<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1800pt" height="13pt"
 viewBox="0.00 0.00 1800.00 13.33" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.02 0.02) rotate(0) translate(4 683)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-683 92781.5,-683 92781.5,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<path fill="lightgreen" stroke="black" d="M94,-679C94,-679 17,-679 17,-679 11,-679 5,-673 5,-667 5,-667 5,-638 5,-638 5,-632 11,-626 17,-626 17,-626 94,-626 94,-626 100,-626 106,-632 106,-638 106,-638 106,-667 106,-667 106,-673 100,-679 94,-679"/>
<text text-anchor="middle" x="55.5" y="-663.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="55.5" y="-648.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="55.5" y="-633.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_ln1 -->
<g id="node2" class="node">
<title>layer1_ln1</title>
<path fill="lightyellow" stroke="black" d="M99,-560C99,-560 12,-560 12,-560 6,-560 0,-554 0,-548 0,-548 0,-519 0,-519 0,-513 6,-507 12,-507 12,-507 99,-507 99,-507 105,-507 111,-513 111,-519 111,-519 111,-548 111,-548 111,-554 105,-560 99,-560"/>
<text text-anchor="middle" x="55.5" y="-544.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="55.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="55.5" y="-514.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- input&#45;&gt;layer1_ln1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer1_ln1</title>
<path fill="none" stroke="black" d="M55.5,-625.82C55.5,-609.52 55.5,-588.18 55.5,-570.23"/>
<polygon fill="black" stroke="black" points="59,-570.12 55.5,-560.12 52,-570.12 59,-570.12"/>
</g>
<!-- layer1_q_0_0 -->
<g id="node3" class="node">
<title>layer1_q_0_0</title>
<path fill="lightcoral" stroke="black" d="M15108,-575C15108,-575 14925,-575 14925,-575 14919,-575 14913,-569 14913,-563 14913,-563 14913,-504 14913,-504 14913,-498 14919,-492 14925,-492 14925,-492 15108,-492 15108,-492 15114,-492 15120,-498 15120,-504 15120,-504 15120,-563 15120,-563 15120,-569 15114,-575 15108,-575"/>
<text text-anchor="middle" x="15016.5" y="-559.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="15016.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="15016.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="15016.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="15016.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_q_0_0 -->
<g id="edge2" class="edge">
<title>layer1_ln1&#45;&gt;layer1_q_0_0</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 243.8,-632.46 14795.3,-625.95 14894.5,-600.5 14912.08,-595.99 14929.84,-588.36 14946.17,-579.83"/>
<polygon fill="black" stroke="black" points="14947.95,-582.85 14955.08,-575.01 14944.62,-576.69 14947.95,-582.85"/>
</g>
<!-- layer1_k_0_0 -->
<g id="node4" class="node">
<title>layer1_k_0_0</title>
<path fill="lightcoral" stroke="black" d="M14883,-575C14883,-575 14700,-575 14700,-575 14694,-575 14688,-569 14688,-563 14688,-563 14688,-504 14688,-504 14688,-498 14694,-492 14700,-492 14700,-492 14883,-492 14883,-492 14889,-492 14895,-498 14895,-504 14895,-504 14895,-563 14895,-563 14895,-569 14889,-575 14883,-575"/>
<text text-anchor="middle" x="14791.5" y="-559.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="14791.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="14791.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="14791.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="14791.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_k_0_0 -->
<g id="edge3" class="edge">
<title>layer1_ln1&#45;&gt;layer1_k_0_0</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 242.32,-631.97 14571.81,-625.56 14669.5,-600.5 14687.08,-595.99 14704.84,-588.36 14721.17,-579.83"/>
<polygon fill="black" stroke="black" points="14722.95,-582.85 14730.08,-575.01 14719.62,-576.69 14722.95,-582.85"/>
</g>
<!-- layer1_v_0_0 -->
<g id="node5" class="node">
<title>layer1_v_0_0</title>
<path fill="lightcoral" stroke="black" d="M14658,-575C14658,-575 14475,-575 14475,-575 14469,-575 14463,-569 14463,-563 14463,-563 14463,-504 14463,-504 14463,-498 14469,-492 14475,-492 14475,-492 14658,-492 14658,-492 14664,-492 14670,-498 14670,-504 14670,-504 14670,-563 14670,-563 14670,-569 14664,-575 14658,-575"/>
<text text-anchor="middle" x="14566.5" y="-559.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="14566.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="14566.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="14566.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="14566.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_v_0_0 -->
<g id="edge4" class="edge">
<title>layer1_ln1&#45;&gt;layer1_v_0_0</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 240.83,-631.48 14348.32,-625.17 14444.5,-600.5 14462.08,-595.99 14479.84,-588.36 14496.17,-579.83"/>
<polygon fill="black" stroke="black" points="14497.95,-582.85 14505.08,-575.01 14494.62,-576.69 14497.95,-582.85"/>
</g>
<!-- layer1_q_0_1 -->
<g id="node6" class="node">
<title>layer1_q_0_1</title>
<path fill="lightcoral" stroke="black" d="M14190,-575C14190,-575 14007,-575 14007,-575 14001,-575 13995,-569 13995,-563 13995,-563 13995,-504 13995,-504 13995,-498 14001,-492 14007,-492 14007,-492 14190,-492 14190,-492 14196,-492 14202,-498 14202,-504 14202,-504 14202,-563 14202,-563 14202,-569 14196,-575 14190,-575"/>
<text text-anchor="middle" x="14098.5" y="-559.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="14098.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="14098.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="14098.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="14098.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_q_0_1 -->
<g id="edge5" class="edge">
<title>layer1_ln1&#45;&gt;layer1_q_0_1</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 237.75,-630.47 13883.47,-624.36 13976.5,-600.5 13994.08,-595.99 14011.84,-588.36 14028.17,-579.83"/>
<polygon fill="black" stroke="black" points="14029.95,-582.85 14037.08,-575.01 14026.62,-576.69 14029.95,-582.85"/>
</g>
<!-- layer1_k_0_1 -->
<g id="node7" class="node">
<title>layer1_k_0_1</title>
<path fill="lightcoral" stroke="black" d="M13965,-575C13965,-575 13782,-575 13782,-575 13776,-575 13770,-569 13770,-563 13770,-563 13770,-504 13770,-504 13770,-498 13776,-492 13782,-492 13782,-492 13965,-492 13965,-492 13971,-492 13977,-498 13977,-504 13977,-504 13977,-563 13977,-563 13977,-569 13971,-575 13965,-575"/>
<text text-anchor="middle" x="13873.5" y="-559.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="13873.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="13873.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="13873.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="13873.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_k_0_1 -->
<g id="edge6" class="edge">
<title>layer1_ln1&#45;&gt;layer1_k_0_1</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 236.26,-629.98 13659.98,-623.98 13751.5,-600.5 13769.08,-595.99 13786.84,-588.36 13803.17,-579.83"/>
<polygon fill="black" stroke="black" points="13804.95,-582.85 13812.08,-575.01 13801.62,-576.69 13804.95,-582.85"/>
</g>
<!-- layer1_v_0_1 -->
<g id="node8" class="node">
<title>layer1_v_0_1</title>
<path fill="lightcoral" stroke="black" d="M13740,-575C13740,-575 13557,-575 13557,-575 13551,-575 13545,-569 13545,-563 13545,-563 13545,-504 13545,-504 13545,-498 13551,-492 13557,-492 13557,-492 13740,-492 13740,-492 13746,-492 13752,-498 13752,-504 13752,-504 13752,-563 13752,-563 13752,-569 13746,-575 13740,-575"/>
<text text-anchor="middle" x="13648.5" y="-559.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="13648.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="13648.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="13648.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="13648.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_v_0_1 -->
<g id="edge7" class="edge">
<title>layer1_ln1&#45;&gt;layer1_v_0_1</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 234.78,-629.49 13436.5,-623.59 13526.5,-600.5 13544.08,-595.99 13561.84,-588.36 13578.17,-579.83"/>
<polygon fill="black" stroke="black" points="13579.95,-582.85 13587.08,-575.01 13576.62,-576.69 13579.95,-582.85"/>
</g>
<!-- layer1_q_0_2 -->
<g id="node9" class="node">
<title>layer1_q_0_2</title>
<path fill="lightcoral" stroke="black" d="M13272,-575C13272,-575 13089,-575 13089,-575 13083,-575 13077,-569 13077,-563 13077,-563 13077,-504 13077,-504 13077,-498 13083,-492 13089,-492 13089,-492 13272,-492 13272,-492 13278,-492 13284,-498 13284,-504 13284,-504 13284,-563 13284,-563 13284,-569 13278,-575 13272,-575"/>
<text text-anchor="middle" x="13180.5" y="-559.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="13180.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="13180.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="13180.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="13180.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_q_0_2 -->
<g id="edge8" class="edge">
<title>layer1_ln1&#45;&gt;layer1_q_0_2</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 231.69,-628.48 12971.65,-622.78 13058.5,-600.5 13076.08,-595.99 13093.84,-588.36 13110.17,-579.83"/>
<polygon fill="black" stroke="black" points="13111.95,-582.85 13119.08,-575.01 13108.62,-576.69 13111.95,-582.85"/>
</g>
<!-- layer1_k_0_2 -->
<g id="node10" class="node">
<title>layer1_k_0_2</title>
<path fill="lightcoral" stroke="black" d="M13047,-575C13047,-575 12864,-575 12864,-575 12858,-575 12852,-569 12852,-563 12852,-563 12852,-504 12852,-504 12852,-498 12858,-492 12864,-492 12864,-492 13047,-492 13047,-492 13053,-492 13059,-498 13059,-504 13059,-504 13059,-563 13059,-563 13059,-569 13053,-575 13047,-575"/>
<text text-anchor="middle" x="12955.5" y="-559.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="12955.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="12955.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="12955.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="12955.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_k_0_2 -->
<g id="edge9" class="edge">
<title>layer1_ln1&#45;&gt;layer1_k_0_2</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 230.21,-627.99 12748.16,-622.39 12833.5,-600.5 12851.08,-595.99 12868.84,-588.36 12885.17,-579.83"/>
<polygon fill="black" stroke="black" points="12886.95,-582.85 12894.08,-575.01 12883.62,-576.69 12886.95,-582.85"/>
</g>
<!-- layer1_v_0_2 -->
<g id="node11" class="node">
<title>layer1_v_0_2</title>
<path fill="lightcoral" stroke="black" d="M12822,-575C12822,-575 12639,-575 12639,-575 12633,-575 12627,-569 12627,-563 12627,-563 12627,-504 12627,-504 12627,-498 12633,-492 12639,-492 12639,-492 12822,-492 12822,-492 12828,-492 12834,-498 12834,-504 12834,-504 12834,-563 12834,-563 12834,-569 12828,-575 12822,-575"/>
<text text-anchor="middle" x="12730.5" y="-559.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="12730.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="12730.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="12730.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="12730.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_v_0_2 -->
<g id="edge10" class="edge">
<title>layer1_ln1&#45;&gt;layer1_v_0_2</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 228.72,-627.5 12524.67,-622 12608.5,-600.5 12626.08,-595.99 12643.84,-588.36 12660.17,-579.83"/>
<polygon fill="black" stroke="black" points="12661.95,-582.85 12669.08,-575.01 12658.62,-576.69 12661.95,-582.85"/>
</g>
<!-- layer1_q_0_3 -->
<g id="node12" class="node">
<title>layer1_q_0_3</title>
<path fill="lightcoral" stroke="black" d="M12354,-575C12354,-575 12171,-575 12171,-575 12165,-575 12159,-569 12159,-563 12159,-563 12159,-504 12159,-504 12159,-498 12165,-492 12171,-492 12171,-492 12354,-492 12354,-492 12360,-492 12366,-498 12366,-504 12366,-504 12366,-563 12366,-563 12366,-569 12360,-575 12354,-575"/>
<text text-anchor="middle" x="12262.5" y="-559.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="12262.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="12262.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="12262.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12262.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_q_0_3 -->
<g id="edge11" class="edge">
<title>layer1_ln1&#45;&gt;layer1_q_0_3</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 225.63,-626.49 12059.82,-621.2 12140.5,-600.5 12158.08,-595.99 12175.84,-588.36 12192.17,-579.83"/>
<polygon fill="black" stroke="black" points="12193.95,-582.85 12201.08,-575.01 12190.62,-576.69 12193.95,-582.85"/>
</g>
<!-- layer1_k_0_3 -->
<g id="node13" class="node">
<title>layer1_k_0_3</title>
<path fill="lightcoral" stroke="black" d="M12129,-575C12129,-575 11946,-575 11946,-575 11940,-575 11934,-569 11934,-563 11934,-563 11934,-504 11934,-504 11934,-498 11940,-492 11946,-492 11946,-492 12129,-492 12129,-492 12135,-492 12141,-498 12141,-504 12141,-504 12141,-563 12141,-563 12141,-569 12135,-575 12129,-575"/>
<text text-anchor="middle" x="12037.5" y="-559.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="12037.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="12037.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="12037.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12037.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_k_0_3 -->
<g id="edge12" class="edge">
<title>layer1_ln1&#45;&gt;layer1_k_0_3</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 224.15,-626 11836.33,-620.81 11915.5,-600.5 11933.08,-595.99 11950.84,-588.36 11967.17,-579.83"/>
<polygon fill="black" stroke="black" points="11968.95,-582.85 11976.08,-575.01 11965.62,-576.69 11968.95,-582.85"/>
</g>
<!-- layer1_v_0_3 -->
<g id="node14" class="node">
<title>layer1_v_0_3</title>
<path fill="lightcoral" stroke="black" d="M11904,-575C11904,-575 11721,-575 11721,-575 11715,-575 11709,-569 11709,-563 11709,-563 11709,-504 11709,-504 11709,-498 11715,-492 11721,-492 11721,-492 11904,-492 11904,-492 11910,-492 11916,-498 11916,-504 11916,-504 11916,-563 11916,-563 11916,-569 11910,-575 11904,-575"/>
<text text-anchor="middle" x="11812.5" y="-559.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="11812.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="11812.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="11812.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="11812.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_v_0_3 -->
<g id="edge13" class="edge">
<title>layer1_ln1&#45;&gt;layer1_v_0_3</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 222.66,-625.51 11612.85,-620.42 11690.5,-600.5 11708.08,-595.99 11725.84,-588.36 11742.17,-579.83"/>
<polygon fill="black" stroke="black" points="11743.95,-582.85 11751.08,-575.01 11740.62,-576.69 11743.95,-582.85"/>
</g>
<!-- layer1_q_1_0 -->
<g id="node15" class="node">
<title>layer1_q_1_0</title>
<path fill="lightcoral" stroke="black" d="M11254,-575C11254,-575 11071,-575 11071,-575 11065,-575 11059,-569 11059,-563 11059,-563 11059,-504 11059,-504 11059,-498 11065,-492 11071,-492 11071,-492 11254,-492 11254,-492 11260,-492 11266,-498 11266,-504 11266,-504 11266,-563 11266,-563 11266,-569 11260,-575 11254,-575"/>
<text text-anchor="middle" x="11162.5" y="-559.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="11162.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="11162.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="11162.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="11162.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_q_1_0 -->
<g id="edge14" class="edge">
<title>layer1_ln1&#45;&gt;layer1_q_1_0</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 218.38,-624.11 10967.22,-619.3 11040.5,-600.5 11058.08,-595.99 11075.84,-588.36 11092.17,-579.83"/>
<polygon fill="black" stroke="black" points="11093.95,-582.85 11101.08,-575.01 11090.62,-576.69 11093.95,-582.85"/>
</g>
<!-- layer1_k_1_0 -->
<g id="node16" class="node">
<title>layer1_k_1_0</title>
<path fill="lightcoral" stroke="black" d="M11029,-575C11029,-575 10846,-575 10846,-575 10840,-575 10834,-569 10834,-563 10834,-563 10834,-504 10834,-504 10834,-498 10840,-492 10846,-492 10846,-492 11029,-492 11029,-492 11035,-492 11041,-498 11041,-504 11041,-504 11041,-563 11041,-563 11041,-569 11035,-575 11029,-575"/>
<text text-anchor="middle" x="10937.5" y="-559.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="10937.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="10937.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="10937.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="10937.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_k_1_0 -->
<g id="edge15" class="edge">
<title>layer1_ln1&#45;&gt;layer1_k_1_0</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 216.89,-623.62 10743.73,-618.91 10815.5,-600.5 10833.08,-595.99 10850.84,-588.36 10867.17,-579.83"/>
<polygon fill="black" stroke="black" points="10868.95,-582.85 10876.08,-575.01 10865.62,-576.69 10868.95,-582.85"/>
</g>
<!-- layer1_v_1_0 -->
<g id="node17" class="node">
<title>layer1_v_1_0</title>
<path fill="lightcoral" stroke="black" d="M10804,-575C10804,-575 10621,-575 10621,-575 10615,-575 10609,-569 10609,-563 10609,-563 10609,-504 10609,-504 10609,-498 10615,-492 10621,-492 10621,-492 10804,-492 10804,-492 10810,-492 10816,-498 10816,-504 10816,-504 10816,-563 10816,-563 10816,-569 10810,-575 10804,-575"/>
<text text-anchor="middle" x="10712.5" y="-559.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="10712.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="10712.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="10712.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="10712.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_v_1_0 -->
<g id="edge16" class="edge">
<title>layer1_ln1&#45;&gt;layer1_v_1_0</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 215.41,-623.13 10520.25,-618.52 10590.5,-600.5 10608.08,-595.99 10625.84,-588.36 10642.17,-579.83"/>
<polygon fill="black" stroke="black" points="10643.95,-582.85 10651.08,-575.01 10640.62,-576.69 10643.95,-582.85"/>
</g>
<!-- layer1_q_1_1 -->
<g id="node18" class="node">
<title>layer1_q_1_1</title>
<path fill="lightcoral" stroke="black" d="M10336,-575C10336,-575 10153,-575 10153,-575 10147,-575 10141,-569 10141,-563 10141,-563 10141,-504 10141,-504 10141,-498 10147,-492 10153,-492 10153,-492 10336,-492 10336,-492 10342,-492 10348,-498 10348,-504 10348,-504 10348,-563 10348,-563 10348,-569 10342,-575 10336,-575"/>
<text text-anchor="middle" x="10244.5" y="-559.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="10244.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="10244.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="10244.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10244.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_q_1_1 -->
<g id="edge17" class="edge">
<title>layer1_ln1&#45;&gt;layer1_q_1_1</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 212.32,-622.12 10055.39,-617.71 10122.5,-600.5 10140.08,-595.99 10157.84,-588.36 10174.17,-579.83"/>
<polygon fill="black" stroke="black" points="10175.95,-582.85 10183.08,-575.01 10172.62,-576.69 10175.95,-582.85"/>
</g>
<!-- layer1_k_1_1 -->
<g id="node19" class="node">
<title>layer1_k_1_1</title>
<path fill="lightcoral" stroke="black" d="M10111,-575C10111,-575 9928,-575 9928,-575 9922,-575 9916,-569 9916,-563 9916,-563 9916,-504 9916,-504 9916,-498 9922,-492 9928,-492 9928,-492 10111,-492 10111,-492 10117,-492 10123,-498 10123,-504 10123,-504 10123,-563 10123,-563 10123,-569 10117,-575 10111,-575"/>
<text text-anchor="middle" x="10019.5" y="-559.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="10019.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="10019.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="10019.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="10019.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_k_1_1 -->
<g id="edge18" class="edge">
<title>layer1_ln1&#45;&gt;layer1_k_1_1</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 210.83,-621.63 9831.91,-617.33 9897.5,-600.5 9915.08,-595.99 9932.84,-588.36 9949.17,-579.83"/>
<polygon fill="black" stroke="black" points="9950.95,-582.85 9958.08,-575.01 9947.62,-576.69 9950.95,-582.85"/>
</g>
<!-- layer1_v_1_1 -->
<g id="node20" class="node">
<title>layer1_v_1_1</title>
<path fill="lightcoral" stroke="black" d="M9886,-575C9886,-575 9703,-575 9703,-575 9697,-575 9691,-569 9691,-563 9691,-563 9691,-504 9691,-504 9691,-498 9697,-492 9703,-492 9703,-492 9886,-492 9886,-492 9892,-492 9898,-498 9898,-504 9898,-504 9898,-563 9898,-563 9898,-569 9892,-575 9886,-575"/>
<text text-anchor="middle" x="9794.5" y="-559.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="9794.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="9794.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="9794.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="9794.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_v_1_1 -->
<g id="edge19" class="edge">
<title>layer1_ln1&#45;&gt;layer1_v_1_1</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 209.35,-621.14 9608.42,-616.94 9672.5,-600.5 9690.08,-595.99 9707.84,-588.36 9724.17,-579.83"/>
<polygon fill="black" stroke="black" points="9725.95,-582.85 9733.08,-575.01 9722.62,-576.69 9725.95,-582.85"/>
</g>
<!-- layer1_q_1_2 -->
<g id="node21" class="node">
<title>layer1_q_1_2</title>
<path fill="lightcoral" stroke="black" d="M9418,-575C9418,-575 9235,-575 9235,-575 9229,-575 9223,-569 9223,-563 9223,-563 9223,-504 9223,-504 9223,-498 9229,-492 9235,-492 9235,-492 9418,-492 9418,-492 9424,-492 9430,-498 9430,-504 9430,-504 9430,-563 9430,-563 9430,-569 9424,-575 9418,-575"/>
<text text-anchor="middle" x="9326.5" y="-559.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="9326.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="9326.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="9326.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="9326.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_q_1_2 -->
<g id="edge20" class="edge">
<title>layer1_ln1&#45;&gt;layer1_q_1_2</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 206.26,-620.13 9143.57,-616.13 9204.5,-600.5 9222.08,-595.99 9239.84,-588.36 9256.17,-579.83"/>
<polygon fill="black" stroke="black" points="9257.95,-582.85 9265.08,-575.01 9254.62,-576.69 9257.95,-582.85"/>
</g>
<!-- layer1_k_1_2 -->
<g id="node22" class="node">
<title>layer1_k_1_2</title>
<path fill="lightcoral" stroke="black" d="M9193,-575C9193,-575 9010,-575 9010,-575 9004,-575 8998,-569 8998,-563 8998,-563 8998,-504 8998,-504 8998,-498 9004,-492 9010,-492 9010,-492 9193,-492 9193,-492 9199,-492 9205,-498 9205,-504 9205,-504 9205,-563 9205,-563 9205,-569 9199,-575 9193,-575"/>
<text text-anchor="middle" x="9101.5" y="-559.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="9101.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="9101.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="9101.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="9101.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_k_1_2 -->
<g id="edge21" class="edge">
<title>layer1_ln1&#45;&gt;layer1_k_1_2</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 204.78,-619.64 8920.08,-615.74 8979.5,-600.5 8997.08,-595.99 9014.84,-588.36 9031.17,-579.83"/>
<polygon fill="black" stroke="black" points="9032.95,-582.85 9040.08,-575.01 9029.62,-576.69 9032.95,-582.85"/>
</g>
<!-- layer1_v_1_2 -->
<g id="node23" class="node">
<title>layer1_v_1_2</title>
<path fill="lightcoral" stroke="black" d="M8968,-575C8968,-575 8785,-575 8785,-575 8779,-575 8773,-569 8773,-563 8773,-563 8773,-504 8773,-504 8773,-498 8779,-492 8785,-492 8785,-492 8968,-492 8968,-492 8974,-492 8980,-498 8980,-504 8980,-504 8980,-563 8980,-563 8980,-569 8974,-575 8968,-575"/>
<text text-anchor="middle" x="8876.5" y="-559.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="8876.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="8876.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="8876.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="8876.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_v_1_2 -->
<g id="edge22" class="edge">
<title>layer1_ln1&#45;&gt;layer1_v_1_2</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 260.09,-637.8 8638.69,-630.21 8754.5,-600.5 8772.08,-595.99 8789.84,-588.36 8806.17,-579.83"/>
<polygon fill="black" stroke="black" points="8807.95,-582.85 8815.08,-575.01 8804.62,-576.69 8807.95,-582.85"/>
</g>
<!-- layer1_q_1_3 -->
<g id="node24" class="node">
<title>layer1_q_1_3</title>
<path fill="lightcoral" stroke="black" d="M8500,-575C8500,-575 8317,-575 8317,-575 8311,-575 8305,-569 8305,-563 8305,-563 8305,-504 8305,-504 8305,-498 8311,-492 8317,-492 8317,-492 8500,-492 8500,-492 8506,-492 8512,-498 8512,-504 8512,-504 8512,-563 8512,-563 8512,-569 8506,-575 8500,-575"/>
<text text-anchor="middle" x="8408.5" y="-559.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="8408.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="8408.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="8408.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8408.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_q_1_3 -->
<g id="edge23" class="edge">
<title>layer1_ln1&#45;&gt;layer1_q_1_3</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 253.91,-635.78 8176.99,-628.59 8286.5,-600.5 8304.08,-595.99 8321.84,-588.36 8338.17,-579.83"/>
<polygon fill="black" stroke="black" points="8339.95,-582.85 8347.08,-575.01 8336.62,-576.69 8339.95,-582.85"/>
</g>
<!-- layer1_k_1_3 -->
<g id="node25" class="node">
<title>layer1_k_1_3</title>
<path fill="lightcoral" stroke="black" d="M8275,-575C8275,-575 8092,-575 8092,-575 8086,-575 8080,-569 8080,-563 8080,-563 8080,-504 8080,-504 8080,-498 8086,-492 8092,-492 8092,-492 8275,-492 8275,-492 8281,-492 8287,-498 8287,-504 8287,-504 8287,-563 8287,-563 8287,-569 8281,-575 8275,-575"/>
<text text-anchor="middle" x="8183.5" y="-559.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="8183.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="8183.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="8183.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="8183.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_k_1_3 -->
<g id="edge24" class="edge">
<title>layer1_ln1&#45;&gt;layer1_k_1_3</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 250.94,-634.8 7955.02,-627.82 8061.5,-600.5 8079.08,-595.99 8096.84,-588.36 8113.17,-579.83"/>
<polygon fill="black" stroke="black" points="8114.95,-582.85 8122.08,-575.01 8111.62,-576.69 8114.95,-582.85"/>
</g>
<!-- layer1_v_1_3 -->
<g id="node26" class="node">
<title>layer1_v_1_3</title>
<path fill="lightcoral" stroke="black" d="M8050,-575C8050,-575 7867,-575 7867,-575 7861,-575 7855,-569 7855,-563 7855,-563 7855,-504 7855,-504 7855,-498 7861,-492 7867,-492 7867,-492 8050,-492 8050,-492 8056,-492 8062,-498 8062,-504 8062,-504 8062,-563 8062,-563 8062,-569 8056,-575 8050,-575"/>
<text text-anchor="middle" x="7958.5" y="-559.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="7958.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="7958.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="7958.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="7958.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_v_1_3 -->
<g id="edge25" class="edge">
<title>layer1_ln1&#45;&gt;layer1_v_1_3</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 247.97,-633.83 7733.04,-627.04 7836.5,-600.5 7854.08,-595.99 7871.84,-588.36 7888.17,-579.83"/>
<polygon fill="black" stroke="black" points="7889.95,-582.85 7897.08,-575.01 7886.62,-576.69 7889.95,-582.85"/>
</g>
<!-- layer1_q_2_0 -->
<g id="node27" class="node">
<title>layer1_q_2_0</title>
<path fill="lightcoral" stroke="black" d="M7400,-575C7400,-575 7217,-575 7217,-575 7211,-575 7205,-569 7205,-563 7205,-563 7205,-504 7205,-504 7205,-498 7211,-492 7217,-492 7217,-492 7400,-492 7400,-492 7406,-492 7412,-498 7412,-504 7412,-504 7412,-563 7412,-563 7412,-569 7406,-575 7400,-575"/>
<text text-anchor="middle" x="7308.5" y="-559.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="7308.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="7308.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="7308.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="7308.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_q_2_0 -->
<g id="edge26" class="edge">
<title>layer1_ln1&#45;&gt;layer1_q_2_0</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 239.4,-631.01 7091.79,-624.8 7186.5,-600.5 7204.08,-595.99 7221.84,-588.36 7238.17,-579.83"/>
<polygon fill="black" stroke="black" points="7239.95,-582.85 7247.08,-575.01 7236.62,-576.69 7239.95,-582.85"/>
</g>
<!-- layer1_k_2_0 -->
<g id="node28" class="node">
<title>layer1_k_2_0</title>
<path fill="lightcoral" stroke="black" d="M7175,-575C7175,-575 6992,-575 6992,-575 6986,-575 6980,-569 6980,-563 6980,-563 6980,-504 6980,-504 6980,-498 6986,-492 6992,-492 6992,-492 7175,-492 7175,-492 7181,-492 7187,-498 7187,-504 7187,-504 7187,-563 7187,-563 7187,-569 7181,-575 7175,-575"/>
<text text-anchor="middle" x="7083.5" y="-559.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="7083.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="7083.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="7083.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="7083.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_k_2_0 -->
<g id="edge27" class="edge">
<title>layer1_ln1&#45;&gt;layer1_k_2_0</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 236.43,-630.03 6869.82,-624.02 6961.5,-600.5 6979.08,-595.99 6996.84,-588.36 7013.17,-579.83"/>
<polygon fill="black" stroke="black" points="7014.95,-582.85 7022.08,-575.01 7011.62,-576.69 7014.95,-582.85"/>
</g>
<!-- layer1_v_2_0 -->
<g id="node29" class="node">
<title>layer1_v_2_0</title>
<path fill="lightcoral" stroke="black" d="M6950,-575C6950,-575 6767,-575 6767,-575 6761,-575 6755,-569 6755,-563 6755,-563 6755,-504 6755,-504 6755,-498 6761,-492 6767,-492 6767,-492 6950,-492 6950,-492 6956,-492 6962,-498 6962,-504 6962,-504 6962,-563 6962,-563 6962,-569 6956,-575 6950,-575"/>
<text text-anchor="middle" x="6858.5" y="-559.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="6858.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="6858.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="6858.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="6858.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_v_2_0 -->
<g id="edge28" class="edge">
<title>layer1_ln1&#45;&gt;layer1_v_2_0</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 233.46,-629.06 6647.84,-623.24 6736.5,-600.5 6754.08,-595.99 6771.84,-588.36 6788.17,-579.83"/>
<polygon fill="black" stroke="black" points="6789.95,-582.85 6797.08,-575.01 6786.62,-576.69 6789.95,-582.85"/>
</g>
<!-- layer1_q_2_1 -->
<g id="node30" class="node">
<title>layer1_q_2_1</title>
<path fill="lightcoral" stroke="black" d="M6482,-575C6482,-575 6299,-575 6299,-575 6293,-575 6287,-569 6287,-563 6287,-563 6287,-504 6287,-504 6287,-498 6293,-492 6299,-492 6299,-492 6482,-492 6482,-492 6488,-492 6494,-498 6494,-504 6494,-504 6494,-563 6494,-563 6494,-569 6488,-575 6482,-575"/>
<text text-anchor="middle" x="6390.5" y="-559.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="6390.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="6390.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="6390.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="6390.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_q_2_1 -->
<g id="edge29" class="edge">
<title>layer1_ln1&#45;&gt;layer1_q_2_1</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 227.28,-627.03 6186.14,-621.63 6268.5,-600.5 6286.08,-595.99 6303.84,-588.36 6320.17,-579.83"/>
<polygon fill="black" stroke="black" points="6321.95,-582.85 6329.08,-575.01 6318.62,-576.69 6321.95,-582.85"/>
</g>
<!-- layer1_k_2_1 -->
<g id="node31" class="node">
<title>layer1_k_2_1</title>
<path fill="lightcoral" stroke="black" d="M6257,-575C6257,-575 6074,-575 6074,-575 6068,-575 6062,-569 6062,-563 6062,-563 6062,-504 6062,-504 6062,-498 6068,-492 6074,-492 6074,-492 6257,-492 6257,-492 6263,-492 6269,-498 6269,-504 6269,-504 6269,-563 6269,-563 6269,-569 6263,-575 6257,-575"/>
<text text-anchor="middle" x="6165.5" y="-559.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="6165.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="6165.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="6165.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="6165.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_k_2_1 -->
<g id="edge30" class="edge">
<title>layer1_ln1&#45;&gt;layer1_k_2_1</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 224.31,-626.06 5964.17,-620.85 6043.5,-600.5 6061.08,-595.99 6078.84,-588.36 6095.17,-579.83"/>
<polygon fill="black" stroke="black" points="6096.95,-582.85 6104.08,-575.01 6093.62,-576.69 6096.95,-582.85"/>
</g>
<!-- layer1_v_2_1 -->
<g id="node32" class="node">
<title>layer1_v_2_1</title>
<path fill="lightcoral" stroke="black" d="M6032,-575C6032,-575 5849,-575 5849,-575 5843,-575 5837,-569 5837,-563 5837,-563 5837,-504 5837,-504 5837,-498 5843,-492 5849,-492 5849,-492 6032,-492 6032,-492 6038,-492 6044,-498 6044,-504 6044,-504 6044,-563 6044,-563 6044,-569 6038,-575 6032,-575"/>
<text text-anchor="middle" x="5940.5" y="-559.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="5940.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="5940.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="5940.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="5940.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_v_2_1 -->
<g id="edge31" class="edge">
<title>layer1_ln1&#45;&gt;layer1_v_2_1</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 221.34,-625.08 5742.19,-620.07 5818.5,-600.5 5836.08,-595.99 5853.84,-588.36 5870.17,-579.83"/>
<polygon fill="black" stroke="black" points="5871.95,-582.85 5879.08,-575.01 5868.62,-576.69 5871.95,-582.85"/>
</g>
<!-- layer1_q_2_2 -->
<g id="node33" class="node">
<title>layer1_q_2_2</title>
<path fill="lightcoral" stroke="black" d="M5564,-575C5564,-575 5381,-575 5381,-575 5375,-575 5369,-569 5369,-563 5369,-563 5369,-504 5369,-504 5369,-498 5375,-492 5381,-492 5381,-492 5564,-492 5564,-492 5570,-492 5576,-498 5576,-504 5576,-504 5576,-563 5576,-563 5576,-569 5570,-575 5564,-575"/>
<text text-anchor="middle" x="5472.5" y="-559.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="5472.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="5472.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="5472.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5472.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_q_2_2 -->
<g id="edge32" class="edge">
<title>layer1_ln1&#45;&gt;layer1_q_2_2</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 215.17,-623.05 5280.49,-618.46 5350.5,-600.5 5368.08,-595.99 5385.84,-588.36 5402.17,-579.83"/>
<polygon fill="black" stroke="black" points="5403.95,-582.85 5411.08,-575.01 5400.62,-576.69 5403.95,-582.85"/>
</g>
<!-- layer1_k_2_2 -->
<g id="node34" class="node">
<title>layer1_k_2_2</title>
<path fill="lightcoral" stroke="black" d="M5339,-575C5339,-575 5156,-575 5156,-575 5150,-575 5144,-569 5144,-563 5144,-563 5144,-504 5144,-504 5144,-498 5150,-492 5156,-492 5156,-492 5339,-492 5339,-492 5345,-492 5351,-498 5351,-504 5351,-504 5351,-563 5351,-563 5351,-569 5345,-575 5339,-575"/>
<text text-anchor="middle" x="5247.5" y="-559.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="5247.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="5247.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="5247.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5247.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_k_2_2 -->
<g id="edge33" class="edge">
<title>layer1_ln1&#45;&gt;layer1_k_2_2</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 212.2,-622.08 5058.52,-617.68 5125.5,-600.5 5143.08,-595.99 5160.84,-588.36 5177.17,-579.83"/>
<polygon fill="black" stroke="black" points="5178.95,-582.85 5186.08,-575.01 5175.62,-576.69 5178.95,-582.85"/>
</g>
<!-- layer1_v_2_2 -->
<g id="node35" class="node">
<title>layer1_v_2_2</title>
<path fill="lightcoral" stroke="black" d="M5114,-575C5114,-575 4931,-575 4931,-575 4925,-575 4919,-569 4919,-563 4919,-563 4919,-504 4919,-504 4919,-498 4925,-492 4931,-492 4931,-492 5114,-492 5114,-492 5120,-492 5126,-498 5126,-504 5126,-504 5126,-563 5126,-563 5126,-569 5120,-575 5114,-575"/>
<text text-anchor="middle" x="5022.5" y="-559.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="5022.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="5022.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="5022.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5022.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_v_2_2 -->
<g id="edge34" class="edge">
<title>layer1_ln1&#45;&gt;layer1_v_2_2</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 209.23,-621.1 4836.54,-616.91 4900.5,-600.5 4918.08,-595.99 4935.84,-588.36 4952.17,-579.83"/>
<polygon fill="black" stroke="black" points="4953.95,-582.85 4961.08,-575.01 4950.62,-576.69 4953.95,-582.85"/>
</g>
<!-- layer1_q_2_3 -->
<g id="node36" class="node">
<title>layer1_q_2_3</title>
<path fill="lightcoral" stroke="black" d="M4646,-575C4646,-575 4463,-575 4463,-575 4457,-575 4451,-569 4451,-563 4451,-563 4451,-504 4451,-504 4451,-498 4457,-492 4463,-492 4463,-492 4646,-492 4646,-492 4652,-492 4658,-498 4658,-504 4658,-504 4658,-563 4658,-563 4658,-569 4652,-575 4646,-575"/>
<text text-anchor="middle" x="4554.5" y="-559.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="4554.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="4554.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="4554.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="4554.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_q_2_3 -->
<g id="edge35" class="edge">
<title>layer1_ln1&#45;&gt;layer1_q_2_3</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 259.61,-637.65 4317.18,-630.08 4432.5,-600.5 4450.08,-595.99 4467.84,-588.36 4484.17,-579.83"/>
<polygon fill="black" stroke="black" points="4485.95,-582.85 4493.08,-575.01 4482.62,-576.69 4485.95,-582.85"/>
</g>
<!-- layer1_k_2_3 -->
<g id="node37" class="node">
<title>layer1_k_2_3</title>
<path fill="lightcoral" stroke="black" d="M4421,-575C4421,-575 4238,-575 4238,-575 4232,-575 4226,-569 4226,-563 4226,-563 4226,-504 4226,-504 4226,-498 4232,-492 4238,-492 4238,-492 4421,-492 4421,-492 4427,-492 4433,-498 4433,-504 4433,-504 4433,-563 4433,-563 4433,-569 4427,-575 4421,-575"/>
<text text-anchor="middle" x="4329.5" y="-559.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="4329.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="4329.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="4329.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="4329.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_k_2_3 -->
<g id="edge36" class="edge">
<title>layer1_ln1&#45;&gt;layer1_k_2_3</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 253.67,-635.7 4098.23,-628.53 4207.5,-600.5 4225.08,-595.99 4242.84,-588.36 4259.17,-579.83"/>
<polygon fill="black" stroke="black" points="4260.95,-582.85 4268.08,-575.01 4257.62,-576.69 4260.95,-582.85"/>
</g>
<!-- layer1_v_2_3 -->
<g id="node38" class="node">
<title>layer1_v_2_3</title>
<path fill="lightcoral" stroke="black" d="M4196,-575C4196,-575 4013,-575 4013,-575 4007,-575 4001,-569 4001,-563 4001,-563 4001,-504 4001,-504 4001,-498 4007,-492 4013,-492 4013,-492 4196,-492 4196,-492 4202,-492 4208,-498 4208,-504 4208,-504 4208,-563 4208,-563 4208,-569 4202,-575 4196,-575"/>
<text text-anchor="middle" x="4104.5" y="-559.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="4104.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="4104.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="4104.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="4104.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_v_2_3 -->
<g id="edge37" class="edge">
<title>layer1_ln1&#45;&gt;layer1_v_2_3</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 247.74,-633.75 3879.29,-626.98 3982.5,-600.5 4000.08,-595.99 4017.84,-588.36 4034.17,-579.83"/>
<polygon fill="black" stroke="black" points="4035.95,-582.85 4043.08,-575.01 4032.62,-576.69 4035.95,-582.85"/>
</g>
<!-- layer1_q_3_0 -->
<g id="node39" class="node">
<title>layer1_q_3_0</title>
<path fill="lightcoral" stroke="black" d="M3546,-575C3546,-575 3363,-575 3363,-575 3357,-575 3351,-569 3351,-563 3351,-563 3351,-504 3351,-504 3351,-498 3357,-492 3363,-492 3363,-492 3546,-492 3546,-492 3552,-492 3558,-498 3558,-504 3558,-504 3558,-563 3558,-563 3558,-569 3552,-575 3546,-575"/>
<text text-anchor="middle" x="3454.5" y="-559.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="3454.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="3454.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="3454.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="3454.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_q_3_0 -->
<g id="edge38" class="edge">
<title>layer1_ln1&#45;&gt;layer1_q_3_0</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 230.58,-628.11 3246.78,-622.49 3332.5,-600.5 3350.08,-595.99 3367.84,-588.36 3384.17,-579.83"/>
<polygon fill="black" stroke="black" points="3385.95,-582.85 3393.08,-575.01 3382.62,-576.69 3385.95,-582.85"/>
</g>
<!-- layer1_k_3_0 -->
<g id="node40" class="node">
<title>layer1_k_3_0</title>
<path fill="lightcoral" stroke="black" d="M3321,-575C3321,-575 3138,-575 3138,-575 3132,-575 3126,-569 3126,-563 3126,-563 3126,-504 3126,-504 3126,-498 3132,-492 3138,-492 3138,-492 3321,-492 3321,-492 3327,-492 3333,-498 3333,-504 3333,-504 3333,-563 3333,-563 3333,-569 3327,-575 3321,-575"/>
<text text-anchor="middle" x="3229.5" y="-559.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="3229.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="3229.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="3229.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="3229.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_k_3_0 -->
<g id="edge39" class="edge">
<title>layer1_ln1&#45;&gt;layer1_k_3_0</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 224.64,-626.16 3027.83,-620.94 3107.5,-600.5 3125.08,-595.99 3142.84,-588.36 3159.17,-579.83"/>
<polygon fill="black" stroke="black" points="3160.95,-582.85 3168.08,-575.01 3157.62,-576.69 3160.95,-582.85"/>
</g>
<!-- layer1_v_3_0 -->
<g id="node41" class="node">
<title>layer1_v_3_0</title>
<path fill="lightcoral" stroke="black" d="M3096,-575C3096,-575 2913,-575 2913,-575 2907,-575 2901,-569 2901,-563 2901,-563 2901,-504 2901,-504 2901,-498 2907,-492 2913,-492 2913,-492 3096,-492 3096,-492 3102,-492 3108,-498 3108,-504 3108,-504 3108,-563 3108,-563 3108,-569 3102,-575 3096,-575"/>
<text text-anchor="middle" x="3004.5" y="-559.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="3004.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="3004.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="3004.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="3004.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_v_3_0 -->
<g id="edge40" class="edge">
<title>layer1_ln1&#45;&gt;layer1_v_3_0</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 218.71,-624.21 2808.88,-619.38 2882.5,-600.5 2900.08,-595.99 2917.84,-588.36 2934.17,-579.83"/>
<polygon fill="black" stroke="black" points="2935.95,-582.85 2943.08,-575.01 2932.62,-576.69 2935.95,-582.85"/>
</g>
<!-- layer1_q_3_1 -->
<g id="node42" class="node">
<title>layer1_q_3_1</title>
<path fill="lightcoral" stroke="black" d="M2628,-575C2628,-575 2445,-575 2445,-575 2439,-575 2433,-569 2433,-563 2433,-563 2433,-504 2433,-504 2433,-498 2439,-492 2445,-492 2445,-492 2628,-492 2628,-492 2634,-492 2640,-498 2640,-504 2640,-504 2640,-563 2640,-563 2640,-569 2634,-575 2628,-575"/>
<text text-anchor="middle" x="2536.5" y="-559.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="2536.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="2536.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="2536.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="2536.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_q_3_1 -->
<g id="edge41" class="edge">
<title>layer1_ln1&#45;&gt;layer1_q_3_1</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 206.35,-620.16 2353.48,-616.15 2414.5,-600.5 2432.08,-595.99 2449.84,-588.36 2466.17,-579.83"/>
<polygon fill="black" stroke="black" points="2467.95,-582.85 2475.08,-575.01 2464.62,-576.69 2467.95,-582.85"/>
</g>
<!-- layer1_k_3_1 -->
<g id="node43" class="node">
<title>layer1_k_3_1</title>
<path fill="lightcoral" stroke="black" d="M2403,-575C2403,-575 2220,-575 2220,-575 2214,-575 2208,-569 2208,-563 2208,-563 2208,-504 2208,-504 2208,-498 2214,-492 2220,-492 2220,-492 2403,-492 2403,-492 2409,-492 2415,-498 2415,-504 2415,-504 2415,-563 2415,-563 2415,-569 2409,-575 2403,-575"/>
<text text-anchor="middle" x="2311.5" y="-559.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="2311.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="2311.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="2311.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="2311.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_k_3_1 -->
<g id="edge42" class="edge">
<title>layer1_ln1&#45;&gt;layer1_k_3_1</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 254.33,-635.92 2079.56,-628.7 2189.5,-600.5 2207.08,-595.99 2224.84,-588.36 2241.17,-579.83"/>
<polygon fill="black" stroke="black" points="2242.95,-582.85 2250.08,-575.01 2239.62,-576.69 2242.95,-582.85"/>
</g>
<!-- layer1_v_3_1 -->
<g id="node44" class="node">
<title>layer1_v_3_1</title>
<path fill="lightcoral" stroke="black" d="M2178,-575C2178,-575 1995,-575 1995,-575 1989,-575 1983,-569 1983,-563 1983,-563 1983,-504 1983,-504 1983,-498 1989,-492 1995,-492 1995,-492 2178,-492 2178,-492 2184,-492 2190,-498 2190,-504 2190,-504 2190,-563 2190,-563 2190,-569 2184,-575 2178,-575"/>
<text text-anchor="middle" x="2086.5" y="-559.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="2086.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="2086.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="2086.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="2086.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_v_3_1 -->
<g id="edge43" class="edge">
<title>layer1_ln1&#45;&gt;layer1_v_3_1</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 242.46,-632.01 1866.67,-625.6 1964.5,-600.5 1982.08,-595.99 1999.84,-588.36 2016.17,-579.83"/>
<polygon fill="black" stroke="black" points="2017.95,-582.85 2025.08,-575.01 2014.62,-576.69 2017.95,-582.85"/>
</g>
<!-- layer1_q_3_2 -->
<g id="node45" class="node">
<title>layer1_q_3_2</title>
<path fill="lightcoral" stroke="black" d="M1710,-575C1710,-575 1527,-575 1527,-575 1521,-575 1515,-569 1515,-563 1515,-563 1515,-504 1515,-504 1515,-498 1521,-492 1527,-492 1527,-492 1710,-492 1710,-492 1716,-492 1722,-498 1722,-504 1722,-504 1722,-563 1722,-563 1722,-569 1716,-575 1710,-575"/>
<text text-anchor="middle" x="1618.5" y="-559.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="1618.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="1618.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="1618.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="1618.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_q_3_2 -->
<g id="edge44" class="edge">
<title>layer1_ln1&#45;&gt;layer1_q_3_2</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 217.76,-623.9 1423.85,-619.14 1496.5,-600.5 1514.08,-595.99 1531.84,-588.36 1548.17,-579.83"/>
<polygon fill="black" stroke="black" points="1549.95,-582.85 1557.08,-575.01 1546.62,-576.69 1549.95,-582.85"/>
</g>
<!-- layer1_k_3_2 -->
<g id="node46" class="node">
<title>layer1_k_3_2</title>
<path fill="lightcoral" stroke="black" d="M1485,-575C1485,-575 1302,-575 1302,-575 1296,-575 1290,-569 1290,-563 1290,-563 1290,-504 1290,-504 1290,-498 1296,-492 1302,-492 1302,-492 1485,-492 1485,-492 1491,-492 1497,-498 1497,-504 1497,-504 1497,-563 1497,-563 1497,-569 1491,-575 1485,-575"/>
<text text-anchor="middle" x="1393.5" y="-559.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="1393.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="1393.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="1393.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="1393.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_k_3_2 -->
<g id="edge45" class="edge">
<title>layer1_ln1&#45;&gt;layer1_k_3_2</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 205.88,-620 1210.96,-616.03 1271.5,-600.5 1289.08,-595.99 1306.84,-588.36 1323.17,-579.83"/>
<polygon fill="black" stroke="black" points="1324.95,-582.85 1332.08,-575.01 1321.62,-576.69 1324.95,-582.85"/>
</g>
<!-- layer1_v_3_2 -->
<g id="node47" class="node">
<title>layer1_v_3_2</title>
<path fill="lightcoral" stroke="black" d="M1260,-575C1260,-575 1077,-575 1077,-575 1071,-575 1065,-569 1065,-563 1065,-563 1065,-504 1065,-504 1065,-498 1071,-492 1077,-492 1077,-492 1260,-492 1260,-492 1266,-492 1272,-498 1272,-504 1272,-504 1272,-563 1272,-563 1272,-569 1266,-575 1260,-575"/>
<text text-anchor="middle" x="1168.5" y="-559.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="1168.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="1168.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="1168.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="1168.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_v_3_2 -->
<g id="edge46" class="edge">
<title>layer1_ln1&#45;&gt;layer1_v_3_2</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 241.51,-631.7 949.64,-625.35 1046.5,-600.5 1064.08,-595.99 1081.84,-588.36 1098.17,-579.83"/>
<polygon fill="black" stroke="black" points="1099.95,-582.85 1107.08,-575.01 1096.62,-576.69 1099.95,-582.85"/>
</g>
<!-- layer1_q_3_3 -->
<g id="node48" class="node">
<title>layer1_q_3_3</title>
<path fill="lightcoral" stroke="black" d="M792,-575C792,-575 609,-575 609,-575 603,-575 597,-569 597,-563 597,-563 597,-504 597,-504 597,-498 603,-492 609,-492 609,-492 792,-492 792,-492 798,-492 804,-498 804,-504 804,-504 804,-563 804,-563 804,-569 798,-575 792,-575"/>
<text text-anchor="middle" x="700.5" y="-559.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="700.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="700.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="700.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="700.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_q_3_3 -->
<g id="edge47" class="edge">
<title>layer1_ln1&#45;&gt;layer1_q_3_3</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 237.71,-630.45 485.51,-624.35 578.5,-600.5 596.08,-595.99 613.84,-588.36 630.17,-579.83"/>
<polygon fill="black" stroke="black" points="631.95,-582.85 639.08,-575.01 628.62,-576.69 631.95,-582.85"/>
</g>
<!-- layer1_k_3_3 -->
<g id="node49" class="node">
<title>layer1_k_3_3</title>
<path fill="lightcoral" stroke="black" d="M567,-575C567,-575 384,-575 384,-575 378,-575 372,-569 372,-563 372,-563 372,-504 372,-504 372,-498 378,-492 384,-492 384,-492 567,-492 567,-492 573,-492 579,-498 579,-504 579,-504 579,-563 579,-563 579,-569 573,-575 567,-575"/>
<text text-anchor="middle" x="475.5" y="-559.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="475.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="475.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="475.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="475.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_k_3_3 -->
<g id="edge48" class="edge">
<title>layer1_ln1&#45;&gt;layer1_k_3_3</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 233.91,-629.21 264.39,-623.36 353.5,-600.5 371.08,-595.99 388.84,-588.36 405.17,-579.83"/>
<polygon fill="black" stroke="black" points="406.95,-582.85 414.08,-575.01 403.62,-576.69 406.95,-582.85"/>
</g>
<!-- layer1_v_3_3 -->
<g id="node50" class="node">
<title>layer1_v_3_3</title>
<path fill="lightcoral" stroke="black" d="M342,-575C342,-575 159,-575 159,-575 153,-575 147,-569 147,-563 147,-563 147,-504 147,-504 147,-498 153,-492 159,-492 159,-492 342,-492 342,-492 348,-492 354,-498 354,-504 354,-504 354,-563 354,-563 354,-569 348,-575 342,-575"/>
<text text-anchor="middle" x="250.5" y="-559.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="250.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="250.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="250.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="250.5" y="-499.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_v_3_3 -->
<g id="edge49" class="edge">
<title>layer1_ln1&#45;&gt;layer1_v_3_3</title>
<path fill="none" stroke="black" d="M111.11,-533.5C119.65,-533.5 128.2,-533.5 136.74,-533.5"/>
<polygon fill="black" stroke="black" points="136.77,-537 146.77,-533.5 136.77,-530 136.77,-537"/>
</g>
<!-- layer1_residual1 -->
<g id="node52" class="node">
<title>layer1_residual1</title>
<path fill="lightgreen" stroke="black" d="M16072.5,-560C16072.5,-560 15972.5,-560 15972.5,-560 15966.5,-560 15960.5,-554 15960.5,-548 15960.5,-548 15960.5,-519 15960.5,-519 15960.5,-513 15966.5,-507 15972.5,-507 15972.5,-507 16072.5,-507 16072.5,-507 16078.5,-507 16084.5,-513 16084.5,-519 16084.5,-519 16084.5,-548 16084.5,-548 16084.5,-554 16078.5,-560 16072.5,-560"/>
<text text-anchor="middle" x="16022.5" y="-544.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="16022.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="16022.5" y="-514.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_ln1&#45;&gt;layer1_residual1 -->
<g id="edge51" class="edge">
<title>layer1_ln1&#45;&gt;layer1_residual1</title>
<path fill="none" stroke="black" d="M81.94,-560.09C98.83,-575.12 122.08,-592.48 146.5,-600.5 250.6,-634.69 15819.82,-632.86 15924.5,-600.5 15946.67,-593.65 15968.29,-579.86 15985.56,-566.57"/>
<polygon fill="black" stroke="black" points="15988.03,-569.08 15993.67,-560.12 15983.67,-563.61 15988.03,-569.08"/>
</g>
<!-- layer1_attn_0_0 -->
<g id="node65" class="node">
<title>layer1_attn_0_0</title>
<path fill="orange" stroke="black" d="M15351,-567.5C15351,-567.5 15168,-567.5 15168,-567.5 15162,-567.5 15156,-561.5 15156,-555.5 15156,-555.5 15156,-511.5 15156,-511.5 15156,-505.5 15162,-499.5 15168,-499.5 15168,-499.5 15351,-499.5 15351,-499.5 15357,-499.5 15363,-505.5 15363,-511.5 15363,-511.5 15363,-555.5 15363,-555.5 15363,-561.5 15357,-567.5 15351,-567.5"/>
<text text-anchor="middle" x="15259.5" y="-552.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="15259.5" y="-537.3" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="15259.5" y="-522.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="15259.5" y="-507.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_q_0_0&#45;&gt;layer1_attn_0_0 -->
<g id="edge72" class="edge">
<title>layer1_q_0_0&#45;&gt;layer1_attn_0_0</title>
<path fill="none" stroke="black" d="M15120.44,-533.5C15128.81,-533.5 15137.17,-533.5 15145.54,-533.5"/>
<polygon fill="black" stroke="black" points="15145.75,-537 15155.75,-533.5 15145.75,-530 15145.75,-537"/>
</g>
<!-- layer1_k_0_0&#45;&gt;layer1_attn_0_0 -->
<g id="edge73" class="edge">
<title>layer1_k_0_0&#45;&gt;layer1_attn_0_0</title>
<path fill="none" stroke="black" d="M14852.38,-575.01C14870.88,-585.43 14891.81,-595.15 14912.5,-600.5 15001.57,-623.51 15029.78,-620.86 15119.5,-600.5 15145.02,-594.71 15171.32,-583.67 15194.14,-572.2"/>
<polygon fill="black" stroke="black" points="15195.75,-575.31 15203.04,-567.62 15192.54,-569.08 15195.75,-575.31"/>
</g>
<!-- layer1_v_0_0&#45;&gt;layer1_attn_0_0 -->
<g id="edge74" class="edge">
<title>layer1_v_0_0&#45;&gt;layer1_attn_0_0</title>
<path fill="none" stroke="black" d="M14627.38,-575.01C14645.88,-585.43 14666.81,-595.15 14687.5,-600.5 14780.45,-624.52 15025.88,-621.75 15119.5,-600.5 15145.02,-594.71 15171.32,-583.67 15194.14,-572.2"/>
<polygon fill="black" stroke="black" points="15195.75,-575.31 15203.04,-567.62 15192.54,-569.08 15195.75,-575.31"/>
</g>
<!-- layer1_attn_0_1 -->
<g id="node66" class="node">
<title>layer1_attn_0_1</title>
<path fill="orange" stroke="black" d="M14433,-567.5C14433,-567.5 14250,-567.5 14250,-567.5 14244,-567.5 14238,-561.5 14238,-555.5 14238,-555.5 14238,-511.5 14238,-511.5 14238,-505.5 14244,-499.5 14250,-499.5 14250,-499.5 14433,-499.5 14433,-499.5 14439,-499.5 14445,-505.5 14445,-511.5 14445,-511.5 14445,-555.5 14445,-555.5 14445,-561.5 14439,-567.5 14433,-567.5"/>
<text text-anchor="middle" x="14341.5" y="-552.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="14341.5" y="-537.3" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="14341.5" y="-522.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="14341.5" y="-507.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer1_q_0_1&#45;&gt;layer1_attn_0_1 -->
<g id="edge75" class="edge">
<title>layer1_q_0_1&#45;&gt;layer1_attn_0_1</title>
<path fill="none" stroke="black" d="M14202.44,-533.5C14210.81,-533.5 14219.17,-533.5 14227.54,-533.5"/>
<polygon fill="black" stroke="black" points="14227.75,-537 14237.75,-533.5 14227.75,-530 14227.75,-537"/>
</g>
<!-- layer1_k_0_1&#45;&gt;layer1_attn_0_1 -->
<g id="edge76" class="edge">
<title>layer1_k_0_1&#45;&gt;layer1_attn_0_1</title>
<path fill="none" stroke="black" d="M13934.38,-575.01C13952.88,-585.43 13973.81,-595.15 13994.5,-600.5 14083.57,-623.51 14111.78,-620.86 14201.5,-600.5 14227.02,-594.71 14253.32,-583.67 14276.14,-572.2"/>
<polygon fill="black" stroke="black" points="14277.75,-575.31 14285.04,-567.62 14274.54,-569.08 14277.75,-575.31"/>
</g>
<!-- layer1_v_0_1&#45;&gt;layer1_attn_0_1 -->
<g id="edge77" class="edge">
<title>layer1_v_0_1&#45;&gt;layer1_attn_0_1</title>
<path fill="none" stroke="black" d="M13709.38,-575.01C13727.88,-585.43 13748.81,-595.15 13769.5,-600.5 13862.45,-624.52 14107.88,-621.75 14201.5,-600.5 14227.02,-594.71 14253.32,-583.67 14276.14,-572.2"/>
<polygon fill="black" stroke="black" points="14277.75,-575.31 14285.04,-567.62 14274.54,-569.08 14277.75,-575.31"/>
</g>
<!-- layer1_attn_0_2 -->
<g id="node67" class="node">
<title>layer1_attn_0_2</title>
<path fill="orange" stroke="black" d="M13515,-567.5C13515,-567.5 13332,-567.5 13332,-567.5 13326,-567.5 13320,-561.5 13320,-555.5 13320,-555.5 13320,-511.5 13320,-511.5 13320,-505.5 13326,-499.5 13332,-499.5 13332,-499.5 13515,-499.5 13515,-499.5 13521,-499.5 13527,-505.5 13527,-511.5 13527,-511.5 13527,-555.5 13527,-555.5 13527,-561.5 13521,-567.5 13515,-567.5"/>
<text text-anchor="middle" x="13423.5" y="-552.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="13423.5" y="-537.3" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="13423.5" y="-522.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="13423.5" y="-507.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_q_0_2&#45;&gt;layer1_attn_0_2 -->
<g id="edge78" class="edge">
<title>layer1_q_0_2&#45;&gt;layer1_attn_0_2</title>
<path fill="none" stroke="black" d="M13284.44,-533.5C13292.81,-533.5 13301.17,-533.5 13309.54,-533.5"/>
<polygon fill="black" stroke="black" points="13309.75,-537 13319.75,-533.5 13309.75,-530 13309.75,-537"/>
</g>
<!-- layer1_k_0_2&#45;&gt;layer1_attn_0_2 -->
<g id="edge79" class="edge">
<title>layer1_k_0_2&#45;&gt;layer1_attn_0_2</title>
<path fill="none" stroke="black" d="M13016.38,-575.01C13034.88,-585.43 13055.81,-595.15 13076.5,-600.5 13165.57,-623.51 13193.78,-620.86 13283.5,-600.5 13309.02,-594.71 13335.32,-583.67 13358.14,-572.2"/>
<polygon fill="black" stroke="black" points="13359.75,-575.31 13367.04,-567.62 13356.54,-569.08 13359.75,-575.31"/>
</g>
<!-- layer1_v_0_2&#45;&gt;layer1_attn_0_2 -->
<g id="edge80" class="edge">
<title>layer1_v_0_2&#45;&gt;layer1_attn_0_2</title>
<path fill="none" stroke="black" d="M12791.38,-575.01C12809.88,-585.43 12830.81,-595.15 12851.5,-600.5 12944.45,-624.52 13189.88,-621.75 13283.5,-600.5 13309.02,-594.71 13335.32,-583.67 13358.14,-572.2"/>
<polygon fill="black" stroke="black" points="13359.75,-575.31 13367.04,-567.62 13356.54,-569.08 13359.75,-575.31"/>
</g>
<!-- layer1_attn_0_3 -->
<g id="node68" class="node">
<title>layer1_attn_0_3</title>
<path fill="orange" stroke="black" d="M12597,-567.5C12597,-567.5 12414,-567.5 12414,-567.5 12408,-567.5 12402,-561.5 12402,-555.5 12402,-555.5 12402,-511.5 12402,-511.5 12402,-505.5 12408,-499.5 12414,-499.5 12414,-499.5 12597,-499.5 12597,-499.5 12603,-499.5 12609,-505.5 12609,-511.5 12609,-511.5 12609,-555.5 12609,-555.5 12609,-561.5 12603,-567.5 12597,-567.5"/>
<text text-anchor="middle" x="12505.5" y="-552.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="12505.5" y="-537.3" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="12505.5" y="-522.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="12505.5" y="-507.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer1_q_0_3&#45;&gt;layer1_attn_0_3 -->
<g id="edge81" class="edge">
<title>layer1_q_0_3&#45;&gt;layer1_attn_0_3</title>
<path fill="none" stroke="black" d="M12366.44,-533.5C12374.81,-533.5 12383.17,-533.5 12391.54,-533.5"/>
<polygon fill="black" stroke="black" points="12391.75,-537 12401.75,-533.5 12391.75,-530 12391.75,-537"/>
</g>
<!-- layer1_k_0_3&#45;&gt;layer1_attn_0_3 -->
<g id="edge82" class="edge">
<title>layer1_k_0_3&#45;&gt;layer1_attn_0_3</title>
<path fill="none" stroke="black" d="M12098.38,-575.01C12116.88,-585.43 12137.81,-595.15 12158.5,-600.5 12247.57,-623.51 12275.78,-620.86 12365.5,-600.5 12391.02,-594.71 12417.32,-583.67 12440.14,-572.2"/>
<polygon fill="black" stroke="black" points="12441.75,-575.31 12449.04,-567.62 12438.54,-569.08 12441.75,-575.31"/>
</g>
<!-- layer1_v_0_3&#45;&gt;layer1_attn_0_3 -->
<g id="edge83" class="edge">
<title>layer1_v_0_3&#45;&gt;layer1_attn_0_3</title>
<path fill="none" stroke="black" d="M11873.38,-575.01C11891.88,-585.43 11912.81,-595.15 11933.5,-600.5 12026.45,-624.52 12271.88,-621.75 12365.5,-600.5 12391.02,-594.71 12417.32,-583.67 12440.14,-572.2"/>
<polygon fill="black" stroke="black" points="12441.75,-575.31 12449.04,-567.62 12438.54,-569.08 12441.75,-575.31"/>
</g>
<!-- layer1_attn_1_0 -->
<g id="node69" class="node">
<title>layer1_attn_1_0</title>
<path fill="orange" stroke="black" d="M11497,-567.5C11497,-567.5 11314,-567.5 11314,-567.5 11308,-567.5 11302,-561.5 11302,-555.5 11302,-555.5 11302,-511.5 11302,-511.5 11302,-505.5 11308,-499.5 11314,-499.5 11314,-499.5 11497,-499.5 11497,-499.5 11503,-499.5 11509,-505.5 11509,-511.5 11509,-511.5 11509,-555.5 11509,-555.5 11509,-561.5 11503,-567.5 11497,-567.5"/>
<text text-anchor="middle" x="11405.5" y="-552.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="11405.5" y="-537.3" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="11405.5" y="-522.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="11405.5" y="-507.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_q_1_0&#45;&gt;layer1_attn_1_0 -->
<g id="edge84" class="edge">
<title>layer1_q_1_0&#45;&gt;layer1_attn_1_0</title>
<path fill="none" stroke="black" d="M11266.44,-533.5C11274.81,-533.5 11283.17,-533.5 11291.54,-533.5"/>
<polygon fill="black" stroke="black" points="11291.75,-537 11301.75,-533.5 11291.75,-530 11291.75,-537"/>
</g>
<!-- layer1_k_1_0&#45;&gt;layer1_attn_1_0 -->
<g id="edge85" class="edge">
<title>layer1_k_1_0&#45;&gt;layer1_attn_1_0</title>
<path fill="none" stroke="black" d="M10998.38,-575.01C11016.88,-585.43 11037.81,-595.15 11058.5,-600.5 11147.57,-623.51 11175.78,-620.86 11265.5,-600.5 11291.02,-594.71 11317.32,-583.67 11340.14,-572.2"/>
<polygon fill="black" stroke="black" points="11341.75,-575.31 11349.04,-567.62 11338.54,-569.08 11341.75,-575.31"/>
</g>
<!-- layer1_v_1_0&#45;&gt;layer1_attn_1_0 -->
<g id="edge86" class="edge">
<title>layer1_v_1_0&#45;&gt;layer1_attn_1_0</title>
<path fill="none" stroke="black" d="M10773.38,-575.01C10791.88,-585.43 10812.81,-595.15 10833.5,-600.5 10926.45,-624.52 11171.88,-621.75 11265.5,-600.5 11291.02,-594.71 11317.32,-583.67 11340.14,-572.2"/>
<polygon fill="black" stroke="black" points="11341.75,-575.31 11349.04,-567.62 11338.54,-569.08 11341.75,-575.31"/>
</g>
<!-- layer1_attn_1_1 -->
<g id="node70" class="node">
<title>layer1_attn_1_1</title>
<path fill="orange" stroke="black" d="M10579,-567.5C10579,-567.5 10396,-567.5 10396,-567.5 10390,-567.5 10384,-561.5 10384,-555.5 10384,-555.5 10384,-511.5 10384,-511.5 10384,-505.5 10390,-499.5 10396,-499.5 10396,-499.5 10579,-499.5 10579,-499.5 10585,-499.5 10591,-505.5 10591,-511.5 10591,-511.5 10591,-555.5 10591,-555.5 10591,-561.5 10585,-567.5 10579,-567.5"/>
<text text-anchor="middle" x="10487.5" y="-552.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="10487.5" y="-537.3" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="10487.5" y="-522.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="10487.5" y="-507.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer1_q_1_1&#45;&gt;layer1_attn_1_1 -->
<g id="edge87" class="edge">
<title>layer1_q_1_1&#45;&gt;layer1_attn_1_1</title>
<path fill="none" stroke="black" d="M10348.44,-533.5C10356.81,-533.5 10365.17,-533.5 10373.54,-533.5"/>
<polygon fill="black" stroke="black" points="10373.75,-537 10383.75,-533.5 10373.75,-530 10373.75,-537"/>
</g>
<!-- layer1_k_1_1&#45;&gt;layer1_attn_1_1 -->
<g id="edge88" class="edge">
<title>layer1_k_1_1&#45;&gt;layer1_attn_1_1</title>
<path fill="none" stroke="black" d="M10080.38,-575.01C10098.88,-585.43 10119.81,-595.15 10140.5,-600.5 10229.57,-623.51 10257.78,-620.86 10347.5,-600.5 10373.02,-594.71 10399.32,-583.67 10422.14,-572.2"/>
<polygon fill="black" stroke="black" points="10423.75,-575.31 10431.04,-567.62 10420.54,-569.08 10423.75,-575.31"/>
</g>
<!-- layer1_v_1_1&#45;&gt;layer1_attn_1_1 -->
<g id="edge89" class="edge">
<title>layer1_v_1_1&#45;&gt;layer1_attn_1_1</title>
<path fill="none" stroke="black" d="M9855.38,-575.01C9873.88,-585.43 9894.81,-595.15 9915.5,-600.5 10008.45,-624.52 10253.88,-621.75 10347.5,-600.5 10373.02,-594.71 10399.32,-583.67 10422.14,-572.2"/>
<polygon fill="black" stroke="black" points="10423.75,-575.31 10431.04,-567.62 10420.54,-569.08 10423.75,-575.31"/>
</g>
<!-- layer1_attn_1_2 -->
<g id="node71" class="node">
<title>layer1_attn_1_2</title>
<path fill="orange" stroke="black" d="M9661,-567.5C9661,-567.5 9478,-567.5 9478,-567.5 9472,-567.5 9466,-561.5 9466,-555.5 9466,-555.5 9466,-511.5 9466,-511.5 9466,-505.5 9472,-499.5 9478,-499.5 9478,-499.5 9661,-499.5 9661,-499.5 9667,-499.5 9673,-505.5 9673,-511.5 9673,-511.5 9673,-555.5 9673,-555.5 9673,-561.5 9667,-567.5 9661,-567.5"/>
<text text-anchor="middle" x="9569.5" y="-552.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="9569.5" y="-537.3" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="9569.5" y="-522.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="9569.5" y="-507.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_q_1_2&#45;&gt;layer1_attn_1_2 -->
<g id="edge90" class="edge">
<title>layer1_q_1_2&#45;&gt;layer1_attn_1_2</title>
<path fill="none" stroke="black" d="M9430.44,-533.5C9438.81,-533.5 9447.17,-533.5 9455.54,-533.5"/>
<polygon fill="black" stroke="black" points="9455.75,-537 9465.75,-533.5 9455.75,-530 9455.75,-537"/>
</g>
<!-- layer1_k_1_2&#45;&gt;layer1_attn_1_2 -->
<g id="edge91" class="edge">
<title>layer1_k_1_2&#45;&gt;layer1_attn_1_2</title>
<path fill="none" stroke="black" d="M9162.38,-575.01C9180.88,-585.43 9201.81,-595.15 9222.5,-600.5 9311.57,-623.51 9339.78,-620.86 9429.5,-600.5 9455.02,-594.71 9481.32,-583.67 9504.14,-572.2"/>
<polygon fill="black" stroke="black" points="9505.75,-575.31 9513.04,-567.62 9502.54,-569.08 9505.75,-575.31"/>
</g>
<!-- layer1_v_1_2&#45;&gt;layer1_attn_1_2 -->
<g id="edge92" class="edge">
<title>layer1_v_1_2&#45;&gt;layer1_attn_1_2</title>
<path fill="none" stroke="black" d="M8937.38,-575.01C8955.88,-585.43 8976.81,-595.15 8997.5,-600.5 9090.45,-624.52 9335.88,-621.75 9429.5,-600.5 9455.02,-594.71 9481.32,-583.67 9504.14,-572.2"/>
<polygon fill="black" stroke="black" points="9505.75,-575.31 9513.04,-567.62 9502.54,-569.08 9505.75,-575.31"/>
</g>
<!-- layer1_attn_1_3 -->
<g id="node72" class="node">
<title>layer1_attn_1_3</title>
<path fill="orange" stroke="black" d="M8743,-567.5C8743,-567.5 8560,-567.5 8560,-567.5 8554,-567.5 8548,-561.5 8548,-555.5 8548,-555.5 8548,-511.5 8548,-511.5 8548,-505.5 8554,-499.5 8560,-499.5 8560,-499.5 8743,-499.5 8743,-499.5 8749,-499.5 8755,-505.5 8755,-511.5 8755,-511.5 8755,-555.5 8755,-555.5 8755,-561.5 8749,-567.5 8743,-567.5"/>
<text text-anchor="middle" x="8651.5" y="-552.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8651.5" y="-537.3" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="8651.5" y="-522.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="8651.5" y="-507.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer1_q_1_3&#45;&gt;layer1_attn_1_3 -->
<g id="edge93" class="edge">
<title>layer1_q_1_3&#45;&gt;layer1_attn_1_3</title>
<path fill="none" stroke="black" d="M8512.44,-533.5C8520.81,-533.5 8529.17,-533.5 8537.54,-533.5"/>
<polygon fill="black" stroke="black" points="8537.75,-537 8547.75,-533.5 8537.75,-530 8537.75,-537"/>
</g>
<!-- layer1_k_1_3&#45;&gt;layer1_attn_1_3 -->
<g id="edge94" class="edge">
<title>layer1_k_1_3&#45;&gt;layer1_attn_1_3</title>
<path fill="none" stroke="black" d="M8244.38,-575.01C8262.88,-585.43 8283.81,-595.15 8304.5,-600.5 8393.57,-623.51 8421.78,-620.86 8511.5,-600.5 8537.02,-594.71 8563.32,-583.67 8586.14,-572.2"/>
<polygon fill="black" stroke="black" points="8587.75,-575.31 8595.04,-567.62 8584.54,-569.08 8587.75,-575.31"/>
</g>
<!-- layer1_v_1_3&#45;&gt;layer1_attn_1_3 -->
<g id="edge95" class="edge">
<title>layer1_v_1_3&#45;&gt;layer1_attn_1_3</title>
<path fill="none" stroke="black" d="M8019.38,-575.01C8037.88,-585.43 8058.81,-595.15 8079.5,-600.5 8172.45,-624.52 8417.88,-621.75 8511.5,-600.5 8537.02,-594.71 8563.32,-583.67 8586.14,-572.2"/>
<polygon fill="black" stroke="black" points="8587.75,-575.31 8595.04,-567.62 8584.54,-569.08 8587.75,-575.31"/>
</g>
<!-- layer1_attn_2_0 -->
<g id="node73" class="node">
<title>layer1_attn_2_0</title>
<path fill="orange" stroke="black" d="M7643,-567.5C7643,-567.5 7460,-567.5 7460,-567.5 7454,-567.5 7448,-561.5 7448,-555.5 7448,-555.5 7448,-511.5 7448,-511.5 7448,-505.5 7454,-499.5 7460,-499.5 7460,-499.5 7643,-499.5 7643,-499.5 7649,-499.5 7655,-505.5 7655,-511.5 7655,-511.5 7655,-555.5 7655,-555.5 7655,-561.5 7649,-567.5 7643,-567.5"/>
<text text-anchor="middle" x="7551.5" y="-552.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7551.5" y="-537.3" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="7551.5" y="-522.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="7551.5" y="-507.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_q_2_0&#45;&gt;layer1_attn_2_0 -->
<g id="edge96" class="edge">
<title>layer1_q_2_0&#45;&gt;layer1_attn_2_0</title>
<path fill="none" stroke="black" d="M7412.44,-533.5C7420.81,-533.5 7429.17,-533.5 7437.54,-533.5"/>
<polygon fill="black" stroke="black" points="7437.75,-537 7447.75,-533.5 7437.75,-530 7437.75,-537"/>
</g>
<!-- layer1_k_2_0&#45;&gt;layer1_attn_2_0 -->
<g id="edge97" class="edge">
<title>layer1_k_2_0&#45;&gt;layer1_attn_2_0</title>
<path fill="none" stroke="black" d="M7144.38,-575.01C7162.88,-585.43 7183.81,-595.15 7204.5,-600.5 7293.57,-623.51 7321.78,-620.86 7411.5,-600.5 7437.02,-594.71 7463.32,-583.67 7486.14,-572.2"/>
<polygon fill="black" stroke="black" points="7487.75,-575.31 7495.04,-567.62 7484.54,-569.08 7487.75,-575.31"/>
</g>
<!-- layer1_v_2_0&#45;&gt;layer1_attn_2_0 -->
<g id="edge98" class="edge">
<title>layer1_v_2_0&#45;&gt;layer1_attn_2_0</title>
<path fill="none" stroke="black" d="M6919.38,-575.01C6937.88,-585.43 6958.81,-595.15 6979.5,-600.5 7072.45,-624.52 7317.88,-621.75 7411.5,-600.5 7437.02,-594.71 7463.32,-583.67 7486.14,-572.2"/>
<polygon fill="black" stroke="black" points="7487.75,-575.31 7495.04,-567.62 7484.54,-569.08 7487.75,-575.31"/>
</g>
<!-- layer1_attn_2_1 -->
<g id="node74" class="node">
<title>layer1_attn_2_1</title>
<path fill="orange" stroke="black" d="M6725,-567.5C6725,-567.5 6542,-567.5 6542,-567.5 6536,-567.5 6530,-561.5 6530,-555.5 6530,-555.5 6530,-511.5 6530,-511.5 6530,-505.5 6536,-499.5 6542,-499.5 6542,-499.5 6725,-499.5 6725,-499.5 6731,-499.5 6737,-505.5 6737,-511.5 6737,-511.5 6737,-555.5 6737,-555.5 6737,-561.5 6731,-567.5 6725,-567.5"/>
<text text-anchor="middle" x="6633.5" y="-552.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6633.5" y="-537.3" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="6633.5" y="-522.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="6633.5" y="-507.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer1_q_2_1&#45;&gt;layer1_attn_2_1 -->
<g id="edge99" class="edge">
<title>layer1_q_2_1&#45;&gt;layer1_attn_2_1</title>
<path fill="none" stroke="black" d="M6494.44,-533.5C6502.81,-533.5 6511.17,-533.5 6519.54,-533.5"/>
<polygon fill="black" stroke="black" points="6519.75,-537 6529.75,-533.5 6519.75,-530 6519.75,-537"/>
</g>
<!-- layer1_k_2_1&#45;&gt;layer1_attn_2_1 -->
<g id="edge100" class="edge">
<title>layer1_k_2_1&#45;&gt;layer1_attn_2_1</title>
<path fill="none" stroke="black" d="M6226.38,-575.01C6244.88,-585.43 6265.81,-595.15 6286.5,-600.5 6375.57,-623.51 6403.78,-620.86 6493.5,-600.5 6519.02,-594.71 6545.32,-583.67 6568.14,-572.2"/>
<polygon fill="black" stroke="black" points="6569.75,-575.31 6577.04,-567.62 6566.54,-569.08 6569.75,-575.31"/>
</g>
<!-- layer1_v_2_1&#45;&gt;layer1_attn_2_1 -->
<g id="edge101" class="edge">
<title>layer1_v_2_1&#45;&gt;layer1_attn_2_1</title>
<path fill="none" stroke="black" d="M6001.38,-575.01C6019.88,-585.43 6040.81,-595.15 6061.5,-600.5 6154.45,-624.52 6399.88,-621.75 6493.5,-600.5 6519.02,-594.71 6545.32,-583.67 6568.14,-572.2"/>
<polygon fill="black" stroke="black" points="6569.75,-575.31 6577.04,-567.62 6566.54,-569.08 6569.75,-575.31"/>
</g>
<!-- layer1_attn_2_2 -->
<g id="node75" class="node">
<title>layer1_attn_2_2</title>
<path fill="orange" stroke="black" d="M5807,-567.5C5807,-567.5 5624,-567.5 5624,-567.5 5618,-567.5 5612,-561.5 5612,-555.5 5612,-555.5 5612,-511.5 5612,-511.5 5612,-505.5 5618,-499.5 5624,-499.5 5624,-499.5 5807,-499.5 5807,-499.5 5813,-499.5 5819,-505.5 5819,-511.5 5819,-511.5 5819,-555.5 5819,-555.5 5819,-561.5 5813,-567.5 5807,-567.5"/>
<text text-anchor="middle" x="5715.5" y="-552.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5715.5" y="-537.3" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="5715.5" y="-522.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="5715.5" y="-507.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_q_2_2&#45;&gt;layer1_attn_2_2 -->
<g id="edge102" class="edge">
<title>layer1_q_2_2&#45;&gt;layer1_attn_2_2</title>
<path fill="none" stroke="black" d="M5576.44,-533.5C5584.81,-533.5 5593.17,-533.5 5601.54,-533.5"/>
<polygon fill="black" stroke="black" points="5601.75,-537 5611.75,-533.5 5601.75,-530 5601.75,-537"/>
</g>
<!-- layer1_k_2_2&#45;&gt;layer1_attn_2_2 -->
<g id="edge103" class="edge">
<title>layer1_k_2_2&#45;&gt;layer1_attn_2_2</title>
<path fill="none" stroke="black" d="M5308.38,-575.01C5326.88,-585.43 5347.81,-595.15 5368.5,-600.5 5457.57,-623.51 5485.78,-620.86 5575.5,-600.5 5601.02,-594.71 5627.32,-583.67 5650.14,-572.2"/>
<polygon fill="black" stroke="black" points="5651.75,-575.31 5659.04,-567.62 5648.54,-569.08 5651.75,-575.31"/>
</g>
<!-- layer1_v_2_2&#45;&gt;layer1_attn_2_2 -->
<g id="edge104" class="edge">
<title>layer1_v_2_2&#45;&gt;layer1_attn_2_2</title>
<path fill="none" stroke="black" d="M5083.38,-575.01C5101.88,-585.43 5122.81,-595.15 5143.5,-600.5 5236.45,-624.52 5481.88,-621.75 5575.5,-600.5 5601.02,-594.71 5627.32,-583.67 5650.14,-572.2"/>
<polygon fill="black" stroke="black" points="5651.75,-575.31 5659.04,-567.62 5648.54,-569.08 5651.75,-575.31"/>
</g>
<!-- layer1_attn_2_3 -->
<g id="node76" class="node">
<title>layer1_attn_2_3</title>
<path fill="orange" stroke="black" d="M4889,-567.5C4889,-567.5 4706,-567.5 4706,-567.5 4700,-567.5 4694,-561.5 4694,-555.5 4694,-555.5 4694,-511.5 4694,-511.5 4694,-505.5 4700,-499.5 4706,-499.5 4706,-499.5 4889,-499.5 4889,-499.5 4895,-499.5 4901,-505.5 4901,-511.5 4901,-511.5 4901,-555.5 4901,-555.5 4901,-561.5 4895,-567.5 4889,-567.5"/>
<text text-anchor="middle" x="4797.5" y="-552.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4797.5" y="-537.3" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="4797.5" y="-522.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="4797.5" y="-507.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer1_q_2_3&#45;&gt;layer1_attn_2_3 -->
<g id="edge105" class="edge">
<title>layer1_q_2_3&#45;&gt;layer1_attn_2_3</title>
<path fill="none" stroke="black" d="M4658.44,-533.5C4666.81,-533.5 4675.17,-533.5 4683.54,-533.5"/>
<polygon fill="black" stroke="black" points="4683.75,-537 4693.75,-533.5 4683.75,-530 4683.75,-537"/>
</g>
<!-- layer1_k_2_3&#45;&gt;layer1_attn_2_3 -->
<g id="edge106" class="edge">
<title>layer1_k_2_3&#45;&gt;layer1_attn_2_3</title>
<path fill="none" stroke="black" d="M4390.38,-575.01C4408.88,-585.43 4429.81,-595.15 4450.5,-600.5 4539.57,-623.51 4567.78,-620.86 4657.5,-600.5 4683.02,-594.71 4709.32,-583.67 4732.14,-572.2"/>
<polygon fill="black" stroke="black" points="4733.75,-575.31 4741.04,-567.62 4730.54,-569.08 4733.75,-575.31"/>
</g>
<!-- layer1_v_2_3&#45;&gt;layer1_attn_2_3 -->
<g id="edge107" class="edge">
<title>layer1_v_2_3&#45;&gt;layer1_attn_2_3</title>
<path fill="none" stroke="black" d="M4165.38,-575.01C4183.88,-585.43 4204.81,-595.15 4225.5,-600.5 4318.45,-624.52 4563.88,-621.75 4657.5,-600.5 4683.02,-594.71 4709.32,-583.67 4732.14,-572.2"/>
<polygon fill="black" stroke="black" points="4733.75,-575.31 4741.04,-567.62 4730.54,-569.08 4733.75,-575.31"/>
</g>
<!-- layer1_attn_3_0 -->
<g id="node77" class="node">
<title>layer1_attn_3_0</title>
<path fill="orange" stroke="black" d="M3789,-567.5C3789,-567.5 3606,-567.5 3606,-567.5 3600,-567.5 3594,-561.5 3594,-555.5 3594,-555.5 3594,-511.5 3594,-511.5 3594,-505.5 3600,-499.5 3606,-499.5 3606,-499.5 3789,-499.5 3789,-499.5 3795,-499.5 3801,-505.5 3801,-511.5 3801,-511.5 3801,-555.5 3801,-555.5 3801,-561.5 3795,-567.5 3789,-567.5"/>
<text text-anchor="middle" x="3697.5" y="-552.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3697.5" y="-537.3" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="3697.5" y="-522.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="3697.5" y="-507.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_q_3_0&#45;&gt;layer1_attn_3_0 -->
<g id="edge108" class="edge">
<title>layer1_q_3_0&#45;&gt;layer1_attn_3_0</title>
<path fill="none" stroke="black" d="M3558.44,-533.5C3566.81,-533.5 3575.17,-533.5 3583.54,-533.5"/>
<polygon fill="black" stroke="black" points="3583.75,-537 3593.75,-533.5 3583.75,-530 3583.75,-537"/>
</g>
<!-- layer1_k_3_0&#45;&gt;layer1_attn_3_0 -->
<g id="edge109" class="edge">
<title>layer1_k_3_0&#45;&gt;layer1_attn_3_0</title>
<path fill="none" stroke="black" d="M3290.38,-575.01C3308.88,-585.43 3329.81,-595.15 3350.5,-600.5 3439.57,-623.51 3467.78,-620.86 3557.5,-600.5 3583.02,-594.71 3609.32,-583.67 3632.14,-572.2"/>
<polygon fill="black" stroke="black" points="3633.75,-575.31 3641.04,-567.62 3630.54,-569.08 3633.75,-575.31"/>
</g>
<!-- layer1_v_3_0&#45;&gt;layer1_attn_3_0 -->
<g id="edge110" class="edge">
<title>layer1_v_3_0&#45;&gt;layer1_attn_3_0</title>
<path fill="none" stroke="black" d="M3065.38,-575.01C3083.88,-585.43 3104.81,-595.15 3125.5,-600.5 3218.45,-624.52 3463.88,-621.75 3557.5,-600.5 3583.02,-594.71 3609.32,-583.67 3632.14,-572.2"/>
<polygon fill="black" stroke="black" points="3633.75,-575.31 3641.04,-567.62 3630.54,-569.08 3633.75,-575.31"/>
</g>
<!-- layer1_attn_3_1 -->
<g id="node78" class="node">
<title>layer1_attn_3_1</title>
<path fill="orange" stroke="black" d="M2871,-567.5C2871,-567.5 2688,-567.5 2688,-567.5 2682,-567.5 2676,-561.5 2676,-555.5 2676,-555.5 2676,-511.5 2676,-511.5 2676,-505.5 2682,-499.5 2688,-499.5 2688,-499.5 2871,-499.5 2871,-499.5 2877,-499.5 2883,-505.5 2883,-511.5 2883,-511.5 2883,-555.5 2883,-555.5 2883,-561.5 2877,-567.5 2871,-567.5"/>
<text text-anchor="middle" x="2779.5" y="-552.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="2779.5" y="-537.3" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="2779.5" y="-522.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="2779.5" y="-507.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer1_q_3_1&#45;&gt;layer1_attn_3_1 -->
<g id="edge111" class="edge">
<title>layer1_q_3_1&#45;&gt;layer1_attn_3_1</title>
<path fill="none" stroke="black" d="M2640.44,-533.5C2648.81,-533.5 2657.17,-533.5 2665.54,-533.5"/>
<polygon fill="black" stroke="black" points="2665.75,-537 2675.75,-533.5 2665.75,-530 2665.75,-537"/>
</g>
<!-- layer1_k_3_1&#45;&gt;layer1_attn_3_1 -->
<g id="edge112" class="edge">
<title>layer1_k_3_1&#45;&gt;layer1_attn_3_1</title>
<path fill="none" stroke="black" d="M2372.38,-575.01C2390.88,-585.43 2411.81,-595.15 2432.5,-600.5 2521.57,-623.51 2549.78,-620.86 2639.5,-600.5 2665.02,-594.71 2691.32,-583.67 2714.14,-572.2"/>
<polygon fill="black" stroke="black" points="2715.75,-575.31 2723.04,-567.62 2712.54,-569.08 2715.75,-575.31"/>
</g>
<!-- layer1_v_3_1&#45;&gt;layer1_attn_3_1 -->
<g id="edge113" class="edge">
<title>layer1_v_3_1&#45;&gt;layer1_attn_3_1</title>
<path fill="none" stroke="black" d="M2147.38,-575.01C2165.88,-585.43 2186.81,-595.15 2207.5,-600.5 2300.45,-624.52 2545.88,-621.75 2639.5,-600.5 2665.02,-594.71 2691.32,-583.67 2714.14,-572.2"/>
<polygon fill="black" stroke="black" points="2715.75,-575.31 2723.04,-567.62 2712.54,-569.08 2715.75,-575.31"/>
</g>
<!-- layer1_attn_3_2 -->
<g id="node79" class="node">
<title>layer1_attn_3_2</title>
<path fill="orange" stroke="black" d="M1953,-567.5C1953,-567.5 1770,-567.5 1770,-567.5 1764,-567.5 1758,-561.5 1758,-555.5 1758,-555.5 1758,-511.5 1758,-511.5 1758,-505.5 1764,-499.5 1770,-499.5 1770,-499.5 1953,-499.5 1953,-499.5 1959,-499.5 1965,-505.5 1965,-511.5 1965,-511.5 1965,-555.5 1965,-555.5 1965,-561.5 1959,-567.5 1953,-567.5"/>
<text text-anchor="middle" x="1861.5" y="-552.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="1861.5" y="-537.3" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="1861.5" y="-522.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="1861.5" y="-507.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_q_3_2&#45;&gt;layer1_attn_3_2 -->
<g id="edge114" class="edge">
<title>layer1_q_3_2&#45;&gt;layer1_attn_3_2</title>
<path fill="none" stroke="black" d="M1722.44,-533.5C1730.81,-533.5 1739.17,-533.5 1747.54,-533.5"/>
<polygon fill="black" stroke="black" points="1747.75,-537 1757.75,-533.5 1747.75,-530 1747.75,-537"/>
</g>
<!-- layer1_k_3_2&#45;&gt;layer1_attn_3_2 -->
<g id="edge115" class="edge">
<title>layer1_k_3_2&#45;&gt;layer1_attn_3_2</title>
<path fill="none" stroke="black" d="M1454.38,-575.01C1472.88,-585.43 1493.81,-595.15 1514.5,-600.5 1603.57,-623.51 1631.78,-620.86 1721.5,-600.5 1747.02,-594.71 1773.32,-583.67 1796.14,-572.2"/>
<polygon fill="black" stroke="black" points="1797.75,-575.31 1805.04,-567.62 1794.54,-569.08 1797.75,-575.31"/>
</g>
<!-- layer1_v_3_2&#45;&gt;layer1_attn_3_2 -->
<g id="edge116" class="edge">
<title>layer1_v_3_2&#45;&gt;layer1_attn_3_2</title>
<path fill="none" stroke="black" d="M1229.38,-575.01C1247.88,-585.43 1268.81,-595.15 1289.5,-600.5 1382.45,-624.52 1627.88,-621.75 1721.5,-600.5 1747.02,-594.71 1773.32,-583.67 1796.14,-572.2"/>
<polygon fill="black" stroke="black" points="1797.75,-575.31 1805.04,-567.62 1794.54,-569.08 1797.75,-575.31"/>
</g>
<!-- layer1_attn_3_3 -->
<g id="node80" class="node">
<title>layer1_attn_3_3</title>
<path fill="orange" stroke="black" d="M1035,-567.5C1035,-567.5 852,-567.5 852,-567.5 846,-567.5 840,-561.5 840,-555.5 840,-555.5 840,-511.5 840,-511.5 840,-505.5 846,-499.5 852,-499.5 852,-499.5 1035,-499.5 1035,-499.5 1041,-499.5 1047,-505.5 1047,-511.5 1047,-511.5 1047,-555.5 1047,-555.5 1047,-561.5 1041,-567.5 1035,-567.5"/>
<text text-anchor="middle" x="943.5" y="-552.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="943.5" y="-537.3" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="943.5" y="-522.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="943.5" y="-507.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer1_q_3_3&#45;&gt;layer1_attn_3_3 -->
<g id="edge117" class="edge">
<title>layer1_q_3_3&#45;&gt;layer1_attn_3_3</title>
<path fill="none" stroke="black" d="M804.44,-533.5C812.81,-533.5 821.17,-533.5 829.54,-533.5"/>
<polygon fill="black" stroke="black" points="829.75,-537 839.75,-533.5 829.75,-530 829.75,-537"/>
</g>
<!-- layer1_k_3_3&#45;&gt;layer1_attn_3_3 -->
<g id="edge118" class="edge">
<title>layer1_k_3_3&#45;&gt;layer1_attn_3_3</title>
<path fill="none" stroke="black" d="M536.38,-575.01C554.88,-585.43 575.81,-595.15 596.5,-600.5 685.57,-623.51 713.78,-620.86 803.5,-600.5 829.02,-594.71 855.32,-583.67 878.14,-572.2"/>
<polygon fill="black" stroke="black" points="879.75,-575.31 887.04,-567.62 876.54,-569.08 879.75,-575.31"/>
</g>
<!-- layer1_v_3_3&#45;&gt;layer1_attn_3_3 -->
<g id="edge119" class="edge">
<title>layer1_v_3_3&#45;&gt;layer1_attn_3_3</title>
<path fill="none" stroke="black" d="M311.38,-575.01C329.88,-585.43 350.81,-595.15 371.5,-600.5 464.45,-624.52 709.88,-621.75 803.5,-600.5 829.02,-594.71 855.32,-583.67 878.14,-572.2"/>
<polygon fill="black" stroke="black" points="879.75,-575.31 887.04,-567.62 876.54,-569.08 879.75,-575.31"/>
</g>
<!-- layer1_out_proj -->
<g id="node51" class="node">
<title>layer1_out_proj</title>
<path fill="lightcoral" stroke="black" d="M15912.5,-567.5C15912.5,-567.5 15792.5,-567.5 15792.5,-567.5 15786.5,-567.5 15780.5,-561.5 15780.5,-555.5 15780.5,-555.5 15780.5,-511.5 15780.5,-511.5 15780.5,-505.5 15786.5,-499.5 15792.5,-499.5 15792.5,-499.5 15912.5,-499.5 15912.5,-499.5 15918.5,-499.5 15924.5,-505.5 15924.5,-511.5 15924.5,-511.5 15924.5,-555.5 15924.5,-555.5 15924.5,-561.5 15918.5,-567.5 15912.5,-567.5"/>
<text text-anchor="middle" x="15852.5" y="-552.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15852.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="15852.5" y="-522.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="15852.5" y="-507.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer1_out_proj&#45;&gt;layer1_residual1 -->
<g id="edge50" class="edge">
<title>layer1_out_proj&#45;&gt;layer1_residual1</title>
<path fill="none" stroke="black" d="M15924.55,-533.5C15933.08,-533.5 15941.6,-533.5 15950.13,-533.5"/>
<polygon fill="black" stroke="black" points="15950.13,-537 15960.13,-533.5 15950.13,-530 15950.13,-537"/>
</g>
<!-- layer1_ln2 -->
<g id="node53" class="node">
<title>layer1_ln2</title>
<path fill="lightyellow" stroke="black" d="M16219,-560C16219,-560 16132,-560 16132,-560 16126,-560 16120,-554 16120,-548 16120,-548 16120,-519 16120,-519 16120,-513 16126,-507 16132,-507 16132,-507 16219,-507 16219,-507 16225,-507 16231,-513 16231,-519 16231,-519 16231,-548 16231,-548 16231,-554 16225,-560 16219,-560"/>
<text text-anchor="middle" x="16175.5" y="-544.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="16175.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="16175.5" y="-514.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_residual1&#45;&gt;layer1_ln2 -->
<g id="edge52" class="edge">
<title>layer1_residual1&#45;&gt;layer1_ln2</title>
<path fill="none" stroke="black" d="M16084.66,-533.5C16092.98,-533.5 16101.31,-533.5 16109.63,-533.5"/>
<polygon fill="black" stroke="black" points="16109.79,-537 16119.79,-533.5 16109.79,-530 16109.79,-537"/>
</g>
<!-- layer1_residual2 -->
<g id="node64" class="node">
<title>layer1_residual2</title>
<path fill="lightgreen" stroke="black" d="M23270.5,-560C23270.5,-560 23170.5,-560 23170.5,-560 23164.5,-560 23158.5,-554 23158.5,-548 23158.5,-548 23158.5,-519 23158.5,-519 23158.5,-513 23164.5,-507 23170.5,-507 23170.5,-507 23270.5,-507 23270.5,-507 23276.5,-507 23282.5,-513 23282.5,-519 23282.5,-519 23282.5,-548 23282.5,-548 23282.5,-554 23276.5,-560 23270.5,-560"/>
<text text-anchor="middle" x="23220.5" y="-544.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="23220.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="23220.5" y="-514.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_residual1&#45;&gt;layer1_residual2 -->
<g id="edge71" class="edge">
<title>layer1_residual1&#45;&gt;layer1_residual2</title>
<path fill="none" stroke="black" d="M16050.99,-560.11C16069.1,-575.16 16093.9,-592.52 16119.5,-600.5 16212.36,-629.45 23029.58,-629.23 23122.5,-600.5 23144.67,-593.65 23166.29,-579.86 23183.56,-566.57"/>
<polygon fill="black" stroke="black" points="23186.03,-569.08 23191.67,-560.12 23181.67,-563.61 23186.03,-569.08"/>
</g>
<!-- layer1_router -->
<g id="node54" class="node">
<title>layer1_router</title>
<path fill="gold" stroke="black" d="M16434,-567.5C16434,-567.5 16279,-567.5 16279,-567.5 16273,-567.5 16267,-561.5 16267,-555.5 16267,-555.5 16267,-511.5 16267,-511.5 16267,-505.5 16273,-499.5 16279,-499.5 16279,-499.5 16434,-499.5 16434,-499.5 16440,-499.5 16446,-505.5 16446,-511.5 16446,-511.5 16446,-555.5 16446,-555.5 16446,-561.5 16440,-567.5 16434,-567.5"/>
<text text-anchor="middle" x="16356.5" y="-552.3" font-family="Times,serif" font-size="14.00">MoE Router</text>
<text text-anchor="middle" x="16356.5" y="-537.3" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="16356.5" y="-522.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]  [B, L, 8]</text>
<text text-anchor="middle" x="16356.5" y="-507.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_ln2&#45;&gt;layer1_router -->
<g id="edge53" class="edge">
<title>layer1_ln2&#45;&gt;layer1_router</title>
<path fill="none" stroke="black" d="M16231,-533.5C16239.58,-533.5 16248.15,-533.5 16256.72,-533.5"/>
<polygon fill="black" stroke="black" points="16256.79,-537 16266.79,-533.5 16256.79,-530 16256.79,-537"/>
</g>
<!-- layer1_expert_0_gate -->
<g id="node55" class="node">
<title>layer1_expert_0_gate</title>
<path fill="lightyellow" stroke="black" d="M22267,-560C22267,-560 22174,-560 22174,-560 22168,-560 22162,-554 22162,-548 22162,-548 22162,-519 22162,-519 22162,-513 22168,-507 22174,-507 22174,-507 22267,-507 22267,-507 22273,-507 22279,-513 22279,-519 22279,-519 22279,-548 22279,-548 22279,-554 22273,-560 22267,-560"/>
<text text-anchor="middle" x="22220.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="22220.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="22220.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_ln2&#45;&gt;layer1_expert_0_gate -->
<g id="edge55" class="edge">
<title>layer1_ln2&#45;&gt;layer1_expert_0_gate</title>
<path fill="none" stroke="black" d="M16201.94,-560.09C16218.83,-575.12 16242.08,-592.48 16266.5,-600.5 16344.05,-625.97 22067.05,-629.1 22143.5,-600.5 22161.67,-593.7 22178.39,-580.46 22191.57,-567.53"/>
<polygon fill="black" stroke="black" points="22194.43,-569.61 22198.9,-560 22189.42,-564.72 22194.43,-569.61"/>
</g>
<!-- layer1_expert_1_gate -->
<g id="node56" class="node">
<title>layer1_expert_1_gate</title>
<path fill="lightyellow" stroke="black" d="M21466,-560C21466,-560 21373,-560 21373,-560 21367,-560 21361,-554 21361,-548 21361,-548 21361,-519 21361,-519 21361,-513 21367,-507 21373,-507 21373,-507 21466,-507 21466,-507 21472,-507 21478,-513 21478,-519 21478,-519 21478,-548 21478,-548 21478,-554 21472,-560 21466,-560"/>
<text text-anchor="middle" x="21419.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="21419.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="21419.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_ln2&#45;&gt;layer1_expert_1_gate -->
<g id="edge57" class="edge">
<title>layer1_ln2&#45;&gt;layer1_expert_1_gate</title>
<path fill="none" stroke="black" d="M16201.94,-560.09C16218.83,-575.12 16242.08,-592.48 16266.5,-600.5 16333.48,-622.5 21276.47,-625.21 21342.5,-600.5 21360.67,-593.7 21377.39,-580.46 21390.57,-567.53"/>
<polygon fill="black" stroke="black" points="21393.43,-569.61 21397.9,-560 21388.42,-564.72 21393.43,-569.61"/>
</g>
<!-- layer1_expert_2_gate -->
<g id="node57" class="node">
<title>layer1_expert_2_gate</title>
<path fill="lightyellow" stroke="black" d="M20665,-560C20665,-560 20572,-560 20572,-560 20566,-560 20560,-554 20560,-548 20560,-548 20560,-519 20560,-519 20560,-513 20566,-507 20572,-507 20572,-507 20665,-507 20665,-507 20671,-507 20677,-513 20677,-519 20677,-519 20677,-548 20677,-548 20677,-554 20671,-560 20665,-560"/>
<text text-anchor="middle" x="20618.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="20618.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="20618.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_ln2&#45;&gt;layer1_expert_2_gate -->
<g id="edge59" class="edge">
<title>layer1_ln2&#45;&gt;layer1_expert_2_gate</title>
<path fill="none" stroke="black" d="M16201.94,-560.09C16218.83,-575.12 16242.08,-592.48 16266.5,-600.5 16322.91,-619.03 20485.89,-621.31 20541.5,-600.5 20559.67,-593.7 20576.39,-580.46 20589.57,-567.53"/>
<polygon fill="black" stroke="black" points="20592.43,-569.61 20596.9,-560 20587.42,-564.72 20592.43,-569.61"/>
</g>
<!-- layer1_expert_3_gate -->
<g id="node58" class="node">
<title>layer1_expert_3_gate</title>
<path fill="lightyellow" stroke="black" d="M19864,-560C19864,-560 19771,-560 19771,-560 19765,-560 19759,-554 19759,-548 19759,-548 19759,-519 19759,-519 19759,-513 19765,-507 19771,-507 19771,-507 19864,-507 19864,-507 19870,-507 19876,-513 19876,-519 19876,-519 19876,-548 19876,-548 19876,-554 19870,-560 19864,-560"/>
<text text-anchor="middle" x="19817.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="19817.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="19817.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_ln2&#45;&gt;layer1_expert_3_gate -->
<g id="edge61" class="edge">
<title>layer1_ln2&#45;&gt;layer1_expert_3_gate</title>
<path fill="none" stroke="black" d="M16201.94,-560.09C16218.83,-575.12 16242.08,-592.48 16266.5,-600.5 16358.18,-630.61 19650.12,-634.32 19740.5,-600.5 19758.67,-593.7 19775.39,-580.46 19788.57,-567.53"/>
<polygon fill="black" stroke="black" points="19791.43,-569.61 19795.9,-560 19786.42,-564.72 19791.43,-569.61"/>
</g>
<!-- layer1_expert_4_gate -->
<g id="node59" class="node">
<title>layer1_expert_4_gate</title>
<path fill="lightyellow" stroke="black" d="M19063,-560C19063,-560 18970,-560 18970,-560 18964,-560 18958,-554 18958,-548 18958,-548 18958,-519 18958,-519 18958,-513 18964,-507 18970,-507 18970,-507 19063,-507 19063,-507 19069,-507 19075,-513 19075,-519 19075,-519 19075,-548 19075,-548 19075,-554 19069,-560 19063,-560"/>
<text text-anchor="middle" x="19016.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="19016.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="19016.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_ln2&#45;&gt;layer1_expert_4_gate -->
<g id="edge63" class="edge">
<title>layer1_ln2&#45;&gt;layer1_expert_4_gate</title>
<path fill="none" stroke="black" d="M16201.94,-560.09C16218.83,-575.12 16242.08,-592.48 16266.5,-600.5 16337.04,-623.67 18869.96,-626.52 18939.5,-600.5 18957.67,-593.7 18974.39,-580.46 18987.57,-567.53"/>
<polygon fill="black" stroke="black" points="18990.43,-569.61 18994.9,-560 18985.42,-564.72 18990.43,-569.61"/>
</g>
<!-- layer1_expert_5_gate -->
<g id="node60" class="node">
<title>layer1_expert_5_gate</title>
<path fill="lightyellow" stroke="black" d="M18262,-560C18262,-560 18169,-560 18169,-560 18163,-560 18157,-554 18157,-548 18157,-548 18157,-519 18157,-519 18157,-513 18163,-507 18169,-507 18169,-507 18262,-507 18262,-507 18268,-507 18274,-513 18274,-519 18274,-519 18274,-548 18274,-548 18274,-554 18268,-560 18262,-560"/>
<text text-anchor="middle" x="18215.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="18215.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="18215.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_ln2&#45;&gt;layer1_expert_5_gate -->
<g id="edge65" class="edge">
<title>layer1_ln2&#45;&gt;layer1_expert_5_gate</title>
<path fill="none" stroke="black" d="M16201.94,-560.09C16218.83,-575.12 16242.08,-592.48 16266.5,-600.5 16315.9,-616.73 18089.8,-618.72 18138.5,-600.5 18156.67,-593.7 18173.39,-580.46 18186.57,-567.53"/>
<polygon fill="black" stroke="black" points="18189.43,-569.61 18193.9,-560 18184.42,-564.72 18189.43,-569.61"/>
</g>
<!-- layer1_expert_6_gate -->
<g id="node61" class="node">
<title>layer1_expert_6_gate</title>
<path fill="lightyellow" stroke="black" d="M17461,-560C17461,-560 17368,-560 17368,-560 17362,-560 17356,-554 17356,-548 17356,-548 17356,-519 17356,-519 17356,-513 17362,-507 17368,-507 17368,-507 17461,-507 17461,-507 17467,-507 17473,-513 17473,-519 17473,-519 17473,-548 17473,-548 17473,-554 17467,-560 17461,-560"/>
<text text-anchor="middle" x="17414.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="17414.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="17414.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_ln2&#45;&gt;layer1_expert_6_gate -->
<g id="edge67" class="edge">
<title>layer1_ln2&#45;&gt;layer1_expert_6_gate</title>
<path fill="none" stroke="black" d="M16201.94,-560.09C16218.83,-575.12 16242.08,-592.48 16266.5,-600.5 16323.03,-619.07 17281.77,-621.35 17337.5,-600.5 17355.67,-593.7 17372.39,-580.46 17385.57,-567.53"/>
<polygon fill="black" stroke="black" points="17388.43,-569.61 17392.9,-560 17383.42,-564.72 17388.43,-569.61"/>
</g>
<!-- layer1_expert_7_gate -->
<g id="node62" class="node">
<title>layer1_expert_7_gate</title>
<path fill="lightyellow" stroke="black" d="M16660,-560C16660,-560 16567,-560 16567,-560 16561,-560 16555,-554 16555,-548 16555,-548 16555,-519 16555,-519 16555,-513 16561,-507 16567,-507 16567,-507 16660,-507 16660,-507 16666,-507 16672,-513 16672,-519 16672,-519 16672,-548 16672,-548 16672,-554 16666,-560 16660,-560"/>
<text text-anchor="middle" x="16613.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="16613.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="16613.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_ln2&#45;&gt;layer1_expert_7_gate -->
<g id="edge69" class="edge">
<title>layer1_ln2&#45;&gt;layer1_expert_7_gate</title>
<path fill="none" stroke="black" d="M16201.94,-560.09C16218.83,-575.12 16242.08,-592.48 16266.5,-600.5 16342.08,-625.32 16367.37,-615.5 16445.5,-600.5 16482.25,-593.44 16521.19,-578.44 16552.32,-564.41"/>
<polygon fill="black" stroke="black" points="16554.09,-567.45 16561.72,-560.1 16551.17,-561.09 16554.09,-567.45"/>
</g>
<!-- layer1_router&#45;&gt;layer1_expert_0_gate -->
<g id="edge54" class="edge">
<title>layer1_router&#45;&gt;layer1_expert_0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16437.33,-567.52C16472.63,-580.61 16514.93,-593.99 16554.5,-600.5 16631.09,-613.11 22070.8,-627.7 22143.5,-600.5 22161.67,-593.7 22178.39,-580.46 22191.57,-567.53"/>
<polygon fill="black" stroke="black" points="22194.43,-569.61 22198.9,-560 22189.42,-564.72 22194.43,-569.61"/>
</g>
<!-- layer1_router&#45;&gt;layer1_expert_0_gate -->
<g id="edge145" class="edge">
<title>layer1_router&#45;&gt;layer1_expert_0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16446.26,-567.5C17164.61,-567.5 21958.36,-567.5 22210.2,-567.5"/>
<polygon fill="black" stroke="black" points="22210.44,-571 22220.44,-567.5 22210.44,-564 22210.44,-571"/>
<text text-anchor="middle" x="16356.5" y="-529.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert_1_gate -->
<g id="edge56" class="edge">
<title>layer1_router&#45;&gt;layer1_expert_1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16437.33,-567.52C16472.63,-580.61 16514.93,-593.99 16554.5,-600.5 16620.12,-611.3 21280.22,-623.8 21342.5,-600.5 21360.67,-593.7 21377.39,-580.46 21390.57,-567.53"/>
<polygon fill="black" stroke="black" points="21393.43,-569.61 21397.9,-560 21388.42,-564.72 21393.43,-569.61"/>
</g>
<!-- layer1_router&#45;&gt;layer1_expert_1_gate -->
<g id="edge150" class="edge">
<title>layer1_router&#45;&gt;layer1_expert_1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16446.26,-567.5C17105.49,-567.5 21179.57,-567.5 21409.38,-567.5"/>
<polygon fill="black" stroke="black" points="21409.45,-571 21419.45,-567.5 21409.45,-564 21409.45,-571"/>
<text text-anchor="middle" x="16356.5" y="-529.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert_2_gate -->
<g id="edge58" class="edge">
<title>layer1_router&#45;&gt;layer1_expert_2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16437.33,-567.52C16472.63,-580.61 16514.93,-593.99 16554.5,-600.5 16663.78,-618.49 20437.77,-639.31 20541.5,-600.5 20559.67,-593.7 20576.39,-580.46 20589.57,-567.53"/>
<polygon fill="black" stroke="black" points="20592.43,-569.61 20596.9,-560 20587.42,-564.72 20592.43,-569.61"/>
</g>
<!-- layer1_router&#45;&gt;layer1_expert_2_gate -->
<g id="edge155" class="edge">
<title>layer1_router&#45;&gt;layer1_expert_2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16446.01,-567.5C17040.05,-567.5 20396.3,-567.5 20608.02,-567.5"/>
<polygon fill="black" stroke="black" points="20608.34,-571 20618.34,-567.5 20608.34,-564 20608.34,-571"/>
<text text-anchor="middle" x="16356.5" y="-529.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert_3_gate -->
<g id="edge60" class="edge">
<title>layer1_router&#45;&gt;layer1_expert_3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16437.33,-567.52C16472.63,-580.61 16514.93,-593.99 16554.5,-600.5 16641.82,-614.87 19657.61,-631.51 19740.5,-600.5 19758.67,-593.7 19775.39,-580.46 19788.57,-567.53"/>
<polygon fill="black" stroke="black" points="19791.43,-569.61 19795.9,-560 19786.42,-564.72 19791.43,-569.61"/>
</g>
<!-- layer1_router&#45;&gt;layer1_expert_3_gate -->
<g id="edge160" class="edge">
<title>layer1_router&#45;&gt;layer1_expert_3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16446.41,-567.5C16971.26,-567.5 19622.21,-567.5 19807.31,-567.5"/>
<polygon fill="black" stroke="black" points="19807.37,-571 19817.37,-567.5 19807.37,-564 19807.37,-571"/>
<text text-anchor="middle" x="16356.5" y="-529.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert_4_gate -->
<g id="edge62" class="edge">
<title>layer1_router&#45;&gt;layer1_expert_4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16437.33,-567.52C16472.63,-580.61 16514.93,-593.99 16554.5,-600.5 16619.87,-611.26 18877.45,-623.72 18939.5,-600.5 18957.67,-593.7 18974.39,-580.46 18987.57,-567.53"/>
<polygon fill="black" stroke="black" points="18990.43,-569.61 18994.9,-560 18985.42,-564.72 18990.43,-569.61"/>
</g>
<!-- layer1_router&#45;&gt;layer1_expert_4_gate -->
<g id="edge165" class="edge">
<title>layer1_router&#45;&gt;layer1_expert_4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16446.14,-567.5C16891.06,-567.5 18847.06,-567.5 19006.2,-567.5"/>
<polygon fill="black" stroke="black" points="19006.4,-571 19016.4,-567.5 19006.4,-564 19006.4,-571"/>
<text text-anchor="middle" x="16356.5" y="-529.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert_5_gate -->
<g id="edge64" class="edge">
<title>layer1_router&#45;&gt;layer1_expert_5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16437.33,-567.52C16472.63,-580.61 16514.93,-593.99 16554.5,-600.5 16641.33,-614.79 18056.08,-631.34 18138.5,-600.5 18156.67,-593.7 18173.39,-580.46 18186.57,-567.53"/>
<polygon fill="black" stroke="black" points="18189.43,-569.61 18193.9,-560 18184.42,-564.72 18189.43,-569.61"/>
</g>
<!-- layer1_router&#45;&gt;layer1_expert_5_gate -->
<g id="edge170" class="edge">
<title>layer1_router&#45;&gt;layer1_expert_5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16446.16,-567.5C16798.72,-567.5 18076.66,-567.5 18205.08,-567.5"/>
<polygon fill="black" stroke="black" points="18205.44,-571 18215.44,-567.5 18205.44,-564 18205.44,-571"/>
<text text-anchor="middle" x="16356.5" y="-529.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert_6_gate -->
<g id="edge66" class="edge">
<title>layer1_router&#45;&gt;layer1_expert_6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16437.33,-567.52C16472.63,-580.61 16514.93,-593.99 16554.5,-600.5 16640.34,-614.63 17256.02,-630.99 17337.5,-600.5 17355.67,-593.7 17372.39,-580.46 17385.57,-567.53"/>
<polygon fill="black" stroke="black" points="17388.43,-569.61 17392.9,-560 17383.42,-564.72 17388.43,-569.61"/>
</g>
<!-- layer1_router&#45;&gt;layer1_expert_6_gate -->
<g id="edge175" class="edge">
<title>layer1_router&#45;&gt;layer1_expert_6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16446.25,-567.5C16683.63,-567.5 17315.87,-567.5 17404.2,-567.5"/>
<polygon fill="black" stroke="black" points="17404.37,-571 17414.37,-567.5 17404.37,-564 17404.37,-571"/>
<text text-anchor="middle" x="16356.5" y="-529.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer1_router&#45;&gt;layer1_expert_7_gate -->
<g id="edge68" class="edge">
<title>layer1_router&#45;&gt;layer1_expert_7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16446.14,-530.74C16469.73,-530.32 16495.16,-530.13 16518.67,-530.5 16527.07,-530.63 16535.89,-530.83 16544.63,-531.07"/>
<polygon fill="black" stroke="black" points="16544.73,-534.57 16554.82,-531.35 16544.93,-527.57 16544.73,-534.57"/>
</g>
<!-- layer1_router&#45;&gt;layer1_expert_7_gate -->
<g id="edge180" class="edge">
<title>layer1_router&#45;&gt;layer1_expert_7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16446.03,-533.5C16478.43,-533.5 16514.49,-533.5 16544.83,-533.5"/>
<polygon fill="black" stroke="black" points="16544.88,-537 16554.88,-533.5 16544.88,-530 16544.88,-537"/>
<text text-anchor="middle" x="16500.5" y="-540.3" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer1_expert_0_up -->
<g id="node86" class="node">
<title>layer1_expert_0_up</title>
<path fill="lightcoral" stroke="black" d="M22442.5,-567.5C22442.5,-567.5 22326.5,-567.5 22326.5,-567.5 22320.5,-567.5 22314.5,-561.5 22314.5,-555.5 22314.5,-555.5 22314.5,-511.5 22314.5,-511.5 22314.5,-505.5 22320.5,-499.5 22326.5,-499.5 22326.5,-499.5 22442.5,-499.5 22442.5,-499.5 22448.5,-499.5 22454.5,-505.5 22454.5,-511.5 22454.5,-511.5 22454.5,-555.5 22454.5,-555.5 22454.5,-561.5 22448.5,-567.5 22442.5,-567.5"/>
<text text-anchor="middle" x="22384.5" y="-552.3" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="22384.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="22384.5" y="-522.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="22384.5" y="-507.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_expert_0_gate&#45;&gt;layer1_expert_0_up -->
<g id="edge141" class="edge">
<title>layer1_expert_0_gate&#45;&gt;layer1_expert_0_up</title>
<path fill="none" stroke="black" d="M22279.12,-533.5C22287.41,-533.5 22295.7,-533.5 22303.99,-533.5"/>
<polygon fill="black" stroke="black" points="22304.11,-537 22314.11,-533.5 22304.11,-530 22304.11,-537"/>
</g>
<!-- layer1_expert_1_up -->
<g id="node90" class="node">
<title>layer1_expert_1_up</title>
<path fill="lightcoral" stroke="black" d="M21641.5,-567.5C21641.5,-567.5 21525.5,-567.5 21525.5,-567.5 21519.5,-567.5 21513.5,-561.5 21513.5,-555.5 21513.5,-555.5 21513.5,-511.5 21513.5,-511.5 21513.5,-505.5 21519.5,-499.5 21525.5,-499.5 21525.5,-499.5 21641.5,-499.5 21641.5,-499.5 21647.5,-499.5 21653.5,-505.5 21653.5,-511.5 21653.5,-511.5 21653.5,-555.5 21653.5,-555.5 21653.5,-561.5 21647.5,-567.5 21641.5,-567.5"/>
<text text-anchor="middle" x="21583.5" y="-552.3" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="21583.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="21583.5" y="-522.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="21583.5" y="-507.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_expert_1_gate&#45;&gt;layer1_expert_1_up -->
<g id="edge146" class="edge">
<title>layer1_expert_1_gate&#45;&gt;layer1_expert_1_up</title>
<path fill="none" stroke="black" d="M21478.12,-533.5C21486.41,-533.5 21494.7,-533.5 21502.99,-533.5"/>
<polygon fill="black" stroke="black" points="21503.11,-537 21513.11,-533.5 21503.11,-530 21503.11,-537"/>
</g>
<!-- layer1_expert_2_up -->
<g id="node94" class="node">
<title>layer1_expert_2_up</title>
<path fill="lightcoral" stroke="black" d="M20840.5,-567.5C20840.5,-567.5 20724.5,-567.5 20724.5,-567.5 20718.5,-567.5 20712.5,-561.5 20712.5,-555.5 20712.5,-555.5 20712.5,-511.5 20712.5,-511.5 20712.5,-505.5 20718.5,-499.5 20724.5,-499.5 20724.5,-499.5 20840.5,-499.5 20840.5,-499.5 20846.5,-499.5 20852.5,-505.5 20852.5,-511.5 20852.5,-511.5 20852.5,-555.5 20852.5,-555.5 20852.5,-561.5 20846.5,-567.5 20840.5,-567.5"/>
<text text-anchor="middle" x="20782.5" y="-552.3" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="20782.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="20782.5" y="-522.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="20782.5" y="-507.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_expert_2_gate&#45;&gt;layer1_expert_2_up -->
<g id="edge151" class="edge">
<title>layer1_expert_2_gate&#45;&gt;layer1_expert_2_up</title>
<path fill="none" stroke="black" d="M20677.12,-533.5C20685.41,-533.5 20693.7,-533.5 20701.99,-533.5"/>
<polygon fill="black" stroke="black" points="20702.11,-537 20712.11,-533.5 20702.11,-530 20702.11,-537"/>
</g>
<!-- layer1_expert_3_up -->
<g id="node98" class="node">
<title>layer1_expert_3_up</title>
<path fill="lightcoral" stroke="black" d="M20039.5,-567.5C20039.5,-567.5 19923.5,-567.5 19923.5,-567.5 19917.5,-567.5 19911.5,-561.5 19911.5,-555.5 19911.5,-555.5 19911.5,-511.5 19911.5,-511.5 19911.5,-505.5 19917.5,-499.5 19923.5,-499.5 19923.5,-499.5 20039.5,-499.5 20039.5,-499.5 20045.5,-499.5 20051.5,-505.5 20051.5,-511.5 20051.5,-511.5 20051.5,-555.5 20051.5,-555.5 20051.5,-561.5 20045.5,-567.5 20039.5,-567.5"/>
<text text-anchor="middle" x="19981.5" y="-552.3" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="19981.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="19981.5" y="-522.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="19981.5" y="-507.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_expert_3_gate&#45;&gt;layer1_expert_3_up -->
<g id="edge156" class="edge">
<title>layer1_expert_3_gate&#45;&gt;layer1_expert_3_up</title>
<path fill="none" stroke="black" d="M19876.12,-533.5C19884.41,-533.5 19892.7,-533.5 19900.99,-533.5"/>
<polygon fill="black" stroke="black" points="19901.11,-537 19911.11,-533.5 19901.11,-530 19901.11,-537"/>
</g>
<!-- layer1_expert_4_up -->
<g id="node102" class="node">
<title>layer1_expert_4_up</title>
<path fill="lightcoral" stroke="black" d="M19238.5,-567.5C19238.5,-567.5 19122.5,-567.5 19122.5,-567.5 19116.5,-567.5 19110.5,-561.5 19110.5,-555.5 19110.5,-555.5 19110.5,-511.5 19110.5,-511.5 19110.5,-505.5 19116.5,-499.5 19122.5,-499.5 19122.5,-499.5 19238.5,-499.5 19238.5,-499.5 19244.5,-499.5 19250.5,-505.5 19250.5,-511.5 19250.5,-511.5 19250.5,-555.5 19250.5,-555.5 19250.5,-561.5 19244.5,-567.5 19238.5,-567.5"/>
<text text-anchor="middle" x="19180.5" y="-552.3" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="19180.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="19180.5" y="-522.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="19180.5" y="-507.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_expert_4_gate&#45;&gt;layer1_expert_4_up -->
<g id="edge161" class="edge">
<title>layer1_expert_4_gate&#45;&gt;layer1_expert_4_up</title>
<path fill="none" stroke="black" d="M19075.12,-533.5C19083.41,-533.5 19091.7,-533.5 19099.99,-533.5"/>
<polygon fill="black" stroke="black" points="19100.11,-537 19110.11,-533.5 19100.11,-530 19100.11,-537"/>
</g>
<!-- layer1_expert_5_up -->
<g id="node106" class="node">
<title>layer1_expert_5_up</title>
<path fill="lightcoral" stroke="black" d="M18437.5,-567.5C18437.5,-567.5 18321.5,-567.5 18321.5,-567.5 18315.5,-567.5 18309.5,-561.5 18309.5,-555.5 18309.5,-555.5 18309.5,-511.5 18309.5,-511.5 18309.5,-505.5 18315.5,-499.5 18321.5,-499.5 18321.5,-499.5 18437.5,-499.5 18437.5,-499.5 18443.5,-499.5 18449.5,-505.5 18449.5,-511.5 18449.5,-511.5 18449.5,-555.5 18449.5,-555.5 18449.5,-561.5 18443.5,-567.5 18437.5,-567.5"/>
<text text-anchor="middle" x="18379.5" y="-552.3" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="18379.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="18379.5" y="-522.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="18379.5" y="-507.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_expert_5_gate&#45;&gt;layer1_expert_5_up -->
<g id="edge166" class="edge">
<title>layer1_expert_5_gate&#45;&gt;layer1_expert_5_up</title>
<path fill="none" stroke="black" d="M18274.12,-533.5C18282.41,-533.5 18290.7,-533.5 18298.99,-533.5"/>
<polygon fill="black" stroke="black" points="18299.11,-537 18309.11,-533.5 18299.11,-530 18299.11,-537"/>
</g>
<!-- layer1_expert_6_up -->
<g id="node110" class="node">
<title>layer1_expert_6_up</title>
<path fill="lightcoral" stroke="black" d="M17636.5,-567.5C17636.5,-567.5 17520.5,-567.5 17520.5,-567.5 17514.5,-567.5 17508.5,-561.5 17508.5,-555.5 17508.5,-555.5 17508.5,-511.5 17508.5,-511.5 17508.5,-505.5 17514.5,-499.5 17520.5,-499.5 17520.5,-499.5 17636.5,-499.5 17636.5,-499.5 17642.5,-499.5 17648.5,-505.5 17648.5,-511.5 17648.5,-511.5 17648.5,-555.5 17648.5,-555.5 17648.5,-561.5 17642.5,-567.5 17636.5,-567.5"/>
<text text-anchor="middle" x="17578.5" y="-552.3" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="17578.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="17578.5" y="-522.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="17578.5" y="-507.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_expert_6_gate&#45;&gt;layer1_expert_6_up -->
<g id="edge171" class="edge">
<title>layer1_expert_6_gate&#45;&gt;layer1_expert_6_up</title>
<path fill="none" stroke="black" d="M17473.12,-533.5C17481.41,-533.5 17489.7,-533.5 17497.99,-533.5"/>
<polygon fill="black" stroke="black" points="17498.11,-537 17508.11,-533.5 17498.11,-530 17498.11,-537"/>
</g>
<!-- layer1_expert_7_up -->
<g id="node114" class="node">
<title>layer1_expert_7_up</title>
<path fill="lightcoral" stroke="black" d="M16835.5,-567.5C16835.5,-567.5 16719.5,-567.5 16719.5,-567.5 16713.5,-567.5 16707.5,-561.5 16707.5,-555.5 16707.5,-555.5 16707.5,-511.5 16707.5,-511.5 16707.5,-505.5 16713.5,-499.5 16719.5,-499.5 16719.5,-499.5 16835.5,-499.5 16835.5,-499.5 16841.5,-499.5 16847.5,-505.5 16847.5,-511.5 16847.5,-511.5 16847.5,-555.5 16847.5,-555.5 16847.5,-561.5 16841.5,-567.5 16835.5,-567.5"/>
<text text-anchor="middle" x="16777.5" y="-552.3" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="16777.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="16777.5" y="-522.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16777.5" y="-507.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer1_expert_7_gate&#45;&gt;layer1_expert_7_up -->
<g id="edge176" class="edge">
<title>layer1_expert_7_gate&#45;&gt;layer1_expert_7_up</title>
<path fill="none" stroke="black" d="M16672.12,-533.5C16680.41,-533.5 16688.7,-533.5 16696.99,-533.5"/>
<polygon fill="black" stroke="black" points="16697.11,-537 16707.11,-533.5 16697.11,-530 16697.11,-537"/>
</g>
<!-- layer1_moe_agg -->
<g id="node63" class="node">
<title>layer1_moe_agg</title>
<path fill="lightpink" stroke="black" d="M23110.5,-575C23110.5,-575 22992.5,-575 22992.5,-575 22986.5,-575 22980.5,-569 22980.5,-563 22980.5,-563 22980.5,-504 22980.5,-504 22980.5,-498 22986.5,-492 22992.5,-492 22992.5,-492 23110.5,-492 23110.5,-492 23116.5,-492 23122.5,-498 23122.5,-504 23122.5,-504 23122.5,-563 23122.5,-563 23122.5,-569 23116.5,-575 23110.5,-575"/>
<text text-anchor="middle" x="23051.5" y="-559.8" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="23051.5" y="-544.8" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="23051.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="23051.5" y="-514.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="23051.5" y="-499.8" font-family="Times,serif" font-size="14.00">(AllReduce)</text>
</g>
<!-- layer1_moe_agg&#45;&gt;layer1_residual2 -->
<g id="edge70" class="edge">
<title>layer1_moe_agg&#45;&gt;layer1_residual2</title>
<path fill="none" stroke="black" d="M23122.8,-533.5C23131.21,-533.5 23139.62,-533.5 23148.03,-533.5"/>
<polygon fill="black" stroke="black" points="23148.29,-537 23158.29,-533.5 23148.29,-530 23148.29,-537"/>
</g>
<!-- layer2_ln1 -->
<g id="node118" class="node">
<title>layer2_ln1</title>
<path fill="lightyellow" stroke="black" d="M23264,-426C23264,-426 23177,-426 23177,-426 23171,-426 23165,-420 23165,-414 23165,-414 23165,-385 23165,-385 23165,-379 23171,-373 23177,-373 23177,-373 23264,-373 23264,-373 23270,-373 23276,-379 23276,-385 23276,-385 23276,-414 23276,-414 23276,-420 23270,-426 23264,-426"/>
<text text-anchor="middle" x="23220.5" y="-410.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="23220.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="23220.5" y="-380.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer1_residual2&#45;&gt;layer2_ln1 -->
<g id="edge189" class="edge">
<title>layer1_residual2&#45;&gt;layer2_ln1</title>
<path fill="none" stroke="black" d="M23220.5,-506.74C23220.5,-486.66 23220.5,-458.54 23220.5,-436.28"/>
<polygon fill="black" stroke="black" points="23224,-436.2 23220.5,-426.2 23217,-436.2 23224,-436.2"/>
</g>
<!-- layer1_concat_dim_0 -->
<g id="node81" class="node">
<title>layer1_concat_dim_0</title>
<path fill="lightpink" stroke="black" d="M15532.5,-575C15532.5,-575 15410.5,-575 15410.5,-575 15404.5,-575 15398.5,-569 15398.5,-563 15398.5,-563 15398.5,-504 15398.5,-504 15398.5,-498 15404.5,-492 15410.5,-492 15410.5,-492 15532.5,-492 15532.5,-492 15538.5,-492 15544.5,-498 15544.5,-504 15544.5,-504 15544.5,-563 15544.5,-563 15544.5,-569 15538.5,-575 15532.5,-575"/>
<text text-anchor="middle" x="15471.5" y="-559.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="15471.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="15471.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 2048]</text>
<text text-anchor="middle" x="15471.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;3</text>
<text text-anchor="middle" x="15471.5" y="-499.8" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer1_attn_0_0&#45;&gt;layer1_concat_dim_0 -->
<g id="edge120" class="edge">
<title>layer1_attn_0_0&#45;&gt;layer1_concat_dim_0</title>
<path fill="none" stroke="black" d="M15363.02,-533.5C15371.35,-533.5 15379.69,-533.5 15388.02,-533.5"/>
<polygon fill="black" stroke="black" points="15388.19,-537 15398.19,-533.5 15388.19,-530 15388.19,-537"/>
</g>
<!-- layer1_attn_0_1&#45;&gt;layer1_concat_dim_0 -->
<g id="edge121" class="edge">
<title>layer1_attn_0_1&#45;&gt;layer1_concat_dim_0</title>
<path fill="none" stroke="black" d="M14389.72,-567.57C14410.99,-580.59 14436.93,-593.89 14462.5,-600.5 14559.32,-625.52 15266.27,-627.71 15362.5,-600.5 15378.17,-596.07 15393.79,-588.69 15408.12,-580.4"/>
<polygon fill="black" stroke="black" points="15410.1,-583.3 15416.87,-575.14 15406.49,-577.3 15410.1,-583.3"/>
</g>
<!-- layer1_attn_0_2&#45;&gt;layer1_concat_dim_0 -->
<g id="edge122" class="edge">
<title>layer1_attn_0_2&#45;&gt;layer1_concat_dim_0</title>
<path fill="none" stroke="black" d="M13471.72,-567.57C13492.99,-580.59 13518.93,-593.89 13544.5,-600.5 13642.29,-625.77 15265.31,-627.98 15362.5,-600.5 15378.17,-596.07 15393.79,-588.69 15408.12,-580.4"/>
<polygon fill="black" stroke="black" points="15410.1,-583.3 15416.87,-575.14 15406.49,-577.3 15410.1,-583.3"/>
</g>
<!-- layer1_attn_0_3&#45;&gt;layer1_concat_dim_0 -->
<g id="edge123" class="edge">
<title>layer1_attn_0_3&#45;&gt;layer1_concat_dim_0</title>
<path fill="none" stroke="black" d="M12553.72,-567.57C12574.99,-580.59 12600.93,-593.89 12626.5,-600.5 12700.08,-619.51 15289.37,-621.18 15362.5,-600.5 15378.17,-596.07 15393.79,-588.69 15408.12,-580.4"/>
<polygon fill="black" stroke="black" points="15410.1,-583.3 15416.87,-575.14 15406.49,-577.3 15410.1,-583.3"/>
</g>
<!-- layer1_concat_dim_1 -->
<g id="node82" class="node">
<title>layer1_concat_dim_1</title>
<path fill="lightpink" stroke="black" d="M11678.5,-575C11678.5,-575 11556.5,-575 11556.5,-575 11550.5,-575 11544.5,-569 11544.5,-563 11544.5,-563 11544.5,-504 11544.5,-504 11544.5,-498 11550.5,-492 11556.5,-492 11556.5,-492 11678.5,-492 11678.5,-492 11684.5,-492 11690.5,-498 11690.5,-504 11690.5,-504 11690.5,-563 11690.5,-563 11690.5,-569 11684.5,-575 11678.5,-575"/>
<text text-anchor="middle" x="11617.5" y="-559.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="11617.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="11617.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 2048]</text>
<text text-anchor="middle" x="11617.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPUs 4&#45;7</text>
<text text-anchor="middle" x="11617.5" y="-499.8" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer1_attn_1_0&#45;&gt;layer1_concat_dim_1 -->
<g id="edge124" class="edge">
<title>layer1_attn_1_0&#45;&gt;layer1_concat_dim_1</title>
<path fill="none" stroke="black" d="M11509.02,-533.5C11517.35,-533.5 11525.69,-533.5 11534.02,-533.5"/>
<polygon fill="black" stroke="black" points="11534.19,-537 11544.19,-533.5 11534.19,-530 11534.19,-537"/>
</g>
<!-- layer1_attn_1_1&#45;&gt;layer1_concat_dim_1 -->
<g id="edge125" class="edge">
<title>layer1_attn_1_1&#45;&gt;layer1_concat_dim_1</title>
<path fill="none" stroke="black" d="M10535.72,-567.57C10556.99,-580.59 10582.93,-593.89 10608.5,-600.5 10705.32,-625.52 11412.27,-627.71 11508.5,-600.5 11524.17,-596.07 11539.79,-588.69 11554.12,-580.4"/>
<polygon fill="black" stroke="black" points="11556.1,-583.3 11562.87,-575.14 11552.49,-577.3 11556.1,-583.3"/>
</g>
<!-- layer1_attn_1_2&#45;&gt;layer1_concat_dim_1 -->
<g id="edge126" class="edge">
<title>layer1_attn_1_2&#45;&gt;layer1_concat_dim_1</title>
<path fill="none" stroke="black" d="M9617.72,-567.57C9638.99,-580.59 9664.93,-593.89 9690.5,-600.5 9788.29,-625.77 11411.31,-627.98 11508.5,-600.5 11524.17,-596.07 11539.79,-588.69 11554.12,-580.4"/>
<polygon fill="black" stroke="black" points="11556.1,-583.3 11562.87,-575.14 11552.49,-577.3 11556.1,-583.3"/>
</g>
<!-- layer1_attn_1_3&#45;&gt;layer1_concat_dim_1 -->
<g id="edge127" class="edge">
<title>layer1_attn_1_3&#45;&gt;layer1_concat_dim_1</title>
<path fill="none" stroke="black" d="M8699.72,-567.57C8720.99,-580.59 8746.93,-593.89 8772.5,-600.5 8846.08,-619.51 11435.37,-621.18 11508.5,-600.5 11524.17,-596.07 11539.79,-588.69 11554.12,-580.4"/>
<polygon fill="black" stroke="black" points="11556.1,-583.3 11562.87,-575.14 11552.49,-577.3 11556.1,-583.3"/>
</g>
<!-- layer1_concat_dim_2 -->
<g id="node83" class="node">
<title>layer1_concat_dim_2</title>
<path fill="lightpink" stroke="black" d="M7824.5,-575C7824.5,-575 7702.5,-575 7702.5,-575 7696.5,-575 7690.5,-569 7690.5,-563 7690.5,-563 7690.5,-504 7690.5,-504 7690.5,-498 7696.5,-492 7702.5,-492 7702.5,-492 7824.5,-492 7824.5,-492 7830.5,-492 7836.5,-498 7836.5,-504 7836.5,-504 7836.5,-563 7836.5,-563 7836.5,-569 7830.5,-575 7824.5,-575"/>
<text text-anchor="middle" x="7763.5" y="-559.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="7763.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="7763.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 2048]</text>
<text text-anchor="middle" x="7763.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;11</text>
<text text-anchor="middle" x="7763.5" y="-499.8" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer1_attn_2_0&#45;&gt;layer1_concat_dim_2 -->
<g id="edge128" class="edge">
<title>layer1_attn_2_0&#45;&gt;layer1_concat_dim_2</title>
<path fill="none" stroke="black" d="M7655.02,-533.5C7663.35,-533.5 7671.69,-533.5 7680.02,-533.5"/>
<polygon fill="black" stroke="black" points="7680.19,-537 7690.19,-533.5 7680.19,-530 7680.19,-537"/>
</g>
<!-- layer1_attn_2_1&#45;&gt;layer1_concat_dim_2 -->
<g id="edge129" class="edge">
<title>layer1_attn_2_1&#45;&gt;layer1_concat_dim_2</title>
<path fill="none" stroke="black" d="M6681.72,-567.57C6702.99,-580.59 6728.93,-593.89 6754.5,-600.5 6851.32,-625.52 7558.27,-627.71 7654.5,-600.5 7670.17,-596.07 7685.79,-588.69 7700.12,-580.4"/>
<polygon fill="black" stroke="black" points="7702.1,-583.3 7708.87,-575.14 7698.49,-577.3 7702.1,-583.3"/>
</g>
<!-- layer1_attn_2_2&#45;&gt;layer1_concat_dim_2 -->
<g id="edge130" class="edge">
<title>layer1_attn_2_2&#45;&gt;layer1_concat_dim_2</title>
<path fill="none" stroke="black" d="M5763.72,-567.57C5784.99,-580.59 5810.93,-593.89 5836.5,-600.5 5934.29,-625.77 7557.31,-627.98 7654.5,-600.5 7670.17,-596.07 7685.79,-588.69 7700.12,-580.4"/>
<polygon fill="black" stroke="black" points="7702.1,-583.3 7708.87,-575.14 7698.49,-577.3 7702.1,-583.3"/>
</g>
<!-- layer1_attn_2_3&#45;&gt;layer1_concat_dim_2 -->
<g id="edge131" class="edge">
<title>layer1_attn_2_3&#45;&gt;layer1_concat_dim_2</title>
<path fill="none" stroke="black" d="M4845.72,-567.57C4866.99,-580.59 4892.93,-593.89 4918.5,-600.5 4992.08,-619.51 7581.37,-621.18 7654.5,-600.5 7670.17,-596.07 7685.79,-588.69 7700.12,-580.4"/>
<polygon fill="black" stroke="black" points="7702.1,-583.3 7708.87,-575.14 7698.49,-577.3 7702.1,-583.3"/>
</g>
<!-- layer1_concat_dim_3 -->
<g id="node84" class="node">
<title>layer1_concat_dim_3</title>
<path fill="lightpink" stroke="black" d="M3970.5,-575C3970.5,-575 3848.5,-575 3848.5,-575 3842.5,-575 3836.5,-569 3836.5,-563 3836.5,-563 3836.5,-504 3836.5,-504 3836.5,-498 3842.5,-492 3848.5,-492 3848.5,-492 3970.5,-492 3970.5,-492 3976.5,-492 3982.5,-498 3982.5,-504 3982.5,-504 3982.5,-563 3982.5,-563 3982.5,-569 3976.5,-575 3970.5,-575"/>
<text text-anchor="middle" x="3909.5" y="-559.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="3909.5" y="-544.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="3909.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 2048]</text>
<text text-anchor="middle" x="3909.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPUs 12&#45;15</text>
<text text-anchor="middle" x="3909.5" y="-499.8" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer1_attn_3_0&#45;&gt;layer1_concat_dim_3 -->
<g id="edge132" class="edge">
<title>layer1_attn_3_0&#45;&gt;layer1_concat_dim_3</title>
<path fill="none" stroke="black" d="M3801.02,-533.5C3809.35,-533.5 3817.69,-533.5 3826.02,-533.5"/>
<polygon fill="black" stroke="black" points="3826.19,-537 3836.19,-533.5 3826.19,-530 3826.19,-537"/>
</g>
<!-- layer1_attn_3_1&#45;&gt;layer1_concat_dim_3 -->
<g id="edge133" class="edge">
<title>layer1_attn_3_1&#45;&gt;layer1_concat_dim_3</title>
<path fill="none" stroke="black" d="M2827.72,-567.57C2848.99,-580.59 2874.93,-593.89 2900.5,-600.5 2997.32,-625.52 3704.27,-627.71 3800.5,-600.5 3816.17,-596.07 3831.79,-588.69 3846.12,-580.4"/>
<polygon fill="black" stroke="black" points="3848.1,-583.3 3854.87,-575.14 3844.49,-577.3 3848.1,-583.3"/>
</g>
<!-- layer1_attn_3_2&#45;&gt;layer1_concat_dim_3 -->
<g id="edge134" class="edge">
<title>layer1_attn_3_2&#45;&gt;layer1_concat_dim_3</title>
<path fill="none" stroke="black" d="M1909.72,-567.57C1930.99,-580.59 1956.93,-593.89 1982.5,-600.5 2080.29,-625.77 3703.31,-627.98 3800.5,-600.5 3816.17,-596.07 3831.79,-588.69 3846.12,-580.4"/>
<polygon fill="black" stroke="black" points="3848.1,-583.3 3854.87,-575.14 3844.49,-577.3 3848.1,-583.3"/>
</g>
<!-- layer1_attn_3_3&#45;&gt;layer1_concat_dim_3 -->
<g id="edge135" class="edge">
<title>layer1_attn_3_3&#45;&gt;layer1_concat_dim_3</title>
<path fill="none" stroke="black" d="M991.72,-567.57C1012.99,-580.59 1038.93,-593.89 1064.5,-600.5 1138.08,-619.51 3727.37,-621.18 3800.5,-600.5 3816.17,-596.07 3831.79,-588.69 3846.12,-580.4"/>
<polygon fill="black" stroke="black" points="3848.1,-583.3 3854.87,-575.14 3844.49,-577.3 3848.1,-583.3"/>
</g>
<!-- layer1_concat_heads -->
<g id="node85" class="node">
<title>layer1_concat_heads</title>
<path fill="lightpink" stroke="black" d="M15732.5,-567.5C15732.5,-567.5 15592.5,-567.5 15592.5,-567.5 15586.5,-567.5 15580.5,-561.5 15580.5,-555.5 15580.5,-555.5 15580.5,-511.5 15580.5,-511.5 15580.5,-505.5 15586.5,-499.5 15592.5,-499.5 15592.5,-499.5 15732.5,-499.5 15732.5,-499.5 15738.5,-499.5 15744.5,-505.5 15744.5,-511.5 15744.5,-511.5 15744.5,-555.5 15744.5,-555.5 15744.5,-561.5 15738.5,-567.5 15732.5,-567.5"/>
<text text-anchor="middle" x="15662.5" y="-552.3" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="15662.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="15662.5" y="-522.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="15662.5" y="-507.3" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer1_concat_dim_0&#45;&gt;layer1_concat_heads -->
<g id="edge136" class="edge">
<title>layer1_concat_dim_0&#45;&gt;layer1_concat_heads</title>
<path fill="none" stroke="black" d="M15544.62,-533.5C15553.02,-533.5 15561.42,-533.5 15569.82,-533.5"/>
<polygon fill="black" stroke="black" points="15570.07,-537 15580.07,-533.5 15570.07,-530 15570.07,-537"/>
</g>
<!-- layer1_concat_dim_1&#45;&gt;layer1_concat_heads -->
<g id="edge137" class="edge">
<title>layer1_concat_dim_1&#45;&gt;layer1_concat_heads</title>
<path fill="none" stroke="black" d="M11662.44,-575.23C11676.22,-585.51 11692.1,-595.11 11708.5,-600.5 11809.74,-633.75 15441.48,-627.71 15544.5,-600.5 15566.13,-594.79 15587.95,-584.09 15606.84,-572.9"/>
<polygon fill="black" stroke="black" points="15608.87,-575.76 15615.58,-567.56 15605.23,-569.79 15608.87,-575.76"/>
</g>
<!-- layer1_concat_dim_2&#45;&gt;layer1_concat_heads -->
<g id="edge138" class="edge">
<title>layer1_concat_dim_2&#45;&gt;layer1_concat_heads</title>
<path fill="none" stroke="black" d="M7808.44,-575.23C7822.22,-585.51 7838.1,-595.11 7854.5,-600.5 7955.97,-633.83 15441.23,-627.77 15544.5,-600.5 15566.13,-594.79 15587.95,-584.09 15606.84,-572.9"/>
<polygon fill="black" stroke="black" points="15608.87,-575.76 15615.58,-567.56 15605.23,-569.79 15608.87,-575.76"/>
</g>
<!-- layer1_concat_dim_3&#45;&gt;layer1_concat_heads -->
<g id="edge139" class="edge">
<title>layer1_concat_dim_3&#45;&gt;layer1_concat_heads</title>
<path fill="none" stroke="black" d="M3954.44,-575.23C3968.22,-585.51 3984.1,-595.11 4000.5,-600.5 4076.66,-625.51 15466.99,-620.97 15544.5,-600.5 15566.13,-594.79 15587.95,-584.09 15606.84,-572.9"/>
<polygon fill="black" stroke="black" points="15608.87,-575.76 15615.58,-567.56 15605.23,-569.79 15608.87,-575.76"/>
</g>
<!-- layer1_concat_heads&#45;&gt;layer1_out_proj -->
<g id="edge140" class="edge">
<title>layer1_concat_heads&#45;&gt;layer1_out_proj</title>
<path fill="none" stroke="black" d="M15744.51,-533.5C15753.1,-533.5 15761.69,-533.5 15770.28,-533.5"/>
<polygon fill="black" stroke="black" points="15770.37,-537 15780.37,-533.5 15770.37,-530 15770.37,-537"/>
</g>
<!-- layer1_expert_0_act -->
<g id="node87" class="node">
<title>layer1_expert_0_act</title>
<path fill="lightyellow" stroke="black" d="M22603,-560C22603,-560 22502,-560 22502,-560 22496,-560 22490,-554 22490,-548 22490,-548 22490,-519 22490,-519 22490,-513 22496,-507 22502,-507 22502,-507 22603,-507 22603,-507 22609,-507 22615,-513 22615,-519 22615,-519 22615,-548 22615,-548 22615,-554 22609,-560 22603,-560"/>
<text text-anchor="middle" x="22552.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="22552.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="22552.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_expert_0_up&#45;&gt;layer1_expert_0_act -->
<g id="edge142" class="edge">
<title>layer1_expert_0_up&#45;&gt;layer1_expert_0_act</title>
<path fill="none" stroke="black" d="M22454.72,-533.5C22463.05,-533.5 22471.37,-533.5 22479.7,-533.5"/>
<polygon fill="black" stroke="black" points="22479.86,-537 22489.86,-533.5 22479.86,-530 22479.86,-537"/>
</g>
<!-- layer1_expert_0_down -->
<g id="node88" class="node">
<title>layer1_expert_0_down</title>
<path fill="lightcoral" stroke="black" d="M22762.5,-567.5C22762.5,-567.5 22662.5,-567.5 22662.5,-567.5 22656.5,-567.5 22650.5,-561.5 22650.5,-555.5 22650.5,-555.5 22650.5,-511.5 22650.5,-511.5 22650.5,-505.5 22656.5,-499.5 22662.5,-499.5 22662.5,-499.5 22762.5,-499.5 22762.5,-499.5 22768.5,-499.5 22774.5,-505.5 22774.5,-511.5 22774.5,-511.5 22774.5,-555.5 22774.5,-555.5 22774.5,-561.5 22768.5,-567.5 22762.5,-567.5"/>
<text text-anchor="middle" x="22712.5" y="-552.3" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="22712.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="22712.5" y="-522.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="22712.5" y="-507.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer1_expert_0_act&#45;&gt;layer1_expert_0_down -->
<g id="edge143" class="edge">
<title>layer1_expert_0_act&#45;&gt;layer1_expert_0_down</title>
<path fill="none" stroke="black" d="M22615,-533.5C22623.39,-533.5 22631.79,-533.5 22640.18,-533.5"/>
<polygon fill="black" stroke="black" points="22640.42,-537 22650.42,-533.5 22640.42,-530 22640.42,-537"/>
</g>
<!-- layer1_expert_0_out -->
<g id="node89" class="node">
<title>layer1_expert_0_out</title>
<path fill="lightpink" stroke="black" d="M22932.5,-560C22932.5,-560 22822.5,-560 22822.5,-560 22816.5,-560 22810.5,-554 22810.5,-548 22810.5,-548 22810.5,-519 22810.5,-519 22810.5,-513 22816.5,-507 22822.5,-507 22822.5,-507 22932.5,-507 22932.5,-507 22938.5,-507 22944.5,-513 22944.5,-519 22944.5,-519 22944.5,-548 22944.5,-548 22944.5,-554 22938.5,-560 22932.5,-560"/>
<text text-anchor="middle" x="22877.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 0 Output</text>
<text text-anchor="middle" x="22877.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="22877.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer1_expert_0_down&#45;&gt;layer1_expert_0_out -->
<g id="edge144" class="edge">
<title>layer1_expert_0_down&#45;&gt;layer1_expert_0_out</title>
<path fill="none" stroke="black" d="M22774.7,-533.5C22783.26,-533.5 22791.82,-533.5 22800.39,-533.5"/>
<polygon fill="black" stroke="black" points="22800.44,-537 22810.44,-533.5 22800.44,-530 22800.44,-537"/>
</g>
<!-- layer1_expert_0_out&#45;&gt;layer1_moe_agg -->
<g id="edge181" class="edge">
<title>layer1_expert_0_out&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M22944.79,-533.5C22953.19,-533.5 22961.58,-533.5 22969.98,-533.5"/>
<polygon fill="black" stroke="black" points="22970.22,-537 22980.22,-533.5 22970.22,-530 22970.22,-537"/>
</g>
<!-- layer1_expert_1_act -->
<g id="node91" class="node">
<title>layer1_expert_1_act</title>
<path fill="lightyellow" stroke="black" d="M21802,-560C21802,-560 21701,-560 21701,-560 21695,-560 21689,-554 21689,-548 21689,-548 21689,-519 21689,-519 21689,-513 21695,-507 21701,-507 21701,-507 21802,-507 21802,-507 21808,-507 21814,-513 21814,-519 21814,-519 21814,-548 21814,-548 21814,-554 21808,-560 21802,-560"/>
<text text-anchor="middle" x="21751.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="21751.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="21751.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_expert_1_up&#45;&gt;layer1_expert_1_act -->
<g id="edge147" class="edge">
<title>layer1_expert_1_up&#45;&gt;layer1_expert_1_act</title>
<path fill="none" stroke="black" d="M21653.72,-533.5C21662.05,-533.5 21670.37,-533.5 21678.7,-533.5"/>
<polygon fill="black" stroke="black" points="21678.86,-537 21688.86,-533.5 21678.86,-530 21678.86,-537"/>
</g>
<!-- layer1_expert_1_down -->
<g id="node92" class="node">
<title>layer1_expert_1_down</title>
<path fill="lightcoral" stroke="black" d="M21961.5,-567.5C21961.5,-567.5 21861.5,-567.5 21861.5,-567.5 21855.5,-567.5 21849.5,-561.5 21849.5,-555.5 21849.5,-555.5 21849.5,-511.5 21849.5,-511.5 21849.5,-505.5 21855.5,-499.5 21861.5,-499.5 21861.5,-499.5 21961.5,-499.5 21961.5,-499.5 21967.5,-499.5 21973.5,-505.5 21973.5,-511.5 21973.5,-511.5 21973.5,-555.5 21973.5,-555.5 21973.5,-561.5 21967.5,-567.5 21961.5,-567.5"/>
<text text-anchor="middle" x="21911.5" y="-552.3" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="21911.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="21911.5" y="-522.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="21911.5" y="-507.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer1_expert_1_act&#45;&gt;layer1_expert_1_down -->
<g id="edge148" class="edge">
<title>layer1_expert_1_act&#45;&gt;layer1_expert_1_down</title>
<path fill="none" stroke="black" d="M21814,-533.5C21822.39,-533.5 21830.79,-533.5 21839.18,-533.5"/>
<polygon fill="black" stroke="black" points="21839.42,-537 21849.42,-533.5 21839.42,-530 21839.42,-537"/>
</g>
<!-- layer1_expert_1_out -->
<g id="node93" class="node">
<title>layer1_expert_1_out</title>
<path fill="lightpink" stroke="black" d="M22131.5,-560C22131.5,-560 22021.5,-560 22021.5,-560 22015.5,-560 22009.5,-554 22009.5,-548 22009.5,-548 22009.5,-519 22009.5,-519 22009.5,-513 22015.5,-507 22021.5,-507 22021.5,-507 22131.5,-507 22131.5,-507 22137.5,-507 22143.5,-513 22143.5,-519 22143.5,-519 22143.5,-548 22143.5,-548 22143.5,-554 22137.5,-560 22131.5,-560"/>
<text text-anchor="middle" x="22076.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 1 Output</text>
<text text-anchor="middle" x="22076.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="22076.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer1_expert_1_down&#45;&gt;layer1_expert_1_out -->
<g id="edge149" class="edge">
<title>layer1_expert_1_down&#45;&gt;layer1_expert_1_out</title>
<path fill="none" stroke="black" d="M21973.7,-533.5C21982.26,-533.5 21990.82,-533.5 21999.39,-533.5"/>
<polygon fill="black" stroke="black" points="21999.44,-537 22009.44,-533.5 21999.44,-530 21999.44,-537"/>
</g>
<!-- layer1_expert_1_out&#45;&gt;layer1_moe_agg -->
<g id="edge182" class="edge">
<title>layer1_expert_1_out&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M22100.87,-560.05C22116.53,-575.08 22138.24,-592.44 22161.5,-600.5 22243.7,-629 22860.88,-624.52 22944.5,-600.5 22959.94,-596.07 22975.31,-588.68 22989.38,-580.39"/>
<polygon fill="black" stroke="black" points="22991.26,-583.34 22997.97,-575.14 22987.61,-577.37 22991.26,-583.34"/>
</g>
<!-- layer1_expert_2_act -->
<g id="node95" class="node">
<title>layer1_expert_2_act</title>
<path fill="lightyellow" stroke="black" d="M21001,-560C21001,-560 20900,-560 20900,-560 20894,-560 20888,-554 20888,-548 20888,-548 20888,-519 20888,-519 20888,-513 20894,-507 20900,-507 20900,-507 21001,-507 21001,-507 21007,-507 21013,-513 21013,-519 21013,-519 21013,-548 21013,-548 21013,-554 21007,-560 21001,-560"/>
<text text-anchor="middle" x="20950.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="20950.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="20950.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_expert_2_up&#45;&gt;layer1_expert_2_act -->
<g id="edge152" class="edge">
<title>layer1_expert_2_up&#45;&gt;layer1_expert_2_act</title>
<path fill="none" stroke="black" d="M20852.72,-533.5C20861.05,-533.5 20869.37,-533.5 20877.7,-533.5"/>
<polygon fill="black" stroke="black" points="20877.86,-537 20887.86,-533.5 20877.86,-530 20877.86,-537"/>
</g>
<!-- layer1_expert_2_down -->
<g id="node96" class="node">
<title>layer1_expert_2_down</title>
<path fill="lightcoral" stroke="black" d="M21160.5,-567.5C21160.5,-567.5 21060.5,-567.5 21060.5,-567.5 21054.5,-567.5 21048.5,-561.5 21048.5,-555.5 21048.5,-555.5 21048.5,-511.5 21048.5,-511.5 21048.5,-505.5 21054.5,-499.5 21060.5,-499.5 21060.5,-499.5 21160.5,-499.5 21160.5,-499.5 21166.5,-499.5 21172.5,-505.5 21172.5,-511.5 21172.5,-511.5 21172.5,-555.5 21172.5,-555.5 21172.5,-561.5 21166.5,-567.5 21160.5,-567.5"/>
<text text-anchor="middle" x="21110.5" y="-552.3" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="21110.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="21110.5" y="-522.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="21110.5" y="-507.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer1_expert_2_act&#45;&gt;layer1_expert_2_down -->
<g id="edge153" class="edge">
<title>layer1_expert_2_act&#45;&gt;layer1_expert_2_down</title>
<path fill="none" stroke="black" d="M21013,-533.5C21021.39,-533.5 21029.79,-533.5 21038.18,-533.5"/>
<polygon fill="black" stroke="black" points="21038.42,-537 21048.42,-533.5 21038.42,-530 21038.42,-537"/>
</g>
<!-- layer1_expert_2_out -->
<g id="node97" class="node">
<title>layer1_expert_2_out</title>
<path fill="lightpink" stroke="black" d="M21330.5,-560C21330.5,-560 21220.5,-560 21220.5,-560 21214.5,-560 21208.5,-554 21208.5,-548 21208.5,-548 21208.5,-519 21208.5,-519 21208.5,-513 21214.5,-507 21220.5,-507 21220.5,-507 21330.5,-507 21330.5,-507 21336.5,-507 21342.5,-513 21342.5,-519 21342.5,-519 21342.5,-548 21342.5,-548 21342.5,-554 21336.5,-560 21330.5,-560"/>
<text text-anchor="middle" x="21275.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 2 Output</text>
<text text-anchor="middle" x="21275.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="21275.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer1_expert_2_down&#45;&gt;layer1_expert_2_out -->
<g id="edge154" class="edge">
<title>layer1_expert_2_down&#45;&gt;layer1_expert_2_out</title>
<path fill="none" stroke="black" d="M21172.7,-533.5C21181.26,-533.5 21189.82,-533.5 21198.39,-533.5"/>
<polygon fill="black" stroke="black" points="21198.44,-537 21208.44,-533.5 21198.44,-530 21198.44,-537"/>
</g>
<!-- layer1_expert_2_out&#45;&gt;layer1_moe_agg -->
<g id="edge183" class="edge">
<title>layer1_expert_2_out&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M21299.87,-560.05C21315.53,-575.08 21337.24,-592.44 21360.5,-600.5 21443.64,-629.33 22859.92,-624.8 22944.5,-600.5 22959.94,-596.07 22975.31,-588.68 22989.38,-580.39"/>
<polygon fill="black" stroke="black" points="22991.26,-583.34 22997.97,-575.14 22987.61,-577.37 22991.26,-583.34"/>
</g>
<!-- layer1_expert_3_act -->
<g id="node99" class="node">
<title>layer1_expert_3_act</title>
<path fill="lightyellow" stroke="black" d="M20200,-560C20200,-560 20099,-560 20099,-560 20093,-560 20087,-554 20087,-548 20087,-548 20087,-519 20087,-519 20087,-513 20093,-507 20099,-507 20099,-507 20200,-507 20200,-507 20206,-507 20212,-513 20212,-519 20212,-519 20212,-548 20212,-548 20212,-554 20206,-560 20200,-560"/>
<text text-anchor="middle" x="20149.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="20149.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="20149.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_expert_3_up&#45;&gt;layer1_expert_3_act -->
<g id="edge157" class="edge">
<title>layer1_expert_3_up&#45;&gt;layer1_expert_3_act</title>
<path fill="none" stroke="black" d="M20051.72,-533.5C20060.05,-533.5 20068.37,-533.5 20076.7,-533.5"/>
<polygon fill="black" stroke="black" points="20076.86,-537 20086.86,-533.5 20076.86,-530 20076.86,-537"/>
</g>
<!-- layer1_expert_3_down -->
<g id="node100" class="node">
<title>layer1_expert_3_down</title>
<path fill="lightcoral" stroke="black" d="M20359.5,-567.5C20359.5,-567.5 20259.5,-567.5 20259.5,-567.5 20253.5,-567.5 20247.5,-561.5 20247.5,-555.5 20247.5,-555.5 20247.5,-511.5 20247.5,-511.5 20247.5,-505.5 20253.5,-499.5 20259.5,-499.5 20259.5,-499.5 20359.5,-499.5 20359.5,-499.5 20365.5,-499.5 20371.5,-505.5 20371.5,-511.5 20371.5,-511.5 20371.5,-555.5 20371.5,-555.5 20371.5,-561.5 20365.5,-567.5 20359.5,-567.5"/>
<text text-anchor="middle" x="20309.5" y="-552.3" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="20309.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="20309.5" y="-522.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="20309.5" y="-507.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer1_expert_3_act&#45;&gt;layer1_expert_3_down -->
<g id="edge158" class="edge">
<title>layer1_expert_3_act&#45;&gt;layer1_expert_3_down</title>
<path fill="none" stroke="black" d="M20212,-533.5C20220.39,-533.5 20228.79,-533.5 20237.18,-533.5"/>
<polygon fill="black" stroke="black" points="20237.42,-537 20247.42,-533.5 20237.42,-530 20237.42,-537"/>
</g>
<!-- layer1_expert_3_out -->
<g id="node101" class="node">
<title>layer1_expert_3_out</title>
<path fill="lightpink" stroke="black" d="M20529.5,-560C20529.5,-560 20419.5,-560 20419.5,-560 20413.5,-560 20407.5,-554 20407.5,-548 20407.5,-548 20407.5,-519 20407.5,-519 20407.5,-513 20413.5,-507 20419.5,-507 20419.5,-507 20529.5,-507 20529.5,-507 20535.5,-507 20541.5,-513 20541.5,-519 20541.5,-519 20541.5,-548 20541.5,-548 20541.5,-554 20535.5,-560 20529.5,-560"/>
<text text-anchor="middle" x="20474.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 3 Output</text>
<text text-anchor="middle" x="20474.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="20474.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer1_expert_3_down&#45;&gt;layer1_expert_3_out -->
<g id="edge159" class="edge">
<title>layer1_expert_3_down&#45;&gt;layer1_expert_3_out</title>
<path fill="none" stroke="black" d="M20371.7,-533.5C20380.26,-533.5 20388.82,-533.5 20397.39,-533.5"/>
<polygon fill="black" stroke="black" points="20397.44,-537 20407.44,-533.5 20397.44,-530 20397.44,-537"/>
</g>
<!-- layer1_expert_3_out&#45;&gt;layer1_moe_agg -->
<g id="edge184" class="edge">
<title>layer1_expert_3_out&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M20498.87,-560.05C20514.53,-575.08 20536.24,-592.44 20559.5,-600.5 20622.09,-622.2 22880.82,-618.79 22944.5,-600.5 22959.94,-596.07 22975.31,-588.68 22989.38,-580.39"/>
<polygon fill="black" stroke="black" points="22991.26,-583.34 22997.97,-575.14 22987.61,-577.37 22991.26,-583.34"/>
</g>
<!-- layer1_expert_4_act -->
<g id="node103" class="node">
<title>layer1_expert_4_act</title>
<path fill="lightyellow" stroke="black" d="M19399,-560C19399,-560 19298,-560 19298,-560 19292,-560 19286,-554 19286,-548 19286,-548 19286,-519 19286,-519 19286,-513 19292,-507 19298,-507 19298,-507 19399,-507 19399,-507 19405,-507 19411,-513 19411,-519 19411,-519 19411,-548 19411,-548 19411,-554 19405,-560 19399,-560"/>
<text text-anchor="middle" x="19348.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="19348.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="19348.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_expert_4_up&#45;&gt;layer1_expert_4_act -->
<g id="edge162" class="edge">
<title>layer1_expert_4_up&#45;&gt;layer1_expert_4_act</title>
<path fill="none" stroke="black" d="M19250.72,-533.5C19259.05,-533.5 19267.37,-533.5 19275.7,-533.5"/>
<polygon fill="black" stroke="black" points="19275.86,-537 19285.86,-533.5 19275.86,-530 19275.86,-537"/>
</g>
<!-- layer1_expert_4_down -->
<g id="node104" class="node">
<title>layer1_expert_4_down</title>
<path fill="lightcoral" stroke="black" d="M19558.5,-567.5C19558.5,-567.5 19458.5,-567.5 19458.5,-567.5 19452.5,-567.5 19446.5,-561.5 19446.5,-555.5 19446.5,-555.5 19446.5,-511.5 19446.5,-511.5 19446.5,-505.5 19452.5,-499.5 19458.5,-499.5 19458.5,-499.5 19558.5,-499.5 19558.5,-499.5 19564.5,-499.5 19570.5,-505.5 19570.5,-511.5 19570.5,-511.5 19570.5,-555.5 19570.5,-555.5 19570.5,-561.5 19564.5,-567.5 19558.5,-567.5"/>
<text text-anchor="middle" x="19508.5" y="-552.3" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="19508.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="19508.5" y="-522.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="19508.5" y="-507.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer1_expert_4_act&#45;&gt;layer1_expert_4_down -->
<g id="edge163" class="edge">
<title>layer1_expert_4_act&#45;&gt;layer1_expert_4_down</title>
<path fill="none" stroke="black" d="M19411,-533.5C19419.39,-533.5 19427.79,-533.5 19436.18,-533.5"/>
<polygon fill="black" stroke="black" points="19436.42,-537 19446.42,-533.5 19436.42,-530 19436.42,-537"/>
</g>
<!-- layer1_expert_4_out -->
<g id="node105" class="node">
<title>layer1_expert_4_out</title>
<path fill="lightpink" stroke="black" d="M19728.5,-560C19728.5,-560 19618.5,-560 19618.5,-560 19612.5,-560 19606.5,-554 19606.5,-548 19606.5,-548 19606.5,-519 19606.5,-519 19606.5,-513 19612.5,-507 19618.5,-507 19618.5,-507 19728.5,-507 19728.5,-507 19734.5,-507 19740.5,-513 19740.5,-519 19740.5,-519 19740.5,-548 19740.5,-548 19740.5,-554 19734.5,-560 19728.5,-560"/>
<text text-anchor="middle" x="19673.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 4 Output</text>
<text text-anchor="middle" x="19673.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="19673.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer1_expert_4_down&#45;&gt;layer1_expert_4_out -->
<g id="edge164" class="edge">
<title>layer1_expert_4_down&#45;&gt;layer1_expert_4_out</title>
<path fill="none" stroke="black" d="M19570.7,-533.5C19579.26,-533.5 19587.82,-533.5 19596.39,-533.5"/>
<polygon fill="black" stroke="black" points="19596.44,-537 19606.44,-533.5 19596.44,-530 19596.44,-537"/>
</g>
<!-- layer1_expert_4_out&#45;&gt;layer1_moe_agg -->
<g id="edge185" class="edge">
<title>layer1_expert_4_out&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M19697.87,-560.05C19713.53,-575.08 19735.24,-592.44 19758.5,-600.5 19842.12,-629.49 22859.44,-624.93 22944.5,-600.5 22959.94,-596.07 22975.31,-588.68 22989.38,-580.39"/>
<polygon fill="black" stroke="black" points="22991.26,-583.34 22997.97,-575.14 22987.61,-577.37 22991.26,-583.34"/>
</g>
<!-- layer1_expert_5_act -->
<g id="node107" class="node">
<title>layer1_expert_5_act</title>
<path fill="lightyellow" stroke="black" d="M18598,-560C18598,-560 18497,-560 18497,-560 18491,-560 18485,-554 18485,-548 18485,-548 18485,-519 18485,-519 18485,-513 18491,-507 18497,-507 18497,-507 18598,-507 18598,-507 18604,-507 18610,-513 18610,-519 18610,-519 18610,-548 18610,-548 18610,-554 18604,-560 18598,-560"/>
<text text-anchor="middle" x="18547.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="18547.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="18547.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_expert_5_up&#45;&gt;layer1_expert_5_act -->
<g id="edge167" class="edge">
<title>layer1_expert_5_up&#45;&gt;layer1_expert_5_act</title>
<path fill="none" stroke="black" d="M18449.72,-533.5C18458.05,-533.5 18466.37,-533.5 18474.7,-533.5"/>
<polygon fill="black" stroke="black" points="18474.86,-537 18484.86,-533.5 18474.86,-530 18474.86,-537"/>
</g>
<!-- layer1_expert_5_down -->
<g id="node108" class="node">
<title>layer1_expert_5_down</title>
<path fill="lightcoral" stroke="black" d="M18757.5,-567.5C18757.5,-567.5 18657.5,-567.5 18657.5,-567.5 18651.5,-567.5 18645.5,-561.5 18645.5,-555.5 18645.5,-555.5 18645.5,-511.5 18645.5,-511.5 18645.5,-505.5 18651.5,-499.5 18657.5,-499.5 18657.5,-499.5 18757.5,-499.5 18757.5,-499.5 18763.5,-499.5 18769.5,-505.5 18769.5,-511.5 18769.5,-511.5 18769.5,-555.5 18769.5,-555.5 18769.5,-561.5 18763.5,-567.5 18757.5,-567.5"/>
<text text-anchor="middle" x="18707.5" y="-552.3" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="18707.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="18707.5" y="-522.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="18707.5" y="-507.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer1_expert_5_act&#45;&gt;layer1_expert_5_down -->
<g id="edge168" class="edge">
<title>layer1_expert_5_act&#45;&gt;layer1_expert_5_down</title>
<path fill="none" stroke="black" d="M18610,-533.5C18618.39,-533.5 18626.79,-533.5 18635.18,-533.5"/>
<polygon fill="black" stroke="black" points="18635.42,-537 18645.42,-533.5 18635.42,-530 18635.42,-537"/>
</g>
<!-- layer1_expert_5_out -->
<g id="node109" class="node">
<title>layer1_expert_5_out</title>
<path fill="lightpink" stroke="black" d="M18927.5,-560C18927.5,-560 18817.5,-560 18817.5,-560 18811.5,-560 18805.5,-554 18805.5,-548 18805.5,-548 18805.5,-519 18805.5,-519 18805.5,-513 18811.5,-507 18817.5,-507 18817.5,-507 18927.5,-507 18927.5,-507 18933.5,-507 18939.5,-513 18939.5,-519 18939.5,-519 18939.5,-548 18939.5,-548 18939.5,-554 18933.5,-560 18927.5,-560"/>
<text text-anchor="middle" x="18872.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 5 Output</text>
<text text-anchor="middle" x="18872.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="18872.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer1_expert_5_down&#45;&gt;layer1_expert_5_out -->
<g id="edge169" class="edge">
<title>layer1_expert_5_down&#45;&gt;layer1_expert_5_out</title>
<path fill="none" stroke="black" d="M18769.7,-533.5C18778.26,-533.5 18786.82,-533.5 18795.39,-533.5"/>
<polygon fill="black" stroke="black" points="18795.44,-537 18805.44,-533.5 18795.44,-530 18795.44,-537"/>
</g>
<!-- layer1_expert_5_out&#45;&gt;layer1_moe_agg -->
<g id="edge186" class="edge">
<title>layer1_expert_5_out&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M18896.87,-560.05C18912.53,-575.08 18934.24,-592.44 18957.5,-600.5 19062.14,-636.78 22838.05,-631.08 22944.5,-600.5 22959.94,-596.07 22975.31,-588.68 22989.38,-580.39"/>
<polygon fill="black" stroke="black" points="22991.26,-583.34 22997.97,-575.14 22987.61,-577.37 22991.26,-583.34"/>
</g>
<!-- layer1_expert_6_act -->
<g id="node111" class="node">
<title>layer1_expert_6_act</title>
<path fill="lightyellow" stroke="black" d="M17797,-560C17797,-560 17696,-560 17696,-560 17690,-560 17684,-554 17684,-548 17684,-548 17684,-519 17684,-519 17684,-513 17690,-507 17696,-507 17696,-507 17797,-507 17797,-507 17803,-507 17809,-513 17809,-519 17809,-519 17809,-548 17809,-548 17809,-554 17803,-560 17797,-560"/>
<text text-anchor="middle" x="17746.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="17746.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="17746.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_expert_6_up&#45;&gt;layer1_expert_6_act -->
<g id="edge172" class="edge">
<title>layer1_expert_6_up&#45;&gt;layer1_expert_6_act</title>
<path fill="none" stroke="black" d="M17648.72,-533.5C17657.05,-533.5 17665.37,-533.5 17673.7,-533.5"/>
<polygon fill="black" stroke="black" points="17673.86,-537 17683.86,-533.5 17673.86,-530 17673.86,-537"/>
</g>
<!-- layer1_expert_6_down -->
<g id="node112" class="node">
<title>layer1_expert_6_down</title>
<path fill="lightcoral" stroke="black" d="M17956.5,-567.5C17956.5,-567.5 17856.5,-567.5 17856.5,-567.5 17850.5,-567.5 17844.5,-561.5 17844.5,-555.5 17844.5,-555.5 17844.5,-511.5 17844.5,-511.5 17844.5,-505.5 17850.5,-499.5 17856.5,-499.5 17856.5,-499.5 17956.5,-499.5 17956.5,-499.5 17962.5,-499.5 17968.5,-505.5 17968.5,-511.5 17968.5,-511.5 17968.5,-555.5 17968.5,-555.5 17968.5,-561.5 17962.5,-567.5 17956.5,-567.5"/>
<text text-anchor="middle" x="17906.5" y="-552.3" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="17906.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="17906.5" y="-522.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="17906.5" y="-507.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer1_expert_6_act&#45;&gt;layer1_expert_6_down -->
<g id="edge173" class="edge">
<title>layer1_expert_6_act&#45;&gt;layer1_expert_6_down</title>
<path fill="none" stroke="black" d="M17809,-533.5C17817.39,-533.5 17825.79,-533.5 17834.18,-533.5"/>
<polygon fill="black" stroke="black" points="17834.42,-537 17844.42,-533.5 17834.42,-530 17834.42,-537"/>
</g>
<!-- layer1_expert_6_out -->
<g id="node113" class="node">
<title>layer1_expert_6_out</title>
<path fill="lightpink" stroke="black" d="M18126.5,-560C18126.5,-560 18016.5,-560 18016.5,-560 18010.5,-560 18004.5,-554 18004.5,-548 18004.5,-548 18004.5,-519 18004.5,-519 18004.5,-513 18010.5,-507 18016.5,-507 18016.5,-507 18126.5,-507 18126.5,-507 18132.5,-507 18138.5,-513 18138.5,-519 18138.5,-519 18138.5,-548 18138.5,-548 18138.5,-554 18132.5,-560 18126.5,-560"/>
<text text-anchor="middle" x="18071.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 6 Output</text>
<text text-anchor="middle" x="18071.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="18071.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer1_expert_6_down&#45;&gt;layer1_expert_6_out -->
<g id="edge174" class="edge">
<title>layer1_expert_6_down&#45;&gt;layer1_expert_6_out</title>
<path fill="none" stroke="black" d="M17968.7,-533.5C17977.26,-533.5 17985.82,-533.5 17994.39,-533.5"/>
<polygon fill="black" stroke="black" points="17994.44,-537 18004.44,-533.5 17994.44,-530 17994.44,-537"/>
</g>
<!-- layer1_expert_6_out&#45;&gt;layer1_moe_agg -->
<g id="edge187" class="edge">
<title>layer1_expert_6_out&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M18095.87,-560.05C18111.53,-575.08 18133.24,-592.44 18156.5,-600.5 18219.33,-622.29 22880.58,-618.86 22944.5,-600.5 22959.94,-596.07 22975.31,-588.68 22989.38,-580.39"/>
<polygon fill="black" stroke="black" points="22991.26,-583.34 22997.97,-575.14 22987.61,-577.37 22991.26,-583.34"/>
</g>
<!-- layer1_expert_7_act -->
<g id="node115" class="node">
<title>layer1_expert_7_act</title>
<path fill="lightyellow" stroke="black" d="M16996,-560C16996,-560 16895,-560 16895,-560 16889,-560 16883,-554 16883,-548 16883,-548 16883,-519 16883,-519 16883,-513 16889,-507 16895,-507 16895,-507 16996,-507 16996,-507 17002,-507 17008,-513 17008,-519 17008,-519 17008,-548 17008,-548 17008,-554 17002,-560 16996,-560"/>
<text text-anchor="middle" x="16945.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="16945.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="16945.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_expert_7_up&#45;&gt;layer1_expert_7_act -->
<g id="edge177" class="edge">
<title>layer1_expert_7_up&#45;&gt;layer1_expert_7_act</title>
<path fill="none" stroke="black" d="M16847.72,-533.5C16856.05,-533.5 16864.37,-533.5 16872.7,-533.5"/>
<polygon fill="black" stroke="black" points="16872.86,-537 16882.86,-533.5 16872.86,-530 16872.86,-537"/>
</g>
<!-- layer1_expert_7_down -->
<g id="node116" class="node">
<title>layer1_expert_7_down</title>
<path fill="lightcoral" stroke="black" d="M17155.5,-567.5C17155.5,-567.5 17055.5,-567.5 17055.5,-567.5 17049.5,-567.5 17043.5,-561.5 17043.5,-555.5 17043.5,-555.5 17043.5,-511.5 17043.5,-511.5 17043.5,-505.5 17049.5,-499.5 17055.5,-499.5 17055.5,-499.5 17155.5,-499.5 17155.5,-499.5 17161.5,-499.5 17167.5,-505.5 17167.5,-511.5 17167.5,-511.5 17167.5,-555.5 17167.5,-555.5 17167.5,-561.5 17161.5,-567.5 17155.5,-567.5"/>
<text text-anchor="middle" x="17105.5" y="-552.3" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="17105.5" y="-537.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="17105.5" y="-522.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="17105.5" y="-507.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer1_expert_7_act&#45;&gt;layer1_expert_7_down -->
<g id="edge178" class="edge">
<title>layer1_expert_7_act&#45;&gt;layer1_expert_7_down</title>
<path fill="none" stroke="black" d="M17008,-533.5C17016.39,-533.5 17024.79,-533.5 17033.18,-533.5"/>
<polygon fill="black" stroke="black" points="17033.42,-537 17043.42,-533.5 17033.42,-530 17033.42,-537"/>
</g>
<!-- layer1_expert_7_out -->
<g id="node117" class="node">
<title>layer1_expert_7_out</title>
<path fill="lightpink" stroke="black" d="M17325.5,-560C17325.5,-560 17215.5,-560 17215.5,-560 17209.5,-560 17203.5,-554 17203.5,-548 17203.5,-548 17203.5,-519 17203.5,-519 17203.5,-513 17209.5,-507 17215.5,-507 17215.5,-507 17325.5,-507 17325.5,-507 17331.5,-507 17337.5,-513 17337.5,-519 17337.5,-519 17337.5,-548 17337.5,-548 17337.5,-554 17331.5,-560 17325.5,-560"/>
<text text-anchor="middle" x="17270.5" y="-544.8" font-family="Times,serif" font-size="14.00">Expert 7 Output</text>
<text text-anchor="middle" x="17270.5" y="-529.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="17270.5" y="-514.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer1_expert_7_down&#45;&gt;layer1_expert_7_out -->
<g id="edge179" class="edge">
<title>layer1_expert_7_down&#45;&gt;layer1_expert_7_out</title>
<path fill="none" stroke="black" d="M17167.7,-533.5C17176.26,-533.5 17184.82,-533.5 17193.39,-533.5"/>
<polygon fill="black" stroke="black" points="17193.44,-537 17203.44,-533.5 17193.44,-530 17193.44,-537"/>
</g>
<!-- layer1_expert_7_out&#45;&gt;layer1_moe_agg -->
<g id="edge188" class="edge">
<title>layer1_expert_7_out&#45;&gt;layer1_moe_agg</title>
<path fill="none" stroke="black" d="M17294.87,-560.05C17310.53,-575.08 17332.24,-592.44 17355.5,-600.5 17428.84,-625.93 22869.89,-621.93 22944.5,-600.5 22959.94,-596.07 22975.31,-588.68 22989.38,-580.39"/>
<polygon fill="black" stroke="black" points="22991.26,-583.34 22997.97,-575.14 22987.61,-577.37 22991.26,-583.34"/>
</g>
<!-- layer2_q_0_0 -->
<g id="node119" class="node">
<title>layer2_q_0_0</title>
<path fill="lightcoral" stroke="black" d="M38273,-441C38273,-441 38090,-441 38090,-441 38084,-441 38078,-435 38078,-429 38078,-429 38078,-370 38078,-370 38078,-364 38084,-358 38090,-358 38090,-358 38273,-358 38273,-358 38279,-358 38285,-364 38285,-370 38285,-370 38285,-429 38285,-429 38285,-435 38279,-441 38273,-441"/>
<text text-anchor="middle" x="38181.5" y="-425.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="38181.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="38181.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="38181.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="38181.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_q_0_0 -->
<g id="edge190" class="edge">
<title>layer2_ln1&#45;&gt;layer2_q_0_0</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23408.8,-498.46 37960.3,-491.95 38059.5,-466.5 38077.08,-461.99 38094.84,-454.36 38111.17,-445.83"/>
<polygon fill="black" stroke="black" points="38112.95,-448.85 38120.08,-441.01 38109.62,-442.69 38112.95,-448.85"/>
</g>
<!-- layer2_k_0_0 -->
<g id="node120" class="node">
<title>layer2_k_0_0</title>
<path fill="lightcoral" stroke="black" d="M38048,-441C38048,-441 37865,-441 37865,-441 37859,-441 37853,-435 37853,-429 37853,-429 37853,-370 37853,-370 37853,-364 37859,-358 37865,-358 37865,-358 38048,-358 38048,-358 38054,-358 38060,-364 38060,-370 38060,-370 38060,-429 38060,-429 38060,-435 38054,-441 38048,-441"/>
<text text-anchor="middle" x="37956.5" y="-425.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="37956.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="37956.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="37956.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="37956.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_k_0_0 -->
<g id="edge191" class="edge">
<title>layer2_ln1&#45;&gt;layer2_k_0_0</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23407.32,-497.97 37736.81,-491.56 37834.5,-466.5 37852.08,-461.99 37869.84,-454.36 37886.17,-445.83"/>
<polygon fill="black" stroke="black" points="37887.95,-448.85 37895.08,-441.01 37884.62,-442.69 37887.95,-448.85"/>
</g>
<!-- layer2_v_0_0 -->
<g id="node121" class="node">
<title>layer2_v_0_0</title>
<path fill="lightcoral" stroke="black" d="M37823,-441C37823,-441 37640,-441 37640,-441 37634,-441 37628,-435 37628,-429 37628,-429 37628,-370 37628,-370 37628,-364 37634,-358 37640,-358 37640,-358 37823,-358 37823,-358 37829,-358 37835,-364 37835,-370 37835,-370 37835,-429 37835,-429 37835,-435 37829,-441 37823,-441"/>
<text text-anchor="middle" x="37731.5" y="-425.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="37731.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="37731.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="37731.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="37731.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_v_0_0 -->
<g id="edge192" class="edge">
<title>layer2_ln1&#45;&gt;layer2_v_0_0</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23405.83,-497.48 37513.32,-491.17 37609.5,-466.5 37627.08,-461.99 37644.84,-454.36 37661.17,-445.83"/>
<polygon fill="black" stroke="black" points="37662.95,-448.85 37670.08,-441.01 37659.62,-442.69 37662.95,-448.85"/>
</g>
<!-- layer2_q_0_1 -->
<g id="node122" class="node">
<title>layer2_q_0_1</title>
<path fill="lightcoral" stroke="black" d="M37355,-441C37355,-441 37172,-441 37172,-441 37166,-441 37160,-435 37160,-429 37160,-429 37160,-370 37160,-370 37160,-364 37166,-358 37172,-358 37172,-358 37355,-358 37355,-358 37361,-358 37367,-364 37367,-370 37367,-370 37367,-429 37367,-429 37367,-435 37361,-441 37355,-441"/>
<text text-anchor="middle" x="37263.5" y="-425.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="37263.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="37263.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="37263.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="37263.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_q_0_1 -->
<g id="edge193" class="edge">
<title>layer2_ln1&#45;&gt;layer2_q_0_1</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23402.75,-496.47 37048.47,-490.36 37141.5,-466.5 37159.08,-461.99 37176.84,-454.36 37193.17,-445.83"/>
<polygon fill="black" stroke="black" points="37194.95,-448.85 37202.08,-441.01 37191.62,-442.69 37194.95,-448.85"/>
</g>
<!-- layer2_k_0_1 -->
<g id="node123" class="node">
<title>layer2_k_0_1</title>
<path fill="lightcoral" stroke="black" d="M37130,-441C37130,-441 36947,-441 36947,-441 36941,-441 36935,-435 36935,-429 36935,-429 36935,-370 36935,-370 36935,-364 36941,-358 36947,-358 36947,-358 37130,-358 37130,-358 37136,-358 37142,-364 37142,-370 37142,-370 37142,-429 37142,-429 37142,-435 37136,-441 37130,-441"/>
<text text-anchor="middle" x="37038.5" y="-425.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="37038.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="37038.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="37038.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="37038.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_k_0_1 -->
<g id="edge194" class="edge">
<title>layer2_ln1&#45;&gt;layer2_k_0_1</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23401.26,-495.98 36824.98,-489.98 36916.5,-466.5 36934.08,-461.99 36951.84,-454.36 36968.17,-445.83"/>
<polygon fill="black" stroke="black" points="36969.95,-448.85 36977.08,-441.01 36966.62,-442.69 36969.95,-448.85"/>
</g>
<!-- layer2_v_0_1 -->
<g id="node124" class="node">
<title>layer2_v_0_1</title>
<path fill="lightcoral" stroke="black" d="M36905,-441C36905,-441 36722,-441 36722,-441 36716,-441 36710,-435 36710,-429 36710,-429 36710,-370 36710,-370 36710,-364 36716,-358 36722,-358 36722,-358 36905,-358 36905,-358 36911,-358 36917,-364 36917,-370 36917,-370 36917,-429 36917,-429 36917,-435 36911,-441 36905,-441"/>
<text text-anchor="middle" x="36813.5" y="-425.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="36813.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="36813.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="36813.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="36813.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_v_0_1 -->
<g id="edge195" class="edge">
<title>layer2_ln1&#45;&gt;layer2_v_0_1</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23399.78,-495.49 36601.5,-489.59 36691.5,-466.5 36709.08,-461.99 36726.84,-454.36 36743.17,-445.83"/>
<polygon fill="black" stroke="black" points="36744.95,-448.85 36752.08,-441.01 36741.62,-442.69 36744.95,-448.85"/>
</g>
<!-- layer2_q_0_2 -->
<g id="node125" class="node">
<title>layer2_q_0_2</title>
<path fill="lightcoral" stroke="black" d="M36437,-441C36437,-441 36254,-441 36254,-441 36248,-441 36242,-435 36242,-429 36242,-429 36242,-370 36242,-370 36242,-364 36248,-358 36254,-358 36254,-358 36437,-358 36437,-358 36443,-358 36449,-364 36449,-370 36449,-370 36449,-429 36449,-429 36449,-435 36443,-441 36437,-441"/>
<text text-anchor="middle" x="36345.5" y="-425.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="36345.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="36345.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="36345.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="36345.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_q_0_2 -->
<g id="edge196" class="edge">
<title>layer2_ln1&#45;&gt;layer2_q_0_2</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23396.69,-494.48 36136.65,-488.78 36223.5,-466.5 36241.08,-461.99 36258.84,-454.36 36275.17,-445.83"/>
<polygon fill="black" stroke="black" points="36276.95,-448.85 36284.08,-441.01 36273.62,-442.69 36276.95,-448.85"/>
</g>
<!-- layer2_k_0_2 -->
<g id="node126" class="node">
<title>layer2_k_0_2</title>
<path fill="lightcoral" stroke="black" d="M36212,-441C36212,-441 36029,-441 36029,-441 36023,-441 36017,-435 36017,-429 36017,-429 36017,-370 36017,-370 36017,-364 36023,-358 36029,-358 36029,-358 36212,-358 36212,-358 36218,-358 36224,-364 36224,-370 36224,-370 36224,-429 36224,-429 36224,-435 36218,-441 36212,-441"/>
<text text-anchor="middle" x="36120.5" y="-425.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="36120.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="36120.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="36120.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="36120.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_k_0_2 -->
<g id="edge197" class="edge">
<title>layer2_ln1&#45;&gt;layer2_k_0_2</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23395.21,-493.99 35913.16,-488.39 35998.5,-466.5 36016.08,-461.99 36033.84,-454.36 36050.17,-445.83"/>
<polygon fill="black" stroke="black" points="36051.95,-448.85 36059.08,-441.01 36048.62,-442.69 36051.95,-448.85"/>
</g>
<!-- layer2_v_0_2 -->
<g id="node127" class="node">
<title>layer2_v_0_2</title>
<path fill="lightcoral" stroke="black" d="M35987,-441C35987,-441 35804,-441 35804,-441 35798,-441 35792,-435 35792,-429 35792,-429 35792,-370 35792,-370 35792,-364 35798,-358 35804,-358 35804,-358 35987,-358 35987,-358 35993,-358 35999,-364 35999,-370 35999,-370 35999,-429 35999,-429 35999,-435 35993,-441 35987,-441"/>
<text text-anchor="middle" x="35895.5" y="-425.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="35895.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="35895.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="35895.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="35895.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_v_0_2 -->
<g id="edge198" class="edge">
<title>layer2_ln1&#45;&gt;layer2_v_0_2</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23393.72,-493.5 35689.67,-488 35773.5,-466.5 35791.08,-461.99 35808.84,-454.36 35825.17,-445.83"/>
<polygon fill="black" stroke="black" points="35826.95,-448.85 35834.08,-441.01 35823.62,-442.69 35826.95,-448.85"/>
</g>
<!-- layer2_q_0_3 -->
<g id="node128" class="node">
<title>layer2_q_0_3</title>
<path fill="lightcoral" stroke="black" d="M35519,-441C35519,-441 35336,-441 35336,-441 35330,-441 35324,-435 35324,-429 35324,-429 35324,-370 35324,-370 35324,-364 35330,-358 35336,-358 35336,-358 35519,-358 35519,-358 35525,-358 35531,-364 35531,-370 35531,-370 35531,-429 35531,-429 35531,-435 35525,-441 35519,-441"/>
<text text-anchor="middle" x="35427.5" y="-425.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="35427.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="35427.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="35427.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="35427.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_q_0_3 -->
<g id="edge199" class="edge">
<title>layer2_ln1&#45;&gt;layer2_q_0_3</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23390.63,-492.49 35224.82,-487.2 35305.5,-466.5 35323.08,-461.99 35340.84,-454.36 35357.17,-445.83"/>
<polygon fill="black" stroke="black" points="35358.95,-448.85 35366.08,-441.01 35355.62,-442.69 35358.95,-448.85"/>
</g>
<!-- layer2_k_0_3 -->
<g id="node129" class="node">
<title>layer2_k_0_3</title>
<path fill="lightcoral" stroke="black" d="M35294,-441C35294,-441 35111,-441 35111,-441 35105,-441 35099,-435 35099,-429 35099,-429 35099,-370 35099,-370 35099,-364 35105,-358 35111,-358 35111,-358 35294,-358 35294,-358 35300,-358 35306,-364 35306,-370 35306,-370 35306,-429 35306,-429 35306,-435 35300,-441 35294,-441"/>
<text text-anchor="middle" x="35202.5" y="-425.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="35202.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="35202.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="35202.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="35202.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_k_0_3 -->
<g id="edge200" class="edge">
<title>layer2_ln1&#45;&gt;layer2_k_0_3</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23389.15,-492 35001.33,-486.81 35080.5,-466.5 35098.08,-461.99 35115.84,-454.36 35132.17,-445.83"/>
<polygon fill="black" stroke="black" points="35133.95,-448.85 35141.08,-441.01 35130.62,-442.69 35133.95,-448.85"/>
</g>
<!-- layer2_v_0_3 -->
<g id="node130" class="node">
<title>layer2_v_0_3</title>
<path fill="lightcoral" stroke="black" d="M35069,-441C35069,-441 34886,-441 34886,-441 34880,-441 34874,-435 34874,-429 34874,-429 34874,-370 34874,-370 34874,-364 34880,-358 34886,-358 34886,-358 35069,-358 35069,-358 35075,-358 35081,-364 35081,-370 35081,-370 35081,-429 35081,-429 35081,-435 35075,-441 35069,-441"/>
<text text-anchor="middle" x="34977.5" y="-425.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="34977.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="34977.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="34977.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="34977.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_v_0_3 -->
<g id="edge201" class="edge">
<title>layer2_ln1&#45;&gt;layer2_v_0_3</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23387.66,-491.51 34777.85,-486.42 34855.5,-466.5 34873.08,-461.99 34890.84,-454.36 34907.17,-445.83"/>
<polygon fill="black" stroke="black" points="34908.95,-448.85 34916.08,-441.01 34905.62,-442.69 34908.95,-448.85"/>
</g>
<!-- layer2_q_1_0 -->
<g id="node131" class="node">
<title>layer2_q_1_0</title>
<path fill="lightcoral" stroke="black" d="M34419,-441C34419,-441 34236,-441 34236,-441 34230,-441 34224,-435 34224,-429 34224,-429 34224,-370 34224,-370 34224,-364 34230,-358 34236,-358 34236,-358 34419,-358 34419,-358 34425,-358 34431,-364 34431,-370 34431,-370 34431,-429 34431,-429 34431,-435 34425,-441 34419,-441"/>
<text text-anchor="middle" x="34327.5" y="-425.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="34327.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="34327.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="34327.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="34327.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_q_1_0 -->
<g id="edge202" class="edge">
<title>layer2_ln1&#45;&gt;layer2_q_1_0</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23383.38,-490.11 34132.22,-485.3 34205.5,-466.5 34223.08,-461.99 34240.84,-454.36 34257.17,-445.83"/>
<polygon fill="black" stroke="black" points="34258.95,-448.85 34266.08,-441.01 34255.62,-442.69 34258.95,-448.85"/>
</g>
<!-- layer2_k_1_0 -->
<g id="node132" class="node">
<title>layer2_k_1_0</title>
<path fill="lightcoral" stroke="black" d="M34194,-441C34194,-441 34011,-441 34011,-441 34005,-441 33999,-435 33999,-429 33999,-429 33999,-370 33999,-370 33999,-364 34005,-358 34011,-358 34011,-358 34194,-358 34194,-358 34200,-358 34206,-364 34206,-370 34206,-370 34206,-429 34206,-429 34206,-435 34200,-441 34194,-441"/>
<text text-anchor="middle" x="34102.5" y="-425.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="34102.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="34102.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="34102.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="34102.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_k_1_0 -->
<g id="edge203" class="edge">
<title>layer2_ln1&#45;&gt;layer2_k_1_0</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23381.89,-489.62 33908.73,-484.91 33980.5,-466.5 33998.08,-461.99 34015.84,-454.36 34032.17,-445.83"/>
<polygon fill="black" stroke="black" points="34033.95,-448.85 34041.08,-441.01 34030.62,-442.69 34033.95,-448.85"/>
</g>
<!-- layer2_v_1_0 -->
<g id="node133" class="node">
<title>layer2_v_1_0</title>
<path fill="lightcoral" stroke="black" d="M33969,-441C33969,-441 33786,-441 33786,-441 33780,-441 33774,-435 33774,-429 33774,-429 33774,-370 33774,-370 33774,-364 33780,-358 33786,-358 33786,-358 33969,-358 33969,-358 33975,-358 33981,-364 33981,-370 33981,-370 33981,-429 33981,-429 33981,-435 33975,-441 33969,-441"/>
<text text-anchor="middle" x="33877.5" y="-425.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="33877.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="33877.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="33877.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="33877.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_v_1_0 -->
<g id="edge204" class="edge">
<title>layer2_ln1&#45;&gt;layer2_v_1_0</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23380.41,-489.13 33685.25,-484.52 33755.5,-466.5 33773.08,-461.99 33790.84,-454.36 33807.17,-445.83"/>
<polygon fill="black" stroke="black" points="33808.95,-448.85 33816.08,-441.01 33805.62,-442.69 33808.95,-448.85"/>
</g>
<!-- layer2_q_1_1 -->
<g id="node134" class="node">
<title>layer2_q_1_1</title>
<path fill="lightcoral" stroke="black" d="M33501,-441C33501,-441 33318,-441 33318,-441 33312,-441 33306,-435 33306,-429 33306,-429 33306,-370 33306,-370 33306,-364 33312,-358 33318,-358 33318,-358 33501,-358 33501,-358 33507,-358 33513,-364 33513,-370 33513,-370 33513,-429 33513,-429 33513,-435 33507,-441 33501,-441"/>
<text text-anchor="middle" x="33409.5" y="-425.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="33409.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="33409.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="33409.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="33409.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_q_1_1 -->
<g id="edge205" class="edge">
<title>layer2_ln1&#45;&gt;layer2_q_1_1</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23377.32,-488.12 33220.39,-483.71 33287.5,-466.5 33305.08,-461.99 33322.84,-454.36 33339.17,-445.83"/>
<polygon fill="black" stroke="black" points="33340.95,-448.85 33348.08,-441.01 33337.62,-442.69 33340.95,-448.85"/>
</g>
<!-- layer2_k_1_1 -->
<g id="node135" class="node">
<title>layer2_k_1_1</title>
<path fill="lightcoral" stroke="black" d="M33276,-441C33276,-441 33093,-441 33093,-441 33087,-441 33081,-435 33081,-429 33081,-429 33081,-370 33081,-370 33081,-364 33087,-358 33093,-358 33093,-358 33276,-358 33276,-358 33282,-358 33288,-364 33288,-370 33288,-370 33288,-429 33288,-429 33288,-435 33282,-441 33276,-441"/>
<text text-anchor="middle" x="33184.5" y="-425.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="33184.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="33184.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="33184.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="33184.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_k_1_1 -->
<g id="edge206" class="edge">
<title>layer2_ln1&#45;&gt;layer2_k_1_1</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23375.83,-487.63 32996.91,-483.33 33062.5,-466.5 33080.08,-461.99 33097.84,-454.36 33114.17,-445.83"/>
<polygon fill="black" stroke="black" points="33115.95,-448.85 33123.08,-441.01 33112.62,-442.69 33115.95,-448.85"/>
</g>
<!-- layer2_v_1_1 -->
<g id="node136" class="node">
<title>layer2_v_1_1</title>
<path fill="lightcoral" stroke="black" d="M33051,-441C33051,-441 32868,-441 32868,-441 32862,-441 32856,-435 32856,-429 32856,-429 32856,-370 32856,-370 32856,-364 32862,-358 32868,-358 32868,-358 33051,-358 33051,-358 33057,-358 33063,-364 33063,-370 33063,-370 33063,-429 33063,-429 33063,-435 33057,-441 33051,-441"/>
<text text-anchor="middle" x="32959.5" y="-425.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="32959.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="32959.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="32959.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="32959.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_v_1_1 -->
<g id="edge207" class="edge">
<title>layer2_ln1&#45;&gt;layer2_v_1_1</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23374.35,-487.14 32773.42,-482.94 32837.5,-466.5 32855.08,-461.99 32872.84,-454.36 32889.17,-445.83"/>
<polygon fill="black" stroke="black" points="32890.95,-448.85 32898.08,-441.01 32887.62,-442.69 32890.95,-448.85"/>
</g>
<!-- layer2_q_1_2 -->
<g id="node137" class="node">
<title>layer2_q_1_2</title>
<path fill="lightcoral" stroke="black" d="M32583,-441C32583,-441 32400,-441 32400,-441 32394,-441 32388,-435 32388,-429 32388,-429 32388,-370 32388,-370 32388,-364 32394,-358 32400,-358 32400,-358 32583,-358 32583,-358 32589,-358 32595,-364 32595,-370 32595,-370 32595,-429 32595,-429 32595,-435 32589,-441 32583,-441"/>
<text text-anchor="middle" x="32491.5" y="-425.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="32491.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="32491.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="32491.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="32491.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_q_1_2 -->
<g id="edge208" class="edge">
<title>layer2_ln1&#45;&gt;layer2_q_1_2</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23371.26,-486.13 32308.57,-482.13 32369.5,-466.5 32387.08,-461.99 32404.84,-454.36 32421.17,-445.83"/>
<polygon fill="black" stroke="black" points="32422.95,-448.85 32430.08,-441.01 32419.62,-442.69 32422.95,-448.85"/>
</g>
<!-- layer2_k_1_2 -->
<g id="node138" class="node">
<title>layer2_k_1_2</title>
<path fill="lightcoral" stroke="black" d="M32358,-441C32358,-441 32175,-441 32175,-441 32169,-441 32163,-435 32163,-429 32163,-429 32163,-370 32163,-370 32163,-364 32169,-358 32175,-358 32175,-358 32358,-358 32358,-358 32364,-358 32370,-364 32370,-370 32370,-370 32370,-429 32370,-429 32370,-435 32364,-441 32358,-441"/>
<text text-anchor="middle" x="32266.5" y="-425.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="32266.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="32266.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="32266.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="32266.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_k_1_2 -->
<g id="edge209" class="edge">
<title>layer2_ln1&#45;&gt;layer2_k_1_2</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23369.78,-485.64 32085.08,-481.74 32144.5,-466.5 32162.08,-461.99 32179.84,-454.36 32196.17,-445.83"/>
<polygon fill="black" stroke="black" points="32197.95,-448.85 32205.08,-441.01 32194.62,-442.69 32197.95,-448.85"/>
</g>
<!-- layer2_v_1_2 -->
<g id="node139" class="node">
<title>layer2_v_1_2</title>
<path fill="lightcoral" stroke="black" d="M32133,-441C32133,-441 31950,-441 31950,-441 31944,-441 31938,-435 31938,-429 31938,-429 31938,-370 31938,-370 31938,-364 31944,-358 31950,-358 31950,-358 32133,-358 32133,-358 32139,-358 32145,-364 32145,-370 32145,-370 32145,-429 32145,-429 32145,-435 32139,-441 32133,-441"/>
<text text-anchor="middle" x="32041.5" y="-425.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="32041.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="32041.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="32041.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="32041.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_v_1_2 -->
<g id="edge210" class="edge">
<title>layer2_ln1&#45;&gt;layer2_v_1_2</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23425.09,-503.8 31803.69,-496.21 31919.5,-466.5 31937.08,-461.99 31954.84,-454.36 31971.17,-445.83"/>
<polygon fill="black" stroke="black" points="31972.95,-448.85 31980.08,-441.01 31969.62,-442.69 31972.95,-448.85"/>
</g>
<!-- layer2_q_1_3 -->
<g id="node140" class="node">
<title>layer2_q_1_3</title>
<path fill="lightcoral" stroke="black" d="M31665,-441C31665,-441 31482,-441 31482,-441 31476,-441 31470,-435 31470,-429 31470,-429 31470,-370 31470,-370 31470,-364 31476,-358 31482,-358 31482,-358 31665,-358 31665,-358 31671,-358 31677,-364 31677,-370 31677,-370 31677,-429 31677,-429 31677,-435 31671,-441 31665,-441"/>
<text text-anchor="middle" x="31573.5" y="-425.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="31573.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="31573.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="31573.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="31573.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_q_1_3 -->
<g id="edge211" class="edge">
<title>layer2_ln1&#45;&gt;layer2_q_1_3</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23418.91,-501.78 31341.99,-494.59 31451.5,-466.5 31469.08,-461.99 31486.84,-454.36 31503.17,-445.83"/>
<polygon fill="black" stroke="black" points="31504.95,-448.85 31512.08,-441.01 31501.62,-442.69 31504.95,-448.85"/>
</g>
<!-- layer2_k_1_3 -->
<g id="node141" class="node">
<title>layer2_k_1_3</title>
<path fill="lightcoral" stroke="black" d="M31440,-441C31440,-441 31257,-441 31257,-441 31251,-441 31245,-435 31245,-429 31245,-429 31245,-370 31245,-370 31245,-364 31251,-358 31257,-358 31257,-358 31440,-358 31440,-358 31446,-358 31452,-364 31452,-370 31452,-370 31452,-429 31452,-429 31452,-435 31446,-441 31440,-441"/>
<text text-anchor="middle" x="31348.5" y="-425.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="31348.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="31348.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="31348.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="31348.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_k_1_3 -->
<g id="edge212" class="edge">
<title>layer2_ln1&#45;&gt;layer2_k_1_3</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23415.94,-500.8 31120.02,-493.82 31226.5,-466.5 31244.08,-461.99 31261.84,-454.36 31278.17,-445.83"/>
<polygon fill="black" stroke="black" points="31279.95,-448.85 31287.08,-441.01 31276.62,-442.69 31279.95,-448.85"/>
</g>
<!-- layer2_v_1_3 -->
<g id="node142" class="node">
<title>layer2_v_1_3</title>
<path fill="lightcoral" stroke="black" d="M31215,-441C31215,-441 31032,-441 31032,-441 31026,-441 31020,-435 31020,-429 31020,-429 31020,-370 31020,-370 31020,-364 31026,-358 31032,-358 31032,-358 31215,-358 31215,-358 31221,-358 31227,-364 31227,-370 31227,-370 31227,-429 31227,-429 31227,-435 31221,-441 31215,-441"/>
<text text-anchor="middle" x="31123.5" y="-425.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="31123.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="31123.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="31123.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="31123.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_v_1_3 -->
<g id="edge213" class="edge">
<title>layer2_ln1&#45;&gt;layer2_v_1_3</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23412.97,-499.83 30898.04,-493.04 31001.5,-466.5 31019.08,-461.99 31036.84,-454.36 31053.17,-445.83"/>
<polygon fill="black" stroke="black" points="31054.95,-448.85 31062.08,-441.01 31051.62,-442.69 31054.95,-448.85"/>
</g>
<!-- layer2_q_2_0 -->
<g id="node143" class="node">
<title>layer2_q_2_0</title>
<path fill="lightcoral" stroke="black" d="M30565,-441C30565,-441 30382,-441 30382,-441 30376,-441 30370,-435 30370,-429 30370,-429 30370,-370 30370,-370 30370,-364 30376,-358 30382,-358 30382,-358 30565,-358 30565,-358 30571,-358 30577,-364 30577,-370 30577,-370 30577,-429 30577,-429 30577,-435 30571,-441 30565,-441"/>
<text text-anchor="middle" x="30473.5" y="-425.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="30473.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="30473.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="30473.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="30473.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_q_2_0 -->
<g id="edge214" class="edge">
<title>layer2_ln1&#45;&gt;layer2_q_2_0</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23404.4,-497.01 30256.79,-490.8 30351.5,-466.5 30369.08,-461.99 30386.84,-454.36 30403.17,-445.83"/>
<polygon fill="black" stroke="black" points="30404.95,-448.85 30412.08,-441.01 30401.62,-442.69 30404.95,-448.85"/>
</g>
<!-- layer2_k_2_0 -->
<g id="node144" class="node">
<title>layer2_k_2_0</title>
<path fill="lightcoral" stroke="black" d="M30340,-441C30340,-441 30157,-441 30157,-441 30151,-441 30145,-435 30145,-429 30145,-429 30145,-370 30145,-370 30145,-364 30151,-358 30157,-358 30157,-358 30340,-358 30340,-358 30346,-358 30352,-364 30352,-370 30352,-370 30352,-429 30352,-429 30352,-435 30346,-441 30340,-441"/>
<text text-anchor="middle" x="30248.5" y="-425.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="30248.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="30248.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="30248.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="30248.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_k_2_0 -->
<g id="edge215" class="edge">
<title>layer2_ln1&#45;&gt;layer2_k_2_0</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23401.43,-496.03 30034.82,-490.02 30126.5,-466.5 30144.08,-461.99 30161.84,-454.36 30178.17,-445.83"/>
<polygon fill="black" stroke="black" points="30179.95,-448.85 30187.08,-441.01 30176.62,-442.69 30179.95,-448.85"/>
</g>
<!-- layer2_v_2_0 -->
<g id="node145" class="node">
<title>layer2_v_2_0</title>
<path fill="lightcoral" stroke="black" d="M30115,-441C30115,-441 29932,-441 29932,-441 29926,-441 29920,-435 29920,-429 29920,-429 29920,-370 29920,-370 29920,-364 29926,-358 29932,-358 29932,-358 30115,-358 30115,-358 30121,-358 30127,-364 30127,-370 30127,-370 30127,-429 30127,-429 30127,-435 30121,-441 30115,-441"/>
<text text-anchor="middle" x="30023.5" y="-425.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="30023.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="30023.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="30023.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="30023.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_v_2_0 -->
<g id="edge216" class="edge">
<title>layer2_ln1&#45;&gt;layer2_v_2_0</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23398.46,-495.06 29812.84,-489.24 29901.5,-466.5 29919.08,-461.99 29936.84,-454.36 29953.17,-445.83"/>
<polygon fill="black" stroke="black" points="29954.95,-448.85 29962.08,-441.01 29951.62,-442.69 29954.95,-448.85"/>
</g>
<!-- layer2_q_2_1 -->
<g id="node146" class="node">
<title>layer2_q_2_1</title>
<path fill="lightcoral" stroke="black" d="M29647,-441C29647,-441 29464,-441 29464,-441 29458,-441 29452,-435 29452,-429 29452,-429 29452,-370 29452,-370 29452,-364 29458,-358 29464,-358 29464,-358 29647,-358 29647,-358 29653,-358 29659,-364 29659,-370 29659,-370 29659,-429 29659,-429 29659,-435 29653,-441 29647,-441"/>
<text text-anchor="middle" x="29555.5" y="-425.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="29555.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="29555.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="29555.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="29555.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_q_2_1 -->
<g id="edge217" class="edge">
<title>layer2_ln1&#45;&gt;layer2_q_2_1</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23392.28,-493.03 29351.14,-487.63 29433.5,-466.5 29451.08,-461.99 29468.84,-454.36 29485.17,-445.83"/>
<polygon fill="black" stroke="black" points="29486.95,-448.85 29494.08,-441.01 29483.62,-442.69 29486.95,-448.85"/>
</g>
<!-- layer2_k_2_1 -->
<g id="node147" class="node">
<title>layer2_k_2_1</title>
<path fill="lightcoral" stroke="black" d="M29422,-441C29422,-441 29239,-441 29239,-441 29233,-441 29227,-435 29227,-429 29227,-429 29227,-370 29227,-370 29227,-364 29233,-358 29239,-358 29239,-358 29422,-358 29422,-358 29428,-358 29434,-364 29434,-370 29434,-370 29434,-429 29434,-429 29434,-435 29428,-441 29422,-441"/>
<text text-anchor="middle" x="29330.5" y="-425.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="29330.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="29330.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="29330.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="29330.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_k_2_1 -->
<g id="edge218" class="edge">
<title>layer2_ln1&#45;&gt;layer2_k_2_1</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23389.31,-492.06 29129.17,-486.85 29208.5,-466.5 29226.08,-461.99 29243.84,-454.36 29260.17,-445.83"/>
<polygon fill="black" stroke="black" points="29261.95,-448.85 29269.08,-441.01 29258.62,-442.69 29261.95,-448.85"/>
</g>
<!-- layer2_v_2_1 -->
<g id="node148" class="node">
<title>layer2_v_2_1</title>
<path fill="lightcoral" stroke="black" d="M29197,-441C29197,-441 29014,-441 29014,-441 29008,-441 29002,-435 29002,-429 29002,-429 29002,-370 29002,-370 29002,-364 29008,-358 29014,-358 29014,-358 29197,-358 29197,-358 29203,-358 29209,-364 29209,-370 29209,-370 29209,-429 29209,-429 29209,-435 29203,-441 29197,-441"/>
<text text-anchor="middle" x="29105.5" y="-425.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="29105.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="29105.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="29105.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="29105.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_v_2_1 -->
<g id="edge219" class="edge">
<title>layer2_ln1&#45;&gt;layer2_v_2_1</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23386.34,-491.08 28907.19,-486.07 28983.5,-466.5 29001.08,-461.99 29018.84,-454.36 29035.17,-445.83"/>
<polygon fill="black" stroke="black" points="29036.95,-448.85 29044.08,-441.01 29033.62,-442.69 29036.95,-448.85"/>
</g>
<!-- layer2_q_2_2 -->
<g id="node149" class="node">
<title>layer2_q_2_2</title>
<path fill="lightcoral" stroke="black" d="M28729,-441C28729,-441 28546,-441 28546,-441 28540,-441 28534,-435 28534,-429 28534,-429 28534,-370 28534,-370 28534,-364 28540,-358 28546,-358 28546,-358 28729,-358 28729,-358 28735,-358 28741,-364 28741,-370 28741,-370 28741,-429 28741,-429 28741,-435 28735,-441 28729,-441"/>
<text text-anchor="middle" x="28637.5" y="-425.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="28637.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="28637.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="28637.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="28637.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_q_2_2 -->
<g id="edge220" class="edge">
<title>layer2_ln1&#45;&gt;layer2_q_2_2</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23380.17,-489.05 28445.49,-484.46 28515.5,-466.5 28533.08,-461.99 28550.84,-454.36 28567.17,-445.83"/>
<polygon fill="black" stroke="black" points="28568.95,-448.85 28576.08,-441.01 28565.62,-442.69 28568.95,-448.85"/>
</g>
<!-- layer2_k_2_2 -->
<g id="node150" class="node">
<title>layer2_k_2_2</title>
<path fill="lightcoral" stroke="black" d="M28504,-441C28504,-441 28321,-441 28321,-441 28315,-441 28309,-435 28309,-429 28309,-429 28309,-370 28309,-370 28309,-364 28315,-358 28321,-358 28321,-358 28504,-358 28504,-358 28510,-358 28516,-364 28516,-370 28516,-370 28516,-429 28516,-429 28516,-435 28510,-441 28504,-441"/>
<text text-anchor="middle" x="28412.5" y="-425.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="28412.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="28412.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="28412.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="28412.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_k_2_2 -->
<g id="edge221" class="edge">
<title>layer2_ln1&#45;&gt;layer2_k_2_2</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23377.2,-488.08 28223.52,-483.68 28290.5,-466.5 28308.08,-461.99 28325.84,-454.36 28342.17,-445.83"/>
<polygon fill="black" stroke="black" points="28343.95,-448.85 28351.08,-441.01 28340.62,-442.69 28343.95,-448.85"/>
</g>
<!-- layer2_v_2_2 -->
<g id="node151" class="node">
<title>layer2_v_2_2</title>
<path fill="lightcoral" stroke="black" d="M28279,-441C28279,-441 28096,-441 28096,-441 28090,-441 28084,-435 28084,-429 28084,-429 28084,-370 28084,-370 28084,-364 28090,-358 28096,-358 28096,-358 28279,-358 28279,-358 28285,-358 28291,-364 28291,-370 28291,-370 28291,-429 28291,-429 28291,-435 28285,-441 28279,-441"/>
<text text-anchor="middle" x="28187.5" y="-425.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="28187.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="28187.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="28187.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="28187.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_v_2_2 -->
<g id="edge222" class="edge">
<title>layer2_ln1&#45;&gt;layer2_v_2_2</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23374.23,-487.1 28001.54,-482.91 28065.5,-466.5 28083.08,-461.99 28100.84,-454.36 28117.17,-445.83"/>
<polygon fill="black" stroke="black" points="28118.95,-448.85 28126.08,-441.01 28115.62,-442.69 28118.95,-448.85"/>
</g>
<!-- layer2_q_2_3 -->
<g id="node152" class="node">
<title>layer2_q_2_3</title>
<path fill="lightcoral" stroke="black" d="M27811,-441C27811,-441 27628,-441 27628,-441 27622,-441 27616,-435 27616,-429 27616,-429 27616,-370 27616,-370 27616,-364 27622,-358 27628,-358 27628,-358 27811,-358 27811,-358 27817,-358 27823,-364 27823,-370 27823,-370 27823,-429 27823,-429 27823,-435 27817,-441 27811,-441"/>
<text text-anchor="middle" x="27719.5" y="-425.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="27719.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="27719.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="27719.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="27719.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_q_2_3 -->
<g id="edge223" class="edge">
<title>layer2_ln1&#45;&gt;layer2_q_2_3</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23424.61,-503.65 27482.18,-496.08 27597.5,-466.5 27615.08,-461.99 27632.84,-454.36 27649.17,-445.83"/>
<polygon fill="black" stroke="black" points="27650.95,-448.85 27658.08,-441.01 27647.62,-442.69 27650.95,-448.85"/>
</g>
<!-- layer2_k_2_3 -->
<g id="node153" class="node">
<title>layer2_k_2_3</title>
<path fill="lightcoral" stroke="black" d="M27586,-441C27586,-441 27403,-441 27403,-441 27397,-441 27391,-435 27391,-429 27391,-429 27391,-370 27391,-370 27391,-364 27397,-358 27403,-358 27403,-358 27586,-358 27586,-358 27592,-358 27598,-364 27598,-370 27598,-370 27598,-429 27598,-429 27598,-435 27592,-441 27586,-441"/>
<text text-anchor="middle" x="27494.5" y="-425.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="27494.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="27494.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="27494.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="27494.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_k_2_3 -->
<g id="edge224" class="edge">
<title>layer2_ln1&#45;&gt;layer2_k_2_3</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23418.67,-501.7 27263.23,-494.53 27372.5,-466.5 27390.08,-461.99 27407.84,-454.36 27424.17,-445.83"/>
<polygon fill="black" stroke="black" points="27425.95,-448.85 27433.08,-441.01 27422.62,-442.69 27425.95,-448.85"/>
</g>
<!-- layer2_v_2_3 -->
<g id="node154" class="node">
<title>layer2_v_2_3</title>
<path fill="lightcoral" stroke="black" d="M27361,-441C27361,-441 27178,-441 27178,-441 27172,-441 27166,-435 27166,-429 27166,-429 27166,-370 27166,-370 27166,-364 27172,-358 27178,-358 27178,-358 27361,-358 27361,-358 27367,-358 27373,-364 27373,-370 27373,-370 27373,-429 27373,-429 27373,-435 27367,-441 27361,-441"/>
<text text-anchor="middle" x="27269.5" y="-425.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="27269.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="27269.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="27269.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="27269.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_v_2_3 -->
<g id="edge225" class="edge">
<title>layer2_ln1&#45;&gt;layer2_v_2_3</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23412.74,-499.75 27044.29,-492.98 27147.5,-466.5 27165.08,-461.99 27182.84,-454.36 27199.17,-445.83"/>
<polygon fill="black" stroke="black" points="27200.95,-448.85 27208.08,-441.01 27197.62,-442.69 27200.95,-448.85"/>
</g>
<!-- layer2_q_3_0 -->
<g id="node155" class="node">
<title>layer2_q_3_0</title>
<path fill="lightcoral" stroke="black" d="M26711,-441C26711,-441 26528,-441 26528,-441 26522,-441 26516,-435 26516,-429 26516,-429 26516,-370 26516,-370 26516,-364 26522,-358 26528,-358 26528,-358 26711,-358 26711,-358 26717,-358 26723,-364 26723,-370 26723,-370 26723,-429 26723,-429 26723,-435 26717,-441 26711,-441"/>
<text text-anchor="middle" x="26619.5" y="-425.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="26619.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="26619.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="26619.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="26619.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_q_3_0 -->
<g id="edge226" class="edge">
<title>layer2_ln1&#45;&gt;layer2_q_3_0</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23395.58,-494.11 26411.78,-488.49 26497.5,-466.5 26515.08,-461.99 26532.84,-454.36 26549.17,-445.83"/>
<polygon fill="black" stroke="black" points="26550.95,-448.85 26558.08,-441.01 26547.62,-442.69 26550.95,-448.85"/>
</g>
<!-- layer2_k_3_0 -->
<g id="node156" class="node">
<title>layer2_k_3_0</title>
<path fill="lightcoral" stroke="black" d="M26486,-441C26486,-441 26303,-441 26303,-441 26297,-441 26291,-435 26291,-429 26291,-429 26291,-370 26291,-370 26291,-364 26297,-358 26303,-358 26303,-358 26486,-358 26486,-358 26492,-358 26498,-364 26498,-370 26498,-370 26498,-429 26498,-429 26498,-435 26492,-441 26486,-441"/>
<text text-anchor="middle" x="26394.5" y="-425.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="26394.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="26394.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="26394.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="26394.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_k_3_0 -->
<g id="edge227" class="edge">
<title>layer2_ln1&#45;&gt;layer2_k_3_0</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23389.64,-492.16 26192.83,-486.94 26272.5,-466.5 26290.08,-461.99 26307.84,-454.36 26324.17,-445.83"/>
<polygon fill="black" stroke="black" points="26325.95,-448.85 26333.08,-441.01 26322.62,-442.69 26325.95,-448.85"/>
</g>
<!-- layer2_v_3_0 -->
<g id="node157" class="node">
<title>layer2_v_3_0</title>
<path fill="lightcoral" stroke="black" d="M26261,-441C26261,-441 26078,-441 26078,-441 26072,-441 26066,-435 26066,-429 26066,-429 26066,-370 26066,-370 26066,-364 26072,-358 26078,-358 26078,-358 26261,-358 26261,-358 26267,-358 26273,-364 26273,-370 26273,-370 26273,-429 26273,-429 26273,-435 26267,-441 26261,-441"/>
<text text-anchor="middle" x="26169.5" y="-425.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="26169.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="26169.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="26169.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="26169.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_v_3_0 -->
<g id="edge228" class="edge">
<title>layer2_ln1&#45;&gt;layer2_v_3_0</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23383.71,-490.21 25973.88,-485.38 26047.5,-466.5 26065.08,-461.99 26082.84,-454.36 26099.17,-445.83"/>
<polygon fill="black" stroke="black" points="26100.95,-448.85 26108.08,-441.01 26097.62,-442.69 26100.95,-448.85"/>
</g>
<!-- layer2_q_3_1 -->
<g id="node158" class="node">
<title>layer2_q_3_1</title>
<path fill="lightcoral" stroke="black" d="M25793,-441C25793,-441 25610,-441 25610,-441 25604,-441 25598,-435 25598,-429 25598,-429 25598,-370 25598,-370 25598,-364 25604,-358 25610,-358 25610,-358 25793,-358 25793,-358 25799,-358 25805,-364 25805,-370 25805,-370 25805,-429 25805,-429 25805,-435 25799,-441 25793,-441"/>
<text text-anchor="middle" x="25701.5" y="-425.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="25701.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="25701.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="25701.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="25701.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_q_3_1 -->
<g id="edge229" class="edge">
<title>layer2_ln1&#45;&gt;layer2_q_3_1</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23371.35,-486.16 25518.48,-482.15 25579.5,-466.5 25597.08,-461.99 25614.84,-454.36 25631.17,-445.83"/>
<polygon fill="black" stroke="black" points="25632.95,-448.85 25640.08,-441.01 25629.62,-442.69 25632.95,-448.85"/>
</g>
<!-- layer2_k_3_1 -->
<g id="node159" class="node">
<title>layer2_k_3_1</title>
<path fill="lightcoral" stroke="black" d="M25568,-441C25568,-441 25385,-441 25385,-441 25379,-441 25373,-435 25373,-429 25373,-429 25373,-370 25373,-370 25373,-364 25379,-358 25385,-358 25385,-358 25568,-358 25568,-358 25574,-358 25580,-364 25580,-370 25580,-370 25580,-429 25580,-429 25580,-435 25574,-441 25568,-441"/>
<text text-anchor="middle" x="25476.5" y="-425.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="25476.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="25476.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="25476.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="25476.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_k_3_1 -->
<g id="edge230" class="edge">
<title>layer2_ln1&#45;&gt;layer2_k_3_1</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23419.33,-501.92 25244.56,-494.7 25354.5,-466.5 25372.08,-461.99 25389.84,-454.36 25406.17,-445.83"/>
<polygon fill="black" stroke="black" points="25407.95,-448.85 25415.08,-441.01 25404.62,-442.69 25407.95,-448.85"/>
</g>
<!-- layer2_v_3_1 -->
<g id="node160" class="node">
<title>layer2_v_3_1</title>
<path fill="lightcoral" stroke="black" d="M25343,-441C25343,-441 25160,-441 25160,-441 25154,-441 25148,-435 25148,-429 25148,-429 25148,-370 25148,-370 25148,-364 25154,-358 25160,-358 25160,-358 25343,-358 25343,-358 25349,-358 25355,-364 25355,-370 25355,-370 25355,-429 25355,-429 25355,-435 25349,-441 25343,-441"/>
<text text-anchor="middle" x="25251.5" y="-425.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="25251.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="25251.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="25251.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="25251.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_v_3_1 -->
<g id="edge231" class="edge">
<title>layer2_ln1&#45;&gt;layer2_v_3_1</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23407.46,-498.01 25031.67,-491.6 25129.5,-466.5 25147.08,-461.99 25164.84,-454.36 25181.17,-445.83"/>
<polygon fill="black" stroke="black" points="25182.95,-448.85 25190.08,-441.01 25179.62,-442.69 25182.95,-448.85"/>
</g>
<!-- layer2_q_3_2 -->
<g id="node161" class="node">
<title>layer2_q_3_2</title>
<path fill="lightcoral" stroke="black" d="M24875,-441C24875,-441 24692,-441 24692,-441 24686,-441 24680,-435 24680,-429 24680,-429 24680,-370 24680,-370 24680,-364 24686,-358 24692,-358 24692,-358 24875,-358 24875,-358 24881,-358 24887,-364 24887,-370 24887,-370 24887,-429 24887,-429 24887,-435 24881,-441 24875,-441"/>
<text text-anchor="middle" x="24783.5" y="-425.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="24783.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="24783.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="24783.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="24783.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_q_3_2 -->
<g id="edge232" class="edge">
<title>layer2_ln1&#45;&gt;layer2_q_3_2</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23382.76,-489.9 24588.85,-485.14 24661.5,-466.5 24679.08,-461.99 24696.84,-454.36 24713.17,-445.83"/>
<polygon fill="black" stroke="black" points="24714.95,-448.85 24722.08,-441.01 24711.62,-442.69 24714.95,-448.85"/>
</g>
<!-- layer2_k_3_2 -->
<g id="node162" class="node">
<title>layer2_k_3_2</title>
<path fill="lightcoral" stroke="black" d="M24650,-441C24650,-441 24467,-441 24467,-441 24461,-441 24455,-435 24455,-429 24455,-429 24455,-370 24455,-370 24455,-364 24461,-358 24467,-358 24467,-358 24650,-358 24650,-358 24656,-358 24662,-364 24662,-370 24662,-370 24662,-429 24662,-429 24662,-435 24656,-441 24650,-441"/>
<text text-anchor="middle" x="24558.5" y="-425.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="24558.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="24558.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="24558.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="24558.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_k_3_2 -->
<g id="edge233" class="edge">
<title>layer2_ln1&#45;&gt;layer2_k_3_2</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23370.88,-486 24375.96,-482.03 24436.5,-466.5 24454.08,-461.99 24471.84,-454.36 24488.17,-445.83"/>
<polygon fill="black" stroke="black" points="24489.95,-448.85 24497.08,-441.01 24486.62,-442.69 24489.95,-448.85"/>
</g>
<!-- layer2_v_3_2 -->
<g id="node163" class="node">
<title>layer2_v_3_2</title>
<path fill="lightcoral" stroke="black" d="M24425,-441C24425,-441 24242,-441 24242,-441 24236,-441 24230,-435 24230,-429 24230,-429 24230,-370 24230,-370 24230,-364 24236,-358 24242,-358 24242,-358 24425,-358 24425,-358 24431,-358 24437,-364 24437,-370 24437,-370 24437,-429 24437,-429 24437,-435 24431,-441 24425,-441"/>
<text text-anchor="middle" x="24333.5" y="-425.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="24333.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="24333.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="24333.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="24333.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_v_3_2 -->
<g id="edge234" class="edge">
<title>layer2_ln1&#45;&gt;layer2_v_3_2</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23406.51,-497.7 24114.64,-491.35 24211.5,-466.5 24229.08,-461.99 24246.84,-454.36 24263.17,-445.83"/>
<polygon fill="black" stroke="black" points="24264.95,-448.85 24272.08,-441.01 24261.62,-442.69 24264.95,-448.85"/>
</g>
<!-- layer2_q_3_3 -->
<g id="node164" class="node">
<title>layer2_q_3_3</title>
<path fill="lightcoral" stroke="black" d="M23957,-441C23957,-441 23774,-441 23774,-441 23768,-441 23762,-435 23762,-429 23762,-429 23762,-370 23762,-370 23762,-364 23768,-358 23774,-358 23774,-358 23957,-358 23957,-358 23963,-358 23969,-364 23969,-370 23969,-370 23969,-429 23969,-429 23969,-435 23963,-441 23957,-441"/>
<text text-anchor="middle" x="23865.5" y="-425.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="23865.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="23865.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="23865.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="23865.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_q_3_3 -->
<g id="edge235" class="edge">
<title>layer2_ln1&#45;&gt;layer2_q_3_3</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23402.71,-496.45 23650.51,-490.35 23743.5,-466.5 23761.08,-461.99 23778.84,-454.36 23795.17,-445.83"/>
<polygon fill="black" stroke="black" points="23796.95,-448.85 23804.08,-441.01 23793.62,-442.69 23796.95,-448.85"/>
</g>
<!-- layer2_k_3_3 -->
<g id="node165" class="node">
<title>layer2_k_3_3</title>
<path fill="lightcoral" stroke="black" d="M23732,-441C23732,-441 23549,-441 23549,-441 23543,-441 23537,-435 23537,-429 23537,-429 23537,-370 23537,-370 23537,-364 23543,-358 23549,-358 23549,-358 23732,-358 23732,-358 23738,-358 23744,-364 23744,-370 23744,-370 23744,-429 23744,-429 23744,-435 23738,-441 23732,-441"/>
<text text-anchor="middle" x="23640.5" y="-425.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="23640.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="23640.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="23640.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="23640.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_k_3_3 -->
<g id="edge236" class="edge">
<title>layer2_ln1&#45;&gt;layer2_k_3_3</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23398.91,-495.21 23429.39,-489.36 23518.5,-466.5 23536.08,-461.99 23553.84,-454.36 23570.17,-445.83"/>
<polygon fill="black" stroke="black" points="23571.95,-448.85 23579.08,-441.01 23568.62,-442.69 23571.95,-448.85"/>
</g>
<!-- layer2_v_3_3 -->
<g id="node166" class="node">
<title>layer2_v_3_3</title>
<path fill="lightcoral" stroke="black" d="M23507,-441C23507,-441 23324,-441 23324,-441 23318,-441 23312,-435 23312,-429 23312,-429 23312,-370 23312,-370 23312,-364 23318,-358 23324,-358 23324,-358 23507,-358 23507,-358 23513,-358 23519,-364 23519,-370 23519,-370 23519,-429 23519,-429 23519,-435 23513,-441 23507,-441"/>
<text text-anchor="middle" x="23415.5" y="-425.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="23415.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="23415.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="23415.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="23415.5" y="-365.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_v_3_3 -->
<g id="edge237" class="edge">
<title>layer2_ln1&#45;&gt;layer2_v_3_3</title>
<path fill="none" stroke="black" d="M23276.11,-399.5C23284.65,-399.5 23293.2,-399.5 23301.74,-399.5"/>
<polygon fill="black" stroke="black" points="23301.77,-403 23311.77,-399.5 23301.77,-396 23301.77,-403"/>
</g>
<!-- layer2_residual1 -->
<g id="node168" class="node">
<title>layer2_residual1</title>
<path fill="lightgreen" stroke="black" d="M39237.5,-426C39237.5,-426 39137.5,-426 39137.5,-426 39131.5,-426 39125.5,-420 39125.5,-414 39125.5,-414 39125.5,-385 39125.5,-385 39125.5,-379 39131.5,-373 39137.5,-373 39137.5,-373 39237.5,-373 39237.5,-373 39243.5,-373 39249.5,-379 39249.5,-385 39249.5,-385 39249.5,-414 39249.5,-414 39249.5,-420 39243.5,-426 39237.5,-426"/>
<text text-anchor="middle" x="39187.5" y="-410.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="39187.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="39187.5" y="-380.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_ln1&#45;&gt;layer2_residual1 -->
<g id="edge239" class="edge">
<title>layer2_ln1&#45;&gt;layer2_residual1</title>
<path fill="none" stroke="black" d="M23246.94,-426.09C23263.83,-441.12 23287.08,-458.48 23311.5,-466.5 23415.6,-500.69 38984.82,-498.86 39089.5,-466.5 39111.67,-459.65 39133.29,-445.86 39150.56,-432.57"/>
<polygon fill="black" stroke="black" points="39153.03,-435.08 39158.67,-426.12 39148.67,-429.61 39153.03,-435.08"/>
</g>
<!-- layer2_attn_0_0 -->
<g id="node181" class="node">
<title>layer2_attn_0_0</title>
<path fill="orange" stroke="black" d="M38516,-433.5C38516,-433.5 38333,-433.5 38333,-433.5 38327,-433.5 38321,-427.5 38321,-421.5 38321,-421.5 38321,-377.5 38321,-377.5 38321,-371.5 38327,-365.5 38333,-365.5 38333,-365.5 38516,-365.5 38516,-365.5 38522,-365.5 38528,-371.5 38528,-377.5 38528,-377.5 38528,-421.5 38528,-421.5 38528,-427.5 38522,-433.5 38516,-433.5"/>
<text text-anchor="middle" x="38424.5" y="-418.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="38424.5" y="-403.3" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="38424.5" y="-388.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="38424.5" y="-373.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_q_0_0&#45;&gt;layer2_attn_0_0 -->
<g id="edge260" class="edge">
<title>layer2_q_0_0&#45;&gt;layer2_attn_0_0</title>
<path fill="none" stroke="black" d="M38285.44,-399.5C38293.81,-399.5 38302.17,-399.5 38310.54,-399.5"/>
<polygon fill="black" stroke="black" points="38310.75,-403 38320.75,-399.5 38310.75,-396 38310.75,-403"/>
</g>
<!-- layer2_k_0_0&#45;&gt;layer2_attn_0_0 -->
<g id="edge261" class="edge">
<title>layer2_k_0_0&#45;&gt;layer2_attn_0_0</title>
<path fill="none" stroke="black" d="M38017.38,-441.01C38035.88,-451.43 38056.81,-461.15 38077.5,-466.5 38166.57,-489.51 38194.78,-486.86 38284.5,-466.5 38310.02,-460.71 38336.32,-449.67 38359.14,-438.2"/>
<polygon fill="black" stroke="black" points="38360.75,-441.31 38368.04,-433.62 38357.54,-435.08 38360.75,-441.31"/>
</g>
<!-- layer2_v_0_0&#45;&gt;layer2_attn_0_0 -->
<g id="edge262" class="edge">
<title>layer2_v_0_0&#45;&gt;layer2_attn_0_0</title>
<path fill="none" stroke="black" d="M37792.38,-441.01C37810.88,-451.43 37831.81,-461.15 37852.5,-466.5 37945.45,-490.52 38190.88,-487.75 38284.5,-466.5 38310.02,-460.71 38336.32,-449.67 38359.14,-438.2"/>
<polygon fill="black" stroke="black" points="38360.75,-441.31 38368.04,-433.62 38357.54,-435.08 38360.75,-441.31"/>
</g>
<!-- layer2_attn_0_1 -->
<g id="node182" class="node">
<title>layer2_attn_0_1</title>
<path fill="orange" stroke="black" d="M37598,-433.5C37598,-433.5 37415,-433.5 37415,-433.5 37409,-433.5 37403,-427.5 37403,-421.5 37403,-421.5 37403,-377.5 37403,-377.5 37403,-371.5 37409,-365.5 37415,-365.5 37415,-365.5 37598,-365.5 37598,-365.5 37604,-365.5 37610,-371.5 37610,-377.5 37610,-377.5 37610,-421.5 37610,-421.5 37610,-427.5 37604,-433.5 37598,-433.5"/>
<text text-anchor="middle" x="37506.5" y="-418.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="37506.5" y="-403.3" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="37506.5" y="-388.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="37506.5" y="-373.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer2_q_0_1&#45;&gt;layer2_attn_0_1 -->
<g id="edge263" class="edge">
<title>layer2_q_0_1&#45;&gt;layer2_attn_0_1</title>
<path fill="none" stroke="black" d="M37367.44,-399.5C37375.81,-399.5 37384.17,-399.5 37392.54,-399.5"/>
<polygon fill="black" stroke="black" points="37392.75,-403 37402.75,-399.5 37392.75,-396 37392.75,-403"/>
</g>
<!-- layer2_k_0_1&#45;&gt;layer2_attn_0_1 -->
<g id="edge264" class="edge">
<title>layer2_k_0_1&#45;&gt;layer2_attn_0_1</title>
<path fill="none" stroke="black" d="M37099.38,-441.01C37117.88,-451.43 37138.81,-461.15 37159.5,-466.5 37248.57,-489.51 37276.78,-486.86 37366.5,-466.5 37392.02,-460.71 37418.32,-449.67 37441.14,-438.2"/>
<polygon fill="black" stroke="black" points="37442.75,-441.31 37450.04,-433.62 37439.54,-435.08 37442.75,-441.31"/>
</g>
<!-- layer2_v_0_1&#45;&gt;layer2_attn_0_1 -->
<g id="edge265" class="edge">
<title>layer2_v_0_1&#45;&gt;layer2_attn_0_1</title>
<path fill="none" stroke="black" d="M36874.38,-441.01C36892.88,-451.43 36913.81,-461.15 36934.5,-466.5 37027.45,-490.52 37272.88,-487.75 37366.5,-466.5 37392.02,-460.71 37418.32,-449.67 37441.14,-438.2"/>
<polygon fill="black" stroke="black" points="37442.75,-441.31 37450.04,-433.62 37439.54,-435.08 37442.75,-441.31"/>
</g>
<!-- layer2_attn_0_2 -->
<g id="node183" class="node">
<title>layer2_attn_0_2</title>
<path fill="orange" stroke="black" d="M36680,-433.5C36680,-433.5 36497,-433.5 36497,-433.5 36491,-433.5 36485,-427.5 36485,-421.5 36485,-421.5 36485,-377.5 36485,-377.5 36485,-371.5 36491,-365.5 36497,-365.5 36497,-365.5 36680,-365.5 36680,-365.5 36686,-365.5 36692,-371.5 36692,-377.5 36692,-377.5 36692,-421.5 36692,-421.5 36692,-427.5 36686,-433.5 36680,-433.5"/>
<text text-anchor="middle" x="36588.5" y="-418.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="36588.5" y="-403.3" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="36588.5" y="-388.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="36588.5" y="-373.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_q_0_2&#45;&gt;layer2_attn_0_2 -->
<g id="edge266" class="edge">
<title>layer2_q_0_2&#45;&gt;layer2_attn_0_2</title>
<path fill="none" stroke="black" d="M36449.44,-399.5C36457.81,-399.5 36466.17,-399.5 36474.54,-399.5"/>
<polygon fill="black" stroke="black" points="36474.75,-403 36484.75,-399.5 36474.75,-396 36474.75,-403"/>
</g>
<!-- layer2_k_0_2&#45;&gt;layer2_attn_0_2 -->
<g id="edge267" class="edge">
<title>layer2_k_0_2&#45;&gt;layer2_attn_0_2</title>
<path fill="none" stroke="black" d="M36181.38,-441.01C36199.88,-451.43 36220.81,-461.15 36241.5,-466.5 36330.57,-489.51 36358.78,-486.86 36448.5,-466.5 36474.02,-460.71 36500.32,-449.67 36523.14,-438.2"/>
<polygon fill="black" stroke="black" points="36524.75,-441.31 36532.04,-433.62 36521.54,-435.08 36524.75,-441.31"/>
</g>
<!-- layer2_v_0_2&#45;&gt;layer2_attn_0_2 -->
<g id="edge268" class="edge">
<title>layer2_v_0_2&#45;&gt;layer2_attn_0_2</title>
<path fill="none" stroke="black" d="M35956.38,-441.01C35974.88,-451.43 35995.81,-461.15 36016.5,-466.5 36109.45,-490.52 36354.88,-487.75 36448.5,-466.5 36474.02,-460.71 36500.32,-449.67 36523.14,-438.2"/>
<polygon fill="black" stroke="black" points="36524.75,-441.31 36532.04,-433.62 36521.54,-435.08 36524.75,-441.31"/>
</g>
<!-- layer2_attn_0_3 -->
<g id="node184" class="node">
<title>layer2_attn_0_3</title>
<path fill="orange" stroke="black" d="M35762,-433.5C35762,-433.5 35579,-433.5 35579,-433.5 35573,-433.5 35567,-427.5 35567,-421.5 35567,-421.5 35567,-377.5 35567,-377.5 35567,-371.5 35573,-365.5 35579,-365.5 35579,-365.5 35762,-365.5 35762,-365.5 35768,-365.5 35774,-371.5 35774,-377.5 35774,-377.5 35774,-421.5 35774,-421.5 35774,-427.5 35768,-433.5 35762,-433.5"/>
<text text-anchor="middle" x="35670.5" y="-418.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="35670.5" y="-403.3" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="35670.5" y="-388.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="35670.5" y="-373.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer2_q_0_3&#45;&gt;layer2_attn_0_3 -->
<g id="edge269" class="edge">
<title>layer2_q_0_3&#45;&gt;layer2_attn_0_3</title>
<path fill="none" stroke="black" d="M35531.44,-399.5C35539.81,-399.5 35548.17,-399.5 35556.54,-399.5"/>
<polygon fill="black" stroke="black" points="35556.75,-403 35566.75,-399.5 35556.75,-396 35556.75,-403"/>
</g>
<!-- layer2_k_0_3&#45;&gt;layer2_attn_0_3 -->
<g id="edge270" class="edge">
<title>layer2_k_0_3&#45;&gt;layer2_attn_0_3</title>
<path fill="none" stroke="black" d="M35263.38,-441.01C35281.88,-451.43 35302.81,-461.15 35323.5,-466.5 35412.57,-489.51 35440.78,-486.86 35530.5,-466.5 35556.02,-460.71 35582.32,-449.67 35605.14,-438.2"/>
<polygon fill="black" stroke="black" points="35606.75,-441.31 35614.04,-433.62 35603.54,-435.08 35606.75,-441.31"/>
</g>
<!-- layer2_v_0_3&#45;&gt;layer2_attn_0_3 -->
<g id="edge271" class="edge">
<title>layer2_v_0_3&#45;&gt;layer2_attn_0_3</title>
<path fill="none" stroke="black" d="M35038.38,-441.01C35056.88,-451.43 35077.81,-461.15 35098.5,-466.5 35191.45,-490.52 35436.88,-487.75 35530.5,-466.5 35556.02,-460.71 35582.32,-449.67 35605.14,-438.2"/>
<polygon fill="black" stroke="black" points="35606.75,-441.31 35614.04,-433.62 35603.54,-435.08 35606.75,-441.31"/>
</g>
<!-- layer2_attn_1_0 -->
<g id="node185" class="node">
<title>layer2_attn_1_0</title>
<path fill="orange" stroke="black" d="M34662,-433.5C34662,-433.5 34479,-433.5 34479,-433.5 34473,-433.5 34467,-427.5 34467,-421.5 34467,-421.5 34467,-377.5 34467,-377.5 34467,-371.5 34473,-365.5 34479,-365.5 34479,-365.5 34662,-365.5 34662,-365.5 34668,-365.5 34674,-371.5 34674,-377.5 34674,-377.5 34674,-421.5 34674,-421.5 34674,-427.5 34668,-433.5 34662,-433.5"/>
<text text-anchor="middle" x="34570.5" y="-418.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="34570.5" y="-403.3" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="34570.5" y="-388.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="34570.5" y="-373.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_q_1_0&#45;&gt;layer2_attn_1_0 -->
<g id="edge272" class="edge">
<title>layer2_q_1_0&#45;&gt;layer2_attn_1_0</title>
<path fill="none" stroke="black" d="M34431.44,-399.5C34439.81,-399.5 34448.17,-399.5 34456.54,-399.5"/>
<polygon fill="black" stroke="black" points="34456.75,-403 34466.75,-399.5 34456.75,-396 34456.75,-403"/>
</g>
<!-- layer2_k_1_0&#45;&gt;layer2_attn_1_0 -->
<g id="edge273" class="edge">
<title>layer2_k_1_0&#45;&gt;layer2_attn_1_0</title>
<path fill="none" stroke="black" d="M34163.38,-441.01C34181.88,-451.43 34202.81,-461.15 34223.5,-466.5 34312.57,-489.51 34340.78,-486.86 34430.5,-466.5 34456.02,-460.71 34482.32,-449.67 34505.14,-438.2"/>
<polygon fill="black" stroke="black" points="34506.75,-441.31 34514.04,-433.62 34503.54,-435.08 34506.75,-441.31"/>
</g>
<!-- layer2_v_1_0&#45;&gt;layer2_attn_1_0 -->
<g id="edge274" class="edge">
<title>layer2_v_1_0&#45;&gt;layer2_attn_1_0</title>
<path fill="none" stroke="black" d="M33938.38,-441.01C33956.88,-451.43 33977.81,-461.15 33998.5,-466.5 34091.45,-490.52 34336.88,-487.75 34430.5,-466.5 34456.02,-460.71 34482.32,-449.67 34505.14,-438.2"/>
<polygon fill="black" stroke="black" points="34506.75,-441.31 34514.04,-433.62 34503.54,-435.08 34506.75,-441.31"/>
</g>
<!-- layer2_attn_1_1 -->
<g id="node186" class="node">
<title>layer2_attn_1_1</title>
<path fill="orange" stroke="black" d="M33744,-433.5C33744,-433.5 33561,-433.5 33561,-433.5 33555,-433.5 33549,-427.5 33549,-421.5 33549,-421.5 33549,-377.5 33549,-377.5 33549,-371.5 33555,-365.5 33561,-365.5 33561,-365.5 33744,-365.5 33744,-365.5 33750,-365.5 33756,-371.5 33756,-377.5 33756,-377.5 33756,-421.5 33756,-421.5 33756,-427.5 33750,-433.5 33744,-433.5"/>
<text text-anchor="middle" x="33652.5" y="-418.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="33652.5" y="-403.3" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="33652.5" y="-388.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="33652.5" y="-373.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_q_1_1&#45;&gt;layer2_attn_1_1 -->
<g id="edge275" class="edge">
<title>layer2_q_1_1&#45;&gt;layer2_attn_1_1</title>
<path fill="none" stroke="black" d="M33513.44,-399.5C33521.81,-399.5 33530.17,-399.5 33538.54,-399.5"/>
<polygon fill="black" stroke="black" points="33538.75,-403 33548.75,-399.5 33538.75,-396 33538.75,-403"/>
</g>
<!-- layer2_k_1_1&#45;&gt;layer2_attn_1_1 -->
<g id="edge276" class="edge">
<title>layer2_k_1_1&#45;&gt;layer2_attn_1_1</title>
<path fill="none" stroke="black" d="M33245.38,-441.01C33263.88,-451.43 33284.81,-461.15 33305.5,-466.5 33394.57,-489.51 33422.78,-486.86 33512.5,-466.5 33538.02,-460.71 33564.32,-449.67 33587.14,-438.2"/>
<polygon fill="black" stroke="black" points="33588.75,-441.31 33596.04,-433.62 33585.54,-435.08 33588.75,-441.31"/>
</g>
<!-- layer2_v_1_1&#45;&gt;layer2_attn_1_1 -->
<g id="edge277" class="edge">
<title>layer2_v_1_1&#45;&gt;layer2_attn_1_1</title>
<path fill="none" stroke="black" d="M33020.38,-441.01C33038.88,-451.43 33059.81,-461.15 33080.5,-466.5 33173.45,-490.52 33418.88,-487.75 33512.5,-466.5 33538.02,-460.71 33564.32,-449.67 33587.14,-438.2"/>
<polygon fill="black" stroke="black" points="33588.75,-441.31 33596.04,-433.62 33585.54,-435.08 33588.75,-441.31"/>
</g>
<!-- layer2_attn_1_2 -->
<g id="node187" class="node">
<title>layer2_attn_1_2</title>
<path fill="orange" stroke="black" d="M32826,-433.5C32826,-433.5 32643,-433.5 32643,-433.5 32637,-433.5 32631,-427.5 32631,-421.5 32631,-421.5 32631,-377.5 32631,-377.5 32631,-371.5 32637,-365.5 32643,-365.5 32643,-365.5 32826,-365.5 32826,-365.5 32832,-365.5 32838,-371.5 32838,-377.5 32838,-377.5 32838,-421.5 32838,-421.5 32838,-427.5 32832,-433.5 32826,-433.5"/>
<text text-anchor="middle" x="32734.5" y="-418.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="32734.5" y="-403.3" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="32734.5" y="-388.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="32734.5" y="-373.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_q_1_2&#45;&gt;layer2_attn_1_2 -->
<g id="edge278" class="edge">
<title>layer2_q_1_2&#45;&gt;layer2_attn_1_2</title>
<path fill="none" stroke="black" d="M32595.44,-399.5C32603.81,-399.5 32612.17,-399.5 32620.54,-399.5"/>
<polygon fill="black" stroke="black" points="32620.75,-403 32630.75,-399.5 32620.75,-396 32620.75,-403"/>
</g>
<!-- layer2_k_1_2&#45;&gt;layer2_attn_1_2 -->
<g id="edge279" class="edge">
<title>layer2_k_1_2&#45;&gt;layer2_attn_1_2</title>
<path fill="none" stroke="black" d="M32327.38,-441.01C32345.88,-451.43 32366.81,-461.15 32387.5,-466.5 32476.57,-489.51 32504.78,-486.86 32594.5,-466.5 32620.02,-460.71 32646.32,-449.67 32669.14,-438.2"/>
<polygon fill="black" stroke="black" points="32670.75,-441.31 32678.04,-433.62 32667.54,-435.08 32670.75,-441.31"/>
</g>
<!-- layer2_v_1_2&#45;&gt;layer2_attn_1_2 -->
<g id="edge280" class="edge">
<title>layer2_v_1_2&#45;&gt;layer2_attn_1_2</title>
<path fill="none" stroke="black" d="M32102.38,-441.01C32120.88,-451.43 32141.81,-461.15 32162.5,-466.5 32255.45,-490.52 32500.88,-487.75 32594.5,-466.5 32620.02,-460.71 32646.32,-449.67 32669.14,-438.2"/>
<polygon fill="black" stroke="black" points="32670.75,-441.31 32678.04,-433.62 32667.54,-435.08 32670.75,-441.31"/>
</g>
<!-- layer2_attn_1_3 -->
<g id="node188" class="node">
<title>layer2_attn_1_3</title>
<path fill="orange" stroke="black" d="M31908,-433.5C31908,-433.5 31725,-433.5 31725,-433.5 31719,-433.5 31713,-427.5 31713,-421.5 31713,-421.5 31713,-377.5 31713,-377.5 31713,-371.5 31719,-365.5 31725,-365.5 31725,-365.5 31908,-365.5 31908,-365.5 31914,-365.5 31920,-371.5 31920,-377.5 31920,-377.5 31920,-421.5 31920,-421.5 31920,-427.5 31914,-433.5 31908,-433.5"/>
<text text-anchor="middle" x="31816.5" y="-418.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="31816.5" y="-403.3" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="31816.5" y="-388.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="31816.5" y="-373.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_q_1_3&#45;&gt;layer2_attn_1_3 -->
<g id="edge281" class="edge">
<title>layer2_q_1_3&#45;&gt;layer2_attn_1_3</title>
<path fill="none" stroke="black" d="M31677.44,-399.5C31685.81,-399.5 31694.17,-399.5 31702.54,-399.5"/>
<polygon fill="black" stroke="black" points="31702.75,-403 31712.75,-399.5 31702.75,-396 31702.75,-403"/>
</g>
<!-- layer2_k_1_3&#45;&gt;layer2_attn_1_3 -->
<g id="edge282" class="edge">
<title>layer2_k_1_3&#45;&gt;layer2_attn_1_3</title>
<path fill="none" stroke="black" d="M31409.38,-441.01C31427.88,-451.43 31448.81,-461.15 31469.5,-466.5 31558.57,-489.51 31586.78,-486.86 31676.5,-466.5 31702.02,-460.71 31728.32,-449.67 31751.14,-438.2"/>
<polygon fill="black" stroke="black" points="31752.75,-441.31 31760.04,-433.62 31749.54,-435.08 31752.75,-441.31"/>
</g>
<!-- layer2_v_1_3&#45;&gt;layer2_attn_1_3 -->
<g id="edge283" class="edge">
<title>layer2_v_1_3&#45;&gt;layer2_attn_1_3</title>
<path fill="none" stroke="black" d="M31184.38,-441.01C31202.88,-451.43 31223.81,-461.15 31244.5,-466.5 31337.45,-490.52 31582.88,-487.75 31676.5,-466.5 31702.02,-460.71 31728.32,-449.67 31751.14,-438.2"/>
<polygon fill="black" stroke="black" points="31752.75,-441.31 31760.04,-433.62 31749.54,-435.08 31752.75,-441.31"/>
</g>
<!-- layer2_attn_2_0 -->
<g id="node189" class="node">
<title>layer2_attn_2_0</title>
<path fill="orange" stroke="black" d="M30808,-433.5C30808,-433.5 30625,-433.5 30625,-433.5 30619,-433.5 30613,-427.5 30613,-421.5 30613,-421.5 30613,-377.5 30613,-377.5 30613,-371.5 30619,-365.5 30625,-365.5 30625,-365.5 30808,-365.5 30808,-365.5 30814,-365.5 30820,-371.5 30820,-377.5 30820,-377.5 30820,-421.5 30820,-421.5 30820,-427.5 30814,-433.5 30808,-433.5"/>
<text text-anchor="middle" x="30716.5" y="-418.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="30716.5" y="-403.3" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="30716.5" y="-388.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="30716.5" y="-373.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_q_2_0&#45;&gt;layer2_attn_2_0 -->
<g id="edge284" class="edge">
<title>layer2_q_2_0&#45;&gt;layer2_attn_2_0</title>
<path fill="none" stroke="black" d="M30577.44,-399.5C30585.81,-399.5 30594.17,-399.5 30602.54,-399.5"/>
<polygon fill="black" stroke="black" points="30602.75,-403 30612.75,-399.5 30602.75,-396 30602.75,-403"/>
</g>
<!-- layer2_k_2_0&#45;&gt;layer2_attn_2_0 -->
<g id="edge285" class="edge">
<title>layer2_k_2_0&#45;&gt;layer2_attn_2_0</title>
<path fill="none" stroke="black" d="M30309.38,-441.01C30327.88,-451.43 30348.81,-461.15 30369.5,-466.5 30458.57,-489.51 30486.78,-486.86 30576.5,-466.5 30602.02,-460.71 30628.32,-449.67 30651.14,-438.2"/>
<polygon fill="black" stroke="black" points="30652.75,-441.31 30660.04,-433.62 30649.54,-435.08 30652.75,-441.31"/>
</g>
<!-- layer2_v_2_0&#45;&gt;layer2_attn_2_0 -->
<g id="edge286" class="edge">
<title>layer2_v_2_0&#45;&gt;layer2_attn_2_0</title>
<path fill="none" stroke="black" d="M30084.38,-441.01C30102.88,-451.43 30123.81,-461.15 30144.5,-466.5 30237.45,-490.52 30482.88,-487.75 30576.5,-466.5 30602.02,-460.71 30628.32,-449.67 30651.14,-438.2"/>
<polygon fill="black" stroke="black" points="30652.75,-441.31 30660.04,-433.62 30649.54,-435.08 30652.75,-441.31"/>
</g>
<!-- layer2_attn_2_1 -->
<g id="node190" class="node">
<title>layer2_attn_2_1</title>
<path fill="orange" stroke="black" d="M29890,-433.5C29890,-433.5 29707,-433.5 29707,-433.5 29701,-433.5 29695,-427.5 29695,-421.5 29695,-421.5 29695,-377.5 29695,-377.5 29695,-371.5 29701,-365.5 29707,-365.5 29707,-365.5 29890,-365.5 29890,-365.5 29896,-365.5 29902,-371.5 29902,-377.5 29902,-377.5 29902,-421.5 29902,-421.5 29902,-427.5 29896,-433.5 29890,-433.5"/>
<text text-anchor="middle" x="29798.5" y="-418.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="29798.5" y="-403.3" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="29798.5" y="-388.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="29798.5" y="-373.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer2_q_2_1&#45;&gt;layer2_attn_2_1 -->
<g id="edge287" class="edge">
<title>layer2_q_2_1&#45;&gt;layer2_attn_2_1</title>
<path fill="none" stroke="black" d="M29659.44,-399.5C29667.81,-399.5 29676.17,-399.5 29684.54,-399.5"/>
<polygon fill="black" stroke="black" points="29684.75,-403 29694.75,-399.5 29684.75,-396 29684.75,-403"/>
</g>
<!-- layer2_k_2_1&#45;&gt;layer2_attn_2_1 -->
<g id="edge288" class="edge">
<title>layer2_k_2_1&#45;&gt;layer2_attn_2_1</title>
<path fill="none" stroke="black" d="M29391.38,-441.01C29409.88,-451.43 29430.81,-461.15 29451.5,-466.5 29540.57,-489.51 29568.78,-486.86 29658.5,-466.5 29684.02,-460.71 29710.32,-449.67 29733.14,-438.2"/>
<polygon fill="black" stroke="black" points="29734.75,-441.31 29742.04,-433.62 29731.54,-435.08 29734.75,-441.31"/>
</g>
<!-- layer2_v_2_1&#45;&gt;layer2_attn_2_1 -->
<g id="edge289" class="edge">
<title>layer2_v_2_1&#45;&gt;layer2_attn_2_1</title>
<path fill="none" stroke="black" d="M29166.38,-441.01C29184.88,-451.43 29205.81,-461.15 29226.5,-466.5 29319.45,-490.52 29564.88,-487.75 29658.5,-466.5 29684.02,-460.71 29710.32,-449.67 29733.14,-438.2"/>
<polygon fill="black" stroke="black" points="29734.75,-441.31 29742.04,-433.62 29731.54,-435.08 29734.75,-441.31"/>
</g>
<!-- layer2_attn_2_2 -->
<g id="node191" class="node">
<title>layer2_attn_2_2</title>
<path fill="orange" stroke="black" d="M28972,-433.5C28972,-433.5 28789,-433.5 28789,-433.5 28783,-433.5 28777,-427.5 28777,-421.5 28777,-421.5 28777,-377.5 28777,-377.5 28777,-371.5 28783,-365.5 28789,-365.5 28789,-365.5 28972,-365.5 28972,-365.5 28978,-365.5 28984,-371.5 28984,-377.5 28984,-377.5 28984,-421.5 28984,-421.5 28984,-427.5 28978,-433.5 28972,-433.5"/>
<text text-anchor="middle" x="28880.5" y="-418.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="28880.5" y="-403.3" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="28880.5" y="-388.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="28880.5" y="-373.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_q_2_2&#45;&gt;layer2_attn_2_2 -->
<g id="edge290" class="edge">
<title>layer2_q_2_2&#45;&gt;layer2_attn_2_2</title>
<path fill="none" stroke="black" d="M28741.44,-399.5C28749.81,-399.5 28758.17,-399.5 28766.54,-399.5"/>
<polygon fill="black" stroke="black" points="28766.75,-403 28776.75,-399.5 28766.75,-396 28766.75,-403"/>
</g>
<!-- layer2_k_2_2&#45;&gt;layer2_attn_2_2 -->
<g id="edge291" class="edge">
<title>layer2_k_2_2&#45;&gt;layer2_attn_2_2</title>
<path fill="none" stroke="black" d="M28473.38,-441.01C28491.88,-451.43 28512.81,-461.15 28533.5,-466.5 28622.57,-489.51 28650.78,-486.86 28740.5,-466.5 28766.02,-460.71 28792.32,-449.67 28815.14,-438.2"/>
<polygon fill="black" stroke="black" points="28816.75,-441.31 28824.04,-433.62 28813.54,-435.08 28816.75,-441.31"/>
</g>
<!-- layer2_v_2_2&#45;&gt;layer2_attn_2_2 -->
<g id="edge292" class="edge">
<title>layer2_v_2_2&#45;&gt;layer2_attn_2_2</title>
<path fill="none" stroke="black" d="M28248.38,-441.01C28266.88,-451.43 28287.81,-461.15 28308.5,-466.5 28401.45,-490.52 28646.88,-487.75 28740.5,-466.5 28766.02,-460.71 28792.32,-449.67 28815.14,-438.2"/>
<polygon fill="black" stroke="black" points="28816.75,-441.31 28824.04,-433.62 28813.54,-435.08 28816.75,-441.31"/>
</g>
<!-- layer2_attn_2_3 -->
<g id="node192" class="node">
<title>layer2_attn_2_3</title>
<path fill="orange" stroke="black" d="M28054,-433.5C28054,-433.5 27871,-433.5 27871,-433.5 27865,-433.5 27859,-427.5 27859,-421.5 27859,-421.5 27859,-377.5 27859,-377.5 27859,-371.5 27865,-365.5 27871,-365.5 27871,-365.5 28054,-365.5 28054,-365.5 28060,-365.5 28066,-371.5 28066,-377.5 28066,-377.5 28066,-421.5 28066,-421.5 28066,-427.5 28060,-433.5 28054,-433.5"/>
<text text-anchor="middle" x="27962.5" y="-418.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="27962.5" y="-403.3" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="27962.5" y="-388.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="27962.5" y="-373.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer2_q_2_3&#45;&gt;layer2_attn_2_3 -->
<g id="edge293" class="edge">
<title>layer2_q_2_3&#45;&gt;layer2_attn_2_3</title>
<path fill="none" stroke="black" d="M27823.44,-399.5C27831.81,-399.5 27840.17,-399.5 27848.54,-399.5"/>
<polygon fill="black" stroke="black" points="27848.75,-403 27858.75,-399.5 27848.75,-396 27848.75,-403"/>
</g>
<!-- layer2_k_2_3&#45;&gt;layer2_attn_2_3 -->
<g id="edge294" class="edge">
<title>layer2_k_2_3&#45;&gt;layer2_attn_2_3</title>
<path fill="none" stroke="black" d="M27555.38,-441.01C27573.88,-451.43 27594.81,-461.15 27615.5,-466.5 27704.57,-489.51 27732.78,-486.86 27822.5,-466.5 27848.02,-460.71 27874.32,-449.67 27897.14,-438.2"/>
<polygon fill="black" stroke="black" points="27898.75,-441.31 27906.04,-433.62 27895.54,-435.08 27898.75,-441.31"/>
</g>
<!-- layer2_v_2_3&#45;&gt;layer2_attn_2_3 -->
<g id="edge295" class="edge">
<title>layer2_v_2_3&#45;&gt;layer2_attn_2_3</title>
<path fill="none" stroke="black" d="M27330.38,-441.01C27348.88,-451.43 27369.81,-461.15 27390.5,-466.5 27483.45,-490.52 27728.88,-487.75 27822.5,-466.5 27848.02,-460.71 27874.32,-449.67 27897.14,-438.2"/>
<polygon fill="black" stroke="black" points="27898.75,-441.31 27906.04,-433.62 27895.54,-435.08 27898.75,-441.31"/>
</g>
<!-- layer2_attn_3_0 -->
<g id="node193" class="node">
<title>layer2_attn_3_0</title>
<path fill="orange" stroke="black" d="M26954,-433.5C26954,-433.5 26771,-433.5 26771,-433.5 26765,-433.5 26759,-427.5 26759,-421.5 26759,-421.5 26759,-377.5 26759,-377.5 26759,-371.5 26765,-365.5 26771,-365.5 26771,-365.5 26954,-365.5 26954,-365.5 26960,-365.5 26966,-371.5 26966,-377.5 26966,-377.5 26966,-421.5 26966,-421.5 26966,-427.5 26960,-433.5 26954,-433.5"/>
<text text-anchor="middle" x="26862.5" y="-418.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="26862.5" y="-403.3" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="26862.5" y="-388.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="26862.5" y="-373.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_q_3_0&#45;&gt;layer2_attn_3_0 -->
<g id="edge296" class="edge">
<title>layer2_q_3_0&#45;&gt;layer2_attn_3_0</title>
<path fill="none" stroke="black" d="M26723.44,-399.5C26731.81,-399.5 26740.17,-399.5 26748.54,-399.5"/>
<polygon fill="black" stroke="black" points="26748.75,-403 26758.75,-399.5 26748.75,-396 26748.75,-403"/>
</g>
<!-- layer2_k_3_0&#45;&gt;layer2_attn_3_0 -->
<g id="edge297" class="edge">
<title>layer2_k_3_0&#45;&gt;layer2_attn_3_0</title>
<path fill="none" stroke="black" d="M26455.38,-441.01C26473.88,-451.43 26494.81,-461.15 26515.5,-466.5 26604.57,-489.51 26632.78,-486.86 26722.5,-466.5 26748.02,-460.71 26774.32,-449.67 26797.14,-438.2"/>
<polygon fill="black" stroke="black" points="26798.75,-441.31 26806.04,-433.62 26795.54,-435.08 26798.75,-441.31"/>
</g>
<!-- layer2_v_3_0&#45;&gt;layer2_attn_3_0 -->
<g id="edge298" class="edge">
<title>layer2_v_3_0&#45;&gt;layer2_attn_3_0</title>
<path fill="none" stroke="black" d="M26230.38,-441.01C26248.88,-451.43 26269.81,-461.15 26290.5,-466.5 26383.45,-490.52 26628.88,-487.75 26722.5,-466.5 26748.02,-460.71 26774.32,-449.67 26797.14,-438.2"/>
<polygon fill="black" stroke="black" points="26798.75,-441.31 26806.04,-433.62 26795.54,-435.08 26798.75,-441.31"/>
</g>
<!-- layer2_attn_3_1 -->
<g id="node194" class="node">
<title>layer2_attn_3_1</title>
<path fill="orange" stroke="black" d="M26036,-433.5C26036,-433.5 25853,-433.5 25853,-433.5 25847,-433.5 25841,-427.5 25841,-421.5 25841,-421.5 25841,-377.5 25841,-377.5 25841,-371.5 25847,-365.5 25853,-365.5 25853,-365.5 26036,-365.5 26036,-365.5 26042,-365.5 26048,-371.5 26048,-377.5 26048,-377.5 26048,-421.5 26048,-421.5 26048,-427.5 26042,-433.5 26036,-433.5"/>
<text text-anchor="middle" x="25944.5" y="-418.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="25944.5" y="-403.3" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="25944.5" y="-388.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="25944.5" y="-373.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer2_q_3_1&#45;&gt;layer2_attn_3_1 -->
<g id="edge299" class="edge">
<title>layer2_q_3_1&#45;&gt;layer2_attn_3_1</title>
<path fill="none" stroke="black" d="M25805.44,-399.5C25813.81,-399.5 25822.17,-399.5 25830.54,-399.5"/>
<polygon fill="black" stroke="black" points="25830.75,-403 25840.75,-399.5 25830.75,-396 25830.75,-403"/>
</g>
<!-- layer2_k_3_1&#45;&gt;layer2_attn_3_1 -->
<g id="edge300" class="edge">
<title>layer2_k_3_1&#45;&gt;layer2_attn_3_1</title>
<path fill="none" stroke="black" d="M25537.38,-441.01C25555.88,-451.43 25576.81,-461.15 25597.5,-466.5 25686.57,-489.51 25714.78,-486.86 25804.5,-466.5 25830.02,-460.71 25856.32,-449.67 25879.14,-438.2"/>
<polygon fill="black" stroke="black" points="25880.75,-441.31 25888.04,-433.62 25877.54,-435.08 25880.75,-441.31"/>
</g>
<!-- layer2_v_3_1&#45;&gt;layer2_attn_3_1 -->
<g id="edge301" class="edge">
<title>layer2_v_3_1&#45;&gt;layer2_attn_3_1</title>
<path fill="none" stroke="black" d="M25312.38,-441.01C25330.88,-451.43 25351.81,-461.15 25372.5,-466.5 25465.45,-490.52 25710.88,-487.75 25804.5,-466.5 25830.02,-460.71 25856.32,-449.67 25879.14,-438.2"/>
<polygon fill="black" stroke="black" points="25880.75,-441.31 25888.04,-433.62 25877.54,-435.08 25880.75,-441.31"/>
</g>
<!-- layer2_attn_3_2 -->
<g id="node195" class="node">
<title>layer2_attn_3_2</title>
<path fill="orange" stroke="black" d="M25118,-433.5C25118,-433.5 24935,-433.5 24935,-433.5 24929,-433.5 24923,-427.5 24923,-421.5 24923,-421.5 24923,-377.5 24923,-377.5 24923,-371.5 24929,-365.5 24935,-365.5 24935,-365.5 25118,-365.5 25118,-365.5 25124,-365.5 25130,-371.5 25130,-377.5 25130,-377.5 25130,-421.5 25130,-421.5 25130,-427.5 25124,-433.5 25118,-433.5"/>
<text text-anchor="middle" x="25026.5" y="-418.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="25026.5" y="-403.3" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="25026.5" y="-388.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="25026.5" y="-373.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_q_3_2&#45;&gt;layer2_attn_3_2 -->
<g id="edge302" class="edge">
<title>layer2_q_3_2&#45;&gt;layer2_attn_3_2</title>
<path fill="none" stroke="black" d="M24887.44,-399.5C24895.81,-399.5 24904.17,-399.5 24912.54,-399.5"/>
<polygon fill="black" stroke="black" points="24912.75,-403 24922.75,-399.5 24912.75,-396 24912.75,-403"/>
</g>
<!-- layer2_k_3_2&#45;&gt;layer2_attn_3_2 -->
<g id="edge303" class="edge">
<title>layer2_k_3_2&#45;&gt;layer2_attn_3_2</title>
<path fill="none" stroke="black" d="M24619.38,-441.01C24637.88,-451.43 24658.81,-461.15 24679.5,-466.5 24768.57,-489.51 24796.78,-486.86 24886.5,-466.5 24912.02,-460.71 24938.32,-449.67 24961.14,-438.2"/>
<polygon fill="black" stroke="black" points="24962.75,-441.31 24970.04,-433.62 24959.54,-435.08 24962.75,-441.31"/>
</g>
<!-- layer2_v_3_2&#45;&gt;layer2_attn_3_2 -->
<g id="edge304" class="edge">
<title>layer2_v_3_2&#45;&gt;layer2_attn_3_2</title>
<path fill="none" stroke="black" d="M24394.38,-441.01C24412.88,-451.43 24433.81,-461.15 24454.5,-466.5 24547.45,-490.52 24792.88,-487.75 24886.5,-466.5 24912.02,-460.71 24938.32,-449.67 24961.14,-438.2"/>
<polygon fill="black" stroke="black" points="24962.75,-441.31 24970.04,-433.62 24959.54,-435.08 24962.75,-441.31"/>
</g>
<!-- layer2_attn_3_3 -->
<g id="node196" class="node">
<title>layer2_attn_3_3</title>
<path fill="orange" stroke="black" d="M24200,-433.5C24200,-433.5 24017,-433.5 24017,-433.5 24011,-433.5 24005,-427.5 24005,-421.5 24005,-421.5 24005,-377.5 24005,-377.5 24005,-371.5 24011,-365.5 24017,-365.5 24017,-365.5 24200,-365.5 24200,-365.5 24206,-365.5 24212,-371.5 24212,-377.5 24212,-377.5 24212,-421.5 24212,-421.5 24212,-427.5 24206,-433.5 24200,-433.5"/>
<text text-anchor="middle" x="24108.5" y="-418.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="24108.5" y="-403.3" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="24108.5" y="-388.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="24108.5" y="-373.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer2_q_3_3&#45;&gt;layer2_attn_3_3 -->
<g id="edge305" class="edge">
<title>layer2_q_3_3&#45;&gt;layer2_attn_3_3</title>
<path fill="none" stroke="black" d="M23969.44,-399.5C23977.81,-399.5 23986.17,-399.5 23994.54,-399.5"/>
<polygon fill="black" stroke="black" points="23994.75,-403 24004.75,-399.5 23994.75,-396 23994.75,-403"/>
</g>
<!-- layer2_k_3_3&#45;&gt;layer2_attn_3_3 -->
<g id="edge306" class="edge">
<title>layer2_k_3_3&#45;&gt;layer2_attn_3_3</title>
<path fill="none" stroke="black" d="M23701.38,-441.01C23719.88,-451.43 23740.81,-461.15 23761.5,-466.5 23850.57,-489.51 23878.78,-486.86 23968.5,-466.5 23994.02,-460.71 24020.32,-449.67 24043.14,-438.2"/>
<polygon fill="black" stroke="black" points="24044.75,-441.31 24052.04,-433.62 24041.54,-435.08 24044.75,-441.31"/>
</g>
<!-- layer2_v_3_3&#45;&gt;layer2_attn_3_3 -->
<g id="edge307" class="edge">
<title>layer2_v_3_3&#45;&gt;layer2_attn_3_3</title>
<path fill="none" stroke="black" d="M23476.38,-441.01C23494.88,-451.43 23515.81,-461.15 23536.5,-466.5 23629.45,-490.52 23874.88,-487.75 23968.5,-466.5 23994.02,-460.71 24020.32,-449.67 24043.14,-438.2"/>
<polygon fill="black" stroke="black" points="24044.75,-441.31 24052.04,-433.62 24041.54,-435.08 24044.75,-441.31"/>
</g>
<!-- layer2_out_proj -->
<g id="node167" class="node">
<title>layer2_out_proj</title>
<path fill="lightcoral" stroke="black" d="M39077.5,-433.5C39077.5,-433.5 38957.5,-433.5 38957.5,-433.5 38951.5,-433.5 38945.5,-427.5 38945.5,-421.5 38945.5,-421.5 38945.5,-377.5 38945.5,-377.5 38945.5,-371.5 38951.5,-365.5 38957.5,-365.5 38957.5,-365.5 39077.5,-365.5 39077.5,-365.5 39083.5,-365.5 39089.5,-371.5 39089.5,-377.5 39089.5,-377.5 39089.5,-421.5 39089.5,-421.5 39089.5,-427.5 39083.5,-433.5 39077.5,-433.5"/>
<text text-anchor="middle" x="39017.5" y="-418.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="39017.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="39017.5" y="-388.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="39017.5" y="-373.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer2_out_proj&#45;&gt;layer2_residual1 -->
<g id="edge238" class="edge">
<title>layer2_out_proj&#45;&gt;layer2_residual1</title>
<path fill="none" stroke="black" d="M39089.55,-399.5C39098.08,-399.5 39106.6,-399.5 39115.13,-399.5"/>
<polygon fill="black" stroke="black" points="39115.13,-403 39125.13,-399.5 39115.13,-396 39115.13,-403"/>
</g>
<!-- layer2_ln2 -->
<g id="node169" class="node">
<title>layer2_ln2</title>
<path fill="lightyellow" stroke="black" d="M39384,-426C39384,-426 39297,-426 39297,-426 39291,-426 39285,-420 39285,-414 39285,-414 39285,-385 39285,-385 39285,-379 39291,-373 39297,-373 39297,-373 39384,-373 39384,-373 39390,-373 39396,-379 39396,-385 39396,-385 39396,-414 39396,-414 39396,-420 39390,-426 39384,-426"/>
<text text-anchor="middle" x="39340.5" y="-410.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="39340.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="39340.5" y="-380.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_residual1&#45;&gt;layer2_ln2 -->
<g id="edge240" class="edge">
<title>layer2_residual1&#45;&gt;layer2_ln2</title>
<path fill="none" stroke="black" d="M39249.66,-399.5C39257.98,-399.5 39266.31,-399.5 39274.63,-399.5"/>
<polygon fill="black" stroke="black" points="39274.79,-403 39284.79,-399.5 39274.79,-396 39274.79,-403"/>
</g>
<!-- layer2_residual2 -->
<g id="node180" class="node">
<title>layer2_residual2</title>
<path fill="lightgreen" stroke="black" d="M46435.5,-426C46435.5,-426 46335.5,-426 46335.5,-426 46329.5,-426 46323.5,-420 46323.5,-414 46323.5,-414 46323.5,-385 46323.5,-385 46323.5,-379 46329.5,-373 46335.5,-373 46335.5,-373 46435.5,-373 46435.5,-373 46441.5,-373 46447.5,-379 46447.5,-385 46447.5,-385 46447.5,-414 46447.5,-414 46447.5,-420 46441.5,-426 46435.5,-426"/>
<text text-anchor="middle" x="46385.5" y="-410.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="46385.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="46385.5" y="-380.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_residual1&#45;&gt;layer2_residual2 -->
<g id="edge259" class="edge">
<title>layer2_residual1&#45;&gt;layer2_residual2</title>
<path fill="none" stroke="black" d="M39215.99,-426.11C39234.1,-441.16 39258.9,-458.52 39284.5,-466.5 39377.36,-495.45 46194.58,-495.23 46287.5,-466.5 46309.67,-459.65 46331.29,-445.86 46348.56,-432.57"/>
<polygon fill="black" stroke="black" points="46351.03,-435.08 46356.67,-426.12 46346.67,-429.61 46351.03,-435.08"/>
</g>
<!-- layer2_router -->
<g id="node170" class="node">
<title>layer2_router</title>
<path fill="gold" stroke="black" d="M39599,-433.5C39599,-433.5 39444,-433.5 39444,-433.5 39438,-433.5 39432,-427.5 39432,-421.5 39432,-421.5 39432,-377.5 39432,-377.5 39432,-371.5 39438,-365.5 39444,-365.5 39444,-365.5 39599,-365.5 39599,-365.5 39605,-365.5 39611,-371.5 39611,-377.5 39611,-377.5 39611,-421.5 39611,-421.5 39611,-427.5 39605,-433.5 39599,-433.5"/>
<text text-anchor="middle" x="39521.5" y="-418.3" font-family="Times,serif" font-size="14.00">MoE Router</text>
<text text-anchor="middle" x="39521.5" y="-403.3" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="39521.5" y="-388.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]  [B, L, 8]</text>
<text text-anchor="middle" x="39521.5" y="-373.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_ln2&#45;&gt;layer2_router -->
<g id="edge241" class="edge">
<title>layer2_ln2&#45;&gt;layer2_router</title>
<path fill="none" stroke="black" d="M39396,-399.5C39404.58,-399.5 39413.15,-399.5 39421.72,-399.5"/>
<polygon fill="black" stroke="black" points="39421.79,-403 39431.79,-399.5 39421.79,-396 39421.79,-403"/>
</g>
<!-- layer2_expert_0_gate -->
<g id="node171" class="node">
<title>layer2_expert_0_gate</title>
<path fill="lightyellow" stroke="black" d="M45432,-426C45432,-426 45339,-426 45339,-426 45333,-426 45327,-420 45327,-414 45327,-414 45327,-385 45327,-385 45327,-379 45333,-373 45339,-373 45339,-373 45432,-373 45432,-373 45438,-373 45444,-379 45444,-385 45444,-385 45444,-414 45444,-414 45444,-420 45438,-426 45432,-426"/>
<text text-anchor="middle" x="45385.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="45385.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="45385.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_ln2&#45;&gt;layer2_expert_0_gate -->
<g id="edge243" class="edge">
<title>layer2_ln2&#45;&gt;layer2_expert_0_gate</title>
<path fill="none" stroke="black" d="M39366.94,-426.09C39383.83,-441.12 39407.08,-458.48 39431.5,-466.5 39509.05,-491.97 45232.05,-495.1 45308.5,-466.5 45326.67,-459.7 45343.39,-446.46 45356.57,-433.53"/>
<polygon fill="black" stroke="black" points="45359.43,-435.61 45363.9,-426 45354.42,-430.72 45359.43,-435.61"/>
</g>
<!-- layer2_expert_1_gate -->
<g id="node172" class="node">
<title>layer2_expert_1_gate</title>
<path fill="lightyellow" stroke="black" d="M44631,-426C44631,-426 44538,-426 44538,-426 44532,-426 44526,-420 44526,-414 44526,-414 44526,-385 44526,-385 44526,-379 44532,-373 44538,-373 44538,-373 44631,-373 44631,-373 44637,-373 44643,-379 44643,-385 44643,-385 44643,-414 44643,-414 44643,-420 44637,-426 44631,-426"/>
<text text-anchor="middle" x="44584.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="44584.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="44584.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_ln2&#45;&gt;layer2_expert_1_gate -->
<g id="edge245" class="edge">
<title>layer2_ln2&#45;&gt;layer2_expert_1_gate</title>
<path fill="none" stroke="black" d="M39366.94,-426.09C39383.83,-441.12 39407.08,-458.48 39431.5,-466.5 39498.48,-488.5 44441.47,-491.21 44507.5,-466.5 44525.67,-459.7 44542.39,-446.46 44555.57,-433.53"/>
<polygon fill="black" stroke="black" points="44558.43,-435.61 44562.9,-426 44553.42,-430.72 44558.43,-435.61"/>
</g>
<!-- layer2_expert_2_gate -->
<g id="node173" class="node">
<title>layer2_expert_2_gate</title>
<path fill="lightyellow" stroke="black" d="M43830,-426C43830,-426 43737,-426 43737,-426 43731,-426 43725,-420 43725,-414 43725,-414 43725,-385 43725,-385 43725,-379 43731,-373 43737,-373 43737,-373 43830,-373 43830,-373 43836,-373 43842,-379 43842,-385 43842,-385 43842,-414 43842,-414 43842,-420 43836,-426 43830,-426"/>
<text text-anchor="middle" x="43783.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="43783.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="43783.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_ln2&#45;&gt;layer2_expert_2_gate -->
<g id="edge247" class="edge">
<title>layer2_ln2&#45;&gt;layer2_expert_2_gate</title>
<path fill="none" stroke="black" d="M39366.94,-426.09C39383.83,-441.12 39407.08,-458.48 39431.5,-466.5 39487.91,-485.03 43650.89,-487.31 43706.5,-466.5 43724.67,-459.7 43741.39,-446.46 43754.57,-433.53"/>
<polygon fill="black" stroke="black" points="43757.43,-435.61 43761.9,-426 43752.42,-430.72 43757.43,-435.61"/>
</g>
<!-- layer2_expert_3_gate -->
<g id="node174" class="node">
<title>layer2_expert_3_gate</title>
<path fill="lightyellow" stroke="black" d="M43029,-426C43029,-426 42936,-426 42936,-426 42930,-426 42924,-420 42924,-414 42924,-414 42924,-385 42924,-385 42924,-379 42930,-373 42936,-373 42936,-373 43029,-373 43029,-373 43035,-373 43041,-379 43041,-385 43041,-385 43041,-414 43041,-414 43041,-420 43035,-426 43029,-426"/>
<text text-anchor="middle" x="42982.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="42982.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="42982.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_ln2&#45;&gt;layer2_expert_3_gate -->
<g id="edge249" class="edge">
<title>layer2_ln2&#45;&gt;layer2_expert_3_gate</title>
<path fill="none" stroke="black" d="M39366.94,-426.09C39383.83,-441.12 39407.08,-458.48 39431.5,-466.5 39523.18,-496.61 42815.12,-500.32 42905.5,-466.5 42923.67,-459.7 42940.39,-446.46 42953.57,-433.53"/>
<polygon fill="black" stroke="black" points="42956.43,-435.61 42960.9,-426 42951.42,-430.72 42956.43,-435.61"/>
</g>
<!-- layer2_expert_4_gate -->
<g id="node175" class="node">
<title>layer2_expert_4_gate</title>
<path fill="lightyellow" stroke="black" d="M42228,-426C42228,-426 42135,-426 42135,-426 42129,-426 42123,-420 42123,-414 42123,-414 42123,-385 42123,-385 42123,-379 42129,-373 42135,-373 42135,-373 42228,-373 42228,-373 42234,-373 42240,-379 42240,-385 42240,-385 42240,-414 42240,-414 42240,-420 42234,-426 42228,-426"/>
<text text-anchor="middle" x="42181.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="42181.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="42181.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_ln2&#45;&gt;layer2_expert_4_gate -->
<g id="edge251" class="edge">
<title>layer2_ln2&#45;&gt;layer2_expert_4_gate</title>
<path fill="none" stroke="black" d="M39366.94,-426.09C39383.83,-441.12 39407.08,-458.48 39431.5,-466.5 39502.04,-489.67 42034.96,-492.52 42104.5,-466.5 42122.67,-459.7 42139.39,-446.46 42152.57,-433.53"/>
<polygon fill="black" stroke="black" points="42155.43,-435.61 42159.9,-426 42150.42,-430.72 42155.43,-435.61"/>
</g>
<!-- layer2_expert_5_gate -->
<g id="node176" class="node">
<title>layer2_expert_5_gate</title>
<path fill="lightyellow" stroke="black" d="M41427,-426C41427,-426 41334,-426 41334,-426 41328,-426 41322,-420 41322,-414 41322,-414 41322,-385 41322,-385 41322,-379 41328,-373 41334,-373 41334,-373 41427,-373 41427,-373 41433,-373 41439,-379 41439,-385 41439,-385 41439,-414 41439,-414 41439,-420 41433,-426 41427,-426"/>
<text text-anchor="middle" x="41380.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="41380.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="41380.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_ln2&#45;&gt;layer2_expert_5_gate -->
<g id="edge253" class="edge">
<title>layer2_ln2&#45;&gt;layer2_expert_5_gate</title>
<path fill="none" stroke="black" d="M39366.94,-426.09C39383.83,-441.12 39407.08,-458.48 39431.5,-466.5 39480.9,-482.73 41254.8,-484.72 41303.5,-466.5 41321.67,-459.7 41338.39,-446.46 41351.57,-433.53"/>
<polygon fill="black" stroke="black" points="41354.43,-435.61 41358.9,-426 41349.42,-430.72 41354.43,-435.61"/>
</g>
<!-- layer2_expert_6_gate -->
<g id="node177" class="node">
<title>layer2_expert_6_gate</title>
<path fill="lightyellow" stroke="black" d="M40626,-426C40626,-426 40533,-426 40533,-426 40527,-426 40521,-420 40521,-414 40521,-414 40521,-385 40521,-385 40521,-379 40527,-373 40533,-373 40533,-373 40626,-373 40626,-373 40632,-373 40638,-379 40638,-385 40638,-385 40638,-414 40638,-414 40638,-420 40632,-426 40626,-426"/>
<text text-anchor="middle" x="40579.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="40579.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="40579.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_ln2&#45;&gt;layer2_expert_6_gate -->
<g id="edge255" class="edge">
<title>layer2_ln2&#45;&gt;layer2_expert_6_gate</title>
<path fill="none" stroke="black" d="M39366.94,-426.09C39383.83,-441.12 39407.08,-458.48 39431.5,-466.5 39488.03,-485.07 40446.77,-487.35 40502.5,-466.5 40520.67,-459.7 40537.39,-446.46 40550.57,-433.53"/>
<polygon fill="black" stroke="black" points="40553.43,-435.61 40557.9,-426 40548.42,-430.72 40553.43,-435.61"/>
</g>
<!-- layer2_expert_7_gate -->
<g id="node178" class="node">
<title>layer2_expert_7_gate</title>
<path fill="lightyellow" stroke="black" d="M39825,-426C39825,-426 39732,-426 39732,-426 39726,-426 39720,-420 39720,-414 39720,-414 39720,-385 39720,-385 39720,-379 39726,-373 39732,-373 39732,-373 39825,-373 39825,-373 39831,-373 39837,-379 39837,-385 39837,-385 39837,-414 39837,-414 39837,-420 39831,-426 39825,-426"/>
<text text-anchor="middle" x="39778.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="39778.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="39778.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_ln2&#45;&gt;layer2_expert_7_gate -->
<g id="edge257" class="edge">
<title>layer2_ln2&#45;&gt;layer2_expert_7_gate</title>
<path fill="none" stroke="black" d="M39366.94,-426.09C39383.83,-441.12 39407.08,-458.48 39431.5,-466.5 39507.08,-491.32 39532.37,-481.5 39610.5,-466.5 39647.25,-459.44 39686.19,-444.44 39717.32,-430.41"/>
<polygon fill="black" stroke="black" points="39719.09,-433.45 39726.72,-426.1 39716.17,-427.09 39719.09,-433.45"/>
</g>
<!-- layer2_router&#45;&gt;layer2_expert_0_gate -->
<g id="edge242" class="edge">
<title>layer2_router&#45;&gt;layer2_expert_0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39602.33,-433.52C39637.63,-446.61 39679.93,-459.99 39719.5,-466.5 39796.09,-479.11 45235.8,-493.7 45308.5,-466.5 45326.67,-459.7 45343.39,-446.46 45356.57,-433.53"/>
<polygon fill="black" stroke="black" points="45359.43,-435.61 45363.9,-426 45354.42,-430.72 45359.43,-435.61"/>
</g>
<!-- layer2_router&#45;&gt;layer2_expert_0_gate -->
<g id="edge333" class="edge">
<title>layer2_router&#45;&gt;layer2_expert_0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39611.26,-433.5C40329.61,-433.5 45123.36,-433.5 45375.2,-433.5"/>
<polygon fill="black" stroke="black" points="45375.44,-437 45385.44,-433.5 45375.44,-430 45375.44,-437"/>
<text text-anchor="middle" x="39521.5" y="-395.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert_1_gate -->
<g id="edge244" class="edge">
<title>layer2_router&#45;&gt;layer2_expert_1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39602.33,-433.52C39637.63,-446.61 39679.93,-459.99 39719.5,-466.5 39785.12,-477.3 44445.22,-489.8 44507.5,-466.5 44525.67,-459.7 44542.39,-446.46 44555.57,-433.53"/>
<polygon fill="black" stroke="black" points="44558.43,-435.61 44562.9,-426 44553.42,-430.72 44558.43,-435.61"/>
</g>
<!-- layer2_router&#45;&gt;layer2_expert_1_gate -->
<g id="edge338" class="edge">
<title>layer2_router&#45;&gt;layer2_expert_1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39611.26,-433.5C40270.49,-433.5 44344.57,-433.5 44574.38,-433.5"/>
<polygon fill="black" stroke="black" points="44574.45,-437 44584.45,-433.5 44574.45,-430 44574.45,-437"/>
<text text-anchor="middle" x="39521.5" y="-395.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert_2_gate -->
<g id="edge246" class="edge">
<title>layer2_router&#45;&gt;layer2_expert_2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39602.33,-433.52C39637.63,-446.61 39679.93,-459.99 39719.5,-466.5 39828.78,-484.49 43602.77,-505.31 43706.5,-466.5 43724.67,-459.7 43741.39,-446.46 43754.57,-433.53"/>
<polygon fill="black" stroke="black" points="43757.43,-435.61 43761.9,-426 43752.42,-430.72 43757.43,-435.61"/>
</g>
<!-- layer2_router&#45;&gt;layer2_expert_2_gate -->
<g id="edge343" class="edge">
<title>layer2_router&#45;&gt;layer2_expert_2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39611.01,-433.5C40205.05,-433.5 43561.3,-433.5 43773.02,-433.5"/>
<polygon fill="black" stroke="black" points="43773.34,-437 43783.34,-433.5 43773.34,-430 43773.34,-437"/>
<text text-anchor="middle" x="39521.5" y="-395.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert_3_gate -->
<g id="edge248" class="edge">
<title>layer2_router&#45;&gt;layer2_expert_3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39602.33,-433.52C39637.63,-446.61 39679.93,-459.99 39719.5,-466.5 39806.82,-480.87 42822.61,-497.51 42905.5,-466.5 42923.67,-459.7 42940.39,-446.46 42953.57,-433.53"/>
<polygon fill="black" stroke="black" points="42956.43,-435.61 42960.9,-426 42951.42,-430.72 42956.43,-435.61"/>
</g>
<!-- layer2_router&#45;&gt;layer2_expert_3_gate -->
<g id="edge348" class="edge">
<title>layer2_router&#45;&gt;layer2_expert_3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39611.41,-433.5C40136.26,-433.5 42787.21,-433.5 42972.31,-433.5"/>
<polygon fill="black" stroke="black" points="42972.37,-437 42982.37,-433.5 42972.37,-430 42972.37,-437"/>
<text text-anchor="middle" x="39521.5" y="-395.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert_4_gate -->
<g id="edge250" class="edge">
<title>layer2_router&#45;&gt;layer2_expert_4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39602.33,-433.52C39637.63,-446.61 39679.93,-459.99 39719.5,-466.5 39784.87,-477.26 42042.45,-489.72 42104.5,-466.5 42122.67,-459.7 42139.39,-446.46 42152.57,-433.53"/>
<polygon fill="black" stroke="black" points="42155.43,-435.61 42159.9,-426 42150.42,-430.72 42155.43,-435.61"/>
</g>
<!-- layer2_router&#45;&gt;layer2_expert_4_gate -->
<g id="edge353" class="edge">
<title>layer2_router&#45;&gt;layer2_expert_4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39611.14,-433.5C40056.06,-433.5 42012.06,-433.5 42171.2,-433.5"/>
<polygon fill="black" stroke="black" points="42171.4,-437 42181.4,-433.5 42171.4,-430 42171.4,-437"/>
<text text-anchor="middle" x="39521.5" y="-395.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert_5_gate -->
<g id="edge252" class="edge">
<title>layer2_router&#45;&gt;layer2_expert_5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39602.33,-433.52C39637.63,-446.61 39679.93,-459.99 39719.5,-466.5 39806.33,-480.79 41221.08,-497.34 41303.5,-466.5 41321.67,-459.7 41338.39,-446.46 41351.57,-433.53"/>
<polygon fill="black" stroke="black" points="41354.43,-435.61 41358.9,-426 41349.42,-430.72 41354.43,-435.61"/>
</g>
<!-- layer2_router&#45;&gt;layer2_expert_5_gate -->
<g id="edge358" class="edge">
<title>layer2_router&#45;&gt;layer2_expert_5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39611.16,-433.5C39963.72,-433.5 41241.66,-433.5 41370.08,-433.5"/>
<polygon fill="black" stroke="black" points="41370.44,-437 41380.44,-433.5 41370.44,-430 41370.44,-437"/>
<text text-anchor="middle" x="39521.5" y="-395.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert_6_gate -->
<g id="edge254" class="edge">
<title>layer2_router&#45;&gt;layer2_expert_6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39602.33,-433.52C39637.63,-446.61 39679.93,-459.99 39719.5,-466.5 39805.34,-480.63 40421.02,-496.99 40502.5,-466.5 40520.67,-459.7 40537.39,-446.46 40550.57,-433.53"/>
<polygon fill="black" stroke="black" points="40553.43,-435.61 40557.9,-426 40548.42,-430.72 40553.43,-435.61"/>
</g>
<!-- layer2_router&#45;&gt;layer2_expert_6_gate -->
<g id="edge363" class="edge">
<title>layer2_router&#45;&gt;layer2_expert_6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39611.25,-433.5C39848.63,-433.5 40480.87,-433.5 40569.2,-433.5"/>
<polygon fill="black" stroke="black" points="40569.37,-437 40579.37,-433.5 40569.37,-430 40569.37,-437"/>
<text text-anchor="middle" x="39521.5" y="-395.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer2_router&#45;&gt;layer2_expert_7_gate -->
<g id="edge256" class="edge">
<title>layer2_router&#45;&gt;layer2_expert_7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39611.14,-396.74C39634.73,-396.32 39660.16,-396.13 39683.67,-396.5 39692.07,-396.63 39700.89,-396.83 39709.63,-397.07"/>
<polygon fill="black" stroke="black" points="39709.73,-400.57 39719.82,-397.35 39709.93,-393.57 39709.73,-400.57"/>
</g>
<!-- layer2_router&#45;&gt;layer2_expert_7_gate -->
<g id="edge368" class="edge">
<title>layer2_router&#45;&gt;layer2_expert_7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M39611.03,-399.5C39643.43,-399.5 39679.49,-399.5 39709.83,-399.5"/>
<polygon fill="black" stroke="black" points="39709.88,-403 39719.88,-399.5 39709.88,-396 39709.88,-403"/>
<text text-anchor="middle" x="39665.5" y="-406.3" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer2_expert_0_up -->
<g id="node202" class="node">
<title>layer2_expert_0_up</title>
<path fill="lightcoral" stroke="black" d="M45607.5,-433.5C45607.5,-433.5 45491.5,-433.5 45491.5,-433.5 45485.5,-433.5 45479.5,-427.5 45479.5,-421.5 45479.5,-421.5 45479.5,-377.5 45479.5,-377.5 45479.5,-371.5 45485.5,-365.5 45491.5,-365.5 45491.5,-365.5 45607.5,-365.5 45607.5,-365.5 45613.5,-365.5 45619.5,-371.5 45619.5,-377.5 45619.5,-377.5 45619.5,-421.5 45619.5,-421.5 45619.5,-427.5 45613.5,-433.5 45607.5,-433.5"/>
<text text-anchor="middle" x="45549.5" y="-418.3" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="45549.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="45549.5" y="-388.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="45549.5" y="-373.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_expert_0_gate&#45;&gt;layer2_expert_0_up -->
<g id="edge329" class="edge">
<title>layer2_expert_0_gate&#45;&gt;layer2_expert_0_up</title>
<path fill="none" stroke="black" d="M45444.12,-399.5C45452.41,-399.5 45460.7,-399.5 45468.99,-399.5"/>
<polygon fill="black" stroke="black" points="45469.11,-403 45479.11,-399.5 45469.11,-396 45469.11,-403"/>
</g>
<!-- layer2_expert_1_up -->
<g id="node206" class="node">
<title>layer2_expert_1_up</title>
<path fill="lightcoral" stroke="black" d="M44806.5,-433.5C44806.5,-433.5 44690.5,-433.5 44690.5,-433.5 44684.5,-433.5 44678.5,-427.5 44678.5,-421.5 44678.5,-421.5 44678.5,-377.5 44678.5,-377.5 44678.5,-371.5 44684.5,-365.5 44690.5,-365.5 44690.5,-365.5 44806.5,-365.5 44806.5,-365.5 44812.5,-365.5 44818.5,-371.5 44818.5,-377.5 44818.5,-377.5 44818.5,-421.5 44818.5,-421.5 44818.5,-427.5 44812.5,-433.5 44806.5,-433.5"/>
<text text-anchor="middle" x="44748.5" y="-418.3" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="44748.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="44748.5" y="-388.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="44748.5" y="-373.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_expert_1_gate&#45;&gt;layer2_expert_1_up -->
<g id="edge334" class="edge">
<title>layer2_expert_1_gate&#45;&gt;layer2_expert_1_up</title>
<path fill="none" stroke="black" d="M44643.12,-399.5C44651.41,-399.5 44659.7,-399.5 44667.99,-399.5"/>
<polygon fill="black" stroke="black" points="44668.11,-403 44678.11,-399.5 44668.11,-396 44668.11,-403"/>
</g>
<!-- layer2_expert_2_up -->
<g id="node210" class="node">
<title>layer2_expert_2_up</title>
<path fill="lightcoral" stroke="black" d="M44005.5,-433.5C44005.5,-433.5 43889.5,-433.5 43889.5,-433.5 43883.5,-433.5 43877.5,-427.5 43877.5,-421.5 43877.5,-421.5 43877.5,-377.5 43877.5,-377.5 43877.5,-371.5 43883.5,-365.5 43889.5,-365.5 43889.5,-365.5 44005.5,-365.5 44005.5,-365.5 44011.5,-365.5 44017.5,-371.5 44017.5,-377.5 44017.5,-377.5 44017.5,-421.5 44017.5,-421.5 44017.5,-427.5 44011.5,-433.5 44005.5,-433.5"/>
<text text-anchor="middle" x="43947.5" y="-418.3" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="43947.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="43947.5" y="-388.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="43947.5" y="-373.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_expert_2_gate&#45;&gt;layer2_expert_2_up -->
<g id="edge339" class="edge">
<title>layer2_expert_2_gate&#45;&gt;layer2_expert_2_up</title>
<path fill="none" stroke="black" d="M43842.12,-399.5C43850.41,-399.5 43858.7,-399.5 43866.99,-399.5"/>
<polygon fill="black" stroke="black" points="43867.11,-403 43877.11,-399.5 43867.11,-396 43867.11,-403"/>
</g>
<!-- layer2_expert_3_up -->
<g id="node214" class="node">
<title>layer2_expert_3_up</title>
<path fill="lightcoral" stroke="black" d="M43204.5,-433.5C43204.5,-433.5 43088.5,-433.5 43088.5,-433.5 43082.5,-433.5 43076.5,-427.5 43076.5,-421.5 43076.5,-421.5 43076.5,-377.5 43076.5,-377.5 43076.5,-371.5 43082.5,-365.5 43088.5,-365.5 43088.5,-365.5 43204.5,-365.5 43204.5,-365.5 43210.5,-365.5 43216.5,-371.5 43216.5,-377.5 43216.5,-377.5 43216.5,-421.5 43216.5,-421.5 43216.5,-427.5 43210.5,-433.5 43204.5,-433.5"/>
<text text-anchor="middle" x="43146.5" y="-418.3" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="43146.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="43146.5" y="-388.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="43146.5" y="-373.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_expert_3_gate&#45;&gt;layer2_expert_3_up -->
<g id="edge344" class="edge">
<title>layer2_expert_3_gate&#45;&gt;layer2_expert_3_up</title>
<path fill="none" stroke="black" d="M43041.12,-399.5C43049.41,-399.5 43057.7,-399.5 43065.99,-399.5"/>
<polygon fill="black" stroke="black" points="43066.11,-403 43076.11,-399.5 43066.11,-396 43066.11,-403"/>
</g>
<!-- layer2_expert_4_up -->
<g id="node218" class="node">
<title>layer2_expert_4_up</title>
<path fill="lightcoral" stroke="black" d="M42403.5,-433.5C42403.5,-433.5 42287.5,-433.5 42287.5,-433.5 42281.5,-433.5 42275.5,-427.5 42275.5,-421.5 42275.5,-421.5 42275.5,-377.5 42275.5,-377.5 42275.5,-371.5 42281.5,-365.5 42287.5,-365.5 42287.5,-365.5 42403.5,-365.5 42403.5,-365.5 42409.5,-365.5 42415.5,-371.5 42415.5,-377.5 42415.5,-377.5 42415.5,-421.5 42415.5,-421.5 42415.5,-427.5 42409.5,-433.5 42403.5,-433.5"/>
<text text-anchor="middle" x="42345.5" y="-418.3" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="42345.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="42345.5" y="-388.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="42345.5" y="-373.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_expert_4_gate&#45;&gt;layer2_expert_4_up -->
<g id="edge349" class="edge">
<title>layer2_expert_4_gate&#45;&gt;layer2_expert_4_up</title>
<path fill="none" stroke="black" d="M42240.12,-399.5C42248.41,-399.5 42256.7,-399.5 42264.99,-399.5"/>
<polygon fill="black" stroke="black" points="42265.11,-403 42275.11,-399.5 42265.11,-396 42265.11,-403"/>
</g>
<!-- layer2_expert_5_up -->
<g id="node222" class="node">
<title>layer2_expert_5_up</title>
<path fill="lightcoral" stroke="black" d="M41602.5,-433.5C41602.5,-433.5 41486.5,-433.5 41486.5,-433.5 41480.5,-433.5 41474.5,-427.5 41474.5,-421.5 41474.5,-421.5 41474.5,-377.5 41474.5,-377.5 41474.5,-371.5 41480.5,-365.5 41486.5,-365.5 41486.5,-365.5 41602.5,-365.5 41602.5,-365.5 41608.5,-365.5 41614.5,-371.5 41614.5,-377.5 41614.5,-377.5 41614.5,-421.5 41614.5,-421.5 41614.5,-427.5 41608.5,-433.5 41602.5,-433.5"/>
<text text-anchor="middle" x="41544.5" y="-418.3" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="41544.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="41544.5" y="-388.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="41544.5" y="-373.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_expert_5_gate&#45;&gt;layer2_expert_5_up -->
<g id="edge354" class="edge">
<title>layer2_expert_5_gate&#45;&gt;layer2_expert_5_up</title>
<path fill="none" stroke="black" d="M41439.12,-399.5C41447.41,-399.5 41455.7,-399.5 41463.99,-399.5"/>
<polygon fill="black" stroke="black" points="41464.11,-403 41474.11,-399.5 41464.11,-396 41464.11,-403"/>
</g>
<!-- layer2_expert_6_up -->
<g id="node226" class="node">
<title>layer2_expert_6_up</title>
<path fill="lightcoral" stroke="black" d="M40801.5,-433.5C40801.5,-433.5 40685.5,-433.5 40685.5,-433.5 40679.5,-433.5 40673.5,-427.5 40673.5,-421.5 40673.5,-421.5 40673.5,-377.5 40673.5,-377.5 40673.5,-371.5 40679.5,-365.5 40685.5,-365.5 40685.5,-365.5 40801.5,-365.5 40801.5,-365.5 40807.5,-365.5 40813.5,-371.5 40813.5,-377.5 40813.5,-377.5 40813.5,-421.5 40813.5,-421.5 40813.5,-427.5 40807.5,-433.5 40801.5,-433.5"/>
<text text-anchor="middle" x="40743.5" y="-418.3" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="40743.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="40743.5" y="-388.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="40743.5" y="-373.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_expert_6_gate&#45;&gt;layer2_expert_6_up -->
<g id="edge359" class="edge">
<title>layer2_expert_6_gate&#45;&gt;layer2_expert_6_up</title>
<path fill="none" stroke="black" d="M40638.12,-399.5C40646.41,-399.5 40654.7,-399.5 40662.99,-399.5"/>
<polygon fill="black" stroke="black" points="40663.11,-403 40673.11,-399.5 40663.11,-396 40663.11,-403"/>
</g>
<!-- layer2_expert_7_up -->
<g id="node230" class="node">
<title>layer2_expert_7_up</title>
<path fill="lightcoral" stroke="black" d="M40000.5,-433.5C40000.5,-433.5 39884.5,-433.5 39884.5,-433.5 39878.5,-433.5 39872.5,-427.5 39872.5,-421.5 39872.5,-421.5 39872.5,-377.5 39872.5,-377.5 39872.5,-371.5 39878.5,-365.5 39884.5,-365.5 39884.5,-365.5 40000.5,-365.5 40000.5,-365.5 40006.5,-365.5 40012.5,-371.5 40012.5,-377.5 40012.5,-377.5 40012.5,-421.5 40012.5,-421.5 40012.5,-427.5 40006.5,-433.5 40000.5,-433.5"/>
<text text-anchor="middle" x="39942.5" y="-418.3" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="39942.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="39942.5" y="-388.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="39942.5" y="-373.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer2_expert_7_gate&#45;&gt;layer2_expert_7_up -->
<g id="edge364" class="edge">
<title>layer2_expert_7_gate&#45;&gt;layer2_expert_7_up</title>
<path fill="none" stroke="black" d="M39837.12,-399.5C39845.41,-399.5 39853.7,-399.5 39861.99,-399.5"/>
<polygon fill="black" stroke="black" points="39862.11,-403 39872.11,-399.5 39862.11,-396 39862.11,-403"/>
</g>
<!-- layer2_moe_agg -->
<g id="node179" class="node">
<title>layer2_moe_agg</title>
<path fill="lightpink" stroke="black" d="M46275.5,-441C46275.5,-441 46157.5,-441 46157.5,-441 46151.5,-441 46145.5,-435 46145.5,-429 46145.5,-429 46145.5,-370 46145.5,-370 46145.5,-364 46151.5,-358 46157.5,-358 46157.5,-358 46275.5,-358 46275.5,-358 46281.5,-358 46287.5,-364 46287.5,-370 46287.5,-370 46287.5,-429 46287.5,-429 46287.5,-435 46281.5,-441 46275.5,-441"/>
<text text-anchor="middle" x="46216.5" y="-425.8" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="46216.5" y="-410.8" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="46216.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="46216.5" y="-380.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="46216.5" y="-365.8" font-family="Times,serif" font-size="14.00">(AllReduce)</text>
</g>
<!-- layer2_moe_agg&#45;&gt;layer2_residual2 -->
<g id="edge258" class="edge">
<title>layer2_moe_agg&#45;&gt;layer2_residual2</title>
<path fill="none" stroke="black" d="M46287.8,-399.5C46296.21,-399.5 46304.62,-399.5 46313.03,-399.5"/>
<polygon fill="black" stroke="black" points="46313.29,-403 46323.29,-399.5 46313.29,-396 46313.29,-403"/>
</g>
<!-- layer3_ln1 -->
<g id="node234" class="node">
<title>layer3_ln1</title>
<path fill="lightyellow" stroke="black" d="M46429,-292C46429,-292 46342,-292 46342,-292 46336,-292 46330,-286 46330,-280 46330,-280 46330,-251 46330,-251 46330,-245 46336,-239 46342,-239 46342,-239 46429,-239 46429,-239 46435,-239 46441,-245 46441,-251 46441,-251 46441,-280 46441,-280 46441,-286 46435,-292 46429,-292"/>
<text text-anchor="middle" x="46385.5" y="-276.8" font-family="Times,serif" font-size="14.00">LayerNorm 3</text>
<text text-anchor="middle" x="46385.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="46385.5" y="-246.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer2_residual2&#45;&gt;layer3_ln1 -->
<g id="edge377" class="edge">
<title>layer2_residual2&#45;&gt;layer3_ln1</title>
<path fill="none" stroke="black" d="M46385.5,-372.74C46385.5,-352.66 46385.5,-324.54 46385.5,-302.28"/>
<polygon fill="black" stroke="black" points="46389,-302.2 46385.5,-292.2 46382,-302.2 46389,-302.2"/>
</g>
<!-- layer2_concat_dim_0 -->
<g id="node197" class="node">
<title>layer2_concat_dim_0</title>
<path fill="lightpink" stroke="black" d="M38697.5,-441C38697.5,-441 38575.5,-441 38575.5,-441 38569.5,-441 38563.5,-435 38563.5,-429 38563.5,-429 38563.5,-370 38563.5,-370 38563.5,-364 38569.5,-358 38575.5,-358 38575.5,-358 38697.5,-358 38697.5,-358 38703.5,-358 38709.5,-364 38709.5,-370 38709.5,-370 38709.5,-429 38709.5,-429 38709.5,-435 38703.5,-441 38697.5,-441"/>
<text text-anchor="middle" x="38636.5" y="-425.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="38636.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="38636.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 2048]</text>
<text text-anchor="middle" x="38636.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;3</text>
<text text-anchor="middle" x="38636.5" y="-365.8" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer2_attn_0_0&#45;&gt;layer2_concat_dim_0 -->
<g id="edge308" class="edge">
<title>layer2_attn_0_0&#45;&gt;layer2_concat_dim_0</title>
<path fill="none" stroke="black" d="M38528.02,-399.5C38536.35,-399.5 38544.69,-399.5 38553.02,-399.5"/>
<polygon fill="black" stroke="black" points="38553.19,-403 38563.19,-399.5 38553.19,-396 38553.19,-403"/>
</g>
<!-- layer2_attn_0_1&#45;&gt;layer2_concat_dim_0 -->
<g id="edge309" class="edge">
<title>layer2_attn_0_1&#45;&gt;layer2_concat_dim_0</title>
<path fill="none" stroke="black" d="M37554.72,-433.57C37575.99,-446.59 37601.93,-459.89 37627.5,-466.5 37724.32,-491.52 38431.27,-493.71 38527.5,-466.5 38543.17,-462.07 38558.79,-454.69 38573.12,-446.4"/>
<polygon fill="black" stroke="black" points="38575.1,-449.3 38581.87,-441.14 38571.49,-443.3 38575.1,-449.3"/>
</g>
<!-- layer2_attn_0_2&#45;&gt;layer2_concat_dim_0 -->
<g id="edge310" class="edge">
<title>layer2_attn_0_2&#45;&gt;layer2_concat_dim_0</title>
<path fill="none" stroke="black" d="M36636.72,-433.57C36657.99,-446.59 36683.93,-459.89 36709.5,-466.5 36807.29,-491.77 38430.31,-493.98 38527.5,-466.5 38543.17,-462.07 38558.79,-454.69 38573.12,-446.4"/>
<polygon fill="black" stroke="black" points="38575.1,-449.3 38581.87,-441.14 38571.49,-443.3 38575.1,-449.3"/>
</g>
<!-- layer2_attn_0_3&#45;&gt;layer2_concat_dim_0 -->
<g id="edge311" class="edge">
<title>layer2_attn_0_3&#45;&gt;layer2_concat_dim_0</title>
<path fill="none" stroke="black" d="M35718.72,-433.57C35739.99,-446.59 35765.93,-459.89 35791.5,-466.5 35865.08,-485.51 38454.37,-487.18 38527.5,-466.5 38543.17,-462.07 38558.79,-454.69 38573.12,-446.4"/>
<polygon fill="black" stroke="black" points="38575.1,-449.3 38581.87,-441.14 38571.49,-443.3 38575.1,-449.3"/>
</g>
<!-- layer2_concat_dim_1 -->
<g id="node198" class="node">
<title>layer2_concat_dim_1</title>
<path fill="lightpink" stroke="black" d="M34843.5,-441C34843.5,-441 34721.5,-441 34721.5,-441 34715.5,-441 34709.5,-435 34709.5,-429 34709.5,-429 34709.5,-370 34709.5,-370 34709.5,-364 34715.5,-358 34721.5,-358 34721.5,-358 34843.5,-358 34843.5,-358 34849.5,-358 34855.5,-364 34855.5,-370 34855.5,-370 34855.5,-429 34855.5,-429 34855.5,-435 34849.5,-441 34843.5,-441"/>
<text text-anchor="middle" x="34782.5" y="-425.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="34782.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="34782.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 2048]</text>
<text text-anchor="middle" x="34782.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPUs 4&#45;7</text>
<text text-anchor="middle" x="34782.5" y="-365.8" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer2_attn_1_0&#45;&gt;layer2_concat_dim_1 -->
<g id="edge312" class="edge">
<title>layer2_attn_1_0&#45;&gt;layer2_concat_dim_1</title>
<path fill="none" stroke="black" d="M34674.02,-399.5C34682.35,-399.5 34690.69,-399.5 34699.02,-399.5"/>
<polygon fill="black" stroke="black" points="34699.19,-403 34709.19,-399.5 34699.19,-396 34699.19,-403"/>
</g>
<!-- layer2_attn_1_1&#45;&gt;layer2_concat_dim_1 -->
<g id="edge313" class="edge">
<title>layer2_attn_1_1&#45;&gt;layer2_concat_dim_1</title>
<path fill="none" stroke="black" d="M33700.72,-433.57C33721.99,-446.59 33747.93,-459.89 33773.5,-466.5 33870.32,-491.52 34577.27,-493.71 34673.5,-466.5 34689.17,-462.07 34704.79,-454.69 34719.12,-446.4"/>
<polygon fill="black" stroke="black" points="34721.1,-449.3 34727.87,-441.14 34717.49,-443.3 34721.1,-449.3"/>
</g>
<!-- layer2_attn_1_2&#45;&gt;layer2_concat_dim_1 -->
<g id="edge314" class="edge">
<title>layer2_attn_1_2&#45;&gt;layer2_concat_dim_1</title>
<path fill="none" stroke="black" d="M32782.72,-433.57C32803.99,-446.59 32829.93,-459.89 32855.5,-466.5 32953.29,-491.77 34576.31,-493.98 34673.5,-466.5 34689.17,-462.07 34704.79,-454.69 34719.12,-446.4"/>
<polygon fill="black" stroke="black" points="34721.1,-449.3 34727.87,-441.14 34717.49,-443.3 34721.1,-449.3"/>
</g>
<!-- layer2_attn_1_3&#45;&gt;layer2_concat_dim_1 -->
<g id="edge315" class="edge">
<title>layer2_attn_1_3&#45;&gt;layer2_concat_dim_1</title>
<path fill="none" stroke="black" d="M31864.72,-433.57C31885.99,-446.59 31911.93,-459.89 31937.5,-466.5 32011.08,-485.51 34600.37,-487.18 34673.5,-466.5 34689.17,-462.07 34704.79,-454.69 34719.12,-446.4"/>
<polygon fill="black" stroke="black" points="34721.1,-449.3 34727.87,-441.14 34717.49,-443.3 34721.1,-449.3"/>
</g>
<!-- layer2_concat_dim_2 -->
<g id="node199" class="node">
<title>layer2_concat_dim_2</title>
<path fill="lightpink" stroke="black" d="M30989.5,-441C30989.5,-441 30867.5,-441 30867.5,-441 30861.5,-441 30855.5,-435 30855.5,-429 30855.5,-429 30855.5,-370 30855.5,-370 30855.5,-364 30861.5,-358 30867.5,-358 30867.5,-358 30989.5,-358 30989.5,-358 30995.5,-358 31001.5,-364 31001.5,-370 31001.5,-370 31001.5,-429 31001.5,-429 31001.5,-435 30995.5,-441 30989.5,-441"/>
<text text-anchor="middle" x="30928.5" y="-425.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="30928.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="30928.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 2048]</text>
<text text-anchor="middle" x="30928.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;11</text>
<text text-anchor="middle" x="30928.5" y="-365.8" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer2_attn_2_0&#45;&gt;layer2_concat_dim_2 -->
<g id="edge316" class="edge">
<title>layer2_attn_2_0&#45;&gt;layer2_concat_dim_2</title>
<path fill="none" stroke="black" d="M30820.02,-399.5C30828.35,-399.5 30836.69,-399.5 30845.02,-399.5"/>
<polygon fill="black" stroke="black" points="30845.19,-403 30855.19,-399.5 30845.19,-396 30845.19,-403"/>
</g>
<!-- layer2_attn_2_1&#45;&gt;layer2_concat_dim_2 -->
<g id="edge317" class="edge">
<title>layer2_attn_2_1&#45;&gt;layer2_concat_dim_2</title>
<path fill="none" stroke="black" d="M29846.72,-433.57C29867.99,-446.59 29893.93,-459.89 29919.5,-466.5 30016.32,-491.52 30723.27,-493.71 30819.5,-466.5 30835.17,-462.07 30850.79,-454.69 30865.12,-446.4"/>
<polygon fill="black" stroke="black" points="30867.1,-449.3 30873.87,-441.14 30863.49,-443.3 30867.1,-449.3"/>
</g>
<!-- layer2_attn_2_2&#45;&gt;layer2_concat_dim_2 -->
<g id="edge318" class="edge">
<title>layer2_attn_2_2&#45;&gt;layer2_concat_dim_2</title>
<path fill="none" stroke="black" d="M28928.72,-433.57C28949.99,-446.59 28975.93,-459.89 29001.5,-466.5 29099.29,-491.77 30722.31,-493.98 30819.5,-466.5 30835.17,-462.07 30850.79,-454.69 30865.12,-446.4"/>
<polygon fill="black" stroke="black" points="30867.1,-449.3 30873.87,-441.14 30863.49,-443.3 30867.1,-449.3"/>
</g>
<!-- layer2_attn_2_3&#45;&gt;layer2_concat_dim_2 -->
<g id="edge319" class="edge">
<title>layer2_attn_2_3&#45;&gt;layer2_concat_dim_2</title>
<path fill="none" stroke="black" d="M28010.72,-433.57C28031.99,-446.59 28057.93,-459.89 28083.5,-466.5 28157.08,-485.51 30746.37,-487.18 30819.5,-466.5 30835.17,-462.07 30850.79,-454.69 30865.12,-446.4"/>
<polygon fill="black" stroke="black" points="30867.1,-449.3 30873.87,-441.14 30863.49,-443.3 30867.1,-449.3"/>
</g>
<!-- layer2_concat_dim_3 -->
<g id="node200" class="node">
<title>layer2_concat_dim_3</title>
<path fill="lightpink" stroke="black" d="M27135.5,-441C27135.5,-441 27013.5,-441 27013.5,-441 27007.5,-441 27001.5,-435 27001.5,-429 27001.5,-429 27001.5,-370 27001.5,-370 27001.5,-364 27007.5,-358 27013.5,-358 27013.5,-358 27135.5,-358 27135.5,-358 27141.5,-358 27147.5,-364 27147.5,-370 27147.5,-370 27147.5,-429 27147.5,-429 27147.5,-435 27141.5,-441 27135.5,-441"/>
<text text-anchor="middle" x="27074.5" y="-425.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="27074.5" y="-410.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="27074.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 2048]</text>
<text text-anchor="middle" x="27074.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPUs 12&#45;15</text>
<text text-anchor="middle" x="27074.5" y="-365.8" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer2_attn_3_0&#45;&gt;layer2_concat_dim_3 -->
<g id="edge320" class="edge">
<title>layer2_attn_3_0&#45;&gt;layer2_concat_dim_3</title>
<path fill="none" stroke="black" d="M26966.02,-399.5C26974.35,-399.5 26982.69,-399.5 26991.02,-399.5"/>
<polygon fill="black" stroke="black" points="26991.19,-403 27001.19,-399.5 26991.19,-396 26991.19,-403"/>
</g>
<!-- layer2_attn_3_1&#45;&gt;layer2_concat_dim_3 -->
<g id="edge321" class="edge">
<title>layer2_attn_3_1&#45;&gt;layer2_concat_dim_3</title>
<path fill="none" stroke="black" d="M25992.72,-433.57C26013.99,-446.59 26039.93,-459.89 26065.5,-466.5 26162.32,-491.52 26869.27,-493.71 26965.5,-466.5 26981.17,-462.07 26996.79,-454.69 27011.12,-446.4"/>
<polygon fill="black" stroke="black" points="27013.1,-449.3 27019.87,-441.14 27009.49,-443.3 27013.1,-449.3"/>
</g>
<!-- layer2_attn_3_2&#45;&gt;layer2_concat_dim_3 -->
<g id="edge322" class="edge">
<title>layer2_attn_3_2&#45;&gt;layer2_concat_dim_3</title>
<path fill="none" stroke="black" d="M25074.72,-433.57C25095.99,-446.59 25121.93,-459.89 25147.5,-466.5 25245.29,-491.77 26868.31,-493.98 26965.5,-466.5 26981.17,-462.07 26996.79,-454.69 27011.12,-446.4"/>
<polygon fill="black" stroke="black" points="27013.1,-449.3 27019.87,-441.14 27009.49,-443.3 27013.1,-449.3"/>
</g>
<!-- layer2_attn_3_3&#45;&gt;layer2_concat_dim_3 -->
<g id="edge323" class="edge">
<title>layer2_attn_3_3&#45;&gt;layer2_concat_dim_3</title>
<path fill="none" stroke="black" d="M24156.72,-433.57C24177.99,-446.59 24203.93,-459.89 24229.5,-466.5 24303.08,-485.51 26892.37,-487.18 26965.5,-466.5 26981.17,-462.07 26996.79,-454.69 27011.12,-446.4"/>
<polygon fill="black" stroke="black" points="27013.1,-449.3 27019.87,-441.14 27009.49,-443.3 27013.1,-449.3"/>
</g>
<!-- layer2_concat_heads -->
<g id="node201" class="node">
<title>layer2_concat_heads</title>
<path fill="lightpink" stroke="black" d="M38897.5,-433.5C38897.5,-433.5 38757.5,-433.5 38757.5,-433.5 38751.5,-433.5 38745.5,-427.5 38745.5,-421.5 38745.5,-421.5 38745.5,-377.5 38745.5,-377.5 38745.5,-371.5 38751.5,-365.5 38757.5,-365.5 38757.5,-365.5 38897.5,-365.5 38897.5,-365.5 38903.5,-365.5 38909.5,-371.5 38909.5,-377.5 38909.5,-377.5 38909.5,-421.5 38909.5,-421.5 38909.5,-427.5 38903.5,-433.5 38897.5,-433.5"/>
<text text-anchor="middle" x="38827.5" y="-418.3" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="38827.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="38827.5" y="-388.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="38827.5" y="-373.3" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer2_concat_dim_0&#45;&gt;layer2_concat_heads -->
<g id="edge324" class="edge">
<title>layer2_concat_dim_0&#45;&gt;layer2_concat_heads</title>
<path fill="none" stroke="black" d="M38709.62,-399.5C38718.02,-399.5 38726.42,-399.5 38734.82,-399.5"/>
<polygon fill="black" stroke="black" points="38735.07,-403 38745.07,-399.5 38735.07,-396 38735.07,-403"/>
</g>
<!-- layer2_concat_dim_1&#45;&gt;layer2_concat_heads -->
<g id="edge325" class="edge">
<title>layer2_concat_dim_1&#45;&gt;layer2_concat_heads</title>
<path fill="none" stroke="black" d="M34827.44,-441.23C34841.22,-451.51 34857.1,-461.11 34873.5,-466.5 34974.74,-499.75 38606.48,-493.71 38709.5,-466.5 38731.13,-460.79 38752.95,-450.09 38771.84,-438.9"/>
<polygon fill="black" stroke="black" points="38773.87,-441.76 38780.58,-433.56 38770.23,-435.79 38773.87,-441.76"/>
</g>
<!-- layer2_concat_dim_2&#45;&gt;layer2_concat_heads -->
<g id="edge326" class="edge">
<title>layer2_concat_dim_2&#45;&gt;layer2_concat_heads</title>
<path fill="none" stroke="black" d="M30973.44,-441.23C30987.22,-451.51 31003.1,-461.11 31019.5,-466.5 31120.97,-499.83 38606.23,-493.77 38709.5,-466.5 38731.13,-460.79 38752.95,-450.09 38771.84,-438.9"/>
<polygon fill="black" stroke="black" points="38773.87,-441.76 38780.58,-433.56 38770.23,-435.79 38773.87,-441.76"/>
</g>
<!-- layer2_concat_dim_3&#45;&gt;layer2_concat_heads -->
<g id="edge327" class="edge">
<title>layer2_concat_dim_3&#45;&gt;layer2_concat_heads</title>
<path fill="none" stroke="black" d="M27119.44,-441.23C27133.22,-451.51 27149.1,-461.11 27165.5,-466.5 27241.66,-491.51 38631.99,-486.97 38709.5,-466.5 38731.13,-460.79 38752.95,-450.09 38771.84,-438.9"/>
<polygon fill="black" stroke="black" points="38773.87,-441.76 38780.58,-433.56 38770.23,-435.79 38773.87,-441.76"/>
</g>
<!-- layer2_concat_heads&#45;&gt;layer2_out_proj -->
<g id="edge328" class="edge">
<title>layer2_concat_heads&#45;&gt;layer2_out_proj</title>
<path fill="none" stroke="black" d="M38909.51,-399.5C38918.1,-399.5 38926.69,-399.5 38935.28,-399.5"/>
<polygon fill="black" stroke="black" points="38935.37,-403 38945.37,-399.5 38935.37,-396 38935.37,-403"/>
</g>
<!-- layer2_expert_0_act -->
<g id="node203" class="node">
<title>layer2_expert_0_act</title>
<path fill="lightyellow" stroke="black" d="M45768,-426C45768,-426 45667,-426 45667,-426 45661,-426 45655,-420 45655,-414 45655,-414 45655,-385 45655,-385 45655,-379 45661,-373 45667,-373 45667,-373 45768,-373 45768,-373 45774,-373 45780,-379 45780,-385 45780,-385 45780,-414 45780,-414 45780,-420 45774,-426 45768,-426"/>
<text text-anchor="middle" x="45717.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="45717.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="45717.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_expert_0_up&#45;&gt;layer2_expert_0_act -->
<g id="edge330" class="edge">
<title>layer2_expert_0_up&#45;&gt;layer2_expert_0_act</title>
<path fill="none" stroke="black" d="M45619.72,-399.5C45628.05,-399.5 45636.37,-399.5 45644.7,-399.5"/>
<polygon fill="black" stroke="black" points="45644.86,-403 45654.86,-399.5 45644.86,-396 45644.86,-403"/>
</g>
<!-- layer2_expert_0_down -->
<g id="node204" class="node">
<title>layer2_expert_0_down</title>
<path fill="lightcoral" stroke="black" d="M45927.5,-433.5C45927.5,-433.5 45827.5,-433.5 45827.5,-433.5 45821.5,-433.5 45815.5,-427.5 45815.5,-421.5 45815.5,-421.5 45815.5,-377.5 45815.5,-377.5 45815.5,-371.5 45821.5,-365.5 45827.5,-365.5 45827.5,-365.5 45927.5,-365.5 45927.5,-365.5 45933.5,-365.5 45939.5,-371.5 45939.5,-377.5 45939.5,-377.5 45939.5,-421.5 45939.5,-421.5 45939.5,-427.5 45933.5,-433.5 45927.5,-433.5"/>
<text text-anchor="middle" x="45877.5" y="-418.3" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="45877.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="45877.5" y="-388.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="45877.5" y="-373.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer2_expert_0_act&#45;&gt;layer2_expert_0_down -->
<g id="edge331" class="edge">
<title>layer2_expert_0_act&#45;&gt;layer2_expert_0_down</title>
<path fill="none" stroke="black" d="M45780,-399.5C45788.39,-399.5 45796.79,-399.5 45805.18,-399.5"/>
<polygon fill="black" stroke="black" points="45805.42,-403 45815.42,-399.5 45805.42,-396 45805.42,-403"/>
</g>
<!-- layer2_expert_0_out -->
<g id="node205" class="node">
<title>layer2_expert_0_out</title>
<path fill="lightpink" stroke="black" d="M46097.5,-426C46097.5,-426 45987.5,-426 45987.5,-426 45981.5,-426 45975.5,-420 45975.5,-414 45975.5,-414 45975.5,-385 45975.5,-385 45975.5,-379 45981.5,-373 45987.5,-373 45987.5,-373 46097.5,-373 46097.5,-373 46103.5,-373 46109.5,-379 46109.5,-385 46109.5,-385 46109.5,-414 46109.5,-414 46109.5,-420 46103.5,-426 46097.5,-426"/>
<text text-anchor="middle" x="46042.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 0 Output</text>
<text text-anchor="middle" x="46042.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="46042.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer2_expert_0_down&#45;&gt;layer2_expert_0_out -->
<g id="edge332" class="edge">
<title>layer2_expert_0_down&#45;&gt;layer2_expert_0_out</title>
<path fill="none" stroke="black" d="M45939.7,-399.5C45948.26,-399.5 45956.82,-399.5 45965.39,-399.5"/>
<polygon fill="black" stroke="black" points="45965.44,-403 45975.44,-399.5 45965.44,-396 45965.44,-403"/>
</g>
<!-- layer2_expert_0_out&#45;&gt;layer2_moe_agg -->
<g id="edge369" class="edge">
<title>layer2_expert_0_out&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M46109.79,-399.5C46118.19,-399.5 46126.58,-399.5 46134.98,-399.5"/>
<polygon fill="black" stroke="black" points="46135.22,-403 46145.22,-399.5 46135.22,-396 46135.22,-403"/>
</g>
<!-- layer2_expert_1_act -->
<g id="node207" class="node">
<title>layer2_expert_1_act</title>
<path fill="lightyellow" stroke="black" d="M44967,-426C44967,-426 44866,-426 44866,-426 44860,-426 44854,-420 44854,-414 44854,-414 44854,-385 44854,-385 44854,-379 44860,-373 44866,-373 44866,-373 44967,-373 44967,-373 44973,-373 44979,-379 44979,-385 44979,-385 44979,-414 44979,-414 44979,-420 44973,-426 44967,-426"/>
<text text-anchor="middle" x="44916.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="44916.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="44916.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_expert_1_up&#45;&gt;layer2_expert_1_act -->
<g id="edge335" class="edge">
<title>layer2_expert_1_up&#45;&gt;layer2_expert_1_act</title>
<path fill="none" stroke="black" d="M44818.72,-399.5C44827.05,-399.5 44835.37,-399.5 44843.7,-399.5"/>
<polygon fill="black" stroke="black" points="44843.86,-403 44853.86,-399.5 44843.86,-396 44843.86,-403"/>
</g>
<!-- layer2_expert_1_down -->
<g id="node208" class="node">
<title>layer2_expert_1_down</title>
<path fill="lightcoral" stroke="black" d="M45126.5,-433.5C45126.5,-433.5 45026.5,-433.5 45026.5,-433.5 45020.5,-433.5 45014.5,-427.5 45014.5,-421.5 45014.5,-421.5 45014.5,-377.5 45014.5,-377.5 45014.5,-371.5 45020.5,-365.5 45026.5,-365.5 45026.5,-365.5 45126.5,-365.5 45126.5,-365.5 45132.5,-365.5 45138.5,-371.5 45138.5,-377.5 45138.5,-377.5 45138.5,-421.5 45138.5,-421.5 45138.5,-427.5 45132.5,-433.5 45126.5,-433.5"/>
<text text-anchor="middle" x="45076.5" y="-418.3" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="45076.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="45076.5" y="-388.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="45076.5" y="-373.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer2_expert_1_act&#45;&gt;layer2_expert_1_down -->
<g id="edge336" class="edge">
<title>layer2_expert_1_act&#45;&gt;layer2_expert_1_down</title>
<path fill="none" stroke="black" d="M44979,-399.5C44987.39,-399.5 44995.79,-399.5 45004.18,-399.5"/>
<polygon fill="black" stroke="black" points="45004.42,-403 45014.42,-399.5 45004.42,-396 45004.42,-403"/>
</g>
<!-- layer2_expert_1_out -->
<g id="node209" class="node">
<title>layer2_expert_1_out</title>
<path fill="lightpink" stroke="black" d="M45296.5,-426C45296.5,-426 45186.5,-426 45186.5,-426 45180.5,-426 45174.5,-420 45174.5,-414 45174.5,-414 45174.5,-385 45174.5,-385 45174.5,-379 45180.5,-373 45186.5,-373 45186.5,-373 45296.5,-373 45296.5,-373 45302.5,-373 45308.5,-379 45308.5,-385 45308.5,-385 45308.5,-414 45308.5,-414 45308.5,-420 45302.5,-426 45296.5,-426"/>
<text text-anchor="middle" x="45241.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 1 Output</text>
<text text-anchor="middle" x="45241.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="45241.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer2_expert_1_down&#45;&gt;layer2_expert_1_out -->
<g id="edge337" class="edge">
<title>layer2_expert_1_down&#45;&gt;layer2_expert_1_out</title>
<path fill="none" stroke="black" d="M45138.7,-399.5C45147.26,-399.5 45155.82,-399.5 45164.39,-399.5"/>
<polygon fill="black" stroke="black" points="45164.44,-403 45174.44,-399.5 45164.44,-396 45164.44,-403"/>
</g>
<!-- layer2_expert_1_out&#45;&gt;layer2_moe_agg -->
<g id="edge370" class="edge">
<title>layer2_expert_1_out&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M45265.87,-426.05C45281.53,-441.08 45303.24,-458.44 45326.5,-466.5 45408.7,-495 46025.88,-490.52 46109.5,-466.5 46124.94,-462.07 46140.31,-454.68 46154.38,-446.39"/>
<polygon fill="black" stroke="black" points="46156.26,-449.34 46162.97,-441.14 46152.61,-443.37 46156.26,-449.34"/>
</g>
<!-- layer2_expert_2_act -->
<g id="node211" class="node">
<title>layer2_expert_2_act</title>
<path fill="lightyellow" stroke="black" d="M44166,-426C44166,-426 44065,-426 44065,-426 44059,-426 44053,-420 44053,-414 44053,-414 44053,-385 44053,-385 44053,-379 44059,-373 44065,-373 44065,-373 44166,-373 44166,-373 44172,-373 44178,-379 44178,-385 44178,-385 44178,-414 44178,-414 44178,-420 44172,-426 44166,-426"/>
<text text-anchor="middle" x="44115.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="44115.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="44115.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_expert_2_up&#45;&gt;layer2_expert_2_act -->
<g id="edge340" class="edge">
<title>layer2_expert_2_up&#45;&gt;layer2_expert_2_act</title>
<path fill="none" stroke="black" d="M44017.72,-399.5C44026.05,-399.5 44034.37,-399.5 44042.7,-399.5"/>
<polygon fill="black" stroke="black" points="44042.86,-403 44052.86,-399.5 44042.86,-396 44042.86,-403"/>
</g>
<!-- layer2_expert_2_down -->
<g id="node212" class="node">
<title>layer2_expert_2_down</title>
<path fill="lightcoral" stroke="black" d="M44325.5,-433.5C44325.5,-433.5 44225.5,-433.5 44225.5,-433.5 44219.5,-433.5 44213.5,-427.5 44213.5,-421.5 44213.5,-421.5 44213.5,-377.5 44213.5,-377.5 44213.5,-371.5 44219.5,-365.5 44225.5,-365.5 44225.5,-365.5 44325.5,-365.5 44325.5,-365.5 44331.5,-365.5 44337.5,-371.5 44337.5,-377.5 44337.5,-377.5 44337.5,-421.5 44337.5,-421.5 44337.5,-427.5 44331.5,-433.5 44325.5,-433.5"/>
<text text-anchor="middle" x="44275.5" y="-418.3" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="44275.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="44275.5" y="-388.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="44275.5" y="-373.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer2_expert_2_act&#45;&gt;layer2_expert_2_down -->
<g id="edge341" class="edge">
<title>layer2_expert_2_act&#45;&gt;layer2_expert_2_down</title>
<path fill="none" stroke="black" d="M44178,-399.5C44186.39,-399.5 44194.79,-399.5 44203.18,-399.5"/>
<polygon fill="black" stroke="black" points="44203.42,-403 44213.42,-399.5 44203.42,-396 44203.42,-403"/>
</g>
<!-- layer2_expert_2_out -->
<g id="node213" class="node">
<title>layer2_expert_2_out</title>
<path fill="lightpink" stroke="black" d="M44495.5,-426C44495.5,-426 44385.5,-426 44385.5,-426 44379.5,-426 44373.5,-420 44373.5,-414 44373.5,-414 44373.5,-385 44373.5,-385 44373.5,-379 44379.5,-373 44385.5,-373 44385.5,-373 44495.5,-373 44495.5,-373 44501.5,-373 44507.5,-379 44507.5,-385 44507.5,-385 44507.5,-414 44507.5,-414 44507.5,-420 44501.5,-426 44495.5,-426"/>
<text text-anchor="middle" x="44440.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 2 Output</text>
<text text-anchor="middle" x="44440.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="44440.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_expert_2_down&#45;&gt;layer2_expert_2_out -->
<g id="edge342" class="edge">
<title>layer2_expert_2_down&#45;&gt;layer2_expert_2_out</title>
<path fill="none" stroke="black" d="M44337.7,-399.5C44346.26,-399.5 44354.82,-399.5 44363.39,-399.5"/>
<polygon fill="black" stroke="black" points="44363.44,-403 44373.44,-399.5 44363.44,-396 44363.44,-403"/>
</g>
<!-- layer2_expert_2_out&#45;&gt;layer2_moe_agg -->
<g id="edge371" class="edge">
<title>layer2_expert_2_out&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M44464.87,-426.05C44480.53,-441.08 44502.24,-458.44 44525.5,-466.5 44608.64,-495.33 46024.92,-490.8 46109.5,-466.5 46124.94,-462.07 46140.31,-454.68 46154.38,-446.39"/>
<polygon fill="black" stroke="black" points="46156.26,-449.34 46162.97,-441.14 46152.61,-443.37 46156.26,-449.34"/>
</g>
<!-- layer2_expert_3_act -->
<g id="node215" class="node">
<title>layer2_expert_3_act</title>
<path fill="lightyellow" stroke="black" d="M43365,-426C43365,-426 43264,-426 43264,-426 43258,-426 43252,-420 43252,-414 43252,-414 43252,-385 43252,-385 43252,-379 43258,-373 43264,-373 43264,-373 43365,-373 43365,-373 43371,-373 43377,-379 43377,-385 43377,-385 43377,-414 43377,-414 43377,-420 43371,-426 43365,-426"/>
<text text-anchor="middle" x="43314.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="43314.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="43314.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_expert_3_up&#45;&gt;layer2_expert_3_act -->
<g id="edge345" class="edge">
<title>layer2_expert_3_up&#45;&gt;layer2_expert_3_act</title>
<path fill="none" stroke="black" d="M43216.72,-399.5C43225.05,-399.5 43233.37,-399.5 43241.7,-399.5"/>
<polygon fill="black" stroke="black" points="43241.86,-403 43251.86,-399.5 43241.86,-396 43241.86,-403"/>
</g>
<!-- layer2_expert_3_down -->
<g id="node216" class="node">
<title>layer2_expert_3_down</title>
<path fill="lightcoral" stroke="black" d="M43524.5,-433.5C43524.5,-433.5 43424.5,-433.5 43424.5,-433.5 43418.5,-433.5 43412.5,-427.5 43412.5,-421.5 43412.5,-421.5 43412.5,-377.5 43412.5,-377.5 43412.5,-371.5 43418.5,-365.5 43424.5,-365.5 43424.5,-365.5 43524.5,-365.5 43524.5,-365.5 43530.5,-365.5 43536.5,-371.5 43536.5,-377.5 43536.5,-377.5 43536.5,-421.5 43536.5,-421.5 43536.5,-427.5 43530.5,-433.5 43524.5,-433.5"/>
<text text-anchor="middle" x="43474.5" y="-418.3" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="43474.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="43474.5" y="-388.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="43474.5" y="-373.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer2_expert_3_act&#45;&gt;layer2_expert_3_down -->
<g id="edge346" class="edge">
<title>layer2_expert_3_act&#45;&gt;layer2_expert_3_down</title>
<path fill="none" stroke="black" d="M43377,-399.5C43385.39,-399.5 43393.79,-399.5 43402.18,-399.5"/>
<polygon fill="black" stroke="black" points="43402.42,-403 43412.42,-399.5 43402.42,-396 43402.42,-403"/>
</g>
<!-- layer2_expert_3_out -->
<g id="node217" class="node">
<title>layer2_expert_3_out</title>
<path fill="lightpink" stroke="black" d="M43694.5,-426C43694.5,-426 43584.5,-426 43584.5,-426 43578.5,-426 43572.5,-420 43572.5,-414 43572.5,-414 43572.5,-385 43572.5,-385 43572.5,-379 43578.5,-373 43584.5,-373 43584.5,-373 43694.5,-373 43694.5,-373 43700.5,-373 43706.5,-379 43706.5,-385 43706.5,-385 43706.5,-414 43706.5,-414 43706.5,-420 43700.5,-426 43694.5,-426"/>
<text text-anchor="middle" x="43639.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 3 Output</text>
<text text-anchor="middle" x="43639.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="43639.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_expert_3_down&#45;&gt;layer2_expert_3_out -->
<g id="edge347" class="edge">
<title>layer2_expert_3_down&#45;&gt;layer2_expert_3_out</title>
<path fill="none" stroke="black" d="M43536.7,-399.5C43545.26,-399.5 43553.82,-399.5 43562.39,-399.5"/>
<polygon fill="black" stroke="black" points="43562.44,-403 43572.44,-399.5 43562.44,-396 43562.44,-403"/>
</g>
<!-- layer2_expert_3_out&#45;&gt;layer2_moe_agg -->
<g id="edge372" class="edge">
<title>layer2_expert_3_out&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M43663.87,-426.05C43679.53,-441.08 43701.24,-458.44 43724.5,-466.5 43787.09,-488.2 46045.82,-484.79 46109.5,-466.5 46124.94,-462.07 46140.31,-454.68 46154.38,-446.39"/>
<polygon fill="black" stroke="black" points="46156.26,-449.34 46162.97,-441.14 46152.61,-443.37 46156.26,-449.34"/>
</g>
<!-- layer2_expert_4_act -->
<g id="node219" class="node">
<title>layer2_expert_4_act</title>
<path fill="lightyellow" stroke="black" d="M42564,-426C42564,-426 42463,-426 42463,-426 42457,-426 42451,-420 42451,-414 42451,-414 42451,-385 42451,-385 42451,-379 42457,-373 42463,-373 42463,-373 42564,-373 42564,-373 42570,-373 42576,-379 42576,-385 42576,-385 42576,-414 42576,-414 42576,-420 42570,-426 42564,-426"/>
<text text-anchor="middle" x="42513.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="42513.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="42513.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_expert_4_up&#45;&gt;layer2_expert_4_act -->
<g id="edge350" class="edge">
<title>layer2_expert_4_up&#45;&gt;layer2_expert_4_act</title>
<path fill="none" stroke="black" d="M42415.72,-399.5C42424.05,-399.5 42432.37,-399.5 42440.7,-399.5"/>
<polygon fill="black" stroke="black" points="42440.86,-403 42450.86,-399.5 42440.86,-396 42440.86,-403"/>
</g>
<!-- layer2_expert_4_down -->
<g id="node220" class="node">
<title>layer2_expert_4_down</title>
<path fill="lightcoral" stroke="black" d="M42723.5,-433.5C42723.5,-433.5 42623.5,-433.5 42623.5,-433.5 42617.5,-433.5 42611.5,-427.5 42611.5,-421.5 42611.5,-421.5 42611.5,-377.5 42611.5,-377.5 42611.5,-371.5 42617.5,-365.5 42623.5,-365.5 42623.5,-365.5 42723.5,-365.5 42723.5,-365.5 42729.5,-365.5 42735.5,-371.5 42735.5,-377.5 42735.5,-377.5 42735.5,-421.5 42735.5,-421.5 42735.5,-427.5 42729.5,-433.5 42723.5,-433.5"/>
<text text-anchor="middle" x="42673.5" y="-418.3" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="42673.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="42673.5" y="-388.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="42673.5" y="-373.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer2_expert_4_act&#45;&gt;layer2_expert_4_down -->
<g id="edge351" class="edge">
<title>layer2_expert_4_act&#45;&gt;layer2_expert_4_down</title>
<path fill="none" stroke="black" d="M42576,-399.5C42584.39,-399.5 42592.79,-399.5 42601.18,-399.5"/>
<polygon fill="black" stroke="black" points="42601.42,-403 42611.42,-399.5 42601.42,-396 42601.42,-403"/>
</g>
<!-- layer2_expert_4_out -->
<g id="node221" class="node">
<title>layer2_expert_4_out</title>
<path fill="lightpink" stroke="black" d="M42893.5,-426C42893.5,-426 42783.5,-426 42783.5,-426 42777.5,-426 42771.5,-420 42771.5,-414 42771.5,-414 42771.5,-385 42771.5,-385 42771.5,-379 42777.5,-373 42783.5,-373 42783.5,-373 42893.5,-373 42893.5,-373 42899.5,-373 42905.5,-379 42905.5,-385 42905.5,-385 42905.5,-414 42905.5,-414 42905.5,-420 42899.5,-426 42893.5,-426"/>
<text text-anchor="middle" x="42838.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 4 Output</text>
<text text-anchor="middle" x="42838.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="42838.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer2_expert_4_down&#45;&gt;layer2_expert_4_out -->
<g id="edge352" class="edge">
<title>layer2_expert_4_down&#45;&gt;layer2_expert_4_out</title>
<path fill="none" stroke="black" d="M42735.7,-399.5C42744.26,-399.5 42752.82,-399.5 42761.39,-399.5"/>
<polygon fill="black" stroke="black" points="42761.44,-403 42771.44,-399.5 42761.44,-396 42761.44,-403"/>
</g>
<!-- layer2_expert_4_out&#45;&gt;layer2_moe_agg -->
<g id="edge373" class="edge">
<title>layer2_expert_4_out&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M42862.87,-426.05C42878.53,-441.08 42900.24,-458.44 42923.5,-466.5 43007.12,-495.49 46024.44,-490.93 46109.5,-466.5 46124.94,-462.07 46140.31,-454.68 46154.38,-446.39"/>
<polygon fill="black" stroke="black" points="46156.26,-449.34 46162.97,-441.14 46152.61,-443.37 46156.26,-449.34"/>
</g>
<!-- layer2_expert_5_act -->
<g id="node223" class="node">
<title>layer2_expert_5_act</title>
<path fill="lightyellow" stroke="black" d="M41763,-426C41763,-426 41662,-426 41662,-426 41656,-426 41650,-420 41650,-414 41650,-414 41650,-385 41650,-385 41650,-379 41656,-373 41662,-373 41662,-373 41763,-373 41763,-373 41769,-373 41775,-379 41775,-385 41775,-385 41775,-414 41775,-414 41775,-420 41769,-426 41763,-426"/>
<text text-anchor="middle" x="41712.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="41712.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="41712.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_expert_5_up&#45;&gt;layer2_expert_5_act -->
<g id="edge355" class="edge">
<title>layer2_expert_5_up&#45;&gt;layer2_expert_5_act</title>
<path fill="none" stroke="black" d="M41614.72,-399.5C41623.05,-399.5 41631.37,-399.5 41639.7,-399.5"/>
<polygon fill="black" stroke="black" points="41639.86,-403 41649.86,-399.5 41639.86,-396 41639.86,-403"/>
</g>
<!-- layer2_expert_5_down -->
<g id="node224" class="node">
<title>layer2_expert_5_down</title>
<path fill="lightcoral" stroke="black" d="M41922.5,-433.5C41922.5,-433.5 41822.5,-433.5 41822.5,-433.5 41816.5,-433.5 41810.5,-427.5 41810.5,-421.5 41810.5,-421.5 41810.5,-377.5 41810.5,-377.5 41810.5,-371.5 41816.5,-365.5 41822.5,-365.5 41822.5,-365.5 41922.5,-365.5 41922.5,-365.5 41928.5,-365.5 41934.5,-371.5 41934.5,-377.5 41934.5,-377.5 41934.5,-421.5 41934.5,-421.5 41934.5,-427.5 41928.5,-433.5 41922.5,-433.5"/>
<text text-anchor="middle" x="41872.5" y="-418.3" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="41872.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="41872.5" y="-388.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="41872.5" y="-373.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer2_expert_5_act&#45;&gt;layer2_expert_5_down -->
<g id="edge356" class="edge">
<title>layer2_expert_5_act&#45;&gt;layer2_expert_5_down</title>
<path fill="none" stroke="black" d="M41775,-399.5C41783.39,-399.5 41791.79,-399.5 41800.18,-399.5"/>
<polygon fill="black" stroke="black" points="41800.42,-403 41810.42,-399.5 41800.42,-396 41800.42,-403"/>
</g>
<!-- layer2_expert_5_out -->
<g id="node225" class="node">
<title>layer2_expert_5_out</title>
<path fill="lightpink" stroke="black" d="M42092.5,-426C42092.5,-426 41982.5,-426 41982.5,-426 41976.5,-426 41970.5,-420 41970.5,-414 41970.5,-414 41970.5,-385 41970.5,-385 41970.5,-379 41976.5,-373 41982.5,-373 41982.5,-373 42092.5,-373 42092.5,-373 42098.5,-373 42104.5,-379 42104.5,-385 42104.5,-385 42104.5,-414 42104.5,-414 42104.5,-420 42098.5,-426 42092.5,-426"/>
<text text-anchor="middle" x="42037.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 5 Output</text>
<text text-anchor="middle" x="42037.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="42037.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer2_expert_5_down&#45;&gt;layer2_expert_5_out -->
<g id="edge357" class="edge">
<title>layer2_expert_5_down&#45;&gt;layer2_expert_5_out</title>
<path fill="none" stroke="black" d="M41934.7,-399.5C41943.26,-399.5 41951.82,-399.5 41960.39,-399.5"/>
<polygon fill="black" stroke="black" points="41960.44,-403 41970.44,-399.5 41960.44,-396 41960.44,-403"/>
</g>
<!-- layer2_expert_5_out&#45;&gt;layer2_moe_agg -->
<g id="edge374" class="edge">
<title>layer2_expert_5_out&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M42061.87,-426.05C42077.53,-441.08 42099.24,-458.44 42122.5,-466.5 42227.14,-502.78 46003.05,-497.08 46109.5,-466.5 46124.94,-462.07 46140.31,-454.68 46154.38,-446.39"/>
<polygon fill="black" stroke="black" points="46156.26,-449.34 46162.97,-441.14 46152.61,-443.37 46156.26,-449.34"/>
</g>
<!-- layer2_expert_6_act -->
<g id="node227" class="node">
<title>layer2_expert_6_act</title>
<path fill="lightyellow" stroke="black" d="M40962,-426C40962,-426 40861,-426 40861,-426 40855,-426 40849,-420 40849,-414 40849,-414 40849,-385 40849,-385 40849,-379 40855,-373 40861,-373 40861,-373 40962,-373 40962,-373 40968,-373 40974,-379 40974,-385 40974,-385 40974,-414 40974,-414 40974,-420 40968,-426 40962,-426"/>
<text text-anchor="middle" x="40911.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="40911.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="40911.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_expert_6_up&#45;&gt;layer2_expert_6_act -->
<g id="edge360" class="edge">
<title>layer2_expert_6_up&#45;&gt;layer2_expert_6_act</title>
<path fill="none" stroke="black" d="M40813.72,-399.5C40822.05,-399.5 40830.37,-399.5 40838.7,-399.5"/>
<polygon fill="black" stroke="black" points="40838.86,-403 40848.86,-399.5 40838.86,-396 40838.86,-403"/>
</g>
<!-- layer2_expert_6_down -->
<g id="node228" class="node">
<title>layer2_expert_6_down</title>
<path fill="lightcoral" stroke="black" d="M41121.5,-433.5C41121.5,-433.5 41021.5,-433.5 41021.5,-433.5 41015.5,-433.5 41009.5,-427.5 41009.5,-421.5 41009.5,-421.5 41009.5,-377.5 41009.5,-377.5 41009.5,-371.5 41015.5,-365.5 41021.5,-365.5 41021.5,-365.5 41121.5,-365.5 41121.5,-365.5 41127.5,-365.5 41133.5,-371.5 41133.5,-377.5 41133.5,-377.5 41133.5,-421.5 41133.5,-421.5 41133.5,-427.5 41127.5,-433.5 41121.5,-433.5"/>
<text text-anchor="middle" x="41071.5" y="-418.3" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="41071.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="41071.5" y="-388.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="41071.5" y="-373.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer2_expert_6_act&#45;&gt;layer2_expert_6_down -->
<g id="edge361" class="edge">
<title>layer2_expert_6_act&#45;&gt;layer2_expert_6_down</title>
<path fill="none" stroke="black" d="M40974,-399.5C40982.39,-399.5 40990.79,-399.5 40999.18,-399.5"/>
<polygon fill="black" stroke="black" points="40999.42,-403 41009.42,-399.5 40999.42,-396 40999.42,-403"/>
</g>
<!-- layer2_expert_6_out -->
<g id="node229" class="node">
<title>layer2_expert_6_out</title>
<path fill="lightpink" stroke="black" d="M41291.5,-426C41291.5,-426 41181.5,-426 41181.5,-426 41175.5,-426 41169.5,-420 41169.5,-414 41169.5,-414 41169.5,-385 41169.5,-385 41169.5,-379 41175.5,-373 41181.5,-373 41181.5,-373 41291.5,-373 41291.5,-373 41297.5,-373 41303.5,-379 41303.5,-385 41303.5,-385 41303.5,-414 41303.5,-414 41303.5,-420 41297.5,-426 41291.5,-426"/>
<text text-anchor="middle" x="41236.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 6 Output</text>
<text text-anchor="middle" x="41236.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="41236.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer2_expert_6_down&#45;&gt;layer2_expert_6_out -->
<g id="edge362" class="edge">
<title>layer2_expert_6_down&#45;&gt;layer2_expert_6_out</title>
<path fill="none" stroke="black" d="M41133.7,-399.5C41142.26,-399.5 41150.82,-399.5 41159.39,-399.5"/>
<polygon fill="black" stroke="black" points="41159.44,-403 41169.44,-399.5 41159.44,-396 41159.44,-403"/>
</g>
<!-- layer2_expert_6_out&#45;&gt;layer2_moe_agg -->
<g id="edge375" class="edge">
<title>layer2_expert_6_out&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M41260.87,-426.05C41276.53,-441.08 41298.24,-458.44 41321.5,-466.5 41384.33,-488.29 46045.58,-484.86 46109.5,-466.5 46124.94,-462.07 46140.31,-454.68 46154.38,-446.39"/>
<polygon fill="black" stroke="black" points="46156.26,-449.34 46162.97,-441.14 46152.61,-443.37 46156.26,-449.34"/>
</g>
<!-- layer2_expert_7_act -->
<g id="node231" class="node">
<title>layer2_expert_7_act</title>
<path fill="lightyellow" stroke="black" d="M40161,-426C40161,-426 40060,-426 40060,-426 40054,-426 40048,-420 40048,-414 40048,-414 40048,-385 40048,-385 40048,-379 40054,-373 40060,-373 40060,-373 40161,-373 40161,-373 40167,-373 40173,-379 40173,-385 40173,-385 40173,-414 40173,-414 40173,-420 40167,-426 40161,-426"/>
<text text-anchor="middle" x="40110.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="40110.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="40110.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_expert_7_up&#45;&gt;layer2_expert_7_act -->
<g id="edge365" class="edge">
<title>layer2_expert_7_up&#45;&gt;layer2_expert_7_act</title>
<path fill="none" stroke="black" d="M40012.72,-399.5C40021.05,-399.5 40029.37,-399.5 40037.7,-399.5"/>
<polygon fill="black" stroke="black" points="40037.86,-403 40047.86,-399.5 40037.86,-396 40037.86,-403"/>
</g>
<!-- layer2_expert_7_down -->
<g id="node232" class="node">
<title>layer2_expert_7_down</title>
<path fill="lightcoral" stroke="black" d="M40320.5,-433.5C40320.5,-433.5 40220.5,-433.5 40220.5,-433.5 40214.5,-433.5 40208.5,-427.5 40208.5,-421.5 40208.5,-421.5 40208.5,-377.5 40208.5,-377.5 40208.5,-371.5 40214.5,-365.5 40220.5,-365.5 40220.5,-365.5 40320.5,-365.5 40320.5,-365.5 40326.5,-365.5 40332.5,-371.5 40332.5,-377.5 40332.5,-377.5 40332.5,-421.5 40332.5,-421.5 40332.5,-427.5 40326.5,-433.5 40320.5,-433.5"/>
<text text-anchor="middle" x="40270.5" y="-418.3" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="40270.5" y="-403.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="40270.5" y="-388.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="40270.5" y="-373.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer2_expert_7_act&#45;&gt;layer2_expert_7_down -->
<g id="edge366" class="edge">
<title>layer2_expert_7_act&#45;&gt;layer2_expert_7_down</title>
<path fill="none" stroke="black" d="M40173,-399.5C40181.39,-399.5 40189.79,-399.5 40198.18,-399.5"/>
<polygon fill="black" stroke="black" points="40198.42,-403 40208.42,-399.5 40198.42,-396 40198.42,-403"/>
</g>
<!-- layer2_expert_7_out -->
<g id="node233" class="node">
<title>layer2_expert_7_out</title>
<path fill="lightpink" stroke="black" d="M40490.5,-426C40490.5,-426 40380.5,-426 40380.5,-426 40374.5,-426 40368.5,-420 40368.5,-414 40368.5,-414 40368.5,-385 40368.5,-385 40368.5,-379 40374.5,-373 40380.5,-373 40380.5,-373 40490.5,-373 40490.5,-373 40496.5,-373 40502.5,-379 40502.5,-385 40502.5,-385 40502.5,-414 40502.5,-414 40502.5,-420 40496.5,-426 40490.5,-426"/>
<text text-anchor="middle" x="40435.5" y="-410.8" font-family="Times,serif" font-size="14.00">Expert 7 Output</text>
<text text-anchor="middle" x="40435.5" y="-395.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="40435.5" y="-380.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer2_expert_7_down&#45;&gt;layer2_expert_7_out -->
<g id="edge367" class="edge">
<title>layer2_expert_7_down&#45;&gt;layer2_expert_7_out</title>
<path fill="none" stroke="black" d="M40332.7,-399.5C40341.26,-399.5 40349.82,-399.5 40358.39,-399.5"/>
<polygon fill="black" stroke="black" points="40358.44,-403 40368.44,-399.5 40358.44,-396 40358.44,-403"/>
</g>
<!-- layer2_expert_7_out&#45;&gt;layer2_moe_agg -->
<g id="edge376" class="edge">
<title>layer2_expert_7_out&#45;&gt;layer2_moe_agg</title>
<path fill="none" stroke="black" d="M40459.87,-426.05C40475.53,-441.08 40497.24,-458.44 40520.5,-466.5 40593.84,-491.93 46034.89,-487.93 46109.5,-466.5 46124.94,-462.07 46140.31,-454.68 46154.38,-446.39"/>
<polygon fill="black" stroke="black" points="46156.26,-449.34 46162.97,-441.14 46152.61,-443.37 46156.26,-449.34"/>
</g>
<!-- layer3_q_0_0 -->
<g id="node235" class="node">
<title>layer3_q_0_0</title>
<path fill="lightcoral" stroke="black" d="M61438,-307C61438,-307 61255,-307 61255,-307 61249,-307 61243,-301 61243,-295 61243,-295 61243,-236 61243,-236 61243,-230 61249,-224 61255,-224 61255,-224 61438,-224 61438,-224 61444,-224 61450,-230 61450,-236 61450,-236 61450,-295 61450,-295 61450,-301 61444,-307 61438,-307"/>
<text text-anchor="middle" x="61346.5" y="-291.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="61346.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="61346.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="61346.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="61346.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_q_0_0 -->
<g id="edge378" class="edge">
<title>layer3_ln1&#45;&gt;layer3_q_0_0</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46573.8,-364.46 61125.3,-357.95 61224.5,-332.5 61242.08,-327.99 61259.84,-320.36 61276.17,-311.83"/>
<polygon fill="black" stroke="black" points="61277.95,-314.85 61285.08,-307.01 61274.62,-308.69 61277.95,-314.85"/>
</g>
<!-- layer3_k_0_0 -->
<g id="node236" class="node">
<title>layer3_k_0_0</title>
<path fill="lightcoral" stroke="black" d="M61213,-307C61213,-307 61030,-307 61030,-307 61024,-307 61018,-301 61018,-295 61018,-295 61018,-236 61018,-236 61018,-230 61024,-224 61030,-224 61030,-224 61213,-224 61213,-224 61219,-224 61225,-230 61225,-236 61225,-236 61225,-295 61225,-295 61225,-301 61219,-307 61213,-307"/>
<text text-anchor="middle" x="61121.5" y="-291.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="61121.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="61121.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="61121.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="61121.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_k_0_0 -->
<g id="edge379" class="edge">
<title>layer3_ln1&#45;&gt;layer3_k_0_0</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46572.32,-363.97 60901.81,-357.56 60999.5,-332.5 61017.08,-327.99 61034.84,-320.36 61051.17,-311.83"/>
<polygon fill="black" stroke="black" points="61052.95,-314.85 61060.08,-307.01 61049.62,-308.69 61052.95,-314.85"/>
</g>
<!-- layer3_v_0_0 -->
<g id="node237" class="node">
<title>layer3_v_0_0</title>
<path fill="lightcoral" stroke="black" d="M60988,-307C60988,-307 60805,-307 60805,-307 60799,-307 60793,-301 60793,-295 60793,-295 60793,-236 60793,-236 60793,-230 60799,-224 60805,-224 60805,-224 60988,-224 60988,-224 60994,-224 61000,-230 61000,-236 61000,-236 61000,-295 61000,-295 61000,-301 60994,-307 60988,-307"/>
<text text-anchor="middle" x="60896.5" y="-291.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="60896.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="60896.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="60896.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="60896.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_v_0_0 -->
<g id="edge380" class="edge">
<title>layer3_ln1&#45;&gt;layer3_v_0_0</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46570.83,-363.48 60678.32,-357.17 60774.5,-332.5 60792.08,-327.99 60809.84,-320.36 60826.17,-311.83"/>
<polygon fill="black" stroke="black" points="60827.95,-314.85 60835.08,-307.01 60824.62,-308.69 60827.95,-314.85"/>
</g>
<!-- layer3_q_0_1 -->
<g id="node238" class="node">
<title>layer3_q_0_1</title>
<path fill="lightcoral" stroke="black" d="M60520,-307C60520,-307 60337,-307 60337,-307 60331,-307 60325,-301 60325,-295 60325,-295 60325,-236 60325,-236 60325,-230 60331,-224 60337,-224 60337,-224 60520,-224 60520,-224 60526,-224 60532,-230 60532,-236 60532,-236 60532,-295 60532,-295 60532,-301 60526,-307 60520,-307"/>
<text text-anchor="middle" x="60428.5" y="-291.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="60428.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="60428.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="60428.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="60428.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_q_0_1 -->
<g id="edge381" class="edge">
<title>layer3_ln1&#45;&gt;layer3_q_0_1</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46567.75,-362.47 60213.47,-356.36 60306.5,-332.5 60324.08,-327.99 60341.84,-320.36 60358.17,-311.83"/>
<polygon fill="black" stroke="black" points="60359.95,-314.85 60367.08,-307.01 60356.62,-308.69 60359.95,-314.85"/>
</g>
<!-- layer3_k_0_1 -->
<g id="node239" class="node">
<title>layer3_k_0_1</title>
<path fill="lightcoral" stroke="black" d="M60295,-307C60295,-307 60112,-307 60112,-307 60106,-307 60100,-301 60100,-295 60100,-295 60100,-236 60100,-236 60100,-230 60106,-224 60112,-224 60112,-224 60295,-224 60295,-224 60301,-224 60307,-230 60307,-236 60307,-236 60307,-295 60307,-295 60307,-301 60301,-307 60295,-307"/>
<text text-anchor="middle" x="60203.5" y="-291.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="60203.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="60203.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="60203.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="60203.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_k_0_1 -->
<g id="edge382" class="edge">
<title>layer3_ln1&#45;&gt;layer3_k_0_1</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46566.26,-361.98 59989.98,-355.98 60081.5,-332.5 60099.08,-327.99 60116.84,-320.36 60133.17,-311.83"/>
<polygon fill="black" stroke="black" points="60134.95,-314.85 60142.08,-307.01 60131.62,-308.69 60134.95,-314.85"/>
</g>
<!-- layer3_v_0_1 -->
<g id="node240" class="node">
<title>layer3_v_0_1</title>
<path fill="lightcoral" stroke="black" d="M60070,-307C60070,-307 59887,-307 59887,-307 59881,-307 59875,-301 59875,-295 59875,-295 59875,-236 59875,-236 59875,-230 59881,-224 59887,-224 59887,-224 60070,-224 60070,-224 60076,-224 60082,-230 60082,-236 60082,-236 60082,-295 60082,-295 60082,-301 60076,-307 60070,-307"/>
<text text-anchor="middle" x="59978.5" y="-291.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="59978.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="59978.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="59978.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="59978.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_v_0_1 -->
<g id="edge383" class="edge">
<title>layer3_ln1&#45;&gt;layer3_v_0_1</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46564.78,-361.49 59766.5,-355.59 59856.5,-332.5 59874.08,-327.99 59891.84,-320.36 59908.17,-311.83"/>
<polygon fill="black" stroke="black" points="59909.95,-314.85 59917.08,-307.01 59906.62,-308.69 59909.95,-314.85"/>
</g>
<!-- layer3_q_0_2 -->
<g id="node241" class="node">
<title>layer3_q_0_2</title>
<path fill="lightcoral" stroke="black" d="M59602,-307C59602,-307 59419,-307 59419,-307 59413,-307 59407,-301 59407,-295 59407,-295 59407,-236 59407,-236 59407,-230 59413,-224 59419,-224 59419,-224 59602,-224 59602,-224 59608,-224 59614,-230 59614,-236 59614,-236 59614,-295 59614,-295 59614,-301 59608,-307 59602,-307"/>
<text text-anchor="middle" x="59510.5" y="-291.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="59510.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="59510.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="59510.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="59510.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_q_0_2 -->
<g id="edge384" class="edge">
<title>layer3_ln1&#45;&gt;layer3_q_0_2</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46561.69,-360.48 59301.65,-354.78 59388.5,-332.5 59406.08,-327.99 59423.84,-320.36 59440.17,-311.83"/>
<polygon fill="black" stroke="black" points="59441.95,-314.85 59449.08,-307.01 59438.62,-308.69 59441.95,-314.85"/>
</g>
<!-- layer3_k_0_2 -->
<g id="node242" class="node">
<title>layer3_k_0_2</title>
<path fill="lightcoral" stroke="black" d="M59377,-307C59377,-307 59194,-307 59194,-307 59188,-307 59182,-301 59182,-295 59182,-295 59182,-236 59182,-236 59182,-230 59188,-224 59194,-224 59194,-224 59377,-224 59377,-224 59383,-224 59389,-230 59389,-236 59389,-236 59389,-295 59389,-295 59389,-301 59383,-307 59377,-307"/>
<text text-anchor="middle" x="59285.5" y="-291.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="59285.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="59285.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="59285.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="59285.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_k_0_2 -->
<g id="edge385" class="edge">
<title>layer3_ln1&#45;&gt;layer3_k_0_2</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46560.21,-359.99 59078.16,-354.39 59163.5,-332.5 59181.08,-327.99 59198.84,-320.36 59215.17,-311.83"/>
<polygon fill="black" stroke="black" points="59216.95,-314.85 59224.08,-307.01 59213.62,-308.69 59216.95,-314.85"/>
</g>
<!-- layer3_v_0_2 -->
<g id="node243" class="node">
<title>layer3_v_0_2</title>
<path fill="lightcoral" stroke="black" d="M59152,-307C59152,-307 58969,-307 58969,-307 58963,-307 58957,-301 58957,-295 58957,-295 58957,-236 58957,-236 58957,-230 58963,-224 58969,-224 58969,-224 59152,-224 59152,-224 59158,-224 59164,-230 59164,-236 59164,-236 59164,-295 59164,-295 59164,-301 59158,-307 59152,-307"/>
<text text-anchor="middle" x="59060.5" y="-291.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="59060.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="59060.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="59060.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="59060.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_v_0_2 -->
<g id="edge386" class="edge">
<title>layer3_ln1&#45;&gt;layer3_v_0_2</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46558.72,-359.5 58854.67,-354 58938.5,-332.5 58956.08,-327.99 58973.84,-320.36 58990.17,-311.83"/>
<polygon fill="black" stroke="black" points="58991.95,-314.85 58999.08,-307.01 58988.62,-308.69 58991.95,-314.85"/>
</g>
<!-- layer3_q_0_3 -->
<g id="node244" class="node">
<title>layer3_q_0_3</title>
<path fill="lightcoral" stroke="black" d="M58684,-307C58684,-307 58501,-307 58501,-307 58495,-307 58489,-301 58489,-295 58489,-295 58489,-236 58489,-236 58489,-230 58495,-224 58501,-224 58501,-224 58684,-224 58684,-224 58690,-224 58696,-230 58696,-236 58696,-236 58696,-295 58696,-295 58696,-301 58690,-307 58684,-307"/>
<text text-anchor="middle" x="58592.5" y="-291.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="58592.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="58592.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="58592.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="58592.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_q_0_3 -->
<g id="edge387" class="edge">
<title>layer3_ln1&#45;&gt;layer3_q_0_3</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46555.63,-358.49 58389.82,-353.2 58470.5,-332.5 58488.08,-327.99 58505.84,-320.36 58522.17,-311.83"/>
<polygon fill="black" stroke="black" points="58523.95,-314.85 58531.08,-307.01 58520.62,-308.69 58523.95,-314.85"/>
</g>
<!-- layer3_k_0_3 -->
<g id="node245" class="node">
<title>layer3_k_0_3</title>
<path fill="lightcoral" stroke="black" d="M58459,-307C58459,-307 58276,-307 58276,-307 58270,-307 58264,-301 58264,-295 58264,-295 58264,-236 58264,-236 58264,-230 58270,-224 58276,-224 58276,-224 58459,-224 58459,-224 58465,-224 58471,-230 58471,-236 58471,-236 58471,-295 58471,-295 58471,-301 58465,-307 58459,-307"/>
<text text-anchor="middle" x="58367.5" y="-291.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="58367.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="58367.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="58367.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="58367.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_k_0_3 -->
<g id="edge388" class="edge">
<title>layer3_ln1&#45;&gt;layer3_k_0_3</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46554.15,-358 58166.33,-352.81 58245.5,-332.5 58263.08,-327.99 58280.84,-320.36 58297.17,-311.83"/>
<polygon fill="black" stroke="black" points="58298.95,-314.85 58306.08,-307.01 58295.62,-308.69 58298.95,-314.85"/>
</g>
<!-- layer3_v_0_3 -->
<g id="node246" class="node">
<title>layer3_v_0_3</title>
<path fill="lightcoral" stroke="black" d="M58234,-307C58234,-307 58051,-307 58051,-307 58045,-307 58039,-301 58039,-295 58039,-295 58039,-236 58039,-236 58039,-230 58045,-224 58051,-224 58051,-224 58234,-224 58234,-224 58240,-224 58246,-230 58246,-236 58246,-236 58246,-295 58246,-295 58246,-301 58240,-307 58234,-307"/>
<text text-anchor="middle" x="58142.5" y="-291.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="58142.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="58142.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="58142.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="58142.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_v_0_3 -->
<g id="edge389" class="edge">
<title>layer3_ln1&#45;&gt;layer3_v_0_3</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46552.66,-357.51 57942.85,-352.42 58020.5,-332.5 58038.08,-327.99 58055.84,-320.36 58072.17,-311.83"/>
<polygon fill="black" stroke="black" points="58073.95,-314.85 58081.08,-307.01 58070.62,-308.69 58073.95,-314.85"/>
</g>
<!-- layer3_q_1_0 -->
<g id="node247" class="node">
<title>layer3_q_1_0</title>
<path fill="lightcoral" stroke="black" d="M57584,-307C57584,-307 57401,-307 57401,-307 57395,-307 57389,-301 57389,-295 57389,-295 57389,-236 57389,-236 57389,-230 57395,-224 57401,-224 57401,-224 57584,-224 57584,-224 57590,-224 57596,-230 57596,-236 57596,-236 57596,-295 57596,-295 57596,-301 57590,-307 57584,-307"/>
<text text-anchor="middle" x="57492.5" y="-291.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="57492.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="57492.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="57492.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="57492.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_q_1_0 -->
<g id="edge390" class="edge">
<title>layer3_ln1&#45;&gt;layer3_q_1_0</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46548.38,-356.11 57297.22,-351.3 57370.5,-332.5 57388.08,-327.99 57405.84,-320.36 57422.17,-311.83"/>
<polygon fill="black" stroke="black" points="57423.95,-314.85 57431.08,-307.01 57420.62,-308.69 57423.95,-314.85"/>
</g>
<!-- layer3_k_1_0 -->
<g id="node248" class="node">
<title>layer3_k_1_0</title>
<path fill="lightcoral" stroke="black" d="M57359,-307C57359,-307 57176,-307 57176,-307 57170,-307 57164,-301 57164,-295 57164,-295 57164,-236 57164,-236 57164,-230 57170,-224 57176,-224 57176,-224 57359,-224 57359,-224 57365,-224 57371,-230 57371,-236 57371,-236 57371,-295 57371,-295 57371,-301 57365,-307 57359,-307"/>
<text text-anchor="middle" x="57267.5" y="-291.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="57267.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="57267.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="57267.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="57267.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_k_1_0 -->
<g id="edge391" class="edge">
<title>layer3_ln1&#45;&gt;layer3_k_1_0</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46546.89,-355.62 57073.73,-350.91 57145.5,-332.5 57163.08,-327.99 57180.84,-320.36 57197.17,-311.83"/>
<polygon fill="black" stroke="black" points="57198.95,-314.85 57206.08,-307.01 57195.62,-308.69 57198.95,-314.85"/>
</g>
<!-- layer3_v_1_0 -->
<g id="node249" class="node">
<title>layer3_v_1_0</title>
<path fill="lightcoral" stroke="black" d="M57134,-307C57134,-307 56951,-307 56951,-307 56945,-307 56939,-301 56939,-295 56939,-295 56939,-236 56939,-236 56939,-230 56945,-224 56951,-224 56951,-224 57134,-224 57134,-224 57140,-224 57146,-230 57146,-236 57146,-236 57146,-295 57146,-295 57146,-301 57140,-307 57134,-307"/>
<text text-anchor="middle" x="57042.5" y="-291.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="57042.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="57042.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="57042.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="57042.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_v_1_0 -->
<g id="edge392" class="edge">
<title>layer3_ln1&#45;&gt;layer3_v_1_0</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46545.41,-355.13 56850.25,-350.52 56920.5,-332.5 56938.08,-327.99 56955.84,-320.36 56972.17,-311.83"/>
<polygon fill="black" stroke="black" points="56973.95,-314.85 56981.08,-307.01 56970.62,-308.69 56973.95,-314.85"/>
</g>
<!-- layer3_q_1_1 -->
<g id="node250" class="node">
<title>layer3_q_1_1</title>
<path fill="lightcoral" stroke="black" d="M56666,-307C56666,-307 56483,-307 56483,-307 56477,-307 56471,-301 56471,-295 56471,-295 56471,-236 56471,-236 56471,-230 56477,-224 56483,-224 56483,-224 56666,-224 56666,-224 56672,-224 56678,-230 56678,-236 56678,-236 56678,-295 56678,-295 56678,-301 56672,-307 56666,-307"/>
<text text-anchor="middle" x="56574.5" y="-291.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="56574.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="56574.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="56574.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="56574.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_q_1_1 -->
<g id="edge393" class="edge">
<title>layer3_ln1&#45;&gt;layer3_q_1_1</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46542.32,-354.12 56385.39,-349.71 56452.5,-332.5 56470.08,-327.99 56487.84,-320.36 56504.17,-311.83"/>
<polygon fill="black" stroke="black" points="56505.95,-314.85 56513.08,-307.01 56502.62,-308.69 56505.95,-314.85"/>
</g>
<!-- layer3_k_1_1 -->
<g id="node251" class="node">
<title>layer3_k_1_1</title>
<path fill="lightcoral" stroke="black" d="M56441,-307C56441,-307 56258,-307 56258,-307 56252,-307 56246,-301 56246,-295 56246,-295 56246,-236 56246,-236 56246,-230 56252,-224 56258,-224 56258,-224 56441,-224 56441,-224 56447,-224 56453,-230 56453,-236 56453,-236 56453,-295 56453,-295 56453,-301 56447,-307 56441,-307"/>
<text text-anchor="middle" x="56349.5" y="-291.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="56349.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="56349.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="56349.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="56349.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_k_1_1 -->
<g id="edge394" class="edge">
<title>layer3_ln1&#45;&gt;layer3_k_1_1</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46540.83,-353.63 56161.91,-349.33 56227.5,-332.5 56245.08,-327.99 56262.84,-320.36 56279.17,-311.83"/>
<polygon fill="black" stroke="black" points="56280.95,-314.85 56288.08,-307.01 56277.62,-308.69 56280.95,-314.85"/>
</g>
<!-- layer3_v_1_1 -->
<g id="node252" class="node">
<title>layer3_v_1_1</title>
<path fill="lightcoral" stroke="black" d="M56216,-307C56216,-307 56033,-307 56033,-307 56027,-307 56021,-301 56021,-295 56021,-295 56021,-236 56021,-236 56021,-230 56027,-224 56033,-224 56033,-224 56216,-224 56216,-224 56222,-224 56228,-230 56228,-236 56228,-236 56228,-295 56228,-295 56228,-301 56222,-307 56216,-307"/>
<text text-anchor="middle" x="56124.5" y="-291.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="56124.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="56124.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="56124.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="56124.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_v_1_1 -->
<g id="edge395" class="edge">
<title>layer3_ln1&#45;&gt;layer3_v_1_1</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46539.35,-353.14 55938.42,-348.94 56002.5,-332.5 56020.08,-327.99 56037.84,-320.36 56054.17,-311.83"/>
<polygon fill="black" stroke="black" points="56055.95,-314.85 56063.08,-307.01 56052.62,-308.69 56055.95,-314.85"/>
</g>
<!-- layer3_q_1_2 -->
<g id="node253" class="node">
<title>layer3_q_1_2</title>
<path fill="lightcoral" stroke="black" d="M55748,-307C55748,-307 55565,-307 55565,-307 55559,-307 55553,-301 55553,-295 55553,-295 55553,-236 55553,-236 55553,-230 55559,-224 55565,-224 55565,-224 55748,-224 55748,-224 55754,-224 55760,-230 55760,-236 55760,-236 55760,-295 55760,-295 55760,-301 55754,-307 55748,-307"/>
<text text-anchor="middle" x="55656.5" y="-291.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="55656.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="55656.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="55656.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="55656.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_q_1_2 -->
<g id="edge396" class="edge">
<title>layer3_ln1&#45;&gt;layer3_q_1_2</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46536.26,-352.13 55473.57,-348.13 55534.5,-332.5 55552.08,-327.99 55569.84,-320.36 55586.17,-311.83"/>
<polygon fill="black" stroke="black" points="55587.95,-314.85 55595.08,-307.01 55584.62,-308.69 55587.95,-314.85"/>
</g>
<!-- layer3_k_1_2 -->
<g id="node254" class="node">
<title>layer3_k_1_2</title>
<path fill="lightcoral" stroke="black" d="M55523,-307C55523,-307 55340,-307 55340,-307 55334,-307 55328,-301 55328,-295 55328,-295 55328,-236 55328,-236 55328,-230 55334,-224 55340,-224 55340,-224 55523,-224 55523,-224 55529,-224 55535,-230 55535,-236 55535,-236 55535,-295 55535,-295 55535,-301 55529,-307 55523,-307"/>
<text text-anchor="middle" x="55431.5" y="-291.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="55431.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="55431.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="55431.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="55431.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_k_1_2 -->
<g id="edge397" class="edge">
<title>layer3_ln1&#45;&gt;layer3_k_1_2</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46534.78,-351.64 55250.08,-347.74 55309.5,-332.5 55327.08,-327.99 55344.84,-320.36 55361.17,-311.83"/>
<polygon fill="black" stroke="black" points="55362.95,-314.85 55370.08,-307.01 55359.62,-308.69 55362.95,-314.85"/>
</g>
<!-- layer3_v_1_2 -->
<g id="node255" class="node">
<title>layer3_v_1_2</title>
<path fill="lightcoral" stroke="black" d="M55298,-307C55298,-307 55115,-307 55115,-307 55109,-307 55103,-301 55103,-295 55103,-295 55103,-236 55103,-236 55103,-230 55109,-224 55115,-224 55115,-224 55298,-224 55298,-224 55304,-224 55310,-230 55310,-236 55310,-236 55310,-295 55310,-295 55310,-301 55304,-307 55298,-307"/>
<text text-anchor="middle" x="55206.5" y="-291.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="55206.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="55206.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="55206.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="55206.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_v_1_2 -->
<g id="edge398" class="edge">
<title>layer3_ln1&#45;&gt;layer3_v_1_2</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46590.09,-369.8 54968.69,-362.21 55084.5,-332.5 55102.08,-327.99 55119.84,-320.36 55136.17,-311.83"/>
<polygon fill="black" stroke="black" points="55137.95,-314.85 55145.08,-307.01 55134.62,-308.69 55137.95,-314.85"/>
</g>
<!-- layer3_q_1_3 -->
<g id="node256" class="node">
<title>layer3_q_1_3</title>
<path fill="lightcoral" stroke="black" d="M54830,-307C54830,-307 54647,-307 54647,-307 54641,-307 54635,-301 54635,-295 54635,-295 54635,-236 54635,-236 54635,-230 54641,-224 54647,-224 54647,-224 54830,-224 54830,-224 54836,-224 54842,-230 54842,-236 54842,-236 54842,-295 54842,-295 54842,-301 54836,-307 54830,-307"/>
<text text-anchor="middle" x="54738.5" y="-291.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="54738.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="54738.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="54738.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="54738.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_q_1_3 -->
<g id="edge399" class="edge">
<title>layer3_ln1&#45;&gt;layer3_q_1_3</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46583.91,-367.78 54506.99,-360.59 54616.5,-332.5 54634.08,-327.99 54651.84,-320.36 54668.17,-311.83"/>
<polygon fill="black" stroke="black" points="54669.95,-314.85 54677.08,-307.01 54666.62,-308.69 54669.95,-314.85"/>
</g>
<!-- layer3_k_1_3 -->
<g id="node257" class="node">
<title>layer3_k_1_3</title>
<path fill="lightcoral" stroke="black" d="M54605,-307C54605,-307 54422,-307 54422,-307 54416,-307 54410,-301 54410,-295 54410,-295 54410,-236 54410,-236 54410,-230 54416,-224 54422,-224 54422,-224 54605,-224 54605,-224 54611,-224 54617,-230 54617,-236 54617,-236 54617,-295 54617,-295 54617,-301 54611,-307 54605,-307"/>
<text text-anchor="middle" x="54513.5" y="-291.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="54513.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="54513.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="54513.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="54513.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_k_1_3 -->
<g id="edge400" class="edge">
<title>layer3_ln1&#45;&gt;layer3_k_1_3</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46580.94,-366.8 54285.02,-359.82 54391.5,-332.5 54409.08,-327.99 54426.84,-320.36 54443.17,-311.83"/>
<polygon fill="black" stroke="black" points="54444.95,-314.85 54452.08,-307.01 54441.62,-308.69 54444.95,-314.85"/>
</g>
<!-- layer3_v_1_3 -->
<g id="node258" class="node">
<title>layer3_v_1_3</title>
<path fill="lightcoral" stroke="black" d="M54380,-307C54380,-307 54197,-307 54197,-307 54191,-307 54185,-301 54185,-295 54185,-295 54185,-236 54185,-236 54185,-230 54191,-224 54197,-224 54197,-224 54380,-224 54380,-224 54386,-224 54392,-230 54392,-236 54392,-236 54392,-295 54392,-295 54392,-301 54386,-307 54380,-307"/>
<text text-anchor="middle" x="54288.5" y="-291.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="54288.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="54288.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="54288.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="54288.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_v_1_3 -->
<g id="edge401" class="edge">
<title>layer3_ln1&#45;&gt;layer3_v_1_3</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46577.97,-365.83 54063.04,-359.04 54166.5,-332.5 54184.08,-327.99 54201.84,-320.36 54218.17,-311.83"/>
<polygon fill="black" stroke="black" points="54219.95,-314.85 54227.08,-307.01 54216.62,-308.69 54219.95,-314.85"/>
</g>
<!-- layer3_q_2_0 -->
<g id="node259" class="node">
<title>layer3_q_2_0</title>
<path fill="lightcoral" stroke="black" d="M53730,-307C53730,-307 53547,-307 53547,-307 53541,-307 53535,-301 53535,-295 53535,-295 53535,-236 53535,-236 53535,-230 53541,-224 53547,-224 53547,-224 53730,-224 53730,-224 53736,-224 53742,-230 53742,-236 53742,-236 53742,-295 53742,-295 53742,-301 53736,-307 53730,-307"/>
<text text-anchor="middle" x="53638.5" y="-291.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="53638.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="53638.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="53638.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="53638.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_q_2_0 -->
<g id="edge402" class="edge">
<title>layer3_ln1&#45;&gt;layer3_q_2_0</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46569.4,-363.01 53421.79,-356.8 53516.5,-332.5 53534.08,-327.99 53551.84,-320.36 53568.17,-311.83"/>
<polygon fill="black" stroke="black" points="53569.95,-314.85 53577.08,-307.01 53566.62,-308.69 53569.95,-314.85"/>
</g>
<!-- layer3_k_2_0 -->
<g id="node260" class="node">
<title>layer3_k_2_0</title>
<path fill="lightcoral" stroke="black" d="M53505,-307C53505,-307 53322,-307 53322,-307 53316,-307 53310,-301 53310,-295 53310,-295 53310,-236 53310,-236 53310,-230 53316,-224 53322,-224 53322,-224 53505,-224 53505,-224 53511,-224 53517,-230 53517,-236 53517,-236 53517,-295 53517,-295 53517,-301 53511,-307 53505,-307"/>
<text text-anchor="middle" x="53413.5" y="-291.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="53413.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="53413.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="53413.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="53413.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_k_2_0 -->
<g id="edge403" class="edge">
<title>layer3_ln1&#45;&gt;layer3_k_2_0</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46566.43,-362.03 53199.82,-356.02 53291.5,-332.5 53309.08,-327.99 53326.84,-320.36 53343.17,-311.83"/>
<polygon fill="black" stroke="black" points="53344.95,-314.85 53352.08,-307.01 53341.62,-308.69 53344.95,-314.85"/>
</g>
<!-- layer3_v_2_0 -->
<g id="node261" class="node">
<title>layer3_v_2_0</title>
<path fill="lightcoral" stroke="black" d="M53280,-307C53280,-307 53097,-307 53097,-307 53091,-307 53085,-301 53085,-295 53085,-295 53085,-236 53085,-236 53085,-230 53091,-224 53097,-224 53097,-224 53280,-224 53280,-224 53286,-224 53292,-230 53292,-236 53292,-236 53292,-295 53292,-295 53292,-301 53286,-307 53280,-307"/>
<text text-anchor="middle" x="53188.5" y="-291.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="53188.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="53188.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="53188.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="53188.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_v_2_0 -->
<g id="edge404" class="edge">
<title>layer3_ln1&#45;&gt;layer3_v_2_0</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46563.46,-361.06 52977.84,-355.24 53066.5,-332.5 53084.08,-327.99 53101.84,-320.36 53118.17,-311.83"/>
<polygon fill="black" stroke="black" points="53119.95,-314.85 53127.08,-307.01 53116.62,-308.69 53119.95,-314.85"/>
</g>
<!-- layer3_q_2_1 -->
<g id="node262" class="node">
<title>layer3_q_2_1</title>
<path fill="lightcoral" stroke="black" d="M52812,-307C52812,-307 52629,-307 52629,-307 52623,-307 52617,-301 52617,-295 52617,-295 52617,-236 52617,-236 52617,-230 52623,-224 52629,-224 52629,-224 52812,-224 52812,-224 52818,-224 52824,-230 52824,-236 52824,-236 52824,-295 52824,-295 52824,-301 52818,-307 52812,-307"/>
<text text-anchor="middle" x="52720.5" y="-291.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="52720.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="52720.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="52720.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="52720.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_q_2_1 -->
<g id="edge405" class="edge">
<title>layer3_ln1&#45;&gt;layer3_q_2_1</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46557.28,-359.03 52516.14,-353.63 52598.5,-332.5 52616.08,-327.99 52633.84,-320.36 52650.17,-311.83"/>
<polygon fill="black" stroke="black" points="52651.95,-314.85 52659.08,-307.01 52648.62,-308.69 52651.95,-314.85"/>
</g>
<!-- layer3_k_2_1 -->
<g id="node263" class="node">
<title>layer3_k_2_1</title>
<path fill="lightcoral" stroke="black" d="M52587,-307C52587,-307 52404,-307 52404,-307 52398,-307 52392,-301 52392,-295 52392,-295 52392,-236 52392,-236 52392,-230 52398,-224 52404,-224 52404,-224 52587,-224 52587,-224 52593,-224 52599,-230 52599,-236 52599,-236 52599,-295 52599,-295 52599,-301 52593,-307 52587,-307"/>
<text text-anchor="middle" x="52495.5" y="-291.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="52495.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="52495.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="52495.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="52495.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_k_2_1 -->
<g id="edge406" class="edge">
<title>layer3_ln1&#45;&gt;layer3_k_2_1</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46554.31,-358.06 52294.17,-352.85 52373.5,-332.5 52391.08,-327.99 52408.84,-320.36 52425.17,-311.83"/>
<polygon fill="black" stroke="black" points="52426.95,-314.85 52434.08,-307.01 52423.62,-308.69 52426.95,-314.85"/>
</g>
<!-- layer3_v_2_1 -->
<g id="node264" class="node">
<title>layer3_v_2_1</title>
<path fill="lightcoral" stroke="black" d="M52362,-307C52362,-307 52179,-307 52179,-307 52173,-307 52167,-301 52167,-295 52167,-295 52167,-236 52167,-236 52167,-230 52173,-224 52179,-224 52179,-224 52362,-224 52362,-224 52368,-224 52374,-230 52374,-236 52374,-236 52374,-295 52374,-295 52374,-301 52368,-307 52362,-307"/>
<text text-anchor="middle" x="52270.5" y="-291.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="52270.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="52270.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="52270.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="52270.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_v_2_1 -->
<g id="edge407" class="edge">
<title>layer3_ln1&#45;&gt;layer3_v_2_1</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46551.34,-357.08 52072.19,-352.07 52148.5,-332.5 52166.08,-327.99 52183.84,-320.36 52200.17,-311.83"/>
<polygon fill="black" stroke="black" points="52201.95,-314.85 52209.08,-307.01 52198.62,-308.69 52201.95,-314.85"/>
</g>
<!-- layer3_q_2_2 -->
<g id="node265" class="node">
<title>layer3_q_2_2</title>
<path fill="lightcoral" stroke="black" d="M51894,-307C51894,-307 51711,-307 51711,-307 51705,-307 51699,-301 51699,-295 51699,-295 51699,-236 51699,-236 51699,-230 51705,-224 51711,-224 51711,-224 51894,-224 51894,-224 51900,-224 51906,-230 51906,-236 51906,-236 51906,-295 51906,-295 51906,-301 51900,-307 51894,-307"/>
<text text-anchor="middle" x="51802.5" y="-291.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="51802.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="51802.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="51802.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="51802.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_q_2_2 -->
<g id="edge408" class="edge">
<title>layer3_ln1&#45;&gt;layer3_q_2_2</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46545.17,-355.05 51610.49,-350.46 51680.5,-332.5 51698.08,-327.99 51715.84,-320.36 51732.17,-311.83"/>
<polygon fill="black" stroke="black" points="51733.95,-314.85 51741.08,-307.01 51730.62,-308.69 51733.95,-314.85"/>
</g>
<!-- layer3_k_2_2 -->
<g id="node266" class="node">
<title>layer3_k_2_2</title>
<path fill="lightcoral" stroke="black" d="M51669,-307C51669,-307 51486,-307 51486,-307 51480,-307 51474,-301 51474,-295 51474,-295 51474,-236 51474,-236 51474,-230 51480,-224 51486,-224 51486,-224 51669,-224 51669,-224 51675,-224 51681,-230 51681,-236 51681,-236 51681,-295 51681,-295 51681,-301 51675,-307 51669,-307"/>
<text text-anchor="middle" x="51577.5" y="-291.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="51577.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="51577.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="51577.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="51577.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_k_2_2 -->
<g id="edge409" class="edge">
<title>layer3_ln1&#45;&gt;layer3_k_2_2</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46542.2,-354.08 51388.52,-349.68 51455.5,-332.5 51473.08,-327.99 51490.84,-320.36 51507.17,-311.83"/>
<polygon fill="black" stroke="black" points="51508.95,-314.85 51516.08,-307.01 51505.62,-308.69 51508.95,-314.85"/>
</g>
<!-- layer3_v_2_2 -->
<g id="node267" class="node">
<title>layer3_v_2_2</title>
<path fill="lightcoral" stroke="black" d="M51444,-307C51444,-307 51261,-307 51261,-307 51255,-307 51249,-301 51249,-295 51249,-295 51249,-236 51249,-236 51249,-230 51255,-224 51261,-224 51261,-224 51444,-224 51444,-224 51450,-224 51456,-230 51456,-236 51456,-236 51456,-295 51456,-295 51456,-301 51450,-307 51444,-307"/>
<text text-anchor="middle" x="51352.5" y="-291.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="51352.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="51352.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="51352.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="51352.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_v_2_2 -->
<g id="edge410" class="edge">
<title>layer3_ln1&#45;&gt;layer3_v_2_2</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46539.23,-353.1 51166.54,-348.91 51230.5,-332.5 51248.08,-327.99 51265.84,-320.36 51282.17,-311.83"/>
<polygon fill="black" stroke="black" points="51283.95,-314.85 51291.08,-307.01 51280.62,-308.69 51283.95,-314.85"/>
</g>
<!-- layer3_q_2_3 -->
<g id="node268" class="node">
<title>layer3_q_2_3</title>
<path fill="lightcoral" stroke="black" d="M50976,-307C50976,-307 50793,-307 50793,-307 50787,-307 50781,-301 50781,-295 50781,-295 50781,-236 50781,-236 50781,-230 50787,-224 50793,-224 50793,-224 50976,-224 50976,-224 50982,-224 50988,-230 50988,-236 50988,-236 50988,-295 50988,-295 50988,-301 50982,-307 50976,-307"/>
<text text-anchor="middle" x="50884.5" y="-291.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="50884.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="50884.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="50884.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="50884.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_q_2_3 -->
<g id="edge411" class="edge">
<title>layer3_ln1&#45;&gt;layer3_q_2_3</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46589.61,-369.65 50647.18,-362.08 50762.5,-332.5 50780.08,-327.99 50797.84,-320.36 50814.17,-311.83"/>
<polygon fill="black" stroke="black" points="50815.95,-314.85 50823.08,-307.01 50812.62,-308.69 50815.95,-314.85"/>
</g>
<!-- layer3_k_2_3 -->
<g id="node269" class="node">
<title>layer3_k_2_3</title>
<path fill="lightcoral" stroke="black" d="M50751,-307C50751,-307 50568,-307 50568,-307 50562,-307 50556,-301 50556,-295 50556,-295 50556,-236 50556,-236 50556,-230 50562,-224 50568,-224 50568,-224 50751,-224 50751,-224 50757,-224 50763,-230 50763,-236 50763,-236 50763,-295 50763,-295 50763,-301 50757,-307 50751,-307"/>
<text text-anchor="middle" x="50659.5" y="-291.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="50659.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="50659.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="50659.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="50659.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_k_2_3 -->
<g id="edge412" class="edge">
<title>layer3_ln1&#45;&gt;layer3_k_2_3</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46583.67,-367.7 50428.23,-360.53 50537.5,-332.5 50555.08,-327.99 50572.84,-320.36 50589.17,-311.83"/>
<polygon fill="black" stroke="black" points="50590.95,-314.85 50598.08,-307.01 50587.62,-308.69 50590.95,-314.85"/>
</g>
<!-- layer3_v_2_3 -->
<g id="node270" class="node">
<title>layer3_v_2_3</title>
<path fill="lightcoral" stroke="black" d="M50526,-307C50526,-307 50343,-307 50343,-307 50337,-307 50331,-301 50331,-295 50331,-295 50331,-236 50331,-236 50331,-230 50337,-224 50343,-224 50343,-224 50526,-224 50526,-224 50532,-224 50538,-230 50538,-236 50538,-236 50538,-295 50538,-295 50538,-301 50532,-307 50526,-307"/>
<text text-anchor="middle" x="50434.5" y="-291.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="50434.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="50434.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="50434.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="50434.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_v_2_3 -->
<g id="edge413" class="edge">
<title>layer3_ln1&#45;&gt;layer3_v_2_3</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46577.74,-365.75 50209.29,-358.98 50312.5,-332.5 50330.08,-327.99 50347.84,-320.36 50364.17,-311.83"/>
<polygon fill="black" stroke="black" points="50365.95,-314.85 50373.08,-307.01 50362.62,-308.69 50365.95,-314.85"/>
</g>
<!-- layer3_q_3_0 -->
<g id="node271" class="node">
<title>layer3_q_3_0</title>
<path fill="lightcoral" stroke="black" d="M49876,-307C49876,-307 49693,-307 49693,-307 49687,-307 49681,-301 49681,-295 49681,-295 49681,-236 49681,-236 49681,-230 49687,-224 49693,-224 49693,-224 49876,-224 49876,-224 49882,-224 49888,-230 49888,-236 49888,-236 49888,-295 49888,-295 49888,-301 49882,-307 49876,-307"/>
<text text-anchor="middle" x="49784.5" y="-291.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="49784.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="49784.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="49784.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="49784.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_q_3_0 -->
<g id="edge414" class="edge">
<title>layer3_ln1&#45;&gt;layer3_q_3_0</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46560.58,-360.11 49576.78,-354.49 49662.5,-332.5 49680.08,-327.99 49697.84,-320.36 49714.17,-311.83"/>
<polygon fill="black" stroke="black" points="49715.95,-314.85 49723.08,-307.01 49712.62,-308.69 49715.95,-314.85"/>
</g>
<!-- layer3_k_3_0 -->
<g id="node272" class="node">
<title>layer3_k_3_0</title>
<path fill="lightcoral" stroke="black" d="M49651,-307C49651,-307 49468,-307 49468,-307 49462,-307 49456,-301 49456,-295 49456,-295 49456,-236 49456,-236 49456,-230 49462,-224 49468,-224 49468,-224 49651,-224 49651,-224 49657,-224 49663,-230 49663,-236 49663,-236 49663,-295 49663,-295 49663,-301 49657,-307 49651,-307"/>
<text text-anchor="middle" x="49559.5" y="-291.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="49559.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="49559.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="49559.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="49559.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_k_3_0 -->
<g id="edge415" class="edge">
<title>layer3_ln1&#45;&gt;layer3_k_3_0</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46554.64,-358.16 49357.83,-352.94 49437.5,-332.5 49455.08,-327.99 49472.84,-320.36 49489.17,-311.83"/>
<polygon fill="black" stroke="black" points="49490.95,-314.85 49498.08,-307.01 49487.62,-308.69 49490.95,-314.85"/>
</g>
<!-- layer3_v_3_0 -->
<g id="node273" class="node">
<title>layer3_v_3_0</title>
<path fill="lightcoral" stroke="black" d="M49426,-307C49426,-307 49243,-307 49243,-307 49237,-307 49231,-301 49231,-295 49231,-295 49231,-236 49231,-236 49231,-230 49237,-224 49243,-224 49243,-224 49426,-224 49426,-224 49432,-224 49438,-230 49438,-236 49438,-236 49438,-295 49438,-295 49438,-301 49432,-307 49426,-307"/>
<text text-anchor="middle" x="49334.5" y="-291.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="49334.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="49334.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="49334.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="49334.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_v_3_0 -->
<g id="edge416" class="edge">
<title>layer3_ln1&#45;&gt;layer3_v_3_0</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46548.71,-356.21 49138.88,-351.38 49212.5,-332.5 49230.08,-327.99 49247.84,-320.36 49264.17,-311.83"/>
<polygon fill="black" stroke="black" points="49265.95,-314.85 49273.08,-307.01 49262.62,-308.69 49265.95,-314.85"/>
</g>
<!-- layer3_q_3_1 -->
<g id="node274" class="node">
<title>layer3_q_3_1</title>
<path fill="lightcoral" stroke="black" d="M48958,-307C48958,-307 48775,-307 48775,-307 48769,-307 48763,-301 48763,-295 48763,-295 48763,-236 48763,-236 48763,-230 48769,-224 48775,-224 48775,-224 48958,-224 48958,-224 48964,-224 48970,-230 48970,-236 48970,-236 48970,-295 48970,-295 48970,-301 48964,-307 48958,-307"/>
<text text-anchor="middle" x="48866.5" y="-291.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="48866.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="48866.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="48866.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="48866.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_q_3_1 -->
<g id="edge417" class="edge">
<title>layer3_ln1&#45;&gt;layer3_q_3_1</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46536.35,-352.16 48683.48,-348.15 48744.5,-332.5 48762.08,-327.99 48779.84,-320.36 48796.17,-311.83"/>
<polygon fill="black" stroke="black" points="48797.95,-314.85 48805.08,-307.01 48794.62,-308.69 48797.95,-314.85"/>
</g>
<!-- layer3_k_3_1 -->
<g id="node275" class="node">
<title>layer3_k_3_1</title>
<path fill="lightcoral" stroke="black" d="M48733,-307C48733,-307 48550,-307 48550,-307 48544,-307 48538,-301 48538,-295 48538,-295 48538,-236 48538,-236 48538,-230 48544,-224 48550,-224 48550,-224 48733,-224 48733,-224 48739,-224 48745,-230 48745,-236 48745,-236 48745,-295 48745,-295 48745,-301 48739,-307 48733,-307"/>
<text text-anchor="middle" x="48641.5" y="-291.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="48641.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="48641.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="48641.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="48641.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_k_3_1 -->
<g id="edge418" class="edge">
<title>layer3_ln1&#45;&gt;layer3_k_3_1</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46584.33,-367.92 48409.56,-360.7 48519.5,-332.5 48537.08,-327.99 48554.84,-320.36 48571.17,-311.83"/>
<polygon fill="black" stroke="black" points="48572.95,-314.85 48580.08,-307.01 48569.62,-308.69 48572.95,-314.85"/>
</g>
<!-- layer3_v_3_1 -->
<g id="node276" class="node">
<title>layer3_v_3_1</title>
<path fill="lightcoral" stroke="black" d="M48508,-307C48508,-307 48325,-307 48325,-307 48319,-307 48313,-301 48313,-295 48313,-295 48313,-236 48313,-236 48313,-230 48319,-224 48325,-224 48325,-224 48508,-224 48508,-224 48514,-224 48520,-230 48520,-236 48520,-236 48520,-295 48520,-295 48520,-301 48514,-307 48508,-307"/>
<text text-anchor="middle" x="48416.5" y="-291.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="48416.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="48416.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="48416.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="48416.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_v_3_1 -->
<g id="edge419" class="edge">
<title>layer3_ln1&#45;&gt;layer3_v_3_1</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46572.46,-364.01 48196.67,-357.6 48294.5,-332.5 48312.08,-327.99 48329.84,-320.36 48346.17,-311.83"/>
<polygon fill="black" stroke="black" points="48347.95,-314.85 48355.08,-307.01 48344.62,-308.69 48347.95,-314.85"/>
</g>
<!-- layer3_q_3_2 -->
<g id="node277" class="node">
<title>layer3_q_3_2</title>
<path fill="lightcoral" stroke="black" d="M48040,-307C48040,-307 47857,-307 47857,-307 47851,-307 47845,-301 47845,-295 47845,-295 47845,-236 47845,-236 47845,-230 47851,-224 47857,-224 47857,-224 48040,-224 48040,-224 48046,-224 48052,-230 48052,-236 48052,-236 48052,-295 48052,-295 48052,-301 48046,-307 48040,-307"/>
<text text-anchor="middle" x="47948.5" y="-291.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="47948.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="47948.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="47948.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="47948.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_q_3_2 -->
<g id="edge420" class="edge">
<title>layer3_ln1&#45;&gt;layer3_q_3_2</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46547.76,-355.9 47753.85,-351.14 47826.5,-332.5 47844.08,-327.99 47861.84,-320.36 47878.17,-311.83"/>
<polygon fill="black" stroke="black" points="47879.95,-314.85 47887.08,-307.01 47876.62,-308.69 47879.95,-314.85"/>
</g>
<!-- layer3_k_3_2 -->
<g id="node278" class="node">
<title>layer3_k_3_2</title>
<path fill="lightcoral" stroke="black" d="M47815,-307C47815,-307 47632,-307 47632,-307 47626,-307 47620,-301 47620,-295 47620,-295 47620,-236 47620,-236 47620,-230 47626,-224 47632,-224 47632,-224 47815,-224 47815,-224 47821,-224 47827,-230 47827,-236 47827,-236 47827,-295 47827,-295 47827,-301 47821,-307 47815,-307"/>
<text text-anchor="middle" x="47723.5" y="-291.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="47723.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="47723.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="47723.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="47723.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_k_3_2 -->
<g id="edge421" class="edge">
<title>layer3_ln1&#45;&gt;layer3_k_3_2</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46535.88,-352 47540.96,-348.03 47601.5,-332.5 47619.08,-327.99 47636.84,-320.36 47653.17,-311.83"/>
<polygon fill="black" stroke="black" points="47654.95,-314.85 47662.08,-307.01 47651.62,-308.69 47654.95,-314.85"/>
</g>
<!-- layer3_v_3_2 -->
<g id="node279" class="node">
<title>layer3_v_3_2</title>
<path fill="lightcoral" stroke="black" d="M47590,-307C47590,-307 47407,-307 47407,-307 47401,-307 47395,-301 47395,-295 47395,-295 47395,-236 47395,-236 47395,-230 47401,-224 47407,-224 47407,-224 47590,-224 47590,-224 47596,-224 47602,-230 47602,-236 47602,-236 47602,-295 47602,-295 47602,-301 47596,-307 47590,-307"/>
<text text-anchor="middle" x="47498.5" y="-291.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="47498.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="47498.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="47498.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="47498.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_v_3_2 -->
<g id="edge422" class="edge">
<title>layer3_ln1&#45;&gt;layer3_v_3_2</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46571.51,-363.7 47279.64,-357.35 47376.5,-332.5 47394.08,-327.99 47411.84,-320.36 47428.17,-311.83"/>
<polygon fill="black" stroke="black" points="47429.95,-314.85 47437.08,-307.01 47426.62,-308.69 47429.95,-314.85"/>
</g>
<!-- layer3_q_3_3 -->
<g id="node280" class="node">
<title>layer3_q_3_3</title>
<path fill="lightcoral" stroke="black" d="M47122,-307C47122,-307 46939,-307 46939,-307 46933,-307 46927,-301 46927,-295 46927,-295 46927,-236 46927,-236 46927,-230 46933,-224 46939,-224 46939,-224 47122,-224 47122,-224 47128,-224 47134,-230 47134,-236 47134,-236 47134,-295 47134,-295 47134,-301 47128,-307 47122,-307"/>
<text text-anchor="middle" x="47030.5" y="-291.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="47030.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="47030.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="47030.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="47030.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_q_3_3 -->
<g id="edge423" class="edge">
<title>layer3_ln1&#45;&gt;layer3_q_3_3</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46567.71,-362.45 46815.51,-356.35 46908.5,-332.5 46926.08,-327.99 46943.84,-320.36 46960.17,-311.83"/>
<polygon fill="black" stroke="black" points="46961.95,-314.85 46969.08,-307.01 46958.62,-308.69 46961.95,-314.85"/>
</g>
<!-- layer3_k_3_3 -->
<g id="node281" class="node">
<title>layer3_k_3_3</title>
<path fill="lightcoral" stroke="black" d="M46897,-307C46897,-307 46714,-307 46714,-307 46708,-307 46702,-301 46702,-295 46702,-295 46702,-236 46702,-236 46702,-230 46708,-224 46714,-224 46714,-224 46897,-224 46897,-224 46903,-224 46909,-230 46909,-236 46909,-236 46909,-295 46909,-295 46909,-301 46903,-307 46897,-307"/>
<text text-anchor="middle" x="46805.5" y="-291.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="46805.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="46805.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="46805.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="46805.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_k_3_3 -->
<g id="edge424" class="edge">
<title>layer3_ln1&#45;&gt;layer3_k_3_3</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46563.91,-361.21 46594.39,-355.36 46683.5,-332.5 46701.08,-327.99 46718.84,-320.36 46735.17,-311.83"/>
<polygon fill="black" stroke="black" points="46736.95,-314.85 46744.08,-307.01 46733.62,-308.69 46736.95,-314.85"/>
</g>
<!-- layer3_v_3_3 -->
<g id="node282" class="node">
<title>layer3_v_3_3</title>
<path fill="lightcoral" stroke="black" d="M46672,-307C46672,-307 46489,-307 46489,-307 46483,-307 46477,-301 46477,-295 46477,-295 46477,-236 46477,-236 46477,-230 46483,-224 46489,-224 46489,-224 46672,-224 46672,-224 46678,-224 46684,-230 46684,-236 46684,-236 46684,-295 46684,-295 46684,-301 46678,-307 46672,-307"/>
<text text-anchor="middle" x="46580.5" y="-291.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="46580.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="46580.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="46580.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="46580.5" y="-231.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_v_3_3 -->
<g id="edge425" class="edge">
<title>layer3_ln1&#45;&gt;layer3_v_3_3</title>
<path fill="none" stroke="black" d="M46441.11,-265.5C46449.65,-265.5 46458.2,-265.5 46466.74,-265.5"/>
<polygon fill="black" stroke="black" points="46466.77,-269 46476.77,-265.5 46466.77,-262 46466.77,-269"/>
</g>
<!-- layer3_residual1 -->
<g id="node284" class="node">
<title>layer3_residual1</title>
<path fill="lightgreen" stroke="black" d="M62402.5,-292C62402.5,-292 62302.5,-292 62302.5,-292 62296.5,-292 62290.5,-286 62290.5,-280 62290.5,-280 62290.5,-251 62290.5,-251 62290.5,-245 62296.5,-239 62302.5,-239 62302.5,-239 62402.5,-239 62402.5,-239 62408.5,-239 62414.5,-245 62414.5,-251 62414.5,-251 62414.5,-280 62414.5,-280 62414.5,-286 62408.5,-292 62402.5,-292"/>
<text text-anchor="middle" x="62352.5" y="-276.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="62352.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="62352.5" y="-246.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_ln1&#45;&gt;layer3_residual1 -->
<g id="edge427" class="edge">
<title>layer3_ln1&#45;&gt;layer3_residual1</title>
<path fill="none" stroke="black" d="M46411.94,-292.09C46428.83,-307.12 46452.08,-324.48 46476.5,-332.5 46580.6,-366.69 62149.82,-364.86 62254.5,-332.5 62276.67,-325.65 62298.29,-311.86 62315.56,-298.57"/>
<polygon fill="black" stroke="black" points="62318.03,-301.08 62323.67,-292.12 62313.67,-295.61 62318.03,-301.08"/>
</g>
<!-- layer3_attn_0_0 -->
<g id="node297" class="node">
<title>layer3_attn_0_0</title>
<path fill="orange" stroke="black" d="M61681,-299.5C61681,-299.5 61498,-299.5 61498,-299.5 61492,-299.5 61486,-293.5 61486,-287.5 61486,-287.5 61486,-243.5 61486,-243.5 61486,-237.5 61492,-231.5 61498,-231.5 61498,-231.5 61681,-231.5 61681,-231.5 61687,-231.5 61693,-237.5 61693,-243.5 61693,-243.5 61693,-287.5 61693,-287.5 61693,-293.5 61687,-299.5 61681,-299.5"/>
<text text-anchor="middle" x="61589.5" y="-284.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="61589.5" y="-269.3" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="61589.5" y="-254.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="61589.5" y="-239.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_q_0_0&#45;&gt;layer3_attn_0_0 -->
<g id="edge448" class="edge">
<title>layer3_q_0_0&#45;&gt;layer3_attn_0_0</title>
<path fill="none" stroke="black" d="M61450.44,-265.5C61458.81,-265.5 61467.17,-265.5 61475.54,-265.5"/>
<polygon fill="black" stroke="black" points="61475.75,-269 61485.75,-265.5 61475.75,-262 61475.75,-269"/>
</g>
<!-- layer3_k_0_0&#45;&gt;layer3_attn_0_0 -->
<g id="edge449" class="edge">
<title>layer3_k_0_0&#45;&gt;layer3_attn_0_0</title>
<path fill="none" stroke="black" d="M61182.38,-307.01C61200.88,-317.43 61221.81,-327.15 61242.5,-332.5 61331.57,-355.51 61359.78,-352.86 61449.5,-332.5 61475.02,-326.71 61501.32,-315.67 61524.14,-304.2"/>
<polygon fill="black" stroke="black" points="61525.75,-307.31 61533.04,-299.62 61522.54,-301.08 61525.75,-307.31"/>
</g>
<!-- layer3_v_0_0&#45;&gt;layer3_attn_0_0 -->
<g id="edge450" class="edge">
<title>layer3_v_0_0&#45;&gt;layer3_attn_0_0</title>
<path fill="none" stroke="black" d="M60957.38,-307.01C60975.88,-317.43 60996.81,-327.15 61017.5,-332.5 61110.45,-356.52 61355.88,-353.75 61449.5,-332.5 61475.02,-326.71 61501.32,-315.67 61524.14,-304.2"/>
<polygon fill="black" stroke="black" points="61525.75,-307.31 61533.04,-299.62 61522.54,-301.08 61525.75,-307.31"/>
</g>
<!-- layer3_attn_0_1 -->
<g id="node298" class="node">
<title>layer3_attn_0_1</title>
<path fill="orange" stroke="black" d="M60763,-299.5C60763,-299.5 60580,-299.5 60580,-299.5 60574,-299.5 60568,-293.5 60568,-287.5 60568,-287.5 60568,-243.5 60568,-243.5 60568,-237.5 60574,-231.5 60580,-231.5 60580,-231.5 60763,-231.5 60763,-231.5 60769,-231.5 60775,-237.5 60775,-243.5 60775,-243.5 60775,-287.5 60775,-287.5 60775,-293.5 60769,-299.5 60763,-299.5"/>
<text text-anchor="middle" x="60671.5" y="-284.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="60671.5" y="-269.3" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="60671.5" y="-254.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="60671.5" y="-239.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer3_q_0_1&#45;&gt;layer3_attn_0_1 -->
<g id="edge451" class="edge">
<title>layer3_q_0_1&#45;&gt;layer3_attn_0_1</title>
<path fill="none" stroke="black" d="M60532.44,-265.5C60540.81,-265.5 60549.17,-265.5 60557.54,-265.5"/>
<polygon fill="black" stroke="black" points="60557.75,-269 60567.75,-265.5 60557.75,-262 60557.75,-269"/>
</g>
<!-- layer3_k_0_1&#45;&gt;layer3_attn_0_1 -->
<g id="edge452" class="edge">
<title>layer3_k_0_1&#45;&gt;layer3_attn_0_1</title>
<path fill="none" stroke="black" d="M60264.38,-307.01C60282.88,-317.43 60303.81,-327.15 60324.5,-332.5 60413.57,-355.51 60441.78,-352.86 60531.5,-332.5 60557.02,-326.71 60583.32,-315.67 60606.14,-304.2"/>
<polygon fill="black" stroke="black" points="60607.75,-307.31 60615.04,-299.62 60604.54,-301.08 60607.75,-307.31"/>
</g>
<!-- layer3_v_0_1&#45;&gt;layer3_attn_0_1 -->
<g id="edge453" class="edge">
<title>layer3_v_0_1&#45;&gt;layer3_attn_0_1</title>
<path fill="none" stroke="black" d="M60039.38,-307.01C60057.88,-317.43 60078.81,-327.15 60099.5,-332.5 60192.45,-356.52 60437.88,-353.75 60531.5,-332.5 60557.02,-326.71 60583.32,-315.67 60606.14,-304.2"/>
<polygon fill="black" stroke="black" points="60607.75,-307.31 60615.04,-299.62 60604.54,-301.08 60607.75,-307.31"/>
</g>
<!-- layer3_attn_0_2 -->
<g id="node299" class="node">
<title>layer3_attn_0_2</title>
<path fill="orange" stroke="black" d="M59845,-299.5C59845,-299.5 59662,-299.5 59662,-299.5 59656,-299.5 59650,-293.5 59650,-287.5 59650,-287.5 59650,-243.5 59650,-243.5 59650,-237.5 59656,-231.5 59662,-231.5 59662,-231.5 59845,-231.5 59845,-231.5 59851,-231.5 59857,-237.5 59857,-243.5 59857,-243.5 59857,-287.5 59857,-287.5 59857,-293.5 59851,-299.5 59845,-299.5"/>
<text text-anchor="middle" x="59753.5" y="-284.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="59753.5" y="-269.3" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="59753.5" y="-254.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="59753.5" y="-239.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_q_0_2&#45;&gt;layer3_attn_0_2 -->
<g id="edge454" class="edge">
<title>layer3_q_0_2&#45;&gt;layer3_attn_0_2</title>
<path fill="none" stroke="black" d="M59614.44,-265.5C59622.81,-265.5 59631.17,-265.5 59639.54,-265.5"/>
<polygon fill="black" stroke="black" points="59639.75,-269 59649.75,-265.5 59639.75,-262 59639.75,-269"/>
</g>
<!-- layer3_k_0_2&#45;&gt;layer3_attn_0_2 -->
<g id="edge455" class="edge">
<title>layer3_k_0_2&#45;&gt;layer3_attn_0_2</title>
<path fill="none" stroke="black" d="M59346.38,-307.01C59364.88,-317.43 59385.81,-327.15 59406.5,-332.5 59495.57,-355.51 59523.78,-352.86 59613.5,-332.5 59639.02,-326.71 59665.32,-315.67 59688.14,-304.2"/>
<polygon fill="black" stroke="black" points="59689.75,-307.31 59697.04,-299.62 59686.54,-301.08 59689.75,-307.31"/>
</g>
<!-- layer3_v_0_2&#45;&gt;layer3_attn_0_2 -->
<g id="edge456" class="edge">
<title>layer3_v_0_2&#45;&gt;layer3_attn_0_2</title>
<path fill="none" stroke="black" d="M59121.38,-307.01C59139.88,-317.43 59160.81,-327.15 59181.5,-332.5 59274.45,-356.52 59519.88,-353.75 59613.5,-332.5 59639.02,-326.71 59665.32,-315.67 59688.14,-304.2"/>
<polygon fill="black" stroke="black" points="59689.75,-307.31 59697.04,-299.62 59686.54,-301.08 59689.75,-307.31"/>
</g>
<!-- layer3_attn_0_3 -->
<g id="node300" class="node">
<title>layer3_attn_0_3</title>
<path fill="orange" stroke="black" d="M58927,-299.5C58927,-299.5 58744,-299.5 58744,-299.5 58738,-299.5 58732,-293.5 58732,-287.5 58732,-287.5 58732,-243.5 58732,-243.5 58732,-237.5 58738,-231.5 58744,-231.5 58744,-231.5 58927,-231.5 58927,-231.5 58933,-231.5 58939,-237.5 58939,-243.5 58939,-243.5 58939,-287.5 58939,-287.5 58939,-293.5 58933,-299.5 58927,-299.5"/>
<text text-anchor="middle" x="58835.5" y="-284.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="58835.5" y="-269.3" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="58835.5" y="-254.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="58835.5" y="-239.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer3_q_0_3&#45;&gt;layer3_attn_0_3 -->
<g id="edge457" class="edge">
<title>layer3_q_0_3&#45;&gt;layer3_attn_0_3</title>
<path fill="none" stroke="black" d="M58696.44,-265.5C58704.81,-265.5 58713.17,-265.5 58721.54,-265.5"/>
<polygon fill="black" stroke="black" points="58721.75,-269 58731.75,-265.5 58721.75,-262 58721.75,-269"/>
</g>
<!-- layer3_k_0_3&#45;&gt;layer3_attn_0_3 -->
<g id="edge458" class="edge">
<title>layer3_k_0_3&#45;&gt;layer3_attn_0_3</title>
<path fill="none" stroke="black" d="M58428.38,-307.01C58446.88,-317.43 58467.81,-327.15 58488.5,-332.5 58577.57,-355.51 58605.78,-352.86 58695.5,-332.5 58721.02,-326.71 58747.32,-315.67 58770.14,-304.2"/>
<polygon fill="black" stroke="black" points="58771.75,-307.31 58779.04,-299.62 58768.54,-301.08 58771.75,-307.31"/>
</g>
<!-- layer3_v_0_3&#45;&gt;layer3_attn_0_3 -->
<g id="edge459" class="edge">
<title>layer3_v_0_3&#45;&gt;layer3_attn_0_3</title>
<path fill="none" stroke="black" d="M58203.38,-307.01C58221.88,-317.43 58242.81,-327.15 58263.5,-332.5 58356.45,-356.52 58601.88,-353.75 58695.5,-332.5 58721.02,-326.71 58747.32,-315.67 58770.14,-304.2"/>
<polygon fill="black" stroke="black" points="58771.75,-307.31 58779.04,-299.62 58768.54,-301.08 58771.75,-307.31"/>
</g>
<!-- layer3_attn_1_0 -->
<g id="node301" class="node">
<title>layer3_attn_1_0</title>
<path fill="orange" stroke="black" d="M57827,-299.5C57827,-299.5 57644,-299.5 57644,-299.5 57638,-299.5 57632,-293.5 57632,-287.5 57632,-287.5 57632,-243.5 57632,-243.5 57632,-237.5 57638,-231.5 57644,-231.5 57644,-231.5 57827,-231.5 57827,-231.5 57833,-231.5 57839,-237.5 57839,-243.5 57839,-243.5 57839,-287.5 57839,-287.5 57839,-293.5 57833,-299.5 57827,-299.5"/>
<text text-anchor="middle" x="57735.5" y="-284.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="57735.5" y="-269.3" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="57735.5" y="-254.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="57735.5" y="-239.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_q_1_0&#45;&gt;layer3_attn_1_0 -->
<g id="edge460" class="edge">
<title>layer3_q_1_0&#45;&gt;layer3_attn_1_0</title>
<path fill="none" stroke="black" d="M57596.44,-265.5C57604.81,-265.5 57613.17,-265.5 57621.54,-265.5"/>
<polygon fill="black" stroke="black" points="57621.75,-269 57631.75,-265.5 57621.75,-262 57621.75,-269"/>
</g>
<!-- layer3_k_1_0&#45;&gt;layer3_attn_1_0 -->
<g id="edge461" class="edge">
<title>layer3_k_1_0&#45;&gt;layer3_attn_1_0</title>
<path fill="none" stroke="black" d="M57328.38,-307.01C57346.88,-317.43 57367.81,-327.15 57388.5,-332.5 57477.57,-355.51 57505.78,-352.86 57595.5,-332.5 57621.02,-326.71 57647.32,-315.67 57670.14,-304.2"/>
<polygon fill="black" stroke="black" points="57671.75,-307.31 57679.04,-299.62 57668.54,-301.08 57671.75,-307.31"/>
</g>
<!-- layer3_v_1_0&#45;&gt;layer3_attn_1_0 -->
<g id="edge462" class="edge">
<title>layer3_v_1_0&#45;&gt;layer3_attn_1_0</title>
<path fill="none" stroke="black" d="M57103.38,-307.01C57121.88,-317.43 57142.81,-327.15 57163.5,-332.5 57256.45,-356.52 57501.88,-353.75 57595.5,-332.5 57621.02,-326.71 57647.32,-315.67 57670.14,-304.2"/>
<polygon fill="black" stroke="black" points="57671.75,-307.31 57679.04,-299.62 57668.54,-301.08 57671.75,-307.31"/>
</g>
<!-- layer3_attn_1_1 -->
<g id="node302" class="node">
<title>layer3_attn_1_1</title>
<path fill="orange" stroke="black" d="M56909,-299.5C56909,-299.5 56726,-299.5 56726,-299.5 56720,-299.5 56714,-293.5 56714,-287.5 56714,-287.5 56714,-243.5 56714,-243.5 56714,-237.5 56720,-231.5 56726,-231.5 56726,-231.5 56909,-231.5 56909,-231.5 56915,-231.5 56921,-237.5 56921,-243.5 56921,-243.5 56921,-287.5 56921,-287.5 56921,-293.5 56915,-299.5 56909,-299.5"/>
<text text-anchor="middle" x="56817.5" y="-284.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="56817.5" y="-269.3" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="56817.5" y="-254.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="56817.5" y="-239.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer3_q_1_1&#45;&gt;layer3_attn_1_1 -->
<g id="edge463" class="edge">
<title>layer3_q_1_1&#45;&gt;layer3_attn_1_1</title>
<path fill="none" stroke="black" d="M56678.44,-265.5C56686.81,-265.5 56695.17,-265.5 56703.54,-265.5"/>
<polygon fill="black" stroke="black" points="56703.75,-269 56713.75,-265.5 56703.75,-262 56703.75,-269"/>
</g>
<!-- layer3_k_1_1&#45;&gt;layer3_attn_1_1 -->
<g id="edge464" class="edge">
<title>layer3_k_1_1&#45;&gt;layer3_attn_1_1</title>
<path fill="none" stroke="black" d="M56410.38,-307.01C56428.88,-317.43 56449.81,-327.15 56470.5,-332.5 56559.57,-355.51 56587.78,-352.86 56677.5,-332.5 56703.02,-326.71 56729.32,-315.67 56752.14,-304.2"/>
<polygon fill="black" stroke="black" points="56753.75,-307.31 56761.04,-299.62 56750.54,-301.08 56753.75,-307.31"/>
</g>
<!-- layer3_v_1_1&#45;&gt;layer3_attn_1_1 -->
<g id="edge465" class="edge">
<title>layer3_v_1_1&#45;&gt;layer3_attn_1_1</title>
<path fill="none" stroke="black" d="M56185.38,-307.01C56203.88,-317.43 56224.81,-327.15 56245.5,-332.5 56338.45,-356.52 56583.88,-353.75 56677.5,-332.5 56703.02,-326.71 56729.32,-315.67 56752.14,-304.2"/>
<polygon fill="black" stroke="black" points="56753.75,-307.31 56761.04,-299.62 56750.54,-301.08 56753.75,-307.31"/>
</g>
<!-- layer3_attn_1_2 -->
<g id="node303" class="node">
<title>layer3_attn_1_2</title>
<path fill="orange" stroke="black" d="M55991,-299.5C55991,-299.5 55808,-299.5 55808,-299.5 55802,-299.5 55796,-293.5 55796,-287.5 55796,-287.5 55796,-243.5 55796,-243.5 55796,-237.5 55802,-231.5 55808,-231.5 55808,-231.5 55991,-231.5 55991,-231.5 55997,-231.5 56003,-237.5 56003,-243.5 56003,-243.5 56003,-287.5 56003,-287.5 56003,-293.5 55997,-299.5 55991,-299.5"/>
<text text-anchor="middle" x="55899.5" y="-284.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="55899.5" y="-269.3" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="55899.5" y="-254.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="55899.5" y="-239.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_q_1_2&#45;&gt;layer3_attn_1_2 -->
<g id="edge466" class="edge">
<title>layer3_q_1_2&#45;&gt;layer3_attn_1_2</title>
<path fill="none" stroke="black" d="M55760.44,-265.5C55768.81,-265.5 55777.17,-265.5 55785.54,-265.5"/>
<polygon fill="black" stroke="black" points="55785.75,-269 55795.75,-265.5 55785.75,-262 55785.75,-269"/>
</g>
<!-- layer3_k_1_2&#45;&gt;layer3_attn_1_2 -->
<g id="edge467" class="edge">
<title>layer3_k_1_2&#45;&gt;layer3_attn_1_2</title>
<path fill="none" stroke="black" d="M55492.38,-307.01C55510.88,-317.43 55531.81,-327.15 55552.5,-332.5 55641.57,-355.51 55669.78,-352.86 55759.5,-332.5 55785.02,-326.71 55811.32,-315.67 55834.14,-304.2"/>
<polygon fill="black" stroke="black" points="55835.75,-307.31 55843.04,-299.62 55832.54,-301.08 55835.75,-307.31"/>
</g>
<!-- layer3_v_1_2&#45;&gt;layer3_attn_1_2 -->
<g id="edge468" class="edge">
<title>layer3_v_1_2&#45;&gt;layer3_attn_1_2</title>
<path fill="none" stroke="black" d="M55267.38,-307.01C55285.88,-317.43 55306.81,-327.15 55327.5,-332.5 55420.45,-356.52 55665.88,-353.75 55759.5,-332.5 55785.02,-326.71 55811.32,-315.67 55834.14,-304.2"/>
<polygon fill="black" stroke="black" points="55835.75,-307.31 55843.04,-299.62 55832.54,-301.08 55835.75,-307.31"/>
</g>
<!-- layer3_attn_1_3 -->
<g id="node304" class="node">
<title>layer3_attn_1_3</title>
<path fill="orange" stroke="black" d="M55073,-299.5C55073,-299.5 54890,-299.5 54890,-299.5 54884,-299.5 54878,-293.5 54878,-287.5 54878,-287.5 54878,-243.5 54878,-243.5 54878,-237.5 54884,-231.5 54890,-231.5 54890,-231.5 55073,-231.5 55073,-231.5 55079,-231.5 55085,-237.5 55085,-243.5 55085,-243.5 55085,-287.5 55085,-287.5 55085,-293.5 55079,-299.5 55073,-299.5"/>
<text text-anchor="middle" x="54981.5" y="-284.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="54981.5" y="-269.3" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="54981.5" y="-254.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="54981.5" y="-239.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer3_q_1_3&#45;&gt;layer3_attn_1_3 -->
<g id="edge469" class="edge">
<title>layer3_q_1_3&#45;&gt;layer3_attn_1_3</title>
<path fill="none" stroke="black" d="M54842.44,-265.5C54850.81,-265.5 54859.17,-265.5 54867.54,-265.5"/>
<polygon fill="black" stroke="black" points="54867.75,-269 54877.75,-265.5 54867.75,-262 54867.75,-269"/>
</g>
<!-- layer3_k_1_3&#45;&gt;layer3_attn_1_3 -->
<g id="edge470" class="edge">
<title>layer3_k_1_3&#45;&gt;layer3_attn_1_3</title>
<path fill="none" stroke="black" d="M54574.38,-307.01C54592.88,-317.43 54613.81,-327.15 54634.5,-332.5 54723.57,-355.51 54751.78,-352.86 54841.5,-332.5 54867.02,-326.71 54893.32,-315.67 54916.14,-304.2"/>
<polygon fill="black" stroke="black" points="54917.75,-307.31 54925.04,-299.62 54914.54,-301.08 54917.75,-307.31"/>
</g>
<!-- layer3_v_1_3&#45;&gt;layer3_attn_1_3 -->
<g id="edge471" class="edge">
<title>layer3_v_1_3&#45;&gt;layer3_attn_1_3</title>
<path fill="none" stroke="black" d="M54349.38,-307.01C54367.88,-317.43 54388.81,-327.15 54409.5,-332.5 54502.45,-356.52 54747.88,-353.75 54841.5,-332.5 54867.02,-326.71 54893.32,-315.67 54916.14,-304.2"/>
<polygon fill="black" stroke="black" points="54917.75,-307.31 54925.04,-299.62 54914.54,-301.08 54917.75,-307.31"/>
</g>
<!-- layer3_attn_2_0 -->
<g id="node305" class="node">
<title>layer3_attn_2_0</title>
<path fill="orange" stroke="black" d="M53973,-299.5C53973,-299.5 53790,-299.5 53790,-299.5 53784,-299.5 53778,-293.5 53778,-287.5 53778,-287.5 53778,-243.5 53778,-243.5 53778,-237.5 53784,-231.5 53790,-231.5 53790,-231.5 53973,-231.5 53973,-231.5 53979,-231.5 53985,-237.5 53985,-243.5 53985,-243.5 53985,-287.5 53985,-287.5 53985,-293.5 53979,-299.5 53973,-299.5"/>
<text text-anchor="middle" x="53881.5" y="-284.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="53881.5" y="-269.3" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="53881.5" y="-254.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="53881.5" y="-239.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_q_2_0&#45;&gt;layer3_attn_2_0 -->
<g id="edge472" class="edge">
<title>layer3_q_2_0&#45;&gt;layer3_attn_2_0</title>
<path fill="none" stroke="black" d="M53742.44,-265.5C53750.81,-265.5 53759.17,-265.5 53767.54,-265.5"/>
<polygon fill="black" stroke="black" points="53767.75,-269 53777.75,-265.5 53767.75,-262 53767.75,-269"/>
</g>
<!-- layer3_k_2_0&#45;&gt;layer3_attn_2_0 -->
<g id="edge473" class="edge">
<title>layer3_k_2_0&#45;&gt;layer3_attn_2_0</title>
<path fill="none" stroke="black" d="M53474.38,-307.01C53492.88,-317.43 53513.81,-327.15 53534.5,-332.5 53623.57,-355.51 53651.78,-352.86 53741.5,-332.5 53767.02,-326.71 53793.32,-315.67 53816.14,-304.2"/>
<polygon fill="black" stroke="black" points="53817.75,-307.31 53825.04,-299.62 53814.54,-301.08 53817.75,-307.31"/>
</g>
<!-- layer3_v_2_0&#45;&gt;layer3_attn_2_0 -->
<g id="edge474" class="edge">
<title>layer3_v_2_0&#45;&gt;layer3_attn_2_0</title>
<path fill="none" stroke="black" d="M53249.38,-307.01C53267.88,-317.43 53288.81,-327.15 53309.5,-332.5 53402.45,-356.52 53647.88,-353.75 53741.5,-332.5 53767.02,-326.71 53793.32,-315.67 53816.14,-304.2"/>
<polygon fill="black" stroke="black" points="53817.75,-307.31 53825.04,-299.62 53814.54,-301.08 53817.75,-307.31"/>
</g>
<!-- layer3_attn_2_1 -->
<g id="node306" class="node">
<title>layer3_attn_2_1</title>
<path fill="orange" stroke="black" d="M53055,-299.5C53055,-299.5 52872,-299.5 52872,-299.5 52866,-299.5 52860,-293.5 52860,-287.5 52860,-287.5 52860,-243.5 52860,-243.5 52860,-237.5 52866,-231.5 52872,-231.5 52872,-231.5 53055,-231.5 53055,-231.5 53061,-231.5 53067,-237.5 53067,-243.5 53067,-243.5 53067,-287.5 53067,-287.5 53067,-293.5 53061,-299.5 53055,-299.5"/>
<text text-anchor="middle" x="52963.5" y="-284.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="52963.5" y="-269.3" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="52963.5" y="-254.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="52963.5" y="-239.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer3_q_2_1&#45;&gt;layer3_attn_2_1 -->
<g id="edge475" class="edge">
<title>layer3_q_2_1&#45;&gt;layer3_attn_2_1</title>
<path fill="none" stroke="black" d="M52824.44,-265.5C52832.81,-265.5 52841.17,-265.5 52849.54,-265.5"/>
<polygon fill="black" stroke="black" points="52849.75,-269 52859.75,-265.5 52849.75,-262 52849.75,-269"/>
</g>
<!-- layer3_k_2_1&#45;&gt;layer3_attn_2_1 -->
<g id="edge476" class="edge">
<title>layer3_k_2_1&#45;&gt;layer3_attn_2_1</title>
<path fill="none" stroke="black" d="M52556.38,-307.01C52574.88,-317.43 52595.81,-327.15 52616.5,-332.5 52705.57,-355.51 52733.78,-352.86 52823.5,-332.5 52849.02,-326.71 52875.32,-315.67 52898.14,-304.2"/>
<polygon fill="black" stroke="black" points="52899.75,-307.31 52907.04,-299.62 52896.54,-301.08 52899.75,-307.31"/>
</g>
<!-- layer3_v_2_1&#45;&gt;layer3_attn_2_1 -->
<g id="edge477" class="edge">
<title>layer3_v_2_1&#45;&gt;layer3_attn_2_1</title>
<path fill="none" stroke="black" d="M52331.38,-307.01C52349.88,-317.43 52370.81,-327.15 52391.5,-332.5 52484.45,-356.52 52729.88,-353.75 52823.5,-332.5 52849.02,-326.71 52875.32,-315.67 52898.14,-304.2"/>
<polygon fill="black" stroke="black" points="52899.75,-307.31 52907.04,-299.62 52896.54,-301.08 52899.75,-307.31"/>
</g>
<!-- layer3_attn_2_2 -->
<g id="node307" class="node">
<title>layer3_attn_2_2</title>
<path fill="orange" stroke="black" d="M52137,-299.5C52137,-299.5 51954,-299.5 51954,-299.5 51948,-299.5 51942,-293.5 51942,-287.5 51942,-287.5 51942,-243.5 51942,-243.5 51942,-237.5 51948,-231.5 51954,-231.5 51954,-231.5 52137,-231.5 52137,-231.5 52143,-231.5 52149,-237.5 52149,-243.5 52149,-243.5 52149,-287.5 52149,-287.5 52149,-293.5 52143,-299.5 52137,-299.5"/>
<text text-anchor="middle" x="52045.5" y="-284.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="52045.5" y="-269.3" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="52045.5" y="-254.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="52045.5" y="-239.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_q_2_2&#45;&gt;layer3_attn_2_2 -->
<g id="edge478" class="edge">
<title>layer3_q_2_2&#45;&gt;layer3_attn_2_2</title>
<path fill="none" stroke="black" d="M51906.44,-265.5C51914.81,-265.5 51923.17,-265.5 51931.54,-265.5"/>
<polygon fill="black" stroke="black" points="51931.75,-269 51941.75,-265.5 51931.75,-262 51931.75,-269"/>
</g>
<!-- layer3_k_2_2&#45;&gt;layer3_attn_2_2 -->
<g id="edge479" class="edge">
<title>layer3_k_2_2&#45;&gt;layer3_attn_2_2</title>
<path fill="none" stroke="black" d="M51638.38,-307.01C51656.88,-317.43 51677.81,-327.15 51698.5,-332.5 51787.57,-355.51 51815.78,-352.86 51905.5,-332.5 51931.02,-326.71 51957.32,-315.67 51980.14,-304.2"/>
<polygon fill="black" stroke="black" points="51981.75,-307.31 51989.04,-299.62 51978.54,-301.08 51981.75,-307.31"/>
</g>
<!-- layer3_v_2_2&#45;&gt;layer3_attn_2_2 -->
<g id="edge480" class="edge">
<title>layer3_v_2_2&#45;&gt;layer3_attn_2_2</title>
<path fill="none" stroke="black" d="M51413.38,-307.01C51431.88,-317.43 51452.81,-327.15 51473.5,-332.5 51566.45,-356.52 51811.88,-353.75 51905.5,-332.5 51931.02,-326.71 51957.32,-315.67 51980.14,-304.2"/>
<polygon fill="black" stroke="black" points="51981.75,-307.31 51989.04,-299.62 51978.54,-301.08 51981.75,-307.31"/>
</g>
<!-- layer3_attn_2_3 -->
<g id="node308" class="node">
<title>layer3_attn_2_3</title>
<path fill="orange" stroke="black" d="M51219,-299.5C51219,-299.5 51036,-299.5 51036,-299.5 51030,-299.5 51024,-293.5 51024,-287.5 51024,-287.5 51024,-243.5 51024,-243.5 51024,-237.5 51030,-231.5 51036,-231.5 51036,-231.5 51219,-231.5 51219,-231.5 51225,-231.5 51231,-237.5 51231,-243.5 51231,-243.5 51231,-287.5 51231,-287.5 51231,-293.5 51225,-299.5 51219,-299.5"/>
<text text-anchor="middle" x="51127.5" y="-284.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="51127.5" y="-269.3" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="51127.5" y="-254.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="51127.5" y="-239.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer3_q_2_3&#45;&gt;layer3_attn_2_3 -->
<g id="edge481" class="edge">
<title>layer3_q_2_3&#45;&gt;layer3_attn_2_3</title>
<path fill="none" stroke="black" d="M50988.44,-265.5C50996.81,-265.5 51005.17,-265.5 51013.54,-265.5"/>
<polygon fill="black" stroke="black" points="51013.75,-269 51023.75,-265.5 51013.75,-262 51013.75,-269"/>
</g>
<!-- layer3_k_2_3&#45;&gt;layer3_attn_2_3 -->
<g id="edge482" class="edge">
<title>layer3_k_2_3&#45;&gt;layer3_attn_2_3</title>
<path fill="none" stroke="black" d="M50720.38,-307.01C50738.88,-317.43 50759.81,-327.15 50780.5,-332.5 50869.57,-355.51 50897.78,-352.86 50987.5,-332.5 51013.02,-326.71 51039.32,-315.67 51062.14,-304.2"/>
<polygon fill="black" stroke="black" points="51063.75,-307.31 51071.04,-299.62 51060.54,-301.08 51063.75,-307.31"/>
</g>
<!-- layer3_v_2_3&#45;&gt;layer3_attn_2_3 -->
<g id="edge483" class="edge">
<title>layer3_v_2_3&#45;&gt;layer3_attn_2_3</title>
<path fill="none" stroke="black" d="M50495.38,-307.01C50513.88,-317.43 50534.81,-327.15 50555.5,-332.5 50648.45,-356.52 50893.88,-353.75 50987.5,-332.5 51013.02,-326.71 51039.32,-315.67 51062.14,-304.2"/>
<polygon fill="black" stroke="black" points="51063.75,-307.31 51071.04,-299.62 51060.54,-301.08 51063.75,-307.31"/>
</g>
<!-- layer3_attn_3_0 -->
<g id="node309" class="node">
<title>layer3_attn_3_0</title>
<path fill="orange" stroke="black" d="M50119,-299.5C50119,-299.5 49936,-299.5 49936,-299.5 49930,-299.5 49924,-293.5 49924,-287.5 49924,-287.5 49924,-243.5 49924,-243.5 49924,-237.5 49930,-231.5 49936,-231.5 49936,-231.5 50119,-231.5 50119,-231.5 50125,-231.5 50131,-237.5 50131,-243.5 50131,-243.5 50131,-287.5 50131,-287.5 50131,-293.5 50125,-299.5 50119,-299.5"/>
<text text-anchor="middle" x="50027.5" y="-284.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="50027.5" y="-269.3" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="50027.5" y="-254.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="50027.5" y="-239.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_q_3_0&#45;&gt;layer3_attn_3_0 -->
<g id="edge484" class="edge">
<title>layer3_q_3_0&#45;&gt;layer3_attn_3_0</title>
<path fill="none" stroke="black" d="M49888.44,-265.5C49896.81,-265.5 49905.17,-265.5 49913.54,-265.5"/>
<polygon fill="black" stroke="black" points="49913.75,-269 49923.75,-265.5 49913.75,-262 49913.75,-269"/>
</g>
<!-- layer3_k_3_0&#45;&gt;layer3_attn_3_0 -->
<g id="edge485" class="edge">
<title>layer3_k_3_0&#45;&gt;layer3_attn_3_0</title>
<path fill="none" stroke="black" d="M49620.38,-307.01C49638.88,-317.43 49659.81,-327.15 49680.5,-332.5 49769.57,-355.51 49797.78,-352.86 49887.5,-332.5 49913.02,-326.71 49939.32,-315.67 49962.14,-304.2"/>
<polygon fill="black" stroke="black" points="49963.75,-307.31 49971.04,-299.62 49960.54,-301.08 49963.75,-307.31"/>
</g>
<!-- layer3_v_3_0&#45;&gt;layer3_attn_3_0 -->
<g id="edge486" class="edge">
<title>layer3_v_3_0&#45;&gt;layer3_attn_3_0</title>
<path fill="none" stroke="black" d="M49395.38,-307.01C49413.88,-317.43 49434.81,-327.15 49455.5,-332.5 49548.45,-356.52 49793.88,-353.75 49887.5,-332.5 49913.02,-326.71 49939.32,-315.67 49962.14,-304.2"/>
<polygon fill="black" stroke="black" points="49963.75,-307.31 49971.04,-299.62 49960.54,-301.08 49963.75,-307.31"/>
</g>
<!-- layer3_attn_3_1 -->
<g id="node310" class="node">
<title>layer3_attn_3_1</title>
<path fill="orange" stroke="black" d="M49201,-299.5C49201,-299.5 49018,-299.5 49018,-299.5 49012,-299.5 49006,-293.5 49006,-287.5 49006,-287.5 49006,-243.5 49006,-243.5 49006,-237.5 49012,-231.5 49018,-231.5 49018,-231.5 49201,-231.5 49201,-231.5 49207,-231.5 49213,-237.5 49213,-243.5 49213,-243.5 49213,-287.5 49213,-287.5 49213,-293.5 49207,-299.5 49201,-299.5"/>
<text text-anchor="middle" x="49109.5" y="-284.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="49109.5" y="-269.3" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="49109.5" y="-254.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="49109.5" y="-239.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer3_q_3_1&#45;&gt;layer3_attn_3_1 -->
<g id="edge487" class="edge">
<title>layer3_q_3_1&#45;&gt;layer3_attn_3_1</title>
<path fill="none" stroke="black" d="M48970.44,-265.5C48978.81,-265.5 48987.17,-265.5 48995.54,-265.5"/>
<polygon fill="black" stroke="black" points="48995.75,-269 49005.75,-265.5 48995.75,-262 48995.75,-269"/>
</g>
<!-- layer3_k_3_1&#45;&gt;layer3_attn_3_1 -->
<g id="edge488" class="edge">
<title>layer3_k_3_1&#45;&gt;layer3_attn_3_1</title>
<path fill="none" stroke="black" d="M48702.38,-307.01C48720.88,-317.43 48741.81,-327.15 48762.5,-332.5 48851.57,-355.51 48879.78,-352.86 48969.5,-332.5 48995.02,-326.71 49021.32,-315.67 49044.14,-304.2"/>
<polygon fill="black" stroke="black" points="49045.75,-307.31 49053.04,-299.62 49042.54,-301.08 49045.75,-307.31"/>
</g>
<!-- layer3_v_3_1&#45;&gt;layer3_attn_3_1 -->
<g id="edge489" class="edge">
<title>layer3_v_3_1&#45;&gt;layer3_attn_3_1</title>
<path fill="none" stroke="black" d="M48477.38,-307.01C48495.88,-317.43 48516.81,-327.15 48537.5,-332.5 48630.45,-356.52 48875.88,-353.75 48969.5,-332.5 48995.02,-326.71 49021.32,-315.67 49044.14,-304.2"/>
<polygon fill="black" stroke="black" points="49045.75,-307.31 49053.04,-299.62 49042.54,-301.08 49045.75,-307.31"/>
</g>
<!-- layer3_attn_3_2 -->
<g id="node311" class="node">
<title>layer3_attn_3_2</title>
<path fill="orange" stroke="black" d="M48283,-299.5C48283,-299.5 48100,-299.5 48100,-299.5 48094,-299.5 48088,-293.5 48088,-287.5 48088,-287.5 48088,-243.5 48088,-243.5 48088,-237.5 48094,-231.5 48100,-231.5 48100,-231.5 48283,-231.5 48283,-231.5 48289,-231.5 48295,-237.5 48295,-243.5 48295,-243.5 48295,-287.5 48295,-287.5 48295,-293.5 48289,-299.5 48283,-299.5"/>
<text text-anchor="middle" x="48191.5" y="-284.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="48191.5" y="-269.3" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="48191.5" y="-254.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="48191.5" y="-239.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_q_3_2&#45;&gt;layer3_attn_3_2 -->
<g id="edge490" class="edge">
<title>layer3_q_3_2&#45;&gt;layer3_attn_3_2</title>
<path fill="none" stroke="black" d="M48052.44,-265.5C48060.81,-265.5 48069.17,-265.5 48077.54,-265.5"/>
<polygon fill="black" stroke="black" points="48077.75,-269 48087.75,-265.5 48077.75,-262 48077.75,-269"/>
</g>
<!-- layer3_k_3_2&#45;&gt;layer3_attn_3_2 -->
<g id="edge491" class="edge">
<title>layer3_k_3_2&#45;&gt;layer3_attn_3_2</title>
<path fill="none" stroke="black" d="M47784.38,-307.01C47802.88,-317.43 47823.81,-327.15 47844.5,-332.5 47933.57,-355.51 47961.78,-352.86 48051.5,-332.5 48077.02,-326.71 48103.32,-315.67 48126.14,-304.2"/>
<polygon fill="black" stroke="black" points="48127.75,-307.31 48135.04,-299.62 48124.54,-301.08 48127.75,-307.31"/>
</g>
<!-- layer3_v_3_2&#45;&gt;layer3_attn_3_2 -->
<g id="edge492" class="edge">
<title>layer3_v_3_2&#45;&gt;layer3_attn_3_2</title>
<path fill="none" stroke="black" d="M47559.38,-307.01C47577.88,-317.43 47598.81,-327.15 47619.5,-332.5 47712.45,-356.52 47957.88,-353.75 48051.5,-332.5 48077.02,-326.71 48103.32,-315.67 48126.14,-304.2"/>
<polygon fill="black" stroke="black" points="48127.75,-307.31 48135.04,-299.62 48124.54,-301.08 48127.75,-307.31"/>
</g>
<!-- layer3_attn_3_3 -->
<g id="node312" class="node">
<title>layer3_attn_3_3</title>
<path fill="orange" stroke="black" d="M47365,-299.5C47365,-299.5 47182,-299.5 47182,-299.5 47176,-299.5 47170,-293.5 47170,-287.5 47170,-287.5 47170,-243.5 47170,-243.5 47170,-237.5 47176,-231.5 47182,-231.5 47182,-231.5 47365,-231.5 47365,-231.5 47371,-231.5 47377,-237.5 47377,-243.5 47377,-243.5 47377,-287.5 47377,-287.5 47377,-293.5 47371,-299.5 47365,-299.5"/>
<text text-anchor="middle" x="47273.5" y="-284.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="47273.5" y="-269.3" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="47273.5" y="-254.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="47273.5" y="-239.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer3_q_3_3&#45;&gt;layer3_attn_3_3 -->
<g id="edge493" class="edge">
<title>layer3_q_3_3&#45;&gt;layer3_attn_3_3</title>
<path fill="none" stroke="black" d="M47134.44,-265.5C47142.81,-265.5 47151.17,-265.5 47159.54,-265.5"/>
<polygon fill="black" stroke="black" points="47159.75,-269 47169.75,-265.5 47159.75,-262 47159.75,-269"/>
</g>
<!-- layer3_k_3_3&#45;&gt;layer3_attn_3_3 -->
<g id="edge494" class="edge">
<title>layer3_k_3_3&#45;&gt;layer3_attn_3_3</title>
<path fill="none" stroke="black" d="M46866.38,-307.01C46884.88,-317.43 46905.81,-327.15 46926.5,-332.5 47015.57,-355.51 47043.78,-352.86 47133.5,-332.5 47159.02,-326.71 47185.32,-315.67 47208.14,-304.2"/>
<polygon fill="black" stroke="black" points="47209.75,-307.31 47217.04,-299.62 47206.54,-301.08 47209.75,-307.31"/>
</g>
<!-- layer3_v_3_3&#45;&gt;layer3_attn_3_3 -->
<g id="edge495" class="edge">
<title>layer3_v_3_3&#45;&gt;layer3_attn_3_3</title>
<path fill="none" stroke="black" d="M46641.38,-307.01C46659.88,-317.43 46680.81,-327.15 46701.5,-332.5 46794.45,-356.52 47039.88,-353.75 47133.5,-332.5 47159.02,-326.71 47185.32,-315.67 47208.14,-304.2"/>
<polygon fill="black" stroke="black" points="47209.75,-307.31 47217.04,-299.62 47206.54,-301.08 47209.75,-307.31"/>
</g>
<!-- layer3_out_proj -->
<g id="node283" class="node">
<title>layer3_out_proj</title>
<path fill="lightcoral" stroke="black" d="M62242.5,-299.5C62242.5,-299.5 62122.5,-299.5 62122.5,-299.5 62116.5,-299.5 62110.5,-293.5 62110.5,-287.5 62110.5,-287.5 62110.5,-243.5 62110.5,-243.5 62110.5,-237.5 62116.5,-231.5 62122.5,-231.5 62122.5,-231.5 62242.5,-231.5 62242.5,-231.5 62248.5,-231.5 62254.5,-237.5 62254.5,-243.5 62254.5,-243.5 62254.5,-287.5 62254.5,-287.5 62254.5,-293.5 62248.5,-299.5 62242.5,-299.5"/>
<text text-anchor="middle" x="62182.5" y="-284.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="62182.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="62182.5" y="-254.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="62182.5" y="-239.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer3_out_proj&#45;&gt;layer3_residual1 -->
<g id="edge426" class="edge">
<title>layer3_out_proj&#45;&gt;layer3_residual1</title>
<path fill="none" stroke="black" d="M62254.55,-265.5C62263.08,-265.5 62271.6,-265.5 62280.13,-265.5"/>
<polygon fill="black" stroke="black" points="62280.13,-269 62290.13,-265.5 62280.13,-262 62280.13,-269"/>
</g>
<!-- layer3_ln2 -->
<g id="node285" class="node">
<title>layer3_ln2</title>
<path fill="lightyellow" stroke="black" d="M62549,-292C62549,-292 62462,-292 62462,-292 62456,-292 62450,-286 62450,-280 62450,-280 62450,-251 62450,-251 62450,-245 62456,-239 62462,-239 62462,-239 62549,-239 62549,-239 62555,-239 62561,-245 62561,-251 62561,-251 62561,-280 62561,-280 62561,-286 62555,-292 62549,-292"/>
<text text-anchor="middle" x="62505.5" y="-276.8" font-family="Times,serif" font-size="14.00">LayerNorm 3</text>
<text text-anchor="middle" x="62505.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="62505.5" y="-246.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_residual1&#45;&gt;layer3_ln2 -->
<g id="edge428" class="edge">
<title>layer3_residual1&#45;&gt;layer3_ln2</title>
<path fill="none" stroke="black" d="M62414.66,-265.5C62422.98,-265.5 62431.31,-265.5 62439.63,-265.5"/>
<polygon fill="black" stroke="black" points="62439.79,-269 62449.79,-265.5 62439.79,-262 62439.79,-269"/>
</g>
<!-- layer3_residual2 -->
<g id="node296" class="node">
<title>layer3_residual2</title>
<path fill="lightgreen" stroke="black" d="M69600.5,-292C69600.5,-292 69500.5,-292 69500.5,-292 69494.5,-292 69488.5,-286 69488.5,-280 69488.5,-280 69488.5,-251 69488.5,-251 69488.5,-245 69494.5,-239 69500.5,-239 69500.5,-239 69600.5,-239 69600.5,-239 69606.5,-239 69612.5,-245 69612.5,-251 69612.5,-251 69612.5,-280 69612.5,-280 69612.5,-286 69606.5,-292 69600.5,-292"/>
<text text-anchor="middle" x="69550.5" y="-276.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="69550.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="69550.5" y="-246.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_residual1&#45;&gt;layer3_residual2 -->
<g id="edge447" class="edge">
<title>layer3_residual1&#45;&gt;layer3_residual2</title>
<path fill="none" stroke="black" d="M62380.99,-292.11C62399.1,-307.16 62423.9,-324.52 62449.5,-332.5 62542.36,-361.45 69359.58,-361.23 69452.5,-332.5 69474.67,-325.65 69496.29,-311.86 69513.56,-298.57"/>
<polygon fill="black" stroke="black" points="69516.03,-301.08 69521.67,-292.12 69511.67,-295.61 69516.03,-301.08"/>
</g>
<!-- layer3_router -->
<g id="node286" class="node">
<title>layer3_router</title>
<path fill="gold" stroke="black" d="M62764,-299.5C62764,-299.5 62609,-299.5 62609,-299.5 62603,-299.5 62597,-293.5 62597,-287.5 62597,-287.5 62597,-243.5 62597,-243.5 62597,-237.5 62603,-231.5 62609,-231.5 62609,-231.5 62764,-231.5 62764,-231.5 62770,-231.5 62776,-237.5 62776,-243.5 62776,-243.5 62776,-287.5 62776,-287.5 62776,-293.5 62770,-299.5 62764,-299.5"/>
<text text-anchor="middle" x="62686.5" y="-284.3" font-family="Times,serif" font-size="14.00">MoE Router</text>
<text text-anchor="middle" x="62686.5" y="-269.3" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="62686.5" y="-254.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]  [B, L, 8]</text>
<text text-anchor="middle" x="62686.5" y="-239.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_ln2&#45;&gt;layer3_router -->
<g id="edge429" class="edge">
<title>layer3_ln2&#45;&gt;layer3_router</title>
<path fill="none" stroke="black" d="M62561,-265.5C62569.58,-265.5 62578.15,-265.5 62586.72,-265.5"/>
<polygon fill="black" stroke="black" points="62586.79,-269 62596.79,-265.5 62586.79,-262 62586.79,-269"/>
</g>
<!-- layer3_expert_0_gate -->
<g id="node287" class="node">
<title>layer3_expert_0_gate</title>
<path fill="lightyellow" stroke="black" d="M68597,-292C68597,-292 68504,-292 68504,-292 68498,-292 68492,-286 68492,-280 68492,-280 68492,-251 68492,-251 68492,-245 68498,-239 68504,-239 68504,-239 68597,-239 68597,-239 68603,-239 68609,-245 68609,-251 68609,-251 68609,-280 68609,-280 68609,-286 68603,-292 68597,-292"/>
<text text-anchor="middle" x="68550.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="68550.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="68550.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_ln2&#45;&gt;layer3_expert_0_gate -->
<g id="edge431" class="edge">
<title>layer3_ln2&#45;&gt;layer3_expert_0_gate</title>
<path fill="none" stroke="black" d="M62531.94,-292.09C62548.83,-307.12 62572.08,-324.48 62596.5,-332.5 62674.05,-357.97 68397.05,-361.1 68473.5,-332.5 68491.67,-325.7 68508.39,-312.46 68521.57,-299.53"/>
<polygon fill="black" stroke="black" points="68524.43,-301.61 68528.9,-292 68519.42,-296.72 68524.43,-301.61"/>
</g>
<!-- layer3_expert_1_gate -->
<g id="node288" class="node">
<title>layer3_expert_1_gate</title>
<path fill="lightyellow" stroke="black" d="M67796,-292C67796,-292 67703,-292 67703,-292 67697,-292 67691,-286 67691,-280 67691,-280 67691,-251 67691,-251 67691,-245 67697,-239 67703,-239 67703,-239 67796,-239 67796,-239 67802,-239 67808,-245 67808,-251 67808,-251 67808,-280 67808,-280 67808,-286 67802,-292 67796,-292"/>
<text text-anchor="middle" x="67749.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="67749.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="67749.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_ln2&#45;&gt;layer3_expert_1_gate -->
<g id="edge433" class="edge">
<title>layer3_ln2&#45;&gt;layer3_expert_1_gate</title>
<path fill="none" stroke="black" d="M62531.94,-292.09C62548.83,-307.12 62572.08,-324.48 62596.5,-332.5 62663.48,-354.5 67606.47,-357.21 67672.5,-332.5 67690.67,-325.7 67707.39,-312.46 67720.57,-299.53"/>
<polygon fill="black" stroke="black" points="67723.43,-301.61 67727.9,-292 67718.42,-296.72 67723.43,-301.61"/>
</g>
<!-- layer3_expert_2_gate -->
<g id="node289" class="node">
<title>layer3_expert_2_gate</title>
<path fill="lightyellow" stroke="black" d="M66995,-292C66995,-292 66902,-292 66902,-292 66896,-292 66890,-286 66890,-280 66890,-280 66890,-251 66890,-251 66890,-245 66896,-239 66902,-239 66902,-239 66995,-239 66995,-239 67001,-239 67007,-245 67007,-251 67007,-251 67007,-280 67007,-280 67007,-286 67001,-292 66995,-292"/>
<text text-anchor="middle" x="66948.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="66948.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="66948.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_ln2&#45;&gt;layer3_expert_2_gate -->
<g id="edge435" class="edge">
<title>layer3_ln2&#45;&gt;layer3_expert_2_gate</title>
<path fill="none" stroke="black" d="M62531.94,-292.09C62548.83,-307.12 62572.08,-324.48 62596.5,-332.5 62652.91,-351.03 66815.89,-353.31 66871.5,-332.5 66889.67,-325.7 66906.39,-312.46 66919.57,-299.53"/>
<polygon fill="black" stroke="black" points="66922.43,-301.61 66926.9,-292 66917.42,-296.72 66922.43,-301.61"/>
</g>
<!-- layer3_expert_3_gate -->
<g id="node290" class="node">
<title>layer3_expert_3_gate</title>
<path fill="lightyellow" stroke="black" d="M66194,-292C66194,-292 66101,-292 66101,-292 66095,-292 66089,-286 66089,-280 66089,-280 66089,-251 66089,-251 66089,-245 66095,-239 66101,-239 66101,-239 66194,-239 66194,-239 66200,-239 66206,-245 66206,-251 66206,-251 66206,-280 66206,-280 66206,-286 66200,-292 66194,-292"/>
<text text-anchor="middle" x="66147.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="66147.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="66147.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_ln2&#45;&gt;layer3_expert_3_gate -->
<g id="edge437" class="edge">
<title>layer3_ln2&#45;&gt;layer3_expert_3_gate</title>
<path fill="none" stroke="black" d="M62531.94,-292.09C62548.83,-307.12 62572.08,-324.48 62596.5,-332.5 62688.18,-362.61 65980.12,-366.32 66070.5,-332.5 66088.67,-325.7 66105.39,-312.46 66118.57,-299.53"/>
<polygon fill="black" stroke="black" points="66121.43,-301.61 66125.9,-292 66116.42,-296.72 66121.43,-301.61"/>
</g>
<!-- layer3_expert_4_gate -->
<g id="node291" class="node">
<title>layer3_expert_4_gate</title>
<path fill="lightyellow" stroke="black" d="M65393,-292C65393,-292 65300,-292 65300,-292 65294,-292 65288,-286 65288,-280 65288,-280 65288,-251 65288,-251 65288,-245 65294,-239 65300,-239 65300,-239 65393,-239 65393,-239 65399,-239 65405,-245 65405,-251 65405,-251 65405,-280 65405,-280 65405,-286 65399,-292 65393,-292"/>
<text text-anchor="middle" x="65346.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="65346.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="65346.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_ln2&#45;&gt;layer3_expert_4_gate -->
<g id="edge439" class="edge">
<title>layer3_ln2&#45;&gt;layer3_expert_4_gate</title>
<path fill="none" stroke="black" d="M62531.94,-292.09C62548.83,-307.12 62572.08,-324.48 62596.5,-332.5 62667.04,-355.67 65199.96,-358.52 65269.5,-332.5 65287.67,-325.7 65304.39,-312.46 65317.57,-299.53"/>
<polygon fill="black" stroke="black" points="65320.43,-301.61 65324.9,-292 65315.42,-296.72 65320.43,-301.61"/>
</g>
<!-- layer3_expert_5_gate -->
<g id="node292" class="node">
<title>layer3_expert_5_gate</title>
<path fill="lightyellow" stroke="black" d="M64592,-292C64592,-292 64499,-292 64499,-292 64493,-292 64487,-286 64487,-280 64487,-280 64487,-251 64487,-251 64487,-245 64493,-239 64499,-239 64499,-239 64592,-239 64592,-239 64598,-239 64604,-245 64604,-251 64604,-251 64604,-280 64604,-280 64604,-286 64598,-292 64592,-292"/>
<text text-anchor="middle" x="64545.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="64545.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="64545.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_ln2&#45;&gt;layer3_expert_5_gate -->
<g id="edge441" class="edge">
<title>layer3_ln2&#45;&gt;layer3_expert_5_gate</title>
<path fill="none" stroke="black" d="M62531.94,-292.09C62548.83,-307.12 62572.08,-324.48 62596.5,-332.5 62645.9,-348.73 64419.8,-350.72 64468.5,-332.5 64486.67,-325.7 64503.39,-312.46 64516.57,-299.53"/>
<polygon fill="black" stroke="black" points="64519.43,-301.61 64523.9,-292 64514.42,-296.72 64519.43,-301.61"/>
</g>
<!-- layer3_expert_6_gate -->
<g id="node293" class="node">
<title>layer3_expert_6_gate</title>
<path fill="lightyellow" stroke="black" d="M63791,-292C63791,-292 63698,-292 63698,-292 63692,-292 63686,-286 63686,-280 63686,-280 63686,-251 63686,-251 63686,-245 63692,-239 63698,-239 63698,-239 63791,-239 63791,-239 63797,-239 63803,-245 63803,-251 63803,-251 63803,-280 63803,-280 63803,-286 63797,-292 63791,-292"/>
<text text-anchor="middle" x="63744.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="63744.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="63744.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_ln2&#45;&gt;layer3_expert_6_gate -->
<g id="edge443" class="edge">
<title>layer3_ln2&#45;&gt;layer3_expert_6_gate</title>
<path fill="none" stroke="black" d="M62531.94,-292.09C62548.83,-307.12 62572.08,-324.48 62596.5,-332.5 62653.03,-351.07 63611.77,-353.35 63667.5,-332.5 63685.67,-325.7 63702.39,-312.46 63715.57,-299.53"/>
<polygon fill="black" stroke="black" points="63718.43,-301.61 63722.9,-292 63713.42,-296.72 63718.43,-301.61"/>
</g>
<!-- layer3_expert_7_gate -->
<g id="node294" class="node">
<title>layer3_expert_7_gate</title>
<path fill="lightyellow" stroke="black" d="M62990,-292C62990,-292 62897,-292 62897,-292 62891,-292 62885,-286 62885,-280 62885,-280 62885,-251 62885,-251 62885,-245 62891,-239 62897,-239 62897,-239 62990,-239 62990,-239 62996,-239 63002,-245 63002,-251 63002,-251 63002,-280 63002,-280 63002,-286 62996,-292 62990,-292"/>
<text text-anchor="middle" x="62943.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="62943.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="62943.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_ln2&#45;&gt;layer3_expert_7_gate -->
<g id="edge445" class="edge">
<title>layer3_ln2&#45;&gt;layer3_expert_7_gate</title>
<path fill="none" stroke="black" d="M62531.94,-292.09C62548.83,-307.12 62572.08,-324.48 62596.5,-332.5 62672.08,-357.32 62697.37,-347.5 62775.5,-332.5 62812.25,-325.44 62851.19,-310.44 62882.32,-296.41"/>
<polygon fill="black" stroke="black" points="62884.09,-299.45 62891.72,-292.1 62881.17,-293.09 62884.09,-299.45"/>
</g>
<!-- layer3_router&#45;&gt;layer3_expert_0_gate -->
<g id="edge430" class="edge">
<title>layer3_router&#45;&gt;layer3_expert_0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62767.33,-299.52C62802.63,-312.61 62844.93,-325.99 62884.5,-332.5 62961.09,-345.11 68400.8,-359.7 68473.5,-332.5 68491.67,-325.7 68508.39,-312.46 68521.57,-299.53"/>
<polygon fill="black" stroke="black" points="68524.43,-301.61 68528.9,-292 68519.42,-296.72 68524.43,-301.61"/>
</g>
<!-- layer3_router&#45;&gt;layer3_expert_0_gate -->
<g id="edge521" class="edge">
<title>layer3_router&#45;&gt;layer3_expert_0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62776.26,-299.5C63494.61,-299.5 68288.36,-299.5 68540.2,-299.5"/>
<polygon fill="black" stroke="black" points="68540.44,-303 68550.44,-299.5 68540.44,-296 68540.44,-303"/>
<text text-anchor="middle" x="62686.5" y="-261.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert_1_gate -->
<g id="edge432" class="edge">
<title>layer3_router&#45;&gt;layer3_expert_1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62767.33,-299.52C62802.63,-312.61 62844.93,-325.99 62884.5,-332.5 62950.12,-343.3 67610.22,-355.8 67672.5,-332.5 67690.67,-325.7 67707.39,-312.46 67720.57,-299.53"/>
<polygon fill="black" stroke="black" points="67723.43,-301.61 67727.9,-292 67718.42,-296.72 67723.43,-301.61"/>
</g>
<!-- layer3_router&#45;&gt;layer3_expert_1_gate -->
<g id="edge526" class="edge">
<title>layer3_router&#45;&gt;layer3_expert_1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62776.26,-299.5C63435.49,-299.5 67509.57,-299.5 67739.38,-299.5"/>
<polygon fill="black" stroke="black" points="67739.45,-303 67749.45,-299.5 67739.45,-296 67739.45,-303"/>
<text text-anchor="middle" x="62686.5" y="-261.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert_2_gate -->
<g id="edge434" class="edge">
<title>layer3_router&#45;&gt;layer3_expert_2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62767.33,-299.52C62802.63,-312.61 62844.93,-325.99 62884.5,-332.5 62993.78,-350.49 66767.77,-371.31 66871.5,-332.5 66889.67,-325.7 66906.39,-312.46 66919.57,-299.53"/>
<polygon fill="black" stroke="black" points="66922.43,-301.61 66926.9,-292 66917.42,-296.72 66922.43,-301.61"/>
</g>
<!-- layer3_router&#45;&gt;layer3_expert_2_gate -->
<g id="edge531" class="edge">
<title>layer3_router&#45;&gt;layer3_expert_2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62776.01,-299.5C63370.05,-299.5 66726.3,-299.5 66938.02,-299.5"/>
<polygon fill="black" stroke="black" points="66938.34,-303 66948.34,-299.5 66938.34,-296 66938.34,-303"/>
<text text-anchor="middle" x="62686.5" y="-261.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert_3_gate -->
<g id="edge436" class="edge">
<title>layer3_router&#45;&gt;layer3_expert_3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62767.33,-299.52C62802.63,-312.61 62844.93,-325.99 62884.5,-332.5 62971.82,-346.87 65987.61,-363.51 66070.5,-332.5 66088.67,-325.7 66105.39,-312.46 66118.57,-299.53"/>
<polygon fill="black" stroke="black" points="66121.43,-301.61 66125.9,-292 66116.42,-296.72 66121.43,-301.61"/>
</g>
<!-- layer3_router&#45;&gt;layer3_expert_3_gate -->
<g id="edge536" class="edge">
<title>layer3_router&#45;&gt;layer3_expert_3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62776.41,-299.5C63301.26,-299.5 65952.21,-299.5 66137.31,-299.5"/>
<polygon fill="black" stroke="black" points="66137.37,-303 66147.37,-299.5 66137.37,-296 66137.37,-303"/>
<text text-anchor="middle" x="62686.5" y="-261.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert_4_gate -->
<g id="edge438" class="edge">
<title>layer3_router&#45;&gt;layer3_expert_4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62767.33,-299.52C62802.63,-312.61 62844.93,-325.99 62884.5,-332.5 62949.87,-343.26 65207.45,-355.72 65269.5,-332.5 65287.67,-325.7 65304.39,-312.46 65317.57,-299.53"/>
<polygon fill="black" stroke="black" points="65320.43,-301.61 65324.9,-292 65315.42,-296.72 65320.43,-301.61"/>
</g>
<!-- layer3_router&#45;&gt;layer3_expert_4_gate -->
<g id="edge541" class="edge">
<title>layer3_router&#45;&gt;layer3_expert_4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62776.14,-299.5C63221.06,-299.5 65177.06,-299.5 65336.2,-299.5"/>
<polygon fill="black" stroke="black" points="65336.4,-303 65346.4,-299.5 65336.4,-296 65336.4,-303"/>
<text text-anchor="middle" x="62686.5" y="-261.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert_5_gate -->
<g id="edge440" class="edge">
<title>layer3_router&#45;&gt;layer3_expert_5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62767.33,-299.52C62802.63,-312.61 62844.93,-325.99 62884.5,-332.5 62971.33,-346.79 64386.08,-363.34 64468.5,-332.5 64486.67,-325.7 64503.39,-312.46 64516.57,-299.53"/>
<polygon fill="black" stroke="black" points="64519.43,-301.61 64523.9,-292 64514.42,-296.72 64519.43,-301.61"/>
</g>
<!-- layer3_router&#45;&gt;layer3_expert_5_gate -->
<g id="edge546" class="edge">
<title>layer3_router&#45;&gt;layer3_expert_5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62776.16,-299.5C63128.72,-299.5 64406.66,-299.5 64535.08,-299.5"/>
<polygon fill="black" stroke="black" points="64535.44,-303 64545.44,-299.5 64535.44,-296 64535.44,-303"/>
<text text-anchor="middle" x="62686.5" y="-261.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert_6_gate -->
<g id="edge442" class="edge">
<title>layer3_router&#45;&gt;layer3_expert_6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62767.33,-299.52C62802.63,-312.61 62844.93,-325.99 62884.5,-332.5 62970.34,-346.63 63586.02,-362.99 63667.5,-332.5 63685.67,-325.7 63702.39,-312.46 63715.57,-299.53"/>
<polygon fill="black" stroke="black" points="63718.43,-301.61 63722.9,-292 63713.42,-296.72 63718.43,-301.61"/>
</g>
<!-- layer3_router&#45;&gt;layer3_expert_6_gate -->
<g id="edge551" class="edge">
<title>layer3_router&#45;&gt;layer3_expert_6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62776.25,-299.5C63013.63,-299.5 63645.87,-299.5 63734.2,-299.5"/>
<polygon fill="black" stroke="black" points="63734.37,-303 63744.37,-299.5 63734.37,-296 63734.37,-303"/>
<text text-anchor="middle" x="62686.5" y="-261.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer3_router&#45;&gt;layer3_expert_7_gate -->
<g id="edge444" class="edge">
<title>layer3_router&#45;&gt;layer3_expert_7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62776.14,-262.74C62799.73,-262.32 62825.16,-262.13 62848.67,-262.5 62857.07,-262.63 62865.89,-262.83 62874.63,-263.07"/>
<polygon fill="black" stroke="black" points="62874.73,-266.57 62884.82,-263.35 62874.93,-259.57 62874.73,-266.57"/>
</g>
<!-- layer3_router&#45;&gt;layer3_expert_7_gate -->
<g id="edge556" class="edge">
<title>layer3_router&#45;&gt;layer3_expert_7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M62776.03,-265.5C62808.43,-265.5 62844.49,-265.5 62874.83,-265.5"/>
<polygon fill="black" stroke="black" points="62874.88,-269 62884.88,-265.5 62874.88,-262 62874.88,-269"/>
<text text-anchor="middle" x="62830.5" y="-272.3" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer3_expert_0_up -->
<g id="node318" class="node">
<title>layer3_expert_0_up</title>
<path fill="lightcoral" stroke="black" d="M68772.5,-299.5C68772.5,-299.5 68656.5,-299.5 68656.5,-299.5 68650.5,-299.5 68644.5,-293.5 68644.5,-287.5 68644.5,-287.5 68644.5,-243.5 68644.5,-243.5 68644.5,-237.5 68650.5,-231.5 68656.5,-231.5 68656.5,-231.5 68772.5,-231.5 68772.5,-231.5 68778.5,-231.5 68784.5,-237.5 68784.5,-243.5 68784.5,-243.5 68784.5,-287.5 68784.5,-287.5 68784.5,-293.5 68778.5,-299.5 68772.5,-299.5"/>
<text text-anchor="middle" x="68714.5" y="-284.3" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="68714.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="68714.5" y="-254.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="68714.5" y="-239.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_expert_0_gate&#45;&gt;layer3_expert_0_up -->
<g id="edge517" class="edge">
<title>layer3_expert_0_gate&#45;&gt;layer3_expert_0_up</title>
<path fill="none" stroke="black" d="M68609.12,-265.5C68617.41,-265.5 68625.7,-265.5 68633.99,-265.5"/>
<polygon fill="black" stroke="black" points="68634.11,-269 68644.11,-265.5 68634.11,-262 68634.11,-269"/>
</g>
<!-- layer3_expert_1_up -->
<g id="node322" class="node">
<title>layer3_expert_1_up</title>
<path fill="lightcoral" stroke="black" d="M67971.5,-299.5C67971.5,-299.5 67855.5,-299.5 67855.5,-299.5 67849.5,-299.5 67843.5,-293.5 67843.5,-287.5 67843.5,-287.5 67843.5,-243.5 67843.5,-243.5 67843.5,-237.5 67849.5,-231.5 67855.5,-231.5 67855.5,-231.5 67971.5,-231.5 67971.5,-231.5 67977.5,-231.5 67983.5,-237.5 67983.5,-243.5 67983.5,-243.5 67983.5,-287.5 67983.5,-287.5 67983.5,-293.5 67977.5,-299.5 67971.5,-299.5"/>
<text text-anchor="middle" x="67913.5" y="-284.3" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="67913.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="67913.5" y="-254.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="67913.5" y="-239.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_expert_1_gate&#45;&gt;layer3_expert_1_up -->
<g id="edge522" class="edge">
<title>layer3_expert_1_gate&#45;&gt;layer3_expert_1_up</title>
<path fill="none" stroke="black" d="M67808.12,-265.5C67816.41,-265.5 67824.7,-265.5 67832.99,-265.5"/>
<polygon fill="black" stroke="black" points="67833.11,-269 67843.11,-265.5 67833.11,-262 67833.11,-269"/>
</g>
<!-- layer3_expert_2_up -->
<g id="node326" class="node">
<title>layer3_expert_2_up</title>
<path fill="lightcoral" stroke="black" d="M67170.5,-299.5C67170.5,-299.5 67054.5,-299.5 67054.5,-299.5 67048.5,-299.5 67042.5,-293.5 67042.5,-287.5 67042.5,-287.5 67042.5,-243.5 67042.5,-243.5 67042.5,-237.5 67048.5,-231.5 67054.5,-231.5 67054.5,-231.5 67170.5,-231.5 67170.5,-231.5 67176.5,-231.5 67182.5,-237.5 67182.5,-243.5 67182.5,-243.5 67182.5,-287.5 67182.5,-287.5 67182.5,-293.5 67176.5,-299.5 67170.5,-299.5"/>
<text text-anchor="middle" x="67112.5" y="-284.3" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="67112.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="67112.5" y="-254.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="67112.5" y="-239.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_expert_2_gate&#45;&gt;layer3_expert_2_up -->
<g id="edge527" class="edge">
<title>layer3_expert_2_gate&#45;&gt;layer3_expert_2_up</title>
<path fill="none" stroke="black" d="M67007.12,-265.5C67015.41,-265.5 67023.7,-265.5 67031.99,-265.5"/>
<polygon fill="black" stroke="black" points="67032.11,-269 67042.11,-265.5 67032.11,-262 67032.11,-269"/>
</g>
<!-- layer3_expert_3_up -->
<g id="node330" class="node">
<title>layer3_expert_3_up</title>
<path fill="lightcoral" stroke="black" d="M66369.5,-299.5C66369.5,-299.5 66253.5,-299.5 66253.5,-299.5 66247.5,-299.5 66241.5,-293.5 66241.5,-287.5 66241.5,-287.5 66241.5,-243.5 66241.5,-243.5 66241.5,-237.5 66247.5,-231.5 66253.5,-231.5 66253.5,-231.5 66369.5,-231.5 66369.5,-231.5 66375.5,-231.5 66381.5,-237.5 66381.5,-243.5 66381.5,-243.5 66381.5,-287.5 66381.5,-287.5 66381.5,-293.5 66375.5,-299.5 66369.5,-299.5"/>
<text text-anchor="middle" x="66311.5" y="-284.3" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="66311.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="66311.5" y="-254.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="66311.5" y="-239.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_expert_3_gate&#45;&gt;layer3_expert_3_up -->
<g id="edge532" class="edge">
<title>layer3_expert_3_gate&#45;&gt;layer3_expert_3_up</title>
<path fill="none" stroke="black" d="M66206.12,-265.5C66214.41,-265.5 66222.7,-265.5 66230.99,-265.5"/>
<polygon fill="black" stroke="black" points="66231.11,-269 66241.11,-265.5 66231.11,-262 66231.11,-269"/>
</g>
<!-- layer3_expert_4_up -->
<g id="node334" class="node">
<title>layer3_expert_4_up</title>
<path fill="lightcoral" stroke="black" d="M65568.5,-299.5C65568.5,-299.5 65452.5,-299.5 65452.5,-299.5 65446.5,-299.5 65440.5,-293.5 65440.5,-287.5 65440.5,-287.5 65440.5,-243.5 65440.5,-243.5 65440.5,-237.5 65446.5,-231.5 65452.5,-231.5 65452.5,-231.5 65568.5,-231.5 65568.5,-231.5 65574.5,-231.5 65580.5,-237.5 65580.5,-243.5 65580.5,-243.5 65580.5,-287.5 65580.5,-287.5 65580.5,-293.5 65574.5,-299.5 65568.5,-299.5"/>
<text text-anchor="middle" x="65510.5" y="-284.3" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="65510.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="65510.5" y="-254.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="65510.5" y="-239.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_expert_4_gate&#45;&gt;layer3_expert_4_up -->
<g id="edge537" class="edge">
<title>layer3_expert_4_gate&#45;&gt;layer3_expert_4_up</title>
<path fill="none" stroke="black" d="M65405.12,-265.5C65413.41,-265.5 65421.7,-265.5 65429.99,-265.5"/>
<polygon fill="black" stroke="black" points="65430.11,-269 65440.11,-265.5 65430.11,-262 65430.11,-269"/>
</g>
<!-- layer3_expert_5_up -->
<g id="node338" class="node">
<title>layer3_expert_5_up</title>
<path fill="lightcoral" stroke="black" d="M64767.5,-299.5C64767.5,-299.5 64651.5,-299.5 64651.5,-299.5 64645.5,-299.5 64639.5,-293.5 64639.5,-287.5 64639.5,-287.5 64639.5,-243.5 64639.5,-243.5 64639.5,-237.5 64645.5,-231.5 64651.5,-231.5 64651.5,-231.5 64767.5,-231.5 64767.5,-231.5 64773.5,-231.5 64779.5,-237.5 64779.5,-243.5 64779.5,-243.5 64779.5,-287.5 64779.5,-287.5 64779.5,-293.5 64773.5,-299.5 64767.5,-299.5"/>
<text text-anchor="middle" x="64709.5" y="-284.3" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="64709.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="64709.5" y="-254.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="64709.5" y="-239.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_expert_5_gate&#45;&gt;layer3_expert_5_up -->
<g id="edge542" class="edge">
<title>layer3_expert_5_gate&#45;&gt;layer3_expert_5_up</title>
<path fill="none" stroke="black" d="M64604.12,-265.5C64612.41,-265.5 64620.7,-265.5 64628.99,-265.5"/>
<polygon fill="black" stroke="black" points="64629.11,-269 64639.11,-265.5 64629.11,-262 64629.11,-269"/>
</g>
<!-- layer3_expert_6_up -->
<g id="node342" class="node">
<title>layer3_expert_6_up</title>
<path fill="lightcoral" stroke="black" d="M63966.5,-299.5C63966.5,-299.5 63850.5,-299.5 63850.5,-299.5 63844.5,-299.5 63838.5,-293.5 63838.5,-287.5 63838.5,-287.5 63838.5,-243.5 63838.5,-243.5 63838.5,-237.5 63844.5,-231.5 63850.5,-231.5 63850.5,-231.5 63966.5,-231.5 63966.5,-231.5 63972.5,-231.5 63978.5,-237.5 63978.5,-243.5 63978.5,-243.5 63978.5,-287.5 63978.5,-287.5 63978.5,-293.5 63972.5,-299.5 63966.5,-299.5"/>
<text text-anchor="middle" x="63908.5" y="-284.3" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="63908.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="63908.5" y="-254.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="63908.5" y="-239.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_expert_6_gate&#45;&gt;layer3_expert_6_up -->
<g id="edge547" class="edge">
<title>layer3_expert_6_gate&#45;&gt;layer3_expert_6_up</title>
<path fill="none" stroke="black" d="M63803.12,-265.5C63811.41,-265.5 63819.7,-265.5 63827.99,-265.5"/>
<polygon fill="black" stroke="black" points="63828.11,-269 63838.11,-265.5 63828.11,-262 63828.11,-269"/>
</g>
<!-- layer3_expert_7_up -->
<g id="node346" class="node">
<title>layer3_expert_7_up</title>
<path fill="lightcoral" stroke="black" d="M63165.5,-299.5C63165.5,-299.5 63049.5,-299.5 63049.5,-299.5 63043.5,-299.5 63037.5,-293.5 63037.5,-287.5 63037.5,-287.5 63037.5,-243.5 63037.5,-243.5 63037.5,-237.5 63043.5,-231.5 63049.5,-231.5 63049.5,-231.5 63165.5,-231.5 63165.5,-231.5 63171.5,-231.5 63177.5,-237.5 63177.5,-243.5 63177.5,-243.5 63177.5,-287.5 63177.5,-287.5 63177.5,-293.5 63171.5,-299.5 63165.5,-299.5"/>
<text text-anchor="middle" x="63107.5" y="-284.3" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="63107.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="63107.5" y="-254.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="63107.5" y="-239.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer3_expert_7_gate&#45;&gt;layer3_expert_7_up -->
<g id="edge552" class="edge">
<title>layer3_expert_7_gate&#45;&gt;layer3_expert_7_up</title>
<path fill="none" stroke="black" d="M63002.12,-265.5C63010.41,-265.5 63018.7,-265.5 63026.99,-265.5"/>
<polygon fill="black" stroke="black" points="63027.11,-269 63037.11,-265.5 63027.11,-262 63027.11,-269"/>
</g>
<!-- layer3_moe_agg -->
<g id="node295" class="node">
<title>layer3_moe_agg</title>
<path fill="lightpink" stroke="black" d="M69440.5,-307C69440.5,-307 69322.5,-307 69322.5,-307 69316.5,-307 69310.5,-301 69310.5,-295 69310.5,-295 69310.5,-236 69310.5,-236 69310.5,-230 69316.5,-224 69322.5,-224 69322.5,-224 69440.5,-224 69440.5,-224 69446.5,-224 69452.5,-230 69452.5,-236 69452.5,-236 69452.5,-295 69452.5,-295 69452.5,-301 69446.5,-307 69440.5,-307"/>
<text text-anchor="middle" x="69381.5" y="-291.8" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="69381.5" y="-276.8" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="69381.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="69381.5" y="-246.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="69381.5" y="-231.8" font-family="Times,serif" font-size="14.00">(AllReduce)</text>
</g>
<!-- layer3_moe_agg&#45;&gt;layer3_residual2 -->
<g id="edge446" class="edge">
<title>layer3_moe_agg&#45;&gt;layer3_residual2</title>
<path fill="none" stroke="black" d="M69452.8,-265.5C69461.21,-265.5 69469.62,-265.5 69478.03,-265.5"/>
<polygon fill="black" stroke="black" points="69478.29,-269 69488.29,-265.5 69478.29,-262 69478.29,-269"/>
</g>
<!-- layer4_ln1 -->
<g id="node350" class="node">
<title>layer4_ln1</title>
<path fill="lightyellow" stroke="black" d="M69594,-158C69594,-158 69507,-158 69507,-158 69501,-158 69495,-152 69495,-146 69495,-146 69495,-117 69495,-117 69495,-111 69501,-105 69507,-105 69507,-105 69594,-105 69594,-105 69600,-105 69606,-111 69606,-117 69606,-117 69606,-146 69606,-146 69606,-152 69600,-158 69594,-158"/>
<text text-anchor="middle" x="69550.5" y="-142.8" font-family="Times,serif" font-size="14.00">LayerNorm 4</text>
<text text-anchor="middle" x="69550.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="69550.5" y="-112.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer3_residual2&#45;&gt;layer4_ln1 -->
<g id="edge565" class="edge">
<title>layer3_residual2&#45;&gt;layer4_ln1</title>
<path fill="none" stroke="black" d="M69550.5,-238.74C69550.5,-218.66 69550.5,-190.54 69550.5,-168.28"/>
<polygon fill="black" stroke="black" points="69554,-168.2 69550.5,-158.2 69547,-168.2 69554,-168.2"/>
</g>
<!-- layer3_concat_dim_0 -->
<g id="node313" class="node">
<title>layer3_concat_dim_0</title>
<path fill="lightpink" stroke="black" d="M61862.5,-307C61862.5,-307 61740.5,-307 61740.5,-307 61734.5,-307 61728.5,-301 61728.5,-295 61728.5,-295 61728.5,-236 61728.5,-236 61728.5,-230 61734.5,-224 61740.5,-224 61740.5,-224 61862.5,-224 61862.5,-224 61868.5,-224 61874.5,-230 61874.5,-236 61874.5,-236 61874.5,-295 61874.5,-295 61874.5,-301 61868.5,-307 61862.5,-307"/>
<text text-anchor="middle" x="61801.5" y="-291.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="61801.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="61801.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 2048]</text>
<text text-anchor="middle" x="61801.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;3</text>
<text text-anchor="middle" x="61801.5" y="-231.8" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer3_attn_0_0&#45;&gt;layer3_concat_dim_0 -->
<g id="edge496" class="edge">
<title>layer3_attn_0_0&#45;&gt;layer3_concat_dim_0</title>
<path fill="none" stroke="black" d="M61693.02,-265.5C61701.35,-265.5 61709.69,-265.5 61718.02,-265.5"/>
<polygon fill="black" stroke="black" points="61718.19,-269 61728.19,-265.5 61718.19,-262 61718.19,-269"/>
</g>
<!-- layer3_attn_0_1&#45;&gt;layer3_concat_dim_0 -->
<g id="edge497" class="edge">
<title>layer3_attn_0_1&#45;&gt;layer3_concat_dim_0</title>
<path fill="none" stroke="black" d="M60719.72,-299.57C60740.99,-312.59 60766.93,-325.89 60792.5,-332.5 60889.32,-357.52 61596.27,-359.71 61692.5,-332.5 61708.17,-328.07 61723.79,-320.69 61738.12,-312.4"/>
<polygon fill="black" stroke="black" points="61740.1,-315.3 61746.87,-307.14 61736.49,-309.3 61740.1,-315.3"/>
</g>
<!-- layer3_attn_0_2&#45;&gt;layer3_concat_dim_0 -->
<g id="edge498" class="edge">
<title>layer3_attn_0_2&#45;&gt;layer3_concat_dim_0</title>
<path fill="none" stroke="black" d="M59801.72,-299.57C59822.99,-312.59 59848.93,-325.89 59874.5,-332.5 59972.29,-357.77 61595.31,-359.98 61692.5,-332.5 61708.17,-328.07 61723.79,-320.69 61738.12,-312.4"/>
<polygon fill="black" stroke="black" points="61740.1,-315.3 61746.87,-307.14 61736.49,-309.3 61740.1,-315.3"/>
</g>
<!-- layer3_attn_0_3&#45;&gt;layer3_concat_dim_0 -->
<g id="edge499" class="edge">
<title>layer3_attn_0_3&#45;&gt;layer3_concat_dim_0</title>
<path fill="none" stroke="black" d="M58883.72,-299.57C58904.99,-312.59 58930.93,-325.89 58956.5,-332.5 59030.08,-351.51 61619.37,-353.18 61692.5,-332.5 61708.17,-328.07 61723.79,-320.69 61738.12,-312.4"/>
<polygon fill="black" stroke="black" points="61740.1,-315.3 61746.87,-307.14 61736.49,-309.3 61740.1,-315.3"/>
</g>
<!-- layer3_concat_dim_1 -->
<g id="node314" class="node">
<title>layer3_concat_dim_1</title>
<path fill="lightpink" stroke="black" d="M58008.5,-307C58008.5,-307 57886.5,-307 57886.5,-307 57880.5,-307 57874.5,-301 57874.5,-295 57874.5,-295 57874.5,-236 57874.5,-236 57874.5,-230 57880.5,-224 57886.5,-224 57886.5,-224 58008.5,-224 58008.5,-224 58014.5,-224 58020.5,-230 58020.5,-236 58020.5,-236 58020.5,-295 58020.5,-295 58020.5,-301 58014.5,-307 58008.5,-307"/>
<text text-anchor="middle" x="57947.5" y="-291.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="57947.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="57947.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 2048]</text>
<text text-anchor="middle" x="57947.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPUs 4&#45;7</text>
<text text-anchor="middle" x="57947.5" y="-231.8" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer3_attn_1_0&#45;&gt;layer3_concat_dim_1 -->
<g id="edge500" class="edge">
<title>layer3_attn_1_0&#45;&gt;layer3_concat_dim_1</title>
<path fill="none" stroke="black" d="M57839.02,-265.5C57847.35,-265.5 57855.69,-265.5 57864.02,-265.5"/>
<polygon fill="black" stroke="black" points="57864.19,-269 57874.19,-265.5 57864.19,-262 57864.19,-269"/>
</g>
<!-- layer3_attn_1_1&#45;&gt;layer3_concat_dim_1 -->
<g id="edge501" class="edge">
<title>layer3_attn_1_1&#45;&gt;layer3_concat_dim_1</title>
<path fill="none" stroke="black" d="M56865.72,-299.57C56886.99,-312.59 56912.93,-325.89 56938.5,-332.5 57035.32,-357.52 57742.27,-359.71 57838.5,-332.5 57854.17,-328.07 57869.79,-320.69 57884.12,-312.4"/>
<polygon fill="black" stroke="black" points="57886.1,-315.3 57892.87,-307.14 57882.49,-309.3 57886.1,-315.3"/>
</g>
<!-- layer3_attn_1_2&#45;&gt;layer3_concat_dim_1 -->
<g id="edge502" class="edge">
<title>layer3_attn_1_2&#45;&gt;layer3_concat_dim_1</title>
<path fill="none" stroke="black" d="M55947.72,-299.57C55968.99,-312.59 55994.93,-325.89 56020.5,-332.5 56118.29,-357.77 57741.31,-359.98 57838.5,-332.5 57854.17,-328.07 57869.79,-320.69 57884.12,-312.4"/>
<polygon fill="black" stroke="black" points="57886.1,-315.3 57892.87,-307.14 57882.49,-309.3 57886.1,-315.3"/>
</g>
<!-- layer3_attn_1_3&#45;&gt;layer3_concat_dim_1 -->
<g id="edge503" class="edge">
<title>layer3_attn_1_3&#45;&gt;layer3_concat_dim_1</title>
<path fill="none" stroke="black" d="M55029.72,-299.57C55050.99,-312.59 55076.93,-325.89 55102.5,-332.5 55176.08,-351.51 57765.37,-353.18 57838.5,-332.5 57854.17,-328.07 57869.79,-320.69 57884.12,-312.4"/>
<polygon fill="black" stroke="black" points="57886.1,-315.3 57892.87,-307.14 57882.49,-309.3 57886.1,-315.3"/>
</g>
<!-- layer3_concat_dim_2 -->
<g id="node315" class="node">
<title>layer3_concat_dim_2</title>
<path fill="lightpink" stroke="black" d="M54154.5,-307C54154.5,-307 54032.5,-307 54032.5,-307 54026.5,-307 54020.5,-301 54020.5,-295 54020.5,-295 54020.5,-236 54020.5,-236 54020.5,-230 54026.5,-224 54032.5,-224 54032.5,-224 54154.5,-224 54154.5,-224 54160.5,-224 54166.5,-230 54166.5,-236 54166.5,-236 54166.5,-295 54166.5,-295 54166.5,-301 54160.5,-307 54154.5,-307"/>
<text text-anchor="middle" x="54093.5" y="-291.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="54093.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="54093.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 2048]</text>
<text text-anchor="middle" x="54093.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;11</text>
<text text-anchor="middle" x="54093.5" y="-231.8" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer3_attn_2_0&#45;&gt;layer3_concat_dim_2 -->
<g id="edge504" class="edge">
<title>layer3_attn_2_0&#45;&gt;layer3_concat_dim_2</title>
<path fill="none" stroke="black" d="M53985.02,-265.5C53993.35,-265.5 54001.69,-265.5 54010.02,-265.5"/>
<polygon fill="black" stroke="black" points="54010.19,-269 54020.19,-265.5 54010.19,-262 54010.19,-269"/>
</g>
<!-- layer3_attn_2_1&#45;&gt;layer3_concat_dim_2 -->
<g id="edge505" class="edge">
<title>layer3_attn_2_1&#45;&gt;layer3_concat_dim_2</title>
<path fill="none" stroke="black" d="M53011.72,-299.57C53032.99,-312.59 53058.93,-325.89 53084.5,-332.5 53181.32,-357.52 53888.27,-359.71 53984.5,-332.5 54000.17,-328.07 54015.79,-320.69 54030.12,-312.4"/>
<polygon fill="black" stroke="black" points="54032.1,-315.3 54038.87,-307.14 54028.49,-309.3 54032.1,-315.3"/>
</g>
<!-- layer3_attn_2_2&#45;&gt;layer3_concat_dim_2 -->
<g id="edge506" class="edge">
<title>layer3_attn_2_2&#45;&gt;layer3_concat_dim_2</title>
<path fill="none" stroke="black" d="M52093.72,-299.57C52114.99,-312.59 52140.93,-325.89 52166.5,-332.5 52264.29,-357.77 53887.31,-359.98 53984.5,-332.5 54000.17,-328.07 54015.79,-320.69 54030.12,-312.4"/>
<polygon fill="black" stroke="black" points="54032.1,-315.3 54038.87,-307.14 54028.49,-309.3 54032.1,-315.3"/>
</g>
<!-- layer3_attn_2_3&#45;&gt;layer3_concat_dim_2 -->
<g id="edge507" class="edge">
<title>layer3_attn_2_3&#45;&gt;layer3_concat_dim_2</title>
<path fill="none" stroke="black" d="M51175.72,-299.57C51196.99,-312.59 51222.93,-325.89 51248.5,-332.5 51322.08,-351.51 53911.37,-353.18 53984.5,-332.5 54000.17,-328.07 54015.79,-320.69 54030.12,-312.4"/>
<polygon fill="black" stroke="black" points="54032.1,-315.3 54038.87,-307.14 54028.49,-309.3 54032.1,-315.3"/>
</g>
<!-- layer3_concat_dim_3 -->
<g id="node316" class="node">
<title>layer3_concat_dim_3</title>
<path fill="lightpink" stroke="black" d="M50300.5,-307C50300.5,-307 50178.5,-307 50178.5,-307 50172.5,-307 50166.5,-301 50166.5,-295 50166.5,-295 50166.5,-236 50166.5,-236 50166.5,-230 50172.5,-224 50178.5,-224 50178.5,-224 50300.5,-224 50300.5,-224 50306.5,-224 50312.5,-230 50312.5,-236 50312.5,-236 50312.5,-295 50312.5,-295 50312.5,-301 50306.5,-307 50300.5,-307"/>
<text text-anchor="middle" x="50239.5" y="-291.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="50239.5" y="-276.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="50239.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 2048]</text>
<text text-anchor="middle" x="50239.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPUs 12&#45;15</text>
<text text-anchor="middle" x="50239.5" y="-231.8" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer3_attn_3_0&#45;&gt;layer3_concat_dim_3 -->
<g id="edge508" class="edge">
<title>layer3_attn_3_0&#45;&gt;layer3_concat_dim_3</title>
<path fill="none" stroke="black" d="M50131.02,-265.5C50139.35,-265.5 50147.69,-265.5 50156.02,-265.5"/>
<polygon fill="black" stroke="black" points="50156.19,-269 50166.19,-265.5 50156.19,-262 50156.19,-269"/>
</g>
<!-- layer3_attn_3_1&#45;&gt;layer3_concat_dim_3 -->
<g id="edge509" class="edge">
<title>layer3_attn_3_1&#45;&gt;layer3_concat_dim_3</title>
<path fill="none" stroke="black" d="M49157.72,-299.57C49178.99,-312.59 49204.93,-325.89 49230.5,-332.5 49327.32,-357.52 50034.27,-359.71 50130.5,-332.5 50146.17,-328.07 50161.79,-320.69 50176.12,-312.4"/>
<polygon fill="black" stroke="black" points="50178.1,-315.3 50184.87,-307.14 50174.49,-309.3 50178.1,-315.3"/>
</g>
<!-- layer3_attn_3_2&#45;&gt;layer3_concat_dim_3 -->
<g id="edge510" class="edge">
<title>layer3_attn_3_2&#45;&gt;layer3_concat_dim_3</title>
<path fill="none" stroke="black" d="M48239.72,-299.57C48260.99,-312.59 48286.93,-325.89 48312.5,-332.5 48410.29,-357.77 50033.31,-359.98 50130.5,-332.5 50146.17,-328.07 50161.79,-320.69 50176.12,-312.4"/>
<polygon fill="black" stroke="black" points="50178.1,-315.3 50184.87,-307.14 50174.49,-309.3 50178.1,-315.3"/>
</g>
<!-- layer3_attn_3_3&#45;&gt;layer3_concat_dim_3 -->
<g id="edge511" class="edge">
<title>layer3_attn_3_3&#45;&gt;layer3_concat_dim_3</title>
<path fill="none" stroke="black" d="M47321.72,-299.57C47342.99,-312.59 47368.93,-325.89 47394.5,-332.5 47468.08,-351.51 50057.37,-353.18 50130.5,-332.5 50146.17,-328.07 50161.79,-320.69 50176.12,-312.4"/>
<polygon fill="black" stroke="black" points="50178.1,-315.3 50184.87,-307.14 50174.49,-309.3 50178.1,-315.3"/>
</g>
<!-- layer3_concat_heads -->
<g id="node317" class="node">
<title>layer3_concat_heads</title>
<path fill="lightpink" stroke="black" d="M62062.5,-299.5C62062.5,-299.5 61922.5,-299.5 61922.5,-299.5 61916.5,-299.5 61910.5,-293.5 61910.5,-287.5 61910.5,-287.5 61910.5,-243.5 61910.5,-243.5 61910.5,-237.5 61916.5,-231.5 61922.5,-231.5 61922.5,-231.5 62062.5,-231.5 62062.5,-231.5 62068.5,-231.5 62074.5,-237.5 62074.5,-243.5 62074.5,-243.5 62074.5,-287.5 62074.5,-287.5 62074.5,-293.5 62068.5,-299.5 62062.5,-299.5"/>
<text text-anchor="middle" x="61992.5" y="-284.3" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="61992.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="61992.5" y="-254.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="61992.5" y="-239.3" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer3_concat_dim_0&#45;&gt;layer3_concat_heads -->
<g id="edge512" class="edge">
<title>layer3_concat_dim_0&#45;&gt;layer3_concat_heads</title>
<path fill="none" stroke="black" d="M61874.62,-265.5C61883.02,-265.5 61891.42,-265.5 61899.82,-265.5"/>
<polygon fill="black" stroke="black" points="61900.07,-269 61910.07,-265.5 61900.07,-262 61900.07,-269"/>
</g>
<!-- layer3_concat_dim_1&#45;&gt;layer3_concat_heads -->
<g id="edge513" class="edge">
<title>layer3_concat_dim_1&#45;&gt;layer3_concat_heads</title>
<path fill="none" stroke="black" d="M57992.44,-307.23C58006.22,-317.51 58022.1,-327.11 58038.5,-332.5 58139.74,-365.75 61771.48,-359.71 61874.5,-332.5 61896.13,-326.79 61917.95,-316.09 61936.84,-304.9"/>
<polygon fill="black" stroke="black" points="61938.87,-307.76 61945.58,-299.56 61935.23,-301.79 61938.87,-307.76"/>
</g>
<!-- layer3_concat_dim_2&#45;&gt;layer3_concat_heads -->
<g id="edge514" class="edge">
<title>layer3_concat_dim_2&#45;&gt;layer3_concat_heads</title>
<path fill="none" stroke="black" d="M54138.44,-307.23C54152.22,-317.51 54168.1,-327.11 54184.5,-332.5 54285.97,-365.83 61771.23,-359.77 61874.5,-332.5 61896.13,-326.79 61917.95,-316.09 61936.84,-304.9"/>
<polygon fill="black" stroke="black" points="61938.87,-307.76 61945.58,-299.56 61935.23,-301.79 61938.87,-307.76"/>
</g>
<!-- layer3_concat_dim_3&#45;&gt;layer3_concat_heads -->
<g id="edge515" class="edge">
<title>layer3_concat_dim_3&#45;&gt;layer3_concat_heads</title>
<path fill="none" stroke="black" d="M50284.44,-307.23C50298.22,-317.51 50314.1,-327.11 50330.5,-332.5 50406.66,-357.51 61796.99,-352.97 61874.5,-332.5 61896.13,-326.79 61917.95,-316.09 61936.84,-304.9"/>
<polygon fill="black" stroke="black" points="61938.87,-307.76 61945.58,-299.56 61935.23,-301.79 61938.87,-307.76"/>
</g>
<!-- layer3_concat_heads&#45;&gt;layer3_out_proj -->
<g id="edge516" class="edge">
<title>layer3_concat_heads&#45;&gt;layer3_out_proj</title>
<path fill="none" stroke="black" d="M62074.51,-265.5C62083.1,-265.5 62091.69,-265.5 62100.28,-265.5"/>
<polygon fill="black" stroke="black" points="62100.37,-269 62110.37,-265.5 62100.37,-262 62100.37,-269"/>
</g>
<!-- layer3_expert_0_act -->
<g id="node319" class="node">
<title>layer3_expert_0_act</title>
<path fill="lightyellow" stroke="black" d="M68933,-292C68933,-292 68832,-292 68832,-292 68826,-292 68820,-286 68820,-280 68820,-280 68820,-251 68820,-251 68820,-245 68826,-239 68832,-239 68832,-239 68933,-239 68933,-239 68939,-239 68945,-245 68945,-251 68945,-251 68945,-280 68945,-280 68945,-286 68939,-292 68933,-292"/>
<text text-anchor="middle" x="68882.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="68882.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="68882.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_expert_0_up&#45;&gt;layer3_expert_0_act -->
<g id="edge518" class="edge">
<title>layer3_expert_0_up&#45;&gt;layer3_expert_0_act</title>
<path fill="none" stroke="black" d="M68784.72,-265.5C68793.05,-265.5 68801.37,-265.5 68809.7,-265.5"/>
<polygon fill="black" stroke="black" points="68809.86,-269 68819.86,-265.5 68809.86,-262 68809.86,-269"/>
</g>
<!-- layer3_expert_0_down -->
<g id="node320" class="node">
<title>layer3_expert_0_down</title>
<path fill="lightcoral" stroke="black" d="M69092.5,-299.5C69092.5,-299.5 68992.5,-299.5 68992.5,-299.5 68986.5,-299.5 68980.5,-293.5 68980.5,-287.5 68980.5,-287.5 68980.5,-243.5 68980.5,-243.5 68980.5,-237.5 68986.5,-231.5 68992.5,-231.5 68992.5,-231.5 69092.5,-231.5 69092.5,-231.5 69098.5,-231.5 69104.5,-237.5 69104.5,-243.5 69104.5,-243.5 69104.5,-287.5 69104.5,-287.5 69104.5,-293.5 69098.5,-299.5 69092.5,-299.5"/>
<text text-anchor="middle" x="69042.5" y="-284.3" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="69042.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="69042.5" y="-254.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="69042.5" y="-239.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer3_expert_0_act&#45;&gt;layer3_expert_0_down -->
<g id="edge519" class="edge">
<title>layer3_expert_0_act&#45;&gt;layer3_expert_0_down</title>
<path fill="none" stroke="black" d="M68945,-265.5C68953.39,-265.5 68961.79,-265.5 68970.18,-265.5"/>
<polygon fill="black" stroke="black" points="68970.42,-269 68980.42,-265.5 68970.42,-262 68970.42,-269"/>
</g>
<!-- layer3_expert_0_out -->
<g id="node321" class="node">
<title>layer3_expert_0_out</title>
<path fill="lightpink" stroke="black" d="M69262.5,-292C69262.5,-292 69152.5,-292 69152.5,-292 69146.5,-292 69140.5,-286 69140.5,-280 69140.5,-280 69140.5,-251 69140.5,-251 69140.5,-245 69146.5,-239 69152.5,-239 69152.5,-239 69262.5,-239 69262.5,-239 69268.5,-239 69274.5,-245 69274.5,-251 69274.5,-251 69274.5,-280 69274.5,-280 69274.5,-286 69268.5,-292 69262.5,-292"/>
<text text-anchor="middle" x="69207.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 0 Output</text>
<text text-anchor="middle" x="69207.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="69207.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer3_expert_0_down&#45;&gt;layer3_expert_0_out -->
<g id="edge520" class="edge">
<title>layer3_expert_0_down&#45;&gt;layer3_expert_0_out</title>
<path fill="none" stroke="black" d="M69104.7,-265.5C69113.26,-265.5 69121.82,-265.5 69130.39,-265.5"/>
<polygon fill="black" stroke="black" points="69130.44,-269 69140.44,-265.5 69130.44,-262 69130.44,-269"/>
</g>
<!-- layer3_expert_0_out&#45;&gt;layer3_moe_agg -->
<g id="edge557" class="edge">
<title>layer3_expert_0_out&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M69274.79,-265.5C69283.19,-265.5 69291.58,-265.5 69299.98,-265.5"/>
<polygon fill="black" stroke="black" points="69300.22,-269 69310.22,-265.5 69300.22,-262 69300.22,-269"/>
</g>
<!-- layer3_expert_1_act -->
<g id="node323" class="node">
<title>layer3_expert_1_act</title>
<path fill="lightyellow" stroke="black" d="M68132,-292C68132,-292 68031,-292 68031,-292 68025,-292 68019,-286 68019,-280 68019,-280 68019,-251 68019,-251 68019,-245 68025,-239 68031,-239 68031,-239 68132,-239 68132,-239 68138,-239 68144,-245 68144,-251 68144,-251 68144,-280 68144,-280 68144,-286 68138,-292 68132,-292"/>
<text text-anchor="middle" x="68081.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="68081.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="68081.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_expert_1_up&#45;&gt;layer3_expert_1_act -->
<g id="edge523" class="edge">
<title>layer3_expert_1_up&#45;&gt;layer3_expert_1_act</title>
<path fill="none" stroke="black" d="M67983.72,-265.5C67992.05,-265.5 68000.37,-265.5 68008.7,-265.5"/>
<polygon fill="black" stroke="black" points="68008.86,-269 68018.86,-265.5 68008.86,-262 68008.86,-269"/>
</g>
<!-- layer3_expert_1_down -->
<g id="node324" class="node">
<title>layer3_expert_1_down</title>
<path fill="lightcoral" stroke="black" d="M68291.5,-299.5C68291.5,-299.5 68191.5,-299.5 68191.5,-299.5 68185.5,-299.5 68179.5,-293.5 68179.5,-287.5 68179.5,-287.5 68179.5,-243.5 68179.5,-243.5 68179.5,-237.5 68185.5,-231.5 68191.5,-231.5 68191.5,-231.5 68291.5,-231.5 68291.5,-231.5 68297.5,-231.5 68303.5,-237.5 68303.5,-243.5 68303.5,-243.5 68303.5,-287.5 68303.5,-287.5 68303.5,-293.5 68297.5,-299.5 68291.5,-299.5"/>
<text text-anchor="middle" x="68241.5" y="-284.3" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="68241.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="68241.5" y="-254.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="68241.5" y="-239.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer3_expert_1_act&#45;&gt;layer3_expert_1_down -->
<g id="edge524" class="edge">
<title>layer3_expert_1_act&#45;&gt;layer3_expert_1_down</title>
<path fill="none" stroke="black" d="M68144,-265.5C68152.39,-265.5 68160.79,-265.5 68169.18,-265.5"/>
<polygon fill="black" stroke="black" points="68169.42,-269 68179.42,-265.5 68169.42,-262 68169.42,-269"/>
</g>
<!-- layer3_expert_1_out -->
<g id="node325" class="node">
<title>layer3_expert_1_out</title>
<path fill="lightpink" stroke="black" d="M68461.5,-292C68461.5,-292 68351.5,-292 68351.5,-292 68345.5,-292 68339.5,-286 68339.5,-280 68339.5,-280 68339.5,-251 68339.5,-251 68339.5,-245 68345.5,-239 68351.5,-239 68351.5,-239 68461.5,-239 68461.5,-239 68467.5,-239 68473.5,-245 68473.5,-251 68473.5,-251 68473.5,-280 68473.5,-280 68473.5,-286 68467.5,-292 68461.5,-292"/>
<text text-anchor="middle" x="68406.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 1 Output</text>
<text text-anchor="middle" x="68406.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="68406.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer3_expert_1_down&#45;&gt;layer3_expert_1_out -->
<g id="edge525" class="edge">
<title>layer3_expert_1_down&#45;&gt;layer3_expert_1_out</title>
<path fill="none" stroke="black" d="M68303.7,-265.5C68312.26,-265.5 68320.82,-265.5 68329.39,-265.5"/>
<polygon fill="black" stroke="black" points="68329.44,-269 68339.44,-265.5 68329.44,-262 68329.44,-269"/>
</g>
<!-- layer3_expert_1_out&#45;&gt;layer3_moe_agg -->
<g id="edge558" class="edge">
<title>layer3_expert_1_out&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M68430.87,-292.05C68446.53,-307.08 68468.24,-324.44 68491.5,-332.5 68573.7,-361 69190.88,-356.52 69274.5,-332.5 69289.94,-328.07 69305.31,-320.68 69319.38,-312.39"/>
<polygon fill="black" stroke="black" points="69321.26,-315.34 69327.97,-307.14 69317.61,-309.37 69321.26,-315.34"/>
</g>
<!-- layer3_expert_2_act -->
<g id="node327" class="node">
<title>layer3_expert_2_act</title>
<path fill="lightyellow" stroke="black" d="M67331,-292C67331,-292 67230,-292 67230,-292 67224,-292 67218,-286 67218,-280 67218,-280 67218,-251 67218,-251 67218,-245 67224,-239 67230,-239 67230,-239 67331,-239 67331,-239 67337,-239 67343,-245 67343,-251 67343,-251 67343,-280 67343,-280 67343,-286 67337,-292 67331,-292"/>
<text text-anchor="middle" x="67280.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="67280.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="67280.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_expert_2_up&#45;&gt;layer3_expert_2_act -->
<g id="edge528" class="edge">
<title>layer3_expert_2_up&#45;&gt;layer3_expert_2_act</title>
<path fill="none" stroke="black" d="M67182.72,-265.5C67191.05,-265.5 67199.37,-265.5 67207.7,-265.5"/>
<polygon fill="black" stroke="black" points="67207.86,-269 67217.86,-265.5 67207.86,-262 67207.86,-269"/>
</g>
<!-- layer3_expert_2_down -->
<g id="node328" class="node">
<title>layer3_expert_2_down</title>
<path fill="lightcoral" stroke="black" d="M67490.5,-299.5C67490.5,-299.5 67390.5,-299.5 67390.5,-299.5 67384.5,-299.5 67378.5,-293.5 67378.5,-287.5 67378.5,-287.5 67378.5,-243.5 67378.5,-243.5 67378.5,-237.5 67384.5,-231.5 67390.5,-231.5 67390.5,-231.5 67490.5,-231.5 67490.5,-231.5 67496.5,-231.5 67502.5,-237.5 67502.5,-243.5 67502.5,-243.5 67502.5,-287.5 67502.5,-287.5 67502.5,-293.5 67496.5,-299.5 67490.5,-299.5"/>
<text text-anchor="middle" x="67440.5" y="-284.3" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="67440.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="67440.5" y="-254.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="67440.5" y="-239.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer3_expert_2_act&#45;&gt;layer3_expert_2_down -->
<g id="edge529" class="edge">
<title>layer3_expert_2_act&#45;&gt;layer3_expert_2_down</title>
<path fill="none" stroke="black" d="M67343,-265.5C67351.39,-265.5 67359.79,-265.5 67368.18,-265.5"/>
<polygon fill="black" stroke="black" points="67368.42,-269 67378.42,-265.5 67368.42,-262 67368.42,-269"/>
</g>
<!-- layer3_expert_2_out -->
<g id="node329" class="node">
<title>layer3_expert_2_out</title>
<path fill="lightpink" stroke="black" d="M67660.5,-292C67660.5,-292 67550.5,-292 67550.5,-292 67544.5,-292 67538.5,-286 67538.5,-280 67538.5,-280 67538.5,-251 67538.5,-251 67538.5,-245 67544.5,-239 67550.5,-239 67550.5,-239 67660.5,-239 67660.5,-239 67666.5,-239 67672.5,-245 67672.5,-251 67672.5,-251 67672.5,-280 67672.5,-280 67672.5,-286 67666.5,-292 67660.5,-292"/>
<text text-anchor="middle" x="67605.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 2 Output</text>
<text text-anchor="middle" x="67605.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="67605.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer3_expert_2_down&#45;&gt;layer3_expert_2_out -->
<g id="edge530" class="edge">
<title>layer3_expert_2_down&#45;&gt;layer3_expert_2_out</title>
<path fill="none" stroke="black" d="M67502.7,-265.5C67511.26,-265.5 67519.82,-265.5 67528.39,-265.5"/>
<polygon fill="black" stroke="black" points="67528.44,-269 67538.44,-265.5 67528.44,-262 67528.44,-269"/>
</g>
<!-- layer3_expert_2_out&#45;&gt;layer3_moe_agg -->
<g id="edge559" class="edge">
<title>layer3_expert_2_out&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M67629.87,-292.05C67645.53,-307.08 67667.24,-324.44 67690.5,-332.5 67773.64,-361.33 69189.92,-356.8 69274.5,-332.5 69289.94,-328.07 69305.31,-320.68 69319.38,-312.39"/>
<polygon fill="black" stroke="black" points="69321.26,-315.34 69327.97,-307.14 69317.61,-309.37 69321.26,-315.34"/>
</g>
<!-- layer3_expert_3_act -->
<g id="node331" class="node">
<title>layer3_expert_3_act</title>
<path fill="lightyellow" stroke="black" d="M66530,-292C66530,-292 66429,-292 66429,-292 66423,-292 66417,-286 66417,-280 66417,-280 66417,-251 66417,-251 66417,-245 66423,-239 66429,-239 66429,-239 66530,-239 66530,-239 66536,-239 66542,-245 66542,-251 66542,-251 66542,-280 66542,-280 66542,-286 66536,-292 66530,-292"/>
<text text-anchor="middle" x="66479.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="66479.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="66479.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_expert_3_up&#45;&gt;layer3_expert_3_act -->
<g id="edge533" class="edge">
<title>layer3_expert_3_up&#45;&gt;layer3_expert_3_act</title>
<path fill="none" stroke="black" d="M66381.72,-265.5C66390.05,-265.5 66398.37,-265.5 66406.7,-265.5"/>
<polygon fill="black" stroke="black" points="66406.86,-269 66416.86,-265.5 66406.86,-262 66406.86,-269"/>
</g>
<!-- layer3_expert_3_down -->
<g id="node332" class="node">
<title>layer3_expert_3_down</title>
<path fill="lightcoral" stroke="black" d="M66689.5,-299.5C66689.5,-299.5 66589.5,-299.5 66589.5,-299.5 66583.5,-299.5 66577.5,-293.5 66577.5,-287.5 66577.5,-287.5 66577.5,-243.5 66577.5,-243.5 66577.5,-237.5 66583.5,-231.5 66589.5,-231.5 66589.5,-231.5 66689.5,-231.5 66689.5,-231.5 66695.5,-231.5 66701.5,-237.5 66701.5,-243.5 66701.5,-243.5 66701.5,-287.5 66701.5,-287.5 66701.5,-293.5 66695.5,-299.5 66689.5,-299.5"/>
<text text-anchor="middle" x="66639.5" y="-284.3" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="66639.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="66639.5" y="-254.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="66639.5" y="-239.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer3_expert_3_act&#45;&gt;layer3_expert_3_down -->
<g id="edge534" class="edge">
<title>layer3_expert_3_act&#45;&gt;layer3_expert_3_down</title>
<path fill="none" stroke="black" d="M66542,-265.5C66550.39,-265.5 66558.79,-265.5 66567.18,-265.5"/>
<polygon fill="black" stroke="black" points="66567.42,-269 66577.42,-265.5 66567.42,-262 66567.42,-269"/>
</g>
<!-- layer3_expert_3_out -->
<g id="node333" class="node">
<title>layer3_expert_3_out</title>
<path fill="lightpink" stroke="black" d="M66859.5,-292C66859.5,-292 66749.5,-292 66749.5,-292 66743.5,-292 66737.5,-286 66737.5,-280 66737.5,-280 66737.5,-251 66737.5,-251 66737.5,-245 66743.5,-239 66749.5,-239 66749.5,-239 66859.5,-239 66859.5,-239 66865.5,-239 66871.5,-245 66871.5,-251 66871.5,-251 66871.5,-280 66871.5,-280 66871.5,-286 66865.5,-292 66859.5,-292"/>
<text text-anchor="middle" x="66804.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 3 Output</text>
<text text-anchor="middle" x="66804.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="66804.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer3_expert_3_down&#45;&gt;layer3_expert_3_out -->
<g id="edge535" class="edge">
<title>layer3_expert_3_down&#45;&gt;layer3_expert_3_out</title>
<path fill="none" stroke="black" d="M66701.7,-265.5C66710.26,-265.5 66718.82,-265.5 66727.39,-265.5"/>
<polygon fill="black" stroke="black" points="66727.44,-269 66737.44,-265.5 66727.44,-262 66727.44,-269"/>
</g>
<!-- layer3_expert_3_out&#45;&gt;layer3_moe_agg -->
<g id="edge560" class="edge">
<title>layer3_expert_3_out&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M66828.87,-292.05C66844.53,-307.08 66866.24,-324.44 66889.5,-332.5 66952.09,-354.2 69210.82,-350.79 69274.5,-332.5 69289.94,-328.07 69305.31,-320.68 69319.38,-312.39"/>
<polygon fill="black" stroke="black" points="69321.26,-315.34 69327.97,-307.14 69317.61,-309.37 69321.26,-315.34"/>
</g>
<!-- layer3_expert_4_act -->
<g id="node335" class="node">
<title>layer3_expert_4_act</title>
<path fill="lightyellow" stroke="black" d="M65729,-292C65729,-292 65628,-292 65628,-292 65622,-292 65616,-286 65616,-280 65616,-280 65616,-251 65616,-251 65616,-245 65622,-239 65628,-239 65628,-239 65729,-239 65729,-239 65735,-239 65741,-245 65741,-251 65741,-251 65741,-280 65741,-280 65741,-286 65735,-292 65729,-292"/>
<text text-anchor="middle" x="65678.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="65678.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="65678.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_expert_4_up&#45;&gt;layer3_expert_4_act -->
<g id="edge538" class="edge">
<title>layer3_expert_4_up&#45;&gt;layer3_expert_4_act</title>
<path fill="none" stroke="black" d="M65580.72,-265.5C65589.05,-265.5 65597.37,-265.5 65605.7,-265.5"/>
<polygon fill="black" stroke="black" points="65605.86,-269 65615.86,-265.5 65605.86,-262 65605.86,-269"/>
</g>
<!-- layer3_expert_4_down -->
<g id="node336" class="node">
<title>layer3_expert_4_down</title>
<path fill="lightcoral" stroke="black" d="M65888.5,-299.5C65888.5,-299.5 65788.5,-299.5 65788.5,-299.5 65782.5,-299.5 65776.5,-293.5 65776.5,-287.5 65776.5,-287.5 65776.5,-243.5 65776.5,-243.5 65776.5,-237.5 65782.5,-231.5 65788.5,-231.5 65788.5,-231.5 65888.5,-231.5 65888.5,-231.5 65894.5,-231.5 65900.5,-237.5 65900.5,-243.5 65900.5,-243.5 65900.5,-287.5 65900.5,-287.5 65900.5,-293.5 65894.5,-299.5 65888.5,-299.5"/>
<text text-anchor="middle" x="65838.5" y="-284.3" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="65838.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="65838.5" y="-254.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="65838.5" y="-239.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer3_expert_4_act&#45;&gt;layer3_expert_4_down -->
<g id="edge539" class="edge">
<title>layer3_expert_4_act&#45;&gt;layer3_expert_4_down</title>
<path fill="none" stroke="black" d="M65741,-265.5C65749.39,-265.5 65757.79,-265.5 65766.18,-265.5"/>
<polygon fill="black" stroke="black" points="65766.42,-269 65776.42,-265.5 65766.42,-262 65766.42,-269"/>
</g>
<!-- layer3_expert_4_out -->
<g id="node337" class="node">
<title>layer3_expert_4_out</title>
<path fill="lightpink" stroke="black" d="M66058.5,-292C66058.5,-292 65948.5,-292 65948.5,-292 65942.5,-292 65936.5,-286 65936.5,-280 65936.5,-280 65936.5,-251 65936.5,-251 65936.5,-245 65942.5,-239 65948.5,-239 65948.5,-239 66058.5,-239 66058.5,-239 66064.5,-239 66070.5,-245 66070.5,-251 66070.5,-251 66070.5,-280 66070.5,-280 66070.5,-286 66064.5,-292 66058.5,-292"/>
<text text-anchor="middle" x="66003.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 4 Output</text>
<text text-anchor="middle" x="66003.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="66003.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_expert_4_down&#45;&gt;layer3_expert_4_out -->
<g id="edge540" class="edge">
<title>layer3_expert_4_down&#45;&gt;layer3_expert_4_out</title>
<path fill="none" stroke="black" d="M65900.7,-265.5C65909.26,-265.5 65917.82,-265.5 65926.39,-265.5"/>
<polygon fill="black" stroke="black" points="65926.44,-269 65936.44,-265.5 65926.44,-262 65926.44,-269"/>
</g>
<!-- layer3_expert_4_out&#45;&gt;layer3_moe_agg -->
<g id="edge561" class="edge">
<title>layer3_expert_4_out&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M66027.87,-292.05C66043.53,-307.08 66065.24,-324.44 66088.5,-332.5 66172.12,-361.49 69189.44,-356.93 69274.5,-332.5 69289.94,-328.07 69305.31,-320.68 69319.38,-312.39"/>
<polygon fill="black" stroke="black" points="69321.26,-315.34 69327.97,-307.14 69317.61,-309.37 69321.26,-315.34"/>
</g>
<!-- layer3_expert_5_act -->
<g id="node339" class="node">
<title>layer3_expert_5_act</title>
<path fill="lightyellow" stroke="black" d="M64928,-292C64928,-292 64827,-292 64827,-292 64821,-292 64815,-286 64815,-280 64815,-280 64815,-251 64815,-251 64815,-245 64821,-239 64827,-239 64827,-239 64928,-239 64928,-239 64934,-239 64940,-245 64940,-251 64940,-251 64940,-280 64940,-280 64940,-286 64934,-292 64928,-292"/>
<text text-anchor="middle" x="64877.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="64877.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="64877.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_expert_5_up&#45;&gt;layer3_expert_5_act -->
<g id="edge543" class="edge">
<title>layer3_expert_5_up&#45;&gt;layer3_expert_5_act</title>
<path fill="none" stroke="black" d="M64779.72,-265.5C64788.05,-265.5 64796.37,-265.5 64804.7,-265.5"/>
<polygon fill="black" stroke="black" points="64804.86,-269 64814.86,-265.5 64804.86,-262 64804.86,-269"/>
</g>
<!-- layer3_expert_5_down -->
<g id="node340" class="node">
<title>layer3_expert_5_down</title>
<path fill="lightcoral" stroke="black" d="M65087.5,-299.5C65087.5,-299.5 64987.5,-299.5 64987.5,-299.5 64981.5,-299.5 64975.5,-293.5 64975.5,-287.5 64975.5,-287.5 64975.5,-243.5 64975.5,-243.5 64975.5,-237.5 64981.5,-231.5 64987.5,-231.5 64987.5,-231.5 65087.5,-231.5 65087.5,-231.5 65093.5,-231.5 65099.5,-237.5 65099.5,-243.5 65099.5,-243.5 65099.5,-287.5 65099.5,-287.5 65099.5,-293.5 65093.5,-299.5 65087.5,-299.5"/>
<text text-anchor="middle" x="65037.5" y="-284.3" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="65037.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="65037.5" y="-254.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="65037.5" y="-239.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer3_expert_5_act&#45;&gt;layer3_expert_5_down -->
<g id="edge544" class="edge">
<title>layer3_expert_5_act&#45;&gt;layer3_expert_5_down</title>
<path fill="none" stroke="black" d="M64940,-265.5C64948.39,-265.5 64956.79,-265.5 64965.18,-265.5"/>
<polygon fill="black" stroke="black" points="64965.42,-269 64975.42,-265.5 64965.42,-262 64965.42,-269"/>
</g>
<!-- layer3_expert_5_out -->
<g id="node341" class="node">
<title>layer3_expert_5_out</title>
<path fill="lightpink" stroke="black" d="M65257.5,-292C65257.5,-292 65147.5,-292 65147.5,-292 65141.5,-292 65135.5,-286 65135.5,-280 65135.5,-280 65135.5,-251 65135.5,-251 65135.5,-245 65141.5,-239 65147.5,-239 65147.5,-239 65257.5,-239 65257.5,-239 65263.5,-239 65269.5,-245 65269.5,-251 65269.5,-251 65269.5,-280 65269.5,-280 65269.5,-286 65263.5,-292 65257.5,-292"/>
<text text-anchor="middle" x="65202.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 5 Output</text>
<text text-anchor="middle" x="65202.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="65202.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_expert_5_down&#45;&gt;layer3_expert_5_out -->
<g id="edge545" class="edge">
<title>layer3_expert_5_down&#45;&gt;layer3_expert_5_out</title>
<path fill="none" stroke="black" d="M65099.7,-265.5C65108.26,-265.5 65116.82,-265.5 65125.39,-265.5"/>
<polygon fill="black" stroke="black" points="65125.44,-269 65135.44,-265.5 65125.44,-262 65125.44,-269"/>
</g>
<!-- layer3_expert_5_out&#45;&gt;layer3_moe_agg -->
<g id="edge562" class="edge">
<title>layer3_expert_5_out&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M65226.87,-292.05C65242.53,-307.08 65264.24,-324.44 65287.5,-332.5 65392.14,-368.78 69168.05,-363.08 69274.5,-332.5 69289.94,-328.07 69305.31,-320.68 69319.38,-312.39"/>
<polygon fill="black" stroke="black" points="69321.26,-315.34 69327.97,-307.14 69317.61,-309.37 69321.26,-315.34"/>
</g>
<!-- layer3_expert_6_act -->
<g id="node343" class="node">
<title>layer3_expert_6_act</title>
<path fill="lightyellow" stroke="black" d="M64127,-292C64127,-292 64026,-292 64026,-292 64020,-292 64014,-286 64014,-280 64014,-280 64014,-251 64014,-251 64014,-245 64020,-239 64026,-239 64026,-239 64127,-239 64127,-239 64133,-239 64139,-245 64139,-251 64139,-251 64139,-280 64139,-280 64139,-286 64133,-292 64127,-292"/>
<text text-anchor="middle" x="64076.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="64076.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="64076.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_expert_6_up&#45;&gt;layer3_expert_6_act -->
<g id="edge548" class="edge">
<title>layer3_expert_6_up&#45;&gt;layer3_expert_6_act</title>
<path fill="none" stroke="black" d="M63978.72,-265.5C63987.05,-265.5 63995.37,-265.5 64003.7,-265.5"/>
<polygon fill="black" stroke="black" points="64003.86,-269 64013.86,-265.5 64003.86,-262 64003.86,-269"/>
</g>
<!-- layer3_expert_6_down -->
<g id="node344" class="node">
<title>layer3_expert_6_down</title>
<path fill="lightcoral" stroke="black" d="M64286.5,-299.5C64286.5,-299.5 64186.5,-299.5 64186.5,-299.5 64180.5,-299.5 64174.5,-293.5 64174.5,-287.5 64174.5,-287.5 64174.5,-243.5 64174.5,-243.5 64174.5,-237.5 64180.5,-231.5 64186.5,-231.5 64186.5,-231.5 64286.5,-231.5 64286.5,-231.5 64292.5,-231.5 64298.5,-237.5 64298.5,-243.5 64298.5,-243.5 64298.5,-287.5 64298.5,-287.5 64298.5,-293.5 64292.5,-299.5 64286.5,-299.5"/>
<text text-anchor="middle" x="64236.5" y="-284.3" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="64236.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="64236.5" y="-254.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="64236.5" y="-239.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer3_expert_6_act&#45;&gt;layer3_expert_6_down -->
<g id="edge549" class="edge">
<title>layer3_expert_6_act&#45;&gt;layer3_expert_6_down</title>
<path fill="none" stroke="black" d="M64139,-265.5C64147.39,-265.5 64155.79,-265.5 64164.18,-265.5"/>
<polygon fill="black" stroke="black" points="64164.42,-269 64174.42,-265.5 64164.42,-262 64164.42,-269"/>
</g>
<!-- layer3_expert_6_out -->
<g id="node345" class="node">
<title>layer3_expert_6_out</title>
<path fill="lightpink" stroke="black" d="M64456.5,-292C64456.5,-292 64346.5,-292 64346.5,-292 64340.5,-292 64334.5,-286 64334.5,-280 64334.5,-280 64334.5,-251 64334.5,-251 64334.5,-245 64340.5,-239 64346.5,-239 64346.5,-239 64456.5,-239 64456.5,-239 64462.5,-239 64468.5,-245 64468.5,-251 64468.5,-251 64468.5,-280 64468.5,-280 64468.5,-286 64462.5,-292 64456.5,-292"/>
<text text-anchor="middle" x="64401.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 6 Output</text>
<text text-anchor="middle" x="64401.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="64401.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer3_expert_6_down&#45;&gt;layer3_expert_6_out -->
<g id="edge550" class="edge">
<title>layer3_expert_6_down&#45;&gt;layer3_expert_6_out</title>
<path fill="none" stroke="black" d="M64298.7,-265.5C64307.26,-265.5 64315.82,-265.5 64324.39,-265.5"/>
<polygon fill="black" stroke="black" points="64324.44,-269 64334.44,-265.5 64324.44,-262 64324.44,-269"/>
</g>
<!-- layer3_expert_6_out&#45;&gt;layer3_moe_agg -->
<g id="edge563" class="edge">
<title>layer3_expert_6_out&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M64425.87,-292.05C64441.53,-307.08 64463.24,-324.44 64486.5,-332.5 64549.33,-354.29 69210.58,-350.86 69274.5,-332.5 69289.94,-328.07 69305.31,-320.68 69319.38,-312.39"/>
<polygon fill="black" stroke="black" points="69321.26,-315.34 69327.97,-307.14 69317.61,-309.37 69321.26,-315.34"/>
</g>
<!-- layer3_expert_7_act -->
<g id="node347" class="node">
<title>layer3_expert_7_act</title>
<path fill="lightyellow" stroke="black" d="M63326,-292C63326,-292 63225,-292 63225,-292 63219,-292 63213,-286 63213,-280 63213,-280 63213,-251 63213,-251 63213,-245 63219,-239 63225,-239 63225,-239 63326,-239 63326,-239 63332,-239 63338,-245 63338,-251 63338,-251 63338,-280 63338,-280 63338,-286 63332,-292 63326,-292"/>
<text text-anchor="middle" x="63275.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="63275.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="63275.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_expert_7_up&#45;&gt;layer3_expert_7_act -->
<g id="edge553" class="edge">
<title>layer3_expert_7_up&#45;&gt;layer3_expert_7_act</title>
<path fill="none" stroke="black" d="M63177.72,-265.5C63186.05,-265.5 63194.37,-265.5 63202.7,-265.5"/>
<polygon fill="black" stroke="black" points="63202.86,-269 63212.86,-265.5 63202.86,-262 63202.86,-269"/>
</g>
<!-- layer3_expert_7_down -->
<g id="node348" class="node">
<title>layer3_expert_7_down</title>
<path fill="lightcoral" stroke="black" d="M63485.5,-299.5C63485.5,-299.5 63385.5,-299.5 63385.5,-299.5 63379.5,-299.5 63373.5,-293.5 63373.5,-287.5 63373.5,-287.5 63373.5,-243.5 63373.5,-243.5 63373.5,-237.5 63379.5,-231.5 63385.5,-231.5 63385.5,-231.5 63485.5,-231.5 63485.5,-231.5 63491.5,-231.5 63497.5,-237.5 63497.5,-243.5 63497.5,-243.5 63497.5,-287.5 63497.5,-287.5 63497.5,-293.5 63491.5,-299.5 63485.5,-299.5"/>
<text text-anchor="middle" x="63435.5" y="-284.3" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="63435.5" y="-269.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="63435.5" y="-254.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="63435.5" y="-239.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer3_expert_7_act&#45;&gt;layer3_expert_7_down -->
<g id="edge554" class="edge">
<title>layer3_expert_7_act&#45;&gt;layer3_expert_7_down</title>
<path fill="none" stroke="black" d="M63338,-265.5C63346.39,-265.5 63354.79,-265.5 63363.18,-265.5"/>
<polygon fill="black" stroke="black" points="63363.42,-269 63373.42,-265.5 63363.42,-262 63363.42,-269"/>
</g>
<!-- layer3_expert_7_out -->
<g id="node349" class="node">
<title>layer3_expert_7_out</title>
<path fill="lightpink" stroke="black" d="M63655.5,-292C63655.5,-292 63545.5,-292 63545.5,-292 63539.5,-292 63533.5,-286 63533.5,-280 63533.5,-280 63533.5,-251 63533.5,-251 63533.5,-245 63539.5,-239 63545.5,-239 63545.5,-239 63655.5,-239 63655.5,-239 63661.5,-239 63667.5,-245 63667.5,-251 63667.5,-251 63667.5,-280 63667.5,-280 63667.5,-286 63661.5,-292 63655.5,-292"/>
<text text-anchor="middle" x="63600.5" y="-276.8" font-family="Times,serif" font-size="14.00">Expert 7 Output</text>
<text text-anchor="middle" x="63600.5" y="-261.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="63600.5" y="-246.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer3_expert_7_down&#45;&gt;layer3_expert_7_out -->
<g id="edge555" class="edge">
<title>layer3_expert_7_down&#45;&gt;layer3_expert_7_out</title>
<path fill="none" stroke="black" d="M63497.7,-265.5C63506.26,-265.5 63514.82,-265.5 63523.39,-265.5"/>
<polygon fill="black" stroke="black" points="63523.44,-269 63533.44,-265.5 63523.44,-262 63523.44,-269"/>
</g>
<!-- layer3_expert_7_out&#45;&gt;layer3_moe_agg -->
<g id="edge564" class="edge">
<title>layer3_expert_7_out&#45;&gt;layer3_moe_agg</title>
<path fill="none" stroke="black" d="M63624.87,-292.05C63640.53,-307.08 63662.24,-324.44 63685.5,-332.5 63758.84,-357.93 69199.89,-353.93 69274.5,-332.5 69289.94,-328.07 69305.31,-320.68 69319.38,-312.39"/>
<polygon fill="black" stroke="black" points="69321.26,-315.34 69327.97,-307.14 69317.61,-309.37 69321.26,-315.34"/>
</g>
<!-- layer4_q_0_0 -->
<g id="node351" class="node">
<title>layer4_q_0_0</title>
<path fill="lightcoral" stroke="black" d="M84603,-173C84603,-173 84420,-173 84420,-173 84414,-173 84408,-167 84408,-161 84408,-161 84408,-102 84408,-102 84408,-96 84414,-90 84420,-90 84420,-90 84603,-90 84603,-90 84609,-90 84615,-96 84615,-102 84615,-102 84615,-161 84615,-161 84615,-167 84609,-173 84603,-173"/>
<text text-anchor="middle" x="84511.5" y="-157.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="84511.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="84511.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="84511.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="84511.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_q_0_0 -->
<g id="edge566" class="edge">
<title>layer4_ln1&#45;&gt;layer4_q_0_0</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69739.89,-230.2 84291.34,-224.12 84390.5,-198.5 84407.96,-193.99 84425.59,-186.36 84441.78,-177.83"/>
<polygon fill="black" stroke="black" points="84443.52,-180.87 84450.62,-173.01 84440.17,-174.72 84443.52,-180.87"/>
</g>
<!-- layer4_k_0_0 -->
<g id="node352" class="node">
<title>layer4_k_0_0</title>
<path fill="lightcoral" stroke="black" d="M84378,-173C84378,-173 84195,-173 84195,-173 84189,-173 84183,-167 84183,-161 84183,-161 84183,-102 84183,-102 84183,-96 84189,-90 84195,-90 84195,-90 84378,-90 84378,-90 84384,-90 84390,-96 84390,-102 84390,-102 84390,-161 84390,-161 84390,-167 84384,-173 84378,-173"/>
<text text-anchor="middle" x="84286.5" y="-157.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="84286.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="84286.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="84286.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="84286.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_k_0_0 -->
<g id="edge567" class="edge">
<title>layer4_ln1&#45;&gt;layer4_k_0_0</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69738.4,-229.72 84067.85,-223.73 84165.5,-198.5 84182.96,-193.99 84200.59,-186.36 84216.78,-177.83"/>
<polygon fill="black" stroke="black" points="84218.52,-180.87 84225.62,-173.01 84215.17,-174.72 84218.52,-180.87"/>
</g>
<!-- layer4_v_0_0 -->
<g id="node353" class="node">
<title>layer4_v_0_0</title>
<path fill="lightcoral" stroke="black" d="M84153,-173C84153,-173 83970,-173 83970,-173 83964,-173 83958,-167 83958,-161 83958,-161 83958,-102 83958,-102 83958,-96 83964,-90 83970,-90 83970,-90 84153,-90 84153,-90 84159,-90 84165,-96 84165,-102 84165,-102 84165,-161 84165,-161 84165,-167 84159,-173 84153,-173"/>
<text text-anchor="middle" x="84061.5" y="-157.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="84061.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="84061.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="84061.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="84061.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_v_0_0 -->
<g id="edge568" class="edge">
<title>layer4_ln1&#45;&gt;layer4_v_0_0</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69736.91,-229.24 83844.37,-223.34 83940.5,-198.5 83957.96,-193.99 83975.59,-186.36 83991.78,-177.83"/>
<polygon fill="black" stroke="black" points="83993.52,-180.87 84000.62,-173.01 83990.17,-174.72 83993.52,-180.87"/>
</g>
<!-- layer4_q_0_1 -->
<g id="node354" class="node">
<title>layer4_q_0_1</title>
<path fill="lightcoral" stroke="black" d="M83685,-173C83685,-173 83502,-173 83502,-173 83496,-173 83490,-167 83490,-161 83490,-161 83490,-102 83490,-102 83490,-96 83496,-90 83502,-90 83502,-90 83685,-90 83685,-90 83691,-90 83697,-96 83697,-102 83697,-102 83697,-161 83697,-161 83697,-167 83691,-173 83685,-173"/>
<text text-anchor="middle" x="83593.5" y="-157.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="83593.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="83593.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="83593.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="83593.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_q_0_1 -->
<g id="edge569" class="edge">
<title>layer4_ln1&#45;&gt;layer4_q_0_1</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69733.82,-228.23 83379.51,-222.53 83472.5,-198.5 83489.96,-193.99 83507.59,-186.36 83523.78,-177.83"/>
<polygon fill="black" stroke="black" points="83525.52,-180.87 83532.62,-173.01 83522.17,-174.72 83525.52,-180.87"/>
</g>
<!-- layer4_k_0_1 -->
<g id="node355" class="node">
<title>layer4_k_0_1</title>
<path fill="lightcoral" stroke="black" d="M83460,-173C83460,-173 83277,-173 83277,-173 83271,-173 83265,-167 83265,-161 83265,-161 83265,-102 83265,-102 83265,-96 83271,-90 83277,-90 83277,-90 83460,-90 83460,-90 83466,-90 83472,-96 83472,-102 83472,-102 83472,-161 83472,-161 83472,-167 83466,-173 83460,-173"/>
<text text-anchor="middle" x="83368.5" y="-157.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="83368.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="83368.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="83368.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="83368.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_k_0_1 -->
<g id="edge570" class="edge">
<title>layer4_ln1&#45;&gt;layer4_k_0_1</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69732.34,-227.75 83156.02,-222.14 83247.5,-198.5 83264.96,-193.99 83282.59,-186.36 83298.78,-177.83"/>
<polygon fill="black" stroke="black" points="83300.52,-180.87 83307.62,-173.01 83297.17,-174.72 83300.52,-180.87"/>
</g>
<!-- layer4_v_0_1 -->
<g id="node356" class="node">
<title>layer4_v_0_1</title>
<path fill="lightcoral" stroke="black" d="M83235,-173C83235,-173 83052,-173 83052,-173 83046,-173 83040,-167 83040,-161 83040,-161 83040,-102 83040,-102 83040,-96 83046,-90 83052,-90 83052,-90 83235,-90 83235,-90 83241,-90 83247,-96 83247,-102 83247,-102 83247,-161 83247,-161 83247,-167 83241,-173 83235,-173"/>
<text text-anchor="middle" x="83143.5" y="-157.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="83143.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="83143.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="83143.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="83143.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_v_0_1 -->
<g id="edge571" class="edge">
<title>layer4_ln1&#45;&gt;layer4_v_0_1</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69730.85,-227.26 82932.54,-221.74 83022.5,-198.5 83039.96,-193.99 83057.59,-186.36 83073.78,-177.83"/>
<polygon fill="black" stroke="black" points="83075.52,-180.87 83082.62,-173.01 83072.17,-174.72 83075.52,-180.87"/>
</g>
<!-- layer4_q_0_2 -->
<g id="node357" class="node">
<title>layer4_q_0_2</title>
<path fill="lightcoral" stroke="black" d="M82767,-173C82767,-173 82584,-173 82584,-173 82578,-173 82572,-167 82572,-161 82572,-161 82572,-102 82572,-102 82572,-96 82578,-90 82584,-90 82584,-90 82767,-90 82767,-90 82773,-90 82779,-96 82779,-102 82779,-102 82779,-161 82779,-161 82779,-167 82773,-173 82767,-173"/>
<text text-anchor="middle" x="82675.5" y="-157.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="82675.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="82675.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="82675.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="82675.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_q_0_2 -->
<g id="edge572" class="edge">
<title>layer4_ln1&#45;&gt;layer4_q_0_2</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69727.76,-226.26 82467.68,-220.93 82554.5,-198.5 82571.96,-193.99 82589.59,-186.36 82605.78,-177.83"/>
<polygon fill="black" stroke="black" points="82607.52,-180.87 82614.62,-173.01 82604.17,-174.72 82607.52,-180.87"/>
</g>
<!-- layer4_k_0_2 -->
<g id="node358" class="node">
<title>layer4_k_0_2</title>
<path fill="lightcoral" stroke="black" d="M82542,-173C82542,-173 82359,-173 82359,-173 82353,-173 82347,-167 82347,-161 82347,-161 82347,-102 82347,-102 82347,-96 82353,-90 82359,-90 82359,-90 82542,-90 82542,-90 82548,-90 82554,-96 82554,-102 82554,-102 82554,-161 82554,-161 82554,-167 82548,-173 82542,-173"/>
<text text-anchor="middle" x="82450.5" y="-157.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="82450.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="82450.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="82450.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="82450.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_k_0_2 -->
<g id="edge573" class="edge">
<title>layer4_ln1&#45;&gt;layer4_k_0_2</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69726.28,-225.77 82244.2,-220.54 82329.5,-198.5 82346.96,-193.99 82364.59,-186.36 82380.78,-177.83"/>
<polygon fill="black" stroke="black" points="82382.52,-180.87 82389.62,-173.01 82379.17,-174.72 82382.52,-180.87"/>
</g>
<!-- layer4_v_0_2 -->
<g id="node359" class="node">
<title>layer4_v_0_2</title>
<path fill="lightcoral" stroke="black" d="M82317,-173C82317,-173 82134,-173 82134,-173 82128,-173 82122,-167 82122,-161 82122,-161 82122,-102 82122,-102 82122,-96 82128,-90 82134,-90 82134,-90 82317,-90 82317,-90 82323,-90 82329,-96 82329,-102 82329,-102 82329,-161 82329,-161 82329,-167 82323,-173 82317,-173"/>
<text text-anchor="middle" x="82225.5" y="-157.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="82225.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="82225.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="82225.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="82225.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_v_0_2 -->
<g id="edge574" class="edge">
<title>layer4_ln1&#45;&gt;layer4_v_0_2</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69724.79,-225.29 82020.71,-220.15 82104.5,-198.5 82121.96,-193.99 82139.59,-186.36 82155.78,-177.83"/>
<polygon fill="black" stroke="black" points="82157.52,-180.87 82164.62,-173.01 82154.17,-174.72 82157.52,-180.87"/>
</g>
<!-- layer4_q_0_3 -->
<g id="node360" class="node">
<title>layer4_q_0_3</title>
<path fill="lightcoral" stroke="black" d="M81849,-173C81849,-173 81666,-173 81666,-173 81660,-173 81654,-167 81654,-161 81654,-161 81654,-102 81654,-102 81654,-96 81660,-90 81666,-90 81666,-90 81849,-90 81849,-90 81855,-90 81861,-96 81861,-102 81861,-102 81861,-161 81861,-161 81861,-167 81855,-173 81849,-173"/>
<text text-anchor="middle" x="81757.5" y="-157.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="81757.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="81757.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="81757.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="81757.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_q_0_3 -->
<g id="edge575" class="edge">
<title>layer4_ln1&#45;&gt;layer4_q_0_3</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69721.7,-224.28 81555.86,-219.34 81636.5,-198.5 81653.96,-193.99 81671.59,-186.36 81687.78,-177.83"/>
<polygon fill="black" stroke="black" points="81689.52,-180.87 81696.62,-173.01 81686.17,-174.72 81689.52,-180.87"/>
</g>
<!-- layer4_k_0_3 -->
<g id="node361" class="node">
<title>layer4_k_0_3</title>
<path fill="lightcoral" stroke="black" d="M81624,-173C81624,-173 81441,-173 81441,-173 81435,-173 81429,-167 81429,-161 81429,-161 81429,-102 81429,-102 81429,-96 81435,-90 81441,-90 81441,-90 81624,-90 81624,-90 81630,-90 81636,-96 81636,-102 81636,-102 81636,-161 81636,-161 81636,-167 81630,-173 81624,-173"/>
<text text-anchor="middle" x="81532.5" y="-157.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="81532.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="81532.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="81532.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="81532.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_k_0_3 -->
<g id="edge576" class="edge">
<title>layer4_ln1&#45;&gt;layer4_k_0_3</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69720.21,-223.8 81332.37,-218.95 81411.5,-198.5 81428.96,-193.99 81446.59,-186.36 81462.78,-177.83"/>
<polygon fill="black" stroke="black" points="81464.52,-180.87 81471.62,-173.01 81461.17,-174.72 81464.52,-180.87"/>
</g>
<!-- layer4_v_0_3 -->
<g id="node362" class="node">
<title>layer4_v_0_3</title>
<path fill="lightcoral" stroke="black" d="M81399,-173C81399,-173 81216,-173 81216,-173 81210,-173 81204,-167 81204,-161 81204,-161 81204,-102 81204,-102 81204,-96 81210,-90 81216,-90 81216,-90 81399,-90 81399,-90 81405,-90 81411,-96 81411,-102 81411,-102 81411,-161 81411,-161 81411,-167 81405,-173 81399,-173"/>
<text text-anchor="middle" x="81307.5" y="-157.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="81307.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="81307.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="81307.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="81307.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_v_0_3 -->
<g id="edge577" class="edge">
<title>layer4_ln1&#45;&gt;layer4_v_0_3</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69718.72,-223.31 81107.85,-218.42 81185.5,-198.5 81203.08,-193.99 81220.84,-186.36 81237.17,-177.83"/>
<polygon fill="black" stroke="black" points="81238.95,-180.85 81246.08,-173.01 81235.62,-174.69 81238.95,-180.85"/>
</g>
<!-- layer4_q_1_0 -->
<g id="node363" class="node">
<title>layer4_q_1_0</title>
<path fill="lightcoral" stroke="black" d="M80749,-173C80749,-173 80566,-173 80566,-173 80560,-173 80554,-167 80554,-161 80554,-161 80554,-102 80554,-102 80554,-96 80560,-90 80566,-90 80566,-90 80749,-90 80749,-90 80755,-90 80761,-96 80761,-102 80761,-102 80761,-161 80761,-161 80761,-167 80755,-173 80749,-173"/>
<text text-anchor="middle" x="80657.5" y="-157.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="80657.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="80657.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="80657.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="80657.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_q_1_0 -->
<g id="edge578" class="edge">
<title>layer4_ln1&#45;&gt;layer4_q_1_0</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69714.44,-221.92 80463.25,-217.43 80536.5,-198.5 80553.96,-193.99 80571.59,-186.36 80587.78,-177.83"/>
<polygon fill="black" stroke="black" points="80589.52,-180.87 80596.62,-173.01 80586.17,-174.72 80589.52,-180.87"/>
</g>
<!-- layer4_k_1_0 -->
<g id="node364" class="node">
<title>layer4_k_1_0</title>
<path fill="lightcoral" stroke="black" d="M80524,-173C80524,-173 80341,-173 80341,-173 80335,-173 80329,-167 80329,-161 80329,-161 80329,-102 80329,-102 80329,-96 80335,-90 80341,-90 80341,-90 80524,-90 80524,-90 80530,-90 80536,-96 80536,-102 80536,-102 80536,-161 80536,-161 80536,-167 80530,-173 80524,-173"/>
<text text-anchor="middle" x="80432.5" y="-157.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="80432.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="80432.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="80432.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="80432.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_k_1_0 -->
<g id="edge579" class="edge">
<title>layer4_ln1&#45;&gt;layer4_k_1_0</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69712.95,-221.43 80239.77,-217.03 80311.5,-198.5 80328.96,-193.99 80346.59,-186.36 80362.78,-177.83"/>
<polygon fill="black" stroke="black" points="80364.52,-180.87 80371.62,-173.01 80361.17,-174.72 80364.52,-180.87"/>
</g>
<!-- layer4_v_1_0 -->
<g id="node365" class="node">
<title>layer4_v_1_0</title>
<path fill="lightcoral" stroke="black" d="M80299,-173C80299,-173 80116,-173 80116,-173 80110,-173 80104,-167 80104,-161 80104,-161 80104,-102 80104,-102 80104,-96 80110,-90 80116,-90 80116,-90 80299,-90 80299,-90 80305,-90 80311,-96 80311,-102 80311,-102 80311,-161 80311,-161 80311,-167 80305,-173 80299,-173"/>
<text text-anchor="middle" x="80207.5" y="-157.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="80207.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="80207.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="80207.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="80207.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_v_1_0 -->
<g id="edge580" class="edge">
<title>layer4_ln1&#45;&gt;layer4_v_1_0</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69711.47,-220.95 80016.28,-216.64 80086.5,-198.5 80103.96,-193.99 80121.59,-186.36 80137.78,-177.83"/>
<polygon fill="black" stroke="black" points="80139.52,-180.87 80146.62,-173.01 80136.17,-174.72 80139.52,-180.87"/>
</g>
<!-- layer4_q_1_1 -->
<g id="node366" class="node">
<title>layer4_q_1_1</title>
<path fill="lightcoral" stroke="black" d="M79831,-173C79831,-173 79648,-173 79648,-173 79642,-173 79636,-167 79636,-161 79636,-161 79636,-102 79636,-102 79636,-96 79642,-90 79648,-90 79648,-90 79831,-90 79831,-90 79837,-90 79843,-96 79843,-102 79843,-102 79843,-161 79843,-161 79843,-167 79837,-173 79831,-173"/>
<text text-anchor="middle" x="79739.5" y="-157.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="79739.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="79739.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="79739.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="79739.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_q_1_1 -->
<g id="edge581" class="edge">
<title>layer4_ln1&#45;&gt;layer4_q_1_1</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69708.38,-219.95 79551.42,-215.83 79618.5,-198.5 79635.96,-193.99 79653.59,-186.36 79669.78,-177.83"/>
<polygon fill="black" stroke="black" points="79671.52,-180.87 79678.62,-173.01 79668.17,-174.72 79671.52,-180.87"/>
</g>
<!-- layer4_k_1_1 -->
<g id="node367" class="node">
<title>layer4_k_1_1</title>
<path fill="lightcoral" stroke="black" d="M79606,-173C79606,-173 79423,-173 79423,-173 79417,-173 79411,-167 79411,-161 79411,-161 79411,-102 79411,-102 79411,-96 79417,-90 79423,-90 79423,-90 79606,-90 79606,-90 79612,-90 79618,-96 79618,-102 79618,-102 79618,-161 79618,-161 79618,-167 79612,-173 79606,-173"/>
<text text-anchor="middle" x="79514.5" y="-157.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="79514.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="79514.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="79514.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="79514.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_k_1_1 -->
<g id="edge582" class="edge">
<title>layer4_ln1&#45;&gt;layer4_k_1_1</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69706.89,-219.46 79327.94,-215.44 79393.5,-198.5 79410.96,-193.99 79428.59,-186.36 79444.78,-177.83"/>
<polygon fill="black" stroke="black" points="79446.52,-180.87 79453.62,-173.01 79443.17,-174.72 79446.52,-180.87"/>
</g>
<!-- layer4_v_1_1 -->
<g id="node368" class="node">
<title>layer4_v_1_1</title>
<path fill="lightcoral" stroke="black" d="M79381,-173C79381,-173 79198,-173 79198,-173 79192,-173 79186,-167 79186,-161 79186,-161 79186,-102 79186,-102 79186,-96 79192,-90 79198,-90 79198,-90 79381,-90 79381,-90 79387,-90 79393,-96 79393,-102 79393,-102 79393,-161 79393,-161 79393,-167 79387,-173 79381,-173"/>
<text text-anchor="middle" x="79289.5" y="-157.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="79289.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="79289.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="79289.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="79289.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_v_1_1 -->
<g id="edge583" class="edge">
<title>layer4_ln1&#45;&gt;layer4_v_1_1</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69705.4,-218.98 79104.45,-215.05 79168.5,-198.5 79185.96,-193.99 79203.59,-186.36 79219.78,-177.83"/>
<polygon fill="black" stroke="black" points="79221.52,-180.87 79228.62,-173.01 79218.17,-174.72 79221.52,-180.87"/>
</g>
<!-- layer4_q_1_2 -->
<g id="node369" class="node">
<title>layer4_q_1_2</title>
<path fill="lightcoral" stroke="black" d="M78913,-173C78913,-173 78730,-173 78730,-173 78724,-173 78718,-167 78718,-161 78718,-161 78718,-102 78718,-102 78718,-96 78724,-90 78730,-90 78730,-90 78913,-90 78913,-90 78919,-90 78925,-96 78925,-102 78925,-102 78925,-161 78925,-161 78925,-167 78919,-173 78913,-173"/>
<text text-anchor="middle" x="78821.5" y="-157.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="78821.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="78821.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="78821.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="78821.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_q_1_2 -->
<g id="edge584" class="edge">
<title>layer4_ln1&#45;&gt;layer4_q_1_2</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69702.31,-217.97 78639.6,-214.24 78700.5,-198.5 78717.96,-193.99 78735.59,-186.36 78751.78,-177.83"/>
<polygon fill="black" stroke="black" points="78753.52,-180.87 78760.62,-173.01 78750.17,-174.72 78753.52,-180.87"/>
</g>
<!-- layer4_k_1_2 -->
<g id="node370" class="node">
<title>layer4_k_1_2</title>
<path fill="lightcoral" stroke="black" d="M78688,-173C78688,-173 78505,-173 78505,-173 78499,-173 78493,-167 78493,-161 78493,-161 78493,-102 78493,-102 78493,-96 78499,-90 78505,-90 78505,-90 78688,-90 78688,-90 78694,-90 78700,-96 78700,-102 78700,-102 78700,-161 78700,-161 78700,-167 78694,-173 78688,-173"/>
<text text-anchor="middle" x="78596.5" y="-157.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="78596.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="78596.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="78596.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="78596.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_k_1_2 -->
<g id="edge585" class="edge">
<title>layer4_ln1&#45;&gt;layer4_k_1_2</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69700.83,-217.49 78416.11,-213.84 78475.5,-198.5 78492.96,-193.99 78510.59,-186.36 78526.78,-177.83"/>
<polygon fill="black" stroke="black" points="78528.52,-180.87 78535.62,-173.01 78525.17,-174.72 78528.52,-180.87"/>
</g>
<!-- layer4_v_1_2 -->
<g id="node371" class="node">
<title>layer4_v_1_2</title>
<path fill="lightcoral" stroke="black" d="M78463,-173C78463,-173 78280,-173 78280,-173 78274,-173 78268,-167 78268,-161 78268,-161 78268,-102 78268,-102 78268,-96 78274,-90 78280,-90 78280,-90 78463,-90 78463,-90 78469,-90 78475,-96 78475,-102 78475,-102 78475,-161 78475,-161 78475,-167 78469,-173 78463,-173"/>
<text text-anchor="middle" x="78371.5" y="-157.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="78371.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="78371.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="78371.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="78371.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_v_1_2 -->
<g id="edge586" class="edge">
<title>layer4_ln1&#45;&gt;layer4_v_1_2</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69756.18,-235.51 78134.75,-228.41 78250.5,-198.5 78267.96,-193.99 78285.59,-186.36 78301.78,-177.83"/>
<polygon fill="black" stroke="black" points="78303.52,-180.87 78310.62,-173.01 78300.17,-174.72 78303.52,-180.87"/>
</g>
<!-- layer4_q_1_3 -->
<g id="node372" class="node">
<title>layer4_q_1_3</title>
<path fill="lightcoral" stroke="black" d="M77995,-173C77995,-173 77812,-173 77812,-173 77806,-173 77800,-167 77800,-161 77800,-161 77800,-102 77800,-102 77800,-96 77806,-90 77812,-90 77812,-90 77995,-90 77995,-90 78001,-90 78007,-96 78007,-102 78007,-102 78007,-161 78007,-161 78007,-167 78001,-173 77995,-173"/>
<text text-anchor="middle" x="77903.5" y="-157.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="77903.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="77903.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="77903.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="77903.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_q_1_3 -->
<g id="edge587" class="edge">
<title>layer4_ln1&#45;&gt;layer4_q_1_3</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69750,-233.5 77673.04,-226.78 77782.5,-198.5 77799.96,-193.99 77817.59,-186.36 77833.78,-177.83"/>
<polygon fill="black" stroke="black" points="77835.52,-180.87 77842.62,-173.01 77832.17,-174.72 77835.52,-180.87"/>
</g>
<!-- layer4_k_1_3 -->
<g id="node373" class="node">
<title>layer4_k_1_3</title>
<path fill="lightcoral" stroke="black" d="M77770,-173C77770,-173 77587,-173 77587,-173 77581,-173 77575,-167 77575,-161 77575,-161 77575,-102 77575,-102 77575,-96 77581,-90 77587,-90 77587,-90 77770,-90 77770,-90 77776,-90 77782,-96 77782,-102 77782,-102 77782,-161 77782,-161 77782,-167 77776,-173 77770,-173"/>
<text text-anchor="middle" x="77678.5" y="-157.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="77678.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="77678.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="77678.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="77678.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_k_1_3 -->
<g id="edge588" class="edge">
<title>layer4_ln1&#45;&gt;layer4_k_1_3</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69747.03,-232.53 77451.06,-226 77557.5,-198.5 77574.96,-193.99 77592.59,-186.36 77608.78,-177.83"/>
<polygon fill="black" stroke="black" points="77610.52,-180.87 77617.62,-173.01 77607.17,-174.72 77610.52,-180.87"/>
</g>
<!-- layer4_v_1_3 -->
<g id="node374" class="node">
<title>layer4_v_1_3</title>
<path fill="lightcoral" stroke="black" d="M77545,-173C77545,-173 77362,-173 77362,-173 77356,-173 77350,-167 77350,-161 77350,-161 77350,-102 77350,-102 77350,-96 77356,-90 77362,-90 77362,-90 77545,-90 77545,-90 77551,-90 77557,-96 77557,-102 77557,-102 77557,-161 77557,-161 77557,-167 77551,-173 77545,-173"/>
<text text-anchor="middle" x="77453.5" y="-157.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="77453.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="77453.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="77453.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="77453.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_v_1_3 -->
<g id="edge589" class="edge">
<title>layer4_ln1&#45;&gt;layer4_v_1_3</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69744.05,-231.56 77228.06,-225.04 77331.5,-198.5 77349.08,-193.99 77366.84,-186.36 77383.17,-177.83"/>
<polygon fill="black" stroke="black" points="77384.95,-180.85 77392.08,-173.01 77381.62,-174.69 77384.95,-180.85"/>
</g>
<!-- layer4_q_2_0 -->
<g id="node375" class="node">
<title>layer4_q_2_0</title>
<path fill="lightcoral" stroke="black" d="M76895,-173C76895,-173 76712,-173 76712,-173 76706,-173 76700,-167 76700,-161 76700,-161 76700,-102 76700,-102 76700,-96 76706,-90 76712,-90 76712,-90 76895,-90 76895,-90 76901,-90 76907,-96 76907,-102 76907,-102 76907,-161 76907,-161 76907,-167 76901,-173 76895,-173"/>
<text text-anchor="middle" x="76803.5" y="-157.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="76803.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="76803.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="76803.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="76803.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_q_2_0 -->
<g id="edge590" class="edge">
<title>layer4_ln1&#45;&gt;layer4_q_2_0</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69735.48,-228.77 76587.83,-222.96 76682.5,-198.5 76699.96,-193.99 76717.59,-186.36 76733.78,-177.83"/>
<polygon fill="black" stroke="black" points="76735.52,-180.87 76742.62,-173.01 76732.17,-174.72 76735.52,-180.87"/>
</g>
<!-- layer4_k_2_0 -->
<g id="node376" class="node">
<title>layer4_k_2_0</title>
<path fill="lightcoral" stroke="black" d="M76670,-173C76670,-173 76487,-173 76487,-173 76481,-173 76475,-167 76475,-161 76475,-161 76475,-102 76475,-102 76475,-96 76481,-90 76487,-90 76487,-90 76670,-90 76670,-90 76676,-90 76682,-96 76682,-102 76682,-102 76682,-161 76682,-161 76682,-167 76676,-173 76670,-173"/>
<text text-anchor="middle" x="76578.5" y="-157.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="76578.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="76578.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="76578.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="76578.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_k_2_0 -->
<g id="edge591" class="edge">
<title>layer4_ln1&#45;&gt;layer4_k_2_0</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69732.5,-227.8 76365.86,-222.18 76457.5,-198.5 76474.96,-193.99 76492.59,-186.36 76508.78,-177.83"/>
<polygon fill="black" stroke="black" points="76510.52,-180.87 76517.62,-173.01 76507.17,-174.72 76510.52,-180.87"/>
</g>
<!-- layer4_v_2_0 -->
<g id="node377" class="node">
<title>layer4_v_2_0</title>
<path fill="lightcoral" stroke="black" d="M76445,-173C76445,-173 76262,-173 76262,-173 76256,-173 76250,-167 76250,-161 76250,-161 76250,-102 76250,-102 76250,-96 76256,-90 76262,-90 76262,-90 76445,-90 76445,-90 76451,-90 76457,-96 76457,-102 76457,-102 76457,-161 76457,-161 76457,-167 76451,-173 76445,-173"/>
<text text-anchor="middle" x="76353.5" y="-157.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="76353.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="76353.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="76353.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="76353.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_v_2_0 -->
<g id="edge592" class="edge">
<title>layer4_ln1&#45;&gt;layer4_v_2_0</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69729.53,-226.83 76143.88,-221.4 76232.5,-198.5 76249.96,-193.99 76267.59,-186.36 76283.78,-177.83"/>
<polygon fill="black" stroke="black" points="76285.52,-180.87 76292.62,-173.01 76282.17,-174.72 76285.52,-180.87"/>
</g>
<!-- layer4_q_2_1 -->
<g id="node378" class="node">
<title>layer4_q_2_1</title>
<path fill="lightcoral" stroke="black" d="M75977,-173C75977,-173 75794,-173 75794,-173 75788,-173 75782,-167 75782,-161 75782,-161 75782,-102 75782,-102 75782,-96 75788,-90 75794,-90 75794,-90 75977,-90 75977,-90 75983,-90 75989,-96 75989,-102 75989,-102 75989,-161 75989,-161 75989,-167 75983,-173 75977,-173"/>
<text text-anchor="middle" x="75885.5" y="-157.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="75885.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="75885.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="75885.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="75885.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_q_2_1 -->
<g id="edge593" class="edge">
<title>layer4_ln1&#45;&gt;layer4_q_2_1</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69723.35,-224.82 75682.18,-219.77 75764.5,-198.5 75781.96,-193.99 75799.59,-186.36 75815.78,-177.83"/>
<polygon fill="black" stroke="black" points="75817.52,-180.87 75824.62,-173.01 75814.17,-174.72 75817.52,-180.87"/>
</g>
<!-- layer4_k_2_1 -->
<g id="node379" class="node">
<title>layer4_k_2_1</title>
<path fill="lightcoral" stroke="black" d="M75752,-173C75752,-173 75569,-173 75569,-173 75563,-173 75557,-167 75557,-161 75557,-161 75557,-102 75557,-102 75557,-96 75563,-90 75569,-90 75569,-90 75752,-90 75752,-90 75758,-90 75764,-96 75764,-102 75764,-102 75764,-161 75764,-161 75764,-167 75758,-173 75752,-173"/>
<text text-anchor="middle" x="75660.5" y="-157.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="75660.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="75660.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="75660.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="75660.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_k_2_1 -->
<g id="edge594" class="edge">
<title>layer4_ln1&#45;&gt;layer4_k_2_1</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69720.38,-223.85 75460.2,-218.99 75539.5,-198.5 75556.96,-193.99 75574.59,-186.36 75590.78,-177.83"/>
<polygon fill="black" stroke="black" points="75592.52,-180.87 75599.62,-173.01 75589.17,-174.72 75592.52,-180.87"/>
</g>
<!-- layer4_v_2_1 -->
<g id="node380" class="node">
<title>layer4_v_2_1</title>
<path fill="lightcoral" stroke="black" d="M75527,-173C75527,-173 75344,-173 75344,-173 75338,-173 75332,-167 75332,-161 75332,-161 75332,-102 75332,-102 75332,-96 75338,-90 75344,-90 75344,-90 75527,-90 75527,-90 75533,-90 75539,-96 75539,-102 75539,-102 75539,-161 75539,-161 75539,-167 75533,-173 75527,-173"/>
<text text-anchor="middle" x="75435.5" y="-157.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="75435.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="75435.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="75435.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="75435.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_v_2_1 -->
<g id="edge595" class="edge">
<title>layer4_ln1&#45;&gt;layer4_v_2_1</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69717.41,-222.89 75238.23,-218.21 75314.5,-198.5 75331.96,-193.99 75349.59,-186.36 75365.78,-177.83"/>
<polygon fill="black" stroke="black" points="75367.52,-180.87 75374.62,-173.01 75364.17,-174.72 75367.52,-180.87"/>
</g>
<!-- layer4_q_2_2 -->
<g id="node381" class="node">
<title>layer4_q_2_2</title>
<path fill="lightcoral" stroke="black" d="M75059,-173C75059,-173 74876,-173 74876,-173 74870,-173 74864,-167 74864,-161 74864,-161 74864,-102 74864,-102 74864,-96 74870,-90 74876,-90 74876,-90 75059,-90 75059,-90 75065,-90 75071,-96 75071,-102 75071,-102 75071,-161 75071,-161 75071,-167 75065,-173 75059,-173"/>
<text text-anchor="middle" x="74967.5" y="-157.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="74967.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="74967.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="74967.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="74967.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_q_2_2 -->
<g id="edge596" class="edge">
<title>layer4_ln1&#45;&gt;layer4_q_2_2</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69711.23,-220.87 74776.52,-216.58 74846.5,-198.5 74863.96,-193.99 74881.59,-186.36 74897.78,-177.83"/>
<polygon fill="black" stroke="black" points="74899.52,-180.87 74906.62,-173.01 74896.17,-174.72 74899.52,-180.87"/>
</g>
<!-- layer4_k_2_2 -->
<g id="node382" class="node">
<title>layer4_k_2_2</title>
<path fill="lightcoral" stroke="black" d="M74834,-173C74834,-173 74651,-173 74651,-173 74645,-173 74639,-167 74639,-161 74639,-161 74639,-102 74639,-102 74639,-96 74645,-90 74651,-90 74651,-90 74834,-90 74834,-90 74840,-90 74846,-96 74846,-102 74846,-102 74846,-161 74846,-161 74846,-167 74840,-173 74834,-173"/>
<text text-anchor="middle" x="74742.5" y="-157.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="74742.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="74742.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="74742.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="74742.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_k_2_2 -->
<g id="edge597" class="edge">
<title>layer4_ln1&#45;&gt;layer4_k_2_2</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69708.26,-219.91 74554.55,-215.8 74621.5,-198.5 74638.96,-193.99 74656.59,-186.36 74672.78,-177.83"/>
<polygon fill="black" stroke="black" points="74674.52,-180.87 74681.62,-173.01 74671.17,-174.72 74674.52,-180.87"/>
</g>
<!-- layer4_v_2_2 -->
<g id="node383" class="node">
<title>layer4_v_2_2</title>
<path fill="lightcoral" stroke="black" d="M74609,-173C74609,-173 74426,-173 74426,-173 74420,-173 74414,-167 74414,-161 74414,-161 74414,-102 74414,-102 74414,-96 74420,-90 74426,-90 74426,-90 74609,-90 74609,-90 74615,-90 74621,-96 74621,-102 74621,-102 74621,-161 74621,-161 74621,-167 74615,-173 74609,-173"/>
<text text-anchor="middle" x="74517.5" y="-157.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="74517.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="74517.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="74517.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="74517.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_v_2_2 -->
<g id="edge598" class="edge">
<title>layer4_ln1&#45;&gt;layer4_v_2_2</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69705.28,-218.94 74332.57,-215.02 74396.5,-198.5 74413.96,-193.99 74431.59,-186.36 74447.78,-177.83"/>
<polygon fill="black" stroke="black" points="74449.52,-180.87 74456.62,-173.01 74446.17,-174.72 74449.52,-180.87"/>
</g>
<!-- layer4_q_2_3 -->
<g id="node384" class="node">
<title>layer4_q_2_3</title>
<path fill="lightcoral" stroke="black" d="M74141,-173C74141,-173 73958,-173 73958,-173 73952,-173 73946,-167 73946,-161 73946,-161 73946,-102 73946,-102 73946,-96 73952,-90 73958,-90 73958,-90 74141,-90 74141,-90 74147,-90 74153,-96 74153,-102 74153,-102 74153,-161 74153,-161 74153,-167 74147,-173 74141,-173"/>
<text text-anchor="middle" x="74049.5" y="-157.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="74049.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="74049.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="74049.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="74049.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_q_2_3 -->
<g id="edge599" class="edge">
<title>layer4_ln1&#45;&gt;layer4_q_2_3</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69755.71,-235.35 73813.23,-228.28 73928.5,-198.5 73945.96,-193.99 73963.59,-186.36 73979.78,-177.83"/>
<polygon fill="black" stroke="black" points="73981.52,-180.87 73988.62,-173.01 73978.17,-174.72 73981.52,-180.87"/>
</g>
<!-- layer4_k_2_3 -->
<g id="node385" class="node">
<title>layer4_k_2_3</title>
<path fill="lightcoral" stroke="black" d="M73916,-173C73916,-173 73733,-173 73733,-173 73727,-173 73721,-167 73721,-161 73721,-161 73721,-102 73721,-102 73721,-96 73727,-90 73733,-90 73733,-90 73916,-90 73916,-90 73922,-90 73928,-96 73928,-102 73928,-102 73928,-161 73928,-161 73928,-167 73922,-173 73916,-173"/>
<text text-anchor="middle" x="73824.5" y="-157.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="73824.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="73824.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="73824.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="73824.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_k_2_3 -->
<g id="edge600" class="edge">
<title>layer4_ln1&#45;&gt;layer4_k_2_3</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69749.76,-233.42 73594.28,-226.72 73703.5,-198.5 73720.96,-193.99 73738.59,-186.36 73754.78,-177.83"/>
<polygon fill="black" stroke="black" points="73756.52,-180.87 73763.62,-173.01 73753.17,-174.72 73756.52,-180.87"/>
</g>
<!-- layer4_v_2_3 -->
<g id="node386" class="node">
<title>layer4_v_2_3</title>
<path fill="lightcoral" stroke="black" d="M73691,-173C73691,-173 73508,-173 73508,-173 73502,-173 73496,-167 73496,-161 73496,-161 73496,-102 73496,-102 73496,-96 73502,-90 73508,-90 73508,-90 73691,-90 73691,-90 73697,-90 73703,-96 73703,-102 73703,-102 73703,-161 73703,-161 73703,-167 73697,-173 73691,-173"/>
<text text-anchor="middle" x="73599.5" y="-157.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="73599.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="73599.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="73599.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="73599.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_v_2_3 -->
<g id="edge601" class="edge">
<title>layer4_ln1&#45;&gt;layer4_v_2_3</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69743.8,-231.48 73374.31,-224.97 73477.5,-198.5 73495.08,-193.99 73512.84,-186.36 73529.17,-177.83"/>
<polygon fill="black" stroke="black" points="73530.95,-180.85 73538.08,-173.01 73527.62,-174.69 73530.95,-180.85"/>
</g>
<!-- layer4_q_3_0 -->
<g id="node387" class="node">
<title>layer4_q_3_0</title>
<path fill="lightcoral" stroke="black" d="M73041,-173C73041,-173 72858,-173 72858,-173 72852,-173 72846,-167 72846,-161 72846,-161 72846,-102 72846,-102 72846,-96 72852,-90 72858,-90 72858,-90 73041,-90 73041,-90 73047,-90 73053,-96 73053,-102 73053,-102 73053,-161 73053,-161 73053,-167 73047,-173 73041,-173"/>
<text text-anchor="middle" x="72949.5" y="-157.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="72949.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="72949.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="72949.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="72949.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_q_3_0 -->
<g id="edge602" class="edge">
<title>layer4_ln1&#45;&gt;layer4_q_3_0</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69726.65,-225.9 72742.81,-220.64 72828.5,-198.5 72845.96,-193.99 72863.59,-186.36 72879.78,-177.83"/>
<polygon fill="black" stroke="black" points="72881.52,-180.87 72888.62,-173.01 72878.17,-174.72 72881.52,-180.87"/>
</g>
<!-- layer4_k_3_0 -->
<g id="node388" class="node">
<title>layer4_k_3_0</title>
<path fill="lightcoral" stroke="black" d="M72816,-173C72816,-173 72633,-173 72633,-173 72627,-173 72621,-167 72621,-161 72621,-161 72621,-102 72621,-102 72621,-96 72627,-90 72633,-90 72633,-90 72816,-90 72816,-90 72822,-90 72828,-96 72828,-102 72828,-102 72828,-161 72828,-161 72828,-167 72822,-173 72816,-173"/>
<text text-anchor="middle" x="72724.5" y="-157.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="72724.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="72724.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="72724.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="72724.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_k_3_0 -->
<g id="edge603" class="edge">
<title>layer4_ln1&#45;&gt;layer4_k_3_0</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69720.71,-223.96 72523.87,-219.08 72603.5,-198.5 72620.96,-193.99 72638.59,-186.36 72654.78,-177.83"/>
<polygon fill="black" stroke="black" points="72656.52,-180.87 72663.62,-173.01 72653.17,-174.72 72656.52,-180.87"/>
</g>
<!-- layer4_v_3_0 -->
<g id="node389" class="node">
<title>layer4_v_3_0</title>
<path fill="lightcoral" stroke="black" d="M72591,-173C72591,-173 72408,-173 72408,-173 72402,-173 72396,-167 72396,-161 72396,-161 72396,-102 72396,-102 72396,-96 72402,-90 72408,-90 72408,-90 72591,-90 72591,-90 72597,-90 72603,-96 72603,-102 72603,-102 72603,-161 72603,-161 72603,-167 72597,-173 72591,-173"/>
<text text-anchor="middle" x="72499.5" y="-157.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="72499.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="72499.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="72499.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="72499.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_v_3_0 -->
<g id="edge604" class="edge">
<title>layer4_ln1&#45;&gt;layer4_v_3_0</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69714.77,-222.03 72304.92,-217.51 72378.5,-198.5 72395.96,-193.99 72413.59,-186.36 72429.78,-177.83"/>
<polygon fill="black" stroke="black" points="72431.52,-180.87 72438.62,-173.01 72428.17,-174.72 72431.52,-180.87"/>
</g>
<!-- layer4_q_3_1 -->
<g id="node390" class="node">
<title>layer4_q_3_1</title>
<path fill="lightcoral" stroke="black" d="M72123,-173C72123,-173 71940,-173 71940,-173 71934,-173 71928,-167 71928,-161 71928,-161 71928,-102 71928,-102 71928,-96 71934,-90 71940,-90 71940,-90 72123,-90 72123,-90 72129,-90 72135,-96 72135,-102 72135,-102 72135,-161 72135,-161 72135,-167 72129,-173 72123,-173"/>
<text text-anchor="middle" x="72031.5" y="-157.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="72031.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="72031.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="72031.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="72031.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_q_3_1 -->
<g id="edge605" class="edge">
<title>layer4_ln1&#45;&gt;layer4_q_3_1</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69702.41,-218 71849.5,-214.26 71910.5,-198.5 71927.96,-193.99 71945.59,-186.36 71961.78,-177.83"/>
<polygon fill="black" stroke="black" points="71963.52,-180.87 71970.62,-173.01 71960.17,-174.72 71963.52,-180.87"/>
</g>
<!-- layer4_k_3_1 -->
<g id="node391" class="node">
<title>layer4_k_3_1</title>
<path fill="lightcoral" stroke="black" d="M71898,-173C71898,-173 71715,-173 71715,-173 71709,-173 71703,-167 71703,-161 71703,-161 71703,-102 71703,-102 71703,-96 71709,-90 71715,-90 71715,-90 71898,-90 71898,-90 71904,-90 71910,-96 71910,-102 71910,-102 71910,-161 71910,-161 71910,-167 71904,-173 71898,-173"/>
<text text-anchor="middle" x="71806.5" y="-157.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="71806.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="71806.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="71806.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="71806.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_k_3_1 -->
<g id="edge606" class="edge">
<title>layer4_ln1&#45;&gt;layer4_k_3_1</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69750.43,-233.63 71575.61,-226.89 71685.5,-198.5 71702.96,-193.99 71720.59,-186.36 71736.78,-177.83"/>
<polygon fill="black" stroke="black" points="71738.52,-180.87 71745.62,-173.01 71735.17,-174.72 71738.52,-180.87"/>
</g>
<!-- layer4_v_3_1 -->
<g id="node392" class="node">
<title>layer4_v_3_1</title>
<path fill="lightcoral" stroke="black" d="M71673,-173C71673,-173 71490,-173 71490,-173 71484,-173 71478,-167 71478,-161 71478,-161 71478,-102 71478,-102 71478,-96 71484,-90 71490,-90 71490,-90 71673,-90 71673,-90 71679,-90 71685,-96 71685,-102 71685,-102 71685,-161 71685,-161 71685,-167 71679,-173 71673,-173"/>
<text text-anchor="middle" x="71581.5" y="-157.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="71581.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="71581.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="71581.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="71581.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_v_3_1 -->
<g id="edge607" class="edge">
<title>layer4_ln1&#45;&gt;layer4_v_3_1</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69738.54,-229.76 71362.71,-223.77 71460.5,-198.5 71477.96,-193.99 71495.59,-186.36 71511.78,-177.83"/>
<polygon fill="black" stroke="black" points="71513.52,-180.87 71520.62,-173.01 71510.17,-174.72 71513.52,-180.87"/>
</g>
<!-- layer4_q_3_2 -->
<g id="node393" class="node">
<title>layer4_q_3_2</title>
<path fill="lightcoral" stroke="black" d="M71205,-173C71205,-173 71022,-173 71022,-173 71016,-173 71010,-167 71010,-161 71010,-161 71010,-102 71010,-102 71010,-96 71016,-90 71022,-90 71022,-90 71205,-90 71205,-90 71211,-90 71217,-96 71217,-102 71217,-102 71217,-161 71217,-161 71217,-167 71211,-173 71205,-173"/>
<text text-anchor="middle" x="71113.5" y="-157.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="71113.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="71113.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="71113.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="71113.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_q_3_2 -->
<g id="edge608" class="edge">
<title>layer4_ln1&#45;&gt;layer4_q_3_2</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69713.82,-221.72 70919.88,-217.26 70992.5,-198.5 71009.96,-193.99 71027.59,-186.36 71043.78,-177.83"/>
<polygon fill="black" stroke="black" points="71045.52,-180.87 71052.62,-173.01 71042.17,-174.72 71045.52,-180.87"/>
</g>
<!-- layer4_k_3_2 -->
<g id="node394" class="node">
<title>layer4_k_3_2</title>
<path fill="lightcoral" stroke="black" d="M70980,-173C70980,-173 70797,-173 70797,-173 70791,-173 70785,-167 70785,-161 70785,-161 70785,-102 70785,-102 70785,-96 70791,-90 70797,-90 70797,-90 70980,-90 70980,-90 70986,-90 70992,-96 70992,-102 70992,-102 70992,-161 70992,-161 70992,-167 70986,-173 70980,-173"/>
<text text-anchor="middle" x="70888.5" y="-157.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="70888.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="70888.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="70888.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="70888.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_k_3_2 -->
<g id="edge609" class="edge">
<title>layer4_ln1&#45;&gt;layer4_k_3_2</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69701.93,-217.85 70706.99,-214.14 70767.5,-198.5 70784.96,-193.99 70802.59,-186.36 70818.78,-177.83"/>
<polygon fill="black" stroke="black" points="70820.52,-180.87 70827.62,-173.01 70817.17,-174.72 70820.52,-180.87"/>
</g>
<!-- layer4_v_3_2 -->
<g id="node395" class="node">
<title>layer4_v_3_2</title>
<path fill="lightcoral" stroke="black" d="M70755,-173C70755,-173 70572,-173 70572,-173 70566,-173 70560,-167 70560,-161 70560,-161 70560,-102 70560,-102 70560,-96 70566,-90 70572,-90 70572,-90 70755,-90 70755,-90 70761,-90 70767,-96 70767,-102 70767,-102 70767,-161 70767,-161 70767,-167 70761,-173 70755,-173"/>
<text text-anchor="middle" x="70663.5" y="-157.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="70663.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="70663.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="70663.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="70663.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_v_3_2 -->
<g id="edge610" class="edge">
<title>layer4_ln1&#45;&gt;layer4_v_3_2</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69737.59,-229.46 70445.68,-223.52 70542.5,-198.5 70559.96,-193.99 70577.59,-186.36 70593.78,-177.83"/>
<polygon fill="black" stroke="black" points="70595.52,-180.87 70602.62,-173.01 70592.17,-174.72 70595.52,-180.87"/>
</g>
<!-- layer4_q_3_3 -->
<g id="node396" class="node">
<title>layer4_q_3_3</title>
<path fill="lightcoral" stroke="black" d="M70287,-173C70287,-173 70104,-173 70104,-173 70098,-173 70092,-167 70092,-161 70092,-161 70092,-102 70092,-102 70092,-96 70098,-90 70104,-90 70104,-90 70287,-90 70287,-90 70293,-90 70299,-96 70299,-102 70299,-102 70299,-161 70299,-161 70299,-167 70293,-173 70287,-173"/>
<text text-anchor="middle" x="70195.5" y="-157.8" font-family="Times,serif" font-size="14.00">Q Proj Slice</text>
<text text-anchor="middle" x="70195.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="70195.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="70195.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="70195.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_q_3_3 -->
<g id="edge611" class="edge">
<title>layer4_ln1&#45;&gt;layer4_q_3_3</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69733.78,-228.22 69981.55,-222.52 70074.5,-198.5 70091.96,-193.99 70109.59,-186.36 70125.78,-177.83"/>
<polygon fill="black" stroke="black" points="70127.52,-180.87 70134.62,-173.01 70124.17,-174.72 70127.52,-180.87"/>
</g>
<!-- layer4_k_3_3 -->
<g id="node397" class="node">
<title>layer4_k_3_3</title>
<path fill="lightcoral" stroke="black" d="M70062,-173C70062,-173 69879,-173 69879,-173 69873,-173 69867,-167 69867,-161 69867,-161 69867,-102 69867,-102 69867,-96 69873,-90 69879,-90 69879,-90 70062,-90 70062,-90 70068,-90 70074,-96 70074,-102 70074,-102 70074,-161 70074,-161 70074,-167 70068,-173 70062,-173"/>
<text text-anchor="middle" x="69970.5" y="-157.8" font-family="Times,serif" font-size="14.00">K Proj Slice</text>
<text text-anchor="middle" x="69970.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="69970.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="69970.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="69970.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_k_3_3 -->
<g id="edge612" class="edge">
<title>layer4_ln1&#45;&gt;layer4_k_3_3</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69729.98,-226.98 69760.43,-221.51 69849.5,-198.5 69866.96,-193.99 69884.59,-186.36 69900.78,-177.83"/>
<polygon fill="black" stroke="black" points="69902.52,-180.87 69909.62,-173.01 69899.17,-174.72 69902.52,-180.87"/>
</g>
<!-- layer4_v_3_3 -->
<g id="node398" class="node">
<title>layer4_v_3_3</title>
<path fill="lightcoral" stroke="black" d="M69837,-173C69837,-173 69654,-173 69654,-173 69648,-173 69642,-167 69642,-161 69642,-161 69642,-102 69642,-102 69642,-96 69648,-90 69654,-90 69654,-90 69837,-90 69837,-90 69843,-90 69849,-96 69849,-102 69849,-102 69849,-161 69849,-161 69849,-167 69843,-173 69837,-173"/>
<text text-anchor="middle" x="69745.5" y="-157.8" font-family="Times,serif" font-size="14.00">V Proj Slice</text>
<text text-anchor="middle" x="69745.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="69745.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="69745.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="69745.5" y="-97.8" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_v_3_3 -->
<g id="edge613" class="edge">
<title>layer4_ln1&#45;&gt;layer4_v_3_3</title>
<path fill="none" stroke="black" d="M69606.11,-131.5C69614.65,-131.5 69623.2,-131.5 69631.74,-131.5"/>
<polygon fill="black" stroke="black" points="69631.77,-135 69641.77,-131.5 69631.77,-128 69631.77,-135"/>
</g>
<!-- layer4_residual1 -->
<g id="node400" class="node">
<title>layer4_residual1</title>
<path fill="lightgreen" stroke="black" d="M85567.5,-158C85567.5,-158 85467.5,-158 85467.5,-158 85461.5,-158 85455.5,-152 85455.5,-146 85455.5,-146 85455.5,-117 85455.5,-117 85455.5,-111 85461.5,-105 85467.5,-105 85467.5,-105 85567.5,-105 85567.5,-105 85573.5,-105 85579.5,-111 85579.5,-117 85579.5,-117 85579.5,-146 85579.5,-146 85579.5,-152 85573.5,-158 85567.5,-158"/>
<text text-anchor="middle" x="85517.5" y="-142.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="85517.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="85517.5" y="-112.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_ln1&#45;&gt;layer4_residual1 -->
<g id="edge615" class="edge">
<title>layer4_ln1&#45;&gt;layer4_residual1</title>
<path fill="none" stroke="black" d="M69577.28,-158.09C69594.37,-173.13 69617.89,-190.49 69642.5,-198.5 69746.68,-232.42 85314.83,-230.86 85419.5,-198.5 85441.67,-191.65 85463.29,-177.86 85480.56,-164.57"/>
<polygon fill="black" stroke="black" points="85483.03,-167.08 85488.67,-158.12 85478.67,-161.61 85483.03,-167.08"/>
</g>
<!-- layer4_attn_0_0 -->
<g id="node413" class="node">
<title>layer4_attn_0_0</title>
<path fill="orange" stroke="black" d="M84846,-165.5C84846,-165.5 84663,-165.5 84663,-165.5 84657,-165.5 84651,-159.5 84651,-153.5 84651,-153.5 84651,-109.5 84651,-109.5 84651,-103.5 84657,-97.5 84663,-97.5 84663,-97.5 84846,-97.5 84846,-97.5 84852,-97.5 84858,-103.5 84858,-109.5 84858,-109.5 84858,-153.5 84858,-153.5 84858,-159.5 84852,-165.5 84846,-165.5"/>
<text text-anchor="middle" x="84754.5" y="-150.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="84754.5" y="-135.3" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 0</text>
<text text-anchor="middle" x="84754.5" y="-120.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="84754.5" y="-105.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer4_q_0_0&#45;&gt;layer4_attn_0_0 -->
<g id="edge636" class="edge">
<title>layer4_q_0_0&#45;&gt;layer4_attn_0_0</title>
<path fill="none" stroke="black" d="M84615.44,-131.5C84623.81,-131.5 84632.17,-131.5 84640.54,-131.5"/>
<polygon fill="black" stroke="black" points="84640.75,-135 84650.75,-131.5 84640.75,-128 84640.75,-135"/>
</g>
<!-- layer4_k_0_0&#45;&gt;layer4_attn_0_0 -->
<g id="edge637" class="edge">
<title>layer4_k_0_0&#45;&gt;layer4_attn_0_0</title>
<path fill="none" stroke="black" d="M84347.92,-173.01C84366.58,-183.43 84387.67,-193.16 84408.5,-198.5 84497.61,-221.36 84525.81,-218.99 84615.5,-198.5 84640.75,-192.73 84666.75,-181.77 84689.34,-170.35"/>
<polygon fill="black" stroke="black" points="84691.2,-173.33 84698.47,-165.62 84687.98,-167.11 84691.2,-173.33"/>
</g>
<!-- layer4_v_0_0&#45;&gt;layer4_attn_0_0 -->
<g id="edge638" class="edge">
<title>layer4_v_0_0&#45;&gt;layer4_attn_0_0</title>
<path fill="none" stroke="black" d="M84122.92,-173.01C84141.58,-183.43 84162.67,-193.16 84183.5,-198.5 84276.49,-222.35 84521.91,-219.88 84615.5,-198.5 84640.75,-192.73 84666.75,-181.77 84689.34,-170.35"/>
<polygon fill="black" stroke="black" points="84691.2,-173.33 84698.47,-165.62 84687.98,-167.11 84691.2,-173.33"/>
</g>
<!-- layer4_attn_0_1 -->
<g id="node414" class="node">
<title>layer4_attn_0_1</title>
<path fill="orange" stroke="black" d="M83928,-165.5C83928,-165.5 83745,-165.5 83745,-165.5 83739,-165.5 83733,-159.5 83733,-153.5 83733,-153.5 83733,-109.5 83733,-109.5 83733,-103.5 83739,-97.5 83745,-97.5 83745,-97.5 83928,-97.5 83928,-97.5 83934,-97.5 83940,-103.5 83940,-109.5 83940,-109.5 83940,-153.5 83940,-153.5 83940,-159.5 83934,-165.5 83928,-165.5"/>
<text text-anchor="middle" x="83836.5" y="-150.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="83836.5" y="-135.3" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 1</text>
<text text-anchor="middle" x="83836.5" y="-120.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="83836.5" y="-105.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer4_q_0_1&#45;&gt;layer4_attn_0_1 -->
<g id="edge639" class="edge">
<title>layer4_q_0_1&#45;&gt;layer4_attn_0_1</title>
<path fill="none" stroke="black" d="M83697.44,-131.5C83705.81,-131.5 83714.17,-131.5 83722.54,-131.5"/>
<polygon fill="black" stroke="black" points="83722.75,-135 83732.75,-131.5 83722.75,-128 83722.75,-135"/>
</g>
<!-- layer4_k_0_1&#45;&gt;layer4_attn_0_1 -->
<g id="edge640" class="edge">
<title>layer4_k_0_1&#45;&gt;layer4_attn_0_1</title>
<path fill="none" stroke="black" d="M83429.92,-173.01C83448.58,-183.43 83469.67,-193.16 83490.5,-198.5 83579.61,-221.36 83607.81,-218.99 83697.5,-198.5 83722.75,-192.73 83748.75,-181.77 83771.34,-170.35"/>
<polygon fill="black" stroke="black" points="83773.2,-173.33 83780.47,-165.62 83769.98,-167.11 83773.2,-173.33"/>
</g>
<!-- layer4_v_0_1&#45;&gt;layer4_attn_0_1 -->
<g id="edge641" class="edge">
<title>layer4_v_0_1&#45;&gt;layer4_attn_0_1</title>
<path fill="none" stroke="black" d="M83204.92,-173.01C83223.58,-183.43 83244.67,-193.16 83265.5,-198.5 83358.49,-222.35 83603.91,-219.88 83697.5,-198.5 83722.75,-192.73 83748.75,-181.77 83771.34,-170.35"/>
<polygon fill="black" stroke="black" points="83773.2,-173.33 83780.47,-165.62 83769.98,-167.11 83773.2,-173.33"/>
</g>
<!-- layer4_attn_0_2 -->
<g id="node415" class="node">
<title>layer4_attn_0_2</title>
<path fill="orange" stroke="black" d="M83010,-165.5C83010,-165.5 82827,-165.5 82827,-165.5 82821,-165.5 82815,-159.5 82815,-153.5 82815,-153.5 82815,-109.5 82815,-109.5 82815,-103.5 82821,-97.5 82827,-97.5 82827,-97.5 83010,-97.5 83010,-97.5 83016,-97.5 83022,-103.5 83022,-109.5 83022,-109.5 83022,-153.5 83022,-153.5 83022,-159.5 83016,-165.5 83010,-165.5"/>
<text text-anchor="middle" x="82918.5" y="-150.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="82918.5" y="-135.3" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 2</text>
<text text-anchor="middle" x="82918.5" y="-120.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="82918.5" y="-105.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer4_q_0_2&#45;&gt;layer4_attn_0_2 -->
<g id="edge642" class="edge">
<title>layer4_q_0_2&#45;&gt;layer4_attn_0_2</title>
<path fill="none" stroke="black" d="M82779.44,-131.5C82787.81,-131.5 82796.17,-131.5 82804.54,-131.5"/>
<polygon fill="black" stroke="black" points="82804.75,-135 82814.75,-131.5 82804.75,-128 82804.75,-135"/>
</g>
<!-- layer4_k_0_2&#45;&gt;layer4_attn_0_2 -->
<g id="edge643" class="edge">
<title>layer4_k_0_2&#45;&gt;layer4_attn_0_2</title>
<path fill="none" stroke="black" d="M82511.92,-173.01C82530.58,-183.43 82551.67,-193.16 82572.5,-198.5 82661.61,-221.36 82689.81,-218.99 82779.5,-198.5 82804.75,-192.73 82830.75,-181.77 82853.34,-170.35"/>
<polygon fill="black" stroke="black" points="82855.2,-173.33 82862.47,-165.62 82851.98,-167.11 82855.2,-173.33"/>
</g>
<!-- layer4_v_0_2&#45;&gt;layer4_attn_0_2 -->
<g id="edge644" class="edge">
<title>layer4_v_0_2&#45;&gt;layer4_attn_0_2</title>
<path fill="none" stroke="black" d="M82286.92,-173.01C82305.58,-183.43 82326.67,-193.16 82347.5,-198.5 82440.49,-222.35 82685.91,-219.88 82779.5,-198.5 82804.75,-192.73 82830.75,-181.77 82853.34,-170.35"/>
<polygon fill="black" stroke="black" points="82855.2,-173.33 82862.47,-165.62 82851.98,-167.11 82855.2,-173.33"/>
</g>
<!-- layer4_attn_0_3 -->
<g id="node416" class="node">
<title>layer4_attn_0_3</title>
<path fill="orange" stroke="black" d="M82092,-165.5C82092,-165.5 81909,-165.5 81909,-165.5 81903,-165.5 81897,-159.5 81897,-153.5 81897,-153.5 81897,-109.5 81897,-109.5 81897,-103.5 81903,-97.5 81909,-97.5 81909,-97.5 82092,-97.5 82092,-97.5 82098,-97.5 82104,-103.5 82104,-109.5 82104,-109.5 82104,-153.5 82104,-153.5 82104,-159.5 82098,-165.5 82092,-165.5"/>
<text text-anchor="middle" x="82000.5" y="-150.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="82000.5" y="-135.3" font-family="Times,serif" font-size="14.00">Head Group 0, Dim Slice 3</text>
<text text-anchor="middle" x="82000.5" y="-120.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="82000.5" y="-105.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer4_q_0_3&#45;&gt;layer4_attn_0_3 -->
<g id="edge645" class="edge">
<title>layer4_q_0_3&#45;&gt;layer4_attn_0_3</title>
<path fill="none" stroke="black" d="M81861.44,-131.5C81869.81,-131.5 81878.17,-131.5 81886.54,-131.5"/>
<polygon fill="black" stroke="black" points="81886.75,-135 81896.75,-131.5 81886.75,-128 81886.75,-135"/>
</g>
<!-- layer4_k_0_3&#45;&gt;layer4_attn_0_3 -->
<g id="edge646" class="edge">
<title>layer4_k_0_3&#45;&gt;layer4_attn_0_3</title>
<path fill="none" stroke="black" d="M81593.92,-173.01C81612.58,-183.43 81633.67,-193.16 81654.5,-198.5 81743.61,-221.36 81771.81,-218.99 81861.5,-198.5 81886.75,-192.73 81912.75,-181.77 81935.34,-170.35"/>
<polygon fill="black" stroke="black" points="81937.2,-173.33 81944.47,-165.62 81933.98,-167.11 81937.2,-173.33"/>
</g>
<!-- layer4_v_0_3&#45;&gt;layer4_attn_0_3 -->
<g id="edge647" class="edge">
<title>layer4_v_0_3&#45;&gt;layer4_attn_0_3</title>
<path fill="none" stroke="black" d="M81368.92,-173.01C81387.58,-183.43 81408.67,-193.16 81429.5,-198.5 81522.49,-222.35 81767.91,-219.88 81861.5,-198.5 81886.75,-192.73 81912.75,-181.77 81935.34,-170.35"/>
<polygon fill="black" stroke="black" points="81937.2,-173.33 81944.47,-165.62 81933.98,-167.11 81937.2,-173.33"/>
</g>
<!-- layer4_attn_1_0 -->
<g id="node417" class="node">
<title>layer4_attn_1_0</title>
<path fill="orange" stroke="black" d="M80992,-165.5C80992,-165.5 80809,-165.5 80809,-165.5 80803,-165.5 80797,-159.5 80797,-153.5 80797,-153.5 80797,-109.5 80797,-109.5 80797,-103.5 80803,-97.5 80809,-97.5 80809,-97.5 80992,-97.5 80992,-97.5 80998,-97.5 81004,-103.5 81004,-109.5 81004,-109.5 81004,-153.5 81004,-153.5 81004,-159.5 80998,-165.5 80992,-165.5"/>
<text text-anchor="middle" x="80900.5" y="-150.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="80900.5" y="-135.3" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 0</text>
<text text-anchor="middle" x="80900.5" y="-120.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="80900.5" y="-105.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer4_q_1_0&#45;&gt;layer4_attn_1_0 -->
<g id="edge648" class="edge">
<title>layer4_q_1_0&#45;&gt;layer4_attn_1_0</title>
<path fill="none" stroke="black" d="M80761.44,-131.5C80769.81,-131.5 80778.17,-131.5 80786.54,-131.5"/>
<polygon fill="black" stroke="black" points="80786.75,-135 80796.75,-131.5 80786.75,-128 80786.75,-135"/>
</g>
<!-- layer4_k_1_0&#45;&gt;layer4_attn_1_0 -->
<g id="edge649" class="edge">
<title>layer4_k_1_0&#45;&gt;layer4_attn_1_0</title>
<path fill="none" stroke="black" d="M80493.92,-173.01C80512.58,-183.43 80533.67,-193.16 80554.5,-198.5 80643.61,-221.36 80671.81,-218.99 80761.5,-198.5 80786.75,-192.73 80812.75,-181.77 80835.34,-170.35"/>
<polygon fill="black" stroke="black" points="80837.2,-173.33 80844.47,-165.62 80833.98,-167.11 80837.2,-173.33"/>
</g>
<!-- layer4_v_1_0&#45;&gt;layer4_attn_1_0 -->
<g id="edge650" class="edge">
<title>layer4_v_1_0&#45;&gt;layer4_attn_1_0</title>
<path fill="none" stroke="black" d="M80268.92,-173.01C80287.58,-183.43 80308.67,-193.16 80329.5,-198.5 80422.49,-222.35 80667.91,-219.88 80761.5,-198.5 80786.75,-192.73 80812.75,-181.77 80835.34,-170.35"/>
<polygon fill="black" stroke="black" points="80837.2,-173.33 80844.47,-165.62 80833.98,-167.11 80837.2,-173.33"/>
</g>
<!-- layer4_attn_1_1 -->
<g id="node418" class="node">
<title>layer4_attn_1_1</title>
<path fill="orange" stroke="black" d="M80074,-165.5C80074,-165.5 79891,-165.5 79891,-165.5 79885,-165.5 79879,-159.5 79879,-153.5 79879,-153.5 79879,-109.5 79879,-109.5 79879,-103.5 79885,-97.5 79891,-97.5 79891,-97.5 80074,-97.5 80074,-97.5 80080,-97.5 80086,-103.5 80086,-109.5 80086,-109.5 80086,-153.5 80086,-153.5 80086,-159.5 80080,-165.5 80074,-165.5"/>
<text text-anchor="middle" x="79982.5" y="-150.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="79982.5" y="-135.3" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 1</text>
<text text-anchor="middle" x="79982.5" y="-120.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="79982.5" y="-105.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer4_q_1_1&#45;&gt;layer4_attn_1_1 -->
<g id="edge651" class="edge">
<title>layer4_q_1_1&#45;&gt;layer4_attn_1_1</title>
<path fill="none" stroke="black" d="M79843.44,-131.5C79851.81,-131.5 79860.17,-131.5 79868.54,-131.5"/>
<polygon fill="black" stroke="black" points="79868.75,-135 79878.75,-131.5 79868.75,-128 79868.75,-135"/>
</g>
<!-- layer4_k_1_1&#45;&gt;layer4_attn_1_1 -->
<g id="edge652" class="edge">
<title>layer4_k_1_1&#45;&gt;layer4_attn_1_1</title>
<path fill="none" stroke="black" d="M79575.92,-173.01C79594.58,-183.43 79615.67,-193.16 79636.5,-198.5 79725.61,-221.36 79753.81,-218.99 79843.5,-198.5 79868.75,-192.73 79894.75,-181.77 79917.34,-170.35"/>
<polygon fill="black" stroke="black" points="79919.2,-173.33 79926.47,-165.62 79915.98,-167.11 79919.2,-173.33"/>
</g>
<!-- layer4_v_1_1&#45;&gt;layer4_attn_1_1 -->
<g id="edge653" class="edge">
<title>layer4_v_1_1&#45;&gt;layer4_attn_1_1</title>
<path fill="none" stroke="black" d="M79350.92,-173.01C79369.58,-183.43 79390.67,-193.16 79411.5,-198.5 79504.49,-222.35 79749.91,-219.88 79843.5,-198.5 79868.75,-192.73 79894.75,-181.77 79917.34,-170.35"/>
<polygon fill="black" stroke="black" points="79919.2,-173.33 79926.47,-165.62 79915.98,-167.11 79919.2,-173.33"/>
</g>
<!-- layer4_attn_1_2 -->
<g id="node419" class="node">
<title>layer4_attn_1_2</title>
<path fill="orange" stroke="black" d="M79156,-165.5C79156,-165.5 78973,-165.5 78973,-165.5 78967,-165.5 78961,-159.5 78961,-153.5 78961,-153.5 78961,-109.5 78961,-109.5 78961,-103.5 78967,-97.5 78973,-97.5 78973,-97.5 79156,-97.5 79156,-97.5 79162,-97.5 79168,-103.5 79168,-109.5 79168,-109.5 79168,-153.5 79168,-153.5 79168,-159.5 79162,-165.5 79156,-165.5"/>
<text text-anchor="middle" x="79064.5" y="-150.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="79064.5" y="-135.3" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 2</text>
<text text-anchor="middle" x="79064.5" y="-120.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="79064.5" y="-105.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer4_q_1_2&#45;&gt;layer4_attn_1_2 -->
<g id="edge654" class="edge">
<title>layer4_q_1_2&#45;&gt;layer4_attn_1_2</title>
<path fill="none" stroke="black" d="M78925.44,-131.5C78933.81,-131.5 78942.17,-131.5 78950.54,-131.5"/>
<polygon fill="black" stroke="black" points="78950.75,-135 78960.75,-131.5 78950.75,-128 78950.75,-135"/>
</g>
<!-- layer4_k_1_2&#45;&gt;layer4_attn_1_2 -->
<g id="edge655" class="edge">
<title>layer4_k_1_2&#45;&gt;layer4_attn_1_2</title>
<path fill="none" stroke="black" d="M78657.92,-173.01C78676.58,-183.43 78697.67,-193.16 78718.5,-198.5 78807.61,-221.36 78835.81,-218.99 78925.5,-198.5 78950.75,-192.73 78976.75,-181.77 78999.34,-170.35"/>
<polygon fill="black" stroke="black" points="79001.2,-173.33 79008.47,-165.62 78997.98,-167.11 79001.2,-173.33"/>
</g>
<!-- layer4_v_1_2&#45;&gt;layer4_attn_1_2 -->
<g id="edge656" class="edge">
<title>layer4_v_1_2&#45;&gt;layer4_attn_1_2</title>
<path fill="none" stroke="black" d="M78432.92,-173.01C78451.58,-183.43 78472.67,-193.16 78493.5,-198.5 78586.49,-222.35 78831.91,-219.88 78925.5,-198.5 78950.75,-192.73 78976.75,-181.77 78999.34,-170.35"/>
<polygon fill="black" stroke="black" points="79001.2,-173.33 79008.47,-165.62 78997.98,-167.11 79001.2,-173.33"/>
</g>
<!-- layer4_attn_1_3 -->
<g id="node420" class="node">
<title>layer4_attn_1_3</title>
<path fill="orange" stroke="black" d="M78238,-165.5C78238,-165.5 78055,-165.5 78055,-165.5 78049,-165.5 78043,-159.5 78043,-153.5 78043,-153.5 78043,-109.5 78043,-109.5 78043,-103.5 78049,-97.5 78055,-97.5 78055,-97.5 78238,-97.5 78238,-97.5 78244,-97.5 78250,-103.5 78250,-109.5 78250,-109.5 78250,-153.5 78250,-153.5 78250,-159.5 78244,-165.5 78238,-165.5"/>
<text text-anchor="middle" x="78146.5" y="-150.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="78146.5" y="-135.3" font-family="Times,serif" font-size="14.00">Head Group 1, Dim Slice 3</text>
<text text-anchor="middle" x="78146.5" y="-120.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="78146.5" y="-105.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer4_q_1_3&#45;&gt;layer4_attn_1_3 -->
<g id="edge657" class="edge">
<title>layer4_q_1_3&#45;&gt;layer4_attn_1_3</title>
<path fill="none" stroke="black" d="M78007.44,-131.5C78015.81,-131.5 78024.17,-131.5 78032.54,-131.5"/>
<polygon fill="black" stroke="black" points="78032.75,-135 78042.75,-131.5 78032.75,-128 78032.75,-135"/>
</g>
<!-- layer4_k_1_3&#45;&gt;layer4_attn_1_3 -->
<g id="edge658" class="edge">
<title>layer4_k_1_3&#45;&gt;layer4_attn_1_3</title>
<path fill="none" stroke="black" d="M77739.92,-173.01C77758.58,-183.43 77779.67,-193.16 77800.5,-198.5 77889.61,-221.36 77917.81,-218.99 78007.5,-198.5 78032.75,-192.73 78058.75,-181.77 78081.34,-170.35"/>
<polygon fill="black" stroke="black" points="78083.2,-173.33 78090.47,-165.62 78079.98,-167.11 78083.2,-173.33"/>
</g>
<!-- layer4_v_1_3&#45;&gt;layer4_attn_1_3 -->
<g id="edge659" class="edge">
<title>layer4_v_1_3&#45;&gt;layer4_attn_1_3</title>
<path fill="none" stroke="black" d="M77514.92,-173.01C77533.58,-183.43 77554.67,-193.16 77575.5,-198.5 77668.49,-222.35 77913.91,-219.88 78007.5,-198.5 78032.75,-192.73 78058.75,-181.77 78081.34,-170.35"/>
<polygon fill="black" stroke="black" points="78083.2,-173.33 78090.47,-165.62 78079.98,-167.11 78083.2,-173.33"/>
</g>
<!-- layer4_attn_2_0 -->
<g id="node421" class="node">
<title>layer4_attn_2_0</title>
<path fill="orange" stroke="black" d="M77138,-165.5C77138,-165.5 76955,-165.5 76955,-165.5 76949,-165.5 76943,-159.5 76943,-153.5 76943,-153.5 76943,-109.5 76943,-109.5 76943,-103.5 76949,-97.5 76955,-97.5 76955,-97.5 77138,-97.5 77138,-97.5 77144,-97.5 77150,-103.5 77150,-109.5 77150,-109.5 77150,-153.5 77150,-153.5 77150,-159.5 77144,-165.5 77138,-165.5"/>
<text text-anchor="middle" x="77046.5" y="-150.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="77046.5" y="-135.3" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 0</text>
<text text-anchor="middle" x="77046.5" y="-120.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="77046.5" y="-105.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer4_q_2_0&#45;&gt;layer4_attn_2_0 -->
<g id="edge660" class="edge">
<title>layer4_q_2_0&#45;&gt;layer4_attn_2_0</title>
<path fill="none" stroke="black" d="M76907.44,-131.5C76915.81,-131.5 76924.17,-131.5 76932.54,-131.5"/>
<polygon fill="black" stroke="black" points="76932.75,-135 76942.75,-131.5 76932.75,-128 76932.75,-135"/>
</g>
<!-- layer4_k_2_0&#45;&gt;layer4_attn_2_0 -->
<g id="edge661" class="edge">
<title>layer4_k_2_0&#45;&gt;layer4_attn_2_0</title>
<path fill="none" stroke="black" d="M76639.92,-173.01C76658.58,-183.43 76679.67,-193.16 76700.5,-198.5 76789.61,-221.36 76817.81,-218.99 76907.5,-198.5 76932.75,-192.73 76958.75,-181.77 76981.34,-170.35"/>
<polygon fill="black" stroke="black" points="76983.2,-173.33 76990.47,-165.62 76979.98,-167.11 76983.2,-173.33"/>
</g>
<!-- layer4_v_2_0&#45;&gt;layer4_attn_2_0 -->
<g id="edge662" class="edge">
<title>layer4_v_2_0&#45;&gt;layer4_attn_2_0</title>
<path fill="none" stroke="black" d="M76414.92,-173.01C76433.58,-183.43 76454.67,-193.16 76475.5,-198.5 76568.49,-222.35 76813.91,-219.88 76907.5,-198.5 76932.75,-192.73 76958.75,-181.77 76981.34,-170.35"/>
<polygon fill="black" stroke="black" points="76983.2,-173.33 76990.47,-165.62 76979.98,-167.11 76983.2,-173.33"/>
</g>
<!-- layer4_attn_2_1 -->
<g id="node422" class="node">
<title>layer4_attn_2_1</title>
<path fill="orange" stroke="black" d="M76220,-165.5C76220,-165.5 76037,-165.5 76037,-165.5 76031,-165.5 76025,-159.5 76025,-153.5 76025,-153.5 76025,-109.5 76025,-109.5 76025,-103.5 76031,-97.5 76037,-97.5 76037,-97.5 76220,-97.5 76220,-97.5 76226,-97.5 76232,-103.5 76232,-109.5 76232,-109.5 76232,-153.5 76232,-153.5 76232,-159.5 76226,-165.5 76220,-165.5"/>
<text text-anchor="middle" x="76128.5" y="-150.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="76128.5" y="-135.3" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 1</text>
<text text-anchor="middle" x="76128.5" y="-120.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="76128.5" y="-105.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer4_q_2_1&#45;&gt;layer4_attn_2_1 -->
<g id="edge663" class="edge">
<title>layer4_q_2_1&#45;&gt;layer4_attn_2_1</title>
<path fill="none" stroke="black" d="M75989.44,-131.5C75997.81,-131.5 76006.17,-131.5 76014.54,-131.5"/>
<polygon fill="black" stroke="black" points="76014.75,-135 76024.75,-131.5 76014.75,-128 76014.75,-135"/>
</g>
<!-- layer4_k_2_1&#45;&gt;layer4_attn_2_1 -->
<g id="edge664" class="edge">
<title>layer4_k_2_1&#45;&gt;layer4_attn_2_1</title>
<path fill="none" stroke="black" d="M75721.92,-173.01C75740.58,-183.43 75761.67,-193.16 75782.5,-198.5 75871.61,-221.36 75899.81,-218.99 75989.5,-198.5 76014.75,-192.73 76040.75,-181.77 76063.34,-170.35"/>
<polygon fill="black" stroke="black" points="76065.2,-173.33 76072.47,-165.62 76061.98,-167.11 76065.2,-173.33"/>
</g>
<!-- layer4_v_2_1&#45;&gt;layer4_attn_2_1 -->
<g id="edge665" class="edge">
<title>layer4_v_2_1&#45;&gt;layer4_attn_2_1</title>
<path fill="none" stroke="black" d="M75496.92,-173.01C75515.58,-183.43 75536.67,-193.16 75557.5,-198.5 75650.49,-222.35 75895.91,-219.88 75989.5,-198.5 76014.75,-192.73 76040.75,-181.77 76063.34,-170.35"/>
<polygon fill="black" stroke="black" points="76065.2,-173.33 76072.47,-165.62 76061.98,-167.11 76065.2,-173.33"/>
</g>
<!-- layer4_attn_2_2 -->
<g id="node423" class="node">
<title>layer4_attn_2_2</title>
<path fill="orange" stroke="black" d="M75302,-165.5C75302,-165.5 75119,-165.5 75119,-165.5 75113,-165.5 75107,-159.5 75107,-153.5 75107,-153.5 75107,-109.5 75107,-109.5 75107,-103.5 75113,-97.5 75119,-97.5 75119,-97.5 75302,-97.5 75302,-97.5 75308,-97.5 75314,-103.5 75314,-109.5 75314,-109.5 75314,-153.5 75314,-153.5 75314,-159.5 75308,-165.5 75302,-165.5"/>
<text text-anchor="middle" x="75210.5" y="-150.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="75210.5" y="-135.3" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 2</text>
<text text-anchor="middle" x="75210.5" y="-120.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="75210.5" y="-105.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer4_q_2_2&#45;&gt;layer4_attn_2_2 -->
<g id="edge666" class="edge">
<title>layer4_q_2_2&#45;&gt;layer4_attn_2_2</title>
<path fill="none" stroke="black" d="M75071.44,-131.5C75079.81,-131.5 75088.17,-131.5 75096.54,-131.5"/>
<polygon fill="black" stroke="black" points="75096.75,-135 75106.75,-131.5 75096.75,-128 75096.75,-135"/>
</g>
<!-- layer4_k_2_2&#45;&gt;layer4_attn_2_2 -->
<g id="edge667" class="edge">
<title>layer4_k_2_2&#45;&gt;layer4_attn_2_2</title>
<path fill="none" stroke="black" d="M74803.92,-173.01C74822.58,-183.43 74843.67,-193.16 74864.5,-198.5 74953.61,-221.36 74981.81,-218.99 75071.5,-198.5 75096.75,-192.73 75122.75,-181.77 75145.34,-170.35"/>
<polygon fill="black" stroke="black" points="75147.2,-173.33 75154.47,-165.62 75143.98,-167.11 75147.2,-173.33"/>
</g>
<!-- layer4_v_2_2&#45;&gt;layer4_attn_2_2 -->
<g id="edge668" class="edge">
<title>layer4_v_2_2&#45;&gt;layer4_attn_2_2</title>
<path fill="none" stroke="black" d="M74578.92,-173.01C74597.58,-183.43 74618.67,-193.16 74639.5,-198.5 74732.49,-222.35 74977.91,-219.88 75071.5,-198.5 75096.75,-192.73 75122.75,-181.77 75145.34,-170.35"/>
<polygon fill="black" stroke="black" points="75147.2,-173.33 75154.47,-165.62 75143.98,-167.11 75147.2,-173.33"/>
</g>
<!-- layer4_attn_2_3 -->
<g id="node424" class="node">
<title>layer4_attn_2_3</title>
<path fill="orange" stroke="black" d="M74384,-165.5C74384,-165.5 74201,-165.5 74201,-165.5 74195,-165.5 74189,-159.5 74189,-153.5 74189,-153.5 74189,-109.5 74189,-109.5 74189,-103.5 74195,-97.5 74201,-97.5 74201,-97.5 74384,-97.5 74384,-97.5 74390,-97.5 74396,-103.5 74396,-109.5 74396,-109.5 74396,-153.5 74396,-153.5 74396,-159.5 74390,-165.5 74384,-165.5"/>
<text text-anchor="middle" x="74292.5" y="-150.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="74292.5" y="-135.3" font-family="Times,serif" font-size="14.00">Head Group 2, Dim Slice 3</text>
<text text-anchor="middle" x="74292.5" y="-120.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="74292.5" y="-105.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer4_q_2_3&#45;&gt;layer4_attn_2_3 -->
<g id="edge669" class="edge">
<title>layer4_q_2_3&#45;&gt;layer4_attn_2_3</title>
<path fill="none" stroke="black" d="M74153.44,-131.5C74161.81,-131.5 74170.17,-131.5 74178.54,-131.5"/>
<polygon fill="black" stroke="black" points="74178.75,-135 74188.75,-131.5 74178.75,-128 74178.75,-135"/>
</g>
<!-- layer4_k_2_3&#45;&gt;layer4_attn_2_3 -->
<g id="edge670" class="edge">
<title>layer4_k_2_3&#45;&gt;layer4_attn_2_3</title>
<path fill="none" stroke="black" d="M73885.92,-173.01C73904.58,-183.43 73925.67,-193.16 73946.5,-198.5 74035.61,-221.36 74063.81,-218.99 74153.5,-198.5 74178.75,-192.73 74204.75,-181.77 74227.34,-170.35"/>
<polygon fill="black" stroke="black" points="74229.2,-173.33 74236.47,-165.62 74225.98,-167.11 74229.2,-173.33"/>
</g>
<!-- layer4_v_2_3&#45;&gt;layer4_attn_2_3 -->
<g id="edge671" class="edge">
<title>layer4_v_2_3&#45;&gt;layer4_attn_2_3</title>
<path fill="none" stroke="black" d="M73660.92,-173.01C73679.58,-183.43 73700.67,-193.16 73721.5,-198.5 73814.49,-222.35 74059.91,-219.88 74153.5,-198.5 74178.75,-192.73 74204.75,-181.77 74227.34,-170.35"/>
<polygon fill="black" stroke="black" points="74229.2,-173.33 74236.47,-165.62 74225.98,-167.11 74229.2,-173.33"/>
</g>
<!-- layer4_attn_3_0 -->
<g id="node425" class="node">
<title>layer4_attn_3_0</title>
<path fill="orange" stroke="black" d="M73284,-165.5C73284,-165.5 73101,-165.5 73101,-165.5 73095,-165.5 73089,-159.5 73089,-153.5 73089,-153.5 73089,-109.5 73089,-109.5 73089,-103.5 73095,-97.5 73101,-97.5 73101,-97.5 73284,-97.5 73284,-97.5 73290,-97.5 73296,-103.5 73296,-109.5 73296,-109.5 73296,-153.5 73296,-153.5 73296,-159.5 73290,-165.5 73284,-165.5"/>
<text text-anchor="middle" x="73192.5" y="-150.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="73192.5" y="-135.3" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 0</text>
<text text-anchor="middle" x="73192.5" y="-120.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="73192.5" y="-105.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer4_q_3_0&#45;&gt;layer4_attn_3_0 -->
<g id="edge672" class="edge">
<title>layer4_q_3_0&#45;&gt;layer4_attn_3_0</title>
<path fill="none" stroke="black" d="M73053.44,-131.5C73061.81,-131.5 73070.17,-131.5 73078.54,-131.5"/>
<polygon fill="black" stroke="black" points="73078.75,-135 73088.75,-131.5 73078.75,-128 73078.75,-135"/>
</g>
<!-- layer4_k_3_0&#45;&gt;layer4_attn_3_0 -->
<g id="edge673" class="edge">
<title>layer4_k_3_0&#45;&gt;layer4_attn_3_0</title>
<path fill="none" stroke="black" d="M72785.92,-173.01C72804.58,-183.43 72825.67,-193.16 72846.5,-198.5 72935.61,-221.36 72963.81,-218.99 73053.5,-198.5 73078.75,-192.73 73104.75,-181.77 73127.34,-170.35"/>
<polygon fill="black" stroke="black" points="73129.2,-173.33 73136.47,-165.62 73125.98,-167.11 73129.2,-173.33"/>
</g>
<!-- layer4_v_3_0&#45;&gt;layer4_attn_3_0 -->
<g id="edge674" class="edge">
<title>layer4_v_3_0&#45;&gt;layer4_attn_3_0</title>
<path fill="none" stroke="black" d="M72560.92,-173.01C72579.58,-183.43 72600.67,-193.16 72621.5,-198.5 72714.49,-222.35 72959.91,-219.88 73053.5,-198.5 73078.75,-192.73 73104.75,-181.77 73127.34,-170.35"/>
<polygon fill="black" stroke="black" points="73129.2,-173.33 73136.47,-165.62 73125.98,-167.11 73129.2,-173.33"/>
</g>
<!-- layer4_attn_3_1 -->
<g id="node426" class="node">
<title>layer4_attn_3_1</title>
<path fill="orange" stroke="black" d="M72366,-165.5C72366,-165.5 72183,-165.5 72183,-165.5 72177,-165.5 72171,-159.5 72171,-153.5 72171,-153.5 72171,-109.5 72171,-109.5 72171,-103.5 72177,-97.5 72183,-97.5 72183,-97.5 72366,-97.5 72366,-97.5 72372,-97.5 72378,-103.5 72378,-109.5 72378,-109.5 72378,-153.5 72378,-153.5 72378,-159.5 72372,-165.5 72366,-165.5"/>
<text text-anchor="middle" x="72274.5" y="-150.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="72274.5" y="-135.3" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 1</text>
<text text-anchor="middle" x="72274.5" y="-120.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="72274.5" y="-105.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer4_q_3_1&#45;&gt;layer4_attn_3_1 -->
<g id="edge675" class="edge">
<title>layer4_q_3_1&#45;&gt;layer4_attn_3_1</title>
<path fill="none" stroke="black" d="M72135.44,-131.5C72143.81,-131.5 72152.17,-131.5 72160.54,-131.5"/>
<polygon fill="black" stroke="black" points="72160.75,-135 72170.75,-131.5 72160.75,-128 72160.75,-135"/>
</g>
<!-- layer4_k_3_1&#45;&gt;layer4_attn_3_1 -->
<g id="edge676" class="edge">
<title>layer4_k_3_1&#45;&gt;layer4_attn_3_1</title>
<path fill="none" stroke="black" d="M71867.92,-173.01C71886.58,-183.43 71907.67,-193.16 71928.5,-198.5 72017.61,-221.36 72045.81,-218.99 72135.5,-198.5 72160.75,-192.73 72186.75,-181.77 72209.34,-170.35"/>
<polygon fill="black" stroke="black" points="72211.2,-173.33 72218.47,-165.62 72207.98,-167.11 72211.2,-173.33"/>
</g>
<!-- layer4_v_3_1&#45;&gt;layer4_attn_3_1 -->
<g id="edge677" class="edge">
<title>layer4_v_3_1&#45;&gt;layer4_attn_3_1</title>
<path fill="none" stroke="black" d="M71642.92,-173.01C71661.58,-183.43 71682.67,-193.16 71703.5,-198.5 71796.49,-222.35 72041.91,-219.88 72135.5,-198.5 72160.75,-192.73 72186.75,-181.77 72209.34,-170.35"/>
<polygon fill="black" stroke="black" points="72211.2,-173.33 72218.47,-165.62 72207.98,-167.11 72211.2,-173.33"/>
</g>
<!-- layer4_attn_3_2 -->
<g id="node427" class="node">
<title>layer4_attn_3_2</title>
<path fill="orange" stroke="black" d="M71448,-165.5C71448,-165.5 71265,-165.5 71265,-165.5 71259,-165.5 71253,-159.5 71253,-153.5 71253,-153.5 71253,-109.5 71253,-109.5 71253,-103.5 71259,-97.5 71265,-97.5 71265,-97.5 71448,-97.5 71448,-97.5 71454,-97.5 71460,-103.5 71460,-109.5 71460,-109.5 71460,-153.5 71460,-153.5 71460,-159.5 71454,-165.5 71448,-165.5"/>
<text text-anchor="middle" x="71356.5" y="-150.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="71356.5" y="-135.3" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 2</text>
<text text-anchor="middle" x="71356.5" y="-120.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="71356.5" y="-105.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer4_q_3_2&#45;&gt;layer4_attn_3_2 -->
<g id="edge678" class="edge">
<title>layer4_q_3_2&#45;&gt;layer4_attn_3_2</title>
<path fill="none" stroke="black" d="M71217.44,-131.5C71225.81,-131.5 71234.17,-131.5 71242.54,-131.5"/>
<polygon fill="black" stroke="black" points="71242.75,-135 71252.75,-131.5 71242.75,-128 71242.75,-135"/>
</g>
<!-- layer4_k_3_2&#45;&gt;layer4_attn_3_2 -->
<g id="edge679" class="edge">
<title>layer4_k_3_2&#45;&gt;layer4_attn_3_2</title>
<path fill="none" stroke="black" d="M70949.92,-173.01C70968.58,-183.43 70989.67,-193.16 71010.5,-198.5 71099.61,-221.36 71127.81,-218.99 71217.5,-198.5 71242.75,-192.73 71268.75,-181.77 71291.34,-170.35"/>
<polygon fill="black" stroke="black" points="71293.2,-173.33 71300.47,-165.62 71289.98,-167.11 71293.2,-173.33"/>
</g>
<!-- layer4_v_3_2&#45;&gt;layer4_attn_3_2 -->
<g id="edge680" class="edge">
<title>layer4_v_3_2&#45;&gt;layer4_attn_3_2</title>
<path fill="none" stroke="black" d="M70724.92,-173.01C70743.58,-183.43 70764.67,-193.16 70785.5,-198.5 70878.49,-222.35 71123.91,-219.88 71217.5,-198.5 71242.75,-192.73 71268.75,-181.77 71291.34,-170.35"/>
<polygon fill="black" stroke="black" points="71293.2,-173.33 71300.47,-165.62 71289.98,-167.11 71293.2,-173.33"/>
</g>
<!-- layer4_attn_3_3 -->
<g id="node428" class="node">
<title>layer4_attn_3_3</title>
<path fill="orange" stroke="black" d="M70530,-165.5C70530,-165.5 70347,-165.5 70347,-165.5 70341,-165.5 70335,-159.5 70335,-153.5 70335,-153.5 70335,-109.5 70335,-109.5 70335,-103.5 70341,-97.5 70347,-97.5 70347,-97.5 70530,-97.5 70530,-97.5 70536,-97.5 70542,-103.5 70542,-109.5 70542,-109.5 70542,-153.5 70542,-153.5 70542,-159.5 70536,-165.5 70530,-165.5"/>
<text text-anchor="middle" x="70438.5" y="-150.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="70438.5" y="-135.3" font-family="Times,serif" font-size="14.00">Head Group 3, Dim Slice 3</text>
<text text-anchor="middle" x="70438.5" y="-120.3" font-family="Times,serif" font-size="14.00">[B, L, 512]</text>
<text text-anchor="middle" x="70438.5" y="-105.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer4_q_3_3&#45;&gt;layer4_attn_3_3 -->
<g id="edge681" class="edge">
<title>layer4_q_3_3&#45;&gt;layer4_attn_3_3</title>
<path fill="none" stroke="black" d="M70299.44,-131.5C70307.81,-131.5 70316.17,-131.5 70324.54,-131.5"/>
<polygon fill="black" stroke="black" points="70324.75,-135 70334.75,-131.5 70324.75,-128 70324.75,-135"/>
</g>
<!-- layer4_k_3_3&#45;&gt;layer4_attn_3_3 -->
<g id="edge682" class="edge">
<title>layer4_k_3_3&#45;&gt;layer4_attn_3_3</title>
<path fill="none" stroke="black" d="M70031.92,-173.01C70050.58,-183.43 70071.67,-193.16 70092.5,-198.5 70181.61,-221.36 70209.81,-218.99 70299.5,-198.5 70324.75,-192.73 70350.75,-181.77 70373.34,-170.35"/>
<polygon fill="black" stroke="black" points="70375.2,-173.33 70382.47,-165.62 70371.98,-167.11 70375.2,-173.33"/>
</g>
<!-- layer4_v_3_3&#45;&gt;layer4_attn_3_3 -->
<g id="edge683" class="edge">
<title>layer4_v_3_3&#45;&gt;layer4_attn_3_3</title>
<path fill="none" stroke="black" d="M69806.92,-173.01C69825.58,-183.43 69846.67,-193.16 69867.5,-198.5 69960.49,-222.35 70205.91,-219.88 70299.5,-198.5 70324.75,-192.73 70350.75,-181.77 70373.34,-170.35"/>
<polygon fill="black" stroke="black" points="70375.2,-173.33 70382.47,-165.62 70371.98,-167.11 70375.2,-173.33"/>
</g>
<!-- layer4_out_proj -->
<g id="node399" class="node">
<title>layer4_out_proj</title>
<path fill="lightcoral" stroke="black" d="M85407.5,-165.5C85407.5,-165.5 85287.5,-165.5 85287.5,-165.5 85281.5,-165.5 85275.5,-159.5 85275.5,-153.5 85275.5,-153.5 85275.5,-109.5 85275.5,-109.5 85275.5,-103.5 85281.5,-97.5 85287.5,-97.5 85287.5,-97.5 85407.5,-97.5 85407.5,-97.5 85413.5,-97.5 85419.5,-103.5 85419.5,-109.5 85419.5,-109.5 85419.5,-153.5 85419.5,-153.5 85419.5,-159.5 85413.5,-165.5 85407.5,-165.5"/>
<text text-anchor="middle" x="85347.5" y="-150.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="85347.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="85347.5" y="-120.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="85347.5" y="-105.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer4_out_proj&#45;&gt;layer4_residual1 -->
<g id="edge614" class="edge">
<title>layer4_out_proj&#45;&gt;layer4_residual1</title>
<path fill="none" stroke="black" d="M85419.55,-131.5C85428.08,-131.5 85436.6,-131.5 85445.13,-131.5"/>
<polygon fill="black" stroke="black" points="85445.13,-135 85455.13,-131.5 85445.13,-128 85445.13,-135"/>
</g>
<!-- layer4_ln2 -->
<g id="node401" class="node">
<title>layer4_ln2</title>
<path fill="lightyellow" stroke="black" d="M85714,-158C85714,-158 85627,-158 85627,-158 85621,-158 85615,-152 85615,-146 85615,-146 85615,-117 85615,-117 85615,-111 85621,-105 85627,-105 85627,-105 85714,-105 85714,-105 85720,-105 85726,-111 85726,-117 85726,-117 85726,-146 85726,-146 85726,-152 85720,-158 85714,-158"/>
<text text-anchor="middle" x="85670.5" y="-142.8" font-family="Times,serif" font-size="14.00">LayerNorm 4</text>
<text text-anchor="middle" x="85670.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="85670.5" y="-112.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_residual1&#45;&gt;layer4_ln2 -->
<g id="edge616" class="edge">
<title>layer4_residual1&#45;&gt;layer4_ln2</title>
<path fill="none" stroke="black" d="M85579.66,-131.5C85587.98,-131.5 85596.31,-131.5 85604.63,-131.5"/>
<polygon fill="black" stroke="black" points="85604.79,-135 85614.79,-131.5 85604.79,-128 85604.79,-135"/>
</g>
<!-- layer4_residual2 -->
<g id="node412" class="node">
<title>layer4_residual2</title>
<path fill="lightgreen" stroke="black" d="M92765.5,-158C92765.5,-158 92665.5,-158 92665.5,-158 92659.5,-158 92653.5,-152 92653.5,-146 92653.5,-146 92653.5,-117 92653.5,-117 92653.5,-111 92659.5,-105 92665.5,-105 92665.5,-105 92765.5,-105 92765.5,-105 92771.5,-105 92777.5,-111 92777.5,-117 92777.5,-117 92777.5,-146 92777.5,-146 92777.5,-152 92771.5,-158 92765.5,-158"/>
<text text-anchor="middle" x="92715.5" y="-142.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="92715.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="92715.5" y="-112.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_residual1&#45;&gt;layer4_residual2 -->
<g id="edge635" class="edge">
<title>layer4_residual1&#45;&gt;layer4_residual2</title>
<path fill="none" stroke="black" d="M85546.33,-158.12C85564.65,-173.17 85589.71,-190.53 85615.5,-198.5 85708.41,-227.22 92524.59,-227.22 92617.5,-198.5 92639.67,-191.65 92661.29,-177.86 92678.56,-164.57"/>
<polygon fill="black" stroke="black" points="92681.03,-167.08 92686.67,-158.12 92676.67,-161.61 92681.03,-167.08"/>
</g>
<!-- layer4_router -->
<g id="node402" class="node">
<title>layer4_router</title>
<path fill="gold" stroke="black" d="M85929,-165.5C85929,-165.5 85774,-165.5 85774,-165.5 85768,-165.5 85762,-159.5 85762,-153.5 85762,-153.5 85762,-109.5 85762,-109.5 85762,-103.5 85768,-97.5 85774,-97.5 85774,-97.5 85929,-97.5 85929,-97.5 85935,-97.5 85941,-103.5 85941,-109.5 85941,-109.5 85941,-153.5 85941,-153.5 85941,-159.5 85935,-165.5 85929,-165.5"/>
<text text-anchor="middle" x="85851.5" y="-150.3" font-family="Times,serif" font-size="14.00">MoE Router</text>
<text text-anchor="middle" x="85851.5" y="-135.3" font-family="Times,serif" font-size="14.00">Token Routing</text>
<text text-anchor="middle" x="85851.5" y="-120.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]  [B, L, 8]</text>
<text text-anchor="middle" x="85851.5" y="-105.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_ln2&#45;&gt;layer4_router -->
<g id="edge617" class="edge">
<title>layer4_ln2&#45;&gt;layer4_router</title>
<path fill="none" stroke="black" d="M85726,-131.5C85734.58,-131.5 85743.15,-131.5 85751.72,-131.5"/>
<polygon fill="black" stroke="black" points="85751.79,-135 85761.79,-131.5 85751.79,-128 85751.79,-135"/>
</g>
<!-- layer4_expert_0_gate -->
<g id="node403" class="node">
<title>layer4_expert_0_gate</title>
<path fill="lightyellow" stroke="black" d="M91762,-158C91762,-158 91669,-158 91669,-158 91663,-158 91657,-152 91657,-146 91657,-146 91657,-117 91657,-117 91657,-111 91663,-105 91669,-105 91669,-105 91762,-105 91762,-105 91768,-105 91774,-111 91774,-117 91774,-117 91774,-146 91774,-146 91774,-152 91768,-158 91762,-158"/>
<text text-anchor="middle" x="91715.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="91715.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="91715.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer4_ln2&#45;&gt;layer4_expert_0_gate -->
<g id="edge619" class="edge">
<title>layer4_ln2&#45;&gt;layer4_expert_0_gate</title>
<path fill="none" stroke="black" d="M85697.28,-158.09C85714.37,-173.13 85737.89,-190.49 85762.5,-198.5 85840.1,-223.76 91562.06,-227.1 91638.5,-198.5 91656.67,-191.7 91673.39,-178.46 91686.57,-165.53"/>
<polygon fill="black" stroke="black" points="91689.43,-167.61 91693.9,-158 91684.42,-162.72 91689.43,-167.61"/>
</g>
<!-- layer4_expert_1_gate -->
<g id="node404" class="node">
<title>layer4_expert_1_gate</title>
<path fill="lightyellow" stroke="black" d="M90961,-158C90961,-158 90868,-158 90868,-158 90862,-158 90856,-152 90856,-146 90856,-146 90856,-117 90856,-117 90856,-111 90862,-105 90868,-105 90868,-105 90961,-105 90961,-105 90967,-105 90973,-111 90973,-117 90973,-117 90973,-146 90973,-146 90973,-152 90967,-158 90961,-158"/>
<text text-anchor="middle" x="90914.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="90914.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="90914.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer4_ln2&#45;&gt;layer4_expert_1_gate -->
<g id="edge621" class="edge">
<title>layer4_ln2&#45;&gt;layer4_expert_1_gate</title>
<path fill="none" stroke="black" d="M85697.28,-158.09C85714.37,-173.13 85737.89,-190.49 85762.5,-198.5 85829.52,-220.32 90771.48,-223.2 90837.5,-198.5 90855.67,-191.7 90872.39,-178.46 90885.57,-165.53"/>
<polygon fill="black" stroke="black" points="90888.43,-167.61 90892.9,-158 90883.42,-162.72 90888.43,-167.61"/>
</g>
<!-- layer4_expert_2_gate -->
<g id="node405" class="node">
<title>layer4_expert_2_gate</title>
<path fill="lightyellow" stroke="black" d="M90160,-158C90160,-158 90067,-158 90067,-158 90061,-158 90055,-152 90055,-146 90055,-146 90055,-117 90055,-117 90055,-111 90061,-105 90067,-105 90067,-105 90160,-105 90160,-105 90166,-105 90172,-111 90172,-117 90172,-117 90172,-146 90172,-146 90172,-152 90166,-158 90160,-158"/>
<text text-anchor="middle" x="90113.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="90113.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="90113.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer4_ln2&#45;&gt;layer4_expert_2_gate -->
<g id="edge623" class="edge">
<title>layer4_ln2&#45;&gt;layer4_expert_2_gate</title>
<path fill="none" stroke="black" d="M85697.28,-158.09C85714.37,-173.13 85737.89,-190.49 85762.5,-198.5 85818.95,-216.88 89980.9,-219.3 90036.5,-198.5 90054.67,-191.7 90071.39,-178.46 90084.57,-165.53"/>
<polygon fill="black" stroke="black" points="90087.43,-167.61 90091.9,-158 90082.42,-162.72 90087.43,-167.61"/>
</g>
<!-- layer4_expert_3_gate -->
<g id="node406" class="node">
<title>layer4_expert_3_gate</title>
<path fill="lightyellow" stroke="black" d="M89359,-158C89359,-158 89266,-158 89266,-158 89260,-158 89254,-152 89254,-146 89254,-146 89254,-117 89254,-117 89254,-111 89260,-105 89266,-105 89266,-105 89359,-105 89359,-105 89365,-105 89371,-111 89371,-117 89371,-117 89371,-146 89371,-146 89371,-152 89365,-158 89359,-158"/>
<text text-anchor="middle" x="89312.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="89312.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="89312.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer4_ln2&#45;&gt;layer4_expert_3_gate -->
<g id="edge625" class="edge">
<title>layer4_ln2&#45;&gt;layer4_expert_3_gate</title>
<path fill="none" stroke="black" d="M85697.28,-158.09C85714.37,-173.13 85737.89,-190.49 85762.5,-198.5 85854.23,-228.36 89145.15,-232.31 89235.5,-198.5 89253.67,-191.7 89270.39,-178.46 89283.57,-165.53"/>
<polygon fill="black" stroke="black" points="89286.43,-167.61 89290.9,-158 89281.42,-162.72 89286.43,-167.61"/>
</g>
<!-- layer4_expert_4_gate -->
<g id="node407" class="node">
<title>layer4_expert_4_gate</title>
<path fill="lightyellow" stroke="black" d="M88558,-158C88558,-158 88465,-158 88465,-158 88459,-158 88453,-152 88453,-146 88453,-146 88453,-117 88453,-117 88453,-111 88459,-105 88465,-105 88465,-105 88558,-105 88558,-105 88564,-105 88570,-111 88570,-117 88570,-117 88570,-146 88570,-146 88570,-152 88564,-158 88558,-158"/>
<text text-anchor="middle" x="88511.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="88511.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="88511.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer4_ln2&#45;&gt;layer4_expert_4_gate -->
<g id="edge627" class="edge">
<title>layer4_ln2&#45;&gt;layer4_expert_4_gate</title>
<path fill="none" stroke="black" d="M85697.28,-158.09C85714.37,-173.13 85737.89,-190.49 85762.5,-198.5 85833.08,-221.48 88364.98,-224.51 88434.5,-198.5 88452.67,-191.7 88469.39,-178.46 88482.57,-165.53"/>
<polygon fill="black" stroke="black" points="88485.43,-167.61 88489.9,-158 88480.42,-162.72 88485.43,-167.61"/>
</g>
<!-- layer4_expert_5_gate -->
<g id="node408" class="node">
<title>layer4_expert_5_gate</title>
<path fill="lightyellow" stroke="black" d="M87757,-158C87757,-158 87664,-158 87664,-158 87658,-158 87652,-152 87652,-146 87652,-146 87652,-117 87652,-117 87652,-111 87658,-105 87664,-105 87664,-105 87757,-105 87757,-105 87763,-105 87769,-111 87769,-117 87769,-117 87769,-146 87769,-146 87769,-152 87763,-158 87757,-158"/>
<text text-anchor="middle" x="87710.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="87710.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="87710.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer4_ln2&#45;&gt;layer4_expert_5_gate -->
<g id="edge629" class="edge">
<title>layer4_ln2&#45;&gt;layer4_expert_5_gate</title>
<path fill="none" stroke="black" d="M85697.28,-158.09C85714.37,-173.13 85737.89,-190.49 85762.5,-198.5 85811.92,-214.59 87584.82,-216.71 87633.5,-198.5 87651.67,-191.7 87668.39,-178.46 87681.57,-165.53"/>
<polygon fill="black" stroke="black" points="87684.43,-167.61 87688.9,-158 87679.42,-162.72 87684.43,-167.61"/>
</g>
<!-- layer4_expert_6_gate -->
<g id="node409" class="node">
<title>layer4_expert_6_gate</title>
<path fill="lightyellow" stroke="black" d="M86956,-158C86956,-158 86863,-158 86863,-158 86857,-158 86851,-152 86851,-146 86851,-146 86851,-117 86851,-117 86851,-111 86857,-105 86863,-105 86863,-105 86956,-105 86956,-105 86962,-105 86968,-111 86968,-117 86968,-117 86968,-146 86968,-146 86968,-152 86962,-158 86956,-158"/>
<text text-anchor="middle" x="86909.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="86909.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="86909.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer4_ln2&#45;&gt;layer4_expert_6_gate -->
<g id="edge631" class="edge">
<title>layer4_ln2&#45;&gt;layer4_expert_6_gate</title>
<path fill="none" stroke="black" d="M85697.28,-158.09C85714.37,-173.13 85737.89,-190.49 85762.5,-198.5 85819.02,-216.9 86776.83,-219.33 86832.5,-198.5 86850.67,-191.7 86867.39,-178.46 86880.57,-165.53"/>
<polygon fill="black" stroke="black" points="86883.43,-167.61 86887.9,-158 86878.42,-162.72 86883.43,-167.61"/>
</g>
<!-- layer4_expert_7_gate -->
<g id="node410" class="node">
<title>layer4_expert_7_gate</title>
<path fill="lightyellow" stroke="black" d="M86155,-158C86155,-158 86062,-158 86062,-158 86056,-158 86050,-152 86050,-146 86050,-146 86050,-117 86050,-117 86050,-111 86056,-105 86062,-105 86062,-105 86155,-105 86155,-105 86161,-105 86167,-111 86167,-117 86167,-117 86167,-146 86167,-146 86167,-152 86161,-158 86155,-158"/>
<text text-anchor="middle" x="86108.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="86108.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="86108.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer4_ln2&#45;&gt;layer4_expert_7_gate -->
<g id="edge633" class="edge">
<title>layer4_ln2&#45;&gt;layer4_expert_7_gate</title>
<path fill="none" stroke="black" d="M85697.28,-158.09C85714.37,-173.13 85737.89,-190.49 85762.5,-198.5 85838.15,-223.13 85863.39,-213.58 85941.5,-198.5 85978.05,-191.44 86016.76,-176.43 86047.7,-162.41"/>
<polygon fill="black" stroke="black" points="86049.43,-165.47 86057.04,-158.1 86046.5,-159.11 86049.43,-165.47"/>
</g>
<!-- layer4_router&#45;&gt;layer4_expert_0_gate -->
<g id="edge618" class="edge">
<title>layer4_router&#45;&gt;layer4_expert_0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85932.75,-165.52C85968.24,-178.61 86010.75,-191.99 86050.5,-198.5 86127.09,-211.05 91565.81,-225.7 91638.5,-198.5 91656.67,-191.7 91673.39,-178.46 91686.57,-165.53"/>
<polygon fill="black" stroke="black" points="91689.43,-167.61 91693.9,-158 91684.42,-162.72 91689.43,-167.61"/>
</g>
<!-- layer4_router&#45;&gt;layer4_expert_0_gate -->
<g id="edge709" class="edge">
<title>layer4_router&#45;&gt;layer4_expert_0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85941.26,-165.5C86659.61,-165.5 91453.36,-165.5 91705.2,-165.5"/>
<polygon fill="black" stroke="black" points="91705.44,-169 91715.44,-165.5 91705.44,-162 91705.44,-169"/>
<text text-anchor="middle" x="85851.5" y="-127.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert_1_gate -->
<g id="edge620" class="edge">
<title>layer4_router&#45;&gt;layer4_expert_1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85932.75,-165.52C85968.24,-178.61 86010.75,-191.99 86050.5,-198.5 86116.11,-209.25 90775.23,-221.8 90837.5,-198.5 90855.67,-191.7 90872.39,-178.46 90885.57,-165.53"/>
<polygon fill="black" stroke="black" points="90888.43,-167.61 90892.9,-158 90883.42,-162.72 90888.43,-167.61"/>
</g>
<!-- layer4_router&#45;&gt;layer4_expert_1_gate -->
<g id="edge714" class="edge">
<title>layer4_router&#45;&gt;layer4_expert_1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85941.26,-165.5C86600.49,-165.5 90674.57,-165.5 90904.38,-165.5"/>
<polygon fill="black" stroke="black" points="90904.45,-169 90914.45,-165.5 90904.45,-162 90904.45,-169"/>
<text text-anchor="middle" x="85851.5" y="-127.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert_2_gate -->
<g id="edge622" class="edge">
<title>layer4_router&#45;&gt;layer4_expert_2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85932.75,-165.52C85968.24,-178.61 86010.75,-191.99 86050.5,-198.5 86159.77,-216.4 89932.8,-237.3 90036.5,-198.5 90054.67,-191.7 90071.39,-178.46 90084.57,-165.53"/>
<polygon fill="black" stroke="black" points="90087.43,-167.61 90091.9,-158 90082.42,-162.72 90087.43,-167.61"/>
</g>
<!-- layer4_router&#45;&gt;layer4_expert_2_gate -->
<g id="edge719" class="edge">
<title>layer4_router&#45;&gt;layer4_expert_2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85941.01,-165.5C86535.05,-165.5 89891.3,-165.5 90103.02,-165.5"/>
<polygon fill="black" stroke="black" points="90103.34,-169 90113.34,-165.5 90103.34,-162 90103.34,-169"/>
<text text-anchor="middle" x="85851.5" y="-127.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert_3_gate -->
<g id="edge624" class="edge">
<title>layer4_router&#45;&gt;layer4_expert_3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85932.75,-165.52C85968.24,-178.61 86010.75,-191.99 86050.5,-198.5 86137.81,-212.8 89152.64,-229.5 89235.5,-198.5 89253.67,-191.7 89270.39,-178.46 89283.57,-165.53"/>
<polygon fill="black" stroke="black" points="89286.43,-167.61 89290.9,-158 89281.42,-162.72 89286.43,-167.61"/>
</g>
<!-- layer4_router&#45;&gt;layer4_expert_3_gate -->
<g id="edge724" class="edge">
<title>layer4_router&#45;&gt;layer4_expert_3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85941.41,-165.5C86466.26,-165.5 89117.21,-165.5 89302.31,-165.5"/>
<polygon fill="black" stroke="black" points="89302.37,-169 89312.37,-165.5 89302.37,-162 89302.37,-169"/>
<text text-anchor="middle" x="85851.5" y="-127.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert_4_gate -->
<g id="edge626" class="edge">
<title>layer4_router&#45;&gt;layer4_expert_4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85932.75,-165.52C85968.24,-178.61 86010.75,-191.99 86050.5,-198.5 86115.85,-209.21 88372.48,-221.71 88434.5,-198.5 88452.67,-191.7 88469.39,-178.46 88482.57,-165.53"/>
<polygon fill="black" stroke="black" points="88485.43,-167.61 88489.9,-158 88480.42,-162.72 88485.43,-167.61"/>
</g>
<!-- layer4_router&#45;&gt;layer4_expert_4_gate -->
<g id="edge729" class="edge">
<title>layer4_router&#45;&gt;layer4_expert_4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85941.14,-165.5C86386.06,-165.5 88342.06,-165.5 88501.2,-165.5"/>
<polygon fill="black" stroke="black" points="88501.4,-169 88511.4,-165.5 88501.4,-162 88501.4,-169"/>
<text text-anchor="middle" x="85851.5" y="-127.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert_5_gate -->
<g id="edge628" class="edge">
<title>layer4_router&#45;&gt;layer4_expert_5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85932.75,-165.52C85968.24,-178.61 86010.75,-191.99 86050.5,-198.5 86137.29,-212.72 87551.13,-229.32 87633.5,-198.5 87651.67,-191.7 87668.39,-178.46 87681.57,-165.53"/>
<polygon fill="black" stroke="black" points="87684.43,-167.61 87688.9,-158 87679.42,-162.72 87684.43,-167.61"/>
</g>
<!-- layer4_router&#45;&gt;layer4_expert_5_gate -->
<g id="edge734" class="edge">
<title>layer4_router&#45;&gt;layer4_expert_5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85941.16,-165.5C86293.72,-165.5 87571.66,-165.5 87700.08,-165.5"/>
<polygon fill="black" stroke="black" points="87700.44,-169 87710.44,-165.5 87700.44,-162 87700.44,-169"/>
<text text-anchor="middle" x="85851.5" y="-127.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert_6_gate -->
<g id="edge630" class="edge">
<title>layer4_router&#45;&gt;layer4_expert_6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85932.75,-165.52C85968.24,-178.61 86010.75,-191.99 86050.5,-198.5 86136.25,-212.55 86751.12,-228.95 86832.5,-198.5 86850.67,-191.7 86867.39,-178.46 86880.57,-165.53"/>
<polygon fill="black" stroke="black" points="86883.43,-167.61 86887.9,-158 86878.42,-162.72 86883.43,-167.61"/>
</g>
<!-- layer4_router&#45;&gt;layer4_expert_6_gate -->
<g id="edge739" class="edge">
<title>layer4_router&#45;&gt;layer4_expert_6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85941.25,-165.5C86178.63,-165.5 86810.87,-165.5 86899.2,-165.5"/>
<polygon fill="black" stroke="black" points="86899.37,-169 86909.37,-165.5 86899.37,-162 86899.37,-169"/>
<text text-anchor="middle" x="85851.5" y="-127.8" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer4_router&#45;&gt;layer4_expert_7_gate -->
<g id="edge632" class="edge">
<title>layer4_router&#45;&gt;layer4_expert_7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85941.14,-128.74C85964.73,-128.32 85990.16,-128.13 86013.67,-128.5 86022.07,-128.63 86030.89,-128.83 86039.63,-129.07"/>
<polygon fill="black" stroke="black" points="86039.73,-132.57 86049.82,-129.35 86039.93,-125.57 86039.73,-132.57"/>
</g>
<!-- layer4_router&#45;&gt;layer4_expert_7_gate -->
<g id="edge744" class="edge">
<title>layer4_router&#45;&gt;layer4_expert_7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M85941.03,-131.5C85973.43,-131.5 86009.49,-131.5 86039.83,-131.5"/>
<polygon fill="black" stroke="black" points="86039.88,-135 86049.88,-131.5 86039.88,-128 86039.88,-135"/>
<text text-anchor="middle" x="85995.5" y="-138.3" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- layer4_expert_0_up -->
<g id="node434" class="node">
<title>layer4_expert_0_up</title>
<path fill="lightcoral" stroke="black" d="M91937.5,-165.5C91937.5,-165.5 91821.5,-165.5 91821.5,-165.5 91815.5,-165.5 91809.5,-159.5 91809.5,-153.5 91809.5,-153.5 91809.5,-109.5 91809.5,-109.5 91809.5,-103.5 91815.5,-97.5 91821.5,-97.5 91821.5,-97.5 91937.5,-97.5 91937.5,-97.5 91943.5,-97.5 91949.5,-103.5 91949.5,-109.5 91949.5,-109.5 91949.5,-153.5 91949.5,-153.5 91949.5,-159.5 91943.5,-165.5 91937.5,-165.5"/>
<text text-anchor="middle" x="91879.5" y="-150.3" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="91879.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="91879.5" y="-120.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="91879.5" y="-105.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_expert_0_gate&#45;&gt;layer4_expert_0_up -->
<g id="edge705" class="edge">
<title>layer4_expert_0_gate&#45;&gt;layer4_expert_0_up</title>
<path fill="none" stroke="black" d="M91774.12,-131.5C91782.41,-131.5 91790.7,-131.5 91798.99,-131.5"/>
<polygon fill="black" stroke="black" points="91799.11,-135 91809.11,-131.5 91799.11,-128 91799.11,-135"/>
</g>
<!-- layer4_expert_1_up -->
<g id="node438" class="node">
<title>layer4_expert_1_up</title>
<path fill="lightcoral" stroke="black" d="M91136.5,-165.5C91136.5,-165.5 91020.5,-165.5 91020.5,-165.5 91014.5,-165.5 91008.5,-159.5 91008.5,-153.5 91008.5,-153.5 91008.5,-109.5 91008.5,-109.5 91008.5,-103.5 91014.5,-97.5 91020.5,-97.5 91020.5,-97.5 91136.5,-97.5 91136.5,-97.5 91142.5,-97.5 91148.5,-103.5 91148.5,-109.5 91148.5,-109.5 91148.5,-153.5 91148.5,-153.5 91148.5,-159.5 91142.5,-165.5 91136.5,-165.5"/>
<text text-anchor="middle" x="91078.5" y="-150.3" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="91078.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="91078.5" y="-120.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="91078.5" y="-105.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_expert_1_gate&#45;&gt;layer4_expert_1_up -->
<g id="edge710" class="edge">
<title>layer4_expert_1_gate&#45;&gt;layer4_expert_1_up</title>
<path fill="none" stroke="black" d="M90973.12,-131.5C90981.41,-131.5 90989.7,-131.5 90997.99,-131.5"/>
<polygon fill="black" stroke="black" points="90998.11,-135 91008.11,-131.5 90998.11,-128 90998.11,-135"/>
</g>
<!-- layer4_expert_2_up -->
<g id="node442" class="node">
<title>layer4_expert_2_up</title>
<path fill="lightcoral" stroke="black" d="M90335.5,-165.5C90335.5,-165.5 90219.5,-165.5 90219.5,-165.5 90213.5,-165.5 90207.5,-159.5 90207.5,-153.5 90207.5,-153.5 90207.5,-109.5 90207.5,-109.5 90207.5,-103.5 90213.5,-97.5 90219.5,-97.5 90219.5,-97.5 90335.5,-97.5 90335.5,-97.5 90341.5,-97.5 90347.5,-103.5 90347.5,-109.5 90347.5,-109.5 90347.5,-153.5 90347.5,-153.5 90347.5,-159.5 90341.5,-165.5 90335.5,-165.5"/>
<text text-anchor="middle" x="90277.5" y="-150.3" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="90277.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="90277.5" y="-120.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="90277.5" y="-105.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_expert_2_gate&#45;&gt;layer4_expert_2_up -->
<g id="edge715" class="edge">
<title>layer4_expert_2_gate&#45;&gt;layer4_expert_2_up</title>
<path fill="none" stroke="black" d="M90172.12,-131.5C90180.41,-131.5 90188.7,-131.5 90196.99,-131.5"/>
<polygon fill="black" stroke="black" points="90197.11,-135 90207.11,-131.5 90197.11,-128 90197.11,-135"/>
</g>
<!-- layer4_expert_3_up -->
<g id="node446" class="node">
<title>layer4_expert_3_up</title>
<path fill="lightcoral" stroke="black" d="M89534.5,-165.5C89534.5,-165.5 89418.5,-165.5 89418.5,-165.5 89412.5,-165.5 89406.5,-159.5 89406.5,-153.5 89406.5,-153.5 89406.5,-109.5 89406.5,-109.5 89406.5,-103.5 89412.5,-97.5 89418.5,-97.5 89418.5,-97.5 89534.5,-97.5 89534.5,-97.5 89540.5,-97.5 89546.5,-103.5 89546.5,-109.5 89546.5,-109.5 89546.5,-153.5 89546.5,-153.5 89546.5,-159.5 89540.5,-165.5 89534.5,-165.5"/>
<text text-anchor="middle" x="89476.5" y="-150.3" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="89476.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="89476.5" y="-120.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="89476.5" y="-105.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_expert_3_gate&#45;&gt;layer4_expert_3_up -->
<g id="edge720" class="edge">
<title>layer4_expert_3_gate&#45;&gt;layer4_expert_3_up</title>
<path fill="none" stroke="black" d="M89371.12,-131.5C89379.41,-131.5 89387.7,-131.5 89395.99,-131.5"/>
<polygon fill="black" stroke="black" points="89396.11,-135 89406.11,-131.5 89396.11,-128 89396.11,-135"/>
</g>
<!-- layer4_expert_4_up -->
<g id="node450" class="node">
<title>layer4_expert_4_up</title>
<path fill="lightcoral" stroke="black" d="M88733.5,-165.5C88733.5,-165.5 88617.5,-165.5 88617.5,-165.5 88611.5,-165.5 88605.5,-159.5 88605.5,-153.5 88605.5,-153.5 88605.5,-109.5 88605.5,-109.5 88605.5,-103.5 88611.5,-97.5 88617.5,-97.5 88617.5,-97.5 88733.5,-97.5 88733.5,-97.5 88739.5,-97.5 88745.5,-103.5 88745.5,-109.5 88745.5,-109.5 88745.5,-153.5 88745.5,-153.5 88745.5,-159.5 88739.5,-165.5 88733.5,-165.5"/>
<text text-anchor="middle" x="88675.5" y="-150.3" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="88675.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="88675.5" y="-120.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="88675.5" y="-105.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_expert_4_gate&#45;&gt;layer4_expert_4_up -->
<g id="edge725" class="edge">
<title>layer4_expert_4_gate&#45;&gt;layer4_expert_4_up</title>
<path fill="none" stroke="black" d="M88570.12,-131.5C88578.41,-131.5 88586.7,-131.5 88594.99,-131.5"/>
<polygon fill="black" stroke="black" points="88595.11,-135 88605.11,-131.5 88595.11,-128 88595.11,-135"/>
</g>
<!-- layer4_expert_5_up -->
<g id="node454" class="node">
<title>layer4_expert_5_up</title>
<path fill="lightcoral" stroke="black" d="M87932.5,-165.5C87932.5,-165.5 87816.5,-165.5 87816.5,-165.5 87810.5,-165.5 87804.5,-159.5 87804.5,-153.5 87804.5,-153.5 87804.5,-109.5 87804.5,-109.5 87804.5,-103.5 87810.5,-97.5 87816.5,-97.5 87816.5,-97.5 87932.5,-97.5 87932.5,-97.5 87938.5,-97.5 87944.5,-103.5 87944.5,-109.5 87944.5,-109.5 87944.5,-153.5 87944.5,-153.5 87944.5,-159.5 87938.5,-165.5 87932.5,-165.5"/>
<text text-anchor="middle" x="87874.5" y="-150.3" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="87874.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="87874.5" y="-120.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="87874.5" y="-105.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_expert_5_gate&#45;&gt;layer4_expert_5_up -->
<g id="edge730" class="edge">
<title>layer4_expert_5_gate&#45;&gt;layer4_expert_5_up</title>
<path fill="none" stroke="black" d="M87769.12,-131.5C87777.41,-131.5 87785.7,-131.5 87793.99,-131.5"/>
<polygon fill="black" stroke="black" points="87794.11,-135 87804.11,-131.5 87794.11,-128 87794.11,-135"/>
</g>
<!-- layer4_expert_6_up -->
<g id="node458" class="node">
<title>layer4_expert_6_up</title>
<path fill="lightcoral" stroke="black" d="M87131.5,-165.5C87131.5,-165.5 87015.5,-165.5 87015.5,-165.5 87009.5,-165.5 87003.5,-159.5 87003.5,-153.5 87003.5,-153.5 87003.5,-109.5 87003.5,-109.5 87003.5,-103.5 87009.5,-97.5 87015.5,-97.5 87015.5,-97.5 87131.5,-97.5 87131.5,-97.5 87137.5,-97.5 87143.5,-103.5 87143.5,-109.5 87143.5,-109.5 87143.5,-153.5 87143.5,-153.5 87143.5,-159.5 87137.5,-165.5 87131.5,-165.5"/>
<text text-anchor="middle" x="87073.5" y="-150.3" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="87073.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="87073.5" y="-120.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="87073.5" y="-105.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_expert_6_gate&#45;&gt;layer4_expert_6_up -->
<g id="edge735" class="edge">
<title>layer4_expert_6_gate&#45;&gt;layer4_expert_6_up</title>
<path fill="none" stroke="black" d="M86968.12,-131.5C86976.41,-131.5 86984.7,-131.5 86992.99,-131.5"/>
<polygon fill="black" stroke="black" points="86993.11,-135 87003.11,-131.5 86993.11,-128 86993.11,-135"/>
</g>
<!-- layer4_expert_7_up -->
<g id="node462" class="node">
<title>layer4_expert_7_up</title>
<path fill="lightcoral" stroke="black" d="M86330.5,-165.5C86330.5,-165.5 86214.5,-165.5 86214.5,-165.5 86208.5,-165.5 86202.5,-159.5 86202.5,-153.5 86202.5,-153.5 86202.5,-109.5 86202.5,-109.5 86202.5,-103.5 86208.5,-97.5 86214.5,-97.5 86214.5,-97.5 86330.5,-97.5 86330.5,-97.5 86336.5,-97.5 86342.5,-103.5 86342.5,-109.5 86342.5,-109.5 86342.5,-153.5 86342.5,-153.5 86342.5,-159.5 86336.5,-165.5 86330.5,-165.5"/>
<text text-anchor="middle" x="86272.5" y="-150.3" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="86272.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="86272.5" y="-120.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="86272.5" y="-105.3" font-family="Times,serif" font-size="14.00">(Column Parallel)</text>
</g>
<!-- layer4_expert_7_gate&#45;&gt;layer4_expert_7_up -->
<g id="edge740" class="edge">
<title>layer4_expert_7_gate&#45;&gt;layer4_expert_7_up</title>
<path fill="none" stroke="black" d="M86167.12,-131.5C86175.41,-131.5 86183.7,-131.5 86191.99,-131.5"/>
<polygon fill="black" stroke="black" points="86192.11,-135 86202.11,-131.5 86192.11,-128 86192.11,-135"/>
</g>
<!-- layer4_moe_agg -->
<g id="node411" class="node">
<title>layer4_moe_agg</title>
<path fill="lightpink" stroke="black" d="M92605.5,-173C92605.5,-173 92487.5,-173 92487.5,-173 92481.5,-173 92475.5,-167 92475.5,-161 92475.5,-161 92475.5,-102 92475.5,-102 92475.5,-96 92481.5,-90 92487.5,-90 92487.5,-90 92605.5,-90 92605.5,-90 92611.5,-90 92617.5,-96 92617.5,-102 92617.5,-102 92617.5,-161 92617.5,-161 92617.5,-167 92611.5,-173 92605.5,-173"/>
<text text-anchor="middle" x="92546.5" y="-157.8" font-family="Times,serif" font-size="14.00">MoE Aggregation</text>
<text text-anchor="middle" x="92546.5" y="-142.8" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="92546.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="92546.5" y="-112.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="92546.5" y="-97.8" font-family="Times,serif" font-size="14.00">(AllReduce)</text>
</g>
<!-- layer4_moe_agg&#45;&gt;layer4_residual2 -->
<g id="edge634" class="edge">
<title>layer4_moe_agg&#45;&gt;layer4_residual2</title>
<path fill="none" stroke="black" d="M92617.8,-131.5C92626.21,-131.5 92634.62,-131.5 92643.03,-131.5"/>
<polygon fill="black" stroke="black" points="92643.29,-135 92653.29,-131.5 92643.29,-128 92643.29,-135"/>
</g>
<!-- output -->
<g id="node466" class="node">
<title>output</title>
<path fill="lightgreen" stroke="black" d="M92754,-53C92754,-53 92677,-53 92677,-53 92671,-53 92665,-47 92665,-41 92665,-41 92665,-12 92665,-12 92665,-6 92671,0 92677,0 92677,0 92754,0 92754,0 92760,0 92766,-6 92766,-12 92766,-12 92766,-41 92766,-41 92766,-47 92760,-53 92754,-53"/>
<text text-anchor="middle" x="92715.5" y="-37.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="92715.5" y="-22.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="92715.5" y="-7.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- layer4_residual2&#45;&gt;output -->
<g id="edge753" class="edge">
<title>layer4_residual2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M92715.5,-104.77C92715.5,-92.24 92715.5,-76.96 92715.5,-63.31"/>
<polygon fill="black" stroke="black" points="92719,-63.25 92715.5,-53.25 92712,-63.25 92719,-63.25"/>
</g>
<!-- layer4_concat_dim_0 -->
<g id="node429" class="node">
<title>layer4_concat_dim_0</title>
<path fill="lightpink" stroke="black" d="M85027.5,-173C85027.5,-173 84905.5,-173 84905.5,-173 84899.5,-173 84893.5,-167 84893.5,-161 84893.5,-161 84893.5,-102 84893.5,-102 84893.5,-96 84899.5,-90 84905.5,-90 84905.5,-90 85027.5,-90 85027.5,-90 85033.5,-90 85039.5,-96 85039.5,-102 85039.5,-102 85039.5,-161 85039.5,-161 85039.5,-167 85033.5,-173 85027.5,-173"/>
<text text-anchor="middle" x="84966.5" y="-157.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="84966.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="84966.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 2048]</text>
<text text-anchor="middle" x="84966.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPUs 0&#45;3</text>
<text text-anchor="middle" x="84966.5" y="-97.8" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer4_attn_0_0&#45;&gt;layer4_concat_dim_0 -->
<g id="edge684" class="edge">
<title>layer4_attn_0_0&#45;&gt;layer4_concat_dim_0</title>
<path fill="none" stroke="black" d="M84858.02,-131.5C84866.35,-131.5 84874.69,-131.5 84883.02,-131.5"/>
<polygon fill="black" stroke="black" points="84883.19,-135 84893.19,-131.5 84883.19,-128 84883.19,-135"/>
</g>
<!-- layer4_attn_0_1&#45;&gt;layer4_concat_dim_0 -->
<g id="edge685" class="edge">
<title>layer4_attn_0_1&#45;&gt;layer4_concat_dim_0</title>
<path fill="none" stroke="black" d="M83885.16,-165.58C83906.61,-178.6 83932.75,-191.9 83958.5,-198.5 84055.36,-223.35 84762.33,-225.91 84858.5,-198.5 84874.05,-194.07 84889.55,-186.68 84903.75,-178.4"/>
<polygon fill="black" stroke="black" points="84905.68,-181.32 84912.42,-173.14 84902.05,-175.34 84905.68,-181.32"/>
</g>
<!-- layer4_attn_0_2&#45;&gt;layer4_concat_dim_0 -->
<g id="edge686" class="edge">
<title>layer4_attn_0_2&#45;&gt;layer4_concat_dim_0</title>
<path fill="none" stroke="black" d="M82967.16,-165.58C82988.61,-178.6 83014.75,-191.9 83040.5,-198.5 83138.33,-223.6 84761.37,-226.18 84858.5,-198.5 84874.05,-194.07 84889.55,-186.68 84903.75,-178.4"/>
<polygon fill="black" stroke="black" points="84905.68,-181.32 84912.42,-173.14 84902.05,-175.34 84905.68,-181.32"/>
</g>
<!-- layer4_attn_0_3&#45;&gt;layer4_concat_dim_0 -->
<g id="edge687" class="edge">
<title>layer4_attn_0_3&#45;&gt;layer4_concat_dim_0</title>
<path fill="none" stroke="black" d="M82049.16,-165.58C82070.61,-178.6 82096.75,-191.9 82122.5,-198.5 82196.12,-217.38 84785.41,-219.33 84858.5,-198.5 84874.05,-194.07 84889.55,-186.68 84903.75,-178.4"/>
<polygon fill="black" stroke="black" points="84905.68,-181.32 84912.42,-173.14 84902.05,-175.34 84905.68,-181.32"/>
</g>
<!-- layer4_concat_dim_1 -->
<g id="node430" class="node">
<title>layer4_concat_dim_1</title>
<path fill="lightpink" stroke="black" d="M81173.5,-173C81173.5,-173 81051.5,-173 81051.5,-173 81045.5,-173 81039.5,-167 81039.5,-161 81039.5,-161 81039.5,-102 81039.5,-102 81039.5,-96 81045.5,-90 81051.5,-90 81051.5,-90 81173.5,-90 81173.5,-90 81179.5,-90 81185.5,-96 81185.5,-102 81185.5,-102 81185.5,-161 81185.5,-161 81185.5,-167 81179.5,-173 81173.5,-173"/>
<text text-anchor="middle" x="81112.5" y="-157.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="81112.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="81112.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 2048]</text>
<text text-anchor="middle" x="81112.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPUs 4&#45;7</text>
<text text-anchor="middle" x="81112.5" y="-97.8" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer4_attn_1_0&#45;&gt;layer4_concat_dim_1 -->
<g id="edge688" class="edge">
<title>layer4_attn_1_0&#45;&gt;layer4_concat_dim_1</title>
<path fill="none" stroke="black" d="M81004.02,-131.5C81012.35,-131.5 81020.69,-131.5 81029.02,-131.5"/>
<polygon fill="black" stroke="black" points="81029.19,-135 81039.19,-131.5 81029.19,-128 81029.19,-135"/>
</g>
<!-- layer4_attn_1_1&#45;&gt;layer4_concat_dim_1 -->
<g id="edge689" class="edge">
<title>layer4_attn_1_1&#45;&gt;layer4_concat_dim_1</title>
<path fill="none" stroke="black" d="M80031.16,-165.58C80052.61,-178.6 80078.75,-191.9 80104.5,-198.5 80201.36,-223.35 80908.33,-225.91 81004.5,-198.5 81020.05,-194.07 81035.55,-186.68 81049.75,-178.4"/>
<polygon fill="black" stroke="black" points="81051.68,-181.32 81058.42,-173.14 81048.05,-175.34 81051.68,-181.32"/>
</g>
<!-- layer4_attn_1_2&#45;&gt;layer4_concat_dim_1 -->
<g id="edge690" class="edge">
<title>layer4_attn_1_2&#45;&gt;layer4_concat_dim_1</title>
<path fill="none" stroke="black" d="M79113.16,-165.58C79134.61,-178.6 79160.75,-191.9 79186.5,-198.5 79284.33,-223.6 80907.37,-226.18 81004.5,-198.5 81020.05,-194.07 81035.55,-186.68 81049.75,-178.4"/>
<polygon fill="black" stroke="black" points="81051.68,-181.32 81058.42,-173.14 81048.05,-175.34 81051.68,-181.32"/>
</g>
<!-- layer4_attn_1_3&#45;&gt;layer4_concat_dim_1 -->
<g id="edge691" class="edge">
<title>layer4_attn_1_3&#45;&gt;layer4_concat_dim_1</title>
<path fill="none" stroke="black" d="M78195.16,-165.58C78216.61,-178.6 78242.75,-191.9 78268.5,-198.5 78342.12,-217.38 80931.41,-219.33 81004.5,-198.5 81020.05,-194.07 81035.55,-186.68 81049.75,-178.4"/>
<polygon fill="black" stroke="black" points="81051.68,-181.32 81058.42,-173.14 81048.05,-175.34 81051.68,-181.32"/>
</g>
<!-- layer4_concat_dim_2 -->
<g id="node431" class="node">
<title>layer4_concat_dim_2</title>
<path fill="lightpink" stroke="black" d="M77319.5,-173C77319.5,-173 77197.5,-173 77197.5,-173 77191.5,-173 77185.5,-167 77185.5,-161 77185.5,-161 77185.5,-102 77185.5,-102 77185.5,-96 77191.5,-90 77197.5,-90 77197.5,-90 77319.5,-90 77319.5,-90 77325.5,-90 77331.5,-96 77331.5,-102 77331.5,-102 77331.5,-161 77331.5,-161 77331.5,-167 77325.5,-173 77319.5,-173"/>
<text text-anchor="middle" x="77258.5" y="-157.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="77258.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="77258.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 2048]</text>
<text text-anchor="middle" x="77258.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPUs 8&#45;11</text>
<text text-anchor="middle" x="77258.5" y="-97.8" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer4_attn_2_0&#45;&gt;layer4_concat_dim_2 -->
<g id="edge692" class="edge">
<title>layer4_attn_2_0&#45;&gt;layer4_concat_dim_2</title>
<path fill="none" stroke="black" d="M77150.02,-131.5C77158.35,-131.5 77166.69,-131.5 77175.02,-131.5"/>
<polygon fill="black" stroke="black" points="77175.19,-135 77185.19,-131.5 77175.19,-128 77175.19,-135"/>
</g>
<!-- layer4_attn_2_1&#45;&gt;layer4_concat_dim_2 -->
<g id="edge693" class="edge">
<title>layer4_attn_2_1&#45;&gt;layer4_concat_dim_2</title>
<path fill="none" stroke="black" d="M76177.16,-165.58C76198.61,-178.6 76224.75,-191.9 76250.5,-198.5 76347.36,-223.35 77054.33,-225.91 77150.5,-198.5 77166.05,-194.07 77181.55,-186.68 77195.75,-178.4"/>
<polygon fill="black" stroke="black" points="77197.68,-181.32 77204.42,-173.14 77194.05,-175.34 77197.68,-181.32"/>
</g>
<!-- layer4_attn_2_2&#45;&gt;layer4_concat_dim_2 -->
<g id="edge694" class="edge">
<title>layer4_attn_2_2&#45;&gt;layer4_concat_dim_2</title>
<path fill="none" stroke="black" d="M75259.16,-165.58C75280.61,-178.6 75306.75,-191.9 75332.5,-198.5 75430.33,-223.6 77053.37,-226.18 77150.5,-198.5 77166.05,-194.07 77181.55,-186.68 77195.75,-178.4"/>
<polygon fill="black" stroke="black" points="77197.68,-181.32 77204.42,-173.14 77194.05,-175.34 77197.68,-181.32"/>
</g>
<!-- layer4_attn_2_3&#45;&gt;layer4_concat_dim_2 -->
<g id="edge695" class="edge">
<title>layer4_attn_2_3&#45;&gt;layer4_concat_dim_2</title>
<path fill="none" stroke="black" d="M74341.16,-165.58C74362.61,-178.6 74388.75,-191.9 74414.5,-198.5 74488.12,-217.38 77077.41,-219.33 77150.5,-198.5 77166.05,-194.07 77181.55,-186.68 77195.75,-178.4"/>
<polygon fill="black" stroke="black" points="77197.68,-181.32 77204.42,-173.14 77194.05,-175.34 77197.68,-181.32"/>
</g>
<!-- layer4_concat_dim_3 -->
<g id="node432" class="node">
<title>layer4_concat_dim_3</title>
<path fill="lightpink" stroke="black" d="M73465.5,-173C73465.5,-173 73343.5,-173 73343.5,-173 73337.5,-173 73331.5,-167 73331.5,-161 73331.5,-161 73331.5,-102 73331.5,-102 73331.5,-96 73337.5,-90 73343.5,-90 73343.5,-90 73465.5,-90 73465.5,-90 73471.5,-90 73477.5,-96 73477.5,-102 73477.5,-102 73477.5,-161 73477.5,-161 73477.5,-167 73471.5,-173 73465.5,-173"/>
<text text-anchor="middle" x="73404.5" y="-157.8" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="73404.5" y="-142.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="73404.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 2048]</text>
<text text-anchor="middle" x="73404.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPUs 12&#45;15</text>
<text text-anchor="middle" x="73404.5" y="-97.8" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer4_attn_3_0&#45;&gt;layer4_concat_dim_3 -->
<g id="edge696" class="edge">
<title>layer4_attn_3_0&#45;&gt;layer4_concat_dim_3</title>
<path fill="none" stroke="black" d="M73296.02,-131.5C73304.35,-131.5 73312.69,-131.5 73321.02,-131.5"/>
<polygon fill="black" stroke="black" points="73321.19,-135 73331.19,-131.5 73321.19,-128 73321.19,-135"/>
</g>
<!-- layer4_attn_3_1&#45;&gt;layer4_concat_dim_3 -->
<g id="edge697" class="edge">
<title>layer4_attn_3_1&#45;&gt;layer4_concat_dim_3</title>
<path fill="none" stroke="black" d="M72323.16,-165.58C72344.61,-178.6 72370.75,-191.9 72396.5,-198.5 72493.36,-223.35 73200.33,-225.91 73296.5,-198.5 73312.05,-194.07 73327.55,-186.68 73341.75,-178.4"/>
<polygon fill="black" stroke="black" points="73343.68,-181.32 73350.42,-173.14 73340.05,-175.34 73343.68,-181.32"/>
</g>
<!-- layer4_attn_3_2&#45;&gt;layer4_concat_dim_3 -->
<g id="edge698" class="edge">
<title>layer4_attn_3_2&#45;&gt;layer4_concat_dim_3</title>
<path fill="none" stroke="black" d="M71405.16,-165.58C71426.61,-178.6 71452.75,-191.9 71478.5,-198.5 71576.33,-223.6 73199.37,-226.18 73296.5,-198.5 73312.05,-194.07 73327.55,-186.68 73341.75,-178.4"/>
<polygon fill="black" stroke="black" points="73343.68,-181.32 73350.42,-173.14 73340.05,-175.34 73343.68,-181.32"/>
</g>
<!-- layer4_attn_3_3&#45;&gt;layer4_concat_dim_3 -->
<g id="edge699" class="edge">
<title>layer4_attn_3_3&#45;&gt;layer4_concat_dim_3</title>
<path fill="none" stroke="black" d="M70487.16,-165.58C70508.61,-178.6 70534.75,-191.9 70560.5,-198.5 70634.12,-217.38 73223.41,-219.33 73296.5,-198.5 73312.05,-194.07 73327.55,-186.68 73341.75,-178.4"/>
<polygon fill="black" stroke="black" points="73343.68,-181.32 73350.42,-173.14 73340.05,-175.34 73343.68,-181.32"/>
</g>
<!-- layer4_concat_heads -->
<g id="node433" class="node">
<title>layer4_concat_heads</title>
<path fill="lightpink" stroke="black" d="M85227.5,-165.5C85227.5,-165.5 85087.5,-165.5 85087.5,-165.5 85081.5,-165.5 85075.5,-159.5 85075.5,-153.5 85075.5,-153.5 85075.5,-109.5 85075.5,-109.5 85075.5,-103.5 85081.5,-97.5 85087.5,-97.5 85087.5,-97.5 85227.5,-97.5 85227.5,-97.5 85233.5,-97.5 85239.5,-103.5 85239.5,-109.5 85239.5,-109.5 85239.5,-153.5 85239.5,-153.5 85239.5,-159.5 85233.5,-165.5 85227.5,-165.5"/>
<text text-anchor="middle" x="85157.5" y="-150.3" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="85157.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="85157.5" y="-120.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
<text text-anchor="middle" x="85157.5" y="-105.3" font-family="Times,serif" font-size="14.00">(AllGather)</text>
</g>
<!-- layer4_concat_dim_0&#45;&gt;layer4_concat_heads -->
<g id="edge700" class="edge">
<title>layer4_concat_dim_0&#45;&gt;layer4_concat_heads</title>
<path fill="none" stroke="black" d="M85039.62,-131.5C85048.02,-131.5 85056.42,-131.5 85064.82,-131.5"/>
<polygon fill="black" stroke="black" points="85065.07,-135 85075.07,-131.5 85065.07,-128 85065.07,-135"/>
</g>
<!-- layer4_concat_dim_1&#45;&gt;layer4_concat_heads -->
<g id="edge701" class="edge">
<title>layer4_concat_dim_1&#45;&gt;layer4_concat_heads</title>
<path fill="none" stroke="black" d="M81158,-173.24C81171.93,-183.52 81187.97,-193.12 81204.5,-198.5 81305.8,-231.48 84936.5,-225.7 85039.5,-198.5 85061.13,-192.79 85082.95,-182.09 85101.84,-170.9"/>
<polygon fill="black" stroke="black" points="85103.87,-173.76 85110.58,-165.56 85100.23,-167.79 85103.87,-173.76"/>
</g>
<!-- layer4_concat_dim_2&#45;&gt;layer4_concat_heads -->
<g id="edge702" class="edge">
<title>layer4_concat_dim_2&#45;&gt;layer4_concat_heads</title>
<path fill="none" stroke="black" d="M77304,-173.24C77317.93,-183.52 77333.97,-193.12 77350.5,-198.5 77452.05,-231.56 84936.25,-225.77 85039.5,-198.5 85061.13,-192.79 85082.95,-182.09 85101.84,-170.9"/>
<polygon fill="black" stroke="black" points="85103.87,-173.76 85110.58,-165.56 85100.23,-167.79 85103.87,-173.76"/>
</g>
<!-- layer4_concat_dim_3&#45;&gt;layer4_concat_heads -->
<g id="edge703" class="edge">
<title>layer4_concat_dim_3&#45;&gt;layer4_concat_heads</title>
<path fill="none" stroke="black" d="M73450,-173.24C73463.93,-183.52 73479.97,-193.12 73496.5,-198.5 73572.72,-223.31 84962,-218.97 85039.5,-198.5 85061.13,-192.79 85082.95,-182.09 85101.84,-170.9"/>
<polygon fill="black" stroke="black" points="85103.87,-173.76 85110.58,-165.56 85100.23,-167.79 85103.87,-173.76"/>
</g>
<!-- layer4_concat_heads&#45;&gt;layer4_out_proj -->
<g id="edge704" class="edge">
<title>layer4_concat_heads&#45;&gt;layer4_out_proj</title>
<path fill="none" stroke="black" d="M85239.51,-131.5C85248.1,-131.5 85256.69,-131.5 85265.28,-131.5"/>
<polygon fill="black" stroke="black" points="85265.37,-135 85275.37,-131.5 85265.37,-128 85265.37,-135"/>
</g>
<!-- layer4_expert_0_act -->
<g id="node435" class="node">
<title>layer4_expert_0_act</title>
<path fill="lightyellow" stroke="black" d="M92098,-158C92098,-158 91997,-158 91997,-158 91991,-158 91985,-152 91985,-146 91985,-146 91985,-117 91985,-117 91985,-111 91991,-105 91997,-105 91997,-105 92098,-105 92098,-105 92104,-105 92110,-111 92110,-117 92110,-117 92110,-146 92110,-146 92110,-152 92104,-158 92098,-158"/>
<text text-anchor="middle" x="92047.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="92047.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="92047.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer4_expert_0_up&#45;&gt;layer4_expert_0_act -->
<g id="edge706" class="edge">
<title>layer4_expert_0_up&#45;&gt;layer4_expert_0_act</title>
<path fill="none" stroke="black" d="M91949.72,-131.5C91958.05,-131.5 91966.37,-131.5 91974.7,-131.5"/>
<polygon fill="black" stroke="black" points="91974.86,-135 91984.86,-131.5 91974.86,-128 91974.86,-135"/>
</g>
<!-- layer4_expert_0_down -->
<g id="node436" class="node">
<title>layer4_expert_0_down</title>
<path fill="lightcoral" stroke="black" d="M92257.5,-165.5C92257.5,-165.5 92157.5,-165.5 92157.5,-165.5 92151.5,-165.5 92145.5,-159.5 92145.5,-153.5 92145.5,-153.5 92145.5,-109.5 92145.5,-109.5 92145.5,-103.5 92151.5,-97.5 92157.5,-97.5 92157.5,-97.5 92257.5,-97.5 92257.5,-97.5 92263.5,-97.5 92269.5,-103.5 92269.5,-109.5 92269.5,-109.5 92269.5,-153.5 92269.5,-153.5 92269.5,-159.5 92263.5,-165.5 92257.5,-165.5"/>
<text text-anchor="middle" x="92207.5" y="-150.3" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="92207.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="92207.5" y="-120.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="92207.5" y="-105.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer4_expert_0_act&#45;&gt;layer4_expert_0_down -->
<g id="edge707" class="edge">
<title>layer4_expert_0_act&#45;&gt;layer4_expert_0_down</title>
<path fill="none" stroke="black" d="M92110.31,-131.5C92118.59,-131.5 92126.87,-131.5 92135.14,-131.5"/>
<polygon fill="black" stroke="black" points="92135.24,-135 92145.24,-131.5 92135.24,-128 92135.24,-135"/>
</g>
<!-- layer4_expert_0_out -->
<g id="node437" class="node">
<title>layer4_expert_0_out</title>
<path fill="lightpink" stroke="black" d="M92427.5,-158C92427.5,-158 92317.5,-158 92317.5,-158 92311.5,-158 92305.5,-152 92305.5,-146 92305.5,-146 92305.5,-117 92305.5,-117 92305.5,-111 92311.5,-105 92317.5,-105 92317.5,-105 92427.5,-105 92427.5,-105 92433.5,-105 92439.5,-111 92439.5,-117 92439.5,-117 92439.5,-146 92439.5,-146 92439.5,-152 92433.5,-158 92427.5,-158"/>
<text text-anchor="middle" x="92372.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 0 Output</text>
<text text-anchor="middle" x="92372.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="92372.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer4_expert_0_down&#45;&gt;layer4_expert_0_out -->
<g id="edge708" class="edge">
<title>layer4_expert_0_down&#45;&gt;layer4_expert_0_out</title>
<path fill="none" stroke="black" d="M92269.7,-131.5C92278.26,-131.5 92286.82,-131.5 92295.39,-131.5"/>
<polygon fill="black" stroke="black" points="92295.44,-135 92305.44,-131.5 92295.44,-128 92295.44,-135"/>
</g>
<!-- layer4_expert_0_out&#45;&gt;layer4_moe_agg -->
<g id="edge745" class="edge">
<title>layer4_expert_0_out&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M92439.79,-131.5C92448.19,-131.5 92456.58,-131.5 92464.98,-131.5"/>
<polygon fill="black" stroke="black" points="92465.22,-135 92475.22,-131.5 92465.22,-128 92465.22,-135"/>
</g>
<!-- layer4_expert_1_act -->
<g id="node439" class="node">
<title>layer4_expert_1_act</title>
<path fill="lightyellow" stroke="black" d="M91297,-158C91297,-158 91196,-158 91196,-158 91190,-158 91184,-152 91184,-146 91184,-146 91184,-117 91184,-117 91184,-111 91190,-105 91196,-105 91196,-105 91297,-105 91297,-105 91303,-105 91309,-111 91309,-117 91309,-117 91309,-146 91309,-146 91309,-152 91303,-158 91297,-158"/>
<text text-anchor="middle" x="91246.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="91246.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="91246.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer4_expert_1_up&#45;&gt;layer4_expert_1_act -->
<g id="edge711" class="edge">
<title>layer4_expert_1_up&#45;&gt;layer4_expert_1_act</title>
<path fill="none" stroke="black" d="M91148.72,-131.5C91157.05,-131.5 91165.37,-131.5 91173.7,-131.5"/>
<polygon fill="black" stroke="black" points="91173.86,-135 91183.86,-131.5 91173.86,-128 91173.86,-135"/>
</g>
<!-- layer4_expert_1_down -->
<g id="node440" class="node">
<title>layer4_expert_1_down</title>
<path fill="lightcoral" stroke="black" d="M91456.5,-165.5C91456.5,-165.5 91356.5,-165.5 91356.5,-165.5 91350.5,-165.5 91344.5,-159.5 91344.5,-153.5 91344.5,-153.5 91344.5,-109.5 91344.5,-109.5 91344.5,-103.5 91350.5,-97.5 91356.5,-97.5 91356.5,-97.5 91456.5,-97.5 91456.5,-97.5 91462.5,-97.5 91468.5,-103.5 91468.5,-109.5 91468.5,-109.5 91468.5,-153.5 91468.5,-153.5 91468.5,-159.5 91462.5,-165.5 91456.5,-165.5"/>
<text text-anchor="middle" x="91406.5" y="-150.3" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="91406.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="91406.5" y="-120.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="91406.5" y="-105.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer4_expert_1_act&#45;&gt;layer4_expert_1_down -->
<g id="edge712" class="edge">
<title>layer4_expert_1_act&#45;&gt;layer4_expert_1_down</title>
<path fill="none" stroke="black" d="M91309.31,-131.5C91317.59,-131.5 91325.87,-131.5 91334.14,-131.5"/>
<polygon fill="black" stroke="black" points="91334.24,-135 91344.24,-131.5 91334.24,-128 91334.24,-135"/>
</g>
<!-- layer4_expert_1_out -->
<g id="node441" class="node">
<title>layer4_expert_1_out</title>
<path fill="lightpink" stroke="black" d="M91626.5,-158C91626.5,-158 91516.5,-158 91516.5,-158 91510.5,-158 91504.5,-152 91504.5,-146 91504.5,-146 91504.5,-117 91504.5,-117 91504.5,-111 91510.5,-105 91516.5,-105 91516.5,-105 91626.5,-105 91626.5,-105 91632.5,-105 91638.5,-111 91638.5,-117 91638.5,-117 91638.5,-146 91638.5,-146 91638.5,-152 91632.5,-158 91626.5,-158"/>
<text text-anchor="middle" x="91571.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 1 Output</text>
<text text-anchor="middle" x="91571.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="91571.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer4_expert_1_down&#45;&gt;layer4_expert_1_out -->
<g id="edge713" class="edge">
<title>layer4_expert_1_down&#45;&gt;layer4_expert_1_out</title>
<path fill="none" stroke="black" d="M91468.7,-131.5C91477.26,-131.5 91485.82,-131.5 91494.39,-131.5"/>
<polygon fill="black" stroke="black" points="91494.44,-135 91504.44,-131.5 91494.44,-128 91494.44,-135"/>
</g>
<!-- layer4_expert_1_out&#45;&gt;layer4_moe_agg -->
<g id="edge746" class="edge">
<title>layer4_expert_1_out&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M91596.22,-158.06C91612.08,-173.09 91634.05,-190.44 91657.5,-198.5 91739.67,-226.73 92355.99,-222.49 92439.5,-198.5 92454.94,-194.07 92470.31,-186.68 92484.38,-178.39"/>
<polygon fill="black" stroke="black" points="92486.26,-181.34 92492.97,-173.14 92482.61,-175.37 92486.26,-181.34"/>
</g>
<!-- layer4_expert_2_act -->
<g id="node443" class="node">
<title>layer4_expert_2_act</title>
<path fill="lightyellow" stroke="black" d="M90496,-158C90496,-158 90395,-158 90395,-158 90389,-158 90383,-152 90383,-146 90383,-146 90383,-117 90383,-117 90383,-111 90389,-105 90395,-105 90395,-105 90496,-105 90496,-105 90502,-105 90508,-111 90508,-117 90508,-117 90508,-146 90508,-146 90508,-152 90502,-158 90496,-158"/>
<text text-anchor="middle" x="90445.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="90445.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="90445.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer4_expert_2_up&#45;&gt;layer4_expert_2_act -->
<g id="edge716" class="edge">
<title>layer4_expert_2_up&#45;&gt;layer4_expert_2_act</title>
<path fill="none" stroke="black" d="M90347.72,-131.5C90356.05,-131.5 90364.37,-131.5 90372.7,-131.5"/>
<polygon fill="black" stroke="black" points="90372.86,-135 90382.86,-131.5 90372.86,-128 90372.86,-135"/>
</g>
<!-- layer4_expert_2_down -->
<g id="node444" class="node">
<title>layer4_expert_2_down</title>
<path fill="lightcoral" stroke="black" d="M90655.5,-165.5C90655.5,-165.5 90555.5,-165.5 90555.5,-165.5 90549.5,-165.5 90543.5,-159.5 90543.5,-153.5 90543.5,-153.5 90543.5,-109.5 90543.5,-109.5 90543.5,-103.5 90549.5,-97.5 90555.5,-97.5 90555.5,-97.5 90655.5,-97.5 90655.5,-97.5 90661.5,-97.5 90667.5,-103.5 90667.5,-109.5 90667.5,-109.5 90667.5,-153.5 90667.5,-153.5 90667.5,-159.5 90661.5,-165.5 90655.5,-165.5"/>
<text text-anchor="middle" x="90605.5" y="-150.3" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="90605.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="90605.5" y="-120.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="90605.5" y="-105.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer4_expert_2_act&#45;&gt;layer4_expert_2_down -->
<g id="edge717" class="edge">
<title>layer4_expert_2_act&#45;&gt;layer4_expert_2_down</title>
<path fill="none" stroke="black" d="M90508.31,-131.5C90516.59,-131.5 90524.87,-131.5 90533.14,-131.5"/>
<polygon fill="black" stroke="black" points="90533.24,-135 90543.24,-131.5 90533.24,-128 90533.24,-135"/>
</g>
<!-- layer4_expert_2_out -->
<g id="node445" class="node">
<title>layer4_expert_2_out</title>
<path fill="lightpink" stroke="black" d="M90825.5,-158C90825.5,-158 90715.5,-158 90715.5,-158 90709.5,-158 90703.5,-152 90703.5,-146 90703.5,-146 90703.5,-117 90703.5,-117 90703.5,-111 90709.5,-105 90715.5,-105 90715.5,-105 90825.5,-105 90825.5,-105 90831.5,-105 90837.5,-111 90837.5,-117 90837.5,-117 90837.5,-146 90837.5,-146 90837.5,-152 90831.5,-158 90825.5,-158"/>
<text text-anchor="middle" x="90770.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 2 Output</text>
<text text-anchor="middle" x="90770.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="90770.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer4_expert_2_down&#45;&gt;layer4_expert_2_out -->
<g id="edge718" class="edge">
<title>layer4_expert_2_down&#45;&gt;layer4_expert_2_out</title>
<path fill="none" stroke="black" d="M90667.7,-131.5C90676.26,-131.5 90684.82,-131.5 90693.39,-131.5"/>
<polygon fill="black" stroke="black" points="90693.44,-135 90703.44,-131.5 90693.44,-128 90693.44,-135"/>
</g>
<!-- layer4_expert_2_out&#45;&gt;layer4_moe_agg -->
<g id="edge747" class="edge">
<title>layer4_expert_2_out&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M90795.22,-158.06C90811.08,-173.09 90833.05,-190.44 90856.5,-198.5 90939.67,-227.07 92354.97,-222.78 92439.5,-198.5 92454.94,-194.07 92470.31,-186.68 92484.38,-178.39"/>
<polygon fill="black" stroke="black" points="92486.26,-181.34 92492.97,-173.14 92482.61,-175.37 92486.26,-181.34"/>
</g>
<!-- layer4_expert_3_act -->
<g id="node447" class="node">
<title>layer4_expert_3_act</title>
<path fill="lightyellow" stroke="black" d="M89695,-158C89695,-158 89594,-158 89594,-158 89588,-158 89582,-152 89582,-146 89582,-146 89582,-117 89582,-117 89582,-111 89588,-105 89594,-105 89594,-105 89695,-105 89695,-105 89701,-105 89707,-111 89707,-117 89707,-117 89707,-146 89707,-146 89707,-152 89701,-158 89695,-158"/>
<text text-anchor="middle" x="89644.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="89644.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="89644.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer4_expert_3_up&#45;&gt;layer4_expert_3_act -->
<g id="edge721" class="edge">
<title>layer4_expert_3_up&#45;&gt;layer4_expert_3_act</title>
<path fill="none" stroke="black" d="M89546.72,-131.5C89555.05,-131.5 89563.37,-131.5 89571.7,-131.5"/>
<polygon fill="black" stroke="black" points="89571.86,-135 89581.86,-131.5 89571.86,-128 89571.86,-135"/>
</g>
<!-- layer4_expert_3_down -->
<g id="node448" class="node">
<title>layer4_expert_3_down</title>
<path fill="lightcoral" stroke="black" d="M89854.5,-165.5C89854.5,-165.5 89754.5,-165.5 89754.5,-165.5 89748.5,-165.5 89742.5,-159.5 89742.5,-153.5 89742.5,-153.5 89742.5,-109.5 89742.5,-109.5 89742.5,-103.5 89748.5,-97.5 89754.5,-97.5 89754.5,-97.5 89854.5,-97.5 89854.5,-97.5 89860.5,-97.5 89866.5,-103.5 89866.5,-109.5 89866.5,-109.5 89866.5,-153.5 89866.5,-153.5 89866.5,-159.5 89860.5,-165.5 89854.5,-165.5"/>
<text text-anchor="middle" x="89804.5" y="-150.3" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="89804.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="89804.5" y="-120.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="89804.5" y="-105.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer4_expert_3_act&#45;&gt;layer4_expert_3_down -->
<g id="edge722" class="edge">
<title>layer4_expert_3_act&#45;&gt;layer4_expert_3_down</title>
<path fill="none" stroke="black" d="M89707.31,-131.5C89715.59,-131.5 89723.87,-131.5 89732.14,-131.5"/>
<polygon fill="black" stroke="black" points="89732.24,-135 89742.24,-131.5 89732.24,-128 89732.24,-135"/>
</g>
<!-- layer4_expert_3_out -->
<g id="node449" class="node">
<title>layer4_expert_3_out</title>
<path fill="lightpink" stroke="black" d="M90024.5,-158C90024.5,-158 89914.5,-158 89914.5,-158 89908.5,-158 89902.5,-152 89902.5,-146 89902.5,-146 89902.5,-117 89902.5,-117 89902.5,-111 89908.5,-105 89914.5,-105 89914.5,-105 90024.5,-105 90024.5,-105 90030.5,-105 90036.5,-111 90036.5,-117 90036.5,-117 90036.5,-146 90036.5,-146 90036.5,-152 90030.5,-158 90024.5,-158"/>
<text text-anchor="middle" x="89969.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 3 Output</text>
<text text-anchor="middle" x="89969.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="89969.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer4_expert_3_down&#45;&gt;layer4_expert_3_out -->
<g id="edge723" class="edge">
<title>layer4_expert_3_down&#45;&gt;layer4_expert_3_out</title>
<path fill="none" stroke="black" d="M89866.7,-131.5C89875.26,-131.5 89883.82,-131.5 89892.39,-131.5"/>
<polygon fill="black" stroke="black" points="89892.44,-135 89902.44,-131.5 89892.44,-128 89892.44,-135"/>
</g>
<!-- layer4_expert_3_out&#45;&gt;layer4_moe_agg -->
<g id="edge748" class="edge">
<title>layer4_expert_3_out&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M89994.22,-158.06C90010.08,-173.09 90032.05,-190.44 90055.5,-198.5 90118.13,-220.02 92375.85,-216.78 92439.5,-198.5 92454.94,-194.07 92470.31,-186.68 92484.38,-178.39"/>
<polygon fill="black" stroke="black" points="92486.26,-181.34 92492.97,-173.14 92482.61,-175.37 92486.26,-181.34"/>
</g>
<!-- layer4_expert_4_act -->
<g id="node451" class="node">
<title>layer4_expert_4_act</title>
<path fill="lightyellow" stroke="black" d="M88894,-158C88894,-158 88793,-158 88793,-158 88787,-158 88781,-152 88781,-146 88781,-146 88781,-117 88781,-117 88781,-111 88787,-105 88793,-105 88793,-105 88894,-105 88894,-105 88900,-105 88906,-111 88906,-117 88906,-117 88906,-146 88906,-146 88906,-152 88900,-158 88894,-158"/>
<text text-anchor="middle" x="88843.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="88843.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="88843.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer4_expert_4_up&#45;&gt;layer4_expert_4_act -->
<g id="edge726" class="edge">
<title>layer4_expert_4_up&#45;&gt;layer4_expert_4_act</title>
<path fill="none" stroke="black" d="M88745.72,-131.5C88754.05,-131.5 88762.37,-131.5 88770.7,-131.5"/>
<polygon fill="black" stroke="black" points="88770.86,-135 88780.86,-131.5 88770.86,-128 88770.86,-135"/>
</g>
<!-- layer4_expert_4_down -->
<g id="node452" class="node">
<title>layer4_expert_4_down</title>
<path fill="lightcoral" stroke="black" d="M89053.5,-165.5C89053.5,-165.5 88953.5,-165.5 88953.5,-165.5 88947.5,-165.5 88941.5,-159.5 88941.5,-153.5 88941.5,-153.5 88941.5,-109.5 88941.5,-109.5 88941.5,-103.5 88947.5,-97.5 88953.5,-97.5 88953.5,-97.5 89053.5,-97.5 89053.5,-97.5 89059.5,-97.5 89065.5,-103.5 89065.5,-109.5 89065.5,-109.5 89065.5,-153.5 89065.5,-153.5 89065.5,-159.5 89059.5,-165.5 89053.5,-165.5"/>
<text text-anchor="middle" x="89003.5" y="-150.3" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="89003.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="89003.5" y="-120.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="89003.5" y="-105.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer4_expert_4_act&#45;&gt;layer4_expert_4_down -->
<g id="edge727" class="edge">
<title>layer4_expert_4_act&#45;&gt;layer4_expert_4_down</title>
<path fill="none" stroke="black" d="M88906.31,-131.5C88914.59,-131.5 88922.87,-131.5 88931.14,-131.5"/>
<polygon fill="black" stroke="black" points="88931.24,-135 88941.24,-131.5 88931.24,-128 88931.24,-135"/>
</g>
<!-- layer4_expert_4_out -->
<g id="node453" class="node">
<title>layer4_expert_4_out</title>
<path fill="lightpink" stroke="black" d="M89223.5,-158C89223.5,-158 89113.5,-158 89113.5,-158 89107.5,-158 89101.5,-152 89101.5,-146 89101.5,-146 89101.5,-117 89101.5,-117 89101.5,-111 89107.5,-105 89113.5,-105 89113.5,-105 89223.5,-105 89223.5,-105 89229.5,-105 89235.5,-111 89235.5,-117 89235.5,-117 89235.5,-146 89235.5,-146 89235.5,-152 89229.5,-158 89223.5,-158"/>
<text text-anchor="middle" x="89168.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 4 Output</text>
<text text-anchor="middle" x="89168.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="89168.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer4_expert_4_down&#45;&gt;layer4_expert_4_out -->
<g id="edge728" class="edge">
<title>layer4_expert_4_down&#45;&gt;layer4_expert_4_out</title>
<path fill="none" stroke="black" d="M89065.7,-131.5C89074.26,-131.5 89082.82,-131.5 89091.39,-131.5"/>
<polygon fill="black" stroke="black" points="89091.44,-135 89101.44,-131.5 89091.44,-128 89091.44,-135"/>
</g>
<!-- layer4_expert_4_out&#45;&gt;layer4_moe_agg -->
<g id="edge749" class="edge">
<title>layer4_expert_4_out&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M89193.22,-158.06C89209.08,-173.09 89231.05,-190.44 89254.5,-198.5 89338.17,-227.25 92354.47,-222.93 92439.5,-198.5 92454.94,-194.07 92470.31,-186.68 92484.38,-178.39"/>
<polygon fill="black" stroke="black" points="92486.26,-181.34 92492.97,-173.14 92482.61,-175.37 92486.26,-181.34"/>
</g>
<!-- layer4_expert_5_act -->
<g id="node455" class="node">
<title>layer4_expert_5_act</title>
<path fill="lightyellow" stroke="black" d="M88093,-158C88093,-158 87992,-158 87992,-158 87986,-158 87980,-152 87980,-146 87980,-146 87980,-117 87980,-117 87980,-111 87986,-105 87992,-105 87992,-105 88093,-105 88093,-105 88099,-105 88105,-111 88105,-117 88105,-117 88105,-146 88105,-146 88105,-152 88099,-158 88093,-158"/>
<text text-anchor="middle" x="88042.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="88042.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="88042.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer4_expert_5_up&#45;&gt;layer4_expert_5_act -->
<g id="edge731" class="edge">
<title>layer4_expert_5_up&#45;&gt;layer4_expert_5_act</title>
<path fill="none" stroke="black" d="M87944.72,-131.5C87953.05,-131.5 87961.37,-131.5 87969.7,-131.5"/>
<polygon fill="black" stroke="black" points="87969.86,-135 87979.86,-131.5 87969.86,-128 87969.86,-135"/>
</g>
<!-- layer4_expert_5_down -->
<g id="node456" class="node">
<title>layer4_expert_5_down</title>
<path fill="lightcoral" stroke="black" d="M88252.5,-165.5C88252.5,-165.5 88152.5,-165.5 88152.5,-165.5 88146.5,-165.5 88140.5,-159.5 88140.5,-153.5 88140.5,-153.5 88140.5,-109.5 88140.5,-109.5 88140.5,-103.5 88146.5,-97.5 88152.5,-97.5 88152.5,-97.5 88252.5,-97.5 88252.5,-97.5 88258.5,-97.5 88264.5,-103.5 88264.5,-109.5 88264.5,-109.5 88264.5,-153.5 88264.5,-153.5 88264.5,-159.5 88258.5,-165.5 88252.5,-165.5"/>
<text text-anchor="middle" x="88202.5" y="-150.3" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="88202.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="88202.5" y="-120.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="88202.5" y="-105.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer4_expert_5_act&#45;&gt;layer4_expert_5_down -->
<g id="edge732" class="edge">
<title>layer4_expert_5_act&#45;&gt;layer4_expert_5_down</title>
<path fill="none" stroke="black" d="M88105.31,-131.5C88113.59,-131.5 88121.87,-131.5 88130.14,-131.5"/>
<polygon fill="black" stroke="black" points="88130.24,-135 88140.24,-131.5 88130.24,-128 88130.24,-135"/>
</g>
<!-- layer4_expert_5_out -->
<g id="node457" class="node">
<title>layer4_expert_5_out</title>
<path fill="lightpink" stroke="black" d="M88422.5,-158C88422.5,-158 88312.5,-158 88312.5,-158 88306.5,-158 88300.5,-152 88300.5,-146 88300.5,-146 88300.5,-117 88300.5,-117 88300.5,-111 88306.5,-105 88312.5,-105 88312.5,-105 88422.5,-105 88422.5,-105 88428.5,-105 88434.5,-111 88434.5,-117 88434.5,-117 88434.5,-146 88434.5,-146 88434.5,-152 88428.5,-158 88422.5,-158"/>
<text text-anchor="middle" x="88367.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 5 Output</text>
<text text-anchor="middle" x="88367.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="88367.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer4_expert_5_down&#45;&gt;layer4_expert_5_out -->
<g id="edge733" class="edge">
<title>layer4_expert_5_down&#45;&gt;layer4_expert_5_out</title>
<path fill="none" stroke="black" d="M88264.7,-131.5C88273.26,-131.5 88281.82,-131.5 88290.39,-131.5"/>
<polygon fill="black" stroke="black" points="88290.44,-135 88300.44,-131.5 88290.44,-128 88290.44,-135"/>
</g>
<!-- layer4_expert_5_out&#45;&gt;layer4_moe_agg -->
<g id="edge750" class="edge">
<title>layer4_expert_5_out&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M88392.22,-158.06C88408.08,-173.09 88430.05,-190.44 88453.5,-198.5 88558.21,-234.48 92333.08,-229.07 92439.5,-198.5 92454.94,-194.07 92470.31,-186.68 92484.38,-178.39"/>
<polygon fill="black" stroke="black" points="92486.26,-181.34 92492.97,-173.14 92482.61,-175.37 92486.26,-181.34"/>
</g>
<!-- layer4_expert_6_act -->
<g id="node459" class="node">
<title>layer4_expert_6_act</title>
<path fill="lightyellow" stroke="black" d="M87292,-158C87292,-158 87191,-158 87191,-158 87185,-158 87179,-152 87179,-146 87179,-146 87179,-117 87179,-117 87179,-111 87185,-105 87191,-105 87191,-105 87292,-105 87292,-105 87298,-105 87304,-111 87304,-117 87304,-117 87304,-146 87304,-146 87304,-152 87298,-158 87292,-158"/>
<text text-anchor="middle" x="87241.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="87241.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="87241.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer4_expert_6_up&#45;&gt;layer4_expert_6_act -->
<g id="edge736" class="edge">
<title>layer4_expert_6_up&#45;&gt;layer4_expert_6_act</title>
<path fill="none" stroke="black" d="M87143.72,-131.5C87152.05,-131.5 87160.37,-131.5 87168.7,-131.5"/>
<polygon fill="black" stroke="black" points="87168.86,-135 87178.86,-131.5 87168.86,-128 87168.86,-135"/>
</g>
<!-- layer4_expert_6_down -->
<g id="node460" class="node">
<title>layer4_expert_6_down</title>
<path fill="lightcoral" stroke="black" d="M87451.5,-165.5C87451.5,-165.5 87351.5,-165.5 87351.5,-165.5 87345.5,-165.5 87339.5,-159.5 87339.5,-153.5 87339.5,-153.5 87339.5,-109.5 87339.5,-109.5 87339.5,-103.5 87345.5,-97.5 87351.5,-97.5 87351.5,-97.5 87451.5,-97.5 87451.5,-97.5 87457.5,-97.5 87463.5,-103.5 87463.5,-109.5 87463.5,-109.5 87463.5,-153.5 87463.5,-153.5 87463.5,-159.5 87457.5,-165.5 87451.5,-165.5"/>
<text text-anchor="middle" x="87401.5" y="-150.3" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="87401.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="87401.5" y="-120.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="87401.5" y="-105.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer4_expert_6_act&#45;&gt;layer4_expert_6_down -->
<g id="edge737" class="edge">
<title>layer4_expert_6_act&#45;&gt;layer4_expert_6_down</title>
<path fill="none" stroke="black" d="M87304.31,-131.5C87312.59,-131.5 87320.87,-131.5 87329.14,-131.5"/>
<polygon fill="black" stroke="black" points="87329.24,-135 87339.24,-131.5 87329.24,-128 87329.24,-135"/>
</g>
<!-- layer4_expert_6_out -->
<g id="node461" class="node">
<title>layer4_expert_6_out</title>
<path fill="lightpink" stroke="black" d="M87621.5,-158C87621.5,-158 87511.5,-158 87511.5,-158 87505.5,-158 87499.5,-152 87499.5,-146 87499.5,-146 87499.5,-117 87499.5,-117 87499.5,-111 87505.5,-105 87511.5,-105 87511.5,-105 87621.5,-105 87621.5,-105 87627.5,-105 87633.5,-111 87633.5,-117 87633.5,-117 87633.5,-146 87633.5,-146 87633.5,-152 87627.5,-158 87621.5,-158"/>
<text text-anchor="middle" x="87566.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 6 Output</text>
<text text-anchor="middle" x="87566.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="87566.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer4_expert_6_down&#45;&gt;layer4_expert_6_out -->
<g id="edge738" class="edge">
<title>layer4_expert_6_down&#45;&gt;layer4_expert_6_out</title>
<path fill="none" stroke="black" d="M87463.7,-131.5C87472.26,-131.5 87480.82,-131.5 87489.39,-131.5"/>
<polygon fill="black" stroke="black" points="87489.44,-135 87499.44,-131.5 87489.44,-128 87489.44,-135"/>
</g>
<!-- layer4_expert_6_out&#45;&gt;layer4_moe_agg -->
<g id="edge751" class="edge">
<title>layer4_expert_6_out&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M87591.22,-158.06C87607.08,-173.09 87629.05,-190.44 87652.5,-198.5 87715.38,-220.1 92375.6,-216.86 92439.5,-198.5 92454.94,-194.07 92470.31,-186.68 92484.38,-178.39"/>
<polygon fill="black" stroke="black" points="92486.26,-181.34 92492.97,-173.14 92482.61,-175.37 92486.26,-181.34"/>
</g>
<!-- layer4_expert_7_act -->
<g id="node463" class="node">
<title>layer4_expert_7_act</title>
<path fill="lightyellow" stroke="black" d="M86491,-158C86491,-158 86390,-158 86390,-158 86384,-158 86378,-152 86378,-146 86378,-146 86378,-117 86378,-117 86378,-111 86384,-105 86390,-105 86390,-105 86491,-105 86491,-105 86497,-105 86503,-111 86503,-117 86503,-117 86503,-146 86503,-146 86503,-152 86497,-158 86491,-158"/>
<text text-anchor="middle" x="86440.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="86440.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 32768]</text>
<text text-anchor="middle" x="86440.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer4_expert_7_up&#45;&gt;layer4_expert_7_act -->
<g id="edge741" class="edge">
<title>layer4_expert_7_up&#45;&gt;layer4_expert_7_act</title>
<path fill="none" stroke="black" d="M86342.72,-131.5C86351.05,-131.5 86359.37,-131.5 86367.7,-131.5"/>
<polygon fill="black" stroke="black" points="86367.86,-135 86377.86,-131.5 86367.86,-128 86367.86,-135"/>
</g>
<!-- layer4_expert_7_down -->
<g id="node464" class="node">
<title>layer4_expert_7_down</title>
<path fill="lightcoral" stroke="black" d="M86650.5,-165.5C86650.5,-165.5 86550.5,-165.5 86550.5,-165.5 86544.5,-165.5 86538.5,-159.5 86538.5,-153.5 86538.5,-153.5 86538.5,-109.5 86538.5,-109.5 86538.5,-103.5 86544.5,-97.5 86550.5,-97.5 86550.5,-97.5 86650.5,-97.5 86650.5,-97.5 86656.5,-97.5 86662.5,-103.5 86662.5,-109.5 86662.5,-109.5 86662.5,-153.5 86662.5,-153.5 86662.5,-159.5 86656.5,-165.5 86650.5,-165.5"/>
<text text-anchor="middle" x="86600.5" y="-150.3" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="86600.5" y="-135.3" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="86600.5" y="-120.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="86600.5" y="-105.3" font-family="Times,serif" font-size="14.00">(Row Parallel)</text>
</g>
<!-- layer4_expert_7_act&#45;&gt;layer4_expert_7_down -->
<g id="edge742" class="edge">
<title>layer4_expert_7_act&#45;&gt;layer4_expert_7_down</title>
<path fill="none" stroke="black" d="M86503.31,-131.5C86511.59,-131.5 86519.87,-131.5 86528.14,-131.5"/>
<polygon fill="black" stroke="black" points="86528.24,-135 86538.24,-131.5 86528.24,-128 86528.24,-135"/>
</g>
<!-- layer4_expert_7_out -->
<g id="node465" class="node">
<title>layer4_expert_7_out</title>
<path fill="lightpink" stroke="black" d="M86820.5,-158C86820.5,-158 86710.5,-158 86710.5,-158 86704.5,-158 86698.5,-152 86698.5,-146 86698.5,-146 86698.5,-117 86698.5,-117 86698.5,-111 86704.5,-105 86710.5,-105 86710.5,-105 86820.5,-105 86820.5,-105 86826.5,-105 86832.5,-111 86832.5,-117 86832.5,-117 86832.5,-146 86832.5,-146 86832.5,-152 86826.5,-158 86820.5,-158"/>
<text text-anchor="middle" x="86765.5" y="-142.8" font-family="Times,serif" font-size="14.00">Expert 7 Output</text>
<text text-anchor="middle" x="86765.5" y="-127.8" font-family="Times,serif" font-size="14.00">[B, L, 8192]</text>
<text text-anchor="middle" x="86765.5" y="-112.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer4_expert_7_down&#45;&gt;layer4_expert_7_out -->
<g id="edge743" class="edge">
<title>layer4_expert_7_down&#45;&gt;layer4_expert_7_out</title>
<path fill="none" stroke="black" d="M86662.7,-131.5C86671.26,-131.5 86679.82,-131.5 86688.39,-131.5"/>
<polygon fill="black" stroke="black" points="86688.44,-135 86698.44,-131.5 86688.44,-128 86688.44,-135"/>
</g>
<!-- layer4_expert_7_out&#45;&gt;layer4_moe_agg -->
<g id="edge752" class="edge">
<title>layer4_expert_7_out&#45;&gt;layer4_moe_agg</title>
<path fill="none" stroke="black" d="M86790.22,-158.06C86806.08,-173.09 86828.05,-190.44 86851.5,-198.5 86924.9,-223.72 92364.91,-219.93 92439.5,-198.5 92454.94,-194.07 92470.31,-186.68 92484.38,-178.39"/>
<polygon fill="black" stroke="black" points="92486.26,-181.34 92492.97,-173.14 92482.61,-175.37 92486.26,-181.34"/>
</g>
</g>
</svg>
