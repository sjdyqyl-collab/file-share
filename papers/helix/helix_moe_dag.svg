<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="30pt"
 viewBox="0.00 0.00 1440.00 30.33" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.01 0.01) rotate(0) translate(4 2661)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2661 126530.5,-2661 126530.5,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_gpu_0</title>
<path fill="lightgrey" stroke="lightgrey" d="M47048,-2485.5C47048,-2485.5 54854,-2485.5 54854,-2485.5 54860,-2485.5 54866,-2491.5 54866,-2497.5 54866,-2497.5 54866,-2618.5 54866,-2618.5 54866,-2624.5 54860,-2630.5 54854,-2630.5 54854,-2630.5 47048,-2630.5 47048,-2630.5 47042,-2630.5 47036,-2624.5 47036,-2618.5 47036,-2618.5 47036,-2497.5 47036,-2497.5 47036,-2491.5 47042,-2485.5 47048,-2485.5"/>
<text text-anchor="middle" x="50951" y="-2615.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu_1</title>
<path fill="lightgrey" stroke="lightgrey" d="M54886,-2485.5C54886,-2485.5 62692,-2485.5 62692,-2485.5 62698,-2485.5 62704,-2491.5 62704,-2497.5 62704,-2497.5 62704,-2618.5 62704,-2618.5 62704,-2624.5 62698,-2630.5 62692,-2630.5 62692,-2630.5 54886,-2630.5 54886,-2630.5 54880,-2630.5 54874,-2624.5 54874,-2618.5 54874,-2618.5 54874,-2497.5 54874,-2497.5 54874,-2491.5 54880,-2485.5 54886,-2485.5"/>
<text text-anchor="middle" x="58789" y="-2615.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu_2</title>
<path fill="lightgrey" stroke="lightgrey" d="M31372,-2485.5C31372,-2485.5 39178,-2485.5 39178,-2485.5 39184,-2485.5 39190,-2491.5 39190,-2497.5 39190,-2497.5 39190,-2618.5 39190,-2618.5 39190,-2624.5 39184,-2630.5 39178,-2630.5 39178,-2630.5 31372,-2630.5 31372,-2630.5 31366,-2630.5 31360,-2624.5 31360,-2618.5 31360,-2618.5 31360,-2497.5 31360,-2497.5 31360,-2491.5 31366,-2485.5 31372,-2485.5"/>
<text text-anchor="middle" x="35275" y="-2615.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_gpu_3</title>
<path fill="lightgrey" stroke="lightgrey" d="M39210,-2485.5C39210,-2485.5 47016,-2485.5 47016,-2485.5 47022,-2485.5 47028,-2491.5 47028,-2497.5 47028,-2497.5 47028,-2618.5 47028,-2618.5 47028,-2624.5 47022,-2630.5 47016,-2630.5 47016,-2630.5 39210,-2630.5 39210,-2630.5 39204,-2630.5 39198,-2624.5 39198,-2618.5 39198,-2618.5 39198,-2497.5 39198,-2497.5 39198,-2491.5 39204,-2485.5 39210,-2485.5"/>
<text text-anchor="middle" x="43113" y="-2615.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_gpu_4</title>
<path fill="lightgrey" stroke="lightgrey" d="M15696,-2485.5C15696,-2485.5 23502,-2485.5 23502,-2485.5 23508,-2485.5 23514,-2491.5 23514,-2497.5 23514,-2497.5 23514,-2618.5 23514,-2618.5 23514,-2624.5 23508,-2630.5 23502,-2630.5 23502,-2630.5 15696,-2630.5 15696,-2630.5 15690,-2630.5 15684,-2624.5 15684,-2618.5 15684,-2618.5 15684,-2497.5 15684,-2497.5 15684,-2491.5 15690,-2485.5 15696,-2485.5"/>
<text text-anchor="middle" x="19599" y="-2615.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_gpu_5</title>
<path fill="lightgrey" stroke="lightgrey" d="M23534,-2485.5C23534,-2485.5 31340,-2485.5 31340,-2485.5 31346,-2485.5 31352,-2491.5 31352,-2497.5 31352,-2497.5 31352,-2618.5 31352,-2618.5 31352,-2624.5 31346,-2630.5 31340,-2630.5 31340,-2630.5 23534,-2630.5 23534,-2630.5 23528,-2630.5 23522,-2624.5 23522,-2618.5 23522,-2618.5 23522,-2497.5 23522,-2497.5 23522,-2491.5 23528,-2485.5 23534,-2485.5"/>
<text text-anchor="middle" x="27437" y="-2615.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_gpu_6</title>
<path fill="lightgrey" stroke="lightgrey" d="M20,-2485.5C20,-2485.5 7826,-2485.5 7826,-2485.5 7832,-2485.5 7838,-2491.5 7838,-2497.5 7838,-2497.5 7838,-2618.5 7838,-2618.5 7838,-2624.5 7832,-2630.5 7826,-2630.5 7826,-2630.5 20,-2630.5 20,-2630.5 14,-2630.5 8,-2624.5 8,-2618.5 8,-2618.5 8,-2497.5 8,-2497.5 8,-2491.5 14,-2485.5 20,-2485.5"/>
<text text-anchor="middle" x="3923" y="-2615.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_gpu_7</title>
<path fill="lightgrey" stroke="lightgrey" d="M7858,-2485.5C7858,-2485.5 15664,-2485.5 15664,-2485.5 15670,-2485.5 15676,-2491.5 15676,-2497.5 15676,-2497.5 15676,-2618.5 15676,-2618.5 15676,-2624.5 15670,-2630.5 15664,-2630.5 15664,-2630.5 7858,-2630.5 7858,-2630.5 7852,-2630.5 7846,-2624.5 7846,-2618.5 7846,-2618.5 7846,-2497.5 7846,-2497.5 7846,-2491.5 7852,-2485.5 7858,-2485.5"/>
<text text-anchor="middle" x="11761" y="-2615.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_gpu_8</title>
<path fill="lightgrey" stroke="lightgrey" d="M109986,-2485.5C109986,-2485.5 117792,-2485.5 117792,-2485.5 117798,-2485.5 117804,-2491.5 117804,-2497.5 117804,-2497.5 117804,-2618.5 117804,-2618.5 117804,-2624.5 117798,-2630.5 117792,-2630.5 117792,-2630.5 109986,-2630.5 109986,-2630.5 109980,-2630.5 109974,-2624.5 109974,-2618.5 109974,-2618.5 109974,-2497.5 109974,-2497.5 109974,-2491.5 109980,-2485.5 109986,-2485.5"/>
<text text-anchor="middle" x="113889" y="-2615.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_gpu_9</title>
<path fill="lightgrey" stroke="lightgrey" d="M117824,-2485.5C117824,-2485.5 125630,-2485.5 125630,-2485.5 125636,-2485.5 125642,-2491.5 125642,-2497.5 125642,-2497.5 125642,-2618.5 125642,-2618.5 125642,-2624.5 125636,-2630.5 125630,-2630.5 125630,-2630.5 117824,-2630.5 117824,-2630.5 117818,-2630.5 117812,-2624.5 117812,-2618.5 117812,-2618.5 117812,-2497.5 117812,-2497.5 117812,-2491.5 117818,-2485.5 117824,-2485.5"/>
<text text-anchor="middle" x="121727" y="-2615.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_gpu_10</title>
<path fill="lightgrey" stroke="lightgrey" d="M94310,-2485.5C94310,-2485.5 102116,-2485.5 102116,-2485.5 102122,-2485.5 102128,-2491.5 102128,-2497.5 102128,-2497.5 102128,-2618.5 102128,-2618.5 102128,-2624.5 102122,-2630.5 102116,-2630.5 102116,-2630.5 94310,-2630.5 94310,-2630.5 94304,-2630.5 94298,-2624.5 94298,-2618.5 94298,-2618.5 94298,-2497.5 94298,-2497.5 94298,-2491.5 94304,-2485.5 94310,-2485.5"/>
<text text-anchor="middle" x="98213" y="-2615.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_gpu_11</title>
<path fill="lightgrey" stroke="lightgrey" d="M102148,-2485.5C102148,-2485.5 109954,-2485.5 109954,-2485.5 109960,-2485.5 109966,-2491.5 109966,-2497.5 109966,-2497.5 109966,-2618.5 109966,-2618.5 109966,-2624.5 109960,-2630.5 109954,-2630.5 109954,-2630.5 102148,-2630.5 102148,-2630.5 102142,-2630.5 102136,-2624.5 102136,-2618.5 102136,-2618.5 102136,-2497.5 102136,-2497.5 102136,-2491.5 102142,-2485.5 102148,-2485.5"/>
<text text-anchor="middle" x="106051" y="-2615.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_gpu_12</title>
<path fill="lightgrey" stroke="lightgrey" d="M78634,-2485.5C78634,-2485.5 86440,-2485.5 86440,-2485.5 86446,-2485.5 86452,-2491.5 86452,-2497.5 86452,-2497.5 86452,-2618.5 86452,-2618.5 86452,-2624.5 86446,-2630.5 86440,-2630.5 86440,-2630.5 78634,-2630.5 78634,-2630.5 78628,-2630.5 78622,-2624.5 78622,-2618.5 78622,-2618.5 78622,-2497.5 78622,-2497.5 78622,-2491.5 78628,-2485.5 78634,-2485.5"/>
<text text-anchor="middle" x="82537" y="-2615.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_gpu_13</title>
<path fill="lightgrey" stroke="lightgrey" d="M86472,-2485.5C86472,-2485.5 94278,-2485.5 94278,-2485.5 94284,-2485.5 94290,-2491.5 94290,-2497.5 94290,-2497.5 94290,-2618.5 94290,-2618.5 94290,-2624.5 94284,-2630.5 94278,-2630.5 94278,-2630.5 86472,-2630.5 86472,-2630.5 86466,-2630.5 86460,-2624.5 86460,-2618.5 86460,-2618.5 86460,-2497.5 86460,-2497.5 86460,-2491.5 86466,-2485.5 86472,-2485.5"/>
<text text-anchor="middle" x="90375" y="-2615.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_gpu_14</title>
<path fill="lightgrey" stroke="lightgrey" d="M62958,-2485.5C62958,-2485.5 70764,-2485.5 70764,-2485.5 70770,-2485.5 70776,-2491.5 70776,-2497.5 70776,-2497.5 70776,-2618.5 70776,-2618.5 70776,-2624.5 70770,-2630.5 70764,-2630.5 70764,-2630.5 62958,-2630.5 62958,-2630.5 62952,-2630.5 62946,-2624.5 62946,-2618.5 62946,-2618.5 62946,-2497.5 62946,-2497.5 62946,-2491.5 62952,-2485.5 62958,-2485.5"/>
<text text-anchor="middle" x="66861" y="-2615.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_gpu_15</title>
<path fill="lightgrey" stroke="lightgrey" d="M70796,-2485.5C70796,-2485.5 78602,-2485.5 78602,-2485.5 78608,-2485.5 78614,-2491.5 78614,-2497.5 78614,-2497.5 78614,-2618.5 78614,-2618.5 78614,-2624.5 78608,-2630.5 78602,-2630.5 78602,-2630.5 70796,-2630.5 70796,-2630.5 70790,-2630.5 70784,-2624.5 70784,-2618.5 70784,-2618.5 70784,-2497.5 70784,-2497.5 70784,-2491.5 70790,-2485.5 70796,-2485.5"/>
<text text-anchor="middle" x="74699" y="-2615.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- L1_Q_proj_0 -->
<g id="node1" class="node">
<title>L1_Q_proj_0</title>
<polygon fill="none" stroke="black" points="54858,-2580.5 54722,-2580.5 54722,-2512.5 54858,-2512.5 54858,-2580.5"/>
<text text-anchor="middle" x="54790" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="54790" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="54790" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="54790" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_K_proj_0 -->
<g id="node2" class="node">
<title>L1_K_proj_0</title>
<polygon fill="none" stroke="black" points="54704,-2580.5 54568,-2580.5 54568,-2512.5 54704,-2512.5 54704,-2580.5"/>
<text text-anchor="middle" x="54636" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="54636" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="54636" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="54636" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_V_proj_0 -->
<g id="node3" class="node">
<title>L1_V_proj_0</title>
<polygon fill="none" stroke="black" points="54550,-2580.5 54414,-2580.5 54414,-2512.5 54550,-2512.5 54550,-2580.5"/>
<text text-anchor="middle" x="54482" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="54482" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="54482" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="54482" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_attention_0 -->
<g id="node4" class="node">
<title>L1_attention_0</title>
<ellipse fill="none" stroke="black" cx="54300" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="54300" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="54300" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="54300" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="54300" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_0 -->
<g id="node5" class="node">
<title>L1_out_proj_0</title>
<polygon fill="none" stroke="black" points="54186,-2580.5 54042,-2580.5 54042,-2512.5 54186,-2512.5 54186,-2580.5"/>
<text text-anchor="middle" x="54114" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="54114" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="54114" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="54114" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_concat_dim_head0 -->
<g id="node705" class="node">
<title>L1_concat_dim_head0</title>
<polygon fill="none" stroke="black" points="54114,-2400 53968,-2347 54114,-2294 54260,-2347 54114,-2400"/>
<text text-anchor="middle" x="54114" y="-2358.3" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="54114" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="54114" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_out_proj_0&#45;&gt;L1_concat_dim_head0 -->
<g id="edge1" class="edge">
<title>L1_out_proj_0&#45;&gt;L1_concat_dim_head0</title>
<path fill="none" stroke="black" d="M54114,-2512.44C54114,-2484.68 54114,-2444.23 54114,-2410.4"/>
<polygon fill="black" stroke="black" points="54117.5,-2410.14 54114,-2400.14 54110.5,-2410.14 54117.5,-2410.14"/>
</g>
<!-- L2_Q_proj_0 -->
<g id="node6" class="node">
<title>L2_Q_proj_0</title>
<polygon fill="none" stroke="black" points="54024,-2580.5 53888,-2580.5 53888,-2512.5 54024,-2512.5 54024,-2580.5"/>
<text text-anchor="middle" x="53956" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="53956" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="53956" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="53956" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_K_proj_0 -->
<g id="node7" class="node">
<title>L2_K_proj_0</title>
<polygon fill="none" stroke="black" points="53870,-2580.5 53734,-2580.5 53734,-2512.5 53870,-2512.5 53870,-2580.5"/>
<text text-anchor="middle" x="53802" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="53802" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="53802" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="53802" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_V_proj_0 -->
<g id="node8" class="node">
<title>L2_V_proj_0</title>
<polygon fill="none" stroke="black" points="53716,-2580.5 53580,-2580.5 53580,-2512.5 53716,-2512.5 53716,-2580.5"/>
<text text-anchor="middle" x="53648" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="53648" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="53648" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="53648" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_attention_0 -->
<g id="node9" class="node">
<title>L2_attention_0</title>
<ellipse fill="none" stroke="black" cx="53466" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="53466" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="53466" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="53466" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="53466" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_0 -->
<g id="node10" class="node">
<title>L2_out_proj_0</title>
<polygon fill="none" stroke="black" points="51700,-2580.5 51556,-2580.5 51556,-2512.5 51700,-2512.5 51700,-2580.5"/>
<text text-anchor="middle" x="51628" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="51628" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="51628" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="51628" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_concat_dim_head0 -->
<g id="node706" class="node">
<title>L2_concat_dim_head0</title>
<polygon fill="none" stroke="black" points="51628,-2400 51482,-2347 51628,-2294 51774,-2347 51628,-2400"/>
<text text-anchor="middle" x="51628" y="-2358.3" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="51628" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="51628" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_out_proj_0&#45;&gt;L2_concat_dim_head0 -->
<g id="edge2" class="edge">
<title>L2_out_proj_0&#45;&gt;L2_concat_dim_head0</title>
<path fill="none" stroke="black" d="M51628,-2512.44C51628,-2484.68 51628,-2444.23 51628,-2410.4"/>
<polygon fill="black" stroke="black" points="51631.5,-2410.14 51628,-2400.14 51624.5,-2410.14 51631.5,-2410.14"/>
</g>
<!-- L3_Q_proj_0 -->
<g id="node11" class="node">
<title>L3_Q_proj_0</title>
<polygon fill="none" stroke="black" points="53198,-2580.5 53062,-2580.5 53062,-2512.5 53198,-2512.5 53198,-2580.5"/>
<text text-anchor="middle" x="53130" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="53130" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="53130" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="53130" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_K_proj_0 -->
<g id="node12" class="node">
<title>L3_K_proj_0</title>
<polygon fill="none" stroke="black" points="53044,-2580.5 52908,-2580.5 52908,-2512.5 53044,-2512.5 53044,-2580.5"/>
<text text-anchor="middle" x="52976" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="52976" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="52976" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="52976" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_V_proj_0 -->
<g id="node13" class="node">
<title>L3_V_proj_0</title>
<polygon fill="none" stroke="black" points="52890,-2580.5 52754,-2580.5 52754,-2512.5 52890,-2512.5 52890,-2580.5"/>
<text text-anchor="middle" x="52822" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="52822" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="52822" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="52822" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_attention_0 -->
<g id="node14" class="node">
<title>L3_attention_0</title>
<ellipse fill="none" stroke="black" cx="52640" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="52640" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="52640" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="52640" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="52640" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_0 -->
<g id="node15" class="node">
<title>L3_out_proj_0</title>
<polygon fill="none" stroke="black" points="50260,-2580.5 50116,-2580.5 50116,-2512.5 50260,-2512.5 50260,-2580.5"/>
<text text-anchor="middle" x="50188" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="50188" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="50188" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="50188" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_concat_dim_head0 -->
<g id="node707" class="node">
<title>L3_concat_dim_head0</title>
<polygon fill="none" stroke="black" points="50188,-2400 50042,-2347 50188,-2294 50334,-2347 50188,-2400"/>
<text text-anchor="middle" x="50188" y="-2358.3" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="50188" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="50188" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_out_proj_0&#45;&gt;L3_concat_dim_head0 -->
<g id="edge3" class="edge">
<title>L3_out_proj_0&#45;&gt;L3_concat_dim_head0</title>
<path fill="none" stroke="black" d="M50188,-2512.44C50188,-2484.68 50188,-2444.23 50188,-2410.4"/>
<polygon fill="black" stroke="black" points="50191.5,-2410.14 50188,-2400.14 50184.5,-2410.14 50191.5,-2410.14"/>
</g>
<!-- L4_Q_proj_0 -->
<g id="node16" class="node">
<title>L4_Q_proj_0</title>
<polygon fill="none" stroke="black" points="52372,-2580.5 52236,-2580.5 52236,-2512.5 52372,-2512.5 52372,-2580.5"/>
<text text-anchor="middle" x="52304" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="52304" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="52304" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="52304" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_K_proj_0 -->
<g id="node17" class="node">
<title>L4_K_proj_0</title>
<polygon fill="none" stroke="black" points="52218,-2580.5 52082,-2580.5 52082,-2512.5 52218,-2512.5 52218,-2580.5"/>
<text text-anchor="middle" x="52150" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="52150" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="52150" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="52150" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_V_proj_0 -->
<g id="node18" class="node">
<title>L4_V_proj_0</title>
<polygon fill="none" stroke="black" points="52064,-2580.5 51928,-2580.5 51928,-2512.5 52064,-2512.5 52064,-2580.5"/>
<text text-anchor="middle" x="51996" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="51996" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="51996" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="51996" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_attention_0 -->
<g id="node19" class="node">
<title>L4_attention_0</title>
<ellipse fill="none" stroke="black" cx="51814" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="51814" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="51814" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="51814" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="51814" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_0 -->
<g id="node20" class="node">
<title>L4_out_proj_0</title>
<polygon fill="none" stroke="black" points="48566,-2580.5 48422,-2580.5 48422,-2512.5 48566,-2512.5 48566,-2580.5"/>
<text text-anchor="middle" x="48494" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="48494" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="48494" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="48494" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_concat_dim_head0 -->
<g id="node708" class="node">
<title>L4_concat_dim_head0</title>
<polygon fill="none" stroke="black" points="48494,-2400 48348,-2347 48494,-2294 48640,-2347 48494,-2400"/>
<text text-anchor="middle" x="48494" y="-2358.3" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="48494" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="48494" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_out_proj_0&#45;&gt;L4_concat_dim_head0 -->
<g id="edge4" class="edge">
<title>L4_out_proj_0&#45;&gt;L4_concat_dim_head0</title>
<path fill="none" stroke="black" d="M48494,-2512.44C48494,-2484.68 48494,-2444.23 48494,-2410.4"/>
<polygon fill="black" stroke="black" points="48497.5,-2410.14 48494,-2400.14 48490.5,-2410.14 48497.5,-2410.14"/>
</g>
<!-- L1_expert0_ffn1_0 -->
<g id="node21" class="node">
<title>L1_expert0_ffn1_0</title>
<polygon fill="none" stroke="black" points="51538,-2580.5 51402,-2580.5 51402,-2512.5 51538,-2512.5 51538,-2580.5"/>
<text text-anchor="middle" x="51470" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN1</text>
<text text-anchor="middle" x="51470" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="51470" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="51470" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert0_ffn2_0 -->
<g id="node22" class="node">
<title>L1_expert0_ffn2_0</title>
<polygon fill="none" stroke="black" points="53352,-2580.5 53216,-2580.5 53216,-2512.5 53352,-2512.5 53352,-2580.5"/>
<text text-anchor="middle" x="53284" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN2</text>
<text text-anchor="middle" x="53284" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="53284" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="53284" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert_concat_head0 -->
<g id="node709" class="node">
<title>L1_expert_concat_head0</title>
<polygon fill="none" stroke="black" points="52458,-2400 52322,-2347 52458,-2294 52594,-2347 52458,-2400"/>
<text text-anchor="middle" x="52458" y="-2358.3" font-family="Times,serif" font-size="14.00">Expert Concat</text>
<text text-anchor="middle" x="52458" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="52458" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert0_ffn2_0&#45;&gt;L1_expert_concat_head0 -->
<g id="edge5" class="edge">
<title>L1_expert0_ffn2_0&#45;&gt;L1_expert_concat_head0</title>
<path fill="none" stroke="black" d="M53269.97,-2512.36C53257.38,-2487 53236.35,-2453.49 53207,-2436 53106.71,-2376.23 52782.64,-2357.03 52595.26,-2350.88"/>
<polygon fill="black" stroke="black" points="52595.17,-2347.38 52585.06,-2350.55 52594.95,-2354.37 52595.17,-2347.38"/>
</g>
<!-- L1_expert0_gate_0 -->
<g id="node23" class="node">
<title>L1_expert0_gate_0</title>
<polygon fill="none" stroke="black" points="51112,-2599.5 50994,-2546.5 51112,-2493.5 51230,-2546.5 51112,-2599.5"/>
<text text-anchor="middle" x="51112" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="51112" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="51112" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_expert1_ffn1_0 -->
<g id="node24" class="node">
<title>L1_expert1_ffn1_0</title>
<polygon fill="none" stroke="black" points="50976,-2580.5 50840,-2580.5 50840,-2512.5 50976,-2512.5 50976,-2580.5"/>
<text text-anchor="middle" x="50908" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN1</text>
<text text-anchor="middle" x="50908" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="50908" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="50908" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert1_ffn2_0 -->
<g id="node25" class="node">
<title>L1_expert1_ffn2_0</title>
<polygon fill="none" stroke="black" points="52526,-2580.5 52390,-2580.5 52390,-2512.5 52526,-2512.5 52526,-2580.5"/>
<text text-anchor="middle" x="52458" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN2</text>
<text text-anchor="middle" x="52458" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="52458" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="52458" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert1_ffn2_0&#45;&gt;L1_expert_concat_head0 -->
<g id="edge6" class="edge">
<title>L1_expert1_ffn2_0&#45;&gt;L1_expert_concat_head0</title>
<path fill="none" stroke="black" d="M52458,-2512.44C52458,-2484.68 52458,-2444.23 52458,-2410.4"/>
<polygon fill="black" stroke="black" points="52461.5,-2410.14 52458,-2400.14 52454.5,-2410.14 52461.5,-2410.14"/>
</g>
<!-- L1_expert1_gate_0 -->
<g id="node26" class="node">
<title>L1_expert1_gate_0</title>
<polygon fill="none" stroke="black" points="50550,-2599.5 50432,-2546.5 50550,-2493.5 50668,-2546.5 50550,-2599.5"/>
<text text-anchor="middle" x="50550" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="50550" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="50550" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert0_ffn1_0 -->
<g id="node27" class="node">
<title>L2_expert0_ffn1_0</title>
<polygon fill="none" stroke="black" points="50414,-2580.5 50278,-2580.5 50278,-2512.5 50414,-2512.5 50414,-2580.5"/>
<text text-anchor="middle" x="50346" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN1</text>
<text text-anchor="middle" x="50346" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="50346" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="50346" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert0_ffn2_0 -->
<g id="node28" class="node">
<title>L2_expert0_ffn2_0</title>
<polygon fill="none" stroke="black" points="51384,-2580.5 51248,-2580.5 51248,-2512.5 51384,-2512.5 51384,-2580.5"/>
<text text-anchor="middle" x="51316" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN2</text>
<text text-anchor="middle" x="51316" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="51316" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="51316" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert_concat_head0 -->
<g id="node710" class="node">
<title>L2_expert_concat_head0</title>
<polygon fill="none" stroke="black" points="50754,-2400 50618,-2347 50754,-2294 50890,-2347 50754,-2400"/>
<text text-anchor="middle" x="50754" y="-2358.3" font-family="Times,serif" font-size="14.00">Expert Concat</text>
<text text-anchor="middle" x="50754" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="50754" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert0_ffn2_0&#45;&gt;L2_expert_concat_head0 -->
<g id="edge7" class="edge">
<title>L2_expert0_ffn2_0&#45;&gt;L2_expert_concat_head0</title>
<path fill="none" stroke="black" d="M51301.4,-2512.34C51288.61,-2487.32 51267.59,-2454.27 51239,-2436 51179.6,-2398.04 50995.8,-2372.49 50872.31,-2359.1"/>
<polygon fill="black" stroke="black" points="50872.36,-2355.59 50862.04,-2358 50871.61,-2362.55 50872.36,-2355.59"/>
</g>
<!-- L2_expert0_gate_0 -->
<g id="node29" class="node">
<title>L2_expert0_gate_0</title>
<polygon fill="none" stroke="black" points="49980,-2599.5 49862,-2546.5 49980,-2493.5 50098,-2546.5 49980,-2599.5"/>
<text text-anchor="middle" x="49980" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="49980" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="49980" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert1_ffn1_0 -->
<g id="node30" class="node">
<title>L2_expert1_ffn1_0</title>
<polygon fill="none" stroke="black" points="49844,-2580.5 49708,-2580.5 49708,-2512.5 49844,-2512.5 49844,-2580.5"/>
<text text-anchor="middle" x="49776" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN1</text>
<text text-anchor="middle" x="49776" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="49776" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="49776" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert1_ffn2_0 -->
<g id="node31" class="node">
<title>L2_expert1_ffn2_0</title>
<polygon fill="none" stroke="black" points="50822,-2580.5 50686,-2580.5 50686,-2512.5 50822,-2512.5 50822,-2580.5"/>
<text text-anchor="middle" x="50754" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN2</text>
<text text-anchor="middle" x="50754" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="50754" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="50754" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert1_ffn2_0&#45;&gt;L2_expert_concat_head0 -->
<g id="edge8" class="edge">
<title>L2_expert1_ffn2_0&#45;&gt;L2_expert_concat_head0</title>
<path fill="none" stroke="black" d="M50754,-2512.44C50754,-2484.68 50754,-2444.23 50754,-2410.4"/>
<polygon fill="black" stroke="black" points="50757.5,-2410.14 50754,-2400.14 50750.5,-2410.14 50757.5,-2410.14"/>
</g>
<!-- L2_expert1_gate_0 -->
<g id="node32" class="node">
<title>L2_expert1_gate_0</title>
<polygon fill="none" stroke="black" points="49418,-2599.5 49300,-2546.5 49418,-2493.5 49536,-2546.5 49418,-2599.5"/>
<text text-anchor="middle" x="49418" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="49418" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="49418" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert0_ffn1_0 -->
<g id="node33" class="node">
<title>L3_expert0_ffn1_0</title>
<polygon fill="none" stroke="black" points="49282,-2580.5 49146,-2580.5 49146,-2512.5 49282,-2512.5 49282,-2580.5"/>
<text text-anchor="middle" x="49214" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN1</text>
<text text-anchor="middle" x="49214" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="49214" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="49214" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert0_ffn2_0 -->
<g id="node34" class="node">
<title>L3_expert0_ffn2_0</title>
<polygon fill="none" stroke="black" points="49690,-2580.5 49554,-2580.5 49554,-2512.5 49690,-2512.5 49690,-2580.5"/>
<text text-anchor="middle" x="49622" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN2</text>
<text text-anchor="middle" x="49622" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="49622" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="49622" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert_concat_head0 -->
<g id="node711" class="node">
<title>L3_expert_concat_head0</title>
<polygon fill="none" stroke="black" points="49060,-2400 48924,-2347 49060,-2294 49196,-2347 49060,-2400"/>
<text text-anchor="middle" x="49060" y="-2358.3" font-family="Times,serif" font-size="14.00">Expert Concat</text>
<text text-anchor="middle" x="49060" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="49060" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert0_ffn2_0&#45;&gt;L3_expert_concat_head0 -->
<g id="edge9" class="edge">
<title>L3_expert0_ffn2_0&#45;&gt;L3_expert_concat_head0</title>
<path fill="none" stroke="black" d="M49607.4,-2512.34C49594.61,-2487.32 49573.59,-2454.27 49545,-2436 49485.6,-2398.04 49301.8,-2372.49 49178.31,-2359.1"/>
<polygon fill="black" stroke="black" points="49178.36,-2355.59 49168.04,-2358 49177.61,-2362.55 49178.36,-2355.59"/>
</g>
<!-- L3_expert0_gate_0 -->
<g id="node35" class="node">
<title>L3_expert0_gate_0</title>
<polygon fill="none" stroke="black" points="48856,-2599.5 48738,-2546.5 48856,-2493.5 48974,-2546.5 48856,-2599.5"/>
<text text-anchor="middle" x="48856" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="48856" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="48856" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert1_ffn1_0 -->
<g id="node36" class="node">
<title>L3_expert1_ffn1_0</title>
<polygon fill="none" stroke="black" points="48720,-2580.5 48584,-2580.5 48584,-2512.5 48720,-2512.5 48720,-2580.5"/>
<text text-anchor="middle" x="48652" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN1</text>
<text text-anchor="middle" x="48652" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="48652" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="48652" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert1_ffn2_0 -->
<g id="node37" class="node">
<title>L3_expert1_ffn2_0</title>
<polygon fill="none" stroke="black" points="49128,-2580.5 48992,-2580.5 48992,-2512.5 49128,-2512.5 49128,-2580.5"/>
<text text-anchor="middle" x="49060" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN2</text>
<text text-anchor="middle" x="49060" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="49060" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="49060" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert1_ffn2_0&#45;&gt;L3_expert_concat_head0 -->
<g id="edge10" class="edge">
<title>L3_expert1_ffn2_0&#45;&gt;L3_expert_concat_head0</title>
<path fill="none" stroke="black" d="M49060,-2512.44C49060,-2484.68 49060,-2444.23 49060,-2410.4"/>
<polygon fill="black" stroke="black" points="49063.5,-2410.14 49060,-2400.14 49056.5,-2410.14 49063.5,-2410.14"/>
</g>
<!-- L3_expert1_gate_0 -->
<g id="node38" class="node">
<title>L3_expert1_gate_0</title>
<polygon fill="none" stroke="black" points="48286,-2599.5 48168,-2546.5 48286,-2493.5 48404,-2546.5 48286,-2599.5"/>
<text text-anchor="middle" x="48286" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="48286" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="48286" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert0_ffn1_0 -->
<g id="node39" class="node">
<title>L4_expert0_ffn1_0</title>
<polygon fill="none" stroke="black" points="48150,-2580.5 48014,-2580.5 48014,-2512.5 48150,-2512.5 48150,-2580.5"/>
<text text-anchor="middle" x="48082" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN1</text>
<text text-anchor="middle" x="48082" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="48082" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="48082" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert0_ffn2_0 -->
<g id="node40" class="node">
<title>L4_expert0_ffn2_0</title>
<polygon fill="none" stroke="black" points="47996,-2580.5 47860,-2580.5 47860,-2512.5 47996,-2512.5 47996,-2580.5"/>
<text text-anchor="middle" x="47928" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN2</text>
<text text-anchor="middle" x="47928" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="47928" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="47928" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert_concat_head0 -->
<g id="node712" class="node">
<title>L4_expert_concat_head0</title>
<polygon fill="none" stroke="black" points="47366,-2400 47230,-2347 47366,-2294 47502,-2347 47366,-2400"/>
<text text-anchor="middle" x="47366" y="-2358.3" font-family="Times,serif" font-size="14.00">Expert Concat</text>
<text text-anchor="middle" x="47366" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="47366" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert0_ffn2_0&#45;&gt;L4_expert_concat_head0 -->
<g id="edge11" class="edge">
<title>L4_expert0_ffn2_0&#45;&gt;L4_expert_concat_head0</title>
<path fill="none" stroke="black" d="M47913.4,-2512.34C47900.61,-2487.32 47879.59,-2454.27 47851,-2436 47791.6,-2398.04 47607.8,-2372.49 47484.31,-2359.1"/>
<polygon fill="black" stroke="black" points="47484.36,-2355.59 47474.04,-2358 47483.61,-2362.55 47484.36,-2355.59"/>
</g>
<!-- L4_expert0_gate_0 -->
<g id="node41" class="node">
<title>L4_expert0_gate_0</title>
<polygon fill="none" stroke="black" points="47724,-2599.5 47606,-2546.5 47724,-2493.5 47842,-2546.5 47724,-2599.5"/>
<text text-anchor="middle" x="47724" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="47724" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="47724" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert1_ffn1_0 -->
<g id="node42" class="node">
<title>L4_expert1_ffn1_0</title>
<polygon fill="none" stroke="black" points="47588,-2580.5 47452,-2580.5 47452,-2512.5 47588,-2512.5 47588,-2580.5"/>
<text text-anchor="middle" x="47520" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN1</text>
<text text-anchor="middle" x="47520" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="47520" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="47520" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert1_ffn2_0 -->
<g id="node43" class="node">
<title>L4_expert1_ffn2_0</title>
<polygon fill="none" stroke="black" points="47434,-2580.5 47298,-2580.5 47298,-2512.5 47434,-2512.5 47434,-2580.5"/>
<text text-anchor="middle" x="47366" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN2</text>
<text text-anchor="middle" x="47366" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="47366" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="47366" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert1_ffn2_0&#45;&gt;L4_expert_concat_head0 -->
<g id="edge12" class="edge">
<title>L4_expert1_ffn2_0&#45;&gt;L4_expert_concat_head0</title>
<path fill="none" stroke="black" d="M47366,-2512.44C47366,-2484.68 47366,-2444.23 47366,-2410.4"/>
<polygon fill="black" stroke="black" points="47369.5,-2410.14 47366,-2400.14 47362.5,-2410.14 47369.5,-2410.14"/>
</g>
<!-- L4_expert1_gate_0 -->
<g id="node44" class="node">
<title>L4_expert1_gate_0</title>
<polygon fill="none" stroke="black" points="47162,-2599.5 47044,-2546.5 47162,-2493.5 47280,-2546.5 47162,-2599.5"/>
<text text-anchor="middle" x="47162" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="47162" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="47162" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_Q_proj_1 -->
<g id="node45" class="node">
<title>L1_Q_proj_1</title>
<polygon fill="none" stroke="black" points="62696,-2580.5 62560,-2580.5 62560,-2512.5 62696,-2512.5 62696,-2580.5"/>
<text text-anchor="middle" x="62628" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="62628" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="62628" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="62628" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_K_proj_1 -->
<g id="node46" class="node">
<title>L1_K_proj_1</title>
<polygon fill="none" stroke="black" points="62542,-2580.5 62406,-2580.5 62406,-2512.5 62542,-2512.5 62542,-2580.5"/>
<text text-anchor="middle" x="62474" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="62474" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="62474" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="62474" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_V_proj_1 -->
<g id="node47" class="node">
<title>L1_V_proj_1</title>
<polygon fill="none" stroke="black" points="62388,-2580.5 62252,-2580.5 62252,-2512.5 62388,-2512.5 62388,-2580.5"/>
<text text-anchor="middle" x="62320" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="62320" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="62320" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="62320" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_attention_1 -->
<g id="node48" class="node">
<title>L1_attention_1</title>
<ellipse fill="none" stroke="black" cx="62138" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="62138" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="62138" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="62138" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="62138" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_1 -->
<g id="node49" class="node">
<title>L1_out_proj_1</title>
<polygon fill="none" stroke="black" points="62024,-2580.5 61880,-2580.5 61880,-2512.5 62024,-2512.5 62024,-2580.5"/>
<text text-anchor="middle" x="61952" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="61952" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="61952" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="61952" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_1&#45;&gt;L1_concat_dim_head0 -->
<g id="edge13" class="edge">
<title>L1_out_proj_1&#45;&gt;L1_concat_dim_head0</title>
<path fill="none" stroke="black" d="M61937.69,-2512.25C61924.51,-2486.27 61902.27,-2451.99 61871,-2436 61695.39,-2346.21 55342.66,-2347.07 54267.75,-2347.85"/>
<polygon fill="black" stroke="black" points="54267.64,-2344.35 54257.64,-2347.86 54267.64,-2351.35 54267.64,-2344.35"/>
</g>
<!-- L2_Q_proj_1 -->
<g id="node50" class="node">
<title>L2_Q_proj_1</title>
<polygon fill="none" stroke="black" points="61862,-2580.5 61726,-2580.5 61726,-2512.5 61862,-2512.5 61862,-2580.5"/>
<text text-anchor="middle" x="61794" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="61794" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="61794" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="61794" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_K_proj_1 -->
<g id="node51" class="node">
<title>L2_K_proj_1</title>
<polygon fill="none" stroke="black" points="61708,-2580.5 61572,-2580.5 61572,-2512.5 61708,-2512.5 61708,-2580.5"/>
<text text-anchor="middle" x="61640" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="61640" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="61640" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="61640" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_V_proj_1 -->
<g id="node52" class="node">
<title>L2_V_proj_1</title>
<polygon fill="none" stroke="black" points="61554,-2580.5 61418,-2580.5 61418,-2512.5 61554,-2512.5 61554,-2580.5"/>
<text text-anchor="middle" x="61486" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="61486" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="61486" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="61486" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_attention_1 -->
<g id="node53" class="node">
<title>L2_attention_1</title>
<ellipse fill="none" stroke="black" cx="61304" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="61304" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="61304" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="61304" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="61304" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_1 -->
<g id="node54" class="node">
<title>L2_out_proj_1</title>
<polygon fill="none" stroke="black" points="59538,-2580.5 59394,-2580.5 59394,-2512.5 59538,-2512.5 59538,-2580.5"/>
<text text-anchor="middle" x="59466" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="59466" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="59466" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="59466" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_1&#45;&gt;L2_concat_dim_head0 -->
<g id="edge14" class="edge">
<title>L2_out_proj_1&#45;&gt;L2_concat_dim_head0</title>
<path fill="none" stroke="black" d="M59451.84,-2512.46C59438.71,-2486.42 59416.42,-2451.94 59385,-2436 59297.4,-2391.56 52411.14,-2403.97 52313,-2400 52116.09,-2392.03 51887.98,-2372.69 51751,-2359.97"/>
<polygon fill="black" stroke="black" points="51751.17,-2356.47 51740.89,-2359.03 51750.52,-2363.44 51751.17,-2356.47"/>
</g>
<!-- L3_Q_proj_1 -->
<g id="node55" class="node">
<title>L3_Q_proj_1</title>
<polygon fill="none" stroke="black" points="61036,-2580.5 60900,-2580.5 60900,-2512.5 61036,-2512.5 61036,-2580.5"/>
<text text-anchor="middle" x="60968" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="60968" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="60968" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="60968" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_K_proj_1 -->
<g id="node56" class="node">
<title>L3_K_proj_1</title>
<polygon fill="none" stroke="black" points="60882,-2580.5 60746,-2580.5 60746,-2512.5 60882,-2512.5 60882,-2580.5"/>
<text text-anchor="middle" x="60814" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="60814" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="60814" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="60814" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_V_proj_1 -->
<g id="node57" class="node">
<title>L3_V_proj_1</title>
<polygon fill="none" stroke="black" points="60728,-2580.5 60592,-2580.5 60592,-2512.5 60728,-2512.5 60728,-2580.5"/>
<text text-anchor="middle" x="60660" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="60660" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="60660" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="60660" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_attention_1 -->
<g id="node58" class="node">
<title>L3_attention_1</title>
<ellipse fill="none" stroke="black" cx="60478" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="60478" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="60478" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="60478" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="60478" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_1 -->
<g id="node59" class="node">
<title>L3_out_proj_1</title>
<polygon fill="none" stroke="black" points="58098,-2580.5 57954,-2580.5 57954,-2512.5 58098,-2512.5 58098,-2580.5"/>
<text text-anchor="middle" x="58026" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="58026" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="58026" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="58026" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_1&#45;&gt;L3_concat_dim_head0 -->
<g id="edge15" class="edge">
<title>L3_out_proj_1&#45;&gt;L3_concat_dim_head0</title>
<path fill="none" stroke="black" d="M58011.85,-2512.46C57998.71,-2486.42 57976.42,-2451.94 57945,-2436 57854.13,-2389.91 50710.68,-2406.51 50609,-2400 50502.96,-2393.21 50382.71,-2377.56 50297.96,-2365.19"/>
<polygon fill="black" stroke="black" points="50298.46,-2361.72 50288.06,-2363.73 50297.45,-2368.65 50298.46,-2361.72"/>
</g>
<!-- L4_Q_proj_1 -->
<g id="node60" class="node">
<title>L4_Q_proj_1</title>
<polygon fill="none" stroke="black" points="60210,-2580.5 60074,-2580.5 60074,-2512.5 60210,-2512.5 60210,-2580.5"/>
<text text-anchor="middle" x="60142" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="60142" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="60142" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="60142" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_K_proj_1 -->
<g id="node61" class="node">
<title>L4_K_proj_1</title>
<polygon fill="none" stroke="black" points="60056,-2580.5 59920,-2580.5 59920,-2512.5 60056,-2512.5 60056,-2580.5"/>
<text text-anchor="middle" x="59988" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="59988" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="59988" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="59988" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_V_proj_1 -->
<g id="node62" class="node">
<title>L4_V_proj_1</title>
<polygon fill="none" stroke="black" points="59902,-2580.5 59766,-2580.5 59766,-2512.5 59902,-2512.5 59902,-2580.5"/>
<text text-anchor="middle" x="59834" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="59834" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="59834" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="59834" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_attention_1 -->
<g id="node63" class="node">
<title>L4_attention_1</title>
<ellipse fill="none" stroke="black" cx="59652" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="59652" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="59652" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="59652" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="59652" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_1 -->
<g id="node64" class="node">
<title>L4_out_proj_1</title>
<polygon fill="none" stroke="black" points="56404,-2580.5 56260,-2580.5 56260,-2512.5 56404,-2512.5 56404,-2580.5"/>
<text text-anchor="middle" x="56332" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="56332" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="56332" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="56332" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_1&#45;&gt;L4_concat_dim_head0 -->
<g id="edge16" class="edge">
<title>L4_out_proj_1&#45;&gt;L4_concat_dim_head0</title>
<path fill="none" stroke="black" d="M56317.85,-2512.46C56304.71,-2486.42 56282.42,-2451.94 56251,-2436 56160.13,-2389.91 49016.68,-2406.51 48915,-2400 48808.96,-2393.21 48688.71,-2377.56 48603.96,-2365.19"/>
<polygon fill="black" stroke="black" points="48604.46,-2361.72 48594.06,-2363.73 48603.45,-2368.65 48604.46,-2361.72"/>
</g>
<!-- L1_expert0_ffn1_1 -->
<g id="node65" class="node">
<title>L1_expert0_ffn1_1</title>
<polygon fill="none" stroke="black" points="59376,-2580.5 59240,-2580.5 59240,-2512.5 59376,-2512.5 59376,-2580.5"/>
<text text-anchor="middle" x="59308" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN1</text>
<text text-anchor="middle" x="59308" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="59308" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="59308" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert0_ffn2_1 -->
<g id="node66" class="node">
<title>L1_expert0_ffn2_1</title>
<polygon fill="none" stroke="black" points="61190,-2580.5 61054,-2580.5 61054,-2512.5 61190,-2512.5 61190,-2580.5"/>
<text text-anchor="middle" x="61122" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN2</text>
<text text-anchor="middle" x="61122" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="61122" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="61122" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert0_ffn2_1&#45;&gt;L1_expert_concat_head0 -->
<g id="edge17" class="edge">
<title>L1_expert0_ffn2_1&#45;&gt;L1_expert_concat_head0</title>
<path fill="none" stroke="black" d="M61108.85,-2512.25C61096.6,-2486.27 61075.59,-2451.98 61045,-2436 60957.77,-2390.42 54057.4,-2401.95 53959,-2400 53451.88,-2389.93 52848.77,-2365.14 52588.36,-2353.81"/>
<polygon fill="black" stroke="black" points="52588.25,-2350.31 52578.11,-2353.37 52587.95,-2357.3 52588.25,-2350.31"/>
</g>
<!-- L1_expert0_gate_1 -->
<g id="node67" class="node">
<title>L1_expert0_gate_1</title>
<polygon fill="none" stroke="black" points="58950,-2599.5 58832,-2546.5 58950,-2493.5 59068,-2546.5 58950,-2599.5"/>
<text text-anchor="middle" x="58950" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="58950" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="58950" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_expert1_ffn1_1 -->
<g id="node68" class="node">
<title>L1_expert1_ffn1_1</title>
<polygon fill="none" stroke="black" points="58814,-2580.5 58678,-2580.5 58678,-2512.5 58814,-2512.5 58814,-2580.5"/>
<text text-anchor="middle" x="58746" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN1</text>
<text text-anchor="middle" x="58746" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="58746" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="58746" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert1_ffn2_1 -->
<g id="node69" class="node">
<title>L1_expert1_ffn2_1</title>
<polygon fill="none" stroke="black" points="60364,-2580.5 60228,-2580.5 60228,-2512.5 60364,-2512.5 60364,-2580.5"/>
<text text-anchor="middle" x="60296" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN2</text>
<text text-anchor="middle" x="60296" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="60296" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="60296" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert1_ffn2_1&#45;&gt;L1_expert_concat_head0 -->
<g id="edge18" class="edge">
<title>L1_expert1_ffn2_1&#45;&gt;L1_expert_concat_head0</title>
<path fill="none" stroke="black" d="M60282.85,-2512.25C60270.59,-2486.28 60249.58,-2451.99 60219,-2436 60141.95,-2395.71 54045.93,-2401.76 53959,-2400 53451.88,-2389.76 52848.77,-2365.06 52588.36,-2353.78"/>
<polygon fill="black" stroke="black" points="52588.25,-2350.28 52578.11,-2353.34 52587.95,-2357.27 52588.25,-2350.28"/>
</g>
<!-- L1_expert1_gate_1 -->
<g id="node70" class="node">
<title>L1_expert1_gate_1</title>
<polygon fill="none" stroke="black" points="58388,-2599.5 58270,-2546.5 58388,-2493.5 58506,-2546.5 58388,-2599.5"/>
<text text-anchor="middle" x="58388" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="58388" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="58388" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert0_ffn1_1 -->
<g id="node71" class="node">
<title>L2_expert0_ffn1_1</title>
<polygon fill="none" stroke="black" points="58252,-2580.5 58116,-2580.5 58116,-2512.5 58252,-2512.5 58252,-2580.5"/>
<text text-anchor="middle" x="58184" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN1</text>
<text text-anchor="middle" x="58184" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="58184" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="58184" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert0_ffn2_1 -->
<g id="node72" class="node">
<title>L2_expert0_ffn2_1</title>
<polygon fill="none" stroke="black" points="59222,-2580.5 59086,-2580.5 59086,-2512.5 59222,-2512.5 59222,-2580.5"/>
<text text-anchor="middle" x="59154" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN2</text>
<text text-anchor="middle" x="59154" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="59154" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="59154" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert0_ffn2_1&#45;&gt;L2_expert_concat_head0 -->
<g id="edge19" class="edge">
<title>L2_expert0_ffn2_1&#45;&gt;L2_expert_concat_head0</title>
<path fill="none" stroke="black" d="M59140.85,-2512.24C59128.6,-2486.26 59107.59,-2451.98 59077,-2436 58983.39,-2387.11 51578.53,-2404.06 51473,-2400 51260.8,-2391.83 51014.03,-2371.65 50871.74,-2358.96"/>
<polygon fill="black" stroke="black" points="50871.95,-2355.47 50861.68,-2358.06 50871.33,-2362.44 50871.95,-2355.47"/>
</g>
<!-- L2_expert0_gate_1 -->
<g id="node73" class="node">
<title>L2_expert0_gate_1</title>
<polygon fill="none" stroke="black" points="57818,-2599.5 57700,-2546.5 57818,-2493.5 57936,-2546.5 57818,-2599.5"/>
<text text-anchor="middle" x="57818" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="57818" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="57818" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert1_ffn1_1 -->
<g id="node74" class="node">
<title>L2_expert1_ffn1_1</title>
<polygon fill="none" stroke="black" points="57682,-2580.5 57546,-2580.5 57546,-2512.5 57682,-2512.5 57682,-2580.5"/>
<text text-anchor="middle" x="57614" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN1</text>
<text text-anchor="middle" x="57614" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="57614" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="57614" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert1_ffn2_1 -->
<g id="node75" class="node">
<title>L2_expert1_ffn2_1</title>
<polygon fill="none" stroke="black" points="58660,-2580.5 58524,-2580.5 58524,-2512.5 58660,-2512.5 58660,-2580.5"/>
<text text-anchor="middle" x="58592" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN2</text>
<text text-anchor="middle" x="58592" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="58592" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="58592" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert1_ffn2_1&#45;&gt;L2_expert_concat_head0 -->
<g id="edge20" class="edge">
<title>L2_expert1_ffn2_1&#45;&gt;L2_expert_concat_head0</title>
<path fill="none" stroke="black" d="M58578.85,-2512.25C58566.6,-2486.27 58545.59,-2451.98 58515,-2436 58428.31,-2390.7 51570.73,-2403.78 51473,-2400 51260.8,-2391.79 51014.03,-2371.62 50871.74,-2358.95"/>
<polygon fill="black" stroke="black" points="50871.95,-2355.46 50861.68,-2358.05 50871.33,-2362.43 50871.95,-2355.46"/>
</g>
<!-- L2_expert1_gate_1 -->
<g id="node76" class="node">
<title>L2_expert1_gate_1</title>
<polygon fill="none" stroke="black" points="57256,-2599.5 57138,-2546.5 57256,-2493.5 57374,-2546.5 57256,-2599.5"/>
<text text-anchor="middle" x="57256" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="57256" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="57256" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert0_ffn1_1 -->
<g id="node77" class="node">
<title>L3_expert0_ffn1_1</title>
<polygon fill="none" stroke="black" points="57120,-2580.5 56984,-2580.5 56984,-2512.5 57120,-2512.5 57120,-2580.5"/>
<text text-anchor="middle" x="57052" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN1</text>
<text text-anchor="middle" x="57052" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="57052" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="57052" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert0_ffn2_1 -->
<g id="node78" class="node">
<title>L3_expert0_ffn2_1</title>
<polygon fill="none" stroke="black" points="57528,-2580.5 57392,-2580.5 57392,-2512.5 57528,-2512.5 57528,-2580.5"/>
<text text-anchor="middle" x="57460" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN2</text>
<text text-anchor="middle" x="57460" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="57460" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="57460" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert0_ffn2_1&#45;&gt;L3_expert_concat_head0 -->
<g id="edge21" class="edge">
<title>L3_expert0_ffn2_1&#45;&gt;L3_expert_concat_head0</title>
<path fill="none" stroke="black" d="M57446.85,-2512.24C57434.6,-2486.27 57413.59,-2451.98 57383,-2436 57292.52,-2388.73 50135.04,-2402.97 50033,-2400 49727.28,-2391.09 49368.07,-2368.83 49183.42,-2356.52"/>
<polygon fill="black" stroke="black" points="49183.61,-2353.02 49173.4,-2355.85 49183.15,-2360.01 49183.61,-2353.02"/>
</g>
<!-- L3_expert0_gate_1 -->
<g id="node79" class="node">
<title>L3_expert0_gate_1</title>
<polygon fill="none" stroke="black" points="56694,-2599.5 56576,-2546.5 56694,-2493.5 56812,-2546.5 56694,-2599.5"/>
<text text-anchor="middle" x="56694" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="56694" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="56694" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert1_ffn1_1 -->
<g id="node80" class="node">
<title>L3_expert1_ffn1_1</title>
<polygon fill="none" stroke="black" points="56558,-2580.5 56422,-2580.5 56422,-2512.5 56558,-2512.5 56558,-2580.5"/>
<text text-anchor="middle" x="56490" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN1</text>
<text text-anchor="middle" x="56490" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="56490" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="56490" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert1_ffn2_1 -->
<g id="node81" class="node">
<title>L3_expert1_ffn2_1</title>
<polygon fill="none" stroke="black" points="56966,-2580.5 56830,-2580.5 56830,-2512.5 56966,-2512.5 56966,-2580.5"/>
<text text-anchor="middle" x="56898" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN2</text>
<text text-anchor="middle" x="56898" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="56898" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="56898" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert1_ffn2_1&#45;&gt;L3_expert_concat_head0 -->
<g id="edge22" class="edge">
<title>L3_expert1_ffn2_1&#45;&gt;L3_expert_concat_head0</title>
<path fill="none" stroke="black" d="M56884.85,-2512.25C56872.6,-2486.27 56851.59,-2451.99 56821,-2436 56737.45,-2392.33 50127.24,-2402.77 50033,-2400 49727.28,-2391.03 49368.07,-2368.79 49183.42,-2356.5"/>
<polygon fill="black" stroke="black" points="49183.61,-2353.01 49173.4,-2355.83 49183.15,-2359.99 49183.61,-2353.01"/>
</g>
<!-- L3_expert1_gate_1 -->
<g id="node82" class="node">
<title>L3_expert1_gate_1</title>
<polygon fill="none" stroke="black" points="56124,-2599.5 56006,-2546.5 56124,-2493.5 56242,-2546.5 56124,-2599.5"/>
<text text-anchor="middle" x="56124" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="56124" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="56124" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert0_ffn1_1 -->
<g id="node83" class="node">
<title>L4_expert0_ffn1_1</title>
<polygon fill="none" stroke="black" points="55988,-2580.5 55852,-2580.5 55852,-2512.5 55988,-2512.5 55988,-2580.5"/>
<text text-anchor="middle" x="55920" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN1</text>
<text text-anchor="middle" x="55920" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="55920" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="55920" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert0_ffn2_1 -->
<g id="node84" class="node">
<title>L4_expert0_ffn2_1</title>
<polygon fill="none" stroke="black" points="55834,-2580.5 55698,-2580.5 55698,-2512.5 55834,-2512.5 55834,-2580.5"/>
<text text-anchor="middle" x="55766" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN2</text>
<text text-anchor="middle" x="55766" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="55766" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="55766" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert0_ffn2_1&#45;&gt;L4_expert_concat_head0 -->
<g id="edge23" class="edge">
<title>L4_expert0_ffn2_1&#45;&gt;L4_expert_concat_head0</title>
<path fill="none" stroke="black" d="M55752.85,-2512.24C55740.6,-2486.27 55719.59,-2451.98 55689,-2436 55598.52,-2388.73 48441.04,-2402.97 48339,-2400 48033.28,-2391.09 47674.07,-2368.83 47489.42,-2356.52"/>
<polygon fill="black" stroke="black" points="47489.61,-2353.02 47479.4,-2355.85 47489.15,-2360.01 47489.61,-2353.02"/>
</g>
<!-- L4_expert0_gate_1 -->
<g id="node85" class="node">
<title>L4_expert0_gate_1</title>
<polygon fill="none" stroke="black" points="55562,-2599.5 55444,-2546.5 55562,-2493.5 55680,-2546.5 55562,-2599.5"/>
<text text-anchor="middle" x="55562" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="55562" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="55562" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert1_ffn1_1 -->
<g id="node86" class="node">
<title>L4_expert1_ffn1_1</title>
<polygon fill="none" stroke="black" points="55426,-2580.5 55290,-2580.5 55290,-2512.5 55426,-2512.5 55426,-2580.5"/>
<text text-anchor="middle" x="55358" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN1</text>
<text text-anchor="middle" x="55358" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="55358" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="55358" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert1_ffn2_1 -->
<g id="node87" class="node">
<title>L4_expert1_ffn2_1</title>
<polygon fill="none" stroke="black" points="55272,-2580.5 55136,-2580.5 55136,-2512.5 55272,-2512.5 55272,-2580.5"/>
<text text-anchor="middle" x="55204" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN2</text>
<text text-anchor="middle" x="55204" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="55204" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="55204" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert1_ffn2_1&#45;&gt;L4_expert_concat_head0 -->
<g id="edge24" class="edge">
<title>L4_expert1_ffn2_1&#45;&gt;L4_expert_concat_head0</title>
<path fill="none" stroke="black" d="M55190.85,-2512.25C55178.6,-2486.27 55157.59,-2451.99 55127,-2436 55043.45,-2392.33 48433.24,-2402.77 48339,-2400 48033.28,-2391.03 47674.07,-2368.79 47489.42,-2356.5"/>
<polygon fill="black" stroke="black" points="47489.61,-2353.01 47479.4,-2355.83 47489.15,-2359.99 47489.61,-2353.01"/>
</g>
<!-- L4_expert1_gate_1 -->
<g id="node88" class="node">
<title>L4_expert1_gate_1</title>
<polygon fill="none" stroke="black" points="55000,-2599.5 54882,-2546.5 55000,-2493.5 55118,-2546.5 55000,-2599.5"/>
<text text-anchor="middle" x="55000" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="55000" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="55000" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_Q_proj_2 -->
<g id="node89" class="node">
<title>L1_Q_proj_2</title>
<polygon fill="none" stroke="black" points="39182,-2580.5 39046,-2580.5 39046,-2512.5 39182,-2512.5 39182,-2580.5"/>
<text text-anchor="middle" x="39114" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="39114" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="39114" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="39114" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_K_proj_2 -->
<g id="node90" class="node">
<title>L1_K_proj_2</title>
<polygon fill="none" stroke="black" points="39028,-2580.5 38892,-2580.5 38892,-2512.5 39028,-2512.5 39028,-2580.5"/>
<text text-anchor="middle" x="38960" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="38960" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="38960" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="38960" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_V_proj_2 -->
<g id="node91" class="node">
<title>L1_V_proj_2</title>
<polygon fill="none" stroke="black" points="38874,-2580.5 38738,-2580.5 38738,-2512.5 38874,-2512.5 38874,-2580.5"/>
<text text-anchor="middle" x="38806" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="38806" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="38806" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="38806" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_attention_2 -->
<g id="node92" class="node">
<title>L1_attention_2</title>
<ellipse fill="none" stroke="black" cx="38624" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="38624" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="38624" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="38624" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="38624" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_2 -->
<g id="node93" class="node">
<title>L1_out_proj_2</title>
<polygon fill="none" stroke="black" points="38510,-2580.5 38366,-2580.5 38366,-2512.5 38510,-2512.5 38510,-2580.5"/>
<text text-anchor="middle" x="38438" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="38438" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="38438" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="38438" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_2&#45;&gt;L1_concat_dim_head0 -->
<g id="edge25" class="edge">
<title>L1_out_proj_2&#45;&gt;L1_concat_dim_head0</title>
<path fill="none" stroke="black" d="M38452.14,-2512.44C38465.28,-2486.39 38487.56,-2451.9 38519,-2436 38606.28,-2391.86 52505.21,-2401.81 52603,-2400 53109.23,-2390.64 53710.45,-2365.86 53976.1,-2354.22"/>
<polygon fill="black" stroke="black" points="53976.34,-2357.71 53986.18,-2353.77 53976.04,-2350.72 53976.34,-2357.71"/>
</g>
<!-- L2_Q_proj_2 -->
<g id="node94" class="node">
<title>L2_Q_proj_2</title>
<polygon fill="none" stroke="black" points="38348,-2580.5 38212,-2580.5 38212,-2512.5 38348,-2512.5 38348,-2580.5"/>
<text text-anchor="middle" x="38280" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="38280" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="38280" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="38280" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_K_proj_2 -->
<g id="node95" class="node">
<title>L2_K_proj_2</title>
<polygon fill="none" stroke="black" points="38194,-2580.5 38058,-2580.5 38058,-2512.5 38194,-2512.5 38194,-2580.5"/>
<text text-anchor="middle" x="38126" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="38126" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="38126" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="38126" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_V_proj_2 -->
<g id="node96" class="node">
<title>L2_V_proj_2</title>
<polygon fill="none" stroke="black" points="38040,-2580.5 37904,-2580.5 37904,-2512.5 38040,-2512.5 38040,-2580.5"/>
<text text-anchor="middle" x="37972" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="37972" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="37972" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="37972" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_attention_2 -->
<g id="node97" class="node">
<title>L2_attention_2</title>
<ellipse fill="none" stroke="black" cx="37790" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="37790" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="37790" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="37790" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="37790" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_2 -->
<g id="node98" class="node">
<title>L2_out_proj_2</title>
<polygon fill="none" stroke="black" points="36024,-2580.5 35880,-2580.5 35880,-2512.5 36024,-2512.5 36024,-2580.5"/>
<text text-anchor="middle" x="35952" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="35952" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="35952" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="35952" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_2&#45;&gt;L2_concat_dim_head0 -->
<g id="edge26" class="edge">
<title>L2_out_proj_2&#45;&gt;L2_concat_dim_head0</title>
<path fill="none" stroke="black" d="M35966.14,-2512.44C35979.28,-2486.38 36001.56,-2451.9 36033,-2436 36125.13,-2389.41 50795.83,-2403.8 50899,-2400 51111.67,-2392.17 51358.59,-2372.28 51503.6,-2359.49"/>
<polygon fill="black" stroke="black" points="51504.21,-2362.95 51513.86,-2358.58 51503.59,-2355.98 51504.21,-2362.95"/>
</g>
<!-- L3_Q_proj_2 -->
<g id="node99" class="node">
<title>L3_Q_proj_2</title>
<polygon fill="none" stroke="black" points="37522,-2580.5 37386,-2580.5 37386,-2512.5 37522,-2512.5 37522,-2580.5"/>
<text text-anchor="middle" x="37454" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="37454" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="37454" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="37454" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_K_proj_2 -->
<g id="node100" class="node">
<title>L3_K_proj_2</title>
<polygon fill="none" stroke="black" points="37368,-2580.5 37232,-2580.5 37232,-2512.5 37368,-2512.5 37368,-2580.5"/>
<text text-anchor="middle" x="37300" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="37300" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="37300" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="37300" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_V_proj_2 -->
<g id="node101" class="node">
<title>L3_V_proj_2</title>
<polygon fill="none" stroke="black" points="37214,-2580.5 37078,-2580.5 37078,-2512.5 37214,-2512.5 37214,-2580.5"/>
<text text-anchor="middle" x="37146" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="37146" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="37146" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="37146" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_attention_2 -->
<g id="node102" class="node">
<title>L3_attention_2</title>
<ellipse fill="none" stroke="black" cx="36964" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="36964" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="36964" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="36964" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="36964" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_2 -->
<g id="node103" class="node">
<title>L3_out_proj_2</title>
<polygon fill="none" stroke="black" points="34584,-2580.5 34440,-2580.5 34440,-2512.5 34584,-2512.5 34584,-2580.5"/>
<text text-anchor="middle" x="34512" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="34512" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="34512" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="34512" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_2&#45;&gt;L3_concat_dim_head0 -->
<g id="edge27" class="edge">
<title>L3_out_proj_2&#45;&gt;L3_concat_dim_head0</title>
<path fill="none" stroke="black" d="M34526.14,-2512.44C34539.28,-2486.39 34561.56,-2451.9 34593,-2436 34683.55,-2390.21 49103.57,-2402.81 49205,-2400 49510.51,-2391.55 49868.89,-2369.53 50057.18,-2357.02"/>
<polygon fill="black" stroke="black" points="50057.65,-2360.5 50067.39,-2356.34 50057.18,-2353.51 50057.65,-2360.5"/>
</g>
<!-- L4_Q_proj_2 -->
<g id="node104" class="node">
<title>L4_Q_proj_2</title>
<polygon fill="none" stroke="black" points="36696,-2580.5 36560,-2580.5 36560,-2512.5 36696,-2512.5 36696,-2580.5"/>
<text text-anchor="middle" x="36628" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="36628" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="36628" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="36628" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_K_proj_2 -->
<g id="node105" class="node">
<title>L4_K_proj_2</title>
<polygon fill="none" stroke="black" points="36542,-2580.5 36406,-2580.5 36406,-2512.5 36542,-2512.5 36542,-2580.5"/>
<text text-anchor="middle" x="36474" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="36474" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="36474" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="36474" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_V_proj_2 -->
<g id="node106" class="node">
<title>L4_V_proj_2</title>
<polygon fill="none" stroke="black" points="36388,-2580.5 36252,-2580.5 36252,-2512.5 36388,-2512.5 36388,-2580.5"/>
<text text-anchor="middle" x="36320" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="36320" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="36320" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="36320" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_attention_2 -->
<g id="node107" class="node">
<title>L4_attention_2</title>
<ellipse fill="none" stroke="black" cx="36138" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="36138" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="36138" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="36138" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="36138" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_2 -->
<g id="node108" class="node">
<title>L4_out_proj_2</title>
<polygon fill="none" stroke="black" points="32890,-2580.5 32746,-2580.5 32746,-2512.5 32890,-2512.5 32890,-2580.5"/>
<text text-anchor="middle" x="32818" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="32818" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="32818" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="32818" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_2&#45;&gt;L4_concat_dim_head0 -->
<g id="edge28" class="edge">
<title>L4_out_proj_2&#45;&gt;L4_concat_dim_head0</title>
<path fill="none" stroke="black" d="M32832.14,-2512.44C32845.28,-2486.39 32867.56,-2451.9 32899,-2436 32989.55,-2390.21 47409.57,-2402.81 47511,-2400 47816.51,-2391.55 48174.89,-2369.53 48363.18,-2357.02"/>
<polygon fill="black" stroke="black" points="48363.65,-2360.5 48373.39,-2356.34 48363.18,-2353.51 48363.65,-2360.5"/>
</g>
<!-- L1_expert0_ffn1_2 -->
<g id="node109" class="node">
<title>L1_expert0_ffn1_2</title>
<polygon fill="none" stroke="black" points="35862,-2580.5 35726,-2580.5 35726,-2512.5 35862,-2512.5 35862,-2580.5"/>
<text text-anchor="middle" x="35794" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN1</text>
<text text-anchor="middle" x="35794" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="35794" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="35794" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert0_ffn2_2 -->
<g id="node110" class="node">
<title>L1_expert0_ffn2_2</title>
<polygon fill="none" stroke="black" points="37676,-2580.5 37540,-2580.5 37540,-2512.5 37676,-2512.5 37676,-2580.5"/>
<text text-anchor="middle" x="37608" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN2</text>
<text text-anchor="middle" x="37608" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="37608" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="37608" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert0_ffn2_2&#45;&gt;L1_expert_concat_head0 -->
<g id="edge29" class="edge">
<title>L1_expert0_ffn2_2&#45;&gt;L1_expert_concat_head0</title>
<path fill="none" stroke="black" d="M37621.02,-2512.49C37633.24,-2486.47 37654.29,-2452 37685,-2436 37771.83,-2390.77 51685.17,-2403.89 51783,-2400 51979.3,-2392.2 52207.01,-2372.42 52341.44,-2359.63"/>
<polygon fill="black" stroke="black" points="52342.13,-2363.08 52351.76,-2358.64 52341.47,-2356.11 52342.13,-2363.08"/>
</g>
<!-- L1_expert0_gate_2 -->
<g id="node111" class="node">
<title>L1_expert0_gate_2</title>
<polygon fill="none" stroke="black" points="35436,-2599.5 35318,-2546.5 35436,-2493.5 35554,-2546.5 35436,-2599.5"/>
<text text-anchor="middle" x="35436" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="35436" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="35436" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_expert1_ffn1_2 -->
<g id="node112" class="node">
<title>L1_expert1_ffn1_2</title>
<polygon fill="none" stroke="black" points="35300,-2580.5 35164,-2580.5 35164,-2512.5 35300,-2512.5 35300,-2580.5"/>
<text text-anchor="middle" x="35232" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN1</text>
<text text-anchor="middle" x="35232" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="35232" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="35232" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert1_ffn2_2 -->
<g id="node113" class="node">
<title>L1_expert1_ffn2_2</title>
<polygon fill="none" stroke="black" points="36850,-2580.5 36714,-2580.5 36714,-2512.5 36850,-2512.5 36850,-2580.5"/>
<text text-anchor="middle" x="36782" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN2</text>
<text text-anchor="middle" x="36782" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="36782" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="36782" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert1_ffn2_2&#45;&gt;L1_expert_concat_head0 -->
<g id="edge30" class="edge">
<title>L1_expert1_ffn2_2&#45;&gt;L1_expert_concat_head0</title>
<path fill="none" stroke="black" d="M36795.01,-2512.49C36807.24,-2486.47 36828.29,-2452 36859,-2436 36950.92,-2388.13 51679.44,-2404.11 51783,-2400 51979.3,-2392.21 52207.02,-2372.43 52341.44,-2359.63"/>
<polygon fill="black" stroke="black" points="52342.13,-2363.08 52351.76,-2358.64 52341.47,-2356.11 52342.13,-2363.08"/>
</g>
<!-- L1_expert1_gate_2 -->
<g id="node114" class="node">
<title>L1_expert1_gate_2</title>
<polygon fill="none" stroke="black" points="34874,-2599.5 34756,-2546.5 34874,-2493.5 34992,-2546.5 34874,-2599.5"/>
<text text-anchor="middle" x="34874" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="34874" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="34874" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert0_ffn1_2 -->
<g id="node115" class="node">
<title>L2_expert0_ffn1_2</title>
<polygon fill="none" stroke="black" points="34738,-2580.5 34602,-2580.5 34602,-2512.5 34738,-2512.5 34738,-2580.5"/>
<text text-anchor="middle" x="34670" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN1</text>
<text text-anchor="middle" x="34670" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="34670" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="34670" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert0_ffn2_2 -->
<g id="node116" class="node">
<title>L2_expert0_ffn2_2</title>
<polygon fill="none" stroke="black" points="35708,-2580.5 35572,-2580.5 35572,-2512.5 35708,-2512.5 35708,-2580.5"/>
<text text-anchor="middle" x="35640" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN2</text>
<text text-anchor="middle" x="35640" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="35640" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="35640" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert0_ffn2_2&#45;&gt;L2_expert_concat_head0 -->
<g id="edge31" class="edge">
<title>L2_expert0_ffn2_2&#45;&gt;L2_expert_concat_head0</title>
<path fill="none" stroke="black" d="M35653.01,-2512.49C35665.24,-2486.47 35686.29,-2452 35717,-2436 35807.08,-2389.08 50241.64,-2406.51 50343,-2400 50447.84,-2393.26 50566.84,-2377.29 50649.71,-2364.81"/>
<polygon fill="black" stroke="black" points="50650.27,-2368.26 50659.64,-2363.3 50649.22,-2361.34 50650.27,-2368.26"/>
</g>
<!-- L2_expert0_gate_2 -->
<g id="node117" class="node">
<title>L2_expert0_gate_2</title>
<polygon fill="none" stroke="black" points="34304,-2599.5 34186,-2546.5 34304,-2493.5 34422,-2546.5 34304,-2599.5"/>
<text text-anchor="middle" x="34304" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="34304" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="34304" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert1_ffn1_2 -->
<g id="node118" class="node">
<title>L2_expert1_ffn1_2</title>
<polygon fill="none" stroke="black" points="34168,-2580.5 34032,-2580.5 34032,-2512.5 34168,-2512.5 34168,-2580.5"/>
<text text-anchor="middle" x="34100" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN1</text>
<text text-anchor="middle" x="34100" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="34100" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="34100" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert1_ffn2_2 -->
<g id="node119" class="node">
<title>L2_expert1_ffn2_2</title>
<polygon fill="none" stroke="black" points="35146,-2580.5 35010,-2580.5 35010,-2512.5 35146,-2512.5 35146,-2580.5"/>
<text text-anchor="middle" x="35078" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN2</text>
<text text-anchor="middle" x="35078" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="35078" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="35078" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert1_ffn2_2&#45;&gt;L2_expert_concat_head0 -->
<g id="edge32" class="edge">
<title>L2_expert1_ffn2_2&#45;&gt;L2_expert_concat_head0</title>
<path fill="none" stroke="black" d="M35091.01,-2512.49C35103.24,-2486.47 35124.29,-2451.99 35155,-2436 35248.55,-2387.28 50237.74,-2406.76 50343,-2400 50447.84,-2393.27 50566.84,-2377.29 50649.71,-2364.81"/>
<polygon fill="black" stroke="black" points="50650.27,-2368.26 50659.64,-2363.31 50649.22,-2361.34 50650.27,-2368.26"/>
</g>
<!-- L2_expert1_gate_2 -->
<g id="node120" class="node">
<title>L2_expert1_gate_2</title>
<polygon fill="none" stroke="black" points="33742,-2599.5 33624,-2546.5 33742,-2493.5 33860,-2546.5 33742,-2599.5"/>
<text text-anchor="middle" x="33742" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="33742" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="33742" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert0_ffn1_2 -->
<g id="node121" class="node">
<title>L3_expert0_ffn1_2</title>
<polygon fill="none" stroke="black" points="33606,-2580.5 33470,-2580.5 33470,-2512.5 33606,-2512.5 33606,-2580.5"/>
<text text-anchor="middle" x="33538" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN1</text>
<text text-anchor="middle" x="33538" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="33538" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="33538" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert0_ffn2_2 -->
<g id="node122" class="node">
<title>L3_expert0_ffn2_2</title>
<polygon fill="none" stroke="black" points="34014,-2580.5 33878,-2580.5 33878,-2512.5 34014,-2512.5 34014,-2580.5"/>
<text text-anchor="middle" x="33946" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN2</text>
<text text-anchor="middle" x="33946" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="33946" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="33946" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert0_ffn2_2&#45;&gt;L3_expert_concat_head0 -->
<g id="edge33" class="edge">
<title>L3_expert0_ffn2_2&#45;&gt;L3_expert_concat_head0</title>
<path fill="none" stroke="black" d="M33959.01,-2512.49C33971.24,-2486.47 33992.29,-2452 34023,-2436 34113.08,-2389.08 48547.64,-2406.51 48649,-2400 48753.84,-2393.26 48872.84,-2377.29 48955.71,-2364.81"/>
<polygon fill="black" stroke="black" points="48956.27,-2368.26 48965.64,-2363.3 48955.22,-2361.34 48956.27,-2368.26"/>
</g>
<!-- L3_expert0_gate_2 -->
<g id="node123" class="node">
<title>L3_expert0_gate_2</title>
<polygon fill="none" stroke="black" points="33180,-2599.5 33062,-2546.5 33180,-2493.5 33298,-2546.5 33180,-2599.5"/>
<text text-anchor="middle" x="33180" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="33180" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="33180" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert1_ffn1_2 -->
<g id="node124" class="node">
<title>L3_expert1_ffn1_2</title>
<polygon fill="none" stroke="black" points="33044,-2580.5 32908,-2580.5 32908,-2512.5 33044,-2512.5 33044,-2580.5"/>
<text text-anchor="middle" x="32976" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN1</text>
<text text-anchor="middle" x="32976" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="32976" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="32976" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert1_ffn2_2 -->
<g id="node125" class="node">
<title>L3_expert1_ffn2_2</title>
<polygon fill="none" stroke="black" points="33452,-2580.5 33316,-2580.5 33316,-2512.5 33452,-2512.5 33452,-2580.5"/>
<text text-anchor="middle" x="33384" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN2</text>
<text text-anchor="middle" x="33384" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="33384" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="33384" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert1_ffn2_2&#45;&gt;L3_expert_concat_head0 -->
<g id="edge34" class="edge">
<title>L3_expert1_ffn2_2&#45;&gt;L3_expert_concat_head0</title>
<path fill="none" stroke="black" d="M33397.01,-2512.49C33409.24,-2486.47 33430.29,-2451.99 33461,-2436 33554.55,-2387.28 48543.74,-2406.76 48649,-2400 48753.84,-2393.27 48872.84,-2377.29 48955.71,-2364.81"/>
<polygon fill="black" stroke="black" points="48956.27,-2368.26 48965.64,-2363.31 48955.22,-2361.34 48956.27,-2368.26"/>
</g>
<!-- L3_expert1_gate_2 -->
<g id="node126" class="node">
<title>L3_expert1_gate_2</title>
<polygon fill="none" stroke="black" points="32610,-2599.5 32492,-2546.5 32610,-2493.5 32728,-2546.5 32610,-2599.5"/>
<text text-anchor="middle" x="32610" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="32610" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="32610" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert0_ffn1_2 -->
<g id="node127" class="node">
<title>L4_expert0_ffn1_2</title>
<polygon fill="none" stroke="black" points="32474,-2580.5 32338,-2580.5 32338,-2512.5 32474,-2512.5 32474,-2580.5"/>
<text text-anchor="middle" x="32406" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN1</text>
<text text-anchor="middle" x="32406" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="32406" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="32406" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert0_ffn2_2 -->
<g id="node128" class="node">
<title>L4_expert0_ffn2_2</title>
<polygon fill="none" stroke="black" points="32320,-2580.5 32184,-2580.5 32184,-2512.5 32320,-2512.5 32320,-2580.5"/>
<text text-anchor="middle" x="32252" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN2</text>
<text text-anchor="middle" x="32252" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="32252" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="32252" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert0_ffn2_2&#45;&gt;L4_expert_concat_head0 -->
<g id="edge35" class="edge">
<title>L4_expert0_ffn2_2&#45;&gt;L4_expert_concat_head0</title>
<path fill="none" stroke="black" d="M32265.15,-2512.25C32277.41,-2486.28 32298.42,-2451.99 32329,-2436 32503.34,-2344.82 45693.09,-2347.34 47221.97,-2347.93"/>
<polygon fill="black" stroke="black" points="47222.17,-2351.43 47232.18,-2347.94 47222.18,-2344.43 47222.17,-2351.43"/>
</g>
<!-- L4_expert0_gate_2 -->
<g id="node129" class="node">
<title>L4_expert0_gate_2</title>
<polygon fill="none" stroke="black" points="32048,-2599.5 31930,-2546.5 32048,-2493.5 32166,-2546.5 32048,-2599.5"/>
<text text-anchor="middle" x="32048" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="32048" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="32048" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert1_ffn1_2 -->
<g id="node130" class="node">
<title>L4_expert1_ffn1_2</title>
<polygon fill="none" stroke="black" points="31912,-2580.5 31776,-2580.5 31776,-2512.5 31912,-2512.5 31912,-2580.5"/>
<text text-anchor="middle" x="31844" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN1</text>
<text text-anchor="middle" x="31844" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="31844" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="31844" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert1_ffn2_2 -->
<g id="node131" class="node">
<title>L4_expert1_ffn2_2</title>
<polygon fill="none" stroke="black" points="31758,-2580.5 31622,-2580.5 31622,-2512.5 31758,-2512.5 31758,-2580.5"/>
<text text-anchor="middle" x="31690" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN2</text>
<text text-anchor="middle" x="31690" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="31690" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="31690" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert1_ffn2_2&#45;&gt;L4_expert_concat_head0 -->
<g id="edge36" class="edge">
<title>L4_expert1_ffn2_2&#45;&gt;L4_expert_concat_head0</title>
<path fill="none" stroke="black" d="M31703.15,-2512.25C31715.41,-2486.28 31736.42,-2451.99 31767,-2436 31948.07,-2341.32 45662.34,-2346.96 47222.06,-2347.9"/>
<polygon fill="black" stroke="black" points="47222.19,-2351.4 47232.19,-2347.91 47222.19,-2344.4 47222.19,-2351.4"/>
</g>
<!-- L4_expert1_gate_2 -->
<g id="node132" class="node">
<title>L4_expert1_gate_2</title>
<polygon fill="none" stroke="black" points="31486,-2599.5 31368,-2546.5 31486,-2493.5 31604,-2546.5 31486,-2599.5"/>
<text text-anchor="middle" x="31486" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="31486" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="31486" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_Q_proj_3 -->
<g id="node133" class="node">
<title>L1_Q_proj_3</title>
<polygon fill="none" stroke="black" points="47020,-2580.5 46884,-2580.5 46884,-2512.5 47020,-2512.5 47020,-2580.5"/>
<text text-anchor="middle" x="46952" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="46952" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="46952" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="46952" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_K_proj_3 -->
<g id="node134" class="node">
<title>L1_K_proj_3</title>
<polygon fill="none" stroke="black" points="46866,-2580.5 46730,-2580.5 46730,-2512.5 46866,-2512.5 46866,-2580.5"/>
<text text-anchor="middle" x="46798" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="46798" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="46798" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="46798" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_V_proj_3 -->
<g id="node135" class="node">
<title>L1_V_proj_3</title>
<polygon fill="none" stroke="black" points="46712,-2580.5 46576,-2580.5 46576,-2512.5 46712,-2512.5 46712,-2580.5"/>
<text text-anchor="middle" x="46644" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="46644" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="46644" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="46644" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_attention_3 -->
<g id="node136" class="node">
<title>L1_attention_3</title>
<ellipse fill="none" stroke="black" cx="46462" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="46462" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="46462" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="46462" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="46462" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_3 -->
<g id="node137" class="node">
<title>L1_out_proj_3</title>
<polygon fill="none" stroke="black" points="46348,-2580.5 46204,-2580.5 46204,-2512.5 46348,-2512.5 46348,-2580.5"/>
<text text-anchor="middle" x="46276" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="46276" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="46276" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="46276" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_3&#45;&gt;L1_concat_dim_head0 -->
<g id="edge37" class="edge">
<title>L1_out_proj_3&#45;&gt;L1_concat_dim_head0</title>
<path fill="none" stroke="black" d="M46290.16,-2512.46C46303.3,-2486.43 46325.58,-2451.95 46357,-2436 46434.35,-2396.72 52516.27,-2401.74 52603,-2400 53109.21,-2389.83 53710.44,-2365.46 53976.1,-2354.07"/>
<polygon fill="black" stroke="black" points="53976.34,-2357.56 53986.18,-2353.63 53976.04,-2350.57 53976.34,-2357.56"/>
</g>
<!-- L2_Q_proj_3 -->
<g id="node138" class="node">
<title>L2_Q_proj_3</title>
<polygon fill="none" stroke="black" points="46186,-2580.5 46050,-2580.5 46050,-2512.5 46186,-2512.5 46186,-2580.5"/>
<text text-anchor="middle" x="46118" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="46118" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="46118" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="46118" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_K_proj_3 -->
<g id="node139" class="node">
<title>L2_K_proj_3</title>
<polygon fill="none" stroke="black" points="46032,-2580.5 45896,-2580.5 45896,-2512.5 46032,-2512.5 46032,-2580.5"/>
<text text-anchor="middle" x="45964" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="45964" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="45964" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="45964" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_V_proj_3 -->
<g id="node140" class="node">
<title>L2_V_proj_3</title>
<polygon fill="none" stroke="black" points="45878,-2580.5 45742,-2580.5 45742,-2512.5 45878,-2512.5 45878,-2580.5"/>
<text text-anchor="middle" x="45810" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="45810" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="45810" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="45810" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_attention_3 -->
<g id="node141" class="node">
<title>L2_attention_3</title>
<ellipse fill="none" stroke="black" cx="45628" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="45628" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="45628" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="45628" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="45628" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_3 -->
<g id="node142" class="node">
<title>L2_out_proj_3</title>
<polygon fill="none" stroke="black" points="43862,-2580.5 43718,-2580.5 43718,-2512.5 43862,-2512.5 43862,-2580.5"/>
<text text-anchor="middle" x="43790" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="43790" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="43790" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="43790" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_3&#45;&gt;L2_concat_dim_head0 -->
<g id="edge38" class="edge">
<title>L2_out_proj_3&#45;&gt;L2_concat_dim_head0</title>
<path fill="none" stroke="black" d="M43804.16,-2512.46C43817.29,-2486.42 43839.58,-2451.94 43871,-2436 43958.05,-2391.84 50801.46,-2403.72 50899,-2400 51111.51,-2391.89 51358.23,-2372.11 51503.28,-2359.42"/>
<polygon fill="black" stroke="black" points="51503.89,-2362.88 51513.54,-2358.51 51503.28,-2355.9 51503.89,-2362.88"/>
</g>
<!-- L3_Q_proj_3 -->
<g id="node143" class="node">
<title>L3_Q_proj_3</title>
<polygon fill="none" stroke="black" points="45360,-2580.5 45224,-2580.5 45224,-2512.5 45360,-2512.5 45360,-2580.5"/>
<text text-anchor="middle" x="45292" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="45292" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="45292" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="45292" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_K_proj_3 -->
<g id="node144" class="node">
<title>L3_K_proj_3</title>
<polygon fill="none" stroke="black" points="45206,-2580.5 45070,-2580.5 45070,-2512.5 45206,-2512.5 45206,-2580.5"/>
<text text-anchor="middle" x="45138" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="45138" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="45138" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="45138" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_V_proj_3 -->
<g id="node145" class="node">
<title>L3_V_proj_3</title>
<polygon fill="none" stroke="black" points="45052,-2580.5 44916,-2580.5 44916,-2512.5 45052,-2512.5 45052,-2580.5"/>
<text text-anchor="middle" x="44984" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="44984" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="44984" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="44984" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_attention_3 -->
<g id="node146" class="node">
<title>L3_attention_3</title>
<ellipse fill="none" stroke="black" cx="44802" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="44802" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="44802" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="44802" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="44802" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_3 -->
<g id="node147" class="node">
<title>L3_out_proj_3</title>
<polygon fill="none" stroke="black" points="42422,-2580.5 42278,-2580.5 42278,-2512.5 42422,-2512.5 42422,-2580.5"/>
<text text-anchor="middle" x="42350" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="42350" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="42350" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="42350" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_3&#45;&gt;L3_concat_dim_head0 -->
<g id="edge39" class="edge">
<title>L3_out_proj_3&#45;&gt;L3_concat_dim_head0</title>
<path fill="none" stroke="black" d="M42364.16,-2512.46C42377.3,-2486.42 42399.58,-2451.94 42431,-2436 42514.9,-2393.42 49110.96,-2402.74 49205,-2400 49510.5,-2391.11 49868.88,-2369.27 50057.17,-2356.9"/>
<polygon fill="black" stroke="black" points="50057.64,-2360.38 50067.39,-2356.23 50057.18,-2353.4 50057.64,-2360.38"/>
</g>
<!-- L4_Q_proj_3 -->
<g id="node148" class="node">
<title>L4_Q_proj_3</title>
<polygon fill="none" stroke="black" points="44534,-2580.5 44398,-2580.5 44398,-2512.5 44534,-2512.5 44534,-2580.5"/>
<text text-anchor="middle" x="44466" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="44466" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="44466" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="44466" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_K_proj_3 -->
<g id="node149" class="node">
<title>L4_K_proj_3</title>
<polygon fill="none" stroke="black" points="44380,-2580.5 44244,-2580.5 44244,-2512.5 44380,-2512.5 44380,-2580.5"/>
<text text-anchor="middle" x="44312" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="44312" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="44312" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="44312" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_V_proj_3 -->
<g id="node150" class="node">
<title>L4_V_proj_3</title>
<polygon fill="none" stroke="black" points="44226,-2580.5 44090,-2580.5 44090,-2512.5 44226,-2512.5 44226,-2580.5"/>
<text text-anchor="middle" x="44158" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="44158" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="44158" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="44158" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_attention_3 -->
<g id="node151" class="node">
<title>L4_attention_3</title>
<ellipse fill="none" stroke="black" cx="43976" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="43976" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="43976" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="43976" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="43976" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_3 -->
<g id="node152" class="node">
<title>L4_out_proj_3</title>
<polygon fill="none" stroke="black" points="40728,-2580.5 40584,-2580.5 40584,-2512.5 40728,-2512.5 40728,-2580.5"/>
<text text-anchor="middle" x="40656" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="40656" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="40656" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="40656" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_3&#45;&gt;L4_concat_dim_head0 -->
<g id="edge40" class="edge">
<title>L4_out_proj_3&#45;&gt;L4_concat_dim_head0</title>
<path fill="none" stroke="black" d="M40670.16,-2512.46C40683.3,-2486.42 40705.58,-2451.94 40737,-2436 40820.9,-2393.42 47416.96,-2402.74 47511,-2400 47816.5,-2391.11 48174.88,-2369.27 48363.17,-2356.9"/>
<polygon fill="black" stroke="black" points="48363.64,-2360.38 48373.39,-2356.23 48363.18,-2353.4 48363.64,-2360.38"/>
</g>
<!-- L1_expert0_ffn1_3 -->
<g id="node153" class="node">
<title>L1_expert0_ffn1_3</title>
<polygon fill="none" stroke="black" points="43700,-2580.5 43564,-2580.5 43564,-2512.5 43700,-2512.5 43700,-2580.5"/>
<text text-anchor="middle" x="43632" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN1</text>
<text text-anchor="middle" x="43632" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="43632" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="43632" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert0_ffn2_3 -->
<g id="node154" class="node">
<title>L1_expert0_ffn2_3</title>
<polygon fill="none" stroke="black" points="45514,-2580.5 45378,-2580.5 45378,-2512.5 45514,-2512.5 45514,-2580.5"/>
<text text-anchor="middle" x="45446" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN2</text>
<text text-anchor="middle" x="45446" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="45446" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="45446" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert0_ffn2_3&#45;&gt;L1_expert_concat_head0 -->
<g id="edge41" class="edge">
<title>L1_expert0_ffn2_3&#45;&gt;L1_expert_concat_head0</title>
<path fill="none" stroke="black" d="M45459.15,-2512.25C45471.41,-2486.28 45492.42,-2451.99 45523,-2436 45600.05,-2395.71 51696.13,-2403.59 51783,-2400 51979.14,-2391.89 52206.67,-2372.23 52341.14,-2359.54"/>
<polygon fill="black" stroke="black" points="52341.83,-2362.99 52351.46,-2358.56 52341.17,-2356.02 52341.83,-2362.99"/>
</g>
<!-- L1_expert0_gate_3 -->
<g id="node155" class="node">
<title>L1_expert0_gate_3</title>
<polygon fill="none" stroke="black" points="43274,-2599.5 43156,-2546.5 43274,-2493.5 43392,-2546.5 43274,-2599.5"/>
<text text-anchor="middle" x="43274" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="43274" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="43274" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_expert1_ffn1_3 -->
<g id="node156" class="node">
<title>L1_expert1_ffn1_3</title>
<polygon fill="none" stroke="black" points="43138,-2580.5 43002,-2580.5 43002,-2512.5 43138,-2512.5 43138,-2580.5"/>
<text text-anchor="middle" x="43070" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN1</text>
<text text-anchor="middle" x="43070" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="43070" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="43070" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert1_ffn2_3 -->
<g id="node157" class="node">
<title>L1_expert1_ffn2_3</title>
<polygon fill="none" stroke="black" points="44688,-2580.5 44552,-2580.5 44552,-2512.5 44688,-2512.5 44688,-2580.5"/>
<text text-anchor="middle" x="44620" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN2</text>
<text text-anchor="middle" x="44620" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="44620" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="44620" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert1_ffn2_3&#45;&gt;L1_expert_concat_head0 -->
<g id="edge42" class="edge">
<title>L1_expert1_ffn2_3&#45;&gt;L1_expert_concat_head0</title>
<path fill="none" stroke="black" d="M44633.15,-2512.25C44645.4,-2486.27 44666.41,-2451.98 44697,-2436 44784.23,-2390.42 51684.66,-2404.03 51783,-2400 51979.15,-2391.96 52206.68,-2372.27 52341.14,-2359.56"/>
<polygon fill="black" stroke="black" points="52341.84,-2363.01 52351.46,-2358.58 52341.18,-2356.04 52341.84,-2363.01"/>
</g>
<!-- L1_expert1_gate_3 -->
<g id="node158" class="node">
<title>L1_expert1_gate_3</title>
<polygon fill="none" stroke="black" points="42712,-2599.5 42594,-2546.5 42712,-2493.5 42830,-2546.5 42712,-2599.5"/>
<text text-anchor="middle" x="42712" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="42712" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="42712" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert0_ffn1_3 -->
<g id="node159" class="node">
<title>L2_expert0_ffn1_3</title>
<polygon fill="none" stroke="black" points="42576,-2580.5 42440,-2580.5 42440,-2512.5 42576,-2512.5 42576,-2580.5"/>
<text text-anchor="middle" x="42508" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN1</text>
<text text-anchor="middle" x="42508" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="42508" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="42508" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert0_ffn2_3 -->
<g id="node160" class="node">
<title>L2_expert0_ffn2_3</title>
<polygon fill="none" stroke="black" points="43546,-2580.5 43410,-2580.5 43410,-2512.5 43546,-2512.5 43546,-2580.5"/>
<text text-anchor="middle" x="43478" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN2</text>
<text text-anchor="middle" x="43478" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="43478" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="43478" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert0_ffn2_3&#45;&gt;L2_expert_concat_head0 -->
<g id="edge43" class="edge">
<title>L2_expert0_ffn2_3&#45;&gt;L2_expert_concat_head0</title>
<path fill="none" stroke="black" d="M43491.15,-2512.25C43503.4,-2486.27 43524.41,-2451.99 43555,-2436 43638.55,-2392.33 50248.92,-2406.18 50343,-2400 50447.83,-2393.12 50566.83,-2377.16 50649.71,-2364.72"/>
<polygon fill="black" stroke="black" points="50650.27,-2368.18 50659.63,-2363.23 50649.22,-2361.26 50650.27,-2368.18"/>
</g>
<!-- L2_expert0_gate_3 -->
<g id="node161" class="node">
<title>L2_expert0_gate_3</title>
<polygon fill="none" stroke="black" points="42142,-2599.5 42024,-2546.5 42142,-2493.5 42260,-2546.5 42142,-2599.5"/>
<text text-anchor="middle" x="42142" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="42142" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="42142" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert1_ffn1_3 -->
<g id="node162" class="node">
<title>L2_expert1_ffn1_3</title>
<polygon fill="none" stroke="black" points="42006,-2580.5 41870,-2580.5 41870,-2512.5 42006,-2512.5 42006,-2580.5"/>
<text text-anchor="middle" x="41938" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN1</text>
<text text-anchor="middle" x="41938" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="41938" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="41938" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert1_ffn2_3 -->
<g id="node163" class="node">
<title>L2_expert1_ffn2_3</title>
<polygon fill="none" stroke="black" points="42984,-2580.5 42848,-2580.5 42848,-2512.5 42984,-2512.5 42984,-2580.5"/>
<text text-anchor="middle" x="42916" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN2</text>
<text text-anchor="middle" x="42916" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="42916" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="42916" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert1_ffn2_3&#45;&gt;L2_expert_concat_head0 -->
<g id="edge44" class="edge">
<title>L2_expert1_ffn2_3&#45;&gt;L2_expert_concat_head0</title>
<path fill="none" stroke="black" d="M42929.15,-2512.24C42941.4,-2486.27 42962.41,-2451.98 42993,-2436 43083.48,-2388.73 50241.13,-2406.67 50343,-2400 50447.83,-2393.14 50566.83,-2377.18 50649.71,-2364.74"/>
<polygon fill="black" stroke="black" points="50650.27,-2368.19 50659.63,-2363.24 50649.22,-2361.27 50650.27,-2368.19"/>
</g>
<!-- L2_expert1_gate_3 -->
<g id="node164" class="node">
<title>L2_expert1_gate_3</title>
<polygon fill="none" stroke="black" points="41580,-2599.5 41462,-2546.5 41580,-2493.5 41698,-2546.5 41580,-2599.5"/>
<text text-anchor="middle" x="41580" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="41580" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="41580" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert0_ffn1_3 -->
<g id="node165" class="node">
<title>L3_expert0_ffn1_3</title>
<polygon fill="none" stroke="black" points="41444,-2580.5 41308,-2580.5 41308,-2512.5 41444,-2512.5 41444,-2580.5"/>
<text text-anchor="middle" x="41376" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN1</text>
<text text-anchor="middle" x="41376" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="41376" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="41376" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert0_ffn2_3 -->
<g id="node166" class="node">
<title>L3_expert0_ffn2_3</title>
<polygon fill="none" stroke="black" points="41852,-2580.5 41716,-2580.5 41716,-2512.5 41852,-2512.5 41852,-2580.5"/>
<text text-anchor="middle" x="41784" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN2</text>
<text text-anchor="middle" x="41784" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="41784" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="41784" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert0_ffn2_3&#45;&gt;L3_expert_concat_head0 -->
<g id="edge45" class="edge">
<title>L3_expert0_ffn2_3&#45;&gt;L3_expert_concat_head0</title>
<path fill="none" stroke="black" d="M41797.15,-2512.25C41809.4,-2486.27 41830.41,-2451.99 41861,-2436 41944.55,-2392.33 48554.92,-2406.18 48649,-2400 48753.83,-2393.12 48872.83,-2377.16 48955.71,-2364.72"/>
<polygon fill="black" stroke="black" points="48956.27,-2368.18 48965.63,-2363.23 48955.22,-2361.26 48956.27,-2368.18"/>
</g>
<!-- L3_expert0_gate_3 -->
<g id="node167" class="node">
<title>L3_expert0_gate_3</title>
<polygon fill="none" stroke="black" points="41018,-2599.5 40900,-2546.5 41018,-2493.5 41136,-2546.5 41018,-2599.5"/>
<text text-anchor="middle" x="41018" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="41018" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="41018" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert1_ffn1_3 -->
<g id="node168" class="node">
<title>L3_expert1_ffn1_3</title>
<polygon fill="none" stroke="black" points="40882,-2580.5 40746,-2580.5 40746,-2512.5 40882,-2512.5 40882,-2580.5"/>
<text text-anchor="middle" x="40814" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN1</text>
<text text-anchor="middle" x="40814" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="40814" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="40814" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert1_ffn2_3 -->
<g id="node169" class="node">
<title>L3_expert1_ffn2_3</title>
<polygon fill="none" stroke="black" points="41290,-2580.5 41154,-2580.5 41154,-2512.5 41290,-2512.5 41290,-2580.5"/>
<text text-anchor="middle" x="41222" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN2</text>
<text text-anchor="middle" x="41222" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="41222" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="41222" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert1_ffn2_3&#45;&gt;L3_expert_concat_head0 -->
<g id="edge46" class="edge">
<title>L3_expert1_ffn2_3&#45;&gt;L3_expert_concat_head0</title>
<path fill="none" stroke="black" d="M41235.15,-2512.24C41247.4,-2486.27 41268.41,-2451.98 41299,-2436 41389.48,-2388.73 48547.13,-2406.67 48649,-2400 48753.83,-2393.14 48872.83,-2377.18 48955.71,-2364.74"/>
<polygon fill="black" stroke="black" points="48956.27,-2368.19 48965.63,-2363.24 48955.22,-2361.27 48956.27,-2368.19"/>
</g>
<!-- L3_expert1_gate_3 -->
<g id="node170" class="node">
<title>L3_expert1_gate_3</title>
<polygon fill="none" stroke="black" points="40448,-2599.5 40330,-2546.5 40448,-2493.5 40566,-2546.5 40448,-2599.5"/>
<text text-anchor="middle" x="40448" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="40448" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="40448" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert0_ffn1_3 -->
<g id="node171" class="node">
<title>L4_expert0_ffn1_3</title>
<polygon fill="none" stroke="black" points="40312,-2580.5 40176,-2580.5 40176,-2512.5 40312,-2512.5 40312,-2580.5"/>
<text text-anchor="middle" x="40244" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN1</text>
<text text-anchor="middle" x="40244" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="40244" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="40244" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert0_ffn2_3 -->
<g id="node172" class="node">
<title>L4_expert0_ffn2_3</title>
<polygon fill="none" stroke="black" points="40158,-2580.5 40022,-2580.5 40022,-2512.5 40158,-2512.5 40158,-2580.5"/>
<text text-anchor="middle" x="40090" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 0 FFN2</text>
<text text-anchor="middle" x="40090" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="40090" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="40090" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert0_ffn2_3&#45;&gt;L4_expert_concat_head0 -->
<g id="edge47" class="edge">
<title>L4_expert0_ffn2_3&#45;&gt;L4_expert_concat_head0</title>
<path fill="none" stroke="black" d="M40103.18,-2512.3C40115.45,-2486.36 40136.47,-2452.09 40167,-2436 40328.87,-2350.68 46221.09,-2347.82 47222.16,-2347.95"/>
<polygon fill="black" stroke="black" points="47222.28,-2351.45 47232.28,-2347.95 47222.29,-2344.45 47222.28,-2351.45"/>
</g>
<!-- L4_expert0_gate_3 -->
<g id="node173" class="node">
<title>L4_expert0_gate_3</title>
<polygon fill="none" stroke="black" points="39886,-2599.5 39768,-2546.5 39886,-2493.5 40004,-2546.5 39886,-2599.5"/>
<text text-anchor="middle" x="39886" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 0 Gate</text>
<text text-anchor="middle" x="39886" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="39886" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert1_ffn1_3 -->
<g id="node174" class="node">
<title>L4_expert1_ffn1_3</title>
<polygon fill="none" stroke="black" points="39750,-2580.5 39614,-2580.5 39614,-2512.5 39750,-2512.5 39750,-2580.5"/>
<text text-anchor="middle" x="39682" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN1</text>
<text text-anchor="middle" x="39682" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="39682" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="39682" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert1_ffn2_3 -->
<g id="node175" class="node">
<title>L4_expert1_ffn2_3</title>
<polygon fill="none" stroke="black" points="39596,-2580.5 39460,-2580.5 39460,-2512.5 39596,-2512.5 39596,-2580.5"/>
<text text-anchor="middle" x="39528" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 1 FFN2</text>
<text text-anchor="middle" x="39528" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="39528" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="39528" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert1_ffn2_3&#45;&gt;L4_expert_concat_head0 -->
<g id="edge48" class="edge">
<title>L4_expert1_ffn2_3&#45;&gt;L4_expert_concat_head0</title>
<path fill="none" stroke="black" d="M39541.18,-2512.3C39553.44,-2486.35 39574.46,-2452.08 39605,-2436 39780.15,-2343.78 46175.59,-2346.72 47221.9,-2347.82"/>
<polygon fill="black" stroke="black" points="47222.1,-2351.32 47232.1,-2347.83 47222.11,-2344.32 47222.1,-2351.32"/>
</g>
<!-- L4_expert1_gate_3 -->
<g id="node176" class="node">
<title>L4_expert1_gate_3</title>
<polygon fill="none" stroke="black" points="39324,-2599.5 39206,-2546.5 39324,-2493.5 39442,-2546.5 39324,-2599.5"/>
<text text-anchor="middle" x="39324" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 1 Gate</text>
<text text-anchor="middle" x="39324" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="39324" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_Q_proj_4 -->
<g id="node177" class="node">
<title>L1_Q_proj_4</title>
<polygon fill="none" stroke="black" points="23506,-2580.5 23370,-2580.5 23370,-2512.5 23506,-2512.5 23506,-2580.5"/>
<text text-anchor="middle" x="23438" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="23438" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="23438" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="23438" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_K_proj_4 -->
<g id="node178" class="node">
<title>L1_K_proj_4</title>
<polygon fill="none" stroke="black" points="23352,-2580.5 23216,-2580.5 23216,-2512.5 23352,-2512.5 23352,-2580.5"/>
<text text-anchor="middle" x="23284" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="23284" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="23284" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="23284" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_V_proj_4 -->
<g id="node179" class="node">
<title>L1_V_proj_4</title>
<polygon fill="none" stroke="black" points="23198,-2580.5 23062,-2580.5 23062,-2512.5 23198,-2512.5 23198,-2580.5"/>
<text text-anchor="middle" x="23130" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="23130" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="23130" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="23130" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_attention_4 -->
<g id="node180" class="node">
<title>L1_attention_4</title>
<ellipse fill="none" stroke="black" cx="22948" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="22948" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="22948" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="22948" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="22948" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_4 -->
<g id="node181" class="node">
<title>L1_out_proj_4</title>
<polygon fill="none" stroke="black" points="22834,-2580.5 22690,-2580.5 22690,-2512.5 22834,-2512.5 22834,-2580.5"/>
<text text-anchor="middle" x="22762" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="22762" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="22762" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="22762" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_concat_dim_head1 -->
<g id="node713" class="node">
<title>L1_concat_dim_head1</title>
<polygon fill="none" stroke="black" points="22762,-2400 22616,-2347 22762,-2294 22908,-2347 22762,-2400"/>
<text text-anchor="middle" x="22762" y="-2358.3" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="22762" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="22762" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_out_proj_4&#45;&gt;L1_concat_dim_head1 -->
<g id="edge49" class="edge">
<title>L1_out_proj_4&#45;&gt;L1_concat_dim_head1</title>
<path fill="none" stroke="black" d="M22762,-2512.44C22762,-2484.68 22762,-2444.23 22762,-2410.4"/>
<polygon fill="black" stroke="black" points="22765.5,-2410.14 22762,-2400.14 22758.5,-2410.14 22765.5,-2410.14"/>
</g>
<!-- L2_Q_proj_4 -->
<g id="node182" class="node">
<title>L2_Q_proj_4</title>
<polygon fill="none" stroke="black" points="22672,-2580.5 22536,-2580.5 22536,-2512.5 22672,-2512.5 22672,-2580.5"/>
<text text-anchor="middle" x="22604" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="22604" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="22604" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="22604" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_K_proj_4 -->
<g id="node183" class="node">
<title>L2_K_proj_4</title>
<polygon fill="none" stroke="black" points="22518,-2580.5 22382,-2580.5 22382,-2512.5 22518,-2512.5 22518,-2580.5"/>
<text text-anchor="middle" x="22450" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="22450" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="22450" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="22450" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_V_proj_4 -->
<g id="node184" class="node">
<title>L2_V_proj_4</title>
<polygon fill="none" stroke="black" points="22364,-2580.5 22228,-2580.5 22228,-2512.5 22364,-2512.5 22364,-2580.5"/>
<text text-anchor="middle" x="22296" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="22296" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="22296" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="22296" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_attention_4 -->
<g id="node185" class="node">
<title>L2_attention_4</title>
<ellipse fill="none" stroke="black" cx="22114" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="22114" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="22114" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="22114" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="22114" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_4 -->
<g id="node186" class="node">
<title>L2_out_proj_4</title>
<polygon fill="none" stroke="black" points="20348,-2580.5 20204,-2580.5 20204,-2512.5 20348,-2512.5 20348,-2580.5"/>
<text text-anchor="middle" x="20276" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="20276" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="20276" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="20276" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_concat_dim_head1 -->
<g id="node714" class="node">
<title>L2_concat_dim_head1</title>
<polygon fill="none" stroke="black" points="20276,-2400 20130,-2347 20276,-2294 20422,-2347 20276,-2400"/>
<text text-anchor="middle" x="20276" y="-2358.3" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="20276" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="20276" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_out_proj_4&#45;&gt;L2_concat_dim_head1 -->
<g id="edge50" class="edge">
<title>L2_out_proj_4&#45;&gt;L2_concat_dim_head1</title>
<path fill="none" stroke="black" d="M20276,-2512.44C20276,-2484.68 20276,-2444.23 20276,-2410.4"/>
<polygon fill="black" stroke="black" points="20279.5,-2410.14 20276,-2400.14 20272.5,-2410.14 20279.5,-2410.14"/>
</g>
<!-- L3_Q_proj_4 -->
<g id="node187" class="node">
<title>L3_Q_proj_4</title>
<polygon fill="none" stroke="black" points="21846,-2580.5 21710,-2580.5 21710,-2512.5 21846,-2512.5 21846,-2580.5"/>
<text text-anchor="middle" x="21778" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="21778" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="21778" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="21778" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_K_proj_4 -->
<g id="node188" class="node">
<title>L3_K_proj_4</title>
<polygon fill="none" stroke="black" points="21692,-2580.5 21556,-2580.5 21556,-2512.5 21692,-2512.5 21692,-2580.5"/>
<text text-anchor="middle" x="21624" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="21624" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="21624" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="21624" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_V_proj_4 -->
<g id="node189" class="node">
<title>L3_V_proj_4</title>
<polygon fill="none" stroke="black" points="21538,-2580.5 21402,-2580.5 21402,-2512.5 21538,-2512.5 21538,-2580.5"/>
<text text-anchor="middle" x="21470" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="21470" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="21470" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="21470" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_attention_4 -->
<g id="node190" class="node">
<title>L3_attention_4</title>
<ellipse fill="none" stroke="black" cx="21288" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="21288" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="21288" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="21288" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="21288" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_4 -->
<g id="node191" class="node">
<title>L3_out_proj_4</title>
<polygon fill="none" stroke="black" points="18908,-2580.5 18764,-2580.5 18764,-2512.5 18908,-2512.5 18908,-2580.5"/>
<text text-anchor="middle" x="18836" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="18836" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="18836" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="18836" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_concat_dim_head1 -->
<g id="node715" class="node">
<title>L3_concat_dim_head1</title>
<polygon fill="none" stroke="black" points="18836,-2400 18690,-2347 18836,-2294 18982,-2347 18836,-2400"/>
<text text-anchor="middle" x="18836" y="-2358.3" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="18836" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="18836" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_out_proj_4&#45;&gt;L3_concat_dim_head1 -->
<g id="edge51" class="edge">
<title>L3_out_proj_4&#45;&gt;L3_concat_dim_head1</title>
<path fill="none" stroke="black" d="M18836,-2512.44C18836,-2484.68 18836,-2444.23 18836,-2410.4"/>
<polygon fill="black" stroke="black" points="18839.5,-2410.14 18836,-2400.14 18832.5,-2410.14 18839.5,-2410.14"/>
</g>
<!-- L4_Q_proj_4 -->
<g id="node192" class="node">
<title>L4_Q_proj_4</title>
<polygon fill="none" stroke="black" points="21020,-2580.5 20884,-2580.5 20884,-2512.5 21020,-2512.5 21020,-2580.5"/>
<text text-anchor="middle" x="20952" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="20952" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="20952" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="20952" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_K_proj_4 -->
<g id="node193" class="node">
<title>L4_K_proj_4</title>
<polygon fill="none" stroke="black" points="20866,-2580.5 20730,-2580.5 20730,-2512.5 20866,-2512.5 20866,-2580.5"/>
<text text-anchor="middle" x="20798" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="20798" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="20798" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="20798" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_V_proj_4 -->
<g id="node194" class="node">
<title>L4_V_proj_4</title>
<polygon fill="none" stroke="black" points="20712,-2580.5 20576,-2580.5 20576,-2512.5 20712,-2512.5 20712,-2580.5"/>
<text text-anchor="middle" x="20644" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="20644" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="20644" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="20644" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_attention_4 -->
<g id="node195" class="node">
<title>L4_attention_4</title>
<ellipse fill="none" stroke="black" cx="20462" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="20462" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="20462" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="20462" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="20462" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_4 -->
<g id="node196" class="node">
<title>L4_out_proj_4</title>
<polygon fill="none" stroke="black" points="17214,-2580.5 17070,-2580.5 17070,-2512.5 17214,-2512.5 17214,-2580.5"/>
<text text-anchor="middle" x="17142" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17142" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="17142" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="17142" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_concat_dim_head1 -->
<g id="node716" class="node">
<title>L4_concat_dim_head1</title>
<polygon fill="none" stroke="black" points="17142,-2400 16996,-2347 17142,-2294 17288,-2347 17142,-2400"/>
<text text-anchor="middle" x="17142" y="-2358.3" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="17142" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="17142" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_out_proj_4&#45;&gt;L4_concat_dim_head1 -->
<g id="edge52" class="edge">
<title>L4_out_proj_4&#45;&gt;L4_concat_dim_head1</title>
<path fill="none" stroke="black" d="M17142,-2512.44C17142,-2484.68 17142,-2444.23 17142,-2410.4"/>
<polygon fill="black" stroke="black" points="17145.5,-2410.14 17142,-2400.14 17138.5,-2410.14 17145.5,-2410.14"/>
</g>
<!-- L1_expert2_ffn1_4 -->
<g id="node197" class="node">
<title>L1_expert2_ffn1_4</title>
<polygon fill="none" stroke="black" points="20186,-2580.5 20050,-2580.5 20050,-2512.5 20186,-2512.5 20186,-2580.5"/>
<text text-anchor="middle" x="20118" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN1</text>
<text text-anchor="middle" x="20118" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="20118" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="20118" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert2_ffn2_4 -->
<g id="node198" class="node">
<title>L1_expert2_ffn2_4</title>
<polygon fill="none" stroke="black" points="22000,-2580.5 21864,-2580.5 21864,-2512.5 22000,-2512.5 22000,-2580.5"/>
<text text-anchor="middle" x="21932" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN2</text>
<text text-anchor="middle" x="21932" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="21932" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="21932" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert_concat_head1 -->
<g id="node717" class="node">
<title>L1_expert_concat_head1</title>
<polygon fill="none" stroke="black" points="21106,-2400 20970,-2347 21106,-2294 21242,-2347 21106,-2400"/>
<text text-anchor="middle" x="21106" y="-2358.3" font-family="Times,serif" font-size="14.00">Expert Concat</text>
<text text-anchor="middle" x="21106" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="21106" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert2_ffn2_4&#45;&gt;L1_expert_concat_head1 -->
<g id="edge53" class="edge">
<title>L1_expert2_ffn2_4&#45;&gt;L1_expert_concat_head1</title>
<path fill="none" stroke="black" d="M21917.97,-2512.36C21905.38,-2487 21884.35,-2453.49 21855,-2436 21754.71,-2376.23 21430.64,-2357.03 21243.26,-2350.88"/>
<polygon fill="black" stroke="black" points="21243.17,-2347.38 21233.06,-2350.55 21242.95,-2354.37 21243.17,-2347.38"/>
</g>
<!-- L1_expert2_gate_4 -->
<g id="node199" class="node">
<title>L1_expert2_gate_4</title>
<polygon fill="none" stroke="black" points="19760,-2599.5 19642,-2546.5 19760,-2493.5 19878,-2546.5 19760,-2599.5"/>
<text text-anchor="middle" x="19760" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="19760" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="19760" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_expert3_ffn1_4 -->
<g id="node200" class="node">
<title>L1_expert3_ffn1_4</title>
<polygon fill="none" stroke="black" points="19624,-2580.5 19488,-2580.5 19488,-2512.5 19624,-2512.5 19624,-2580.5"/>
<text text-anchor="middle" x="19556" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN1</text>
<text text-anchor="middle" x="19556" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="19556" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="19556" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert3_ffn2_4 -->
<g id="node201" class="node">
<title>L1_expert3_ffn2_4</title>
<polygon fill="none" stroke="black" points="21174,-2580.5 21038,-2580.5 21038,-2512.5 21174,-2512.5 21174,-2580.5"/>
<text text-anchor="middle" x="21106" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN2</text>
<text text-anchor="middle" x="21106" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="21106" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="21106" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert3_ffn2_4&#45;&gt;L1_expert_concat_head1 -->
<g id="edge54" class="edge">
<title>L1_expert3_ffn2_4&#45;&gt;L1_expert_concat_head1</title>
<path fill="none" stroke="black" d="M21106,-2512.44C21106,-2484.68 21106,-2444.23 21106,-2410.4"/>
<polygon fill="black" stroke="black" points="21109.5,-2410.14 21106,-2400.14 21102.5,-2410.14 21109.5,-2410.14"/>
</g>
<!-- L1_expert3_gate_4 -->
<g id="node202" class="node">
<title>L1_expert3_gate_4</title>
<polygon fill="none" stroke="black" points="19198,-2599.5 19080,-2546.5 19198,-2493.5 19316,-2546.5 19198,-2599.5"/>
<text text-anchor="middle" x="19198" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="19198" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="19198" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert2_ffn1_4 -->
<g id="node203" class="node">
<title>L2_expert2_ffn1_4</title>
<polygon fill="none" stroke="black" points="19062,-2580.5 18926,-2580.5 18926,-2512.5 19062,-2512.5 19062,-2580.5"/>
<text text-anchor="middle" x="18994" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN1</text>
<text text-anchor="middle" x="18994" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="18994" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="18994" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert2_ffn2_4 -->
<g id="node204" class="node">
<title>L2_expert2_ffn2_4</title>
<polygon fill="none" stroke="black" points="20032,-2580.5 19896,-2580.5 19896,-2512.5 20032,-2512.5 20032,-2580.5"/>
<text text-anchor="middle" x="19964" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN2</text>
<text text-anchor="middle" x="19964" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="19964" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="19964" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert_concat_head1 -->
<g id="node718" class="node">
<title>L2_expert_concat_head1</title>
<polygon fill="none" stroke="black" points="19402,-2400 19266,-2347 19402,-2294 19538,-2347 19402,-2400"/>
<text text-anchor="middle" x="19402" y="-2358.3" font-family="Times,serif" font-size="14.00">Expert Concat</text>
<text text-anchor="middle" x="19402" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="19402" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert2_ffn2_4&#45;&gt;L2_expert_concat_head1 -->
<g id="edge55" class="edge">
<title>L2_expert2_ffn2_4&#45;&gt;L2_expert_concat_head1</title>
<path fill="none" stroke="black" d="M19949.4,-2512.34C19936.61,-2487.32 19915.59,-2454.27 19887,-2436 19827.6,-2398.04 19643.8,-2372.49 19520.31,-2359.1"/>
<polygon fill="black" stroke="black" points="19520.36,-2355.59 19510.04,-2358 19519.61,-2362.55 19520.36,-2355.59"/>
</g>
<!-- L2_expert2_gate_4 -->
<g id="node205" class="node">
<title>L2_expert2_gate_4</title>
<polygon fill="none" stroke="black" points="18628,-2599.5 18510,-2546.5 18628,-2493.5 18746,-2546.5 18628,-2599.5"/>
<text text-anchor="middle" x="18628" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="18628" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="18628" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert3_ffn1_4 -->
<g id="node206" class="node">
<title>L2_expert3_ffn1_4</title>
<polygon fill="none" stroke="black" points="18492,-2580.5 18356,-2580.5 18356,-2512.5 18492,-2512.5 18492,-2580.5"/>
<text text-anchor="middle" x="18424" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN1</text>
<text text-anchor="middle" x="18424" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="18424" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="18424" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert3_ffn2_4 -->
<g id="node207" class="node">
<title>L2_expert3_ffn2_4</title>
<polygon fill="none" stroke="black" points="19470,-2580.5 19334,-2580.5 19334,-2512.5 19470,-2512.5 19470,-2580.5"/>
<text text-anchor="middle" x="19402" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN2</text>
<text text-anchor="middle" x="19402" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="19402" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="19402" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert3_ffn2_4&#45;&gt;L2_expert_concat_head1 -->
<g id="edge56" class="edge">
<title>L2_expert3_ffn2_4&#45;&gt;L2_expert_concat_head1</title>
<path fill="none" stroke="black" d="M19402,-2512.44C19402,-2484.68 19402,-2444.23 19402,-2410.4"/>
<polygon fill="black" stroke="black" points="19405.5,-2410.14 19402,-2400.14 19398.5,-2410.14 19405.5,-2410.14"/>
</g>
<!-- L2_expert3_gate_4 -->
<g id="node208" class="node">
<title>L2_expert3_gate_4</title>
<polygon fill="none" stroke="black" points="18066,-2599.5 17948,-2546.5 18066,-2493.5 18184,-2546.5 18066,-2599.5"/>
<text text-anchor="middle" x="18066" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="18066" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="18066" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert2_ffn1_4 -->
<g id="node209" class="node">
<title>L3_expert2_ffn1_4</title>
<polygon fill="none" stroke="black" points="17930,-2580.5 17794,-2580.5 17794,-2512.5 17930,-2512.5 17930,-2580.5"/>
<text text-anchor="middle" x="17862" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN1</text>
<text text-anchor="middle" x="17862" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="17862" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="17862" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert2_ffn2_4 -->
<g id="node210" class="node">
<title>L3_expert2_ffn2_4</title>
<polygon fill="none" stroke="black" points="18338,-2580.5 18202,-2580.5 18202,-2512.5 18338,-2512.5 18338,-2580.5"/>
<text text-anchor="middle" x="18270" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN2</text>
<text text-anchor="middle" x="18270" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="18270" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="18270" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert_concat_head1 -->
<g id="node719" class="node">
<title>L3_expert_concat_head1</title>
<polygon fill="none" stroke="black" points="17708,-2400 17572,-2347 17708,-2294 17844,-2347 17708,-2400"/>
<text text-anchor="middle" x="17708" y="-2358.3" font-family="Times,serif" font-size="14.00">Expert Concat</text>
<text text-anchor="middle" x="17708" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="17708" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert2_ffn2_4&#45;&gt;L3_expert_concat_head1 -->
<g id="edge57" class="edge">
<title>L3_expert2_ffn2_4&#45;&gt;L3_expert_concat_head1</title>
<path fill="none" stroke="black" d="M18255.4,-2512.34C18242.61,-2487.32 18221.59,-2454.27 18193,-2436 18133.6,-2398.04 17949.8,-2372.49 17826.31,-2359.1"/>
<polygon fill="black" stroke="black" points="17826.36,-2355.59 17816.04,-2358 17825.61,-2362.55 17826.36,-2355.59"/>
</g>
<!-- L3_expert2_gate_4 -->
<g id="node211" class="node">
<title>L3_expert2_gate_4</title>
<polygon fill="none" stroke="black" points="17504,-2599.5 17386,-2546.5 17504,-2493.5 17622,-2546.5 17504,-2599.5"/>
<text text-anchor="middle" x="17504" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="17504" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="17504" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert3_ffn1_4 -->
<g id="node212" class="node">
<title>L3_expert3_ffn1_4</title>
<polygon fill="none" stroke="black" points="17368,-2580.5 17232,-2580.5 17232,-2512.5 17368,-2512.5 17368,-2580.5"/>
<text text-anchor="middle" x="17300" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN1</text>
<text text-anchor="middle" x="17300" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="17300" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="17300" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert3_ffn2_4 -->
<g id="node213" class="node">
<title>L3_expert3_ffn2_4</title>
<polygon fill="none" stroke="black" points="17776,-2580.5 17640,-2580.5 17640,-2512.5 17776,-2512.5 17776,-2580.5"/>
<text text-anchor="middle" x="17708" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN2</text>
<text text-anchor="middle" x="17708" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="17708" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="17708" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert3_ffn2_4&#45;&gt;L3_expert_concat_head1 -->
<g id="edge58" class="edge">
<title>L3_expert3_ffn2_4&#45;&gt;L3_expert_concat_head1</title>
<path fill="none" stroke="black" d="M17708,-2512.44C17708,-2484.68 17708,-2444.23 17708,-2410.4"/>
<polygon fill="black" stroke="black" points="17711.5,-2410.14 17708,-2400.14 17704.5,-2410.14 17711.5,-2410.14"/>
</g>
<!-- L3_expert3_gate_4 -->
<g id="node214" class="node">
<title>L3_expert3_gate_4</title>
<polygon fill="none" stroke="black" points="16934,-2599.5 16816,-2546.5 16934,-2493.5 17052,-2546.5 16934,-2599.5"/>
<text text-anchor="middle" x="16934" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="16934" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="16934" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert2_ffn1_4 -->
<g id="node215" class="node">
<title>L4_expert2_ffn1_4</title>
<polygon fill="none" stroke="black" points="16798,-2580.5 16662,-2580.5 16662,-2512.5 16798,-2512.5 16798,-2580.5"/>
<text text-anchor="middle" x="16730" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN1</text>
<text text-anchor="middle" x="16730" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="16730" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="16730" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert2_ffn2_4 -->
<g id="node216" class="node">
<title>L4_expert2_ffn2_4</title>
<polygon fill="none" stroke="black" points="16644,-2580.5 16508,-2580.5 16508,-2512.5 16644,-2512.5 16644,-2580.5"/>
<text text-anchor="middle" x="16576" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN2</text>
<text text-anchor="middle" x="16576" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="16576" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="16576" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert_concat_head1 -->
<g id="node720" class="node">
<title>L4_expert_concat_head1</title>
<polygon fill="none" stroke="black" points="16014,-2400 15878,-2347 16014,-2294 16150,-2347 16014,-2400"/>
<text text-anchor="middle" x="16014" y="-2358.3" font-family="Times,serif" font-size="14.00">Expert Concat</text>
<text text-anchor="middle" x="16014" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="16014" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert2_ffn2_4&#45;&gt;L4_expert_concat_head1 -->
<g id="edge59" class="edge">
<title>L4_expert2_ffn2_4&#45;&gt;L4_expert_concat_head1</title>
<path fill="none" stroke="black" d="M16561.4,-2512.34C16548.61,-2487.32 16527.59,-2454.27 16499,-2436 16439.6,-2398.04 16255.8,-2372.49 16132.31,-2359.1"/>
<polygon fill="black" stroke="black" points="16132.36,-2355.59 16122.04,-2358 16131.61,-2362.55 16132.36,-2355.59"/>
</g>
<!-- L4_expert2_gate_4 -->
<g id="node217" class="node">
<title>L4_expert2_gate_4</title>
<polygon fill="none" stroke="black" points="16372,-2599.5 16254,-2546.5 16372,-2493.5 16490,-2546.5 16372,-2599.5"/>
<text text-anchor="middle" x="16372" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="16372" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="16372" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert3_ffn1_4 -->
<g id="node218" class="node">
<title>L4_expert3_ffn1_4</title>
<polygon fill="none" stroke="black" points="16236,-2580.5 16100,-2580.5 16100,-2512.5 16236,-2512.5 16236,-2580.5"/>
<text text-anchor="middle" x="16168" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN1</text>
<text text-anchor="middle" x="16168" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="16168" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="16168" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert3_ffn2_4 -->
<g id="node219" class="node">
<title>L4_expert3_ffn2_4</title>
<polygon fill="none" stroke="black" points="16082,-2580.5 15946,-2580.5 15946,-2512.5 16082,-2512.5 16082,-2580.5"/>
<text text-anchor="middle" x="16014" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN2</text>
<text text-anchor="middle" x="16014" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="16014" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="16014" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert3_ffn2_4&#45;&gt;L4_expert_concat_head1 -->
<g id="edge60" class="edge">
<title>L4_expert3_ffn2_4&#45;&gt;L4_expert_concat_head1</title>
<path fill="none" stroke="black" d="M16014,-2512.44C16014,-2484.68 16014,-2444.23 16014,-2410.4"/>
<polygon fill="black" stroke="black" points="16017.5,-2410.14 16014,-2400.14 16010.5,-2410.14 16017.5,-2410.14"/>
</g>
<!-- L4_expert3_gate_4 -->
<g id="node220" class="node">
<title>L4_expert3_gate_4</title>
<polygon fill="none" stroke="black" points="15810,-2599.5 15692,-2546.5 15810,-2493.5 15928,-2546.5 15810,-2599.5"/>
<text text-anchor="middle" x="15810" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="15810" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="15810" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_Q_proj_5 -->
<g id="node221" class="node">
<title>L1_Q_proj_5</title>
<polygon fill="none" stroke="black" points="31344,-2580.5 31208,-2580.5 31208,-2512.5 31344,-2512.5 31344,-2580.5"/>
<text text-anchor="middle" x="31276" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="31276" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="31276" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="31276" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_K_proj_5 -->
<g id="node222" class="node">
<title>L1_K_proj_5</title>
<polygon fill="none" stroke="black" points="31190,-2580.5 31054,-2580.5 31054,-2512.5 31190,-2512.5 31190,-2580.5"/>
<text text-anchor="middle" x="31122" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="31122" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="31122" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="31122" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_V_proj_5 -->
<g id="node223" class="node">
<title>L1_V_proj_5</title>
<polygon fill="none" stroke="black" points="31036,-2580.5 30900,-2580.5 30900,-2512.5 31036,-2512.5 31036,-2580.5"/>
<text text-anchor="middle" x="30968" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="30968" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="30968" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="30968" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_attention_5 -->
<g id="node224" class="node">
<title>L1_attention_5</title>
<ellipse fill="none" stroke="black" cx="30786" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="30786" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="30786" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="30786" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="30786" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_5 -->
<g id="node225" class="node">
<title>L1_out_proj_5</title>
<polygon fill="none" stroke="black" points="30672,-2580.5 30528,-2580.5 30528,-2512.5 30672,-2512.5 30672,-2580.5"/>
<text text-anchor="middle" x="30600" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="30600" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="30600" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="30600" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_5&#45;&gt;L1_concat_dim_head1 -->
<g id="edge61" class="edge">
<title>L1_out_proj_5&#45;&gt;L1_concat_dim_head1</title>
<path fill="none" stroke="black" d="M30585.69,-2512.25C30572.51,-2486.27 30550.27,-2451.99 30519,-2436 30343.39,-2346.21 23990.66,-2347.07 22915.75,-2347.85"/>
<polygon fill="black" stroke="black" points="22915.64,-2344.35 22905.64,-2347.86 22915.64,-2351.35 22915.64,-2344.35"/>
</g>
<!-- L2_Q_proj_5 -->
<g id="node226" class="node">
<title>L2_Q_proj_5</title>
<polygon fill="none" stroke="black" points="30510,-2580.5 30374,-2580.5 30374,-2512.5 30510,-2512.5 30510,-2580.5"/>
<text text-anchor="middle" x="30442" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="30442" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="30442" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="30442" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_K_proj_5 -->
<g id="node227" class="node">
<title>L2_K_proj_5</title>
<polygon fill="none" stroke="black" points="30356,-2580.5 30220,-2580.5 30220,-2512.5 30356,-2512.5 30356,-2580.5"/>
<text text-anchor="middle" x="30288" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="30288" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="30288" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="30288" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_V_proj_5 -->
<g id="node228" class="node">
<title>L2_V_proj_5</title>
<polygon fill="none" stroke="black" points="30202,-2580.5 30066,-2580.5 30066,-2512.5 30202,-2512.5 30202,-2580.5"/>
<text text-anchor="middle" x="30134" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="30134" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="30134" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="30134" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_attention_5 -->
<g id="node229" class="node">
<title>L2_attention_5</title>
<ellipse fill="none" stroke="black" cx="29952" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="29952" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="29952" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="29952" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="29952" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_5 -->
<g id="node230" class="node">
<title>L2_out_proj_5</title>
<polygon fill="none" stroke="black" points="28186,-2580.5 28042,-2580.5 28042,-2512.5 28186,-2512.5 28186,-2580.5"/>
<text text-anchor="middle" x="28114" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="28114" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="28114" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="28114" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_5&#45;&gt;L2_concat_dim_head1 -->
<g id="edge62" class="edge">
<title>L2_out_proj_5&#45;&gt;L2_concat_dim_head1</title>
<path fill="none" stroke="black" d="M28099.84,-2512.46C28086.71,-2486.42 28064.42,-2451.94 28033,-2436 27945.4,-2391.56 21059.14,-2403.97 20961,-2400 20764.09,-2392.03 20535.98,-2372.69 20399,-2359.97"/>
<polygon fill="black" stroke="black" points="20399.17,-2356.47 20388.89,-2359.03 20398.52,-2363.44 20399.17,-2356.47"/>
</g>
<!-- L3_Q_proj_5 -->
<g id="node231" class="node">
<title>L3_Q_proj_5</title>
<polygon fill="none" stroke="black" points="29684,-2580.5 29548,-2580.5 29548,-2512.5 29684,-2512.5 29684,-2580.5"/>
<text text-anchor="middle" x="29616" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="29616" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="29616" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="29616" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_K_proj_5 -->
<g id="node232" class="node">
<title>L3_K_proj_5</title>
<polygon fill="none" stroke="black" points="29530,-2580.5 29394,-2580.5 29394,-2512.5 29530,-2512.5 29530,-2580.5"/>
<text text-anchor="middle" x="29462" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="29462" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="29462" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="29462" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_V_proj_5 -->
<g id="node233" class="node">
<title>L3_V_proj_5</title>
<polygon fill="none" stroke="black" points="29376,-2580.5 29240,-2580.5 29240,-2512.5 29376,-2512.5 29376,-2580.5"/>
<text text-anchor="middle" x="29308" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="29308" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="29308" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="29308" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_attention_5 -->
<g id="node234" class="node">
<title>L3_attention_5</title>
<ellipse fill="none" stroke="black" cx="29126" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="29126" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="29126" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="29126" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="29126" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_5 -->
<g id="node235" class="node">
<title>L3_out_proj_5</title>
<polygon fill="none" stroke="black" points="26746,-2580.5 26602,-2580.5 26602,-2512.5 26746,-2512.5 26746,-2580.5"/>
<text text-anchor="middle" x="26674" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="26674" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="26674" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="26674" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_5&#45;&gt;L3_concat_dim_head1 -->
<g id="edge63" class="edge">
<title>L3_out_proj_5&#45;&gt;L3_concat_dim_head1</title>
<path fill="none" stroke="black" d="M26659.85,-2512.46C26646.71,-2486.42 26624.42,-2451.94 26593,-2436 26502.13,-2389.91 19358.68,-2406.51 19257,-2400 19150.96,-2393.21 19030.71,-2377.56 18945.96,-2365.19"/>
<polygon fill="black" stroke="black" points="18946.46,-2361.72 18936.06,-2363.73 18945.45,-2368.65 18946.46,-2361.72"/>
</g>
<!-- L4_Q_proj_5 -->
<g id="node236" class="node">
<title>L4_Q_proj_5</title>
<polygon fill="none" stroke="black" points="28858,-2580.5 28722,-2580.5 28722,-2512.5 28858,-2512.5 28858,-2580.5"/>
<text text-anchor="middle" x="28790" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="28790" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="28790" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="28790" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_K_proj_5 -->
<g id="node237" class="node">
<title>L4_K_proj_5</title>
<polygon fill="none" stroke="black" points="28704,-2580.5 28568,-2580.5 28568,-2512.5 28704,-2512.5 28704,-2580.5"/>
<text text-anchor="middle" x="28636" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="28636" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="28636" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="28636" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_V_proj_5 -->
<g id="node238" class="node">
<title>L4_V_proj_5</title>
<polygon fill="none" stroke="black" points="28550,-2580.5 28414,-2580.5 28414,-2512.5 28550,-2512.5 28550,-2580.5"/>
<text text-anchor="middle" x="28482" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="28482" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="28482" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="28482" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_attention_5 -->
<g id="node239" class="node">
<title>L4_attention_5</title>
<ellipse fill="none" stroke="black" cx="28300" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="28300" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="28300" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="28300" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="28300" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_5 -->
<g id="node240" class="node">
<title>L4_out_proj_5</title>
<polygon fill="none" stroke="black" points="25052,-2580.5 24908,-2580.5 24908,-2512.5 25052,-2512.5 25052,-2580.5"/>
<text text-anchor="middle" x="24980" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="24980" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="24980" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="24980" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_5&#45;&gt;L4_concat_dim_head1 -->
<g id="edge64" class="edge">
<title>L4_out_proj_5&#45;&gt;L4_concat_dim_head1</title>
<path fill="none" stroke="black" d="M24965.85,-2512.46C24952.71,-2486.42 24930.42,-2451.94 24899,-2436 24808.13,-2389.91 17664.68,-2406.51 17563,-2400 17456.96,-2393.21 17336.71,-2377.56 17251.96,-2365.19"/>
<polygon fill="black" stroke="black" points="17252.46,-2361.72 17242.06,-2363.73 17251.45,-2368.65 17252.46,-2361.72"/>
</g>
<!-- L1_expert2_ffn1_5 -->
<g id="node241" class="node">
<title>L1_expert2_ffn1_5</title>
<polygon fill="none" stroke="black" points="28024,-2580.5 27888,-2580.5 27888,-2512.5 28024,-2512.5 28024,-2580.5"/>
<text text-anchor="middle" x="27956" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN1</text>
<text text-anchor="middle" x="27956" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="27956" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="27956" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert2_ffn2_5 -->
<g id="node242" class="node">
<title>L1_expert2_ffn2_5</title>
<polygon fill="none" stroke="black" points="29838,-2580.5 29702,-2580.5 29702,-2512.5 29838,-2512.5 29838,-2580.5"/>
<text text-anchor="middle" x="29770" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN2</text>
<text text-anchor="middle" x="29770" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="29770" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="29770" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert2_ffn2_5&#45;&gt;L1_expert_concat_head1 -->
<g id="edge65" class="edge">
<title>L1_expert2_ffn2_5&#45;&gt;L1_expert_concat_head1</title>
<path fill="none" stroke="black" d="M29756.85,-2512.25C29744.6,-2486.27 29723.59,-2451.98 29693,-2436 29605.77,-2390.42 22705.4,-2401.95 22607,-2400 22099.88,-2389.93 21496.77,-2365.14 21236.36,-2353.81"/>
<polygon fill="black" stroke="black" points="21236.25,-2350.31 21226.11,-2353.37 21235.95,-2357.3 21236.25,-2350.31"/>
</g>
<!-- L1_expert2_gate_5 -->
<g id="node243" class="node">
<title>L1_expert2_gate_5</title>
<polygon fill="none" stroke="black" points="27598,-2599.5 27480,-2546.5 27598,-2493.5 27716,-2546.5 27598,-2599.5"/>
<text text-anchor="middle" x="27598" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="27598" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="27598" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_expert3_ffn1_5 -->
<g id="node244" class="node">
<title>L1_expert3_ffn1_5</title>
<polygon fill="none" stroke="black" points="27462,-2580.5 27326,-2580.5 27326,-2512.5 27462,-2512.5 27462,-2580.5"/>
<text text-anchor="middle" x="27394" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN1</text>
<text text-anchor="middle" x="27394" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="27394" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="27394" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert3_ffn2_5 -->
<g id="node245" class="node">
<title>L1_expert3_ffn2_5</title>
<polygon fill="none" stroke="black" points="29012,-2580.5 28876,-2580.5 28876,-2512.5 29012,-2512.5 29012,-2580.5"/>
<text text-anchor="middle" x="28944" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN2</text>
<text text-anchor="middle" x="28944" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="28944" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="28944" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert3_ffn2_5&#45;&gt;L1_expert_concat_head1 -->
<g id="edge66" class="edge">
<title>L1_expert3_ffn2_5&#45;&gt;L1_expert_concat_head1</title>
<path fill="none" stroke="black" d="M28930.85,-2512.25C28918.59,-2486.28 28897.58,-2451.99 28867,-2436 28789.95,-2395.71 22693.93,-2401.76 22607,-2400 22099.88,-2389.76 21496.77,-2365.06 21236.36,-2353.78"/>
<polygon fill="black" stroke="black" points="21236.25,-2350.28 21226.11,-2353.34 21235.95,-2357.27 21236.25,-2350.28"/>
</g>
<!-- L1_expert3_gate_5 -->
<g id="node246" class="node">
<title>L1_expert3_gate_5</title>
<polygon fill="none" stroke="black" points="27036,-2599.5 26918,-2546.5 27036,-2493.5 27154,-2546.5 27036,-2599.5"/>
<text text-anchor="middle" x="27036" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="27036" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="27036" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert2_ffn1_5 -->
<g id="node247" class="node">
<title>L2_expert2_ffn1_5</title>
<polygon fill="none" stroke="black" points="26900,-2580.5 26764,-2580.5 26764,-2512.5 26900,-2512.5 26900,-2580.5"/>
<text text-anchor="middle" x="26832" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN1</text>
<text text-anchor="middle" x="26832" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="26832" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="26832" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert2_ffn2_5 -->
<g id="node248" class="node">
<title>L2_expert2_ffn2_5</title>
<polygon fill="none" stroke="black" points="27870,-2580.5 27734,-2580.5 27734,-2512.5 27870,-2512.5 27870,-2580.5"/>
<text text-anchor="middle" x="27802" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN2</text>
<text text-anchor="middle" x="27802" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="27802" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="27802" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert2_ffn2_5&#45;&gt;L2_expert_concat_head1 -->
<g id="edge67" class="edge">
<title>L2_expert2_ffn2_5&#45;&gt;L2_expert_concat_head1</title>
<path fill="none" stroke="black" d="M27788.85,-2512.24C27776.6,-2486.26 27755.59,-2451.98 27725,-2436 27631.39,-2387.11 20226.53,-2404.06 20121,-2400 19908.8,-2391.83 19662.03,-2371.65 19519.74,-2358.96"/>
<polygon fill="black" stroke="black" points="19519.95,-2355.47 19509.68,-2358.06 19519.33,-2362.44 19519.95,-2355.47"/>
</g>
<!-- L2_expert2_gate_5 -->
<g id="node249" class="node">
<title>L2_expert2_gate_5</title>
<polygon fill="none" stroke="black" points="26466,-2599.5 26348,-2546.5 26466,-2493.5 26584,-2546.5 26466,-2599.5"/>
<text text-anchor="middle" x="26466" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="26466" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="26466" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert3_ffn1_5 -->
<g id="node250" class="node">
<title>L2_expert3_ffn1_5</title>
<polygon fill="none" stroke="black" points="26330,-2580.5 26194,-2580.5 26194,-2512.5 26330,-2512.5 26330,-2580.5"/>
<text text-anchor="middle" x="26262" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN1</text>
<text text-anchor="middle" x="26262" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="26262" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="26262" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert3_ffn2_5 -->
<g id="node251" class="node">
<title>L2_expert3_ffn2_5</title>
<polygon fill="none" stroke="black" points="27308,-2580.5 27172,-2580.5 27172,-2512.5 27308,-2512.5 27308,-2580.5"/>
<text text-anchor="middle" x="27240" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN2</text>
<text text-anchor="middle" x="27240" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="27240" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="27240" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert3_ffn2_5&#45;&gt;L2_expert_concat_head1 -->
<g id="edge68" class="edge">
<title>L2_expert3_ffn2_5&#45;&gt;L2_expert_concat_head1</title>
<path fill="none" stroke="black" d="M27226.85,-2512.25C27214.6,-2486.27 27193.59,-2451.98 27163,-2436 27076.31,-2390.7 20218.73,-2403.78 20121,-2400 19908.8,-2391.79 19662.03,-2371.62 19519.74,-2358.95"/>
<polygon fill="black" stroke="black" points="19519.95,-2355.46 19509.68,-2358.05 19519.33,-2362.43 19519.95,-2355.46"/>
</g>
<!-- L2_expert3_gate_5 -->
<g id="node252" class="node">
<title>L2_expert3_gate_5</title>
<polygon fill="none" stroke="black" points="25904,-2599.5 25786,-2546.5 25904,-2493.5 26022,-2546.5 25904,-2599.5"/>
<text text-anchor="middle" x="25904" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="25904" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="25904" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert2_ffn1_5 -->
<g id="node253" class="node">
<title>L3_expert2_ffn1_5</title>
<polygon fill="none" stroke="black" points="25768,-2580.5 25632,-2580.5 25632,-2512.5 25768,-2512.5 25768,-2580.5"/>
<text text-anchor="middle" x="25700" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN1</text>
<text text-anchor="middle" x="25700" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="25700" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="25700" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert2_ffn2_5 -->
<g id="node254" class="node">
<title>L3_expert2_ffn2_5</title>
<polygon fill="none" stroke="black" points="26176,-2580.5 26040,-2580.5 26040,-2512.5 26176,-2512.5 26176,-2580.5"/>
<text text-anchor="middle" x="26108" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN2</text>
<text text-anchor="middle" x="26108" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="26108" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="26108" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert2_ffn2_5&#45;&gt;L3_expert_concat_head1 -->
<g id="edge69" class="edge">
<title>L3_expert2_ffn2_5&#45;&gt;L3_expert_concat_head1</title>
<path fill="none" stroke="black" d="M26094.85,-2512.24C26082.6,-2486.27 26061.59,-2451.98 26031,-2436 25940.52,-2388.73 18783.04,-2402.97 18681,-2400 18375.28,-2391.09 18016.07,-2368.83 17831.42,-2356.52"/>
<polygon fill="black" stroke="black" points="17831.61,-2353.02 17821.4,-2355.85 17831.15,-2360.01 17831.61,-2353.02"/>
</g>
<!-- L3_expert2_gate_5 -->
<g id="node255" class="node">
<title>L3_expert2_gate_5</title>
<polygon fill="none" stroke="black" points="25342,-2599.5 25224,-2546.5 25342,-2493.5 25460,-2546.5 25342,-2599.5"/>
<text text-anchor="middle" x="25342" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="25342" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="25342" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert3_ffn1_5 -->
<g id="node256" class="node">
<title>L3_expert3_ffn1_5</title>
<polygon fill="none" stroke="black" points="25206,-2580.5 25070,-2580.5 25070,-2512.5 25206,-2512.5 25206,-2580.5"/>
<text text-anchor="middle" x="25138" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN1</text>
<text text-anchor="middle" x="25138" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="25138" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="25138" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert3_ffn2_5 -->
<g id="node257" class="node">
<title>L3_expert3_ffn2_5</title>
<polygon fill="none" stroke="black" points="25614,-2580.5 25478,-2580.5 25478,-2512.5 25614,-2512.5 25614,-2580.5"/>
<text text-anchor="middle" x="25546" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN2</text>
<text text-anchor="middle" x="25546" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="25546" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="25546" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert3_ffn2_5&#45;&gt;L3_expert_concat_head1 -->
<g id="edge70" class="edge">
<title>L3_expert3_ffn2_5&#45;&gt;L3_expert_concat_head1</title>
<path fill="none" stroke="black" d="M25532.85,-2512.25C25520.6,-2486.27 25499.59,-2451.99 25469,-2436 25385.45,-2392.33 18775.24,-2402.77 18681,-2400 18375.28,-2391.03 18016.07,-2368.79 17831.42,-2356.5"/>
<polygon fill="black" stroke="black" points="17831.61,-2353.01 17821.4,-2355.83 17831.15,-2359.99 17831.61,-2353.01"/>
</g>
<!-- L3_expert3_gate_5 -->
<g id="node258" class="node">
<title>L3_expert3_gate_5</title>
<polygon fill="none" stroke="black" points="24772,-2599.5 24654,-2546.5 24772,-2493.5 24890,-2546.5 24772,-2599.5"/>
<text text-anchor="middle" x="24772" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="24772" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="24772" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert2_ffn1_5 -->
<g id="node259" class="node">
<title>L4_expert2_ffn1_5</title>
<polygon fill="none" stroke="black" points="24636,-2580.5 24500,-2580.5 24500,-2512.5 24636,-2512.5 24636,-2580.5"/>
<text text-anchor="middle" x="24568" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN1</text>
<text text-anchor="middle" x="24568" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="24568" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="24568" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert2_ffn2_5 -->
<g id="node260" class="node">
<title>L4_expert2_ffn2_5</title>
<polygon fill="none" stroke="black" points="24482,-2580.5 24346,-2580.5 24346,-2512.5 24482,-2512.5 24482,-2580.5"/>
<text text-anchor="middle" x="24414" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN2</text>
<text text-anchor="middle" x="24414" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="24414" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="24414" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert2_ffn2_5&#45;&gt;L4_expert_concat_head1 -->
<g id="edge71" class="edge">
<title>L4_expert2_ffn2_5&#45;&gt;L4_expert_concat_head1</title>
<path fill="none" stroke="black" d="M24400.85,-2512.24C24388.6,-2486.27 24367.59,-2451.98 24337,-2436 24246.52,-2388.73 17089.04,-2402.97 16987,-2400 16681.28,-2391.09 16322.07,-2368.83 16137.42,-2356.52"/>
<polygon fill="black" stroke="black" points="16137.61,-2353.02 16127.4,-2355.85 16137.15,-2360.01 16137.61,-2353.02"/>
</g>
<!-- L4_expert2_gate_5 -->
<g id="node261" class="node">
<title>L4_expert2_gate_5</title>
<polygon fill="none" stroke="black" points="24210,-2599.5 24092,-2546.5 24210,-2493.5 24328,-2546.5 24210,-2599.5"/>
<text text-anchor="middle" x="24210" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="24210" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="24210" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert3_ffn1_5 -->
<g id="node262" class="node">
<title>L4_expert3_ffn1_5</title>
<polygon fill="none" stroke="black" points="24074,-2580.5 23938,-2580.5 23938,-2512.5 24074,-2512.5 24074,-2580.5"/>
<text text-anchor="middle" x="24006" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN1</text>
<text text-anchor="middle" x="24006" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="24006" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="24006" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert3_ffn2_5 -->
<g id="node263" class="node">
<title>L4_expert3_ffn2_5</title>
<polygon fill="none" stroke="black" points="23920,-2580.5 23784,-2580.5 23784,-2512.5 23920,-2512.5 23920,-2580.5"/>
<text text-anchor="middle" x="23852" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN2</text>
<text text-anchor="middle" x="23852" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="23852" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="23852" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert3_ffn2_5&#45;&gt;L4_expert_concat_head1 -->
<g id="edge72" class="edge">
<title>L4_expert3_ffn2_5&#45;&gt;L4_expert_concat_head1</title>
<path fill="none" stroke="black" d="M23838.85,-2512.25C23826.6,-2486.27 23805.59,-2451.99 23775,-2436 23691.45,-2392.33 17081.24,-2402.77 16987,-2400 16681.28,-2391.03 16322.07,-2368.79 16137.42,-2356.5"/>
<polygon fill="black" stroke="black" points="16137.61,-2353.01 16127.4,-2355.83 16137.15,-2359.99 16137.61,-2353.01"/>
</g>
<!-- L4_expert3_gate_5 -->
<g id="node264" class="node">
<title>L4_expert3_gate_5</title>
<polygon fill="none" stroke="black" points="23648,-2599.5 23530,-2546.5 23648,-2493.5 23766,-2546.5 23648,-2599.5"/>
<text text-anchor="middle" x="23648" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="23648" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="23648" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_Q_proj_6 -->
<g id="node265" class="node">
<title>L1_Q_proj_6</title>
<polygon fill="none" stroke="black" points="7830,-2580.5 7694,-2580.5 7694,-2512.5 7830,-2512.5 7830,-2580.5"/>
<text text-anchor="middle" x="7762" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7762" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="7762" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="7762" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_K_proj_6 -->
<g id="node266" class="node">
<title>L1_K_proj_6</title>
<polygon fill="none" stroke="black" points="7676,-2580.5 7540,-2580.5 7540,-2512.5 7676,-2512.5 7676,-2580.5"/>
<text text-anchor="middle" x="7608" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7608" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="7608" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="7608" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_V_proj_6 -->
<g id="node267" class="node">
<title>L1_V_proj_6</title>
<polygon fill="none" stroke="black" points="7522,-2580.5 7386,-2580.5 7386,-2512.5 7522,-2512.5 7522,-2580.5"/>
<text text-anchor="middle" x="7454" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7454" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="7454" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="7454" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_attention_6 -->
<g id="node268" class="node">
<title>L1_attention_6</title>
<ellipse fill="none" stroke="black" cx="7272" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="7272" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7272" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="7272" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="7272" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_6 -->
<g id="node269" class="node">
<title>L1_out_proj_6</title>
<polygon fill="none" stroke="black" points="7158,-2580.5 7014,-2580.5 7014,-2512.5 7158,-2512.5 7158,-2580.5"/>
<text text-anchor="middle" x="7086" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7086" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="7086" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="7086" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_6&#45;&gt;L1_concat_dim_head1 -->
<g id="edge73" class="edge">
<title>L1_out_proj_6&#45;&gt;L1_concat_dim_head1</title>
<path fill="none" stroke="black" d="M7100.14,-2512.44C7113.28,-2486.39 7135.56,-2451.9 7167,-2436 7254.28,-2391.86 21153.21,-2401.81 21251,-2400 21757.23,-2390.64 22358.45,-2365.86 22624.1,-2354.22"/>
<polygon fill="black" stroke="black" points="22624.34,-2357.71 22634.18,-2353.77 22624.04,-2350.72 22624.34,-2357.71"/>
</g>
<!-- L2_Q_proj_6 -->
<g id="node270" class="node">
<title>L2_Q_proj_6</title>
<polygon fill="none" stroke="black" points="6996,-2580.5 6860,-2580.5 6860,-2512.5 6996,-2512.5 6996,-2580.5"/>
<text text-anchor="middle" x="6928" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6928" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="6928" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="6928" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_K_proj_6 -->
<g id="node271" class="node">
<title>L2_K_proj_6</title>
<polygon fill="none" stroke="black" points="6842,-2580.5 6706,-2580.5 6706,-2512.5 6842,-2512.5 6842,-2580.5"/>
<text text-anchor="middle" x="6774" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6774" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="6774" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="6774" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_V_proj_6 -->
<g id="node272" class="node">
<title>L2_V_proj_6</title>
<polygon fill="none" stroke="black" points="6688,-2580.5 6552,-2580.5 6552,-2512.5 6688,-2512.5 6688,-2580.5"/>
<text text-anchor="middle" x="6620" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6620" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="6620" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="6620" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_attention_6 -->
<g id="node273" class="node">
<title>L2_attention_6</title>
<ellipse fill="none" stroke="black" cx="6438" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="6438" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6438" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="6438" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="6438" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_6 -->
<g id="node274" class="node">
<title>L2_out_proj_6</title>
<polygon fill="none" stroke="black" points="4672,-2580.5 4528,-2580.5 4528,-2512.5 4672,-2512.5 4672,-2580.5"/>
<text text-anchor="middle" x="4600" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4600" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="4600" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="4600" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_6&#45;&gt;L2_concat_dim_head1 -->
<g id="edge74" class="edge">
<title>L2_out_proj_6&#45;&gt;L2_concat_dim_head1</title>
<path fill="none" stroke="black" d="M4614.14,-2512.44C4627.28,-2486.38 4649.56,-2451.9 4681,-2436 4773.13,-2389.41 19443.83,-2403.8 19547,-2400 19759.67,-2392.17 20006.59,-2372.28 20151.6,-2359.49"/>
<polygon fill="black" stroke="black" points="20152.21,-2362.95 20161.86,-2358.58 20151.59,-2355.98 20152.21,-2362.95"/>
</g>
<!-- L3_Q_proj_6 -->
<g id="node275" class="node">
<title>L3_Q_proj_6</title>
<polygon fill="none" stroke="black" points="6170,-2580.5 6034,-2580.5 6034,-2512.5 6170,-2512.5 6170,-2580.5"/>
<text text-anchor="middle" x="6102" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6102" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="6102" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="6102" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_K_proj_6 -->
<g id="node276" class="node">
<title>L3_K_proj_6</title>
<polygon fill="none" stroke="black" points="6016,-2580.5 5880,-2580.5 5880,-2512.5 6016,-2512.5 6016,-2580.5"/>
<text text-anchor="middle" x="5948" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5948" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="5948" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="5948" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_V_proj_6 -->
<g id="node277" class="node">
<title>L3_V_proj_6</title>
<polygon fill="none" stroke="black" points="5862,-2580.5 5726,-2580.5 5726,-2512.5 5862,-2512.5 5862,-2580.5"/>
<text text-anchor="middle" x="5794" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5794" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="5794" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="5794" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_attention_6 -->
<g id="node278" class="node">
<title>L3_attention_6</title>
<ellipse fill="none" stroke="black" cx="5612" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="5612" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5612" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="5612" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="5612" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_6 -->
<g id="node279" class="node">
<title>L3_out_proj_6</title>
<polygon fill="none" stroke="black" points="3232,-2580.5 3088,-2580.5 3088,-2512.5 3232,-2512.5 3232,-2580.5"/>
<text text-anchor="middle" x="3160" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3160" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="3160" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="3160" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_6&#45;&gt;L3_concat_dim_head1 -->
<g id="edge75" class="edge">
<title>L3_out_proj_6&#45;&gt;L3_concat_dim_head1</title>
<path fill="none" stroke="black" d="M3174.14,-2512.44C3187.28,-2486.39 3209.56,-2451.9 3241,-2436 3331.55,-2390.21 17751.57,-2402.81 17853,-2400 18158.51,-2391.55 18516.89,-2369.53 18705.18,-2357.02"/>
<polygon fill="black" stroke="black" points="18705.65,-2360.5 18715.39,-2356.34 18705.18,-2353.51 18705.65,-2360.5"/>
</g>
<!-- L4_Q_proj_6 -->
<g id="node280" class="node">
<title>L4_Q_proj_6</title>
<polygon fill="none" stroke="black" points="5344,-2580.5 5208,-2580.5 5208,-2512.5 5344,-2512.5 5344,-2580.5"/>
<text text-anchor="middle" x="5276" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5276" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="5276" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="5276" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_K_proj_6 -->
<g id="node281" class="node">
<title>L4_K_proj_6</title>
<polygon fill="none" stroke="black" points="5190,-2580.5 5054,-2580.5 5054,-2512.5 5190,-2512.5 5190,-2580.5"/>
<text text-anchor="middle" x="5122" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5122" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="5122" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="5122" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_V_proj_6 -->
<g id="node282" class="node">
<title>L4_V_proj_6</title>
<polygon fill="none" stroke="black" points="5036,-2580.5 4900,-2580.5 4900,-2512.5 5036,-2512.5 5036,-2580.5"/>
<text text-anchor="middle" x="4968" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4968" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="4968" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="4968" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_attention_6 -->
<g id="node283" class="node">
<title>L4_attention_6</title>
<ellipse fill="none" stroke="black" cx="4786" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="4786" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4786" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="4786" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="4786" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_6 -->
<g id="node284" class="node">
<title>L4_out_proj_6</title>
<polygon fill="none" stroke="black" points="1538,-2580.5 1394,-2580.5 1394,-2512.5 1538,-2512.5 1538,-2580.5"/>
<text text-anchor="middle" x="1466" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1466" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="1466" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="1466" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_6&#45;&gt;L4_concat_dim_head1 -->
<g id="edge76" class="edge">
<title>L4_out_proj_6&#45;&gt;L4_concat_dim_head1</title>
<path fill="none" stroke="black" d="M1480.14,-2512.44C1493.28,-2486.39 1515.56,-2451.9 1547,-2436 1637.55,-2390.21 16057.57,-2402.81 16159,-2400 16464.51,-2391.55 16822.89,-2369.53 17011.18,-2357.02"/>
<polygon fill="black" stroke="black" points="17011.65,-2360.5 17021.39,-2356.34 17011.18,-2353.51 17011.65,-2360.5"/>
</g>
<!-- L1_expert2_ffn1_6 -->
<g id="node285" class="node">
<title>L1_expert2_ffn1_6</title>
<polygon fill="none" stroke="black" points="4510,-2580.5 4374,-2580.5 4374,-2512.5 4510,-2512.5 4510,-2580.5"/>
<text text-anchor="middle" x="4442" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN1</text>
<text text-anchor="middle" x="4442" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="4442" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="4442" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert2_ffn2_6 -->
<g id="node286" class="node">
<title>L1_expert2_ffn2_6</title>
<polygon fill="none" stroke="black" points="6324,-2580.5 6188,-2580.5 6188,-2512.5 6324,-2512.5 6324,-2580.5"/>
<text text-anchor="middle" x="6256" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN2</text>
<text text-anchor="middle" x="6256" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="6256" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="6256" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert2_ffn2_6&#45;&gt;L1_expert_concat_head1 -->
<g id="edge77" class="edge">
<title>L1_expert2_ffn2_6&#45;&gt;L1_expert_concat_head1</title>
<path fill="none" stroke="black" d="M6269.02,-2512.49C6281.24,-2486.47 6302.29,-2452 6333,-2436 6419.83,-2390.77 20333.17,-2403.89 20431,-2400 20627.3,-2392.2 20855.01,-2372.42 20989.44,-2359.63"/>
<polygon fill="black" stroke="black" points="20990.13,-2363.08 20999.76,-2358.64 20989.47,-2356.11 20990.13,-2363.08"/>
</g>
<!-- L1_expert2_gate_6 -->
<g id="node287" class="node">
<title>L1_expert2_gate_6</title>
<polygon fill="none" stroke="black" points="4084,-2599.5 3966,-2546.5 4084,-2493.5 4202,-2546.5 4084,-2599.5"/>
<text text-anchor="middle" x="4084" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="4084" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="4084" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_expert3_ffn1_6 -->
<g id="node288" class="node">
<title>L1_expert3_ffn1_6</title>
<polygon fill="none" stroke="black" points="3948,-2580.5 3812,-2580.5 3812,-2512.5 3948,-2512.5 3948,-2580.5"/>
<text text-anchor="middle" x="3880" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN1</text>
<text text-anchor="middle" x="3880" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="3880" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="3880" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert3_ffn2_6 -->
<g id="node289" class="node">
<title>L1_expert3_ffn2_6</title>
<polygon fill="none" stroke="black" points="5498,-2580.5 5362,-2580.5 5362,-2512.5 5498,-2512.5 5498,-2580.5"/>
<text text-anchor="middle" x="5430" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN2</text>
<text text-anchor="middle" x="5430" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="5430" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="5430" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert3_ffn2_6&#45;&gt;L1_expert_concat_head1 -->
<g id="edge78" class="edge">
<title>L1_expert3_ffn2_6&#45;&gt;L1_expert_concat_head1</title>
<path fill="none" stroke="black" d="M5443.01,-2512.49C5455.24,-2486.47 5476.29,-2452 5507,-2436 5598.92,-2388.13 20327.44,-2404.11 20431,-2400 20627.3,-2392.21 20855.02,-2372.43 20989.44,-2359.63"/>
<polygon fill="black" stroke="black" points="20990.13,-2363.08 20999.76,-2358.64 20989.47,-2356.11 20990.13,-2363.08"/>
</g>
<!-- L1_expert3_gate_6 -->
<g id="node290" class="node">
<title>L1_expert3_gate_6</title>
<polygon fill="none" stroke="black" points="3522,-2599.5 3404,-2546.5 3522,-2493.5 3640,-2546.5 3522,-2599.5"/>
<text text-anchor="middle" x="3522" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="3522" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="3522" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert2_ffn1_6 -->
<g id="node291" class="node">
<title>L2_expert2_ffn1_6</title>
<polygon fill="none" stroke="black" points="3386,-2580.5 3250,-2580.5 3250,-2512.5 3386,-2512.5 3386,-2580.5"/>
<text text-anchor="middle" x="3318" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN1</text>
<text text-anchor="middle" x="3318" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="3318" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="3318" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert2_ffn2_6 -->
<g id="node292" class="node">
<title>L2_expert2_ffn2_6</title>
<polygon fill="none" stroke="black" points="4356,-2580.5 4220,-2580.5 4220,-2512.5 4356,-2512.5 4356,-2580.5"/>
<text text-anchor="middle" x="4288" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN2</text>
<text text-anchor="middle" x="4288" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="4288" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="4288" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert2_ffn2_6&#45;&gt;L2_expert_concat_head1 -->
<g id="edge79" class="edge">
<title>L2_expert2_ffn2_6&#45;&gt;L2_expert_concat_head1</title>
<path fill="none" stroke="black" d="M4301.01,-2512.49C4313.24,-2486.47 4334.29,-2452 4365,-2436 4455.08,-2389.08 18889.64,-2406.51 18991,-2400 19095.84,-2393.26 19214.84,-2377.29 19297.71,-2364.81"/>
<polygon fill="black" stroke="black" points="19298.27,-2368.26 19307.64,-2363.3 19297.22,-2361.34 19298.27,-2368.26"/>
</g>
<!-- L2_expert2_gate_6 -->
<g id="node293" class="node">
<title>L2_expert2_gate_6</title>
<polygon fill="none" stroke="black" points="2952,-2599.5 2834,-2546.5 2952,-2493.5 3070,-2546.5 2952,-2599.5"/>
<text text-anchor="middle" x="2952" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="2952" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="2952" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert3_ffn1_6 -->
<g id="node294" class="node">
<title>L2_expert3_ffn1_6</title>
<polygon fill="none" stroke="black" points="2816,-2580.5 2680,-2580.5 2680,-2512.5 2816,-2512.5 2816,-2580.5"/>
<text text-anchor="middle" x="2748" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN1</text>
<text text-anchor="middle" x="2748" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="2748" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="2748" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert3_ffn2_6 -->
<g id="node295" class="node">
<title>L2_expert3_ffn2_6</title>
<polygon fill="none" stroke="black" points="3794,-2580.5 3658,-2580.5 3658,-2512.5 3794,-2512.5 3794,-2580.5"/>
<text text-anchor="middle" x="3726" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN2</text>
<text text-anchor="middle" x="3726" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="3726" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="3726" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert3_ffn2_6&#45;&gt;L2_expert_concat_head1 -->
<g id="edge80" class="edge">
<title>L2_expert3_ffn2_6&#45;&gt;L2_expert_concat_head1</title>
<path fill="none" stroke="black" d="M3739.01,-2512.49C3751.24,-2486.47 3772.29,-2451.99 3803,-2436 3896.55,-2387.28 18885.74,-2406.76 18991,-2400 19095.84,-2393.27 19214.84,-2377.29 19297.71,-2364.81"/>
<polygon fill="black" stroke="black" points="19298.27,-2368.26 19307.64,-2363.31 19297.22,-2361.34 19298.27,-2368.26"/>
</g>
<!-- L2_expert3_gate_6 -->
<g id="node296" class="node">
<title>L2_expert3_gate_6</title>
<polygon fill="none" stroke="black" points="2390,-2599.5 2272,-2546.5 2390,-2493.5 2508,-2546.5 2390,-2599.5"/>
<text text-anchor="middle" x="2390" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="2390" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="2390" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert2_ffn1_6 -->
<g id="node297" class="node">
<title>L3_expert2_ffn1_6</title>
<polygon fill="none" stroke="black" points="2254,-2580.5 2118,-2580.5 2118,-2512.5 2254,-2512.5 2254,-2580.5"/>
<text text-anchor="middle" x="2186" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN1</text>
<text text-anchor="middle" x="2186" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="2186" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="2186" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert2_ffn2_6 -->
<g id="node298" class="node">
<title>L3_expert2_ffn2_6</title>
<polygon fill="none" stroke="black" points="2662,-2580.5 2526,-2580.5 2526,-2512.5 2662,-2512.5 2662,-2580.5"/>
<text text-anchor="middle" x="2594" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN2</text>
<text text-anchor="middle" x="2594" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="2594" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="2594" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert2_ffn2_6&#45;&gt;L3_expert_concat_head1 -->
<g id="edge81" class="edge">
<title>L3_expert2_ffn2_6&#45;&gt;L3_expert_concat_head1</title>
<path fill="none" stroke="black" d="M2607.01,-2512.49C2619.24,-2486.47 2640.29,-2452 2671,-2436 2761.08,-2389.08 17195.64,-2406.51 17297,-2400 17401.84,-2393.26 17520.84,-2377.29 17603.71,-2364.81"/>
<polygon fill="black" stroke="black" points="17604.27,-2368.26 17613.64,-2363.3 17603.22,-2361.34 17604.27,-2368.26"/>
</g>
<!-- L3_expert2_gate_6 -->
<g id="node299" class="node">
<title>L3_expert2_gate_6</title>
<polygon fill="none" stroke="black" points="1828,-2599.5 1710,-2546.5 1828,-2493.5 1946,-2546.5 1828,-2599.5"/>
<text text-anchor="middle" x="1828" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="1828" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="1828" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert3_ffn1_6 -->
<g id="node300" class="node">
<title>L3_expert3_ffn1_6</title>
<polygon fill="none" stroke="black" points="1692,-2580.5 1556,-2580.5 1556,-2512.5 1692,-2512.5 1692,-2580.5"/>
<text text-anchor="middle" x="1624" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN1</text>
<text text-anchor="middle" x="1624" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="1624" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="1624" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert3_ffn2_6 -->
<g id="node301" class="node">
<title>L3_expert3_ffn2_6</title>
<polygon fill="none" stroke="black" points="2100,-2580.5 1964,-2580.5 1964,-2512.5 2100,-2512.5 2100,-2580.5"/>
<text text-anchor="middle" x="2032" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN2</text>
<text text-anchor="middle" x="2032" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="2032" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="2032" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert3_ffn2_6&#45;&gt;L3_expert_concat_head1 -->
<g id="edge82" class="edge">
<title>L3_expert3_ffn2_6&#45;&gt;L3_expert_concat_head1</title>
<path fill="none" stroke="black" d="M2045.01,-2512.49C2057.24,-2486.47 2078.29,-2451.99 2109,-2436 2202.55,-2387.28 17191.74,-2406.76 17297,-2400 17401.84,-2393.27 17520.84,-2377.29 17603.71,-2364.81"/>
<polygon fill="black" stroke="black" points="17604.27,-2368.26 17613.64,-2363.31 17603.22,-2361.34 17604.27,-2368.26"/>
</g>
<!-- L3_expert3_gate_6 -->
<g id="node302" class="node">
<title>L3_expert3_gate_6</title>
<polygon fill="none" stroke="black" points="1258,-2599.5 1140,-2546.5 1258,-2493.5 1376,-2546.5 1258,-2599.5"/>
<text text-anchor="middle" x="1258" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="1258" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="1258" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert2_ffn1_6 -->
<g id="node303" class="node">
<title>L4_expert2_ffn1_6</title>
<polygon fill="none" stroke="black" points="1122,-2580.5 986,-2580.5 986,-2512.5 1122,-2512.5 1122,-2580.5"/>
<text text-anchor="middle" x="1054" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN1</text>
<text text-anchor="middle" x="1054" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="1054" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="1054" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert2_ffn2_6 -->
<g id="node304" class="node">
<title>L4_expert2_ffn2_6</title>
<polygon fill="none" stroke="black" points="968,-2580.5 832,-2580.5 832,-2512.5 968,-2512.5 968,-2580.5"/>
<text text-anchor="middle" x="900" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN2</text>
<text text-anchor="middle" x="900" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="900" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="900" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert2_ffn2_6&#45;&gt;L4_expert_concat_head1 -->
<g id="edge83" class="edge">
<title>L4_expert2_ffn2_6&#45;&gt;L4_expert_concat_head1</title>
<path fill="none" stroke="black" d="M913.15,-2512.25C925.41,-2486.28 946.42,-2451.99 977,-2436 1151.34,-2344.82 14341.09,-2347.34 15869.97,-2347.93"/>
<polygon fill="black" stroke="black" points="15870.17,-2351.43 15880.18,-2347.94 15870.18,-2344.43 15870.17,-2351.43"/>
</g>
<!-- L4_expert2_gate_6 -->
<g id="node305" class="node">
<title>L4_expert2_gate_6</title>
<polygon fill="none" stroke="black" points="696,-2599.5 578,-2546.5 696,-2493.5 814,-2546.5 696,-2599.5"/>
<text text-anchor="middle" x="696" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="696" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="696" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert3_ffn1_6 -->
<g id="node306" class="node">
<title>L4_expert3_ffn1_6</title>
<polygon fill="none" stroke="black" points="560,-2580.5 424,-2580.5 424,-2512.5 560,-2512.5 560,-2580.5"/>
<text text-anchor="middle" x="492" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN1</text>
<text text-anchor="middle" x="492" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="492" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="492" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert3_ffn2_6 -->
<g id="node307" class="node">
<title>L4_expert3_ffn2_6</title>
<polygon fill="none" stroke="black" points="406,-2580.5 270,-2580.5 270,-2512.5 406,-2512.5 406,-2580.5"/>
<text text-anchor="middle" x="338" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN2</text>
<text text-anchor="middle" x="338" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="338" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="338" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert3_ffn2_6&#45;&gt;L4_expert_concat_head1 -->
<g id="edge84" class="edge">
<title>L4_expert3_ffn2_6&#45;&gt;L4_expert_concat_head1</title>
<path fill="none" stroke="black" d="M351.15,-2512.25C363.41,-2486.28 384.42,-2451.99 415,-2436 596.07,-2341.32 14310.34,-2346.96 15870.06,-2347.9"/>
<polygon fill="black" stroke="black" points="15870.19,-2351.4 15880.19,-2347.91 15870.19,-2344.4 15870.19,-2351.4"/>
</g>
<!-- L4_expert3_gate_6 -->
<g id="node308" class="node">
<title>L4_expert3_gate_6</title>
<polygon fill="none" stroke="black" points="134,-2599.5 16,-2546.5 134,-2493.5 252,-2546.5 134,-2599.5"/>
<text text-anchor="middle" x="134" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="134" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="134" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_Q_proj_7 -->
<g id="node309" class="node">
<title>L1_Q_proj_7</title>
<polygon fill="none" stroke="black" points="15668,-2580.5 15532,-2580.5 15532,-2512.5 15668,-2512.5 15668,-2580.5"/>
<text text-anchor="middle" x="15600" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="15600" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="15600" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="15600" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_K_proj_7 -->
<g id="node310" class="node">
<title>L1_K_proj_7</title>
<polygon fill="none" stroke="black" points="15514,-2580.5 15378,-2580.5 15378,-2512.5 15514,-2512.5 15514,-2580.5"/>
<text text-anchor="middle" x="15446" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="15446" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="15446" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="15446" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_V_proj_7 -->
<g id="node311" class="node">
<title>L1_V_proj_7</title>
<polygon fill="none" stroke="black" points="15360,-2580.5 15224,-2580.5 15224,-2512.5 15360,-2512.5 15360,-2580.5"/>
<text text-anchor="middle" x="15292" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="15292" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="15292" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="15292" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_attention_7 -->
<g id="node312" class="node">
<title>L1_attention_7</title>
<ellipse fill="none" stroke="black" cx="15110" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="15110" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="15110" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="15110" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="15110" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_7 -->
<g id="node313" class="node">
<title>L1_out_proj_7</title>
<polygon fill="none" stroke="black" points="14996,-2580.5 14852,-2580.5 14852,-2512.5 14996,-2512.5 14996,-2580.5"/>
<text text-anchor="middle" x="14924" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14924" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="14924" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="14924" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_7&#45;&gt;L1_concat_dim_head1 -->
<g id="edge85" class="edge">
<title>L1_out_proj_7&#45;&gt;L1_concat_dim_head1</title>
<path fill="none" stroke="black" d="M14938.16,-2512.46C14951.3,-2486.43 14973.58,-2451.95 15005,-2436 15082.35,-2396.72 21164.27,-2401.74 21251,-2400 21757.21,-2389.83 22358.44,-2365.46 22624.1,-2354.07"/>
<polygon fill="black" stroke="black" points="22624.34,-2357.56 22634.18,-2353.63 22624.04,-2350.57 22624.34,-2357.56"/>
</g>
<!-- L2_Q_proj_7 -->
<g id="node314" class="node">
<title>L2_Q_proj_7</title>
<polygon fill="none" stroke="black" points="14834,-2580.5 14698,-2580.5 14698,-2512.5 14834,-2512.5 14834,-2580.5"/>
<text text-anchor="middle" x="14766" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="14766" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="14766" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="14766" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_K_proj_7 -->
<g id="node315" class="node">
<title>L2_K_proj_7</title>
<polygon fill="none" stroke="black" points="14680,-2580.5 14544,-2580.5 14544,-2512.5 14680,-2512.5 14680,-2580.5"/>
<text text-anchor="middle" x="14612" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="14612" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="14612" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="14612" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_V_proj_7 -->
<g id="node316" class="node">
<title>L2_V_proj_7</title>
<polygon fill="none" stroke="black" points="14526,-2580.5 14390,-2580.5 14390,-2512.5 14526,-2512.5 14526,-2580.5"/>
<text text-anchor="middle" x="14458" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="14458" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="14458" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="14458" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_attention_7 -->
<g id="node317" class="node">
<title>L2_attention_7</title>
<ellipse fill="none" stroke="black" cx="14276" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="14276" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="14276" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="14276" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="14276" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_7 -->
<g id="node318" class="node">
<title>L2_out_proj_7</title>
<polygon fill="none" stroke="black" points="12510,-2580.5 12366,-2580.5 12366,-2512.5 12510,-2512.5 12510,-2580.5"/>
<text text-anchor="middle" x="12438" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12438" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="12438" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="12438" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_7&#45;&gt;L2_concat_dim_head1 -->
<g id="edge86" class="edge">
<title>L2_out_proj_7&#45;&gt;L2_concat_dim_head1</title>
<path fill="none" stroke="black" d="M12452.16,-2512.46C12465.29,-2486.42 12487.58,-2451.94 12519,-2436 12606.05,-2391.84 19449.46,-2403.72 19547,-2400 19759.51,-2391.89 20006.23,-2372.11 20151.28,-2359.42"/>
<polygon fill="black" stroke="black" points="20151.89,-2362.88 20161.54,-2358.51 20151.28,-2355.9 20151.89,-2362.88"/>
</g>
<!-- L3_Q_proj_7 -->
<g id="node319" class="node">
<title>L3_Q_proj_7</title>
<polygon fill="none" stroke="black" points="14008,-2580.5 13872,-2580.5 13872,-2512.5 14008,-2512.5 14008,-2580.5"/>
<text text-anchor="middle" x="13940" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="13940" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="13940" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="13940" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_K_proj_7 -->
<g id="node320" class="node">
<title>L3_K_proj_7</title>
<polygon fill="none" stroke="black" points="13854,-2580.5 13718,-2580.5 13718,-2512.5 13854,-2512.5 13854,-2580.5"/>
<text text-anchor="middle" x="13786" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="13786" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="13786" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="13786" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_V_proj_7 -->
<g id="node321" class="node">
<title>L3_V_proj_7</title>
<polygon fill="none" stroke="black" points="13700,-2580.5 13564,-2580.5 13564,-2512.5 13700,-2512.5 13700,-2580.5"/>
<text text-anchor="middle" x="13632" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="13632" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="13632" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="13632" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_attention_7 -->
<g id="node322" class="node">
<title>L3_attention_7</title>
<ellipse fill="none" stroke="black" cx="13450" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="13450" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="13450" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="13450" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="13450" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_7 -->
<g id="node323" class="node">
<title>L3_out_proj_7</title>
<polygon fill="none" stroke="black" points="11070,-2580.5 10926,-2580.5 10926,-2512.5 11070,-2512.5 11070,-2580.5"/>
<text text-anchor="middle" x="10998" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10998" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="10998" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="10998" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_7&#45;&gt;L3_concat_dim_head1 -->
<g id="edge87" class="edge">
<title>L3_out_proj_7&#45;&gt;L3_concat_dim_head1</title>
<path fill="none" stroke="black" d="M11012.16,-2512.46C11025.3,-2486.42 11047.58,-2451.94 11079,-2436 11162.9,-2393.42 17758.96,-2402.74 17853,-2400 18158.5,-2391.11 18516.88,-2369.27 18705.17,-2356.9"/>
<polygon fill="black" stroke="black" points="18705.64,-2360.38 18715.39,-2356.23 18705.18,-2353.4 18705.64,-2360.38"/>
</g>
<!-- L4_Q_proj_7 -->
<g id="node324" class="node">
<title>L4_Q_proj_7</title>
<polygon fill="none" stroke="black" points="13182,-2580.5 13046,-2580.5 13046,-2512.5 13182,-2512.5 13182,-2580.5"/>
<text text-anchor="middle" x="13114" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="13114" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="13114" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="13114" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_K_proj_7 -->
<g id="node325" class="node">
<title>L4_K_proj_7</title>
<polygon fill="none" stroke="black" points="13028,-2580.5 12892,-2580.5 12892,-2512.5 13028,-2512.5 13028,-2580.5"/>
<text text-anchor="middle" x="12960" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="12960" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="12960" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="12960" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_V_proj_7 -->
<g id="node326" class="node">
<title>L4_V_proj_7</title>
<polygon fill="none" stroke="black" points="12874,-2580.5 12738,-2580.5 12738,-2512.5 12874,-2512.5 12874,-2580.5"/>
<text text-anchor="middle" x="12806" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="12806" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="12806" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="12806" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_attention_7 -->
<g id="node327" class="node">
<title>L4_attention_7</title>
<ellipse fill="none" stroke="black" cx="12624" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="12624" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="12624" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="12624" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="12624" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_7 -->
<g id="node328" class="node">
<title>L4_out_proj_7</title>
<polygon fill="none" stroke="black" points="9376,-2580.5 9232,-2580.5 9232,-2512.5 9376,-2512.5 9376,-2580.5"/>
<text text-anchor="middle" x="9304" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9304" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="9304" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="9304" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_7&#45;&gt;L4_concat_dim_head1 -->
<g id="edge88" class="edge">
<title>L4_out_proj_7&#45;&gt;L4_concat_dim_head1</title>
<path fill="none" stroke="black" d="M9318.16,-2512.46C9331.3,-2486.42 9353.58,-2451.94 9385,-2436 9468.9,-2393.42 16064.96,-2402.74 16159,-2400 16464.5,-2391.11 16822.88,-2369.27 17011.17,-2356.9"/>
<polygon fill="black" stroke="black" points="17011.64,-2360.38 17021.39,-2356.23 17011.18,-2353.4 17011.64,-2360.38"/>
</g>
<!-- L1_expert2_ffn1_7 -->
<g id="node329" class="node">
<title>L1_expert2_ffn1_7</title>
<polygon fill="none" stroke="black" points="12348,-2580.5 12212,-2580.5 12212,-2512.5 12348,-2512.5 12348,-2580.5"/>
<text text-anchor="middle" x="12280" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN1</text>
<text text-anchor="middle" x="12280" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="12280" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="12280" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert2_ffn2_7 -->
<g id="node330" class="node">
<title>L1_expert2_ffn2_7</title>
<polygon fill="none" stroke="black" points="14162,-2580.5 14026,-2580.5 14026,-2512.5 14162,-2512.5 14162,-2580.5"/>
<text text-anchor="middle" x="14094" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN2</text>
<text text-anchor="middle" x="14094" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="14094" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="14094" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert2_ffn2_7&#45;&gt;L1_expert_concat_head1 -->
<g id="edge89" class="edge">
<title>L1_expert2_ffn2_7&#45;&gt;L1_expert_concat_head1</title>
<path fill="none" stroke="black" d="M14107.15,-2512.25C14119.41,-2486.28 14140.42,-2451.99 14171,-2436 14248.05,-2395.71 20344.13,-2403.59 20431,-2400 20627.14,-2391.89 20854.67,-2372.23 20989.14,-2359.54"/>
<polygon fill="black" stroke="black" points="20989.83,-2362.99 20999.46,-2358.56 20989.17,-2356.02 20989.83,-2362.99"/>
</g>
<!-- L1_expert2_gate_7 -->
<g id="node331" class="node">
<title>L1_expert2_gate_7</title>
<polygon fill="none" stroke="black" points="11922,-2599.5 11804,-2546.5 11922,-2493.5 12040,-2546.5 11922,-2599.5"/>
<text text-anchor="middle" x="11922" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="11922" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="11922" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_expert3_ffn1_7 -->
<g id="node332" class="node">
<title>L1_expert3_ffn1_7</title>
<polygon fill="none" stroke="black" points="11786,-2580.5 11650,-2580.5 11650,-2512.5 11786,-2512.5 11786,-2580.5"/>
<text text-anchor="middle" x="11718" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN1</text>
<text text-anchor="middle" x="11718" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="11718" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="11718" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert3_ffn2_7 -->
<g id="node333" class="node">
<title>L1_expert3_ffn2_7</title>
<polygon fill="none" stroke="black" points="13336,-2580.5 13200,-2580.5 13200,-2512.5 13336,-2512.5 13336,-2580.5"/>
<text text-anchor="middle" x="13268" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN2</text>
<text text-anchor="middle" x="13268" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="13268" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="13268" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert3_ffn2_7&#45;&gt;L1_expert_concat_head1 -->
<g id="edge90" class="edge">
<title>L1_expert3_ffn2_7&#45;&gt;L1_expert_concat_head1</title>
<path fill="none" stroke="black" d="M13281.15,-2512.25C13293.4,-2486.27 13314.41,-2451.98 13345,-2436 13432.23,-2390.42 20332.66,-2404.03 20431,-2400 20627.15,-2391.96 20854.68,-2372.27 20989.14,-2359.56"/>
<polygon fill="black" stroke="black" points="20989.84,-2363.01 20999.46,-2358.58 20989.18,-2356.04 20989.84,-2363.01"/>
</g>
<!-- L1_expert3_gate_7 -->
<g id="node334" class="node">
<title>L1_expert3_gate_7</title>
<polygon fill="none" stroke="black" points="11360,-2599.5 11242,-2546.5 11360,-2493.5 11478,-2546.5 11360,-2599.5"/>
<text text-anchor="middle" x="11360" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="11360" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="11360" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert2_ffn1_7 -->
<g id="node335" class="node">
<title>L2_expert2_ffn1_7</title>
<polygon fill="none" stroke="black" points="11224,-2580.5 11088,-2580.5 11088,-2512.5 11224,-2512.5 11224,-2580.5"/>
<text text-anchor="middle" x="11156" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN1</text>
<text text-anchor="middle" x="11156" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="11156" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="11156" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert2_ffn2_7 -->
<g id="node336" class="node">
<title>L2_expert2_ffn2_7</title>
<polygon fill="none" stroke="black" points="12194,-2580.5 12058,-2580.5 12058,-2512.5 12194,-2512.5 12194,-2580.5"/>
<text text-anchor="middle" x="12126" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN2</text>
<text text-anchor="middle" x="12126" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="12126" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="12126" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert2_ffn2_7&#45;&gt;L2_expert_concat_head1 -->
<g id="edge91" class="edge">
<title>L2_expert2_ffn2_7&#45;&gt;L2_expert_concat_head1</title>
<path fill="none" stroke="black" d="M12139.15,-2512.25C12151.4,-2486.27 12172.41,-2451.99 12203,-2436 12286.55,-2392.33 18896.92,-2406.18 18991,-2400 19095.83,-2393.12 19214.83,-2377.16 19297.71,-2364.72"/>
<polygon fill="black" stroke="black" points="19298.27,-2368.18 19307.63,-2363.23 19297.22,-2361.26 19298.27,-2368.18"/>
</g>
<!-- L2_expert2_gate_7 -->
<g id="node337" class="node">
<title>L2_expert2_gate_7</title>
<polygon fill="none" stroke="black" points="10790,-2599.5 10672,-2546.5 10790,-2493.5 10908,-2546.5 10790,-2599.5"/>
<text text-anchor="middle" x="10790" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="10790" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="10790" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert3_ffn1_7 -->
<g id="node338" class="node">
<title>L2_expert3_ffn1_7</title>
<polygon fill="none" stroke="black" points="10654,-2580.5 10518,-2580.5 10518,-2512.5 10654,-2512.5 10654,-2580.5"/>
<text text-anchor="middle" x="10586" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN1</text>
<text text-anchor="middle" x="10586" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="10586" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="10586" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert3_ffn2_7 -->
<g id="node339" class="node">
<title>L2_expert3_ffn2_7</title>
<polygon fill="none" stroke="black" points="11632,-2580.5 11496,-2580.5 11496,-2512.5 11632,-2512.5 11632,-2580.5"/>
<text text-anchor="middle" x="11564" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN2</text>
<text text-anchor="middle" x="11564" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="11564" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="11564" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert3_ffn2_7&#45;&gt;L2_expert_concat_head1 -->
<g id="edge92" class="edge">
<title>L2_expert3_ffn2_7&#45;&gt;L2_expert_concat_head1</title>
<path fill="none" stroke="black" d="M11577.15,-2512.24C11589.4,-2486.27 11610.41,-2451.98 11641,-2436 11731.48,-2388.73 18889.13,-2406.67 18991,-2400 19095.83,-2393.14 19214.83,-2377.18 19297.71,-2364.74"/>
<polygon fill="black" stroke="black" points="19298.27,-2368.19 19307.63,-2363.24 19297.22,-2361.27 19298.27,-2368.19"/>
</g>
<!-- L2_expert3_gate_7 -->
<g id="node340" class="node">
<title>L2_expert3_gate_7</title>
<polygon fill="none" stroke="black" points="10228,-2599.5 10110,-2546.5 10228,-2493.5 10346,-2546.5 10228,-2599.5"/>
<text text-anchor="middle" x="10228" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="10228" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="10228" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert2_ffn1_7 -->
<g id="node341" class="node">
<title>L3_expert2_ffn1_7</title>
<polygon fill="none" stroke="black" points="10092,-2580.5 9956,-2580.5 9956,-2512.5 10092,-2512.5 10092,-2580.5"/>
<text text-anchor="middle" x="10024" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN1</text>
<text text-anchor="middle" x="10024" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="10024" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="10024" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert2_ffn2_7 -->
<g id="node342" class="node">
<title>L3_expert2_ffn2_7</title>
<polygon fill="none" stroke="black" points="10500,-2580.5 10364,-2580.5 10364,-2512.5 10500,-2512.5 10500,-2580.5"/>
<text text-anchor="middle" x="10432" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN2</text>
<text text-anchor="middle" x="10432" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="10432" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="10432" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert2_ffn2_7&#45;&gt;L3_expert_concat_head1 -->
<g id="edge93" class="edge">
<title>L3_expert2_ffn2_7&#45;&gt;L3_expert_concat_head1</title>
<path fill="none" stroke="black" d="M10445.15,-2512.25C10457.4,-2486.27 10478.41,-2451.99 10509,-2436 10592.55,-2392.33 17202.92,-2406.18 17297,-2400 17401.83,-2393.12 17520.83,-2377.16 17603.71,-2364.72"/>
<polygon fill="black" stroke="black" points="17604.27,-2368.18 17613.63,-2363.23 17603.22,-2361.26 17604.27,-2368.18"/>
</g>
<!-- L3_expert2_gate_7 -->
<g id="node343" class="node">
<title>L3_expert2_gate_7</title>
<polygon fill="none" stroke="black" points="9666,-2599.5 9548,-2546.5 9666,-2493.5 9784,-2546.5 9666,-2599.5"/>
<text text-anchor="middle" x="9666" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="9666" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="9666" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert3_ffn1_7 -->
<g id="node344" class="node">
<title>L3_expert3_ffn1_7</title>
<polygon fill="none" stroke="black" points="9530,-2580.5 9394,-2580.5 9394,-2512.5 9530,-2512.5 9530,-2580.5"/>
<text text-anchor="middle" x="9462" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN1</text>
<text text-anchor="middle" x="9462" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="9462" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="9462" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert3_ffn2_7 -->
<g id="node345" class="node">
<title>L3_expert3_ffn2_7</title>
<polygon fill="none" stroke="black" points="9938,-2580.5 9802,-2580.5 9802,-2512.5 9938,-2512.5 9938,-2580.5"/>
<text text-anchor="middle" x="9870" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN2</text>
<text text-anchor="middle" x="9870" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="9870" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="9870" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert3_ffn2_7&#45;&gt;L3_expert_concat_head1 -->
<g id="edge94" class="edge">
<title>L3_expert3_ffn2_7&#45;&gt;L3_expert_concat_head1</title>
<path fill="none" stroke="black" d="M9883.15,-2512.24C9895.4,-2486.27 9916.41,-2451.98 9947,-2436 10037.48,-2388.73 17195.13,-2406.67 17297,-2400 17401.83,-2393.14 17520.83,-2377.18 17603.71,-2364.74"/>
<polygon fill="black" stroke="black" points="17604.27,-2368.19 17613.63,-2363.24 17603.22,-2361.27 17604.27,-2368.19"/>
</g>
<!-- L3_expert3_gate_7 -->
<g id="node346" class="node">
<title>L3_expert3_gate_7</title>
<polygon fill="none" stroke="black" points="9096,-2599.5 8978,-2546.5 9096,-2493.5 9214,-2546.5 9096,-2599.5"/>
<text text-anchor="middle" x="9096" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="9096" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="9096" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert2_ffn1_7 -->
<g id="node347" class="node">
<title>L4_expert2_ffn1_7</title>
<polygon fill="none" stroke="black" points="8960,-2580.5 8824,-2580.5 8824,-2512.5 8960,-2512.5 8960,-2580.5"/>
<text text-anchor="middle" x="8892" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN1</text>
<text text-anchor="middle" x="8892" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="8892" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="8892" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert2_ffn2_7 -->
<g id="node348" class="node">
<title>L4_expert2_ffn2_7</title>
<polygon fill="none" stroke="black" points="8806,-2580.5 8670,-2580.5 8670,-2512.5 8806,-2512.5 8806,-2580.5"/>
<text text-anchor="middle" x="8738" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 2 FFN2</text>
<text text-anchor="middle" x="8738" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="8738" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="8738" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert2_ffn2_7&#45;&gt;L4_expert_concat_head1 -->
<g id="edge95" class="edge">
<title>L4_expert2_ffn2_7&#45;&gt;L4_expert_concat_head1</title>
<path fill="none" stroke="black" d="M8751.18,-2512.3C8763.45,-2486.36 8784.47,-2452.09 8815,-2436 8976.87,-2350.68 14869.09,-2347.82 15870.16,-2347.95"/>
<polygon fill="black" stroke="black" points="15870.28,-2351.45 15880.28,-2347.95 15870.29,-2344.45 15870.28,-2351.45"/>
</g>
<!-- L4_expert2_gate_7 -->
<g id="node349" class="node">
<title>L4_expert2_gate_7</title>
<polygon fill="none" stroke="black" points="8534,-2599.5 8416,-2546.5 8534,-2493.5 8652,-2546.5 8534,-2599.5"/>
<text text-anchor="middle" x="8534" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 2 Gate</text>
<text text-anchor="middle" x="8534" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="8534" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert3_ffn1_7 -->
<g id="node350" class="node">
<title>L4_expert3_ffn1_7</title>
<polygon fill="none" stroke="black" points="8398,-2580.5 8262,-2580.5 8262,-2512.5 8398,-2512.5 8398,-2580.5"/>
<text text-anchor="middle" x="8330" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN1</text>
<text text-anchor="middle" x="8330" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="8330" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="8330" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert3_ffn2_7 -->
<g id="node351" class="node">
<title>L4_expert3_ffn2_7</title>
<polygon fill="none" stroke="black" points="8244,-2580.5 8108,-2580.5 8108,-2512.5 8244,-2512.5 8244,-2580.5"/>
<text text-anchor="middle" x="8176" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 3 FFN2</text>
<text text-anchor="middle" x="8176" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="8176" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="8176" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert3_ffn2_7&#45;&gt;L4_expert_concat_head1 -->
<g id="edge96" class="edge">
<title>L4_expert3_ffn2_7&#45;&gt;L4_expert_concat_head1</title>
<path fill="none" stroke="black" d="M8189.18,-2512.3C8201.44,-2486.35 8222.46,-2452.08 8253,-2436 8428.15,-2343.78 14823.59,-2346.72 15869.9,-2347.82"/>
<polygon fill="black" stroke="black" points="15870.1,-2351.32 15880.1,-2347.83 15870.11,-2344.32 15870.1,-2351.32"/>
</g>
<!-- L4_expert3_gate_7 -->
<g id="node352" class="node">
<title>L4_expert3_gate_7</title>
<polygon fill="none" stroke="black" points="7972,-2599.5 7854,-2546.5 7972,-2493.5 8090,-2546.5 7972,-2599.5"/>
<text text-anchor="middle" x="7972" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 3 Gate</text>
<text text-anchor="middle" x="7972" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="7972" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_Q_proj_8 -->
<g id="node353" class="node">
<title>L1_Q_proj_8</title>
<polygon fill="none" stroke="black" points="117796,-2580.5 117660,-2580.5 117660,-2512.5 117796,-2512.5 117796,-2580.5"/>
<text text-anchor="middle" x="117728" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="117728" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="117728" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="117728" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_K_proj_8 -->
<g id="node354" class="node">
<title>L1_K_proj_8</title>
<polygon fill="none" stroke="black" points="117642,-2580.5 117506,-2580.5 117506,-2512.5 117642,-2512.5 117642,-2580.5"/>
<text text-anchor="middle" x="117574" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="117574" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="117574" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="117574" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_V_proj_8 -->
<g id="node355" class="node">
<title>L1_V_proj_8</title>
<polygon fill="none" stroke="black" points="117488,-2580.5 117352,-2580.5 117352,-2512.5 117488,-2512.5 117488,-2580.5"/>
<text text-anchor="middle" x="117420" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="117420" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="117420" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="117420" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_attention_8 -->
<g id="node356" class="node">
<title>L1_attention_8</title>
<ellipse fill="none" stroke="black" cx="117238" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="117238" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="117238" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="117238" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="117238" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_8 -->
<g id="node357" class="node">
<title>L1_out_proj_8</title>
<polygon fill="none" stroke="black" points="110380,-2580.5 110236,-2580.5 110236,-2512.5 110380,-2512.5 110380,-2580.5"/>
<text text-anchor="middle" x="110308" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="110308" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="110308" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="110308" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_concat_dim_head2 -->
<g id="node721" class="node">
<title>L1_concat_dim_head2</title>
<polygon fill="none" stroke="black" points="102470,-2400 102324,-2347 102470,-2294 102616,-2347 102470,-2400"/>
<text text-anchor="middle" x="102470" y="-2358.3" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="102470" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="102470" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_out_proj_8&#45;&gt;L1_concat_dim_head2 -->
<g id="edge97" class="edge">
<title>L1_out_proj_8&#45;&gt;L1_concat_dim_head2</title>
<path fill="none" stroke="black" d="M110293.84,-2512.46C110280.7,-2486.42 110258.42,-2451.94 110227,-2436 110143.1,-2393.42 103547.04,-2402.74 103453,-2400 103147.5,-2391.11 102789.12,-2369.27 102600.83,-2356.9"/>
<polygon fill="black" stroke="black" points="102600.82,-2353.4 102590.61,-2356.23 102600.36,-2360.38 102600.82,-2353.4"/>
</g>
<!-- L2_Q_proj_8 -->
<g id="node358" class="node">
<title>L2_Q_proj_8</title>
<polygon fill="none" stroke="black" points="116970,-2580.5 116834,-2580.5 116834,-2512.5 116970,-2512.5 116970,-2580.5"/>
<text text-anchor="middle" x="116902" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="116902" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="116902" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="116902" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_K_proj_8 -->
<g id="node359" class="node">
<title>L2_K_proj_8</title>
<polygon fill="none" stroke="black" points="116816,-2580.5 116680,-2580.5 116680,-2512.5 116816,-2512.5 116816,-2580.5"/>
<text text-anchor="middle" x="116748" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="116748" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="116748" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="116748" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_V_proj_8 -->
<g id="node360" class="node">
<title>L2_V_proj_8</title>
<polygon fill="none" stroke="black" points="116662,-2580.5 116526,-2580.5 116526,-2512.5 116662,-2512.5 116662,-2580.5"/>
<text text-anchor="middle" x="116594" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="116594" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="116594" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="116594" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_attention_8 -->
<g id="node361" class="node">
<title>L2_attention_8</title>
<ellipse fill="none" stroke="black" cx="116412" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="116412" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="116412" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="116412" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="116412" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_8 -->
<g id="node362" class="node">
<title>L2_out_proj_8</title>
<polygon fill="none" stroke="black" points="112074,-2580.5 111930,-2580.5 111930,-2512.5 112074,-2512.5 112074,-2580.5"/>
<text text-anchor="middle" x="112002" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="112002" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="112002" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="112002" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_concat_dim_head2 -->
<g id="node722" class="node">
<title>L2_concat_dim_head2</title>
<polygon fill="none" stroke="black" points="104164,-2400 104018,-2347 104164,-2294 104310,-2347 104164,-2400"/>
<text text-anchor="middle" x="104164" y="-2358.3" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="104164" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="104164" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_out_proj_8&#45;&gt;L2_concat_dim_head2 -->
<g id="edge98" class="edge">
<title>L2_out_proj_8&#45;&gt;L2_concat_dim_head2</title>
<path fill="none" stroke="black" d="M111987.84,-2512.46C111974.7,-2486.42 111952.42,-2451.94 111921,-2436 111837.1,-2393.42 105241.04,-2402.74 105147,-2400 104841.5,-2391.11 104483.12,-2369.27 104294.83,-2356.9"/>
<polygon fill="black" stroke="black" points="104294.82,-2353.4 104284.61,-2356.23 104294.36,-2360.38 104294.82,-2353.4"/>
</g>
<!-- L3_Q_proj_8 -->
<g id="node363" class="node">
<title>L3_Q_proj_8</title>
<polygon fill="none" stroke="black" points="116144,-2580.5 116008,-2580.5 116008,-2512.5 116144,-2512.5 116144,-2580.5"/>
<text text-anchor="middle" x="116076" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="116076" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="116076" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="116076" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_K_proj_8 -->
<g id="node364" class="node">
<title>L3_K_proj_8</title>
<polygon fill="none" stroke="black" points="115990,-2580.5 115854,-2580.5 115854,-2512.5 115990,-2512.5 115990,-2580.5"/>
<text text-anchor="middle" x="115922" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="115922" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="115922" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="115922" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_V_proj_8 -->
<g id="node365" class="node">
<title>L3_V_proj_8</title>
<polygon fill="none" stroke="black" points="115836,-2580.5 115700,-2580.5 115700,-2512.5 115836,-2512.5 115836,-2580.5"/>
<text text-anchor="middle" x="115768" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="115768" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="115768" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="115768" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_attention_8 -->
<g id="node366" class="node">
<title>L3_attention_8</title>
<ellipse fill="none" stroke="black" cx="115586" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="115586" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="115586" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="115586" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="115586" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_8 -->
<g id="node367" class="node">
<title>L3_out_proj_8</title>
<polygon fill="none" stroke="black" points="113768,-2580.5 113624,-2580.5 113624,-2512.5 113768,-2512.5 113768,-2580.5"/>
<text text-anchor="middle" x="113696" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="113696" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="113696" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="113696" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_concat_dim_head2 -->
<g id="node723" class="node">
<title>L3_concat_dim_head2</title>
<polygon fill="none" stroke="black" points="105858,-2400 105712,-2347 105858,-2294 106004,-2347 105858,-2400"/>
<text text-anchor="middle" x="105858" y="-2358.3" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="105858" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="105858" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_out_proj_8&#45;&gt;L3_concat_dim_head2 -->
<g id="edge99" class="edge">
<title>L3_out_proj_8&#45;&gt;L3_concat_dim_head2</title>
<path fill="none" stroke="black" d="M113681.84,-2512.46C113668.71,-2486.42 113646.42,-2451.94 113615,-2436 113527.95,-2391.84 106684.54,-2403.72 106587,-2400 106374.49,-2391.89 106127.77,-2372.11 105982.72,-2359.42"/>
<polygon fill="black" stroke="black" points="105982.72,-2355.9 105972.46,-2358.51 105982.11,-2362.88 105982.72,-2355.9"/>
</g>
<!-- L4_Q_proj_8 -->
<g id="node368" class="node">
<title>L4_Q_proj_8</title>
<polygon fill="none" stroke="black" points="115310,-2580.5 115174,-2580.5 115174,-2512.5 115310,-2512.5 115310,-2580.5"/>
<text text-anchor="middle" x="115242" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="115242" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="115242" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="115242" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_K_proj_8 -->
<g id="node369" class="node">
<title>L4_K_proj_8</title>
<polygon fill="none" stroke="black" points="115156,-2580.5 115020,-2580.5 115020,-2512.5 115156,-2512.5 115156,-2580.5"/>
<text text-anchor="middle" x="115088" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="115088" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="115088" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="115088" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_V_proj_8 -->
<g id="node370" class="node">
<title>L4_V_proj_8</title>
<polygon fill="none" stroke="black" points="115002,-2580.5 114866,-2580.5 114866,-2512.5 115002,-2512.5 115002,-2580.5"/>
<text text-anchor="middle" x="114934" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="114934" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="114934" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="114934" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_attention_8 -->
<g id="node371" class="node">
<title>L4_attention_8</title>
<ellipse fill="none" stroke="black" cx="114752" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="114752" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="114752" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="114752" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="114752" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_8 -->
<g id="node372" class="node">
<title>L4_out_proj_8</title>
<polygon fill="none" stroke="black" points="115472,-2580.5 115328,-2580.5 115328,-2512.5 115472,-2512.5 115472,-2580.5"/>
<text text-anchor="middle" x="115400" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="115400" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="115400" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="115400" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_concat_dim_head2 -->
<g id="node724" class="node">
<title>L4_concat_dim_head2</title>
<polygon fill="none" stroke="black" points="107562,-2400 107416,-2347 107562,-2294 107708,-2347 107562,-2400"/>
<text text-anchor="middle" x="107562" y="-2358.3" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="107562" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="107562" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_out_proj_8&#45;&gt;L4_concat_dim_head2 -->
<g id="edge100" class="edge">
<title>L4_out_proj_8&#45;&gt;L4_concat_dim_head2</title>
<path fill="none" stroke="black" d="M115385.84,-2512.46C115372.7,-2486.43 115350.42,-2451.95 115319,-2436 115241.65,-2396.72 109159.73,-2401.74 109073,-2400 108566.79,-2389.83 107965.56,-2365.46 107699.9,-2354.07"/>
<polygon fill="black" stroke="black" points="107699.96,-2350.57 107689.82,-2353.63 107699.66,-2357.56 107699.96,-2350.57"/>
</g>
<!-- L1_expert4_ffn1_8 -->
<g id="node373" class="node">
<title>L1_expert4_ffn1_8</title>
<polygon fill="none" stroke="black" points="114484,-2580.5 114348,-2580.5 114348,-2512.5 114484,-2512.5 114484,-2580.5"/>
<text text-anchor="middle" x="114416" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN1</text>
<text text-anchor="middle" x="114416" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="114416" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="114416" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert4_ffn2_8 -->
<g id="node374" class="node">
<title>L1_expert4_ffn2_8</title>
<polygon fill="none" stroke="black" points="111504,-2580.5 111368,-2580.5 111368,-2512.5 111504,-2512.5 111504,-2580.5"/>
<text text-anchor="middle" x="111436" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN2</text>
<text text-anchor="middle" x="111436" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="111436" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="111436" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert_concat_head2 -->
<g id="node725" class="node">
<title>L1_expert_concat_head2</title>
<polygon fill="none" stroke="black" points="103598,-2400 103462,-2347 103598,-2294 103734,-2347 103598,-2400"/>
<text text-anchor="middle" x="103598" y="-2358.3" font-family="Times,serif" font-size="14.00">Expert Concat</text>
<text text-anchor="middle" x="103598" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="103598" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert4_ffn2_8&#45;&gt;L1_expert_concat_head2 -->
<g id="edge101" class="edge">
<title>L1_expert4_ffn2_8&#45;&gt;L1_expert_concat_head2</title>
<path fill="none" stroke="black" d="M111422.85,-2512.24C111410.6,-2486.27 111389.59,-2451.98 111359,-2436 111268.52,-2388.73 104110.87,-2406.67 104009,-2400 103904.17,-2393.14 103785.17,-2377.18 103702.29,-2364.74"/>
<polygon fill="black" stroke="black" points="103702.78,-2361.27 103692.37,-2363.24 103701.73,-2368.19 103702.78,-2361.27"/>
</g>
<!-- L1_expert4_gate_8 -->
<g id="node375" class="node">
<title>L1_expert4_gate_8</title>
<polygon fill="none" stroke="black" points="114058,-2599.5 113940,-2546.5 114058,-2493.5 114176,-2546.5 114058,-2599.5"/>
<text text-anchor="middle" x="114058" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="114058" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="114058" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_expert5_ffn1_8 -->
<g id="node376" class="node">
<title>L1_expert5_ffn1_8</title>
<polygon fill="none" stroke="black" points="113922,-2580.5 113786,-2580.5 113786,-2512.5 113922,-2512.5 113922,-2580.5"/>
<text text-anchor="middle" x="113854" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN1</text>
<text text-anchor="middle" x="113854" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="113854" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="113854" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert5_ffn2_8 -->
<g id="node377" class="node">
<title>L1_expert5_ffn2_8</title>
<polygon fill="none" stroke="black" points="110942,-2580.5 110806,-2580.5 110806,-2512.5 110942,-2512.5 110942,-2580.5"/>
<text text-anchor="middle" x="110874" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN2</text>
<text text-anchor="middle" x="110874" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="110874" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="110874" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert5_ffn2_8&#45;&gt;L1_expert_concat_head2 -->
<g id="edge102" class="edge">
<title>L1_expert5_ffn2_8&#45;&gt;L1_expert_concat_head2</title>
<path fill="none" stroke="black" d="M110860.85,-2512.25C110848.6,-2486.27 110827.59,-2451.99 110797,-2436 110713.45,-2392.33 104103.08,-2406.18 104009,-2400 103904.17,-2393.12 103785.17,-2377.16 103702.29,-2364.72"/>
<polygon fill="black" stroke="black" points="103702.78,-2361.26 103692.37,-2363.23 103701.73,-2368.18 103702.78,-2361.26"/>
</g>
<!-- L1_expert5_gate_8 -->
<g id="node378" class="node">
<title>L1_expert5_gate_8</title>
<polygon fill="none" stroke="black" points="113488,-2599.5 113370,-2546.5 113488,-2493.5 113606,-2546.5 113488,-2599.5"/>
<text text-anchor="middle" x="113488" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="113488" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="113488" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert4_ffn1_8 -->
<g id="node379" class="node">
<title>L2_expert4_ffn1_8</title>
<polygon fill="none" stroke="black" points="113352,-2580.5 113216,-2580.5 113216,-2512.5 113352,-2512.5 113352,-2580.5"/>
<text text-anchor="middle" x="113284" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN1</text>
<text text-anchor="middle" x="113284" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="113284" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="113284" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert4_ffn2_8 -->
<g id="node380" class="node">
<title>L2_expert4_ffn2_8</title>
<polygon fill="none" stroke="black" points="113198,-2580.5 113062,-2580.5 113062,-2512.5 113198,-2512.5 113198,-2580.5"/>
<text text-anchor="middle" x="113130" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN2</text>
<text text-anchor="middle" x="113130" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="113130" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="113130" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert_concat_head2 -->
<g id="node726" class="node">
<title>L2_expert_concat_head2</title>
<polygon fill="none" stroke="black" points="105292,-2400 105156,-2347 105292,-2294 105428,-2347 105292,-2400"/>
<text text-anchor="middle" x="105292" y="-2358.3" font-family="Times,serif" font-size="14.00">Expert Concat</text>
<text text-anchor="middle" x="105292" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="105292" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert4_ffn2_8&#45;&gt;L2_expert_concat_head2 -->
<g id="edge103" class="edge">
<title>L2_expert4_ffn2_8&#45;&gt;L2_expert_concat_head2</title>
<path fill="none" stroke="black" d="M113116.85,-2512.24C113104.6,-2486.27 113083.59,-2451.98 113053,-2436 112962.52,-2388.73 105804.87,-2406.67 105703,-2400 105598.17,-2393.14 105479.17,-2377.18 105396.29,-2364.74"/>
<polygon fill="black" stroke="black" points="105396.78,-2361.27 105386.37,-2363.24 105395.73,-2368.19 105396.78,-2361.27"/>
</g>
<!-- L2_expert4_gate_8 -->
<g id="node381" class="node">
<title>L2_expert4_gate_8</title>
<polygon fill="none" stroke="black" points="112926,-2599.5 112808,-2546.5 112926,-2493.5 113044,-2546.5 112926,-2599.5"/>
<text text-anchor="middle" x="112926" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="112926" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="112926" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert5_ffn1_8 -->
<g id="node382" class="node">
<title>L2_expert5_ffn1_8</title>
<polygon fill="none" stroke="black" points="112790,-2580.5 112654,-2580.5 112654,-2512.5 112790,-2512.5 112790,-2580.5"/>
<text text-anchor="middle" x="112722" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN1</text>
<text text-anchor="middle" x="112722" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="112722" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="112722" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert5_ffn2_8 -->
<g id="node383" class="node">
<title>L2_expert5_ffn2_8</title>
<polygon fill="none" stroke="black" points="112636,-2580.5 112500,-2580.5 112500,-2512.5 112636,-2512.5 112636,-2580.5"/>
<text text-anchor="middle" x="112568" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN2</text>
<text text-anchor="middle" x="112568" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="112568" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="112568" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert5_ffn2_8&#45;&gt;L2_expert_concat_head2 -->
<g id="edge104" class="edge">
<title>L2_expert5_ffn2_8&#45;&gt;L2_expert_concat_head2</title>
<path fill="none" stroke="black" d="M112554.85,-2512.25C112542.6,-2486.27 112521.59,-2451.99 112491,-2436 112407.45,-2392.33 105797.08,-2406.18 105703,-2400 105598.17,-2393.12 105479.17,-2377.16 105396.29,-2364.72"/>
<polygon fill="black" stroke="black" points="105396.78,-2361.26 105386.37,-2363.23 105395.73,-2368.18 105396.78,-2361.26"/>
</g>
<!-- L2_expert5_gate_8 -->
<g id="node384" class="node">
<title>L2_expert5_gate_8</title>
<polygon fill="none" stroke="black" points="112364,-2599.5 112246,-2546.5 112364,-2493.5 112482,-2546.5 112364,-2599.5"/>
<text text-anchor="middle" x="112364" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="112364" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="112364" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert4_ffn1_8 -->
<g id="node385" class="node">
<title>L3_expert4_ffn1_8</title>
<polygon fill="none" stroke="black" points="112228,-2580.5 112092,-2580.5 112092,-2512.5 112228,-2512.5 112228,-2580.5"/>
<text text-anchor="middle" x="112160" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN1</text>
<text text-anchor="middle" x="112160" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="112160" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="112160" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert4_ffn2_8 -->
<g id="node386" class="node">
<title>L3_expert4_ffn2_8</title>
<polygon fill="none" stroke="black" points="114638,-2580.5 114502,-2580.5 114502,-2512.5 114638,-2512.5 114638,-2580.5"/>
<text text-anchor="middle" x="114570" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN2</text>
<text text-anchor="middle" x="114570" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="114570" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="114570" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert_concat_head2 -->
<g id="node727" class="node">
<title>L3_expert_concat_head2</title>
<polygon fill="none" stroke="black" points="106732,-2400 106596,-2347 106732,-2294 106868,-2347 106732,-2400"/>
<text text-anchor="middle" x="106732" y="-2358.3" font-family="Times,serif" font-size="14.00">Expert Concat</text>
<text text-anchor="middle" x="106732" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="106732" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert4_ffn2_8&#45;&gt;L3_expert_concat_head2 -->
<g id="edge105" class="edge">
<title>L3_expert4_ffn2_8&#45;&gt;L3_expert_concat_head2</title>
<path fill="none" stroke="black" d="M114556.85,-2512.25C114544.6,-2486.27 114523.59,-2451.98 114493,-2436 114405.77,-2390.42 107505.34,-2404.03 107407,-2400 107210.85,-2391.96 106983.32,-2372.27 106848.86,-2359.56"/>
<polygon fill="black" stroke="black" points="106848.82,-2356.04 106838.54,-2358.58 106848.16,-2363.01 106848.82,-2356.04"/>
</g>
<!-- L3_expert4_gate_8 -->
<g id="node387" class="node">
<title>L3_expert4_gate_8</title>
<polygon fill="none" stroke="black" points="111794,-2599.5 111676,-2546.5 111794,-2493.5 111912,-2546.5 111794,-2599.5"/>
<text text-anchor="middle" x="111794" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="111794" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="111794" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert5_ffn1_8 -->
<g id="node388" class="node">
<title>L3_expert5_ffn1_8</title>
<polygon fill="none" stroke="black" points="111658,-2580.5 111522,-2580.5 111522,-2512.5 111658,-2512.5 111658,-2580.5"/>
<text text-anchor="middle" x="111590" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN1</text>
<text text-anchor="middle" x="111590" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="111590" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="111590" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert5_ffn2_8 -->
<g id="node389" class="node">
<title>L3_expert5_ffn2_8</title>
<polygon fill="none" stroke="black" points="114330,-2580.5 114194,-2580.5 114194,-2512.5 114330,-2512.5 114330,-2580.5"/>
<text text-anchor="middle" x="114262" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN2</text>
<text text-anchor="middle" x="114262" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="114262" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="114262" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert5_ffn2_8&#45;&gt;L3_expert_concat_head2 -->
<g id="edge106" class="edge">
<title>L3_expert5_ffn2_8&#45;&gt;L3_expert_concat_head2</title>
<path fill="none" stroke="black" d="M114248.85,-2512.25C114236.6,-2486.27 114215.59,-2451.99 114185,-2436 114101.57,-2392.39 107501.06,-2403.87 107407,-2400 107210.85,-2391.93 106983.32,-2372.26 106848.86,-2359.56"/>
<polygon fill="black" stroke="black" points="106848.82,-2356.04 106838.54,-2358.58 106848.16,-2363.01 106848.82,-2356.04"/>
</g>
<!-- L3_expert5_gate_8 -->
<g id="node390" class="node">
<title>L3_expert5_gate_8</title>
<polygon fill="none" stroke="black" points="111232,-2599.5 111114,-2546.5 111232,-2493.5 111350,-2546.5 111232,-2599.5"/>
<text text-anchor="middle" x="111232" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="111232" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="111232" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert4_ffn1_8 -->
<g id="node391" class="node">
<title>L4_expert4_ffn1_8</title>
<polygon fill="none" stroke="black" points="111096,-2580.5 110960,-2580.5 110960,-2512.5 111096,-2512.5 111096,-2580.5"/>
<text text-anchor="middle" x="111028" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN1</text>
<text text-anchor="middle" x="111028" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="111028" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="111028" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert4_ffn2_8 -->
<g id="node392" class="node">
<title>L4_expert4_ffn2_8</title>
<polygon fill="none" stroke="black" points="117124,-2580.5 116988,-2580.5 116988,-2512.5 117124,-2512.5 117124,-2580.5"/>
<text text-anchor="middle" x="117056" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN2</text>
<text text-anchor="middle" x="117056" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="117056" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="117056" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert_concat_head2 -->
<g id="node728" class="node">
<title>L4_expert_concat_head2</title>
<polygon fill="none" stroke="black" points="109218,-2400 109082,-2347 109218,-2294 109354,-2347 109218,-2400"/>
<text text-anchor="middle" x="109218" y="-2358.3" font-family="Times,serif" font-size="14.00">Expert Concat</text>
<text text-anchor="middle" x="109218" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="109218" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert4_ffn2_8&#45;&gt;L4_expert_concat_head2 -->
<g id="edge107" class="edge">
<title>L4_expert4_ffn2_8&#45;&gt;L4_expert_concat_head2</title>
<path fill="none" stroke="black" d="M117042.82,-2512.3C117030.56,-2486.35 117009.54,-2452.08 116979,-2436 116803.85,-2343.78 110408.41,-2346.72 109362.1,-2347.82"/>
<polygon fill="black" stroke="black" points="109361.89,-2344.32 109351.9,-2347.83 109361.9,-2351.32 109361.89,-2344.32"/>
</g>
<!-- L4_expert4_gate_8 -->
<g id="node393" class="node">
<title>L4_expert4_gate_8</title>
<polygon fill="none" stroke="black" points="110670,-2599.5 110552,-2546.5 110670,-2493.5 110788,-2546.5 110670,-2599.5"/>
<text text-anchor="middle" x="110670" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="110670" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="110670" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert5_ffn1_8 -->
<g id="node394" class="node">
<title>L4_expert5_ffn1_8</title>
<polygon fill="none" stroke="black" points="110534,-2580.5 110398,-2580.5 110398,-2512.5 110534,-2512.5 110534,-2580.5"/>
<text text-anchor="middle" x="110466" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN1</text>
<text text-anchor="middle" x="110466" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="110466" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="110466" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert5_ffn2_8 -->
<g id="node395" class="node">
<title>L4_expert5_ffn2_8</title>
<polygon fill="none" stroke="black" points="116298,-2580.5 116162,-2580.5 116162,-2512.5 116298,-2512.5 116298,-2580.5"/>
<text text-anchor="middle" x="116230" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN2</text>
<text text-anchor="middle" x="116230" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="116230" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="116230" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert5_ffn2_8&#45;&gt;L4_expert_concat_head2 -->
<g id="edge108" class="edge">
<title>L4_expert5_ffn2_8&#45;&gt;L4_expert_concat_head2</title>
<path fill="none" stroke="black" d="M116216.82,-2512.31C116204.55,-2486.37 116183.53,-2452.1 116153,-2436 115997.37,-2353.93 110341.91,-2348.37 109361.97,-2348.02"/>
<polygon fill="black" stroke="black" points="109361.71,-2344.52 109351.7,-2348.02 109361.7,-2351.52 109361.71,-2344.52"/>
</g>
<!-- L4_expert5_gate_8 -->
<g id="node396" class="node">
<title>L4_expert5_gate_8</title>
<polygon fill="none" stroke="black" points="110100,-2599.5 109982,-2546.5 110100,-2493.5 110218,-2546.5 110100,-2599.5"/>
<text text-anchor="middle" x="110100" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="110100" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="110100" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_Q_proj_9 -->
<g id="node397" class="node">
<title>L1_Q_proj_9</title>
<polygon fill="none" stroke="black" points="125634,-2580.5 125498,-2580.5 125498,-2512.5 125634,-2512.5 125634,-2580.5"/>
<text text-anchor="middle" x="125566" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="125566" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="125566" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="125566" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_K_proj_9 -->
<g id="node398" class="node">
<title>L1_K_proj_9</title>
<polygon fill="none" stroke="black" points="125480,-2580.5 125344,-2580.5 125344,-2512.5 125480,-2512.5 125480,-2580.5"/>
<text text-anchor="middle" x="125412" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="125412" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="125412" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="125412" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_V_proj_9 -->
<g id="node399" class="node">
<title>L1_V_proj_9</title>
<polygon fill="none" stroke="black" points="125326,-2580.5 125190,-2580.5 125190,-2512.5 125326,-2512.5 125326,-2580.5"/>
<text text-anchor="middle" x="125258" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="125258" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="125258" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="125258" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_attention_9 -->
<g id="node400" class="node">
<title>L1_attention_9</title>
<ellipse fill="none" stroke="black" cx="125076" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="125076" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="125076" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="125076" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="125076" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_9 -->
<g id="node401" class="node">
<title>L1_out_proj_9</title>
<polygon fill="none" stroke="black" points="118218,-2580.5 118074,-2580.5 118074,-2512.5 118218,-2512.5 118218,-2580.5"/>
<text text-anchor="middle" x="118146" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="118146" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="118146" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="118146" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_9&#45;&gt;L1_concat_dim_head2 -->
<g id="edge109" class="edge">
<title>L1_out_proj_9&#45;&gt;L1_concat_dim_head2</title>
<path fill="none" stroke="black" d="M118131.86,-2512.44C118118.72,-2486.39 118096.44,-2451.9 118065,-2436 117974.45,-2390.21 103554.43,-2402.81 103453,-2400 103147.49,-2391.55 102789.11,-2369.53 102600.82,-2357.02"/>
<polygon fill="black" stroke="black" points="102600.82,-2353.51 102590.61,-2356.34 102600.35,-2360.5 102600.82,-2353.51"/>
</g>
<!-- L2_Q_proj_9 -->
<g id="node402" class="node">
<title>L2_Q_proj_9</title>
<polygon fill="none" stroke="black" points="124808,-2580.5 124672,-2580.5 124672,-2512.5 124808,-2512.5 124808,-2580.5"/>
<text text-anchor="middle" x="124740" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="124740" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="124740" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="124740" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_K_proj_9 -->
<g id="node403" class="node">
<title>L2_K_proj_9</title>
<polygon fill="none" stroke="black" points="124654,-2580.5 124518,-2580.5 124518,-2512.5 124654,-2512.5 124654,-2580.5"/>
<text text-anchor="middle" x="124586" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="124586" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="124586" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="124586" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_V_proj_9 -->
<g id="node404" class="node">
<title>L2_V_proj_9</title>
<polygon fill="none" stroke="black" points="124500,-2580.5 124364,-2580.5 124364,-2512.5 124500,-2512.5 124500,-2580.5"/>
<text text-anchor="middle" x="124432" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="124432" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="124432" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="124432" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_attention_9 -->
<g id="node405" class="node">
<title>L2_attention_9</title>
<ellipse fill="none" stroke="black" cx="124250" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="124250" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="124250" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="124250" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="124250" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_9 -->
<g id="node406" class="node">
<title>L2_out_proj_9</title>
<polygon fill="none" stroke="black" points="119912,-2580.5 119768,-2580.5 119768,-2512.5 119912,-2512.5 119912,-2580.5"/>
<text text-anchor="middle" x="119840" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="119840" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="119840" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="119840" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_9&#45;&gt;L2_concat_dim_head2 -->
<g id="edge110" class="edge">
<title>L2_out_proj_9&#45;&gt;L2_concat_dim_head2</title>
<path fill="none" stroke="black" d="M119825.86,-2512.44C119812.72,-2486.39 119790.44,-2451.9 119759,-2436 119668.45,-2390.21 105248.43,-2402.81 105147,-2400 104841.49,-2391.55 104483.11,-2369.53 104294.82,-2357.02"/>
<polygon fill="black" stroke="black" points="104294.82,-2353.51 104284.61,-2356.34 104294.35,-2360.5 104294.82,-2353.51"/>
</g>
<!-- L3_Q_proj_9 -->
<g id="node407" class="node">
<title>L3_Q_proj_9</title>
<polygon fill="none" stroke="black" points="123982,-2580.5 123846,-2580.5 123846,-2512.5 123982,-2512.5 123982,-2580.5"/>
<text text-anchor="middle" x="123914" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="123914" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="123914" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="123914" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_K_proj_9 -->
<g id="node408" class="node">
<title>L3_K_proj_9</title>
<polygon fill="none" stroke="black" points="123828,-2580.5 123692,-2580.5 123692,-2512.5 123828,-2512.5 123828,-2580.5"/>
<text text-anchor="middle" x="123760" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="123760" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="123760" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="123760" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_V_proj_9 -->
<g id="node409" class="node">
<title>L3_V_proj_9</title>
<polygon fill="none" stroke="black" points="123674,-2580.5 123538,-2580.5 123538,-2512.5 123674,-2512.5 123674,-2580.5"/>
<text text-anchor="middle" x="123606" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="123606" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="123606" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="123606" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_attention_9 -->
<g id="node410" class="node">
<title>L3_attention_9</title>
<ellipse fill="none" stroke="black" cx="123424" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="123424" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="123424" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="123424" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="123424" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_9 -->
<g id="node411" class="node">
<title>L3_out_proj_9</title>
<polygon fill="none" stroke="black" points="121606,-2580.5 121462,-2580.5 121462,-2512.5 121606,-2512.5 121606,-2580.5"/>
<text text-anchor="middle" x="121534" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="121534" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="121534" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="121534" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_9&#45;&gt;L3_concat_dim_head2 -->
<g id="edge111" class="edge">
<title>L3_out_proj_9&#45;&gt;L3_concat_dim_head2</title>
<path fill="none" stroke="black" d="M121519.86,-2512.44C121506.72,-2486.38 121484.44,-2451.9 121453,-2436 121360.87,-2389.41 106690.17,-2403.8 106587,-2400 106374.33,-2392.17 106127.41,-2372.28 105982.4,-2359.49"/>
<polygon fill="black" stroke="black" points="105982.41,-2355.98 105972.14,-2358.58 105981.79,-2362.95 105982.41,-2355.98"/>
</g>
<!-- L4_Q_proj_9 -->
<g id="node412" class="node">
<title>L4_Q_proj_9</title>
<polygon fill="none" stroke="black" points="123148,-2580.5 123012,-2580.5 123012,-2512.5 123148,-2512.5 123148,-2580.5"/>
<text text-anchor="middle" x="123080" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="123080" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="123080" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="123080" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_K_proj_9 -->
<g id="node413" class="node">
<title>L4_K_proj_9</title>
<polygon fill="none" stroke="black" points="122994,-2580.5 122858,-2580.5 122858,-2512.5 122994,-2512.5 122994,-2580.5"/>
<text text-anchor="middle" x="122926" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="122926" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="122926" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="122926" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_V_proj_9 -->
<g id="node414" class="node">
<title>L4_V_proj_9</title>
<polygon fill="none" stroke="black" points="122840,-2580.5 122704,-2580.5 122704,-2512.5 122840,-2512.5 122840,-2580.5"/>
<text text-anchor="middle" x="122772" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="122772" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="122772" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="122772" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_attention_9 -->
<g id="node415" class="node">
<title>L4_attention_9</title>
<ellipse fill="none" stroke="black" cx="122590" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="122590" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="122590" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="122590" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="122590" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_9 -->
<g id="node416" class="node">
<title>L4_out_proj_9</title>
<polygon fill="none" stroke="black" points="123310,-2580.5 123166,-2580.5 123166,-2512.5 123310,-2512.5 123310,-2580.5"/>
<text text-anchor="middle" x="123238" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="123238" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="123238" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="123238" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_9&#45;&gt;L4_concat_dim_head2 -->
<g id="edge112" class="edge">
<title>L4_out_proj_9&#45;&gt;L4_concat_dim_head2</title>
<path fill="none" stroke="black" d="M123223.86,-2512.44C123210.72,-2486.39 123188.44,-2451.9 123157,-2436 123069.72,-2391.86 109170.79,-2401.81 109073,-2400 108566.77,-2390.64 107965.55,-2365.86 107699.9,-2354.22"/>
<polygon fill="black" stroke="black" points="107699.96,-2350.72 107689.82,-2353.77 107699.66,-2357.71 107699.96,-2350.72"/>
</g>
<!-- L1_expert4_ffn1_9 -->
<g id="node417" class="node">
<title>L1_expert4_ffn1_9</title>
<polygon fill="none" stroke="black" points="122322,-2580.5 122186,-2580.5 122186,-2512.5 122322,-2512.5 122322,-2580.5"/>
<text text-anchor="middle" x="122254" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN1</text>
<text text-anchor="middle" x="122254" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="122254" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="122254" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert4_ffn2_9 -->
<g id="node418" class="node">
<title>L1_expert4_ffn2_9</title>
<polygon fill="none" stroke="black" points="119342,-2580.5 119206,-2580.5 119206,-2512.5 119342,-2512.5 119342,-2580.5"/>
<text text-anchor="middle" x="119274" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN2</text>
<text text-anchor="middle" x="119274" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="119274" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="119274" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert4_ffn2_9&#45;&gt;L1_expert_concat_head2 -->
<g id="edge113" class="edge">
<title>L1_expert4_ffn2_9&#45;&gt;L1_expert_concat_head2</title>
<path fill="none" stroke="black" d="M119260.99,-2512.49C119248.76,-2486.47 119227.71,-2451.99 119197,-2436 119103.45,-2387.28 104114.26,-2406.76 104009,-2400 103904.16,-2393.27 103785.16,-2377.29 103702.29,-2364.81"/>
<polygon fill="black" stroke="black" points="103702.78,-2361.34 103692.36,-2363.31 103701.73,-2368.26 103702.78,-2361.34"/>
</g>
<!-- L1_expert4_gate_9 -->
<g id="node419" class="node">
<title>L1_expert4_gate_9</title>
<polygon fill="none" stroke="black" points="121896,-2599.5 121778,-2546.5 121896,-2493.5 122014,-2546.5 121896,-2599.5"/>
<text text-anchor="middle" x="121896" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="121896" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="121896" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_expert5_ffn1_9 -->
<g id="node420" class="node">
<title>L1_expert5_ffn1_9</title>
<polygon fill="none" stroke="black" points="121760,-2580.5 121624,-2580.5 121624,-2512.5 121760,-2512.5 121760,-2580.5"/>
<text text-anchor="middle" x="121692" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN1</text>
<text text-anchor="middle" x="121692" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="121692" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="121692" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert5_ffn2_9 -->
<g id="node421" class="node">
<title>L1_expert5_ffn2_9</title>
<polygon fill="none" stroke="black" points="118780,-2580.5 118644,-2580.5 118644,-2512.5 118780,-2512.5 118780,-2580.5"/>
<text text-anchor="middle" x="118712" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN2</text>
<text text-anchor="middle" x="118712" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="118712" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="118712" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert5_ffn2_9&#45;&gt;L1_expert_concat_head2 -->
<g id="edge114" class="edge">
<title>L1_expert5_ffn2_9&#45;&gt;L1_expert_concat_head2</title>
<path fill="none" stroke="black" d="M118698.99,-2512.49C118686.76,-2486.47 118665.71,-2452 118635,-2436 118544.92,-2389.08 104110.36,-2406.51 104009,-2400 103904.16,-2393.26 103785.16,-2377.29 103702.29,-2364.81"/>
<polygon fill="black" stroke="black" points="103702.78,-2361.34 103692.36,-2363.3 103701.73,-2368.26 103702.78,-2361.34"/>
</g>
<!-- L1_expert5_gate_9 -->
<g id="node422" class="node">
<title>L1_expert5_gate_9</title>
<polygon fill="none" stroke="black" points="121326,-2599.5 121208,-2546.5 121326,-2493.5 121444,-2546.5 121326,-2599.5"/>
<text text-anchor="middle" x="121326" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="121326" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="121326" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert4_ffn1_9 -->
<g id="node423" class="node">
<title>L2_expert4_ffn1_9</title>
<polygon fill="none" stroke="black" points="121190,-2580.5 121054,-2580.5 121054,-2512.5 121190,-2512.5 121190,-2580.5"/>
<text text-anchor="middle" x="121122" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN1</text>
<text text-anchor="middle" x="121122" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="121122" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="121122" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert4_ffn2_9 -->
<g id="node424" class="node">
<title>L2_expert4_ffn2_9</title>
<polygon fill="none" stroke="black" points="121036,-2580.5 120900,-2580.5 120900,-2512.5 121036,-2512.5 121036,-2580.5"/>
<text text-anchor="middle" x="120968" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN2</text>
<text text-anchor="middle" x="120968" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="120968" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="120968" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert4_ffn2_9&#45;&gt;L2_expert_concat_head2 -->
<g id="edge115" class="edge">
<title>L2_expert4_ffn2_9&#45;&gt;L2_expert_concat_head2</title>
<path fill="none" stroke="black" d="M120954.99,-2512.49C120942.76,-2486.47 120921.71,-2451.99 120891,-2436 120797.45,-2387.28 105808.26,-2406.76 105703,-2400 105598.16,-2393.27 105479.16,-2377.29 105396.29,-2364.81"/>
<polygon fill="black" stroke="black" points="105396.78,-2361.34 105386.36,-2363.31 105395.73,-2368.26 105396.78,-2361.34"/>
</g>
<!-- L2_expert4_gate_9 -->
<g id="node425" class="node">
<title>L2_expert4_gate_9</title>
<polygon fill="none" stroke="black" points="120764,-2599.5 120646,-2546.5 120764,-2493.5 120882,-2546.5 120764,-2599.5"/>
<text text-anchor="middle" x="120764" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="120764" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="120764" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert5_ffn1_9 -->
<g id="node426" class="node">
<title>L2_expert5_ffn1_9</title>
<polygon fill="none" stroke="black" points="120628,-2580.5 120492,-2580.5 120492,-2512.5 120628,-2512.5 120628,-2580.5"/>
<text text-anchor="middle" x="120560" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN1</text>
<text text-anchor="middle" x="120560" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="120560" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="120560" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert5_ffn2_9 -->
<g id="node427" class="node">
<title>L2_expert5_ffn2_9</title>
<polygon fill="none" stroke="black" points="120474,-2580.5 120338,-2580.5 120338,-2512.5 120474,-2512.5 120474,-2580.5"/>
<text text-anchor="middle" x="120406" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN2</text>
<text text-anchor="middle" x="120406" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="120406" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="120406" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert5_ffn2_9&#45;&gt;L2_expert_concat_head2 -->
<g id="edge116" class="edge">
<title>L2_expert5_ffn2_9&#45;&gt;L2_expert_concat_head2</title>
<path fill="none" stroke="black" d="M120392.99,-2512.49C120380.76,-2486.47 120359.71,-2452 120329,-2436 120238.92,-2389.08 105804.36,-2406.51 105703,-2400 105598.16,-2393.26 105479.16,-2377.29 105396.29,-2364.81"/>
<polygon fill="black" stroke="black" points="105396.78,-2361.34 105386.36,-2363.3 105395.73,-2368.26 105396.78,-2361.34"/>
</g>
<!-- L2_expert5_gate_9 -->
<g id="node428" class="node">
<title>L2_expert5_gate_9</title>
<polygon fill="none" stroke="black" points="120202,-2599.5 120084,-2546.5 120202,-2493.5 120320,-2546.5 120202,-2599.5"/>
<text text-anchor="middle" x="120202" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="120202" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="120202" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert4_ffn1_9 -->
<g id="node429" class="node">
<title>L3_expert4_ffn1_9</title>
<polygon fill="none" stroke="black" points="120066,-2580.5 119930,-2580.5 119930,-2512.5 120066,-2512.5 120066,-2580.5"/>
<text text-anchor="middle" x="119998" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN1</text>
<text text-anchor="middle" x="119998" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="119998" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="119998" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert4_ffn2_9 -->
<g id="node430" class="node">
<title>L3_expert4_ffn2_9</title>
<polygon fill="none" stroke="black" points="122476,-2580.5 122340,-2580.5 122340,-2512.5 122476,-2512.5 122476,-2580.5"/>
<text text-anchor="middle" x="122408" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN2</text>
<text text-anchor="middle" x="122408" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="122408" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="122408" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert4_ffn2_9&#45;&gt;L3_expert_concat_head2 -->
<g id="edge117" class="edge">
<title>L3_expert4_ffn2_9&#45;&gt;L3_expert_concat_head2</title>
<path fill="none" stroke="black" d="M122394.99,-2512.49C122382.76,-2486.47 122361.71,-2452 122331,-2436 122239.08,-2388.13 107510.56,-2404.11 107407,-2400 107210.7,-2392.21 106982.98,-2372.43 106848.56,-2359.63"/>
<polygon fill="black" stroke="black" points="106848.53,-2356.11 106838.24,-2358.64 106847.87,-2363.08 106848.53,-2356.11"/>
</g>
<!-- L3_expert4_gate_9 -->
<g id="node431" class="node">
<title>L3_expert4_gate_9</title>
<polygon fill="none" stroke="black" points="119632,-2599.5 119514,-2546.5 119632,-2493.5 119750,-2546.5 119632,-2599.5"/>
<text text-anchor="middle" x="119632" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="119632" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="119632" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert5_ffn1_9 -->
<g id="node432" class="node">
<title>L3_expert5_ffn1_9</title>
<polygon fill="none" stroke="black" points="119496,-2580.5 119360,-2580.5 119360,-2512.5 119496,-2512.5 119496,-2580.5"/>
<text text-anchor="middle" x="119428" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN1</text>
<text text-anchor="middle" x="119428" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="119428" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="119428" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert5_ffn2_9 -->
<g id="node433" class="node">
<title>L3_expert5_ffn2_9</title>
<polygon fill="none" stroke="black" points="122168,-2580.5 122032,-2580.5 122032,-2512.5 122168,-2512.5 122168,-2580.5"/>
<text text-anchor="middle" x="122100" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN2</text>
<text text-anchor="middle" x="122100" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="122100" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="122100" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert5_ffn2_9&#45;&gt;L3_expert_concat_head2 -->
<g id="edge118" class="edge">
<title>L3_expert5_ffn2_9&#45;&gt;L3_expert_concat_head2</title>
<path fill="none" stroke="black" d="M122086.99,-2512.49C122074.76,-2486.47 122053.71,-2452 122023,-2436 121932.98,-2389.11 107508.42,-2404.03 107407,-2400 107210.7,-2392.21 106982.99,-2372.42 106848.56,-2359.63"/>
<polygon fill="black" stroke="black" points="106848.53,-2356.11 106838.24,-2358.64 106847.87,-2363.08 106848.53,-2356.11"/>
</g>
<!-- L3_expert5_gate_9 -->
<g id="node434" class="node">
<title>L3_expert5_gate_9</title>
<polygon fill="none" stroke="black" points="119070,-2599.5 118952,-2546.5 119070,-2493.5 119188,-2546.5 119070,-2599.5"/>
<text text-anchor="middle" x="119070" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="119070" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="119070" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert4_ffn1_9 -->
<g id="node435" class="node">
<title>L4_expert4_ffn1_9</title>
<polygon fill="none" stroke="black" points="118934,-2580.5 118798,-2580.5 118798,-2512.5 118934,-2512.5 118934,-2580.5"/>
<text text-anchor="middle" x="118866" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN1</text>
<text text-anchor="middle" x="118866" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="118866" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="118866" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert4_ffn2_9 -->
<g id="node436" class="node">
<title>L4_expert4_ffn2_9</title>
<polygon fill="none" stroke="black" points="124962,-2580.5 124826,-2580.5 124826,-2512.5 124962,-2512.5 124962,-2580.5"/>
<text text-anchor="middle" x="124894" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN2</text>
<text text-anchor="middle" x="124894" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="124894" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="124894" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert4_ffn2_9&#45;&gt;L4_expert_concat_head2 -->
<g id="edge119" class="edge">
<title>L4_expert4_ffn2_9&#45;&gt;L4_expert_concat_head2</title>
<path fill="none" stroke="black" d="M124880.85,-2512.25C124868.59,-2486.28 124847.58,-2451.99 124817,-2436 124635.93,-2341.32 110921.66,-2346.96 109361.94,-2347.9"/>
<polygon fill="black" stroke="black" points="109361.81,-2344.4 109351.81,-2347.91 109361.81,-2351.4 109361.81,-2344.4"/>
</g>
<!-- L4_expert4_gate_9 -->
<g id="node437" class="node">
<title>L4_expert4_gate_9</title>
<polygon fill="none" stroke="black" points="118508,-2599.5 118390,-2546.5 118508,-2493.5 118626,-2546.5 118508,-2599.5"/>
<text text-anchor="middle" x="118508" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="118508" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="118508" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert5_ffn1_9 -->
<g id="node438" class="node">
<title>L4_expert5_ffn1_9</title>
<polygon fill="none" stroke="black" points="118372,-2580.5 118236,-2580.5 118236,-2512.5 118372,-2512.5 118372,-2580.5"/>
<text text-anchor="middle" x="118304" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN1</text>
<text text-anchor="middle" x="118304" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="118304" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="118304" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert5_ffn2_9 -->
<g id="node439" class="node">
<title>L4_expert5_ffn2_9</title>
<polygon fill="none" stroke="black" points="124136,-2580.5 124000,-2580.5 124000,-2512.5 124136,-2512.5 124136,-2580.5"/>
<text text-anchor="middle" x="124068" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN2</text>
<text text-anchor="middle" x="124068" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="124068" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="124068" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert5_ffn2_9&#45;&gt;L4_expert_concat_head2 -->
<g id="edge120" class="edge">
<title>L4_expert5_ffn2_9&#45;&gt;L4_expert_concat_head2</title>
<path fill="none" stroke="black" d="M124054.85,-2512.25C124042.59,-2486.28 124021.58,-2452 123991,-2436 123819.82,-2346.46 110874.94,-2347.52 109361.84,-2347.95"/>
<polygon fill="black" stroke="black" points="109361.74,-2344.45 109351.74,-2347.95 109361.74,-2351.45 109361.74,-2344.45"/>
</g>
<!-- L4_expert5_gate_9 -->
<g id="node440" class="node">
<title>L4_expert5_gate_9</title>
<polygon fill="none" stroke="black" points="117938,-2599.5 117820,-2546.5 117938,-2493.5 118056,-2546.5 117938,-2599.5"/>
<text text-anchor="middle" x="117938" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="117938" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="117938" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_Q_proj_10 -->
<g id="node441" class="node">
<title>L1_Q_proj_10</title>
<polygon fill="none" stroke="black" points="102120,-2580.5 101984,-2580.5 101984,-2512.5 102120,-2512.5 102120,-2580.5"/>
<text text-anchor="middle" x="102052" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="102052" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="102052" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="102052" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_K_proj_10 -->
<g id="node442" class="node">
<title>L1_K_proj_10</title>
<polygon fill="none" stroke="black" points="101966,-2580.5 101830,-2580.5 101830,-2512.5 101966,-2512.5 101966,-2580.5"/>
<text text-anchor="middle" x="101898" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="101898" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="101898" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="101898" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_V_proj_10 -->
<g id="node443" class="node">
<title>L1_V_proj_10</title>
<polygon fill="none" stroke="black" points="101812,-2580.5 101676,-2580.5 101676,-2512.5 101812,-2512.5 101812,-2580.5"/>
<text text-anchor="middle" x="101744" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="101744" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="101744" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="101744" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_attention_10 -->
<g id="node444" class="node">
<title>L1_attention_10</title>
<ellipse fill="none" stroke="black" cx="101562" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="101562" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="101562" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="101562" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="101562" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_10 -->
<g id="node445" class="node">
<title>L1_out_proj_10</title>
<polygon fill="none" stroke="black" points="94704,-2580.5 94560,-2580.5 94560,-2512.5 94704,-2512.5 94704,-2580.5"/>
<text text-anchor="middle" x="94632" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="94632" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="94632" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="94632" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_10&#45;&gt;L1_concat_dim_head2 -->
<g id="edge121" class="edge">
<title>L1_out_proj_10&#45;&gt;L1_concat_dim_head2</title>
<path fill="none" stroke="black" d="M94646.31,-2512.25C94659.49,-2486.27 94681.73,-2451.99 94713,-2436 94888.61,-2346.21 101241.34,-2347.07 102316.25,-2347.85"/>
<polygon fill="black" stroke="black" points="102316.36,-2351.35 102326.36,-2347.86 102316.36,-2344.35 102316.36,-2351.35"/>
</g>
<!-- L2_Q_proj_10 -->
<g id="node446" class="node">
<title>L2_Q_proj_10</title>
<polygon fill="none" stroke="black" points="101294,-2580.5 101158,-2580.5 101158,-2512.5 101294,-2512.5 101294,-2580.5"/>
<text text-anchor="middle" x="101226" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="101226" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="101226" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="101226" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_K_proj_10 -->
<g id="node447" class="node">
<title>L2_K_proj_10</title>
<polygon fill="none" stroke="black" points="101140,-2580.5 101004,-2580.5 101004,-2512.5 101140,-2512.5 101140,-2580.5"/>
<text text-anchor="middle" x="101072" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="101072" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="101072" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="101072" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_V_proj_10 -->
<g id="node448" class="node">
<title>L2_V_proj_10</title>
<polygon fill="none" stroke="black" points="100986,-2580.5 100850,-2580.5 100850,-2512.5 100986,-2512.5 100986,-2580.5"/>
<text text-anchor="middle" x="100918" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="100918" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="100918" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="100918" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_attention_10 -->
<g id="node449" class="node">
<title>L2_attention_10</title>
<ellipse fill="none" stroke="black" cx="100736" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="100736" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="100736" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="100736" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="100736" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_10 -->
<g id="node450" class="node">
<title>L2_out_proj_10</title>
<polygon fill="none" stroke="black" points="96398,-2580.5 96254,-2580.5 96254,-2512.5 96398,-2512.5 96398,-2580.5"/>
<text text-anchor="middle" x="96326" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="96326" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="96326" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="96326" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_10&#45;&gt;L2_concat_dim_head2 -->
<g id="edge122" class="edge">
<title>L2_out_proj_10&#45;&gt;L2_concat_dim_head2</title>
<path fill="none" stroke="black" d="M96340.15,-2512.46C96353.29,-2486.42 96375.58,-2451.94 96407,-2436 96497.87,-2389.91 103641.32,-2406.51 103743,-2400 103849.04,-2393.21 103969.29,-2377.56 104054.04,-2365.19"/>
<polygon fill="black" stroke="black" points="104054.55,-2368.65 104063.94,-2363.73 104053.54,-2361.72 104054.55,-2368.65"/>
</g>
<!-- L3_Q_proj_10 -->
<g id="node451" class="node">
<title>L3_Q_proj_10</title>
<polygon fill="none" stroke="black" points="100468,-2580.5 100332,-2580.5 100332,-2512.5 100468,-2512.5 100468,-2580.5"/>
<text text-anchor="middle" x="100400" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="100400" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="100400" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="100400" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_K_proj_10 -->
<g id="node452" class="node">
<title>L3_K_proj_10</title>
<polygon fill="none" stroke="black" points="100314,-2580.5 100178,-2580.5 100178,-2512.5 100314,-2512.5 100314,-2580.5"/>
<text text-anchor="middle" x="100246" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="100246" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="100246" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="100246" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_V_proj_10 -->
<g id="node453" class="node">
<title>L3_V_proj_10</title>
<polygon fill="none" stroke="black" points="100160,-2580.5 100024,-2580.5 100024,-2512.5 100160,-2512.5 100160,-2580.5"/>
<text text-anchor="middle" x="100092" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="100092" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="100092" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="100092" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_attention_10 -->
<g id="node454" class="node">
<title>L3_attention_10</title>
<ellipse fill="none" stroke="black" cx="99910" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="99910" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="99910" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="99910" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="99910" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_10 -->
<g id="node455" class="node">
<title>L3_out_proj_10</title>
<polygon fill="none" stroke="black" points="98092,-2580.5 97948,-2580.5 97948,-2512.5 98092,-2512.5 98092,-2580.5"/>
<text text-anchor="middle" x="98020" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="98020" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="98020" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="98020" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_10&#45;&gt;L3_concat_dim_head2 -->
<g id="edge123" class="edge">
<title>L3_out_proj_10&#45;&gt;L3_concat_dim_head2</title>
<path fill="none" stroke="black" d="M98034.15,-2512.46C98047.29,-2486.42 98069.58,-2451.94 98101,-2436 98191.87,-2389.91 105335.32,-2406.51 105437,-2400 105543.04,-2393.21 105663.29,-2377.56 105748.04,-2365.19"/>
<polygon fill="black" stroke="black" points="105748.55,-2368.65 105757.94,-2363.73 105747.54,-2361.72 105748.55,-2368.65"/>
</g>
<!-- L4_Q_proj_10 -->
<g id="node456" class="node">
<title>L4_Q_proj_10</title>
<polygon fill="none" stroke="black" points="99634,-2580.5 99498,-2580.5 99498,-2512.5 99634,-2512.5 99634,-2580.5"/>
<text text-anchor="middle" x="99566" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="99566" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="99566" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="99566" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_K_proj_10 -->
<g id="node457" class="node">
<title>L4_K_proj_10</title>
<polygon fill="none" stroke="black" points="99480,-2580.5 99344,-2580.5 99344,-2512.5 99480,-2512.5 99480,-2580.5"/>
<text text-anchor="middle" x="99412" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="99412" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="99412" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="99412" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_V_proj_10 -->
<g id="node458" class="node">
<title>L4_V_proj_10</title>
<polygon fill="none" stroke="black" points="99326,-2580.5 99190,-2580.5 99190,-2512.5 99326,-2512.5 99326,-2580.5"/>
<text text-anchor="middle" x="99258" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="99258" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="99258" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="99258" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_attention_10 -->
<g id="node459" class="node">
<title>L4_attention_10</title>
<ellipse fill="none" stroke="black" cx="99076" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="99076" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="99076" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="99076" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="99076" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_10 -->
<g id="node460" class="node">
<title>L4_out_proj_10</title>
<polygon fill="none" stroke="black" points="99796,-2580.5 99652,-2580.5 99652,-2512.5 99796,-2512.5 99796,-2580.5"/>
<text text-anchor="middle" x="99724" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="99724" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="99724" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="99724" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_10&#45;&gt;L4_concat_dim_head2 -->
<g id="edge124" class="edge">
<title>L4_out_proj_10&#45;&gt;L4_concat_dim_head2</title>
<path fill="none" stroke="black" d="M99738.16,-2512.46C99751.29,-2486.42 99773.58,-2451.94 99805,-2436 99892.6,-2391.56 106778.86,-2403.97 106877,-2400 107073.91,-2392.03 107302.02,-2372.69 107439,-2359.97"/>
<polygon fill="black" stroke="black" points="107439.48,-2363.44 107449.11,-2359.03 107438.83,-2356.47 107439.48,-2363.44"/>
</g>
<!-- L1_expert4_ffn1_10 -->
<g id="node461" class="node">
<title>L1_expert4_ffn1_10</title>
<polygon fill="none" stroke="black" points="98808,-2580.5 98672,-2580.5 98672,-2512.5 98808,-2512.5 98808,-2580.5"/>
<text text-anchor="middle" x="98740" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN1</text>
<text text-anchor="middle" x="98740" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="98740" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="98740" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert4_ffn2_10 -->
<g id="node462" class="node">
<title>L1_expert4_ffn2_10</title>
<polygon fill="none" stroke="black" points="95828,-2580.5 95692,-2580.5 95692,-2512.5 95828,-2512.5 95828,-2580.5"/>
<text text-anchor="middle" x="95760" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN2</text>
<text text-anchor="middle" x="95760" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="95760" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="95760" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert4_ffn2_10&#45;&gt;L1_expert_concat_head2 -->
<g id="edge125" class="edge">
<title>L1_expert4_ffn2_10&#45;&gt;L1_expert_concat_head2</title>
<path fill="none" stroke="black" d="M95773.15,-2512.25C95785.4,-2486.27 95806.41,-2451.99 95837,-2436 95920.55,-2392.33 102530.76,-2402.77 102625,-2400 102930.72,-2391.03 103289.93,-2368.79 103474.58,-2356.5"/>
<polygon fill="black" stroke="black" points="103474.85,-2359.99 103484.6,-2355.83 103474.39,-2353.01 103474.85,-2359.99"/>
</g>
<!-- L1_expert4_gate_10 -->
<g id="node463" class="node">
<title>L1_expert4_gate_10</title>
<polygon fill="none" stroke="black" points="98382,-2599.5 98264,-2546.5 98382,-2493.5 98500,-2546.5 98382,-2599.5"/>
<text text-anchor="middle" x="98382" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="98382" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="98382" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_expert5_ffn1_10 -->
<g id="node464" class="node">
<title>L1_expert5_ffn1_10</title>
<polygon fill="none" stroke="black" points="98246,-2580.5 98110,-2580.5 98110,-2512.5 98246,-2512.5 98246,-2580.5"/>
<text text-anchor="middle" x="98178" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN1</text>
<text text-anchor="middle" x="98178" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="98178" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="98178" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert5_ffn2_10 -->
<g id="node465" class="node">
<title>L1_expert5_ffn2_10</title>
<polygon fill="none" stroke="black" points="95266,-2580.5 95130,-2580.5 95130,-2512.5 95266,-2512.5 95266,-2580.5"/>
<text text-anchor="middle" x="95198" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN2</text>
<text text-anchor="middle" x="95198" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="95198" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="95198" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert5_ffn2_10&#45;&gt;L1_expert_concat_head2 -->
<g id="edge126" class="edge">
<title>L1_expert5_ffn2_10&#45;&gt;L1_expert_concat_head2</title>
<path fill="none" stroke="black" d="M95211.15,-2512.24C95223.4,-2486.27 95244.41,-2451.98 95275,-2436 95365.48,-2388.73 102522.96,-2402.97 102625,-2400 102930.72,-2391.09 103289.93,-2368.83 103474.58,-2356.52"/>
<polygon fill="black" stroke="black" points="103474.85,-2360.01 103484.6,-2355.85 103474.39,-2353.02 103474.85,-2360.01"/>
</g>
<!-- L1_expert5_gate_10 -->
<g id="node466" class="node">
<title>L1_expert5_gate_10</title>
<polygon fill="none" stroke="black" points="97812,-2599.5 97694,-2546.5 97812,-2493.5 97930,-2546.5 97812,-2599.5"/>
<text text-anchor="middle" x="97812" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="97812" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="97812" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert4_ffn1_10 -->
<g id="node467" class="node">
<title>L2_expert4_ffn1_10</title>
<polygon fill="none" stroke="black" points="97676,-2580.5 97540,-2580.5 97540,-2512.5 97676,-2512.5 97676,-2580.5"/>
<text text-anchor="middle" x="97608" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN1</text>
<text text-anchor="middle" x="97608" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="97608" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="97608" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert4_ffn2_10 -->
<g id="node468" class="node">
<title>L2_expert4_ffn2_10</title>
<polygon fill="none" stroke="black" points="97522,-2580.5 97386,-2580.5 97386,-2512.5 97522,-2512.5 97522,-2580.5"/>
<text text-anchor="middle" x="97454" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN2</text>
<text text-anchor="middle" x="97454" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="97454" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="97454" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert4_ffn2_10&#45;&gt;L2_expert_concat_head2 -->
<g id="edge127" class="edge">
<title>L2_expert4_ffn2_10&#45;&gt;L2_expert_concat_head2</title>
<path fill="none" stroke="black" d="M97467.15,-2512.25C97479.4,-2486.27 97500.41,-2451.99 97531,-2436 97614.55,-2392.33 104224.76,-2402.77 104319,-2400 104624.72,-2391.03 104983.93,-2368.79 105168.58,-2356.5"/>
<polygon fill="black" stroke="black" points="105168.85,-2359.99 105178.6,-2355.83 105168.39,-2353.01 105168.85,-2359.99"/>
</g>
<!-- L2_expert4_gate_10 -->
<g id="node469" class="node">
<title>L2_expert4_gate_10</title>
<polygon fill="none" stroke="black" points="97250,-2599.5 97132,-2546.5 97250,-2493.5 97368,-2546.5 97250,-2599.5"/>
<text text-anchor="middle" x="97250" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="97250" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="97250" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert5_ffn1_10 -->
<g id="node470" class="node">
<title>L2_expert5_ffn1_10</title>
<polygon fill="none" stroke="black" points="97114,-2580.5 96978,-2580.5 96978,-2512.5 97114,-2512.5 97114,-2580.5"/>
<text text-anchor="middle" x="97046" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN1</text>
<text text-anchor="middle" x="97046" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="97046" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="97046" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert5_ffn2_10 -->
<g id="node471" class="node">
<title>L2_expert5_ffn2_10</title>
<polygon fill="none" stroke="black" points="96960,-2580.5 96824,-2580.5 96824,-2512.5 96960,-2512.5 96960,-2580.5"/>
<text text-anchor="middle" x="96892" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN2</text>
<text text-anchor="middle" x="96892" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="96892" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="96892" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert5_ffn2_10&#45;&gt;L2_expert_concat_head2 -->
<g id="edge128" class="edge">
<title>L2_expert5_ffn2_10&#45;&gt;L2_expert_concat_head2</title>
<path fill="none" stroke="black" d="M96905.15,-2512.24C96917.4,-2486.27 96938.41,-2451.98 96969,-2436 97059.48,-2388.73 104216.96,-2402.97 104319,-2400 104624.72,-2391.09 104983.93,-2368.83 105168.58,-2356.52"/>
<polygon fill="black" stroke="black" points="105168.85,-2360.01 105178.6,-2355.85 105168.39,-2353.02 105168.85,-2360.01"/>
</g>
<!-- L2_expert5_gate_10 -->
<g id="node472" class="node">
<title>L2_expert5_gate_10</title>
<polygon fill="none" stroke="black" points="96688,-2599.5 96570,-2546.5 96688,-2493.5 96806,-2546.5 96688,-2599.5"/>
<text text-anchor="middle" x="96688" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="96688" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="96688" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert4_ffn1_10 -->
<g id="node473" class="node">
<title>L3_expert4_ffn1_10</title>
<polygon fill="none" stroke="black" points="96552,-2580.5 96416,-2580.5 96416,-2512.5 96552,-2512.5 96552,-2580.5"/>
<text text-anchor="middle" x="96484" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN1</text>
<text text-anchor="middle" x="96484" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="96484" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="96484" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert4_ffn2_10 -->
<g id="node474" class="node">
<title>L3_expert4_ffn2_10</title>
<polygon fill="none" stroke="black" points="98962,-2580.5 98826,-2580.5 98826,-2512.5 98962,-2512.5 98962,-2580.5"/>
<text text-anchor="middle" x="98894" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN2</text>
<text text-anchor="middle" x="98894" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="98894" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="98894" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert4_ffn2_10&#45;&gt;L3_expert_concat_head2 -->
<g id="edge129" class="edge">
<title>L3_expert4_ffn2_10&#45;&gt;L3_expert_concat_head2</title>
<path fill="none" stroke="black" d="M98907.15,-2512.25C98919.4,-2486.27 98940.41,-2451.98 98971,-2436 99057.69,-2390.7 105915.27,-2403.78 106013,-2400 106225.2,-2391.79 106471.97,-2371.62 106614.26,-2358.95"/>
<polygon fill="black" stroke="black" points="106614.67,-2362.43 106624.32,-2358.05 106614.05,-2355.46 106614.67,-2362.43"/>
</g>
<!-- L3_expert4_gate_10 -->
<g id="node475" class="node">
<title>L3_expert4_gate_10</title>
<polygon fill="none" stroke="black" points="96118,-2599.5 96000,-2546.5 96118,-2493.5 96236,-2546.5 96118,-2599.5"/>
<text text-anchor="middle" x="96118" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="96118" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="96118" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert5_ffn1_10 -->
<g id="node476" class="node">
<title>L3_expert5_ffn1_10</title>
<polygon fill="none" stroke="black" points="95982,-2580.5 95846,-2580.5 95846,-2512.5 95982,-2512.5 95982,-2580.5"/>
<text text-anchor="middle" x="95914" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN1</text>
<text text-anchor="middle" x="95914" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="95914" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="95914" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert5_ffn2_10 -->
<g id="node477" class="node">
<title>L3_expert5_ffn2_10</title>
<polygon fill="none" stroke="black" points="98654,-2580.5 98518,-2580.5 98518,-2512.5 98654,-2512.5 98654,-2580.5"/>
<text text-anchor="middle" x="98586" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN2</text>
<text text-anchor="middle" x="98586" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="98586" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="98586" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert5_ffn2_10&#45;&gt;L3_expert_concat_head2 -->
<g id="edge130" class="edge">
<title>L3_expert5_ffn2_10&#45;&gt;L3_expert_concat_head2</title>
<path fill="none" stroke="black" d="M98599.15,-2512.24C98611.4,-2486.27 98632.41,-2451.98 98663,-2436 98753.48,-2388.73 105910.99,-2403.93 106013,-2400 106225.2,-2391.82 106471.97,-2371.64 106614.26,-2358.96"/>
<polygon fill="black" stroke="black" points="106614.67,-2362.44 106624.32,-2358.06 106614.05,-2355.46 106614.67,-2362.44"/>
</g>
<!-- L3_expert5_gate_10 -->
<g id="node478" class="node">
<title>L3_expert5_gate_10</title>
<polygon fill="none" stroke="black" points="95556,-2599.5 95438,-2546.5 95556,-2493.5 95674,-2546.5 95556,-2599.5"/>
<text text-anchor="middle" x="95556" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="95556" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="95556" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert4_ffn1_10 -->
<g id="node479" class="node">
<title>L4_expert4_ffn1_10</title>
<polygon fill="none" stroke="black" points="95420,-2580.5 95284,-2580.5 95284,-2512.5 95420,-2512.5 95420,-2580.5"/>
<text text-anchor="middle" x="95352" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN1</text>
<text text-anchor="middle" x="95352" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="95352" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="95352" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert4_ffn2_10 -->
<g id="node480" class="node">
<title>L4_expert4_ffn2_10</title>
<polygon fill="none" stroke="black" points="101448,-2580.5 101312,-2580.5 101312,-2512.5 101448,-2512.5 101448,-2580.5"/>
<text text-anchor="middle" x="101380" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN2</text>
<text text-anchor="middle" x="101380" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="101380" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="101380" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert4_ffn2_10&#45;&gt;L4_expert_concat_head2 -->
<g id="edge131" class="edge">
<title>L4_expert4_ffn2_10&#45;&gt;L4_expert_concat_head2</title>
<path fill="none" stroke="black" d="M101393.15,-2512.25C101405.41,-2486.28 101426.42,-2451.99 101457,-2436 101534.05,-2395.71 107630.07,-2401.76 107717,-2400 108224.12,-2389.76 108827.23,-2365.06 109087.64,-2353.78"/>
<polygon fill="black" stroke="black" points="109088.05,-2357.27 109097.89,-2353.34 109087.75,-2350.28 109088.05,-2357.27"/>
</g>
<!-- L4_expert4_gate_10 -->
<g id="node481" class="node">
<title>L4_expert4_gate_10</title>
<polygon fill="none" stroke="black" points="94994,-2599.5 94876,-2546.5 94994,-2493.5 95112,-2546.5 94994,-2599.5"/>
<text text-anchor="middle" x="94994" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="94994" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="94994" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert5_ffn1_10 -->
<g id="node482" class="node">
<title>L4_expert5_ffn1_10</title>
<polygon fill="none" stroke="black" points="94858,-2580.5 94722,-2580.5 94722,-2512.5 94858,-2512.5 94858,-2580.5"/>
<text text-anchor="middle" x="94790" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN1</text>
<text text-anchor="middle" x="94790" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="94790" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="94790" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert5_ffn2_10 -->
<g id="node483" class="node">
<title>L4_expert5_ffn2_10</title>
<polygon fill="none" stroke="black" points="100622,-2580.5 100486,-2580.5 100486,-2512.5 100622,-2512.5 100622,-2580.5"/>
<text text-anchor="middle" x="100554" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN2</text>
<text text-anchor="middle" x="100554" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="100554" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="100554" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert5_ffn2_10&#45;&gt;L4_expert_concat_head2 -->
<g id="edge132" class="edge">
<title>L4_expert5_ffn2_10&#45;&gt;L4_expert_concat_head2</title>
<path fill="none" stroke="black" d="M100567.15,-2512.25C100579.4,-2486.27 100600.41,-2451.98 100631,-2436 100718.23,-2390.42 107618.6,-2401.95 107717,-2400 108224.12,-2389.93 108827.23,-2365.14 109087.64,-2353.81"/>
<polygon fill="black" stroke="black" points="109088.05,-2357.3 109097.89,-2353.37 109087.75,-2350.31 109088.05,-2357.3"/>
</g>
<!-- L4_expert5_gate_10 -->
<g id="node484" class="node">
<title>L4_expert5_gate_10</title>
<polygon fill="none" stroke="black" points="94424,-2599.5 94306,-2546.5 94424,-2493.5 94542,-2546.5 94424,-2599.5"/>
<text text-anchor="middle" x="94424" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="94424" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="94424" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_Q_proj_11 -->
<g id="node485" class="node">
<title>L1_Q_proj_11</title>
<polygon fill="none" stroke="black" points="109958,-2580.5 109822,-2580.5 109822,-2512.5 109958,-2512.5 109958,-2580.5"/>
<text text-anchor="middle" x="109890" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="109890" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="109890" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="109890" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_K_proj_11 -->
<g id="node486" class="node">
<title>L1_K_proj_11</title>
<polygon fill="none" stroke="black" points="109804,-2580.5 109668,-2580.5 109668,-2512.5 109804,-2512.5 109804,-2580.5"/>
<text text-anchor="middle" x="109736" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="109736" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="109736" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="109736" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_V_proj_11 -->
<g id="node487" class="node">
<title>L1_V_proj_11</title>
<polygon fill="none" stroke="black" points="109650,-2580.5 109514,-2580.5 109514,-2512.5 109650,-2512.5 109650,-2580.5"/>
<text text-anchor="middle" x="109582" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="109582" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="109582" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="109582" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_attention_11 -->
<g id="node488" class="node">
<title>L1_attention_11</title>
<ellipse fill="none" stroke="black" cx="109400" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="109400" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="109400" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="109400" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="109400" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_11 -->
<g id="node489" class="node">
<title>L1_out_proj_11</title>
<polygon fill="none" stroke="black" points="102542,-2580.5 102398,-2580.5 102398,-2512.5 102542,-2512.5 102542,-2580.5"/>
<text text-anchor="middle" x="102470" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="102470" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="102470" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="102470" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_11&#45;&gt;L1_concat_dim_head2 -->
<g id="edge133" class="edge">
<title>L1_out_proj_11&#45;&gt;L1_concat_dim_head2</title>
<path fill="none" stroke="black" d="M102470,-2512.44C102470,-2484.68 102470,-2444.23 102470,-2410.4"/>
<polygon fill="black" stroke="black" points="102473.5,-2410.14 102470,-2400.14 102466.5,-2410.14 102473.5,-2410.14"/>
</g>
<!-- L2_Q_proj_11 -->
<g id="node490" class="node">
<title>L2_Q_proj_11</title>
<polygon fill="none" stroke="black" points="109132,-2580.5 108996,-2580.5 108996,-2512.5 109132,-2512.5 109132,-2580.5"/>
<text text-anchor="middle" x="109064" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="109064" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="109064" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="109064" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_K_proj_11 -->
<g id="node491" class="node">
<title>L2_K_proj_11</title>
<polygon fill="none" stroke="black" points="108978,-2580.5 108842,-2580.5 108842,-2512.5 108978,-2512.5 108978,-2580.5"/>
<text text-anchor="middle" x="108910" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="108910" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="108910" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="108910" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_V_proj_11 -->
<g id="node492" class="node">
<title>L2_V_proj_11</title>
<polygon fill="none" stroke="black" points="108824,-2580.5 108688,-2580.5 108688,-2512.5 108824,-2512.5 108824,-2580.5"/>
<text text-anchor="middle" x="108756" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="108756" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="108756" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="108756" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_attention_11 -->
<g id="node493" class="node">
<title>L2_attention_11</title>
<ellipse fill="none" stroke="black" cx="108574" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="108574" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="108574" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="108574" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="108574" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_11 -->
<g id="node494" class="node">
<title>L2_out_proj_11</title>
<polygon fill="none" stroke="black" points="104236,-2580.5 104092,-2580.5 104092,-2512.5 104236,-2512.5 104236,-2580.5"/>
<text text-anchor="middle" x="104164" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="104164" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="104164" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="104164" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_11&#45;&gt;L2_concat_dim_head2 -->
<g id="edge134" class="edge">
<title>L2_out_proj_11&#45;&gt;L2_concat_dim_head2</title>
<path fill="none" stroke="black" d="M104164,-2512.44C104164,-2484.68 104164,-2444.23 104164,-2410.4"/>
<polygon fill="black" stroke="black" points="104167.5,-2410.14 104164,-2400.14 104160.5,-2410.14 104167.5,-2410.14"/>
</g>
<!-- L3_Q_proj_11 -->
<g id="node495" class="node">
<title>L3_Q_proj_11</title>
<polygon fill="none" stroke="black" points="108306,-2580.5 108170,-2580.5 108170,-2512.5 108306,-2512.5 108306,-2580.5"/>
<text text-anchor="middle" x="108238" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="108238" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="108238" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="108238" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_K_proj_11 -->
<g id="node496" class="node">
<title>L3_K_proj_11</title>
<polygon fill="none" stroke="black" points="108152,-2580.5 108016,-2580.5 108016,-2512.5 108152,-2512.5 108152,-2580.5"/>
<text text-anchor="middle" x="108084" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="108084" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="108084" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="108084" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_V_proj_11 -->
<g id="node497" class="node">
<title>L3_V_proj_11</title>
<polygon fill="none" stroke="black" points="107998,-2580.5 107862,-2580.5 107862,-2512.5 107998,-2512.5 107998,-2580.5"/>
<text text-anchor="middle" x="107930" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="107930" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="107930" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="107930" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_attention_11 -->
<g id="node498" class="node">
<title>L3_attention_11</title>
<ellipse fill="none" stroke="black" cx="107748" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="107748" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="107748" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="107748" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="107748" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_11 -->
<g id="node499" class="node">
<title>L3_out_proj_11</title>
<polygon fill="none" stroke="black" points="105930,-2580.5 105786,-2580.5 105786,-2512.5 105930,-2512.5 105930,-2580.5"/>
<text text-anchor="middle" x="105858" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="105858" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="105858" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="105858" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_11&#45;&gt;L3_concat_dim_head2 -->
<g id="edge135" class="edge">
<title>L3_out_proj_11&#45;&gt;L3_concat_dim_head2</title>
<path fill="none" stroke="black" d="M105858,-2512.44C105858,-2484.68 105858,-2444.23 105858,-2410.4"/>
<polygon fill="black" stroke="black" points="105861.5,-2410.14 105858,-2400.14 105854.5,-2410.14 105861.5,-2410.14"/>
</g>
<!-- L4_Q_proj_11 -->
<g id="node500" class="node">
<title>L4_Q_proj_11</title>
<polygon fill="none" stroke="black" points="107472,-2580.5 107336,-2580.5 107336,-2512.5 107472,-2512.5 107472,-2580.5"/>
<text text-anchor="middle" x="107404" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="107404" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="107404" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="107404" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_K_proj_11 -->
<g id="node501" class="node">
<title>L4_K_proj_11</title>
<polygon fill="none" stroke="black" points="107318,-2580.5 107182,-2580.5 107182,-2512.5 107318,-2512.5 107318,-2580.5"/>
<text text-anchor="middle" x="107250" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="107250" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="107250" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="107250" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_V_proj_11 -->
<g id="node502" class="node">
<title>L4_V_proj_11</title>
<polygon fill="none" stroke="black" points="107164,-2580.5 107028,-2580.5 107028,-2512.5 107164,-2512.5 107164,-2580.5"/>
<text text-anchor="middle" x="107096" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="107096" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="107096" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="107096" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_attention_11 -->
<g id="node503" class="node">
<title>L4_attention_11</title>
<ellipse fill="none" stroke="black" cx="106914" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="106914" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="106914" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="106914" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="106914" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_11 -->
<g id="node504" class="node">
<title>L4_out_proj_11</title>
<polygon fill="none" stroke="black" points="107634,-2580.5 107490,-2580.5 107490,-2512.5 107634,-2512.5 107634,-2580.5"/>
<text text-anchor="middle" x="107562" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="107562" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="107562" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="107562" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_11&#45;&gt;L4_concat_dim_head2 -->
<g id="edge136" class="edge">
<title>L4_out_proj_11&#45;&gt;L4_concat_dim_head2</title>
<path fill="none" stroke="black" d="M107562,-2512.44C107562,-2484.68 107562,-2444.23 107562,-2410.4"/>
<polygon fill="black" stroke="black" points="107565.5,-2410.14 107562,-2400.14 107558.5,-2410.14 107565.5,-2410.14"/>
</g>
<!-- L1_expert4_ffn1_11 -->
<g id="node505" class="node">
<title>L1_expert4_ffn1_11</title>
<polygon fill="none" stroke="black" points="106646,-2580.5 106510,-2580.5 106510,-2512.5 106646,-2512.5 106646,-2580.5"/>
<text text-anchor="middle" x="106578" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN1</text>
<text text-anchor="middle" x="106578" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="106578" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="106578" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert4_ffn2_11 -->
<g id="node506" class="node">
<title>L1_expert4_ffn2_11</title>
<polygon fill="none" stroke="black" points="103666,-2580.5 103530,-2580.5 103530,-2512.5 103666,-2512.5 103666,-2580.5"/>
<text text-anchor="middle" x="103598" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN2</text>
<text text-anchor="middle" x="103598" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="103598" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="103598" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert4_ffn2_11&#45;&gt;L1_expert_concat_head2 -->
<g id="edge137" class="edge">
<title>L1_expert4_ffn2_11&#45;&gt;L1_expert_concat_head2</title>
<path fill="none" stroke="black" d="M103598,-2512.44C103598,-2484.68 103598,-2444.23 103598,-2410.4"/>
<polygon fill="black" stroke="black" points="103601.5,-2410.14 103598,-2400.14 103594.5,-2410.14 103601.5,-2410.14"/>
</g>
<!-- L1_expert4_gate_11 -->
<g id="node507" class="node">
<title>L1_expert4_gate_11</title>
<polygon fill="none" stroke="black" points="106220,-2599.5 106102,-2546.5 106220,-2493.5 106338,-2546.5 106220,-2599.5"/>
<text text-anchor="middle" x="106220" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="106220" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="106220" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_expert5_ffn1_11 -->
<g id="node508" class="node">
<title>L1_expert5_ffn1_11</title>
<polygon fill="none" stroke="black" points="106084,-2580.5 105948,-2580.5 105948,-2512.5 106084,-2512.5 106084,-2580.5"/>
<text text-anchor="middle" x="106016" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN1</text>
<text text-anchor="middle" x="106016" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="106016" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="106016" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert5_ffn2_11 -->
<g id="node509" class="node">
<title>L1_expert5_ffn2_11</title>
<polygon fill="none" stroke="black" points="103104,-2580.5 102968,-2580.5 102968,-2512.5 103104,-2512.5 103104,-2580.5"/>
<text text-anchor="middle" x="103036" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN2</text>
<text text-anchor="middle" x="103036" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="103036" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="103036" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert5_ffn2_11&#45;&gt;L1_expert_concat_head2 -->
<g id="edge138" class="edge">
<title>L1_expert5_ffn2_11&#45;&gt;L1_expert_concat_head2</title>
<path fill="none" stroke="black" d="M103050.6,-2512.34C103063.39,-2487.32 103084.41,-2454.27 103113,-2436 103172.4,-2398.04 103356.2,-2372.49 103479.69,-2359.1"/>
<polygon fill="black" stroke="black" points="103480.39,-2362.55 103489.96,-2358 103479.64,-2355.59 103480.39,-2362.55"/>
</g>
<!-- L1_expert5_gate_11 -->
<g id="node510" class="node">
<title>L1_expert5_gate_11</title>
<polygon fill="none" stroke="black" points="105650,-2599.5 105532,-2546.5 105650,-2493.5 105768,-2546.5 105650,-2599.5"/>
<text text-anchor="middle" x="105650" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="105650" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="105650" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert4_ffn1_11 -->
<g id="node511" class="node">
<title>L2_expert4_ffn1_11</title>
<polygon fill="none" stroke="black" points="105514,-2580.5 105378,-2580.5 105378,-2512.5 105514,-2512.5 105514,-2580.5"/>
<text text-anchor="middle" x="105446" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN1</text>
<text text-anchor="middle" x="105446" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="105446" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="105446" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert4_ffn2_11 -->
<g id="node512" class="node">
<title>L2_expert4_ffn2_11</title>
<polygon fill="none" stroke="black" points="105360,-2580.5 105224,-2580.5 105224,-2512.5 105360,-2512.5 105360,-2580.5"/>
<text text-anchor="middle" x="105292" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN2</text>
<text text-anchor="middle" x="105292" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="105292" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="105292" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert4_ffn2_11&#45;&gt;L2_expert_concat_head2 -->
<g id="edge139" class="edge">
<title>L2_expert4_ffn2_11&#45;&gt;L2_expert_concat_head2</title>
<path fill="none" stroke="black" d="M105292,-2512.44C105292,-2484.68 105292,-2444.23 105292,-2410.4"/>
<polygon fill="black" stroke="black" points="105295.5,-2410.14 105292,-2400.14 105288.5,-2410.14 105295.5,-2410.14"/>
</g>
<!-- L2_expert4_gate_11 -->
<g id="node513" class="node">
<title>L2_expert4_gate_11</title>
<polygon fill="none" stroke="black" points="105088,-2599.5 104970,-2546.5 105088,-2493.5 105206,-2546.5 105088,-2599.5"/>
<text text-anchor="middle" x="105088" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="105088" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="105088" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert5_ffn1_11 -->
<g id="node514" class="node">
<title>L2_expert5_ffn1_11</title>
<polygon fill="none" stroke="black" points="104952,-2580.5 104816,-2580.5 104816,-2512.5 104952,-2512.5 104952,-2580.5"/>
<text text-anchor="middle" x="104884" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN1</text>
<text text-anchor="middle" x="104884" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="104884" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="104884" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert5_ffn2_11 -->
<g id="node515" class="node">
<title>L2_expert5_ffn2_11</title>
<polygon fill="none" stroke="black" points="104798,-2580.5 104662,-2580.5 104662,-2512.5 104798,-2512.5 104798,-2580.5"/>
<text text-anchor="middle" x="104730" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN2</text>
<text text-anchor="middle" x="104730" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="104730" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="104730" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert5_ffn2_11&#45;&gt;L2_expert_concat_head2 -->
<g id="edge140" class="edge">
<title>L2_expert5_ffn2_11&#45;&gt;L2_expert_concat_head2</title>
<path fill="none" stroke="black" d="M104744.6,-2512.34C104757.39,-2487.32 104778.41,-2454.27 104807,-2436 104866.4,-2398.04 105050.2,-2372.49 105173.69,-2359.1"/>
<polygon fill="black" stroke="black" points="105174.39,-2362.55 105183.96,-2358 105173.64,-2355.59 105174.39,-2362.55"/>
</g>
<!-- L2_expert5_gate_11 -->
<g id="node516" class="node">
<title>L2_expert5_gate_11</title>
<polygon fill="none" stroke="black" points="104526,-2599.5 104408,-2546.5 104526,-2493.5 104644,-2546.5 104526,-2599.5"/>
<text text-anchor="middle" x="104526" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="104526" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="104526" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert4_ffn1_11 -->
<g id="node517" class="node">
<title>L3_expert4_ffn1_11</title>
<polygon fill="none" stroke="black" points="104390,-2580.5 104254,-2580.5 104254,-2512.5 104390,-2512.5 104390,-2580.5"/>
<text text-anchor="middle" x="104322" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN1</text>
<text text-anchor="middle" x="104322" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="104322" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="104322" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert4_ffn2_11 -->
<g id="node518" class="node">
<title>L3_expert4_ffn2_11</title>
<polygon fill="none" stroke="black" points="106800,-2580.5 106664,-2580.5 106664,-2512.5 106800,-2512.5 106800,-2580.5"/>
<text text-anchor="middle" x="106732" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN2</text>
<text text-anchor="middle" x="106732" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="106732" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="106732" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert4_ffn2_11&#45;&gt;L3_expert_concat_head2 -->
<g id="edge141" class="edge">
<title>L3_expert4_ffn2_11&#45;&gt;L3_expert_concat_head2</title>
<path fill="none" stroke="black" d="M106732,-2512.44C106732,-2484.68 106732,-2444.23 106732,-2410.4"/>
<polygon fill="black" stroke="black" points="106735.5,-2410.14 106732,-2400.14 106728.5,-2410.14 106735.5,-2410.14"/>
</g>
<!-- L3_expert4_gate_11 -->
<g id="node519" class="node">
<title>L3_expert4_gate_11</title>
<polygon fill="none" stroke="black" points="103956,-2599.5 103838,-2546.5 103956,-2493.5 104074,-2546.5 103956,-2599.5"/>
<text text-anchor="middle" x="103956" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="103956" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="103956" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert5_ffn1_11 -->
<g id="node520" class="node">
<title>L3_expert5_ffn1_11</title>
<polygon fill="none" stroke="black" points="103820,-2580.5 103684,-2580.5 103684,-2512.5 103820,-2512.5 103820,-2580.5"/>
<text text-anchor="middle" x="103752" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN1</text>
<text text-anchor="middle" x="103752" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="103752" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="103752" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert5_ffn2_11 -->
<g id="node521" class="node">
<title>L3_expert5_ffn2_11</title>
<polygon fill="none" stroke="black" points="106492,-2580.5 106356,-2580.5 106356,-2512.5 106492,-2512.5 106492,-2580.5"/>
<text text-anchor="middle" x="106424" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN2</text>
<text text-anchor="middle" x="106424" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="106424" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="106424" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert5_ffn2_11&#45;&gt;L3_expert_concat_head2 -->
<g id="edge142" class="edge">
<title>L3_expert5_ffn2_11&#45;&gt;L3_expert_concat_head2</title>
<path fill="none" stroke="black" d="M106440.43,-2512.25C106453.81,-2488.18 106474.77,-2456.4 106501,-2436 106540.93,-2404.95 106593.05,-2383.84 106637.67,-2370.1"/>
<polygon fill="black" stroke="black" points="106638.8,-2373.41 106647.37,-2367.19 106636.79,-2366.71 106638.8,-2373.41"/>
</g>
<!-- L3_expert5_gate_11 -->
<g id="node522" class="node">
<title>L3_expert5_gate_11</title>
<polygon fill="none" stroke="black" points="103394,-2599.5 103276,-2546.5 103394,-2493.5 103512,-2546.5 103394,-2599.5"/>
<text text-anchor="middle" x="103394" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="103394" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="103394" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert4_ffn1_11 -->
<g id="node523" class="node">
<title>L4_expert4_ffn1_11</title>
<polygon fill="none" stroke="black" points="103258,-2580.5 103122,-2580.5 103122,-2512.5 103258,-2512.5 103258,-2580.5"/>
<text text-anchor="middle" x="103190" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN1</text>
<text text-anchor="middle" x="103190" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="103190" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="103190" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert4_ffn2_11 -->
<g id="node524" class="node">
<title>L4_expert4_ffn2_11</title>
<polygon fill="none" stroke="black" points="109286,-2580.5 109150,-2580.5 109150,-2512.5 109286,-2512.5 109286,-2580.5"/>
<text text-anchor="middle" x="109218" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 4 FFN2</text>
<text text-anchor="middle" x="109218" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="109218" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="109218" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert4_ffn2_11&#45;&gt;L4_expert_concat_head2 -->
<g id="edge143" class="edge">
<title>L4_expert4_ffn2_11&#45;&gt;L4_expert_concat_head2</title>
<path fill="none" stroke="black" d="M109218,-2512.44C109218,-2484.68 109218,-2444.23 109218,-2410.4"/>
<polygon fill="black" stroke="black" points="109221.5,-2410.14 109218,-2400.14 109214.5,-2410.14 109221.5,-2410.14"/>
</g>
<!-- L4_expert4_gate_11 -->
<g id="node525" class="node">
<title>L4_expert4_gate_11</title>
<polygon fill="none" stroke="black" points="102832,-2599.5 102714,-2546.5 102832,-2493.5 102950,-2546.5 102832,-2599.5"/>
<text text-anchor="middle" x="102832" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 4 Gate</text>
<text text-anchor="middle" x="102832" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="102832" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert5_ffn1_11 -->
<g id="node526" class="node">
<title>L4_expert5_ffn1_11</title>
<polygon fill="none" stroke="black" points="102696,-2580.5 102560,-2580.5 102560,-2512.5 102696,-2512.5 102696,-2580.5"/>
<text text-anchor="middle" x="102628" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN1</text>
<text text-anchor="middle" x="102628" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="102628" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="102628" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert5_ffn2_11 -->
<g id="node527" class="node">
<title>L4_expert5_ffn2_11</title>
<polygon fill="none" stroke="black" points="108460,-2580.5 108324,-2580.5 108324,-2512.5 108460,-2512.5 108460,-2580.5"/>
<text text-anchor="middle" x="108392" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 5 FFN2</text>
<text text-anchor="middle" x="108392" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="108392" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="108392" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert5_ffn2_11&#45;&gt;L4_expert_concat_head2 -->
<g id="edge144" class="edge">
<title>L4_expert5_ffn2_11&#45;&gt;L4_expert_concat_head2</title>
<path fill="none" stroke="black" d="M108406.03,-2512.36C108418.62,-2487 108439.65,-2453.49 108469,-2436 108569.29,-2376.23 108893.36,-2357.03 109080.74,-2350.88"/>
<polygon fill="black" stroke="black" points="109081.05,-2354.37 109090.94,-2350.55 109080.83,-2347.38 109081.05,-2354.37"/>
</g>
<!-- L4_expert5_gate_11 -->
<g id="node528" class="node">
<title>L4_expert5_gate_11</title>
<polygon fill="none" stroke="black" points="102262,-2599.5 102144,-2546.5 102262,-2493.5 102380,-2546.5 102262,-2599.5"/>
<text text-anchor="middle" x="102262" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 5 Gate</text>
<text text-anchor="middle" x="102262" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="102262" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_Q_proj_12 -->
<g id="node529" class="node">
<title>L1_Q_proj_12</title>
<polygon fill="none" stroke="black" points="86444,-2580.5 86308,-2580.5 86308,-2512.5 86444,-2512.5 86444,-2580.5"/>
<text text-anchor="middle" x="86376" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="86376" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="86376" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="86376" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_K_proj_12 -->
<g id="node530" class="node">
<title>L1_K_proj_12</title>
<polygon fill="none" stroke="black" points="86290,-2580.5 86154,-2580.5 86154,-2512.5 86290,-2512.5 86290,-2580.5"/>
<text text-anchor="middle" x="86222" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="86222" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="86222" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="86222" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_V_proj_12 -->
<g id="node531" class="node">
<title>L1_V_proj_12</title>
<polygon fill="none" stroke="black" points="86136,-2580.5 86000,-2580.5 86000,-2512.5 86136,-2512.5 86136,-2580.5"/>
<text text-anchor="middle" x="86068" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="86068" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="86068" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="86068" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_attention_12 -->
<g id="node532" class="node">
<title>L1_attention_12</title>
<ellipse fill="none" stroke="black" cx="85886" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="85886" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="85886" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="85886" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="85886" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_12 -->
<g id="node533" class="node">
<title>L1_out_proj_12</title>
<polygon fill="none" stroke="black" points="79028,-2580.5 78884,-2580.5 78884,-2512.5 79028,-2512.5 79028,-2580.5"/>
<text text-anchor="middle" x="78956" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="78956" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="78956" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="78956" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_concat_dim_head3 -->
<g id="node729" class="node">
<title>L1_concat_dim_head3</title>
<polygon fill="none" stroke="black" points="71118,-2400 70972,-2347 71118,-2294 71264,-2347 71118,-2400"/>
<text text-anchor="middle" x="71118" y="-2358.3" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="71118" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="71118" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_out_proj_12&#45;&gt;L1_concat_dim_head3 -->
<g id="edge145" class="edge">
<title>L1_out_proj_12&#45;&gt;L1_concat_dim_head3</title>
<path fill="none" stroke="black" d="M78941.84,-2512.46C78928.7,-2486.42 78906.42,-2451.94 78875,-2436 78791.1,-2393.42 72195.04,-2402.74 72101,-2400 71795.5,-2391.11 71437.12,-2369.27 71248.83,-2356.9"/>
<polygon fill="black" stroke="black" points="71248.82,-2353.4 71238.61,-2356.23 71248.36,-2360.38 71248.82,-2353.4"/>
</g>
<!-- L2_Q_proj_12 -->
<g id="node534" class="node">
<title>L2_Q_proj_12</title>
<polygon fill="none" stroke="black" points="85618,-2580.5 85482,-2580.5 85482,-2512.5 85618,-2512.5 85618,-2580.5"/>
<text text-anchor="middle" x="85550" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="85550" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="85550" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="85550" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_K_proj_12 -->
<g id="node535" class="node">
<title>L2_K_proj_12</title>
<polygon fill="none" stroke="black" points="85464,-2580.5 85328,-2580.5 85328,-2512.5 85464,-2512.5 85464,-2580.5"/>
<text text-anchor="middle" x="85396" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="85396" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="85396" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="85396" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_V_proj_12 -->
<g id="node536" class="node">
<title>L2_V_proj_12</title>
<polygon fill="none" stroke="black" points="85310,-2580.5 85174,-2580.5 85174,-2512.5 85310,-2512.5 85310,-2580.5"/>
<text text-anchor="middle" x="85242" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="85242" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="85242" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="85242" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_attention_12 -->
<g id="node537" class="node">
<title>L2_attention_12</title>
<ellipse fill="none" stroke="black" cx="85060" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="85060" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="85060" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="85060" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="85060" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_12 -->
<g id="node538" class="node">
<title>L2_out_proj_12</title>
<polygon fill="none" stroke="black" points="80722,-2580.5 80578,-2580.5 80578,-2512.5 80722,-2512.5 80722,-2580.5"/>
<text text-anchor="middle" x="80650" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="80650" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="80650" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="80650" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_concat_dim_head3 -->
<g id="node730" class="node">
<title>L2_concat_dim_head3</title>
<polygon fill="none" stroke="black" points="72812,-2400 72666,-2347 72812,-2294 72958,-2347 72812,-2400"/>
<text text-anchor="middle" x="72812" y="-2358.3" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="72812" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="72812" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_out_proj_12&#45;&gt;L2_concat_dim_head3 -->
<g id="edge146" class="edge">
<title>L2_out_proj_12&#45;&gt;L2_concat_dim_head3</title>
<path fill="none" stroke="black" d="M80635.84,-2512.46C80622.7,-2486.42 80600.42,-2451.94 80569,-2436 80485.1,-2393.42 73889.04,-2402.74 73795,-2400 73489.5,-2391.11 73131.12,-2369.27 72942.83,-2356.9"/>
<polygon fill="black" stroke="black" points="72942.82,-2353.4 72932.61,-2356.23 72942.36,-2360.38 72942.82,-2353.4"/>
</g>
<!-- L3_Q_proj_12 -->
<g id="node539" class="node">
<title>L3_Q_proj_12</title>
<polygon fill="none" stroke="black" points="84792,-2580.5 84656,-2580.5 84656,-2512.5 84792,-2512.5 84792,-2580.5"/>
<text text-anchor="middle" x="84724" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="84724" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="84724" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="84724" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_K_proj_12 -->
<g id="node540" class="node">
<title>L3_K_proj_12</title>
<polygon fill="none" stroke="black" points="84638,-2580.5 84502,-2580.5 84502,-2512.5 84638,-2512.5 84638,-2580.5"/>
<text text-anchor="middle" x="84570" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="84570" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="84570" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="84570" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_V_proj_12 -->
<g id="node541" class="node">
<title>L3_V_proj_12</title>
<polygon fill="none" stroke="black" points="84484,-2580.5 84348,-2580.5 84348,-2512.5 84484,-2512.5 84484,-2580.5"/>
<text text-anchor="middle" x="84416" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="84416" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="84416" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="84416" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_attention_12 -->
<g id="node542" class="node">
<title>L3_attention_12</title>
<ellipse fill="none" stroke="black" cx="84234" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="84234" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="84234" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="84234" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="84234" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_12 -->
<g id="node543" class="node">
<title>L3_out_proj_12</title>
<polygon fill="none" stroke="black" points="82416,-2580.5 82272,-2580.5 82272,-2512.5 82416,-2512.5 82416,-2580.5"/>
<text text-anchor="middle" x="82344" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="82344" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="82344" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="82344" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_concat_dim_head3 -->
<g id="node731" class="node">
<title>L3_concat_dim_head3</title>
<polygon fill="none" stroke="black" points="74506,-2400 74360,-2347 74506,-2294 74652,-2347 74506,-2400"/>
<text text-anchor="middle" x="74506" y="-2358.3" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="74506" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="74506" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_out_proj_12&#45;&gt;L3_concat_dim_head3 -->
<g id="edge147" class="edge">
<title>L3_out_proj_12&#45;&gt;L3_concat_dim_head3</title>
<path fill="none" stroke="black" d="M82329.84,-2512.46C82316.71,-2486.42 82294.42,-2451.94 82263,-2436 82175.95,-2391.84 75332.54,-2403.72 75235,-2400 75022.49,-2391.89 74775.77,-2372.11 74630.72,-2359.42"/>
<polygon fill="black" stroke="black" points="74630.72,-2355.9 74620.46,-2358.51 74630.11,-2362.88 74630.72,-2355.9"/>
</g>
<!-- L4_Q_proj_12 -->
<g id="node544" class="node">
<title>L4_Q_proj_12</title>
<polygon fill="none" stroke="black" points="83958,-2580.5 83822,-2580.5 83822,-2512.5 83958,-2512.5 83958,-2580.5"/>
<text text-anchor="middle" x="83890" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="83890" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="83890" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="83890" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_K_proj_12 -->
<g id="node545" class="node">
<title>L4_K_proj_12</title>
<polygon fill="none" stroke="black" points="83804,-2580.5 83668,-2580.5 83668,-2512.5 83804,-2512.5 83804,-2580.5"/>
<text text-anchor="middle" x="83736" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="83736" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="83736" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="83736" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_V_proj_12 -->
<g id="node546" class="node">
<title>L4_V_proj_12</title>
<polygon fill="none" stroke="black" points="83650,-2580.5 83514,-2580.5 83514,-2512.5 83650,-2512.5 83650,-2580.5"/>
<text text-anchor="middle" x="83582" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="83582" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="83582" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="83582" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_attention_12 -->
<g id="node547" class="node">
<title>L4_attention_12</title>
<ellipse fill="none" stroke="black" cx="83400" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="83400" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="83400" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="83400" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="83400" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_12 -->
<g id="node548" class="node">
<title>L4_out_proj_12</title>
<polygon fill="none" stroke="black" points="84120,-2580.5 83976,-2580.5 83976,-2512.5 84120,-2512.5 84120,-2580.5"/>
<text text-anchor="middle" x="84048" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="84048" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="84048" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="84048" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_concat_dim_head3 -->
<g id="node732" class="node">
<title>L4_concat_dim_head3</title>
<polygon fill="none" stroke="black" points="76210,-2400 76064,-2347 76210,-2294 76356,-2347 76210,-2400"/>
<text text-anchor="middle" x="76210" y="-2358.3" font-family="Times,serif" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="76210" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="76210" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_out_proj_12&#45;&gt;L4_concat_dim_head3 -->
<g id="edge148" class="edge">
<title>L4_out_proj_12&#45;&gt;L4_concat_dim_head3</title>
<path fill="none" stroke="black" d="M84033.84,-2512.46C84020.7,-2486.43 83998.42,-2451.95 83967,-2436 83889.65,-2396.72 77807.73,-2401.74 77721,-2400 77214.79,-2389.83 76613.56,-2365.46 76347.9,-2354.07"/>
<polygon fill="black" stroke="black" points="76347.96,-2350.57 76337.82,-2353.63 76347.66,-2357.56 76347.96,-2350.57"/>
</g>
<!-- L1_expert6_ffn1_12 -->
<g id="node549" class="node">
<title>L1_expert6_ffn1_12</title>
<polygon fill="none" stroke="black" points="83132,-2580.5 82996,-2580.5 82996,-2512.5 83132,-2512.5 83132,-2580.5"/>
<text text-anchor="middle" x="83064" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN1</text>
<text text-anchor="middle" x="83064" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="83064" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="83064" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert6_ffn2_12 -->
<g id="node550" class="node">
<title>L1_expert6_ffn2_12</title>
<polygon fill="none" stroke="black" points="80152,-2580.5 80016,-2580.5 80016,-2512.5 80152,-2512.5 80152,-2580.5"/>
<text text-anchor="middle" x="80084" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN2</text>
<text text-anchor="middle" x="80084" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="80084" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="80084" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert_concat_head3 -->
<g id="node733" class="node">
<title>L1_expert_concat_head3</title>
<polygon fill="none" stroke="black" points="72246,-2400 72110,-2347 72246,-2294 72382,-2347 72246,-2400"/>
<text text-anchor="middle" x="72246" y="-2358.3" font-family="Times,serif" font-size="14.00">Expert Concat</text>
<text text-anchor="middle" x="72246" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="72246" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert6_ffn2_12&#45;&gt;L1_expert_concat_head3 -->
<g id="edge149" class="edge">
<title>L1_expert6_ffn2_12&#45;&gt;L1_expert_concat_head3</title>
<path fill="none" stroke="black" d="M80070.85,-2512.24C80058.6,-2486.27 80037.59,-2451.98 80007,-2436 79916.52,-2388.73 72758.87,-2406.67 72657,-2400 72552.17,-2393.14 72433.17,-2377.18 72350.29,-2364.74"/>
<polygon fill="black" stroke="black" points="72350.78,-2361.27 72340.37,-2363.24 72349.73,-2368.19 72350.78,-2361.27"/>
</g>
<!-- L1_expert6_gate_12 -->
<g id="node551" class="node">
<title>L1_expert6_gate_12</title>
<polygon fill="none" stroke="black" points="82706,-2599.5 82588,-2546.5 82706,-2493.5 82824,-2546.5 82706,-2599.5"/>
<text text-anchor="middle" x="82706" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="82706" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="82706" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_expert7_ffn1_12 -->
<g id="node552" class="node">
<title>L1_expert7_ffn1_12</title>
<polygon fill="none" stroke="black" points="82570,-2580.5 82434,-2580.5 82434,-2512.5 82570,-2512.5 82570,-2580.5"/>
<text text-anchor="middle" x="82502" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN1</text>
<text text-anchor="middle" x="82502" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="82502" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="82502" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert7_ffn2_12 -->
<g id="node553" class="node">
<title>L1_expert7_ffn2_12</title>
<polygon fill="none" stroke="black" points="79590,-2580.5 79454,-2580.5 79454,-2512.5 79590,-2512.5 79590,-2580.5"/>
<text text-anchor="middle" x="79522" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN2</text>
<text text-anchor="middle" x="79522" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="79522" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="79522" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert7_ffn2_12&#45;&gt;L1_expert_concat_head3 -->
<g id="edge150" class="edge">
<title>L1_expert7_ffn2_12&#45;&gt;L1_expert_concat_head3</title>
<path fill="none" stroke="black" d="M79508.85,-2512.25C79496.6,-2486.27 79475.59,-2451.99 79445,-2436 79361.45,-2392.33 72751.08,-2406.18 72657,-2400 72552.17,-2393.12 72433.17,-2377.16 72350.29,-2364.72"/>
<polygon fill="black" stroke="black" points="72350.78,-2361.26 72340.37,-2363.23 72349.73,-2368.18 72350.78,-2361.26"/>
</g>
<!-- L1_expert7_gate_12 -->
<g id="node554" class="node">
<title>L1_expert7_gate_12</title>
<polygon fill="none" stroke="black" points="82136,-2599.5 82018,-2546.5 82136,-2493.5 82254,-2546.5 82136,-2599.5"/>
<text text-anchor="middle" x="82136" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="82136" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="82136" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert6_ffn1_12 -->
<g id="node555" class="node">
<title>L2_expert6_ffn1_12</title>
<polygon fill="none" stroke="black" points="82000,-2580.5 81864,-2580.5 81864,-2512.5 82000,-2512.5 82000,-2580.5"/>
<text text-anchor="middle" x="81932" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN1</text>
<text text-anchor="middle" x="81932" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="81932" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="81932" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert6_ffn2_12 -->
<g id="node556" class="node">
<title>L2_expert6_ffn2_12</title>
<polygon fill="none" stroke="black" points="81846,-2580.5 81710,-2580.5 81710,-2512.5 81846,-2512.5 81846,-2580.5"/>
<text text-anchor="middle" x="81778" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN2</text>
<text text-anchor="middle" x="81778" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="81778" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="81778" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert_concat_head3 -->
<g id="node734" class="node">
<title>L2_expert_concat_head3</title>
<polygon fill="none" stroke="black" points="73940,-2400 73804,-2347 73940,-2294 74076,-2347 73940,-2400"/>
<text text-anchor="middle" x="73940" y="-2358.3" font-family="Times,serif" font-size="14.00">Expert Concat</text>
<text text-anchor="middle" x="73940" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="73940" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert6_ffn2_12&#45;&gt;L2_expert_concat_head3 -->
<g id="edge151" class="edge">
<title>L2_expert6_ffn2_12&#45;&gt;L2_expert_concat_head3</title>
<path fill="none" stroke="black" d="M81764.85,-2512.24C81752.6,-2486.27 81731.59,-2451.98 81701,-2436 81610.52,-2388.73 74452.87,-2406.67 74351,-2400 74246.17,-2393.14 74127.17,-2377.18 74044.29,-2364.74"/>
<polygon fill="black" stroke="black" points="74044.78,-2361.27 74034.37,-2363.24 74043.73,-2368.19 74044.78,-2361.27"/>
</g>
<!-- L2_expert6_gate_12 -->
<g id="node557" class="node">
<title>L2_expert6_gate_12</title>
<polygon fill="none" stroke="black" points="81574,-2599.5 81456,-2546.5 81574,-2493.5 81692,-2546.5 81574,-2599.5"/>
<text text-anchor="middle" x="81574" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="81574" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="81574" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert7_ffn1_12 -->
<g id="node558" class="node">
<title>L2_expert7_ffn1_12</title>
<polygon fill="none" stroke="black" points="81438,-2580.5 81302,-2580.5 81302,-2512.5 81438,-2512.5 81438,-2580.5"/>
<text text-anchor="middle" x="81370" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN1</text>
<text text-anchor="middle" x="81370" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="81370" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="81370" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert7_ffn2_12 -->
<g id="node559" class="node">
<title>L2_expert7_ffn2_12</title>
<polygon fill="none" stroke="black" points="81284,-2580.5 81148,-2580.5 81148,-2512.5 81284,-2512.5 81284,-2580.5"/>
<text text-anchor="middle" x="81216" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN2</text>
<text text-anchor="middle" x="81216" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="81216" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="81216" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert7_ffn2_12&#45;&gt;L2_expert_concat_head3 -->
<g id="edge152" class="edge">
<title>L2_expert7_ffn2_12&#45;&gt;L2_expert_concat_head3</title>
<path fill="none" stroke="black" d="M81202.85,-2512.25C81190.6,-2486.27 81169.59,-2451.99 81139,-2436 81055.45,-2392.33 74445.08,-2406.18 74351,-2400 74246.17,-2393.12 74127.17,-2377.16 74044.29,-2364.72"/>
<polygon fill="black" stroke="black" points="74044.78,-2361.26 74034.37,-2363.23 74043.73,-2368.18 74044.78,-2361.26"/>
</g>
<!-- L2_expert7_gate_12 -->
<g id="node560" class="node">
<title>L2_expert7_gate_12</title>
<polygon fill="none" stroke="black" points="81012,-2599.5 80894,-2546.5 81012,-2493.5 81130,-2546.5 81012,-2599.5"/>
<text text-anchor="middle" x="81012" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="81012" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="81012" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert6_ffn1_12 -->
<g id="node561" class="node">
<title>L3_expert6_ffn1_12</title>
<polygon fill="none" stroke="black" points="80876,-2580.5 80740,-2580.5 80740,-2512.5 80876,-2512.5 80876,-2580.5"/>
<text text-anchor="middle" x="80808" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN1</text>
<text text-anchor="middle" x="80808" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="80808" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="80808" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert6_ffn2_12 -->
<g id="node562" class="node">
<title>L3_expert6_ffn2_12</title>
<polygon fill="none" stroke="black" points="83286,-2580.5 83150,-2580.5 83150,-2512.5 83286,-2512.5 83286,-2580.5"/>
<text text-anchor="middle" x="83218" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN2</text>
<text text-anchor="middle" x="83218" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="83218" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="83218" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert_concat_head3 -->
<g id="node735" class="node">
<title>L3_expert_concat_head3</title>
<polygon fill="none" stroke="black" points="75380,-2400 75244,-2347 75380,-2294 75516,-2347 75380,-2400"/>
<text text-anchor="middle" x="75380" y="-2358.3" font-family="Times,serif" font-size="14.00">Expert Concat</text>
<text text-anchor="middle" x="75380" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="75380" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert6_ffn2_12&#45;&gt;L3_expert_concat_head3 -->
<g id="edge153" class="edge">
<title>L3_expert6_ffn2_12&#45;&gt;L3_expert_concat_head3</title>
<path fill="none" stroke="black" d="M83204.85,-2512.25C83192.6,-2486.27 83171.59,-2451.98 83141,-2436 83053.77,-2390.42 76153.34,-2404.03 76055,-2400 75858.85,-2391.96 75631.32,-2372.27 75496.86,-2359.56"/>
<polygon fill="black" stroke="black" points="75496.82,-2356.04 75486.54,-2358.58 75496.16,-2363.01 75496.82,-2356.04"/>
</g>
<!-- L3_expert6_gate_12 -->
<g id="node563" class="node">
<title>L3_expert6_gate_12</title>
<polygon fill="none" stroke="black" points="80442,-2599.5 80324,-2546.5 80442,-2493.5 80560,-2546.5 80442,-2599.5"/>
<text text-anchor="middle" x="80442" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="80442" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="80442" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert7_ffn1_12 -->
<g id="node564" class="node">
<title>L3_expert7_ffn1_12</title>
<polygon fill="none" stroke="black" points="80306,-2580.5 80170,-2580.5 80170,-2512.5 80306,-2512.5 80306,-2580.5"/>
<text text-anchor="middle" x="80238" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN1</text>
<text text-anchor="middle" x="80238" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="80238" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="80238" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert7_ffn2_12 -->
<g id="node565" class="node">
<title>L3_expert7_ffn2_12</title>
<polygon fill="none" stroke="black" points="82978,-2580.5 82842,-2580.5 82842,-2512.5 82978,-2512.5 82978,-2580.5"/>
<text text-anchor="middle" x="82910" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN2</text>
<text text-anchor="middle" x="82910" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="82910" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="82910" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert7_ffn2_12&#45;&gt;L3_expert_concat_head3 -->
<g id="edge154" class="edge">
<title>L3_expert7_ffn2_12&#45;&gt;L3_expert_concat_head3</title>
<path fill="none" stroke="black" d="M82896.85,-2512.25C82884.6,-2486.27 82863.59,-2451.99 82833,-2436 82749.57,-2392.39 76149.06,-2403.87 76055,-2400 75858.85,-2391.93 75631.32,-2372.26 75496.86,-2359.56"/>
<polygon fill="black" stroke="black" points="75496.82,-2356.04 75486.54,-2358.58 75496.16,-2363.01 75496.82,-2356.04"/>
</g>
<!-- L3_expert7_gate_12 -->
<g id="node566" class="node">
<title>L3_expert7_gate_12</title>
<polygon fill="none" stroke="black" points="79880,-2599.5 79762,-2546.5 79880,-2493.5 79998,-2546.5 79880,-2599.5"/>
<text text-anchor="middle" x="79880" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="79880" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="79880" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert6_ffn1_12 -->
<g id="node567" class="node">
<title>L4_expert6_ffn1_12</title>
<polygon fill="none" stroke="black" points="79744,-2580.5 79608,-2580.5 79608,-2512.5 79744,-2512.5 79744,-2580.5"/>
<text text-anchor="middle" x="79676" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN1</text>
<text text-anchor="middle" x="79676" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="79676" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="79676" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert6_ffn2_12 -->
<g id="node568" class="node">
<title>L4_expert6_ffn2_12</title>
<polygon fill="none" stroke="black" points="85772,-2580.5 85636,-2580.5 85636,-2512.5 85772,-2512.5 85772,-2580.5"/>
<text text-anchor="middle" x="85704" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN2</text>
<text text-anchor="middle" x="85704" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="85704" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="85704" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert_concat_head3 -->
<g id="node736" class="node">
<title>L4_expert_concat_head3</title>
<polygon fill="none" stroke="black" points="77866,-2400 77730,-2347 77866,-2294 78002,-2347 77866,-2400"/>
<text text-anchor="middle" x="77866" y="-2358.3" font-family="Times,serif" font-size="14.00">Expert Concat</text>
<text text-anchor="middle" x="77866" y="-2343.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="77866" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert6_ffn2_12&#45;&gt;L4_expert_concat_head3 -->
<g id="edge155" class="edge">
<title>L4_expert6_ffn2_12&#45;&gt;L4_expert_concat_head3</title>
<path fill="none" stroke="black" d="M85690.82,-2512.3C85678.56,-2486.35 85657.54,-2452.08 85627,-2436 85451.85,-2343.78 79056.41,-2346.72 78010.1,-2347.82"/>
<polygon fill="black" stroke="black" points="78009.89,-2344.32 77999.9,-2347.83 78009.9,-2351.32 78009.89,-2344.32"/>
</g>
<!-- L4_expert6_gate_12 -->
<g id="node569" class="node">
<title>L4_expert6_gate_12</title>
<polygon fill="none" stroke="black" points="79318,-2599.5 79200,-2546.5 79318,-2493.5 79436,-2546.5 79318,-2599.5"/>
<text text-anchor="middle" x="79318" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="79318" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="79318" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert7_ffn1_12 -->
<g id="node570" class="node">
<title>L4_expert7_ffn1_12</title>
<polygon fill="none" stroke="black" points="79182,-2580.5 79046,-2580.5 79046,-2512.5 79182,-2512.5 79182,-2580.5"/>
<text text-anchor="middle" x="79114" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN1</text>
<text text-anchor="middle" x="79114" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="79114" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="79114" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert7_ffn2_12 -->
<g id="node571" class="node">
<title>L4_expert7_ffn2_12</title>
<polygon fill="none" stroke="black" points="84946,-2580.5 84810,-2580.5 84810,-2512.5 84946,-2512.5 84946,-2580.5"/>
<text text-anchor="middle" x="84878" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN2</text>
<text text-anchor="middle" x="84878" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="84878" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 0</text>
<text text-anchor="middle" x="84878" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert7_ffn2_12&#45;&gt;L4_expert_concat_head3 -->
<g id="edge156" class="edge">
<title>L4_expert7_ffn2_12&#45;&gt;L4_expert_concat_head3</title>
<path fill="none" stroke="black" d="M84864.82,-2512.31C84852.55,-2486.37 84831.53,-2452.1 84801,-2436 84645.37,-2353.93 78989.91,-2348.37 78009.97,-2348.02"/>
<polygon fill="black" stroke="black" points="78009.71,-2344.52 77999.7,-2348.02 78009.7,-2351.52 78009.71,-2344.52"/>
</g>
<!-- L4_expert7_gate_12 -->
<g id="node572" class="node">
<title>L4_expert7_gate_12</title>
<polygon fill="none" stroke="black" points="78748,-2599.5 78630,-2546.5 78748,-2493.5 78866,-2546.5 78748,-2599.5"/>
<text text-anchor="middle" x="78748" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="78748" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="78748" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_Q_proj_13 -->
<g id="node573" class="node">
<title>L1_Q_proj_13</title>
<polygon fill="none" stroke="black" points="94282,-2580.5 94146,-2580.5 94146,-2512.5 94282,-2512.5 94282,-2580.5"/>
<text text-anchor="middle" x="94214" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="94214" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="94214" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="94214" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_K_proj_13 -->
<g id="node574" class="node">
<title>L1_K_proj_13</title>
<polygon fill="none" stroke="black" points="94128,-2580.5 93992,-2580.5 93992,-2512.5 94128,-2512.5 94128,-2580.5"/>
<text text-anchor="middle" x="94060" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="94060" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="94060" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="94060" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_V_proj_13 -->
<g id="node575" class="node">
<title>L1_V_proj_13</title>
<polygon fill="none" stroke="black" points="93974,-2580.5 93838,-2580.5 93838,-2512.5 93974,-2512.5 93974,-2580.5"/>
<text text-anchor="middle" x="93906" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="93906" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="93906" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="93906" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_attention_13 -->
<g id="node576" class="node">
<title>L1_attention_13</title>
<ellipse fill="none" stroke="black" cx="93724" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="93724" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="93724" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="93724" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="93724" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_13 -->
<g id="node577" class="node">
<title>L1_out_proj_13</title>
<polygon fill="none" stroke="black" points="86866,-2580.5 86722,-2580.5 86722,-2512.5 86866,-2512.5 86866,-2580.5"/>
<text text-anchor="middle" x="86794" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="86794" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="86794" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="86794" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_13&#45;&gt;L1_concat_dim_head3 -->
<g id="edge157" class="edge">
<title>L1_out_proj_13&#45;&gt;L1_concat_dim_head3</title>
<path fill="none" stroke="black" d="M86779.86,-2512.44C86766.72,-2486.39 86744.44,-2451.9 86713,-2436 86622.45,-2390.21 72202.43,-2402.81 72101,-2400 71795.49,-2391.55 71437.11,-2369.53 71248.82,-2357.02"/>
<polygon fill="black" stroke="black" points="71248.82,-2353.51 71238.61,-2356.34 71248.35,-2360.5 71248.82,-2353.51"/>
</g>
<!-- L2_Q_proj_13 -->
<g id="node578" class="node">
<title>L2_Q_proj_13</title>
<polygon fill="none" stroke="black" points="93456,-2580.5 93320,-2580.5 93320,-2512.5 93456,-2512.5 93456,-2580.5"/>
<text text-anchor="middle" x="93388" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="93388" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="93388" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="93388" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_K_proj_13 -->
<g id="node579" class="node">
<title>L2_K_proj_13</title>
<polygon fill="none" stroke="black" points="93302,-2580.5 93166,-2580.5 93166,-2512.5 93302,-2512.5 93302,-2580.5"/>
<text text-anchor="middle" x="93234" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="93234" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="93234" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="93234" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_V_proj_13 -->
<g id="node580" class="node">
<title>L2_V_proj_13</title>
<polygon fill="none" stroke="black" points="93148,-2580.5 93012,-2580.5 93012,-2512.5 93148,-2512.5 93148,-2580.5"/>
<text text-anchor="middle" x="93080" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="93080" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="93080" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="93080" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_attention_13 -->
<g id="node581" class="node">
<title>L2_attention_13</title>
<ellipse fill="none" stroke="black" cx="92898" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="92898" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="92898" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="92898" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="92898" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_13 -->
<g id="node582" class="node">
<title>L2_out_proj_13</title>
<polygon fill="none" stroke="black" points="88560,-2580.5 88416,-2580.5 88416,-2512.5 88560,-2512.5 88560,-2580.5"/>
<text text-anchor="middle" x="88488" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="88488" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="88488" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="88488" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_13&#45;&gt;L2_concat_dim_head3 -->
<g id="edge158" class="edge">
<title>L2_out_proj_13&#45;&gt;L2_concat_dim_head3</title>
<path fill="none" stroke="black" d="M88473.86,-2512.44C88460.72,-2486.39 88438.44,-2451.9 88407,-2436 88316.45,-2390.21 73896.43,-2402.81 73795,-2400 73489.49,-2391.55 73131.11,-2369.53 72942.82,-2357.02"/>
<polygon fill="black" stroke="black" points="72942.82,-2353.51 72932.61,-2356.34 72942.35,-2360.5 72942.82,-2353.51"/>
</g>
<!-- L3_Q_proj_13 -->
<g id="node583" class="node">
<title>L3_Q_proj_13</title>
<polygon fill="none" stroke="black" points="92630,-2580.5 92494,-2580.5 92494,-2512.5 92630,-2512.5 92630,-2580.5"/>
<text text-anchor="middle" x="92562" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="92562" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="92562" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="92562" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_K_proj_13 -->
<g id="node584" class="node">
<title>L3_K_proj_13</title>
<polygon fill="none" stroke="black" points="92476,-2580.5 92340,-2580.5 92340,-2512.5 92476,-2512.5 92476,-2580.5"/>
<text text-anchor="middle" x="92408" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="92408" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="92408" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="92408" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_V_proj_13 -->
<g id="node585" class="node">
<title>L3_V_proj_13</title>
<polygon fill="none" stroke="black" points="92322,-2580.5 92186,-2580.5 92186,-2512.5 92322,-2512.5 92322,-2580.5"/>
<text text-anchor="middle" x="92254" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="92254" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="92254" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="92254" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_attention_13 -->
<g id="node586" class="node">
<title>L3_attention_13</title>
<ellipse fill="none" stroke="black" cx="92072" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="92072" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="92072" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="92072" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="92072" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_13 -->
<g id="node587" class="node">
<title>L3_out_proj_13</title>
<polygon fill="none" stroke="black" points="90254,-2580.5 90110,-2580.5 90110,-2512.5 90254,-2512.5 90254,-2580.5"/>
<text text-anchor="middle" x="90182" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="90182" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="90182" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="90182" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_13&#45;&gt;L3_concat_dim_head3 -->
<g id="edge159" class="edge">
<title>L3_out_proj_13&#45;&gt;L3_concat_dim_head3</title>
<path fill="none" stroke="black" d="M90167.86,-2512.44C90154.72,-2486.38 90132.44,-2451.9 90101,-2436 90008.87,-2389.41 75338.17,-2403.8 75235,-2400 75022.33,-2392.17 74775.41,-2372.28 74630.4,-2359.49"/>
<polygon fill="black" stroke="black" points="74630.41,-2355.98 74620.14,-2358.58 74629.79,-2362.95 74630.41,-2355.98"/>
</g>
<!-- L4_Q_proj_13 -->
<g id="node588" class="node">
<title>L4_Q_proj_13</title>
<polygon fill="none" stroke="black" points="91796,-2580.5 91660,-2580.5 91660,-2512.5 91796,-2512.5 91796,-2580.5"/>
<text text-anchor="middle" x="91728" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="91728" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="91728" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="91728" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_K_proj_13 -->
<g id="node589" class="node">
<title>L4_K_proj_13</title>
<polygon fill="none" stroke="black" points="91642,-2580.5 91506,-2580.5 91506,-2512.5 91642,-2512.5 91642,-2580.5"/>
<text text-anchor="middle" x="91574" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="91574" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="91574" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="91574" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_V_proj_13 -->
<g id="node590" class="node">
<title>L4_V_proj_13</title>
<polygon fill="none" stroke="black" points="91488,-2580.5 91352,-2580.5 91352,-2512.5 91488,-2512.5 91488,-2580.5"/>
<text text-anchor="middle" x="91420" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="91420" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="91420" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="91420" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_attention_13 -->
<g id="node591" class="node">
<title>L4_attention_13</title>
<ellipse fill="none" stroke="black" cx="91238" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="91238" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="91238" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="91238" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="91238" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_13 -->
<g id="node592" class="node">
<title>L4_out_proj_13</title>
<polygon fill="none" stroke="black" points="91958,-2580.5 91814,-2580.5 91814,-2512.5 91958,-2512.5 91958,-2580.5"/>
<text text-anchor="middle" x="91886" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="91886" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="91886" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="91886" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_13&#45;&gt;L4_concat_dim_head3 -->
<g id="edge160" class="edge">
<title>L4_out_proj_13&#45;&gt;L4_concat_dim_head3</title>
<path fill="none" stroke="black" d="M91871.86,-2512.44C91858.72,-2486.39 91836.44,-2451.9 91805,-2436 91717.72,-2391.86 77818.79,-2401.81 77721,-2400 77214.77,-2390.64 76613.55,-2365.86 76347.9,-2354.22"/>
<polygon fill="black" stroke="black" points="76347.96,-2350.72 76337.82,-2353.77 76347.66,-2357.71 76347.96,-2350.72"/>
</g>
<!-- L1_expert6_ffn1_13 -->
<g id="node593" class="node">
<title>L1_expert6_ffn1_13</title>
<polygon fill="none" stroke="black" points="90970,-2580.5 90834,-2580.5 90834,-2512.5 90970,-2512.5 90970,-2580.5"/>
<text text-anchor="middle" x="90902" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN1</text>
<text text-anchor="middle" x="90902" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="90902" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="90902" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert6_ffn2_13 -->
<g id="node594" class="node">
<title>L1_expert6_ffn2_13</title>
<polygon fill="none" stroke="black" points="87990,-2580.5 87854,-2580.5 87854,-2512.5 87990,-2512.5 87990,-2580.5"/>
<text text-anchor="middle" x="87922" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN2</text>
<text text-anchor="middle" x="87922" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="87922" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="87922" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert6_ffn2_13&#45;&gt;L1_expert_concat_head3 -->
<g id="edge161" class="edge">
<title>L1_expert6_ffn2_13&#45;&gt;L1_expert_concat_head3</title>
<path fill="none" stroke="black" d="M87908.99,-2512.49C87896.76,-2486.47 87875.71,-2451.99 87845,-2436 87751.45,-2387.28 72762.26,-2406.76 72657,-2400 72552.16,-2393.27 72433.16,-2377.29 72350.29,-2364.81"/>
<polygon fill="black" stroke="black" points="72350.78,-2361.34 72340.36,-2363.31 72349.73,-2368.26 72350.78,-2361.34"/>
</g>
<!-- L1_expert6_gate_13 -->
<g id="node595" class="node">
<title>L1_expert6_gate_13</title>
<polygon fill="none" stroke="black" points="90544,-2599.5 90426,-2546.5 90544,-2493.5 90662,-2546.5 90544,-2599.5"/>
<text text-anchor="middle" x="90544" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="90544" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="90544" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_expert7_ffn1_13 -->
<g id="node596" class="node">
<title>L1_expert7_ffn1_13</title>
<polygon fill="none" stroke="black" points="90408,-2580.5 90272,-2580.5 90272,-2512.5 90408,-2512.5 90408,-2580.5"/>
<text text-anchor="middle" x="90340" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN1</text>
<text text-anchor="middle" x="90340" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="90340" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="90340" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert7_ffn2_13 -->
<g id="node597" class="node">
<title>L1_expert7_ffn2_13</title>
<polygon fill="none" stroke="black" points="87428,-2580.5 87292,-2580.5 87292,-2512.5 87428,-2512.5 87428,-2580.5"/>
<text text-anchor="middle" x="87360" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN2</text>
<text text-anchor="middle" x="87360" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="87360" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="87360" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert7_ffn2_13&#45;&gt;L1_expert_concat_head3 -->
<g id="edge162" class="edge">
<title>L1_expert7_ffn2_13&#45;&gt;L1_expert_concat_head3</title>
<path fill="none" stroke="black" d="M87346.99,-2512.49C87334.76,-2486.47 87313.71,-2452 87283,-2436 87192.92,-2389.08 72758.36,-2406.51 72657,-2400 72552.16,-2393.26 72433.16,-2377.29 72350.29,-2364.81"/>
<polygon fill="black" stroke="black" points="72350.78,-2361.34 72340.36,-2363.3 72349.73,-2368.26 72350.78,-2361.34"/>
</g>
<!-- L1_expert7_gate_13 -->
<g id="node598" class="node">
<title>L1_expert7_gate_13</title>
<polygon fill="none" stroke="black" points="89974,-2599.5 89856,-2546.5 89974,-2493.5 90092,-2546.5 89974,-2599.5"/>
<text text-anchor="middle" x="89974" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="89974" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="89974" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert6_ffn1_13 -->
<g id="node599" class="node">
<title>L2_expert6_ffn1_13</title>
<polygon fill="none" stroke="black" points="89838,-2580.5 89702,-2580.5 89702,-2512.5 89838,-2512.5 89838,-2580.5"/>
<text text-anchor="middle" x="89770" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN1</text>
<text text-anchor="middle" x="89770" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="89770" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="89770" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert6_ffn2_13 -->
<g id="node600" class="node">
<title>L2_expert6_ffn2_13</title>
<polygon fill="none" stroke="black" points="89684,-2580.5 89548,-2580.5 89548,-2512.5 89684,-2512.5 89684,-2580.5"/>
<text text-anchor="middle" x="89616" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN2</text>
<text text-anchor="middle" x="89616" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="89616" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="89616" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert6_ffn2_13&#45;&gt;L2_expert_concat_head3 -->
<g id="edge163" class="edge">
<title>L2_expert6_ffn2_13&#45;&gt;L2_expert_concat_head3</title>
<path fill="none" stroke="black" d="M89602.99,-2512.49C89590.76,-2486.47 89569.71,-2451.99 89539,-2436 89445.45,-2387.28 74456.26,-2406.76 74351,-2400 74246.16,-2393.27 74127.16,-2377.29 74044.29,-2364.81"/>
<polygon fill="black" stroke="black" points="74044.78,-2361.34 74034.36,-2363.31 74043.73,-2368.26 74044.78,-2361.34"/>
</g>
<!-- L2_expert6_gate_13 -->
<g id="node601" class="node">
<title>L2_expert6_gate_13</title>
<polygon fill="none" stroke="black" points="89412,-2599.5 89294,-2546.5 89412,-2493.5 89530,-2546.5 89412,-2599.5"/>
<text text-anchor="middle" x="89412" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="89412" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="89412" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert7_ffn1_13 -->
<g id="node602" class="node">
<title>L2_expert7_ffn1_13</title>
<polygon fill="none" stroke="black" points="89276,-2580.5 89140,-2580.5 89140,-2512.5 89276,-2512.5 89276,-2580.5"/>
<text text-anchor="middle" x="89208" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN1</text>
<text text-anchor="middle" x="89208" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="89208" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="89208" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert7_ffn2_13 -->
<g id="node603" class="node">
<title>L2_expert7_ffn2_13</title>
<polygon fill="none" stroke="black" points="89122,-2580.5 88986,-2580.5 88986,-2512.5 89122,-2512.5 89122,-2580.5"/>
<text text-anchor="middle" x="89054" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN2</text>
<text text-anchor="middle" x="89054" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="89054" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="89054" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert7_ffn2_13&#45;&gt;L2_expert_concat_head3 -->
<g id="edge164" class="edge">
<title>L2_expert7_ffn2_13&#45;&gt;L2_expert_concat_head3</title>
<path fill="none" stroke="black" d="M89040.99,-2512.49C89028.76,-2486.47 89007.71,-2452 88977,-2436 88886.92,-2389.08 74452.36,-2406.51 74351,-2400 74246.16,-2393.26 74127.16,-2377.29 74044.29,-2364.81"/>
<polygon fill="black" stroke="black" points="74044.78,-2361.34 74034.36,-2363.3 74043.73,-2368.26 74044.78,-2361.34"/>
</g>
<!-- L2_expert7_gate_13 -->
<g id="node604" class="node">
<title>L2_expert7_gate_13</title>
<polygon fill="none" stroke="black" points="88850,-2599.5 88732,-2546.5 88850,-2493.5 88968,-2546.5 88850,-2599.5"/>
<text text-anchor="middle" x="88850" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="88850" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="88850" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert6_ffn1_13 -->
<g id="node605" class="node">
<title>L3_expert6_ffn1_13</title>
<polygon fill="none" stroke="black" points="88714,-2580.5 88578,-2580.5 88578,-2512.5 88714,-2512.5 88714,-2580.5"/>
<text text-anchor="middle" x="88646" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN1</text>
<text text-anchor="middle" x="88646" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="88646" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="88646" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert6_ffn2_13 -->
<g id="node606" class="node">
<title>L3_expert6_ffn2_13</title>
<polygon fill="none" stroke="black" points="91124,-2580.5 90988,-2580.5 90988,-2512.5 91124,-2512.5 91124,-2580.5"/>
<text text-anchor="middle" x="91056" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN2</text>
<text text-anchor="middle" x="91056" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="91056" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="91056" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert6_ffn2_13&#45;&gt;L3_expert_concat_head3 -->
<g id="edge165" class="edge">
<title>L3_expert6_ffn2_13&#45;&gt;L3_expert_concat_head3</title>
<path fill="none" stroke="black" d="M91042.99,-2512.49C91030.76,-2486.47 91009.71,-2452 90979,-2436 90887.08,-2388.13 76158.56,-2404.11 76055,-2400 75858.7,-2392.21 75630.98,-2372.43 75496.56,-2359.63"/>
<polygon fill="black" stroke="black" points="75496.53,-2356.11 75486.24,-2358.64 75495.87,-2363.08 75496.53,-2356.11"/>
</g>
<!-- L3_expert6_gate_13 -->
<g id="node607" class="node">
<title>L3_expert6_gate_13</title>
<polygon fill="none" stroke="black" points="88280,-2599.5 88162,-2546.5 88280,-2493.5 88398,-2546.5 88280,-2599.5"/>
<text text-anchor="middle" x="88280" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="88280" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="88280" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert7_ffn1_13 -->
<g id="node608" class="node">
<title>L3_expert7_ffn1_13</title>
<polygon fill="none" stroke="black" points="88144,-2580.5 88008,-2580.5 88008,-2512.5 88144,-2512.5 88144,-2580.5"/>
<text text-anchor="middle" x="88076" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN1</text>
<text text-anchor="middle" x="88076" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="88076" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="88076" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert7_ffn2_13 -->
<g id="node609" class="node">
<title>L3_expert7_ffn2_13</title>
<polygon fill="none" stroke="black" points="90816,-2580.5 90680,-2580.5 90680,-2512.5 90816,-2512.5 90816,-2580.5"/>
<text text-anchor="middle" x="90748" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN2</text>
<text text-anchor="middle" x="90748" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="90748" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="90748" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert7_ffn2_13&#45;&gt;L3_expert_concat_head3 -->
<g id="edge166" class="edge">
<title>L3_expert7_ffn2_13&#45;&gt;L3_expert_concat_head3</title>
<path fill="none" stroke="black" d="M90734.99,-2512.49C90722.76,-2486.47 90701.71,-2452 90671,-2436 90580.98,-2389.11 76156.42,-2404.03 76055,-2400 75858.7,-2392.21 75630.99,-2372.42 75496.56,-2359.63"/>
<polygon fill="black" stroke="black" points="75496.53,-2356.11 75486.24,-2358.64 75495.87,-2363.08 75496.53,-2356.11"/>
</g>
<!-- L3_expert7_gate_13 -->
<g id="node610" class="node">
<title>L3_expert7_gate_13</title>
<polygon fill="none" stroke="black" points="87718,-2599.5 87600,-2546.5 87718,-2493.5 87836,-2546.5 87718,-2599.5"/>
<text text-anchor="middle" x="87718" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="87718" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="87718" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert6_ffn1_13 -->
<g id="node611" class="node">
<title>L4_expert6_ffn1_13</title>
<polygon fill="none" stroke="black" points="87582,-2580.5 87446,-2580.5 87446,-2512.5 87582,-2512.5 87582,-2580.5"/>
<text text-anchor="middle" x="87514" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN1</text>
<text text-anchor="middle" x="87514" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="87514" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="87514" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert6_ffn2_13 -->
<g id="node612" class="node">
<title>L4_expert6_ffn2_13</title>
<polygon fill="none" stroke="black" points="93610,-2580.5 93474,-2580.5 93474,-2512.5 93610,-2512.5 93610,-2580.5"/>
<text text-anchor="middle" x="93542" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN2</text>
<text text-anchor="middle" x="93542" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="93542" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="93542" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert6_ffn2_13&#45;&gt;L4_expert_concat_head3 -->
<g id="edge167" class="edge">
<title>L4_expert6_ffn2_13&#45;&gt;L4_expert_concat_head3</title>
<path fill="none" stroke="black" d="M93528.85,-2512.25C93516.59,-2486.28 93495.58,-2451.99 93465,-2436 93283.93,-2341.32 79569.66,-2346.96 78009.94,-2347.9"/>
<polygon fill="black" stroke="black" points="78009.81,-2344.4 77999.81,-2347.91 78009.81,-2351.4 78009.81,-2344.4"/>
</g>
<!-- L4_expert6_gate_13 -->
<g id="node613" class="node">
<title>L4_expert6_gate_13</title>
<polygon fill="none" stroke="black" points="87156,-2599.5 87038,-2546.5 87156,-2493.5 87274,-2546.5 87156,-2599.5"/>
<text text-anchor="middle" x="87156" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="87156" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="87156" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert7_ffn1_13 -->
<g id="node614" class="node">
<title>L4_expert7_ffn1_13</title>
<polygon fill="none" stroke="black" points="87020,-2580.5 86884,-2580.5 86884,-2512.5 87020,-2512.5 87020,-2580.5"/>
<text text-anchor="middle" x="86952" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN1</text>
<text text-anchor="middle" x="86952" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="86952" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="86952" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert7_ffn2_13 -->
<g id="node615" class="node">
<title>L4_expert7_ffn2_13</title>
<polygon fill="none" stroke="black" points="92784,-2580.5 92648,-2580.5 92648,-2512.5 92784,-2512.5 92784,-2580.5"/>
<text text-anchor="middle" x="92716" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN2</text>
<text text-anchor="middle" x="92716" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="92716" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 1</text>
<text text-anchor="middle" x="92716" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert7_ffn2_13&#45;&gt;L4_expert_concat_head3 -->
<g id="edge168" class="edge">
<title>L4_expert7_ffn2_13&#45;&gt;L4_expert_concat_head3</title>
<path fill="none" stroke="black" d="M92702.85,-2512.25C92690.59,-2486.28 92669.58,-2452 92639,-2436 92467.82,-2346.46 79522.94,-2347.52 78009.84,-2347.95"/>
<polygon fill="black" stroke="black" points="78009.74,-2344.45 77999.74,-2347.95 78009.74,-2351.45 78009.74,-2344.45"/>
</g>
<!-- L4_expert7_gate_13 -->
<g id="node616" class="node">
<title>L4_expert7_gate_13</title>
<polygon fill="none" stroke="black" points="86586,-2599.5 86468,-2546.5 86586,-2493.5 86704,-2546.5 86586,-2599.5"/>
<text text-anchor="middle" x="86586" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="86586" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="86586" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_Q_proj_14 -->
<g id="node617" class="node">
<title>L1_Q_proj_14</title>
<polygon fill="none" stroke="black" points="70768,-2580.5 70632,-2580.5 70632,-2512.5 70768,-2512.5 70768,-2580.5"/>
<text text-anchor="middle" x="70700" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="70700" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="70700" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="70700" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_K_proj_14 -->
<g id="node618" class="node">
<title>L1_K_proj_14</title>
<polygon fill="none" stroke="black" points="70614,-2580.5 70478,-2580.5 70478,-2512.5 70614,-2512.5 70614,-2580.5"/>
<text text-anchor="middle" x="70546" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="70546" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="70546" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="70546" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_V_proj_14 -->
<g id="node619" class="node">
<title>L1_V_proj_14</title>
<polygon fill="none" stroke="black" points="70460,-2580.5 70324,-2580.5 70324,-2512.5 70460,-2512.5 70460,-2580.5"/>
<text text-anchor="middle" x="70392" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="70392" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="70392" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="70392" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_attention_14 -->
<g id="node620" class="node">
<title>L1_attention_14</title>
<ellipse fill="none" stroke="black" cx="70210" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="70210" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="70210" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="70210" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="70210" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_14 -->
<g id="node621" class="node">
<title>L1_out_proj_14</title>
<polygon fill="none" stroke="black" points="63352,-2580.5 63208,-2580.5 63208,-2512.5 63352,-2512.5 63352,-2580.5"/>
<text text-anchor="middle" x="63280" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="63280" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="63280" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="63280" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_14&#45;&gt;L1_concat_dim_head3 -->
<g id="edge169" class="edge">
<title>L1_out_proj_14&#45;&gt;L1_concat_dim_head3</title>
<path fill="none" stroke="black" d="M63294.31,-2512.25C63307.49,-2486.27 63329.73,-2451.99 63361,-2436 63536.61,-2346.21 69889.34,-2347.07 70964.25,-2347.85"/>
<polygon fill="black" stroke="black" points="70964.36,-2351.35 70974.36,-2347.86 70964.36,-2344.35 70964.36,-2351.35"/>
</g>
<!-- L2_Q_proj_14 -->
<g id="node622" class="node">
<title>L2_Q_proj_14</title>
<polygon fill="none" stroke="black" points="69942,-2580.5 69806,-2580.5 69806,-2512.5 69942,-2512.5 69942,-2580.5"/>
<text text-anchor="middle" x="69874" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="69874" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="69874" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="69874" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_K_proj_14 -->
<g id="node623" class="node">
<title>L2_K_proj_14</title>
<polygon fill="none" stroke="black" points="69788,-2580.5 69652,-2580.5 69652,-2512.5 69788,-2512.5 69788,-2580.5"/>
<text text-anchor="middle" x="69720" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="69720" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="69720" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="69720" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_V_proj_14 -->
<g id="node624" class="node">
<title>L2_V_proj_14</title>
<polygon fill="none" stroke="black" points="69634,-2580.5 69498,-2580.5 69498,-2512.5 69634,-2512.5 69634,-2580.5"/>
<text text-anchor="middle" x="69566" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="69566" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="69566" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="69566" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_attention_14 -->
<g id="node625" class="node">
<title>L2_attention_14</title>
<ellipse fill="none" stroke="black" cx="69384" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="69384" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="69384" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="69384" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="69384" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_14 -->
<g id="node626" class="node">
<title>L2_out_proj_14</title>
<polygon fill="none" stroke="black" points="65046,-2580.5 64902,-2580.5 64902,-2512.5 65046,-2512.5 65046,-2580.5"/>
<text text-anchor="middle" x="64974" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="64974" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="64974" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="64974" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_14&#45;&gt;L2_concat_dim_head3 -->
<g id="edge170" class="edge">
<title>L2_out_proj_14&#45;&gt;L2_concat_dim_head3</title>
<path fill="none" stroke="black" d="M64988.15,-2512.46C65001.29,-2486.42 65023.58,-2451.94 65055,-2436 65145.87,-2389.91 72289.32,-2406.51 72391,-2400 72497.04,-2393.21 72617.29,-2377.56 72702.04,-2365.19"/>
<polygon fill="black" stroke="black" points="72702.55,-2368.65 72711.94,-2363.73 72701.54,-2361.72 72702.55,-2368.65"/>
</g>
<!-- L3_Q_proj_14 -->
<g id="node627" class="node">
<title>L3_Q_proj_14</title>
<polygon fill="none" stroke="black" points="69116,-2580.5 68980,-2580.5 68980,-2512.5 69116,-2512.5 69116,-2580.5"/>
<text text-anchor="middle" x="69048" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="69048" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="69048" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="69048" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_K_proj_14 -->
<g id="node628" class="node">
<title>L3_K_proj_14</title>
<polygon fill="none" stroke="black" points="68962,-2580.5 68826,-2580.5 68826,-2512.5 68962,-2512.5 68962,-2580.5"/>
<text text-anchor="middle" x="68894" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="68894" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="68894" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="68894" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_V_proj_14 -->
<g id="node629" class="node">
<title>L3_V_proj_14</title>
<polygon fill="none" stroke="black" points="68808,-2580.5 68672,-2580.5 68672,-2512.5 68808,-2512.5 68808,-2580.5"/>
<text text-anchor="middle" x="68740" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="68740" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="68740" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="68740" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_attention_14 -->
<g id="node630" class="node">
<title>L3_attention_14</title>
<ellipse fill="none" stroke="black" cx="68558" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="68558" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="68558" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="68558" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="68558" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_14 -->
<g id="node631" class="node">
<title>L3_out_proj_14</title>
<polygon fill="none" stroke="black" points="66740,-2580.5 66596,-2580.5 66596,-2512.5 66740,-2512.5 66740,-2580.5"/>
<text text-anchor="middle" x="66668" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="66668" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="66668" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="66668" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_14&#45;&gt;L3_concat_dim_head3 -->
<g id="edge171" class="edge">
<title>L3_out_proj_14&#45;&gt;L3_concat_dim_head3</title>
<path fill="none" stroke="black" d="M66682.15,-2512.46C66695.29,-2486.42 66717.58,-2451.94 66749,-2436 66839.87,-2389.91 73983.32,-2406.51 74085,-2400 74191.04,-2393.21 74311.29,-2377.56 74396.04,-2365.19"/>
<polygon fill="black" stroke="black" points="74396.55,-2368.65 74405.94,-2363.73 74395.54,-2361.72 74396.55,-2368.65"/>
</g>
<!-- L4_Q_proj_14 -->
<g id="node632" class="node">
<title>L4_Q_proj_14</title>
<polygon fill="none" stroke="black" points="68282,-2580.5 68146,-2580.5 68146,-2512.5 68282,-2512.5 68282,-2580.5"/>
<text text-anchor="middle" x="68214" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="68214" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="68214" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="68214" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_K_proj_14 -->
<g id="node633" class="node">
<title>L4_K_proj_14</title>
<polygon fill="none" stroke="black" points="68128,-2580.5 67992,-2580.5 67992,-2512.5 68128,-2512.5 68128,-2580.5"/>
<text text-anchor="middle" x="68060" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="68060" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="68060" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="68060" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_V_proj_14 -->
<g id="node634" class="node">
<title>L4_V_proj_14</title>
<polygon fill="none" stroke="black" points="67974,-2580.5 67838,-2580.5 67838,-2512.5 67974,-2512.5 67974,-2580.5"/>
<text text-anchor="middle" x="67906" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="67906" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="67906" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="67906" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_attention_14 -->
<g id="node635" class="node">
<title>L4_attention_14</title>
<ellipse fill="none" stroke="black" cx="67724" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="67724" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="67724" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="67724" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="67724" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_14 -->
<g id="node636" class="node">
<title>L4_out_proj_14</title>
<polygon fill="none" stroke="black" points="68444,-2580.5 68300,-2580.5 68300,-2512.5 68444,-2512.5 68444,-2580.5"/>
<text text-anchor="middle" x="68372" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="68372" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="68372" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="68372" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_14&#45;&gt;L4_concat_dim_head3 -->
<g id="edge172" class="edge">
<title>L4_out_proj_14&#45;&gt;L4_concat_dim_head3</title>
<path fill="none" stroke="black" d="M68386.16,-2512.46C68399.29,-2486.42 68421.58,-2451.94 68453,-2436 68540.6,-2391.56 75426.86,-2403.97 75525,-2400 75721.91,-2392.03 75950.02,-2372.69 76087,-2359.97"/>
<polygon fill="black" stroke="black" points="76087.48,-2363.44 76097.11,-2359.03 76086.83,-2356.47 76087.48,-2363.44"/>
</g>
<!-- L1_expert6_ffn1_14 -->
<g id="node637" class="node">
<title>L1_expert6_ffn1_14</title>
<polygon fill="none" stroke="black" points="67456,-2580.5 67320,-2580.5 67320,-2512.5 67456,-2512.5 67456,-2580.5"/>
<text text-anchor="middle" x="67388" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN1</text>
<text text-anchor="middle" x="67388" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="67388" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="67388" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert6_ffn2_14 -->
<g id="node638" class="node">
<title>L1_expert6_ffn2_14</title>
<polygon fill="none" stroke="black" points="64476,-2580.5 64340,-2580.5 64340,-2512.5 64476,-2512.5 64476,-2580.5"/>
<text text-anchor="middle" x="64408" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN2</text>
<text text-anchor="middle" x="64408" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="64408" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="64408" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert6_ffn2_14&#45;&gt;L1_expert_concat_head3 -->
<g id="edge173" class="edge">
<title>L1_expert6_ffn2_14&#45;&gt;L1_expert_concat_head3</title>
<path fill="none" stroke="black" d="M64421.15,-2512.25C64433.4,-2486.27 64454.41,-2451.99 64485,-2436 64568.55,-2392.33 71178.76,-2402.77 71273,-2400 71578.72,-2391.03 71937.93,-2368.79 72122.58,-2356.5"/>
<polygon fill="black" stroke="black" points="72122.85,-2359.99 72132.6,-2355.83 72122.39,-2353.01 72122.85,-2359.99"/>
</g>
<!-- L1_expert6_gate_14 -->
<g id="node639" class="node">
<title>L1_expert6_gate_14</title>
<polygon fill="none" stroke="black" points="67030,-2599.5 66912,-2546.5 67030,-2493.5 67148,-2546.5 67030,-2599.5"/>
<text text-anchor="middle" x="67030" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="67030" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="67030" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_expert7_ffn1_14 -->
<g id="node640" class="node">
<title>L1_expert7_ffn1_14</title>
<polygon fill="none" stroke="black" points="66894,-2580.5 66758,-2580.5 66758,-2512.5 66894,-2512.5 66894,-2580.5"/>
<text text-anchor="middle" x="66826" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN1</text>
<text text-anchor="middle" x="66826" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="66826" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="66826" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert7_ffn2_14 -->
<g id="node641" class="node">
<title>L1_expert7_ffn2_14</title>
<polygon fill="none" stroke="black" points="63914,-2580.5 63778,-2580.5 63778,-2512.5 63914,-2512.5 63914,-2580.5"/>
<text text-anchor="middle" x="63846" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN2</text>
<text text-anchor="middle" x="63846" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="63846" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="63846" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert7_ffn2_14&#45;&gt;L1_expert_concat_head3 -->
<g id="edge174" class="edge">
<title>L1_expert7_ffn2_14&#45;&gt;L1_expert_concat_head3</title>
<path fill="none" stroke="black" d="M63859.15,-2512.24C63871.4,-2486.27 63892.41,-2451.98 63923,-2436 64013.48,-2388.73 71170.96,-2402.97 71273,-2400 71578.72,-2391.09 71937.93,-2368.83 72122.58,-2356.52"/>
<polygon fill="black" stroke="black" points="72122.85,-2360.01 72132.6,-2355.85 72122.39,-2353.02 72122.85,-2360.01"/>
</g>
<!-- L1_expert7_gate_14 -->
<g id="node642" class="node">
<title>L1_expert7_gate_14</title>
<polygon fill="none" stroke="black" points="66460,-2599.5 66342,-2546.5 66460,-2493.5 66578,-2546.5 66460,-2599.5"/>
<text text-anchor="middle" x="66460" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="66460" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="66460" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert6_ffn1_14 -->
<g id="node643" class="node">
<title>L2_expert6_ffn1_14</title>
<polygon fill="none" stroke="black" points="66324,-2580.5 66188,-2580.5 66188,-2512.5 66324,-2512.5 66324,-2580.5"/>
<text text-anchor="middle" x="66256" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN1</text>
<text text-anchor="middle" x="66256" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="66256" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="66256" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert6_ffn2_14 -->
<g id="node644" class="node">
<title>L2_expert6_ffn2_14</title>
<polygon fill="none" stroke="black" points="66170,-2580.5 66034,-2580.5 66034,-2512.5 66170,-2512.5 66170,-2580.5"/>
<text text-anchor="middle" x="66102" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN2</text>
<text text-anchor="middle" x="66102" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="66102" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="66102" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert6_ffn2_14&#45;&gt;L2_expert_concat_head3 -->
<g id="edge175" class="edge">
<title>L2_expert6_ffn2_14&#45;&gt;L2_expert_concat_head3</title>
<path fill="none" stroke="black" d="M66115.15,-2512.25C66127.4,-2486.27 66148.41,-2451.99 66179,-2436 66262.55,-2392.33 72872.76,-2402.77 72967,-2400 73272.72,-2391.03 73631.93,-2368.79 73816.58,-2356.5"/>
<polygon fill="black" stroke="black" points="73816.85,-2359.99 73826.6,-2355.83 73816.39,-2353.01 73816.85,-2359.99"/>
</g>
<!-- L2_expert6_gate_14 -->
<g id="node645" class="node">
<title>L2_expert6_gate_14</title>
<polygon fill="none" stroke="black" points="65898,-2599.5 65780,-2546.5 65898,-2493.5 66016,-2546.5 65898,-2599.5"/>
<text text-anchor="middle" x="65898" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="65898" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="65898" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert7_ffn1_14 -->
<g id="node646" class="node">
<title>L2_expert7_ffn1_14</title>
<polygon fill="none" stroke="black" points="65762,-2580.5 65626,-2580.5 65626,-2512.5 65762,-2512.5 65762,-2580.5"/>
<text text-anchor="middle" x="65694" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN1</text>
<text text-anchor="middle" x="65694" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="65694" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="65694" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert7_ffn2_14 -->
<g id="node647" class="node">
<title>L2_expert7_ffn2_14</title>
<polygon fill="none" stroke="black" points="65608,-2580.5 65472,-2580.5 65472,-2512.5 65608,-2512.5 65608,-2580.5"/>
<text text-anchor="middle" x="65540" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN2</text>
<text text-anchor="middle" x="65540" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="65540" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="65540" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert7_ffn2_14&#45;&gt;L2_expert_concat_head3 -->
<g id="edge176" class="edge">
<title>L2_expert7_ffn2_14&#45;&gt;L2_expert_concat_head3</title>
<path fill="none" stroke="black" d="M65553.15,-2512.24C65565.4,-2486.27 65586.41,-2451.98 65617,-2436 65707.48,-2388.73 72864.96,-2402.97 72967,-2400 73272.72,-2391.09 73631.93,-2368.83 73816.58,-2356.52"/>
<polygon fill="black" stroke="black" points="73816.85,-2360.01 73826.6,-2355.85 73816.39,-2353.02 73816.85,-2360.01"/>
</g>
<!-- L2_expert7_gate_14 -->
<g id="node648" class="node">
<title>L2_expert7_gate_14</title>
<polygon fill="none" stroke="black" points="65336,-2599.5 65218,-2546.5 65336,-2493.5 65454,-2546.5 65336,-2599.5"/>
<text text-anchor="middle" x="65336" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="65336" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="65336" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert6_ffn1_14 -->
<g id="node649" class="node">
<title>L3_expert6_ffn1_14</title>
<polygon fill="none" stroke="black" points="65200,-2580.5 65064,-2580.5 65064,-2512.5 65200,-2512.5 65200,-2580.5"/>
<text text-anchor="middle" x="65132" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN1</text>
<text text-anchor="middle" x="65132" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="65132" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="65132" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert6_ffn2_14 -->
<g id="node650" class="node">
<title>L3_expert6_ffn2_14</title>
<polygon fill="none" stroke="black" points="67610,-2580.5 67474,-2580.5 67474,-2512.5 67610,-2512.5 67610,-2580.5"/>
<text text-anchor="middle" x="67542" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN2</text>
<text text-anchor="middle" x="67542" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="67542" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="67542" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert6_ffn2_14&#45;&gt;L3_expert_concat_head3 -->
<g id="edge177" class="edge">
<title>L3_expert6_ffn2_14&#45;&gt;L3_expert_concat_head3</title>
<path fill="none" stroke="black" d="M67555.15,-2512.25C67567.4,-2486.27 67588.41,-2451.98 67619,-2436 67705.69,-2390.7 74563.27,-2403.78 74661,-2400 74873.2,-2391.79 75119.97,-2371.62 75262.26,-2358.95"/>
<polygon fill="black" stroke="black" points="75262.67,-2362.43 75272.32,-2358.05 75262.05,-2355.46 75262.67,-2362.43"/>
</g>
<!-- L3_expert6_gate_14 -->
<g id="node651" class="node">
<title>L3_expert6_gate_14</title>
<polygon fill="none" stroke="black" points="64766,-2599.5 64648,-2546.5 64766,-2493.5 64884,-2546.5 64766,-2599.5"/>
<text text-anchor="middle" x="64766" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="64766" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="64766" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert7_ffn1_14 -->
<g id="node652" class="node">
<title>L3_expert7_ffn1_14</title>
<polygon fill="none" stroke="black" points="64630,-2580.5 64494,-2580.5 64494,-2512.5 64630,-2512.5 64630,-2580.5"/>
<text text-anchor="middle" x="64562" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN1</text>
<text text-anchor="middle" x="64562" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="64562" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="64562" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert7_ffn2_14 -->
<g id="node653" class="node">
<title>L3_expert7_ffn2_14</title>
<polygon fill="none" stroke="black" points="67302,-2580.5 67166,-2580.5 67166,-2512.5 67302,-2512.5 67302,-2580.5"/>
<text text-anchor="middle" x="67234" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN2</text>
<text text-anchor="middle" x="67234" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="67234" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="67234" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert7_ffn2_14&#45;&gt;L3_expert_concat_head3 -->
<g id="edge178" class="edge">
<title>L3_expert7_ffn2_14&#45;&gt;L3_expert_concat_head3</title>
<path fill="none" stroke="black" d="M67247.15,-2512.24C67259.4,-2486.27 67280.41,-2451.98 67311,-2436 67401.48,-2388.73 74558.99,-2403.93 74661,-2400 74873.2,-2391.82 75119.97,-2371.64 75262.26,-2358.96"/>
<polygon fill="black" stroke="black" points="75262.67,-2362.44 75272.32,-2358.06 75262.05,-2355.46 75262.67,-2362.44"/>
</g>
<!-- L3_expert7_gate_14 -->
<g id="node654" class="node">
<title>L3_expert7_gate_14</title>
<polygon fill="none" stroke="black" points="64204,-2599.5 64086,-2546.5 64204,-2493.5 64322,-2546.5 64204,-2599.5"/>
<text text-anchor="middle" x="64204" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="64204" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="64204" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert6_ffn1_14 -->
<g id="node655" class="node">
<title>L4_expert6_ffn1_14</title>
<polygon fill="none" stroke="black" points="64068,-2580.5 63932,-2580.5 63932,-2512.5 64068,-2512.5 64068,-2580.5"/>
<text text-anchor="middle" x="64000" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN1</text>
<text text-anchor="middle" x="64000" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="64000" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="64000" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert6_ffn2_14 -->
<g id="node656" class="node">
<title>L4_expert6_ffn2_14</title>
<polygon fill="none" stroke="black" points="70096,-2580.5 69960,-2580.5 69960,-2512.5 70096,-2512.5 70096,-2580.5"/>
<text text-anchor="middle" x="70028" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN2</text>
<text text-anchor="middle" x="70028" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="70028" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="70028" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert6_ffn2_14&#45;&gt;L4_expert_concat_head3 -->
<g id="edge179" class="edge">
<title>L4_expert6_ffn2_14&#45;&gt;L4_expert_concat_head3</title>
<path fill="none" stroke="black" d="M70041.15,-2512.25C70053.41,-2486.28 70074.42,-2451.99 70105,-2436 70182.05,-2395.71 76278.07,-2401.76 76365,-2400 76872.12,-2389.76 77475.23,-2365.06 77735.64,-2353.78"/>
<polygon fill="black" stroke="black" points="77736.05,-2357.27 77745.89,-2353.34 77735.75,-2350.28 77736.05,-2357.27"/>
</g>
<!-- L4_expert6_gate_14 -->
<g id="node657" class="node">
<title>L4_expert6_gate_14</title>
<polygon fill="none" stroke="black" points="63642,-2599.5 63524,-2546.5 63642,-2493.5 63760,-2546.5 63642,-2599.5"/>
<text text-anchor="middle" x="63642" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="63642" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="63642" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert7_ffn1_14 -->
<g id="node658" class="node">
<title>L4_expert7_ffn1_14</title>
<polygon fill="none" stroke="black" points="63506,-2580.5 63370,-2580.5 63370,-2512.5 63506,-2512.5 63506,-2580.5"/>
<text text-anchor="middle" x="63438" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN1</text>
<text text-anchor="middle" x="63438" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="63438" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="63438" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert7_ffn2_14 -->
<g id="node659" class="node">
<title>L4_expert7_ffn2_14</title>
<polygon fill="none" stroke="black" points="69270,-2580.5 69134,-2580.5 69134,-2512.5 69270,-2512.5 69270,-2580.5"/>
<text text-anchor="middle" x="69202" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN2</text>
<text text-anchor="middle" x="69202" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="69202" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 2</text>
<text text-anchor="middle" x="69202" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert7_ffn2_14&#45;&gt;L4_expert_concat_head3 -->
<g id="edge180" class="edge">
<title>L4_expert7_ffn2_14&#45;&gt;L4_expert_concat_head3</title>
<path fill="none" stroke="black" d="M69215.15,-2512.25C69227.4,-2486.27 69248.41,-2451.98 69279,-2436 69366.23,-2390.42 76266.6,-2401.95 76365,-2400 76872.12,-2389.93 77475.23,-2365.14 77735.64,-2353.81"/>
<polygon fill="black" stroke="black" points="77736.05,-2357.3 77745.89,-2353.37 77735.75,-2350.31 77736.05,-2357.3"/>
</g>
<!-- L4_expert7_gate_14 -->
<g id="node660" class="node">
<title>L4_expert7_gate_14</title>
<polygon fill="none" stroke="black" points="63072,-2599.5 62954,-2546.5 63072,-2493.5 63190,-2546.5 63072,-2599.5"/>
<text text-anchor="middle" x="63072" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="63072" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="63072" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_Q_proj_15 -->
<g id="node661" class="node">
<title>L1_Q_proj_15</title>
<polygon fill="none" stroke="black" points="78606,-2580.5 78470,-2580.5 78470,-2512.5 78606,-2512.5 78606,-2580.5"/>
<text text-anchor="middle" x="78538" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="78538" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="78538" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="78538" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_K_proj_15 -->
<g id="node662" class="node">
<title>L1_K_proj_15</title>
<polygon fill="none" stroke="black" points="78452,-2580.5 78316,-2580.5 78316,-2512.5 78452,-2512.5 78452,-2580.5"/>
<text text-anchor="middle" x="78384" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="78384" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="78384" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="78384" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_V_proj_15 -->
<g id="node663" class="node">
<title>L1_V_proj_15</title>
<polygon fill="none" stroke="black" points="78298,-2580.5 78162,-2580.5 78162,-2512.5 78298,-2512.5 78298,-2580.5"/>
<text text-anchor="middle" x="78230" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="78230" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="78230" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="78230" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_attention_15 -->
<g id="node664" class="node">
<title>L1_attention_15</title>
<ellipse fill="none" stroke="black" cx="78048" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="78048" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="78048" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="78048" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="78048" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_15 -->
<g id="node665" class="node">
<title>L1_out_proj_15</title>
<polygon fill="none" stroke="black" points="71190,-2580.5 71046,-2580.5 71046,-2512.5 71190,-2512.5 71190,-2580.5"/>
<text text-anchor="middle" x="71118" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="71118" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="71118" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="71118" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_out_proj_15&#45;&gt;L1_concat_dim_head3 -->
<g id="edge181" class="edge">
<title>L1_out_proj_15&#45;&gt;L1_concat_dim_head3</title>
<path fill="none" stroke="black" d="M71118,-2512.44C71118,-2484.68 71118,-2444.23 71118,-2410.4"/>
<polygon fill="black" stroke="black" points="71121.5,-2410.14 71118,-2400.14 71114.5,-2410.14 71121.5,-2410.14"/>
</g>
<!-- L2_Q_proj_15 -->
<g id="node666" class="node">
<title>L2_Q_proj_15</title>
<polygon fill="none" stroke="black" points="77780,-2580.5 77644,-2580.5 77644,-2512.5 77780,-2512.5 77780,-2580.5"/>
<text text-anchor="middle" x="77712" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="77712" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="77712" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="77712" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_K_proj_15 -->
<g id="node667" class="node">
<title>L2_K_proj_15</title>
<polygon fill="none" stroke="black" points="77626,-2580.5 77490,-2580.5 77490,-2512.5 77626,-2512.5 77626,-2580.5"/>
<text text-anchor="middle" x="77558" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="77558" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="77558" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="77558" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_V_proj_15 -->
<g id="node668" class="node">
<title>L2_V_proj_15</title>
<polygon fill="none" stroke="black" points="77472,-2580.5 77336,-2580.5 77336,-2512.5 77472,-2512.5 77472,-2580.5"/>
<text text-anchor="middle" x="77404" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="77404" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="77404" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="77404" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_attention_15 -->
<g id="node669" class="node">
<title>L2_attention_15</title>
<ellipse fill="none" stroke="black" cx="77222" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="77222" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="77222" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="77222" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="77222" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_15 -->
<g id="node670" class="node">
<title>L2_out_proj_15</title>
<polygon fill="none" stroke="black" points="72884,-2580.5 72740,-2580.5 72740,-2512.5 72884,-2512.5 72884,-2580.5"/>
<text text-anchor="middle" x="72812" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="72812" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="72812" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="72812" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_out_proj_15&#45;&gt;L2_concat_dim_head3 -->
<g id="edge182" class="edge">
<title>L2_out_proj_15&#45;&gt;L2_concat_dim_head3</title>
<path fill="none" stroke="black" d="M72812,-2512.44C72812,-2484.68 72812,-2444.23 72812,-2410.4"/>
<polygon fill="black" stroke="black" points="72815.5,-2410.14 72812,-2400.14 72808.5,-2410.14 72815.5,-2410.14"/>
</g>
<!-- L3_Q_proj_15 -->
<g id="node671" class="node">
<title>L3_Q_proj_15</title>
<polygon fill="none" stroke="black" points="76954,-2580.5 76818,-2580.5 76818,-2512.5 76954,-2512.5 76954,-2580.5"/>
<text text-anchor="middle" x="76886" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="76886" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="76886" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="76886" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_K_proj_15 -->
<g id="node672" class="node">
<title>L3_K_proj_15</title>
<polygon fill="none" stroke="black" points="76800,-2580.5 76664,-2580.5 76664,-2512.5 76800,-2512.5 76800,-2580.5"/>
<text text-anchor="middle" x="76732" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="76732" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="76732" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="76732" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_V_proj_15 -->
<g id="node673" class="node">
<title>L3_V_proj_15</title>
<polygon fill="none" stroke="black" points="76646,-2580.5 76510,-2580.5 76510,-2512.5 76646,-2512.5 76646,-2580.5"/>
<text text-anchor="middle" x="76578" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="76578" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="76578" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="76578" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_attention_15 -->
<g id="node674" class="node">
<title>L3_attention_15</title>
<ellipse fill="none" stroke="black" cx="76396" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="76396" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="76396" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="76396" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="76396" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_15 -->
<g id="node675" class="node">
<title>L3_out_proj_15</title>
<polygon fill="none" stroke="black" points="74578,-2580.5 74434,-2580.5 74434,-2512.5 74578,-2512.5 74578,-2580.5"/>
<text text-anchor="middle" x="74506" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="74506" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="74506" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="74506" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_out_proj_15&#45;&gt;L3_concat_dim_head3 -->
<g id="edge183" class="edge">
<title>L3_out_proj_15&#45;&gt;L3_concat_dim_head3</title>
<path fill="none" stroke="black" d="M74506,-2512.44C74506,-2484.68 74506,-2444.23 74506,-2410.4"/>
<polygon fill="black" stroke="black" points="74509.5,-2410.14 74506,-2400.14 74502.5,-2410.14 74509.5,-2410.14"/>
</g>
<!-- L4_Q_proj_15 -->
<g id="node676" class="node">
<title>L4_Q_proj_15</title>
<polygon fill="none" stroke="black" points="76120,-2580.5 75984,-2580.5 75984,-2512.5 76120,-2512.5 76120,-2580.5"/>
<text text-anchor="middle" x="76052" y="-2565.3" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="76052" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="76052" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="76052" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_K_proj_15 -->
<g id="node677" class="node">
<title>L4_K_proj_15</title>
<polygon fill="none" stroke="black" points="75966,-2580.5 75830,-2580.5 75830,-2512.5 75966,-2512.5 75966,-2580.5"/>
<text text-anchor="middle" x="75898" y="-2565.3" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="75898" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="75898" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="75898" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_V_proj_15 -->
<g id="node678" class="node">
<title>L4_V_proj_15</title>
<polygon fill="none" stroke="black" points="75812,-2580.5 75676,-2580.5 75676,-2512.5 75812,-2512.5 75812,-2580.5"/>
<text text-anchor="middle" x="75744" y="-2565.3" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="75744" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="75744" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="75744" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_attention_15 -->
<g id="node679" class="node">
<title>L4_attention_15</title>
<ellipse fill="none" stroke="black" cx="75562" cy="-2546.5" rx="96.33" ry="48.17"/>
<text text-anchor="middle" x="75562" y="-2565.3" font-family="Times,serif" font-size="14.00">Attention</text>
<text text-anchor="middle" x="75562" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="75562" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="75562" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_15 -->
<g id="node680" class="node">
<title>L4_out_proj_15</title>
<polygon fill="none" stroke="black" points="76282,-2580.5 76138,-2580.5 76138,-2512.5 76282,-2512.5 76282,-2580.5"/>
<text text-anchor="middle" x="76210" y="-2565.3" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="76210" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="76210" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="76210" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_out_proj_15&#45;&gt;L4_concat_dim_head3 -->
<g id="edge184" class="edge">
<title>L4_out_proj_15&#45;&gt;L4_concat_dim_head3</title>
<path fill="none" stroke="black" d="M76210,-2512.44C76210,-2484.68 76210,-2444.23 76210,-2410.4"/>
<polygon fill="black" stroke="black" points="76213.5,-2410.14 76210,-2400.14 76206.5,-2410.14 76213.5,-2410.14"/>
</g>
<!-- L1_expert6_ffn1_15 -->
<g id="node681" class="node">
<title>L1_expert6_ffn1_15</title>
<polygon fill="none" stroke="black" points="75294,-2580.5 75158,-2580.5 75158,-2512.5 75294,-2512.5 75294,-2580.5"/>
<text text-anchor="middle" x="75226" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN1</text>
<text text-anchor="middle" x="75226" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="75226" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="75226" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert6_ffn2_15 -->
<g id="node682" class="node">
<title>L1_expert6_ffn2_15</title>
<polygon fill="none" stroke="black" points="72314,-2580.5 72178,-2580.5 72178,-2512.5 72314,-2512.5 72314,-2580.5"/>
<text text-anchor="middle" x="72246" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN2</text>
<text text-anchor="middle" x="72246" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="72246" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="72246" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert6_ffn2_15&#45;&gt;L1_expert_concat_head3 -->
<g id="edge185" class="edge">
<title>L1_expert6_ffn2_15&#45;&gt;L1_expert_concat_head3</title>
<path fill="none" stroke="black" d="M72246,-2512.44C72246,-2484.68 72246,-2444.23 72246,-2410.4"/>
<polygon fill="black" stroke="black" points="72249.5,-2410.14 72246,-2400.14 72242.5,-2410.14 72249.5,-2410.14"/>
</g>
<!-- L1_expert6_gate_15 -->
<g id="node683" class="node">
<title>L1_expert6_gate_15</title>
<polygon fill="none" stroke="black" points="74868,-2599.5 74750,-2546.5 74868,-2493.5 74986,-2546.5 74868,-2599.5"/>
<text text-anchor="middle" x="74868" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="74868" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="74868" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_expert7_ffn1_15 -->
<g id="node684" class="node">
<title>L1_expert7_ffn1_15</title>
<polygon fill="none" stroke="black" points="74732,-2580.5 74596,-2580.5 74596,-2512.5 74732,-2512.5 74732,-2580.5"/>
<text text-anchor="middle" x="74664" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN1</text>
<text text-anchor="middle" x="74664" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="74664" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="74664" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L1_expert7_ffn2_15 -->
<g id="node685" class="node">
<title>L1_expert7_ffn2_15</title>
<polygon fill="none" stroke="black" points="71752,-2580.5 71616,-2580.5 71616,-2512.5 71752,-2512.5 71752,-2580.5"/>
<text text-anchor="middle" x="71684" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN2</text>
<text text-anchor="middle" x="71684" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="71684" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="71684" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L1_expert7_ffn2_15&#45;&gt;L1_expert_concat_head3 -->
<g id="edge186" class="edge">
<title>L1_expert7_ffn2_15&#45;&gt;L1_expert_concat_head3</title>
<path fill="none" stroke="black" d="M71698.6,-2512.34C71711.39,-2487.32 71732.41,-2454.27 71761,-2436 71820.4,-2398.04 72004.2,-2372.49 72127.69,-2359.1"/>
<polygon fill="black" stroke="black" points="72128.39,-2362.55 72137.96,-2358 72127.64,-2355.59 72128.39,-2362.55"/>
</g>
<!-- L1_expert7_gate_15 -->
<g id="node686" class="node">
<title>L1_expert7_gate_15</title>
<polygon fill="none" stroke="black" points="74298,-2599.5 74180,-2546.5 74298,-2493.5 74416,-2546.5 74298,-2599.5"/>
<text text-anchor="middle" x="74298" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="74298" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="74298" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert6_ffn1_15 -->
<g id="node687" class="node">
<title>L2_expert6_ffn1_15</title>
<polygon fill="none" stroke="black" points="74162,-2580.5 74026,-2580.5 74026,-2512.5 74162,-2512.5 74162,-2580.5"/>
<text text-anchor="middle" x="74094" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN1</text>
<text text-anchor="middle" x="74094" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="74094" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="74094" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert6_ffn2_15 -->
<g id="node688" class="node">
<title>L2_expert6_ffn2_15</title>
<polygon fill="none" stroke="black" points="74008,-2580.5 73872,-2580.5 73872,-2512.5 74008,-2512.5 74008,-2580.5"/>
<text text-anchor="middle" x="73940" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN2</text>
<text text-anchor="middle" x="73940" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="73940" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="73940" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert6_ffn2_15&#45;&gt;L2_expert_concat_head3 -->
<g id="edge187" class="edge">
<title>L2_expert6_ffn2_15&#45;&gt;L2_expert_concat_head3</title>
<path fill="none" stroke="black" d="M73940,-2512.44C73940,-2484.68 73940,-2444.23 73940,-2410.4"/>
<polygon fill="black" stroke="black" points="73943.5,-2410.14 73940,-2400.14 73936.5,-2410.14 73943.5,-2410.14"/>
</g>
<!-- L2_expert6_gate_15 -->
<g id="node689" class="node">
<title>L2_expert6_gate_15</title>
<polygon fill="none" stroke="black" points="73736,-2599.5 73618,-2546.5 73736,-2493.5 73854,-2546.5 73736,-2599.5"/>
<text text-anchor="middle" x="73736" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="73736" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="73736" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L2_expert7_ffn1_15 -->
<g id="node690" class="node">
<title>L2_expert7_ffn1_15</title>
<polygon fill="none" stroke="black" points="73600,-2580.5 73464,-2580.5 73464,-2512.5 73600,-2512.5 73600,-2580.5"/>
<text text-anchor="middle" x="73532" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN1</text>
<text text-anchor="middle" x="73532" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="73532" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="73532" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L2_expert7_ffn2_15 -->
<g id="node691" class="node">
<title>L2_expert7_ffn2_15</title>
<polygon fill="none" stroke="black" points="73446,-2580.5 73310,-2580.5 73310,-2512.5 73446,-2512.5 73446,-2580.5"/>
<text text-anchor="middle" x="73378" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN2</text>
<text text-anchor="middle" x="73378" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="73378" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="73378" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L2_expert7_ffn2_15&#45;&gt;L2_expert_concat_head3 -->
<g id="edge188" class="edge">
<title>L2_expert7_ffn2_15&#45;&gt;L2_expert_concat_head3</title>
<path fill="none" stroke="black" d="M73392.6,-2512.34C73405.39,-2487.32 73426.41,-2454.27 73455,-2436 73514.4,-2398.04 73698.2,-2372.49 73821.69,-2359.1"/>
<polygon fill="black" stroke="black" points="73822.39,-2362.55 73831.96,-2358 73821.64,-2355.59 73822.39,-2362.55"/>
</g>
<!-- L2_expert7_gate_15 -->
<g id="node692" class="node">
<title>L2_expert7_gate_15</title>
<polygon fill="none" stroke="black" points="73174,-2599.5 73056,-2546.5 73174,-2493.5 73292,-2546.5 73174,-2599.5"/>
<text text-anchor="middle" x="73174" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="73174" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="73174" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert6_ffn1_15 -->
<g id="node693" class="node">
<title>L3_expert6_ffn1_15</title>
<polygon fill="none" stroke="black" points="73038,-2580.5 72902,-2580.5 72902,-2512.5 73038,-2512.5 73038,-2580.5"/>
<text text-anchor="middle" x="72970" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN1</text>
<text text-anchor="middle" x="72970" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="72970" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="72970" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert6_ffn2_15 -->
<g id="node694" class="node">
<title>L3_expert6_ffn2_15</title>
<polygon fill="none" stroke="black" points="75448,-2580.5 75312,-2580.5 75312,-2512.5 75448,-2512.5 75448,-2580.5"/>
<text text-anchor="middle" x="75380" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN2</text>
<text text-anchor="middle" x="75380" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="75380" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="75380" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert6_ffn2_15&#45;&gt;L3_expert_concat_head3 -->
<g id="edge189" class="edge">
<title>L3_expert6_ffn2_15&#45;&gt;L3_expert_concat_head3</title>
<path fill="none" stroke="black" d="M75380,-2512.44C75380,-2484.68 75380,-2444.23 75380,-2410.4"/>
<polygon fill="black" stroke="black" points="75383.5,-2410.14 75380,-2400.14 75376.5,-2410.14 75383.5,-2410.14"/>
</g>
<!-- L3_expert6_gate_15 -->
<g id="node695" class="node">
<title>L3_expert6_gate_15</title>
<polygon fill="none" stroke="black" points="72604,-2599.5 72486,-2546.5 72604,-2493.5 72722,-2546.5 72604,-2599.5"/>
<text text-anchor="middle" x="72604" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="72604" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="72604" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L3_expert7_ffn1_15 -->
<g id="node696" class="node">
<title>L3_expert7_ffn1_15</title>
<polygon fill="none" stroke="black" points="72468,-2580.5 72332,-2580.5 72332,-2512.5 72468,-2512.5 72468,-2580.5"/>
<text text-anchor="middle" x="72400" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN1</text>
<text text-anchor="middle" x="72400" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="72400" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="72400" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L3_expert7_ffn2_15 -->
<g id="node697" class="node">
<title>L3_expert7_ffn2_15</title>
<polygon fill="none" stroke="black" points="75140,-2580.5 75004,-2580.5 75004,-2512.5 75140,-2512.5 75140,-2580.5"/>
<text text-anchor="middle" x="75072" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN2</text>
<text text-anchor="middle" x="75072" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="75072" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="75072" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L3_expert7_ffn2_15&#45;&gt;L3_expert_concat_head3 -->
<g id="edge190" class="edge">
<title>L3_expert7_ffn2_15&#45;&gt;L3_expert_concat_head3</title>
<path fill="none" stroke="black" d="M75088.43,-2512.25C75101.81,-2488.18 75122.77,-2456.4 75149,-2436 75188.93,-2404.95 75241.05,-2383.84 75285.67,-2370.1"/>
<polygon fill="black" stroke="black" points="75286.8,-2373.41 75295.37,-2367.19 75284.79,-2366.71 75286.8,-2373.41"/>
</g>
<!-- L3_expert7_gate_15 -->
<g id="node698" class="node">
<title>L3_expert7_gate_15</title>
<polygon fill="none" stroke="black" points="72042,-2599.5 71924,-2546.5 72042,-2493.5 72160,-2546.5 72042,-2599.5"/>
<text text-anchor="middle" x="72042" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="72042" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="72042" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert6_ffn1_15 -->
<g id="node699" class="node">
<title>L4_expert6_ffn1_15</title>
<polygon fill="none" stroke="black" points="71906,-2580.5 71770,-2580.5 71770,-2512.5 71906,-2512.5 71906,-2580.5"/>
<text text-anchor="middle" x="71838" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN1</text>
<text text-anchor="middle" x="71838" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="71838" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="71838" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert6_ffn2_15 -->
<g id="node700" class="node">
<title>L4_expert6_ffn2_15</title>
<polygon fill="none" stroke="black" points="77934,-2580.5 77798,-2580.5 77798,-2512.5 77934,-2512.5 77934,-2580.5"/>
<text text-anchor="middle" x="77866" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 6 FFN2</text>
<text text-anchor="middle" x="77866" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="77866" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="77866" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert6_ffn2_15&#45;&gt;L4_expert_concat_head3 -->
<g id="edge191" class="edge">
<title>L4_expert6_ffn2_15&#45;&gt;L4_expert_concat_head3</title>
<path fill="none" stroke="black" d="M77866,-2512.44C77866,-2484.68 77866,-2444.23 77866,-2410.4"/>
<polygon fill="black" stroke="black" points="77869.5,-2410.14 77866,-2400.14 77862.5,-2410.14 77869.5,-2410.14"/>
</g>
<!-- L4_expert6_gate_15 -->
<g id="node701" class="node">
<title>L4_expert6_gate_15</title>
<polygon fill="none" stroke="black" points="71480,-2599.5 71362,-2546.5 71480,-2493.5 71598,-2546.5 71480,-2599.5"/>
<text text-anchor="middle" x="71480" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 6 Gate</text>
<text text-anchor="middle" x="71480" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="71480" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L4_expert7_ffn1_15 -->
<g id="node702" class="node">
<title>L4_expert7_ffn1_15</title>
<polygon fill="none" stroke="black" points="71344,-2580.5 71208,-2580.5 71208,-2512.5 71344,-2512.5 71344,-2580.5"/>
<text text-anchor="middle" x="71276" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN1</text>
<text text-anchor="middle" x="71276" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="71276" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="71276" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,512]</text>
</g>
<!-- L4_expert7_ffn2_15 -->
<g id="node703" class="node">
<title>L4_expert7_ffn2_15</title>
<polygon fill="none" stroke="black" points="77108,-2580.5 76972,-2580.5 76972,-2512.5 77108,-2512.5 77108,-2580.5"/>
<text text-anchor="middle" x="77040" y="-2565.3" font-family="Times,serif" font-size="14.00">Expert 7 FFN2</text>
<text text-anchor="middle" x="77040" y="-2550.3" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="77040" y="-2535.3" font-family="Times,serif" font-size="14.00">Dim Slice 3</text>
<text text-anchor="middle" x="77040" y="-2520.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,128]</text>
</g>
<!-- L4_expert7_ffn2_15&#45;&gt;L4_expert_concat_head3 -->
<g id="edge192" class="edge">
<title>L4_expert7_ffn2_15&#45;&gt;L4_expert_concat_head3</title>
<path fill="none" stroke="black" d="M77054.03,-2512.36C77066.62,-2487 77087.65,-2453.49 77117,-2436 77217.29,-2376.23 77541.36,-2357.03 77728.74,-2350.88"/>
<polygon fill="black" stroke="black" points="77729.05,-2354.37 77738.94,-2350.55 77728.83,-2347.38 77729.05,-2354.37"/>
</g>
<!-- L4_expert7_gate_15 -->
<g id="node704" class="node">
<title>L4_expert7_gate_15</title>
<polygon fill="none" stroke="black" points="70910,-2599.5 70792,-2546.5 70910,-2493.5 71028,-2546.5 70910,-2599.5"/>
<text text-anchor="middle" x="70910" y="-2557.8" font-family="Times,serif" font-size="14.00">Expert 7 Gate</text>
<text text-anchor="middle" x="70910" y="-2542.8" font-family="Times,serif" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="70910" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,1]</text>
</g>
<!-- L1_concat_heads -->
<g id="node739" class="node">
<title>L1_concat_heads</title>
<polygon fill="none" stroke="black" points="62825,-2258 62661,-2205 62825,-2152 62989,-2205 62825,-2258"/>
<text text-anchor="middle" x="62825" y="-2216.3" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="62825" y="-2201.3" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="62825" y="-2186.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- L1_concat_dim_head0&#45;&gt;L1_concat_heads -->
<g id="edge194" class="edge">
<title>L1_concat_dim_head0&#45;&gt;L1_concat_heads</title>
<path fill="none" stroke="black" d="M54255.78,-2345.39C54991.74,-2341.97 58451.21,-2323.02 61281,-2258 61790.53,-2246.29 62394.36,-2223.31 62671.74,-2212.25"/>
<polygon fill="black" stroke="black" points="62672.02,-2215.74 62681.88,-2211.84 62671.75,-2208.75 62672.02,-2215.74"/>
</g>
<!-- L2_concat_heads -->
<g id="node740" class="node">
<title>L2_concat_heads</title>
<polygon fill="none" stroke="black" points="62825,-1721 62661,-1668 62825,-1615 62989,-1668 62825,-1721"/>
<text text-anchor="middle" x="62825" y="-1679.3" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="62825" y="-1664.3" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="62825" y="-1649.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- L2_concat_dim_head0&#45;&gt;L2_concat_heads -->
<g id="edge198" class="edge">
<title>L2_concat_dim_head0&#45;&gt;L2_concat_heads</title>
<path fill="none" stroke="black" d="M51740.45,-2334.71C52067.45,-2300.38 52995,-2191.75 52995,-2064 52995,-2064 52995,-2064 52995,-1920 52995,-1668.31 61341.7,-1667.34 62652.65,-1668.74"/>
<polygon fill="black" stroke="black" points="62653.09,-1672.24 62663.09,-1668.76 62653.09,-1665.24 62653.09,-1672.24"/>
</g>
<!-- L3_concat_heads -->
<g id="node741" class="node">
<title>L3_concat_heads</title>
<polygon fill="none" stroke="black" points="62825,-1184 62661,-1131 62825,-1078 62989,-1131 62825,-1184"/>
<text text-anchor="middle" x="62825" y="-1142.3" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="62825" y="-1127.3" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="62825" y="-1112.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- L3_concat_dim_head0&#45;&gt;L3_concat_heads -->
<g id="edge202" class="edge">
<title>L3_concat_dim_head0&#45;&gt;L3_concat_heads</title>
<path fill="none" stroke="black" d="M50289.82,-2330.79C50374.93,-2318.71 50499.6,-2302.48 50609,-2294 50671.51,-2289.15 51690.69,-2300.27 51737,-2258 51801.17,-2199.43 51761,-2150.88 51761,-2064 51761,-2064 51761,-2064 51761,-1383 51761,-1240.46 61275.94,-1146.43 62658.33,-1133.52"/>
<polygon fill="black" stroke="black" points="62658.36,-1137.02 62668.33,-1133.43 62658.3,-1130.02 62658.36,-1137.02"/>
</g>
<!-- L4_concat_heads -->
<g id="node742" class="node">
<title>L4_concat_heads</title>
<polygon fill="none" stroke="black" points="62825,-647 62661,-594 62825,-541 62989,-594 62825,-647"/>
<text text-anchor="middle" x="62825" y="-605.3" font-family="Times,serif" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="62825" y="-590.3" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="62825" y="-575.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- L4_concat_dim_head0&#45;&gt;L4_concat_heads -->
<g id="edge206" class="edge">
<title>L4_concat_dim_head0&#45;&gt;L4_concat_heads</title>
<path fill="none" stroke="black" d="M48594.5,-2330.44C48679.61,-2318.01 48804.97,-2301.49 48915,-2294 48953.05,-2291.41 51634.21,-2285.15 51661,-2258 51718.2,-2200.05 51609,-1608.43 51609,-1527 51609,-1527 51609,-1527 51609,-846 51609,-701.43 61264.79,-609.05 62658.24,-596.47"/>
<polygon fill="black" stroke="black" points="62658.35,-599.97 62668.32,-596.38 62658.29,-592.97 62658.35,-599.97"/>
</g>
<!-- L1_expert_final -->
<g id="node745" class="node">
<title>L1_expert_final</title>
<polygon fill="none" stroke="black" points="62825,-1974 62665,-1921 62825,-1868 62985,-1921 62825,-1974"/>
<text text-anchor="middle" x="62825" y="-1932.3" font-family="Times,serif" font-size="14.00">Final Expert Concat</text>
<text text-anchor="middle" x="62825" y="-1917.3" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="62825" y="-1902.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- L1_expert_concat_head0&#45;&gt;L1_expert_final -->
<g id="edge213" class="edge">
<title>L1_expert_concat_head0&#45;&gt;L1_expert_final</title>
<path fill="none" stroke="black" d="M52579.58,-2341.18C52835.01,-2331.17 53446.17,-2307.95 53959,-2294 54767.75,-2271.99 54970.41,-2285.27 55779,-2258 58557.44,-2164.29 61948.67,-1972.58 62681.24,-1930.35"/>
<polygon fill="black" stroke="black" points="62681.52,-1933.84 62691.3,-1929.77 62681.12,-1926.85 62681.52,-1933.84"/>
</g>
<!-- L2_expert_final -->
<g id="node749" class="node">
<title>L2_expert_final</title>
<polygon fill="none" stroke="black" points="62825,-1437 62665,-1384 62825,-1331 62985,-1384 62825,-1437"/>
<text text-anchor="middle" x="62825" y="-1395.3" font-family="Times,serif" font-size="14.00">Final Expert Concat</text>
<text text-anchor="middle" x="62825" y="-1380.3" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="62825" y="-1365.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- L2_expert_concat_head0&#45;&gt;L2_expert_final -->
<g id="edge221" class="edge">
<title>L2_expert_concat_head0&#45;&gt;L2_expert_final</title>
<path fill="none" stroke="black" d="M50866.83,-2337.92C51128.8,-2318.93 51757.4,-2272.05 51775,-2258 51845.74,-2201.53 51837,-2154.52 51837,-2064 51837,-2064 51837,-2064 51837,-1667 51837,-1384.02 61275.5,-1383.35 62657.05,-1384.76"/>
<polygon fill="black" stroke="black" points="62657.29,-1388.26 62667.29,-1384.77 62657.3,-1381.26 62657.29,-1388.26"/>
</g>
<!-- L3_expert_final -->
<g id="node753" class="node">
<title>L3_expert_final</title>
<polygon fill="none" stroke="black" points="62825,-900 62665,-847 62825,-794 62985,-847 62825,-900"/>
<text text-anchor="middle" x="62825" y="-858.3" font-family="Times,serif" font-size="14.00">Final Expert Concat</text>
<text text-anchor="middle" x="62825" y="-843.3" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="62825" y="-828.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- L3_expert_concat_head0&#45;&gt;L3_expert_final -->
<g id="edge229" class="edge">
<title>L3_expert_concat_head0&#45;&gt;L3_expert_final</title>
<path fill="none" stroke="black" d="M49174.9,-2338.67C49356.88,-2327.34 49722.59,-2305.65 50033,-2294 50079.26,-2292.26 51666.62,-2291.08 51699,-2258 51748.69,-2207.22 51685,-1740 51685,-1669 51685,-1669 51685,-1669 51685,-1130 51685,-842.96 61264.04,-845.78 62656.91,-847.7"/>
<polygon fill="black" stroke="black" points="62656.98,-851.2 62666.99,-847.72 62656.99,-844.2 62656.98,-851.2"/>
</g>
<!-- L4_expert_final -->
<g id="node757" class="node">
<title>L4_expert_final</title>
<polygon fill="none" stroke="black" points="62825,-363 62665,-310 62825,-257 62985,-310 62825,-363"/>
<text text-anchor="middle" x="62825" y="-321.3" font-family="Times,serif" font-size="14.00">Final Expert Concat</text>
<text text-anchor="middle" x="62825" y="-306.3" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="62825" y="-291.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- L4_expert_concat_head0&#45;&gt;L4_expert_final -->
<g id="edge237" class="edge">
<title>L4_expert_concat_head0&#45;&gt;L4_expert_final</title>
<path fill="none" stroke="black" d="M47480.15,-2338.34C47661.85,-2326.49 48028.11,-2304.05 48339,-2294 48383.47,-2292.56 51510.39,-2289.3 51542,-2258 51585.86,-2214.57 51533,-1981.55 51533,-1385 51533,-1385 51533,-1385 51533,-593 51533,-301.89 61252.94,-308.21 62656.83,-310.65"/>
<polygon fill="black" stroke="black" points="62656.98,-314.15 62666.99,-310.66 62657,-307.15 62656.98,-314.15"/>
</g>
<!-- L1_concat_dim_head1&#45;&gt;L1_concat_heads -->
<g id="edge195" class="edge">
<title>L1_concat_dim_head1&#45;&gt;L1_concat_heads</title>
<path fill="none" stroke="black" d="M22905.02,-2345.88C24642.09,-2344.37 41860.83,-2327.91 55779,-2258 58528.04,-2244.19 61880.31,-2214.56 62658.32,-2207.52"/>
<polygon fill="black" stroke="black" points="62658.5,-2211.02 62668.47,-2207.43 62658.44,-2204.02 62658.5,-2211.02"/>
</g>
<!-- L2_concat_dim_head1&#45;&gt;L2_concat_heads -->
<g id="edge199" class="edge">
<title>L2_concat_dim_head1&#45;&gt;L2_concat_heads</title>
<path fill="none" stroke="black" d="M20388.58,-2334.86C20524.19,-2322.05 20758.99,-2301.78 20961,-2294 21386.02,-2277.64 51163.64,-2316 51585,-2258 52462.93,-2137.14 52633.88,-1851.82 53515,-1757 53986.95,-1706.21 61433.39,-1674.53 62655.81,-1669.66"/>
<polygon fill="black" stroke="black" points="62656,-1673.16 62665.99,-1669.62 62655.97,-1666.16 62656,-1673.16"/>
</g>
<!-- L3_concat_dim_head1&#45;&gt;L3_concat_heads -->
<g id="edge203" class="edge">
<title>L3_concat_dim_head1&#45;&gt;L3_concat_heads</title>
<path fill="none" stroke="black" d="M18936.06,-2330.16C19021.16,-2317.52 19146.74,-2300.85 19257,-2294 19312.89,-2290.53 51463.23,-2290.25 51509,-2258 51549.91,-2229.17 51529.99,-2199.07 51547,-2152 51551.85,-2138.57 51723,-1683.28 51723,-1669 51723,-1669 51723,-1669 51723,-1383 51723,-1068.9 52813.22,-1234.03 53127,-1220 55087.44,-1132.37 61518.25,-1131.36 62653.12,-1131.88"/>
<polygon fill="black" stroke="black" points="62653.4,-1135.38 62663.4,-1131.89 62653.4,-1128.38 62653.4,-1135.38"/>
</g>
<!-- L4_concat_dim_head1&#45;&gt;L4_concat_heads -->
<g id="edge207" class="edge">
<title>L4_concat_dim_head1&#45;&gt;L4_concat_heads</title>
<path fill="none" stroke="black" d="M17242.06,-2330.22C17327.16,-2317.62 17452.75,-2300.97 17563,-2294 18164.36,-2256 27806.57,-2270.35 28409,-2258 29052.71,-2244.8 51571,-2028.85 51571,-1385 51571,-1385 51571,-1385 51571,-846 51571,-527.71 52676.02,-697.02 52994,-683 54982.71,-595.31 61509.05,-594.36 62653.07,-594.88"/>
<polygon fill="black" stroke="black" points="62653.42,-598.38 62663.42,-594.89 62653.42,-591.38 62653.42,-598.38"/>
</g>
<!-- L1_expert_concat_head1&#45;&gt;L1_expert_final -->
<g id="edge214" class="edge">
<title>L1_expert_concat_head1&#45;&gt;L1_expert_final</title>
<path fill="none" stroke="black" d="M21225.62,-2340.5C21479.85,-2329.11 22092.76,-2303.22 22607,-2294 25830.48,-2236.18 48399.46,-2312.63 51623,-2258 54998.98,-2200.79 55840.91,-2106.26 59216,-2010 60550.64,-1971.93 62163.22,-1936.28 62666.92,-1925.39"/>
<polygon fill="black" stroke="black" points="62667.25,-1928.88 62677.17,-1925.17 62667.09,-1921.88 62667.25,-1928.88"/>
</g>
<!-- L2_expert_concat_head1&#45;&gt;L2_expert_final -->
<g id="edge222" class="edge">
<title>L2_expert_concat_head1&#45;&gt;L2_expert_final</title>
<path fill="none" stroke="black" d="M19509.37,-2335.84C19649.79,-2323.11 19903.54,-2301.98 20121,-2294 20175.52,-2292 51502.4,-2289.43 51547,-2258 51587.91,-2229.17 51563.57,-2197.23 51585,-2152 51664.12,-1984.99 51799,-1980.3 51799,-1795.5 51799,-1795.5 51799,-1795.5 51799,-1667 51799,-1439.83 51913.94,-1529.68 52269,-1473 52803.68,-1387.65 61348.62,-1384.89 62657.38,-1384.97"/>
<polygon fill="black" stroke="black" points="62657.8,-1388.47 62667.8,-1384.97 62657.8,-1381.47 62657.8,-1388.47"/>
</g>
<!-- L3_expert_concat_head1&#45;&gt;L3_expert_final -->
<g id="edge230" class="edge">
<title>L3_expert_concat_head1&#45;&gt;L3_expert_final</title>
<path fill="none" stroke="black" d="M17821.03,-2338.04C18002.33,-2325.7 18369.43,-2302.49 18681,-2294 18737.91,-2292.45 51426.3,-2293.25 51471,-2258 51503.8,-2232.13 51647,-1568.77 51647,-1527 51647,-1527 51647,-1527 51647,-1130 51647,-900.29 51755.25,-993.96 52123,-936 52665.63,-850.48 61340.63,-847.87 62657.91,-847.97"/>
<polygon fill="black" stroke="black" points="62657.92,-851.47 62667.92,-847.97 62657.92,-844.47 62657.92,-851.47"/>
</g>
<!-- L4_expert_concat_head1&#45;&gt;L4_expert_final -->
<g id="edge238" class="edge">
<title>L4_expert_concat_head1&#45;&gt;L4_expert_final</title>
<path fill="none" stroke="black" d="M16128.9,-2338.62C16310.87,-2327.21 16676.58,-2305.42 16987,-2294 17145.37,-2288.17 28395,-2222.48 28395,-2064 28395,-2064 28395,-2064 28395,-593 28395,-363.63 60078.21,-314.82 62658.39,-311.22"/>
<polygon fill="black" stroke="black" points="62658.65,-314.72 62668.64,-311.21 62658.64,-307.72 62658.65,-314.72"/>
</g>
<!-- L1_concat_dim_head2&#45;&gt;L1_concat_heads -->
<g id="edge196" class="edge">
<title>L1_concat_dim_head2&#45;&gt;L1_concat_heads</title>
<path fill="none" stroke="black" d="M102327.17,-2345.84C100616.13,-2343.88 83868.9,-2323.44 70330,-2258 67389.36,-2243.79 63800.68,-2214.22 62992.06,-2207.42"/>
<polygon fill="black" stroke="black" points="62991.84,-2203.91 62981.81,-2207.33 62991.78,-2210.91 62991.84,-2203.91"/>
</g>
<!-- L2_concat_dim_head2&#45;&gt;L2_concat_heads -->
<g id="edge200" class="edge">
<title>L2_concat_dim_head2&#45;&gt;L2_concat_heads</title>
<path fill="none" stroke="black" d="M104063.94,-2330.16C103978.84,-2317.52 103853.26,-2300.84 103743,-2294 103628,-2286.86 70666.07,-2297.96 70558,-2258 70490,-2232.85 70501.15,-2179.34 70434,-2152 69720.71,-1861.6 64015.73,-1700.02 62984.49,-1673.05"/>
<polygon fill="black" stroke="black" points="62984.5,-1669.55 62974.42,-1672.79 62984.32,-1676.55 62984.5,-1669.55"/>
</g>
<!-- L3_concat_dim_head2&#45;&gt;L3_concat_heads -->
<g id="edge204" class="edge">
<title>L3_concat_dim_head2&#45;&gt;L3_concat_heads</title>
<path fill="none" stroke="black" d="M105757.94,-2330.16C105672.85,-2317.52 105547.26,-2300.84 105437,-2294 105376.69,-2290.26 70681.72,-2295.06 70634,-2258 70550.01,-2192.78 70477.11,-1399.77 70396,-1331 69962.81,-963.73 69690.2,-1248.65 69123,-1220 67880.13,-1157.21 63868.84,-1136.51 62994.36,-1132.69"/>
<polygon fill="black" stroke="black" points="62994.23,-1129.19 62984.22,-1132.65 62994.2,-1136.19 62994.23,-1129.19"/>
</g>
<!-- L4_concat_dim_head2&#45;&gt;L4_concat_heads -->
<g id="edge208" class="edge">
<title>L4_concat_dim_head2&#45;&gt;L4_concat_heads</title>
<path fill="none" stroke="black" d="M107449.42,-2334.86C107313.81,-2322.04 107079.01,-2301.76 106877,-2294 106814.26,-2291.59 70757.03,-2299.61 70710,-2258 70644.93,-2200.43 70686,-2150.88 70686,-2064 70686,-2064 70686,-2064 70686,-1920 70686,-1676.88 70572,-1628.12 70572,-1385 70572,-1385 70572,-1385 70572,-846 70572,-549.78 69544.86,-697.65 69249,-683 67979.65,-620.15 63879.64,-599.46 62994.47,-595.68"/>
<polygon fill="black" stroke="black" points="62994.22,-592.18 62984.2,-595.63 62994.19,-599.18 62994.22,-592.18"/>
</g>
<!-- L1_expert_concat_head2&#45;&gt;L1_expert_final -->
<g id="edge215" class="edge">
<title>L1_expert_concat_head2&#45;&gt;L1_expert_final</title>
<path fill="none" stroke="black" d="M103484.97,-2338.04C103303.67,-2325.7 102936.57,-2302.49 102625,-2294 100839.94,-2245.33 72266.52,-2323.61 70482,-2258 69830.96,-2234.06 69670.37,-2189.99 69020,-2152 67597.91,-2068.93 67241.54,-2062.49 65818,-2010 64732.75,-1969.98 63425.61,-1936.68 62981.41,-1925.78"/>
<polygon fill="black" stroke="black" points="62981.48,-1922.28 62971.4,-1925.53 62981.31,-1929.27 62981.48,-1922.28"/>
</g>
<!-- L2_expert_concat_head2&#45;&gt;L2_expert_final -->
<g id="edge223" class="edge">
<title>L2_expert_concat_head2&#45;&gt;L2_expert_final</title>
<path fill="none" stroke="black" d="M105178.97,-2338.04C104997.67,-2325.69 104630.57,-2302.49 104319,-2294 104260.47,-2292.41 70644.87,-2290.24 70596,-2258 70466.21,-2172.37 70445.86,-1706.32 70320,-1615 70013.55,-1392.66 64073.21,-1384.49 62992.82,-1384.84"/>
<polygon fill="black" stroke="black" points="62992.65,-1381.34 62982.65,-1384.85 62992.65,-1388.34 62992.65,-1381.34"/>
</g>
<!-- L3_expert_concat_head2&#45;&gt;L3_expert_final -->
<g id="edge231" class="edge">
<title>L3_expert_concat_head2&#45;&gt;L3_expert_final</title>
<path fill="none" stroke="black" d="M106624.63,-2335.84C106484.21,-2323.1 106230.46,-2301.96 106013,-2294 105951.69,-2291.75 70719.46,-2296.89 70672,-2258 70595.46,-2195.29 70496,-1483.95 70496,-1385 70496,-1385 70496,-1385 70496,-1130 70496,-765.22 69230.3,-954.73 68866,-936 67675.18,-874.76 63834.56,-852.89 62990.18,-848.76"/>
<polygon fill="black" stroke="black" points="62990.1,-845.26 62980.08,-848.71 62990.06,-852.26 62990.1,-845.26"/>
</g>
<!-- L4_expert_concat_head2&#45;&gt;L4_expert_final -->
<g id="edge239" class="edge">
<title>L4_expert_concat_head2&#45;&gt;L4_expert_final</title>
<path fill="none" stroke="black" d="M109097.89,-2340.68C108843.36,-2329.66 108230.89,-2304.5 107717,-2294 107460.15,-2288.75 70724,-2320.9 70724,-2064 70724,-2064 70724,-2064 70724,-593 70724,-231.51 78154.11,-861.27 68986,-399 67769.97,-337.69 63844.95,-315.83 62990.29,-311.74"/>
<polygon fill="black" stroke="black" points="62990.09,-308.24 62980.07,-311.69 62990.05,-315.24 62990.09,-308.24"/>
</g>
<!-- L1_concat_dim_head3&#45;&gt;L1_concat_heads -->
<g id="edge197" class="edge">
<title>L1_concat_dim_head3&#45;&gt;L1_concat_heads</title>
<path fill="none" stroke="black" d="M70980.98,-2343.69C69999.96,-2327.13 64052.71,-2226.73 62988.08,-2208.75"/>
<polygon fill="black" stroke="black" points="62988.11,-2205.25 62978.06,-2208.58 62988,-2212.25 62988.11,-2205.25"/>
</g>
<!-- L2_concat_dim_head3&#45;&gt;L2_concat_heads -->
<g id="edge201" class="edge">
<title>L2_concat_dim_head3&#45;&gt;L2_concat_heads</title>
<path fill="none" stroke="black" d="M72711.06,-2330.49C72625.96,-2318.14 72500.83,-2301.7 72391,-2294 71460.26,-2228.72 71223.85,-2304.77 70292,-2258 69725.42,-2229.56 69585.46,-2197.6 69020,-2152 66596.61,-1956.56 63638.85,-1730.9 62965.76,-1679.7"/>
<polygon fill="black" stroke="black" points="62965.77,-1676.19 62955.54,-1678.92 62965.24,-1683.17 62965.77,-1676.19"/>
</g>
<!-- L3_concat_dim_head3&#45;&gt;L3_concat_heads -->
<g id="edge205" class="edge">
<title>L3_concat_dim_head3&#45;&gt;L3_concat_heads</title>
<path fill="none" stroke="black" d="M74405.5,-2330.34C74320.4,-2317.86 74195.04,-2301.31 74085,-2294 74034.01,-2290.61 70444.12,-2292.03 70406,-2258 70341.19,-2200.14 70382,-2150.88 70382,-2064 70382,-2064 70382,-2064 70382,-1383 70382,-1191.63 64108.2,-1140.61 62993.37,-1133.06"/>
<polygon fill="black" stroke="black" points="62993.3,-1129.56 62983.27,-1132.99 62993.25,-1136.56 62993.3,-1129.56"/>
</g>
<!-- L4_concat_dim_head3&#45;&gt;L4_concat_heads -->
<g id="edge209" class="edge">
<title>L4_concat_dim_head3&#45;&gt;L4_concat_heads</title>
<path fill="none" stroke="black" d="M76096.81,-2335.02C75961.1,-2322.4 75726.68,-2302.37 75525,-2294 75490.27,-2292.56 70544.49,-2282.67 70520,-2258 70486.81,-2224.57 70518.57,-2199.09 70520,-2152 70523.11,-2049.64 70534,-2024.41 70534,-1922 70534,-1922 70534,-1922 70534,-846 70534,-650.6 64122.04,-602.84 62993.58,-595.95"/>
<polygon fill="black" stroke="black" points="62993.38,-592.45 62983.36,-595.89 62993.34,-599.45 62993.38,-592.45"/>
</g>
<!-- L1_expert_concat_head3&#45;&gt;L1_expert_final -->
<g id="edge216" class="edge">
<title>L1_expert_concat_head3&#45;&gt;L1_expert_final</title>
<path fill="none" stroke="black" d="M72129.96,-2339.11C71947.58,-2328.43 71582.69,-2307.7 71273,-2294 70816.28,-2273.8 70701.8,-2276.34 70245,-2258 67314.53,-2140.34 63734.47,-1966.54 62972.06,-1929.22"/>
<polygon fill="black" stroke="black" points="62972.01,-1925.71 62961.85,-1928.72 62971.67,-1932.71 62972.01,-1925.71"/>
</g>
<!-- L2_expert_concat_head3&#45;&gt;L2_expert_final -->
<g id="edge224" class="edge">
<title>L2_expert_concat_head3&#45;&gt;L2_expert_final</title>
<path fill="none" stroke="black" d="M73825.85,-2338.43C73644.14,-2326.72 73277.88,-2304.46 72967,-2294 72894.84,-2291.57 70426.01,-2300.98 70368,-2258 70295.27,-2204.11 70306,-2154.52 70306,-2064 70306,-2064 70306,-2064 70306,-1667 70306,-1477.29 64080.22,-1399.03 62987.68,-1386.75"/>
<polygon fill="black" stroke="black" points="62987.44,-1383.25 62977.4,-1386.64 62987.36,-1390.25 62987.44,-1383.25"/>
</g>
<!-- L3_expert_concat_head3&#45;&gt;L3_expert_final -->
<g id="edge232" class="edge">
<title>L3_expert_concat_head3&#45;&gt;L3_expert_final</title>
<path fill="none" stroke="black" d="M75272.01,-2336.04C75131.46,-2323.56 74878.12,-2302.77 74661,-2294 74602.48,-2291.64 70485.24,-2299.59 70444,-2258 70410.83,-2224.55 70443.32,-2199.11 70444,-2152 70447.11,-1937.27 70458,-1883.76 70458,-1669 70458,-1669 70458,-1669 70458,-1130 70458,-936.26 64093.86,-861.21 62987.88,-849.63"/>
<polygon fill="black" stroke="black" points="62987.51,-846.13 62977.47,-849.52 62987.43,-853.12 62987.51,-846.13"/>
</g>
<!-- L4_expert_concat_head3&#45;&gt;L4_expert_final -->
<g id="edge240" class="edge">
<title>L4_expert_concat_head3&#45;&gt;L4_expert_final</title>
<path fill="none" stroke="black" d="M77745.89,-2340.68C77491.36,-2329.67 76878.89,-2304.51 76365,-2294 76325.11,-2293.18 70648.54,-2285.88 70620,-2258 70513.13,-2153.61 70610,-2071.4 70610,-1922 70610,-1922 70610,-1922 70610,-593 70610,-395.23 64107.15,-323.41 62988.01,-312.51"/>
<polygon fill="black" stroke="black" points="62987.92,-309.01 62977.89,-312.41 62987.85,-316.01 62987.92,-309.01"/>
</g>
<!-- input -->
<g id="node737" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="62825" cy="-2546.5" rx="106.5" ry="106.5"/>
<ellipse fill="none" stroke="black" cx="62825" cy="-2546.5" rx="110.5" ry="110.5"/>
<text text-anchor="middle" x="62825" y="-2550.3" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="62825" y="-2535.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- L1_norm1 -->
<g id="node738" class="node">
<title>L1_norm1</title>
<ellipse fill="none" stroke="black" cx="62825" cy="-2347" rx="102.5" ry="37.5"/>
<text text-anchor="middle" x="62825" y="-2358.3" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="62825" y="-2343.3" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="62825" y="-2328.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- input&#45;&gt;L1_norm1 -->
<g id="edge193" class="edge">
<title>input&#45;&gt;L1_norm1</title>
<path fill="none" stroke="black" d="M62825,-2435.78C62825,-2421.35 62825,-2407.24 62825,-2394.69"/>
<polygon fill="black" stroke="black" points="62828.5,-2394.56 62825,-2384.56 62821.5,-2394.56 62828.5,-2394.56"/>
</g>
<!-- L1_norm1&#45;&gt;L1_concat_heads -->
<g id="edge211" class="edge">
<title>L1_norm1&#45;&gt;L1_concat_heads</title>
<path fill="none" stroke="black" d="M62825,-2309.22C62825,-2296.63 62825,-2282.19 62825,-2268.17"/>
<polygon fill="black" stroke="black" points="62828.5,-2268.07 62825,-2258.07 62821.5,-2268.07 62828.5,-2268.07"/>
</g>
<!-- L1_router -->
<g id="node743" class="node">
<title>L1_router</title>
<polygon fill="none" stroke="black" points="62825,-2116 62707,-2063 62825,-2010 62943,-2063 62825,-2116"/>
<text text-anchor="middle" x="62825" y="-2074.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="62825" y="-2059.3" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="62825" y="-2044.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,8]</text>
</g>
<!-- L1_concat_heads&#45;&gt;L1_router -->
<g id="edge210" class="edge">
<title>L1_concat_heads&#45;&gt;L1_router</title>
<path fill="none" stroke="black" d="M62825,-2151.87C62825,-2143.58 62825,-2134.93 62825,-2126.43"/>
<polygon fill="black" stroke="black" points="62828.5,-2126.17 62825,-2116.17 62821.5,-2126.17 62828.5,-2126.17"/>
</g>
<!-- L2_router -->
<g id="node747" class="node">
<title>L2_router</title>
<polygon fill="none" stroke="black" points="62825,-1579 62707,-1526 62825,-1473 62943,-1526 62825,-1579"/>
<text text-anchor="middle" x="62825" y="-1537.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="62825" y="-1522.3" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="62825" y="-1507.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,8]</text>
</g>
<!-- L2_concat_heads&#45;&gt;L2_router -->
<g id="edge218" class="edge">
<title>L2_concat_heads&#45;&gt;L2_router</title>
<path fill="none" stroke="black" d="M62825,-1614.87C62825,-1606.58 62825,-1597.93 62825,-1589.43"/>
<polygon fill="black" stroke="black" points="62828.5,-1589.17 62825,-1579.17 62821.5,-1589.17 62828.5,-1589.17"/>
</g>
<!-- L3_router -->
<g id="node751" class="node">
<title>L3_router</title>
<polygon fill="none" stroke="black" points="62825,-1042 62707,-989 62825,-936 62943,-989 62825,-1042"/>
<text text-anchor="middle" x="62825" y="-1000.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="62825" y="-985.3" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="62825" y="-970.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,8]</text>
</g>
<!-- L3_concat_heads&#45;&gt;L3_router -->
<g id="edge226" class="edge">
<title>L3_concat_heads&#45;&gt;L3_router</title>
<path fill="none" stroke="black" d="M62825,-1077.87C62825,-1069.58 62825,-1060.93 62825,-1052.43"/>
<polygon fill="black" stroke="black" points="62828.5,-1052.17 62825,-1042.17 62821.5,-1052.17 62828.5,-1052.17"/>
</g>
<!-- L4_router -->
<g id="node755" class="node">
<title>L4_router</title>
<polygon fill="none" stroke="black" points="62825,-505 62707,-452 62825,-399 62943,-452 62825,-505"/>
<text text-anchor="middle" x="62825" y="-463.3" font-family="Times,serif" font-size="14.00">Router</text>
<text text-anchor="middle" x="62825" y="-448.3" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="62825" y="-433.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,8]</text>
</g>
<!-- L4_concat_heads&#45;&gt;L4_router -->
<g id="edge234" class="edge">
<title>L4_concat_heads&#45;&gt;L4_router</title>
<path fill="none" stroke="black" d="M62825,-540.87C62825,-532.58 62825,-523.93 62825,-515.43"/>
<polygon fill="black" stroke="black" points="62828.5,-515.17 62825,-505.17 62821.5,-515.17 62828.5,-515.17"/>
</g>
<!-- L1_router&#45;&gt;L1_expert_final -->
<g id="edge212" class="edge">
<title>L1_router&#45;&gt;L1_expert_final</title>
<path fill="none" stroke="black" d="M62825,-2009.87C62825,-2001.58 62825,-1992.93 62825,-1984.43"/>
<polygon fill="black" stroke="black" points="62828.5,-1984.17 62825,-1974.17 62821.5,-1984.17 62828.5,-1984.17"/>
</g>
<!-- L1_norm2 -->
<g id="node744" class="node">
<title>L1_norm2</title>
<ellipse fill="none" stroke="black" cx="125755" cy="-2546.5" rx="102.5" ry="37.5"/>
<text text-anchor="middle" x="125755" y="-2557.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="125755" y="-2542.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="125755" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- L2_norm1 -->
<g id="node746" class="node">
<title>L2_norm1</title>
<ellipse fill="none" stroke="black" cx="62825" cy="-1794.5" rx="102.5" ry="37.5"/>
<text text-anchor="middle" x="62825" y="-1805.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="62825" y="-1790.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="62825" y="-1775.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- L1_expert_final&#45;&gt;L2_norm1 -->
<g id="edge217" class="edge">
<title>L1_expert_final&#45;&gt;L2_norm1</title>
<path fill="none" stroke="black" d="M62825,-1867.92C62825,-1859.49 62825,-1850.8 62825,-1842.5"/>
<polygon fill="black" stroke="black" points="62828.5,-1842.23 62825,-1832.23 62821.5,-1842.23 62828.5,-1842.23"/>
</g>
<!-- L2_norm1&#45;&gt;L2_concat_heads -->
<g id="edge219" class="edge">
<title>L2_norm1&#45;&gt;L2_concat_heads</title>
<path fill="none" stroke="black" d="M62825,-1756.82C62825,-1748.78 62825,-1740.05 62825,-1731.31"/>
<polygon fill="black" stroke="black" points="62828.5,-1731.1 62825,-1721.1 62821.5,-1731.1 62828.5,-1731.1"/>
</g>
<!-- L2_router&#45;&gt;L2_expert_final -->
<g id="edge220" class="edge">
<title>L2_router&#45;&gt;L2_expert_final</title>
<path fill="none" stroke="black" d="M62825,-1472.87C62825,-1464.58 62825,-1455.93 62825,-1447.43"/>
<polygon fill="black" stroke="black" points="62828.5,-1447.17 62825,-1437.17 62821.5,-1447.17 62828.5,-1447.17"/>
</g>
<!-- L2_norm2 -->
<g id="node748" class="node">
<title>L2_norm2</title>
<ellipse fill="none" stroke="black" cx="125978" cy="-2546.5" rx="102.5" ry="37.5"/>
<text text-anchor="middle" x="125978" y="-2557.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="125978" y="-2542.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="125978" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- L3_norm1 -->
<g id="node750" class="node">
<title>L3_norm1</title>
<ellipse fill="none" stroke="black" cx="62825" cy="-1257.5" rx="102.5" ry="37.5"/>
<text text-anchor="middle" x="62825" y="-1268.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="62825" y="-1253.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="62825" y="-1238.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- L2_expert_final&#45;&gt;L3_norm1 -->
<g id="edge225" class="edge">
<title>L2_expert_final&#45;&gt;L3_norm1</title>
<path fill="none" stroke="black" d="M62825,-1330.92C62825,-1322.49 62825,-1313.8 62825,-1305.5"/>
<polygon fill="black" stroke="black" points="62828.5,-1305.23 62825,-1295.23 62821.5,-1305.23 62828.5,-1305.23"/>
</g>
<!-- L3_norm1&#45;&gt;L3_concat_heads -->
<g id="edge227" class="edge">
<title>L3_norm1&#45;&gt;L3_concat_heads</title>
<path fill="none" stroke="black" d="M62825,-1219.82C62825,-1211.78 62825,-1203.05 62825,-1194.31"/>
<polygon fill="black" stroke="black" points="62828.5,-1194.1 62825,-1184.1 62821.5,-1194.1 62828.5,-1194.1"/>
</g>
<!-- L3_router&#45;&gt;L3_expert_final -->
<g id="edge228" class="edge">
<title>L3_router&#45;&gt;L3_expert_final</title>
<path fill="none" stroke="black" d="M62825,-935.87C62825,-927.58 62825,-918.93 62825,-910.43"/>
<polygon fill="black" stroke="black" points="62828.5,-910.17 62825,-900.17 62821.5,-910.17 62828.5,-910.17"/>
</g>
<!-- L3_norm2 -->
<g id="node752" class="node">
<title>L3_norm2</title>
<ellipse fill="none" stroke="black" cx="126201" cy="-2546.5" rx="102.5" ry="37.5"/>
<text text-anchor="middle" x="126201" y="-2557.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="126201" y="-2542.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="126201" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- L4_norm1 -->
<g id="node754" class="node">
<title>L4_norm1</title>
<ellipse fill="none" stroke="black" cx="62825" cy="-720.5" rx="102.5" ry="37.5"/>
<text text-anchor="middle" x="62825" y="-731.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="62825" y="-716.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="62825" y="-701.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- L3_expert_final&#45;&gt;L4_norm1 -->
<g id="edge233" class="edge">
<title>L3_expert_final&#45;&gt;L4_norm1</title>
<path fill="none" stroke="black" d="M62825,-793.92C62825,-785.49 62825,-776.8 62825,-768.5"/>
<polygon fill="black" stroke="black" points="62828.5,-768.23 62825,-758.23 62821.5,-768.23 62828.5,-768.23"/>
</g>
<!-- L4_norm1&#45;&gt;L4_concat_heads -->
<g id="edge235" class="edge">
<title>L4_norm1&#45;&gt;L4_concat_heads</title>
<path fill="none" stroke="black" d="M62825,-682.82C62825,-674.78 62825,-666.05 62825,-657.31"/>
<polygon fill="black" stroke="black" points="62828.5,-657.1 62825,-647.1 62821.5,-657.1 62828.5,-657.1"/>
</g>
<!-- L4_router&#45;&gt;L4_expert_final -->
<g id="edge236" class="edge">
<title>L4_router&#45;&gt;L4_expert_final</title>
<path fill="none" stroke="black" d="M62825,-398.87C62825,-390.58 62825,-381.93 62825,-373.43"/>
<polygon fill="black" stroke="black" points="62828.5,-373.17 62825,-363.17 62821.5,-373.17 62828.5,-373.17"/>
</g>
<!-- L4_norm2 -->
<g id="node756" class="node">
<title>L4_norm2</title>
<ellipse fill="none" stroke="black" cx="126424" cy="-2546.5" rx="102.5" ry="37.5"/>
<text text-anchor="middle" x="126424" y="-2557.8" font-family="Times,serif" font-size="14.00">Layer Norm</text>
<text text-anchor="middle" x="126424" y="-2542.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="126424" y="-2527.8" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- output -->
<g id="node758" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="62825" cy="-110.5" rx="106.5" ry="106.5"/>
<ellipse fill="none" stroke="black" cx="62825" cy="-110.5" rx="110.5" ry="110.5"/>
<text text-anchor="middle" x="62825" y="-114.3" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="62825" y="-99.3" font-family="Times,serif" font-size="14.00">Shape: [B,L,8192]</text>
</g>
<!-- L4_expert_final&#45;&gt;output -->
<g id="edge241" class="edge">
<title>L4_expert_final&#45;&gt;output</title>
<path fill="none" stroke="black" d="M62825,-256.85C62825,-248.8 62825,-240.21 62825,-231.38"/>
<polygon fill="black" stroke="black" points="62828.5,-231.33 62825,-221.33 62821.5,-231.33 62828.5,-231.33"/>
</g>
</g>
</svg>
