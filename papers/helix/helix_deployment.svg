<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: helix_deployment Pages: 1 -->
<svg width="35402pt" height="5133pt"
 viewBox="0.00 0.00 35402.00 5133.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 5129)">
<title>helix_deployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-5129 35398,-5129 35398,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="26212,-3890 26212,-4994 35386,-4994 35386,-3890 26212,-3890"/>
<text text-anchor="middle" x="30799" y="-4978.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="20355,-2738 20355,-3842 29529,-3842 29529,-2738 20355,-2738"/>
<text text-anchor="middle" x="24942" y="-3826.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6723,-1446 6723,-2690 23241,-2690 23241,-1446 6723,-1446"/>
<text text-anchor="middle" x="14982" y="-2674.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_4</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-154 8,-1398 16526,-1398 16526,-154 8,-154"/>
<text text-anchor="middle" x="8267" y="-1382.8" font-family="Times,serif" font-size="14.00">Layer 4</text>
</g>
<!-- q_proj_1_0_0 -->
<g id="node1" class="node">
<title>q_proj_1_0_0</title>
<polygon fill="#ff9999" stroke="black" points="34994,-4963 34860,-4963 34860,-4895 34994,-4895 34994,-4963"/>
<text text-anchor="middle" x="34927" y="-4947.8" font-family="Times,serif" font-size="14.00">Q Projection 0_0</text>
<text text-anchor="middle" x="34927" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="34927" y="-4917.8" font-family="Times,serif" font-size="14.00">W_Q^{0,0}</text>
<text text-anchor="middle" x="34927" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- attention_1_0_0 -->
<g id="node2" class="node">
<title>attention_1_0_0</title>
<polygon fill="#ff9999" stroke="black" points="35108.5,-4808 34935.5,-4808 34935.5,-4740 35108.5,-4740 35108.5,-4808"/>
<text text-anchor="middle" x="35022" y="-4792.8" font-family="Times,serif" font-size="14.00">Attention 0_0</text>
<text text-anchor="middle" x="35022" y="-4777.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="35022" y="-4762.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="35022" y="-4747.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- q_proj_1_0_0&#45;&gt;attention_1_0_0 -->
<g id="edge1" class="edge">
<title>q_proj_1_0_0&#45;&gt;attention_1_0_0</title>
<path fill="none" stroke="black" d="M34964.75,-4894.98C34964.75,-4894.98 34964.75,-4818.2 34964.75,-4818.2"/>
<polygon fill="black" stroke="black" points="34968.25,-4818.2 34964.75,-4808.2 34961.25,-4818.2 34968.25,-4818.2"/>
</g>
<!-- concat_group_1_0 -->
<g id="node5" class="node">
<title>concat_group_1_0</title>
<polygon fill="#ffd700" stroke="black" points="33967,-4639 33839,-4586 33967,-4533 34095,-4586 33967,-4639"/>
<text text-anchor="middle" x="33967" y="-4597.3" font-family="Times,serif" font-size="14.00">Concat Group 0</text>
<text text-anchor="middle" x="33967" y="-4582.3" font-family="Times,serif" font-size="14.00">[B×L×d×h_g]</text>
<text text-anchor="middle" x="33967" y="-4567.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- attention_1_0_0&#45;&gt;concat_group_1_0 -->
<g id="edge4" class="edge">
<title>attention_1_0_0&#45;&gt;concat_group_1_0</title>
<path fill="none" stroke="black" d="M35022,-4739.95C35022,-4685.78 35022,-4586 35022,-4586 35022,-4586 34105.05,-4586 34105.05,-4586"/>
<polygon fill="black" stroke="black" points="34105.05,-4582.5 34095.05,-4586 34105.05,-4589.5 34105.05,-4582.5"/>
</g>
<!-- k_proj_1_0_0 -->
<g id="node3" class="node">
<title>k_proj_1_0_0</title>
<polygon fill="#ff9999" stroke="black" points="35378,-4963 35244,-4963 35244,-4895 35378,-4895 35378,-4963"/>
<text text-anchor="middle" x="35311" y="-4947.8" font-family="Times,serif" font-size="14.00">K Projection 0_0</text>
<text text-anchor="middle" x="35311" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="35311" y="-4917.8" font-family="Times,serif" font-size="14.00">W_K^{0,0}</text>
<text text-anchor="middle" x="35311" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- k_proj_1_0_0&#45;&gt;attention_1_0_0 -->
<g id="edge2" class="edge">
<title>k_proj_1_0_0&#45;&gt;attention_1_0_0</title>
<path fill="none" stroke="black" d="M35311,-4894.98C35311,-4849.36 35311,-4774 35311,-4774 35311,-4774 35118.71,-4774 35118.71,-4774"/>
<polygon fill="black" stroke="black" points="35118.71,-4770.5 35108.71,-4774 35118.71,-4777.5 35118.71,-4770.5"/>
</g>
<!-- v_proj_1_0_0 -->
<g id="node4" class="node">
<title>v_proj_1_0_0</title>
<polygon fill="#ff9999" stroke="black" points="35185.5,-4963 35052.5,-4963 35052.5,-4895 35185.5,-4895 35185.5,-4963"/>
<text text-anchor="middle" x="35119" y="-4947.8" font-family="Times,serif" font-size="14.00">V Projection 0_0</text>
<text text-anchor="middle" x="35119" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="35119" y="-4917.8" font-family="Times,serif" font-size="14.00">W_V^{0,0}</text>
<text text-anchor="middle" x="35119" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- v_proj_1_0_0&#45;&gt;attention_1_0_0 -->
<g id="edge3" class="edge">
<title>v_proj_1_0_0&#45;&gt;attention_1_0_0</title>
<path fill="none" stroke="black" d="M35080.5,-4894.98C35080.5,-4894.98 35080.5,-4818.2 35080.5,-4818.2"/>
<polygon fill="black" stroke="black" points="35084,-4818.2 35080.5,-4808.2 35077,-4818.2 35084,-4818.2"/>
</g>
<!-- final_concat_1 -->
<g id="node69" class="node">
<title>final_concat_1</title>
<polygon fill="#ffa500" stroke="black" points="30800,-4446 30635,-4393 30800,-4340 30965,-4393 30800,-4446"/>
<text text-anchor="middle" x="30800" y="-4404.3" font-family="Times,serif" font-size="14.00">Final Concat Layer 1</text>
<text text-anchor="middle" x="30800" y="-4389.3" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="30800" y="-4374.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- concat_group_1_0&#45;&gt;final_concat_1 -->
<g id="edge77" class="edge">
<title>concat_group_1_0&#45;&gt;final_concat_1</title>
<path fill="none" stroke="black" d="M33967,-4532.75C33967,-4475.62 33967,-4393 33967,-4393 33967,-4393 30975.26,-4393 30975.26,-4393"/>
<polygon fill="black" stroke="black" points="30975.26,-4389.5 30965.26,-4393 30975.26,-4396.5 30975.26,-4389.5"/>
</g>
<!-- q_proj_1_0_1 -->
<g id="node6" class="node">
<title>q_proj_1_0_1</title>
<polygon fill="#ffcc99" stroke="black" points="34418,-4963 34284,-4963 34284,-4895 34418,-4895 34418,-4963"/>
<text text-anchor="middle" x="34351" y="-4947.8" font-family="Times,serif" font-size="14.00">Q Projection 0_1</text>
<text text-anchor="middle" x="34351" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="34351" y="-4917.8" font-family="Times,serif" font-size="14.00">W_Q^{0,1}</text>
<text text-anchor="middle" x="34351" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- attention_1_0_1 -->
<g id="node7" class="node">
<title>attention_1_0_1</title>
<polygon fill="#ffcc99" stroke="black" points="34485.5,-4808 34312.5,-4808 34312.5,-4740 34485.5,-4740 34485.5,-4808"/>
<text text-anchor="middle" x="34399" y="-4792.8" font-family="Times,serif" font-size="14.00">Attention 0_1</text>
<text text-anchor="middle" x="34399" y="-4777.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="34399" y="-4762.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="34399" y="-4747.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- q_proj_1_0_1&#45;&gt;attention_1_0_1 -->
<g id="edge5" class="edge">
<title>q_proj_1_0_1&#45;&gt;attention_1_0_1</title>
<path fill="none" stroke="black" d="M34365.25,-4894.98C34365.25,-4894.98 34365.25,-4818.2 34365.25,-4818.2"/>
<polygon fill="black" stroke="black" points="34368.75,-4818.2 34365.25,-4808.2 34361.75,-4818.2 34368.75,-4818.2"/>
</g>
<!-- attention_1_0_1&#45;&gt;concat_group_1_0 -->
<g id="edge8" class="edge">
<title>attention_1_0_1&#45;&gt;concat_group_1_0</title>
<path fill="none" stroke="black" d="M34312.46,-4785C34213.9,-4785 34066.33,-4785 34066.33,-4785 34066.33,-4785 34066.33,-4608.15 34066.33,-4608.15"/>
<polygon fill="black" stroke="black" points="34069.83,-4608.15 34066.33,-4598.15 34062.83,-4608.15 34069.83,-4608.15"/>
</g>
<!-- attention_1_0_1&#45;&gt;concat_group_1_0 -->
<g id="edge9" class="edge">
<title>attention_1_0_1&#45;&gt;concat_group_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M34312.45,-4762C34217.73,-4762 34079.17,-4762 34079.17,-4762 34079.17,-4762 34079.17,-4602.68 34079.17,-4602.68"/>
<polygon fill="red" stroke="red" points="34082.67,-4602.68 34079.17,-4592.68 34075.67,-4602.68 34082.67,-4602.68"/>
<text text-anchor="middle" x="34466" y="-4685.8" font-family="Times,serif" font-size="14.00">AllGather GPU0→GPU1</text>
</g>
<!-- k_proj_1_0_1 -->
<g id="node8" class="node">
<title>k_proj_1_0_1</title>
<polygon fill="#ffcc99" stroke="black" points="34802,-4963 34668,-4963 34668,-4895 34802,-4895 34802,-4963"/>
<text text-anchor="middle" x="34735" y="-4947.8" font-family="Times,serif" font-size="14.00">K Projection 0_1</text>
<text text-anchor="middle" x="34735" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="34735" y="-4917.8" font-family="Times,serif" font-size="14.00">W_K^{0,1}</text>
<text text-anchor="middle" x="34735" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- k_proj_1_0_1&#45;&gt;attention_1_0_1 -->
<g id="edge6" class="edge">
<title>k_proj_1_0_1&#45;&gt;attention_1_0_1</title>
<path fill="none" stroke="black" d="M34735,-4894.98C34735,-4849.36 34735,-4774 34735,-4774 34735,-4774 34495.53,-4774 34495.53,-4774"/>
<polygon fill="black" stroke="black" points="34495.53,-4770.5 34485.53,-4774 34495.53,-4777.5 34495.53,-4770.5"/>
</g>
<!-- v_proj_1_0_1 -->
<g id="node9" class="node">
<title>v_proj_1_0_1</title>
<polygon fill="#ffcc99" stroke="black" points="34609.5,-4963 34476.5,-4963 34476.5,-4895 34609.5,-4895 34609.5,-4963"/>
<text text-anchor="middle" x="34543" y="-4947.8" font-family="Times,serif" font-size="14.00">V Projection 0_1</text>
<text text-anchor="middle" x="34543" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="34543" y="-4917.8" font-family="Times,serif" font-size="14.00">W_V^{0,1}</text>
<text text-anchor="middle" x="34543" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- v_proj_1_0_1&#45;&gt;attention_1_0_1 -->
<g id="edge7" class="edge">
<title>v_proj_1_0_1&#45;&gt;attention_1_0_1</title>
<path fill="none" stroke="black" d="M34481,-4894.98C34481,-4894.98 34481,-4818.2 34481,-4818.2"/>
<polygon fill="black" stroke="black" points="34484.5,-4818.2 34481,-4808.2 34477.5,-4818.2 34484.5,-4818.2"/>
</g>
<!-- q_proj_1_0_2 -->
<g id="node10" class="node">
<title>q_proj_1_0_2</title>
<polygon fill="#ffff99" stroke="black" points="33842,-4963 33708,-4963 33708,-4895 33842,-4895 33842,-4963"/>
<text text-anchor="middle" x="33775" y="-4947.8" font-family="Times,serif" font-size="14.00">Q Projection 0_2</text>
<text text-anchor="middle" x="33775" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="33775" y="-4917.8" font-family="Times,serif" font-size="14.00">W_Q^{0,2}</text>
<text text-anchor="middle" x="33775" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- attention_1_0_2 -->
<g id="node11" class="node">
<title>attention_1_0_2</title>
<polygon fill="#ffff99" stroke="black" points="34053.5,-4808 33880.5,-4808 33880.5,-4740 34053.5,-4740 34053.5,-4808"/>
<text text-anchor="middle" x="33967" y="-4792.8" font-family="Times,serif" font-size="14.00">Attention 0_2</text>
<text text-anchor="middle" x="33967" y="-4777.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="33967" y="-4762.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="33967" y="-4747.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- q_proj_1_0_2&#45;&gt;attention_1_0_2 -->
<g id="edge10" class="edge">
<title>q_proj_1_0_2&#45;&gt;attention_1_0_2</title>
<path fill="none" stroke="black" d="M33842.19,-4917C33867.6,-4917 33890.5,-4917 33890.5,-4917 33890.5,-4917 33890.5,-4818.25 33890.5,-4818.25"/>
<polygon fill="black" stroke="black" points="33894,-4818.25 33890.5,-4808.25 33887,-4818.25 33894,-4818.25"/>
</g>
<!-- attention_1_0_2&#45;&gt;concat_group_1_0 -->
<g id="edge13" class="edge">
<title>attention_1_0_2&#45;&gt;concat_group_1_0</title>
<path fill="none" stroke="black" d="M33938.17,-4739.95C33938.17,-4739.95 33938.17,-4637.34 33938.17,-4637.34"/>
<polygon fill="black" stroke="black" points="33941.67,-4637.34 33938.17,-4627.34 33934.67,-4637.34 33941.67,-4637.34"/>
</g>
<!-- attention_1_0_2&#45;&gt;concat_group_1_0 -->
<g id="edge14" class="edge">
<title>attention_1_0_2&#45;&gt;concat_group_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M33995.83,-4739.95C33995.83,-4739.95 33995.83,-4637.34 33995.83,-4637.34"/>
<polygon fill="red" stroke="red" points="33999.33,-4637.34 33995.83,-4627.34 33992.33,-4637.34 33999.33,-4637.34"/>
<text text-anchor="middle" x="34180" y="-4685.8" font-family="Times,serif" font-size="14.00">AllGather GPU1→GPU2</text>
</g>
<!-- k_proj_1_0_2 -->
<g id="node12" class="node">
<title>k_proj_1_0_2</title>
<polygon fill="#ffff99" stroke="black" points="34226,-4963 34092,-4963 34092,-4895 34226,-4895 34226,-4963"/>
<text text-anchor="middle" x="34159" y="-4947.8" font-family="Times,serif" font-size="14.00">K Projection 0_2</text>
<text text-anchor="middle" x="34159" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="34159" y="-4917.8" font-family="Times,serif" font-size="14.00">W_K^{0,2}</text>
<text text-anchor="middle" x="34159" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- k_proj_1_0_2&#45;&gt;attention_1_0_2 -->
<g id="edge11" class="edge">
<title>k_proj_1_0_2&#45;&gt;attention_1_0_2</title>
<path fill="none" stroke="black" d="M34091.81,-4929C34066.66,-4929 34044.07,-4929 34044.07,-4929 34044.07,-4929 34044.07,-4818.02 34044.07,-4818.02"/>
<polygon fill="black" stroke="black" points="34047.57,-4818.02 34044.07,-4808.02 34040.57,-4818.02 34047.57,-4818.02"/>
</g>
<!-- v_proj_1_0_2 -->
<g id="node13" class="node">
<title>v_proj_1_0_2</title>
<polygon fill="#ffff99" stroke="black" points="34033.5,-4963 33900.5,-4963 33900.5,-4895 34033.5,-4895 34033.5,-4963"/>
<text text-anchor="middle" x="33967" y="-4947.8" font-family="Times,serif" font-size="14.00">V Projection 0_2</text>
<text text-anchor="middle" x="33967" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="33967" y="-4917.8" font-family="Times,serif" font-size="14.00">W_V^{0,2}</text>
<text text-anchor="middle" x="33967" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- v_proj_1_0_2&#45;&gt;attention_1_0_2 -->
<g id="edge12" class="edge">
<title>v_proj_1_0_2&#45;&gt;attention_1_0_2</title>
<path fill="none" stroke="black" d="M33967,-4894.98C33967,-4894.98 33967,-4818.2 33967,-4818.2"/>
<polygon fill="black" stroke="black" points="33970.5,-4818.2 33967,-4808.2 33963.5,-4818.2 33970.5,-4818.2"/>
</g>
<!-- q_proj_1_0_3 -->
<g id="node14" class="node">
<title>q_proj_1_0_3</title>
<polygon fill="#ccff99" stroke="black" points="33650,-4963 33516,-4963 33516,-4895 33650,-4895 33650,-4963"/>
<text text-anchor="middle" x="33583" y="-4947.8" font-family="Times,serif" font-size="14.00">Q Projection 0_3</text>
<text text-anchor="middle" x="33583" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="33583" y="-4917.8" font-family="Times,serif" font-size="14.00">W_Q^{0,3}</text>
<text text-anchor="middle" x="33583" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- attention_1_0_3 -->
<g id="node15" class="node">
<title>attention_1_0_3</title>
<polygon fill="#ccff99" stroke="black" points="33574.5,-4808 33401.5,-4808 33401.5,-4740 33574.5,-4740 33574.5,-4808"/>
<text text-anchor="middle" x="33488" y="-4792.8" font-family="Times,serif" font-size="14.00">Attention 0_3</text>
<text text-anchor="middle" x="33488" y="-4777.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="33488" y="-4762.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="33488" y="-4747.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- q_proj_1_0_3&#45;&gt;attention_1_0_3 -->
<g id="edge15" class="edge">
<title>q_proj_1_0_3&#45;&gt;attention_1_0_3</title>
<path fill="none" stroke="black" d="M33545.25,-4894.98C33545.25,-4894.98 33545.25,-4818.2 33545.25,-4818.2"/>
<polygon fill="black" stroke="black" points="33548.75,-4818.2 33545.25,-4808.2 33541.75,-4818.2 33548.75,-4818.2"/>
</g>
<!-- attention_1_0_3&#45;&gt;concat_group_1_0 -->
<g id="edge18" class="edge">
<title>attention_1_0_3&#45;&gt;concat_group_1_0</title>
<path fill="none" stroke="black" d="M33574.57,-4785C33684.83,-4785 33861.25,-4785 33861.25,-4785 33861.25,-4785 33861.25,-4605.33 33861.25,-4605.33"/>
<polygon fill="black" stroke="black" points="33864.75,-4605.33 33861.25,-4595.33 33857.75,-4605.33 33864.75,-4605.33"/>
</g>
<!-- attention_1_0_3&#45;&gt;concat_group_1_0 -->
<g id="edge19" class="edge">
<title>attention_1_0_3&#45;&gt;concat_group_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M33574.64,-4762C33682.19,-4762 33851.62,-4762 33851.62,-4762 33851.62,-4762 33851.62,-4601.46 33851.62,-4601.46"/>
<polygon fill="red" stroke="red" points="33855.13,-4601.46 33851.62,-4591.46 33848.13,-4601.46 33855.13,-4601.46"/>
<text text-anchor="middle" x="33841" y="-4685.8" font-family="Times,serif" font-size="14.00">AllGather GPU2→GPU3</text>
</g>
<!-- k_proj_1_0_3 -->
<g id="node16" class="node">
<title>k_proj_1_0_3</title>
<polygon fill="#ccff99" stroke="black" points="33458,-4963 33324,-4963 33324,-4895 33458,-4895 33458,-4963"/>
<text text-anchor="middle" x="33391" y="-4947.8" font-family="Times,serif" font-size="14.00">K Projection 0_3</text>
<text text-anchor="middle" x="33391" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="33391" y="-4917.8" font-family="Times,serif" font-size="14.00">W_K^{0,3}</text>
<text text-anchor="middle" x="33391" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- k_proj_1_0_3&#45;&gt;attention_1_0_3 -->
<g id="edge16" class="edge">
<title>k_proj_1_0_3&#45;&gt;attention_1_0_3</title>
<path fill="none" stroke="black" d="M33429.75,-4894.98C33429.75,-4894.98 33429.75,-4818.2 33429.75,-4818.2"/>
<polygon fill="black" stroke="black" points="33433.25,-4818.2 33429.75,-4808.2 33426.25,-4818.2 33433.25,-4818.2"/>
</g>
<!-- v_proj_1_0_3 -->
<g id="node17" class="node">
<title>v_proj_1_0_3</title>
<polygon fill="#ccff99" stroke="black" points="33265.5,-4963 33132.5,-4963 33132.5,-4895 33265.5,-4895 33265.5,-4963"/>
<text text-anchor="middle" x="33199" y="-4947.8" font-family="Times,serif" font-size="14.00">V Projection 0_3</text>
<text text-anchor="middle" x="33199" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="33199" y="-4917.8" font-family="Times,serif" font-size="14.00">W_V^{0,3}</text>
<text text-anchor="middle" x="33199" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- v_proj_1_0_3&#45;&gt;attention_1_0_3 -->
<g id="edge17" class="edge">
<title>v_proj_1_0_3&#45;&gt;attention_1_0_3</title>
<path fill="none" stroke="black" d="M33199,-4894.8C33199,-4845.94 33199,-4762 33199,-4762 33199,-4762 33391.29,-4762 33391.29,-4762"/>
<polygon fill="black" stroke="black" points="33391.29,-4765.5 33401.29,-4762 33391.29,-4758.5 33391.29,-4765.5"/>
</g>
<!-- q_proj_1_1_0 -->
<g id="node18" class="node">
<title>q_proj_1_1_0</title>
<polygon fill="#99ff99" stroke="black" points="33074,-4963 32940,-4963 32940,-4895 33074,-4895 33074,-4963"/>
<text text-anchor="middle" x="33007" y="-4947.8" font-family="Times,serif" font-size="14.00">Q Projection 1_0</text>
<text text-anchor="middle" x="33007" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="33007" y="-4917.8" font-family="Times,serif" font-size="14.00">W_Q^{1,0}</text>
<text text-anchor="middle" x="33007" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- attention_1_1_0 -->
<g id="node19" class="node">
<title>attention_1_1_0</title>
<polygon fill="#99ff99" stroke="black" points="32759.5,-4808 32586.5,-4808 32586.5,-4740 32759.5,-4740 32759.5,-4808"/>
<text text-anchor="middle" x="32673" y="-4792.8" font-family="Times,serif" font-size="14.00">Attention 1_0</text>
<text text-anchor="middle" x="32673" y="-4777.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="32673" y="-4762.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="32673" y="-4747.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- q_proj_1_1_0&#45;&gt;attention_1_1_0 -->
<g id="edge20" class="edge">
<title>q_proj_1_1_0&#45;&gt;attention_1_1_0</title>
<path fill="none" stroke="black" d="M33007,-4894.87C33007,-4852.29 33007,-4785 33007,-4785 33007,-4785 32769.88,-4785 32769.88,-4785"/>
<polygon fill="black" stroke="black" points="32769.88,-4781.5 32759.88,-4785 32769.88,-4788.5 32769.88,-4781.5"/>
</g>
<!-- concat_group_1_1 -->
<g id="node22" class="node">
<title>concat_group_1_1</title>
<polygon fill="#ffd700" stroke="black" points="31663,-4639 31535,-4586 31663,-4533 31791,-4586 31663,-4639"/>
<text text-anchor="middle" x="31663" y="-4597.3" font-family="Times,serif" font-size="14.00">Concat Group 1</text>
<text text-anchor="middle" x="31663" y="-4582.3" font-family="Times,serif" font-size="14.00">[B×L×d×h_g]</text>
<text text-anchor="middle" x="31663" y="-4567.3" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- attention_1_1_0&#45;&gt;concat_group_1_1 -->
<g id="edge23" class="edge">
<title>attention_1_1_0&#45;&gt;concat_group_1_1</title>
<path fill="none" stroke="black" d="M32673,-4739.95C32673,-4685.78 32673,-4586 32673,-4586 32673,-4586 31801.17,-4586 31801.17,-4586"/>
<polygon fill="black" stroke="black" points="31801.17,-4582.5 31791.17,-4586 31801.17,-4589.5 31801.17,-4582.5"/>
</g>
<!-- k_proj_1_1_0 -->
<g id="node20" class="node">
<title>k_proj_1_1_0</title>
<polygon fill="#99ff99" stroke="black" points="32882,-4963 32748,-4963 32748,-4895 32882,-4895 32882,-4963"/>
<text text-anchor="middle" x="32815" y="-4947.8" font-family="Times,serif" font-size="14.00">K Projection 1_0</text>
<text text-anchor="middle" x="32815" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="32815" y="-4917.8" font-family="Times,serif" font-size="14.00">W_K^{1,0}</text>
<text text-anchor="middle" x="32815" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- k_proj_1_1_0&#45;&gt;attention_1_1_0 -->
<g id="edge21" class="edge">
<title>k_proj_1_1_0&#45;&gt;attention_1_1_0</title>
<path fill="none" stroke="black" d="M32753.75,-4894.98C32753.75,-4894.98 32753.75,-4818.2 32753.75,-4818.2"/>
<polygon fill="black" stroke="black" points="32757.25,-4818.2 32753.75,-4808.2 32750.25,-4818.2 32757.25,-4818.2"/>
</g>
<!-- v_proj_1_1_0 -->
<g id="node21" class="node">
<title>v_proj_1_1_0</title>
<polygon fill="#99ff99" stroke="black" points="32689.5,-4963 32556.5,-4963 32556.5,-4895 32689.5,-4895 32689.5,-4963"/>
<text text-anchor="middle" x="32623" y="-4947.8" font-family="Times,serif" font-size="14.00">V Projection 1_0</text>
<text text-anchor="middle" x="32623" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="32623" y="-4917.8" font-family="Times,serif" font-size="14.00">W_V^{1,0}</text>
<text text-anchor="middle" x="32623" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- v_proj_1_1_0&#45;&gt;attention_1_1_0 -->
<g id="edge22" class="edge">
<title>v_proj_1_1_0&#45;&gt;attention_1_1_0</title>
<path fill="none" stroke="black" d="M32638,-4894.98C32638,-4894.98 32638,-4818.2 32638,-4818.2"/>
<polygon fill="black" stroke="black" points="32641.5,-4818.2 32638,-4808.2 32634.5,-4818.2 32641.5,-4818.2"/>
</g>
<!-- concat_group_1_1&#45;&gt;final_concat_1 -->
<g id="edge79" class="edge">
<title>concat_group_1_1&#45;&gt;final_concat_1</title>
<path fill="none" stroke="black" d="M31534.73,-4586C31310.96,-4586 30872.83,-4586 30872.83,-4586 30872.83,-4586 30872.83,-4432.73 30872.83,-4432.73"/>
<polygon fill="black" stroke="black" points="30876.33,-4432.73 30872.83,-4422.73 30869.33,-4432.73 30876.33,-4432.73"/>
</g>
<!-- q_proj_1_1_1 -->
<g id="node23" class="node">
<title>q_proj_1_1_1</title>
<polygon fill="#99ffcc" stroke="black" points="32498,-4963 32364,-4963 32364,-4895 32498,-4895 32498,-4963"/>
<text text-anchor="middle" x="32431" y="-4947.8" font-family="Times,serif" font-size="14.00">Q Projection 1_1</text>
<text text-anchor="middle" x="32431" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="32431" y="-4917.8" font-family="Times,serif" font-size="14.00">W_Q^{1,1}</text>
<text text-anchor="middle" x="32431" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- attention_1_1_1 -->
<g id="node24" class="node">
<title>attention_1_1_1</title>
<polygon fill="#99ffcc" stroke="black" points="32262.5,-4808 32089.5,-4808 32089.5,-4740 32262.5,-4740 32262.5,-4808"/>
<text text-anchor="middle" x="32176" y="-4792.8" font-family="Times,serif" font-size="14.00">Attention 1_1</text>
<text text-anchor="middle" x="32176" y="-4777.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="32176" y="-4762.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="32176" y="-4747.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- q_proj_1_1_1&#45;&gt;attention_1_1_1 -->
<g id="edge24" class="edge">
<title>q_proj_1_1_1&#45;&gt;attention_1_1_1</title>
<path fill="none" stroke="black" d="M32431,-4894.98C32431,-4849.36 32431,-4774 32431,-4774 32431,-4774 32272.69,-4774 32272.69,-4774"/>
<polygon fill="black" stroke="black" points="32272.69,-4770.5 32262.69,-4774 32272.69,-4777.5 32272.69,-4770.5"/>
</g>
<!-- attention_1_1_1&#45;&gt;concat_group_1_1 -->
<g id="edge27" class="edge">
<title>attention_1_1_1&#45;&gt;concat_group_1_1</title>
<path fill="none" stroke="black" d="M32089.28,-4785C31967.98,-4785 31762.33,-4785 31762.33,-4785 31762.33,-4785 31762.33,-4608.15 31762.33,-4608.15"/>
<polygon fill="black" stroke="black" points="31765.83,-4608.15 31762.33,-4598.15 31758.83,-4608.15 31765.83,-4608.15"/>
</g>
<!-- attention_1_1_1&#45;&gt;concat_group_1_1 -->
<g id="edge28" class="edge">
<title>attention_1_1_1&#45;&gt;concat_group_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32089.03,-4762C31971.14,-4762 31775.17,-4762 31775.17,-4762 31775.17,-4762 31775.17,-4602.68 31775.17,-4602.68"/>
<polygon fill="red" stroke="red" points="31778.67,-4602.68 31775.17,-4592.68 31771.67,-4602.68 31778.67,-4602.68"/>
<text text-anchor="middle" x="32399" y="-4685.8" font-family="Times,serif" font-size="14.00">AllGather GPU4→GPU5</text>
</g>
<!-- k_proj_1_1_1 -->
<g id="node25" class="node">
<title>k_proj_1_1_1</title>
<polygon fill="#99ffcc" stroke="black" points="32306,-4963 32172,-4963 32172,-4895 32306,-4895 32306,-4963"/>
<text text-anchor="middle" x="32239" y="-4947.8" font-family="Times,serif" font-size="14.00">K Projection 1_1</text>
<text text-anchor="middle" x="32239" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="32239" y="-4917.8" font-family="Times,serif" font-size="14.00">W_K^{1,1}</text>
<text text-anchor="middle" x="32239" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- k_proj_1_1_1&#45;&gt;attention_1_1_1 -->
<g id="edge25" class="edge">
<title>k_proj_1_1_1&#45;&gt;attention_1_1_1</title>
<path fill="none" stroke="black" d="M32217.25,-4894.98C32217.25,-4894.98 32217.25,-4818.2 32217.25,-4818.2"/>
<polygon fill="black" stroke="black" points="32220.75,-4818.2 32217.25,-4808.2 32213.75,-4818.2 32220.75,-4818.2"/>
</g>
<!-- v_proj_1_1_1 -->
<g id="node26" class="node">
<title>v_proj_1_1_1</title>
<polygon fill="#99ffcc" stroke="black" points="32113.5,-4963 31980.5,-4963 31980.5,-4895 32113.5,-4895 32113.5,-4963"/>
<text text-anchor="middle" x="32047" y="-4947.8" font-family="Times,serif" font-size="14.00">V Projection 1_1</text>
<text text-anchor="middle" x="32047" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="32047" y="-4917.8" font-family="Times,serif" font-size="14.00">W_V^{1,1}</text>
<text text-anchor="middle" x="32047" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- v_proj_1_1_1&#45;&gt;attention_1_1_1 -->
<g id="edge26" class="edge">
<title>v_proj_1_1_1&#45;&gt;attention_1_1_1</title>
<path fill="none" stroke="black" d="M32101.5,-4894.98C32101.5,-4894.98 32101.5,-4818.2 32101.5,-4818.2"/>
<polygon fill="black" stroke="black" points="32105,-4818.2 32101.5,-4808.2 32098,-4818.2 32105,-4818.2"/>
</g>
<!-- q_proj_1_1_2 -->
<g id="node27" class="node">
<title>q_proj_1_1_2</title>
<polygon fill="#99ffff" stroke="black" points="31922,-4963 31788,-4963 31788,-4895 31922,-4895 31922,-4963"/>
<text text-anchor="middle" x="31855" y="-4947.8" font-family="Times,serif" font-size="14.00">Q Projection 1_2</text>
<text text-anchor="middle" x="31855" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="31855" y="-4917.8" font-family="Times,serif" font-size="14.00">W_Q^{1,2}</text>
<text text-anchor="middle" x="31855" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- attention_1_1_2 -->
<g id="node28" class="node">
<title>attention_1_1_2</title>
<polygon fill="#99ffff" stroke="black" points="31749.5,-4808 31576.5,-4808 31576.5,-4740 31749.5,-4740 31749.5,-4808"/>
<text text-anchor="middle" x="31663" y="-4792.8" font-family="Times,serif" font-size="14.00">Attention 1_2</text>
<text text-anchor="middle" x="31663" y="-4777.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="31663" y="-4762.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="31663" y="-4747.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- q_proj_1_1_2&#45;&gt;attention_1_1_2 -->
<g id="edge29" class="edge">
<title>q_proj_1_1_2&#45;&gt;attention_1_1_2</title>
<path fill="none" stroke="black" d="M31787.96,-4929C31762.6,-4929 31739.75,-4929 31739.75,-4929 31739.75,-4929 31739.75,-4818.02 31739.75,-4818.02"/>
<polygon fill="black" stroke="black" points="31743.25,-4818.02 31739.75,-4808.02 31736.25,-4818.02 31743.25,-4818.02"/>
</g>
<!-- attention_1_1_2&#45;&gt;concat_group_1_1 -->
<g id="edge32" class="edge">
<title>attention_1_1_2&#45;&gt;concat_group_1_1</title>
<path fill="none" stroke="black" d="M31634.17,-4739.95C31634.17,-4739.95 31634.17,-4637.34 31634.17,-4637.34"/>
<polygon fill="black" stroke="black" points="31637.67,-4637.34 31634.17,-4627.34 31630.67,-4637.34 31637.67,-4637.34"/>
</g>
<!-- attention_1_1_2&#45;&gt;concat_group_1_1 -->
<g id="edge33" class="edge">
<title>attention_1_1_2&#45;&gt;concat_group_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31691.83,-4739.95C31691.83,-4739.95 31691.83,-4637.34 31691.83,-4637.34"/>
<polygon fill="red" stroke="red" points="31695.33,-4637.34 31691.83,-4627.34 31688.33,-4637.34 31695.33,-4637.34"/>
<text text-anchor="middle" x="31833" y="-4685.8" font-family="Times,serif" font-size="14.00">AllGather GPU5→GPU6</text>
</g>
<!-- k_proj_1_1_2 -->
<g id="node29" class="node">
<title>k_proj_1_1_2</title>
<polygon fill="#99ffff" stroke="black" points="31730,-4963 31596,-4963 31596,-4895 31730,-4895 31730,-4963"/>
<text text-anchor="middle" x="31663" y="-4947.8" font-family="Times,serif" font-size="14.00">K Projection 1_2</text>
<text text-anchor="middle" x="31663" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="31663" y="-4917.8" font-family="Times,serif" font-size="14.00">W_K^{1,2}</text>
<text text-anchor="middle" x="31663" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- k_proj_1_1_2&#45;&gt;attention_1_1_2 -->
<g id="edge30" class="edge">
<title>k_proj_1_1_2&#45;&gt;attention_1_1_2</title>
<path fill="none" stroke="black" d="M31663,-4894.98C31663,-4894.98 31663,-4818.2 31663,-4818.2"/>
<polygon fill="black" stroke="black" points="31666.5,-4818.2 31663,-4808.2 31659.5,-4818.2 31666.5,-4818.2"/>
</g>
<!-- v_proj_1_1_2 -->
<g id="node30" class="node">
<title>v_proj_1_1_2</title>
<polygon fill="#99ffff" stroke="black" points="31537.5,-4963 31404.5,-4963 31404.5,-4895 31537.5,-4895 31537.5,-4963"/>
<text text-anchor="middle" x="31471" y="-4947.8" font-family="Times,serif" font-size="14.00">V Projection 1_2</text>
<text text-anchor="middle" x="31471" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="31471" y="-4917.8" font-family="Times,serif" font-size="14.00">W_V^{1,2}</text>
<text text-anchor="middle" x="31471" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- v_proj_1_1_2&#45;&gt;attention_1_1_2 -->
<g id="edge31" class="edge">
<title>v_proj_1_1_2&#45;&gt;attention_1_1_2</title>
<path fill="none" stroke="black" d="M31537.71,-4929C31563.19,-4929 31586.25,-4929 31586.25,-4929 31586.25,-4929 31586.25,-4818.02 31586.25,-4818.02"/>
<polygon fill="black" stroke="black" points="31589.75,-4818.02 31586.25,-4808.02 31582.75,-4818.02 31589.75,-4818.02"/>
</g>
<!-- q_proj_1_1_3 -->
<g id="node31" class="node">
<title>q_proj_1_1_3</title>
<polygon fill="#99ccff" stroke="black" points="31346,-4963 31212,-4963 31212,-4895 31346,-4895 31346,-4963"/>
<text text-anchor="middle" x="31279" y="-4947.8" font-family="Times,serif" font-size="14.00">Q Projection 1_3</text>
<text text-anchor="middle" x="31279" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="31279" y="-4917.8" font-family="Times,serif" font-size="14.00">W_Q^{1,3}</text>
<text text-anchor="middle" x="31279" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- attention_1_1_3 -->
<g id="node32" class="node">
<title>attention_1_1_3</title>
<polygon fill="#99ccff" stroke="black" points="31270.5,-4808 31097.5,-4808 31097.5,-4740 31270.5,-4740 31270.5,-4808"/>
<text text-anchor="middle" x="31184" y="-4792.8" font-family="Times,serif" font-size="14.00">Attention 1_3</text>
<text text-anchor="middle" x="31184" y="-4777.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="31184" y="-4762.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="31184" y="-4747.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- q_proj_1_1_3&#45;&gt;attention_1_1_3 -->
<g id="edge34" class="edge">
<title>q_proj_1_1_3&#45;&gt;attention_1_1_3</title>
<path fill="none" stroke="black" d="M31241.25,-4894.98C31241.25,-4894.98 31241.25,-4818.2 31241.25,-4818.2"/>
<polygon fill="black" stroke="black" points="31244.75,-4818.2 31241.25,-4808.2 31237.75,-4818.2 31244.75,-4818.2"/>
</g>
<!-- attention_1_1_3&#45;&gt;concat_group_1_1 -->
<g id="edge37" class="edge">
<title>attention_1_1_3&#45;&gt;concat_group_1_1</title>
<path fill="none" stroke="black" d="M31270.59,-4785C31382.59,-4785 31563.5,-4785 31563.5,-4785 31563.5,-4785 31563.5,-4607.85 31563.5,-4607.85"/>
<polygon fill="black" stroke="black" points="31567,-4607.85 31563.5,-4597.85 31560,-4607.85 31567,-4607.85"/>
</g>
<!-- attention_1_1_3&#45;&gt;concat_group_1_1 -->
<g id="edge38" class="edge">
<title>attention_1_1_3&#45;&gt;concat_group_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31270.86,-4762C31379.23,-4762 31550.5,-4762 31550.5,-4762 31550.5,-4762 31550.5,-4602.68 31550.5,-4602.68"/>
<polygon fill="red" stroke="red" points="31554,-4602.68 31550.5,-4592.68 31547,-4602.68 31554,-4602.68"/>
<text text-anchor="middle" x="31537" y="-4685.8" font-family="Times,serif" font-size="14.00">AllGather GPU6→GPU7</text>
</g>
<!-- k_proj_1_1_3 -->
<g id="node33" class="node">
<title>k_proj_1_1_3</title>
<polygon fill="#99ccff" stroke="black" points="31154,-4963 31020,-4963 31020,-4895 31154,-4895 31154,-4963"/>
<text text-anchor="middle" x="31087" y="-4947.8" font-family="Times,serif" font-size="14.00">K Projection 1_3</text>
<text text-anchor="middle" x="31087" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="31087" y="-4917.8" font-family="Times,serif" font-size="14.00">W_K^{1,3}</text>
<text text-anchor="middle" x="31087" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- k_proj_1_1_3&#45;&gt;attention_1_1_3 -->
<g id="edge35" class="edge">
<title>k_proj_1_1_3&#45;&gt;attention_1_1_3</title>
<path fill="none" stroke="black" d="M31125.75,-4894.98C31125.75,-4894.98 31125.75,-4818.2 31125.75,-4818.2"/>
<polygon fill="black" stroke="black" points="31129.25,-4818.2 31125.75,-4808.2 31122.25,-4818.2 31129.25,-4818.2"/>
</g>
<!-- v_proj_1_1_3 -->
<g id="node34" class="node">
<title>v_proj_1_1_3</title>
<polygon fill="#99ccff" stroke="black" points="30961.5,-4963 30828.5,-4963 30828.5,-4895 30961.5,-4895 30961.5,-4963"/>
<text text-anchor="middle" x="30895" y="-4947.8" font-family="Times,serif" font-size="14.00">V Projection 1_3</text>
<text text-anchor="middle" x="30895" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="30895" y="-4917.8" font-family="Times,serif" font-size="14.00">W_V^{1,3}</text>
<text text-anchor="middle" x="30895" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- v_proj_1_1_3&#45;&gt;attention_1_1_3 -->
<g id="edge36" class="edge">
<title>v_proj_1_1_3&#45;&gt;attention_1_1_3</title>
<path fill="none" stroke="black" d="M30917.17,-4894.8C30917.17,-4845.94 30917.17,-4762 30917.17,-4762 30917.17,-4762 31087.37,-4762 31087.37,-4762"/>
<polygon fill="black" stroke="black" points="31087.37,-4765.5 31097.37,-4762 31087.37,-4758.5 31087.37,-4765.5"/>
</g>
<!-- q_proj_1_2_0 -->
<g id="node35" class="node">
<title>q_proj_1_2_0</title>
<polygon fill="#9999ff" stroke="black" points="30770,-4963 30636,-4963 30636,-4895 30770,-4895 30770,-4963"/>
<text text-anchor="middle" x="30703" y="-4947.8" font-family="Times,serif" font-size="14.00">Q Projection 2_0</text>
<text text-anchor="middle" x="30703" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="30703" y="-4917.8" font-family="Times,serif" font-size="14.00">W_Q^{2,0}</text>
<text text-anchor="middle" x="30703" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- attention_1_2_0 -->
<g id="node36" class="node">
<title>attention_1_2_0</title>
<polygon fill="#9999ff" stroke="black" points="30474.5,-4808 30301.5,-4808 30301.5,-4740 30474.5,-4740 30474.5,-4808"/>
<text text-anchor="middle" x="30388" y="-4792.8" font-family="Times,serif" font-size="14.00">Attention 2_0</text>
<text text-anchor="middle" x="30388" y="-4777.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="30388" y="-4762.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="30388" y="-4747.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- q_proj_1_2_0&#45;&gt;attention_1_2_0 -->
<g id="edge39" class="edge">
<title>q_proj_1_2_0&#45;&gt;attention_1_2_0</title>
<path fill="none" stroke="black" d="M30703,-4894.87C30703,-4852.29 30703,-4785 30703,-4785 30703,-4785 30484.91,-4785 30484.91,-4785"/>
<polygon fill="black" stroke="black" points="30484.91,-4781.5 30474.91,-4785 30484.91,-4788.5 30484.91,-4781.5"/>
</g>
<!-- concat_group_1_2 -->
<g id="node39" class="node">
<title>concat_group_1_2</title>
<polygon fill="#ffd700" stroke="black" points="29935,-4639 29807,-4586 29935,-4533 30063,-4586 29935,-4639"/>
<text text-anchor="middle" x="29935" y="-4597.3" font-family="Times,serif" font-size="14.00">Concat Group 2</text>
<text text-anchor="middle" x="29935" y="-4582.3" font-family="Times,serif" font-size="14.00">[B×L×d×h_g]</text>
<text text-anchor="middle" x="29935" y="-4567.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;11</text>
</g>
<!-- attention_1_2_0&#45;&gt;concat_group_1_2 -->
<g id="edge42" class="edge">
<title>attention_1_2_0&#45;&gt;concat_group_1_2</title>
<path fill="none" stroke="black" d="M30301.27,-4774C30198.42,-4774 30040.75,-4774 30040.75,-4774 30040.75,-4774 30040.75,-4605.32 30040.75,-4605.32"/>
<polygon fill="black" stroke="black" points="30044.25,-4605.32 30040.75,-4595.32 30037.25,-4605.32 30044.25,-4605.32"/>
</g>
<!-- k_proj_1_2_0 -->
<g id="node37" class="node">
<title>k_proj_1_2_0</title>
<polygon fill="#9999ff" stroke="black" points="30578,-4963 30444,-4963 30444,-4895 30578,-4895 30578,-4963"/>
<text text-anchor="middle" x="30511" y="-4947.8" font-family="Times,serif" font-size="14.00">K Projection 2_0</text>
<text text-anchor="middle" x="30511" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="30511" y="-4917.8" font-family="Times,serif" font-size="14.00">W_K^{2,0}</text>
<text text-anchor="middle" x="30511" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- k_proj_1_2_0&#45;&gt;attention_1_2_0 -->
<g id="edge40" class="edge">
<title>k_proj_1_2_0&#45;&gt;attention_1_2_0</title>
<path fill="none" stroke="black" d="M30459.25,-4894.98C30459.25,-4894.98 30459.25,-4818.2 30459.25,-4818.2"/>
<polygon fill="black" stroke="black" points="30462.75,-4818.2 30459.25,-4808.2 30455.75,-4818.2 30462.75,-4818.2"/>
</g>
<!-- v_proj_1_2_0 -->
<g id="node38" class="node">
<title>v_proj_1_2_0</title>
<polygon fill="#9999ff" stroke="black" points="30385.5,-4963 30252.5,-4963 30252.5,-4895 30385.5,-4895 30385.5,-4963"/>
<text text-anchor="middle" x="30319" y="-4947.8" font-family="Times,serif" font-size="14.00">V Projection 2_0</text>
<text text-anchor="middle" x="30319" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="30319" y="-4917.8" font-family="Times,serif" font-size="14.00">W_V^{2,0}</text>
<text text-anchor="middle" x="30319" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- v_proj_1_2_0&#45;&gt;attention_1_2_0 -->
<g id="edge41" class="edge">
<title>v_proj_1_2_0&#45;&gt;attention_1_2_0</title>
<path fill="none" stroke="black" d="M30343.5,-4894.98C30343.5,-4894.98 30343.5,-4818.2 30343.5,-4818.2"/>
<polygon fill="black" stroke="black" points="30347,-4818.2 30343.5,-4808.2 30340,-4818.2 30347,-4818.2"/>
</g>
<!-- concat_group_1_2&#45;&gt;final_concat_1 -->
<g id="edge80" class="edge">
<title>concat_group_1_2&#45;&gt;final_concat_1</title>
<path fill="none" stroke="black" d="M30056,-4582.95C30056,-4559.57 30056,-4410 30056,-4410 30056,-4410 30677.81,-4410 30677.81,-4410"/>
<polygon fill="black" stroke="black" points="30677.81,-4413.5 30687.81,-4410 30677.81,-4406.5 30677.81,-4413.5"/>
</g>
<!-- q_proj_1_2_1 -->
<g id="node40" class="node">
<title>q_proj_1_2_1</title>
<polygon fill="#cc99ff" stroke="black" points="30194,-4963 30060,-4963 30060,-4895 30194,-4895 30194,-4963"/>
<text text-anchor="middle" x="30127" y="-4947.8" font-family="Times,serif" font-size="14.00">Q Projection 2_1</text>
<text text-anchor="middle" x="30127" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="30127" y="-4917.8" font-family="Times,serif" font-size="14.00">W_Q^{2,1}</text>
<text text-anchor="middle" x="30127" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- attention_1_2_1 -->
<g id="node41" class="node">
<title>attention_1_2_1</title>
<polygon fill="#cc99ff" stroke="black" points="30021.5,-4808 29848.5,-4808 29848.5,-4740 30021.5,-4740 30021.5,-4808"/>
<text text-anchor="middle" x="29935" y="-4792.8" font-family="Times,serif" font-size="14.00">Attention 2_1</text>
<text text-anchor="middle" x="29935" y="-4777.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="29935" y="-4762.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="29935" y="-4747.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- q_proj_1_2_1&#45;&gt;attention_1_2_1 -->
<g id="edge43" class="edge">
<title>q_proj_1_2_1&#45;&gt;attention_1_2_1</title>
<path fill="none" stroke="black" d="M30059.96,-4929C30034.6,-4929 30011.75,-4929 30011.75,-4929 30011.75,-4929 30011.75,-4818.02 30011.75,-4818.02"/>
<polygon fill="black" stroke="black" points="30015.25,-4818.02 30011.75,-4808.02 30008.25,-4818.02 30015.25,-4818.02"/>
</g>
<!-- attention_1_2_1&#45;&gt;concat_group_1_2 -->
<g id="edge46" class="edge">
<title>attention_1_2_1&#45;&gt;concat_group_1_2</title>
<path fill="none" stroke="black" d="M29906.17,-4739.95C29906.17,-4739.95 29906.17,-4637.34 29906.17,-4637.34"/>
<polygon fill="black" stroke="black" points="29909.67,-4637.34 29906.17,-4627.34 29902.67,-4637.34 29909.67,-4637.34"/>
</g>
<!-- attention_1_2_1&#45;&gt;concat_group_1_2 -->
<g id="edge47" class="edge">
<title>attention_1_2_1&#45;&gt;concat_group_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29963.83,-4739.95C29963.83,-4739.95 29963.83,-4637.34 29963.83,-4637.34"/>
<polygon fill="red" stroke="red" points="29967.33,-4637.34 29963.83,-4627.34 29960.33,-4637.34 29967.33,-4637.34"/>
<text text-anchor="middle" x="30206" y="-4685.8" font-family="Times,serif" font-size="14.00">AllGather GPU8→GPU9</text>
</g>
<!-- k_proj_1_2_1 -->
<g id="node42" class="node">
<title>k_proj_1_2_1</title>
<polygon fill="#cc99ff" stroke="black" points="30002,-4963 29868,-4963 29868,-4895 30002,-4895 30002,-4963"/>
<text text-anchor="middle" x="29935" y="-4947.8" font-family="Times,serif" font-size="14.00">K Projection 2_1</text>
<text text-anchor="middle" x="29935" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="29935" y="-4917.8" font-family="Times,serif" font-size="14.00">W_K^{2,1}</text>
<text text-anchor="middle" x="29935" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- k_proj_1_2_1&#45;&gt;attention_1_2_1 -->
<g id="edge44" class="edge">
<title>k_proj_1_2_1&#45;&gt;attention_1_2_1</title>
<path fill="none" stroke="black" d="M29935,-4894.98C29935,-4894.98 29935,-4818.2 29935,-4818.2"/>
<polygon fill="black" stroke="black" points="29938.5,-4818.2 29935,-4808.2 29931.5,-4818.2 29938.5,-4818.2"/>
</g>
<!-- v_proj_1_2_1 -->
<g id="node43" class="node">
<title>v_proj_1_2_1</title>
<polygon fill="#cc99ff" stroke="black" points="29809.5,-4963 29676.5,-4963 29676.5,-4895 29809.5,-4895 29809.5,-4963"/>
<text text-anchor="middle" x="29743" y="-4947.8" font-family="Times,serif" font-size="14.00">V Projection 2_1</text>
<text text-anchor="middle" x="29743" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="29743" y="-4917.8" font-family="Times,serif" font-size="14.00">W_V^{2,1}</text>
<text text-anchor="middle" x="29743" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- v_proj_1_2_1&#45;&gt;attention_1_2_1 -->
<g id="edge45" class="edge">
<title>v_proj_1_2_1&#45;&gt;attention_1_2_1</title>
<path fill="none" stroke="black" d="M29809.71,-4929C29835.19,-4929 29858.25,-4929 29858.25,-4929 29858.25,-4929 29858.25,-4818.02 29858.25,-4818.02"/>
<polygon fill="black" stroke="black" points="29861.75,-4818.02 29858.25,-4808.02 29854.75,-4818.02 29861.75,-4818.02"/>
</g>
<!-- q_proj_1_2_2 -->
<g id="node44" class="node">
<title>q_proj_1_2_2</title>
<polygon fill="#ff99ff" stroke="black" points="29618,-4963 29484,-4963 29484,-4895 29618,-4895 29618,-4963"/>
<text text-anchor="middle" x="29551" y="-4947.8" font-family="Times,serif" font-size="14.00">Q Projection 2_2</text>
<text text-anchor="middle" x="29551" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="29551" y="-4917.8" font-family="Times,serif" font-size="14.00">W_Q^{2,2}</text>
<text text-anchor="middle" x="29551" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- attention_1_2_2 -->
<g id="node45" class="node">
<title>attention_1_2_2</title>
<polygon fill="#ff99ff" stroke="black" points="29507.5,-4808 29334.5,-4808 29334.5,-4740 29507.5,-4740 29507.5,-4808"/>
<text text-anchor="middle" x="29421" y="-4792.8" font-family="Times,serif" font-size="14.00">Attention 2_2</text>
<text text-anchor="middle" x="29421" y="-4777.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="29421" y="-4762.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="29421" y="-4747.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- q_proj_1_2_2&#45;&gt;attention_1_2_2 -->
<g id="edge48" class="edge">
<title>q_proj_1_2_2&#45;&gt;attention_1_2_2</title>
<path fill="none" stroke="black" d="M29495.75,-4894.98C29495.75,-4894.98 29495.75,-4818.2 29495.75,-4818.2"/>
<polygon fill="black" stroke="black" points="29499.25,-4818.2 29495.75,-4808.2 29492.25,-4818.2 29499.25,-4818.2"/>
</g>
<!-- attention_1_2_2&#45;&gt;concat_group_1_2 -->
<g id="edge51" class="edge">
<title>attention_1_2_2&#45;&gt;concat_group_1_2</title>
<path fill="none" stroke="black" d="M29507.64,-4785C29629.15,-4785 29835.5,-4785 29835.5,-4785 29835.5,-4785 29835.5,-4607.85 29835.5,-4607.85"/>
<polygon fill="black" stroke="black" points="29839,-4607.85 29835.5,-4597.85 29832,-4607.85 29839,-4607.85"/>
</g>
<!-- attention_1_2_2&#45;&gt;concat_group_1_2 -->
<g id="edge52" class="edge">
<title>attention_1_2_2&#45;&gt;concat_group_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29507.63,-4762C29625.66,-4762 29822.5,-4762 29822.5,-4762 29822.5,-4762 29822.5,-4602.68 29822.5,-4602.68"/>
<polygon fill="red" stroke="red" points="29826,-4602.68 29822.5,-4592.68 29819,-4602.68 29826,-4602.68"/>
<text text-anchor="middle" x="29676.5" y="-4685.8" font-family="Times,serif" font-size="14.00">AllGather GPU9→GPU10</text>
</g>
<!-- k_proj_1_2_2 -->
<g id="node46" class="node">
<title>k_proj_1_2_2</title>
<polygon fill="#ff99ff" stroke="black" points="29426,-4963 29292,-4963 29292,-4895 29426,-4895 29426,-4963"/>
<text text-anchor="middle" x="29359" y="-4947.8" font-family="Times,serif" font-size="14.00">K Projection 2_2</text>
<text text-anchor="middle" x="29359" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="29359" y="-4917.8" font-family="Times,serif" font-size="14.00">W_K^{2,2}</text>
<text text-anchor="middle" x="29359" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- k_proj_1_2_2&#45;&gt;attention_1_2_2 -->
<g id="edge49" class="edge">
<title>k_proj_1_2_2&#45;&gt;attention_1_2_2</title>
<path fill="none" stroke="black" d="M29380.25,-4894.98C29380.25,-4894.98 29380.25,-4818.2 29380.25,-4818.2"/>
<polygon fill="black" stroke="black" points="29383.75,-4818.2 29380.25,-4808.2 29376.75,-4818.2 29383.75,-4818.2"/>
</g>
<!-- v_proj_1_2_2 -->
<g id="node47" class="node">
<title>v_proj_1_2_2</title>
<polygon fill="#ff99ff" stroke="black" points="29233.5,-4963 29100.5,-4963 29100.5,-4895 29233.5,-4895 29233.5,-4963"/>
<text text-anchor="middle" x="29167" y="-4947.8" font-family="Times,serif" font-size="14.00">V Projection 2_2</text>
<text text-anchor="middle" x="29167" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="29167" y="-4917.8" font-family="Times,serif" font-size="14.00">W_V^{2,2}</text>
<text text-anchor="middle" x="29167" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- v_proj_1_2_2&#45;&gt;attention_1_2_2 -->
<g id="edge50" class="edge">
<title>v_proj_1_2_2&#45;&gt;attention_1_2_2</title>
<path fill="none" stroke="black" d="M29206.25,-4894.98C29206.25,-4849.36 29206.25,-4774 29206.25,-4774 29206.25,-4774 29324.27,-4774 29324.27,-4774"/>
<polygon fill="black" stroke="black" points="29324.27,-4777.5 29334.27,-4774 29324.27,-4770.5 29324.27,-4777.5"/>
</g>
<!-- q_proj_1_2_3 -->
<g id="node48" class="node">
<title>q_proj_1_2_3</title>
<polygon fill="#ff99cc" stroke="black" points="29042,-4963 28908,-4963 28908,-4895 29042,-4895 29042,-4963"/>
<text text-anchor="middle" x="28975" y="-4947.8" font-family="Times,serif" font-size="14.00">Q Projection 2_3</text>
<text text-anchor="middle" x="28975" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="28975" y="-4917.8" font-family="Times,serif" font-size="14.00">W_Q^{2,3}</text>
<text text-anchor="middle" x="28975" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- attention_1_2_3 -->
<g id="node49" class="node">
<title>attention_1_2_3</title>
<polygon fill="#ff99cc" stroke="black" points="28966.5,-4808 28793.5,-4808 28793.5,-4740 28966.5,-4740 28966.5,-4808"/>
<text text-anchor="middle" x="28880" y="-4792.8" font-family="Times,serif" font-size="14.00">Attention 2_3</text>
<text text-anchor="middle" x="28880" y="-4777.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="28880" y="-4762.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="28880" y="-4747.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- q_proj_1_2_3&#45;&gt;attention_1_2_3 -->
<g id="edge53" class="edge">
<title>q_proj_1_2_3&#45;&gt;attention_1_2_3</title>
<path fill="none" stroke="black" d="M28937.25,-4894.98C28937.25,-4894.98 28937.25,-4818.2 28937.25,-4818.2"/>
<polygon fill="black" stroke="black" points="28940.75,-4818.2 28937.25,-4808.2 28933.75,-4818.2 28940.75,-4818.2"/>
</g>
<!-- attention_1_2_3&#45;&gt;concat_group_1_2 -->
<g id="edge56" class="edge">
<title>attention_1_2_3&#45;&gt;concat_group_1_2</title>
<path fill="none" stroke="black" d="M28959.33,-4739.81C28959.33,-4689.9 28959.33,-4603 28959.33,-4603 28959.33,-4603 29837.99,-4603 29837.99,-4603"/>
<polygon fill="black" stroke="black" points="29837.99,-4606.5 29847.99,-4603 29837.99,-4599.5 29837.99,-4606.5"/>
</g>
<!-- attention_1_2_3&#45;&gt;concat_group_1_2 -->
<g id="edge57" class="edge">
<title>attention_1_2_3&#45;&gt;concat_group_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M28952.17,-4739.98C28952.17,-4681.47 28952.17,-4568 28952.17,-4568 28952.17,-4568 29840.35,-4568 29840.35,-4568"/>
<polygon fill="red" stroke="red" points="29840.35,-4571.5 29850.35,-4568 29840.35,-4564.5 29840.35,-4571.5"/>
<text text-anchor="middle" x="29349" y="-4685.8" font-family="Times,serif" font-size="14.00">AllGather GPU10→GPU11</text>
</g>
<!-- k_proj_1_2_3 -->
<g id="node50" class="node">
<title>k_proj_1_2_3</title>
<polygon fill="#ff99cc" stroke="black" points="28850,-4963 28716,-4963 28716,-4895 28850,-4895 28850,-4963"/>
<text text-anchor="middle" x="28783" y="-4947.8" font-family="Times,serif" font-size="14.00">K Projection 2_3</text>
<text text-anchor="middle" x="28783" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="28783" y="-4917.8" font-family="Times,serif" font-size="14.00">W_K^{2,3}</text>
<text text-anchor="middle" x="28783" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- k_proj_1_2_3&#45;&gt;attention_1_2_3 -->
<g id="edge54" class="edge">
<title>k_proj_1_2_3&#45;&gt;attention_1_2_3</title>
<path fill="none" stroke="black" d="M28821.75,-4894.98C28821.75,-4894.98 28821.75,-4818.2 28821.75,-4818.2"/>
<polygon fill="black" stroke="black" points="28825.25,-4818.2 28821.75,-4808.2 28818.25,-4818.2 28825.25,-4818.2"/>
</g>
<!-- v_proj_1_2_3 -->
<g id="node51" class="node">
<title>v_proj_1_2_3</title>
<polygon fill="#ff99cc" stroke="black" points="28657.5,-4963 28524.5,-4963 28524.5,-4895 28657.5,-4895 28657.5,-4963"/>
<text text-anchor="middle" x="28591" y="-4947.8" font-family="Times,serif" font-size="14.00">V Projection 2_3</text>
<text text-anchor="middle" x="28591" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="28591" y="-4917.8" font-family="Times,serif" font-size="14.00">W_V^{2,3}</text>
<text text-anchor="middle" x="28591" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- v_proj_1_2_3&#45;&gt;attention_1_2_3 -->
<g id="edge55" class="edge">
<title>v_proj_1_2_3&#45;&gt;attention_1_2_3</title>
<path fill="none" stroke="black" d="M28643.5,-4894.8C28643.5,-4845.94 28643.5,-4762 28643.5,-4762 28643.5,-4762 28783.28,-4762 28783.28,-4762"/>
<polygon fill="black" stroke="black" points="28783.28,-4765.5 28793.28,-4762 28783.28,-4758.5 28783.28,-4765.5"/>
</g>
<!-- q_proj_1_3_0 -->
<g id="node52" class="node">
<title>q_proj_1_3_0</title>
<polygon fill="#ffb366" stroke="black" points="28466,-4963 28332,-4963 28332,-4895 28466,-4895 28466,-4963"/>
<text text-anchor="middle" x="28399" y="-4947.8" font-family="Times,serif" font-size="14.00">Q Projection 3_0</text>
<text text-anchor="middle" x="28399" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="28399" y="-4917.8" font-family="Times,serif" font-size="14.00">W_Q^{3,0}</text>
<text text-anchor="middle" x="28399" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- attention_1_3_0 -->
<g id="node53" class="node">
<title>attention_1_3_0</title>
<polygon fill="#ffb366" stroke="black" points="28173.5,-4808 28000.5,-4808 28000.5,-4740 28173.5,-4740 28173.5,-4808"/>
<text text-anchor="middle" x="28087" y="-4792.8" font-family="Times,serif" font-size="14.00">Attention 3_0</text>
<text text-anchor="middle" x="28087" y="-4777.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="28087" y="-4762.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="28087" y="-4747.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- q_proj_1_3_0&#45;&gt;attention_1_3_0 -->
<g id="edge58" class="edge">
<title>q_proj_1_3_0&#45;&gt;attention_1_3_0</title>
<path fill="none" stroke="black" d="M28357.25,-4894.87C28357.25,-4852.29 28357.25,-4785 28357.25,-4785 28357.25,-4785 28183.62,-4785 28183.62,-4785"/>
<polygon fill="black" stroke="black" points="28183.62,-4781.5 28173.62,-4785 28183.62,-4788.5 28183.62,-4781.5"/>
</g>
<!-- concat_group_1_3 -->
<g id="node56" class="node">
<title>concat_group_1_3</title>
<polygon fill="#ffd700" stroke="black" points="27631,-4639 27503,-4586 27631,-4533 27759,-4586 27631,-4639"/>
<text text-anchor="middle" x="27631" y="-4597.3" font-family="Times,serif" font-size="14.00">Concat Group 3</text>
<text text-anchor="middle" x="27631" y="-4582.3" font-family="Times,serif" font-size="14.00">[B×L×d×h_g]</text>
<text text-anchor="middle" x="27631" y="-4567.3" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- attention_1_3_0&#45;&gt;concat_group_1_3 -->
<g id="edge61" class="edge">
<title>attention_1_3_0&#45;&gt;concat_group_1_3</title>
<path fill="none" stroke="black" d="M28000.42,-4774C27896.7,-4774 27736.75,-4774 27736.75,-4774 27736.75,-4774 27736.75,-4605.32 27736.75,-4605.32"/>
<polygon fill="black" stroke="black" points="27740.25,-4605.32 27736.75,-4595.32 27733.25,-4605.32 27740.25,-4605.32"/>
</g>
<!-- k_proj_1_3_0 -->
<g id="node54" class="node">
<title>k_proj_1_3_0</title>
<polygon fill="#ffb366" stroke="black" points="28274,-4963 28140,-4963 28140,-4895 28274,-4895 28274,-4963"/>
<text text-anchor="middle" x="28207" y="-4947.8" font-family="Times,serif" font-size="14.00">K Projection 3_0</text>
<text text-anchor="middle" x="28207" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="28207" y="-4917.8" font-family="Times,serif" font-size="14.00">W_K^{3,0}</text>
<text text-anchor="middle" x="28207" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- k_proj_1_3_0&#45;&gt;attention_1_3_0 -->
<g id="edge59" class="edge">
<title>k_proj_1_3_0&#45;&gt;attention_1_3_0</title>
<path fill="none" stroke="black" d="M28156.75,-4894.98C28156.75,-4894.98 28156.75,-4818.2 28156.75,-4818.2"/>
<polygon fill="black" stroke="black" points="28160.25,-4818.2 28156.75,-4808.2 28153.25,-4818.2 28160.25,-4818.2"/>
</g>
<!-- v_proj_1_3_0 -->
<g id="node55" class="node">
<title>v_proj_1_3_0</title>
<polygon fill="#ffb366" stroke="black" points="28081.5,-4963 27948.5,-4963 27948.5,-4895 28081.5,-4895 28081.5,-4963"/>
<text text-anchor="middle" x="28015" y="-4947.8" font-family="Times,serif" font-size="14.00">V Projection 3_0</text>
<text text-anchor="middle" x="28015" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="28015" y="-4917.8" font-family="Times,serif" font-size="14.00">W_V^{3,0}</text>
<text text-anchor="middle" x="28015" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- v_proj_1_3_0&#45;&gt;attention_1_3_0 -->
<g id="edge60" class="edge">
<title>v_proj_1_3_0&#45;&gt;attention_1_3_0</title>
<path fill="none" stroke="black" d="M28041,-4894.98C28041,-4894.98 28041,-4818.2 28041,-4818.2"/>
<polygon fill="black" stroke="black" points="28044.5,-4818.2 28041,-4808.2 28037.5,-4818.2 28044.5,-4818.2"/>
</g>
<!-- concat_group_1_3&#45;&gt;final_concat_1 -->
<g id="edge81" class="edge">
<title>concat_group_1_3&#45;&gt;final_concat_1</title>
<path fill="none" stroke="black" d="M27709,-4565C27709,-4511.63 27709,-4375 27709,-4375 27709,-4375 30680.9,-4375 30680.9,-4375"/>
<polygon fill="black" stroke="black" points="30680.9,-4378.5 30690.9,-4375 30680.9,-4371.5 30680.9,-4378.5"/>
</g>
<!-- q_proj_1_3_1 -->
<g id="node57" class="node">
<title>q_proj_1_3_1</title>
<polygon fill="#b3ff66" stroke="black" points="27890,-4963 27756,-4963 27756,-4895 27890,-4895 27890,-4963"/>
<text text-anchor="middle" x="27823" y="-4947.8" font-family="Times,serif" font-size="14.00">Q Projection 3_1</text>
<text text-anchor="middle" x="27823" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="27823" y="-4917.8" font-family="Times,serif" font-size="14.00">W_Q^{3,1}</text>
<text text-anchor="middle" x="27823" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- attention_1_3_1 -->
<g id="node58" class="node">
<title>attention_1_3_1</title>
<polygon fill="#b3ff66" stroke="black" points="27717.5,-4808 27544.5,-4808 27544.5,-4740 27717.5,-4740 27717.5,-4808"/>
<text text-anchor="middle" x="27631" y="-4792.8" font-family="Times,serif" font-size="14.00">Attention 3_1</text>
<text text-anchor="middle" x="27631" y="-4777.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="27631" y="-4762.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="27631" y="-4747.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- q_proj_1_3_1&#45;&gt;attention_1_3_1 -->
<g id="edge62" class="edge">
<title>q_proj_1_3_1&#45;&gt;attention_1_3_1</title>
<path fill="none" stroke="black" d="M27755.96,-4929C27730.6,-4929 27707.75,-4929 27707.75,-4929 27707.75,-4929 27707.75,-4818.02 27707.75,-4818.02"/>
<polygon fill="black" stroke="black" points="27711.25,-4818.02 27707.75,-4808.02 27704.25,-4818.02 27711.25,-4818.02"/>
</g>
<!-- attention_1_3_1&#45;&gt;concat_group_1_3 -->
<g id="edge65" class="edge">
<title>attention_1_3_1&#45;&gt;concat_group_1_3</title>
<path fill="none" stroke="black" d="M27602.17,-4739.95C27602.17,-4739.95 27602.17,-4637.34 27602.17,-4637.34"/>
<polygon fill="black" stroke="black" points="27605.67,-4637.34 27602.17,-4627.34 27598.67,-4637.34 27605.67,-4637.34"/>
</g>
<!-- attention_1_3_1&#45;&gt;concat_group_1_3 -->
<g id="edge66" class="edge">
<title>attention_1_3_1&#45;&gt;concat_group_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M27659.83,-4739.95C27659.83,-4739.95 27659.83,-4637.34 27659.83,-4637.34"/>
<polygon fill="red" stroke="red" points="27663.33,-4637.34 27659.83,-4627.34 27656.33,-4637.34 27663.33,-4637.34"/>
<text text-anchor="middle" x="27817" y="-4685.8" font-family="Times,serif" font-size="14.00">AllGather GPU12→GPU13</text>
</g>
<!-- k_proj_1_3_1 -->
<g id="node59" class="node">
<title>k_proj_1_3_1</title>
<polygon fill="#b3ff66" stroke="black" points="27698,-4963 27564,-4963 27564,-4895 27698,-4895 27698,-4963"/>
<text text-anchor="middle" x="27631" y="-4947.8" font-family="Times,serif" font-size="14.00">K Projection 3_1</text>
<text text-anchor="middle" x="27631" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="27631" y="-4917.8" font-family="Times,serif" font-size="14.00">W_K^{3,1}</text>
<text text-anchor="middle" x="27631" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- k_proj_1_3_1&#45;&gt;attention_1_3_1 -->
<g id="edge63" class="edge">
<title>k_proj_1_3_1&#45;&gt;attention_1_3_1</title>
<path fill="none" stroke="black" d="M27631,-4894.98C27631,-4894.98 27631,-4818.2 27631,-4818.2"/>
<polygon fill="black" stroke="black" points="27634.5,-4818.2 27631,-4808.2 27627.5,-4818.2 27634.5,-4818.2"/>
</g>
<!-- v_proj_1_3_1 -->
<g id="node60" class="node">
<title>v_proj_1_3_1</title>
<polygon fill="#b3ff66" stroke="black" points="27505.5,-4963 27372.5,-4963 27372.5,-4895 27505.5,-4895 27505.5,-4963"/>
<text text-anchor="middle" x="27439" y="-4947.8" font-family="Times,serif" font-size="14.00">V Projection 3_1</text>
<text text-anchor="middle" x="27439" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="27439" y="-4917.8" font-family="Times,serif" font-size="14.00">W_V^{3,1}</text>
<text text-anchor="middle" x="27439" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- v_proj_1_3_1&#45;&gt;attention_1_3_1 -->
<g id="edge64" class="edge">
<title>v_proj_1_3_1&#45;&gt;attention_1_3_1</title>
<path fill="none" stroke="black" d="M27505.71,-4929C27531.19,-4929 27554.25,-4929 27554.25,-4929 27554.25,-4929 27554.25,-4818.02 27554.25,-4818.02"/>
<polygon fill="black" stroke="black" points="27557.75,-4818.02 27554.25,-4808.02 27550.75,-4818.02 27557.75,-4818.02"/>
</g>
<!-- q_proj_1_3_2 -->
<g id="node61" class="node">
<title>q_proj_1_3_2</title>
<polygon fill="#66ffb3" stroke="black" points="27314,-4963 27180,-4963 27180,-4895 27314,-4895 27314,-4963"/>
<text text-anchor="middle" x="27247" y="-4947.8" font-family="Times,serif" font-size="14.00">Q Projection 3_2</text>
<text text-anchor="middle" x="27247" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="27247" y="-4917.8" font-family="Times,serif" font-size="14.00">W_Q^{3,2}</text>
<text text-anchor="middle" x="27247" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- attention_1_3_2 -->
<g id="node62" class="node">
<title>attention_1_3_2</title>
<polygon fill="#66ffb3" stroke="black" points="27237.5,-4808 27064.5,-4808 27064.5,-4740 27237.5,-4740 27237.5,-4808"/>
<text text-anchor="middle" x="27151" y="-4792.8" font-family="Times,serif" font-size="14.00">Attention 3_2</text>
<text text-anchor="middle" x="27151" y="-4777.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="27151" y="-4762.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="27151" y="-4747.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- q_proj_1_3_2&#45;&gt;attention_1_3_2 -->
<g id="edge67" class="edge">
<title>q_proj_1_3_2&#45;&gt;attention_1_3_2</title>
<path fill="none" stroke="black" d="M27208.75,-4894.98C27208.75,-4894.98 27208.75,-4818.2 27208.75,-4818.2"/>
<polygon fill="black" stroke="black" points="27212.25,-4818.2 27208.75,-4808.2 27205.25,-4818.2 27212.25,-4818.2"/>
</g>
<!-- attention_1_3_2&#45;&gt;concat_group_1_3 -->
<g id="edge70" class="edge">
<title>attention_1_3_2&#45;&gt;concat_group_1_3</title>
<path fill="none" stroke="black" d="M27237.82,-4785C27350.12,-4785 27531.5,-4785 27531.5,-4785 27531.5,-4785 27531.5,-4607.85 27531.5,-4607.85"/>
<polygon fill="black" stroke="black" points="27535,-4607.85 27531.5,-4597.85 27528,-4607.85 27535,-4607.85"/>
</g>
<!-- attention_1_3_2&#45;&gt;concat_group_1_3 -->
<g id="edge71" class="edge">
<title>attention_1_3_2&#45;&gt;concat_group_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M27237.63,-4762C27346.28,-4762 27518.5,-4762 27518.5,-4762 27518.5,-4762 27518.5,-4602.68 27518.5,-4602.68"/>
<polygon fill="red" stroke="red" points="27522,-4602.68 27518.5,-4592.68 27515,-4602.68 27522,-4602.68"/>
<text text-anchor="middle" x="27498" y="-4685.8" font-family="Times,serif" font-size="14.00">AllGather GPU13→GPU14</text>
</g>
<!-- k_proj_1_3_2 -->
<g id="node63" class="node">
<title>k_proj_1_3_2</title>
<polygon fill="#66ffb3" stroke="black" points="27122,-4963 26988,-4963 26988,-4895 27122,-4895 27122,-4963"/>
<text text-anchor="middle" x="27055" y="-4947.8" font-family="Times,serif" font-size="14.00">K Projection 3_2</text>
<text text-anchor="middle" x="27055" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="27055" y="-4917.8" font-family="Times,serif" font-size="14.00">W_K^{3,2}</text>
<text text-anchor="middle" x="27055" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- k_proj_1_3_2&#45;&gt;attention_1_3_2 -->
<g id="edge68" class="edge">
<title>k_proj_1_3_2&#45;&gt;attention_1_3_2</title>
<path fill="none" stroke="black" d="M27093.25,-4894.98C27093.25,-4894.98 27093.25,-4818.2 27093.25,-4818.2"/>
<polygon fill="black" stroke="black" points="27096.75,-4818.2 27093.25,-4808.2 27089.75,-4818.2 27096.75,-4818.2"/>
</g>
<!-- v_proj_1_3_2 -->
<g id="node64" class="node">
<title>v_proj_1_3_2</title>
<polygon fill="#66ffb3" stroke="black" points="26929.5,-4963 26796.5,-4963 26796.5,-4895 26929.5,-4895 26929.5,-4963"/>
<text text-anchor="middle" x="26863" y="-4947.8" font-family="Times,serif" font-size="14.00">V Projection 3_2</text>
<text text-anchor="middle" x="26863" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="26863" y="-4917.8" font-family="Times,serif" font-size="14.00">W_V^{3,2}</text>
<text text-anchor="middle" x="26863" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- v_proj_1_3_2&#45;&gt;attention_1_3_2 -->
<g id="edge69" class="edge">
<title>v_proj_1_3_2&#45;&gt;attention_1_3_2</title>
<path fill="none" stroke="black" d="M26910.25,-4894.98C26910.25,-4849.36 26910.25,-4774 26910.25,-4774 26910.25,-4774 27054.42,-4774 27054.42,-4774"/>
<polygon fill="black" stroke="black" points="27054.42,-4777.5 27064.42,-4774 27054.42,-4770.5 27054.42,-4777.5"/>
</g>
<!-- q_proj_1_3_3 -->
<g id="node65" class="node">
<title>q_proj_1_3_3</title>
<polygon fill="#66b3ff" stroke="black" points="26738,-4963 26604,-4963 26604,-4895 26738,-4895 26738,-4963"/>
<text text-anchor="middle" x="26671" y="-4947.8" font-family="Times,serif" font-size="14.00">Q Projection 3_3</text>
<text text-anchor="middle" x="26671" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="26671" y="-4917.8" font-family="Times,serif" font-size="14.00">W_Q^{3,3}</text>
<text text-anchor="middle" x="26671" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- attention_1_3_3 -->
<g id="node66" class="node">
<title>attention_1_3_3</title>
<polygon fill="#66b3ff" stroke="black" points="26615.5,-4808 26442.5,-4808 26442.5,-4740 26615.5,-4740 26615.5,-4808"/>
<text text-anchor="middle" x="26529" y="-4792.8" font-family="Times,serif" font-size="14.00">Attention 3_3</text>
<text text-anchor="middle" x="26529" y="-4777.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="26529" y="-4762.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="26529" y="-4747.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- q_proj_1_3_3&#45;&gt;attention_1_3_3 -->
<g id="edge72" class="edge">
<title>q_proj_1_3_3&#45;&gt;attention_1_3_3</title>
<path fill="none" stroke="black" d="M26609.75,-4894.98C26609.75,-4894.98 26609.75,-4818.2 26609.75,-4818.2"/>
<polygon fill="black" stroke="black" points="26613.25,-4818.2 26609.75,-4808.2 26606.25,-4818.2 26613.25,-4818.2"/>
</g>
<!-- attention_1_3_3&#45;&gt;concat_group_1_3 -->
<g id="edge75" class="edge">
<title>attention_1_3_3&#45;&gt;concat_group_1_3</title>
<path fill="none" stroke="black" d="M26579.33,-4739.81C26579.33,-4689.9 26579.33,-4603 26579.33,-4603 26579.33,-4603 27534.04,-4603 27534.04,-4603"/>
<polygon fill="black" stroke="black" points="27534.04,-4606.5 27544.04,-4603 27534.04,-4599.5 27534.04,-4606.5"/>
</g>
<!-- attention_1_3_3&#45;&gt;concat_group_1_3 -->
<g id="edge76" class="edge">
<title>attention_1_3_3&#45;&gt;concat_group_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26543.17,-4739.98C26543.17,-4681.47 26543.17,-4568 26543.17,-4568 26543.17,-4568 27536.09,-4568 27536.09,-4568"/>
<polygon fill="red" stroke="red" points="27536.09,-4571.5 27546.09,-4568 27536.09,-4564.5 27536.09,-4571.5"/>
<text text-anchor="middle" x="27040" y="-4685.8" font-family="Times,serif" font-size="14.00">AllGather GPU14→GPU15</text>
</g>
<!-- k_proj_1_3_3 -->
<g id="node67" class="node">
<title>k_proj_1_3_3</title>
<polygon fill="#66b3ff" stroke="black" points="26546,-4963 26412,-4963 26412,-4895 26546,-4895 26546,-4963"/>
<text text-anchor="middle" x="26479" y="-4947.8" font-family="Times,serif" font-size="14.00">K Projection 3_3</text>
<text text-anchor="middle" x="26479" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="26479" y="-4917.8" font-family="Times,serif" font-size="14.00">W_K^{3,3}</text>
<text text-anchor="middle" x="26479" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- k_proj_1_3_3&#45;&gt;attention_1_3_3 -->
<g id="edge73" class="edge">
<title>k_proj_1_3_3&#45;&gt;attention_1_3_3</title>
<path fill="none" stroke="black" d="M26494.25,-4894.98C26494.25,-4894.98 26494.25,-4818.2 26494.25,-4818.2"/>
<polygon fill="black" stroke="black" points="26497.75,-4818.2 26494.25,-4808.2 26490.75,-4818.2 26497.75,-4818.2"/>
</g>
<!-- v_proj_1_3_3 -->
<g id="node68" class="node">
<title>v_proj_1_3_3</title>
<polygon fill="#66b3ff" stroke="black" points="26353.5,-4963 26220.5,-4963 26220.5,-4895 26353.5,-4895 26353.5,-4963"/>
<text text-anchor="middle" x="26287" y="-4947.8" font-family="Times,serif" font-size="14.00">V Projection 3_3</text>
<text text-anchor="middle" x="26287" y="-4932.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="26287" y="-4917.8" font-family="Times,serif" font-size="14.00">W_V^{3,3}</text>
<text text-anchor="middle" x="26287" y="-4902.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- v_proj_1_3_3&#45;&gt;attention_1_3_3 -->
<g id="edge74" class="edge">
<title>v_proj_1_3_3&#45;&gt;attention_1_3_3</title>
<path fill="none" stroke="black" d="M26334.25,-4894.98C26334.25,-4849.36 26334.25,-4774 26334.25,-4774 26334.25,-4774 26432.45,-4774 26432.45,-4774"/>
<polygon fill="black" stroke="black" points="26432.45,-4777.5 26442.45,-4774 26432.45,-4770.5 26432.45,-4777.5"/>
</g>
<!-- ffn_1_0 -->
<g id="node70" class="node">
<title>ffn_1_0</title>
<polygon fill="#ff9999" stroke="black" points="30855,-4253 30745,-4253 30745,-4200 30855,-4200 30855,-4253"/>
<text text-anchor="middle" x="30800" y="-4237.8" font-family="Times,serif" font-size="14.00">FFN Dense 0</text>
<text text-anchor="middle" x="30800" y="-4222.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="30800" y="-4207.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- final_concat_1&#45;&gt;ffn_1_0 -->
<g id="edge78" class="edge">
<title>final_concat_1&#45;&gt;ffn_1_0</title>
<path fill="none" stroke="black" d="M30800,-4339.86C30800,-4339.86 30800,-4263.1 30800,-4263.1"/>
<polygon fill="black" stroke="black" points="30803.5,-4263.1 30800,-4253.1 30796.5,-4263.1 30803.5,-4263.1"/>
</g>
<!-- ffn_out_1_0 -->
<g id="node71" class="node">
<title>ffn_out_1_0</title>
<polygon fill="#ff9999" stroke="black" points="30858,-4113 30742,-4113 30742,-4060 30858,-4060 30858,-4113"/>
<text text-anchor="middle" x="30800" y="-4097.8" font-family="Times,serif" font-size="14.00">FFN Output 0</text>
<text text-anchor="middle" x="30800" y="-4082.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="30800" y="-4067.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn_1_0&#45;&gt;ffn_out_1_0 -->
<g id="edge82" class="edge">
<title>ffn_1_0&#45;&gt;ffn_out_1_0</title>
<path fill="none" stroke="black" d="M30800,-4199.84C30800,-4199.84 30800,-4123.06 30800,-4123.06"/>
<polygon fill="black" stroke="black" points="30803.5,-4123.06 30800,-4113.06 30796.5,-4123.06 30803.5,-4123.06"/>
</g>
<!-- layer_norm_1 -->
<g id="node72" class="node">
<title>layer_norm_1</title>
<ellipse fill="#e6e6e6" stroke="black" cx="29454" cy="-3935.5" rx="82" ry="37.5"/>
<text text-anchor="middle" x="29454" y="-3946.8" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="29454" y="-3931.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="29454" y="-3916.8" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- ffn_out_1_0&#45;&gt;layer_norm_1 -->
<g id="edge83" class="edge">
<title>ffn_out_1_0&#45;&gt;layer_norm_1</title>
<path fill="none" stroke="black" d="M30800,-4059.63C30800,-4009.55 30800,-3907 30800,-3907 30800,-3907 29517.6,-3907 29517.6,-3907"/>
<polygon fill="black" stroke="black" points="29517.6,-3903.5 29507.6,-3907 29517.6,-3910.5 29517.6,-3903.5"/>
</g>
<!-- q_proj_2_0_0 -->
<g id="node103" class="node">
<title>q_proj_2_0_0</title>
<polygon fill="#ff9999" stroke="black" points="29521,-3811 29387,-3811 29387,-3743 29521,-3743 29521,-3811"/>
<text text-anchor="middle" x="29454" y="-3795.8" font-family="Times,serif" font-size="14.00">Q Projection 0_0</text>
<text text-anchor="middle" x="29454" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="29454" y="-3765.8" font-family="Times,serif" font-size="14.00">W_Q^{0,0}</text>
<text text-anchor="middle" x="29454" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_norm_1&#45;&gt;q_proj_2_0_0 -->
<g id="edge489" class="edge">
<title>layer_norm_1&#45;&gt;q_proj_2_0_0</title>
<path fill="none" stroke="black" d="M29454,-3897.94C29454,-3897.94 29454,-3821.05 29454,-3821.05"/>
<polygon fill="black" stroke="black" points="29457.5,-3821.05 29454,-3811.05 29450.5,-3821.05 29457.5,-3821.05"/>
</g>
<!-- ffn_1_1 -->
<g id="node73" class="node">
<title>ffn_1_1</title>
<polygon fill="#ffcc99" stroke="black" points="30681,-4253 30571,-4253 30571,-4200 30681,-4200 30681,-4253"/>
<text text-anchor="middle" x="30626" y="-4237.8" font-family="Times,serif" font-size="14.00">FFN Dense 1</text>
<text text-anchor="middle" x="30626" y="-4222.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="30626" y="-4207.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn_out_1_1 -->
<g id="node74" class="node">
<title>ffn_out_1_1</title>
<polygon fill="#ffcc99" stroke="black" points="30684,-4113 30568,-4113 30568,-4060 30684,-4060 30684,-4113"/>
<text text-anchor="middle" x="30626" y="-4097.8" font-family="Times,serif" font-size="14.00">FFN Output 1</text>
<text text-anchor="middle" x="30626" y="-4082.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="30626" y="-4067.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn_1_1&#45;&gt;ffn_out_1_1 -->
<g id="edge84" class="edge">
<title>ffn_1_1&#45;&gt;ffn_out_1_1</title>
<path fill="none" stroke="black" d="M30626,-4199.84C30626,-4199.84 30626,-4123.06 30626,-4123.06"/>
<polygon fill="black" stroke="black" points="30629.5,-4123.06 30626,-4113.06 30622.5,-4123.06 30629.5,-4123.06"/>
</g>
<!-- ffn_out_1_1&#45;&gt;layer_norm_1 -->
<g id="edge85" class="edge">
<title>ffn_out_1_1&#45;&gt;layer_norm_1</title>
<path fill="none" stroke="black" d="M30626,-4059.86C30626,-4011.91 30626,-3916 30626,-3916 30626,-3916 29534.24,-3916 29534.24,-3916"/>
<polygon fill="black" stroke="black" points="29534.24,-3912.5 29524.24,-3916 29534.24,-3919.5 29534.24,-3912.5"/>
</g>
<!-- ffn_1_2 -->
<g id="node75" class="node">
<title>ffn_1_2</title>
<polygon fill="#ffff99" stroke="black" points="30507,-4253 30397,-4253 30397,-4200 30507,-4200 30507,-4253"/>
<text text-anchor="middle" x="30452" y="-4237.8" font-family="Times,serif" font-size="14.00">FFN Dense 2</text>
<text text-anchor="middle" x="30452" y="-4222.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="30452" y="-4207.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn_out_1_2 -->
<g id="node76" class="node">
<title>ffn_out_1_2</title>
<polygon fill="#ffff99" stroke="black" points="30510,-4113 30394,-4113 30394,-4060 30510,-4060 30510,-4113"/>
<text text-anchor="middle" x="30452" y="-4097.8" font-family="Times,serif" font-size="14.00">FFN Output 2</text>
<text text-anchor="middle" x="30452" y="-4082.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="30452" y="-4067.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn_1_2&#45;&gt;ffn_out_1_2 -->
<g id="edge86" class="edge">
<title>ffn_1_2&#45;&gt;ffn_out_1_2</title>
<path fill="none" stroke="black" d="M30452,-4199.84C30452,-4199.84 30452,-4123.06 30452,-4123.06"/>
<polygon fill="black" stroke="black" points="30455.5,-4123.06 30452,-4113.06 30448.5,-4123.06 30455.5,-4123.06"/>
</g>
<!-- ffn_out_1_2&#45;&gt;layer_norm_1 -->
<g id="edge87" class="edge">
<title>ffn_out_1_2&#45;&gt;layer_norm_1</title>
<path fill="none" stroke="black" d="M30452,-4060C30452,-4014.41 30452,-3926 30452,-3926 30452,-3926 29543.56,-3926 29543.56,-3926"/>
<polygon fill="black" stroke="black" points="29543.56,-3922.5 29533.56,-3926 29543.56,-3929.5 29543.56,-3922.5"/>
</g>
<!-- ffn_1_3 -->
<g id="node77" class="node">
<title>ffn_1_3</title>
<polygon fill="#ccff99" stroke="black" points="30333,-4253 30223,-4253 30223,-4200 30333,-4200 30333,-4253"/>
<text text-anchor="middle" x="30278" y="-4237.8" font-family="Times,serif" font-size="14.00">FFN Dense 3</text>
<text text-anchor="middle" x="30278" y="-4222.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="30278" y="-4207.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn_out_1_3 -->
<g id="node78" class="node">
<title>ffn_out_1_3</title>
<polygon fill="#ccff99" stroke="black" points="30336,-4113 30220,-4113 30220,-4060 30336,-4060 30336,-4113"/>
<text text-anchor="middle" x="30278" y="-4097.8" font-family="Times,serif" font-size="14.00">FFN Output 3</text>
<text text-anchor="middle" x="30278" y="-4082.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="30278" y="-4067.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn_1_3&#45;&gt;ffn_out_1_3 -->
<g id="edge88" class="edge">
<title>ffn_1_3&#45;&gt;ffn_out_1_3</title>
<path fill="none" stroke="black" d="M30278,-4199.84C30278,-4199.84 30278,-4123.06 30278,-4123.06"/>
<polygon fill="black" stroke="black" points="30281.5,-4123.06 30278,-4113.06 30274.5,-4123.06 30281.5,-4123.06"/>
</g>
<!-- ffn_out_1_3&#45;&gt;layer_norm_1 -->
<g id="edge89" class="edge">
<title>ffn_out_1_3&#45;&gt;layer_norm_1</title>
<path fill="none" stroke="black" d="M30278,-4059.76C30278,-4016.27 30278,-3935 30278,-3935 30278,-3935 29546.02,-3935 29546.02,-3935"/>
<polygon fill="black" stroke="black" points="29546.02,-3931.5 29536.02,-3935 29546.02,-3938.5 29546.02,-3931.5"/>
</g>
<!-- ffn_1_4 -->
<g id="node79" class="node">
<title>ffn_1_4</title>
<polygon fill="#99ff99" stroke="black" points="30159,-4253 30049,-4253 30049,-4200 30159,-4200 30159,-4253"/>
<text text-anchor="middle" x="30104" y="-4237.8" font-family="Times,serif" font-size="14.00">FFN Dense 4</text>
<text text-anchor="middle" x="30104" y="-4222.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="30104" y="-4207.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn_out_1_4 -->
<g id="node80" class="node">
<title>ffn_out_1_4</title>
<polygon fill="#99ff99" stroke="black" points="30162,-4113 30046,-4113 30046,-4060 30162,-4060 30162,-4113"/>
<text text-anchor="middle" x="30104" y="-4097.8" font-family="Times,serif" font-size="14.00">FFN Output 4</text>
<text text-anchor="middle" x="30104" y="-4082.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="30104" y="-4067.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn_1_4&#45;&gt;ffn_out_1_4 -->
<g id="edge90" class="edge">
<title>ffn_1_4&#45;&gt;ffn_out_1_4</title>
<path fill="none" stroke="black" d="M30104,-4199.84C30104,-4199.84 30104,-4123.06 30104,-4123.06"/>
<polygon fill="black" stroke="black" points="30107.5,-4123.06 30104,-4113.06 30100.5,-4123.06 30107.5,-4123.06"/>
</g>
<!-- ffn_out_1_4&#45;&gt;layer_norm_1 -->
<g id="edge91" class="edge">
<title>ffn_out_1_4&#45;&gt;layer_norm_1</title>
<path fill="none" stroke="black" d="M30104,-4059.7C30104,-4018.42 30104,-3944 30104,-3944 30104,-3944 29544.03,-3944 29544.03,-3944"/>
<polygon fill="black" stroke="black" points="29544.03,-3940.5 29534.03,-3944 29544.03,-3947.5 29544.03,-3940.5"/>
</g>
<!-- ffn_1_5 -->
<g id="node81" class="node">
<title>ffn_1_5</title>
<polygon fill="#99ffcc" stroke="black" points="29985,-4253 29875,-4253 29875,-4200 29985,-4200 29985,-4253"/>
<text text-anchor="middle" x="29930" y="-4237.8" font-family="Times,serif" font-size="14.00">FFN Dense 5</text>
<text text-anchor="middle" x="29930" y="-4222.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="29930" y="-4207.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn_out_1_5 -->
<g id="node82" class="node">
<title>ffn_out_1_5</title>
<polygon fill="#99ffcc" stroke="black" points="29988,-4113 29872,-4113 29872,-4060 29988,-4060 29988,-4113"/>
<text text-anchor="middle" x="29930" y="-4097.8" font-family="Times,serif" font-size="14.00">FFN Output 5</text>
<text text-anchor="middle" x="29930" y="-4082.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="29930" y="-4067.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn_1_5&#45;&gt;ffn_out_1_5 -->
<g id="edge92" class="edge">
<title>ffn_1_5&#45;&gt;ffn_out_1_5</title>
<path fill="none" stroke="black" d="M29930,-4199.84C29930,-4199.84 29930,-4123.06 29930,-4123.06"/>
<polygon fill="black" stroke="black" points="29933.5,-4123.06 29930,-4113.06 29926.5,-4123.06 29933.5,-4123.06"/>
</g>
<!-- ffn_out_1_5&#45;&gt;layer_norm_1 -->
<g id="edge93" class="edge">
<title>ffn_out_1_5&#45;&gt;layer_norm_1</title>
<path fill="none" stroke="black" d="M29930,-4059.69C29930,-4020.97 29930,-3954 29930,-3954 29930,-3954 29535.52,-3954 29535.52,-3954"/>
<polygon fill="black" stroke="black" points="29535.52,-3950.5 29525.52,-3954 29535.52,-3957.5 29535.52,-3950.5"/>
</g>
<!-- ffn_1_6 -->
<g id="node83" class="node">
<title>ffn_1_6</title>
<polygon fill="#99ffff" stroke="black" points="29811,-4253 29701,-4253 29701,-4200 29811,-4200 29811,-4253"/>
<text text-anchor="middle" x="29756" y="-4237.8" font-family="Times,serif" font-size="14.00">FFN Dense 6</text>
<text text-anchor="middle" x="29756" y="-4222.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="29756" y="-4207.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn_out_1_6 -->
<g id="node84" class="node">
<title>ffn_out_1_6</title>
<polygon fill="#99ffff" stroke="black" points="29814,-4113 29698,-4113 29698,-4060 29814,-4060 29814,-4113"/>
<text text-anchor="middle" x="29756" y="-4097.8" font-family="Times,serif" font-size="14.00">FFN Output 6</text>
<text text-anchor="middle" x="29756" y="-4082.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="29756" y="-4067.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn_1_6&#45;&gt;ffn_out_1_6 -->
<g id="edge94" class="edge">
<title>ffn_1_6&#45;&gt;ffn_out_1_6</title>
<path fill="none" stroke="black" d="M29756,-4199.84C29756,-4199.84 29756,-4123.06 29756,-4123.06"/>
<polygon fill="black" stroke="black" points="29759.5,-4123.06 29756,-4113.06 29752.5,-4123.06 29759.5,-4123.06"/>
</g>
<!-- ffn_out_1_6&#45;&gt;layer_norm_1 -->
<g id="edge95" class="edge">
<title>ffn_out_1_6&#45;&gt;layer_norm_1</title>
<path fill="none" stroke="black" d="M29756,-4059.7C29756,-4023.38 29756,-3963 29756,-3963 29756,-3963 29520.1,-3963 29520.1,-3963"/>
<polygon fill="black" stroke="black" points="29520.1,-3959.5 29510.1,-3963 29520.1,-3966.5 29520.1,-3959.5"/>
</g>
<!-- ffn_1_7 -->
<g id="node85" class="node">
<title>ffn_1_7</title>
<polygon fill="#99ccff" stroke="black" points="29637,-4253 29527,-4253 29527,-4200 29637,-4200 29637,-4253"/>
<text text-anchor="middle" x="29582" y="-4237.8" font-family="Times,serif" font-size="14.00">FFN Dense 7</text>
<text text-anchor="middle" x="29582" y="-4222.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="29582" y="-4207.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn_out_1_7 -->
<g id="node86" class="node">
<title>ffn_out_1_7</title>
<polygon fill="#99ccff" stroke="black" points="29640,-4113 29524,-4113 29524,-4060 29640,-4060 29640,-4113"/>
<text text-anchor="middle" x="29582" y="-4097.8" font-family="Times,serif" font-size="14.00">FFN Output 7</text>
<text text-anchor="middle" x="29582" y="-4082.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="29582" y="-4067.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn_1_7&#45;&gt;ffn_out_1_7 -->
<g id="edge96" class="edge">
<title>ffn_1_7&#45;&gt;ffn_out_1_7</title>
<path fill="none" stroke="black" d="M29582,-4199.84C29582,-4199.84 29582,-4123.06 29582,-4123.06"/>
<polygon fill="black" stroke="black" points="29585.5,-4123.06 29582,-4113.06 29578.5,-4123.06 29585.5,-4123.06"/>
</g>
<!-- ffn_out_1_7&#45;&gt;layer_norm_1 -->
<g id="edge97" class="edge">
<title>ffn_out_1_7&#45;&gt;layer_norm_1</title>
<path fill="none" stroke="black" d="M29530,-4059.85C29530,-4059.85 29530,-3959.62 29530,-3959.62"/>
<polygon fill="black" stroke="black" points="29533.5,-3959.62 29530,-3949.62 29526.5,-3959.62 29533.5,-3959.62"/>
</g>
<!-- ffn_1_8 -->
<g id="node87" class="node">
<title>ffn_1_8</title>
<polygon fill="#9999ff" stroke="black" points="29463,-4253 29353,-4253 29353,-4200 29463,-4200 29463,-4253"/>
<text text-anchor="middle" x="29408" y="-4237.8" font-family="Times,serif" font-size="14.00">FFN Dense 8</text>
<text text-anchor="middle" x="29408" y="-4222.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="29408" y="-4207.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn_out_1_8 -->
<g id="node88" class="node">
<title>ffn_out_1_8</title>
<polygon fill="#9999ff" stroke="black" points="29466,-4113 29350,-4113 29350,-4060 29466,-4060 29466,-4113"/>
<text text-anchor="middle" x="29408" y="-4097.8" font-family="Times,serif" font-size="14.00">FFN Output 8</text>
<text text-anchor="middle" x="29408" y="-4082.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="29408" y="-4067.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn_1_8&#45;&gt;ffn_out_1_8 -->
<g id="edge98" class="edge">
<title>ffn_1_8&#45;&gt;ffn_out_1_8</title>
<path fill="none" stroke="black" d="M29408,-4199.84C29408,-4199.84 29408,-4123.06 29408,-4123.06"/>
<polygon fill="black" stroke="black" points="29411.5,-4123.06 29408,-4113.06 29404.5,-4123.06 29411.5,-4123.06"/>
</g>
<!-- ffn_out_1_8&#45;&gt;layer_norm_1 -->
<g id="edge99" class="edge">
<title>ffn_out_1_8&#45;&gt;layer_norm_1</title>
<path fill="none" stroke="black" d="M29419,-4059.85C29419,-4059.85 29419,-3979.56 29419,-3979.56"/>
<polygon fill="black" stroke="black" points="29422.5,-3979.56 29419,-3969.56 29415.5,-3979.56 29422.5,-3979.56"/>
</g>
<!-- ffn_1_9 -->
<g id="node89" class="node">
<title>ffn_1_9</title>
<polygon fill="#cc99ff" stroke="black" points="29289,-4253 29179,-4253 29179,-4200 29289,-4200 29289,-4253"/>
<text text-anchor="middle" x="29234" y="-4237.8" font-family="Times,serif" font-size="14.00">FFN Dense 9</text>
<text text-anchor="middle" x="29234" y="-4222.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="29234" y="-4207.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn_out_1_9 -->
<g id="node90" class="node">
<title>ffn_out_1_9</title>
<polygon fill="#cc99ff" stroke="black" points="29292,-4113 29176,-4113 29176,-4060 29292,-4060 29292,-4113"/>
<text text-anchor="middle" x="29234" y="-4097.8" font-family="Times,serif" font-size="14.00">FFN Output 9</text>
<text text-anchor="middle" x="29234" y="-4082.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="29234" y="-4067.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn_1_9&#45;&gt;ffn_out_1_9 -->
<g id="edge100" class="edge">
<title>ffn_1_9&#45;&gt;ffn_out_1_9</title>
<path fill="none" stroke="black" d="M29234,-4199.84C29234,-4199.84 29234,-4123.06 29234,-4123.06"/>
<polygon fill="black" stroke="black" points="29237.5,-4123.06 29234,-4113.06 29230.5,-4123.06 29237.5,-4123.06"/>
</g>
<!-- ffn_out_1_9&#45;&gt;layer_norm_1 -->
<g id="edge101" class="edge">
<title>ffn_out_1_9&#45;&gt;layer_norm_1</title>
<path fill="none" stroke="black" d="M29243.5,-4059.7C29243.5,-4023.38 29243.5,-3963 29243.5,-3963 29243.5,-3963 29388.14,-3963 29388.14,-3963"/>
<polygon fill="black" stroke="black" points="29388.14,-3966.5 29398.14,-3963 29388.14,-3959.5 29388.14,-3966.5"/>
</g>
<!-- ffn_1_10 -->
<g id="node91" class="node">
<title>ffn_1_10</title>
<polygon fill="#ff99ff" stroke="black" points="29114.5,-4253 28995.5,-4253 28995.5,-4200 29114.5,-4200 29114.5,-4253"/>
<text text-anchor="middle" x="29055" y="-4237.8" font-family="Times,serif" font-size="14.00">FFN Dense 10</text>
<text text-anchor="middle" x="29055" y="-4222.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="29055" y="-4207.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn_out_1_10 -->
<g id="node92" class="node">
<title>ffn_out_1_10</title>
<polygon fill="#ff99ff" stroke="black" points="29117.5,-4113 28992.5,-4113 28992.5,-4060 29117.5,-4060 29117.5,-4113"/>
<text text-anchor="middle" x="29055" y="-4097.8" font-family="Times,serif" font-size="14.00">FFN Output 10</text>
<text text-anchor="middle" x="29055" y="-4082.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="29055" y="-4067.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn_1_10&#45;&gt;ffn_out_1_10 -->
<g id="edge102" class="edge">
<title>ffn_1_10&#45;&gt;ffn_out_1_10</title>
<path fill="none" stroke="black" d="M29055,-4199.84C29055,-4199.84 29055,-4123.06 29055,-4123.06"/>
<polygon fill="black" stroke="black" points="29058.5,-4123.06 29055,-4113.06 29051.5,-4123.06 29058.5,-4123.06"/>
</g>
<!-- ffn_out_1_10&#45;&gt;layer_norm_1 -->
<g id="edge103" class="edge">
<title>ffn_out_1_10&#45;&gt;layer_norm_1</title>
<path fill="none" stroke="black" d="M29060.5,-4059.69C29060.5,-4020.97 29060.5,-3954 29060.5,-3954 29060.5,-3954 29372.28,-3954 29372.28,-3954"/>
<polygon fill="black" stroke="black" points="29372.28,-3957.5 29382.28,-3954 29372.28,-3950.5 29372.28,-3957.5"/>
</g>
<!-- ffn_1_11 -->
<g id="node93" class="node">
<title>ffn_1_11</title>
<polygon fill="#ff99cc" stroke="black" points="28931.5,-4253 28812.5,-4253 28812.5,-4200 28931.5,-4200 28931.5,-4253"/>
<text text-anchor="middle" x="28872" y="-4237.8" font-family="Times,serif" font-size="14.00">FFN Dense 11</text>
<text text-anchor="middle" x="28872" y="-4222.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="28872" y="-4207.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn_out_1_11 -->
<g id="node94" class="node">
<title>ffn_out_1_11</title>
<polygon fill="#ff99cc" stroke="black" points="28934.5,-4113 28809.5,-4113 28809.5,-4060 28934.5,-4060 28934.5,-4113"/>
<text text-anchor="middle" x="28872" y="-4097.8" font-family="Times,serif" font-size="14.00">FFN Output 11</text>
<text text-anchor="middle" x="28872" y="-4082.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="28872" y="-4067.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn_1_11&#45;&gt;ffn_out_1_11 -->
<g id="edge104" class="edge">
<title>ffn_1_11&#45;&gt;ffn_out_1_11</title>
<path fill="none" stroke="black" d="M28872,-4199.84C28872,-4199.84 28872,-4123.06 28872,-4123.06"/>
<polygon fill="black" stroke="black" points="28875.5,-4123.06 28872,-4113.06 28868.5,-4123.06 28875.5,-4123.06"/>
</g>
<!-- ffn_out_1_11&#45;&gt;layer_norm_1 -->
<g id="edge105" class="edge">
<title>ffn_out_1_11&#45;&gt;layer_norm_1</title>
<path fill="none" stroke="black" d="M28872.75,-4059.7C28872.75,-4018.42 28872.75,-3944 28872.75,-3944 28872.75,-3944 29364.09,-3944 29364.09,-3944"/>
<polygon fill="black" stroke="black" points="29364.09,-3947.5 29374.09,-3944 29364.09,-3940.5 29364.09,-3947.5"/>
</g>
<!-- ffn_1_12 -->
<g id="node95" class="node">
<title>ffn_1_12</title>
<polygon fill="#ffb366" stroke="black" points="28748.5,-4253 28629.5,-4253 28629.5,-4200 28748.5,-4200 28748.5,-4253"/>
<text text-anchor="middle" x="28689" y="-4237.8" font-family="Times,serif" font-size="14.00">FFN Dense 12</text>
<text text-anchor="middle" x="28689" y="-4222.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="28689" y="-4207.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn_out_1_12 -->
<g id="node96" class="node">
<title>ffn_out_1_12</title>
<polygon fill="#ffb366" stroke="black" points="28751.5,-4113 28626.5,-4113 28626.5,-4060 28751.5,-4060 28751.5,-4113"/>
<text text-anchor="middle" x="28689" y="-4097.8" font-family="Times,serif" font-size="14.00">FFN Output 12</text>
<text text-anchor="middle" x="28689" y="-4082.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="28689" y="-4067.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn_1_12&#45;&gt;ffn_out_1_12 -->
<g id="edge106" class="edge">
<title>ffn_1_12&#45;&gt;ffn_out_1_12</title>
<path fill="none" stroke="black" d="M28689,-4199.84C28689,-4199.84 28689,-4123.06 28689,-4123.06"/>
<polygon fill="black" stroke="black" points="28692.5,-4123.06 28689,-4113.06 28685.5,-4123.06 28692.5,-4123.06"/>
</g>
<!-- ffn_out_1_12&#45;&gt;layer_norm_1 -->
<g id="edge107" class="edge">
<title>ffn_out_1_12&#45;&gt;layer_norm_1</title>
<path fill="none" stroke="black" d="M28689,-4059.76C28689,-4016.27 28689,-3935 28689,-3935 28689,-3935 29361.77,-3935 29361.77,-3935"/>
<polygon fill="black" stroke="black" points="29361.77,-3938.5 29371.77,-3935 29361.77,-3931.5 29361.77,-3938.5"/>
</g>
<!-- ffn_1_13 -->
<g id="node97" class="node">
<title>ffn_1_13</title>
<polygon fill="#b3ff66" stroke="black" points="28565.5,-4253 28446.5,-4253 28446.5,-4200 28565.5,-4200 28565.5,-4253"/>
<text text-anchor="middle" x="28506" y="-4237.8" font-family="Times,serif" font-size="14.00">FFN Dense 13</text>
<text text-anchor="middle" x="28506" y="-4222.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="28506" y="-4207.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn_out_1_13 -->
<g id="node98" class="node">
<title>ffn_out_1_13</title>
<polygon fill="#b3ff66" stroke="black" points="28568.5,-4113 28443.5,-4113 28443.5,-4060 28568.5,-4060 28568.5,-4113"/>
<text text-anchor="middle" x="28506" y="-4097.8" font-family="Times,serif" font-size="14.00">FFN Output 13</text>
<text text-anchor="middle" x="28506" y="-4082.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="28506" y="-4067.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn_1_13&#45;&gt;ffn_out_1_13 -->
<g id="edge108" class="edge">
<title>ffn_1_13&#45;&gt;ffn_out_1_13</title>
<path fill="none" stroke="black" d="M28506,-4199.84C28506,-4199.84 28506,-4123.06 28506,-4123.06"/>
<polygon fill="black" stroke="black" points="28509.5,-4123.06 28506,-4113.06 28502.5,-4123.06 28509.5,-4123.06"/>
</g>
<!-- ffn_out_1_13&#45;&gt;layer_norm_1 -->
<g id="edge109" class="edge">
<title>ffn_out_1_13&#45;&gt;layer_norm_1</title>
<path fill="none" stroke="black" d="M28564.5,-4060C28564.5,-4014.41 28564.5,-3926 28564.5,-3926 28564.5,-3926 29364.67,-3926 29364.67,-3926"/>
<polygon fill="black" stroke="black" points="29364.67,-3929.5 29374.67,-3926 29364.67,-3922.5 29364.67,-3929.5"/>
</g>
<!-- ffn_1_14 -->
<g id="node99" class="node">
<title>ffn_1_14</title>
<polygon fill="#66ffb3" stroke="black" points="28382.5,-4253 28263.5,-4253 28263.5,-4200 28382.5,-4200 28382.5,-4253"/>
<text text-anchor="middle" x="28323" y="-4237.8" font-family="Times,serif" font-size="14.00">FFN Dense 14</text>
<text text-anchor="middle" x="28323" y="-4222.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="28323" y="-4207.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn_out_1_14 -->
<g id="node100" class="node">
<title>ffn_out_1_14</title>
<polygon fill="#66ffb3" stroke="black" points="28385.5,-4113 28260.5,-4113 28260.5,-4060 28385.5,-4060 28385.5,-4113"/>
<text text-anchor="middle" x="28323" y="-4097.8" font-family="Times,serif" font-size="14.00">FFN Output 14</text>
<text text-anchor="middle" x="28323" y="-4082.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="28323" y="-4067.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn_1_14&#45;&gt;ffn_out_1_14 -->
<g id="edge110" class="edge">
<title>ffn_1_14&#45;&gt;ffn_out_1_14</title>
<path fill="none" stroke="black" d="M28323,-4199.84C28323,-4199.84 28323,-4123.06 28323,-4123.06"/>
<polygon fill="black" stroke="black" points="28326.5,-4123.06 28323,-4113.06 28319.5,-4123.06 28326.5,-4123.06"/>
</g>
<!-- ffn_out_1_14&#45;&gt;layer_norm_1 -->
<g id="edge111" class="edge">
<title>ffn_out_1_14&#45;&gt;layer_norm_1</title>
<path fill="none" stroke="black" d="M28377.25,-4059.86C28377.25,-4011.91 28377.25,-3916 28377.25,-3916 28377.25,-3916 29373.77,-3916 29373.77,-3916"/>
<polygon fill="black" stroke="black" points="29373.77,-3919.5 29383.77,-3916 29373.77,-3912.5 29373.77,-3919.5"/>
</g>
<!-- ffn_1_15 -->
<g id="node101" class="node">
<title>ffn_1_15</title>
<polygon fill="#66b3ff" stroke="black" points="28199.5,-4253 28080.5,-4253 28080.5,-4200 28199.5,-4200 28199.5,-4253"/>
<text text-anchor="middle" x="28140" y="-4237.8" font-family="Times,serif" font-size="14.00">FFN Dense 15</text>
<text text-anchor="middle" x="28140" y="-4222.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="28140" y="-4207.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn_out_1_15 -->
<g id="node102" class="node">
<title>ffn_out_1_15</title>
<polygon fill="#66b3ff" stroke="black" points="28202.5,-4113 28077.5,-4113 28077.5,-4060 28202.5,-4060 28202.5,-4113"/>
<text text-anchor="middle" x="28140" y="-4097.8" font-family="Times,serif" font-size="14.00">FFN Output 15</text>
<text text-anchor="middle" x="28140" y="-4082.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="28140" y="-4067.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn_1_15&#45;&gt;ffn_out_1_15 -->
<g id="edge112" class="edge">
<title>ffn_1_15&#45;&gt;ffn_out_1_15</title>
<path fill="none" stroke="black" d="M28140,-4199.84C28140,-4199.84 28140,-4123.06 28140,-4123.06"/>
<polygon fill="black" stroke="black" points="28143.5,-4123.06 28140,-4113.06 28136.5,-4123.06 28143.5,-4123.06"/>
</g>
<!-- ffn_out_1_15&#45;&gt;layer_norm_1 -->
<g id="edge113" class="edge">
<title>ffn_out_1_15&#45;&gt;layer_norm_1</title>
<path fill="none" stroke="black" d="M28183.5,-4059.63C28183.5,-4009.55 28183.5,-3907 28183.5,-3907 28183.5,-3907 29390.62,-3907 29390.62,-3907"/>
<polygon fill="black" stroke="black" points="29390.62,-3910.5 29400.62,-3907 29390.62,-3903.5 29390.62,-3910.5"/>
</g>
<!-- attention_2_0_0 -->
<g id="node104" class="node">
<title>attention_2_0_0</title>
<polygon fill="#ff9999" stroke="black" points="29252.5,-3656 29079.5,-3656 29079.5,-3588 29252.5,-3588 29252.5,-3656"/>
<text text-anchor="middle" x="29166" y="-3640.8" font-family="Times,serif" font-size="14.00">Attention 0_0</text>
<text text-anchor="middle" x="29166" y="-3625.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="29166" y="-3610.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="29166" y="-3595.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- q_proj_2_0_0&#45;&gt;attention_2_0_0 -->
<g id="edge114" class="edge">
<title>q_proj_2_0_0&#45;&gt;attention_2_0_0</title>
<path fill="none" stroke="black" d="M29454,-3742.98C29454,-3697.36 29454,-3622 29454,-3622 29454,-3622 29262.8,-3622 29262.8,-3622"/>
<polygon fill="black" stroke="black" points="29262.8,-3618.5 29252.8,-3622 29262.8,-3625.5 29262.8,-3618.5"/>
</g>
<!-- concat_group_2_0 -->
<g id="node107" class="node">
<title>concat_group_2_0</title>
<polygon fill="#ffd700" stroke="black" points="28110,-3487 27982,-3434 28110,-3381 28238,-3434 28110,-3487"/>
<text text-anchor="middle" x="28110" y="-3445.3" font-family="Times,serif" font-size="14.00">Concat Group 0</text>
<text text-anchor="middle" x="28110" y="-3430.3" font-family="Times,serif" font-size="14.00">[B×L×d×h_g]</text>
<text text-anchor="middle" x="28110" y="-3415.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- attention_2_0_0&#45;&gt;concat_group_2_0 -->
<g id="edge117" class="edge">
<title>attention_2_0_0&#45;&gt;concat_group_2_0</title>
<path fill="none" stroke="black" d="M29166,-3587.95C29166,-3533.78 29166,-3434 29166,-3434 29166,-3434 28248.17,-3434 28248.17,-3434"/>
<polygon fill="black" stroke="black" points="28248.17,-3430.5 28238.17,-3434 28248.17,-3437.5 28248.17,-3430.5"/>
</g>
<!-- k_proj_2_0_0 -->
<g id="node105" class="node">
<title>k_proj_2_0_0</title>
<polygon fill="#ff9999" stroke="black" points="29329,-3811 29195,-3811 29195,-3743 29329,-3743 29329,-3811"/>
<text text-anchor="middle" x="29262" y="-3795.8" font-family="Times,serif" font-size="14.00">K Projection 0_0</text>
<text text-anchor="middle" x="29262" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="29262" y="-3765.8" font-family="Times,serif" font-size="14.00">W_K^{0,0}</text>
<text text-anchor="middle" x="29262" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- k_proj_2_0_0&#45;&gt;attention_2_0_0 -->
<g id="edge115" class="edge">
<title>k_proj_2_0_0&#45;&gt;attention_2_0_0</title>
<path fill="none" stroke="black" d="M29223.75,-3742.98C29223.75,-3742.98 29223.75,-3666.2 29223.75,-3666.2"/>
<polygon fill="black" stroke="black" points="29227.25,-3666.2 29223.75,-3656.2 29220.25,-3666.2 29227.25,-3666.2"/>
</g>
<!-- v_proj_2_0_0 -->
<g id="node106" class="node">
<title>v_proj_2_0_0</title>
<polygon fill="#ff9999" stroke="black" points="29136.5,-3811 29003.5,-3811 29003.5,-3743 29136.5,-3743 29136.5,-3811"/>
<text text-anchor="middle" x="29070" y="-3795.8" font-family="Times,serif" font-size="14.00">V Projection 0_0</text>
<text text-anchor="middle" x="29070" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="29070" y="-3765.8" font-family="Times,serif" font-size="14.00">W_V^{0,0}</text>
<text text-anchor="middle" x="29070" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- v_proj_2_0_0&#45;&gt;attention_2_0_0 -->
<g id="edge116" class="edge">
<title>v_proj_2_0_0&#45;&gt;attention_2_0_0</title>
<path fill="none" stroke="black" d="M29108,-3742.98C29108,-3742.98 29108,-3666.2 29108,-3666.2"/>
<polygon fill="black" stroke="black" points="29111.5,-3666.2 29108,-3656.2 29104.5,-3666.2 29111.5,-3666.2"/>
</g>
<!-- final_concat_2 -->
<g id="node171" class="node">
<title>final_concat_2</title>
<polygon fill="#ffa500" stroke="black" points="24512,-3294 24347,-3241 24512,-3188 24677,-3241 24512,-3294"/>
<text text-anchor="middle" x="24512" y="-3252.3" font-family="Times,serif" font-size="14.00">Final Concat Layer 2</text>
<text text-anchor="middle" x="24512" y="-3237.3" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="24512" y="-3222.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- concat_group_2_0&#45;&gt;final_concat_2 -->
<g id="edge190" class="edge">
<title>concat_group_2_0&#45;&gt;final_concat_2</title>
<path fill="none" stroke="black" d="M28110,-3380.75C28110,-3323.62 28110,-3241 28110,-3241 28110,-3241 24687.13,-3241 24687.13,-3241"/>
<polygon fill="black" stroke="black" points="24687.13,-3237.5 24677.13,-3241 24687.13,-3244.5 24687.13,-3237.5"/>
</g>
<!-- q_proj_2_0_1 -->
<g id="node108" class="node">
<title>q_proj_2_0_1</title>
<polygon fill="#ffcc99" stroke="black" points="28945,-3811 28811,-3811 28811,-3743 28945,-3743 28945,-3811"/>
<text text-anchor="middle" x="28878" y="-3795.8" font-family="Times,serif" font-size="14.00">Q Projection 0_1</text>
<text text-anchor="middle" x="28878" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="28878" y="-3765.8" font-family="Times,serif" font-size="14.00">W_Q^{0,1}</text>
<text text-anchor="middle" x="28878" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- attention_2_0_1 -->
<g id="node109" class="node">
<title>attention_2_0_1</title>
<polygon fill="#ffcc99" stroke="black" points="28676.5,-3656 28503.5,-3656 28503.5,-3588 28676.5,-3588 28676.5,-3656"/>
<text text-anchor="middle" x="28590" y="-3640.8" font-family="Times,serif" font-size="14.00">Attention 0_1</text>
<text text-anchor="middle" x="28590" y="-3625.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="28590" y="-3610.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="28590" y="-3595.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- q_proj_2_0_1&#45;&gt;attention_2_0_1 -->
<g id="edge118" class="edge">
<title>q_proj_2_0_1&#45;&gt;attention_2_0_1</title>
<path fill="none" stroke="black" d="M28878,-3742.98C28878,-3697.36 28878,-3622 28878,-3622 28878,-3622 28686.8,-3622 28686.8,-3622"/>
<polygon fill="black" stroke="black" points="28686.8,-3618.5 28676.8,-3622 28686.8,-3625.5 28686.8,-3618.5"/>
</g>
<!-- attention_2_0_1&#45;&gt;concat_group_2_0 -->
<g id="edge121" class="edge">
<title>attention_2_0_1&#45;&gt;concat_group_2_0</title>
<path fill="none" stroke="black" d="M28503.11,-3633C28391.87,-3633 28213.33,-3633 28213.33,-3633 28213.33,-3633 28213.33,-3454.42 28213.33,-3454.42"/>
<polygon fill="black" stroke="black" points="28216.83,-3454.42 28213.33,-3444.42 28209.83,-3454.42 28216.83,-3454.42"/>
</g>
<!-- attention_2_0_1&#45;&gt;concat_group_2_0 -->
<g id="edge122" class="edge">
<title>attention_2_0_1&#45;&gt;concat_group_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M28503.3,-3610C28395.12,-3610 28224.17,-3610 28224.17,-3610 28224.17,-3610 28224.17,-3449.86 28224.17,-3449.86"/>
<polygon fill="red" stroke="red" points="28227.67,-3449.86 28224.17,-3439.86 28220.67,-3449.86 28227.67,-3449.86"/>
<text text-anchor="middle" x="28608" y="-3533.8" font-family="Times,serif" font-size="14.00">AllGather GPU0→GPU1</text>
</g>
<!-- k_proj_2_0_1 -->
<g id="node110" class="node">
<title>k_proj_2_0_1</title>
<polygon fill="#ffcc99" stroke="black" points="28753,-3811 28619,-3811 28619,-3743 28753,-3743 28753,-3811"/>
<text text-anchor="middle" x="28686" y="-3795.8" font-family="Times,serif" font-size="14.00">K Projection 0_1</text>
<text text-anchor="middle" x="28686" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="28686" y="-3765.8" font-family="Times,serif" font-size="14.00">W_K^{0,1}</text>
<text text-anchor="middle" x="28686" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- k_proj_2_0_1&#45;&gt;attention_2_0_1 -->
<g id="edge119" class="edge">
<title>k_proj_2_0_1&#45;&gt;attention_2_0_1</title>
<path fill="none" stroke="black" d="M28647.75,-3742.98C28647.75,-3742.98 28647.75,-3666.2 28647.75,-3666.2"/>
<polygon fill="black" stroke="black" points="28651.25,-3666.2 28647.75,-3656.2 28644.25,-3666.2 28651.25,-3666.2"/>
</g>
<!-- v_proj_2_0_1 -->
<g id="node111" class="node">
<title>v_proj_2_0_1</title>
<polygon fill="#ffcc99" stroke="black" points="28560.5,-3811 28427.5,-3811 28427.5,-3743 28560.5,-3743 28560.5,-3811"/>
<text text-anchor="middle" x="28494" y="-3795.8" font-family="Times,serif" font-size="14.00">V Projection 0_1</text>
<text text-anchor="middle" x="28494" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="28494" y="-3765.8" font-family="Times,serif" font-size="14.00">W_V^{0,1}</text>
<text text-anchor="middle" x="28494" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- v_proj_2_0_1&#45;&gt;attention_2_0_1 -->
<g id="edge120" class="edge">
<title>v_proj_2_0_1&#45;&gt;attention_2_0_1</title>
<path fill="none" stroke="black" d="M28532,-3742.98C28532,-3742.98 28532,-3666.2 28532,-3666.2"/>
<polygon fill="black" stroke="black" points="28535.5,-3666.2 28532,-3656.2 28528.5,-3666.2 28535.5,-3666.2"/>
</g>
<!-- q_proj_2_0_2 -->
<g id="node112" class="node">
<title>q_proj_2_0_2</title>
<polygon fill="#ffff99" stroke="black" points="28369,-3811 28235,-3811 28235,-3743 28369,-3743 28369,-3811"/>
<text text-anchor="middle" x="28302" y="-3795.8" font-family="Times,serif" font-size="14.00">Q Projection 0_2</text>
<text text-anchor="middle" x="28302" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="28302" y="-3765.8" font-family="Times,serif" font-size="14.00">W_Q^{0,2}</text>
<text text-anchor="middle" x="28302" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- attention_2_0_2 -->
<g id="node113" class="node">
<title>attention_2_0_2</title>
<polygon fill="#ffff99" stroke="black" points="28196.5,-3656 28023.5,-3656 28023.5,-3588 28196.5,-3588 28196.5,-3656"/>
<text text-anchor="middle" x="28110" y="-3640.8" font-family="Times,serif" font-size="14.00">Attention 0_2</text>
<text text-anchor="middle" x="28110" y="-3625.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="28110" y="-3610.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="28110" y="-3595.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- q_proj_2_0_2&#45;&gt;attention_2_0_2 -->
<g id="edge123" class="edge">
<title>q_proj_2_0_2&#45;&gt;attention_2_0_2</title>
<path fill="none" stroke="black" d="M28234.91,-3777C28211.06,-3777 28190,-3777 28190,-3777 28190,-3777 28190,-3666.02 28190,-3666.02"/>
<polygon fill="black" stroke="black" points="28193.5,-3666.02 28190,-3656.02 28186.5,-3666.02 28193.5,-3666.02"/>
</g>
<!-- attention_2_0_2&#45;&gt;concat_group_2_0 -->
<g id="edge126" class="edge">
<title>attention_2_0_2&#45;&gt;concat_group_2_0</title>
<path fill="none" stroke="black" d="M28081.17,-3587.95C28081.17,-3587.95 28081.17,-3485.34 28081.17,-3485.34"/>
<polygon fill="black" stroke="black" points="28084.67,-3485.34 28081.17,-3475.34 28077.67,-3485.34 28084.67,-3485.34"/>
</g>
<!-- attention_2_0_2&#45;&gt;concat_group_2_0 -->
<g id="edge127" class="edge">
<title>attention_2_0_2&#45;&gt;concat_group_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M28138.83,-3587.95C28138.83,-3587.95 28138.83,-3485.34 28138.83,-3485.34"/>
<polygon fill="red" stroke="red" points="28142.33,-3485.34 28138.83,-3475.34 28135.33,-3485.34 28142.33,-3485.34"/>
<text text-anchor="middle" x="28322" y="-3533.8" font-family="Times,serif" font-size="14.00">AllGather GPU1→GPU2</text>
</g>
<!-- k_proj_2_0_2 -->
<g id="node114" class="node">
<title>k_proj_2_0_2</title>
<polygon fill="#ffff99" stroke="black" points="28177,-3811 28043,-3811 28043,-3743 28177,-3743 28177,-3811"/>
<text text-anchor="middle" x="28110" y="-3795.8" font-family="Times,serif" font-size="14.00">K Projection 0_2</text>
<text text-anchor="middle" x="28110" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="28110" y="-3765.8" font-family="Times,serif" font-size="14.00">W_K^{0,2}</text>
<text text-anchor="middle" x="28110" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- k_proj_2_0_2&#45;&gt;attention_2_0_2 -->
<g id="edge124" class="edge">
<title>k_proj_2_0_2&#45;&gt;attention_2_0_2</title>
<path fill="none" stroke="black" d="M28110,-3742.98C28110,-3742.98 28110,-3666.2 28110,-3666.2"/>
<polygon fill="black" stroke="black" points="28113.5,-3666.2 28110,-3656.2 28106.5,-3666.2 28113.5,-3666.2"/>
</g>
<!-- v_proj_2_0_2 -->
<g id="node115" class="node">
<title>v_proj_2_0_2</title>
<polygon fill="#ffff99" stroke="black" points="27984.5,-3811 27851.5,-3811 27851.5,-3743 27984.5,-3743 27984.5,-3811"/>
<text text-anchor="middle" x="27918" y="-3795.8" font-family="Times,serif" font-size="14.00">V Projection 0_2</text>
<text text-anchor="middle" x="27918" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="27918" y="-3765.8" font-family="Times,serif" font-size="14.00">W_V^{0,2}</text>
<text text-anchor="middle" x="27918" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- v_proj_2_0_2&#45;&gt;attention_2_0_2 -->
<g id="edge125" class="edge">
<title>v_proj_2_0_2&#45;&gt;attention_2_0_2</title>
<path fill="none" stroke="black" d="M27984.71,-3777C28010.19,-3777 28033.25,-3777 28033.25,-3777 28033.25,-3777 28033.25,-3666.02 28033.25,-3666.02"/>
<polygon fill="black" stroke="black" points="28036.75,-3666.02 28033.25,-3656.02 28029.75,-3666.02 28036.75,-3666.02"/>
</g>
<!-- q_proj_2_0_3 -->
<g id="node116" class="node">
<title>q_proj_2_0_3</title>
<polygon fill="#ccff99" stroke="black" points="27793,-3811 27659,-3811 27659,-3743 27793,-3743 27793,-3811"/>
<text text-anchor="middle" x="27726" y="-3795.8" font-family="Times,serif" font-size="14.00">Q Projection 0_3</text>
<text text-anchor="middle" x="27726" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="27726" y="-3765.8" font-family="Times,serif" font-size="14.00">W_Q^{0,3}</text>
<text text-anchor="middle" x="27726" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- attention_2_0_3 -->
<g id="node117" class="node">
<title>attention_2_0_3</title>
<polygon fill="#ccff99" stroke="black" points="27716.5,-3656 27543.5,-3656 27543.5,-3588 27716.5,-3588 27716.5,-3656"/>
<text text-anchor="middle" x="27630" y="-3640.8" font-family="Times,serif" font-size="14.00">Attention 0_3</text>
<text text-anchor="middle" x="27630" y="-3625.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="27630" y="-3610.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="27630" y="-3595.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- q_proj_2_0_3&#45;&gt;attention_2_0_3 -->
<g id="edge128" class="edge">
<title>q_proj_2_0_3&#45;&gt;attention_2_0_3</title>
<path fill="none" stroke="black" d="M27687.75,-3742.98C27687.75,-3742.98 27687.75,-3666.2 27687.75,-3666.2"/>
<polygon fill="black" stroke="black" points="27691.25,-3666.2 27687.75,-3656.2 27684.25,-3666.2 27691.25,-3666.2"/>
</g>
<!-- attention_2_0_3&#45;&gt;concat_group_2_0 -->
<g id="edge131" class="edge">
<title>attention_2_0_3&#45;&gt;concat_group_2_0</title>
<path fill="none" stroke="black" d="M27716.54,-3633C27824.52,-3633 27995.17,-3633 27995.17,-3633 27995.17,-3633 27995.17,-3449.74 27995.17,-3449.74"/>
<polygon fill="black" stroke="black" points="27998.67,-3449.74 27995.17,-3439.74 27991.67,-3449.74 27998.67,-3449.74"/>
</g>
<!-- attention_2_0_3&#45;&gt;concat_group_2_0 -->
<g id="edge132" class="edge">
<title>attention_2_0_3&#45;&gt;concat_group_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M27716.65,-3610C27823.12,-3610 27989.83,-3610 27989.83,-3610 27989.83,-3610 27989.83,-3447.36 27989.83,-3447.36"/>
<polygon fill="red" stroke="red" points="27993.33,-3447.36 27989.83,-3437.36 27986.33,-3447.36 27993.33,-3447.36"/>
<text text-anchor="middle" x="27960" y="-3533.8" font-family="Times,serif" font-size="14.00">AllGather GPU2→GPU3</text>
</g>
<!-- k_proj_2_0_3 -->
<g id="node118" class="node">
<title>k_proj_2_0_3</title>
<polygon fill="#ccff99" stroke="black" points="27601,-3811 27467,-3811 27467,-3743 27601,-3743 27601,-3811"/>
<text text-anchor="middle" x="27534" y="-3795.8" font-family="Times,serif" font-size="14.00">K Projection 0_3</text>
<text text-anchor="middle" x="27534" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="27534" y="-3765.8" font-family="Times,serif" font-size="14.00">W_K^{0,3}</text>
<text text-anchor="middle" x="27534" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- k_proj_2_0_3&#45;&gt;attention_2_0_3 -->
<g id="edge129" class="edge">
<title>k_proj_2_0_3&#45;&gt;attention_2_0_3</title>
<path fill="none" stroke="black" d="M27572.25,-3742.98C27572.25,-3742.98 27572.25,-3666.2 27572.25,-3666.2"/>
<polygon fill="black" stroke="black" points="27575.75,-3666.2 27572.25,-3656.2 27568.75,-3666.2 27575.75,-3666.2"/>
</g>
<!-- v_proj_2_0_3 -->
<g id="node119" class="node">
<title>v_proj_2_0_3</title>
<polygon fill="#ccff99" stroke="black" points="27408.5,-3811 27275.5,-3811 27275.5,-3743 27408.5,-3743 27408.5,-3811"/>
<text text-anchor="middle" x="27342" y="-3795.8" font-family="Times,serif" font-size="14.00">V Projection 0_3</text>
<text text-anchor="middle" x="27342" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="27342" y="-3765.8" font-family="Times,serif" font-size="14.00">W_V^{0,3}</text>
<text text-anchor="middle" x="27342" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- v_proj_2_0_3&#45;&gt;attention_2_0_3 -->
<g id="edge130" class="edge">
<title>v_proj_2_0_3&#45;&gt;attention_2_0_3</title>
<path fill="none" stroke="black" d="M27342,-3742.87C27342,-3700.29 27342,-3633 27342,-3633 27342,-3633 27533.2,-3633 27533.2,-3633"/>
<polygon fill="black" stroke="black" points="27533.2,-3636.5 27543.2,-3633 27533.2,-3629.5 27533.2,-3636.5"/>
</g>
<!-- q_proj_2_1_0 -->
<g id="node120" class="node">
<title>q_proj_2_1_0</title>
<polygon fill="#99ff99" stroke="black" points="27217,-3811 27083,-3811 27083,-3743 27217,-3743 27217,-3811"/>
<text text-anchor="middle" x="27150" y="-3795.8" font-family="Times,serif" font-size="14.00">Q Projection 1_0</text>
<text text-anchor="middle" x="27150" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="27150" y="-3765.8" font-family="Times,serif" font-size="14.00">W_Q^{1,0}</text>
<text text-anchor="middle" x="27150" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- attention_2_1_0 -->
<g id="node121" class="node">
<title>attention_2_1_0</title>
<polygon fill="#99ff99" stroke="black" points="26949.5,-3656 26776.5,-3656 26776.5,-3588 26949.5,-3588 26949.5,-3656"/>
<text text-anchor="middle" x="26863" y="-3640.8" font-family="Times,serif" font-size="14.00">Attention 1_0</text>
<text text-anchor="middle" x="26863" y="-3625.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="26863" y="-3610.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="26863" y="-3595.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- q_proj_2_1_0&#45;&gt;attention_2_1_0 -->
<g id="edge133" class="edge">
<title>q_proj_2_1_0&#45;&gt;attention_2_1_0</title>
<path fill="none" stroke="black" d="M27150,-3742.8C27150,-3693.94 27150,-3610 27150,-3610 27150,-3610 26959.89,-3610 26959.89,-3610"/>
<polygon fill="black" stroke="black" points="26959.89,-3606.5 26949.89,-3610 26959.89,-3613.5 26959.89,-3606.5"/>
</g>
<!-- concat_group_2_1 -->
<g id="node124" class="node">
<title>concat_group_2_1</title>
<polygon fill="#ffd700" stroke="black" points="25806,-3487 25678,-3434 25806,-3381 25934,-3434 25806,-3487"/>
<text text-anchor="middle" x="25806" y="-3445.3" font-family="Times,serif" font-size="14.00">Concat Group 1</text>
<text text-anchor="middle" x="25806" y="-3430.3" font-family="Times,serif" font-size="14.00">[B×L×d×h_g]</text>
<text text-anchor="middle" x="25806" y="-3415.3" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- attention_2_1_0&#45;&gt;concat_group_2_1 -->
<g id="edge136" class="edge">
<title>attention_2_1_0&#45;&gt;concat_group_2_1</title>
<path fill="none" stroke="black" d="M26863,-3587.95C26863,-3533.78 26863,-3434 26863,-3434 26863,-3434 25944.03,-3434 25944.03,-3434"/>
<polygon fill="black" stroke="black" points="25944.03,-3430.5 25934.03,-3434 25944.03,-3437.5 25944.03,-3430.5"/>
</g>
<!-- k_proj_2_1_0 -->
<g id="node122" class="node">
<title>k_proj_2_1_0</title>
<polygon fill="#99ff99" stroke="black" points="27025,-3811 26891,-3811 26891,-3743 27025,-3743 27025,-3811"/>
<text text-anchor="middle" x="26958" y="-3795.8" font-family="Times,serif" font-size="14.00">K Projection 1_0</text>
<text text-anchor="middle" x="26958" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="26958" y="-3765.8" font-family="Times,serif" font-size="14.00">W_K^{1,0}</text>
<text text-anchor="middle" x="26958" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- k_proj_2_1_0&#45;&gt;attention_2_1_0 -->
<g id="edge134" class="edge">
<title>k_proj_2_1_0&#45;&gt;attention_2_1_0</title>
<path fill="none" stroke="black" d="M26920.25,-3742.98C26920.25,-3742.98 26920.25,-3666.2 26920.25,-3666.2"/>
<polygon fill="black" stroke="black" points="26923.75,-3666.2 26920.25,-3656.2 26916.75,-3666.2 26923.75,-3666.2"/>
</g>
<!-- v_proj_2_1_0 -->
<g id="node123" class="node">
<title>v_proj_2_1_0</title>
<polygon fill="#99ff99" stroke="black" points="26832.5,-3811 26699.5,-3811 26699.5,-3743 26832.5,-3743 26832.5,-3811"/>
<text text-anchor="middle" x="26766" y="-3795.8" font-family="Times,serif" font-size="14.00">V Projection 1_0</text>
<text text-anchor="middle" x="26766" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="26766" y="-3765.8" font-family="Times,serif" font-size="14.00">W_V^{1,0}</text>
<text text-anchor="middle" x="26766" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- v_proj_2_1_0&#45;&gt;attention_2_1_0 -->
<g id="edge135" class="edge">
<title>v_proj_2_1_0&#45;&gt;attention_2_1_0</title>
<path fill="none" stroke="black" d="M26804.5,-3742.98C26804.5,-3742.98 26804.5,-3666.2 26804.5,-3666.2"/>
<polygon fill="black" stroke="black" points="26808,-3666.2 26804.5,-3656.2 26801,-3666.2 26808,-3666.2"/>
</g>
<!-- concat_group_2_1&#45;&gt;final_concat_2 -->
<g id="edge192" class="edge">
<title>concat_group_2_1&#45;&gt;final_concat_2</title>
<path fill="none" stroke="black" d="M25718.91,-3451C25449.42,-3451 24647.25,-3451 24647.25,-3451 24647.25,-3451 24647.25,-3260.57 24647.25,-3260.57"/>
<polygon fill="black" stroke="black" points="24650.75,-3260.57 24647.25,-3250.57 24643.75,-3260.57 24650.75,-3260.57"/>
</g>
<!-- q_proj_2_1_1 -->
<g id="node125" class="node">
<title>q_proj_2_1_1</title>
<polygon fill="#99ffcc" stroke="black" points="26641,-3811 26507,-3811 26507,-3743 26641,-3743 26641,-3811"/>
<text text-anchor="middle" x="26574" y="-3795.8" font-family="Times,serif" font-size="14.00">Q Projection 1_1</text>
<text text-anchor="middle" x="26574" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="26574" y="-3765.8" font-family="Times,serif" font-size="14.00">W_Q^{1,1}</text>
<text text-anchor="middle" x="26574" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- attention_2_1_1 -->
<g id="node126" class="node">
<title>attention_2_1_1</title>
<polygon fill="#99ffcc" stroke="black" points="26345.5,-3656 26172.5,-3656 26172.5,-3588 26345.5,-3588 26345.5,-3656"/>
<text text-anchor="middle" x="26259" y="-3640.8" font-family="Times,serif" font-size="14.00">Attention 1_1</text>
<text text-anchor="middle" x="26259" y="-3625.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="26259" y="-3610.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="26259" y="-3595.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- q_proj_2_1_1&#45;&gt;attention_2_1_1 -->
<g id="edge137" class="edge">
<title>q_proj_2_1_1&#45;&gt;attention_2_1_1</title>
<path fill="none" stroke="black" d="M26574,-3742.98C26574,-3697.36 26574,-3622 26574,-3622 26574,-3622 26355.91,-3622 26355.91,-3622"/>
<polygon fill="black" stroke="black" points="26355.91,-3618.5 26345.91,-3622 26355.91,-3625.5 26355.91,-3618.5"/>
</g>
<!-- attention_2_1_1&#45;&gt;concat_group_2_1 -->
<g id="edge140" class="edge">
<title>attention_2_1_1&#45;&gt;concat_group_2_1</title>
<path fill="none" stroke="black" d="M26172.48,-3633C26067.78,-3633 25905.33,-3633 25905.33,-3633 25905.33,-3633 25905.33,-3456.15 25905.33,-3456.15"/>
<polygon fill="black" stroke="black" points="25908.83,-3456.15 25905.33,-3446.15 25901.83,-3456.15 25908.83,-3456.15"/>
</g>
<!-- attention_2_1_1&#45;&gt;concat_group_2_1 -->
<g id="edge141" class="edge">
<title>attention_2_1_1&#45;&gt;concat_group_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26172.11,-3610C26071.13,-3610 25918.17,-3610 25918.17,-3610 25918.17,-3610 25918.17,-3450.68 25918.17,-3450.68"/>
<polygon fill="red" stroke="red" points="25921.67,-3450.68 25918.17,-3440.68 25914.67,-3450.68 25921.67,-3450.68"/>
<text text-anchor="middle" x="26451" y="-3533.8" font-family="Times,serif" font-size="14.00">AllGather GPU4→GPU5</text>
</g>
<!-- k_proj_2_1_1 -->
<g id="node127" class="node">
<title>k_proj_2_1_1</title>
<polygon fill="#99ffcc" stroke="black" points="26449,-3811 26315,-3811 26315,-3743 26449,-3743 26449,-3811"/>
<text text-anchor="middle" x="26382" y="-3795.8" font-family="Times,serif" font-size="14.00">K Projection 1_1</text>
<text text-anchor="middle" x="26382" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="26382" y="-3765.8" font-family="Times,serif" font-size="14.00">W_K^{1,1}</text>
<text text-anchor="middle" x="26382" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- k_proj_2_1_1&#45;&gt;attention_2_1_1 -->
<g id="edge138" class="edge">
<title>k_proj_2_1_1&#45;&gt;attention_2_1_1</title>
<path fill="none" stroke="black" d="M26330.25,-3742.98C26330.25,-3742.98 26330.25,-3666.2 26330.25,-3666.2"/>
<polygon fill="black" stroke="black" points="26333.75,-3666.2 26330.25,-3656.2 26326.75,-3666.2 26333.75,-3666.2"/>
</g>
<!-- v_proj_2_1_1 -->
<g id="node128" class="node">
<title>v_proj_2_1_1</title>
<polygon fill="#99ffcc" stroke="black" points="26256.5,-3811 26123.5,-3811 26123.5,-3743 26256.5,-3743 26256.5,-3811"/>
<text text-anchor="middle" x="26190" y="-3795.8" font-family="Times,serif" font-size="14.00">V Projection 1_1</text>
<text text-anchor="middle" x="26190" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="26190" y="-3765.8" font-family="Times,serif" font-size="14.00">W_V^{1,1}</text>
<text text-anchor="middle" x="26190" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- v_proj_2_1_1&#45;&gt;attention_2_1_1 -->
<g id="edge139" class="edge">
<title>v_proj_2_1_1&#45;&gt;attention_2_1_1</title>
<path fill="none" stroke="black" d="M26214.5,-3742.98C26214.5,-3742.98 26214.5,-3666.2 26214.5,-3666.2"/>
<polygon fill="black" stroke="black" points="26218,-3666.2 26214.5,-3656.2 26211,-3666.2 26218,-3666.2"/>
</g>
<!-- q_proj_2_1_2 -->
<g id="node129" class="node">
<title>q_proj_2_1_2</title>
<polygon fill="#99ffff" stroke="black" points="26065,-3811 25931,-3811 25931,-3743 26065,-3743 26065,-3811"/>
<text text-anchor="middle" x="25998" y="-3795.8" font-family="Times,serif" font-size="14.00">Q Projection 1_2</text>
<text text-anchor="middle" x="25998" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="25998" y="-3765.8" font-family="Times,serif" font-size="14.00">W_Q^{1,2}</text>
<text text-anchor="middle" x="25998" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- attention_2_1_2 -->
<g id="node130" class="node">
<title>attention_2_1_2</title>
<polygon fill="#99ffff" stroke="black" points="25892.5,-3656 25719.5,-3656 25719.5,-3588 25892.5,-3588 25892.5,-3656"/>
<text text-anchor="middle" x="25806" y="-3640.8" font-family="Times,serif" font-size="14.00">Attention 1_2</text>
<text text-anchor="middle" x="25806" y="-3625.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="25806" y="-3610.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="25806" y="-3595.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- q_proj_2_1_2&#45;&gt;attention_2_1_2 -->
<g id="edge142" class="edge">
<title>q_proj_2_1_2&#45;&gt;attention_2_1_2</title>
<path fill="none" stroke="black" d="M25930.96,-3777C25905.6,-3777 25882.75,-3777 25882.75,-3777 25882.75,-3777 25882.75,-3666.02 25882.75,-3666.02"/>
<polygon fill="black" stroke="black" points="25886.25,-3666.02 25882.75,-3656.02 25879.25,-3666.02 25886.25,-3666.02"/>
</g>
<!-- attention_2_1_2&#45;&gt;concat_group_2_1 -->
<g id="edge145" class="edge">
<title>attention_2_1_2&#45;&gt;concat_group_2_1</title>
<path fill="none" stroke="black" d="M25777.17,-3587.95C25777.17,-3587.95 25777.17,-3485.34 25777.17,-3485.34"/>
<polygon fill="black" stroke="black" points="25780.67,-3485.34 25777.17,-3475.34 25773.67,-3485.34 25780.67,-3485.34"/>
</g>
<!-- attention_2_1_2&#45;&gt;concat_group_2_1 -->
<g id="edge146" class="edge">
<title>attention_2_1_2&#45;&gt;concat_group_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25834.83,-3587.95C25834.83,-3587.95 25834.83,-3485.34 25834.83,-3485.34"/>
<polygon fill="red" stroke="red" points="25838.33,-3485.34 25834.83,-3475.34 25831.33,-3485.34 25838.33,-3485.34"/>
<text text-anchor="middle" x="25985" y="-3533.8" font-family="Times,serif" font-size="14.00">AllGather GPU5→GPU6</text>
</g>
<!-- k_proj_2_1_2 -->
<g id="node131" class="node">
<title>k_proj_2_1_2</title>
<polygon fill="#99ffff" stroke="black" points="25873,-3811 25739,-3811 25739,-3743 25873,-3743 25873,-3811"/>
<text text-anchor="middle" x="25806" y="-3795.8" font-family="Times,serif" font-size="14.00">K Projection 1_2</text>
<text text-anchor="middle" x="25806" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="25806" y="-3765.8" font-family="Times,serif" font-size="14.00">W_K^{1,2}</text>
<text text-anchor="middle" x="25806" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- k_proj_2_1_2&#45;&gt;attention_2_1_2 -->
<g id="edge143" class="edge">
<title>k_proj_2_1_2&#45;&gt;attention_2_1_2</title>
<path fill="none" stroke="black" d="M25806,-3742.98C25806,-3742.98 25806,-3666.2 25806,-3666.2"/>
<polygon fill="black" stroke="black" points="25809.5,-3666.2 25806,-3656.2 25802.5,-3666.2 25809.5,-3666.2"/>
</g>
<!-- v_proj_2_1_2 -->
<g id="node132" class="node">
<title>v_proj_2_1_2</title>
<polygon fill="#99ffff" stroke="black" points="25680.5,-3811 25547.5,-3811 25547.5,-3743 25680.5,-3743 25680.5,-3811"/>
<text text-anchor="middle" x="25614" y="-3795.8" font-family="Times,serif" font-size="14.00">V Projection 1_2</text>
<text text-anchor="middle" x="25614" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="25614" y="-3765.8" font-family="Times,serif" font-size="14.00">W_V^{1,2}</text>
<text text-anchor="middle" x="25614" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- v_proj_2_1_2&#45;&gt;attention_2_1_2 -->
<g id="edge144" class="edge">
<title>v_proj_2_1_2&#45;&gt;attention_2_1_2</title>
<path fill="none" stroke="black" d="M25680.71,-3777C25706.19,-3777 25729.25,-3777 25729.25,-3777 25729.25,-3777 25729.25,-3666.02 25729.25,-3666.02"/>
<polygon fill="black" stroke="black" points="25732.75,-3666.02 25729.25,-3656.02 25725.75,-3666.02 25732.75,-3666.02"/>
</g>
<!-- q_proj_2_1_3 -->
<g id="node133" class="node">
<title>q_proj_2_1_3</title>
<polygon fill="#99ccff" stroke="black" points="25489,-3811 25355,-3811 25355,-3743 25489,-3743 25489,-3811"/>
<text text-anchor="middle" x="25422" y="-3795.8" font-family="Times,serif" font-size="14.00">Q Projection 1_3</text>
<text text-anchor="middle" x="25422" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="25422" y="-3765.8" font-family="Times,serif" font-size="14.00">W_Q^{1,3}</text>
<text text-anchor="middle" x="25422" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- attention_2_1_3 -->
<g id="node134" class="node">
<title>attention_2_1_3</title>
<polygon fill="#99ccff" stroke="black" points="25364.5,-3656 25191.5,-3656 25191.5,-3588 25364.5,-3588 25364.5,-3656"/>
<text text-anchor="middle" x="25278" y="-3640.8" font-family="Times,serif" font-size="14.00">Attention 1_3</text>
<text text-anchor="middle" x="25278" y="-3625.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="25278" y="-3610.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="25278" y="-3595.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- q_proj_2_1_3&#45;&gt;attention_2_1_3 -->
<g id="edge147" class="edge">
<title>q_proj_2_1_3&#45;&gt;attention_2_1_3</title>
<path fill="none" stroke="black" d="M25359.75,-3742.98C25359.75,-3742.98 25359.75,-3666.2 25359.75,-3666.2"/>
<polygon fill="black" stroke="black" points="25363.25,-3666.2 25359.75,-3656.2 25356.25,-3666.2 25363.25,-3666.2"/>
</g>
<!-- attention_2_1_3&#45;&gt;concat_group_2_1 -->
<g id="edge150" class="edge">
<title>attention_2_1_3&#45;&gt;concat_group_2_1</title>
<path fill="none" stroke="black" d="M25364.71,-3633C25489.92,-3633 25706.5,-3633 25706.5,-3633 25706.5,-3633 25706.5,-3455.85 25706.5,-3455.85"/>
<polygon fill="black" stroke="black" points="25710,-3455.85 25706.5,-3445.85 25703,-3455.85 25710,-3455.85"/>
</g>
<!-- attention_2_1_3&#45;&gt;concat_group_2_1 -->
<g id="edge151" class="edge">
<title>attention_2_1_3&#45;&gt;concat_group_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25364.6,-3610C25486.37,-3610 25693.5,-3610 25693.5,-3610 25693.5,-3610 25693.5,-3450.68 25693.5,-3450.68"/>
<polygon fill="red" stroke="red" points="25697,-3450.68 25693.5,-3440.68 25690,-3450.68 25697,-3450.68"/>
<text text-anchor="middle" x="25644" y="-3533.8" font-family="Times,serif" font-size="14.00">AllGather GPU6→GPU7</text>
</g>
<!-- k_proj_2_1_3 -->
<g id="node135" class="node">
<title>k_proj_2_1_3</title>
<polygon fill="#99ccff" stroke="black" points="25297,-3811 25163,-3811 25163,-3743 25297,-3743 25297,-3811"/>
<text text-anchor="middle" x="25230" y="-3795.8" font-family="Times,serif" font-size="14.00">K Projection 1_3</text>
<text text-anchor="middle" x="25230" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="25230" y="-3765.8" font-family="Times,serif" font-size="14.00">W_K^{1,3}</text>
<text text-anchor="middle" x="25230" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- k_proj_2_1_3&#45;&gt;attention_2_1_3 -->
<g id="edge148" class="edge">
<title>k_proj_2_1_3&#45;&gt;attention_2_1_3</title>
<path fill="none" stroke="black" d="M25244.25,-3742.98C25244.25,-3742.98 25244.25,-3666.2 25244.25,-3666.2"/>
<polygon fill="black" stroke="black" points="25247.75,-3666.2 25244.25,-3656.2 25240.75,-3666.2 25247.75,-3666.2"/>
</g>
<!-- v_proj_2_1_3 -->
<g id="node136" class="node">
<title>v_proj_2_1_3</title>
<polygon fill="#99ccff" stroke="black" points="25104.5,-3811 24971.5,-3811 24971.5,-3743 25104.5,-3743 25104.5,-3811"/>
<text text-anchor="middle" x="25038" y="-3795.8" font-family="Times,serif" font-size="14.00">V Projection 1_3</text>
<text text-anchor="middle" x="25038" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="25038" y="-3765.8" font-family="Times,serif" font-size="14.00">W_V^{1,3}</text>
<text text-anchor="middle" x="25038" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- v_proj_2_1_3&#45;&gt;attention_2_1_3 -->
<g id="edge149" class="edge">
<title>v_proj_2_1_3&#45;&gt;attention_2_1_3</title>
<path fill="none" stroke="black" d="M25038,-3742.8C25038,-3693.94 25038,-3610 25038,-3610 25038,-3610 25181.35,-3610 25181.35,-3610"/>
<polygon fill="black" stroke="black" points="25181.35,-3613.5 25191.35,-3610 25181.35,-3606.5 25181.35,-3613.5"/>
</g>
<!-- q_proj_2_2_0 -->
<g id="node137" class="node">
<title>q_proj_2_2_0</title>
<polygon fill="#9999ff" stroke="black" points="24913,-3811 24779,-3811 24779,-3743 24913,-3743 24913,-3811"/>
<text text-anchor="middle" x="24846" y="-3795.8" font-family="Times,serif" font-size="14.00">Q Projection 2_0</text>
<text text-anchor="middle" x="24846" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="24846" y="-3765.8" font-family="Times,serif" font-size="14.00">W_Q^{2,0}</text>
<text text-anchor="middle" x="24846" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- attention_2_2_0 -->
<g id="node138" class="node">
<title>attention_2_2_0</title>
<polygon fill="#9999ff" stroke="black" points="24617.5,-3656 24444.5,-3656 24444.5,-3588 24617.5,-3588 24617.5,-3656"/>
<text text-anchor="middle" x="24531" y="-3640.8" font-family="Times,serif" font-size="14.00">Attention 2_0</text>
<text text-anchor="middle" x="24531" y="-3625.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="24531" y="-3610.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="24531" y="-3595.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- q_proj_2_2_0&#45;&gt;attention_2_2_0 -->
<g id="edge152" class="edge">
<title>q_proj_2_2_0&#45;&gt;attention_2_2_0</title>
<path fill="none" stroke="black" d="M24846,-3742.87C24846,-3700.29 24846,-3633 24846,-3633 24846,-3633 24627.91,-3633 24627.91,-3633"/>
<polygon fill="black" stroke="black" points="24627.91,-3629.5 24617.91,-3633 24627.91,-3636.5 24627.91,-3629.5"/>
</g>
<!-- concat_group_2_2 -->
<g id="node141" class="node">
<title>concat_group_2_2</title>
<polygon fill="#ffd700" stroke="black" points="24078,-3487 23950,-3434 24078,-3381 24206,-3434 24078,-3487"/>
<text text-anchor="middle" x="24078" y="-3445.3" font-family="Times,serif" font-size="14.00">Concat Group 2</text>
<text text-anchor="middle" x="24078" y="-3430.3" font-family="Times,serif" font-size="14.00">[B×L×d×h_g]</text>
<text text-anchor="middle" x="24078" y="-3415.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;11</text>
</g>
<!-- attention_2_2_0&#45;&gt;concat_group_2_2 -->
<g id="edge155" class="edge">
<title>attention_2_2_0&#45;&gt;concat_group_2_2</title>
<path fill="none" stroke="black" d="M24444.27,-3610C24341.42,-3610 24183.75,-3610 24183.75,-3610 24183.75,-3610 24183.75,-3453.46 24183.75,-3453.46"/>
<polygon fill="black" stroke="black" points="24187.25,-3453.46 24183.75,-3443.46 24180.25,-3453.46 24187.25,-3453.46"/>
</g>
<!-- k_proj_2_2_0 -->
<g id="node139" class="node">
<title>k_proj_2_2_0</title>
<polygon fill="#9999ff" stroke="black" points="24721,-3811 24587,-3811 24587,-3743 24721,-3743 24721,-3811"/>
<text text-anchor="middle" x="24654" y="-3795.8" font-family="Times,serif" font-size="14.00">K Projection 2_0</text>
<text text-anchor="middle" x="24654" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="24654" y="-3765.8" font-family="Times,serif" font-size="14.00">W_K^{2,0}</text>
<text text-anchor="middle" x="24654" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- k_proj_2_2_0&#45;&gt;attention_2_2_0 -->
<g id="edge153" class="edge">
<title>k_proj_2_2_0&#45;&gt;attention_2_2_0</title>
<path fill="none" stroke="black" d="M24602.25,-3742.98C24602.25,-3742.98 24602.25,-3666.2 24602.25,-3666.2"/>
<polygon fill="black" stroke="black" points="24605.75,-3666.2 24602.25,-3656.2 24598.75,-3666.2 24605.75,-3666.2"/>
</g>
<!-- v_proj_2_2_0 -->
<g id="node140" class="node">
<title>v_proj_2_2_0</title>
<polygon fill="#9999ff" stroke="black" points="24528.5,-3811 24395.5,-3811 24395.5,-3743 24528.5,-3743 24528.5,-3811"/>
<text text-anchor="middle" x="24462" y="-3795.8" font-family="Times,serif" font-size="14.00">V Projection 2_0</text>
<text text-anchor="middle" x="24462" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="24462" y="-3765.8" font-family="Times,serif" font-size="14.00">W_V^{2,0}</text>
<text text-anchor="middle" x="24462" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- v_proj_2_2_0&#45;&gt;attention_2_2_0 -->
<g id="edge154" class="edge">
<title>v_proj_2_2_0&#45;&gt;attention_2_2_0</title>
<path fill="none" stroke="black" d="M24486.5,-3742.98C24486.5,-3742.98 24486.5,-3666.2 24486.5,-3666.2"/>
<polygon fill="black" stroke="black" points="24490,-3666.2 24486.5,-3656.2 24483,-3666.2 24490,-3666.2"/>
</g>
<!-- concat_group_2_2&#45;&gt;final_concat_2 -->
<g id="edge193" class="edge">
<title>concat_group_2_2&#45;&gt;final_concat_2</title>
<path fill="none" stroke="black" d="M24162.82,-3416C24249.43,-3416 24371.25,-3416 24371.25,-3416 24371.25,-3416 24371.25,-3258.97 24371.25,-3258.97"/>
<polygon fill="black" stroke="black" points="24374.75,-3258.97 24371.25,-3248.97 24367.75,-3258.97 24374.75,-3258.97"/>
</g>
<!-- q_proj_2_2_1 -->
<g id="node142" class="node">
<title>q_proj_2_2_1</title>
<polygon fill="#cc99ff" stroke="black" points="24337,-3811 24203,-3811 24203,-3743 24337,-3743 24337,-3811"/>
<text text-anchor="middle" x="24270" y="-3795.8" font-family="Times,serif" font-size="14.00">Q Projection 2_1</text>
<text text-anchor="middle" x="24270" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="24270" y="-3765.8" font-family="Times,serif" font-size="14.00">W_Q^{2,1}</text>
<text text-anchor="middle" x="24270" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- attention_2_2_1 -->
<g id="node143" class="node">
<title>attention_2_2_1</title>
<polygon fill="#cc99ff" stroke="black" points="24164.5,-3656 23991.5,-3656 23991.5,-3588 24164.5,-3588 24164.5,-3656"/>
<text text-anchor="middle" x="24078" y="-3640.8" font-family="Times,serif" font-size="14.00">Attention 2_1</text>
<text text-anchor="middle" x="24078" y="-3625.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="24078" y="-3610.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="24078" y="-3595.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- q_proj_2_2_1&#45;&gt;attention_2_2_1 -->
<g id="edge156" class="edge">
<title>q_proj_2_2_1&#45;&gt;attention_2_2_1</title>
<path fill="none" stroke="black" d="M24212.5,-3742.87C24212.5,-3700.29 24212.5,-3633 24212.5,-3633 24212.5,-3633 24174.7,-3633 24174.7,-3633"/>
<polygon fill="black" stroke="black" points="24174.7,-3629.5 24164.7,-3633 24174.7,-3636.5 24174.7,-3629.5"/>
</g>
<!-- attention_2_2_1&#45;&gt;concat_group_2_2 -->
<g id="edge159" class="edge">
<title>attention_2_2_1&#45;&gt;concat_group_2_2</title>
<path fill="none" stroke="black" d="M24049.17,-3587.95C24049.17,-3587.95 24049.17,-3485.34 24049.17,-3485.34"/>
<polygon fill="black" stroke="black" points="24052.67,-3485.34 24049.17,-3475.34 24045.67,-3485.34 24052.67,-3485.34"/>
</g>
<!-- attention_2_2_1&#45;&gt;concat_group_2_2 -->
<g id="edge160" class="edge">
<title>attention_2_2_1&#45;&gt;concat_group_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24106.83,-3587.95C24106.83,-3587.95 24106.83,-3485.34 24106.83,-3485.34"/>
<polygon fill="red" stroke="red" points="24110.33,-3485.34 24106.83,-3475.34 24103.33,-3485.34 24110.33,-3485.34"/>
<text text-anchor="middle" x="24349" y="-3533.8" font-family="Times,serif" font-size="14.00">AllGather GPU8→GPU9</text>
</g>
<!-- k_proj_2_2_1 -->
<g id="node144" class="node">
<title>k_proj_2_2_1</title>
<polygon fill="#cc99ff" stroke="black" points="24145,-3811 24011,-3811 24011,-3743 24145,-3743 24145,-3811"/>
<text text-anchor="middle" x="24078" y="-3795.8" font-family="Times,serif" font-size="14.00">K Projection 2_1</text>
<text text-anchor="middle" x="24078" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="24078" y="-3765.8" font-family="Times,serif" font-size="14.00">W_K^{2,1}</text>
<text text-anchor="middle" x="24078" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- k_proj_2_2_1&#45;&gt;attention_2_2_1 -->
<g id="edge157" class="edge">
<title>k_proj_2_2_1&#45;&gt;attention_2_2_1</title>
<path fill="none" stroke="black" d="M24078,-3742.98C24078,-3742.98 24078,-3666.2 24078,-3666.2"/>
<polygon fill="black" stroke="black" points="24081.5,-3666.2 24078,-3656.2 24074.5,-3666.2 24081.5,-3666.2"/>
</g>
<!-- v_proj_2_2_1 -->
<g id="node145" class="node">
<title>v_proj_2_2_1</title>
<polygon fill="#cc99ff" stroke="black" points="23952.5,-3811 23819.5,-3811 23819.5,-3743 23952.5,-3743 23952.5,-3811"/>
<text text-anchor="middle" x="23886" y="-3795.8" font-family="Times,serif" font-size="14.00">V Projection 2_1</text>
<text text-anchor="middle" x="23886" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="23886" y="-3765.8" font-family="Times,serif" font-size="14.00">W_V^{2,1}</text>
<text text-anchor="middle" x="23886" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- v_proj_2_2_1&#45;&gt;attention_2_2_1 -->
<g id="edge158" class="edge">
<title>v_proj_2_2_1&#45;&gt;attention_2_2_1</title>
<path fill="none" stroke="black" d="M23942.5,-3742.89C23942.5,-3702.02 23942.5,-3639 23942.5,-3639 23942.5,-3639 23981.42,-3639 23981.42,-3639"/>
<polygon fill="black" stroke="black" points="23981.42,-3642.5 23991.42,-3639 23981.42,-3635.5 23981.42,-3642.5"/>
</g>
<!-- q_proj_2_2_2 -->
<g id="node146" class="node">
<title>q_proj_2_2_2</title>
<polygon fill="#ff99ff" stroke="black" points="23761,-3811 23627,-3811 23627,-3743 23761,-3743 23761,-3811"/>
<text text-anchor="middle" x="23694" y="-3795.8" font-family="Times,serif" font-size="14.00">Q Projection 2_2</text>
<text text-anchor="middle" x="23694" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="23694" y="-3765.8" font-family="Times,serif" font-size="14.00">W_Q^{2,2}</text>
<text text-anchor="middle" x="23694" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- attention_2_2_2 -->
<g id="node147" class="node">
<title>attention_2_2_2</title>
<polygon fill="#ff99ff" stroke="black" points="23685.5,-3656 23512.5,-3656 23512.5,-3588 23685.5,-3588 23685.5,-3656"/>
<text text-anchor="middle" x="23599" y="-3640.8" font-family="Times,serif" font-size="14.00">Attention 2_2</text>
<text text-anchor="middle" x="23599" y="-3625.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="23599" y="-3610.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="23599" y="-3595.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- q_proj_2_2_2&#45;&gt;attention_2_2_2 -->
<g id="edge161" class="edge">
<title>q_proj_2_2_2&#45;&gt;attention_2_2_2</title>
<path fill="none" stroke="black" d="M23656.25,-3742.98C23656.25,-3742.98 23656.25,-3666.2 23656.25,-3666.2"/>
<polygon fill="black" stroke="black" points="23659.75,-3666.2 23656.25,-3656.2 23652.75,-3666.2 23659.75,-3666.2"/>
</g>
<!-- attention_2_2_2&#45;&gt;concat_group_2_2 -->
<g id="edge164" class="edge">
<title>attention_2_2_2&#45;&gt;concat_group_2_2</title>
<path fill="none" stroke="black" d="M23685.59,-3622C23797.59,-3622 23978.5,-3622 23978.5,-3622 23978.5,-3622 23978.5,-3456.05 23978.5,-3456.05"/>
<polygon fill="black" stroke="black" points="23982,-3456.05 23978.5,-3446.05 23975,-3456.05 23982,-3456.05"/>
</g>
<!-- attention_2_2_2&#45;&gt;concat_group_2_2 -->
<g id="edge165" class="edge">
<title>attention_2_2_2&#45;&gt;concat_group_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23685.86,-3605C23794.23,-3605 23965.5,-3605 23965.5,-3605 23965.5,-3605 23965.5,-3450.49 23965.5,-3450.49"/>
<polygon fill="red" stroke="red" points="23969,-3450.49 23965.5,-3440.49 23962,-3450.49 23969,-3450.49"/>
<text text-anchor="middle" x="23915.5" y="-3533.8" font-family="Times,serif" font-size="14.00">AllGather GPU9→GPU10</text>
</g>
<!-- k_proj_2_2_2 -->
<g id="node148" class="node">
<title>k_proj_2_2_2</title>
<polygon fill="#ff99ff" stroke="black" points="23569,-3811 23435,-3811 23435,-3743 23569,-3743 23569,-3811"/>
<text text-anchor="middle" x="23502" y="-3795.8" font-family="Times,serif" font-size="14.00">K Projection 2_2</text>
<text text-anchor="middle" x="23502" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="23502" y="-3765.8" font-family="Times,serif" font-size="14.00">W_K^{2,2}</text>
<text text-anchor="middle" x="23502" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- k_proj_2_2_2&#45;&gt;attention_2_2_2 -->
<g id="edge162" class="edge">
<title>k_proj_2_2_2&#45;&gt;attention_2_2_2</title>
<path fill="none" stroke="black" d="M23540.75,-3742.98C23540.75,-3742.98 23540.75,-3666.2 23540.75,-3666.2"/>
<polygon fill="black" stroke="black" points="23544.25,-3666.2 23540.75,-3656.2 23537.25,-3666.2 23544.25,-3666.2"/>
</g>
<!-- v_proj_2_2_2 -->
<g id="node149" class="node">
<title>v_proj_2_2_2</title>
<polygon fill="#ff99ff" stroke="black" points="23376.5,-3811 23243.5,-3811 23243.5,-3743 23376.5,-3743 23376.5,-3811"/>
<text text-anchor="middle" x="23310" y="-3795.8" font-family="Times,serif" font-size="14.00">V Projection 2_2</text>
<text text-anchor="middle" x="23310" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="23310" y="-3765.8" font-family="Times,serif" font-size="14.00">W_V^{2,2}</text>
<text text-anchor="middle" x="23310" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- v_proj_2_2_2&#45;&gt;attention_2_2_2 -->
<g id="edge163" class="edge">
<title>v_proj_2_2_2&#45;&gt;attention_2_2_2</title>
<path fill="none" stroke="black" d="M23364.25,-3742.98C23364.25,-3697.36 23364.25,-3622 23364.25,-3622 23364.25,-3622 23502.25,-3622 23502.25,-3622"/>
<polygon fill="black" stroke="black" points="23502.25,-3625.5 23512.25,-3622 23502.25,-3618.5 23502.25,-3625.5"/>
</g>
<!-- q_proj_2_2_3 -->
<g id="node150" class="node">
<title>q_proj_2_2_3</title>
<polygon fill="#ff99cc" stroke="black" points="23185,-3811 23051,-3811 23051,-3743 23185,-3743 23185,-3811"/>
<text text-anchor="middle" x="23118" y="-3795.8" font-family="Times,serif" font-size="14.00">Q Projection 2_3</text>
<text text-anchor="middle" x="23118" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="23118" y="-3765.8" font-family="Times,serif" font-size="14.00">W_Q^{2,3}</text>
<text text-anchor="middle" x="23118" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- attention_2_2_3 -->
<g id="node151" class="node">
<title>attention_2_2_3</title>
<polygon fill="#ff99cc" stroke="black" points="23099.5,-3656 22926.5,-3656 22926.5,-3588 23099.5,-3588 23099.5,-3656"/>
<text text-anchor="middle" x="23013" y="-3640.8" font-family="Times,serif" font-size="14.00">Attention 2_3</text>
<text text-anchor="middle" x="23013" y="-3625.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="23013" y="-3610.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="23013" y="-3595.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- q_proj_2_2_3&#45;&gt;attention_2_2_3 -->
<g id="edge166" class="edge">
<title>q_proj_2_2_3&#45;&gt;attention_2_2_3</title>
<path fill="none" stroke="black" d="M23075.25,-3742.98C23075.25,-3742.98 23075.25,-3666.2 23075.25,-3666.2"/>
<polygon fill="black" stroke="black" points="23078.75,-3666.2 23075.25,-3656.2 23071.75,-3666.2 23078.75,-3666.2"/>
</g>
<!-- attention_2_2_3&#45;&gt;concat_group_2_2 -->
<g id="edge169" class="edge">
<title>attention_2_2_3&#45;&gt;concat_group_2_2</title>
<path fill="none" stroke="black" d="M23088,-3587.81C23088,-3537.9 23088,-3451 23088,-3451 23088,-3451 23981.01,-3451 23981.01,-3451"/>
<polygon fill="black" stroke="black" points="23981.01,-3454.5 23991.01,-3451 23981.01,-3447.5 23981.01,-3454.5"/>
</g>
<!-- attention_2_2_3&#45;&gt;concat_group_2_2 -->
<g id="edge170" class="edge">
<title>attention_2_2_3&#45;&gt;concat_group_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23076.5,-3587.98C23076.5,-3529.47 23076.5,-3416 23076.5,-3416 23076.5,-3416 23983.04,-3416 23983.04,-3416"/>
<polygon fill="red" stroke="red" points="23983.04,-3419.5 23993.04,-3416 23983.04,-3412.5 23983.04,-3419.5"/>
<text text-anchor="middle" x="23328" y="-3533.8" font-family="Times,serif" font-size="14.00">AllGather GPU10→GPU11</text>
</g>
<!-- k_proj_2_2_3 -->
<g id="node152" class="node">
<title>k_proj_2_2_3</title>
<polygon fill="#ff99cc" stroke="black" points="22993,-3811 22859,-3811 22859,-3743 22993,-3743 22993,-3811"/>
<text text-anchor="middle" x="22926" y="-3795.8" font-family="Times,serif" font-size="14.00">K Projection 2_3</text>
<text text-anchor="middle" x="22926" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="22926" y="-3765.8" font-family="Times,serif" font-size="14.00">W_K^{2,3}</text>
<text text-anchor="middle" x="22926" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- k_proj_2_2_3&#45;&gt;attention_2_2_3 -->
<g id="edge167" class="edge">
<title>k_proj_2_2_3&#45;&gt;attention_2_2_3</title>
<path fill="none" stroke="black" d="M22959.75,-3742.98C22959.75,-3742.98 22959.75,-3666.2 22959.75,-3666.2"/>
<polygon fill="black" stroke="black" points="22963.25,-3666.2 22959.75,-3656.2 22956.25,-3666.2 22963.25,-3666.2"/>
</g>
<!-- v_proj_2_2_3 -->
<g id="node153" class="node">
<title>v_proj_2_2_3</title>
<polygon fill="#ff99cc" stroke="black" points="22800.5,-3811 22667.5,-3811 22667.5,-3743 22800.5,-3743 22800.5,-3811"/>
<text text-anchor="middle" x="22734" y="-3795.8" font-family="Times,serif" font-size="14.00">V Projection 2_3</text>
<text text-anchor="middle" x="22734" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="22734" y="-3765.8" font-family="Times,serif" font-size="14.00">W_V^{2,3}</text>
<text text-anchor="middle" x="22734" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- v_proj_2_2_3&#45;&gt;attention_2_2_3 -->
<g id="edge168" class="edge">
<title>v_proj_2_2_3&#45;&gt;attention_2_2_3</title>
<path fill="none" stroke="black" d="M22754,-3742.8C22754,-3693.94 22754,-3610 22754,-3610 22754,-3610 22916.4,-3610 22916.4,-3610"/>
<polygon fill="black" stroke="black" points="22916.4,-3613.5 22926.4,-3610 22916.4,-3606.5 22916.4,-3613.5"/>
</g>
<!-- q_proj_2_3_0 -->
<g id="node154" class="node">
<title>q_proj_2_3_0</title>
<polygon fill="#ffb366" stroke="black" points="22609,-3811 22475,-3811 22475,-3743 22609,-3743 22609,-3811"/>
<text text-anchor="middle" x="22542" y="-3795.8" font-family="Times,serif" font-size="14.00">Q Projection 3_0</text>
<text text-anchor="middle" x="22542" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="22542" y="-3765.8" font-family="Times,serif" font-size="14.00">W_Q^{3,0}</text>
<text text-anchor="middle" x="22542" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- attention_2_3_0 -->
<g id="node155" class="node">
<title>attention_2_3_0</title>
<polygon fill="#ffb366" stroke="black" points="22316.5,-3656 22143.5,-3656 22143.5,-3588 22316.5,-3588 22316.5,-3656"/>
<text text-anchor="middle" x="22230" y="-3640.8" font-family="Times,serif" font-size="14.00">Attention 3_0</text>
<text text-anchor="middle" x="22230" y="-3625.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="22230" y="-3610.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="22230" y="-3595.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- q_proj_2_3_0&#45;&gt;attention_2_3_0 -->
<g id="edge171" class="edge">
<title>q_proj_2_3_0&#45;&gt;attention_2_3_0</title>
<path fill="none" stroke="black" d="M22498.25,-3742.87C22498.25,-3700.29 22498.25,-3633 22498.25,-3633 22498.25,-3633 22326.72,-3633 22326.72,-3633"/>
<polygon fill="black" stroke="black" points="22326.72,-3629.5 22316.72,-3633 22326.72,-3636.5 22326.72,-3629.5"/>
</g>
<!-- concat_group_2_3 -->
<g id="node158" class="node">
<title>concat_group_2_3</title>
<polygon fill="#ffd700" stroke="black" points="21774,-3487 21646,-3434 21774,-3381 21902,-3434 21774,-3487"/>
<text text-anchor="middle" x="21774" y="-3445.3" font-family="Times,serif" font-size="14.00">Concat Group 3</text>
<text text-anchor="middle" x="21774" y="-3430.3" font-family="Times,serif" font-size="14.00">[B×L×d×h_g]</text>
<text text-anchor="middle" x="21774" y="-3415.3" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- attention_2_3_0&#45;&gt;concat_group_2_3 -->
<g id="edge174" class="edge">
<title>attention_2_3_0&#45;&gt;concat_group_2_3</title>
<path fill="none" stroke="black" d="M22143.42,-3610C22039.7,-3610 21879.75,-3610 21879.75,-3610 21879.75,-3610 21879.75,-3453.46 21879.75,-3453.46"/>
<polygon fill="black" stroke="black" points="21883.25,-3453.46 21879.75,-3443.46 21876.25,-3453.46 21883.25,-3453.46"/>
</g>
<!-- k_proj_2_3_0 -->
<g id="node156" class="node">
<title>k_proj_2_3_0</title>
<polygon fill="#ffb366" stroke="black" points="22417,-3811 22283,-3811 22283,-3743 22417,-3743 22417,-3811"/>
<text text-anchor="middle" x="22350" y="-3795.8" font-family="Times,serif" font-size="14.00">K Projection 3_0</text>
<text text-anchor="middle" x="22350" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="22350" y="-3765.8" font-family="Times,serif" font-size="14.00">W_K^{3,0}</text>
<text text-anchor="middle" x="22350" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- k_proj_2_3_0&#45;&gt;attention_2_3_0 -->
<g id="edge172" class="edge">
<title>k_proj_2_3_0&#45;&gt;attention_2_3_0</title>
<path fill="none" stroke="black" d="M22299.75,-3742.98C22299.75,-3742.98 22299.75,-3666.2 22299.75,-3666.2"/>
<polygon fill="black" stroke="black" points="22303.25,-3666.2 22299.75,-3656.2 22296.25,-3666.2 22303.25,-3666.2"/>
</g>
<!-- v_proj_2_3_0 -->
<g id="node157" class="node">
<title>v_proj_2_3_0</title>
<polygon fill="#ffb366" stroke="black" points="22224.5,-3811 22091.5,-3811 22091.5,-3743 22224.5,-3743 22224.5,-3811"/>
<text text-anchor="middle" x="22158" y="-3795.8" font-family="Times,serif" font-size="14.00">V Projection 3_0</text>
<text text-anchor="middle" x="22158" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="22158" y="-3765.8" font-family="Times,serif" font-size="14.00">W_V^{3,0}</text>
<text text-anchor="middle" x="22158" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- v_proj_2_3_0&#45;&gt;attention_2_3_0 -->
<g id="edge173" class="edge">
<title>v_proj_2_3_0&#45;&gt;attention_2_3_0</title>
<path fill="none" stroke="black" d="M22184,-3742.98C22184,-3742.98 22184,-3666.2 22184,-3666.2"/>
<polygon fill="black" stroke="black" points="22187.5,-3666.2 22184,-3656.2 22180.5,-3666.2 22187.5,-3666.2"/>
</g>
<!-- concat_group_2_3&#45;&gt;final_concat_2 -->
<g id="edge194" class="edge">
<title>concat_group_2_3&#45;&gt;final_concat_2</title>
<path fill="none" stroke="black" d="M21847.25,-3411.1C21847.25,-3359.98 21847.25,-3241 21847.25,-3241 21847.25,-3241 24336.82,-3241 24336.82,-3241"/>
<polygon fill="black" stroke="black" points="24336.82,-3244.5 24346.82,-3241 24336.82,-3237.5 24336.82,-3244.5"/>
</g>
<!-- q_proj_2_3_1 -->
<g id="node159" class="node">
<title>q_proj_2_3_1</title>
<polygon fill="#b3ff66" stroke="black" points="22033,-3811 21899,-3811 21899,-3743 22033,-3743 22033,-3811"/>
<text text-anchor="middle" x="21966" y="-3795.8" font-family="Times,serif" font-size="14.00">Q Projection 3_1</text>
<text text-anchor="middle" x="21966" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="21966" y="-3765.8" font-family="Times,serif" font-size="14.00">W_Q^{3,1}</text>
<text text-anchor="middle" x="21966" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- attention_2_3_1 -->
<g id="node160" class="node">
<title>attention_2_3_1</title>
<polygon fill="#b3ff66" stroke="black" points="21860.5,-3656 21687.5,-3656 21687.5,-3588 21860.5,-3588 21860.5,-3656"/>
<text text-anchor="middle" x="21774" y="-3640.8" font-family="Times,serif" font-size="14.00">Attention 3_1</text>
<text text-anchor="middle" x="21774" y="-3625.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="21774" y="-3610.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="21774" y="-3595.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- q_proj_2_3_1&#45;&gt;attention_2_3_1 -->
<g id="edge175" class="edge">
<title>q_proj_2_3_1&#45;&gt;attention_2_3_1</title>
<path fill="none" stroke="black" d="M21906.75,-3742.87C21906.75,-3700.29 21906.75,-3633 21906.75,-3633 21906.75,-3633 21870.69,-3633 21870.69,-3633"/>
<polygon fill="black" stroke="black" points="21870.69,-3629.5 21860.69,-3633 21870.69,-3636.5 21870.69,-3629.5"/>
</g>
<!-- attention_2_3_1&#45;&gt;concat_group_2_3 -->
<g id="edge178" class="edge">
<title>attention_2_3_1&#45;&gt;concat_group_2_3</title>
<path fill="none" stroke="black" d="M21745.17,-3587.95C21745.17,-3587.95 21745.17,-3485.34 21745.17,-3485.34"/>
<polygon fill="black" stroke="black" points="21748.67,-3485.34 21745.17,-3475.34 21741.67,-3485.34 21748.67,-3485.34"/>
</g>
<!-- attention_2_3_1&#45;&gt;concat_group_2_3 -->
<g id="edge179" class="edge">
<title>attention_2_3_1&#45;&gt;concat_group_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M21802.83,-3587.95C21802.83,-3587.95 21802.83,-3485.34 21802.83,-3485.34"/>
<polygon fill="red" stroke="red" points="21806.33,-3485.34 21802.83,-3475.34 21799.33,-3485.34 21806.33,-3485.34"/>
<text text-anchor="middle" x="21960" y="-3533.8" font-family="Times,serif" font-size="14.00">AllGather GPU12→GPU13</text>
</g>
<!-- k_proj_2_3_1 -->
<g id="node161" class="node">
<title>k_proj_2_3_1</title>
<polygon fill="#b3ff66" stroke="black" points="21841,-3811 21707,-3811 21707,-3743 21841,-3743 21841,-3811"/>
<text text-anchor="middle" x="21774" y="-3795.8" font-family="Times,serif" font-size="14.00">K Projection 3_1</text>
<text text-anchor="middle" x="21774" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="21774" y="-3765.8" font-family="Times,serif" font-size="14.00">W_K^{3,1}</text>
<text text-anchor="middle" x="21774" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- k_proj_2_3_1&#45;&gt;attention_2_3_1 -->
<g id="edge176" class="edge">
<title>k_proj_2_3_1&#45;&gt;attention_2_3_1</title>
<path fill="none" stroke="black" d="M21774,-3742.98C21774,-3742.98 21774,-3666.2 21774,-3666.2"/>
<polygon fill="black" stroke="black" points="21777.5,-3666.2 21774,-3656.2 21770.5,-3666.2 21777.5,-3666.2"/>
</g>
<!-- v_proj_2_3_1 -->
<g id="node162" class="node">
<title>v_proj_2_3_1</title>
<polygon fill="#b3ff66" stroke="black" points="21648.5,-3811 21515.5,-3811 21515.5,-3743 21648.5,-3743 21648.5,-3811"/>
<text text-anchor="middle" x="21582" y="-3795.8" font-family="Times,serif" font-size="14.00">V Projection 3_1</text>
<text text-anchor="middle" x="21582" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="21582" y="-3765.8" font-family="Times,serif" font-size="14.00">W_V^{3,1}</text>
<text text-anchor="middle" x="21582" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- v_proj_2_3_1&#45;&gt;attention_2_3_1 -->
<g id="edge177" class="edge">
<title>v_proj_2_3_1&#45;&gt;attention_2_3_1</title>
<path fill="none" stroke="black" d="M21648.71,-3777C21674.19,-3777 21697.25,-3777 21697.25,-3777 21697.25,-3777 21697.25,-3666.02 21697.25,-3666.02"/>
<polygon fill="black" stroke="black" points="21700.75,-3666.02 21697.25,-3656.02 21693.75,-3666.02 21700.75,-3666.02"/>
</g>
<!-- q_proj_2_3_2 -->
<g id="node163" class="node">
<title>q_proj_2_3_2</title>
<polygon fill="#66ffb3" stroke="black" points="21457,-3811 21323,-3811 21323,-3743 21457,-3743 21457,-3811"/>
<text text-anchor="middle" x="21390" y="-3795.8" font-family="Times,serif" font-size="14.00">Q Projection 3_2</text>
<text text-anchor="middle" x="21390" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="21390" y="-3765.8" font-family="Times,serif" font-size="14.00">W_Q^{3,2}</text>
<text text-anchor="middle" x="21390" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- attention_2_3_2 -->
<g id="node164" class="node">
<title>attention_2_3_2</title>
<polygon fill="#66ffb3" stroke="black" points="21380.5,-3656 21207.5,-3656 21207.5,-3588 21380.5,-3588 21380.5,-3656"/>
<text text-anchor="middle" x="21294" y="-3640.8" font-family="Times,serif" font-size="14.00">Attention 3_2</text>
<text text-anchor="middle" x="21294" y="-3625.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="21294" y="-3610.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="21294" y="-3595.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- q_proj_2_3_2&#45;&gt;attention_2_3_2 -->
<g id="edge180" class="edge">
<title>q_proj_2_3_2&#45;&gt;attention_2_3_2</title>
<path fill="none" stroke="black" d="M21351.75,-3742.98C21351.75,-3742.98 21351.75,-3666.2 21351.75,-3666.2"/>
<polygon fill="black" stroke="black" points="21355.25,-3666.2 21351.75,-3656.2 21348.25,-3666.2 21355.25,-3666.2"/>
</g>
<!-- attention_2_3_2&#45;&gt;concat_group_2_3 -->
<g id="edge183" class="edge">
<title>attention_2_3_2&#45;&gt;concat_group_2_3</title>
<path fill="none" stroke="black" d="M21380.82,-3633C21493.12,-3633 21674.5,-3633 21674.5,-3633 21674.5,-3633 21674.5,-3455.85 21674.5,-3455.85"/>
<polygon fill="black" stroke="black" points="21678,-3455.85 21674.5,-3445.85 21671,-3455.85 21678,-3455.85"/>
</g>
<!-- attention_2_3_2&#45;&gt;concat_group_2_3 -->
<g id="edge184" class="edge">
<title>attention_2_3_2&#45;&gt;concat_group_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M21380.63,-3610C21489.28,-3610 21661.5,-3610 21661.5,-3610 21661.5,-3610 21661.5,-3450.68 21661.5,-3450.68"/>
<polygon fill="red" stroke="red" points="21665,-3450.68 21661.5,-3440.68 21658,-3450.68 21665,-3450.68"/>
<text text-anchor="middle" x="21647" y="-3533.8" font-family="Times,serif" font-size="14.00">AllGather GPU13→GPU14</text>
</g>
<!-- k_proj_2_3_2 -->
<g id="node165" class="node">
<title>k_proj_2_3_2</title>
<polygon fill="#66ffb3" stroke="black" points="21265,-3811 21131,-3811 21131,-3743 21265,-3743 21265,-3811"/>
<text text-anchor="middle" x="21198" y="-3795.8" font-family="Times,serif" font-size="14.00">K Projection 3_2</text>
<text text-anchor="middle" x="21198" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="21198" y="-3765.8" font-family="Times,serif" font-size="14.00">W_K^{3,2}</text>
<text text-anchor="middle" x="21198" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- k_proj_2_3_2&#45;&gt;attention_2_3_2 -->
<g id="edge181" class="edge">
<title>k_proj_2_3_2&#45;&gt;attention_2_3_2</title>
<path fill="none" stroke="black" d="M21236.25,-3742.98C21236.25,-3742.98 21236.25,-3666.2 21236.25,-3666.2"/>
<polygon fill="black" stroke="black" points="21239.75,-3666.2 21236.25,-3656.2 21232.75,-3666.2 21239.75,-3666.2"/>
</g>
<!-- v_proj_2_3_2 -->
<g id="node166" class="node">
<title>v_proj_2_3_2</title>
<polygon fill="#66ffb3" stroke="black" points="21072.5,-3811 20939.5,-3811 20939.5,-3743 21072.5,-3743 21072.5,-3811"/>
<text text-anchor="middle" x="21006" y="-3795.8" font-family="Times,serif" font-size="14.00">V Projection 3_2</text>
<text text-anchor="middle" x="21006" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="21006" y="-3765.8" font-family="Times,serif" font-size="14.00">W_V^{3,2}</text>
<text text-anchor="middle" x="21006" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- v_proj_2_3_2&#45;&gt;attention_2_3_2 -->
<g id="edge182" class="edge">
<title>v_proj_2_3_2&#45;&gt;attention_2_3_2</title>
<path fill="none" stroke="black" d="M21030,-3742.98C21030,-3697.36 21030,-3622 21030,-3622 21030,-3622 21197.19,-3622 21197.19,-3622"/>
<polygon fill="black" stroke="black" points="21197.19,-3625.5 21207.19,-3622 21197.19,-3618.5 21197.19,-3625.5"/>
</g>
<!-- q_proj_2_3_3 -->
<g id="node167" class="node">
<title>q_proj_2_3_3</title>
<polygon fill="#66b3ff" stroke="black" points="20881,-3811 20747,-3811 20747,-3743 20881,-3743 20881,-3811"/>
<text text-anchor="middle" x="20814" y="-3795.8" font-family="Times,serif" font-size="14.00">Q Projection 3_3</text>
<text text-anchor="middle" x="20814" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="20814" y="-3765.8" font-family="Times,serif" font-size="14.00">W_Q^{3,3}</text>
<text text-anchor="middle" x="20814" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- attention_2_3_3 -->
<g id="node168" class="node">
<title>attention_2_3_3</title>
<polygon fill="#66b3ff" stroke="black" points="20756.5,-3656 20583.5,-3656 20583.5,-3588 20756.5,-3588 20756.5,-3656"/>
<text text-anchor="middle" x="20670" y="-3640.8" font-family="Times,serif" font-size="14.00">Attention 3_3</text>
<text text-anchor="middle" x="20670" y="-3625.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="20670" y="-3610.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="20670" y="-3595.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- q_proj_2_3_3&#45;&gt;attention_2_3_3 -->
<g id="edge185" class="edge">
<title>q_proj_2_3_3&#45;&gt;attention_2_3_3</title>
<path fill="none" stroke="black" d="M20751.75,-3742.98C20751.75,-3742.98 20751.75,-3666.2 20751.75,-3666.2"/>
<polygon fill="black" stroke="black" points="20755.25,-3666.2 20751.75,-3656.2 20748.25,-3666.2 20755.25,-3666.2"/>
</g>
<!-- attention_2_3_3&#45;&gt;concat_group_2_3 -->
<g id="edge188" class="edge">
<title>attention_2_3_3&#45;&gt;concat_group_2_3</title>
<path fill="none" stroke="black" d="M20750,-3587.81C20750,-3537.9 20750,-3451 20750,-3451 20750,-3451 21676.69,-3451 21676.69,-3451"/>
<polygon fill="black" stroke="black" points="21676.69,-3454.5 21686.69,-3451 21676.69,-3447.5 21676.69,-3454.5"/>
</g>
<!-- attention_2_3_3&#45;&gt;concat_group_2_3 -->
<g id="edge189" class="edge">
<title>attention_2_3_3&#45;&gt;concat_group_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20743.5,-3587.98C20743.5,-3529.47 20743.5,-3416 20743.5,-3416 20743.5,-3416 21679.23,-3416 21679.23,-3416"/>
<polygon fill="red" stroke="red" points="21679.23,-3419.5 21689.23,-3416 21679.23,-3412.5 21679.23,-3419.5"/>
<text text-anchor="middle" x="21223" y="-3533.8" font-family="Times,serif" font-size="14.00">AllGather GPU14→GPU15</text>
</g>
<!-- k_proj_2_3_3 -->
<g id="node169" class="node">
<title>k_proj_2_3_3</title>
<polygon fill="#66b3ff" stroke="black" points="20689,-3811 20555,-3811 20555,-3743 20689,-3743 20689,-3811"/>
<text text-anchor="middle" x="20622" y="-3795.8" font-family="Times,serif" font-size="14.00">K Projection 3_3</text>
<text text-anchor="middle" x="20622" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="20622" y="-3765.8" font-family="Times,serif" font-size="14.00">W_K^{3,3}</text>
<text text-anchor="middle" x="20622" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- k_proj_2_3_3&#45;&gt;attention_2_3_3 -->
<g id="edge186" class="edge">
<title>k_proj_2_3_3&#45;&gt;attention_2_3_3</title>
<path fill="none" stroke="black" d="M20636.25,-3742.98C20636.25,-3742.98 20636.25,-3666.2 20636.25,-3666.2"/>
<polygon fill="black" stroke="black" points="20639.75,-3666.2 20636.25,-3656.2 20632.75,-3666.2 20639.75,-3666.2"/>
</g>
<!-- v_proj_2_3_3 -->
<g id="node170" class="node">
<title>v_proj_2_3_3</title>
<polygon fill="#66b3ff" stroke="black" points="20496.5,-3811 20363.5,-3811 20363.5,-3743 20496.5,-3743 20496.5,-3811"/>
<text text-anchor="middle" x="20430" y="-3795.8" font-family="Times,serif" font-size="14.00">V Projection 3_3</text>
<text text-anchor="middle" x="20430" y="-3780.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="20430" y="-3765.8" font-family="Times,serif" font-size="14.00">W_V^{3,3}</text>
<text text-anchor="middle" x="20430" y="-3750.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- v_proj_2_3_3&#45;&gt;attention_2_3_3 -->
<g id="edge187" class="edge">
<title>v_proj_2_3_3&#45;&gt;attention_2_3_3</title>
<path fill="none" stroke="black" d="M20454,-3742.98C20454,-3697.36 20454,-3622 20454,-3622 20454,-3622 20573.39,-3622 20573.39,-3622"/>
<polygon fill="black" stroke="black" points="20573.39,-3625.5 20583.39,-3622 20573.39,-3618.5 20573.39,-3625.5"/>
</g>
<!-- ffn_2_0 -->
<g id="node172" class="node">
<title>ffn_2_0</title>
<polygon fill="#ff9999" stroke="black" points="24567,-3101 24457,-3101 24457,-3048 24567,-3048 24567,-3101"/>
<text text-anchor="middle" x="24512" y="-3085.8" font-family="Times,serif" font-size="14.00">FFN Dense 0</text>
<text text-anchor="middle" x="24512" y="-3070.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="24512" y="-3055.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- final_concat_2&#45;&gt;ffn_2_0 -->
<g id="edge191" class="edge">
<title>final_concat_2&#45;&gt;ffn_2_0</title>
<path fill="none" stroke="black" d="M24512,-3187.86C24512,-3187.86 24512,-3111.1 24512,-3111.1"/>
<polygon fill="black" stroke="black" points="24515.5,-3111.1 24512,-3101.1 24508.5,-3111.1 24515.5,-3111.1"/>
</g>
<!-- ffn_out_2_0 -->
<g id="node173" class="node">
<title>ffn_out_2_0</title>
<polygon fill="#ff9999" stroke="black" points="24570,-2961 24454,-2961 24454,-2908 24570,-2908 24570,-2961"/>
<text text-anchor="middle" x="24512" y="-2945.8" font-family="Times,serif" font-size="14.00">FFN Output 0</text>
<text text-anchor="middle" x="24512" y="-2930.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="24512" y="-2915.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn_2_0&#45;&gt;ffn_out_2_0 -->
<g id="edge195" class="edge">
<title>ffn_2_0&#45;&gt;ffn_out_2_0</title>
<path fill="none" stroke="black" d="M24512,-3047.84C24512,-3047.84 24512,-2971.06 24512,-2971.06"/>
<polygon fill="black" stroke="black" points="24515.5,-2971.06 24512,-2961.06 24508.5,-2971.06 24515.5,-2971.06"/>
</g>
<!-- layer_norm_2 -->
<g id="node174" class="node">
<title>layer_norm_2</title>
<ellipse fill="#e6e6e6" stroke="black" cx="23166" cy="-2783.5" rx="82" ry="37.5"/>
<text text-anchor="middle" x="23166" y="-2794.8" font-family="Times,serif" font-size="14.00">Layer Norm 2</text>
<text text-anchor="middle" x="23166" y="-2779.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="23166" y="-2764.8" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- ffn_out_2_0&#45;&gt;layer_norm_2 -->
<g id="edge196" class="edge">
<title>ffn_out_2_0&#45;&gt;layer_norm_2</title>
<path fill="none" stroke="black" d="M24512,-2907.63C24512,-2857.55 24512,-2755 24512,-2755 24512,-2755 23229.6,-2755 23229.6,-2755"/>
<polygon fill="black" stroke="black" points="23229.6,-2751.5 23219.6,-2755 23229.6,-2758.5 23229.6,-2751.5"/>
</g>
<!-- q_proj_3_0_0 -->
<g id="node205" class="node">
<title>q_proj_3_0_0</title>
<polygon fill="#ff9999" stroke="black" points="23233,-2659 23099,-2659 23099,-2591 23233,-2591 23233,-2659"/>
<text text-anchor="middle" x="23166" y="-2643.8" font-family="Times,serif" font-size="14.00">Q Projection 0_0</text>
<text text-anchor="middle" x="23166" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="23166" y="-2613.8" font-family="Times,serif" font-size="14.00">W_Q^{0,0}</text>
<text text-anchor="middle" x="23166" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_norm_2&#45;&gt;q_proj_3_0_0 -->
<g id="edge490" class="edge">
<title>layer_norm_2&#45;&gt;q_proj_3_0_0</title>
<path fill="none" stroke="black" d="M23166,-2745.94C23166,-2745.94 23166,-2669.05 23166,-2669.05"/>
<polygon fill="black" stroke="black" points="23169.5,-2669.05 23166,-2659.05 23162.5,-2669.05 23169.5,-2669.05"/>
</g>
<!-- ffn_2_1 -->
<g id="node175" class="node">
<title>ffn_2_1</title>
<polygon fill="#ffcc99" stroke="black" points="24393,-3101 24283,-3101 24283,-3048 24393,-3048 24393,-3101"/>
<text text-anchor="middle" x="24338" y="-3085.8" font-family="Times,serif" font-size="14.00">FFN Dense 1</text>
<text text-anchor="middle" x="24338" y="-3070.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="24338" y="-3055.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn_out_2_1 -->
<g id="node176" class="node">
<title>ffn_out_2_1</title>
<polygon fill="#ffcc99" stroke="black" points="24396,-2961 24280,-2961 24280,-2908 24396,-2908 24396,-2961"/>
<text text-anchor="middle" x="24338" y="-2945.8" font-family="Times,serif" font-size="14.00">FFN Output 1</text>
<text text-anchor="middle" x="24338" y="-2930.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="24338" y="-2915.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn_2_1&#45;&gt;ffn_out_2_1 -->
<g id="edge197" class="edge">
<title>ffn_2_1&#45;&gt;ffn_out_2_1</title>
<path fill="none" stroke="black" d="M24338,-3047.84C24338,-3047.84 24338,-2971.06 24338,-2971.06"/>
<polygon fill="black" stroke="black" points="24341.5,-2971.06 24338,-2961.06 24334.5,-2971.06 24341.5,-2971.06"/>
</g>
<!-- ffn_out_2_1&#45;&gt;layer_norm_2 -->
<g id="edge198" class="edge">
<title>ffn_out_2_1&#45;&gt;layer_norm_2</title>
<path fill="none" stroke="black" d="M24338,-2907.86C24338,-2859.91 24338,-2764 24338,-2764 24338,-2764 23246.24,-2764 23246.24,-2764"/>
<polygon fill="black" stroke="black" points="23246.24,-2760.5 23236.24,-2764 23246.24,-2767.5 23246.24,-2760.5"/>
</g>
<!-- ffn_2_2 -->
<g id="node177" class="node">
<title>ffn_2_2</title>
<polygon fill="#ffff99" stroke="black" points="24219,-3101 24109,-3101 24109,-3048 24219,-3048 24219,-3101"/>
<text text-anchor="middle" x="24164" y="-3085.8" font-family="Times,serif" font-size="14.00">FFN Dense 2</text>
<text text-anchor="middle" x="24164" y="-3070.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="24164" y="-3055.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn_out_2_2 -->
<g id="node178" class="node">
<title>ffn_out_2_2</title>
<polygon fill="#ffff99" stroke="black" points="24222,-2961 24106,-2961 24106,-2908 24222,-2908 24222,-2961"/>
<text text-anchor="middle" x="24164" y="-2945.8" font-family="Times,serif" font-size="14.00">FFN Output 2</text>
<text text-anchor="middle" x="24164" y="-2930.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="24164" y="-2915.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn_2_2&#45;&gt;ffn_out_2_2 -->
<g id="edge199" class="edge">
<title>ffn_2_2&#45;&gt;ffn_out_2_2</title>
<path fill="none" stroke="black" d="M24164,-3047.84C24164,-3047.84 24164,-2971.06 24164,-2971.06"/>
<polygon fill="black" stroke="black" points="24167.5,-2971.06 24164,-2961.06 24160.5,-2971.06 24167.5,-2971.06"/>
</g>
<!-- ffn_out_2_2&#45;&gt;layer_norm_2 -->
<g id="edge200" class="edge">
<title>ffn_out_2_2&#45;&gt;layer_norm_2</title>
<path fill="none" stroke="black" d="M24164,-2908C24164,-2862.41 24164,-2774 24164,-2774 24164,-2774 23255.56,-2774 23255.56,-2774"/>
<polygon fill="black" stroke="black" points="23255.56,-2770.5 23245.56,-2774 23255.56,-2777.5 23255.56,-2770.5"/>
</g>
<!-- ffn_2_3 -->
<g id="node179" class="node">
<title>ffn_2_3</title>
<polygon fill="#ccff99" stroke="black" points="24045,-3101 23935,-3101 23935,-3048 24045,-3048 24045,-3101"/>
<text text-anchor="middle" x="23990" y="-3085.8" font-family="Times,serif" font-size="14.00">FFN Dense 3</text>
<text text-anchor="middle" x="23990" y="-3070.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="23990" y="-3055.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn_out_2_3 -->
<g id="node180" class="node">
<title>ffn_out_2_3</title>
<polygon fill="#ccff99" stroke="black" points="24048,-2961 23932,-2961 23932,-2908 24048,-2908 24048,-2961"/>
<text text-anchor="middle" x="23990" y="-2945.8" font-family="Times,serif" font-size="14.00">FFN Output 3</text>
<text text-anchor="middle" x="23990" y="-2930.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="23990" y="-2915.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn_2_3&#45;&gt;ffn_out_2_3 -->
<g id="edge201" class="edge">
<title>ffn_2_3&#45;&gt;ffn_out_2_3</title>
<path fill="none" stroke="black" d="M23990,-3047.84C23990,-3047.84 23990,-2971.06 23990,-2971.06"/>
<polygon fill="black" stroke="black" points="23993.5,-2971.06 23990,-2961.06 23986.5,-2971.06 23993.5,-2971.06"/>
</g>
<!-- ffn_out_2_3&#45;&gt;layer_norm_2 -->
<g id="edge202" class="edge">
<title>ffn_out_2_3&#45;&gt;layer_norm_2</title>
<path fill="none" stroke="black" d="M23990,-2907.76C23990,-2864.27 23990,-2783 23990,-2783 23990,-2783 23258.02,-2783 23258.02,-2783"/>
<polygon fill="black" stroke="black" points="23258.02,-2779.5 23248.02,-2783 23258.02,-2786.5 23258.02,-2779.5"/>
</g>
<!-- ffn_2_4 -->
<g id="node181" class="node">
<title>ffn_2_4</title>
<polygon fill="#99ff99" stroke="black" points="23871,-3101 23761,-3101 23761,-3048 23871,-3048 23871,-3101"/>
<text text-anchor="middle" x="23816" y="-3085.8" font-family="Times,serif" font-size="14.00">FFN Dense 4</text>
<text text-anchor="middle" x="23816" y="-3070.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="23816" y="-3055.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn_out_2_4 -->
<g id="node182" class="node">
<title>ffn_out_2_4</title>
<polygon fill="#99ff99" stroke="black" points="23874,-2961 23758,-2961 23758,-2908 23874,-2908 23874,-2961"/>
<text text-anchor="middle" x="23816" y="-2945.8" font-family="Times,serif" font-size="14.00">FFN Output 4</text>
<text text-anchor="middle" x="23816" y="-2930.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="23816" y="-2915.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn_2_4&#45;&gt;ffn_out_2_4 -->
<g id="edge203" class="edge">
<title>ffn_2_4&#45;&gt;ffn_out_2_4</title>
<path fill="none" stroke="black" d="M23816,-3047.84C23816,-3047.84 23816,-2971.06 23816,-2971.06"/>
<polygon fill="black" stroke="black" points="23819.5,-2971.06 23816,-2961.06 23812.5,-2971.06 23819.5,-2971.06"/>
</g>
<!-- ffn_out_2_4&#45;&gt;layer_norm_2 -->
<g id="edge204" class="edge">
<title>ffn_out_2_4&#45;&gt;layer_norm_2</title>
<path fill="none" stroke="black" d="M23816,-2907.7C23816,-2866.42 23816,-2792 23816,-2792 23816,-2792 23256.03,-2792 23256.03,-2792"/>
<polygon fill="black" stroke="black" points="23256.03,-2788.5 23246.03,-2792 23256.03,-2795.5 23256.03,-2788.5"/>
</g>
<!-- ffn_2_5 -->
<g id="node183" class="node">
<title>ffn_2_5</title>
<polygon fill="#99ffcc" stroke="black" points="23697,-3101 23587,-3101 23587,-3048 23697,-3048 23697,-3101"/>
<text text-anchor="middle" x="23642" y="-3085.8" font-family="Times,serif" font-size="14.00">FFN Dense 5</text>
<text text-anchor="middle" x="23642" y="-3070.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="23642" y="-3055.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn_out_2_5 -->
<g id="node184" class="node">
<title>ffn_out_2_5</title>
<polygon fill="#99ffcc" stroke="black" points="23700,-2961 23584,-2961 23584,-2908 23700,-2908 23700,-2961"/>
<text text-anchor="middle" x="23642" y="-2945.8" font-family="Times,serif" font-size="14.00">FFN Output 5</text>
<text text-anchor="middle" x="23642" y="-2930.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="23642" y="-2915.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn_2_5&#45;&gt;ffn_out_2_5 -->
<g id="edge205" class="edge">
<title>ffn_2_5&#45;&gt;ffn_out_2_5</title>
<path fill="none" stroke="black" d="M23642,-3047.84C23642,-3047.84 23642,-2971.06 23642,-2971.06"/>
<polygon fill="black" stroke="black" points="23645.5,-2971.06 23642,-2961.06 23638.5,-2971.06 23645.5,-2971.06"/>
</g>
<!-- ffn_out_2_5&#45;&gt;layer_norm_2 -->
<g id="edge206" class="edge">
<title>ffn_out_2_5&#45;&gt;layer_norm_2</title>
<path fill="none" stroke="black" d="M23642,-2907.69C23642,-2868.97 23642,-2802 23642,-2802 23642,-2802 23247.52,-2802 23247.52,-2802"/>
<polygon fill="black" stroke="black" points="23247.52,-2798.5 23237.52,-2802 23247.52,-2805.5 23247.52,-2798.5"/>
</g>
<!-- ffn_2_6 -->
<g id="node185" class="node">
<title>ffn_2_6</title>
<polygon fill="#99ffff" stroke="black" points="23523,-3101 23413,-3101 23413,-3048 23523,-3048 23523,-3101"/>
<text text-anchor="middle" x="23468" y="-3085.8" font-family="Times,serif" font-size="14.00">FFN Dense 6</text>
<text text-anchor="middle" x="23468" y="-3070.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="23468" y="-3055.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn_out_2_6 -->
<g id="node186" class="node">
<title>ffn_out_2_6</title>
<polygon fill="#99ffff" stroke="black" points="23526,-2961 23410,-2961 23410,-2908 23526,-2908 23526,-2961"/>
<text text-anchor="middle" x="23468" y="-2945.8" font-family="Times,serif" font-size="14.00">FFN Output 6</text>
<text text-anchor="middle" x="23468" y="-2930.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="23468" y="-2915.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn_2_6&#45;&gt;ffn_out_2_6 -->
<g id="edge207" class="edge">
<title>ffn_2_6&#45;&gt;ffn_out_2_6</title>
<path fill="none" stroke="black" d="M23468,-3047.84C23468,-3047.84 23468,-2971.06 23468,-2971.06"/>
<polygon fill="black" stroke="black" points="23471.5,-2971.06 23468,-2961.06 23464.5,-2971.06 23471.5,-2971.06"/>
</g>
<!-- ffn_out_2_6&#45;&gt;layer_norm_2 -->
<g id="edge208" class="edge">
<title>ffn_out_2_6&#45;&gt;layer_norm_2</title>
<path fill="none" stroke="black" d="M23468,-2907.7C23468,-2871.38 23468,-2811 23468,-2811 23468,-2811 23232.1,-2811 23232.1,-2811"/>
<polygon fill="black" stroke="black" points="23232.1,-2807.5 23222.1,-2811 23232.1,-2814.5 23232.1,-2807.5"/>
</g>
<!-- ffn_2_7 -->
<g id="node187" class="node">
<title>ffn_2_7</title>
<polygon fill="#99ccff" stroke="black" points="23349,-3101 23239,-3101 23239,-3048 23349,-3048 23349,-3101"/>
<text text-anchor="middle" x="23294" y="-3085.8" font-family="Times,serif" font-size="14.00">FFN Dense 7</text>
<text text-anchor="middle" x="23294" y="-3070.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="23294" y="-3055.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn_out_2_7 -->
<g id="node188" class="node">
<title>ffn_out_2_7</title>
<polygon fill="#99ccff" stroke="black" points="23352,-2961 23236,-2961 23236,-2908 23352,-2908 23352,-2961"/>
<text text-anchor="middle" x="23294" y="-2945.8" font-family="Times,serif" font-size="14.00">FFN Output 7</text>
<text text-anchor="middle" x="23294" y="-2930.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="23294" y="-2915.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn_2_7&#45;&gt;ffn_out_2_7 -->
<g id="edge209" class="edge">
<title>ffn_2_7&#45;&gt;ffn_out_2_7</title>
<path fill="none" stroke="black" d="M23294,-3047.84C23294,-3047.84 23294,-2971.06 23294,-2971.06"/>
<polygon fill="black" stroke="black" points="23297.5,-2971.06 23294,-2961.06 23290.5,-2971.06 23297.5,-2971.06"/>
</g>
<!-- ffn_out_2_7&#45;&gt;layer_norm_2 -->
<g id="edge210" class="edge">
<title>ffn_out_2_7&#45;&gt;layer_norm_2</title>
<path fill="none" stroke="black" d="M23242,-2907.85C23242,-2907.85 23242,-2807.62 23242,-2807.62"/>
<polygon fill="black" stroke="black" points="23245.5,-2807.62 23242,-2797.62 23238.5,-2807.62 23245.5,-2807.62"/>
</g>
<!-- ffn_2_8 -->
<g id="node189" class="node">
<title>ffn_2_8</title>
<polygon fill="#9999ff" stroke="black" points="23175,-3101 23065,-3101 23065,-3048 23175,-3048 23175,-3101"/>
<text text-anchor="middle" x="23120" y="-3085.8" font-family="Times,serif" font-size="14.00">FFN Dense 8</text>
<text text-anchor="middle" x="23120" y="-3070.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="23120" y="-3055.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn_out_2_8 -->
<g id="node190" class="node">
<title>ffn_out_2_8</title>
<polygon fill="#9999ff" stroke="black" points="23178,-2961 23062,-2961 23062,-2908 23178,-2908 23178,-2961"/>
<text text-anchor="middle" x="23120" y="-2945.8" font-family="Times,serif" font-size="14.00">FFN Output 8</text>
<text text-anchor="middle" x="23120" y="-2930.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="23120" y="-2915.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn_2_8&#45;&gt;ffn_out_2_8 -->
<g id="edge211" class="edge">
<title>ffn_2_8&#45;&gt;ffn_out_2_8</title>
<path fill="none" stroke="black" d="M23120,-3047.84C23120,-3047.84 23120,-2971.06 23120,-2971.06"/>
<polygon fill="black" stroke="black" points="23123.5,-2971.06 23120,-2961.06 23116.5,-2971.06 23123.5,-2971.06"/>
</g>
<!-- ffn_out_2_8&#45;&gt;layer_norm_2 -->
<g id="edge212" class="edge">
<title>ffn_out_2_8&#45;&gt;layer_norm_2</title>
<path fill="none" stroke="black" d="M23131,-2907.85C23131,-2907.85 23131,-2827.56 23131,-2827.56"/>
<polygon fill="black" stroke="black" points="23134.5,-2827.56 23131,-2817.56 23127.5,-2827.56 23134.5,-2827.56"/>
</g>
<!-- ffn_2_9 -->
<g id="node191" class="node">
<title>ffn_2_9</title>
<polygon fill="#cc99ff" stroke="black" points="23001,-3101 22891,-3101 22891,-3048 23001,-3048 23001,-3101"/>
<text text-anchor="middle" x="22946" y="-3085.8" font-family="Times,serif" font-size="14.00">FFN Dense 9</text>
<text text-anchor="middle" x="22946" y="-3070.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="22946" y="-3055.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn_out_2_9 -->
<g id="node192" class="node">
<title>ffn_out_2_9</title>
<polygon fill="#cc99ff" stroke="black" points="23004,-2961 22888,-2961 22888,-2908 23004,-2908 23004,-2961"/>
<text text-anchor="middle" x="22946" y="-2945.8" font-family="Times,serif" font-size="14.00">FFN Output 9</text>
<text text-anchor="middle" x="22946" y="-2930.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="22946" y="-2915.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn_2_9&#45;&gt;ffn_out_2_9 -->
<g id="edge213" class="edge">
<title>ffn_2_9&#45;&gt;ffn_out_2_9</title>
<path fill="none" stroke="black" d="M22946,-3047.84C22946,-3047.84 22946,-2971.06 22946,-2971.06"/>
<polygon fill="black" stroke="black" points="22949.5,-2971.06 22946,-2961.06 22942.5,-2971.06 22949.5,-2971.06"/>
</g>
<!-- ffn_out_2_9&#45;&gt;layer_norm_2 -->
<g id="edge214" class="edge">
<title>ffn_out_2_9&#45;&gt;layer_norm_2</title>
<path fill="none" stroke="black" d="M22955.5,-2907.7C22955.5,-2871.38 22955.5,-2811 22955.5,-2811 22955.5,-2811 23100.14,-2811 23100.14,-2811"/>
<polygon fill="black" stroke="black" points="23100.14,-2814.5 23110.14,-2811 23100.14,-2807.5 23100.14,-2814.5"/>
</g>
<!-- ffn_2_10 -->
<g id="node193" class="node">
<title>ffn_2_10</title>
<polygon fill="#ff99ff" stroke="black" points="22826.5,-3101 22707.5,-3101 22707.5,-3048 22826.5,-3048 22826.5,-3101"/>
<text text-anchor="middle" x="22767" y="-3085.8" font-family="Times,serif" font-size="14.00">FFN Dense 10</text>
<text text-anchor="middle" x="22767" y="-3070.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="22767" y="-3055.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn_out_2_10 -->
<g id="node194" class="node">
<title>ffn_out_2_10</title>
<polygon fill="#ff99ff" stroke="black" points="22829.5,-2961 22704.5,-2961 22704.5,-2908 22829.5,-2908 22829.5,-2961"/>
<text text-anchor="middle" x="22767" y="-2945.8" font-family="Times,serif" font-size="14.00">FFN Output 10</text>
<text text-anchor="middle" x="22767" y="-2930.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="22767" y="-2915.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn_2_10&#45;&gt;ffn_out_2_10 -->
<g id="edge215" class="edge">
<title>ffn_2_10&#45;&gt;ffn_out_2_10</title>
<path fill="none" stroke="black" d="M22767,-3047.84C22767,-3047.84 22767,-2971.06 22767,-2971.06"/>
<polygon fill="black" stroke="black" points="22770.5,-2971.06 22767,-2961.06 22763.5,-2971.06 22770.5,-2971.06"/>
</g>
<!-- ffn_out_2_10&#45;&gt;layer_norm_2 -->
<g id="edge216" class="edge">
<title>ffn_out_2_10&#45;&gt;layer_norm_2</title>
<path fill="none" stroke="black" d="M22772.5,-2907.69C22772.5,-2868.97 22772.5,-2802 22772.5,-2802 22772.5,-2802 23084.28,-2802 23084.28,-2802"/>
<polygon fill="black" stroke="black" points="23084.28,-2805.5 23094.28,-2802 23084.28,-2798.5 23084.28,-2805.5"/>
</g>
<!-- ffn_2_11 -->
<g id="node195" class="node">
<title>ffn_2_11</title>
<polygon fill="#ff99cc" stroke="black" points="22643.5,-3101 22524.5,-3101 22524.5,-3048 22643.5,-3048 22643.5,-3101"/>
<text text-anchor="middle" x="22584" y="-3085.8" font-family="Times,serif" font-size="14.00">FFN Dense 11</text>
<text text-anchor="middle" x="22584" y="-3070.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="22584" y="-3055.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn_out_2_11 -->
<g id="node196" class="node">
<title>ffn_out_2_11</title>
<polygon fill="#ff99cc" stroke="black" points="22646.5,-2961 22521.5,-2961 22521.5,-2908 22646.5,-2908 22646.5,-2961"/>
<text text-anchor="middle" x="22584" y="-2945.8" font-family="Times,serif" font-size="14.00">FFN Output 11</text>
<text text-anchor="middle" x="22584" y="-2930.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="22584" y="-2915.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn_2_11&#45;&gt;ffn_out_2_11 -->
<g id="edge217" class="edge">
<title>ffn_2_11&#45;&gt;ffn_out_2_11</title>
<path fill="none" stroke="black" d="M22584,-3047.84C22584,-3047.84 22584,-2971.06 22584,-2971.06"/>
<polygon fill="black" stroke="black" points="22587.5,-2971.06 22584,-2961.06 22580.5,-2971.06 22587.5,-2971.06"/>
</g>
<!-- ffn_out_2_11&#45;&gt;layer_norm_2 -->
<g id="edge218" class="edge">
<title>ffn_out_2_11&#45;&gt;layer_norm_2</title>
<path fill="none" stroke="black" d="M22584.75,-2907.7C22584.75,-2866.42 22584.75,-2792 22584.75,-2792 22584.75,-2792 23076.09,-2792 23076.09,-2792"/>
<polygon fill="black" stroke="black" points="23076.09,-2795.5 23086.09,-2792 23076.09,-2788.5 23076.09,-2795.5"/>
</g>
<!-- ffn_2_12 -->
<g id="node197" class="node">
<title>ffn_2_12</title>
<polygon fill="#ffb366" stroke="black" points="22460.5,-3101 22341.5,-3101 22341.5,-3048 22460.5,-3048 22460.5,-3101"/>
<text text-anchor="middle" x="22401" y="-3085.8" font-family="Times,serif" font-size="14.00">FFN Dense 12</text>
<text text-anchor="middle" x="22401" y="-3070.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="22401" y="-3055.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn_out_2_12 -->
<g id="node198" class="node">
<title>ffn_out_2_12</title>
<polygon fill="#ffb366" stroke="black" points="22463.5,-2961 22338.5,-2961 22338.5,-2908 22463.5,-2908 22463.5,-2961"/>
<text text-anchor="middle" x="22401" y="-2945.8" font-family="Times,serif" font-size="14.00">FFN Output 12</text>
<text text-anchor="middle" x="22401" y="-2930.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="22401" y="-2915.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn_2_12&#45;&gt;ffn_out_2_12 -->
<g id="edge219" class="edge">
<title>ffn_2_12&#45;&gt;ffn_out_2_12</title>
<path fill="none" stroke="black" d="M22401,-3047.84C22401,-3047.84 22401,-2971.06 22401,-2971.06"/>
<polygon fill="black" stroke="black" points="22404.5,-2971.06 22401,-2961.06 22397.5,-2971.06 22404.5,-2971.06"/>
</g>
<!-- ffn_out_2_12&#45;&gt;layer_norm_2 -->
<g id="edge220" class="edge">
<title>ffn_out_2_12&#45;&gt;layer_norm_2</title>
<path fill="none" stroke="black" d="M22401,-2907.76C22401,-2864.27 22401,-2783 22401,-2783 22401,-2783 23073.77,-2783 23073.77,-2783"/>
<polygon fill="black" stroke="black" points="23073.77,-2786.5 23083.77,-2783 23073.77,-2779.5 23073.77,-2786.5"/>
</g>
<!-- ffn_2_13 -->
<g id="node199" class="node">
<title>ffn_2_13</title>
<polygon fill="#b3ff66" stroke="black" points="22277.5,-3101 22158.5,-3101 22158.5,-3048 22277.5,-3048 22277.5,-3101"/>
<text text-anchor="middle" x="22218" y="-3085.8" font-family="Times,serif" font-size="14.00">FFN Dense 13</text>
<text text-anchor="middle" x="22218" y="-3070.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="22218" y="-3055.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn_out_2_13 -->
<g id="node200" class="node">
<title>ffn_out_2_13</title>
<polygon fill="#b3ff66" stroke="black" points="22280.5,-2961 22155.5,-2961 22155.5,-2908 22280.5,-2908 22280.5,-2961"/>
<text text-anchor="middle" x="22218" y="-2945.8" font-family="Times,serif" font-size="14.00">FFN Output 13</text>
<text text-anchor="middle" x="22218" y="-2930.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="22218" y="-2915.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn_2_13&#45;&gt;ffn_out_2_13 -->
<g id="edge221" class="edge">
<title>ffn_2_13&#45;&gt;ffn_out_2_13</title>
<path fill="none" stroke="black" d="M22218,-3047.84C22218,-3047.84 22218,-2971.06 22218,-2971.06"/>
<polygon fill="black" stroke="black" points="22221.5,-2971.06 22218,-2961.06 22214.5,-2971.06 22221.5,-2971.06"/>
</g>
<!-- ffn_out_2_13&#45;&gt;layer_norm_2 -->
<g id="edge222" class="edge">
<title>ffn_out_2_13&#45;&gt;layer_norm_2</title>
<path fill="none" stroke="black" d="M22276.5,-2908C22276.5,-2862.41 22276.5,-2774 22276.5,-2774 22276.5,-2774 23076.67,-2774 23076.67,-2774"/>
<polygon fill="black" stroke="black" points="23076.67,-2777.5 23086.67,-2774 23076.67,-2770.5 23076.67,-2777.5"/>
</g>
<!-- ffn_2_14 -->
<g id="node201" class="node">
<title>ffn_2_14</title>
<polygon fill="#66ffb3" stroke="black" points="22094.5,-3101 21975.5,-3101 21975.5,-3048 22094.5,-3048 22094.5,-3101"/>
<text text-anchor="middle" x="22035" y="-3085.8" font-family="Times,serif" font-size="14.00">FFN Dense 14</text>
<text text-anchor="middle" x="22035" y="-3070.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="22035" y="-3055.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn_out_2_14 -->
<g id="node202" class="node">
<title>ffn_out_2_14</title>
<polygon fill="#66ffb3" stroke="black" points="22097.5,-2961 21972.5,-2961 21972.5,-2908 22097.5,-2908 22097.5,-2961"/>
<text text-anchor="middle" x="22035" y="-2945.8" font-family="Times,serif" font-size="14.00">FFN Output 14</text>
<text text-anchor="middle" x="22035" y="-2930.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="22035" y="-2915.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn_2_14&#45;&gt;ffn_out_2_14 -->
<g id="edge223" class="edge">
<title>ffn_2_14&#45;&gt;ffn_out_2_14</title>
<path fill="none" stroke="black" d="M22035,-3047.84C22035,-3047.84 22035,-2971.06 22035,-2971.06"/>
<polygon fill="black" stroke="black" points="22038.5,-2971.06 22035,-2961.06 22031.5,-2971.06 22038.5,-2971.06"/>
</g>
<!-- ffn_out_2_14&#45;&gt;layer_norm_2 -->
<g id="edge224" class="edge">
<title>ffn_out_2_14&#45;&gt;layer_norm_2</title>
<path fill="none" stroke="black" d="M22089.25,-2907.86C22089.25,-2859.91 22089.25,-2764 22089.25,-2764 22089.25,-2764 23085.77,-2764 23085.77,-2764"/>
<polygon fill="black" stroke="black" points="23085.77,-2767.5 23095.77,-2764 23085.77,-2760.5 23085.77,-2767.5"/>
</g>
<!-- ffn_2_15 -->
<g id="node203" class="node">
<title>ffn_2_15</title>
<polygon fill="#66b3ff" stroke="black" points="21911.5,-3101 21792.5,-3101 21792.5,-3048 21911.5,-3048 21911.5,-3101"/>
<text text-anchor="middle" x="21852" y="-3085.8" font-family="Times,serif" font-size="14.00">FFN Dense 15</text>
<text text-anchor="middle" x="21852" y="-3070.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="21852" y="-3055.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn_out_2_15 -->
<g id="node204" class="node">
<title>ffn_out_2_15</title>
<polygon fill="#66b3ff" stroke="black" points="21914.5,-2961 21789.5,-2961 21789.5,-2908 21914.5,-2908 21914.5,-2961"/>
<text text-anchor="middle" x="21852" y="-2945.8" font-family="Times,serif" font-size="14.00">FFN Output 15</text>
<text text-anchor="middle" x="21852" y="-2930.8" font-family="Times,serif" font-size="14.00">[B×L×D/16]</text>
<text text-anchor="middle" x="21852" y="-2915.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn_2_15&#45;&gt;ffn_out_2_15 -->
<g id="edge225" class="edge">
<title>ffn_2_15&#45;&gt;ffn_out_2_15</title>
<path fill="none" stroke="black" d="M21852,-3047.84C21852,-3047.84 21852,-2971.06 21852,-2971.06"/>
<polygon fill="black" stroke="black" points="21855.5,-2971.06 21852,-2961.06 21848.5,-2971.06 21855.5,-2971.06"/>
</g>
<!-- ffn_out_2_15&#45;&gt;layer_norm_2 -->
<g id="edge226" class="edge">
<title>ffn_out_2_15&#45;&gt;layer_norm_2</title>
<path fill="none" stroke="black" d="M21895.5,-2907.63C21895.5,-2857.55 21895.5,-2755 21895.5,-2755 21895.5,-2755 23102.62,-2755 23102.62,-2755"/>
<polygon fill="black" stroke="black" points="23102.62,-2758.5 23112.62,-2755 23102.62,-2751.5 23102.62,-2758.5"/>
</g>
<!-- attention_3_0_0 -->
<g id="node206" class="node">
<title>attention_3_0_0</title>
<polygon fill="#ff9999" stroke="black" points="22964.5,-2504 22791.5,-2504 22791.5,-2436 22964.5,-2436 22964.5,-2504"/>
<text text-anchor="middle" x="22878" y="-2488.8" font-family="Times,serif" font-size="14.00">Attention 0_0</text>
<text text-anchor="middle" x="22878" y="-2473.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="22878" y="-2458.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="22878" y="-2443.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- q_proj_3_0_0&#45;&gt;attention_3_0_0 -->
<g id="edge227" class="edge">
<title>q_proj_3_0_0&#45;&gt;attention_3_0_0</title>
<path fill="none" stroke="black" d="M23166,-2590.98C23166,-2545.36 23166,-2470 23166,-2470 23166,-2470 22974.8,-2470 22974.8,-2470"/>
<polygon fill="black" stroke="black" points="22974.8,-2466.5 22964.8,-2470 22974.8,-2473.5 22974.8,-2466.5"/>
</g>
<!-- concat_group_3_0 -->
<g id="node209" class="node">
<title>concat_group_3_0</title>
<polygon fill="#ffd700" stroke="black" points="21822,-2335 21694,-2282 21822,-2229 21950,-2282 21822,-2335"/>
<text text-anchor="middle" x="21822" y="-2293.3" font-family="Times,serif" font-size="14.00">Concat Group 0</text>
<text text-anchor="middle" x="21822" y="-2278.3" font-family="Times,serif" font-size="14.00">[B×L×d×h_g]</text>
<text text-anchor="middle" x="21822" y="-2263.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- attention_3_0_0&#45;&gt;concat_group_3_0 -->
<g id="edge230" class="edge">
<title>attention_3_0_0&#45;&gt;concat_group_3_0</title>
<path fill="none" stroke="black" d="M22878,-2435.95C22878,-2381.78 22878,-2282 22878,-2282 22878,-2282 21960.17,-2282 21960.17,-2282"/>
<polygon fill="black" stroke="black" points="21960.17,-2278.5 21950.17,-2282 21960.17,-2285.5 21960.17,-2278.5"/>
</g>
<!-- k_proj_3_0_0 -->
<g id="node207" class="node">
<title>k_proj_3_0_0</title>
<polygon fill="#ff9999" stroke="black" points="23041,-2659 22907,-2659 22907,-2591 23041,-2591 23041,-2659"/>
<text text-anchor="middle" x="22974" y="-2643.8" font-family="Times,serif" font-size="14.00">K Projection 0_0</text>
<text text-anchor="middle" x="22974" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="22974" y="-2613.8" font-family="Times,serif" font-size="14.00">W_K^{0,0}</text>
<text text-anchor="middle" x="22974" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- k_proj_3_0_0&#45;&gt;attention_3_0_0 -->
<g id="edge228" class="edge">
<title>k_proj_3_0_0&#45;&gt;attention_3_0_0</title>
<path fill="none" stroke="black" d="M22935.75,-2590.98C22935.75,-2590.98 22935.75,-2514.2 22935.75,-2514.2"/>
<polygon fill="black" stroke="black" points="22939.25,-2514.2 22935.75,-2504.2 22932.25,-2514.2 22939.25,-2514.2"/>
</g>
<!-- v_proj_3_0_0 -->
<g id="node208" class="node">
<title>v_proj_3_0_0</title>
<polygon fill="#ff9999" stroke="black" points="22848.5,-2659 22715.5,-2659 22715.5,-2591 22848.5,-2591 22848.5,-2659"/>
<text text-anchor="middle" x="22782" y="-2643.8" font-family="Times,serif" font-size="14.00">V Projection 0_0</text>
<text text-anchor="middle" x="22782" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="22782" y="-2613.8" font-family="Times,serif" font-size="14.00">W_V^{0,0}</text>
<text text-anchor="middle" x="22782" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- v_proj_3_0_0&#45;&gt;attention_3_0_0 -->
<g id="edge229" class="edge">
<title>v_proj_3_0_0&#45;&gt;attention_3_0_0</title>
<path fill="none" stroke="black" d="M22820,-2590.98C22820,-2590.98 22820,-2514.2 22820,-2514.2"/>
<polygon fill="black" stroke="black" points="22823.5,-2514.2 22820,-2504.2 22816.5,-2514.2 22823.5,-2514.2"/>
</g>
<!-- final_concat_3 -->
<g id="node273" class="node">
<title>final_concat_3</title>
<polygon fill="#ffa500" stroke="black" points="18224,-2142 18059,-2089 18224,-2036 18389,-2089 18224,-2142"/>
<text text-anchor="middle" x="18224" y="-2100.3" font-family="Times,serif" font-size="14.00">Final Concat Layer 3</text>
<text text-anchor="middle" x="18224" y="-2085.3" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="18224" y="-2070.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- concat_group_3_0&#45;&gt;final_concat_3 -->
<g id="edge303" class="edge">
<title>concat_group_3_0&#45;&gt;final_concat_3</title>
<path fill="none" stroke="black" d="M21822,-2228.75C21822,-2171.62 21822,-2089 21822,-2089 21822,-2089 18399.13,-2089 18399.13,-2089"/>
<polygon fill="black" stroke="black" points="18399.13,-2085.5 18389.13,-2089 18399.13,-2092.5 18399.13,-2085.5"/>
</g>
<!-- q_proj_3_0_1 -->
<g id="node210" class="node">
<title>q_proj_3_0_1</title>
<polygon fill="#ffcc99" stroke="black" points="22657,-2659 22523,-2659 22523,-2591 22657,-2591 22657,-2659"/>
<text text-anchor="middle" x="22590" y="-2643.8" font-family="Times,serif" font-size="14.00">Q Projection 0_1</text>
<text text-anchor="middle" x="22590" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="22590" y="-2613.8" font-family="Times,serif" font-size="14.00">W_Q^{0,1}</text>
<text text-anchor="middle" x="22590" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- attention_3_0_1 -->
<g id="node211" class="node">
<title>attention_3_0_1</title>
<polygon fill="#ffcc99" stroke="black" points="22340.5,-2504 22167.5,-2504 22167.5,-2436 22340.5,-2436 22340.5,-2504"/>
<text text-anchor="middle" x="22254" y="-2488.8" font-family="Times,serif" font-size="14.00">Attention 0_1</text>
<text text-anchor="middle" x="22254" y="-2473.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="22254" y="-2458.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="22254" y="-2443.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- q_proj_3_0_1&#45;&gt;attention_3_0_1 -->
<g id="edge231" class="edge">
<title>q_proj_3_0_1&#45;&gt;attention_3_0_1</title>
<path fill="none" stroke="black" d="M22590,-2590.98C22590,-2545.36 22590,-2470 22590,-2470 22590,-2470 22350.53,-2470 22350.53,-2470"/>
<polygon fill="black" stroke="black" points="22350.53,-2466.5 22340.53,-2470 22350.53,-2473.5 22350.53,-2466.5"/>
</g>
<!-- attention_3_0_1&#45;&gt;concat_group_3_0 -->
<g id="edge234" class="edge">
<title>attention_3_0_1&#45;&gt;concat_group_3_0</title>
<path fill="none" stroke="black" d="M22167.22,-2481C22069.84,-2481 21925.33,-2481 21925.33,-2481 21925.33,-2481 21925.33,-2302.42 21925.33,-2302.42"/>
<polygon fill="black" stroke="black" points="21928.83,-2302.42 21925.33,-2292.42 21921.83,-2302.42 21928.83,-2302.42"/>
</g>
<!-- attention_3_0_1&#45;&gt;concat_group_3_0 -->
<g id="edge235" class="edge">
<title>attention_3_0_1&#45;&gt;concat_group_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M22167.15,-2458C22073.05,-2458 21936.17,-2458 21936.17,-2458 21936.17,-2458 21936.17,-2297.86 21936.17,-2297.86"/>
<polygon fill="red" stroke="red" points="21939.67,-2297.86 21936.17,-2287.86 21932.67,-2297.86 21939.67,-2297.86"/>
<text text-anchor="middle" x="22321" y="-2381.8" font-family="Times,serif" font-size="14.00">AllGather GPU0→GPU1</text>
</g>
<!-- k_proj_3_0_1 -->
<g id="node212" class="node">
<title>k_proj_3_0_1</title>
<polygon fill="#ffcc99" stroke="black" points="22465,-2659 22331,-2659 22331,-2591 22465,-2591 22465,-2659"/>
<text text-anchor="middle" x="22398" y="-2643.8" font-family="Times,serif" font-size="14.00">K Projection 0_1</text>
<text text-anchor="middle" x="22398" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="22398" y="-2613.8" font-family="Times,serif" font-size="14.00">W_K^{0,1}</text>
<text text-anchor="middle" x="22398" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- k_proj_3_0_1&#45;&gt;attention_3_0_1 -->
<g id="edge232" class="edge">
<title>k_proj_3_0_1&#45;&gt;attention_3_0_1</title>
<path fill="none" stroke="black" d="M22335.75,-2590.98C22335.75,-2590.98 22335.75,-2514.2 22335.75,-2514.2"/>
<polygon fill="black" stroke="black" points="22339.25,-2514.2 22335.75,-2504.2 22332.25,-2514.2 22339.25,-2514.2"/>
</g>
<!-- v_proj_3_0_1 -->
<g id="node213" class="node">
<title>v_proj_3_0_1</title>
<polygon fill="#ffcc99" stroke="black" points="22272.5,-2659 22139.5,-2659 22139.5,-2591 22272.5,-2591 22272.5,-2659"/>
<text text-anchor="middle" x="22206" y="-2643.8" font-family="Times,serif" font-size="14.00">V Projection 0_1</text>
<text text-anchor="middle" x="22206" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="22206" y="-2613.8" font-family="Times,serif" font-size="14.00">W_V^{0,1}</text>
<text text-anchor="middle" x="22206" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- v_proj_3_0_1&#45;&gt;attention_3_0_1 -->
<g id="edge233" class="edge">
<title>v_proj_3_0_1&#45;&gt;attention_3_0_1</title>
<path fill="none" stroke="black" d="M22220,-2590.98C22220,-2590.98 22220,-2514.2 22220,-2514.2"/>
<polygon fill="black" stroke="black" points="22223.5,-2514.2 22220,-2504.2 22216.5,-2514.2 22223.5,-2514.2"/>
</g>
<!-- q_proj_3_0_2 -->
<g id="node214" class="node">
<title>q_proj_3_0_2</title>
<polygon fill="#ffff99" stroke="black" points="22081,-2659 21947,-2659 21947,-2591 22081,-2591 22081,-2659"/>
<text text-anchor="middle" x="22014" y="-2643.8" font-family="Times,serif" font-size="14.00">Q Projection 0_2</text>
<text text-anchor="middle" x="22014" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="22014" y="-2613.8" font-family="Times,serif" font-size="14.00">W_Q^{0,2}</text>
<text text-anchor="middle" x="22014" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- attention_3_0_2 -->
<g id="node215" class="node">
<title>attention_3_0_2</title>
<polygon fill="#ffff99" stroke="black" points="21908.5,-2504 21735.5,-2504 21735.5,-2436 21908.5,-2436 21908.5,-2504"/>
<text text-anchor="middle" x="21822" y="-2488.8" font-family="Times,serif" font-size="14.00">Attention 0_2</text>
<text text-anchor="middle" x="21822" y="-2473.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="21822" y="-2458.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="21822" y="-2443.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- q_proj_3_0_2&#45;&gt;attention_3_0_2 -->
<g id="edge236" class="edge">
<title>q_proj_3_0_2&#45;&gt;attention_3_0_2</title>
<path fill="none" stroke="black" d="M21946.91,-2625C21923.06,-2625 21902,-2625 21902,-2625 21902,-2625 21902,-2514.02 21902,-2514.02"/>
<polygon fill="black" stroke="black" points="21905.5,-2514.02 21902,-2504.02 21898.5,-2514.02 21905.5,-2514.02"/>
</g>
<!-- attention_3_0_2&#45;&gt;concat_group_3_0 -->
<g id="edge239" class="edge">
<title>attention_3_0_2&#45;&gt;concat_group_3_0</title>
<path fill="none" stroke="black" d="M21793.17,-2435.95C21793.17,-2435.95 21793.17,-2333.34 21793.17,-2333.34"/>
<polygon fill="black" stroke="black" points="21796.67,-2333.34 21793.17,-2323.34 21789.67,-2333.34 21796.67,-2333.34"/>
</g>
<!-- attention_3_0_2&#45;&gt;concat_group_3_0 -->
<g id="edge240" class="edge">
<title>attention_3_0_2&#45;&gt;concat_group_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M21850.83,-2435.95C21850.83,-2435.95 21850.83,-2333.34 21850.83,-2333.34"/>
<polygon fill="red" stroke="red" points="21854.33,-2333.34 21850.83,-2323.34 21847.33,-2333.34 21854.33,-2333.34"/>
<text text-anchor="middle" x="22035" y="-2381.8" font-family="Times,serif" font-size="14.00">AllGather GPU1→GPU2</text>
</g>
<!-- k_proj_3_0_2 -->
<g id="node216" class="node">
<title>k_proj_3_0_2</title>
<polygon fill="#ffff99" stroke="black" points="21889,-2659 21755,-2659 21755,-2591 21889,-2591 21889,-2659"/>
<text text-anchor="middle" x="21822" y="-2643.8" font-family="Times,serif" font-size="14.00">K Projection 0_2</text>
<text text-anchor="middle" x="21822" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="21822" y="-2613.8" font-family="Times,serif" font-size="14.00">W_K^{0,2}</text>
<text text-anchor="middle" x="21822" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- k_proj_3_0_2&#45;&gt;attention_3_0_2 -->
<g id="edge237" class="edge">
<title>k_proj_3_0_2&#45;&gt;attention_3_0_2</title>
<path fill="none" stroke="black" d="M21822,-2590.98C21822,-2590.98 21822,-2514.2 21822,-2514.2"/>
<polygon fill="black" stroke="black" points="21825.5,-2514.2 21822,-2504.2 21818.5,-2514.2 21825.5,-2514.2"/>
</g>
<!-- v_proj_3_0_2 -->
<g id="node217" class="node">
<title>v_proj_3_0_2</title>
<polygon fill="#ffff99" stroke="black" points="21696.5,-2659 21563.5,-2659 21563.5,-2591 21696.5,-2591 21696.5,-2659"/>
<text text-anchor="middle" x="21630" y="-2643.8" font-family="Times,serif" font-size="14.00">V Projection 0_2</text>
<text text-anchor="middle" x="21630" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="21630" y="-2613.8" font-family="Times,serif" font-size="14.00">W_V^{0,2}</text>
<text text-anchor="middle" x="21630" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- v_proj_3_0_2&#45;&gt;attention_3_0_2 -->
<g id="edge238" class="edge">
<title>v_proj_3_0_2&#45;&gt;attention_3_0_2</title>
<path fill="none" stroke="black" d="M21696.71,-2625C21722.19,-2625 21745.25,-2625 21745.25,-2625 21745.25,-2625 21745.25,-2514.02 21745.25,-2514.02"/>
<polygon fill="black" stroke="black" points="21748.75,-2514.02 21745.25,-2504.02 21741.75,-2514.02 21748.75,-2514.02"/>
</g>
<!-- q_proj_3_0_3 -->
<g id="node218" class="node">
<title>q_proj_3_0_3</title>
<polygon fill="#ccff99" stroke="black" points="21505,-2659 21371,-2659 21371,-2591 21505,-2591 21505,-2659"/>
<text text-anchor="middle" x="21438" y="-2643.8" font-family="Times,serif" font-size="14.00">Q Projection 0_3</text>
<text text-anchor="middle" x="21438" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="21438" y="-2613.8" font-family="Times,serif" font-size="14.00">W_Q^{0,3}</text>
<text text-anchor="middle" x="21438" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- attention_3_0_3 -->
<g id="node219" class="node">
<title>attention_3_0_3</title>
<polygon fill="#ccff99" stroke="black" points="21429.5,-2504 21256.5,-2504 21256.5,-2436 21429.5,-2436 21429.5,-2504"/>
<text text-anchor="middle" x="21343" y="-2488.8" font-family="Times,serif" font-size="14.00">Attention 0_3</text>
<text text-anchor="middle" x="21343" y="-2473.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="21343" y="-2458.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="21343" y="-2443.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- q_proj_3_0_3&#45;&gt;attention_3_0_3 -->
<g id="edge241" class="edge">
<title>q_proj_3_0_3&#45;&gt;attention_3_0_3</title>
<path fill="none" stroke="black" d="M21400.25,-2590.98C21400.25,-2590.98 21400.25,-2514.2 21400.25,-2514.2"/>
<polygon fill="black" stroke="black" points="21403.75,-2514.2 21400.25,-2504.2 21396.75,-2514.2 21403.75,-2514.2"/>
</g>
<!-- attention_3_0_3&#45;&gt;concat_group_3_0 -->
<g id="edge244" class="edge">
<title>attention_3_0_3&#45;&gt;concat_group_3_0</title>
<path fill="none" stroke="black" d="M21429.59,-2481C21541.59,-2481 21722.5,-2481 21722.5,-2481 21722.5,-2481 21722.5,-2303.85 21722.5,-2303.85"/>
<polygon fill="black" stroke="black" points="21726,-2303.85 21722.5,-2293.85 21719,-2303.85 21726,-2303.85"/>
</g>
<!-- attention_3_0_3&#45;&gt;concat_group_3_0 -->
<g id="edge245" class="edge">
<title>attention_3_0_3&#45;&gt;concat_group_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M21429.86,-2458C21538.23,-2458 21709.5,-2458 21709.5,-2458 21709.5,-2458 21709.5,-2298.68 21709.5,-2298.68"/>
<polygon fill="red" stroke="red" points="21713,-2298.68 21709.5,-2288.68 21706,-2298.68 21713,-2298.68"/>
<text text-anchor="middle" x="21659" y="-2381.8" font-family="Times,serif" font-size="14.00">AllGather GPU2→GPU3</text>
</g>
<!-- k_proj_3_0_3 -->
<g id="node220" class="node">
<title>k_proj_3_0_3</title>
<polygon fill="#ccff99" stroke="black" points="21313,-2659 21179,-2659 21179,-2591 21313,-2591 21313,-2659"/>
<text text-anchor="middle" x="21246" y="-2643.8" font-family="Times,serif" font-size="14.00">K Projection 0_3</text>
<text text-anchor="middle" x="21246" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="21246" y="-2613.8" font-family="Times,serif" font-size="14.00">W_K^{0,3}</text>
<text text-anchor="middle" x="21246" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- k_proj_3_0_3&#45;&gt;attention_3_0_3 -->
<g id="edge242" class="edge">
<title>k_proj_3_0_3&#45;&gt;attention_3_0_3</title>
<path fill="none" stroke="black" d="M21284.75,-2590.98C21284.75,-2590.98 21284.75,-2514.2 21284.75,-2514.2"/>
<polygon fill="black" stroke="black" points="21288.25,-2514.2 21284.75,-2504.2 21281.25,-2514.2 21288.25,-2514.2"/>
</g>
<!-- v_proj_3_0_3 -->
<g id="node221" class="node">
<title>v_proj_3_0_3</title>
<polygon fill="#ccff99" stroke="black" points="21120.5,-2659 20987.5,-2659 20987.5,-2591 21120.5,-2591 21120.5,-2659"/>
<text text-anchor="middle" x="21054" y="-2643.8" font-family="Times,serif" font-size="14.00">V Projection 0_3</text>
<text text-anchor="middle" x="21054" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="21054" y="-2613.8" font-family="Times,serif" font-size="14.00">W_V^{0,3}</text>
<text text-anchor="middle" x="21054" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- v_proj_3_0_3&#45;&gt;attention_3_0_3 -->
<g id="edge243" class="edge">
<title>v_proj_3_0_3&#45;&gt;attention_3_0_3</title>
<path fill="none" stroke="black" d="M21054,-2590.87C21054,-2548.29 21054,-2481 21054,-2481 21054,-2481 21246.29,-2481 21246.29,-2481"/>
<polygon fill="black" stroke="black" points="21246.29,-2484.5 21256.29,-2481 21246.29,-2477.5 21246.29,-2484.5"/>
</g>
<!-- q_proj_3_1_0 -->
<g id="node222" class="node">
<title>q_proj_3_1_0</title>
<polygon fill="#99ff99" stroke="black" points="20929,-2659 20795,-2659 20795,-2591 20929,-2591 20929,-2659"/>
<text text-anchor="middle" x="20862" y="-2643.8" font-family="Times,serif" font-size="14.00">Q Projection 1_0</text>
<text text-anchor="middle" x="20862" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="20862" y="-2613.8" font-family="Times,serif" font-size="14.00">W_Q^{1,0}</text>
<text text-anchor="middle" x="20862" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- attention_3_1_0 -->
<g id="node223" class="node">
<title>attention_3_1_0</title>
<polygon fill="#99ff99" stroke="black" points="20661.5,-2504 20488.5,-2504 20488.5,-2436 20661.5,-2436 20661.5,-2504"/>
<text text-anchor="middle" x="20575" y="-2488.8" font-family="Times,serif" font-size="14.00">Attention 1_0</text>
<text text-anchor="middle" x="20575" y="-2473.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="20575" y="-2458.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="20575" y="-2443.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- q_proj_3_1_0&#45;&gt;attention_3_1_0 -->
<g id="edge246" class="edge">
<title>q_proj_3_1_0&#45;&gt;attention_3_1_0</title>
<path fill="none" stroke="black" d="M20862,-2590.8C20862,-2541.94 20862,-2458 20862,-2458 20862,-2458 20671.89,-2458 20671.89,-2458"/>
<polygon fill="black" stroke="black" points="20671.89,-2454.5 20661.89,-2458 20671.89,-2461.5 20671.89,-2454.5"/>
</g>
<!-- concat_group_3_1 -->
<g id="node226" class="node">
<title>concat_group_3_1</title>
<polygon fill="#ffd700" stroke="black" points="19518,-2335 19390,-2282 19518,-2229 19646,-2282 19518,-2335"/>
<text text-anchor="middle" x="19518" y="-2293.3" font-family="Times,serif" font-size="14.00">Concat Group 1</text>
<text text-anchor="middle" x="19518" y="-2278.3" font-family="Times,serif" font-size="14.00">[B×L×d×h_g]</text>
<text text-anchor="middle" x="19518" y="-2263.3" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- attention_3_1_0&#45;&gt;concat_group_3_1 -->
<g id="edge249" class="edge">
<title>attention_3_1_0&#45;&gt;concat_group_3_1</title>
<path fill="none" stroke="black" d="M20575,-2435.95C20575,-2381.78 20575,-2282 20575,-2282 20575,-2282 19656.03,-2282 19656.03,-2282"/>
<polygon fill="black" stroke="black" points="19656.03,-2278.5 19646.03,-2282 19656.03,-2285.5 19656.03,-2278.5"/>
</g>
<!-- k_proj_3_1_0 -->
<g id="node224" class="node">
<title>k_proj_3_1_0</title>
<polygon fill="#99ff99" stroke="black" points="20737,-2659 20603,-2659 20603,-2591 20737,-2591 20737,-2659"/>
<text text-anchor="middle" x="20670" y="-2643.8" font-family="Times,serif" font-size="14.00">K Projection 1_0</text>
<text text-anchor="middle" x="20670" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="20670" y="-2613.8" font-family="Times,serif" font-size="14.00">W_K^{1,0}</text>
<text text-anchor="middle" x="20670" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- k_proj_3_1_0&#45;&gt;attention_3_1_0 -->
<g id="edge247" class="edge">
<title>k_proj_3_1_0&#45;&gt;attention_3_1_0</title>
<path fill="none" stroke="black" d="M20632.25,-2590.98C20632.25,-2590.98 20632.25,-2514.2 20632.25,-2514.2"/>
<polygon fill="black" stroke="black" points="20635.75,-2514.2 20632.25,-2504.2 20628.75,-2514.2 20635.75,-2514.2"/>
</g>
<!-- v_proj_3_1_0 -->
<g id="node225" class="node">
<title>v_proj_3_1_0</title>
<polygon fill="#99ff99" stroke="black" points="20544.5,-2659 20411.5,-2659 20411.5,-2591 20544.5,-2591 20544.5,-2659"/>
<text text-anchor="middle" x="20478" y="-2643.8" font-family="Times,serif" font-size="14.00">V Projection 1_0</text>
<text text-anchor="middle" x="20478" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="20478" y="-2613.8" font-family="Times,serif" font-size="14.00">W_V^{1,0}</text>
<text text-anchor="middle" x="20478" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- v_proj_3_1_0&#45;&gt;attention_3_1_0 -->
<g id="edge248" class="edge">
<title>v_proj_3_1_0&#45;&gt;attention_3_1_0</title>
<path fill="none" stroke="black" d="M20516.5,-2590.98C20516.5,-2590.98 20516.5,-2514.2 20516.5,-2514.2"/>
<polygon fill="black" stroke="black" points="20520,-2514.2 20516.5,-2504.2 20513,-2514.2 20520,-2514.2"/>
</g>
<!-- concat_group_3_1&#45;&gt;final_concat_3 -->
<g id="edge305" class="edge">
<title>concat_group_3_1&#45;&gt;final_concat_3</title>
<path fill="none" stroke="black" d="M19389.92,-2282C19092.4,-2282 18379.75,-2282 18379.75,-2282 18379.75,-2282 18379.75,-2102.03 18379.75,-2102.03"/>
<polygon fill="black" stroke="black" points="18383.25,-2102.03 18379.75,-2092.03 18376.25,-2102.03 18383.25,-2102.03"/>
</g>
<!-- q_proj_3_1_1 -->
<g id="node227" class="node">
<title>q_proj_3_1_1</title>
<polygon fill="#99ffcc" stroke="black" points="20353,-2659 20219,-2659 20219,-2591 20353,-2591 20353,-2659"/>
<text text-anchor="middle" x="20286" y="-2643.8" font-family="Times,serif" font-size="14.00">Q Projection 1_1</text>
<text text-anchor="middle" x="20286" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="20286" y="-2613.8" font-family="Times,serif" font-size="14.00">W_Q^{1,1}</text>
<text text-anchor="middle" x="20286" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- attention_3_1_1 -->
<g id="node228" class="node">
<title>attention_3_1_1</title>
<polygon fill="#99ffcc" stroke="black" points="20057.5,-2504 19884.5,-2504 19884.5,-2436 20057.5,-2436 20057.5,-2504"/>
<text text-anchor="middle" x="19971" y="-2488.8" font-family="Times,serif" font-size="14.00">Attention 1_1</text>
<text text-anchor="middle" x="19971" y="-2473.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="19971" y="-2458.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="19971" y="-2443.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- q_proj_3_1_1&#45;&gt;attention_3_1_1 -->
<g id="edge250" class="edge">
<title>q_proj_3_1_1&#45;&gt;attention_3_1_1</title>
<path fill="none" stroke="black" d="M20286,-2590.98C20286,-2545.36 20286,-2470 20286,-2470 20286,-2470 20067.91,-2470 20067.91,-2470"/>
<polygon fill="black" stroke="black" points="20067.91,-2466.5 20057.91,-2470 20067.91,-2473.5 20067.91,-2466.5"/>
</g>
<!-- attention_3_1_1&#45;&gt;concat_group_3_1 -->
<g id="edge253" class="edge">
<title>attention_3_1_1&#45;&gt;concat_group_3_1</title>
<path fill="none" stroke="black" d="M19884.48,-2481C19779.78,-2481 19617.33,-2481 19617.33,-2481 19617.33,-2481 19617.33,-2304.15 19617.33,-2304.15"/>
<polygon fill="black" stroke="black" points="19620.83,-2304.15 19617.33,-2294.15 19613.83,-2304.15 19620.83,-2304.15"/>
</g>
<!-- attention_3_1_1&#45;&gt;concat_group_3_1 -->
<g id="edge254" class="edge">
<title>attention_3_1_1&#45;&gt;concat_group_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19884.11,-2458C19783.13,-2458 19630.17,-2458 19630.17,-2458 19630.17,-2458 19630.17,-2298.68 19630.17,-2298.68"/>
<polygon fill="red" stroke="red" points="19633.67,-2298.68 19630.17,-2288.68 19626.67,-2298.68 19633.67,-2298.68"/>
<text text-anchor="middle" x="20163" y="-2381.8" font-family="Times,serif" font-size="14.00">AllGather GPU4→GPU5</text>
</g>
<!-- k_proj_3_1_1 -->
<g id="node229" class="node">
<title>k_proj_3_1_1</title>
<polygon fill="#99ffcc" stroke="black" points="20161,-2659 20027,-2659 20027,-2591 20161,-2591 20161,-2659"/>
<text text-anchor="middle" x="20094" y="-2643.8" font-family="Times,serif" font-size="14.00">K Projection 1_1</text>
<text text-anchor="middle" x="20094" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="20094" y="-2613.8" font-family="Times,serif" font-size="14.00">W_K^{1,1}</text>
<text text-anchor="middle" x="20094" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- k_proj_3_1_1&#45;&gt;attention_3_1_1 -->
<g id="edge251" class="edge">
<title>k_proj_3_1_1&#45;&gt;attention_3_1_1</title>
<path fill="none" stroke="black" d="M20042.25,-2590.98C20042.25,-2590.98 20042.25,-2514.2 20042.25,-2514.2"/>
<polygon fill="black" stroke="black" points="20045.75,-2514.2 20042.25,-2504.2 20038.75,-2514.2 20045.75,-2514.2"/>
</g>
<!-- v_proj_3_1_1 -->
<g id="node230" class="node">
<title>v_proj_3_1_1</title>
<polygon fill="#99ffcc" stroke="black" points="19968.5,-2659 19835.5,-2659 19835.5,-2591 19968.5,-2591 19968.5,-2659"/>
<text text-anchor="middle" x="19902" y="-2643.8" font-family="Times,serif" font-size="14.00">V Projection 1_1</text>
<text text-anchor="middle" x="19902" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="19902" y="-2613.8" font-family="Times,serif" font-size="14.00">W_V^{1,1}</text>
<text text-anchor="middle" x="19902" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- v_proj_3_1_1&#45;&gt;attention_3_1_1 -->
<g id="edge252" class="edge">
<title>v_proj_3_1_1&#45;&gt;attention_3_1_1</title>
<path fill="none" stroke="black" d="M19926.5,-2590.98C19926.5,-2590.98 19926.5,-2514.2 19926.5,-2514.2"/>
<polygon fill="black" stroke="black" points="19930,-2514.2 19926.5,-2504.2 19923,-2514.2 19930,-2514.2"/>
</g>
<!-- q_proj_3_1_2 -->
<g id="node231" class="node">
<title>q_proj_3_1_2</title>
<polygon fill="#99ffff" stroke="black" points="19777,-2659 19643,-2659 19643,-2591 19777,-2591 19777,-2659"/>
<text text-anchor="middle" x="19710" y="-2643.8" font-family="Times,serif" font-size="14.00">Q Projection 1_2</text>
<text text-anchor="middle" x="19710" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="19710" y="-2613.8" font-family="Times,serif" font-size="14.00">W_Q^{1,2}</text>
<text text-anchor="middle" x="19710" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- attention_3_1_2 -->
<g id="node232" class="node">
<title>attention_3_1_2</title>
<polygon fill="#99ffff" stroke="black" points="19604.5,-2504 19431.5,-2504 19431.5,-2436 19604.5,-2436 19604.5,-2504"/>
<text text-anchor="middle" x="19518" y="-2488.8" font-family="Times,serif" font-size="14.00">Attention 1_2</text>
<text text-anchor="middle" x="19518" y="-2473.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="19518" y="-2458.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="19518" y="-2443.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- q_proj_3_1_2&#45;&gt;attention_3_1_2 -->
<g id="edge255" class="edge">
<title>q_proj_3_1_2&#45;&gt;attention_3_1_2</title>
<path fill="none" stroke="black" d="M19642.96,-2625C19617.6,-2625 19594.75,-2625 19594.75,-2625 19594.75,-2625 19594.75,-2514.02 19594.75,-2514.02"/>
<polygon fill="black" stroke="black" points="19598.25,-2514.02 19594.75,-2504.02 19591.25,-2514.02 19598.25,-2514.02"/>
</g>
<!-- attention_3_1_2&#45;&gt;concat_group_3_1 -->
<g id="edge258" class="edge">
<title>attention_3_1_2&#45;&gt;concat_group_3_1</title>
<path fill="none" stroke="black" d="M19489.17,-2435.95C19489.17,-2435.95 19489.17,-2333.34 19489.17,-2333.34"/>
<polygon fill="black" stroke="black" points="19492.67,-2333.34 19489.17,-2323.34 19485.67,-2333.34 19492.67,-2333.34"/>
</g>
<!-- attention_3_1_2&#45;&gt;concat_group_3_1 -->
<g id="edge259" class="edge">
<title>attention_3_1_2&#45;&gt;concat_group_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19546.83,-2435.95C19546.83,-2435.95 19546.83,-2333.34 19546.83,-2333.34"/>
<polygon fill="red" stroke="red" points="19550.33,-2333.34 19546.83,-2323.34 19543.33,-2333.34 19550.33,-2333.34"/>
<text text-anchor="middle" x="19697" y="-2381.8" font-family="Times,serif" font-size="14.00">AllGather GPU5→GPU6</text>
</g>
<!-- k_proj_3_1_2 -->
<g id="node233" class="node">
<title>k_proj_3_1_2</title>
<polygon fill="#99ffff" stroke="black" points="19585,-2659 19451,-2659 19451,-2591 19585,-2591 19585,-2659"/>
<text text-anchor="middle" x="19518" y="-2643.8" font-family="Times,serif" font-size="14.00">K Projection 1_2</text>
<text text-anchor="middle" x="19518" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="19518" y="-2613.8" font-family="Times,serif" font-size="14.00">W_K^{1,2}</text>
<text text-anchor="middle" x="19518" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- k_proj_3_1_2&#45;&gt;attention_3_1_2 -->
<g id="edge256" class="edge">
<title>k_proj_3_1_2&#45;&gt;attention_3_1_2</title>
<path fill="none" stroke="black" d="M19518,-2590.98C19518,-2590.98 19518,-2514.2 19518,-2514.2"/>
<polygon fill="black" stroke="black" points="19521.5,-2514.2 19518,-2504.2 19514.5,-2514.2 19521.5,-2514.2"/>
</g>
<!-- v_proj_3_1_2 -->
<g id="node234" class="node">
<title>v_proj_3_1_2</title>
<polygon fill="#99ffff" stroke="black" points="19392.5,-2659 19259.5,-2659 19259.5,-2591 19392.5,-2591 19392.5,-2659"/>
<text text-anchor="middle" x="19326" y="-2643.8" font-family="Times,serif" font-size="14.00">V Projection 1_2</text>
<text text-anchor="middle" x="19326" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="19326" y="-2613.8" font-family="Times,serif" font-size="14.00">W_V^{1,2}</text>
<text text-anchor="middle" x="19326" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- v_proj_3_1_2&#45;&gt;attention_3_1_2 -->
<g id="edge257" class="edge">
<title>v_proj_3_1_2&#45;&gt;attention_3_1_2</title>
<path fill="none" stroke="black" d="M19392.71,-2625C19418.19,-2625 19441.25,-2625 19441.25,-2625 19441.25,-2625 19441.25,-2514.02 19441.25,-2514.02"/>
<polygon fill="black" stroke="black" points="19444.75,-2514.02 19441.25,-2504.02 19437.75,-2514.02 19444.75,-2514.02"/>
</g>
<!-- q_proj_3_1_3 -->
<g id="node235" class="node">
<title>q_proj_3_1_3</title>
<polygon fill="#99ccff" stroke="black" points="19201,-2659 19067,-2659 19067,-2591 19201,-2591 19201,-2659"/>
<text text-anchor="middle" x="19134" y="-2643.8" font-family="Times,serif" font-size="14.00">Q Projection 1_3</text>
<text text-anchor="middle" x="19134" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="19134" y="-2613.8" font-family="Times,serif" font-size="14.00">W_Q^{1,3}</text>
<text text-anchor="middle" x="19134" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- attention_3_1_3 -->
<g id="node236" class="node">
<title>attention_3_1_3</title>
<polygon fill="#99ccff" stroke="black" points="19091.5,-2504 18918.5,-2504 18918.5,-2436 19091.5,-2436 19091.5,-2504"/>
<text text-anchor="middle" x="19005" y="-2488.8" font-family="Times,serif" font-size="14.00">Attention 1_3</text>
<text text-anchor="middle" x="19005" y="-2473.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="19005" y="-2458.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="19005" y="-2443.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- q_proj_3_1_3&#45;&gt;attention_3_1_3 -->
<g id="edge260" class="edge">
<title>q_proj_3_1_3&#45;&gt;attention_3_1_3</title>
<path fill="none" stroke="black" d="M19079.25,-2590.98C19079.25,-2590.98 19079.25,-2514.2 19079.25,-2514.2"/>
<polygon fill="black" stroke="black" points="19082.75,-2514.2 19079.25,-2504.2 19075.75,-2514.2 19082.75,-2514.2"/>
</g>
<!-- attention_3_1_3&#45;&gt;concat_group_3_1 -->
<g id="edge263" class="edge">
<title>attention_3_1_3&#45;&gt;concat_group_3_1</title>
<path fill="none" stroke="black" d="M19091.68,-2481C19212.93,-2481 19418.5,-2481 19418.5,-2481 19418.5,-2481 19418.5,-2303.85 19418.5,-2303.85"/>
<polygon fill="black" stroke="black" points="19422,-2303.85 19418.5,-2293.85 19415,-2303.85 19422,-2303.85"/>
</g>
<!-- attention_3_1_3&#45;&gt;concat_group_3_1 -->
<g id="edge264" class="edge">
<title>attention_3_1_3&#45;&gt;concat_group_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19091.9,-2458C19209.69,-2458 19405.5,-2458 19405.5,-2458 19405.5,-2458 19405.5,-2298.68 19405.5,-2298.68"/>
<polygon fill="red" stroke="red" points="19409,-2298.68 19405.5,-2288.68 19402,-2298.68 19409,-2298.68"/>
<text text-anchor="middle" x="19259" y="-2381.8" font-family="Times,serif" font-size="14.00">AllGather GPU6→GPU7</text>
</g>
<!-- k_proj_3_1_3 -->
<g id="node237" class="node">
<title>k_proj_3_1_3</title>
<polygon fill="#99ccff" stroke="black" points="19009,-2659 18875,-2659 18875,-2591 19009,-2591 19009,-2659"/>
<text text-anchor="middle" x="18942" y="-2643.8" font-family="Times,serif" font-size="14.00">K Projection 1_3</text>
<text text-anchor="middle" x="18942" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="18942" y="-2613.8" font-family="Times,serif" font-size="14.00">W_K^{1,3}</text>
<text text-anchor="middle" x="18942" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- k_proj_3_1_3&#45;&gt;attention_3_1_3 -->
<g id="edge261" class="edge">
<title>k_proj_3_1_3&#45;&gt;attention_3_1_3</title>
<path fill="none" stroke="black" d="M18963.75,-2590.98C18963.75,-2590.98 18963.75,-2514.2 18963.75,-2514.2"/>
<polygon fill="black" stroke="black" points="18967.25,-2514.2 18963.75,-2504.2 18960.25,-2514.2 18967.25,-2514.2"/>
</g>
<!-- v_proj_3_1_3 -->
<g id="node238" class="node">
<title>v_proj_3_1_3</title>
<polygon fill="#99ccff" stroke="black" points="18816.5,-2659 18683.5,-2659 18683.5,-2591 18816.5,-2591 18816.5,-2659"/>
<text text-anchor="middle" x="18750" y="-2643.8" font-family="Times,serif" font-size="14.00">V Projection 1_3</text>
<text text-anchor="middle" x="18750" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="18750" y="-2613.8" font-family="Times,serif" font-size="14.00">W_V^{1,3}</text>
<text text-anchor="middle" x="18750" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- v_proj_3_1_3&#45;&gt;attention_3_1_3 -->
<g id="edge262" class="edge">
<title>v_proj_3_1_3&#45;&gt;attention_3_1_3</title>
<path fill="none" stroke="black" d="M18750,-2590.8C18750,-2541.94 18750,-2458 18750,-2458 18750,-2458 18908.31,-2458 18908.31,-2458"/>
<polygon fill="black" stroke="black" points="18908.31,-2461.5 18918.31,-2458 18908.31,-2454.5 18908.31,-2461.5"/>
</g>
<!-- q_proj_3_2_0 -->
<g id="node239" class="node">
<title>q_proj_3_2_0</title>
<polygon fill="#9999ff" stroke="black" points="18625,-2659 18491,-2659 18491,-2591 18625,-2591 18625,-2659"/>
<text text-anchor="middle" x="18558" y="-2643.8" font-family="Times,serif" font-size="14.00">Q Projection 2_0</text>
<text text-anchor="middle" x="18558" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="18558" y="-2613.8" font-family="Times,serif" font-size="14.00">W_Q^{2,0}</text>
<text text-anchor="middle" x="18558" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- attention_3_2_0 -->
<g id="node240" class="node">
<title>attention_3_2_0</title>
<polygon fill="#9999ff" stroke="black" points="18370.5,-2504 18197.5,-2504 18197.5,-2436 18370.5,-2436 18370.5,-2504"/>
<text text-anchor="middle" x="18284" y="-2488.8" font-family="Times,serif" font-size="14.00">Attention 2_0</text>
<text text-anchor="middle" x="18284" y="-2473.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="18284" y="-2458.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="18284" y="-2443.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- q_proj_3_2_0&#45;&gt;attention_3_2_0 -->
<g id="edge265" class="edge">
<title>q_proj_3_2_0&#45;&gt;attention_3_2_0</title>
<path fill="none" stroke="black" d="M18558,-2590.87C18558,-2548.29 18558,-2481 18558,-2481 18558,-2481 18380.7,-2481 18380.7,-2481"/>
<polygon fill="black" stroke="black" points="18380.7,-2477.5 18370.7,-2481 18380.7,-2484.5 18380.7,-2477.5"/>
</g>
<!-- concat_group_3_2 -->
<g id="node243" class="node">
<title>concat_group_3_2</title>
<polygon fill="#ffd700" stroke="black" points="17790,-2335 17662,-2282 17790,-2229 17918,-2282 17790,-2335"/>
<text text-anchor="middle" x="17790" y="-2293.3" font-family="Times,serif" font-size="14.00">Concat Group 2</text>
<text text-anchor="middle" x="17790" y="-2278.3" font-family="Times,serif" font-size="14.00">[B×L×d×h_g]</text>
<text text-anchor="middle" x="17790" y="-2263.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;11</text>
</g>
<!-- attention_3_2_0&#45;&gt;concat_group_3_2 -->
<g id="edge268" class="edge">
<title>attention_3_2_0&#45;&gt;concat_group_3_2</title>
<path fill="none" stroke="black" d="M18197.35,-2470C18082.93,-2470 17895.75,-2470 17895.75,-2470 17895.75,-2470 17895.75,-2301.32 17895.75,-2301.32"/>
<polygon fill="black" stroke="black" points="17899.25,-2301.32 17895.75,-2291.32 17892.25,-2301.32 17899.25,-2301.32"/>
</g>
<!-- k_proj_3_2_0 -->
<g id="node241" class="node">
<title>k_proj_3_2_0</title>
<polygon fill="#9999ff" stroke="black" points="18433,-2659 18299,-2659 18299,-2591 18433,-2591 18433,-2659"/>
<text text-anchor="middle" x="18366" y="-2643.8" font-family="Times,serif" font-size="14.00">K Projection 2_0</text>
<text text-anchor="middle" x="18366" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="18366" y="-2613.8" font-family="Times,serif" font-size="14.00">W_K^{2,0}</text>
<text text-anchor="middle" x="18366" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- k_proj_3_2_0&#45;&gt;attention_3_2_0 -->
<g id="edge266" class="edge">
<title>k_proj_3_2_0&#45;&gt;attention_3_2_0</title>
<path fill="none" stroke="black" d="M18334.75,-2590.98C18334.75,-2590.98 18334.75,-2514.2 18334.75,-2514.2"/>
<polygon fill="black" stroke="black" points="18338.25,-2514.2 18334.75,-2504.2 18331.25,-2514.2 18338.25,-2514.2"/>
</g>
<!-- v_proj_3_2_0 -->
<g id="node242" class="node">
<title>v_proj_3_2_0</title>
<polygon fill="#9999ff" stroke="black" points="18240.5,-2659 18107.5,-2659 18107.5,-2591 18240.5,-2591 18240.5,-2659"/>
<text text-anchor="middle" x="18174" y="-2643.8" font-family="Times,serif" font-size="14.00">V Projection 2_0</text>
<text text-anchor="middle" x="18174" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="18174" y="-2613.8" font-family="Times,serif" font-size="14.00">W_V^{2,0}</text>
<text text-anchor="middle" x="18174" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- v_proj_3_2_0&#45;&gt;attention_3_2_0 -->
<g id="edge267" class="edge">
<title>v_proj_3_2_0&#45;&gt;attention_3_2_0</title>
<path fill="none" stroke="black" d="M18219,-2590.98C18219,-2590.98 18219,-2514.2 18219,-2514.2"/>
<polygon fill="black" stroke="black" points="18222.5,-2514.2 18219,-2504.2 18215.5,-2514.2 18222.5,-2514.2"/>
</g>
<!-- concat_group_3_2&#45;&gt;final_concat_3 -->
<g id="edge306" class="edge">
<title>concat_group_3_2&#45;&gt;final_concat_3</title>
<path fill="none" stroke="black" d="M17913.75,-2280.02C17913.75,-2260.69 17913.75,-2106 17913.75,-2106 17913.75,-2106 18101.55,-2106 18101.55,-2106"/>
<polygon fill="black" stroke="black" points="18101.55,-2109.5 18111.55,-2106 18101.55,-2102.5 18101.55,-2109.5"/>
</g>
<!-- q_proj_3_2_1 -->
<g id="node244" class="node">
<title>q_proj_3_2_1</title>
<polygon fill="#cc99ff" stroke="black" points="18049,-2659 17915,-2659 17915,-2591 18049,-2591 18049,-2659"/>
<text text-anchor="middle" x="17982" y="-2643.8" font-family="Times,serif" font-size="14.00">Q Projection 2_1</text>
<text text-anchor="middle" x="17982" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="17982" y="-2613.8" font-family="Times,serif" font-size="14.00">W_Q^{2,1}</text>
<text text-anchor="middle" x="17982" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- attention_3_2_1 -->
<g id="node245" class="node">
<title>attention_3_2_1</title>
<polygon fill="#cc99ff" stroke="black" points="17876.5,-2504 17703.5,-2504 17703.5,-2436 17876.5,-2436 17876.5,-2504"/>
<text text-anchor="middle" x="17790" y="-2488.8" font-family="Times,serif" font-size="14.00">Attention 2_1</text>
<text text-anchor="middle" x="17790" y="-2473.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="17790" y="-2458.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="17790" y="-2443.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- q_proj_3_2_1&#45;&gt;attention_3_2_1 -->
<g id="edge269" class="edge">
<title>q_proj_3_2_1&#45;&gt;attention_3_2_1</title>
<path fill="none" stroke="black" d="M17914.96,-2625C17889.6,-2625 17866.75,-2625 17866.75,-2625 17866.75,-2625 17866.75,-2514.02 17866.75,-2514.02"/>
<polygon fill="black" stroke="black" points="17870.25,-2514.02 17866.75,-2504.02 17863.25,-2514.02 17870.25,-2514.02"/>
</g>
<!-- attention_3_2_1&#45;&gt;concat_group_3_2 -->
<g id="edge272" class="edge">
<title>attention_3_2_1&#45;&gt;concat_group_3_2</title>
<path fill="none" stroke="black" d="M17761.17,-2435.95C17761.17,-2435.95 17761.17,-2333.34 17761.17,-2333.34"/>
<polygon fill="black" stroke="black" points="17764.67,-2333.34 17761.17,-2323.34 17757.67,-2333.34 17764.67,-2333.34"/>
</g>
<!-- attention_3_2_1&#45;&gt;concat_group_3_2 -->
<g id="edge273" class="edge">
<title>attention_3_2_1&#45;&gt;concat_group_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17818.83,-2435.95C17818.83,-2435.95 17818.83,-2333.34 17818.83,-2333.34"/>
<polygon fill="red" stroke="red" points="17822.33,-2333.34 17818.83,-2323.34 17815.33,-2333.34 17822.33,-2333.34"/>
<text text-anchor="middle" x="17975" y="-2381.8" font-family="Times,serif" font-size="14.00">AllGather GPU8→GPU9</text>
</g>
<!-- k_proj_3_2_1 -->
<g id="node246" class="node">
<title>k_proj_3_2_1</title>
<polygon fill="#cc99ff" stroke="black" points="17857,-2659 17723,-2659 17723,-2591 17857,-2591 17857,-2659"/>
<text text-anchor="middle" x="17790" y="-2643.8" font-family="Times,serif" font-size="14.00">K Projection 2_1</text>
<text text-anchor="middle" x="17790" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="17790" y="-2613.8" font-family="Times,serif" font-size="14.00">W_K^{2,1}</text>
<text text-anchor="middle" x="17790" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- k_proj_3_2_1&#45;&gt;attention_3_2_1 -->
<g id="edge270" class="edge">
<title>k_proj_3_2_1&#45;&gt;attention_3_2_1</title>
<path fill="none" stroke="black" d="M17790,-2590.98C17790,-2590.98 17790,-2514.2 17790,-2514.2"/>
<polygon fill="black" stroke="black" points="17793.5,-2514.2 17790,-2504.2 17786.5,-2514.2 17793.5,-2514.2"/>
</g>
<!-- v_proj_3_2_1 -->
<g id="node247" class="node">
<title>v_proj_3_2_1</title>
<polygon fill="#cc99ff" stroke="black" points="17664.5,-2659 17531.5,-2659 17531.5,-2591 17664.5,-2591 17664.5,-2659"/>
<text text-anchor="middle" x="17598" y="-2643.8" font-family="Times,serif" font-size="14.00">V Projection 2_1</text>
<text text-anchor="middle" x="17598" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="17598" y="-2613.8" font-family="Times,serif" font-size="14.00">W_V^{2,1}</text>
<text text-anchor="middle" x="17598" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- v_proj_3_2_1&#45;&gt;attention_3_2_1 -->
<g id="edge271" class="edge">
<title>v_proj_3_2_1&#45;&gt;attention_3_2_1</title>
<path fill="none" stroke="black" d="M17664.71,-2625C17690.19,-2625 17713.25,-2625 17713.25,-2625 17713.25,-2625 17713.25,-2514.02 17713.25,-2514.02"/>
<polygon fill="black" stroke="black" points="17716.75,-2514.02 17713.25,-2504.02 17709.75,-2514.02 17716.75,-2514.02"/>
</g>
<!-- q_proj_3_2_2 -->
<g id="node248" class="node">
<title>q_proj_3_2_2</title>
<polygon fill="#ff99ff" stroke="black" points="17473,-2659 17339,-2659 17339,-2591 17473,-2591 17473,-2659"/>
<text text-anchor="middle" x="17406" y="-2643.8" font-family="Times,serif" font-size="14.00">Q Projection 2_2</text>
<text text-anchor="middle" x="17406" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="17406" y="-2613.8" font-family="Times,serif" font-size="14.00">W_Q^{2,2}</text>
<text text-anchor="middle" x="17406" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- attention_3_2_2 -->
<g id="node249" class="node">
<title>attention_3_2_2</title>
<polygon fill="#ff99ff" stroke="black" points="17362.5,-2504 17189.5,-2504 17189.5,-2436 17362.5,-2436 17362.5,-2504"/>
<text text-anchor="middle" x="17276" y="-2488.8" font-family="Times,serif" font-size="14.00">Attention 2_2</text>
<text text-anchor="middle" x="17276" y="-2473.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="17276" y="-2458.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="17276" y="-2443.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- q_proj_3_2_2&#45;&gt;attention_3_2_2 -->
<g id="edge274" class="edge">
<title>q_proj_3_2_2&#45;&gt;attention_3_2_2</title>
<path fill="none" stroke="black" d="M17350.75,-2590.98C17350.75,-2590.98 17350.75,-2514.2 17350.75,-2514.2"/>
<polygon fill="black" stroke="black" points="17354.25,-2514.2 17350.75,-2504.2 17347.25,-2514.2 17354.25,-2514.2"/>
</g>
<!-- attention_3_2_2&#45;&gt;concat_group_3_2 -->
<g id="edge277" class="edge">
<title>attention_3_2_2&#45;&gt;concat_group_3_2</title>
<path fill="none" stroke="black" d="M17362.64,-2481C17484.15,-2481 17690.5,-2481 17690.5,-2481 17690.5,-2481 17690.5,-2303.85 17690.5,-2303.85"/>
<polygon fill="black" stroke="black" points="17694,-2303.85 17690.5,-2293.85 17687,-2303.85 17694,-2303.85"/>
</g>
<!-- attention_3_2_2&#45;&gt;concat_group_3_2 -->
<g id="edge278" class="edge">
<title>attention_3_2_2&#45;&gt;concat_group_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17362.63,-2458C17480.66,-2458 17677.5,-2458 17677.5,-2458 17677.5,-2458 17677.5,-2298.68 17677.5,-2298.68"/>
<polygon fill="red" stroke="red" points="17681,-2298.68 17677.5,-2288.68 17674,-2298.68 17681,-2298.68"/>
<text text-anchor="middle" x="17531.5" y="-2381.8" font-family="Times,serif" font-size="14.00">AllGather GPU9→GPU10</text>
</g>
<!-- k_proj_3_2_2 -->
<g id="node250" class="node">
<title>k_proj_3_2_2</title>
<polygon fill="#ff99ff" stroke="black" points="17281,-2659 17147,-2659 17147,-2591 17281,-2591 17281,-2659"/>
<text text-anchor="middle" x="17214" y="-2643.8" font-family="Times,serif" font-size="14.00">K Projection 2_2</text>
<text text-anchor="middle" x="17214" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="17214" y="-2613.8" font-family="Times,serif" font-size="14.00">W_K^{2,2}</text>
<text text-anchor="middle" x="17214" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- k_proj_3_2_2&#45;&gt;attention_3_2_2 -->
<g id="edge275" class="edge">
<title>k_proj_3_2_2&#45;&gt;attention_3_2_2</title>
<path fill="none" stroke="black" d="M17235.25,-2590.98C17235.25,-2590.98 17235.25,-2514.2 17235.25,-2514.2"/>
<polygon fill="black" stroke="black" points="17238.75,-2514.2 17235.25,-2504.2 17231.75,-2514.2 17238.75,-2514.2"/>
</g>
<!-- v_proj_3_2_2 -->
<g id="node251" class="node">
<title>v_proj_3_2_2</title>
<polygon fill="#ff99ff" stroke="black" points="17088.5,-2659 16955.5,-2659 16955.5,-2591 17088.5,-2591 17088.5,-2659"/>
<text text-anchor="middle" x="17022" y="-2643.8" font-family="Times,serif" font-size="14.00">V Projection 2_2</text>
<text text-anchor="middle" x="17022" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="17022" y="-2613.8" font-family="Times,serif" font-size="14.00">W_V^{2,2}</text>
<text text-anchor="middle" x="17022" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- v_proj_3_2_2&#45;&gt;attention_3_2_2 -->
<g id="edge276" class="edge">
<title>v_proj_3_2_2&#45;&gt;attention_3_2_2</title>
<path fill="none" stroke="black" d="M17054.5,-2590.98C17054.5,-2545.36 17054.5,-2470 17054.5,-2470 17054.5,-2470 17179.41,-2470 17179.41,-2470"/>
<polygon fill="black" stroke="black" points="17179.41,-2473.5 17189.41,-2470 17179.41,-2466.5 17179.41,-2473.5"/>
</g>
<!-- q_proj_3_2_3 -->
<g id="node252" class="node">
<title>q_proj_3_2_3</title>
<polygon fill="#ff99cc" stroke="black" points="16897,-2659 16763,-2659 16763,-2591 16897,-2591 16897,-2659"/>
<text text-anchor="middle" x="16830" y="-2643.8" font-family="Times,serif" font-size="14.00">Q Projection 2_3</text>
<text text-anchor="middle" x="16830" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="16830" y="-2613.8" font-family="Times,serif" font-size="14.00">W_Q^{2,3}</text>
<text text-anchor="middle" x="16830" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- attention_3_2_3 -->
<g id="node253" class="node">
<title>attention_3_2_3</title>
<polygon fill="#ff99cc" stroke="black" points="16819.5,-2504 16646.5,-2504 16646.5,-2436 16819.5,-2436 16819.5,-2504"/>
<text text-anchor="middle" x="16733" y="-2488.8" font-family="Times,serif" font-size="14.00">Attention 2_3</text>
<text text-anchor="middle" x="16733" y="-2473.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="16733" y="-2458.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="16733" y="-2443.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- q_proj_3_2_3&#45;&gt;attention_3_2_3 -->
<g id="edge279" class="edge">
<title>q_proj_3_2_3&#45;&gt;attention_3_2_3</title>
<path fill="none" stroke="black" d="M16791.25,-2590.98C16791.25,-2590.98 16791.25,-2514.2 16791.25,-2514.2"/>
<polygon fill="black" stroke="black" points="16794.75,-2514.2 16791.25,-2504.2 16787.75,-2514.2 16794.75,-2514.2"/>
</g>
<!-- attention_3_2_3&#45;&gt;concat_group_3_2 -->
<g id="edge282" class="edge">
<title>attention_3_2_3&#45;&gt;concat_group_3_2</title>
<path fill="none" stroke="black" d="M16810.17,-2435.81C16810.17,-2385.9 16810.17,-2299 16810.17,-2299 16810.17,-2299 17693.05,-2299 17693.05,-2299"/>
<polygon fill="black" stroke="black" points="17693.05,-2302.5 17703.05,-2299 17693.05,-2295.5 17693.05,-2302.5"/>
</g>
<!-- attention_3_2_3&#45;&gt;concat_group_3_2 -->
<g id="edge283" class="edge">
<title>attention_3_2_3&#45;&gt;concat_group_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M16800.83,-2435.98C16800.83,-2377.47 16800.83,-2264 16800.83,-2264 16800.83,-2264 17695.24,-2264 17695.24,-2264"/>
<polygon fill="red" stroke="red" points="17695.24,-2267.5 17705.24,-2264 17695.24,-2260.5 17695.24,-2267.5"/>
<text text-anchor="middle" x="17099" y="-2381.8" font-family="Times,serif" font-size="14.00">AllGather GPU10→GPU11</text>
</g>
<!-- k_proj_3_2_3 -->
<g id="node254" class="node">
<title>k_proj_3_2_3</title>
<polygon fill="#ff99cc" stroke="black" points="16705,-2659 16571,-2659 16571,-2591 16705,-2591 16705,-2659"/>
<text text-anchor="middle" x="16638" y="-2643.8" font-family="Times,serif" font-size="14.00">K Projection 2_3</text>
<text text-anchor="middle" x="16638" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="16638" y="-2613.8" font-family="Times,serif" font-size="14.00">W_K^{2,3}</text>
<text text-anchor="middle" x="16638" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- k_proj_3_2_3&#45;&gt;attention_3_2_3 -->
<g id="edge280" class="edge">
<title>k_proj_3_2_3&#45;&gt;attention_3_2_3</title>
<path fill="none" stroke="black" d="M16675.75,-2590.98C16675.75,-2590.98 16675.75,-2514.2 16675.75,-2514.2"/>
<polygon fill="black" stroke="black" points="16679.25,-2514.2 16675.75,-2504.2 16672.25,-2514.2 16679.25,-2514.2"/>
</g>
<!-- v_proj_3_2_3 -->
<g id="node255" class="node">
<title>v_proj_3_2_3</title>
<polygon fill="#ff99cc" stroke="black" points="16512.5,-2659 16379.5,-2659 16379.5,-2591 16512.5,-2591 16512.5,-2659"/>
<text text-anchor="middle" x="16446" y="-2643.8" font-family="Times,serif" font-size="14.00">V Projection 2_3</text>
<text text-anchor="middle" x="16446" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="16446" y="-2613.8" font-family="Times,serif" font-size="14.00">W_V^{2,3}</text>
<text text-anchor="middle" x="16446" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- v_proj_3_2_3&#45;&gt;attention_3_2_3 -->
<g id="edge281" class="edge">
<title>v_proj_3_2_3&#45;&gt;attention_3_2_3</title>
<path fill="none" stroke="black" d="M16495,-2590.87C16495,-2548.29 16495,-2481 16495,-2481 16495,-2481 16636.4,-2481 16636.4,-2481"/>
<polygon fill="black" stroke="black" points="16636.4,-2484.5 16646.4,-2481 16636.4,-2477.5 16636.4,-2484.5"/>
</g>
<!-- q_proj_3_3_0 -->
<g id="node256" class="node">
<title>q_proj_3_3_0</title>
<polygon fill="#ffb366" stroke="black" points="16321,-2659 16187,-2659 16187,-2591 16321,-2591 16321,-2659"/>
<text text-anchor="middle" x="16254" y="-2643.8" font-family="Times,serif" font-size="14.00">Q Projection 3_0</text>
<text text-anchor="middle" x="16254" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="16254" y="-2613.8" font-family="Times,serif" font-size="14.00">W_Q^{3,0}</text>
<text text-anchor="middle" x="16254" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- attention_3_3_0 -->
<g id="node257" class="node">
<title>attention_3_3_0</title>
<polygon fill="#ffb366" stroke="black" points="16088.5,-2504 15915.5,-2504 15915.5,-2436 16088.5,-2436 16088.5,-2504"/>
<text text-anchor="middle" x="16002" y="-2488.8" font-family="Times,serif" font-size="14.00">Attention 3_0</text>
<text text-anchor="middle" x="16002" y="-2473.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="16002" y="-2458.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="16002" y="-2443.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- q_proj_3_3_0&#45;&gt;attention_3_3_0 -->
<g id="edge284" class="edge">
<title>q_proj_3_3_0&#45;&gt;attention_3_3_0</title>
<path fill="none" stroke="black" d="M16204.25,-2590.8C16204.25,-2541.94 16204.25,-2458 16204.25,-2458 16204.25,-2458 16098.65,-2458 16098.65,-2458"/>
<polygon fill="black" stroke="black" points="16098.65,-2454.5 16088.65,-2458 16098.65,-2461.5 16098.65,-2454.5"/>
</g>
<!-- concat_group_3_3 -->
<g id="node260" class="node">
<title>concat_group_3_3</title>
<polygon fill="#ffd700" stroke="black" points="15486,-2335 15358,-2282 15486,-2229 15614,-2282 15486,-2335"/>
<text text-anchor="middle" x="15486" y="-2293.3" font-family="Times,serif" font-size="14.00">Concat Group 3</text>
<text text-anchor="middle" x="15486" y="-2278.3" font-family="Times,serif" font-size="14.00">[B×L×d×h_g]</text>
<text text-anchor="middle" x="15486" y="-2263.3" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- attention_3_3_0&#45;&gt;concat_group_3_3 -->
<g id="edge287" class="edge">
<title>attention_3_3_0&#45;&gt;concat_group_3_3</title>
<path fill="none" stroke="black" d="M15915.5,-2470C15795.14,-2470 15591.75,-2470 15591.75,-2470 15591.75,-2470 15591.75,-2301.32 15591.75,-2301.32"/>
<polygon fill="black" stroke="black" points="15595.25,-2301.32 15591.75,-2291.32 15588.25,-2301.32 15595.25,-2301.32"/>
</g>
<!-- k_proj_3_3_0 -->
<g id="node258" class="node">
<title>k_proj_3_3_0</title>
<polygon fill="#ffb366" stroke="black" points="16129,-2659 15995,-2659 15995,-2591 16129,-2591 16129,-2659"/>
<text text-anchor="middle" x="16062" y="-2643.8" font-family="Times,serif" font-size="14.00">K Projection 3_0</text>
<text text-anchor="middle" x="16062" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="16062" y="-2613.8" font-family="Times,serif" font-size="14.00">W_K^{3,0}</text>
<text text-anchor="middle" x="16062" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- k_proj_3_3_0&#45;&gt;attention_3_3_0 -->
<g id="edge285" class="edge">
<title>k_proj_3_3_0&#45;&gt;attention_3_3_0</title>
<path fill="none" stroke="black" d="M16041.75,-2590.98C16041.75,-2590.98 16041.75,-2514.2 16041.75,-2514.2"/>
<polygon fill="black" stroke="black" points="16045.25,-2514.2 16041.75,-2504.2 16038.25,-2514.2 16045.25,-2514.2"/>
</g>
<!-- v_proj_3_3_0 -->
<g id="node259" class="node">
<title>v_proj_3_3_0</title>
<polygon fill="#ffb366" stroke="black" points="15936.5,-2659 15803.5,-2659 15803.5,-2591 15936.5,-2591 15936.5,-2659"/>
<text text-anchor="middle" x="15870" y="-2643.8" font-family="Times,serif" font-size="14.00">V Projection 3_0</text>
<text text-anchor="middle" x="15870" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="15870" y="-2613.8" font-family="Times,serif" font-size="14.00">W_V^{3,0}</text>
<text text-anchor="middle" x="15870" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- v_proj_3_3_0&#45;&gt;attention_3_3_0 -->
<g id="edge286" class="edge">
<title>v_proj_3_3_0&#45;&gt;attention_3_3_0</title>
<path fill="none" stroke="black" d="M15926,-2590.98C15926,-2590.98 15926,-2514.2 15926,-2514.2"/>
<polygon fill="black" stroke="black" points="15929.5,-2514.2 15926,-2504.2 15922.5,-2514.2 15929.5,-2514.2"/>
</g>
<!-- concat_group_3_3&#45;&gt;final_concat_3 -->
<g id="edge307" class="edge">
<title>concat_group_3_3&#45;&gt;final_concat_3</title>
<path fill="none" stroke="black" d="M15607.5,-2279.02C15607.5,-2253.37 15607.5,-2071 15607.5,-2071 15607.5,-2071 18104.9,-2071 18104.9,-2071"/>
<polygon fill="black" stroke="black" points="18104.9,-2074.5 18114.9,-2071 18104.9,-2067.5 18104.9,-2074.5"/>
</g>
<!-- q_proj_3_3_1 -->
<g id="node261" class="node">
<title>q_proj_3_3_1</title>
<polygon fill="#b3ff66" stroke="black" points="15745,-2659 15611,-2659 15611,-2591 15745,-2591 15745,-2659"/>
<text text-anchor="middle" x="15678" y="-2643.8" font-family="Times,serif" font-size="14.00">Q Projection 3_1</text>
<text text-anchor="middle" x="15678" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="15678" y="-2613.8" font-family="Times,serif" font-size="14.00">W_Q^{3,1}</text>
<text text-anchor="middle" x="15678" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- attention_3_3_1 -->
<g id="node262" class="node">
<title>attention_3_3_1</title>
<polygon fill="#b3ff66" stroke="black" points="15572.5,-2504 15399.5,-2504 15399.5,-2436 15572.5,-2436 15572.5,-2504"/>
<text text-anchor="middle" x="15486" y="-2488.8" font-family="Times,serif" font-size="14.00">Attention 3_1</text>
<text text-anchor="middle" x="15486" y="-2473.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="15486" y="-2458.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="15486" y="-2443.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- q_proj_3_3_1&#45;&gt;attention_3_3_1 -->
<g id="edge288" class="edge">
<title>q_proj_3_3_1&#45;&gt;attention_3_3_1</title>
<path fill="none" stroke="black" d="M15610.96,-2625C15585.6,-2625 15562.75,-2625 15562.75,-2625 15562.75,-2625 15562.75,-2514.02 15562.75,-2514.02"/>
<polygon fill="black" stroke="black" points="15566.25,-2514.02 15562.75,-2504.02 15559.25,-2514.02 15566.25,-2514.02"/>
</g>
<!-- attention_3_3_1&#45;&gt;concat_group_3_3 -->
<g id="edge291" class="edge">
<title>attention_3_3_1&#45;&gt;concat_group_3_3</title>
<path fill="none" stroke="black" d="M15457.17,-2435.95C15457.17,-2435.95 15457.17,-2333.34 15457.17,-2333.34"/>
<polygon fill="black" stroke="black" points="15460.67,-2333.34 15457.17,-2323.34 15453.67,-2333.34 15460.67,-2333.34"/>
</g>
<!-- attention_3_3_1&#45;&gt;concat_group_3_3 -->
<g id="edge292" class="edge">
<title>attention_3_3_1&#45;&gt;concat_group_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M15514.83,-2435.95C15514.83,-2435.95 15514.83,-2333.34 15514.83,-2333.34"/>
<polygon fill="red" stroke="red" points="15518.33,-2333.34 15514.83,-2323.34 15511.33,-2333.34 15518.33,-2333.34"/>
<text text-anchor="middle" x="15803" y="-2381.8" font-family="Times,serif" font-size="14.00">AllGather GPU12→GPU13</text>
</g>
<!-- k_proj_3_3_1 -->
<g id="node263" class="node">
<title>k_proj_3_3_1</title>
<polygon fill="#b3ff66" stroke="black" points="15553,-2659 15419,-2659 15419,-2591 15553,-2591 15553,-2659"/>
<text text-anchor="middle" x="15486" y="-2643.8" font-family="Times,serif" font-size="14.00">K Projection 3_1</text>
<text text-anchor="middle" x="15486" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="15486" y="-2613.8" font-family="Times,serif" font-size="14.00">W_K^{3,1}</text>
<text text-anchor="middle" x="15486" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- k_proj_3_3_1&#45;&gt;attention_3_3_1 -->
<g id="edge289" class="edge">
<title>k_proj_3_3_1&#45;&gt;attention_3_3_1</title>
<path fill="none" stroke="black" d="M15486,-2590.98C15486,-2590.98 15486,-2514.2 15486,-2514.2"/>
<polygon fill="black" stroke="black" points="15489.5,-2514.2 15486,-2504.2 15482.5,-2514.2 15489.5,-2514.2"/>
</g>
<!-- v_proj_3_3_1 -->
<g id="node264" class="node">
<title>v_proj_3_3_1</title>
<polygon fill="#b3ff66" stroke="black" points="15360.5,-2659 15227.5,-2659 15227.5,-2591 15360.5,-2591 15360.5,-2659"/>
<text text-anchor="middle" x="15294" y="-2643.8" font-family="Times,serif" font-size="14.00">V Projection 3_1</text>
<text text-anchor="middle" x="15294" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="15294" y="-2613.8" font-family="Times,serif" font-size="14.00">W_V^{3,1}</text>
<text text-anchor="middle" x="15294" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- v_proj_3_3_1&#45;&gt;attention_3_3_1 -->
<g id="edge290" class="edge">
<title>v_proj_3_3_1&#45;&gt;attention_3_3_1</title>
<path fill="none" stroke="black" d="M15360.71,-2625C15386.19,-2625 15409.25,-2625 15409.25,-2625 15409.25,-2625 15409.25,-2514.02 15409.25,-2514.02"/>
<polygon fill="black" stroke="black" points="15412.75,-2514.02 15409.25,-2504.02 15405.75,-2514.02 15412.75,-2514.02"/>
</g>
<!-- q_proj_3_3_2 -->
<g id="node265" class="node">
<title>q_proj_3_3_2</title>
<polygon fill="#66ffb3" stroke="black" points="15169,-2659 15035,-2659 15035,-2591 15169,-2591 15169,-2659"/>
<text text-anchor="middle" x="15102" y="-2643.8" font-family="Times,serif" font-size="14.00">Q Projection 3_2</text>
<text text-anchor="middle" x="15102" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="15102" y="-2613.8" font-family="Times,serif" font-size="14.00">W_Q^{3,2}</text>
<text text-anchor="middle" x="15102" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- attention_3_3_2 -->
<g id="node266" class="node">
<title>attention_3_3_2</title>
<polygon fill="#66ffb3" stroke="black" points="15093.5,-2504 14920.5,-2504 14920.5,-2436 15093.5,-2436 15093.5,-2504"/>
<text text-anchor="middle" x="15007" y="-2488.8" font-family="Times,serif" font-size="14.00">Attention 3_2</text>
<text text-anchor="middle" x="15007" y="-2473.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="15007" y="-2458.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="15007" y="-2443.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- q_proj_3_3_2&#45;&gt;attention_3_3_2 -->
<g id="edge293" class="edge">
<title>q_proj_3_3_2&#45;&gt;attention_3_3_2</title>
<path fill="none" stroke="black" d="M15064.25,-2590.98C15064.25,-2590.98 15064.25,-2514.2 15064.25,-2514.2"/>
<polygon fill="black" stroke="black" points="15067.75,-2514.2 15064.25,-2504.2 15060.75,-2514.2 15067.75,-2514.2"/>
</g>
<!-- attention_3_3_2&#45;&gt;concat_group_3_3 -->
<g id="edge296" class="edge">
<title>attention_3_3_2&#45;&gt;concat_group_3_3</title>
<path fill="none" stroke="black" d="M15093.59,-2481C15205.59,-2481 15386.5,-2481 15386.5,-2481 15386.5,-2481 15386.5,-2303.85 15386.5,-2303.85"/>
<polygon fill="black" stroke="black" points="15390,-2303.85 15386.5,-2293.85 15383,-2303.85 15390,-2303.85"/>
</g>
<!-- attention_3_3_2&#45;&gt;concat_group_3_3 -->
<g id="edge297" class="edge">
<title>attention_3_3_2&#45;&gt;concat_group_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M15093.86,-2458C15202.23,-2458 15373.5,-2458 15373.5,-2458 15373.5,-2458 15373.5,-2298.68 15373.5,-2298.68"/>
<polygon fill="red" stroke="red" points="15377,-2298.68 15373.5,-2288.68 15370,-2298.68 15377,-2298.68"/>
<text text-anchor="middle" x="15344" y="-2381.8" font-family="Times,serif" font-size="14.00">AllGather GPU13→GPU14</text>
</g>
<!-- k_proj_3_3_2 -->
<g id="node267" class="node">
<title>k_proj_3_3_2</title>
<polygon fill="#66ffb3" stroke="black" points="14977,-2659 14843,-2659 14843,-2591 14977,-2591 14977,-2659"/>
<text text-anchor="middle" x="14910" y="-2643.8" font-family="Times,serif" font-size="14.00">K Projection 3_2</text>
<text text-anchor="middle" x="14910" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="14910" y="-2613.8" font-family="Times,serif" font-size="14.00">W_K^{3,2}</text>
<text text-anchor="middle" x="14910" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- k_proj_3_3_2&#45;&gt;attention_3_3_2 -->
<g id="edge294" class="edge">
<title>k_proj_3_3_2&#45;&gt;attention_3_3_2</title>
<path fill="none" stroke="black" d="M14948.75,-2590.98C14948.75,-2590.98 14948.75,-2514.2 14948.75,-2514.2"/>
<polygon fill="black" stroke="black" points="14952.25,-2514.2 14948.75,-2504.2 14945.25,-2514.2 14952.25,-2514.2"/>
</g>
<!-- v_proj_3_3_2 -->
<g id="node268" class="node">
<title>v_proj_3_3_2</title>
<polygon fill="#66ffb3" stroke="black" points="14784.5,-2659 14651.5,-2659 14651.5,-2591 14784.5,-2591 14784.5,-2659"/>
<text text-anchor="middle" x="14718" y="-2643.8" font-family="Times,serif" font-size="14.00">V Projection 3_2</text>
<text text-anchor="middle" x="14718" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="14718" y="-2613.8" font-family="Times,serif" font-size="14.00">W_V^{3,2}</text>
<text text-anchor="middle" x="14718" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- v_proj_3_3_2&#45;&gt;attention_3_3_2 -->
<g id="edge295" class="edge">
<title>v_proj_3_3_2&#45;&gt;attention_3_3_2</title>
<path fill="none" stroke="black" d="M14730.25,-2590.98C14730.25,-2545.36 14730.25,-2470 14730.25,-2470 14730.25,-2470 14910.19,-2470 14910.19,-2470"/>
<polygon fill="black" stroke="black" points="14910.19,-2473.5 14920.19,-2470 14910.19,-2466.5 14910.19,-2473.5"/>
</g>
<!-- q_proj_3_3_3 -->
<g id="node269" class="node">
<title>q_proj_3_3_3</title>
<polygon fill="#66b3ff" stroke="black" points="14593,-2659 14459,-2659 14459,-2591 14593,-2591 14593,-2659"/>
<text text-anchor="middle" x="14526" y="-2643.8" font-family="Times,serif" font-size="14.00">Q Projection 3_3</text>
<text text-anchor="middle" x="14526" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="14526" y="-2613.8" font-family="Times,serif" font-size="14.00">W_Q^{3,3}</text>
<text text-anchor="middle" x="14526" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- attention_3_3_3 -->
<g id="node270" class="node">
<title>attention_3_3_3</title>
<polygon fill="#66b3ff" stroke="black" points="14468.5,-2504 14295.5,-2504 14295.5,-2436 14468.5,-2436 14468.5,-2504"/>
<text text-anchor="middle" x="14382" y="-2488.8" font-family="Times,serif" font-size="14.00">Attention 3_3</text>
<text text-anchor="middle" x="14382" y="-2473.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="14382" y="-2458.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="14382" y="-2443.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- q_proj_3_3_3&#45;&gt;attention_3_3_3 -->
<g id="edge298" class="edge">
<title>q_proj_3_3_3&#45;&gt;attention_3_3_3</title>
<path fill="none" stroke="black" d="M14463.75,-2590.98C14463.75,-2590.98 14463.75,-2514.2 14463.75,-2514.2"/>
<polygon fill="black" stroke="black" points="14467.25,-2514.2 14463.75,-2504.2 14460.25,-2514.2 14467.25,-2514.2"/>
</g>
<!-- attention_3_3_3&#45;&gt;concat_group_3_3 -->
<g id="edge301" class="edge">
<title>attention_3_3_3&#45;&gt;concat_group_3_3</title>
<path fill="none" stroke="black" d="M14444.5,-2435.81C14444.5,-2385.9 14444.5,-2299 14444.5,-2299 14444.5,-2299 15388.99,-2299 15388.99,-2299"/>
<polygon fill="black" stroke="black" points="15388.99,-2302.5 15398.99,-2299 15388.99,-2295.5 15388.99,-2302.5"/>
</g>
<!-- attention_3_3_3&#45;&gt;concat_group_3_3 -->
<g id="edge302" class="edge">
<title>attention_3_3_3&#45;&gt;concat_group_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14425,-2435.98C14425,-2377.47 14425,-2264 14425,-2264 14425,-2264 15391.41,-2264 15391.41,-2264"/>
<polygon fill="red" stroke="red" points="15391.41,-2267.5 15401.41,-2264 15391.41,-2260.5 15391.41,-2267.5"/>
<text text-anchor="middle" x="14810" y="-2381.8" font-family="Times,serif" font-size="14.00">AllGather GPU14→GPU15</text>
</g>
<!-- k_proj_3_3_3 -->
<g id="node271" class="node">
<title>k_proj_3_3_3</title>
<polygon fill="#66b3ff" stroke="black" points="14401,-2659 14267,-2659 14267,-2591 14401,-2591 14401,-2659"/>
<text text-anchor="middle" x="14334" y="-2643.8" font-family="Times,serif" font-size="14.00">K Projection 3_3</text>
<text text-anchor="middle" x="14334" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="14334" y="-2613.8" font-family="Times,serif" font-size="14.00">W_K^{3,3}</text>
<text text-anchor="middle" x="14334" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- k_proj_3_3_3&#45;&gt;attention_3_3_3 -->
<g id="edge299" class="edge">
<title>k_proj_3_3_3&#45;&gt;attention_3_3_3</title>
<path fill="none" stroke="black" d="M14348.25,-2590.98C14348.25,-2590.98 14348.25,-2514.2 14348.25,-2514.2"/>
<polygon fill="black" stroke="black" points="14351.75,-2514.2 14348.25,-2504.2 14344.75,-2514.2 14351.75,-2514.2"/>
</g>
<!-- v_proj_3_3_3 -->
<g id="node272" class="node">
<title>v_proj_3_3_3</title>
<polygon fill="#66b3ff" stroke="black" points="14208.5,-2659 14075.5,-2659 14075.5,-2591 14208.5,-2591 14208.5,-2659"/>
<text text-anchor="middle" x="14142" y="-2643.8" font-family="Times,serif" font-size="14.00">V Projection 3_3</text>
<text text-anchor="middle" x="14142" y="-2628.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="14142" y="-2613.8" font-family="Times,serif" font-size="14.00">W_V^{3,3}</text>
<text text-anchor="middle" x="14142" y="-2598.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- v_proj_3_3_3&#45;&gt;attention_3_3_3 -->
<g id="edge300" class="edge">
<title>v_proj_3_3_3&#45;&gt;attention_3_3_3</title>
<path fill="none" stroke="black" d="M14144.25,-2590.98C14144.25,-2545.36 14144.25,-2470 14144.25,-2470 14144.25,-2470 14285.49,-2470 14285.49,-2470"/>
<polygon fill="black" stroke="black" points="14285.49,-2473.5 14295.49,-2470 14285.49,-2466.5 14285.49,-2473.5"/>
</g>
<!-- expert_gate_3_0 -->
<g id="node274" class="node">
<title>expert_gate_3_0</title>
<polygon fill="#ff9999" stroke="black" points="18282.5,-1949 18165.5,-1949 18165.5,-1896 18282.5,-1896 18282.5,-1949"/>
<text text-anchor="middle" x="18224" y="-1933.8" font-family="Times,serif" font-size="14.00">Expert Gate 0</text>
<text text-anchor="middle" x="18224" y="-1918.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="18224" y="-1903.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- final_concat_3&#45;&gt;expert_gate_3_0 -->
<g id="edge304" class="edge">
<title>final_concat_3&#45;&gt;expert_gate_3_0</title>
<path fill="none" stroke="black" d="M18224,-2035.86C18224,-2035.86 18224,-1959.1 18224,-1959.1"/>
<polygon fill="black" stroke="black" points="18227.5,-1959.1 18224,-1949.1 18220.5,-1959.1 18227.5,-1959.1"/>
</g>
<!-- expert_3_0_0 -->
<g id="node275" class="node">
<title>expert_3_0_0</title>
<polygon fill="#ff9999" stroke="black" points="18271.5,-1809 18176.5,-1809 18176.5,-1756 18271.5,-1756 18271.5,-1809"/>
<text text-anchor="middle" x="18224" y="-1793.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="18224" y="-1778.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="18224" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_gate_3_0&#45;&gt;expert_3_0_0 -->
<g id="edge308" class="edge">
<title>expert_gate_3_0&#45;&gt;expert_3_0_0</title>
<path fill="none" stroke="black" d="M18224,-1895.84C18224,-1895.84 18224,-1819.06 18224,-1819.06"/>
<polygon fill="black" stroke="black" points="18227.5,-1819.06 18224,-1809.06 18220.5,-1819.06 18227.5,-1819.06"/>
</g>
<!-- expert_agg_3_0 -->
<g id="node276" class="node">
<title>expert_agg_3_0</title>
<polygon fill="#ff9999" stroke="black" points="18309.5,-1669 18138.5,-1669 18138.5,-1616 18309.5,-1616 18309.5,-1669"/>
<text text-anchor="middle" x="18224" y="-1653.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 0</text>
<text text-anchor="middle" x="18224" y="-1638.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="18224" y="-1623.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_3_0_0&#45;&gt;expert_agg_3_0 -->
<g id="edge309" class="edge">
<title>expert_3_0_0&#45;&gt;expert_agg_3_0</title>
<path fill="none" stroke="black" d="M18224,-1755.84C18224,-1755.84 18224,-1679.06 18224,-1679.06"/>
<polygon fill="black" stroke="black" points="18227.5,-1679.06 18224,-1669.06 18220.5,-1679.06 18227.5,-1679.06"/>
</g>
<!-- layer_norm_3 -->
<g id="node280" class="node">
<title>layer_norm_3</title>
<ellipse fill="#e6e6e6" stroke="black" cx="16451" cy="-1491.5" rx="82" ry="37.5"/>
<text text-anchor="middle" x="16451" y="-1502.8" font-family="Times,serif" font-size="14.00">Layer Norm 3</text>
<text text-anchor="middle" x="16451" y="-1487.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="16451" y="-1472.8" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- expert_agg_3_0&#45;&gt;layer_norm_3 -->
<g id="edge310" class="edge">
<title>expert_agg_3_0&#45;&gt;layer_norm_3</title>
<path fill="none" stroke="black" d="M18224,-1615.63C18224,-1565.55 18224,-1463 18224,-1463 18224,-1463 16514.55,-1463 16514.55,-1463"/>
<polygon fill="black" stroke="black" points="16514.55,-1459.5 16504.55,-1463 16514.55,-1466.5 16514.55,-1459.5"/>
</g>
<!-- expert_3_0_1 -->
<g id="node277" class="node">
<title>expert_3_0_1</title>
<polygon fill="#ff9999" stroke="black" points="14017.5,-2651.5 13922.5,-2651.5 13922.5,-2598.5 14017.5,-2598.5 14017.5,-2651.5"/>
<text text-anchor="middle" x="13970" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="13970" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="13970" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_3_0_2 -->
<g id="node278" class="node">
<title>expert_3_0_2</title>
<polygon fill="#ff9999" stroke="black" points="13864.5,-2651.5 13769.5,-2651.5 13769.5,-2598.5 13864.5,-2598.5 13864.5,-2651.5"/>
<text text-anchor="middle" x="13817" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="13817" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="13817" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_3_0_3 -->
<g id="node279" class="node">
<title>expert_3_0_3</title>
<polygon fill="#ff9999" stroke="black" points="13711.5,-2651.5 13616.5,-2651.5 13616.5,-2598.5 13711.5,-2598.5 13711.5,-2651.5"/>
<text text-anchor="middle" x="13664" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="13664" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="13664" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- q_proj_4_0_0 -->
<g id="node371" class="node">
<title>q_proj_4_0_0</title>
<polygon fill="#ff9999" stroke="black" points="16518,-1367 16384,-1367 16384,-1299 16518,-1299 16518,-1367"/>
<text text-anchor="middle" x="16451" y="-1351.8" font-family="Times,serif" font-size="14.00">Q Projection 0_0</text>
<text text-anchor="middle" x="16451" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="16451" y="-1321.8" font-family="Times,serif" font-size="14.00">W_Q^{0,0}</text>
<text text-anchor="middle" x="16451" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_norm_3&#45;&gt;q_proj_4_0_0 -->
<g id="edge491" class="edge">
<title>layer_norm_3&#45;&gt;q_proj_4_0_0</title>
<path fill="none" stroke="black" d="M16451,-1453.94C16451,-1453.94 16451,-1377.05 16451,-1377.05"/>
<polygon fill="black" stroke="black" points="16454.5,-1377.05 16451,-1367.05 16447.5,-1377.05 16454.5,-1377.05"/>
</g>
<!-- expert_gate_3_1 -->
<g id="node281" class="node">
<title>expert_gate_3_1</title>
<polygon fill="#ffcc99" stroke="black" points="18053.5,-1949 17936.5,-1949 17936.5,-1896 18053.5,-1896 18053.5,-1949"/>
<text text-anchor="middle" x="17995" y="-1933.8" font-family="Times,serif" font-size="14.00">Expert Gate 1</text>
<text text-anchor="middle" x="17995" y="-1918.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="17995" y="-1903.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_3_1_0 -->
<g id="node282" class="node">
<title>expert_3_1_0</title>
<polygon fill="#ffcc99" stroke="black" points="18042.5,-1809 17947.5,-1809 17947.5,-1756 18042.5,-1756 18042.5,-1809"/>
<text text-anchor="middle" x="17995" y="-1793.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="17995" y="-1778.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="17995" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_gate_3_1&#45;&gt;expert_3_1_0 -->
<g id="edge311" class="edge">
<title>expert_gate_3_1&#45;&gt;expert_3_1_0</title>
<path fill="none" stroke="black" d="M17995,-1895.84C17995,-1895.84 17995,-1819.06 17995,-1819.06"/>
<polygon fill="black" stroke="black" points="17998.5,-1819.06 17995,-1809.06 17991.5,-1819.06 17998.5,-1819.06"/>
</g>
<!-- expert_agg_3_1 -->
<g id="node283" class="node">
<title>expert_agg_3_1</title>
<polygon fill="#ffcc99" stroke="black" points="18080.5,-1669 17909.5,-1669 17909.5,-1616 18080.5,-1616 18080.5,-1669"/>
<text text-anchor="middle" x="17995" y="-1653.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 1</text>
<text text-anchor="middle" x="17995" y="-1638.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="17995" y="-1623.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_3_1_0&#45;&gt;expert_agg_3_1 -->
<g id="edge312" class="edge">
<title>expert_3_1_0&#45;&gt;expert_agg_3_1</title>
<path fill="none" stroke="black" d="M17995,-1755.84C17995,-1755.84 17995,-1679.06 17995,-1679.06"/>
<polygon fill="black" stroke="black" points="17998.5,-1679.06 17995,-1669.06 17991.5,-1679.06 17998.5,-1679.06"/>
</g>
<!-- expert_agg_3_1&#45;&gt;layer_norm_3 -->
<g id="edge313" class="edge">
<title>expert_agg_3_1&#45;&gt;layer_norm_3</title>
<path fill="none" stroke="black" d="M17995,-1615.86C17995,-1567.91 17995,-1472 17995,-1472 17995,-1472 16531.1,-1472 16531.1,-1472"/>
<polygon fill="black" stroke="black" points="16531.1,-1468.5 16521.1,-1472 16531.1,-1475.5 16531.1,-1468.5"/>
</g>
<!-- expert_3_1_1 -->
<g id="node284" class="node">
<title>expert_3_1_1</title>
<polygon fill="#ffcc99" stroke="black" points="13558.5,-2651.5 13463.5,-2651.5 13463.5,-2598.5 13558.5,-2598.5 13558.5,-2651.5"/>
<text text-anchor="middle" x="13511" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="13511" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="13511" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_3_1_2 -->
<g id="node285" class="node">
<title>expert_3_1_2</title>
<polygon fill="#ffcc99" stroke="black" points="13405.5,-2651.5 13310.5,-2651.5 13310.5,-2598.5 13405.5,-2598.5 13405.5,-2651.5"/>
<text text-anchor="middle" x="13358" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="13358" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="13358" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_3_1_3 -->
<g id="node286" class="node">
<title>expert_3_1_3</title>
<polygon fill="#ffcc99" stroke="black" points="13252.5,-2651.5 13157.5,-2651.5 13157.5,-2598.5 13252.5,-2598.5 13252.5,-2651.5"/>
<text text-anchor="middle" x="13205" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="13205" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="13205" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_gate_3_2 -->
<g id="node287" class="node">
<title>expert_gate_3_2</title>
<polygon fill="#ffff99" stroke="black" points="17824.5,-1949 17707.5,-1949 17707.5,-1896 17824.5,-1896 17824.5,-1949"/>
<text text-anchor="middle" x="17766" y="-1933.8" font-family="Times,serif" font-size="14.00">Expert Gate 2</text>
<text text-anchor="middle" x="17766" y="-1918.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="17766" y="-1903.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_3_2_0 -->
<g id="node288" class="node">
<title>expert_3_2_0</title>
<polygon fill="#ffff99" stroke="black" points="17813.5,-1809 17718.5,-1809 17718.5,-1756 17813.5,-1756 17813.5,-1809"/>
<text text-anchor="middle" x="17766" y="-1793.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="17766" y="-1778.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="17766" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_gate_3_2&#45;&gt;expert_3_2_0 -->
<g id="edge314" class="edge">
<title>expert_gate_3_2&#45;&gt;expert_3_2_0</title>
<path fill="none" stroke="black" d="M17766,-1895.84C17766,-1895.84 17766,-1819.06 17766,-1819.06"/>
<polygon fill="black" stroke="black" points="17769.5,-1819.06 17766,-1809.06 17762.5,-1819.06 17769.5,-1819.06"/>
</g>
<!-- expert_agg_3_2 -->
<g id="node289" class="node">
<title>expert_agg_3_2</title>
<polygon fill="#ffff99" stroke="black" points="17851.5,-1669 17680.5,-1669 17680.5,-1616 17851.5,-1616 17851.5,-1669"/>
<text text-anchor="middle" x="17766" y="-1653.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 2</text>
<text text-anchor="middle" x="17766" y="-1638.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="17766" y="-1623.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_3_2_0&#45;&gt;expert_agg_3_2 -->
<g id="edge315" class="edge">
<title>expert_3_2_0&#45;&gt;expert_agg_3_2</title>
<path fill="none" stroke="black" d="M17766,-1755.84C17766,-1755.84 17766,-1679.06 17766,-1679.06"/>
<polygon fill="black" stroke="black" points="17769.5,-1679.06 17766,-1669.06 17762.5,-1679.06 17769.5,-1679.06"/>
</g>
<!-- expert_agg_3_2&#45;&gt;layer_norm_3 -->
<g id="edge316" class="edge">
<title>expert_agg_3_2&#45;&gt;layer_norm_3</title>
<path fill="none" stroke="black" d="M17766,-1616C17766,-1570.41 17766,-1482 17766,-1482 17766,-1482 16540.79,-1482 16540.79,-1482"/>
<polygon fill="black" stroke="black" points="16540.79,-1478.5 16530.79,-1482 16540.79,-1485.5 16540.79,-1478.5"/>
</g>
<!-- expert_3_2_1 -->
<g id="node290" class="node">
<title>expert_3_2_1</title>
<polygon fill="#ffff99" stroke="black" points="13099.5,-2651.5 13004.5,-2651.5 13004.5,-2598.5 13099.5,-2598.5 13099.5,-2651.5"/>
<text text-anchor="middle" x="13052" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="13052" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="13052" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_3_2_2 -->
<g id="node291" class="node">
<title>expert_3_2_2</title>
<polygon fill="#ffff99" stroke="black" points="12946.5,-2651.5 12851.5,-2651.5 12851.5,-2598.5 12946.5,-2598.5 12946.5,-2651.5"/>
<text text-anchor="middle" x="12899" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="12899" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="12899" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_3_2_3 -->
<g id="node292" class="node">
<title>expert_3_2_3</title>
<polygon fill="#ffff99" stroke="black" points="12793.5,-2651.5 12698.5,-2651.5 12698.5,-2598.5 12793.5,-2598.5 12793.5,-2651.5"/>
<text text-anchor="middle" x="12746" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="12746" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="12746" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_gate_3_3 -->
<g id="node293" class="node">
<title>expert_gate_3_3</title>
<polygon fill="#ccff99" stroke="black" points="17595.5,-1949 17478.5,-1949 17478.5,-1896 17595.5,-1896 17595.5,-1949"/>
<text text-anchor="middle" x="17537" y="-1933.8" font-family="Times,serif" font-size="14.00">Expert Gate 3</text>
<text text-anchor="middle" x="17537" y="-1918.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="17537" y="-1903.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_3_3_0 -->
<g id="node294" class="node">
<title>expert_3_3_0</title>
<polygon fill="#ccff99" stroke="black" points="17584.5,-1809 17489.5,-1809 17489.5,-1756 17584.5,-1756 17584.5,-1809"/>
<text text-anchor="middle" x="17537" y="-1793.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="17537" y="-1778.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="17537" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_gate_3_3&#45;&gt;expert_3_3_0 -->
<g id="edge317" class="edge">
<title>expert_gate_3_3&#45;&gt;expert_3_3_0</title>
<path fill="none" stroke="black" d="M17537,-1895.84C17537,-1895.84 17537,-1819.06 17537,-1819.06"/>
<polygon fill="black" stroke="black" points="17540.5,-1819.06 17537,-1809.06 17533.5,-1819.06 17540.5,-1819.06"/>
</g>
<!-- expert_agg_3_3 -->
<g id="node295" class="node">
<title>expert_agg_3_3</title>
<polygon fill="#ccff99" stroke="black" points="17622.5,-1669 17451.5,-1669 17451.5,-1616 17622.5,-1616 17622.5,-1669"/>
<text text-anchor="middle" x="17537" y="-1653.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 3</text>
<text text-anchor="middle" x="17537" y="-1638.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="17537" y="-1623.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_3_3_0&#45;&gt;expert_agg_3_3 -->
<g id="edge318" class="edge">
<title>expert_3_3_0&#45;&gt;expert_agg_3_3</title>
<path fill="none" stroke="black" d="M17537,-1755.84C17537,-1755.84 17537,-1679.06 17537,-1679.06"/>
<polygon fill="black" stroke="black" points="17540.5,-1679.06 17537,-1669.06 17533.5,-1679.06 17540.5,-1679.06"/>
</g>
<!-- expert_agg_3_3&#45;&gt;layer_norm_3 -->
<g id="edge319" class="edge">
<title>expert_agg_3_3&#45;&gt;layer_norm_3</title>
<path fill="none" stroke="black" d="M17537,-1615.76C17537,-1572.27 17537,-1491 17537,-1491 17537,-1491 16543.07,-1491 16543.07,-1491"/>
<polygon fill="black" stroke="black" points="16543.07,-1487.5 16533.07,-1491 16543.07,-1494.5 16543.07,-1487.5"/>
</g>
<!-- expert_3_3_1 -->
<g id="node296" class="node">
<title>expert_3_3_1</title>
<polygon fill="#ccff99" stroke="black" points="12640.5,-2651.5 12545.5,-2651.5 12545.5,-2598.5 12640.5,-2598.5 12640.5,-2651.5"/>
<text text-anchor="middle" x="12593" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="12593" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="12593" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_3_3_2 -->
<g id="node297" class="node">
<title>expert_3_3_2</title>
<polygon fill="#ccff99" stroke="black" points="12487.5,-2651.5 12392.5,-2651.5 12392.5,-2598.5 12487.5,-2598.5 12487.5,-2651.5"/>
<text text-anchor="middle" x="12440" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="12440" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="12440" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_3_3_3 -->
<g id="node298" class="node">
<title>expert_3_3_3</title>
<polygon fill="#ccff99" stroke="black" points="12334.5,-2651.5 12239.5,-2651.5 12239.5,-2598.5 12334.5,-2598.5 12334.5,-2651.5"/>
<text text-anchor="middle" x="12287" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="12287" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="12287" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_gate_3_4 -->
<g id="node299" class="node">
<title>expert_gate_3_4</title>
<polygon fill="#99ff99" stroke="black" points="17366.5,-1949 17249.5,-1949 17249.5,-1896 17366.5,-1896 17366.5,-1949"/>
<text text-anchor="middle" x="17308" y="-1933.8" font-family="Times,serif" font-size="14.00">Expert Gate 4</text>
<text text-anchor="middle" x="17308" y="-1918.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="17308" y="-1903.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_3_4_0 -->
<g id="node300" class="node">
<title>expert_3_4_0</title>
<polygon fill="#99ff99" stroke="black" points="17355.5,-1809 17260.5,-1809 17260.5,-1756 17355.5,-1756 17355.5,-1809"/>
<text text-anchor="middle" x="17308" y="-1793.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="17308" y="-1778.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="17308" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_gate_3_4&#45;&gt;expert_3_4_0 -->
<g id="edge320" class="edge">
<title>expert_gate_3_4&#45;&gt;expert_3_4_0</title>
<path fill="none" stroke="black" d="M17308,-1895.84C17308,-1895.84 17308,-1819.06 17308,-1819.06"/>
<polygon fill="black" stroke="black" points="17311.5,-1819.06 17308,-1809.06 17304.5,-1819.06 17311.5,-1819.06"/>
</g>
<!-- expert_agg_3_4 -->
<g id="node301" class="node">
<title>expert_agg_3_4</title>
<polygon fill="#99ff99" stroke="black" points="17393.5,-1669 17222.5,-1669 17222.5,-1616 17393.5,-1616 17393.5,-1669"/>
<text text-anchor="middle" x="17308" y="-1653.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 4</text>
<text text-anchor="middle" x="17308" y="-1638.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="17308" y="-1623.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_3_4_0&#45;&gt;expert_agg_3_4 -->
<g id="edge321" class="edge">
<title>expert_3_4_0&#45;&gt;expert_agg_3_4</title>
<path fill="none" stroke="black" d="M17308,-1755.84C17308,-1755.84 17308,-1679.06 17308,-1679.06"/>
<polygon fill="black" stroke="black" points="17311.5,-1679.06 17308,-1669.06 17304.5,-1679.06 17311.5,-1679.06"/>
</g>
<!-- expert_agg_3_4&#45;&gt;layer_norm_3 -->
<g id="edge322" class="edge">
<title>expert_agg_3_4&#45;&gt;layer_norm_3</title>
<path fill="none" stroke="black" d="M17308,-1615.7C17308,-1574.42 17308,-1500 17308,-1500 17308,-1500 16541.24,-1500 16541.24,-1500"/>
<polygon fill="black" stroke="black" points="16541.24,-1496.5 16531.24,-1500 16541.24,-1503.5 16541.24,-1496.5"/>
</g>
<!-- expert_3_4_1 -->
<g id="node302" class="node">
<title>expert_3_4_1</title>
<polygon fill="#99ff99" stroke="black" points="12181.5,-2651.5 12086.5,-2651.5 12086.5,-2598.5 12181.5,-2598.5 12181.5,-2651.5"/>
<text text-anchor="middle" x="12134" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="12134" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="12134" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_3_4_2 -->
<g id="node303" class="node">
<title>expert_3_4_2</title>
<polygon fill="#99ff99" stroke="black" points="12028.5,-2651.5 11933.5,-2651.5 11933.5,-2598.5 12028.5,-2598.5 12028.5,-2651.5"/>
<text text-anchor="middle" x="11981" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="11981" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="11981" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_3_4_3 -->
<g id="node304" class="node">
<title>expert_3_4_3</title>
<polygon fill="#99ff99" stroke="black" points="11875.5,-2651.5 11780.5,-2651.5 11780.5,-2598.5 11875.5,-2598.5 11875.5,-2651.5"/>
<text text-anchor="middle" x="11828" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="11828" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="11828" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_gate_3_5 -->
<g id="node305" class="node">
<title>expert_gate_3_5</title>
<polygon fill="#99ffcc" stroke="black" points="17137.5,-1949 17020.5,-1949 17020.5,-1896 17137.5,-1896 17137.5,-1949"/>
<text text-anchor="middle" x="17079" y="-1933.8" font-family="Times,serif" font-size="14.00">Expert Gate 5</text>
<text text-anchor="middle" x="17079" y="-1918.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="17079" y="-1903.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_3_5_0 -->
<g id="node306" class="node">
<title>expert_3_5_0</title>
<polygon fill="#99ffcc" stroke="black" points="17126.5,-1809 17031.5,-1809 17031.5,-1756 17126.5,-1756 17126.5,-1809"/>
<text text-anchor="middle" x="17079" y="-1793.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="17079" y="-1778.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="17079" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_gate_3_5&#45;&gt;expert_3_5_0 -->
<g id="edge323" class="edge">
<title>expert_gate_3_5&#45;&gt;expert_3_5_0</title>
<path fill="none" stroke="black" d="M17079,-1895.84C17079,-1895.84 17079,-1819.06 17079,-1819.06"/>
<polygon fill="black" stroke="black" points="17082.5,-1819.06 17079,-1809.06 17075.5,-1819.06 17082.5,-1819.06"/>
</g>
<!-- expert_agg_3_5 -->
<g id="node307" class="node">
<title>expert_agg_3_5</title>
<polygon fill="#99ffcc" stroke="black" points="17164.5,-1669 16993.5,-1669 16993.5,-1616 17164.5,-1616 17164.5,-1669"/>
<text text-anchor="middle" x="17079" y="-1653.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 5</text>
<text text-anchor="middle" x="17079" y="-1638.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="17079" y="-1623.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_3_5_0&#45;&gt;expert_agg_3_5 -->
<g id="edge324" class="edge">
<title>expert_3_5_0&#45;&gt;expert_agg_3_5</title>
<path fill="none" stroke="black" d="M17079,-1755.84C17079,-1755.84 17079,-1679.06 17079,-1679.06"/>
<polygon fill="black" stroke="black" points="17082.5,-1679.06 17079,-1669.06 17075.5,-1679.06 17082.5,-1679.06"/>
</g>
<!-- expert_agg_3_5&#45;&gt;layer_norm_3 -->
<g id="edge325" class="edge">
<title>expert_agg_3_5&#45;&gt;layer_norm_3</title>
<path fill="none" stroke="black" d="M17079,-1615.69C17079,-1576.97 17079,-1510 17079,-1510 17079,-1510 16532.43,-1510 16532.43,-1510"/>
<polygon fill="black" stroke="black" points="16532.43,-1506.5 16522.43,-1510 16532.43,-1513.5 16532.43,-1506.5"/>
</g>
<!-- expert_3_5_1 -->
<g id="node308" class="node">
<title>expert_3_5_1</title>
<polygon fill="#99ffcc" stroke="black" points="11722.5,-2651.5 11627.5,-2651.5 11627.5,-2598.5 11722.5,-2598.5 11722.5,-2651.5"/>
<text text-anchor="middle" x="11675" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="11675" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="11675" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_3_5_2 -->
<g id="node309" class="node">
<title>expert_3_5_2</title>
<polygon fill="#99ffcc" stroke="black" points="11569.5,-2651.5 11474.5,-2651.5 11474.5,-2598.5 11569.5,-2598.5 11569.5,-2651.5"/>
<text text-anchor="middle" x="11522" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="11522" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="11522" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_3_5_3 -->
<g id="node310" class="node">
<title>expert_3_5_3</title>
<polygon fill="#99ffcc" stroke="black" points="11416.5,-2651.5 11321.5,-2651.5 11321.5,-2598.5 11416.5,-2598.5 11416.5,-2651.5"/>
<text text-anchor="middle" x="11369" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="11369" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="11369" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_gate_3_6 -->
<g id="node311" class="node">
<title>expert_gate_3_6</title>
<polygon fill="#99ffff" stroke="black" points="16908.5,-1949 16791.5,-1949 16791.5,-1896 16908.5,-1896 16908.5,-1949"/>
<text text-anchor="middle" x="16850" y="-1933.8" font-family="Times,serif" font-size="14.00">Expert Gate 6</text>
<text text-anchor="middle" x="16850" y="-1918.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="16850" y="-1903.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_3_6_0 -->
<g id="node312" class="node">
<title>expert_3_6_0</title>
<polygon fill="#99ffff" stroke="black" points="16897.5,-1809 16802.5,-1809 16802.5,-1756 16897.5,-1756 16897.5,-1809"/>
<text text-anchor="middle" x="16850" y="-1793.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="16850" y="-1778.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="16850" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_gate_3_6&#45;&gt;expert_3_6_0 -->
<g id="edge326" class="edge">
<title>expert_gate_3_6&#45;&gt;expert_3_6_0</title>
<path fill="none" stroke="black" d="M16850,-1895.84C16850,-1895.84 16850,-1819.06 16850,-1819.06"/>
<polygon fill="black" stroke="black" points="16853.5,-1819.06 16850,-1809.06 16846.5,-1819.06 16853.5,-1819.06"/>
</g>
<!-- expert_agg_3_6 -->
<g id="node313" class="node">
<title>expert_agg_3_6</title>
<polygon fill="#99ffff" stroke="black" points="16935.5,-1669 16764.5,-1669 16764.5,-1616 16935.5,-1616 16935.5,-1669"/>
<text text-anchor="middle" x="16850" y="-1653.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 6</text>
<text text-anchor="middle" x="16850" y="-1638.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="16850" y="-1623.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_3_6_0&#45;&gt;expert_agg_3_6 -->
<g id="edge327" class="edge">
<title>expert_3_6_0&#45;&gt;expert_agg_3_6</title>
<path fill="none" stroke="black" d="M16850,-1755.84C16850,-1755.84 16850,-1679.06 16850,-1679.06"/>
<polygon fill="black" stroke="black" points="16853.5,-1679.06 16850,-1669.06 16846.5,-1679.06 16853.5,-1679.06"/>
</g>
<!-- expert_agg_3_6&#45;&gt;layer_norm_3 -->
<g id="edge328" class="edge">
<title>expert_agg_3_6&#45;&gt;layer_norm_3</title>
<path fill="none" stroke="black" d="M16850,-1615.7C16850,-1579.38 16850,-1519 16850,-1519 16850,-1519 16516.9,-1519 16516.9,-1519"/>
<polygon fill="black" stroke="black" points="16516.9,-1515.5 16506.9,-1519 16516.9,-1522.5 16516.9,-1515.5"/>
</g>
<!-- expert_3_6_1 -->
<g id="node314" class="node">
<title>expert_3_6_1</title>
<polygon fill="#99ffff" stroke="black" points="11263.5,-2651.5 11168.5,-2651.5 11168.5,-2598.5 11263.5,-2598.5 11263.5,-2651.5"/>
<text text-anchor="middle" x="11216" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="11216" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="11216" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_3_6_2 -->
<g id="node315" class="node">
<title>expert_3_6_2</title>
<polygon fill="#99ffff" stroke="black" points="11110.5,-2651.5 11015.5,-2651.5 11015.5,-2598.5 11110.5,-2598.5 11110.5,-2651.5"/>
<text text-anchor="middle" x="11063" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="11063" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="11063" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_3_6_3 -->
<g id="node316" class="node">
<title>expert_3_6_3</title>
<polygon fill="#99ffff" stroke="black" points="10957.5,-2651.5 10862.5,-2651.5 10862.5,-2598.5 10957.5,-2598.5 10957.5,-2651.5"/>
<text text-anchor="middle" x="10910" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="10910" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="10910" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_gate_3_7 -->
<g id="node317" class="node">
<title>expert_gate_3_7</title>
<polygon fill="#99ccff" stroke="black" points="16679.5,-1949 16562.5,-1949 16562.5,-1896 16679.5,-1896 16679.5,-1949"/>
<text text-anchor="middle" x="16621" y="-1933.8" font-family="Times,serif" font-size="14.00">Expert Gate 7</text>
<text text-anchor="middle" x="16621" y="-1918.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="16621" y="-1903.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_3_7_0 -->
<g id="node318" class="node">
<title>expert_3_7_0</title>
<polygon fill="#99ccff" stroke="black" points="16668.5,-1809 16573.5,-1809 16573.5,-1756 16668.5,-1756 16668.5,-1809"/>
<text text-anchor="middle" x="16621" y="-1793.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="16621" y="-1778.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="16621" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_gate_3_7&#45;&gt;expert_3_7_0 -->
<g id="edge329" class="edge">
<title>expert_gate_3_7&#45;&gt;expert_3_7_0</title>
<path fill="none" stroke="black" d="M16621,-1895.84C16621,-1895.84 16621,-1819.06 16621,-1819.06"/>
<polygon fill="black" stroke="black" points="16624.5,-1819.06 16621,-1809.06 16617.5,-1819.06 16624.5,-1819.06"/>
</g>
<!-- expert_agg_3_7 -->
<g id="node319" class="node">
<title>expert_agg_3_7</title>
<polygon fill="#99ccff" stroke="black" points="16706.5,-1669 16535.5,-1669 16535.5,-1616 16706.5,-1616 16706.5,-1669"/>
<text text-anchor="middle" x="16621" y="-1653.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 7</text>
<text text-anchor="middle" x="16621" y="-1638.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="16621" y="-1623.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_3_7_0&#45;&gt;expert_agg_3_7 -->
<g id="edge330" class="edge">
<title>expert_3_7_0&#45;&gt;expert_agg_3_7</title>
<path fill="none" stroke="black" d="M16621,-1755.84C16621,-1755.84 16621,-1679.06 16621,-1679.06"/>
<polygon fill="black" stroke="black" points="16624.5,-1679.06 16621,-1669.06 16617.5,-1679.06 16624.5,-1679.06"/>
</g>
<!-- expert_agg_3_7&#45;&gt;layer_norm_3 -->
<g id="edge331" class="edge">
<title>expert_agg_3_7&#45;&gt;layer_norm_3</title>
<path fill="none" stroke="black" d="M16535.19,-1642C16527.62,-1642 16522.75,-1642 16522.75,-1642 16522.75,-1642 16522.75,-1519.95 16522.75,-1519.95"/>
<polygon fill="black" stroke="black" points="16526.25,-1519.95 16522.75,-1509.95 16519.25,-1519.95 16526.25,-1519.95"/>
</g>
<!-- expert_3_7_1 -->
<g id="node320" class="node">
<title>expert_3_7_1</title>
<polygon fill="#99ccff" stroke="black" points="10804.5,-2651.5 10709.5,-2651.5 10709.5,-2598.5 10804.5,-2598.5 10804.5,-2651.5"/>
<text text-anchor="middle" x="10757" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="10757" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="10757" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_3_7_2 -->
<g id="node321" class="node">
<title>expert_3_7_2</title>
<polygon fill="#99ccff" stroke="black" points="10651.5,-2651.5 10556.5,-2651.5 10556.5,-2598.5 10651.5,-2598.5 10651.5,-2651.5"/>
<text text-anchor="middle" x="10604" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="10604" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="10604" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_3_7_3 -->
<g id="node322" class="node">
<title>expert_3_7_3</title>
<polygon fill="#99ccff" stroke="black" points="10498.5,-2651.5 10403.5,-2651.5 10403.5,-2598.5 10498.5,-2598.5 10498.5,-2651.5"/>
<text text-anchor="middle" x="10451" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="10451" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="10451" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_gate_3_8 -->
<g id="node323" class="node">
<title>expert_gate_3_8</title>
<polygon fill="#9999ff" stroke="black" points="16450.5,-1949 16333.5,-1949 16333.5,-1896 16450.5,-1896 16450.5,-1949"/>
<text text-anchor="middle" x="16392" y="-1933.8" font-family="Times,serif" font-size="14.00">Expert Gate 8</text>
<text text-anchor="middle" x="16392" y="-1918.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="16392" y="-1903.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_3_8_0 -->
<g id="node324" class="node">
<title>expert_3_8_0</title>
<polygon fill="#9999ff" stroke="black" points="16439.5,-1809 16344.5,-1809 16344.5,-1756 16439.5,-1756 16439.5,-1809"/>
<text text-anchor="middle" x="16392" y="-1793.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="16392" y="-1778.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="16392" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_gate_3_8&#45;&gt;expert_3_8_0 -->
<g id="edge332" class="edge">
<title>expert_gate_3_8&#45;&gt;expert_3_8_0</title>
<path fill="none" stroke="black" d="M16392,-1895.84C16392,-1895.84 16392,-1819.06 16392,-1819.06"/>
<polygon fill="black" stroke="black" points="16395.5,-1819.06 16392,-1809.06 16388.5,-1819.06 16395.5,-1819.06"/>
</g>
<!-- expert_agg_3_8 -->
<g id="node325" class="node">
<title>expert_agg_3_8</title>
<polygon fill="#9999ff" stroke="black" points="16477.5,-1669 16306.5,-1669 16306.5,-1616 16477.5,-1616 16477.5,-1669"/>
<text text-anchor="middle" x="16392" y="-1653.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 8</text>
<text text-anchor="middle" x="16392" y="-1638.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="16392" y="-1623.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_3_8_0&#45;&gt;expert_agg_3_8 -->
<g id="edge333" class="edge">
<title>expert_3_8_0&#45;&gt;expert_agg_3_8</title>
<path fill="none" stroke="black" d="M16392,-1755.84C16392,-1755.84 16392,-1679.06 16392,-1679.06"/>
<polygon fill="black" stroke="black" points="16395.5,-1679.06 16392,-1669.06 16388.5,-1679.06 16395.5,-1679.06"/>
</g>
<!-- expert_agg_3_8&#45;&gt;layer_norm_3 -->
<g id="edge334" class="edge">
<title>expert_agg_3_8&#45;&gt;layer_norm_3</title>
<path fill="none" stroke="black" d="M16423.25,-1615.85C16423.25,-1615.85 16423.25,-1536.95 16423.25,-1536.95"/>
<polygon fill="black" stroke="black" points="16426.75,-1536.95 16423.25,-1526.95 16419.75,-1536.95 16426.75,-1536.95"/>
</g>
<!-- expert_3_8_1 -->
<g id="node326" class="node">
<title>expert_3_8_1</title>
<polygon fill="#9999ff" stroke="black" points="10345.5,-2651.5 10250.5,-2651.5 10250.5,-2598.5 10345.5,-2598.5 10345.5,-2651.5"/>
<text text-anchor="middle" x="10298" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="10298" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="10298" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_3_8_2 -->
<g id="node327" class="node">
<title>expert_3_8_2</title>
<polygon fill="#9999ff" stroke="black" points="10192.5,-2651.5 10097.5,-2651.5 10097.5,-2598.5 10192.5,-2598.5 10192.5,-2651.5"/>
<text text-anchor="middle" x="10145" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="10145" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="10145" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_3_8_3 -->
<g id="node328" class="node">
<title>expert_3_8_3</title>
<polygon fill="#9999ff" stroke="black" points="10039.5,-2651.5 9944.5,-2651.5 9944.5,-2598.5 10039.5,-2598.5 10039.5,-2651.5"/>
<text text-anchor="middle" x="9992" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9992" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="9992" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_gate_3_9 -->
<g id="node329" class="node">
<title>expert_gate_3_9</title>
<polygon fill="#cc99ff" stroke="black" points="16221.5,-1949 16104.5,-1949 16104.5,-1896 16221.5,-1896 16221.5,-1949"/>
<text text-anchor="middle" x="16163" y="-1933.8" font-family="Times,serif" font-size="14.00">Expert Gate 9</text>
<text text-anchor="middle" x="16163" y="-1918.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="16163" y="-1903.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_3_9_0 -->
<g id="node330" class="node">
<title>expert_3_9_0</title>
<polygon fill="#cc99ff" stroke="black" points="16210.5,-1809 16115.5,-1809 16115.5,-1756 16210.5,-1756 16210.5,-1809"/>
<text text-anchor="middle" x="16163" y="-1793.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="16163" y="-1778.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="16163" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_gate_3_9&#45;&gt;expert_3_9_0 -->
<g id="edge335" class="edge">
<title>expert_gate_3_9&#45;&gt;expert_3_9_0</title>
<path fill="none" stroke="black" d="M16163,-1895.84C16163,-1895.84 16163,-1819.06 16163,-1819.06"/>
<polygon fill="black" stroke="black" points="16166.5,-1819.06 16163,-1809.06 16159.5,-1819.06 16166.5,-1819.06"/>
</g>
<!-- expert_agg_3_9 -->
<g id="node331" class="node">
<title>expert_agg_3_9</title>
<polygon fill="#cc99ff" stroke="black" points="16248.5,-1669 16077.5,-1669 16077.5,-1616 16248.5,-1616 16248.5,-1669"/>
<text text-anchor="middle" x="16163" y="-1653.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 9</text>
<text text-anchor="middle" x="16163" y="-1638.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="16163" y="-1623.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_3_9_0&#45;&gt;expert_agg_3_9 -->
<g id="edge336" class="edge">
<title>expert_3_9_0&#45;&gt;expert_agg_3_9</title>
<path fill="none" stroke="black" d="M16163,-1755.84C16163,-1755.84 16163,-1679.06 16163,-1679.06"/>
<polygon fill="black" stroke="black" points="16166.5,-1679.06 16163,-1669.06 16159.5,-1679.06 16166.5,-1679.06"/>
</g>
<!-- expert_agg_3_9&#45;&gt;layer_norm_3 -->
<g id="edge337" class="edge">
<title>expert_agg_3_9&#45;&gt;layer_norm_3</title>
<path fill="none" stroke="black" d="M16220.25,-1615.7C16220.25,-1579.38 16220.25,-1519 16220.25,-1519 16220.25,-1519 16385.14,-1519 16385.14,-1519"/>
<polygon fill="black" stroke="black" points="16385.14,-1522.5 16395.14,-1519 16385.14,-1515.5 16385.14,-1522.5"/>
</g>
<!-- expert_3_9_1 -->
<g id="node332" class="node">
<title>expert_3_9_1</title>
<polygon fill="#cc99ff" stroke="black" points="9886.5,-2651.5 9791.5,-2651.5 9791.5,-2598.5 9886.5,-2598.5 9886.5,-2651.5"/>
<text text-anchor="middle" x="9839" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="9839" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="9839" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_3_9_2 -->
<g id="node333" class="node">
<title>expert_3_9_2</title>
<polygon fill="#cc99ff" stroke="black" points="9733.5,-2651.5 9638.5,-2651.5 9638.5,-2598.5 9733.5,-2598.5 9733.5,-2651.5"/>
<text text-anchor="middle" x="9686" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="9686" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="9686" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_3_9_3 -->
<g id="node334" class="node">
<title>expert_3_9_3</title>
<polygon fill="#cc99ff" stroke="black" points="9580.5,-2651.5 9485.5,-2651.5 9485.5,-2598.5 9580.5,-2598.5 9580.5,-2651.5"/>
<text text-anchor="middle" x="9533" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9533" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="9533" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_gate_3_10 -->
<g id="node335" class="node">
<title>expert_gate_3_10</title>
<polygon fill="#ff99ff" stroke="black" points="15992,-1949 15866,-1949 15866,-1896 15992,-1896 15992,-1949"/>
<text text-anchor="middle" x="15929" y="-1933.8" font-family="Times,serif" font-size="14.00">Expert Gate 10</text>
<text text-anchor="middle" x="15929" y="-1918.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="15929" y="-1903.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_3_10_0 -->
<g id="node336" class="node">
<title>expert_3_10_0</title>
<polygon fill="#ff99ff" stroke="black" points="15976.5,-1809 15881.5,-1809 15881.5,-1756 15976.5,-1756 15976.5,-1809"/>
<text text-anchor="middle" x="15929" y="-1793.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="15929" y="-1778.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="15929" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_gate_3_10&#45;&gt;expert_3_10_0 -->
<g id="edge338" class="edge">
<title>expert_gate_3_10&#45;&gt;expert_3_10_0</title>
<path fill="none" stroke="black" d="M15929,-1895.84C15929,-1895.84 15929,-1819.06 15929,-1819.06"/>
<polygon fill="black" stroke="black" points="15932.5,-1819.06 15929,-1809.06 15925.5,-1819.06 15932.5,-1819.06"/>
</g>
<!-- expert_agg_3_10 -->
<g id="node337" class="node">
<title>expert_agg_3_10</title>
<polygon fill="#ff99ff" stroke="black" points="16019,-1669 15839,-1669 15839,-1616 16019,-1616 16019,-1669"/>
<text text-anchor="middle" x="15929" y="-1653.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 10</text>
<text text-anchor="middle" x="15929" y="-1638.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="15929" y="-1623.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_3_10_0&#45;&gt;expert_agg_3_10 -->
<g id="edge339" class="edge">
<title>expert_3_10_0&#45;&gt;expert_agg_3_10</title>
<path fill="none" stroke="black" d="M15929,-1755.84C15929,-1755.84 15929,-1679.06 15929,-1679.06"/>
<polygon fill="black" stroke="black" points="15932.5,-1679.06 15929,-1669.06 15925.5,-1679.06 15932.5,-1679.06"/>
</g>
<!-- expert_agg_3_10&#45;&gt;layer_norm_3 -->
<g id="edge340" class="edge">
<title>expert_agg_3_10&#45;&gt;layer_norm_3</title>
<path fill="none" stroke="black" d="M16009.75,-1615.69C16009.75,-1576.97 16009.75,-1510 16009.75,-1510 16009.75,-1510 16369.62,-1510 16369.62,-1510"/>
<polygon fill="black" stroke="black" points="16369.62,-1513.5 16379.62,-1510 16369.62,-1506.5 16369.62,-1513.5"/>
</g>
<!-- expert_3_10_1 -->
<g id="node338" class="node">
<title>expert_3_10_1</title>
<polygon fill="#ff99ff" stroke="black" points="9427.5,-2651.5 9332.5,-2651.5 9332.5,-2598.5 9427.5,-2598.5 9427.5,-2651.5"/>
<text text-anchor="middle" x="9380" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="9380" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="9380" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_3_10_2 -->
<g id="node339" class="node">
<title>expert_3_10_2</title>
<polygon fill="#ff99ff" stroke="black" points="9274.5,-2651.5 9179.5,-2651.5 9179.5,-2598.5 9274.5,-2598.5 9274.5,-2651.5"/>
<text text-anchor="middle" x="9227" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="9227" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="9227" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_3_10_3 -->
<g id="node340" class="node">
<title>expert_3_10_3</title>
<polygon fill="#ff99ff" stroke="black" points="9121.5,-2651.5 9026.5,-2651.5 9026.5,-2598.5 9121.5,-2598.5 9121.5,-2651.5"/>
<text text-anchor="middle" x="9074" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9074" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="9074" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_gate_3_11 -->
<g id="node341" class="node">
<title>expert_gate_3_11</title>
<polygon fill="#ff99cc" stroke="black" points="15754,-1949 15628,-1949 15628,-1896 15754,-1896 15754,-1949"/>
<text text-anchor="middle" x="15691" y="-1933.8" font-family="Times,serif" font-size="14.00">Expert Gate 11</text>
<text text-anchor="middle" x="15691" y="-1918.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="15691" y="-1903.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_3_11_0 -->
<g id="node342" class="node">
<title>expert_3_11_0</title>
<polygon fill="#ff99cc" stroke="black" points="15738.5,-1809 15643.5,-1809 15643.5,-1756 15738.5,-1756 15738.5,-1809"/>
<text text-anchor="middle" x="15691" y="-1793.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="15691" y="-1778.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="15691" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_gate_3_11&#45;&gt;expert_3_11_0 -->
<g id="edge341" class="edge">
<title>expert_gate_3_11&#45;&gt;expert_3_11_0</title>
<path fill="none" stroke="black" d="M15691,-1895.84C15691,-1895.84 15691,-1819.06 15691,-1819.06"/>
<polygon fill="black" stroke="black" points="15694.5,-1819.06 15691,-1809.06 15687.5,-1819.06 15694.5,-1819.06"/>
</g>
<!-- expert_agg_3_11 -->
<g id="node343" class="node">
<title>expert_agg_3_11</title>
<polygon fill="#ff99cc" stroke="black" points="15781,-1669 15601,-1669 15601,-1616 15781,-1616 15781,-1669"/>
<text text-anchor="middle" x="15691" y="-1653.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 11</text>
<text text-anchor="middle" x="15691" y="-1638.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="15691" y="-1623.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_3_11_0&#45;&gt;expert_agg_3_11 -->
<g id="edge342" class="edge">
<title>expert_3_11_0&#45;&gt;expert_agg_3_11</title>
<path fill="none" stroke="black" d="M15691,-1755.84C15691,-1755.84 15691,-1679.06 15691,-1679.06"/>
<polygon fill="black" stroke="black" points="15694.5,-1679.06 15691,-1669.06 15687.5,-1679.06 15694.5,-1679.06"/>
</g>
<!-- expert_agg_3_11&#45;&gt;layer_norm_3 -->
<g id="edge343" class="edge">
<title>expert_agg_3_11&#45;&gt;layer_norm_3</title>
<path fill="none" stroke="black" d="M15765.5,-1615.7C15765.5,-1574.42 15765.5,-1500 15765.5,-1500 15765.5,-1500 16361.02,-1500 16361.02,-1500"/>
<polygon fill="black" stroke="black" points="16361.02,-1503.5 16371.02,-1500 16361.02,-1496.5 16361.02,-1503.5"/>
</g>
<!-- expert_3_11_1 -->
<g id="node344" class="node">
<title>expert_3_11_1</title>
<polygon fill="#ff99cc" stroke="black" points="8968.5,-2651.5 8873.5,-2651.5 8873.5,-2598.5 8968.5,-2598.5 8968.5,-2651.5"/>
<text text-anchor="middle" x="8921" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8921" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="8921" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_3_11_2 -->
<g id="node345" class="node">
<title>expert_3_11_2</title>
<polygon fill="#ff99cc" stroke="black" points="8815.5,-2651.5 8720.5,-2651.5 8720.5,-2598.5 8815.5,-2598.5 8815.5,-2651.5"/>
<text text-anchor="middle" x="8768" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="8768" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="8768" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_3_11_3 -->
<g id="node346" class="node">
<title>expert_3_11_3</title>
<polygon fill="#ff99cc" stroke="black" points="8662.5,-2651.5 8567.5,-2651.5 8567.5,-2598.5 8662.5,-2598.5 8662.5,-2651.5"/>
<text text-anchor="middle" x="8615" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="8615" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="8615" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_gate_3_12 -->
<g id="node347" class="node">
<title>expert_gate_3_12</title>
<polygon fill="#ffb366" stroke="black" points="15516,-1949 15390,-1949 15390,-1896 15516,-1896 15516,-1949"/>
<text text-anchor="middle" x="15453" y="-1933.8" font-family="Times,serif" font-size="14.00">Expert Gate 12</text>
<text text-anchor="middle" x="15453" y="-1918.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="15453" y="-1903.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_3_12_0 -->
<g id="node348" class="node">
<title>expert_3_12_0</title>
<polygon fill="#ffb366" stroke="black" points="15500.5,-1809 15405.5,-1809 15405.5,-1756 15500.5,-1756 15500.5,-1809"/>
<text text-anchor="middle" x="15453" y="-1793.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="15453" y="-1778.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="15453" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_gate_3_12&#45;&gt;expert_3_12_0 -->
<g id="edge344" class="edge">
<title>expert_gate_3_12&#45;&gt;expert_3_12_0</title>
<path fill="none" stroke="black" d="M15453,-1895.84C15453,-1895.84 15453,-1819.06 15453,-1819.06"/>
<polygon fill="black" stroke="black" points="15456.5,-1819.06 15453,-1809.06 15449.5,-1819.06 15456.5,-1819.06"/>
</g>
<!-- expert_agg_3_12 -->
<g id="node349" class="node">
<title>expert_agg_3_12</title>
<polygon fill="#ffb366" stroke="black" points="15543,-1669 15363,-1669 15363,-1616 15543,-1616 15543,-1669"/>
<text text-anchor="middle" x="15453" y="-1653.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 12</text>
<text text-anchor="middle" x="15453" y="-1638.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="15453" y="-1623.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_3_12_0&#45;&gt;expert_agg_3_12 -->
<g id="edge345" class="edge">
<title>expert_3_12_0&#45;&gt;expert_agg_3_12</title>
<path fill="none" stroke="black" d="M15453,-1755.84C15453,-1755.84 15453,-1679.06 15453,-1679.06"/>
<polygon fill="black" stroke="black" points="15456.5,-1679.06 15453,-1669.06 15449.5,-1679.06 15456.5,-1679.06"/>
</g>
<!-- expert_agg_3_12&#45;&gt;layer_norm_3 -->
<g id="edge346" class="edge">
<title>expert_agg_3_12&#45;&gt;layer_norm_3</title>
<path fill="none" stroke="black" d="M15483.75,-1615.76C15483.75,-1572.27 15483.75,-1491 15483.75,-1491 15483.75,-1491 16358.95,-1491 16358.95,-1491"/>
<polygon fill="black" stroke="black" points="16358.95,-1494.5 16368.95,-1491 16358.95,-1487.5 16358.95,-1494.5"/>
</g>
<!-- expert_3_12_1 -->
<g id="node350" class="node">
<title>expert_3_12_1</title>
<polygon fill="#ffb366" stroke="black" points="8509.5,-2651.5 8414.5,-2651.5 8414.5,-2598.5 8509.5,-2598.5 8509.5,-2651.5"/>
<text text-anchor="middle" x="8462" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8462" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="8462" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_3_12_2 -->
<g id="node351" class="node">
<title>expert_3_12_2</title>
<polygon fill="#ffb366" stroke="black" points="8356.5,-2651.5 8261.5,-2651.5 8261.5,-2598.5 8356.5,-2598.5 8356.5,-2651.5"/>
<text text-anchor="middle" x="8309" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="8309" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="8309" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_3_12_3 -->
<g id="node352" class="node">
<title>expert_3_12_3</title>
<polygon fill="#ffb366" stroke="black" points="8203.5,-2651.5 8108.5,-2651.5 8108.5,-2598.5 8203.5,-2598.5 8203.5,-2651.5"/>
<text text-anchor="middle" x="8156" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="8156" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="8156" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_gate_3_13 -->
<g id="node353" class="node">
<title>expert_gate_3_13</title>
<polygon fill="#b3ff66" stroke="black" points="15278,-1949 15152,-1949 15152,-1896 15278,-1896 15278,-1949"/>
<text text-anchor="middle" x="15215" y="-1933.8" font-family="Times,serif" font-size="14.00">Expert Gate 13</text>
<text text-anchor="middle" x="15215" y="-1918.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="15215" y="-1903.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_3_13_0 -->
<g id="node354" class="node">
<title>expert_3_13_0</title>
<polygon fill="#b3ff66" stroke="black" points="15262.5,-1809 15167.5,-1809 15167.5,-1756 15262.5,-1756 15262.5,-1809"/>
<text text-anchor="middle" x="15215" y="-1793.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="15215" y="-1778.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="15215" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_gate_3_13&#45;&gt;expert_3_13_0 -->
<g id="edge347" class="edge">
<title>expert_gate_3_13&#45;&gt;expert_3_13_0</title>
<path fill="none" stroke="black" d="M15215,-1895.84C15215,-1895.84 15215,-1819.06 15215,-1819.06"/>
<polygon fill="black" stroke="black" points="15218.5,-1819.06 15215,-1809.06 15211.5,-1819.06 15218.5,-1819.06"/>
</g>
<!-- expert_agg_3_13 -->
<g id="node355" class="node">
<title>expert_agg_3_13</title>
<polygon fill="#b3ff66" stroke="black" points="15305,-1669 15125,-1669 15125,-1616 15305,-1616 15305,-1669"/>
<text text-anchor="middle" x="15215" y="-1653.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 13</text>
<text text-anchor="middle" x="15215" y="-1638.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="15215" y="-1623.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_3_13_0&#45;&gt;expert_agg_3_13 -->
<g id="edge348" class="edge">
<title>expert_3_13_0&#45;&gt;expert_agg_3_13</title>
<path fill="none" stroke="black" d="M15215,-1755.84C15215,-1755.84 15215,-1679.06 15215,-1679.06"/>
<polygon fill="black" stroke="black" points="15218.5,-1679.06 15215,-1669.06 15211.5,-1679.06 15218.5,-1679.06"/>
</g>
<!-- expert_agg_3_13&#45;&gt;layer_norm_3 -->
<g id="edge349" class="edge">
<title>expert_agg_3_13&#45;&gt;layer_norm_3</title>
<path fill="none" stroke="black" d="M15268.5,-1616C15268.5,-1570.41 15268.5,-1482 15268.5,-1482 15268.5,-1482 16361.58,-1482 16361.58,-1482"/>
<polygon fill="black" stroke="black" points="16361.58,-1485.5 16371.58,-1482 16361.58,-1478.5 16361.58,-1485.5"/>
</g>
<!-- expert_3_13_1 -->
<g id="node356" class="node">
<title>expert_3_13_1</title>
<polygon fill="#b3ff66" stroke="black" points="8050.5,-2651.5 7955.5,-2651.5 7955.5,-2598.5 8050.5,-2598.5 8050.5,-2651.5"/>
<text text-anchor="middle" x="8003" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8003" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="8003" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_3_13_2 -->
<g id="node357" class="node">
<title>expert_3_13_2</title>
<polygon fill="#b3ff66" stroke="black" points="7897.5,-2651.5 7802.5,-2651.5 7802.5,-2598.5 7897.5,-2598.5 7897.5,-2651.5"/>
<text text-anchor="middle" x="7850" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="7850" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="7850" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_3_13_3 -->
<g id="node358" class="node">
<title>expert_3_13_3</title>
<polygon fill="#b3ff66" stroke="black" points="7744.5,-2651.5 7649.5,-2651.5 7649.5,-2598.5 7744.5,-2598.5 7744.5,-2651.5"/>
<text text-anchor="middle" x="7697" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7697" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="7697" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_gate_3_14 -->
<g id="node359" class="node">
<title>expert_gate_3_14</title>
<polygon fill="#66ffb3" stroke="black" points="15040,-1949 14914,-1949 14914,-1896 15040,-1896 15040,-1949"/>
<text text-anchor="middle" x="14977" y="-1933.8" font-family="Times,serif" font-size="14.00">Expert Gate 14</text>
<text text-anchor="middle" x="14977" y="-1918.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="14977" y="-1903.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_3_14_0 -->
<g id="node360" class="node">
<title>expert_3_14_0</title>
<polygon fill="#66ffb3" stroke="black" points="15024.5,-1809 14929.5,-1809 14929.5,-1756 15024.5,-1756 15024.5,-1809"/>
<text text-anchor="middle" x="14977" y="-1793.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="14977" y="-1778.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="14977" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_gate_3_14&#45;&gt;expert_3_14_0 -->
<g id="edge350" class="edge">
<title>expert_gate_3_14&#45;&gt;expert_3_14_0</title>
<path fill="none" stroke="black" d="M14977,-1895.84C14977,-1895.84 14977,-1819.06 14977,-1819.06"/>
<polygon fill="black" stroke="black" points="14980.5,-1819.06 14977,-1809.06 14973.5,-1819.06 14980.5,-1819.06"/>
</g>
<!-- expert_agg_3_14 -->
<g id="node361" class="node">
<title>expert_agg_3_14</title>
<polygon fill="#66ffb3" stroke="black" points="15067,-1669 14887,-1669 14887,-1616 15067,-1616 15067,-1669"/>
<text text-anchor="middle" x="14977" y="-1653.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 14</text>
<text text-anchor="middle" x="14977" y="-1638.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="14977" y="-1623.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_3_14_0&#45;&gt;expert_agg_3_14 -->
<g id="edge351" class="edge">
<title>expert_3_14_0&#45;&gt;expert_agg_3_14</title>
<path fill="none" stroke="black" d="M14977,-1755.84C14977,-1755.84 14977,-1679.06 14977,-1679.06"/>
<polygon fill="black" stroke="black" points="14980.5,-1679.06 14977,-1669.06 14973.5,-1679.06 14980.5,-1679.06"/>
</g>
<!-- expert_agg_3_14&#45;&gt;layer_norm_3 -->
<g id="edge352" class="edge">
<title>expert_agg_3_14&#45;&gt;layer_norm_3</title>
<path fill="none" stroke="black" d="M15053.5,-1615.86C15053.5,-1567.91 15053.5,-1472 15053.5,-1472 15053.5,-1472 16370.74,-1472 16370.74,-1472"/>
<polygon fill="black" stroke="black" points="16370.74,-1475.5 16380.74,-1472 16370.74,-1468.5 16370.74,-1475.5"/>
</g>
<!-- expert_3_14_1 -->
<g id="node362" class="node">
<title>expert_3_14_1</title>
<polygon fill="#66ffb3" stroke="black" points="7591.5,-2651.5 7496.5,-2651.5 7496.5,-2598.5 7591.5,-2598.5 7591.5,-2651.5"/>
<text text-anchor="middle" x="7544" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="7544" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="7544" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_3_14_2 -->
<g id="node363" class="node">
<title>expert_3_14_2</title>
<polygon fill="#66ffb3" stroke="black" points="7438.5,-2651.5 7343.5,-2651.5 7343.5,-2598.5 7438.5,-2598.5 7438.5,-2651.5"/>
<text text-anchor="middle" x="7391" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="7391" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="7391" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_3_14_3 -->
<g id="node364" class="node">
<title>expert_3_14_3</title>
<polygon fill="#66ffb3" stroke="black" points="7285.5,-2651.5 7190.5,-2651.5 7190.5,-2598.5 7285.5,-2598.5 7285.5,-2651.5"/>
<text text-anchor="middle" x="7238" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7238" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="7238" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_gate_3_15 -->
<g id="node365" class="node">
<title>expert_gate_3_15</title>
<polygon fill="#66b3ff" stroke="black" points="14802,-1949 14676,-1949 14676,-1896 14802,-1896 14802,-1949"/>
<text text-anchor="middle" x="14739" y="-1933.8" font-family="Times,serif" font-size="14.00">Expert Gate 15</text>
<text text-anchor="middle" x="14739" y="-1918.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="14739" y="-1903.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_3_15_0 -->
<g id="node366" class="node">
<title>expert_3_15_0</title>
<polygon fill="#66b3ff" stroke="black" points="14786.5,-1809 14691.5,-1809 14691.5,-1756 14786.5,-1756 14786.5,-1809"/>
<text text-anchor="middle" x="14739" y="-1793.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="14739" y="-1778.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="14739" y="-1763.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_gate_3_15&#45;&gt;expert_3_15_0 -->
<g id="edge353" class="edge">
<title>expert_gate_3_15&#45;&gt;expert_3_15_0</title>
<path fill="none" stroke="black" d="M14739,-1895.84C14739,-1895.84 14739,-1819.06 14739,-1819.06"/>
<polygon fill="black" stroke="black" points="14742.5,-1819.06 14739,-1809.06 14735.5,-1819.06 14742.5,-1819.06"/>
</g>
<!-- expert_agg_3_15 -->
<g id="node367" class="node">
<title>expert_agg_3_15</title>
<polygon fill="#66b3ff" stroke="black" points="14829,-1669 14649,-1669 14649,-1616 14829,-1616 14829,-1669"/>
<text text-anchor="middle" x="14739" y="-1653.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 15</text>
<text text-anchor="middle" x="14739" y="-1638.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="14739" y="-1623.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_3_15_0&#45;&gt;expert_agg_3_15 -->
<g id="edge354" class="edge">
<title>expert_3_15_0&#45;&gt;expert_agg_3_15</title>
<path fill="none" stroke="black" d="M14739,-1755.84C14739,-1755.84 14739,-1679.06 14739,-1679.06"/>
<polygon fill="black" stroke="black" points="14742.5,-1679.06 14739,-1669.06 14735.5,-1679.06 14742.5,-1679.06"/>
</g>
<!-- expert_agg_3_15&#45;&gt;layer_norm_3 -->
<g id="edge355" class="edge">
<title>expert_agg_3_15&#45;&gt;layer_norm_3</title>
<path fill="none" stroke="black" d="M14809.5,-1615.63C14809.5,-1565.55 14809.5,-1463 14809.5,-1463 14809.5,-1463 16387.32,-1463 16387.32,-1463"/>
<polygon fill="black" stroke="black" points="16387.32,-1466.5 16397.32,-1463 16387.32,-1459.5 16387.32,-1466.5"/>
</g>
<!-- expert_3_15_1 -->
<g id="node368" class="node">
<title>expert_3_15_1</title>
<polygon fill="#66b3ff" stroke="black" points="7132.5,-2651.5 7037.5,-2651.5 7037.5,-2598.5 7132.5,-2598.5 7132.5,-2651.5"/>
<text text-anchor="middle" x="7085" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="7085" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="7085" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_3_15_2 -->
<g id="node369" class="node">
<title>expert_3_15_2</title>
<polygon fill="#66b3ff" stroke="black" points="6979.5,-2651.5 6884.5,-2651.5 6884.5,-2598.5 6979.5,-2598.5 6979.5,-2651.5"/>
<text text-anchor="middle" x="6932" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="6932" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="6932" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_3_15_3 -->
<g id="node370" class="node">
<title>expert_3_15_3</title>
<polygon fill="#66b3ff" stroke="black" points="6826.5,-2651.5 6731.5,-2651.5 6731.5,-2598.5 6826.5,-2598.5 6826.5,-2651.5"/>
<text text-anchor="middle" x="6779" y="-2636.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6779" y="-2621.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="6779" y="-2606.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- attention_4_0_0 -->
<g id="node372" class="node">
<title>attention_4_0_0</title>
<polygon fill="#ff9999" stroke="black" points="16249.5,-1212 16076.5,-1212 16076.5,-1144 16249.5,-1144 16249.5,-1212"/>
<text text-anchor="middle" x="16163" y="-1196.8" font-family="Times,serif" font-size="14.00">Attention 0_0</text>
<text text-anchor="middle" x="16163" y="-1181.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="16163" y="-1166.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="16163" y="-1151.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- q_proj_4_0_0&#45;&gt;attention_4_0_0 -->
<g id="edge356" class="edge">
<title>q_proj_4_0_0&#45;&gt;attention_4_0_0</title>
<path fill="none" stroke="black" d="M16451,-1298.98C16451,-1253.36 16451,-1178 16451,-1178 16451,-1178 16259.8,-1178 16259.8,-1178"/>
<polygon fill="black" stroke="black" points="16259.8,-1174.5 16249.8,-1178 16259.8,-1181.5 16259.8,-1174.5"/>
</g>
<!-- concat_group_4_0 -->
<g id="node375" class="node">
<title>concat_group_4_0</title>
<polygon fill="#ffd700" stroke="black" points="15107,-1043 14979,-990 15107,-937 15235,-990 15107,-1043"/>
<text text-anchor="middle" x="15107" y="-1001.3" font-family="Times,serif" font-size="14.00">Concat Group 0</text>
<text text-anchor="middle" x="15107" y="-986.3" font-family="Times,serif" font-size="14.00">[B×L×d×h_g]</text>
<text text-anchor="middle" x="15107" y="-971.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;3</text>
</g>
<!-- attention_4_0_0&#45;&gt;concat_group_4_0 -->
<g id="edge359" class="edge">
<title>attention_4_0_0&#45;&gt;concat_group_4_0</title>
<path fill="none" stroke="black" d="M16163,-1143.95C16163,-1089.78 16163,-990 16163,-990 16163,-990 15245.17,-990 15245.17,-990"/>
<polygon fill="black" stroke="black" points="15245.17,-986.5 15235.17,-990 15245.17,-993.5 15245.17,-986.5"/>
</g>
<!-- k_proj_4_0_0 -->
<g id="node373" class="node">
<title>k_proj_4_0_0</title>
<polygon fill="#ff9999" stroke="black" points="16326,-1367 16192,-1367 16192,-1299 16326,-1299 16326,-1367"/>
<text text-anchor="middle" x="16259" y="-1351.8" font-family="Times,serif" font-size="14.00">K Projection 0_0</text>
<text text-anchor="middle" x="16259" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="16259" y="-1321.8" font-family="Times,serif" font-size="14.00">W_K^{0,0}</text>
<text text-anchor="middle" x="16259" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- k_proj_4_0_0&#45;&gt;attention_4_0_0 -->
<g id="edge357" class="edge">
<title>k_proj_4_0_0&#45;&gt;attention_4_0_0</title>
<path fill="none" stroke="black" d="M16220.75,-1298.98C16220.75,-1298.98 16220.75,-1222.2 16220.75,-1222.2"/>
<polygon fill="black" stroke="black" points="16224.25,-1222.2 16220.75,-1212.2 16217.25,-1222.2 16224.25,-1222.2"/>
</g>
<!-- v_proj_4_0_0 -->
<g id="node374" class="node">
<title>v_proj_4_0_0</title>
<polygon fill="#ff9999" stroke="black" points="16133.5,-1367 16000.5,-1367 16000.5,-1299 16133.5,-1299 16133.5,-1367"/>
<text text-anchor="middle" x="16067" y="-1351.8" font-family="Times,serif" font-size="14.00">V Projection 0_0</text>
<text text-anchor="middle" x="16067" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="16067" y="-1321.8" font-family="Times,serif" font-size="14.00">W_V^{0,0}</text>
<text text-anchor="middle" x="16067" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- v_proj_4_0_0&#45;&gt;attention_4_0_0 -->
<g id="edge358" class="edge">
<title>v_proj_4_0_0&#45;&gt;attention_4_0_0</title>
<path fill="none" stroke="black" d="M16105,-1298.98C16105,-1298.98 16105,-1222.2 16105,-1222.2"/>
<polygon fill="black" stroke="black" points="16108.5,-1222.2 16105,-1212.2 16101.5,-1222.2 16108.5,-1222.2"/>
</g>
<!-- final_concat_4 -->
<g id="node439" class="node">
<title>final_concat_4</title>
<polygon fill="#ffa500" stroke="black" points="11938,-850 11773,-797 11938,-744 12103,-797 11938,-850"/>
<text text-anchor="middle" x="11938" y="-808.3" font-family="Times,serif" font-size="14.00">Final Concat Layer 4</text>
<text text-anchor="middle" x="11938" y="-793.3" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="11938" y="-778.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;15</text>
</g>
<!-- concat_group_4_0&#45;&gt;final_concat_4 -->
<g id="edge432" class="edge">
<title>concat_group_4_0&#45;&gt;final_concat_4</title>
<path fill="none" stroke="black" d="M15107,-936.75C15107,-879.62 15107,-797 15107,-797 15107,-797 12113.09,-797 12113.09,-797"/>
<polygon fill="black" stroke="black" points="12113.09,-793.5 12103.09,-797 12113.09,-800.5 12113.09,-793.5"/>
</g>
<!-- q_proj_4_0_1 -->
<g id="node376" class="node">
<title>q_proj_4_0_1</title>
<polygon fill="#ffcc99" stroke="black" points="15942,-1367 15808,-1367 15808,-1299 15942,-1299 15942,-1367"/>
<text text-anchor="middle" x="15875" y="-1351.8" font-family="Times,serif" font-size="14.00">Q Projection 0_1</text>
<text text-anchor="middle" x="15875" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="15875" y="-1321.8" font-family="Times,serif" font-size="14.00">W_Q^{0,1}</text>
<text text-anchor="middle" x="15875" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- attention_4_0_1 -->
<g id="node377" class="node">
<title>attention_4_0_1</title>
<polygon fill="#ffcc99" stroke="black" points="15673.5,-1212 15500.5,-1212 15500.5,-1144 15673.5,-1144 15673.5,-1212"/>
<text text-anchor="middle" x="15587" y="-1196.8" font-family="Times,serif" font-size="14.00">Attention 0_1</text>
<text text-anchor="middle" x="15587" y="-1181.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="15587" y="-1166.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="15587" y="-1151.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- q_proj_4_0_1&#45;&gt;attention_4_0_1 -->
<g id="edge360" class="edge">
<title>q_proj_4_0_1&#45;&gt;attention_4_0_1</title>
<path fill="none" stroke="black" d="M15875,-1298.98C15875,-1253.36 15875,-1178 15875,-1178 15875,-1178 15683.8,-1178 15683.8,-1178"/>
<polygon fill="black" stroke="black" points="15683.8,-1174.5 15673.8,-1178 15683.8,-1181.5 15683.8,-1174.5"/>
</g>
<!-- attention_4_0_1&#45;&gt;concat_group_4_0 -->
<g id="edge363" class="edge">
<title>attention_4_0_1&#45;&gt;concat_group_4_0</title>
<path fill="none" stroke="black" d="M15500.14,-1189C15387.79,-1189 15206.33,-1189 15206.33,-1189 15206.33,-1189 15206.33,-1012.15 15206.33,-1012.15"/>
<polygon fill="black" stroke="black" points="15209.83,-1012.15 15206.33,-1002.15 15202.83,-1012.15 15209.83,-1012.15"/>
</g>
<!-- attention_4_0_1&#45;&gt;concat_group_4_0 -->
<g id="edge364" class="edge">
<title>attention_4_0_1&#45;&gt;concat_group_4_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M15500.29,-1166C15391.55,-1166 15219.17,-1166 15219.17,-1166 15219.17,-1166 15219.17,-1006.68 15219.17,-1006.68"/>
<polygon fill="red" stroke="red" points="15222.67,-1006.68 15219.17,-996.68 15215.67,-1006.68 15222.67,-1006.68"/>
<text text-anchor="middle" x="15605" y="-1089.8" font-family="Times,serif" font-size="14.00">AllGather GPU0→GPU1</text>
</g>
<!-- k_proj_4_0_1 -->
<g id="node378" class="node">
<title>k_proj_4_0_1</title>
<polygon fill="#ffcc99" stroke="black" points="15750,-1367 15616,-1367 15616,-1299 15750,-1299 15750,-1367"/>
<text text-anchor="middle" x="15683" y="-1351.8" font-family="Times,serif" font-size="14.00">K Projection 0_1</text>
<text text-anchor="middle" x="15683" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="15683" y="-1321.8" font-family="Times,serif" font-size="14.00">W_K^{0,1}</text>
<text text-anchor="middle" x="15683" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- k_proj_4_0_1&#45;&gt;attention_4_0_1 -->
<g id="edge361" class="edge">
<title>k_proj_4_0_1&#45;&gt;attention_4_0_1</title>
<path fill="none" stroke="black" d="M15644.75,-1298.98C15644.75,-1298.98 15644.75,-1222.2 15644.75,-1222.2"/>
<polygon fill="black" stroke="black" points="15648.25,-1222.2 15644.75,-1212.2 15641.25,-1222.2 15648.25,-1222.2"/>
</g>
<!-- v_proj_4_0_1 -->
<g id="node379" class="node">
<title>v_proj_4_0_1</title>
<polygon fill="#ffcc99" stroke="black" points="15557.5,-1367 15424.5,-1367 15424.5,-1299 15557.5,-1299 15557.5,-1367"/>
<text text-anchor="middle" x="15491" y="-1351.8" font-family="Times,serif" font-size="14.00">V Projection 0_1</text>
<text text-anchor="middle" x="15491" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="15491" y="-1321.8" font-family="Times,serif" font-size="14.00">W_V^{0,1}</text>
<text text-anchor="middle" x="15491" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- v_proj_4_0_1&#45;&gt;attention_4_0_1 -->
<g id="edge362" class="edge">
<title>v_proj_4_0_1&#45;&gt;attention_4_0_1</title>
<path fill="none" stroke="black" d="M15529,-1298.98C15529,-1298.98 15529,-1222.2 15529,-1222.2"/>
<polygon fill="black" stroke="black" points="15532.5,-1222.2 15529,-1212.2 15525.5,-1222.2 15532.5,-1222.2"/>
</g>
<!-- q_proj_4_0_2 -->
<g id="node380" class="node">
<title>q_proj_4_0_2</title>
<polygon fill="#ffff99" stroke="black" points="15366,-1367 15232,-1367 15232,-1299 15366,-1299 15366,-1367"/>
<text text-anchor="middle" x="15299" y="-1351.8" font-family="Times,serif" font-size="14.00">Q Projection 0_2</text>
<text text-anchor="middle" x="15299" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="15299" y="-1321.8" font-family="Times,serif" font-size="14.00">W_Q^{0,2}</text>
<text text-anchor="middle" x="15299" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- attention_4_0_2 -->
<g id="node381" class="node">
<title>attention_4_0_2</title>
<polygon fill="#ffff99" stroke="black" points="15193.5,-1212 15020.5,-1212 15020.5,-1144 15193.5,-1144 15193.5,-1212"/>
<text text-anchor="middle" x="15107" y="-1196.8" font-family="Times,serif" font-size="14.00">Attention 0_2</text>
<text text-anchor="middle" x="15107" y="-1181.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="15107" y="-1166.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="15107" y="-1151.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- q_proj_4_0_2&#45;&gt;attention_4_0_2 -->
<g id="edge365" class="edge">
<title>q_proj_4_0_2&#45;&gt;attention_4_0_2</title>
<path fill="none" stroke="black" d="M15231.96,-1333C15206.6,-1333 15183.75,-1333 15183.75,-1333 15183.75,-1333 15183.75,-1222.02 15183.75,-1222.02"/>
<polygon fill="black" stroke="black" points="15187.25,-1222.02 15183.75,-1212.02 15180.25,-1222.02 15187.25,-1222.02"/>
</g>
<!-- attention_4_0_2&#45;&gt;concat_group_4_0 -->
<g id="edge368" class="edge">
<title>attention_4_0_2&#45;&gt;concat_group_4_0</title>
<path fill="none" stroke="black" d="M15078.17,-1143.95C15078.17,-1143.95 15078.17,-1041.34 15078.17,-1041.34"/>
<polygon fill="black" stroke="black" points="15081.67,-1041.34 15078.17,-1031.34 15074.67,-1041.34 15081.67,-1041.34"/>
</g>
<!-- attention_4_0_2&#45;&gt;concat_group_4_0 -->
<g id="edge369" class="edge">
<title>attention_4_0_2&#45;&gt;concat_group_4_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M15135.83,-1143.95C15135.83,-1143.95 15135.83,-1041.34 15135.83,-1041.34"/>
<polygon fill="red" stroke="red" points="15139.33,-1041.34 15135.83,-1031.34 15132.33,-1041.34 15139.33,-1041.34"/>
<text text-anchor="middle" x="15319" y="-1089.8" font-family="Times,serif" font-size="14.00">AllGather GPU1→GPU2</text>
</g>
<!-- k_proj_4_0_2 -->
<g id="node382" class="node">
<title>k_proj_4_0_2</title>
<polygon fill="#ffff99" stroke="black" points="15174,-1367 15040,-1367 15040,-1299 15174,-1299 15174,-1367"/>
<text text-anchor="middle" x="15107" y="-1351.8" font-family="Times,serif" font-size="14.00">K Projection 0_2</text>
<text text-anchor="middle" x="15107" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="15107" y="-1321.8" font-family="Times,serif" font-size="14.00">W_K^{0,2}</text>
<text text-anchor="middle" x="15107" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- k_proj_4_0_2&#45;&gt;attention_4_0_2 -->
<g id="edge366" class="edge">
<title>k_proj_4_0_2&#45;&gt;attention_4_0_2</title>
<path fill="none" stroke="black" d="M15107,-1298.98C15107,-1298.98 15107,-1222.2 15107,-1222.2"/>
<polygon fill="black" stroke="black" points="15110.5,-1222.2 15107,-1212.2 15103.5,-1222.2 15110.5,-1222.2"/>
</g>
<!-- v_proj_4_0_2 -->
<g id="node383" class="node">
<title>v_proj_4_0_2</title>
<polygon fill="#ffff99" stroke="black" points="14981.5,-1367 14848.5,-1367 14848.5,-1299 14981.5,-1299 14981.5,-1367"/>
<text text-anchor="middle" x="14915" y="-1351.8" font-family="Times,serif" font-size="14.00">V Projection 0_2</text>
<text text-anchor="middle" x="14915" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="14915" y="-1321.8" font-family="Times,serif" font-size="14.00">W_V^{0,2}</text>
<text text-anchor="middle" x="14915" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- v_proj_4_0_2&#45;&gt;attention_4_0_2 -->
<g id="edge367" class="edge">
<title>v_proj_4_0_2&#45;&gt;attention_4_0_2</title>
<path fill="none" stroke="black" d="M14981.71,-1333C15007.19,-1333 15030.25,-1333 15030.25,-1333 15030.25,-1333 15030.25,-1222.02 15030.25,-1222.02"/>
<polygon fill="black" stroke="black" points="15033.75,-1222.02 15030.25,-1212.02 15026.75,-1222.02 15033.75,-1222.02"/>
</g>
<!-- q_proj_4_0_3 -->
<g id="node384" class="node">
<title>q_proj_4_0_3</title>
<polygon fill="#ccff99" stroke="black" points="14790,-1367 14656,-1367 14656,-1299 14790,-1299 14790,-1367"/>
<text text-anchor="middle" x="14723" y="-1351.8" font-family="Times,serif" font-size="14.00">Q Projection 0_3</text>
<text text-anchor="middle" x="14723" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="14723" y="-1321.8" font-family="Times,serif" font-size="14.00">W_Q^{0,3}</text>
<text text-anchor="middle" x="14723" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- attention_4_0_3 -->
<g id="node385" class="node">
<title>attention_4_0_3</title>
<polygon fill="#ccff99" stroke="black" points="14714.5,-1212 14541.5,-1212 14541.5,-1144 14714.5,-1144 14714.5,-1212"/>
<text text-anchor="middle" x="14628" y="-1196.8" font-family="Times,serif" font-size="14.00">Attention 0_3</text>
<text text-anchor="middle" x="14628" y="-1181.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="14628" y="-1166.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="14628" y="-1151.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- q_proj_4_0_3&#45;&gt;attention_4_0_3 -->
<g id="edge370" class="edge">
<title>q_proj_4_0_3&#45;&gt;attention_4_0_3</title>
<path fill="none" stroke="black" d="M14685.25,-1298.98C14685.25,-1298.98 14685.25,-1222.2 14685.25,-1222.2"/>
<polygon fill="black" stroke="black" points="14688.75,-1222.2 14685.25,-1212.2 14681.75,-1222.2 14688.75,-1222.2"/>
</g>
<!-- attention_4_0_3&#45;&gt;concat_group_4_0 -->
<g id="edge373" class="edge">
<title>attention_4_0_3&#45;&gt;concat_group_4_0</title>
<path fill="none" stroke="black" d="M14714.59,-1189C14826.59,-1189 15007.5,-1189 15007.5,-1189 15007.5,-1189 15007.5,-1011.85 15007.5,-1011.85"/>
<polygon fill="black" stroke="black" points="15011,-1011.85 15007.5,-1001.85 15004,-1011.85 15011,-1011.85"/>
</g>
<!-- attention_4_0_3&#45;&gt;concat_group_4_0 -->
<g id="edge374" class="edge">
<title>attention_4_0_3&#45;&gt;concat_group_4_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14714.86,-1166C14823.23,-1166 14994.5,-1166 14994.5,-1166 14994.5,-1166 14994.5,-1006.68 14994.5,-1006.68"/>
<polygon fill="red" stroke="red" points="14998,-1006.68 14994.5,-996.68 14991,-1006.68 14998,-1006.68"/>
<text text-anchor="middle" x="14981" y="-1089.8" font-family="Times,serif" font-size="14.00">AllGather GPU2→GPU3</text>
</g>
<!-- k_proj_4_0_3 -->
<g id="node386" class="node">
<title>k_proj_4_0_3</title>
<polygon fill="#ccff99" stroke="black" points="14598,-1367 14464,-1367 14464,-1299 14598,-1299 14598,-1367"/>
<text text-anchor="middle" x="14531" y="-1351.8" font-family="Times,serif" font-size="14.00">K Projection 0_3</text>
<text text-anchor="middle" x="14531" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="14531" y="-1321.8" font-family="Times,serif" font-size="14.00">W_K^{0,3}</text>
<text text-anchor="middle" x="14531" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- k_proj_4_0_3&#45;&gt;attention_4_0_3 -->
<g id="edge371" class="edge">
<title>k_proj_4_0_3&#45;&gt;attention_4_0_3</title>
<path fill="none" stroke="black" d="M14569.75,-1298.98C14569.75,-1298.98 14569.75,-1222.2 14569.75,-1222.2"/>
<polygon fill="black" stroke="black" points="14573.25,-1222.2 14569.75,-1212.2 14566.25,-1222.2 14573.25,-1222.2"/>
</g>
<!-- v_proj_4_0_3 -->
<g id="node387" class="node">
<title>v_proj_4_0_3</title>
<polygon fill="#ccff99" stroke="black" points="14405.5,-1367 14272.5,-1367 14272.5,-1299 14405.5,-1299 14405.5,-1367"/>
<text text-anchor="middle" x="14339" y="-1351.8" font-family="Times,serif" font-size="14.00">V Projection 0_3</text>
<text text-anchor="middle" x="14339" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="14339" y="-1321.8" font-family="Times,serif" font-size="14.00">W_V^{0,3}</text>
<text text-anchor="middle" x="14339" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- v_proj_4_0_3&#45;&gt;attention_4_0_3 -->
<g id="edge372" class="edge">
<title>v_proj_4_0_3&#45;&gt;attention_4_0_3</title>
<path fill="none" stroke="black" d="M14339,-1298.8C14339,-1249.94 14339,-1166 14339,-1166 14339,-1166 14531.29,-1166 14531.29,-1166"/>
<polygon fill="black" stroke="black" points="14531.29,-1169.5 14541.29,-1166 14531.29,-1162.5 14531.29,-1169.5"/>
</g>
<!-- q_proj_4_1_0 -->
<g id="node388" class="node">
<title>q_proj_4_1_0</title>
<polygon fill="#99ff99" stroke="black" points="14214,-1367 14080,-1367 14080,-1299 14214,-1299 14214,-1367"/>
<text text-anchor="middle" x="14147" y="-1351.8" font-family="Times,serif" font-size="14.00">Q Projection 1_0</text>
<text text-anchor="middle" x="14147" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="14147" y="-1321.8" font-family="Times,serif" font-size="14.00">W_Q^{1,0}</text>
<text text-anchor="middle" x="14147" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- attention_4_1_0 -->
<g id="node389" class="node">
<title>attention_4_1_0</title>
<polygon fill="#99ff99" stroke="black" points="13899.5,-1212 13726.5,-1212 13726.5,-1144 13899.5,-1144 13899.5,-1212"/>
<text text-anchor="middle" x="13813" y="-1196.8" font-family="Times,serif" font-size="14.00">Attention 1_0</text>
<text text-anchor="middle" x="13813" y="-1181.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="13813" y="-1166.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="13813" y="-1151.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- q_proj_4_1_0&#45;&gt;attention_4_1_0 -->
<g id="edge375" class="edge">
<title>q_proj_4_1_0&#45;&gt;attention_4_1_0</title>
<path fill="none" stroke="black" d="M14147,-1298.87C14147,-1256.29 14147,-1189 14147,-1189 14147,-1189 13909.88,-1189 13909.88,-1189"/>
<polygon fill="black" stroke="black" points="13909.88,-1185.5 13899.88,-1189 13909.88,-1192.5 13909.88,-1185.5"/>
</g>
<!-- concat_group_4_1 -->
<g id="node392" class="node">
<title>concat_group_4_1</title>
<polygon fill="#ffd700" stroke="black" points="12803,-1043 12675,-990 12803,-937 12931,-990 12803,-1043"/>
<text text-anchor="middle" x="12803" y="-1001.3" font-family="Times,serif" font-size="14.00">Concat Group 1</text>
<text text-anchor="middle" x="12803" y="-986.3" font-family="Times,serif" font-size="14.00">[B×L×d×h_g]</text>
<text text-anchor="middle" x="12803" y="-971.3" font-family="Times,serif" font-size="14.00">GPU: 4&#45;7</text>
</g>
<!-- attention_4_1_0&#45;&gt;concat_group_4_1 -->
<g id="edge378" class="edge">
<title>attention_4_1_0&#45;&gt;concat_group_4_1</title>
<path fill="none" stroke="black" d="M13813,-1143.95C13813,-1089.78 13813,-990 13813,-990 13813,-990 12941.17,-990 12941.17,-990"/>
<polygon fill="black" stroke="black" points="12941.17,-986.5 12931.17,-990 12941.17,-993.5 12941.17,-986.5"/>
</g>
<!-- k_proj_4_1_0 -->
<g id="node390" class="node">
<title>k_proj_4_1_0</title>
<polygon fill="#99ff99" stroke="black" points="14022,-1367 13888,-1367 13888,-1299 14022,-1299 14022,-1367"/>
<text text-anchor="middle" x="13955" y="-1351.8" font-family="Times,serif" font-size="14.00">K Projection 1_0</text>
<text text-anchor="middle" x="13955" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="13955" y="-1321.8" font-family="Times,serif" font-size="14.00">W_K^{1,0}</text>
<text text-anchor="middle" x="13955" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- k_proj_4_1_0&#45;&gt;attention_4_1_0 -->
<g id="edge376" class="edge">
<title>k_proj_4_1_0&#45;&gt;attention_4_1_0</title>
<path fill="none" stroke="black" d="M13893.75,-1298.98C13893.75,-1298.98 13893.75,-1222.2 13893.75,-1222.2"/>
<polygon fill="black" stroke="black" points="13897.25,-1222.2 13893.75,-1212.2 13890.25,-1222.2 13897.25,-1222.2"/>
</g>
<!-- v_proj_4_1_0 -->
<g id="node391" class="node">
<title>v_proj_4_1_0</title>
<polygon fill="#99ff99" stroke="black" points="13829.5,-1367 13696.5,-1367 13696.5,-1299 13829.5,-1299 13829.5,-1367"/>
<text text-anchor="middle" x="13763" y="-1351.8" font-family="Times,serif" font-size="14.00">V Projection 1_0</text>
<text text-anchor="middle" x="13763" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="13763" y="-1321.8" font-family="Times,serif" font-size="14.00">W_V^{1,0}</text>
<text text-anchor="middle" x="13763" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- v_proj_4_1_0&#45;&gt;attention_4_1_0 -->
<g id="edge377" class="edge">
<title>v_proj_4_1_0&#45;&gt;attention_4_1_0</title>
<path fill="none" stroke="black" d="M13778,-1298.98C13778,-1298.98 13778,-1222.2 13778,-1222.2"/>
<polygon fill="black" stroke="black" points="13781.5,-1222.2 13778,-1212.2 13774.5,-1222.2 13781.5,-1222.2"/>
</g>
<!-- concat_group_4_1&#45;&gt;final_concat_4 -->
<g id="edge434" class="edge">
<title>concat_group_4_1&#45;&gt;final_concat_4</title>
<path fill="none" stroke="black" d="M12674.73,-990C12450.96,-990 12012.83,-990 12012.83,-990 12012.83,-990 12012.83,-836.31 12012.83,-836.31"/>
<polygon fill="black" stroke="black" points="12016.33,-836.31 12012.83,-826.31 12009.33,-836.31 12016.33,-836.31"/>
</g>
<!-- q_proj_4_1_1 -->
<g id="node393" class="node">
<title>q_proj_4_1_1</title>
<polygon fill="#99ffcc" stroke="black" points="13638,-1367 13504,-1367 13504,-1299 13638,-1299 13638,-1367"/>
<text text-anchor="middle" x="13571" y="-1351.8" font-family="Times,serif" font-size="14.00">Q Projection 1_1</text>
<text text-anchor="middle" x="13571" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="13571" y="-1321.8" font-family="Times,serif" font-size="14.00">W_Q^{1,1}</text>
<text text-anchor="middle" x="13571" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- attention_4_1_1 -->
<g id="node394" class="node">
<title>attention_4_1_1</title>
<polygon fill="#99ffcc" stroke="black" points="13387.5,-1212 13214.5,-1212 13214.5,-1144 13387.5,-1144 13387.5,-1212"/>
<text text-anchor="middle" x="13301" y="-1196.8" font-family="Times,serif" font-size="14.00">Attention 1_1</text>
<text text-anchor="middle" x="13301" y="-1181.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="13301" y="-1166.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="13301" y="-1151.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- q_proj_4_1_1&#45;&gt;attention_4_1_1 -->
<g id="edge379" class="edge">
<title>q_proj_4_1_1&#45;&gt;attention_4_1_1</title>
<path fill="none" stroke="black" d="M13571,-1298.98C13571,-1253.36 13571,-1178 13571,-1178 13571,-1178 13397.54,-1178 13397.54,-1178"/>
<polygon fill="black" stroke="black" points="13397.54,-1174.5 13387.54,-1178 13397.54,-1181.5 13397.54,-1174.5"/>
</g>
<!-- attention_4_1_1&#45;&gt;concat_group_4_1 -->
<g id="edge382" class="edge">
<title>attention_4_1_1&#45;&gt;concat_group_4_1</title>
<path fill="none" stroke="black" d="M13214.5,-1189C13097.24,-1189 12902.33,-1189 12902.33,-1189 12902.33,-1189 12902.33,-1012.15 12902.33,-1012.15"/>
<polygon fill="black" stroke="black" points="12905.83,-1012.15 12902.33,-1002.15 12898.83,-1012.15 12905.83,-1012.15"/>
</g>
<!-- attention_4_1_1&#45;&gt;concat_group_4_1 -->
<g id="edge383" class="edge">
<title>attention_4_1_1&#45;&gt;concat_group_4_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13214.41,-1166C13100.65,-1166 12915.17,-1166 12915.17,-1166 12915.17,-1166 12915.17,-1006.68 12915.17,-1006.68"/>
<polygon fill="red" stroke="red" points="12918.67,-1006.68 12915.17,-996.68 12911.67,-1006.68 12918.67,-1006.68"/>
<text text-anchor="middle" x="13469" y="-1089.8" font-family="Times,serif" font-size="14.00">AllGather GPU4→GPU5</text>
</g>
<!-- k_proj_4_1_1 -->
<g id="node395" class="node">
<title>k_proj_4_1_1</title>
<polygon fill="#99ffcc" stroke="black" points="13446,-1367 13312,-1367 13312,-1299 13446,-1299 13446,-1367"/>
<text text-anchor="middle" x="13379" y="-1351.8" font-family="Times,serif" font-size="14.00">K Projection 1_1</text>
<text text-anchor="middle" x="13379" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="13379" y="-1321.8" font-family="Times,serif" font-size="14.00">W_K^{1,1}</text>
<text text-anchor="middle" x="13379" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- k_proj_4_1_1&#45;&gt;attention_4_1_1 -->
<g id="edge380" class="edge">
<title>k_proj_4_1_1&#45;&gt;attention_4_1_1</title>
<path fill="none" stroke="black" d="M13349.75,-1298.98C13349.75,-1298.98 13349.75,-1222.2 13349.75,-1222.2"/>
<polygon fill="black" stroke="black" points="13353.25,-1222.2 13349.75,-1212.2 13346.25,-1222.2 13353.25,-1222.2"/>
</g>
<!-- v_proj_4_1_1 -->
<g id="node396" class="node">
<title>v_proj_4_1_1</title>
<polygon fill="#99ffcc" stroke="black" points="13253.5,-1367 13120.5,-1367 13120.5,-1299 13253.5,-1299 13253.5,-1367"/>
<text text-anchor="middle" x="13187" y="-1351.8" font-family="Times,serif" font-size="14.00">V Projection 1_1</text>
<text text-anchor="middle" x="13187" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="13187" y="-1321.8" font-family="Times,serif" font-size="14.00">W_V^{1,1}</text>
<text text-anchor="middle" x="13187" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- v_proj_4_1_1&#45;&gt;attention_4_1_1 -->
<g id="edge381" class="edge">
<title>v_proj_4_1_1&#45;&gt;attention_4_1_1</title>
<path fill="none" stroke="black" d="M13234,-1298.98C13234,-1298.98 13234,-1222.2 13234,-1222.2"/>
<polygon fill="black" stroke="black" points="13237.5,-1222.2 13234,-1212.2 13230.5,-1222.2 13237.5,-1222.2"/>
</g>
<!-- q_proj_4_1_2 -->
<g id="node397" class="node">
<title>q_proj_4_1_2</title>
<polygon fill="#99ffff" stroke="black" points="13062,-1367 12928,-1367 12928,-1299 13062,-1299 13062,-1367"/>
<text text-anchor="middle" x="12995" y="-1351.8" font-family="Times,serif" font-size="14.00">Q Projection 1_2</text>
<text text-anchor="middle" x="12995" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="12995" y="-1321.8" font-family="Times,serif" font-size="14.00">W_Q^{1,2}</text>
<text text-anchor="middle" x="12995" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- attention_4_1_2 -->
<g id="node398" class="node">
<title>attention_4_1_2</title>
<polygon fill="#99ffff" stroke="black" points="12889.5,-1212 12716.5,-1212 12716.5,-1144 12889.5,-1144 12889.5,-1212"/>
<text text-anchor="middle" x="12803" y="-1196.8" font-family="Times,serif" font-size="14.00">Attention 1_2</text>
<text text-anchor="middle" x="12803" y="-1181.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="12803" y="-1166.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="12803" y="-1151.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- q_proj_4_1_2&#45;&gt;attention_4_1_2 -->
<g id="edge384" class="edge">
<title>q_proj_4_1_2&#45;&gt;attention_4_1_2</title>
<path fill="none" stroke="black" d="M12927.96,-1333C12902.6,-1333 12879.75,-1333 12879.75,-1333 12879.75,-1333 12879.75,-1222.02 12879.75,-1222.02"/>
<polygon fill="black" stroke="black" points="12883.25,-1222.02 12879.75,-1212.02 12876.25,-1222.02 12883.25,-1222.02"/>
</g>
<!-- attention_4_1_2&#45;&gt;concat_group_4_1 -->
<g id="edge387" class="edge">
<title>attention_4_1_2&#45;&gt;concat_group_4_1</title>
<path fill="none" stroke="black" d="M12774.17,-1143.95C12774.17,-1143.95 12774.17,-1041.34 12774.17,-1041.34"/>
<polygon fill="black" stroke="black" points="12777.67,-1041.34 12774.17,-1031.34 12770.67,-1041.34 12777.67,-1041.34"/>
</g>
<!-- attention_4_1_2&#45;&gt;concat_group_4_1 -->
<g id="edge388" class="edge">
<title>attention_4_1_2&#45;&gt;concat_group_4_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12831.83,-1143.95C12831.83,-1143.95 12831.83,-1041.34 12831.83,-1041.34"/>
<polygon fill="red" stroke="red" points="12835.33,-1041.34 12831.83,-1031.34 12828.33,-1041.34 12835.33,-1041.34"/>
<text text-anchor="middle" x="13028" y="-1089.8" font-family="Times,serif" font-size="14.00">AllGather GPU5→GPU6</text>
</g>
<!-- k_proj_4_1_2 -->
<g id="node399" class="node">
<title>k_proj_4_1_2</title>
<polygon fill="#99ffff" stroke="black" points="12870,-1367 12736,-1367 12736,-1299 12870,-1299 12870,-1367"/>
<text text-anchor="middle" x="12803" y="-1351.8" font-family="Times,serif" font-size="14.00">K Projection 1_2</text>
<text text-anchor="middle" x="12803" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="12803" y="-1321.8" font-family="Times,serif" font-size="14.00">W_K^{1,2}</text>
<text text-anchor="middle" x="12803" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- k_proj_4_1_2&#45;&gt;attention_4_1_2 -->
<g id="edge385" class="edge">
<title>k_proj_4_1_2&#45;&gt;attention_4_1_2</title>
<path fill="none" stroke="black" d="M12803,-1298.98C12803,-1298.98 12803,-1222.2 12803,-1222.2"/>
<polygon fill="black" stroke="black" points="12806.5,-1222.2 12803,-1212.2 12799.5,-1222.2 12806.5,-1222.2"/>
</g>
<!-- v_proj_4_1_2 -->
<g id="node400" class="node">
<title>v_proj_4_1_2</title>
<polygon fill="#99ffff" stroke="black" points="12677.5,-1367 12544.5,-1367 12544.5,-1299 12677.5,-1299 12677.5,-1367"/>
<text text-anchor="middle" x="12611" y="-1351.8" font-family="Times,serif" font-size="14.00">V Projection 1_2</text>
<text text-anchor="middle" x="12611" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="12611" y="-1321.8" font-family="Times,serif" font-size="14.00">W_V^{1,2}</text>
<text text-anchor="middle" x="12611" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- v_proj_4_1_2&#45;&gt;attention_4_1_2 -->
<g id="edge386" class="edge">
<title>v_proj_4_1_2&#45;&gt;attention_4_1_2</title>
<path fill="none" stroke="black" d="M12677.71,-1333C12703.19,-1333 12726.25,-1333 12726.25,-1333 12726.25,-1333 12726.25,-1222.02 12726.25,-1222.02"/>
<polygon fill="black" stroke="black" points="12729.75,-1222.02 12726.25,-1212.02 12722.75,-1222.02 12729.75,-1222.02"/>
</g>
<!-- q_proj_4_1_3 -->
<g id="node401" class="node">
<title>q_proj_4_1_3</title>
<polygon fill="#99ccff" stroke="black" points="12486,-1367 12352,-1367 12352,-1299 12486,-1299 12486,-1367"/>
<text text-anchor="middle" x="12419" y="-1351.8" font-family="Times,serif" font-size="14.00">Q Projection 1_3</text>
<text text-anchor="middle" x="12419" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="12419" y="-1321.8" font-family="Times,serif" font-size="14.00">W_Q^{1,3}</text>
<text text-anchor="middle" x="12419" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- attention_4_1_3 -->
<g id="node402" class="node">
<title>attention_4_1_3</title>
<polygon fill="#99ccff" stroke="black" points="12361.5,-1212 12188.5,-1212 12188.5,-1144 12361.5,-1144 12361.5,-1212"/>
<text text-anchor="middle" x="12275" y="-1196.8" font-family="Times,serif" font-size="14.00">Attention 1_3</text>
<text text-anchor="middle" x="12275" y="-1181.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="12275" y="-1166.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="12275" y="-1151.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- q_proj_4_1_3&#45;&gt;attention_4_1_3 -->
<g id="edge389" class="edge">
<title>q_proj_4_1_3&#45;&gt;attention_4_1_3</title>
<path fill="none" stroke="black" d="M12356.75,-1298.98C12356.75,-1298.98 12356.75,-1222.2 12356.75,-1222.2"/>
<polygon fill="black" stroke="black" points="12360.25,-1222.2 12356.75,-1212.2 12353.25,-1222.2 12360.25,-1222.2"/>
</g>
<!-- attention_4_1_3&#45;&gt;concat_group_4_1 -->
<g id="edge392" class="edge">
<title>attention_4_1_3&#45;&gt;concat_group_4_1</title>
<path fill="none" stroke="black" d="M12361.55,-1189C12483.58,-1189 12691.5,-1189 12691.5,-1189 12691.5,-1189 12691.5,-1007.08 12691.5,-1007.08"/>
<polygon fill="black" stroke="black" points="12695,-1007.08 12691.5,-997.08 12688,-1007.08 12695,-1007.08"/>
</g>
<!-- attention_4_1_3&#45;&gt;concat_group_4_1 -->
<g id="edge393" class="edge">
<title>attention_4_1_3&#45;&gt;concat_group_4_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12361.84,-1166C12482.05,-1166 12684.5,-1166 12684.5,-1166 12684.5,-1166 12684.5,-1004.01 12684.5,-1004.01"/>
<polygon fill="red" stroke="red" points="12688,-1004.01 12684.5,-994.01 12681,-1004.01 12688,-1004.01"/>
<text text-anchor="middle" x="12677" y="-1089.8" font-family="Times,serif" font-size="14.00">AllGather GPU6→GPU7</text>
</g>
<!-- k_proj_4_1_3 -->
<g id="node403" class="node">
<title>k_proj_4_1_3</title>
<polygon fill="#99ccff" stroke="black" points="12294,-1367 12160,-1367 12160,-1299 12294,-1299 12294,-1367"/>
<text text-anchor="middle" x="12227" y="-1351.8" font-family="Times,serif" font-size="14.00">K Projection 1_3</text>
<text text-anchor="middle" x="12227" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="12227" y="-1321.8" font-family="Times,serif" font-size="14.00">W_K^{1,3}</text>
<text text-anchor="middle" x="12227" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- k_proj_4_1_3&#45;&gt;attention_4_1_3 -->
<g id="edge390" class="edge">
<title>k_proj_4_1_3&#45;&gt;attention_4_1_3</title>
<path fill="none" stroke="black" d="M12241.25,-1298.98C12241.25,-1298.98 12241.25,-1222.2 12241.25,-1222.2"/>
<polygon fill="black" stroke="black" points="12244.75,-1222.2 12241.25,-1212.2 12237.75,-1222.2 12244.75,-1222.2"/>
</g>
<!-- v_proj_4_1_3 -->
<g id="node404" class="node">
<title>v_proj_4_1_3</title>
<polygon fill="#99ccff" stroke="black" points="12101.5,-1367 11968.5,-1367 11968.5,-1299 12101.5,-1299 12101.5,-1367"/>
<text text-anchor="middle" x="12035" y="-1351.8" font-family="Times,serif" font-size="14.00">V Projection 1_3</text>
<text text-anchor="middle" x="12035" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="12035" y="-1321.8" font-family="Times,serif" font-size="14.00">W_V^{1,3}</text>
<text text-anchor="middle" x="12035" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- v_proj_4_1_3&#45;&gt;attention_4_1_3 -->
<g id="edge391" class="edge">
<title>v_proj_4_1_3&#45;&gt;attention_4_1_3</title>
<path fill="none" stroke="black" d="M12057.17,-1298.8C12057.17,-1249.94 12057.17,-1166 12057.17,-1166 12057.17,-1166 12178.28,-1166 12178.28,-1166"/>
<polygon fill="black" stroke="black" points="12178.28,-1169.5 12188.28,-1166 12178.28,-1162.5 12178.28,-1169.5"/>
</g>
<!-- q_proj_4_2_0 -->
<g id="node405" class="node">
<title>q_proj_4_2_0</title>
<polygon fill="#9999ff" stroke="black" points="11910,-1367 11776,-1367 11776,-1299 11910,-1299 11910,-1367"/>
<text text-anchor="middle" x="11843" y="-1351.8" font-family="Times,serif" font-size="14.00">Q Projection 2_0</text>
<text text-anchor="middle" x="11843" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="11843" y="-1321.8" font-family="Times,serif" font-size="14.00">W_Q^{2,0}</text>
<text text-anchor="middle" x="11843" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- attention_4_2_0 -->
<g id="node406" class="node">
<title>attention_4_2_0</title>
<polygon fill="#9999ff" stroke="black" points="11614.5,-1212 11441.5,-1212 11441.5,-1144 11614.5,-1144 11614.5,-1212"/>
<text text-anchor="middle" x="11528" y="-1196.8" font-family="Times,serif" font-size="14.00">Attention 2_0</text>
<text text-anchor="middle" x="11528" y="-1181.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="11528" y="-1166.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="11528" y="-1151.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- q_proj_4_2_0&#45;&gt;attention_4_2_0 -->
<g id="edge394" class="edge">
<title>q_proj_4_2_0&#45;&gt;attention_4_2_0</title>
<path fill="none" stroke="black" d="M11843,-1298.87C11843,-1256.29 11843,-1189 11843,-1189 11843,-1189 11624.91,-1189 11624.91,-1189"/>
<polygon fill="black" stroke="black" points="11624.91,-1185.5 11614.91,-1189 11624.91,-1192.5 11624.91,-1185.5"/>
</g>
<!-- concat_group_4_2 -->
<g id="node409" class="node">
<title>concat_group_4_2</title>
<polygon fill="#ffd700" stroke="black" points="11075,-1043 10947,-990 11075,-937 11203,-990 11075,-1043"/>
<text text-anchor="middle" x="11075" y="-1001.3" font-family="Times,serif" font-size="14.00">Concat Group 2</text>
<text text-anchor="middle" x="11075" y="-986.3" font-family="Times,serif" font-size="14.00">[B×L×d×h_g]</text>
<text text-anchor="middle" x="11075" y="-971.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;11</text>
</g>
<!-- attention_4_2_0&#45;&gt;concat_group_4_2 -->
<g id="edge397" class="edge">
<title>attention_4_2_0&#45;&gt;concat_group_4_2</title>
<path fill="none" stroke="black" d="M11441.26,-1178C11339.42,-1178 11184.25,-1178 11184.25,-1178 11184.25,-1178 11184.25,-1008.08 11184.25,-1008.08"/>
<polygon fill="black" stroke="black" points="11187.75,-1008.08 11184.25,-998.08 11180.75,-1008.08 11187.75,-1008.08"/>
</g>
<!-- k_proj_4_2_0 -->
<g id="node407" class="node">
<title>k_proj_4_2_0</title>
<polygon fill="#9999ff" stroke="black" points="11718,-1367 11584,-1367 11584,-1299 11718,-1299 11718,-1367"/>
<text text-anchor="middle" x="11651" y="-1351.8" font-family="Times,serif" font-size="14.00">K Projection 2_0</text>
<text text-anchor="middle" x="11651" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="11651" y="-1321.8" font-family="Times,serif" font-size="14.00">W_K^{2,0}</text>
<text text-anchor="middle" x="11651" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- k_proj_4_2_0&#45;&gt;attention_4_2_0 -->
<g id="edge395" class="edge">
<title>k_proj_4_2_0&#45;&gt;attention_4_2_0</title>
<path fill="none" stroke="black" d="M11599.25,-1298.98C11599.25,-1298.98 11599.25,-1222.2 11599.25,-1222.2"/>
<polygon fill="black" stroke="black" points="11602.75,-1222.2 11599.25,-1212.2 11595.75,-1222.2 11602.75,-1222.2"/>
</g>
<!-- v_proj_4_2_0 -->
<g id="node408" class="node">
<title>v_proj_4_2_0</title>
<polygon fill="#9999ff" stroke="black" points="11525.5,-1367 11392.5,-1367 11392.5,-1299 11525.5,-1299 11525.5,-1367"/>
<text text-anchor="middle" x="11459" y="-1351.8" font-family="Times,serif" font-size="14.00">V Projection 2_0</text>
<text text-anchor="middle" x="11459" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="11459" y="-1321.8" font-family="Times,serif" font-size="14.00">W_V^{2,0}</text>
<text text-anchor="middle" x="11459" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- v_proj_4_2_0&#45;&gt;attention_4_2_0 -->
<g id="edge396" class="edge">
<title>v_proj_4_2_0&#45;&gt;attention_4_2_0</title>
<path fill="none" stroke="black" d="M11483.5,-1298.98C11483.5,-1298.98 11483.5,-1222.2 11483.5,-1222.2"/>
<polygon fill="black" stroke="black" points="11487,-1222.2 11483.5,-1212.2 11480,-1222.2 11487,-1222.2"/>
</g>
<!-- concat_group_4_2&#45;&gt;final_concat_4 -->
<g id="edge435" class="edge">
<title>concat_group_4_2&#45;&gt;final_concat_4</title>
<path fill="none" stroke="black" d="M11197.75,-987.77C11197.75,-967.4 11197.75,-814 11197.75,-814 11197.75,-814 11815.57,-814 11815.57,-814"/>
<polygon fill="black" stroke="black" points="11815.57,-817.5 11825.57,-814 11815.57,-810.5 11815.57,-817.5"/>
</g>
<!-- q_proj_4_2_1 -->
<g id="node410" class="node">
<title>q_proj_4_2_1</title>
<polygon fill="#cc99ff" stroke="black" points="11334,-1367 11200,-1367 11200,-1299 11334,-1299 11334,-1367"/>
<text text-anchor="middle" x="11267" y="-1351.8" font-family="Times,serif" font-size="14.00">Q Projection 2_1</text>
<text text-anchor="middle" x="11267" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="11267" y="-1321.8" font-family="Times,serif" font-size="14.00">W_Q^{2,1}</text>
<text text-anchor="middle" x="11267" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- attention_4_2_1 -->
<g id="node411" class="node">
<title>attention_4_2_1</title>
<polygon fill="#cc99ff" stroke="black" points="11161.5,-1212 10988.5,-1212 10988.5,-1144 11161.5,-1144 11161.5,-1212"/>
<text text-anchor="middle" x="11075" y="-1196.8" font-family="Times,serif" font-size="14.00">Attention 2_1</text>
<text text-anchor="middle" x="11075" y="-1181.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="11075" y="-1166.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="11075" y="-1151.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- q_proj_4_2_1&#45;&gt;attention_4_2_1 -->
<g id="edge398" class="edge">
<title>q_proj_4_2_1&#45;&gt;attention_4_2_1</title>
<path fill="none" stroke="black" d="M11199.96,-1333C11174.6,-1333 11151.75,-1333 11151.75,-1333 11151.75,-1333 11151.75,-1222.02 11151.75,-1222.02"/>
<polygon fill="black" stroke="black" points="11155.25,-1222.02 11151.75,-1212.02 11148.25,-1222.02 11155.25,-1222.02"/>
</g>
<!-- attention_4_2_1&#45;&gt;concat_group_4_2 -->
<g id="edge401" class="edge">
<title>attention_4_2_1&#45;&gt;concat_group_4_2</title>
<path fill="none" stroke="black" d="M11046.17,-1143.95C11046.17,-1143.95 11046.17,-1041.34 11046.17,-1041.34"/>
<polygon fill="black" stroke="black" points="11049.67,-1041.34 11046.17,-1031.34 11042.67,-1041.34 11049.67,-1041.34"/>
</g>
<!-- attention_4_2_1&#45;&gt;concat_group_4_2 -->
<g id="edge402" class="edge">
<title>attention_4_2_1&#45;&gt;concat_group_4_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11103.83,-1143.95C11103.83,-1143.95 11103.83,-1041.34 11103.83,-1041.34"/>
<polygon fill="red" stroke="red" points="11107.33,-1041.34 11103.83,-1031.34 11100.33,-1041.34 11107.33,-1041.34"/>
<text text-anchor="middle" x="11346" y="-1089.8" font-family="Times,serif" font-size="14.00">AllGather GPU8→GPU9</text>
</g>
<!-- k_proj_4_2_1 -->
<g id="node412" class="node">
<title>k_proj_4_2_1</title>
<polygon fill="#cc99ff" stroke="black" points="11142,-1367 11008,-1367 11008,-1299 11142,-1299 11142,-1367"/>
<text text-anchor="middle" x="11075" y="-1351.8" font-family="Times,serif" font-size="14.00">K Projection 2_1</text>
<text text-anchor="middle" x="11075" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="11075" y="-1321.8" font-family="Times,serif" font-size="14.00">W_K^{2,1}</text>
<text text-anchor="middle" x="11075" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- k_proj_4_2_1&#45;&gt;attention_4_2_1 -->
<g id="edge399" class="edge">
<title>k_proj_4_2_1&#45;&gt;attention_4_2_1</title>
<path fill="none" stroke="black" d="M11075,-1298.98C11075,-1298.98 11075,-1222.2 11075,-1222.2"/>
<polygon fill="black" stroke="black" points="11078.5,-1222.2 11075,-1212.2 11071.5,-1222.2 11078.5,-1222.2"/>
</g>
<!-- v_proj_4_2_1 -->
<g id="node413" class="node">
<title>v_proj_4_2_1</title>
<polygon fill="#cc99ff" stroke="black" points="10949.5,-1367 10816.5,-1367 10816.5,-1299 10949.5,-1299 10949.5,-1367"/>
<text text-anchor="middle" x="10883" y="-1351.8" font-family="Times,serif" font-size="14.00">V Projection 2_1</text>
<text text-anchor="middle" x="10883" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="10883" y="-1321.8" font-family="Times,serif" font-size="14.00">W_V^{2,1}</text>
<text text-anchor="middle" x="10883" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- v_proj_4_2_1&#45;&gt;attention_4_2_1 -->
<g id="edge400" class="edge">
<title>v_proj_4_2_1&#45;&gt;attention_4_2_1</title>
<path fill="none" stroke="black" d="M10941.75,-1298.89C10941.75,-1258.02 10941.75,-1195 10941.75,-1195 10941.75,-1195 10978.35,-1195 10978.35,-1195"/>
<polygon fill="black" stroke="black" points="10978.35,-1198.5 10988.35,-1195 10978.35,-1191.5 10978.35,-1198.5"/>
</g>
<!-- q_proj_4_2_2 -->
<g id="node414" class="node">
<title>q_proj_4_2_2</title>
<polygon fill="#ff99ff" stroke="black" points="10758,-1367 10624,-1367 10624,-1299 10758,-1299 10758,-1367"/>
<text text-anchor="middle" x="10691" y="-1351.8" font-family="Times,serif" font-size="14.00">Q Projection 2_2</text>
<text text-anchor="middle" x="10691" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="10691" y="-1321.8" font-family="Times,serif" font-size="14.00">W_Q^{2,2}</text>
<text text-anchor="middle" x="10691" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- attention_4_2_2 -->
<g id="node415" class="node">
<title>attention_4_2_2</title>
<polygon fill="#ff99ff" stroke="black" points="10635.5,-1212 10462.5,-1212 10462.5,-1144 10635.5,-1144 10635.5,-1212"/>
<text text-anchor="middle" x="10549" y="-1196.8" font-family="Times,serif" font-size="14.00">Attention 2_2</text>
<text text-anchor="middle" x="10549" y="-1181.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="10549" y="-1166.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="10549" y="-1151.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- q_proj_4_2_2&#45;&gt;attention_4_2_2 -->
<g id="edge403" class="edge">
<title>q_proj_4_2_2&#45;&gt;attention_4_2_2</title>
<path fill="none" stroke="black" d="M10629.75,-1298.98C10629.75,-1298.98 10629.75,-1222.2 10629.75,-1222.2"/>
<polygon fill="black" stroke="black" points="10633.25,-1222.2 10629.75,-1212.2 10626.25,-1222.2 10633.25,-1222.2"/>
</g>
<!-- attention_4_2_2&#45;&gt;concat_group_4_2 -->
<g id="edge406" class="edge">
<title>attention_4_2_2&#45;&gt;concat_group_4_2</title>
<path fill="none" stroke="black" d="M10635.56,-1178C10754.75,-1178 10954.83,-1178 10954.83,-1178 10954.83,-1178 10954.83,-1003.26 10954.83,-1003.26"/>
<polygon fill="black" stroke="black" points="10958.33,-1003.26 10954.83,-993.26 10951.33,-1003.26 10958.33,-1003.26"/>
</g>
<!-- attention_4_2_2&#45;&gt;concat_group_4_2 -->
<g id="edge407" class="edge">
<title>attention_4_2_2&#45;&gt;concat_group_4_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10635.98,-1161C10754.5,-1161 10952.17,-1161 10952.17,-1161 10952.17,-1161 10952.17,-1002.16 10952.17,-1002.16"/>
<polygon fill="red" stroke="red" points="10955.67,-1002.16 10952.17,-992.16 10948.67,-1002.16 10955.67,-1002.16"/>
<text text-anchor="middle" x="10866.5" y="-1089.8" font-family="Times,serif" font-size="14.00">AllGather GPU9→GPU10</text>
</g>
<!-- k_proj_4_2_2 -->
<g id="node416" class="node">
<title>k_proj_4_2_2</title>
<polygon fill="#ff99ff" stroke="black" points="10566,-1367 10432,-1367 10432,-1299 10566,-1299 10566,-1367"/>
<text text-anchor="middle" x="10499" y="-1351.8" font-family="Times,serif" font-size="14.00">K Projection 2_2</text>
<text text-anchor="middle" x="10499" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="10499" y="-1321.8" font-family="Times,serif" font-size="14.00">W_K^{2,2}</text>
<text text-anchor="middle" x="10499" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- k_proj_4_2_2&#45;&gt;attention_4_2_2 -->
<g id="edge404" class="edge">
<title>k_proj_4_2_2&#45;&gt;attention_4_2_2</title>
<path fill="none" stroke="black" d="M10514.25,-1298.98C10514.25,-1298.98 10514.25,-1222.2 10514.25,-1222.2"/>
<polygon fill="black" stroke="black" points="10517.75,-1222.2 10514.25,-1212.2 10510.75,-1222.2 10517.75,-1222.2"/>
</g>
<!-- v_proj_4_2_2 -->
<g id="node417" class="node">
<title>v_proj_4_2_2</title>
<polygon fill="#ff99ff" stroke="black" points="10373.5,-1367 10240.5,-1367 10240.5,-1299 10373.5,-1299 10373.5,-1367"/>
<text text-anchor="middle" x="10307" y="-1351.8" font-family="Times,serif" font-size="14.00">V Projection 2_2</text>
<text text-anchor="middle" x="10307" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="10307" y="-1321.8" font-family="Times,serif" font-size="14.00">W_V^{2,2}</text>
<text text-anchor="middle" x="10307" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- v_proj_4_2_2&#45;&gt;attention_4_2_2 -->
<g id="edge405" class="edge">
<title>v_proj_4_2_2&#45;&gt;attention_4_2_2</title>
<path fill="none" stroke="black" d="M10325,-1298.98C10325,-1253.36 10325,-1178 10325,-1178 10325,-1178 10452.4,-1178 10452.4,-1178"/>
<polygon fill="black" stroke="black" points="10452.4,-1181.5 10462.4,-1178 10452.4,-1174.5 10452.4,-1181.5"/>
</g>
<!-- q_proj_4_2_3 -->
<g id="node418" class="node">
<title>q_proj_4_2_3</title>
<polygon fill="#ff99cc" stroke="black" points="10182,-1367 10048,-1367 10048,-1299 10182,-1299 10182,-1367"/>
<text text-anchor="middle" x="10115" y="-1351.8" font-family="Times,serif" font-size="14.00">Q Projection 2_3</text>
<text text-anchor="middle" x="10115" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="10115" y="-1321.8" font-family="Times,serif" font-size="14.00">W_Q^{2,3}</text>
<text text-anchor="middle" x="10115" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- attention_4_2_3 -->
<g id="node419" class="node">
<title>attention_4_2_3</title>
<polygon fill="#ff99cc" stroke="black" points="10059.5,-1212 9886.5,-1212 9886.5,-1144 10059.5,-1144 10059.5,-1212"/>
<text text-anchor="middle" x="9973" y="-1196.8" font-family="Times,serif" font-size="14.00">Attention 2_3</text>
<text text-anchor="middle" x="9973" y="-1181.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="9973" y="-1166.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="9973" y="-1151.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- q_proj_4_2_3&#45;&gt;attention_4_2_3 -->
<g id="edge408" class="edge">
<title>q_proj_4_2_3&#45;&gt;attention_4_2_3</title>
<path fill="none" stroke="black" d="M10053.75,-1298.98C10053.75,-1298.98 10053.75,-1222.2 10053.75,-1222.2"/>
<polygon fill="black" stroke="black" points="10057.25,-1222.2 10053.75,-1212.2 10050.25,-1222.2 10057.25,-1222.2"/>
</g>
<!-- attention_4_2_3&#45;&gt;concat_group_4_2 -->
<g id="edge411" class="edge">
<title>attention_4_2_3&#45;&gt;concat_group_4_2</title>
<path fill="none" stroke="black" d="M10055.5,-1143.81C10055.5,-1093.9 10055.5,-1007 10055.5,-1007 10055.5,-1007 10977.64,-1007 10977.64,-1007"/>
<polygon fill="black" stroke="black" points="10977.64,-1010.5 10987.64,-1007 10977.64,-1003.5 10977.64,-1010.5"/>
</g>
<!-- attention_4_2_3&#45;&gt;concat_group_4_2 -->
<g id="edge412" class="edge">
<title>attention_4_2_3&#45;&gt;concat_group_4_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10051.5,-1143.98C10051.5,-1085.47 10051.5,-972 10051.5,-972 10051.5,-972 10980.37,-972 10980.37,-972"/>
<polygon fill="red" stroke="red" points="10980.37,-975.5 10990.37,-972 10980.37,-968.5 10980.37,-975.5"/>
<text text-anchor="middle" x="10347" y="-1089.8" font-family="Times,serif" font-size="14.00">AllGather GPU10→GPU11</text>
</g>
<!-- k_proj_4_2_3 -->
<g id="node420" class="node">
<title>k_proj_4_2_3</title>
<polygon fill="#ff99cc" stroke="black" points="9990,-1367 9856,-1367 9856,-1299 9990,-1299 9990,-1367"/>
<text text-anchor="middle" x="9923" y="-1351.8" font-family="Times,serif" font-size="14.00">K Projection 2_3</text>
<text text-anchor="middle" x="9923" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="9923" y="-1321.8" font-family="Times,serif" font-size="14.00">W_K^{2,3}</text>
<text text-anchor="middle" x="9923" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- k_proj_4_2_3&#45;&gt;attention_4_2_3 -->
<g id="edge409" class="edge">
<title>k_proj_4_2_3&#45;&gt;attention_4_2_3</title>
<path fill="none" stroke="black" d="M9938.25,-1298.98C9938.25,-1298.98 9938.25,-1222.2 9938.25,-1222.2"/>
<polygon fill="black" stroke="black" points="9941.75,-1222.2 9938.25,-1212.2 9934.75,-1222.2 9941.75,-1222.2"/>
</g>
<!-- v_proj_4_2_3 -->
<g id="node421" class="node">
<title>v_proj_4_2_3</title>
<polygon fill="#ff99cc" stroke="black" points="9797.5,-1367 9664.5,-1367 9664.5,-1299 9797.5,-1299 9797.5,-1367"/>
<text text-anchor="middle" x="9731" y="-1351.8" font-family="Times,serif" font-size="14.00">V Projection 2_3</text>
<text text-anchor="middle" x="9731" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="9731" y="-1321.8" font-family="Times,serif" font-size="14.00">W_V^{2,3}</text>
<text text-anchor="middle" x="9731" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- v_proj_4_2_3&#45;&gt;attention_4_2_3 -->
<g id="edge410" class="edge">
<title>v_proj_4_2_3&#45;&gt;attention_4_2_3</title>
<path fill="none" stroke="black" d="M9762.25,-1298.8C9762.25,-1249.94 9762.25,-1166 9762.25,-1166 9762.25,-1166 9876.37,-1166 9876.37,-1166"/>
<polygon fill="black" stroke="black" points="9876.37,-1169.5 9886.37,-1166 9876.37,-1162.5 9876.37,-1169.5"/>
</g>
<!-- q_proj_4_3_0 -->
<g id="node422" class="node">
<title>q_proj_4_3_0</title>
<polygon fill="#ffb366" stroke="black" points="9606,-1367 9472,-1367 9472,-1299 9606,-1299 9606,-1367"/>
<text text-anchor="middle" x="9539" y="-1351.8" font-family="Times,serif" font-size="14.00">Q Projection 3_0</text>
<text text-anchor="middle" x="9539" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="9539" y="-1321.8" font-family="Times,serif" font-size="14.00">W_Q^{3,0}</text>
<text text-anchor="middle" x="9539" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- attention_4_3_0 -->
<g id="node423" class="node">
<title>attention_4_3_0</title>
<polygon fill="#ffb366" stroke="black" points="9358.5,-1212 9185.5,-1212 9185.5,-1144 9358.5,-1144 9358.5,-1212"/>
<text text-anchor="middle" x="9272" y="-1196.8" font-family="Times,serif" font-size="14.00">Attention 3_0</text>
<text text-anchor="middle" x="9272" y="-1181.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="9272" y="-1166.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="9272" y="-1151.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- q_proj_4_3_0&#45;&gt;attention_4_3_0 -->
<g id="edge413" class="edge">
<title>q_proj_4_3_0&#45;&gt;attention_4_3_0</title>
<path fill="none" stroke="black" d="M9483.5,-1298.87C9483.5,-1256.29 9483.5,-1189 9483.5,-1189 9483.5,-1189 9368.64,-1189 9368.64,-1189"/>
<polygon fill="black" stroke="black" points="9368.64,-1185.5 9358.64,-1189 9368.64,-1192.5 9368.64,-1185.5"/>
</g>
<!-- concat_group_4_3 -->
<g id="node426" class="node">
<title>concat_group_4_3</title>
<polygon fill="#ffd700" stroke="black" points="8771,-1043 8643,-990 8771,-937 8899,-990 8771,-1043"/>
<text text-anchor="middle" x="8771" y="-1001.3" font-family="Times,serif" font-size="14.00">Concat Group 3</text>
<text text-anchor="middle" x="8771" y="-986.3" font-family="Times,serif" font-size="14.00">[B×L×d×h_g]</text>
<text text-anchor="middle" x="8771" y="-971.3" font-family="Times,serif" font-size="14.00">GPU: 12&#45;15</text>
</g>
<!-- attention_4_3_0&#45;&gt;concat_group_4_3 -->
<g id="edge416" class="edge">
<title>attention_4_3_0&#45;&gt;concat_group_4_3</title>
<path fill="none" stroke="black" d="M9185.09,-1178C9070.92,-1178 8884.75,-1178 8884.75,-1178 8884.75,-1178 8884.75,-1006.26 8884.75,-1006.26"/>
<polygon fill="black" stroke="black" points="8888.25,-1006.26 8884.75,-996.26 8881.25,-1006.26 8888.25,-1006.26"/>
</g>
<!-- k_proj_4_3_0 -->
<g id="node424" class="node">
<title>k_proj_4_3_0</title>
<polygon fill="#ffb366" stroke="black" points="9414,-1367 9280,-1367 9280,-1299 9414,-1299 9414,-1367"/>
<text text-anchor="middle" x="9347" y="-1351.8" font-family="Times,serif" font-size="14.00">K Projection 3_0</text>
<text text-anchor="middle" x="9347" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="9347" y="-1321.8" font-family="Times,serif" font-size="14.00">W_K^{3,0}</text>
<text text-anchor="middle" x="9347" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- k_proj_4_3_0&#45;&gt;attention_4_3_0 -->
<g id="edge414" class="edge">
<title>k_proj_4_3_0&#45;&gt;attention_4_3_0</title>
<path fill="none" stroke="black" d="M9319.25,-1298.98C9319.25,-1298.98 9319.25,-1222.2 9319.25,-1222.2"/>
<polygon fill="black" stroke="black" points="9322.75,-1222.2 9319.25,-1212.2 9315.75,-1222.2 9322.75,-1222.2"/>
</g>
<!-- v_proj_4_3_0 -->
<g id="node425" class="node">
<title>v_proj_4_3_0</title>
<polygon fill="#ffb366" stroke="black" points="9221.5,-1367 9088.5,-1367 9088.5,-1299 9221.5,-1299 9221.5,-1367"/>
<text text-anchor="middle" x="9155" y="-1351.8" font-family="Times,serif" font-size="14.00">V Projection 3_0</text>
<text text-anchor="middle" x="9155" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="9155" y="-1321.8" font-family="Times,serif" font-size="14.00">W_V^{3,0}</text>
<text text-anchor="middle" x="9155" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- v_proj_4_3_0&#45;&gt;attention_4_3_0 -->
<g id="edge415" class="edge">
<title>v_proj_4_3_0&#45;&gt;attention_4_3_0</title>
<path fill="none" stroke="black" d="M9203.5,-1298.98C9203.5,-1298.98 9203.5,-1222.2 9203.5,-1222.2"/>
<polygon fill="black" stroke="black" points="9207,-1222.2 9203.5,-1212.2 9200,-1222.2 9207,-1222.2"/>
</g>
<!-- concat_group_4_3&#45;&gt;final_concat_4 -->
<g id="edge436" class="edge">
<title>concat_group_4_3&#45;&gt;final_concat_4</title>
<path fill="none" stroke="black" d="M8882.5,-982.98C8882.5,-946.37 8882.5,-779 8882.5,-779 8882.5,-779 11818.8,-779 11818.8,-779"/>
<polygon fill="black" stroke="black" points="11818.8,-782.5 11828.8,-779 11818.8,-775.5 11818.8,-782.5"/>
</g>
<!-- q_proj_4_3_1 -->
<g id="node427" class="node">
<title>q_proj_4_3_1</title>
<polygon fill="#b3ff66" stroke="black" points="9030,-1367 8896,-1367 8896,-1299 9030,-1299 9030,-1367"/>
<text text-anchor="middle" x="8963" y="-1351.8" font-family="Times,serif" font-size="14.00">Q Projection 3_1</text>
<text text-anchor="middle" x="8963" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="8963" y="-1321.8" font-family="Times,serif" font-size="14.00">W_Q^{3,1}</text>
<text text-anchor="middle" x="8963" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- attention_4_3_1 -->
<g id="node428" class="node">
<title>attention_4_3_1</title>
<polygon fill="#b3ff66" stroke="black" points="8857.5,-1212 8684.5,-1212 8684.5,-1144 8857.5,-1144 8857.5,-1212"/>
<text text-anchor="middle" x="8771" y="-1196.8" font-family="Times,serif" font-size="14.00">Attention 3_1</text>
<text text-anchor="middle" x="8771" y="-1181.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="8771" y="-1166.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="8771" y="-1151.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- q_proj_4_3_1&#45;&gt;attention_4_3_1 -->
<g id="edge417" class="edge">
<title>q_proj_4_3_1&#45;&gt;attention_4_3_1</title>
<path fill="none" stroke="black" d="M8895.96,-1333C8870.6,-1333 8847.75,-1333 8847.75,-1333 8847.75,-1333 8847.75,-1222.02 8847.75,-1222.02"/>
<polygon fill="black" stroke="black" points="8851.25,-1222.02 8847.75,-1212.02 8844.25,-1222.02 8851.25,-1222.02"/>
</g>
<!-- attention_4_3_1&#45;&gt;concat_group_4_3 -->
<g id="edge420" class="edge">
<title>attention_4_3_1&#45;&gt;concat_group_4_3</title>
<path fill="none" stroke="black" d="M8742.17,-1143.95C8742.17,-1143.95 8742.17,-1041.34 8742.17,-1041.34"/>
<polygon fill="black" stroke="black" points="8745.67,-1041.34 8742.17,-1031.34 8738.67,-1041.34 8745.67,-1041.34"/>
</g>
<!-- attention_4_3_1&#45;&gt;concat_group_4_3 -->
<g id="edge421" class="edge">
<title>attention_4_3_1&#45;&gt;concat_group_4_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8799.83,-1143.95C8799.83,-1143.95 8799.83,-1041.34 8799.83,-1041.34"/>
<polygon fill="red" stroke="red" points="8803.33,-1041.34 8799.83,-1031.34 8796.33,-1041.34 8803.33,-1041.34"/>
<text text-anchor="middle" x="9041" y="-1089.8" font-family="Times,serif" font-size="14.00">AllGather GPU12→GPU13</text>
</g>
<!-- k_proj_4_3_1 -->
<g id="node429" class="node">
<title>k_proj_4_3_1</title>
<polygon fill="#b3ff66" stroke="black" points="8838,-1367 8704,-1367 8704,-1299 8838,-1299 8838,-1367"/>
<text text-anchor="middle" x="8771" y="-1351.8" font-family="Times,serif" font-size="14.00">K Projection 3_1</text>
<text text-anchor="middle" x="8771" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="8771" y="-1321.8" font-family="Times,serif" font-size="14.00">W_K^{3,1}</text>
<text text-anchor="middle" x="8771" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- k_proj_4_3_1&#45;&gt;attention_4_3_1 -->
<g id="edge418" class="edge">
<title>k_proj_4_3_1&#45;&gt;attention_4_3_1</title>
<path fill="none" stroke="black" d="M8771,-1298.98C8771,-1298.98 8771,-1222.2 8771,-1222.2"/>
<polygon fill="black" stroke="black" points="8774.5,-1222.2 8771,-1212.2 8767.5,-1222.2 8774.5,-1222.2"/>
</g>
<!-- v_proj_4_3_1 -->
<g id="node430" class="node">
<title>v_proj_4_3_1</title>
<polygon fill="#b3ff66" stroke="black" points="8645.5,-1367 8512.5,-1367 8512.5,-1299 8645.5,-1299 8645.5,-1367"/>
<text text-anchor="middle" x="8579" y="-1351.8" font-family="Times,serif" font-size="14.00">V Projection 3_1</text>
<text text-anchor="middle" x="8579" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="8579" y="-1321.8" font-family="Times,serif" font-size="14.00">W_V^{3,1}</text>
<text text-anchor="middle" x="8579" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- v_proj_4_3_1&#45;&gt;attention_4_3_1 -->
<g id="edge419" class="edge">
<title>v_proj_4_3_1&#45;&gt;attention_4_3_1</title>
<path fill="none" stroke="black" d="M8635.5,-1298.89C8635.5,-1258.02 8635.5,-1195 8635.5,-1195 8635.5,-1195 8674.42,-1195 8674.42,-1195"/>
<polygon fill="black" stroke="black" points="8674.42,-1198.5 8684.42,-1195 8674.42,-1191.5 8674.42,-1198.5"/>
</g>
<!-- q_proj_4_3_2 -->
<g id="node431" class="node">
<title>q_proj_4_3_2</title>
<polygon fill="#66ffb3" stroke="black" points="8454,-1367 8320,-1367 8320,-1299 8454,-1299 8454,-1367"/>
<text text-anchor="middle" x="8387" y="-1351.8" font-family="Times,serif" font-size="14.00">Q Projection 3_2</text>
<text text-anchor="middle" x="8387" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="8387" y="-1321.8" font-family="Times,serif" font-size="14.00">W_Q^{3,2}</text>
<text text-anchor="middle" x="8387" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- attention_4_3_2 -->
<g id="node432" class="node">
<title>attention_4_3_2</title>
<polygon fill="#66ffb3" stroke="black" points="8381.5,-1212 8208.5,-1212 8208.5,-1144 8381.5,-1144 8381.5,-1212"/>
<text text-anchor="middle" x="8295" y="-1196.8" font-family="Times,serif" font-size="14.00">Attention 3_2</text>
<text text-anchor="middle" x="8295" y="-1181.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="8295" y="-1166.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="8295" y="-1151.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- q_proj_4_3_2&#45;&gt;attention_4_3_2 -->
<g id="edge422" class="edge">
<title>q_proj_4_3_2&#45;&gt;attention_4_3_2</title>
<path fill="none" stroke="black" d="M8350.75,-1298.98C8350.75,-1298.98 8350.75,-1222.2 8350.75,-1222.2"/>
<polygon fill="black" stroke="black" points="8354.25,-1222.2 8350.75,-1212.2 8347.25,-1222.2 8354.25,-1222.2"/>
</g>
<!-- attention_4_3_2&#45;&gt;concat_group_4_3 -->
<g id="edge425" class="edge">
<title>attention_4_3_2&#45;&gt;concat_group_4_3</title>
<path fill="none" stroke="black" d="M8381.67,-1178C8488.71,-1178 8656.83,-1178 8656.83,-1178 8656.83,-1178 8656.83,-1005.83 8656.83,-1005.83"/>
<polygon fill="black" stroke="black" points="8660.33,-1005.83 8656.83,-995.83 8653.33,-1005.83 8660.33,-1005.83"/>
</g>
<!-- attention_4_3_2&#45;&gt;concat_group_4_3 -->
<g id="edge426" class="edge">
<title>attention_4_3_2&#45;&gt;concat_group_4_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8381.67,-1161C8487.1,-1161 8651.17,-1161 8651.17,-1161 8651.17,-1161 8651.17,-1003.57 8651.17,-1003.57"/>
<polygon fill="red" stroke="red" points="8654.67,-1003.57 8651.17,-993.57 8647.67,-1003.57 8654.67,-1003.57"/>
<text text-anchor="middle" x="8632" y="-1089.8" font-family="Times,serif" font-size="14.00">AllGather GPU13→GPU14</text>
</g>
<!-- k_proj_4_3_2 -->
<g id="node433" class="node">
<title>k_proj_4_3_2</title>
<polygon fill="#66ffb3" stroke="black" points="8262,-1367 8128,-1367 8128,-1299 8262,-1299 8262,-1367"/>
<text text-anchor="middle" x="8195" y="-1351.8" font-family="Times,serif" font-size="14.00">K Projection 3_2</text>
<text text-anchor="middle" x="8195" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="8195" y="-1321.8" font-family="Times,serif" font-size="14.00">W_K^{3,2}</text>
<text text-anchor="middle" x="8195" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- k_proj_4_3_2&#45;&gt;attention_4_3_2 -->
<g id="edge423" class="edge">
<title>k_proj_4_3_2&#45;&gt;attention_4_3_2</title>
<path fill="none" stroke="black" d="M8235.25,-1298.98C8235.25,-1298.98 8235.25,-1222.2 8235.25,-1222.2"/>
<polygon fill="black" stroke="black" points="8238.75,-1222.2 8235.25,-1212.2 8231.75,-1222.2 8238.75,-1222.2"/>
</g>
<!-- v_proj_4_3_2 -->
<g id="node434" class="node">
<title>v_proj_4_3_2</title>
<polygon fill="#66ffb3" stroke="black" points="8069.5,-1367 7936.5,-1367 7936.5,-1299 8069.5,-1299 8069.5,-1367"/>
<text text-anchor="middle" x="8003" y="-1351.8" font-family="Times,serif" font-size="14.00">V Projection 3_2</text>
<text text-anchor="middle" x="8003" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="8003" y="-1321.8" font-family="Times,serif" font-size="14.00">W_V^{3,2}</text>
<text text-anchor="middle" x="8003" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- v_proj_4_3_2&#45;&gt;attention_4_3_2 -->
<g id="edge424" class="edge">
<title>v_proj_4_3_2&#45;&gt;attention_4_3_2</title>
<path fill="none" stroke="black" d="M8003,-1298.98C8003,-1253.36 8003,-1178 8003,-1178 8003,-1178 8198.18,-1178 8198.18,-1178"/>
<polygon fill="black" stroke="black" points="8198.18,-1181.5 8208.18,-1178 8198.18,-1174.5 8198.18,-1181.5"/>
</g>
<!-- q_proj_4_3_3 -->
<g id="node435" class="node">
<title>q_proj_4_3_3</title>
<polygon fill="#66b3ff" stroke="black" points="7878,-1367 7744,-1367 7744,-1299 7878,-1299 7878,-1367"/>
<text text-anchor="middle" x="7811" y="-1351.8" font-family="Times,serif" font-size="14.00">Q Projection 3_3</text>
<text text-anchor="middle" x="7811" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="7811" y="-1321.8" font-family="Times,serif" font-size="14.00">W_Q^{3,3}</text>
<text text-anchor="middle" x="7811" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- attention_4_3_3 -->
<g id="node436" class="node">
<title>attention_4_3_3</title>
<polygon fill="#66b3ff" stroke="black" points="7753.5,-1212 7580.5,-1212 7580.5,-1144 7753.5,-1144 7753.5,-1212"/>
<text text-anchor="middle" x="7667" y="-1196.8" font-family="Times,serif" font-size="14.00">Attention 3_3</text>
<text text-anchor="middle" x="7667" y="-1181.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="7667" y="-1166.8" font-family="Times,serif" font-size="14.00">softmax(QK^T/√d_s)V</text>
<text text-anchor="middle" x="7667" y="-1151.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- q_proj_4_3_3&#45;&gt;attention_4_3_3 -->
<g id="edge427" class="edge">
<title>q_proj_4_3_3&#45;&gt;attention_4_3_3</title>
<path fill="none" stroke="black" d="M7748.75,-1298.98C7748.75,-1298.98 7748.75,-1222.2 7748.75,-1222.2"/>
<polygon fill="black" stroke="black" points="7752.25,-1222.2 7748.75,-1212.2 7745.25,-1222.2 7752.25,-1222.2"/>
</g>
<!-- attention_4_3_3&#45;&gt;concat_group_4_3 -->
<g id="edge430" class="edge">
<title>attention_4_3_3&#45;&gt;concat_group_4_3</title>
<path fill="none" stroke="black" d="M7695.83,-1143.81C7695.83,-1093.9 7695.83,-1007 7695.83,-1007 7695.83,-1007 8673.93,-1007 8673.93,-1007"/>
<polygon fill="black" stroke="black" points="8673.93,-1010.5 8683.93,-1007 8673.93,-1003.5 8673.93,-1010.5"/>
</g>
<!-- attention_4_3_3&#45;&gt;concat_group_4_3 -->
<g id="edge431" class="edge">
<title>attention_4_3_3&#45;&gt;concat_group_4_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7638.17,-1143.98C7638.17,-1085.47 7638.17,-972 7638.17,-972 7638.17,-972 8676.32,-972 8676.32,-972"/>
<polygon fill="red" stroke="red" points="8676.32,-975.5 8686.32,-972 8676.32,-968.5 8676.32,-975.5"/>
<text text-anchor="middle" x="8212" y="-1089.8" font-family="Times,serif" font-size="14.00">AllGather GPU14→GPU15</text>
</g>
<!-- k_proj_4_3_3 -->
<g id="node437" class="node">
<title>k_proj_4_3_3</title>
<polygon fill="#66b3ff" stroke="black" points="7686,-1367 7552,-1367 7552,-1299 7686,-1299 7686,-1367"/>
<text text-anchor="middle" x="7619" y="-1351.8" font-family="Times,serif" font-size="14.00">K Projection 3_3</text>
<text text-anchor="middle" x="7619" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="7619" y="-1321.8" font-family="Times,serif" font-size="14.00">W_K^{3,3}</text>
<text text-anchor="middle" x="7619" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- k_proj_4_3_3&#45;&gt;attention_4_3_3 -->
<g id="edge428" class="edge">
<title>k_proj_4_3_3&#45;&gt;attention_4_3_3</title>
<path fill="none" stroke="black" d="M7633.25,-1298.98C7633.25,-1298.98 7633.25,-1222.2 7633.25,-1222.2"/>
<polygon fill="black" stroke="black" points="7636.75,-1222.2 7633.25,-1212.2 7629.75,-1222.2 7636.75,-1222.2"/>
</g>
<!-- v_proj_4_3_3 -->
<g id="node438" class="node">
<title>v_proj_4_3_3</title>
<polygon fill="#66b3ff" stroke="black" points="7493.5,-1367 7360.5,-1367 7360.5,-1299 7493.5,-1299 7493.5,-1367"/>
<text text-anchor="middle" x="7427" y="-1351.8" font-family="Times,serif" font-size="14.00">V Projection 3_3</text>
<text text-anchor="middle" x="7427" y="-1336.8" font-family="Times,serif" font-size="14.00">[B×L×d_s×h_g]</text>
<text text-anchor="middle" x="7427" y="-1321.8" font-family="Times,serif" font-size="14.00">W_V^{3,3}</text>
<text text-anchor="middle" x="7427" y="-1306.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- v_proj_4_3_3&#45;&gt;attention_4_3_3 -->
<g id="edge429" class="edge">
<title>v_proj_4_3_3&#45;&gt;attention_4_3_3</title>
<path fill="none" stroke="black" d="M7427,-1298.98C7427,-1253.36 7427,-1178 7427,-1178 7427,-1178 7570.35,-1178 7570.35,-1178"/>
<polygon fill="black" stroke="black" points="7570.35,-1181.5 7580.35,-1178 7570.35,-1174.5 7570.35,-1181.5"/>
</g>
<!-- expert_gate_4_0 -->
<g id="node440" class="node">
<title>expert_gate_4_0</title>
<polygon fill="#ff9999" stroke="black" points="11996.5,-657 11879.5,-657 11879.5,-604 11996.5,-604 11996.5,-657"/>
<text text-anchor="middle" x="11938" y="-641.8" font-family="Times,serif" font-size="14.00">Expert Gate 0</text>
<text text-anchor="middle" x="11938" y="-626.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="11938" y="-611.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- final_concat_4&#45;&gt;expert_gate_4_0 -->
<g id="edge433" class="edge">
<title>final_concat_4&#45;&gt;expert_gate_4_0</title>
<path fill="none" stroke="black" d="M11938,-743.86C11938,-743.86 11938,-667.1 11938,-667.1"/>
<polygon fill="black" stroke="black" points="11941.5,-667.1 11938,-657.1 11934.5,-667.1 11941.5,-667.1"/>
</g>
<!-- expert_4_0_0 -->
<g id="node441" class="node">
<title>expert_4_0_0</title>
<polygon fill="#ff9999" stroke="black" points="11985.5,-517 11890.5,-517 11890.5,-464 11985.5,-464 11985.5,-517"/>
<text text-anchor="middle" x="11938" y="-501.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="11938" y="-486.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="11938" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_gate_4_0&#45;&gt;expert_4_0_0 -->
<g id="edge437" class="edge">
<title>expert_gate_4_0&#45;&gt;expert_4_0_0</title>
<path fill="none" stroke="black" d="M11938,-603.84C11938,-603.84 11938,-527.06 11938,-527.06"/>
<polygon fill="black" stroke="black" points="11941.5,-527.06 11938,-517.06 11934.5,-527.06 11941.5,-527.06"/>
</g>
<!-- expert_agg_4_0 -->
<g id="node442" class="node">
<title>expert_agg_4_0</title>
<polygon fill="#ff9999" stroke="black" points="12023.5,-377 11852.5,-377 11852.5,-324 12023.5,-324 12023.5,-377"/>
<text text-anchor="middle" x="11938" y="-361.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 0</text>
<text text-anchor="middle" x="11938" y="-346.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="11938" y="-331.8" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_4_0_0&#45;&gt;expert_agg_4_0 -->
<g id="edge438" class="edge">
<title>expert_4_0_0&#45;&gt;expert_agg_4_0</title>
<path fill="none" stroke="black" d="M11938,-463.84C11938,-463.84 11938,-387.06 11938,-387.06"/>
<polygon fill="black" stroke="black" points="11941.5,-387.06 11938,-377.06 11934.5,-387.06 11941.5,-387.06"/>
</g>
<!-- layer_norm_4 -->
<g id="node446" class="node">
<title>layer_norm_4</title>
<ellipse fill="#e6e6e6" stroke="black" cx="10220" cy="-199.5" rx="82" ry="37.5"/>
<text text-anchor="middle" x="10220" y="-210.8" font-family="Times,serif" font-size="14.00">Layer Norm 4</text>
<text text-anchor="middle" x="10220" y="-195.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="10220" y="-180.8" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- expert_agg_4_0&#45;&gt;layer_norm_4 -->
<g id="edge439" class="edge">
<title>expert_agg_4_0&#45;&gt;layer_norm_4</title>
<path fill="none" stroke="black" d="M11938,-323.63C11938,-273.55 11938,-171 11938,-171 11938,-171 10283.3,-171 10283.3,-171"/>
<polygon fill="black" stroke="black" points="10283.3,-167.5 10273.3,-171 10283.3,-174.5 10283.3,-167.5"/>
</g>
<!-- expert_4_0_1 -->
<g id="node443" class="node">
<title>expert_4_0_1</title>
<polygon fill="#ff9999" stroke="black" points="7302.5,-1359.5 7207.5,-1359.5 7207.5,-1306.5 7302.5,-1306.5 7302.5,-1359.5"/>
<text text-anchor="middle" x="7255" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="7255" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="7255" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_4_0_2 -->
<g id="node444" class="node">
<title>expert_4_0_2</title>
<polygon fill="#ff9999" stroke="black" points="7149.5,-1359.5 7054.5,-1359.5 7054.5,-1306.5 7149.5,-1306.5 7149.5,-1359.5"/>
<text text-anchor="middle" x="7102" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="7102" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="7102" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_4_0_3 -->
<g id="node445" class="node">
<title>expert_4_0_3</title>
<polygon fill="#ff9999" stroke="black" points="6996.5,-1359.5 6901.5,-1359.5 6901.5,-1306.5 6996.5,-1306.5 6996.5,-1359.5"/>
<text text-anchor="middle" x="6949" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6949" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="6949" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- output_proj -->
<g id="node538" class="node">
<title>output_proj</title>
<ellipse fill="#e6e6e6" stroke="black" cx="10220" cy="-37.5" rx="102" ry="37.5"/>
<text text-anchor="middle" x="10220" y="-48.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10220" y="-33.8" font-family="Times,serif" font-size="14.00">[B×L×Vocab]</text>
<text text-anchor="middle" x="10220" y="-18.8" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- layer_norm_4&#45;&gt;output_proj -->
<g id="edge492" class="edge">
<title>layer_norm_4&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M10220,-161.93C10220,-161.93 10220,-85.15 10220,-85.15"/>
<polygon fill="black" stroke="black" points="10223.5,-85.15 10220,-75.15 10216.5,-85.15 10223.5,-85.15"/>
</g>
<!-- expert_gate_4_1 -->
<g id="node447" class="node">
<title>expert_gate_4_1</title>
<polygon fill="#ffcc99" stroke="black" points="11767.5,-657 11650.5,-657 11650.5,-604 11767.5,-604 11767.5,-657"/>
<text text-anchor="middle" x="11709" y="-641.8" font-family="Times,serif" font-size="14.00">Expert Gate 1</text>
<text text-anchor="middle" x="11709" y="-626.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="11709" y="-611.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_4_1_0 -->
<g id="node448" class="node">
<title>expert_4_1_0</title>
<polygon fill="#ffcc99" stroke="black" points="11756.5,-517 11661.5,-517 11661.5,-464 11756.5,-464 11756.5,-517"/>
<text text-anchor="middle" x="11709" y="-501.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="11709" y="-486.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="11709" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_gate_4_1&#45;&gt;expert_4_1_0 -->
<g id="edge440" class="edge">
<title>expert_gate_4_1&#45;&gt;expert_4_1_0</title>
<path fill="none" stroke="black" d="M11709,-603.84C11709,-603.84 11709,-527.06 11709,-527.06"/>
<polygon fill="black" stroke="black" points="11712.5,-527.06 11709,-517.06 11705.5,-527.06 11712.5,-527.06"/>
</g>
<!-- expert_agg_4_1 -->
<g id="node449" class="node">
<title>expert_agg_4_1</title>
<polygon fill="#ffcc99" stroke="black" points="11794.5,-377 11623.5,-377 11623.5,-324 11794.5,-324 11794.5,-377"/>
<text text-anchor="middle" x="11709" y="-361.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 1</text>
<text text-anchor="middle" x="11709" y="-346.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="11709" y="-331.8" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_4_1_0&#45;&gt;expert_agg_4_1 -->
<g id="edge441" class="edge">
<title>expert_4_1_0&#45;&gt;expert_agg_4_1</title>
<path fill="none" stroke="black" d="M11709,-463.84C11709,-463.84 11709,-387.06 11709,-387.06"/>
<polygon fill="black" stroke="black" points="11712.5,-387.06 11709,-377.06 11705.5,-387.06 11712.5,-387.06"/>
</g>
<!-- expert_agg_4_1&#45;&gt;layer_norm_4 -->
<g id="edge442" class="edge">
<title>expert_agg_4_1&#45;&gt;layer_norm_4</title>
<path fill="none" stroke="black" d="M11709,-323.86C11709,-275.91 11709,-180 11709,-180 11709,-180 10300.32,-180 10300.32,-180"/>
<polygon fill="black" stroke="black" points="10300.32,-176.5 10290.32,-180 10300.32,-183.5 10300.32,-176.5"/>
</g>
<!-- expert_4_1_1 -->
<g id="node450" class="node">
<title>expert_4_1_1</title>
<polygon fill="#ffcc99" stroke="black" points="6843.5,-1359.5 6748.5,-1359.5 6748.5,-1306.5 6843.5,-1306.5 6843.5,-1359.5"/>
<text text-anchor="middle" x="6796" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="6796" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="6796" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_4_1_2 -->
<g id="node451" class="node">
<title>expert_4_1_2</title>
<polygon fill="#ffcc99" stroke="black" points="6690.5,-1359.5 6595.5,-1359.5 6595.5,-1306.5 6690.5,-1306.5 6690.5,-1359.5"/>
<text text-anchor="middle" x="6643" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="6643" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="6643" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_4_1_3 -->
<g id="node452" class="node">
<title>expert_4_1_3</title>
<polygon fill="#ffcc99" stroke="black" points="6537.5,-1359.5 6442.5,-1359.5 6442.5,-1306.5 6537.5,-1306.5 6537.5,-1359.5"/>
<text text-anchor="middle" x="6490" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6490" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="6490" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_gate_4_2 -->
<g id="node453" class="node">
<title>expert_gate_4_2</title>
<polygon fill="#ffff99" stroke="black" points="11538.5,-657 11421.5,-657 11421.5,-604 11538.5,-604 11538.5,-657"/>
<text text-anchor="middle" x="11480" y="-641.8" font-family="Times,serif" font-size="14.00">Expert Gate 2</text>
<text text-anchor="middle" x="11480" y="-626.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="11480" y="-611.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_4_2_0 -->
<g id="node454" class="node">
<title>expert_4_2_0</title>
<polygon fill="#ffff99" stroke="black" points="11527.5,-517 11432.5,-517 11432.5,-464 11527.5,-464 11527.5,-517"/>
<text text-anchor="middle" x="11480" y="-501.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="11480" y="-486.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="11480" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_gate_4_2&#45;&gt;expert_4_2_0 -->
<g id="edge443" class="edge">
<title>expert_gate_4_2&#45;&gt;expert_4_2_0</title>
<path fill="none" stroke="black" d="M11480,-603.84C11480,-603.84 11480,-527.06 11480,-527.06"/>
<polygon fill="black" stroke="black" points="11483.5,-527.06 11480,-517.06 11476.5,-527.06 11483.5,-527.06"/>
</g>
<!-- expert_agg_4_2 -->
<g id="node455" class="node">
<title>expert_agg_4_2</title>
<polygon fill="#ffff99" stroke="black" points="11565.5,-377 11394.5,-377 11394.5,-324 11565.5,-324 11565.5,-377"/>
<text text-anchor="middle" x="11480" y="-361.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 2</text>
<text text-anchor="middle" x="11480" y="-346.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="11480" y="-331.8" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_4_2_0&#45;&gt;expert_agg_4_2 -->
<g id="edge444" class="edge">
<title>expert_4_2_0&#45;&gt;expert_agg_4_2</title>
<path fill="none" stroke="black" d="M11480,-463.84C11480,-463.84 11480,-387.06 11480,-387.06"/>
<polygon fill="black" stroke="black" points="11483.5,-387.06 11480,-377.06 11476.5,-387.06 11483.5,-387.06"/>
</g>
<!-- expert_agg_4_2&#45;&gt;layer_norm_4 -->
<g id="edge445" class="edge">
<title>expert_agg_4_2&#45;&gt;layer_norm_4</title>
<path fill="none" stroke="black" d="M11480,-324C11480,-278.41 11480,-190 11480,-190 11480,-190 10309.77,-190 10309.77,-190"/>
<polygon fill="black" stroke="black" points="10309.77,-186.5 10299.77,-190 10309.77,-193.5 10309.77,-186.5"/>
</g>
<!-- expert_4_2_1 -->
<g id="node456" class="node">
<title>expert_4_2_1</title>
<polygon fill="#ffff99" stroke="black" points="6384.5,-1359.5 6289.5,-1359.5 6289.5,-1306.5 6384.5,-1306.5 6384.5,-1359.5"/>
<text text-anchor="middle" x="6337" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="6337" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="6337" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_4_2_2 -->
<g id="node457" class="node">
<title>expert_4_2_2</title>
<polygon fill="#ffff99" stroke="black" points="6231.5,-1359.5 6136.5,-1359.5 6136.5,-1306.5 6231.5,-1306.5 6231.5,-1359.5"/>
<text text-anchor="middle" x="6184" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="6184" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="6184" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_4_2_3 -->
<g id="node458" class="node">
<title>expert_4_2_3</title>
<polygon fill="#ffff99" stroke="black" points="6078.5,-1359.5 5983.5,-1359.5 5983.5,-1306.5 6078.5,-1306.5 6078.5,-1359.5"/>
<text text-anchor="middle" x="6031" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6031" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="6031" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_gate_4_3 -->
<g id="node459" class="node">
<title>expert_gate_4_3</title>
<polygon fill="#ccff99" stroke="black" points="11309.5,-657 11192.5,-657 11192.5,-604 11309.5,-604 11309.5,-657"/>
<text text-anchor="middle" x="11251" y="-641.8" font-family="Times,serif" font-size="14.00">Expert Gate 3</text>
<text text-anchor="middle" x="11251" y="-626.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="11251" y="-611.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_4_3_0 -->
<g id="node460" class="node">
<title>expert_4_3_0</title>
<polygon fill="#ccff99" stroke="black" points="11298.5,-517 11203.5,-517 11203.5,-464 11298.5,-464 11298.5,-517"/>
<text text-anchor="middle" x="11251" y="-501.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="11251" y="-486.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="11251" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_gate_4_3&#45;&gt;expert_4_3_0 -->
<g id="edge446" class="edge">
<title>expert_gate_4_3&#45;&gt;expert_4_3_0</title>
<path fill="none" stroke="black" d="M11251,-603.84C11251,-603.84 11251,-527.06 11251,-527.06"/>
<polygon fill="black" stroke="black" points="11254.5,-527.06 11251,-517.06 11247.5,-527.06 11254.5,-527.06"/>
</g>
<!-- expert_agg_4_3 -->
<g id="node461" class="node">
<title>expert_agg_4_3</title>
<polygon fill="#ccff99" stroke="black" points="11336.5,-377 11165.5,-377 11165.5,-324 11336.5,-324 11336.5,-377"/>
<text text-anchor="middle" x="11251" y="-361.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 3</text>
<text text-anchor="middle" x="11251" y="-346.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="11251" y="-331.8" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_4_3_0&#45;&gt;expert_agg_4_3 -->
<g id="edge447" class="edge">
<title>expert_4_3_0&#45;&gt;expert_agg_4_3</title>
<path fill="none" stroke="black" d="M11251,-463.84C11251,-463.84 11251,-387.06 11251,-387.06"/>
<polygon fill="black" stroke="black" points="11254.5,-387.06 11251,-377.06 11247.5,-387.06 11254.5,-387.06"/>
</g>
<!-- expert_agg_4_3&#45;&gt;layer_norm_4 -->
<g id="edge448" class="edge">
<title>expert_agg_4_3&#45;&gt;layer_norm_4</title>
<path fill="none" stroke="black" d="M11251,-323.76C11251,-280.27 11251,-199 11251,-199 11251,-199 10312.19,-199 10312.19,-199"/>
<polygon fill="black" stroke="black" points="10312.19,-195.5 10302.19,-199 10312.19,-202.5 10312.19,-195.5"/>
</g>
<!-- expert_4_3_1 -->
<g id="node462" class="node">
<title>expert_4_3_1</title>
<polygon fill="#ccff99" stroke="black" points="5925.5,-1359.5 5830.5,-1359.5 5830.5,-1306.5 5925.5,-1306.5 5925.5,-1359.5"/>
<text text-anchor="middle" x="5878" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="5878" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="5878" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_4_3_2 -->
<g id="node463" class="node">
<title>expert_4_3_2</title>
<polygon fill="#ccff99" stroke="black" points="5772.5,-1359.5 5677.5,-1359.5 5677.5,-1306.5 5772.5,-1306.5 5772.5,-1359.5"/>
<text text-anchor="middle" x="5725" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="5725" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="5725" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_4_3_3 -->
<g id="node464" class="node">
<title>expert_4_3_3</title>
<polygon fill="#ccff99" stroke="black" points="5619.5,-1359.5 5524.5,-1359.5 5524.5,-1306.5 5619.5,-1306.5 5619.5,-1359.5"/>
<text text-anchor="middle" x="5572" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="5572" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="5572" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_gate_4_4 -->
<g id="node465" class="node">
<title>expert_gate_4_4</title>
<polygon fill="#99ff99" stroke="black" points="11080.5,-657 10963.5,-657 10963.5,-604 11080.5,-604 11080.5,-657"/>
<text text-anchor="middle" x="11022" y="-641.8" font-family="Times,serif" font-size="14.00">Expert Gate 4</text>
<text text-anchor="middle" x="11022" y="-626.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="11022" y="-611.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_4_4_0 -->
<g id="node466" class="node">
<title>expert_4_4_0</title>
<polygon fill="#99ff99" stroke="black" points="11069.5,-517 10974.5,-517 10974.5,-464 11069.5,-464 11069.5,-517"/>
<text text-anchor="middle" x="11022" y="-501.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="11022" y="-486.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="11022" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_gate_4_4&#45;&gt;expert_4_4_0 -->
<g id="edge449" class="edge">
<title>expert_gate_4_4&#45;&gt;expert_4_4_0</title>
<path fill="none" stroke="black" d="M11022,-603.84C11022,-603.84 11022,-527.06 11022,-527.06"/>
<polygon fill="black" stroke="black" points="11025.5,-527.06 11022,-517.06 11018.5,-527.06 11025.5,-527.06"/>
</g>
<!-- expert_agg_4_4 -->
<g id="node467" class="node">
<title>expert_agg_4_4</title>
<polygon fill="#99ff99" stroke="black" points="11107.5,-377 10936.5,-377 10936.5,-324 11107.5,-324 11107.5,-377"/>
<text text-anchor="middle" x="11022" y="-361.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 4</text>
<text text-anchor="middle" x="11022" y="-346.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="11022" y="-331.8" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_4_4_0&#45;&gt;expert_agg_4_4 -->
<g id="edge450" class="edge">
<title>expert_4_4_0&#45;&gt;expert_agg_4_4</title>
<path fill="none" stroke="black" d="M11022,-463.84C11022,-463.84 11022,-387.06 11022,-387.06"/>
<polygon fill="black" stroke="black" points="11025.5,-387.06 11022,-377.06 11018.5,-387.06 11025.5,-387.06"/>
</g>
<!-- expert_agg_4_4&#45;&gt;layer_norm_4 -->
<g id="edge451" class="edge">
<title>expert_agg_4_4&#45;&gt;layer_norm_4</title>
<path fill="none" stroke="black" d="M11022,-323.7C11022,-282.42 11022,-208 11022,-208 11022,-208 10310.2,-208 10310.2,-208"/>
<polygon fill="black" stroke="black" points="10310.2,-204.5 10300.2,-208 10310.2,-211.5 10310.2,-204.5"/>
</g>
<!-- expert_4_4_1 -->
<g id="node468" class="node">
<title>expert_4_4_1</title>
<polygon fill="#99ff99" stroke="black" points="5466.5,-1359.5 5371.5,-1359.5 5371.5,-1306.5 5466.5,-1306.5 5466.5,-1359.5"/>
<text text-anchor="middle" x="5419" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="5419" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="5419" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_4_4_2 -->
<g id="node469" class="node">
<title>expert_4_4_2</title>
<polygon fill="#99ff99" stroke="black" points="5313.5,-1359.5 5218.5,-1359.5 5218.5,-1306.5 5313.5,-1306.5 5313.5,-1359.5"/>
<text text-anchor="middle" x="5266" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="5266" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="5266" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_4_4_3 -->
<g id="node470" class="node">
<title>expert_4_4_3</title>
<polygon fill="#99ff99" stroke="black" points="5160.5,-1359.5 5065.5,-1359.5 5065.5,-1306.5 5160.5,-1306.5 5160.5,-1359.5"/>
<text text-anchor="middle" x="5113" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="5113" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="5113" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_gate_4_5 -->
<g id="node471" class="node">
<title>expert_gate_4_5</title>
<polygon fill="#99ffcc" stroke="black" points="10851.5,-657 10734.5,-657 10734.5,-604 10851.5,-604 10851.5,-657"/>
<text text-anchor="middle" x="10793" y="-641.8" font-family="Times,serif" font-size="14.00">Expert Gate 5</text>
<text text-anchor="middle" x="10793" y="-626.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="10793" y="-611.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_4_5_0 -->
<g id="node472" class="node">
<title>expert_4_5_0</title>
<polygon fill="#99ffcc" stroke="black" points="10840.5,-517 10745.5,-517 10745.5,-464 10840.5,-464 10840.5,-517"/>
<text text-anchor="middle" x="10793" y="-501.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="10793" y="-486.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="10793" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_gate_4_5&#45;&gt;expert_4_5_0 -->
<g id="edge452" class="edge">
<title>expert_gate_4_5&#45;&gt;expert_4_5_0</title>
<path fill="none" stroke="black" d="M10793,-603.84C10793,-603.84 10793,-527.06 10793,-527.06"/>
<polygon fill="black" stroke="black" points="10796.5,-527.06 10793,-517.06 10789.5,-527.06 10796.5,-527.06"/>
</g>
<!-- expert_agg_4_5 -->
<g id="node473" class="node">
<title>expert_agg_4_5</title>
<polygon fill="#99ffcc" stroke="black" points="10878.5,-377 10707.5,-377 10707.5,-324 10878.5,-324 10878.5,-377"/>
<text text-anchor="middle" x="10793" y="-361.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 5</text>
<text text-anchor="middle" x="10793" y="-346.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="10793" y="-331.8" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_4_5_0&#45;&gt;expert_agg_4_5 -->
<g id="edge453" class="edge">
<title>expert_4_5_0&#45;&gt;expert_agg_4_5</title>
<path fill="none" stroke="black" d="M10793,-463.84C10793,-463.84 10793,-387.06 10793,-387.06"/>
<polygon fill="black" stroke="black" points="10796.5,-387.06 10793,-377.06 10789.5,-387.06 10796.5,-387.06"/>
</g>
<!-- expert_agg_4_5&#45;&gt;layer_norm_4 -->
<g id="edge454" class="edge">
<title>expert_agg_4_5&#45;&gt;layer_norm_4</title>
<path fill="none" stroke="black" d="M10793,-323.69C10793,-284.97 10793,-218 10793,-218 10793,-218 10301.41,-218 10301.41,-218"/>
<polygon fill="black" stroke="black" points="10301.41,-214.5 10291.41,-218 10301.41,-221.5 10301.41,-214.5"/>
</g>
<!-- expert_4_5_1 -->
<g id="node474" class="node">
<title>expert_4_5_1</title>
<polygon fill="#99ffcc" stroke="black" points="5007.5,-1359.5 4912.5,-1359.5 4912.5,-1306.5 5007.5,-1306.5 5007.5,-1359.5"/>
<text text-anchor="middle" x="4960" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4960" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="4960" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_4_5_2 -->
<g id="node475" class="node">
<title>expert_4_5_2</title>
<polygon fill="#99ffcc" stroke="black" points="4854.5,-1359.5 4759.5,-1359.5 4759.5,-1306.5 4854.5,-1306.5 4854.5,-1359.5"/>
<text text-anchor="middle" x="4807" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4807" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="4807" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_4_5_3 -->
<g id="node476" class="node">
<title>expert_4_5_3</title>
<polygon fill="#99ffcc" stroke="black" points="4701.5,-1359.5 4606.5,-1359.5 4606.5,-1306.5 4701.5,-1306.5 4701.5,-1359.5"/>
<text text-anchor="middle" x="4654" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4654" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="4654" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_gate_4_6 -->
<g id="node477" class="node">
<title>expert_gate_4_6</title>
<polygon fill="#99ffff" stroke="black" points="10622.5,-657 10505.5,-657 10505.5,-604 10622.5,-604 10622.5,-657"/>
<text text-anchor="middle" x="10564" y="-641.8" font-family="Times,serif" font-size="14.00">Expert Gate 6</text>
<text text-anchor="middle" x="10564" y="-626.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="10564" y="-611.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_4_6_0 -->
<g id="node478" class="node">
<title>expert_4_6_0</title>
<polygon fill="#99ffff" stroke="black" points="10611.5,-517 10516.5,-517 10516.5,-464 10611.5,-464 10611.5,-517"/>
<text text-anchor="middle" x="10564" y="-501.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="10564" y="-486.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="10564" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_gate_4_6&#45;&gt;expert_4_6_0 -->
<g id="edge455" class="edge">
<title>expert_gate_4_6&#45;&gt;expert_4_6_0</title>
<path fill="none" stroke="black" d="M10564,-603.84C10564,-603.84 10564,-527.06 10564,-527.06"/>
<polygon fill="black" stroke="black" points="10567.5,-527.06 10564,-517.06 10560.5,-527.06 10567.5,-527.06"/>
</g>
<!-- expert_agg_4_6 -->
<g id="node479" class="node">
<title>expert_agg_4_6</title>
<polygon fill="#99ffff" stroke="black" points="10649.5,-377 10478.5,-377 10478.5,-324 10649.5,-324 10649.5,-377"/>
<text text-anchor="middle" x="10564" y="-361.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 6</text>
<text text-anchor="middle" x="10564" y="-346.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="10564" y="-331.8" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_4_6_0&#45;&gt;expert_agg_4_6 -->
<g id="edge456" class="edge">
<title>expert_4_6_0&#45;&gt;expert_agg_4_6</title>
<path fill="none" stroke="black" d="M10564,-463.84C10564,-463.84 10564,-387.06 10564,-387.06"/>
<polygon fill="black" stroke="black" points="10567.5,-387.06 10564,-377.06 10560.5,-387.06 10567.5,-387.06"/>
</g>
<!-- expert_agg_4_6&#45;&gt;layer_norm_4 -->
<g id="edge457" class="edge">
<title>expert_agg_4_6&#45;&gt;layer_norm_4</title>
<path fill="none" stroke="black" d="M10564,-323.7C10564,-287.38 10564,-227 10564,-227 10564,-227 10286.04,-227 10286.04,-227"/>
<polygon fill="black" stroke="black" points="10286.04,-223.5 10276.04,-227 10286.04,-230.5 10286.04,-223.5"/>
</g>
<!-- expert_4_6_1 -->
<g id="node480" class="node">
<title>expert_4_6_1</title>
<polygon fill="#99ffff" stroke="black" points="4548.5,-1359.5 4453.5,-1359.5 4453.5,-1306.5 4548.5,-1306.5 4548.5,-1359.5"/>
<text text-anchor="middle" x="4501" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4501" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="4501" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_4_6_2 -->
<g id="node481" class="node">
<title>expert_4_6_2</title>
<polygon fill="#99ffff" stroke="black" points="4395.5,-1359.5 4300.5,-1359.5 4300.5,-1306.5 4395.5,-1306.5 4395.5,-1359.5"/>
<text text-anchor="middle" x="4348" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4348" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="4348" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_4_6_3 -->
<g id="node482" class="node">
<title>expert_4_6_3</title>
<polygon fill="#99ffff" stroke="black" points="4242.5,-1359.5 4147.5,-1359.5 4147.5,-1306.5 4242.5,-1306.5 4242.5,-1359.5"/>
<text text-anchor="middle" x="4195" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4195" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="4195" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_gate_4_7 -->
<g id="node483" class="node">
<title>expert_gate_4_7</title>
<polygon fill="#99ccff" stroke="black" points="10393.5,-657 10276.5,-657 10276.5,-604 10393.5,-604 10393.5,-657"/>
<text text-anchor="middle" x="10335" y="-641.8" font-family="Times,serif" font-size="14.00">Expert Gate 7</text>
<text text-anchor="middle" x="10335" y="-626.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="10335" y="-611.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_4_7_0 -->
<g id="node484" class="node">
<title>expert_4_7_0</title>
<polygon fill="#99ccff" stroke="black" points="10382.5,-517 10287.5,-517 10287.5,-464 10382.5,-464 10382.5,-517"/>
<text text-anchor="middle" x="10335" y="-501.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="10335" y="-486.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="10335" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_gate_4_7&#45;&gt;expert_4_7_0 -->
<g id="edge458" class="edge">
<title>expert_gate_4_7&#45;&gt;expert_4_7_0</title>
<path fill="none" stroke="black" d="M10335,-603.84C10335,-603.84 10335,-527.06 10335,-527.06"/>
<polygon fill="black" stroke="black" points="10338.5,-527.06 10335,-517.06 10331.5,-527.06 10338.5,-527.06"/>
</g>
<!-- expert_agg_4_7 -->
<g id="node485" class="node">
<title>expert_agg_4_7</title>
<polygon fill="#99ccff" stroke="black" points="10420.5,-377 10249.5,-377 10249.5,-324 10420.5,-324 10420.5,-377"/>
<text text-anchor="middle" x="10335" y="-361.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 7</text>
<text text-anchor="middle" x="10335" y="-346.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="10335" y="-331.8" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_4_7_0&#45;&gt;expert_agg_4_7 -->
<g id="edge459" class="edge">
<title>expert_4_7_0&#45;&gt;expert_agg_4_7</title>
<path fill="none" stroke="black" d="M10335,-463.84C10335,-463.84 10335,-387.06 10335,-387.06"/>
<polygon fill="black" stroke="black" points="10338.5,-387.06 10335,-377.06 10331.5,-387.06 10338.5,-387.06"/>
</g>
<!-- expert_agg_4_7&#45;&gt;layer_norm_4 -->
<g id="edge460" class="edge">
<title>expert_agg_4_7&#45;&gt;layer_norm_4</title>
<path fill="none" stroke="black" d="M10275.75,-323.85C10275.75,-323.85 10275.75,-237.16 10275.75,-237.16"/>
<polygon fill="black" stroke="black" points="10279.25,-237.16 10275.75,-227.16 10272.25,-237.16 10279.25,-237.16"/>
</g>
<!-- expert_4_7_1 -->
<g id="node486" class="node">
<title>expert_4_7_1</title>
<polygon fill="#99ccff" stroke="black" points="4089.5,-1359.5 3994.5,-1359.5 3994.5,-1306.5 4089.5,-1306.5 4089.5,-1359.5"/>
<text text-anchor="middle" x="4042" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4042" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="4042" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_4_7_2 -->
<g id="node487" class="node">
<title>expert_4_7_2</title>
<polygon fill="#99ccff" stroke="black" points="3936.5,-1359.5 3841.5,-1359.5 3841.5,-1306.5 3936.5,-1306.5 3936.5,-1359.5"/>
<text text-anchor="middle" x="3889" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3889" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="3889" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_4_7_3 -->
<g id="node488" class="node">
<title>expert_4_7_3</title>
<polygon fill="#99ccff" stroke="black" points="3783.5,-1359.5 3688.5,-1359.5 3688.5,-1306.5 3783.5,-1306.5 3783.5,-1359.5"/>
<text text-anchor="middle" x="3736" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3736" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="3736" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_gate_4_8 -->
<g id="node489" class="node">
<title>expert_gate_4_8</title>
<polygon fill="#9999ff" stroke="black" points="10164.5,-657 10047.5,-657 10047.5,-604 10164.5,-604 10164.5,-657"/>
<text text-anchor="middle" x="10106" y="-641.8" font-family="Times,serif" font-size="14.00">Expert Gate 8</text>
<text text-anchor="middle" x="10106" y="-626.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="10106" y="-611.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_4_8_0 -->
<g id="node490" class="node">
<title>expert_4_8_0</title>
<polygon fill="#9999ff" stroke="black" points="10153.5,-517 10058.5,-517 10058.5,-464 10153.5,-464 10153.5,-517"/>
<text text-anchor="middle" x="10106" y="-501.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="10106" y="-486.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="10106" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_gate_4_8&#45;&gt;expert_4_8_0 -->
<g id="edge461" class="edge">
<title>expert_gate_4_8&#45;&gt;expert_4_8_0</title>
<path fill="none" stroke="black" d="M10106,-603.84C10106,-603.84 10106,-527.06 10106,-527.06"/>
<polygon fill="black" stroke="black" points="10109.5,-527.06 10106,-517.06 10102.5,-527.06 10109.5,-527.06"/>
</g>
<!-- expert_agg_4_8 -->
<g id="node491" class="node">
<title>expert_agg_4_8</title>
<polygon fill="#9999ff" stroke="black" points="10191.5,-377 10020.5,-377 10020.5,-324 10191.5,-324 10191.5,-377"/>
<text text-anchor="middle" x="10106" y="-361.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 8</text>
<text text-anchor="middle" x="10106" y="-346.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="10106" y="-331.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_4_8_0&#45;&gt;expert_agg_4_8 -->
<g id="edge462" class="edge">
<title>expert_4_8_0&#45;&gt;expert_agg_4_8</title>
<path fill="none" stroke="black" d="M10106,-463.84C10106,-463.84 10106,-387.06 10106,-387.06"/>
<polygon fill="black" stroke="black" points="10109.5,-387.06 10106,-377.06 10102.5,-387.06 10109.5,-387.06"/>
</g>
<!-- expert_agg_4_8&#45;&gt;layer_norm_4 -->
<g id="edge463" class="edge">
<title>expert_agg_4_8&#45;&gt;layer_norm_4</title>
<path fill="none" stroke="black" d="M10164.75,-323.85C10164.75,-323.85 10164.75,-237.42 10164.75,-237.42"/>
<polygon fill="black" stroke="black" points="10168.25,-237.42 10164.75,-227.42 10161.25,-237.42 10168.25,-237.42"/>
</g>
<!-- expert_4_8_1 -->
<g id="node492" class="node">
<title>expert_4_8_1</title>
<polygon fill="#9999ff" stroke="black" points="3630.5,-1359.5 3535.5,-1359.5 3535.5,-1306.5 3630.5,-1306.5 3630.5,-1359.5"/>
<text text-anchor="middle" x="3583" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3583" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="3583" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_4_8_2 -->
<g id="node493" class="node">
<title>expert_4_8_2</title>
<polygon fill="#9999ff" stroke="black" points="3477.5,-1359.5 3382.5,-1359.5 3382.5,-1306.5 3477.5,-1306.5 3477.5,-1359.5"/>
<text text-anchor="middle" x="3430" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3430" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="3430" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_4_8_3 -->
<g id="node494" class="node">
<title>expert_4_8_3</title>
<polygon fill="#9999ff" stroke="black" points="3324.5,-1359.5 3229.5,-1359.5 3229.5,-1306.5 3324.5,-1306.5 3324.5,-1359.5"/>
<text text-anchor="middle" x="3277" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3277" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="3277" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_gate_4_9 -->
<g id="node495" class="node">
<title>expert_gate_4_9</title>
<polygon fill="#cc99ff" stroke="black" points="9935.5,-657 9818.5,-657 9818.5,-604 9935.5,-604 9935.5,-657"/>
<text text-anchor="middle" x="9877" y="-641.8" font-family="Times,serif" font-size="14.00">Expert Gate 9</text>
<text text-anchor="middle" x="9877" y="-626.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="9877" y="-611.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_4_9_0 -->
<g id="node496" class="node">
<title>expert_4_9_0</title>
<polygon fill="#cc99ff" stroke="black" points="9924.5,-517 9829.5,-517 9829.5,-464 9924.5,-464 9924.5,-517"/>
<text text-anchor="middle" x="9877" y="-501.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="9877" y="-486.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="9877" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_gate_4_9&#45;&gt;expert_4_9_0 -->
<g id="edge464" class="edge">
<title>expert_gate_4_9&#45;&gt;expert_4_9_0</title>
<path fill="none" stroke="black" d="M9877,-603.84C9877,-603.84 9877,-527.06 9877,-527.06"/>
<polygon fill="black" stroke="black" points="9880.5,-527.06 9877,-517.06 9873.5,-527.06 9880.5,-527.06"/>
</g>
<!-- expert_agg_4_9 -->
<g id="node497" class="node">
<title>expert_agg_4_9</title>
<polygon fill="#cc99ff" stroke="black" points="9962.5,-377 9791.5,-377 9791.5,-324 9962.5,-324 9962.5,-377"/>
<text text-anchor="middle" x="9877" y="-361.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 9</text>
<text text-anchor="middle" x="9877" y="-346.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="9877" y="-331.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_4_9_0&#45;&gt;expert_agg_4_9 -->
<g id="edge465" class="edge">
<title>expert_4_9_0&#45;&gt;expert_agg_4_9</title>
<path fill="none" stroke="black" d="M9877,-463.84C9877,-463.84 9877,-387.06 9877,-387.06"/>
<polygon fill="black" stroke="black" points="9880.5,-387.06 9877,-377.06 9873.5,-387.06 9880.5,-387.06"/>
</g>
<!-- expert_agg_4_9&#45;&gt;layer_norm_4 -->
<g id="edge466" class="edge">
<title>expert_agg_4_9&#45;&gt;layer_norm_4</title>
<path fill="none" stroke="black" d="M9877,-323.7C9877,-287.38 9877,-227 9877,-227 9877,-227 10154.13,-227 10154.13,-227"/>
<polygon fill="black" stroke="black" points="10154.13,-230.5 10164.13,-227 10154.13,-223.5 10154.13,-230.5"/>
</g>
<!-- expert_4_9_1 -->
<g id="node498" class="node">
<title>expert_4_9_1</title>
<polygon fill="#cc99ff" stroke="black" points="3171.5,-1359.5 3076.5,-1359.5 3076.5,-1306.5 3171.5,-1306.5 3171.5,-1359.5"/>
<text text-anchor="middle" x="3124" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3124" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="3124" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_4_9_2 -->
<g id="node499" class="node">
<title>expert_4_9_2</title>
<polygon fill="#cc99ff" stroke="black" points="3018.5,-1359.5 2923.5,-1359.5 2923.5,-1306.5 3018.5,-1306.5 3018.5,-1359.5"/>
<text text-anchor="middle" x="2971" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2971" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="2971" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_4_9_3 -->
<g id="node500" class="node">
<title>expert_4_9_3</title>
<polygon fill="#cc99ff" stroke="black" points="2865.5,-1359.5 2770.5,-1359.5 2770.5,-1306.5 2865.5,-1306.5 2865.5,-1359.5"/>
<text text-anchor="middle" x="2818" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2818" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="2818" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_gate_4_10 -->
<g id="node501" class="node">
<title>expert_gate_4_10</title>
<polygon fill="#ff99ff" stroke="black" points="9706,-657 9580,-657 9580,-604 9706,-604 9706,-657"/>
<text text-anchor="middle" x="9643" y="-641.8" font-family="Times,serif" font-size="14.00">Expert Gate 10</text>
<text text-anchor="middle" x="9643" y="-626.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="9643" y="-611.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_4_10_0 -->
<g id="node502" class="node">
<title>expert_4_10_0</title>
<polygon fill="#ff99ff" stroke="black" points="9690.5,-517 9595.5,-517 9595.5,-464 9690.5,-464 9690.5,-517"/>
<text text-anchor="middle" x="9643" y="-501.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="9643" y="-486.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="9643" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_gate_4_10&#45;&gt;expert_4_10_0 -->
<g id="edge467" class="edge">
<title>expert_gate_4_10&#45;&gt;expert_4_10_0</title>
<path fill="none" stroke="black" d="M9643,-603.84C9643,-603.84 9643,-527.06 9643,-527.06"/>
<polygon fill="black" stroke="black" points="9646.5,-527.06 9643,-517.06 9639.5,-527.06 9646.5,-527.06"/>
</g>
<!-- expert_agg_4_10 -->
<g id="node503" class="node">
<title>expert_agg_4_10</title>
<polygon fill="#ff99ff" stroke="black" points="9733,-377 9553,-377 9553,-324 9733,-324 9733,-377"/>
<text text-anchor="middle" x="9643" y="-361.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 10</text>
<text text-anchor="middle" x="9643" y="-346.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="9643" y="-331.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_4_10_0&#45;&gt;expert_agg_4_10 -->
<g id="edge468" class="edge">
<title>expert_4_10_0&#45;&gt;expert_agg_4_10</title>
<path fill="none" stroke="black" d="M9643,-463.84C9643,-463.84 9643,-387.06 9643,-387.06"/>
<polygon fill="black" stroke="black" points="9646.5,-387.06 9643,-377.06 9639.5,-387.06 9646.5,-387.06"/>
</g>
<!-- expert_agg_4_10&#45;&gt;layer_norm_4 -->
<g id="edge469" class="edge">
<title>expert_agg_4_10&#45;&gt;layer_norm_4</title>
<path fill="none" stroke="black" d="M9643,-323.69C9643,-284.97 9643,-218 9643,-218 9643,-218 10138.67,-218 10138.67,-218"/>
<polygon fill="black" stroke="black" points="10138.67,-221.5 10148.67,-218 10138.67,-214.5 10138.67,-221.5"/>
</g>
<!-- expert_4_10_1 -->
<g id="node504" class="node">
<title>expert_4_10_1</title>
<polygon fill="#ff99ff" stroke="black" points="2712.5,-1359.5 2617.5,-1359.5 2617.5,-1306.5 2712.5,-1306.5 2712.5,-1359.5"/>
<text text-anchor="middle" x="2665" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2665" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="2665" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_4_10_2 -->
<g id="node505" class="node">
<title>expert_4_10_2</title>
<polygon fill="#ff99ff" stroke="black" points="2559.5,-1359.5 2464.5,-1359.5 2464.5,-1306.5 2559.5,-1306.5 2559.5,-1359.5"/>
<text text-anchor="middle" x="2512" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2512" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="2512" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_4_10_3 -->
<g id="node506" class="node">
<title>expert_4_10_3</title>
<polygon fill="#ff99ff" stroke="black" points="2406.5,-1359.5 2311.5,-1359.5 2311.5,-1306.5 2406.5,-1306.5 2406.5,-1359.5"/>
<text text-anchor="middle" x="2359" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2359" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="2359" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_gate_4_11 -->
<g id="node507" class="node">
<title>expert_gate_4_11</title>
<polygon fill="#ff99cc" stroke="black" points="9468,-657 9342,-657 9342,-604 9468,-604 9468,-657"/>
<text text-anchor="middle" x="9405" y="-641.8" font-family="Times,serif" font-size="14.00">Expert Gate 11</text>
<text text-anchor="middle" x="9405" y="-626.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="9405" y="-611.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_4_11_0 -->
<g id="node508" class="node">
<title>expert_4_11_0</title>
<polygon fill="#ff99cc" stroke="black" points="9452.5,-517 9357.5,-517 9357.5,-464 9452.5,-464 9452.5,-517"/>
<text text-anchor="middle" x="9405" y="-501.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="9405" y="-486.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="9405" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_gate_4_11&#45;&gt;expert_4_11_0 -->
<g id="edge470" class="edge">
<title>expert_gate_4_11&#45;&gt;expert_4_11_0</title>
<path fill="none" stroke="black" d="M9405,-603.84C9405,-603.84 9405,-527.06 9405,-527.06"/>
<polygon fill="black" stroke="black" points="9408.5,-527.06 9405,-517.06 9401.5,-527.06 9408.5,-527.06"/>
</g>
<!-- expert_agg_4_11 -->
<g id="node509" class="node">
<title>expert_agg_4_11</title>
<polygon fill="#ff99cc" stroke="black" points="9495,-377 9315,-377 9315,-324 9495,-324 9495,-377"/>
<text text-anchor="middle" x="9405" y="-361.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 11</text>
<text text-anchor="middle" x="9405" y="-346.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="9405" y="-331.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_4_11_0&#45;&gt;expert_agg_4_11 -->
<g id="edge471" class="edge">
<title>expert_4_11_0&#45;&gt;expert_agg_4_11</title>
<path fill="none" stroke="black" d="M9405,-463.84C9405,-463.84 9405,-387.06 9405,-387.06"/>
<polygon fill="black" stroke="black" points="9408.5,-387.06 9405,-377.06 9401.5,-387.06 9408.5,-387.06"/>
</g>
<!-- expert_agg_4_11&#45;&gt;layer_norm_4 -->
<g id="edge472" class="edge">
<title>expert_agg_4_11&#45;&gt;layer_norm_4</title>
<path fill="none" stroke="black" d="M9405,-323.7C9405,-282.42 9405,-208 9405,-208 9405,-208 10130,-208 10130,-208"/>
<polygon fill="black" stroke="black" points="10130,-211.5 10140,-208 10130,-204.5 10130,-211.5"/>
</g>
<!-- expert_4_11_1 -->
<g id="node510" class="node">
<title>expert_4_11_1</title>
<polygon fill="#ff99cc" stroke="black" points="2253.5,-1359.5 2158.5,-1359.5 2158.5,-1306.5 2253.5,-1306.5 2253.5,-1359.5"/>
<text text-anchor="middle" x="2206" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2206" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="2206" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_4_11_2 -->
<g id="node511" class="node">
<title>expert_4_11_2</title>
<polygon fill="#ff99cc" stroke="black" points="2100.5,-1359.5 2005.5,-1359.5 2005.5,-1306.5 2100.5,-1306.5 2100.5,-1359.5"/>
<text text-anchor="middle" x="2053" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2053" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="2053" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_4_11_3 -->
<g id="node512" class="node">
<title>expert_4_11_3</title>
<polygon fill="#ff99cc" stroke="black" points="1947.5,-1359.5 1852.5,-1359.5 1852.5,-1306.5 1947.5,-1306.5 1947.5,-1359.5"/>
<text text-anchor="middle" x="1900" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1900" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="1900" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_gate_4_12 -->
<g id="node513" class="node">
<title>expert_gate_4_12</title>
<polygon fill="#ffb366" stroke="black" points="9230,-657 9104,-657 9104,-604 9230,-604 9230,-657"/>
<text text-anchor="middle" x="9167" y="-641.8" font-family="Times,serif" font-size="14.00">Expert Gate 12</text>
<text text-anchor="middle" x="9167" y="-626.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="9167" y="-611.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_4_12_0 -->
<g id="node514" class="node">
<title>expert_4_12_0</title>
<polygon fill="#ffb366" stroke="black" points="9214.5,-517 9119.5,-517 9119.5,-464 9214.5,-464 9214.5,-517"/>
<text text-anchor="middle" x="9167" y="-501.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="9167" y="-486.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="9167" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_gate_4_12&#45;&gt;expert_4_12_0 -->
<g id="edge473" class="edge">
<title>expert_gate_4_12&#45;&gt;expert_4_12_0</title>
<path fill="none" stroke="black" d="M9167,-603.84C9167,-603.84 9167,-527.06 9167,-527.06"/>
<polygon fill="black" stroke="black" points="9170.5,-527.06 9167,-517.06 9163.5,-527.06 9170.5,-527.06"/>
</g>
<!-- expert_agg_4_12 -->
<g id="node515" class="node">
<title>expert_agg_4_12</title>
<polygon fill="#ffb366" stroke="black" points="9257,-377 9077,-377 9077,-324 9257,-324 9257,-377"/>
<text text-anchor="middle" x="9167" y="-361.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 12</text>
<text text-anchor="middle" x="9167" y="-346.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="9167" y="-331.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_4_12_0&#45;&gt;expert_agg_4_12 -->
<g id="edge474" class="edge">
<title>expert_4_12_0&#45;&gt;expert_agg_4_12</title>
<path fill="none" stroke="black" d="M9167,-463.84C9167,-463.84 9167,-387.06 9167,-387.06"/>
<polygon fill="black" stroke="black" points="9170.5,-387.06 9167,-377.06 9163.5,-387.06 9170.5,-387.06"/>
</g>
<!-- expert_agg_4_12&#45;&gt;layer_norm_4 -->
<g id="edge475" class="edge">
<title>expert_agg_4_12&#45;&gt;layer_norm_4</title>
<path fill="none" stroke="black" d="M9167,-323.76C9167,-280.27 9167,-199 9167,-199 9167,-199 10127.81,-199 10127.81,-199"/>
<polygon fill="black" stroke="black" points="10127.81,-202.5 10137.81,-199 10127.81,-195.5 10127.81,-202.5"/>
</g>
<!-- expert_4_12_1 -->
<g id="node516" class="node">
<title>expert_4_12_1</title>
<polygon fill="#ffb366" stroke="black" points="1794.5,-1359.5 1699.5,-1359.5 1699.5,-1306.5 1794.5,-1306.5 1794.5,-1359.5"/>
<text text-anchor="middle" x="1747" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1747" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="1747" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_4_12_2 -->
<g id="node517" class="node">
<title>expert_4_12_2</title>
<polygon fill="#ffb366" stroke="black" points="1641.5,-1359.5 1546.5,-1359.5 1546.5,-1306.5 1641.5,-1306.5 1641.5,-1359.5"/>
<text text-anchor="middle" x="1594" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1594" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="1594" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_4_12_3 -->
<g id="node518" class="node">
<title>expert_4_12_3</title>
<polygon fill="#ffb366" stroke="black" points="1488.5,-1359.5 1393.5,-1359.5 1393.5,-1306.5 1488.5,-1306.5 1488.5,-1359.5"/>
<text text-anchor="middle" x="1441" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1441" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="1441" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_gate_4_13 -->
<g id="node519" class="node">
<title>expert_gate_4_13</title>
<polygon fill="#b3ff66" stroke="black" points="8992,-657 8866,-657 8866,-604 8992,-604 8992,-657"/>
<text text-anchor="middle" x="8929" y="-641.8" font-family="Times,serif" font-size="14.00">Expert Gate 13</text>
<text text-anchor="middle" x="8929" y="-626.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="8929" y="-611.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_4_13_0 -->
<g id="node520" class="node">
<title>expert_4_13_0</title>
<polygon fill="#b3ff66" stroke="black" points="8976.5,-517 8881.5,-517 8881.5,-464 8976.5,-464 8976.5,-517"/>
<text text-anchor="middle" x="8929" y="-501.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8929" y="-486.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="8929" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_gate_4_13&#45;&gt;expert_4_13_0 -->
<g id="edge476" class="edge">
<title>expert_gate_4_13&#45;&gt;expert_4_13_0</title>
<path fill="none" stroke="black" d="M8929,-603.84C8929,-603.84 8929,-527.06 8929,-527.06"/>
<polygon fill="black" stroke="black" points="8932.5,-527.06 8929,-517.06 8925.5,-527.06 8932.5,-527.06"/>
</g>
<!-- expert_agg_4_13 -->
<g id="node521" class="node">
<title>expert_agg_4_13</title>
<polygon fill="#b3ff66" stroke="black" points="9019,-377 8839,-377 8839,-324 9019,-324 9019,-377"/>
<text text-anchor="middle" x="8929" y="-361.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 13</text>
<text text-anchor="middle" x="8929" y="-346.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="8929" y="-331.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_4_13_0&#45;&gt;expert_agg_4_13 -->
<g id="edge477" class="edge">
<title>expert_4_13_0&#45;&gt;expert_agg_4_13</title>
<path fill="none" stroke="black" d="M8929,-463.84C8929,-463.84 8929,-387.06 8929,-387.06"/>
<polygon fill="black" stroke="black" points="8932.5,-387.06 8929,-377.06 8925.5,-387.06 8932.5,-387.06"/>
</g>
<!-- expert_agg_4_13&#45;&gt;layer_norm_4 -->
<g id="edge478" class="edge">
<title>expert_agg_4_13&#45;&gt;layer_norm_4</title>
<path fill="none" stroke="black" d="M8929,-324C8929,-278.41 8929,-190 8929,-190 8929,-190 10130.22,-190 10130.22,-190"/>
<polygon fill="black" stroke="black" points="10130.22,-193.5 10140.22,-190 10130.22,-186.5 10130.22,-193.5"/>
</g>
<!-- expert_4_13_1 -->
<g id="node522" class="node">
<title>expert_4_13_1</title>
<polygon fill="#b3ff66" stroke="black" points="1335.5,-1359.5 1240.5,-1359.5 1240.5,-1306.5 1335.5,-1306.5 1335.5,-1359.5"/>
<text text-anchor="middle" x="1288" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1288" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="1288" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_4_13_2 -->
<g id="node523" class="node">
<title>expert_4_13_2</title>
<polygon fill="#b3ff66" stroke="black" points="1182.5,-1359.5 1087.5,-1359.5 1087.5,-1306.5 1182.5,-1306.5 1182.5,-1359.5"/>
<text text-anchor="middle" x="1135" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1135" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="1135" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_4_13_3 -->
<g id="node524" class="node">
<title>expert_4_13_3</title>
<polygon fill="#b3ff66" stroke="black" points="1029.5,-1359.5 934.5,-1359.5 934.5,-1306.5 1029.5,-1306.5 1029.5,-1359.5"/>
<text text-anchor="middle" x="982" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="982" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="982" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_gate_4_14 -->
<g id="node525" class="node">
<title>expert_gate_4_14</title>
<polygon fill="#66ffb3" stroke="black" points="8754,-657 8628,-657 8628,-604 8754,-604 8754,-657"/>
<text text-anchor="middle" x="8691" y="-641.8" font-family="Times,serif" font-size="14.00">Expert Gate 14</text>
<text text-anchor="middle" x="8691" y="-626.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="8691" y="-611.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_4_14_0 -->
<g id="node526" class="node">
<title>expert_4_14_0</title>
<polygon fill="#66ffb3" stroke="black" points="8738.5,-517 8643.5,-517 8643.5,-464 8738.5,-464 8738.5,-517"/>
<text text-anchor="middle" x="8691" y="-501.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8691" y="-486.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="8691" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_gate_4_14&#45;&gt;expert_4_14_0 -->
<g id="edge479" class="edge">
<title>expert_gate_4_14&#45;&gt;expert_4_14_0</title>
<path fill="none" stroke="black" d="M8691,-603.84C8691,-603.84 8691,-527.06 8691,-527.06"/>
<polygon fill="black" stroke="black" points="8694.5,-527.06 8691,-517.06 8687.5,-527.06 8694.5,-527.06"/>
</g>
<!-- expert_agg_4_14 -->
<g id="node527" class="node">
<title>expert_agg_4_14</title>
<polygon fill="#66ffb3" stroke="black" points="8781,-377 8601,-377 8601,-324 8781,-324 8781,-377"/>
<text text-anchor="middle" x="8691" y="-361.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 14</text>
<text text-anchor="middle" x="8691" y="-346.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="8691" y="-331.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_4_14_0&#45;&gt;expert_agg_4_14 -->
<g id="edge480" class="edge">
<title>expert_4_14_0&#45;&gt;expert_agg_4_14</title>
<path fill="none" stroke="black" d="M8691,-463.84C8691,-463.84 8691,-387.06 8691,-387.06"/>
<polygon fill="black" stroke="black" points="8694.5,-387.06 8691,-377.06 8687.5,-387.06 8694.5,-387.06"/>
</g>
<!-- expert_agg_4_14&#45;&gt;layer_norm_4 -->
<g id="edge481" class="edge">
<title>expert_agg_4_14&#45;&gt;layer_norm_4</title>
<path fill="none" stroke="black" d="M8691,-323.86C8691,-275.91 8691,-180 8691,-180 8691,-180 10139.83,-180 10139.83,-180"/>
<polygon fill="black" stroke="black" points="10139.83,-183.5 10149.83,-180 10139.83,-176.5 10139.83,-183.5"/>
</g>
<!-- expert_4_14_1 -->
<g id="node528" class="node">
<title>expert_4_14_1</title>
<polygon fill="#66ffb3" stroke="black" points="876.5,-1359.5 781.5,-1359.5 781.5,-1306.5 876.5,-1306.5 876.5,-1359.5"/>
<text text-anchor="middle" x="829" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="829" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="829" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_4_14_2 -->
<g id="node529" class="node">
<title>expert_4_14_2</title>
<polygon fill="#66ffb3" stroke="black" points="723.5,-1359.5 628.5,-1359.5 628.5,-1306.5 723.5,-1306.5 723.5,-1359.5"/>
<text text-anchor="middle" x="676" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="676" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="676" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_4_14_3 -->
<g id="node530" class="node">
<title>expert_4_14_3</title>
<polygon fill="#66ffb3" stroke="black" points="570.5,-1359.5 475.5,-1359.5 475.5,-1306.5 570.5,-1306.5 570.5,-1359.5"/>
<text text-anchor="middle" x="523" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="523" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="523" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_gate_4_15 -->
<g id="node531" class="node">
<title>expert_gate_4_15</title>
<polygon fill="#66b3ff" stroke="black" points="8516,-657 8390,-657 8390,-604 8516,-604 8516,-657"/>
<text text-anchor="middle" x="8453" y="-641.8" font-family="Times,serif" font-size="14.00">Expert Gate 15</text>
<text text-anchor="middle" x="8453" y="-626.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="8453" y="-611.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_4_15_0 -->
<g id="node532" class="node">
<title>expert_4_15_0</title>
<polygon fill="#66b3ff" stroke="black" points="8500.5,-517 8405.5,-517 8405.5,-464 8500.5,-464 8500.5,-517"/>
<text text-anchor="middle" x="8453" y="-501.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8453" y="-486.8" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="8453" y="-471.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_gate_4_15&#45;&gt;expert_4_15_0 -->
<g id="edge482" class="edge">
<title>expert_gate_4_15&#45;&gt;expert_4_15_0</title>
<path fill="none" stroke="black" d="M8453,-603.84C8453,-603.84 8453,-527.06 8453,-527.06"/>
<polygon fill="black" stroke="black" points="8456.5,-527.06 8453,-517.06 8449.5,-527.06 8456.5,-527.06"/>
</g>
<!-- expert_agg_4_15 -->
<g id="node533" class="node">
<title>expert_agg_4_15</title>
<polygon fill="#66b3ff" stroke="black" points="8543,-377 8363,-377 8363,-324 8543,-324 8543,-377"/>
<text text-anchor="middle" x="8453" y="-361.8" font-family="Times,serif" font-size="14.00">Expert Aggregation 15</text>
<text text-anchor="middle" x="8453" y="-346.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="8453" y="-331.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_4_15_0&#45;&gt;expert_agg_4_15 -->
<g id="edge483" class="edge">
<title>expert_4_15_0&#45;&gt;expert_agg_4_15</title>
<path fill="none" stroke="black" d="M8453,-463.84C8453,-463.84 8453,-387.06 8453,-387.06"/>
<polygon fill="black" stroke="black" points="8456.5,-387.06 8453,-377.06 8449.5,-387.06 8456.5,-387.06"/>
</g>
<!-- expert_agg_4_15&#45;&gt;layer_norm_4 -->
<g id="edge484" class="edge">
<title>expert_agg_4_15&#45;&gt;layer_norm_4</title>
<path fill="none" stroke="black" d="M8453,-323.63C8453,-273.55 8453,-171 8453,-171 8453,-171 10156.64,-171 10156.64,-171"/>
<polygon fill="black" stroke="black" points="10156.64,-174.5 10166.64,-171 10156.64,-167.5 10156.64,-174.5"/>
</g>
<!-- expert_4_15_1 -->
<g id="node534" class="node">
<title>expert_4_15_1</title>
<polygon fill="#66b3ff" stroke="black" points="417.5,-1359.5 322.5,-1359.5 322.5,-1306.5 417.5,-1306.5 417.5,-1359.5"/>
<text text-anchor="middle" x="370" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="370" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="370" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_4_15_2 -->
<g id="node535" class="node">
<title>expert_4_15_2</title>
<polygon fill="#66b3ff" stroke="black" points="264.5,-1359.5 169.5,-1359.5 169.5,-1306.5 264.5,-1306.5 264.5,-1359.5"/>
<text text-anchor="middle" x="217" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="217" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="217" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_4_15_3 -->
<g id="node536" class="node">
<title>expert_4_15_3</title>
<polygon fill="#66b3ff" stroke="black" points="111.5,-1359.5 16.5,-1359.5 16.5,-1306.5 111.5,-1306.5 111.5,-1359.5"/>
<text text-anchor="middle" x="64" y="-1344.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="64" y="-1329.3" font-family="Times,serif" font-size="14.00">[B×L×D/4]</text>
<text text-anchor="middle" x="64" y="-1314.3" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- input_embed -->
<g id="node537" class="node">
<title>input_embed</title>
<ellipse fill="#e6e6e6" stroke="black" cx="33935" cy="-5087.5" rx="99.78" ry="37.5"/>
<text text-anchor="middle" x="33935" y="-5098.8" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="33935" y="-5083.8" font-family="Times,serif" font-size="14.00">[B×L×D]</text>
<text text-anchor="middle" x="33935" y="-5068.8" font-family="Times,serif" font-size="14.00">GPU: All</text>
</g>
<!-- input_embed&#45;&gt;q_proj_1_0_0 -->
<g id="edge485" class="edge">
<title>input_embed&#45;&gt;q_proj_1_0_0</title>
<path fill="none" stroke="black" d="M34029.22,-5100C34276.84,-5100 34927,-5100 34927,-5100 34927,-5100 34927,-4973.19 34927,-4973.19"/>
<polygon fill="black" stroke="black" points="34930.5,-4973.19 34927,-4963.19 34923.5,-4973.19 34930.5,-4973.19"/>
</g>
<!-- input_embed&#45;&gt;q_proj_1_0_1 -->
<g id="edge486" class="edge">
<title>input_embed&#45;&gt;q_proj_1_0_1</title>
<path fill="none" stroke="black" d="M34029.14,-5075C34151.85,-5075 34351,-5075 34351,-5075 34351,-5075 34351,-4973.23 34351,-4973.23"/>
<polygon fill="black" stroke="black" points="34354.5,-4973.23 34351,-4963.23 34347.5,-4973.23 34354.5,-4973.23"/>
</g>
<!-- input_embed&#45;&gt;q_proj_1_0_2 -->
<g id="edge487" class="edge">
<title>input_embed&#45;&gt;q_proj_1_0_2</title>
<path fill="none" stroke="black" d="M33870.88,-5058.71C33870.88,-5015.79 33870.88,-4940 33870.88,-4940 33870.88,-4940 33852.11,-4940 33852.11,-4940"/>
<polygon fill="black" stroke="black" points="33852.11,-4936.5 33842.11,-4940 33852.11,-4943.5 33852.11,-4936.5"/>
</g>
<!-- input_embed&#45;&gt;q_proj_1_0_3 -->
<g id="edge488" class="edge">
<title>input_embed&#45;&gt;q_proj_1_0_3</title>
<path fill="none" stroke="black" d="M33835.07,-5087C33731.01,-5087 33583,-5087 33583,-5087 33583,-5087 33583,-4973.28 33583,-4973.28"/>
<polygon fill="black" stroke="black" points="33586.5,-4973.28 33583,-4963.28 33579.5,-4973.28 33586.5,-4973.28"/>
</g>
</g>
</svg>
