<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="951pt"
 viewBox="0.00 0.00 1440.00 951.18" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.14 0.14) rotate(0) translate(4 6757)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-6757 10231.5,-6757 10231.5,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_legend</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7412.5,-6555 7412.5,-6745 8255.5,-6745 8255.5,-6555 7412.5,-6555"/>
<text text-anchor="middle" x="7834" y="-6729.8" font-family="Times,serif" font-size="14.00">Legend</text>
</g>
<!-- legend_input -->
<g id="node1" class="node">
<title>legend_input</title>
<ellipse fill="lightblue" stroke="black" cx="8171.5" cy="-6638.5" rx="75.5" ry="18"/>
<text text-anchor="middle" x="8171.5" y="-6634.8" font-family="monospace" font-size="14.00">Input/Output</text>
</g>
<!-- legend_compute -->
<g id="node2" class="node">
<title>legend_compute</title>
<polygon fill="white" stroke="black" points="8077.5,-6657.5 7945.5,-6657.5 7945.5,-6619.5 8077.5,-6619.5 8077.5,-6657.5"/>
<text text-anchor="middle" x="8011.5" y="-6642.3" font-family="monospace" font-size="14.00">Computation</text>
<text text-anchor="middle" x="8011.5" y="-6627.3" font-family="monospace" font-size="14.00">(GPU&#45;specific)</text>
</g>
<!-- legend_concat -->
<g id="node3" class="node">
<title>legend_concat</title>
<polygon fill="lightyellow" stroke="black" points="7813.5,-6656.5 7699.5,-6638.5 7813.5,-6620.5 7927.5,-6638.5 7813.5,-6656.5"/>
<text text-anchor="middle" x="7813.5" y="-6634.8" font-family="monospace" font-size="14.00">Concatenation</text>
</g>
<!-- legend_norm -->
<g id="node4" class="node">
<title>legend_norm</title>
<polygon fill="lightgray" stroke="black" points="7681,-6656.5 7590,-6656.5 7590,-6620.5 7681,-6620.5 7681,-6656.5"/>
<text text-anchor="middle" x="7635.5" y="-6634.8" font-family="monospace" font-size="14.00">LayerNorm</text>
</g>
<!-- legend_add -->
<g id="node5" class="node">
<title>legend_add</title>
<ellipse fill="lightgray" stroke="black" cx="7496.5" cy="-6638.5" rx="75.5" ry="75.5"/>
<text text-anchor="middle" x="7496.5" y="-6634.8" font-family="monospace" font-size="14.00">Add/Residual</text>
</g>
<!-- input -->
<g id="node6" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="8480.5" cy="-6638.5" rx="215.5" ry="27"/>
<text text-anchor="middle" x="8480.5" y="-6642.3" font-family="monospace" font-size="14.00">Input</text>
<text text-anchor="middle" x="8480.5" y="-6627.3" font-family="monospace" font-size="14.00">[Batch=1024, Seq=2048, Hidden=8192]</text>
</g>
<!-- ln1_0 -->
<g id="node7" class="node">
<title>ln1_0</title>
<polygon fill="lightgray" stroke="black" points="5180,-6526 5031,-6526 5031,-6488 5180,-6488 5180,-6526"/>
<text text-anchor="middle" x="5105.5" y="-6510.8" font-family="monospace" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5105.5" y="-6495.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- input&#45;&gt;ln1_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln1_0</title>
<path fill="none" stroke="black" d="M8428.38,-6612.23C8384.5,-6592.39 8319.47,-6566.29 8259.5,-6555 8104.62,-6525.84 5677.28,-6511.12 5190.22,-6508.45"/>
<polygon fill="black" stroke="black" points="5190.11,-6504.95 5180.1,-6508.39 5190.08,-6511.95 5190.11,-6504.95"/>
</g>
<!-- add_0 -->
<g id="node8" class="node">
<title>add_0</title>
<ellipse fill="lightgray" stroke="black" cx="8027.5" cy="-5686.5" rx="105.5" ry="105.5"/>
<text text-anchor="middle" x="8027.5" y="-5697.8" font-family="monospace" font-size="14.00">Add</text>
<text text-anchor="middle" x="8027.5" y="-5682.8" font-family="monospace" font-size="14.00">Residual</text>
<text text-anchor="middle" x="8027.5" y="-5667.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- input&#45;&gt;add_0 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;add_0</title>
<path fill="none" stroke="black" d="M8693.61,-6634.27C9021.81,-6626.42 9613.5,-6599.57 9613.5,-6508 9613.5,-6508 9613.5,-6508 9613.5,-5881 9613.5,-5732.81 8508.46,-5697.19 8143.16,-5689.47"/>
<polygon fill="black" stroke="black" points="8143.17,-5685.97 8133.1,-5689.26 8143.02,-5692.96 8143.17,-5685.97"/>
</g>
<!-- q_proj_0_0_0 -->
<g id="node9" class="node">
<title>q_proj_0_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="608,-6451 435,-6451 435,-6368 608,-6368 608,-6451"/>
<text text-anchor="middle" x="521.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="521.5" y="-6420.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="521.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="521.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="521.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_0_0 -->
<g id="edge3" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_0_0</title>
<path fill="none" stroke="black" d="M5030.66,-6505.92C4538.89,-6505.27 1764.04,-6500.33 917.5,-6470 786.81,-6465.32 748.77,-6481.15 618.06,-6451.14"/>
<polygon fill="black" stroke="black" points="618.61,-6447.67 608.07,-6448.8 617.01,-6454.49 618.61,-6447.67"/>
</g>
<!-- k_proj_0_0_0 -->
<g id="node10" class="node">
<title>k_proj_0_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="799,-6451 626,-6451 626,-6368 799,-6368 799,-6451"/>
<text text-anchor="middle" x="712.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="712.5" y="-6420.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="712.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="712.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="712.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_0_0 -->
<g id="edge4" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_0_0</title>
<path fill="none" stroke="black" d="M5030.63,-6505.88C4551.95,-6505.02 1914.48,-6499.05 1108.5,-6470 977.81,-6465.29 939.77,-6481.15 809.06,-6451.14"/>
<polygon fill="black" stroke="black" points="809.61,-6447.67 799.07,-6448.8 808.01,-6454.49 809.61,-6447.67"/>
</g>
<!-- v_proj_0_0_0 -->
<g id="node11" class="node">
<title>v_proj_0_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="990,-6451 817,-6451 817,-6368 990,-6368 990,-6451"/>
<text text-anchor="middle" x="903.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="903.5" y="-6420.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="903.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="903.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="903.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_0_0 -->
<g id="edge5" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_0_0</title>
<path fill="none" stroke="black" d="M5030.87,-6505.84C4566.26,-6504.77 2065.1,-6497.76 1299.5,-6470 1168.81,-6465.26 1130.77,-6481.14 1000.06,-6451.14"/>
<polygon fill="black" stroke="black" points="1000.61,-6447.67 990.07,-6448.8 999.01,-6454.49 1000.61,-6447.67"/>
</g>
<!-- q_proj_0_0_1 -->
<g id="node12" class="node">
<title>q_proj_0_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="1181,-6451 1008,-6451 1008,-6368 1181,-6368 1181,-6451"/>
<text text-anchor="middle" x="1094.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1094.5" y="-6420.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="1094.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1094.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1094.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_0_1 -->
<g id="edge6" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_0_1</title>
<path fill="none" stroke="black" d="M5030.64,-6505.8C4579.25,-6504.49 2215.52,-6496.47 1490.5,-6470 1359.82,-6465.23 1321.77,-6481.14 1191.06,-6451.14"/>
<polygon fill="black" stroke="black" points="1191.61,-6447.67 1181.07,-6448.8 1190.01,-6454.49 1191.61,-6447.67"/>
</g>
<!-- k_proj_0_0_1 -->
<g id="node13" class="node">
<title>k_proj_0_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="1372,-6451 1199,-6451 1199,-6368 1372,-6368 1372,-6451"/>
<text text-anchor="middle" x="1285.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1285.5" y="-6420.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="1285.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1285.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1285.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_0_1 -->
<g id="edge7" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_0_1</title>
<path fill="none" stroke="black" d="M5030.73,-6505.75C4593.75,-6504.2 2366.17,-6495.19 1681.5,-6470 1550.82,-6465.19 1512.77,-6481.14 1382.06,-6451.14"/>
<polygon fill="black" stroke="black" points="1382.61,-6447.67 1372.07,-6448.8 1381.01,-6454.49 1382.61,-6447.67"/>
</g>
<!-- v_proj_0_0_1 -->
<g id="node14" class="node">
<title>v_proj_0_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="1563,-6451 1390,-6451 1390,-6368 1563,-6368 1563,-6451"/>
<text text-anchor="middle" x="1476.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1476.5" y="-6420.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="1476.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1476.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1476.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_0_1 -->
<g id="edge8" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_0_1</title>
<path fill="none" stroke="black" d="M5030.82,-6505.7C4608.62,-6503.9 2516.87,-6493.91 1872.5,-6470 1741.82,-6465.15 1703.77,-6481.14 1573.06,-6451.14"/>
<polygon fill="black" stroke="black" points="1573.61,-6447.67 1563.07,-6448.8 1572.01,-6454.49 1573.61,-6447.67"/>
</g>
<!-- q_proj_0_0_2 -->
<g id="node15" class="node">
<title>q_proj_0_0_2</title>
<polygon fill="#ccccff" stroke="black" points="1754,-6451 1581,-6451 1581,-6368 1754,-6368 1754,-6451"/>
<text text-anchor="middle" x="1667.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1667.5" y="-6420.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="1667.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1667.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1667.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_0_2 -->
<g id="edge9" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_0_2</title>
<path fill="none" stroke="black" d="M5030.96,-6505.64C4624.07,-6503.58 2667.66,-6492.63 2063.5,-6470 1932.82,-6465.11 1894.77,-6481.14 1764.06,-6451.14"/>
<polygon fill="black" stroke="black" points="1764.61,-6447.67 1754.07,-6448.8 1763.01,-6454.49 1764.61,-6447.67"/>
</g>
<!-- k_proj_0_0_2 -->
<g id="node16" class="node">
<title>k_proj_0_0_2</title>
<polygon fill="#ccccff" stroke="black" points="1945,-6451 1772,-6451 1772,-6368 1945,-6368 1945,-6451"/>
<text text-anchor="middle" x="1858.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1858.5" y="-6420.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="1858.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1858.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1858.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_0_2 -->
<g id="edge10" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_0_2</title>
<path fill="none" stroke="black" d="M5030.88,-6505.57C4639.3,-6503.22 2818.4,-6491.34 2254.5,-6470 2123.82,-6465.05 2085.77,-6481.13 1955.06,-6451.14"/>
<polygon fill="black" stroke="black" points="1955.61,-6447.67 1945.07,-6448.8 1954.01,-6454.49 1955.61,-6447.67"/>
</g>
<!-- v_proj_0_0_2 -->
<g id="node17" class="node">
<title>v_proj_0_0_2</title>
<polygon fill="#ccccff" stroke="black" points="2136,-6451 1963,-6451 1963,-6368 2136,-6368 2136,-6451"/>
<text text-anchor="middle" x="2049.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2049.5" y="-6420.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="2049.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2049.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2049.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_0_2 -->
<g id="edge11" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_0_2</title>
<path fill="none" stroke="black" d="M5030.89,-6506.34C4716.6,-6507.5 3469.47,-6509.22 2445.5,-6470 2314.82,-6464.99 2276.77,-6481.13 2146.06,-6451.14"/>
<polygon fill="black" stroke="black" points="2146.61,-6447.67 2136.07,-6448.8 2145.01,-6454.49 2146.61,-6447.67"/>
</g>
<!-- q_proj_0_0_3 -->
<g id="node18" class="node">
<title>q_proj_0_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="2327,-6451 2154,-6451 2154,-6368 2327,-6368 2327,-6451"/>
<text text-anchor="middle" x="2240.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2240.5" y="-6420.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="2240.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2240.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2240.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_0_3 -->
<g id="edge12" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_0_3</title>
<path fill="none" stroke="black" d="M5030.98,-6506.23C4730.83,-6506.88 3581.32,-6506.69 2636.5,-6470 2505.83,-6464.93 2467.77,-6481.13 2337.06,-6451.14"/>
<polygon fill="black" stroke="black" points="2337.61,-6447.67 2327.07,-6448.8 2336.01,-6454.49 2337.61,-6447.67"/>
</g>
<!-- k_proj_0_0_3 -->
<g id="node19" class="node">
<title>k_proj_0_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="2518,-6451 2345,-6451 2345,-6368 2518,-6368 2518,-6451"/>
<text text-anchor="middle" x="2431.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2431.5" y="-6420.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="2431.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2431.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2431.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_0_3 -->
<g id="edge13" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_0_3</title>
<path fill="none" stroke="black" d="M5030.77,-6506.09C4744.96,-6506.18 3693.67,-6504.04 2828.5,-6470 2697.4,-6464.84 2659.21,-6481.21 2528.09,-6451.14"/>
<polygon fill="black" stroke="black" points="2528.61,-6447.67 2518.07,-6448.8 2527.01,-6454.49 2528.61,-6447.67"/>
</g>
<!-- v_proj_0_0_3 -->
<g id="node20" class="node">
<title>v_proj_0_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="2709,-6451 2536,-6451 2536,-6368 2709,-6368 2709,-6451"/>
<text text-anchor="middle" x="2622.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2622.5" y="-6420.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="2622.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2622.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2622.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_0_3 -->
<g id="edge14" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_0_3</title>
<path fill="none" stroke="black" d="M5030.67,-6505.93C4759.99,-6505.43 3806.39,-6501.41 3020.5,-6470 2888.97,-6464.74 2850.65,-6481.29 2719.13,-6451.15"/>
<polygon fill="black" stroke="black" points="2719.61,-6447.67 2709.07,-6448.8 2718.01,-6454.49 2719.61,-6447.67"/>
</g>
<!-- q_proj_0_1_0 -->
<g id="node21" class="node">
<title>q_proj_0_1_0</title>
<polygon fill="#ffccff" stroke="black" points="2900,-6451 2727,-6451 2727,-6368 2900,-6368 2900,-6451"/>
<text text-anchor="middle" x="2813.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2813.5" y="-6420.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="2813.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2813.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2813.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_1_0 -->
<g id="edge15" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_1_0</title>
<path fill="none" stroke="black" d="M5030.73,-6505.72C4776.4,-6504.54 3921.34,-6498.55 3215.5,-6470 3082.11,-6464.6 3043.34,-6481.65 2909.85,-6451.09"/>
<polygon fill="black" stroke="black" points="2910.61,-6447.67 2900.07,-6448.8 2909.01,-6454.49 2910.61,-6447.67"/>
</g>
<!-- k_proj_0_1_0 -->
<g id="node22" class="node">
<title>k_proj_0_1_0</title>
<polygon fill="#ffccff" stroke="black" points="3091,-6451 2918,-6451 2918,-6368 3091,-6368 3091,-6451"/>
<text text-anchor="middle" x="3004.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="3004.5" y="-6420.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="3004.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3004.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3004.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_1_0 -->
<g id="edge16" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_1_0</title>
<path fill="none" stroke="black" d="M5030.77,-6505.53C4792.87,-6503.78 4031.84,-6496.37 3402.5,-6470 3270.98,-6464.49 3232.65,-6481.28 3101.13,-6451.15"/>
<polygon fill="black" stroke="black" points="3101.61,-6447.67 3091.07,-6448.8 3100.01,-6454.49 3101.61,-6447.67"/>
</g>
<!-- v_proj_0_1_0 -->
<g id="node23" class="node">
<title>v_proj_0_1_0</title>
<polygon fill="#ffccff" stroke="black" points="3282,-6451 3109,-6451 3109,-6368 3282,-6368 3282,-6451"/>
<text text-anchor="middle" x="3195.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="3195.5" y="-6420.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="3195.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3195.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3195.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_1_0 -->
<g id="edge17" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_1_0</title>
<path fill="none" stroke="black" d="M5030.98,-6505.21C4811.48,-6502.69 4148.24,-6493.51 3598.5,-6470 3464.69,-6464.28 3425.78,-6481.72 3291.88,-6451.09"/>
<polygon fill="black" stroke="black" points="3292.61,-6447.67 3282.07,-6448.8 3291.01,-6454.49 3292.61,-6447.67"/>
</g>
<!-- q_proj_0_1_1 -->
<g id="node24" class="node">
<title>q_proj_0_1_1</title>
<polygon fill="#ccffff" stroke="black" points="3473,-6451 3300,-6451 3300,-6368 3473,-6368 3473,-6451"/>
<text text-anchor="middle" x="3386.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3386.5" y="-6420.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="3386.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3386.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3386.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_1_1 -->
<g id="edge18" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_1_1</title>
<path fill="none" stroke="black" d="M5030.73,-6504.87C4829.55,-6501.65 4259.93,-6491.2 3786.5,-6470 3654.13,-6464.07 3615.53,-6481.42 3483.19,-6451.16"/>
<polygon fill="black" stroke="black" points="3483.61,-6447.67 3473.07,-6448.8 3482.01,-6454.48 3483.61,-6447.67"/>
</g>
<!-- k_proj_0_1_1 -->
<g id="node25" class="node">
<title>k_proj_0_1_1</title>
<polygon fill="#ccffff" stroke="black" points="3664,-6451 3491,-6451 3491,-6368 3664,-6368 3664,-6451"/>
<text text-anchor="middle" x="3577.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3577.5" y="-6420.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="3577.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3577.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3577.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_1_1 -->
<g id="edge19" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_1_1</title>
<path fill="none" stroke="black" d="M5030.69,-6504.34C4850.55,-6500.18 4378.38,-6488.31 3984.5,-6470 3848.98,-6463.7 3809.54,-6482.03 3674,-6451.12"/>
<polygon fill="black" stroke="black" points="3674.6,-6447.67 3664.07,-6448.81 3673.02,-6454.48 3674.6,-6447.67"/>
</g>
<!-- v_proj_0_1_1 -->
<g id="node26" class="node">
<title>v_proj_0_1_1</title>
<polygon fill="#ccffff" stroke="black" points="3855,-6451 3682,-6451 3682,-6368 3855,-6368 3855,-6451"/>
<text text-anchor="middle" x="3768.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3768.5" y="-6420.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="3768.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3768.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3768.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_1_1 -->
<g id="edge20" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_1_1</title>
<path fill="none" stroke="black" d="M5030.92,-6503.76C4871.96,-6498.84 4488.09,-6486.25 4166.5,-6470 4035.03,-6463.36 3996.65,-6481.22 3865.13,-6451.15"/>
<polygon fill="black" stroke="black" points="3865.61,-6447.67 3855.07,-6448.8 3864.01,-6454.48 3865.61,-6447.67"/>
</g>
<!-- q_proj_0_1_2 -->
<g id="node27" class="node">
<title>q_proj_0_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="4046,-6451 3873,-6451 3873,-6368 4046,-6368 4046,-6451"/>
<text text-anchor="middle" x="3959.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="3959.5" y="-6420.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="3959.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3959.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3959.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_1_2 -->
<g id="edge21" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_1_2</title>
<path fill="none" stroke="black" d="M5030.65,-6505.56C4826,-6503.8 4259.44,-6495.19 4056.06,-6451.07"/>
<polygon fill="black" stroke="black" points="4056.6,-6447.6 4046.07,-6448.81 4055.05,-6454.43 4056.6,-6447.6"/>
</g>
<!-- k_proj_0_1_2 -->
<g id="node28" class="node">
<title>k_proj_0_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="4237,-6451 4064,-6451 4064,-6368 4237,-6368 4237,-6451"/>
<text text-anchor="middle" x="4150.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="4150.5" y="-6420.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="4150.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4150.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4150.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_1_2 -->
<g id="edge22" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_1_2</title>
<path fill="none" stroke="black" d="M5030.85,-6504.46C4853.94,-6500.3 4412.3,-6486.8 4247.08,-6451.07"/>
<polygon fill="black" stroke="black" points="4247.6,-6447.6 4237.07,-6448.8 4246.05,-6454.42 4247.6,-6447.6"/>
</g>
<!-- v_proj_0_1_2 -->
<g id="node29" class="node">
<title>v_proj_0_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="4428,-6451 4255,-6451 4255,-6368 4428,-6368 4428,-6451"/>
<text text-anchor="middle" x="4341.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="4341.5" y="-6420.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="4341.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4341.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4341.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_1_2 -->
<g id="edge23" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_1_2</title>
<path fill="none" stroke="black" d="M5030.75,-6502.87C4884.58,-6496.27 4564.81,-6479.35 4437.96,-6451.05"/>
<polygon fill="black" stroke="black" points="4438.63,-6447.61 4428.09,-6448.73 4437.02,-6454.43 4438.63,-6447.61"/>
</g>
<!-- q_proj_0_1_3 -->
<g id="node30" class="node">
<title>q_proj_0_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="4619,-6451 4446,-6451 4446,-6368 4619,-6368 4619,-6451"/>
<text text-anchor="middle" x="4532.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="4532.5" y="-6420.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="4532.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4532.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4532.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_1_3 -->
<g id="edge24" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_1_3</title>
<path fill="none" stroke="black" d="M5030.99,-6504.05C4938.03,-6500.15 4774.55,-6488.47 4629.12,-6451.22"/>
<polygon fill="black" stroke="black" points="4629.68,-6447.75 4619.12,-6448.61 4627.91,-6454.52 4629.68,-6447.75"/>
</g>
<!-- k_proj_0_1_3 -->
<g id="node31" class="node">
<title>k_proj_0_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="4810,-6451 4637,-6451 4637,-6368 4810,-6368 4810,-6451"/>
<text text-anchor="middle" x="4723.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="4723.5" y="-6420.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="4723.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4723.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4723.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_1_3 -->
<g id="edge25" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_1_3</title>
<path fill="none" stroke="black" d="M5030.71,-6496.15C4974.56,-6487.73 4895.87,-6473.75 4819.93,-6451.27"/>
<polygon fill="black" stroke="black" points="4820.78,-6447.87 4810.2,-6448.34 4818.76,-6454.57 4820.78,-6447.87"/>
</g>
<!-- v_proj_0_1_3 -->
<g id="node32" class="node">
<title>v_proj_0_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="5001,-6451 4828,-6451 4828,-6368 5001,-6368 5001,-6451"/>
<text text-anchor="middle" x="4914.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="4914.5" y="-6420.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="4914.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4914.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4914.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_1_3 -->
<g id="edge26" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_1_3</title>
<path fill="none" stroke="black" d="M5069.12,-6487.81C5050.78,-6478.64 5027.63,-6467.07 5004.88,-6455.69"/>
<polygon fill="black" stroke="black" points="5006.36,-6452.52 4995.85,-6451.17 5003.23,-6458.78 5006.36,-6452.52"/>
</g>
<!-- q_proj_0_2_0 -->
<g id="node33" class="node">
<title>q_proj_0_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="5192,-6451 5019,-6451 5019,-6368 5192,-6368 5192,-6451"/>
<text text-anchor="middle" x="5105.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5105.5" y="-6420.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="5105.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5105.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5105.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_2_0 -->
<g id="edge27" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_2_0</title>
<path fill="none" stroke="black" d="M5105.5,-6487.59C5105.5,-6479.94 5105.5,-6470.66 5105.5,-6461.23"/>
<polygon fill="black" stroke="black" points="5109,-6461 5105.5,-6451 5102,-6461 5109,-6461"/>
</g>
<!-- k_proj_0_2_0 -->
<g id="node34" class="node">
<title>k_proj_0_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="5383,-6451 5210,-6451 5210,-6368 5383,-6368 5383,-6451"/>
<text text-anchor="middle" x="5296.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5296.5" y="-6420.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="5296.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5296.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5296.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_2_0 -->
<g id="edge28" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_2_0</title>
<path fill="none" stroke="black" d="M5141.88,-6487.81C5160.22,-6478.64 5183.37,-6467.07 5206.12,-6455.69"/>
<polygon fill="black" stroke="black" points="5207.77,-6458.78 5215.15,-6451.17 5204.64,-6452.52 5207.77,-6458.78"/>
</g>
<!-- v_proj_0_2_0 -->
<g id="node35" class="node">
<title>v_proj_0_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="5574,-6451 5401,-6451 5401,-6368 5574,-6368 5574,-6451"/>
<text text-anchor="middle" x="5487.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5487.5" y="-6420.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="5487.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5487.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5487.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_2_0 -->
<g id="edge29" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_2_0</title>
<path fill="none" stroke="black" d="M5180.01,-6496.04C5235.95,-6487.57 5314.35,-6473.57 5391.1,-6450.93"/>
<polygon fill="black" stroke="black" points="5392.36,-6454.2 5400.94,-6447.98 5390.35,-6447.5 5392.36,-6454.2"/>
</g>
<!-- q_proj_0_2_1 -->
<g id="node36" class="node">
<title>q_proj_0_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="5765,-6451 5592,-6451 5592,-6368 5765,-6368 5765,-6451"/>
<text text-anchor="middle" x="5678.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5678.5" y="-6420.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="5678.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5678.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5678.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_2_1 -->
<g id="edge30" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_2_1</title>
<path fill="none" stroke="black" d="M5180.25,-6503.93C5273.06,-6499.91 5435.9,-6488.1 5581.73,-6450.96"/>
<polygon fill="black" stroke="black" points="5582.96,-6454.26 5591.76,-6448.36 5581.2,-6447.49 5582.96,-6454.26"/>
</g>
<!-- k_proj_0_2_1 -->
<g id="node37" class="node">
<title>k_proj_0_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="5956,-6451 5783,-6451 5783,-6368 5956,-6368 5956,-6451"/>
<text text-anchor="middle" x="5869.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5869.5" y="-6420.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="5869.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5869.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5869.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_2_1 -->
<g id="edge31" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_2_1</title>
<path fill="none" stroke="black" d="M5180.13,-6502.83C5326.06,-6496.16 5645.33,-6479.11 5772.86,-6450.82"/>
<polygon fill="black" stroke="black" points="5773.85,-6454.18 5782.79,-6448.49 5772.26,-6447.36 5773.85,-6454.18"/>
</g>
<!-- v_proj_0_2_1 -->
<g id="node38" class="node">
<title>v_proj_0_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="6147,-6451 5974,-6451 5974,-6368 6147,-6368 6147,-6451"/>
<text text-anchor="middle" x="6060.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="6060.5" y="-6420.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="6060.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6060.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6060.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_2_1 -->
<g id="edge32" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_2_1</title>
<path fill="none" stroke="black" d="M5180.06,-6504.43C5356.74,-6500.19 5797.84,-6486.54 5963.75,-6450.84"/>
<polygon fill="black" stroke="black" points="5964.82,-6454.18 5973.81,-6448.56 5963.28,-6447.35 5964.82,-6454.18"/>
</g>
<!-- q_proj_0_2_2 -->
<g id="node39" class="node">
<title>q_proj_0_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="6338,-6451 6165,-6451 6165,-6368 6338,-6368 6338,-6451"/>
<text text-anchor="middle" x="6251.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6251.5" y="-6420.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="6251.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6251.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6251.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_2_2 -->
<g id="edge33" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_2_2</title>
<path fill="none" stroke="black" d="M5180.24,-6502.81C5315.42,-6496.97 5609.55,-6483.84 5857.5,-6470 5986.77,-6462.79 6024.49,-6480.54 6154.84,-6450.88"/>
<polygon fill="black" stroke="black" points="6155.86,-6454.24 6164.81,-6448.57 6154.27,-6447.42 6155.86,-6454.24"/>
</g>
<!-- k_proj_0_2_2 -->
<g id="node40" class="node">
<title>k_proj_0_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="6529,-6451 6356,-6451 6356,-6368 6529,-6368 6529,-6451"/>
<text text-anchor="middle" x="6442.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6442.5" y="-6420.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="6442.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6442.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6442.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_2_2 -->
<g id="edge34" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_2_2</title>
<path fill="none" stroke="black" d="M5180.23,-6506.18C5409.8,-6506.19 6103.36,-6502.04 6345.99,-6450.79"/>
<polygon fill="black" stroke="black" points="6346.81,-6454.19 6355.82,-6448.63 6345.3,-6447.36 6346.81,-6454.19"/>
</g>
<!-- v_proj_0_2_2 -->
<g id="node41" class="node">
<title>v_proj_0_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="6720,-6451 6547,-6451 6547,-6368 6720,-6368 6720,-6451"/>
<text text-anchor="middle" x="6633.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6633.5" y="-6420.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="6633.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6633.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6633.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_2_2 -->
<g id="edge35" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_2_2</title>
<path fill="none" stroke="black" d="M5180.03,-6504.48C5361.74,-6500.6 5842.05,-6489.23 6242.5,-6470 6370.53,-6463.85 6407.82,-6480.34 6536.94,-6450.86"/>
<polygon fill="black" stroke="black" points="6537.86,-6454.24 6546.81,-6448.56 6536.27,-6447.43 6537.86,-6454.24"/>
</g>
<!-- q_proj_0_2_3 -->
<g id="node42" class="node">
<title>q_proj_0_2_3</title>
<polygon fill="#aaffff" stroke="black" points="6911,-6451 6738,-6451 6738,-6368 6911,-6368 6911,-6451"/>
<text text-anchor="middle" x="6824.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6824.5" y="-6420.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="6824.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6824.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6824.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_2_3 -->
<g id="edge36" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_2_3</title>
<path fill="none" stroke="black" d="M5180.06,-6504.35C5372.41,-6499.97 5901.22,-6487.22 6341.5,-6470 6510.3,-6463.4 6558.76,-6488.3 6727.84,-6450.88"/>
<polygon fill="black" stroke="black" points="6728.84,-6454.24 6737.82,-6448.63 6727.3,-6447.41 6728.84,-6454.24"/>
</g>
<!-- k_proj_0_2_3 -->
<g id="node43" class="node">
<title>k_proj_0_2_3</title>
<polygon fill="#aaffff" stroke="black" points="7102,-6451 6929,-6451 6929,-6368 7102,-6368 7102,-6451"/>
<text text-anchor="middle" x="7015.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7015.5" y="-6420.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="7015.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7015.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7015.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_2_3 -->
<g id="edge37" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_2_3</title>
<path fill="none" stroke="black" d="M5180.05,-6504.56C5388.05,-6500.44 5992.46,-6487.73 6494.5,-6470 6680.23,-6463.44 6733.26,-6491.63 6919.01,-6450.83"/>
<polygon fill="black" stroke="black" points="6919.83,-6454.24 6928.83,-6448.64 6918.3,-6447.41 6919.83,-6454.24"/>
</g>
<!-- v_proj_0_2_3 -->
<g id="node44" class="node">
<title>v_proj_0_2_3</title>
<polygon fill="#aaffff" stroke="black" points="7293,-6451 7120,-6451 7120,-6368 7293,-6368 7293,-6451"/>
<text text-anchor="middle" x="7206.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7206.5" y="-6420.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="7206.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7206.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7206.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_2_3 -->
<g id="edge38" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_2_3</title>
<path fill="none" stroke="black" d="M5180.35,-6504.81C5405.46,-6501.1 6096.1,-6488.89 6668.5,-6470 6861.76,-6463.62 6916.84,-6493.11 7109.93,-6450.85"/>
<polygon fill="black" stroke="black" points="7110.83,-6454.24 7119.83,-6448.65 7109.31,-6447.41 7110.83,-6454.24"/>
</g>
<!-- q_proj_0_3_0 -->
<g id="node45" class="node">
<title>q_proj_0_3_0</title>
<polygon fill="#ff8888" stroke="black" points="7484,-6451 7311,-6451 7311,-6368 7484,-6368 7484,-6451"/>
<text text-anchor="middle" x="7397.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7397.5" y="-6420.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="7397.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7397.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7397.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_3_0 -->
<g id="edge39" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_3_0</title>
<path fill="none" stroke="black" d="M5180.31,-6505.03C5421.92,-6501.76 6203.25,-6490.25 6849.5,-6470 7047.23,-6463.8 7103.5,-6494 7301.01,-6450.83"/>
<polygon fill="black" stroke="black" points="7301.82,-6454.24 7310.83,-6448.65 7300.31,-6447.41 7301.82,-6454.24"/>
</g>
<!-- k_proj_0_3_0 -->
<g id="node46" class="node">
<title>k_proj_0_3_0</title>
<polygon fill="#ff8888" stroke="black" points="7675,-6451 7502,-6451 7502,-6368 7675,-6368 7675,-6451"/>
<text text-anchor="middle" x="7588.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7588.5" y="-6420.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="7588.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7588.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7588.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_3_0 -->
<g id="edge40" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_3_0</title>
<path fill="none" stroke="black" d="M5180.15,-6505.23C5437.94,-6502.45 6314.67,-6491.88 7038.5,-6470 7237.11,-6464 7293.62,-6494.18 7491.97,-6450.84"/>
<polygon fill="black" stroke="black" points="7492.82,-6454.24 7501.83,-6448.66 7491.31,-6447.41 7492.82,-6454.24"/>
</g>
<!-- v_proj_0_3_0 -->
<g id="node47" class="node">
<title>v_proj_0_3_0</title>
<polygon fill="#ff8888" stroke="black" points="7866,-6451 7693,-6451 7693,-6368 7866,-6368 7866,-6451"/>
<text text-anchor="middle" x="7779.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7779.5" y="-6420.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="7779.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7779.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7779.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_3_0 -->
<g id="edge41" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_3_0</title>
<path fill="none" stroke="black" d="M5180.26,-6505.4C5453.87,-6503.07 6426.62,-6493.54 7228.5,-6470 7427.55,-6464.16 7484.18,-6494.27 7682.95,-6450.85"/>
<polygon fill="black" stroke="black" points="7683.82,-6454.24 7692.83,-6448.66 7682.31,-6447.41 7683.82,-6454.24"/>
</g>
<!-- q_proj_0_3_1 -->
<g id="node48" class="node">
<title>q_proj_0_3_1</title>
<polygon fill="#88ff88" stroke="black" points="8057,-6451 7884,-6451 7884,-6368 8057,-6368 8057,-6451"/>
<text text-anchor="middle" x="7970.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7970.5" y="-6420.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="7970.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7970.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7970.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_3_1 -->
<g id="edge42" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_3_1</title>
<path fill="none" stroke="black" d="M5180.4,-6505.54C5469.21,-6503.64 6538.33,-6495.18 7418.5,-6470 7617.99,-6464.29 7674.75,-6494.36 7873.93,-6450.85"/>
<polygon fill="black" stroke="black" points="7874.82,-6454.24 7883.83,-6448.66 7873.31,-6447.41 7874.82,-6454.24"/>
</g>
<!-- k_proj_0_3_1 -->
<g id="node49" class="node">
<title>k_proj_0_3_1</title>
<polygon fill="#88ff88" stroke="black" points="8248,-6451 8075,-6451 8075,-6368 8248,-6368 8248,-6451"/>
<text text-anchor="middle" x="8161.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="8161.5" y="-6420.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="8161.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8161.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8161.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_3_1 -->
<g id="edge43" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_3_1</title>
<path fill="none" stroke="black" d="M5180.03,-6505.67C5482.74,-6504.17 6649.86,-6496.89 7609.5,-6470 7809,-6464.41 7865.75,-6494.36 8064.93,-6450.85"/>
<polygon fill="black" stroke="black" points="8065.82,-6454.24 8074.83,-6448.66 8064.31,-6447.41 8065.82,-6454.24"/>
</g>
<!-- v_proj_0_3_1 -->
<g id="node50" class="node">
<title>v_proj_0_3_1</title>
<polygon fill="#88ff88" stroke="black" points="8439,-6451 8266,-6451 8266,-6368 8439,-6368 8439,-6451"/>
<text text-anchor="middle" x="8352.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="8352.5" y="-6420.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="8352.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8352.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8352.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_3_1 -->
<g id="edge44" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_3_1</title>
<path fill="none" stroke="black" d="M5180,-6505.78C5496.57,-6504.67 6761.52,-6498.58 7800.5,-6470 8000,-6464.51 8056.75,-6494.36 8255.93,-6450.85"/>
<polygon fill="black" stroke="black" points="8256.82,-6454.24 8265.83,-6448.66 8255.31,-6447.41 8256.82,-6454.24"/>
</g>
<!-- q_proj_0_3_2 -->
<g id="node51" class="node">
<title>q_proj_0_3_2</title>
<polygon fill="#8888ff" stroke="black" points="8630,-6451 8457,-6451 8457,-6368 8630,-6368 8630,-6451"/>
<text text-anchor="middle" x="8543.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8543.5" y="-6420.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="8543.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8543.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8543.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_3_2 -->
<g id="edge45" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_3_2</title>
<path fill="none" stroke="black" d="M5180.21,-6505.87C5510.56,-6505.12 6873.25,-6500.27 7991.5,-6470 8191,-6464.6 8247.75,-6494.37 8446.93,-6450.85"/>
<polygon fill="black" stroke="black" points="8447.82,-6454.24 8456.83,-6448.66 8446.31,-6447.41 8447.82,-6454.24"/>
</g>
<!-- k_proj_0_3_2 -->
<g id="node52" class="node">
<title>k_proj_0_3_2</title>
<polygon fill="#8888ff" stroke="black" points="8821,-6451 8648,-6451 8648,-6368 8821,-6368 8821,-6451"/>
<text text-anchor="middle" x="8734.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8734.5" y="-6420.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="8734.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8734.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8734.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_3_2 -->
<g id="edge46" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_3_2</title>
<path fill="none" stroke="black" d="M5180.2,-6505.95C5523.53,-6505.54 6984.56,-6501.9 8182.5,-6470 8382.44,-6464.68 8439.39,-6494.82 8638.07,-6451.09"/>
<polygon fill="black" stroke="black" points="8638.95,-6454.48 8647.94,-6448.88 8637.42,-6447.64 8638.95,-6454.48"/>
</g>
<!-- v_proj_0_3_2 -->
<g id="node53" class="node">
<title>v_proj_0_3_2</title>
<polygon fill="#8888ff" stroke="black" points="9012,-6451 8839,-6451 8839,-6368 9012,-6368 9012,-6451"/>
<text text-anchor="middle" x="8925.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8925.5" y="-6420.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="8925.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8925.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8925.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_3_2 -->
<g id="edge47" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_3_2</title>
<path fill="none" stroke="black" d="M5180.03,-6506.02C5535.64,-6505.94 7095.53,-6503.6 8373.5,-6470 8573.44,-6464.74 8630.39,-6494.82 8829.07,-6451.09"/>
<polygon fill="black" stroke="black" points="8829.95,-6454.48 8838.94,-6448.88 8828.42,-6447.64 8829.95,-6454.48"/>
</g>
<!-- q_proj_0_3_3 -->
<g id="node54" class="node">
<title>q_proj_0_3_3</title>
<polygon fill="#ffff88" stroke="black" points="9203,-6451 9030,-6451 9030,-6368 9203,-6368 9203,-6451"/>
<text text-anchor="middle" x="9116.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9116.5" y="-6420.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="9116.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="9116.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9116.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_3_3 -->
<g id="edge48" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_3_3</title>
<path fill="none" stroke="black" d="M5180.04,-6506.08C5547.82,-6506.31 7205.97,-6505.22 8563.5,-6470 8763.88,-6464.8 8820.95,-6494.91 9020.05,-6451.09"/>
<polygon fill="black" stroke="black" points="9020.95,-6454.48 9029.94,-6448.88 9019.42,-6447.64 9020.95,-6454.48"/>
</g>
<!-- k_proj_0_3_3 -->
<g id="node55" class="node">
<title>k_proj_0_3_3</title>
<polygon fill="#ffff88" stroke="black" points="9394,-6451 9221,-6451 9221,-6368 9394,-6368 9394,-6451"/>
<text text-anchor="middle" x="9307.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9307.5" y="-6420.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="9307.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="9307.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9307.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_3_3 -->
<g id="edge49" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_3_3</title>
<path fill="none" stroke="black" d="M5180,-6506.14C5559.56,-6506.65 7316.24,-6506.83 8753.5,-6470 8954.32,-6464.85 9011.51,-6494.99 9211.03,-6451.1"/>
<polygon fill="black" stroke="black" points="9211.95,-6454.48 9220.94,-6448.88 9210.42,-6447.64 9211.95,-6454.48"/>
</g>
<!-- v_proj_0_3_3 -->
<g id="node56" class="node">
<title>v_proj_0_3_3</title>
<polygon fill="#ffff88" stroke="black" points="9585,-6451 9412,-6451 9412,-6368 9585,-6368 9585,-6451"/>
<text text-anchor="middle" x="9498.5" y="-6435.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9498.5" y="-6420.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="9498.5" y="-6405.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="9498.5" y="-6390.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9498.5" y="-6375.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_3_3 -->
<g id="edge50" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_3_3</title>
<path fill="none" stroke="black" d="M5180.31,-6506.19C5572.13,-6506.99 7427.4,-6508.5 8944.5,-6470 9145.32,-6464.9 9202.51,-6495 9402.03,-6451.1"/>
<polygon fill="black" stroke="black" points="9402.95,-6454.48 9411.94,-6448.88 9401.42,-6447.64 9402.95,-6454.48"/>
</g>
<!-- ln2_0 -->
<g id="node94" class="node">
<title>ln2_0</title>
<polygon fill="lightgray" stroke="black" points="8049,-5544 7900,-5544 7900,-5506 8049,-5506 8049,-5544"/>
<text text-anchor="middle" x="7974.5" y="-5528.8" font-family="monospace" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="7974.5" y="-5513.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- add_0&#45;&gt;ln2_0 -->
<g id="edge200" class="edge">
<title>add_0&#45;&gt;ln2_0</title>
<path fill="none" stroke="black" d="M7994.39,-5585.85C7990.52,-5574.22 7986.86,-5563.21 7983.76,-5553.87"/>
<polygon fill="black" stroke="black" points="7986.99,-5552.48 7980.51,-5544.09 7980.34,-5554.68 7986.99,-5552.48"/>
</g>
<!-- add2_0 -->
<g id="node95" class="node">
<title>add2_0</title>
<ellipse fill="lightgray" stroke="black" cx="7973.5" cy="-5050.5" rx="105.5" ry="105.5"/>
<text text-anchor="middle" x="7973.5" y="-5061.8" font-family="monospace" font-size="14.00">Add</text>
<text text-anchor="middle" x="7973.5" y="-5046.8" font-family="monospace" font-size="14.00">Residual</text>
<text text-anchor="middle" x="7973.5" y="-5031.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- add_0&#45;&gt;add2_0 -->
<g id="edge201" class="edge">
<title>add_0&#45;&gt;add2_0</title>
<path fill="none" stroke="black" d="M8070.83,-5590.23C8077.11,-5569.48 8081.5,-5547.34 8081.5,-5526 8081.5,-5526 8081.5,-5526 8081.5,-5240 8081.5,-5204.3 8066.73,-5169.23 8048.12,-5139.2"/>
<polygon fill="black" stroke="black" points="8050.86,-5136.98 8042.51,-5130.46 8044.97,-5140.77 8050.86,-5136.98"/>
</g>
<!-- attn_0_0_0 -->
<g id="node57" class="node">
<title>attn_0_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="900,-6317 801,-6317 801,-6249 900,-6249 900,-6317"/>
<text text-anchor="middle" x="850.5" y="-6301.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="850.5" y="-6286.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="850.5" y="-6271.8" font-family="monospace" font-size="14.00">Heads[0&#45;3]</text>
<text text-anchor="middle" x="850.5" y="-6256.8" font-family="monospace" font-size="14.00">Dim[0&#45;127]</text>
</g>
<!-- q_proj_0_0_0&#45;&gt;attn_0_0_0 -->
<g id="edge51" class="edge">
<title>q_proj_0_0_0&#45;&gt;attn_0_0_0</title>
<path fill="none" stroke="black" d="M558.88,-6367.96C572.18,-6355.68 587.98,-6343.28 604.5,-6335 663.72,-6305.32 739.26,-6292.91 790.91,-6287.72"/>
<polygon fill="black" stroke="black" points="791.28,-6291.2 800.91,-6286.77 790.62,-6284.23 791.28,-6291.2"/>
</g>
<!-- q_proj_0_0_0&#45;&gt;attn_0_0_0 -->
<g id="edge52" class="edge">
<title>q_proj_0_0_0&#45;&gt;attn_0_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M605.55,-6367.87C630.37,-6356.56 657.79,-6344.71 683.5,-6335 718.71,-6321.7 759.05,-6309.31 791.26,-6300.07"/>
<polygon fill="red" stroke="red" points="792.32,-6303.4 800.98,-6297.3 790.4,-6296.67 792.32,-6303.4"/>
<text text-anchor="middle" x="721.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_0_0_0&#45;&gt;attn_0_0_0 -->
<g id="edge53" class="edge">
<title>k_proj_0_0_0&#45;&gt;attn_0_0_0</title>
<path fill="none" stroke="black" d="M746.25,-6367.67C756.17,-6356.59 767.36,-6344.92 778.5,-6335 783.08,-6330.92 787.99,-6326.87 793.01,-6322.94"/>
<polygon fill="black" stroke="black" points="795.13,-6325.72 800.96,-6316.87 790.89,-6320.16 795.13,-6325.72"/>
</g>
<!-- k_proj_0_0_0&#45;&gt;attn_0_0_0 -->
<g id="edge54" class="edge">
<title>k_proj_0_0_0&#45;&gt;attn_0_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M758.75,-6367.69C765.39,-6361.77 772.13,-6355.74 778.5,-6350 787.84,-6341.58 797.81,-6332.5 807.27,-6323.84"/>
<polygon fill="red" stroke="red" points="809.71,-6326.35 814.72,-6317.02 804.98,-6321.19 809.71,-6326.35"/>
<text text-anchor="middle" x="832.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_0_0_0&#45;&gt;attn_0_0_0 -->
<g id="edge55" class="edge">
<title>v_proj_0_0_0&#45;&gt;attn_0_0_0</title>
<path fill="none" stroke="black" d="M892.59,-6367.83C889.19,-6356.98 885.11,-6345.39 880.5,-6335 879.19,-6332.04 877.74,-6329.04 876.22,-6326.05"/>
<polygon fill="black" stroke="black" points="879.27,-6324.33 871.47,-6317.17 873.1,-6327.64 879.27,-6324.33"/>
</g>
<!-- v_proj_0_0_0&#45;&gt;attn_0_0_0 -->
<g id="edge56" class="edge">
<title>v_proj_0_0_0&#45;&gt;attn_0_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M904.92,-6367.65C904.05,-6356.69 901.92,-6345.08 897.5,-6335 896.08,-6331.76 894.37,-6328.59 892.44,-6325.52"/>
<polygon fill="red" stroke="red" points="895.17,-6323.31 886.55,-6317.15 889.45,-6327.34 895.17,-6323.31"/>
<text text-anchor="middle" x="940.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_0_0_1 -->
<g id="node60" class="node">
<title>attn_0_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="1369.5,-6317 1253.5,-6317 1253.5,-6249 1369.5,-6249 1369.5,-6317"/>
<text text-anchor="middle" x="1311.5" y="-6301.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1311.5" y="-6286.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="1311.5" y="-6271.8" font-family="monospace" font-size="14.00">Heads[0&#45;3]</text>
<text text-anchor="middle" x="1311.5" y="-6256.8" font-family="monospace" font-size="14.00">Dim[128&#45;255]</text>
</g>
<!-- q_proj_0_0_1&#45;&gt;attn_0_0_1 -->
<g id="edge60" class="edge">
<title>q_proj_0_0_1&#45;&gt;attn_0_0_1</title>
<path fill="none" stroke="black" d="M1126.74,-6367.84C1137.71,-6355.99 1150.72,-6343.87 1164.5,-6335 1188.47,-6319.57 1217.65,-6308.2 1243.68,-6300.16"/>
<polygon fill="black" stroke="black" points="1244.9,-6303.45 1253.49,-6297.24 1242.9,-6296.74 1244.9,-6303.45"/>
</g>
<!-- q_proj_0_0_1&#45;&gt;attn_0_0_1 -->
<g id="edge61" class="edge">
<title>q_proj_0_0_1&#45;&gt;attn_0_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1162.16,-6367.84C1180.38,-6357.05 1200.13,-6345.48 1218.5,-6335 1226.81,-6330.26 1235.58,-6325.34 1244.27,-6320.52"/>
<polygon fill="red" stroke="red" points="1246.23,-6323.43 1253.29,-6315.53 1242.84,-6317.31 1246.23,-6323.43"/>
<text text-anchor="middle" x="1256.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_0_0_1&#45;&gt;attn_0_0_1 -->
<g id="edge62" class="edge">
<title>k_proj_0_0_1&#45;&gt;attn_0_0_1</title>
<path fill="none" stroke="black" d="M1294.01,-6367.73C1296.7,-6354.86 1299.68,-6340.6 1302.41,-6327.54"/>
<polygon fill="black" stroke="black" points="1305.91,-6327.88 1304.53,-6317.38 1299.06,-6326.45 1305.91,-6327.88"/>
</g>
<!-- k_proj_0_0_1&#45;&gt;attn_0_0_1 -->
<g id="edge63" class="edge">
<title>k_proj_0_0_1&#45;&gt;attn_0_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1307.77,-6367.79C1310.13,-6361.96 1312.15,-6355.93 1313.5,-6350 1315.14,-6342.78 1315.82,-6334.99 1315.93,-6327.39"/>
<polygon fill="red" stroke="red" points="1319.43,-6327.15 1315.75,-6317.21 1312.43,-6327.27 1319.43,-6327.15"/>
<text text-anchor="middle" x="1354.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_0_0_1&#45;&gt;attn_0_0_1 -->
<g id="edge64" class="edge">
<title>v_proj_0_0_1&#45;&gt;attn_0_0_1</title>
<path fill="none" stroke="black" d="M1435.54,-6367.92C1423.4,-6356.73 1409.8,-6344.94 1396.5,-6335 1390.72,-6330.68 1384.55,-6326.41 1378.28,-6322.28"/>
<polygon fill="black" stroke="black" points="1379.99,-6319.22 1369.68,-6316.75 1376.2,-6325.11 1379.99,-6319.22"/>
</g>
<!-- v_proj_0_0_1&#45;&gt;attn_0_0_1 -->
<g id="edge65" class="edge">
<title>v_proj_0_0_1&#45;&gt;attn_0_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1450.86,-6367.68C1442.22,-6356.1 1431.86,-6344.16 1420.5,-6335 1408.16,-6325.05 1393.56,-6316.52 1379.12,-6309.43"/>
<polygon fill="red" stroke="red" points="1380.22,-6306.08 1369.68,-6304.99 1377.24,-6312.42 1380.22,-6306.08"/>
<text text-anchor="middle" x="1473.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_0_0_2 -->
<g id="node62" class="node">
<title>attn_0_0_2</title>
<polygon fill="#ccccff" stroke="black" points="1916.5,-6317 1800.5,-6317 1800.5,-6249 1916.5,-6249 1916.5,-6317"/>
<text text-anchor="middle" x="1858.5" y="-6301.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1858.5" y="-6286.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="1858.5" y="-6271.8" font-family="monospace" font-size="14.00">Heads[0&#45;3]</text>
<text text-anchor="middle" x="1858.5" y="-6256.8" font-family="monospace" font-size="14.00">Dim[256&#45;383]</text>
</g>
<!-- q_proj_0_0_2&#45;&gt;attn_0_0_2 -->
<g id="edge69" class="edge">
<title>q_proj_0_0_2&#45;&gt;attn_0_0_2</title>
<path fill="none" stroke="black" d="M1695.31,-6367.66C1704.78,-6355.94 1716.14,-6343.94 1728.5,-6335 1747.07,-6321.57 1769.65,-6311.11 1790.75,-6303.25"/>
<polygon fill="black" stroke="black" points="1792.08,-6306.49 1800.32,-6299.82 1789.72,-6299.9 1792.08,-6306.49"/>
</g>
<!-- q_proj_0_0_2&#45;&gt;attn_0_0_2 -->
<g id="edge70" class="edge">
<title>q_proj_0_0_2&#45;&gt;attn_0_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1728.44,-6367.87C1744.67,-6357.13 1762.22,-6345.58 1778.5,-6335 1784.67,-6330.99 1791.13,-6326.83 1797.58,-6322.68"/>
<polygon fill="red" stroke="red" points="1799.81,-6325.41 1806.35,-6317.06 1796.04,-6319.51 1799.81,-6325.41"/>
<text text-anchor="middle" x="1816.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_0_0_2&#45;&gt;attn_0_0_2 -->
<g id="edge71" class="edge">
<title>k_proj_0_0_2&#45;&gt;attn_0_0_2</title>
<path fill="none" stroke="black" d="M1858.5,-6367.73C1858.5,-6354.86 1858.5,-6340.6 1858.5,-6327.54"/>
<polygon fill="black" stroke="black" points="1862,-6327.38 1858.5,-6317.38 1855,-6327.38 1862,-6327.38"/>
</g>
<!-- k_proj_0_0_2&#45;&gt;attn_0_0_2 -->
<g id="edge72" class="edge">
<title>k_proj_0_0_2&#45;&gt;attn_0_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1871.01,-6367.81C1872.97,-6357.17 1873.94,-6345.68 1872.5,-6335 1872.16,-6332.45 1871.72,-6329.85 1871.22,-6327.24"/>
<polygon fill="red" stroke="red" points="1874.57,-6326.21 1868.99,-6317.2 1867.74,-6327.72 1874.57,-6326.21"/>
<text text-anchor="middle" x="1911.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_0_0_2&#45;&gt;attn_0_0_2 -->
<g id="edge73" class="edge">
<title>v_proj_0_0_2&#45;&gt;attn_0_0_2</title>
<path fill="none" stroke="black" d="M1999.29,-6367.64C1984.85,-6356.56 1968.84,-6344.9 1953.5,-6335 1944.59,-6329.25 1934.97,-6323.55 1925.39,-6318.15"/>
<polygon fill="black" stroke="black" points="1927.07,-6315.08 1916.63,-6313.29 1923.67,-6321.2 1927.07,-6315.08"/>
</g>
<!-- v_proj_0_0_2&#45;&gt;attn_0_0_2 -->
<g id="edge74" class="edge">
<title>v_proj_0_0_2&#45;&gt;attn_0_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2015.62,-6367.66C2004.62,-6356.08 1991.8,-6344.15 1978.5,-6335 1962.68,-6324.13 1944.18,-6314.86 1926.5,-6307.33"/>
<polygon fill="red" stroke="red" points="1927.37,-6303.9 1916.79,-6303.33 1924.7,-6310.37 1927.37,-6303.9"/>
<text text-anchor="middle" x="2034.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_0_0_3 -->
<g id="node64" class="node">
<title>attn_0_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="2348.5,-6317 2232.5,-6317 2232.5,-6249 2348.5,-6249 2348.5,-6317"/>
<text text-anchor="middle" x="2290.5" y="-6301.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2290.5" y="-6286.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="2290.5" y="-6271.8" font-family="monospace" font-size="14.00">Heads[0&#45;3]</text>
<text text-anchor="middle" x="2290.5" y="-6256.8" font-family="monospace" font-size="14.00">Dim[384&#45;511]</text>
</g>
<!-- q_proj_0_0_3&#45;&gt;attn_0_0_3 -->
<g id="edge78" class="edge">
<title>q_proj_0_0_3&#45;&gt;attn_0_0_3</title>
<path fill="none" stroke="black" d="M2256.87,-6367.73C2262.14,-6354.61 2268,-6340.03 2273.32,-6326.77"/>
<polygon fill="black" stroke="black" points="2276.62,-6327.96 2277.09,-6317.38 2270.12,-6325.35 2276.62,-6327.96"/>
</g>
<!-- q_proj_0_0_3&#45;&gt;attn_0_0_3 -->
<g id="edge79" class="edge">
<title>q_proj_0_0_3&#45;&gt;attn_0_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2268.77,-6367.97C2272.06,-6362.12 2275.1,-6356.03 2277.5,-6350 2280.36,-6342.83 2282.6,-6334.97 2284.37,-6327.25"/>
<polygon fill="red" stroke="red" points="2287.84,-6327.75 2286.42,-6317.25 2280.98,-6326.34 2287.84,-6327.75"/>
<text text-anchor="middle" x="2320.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_0_0_3&#45;&gt;attn_0_0_3 -->
<g id="edge80" class="edge">
<title>k_proj_0_0_3&#45;&gt;attn_0_0_3</title>
<path fill="none" stroke="black" d="M2396,-6367.77C2385.63,-6356.69 2373.98,-6345 2362.5,-6335 2357.88,-6330.97 2352.94,-6326.96 2347.9,-6323.05"/>
<polygon fill="black" stroke="black" points="2350.01,-6320.26 2339.92,-6317.01 2345.78,-6325.84 2350.01,-6320.26"/>
</g>
<!-- k_proj_0_0_3&#45;&gt;attn_0_0_3 -->
<g id="edge81" class="edge">
<title>k_proj_0_0_3&#45;&gt;attn_0_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2410.67,-6367.96C2403.45,-6356.39 2394.59,-6344.39 2384.5,-6335 2376.49,-6327.54 2367.18,-6320.82 2357.6,-6314.88"/>
<polygon fill="red" stroke="red" points="2359.14,-6311.72 2348.75,-6309.65 2355.58,-6317.75 2359.14,-6311.72"/>
<text text-anchor="middle" x="2435.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_0_0_3&#45;&gt;attn_0_0_3 -->
<g id="edge82" class="edge">
<title>v_proj_0_0_3&#45;&gt;attn_0_0_3</title>
<path fill="none" stroke="black" d="M2549.68,-6367.96C2526.99,-6356.32 2501.6,-6344.28 2477.5,-6335 2439.04,-6320.18 2394.57,-6307.87 2358.65,-6299.06"/>
<polygon fill="black" stroke="black" points="2359.3,-6295.61 2348.76,-6296.66 2357.66,-6302.42 2359.3,-6295.61"/>
</g>
<!-- v_proj_0_0_3&#45;&gt;attn_0_0_3 -->
<g id="edge83" class="edge">
<title>v_proj_0_0_3&#45;&gt;attn_0_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2567.8,-6367.84C2549.66,-6355.85 2528.88,-6343.65 2508.5,-6335 2460.37,-6314.58 2402.62,-6301.54 2358.66,-6293.76"/>
<polygon fill="red" stroke="red" points="2359.1,-6290.28 2348.65,-6292.03 2357.91,-6297.18 2359.1,-6290.28"/>
<text text-anchor="middle" x="2576.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_0_1_0 -->
<g id="node66" class="node">
<title>attn_0_1_0</title>
<polygon fill="#ffccff" stroke="black" points="3081,-6317 2982,-6317 2982,-6249 3081,-6249 3081,-6317"/>
<text text-anchor="middle" x="3031.5" y="-6301.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="3031.5" y="-6286.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3031.5" y="-6271.8" font-family="monospace" font-size="14.00">Heads[4&#45;7]</text>
<text text-anchor="middle" x="3031.5" y="-6256.8" font-family="monospace" font-size="14.00">Dim[0&#45;127]</text>
</g>
<!-- q_proj_0_1_0&#45;&gt;attn_0_1_0 -->
<g id="edge87" class="edge">
<title>q_proj_0_1_0&#45;&gt;attn_0_1_0</title>
<path fill="none" stroke="black" d="M2841.8,-6367.63C2851.65,-6355.77 2863.51,-6343.7 2876.5,-6335 2905.05,-6315.88 2941.34,-6303.43 2971.63,-6295.62"/>
<polygon fill="black" stroke="black" points="2972.78,-6298.94 2981.65,-6293.15 2971.1,-6292.15 2972.78,-6298.94"/>
</g>
<!-- q_proj_0_1_0&#45;&gt;attn_0_1_0 -->
<g id="edge88" class="edge">
<title>q_proj_0_1_0&#45;&gt;attn_0_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2880.8,-6367.98C2899.11,-6357.13 2919,-6345.5 2937.5,-6335 2948.82,-6328.57 2961,-6321.84 2972.71,-6315.45"/>
<polygon fill="red" stroke="red" points="2974.43,-6318.5 2981.55,-6310.65 2971.09,-6312.35 2974.43,-6318.5"/>
<text text-anchor="middle" x="2975.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_0_1_0&#45;&gt;attn_0_1_0 -->
<g id="edge89" class="edge">
<title>k_proj_0_1_0&#45;&gt;attn_0_1_0</title>
<path fill="none" stroke="black" d="M3013.34,-6367.73C3016.16,-6354.74 3019.29,-6340.31 3022.14,-6327.15"/>
<polygon fill="black" stroke="black" points="3025.56,-6327.89 3024.26,-6317.38 3018.72,-6326.41 3025.56,-6327.89"/>
</g>
<!-- k_proj_0_1_0&#45;&gt;attn_0_1_0 -->
<g id="edge90" class="edge">
<title>k_proj_0_1_0&#45;&gt;attn_0_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3027.57,-6367.84C3030.01,-6362.01 3032.1,-6355.96 3033.5,-6350 3035.19,-6342.79 3035.9,-6335.01 3036.01,-6327.41"/>
<polygon fill="red" stroke="red" points="3039.51,-6327.17 3035.84,-6317.23 3032.51,-6327.29 3039.51,-6327.17"/>
<text text-anchor="middle" x="3074.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_0_1_0&#45;&gt;attn_0_1_0 -->
<g id="edge91" class="edge">
<title>v_proj_0_1_0&#45;&gt;attn_0_1_0</title>
<path fill="none" stroke="black" d="M3155.11,-6367.89C3143.13,-6356.69 3129.67,-6344.91 3116.5,-6335 3108.16,-6328.73 3099.01,-6322.57 3089.89,-6316.82"/>
<polygon fill="black" stroke="black" points="3091.53,-6313.72 3081.18,-6311.44 3087.85,-6319.67 3091.53,-6313.72"/>
</g>
<!-- v_proj_0_1_0&#45;&gt;attn_0_1_0 -->
<g id="edge92" class="edge">
<title>v_proj_0_1_0&#45;&gt;attn_0_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3170.43,-6367.67C3161.95,-6356.09 3151.75,-6344.15 3140.5,-6335 3125.73,-6322.98 3107.67,-6313.06 3090.52,-6305.26"/>
<polygon fill="red" stroke="red" points="3091.68,-6301.95 3081.12,-6301.15 3088.88,-6308.36 3091.68,-6301.95"/>
<text text-anchor="middle" x="3193.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_0_1_1 -->
<g id="node69" class="node">
<title>attn_0_1_1</title>
<polygon fill="#ccffff" stroke="black" points="3662.5,-6317 3546.5,-6317 3546.5,-6249 3662.5,-6249 3662.5,-6317"/>
<text text-anchor="middle" x="3604.5" y="-6301.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3604.5" y="-6286.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3604.5" y="-6271.8" font-family="monospace" font-size="14.00">Heads[4&#45;7]</text>
<text text-anchor="middle" x="3604.5" y="-6256.8" font-family="monospace" font-size="14.00">Dim[128&#45;255]</text>
</g>
<!-- q_proj_0_1_1&#45;&gt;attn_0_1_1 -->
<g id="edge96" class="edge">
<title>q_proj_0_1_1&#45;&gt;attn_0_1_1</title>
<path fill="none" stroke="black" d="M3414.8,-6367.63C3424.65,-6355.77 3436.51,-6343.7 3449.5,-6335 3475.5,-6317.59 3507.93,-6305.71 3536.39,-6297.82"/>
<polygon fill="black" stroke="black" points="3537.51,-6301.15 3546.28,-6295.2 3535.71,-6294.38 3537.51,-6301.15"/>
</g>
<!-- q_proj_0_1_1&#45;&gt;attn_0_1_1 -->
<g id="edge97" class="edge">
<title>q_proj_0_1_1&#45;&gt;attn_0_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3453.8,-6367.98C3472.11,-6357.13 3492,-6345.5 3510.5,-6335 3519.16,-6330.09 3528.32,-6324.99 3537.38,-6320.01"/>
<polygon fill="red" stroke="red" points="3539.3,-6322.95 3546.39,-6315.08 3535.94,-6316.81 3539.3,-6322.95"/>
<text text-anchor="middle" x="3548.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_0_1_1&#45;&gt;attn_0_1_1 -->
<g id="edge98" class="edge">
<title>k_proj_0_1_1&#45;&gt;attn_0_1_1</title>
<path fill="none" stroke="black" d="M3586.34,-6367.73C3589.16,-6354.74 3592.29,-6340.31 3595.14,-6327.15"/>
<polygon fill="black" stroke="black" points="3598.56,-6327.89 3597.26,-6317.38 3591.72,-6326.41 3598.56,-6327.89"/>
</g>
<!-- k_proj_0_1_1&#45;&gt;attn_0_1_1 -->
<g id="edge99" class="edge">
<title>k_proj_0_1_1&#45;&gt;attn_0_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3600.57,-6367.84C3603.01,-6362.01 3605.1,-6355.96 3606.5,-6350 3608.19,-6342.79 3608.9,-6335.01 3609.01,-6327.41"/>
<polygon fill="red" stroke="red" points="3612.51,-6327.17 3608.84,-6317.23 3605.51,-6327.29 3612.51,-6327.17"/>
<text text-anchor="middle" x="3647.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_0_1_1&#45;&gt;attn_0_1_1 -->
<g id="edge100" class="edge">
<title>v_proj_0_1_1&#45;&gt;attn_0_1_1</title>
<path fill="none" stroke="black" d="M3728.11,-6367.89C3716.13,-6356.69 3702.67,-6344.91 3689.5,-6335 3683.73,-6330.66 3677.57,-6326.38 3671.31,-6322.24"/>
<polygon fill="black" stroke="black" points="3673.02,-6319.18 3662.72,-6316.71 3669.23,-6325.07 3673.02,-6319.18"/>
</g>
<!-- v_proj_0_1_1&#45;&gt;attn_0_1_1 -->
<g id="edge101" class="edge">
<title>v_proj_0_1_1&#45;&gt;attn_0_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3743.43,-6367.67C3734.95,-6356.09 3724.75,-6344.15 3713.5,-6335 3701.2,-6324.99 3686.62,-6316.44 3672.19,-6309.36"/>
<polygon fill="red" stroke="red" points="3673.29,-6306 3662.75,-6304.91 3670.3,-6312.34 3673.29,-6306"/>
<text text-anchor="middle" x="3766.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_0_1_2 -->
<g id="node71" class="node">
<title>attn_0_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="4208.5,-6317 4092.5,-6317 4092.5,-6249 4208.5,-6249 4208.5,-6317"/>
<text text-anchor="middle" x="4150.5" y="-6301.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="4150.5" y="-6286.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4150.5" y="-6271.8" font-family="monospace" font-size="14.00">Heads[4&#45;7]</text>
<text text-anchor="middle" x="4150.5" y="-6256.8" font-family="monospace" font-size="14.00">Dim[256&#45;383]</text>
</g>
<!-- q_proj_0_1_2&#45;&gt;attn_0_1_2 -->
<g id="edge105" class="edge">
<title>q_proj_0_1_2&#45;&gt;attn_0_1_2</title>
<path fill="none" stroke="black" d="M3977.83,-6367.68C3984.77,-6355.82 3993.67,-6343.74 4004.5,-6335 4026.83,-6316.99 4055.95,-6305.13 4082.31,-6297.42"/>
<polygon fill="black" stroke="black" points="4083.55,-6300.71 4092.26,-6294.67 4081.68,-6293.96 4083.55,-6300.71"/>
</g>
<!-- q_proj_0_1_2&#45;&gt;attn_0_1_2 -->
<g id="edge106" class="edge">
<title>q_proj_0_1_2&#45;&gt;attn_0_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4020.44,-6367.87C4036.67,-6357.13 4054.22,-6345.58 4070.5,-6335 4076.67,-6330.99 4083.13,-6326.83 4089.58,-6322.68"/>
<polygon fill="red" stroke="red" points="4091.81,-6325.41 4098.35,-6317.06 4088.04,-6319.51 4091.81,-6325.41"/>
<text text-anchor="middle" x="4108.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_0_1_2&#45;&gt;attn_0_1_2 -->
<g id="edge107" class="edge">
<title>k_proj_0_1_2&#45;&gt;attn_0_1_2</title>
<path fill="none" stroke="black" d="M4150.5,-6367.73C4150.5,-6354.86 4150.5,-6340.6 4150.5,-6327.54"/>
<polygon fill="black" stroke="black" points="4154,-6327.38 4150.5,-6317.38 4147,-6327.38 4154,-6327.38"/>
</g>
<!-- k_proj_0_1_2&#45;&gt;attn_0_1_2 -->
<g id="edge108" class="edge">
<title>k_proj_0_1_2&#45;&gt;attn_0_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4163.01,-6367.81C4164.97,-6357.17 4165.94,-6345.68 4164.5,-6335 4164.16,-6332.45 4163.72,-6329.85 4163.22,-6327.24"/>
<polygon fill="red" stroke="red" points="4166.57,-6326.21 4160.99,-6317.2 4159.74,-6327.72 4166.57,-6326.21"/>
<text text-anchor="middle" x="4203.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_0_1_2&#45;&gt;attn_0_1_2 -->
<g id="edge109" class="edge">
<title>v_proj_0_1_2&#45;&gt;attn_0_1_2</title>
<path fill="none" stroke="black" d="M4291.29,-6367.64C4276.85,-6356.56 4260.84,-6344.9 4245.5,-6335 4236.59,-6329.25 4226.97,-6323.55 4217.39,-6318.15"/>
<polygon fill="black" stroke="black" points="4219.07,-6315.08 4208.63,-6313.29 4215.67,-6321.2 4219.07,-6315.08"/>
</g>
<!-- v_proj_0_1_2&#45;&gt;attn_0_1_2 -->
<g id="edge110" class="edge">
<title>v_proj_0_1_2&#45;&gt;attn_0_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4307.62,-6367.66C4296.62,-6356.08 4283.8,-6344.15 4270.5,-6335 4254.68,-6324.13 4236.18,-6314.86 4218.5,-6307.33"/>
<polygon fill="red" stroke="red" points="4219.37,-6303.9 4208.79,-6303.33 4216.7,-6310.37 4219.37,-6303.9"/>
<text text-anchor="middle" x="4326.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_0_1_3 -->
<g id="node73" class="node">
<title>attn_0_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="4725.5,-6317 4609.5,-6317 4609.5,-6249 4725.5,-6249 4725.5,-6317"/>
<text text-anchor="middle" x="4667.5" y="-6301.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="4667.5" y="-6286.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4667.5" y="-6271.8" font-family="monospace" font-size="14.00">Heads[4&#45;7]</text>
<text text-anchor="middle" x="4667.5" y="-6256.8" font-family="monospace" font-size="14.00">Dim[384&#45;511]</text>
</g>
<!-- q_proj_0_1_3&#45;&gt;attn_0_1_3 -->
<g id="edge114" class="edge">
<title>q_proj_0_1_3&#45;&gt;attn_0_1_3</title>
<path fill="none" stroke="black" d="M4547.42,-6367.79C4553.06,-6356.22 4560.37,-6344.25 4569.5,-6335 4578.38,-6326 4589.17,-6318.26 4600.32,-6311.72"/>
<polygon fill="black" stroke="black" points="4602.26,-6314.65 4609.3,-6306.73 4598.86,-6308.53 4602.26,-6314.65"/>
</g>
<!-- q_proj_0_1_3&#45;&gt;attn_0_1_3 -->
<g id="edge115" class="edge">
<title>q_proj_0_1_3&#45;&gt;attn_0_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4575.23,-6367.86C4586.63,-6357.12 4598.99,-6345.57 4610.5,-6335 4614.47,-6331.35 4618.62,-6327.58 4622.79,-6323.81"/>
<polygon fill="red" stroke="red" points="4625.19,-6326.35 4630.27,-6317.06 4620.5,-6321.15 4625.19,-6326.35"/>
<text text-anchor="middle" x="4648.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_0_1_3&#45;&gt;attn_0_1_3 -->
<g id="edge116" class="edge">
<title>k_proj_0_1_3&#45;&gt;attn_0_1_3</title>
<path fill="none" stroke="black" d="M4705.16,-6367.73C4699.26,-6354.61 4692.7,-6340.03 4686.74,-6326.77"/>
<polygon fill="black" stroke="black" points="4689.81,-6325.06 4682.51,-6317.38 4683.42,-6327.93 4689.81,-6325.06"/>
</g>
<!-- k_proj_0_1_3&#45;&gt;attn_0_1_3 -->
<g id="edge117" class="edge">
<title>k_proj_0_1_3&#45;&gt;attn_0_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4718.74,-6367.72C4716.52,-6356.76 4713.26,-6345.14 4708.5,-6335 4707.01,-6331.82 4705.27,-6328.66 4703.38,-6325.57"/>
<polygon fill="red" stroke="red" points="4706.17,-6323.43 4697.7,-6317.06 4700.34,-6327.32 4706.17,-6323.43"/>
<text text-anchor="middle" x="4752.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_0_1_3&#45;&gt;attn_0_1_3 -->
<g id="edge118" class="edge">
<title>v_proj_0_1_3&#45;&gt;attn_0_1_3</title>
<path fill="none" stroke="black" d="M4852.73,-6367.94C4834.35,-6356.62 4813.93,-6344.76 4794.5,-6335 4775.62,-6325.51 4754.52,-6316.46 4735.04,-6308.68"/>
<polygon fill="black" stroke="black" points="4736.2,-6305.38 4725.62,-6304.98 4733.64,-6311.9 4736.2,-6305.38"/>
</g>
<!-- v_proj_0_1_3&#45;&gt;attn_0_1_3 -->
<g id="edge119" class="edge">
<title>v_proj_0_1_3&#45;&gt;attn_0_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4869.97,-6367.67C4855.58,-6355.96 4839.04,-6343.95 4822.5,-6335 4795.42,-6320.35 4763.4,-6308.94 4735.51,-6300.67"/>
<polygon fill="red" stroke="red" points="4736.41,-6297.29 4725.83,-6297.88 4734.47,-6304.01 4736.41,-6297.29"/>
<text text-anchor="middle" x="4882.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_0_2_0 -->
<g id="node75" class="node">
<title>attn_0_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="5471,-6317 5364,-6317 5364,-6249 5471,-6249 5471,-6317"/>
<text text-anchor="middle" x="5417.5" y="-6301.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5417.5" y="-6286.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5417.5" y="-6271.8" font-family="monospace" font-size="14.00">Heads[8&#45;11]</text>
<text text-anchor="middle" x="5417.5" y="-6256.8" font-family="monospace" font-size="14.00">Dim[0&#45;127]</text>
</g>
<!-- q_proj_0_2_0&#45;&gt;attn_0_2_0 -->
<g id="edge123" class="edge">
<title>q_proj_0_2_0&#45;&gt;attn_0_2_0</title>
<path fill="none" stroke="black" d="M5140.69,-6367.63C5153.09,-6355.49 5167.86,-6343.24 5183.5,-6335 5236.72,-6306.94 5304.55,-6294.31 5353.45,-6288.63"/>
<polygon fill="black" stroke="black" points="5354.03,-6292.08 5363.59,-6287.52 5353.27,-6285.13 5354.03,-6292.08"/>
</g>
<!-- q_proj_0_2_0&#45;&gt;attn_0_2_0 -->
<g id="edge124" class="edge">
<title>q_proj_0_2_0&#45;&gt;attn_0_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5175.08,-6367.89C5196.58,-6356.31 5220.63,-6344.33 5243.5,-6335 5279.03,-6320.51 5320.17,-6308.26 5353.53,-6299.39"/>
<polygon fill="red" stroke="red" points="5354.83,-6302.67 5363.61,-6296.75 5353.05,-6295.9 5354.83,-6302.67"/>
<text text-anchor="middle" x="5281.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_0_2_0&#45;&gt;attn_0_2_0 -->
<g id="edge125" class="edge">
<title>k_proj_0_2_0&#45;&gt;attn_0_2_0</title>
<path fill="none" stroke="black" d="M5311.99,-6367.78C5317.61,-6356.33 5324.78,-6344.44 5333.5,-6335 5339.94,-6328.02 5347.56,-6321.67 5355.53,-6316"/>
<polygon fill="black" stroke="black" points="5357.59,-6318.83 5363.93,-6310.34 5353.68,-6313.02 5357.59,-6318.83"/>
</g>
<!-- k_proj_0_2_0&#45;&gt;attn_0_2_0 -->
<g id="edge126" class="edge">
<title>k_proj_0_2_0&#45;&gt;attn_0_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5334.84,-6367.89C5345.07,-6357.15 5356.16,-6345.59 5366.5,-6335 5369.88,-6331.54 5373.39,-6327.97 5376.93,-6324.39"/>
<polygon fill="red" stroke="red" points="5379.63,-6326.64 5384.19,-6317.08 5374.66,-6321.71 5379.63,-6326.64"/>
<text text-anchor="middle" x="5404.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_0_2_0&#45;&gt;attn_0_2_0 -->
<g id="edge127" class="edge">
<title>v_proj_0_2_0&#45;&gt;attn_0_2_0</title>
<path fill="none" stroke="black" d="M5464.58,-6367.73C5457.13,-6354.48 5448.84,-6339.75 5441.33,-6326.38"/>
<polygon fill="black" stroke="black" points="5444.22,-6324.38 5436.27,-6317.38 5438.12,-6327.81 5444.22,-6324.38"/>
</g>
<!-- v_proj_0_2_0&#45;&gt;attn_0_2_0 -->
<g id="edge128" class="edge">
<title>v_proj_0_2_0&#45;&gt;attn_0_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5478.27,-6367.86C5474.84,-6356.79 5470.32,-6345.07 5464.5,-6335 5462.61,-6331.73 5460.48,-6328.5 5458.2,-6325.34"/>
<polygon fill="red" stroke="red" points="5460.75,-6322.93 5451.85,-6317.19 5455.23,-6327.23 5460.75,-6322.93"/>
<text text-anchor="middle" x="5509.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_0_2_1 -->
<g id="node78" class="node">
<title>attn_0_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="5954.5,-6317 5838.5,-6317 5838.5,-6249 5954.5,-6249 5954.5,-6317"/>
<text text-anchor="middle" x="5896.5" y="-6301.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5896.5" y="-6286.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5896.5" y="-6271.8" font-family="monospace" font-size="14.00">Heads[8&#45;11]</text>
<text text-anchor="middle" x="5896.5" y="-6256.8" font-family="monospace" font-size="14.00">Dim[128&#45;255]</text>
</g>
<!-- q_proj_0_2_1&#45;&gt;attn_0_2_1 -->
<g id="edge132" class="edge">
<title>q_proj_0_2_1&#45;&gt;attn_0_2_1</title>
<path fill="none" stroke="black" d="M5706.8,-6367.63C5716.65,-6355.77 5728.51,-6343.7 5741.5,-6335 5767.5,-6317.59 5799.93,-6305.71 5828.39,-6297.82"/>
<polygon fill="black" stroke="black" points="5829.51,-6301.15 5838.28,-6295.2 5827.71,-6294.38 5829.51,-6301.15"/>
</g>
<!-- q_proj_0_2_1&#45;&gt;attn_0_2_1 -->
<g id="edge133" class="edge">
<title>q_proj_0_2_1&#45;&gt;attn_0_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5745.8,-6367.98C5764.11,-6357.13 5784,-6345.5 5802.5,-6335 5811.16,-6330.09 5820.32,-6324.99 5829.38,-6320.01"/>
<polygon fill="red" stroke="red" points="5831.3,-6322.95 5838.39,-6315.08 5827.94,-6316.81 5831.3,-6322.95"/>
<text text-anchor="middle" x="5840.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_0_2_1&#45;&gt;attn_0_2_1 -->
<g id="edge134" class="edge">
<title>k_proj_0_2_1&#45;&gt;attn_0_2_1</title>
<path fill="none" stroke="black" d="M5878.34,-6367.73C5881.16,-6354.74 5884.29,-6340.31 5887.14,-6327.15"/>
<polygon fill="black" stroke="black" points="5890.56,-6327.89 5889.26,-6317.38 5883.72,-6326.41 5890.56,-6327.89"/>
</g>
<!-- k_proj_0_2_1&#45;&gt;attn_0_2_1 -->
<g id="edge135" class="edge">
<title>k_proj_0_2_1&#45;&gt;attn_0_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5892.57,-6367.84C5895.01,-6362.01 5897.1,-6355.96 5898.5,-6350 5900.19,-6342.79 5900.9,-6335.01 5901.01,-6327.41"/>
<polygon fill="red" stroke="red" points="5904.51,-6327.17 5900.84,-6317.23 5897.51,-6327.29 5904.51,-6327.17"/>
<text text-anchor="middle" x="5939.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_0_2_1&#45;&gt;attn_0_2_1 -->
<g id="edge136" class="edge">
<title>v_proj_0_2_1&#45;&gt;attn_0_2_1</title>
<path fill="none" stroke="black" d="M6020.11,-6367.89C6008.13,-6356.69 5994.67,-6344.91 5981.5,-6335 5975.73,-6330.66 5969.57,-6326.38 5963.31,-6322.24"/>
<polygon fill="black" stroke="black" points="5965.02,-6319.18 5954.72,-6316.71 5961.23,-6325.07 5965.02,-6319.18"/>
</g>
<!-- v_proj_0_2_1&#45;&gt;attn_0_2_1 -->
<g id="edge137" class="edge">
<title>v_proj_0_2_1&#45;&gt;attn_0_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6035.43,-6367.67C6026.95,-6356.09 6016.75,-6344.15 6005.5,-6335 5993.2,-6324.99 5978.62,-6316.44 5964.19,-6309.36"/>
<polygon fill="red" stroke="red" points="5965.29,-6306 5954.75,-6304.91 5962.3,-6312.34 5965.29,-6306"/>
<text text-anchor="middle" x="6058.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_0_2_2 -->
<g id="node80" class="node">
<title>attn_0_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="6468.5,-6317 6352.5,-6317 6352.5,-6249 6468.5,-6249 6468.5,-6317"/>
<text text-anchor="middle" x="6410.5" y="-6301.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6410.5" y="-6286.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6410.5" y="-6271.8" font-family="monospace" font-size="14.00">Heads[8&#45;11]</text>
<text text-anchor="middle" x="6410.5" y="-6256.8" font-family="monospace" font-size="14.00">Dim[256&#45;383]</text>
</g>
<!-- q_proj_0_2_2&#45;&gt;attn_0_2_2 -->
<g id="edge141" class="edge">
<title>q_proj_0_2_2&#45;&gt;attn_0_2_2</title>
<path fill="none" stroke="black" d="M6275.49,-6367.72C6283.66,-6356.14 6293.53,-6344.19 6304.5,-6335 6315.95,-6325.41 6329.51,-6317.14 6343.03,-6310.21"/>
<polygon fill="black" stroke="black" points="6344.93,-6313.18 6352.37,-6305.63 6341.85,-6306.9 6344.93,-6313.18"/>
</g>
<!-- q_proj_0_2_2&#45;&gt;attn_0_2_2 -->
<g id="edge142" class="edge">
<title>q_proj_0_2_2&#45;&gt;attn_0_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6302.59,-6367.96C6316.18,-6357.22 6330.88,-6345.64 6344.5,-6335 6349.37,-6331.2 6354.44,-6327.24 6359.53,-6323.3"/>
<polygon fill="red" stroke="red" points="6361.73,-6326.02 6367.49,-6317.13 6357.44,-6320.49 6361.73,-6326.02"/>
<text text-anchor="middle" x="6382.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_0_2_2&#45;&gt;attn_0_2_2 -->
<g id="edge143" class="edge">
<title>k_proj_0_2_2&#45;&gt;attn_0_2_2</title>
<path fill="none" stroke="black" d="M6432.02,-6367.73C6428.68,-6354.74 6424.97,-6340.31 6421.59,-6327.15"/>
<polygon fill="black" stroke="black" points="6424.96,-6326.19 6419.08,-6317.38 6418.18,-6327.94 6424.96,-6326.19"/>
</g>
<!-- k_proj_0_2_2&#45;&gt;attn_0_2_2 -->
<g id="edge144" class="edge">
<title>k_proj_0_2_2&#45;&gt;attn_0_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6445.02,-6367.89C6444.72,-6357.04 6443.49,-6345.43 6440.5,-6335 6439.66,-6332.08 6438.62,-6329.16 6437.43,-6326.27"/>
<polygon fill="red" stroke="red" points="6440.6,-6324.79 6433.19,-6317.21 6434.26,-6327.75 6440.6,-6324.79"/>
<text text-anchor="middle" x="6481.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_0_2_2&#45;&gt;attn_0_2_2 -->
<g id="edge145" class="edge">
<title>v_proj_0_2_2&#45;&gt;attn_0_2_2</title>
<path fill="none" stroke="black" d="M6576.68,-6367.94C6559.91,-6356.69 6541.27,-6344.86 6523.5,-6335 6509.08,-6327 6493.18,-6319.22 6477.96,-6312.25"/>
<polygon fill="black" stroke="black" points="6479.15,-6308.95 6468.6,-6308.02 6476.27,-6315.33 6479.15,-6308.95"/>
</g>
<!-- v_proj_0_2_2&#45;&gt;attn_0_2_2 -->
<g id="edge146" class="edge">
<title>v_proj_0_2_2&#45;&gt;attn_0_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6593.69,-6367.81C6580.71,-6356.1 6565.71,-6344.06 6550.5,-6335 6528.23,-6321.74 6501.95,-6311.05 6478.2,-6302.94"/>
<polygon fill="red" stroke="red" points="6479.14,-6299.57 6468.55,-6299.74 6476.94,-6306.21 6479.14,-6299.57"/>
<text text-anchor="middle" x="6609.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_0_2_3 -->
<g id="node82" class="node">
<title>attn_0_2_3</title>
<polygon fill="#aaffff" stroke="black" points="7011.5,-6317 6895.5,-6317 6895.5,-6249 7011.5,-6249 7011.5,-6317"/>
<text text-anchor="middle" x="6953.5" y="-6301.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6953.5" y="-6286.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6953.5" y="-6271.8" font-family="monospace" font-size="14.00">Heads[8&#45;11]</text>
<text text-anchor="middle" x="6953.5" y="-6256.8" font-family="monospace" font-size="14.00">Dim[384&#45;511]</text>
</g>
<!-- q_proj_0_2_3&#45;&gt;attn_0_2_3 -->
<g id="edge150" class="edge">
<title>q_proj_0_2_3&#45;&gt;attn_0_2_3</title>
<path fill="none" stroke="black" d="M6849.89,-6367.9C6857.96,-6356.58 6867.43,-6344.73 6877.5,-6335 6881.67,-6330.97 6886.2,-6327.05 6890.9,-6323.29"/>
<polygon fill="black" stroke="black" points="6893.12,-6325.99 6898.93,-6317.13 6888.86,-6320.44 6893.12,-6325.99"/>
</g>
<!-- q_proj_0_2_3&#45;&gt;attn_0_2_3 -->
<g id="edge151" class="edge">
<title>q_proj_0_2_3&#45;&gt;attn_0_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6865.63,-6367.93C6876.6,-6357.18 6888.46,-6345.62 6899.5,-6335 6903.18,-6331.46 6907.02,-6327.79 6910.87,-6324.12"/>
<polygon fill="red" stroke="red" points="6913.42,-6326.53 6918.26,-6317.1 6908.6,-6321.45 6913.42,-6326.53"/>
<text text-anchor="middle" x="6937.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_0_2_3&#45;&gt;attn_0_2_3 -->
<g id="edge152" class="edge">
<title>k_proj_0_2_3&#45;&gt;attn_0_2_3</title>
<path fill="none" stroke="black" d="M6995.62,-6367.62C6990.41,-6356.98 6984.77,-6345.55 6979.5,-6335 6978.06,-6332.11 6976.56,-6329.13 6975.05,-6326.14"/>
<polygon fill="black" stroke="black" points="6978.14,-6324.5 6970.5,-6317.16 6971.9,-6327.66 6978.14,-6324.5"/>
</g>
<!-- k_proj_0_2_3&#45;&gt;attn_0_2_3 -->
<g id="edge153" class="edge">
<title>k_proj_0_2_3&#45;&gt;attn_0_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7009.17,-6367.98C7006.49,-6356.9 7002.74,-6345.16 6997.5,-6335 6995.82,-6331.74 6993.89,-6328.52 6991.8,-6325.37"/>
<polygon fill="red" stroke="red" points="6994.63,-6323.3 6985.95,-6317.23 6988.95,-6327.39 6994.63,-6323.3"/>
<text text-anchor="middle" x="7041.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_0_2_3&#45;&gt;attn_0_2_3 -->
<g id="edge154" class="edge">
<title>v_proj_0_2_3&#45;&gt;attn_0_2_3</title>
<path fill="none" stroke="black" d="M7143.14,-6367.93C7124.3,-6356.61 7103.38,-6344.75 7083.5,-6335 7063.68,-6325.27 7041.51,-6316.01 7021.16,-6308.12"/>
<polygon fill="black" stroke="black" points="7022.25,-6304.78 7011.65,-6304.47 7019.74,-6311.32 7022.25,-6304.78"/>
</g>
<!-- v_proj_0_2_3&#45;&gt;attn_0_2_3 -->
<g id="edge155" class="edge">
<title>v_proj_0_2_3&#45;&gt;attn_0_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7160.38,-6367.67C7145.51,-6355.96 7128.47,-6343.95 7111.5,-6335 7083.45,-6320.2 7050.32,-6308.71 7021.67,-6300.4"/>
<polygon fill="red" stroke="red" points="7022.31,-6296.95 7011.73,-6297.6 7020.41,-6303.68 7022.31,-6296.95"/>
<text text-anchor="middle" x="7172.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_0_3_0 -->
<g id="node84" class="node">
<title>attn_0_3_0</title>
<polygon fill="#ff8888" stroke="black" points="7673.5,-6317 7557.5,-6317 7557.5,-6249 7673.5,-6249 7673.5,-6317"/>
<text text-anchor="middle" x="7615.5" y="-6301.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7615.5" y="-6286.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7615.5" y="-6271.8" font-family="monospace" font-size="14.00">Heads[12&#45;15]</text>
<text text-anchor="middle" x="7615.5" y="-6256.8" font-family="monospace" font-size="14.00">Dim[0&#45;127]</text>
</g>
<!-- q_proj_0_3_0&#45;&gt;attn_0_3_0 -->
<g id="edge159" class="edge">
<title>q_proj_0_3_0&#45;&gt;attn_0_3_0</title>
<path fill="none" stroke="black" d="M7416.48,-6367.75C7423.77,-6355.76 7433.13,-6343.57 7444.5,-6335 7474.21,-6312.61 7513.67,-6300 7547.2,-6292.93"/>
<polygon fill="black" stroke="black" points="7548.27,-6296.28 7557.39,-6290.91 7546.9,-6289.42 7548.27,-6296.28"/>
</g>
<!-- q_proj_0_3_0&#45;&gt;attn_0_3_0 -->
<g id="edge160" class="edge">
<title>q_proj_0_3_0&#45;&gt;attn_0_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7464.8,-6367.98C7483.11,-6357.13 7503,-6345.5 7521.5,-6335 7530.16,-6330.09 7539.32,-6324.99 7548.38,-6320.01"/>
<polygon fill="red" stroke="red" points="7550.3,-6322.95 7557.39,-6315.08 7546.94,-6316.81 7550.3,-6322.95"/>
<text text-anchor="middle" x="7559.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_0_3_0&#45;&gt;attn_0_3_0 -->
<g id="edge161" class="edge">
<title>k_proj_0_3_0&#45;&gt;attn_0_3_0</title>
<path fill="none" stroke="black" d="M7597.34,-6367.73C7600.16,-6354.74 7603.29,-6340.31 7606.14,-6327.15"/>
<polygon fill="black" stroke="black" points="7609.56,-6327.89 7608.26,-6317.38 7602.72,-6326.41 7609.56,-6327.89"/>
</g>
<!-- k_proj_0_3_0&#45;&gt;attn_0_3_0 -->
<g id="edge162" class="edge">
<title>k_proj_0_3_0&#45;&gt;attn_0_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7611.57,-6367.84C7614.01,-6362.01 7616.1,-6355.96 7617.5,-6350 7619.19,-6342.79 7619.9,-6335.01 7620.01,-6327.41"/>
<polygon fill="red" stroke="red" points="7623.51,-6327.17 7619.84,-6317.23 7616.51,-6327.29 7623.51,-6327.17"/>
<text text-anchor="middle" x="7658.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_0_3_0&#45;&gt;attn_0_3_0 -->
<g id="edge163" class="edge">
<title>v_proj_0_3_0&#45;&gt;attn_0_3_0</title>
<path fill="none" stroke="black" d="M7739.11,-6367.89C7727.13,-6356.69 7713.67,-6344.91 7700.5,-6335 7694.73,-6330.66 7688.57,-6326.38 7682.31,-6322.24"/>
<polygon fill="black" stroke="black" points="7684.02,-6319.18 7673.72,-6316.71 7680.23,-6325.07 7684.02,-6319.18"/>
</g>
<!-- v_proj_0_3_0&#45;&gt;attn_0_3_0 -->
<g id="edge164" class="edge">
<title>v_proj_0_3_0&#45;&gt;attn_0_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7754.43,-6367.67C7745.95,-6356.09 7735.75,-6344.15 7724.5,-6335 7712.2,-6324.99 7697.62,-6316.44 7683.19,-6309.36"/>
<polygon fill="red" stroke="red" points="7684.29,-6306 7673.75,-6304.91 7681.3,-6312.34 7684.29,-6306"/>
<text text-anchor="middle" x="7777.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_0_3_1 -->
<g id="node87" class="node">
<title>attn_0_3_1</title>
<polygon fill="#88ff88" stroke="black" points="8219.5,-6317 8103.5,-6317 8103.5,-6249 8219.5,-6249 8219.5,-6317"/>
<text text-anchor="middle" x="8161.5" y="-6301.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="8161.5" y="-6286.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8161.5" y="-6271.8" font-family="monospace" font-size="14.00">Heads[12&#45;15]</text>
<text text-anchor="middle" x="8161.5" y="-6256.8" font-family="monospace" font-size="14.00">Dim[128&#45;255]</text>
</g>
<!-- q_proj_0_3_1&#45;&gt;attn_0_3_1 -->
<g id="edge168" class="edge">
<title>q_proj_0_3_1&#45;&gt;attn_0_3_1</title>
<path fill="none" stroke="black" d="M7988.83,-6367.68C7995.77,-6355.82 8004.67,-6343.74 8015.5,-6335 8037.83,-6316.99 8066.95,-6305.13 8093.31,-6297.42"/>
<polygon fill="black" stroke="black" points="8094.55,-6300.71 8103.26,-6294.67 8092.68,-6293.96 8094.55,-6300.71"/>
</g>
<!-- q_proj_0_3_1&#45;&gt;attn_0_3_1 -->
<g id="edge169" class="edge">
<title>q_proj_0_3_1&#45;&gt;attn_0_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8031.44,-6367.87C8047.67,-6357.13 8065.22,-6345.58 8081.5,-6335 8087.67,-6330.99 8094.13,-6326.83 8100.58,-6322.68"/>
<polygon fill="red" stroke="red" points="8102.81,-6325.41 8109.35,-6317.06 8099.04,-6319.51 8102.81,-6325.41"/>
<text text-anchor="middle" x="8119.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_0_3_1&#45;&gt;attn_0_3_1 -->
<g id="edge170" class="edge">
<title>k_proj_0_3_1&#45;&gt;attn_0_3_1</title>
<path fill="none" stroke="black" d="M8161.5,-6367.73C8161.5,-6354.86 8161.5,-6340.6 8161.5,-6327.54"/>
<polygon fill="black" stroke="black" points="8165,-6327.38 8161.5,-6317.38 8158,-6327.38 8165,-6327.38"/>
</g>
<!-- k_proj_0_3_1&#45;&gt;attn_0_3_1 -->
<g id="edge171" class="edge">
<title>k_proj_0_3_1&#45;&gt;attn_0_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8174.01,-6367.81C8175.97,-6357.17 8176.94,-6345.68 8175.5,-6335 8175.16,-6332.45 8174.72,-6329.85 8174.22,-6327.24"/>
<polygon fill="red" stroke="red" points="8177.57,-6326.21 8171.99,-6317.2 8170.74,-6327.72 8177.57,-6326.21"/>
<text text-anchor="middle" x="8214.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_0_3_1&#45;&gt;attn_0_3_1 -->
<g id="edge172" class="edge">
<title>v_proj_0_3_1&#45;&gt;attn_0_3_1</title>
<path fill="none" stroke="black" d="M8302.29,-6367.64C8287.85,-6356.56 8271.84,-6344.9 8256.5,-6335 8247.59,-6329.25 8237.97,-6323.55 8228.39,-6318.15"/>
<polygon fill="black" stroke="black" points="8230.07,-6315.08 8219.63,-6313.29 8226.67,-6321.2 8230.07,-6315.08"/>
</g>
<!-- v_proj_0_3_1&#45;&gt;attn_0_3_1 -->
<g id="edge173" class="edge">
<title>v_proj_0_3_1&#45;&gt;attn_0_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8318.62,-6367.66C8307.62,-6356.08 8294.8,-6344.15 8281.5,-6335 8265.68,-6324.13 8247.18,-6314.86 8229.5,-6307.33"/>
<polygon fill="red" stroke="red" points="8230.37,-6303.9 8219.79,-6303.33 8227.7,-6310.37 8230.37,-6303.9"/>
<text text-anchor="middle" x="8337.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_0_3_2 -->
<g id="node89" class="node">
<title>attn_0_3_2</title>
<polygon fill="#8888ff" stroke="black" points="8717.5,-6317 8601.5,-6317 8601.5,-6249 8717.5,-6249 8717.5,-6317"/>
<text text-anchor="middle" x="8659.5" y="-6301.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8659.5" y="-6286.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8659.5" y="-6271.8" font-family="monospace" font-size="14.00">Heads[12&#45;15]</text>
<text text-anchor="middle" x="8659.5" y="-6256.8" font-family="monospace" font-size="14.00">Dim[256&#45;383]</text>
</g>
<!-- q_proj_0_3_2&#45;&gt;attn_0_3_2 -->
<g id="edge177" class="edge">
<title>q_proj_0_3_2&#45;&gt;attn_0_3_2</title>
<path fill="none" stroke="black" d="M8559.16,-6367.93C8564.78,-6356.49 8571.91,-6344.56 8580.5,-6335 8584.41,-6330.64 8588.78,-6326.51 8593.4,-6322.61"/>
<polygon fill="black" stroke="black" points="8595.71,-6325.25 8601.37,-6316.29 8591.36,-6319.76 8595.71,-6325.25"/>
</g>
<!-- q_proj_0_3_2&#45;&gt;attn_0_3_2 -->
<g id="edge178" class="edge">
<title>q_proj_0_3_2&#45;&gt;attn_0_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8579.5,-6367.77C8589.15,-6357.03 8599.64,-6345.51 8609.5,-6335 8612.72,-6331.56 8616.09,-6328.02 8619.49,-6324.49"/>
<polygon fill="red" stroke="red" points="8622.04,-6326.89 8626.48,-6317.27 8617.01,-6322.02 8622.04,-6326.89"/>
<text text-anchor="middle" x="8647.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_0_3_2&#45;&gt;attn_0_3_2 -->
<g id="edge179" class="edge">
<title>k_proj_0_3_2&#45;&gt;attn_0_3_2</title>
<path fill="none" stroke="black" d="M8709.94,-6367.73C8701.88,-6354.35 8692.91,-6339.46 8684.8,-6326"/>
<polygon fill="black" stroke="black" points="8687.77,-6324.14 8679.61,-6317.38 8681.77,-6327.75 8687.77,-6324.14"/>
</g>
<!-- k_proj_0_3_2&#45;&gt;attn_0_3_2 -->
<g id="edge180" class="edge">
<title>k_proj_0_3_2&#45;&gt;attn_0_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8723.55,-6367.8C8719.67,-6356.72 8714.68,-6345.02 8708.5,-6335 8706.42,-6331.63 8704.09,-6328.3 8701.6,-6325.05"/>
<polygon fill="red" stroke="red" points="8704.18,-6322.68 8695.14,-6317.17 8698.77,-6327.12 8704.18,-6322.68"/>
<text text-anchor="middle" x="8753.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_0_3_2&#45;&gt;attn_0_3_2 -->
<g id="edge181" class="edge">
<title>v_proj_0_3_2&#45;&gt;attn_0_3_2</title>
<path fill="none" stroke="black" d="M8858.41,-6367.93C8838.49,-6356.62 8816.41,-6344.76 8795.5,-6335 8773.7,-6324.83 8749.27,-6315.16 8727.19,-6307.02"/>
<polygon fill="black" stroke="black" points="8728.15,-6303.65 8717.56,-6303.52 8725.76,-6310.23 8728.15,-6303.65"/>
</g>
<!-- v_proj_0_3_2&#45;&gt;attn_0_3_2 -->
<g id="edge182" class="edge">
<title>v_proj_0_3_2&#45;&gt;attn_0_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8875.93,-6367.89C8859.89,-6356.11 8841.56,-6344.02 8823.5,-6335 8793.42,-6319.99 8758.02,-6308.3 8727.83,-6299.93"/>
<polygon fill="red" stroke="red" points="8728.37,-6296.45 8717.8,-6297.22 8726.54,-6303.21 8728.37,-6296.45"/>
<text text-anchor="middle" x="8884.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_0_3_3 -->
<g id="node91" class="node">
<title>attn_0_3_3</title>
<polygon fill="#ffff88" stroke="black" points="9216.5,-6317 9100.5,-6317 9100.5,-6249 9216.5,-6249 9216.5,-6317"/>
<text text-anchor="middle" x="9158.5" y="-6301.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9158.5" y="-6286.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="9158.5" y="-6271.8" font-family="monospace" font-size="14.00">Heads[12&#45;15]</text>
<text text-anchor="middle" x="9158.5" y="-6256.8" font-family="monospace" font-size="14.00">Dim[384&#45;511]</text>
</g>
<!-- q_proj_0_3_3&#45;&gt;attn_0_3_3 -->
<g id="edge186" class="edge">
<title>q_proj_0_3_3&#45;&gt;attn_0_3_3</title>
<path fill="none" stroke="black" d="M9130.25,-6367.73C9134.64,-6354.74 9139.5,-6340.31 9143.94,-6327.15"/>
<polygon fill="black" stroke="black" points="9147.36,-6327.97 9147.24,-6317.38 9140.73,-6325.74 9147.36,-6327.97"/>
</g>
<!-- q_proj_0_3_3&#45;&gt;attn_0_3_3 -->
<g id="edge187" class="edge">
<title>q_proj_0_3_3&#45;&gt;attn_0_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9144.75,-6367.8C9147.79,-6362.02 9150.5,-6356 9152.5,-6350 9154.9,-6342.79 9156.46,-6334.9 9157.45,-6327.18"/>
<polygon fill="red" stroke="red" points="9160.94,-6327.47 9158.46,-6317.17 9153.98,-6326.77 9160.94,-6327.47"/>
<text text-anchor="middle" x="9193.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_0_3_3&#45;&gt;attn_0_3_3 -->
<g id="edge188" class="edge">
<title>k_proj_0_3_3&#45;&gt;attn_0_3_3</title>
<path fill="none" stroke="black" d="M9270.46,-6367.64C9259.64,-6356.56 9247.48,-6344.9 9235.5,-6335 9230.63,-6330.98 9225.44,-6326.99 9220.14,-6323.12"/>
<polygon fill="black" stroke="black" points="9221.92,-6320.09 9211.75,-6317.13 9217.86,-6325.79 9221.92,-6320.09"/>
</g>
<!-- k_proj_0_3_3&#45;&gt;attn_0_3_3 -->
<g id="edge189" class="edge">
<title>k_proj_0_3_3&#45;&gt;attn_0_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9285.07,-6367.86C9277.37,-6356.29 9268.02,-6344.31 9257.5,-6335 9248.02,-6326.61 9236.91,-6319.17 9225.62,-6312.75"/>
<polygon fill="red" stroke="red" points="9227.02,-6309.53 9216.57,-6307.82 9223.68,-6315.68 9227.02,-6309.53"/>
<text text-anchor="middle" x="9308.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_0_3_3&#45;&gt;attn_0_3_3 -->
<g id="edge190" class="edge">
<title>v_proj_0_3_3&#45;&gt;attn_0_3_3</title>
<path fill="none" stroke="black" d="M9424.13,-6367.92C9400.98,-6356.28 9375.06,-6344.25 9350.5,-6335 9310.21,-6319.82 9263.55,-6307.32 9226.32,-6298.49"/>
<polygon fill="black" stroke="black" points="9227.11,-6295.08 9216.58,-6296.21 9225.52,-6301.9 9227.11,-6295.08"/>
</g>
<!-- v_proj_0_3_3&#45;&gt;attn_0_3_3 -->
<g id="edge191" class="edge">
<title>v_proj_0_3_3&#45;&gt;attn_0_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9441.74,-6367.85C9422.95,-6355.86 9401.47,-6343.66 9380.5,-6335 9330.88,-6314.52 9271.47,-6301.42 9226.6,-6293.63"/>
<polygon fill="red" stroke="red" points="9227.12,-6290.17 9216.68,-6291.96 9225.96,-6297.07 9227.12,-6290.17"/>
<text text-anchor="middle" x="9448.5" y="-6338.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_0_0_0 -->
<g id="node58" class="node">
<title>out_proj_0_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="1413,-6212 1240,-6212 1240,-6129 1413,-6129 1413,-6212"/>
<text text-anchor="middle" x="1326.5" y="-6196.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1326.5" y="-6181.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="1326.5" y="-6166.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1326.5" y="-6151.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1326.5" y="-6136.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_0_0_0&#45;&gt;out_proj_0_0_0 -->
<g id="edge57" class="edge">
<title>attn_0_0_0&#45;&gt;out_proj_0_0_0</title>
<path fill="none" stroke="black" d="M900.09,-6270.49C977.87,-6252.43 1129.94,-6217.13 1229.87,-6193.93"/>
<polygon fill="black" stroke="black" points="1230.73,-6197.33 1239.67,-6191.66 1229.14,-6190.51 1230.73,-6197.33"/>
</g>
<!-- concat_dim_0_0 -->
<g id="node59" class="node">
<title>concat_dim_0_0</title>
<polygon fill="lightyellow" stroke="black" points="1858.5,-6078 1685.5,-6025 1858.5,-5972 2031.5,-6025 1858.5,-6078"/>
<text text-anchor="middle" x="1858.5" y="-6036.3" font-family="monospace" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="1858.5" y="-6021.3" font-family="monospace" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="1858.5" y="-6006.3" font-family="monospace" font-size="14.00">[1024×2048×(4×512)]</text>
</g>
<!-- out_proj_0_0_0&#45;&gt;concat_dim_0_0 -->
<g id="edge58" class="edge">
<title>out_proj_0_0_0&#45;&gt;concat_dim_0_0</title>
<path fill="none" stroke="black" d="M1403.7,-6128.88C1428.92,-6116.9 1457.42,-6104.68 1484.5,-6096 1563.2,-6070.77 1654.31,-6053.48 1726.9,-6042.4"/>
<polygon fill="black" stroke="black" points="1727.65,-6045.82 1737.01,-6040.88 1726.6,-6038.9 1727.65,-6045.82"/>
</g>
<!-- out_proj_0_0_0&#45;&gt;concat_dim_0_0 -->
<g id="edge59" class="edge">
<title>out_proj_0_0_0&#45;&gt;concat_dim_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1413.16,-6146.12C1507.62,-6120.65 1658.55,-6079.93 1758.1,-6053.08"/>
<polygon fill="red" stroke="red" points="1759.13,-6056.43 1767.87,-6050.45 1757.3,-6049.67 1759.13,-6056.43"/>
<text text-anchor="middle" x="1630.5" y="-6099.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_heads_0 -->
<g id="node93" class="node">
<title>concat_heads_0</title>
<polygon fill="lightyellow" stroke="black" points="6192.5,-5935 6027.5,-5882 6192.5,-5829 6357.5,-5882 6192.5,-5935"/>
<text text-anchor="middle" x="6192.5" y="-5893.3" font-family="monospace" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="6192.5" y="-5878.3" font-family="monospace" font-size="14.00">Layer 0</text>
<text text-anchor="middle" x="6192.5" y="-5863.3" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- concat_dim_0_0&#45;&gt;concat_heads_0 -->
<g id="edge195" class="edge">
<title>concat_dim_0_0&#45;&gt;concat_heads_0</title>
<path fill="none" stroke="black" d="M2012.11,-6019C2683.48,-5997.16 5356.65,-5910.19 6035.23,-5888.12"/>
<polygon fill="black" stroke="black" points="6035.44,-5891.61 6045.32,-5887.79 6035.21,-5884.62 6035.44,-5891.61"/>
</g>
<!-- out_proj_0_0_1 -->
<g id="node61" class="node">
<title>out_proj_0_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="1719,-6212 1546,-6212 1546,-6129 1719,-6129 1719,-6212"/>
<text text-anchor="middle" x="1632.5" y="-6196.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1632.5" y="-6181.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="1632.5" y="-6166.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1632.5" y="-6151.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1632.5" y="-6136.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_0_0_1&#45;&gt;out_proj_0_0_1 -->
<g id="edge66" class="edge">
<title>attn_0_0_1&#45;&gt;out_proj_0_0_1</title>
<path fill="none" stroke="black" d="M1369.63,-6261.99C1415.99,-6246.03 1481.9,-6223.34 1536.13,-6204.67"/>
<polygon fill="black" stroke="black" points="1537.45,-6207.92 1545.76,-6201.36 1535.17,-6201.3 1537.45,-6207.92"/>
</g>
<!-- out_proj_0_0_1&#45;&gt;concat_dim_0_0 -->
<g id="edge67" class="edge">
<title>out_proj_0_0_1&#45;&gt;concat_dim_0_0</title>
<path fill="none" stroke="black" d="M1670.91,-6128.77C1682.92,-6117.32 1696.67,-6105.44 1710.5,-6096 1730.43,-6082.4 1753.41,-6070.13 1775.23,-6059.79"/>
<polygon fill="black" stroke="black" points="1776.91,-6062.87 1784.5,-6055.48 1773.96,-6056.53 1776.91,-6062.87"/>
</g>
<!-- out_proj_0_0_1&#45;&gt;concat_dim_0_0 -->
<g id="edge68" class="edge">
<title>out_proj_0_0_1&#45;&gt;concat_dim_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1696.36,-6128.95C1727.14,-6109.41 1763.96,-6086.03 1794.73,-6066.49"/>
<polygon fill="red" stroke="red" points="1796.68,-6069.4 1803.24,-6061.09 1792.92,-6063.49 1796.68,-6069.4"/>
<text text-anchor="middle" x="1783.5" y="-6099.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_0_0_2 -->
<g id="node63" class="node">
<title>out_proj_0_0_2</title>
<polygon fill="#ccccff" stroke="black" points="1945,-6212 1772,-6212 1772,-6129 1945,-6129 1945,-6212"/>
<text text-anchor="middle" x="1858.5" y="-6196.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1858.5" y="-6181.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="1858.5" y="-6166.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1858.5" y="-6151.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1858.5" y="-6136.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_0_0_2&#45;&gt;out_proj_0_0_2 -->
<g id="edge75" class="edge">
<title>attn_0_0_2&#45;&gt;out_proj_0_0_2</title>
<path fill="none" stroke="black" d="M1858.5,-6248.85C1858.5,-6240.44 1858.5,-6231.22 1858.5,-6222.16"/>
<polygon fill="black" stroke="black" points="1862,-6222.06 1858.5,-6212.06 1855,-6222.06 1862,-6222.06"/>
</g>
<!-- out_proj_0_0_2&#45;&gt;concat_dim_0_0 -->
<g id="edge76" class="edge">
<title>out_proj_0_0_2&#45;&gt;concat_dim_0_0</title>
<path fill="none" stroke="black" d="M1858.5,-6128.76C1858.5,-6116.22 1858.5,-6102.1 1858.5,-6088.45"/>
<polygon fill="black" stroke="black" points="1862,-6088.13 1858.5,-6078.13 1855,-6088.13 1862,-6088.13"/>
</g>
<!-- out_proj_0_0_2&#45;&gt;concat_dim_0_0 -->
<g id="edge77" class="edge">
<title>out_proj_0_0_2&#45;&gt;concat_dim_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1869.53,-6128.81C1870.76,-6122.87 1871.81,-6116.81 1872.5,-6111 1873.52,-6102.37 1873.35,-6093.27 1872.49,-6084.37"/>
<polygon fill="red" stroke="red" points="1875.96,-6083.92 1871.24,-6074.44 1869.01,-6084.8 1875.96,-6083.92"/>
<text text-anchor="middle" x="1911.5" y="-6099.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_0_0_3 -->
<g id="node65" class="node">
<title>out_proj_0_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="2231,-6212 2058,-6212 2058,-6129 2231,-6129 2231,-6212"/>
<text text-anchor="middle" x="2144.5" y="-6196.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2144.5" y="-6181.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="2144.5" y="-6166.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2144.5" y="-6151.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2144.5" y="-6136.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_0_0_3&#45;&gt;out_proj_0_0_3 -->
<g id="edge84" class="edge">
<title>attn_0_0_3&#45;&gt;out_proj_0_0_3</title>
<path fill="none" stroke="black" d="M2246.7,-6248.85C2234.04,-6239.26 2219.97,-6228.62 2206.43,-6218.37"/>
<polygon fill="black" stroke="black" points="2208.17,-6215.3 2198.08,-6212.06 2203.95,-6220.88 2208.17,-6215.3"/>
</g>
<!-- out_proj_0_0_3&#45;&gt;concat_dim_0_0 -->
<g id="edge85" class="edge">
<title>out_proj_0_0_3&#45;&gt;concat_dim_0_0</title>
<path fill="none" stroke="black" d="M2063.69,-6128.95C2022.38,-6108.23 1972.47,-6083.19 1932.22,-6062.99"/>
<polygon fill="black" stroke="black" points="1933.77,-6059.85 1923.26,-6058.49 1930.63,-6066.11 1933.77,-6059.85"/>
</g>
<!-- out_proj_0_0_3&#45;&gt;concat_dim_0_0 -->
<g id="edge86" class="edge">
<title>out_proj_0_0_3&#45;&gt;concat_dim_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2084.87,-6128.93C2067.11,-6117.61 2047.34,-6105.75 2028.5,-6096 2002,-6082.28 1972.19,-6069.25 1945.02,-6058.23"/>
<polygon fill="red" stroke="red" points="1946.11,-6054.9 1935.52,-6054.42 1943.5,-6061.39 1946.11,-6054.9"/>
<text text-anchor="middle" x="2093.5" y="-6099.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_0_1_0 -->
<g id="node67" class="node">
<title>out_proj_0_1_0</title>
<polygon fill="#ffccff" stroke="black" points="3282,-6212 3109,-6212 3109,-6129 3282,-6129 3282,-6212"/>
<text text-anchor="middle" x="3195.5" y="-6196.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="3195.5" y="-6181.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="3195.5" y="-6166.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3195.5" y="-6151.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3195.5" y="-6136.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_0_1_0&#45;&gt;out_proj_0_1_0 -->
<g id="edge93" class="edge">
<title>attn_0_1_0&#45;&gt;out_proj_0_1_0</title>
<path fill="none" stroke="black" d="M3080.71,-6248.85C3095.19,-6239.08 3111.32,-6228.22 3126.79,-6217.79"/>
<polygon fill="black" stroke="black" points="3128.97,-6220.55 3135.31,-6212.06 3125.06,-6214.74 3128.97,-6220.55"/>
</g>
<!-- concat_dim_0_1 -->
<g id="node68" class="node">
<title>concat_dim_0_1</title>
<polygon fill="lightyellow" stroke="black" points="4150.5,-6078 3977.5,-6025 4150.5,-5972 4323.5,-6025 4150.5,-6078"/>
<text text-anchor="middle" x="4150.5" y="-6036.3" font-family="monospace" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="4150.5" y="-6021.3" font-family="monospace" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="4150.5" y="-6006.3" font-family="monospace" font-size="14.00">[1024×2048×(4×512)]</text>
</g>
<!-- out_proj_0_1_0&#45;&gt;concat_dim_0_1 -->
<g id="edge94" class="edge">
<title>out_proj_0_1_0&#45;&gt;concat_dim_0_1</title>
<path fill="none" stroke="black" d="M3282.36,-6156.45C3452.4,-6130.9 3829.73,-6074.2 4026.18,-6044.68"/>
<polygon fill="black" stroke="black" points="4026.89,-6048.11 4036.26,-6043.17 4025.85,-6041.19 4026.89,-6048.11"/>
</g>
<!-- out_proj_0_1_0&#45;&gt;concat_dim_0_1 -->
<g id="edge95" class="edge">
<title>out_proj_0_1_0&#45;&gt;concat_dim_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3282.13,-6159.17C3372.65,-6148.16 3518.74,-6129.75 3644.5,-6111 3777.94,-6091.11 3930.6,-6065 4033.03,-6047"/>
<polygon fill="red" stroke="red" points="4033.85,-6050.4 4043.09,-6045.22 4032.63,-6043.51 4033.85,-6050.4"/>
<text text-anchor="middle" x="3780.5" y="-6099.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_dim_0_1&#45;&gt;concat_heads_0 -->
<g id="edge196" class="edge">
<title>concat_dim_0_1&#45;&gt;concat_heads_0</title>
<path fill="none" stroke="black" d="M4289.25,-6014.42C4660.3,-5988.8 5672.75,-5918.89 6049.1,-5892.9"/>
<polygon fill="black" stroke="black" points="6049.5,-5896.38 6059.23,-5892.2 6049.02,-5889.4 6049.5,-5896.38"/>
</g>
<!-- out_proj_0_1_1 -->
<g id="node70" class="node">
<title>out_proj_0_1_1</title>
<polygon fill="#ccffff" stroke="black" points="3855,-6212 3682,-6212 3682,-6129 3855,-6129 3855,-6212"/>
<text text-anchor="middle" x="3768.5" y="-6196.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3768.5" y="-6181.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="3768.5" y="-6166.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3768.5" y="-6151.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3768.5" y="-6136.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_0_1_1&#45;&gt;out_proj_0_1_1 -->
<g id="edge102" class="edge">
<title>attn_0_1_1&#45;&gt;out_proj_0_1_1</title>
<path fill="none" stroke="black" d="M3653.71,-6248.85C3668.19,-6239.08 3684.32,-6228.22 3699.79,-6217.79"/>
<polygon fill="black" stroke="black" points="3701.97,-6220.55 3708.31,-6212.06 3698.06,-6214.74 3701.97,-6220.55"/>
</g>
<!-- out_proj_0_1_1&#45;&gt;concat_dim_0_1 -->
<g id="edge103" class="edge">
<title>out_proj_0_1_1&#45;&gt;concat_dim_0_1</title>
<path fill="none" stroke="black" d="M3855.18,-6136.94C3917.89,-6113.38 4002.24,-6081.69 4064.74,-6058.22"/>
<polygon fill="black" stroke="black" points="4066.05,-6061.46 4074.18,-6054.67 4063.59,-6054.91 4066.05,-6061.46"/>
</g>
<!-- out_proj_0_1_1&#45;&gt;concat_dim_0_1 -->
<g id="edge104" class="edge">
<title>out_proj_0_1_1&#45;&gt;concat_dim_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3855.29,-6144.7C3887.36,-6134.96 3923.84,-6123.19 3956.5,-6111 3995.87,-6096.3 4038.75,-6077.79 4074.17,-6061.79"/>
<polygon fill="red" stroke="red" points="4075.81,-6064.89 4083.47,-6057.57 4072.92,-6058.51 4075.81,-6064.89"/>
<text text-anchor="middle" x="4032.5" y="-6099.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_0_1_2 -->
<g id="node72" class="node">
<title>out_proj_0_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="4237,-6212 4064,-6212 4064,-6129 4237,-6129 4237,-6212"/>
<text text-anchor="middle" x="4150.5" y="-6196.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="4150.5" y="-6181.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="4150.5" y="-6166.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4150.5" y="-6151.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4150.5" y="-6136.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_0_1_2&#45;&gt;out_proj_0_1_2 -->
<g id="edge111" class="edge">
<title>attn_0_1_2&#45;&gt;out_proj_0_1_2</title>
<path fill="none" stroke="black" d="M4150.5,-6248.85C4150.5,-6240.44 4150.5,-6231.22 4150.5,-6222.16"/>
<polygon fill="black" stroke="black" points="4154,-6222.06 4150.5,-6212.06 4147,-6222.06 4154,-6222.06"/>
</g>
<!-- out_proj_0_1_2&#45;&gt;concat_dim_0_1 -->
<g id="edge112" class="edge">
<title>out_proj_0_1_2&#45;&gt;concat_dim_0_1</title>
<path fill="none" stroke="black" d="M4150.5,-6128.76C4150.5,-6116.22 4150.5,-6102.1 4150.5,-6088.45"/>
<polygon fill="black" stroke="black" points="4154,-6088.13 4150.5,-6078.13 4147,-6088.13 4154,-6088.13"/>
</g>
<!-- out_proj_0_1_2&#45;&gt;concat_dim_0_1 -->
<g id="edge113" class="edge">
<title>out_proj_0_1_2&#45;&gt;concat_dim_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4161.53,-6128.81C4162.76,-6122.87 4163.81,-6116.81 4164.5,-6111 4165.52,-6102.37 4165.35,-6093.27 4164.49,-6084.37"/>
<polygon fill="red" stroke="red" points="4167.96,-6083.92 4163.24,-6074.44 4161.01,-6084.8 4167.96,-6083.92"/>
<text text-anchor="middle" x="4203.5" y="-6099.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_0_1_3 -->
<g id="node74" class="node">
<title>out_proj_0_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="4619,-6212 4446,-6212 4446,-6129 4619,-6129 4619,-6212"/>
<text text-anchor="middle" x="4532.5" y="-6196.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="4532.5" y="-6181.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="4532.5" y="-6166.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4532.5" y="-6151.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4532.5" y="-6136.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_0_1_3&#45;&gt;out_proj_0_1_3 -->
<g id="edge120" class="edge">
<title>attn_0_1_3&#45;&gt;out_proj_0_1_3</title>
<path fill="none" stroke="black" d="M4627,-6248.85C4615.4,-6239.36 4602.53,-6228.82 4590.12,-6218.66"/>
<polygon fill="black" stroke="black" points="4592,-6215.68 4582.05,-6212.06 4587.57,-6221.1 4592,-6215.68"/>
</g>
<!-- out_proj_0_1_3&#45;&gt;concat_dim_0_1 -->
<g id="edge121" class="edge">
<title>out_proj_0_1_3&#45;&gt;concat_dim_0_1</title>
<path fill="none" stroke="black" d="M4445.82,-6136.94C4383.11,-6113.38 4298.76,-6081.69 4236.26,-6058.22"/>
<polygon fill="black" stroke="black" points="4237.41,-6054.91 4226.82,-6054.67 4234.95,-6061.46 4237.41,-6054.91"/>
</g>
<!-- out_proj_0_1_3&#45;&gt;concat_dim_0_1 -->
<g id="edge122" class="edge">
<title>out_proj_0_1_3&#45;&gt;concat_dim_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4450.02,-6128.92C4425.66,-6117.61 4398.75,-6105.75 4373.5,-6096 4333.28,-6080.47 4288.04,-6065.77 4248.86,-6053.89"/>
<polygon fill="red" stroke="red" points="4249.63,-6050.46 4239.04,-6050.93 4247.61,-6057.17 4249.63,-6050.46"/>
<text text-anchor="middle" x="4447.5" y="-6099.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_0_2_0 -->
<g id="node76" class="node">
<title>out_proj_0_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="5801,-6212 5628,-6212 5628,-6129 5801,-6129 5801,-6212"/>
<text text-anchor="middle" x="5714.5" y="-6196.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5714.5" y="-6181.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="5714.5" y="-6166.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5714.5" y="-6151.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="5714.5" y="-6136.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_0_2_0&#45;&gt;out_proj_0_2_0 -->
<g id="edge129" class="edge">
<title>attn_0_2_0&#45;&gt;out_proj_0_2_0</title>
<path fill="none" stroke="black" d="M5471.28,-6261.99C5512.19,-6246.77 5569.54,-6225.43 5618.28,-6207.3"/>
<polygon fill="black" stroke="black" points="5619.76,-6210.48 5627.91,-6203.72 5617.32,-6203.92 5619.76,-6210.48"/>
</g>
<!-- concat_dim_0_2 -->
<g id="node77" class="node">
<title>concat_dim_0_2</title>
<polygon fill="lightyellow" stroke="black" points="6192.5,-6078 6019.5,-6025 6192.5,-5972 6365.5,-6025 6192.5,-6078"/>
<text text-anchor="middle" x="6192.5" y="-6036.3" font-family="monospace" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="6192.5" y="-6021.3" font-family="monospace" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="6192.5" y="-6006.3" font-family="monospace" font-size="14.00">[1024×2048×(4×512)]</text>
</g>
<!-- out_proj_0_2_0&#45;&gt;concat_dim_0_2 -->
<g id="edge130" class="edge">
<title>out_proj_0_2_0&#45;&gt;concat_dim_0_2</title>
<path fill="none" stroke="black" d="M5746.09,-6128.98C5757.8,-6116.56 5772.03,-6104.06 5787.5,-6096 5860.79,-6057.84 5950.65,-6039.89 6027.09,-6031.66"/>
<polygon fill="black" stroke="black" points="6027.71,-6035.11 6037.3,-6030.61 6026.99,-6028.15 6027.71,-6035.11"/>
</g>
<!-- out_proj_0_2_0&#45;&gt;concat_dim_0_2 -->
<g id="edge131" class="edge">
<title>out_proj_0_2_0&#45;&gt;concat_dim_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5801.06,-6143.51C5884.48,-6118.47 6010.41,-6080.66 6096.78,-6054.74"/>
<polygon fill="red" stroke="red" points="6098.01,-6058.02 6106.58,-6051.79 6096,-6051.32 6098.01,-6058.02"/>
<text text-anchor="middle" x="5991.5" y="-6099.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_dim_0_2&#45;&gt;concat_heads_0 -->
<g id="edge197" class="edge">
<title>concat_dim_0_2&#45;&gt;concat_heads_0</title>
<path fill="none" stroke="black" d="M6192.5,-5971.9C6192.5,-5963.33 6192.5,-5954.37 6192.5,-5945.57"/>
<polygon fill="black" stroke="black" points="6196,-5945.36 6192.5,-5935.36 6189,-5945.36 6196,-5945.36"/>
</g>
<!-- out_proj_0_2_1 -->
<g id="node79" class="node">
<title>out_proj_0_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="6125,-6212 5952,-6212 5952,-6129 6125,-6129 6125,-6212"/>
<text text-anchor="middle" x="6038.5" y="-6196.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="6038.5" y="-6181.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="6038.5" y="-6166.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6038.5" y="-6151.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6038.5" y="-6136.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_0_2_1&#45;&gt;out_proj_0_2_1 -->
<g id="edge138" class="edge">
<title>attn_0_2_1&#45;&gt;out_proj_0_2_1</title>
<path fill="none" stroke="black" d="M5939.1,-6248.85C5951.42,-6239.26 5965.09,-6228.62 5978.26,-6218.37"/>
<polygon fill="black" stroke="black" points="5980.64,-6220.96 5986.38,-6212.06 5976.34,-6215.43 5980.64,-6220.96"/>
</g>
<!-- out_proj_0_2_1&#45;&gt;concat_dim_0_2 -->
<g id="edge139" class="edge">
<title>out_proj_0_2_1&#45;&gt;concat_dim_0_2</title>
<path fill="none" stroke="black" d="M6075.83,-6128.63C6086.17,-6117.78 6097.56,-6106.23 6108.5,-6096 6117.58,-6087.5 6127.51,-6078.78 6137.26,-6070.49"/>
<polygon fill="black" stroke="black" points="6139.63,-6073.07 6145.03,-6063.95 6135.12,-6067.71 6139.63,-6073.07"/>
</g>
<!-- out_proj_0_2_1&#45;&gt;concat_dim_0_2 -->
<g id="edge140" class="edge">
<title>out_proj_0_2_1&#45;&gt;concat_dim_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6088.34,-6128.85C6095.2,-6122.96 6102.09,-6116.9 6108.5,-6111 6121.26,-6099.26 6134.65,-6086.12 6146.89,-6073.75"/>
<polygon fill="red" stroke="red" points="6149.43,-6076.16 6153.95,-6066.57 6144.44,-6071.25 6149.43,-6076.16"/>
<text text-anchor="middle" x="6161.5" y="-6099.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_0_2_2 -->
<g id="node81" class="node">
<title>out_proj_0_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="6360,-6212 6187,-6212 6187,-6129 6360,-6129 6360,-6212"/>
<text text-anchor="middle" x="6273.5" y="-6196.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6273.5" y="-6181.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="6273.5" y="-6166.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6273.5" y="-6151.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6273.5" y="-6136.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_0_2_2&#45;&gt;out_proj_0_2_2 -->
<g id="edge147" class="edge">
<title>attn_0_2_2&#45;&gt;out_proj_0_2_2</title>
<path fill="none" stroke="black" d="M6369.4,-6248.85C6357.52,-6239.26 6344.32,-6228.62 6331.61,-6218.37"/>
<polygon fill="black" stroke="black" points="6333.76,-6215.61 6323.78,-6212.06 6329.37,-6221.06 6333.76,-6215.61"/>
</g>
<!-- out_proj_0_2_2&#45;&gt;concat_dim_0_2 -->
<g id="edge148" class="edge">
<title>out_proj_0_2_2&#45;&gt;concat_dim_0_2</title>
<path fill="none" stroke="black" d="M6250.51,-6128.76C6241.82,-6113.38 6231.81,-6095.65 6222.58,-6079.28"/>
<polygon fill="black" stroke="black" points="6225.5,-6077.35 6217.54,-6070.36 6219.41,-6080.79 6225.5,-6077.35"/>
</g>
<!-- out_proj_0_2_2&#45;&gt;concat_dim_0_2 -->
<g id="edge149" class="edge">
<title>out_proj_0_2_2&#45;&gt;concat_dim_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6264.49,-6128.64C6261.22,-6117.68 6256.95,-6106.08 6251.5,-6096 6247.53,-6088.66 6242.72,-6081.39 6237.56,-6074.47"/>
<polygon fill="red" stroke="red" points="6240.28,-6072.27 6231.39,-6066.52 6234.76,-6076.57 6240.28,-6072.27"/>
<text text-anchor="middle" x="6296.5" y="-6099.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_0_2_3 -->
<g id="node83" class="node">
<title>out_proj_0_2_3</title>
<polygon fill="#aaffff" stroke="black" points="6786,-6212 6613,-6212 6613,-6129 6786,-6129 6786,-6212"/>
<text text-anchor="middle" x="6699.5" y="-6196.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6699.5" y="-6181.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="6699.5" y="-6166.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6699.5" y="-6151.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6699.5" y="-6136.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_0_2_3&#45;&gt;out_proj_0_2_3 -->
<g id="edge156" class="edge">
<title>attn_0_2_3&#45;&gt;out_proj_0_2_3</title>
<path fill="none" stroke="black" d="M6895.23,-6256.65C6865.77,-6243.84 6829.26,-6227.95 6795.78,-6213.39"/>
<polygon fill="black" stroke="black" points="6797,-6210.1 6786.43,-6209.32 6794.2,-6216.52 6797,-6210.1"/>
</g>
<!-- out_proj_0_2_3&#45;&gt;concat_dim_0_2 -->
<g id="edge157" class="edge">
<title>out_proj_0_2_3&#45;&gt;concat_dim_0_2</title>
<path fill="none" stroke="black" d="M6612.92,-6144.99C6523.46,-6119.67 6384.08,-6080.22 6290.6,-6053.77"/>
<polygon fill="black" stroke="black" points="6291.43,-6050.36 6280.85,-6051.01 6289.52,-6057.1 6291.43,-6050.36"/>
</g>
<!-- out_proj_0_2_3&#45;&gt;concat_dim_0_2 -->
<g id="edge158" class="edge">
<title>out_proj_0_2_3&#45;&gt;concat_dim_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6612.85,-6137.98C6573.62,-6124.24 6526.49,-6108.46 6483.5,-6096 6424.06,-6078.78 6356.95,-6062.43 6302.17,-6049.87"/>
<polygon fill="red" stroke="red" points="6302.62,-6046.38 6292.09,-6047.57 6301.06,-6053.21 6302.62,-6046.38"/>
<text text-anchor="middle" x="6569.5" y="-6099.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_0_3_0 -->
<g id="node85" class="node">
<title>out_proj_0_3_0</title>
<polygon fill="#ff8888" stroke="black" points="7866,-6212 7693,-6212 7693,-6129 7866,-6129 7866,-6212"/>
<text text-anchor="middle" x="7779.5" y="-6196.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7779.5" y="-6181.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="7779.5" y="-6166.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7779.5" y="-6151.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="7779.5" y="-6136.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_0_3_0&#45;&gt;out_proj_0_3_0 -->
<g id="edge165" class="edge">
<title>attn_0_3_0&#45;&gt;out_proj_0_3_0</title>
<path fill="none" stroke="black" d="M7664.71,-6248.85C7679.19,-6239.08 7695.32,-6228.22 7710.79,-6217.79"/>
<polygon fill="black" stroke="black" points="7712.97,-6220.55 7719.31,-6212.06 7709.06,-6214.74 7712.97,-6220.55"/>
</g>
<!-- concat_dim_0_3 -->
<g id="node86" class="node">
<title>concat_dim_0_3</title>
<polygon fill="lightyellow" stroke="black" points="8161.5,-6078 7988.5,-6025 8161.5,-5972 8334.5,-6025 8161.5,-6078"/>
<text text-anchor="middle" x="8161.5" y="-6036.3" font-family="monospace" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="8161.5" y="-6021.3" font-family="monospace" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="8161.5" y="-6006.3" font-family="monospace" font-size="14.00">[1024×2048×(4×512)]</text>
</g>
<!-- out_proj_0_3_0&#45;&gt;concat_dim_0_3 -->
<g id="edge166" class="edge">
<title>out_proj_0_3_0&#45;&gt;concat_dim_0_3</title>
<path fill="none" stroke="black" d="M7866.18,-6136.94C7928.89,-6113.38 8013.24,-6081.69 8075.74,-6058.22"/>
<polygon fill="black" stroke="black" points="8077.05,-6061.46 8085.18,-6054.67 8074.59,-6054.91 8077.05,-6061.46"/>
</g>
<!-- out_proj_0_3_0&#45;&gt;concat_dim_0_3 -->
<g id="edge167" class="edge">
<title>out_proj_0_3_0&#45;&gt;concat_dim_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7866.29,-6144.7C7898.36,-6134.96 7934.84,-6123.19 7967.5,-6111 8006.87,-6096.3 8049.75,-6077.79 8085.17,-6061.79"/>
<polygon fill="red" stroke="red" points="8086.81,-6064.89 8094.47,-6057.57 8083.92,-6058.51 8086.81,-6064.89"/>
<text text-anchor="middle" x="8043.5" y="-6099.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_dim_0_3&#45;&gt;concat_heads_0 -->
<g id="edge198" class="edge">
<title>concat_dim_0_3&#45;&gt;concat_heads_0</title>
<path fill="none" stroke="black" d="M8023.83,-6014.14C7664.37,-5988.4 6700.21,-5919.36 6335.19,-5893.22"/>
<polygon fill="black" stroke="black" points="6335.32,-5889.72 6325.1,-5892.5 6334.82,-5896.7 6335.32,-5889.72"/>
</g>
<!-- out_proj_0_3_1 -->
<g id="node88" class="node">
<title>out_proj_0_3_1</title>
<polygon fill="#88ff88" stroke="black" points="8248,-6212 8075,-6212 8075,-6129 8248,-6129 8248,-6212"/>
<text text-anchor="middle" x="8161.5" y="-6196.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="8161.5" y="-6181.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="8161.5" y="-6166.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8161.5" y="-6151.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8161.5" y="-6136.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_0_3_1&#45;&gt;out_proj_0_3_1 -->
<g id="edge174" class="edge">
<title>attn_0_3_1&#45;&gt;out_proj_0_3_1</title>
<path fill="none" stroke="black" d="M8161.5,-6248.85C8161.5,-6240.44 8161.5,-6231.22 8161.5,-6222.16"/>
<polygon fill="black" stroke="black" points="8165,-6222.06 8161.5,-6212.06 8158,-6222.06 8165,-6222.06"/>
</g>
<!-- out_proj_0_3_1&#45;&gt;concat_dim_0_3 -->
<g id="edge175" class="edge">
<title>out_proj_0_3_1&#45;&gt;concat_dim_0_3</title>
<path fill="none" stroke="black" d="M8161.5,-6128.76C8161.5,-6116.22 8161.5,-6102.1 8161.5,-6088.45"/>
<polygon fill="black" stroke="black" points="8165,-6088.13 8161.5,-6078.13 8158,-6088.13 8165,-6088.13"/>
</g>
<!-- out_proj_0_3_1&#45;&gt;concat_dim_0_3 -->
<g id="edge176" class="edge">
<title>out_proj_0_3_1&#45;&gt;concat_dim_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8172.53,-6128.81C8173.76,-6122.87 8174.81,-6116.81 8175.5,-6111 8176.52,-6102.37 8176.35,-6093.27 8175.49,-6084.37"/>
<polygon fill="red" stroke="red" points="8178.96,-6083.92 8174.24,-6074.44 8172.01,-6084.8 8178.96,-6083.92"/>
<text text-anchor="middle" x="8214.5" y="-6099.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_0_3_2 -->
<g id="node90" class="node">
<title>out_proj_0_3_2</title>
<polygon fill="#8888ff" stroke="black" points="8645,-6212 8472,-6212 8472,-6129 8645,-6129 8645,-6212"/>
<text text-anchor="middle" x="8558.5" y="-6196.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8558.5" y="-6181.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="8558.5" y="-6166.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8558.5" y="-6151.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8558.5" y="-6136.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_0_3_2&#45;&gt;out_proj_0_3_2 -->
<g id="edge183" class="edge">
<title>attn_0_3_2&#45;&gt;out_proj_0_3_2</title>
<path fill="none" stroke="black" d="M8629.2,-6248.85C8620.77,-6239.63 8611.44,-6229.42 8602.41,-6219.53"/>
<polygon fill="black" stroke="black" points="8604.9,-6217.08 8595.57,-6212.06 8599.73,-6221.8 8604.9,-6217.08"/>
</g>
<!-- out_proj_0_3_2&#45;&gt;concat_dim_0_3 -->
<g id="edge184" class="edge">
<title>out_proj_0_3_2&#45;&gt;concat_dim_0_3</title>
<path fill="none" stroke="black" d="M8471.87,-6138.19C8405.87,-6114.33 8315.37,-6081.62 8249.13,-6057.68"/>
<polygon fill="black" stroke="black" points="8250.13,-6054.32 8239.54,-6054.21 8247.75,-6060.9 8250.13,-6054.32"/>
</g>
<!-- out_proj_0_3_2&#45;&gt;concat_dim_0_3 -->
<g id="edge185" class="edge">
<title>out_proj_0_3_2&#45;&gt;concat_dim_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8472.31,-6128.94C8446.87,-6117.62 8418.8,-6105.76 8392.5,-6096 8350.04,-6080.23 8302.26,-6065.3 8261.21,-6053.31"/>
<polygon fill="red" stroke="red" points="8262.06,-6049.91 8251.48,-6050.49 8260.1,-6056.64 8262.06,-6049.91"/>
<text text-anchor="middle" x="8468.5" y="-6099.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_0_3_3 -->
<g id="node92" class="node">
<title>out_proj_0_3_3</title>
<polygon fill="#ffff88" stroke="black" points="9138,-6212 8965,-6212 8965,-6129 9138,-6129 9138,-6212"/>
<text text-anchor="middle" x="9051.5" y="-6196.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9051.5" y="-6181.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="9051.5" y="-6166.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="9051.5" y="-6151.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="9051.5" y="-6136.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_0_3_3&#45;&gt;out_proj_0_3_3 -->
<g id="edge192" class="edge">
<title>attn_0_3_3&#45;&gt;out_proj_0_3_3</title>
<path fill="none" stroke="black" d="M9126.4,-6248.85C9117.38,-6239.54 9107.4,-6229.22 9097.73,-6219.24"/>
<polygon fill="black" stroke="black" points="9100.24,-6216.8 9090.77,-6212.06 9095.21,-6221.67 9100.24,-6216.8"/>
</g>
<!-- out_proj_0_3_3&#45;&gt;concat_dim_0_3 -->
<g id="edge193" class="edge">
<title>out_proj_0_3_3&#45;&gt;concat_dim_0_3</title>
<path fill="none" stroke="black" d="M8964.95,-6155.54C8805.49,-6129.84 8465.01,-6074.94 8282.68,-6045.54"/>
<polygon fill="black" stroke="black" points="8283.21,-6042.08 8272.78,-6043.94 8282.09,-6048.99 8283.21,-6042.08"/>
</g>
<!-- out_proj_0_3_3&#45;&gt;concat_dim_0_3 -->
<g id="edge194" class="edge">
<title>out_proj_0_3_3&#45;&gt;concat_dim_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8964.9,-6152.09C8885.6,-6136.42 8764.9,-6113.28 8659.5,-6096 8534.97,-6075.58 8392.31,-6055.91 8291.69,-6042.64"/>
<polygon fill="red" stroke="red" points="8291.85,-6039.13 8281.48,-6041.3 8290.93,-6046.07 8291.85,-6039.13"/>
<text text-anchor="middle" x="8783.5" y="-6099.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_heads_0&#45;&gt;add_0 -->
<g id="edge199" class="edge">
<title>concat_heads_0&#45;&gt;add_0</title>
<path fill="none" stroke="black" d="M6314.68,-5868.12C6650.72,-5832.68 7585.54,-5734.1 7912.67,-5699.61"/>
<polygon fill="black" stroke="black" points="7913.07,-5703.09 7922.64,-5698.56 7912.33,-5696.13 7913.07,-5703.09"/>
</g>
<!-- ffn_dense_h_0 -->
<g id="node96" class="node">
<title>ffn_dense_h_0</title>
<polygon fill="lightgreen" stroke="black" points="8046,-5469 7889,-5469 7889,-5401 8046,-5401 8046,-5469"/>
<text text-anchor="middle" x="7967.5" y="-5453.8" font-family="monospace" font-size="14.00">FFN Dense_H</text>
<text text-anchor="middle" x="7967.5" y="-5438.8" font-family="monospace" font-size="14.00">[1024×2048×32768]</text>
<text text-anchor="middle" x="7967.5" y="-5423.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7967.5" y="-5408.8" font-family="monospace" font-size="14.00">→AllGather</text>
</g>
<!-- ln2_0&#45;&gt;ffn_dense_h_0 -->
<g id="edge202" class="edge">
<title>ln2_0&#45;&gt;ffn_dense_h_0</title>
<path fill="none" stroke="black" d="M7973.05,-5505.77C7972.43,-5498 7971.68,-5488.59 7970.94,-5479.22"/>
<polygon fill="black" stroke="black" points="7974.42,-5478.84 7970.14,-5469.15 7967.44,-5479.4 7974.42,-5478.84"/>
</g>
<!-- ln1_1 -->
<g id="node99" class="node">
<title>ln1_1</title>
<polygon fill="lightgray" stroke="black" points="5794,-4908 5645,-4908 5645,-4870 5794,-4870 5794,-4908"/>
<text text-anchor="middle" x="5719.5" y="-4892.8" font-family="monospace" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5719.5" y="-4877.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- add2_0&#45;&gt;ln1_1 -->
<g id="edge208" class="edge">
<title>add2_0&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M7868.18,-5042.05C7482.79,-5014.78 6153.56,-4920.72 5804.18,-4895.99"/>
<polygon fill="black" stroke="black" points="5804.35,-4892.5 5794.13,-4895.28 5803.86,-4899.48 5804.35,-4892.5"/>
</g>
<!-- add_1 -->
<g id="node100" class="node">
<title>add_1</title>
<ellipse fill="lightgray" stroke="black" cx="8641.5" cy="-4068.5" rx="105.5" ry="105.5"/>
<text text-anchor="middle" x="8641.5" y="-4079.8" font-family="monospace" font-size="14.00">Add</text>
<text text-anchor="middle" x="8641.5" y="-4064.8" font-family="monospace" font-size="14.00">Residual</text>
<text text-anchor="middle" x="8641.5" y="-4049.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- add2_0&#45;&gt;add_1 -->
<g id="edge209" class="edge">
<title>add2_0&#45;&gt;add_1</title>
<path fill="none" stroke="black" d="M8079.19,-5047.63C8524.82,-5039.04 10227.5,-4999.11 10227.5,-4890 10227.5,-4890 10227.5,-4890 10227.5,-4263 10227.5,-4114.81 9122.46,-4079.19 8757.16,-4071.47"/>
<polygon fill="black" stroke="black" points="8757.17,-4067.97 8747.1,-4071.26 8757.02,-4074.96 8757.17,-4067.97"/>
</g>
<!-- ffn_act_0 -->
<g id="node97" class="node">
<title>ffn_act_0</title>
<polygon fill="lightgreen" stroke="black" points="8038,-5350 7881,-5350 7881,-5312 8038,-5312 8038,-5350"/>
<text text-anchor="middle" x="7959.5" y="-5334.8" font-family="monospace" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7959.5" y="-5319.8" font-family="monospace" font-size="14.00">[1024×2048×32768]</text>
</g>
<!-- ffn_dense_h_0&#45;&gt;ffn_act_0 -->
<g id="edge203" class="edge">
<title>ffn_dense_h_0&#45;&gt;ffn_act_0</title>
<path fill="none" stroke="black" d="M7964.9,-5400.88C7963.88,-5387.84 7962.72,-5373 7961.73,-5360.45"/>
<polygon fill="black" stroke="black" points="7965.19,-5359.8 7960.92,-5350.11 7958.21,-5360.35 7965.19,-5359.8"/>
</g>
<!-- ffn_dense_h_0&#45;&gt;ffn_act_0 -->
<g id="edge204" class="edge">
<title>ffn_dense_h_0&#45;&gt;ffn_act_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7972.35,-5400.96C7973.15,-5390.38 7973.23,-5378.65 7971.5,-5368 7971.06,-5365.29 7970.45,-5362.51 7969.72,-5359.75"/>
<polygon fill="red" stroke="red" points="7973.03,-5358.58 7966.77,-5350.03 7966.33,-5360.61 7973.03,-5358.58"/>
<text text-anchor="middle" x="8010" y="-5371.8" font-family="Times,serif" font-size="14.00">All&#45;Gather</text>
</g>
<!-- ffn_dense_4h_0 -->
<g id="node98" class="node">
<title>ffn_dense_4h_0</title>
<polygon fill="lightgreen" stroke="black" points="8033,-5275 7884,-5275 7884,-5207 8033,-5207 8033,-5275"/>
<text text-anchor="middle" x="7958.5" y="-5259.8" font-family="monospace" font-size="14.00">FFN Dense_4H</text>
<text text-anchor="middle" x="7958.5" y="-5244.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
<text text-anchor="middle" x="7958.5" y="-5229.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="7958.5" y="-5214.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ffn_act_0&#45;&gt;ffn_dense_4h_0 -->
<g id="edge205" class="edge">
<title>ffn_act_0&#45;&gt;ffn_dense_4h_0</title>
<path fill="none" stroke="black" d="M7959.29,-5311.77C7959.2,-5304 7959.1,-5294.59 7958.99,-5285.22"/>
<polygon fill="black" stroke="black" points="7962.49,-5285.11 7958.88,-5275.15 7955.49,-5285.19 7962.49,-5285.11"/>
</g>
<!-- ffn_dense_4h_0&#45;&gt;add2_0 -->
<g id="edge206" class="edge">
<title>ffn_dense_4h_0&#45;&gt;add2_0</title>
<path fill="none" stroke="black" d="M7961.15,-5206.73C7962.08,-5194.97 7963.2,-5180.98 7964.37,-5166.3"/>
<polygon fill="black" stroke="black" points="7967.88,-5166.28 7965.18,-5156.04 7960.9,-5165.73 7967.88,-5166.28"/>
</g>
<!-- ffn_dense_4h_0&#45;&gt;add2_0 -->
<g id="edge207" class="edge">
<title>ffn_dense_4h_0&#45;&gt;add2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7965.77,-5206.92C7966.85,-5200.98 7967.83,-5194.83 7968.5,-5189 7969.36,-5181.58 7970.08,-5173.91 7970.69,-5166.18"/>
<polygon fill="red" stroke="red" points="7974.19,-5166.21 7971.42,-5155.99 7967.21,-5165.71 7974.19,-5166.21"/>
<text text-anchor="middle" x="8008.5" y="-5177.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- q_proj_1_0_0 -->
<g id="node101" class="node">
<title>q_proj_1_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="1222,-4833 1049,-4833 1049,-4750 1222,-4750 1222,-4833"/>
<text text-anchor="middle" x="1135.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1135.5" y="-4802.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="1135.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1135.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1135.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_0_0 -->
<g id="edge210" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_0_0</title>
<path fill="none" stroke="black" d="M5644.66,-4887.92C5152.89,-4887.27 2378.04,-4882.33 1531.5,-4852 1400.81,-4847.32 1362.77,-4863.15 1232.06,-4833.14"/>
<polygon fill="black" stroke="black" points="1232.61,-4829.67 1222.07,-4830.8 1231.01,-4836.49 1232.61,-4829.67"/>
</g>
<!-- k_proj_1_0_0 -->
<g id="node102" class="node">
<title>k_proj_1_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="1413,-4833 1240,-4833 1240,-4750 1413,-4750 1413,-4833"/>
<text text-anchor="middle" x="1326.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1326.5" y="-4802.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="1326.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1326.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1326.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_0_0 -->
<g id="edge211" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_0_0</title>
<path fill="none" stroke="black" d="M5644.63,-4887.88C5165.95,-4887.02 2528.48,-4881.05 1722.5,-4852 1591.81,-4847.29 1553.77,-4863.15 1423.06,-4833.14"/>
<polygon fill="black" stroke="black" points="1423.61,-4829.67 1413.07,-4830.8 1422.01,-4836.49 1423.61,-4829.67"/>
</g>
<!-- v_proj_1_0_0 -->
<g id="node103" class="node">
<title>v_proj_1_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="1604,-4833 1431,-4833 1431,-4750 1604,-4750 1604,-4833"/>
<text text-anchor="middle" x="1517.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1517.5" y="-4802.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="1517.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1517.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1517.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_0_0 -->
<g id="edge212" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_0_0</title>
<path fill="none" stroke="black" d="M5644.87,-4887.84C5180.26,-4886.77 2679.1,-4879.76 1913.5,-4852 1782.81,-4847.26 1744.77,-4863.14 1614.06,-4833.14"/>
<polygon fill="black" stroke="black" points="1614.61,-4829.67 1604.07,-4830.8 1613.01,-4836.49 1614.61,-4829.67"/>
</g>
<!-- q_proj_1_0_1 -->
<g id="node104" class="node">
<title>q_proj_1_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="1795,-4833 1622,-4833 1622,-4750 1795,-4750 1795,-4833"/>
<text text-anchor="middle" x="1708.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1708.5" y="-4802.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="1708.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1708.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1708.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_0_1 -->
<g id="edge213" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_0_1</title>
<path fill="none" stroke="black" d="M5644.64,-4887.8C5193.25,-4886.49 2829.52,-4878.47 2104.5,-4852 1973.82,-4847.23 1935.77,-4863.14 1805.06,-4833.14"/>
<polygon fill="black" stroke="black" points="1805.61,-4829.67 1795.07,-4830.8 1804.01,-4836.49 1805.61,-4829.67"/>
</g>
<!-- k_proj_1_0_1 -->
<g id="node105" class="node">
<title>k_proj_1_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="1986,-4833 1813,-4833 1813,-4750 1986,-4750 1986,-4833"/>
<text text-anchor="middle" x="1899.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1899.5" y="-4802.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="1899.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1899.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1899.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_0_1 -->
<g id="edge214" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_0_1</title>
<path fill="none" stroke="black" d="M5644.73,-4887.75C5207.75,-4886.2 2980.17,-4877.19 2295.5,-4852 2164.82,-4847.19 2126.77,-4863.14 1996.06,-4833.14"/>
<polygon fill="black" stroke="black" points="1996.61,-4829.67 1986.07,-4830.8 1995.01,-4836.49 1996.61,-4829.67"/>
</g>
<!-- v_proj_1_0_1 -->
<g id="node106" class="node">
<title>v_proj_1_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="2177,-4833 2004,-4833 2004,-4750 2177,-4750 2177,-4833"/>
<text text-anchor="middle" x="2090.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="2090.5" y="-4802.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="2090.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2090.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2090.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_0_1 -->
<g id="edge215" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_0_1</title>
<path fill="none" stroke="black" d="M5644.82,-4887.7C5222.62,-4885.9 3130.87,-4875.91 2486.5,-4852 2355.82,-4847.15 2317.77,-4863.14 2187.06,-4833.14"/>
<polygon fill="black" stroke="black" points="2187.61,-4829.67 2177.07,-4830.8 2186.01,-4836.49 2187.61,-4829.67"/>
</g>
<!-- q_proj_1_0_2 -->
<g id="node107" class="node">
<title>q_proj_1_0_2</title>
<polygon fill="#ccccff" stroke="black" points="2368,-4833 2195,-4833 2195,-4750 2368,-4750 2368,-4833"/>
<text text-anchor="middle" x="2281.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2281.5" y="-4802.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="2281.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2281.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2281.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_0_2 -->
<g id="edge216" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_0_2</title>
<path fill="none" stroke="black" d="M5644.96,-4887.64C5238.07,-4885.58 3281.66,-4874.63 2677.5,-4852 2546.82,-4847.11 2508.77,-4863.14 2378.06,-4833.14"/>
<polygon fill="black" stroke="black" points="2378.61,-4829.67 2368.07,-4830.8 2377.01,-4836.49 2378.61,-4829.67"/>
</g>
<!-- k_proj_1_0_2 -->
<g id="node108" class="node">
<title>k_proj_1_0_2</title>
<polygon fill="#ccccff" stroke="black" points="2559,-4833 2386,-4833 2386,-4750 2559,-4750 2559,-4833"/>
<text text-anchor="middle" x="2472.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2472.5" y="-4802.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="2472.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2472.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2472.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_0_2 -->
<g id="edge217" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_0_2</title>
<path fill="none" stroke="black" d="M5644.88,-4887.57C5253.3,-4885.22 3432.4,-4873.34 2868.5,-4852 2737.82,-4847.05 2699.77,-4863.13 2569.06,-4833.14"/>
<polygon fill="black" stroke="black" points="2569.61,-4829.67 2559.07,-4830.8 2568.01,-4836.49 2569.61,-4829.67"/>
</g>
<!-- v_proj_1_0_2 -->
<g id="node109" class="node">
<title>v_proj_1_0_2</title>
<polygon fill="#ccccff" stroke="black" points="2750,-4833 2577,-4833 2577,-4750 2750,-4750 2750,-4833"/>
<text text-anchor="middle" x="2663.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2663.5" y="-4802.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="2663.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2663.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2663.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_0_2 -->
<g id="edge218" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_0_2</title>
<path fill="none" stroke="black" d="M5644.89,-4888.34C5330.6,-4889.5 4083.47,-4891.22 3059.5,-4852 2928.82,-4846.99 2890.77,-4863.13 2760.06,-4833.14"/>
<polygon fill="black" stroke="black" points="2760.61,-4829.67 2750.07,-4830.8 2759.01,-4836.49 2760.61,-4829.67"/>
</g>
<!-- q_proj_1_0_3 -->
<g id="node110" class="node">
<title>q_proj_1_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="2941,-4833 2768,-4833 2768,-4750 2941,-4750 2941,-4833"/>
<text text-anchor="middle" x="2854.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2854.5" y="-4802.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="2854.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2854.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2854.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_0_3 -->
<g id="edge219" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_0_3</title>
<path fill="none" stroke="black" d="M5644.98,-4888.23C5344.83,-4888.88 4195.32,-4888.69 3250.5,-4852 3119.83,-4846.93 3081.77,-4863.13 2951.06,-4833.14"/>
<polygon fill="black" stroke="black" points="2951.61,-4829.67 2941.07,-4830.8 2950.01,-4836.49 2951.61,-4829.67"/>
</g>
<!-- k_proj_1_0_3 -->
<g id="node111" class="node">
<title>k_proj_1_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="3132,-4833 2959,-4833 2959,-4750 3132,-4750 3132,-4833"/>
<text text-anchor="middle" x="3045.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3045.5" y="-4802.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="3045.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3045.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3045.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_0_3 -->
<g id="edge220" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_0_3</title>
<path fill="none" stroke="black" d="M5644.77,-4888.09C5358.96,-4888.18 4307.67,-4886.04 3442.5,-4852 3311.4,-4846.84 3273.21,-4863.21 3142.09,-4833.14"/>
<polygon fill="black" stroke="black" points="3142.61,-4829.67 3132.07,-4830.8 3141.01,-4836.49 3142.61,-4829.67"/>
</g>
<!-- v_proj_1_0_3 -->
<g id="node112" class="node">
<title>v_proj_1_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="3323,-4833 3150,-4833 3150,-4750 3323,-4750 3323,-4833"/>
<text text-anchor="middle" x="3236.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="3236.5" y="-4802.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="3236.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3236.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3236.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_0_3 -->
<g id="edge221" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_0_3</title>
<path fill="none" stroke="black" d="M5644.67,-4887.93C5373.99,-4887.43 4420.39,-4883.41 3634.5,-4852 3502.97,-4846.74 3464.65,-4863.29 3333.13,-4833.15"/>
<polygon fill="black" stroke="black" points="3333.61,-4829.67 3323.07,-4830.8 3332.01,-4836.49 3333.61,-4829.67"/>
</g>
<!-- q_proj_1_1_0 -->
<g id="node113" class="node">
<title>q_proj_1_1_0</title>
<polygon fill="#ffccff" stroke="black" points="3514,-4833 3341,-4833 3341,-4750 3514,-4750 3514,-4833"/>
<text text-anchor="middle" x="3427.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="3427.5" y="-4802.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="3427.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3427.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3427.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_1_0 -->
<g id="edge222" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_1_0</title>
<path fill="none" stroke="black" d="M5644.73,-4887.72C5390.4,-4886.54 4535.34,-4880.55 3829.5,-4852 3696.11,-4846.6 3657.34,-4863.65 3523.85,-4833.09"/>
<polygon fill="black" stroke="black" points="3524.61,-4829.67 3514.07,-4830.8 3523.01,-4836.49 3524.61,-4829.67"/>
</g>
<!-- k_proj_1_1_0 -->
<g id="node114" class="node">
<title>k_proj_1_1_0</title>
<polygon fill="#ffccff" stroke="black" points="3705,-4833 3532,-4833 3532,-4750 3705,-4750 3705,-4833"/>
<text text-anchor="middle" x="3618.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="3618.5" y="-4802.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="3618.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3618.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3618.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_1_0 -->
<g id="edge223" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_1_0</title>
<path fill="none" stroke="black" d="M5644.77,-4887.53C5406.87,-4885.78 4645.84,-4878.37 4016.5,-4852 3884.98,-4846.49 3846.65,-4863.28 3715.13,-4833.15"/>
<polygon fill="black" stroke="black" points="3715.61,-4829.67 3705.07,-4830.8 3714.01,-4836.49 3715.61,-4829.67"/>
</g>
<!-- v_proj_1_1_0 -->
<g id="node115" class="node">
<title>v_proj_1_1_0</title>
<polygon fill="#ffccff" stroke="black" points="3896,-4833 3723,-4833 3723,-4750 3896,-4750 3896,-4833"/>
<text text-anchor="middle" x="3809.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="3809.5" y="-4802.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="3809.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3809.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3809.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_1_0 -->
<g id="edge224" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_1_0</title>
<path fill="none" stroke="black" d="M5644.98,-4887.21C5425.48,-4884.69 4762.24,-4875.51 4212.5,-4852 4078.69,-4846.28 4039.78,-4863.72 3905.88,-4833.09"/>
<polygon fill="black" stroke="black" points="3906.61,-4829.67 3896.07,-4830.8 3905.01,-4836.49 3906.61,-4829.67"/>
</g>
<!-- q_proj_1_1_1 -->
<g id="node116" class="node">
<title>q_proj_1_1_1</title>
<polygon fill="#ccffff" stroke="black" points="4087,-4833 3914,-4833 3914,-4750 4087,-4750 4087,-4833"/>
<text text-anchor="middle" x="4000.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="4000.5" y="-4802.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="4000.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4000.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4000.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_1_1 -->
<g id="edge225" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_1_1</title>
<path fill="none" stroke="black" d="M5644.73,-4886.87C5443.55,-4883.65 4873.93,-4873.2 4400.5,-4852 4268.13,-4846.07 4229.53,-4863.42 4097.19,-4833.16"/>
<polygon fill="black" stroke="black" points="4097.61,-4829.67 4087.07,-4830.8 4096.01,-4836.48 4097.61,-4829.67"/>
</g>
<!-- k_proj_1_1_1 -->
<g id="node117" class="node">
<title>k_proj_1_1_1</title>
<polygon fill="#ccffff" stroke="black" points="4278,-4833 4105,-4833 4105,-4750 4278,-4750 4278,-4833"/>
<text text-anchor="middle" x="4191.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="4191.5" y="-4802.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="4191.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4191.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4191.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_1_1 -->
<g id="edge226" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_1_1</title>
<path fill="none" stroke="black" d="M5644.69,-4886.34C5464.55,-4882.18 4992.38,-4870.31 4598.5,-4852 4462.98,-4845.7 4423.54,-4864.03 4288,-4833.12"/>
<polygon fill="black" stroke="black" points="4288.6,-4829.67 4278.07,-4830.81 4287.02,-4836.48 4288.6,-4829.67"/>
</g>
<!-- v_proj_1_1_1 -->
<g id="node118" class="node">
<title>v_proj_1_1_1</title>
<polygon fill="#ccffff" stroke="black" points="4469,-4833 4296,-4833 4296,-4750 4469,-4750 4469,-4833"/>
<text text-anchor="middle" x="4382.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="4382.5" y="-4802.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="4382.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4382.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4382.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_1_1 -->
<g id="edge227" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_1_1</title>
<path fill="none" stroke="black" d="M5644.92,-4885.76C5485.96,-4880.84 5102.09,-4868.25 4780.5,-4852 4649.03,-4845.36 4610.65,-4863.22 4479.13,-4833.15"/>
<polygon fill="black" stroke="black" points="4479.61,-4829.67 4469.07,-4830.8 4478.01,-4836.48 4479.61,-4829.67"/>
</g>
<!-- q_proj_1_1_2 -->
<g id="node119" class="node">
<title>q_proj_1_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="4660,-4833 4487,-4833 4487,-4750 4660,-4750 4660,-4833"/>
<text text-anchor="middle" x="4573.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="4573.5" y="-4802.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="4573.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4573.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4573.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_1_2 -->
<g id="edge228" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_1_2</title>
<path fill="none" stroke="black" d="M5644.65,-4887.56C5440,-4885.8 4873.44,-4877.19 4670.06,-4833.07"/>
<polygon fill="black" stroke="black" points="4670.6,-4829.6 4660.07,-4830.81 4669.05,-4836.43 4670.6,-4829.6"/>
</g>
<!-- k_proj_1_1_2 -->
<g id="node120" class="node">
<title>k_proj_1_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="4851,-4833 4678,-4833 4678,-4750 4851,-4750 4851,-4833"/>
<text text-anchor="middle" x="4764.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="4764.5" y="-4802.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="4764.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4764.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4764.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_1_2 -->
<g id="edge229" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_1_2</title>
<path fill="none" stroke="black" d="M5644.85,-4886.46C5467.94,-4882.3 5026.3,-4868.8 4861.08,-4833.07"/>
<polygon fill="black" stroke="black" points="4861.6,-4829.6 4851.07,-4830.8 4860.05,-4836.42 4861.6,-4829.6"/>
</g>
<!-- v_proj_1_1_2 -->
<g id="node121" class="node">
<title>v_proj_1_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="5042,-4833 4869,-4833 4869,-4750 5042,-4750 5042,-4833"/>
<text text-anchor="middle" x="4955.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="4955.5" y="-4802.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="4955.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4955.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4955.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_1_2 -->
<g id="edge230" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_1_2</title>
<path fill="none" stroke="black" d="M5644.75,-4884.87C5498.58,-4878.27 5178.81,-4861.35 5051.96,-4833.05"/>
<polygon fill="black" stroke="black" points="5052.63,-4829.61 5042.09,-4830.73 5051.02,-4836.43 5052.63,-4829.61"/>
</g>
<!-- q_proj_1_1_3 -->
<g id="node122" class="node">
<title>q_proj_1_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="5233,-4833 5060,-4833 5060,-4750 5233,-4750 5233,-4833"/>
<text text-anchor="middle" x="5146.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="5146.5" y="-4802.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="5146.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5146.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5146.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_1_3 -->
<g id="edge231" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_1_3</title>
<path fill="none" stroke="black" d="M5644.74,-4879.27C5580.1,-4871.74 5484.14,-4860.58 5400.5,-4851 5333.02,-4843.27 5312.13,-4850.43 5243.18,-4833.21"/>
<polygon fill="black" stroke="black" points="5243.68,-4829.73 5233.12,-4830.62 5241.93,-4836.5 5243.68,-4829.73"/>
</g>
<!-- k_proj_1_1_3 -->
<g id="node123" class="node">
<title>k_proj_1_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="5424,-4833 5251,-4833 5251,-4750 5424,-4750 5424,-4833"/>
<text text-anchor="middle" x="5337.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="5337.5" y="-4802.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="5337.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5337.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5337.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_1_3 -->
<g id="edge232" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_1_3</title>
<path fill="none" stroke="black" d="M5644.8,-4870.7C5615.21,-4864.12 5580.83,-4856.81 5549.5,-4851 5500.8,-4841.96 5484.94,-4846.78 5434.08,-4833.22"/>
<polygon fill="black" stroke="black" points="5434.73,-4829.77 5424.16,-4830.47 5432.86,-4836.52 5434.73,-4829.77"/>
</g>
<!-- v_proj_1_1_3 -->
<g id="node124" class="node">
<title>v_proj_1_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="5615,-4833 5442,-4833 5442,-4750 5615,-4750 5615,-4833"/>
<text text-anchor="middle" x="5528.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="5528.5" y="-4802.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="5528.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5528.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5528.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_1_3 -->
<g id="edge233" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_1_3</title>
<path fill="none" stroke="black" d="M5683.12,-4869.81C5664.78,-4860.64 5641.63,-4849.07 5618.88,-4837.69"/>
<polygon fill="black" stroke="black" points="5620.36,-4834.52 5609.85,-4833.17 5617.23,-4840.78 5620.36,-4834.52"/>
</g>
<!-- q_proj_1_2_0 -->
<g id="node125" class="node">
<title>q_proj_1_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="5806,-4833 5633,-4833 5633,-4750 5806,-4750 5806,-4833"/>
<text text-anchor="middle" x="5719.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5719.5" y="-4802.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="5719.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5719.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5719.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_2_0 -->
<g id="edge234" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_2_0</title>
<path fill="none" stroke="black" d="M5719.5,-4869.59C5719.5,-4861.94 5719.5,-4852.66 5719.5,-4843.23"/>
<polygon fill="black" stroke="black" points="5723,-4843 5719.5,-4833 5716,-4843 5723,-4843"/>
</g>
<!-- k_proj_1_2_0 -->
<g id="node126" class="node">
<title>k_proj_1_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="5997,-4833 5824,-4833 5824,-4750 5997,-4750 5997,-4833"/>
<text text-anchor="middle" x="5910.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5910.5" y="-4802.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="5910.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5910.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5910.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_2_0 -->
<g id="edge235" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_2_0</title>
<path fill="none" stroke="black" d="M5755.88,-4869.81C5774.22,-4860.64 5797.37,-4849.07 5820.12,-4837.69"/>
<polygon fill="black" stroke="black" points="5821.77,-4840.78 5829.15,-4833.17 5818.64,-4834.52 5821.77,-4840.78"/>
</g>
<!-- v_proj_1_2_0 -->
<g id="node127" class="node">
<title>v_proj_1_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="6188,-4833 6015,-4833 6015,-4750 6188,-4750 6188,-4833"/>
<text text-anchor="middle" x="6101.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="6101.5" y="-4802.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="6101.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6101.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6101.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_2_0 -->
<g id="edge236" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_2_0</title>
<path fill="none" stroke="black" d="M5794.01,-4878.04C5849.95,-4869.57 5928.35,-4855.57 6005.1,-4832.93"/>
<polygon fill="black" stroke="black" points="6006.36,-4836.2 6014.94,-4829.98 6004.35,-4829.5 6006.36,-4836.2"/>
</g>
<!-- q_proj_1_2_1 -->
<g id="node128" class="node">
<title>q_proj_1_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="6379,-4833 6206,-4833 6206,-4750 6379,-4750 6379,-4833"/>
<text text-anchor="middle" x="6292.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="6292.5" y="-4802.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="6292.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6292.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6292.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_2_1 -->
<g id="edge237" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_2_1</title>
<path fill="none" stroke="black" d="M5794.25,-4885.93C5887.06,-4881.91 6049.9,-4870.1 6195.73,-4832.96"/>
<polygon fill="black" stroke="black" points="6196.96,-4836.26 6205.76,-4830.36 6195.2,-4829.49 6196.96,-4836.26"/>
</g>
<!-- k_proj_1_2_1 -->
<g id="node129" class="node">
<title>k_proj_1_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="6570,-4833 6397,-4833 6397,-4750 6570,-4750 6570,-4833"/>
<text text-anchor="middle" x="6483.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="6483.5" y="-4802.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="6483.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6483.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6483.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_2_1 -->
<g id="edge238" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_2_1</title>
<path fill="none" stroke="black" d="M5794.13,-4884.83C5940.06,-4878.16 6259.33,-4861.11 6386.86,-4832.82"/>
<polygon fill="black" stroke="black" points="6387.85,-4836.18 6396.79,-4830.49 6386.26,-4829.36 6387.85,-4836.18"/>
</g>
<!-- v_proj_1_2_1 -->
<g id="node130" class="node">
<title>v_proj_1_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="6761,-4833 6588,-4833 6588,-4750 6761,-4750 6761,-4833"/>
<text text-anchor="middle" x="6674.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="6674.5" y="-4802.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="6674.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6674.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6674.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_2_1 -->
<g id="edge239" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_2_1</title>
<path fill="none" stroke="black" d="M5794.06,-4886.43C5970.74,-4882.19 6411.84,-4868.54 6577.75,-4832.84"/>
<polygon fill="black" stroke="black" points="6578.82,-4836.18 6587.81,-4830.56 6577.28,-4829.35 6578.82,-4836.18"/>
</g>
<!-- q_proj_1_2_2 -->
<g id="node131" class="node">
<title>q_proj_1_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="6952,-4833 6779,-4833 6779,-4750 6952,-4750 6952,-4833"/>
<text text-anchor="middle" x="6865.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6865.5" y="-4802.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="6865.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6865.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6865.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_2_2 -->
<g id="edge240" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_2_2</title>
<path fill="none" stroke="black" d="M5794.24,-4884.81C5929.42,-4878.97 6223.55,-4865.84 6471.5,-4852 6600.77,-4844.79 6638.49,-4862.54 6768.84,-4832.88"/>
<polygon fill="black" stroke="black" points="6769.86,-4836.24 6778.81,-4830.57 6768.27,-4829.42 6769.86,-4836.24"/>
</g>
<!-- k_proj_1_2_2 -->
<g id="node132" class="node">
<title>k_proj_1_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="7143,-4833 6970,-4833 6970,-4750 7143,-4750 7143,-4833"/>
<text text-anchor="middle" x="7056.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="7056.5" y="-4802.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="7056.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7056.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7056.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_2_2 -->
<g id="edge241" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_2_2</title>
<path fill="none" stroke="black" d="M5794.23,-4888.18C6023.8,-4888.19 6717.36,-4884.04 6959.99,-4832.79"/>
<polygon fill="black" stroke="black" points="6960.81,-4836.19 6969.82,-4830.63 6959.3,-4829.36 6960.81,-4836.19"/>
</g>
<!-- v_proj_1_2_2 -->
<g id="node133" class="node">
<title>v_proj_1_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="7334,-4833 7161,-4833 7161,-4750 7334,-4750 7334,-4833"/>
<text text-anchor="middle" x="7247.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="7247.5" y="-4802.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="7247.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7247.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7247.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_2_2 -->
<g id="edge242" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_2_2</title>
<path fill="none" stroke="black" d="M5794.03,-4886.48C5975.74,-4882.6 6456.05,-4871.23 6856.5,-4852 6984.53,-4845.85 7021.82,-4862.34 7150.94,-4832.86"/>
<polygon fill="black" stroke="black" points="7151.86,-4836.24 7160.81,-4830.56 7150.27,-4829.43 7151.86,-4836.24"/>
</g>
<!-- q_proj_1_2_3 -->
<g id="node134" class="node">
<title>q_proj_1_2_3</title>
<polygon fill="#aaffff" stroke="black" points="7525,-4833 7352,-4833 7352,-4750 7525,-4750 7525,-4833"/>
<text text-anchor="middle" x="7438.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7438.5" y="-4802.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="7438.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7438.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7438.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_2_3 -->
<g id="edge243" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_2_3</title>
<path fill="none" stroke="black" d="M5794.06,-4886.35C5986.41,-4881.97 6515.22,-4869.22 6955.5,-4852 7124.3,-4845.4 7172.76,-4870.3 7341.84,-4832.88"/>
<polygon fill="black" stroke="black" points="7342.84,-4836.24 7351.82,-4830.63 7341.3,-4829.41 7342.84,-4836.24"/>
</g>
<!-- k_proj_1_2_3 -->
<g id="node135" class="node">
<title>k_proj_1_2_3</title>
<polygon fill="#aaffff" stroke="black" points="7716,-4833 7543,-4833 7543,-4750 7716,-4750 7716,-4833"/>
<text text-anchor="middle" x="7629.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7629.5" y="-4802.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="7629.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7629.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7629.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_2_3 -->
<g id="edge244" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_2_3</title>
<path fill="none" stroke="black" d="M5794.05,-4886.56C6002.05,-4882.44 6606.46,-4869.73 7108.5,-4852 7294.23,-4845.44 7347.26,-4873.63 7533.01,-4832.83"/>
<polygon fill="black" stroke="black" points="7533.83,-4836.24 7542.83,-4830.64 7532.3,-4829.41 7533.83,-4836.24"/>
</g>
<!-- v_proj_1_2_3 -->
<g id="node136" class="node">
<title>v_proj_1_2_3</title>
<polygon fill="#aaffff" stroke="black" points="7907,-4833 7734,-4833 7734,-4750 7907,-4750 7907,-4833"/>
<text text-anchor="middle" x="7820.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7820.5" y="-4802.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="7820.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7820.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7820.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_2_3 -->
<g id="edge245" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_2_3</title>
<path fill="none" stroke="black" d="M5794.35,-4886.81C6019.46,-4883.1 6710.1,-4870.89 7282.5,-4852 7475.76,-4845.62 7530.84,-4875.11 7723.93,-4832.85"/>
<polygon fill="black" stroke="black" points="7724.83,-4836.24 7733.83,-4830.65 7723.31,-4829.41 7724.83,-4836.24"/>
</g>
<!-- q_proj_1_3_0 -->
<g id="node137" class="node">
<title>q_proj_1_3_0</title>
<polygon fill="#ff8888" stroke="black" points="8098,-4833 7925,-4833 7925,-4750 8098,-4750 8098,-4833"/>
<text text-anchor="middle" x="8011.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8011.5" y="-4802.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="8011.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8011.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8011.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_3_0 -->
<g id="edge246" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_3_0</title>
<path fill="none" stroke="black" d="M5794.31,-4887.03C6035.92,-4883.76 6817.25,-4872.25 7463.5,-4852 7661.23,-4845.8 7717.5,-4876 7915.01,-4832.83"/>
<polygon fill="black" stroke="black" points="7915.82,-4836.24 7924.83,-4830.65 7914.31,-4829.41 7915.82,-4836.24"/>
</g>
<!-- k_proj_1_3_0 -->
<g id="node138" class="node">
<title>k_proj_1_3_0</title>
<polygon fill="#ff8888" stroke="black" points="8289,-4833 8116,-4833 8116,-4750 8289,-4750 8289,-4833"/>
<text text-anchor="middle" x="8202.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8202.5" y="-4802.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="8202.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8202.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8202.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_3_0 -->
<g id="edge247" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_3_0</title>
<path fill="none" stroke="black" d="M5794.15,-4887.23C6051.94,-4884.45 6928.67,-4873.88 7652.5,-4852 7851.11,-4846 7907.62,-4876.18 8105.97,-4832.84"/>
<polygon fill="black" stroke="black" points="8106.82,-4836.24 8115.83,-4830.66 8105.31,-4829.41 8106.82,-4836.24"/>
</g>
<!-- v_proj_1_3_0 -->
<g id="node139" class="node">
<title>v_proj_1_3_0</title>
<polygon fill="#ff8888" stroke="black" points="8480,-4833 8307,-4833 8307,-4750 8480,-4750 8480,-4833"/>
<text text-anchor="middle" x="8393.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8393.5" y="-4802.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="8393.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8393.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8393.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_3_0 -->
<g id="edge248" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_3_0</title>
<path fill="none" stroke="black" d="M5794.26,-4887.4C6067.87,-4885.07 7040.62,-4875.54 7842.5,-4852 8041.55,-4846.16 8098.18,-4876.27 8296.95,-4832.85"/>
<polygon fill="black" stroke="black" points="8297.82,-4836.24 8306.83,-4830.66 8296.31,-4829.41 8297.82,-4836.24"/>
</g>
<!-- q_proj_1_3_1 -->
<g id="node140" class="node">
<title>q_proj_1_3_1</title>
<polygon fill="#88ff88" stroke="black" points="8671,-4833 8498,-4833 8498,-4750 8671,-4750 8671,-4833"/>
<text text-anchor="middle" x="8584.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="8584.5" y="-4802.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="8584.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8584.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8584.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_3_1 -->
<g id="edge249" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_3_1</title>
<path fill="none" stroke="black" d="M5794.4,-4887.54C6083.21,-4885.64 7152.33,-4877.18 8032.5,-4852 8231.99,-4846.29 8288.75,-4876.36 8487.93,-4832.85"/>
<polygon fill="black" stroke="black" points="8488.82,-4836.24 8497.83,-4830.66 8487.31,-4829.41 8488.82,-4836.24"/>
</g>
<!-- k_proj_1_3_1 -->
<g id="node141" class="node">
<title>k_proj_1_3_1</title>
<polygon fill="#88ff88" stroke="black" points="8862,-4833 8689,-4833 8689,-4750 8862,-4750 8862,-4833"/>
<text text-anchor="middle" x="8775.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="8775.5" y="-4802.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="8775.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8775.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8775.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_3_1 -->
<g id="edge250" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_3_1</title>
<path fill="none" stroke="black" d="M5794.03,-4887.67C6096.74,-4886.16 7263.86,-4878.84 8223.5,-4852 8423.43,-4846.41 8480.39,-4876.81 8679.07,-4833.09"/>
<polygon fill="black" stroke="black" points="8679.95,-4836.48 8688.94,-4830.88 8678.42,-4829.64 8679.95,-4836.48"/>
</g>
<!-- v_proj_1_3_1 -->
<g id="node142" class="node">
<title>v_proj_1_3_1</title>
<polygon fill="#88ff88" stroke="black" points="9053,-4833 8880,-4833 8880,-4750 9053,-4750 9053,-4833"/>
<text text-anchor="middle" x="8966.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="8966.5" y="-4802.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="8966.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8966.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8966.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_3_1 -->
<g id="edge251" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_3_1</title>
<path fill="none" stroke="black" d="M5794,-4887.77C6110.57,-4886.65 7375.52,-4880.53 8414.5,-4852 8614.44,-4846.51 8671.39,-4876.81 8870.07,-4833.09"/>
<polygon fill="black" stroke="black" points="8870.95,-4836.48 8879.94,-4830.88 8869.42,-4829.64 8870.95,-4836.48"/>
</g>
<!-- q_proj_1_3_2 -->
<g id="node143" class="node">
<title>q_proj_1_3_2</title>
<polygon fill="#8888ff" stroke="black" points="9244,-4833 9071,-4833 9071,-4750 9244,-4750 9244,-4833"/>
<text text-anchor="middle" x="9157.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9157.5" y="-4802.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="9157.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="9157.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9157.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_3_2 -->
<g id="edge252" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_3_2</title>
<path fill="none" stroke="black" d="M5794.18,-4887.86C6124.42,-4887.09 7486.63,-4882.16 8604.5,-4852 8804.87,-4846.59 8861.95,-4876.9 9061.05,-4833.09"/>
<polygon fill="black" stroke="black" points="9061.95,-4836.48 9070.94,-4830.88 9060.42,-4829.64 9061.95,-4836.48"/>
</g>
<!-- k_proj_1_3_2 -->
<g id="node144" class="node">
<title>k_proj_1_3_2</title>
<polygon fill="#8888ff" stroke="black" points="9435,-4833 9262,-4833 9262,-4750 9435,-4750 9435,-4833"/>
<text text-anchor="middle" x="9348.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9348.5" y="-4802.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="9348.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="9348.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9348.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_3_2 -->
<g id="edge253" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_3_2</title>
<path fill="none" stroke="black" d="M5794.15,-4887.94C6137.26,-4887.51 7597.34,-4883.78 8794.5,-4852 8995.31,-4846.67 9052.51,-4876.99 9252.03,-4833.1"/>
<polygon fill="black" stroke="black" points="9252.95,-4836.48 9261.94,-4830.88 9251.42,-4829.64 9252.95,-4836.48"/>
</g>
<!-- v_proj_1_3_2 -->
<g id="node145" class="node">
<title>v_proj_1_3_2</title>
<polygon fill="#8888ff" stroke="black" points="9626,-4833 9453,-4833 9453,-4750 9626,-4750 9626,-4833"/>
<text text-anchor="middle" x="9539.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9539.5" y="-4802.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="9539.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="9539.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9539.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_3_2 -->
<g id="edge254" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_3_2</title>
<path fill="none" stroke="black" d="M5794.28,-4888.01C6150.24,-4887.91 7708.66,-4885.46 8985.5,-4852 9186.32,-4846.74 9243.51,-4876.99 9443.03,-4833.1"/>
<polygon fill="black" stroke="black" points="9443.95,-4836.48 9452.94,-4830.88 9442.42,-4829.64 9443.95,-4836.48"/>
</g>
<!-- q_proj_1_3_3 -->
<g id="node146" class="node">
<title>q_proj_1_3_3</title>
<polygon fill="#ffff88" stroke="black" points="9817,-4833 9644,-4833 9644,-4750 9817,-4750 9817,-4833"/>
<text text-anchor="middle" x="9730.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9730.5" y="-4802.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="9730.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="9730.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9730.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_3_3 -->
<g id="edge255" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_3_3</title>
<path fill="none" stroke="black" d="M5794.01,-4888.08C6161.7,-4888.29 7819.36,-4887.15 9176.5,-4852 9377.32,-4846.8 9434.51,-4876.99 9634.03,-4833.1"/>
<polygon fill="black" stroke="black" points="9634.95,-4836.48 9643.94,-4830.88 9633.42,-4829.64 9634.95,-4836.48"/>
</g>
<!-- k_proj_1_3_3 -->
<g id="node147" class="node">
<title>k_proj_1_3_3</title>
<polygon fill="#ffff88" stroke="black" points="10008,-4833 9835,-4833 9835,-4750 10008,-4750 10008,-4833"/>
<text text-anchor="middle" x="9921.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9921.5" y="-4802.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="9921.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="9921.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9921.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_3_3 -->
<g id="edge256" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_3_3</title>
<path fill="none" stroke="black" d="M5794,-4888.14C6173.56,-4888.65 7930.24,-4888.83 9367.5,-4852 9568.32,-4846.85 9625.51,-4876.99 9825.03,-4833.1"/>
<polygon fill="black" stroke="black" points="9825.95,-4836.48 9834.94,-4830.88 9824.42,-4829.64 9825.95,-4836.48"/>
</g>
<!-- v_proj_1_3_3 -->
<g id="node148" class="node">
<title>v_proj_1_3_3</title>
<polygon fill="#ffff88" stroke="black" points="10199,-4833 10026,-4833 10026,-4750 10199,-4750 10199,-4833"/>
<text text-anchor="middle" x="10112.5" y="-4817.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="10112.5" y="-4802.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="10112.5" y="-4787.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="10112.5" y="-4772.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="10112.5" y="-4757.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_3_3 -->
<g id="edge257" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_3_3</title>
<path fill="none" stroke="black" d="M5794.31,-4888.19C6186.13,-4888.99 8041.4,-4890.5 9558.5,-4852 9759.32,-4846.9 9816.51,-4877 10016.03,-4833.1"/>
<polygon fill="black" stroke="black" points="10016.95,-4836.48 10025.94,-4830.88 10015.42,-4829.64 10016.95,-4836.48"/>
</g>
<!-- ln2_1 -->
<g id="node186" class="node">
<title>ln2_1</title>
<polygon fill="lightgray" stroke="black" points="8663,-3926 8514,-3926 8514,-3888 8663,-3888 8663,-3926"/>
<text text-anchor="middle" x="8588.5" y="-3910.8" font-family="monospace" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8588.5" y="-3895.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- add_1&#45;&gt;ln2_1 -->
<g id="edge407" class="edge">
<title>add_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M8608.39,-3967.85C8604.52,-3956.22 8600.86,-3945.21 8597.76,-3935.87"/>
<polygon fill="black" stroke="black" points="8600.99,-3934.48 8594.51,-3926.09 8594.34,-3936.68 8600.99,-3934.48"/>
</g>
<!-- add2_1 -->
<g id="node187" class="node">
<title>add2_1</title>
<ellipse fill="lightgray" stroke="black" cx="8587.5" cy="-3432.5" rx="105.5" ry="105.5"/>
<text text-anchor="middle" x="8587.5" y="-3443.8" font-family="monospace" font-size="14.00">Add</text>
<text text-anchor="middle" x="8587.5" y="-3428.8" font-family="monospace" font-size="14.00">Residual</text>
<text text-anchor="middle" x="8587.5" y="-3413.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- add_1&#45;&gt;add2_1 -->
<g id="edge408" class="edge">
<title>add_1&#45;&gt;add2_1</title>
<path fill="none" stroke="black" d="M8684.83,-3972.23C8691.11,-3951.48 8695.5,-3929.34 8695.5,-3908 8695.5,-3908 8695.5,-3908 8695.5,-3622 8695.5,-3586.3 8680.73,-3551.23 8662.12,-3521.2"/>
<polygon fill="black" stroke="black" points="8664.86,-3518.98 8656.51,-3512.46 8658.97,-3522.77 8664.86,-3518.98"/>
</g>
<!-- attn_1_0_0 -->
<g id="node149" class="node">
<title>attn_1_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="1394,-4699 1295,-4699 1295,-4631 1394,-4631 1394,-4699"/>
<text text-anchor="middle" x="1344.5" y="-4683.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1344.5" y="-4668.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="1344.5" y="-4653.8" font-family="monospace" font-size="14.00">Heads[0&#45;3]</text>
<text text-anchor="middle" x="1344.5" y="-4638.8" font-family="monospace" font-size="14.00">Dim[0&#45;127]</text>
</g>
<!-- q_proj_1_0_0&#45;&gt;attn_1_0_0 -->
<g id="edge258" class="edge">
<title>q_proj_1_0_0&#45;&gt;attn_1_0_0</title>
<path fill="none" stroke="black" d="M1163.9,-4749.77C1173.75,-4737.92 1185.59,-4725.81 1198.5,-4717 1224.48,-4699.26 1257.27,-4687.07 1285.19,-4679.07"/>
<polygon fill="black" stroke="black" points="1286.13,-4682.45 1294.84,-4676.42 1284.27,-4675.7 1286.13,-4682.45"/>
</g>
<!-- q_proj_1_0_0&#45;&gt;attn_1_0_0 -->
<g id="edge259" class="edge">
<title>q_proj_1_0_0&#45;&gt;attn_1_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1201,-4749.91C1218.63,-4739.11 1237.74,-4727.52 1255.5,-4717 1265.34,-4711.17 1275.83,-4705.06 1286.05,-4699.17"/>
<polygon fill="red" stroke="red" points="1288,-4702.09 1294.92,-4694.07 1284.51,-4696.02 1288,-4702.09"/>
<text text-anchor="middle" x="1293.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_1_0_0&#45;&gt;attn_1_0_0 -->
<g id="edge260" class="edge">
<title>k_proj_1_0_0&#45;&gt;attn_1_0_0</title>
<path fill="none" stroke="black" d="M1332.39,-4749.73C1334.25,-4736.86 1336.32,-4722.6 1338.2,-4709.54"/>
<polygon fill="black" stroke="black" points="1341.71,-4709.78 1339.67,-4699.38 1334.78,-4708.78 1341.71,-4709.78"/>
</g>
<!-- k_proj_1_0_0&#45;&gt;attn_1_0_0 -->
<g id="edge261" class="edge">
<title>k_proj_1_0_0&#45;&gt;attn_1_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1343.13,-4749.75C1344.93,-4743.88 1346.48,-4737.85 1347.5,-4732 1348.77,-4724.7 1349.21,-4716.88 1349.15,-4709.26"/>
<polygon fill="red" stroke="red" points="1352.65,-4708.95 1348.8,-4699.08 1345.65,-4709.19 1352.65,-4708.95"/>
<text text-anchor="middle" x="1387.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_1_0_0&#45;&gt;attn_1_0_0 -->
<g id="edge262" class="edge">
<title>v_proj_1_0_0&#45;&gt;attn_1_0_0</title>
<path fill="none" stroke="black" d="M1471.53,-4749.82C1458.3,-4738.74 1443.61,-4727.04 1429.5,-4717 1421.1,-4711.03 1411.99,-4705.06 1402.94,-4699.42"/>
<polygon fill="black" stroke="black" points="1404.68,-4696.38 1394.32,-4694.13 1401.01,-4702.34 1404.68,-4696.38"/>
</g>
<!-- v_proj_1_0_0&#45;&gt;attn_1_0_0 -->
<g id="edge263" class="edge">
<title>v_proj_1_0_0&#45;&gt;attn_1_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1486.75,-4749.86C1476.69,-4738.28 1464.9,-4726.31 1452.5,-4717 1437.67,-4705.87 1420.02,-4696.29 1403.33,-4688.54"/>
<polygon fill="red" stroke="red" points="1404.74,-4685.33 1394.18,-4684.42 1401.86,-4691.71 1404.74,-4685.33"/>
<text text-anchor="middle" x="1507.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_1_0_1 -->
<g id="node152" class="node">
<title>attn_1_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="1984.5,-4699 1868.5,-4699 1868.5,-4631 1984.5,-4631 1984.5,-4699"/>
<text text-anchor="middle" x="1926.5" y="-4683.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1926.5" y="-4668.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="1926.5" y="-4653.8" font-family="monospace" font-size="14.00">Heads[0&#45;3]</text>
<text text-anchor="middle" x="1926.5" y="-4638.8" font-family="monospace" font-size="14.00">Dim[128&#45;255]</text>
</g>
<!-- q_proj_1_0_1&#45;&gt;attn_1_0_1 -->
<g id="edge267" class="edge">
<title>q_proj_1_0_1&#45;&gt;attn_1_0_1</title>
<path fill="none" stroke="black" d="M1736.8,-4749.63C1746.65,-4737.77 1758.51,-4725.7 1771.5,-4717 1797.5,-4699.59 1829.93,-4687.71 1858.39,-4679.82"/>
<polygon fill="black" stroke="black" points="1859.51,-4683.15 1868.28,-4677.2 1857.71,-4676.38 1859.51,-4683.15"/>
</g>
<!-- q_proj_1_0_1&#45;&gt;attn_1_0_1 -->
<g id="edge268" class="edge">
<title>q_proj_1_0_1&#45;&gt;attn_1_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1775.8,-4749.98C1794.11,-4739.13 1814,-4727.5 1832.5,-4717 1841.16,-4712.09 1850.32,-4706.99 1859.38,-4702.01"/>
<polygon fill="red" stroke="red" points="1861.3,-4704.95 1868.39,-4697.08 1857.94,-4698.81 1861.3,-4704.95"/>
<text text-anchor="middle" x="1870.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_1_0_1&#45;&gt;attn_1_0_1 -->
<g id="edge269" class="edge">
<title>k_proj_1_0_1&#45;&gt;attn_1_0_1</title>
<path fill="none" stroke="black" d="M1908.34,-4749.73C1911.16,-4736.74 1914.29,-4722.31 1917.14,-4709.15"/>
<polygon fill="black" stroke="black" points="1920.56,-4709.89 1919.26,-4699.38 1913.72,-4708.41 1920.56,-4709.89"/>
</g>
<!-- k_proj_1_0_1&#45;&gt;attn_1_0_1 -->
<g id="edge270" class="edge">
<title>k_proj_1_0_1&#45;&gt;attn_1_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1922.57,-4749.84C1925.01,-4744.01 1927.1,-4737.96 1928.5,-4732 1930.19,-4724.79 1930.9,-4717.01 1931.01,-4709.41"/>
<polygon fill="red" stroke="red" points="1934.51,-4709.17 1930.84,-4699.23 1927.51,-4709.29 1934.51,-4709.17"/>
<text text-anchor="middle" x="1969.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_1_0_1&#45;&gt;attn_1_0_1 -->
<g id="edge271" class="edge">
<title>v_proj_1_0_1&#45;&gt;attn_1_0_1</title>
<path fill="none" stroke="black" d="M2050.11,-4749.89C2038.13,-4738.69 2024.67,-4726.91 2011.5,-4717 2005.73,-4712.66 1999.57,-4708.38 1993.31,-4704.24"/>
<polygon fill="black" stroke="black" points="1995.02,-4701.18 1984.72,-4698.71 1991.23,-4707.07 1995.02,-4701.18"/>
</g>
<!-- v_proj_1_0_1&#45;&gt;attn_1_0_1 -->
<g id="edge272" class="edge">
<title>v_proj_1_0_1&#45;&gt;attn_1_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2065.43,-4749.67C2056.95,-4738.09 2046.75,-4726.15 2035.5,-4717 2023.2,-4706.99 2008.62,-4698.44 1994.19,-4691.36"/>
<polygon fill="red" stroke="red" points="1995.29,-4688 1984.75,-4686.91 1992.3,-4694.34 1995.29,-4688"/>
<text text-anchor="middle" x="2088.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_1_0_2 -->
<g id="node154" class="node">
<title>attn_1_0_2</title>
<polygon fill="#ccccff" stroke="black" points="2530.5,-4699 2414.5,-4699 2414.5,-4631 2530.5,-4631 2530.5,-4699"/>
<text text-anchor="middle" x="2472.5" y="-4683.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2472.5" y="-4668.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="2472.5" y="-4653.8" font-family="monospace" font-size="14.00">Heads[0&#45;3]</text>
<text text-anchor="middle" x="2472.5" y="-4638.8" font-family="monospace" font-size="14.00">Dim[256&#45;383]</text>
</g>
<!-- q_proj_1_0_2&#45;&gt;attn_1_0_2 -->
<g id="edge276" class="edge">
<title>q_proj_1_0_2&#45;&gt;attn_1_0_2</title>
<path fill="none" stroke="black" d="M2299.83,-4749.68C2306.77,-4737.82 2315.67,-4725.74 2326.5,-4717 2348.83,-4698.99 2377.95,-4687.13 2404.31,-4679.42"/>
<polygon fill="black" stroke="black" points="2405.55,-4682.71 2414.26,-4676.67 2403.68,-4675.96 2405.55,-4682.71"/>
</g>
<!-- q_proj_1_0_2&#45;&gt;attn_1_0_2 -->
<g id="edge277" class="edge">
<title>q_proj_1_0_2&#45;&gt;attn_1_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2342.44,-4749.87C2358.67,-4739.13 2376.22,-4727.58 2392.5,-4717 2398.67,-4712.99 2405.13,-4708.83 2411.58,-4704.68"/>
<polygon fill="red" stroke="red" points="2413.81,-4707.41 2420.35,-4699.06 2410.04,-4701.51 2413.81,-4707.41"/>
<text text-anchor="middle" x="2430.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_1_0_2&#45;&gt;attn_1_0_2 -->
<g id="edge278" class="edge">
<title>k_proj_1_0_2&#45;&gt;attn_1_0_2</title>
<path fill="none" stroke="black" d="M2472.5,-4749.73C2472.5,-4736.86 2472.5,-4722.6 2472.5,-4709.54"/>
<polygon fill="black" stroke="black" points="2476,-4709.38 2472.5,-4699.38 2469,-4709.38 2476,-4709.38"/>
</g>
<!-- k_proj_1_0_2&#45;&gt;attn_1_0_2 -->
<g id="edge279" class="edge">
<title>k_proj_1_0_2&#45;&gt;attn_1_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2485.01,-4749.81C2486.97,-4739.17 2487.94,-4727.68 2486.5,-4717 2486.16,-4714.45 2485.72,-4711.85 2485.22,-4709.24"/>
<polygon fill="red" stroke="red" points="2488.57,-4708.21 2482.99,-4699.2 2481.74,-4709.72 2488.57,-4708.21"/>
<text text-anchor="middle" x="2525.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_1_0_2&#45;&gt;attn_1_0_2 -->
<g id="edge280" class="edge">
<title>v_proj_1_0_2&#45;&gt;attn_1_0_2</title>
<path fill="none" stroke="black" d="M2613.29,-4749.64C2598.85,-4738.56 2582.84,-4726.9 2567.5,-4717 2558.59,-4711.25 2548.97,-4705.55 2539.39,-4700.15"/>
<polygon fill="black" stroke="black" points="2541.07,-4697.08 2530.63,-4695.29 2537.67,-4703.2 2541.07,-4697.08"/>
</g>
<!-- v_proj_1_0_2&#45;&gt;attn_1_0_2 -->
<g id="edge281" class="edge">
<title>v_proj_1_0_2&#45;&gt;attn_1_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2629.62,-4749.66C2618.62,-4738.08 2605.8,-4726.15 2592.5,-4717 2576.68,-4706.13 2558.18,-4696.86 2540.5,-4689.33"/>
<polygon fill="red" stroke="red" points="2541.37,-4685.9 2530.79,-4685.33 2538.7,-4692.37 2541.37,-4685.9"/>
<text text-anchor="middle" x="2648.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_1_0_3 -->
<g id="node156" class="node">
<title>attn_1_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="2962.5,-4699 2846.5,-4699 2846.5,-4631 2962.5,-4631 2962.5,-4699"/>
<text text-anchor="middle" x="2904.5" y="-4683.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2904.5" y="-4668.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="2904.5" y="-4653.8" font-family="monospace" font-size="14.00">Heads[0&#45;3]</text>
<text text-anchor="middle" x="2904.5" y="-4638.8" font-family="monospace" font-size="14.00">Dim[384&#45;511]</text>
</g>
<!-- q_proj_1_0_3&#45;&gt;attn_1_0_3 -->
<g id="edge285" class="edge">
<title>q_proj_1_0_3&#45;&gt;attn_1_0_3</title>
<path fill="none" stroke="black" d="M2870.87,-4749.73C2876.14,-4736.61 2882,-4722.03 2887.32,-4708.77"/>
<polygon fill="black" stroke="black" points="2890.62,-4709.96 2891.09,-4699.38 2884.12,-4707.35 2890.62,-4709.96"/>
</g>
<!-- q_proj_1_0_3&#45;&gt;attn_1_0_3 -->
<g id="edge286" class="edge">
<title>q_proj_1_0_3&#45;&gt;attn_1_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2882.77,-4749.97C2886.06,-4744.12 2889.1,-4738.03 2891.5,-4732 2894.36,-4724.83 2896.6,-4716.97 2898.37,-4709.25"/>
<polygon fill="red" stroke="red" points="2901.84,-4709.75 2900.42,-4699.25 2894.98,-4708.34 2901.84,-4709.75"/>
<text text-anchor="middle" x="2934.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_1_0_3&#45;&gt;attn_1_0_3 -->
<g id="edge287" class="edge">
<title>k_proj_1_0_3&#45;&gt;attn_1_0_3</title>
<path fill="none" stroke="black" d="M3010,-4749.77C2999.63,-4738.69 2987.98,-4727 2976.5,-4717 2971.88,-4712.97 2966.94,-4708.96 2961.9,-4705.05"/>
<polygon fill="black" stroke="black" points="2964.01,-4702.26 2953.92,-4699.01 2959.78,-4707.84 2964.01,-4702.26"/>
</g>
<!-- k_proj_1_0_3&#45;&gt;attn_1_0_3 -->
<g id="edge288" class="edge">
<title>k_proj_1_0_3&#45;&gt;attn_1_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3024.67,-4749.96C3017.45,-4738.39 3008.59,-4726.39 2998.5,-4717 2990.49,-4709.54 2981.18,-4702.82 2971.6,-4696.88"/>
<polygon fill="red" stroke="red" points="2973.14,-4693.72 2962.75,-4691.65 2969.58,-4699.75 2973.14,-4693.72"/>
<text text-anchor="middle" x="3049.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_1_0_3&#45;&gt;attn_1_0_3 -->
<g id="edge289" class="edge">
<title>v_proj_1_0_3&#45;&gt;attn_1_0_3</title>
<path fill="none" stroke="black" d="M3163.68,-4749.96C3140.99,-4738.32 3115.6,-4726.28 3091.5,-4717 3053.04,-4702.18 3008.57,-4689.87 2972.65,-4681.06"/>
<polygon fill="black" stroke="black" points="2973.3,-4677.61 2962.76,-4678.66 2971.66,-4684.42 2973.3,-4677.61"/>
</g>
<!-- v_proj_1_0_3&#45;&gt;attn_1_0_3 -->
<g id="edge290" class="edge">
<title>v_proj_1_0_3&#45;&gt;attn_1_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3181.8,-4749.84C3163.66,-4737.85 3142.88,-4725.65 3122.5,-4717 3074.37,-4696.58 3016.62,-4683.54 2972.66,-4675.76"/>
<polygon fill="red" stroke="red" points="2973.1,-4672.28 2962.65,-4674.03 2971.91,-4679.18 2973.1,-4672.28"/>
<text text-anchor="middle" x="3190.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_1_1_0 -->
<g id="node158" class="node">
<title>attn_1_1_0</title>
<polygon fill="#ffccff" stroke="black" points="3715,-4699 3616,-4699 3616,-4631 3715,-4631 3715,-4699"/>
<text text-anchor="middle" x="3665.5" y="-4683.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="3665.5" y="-4668.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3665.5" y="-4653.8" font-family="monospace" font-size="14.00">Heads[4&#45;7]</text>
<text text-anchor="middle" x="3665.5" y="-4638.8" font-family="monospace" font-size="14.00">Dim[0&#45;127]</text>
</g>
<!-- q_proj_1_1_0&#45;&gt;attn_1_1_0 -->
<g id="edge294" class="edge">
<title>q_proj_1_1_0&#45;&gt;attn_1_1_0</title>
<path fill="none" stroke="black" d="M3447.79,-4749.95C3455.6,-4737.82 3465.56,-4725.51 3477.5,-4717 3515.25,-4690.1 3566.47,-4677.38 3605.92,-4671.38"/>
<polygon fill="black" stroke="black" points="3606.52,-4674.82 3615.93,-4669.95 3605.54,-4667.89 3606.52,-4674.82"/>
</g>
<!-- q_proj_1_1_0&#45;&gt;attn_1_1_0 -->
<g id="edge295" class="edge">
<title>q_proj_1_1_0&#45;&gt;attn_1_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3500.2,-4749.84C3519.99,-4738.98 3541.48,-4727.39 3561.5,-4717 3576.06,-4709.44 3591.9,-4701.52 3606.73,-4694.24"/>
<polygon fill="red" stroke="red" points="3608.36,-4697.34 3615.81,-4689.8 3605.28,-4691.05 3608.36,-4697.34"/>
<text text-anchor="middle" x="3599.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_1_1_0&#45;&gt;attn_1_1_0 -->
<g id="edge296" class="edge">
<title>k_proj_1_1_0&#45;&gt;attn_1_1_0</title>
<path fill="none" stroke="black" d="M3633.89,-4749.73C3638.84,-4736.61 3644.35,-4722.03 3649.36,-4708.77"/>
<polygon fill="black" stroke="black" points="3652.64,-4709.97 3652.9,-4699.38 3646.09,-4707.5 3652.64,-4709.97"/>
</g>
<!-- k_proj_1_1_0&#45;&gt;attn_1_1_0 -->
<g id="edge297" class="edge">
<title>k_proj_1_1_0&#45;&gt;attn_1_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3648.94,-4749.93C3652.27,-4744.13 3655.26,-4738.07 3657.5,-4732 3660.15,-4724.85 3661.96,-4716.99 3663.19,-4709.28"/>
<polygon fill="red" stroke="red" points="3666.67,-4709.65 3664.5,-4699.28 3659.73,-4708.74 3666.67,-4709.65"/>
<text text-anchor="middle" x="3700.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_1_1_0&#45;&gt;attn_1_1_0 -->
<g id="edge298" class="edge">
<title>v_proj_1_1_0&#45;&gt;attn_1_1_0</title>
<path fill="none" stroke="black" d="M3775.72,-4749.86C3765.56,-4738.66 3754.04,-4726.88 3742.5,-4717 3736.59,-4711.94 3730.16,-4706.96 3723.61,-4702.23"/>
<polygon fill="black" stroke="black" points="3725.47,-4699.26 3715.28,-4696.36 3721.44,-4704.98 3725.47,-4699.26"/>
</g>
<!-- v_proj_1_1_0&#45;&gt;attn_1_1_0 -->
<g id="edge299" class="edge">
<title>v_proj_1_1_0&#45;&gt;attn_1_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3789.95,-4749.81C3783.05,-4738.23 3774.48,-4726.27 3764.5,-4717 3752.88,-4706.21 3738.54,-4697.09 3724.42,-4689.69"/>
<polygon fill="red" stroke="red" points="3725.71,-4686.42 3715.2,-4685.08 3722.58,-4692.68 3725.71,-4686.42"/>
<text text-anchor="middle" x="3815.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_1_1_1 -->
<g id="node161" class="node">
<title>attn_1_1_1</title>
<polygon fill="#ccffff" stroke="black" points="4282.5,-4699 4166.5,-4699 4166.5,-4631 4282.5,-4631 4282.5,-4699"/>
<text text-anchor="middle" x="4224.5" y="-4683.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="4224.5" y="-4668.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4224.5" y="-4653.8" font-family="monospace" font-size="14.00">Heads[4&#45;7]</text>
<text text-anchor="middle" x="4224.5" y="-4638.8" font-family="monospace" font-size="14.00">Dim[128&#45;255]</text>
</g>
<!-- q_proj_1_1_1&#45;&gt;attn_1_1_1 -->
<g id="edge303" class="edge">
<title>q_proj_1_1_1&#45;&gt;attn_1_1_1</title>
<path fill="none" stroke="black" d="M4032.1,-4749.69C4042.91,-4737.84 4055.77,-4725.75 4069.5,-4717 4095.79,-4700.25 4128.11,-4688.47 4156.42,-4680.5"/>
<polygon fill="black" stroke="black" points="4157.52,-4683.82 4166.25,-4677.83 4155.69,-4677.07 4157.52,-4683.82"/>
</g>
<!-- q_proj_1_1_1&#45;&gt;attn_1_1_1 -->
<g id="edge304" class="edge">
<title>q_proj_1_1_1&#45;&gt;attn_1_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4069.42,-4749.93C4088.17,-4739.08 4108.54,-4727.46 4127.5,-4717 4137.06,-4711.72 4147.22,-4706.24 4157.22,-4700.92"/>
<polygon fill="red" stroke="red" points="4159.14,-4703.87 4166.33,-4696.09 4155.86,-4697.68 4159.14,-4703.87"/>
<text text-anchor="middle" x="4165.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_1_1_1&#45;&gt;attn_1_1_1 -->
<g id="edge305" class="edge">
<title>k_proj_1_1_1&#45;&gt;attn_1_1_1</title>
<path fill="none" stroke="black" d="M4202.31,-4749.73C4205.75,-4736.74 4209.57,-4722.31 4213.06,-4709.15"/>
<polygon fill="black" stroke="black" points="4216.47,-4709.94 4215.65,-4699.38 4209.71,-4708.15 4216.47,-4709.94"/>
</g>
<!-- k_proj_1_1_1&#45;&gt;attn_1_1_1 -->
<g id="edge306" class="edge">
<title>k_proj_1_1_1&#45;&gt;attn_1_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4217,-4749.68C4219.65,-4743.92 4221.94,-4737.93 4223.5,-4732 4225.39,-4724.84 4226.39,-4717.09 4226.83,-4709.5"/>
<polygon fill="red" stroke="red" points="4230.33,-4709.42 4227.11,-4699.33 4223.33,-4709.23 4230.33,-4709.42"/>
<text text-anchor="middle" x="4264.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_1_1_1&#45;&gt;attn_1_1_1 -->
<g id="edge307" class="edge">
<title>v_proj_1_1_1&#45;&gt;attn_1_1_1</title>
<path fill="none" stroke="black" d="M4343.72,-4749.92C4332.2,-4738.73 4319.24,-4726.94 4306.5,-4717 4301.17,-4712.84 4295.49,-4708.73 4289.69,-4704.75"/>
<polygon fill="black" stroke="black" points="4291.41,-4701.69 4281.15,-4699.03 4287.51,-4707.5 4291.41,-4701.69"/>
</g>
<!-- v_proj_1_1_1&#45;&gt;attn_1_1_1 -->
<g id="edge308" class="edge">
<title>v_proj_1_1_1&#45;&gt;attn_1_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4358.49,-4749.74C4350.32,-4738.16 4340.46,-4726.21 4329.5,-4717 4318.28,-4707.57 4305.03,-4699.4 4291.77,-4692.52"/>
<polygon fill="red" stroke="red" points="4293.14,-4689.29 4282.63,-4687.98 4290.02,-4695.56 4293.14,-4689.29"/>
<text text-anchor="middle" x="4382.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_1_1_2 -->
<g id="node163" class="node">
<title>attn_1_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="4822.5,-4699 4706.5,-4699 4706.5,-4631 4822.5,-4631 4822.5,-4699"/>
<text text-anchor="middle" x="4764.5" y="-4683.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="4764.5" y="-4668.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4764.5" y="-4653.8" font-family="monospace" font-size="14.00">Heads[4&#45;7]</text>
<text text-anchor="middle" x="4764.5" y="-4638.8" font-family="monospace" font-size="14.00">Dim[256&#45;383]</text>
</g>
<!-- q_proj_1_1_2&#45;&gt;attn_1_1_2 -->
<g id="edge312" class="edge">
<title>q_proj_1_1_2&#45;&gt;attn_1_1_2</title>
<path fill="none" stroke="black" d="M4591.83,-4749.68C4598.77,-4737.82 4607.67,-4725.74 4618.5,-4717 4640.83,-4698.99 4669.95,-4687.13 4696.31,-4679.42"/>
<polygon fill="black" stroke="black" points="4697.55,-4682.71 4706.26,-4676.67 4695.68,-4675.96 4697.55,-4682.71"/>
</g>
<!-- q_proj_1_1_2&#45;&gt;attn_1_1_2 -->
<g id="edge313" class="edge">
<title>q_proj_1_1_2&#45;&gt;attn_1_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4634.44,-4749.87C4650.67,-4739.13 4668.22,-4727.58 4684.5,-4717 4690.67,-4712.99 4697.13,-4708.83 4703.58,-4704.68"/>
<polygon fill="red" stroke="red" points="4705.81,-4707.41 4712.35,-4699.06 4702.04,-4701.51 4705.81,-4707.41"/>
<text text-anchor="middle" x="4722.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_1_1_2&#45;&gt;attn_1_1_2 -->
<g id="edge314" class="edge">
<title>k_proj_1_1_2&#45;&gt;attn_1_1_2</title>
<path fill="none" stroke="black" d="M4764.5,-4749.73C4764.5,-4736.86 4764.5,-4722.6 4764.5,-4709.54"/>
<polygon fill="black" stroke="black" points="4768,-4709.38 4764.5,-4699.38 4761,-4709.38 4768,-4709.38"/>
</g>
<!-- k_proj_1_1_2&#45;&gt;attn_1_1_2 -->
<g id="edge315" class="edge">
<title>k_proj_1_1_2&#45;&gt;attn_1_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4777.01,-4749.81C4778.97,-4739.17 4779.94,-4727.68 4778.5,-4717 4778.16,-4714.45 4777.72,-4711.85 4777.22,-4709.24"/>
<polygon fill="red" stroke="red" points="4780.57,-4708.21 4774.99,-4699.2 4773.74,-4709.72 4780.57,-4708.21"/>
<text text-anchor="middle" x="4817.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_1_1_2&#45;&gt;attn_1_1_2 -->
<g id="edge316" class="edge">
<title>v_proj_1_1_2&#45;&gt;attn_1_1_2</title>
<path fill="none" stroke="black" d="M4905.29,-4749.64C4890.85,-4738.56 4874.84,-4726.9 4859.5,-4717 4850.59,-4711.25 4840.97,-4705.55 4831.39,-4700.15"/>
<polygon fill="black" stroke="black" points="4833.07,-4697.08 4822.63,-4695.29 4829.67,-4703.2 4833.07,-4697.08"/>
</g>
<!-- v_proj_1_1_2&#45;&gt;attn_1_1_2 -->
<g id="edge317" class="edge">
<title>v_proj_1_1_2&#45;&gt;attn_1_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4921.62,-4749.66C4910.62,-4738.08 4897.8,-4726.15 4884.5,-4717 4868.68,-4706.13 4850.18,-4696.86 4832.5,-4689.33"/>
<polygon fill="red" stroke="red" points="4833.37,-4685.9 4822.79,-4685.33 4830.7,-4692.37 4833.37,-4685.9"/>
<text text-anchor="middle" x="4940.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_1_1_3 -->
<g id="node165" class="node">
<title>attn_1_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="5386.5,-4699 5270.5,-4699 5270.5,-4631 5386.5,-4631 5386.5,-4699"/>
<text text-anchor="middle" x="5328.5" y="-4683.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="5328.5" y="-4668.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5328.5" y="-4653.8" font-family="monospace" font-size="14.00">Heads[4&#45;7]</text>
<text text-anchor="middle" x="5328.5" y="-4638.8" font-family="monospace" font-size="14.00">Dim[384&#45;511]</text>
</g>
<!-- q_proj_1_1_3&#45;&gt;attn_1_1_3 -->
<g id="edge321" class="edge">
<title>q_proj_1_1_3&#45;&gt;attn_1_1_3</title>
<path fill="none" stroke="black" d="M5163.19,-4749.77C5169.65,-4737.92 5178.05,-4725.81 5188.5,-4717 5209.01,-4699.7 5235.89,-4688.05 5260.6,-4680.31"/>
<polygon fill="black" stroke="black" points="5261.72,-4683.63 5270.31,-4677.43 5259.73,-4676.92 5261.72,-4683.63"/>
</g>
<!-- q_proj_1_1_3&#45;&gt;attn_1_1_3 -->
<g id="edge322" class="edge">
<title>q_proj_1_1_3&#45;&gt;attn_1_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5204.71,-4749.9C5220.21,-4739.16 5236.96,-4727.6 5252.5,-4717 5258.37,-4713 5264.5,-4708.84 5270.63,-4704.7"/>
<polygon fill="red" stroke="red" points="5272.62,-4707.58 5278.96,-4699.09 5268.71,-4701.77 5272.62,-4707.58"/>
<text text-anchor="middle" x="5290.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_1_1_3&#45;&gt;attn_1_1_3 -->
<g id="edge323" class="edge">
<title>k_proj_1_1_3&#45;&gt;attn_1_1_3</title>
<path fill="none" stroke="black" d="M5334.55,-4749.73C5333.62,-4736.86 5332.59,-4722.6 5331.65,-4709.54"/>
<polygon fill="black" stroke="black" points="5335.12,-4709.1 5330.91,-4699.38 5328.14,-4709.61 5335.12,-4709.1"/>
</g>
<!-- k_proj_1_1_3&#45;&gt;attn_1_1_3 -->
<g id="edge324" class="edge">
<title>k_proj_1_1_3&#45;&gt;attn_1_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5347.57,-4749.96C5349,-4739.22 5349.42,-4727.65 5347.5,-4717 5347.02,-4714.35 5346.41,-4711.65 5345.71,-4708.95"/>
<polygon fill="red" stroke="red" points="5349.03,-4707.84 5342.81,-4699.27 5342.33,-4709.85 5349.03,-4707.84"/>
<text text-anchor="middle" x="5387.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_1_1_3&#45;&gt;attn_1_1_3 -->
<g id="edge325" class="edge">
<title>v_proj_1_1_3&#45;&gt;attn_1_1_3</title>
<path fill="none" stroke="black" d="M5477.26,-4749.87C5462.24,-4738.67 5445.53,-4726.9 5429.5,-4717 5418.82,-4710.4 5407.17,-4703.92 5395.71,-4697.91"/>
<polygon fill="black" stroke="black" points="5397.08,-4694.67 5386.58,-4693.2 5393.86,-4700.89 5397.08,-4694.67"/>
</g>
<!-- v_proj_1_1_3&#45;&gt;attn_1_1_3 -->
<g id="edge326" class="edge">
<title>v_proj_1_1_3&#45;&gt;attn_1_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5493.99,-4749.91C5482.6,-4738.2 5469.29,-4726.14 5455.5,-4717 5437.38,-4704.99 5415.98,-4695.05 5395.97,-4687.23"/>
<polygon fill="red" stroke="red" points="5397.18,-4683.95 5386.59,-4683.68 5394.7,-4690.49 5397.18,-4683.95"/>
<text text-anchor="middle" x="5512.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_1_2_0 -->
<g id="node167" class="node">
<title>attn_1_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="6014,-4699 5907,-4699 5907,-4631 6014,-4631 6014,-4699"/>
<text text-anchor="middle" x="5960.5" y="-4683.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5960.5" y="-4668.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5960.5" y="-4653.8" font-family="monospace" font-size="14.00">Heads[8&#45;11]</text>
<text text-anchor="middle" x="5960.5" y="-4638.8" font-family="monospace" font-size="14.00">Dim[0&#45;127]</text>
</g>
<!-- q_proj_1_2_0&#45;&gt;attn_1_2_0 -->
<g id="edge330" class="edge">
<title>q_proj_1_2_0&#45;&gt;attn_1_2_0</title>
<path fill="none" stroke="black" d="M5746.73,-4749.69C5756.46,-4737.69 5768.32,-4725.52 5781.5,-4717 5816.23,-4694.55 5860.96,-4681.8 5897.03,-4674.67"/>
<polygon fill="black" stroke="black" points="5897.77,-4678.09 5906.95,-4672.8 5896.48,-4671.21 5897.77,-4678.09"/>
</g>
<!-- q_proj_1_2_0&#45;&gt;attn_1_2_0 -->
<g id="edge331" class="edge">
<title>q_proj_1_2_0&#45;&gt;attn_1_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5792.36,-4749.97C5812.39,-4739.06 5834.19,-4727.4 5854.5,-4717 5868.37,-4709.9 5883.38,-4702.5 5897.63,-4695.61"/>
<polygon fill="red" stroke="red" points="5899.37,-4698.66 5906.86,-4691.16 5896.33,-4692.35 5899.37,-4698.66"/>
<text text-anchor="middle" x="5892.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_1_2_0&#45;&gt;attn_1_2_0 -->
<g id="edge332" class="edge">
<title>k_proj_1_2_0&#45;&gt;attn_1_2_0</title>
<path fill="none" stroke="black" d="M5926.87,-4749.73C5932.14,-4736.61 5938,-4722.03 5943.32,-4708.77"/>
<polygon fill="black" stroke="black" points="5946.62,-4709.96 5947.09,-4699.38 5940.12,-4707.35 5946.62,-4709.96"/>
</g>
<!-- k_proj_1_2_0&#45;&gt;attn_1_2_0 -->
<g id="edge333" class="edge">
<title>k_proj_1_2_0&#45;&gt;attn_1_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5938.77,-4749.97C5942.06,-4744.12 5945.1,-4738.03 5947.5,-4732 5950.36,-4724.83 5952.6,-4716.97 5954.37,-4709.25"/>
<polygon fill="red" stroke="red" points="5957.84,-4709.75 5956.42,-4699.25 5950.98,-4708.34 5957.84,-4709.75"/>
<text text-anchor="middle" x="5990.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_1_2_0&#45;&gt;attn_1_2_0 -->
<g id="edge334" class="edge">
<title>v_proj_1_2_0&#45;&gt;attn_1_2_0</title>
<path fill="none" stroke="black" d="M6066,-4749.77C6055.63,-4738.69 6043.98,-4727 6032.5,-4717 6027.88,-4712.97 6022.94,-4708.96 6017.9,-4705.05"/>
<polygon fill="black" stroke="black" points="6020.01,-4702.26 6009.92,-4699.01 6015.78,-4707.84 6020.01,-4702.26"/>
</g>
<!-- v_proj_1_2_0&#45;&gt;attn_1_2_0 -->
<g id="edge335" class="edge">
<title>v_proj_1_2_0&#45;&gt;attn_1_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6080.67,-4749.96C6073.45,-4738.39 6064.59,-4726.39 6054.5,-4717 6045.28,-4708.42 6034.34,-4700.8 6023.24,-4694.24"/>
<polygon fill="red" stroke="red" points="6024.77,-4691.08 6014.34,-4689.21 6021.32,-4697.18 6024.77,-4691.08"/>
<text text-anchor="middle" x="6105.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_1_2_1 -->
<g id="node170" class="node">
<title>attn_1_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="6547.5,-4699 6431.5,-4699 6431.5,-4631 6547.5,-4631 6547.5,-4699"/>
<text text-anchor="middle" x="6489.5" y="-4683.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="6489.5" y="-4668.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6489.5" y="-4653.8" font-family="monospace" font-size="14.00">Heads[8&#45;11]</text>
<text text-anchor="middle" x="6489.5" y="-4638.8" font-family="monospace" font-size="14.00">Dim[128&#45;255]</text>
</g>
<!-- q_proj_1_2_1&#45;&gt;attn_1_2_1 -->
<g id="edge339" class="edge">
<title>q_proj_1_2_1&#45;&gt;attn_1_2_1</title>
<path fill="none" stroke="black" d="M6311.92,-4749.62C6319.18,-4737.77 6328.41,-4725.69 6339.5,-4717 6363.12,-4698.49 6393.85,-4686.49 6421.34,-4678.82"/>
<polygon fill="black" stroke="black" points="6422.53,-4682.12 6431.3,-4676.18 6420.74,-4675.36 6422.53,-4682.12"/>
</g>
<!-- q_proj_1_2_1&#45;&gt;attn_1_2_1 -->
<g id="edge340" class="edge">
<title>q_proj_1_2_1&#45;&gt;attn_1_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6355.06,-4749.82C6371.73,-4739.07 6389.76,-4727.54 6406.5,-4717 6413.04,-4712.88 6419.89,-4708.61 6426.73,-4704.37"/>
<polygon fill="red" stroke="red" points="6428.71,-4707.26 6435.37,-4699.03 6425.03,-4701.31 6428.71,-4707.26"/>
<text text-anchor="middle" x="6444.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_1_2_1&#45;&gt;attn_1_2_1 -->
<g id="edge341" class="edge">
<title>k_proj_1_2_1&#45;&gt;attn_1_2_1</title>
<path fill="none" stroke="black" d="M6485.46,-4749.73C6486.08,-4736.86 6486.77,-4722.6 6487.4,-4709.54"/>
<polygon fill="black" stroke="black" points="6490.91,-4709.54 6487.89,-4699.38 6483.91,-4709.2 6490.91,-4709.54"/>
</g>
<!-- k_proj_1_2_1&#45;&gt;attn_1_2_1 -->
<g id="edge342" class="edge">
<title>k_proj_1_2_1&#45;&gt;attn_1_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6498.86,-4749.62C6501.34,-4739.09 6502.74,-4727.7 6501.5,-4717 6501.21,-4714.47 6500.83,-4711.88 6500.4,-4709.28"/>
<polygon fill="red" stroke="red" points="6503.8,-4708.44 6498.49,-4699.27 6496.93,-4709.75 6503.8,-4708.44"/>
<text text-anchor="middle" x="6540.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_1_2_1&#45;&gt;attn_1_2_1 -->
<g id="edge343" class="edge">
<title>v_proj_1_2_1&#45;&gt;attn_1_2_1</title>
<path fill="none" stroke="black" d="M6626.98,-4749.97C6613.02,-4738.78 6597.47,-4726.98 6582.5,-4717 6574.34,-4711.56 6565.55,-4706.18 6556.75,-4701.07"/>
<polygon fill="black" stroke="black" points="6558.38,-4697.97 6547.96,-4696.05 6554.91,-4704.05 6558.38,-4697.97"/>
</g>
<!-- v_proj_1_2_1&#45;&gt;attn_1_2_1 -->
<g id="edge344" class="edge">
<title>v_proj_1_2_1&#45;&gt;attn_1_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6642.82,-4749.63C6632.45,-4738.05 6620.29,-4726.13 6607.5,-4717 6592.25,-4706.12 6574.31,-4696.89 6557.09,-4689.4"/>
<polygon fill="red" stroke="red" points="6558.19,-4686.06 6547.61,-4685.41 6555.48,-4692.52 6558.19,-4686.06"/>
<text text-anchor="middle" x="6662.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_1_2_2 -->
<g id="node172" class="node">
<title>attn_1_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="7114.5,-4699 6998.5,-4699 6998.5,-4631 7114.5,-4631 7114.5,-4699"/>
<text text-anchor="middle" x="7056.5" y="-4683.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="7056.5" y="-4668.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7056.5" y="-4653.8" font-family="monospace" font-size="14.00">Heads[8&#45;11]</text>
<text text-anchor="middle" x="7056.5" y="-4638.8" font-family="monospace" font-size="14.00">Dim[256&#45;383]</text>
</g>
<!-- q_proj_1_2_2&#45;&gt;attn_1_2_2 -->
<g id="edge348" class="edge">
<title>q_proj_1_2_2&#45;&gt;attn_1_2_2</title>
<path fill="none" stroke="black" d="M6883.83,-4749.68C6890.77,-4737.82 6899.67,-4725.74 6910.5,-4717 6932.83,-4698.99 6961.95,-4687.13 6988.31,-4679.42"/>
<polygon fill="black" stroke="black" points="6989.55,-4682.71 6998.26,-4676.67 6987.68,-4675.96 6989.55,-4682.71"/>
</g>
<!-- q_proj_1_2_2&#45;&gt;attn_1_2_2 -->
<g id="edge349" class="edge">
<title>q_proj_1_2_2&#45;&gt;attn_1_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6926.44,-4749.87C6942.67,-4739.13 6960.22,-4727.58 6976.5,-4717 6982.67,-4712.99 6989.13,-4708.83 6995.58,-4704.68"/>
<polygon fill="red" stroke="red" points="6997.81,-4707.41 7004.35,-4699.06 6994.04,-4701.51 6997.81,-4707.41"/>
<text text-anchor="middle" x="7014.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_1_2_2&#45;&gt;attn_1_2_2 -->
<g id="edge350" class="edge">
<title>k_proj_1_2_2&#45;&gt;attn_1_2_2</title>
<path fill="none" stroke="black" d="M7056.5,-4749.73C7056.5,-4736.86 7056.5,-4722.6 7056.5,-4709.54"/>
<polygon fill="black" stroke="black" points="7060,-4709.38 7056.5,-4699.38 7053,-4709.38 7060,-4709.38"/>
</g>
<!-- k_proj_1_2_2&#45;&gt;attn_1_2_2 -->
<g id="edge351" class="edge">
<title>k_proj_1_2_2&#45;&gt;attn_1_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7069.01,-4749.81C7070.97,-4739.17 7071.94,-4727.68 7070.5,-4717 7070.16,-4714.45 7069.72,-4711.85 7069.22,-4709.24"/>
<polygon fill="red" stroke="red" points="7072.57,-4708.21 7066.99,-4699.2 7065.74,-4709.72 7072.57,-4708.21"/>
<text text-anchor="middle" x="7109.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_1_2_2&#45;&gt;attn_1_2_2 -->
<g id="edge352" class="edge">
<title>v_proj_1_2_2&#45;&gt;attn_1_2_2</title>
<path fill="none" stroke="black" d="M7197.29,-4749.64C7182.85,-4738.56 7166.84,-4726.9 7151.5,-4717 7142.59,-4711.25 7132.97,-4705.55 7123.39,-4700.15"/>
<polygon fill="black" stroke="black" points="7125.07,-4697.08 7114.63,-4695.29 7121.67,-4703.2 7125.07,-4697.08"/>
</g>
<!-- v_proj_1_2_2&#45;&gt;attn_1_2_2 -->
<g id="edge353" class="edge">
<title>v_proj_1_2_2&#45;&gt;attn_1_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7213.62,-4749.66C7202.62,-4738.08 7189.8,-4726.15 7176.5,-4717 7160.68,-4706.13 7142.18,-4696.86 7124.5,-4689.33"/>
<polygon fill="red" stroke="red" points="7125.37,-4685.9 7114.79,-4685.33 7122.7,-4692.37 7125.37,-4685.9"/>
<text text-anchor="middle" x="7232.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_1_2_3 -->
<g id="node174" class="node">
<title>attn_1_2_3</title>
<polygon fill="#aaffff" stroke="black" points="7608.5,-4699 7492.5,-4699 7492.5,-4631 7608.5,-4631 7608.5,-4699"/>
<text text-anchor="middle" x="7550.5" y="-4683.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7550.5" y="-4668.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7550.5" y="-4653.8" font-family="monospace" font-size="14.00">Heads[8&#45;11]</text>
<text text-anchor="middle" x="7550.5" y="-4638.8" font-family="monospace" font-size="14.00">Dim[384&#45;511]</text>
</g>
<!-- q_proj_1_2_3&#45;&gt;attn_1_2_3 -->
<g id="edge357" class="edge">
<title>q_proj_1_2_3&#45;&gt;attn_1_2_3</title>
<path fill="none" stroke="black" d="M7465.21,-4749.89C7473.18,-4738.82 7482.26,-4727.09 7491.5,-4717 7494.9,-4713.29 7498.55,-4709.58 7502.32,-4705.95"/>
<polygon fill="black" stroke="black" points="7504.74,-4708.47 7509.66,-4699.09 7499.97,-4703.36 7504.74,-4708.47"/>
</g>
<!-- q_proj_1_2_3&#45;&gt;attn_1_2_3 -->
<g id="edge358" class="edge">
<title>q_proj_1_2_3&#45;&gt;attn_1_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7475.31,-4749.93C7480.75,-4743.93 7486.27,-4737.81 7491.5,-4732 7498.82,-4723.87 7506.63,-4715.15 7514.1,-4706.81"/>
<polygon fill="red" stroke="red" points="7516.77,-4709.06 7520.83,-4699.28 7511.56,-4704.4 7516.77,-4709.06"/>
<text text-anchor="middle" x="7542.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_1_2_3&#45;&gt;attn_1_2_3 -->
<g id="edge359" class="edge">
<title>k_proj_1_2_3&#45;&gt;attn_1_2_3</title>
<path fill="none" stroke="black" d="M7611.79,-4749.85C7606.43,-4738.89 7600.18,-4727.23 7593.5,-4717 7591.35,-4713.71 7589.02,-4710.4 7586.59,-4707.13"/>
<polygon fill="black" stroke="black" points="7589.28,-4704.88 7580.4,-4699.11 7583.74,-4709.17 7589.28,-4704.88"/>
</g>
<!-- k_proj_1_2_3&#45;&gt;attn_1_2_3 -->
<g id="edge360" class="edge">
<title>k_proj_1_2_3&#45;&gt;attn_1_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7624.99,-4749.74C7622.48,-4738.54 7618.57,-4726.8 7612.5,-4717 7610.27,-4713.4 7607.7,-4709.94 7604.89,-4706.63"/>
<polygon fill="red" stroke="red" points="7607.35,-4704.14 7597.98,-4699.2 7602.23,-4708.91 7607.35,-4704.14"/>
<text text-anchor="middle" x="7658.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_1_2_3&#45;&gt;attn_1_2_3 -->
<g id="edge361" class="edge">
<title>v_proj_1_2_3&#45;&gt;attn_1_2_3</title>
<path fill="none" stroke="black" d="M7759.98,-4749.84C7741.38,-4738.33 7720.52,-4726.39 7700.5,-4717 7674.44,-4704.78 7644.63,-4694.03 7618.48,-4685.58"/>
<polygon fill="black" stroke="black" points="7619.25,-4682.16 7608.66,-4682.46 7617.13,-4688.83 7619.25,-4682.16"/>
</g>
<!-- v_proj_1_2_3&#45;&gt;attn_1_2_3 -->
<g id="edge362" class="edge">
<title>v_proj_1_2_3&#45;&gt;attn_1_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7776.65,-4749.66C7762.16,-4737.81 7745.39,-4725.72 7728.5,-4717 7694.18,-4699.28 7652.87,-4686.96 7618.69,-4678.88"/>
<polygon fill="red" stroke="red" points="7619.32,-4675.43 7608.79,-4676.6 7617.75,-4682.25 7619.32,-4675.43"/>
<text text-anchor="middle" x="7789.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_1_3_0 -->
<g id="node176" class="node">
<title>attn_1_3_0</title>
<polygon fill="#ff8888" stroke="black" points="8287.5,-4699 8171.5,-4699 8171.5,-4631 8287.5,-4631 8287.5,-4699"/>
<text text-anchor="middle" x="8229.5" y="-4683.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8229.5" y="-4668.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8229.5" y="-4653.8" font-family="monospace" font-size="14.00">Heads[12&#45;15]</text>
<text text-anchor="middle" x="8229.5" y="-4638.8" font-family="monospace" font-size="14.00">Dim[0&#45;127]</text>
</g>
<!-- q_proj_1_3_0&#45;&gt;attn_1_3_0 -->
<g id="edge366" class="edge">
<title>q_proj_1_3_0&#45;&gt;attn_1_3_0</title>
<path fill="none" stroke="black" d="M8030.48,-4749.75C8037.77,-4737.76 8047.13,-4725.57 8058.5,-4717 8088.21,-4694.61 8127.67,-4682 8161.2,-4674.93"/>
<polygon fill="black" stroke="black" points="8162.27,-4678.28 8171.39,-4672.91 8160.9,-4671.42 8162.27,-4678.28"/>
</g>
<!-- q_proj_1_3_0&#45;&gt;attn_1_3_0 -->
<g id="edge367" class="edge">
<title>q_proj_1_3_0&#45;&gt;attn_1_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8078.8,-4749.98C8097.11,-4739.13 8117,-4727.5 8135.5,-4717 8144.16,-4712.09 8153.32,-4706.99 8162.38,-4702.01"/>
<polygon fill="red" stroke="red" points="8164.3,-4704.95 8171.39,-4697.08 8160.94,-4698.81 8164.3,-4704.95"/>
<text text-anchor="middle" x="8173.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_1_3_0&#45;&gt;attn_1_3_0 -->
<g id="edge368" class="edge">
<title>k_proj_1_3_0&#45;&gt;attn_1_3_0</title>
<path fill="none" stroke="black" d="M8211.34,-4749.73C8214.16,-4736.74 8217.29,-4722.31 8220.14,-4709.15"/>
<polygon fill="black" stroke="black" points="8223.56,-4709.89 8222.26,-4699.38 8216.72,-4708.41 8223.56,-4709.89"/>
</g>
<!-- k_proj_1_3_0&#45;&gt;attn_1_3_0 -->
<g id="edge369" class="edge">
<title>k_proj_1_3_0&#45;&gt;attn_1_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8225.57,-4749.84C8228.01,-4744.01 8230.1,-4737.96 8231.5,-4732 8233.19,-4724.79 8233.9,-4717.01 8234.01,-4709.41"/>
<polygon fill="red" stroke="red" points="8237.51,-4709.17 8233.84,-4699.23 8230.51,-4709.29 8237.51,-4709.17"/>
<text text-anchor="middle" x="8272.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_1_3_0&#45;&gt;attn_1_3_0 -->
<g id="edge370" class="edge">
<title>v_proj_1_3_0&#45;&gt;attn_1_3_0</title>
<path fill="none" stroke="black" d="M8353.11,-4749.89C8341.13,-4738.69 8327.67,-4726.91 8314.5,-4717 8308.73,-4712.66 8302.57,-4708.38 8296.31,-4704.24"/>
<polygon fill="black" stroke="black" points="8298.02,-4701.18 8287.72,-4698.71 8294.23,-4707.07 8298.02,-4701.18"/>
</g>
<!-- v_proj_1_3_0&#45;&gt;attn_1_3_0 -->
<g id="edge371" class="edge">
<title>v_proj_1_3_0&#45;&gt;attn_1_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8368.43,-4749.67C8359.95,-4738.09 8349.75,-4726.15 8338.5,-4717 8326.2,-4706.99 8311.62,-4698.44 8297.19,-4691.36"/>
<polygon fill="red" stroke="red" points="8298.29,-4688 8287.75,-4686.91 8295.3,-4694.34 8298.29,-4688"/>
<text text-anchor="middle" x="8391.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_1_3_1 -->
<g id="node179" class="node">
<title>attn_1_3_1</title>
<polygon fill="#88ff88" stroke="black" points="8833.5,-4699 8717.5,-4699 8717.5,-4631 8833.5,-4631 8833.5,-4699"/>
<text text-anchor="middle" x="8775.5" y="-4683.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="8775.5" y="-4668.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8775.5" y="-4653.8" font-family="monospace" font-size="14.00">Heads[12&#45;15]</text>
<text text-anchor="middle" x="8775.5" y="-4638.8" font-family="monospace" font-size="14.00">Dim[128&#45;255]</text>
</g>
<!-- q_proj_1_3_1&#45;&gt;attn_1_3_1 -->
<g id="edge375" class="edge">
<title>q_proj_1_3_1&#45;&gt;attn_1_3_1</title>
<path fill="none" stroke="black" d="M8602.83,-4749.68C8609.77,-4737.82 8618.67,-4725.74 8629.5,-4717 8651.83,-4698.99 8680.95,-4687.13 8707.31,-4679.42"/>
<polygon fill="black" stroke="black" points="8708.55,-4682.71 8717.26,-4676.67 8706.68,-4675.96 8708.55,-4682.71"/>
</g>
<!-- q_proj_1_3_1&#45;&gt;attn_1_3_1 -->
<g id="edge376" class="edge">
<title>q_proj_1_3_1&#45;&gt;attn_1_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8645.44,-4749.87C8661.67,-4739.13 8679.22,-4727.58 8695.5,-4717 8701.67,-4712.99 8708.13,-4708.83 8714.58,-4704.68"/>
<polygon fill="red" stroke="red" points="8716.81,-4707.41 8723.35,-4699.06 8713.04,-4701.51 8716.81,-4707.41"/>
<text text-anchor="middle" x="8733.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_1_3_1&#45;&gt;attn_1_3_1 -->
<g id="edge377" class="edge">
<title>k_proj_1_3_1&#45;&gt;attn_1_3_1</title>
<path fill="none" stroke="black" d="M8775.5,-4749.73C8775.5,-4736.86 8775.5,-4722.6 8775.5,-4709.54"/>
<polygon fill="black" stroke="black" points="8779,-4709.38 8775.5,-4699.38 8772,-4709.38 8779,-4709.38"/>
</g>
<!-- k_proj_1_3_1&#45;&gt;attn_1_3_1 -->
<g id="edge378" class="edge">
<title>k_proj_1_3_1&#45;&gt;attn_1_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8788.01,-4749.81C8789.97,-4739.17 8790.94,-4727.68 8789.5,-4717 8789.16,-4714.45 8788.72,-4711.85 8788.22,-4709.24"/>
<polygon fill="red" stroke="red" points="8791.57,-4708.21 8785.99,-4699.2 8784.74,-4709.72 8791.57,-4708.21"/>
<text text-anchor="middle" x="8827.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_1_3_1&#45;&gt;attn_1_3_1 -->
<g id="edge379" class="edge">
<title>v_proj_1_3_1&#45;&gt;attn_1_3_1</title>
<path fill="none" stroke="black" d="M8915.94,-4749.91C8901.29,-4738.78 8885.04,-4727.02 8869.5,-4717 8860.99,-4711.51 8851.83,-4706.04 8842.7,-4700.84"/>
<polygon fill="black" stroke="black" points="8844.4,-4697.78 8833.96,-4695.94 8840.97,-4703.89 8844.4,-4697.78"/>
</g>
<!-- v_proj_1_3_1&#45;&gt;attn_1_3_1 -->
<g id="edge380" class="edge">
<title>v_proj_1_3_1&#45;&gt;attn_1_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8932.04,-4749.7C8920.89,-4738.12 8907.91,-4726.18 8894.5,-4717 8878.85,-4706.29 8860.59,-4697.1 8843.14,-4689.59"/>
<polygon fill="red" stroke="red" points="8844.13,-4686.21 8833.55,-4685.59 8841.43,-4692.67 8844.13,-4686.21"/>
<text text-anchor="middle" x="8949.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_1_3_2 -->
<g id="node181" class="node">
<title>attn_1_3_2</title>
<polygon fill="#8888ff" stroke="black" points="9385.5,-4699 9269.5,-4699 9269.5,-4631 9385.5,-4631 9385.5,-4699"/>
<text text-anchor="middle" x="9327.5" y="-4683.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9327.5" y="-4668.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="9327.5" y="-4653.8" font-family="monospace" font-size="14.00">Heads[12&#45;15]</text>
<text text-anchor="middle" x="9327.5" y="-4638.8" font-family="monospace" font-size="14.00">Dim[256&#45;383]</text>
</g>
<!-- q_proj_1_3_2&#45;&gt;attn_1_3_2 -->
<g id="edge384" class="edge">
<title>q_proj_1_3_2&#45;&gt;attn_1_3_2</title>
<path fill="none" stroke="black" d="M9172,-4749.9C9177.82,-4738.06 9185.56,-4725.92 9195.5,-4717 9213.5,-4700.85 9237.18,-4689.58 9259.5,-4681.83"/>
<polygon fill="black" stroke="black" points="9260.89,-4685.05 9269.3,-4678.61 9258.7,-4678.4 9260.89,-4685.05"/>
</g>
<!-- q_proj_1_3_2&#45;&gt;attn_1_3_2 -->
<g id="edge385" class="edge">
<title>q_proj_1_3_2&#45;&gt;attn_1_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9210.96,-4749.99C9225.37,-4739.19 9240.98,-4727.59 9255.5,-4717 9260.91,-4713.06 9266.56,-4708.98 9272.23,-4704.92"/>
<polygon fill="red" stroke="red" points="9274.4,-4707.67 9280.5,-4699.01 9270.33,-4701.97 9274.4,-4707.67"/>
<text text-anchor="middle" x="9293.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_1_3_2&#45;&gt;attn_1_3_2 -->
<g id="edge386" class="edge">
<title>k_proj_1_3_2&#45;&gt;attn_1_3_2</title>
<path fill="none" stroke="black" d="M9341.62,-4749.73C9339.45,-4736.86 9337.05,-4722.6 9334.84,-4709.54"/>
<polygon fill="black" stroke="black" points="9338.24,-4708.66 9333.13,-4699.38 9331.34,-4709.82 9338.24,-4708.66"/>
</g>
<!-- k_proj_1_3_2&#45;&gt;attn_1_3_2 -->
<g id="edge387" class="edge">
<title>k_proj_1_3_2&#45;&gt;attn_1_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9353.05,-4749.74C9353.31,-4739 9352.75,-4727.48 9350.5,-4717 9349.9,-4714.2 9349.13,-4711.36 9348.24,-4708.54"/>
<polygon fill="red" stroke="red" points="9351.5,-4707.27 9344.81,-4699.05 9344.92,-4709.65 9351.5,-4707.27"/>
<text text-anchor="middle" x="9390.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_1_3_2&#45;&gt;attn_1_3_2 -->
<g id="edge388" class="edge">
<title>v_proj_1_3_2&#45;&gt;attn_1_3_2</title>
<path fill="none" stroke="black" d="M9483.88,-4749.97C9467.64,-4738.78 9449.64,-4726.97 9432.5,-4717 9420.52,-4710.03 9407.45,-4703.14 9394.72,-4696.79"/>
<polygon fill="black" stroke="black" points="9396.05,-4693.55 9385.53,-4692.27 9392.96,-4699.83 9396.05,-4693.55"/>
</g>
<!-- v_proj_1_3_2&#45;&gt;attn_1_3_2 -->
<g id="edge389" class="edge">
<title>v_proj_1_3_2&#45;&gt;attn_1_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9500.66,-4749.97C9488,-4738.27 9473.36,-4726.19 9458.5,-4717 9439.06,-4704.97 9416.31,-4694.92 9395.28,-4687.01"/>
<polygon fill="red" stroke="red" points="9396.35,-4683.67 9385.75,-4683.52 9393.94,-4690.24 9396.35,-4683.67"/>
<text text-anchor="middle" x="9515.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_1_3_3 -->
<g id="node183" class="node">
<title>attn_1_3_3</title>
<polygon fill="#ffff88" stroke="black" points="9896.5,-4699 9780.5,-4699 9780.5,-4631 9896.5,-4631 9896.5,-4699"/>
<text text-anchor="middle" x="9838.5" y="-4683.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9838.5" y="-4668.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="9838.5" y="-4653.8" font-family="monospace" font-size="14.00">Heads[12&#45;15]</text>
<text text-anchor="middle" x="9838.5" y="-4638.8" font-family="monospace" font-size="14.00">Dim[384&#45;511]</text>
</g>
<!-- q_proj_1_3_3&#45;&gt;attn_1_3_3 -->
<g id="edge393" class="edge">
<title>q_proj_1_3_3&#45;&gt;attn_1_3_3</title>
<path fill="none" stroke="black" d="M9754.83,-4749.78C9762.19,-4738.7 9770.67,-4727 9779.5,-4717 9782.69,-4713.38 9786.14,-4709.79 9789.7,-4706.27"/>
<polygon fill="black" stroke="black" points="9792.31,-4708.62 9797.16,-4699.2 9787.49,-4703.54 9792.31,-4708.62"/>
</g>
<!-- q_proj_1_3_3&#45;&gt;attn_1_3_3 -->
<g id="edge394" class="edge">
<title>q_proj_1_3_3&#45;&gt;attn_1_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9765.86,-4749.73C9777.69,-4736.1 9790.88,-4720.9 9802.74,-4707.23"/>
<polygon fill="red" stroke="red" points="9805.64,-4709.23 9809.54,-4699.38 9800.35,-4704.64 9805.64,-4709.23"/>
<text text-anchor="middle" x="9831.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_1_3_3&#45;&gt;attn_1_3_3 -->
<g id="edge395" class="edge">
<title>k_proj_1_3_3&#45;&gt;attn_1_3_3</title>
<path fill="none" stroke="black" d="M9901.33,-4749.96C9895.38,-4739 9888.55,-4727.32 9881.5,-4717 9879.28,-4713.76 9876.9,-4710.48 9874.43,-4707.23"/>
<polygon fill="black" stroke="black" points="9877.1,-4704.96 9868.18,-4699.26 9871.6,-4709.29 9877.1,-4704.96"/>
</g>
<!-- k_proj_1_3_3&#45;&gt;attn_1_3_3 -->
<g id="edge396" class="edge">
<title>k_proj_1_3_3&#45;&gt;attn_1_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9913.84,-4749.73C9910.56,-4738.53 9905.95,-4726.79 9899.5,-4717 9897.15,-4713.43 9894.48,-4709.99 9891.59,-4706.68"/>
<polygon fill="red" stroke="red" points="9893.95,-4704.08 9884.54,-4699.22 9888.87,-4708.89 9893.95,-4704.08"/>
<text text-anchor="middle" x="9944.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_1_3_3&#45;&gt;attn_1_3_3 -->
<g id="edge397" class="edge">
<title>v_proj_1_3_3&#45;&gt;attn_1_3_3</title>
<path fill="none" stroke="black" d="M10048.4,-4749.85C10028.94,-4738.41 10007.22,-4726.5 9986.5,-4717 9960.98,-4705.3 9931.96,-4694.73 9906.41,-4686.3"/>
<polygon fill="black" stroke="black" points="9907.4,-4682.94 9896.81,-4683.17 9905.23,-4689.59 9907.4,-4682.94"/>
</g>
<!-- v_proj_1_3_3&#45;&gt;attn_1_3_3 -->
<g id="edge398" class="edge">
<title>v_proj_1_3_3&#45;&gt;attn_1_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M10065.43,-4749.79C10049.97,-4737.94 10032.2,-4725.83 10014.5,-4717 9980.56,-4700.07 9940.06,-4687.84 9906.47,-4679.62"/>
<polygon fill="red" stroke="red" points="9907.27,-4676.21 9896.73,-4677.3 9905.65,-4683.02 9907.27,-4676.21"/>
<text text-anchor="middle" x="10075.5" y="-4720.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_1_0_0 -->
<g id="node150" class="node">
<title>out_proj_1_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="1988,-4594 1815,-4594 1815,-4511 1988,-4511 1988,-4594"/>
<text text-anchor="middle" x="1901.5" y="-4578.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1901.5" y="-4563.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="1901.5" y="-4548.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1901.5" y="-4533.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1901.5" y="-4518.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_1_0_0&#45;&gt;out_proj_1_0_0 -->
<g id="edge264" class="edge">
<title>attn_1_0_0&#45;&gt;out_proj_1_0_0</title>
<path fill="none" stroke="black" d="M1394.42,-4654.1C1486.75,-4635.78 1685.65,-4596.32 1805.06,-4572.63"/>
<polygon fill="black" stroke="black" points="1805.81,-4576.05 1814.94,-4570.67 1804.45,-4569.19 1805.81,-4576.05"/>
</g>
<!-- concat_dim_1_0 -->
<g id="node151" class="node">
<title>concat_dim_1_0</title>
<polygon fill="lightyellow" stroke="black" points="2472.5,-4460 2299.5,-4407 2472.5,-4354 2645.5,-4407 2472.5,-4460"/>
<text text-anchor="middle" x="2472.5" y="-4418.3" font-family="monospace" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="2472.5" y="-4403.3" font-family="monospace" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="2472.5" y="-4388.3" font-family="monospace" font-size="14.00">[1024×2048×(4×512)]</text>
</g>
<!-- out_proj_1_0_0&#45;&gt;concat_dim_1_0 -->
<g id="edge265" class="edge">
<title>out_proj_1_0_0&#45;&gt;concat_dim_1_0</title>
<path fill="none" stroke="black" d="M1988.11,-4521.25C2030.68,-4507.01 2082.94,-4490.46 2130.5,-4478 2204.25,-4458.68 2288.1,-4441.44 2354.31,-4428.91"/>
<polygon fill="black" stroke="black" points="2355.19,-4432.31 2364.37,-4427.02 2353.89,-4425.43 2355.19,-4432.31"/>
</g>
<!-- out_proj_1_0_0&#45;&gt;concat_dim_1_0 -->
<g id="edge266" class="edge">
<title>out_proj_1_0_0&#45;&gt;concat_dim_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1988.22,-4529.71C2090.33,-4504.04 2259.78,-4461.46 2368.75,-4434.07"/>
<polygon fill="red" stroke="red" points="2369.93,-4437.39 2378.78,-4431.55 2368.23,-4430.6 2369.93,-4437.39"/>
<text text-anchor="middle" x="2225.5" y="-4481.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_heads_1 -->
<g id="node185" class="node">
<title>concat_heads_1</title>
<polygon fill="lightyellow" stroke="black" points="6730.5,-4317 6565.5,-4264 6730.5,-4211 6895.5,-4264 6730.5,-4317"/>
<text text-anchor="middle" x="6730.5" y="-4275.3" font-family="monospace" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="6730.5" y="-4260.3" font-family="monospace" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="6730.5" y="-4245.3" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- concat_dim_1_0&#45;&gt;concat_heads_1 -->
<g id="edge402" class="edge">
<title>concat_dim_1_0&#45;&gt;concat_heads_1</title>
<path fill="none" stroke="black" d="M2625.93,-4400.92C3288.75,-4378.97 5903.06,-4292.4 6573.28,-4270.21"/>
<polygon fill="black" stroke="black" points="6573.6,-4273.7 6583.48,-4269.87 6573.37,-4266.7 6573.6,-4273.7"/>
</g>
<!-- out_proj_1_0_1 -->
<g id="node153" class="node">
<title>out_proj_1_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="2346,-4594 2173,-4594 2173,-4511 2346,-4511 2346,-4594"/>
<text text-anchor="middle" x="2259.5" y="-4578.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="2259.5" y="-4563.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="2259.5" y="-4548.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2259.5" y="-4533.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2259.5" y="-4518.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_1_0_1&#45;&gt;out_proj_1_0_1 -->
<g id="edge273" class="edge">
<title>attn_1_0_1&#45;&gt;out_proj_1_0_1</title>
<path fill="none" stroke="black" d="M1984.5,-4644.75C2033.75,-4628.41 2105.43,-4604.63 2163.26,-4585.44"/>
<polygon fill="black" stroke="black" points="2164.39,-4588.75 2172.78,-4582.28 2162.19,-4582.1 2164.39,-4588.75"/>
</g>
<!-- out_proj_1_0_1&#45;&gt;concat_dim_1_0 -->
<g id="edge274" class="edge">
<title>out_proj_1_0_1&#45;&gt;concat_dim_1_0</title>
<path fill="none" stroke="black" d="M2291.41,-4510.94C2301.78,-4499.37 2313.89,-4487.38 2326.5,-4478 2345.27,-4464.05 2367.25,-4451.77 2388.39,-4441.55"/>
<polygon fill="black" stroke="black" points="2390.15,-4444.59 2397.7,-4437.16 2387.16,-4438.26 2390.15,-4444.59"/>
</g>
<!-- out_proj_1_0_1&#45;&gt;concat_dim_1_0 -->
<g id="edge275" class="edge">
<title>out_proj_1_0_1&#45;&gt;concat_dim_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2319.68,-4510.95C2348.23,-4491.72 2382.3,-4468.77 2411.02,-4449.42"/>
<polygon fill="red" stroke="red" points="2413.02,-4452.29 2419.36,-4443.8 2409.11,-4446.49 2413.02,-4452.29"/>
<text text-anchor="middle" x="2404.5" y="-4481.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_1_0_2 -->
<g id="node155" class="node">
<title>out_proj_1_0_2</title>
<polygon fill="#ccccff" stroke="black" points="2559,-4594 2386,-4594 2386,-4511 2559,-4511 2559,-4594"/>
<text text-anchor="middle" x="2472.5" y="-4578.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2472.5" y="-4563.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="2472.5" y="-4548.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2472.5" y="-4533.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2472.5" y="-4518.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_1_0_2&#45;&gt;out_proj_1_0_2 -->
<g id="edge282" class="edge">
<title>attn_1_0_2&#45;&gt;out_proj_1_0_2</title>
<path fill="none" stroke="black" d="M2472.5,-4630.85C2472.5,-4622.44 2472.5,-4613.22 2472.5,-4604.16"/>
<polygon fill="black" stroke="black" points="2476,-4604.06 2472.5,-4594.06 2469,-4604.06 2476,-4604.06"/>
</g>
<!-- out_proj_1_0_2&#45;&gt;concat_dim_1_0 -->
<g id="edge283" class="edge">
<title>out_proj_1_0_2&#45;&gt;concat_dim_1_0</title>
<path fill="none" stroke="black" d="M2472.5,-4510.76C2472.5,-4498.22 2472.5,-4484.1 2472.5,-4470.45"/>
<polygon fill="black" stroke="black" points="2476,-4470.13 2472.5,-4460.13 2469,-4470.13 2476,-4470.13"/>
</g>
<!-- out_proj_1_0_2&#45;&gt;concat_dim_1_0 -->
<g id="edge284" class="edge">
<title>out_proj_1_0_2&#45;&gt;concat_dim_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2483.53,-4510.81C2484.76,-4504.87 2485.81,-4498.81 2486.5,-4493 2487.52,-4484.37 2487.35,-4475.27 2486.49,-4466.37"/>
<polygon fill="red" stroke="red" points="2489.96,-4465.92 2485.24,-4456.44 2483.01,-4466.8 2489.96,-4465.92"/>
<text text-anchor="middle" x="2525.5" y="-4481.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_1_0_3 -->
<g id="node157" class="node">
<title>out_proj_1_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="2845,-4594 2672,-4594 2672,-4511 2845,-4511 2845,-4594"/>
<text text-anchor="middle" x="2758.5" y="-4578.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2758.5" y="-4563.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="2758.5" y="-4548.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2758.5" y="-4533.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2758.5" y="-4518.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_1_0_3&#45;&gt;out_proj_1_0_3 -->
<g id="edge291" class="edge">
<title>attn_1_0_3&#45;&gt;out_proj_1_0_3</title>
<path fill="none" stroke="black" d="M2860.7,-4630.85C2848.04,-4621.26 2833.97,-4610.62 2820.43,-4600.37"/>
<polygon fill="black" stroke="black" points="2822.17,-4597.3 2812.08,-4594.06 2817.95,-4602.88 2822.17,-4597.3"/>
</g>
<!-- out_proj_1_0_3&#45;&gt;concat_dim_1_0 -->
<g id="edge292" class="edge">
<title>out_proj_1_0_3&#45;&gt;concat_dim_1_0</title>
<path fill="none" stroke="black" d="M2677.69,-4510.95C2636.38,-4490.23 2586.47,-4465.19 2546.22,-4444.99"/>
<polygon fill="black" stroke="black" points="2547.77,-4441.85 2537.26,-4440.49 2544.63,-4448.11 2547.77,-4441.85"/>
</g>
<!-- out_proj_1_0_3&#45;&gt;concat_dim_1_0 -->
<g id="edge293" class="edge">
<title>out_proj_1_0_3&#45;&gt;concat_dim_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2698.87,-4510.93C2681.11,-4499.61 2661.34,-4487.75 2642.5,-4478 2616,-4464.28 2586.19,-4451.25 2559.02,-4440.23"/>
<polygon fill="red" stroke="red" points="2560.11,-4436.9 2549.52,-4436.42 2557.5,-4443.39 2560.11,-4436.9"/>
<text text-anchor="middle" x="2707.5" y="-4481.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_1_1_0 -->
<g id="node159" class="node">
<title>out_proj_1_1_0</title>
<polygon fill="#ffccff" stroke="black" points="4014,-4594 3841,-4594 3841,-4511 4014,-4511 4014,-4594"/>
<text text-anchor="middle" x="3927.5" y="-4578.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="3927.5" y="-4563.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="3927.5" y="-4548.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3927.5" y="-4533.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3927.5" y="-4518.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_1_1_0&#45;&gt;out_proj_1_1_0 -->
<g id="edge300" class="edge">
<title>attn_1_1_0&#45;&gt;out_proj_1_1_0</title>
<path fill="none" stroke="black" d="M3715.09,-4643.09C3747.91,-4629.24 3792.04,-4610.63 3831.56,-4593.96"/>
<polygon fill="black" stroke="black" points="3833.12,-4597.1 3840.97,-4589.99 3830.4,-4590.65 3833.12,-4597.1"/>
</g>
<!-- concat_dim_1_1 -->
<g id="node160" class="node">
<title>concat_dim_1_1</title>
<polygon fill="lightyellow" stroke="black" points="4764.5,-4460 4591.5,-4407 4764.5,-4354 4937.5,-4407 4764.5,-4460"/>
<text text-anchor="middle" x="4764.5" y="-4418.3" font-family="monospace" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="4764.5" y="-4403.3" font-family="monospace" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="4764.5" y="-4388.3" font-family="monospace" font-size="14.00">[1024×2048×(4×512)]</text>
</g>
<!-- out_proj_1_1_0&#45;&gt;concat_dim_1_1 -->
<g id="edge301" class="edge">
<title>out_proj_1_1_0&#45;&gt;concat_dim_1_1</title>
<path fill="none" stroke="black" d="M4014.23,-4530.22C4080.77,-4514.39 4175.07,-4493.01 4258.5,-4478 4384.25,-4455.38 4528.73,-4436.05 4631.03,-4423.47"/>
<polygon fill="black" stroke="black" points="4631.6,-4426.92 4641.1,-4422.23 4630.75,-4419.98 4631.6,-4426.92"/>
</g>
<!-- out_proj_1_1_0&#45;&gt;concat_dim_1_1 -->
<g id="edge302" class="edge">
<title>out_proj_1_1_0&#45;&gt;concat_dim_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4014.1,-4535.23C4076.06,-4523.56 4161.43,-4507.42 4236.5,-4493 4270.74,-4486.42 4279.16,-4484.01 4313.5,-4478 4423.15,-4458.82 4548.27,-4439.61 4638.86,-4426.18"/>
<polygon fill="red" stroke="red" points="4639.52,-4429.62 4648.9,-4424.69 4638.5,-4422.69 4639.52,-4429.62"/>
<text text-anchor="middle" x="4351.5" y="-4481.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_dim_1_1&#45;&gt;concat_heads_1 -->
<g id="edge403" class="edge">
<title>concat_dim_1_1&#45;&gt;concat_heads_1</title>
<path fill="none" stroke="black" d="M4902.35,-4396.11C5261.49,-4370.36 6223.25,-4301.38 6587.77,-4275.24"/>
<polygon fill="black" stroke="black" points="6588.13,-4278.72 6597.86,-4274.51 6587.63,-4271.74 6588.13,-4278.72"/>
</g>
<!-- out_proj_1_1_1 -->
<g id="node162" class="node">
<title>out_proj_1_1_1</title>
<polygon fill="#ccffff" stroke="black" points="4379,-4594 4206,-4594 4206,-4511 4379,-4511 4379,-4594"/>
<text text-anchor="middle" x="4292.5" y="-4578.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="4292.5" y="-4563.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="4292.5" y="-4548.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4292.5" y="-4533.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4292.5" y="-4518.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_1_1_1&#45;&gt;out_proj_1_1_1 -->
<g id="edge309" class="edge">
<title>attn_1_1_1&#45;&gt;out_proj_1_1_1</title>
<path fill="none" stroke="black" d="M4244.9,-4630.85C4250.35,-4621.99 4256.36,-4612.22 4262.22,-4602.7"/>
<polygon fill="black" stroke="black" points="4265.28,-4604.41 4267.54,-4594.06 4259.32,-4600.74 4265.28,-4604.41"/>
</g>
<!-- out_proj_1_1_1&#45;&gt;concat_dim_1_1 -->
<g id="edge310" class="edge">
<title>out_proj_1_1_1&#45;&gt;concat_dim_1_1</title>
<path fill="none" stroke="black" d="M4357.97,-4510.83C4379.49,-4498.85 4403.95,-4486.64 4427.5,-4478 4494.46,-4453.43 4572.24,-4436.55 4636.2,-4425.54"/>
<polygon fill="black" stroke="black" points="4637.07,-4428.94 4646.34,-4423.82 4635.9,-4422.04 4637.07,-4428.94"/>
</g>
<!-- out_proj_1_1_1&#45;&gt;concat_dim_1_1 -->
<g id="edge311" class="edge">
<title>out_proj_1_1_1&#45;&gt;concat_dim_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4379.07,-4525.18C4461.33,-4500.17 4584.74,-4462.65 4669.63,-4436.84"/>
<polygon fill="red" stroke="red" points="4670.72,-4440.17 4679.27,-4433.91 4668.69,-4433.47 4670.72,-4440.17"/>
<text text-anchor="middle" x="4566.5" y="-4481.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_1_1_2 -->
<g id="node164" class="node">
<title>out_proj_1_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="4851,-4594 4678,-4594 4678,-4511 4851,-4511 4851,-4594"/>
<text text-anchor="middle" x="4764.5" y="-4578.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="4764.5" y="-4563.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="4764.5" y="-4548.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4764.5" y="-4533.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4764.5" y="-4518.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_1_1_2&#45;&gt;out_proj_1_1_2 -->
<g id="edge318" class="edge">
<title>attn_1_1_2&#45;&gt;out_proj_1_1_2</title>
<path fill="none" stroke="black" d="M4764.5,-4630.85C4764.5,-4622.44 4764.5,-4613.22 4764.5,-4604.16"/>
<polygon fill="black" stroke="black" points="4768,-4604.06 4764.5,-4594.06 4761,-4604.06 4768,-4604.06"/>
</g>
<!-- out_proj_1_1_2&#45;&gt;concat_dim_1_1 -->
<g id="edge319" class="edge">
<title>out_proj_1_1_2&#45;&gt;concat_dim_1_1</title>
<path fill="none" stroke="black" d="M4764.5,-4510.76C4764.5,-4498.22 4764.5,-4484.1 4764.5,-4470.45"/>
<polygon fill="black" stroke="black" points="4768,-4470.13 4764.5,-4460.13 4761,-4470.13 4768,-4470.13"/>
</g>
<!-- out_proj_1_1_2&#45;&gt;concat_dim_1_1 -->
<g id="edge320" class="edge">
<title>out_proj_1_1_2&#45;&gt;concat_dim_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4775.53,-4510.81C4776.76,-4504.87 4777.81,-4498.81 4778.5,-4493 4779.52,-4484.37 4779.35,-4475.27 4778.49,-4466.37"/>
<polygon fill="red" stroke="red" points="4781.96,-4465.92 4777.24,-4456.44 4775.01,-4466.8 4781.96,-4465.92"/>
<text text-anchor="middle" x="4817.5" y="-4481.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_1_1_3 -->
<g id="node166" class="node">
<title>out_proj_1_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="5337,-4594 5164,-4594 5164,-4511 5337,-4511 5337,-4594"/>
<text text-anchor="middle" x="5250.5" y="-4578.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="5250.5" y="-4563.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="5250.5" y="-4548.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5250.5" y="-4533.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="5250.5" y="-4518.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_1_1_3&#45;&gt;out_proj_1_1_3 -->
<g id="edge327" class="edge">
<title>attn_1_1_3&#45;&gt;out_proj_1_1_3</title>
<path fill="none" stroke="black" d="M5305.1,-4630.85C5298.78,-4621.9 5291.81,-4612.02 5285.02,-4602.41"/>
<polygon fill="black" stroke="black" points="5287.75,-4600.21 5279.13,-4594.06 5282.03,-4604.24 5287.75,-4600.21"/>
</g>
<!-- out_proj_1_1_3&#45;&gt;concat_dim_1_1 -->
<g id="edge328" class="edge">
<title>out_proj_1_1_3&#45;&gt;concat_dim_1_1</title>
<path fill="none" stroke="black" d="M5163.89,-4525.93C5078.8,-4500.8 4949.22,-4462.54 4860.9,-4436.46"/>
<polygon fill="black" stroke="black" points="4861.73,-4433.06 4851.15,-4433.58 4859.75,-4439.77 4861.73,-4433.06"/>
</g>
<!-- out_proj_1_1_3&#45;&gt;concat_dim_1_1 -->
<g id="edge329" class="edge">
<title>out_proj_1_1_3&#45;&gt;concat_dim_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5163.99,-4518.71C5127.12,-4505.27 5083.47,-4490.08 5043.5,-4478 4987.48,-4461.07 4924.27,-4444.97 4872.21,-4432.49"/>
<polygon fill="red" stroke="red" points="4872.83,-4429.04 4862.29,-4430.12 4871.2,-4435.84 4872.83,-4429.04"/>
<text text-anchor="middle" x="5127.5" y="-4481.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_1_2_0 -->
<g id="node168" class="node">
<title>out_proj_1_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="6229,-4594 6056,-4594 6056,-4511 6229,-4511 6229,-4594"/>
<text text-anchor="middle" x="6142.5" y="-4578.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="6142.5" y="-4563.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="6142.5" y="-4548.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6142.5" y="-4533.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6142.5" y="-4518.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_1_2_0&#45;&gt;out_proj_1_2_0 -->
<g id="edge336" class="edge">
<title>attn_1_2_0&#45;&gt;out_proj_1_2_0</title>
<path fill="none" stroke="black" d="M6014.12,-4631.44C6030.7,-4621.38 6049.29,-4610.09 6067.05,-4599.31"/>
<polygon fill="black" stroke="black" points="6068.97,-4602.24 6075.7,-4594.06 6065.33,-4596.26 6068.97,-4602.24"/>
</g>
<!-- concat_dim_1_2 -->
<g id="node169" class="node">
<title>concat_dim_1_2</title>
<polygon fill="lightyellow" stroke="black" points="6730.5,-4460 6557.5,-4407 6730.5,-4354 6903.5,-4407 6730.5,-4460"/>
<text text-anchor="middle" x="6730.5" y="-4418.3" font-family="monospace" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="6730.5" y="-4403.3" font-family="monospace" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="6730.5" y="-4388.3" font-family="monospace" font-size="14.00">[1024×2048×(4×512)]</text>
</g>
<!-- out_proj_1_2_0&#45;&gt;concat_dim_1_2 -->
<g id="edge337" class="edge">
<title>out_proj_1_2_0&#45;&gt;concat_dim_1_2</title>
<path fill="none" stroke="black" d="M6229.09,-4524.15C6276.99,-4509.49 6337.75,-4491.69 6392.5,-4478 6465.91,-4459.64 6549.13,-4442.36 6614.62,-4429.57"/>
<polygon fill="black" stroke="black" points="6615.42,-4432.98 6624.57,-4427.63 6614.08,-4426.11 6615.42,-4432.98"/>
</g>
<!-- out_proj_1_2_0&#45;&gt;concat_dim_1_2 -->
<g id="edge338" class="edge">
<title>out_proj_1_2_0&#45;&gt;concat_dim_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6229.26,-4530.33C6334.69,-4504.6 6512.48,-4461.21 6625.52,-4433.62"/>
<polygon fill="red" stroke="red" points="6626.69,-4436.94 6635.58,-4431.17 6625.03,-4430.14 6626.69,-4436.94"/>
<text text-anchor="middle" x="6474.5" y="-4481.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_dim_1_2&#45;&gt;concat_heads_1 -->
<g id="edge404" class="edge">
<title>concat_dim_1_2&#45;&gt;concat_heads_1</title>
<path fill="none" stroke="black" d="M6730.5,-4353.9C6730.5,-4345.33 6730.5,-4336.37 6730.5,-4327.57"/>
<polygon fill="black" stroke="black" points="6734,-4327.36 6730.5,-4317.36 6727,-4327.36 6734,-4327.36"/>
</g>
<!-- out_proj_1_2_1 -->
<g id="node171" class="node">
<title>out_proj_1_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="6611,-4594 6438,-4594 6438,-4511 6611,-4511 6611,-4594"/>
<text text-anchor="middle" x="6524.5" y="-4578.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="6524.5" y="-4563.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="6524.5" y="-4548.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6524.5" y="-4533.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6524.5" y="-4518.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_1_2_1&#45;&gt;out_proj_1_2_1 -->
<g id="edge345" class="edge">
<title>attn_1_2_1&#45;&gt;out_proj_1_2_1</title>
<path fill="none" stroke="black" d="M6500,-4630.85C6502.69,-4622.35 6505.65,-4613.02 6508.55,-4603.87"/>
<polygon fill="black" stroke="black" points="6511.97,-4604.65 6511.65,-4594.06 6505.3,-4602.53 6511.97,-4604.65"/>
</g>
<!-- out_proj_1_2_1&#45;&gt;concat_dim_1_2 -->
<g id="edge346" class="edge">
<title>out_proj_1_2_1&#45;&gt;concat_dim_1_2</title>
<path fill="none" stroke="black" d="M6533.37,-4510.65C6537.56,-4498.93 6543.66,-4486.93 6552.5,-4478 6571.95,-4458.34 6597.58,-4444.07 6623.31,-4433.75"/>
<polygon fill="black" stroke="black" points="6624.69,-4436.97 6632.78,-4430.13 6622.19,-4430.43 6624.69,-4436.97"/>
</g>
<!-- out_proj_1_2_1&#45;&gt;concat_dim_1_2 -->
<g id="edge347" class="edge">
<title>out_proj_1_2_1&#45;&gt;concat_dim_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6582.71,-4510.95C6609.98,-4491.95 6642.47,-4469.32 6670.03,-4450.12"/>
<polygon fill="red" stroke="red" points="6672.21,-4452.87 6678.41,-4444.28 6668.21,-4447.13 6672.21,-4452.87"/>
<text text-anchor="middle" x="6665.5" y="-4481.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_1_2_2 -->
<g id="node173" class="node">
<title>out_proj_1_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="7030,-4594 6857,-4594 6857,-4511 7030,-4511 7030,-4594"/>
<text text-anchor="middle" x="6943.5" y="-4578.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6943.5" y="-4563.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="6943.5" y="-4548.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6943.5" y="-4533.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6943.5" y="-4518.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_1_2_2&#45;&gt;out_proj_1_2_2 -->
<g id="edge354" class="edge">
<title>attn_1_2_2&#45;&gt;out_proj_1_2_2</title>
<path fill="none" stroke="black" d="M7022.6,-4630.85C7013.08,-4621.54 7002.53,-4611.22 6992.32,-4601.24"/>
<polygon fill="black" stroke="black" points="6994.57,-4598.54 6984.97,-4594.06 6989.68,-4603.55 6994.57,-4598.54"/>
</g>
<!-- out_proj_1_2_2&#45;&gt;concat_dim_1_2 -->
<g id="edge355" class="edge">
<title>out_proj_1_2_2&#45;&gt;concat_dim_1_2</title>
<path fill="none" stroke="black" d="M6883.32,-4510.95C6854.77,-4491.72 6820.7,-4468.77 6791.98,-4449.42"/>
<polygon fill="black" stroke="black" points="6793.89,-4446.49 6783.64,-4443.8 6789.98,-4452.29 6793.89,-4446.49"/>
</g>
<!-- out_proj_1_2_2&#45;&gt;concat_dim_1_2 -->
<g id="edge356" class="edge">
<title>out_proj_1_2_2&#45;&gt;concat_dim_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6902.14,-4510.93C6889.6,-4499.61 6875.44,-4487.76 6861.5,-4478 6844.34,-4465.99 6824.89,-4454.56 6806.32,-4444.54"/>
<polygon fill="red" stroke="red" points="6807.77,-4441.34 6797.29,-4439.74 6804.48,-4447.52 6807.77,-4441.34"/>
<text text-anchor="middle" x="6919.5" y="-4481.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_1_2_3 -->
<g id="node175" class="node">
<title>out_proj_1_2_3</title>
<polygon fill="#aaffff" stroke="black" points="7422,-4594 7249,-4594 7249,-4511 7422,-4511 7422,-4594"/>
<text text-anchor="middle" x="7335.5" y="-4578.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7335.5" y="-4563.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="7335.5" y="-4548.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7335.5" y="-4533.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="7335.5" y="-4518.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_1_2_3&#45;&gt;out_proj_1_2_3 -->
<g id="edge363" class="edge">
<title>attn_1_2_3&#45;&gt;out_proj_1_2_3</title>
<path fill="none" stroke="black" d="M7492.32,-4634.1C7471.13,-4623.21 7446.68,-4610.64 7423.48,-4598.72"/>
<polygon fill="black" stroke="black" points="7424.81,-4595.47 7414.32,-4594.01 7421.61,-4601.69 7424.81,-4595.47"/>
</g>
<!-- out_proj_1_2_3&#45;&gt;concat_dim_1_2 -->
<g id="edge364" class="edge">
<title>out_proj_1_2_3&#45;&gt;concat_dim_1_2</title>
<path fill="none" stroke="black" d="M7248.82,-4530.94C7140,-4505.13 6953.44,-4460.88 6836.32,-4433.1"/>
<polygon fill="black" stroke="black" points="6836.8,-4429.62 6826.26,-4430.71 6835.18,-4436.43 6836.8,-4429.62"/>
</g>
<!-- out_proj_1_2_3&#45;&gt;concat_dim_1_2 -->
<g id="edge365" class="edge">
<title>out_proj_1_2_3&#45;&gt;concat_dim_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7248.92,-4525.39C7198.31,-4510.56 7133.06,-4492.18 7074.5,-4478 6999.14,-4459.75 6913.73,-4442.35 6846.86,-4429.46"/>
<polygon fill="red" stroke="red" points="6847.2,-4425.96 6836.72,-4427.52 6845.88,-4432.84 6847.2,-4425.96"/>
<text text-anchor="middle" x="7170.5" y="-4481.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_1_3_0 -->
<g id="node177" class="node">
<title>out_proj_1_3_0</title>
<polygon fill="#ff8888" stroke="black" points="8480,-4594 8307,-4594 8307,-4511 8480,-4511 8480,-4594"/>
<text text-anchor="middle" x="8393.5" y="-4578.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8393.5" y="-4563.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="8393.5" y="-4548.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8393.5" y="-4533.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8393.5" y="-4518.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_1_3_0&#45;&gt;out_proj_1_3_0 -->
<g id="edge372" class="edge">
<title>attn_1_3_0&#45;&gt;out_proj_1_3_0</title>
<path fill="none" stroke="black" d="M8278.71,-4630.85C8293.19,-4621.08 8309.32,-4610.22 8324.79,-4599.79"/>
<polygon fill="black" stroke="black" points="8326.97,-4602.55 8333.31,-4594.06 8323.06,-4596.74 8326.97,-4602.55"/>
</g>
<!-- concat_dim_1_3 -->
<g id="node178" class="node">
<title>concat_dim_1_3</title>
<polygon fill="lightyellow" stroke="black" points="8775.5,-4460 8602.5,-4407 8775.5,-4354 8948.5,-4407 8775.5,-4460"/>
<text text-anchor="middle" x="8775.5" y="-4418.3" font-family="monospace" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="8775.5" y="-4403.3" font-family="monospace" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="8775.5" y="-4388.3" font-family="monospace" font-size="14.00">[1024×2048×(4×512)]</text>
</g>
<!-- out_proj_1_3_0&#45;&gt;concat_dim_1_3 -->
<g id="edge373" class="edge">
<title>out_proj_1_3_0&#45;&gt;concat_dim_1_3</title>
<path fill="none" stroke="black" d="M8480.18,-4518.94C8542.89,-4495.38 8627.24,-4463.69 8689.74,-4440.22"/>
<polygon fill="black" stroke="black" points="8691.05,-4443.46 8699.18,-4436.67 8688.59,-4436.91 8691.05,-4443.46"/>
</g>
<!-- out_proj_1_3_0&#45;&gt;concat_dim_1_3 -->
<g id="edge374" class="edge">
<title>out_proj_1_3_0&#45;&gt;concat_dim_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8480.27,-4526.49C8512.06,-4516.77 8548.15,-4505.07 8580.5,-4493 8620.04,-4478.25 8663.14,-4459.72 8698.74,-4443.74"/>
<polygon fill="red" stroke="red" points="8700.42,-4446.82 8708.1,-4439.52 8697.55,-4440.44 8700.42,-4446.82"/>
<text text-anchor="middle" x="8655.5" y="-4481.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_dim_1_3&#45;&gt;concat_heads_1 -->
<g id="edge405" class="edge">
<title>concat_dim_1_3&#45;&gt;concat_heads_1</title>
<path fill="none" stroke="black" d="M8636.55,-4396.42C8264.95,-4370.8 7251.01,-4300.89 6874.11,-4274.9"/>
<polygon fill="black" stroke="black" points="6874.18,-4271.4 6863.96,-4274.2 6873.7,-4278.38 6874.18,-4271.4"/>
</g>
<!-- out_proj_1_3_1 -->
<g id="node180" class="node">
<title>out_proj_1_3_1</title>
<polygon fill="#88ff88" stroke="black" points="8862,-4594 8689,-4594 8689,-4511 8862,-4511 8862,-4594"/>
<text text-anchor="middle" x="8775.5" y="-4578.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="8775.5" y="-4563.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="8775.5" y="-4548.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8775.5" y="-4533.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8775.5" y="-4518.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_1_3_1&#45;&gt;out_proj_1_3_1 -->
<g id="edge381" class="edge">
<title>attn_1_3_1&#45;&gt;out_proj_1_3_1</title>
<path fill="none" stroke="black" d="M8775.5,-4630.85C8775.5,-4622.44 8775.5,-4613.22 8775.5,-4604.16"/>
<polygon fill="black" stroke="black" points="8779,-4604.06 8775.5,-4594.06 8772,-4604.06 8779,-4604.06"/>
</g>
<!-- out_proj_1_3_1&#45;&gt;concat_dim_1_3 -->
<g id="edge382" class="edge">
<title>out_proj_1_3_1&#45;&gt;concat_dim_1_3</title>
<path fill="none" stroke="black" d="M8775.5,-4510.76C8775.5,-4498.22 8775.5,-4484.1 8775.5,-4470.45"/>
<polygon fill="black" stroke="black" points="8779,-4470.13 8775.5,-4460.13 8772,-4470.13 8779,-4470.13"/>
</g>
<!-- out_proj_1_3_1&#45;&gt;concat_dim_1_3 -->
<g id="edge383" class="edge">
<title>out_proj_1_3_1&#45;&gt;concat_dim_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8786.53,-4510.81C8787.76,-4504.87 8788.81,-4498.81 8789.5,-4493 8790.52,-4484.37 8790.35,-4475.27 8789.49,-4466.37"/>
<polygon fill="red" stroke="red" points="8792.96,-4465.92 8788.24,-4456.44 8786.01,-4466.8 8792.96,-4465.92"/>
<text text-anchor="middle" x="8827.5" y="-4481.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_1_3_2 -->
<g id="node182" class="node">
<title>out_proj_1_3_2</title>
<polygon fill="#8888ff" stroke="black" points="9274,-4594 9101,-4594 9101,-4511 9274,-4511 9274,-4594"/>
<text text-anchor="middle" x="9187.5" y="-4578.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9187.5" y="-4563.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="9187.5" y="-4548.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="9187.5" y="-4533.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="9187.5" y="-4518.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_1_3_2&#45;&gt;out_proj_1_3_2 -->
<g id="edge390" class="edge">
<title>attn_1_3_2&#45;&gt;out_proj_1_3_2</title>
<path fill="none" stroke="black" d="M9285.5,-4630.85C9273.36,-4621.26 9259.87,-4610.62 9246.89,-4600.37"/>
<polygon fill="black" stroke="black" points="9248.9,-4597.5 9238.88,-4594.06 9244.56,-4603 9248.9,-4597.5"/>
</g>
<!-- out_proj_1_3_2&#45;&gt;concat_dim_1_3 -->
<g id="edge391" class="edge">
<title>out_proj_1_3_2&#45;&gt;concat_dim_1_3</title>
<path fill="none" stroke="black" d="M9100.88,-4521.33C9031.56,-4497.19 8934.71,-4463.45 8864.72,-4439.07"/>
<polygon fill="black" stroke="black" points="8865.62,-4435.68 8855.02,-4435.7 8863.32,-4442.29 8865.62,-4435.68"/>
</g>
<!-- out_proj_1_3_2&#45;&gt;concat_dim_1_3 -->
<g id="edge392" class="edge">
<title>out_proj_1_3_2&#45;&gt;concat_dim_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9100.64,-4512.52C9073.04,-4500.76 9042.22,-4488.25 9013.5,-4478 8969.09,-4462.15 8919.15,-4447.05 8876.51,-4434.97"/>
<polygon fill="red" stroke="red" points="8877.27,-4431.54 8866.69,-4432.2 8875.37,-4438.28 8877.27,-4431.54"/>
<text text-anchor="middle" x="9089.5" y="-4481.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_1_3_3 -->
<g id="node184" class="node">
<title>out_proj_1_3_3</title>
<polygon fill="#ffff88" stroke="black" points="9745,-4594 9572,-4594 9572,-4511 9745,-4511 9745,-4594"/>
<text text-anchor="middle" x="9658.5" y="-4578.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9658.5" y="-4563.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="9658.5" y="-4548.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="9658.5" y="-4533.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="9658.5" y="-4518.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_1_3_3&#45;&gt;out_proj_1_3_3 -->
<g id="edge399" class="edge">
<title>attn_1_3_3&#45;&gt;out_proj_1_3_3</title>
<path fill="none" stroke="black" d="M9784.49,-4630.85C9768.44,-4620.99 9750.57,-4610.02 9733.44,-4599.5"/>
<polygon fill="black" stroke="black" points="9734.92,-4596.3 9724.56,-4594.06 9731.25,-4602.27 9734.92,-4596.3"/>
</g>
<!-- out_proj_1_3_3&#45;&gt;concat_dim_1_3 -->
<g id="edge400" class="edge">
<title>out_proj_1_3_3&#45;&gt;concat_dim_1_3</title>
<path fill="none" stroke="black" d="M9571.82,-4537.41C9413.6,-4511.7 9077.68,-4457.11 8896.83,-4427.72"/>
<polygon fill="black" stroke="black" points="8897.17,-4424.23 8886.74,-4426.08 8896.05,-4431.14 8897.17,-4424.23"/>
</g>
<!-- out_proj_1_3_3&#45;&gt;concat_dim_1_3 -->
<g id="edge401" class="edge">
<title>out_proj_1_3_3&#45;&gt;concat_dim_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9571.64,-4533.84C9493.14,-4518.17 9374.33,-4495.17 9270.5,-4478 9146.94,-4457.57 9005.41,-4437.93 8905.42,-4424.68"/>
<polygon fill="red" stroke="red" points="8905.64,-4421.18 8895.26,-4423.34 8904.72,-4428.12 8905.64,-4421.18"/>
<text text-anchor="middle" x="9393.5" y="-4481.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_heads_1&#45;&gt;add_1 -->
<g id="edge406" class="edge">
<title>concat_heads_1&#45;&gt;add_1</title>
<path fill="none" stroke="black" d="M6853.68,-4250.53C7201.69,-4215.29 8188.86,-4115.33 8526.55,-4081.14"/>
<polygon fill="black" stroke="black" points="8527,-4084.61 8536.6,-4080.12 8526.3,-4077.65 8527,-4084.61"/>
</g>
<!-- ffn_dense_h_1 -->
<g id="node188" class="node">
<title>ffn_dense_h_1</title>
<polygon fill="lightgreen" stroke="black" points="8660,-3851 8503,-3851 8503,-3783 8660,-3783 8660,-3851"/>
<text text-anchor="middle" x="8581.5" y="-3835.8" font-family="monospace" font-size="14.00">FFN Dense_H</text>
<text text-anchor="middle" x="8581.5" y="-3820.8" font-family="monospace" font-size="14.00">[1024×2048×32768]</text>
<text text-anchor="middle" x="8581.5" y="-3805.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8581.5" y="-3790.8" font-family="monospace" font-size="14.00">→AllGather</text>
</g>
<!-- ln2_1&#45;&gt;ffn_dense_h_1 -->
<g id="edge409" class="edge">
<title>ln2_1&#45;&gt;ffn_dense_h_1</title>
<path fill="none" stroke="black" d="M8587.05,-3887.77C8586.43,-3880 8585.68,-3870.59 8584.94,-3861.22"/>
<polygon fill="black" stroke="black" points="8588.42,-3860.84 8584.14,-3851.15 8581.44,-3861.4 8588.42,-3860.84"/>
</g>
<!-- ln1_2 -->
<g id="node191" class="node">
<title>ln1_2</title>
<polygon fill="lightgray" stroke="black" points="5281,-3290 5132,-3290 5132,-3252 5281,-3252 5281,-3290"/>
<text text-anchor="middle" x="5206.5" y="-3274.8" font-family="monospace" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5206.5" y="-3259.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- add2_1&#45;&gt;ln1_2 -->
<g id="edge415" class="edge">
<title>add2_1&#45;&gt;ln1_2</title>
<path fill="none" stroke="black" d="M8482.14,-3426.53C7970.88,-3402.41 5754.28,-3297.84 5291.41,-3276.01"/>
<polygon fill="black" stroke="black" points="5291.29,-3272.5 5281.13,-3275.52 5290.96,-3279.49 5291.29,-3272.5"/>
</g>
<!-- add_2 -->
<g id="node192" class="node">
<title>add_2</title>
<ellipse fill="lightgray" stroke="black" cx="8128.5" cy="-2450.5" rx="105.5" ry="105.5"/>
<text text-anchor="middle" x="8128.5" y="-2461.8" font-family="monospace" font-size="14.00">Add</text>
<text text-anchor="middle" x="8128.5" y="-2446.8" font-family="monospace" font-size="14.00">Residual</text>
<text text-anchor="middle" x="8128.5" y="-2431.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- add2_1&#45;&gt;add_2 -->
<g id="edge416" class="edge">
<title>add2_1&#45;&gt;add_2</title>
<path fill="none" stroke="black" d="M8693.02,-3427.55C8973.18,-3415.68 9714.5,-3374.57 9714.5,-3272 9714.5,-3272 9714.5,-3272 9714.5,-2645 9714.5,-2496.81 8609.46,-2461.19 8244.16,-2453.47"/>
<polygon fill="black" stroke="black" points="8244.17,-2449.97 8234.1,-2453.26 8244.02,-2456.96 8244.17,-2449.97"/>
</g>
<!-- ffn_act_1 -->
<g id="node189" class="node">
<title>ffn_act_1</title>
<polygon fill="lightgreen" stroke="black" points="8652,-3732 8495,-3732 8495,-3694 8652,-3694 8652,-3732"/>
<text text-anchor="middle" x="8573.5" y="-3716.8" font-family="monospace" font-size="14.00">GELU</text>
<text text-anchor="middle" x="8573.5" y="-3701.8" font-family="monospace" font-size="14.00">[1024×2048×32768]</text>
</g>
<!-- ffn_dense_h_1&#45;&gt;ffn_act_1 -->
<g id="edge410" class="edge">
<title>ffn_dense_h_1&#45;&gt;ffn_act_1</title>
<path fill="none" stroke="black" d="M8578.9,-3782.88C8577.88,-3769.84 8576.72,-3755 8575.73,-3742.45"/>
<polygon fill="black" stroke="black" points="8579.19,-3741.8 8574.92,-3732.11 8572.21,-3742.35 8579.19,-3741.8"/>
</g>
<!-- ffn_dense_h_1&#45;&gt;ffn_act_1 -->
<g id="edge411" class="edge">
<title>ffn_dense_h_1&#45;&gt;ffn_act_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8586.35,-3782.96C8587.15,-3772.38 8587.23,-3760.65 8585.5,-3750 8585.06,-3747.29 8584.45,-3744.51 8583.72,-3741.75"/>
<polygon fill="red" stroke="red" points="8587.03,-3740.58 8580.77,-3732.03 8580.33,-3742.61 8587.03,-3740.58"/>
<text text-anchor="middle" x="8623" y="-3753.8" font-family="Times,serif" font-size="14.00">All&#45;Gather</text>
</g>
<!-- ffn_dense_4h_1 -->
<g id="node190" class="node">
<title>ffn_dense_4h_1</title>
<polygon fill="lightgreen" stroke="black" points="8646,-3657 8497,-3657 8497,-3589 8646,-3589 8646,-3657"/>
<text text-anchor="middle" x="8571.5" y="-3641.8" font-family="monospace" font-size="14.00">FFN Dense_4H</text>
<text text-anchor="middle" x="8571.5" y="-3626.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
<text text-anchor="middle" x="8571.5" y="-3611.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8571.5" y="-3596.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ffn_act_1&#45;&gt;ffn_dense_4h_1 -->
<g id="edge412" class="edge">
<title>ffn_act_1&#45;&gt;ffn_dense_4h_1</title>
<path fill="none" stroke="black" d="M8573.09,-3693.77C8572.91,-3686 8572.7,-3676.59 8572.48,-3667.22"/>
<polygon fill="black" stroke="black" points="8575.98,-3667.07 8572.25,-3657.15 8568.98,-3667.23 8575.98,-3667.07"/>
</g>
<!-- ffn_dense_4h_1&#45;&gt;add2_1 -->
<g id="edge413" class="edge">
<title>ffn_dense_4h_1&#45;&gt;add2_1</title>
<path fill="none" stroke="black" d="M8574.32,-3588.73C8575.33,-3576.88 8576.53,-3562.78 8577.78,-3547.97"/>
<polygon fill="black" stroke="black" points="8581.3,-3547.89 8578.66,-3537.63 8574.33,-3547.3 8581.3,-3547.89"/>
</g>
<!-- ffn_dense_4h_1&#45;&gt;add2_1 -->
<g id="edge414" class="edge">
<title>ffn_dense_4h_1&#45;&gt;add2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8579.51,-3588.95C8580.7,-3583.01 8581.77,-3576.84 8582.5,-3571 8583.43,-3563.58 8584.2,-3555.93 8584.85,-3548.2"/>
<polygon fill="red" stroke="red" points="8588.36,-3548.25 8585.63,-3538.01 8581.38,-3547.71 8588.36,-3548.25"/>
<text text-anchor="middle" x="8621.5" y="-3559.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- q_proj_2_0_0 -->
<g id="node193" class="node">
<title>q_proj_2_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="709,-3215 536,-3215 536,-3132 709,-3132 709,-3215"/>
<text text-anchor="middle" x="622.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="622.5" y="-3184.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="622.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="622.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="622.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_0_0 -->
<g id="edge417" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_0_0</title>
<path fill="none" stroke="black" d="M5131.66,-3269.92C4639.89,-3269.27 1865.04,-3264.33 1018.5,-3234 887.81,-3229.32 849.77,-3245.15 719.06,-3215.14"/>
<polygon fill="black" stroke="black" points="719.61,-3211.67 709.07,-3212.8 718.01,-3218.49 719.61,-3211.67"/>
</g>
<!-- k_proj_2_0_0 -->
<g id="node194" class="node">
<title>k_proj_2_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="900,-3215 727,-3215 727,-3132 900,-3132 900,-3215"/>
<text text-anchor="middle" x="813.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="813.5" y="-3184.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="813.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="813.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="813.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_0_0 -->
<g id="edge418" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_0_0</title>
<path fill="none" stroke="black" d="M5131.63,-3269.88C4652.95,-3269.02 2015.48,-3263.05 1209.5,-3234 1078.81,-3229.29 1040.77,-3245.15 910.06,-3215.14"/>
<polygon fill="black" stroke="black" points="910.61,-3211.67 900.07,-3212.8 909.01,-3218.49 910.61,-3211.67"/>
</g>
<!-- v_proj_2_0_0 -->
<g id="node195" class="node">
<title>v_proj_2_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="1091,-3215 918,-3215 918,-3132 1091,-3132 1091,-3215"/>
<text text-anchor="middle" x="1004.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1004.5" y="-3184.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="1004.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1004.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1004.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_0_0 -->
<g id="edge419" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_0_0</title>
<path fill="none" stroke="black" d="M5131.87,-3269.84C4667.26,-3268.77 2166.1,-3261.76 1400.5,-3234 1269.81,-3229.26 1231.77,-3245.14 1101.06,-3215.14"/>
<polygon fill="black" stroke="black" points="1101.61,-3211.67 1091.07,-3212.8 1100.01,-3218.49 1101.61,-3211.67"/>
</g>
<!-- q_proj_2_0_1 -->
<g id="node196" class="node">
<title>q_proj_2_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="1282,-3215 1109,-3215 1109,-3132 1282,-3132 1282,-3215"/>
<text text-anchor="middle" x="1195.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1195.5" y="-3184.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="1195.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1195.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1195.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_0_1 -->
<g id="edge420" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_0_1</title>
<path fill="none" stroke="black" d="M5131.64,-3269.8C4680.25,-3268.49 2316.52,-3260.47 1591.5,-3234 1460.82,-3229.23 1422.77,-3245.14 1292.06,-3215.14"/>
<polygon fill="black" stroke="black" points="1292.61,-3211.67 1282.07,-3212.8 1291.01,-3218.49 1292.61,-3211.67"/>
</g>
<!-- k_proj_2_0_1 -->
<g id="node197" class="node">
<title>k_proj_2_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="1473,-3215 1300,-3215 1300,-3132 1473,-3132 1473,-3215"/>
<text text-anchor="middle" x="1386.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1386.5" y="-3184.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="1386.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1386.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1386.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_0_1 -->
<g id="edge421" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_0_1</title>
<path fill="none" stroke="black" d="M5131.73,-3269.75C4694.75,-3268.2 2467.17,-3259.19 1782.5,-3234 1651.82,-3229.19 1613.77,-3245.14 1483.06,-3215.14"/>
<polygon fill="black" stroke="black" points="1483.61,-3211.67 1473.07,-3212.8 1482.01,-3218.49 1483.61,-3211.67"/>
</g>
<!-- v_proj_2_0_1 -->
<g id="node198" class="node">
<title>v_proj_2_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="1664,-3215 1491,-3215 1491,-3132 1664,-3132 1664,-3215"/>
<text text-anchor="middle" x="1577.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1577.5" y="-3184.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="1577.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1577.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1577.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_0_1 -->
<g id="edge422" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_0_1</title>
<path fill="none" stroke="black" d="M5131.82,-3269.7C4709.62,-3267.9 2617.87,-3257.91 1973.5,-3234 1842.82,-3229.15 1804.77,-3245.14 1674.06,-3215.14"/>
<polygon fill="black" stroke="black" points="1674.61,-3211.67 1664.07,-3212.8 1673.01,-3218.49 1674.61,-3211.67"/>
</g>
<!-- q_proj_2_0_2 -->
<g id="node199" class="node">
<title>q_proj_2_0_2</title>
<polygon fill="#ccccff" stroke="black" points="1855,-3215 1682,-3215 1682,-3132 1855,-3132 1855,-3215"/>
<text text-anchor="middle" x="1768.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1768.5" y="-3184.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="1768.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1768.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1768.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_0_2 -->
<g id="edge423" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_0_2</title>
<path fill="none" stroke="black" d="M5131.96,-3269.64C4725.07,-3267.58 2768.66,-3256.63 2164.5,-3234 2033.82,-3229.11 1995.77,-3245.14 1865.06,-3215.14"/>
<polygon fill="black" stroke="black" points="1865.61,-3211.67 1855.07,-3212.8 1864.01,-3218.49 1865.61,-3211.67"/>
</g>
<!-- k_proj_2_0_2 -->
<g id="node200" class="node">
<title>k_proj_2_0_2</title>
<polygon fill="#ccccff" stroke="black" points="2046,-3215 1873,-3215 1873,-3132 2046,-3132 2046,-3215"/>
<text text-anchor="middle" x="1959.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1959.5" y="-3184.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="1959.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1959.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1959.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_0_2 -->
<g id="edge424" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_0_2</title>
<path fill="none" stroke="black" d="M5131.88,-3269.57C4740.3,-3267.22 2919.4,-3255.34 2355.5,-3234 2224.82,-3229.05 2186.77,-3245.13 2056.06,-3215.14"/>
<polygon fill="black" stroke="black" points="2056.61,-3211.67 2046.07,-3212.8 2055.01,-3218.49 2056.61,-3211.67"/>
</g>
<!-- v_proj_2_0_2 -->
<g id="node201" class="node">
<title>v_proj_2_0_2</title>
<polygon fill="#ccccff" stroke="black" points="2237,-3215 2064,-3215 2064,-3132 2237,-3132 2237,-3215"/>
<text text-anchor="middle" x="2150.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2150.5" y="-3184.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="2150.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2150.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2150.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_0_2 -->
<g id="edge425" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_0_2</title>
<path fill="none" stroke="black" d="M5131.89,-3270.34C4817.6,-3271.5 3570.47,-3273.22 2546.5,-3234 2415.82,-3228.99 2377.77,-3245.13 2247.06,-3215.14"/>
<polygon fill="black" stroke="black" points="2247.61,-3211.67 2237.07,-3212.8 2246.01,-3218.49 2247.61,-3211.67"/>
</g>
<!-- q_proj_2_0_3 -->
<g id="node202" class="node">
<title>q_proj_2_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="2428,-3215 2255,-3215 2255,-3132 2428,-3132 2428,-3215"/>
<text text-anchor="middle" x="2341.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2341.5" y="-3184.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="2341.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2341.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2341.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_0_3 -->
<g id="edge426" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_0_3</title>
<path fill="none" stroke="black" d="M5131.98,-3270.23C4831.83,-3270.88 3682.32,-3270.69 2737.5,-3234 2606.83,-3228.93 2568.77,-3245.13 2438.06,-3215.14"/>
<polygon fill="black" stroke="black" points="2438.61,-3211.67 2428.07,-3212.8 2437.01,-3218.49 2438.61,-3211.67"/>
</g>
<!-- k_proj_2_0_3 -->
<g id="node203" class="node">
<title>k_proj_2_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="2619,-3215 2446,-3215 2446,-3132 2619,-3132 2619,-3215"/>
<text text-anchor="middle" x="2532.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2532.5" y="-3184.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="2532.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2532.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2532.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_0_3 -->
<g id="edge427" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_0_3</title>
<path fill="none" stroke="black" d="M5131.77,-3270.09C4845.96,-3270.18 3794.67,-3268.04 2929.5,-3234 2798.4,-3228.84 2760.21,-3245.21 2629.09,-3215.14"/>
<polygon fill="black" stroke="black" points="2629.61,-3211.67 2619.07,-3212.8 2628.01,-3218.49 2629.61,-3211.67"/>
</g>
<!-- v_proj_2_0_3 -->
<g id="node204" class="node">
<title>v_proj_2_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="2810,-3215 2637,-3215 2637,-3132 2810,-3132 2810,-3215"/>
<text text-anchor="middle" x="2723.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2723.5" y="-3184.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="2723.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2723.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2723.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_0_3 -->
<g id="edge428" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_0_3</title>
<path fill="none" stroke="black" d="M5131.67,-3269.93C4860.99,-3269.43 3907.39,-3265.41 3121.5,-3234 2989.97,-3228.74 2951.65,-3245.29 2820.13,-3215.15"/>
<polygon fill="black" stroke="black" points="2820.61,-3211.67 2810.07,-3212.8 2819.01,-3218.49 2820.61,-3211.67"/>
</g>
<!-- q_proj_2_1_0 -->
<g id="node205" class="node">
<title>q_proj_2_1_0</title>
<polygon fill="#ffccff" stroke="black" points="3001,-3215 2828,-3215 2828,-3132 3001,-3132 3001,-3215"/>
<text text-anchor="middle" x="2914.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2914.5" y="-3184.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="2914.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2914.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2914.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_1_0 -->
<g id="edge429" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_1_0</title>
<path fill="none" stroke="black" d="M5131.73,-3269.72C4877.4,-3268.54 4022.34,-3262.55 3316.5,-3234 3183.11,-3228.6 3144.34,-3245.65 3010.85,-3215.09"/>
<polygon fill="black" stroke="black" points="3011.61,-3211.67 3001.07,-3212.8 3010.01,-3218.49 3011.61,-3211.67"/>
</g>
<!-- k_proj_2_1_0 -->
<g id="node206" class="node">
<title>k_proj_2_1_0</title>
<polygon fill="#ffccff" stroke="black" points="3192,-3215 3019,-3215 3019,-3132 3192,-3132 3192,-3215"/>
<text text-anchor="middle" x="3105.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="3105.5" y="-3184.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="3105.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3105.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3105.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_1_0 -->
<g id="edge430" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_1_0</title>
<path fill="none" stroke="black" d="M5131.77,-3269.53C4893.87,-3267.78 4132.84,-3260.37 3503.5,-3234 3371.98,-3228.49 3333.65,-3245.28 3202.13,-3215.15"/>
<polygon fill="black" stroke="black" points="3202.61,-3211.67 3192.07,-3212.8 3201.01,-3218.49 3202.61,-3211.67"/>
</g>
<!-- v_proj_2_1_0 -->
<g id="node207" class="node">
<title>v_proj_2_1_0</title>
<polygon fill="#ffccff" stroke="black" points="3383,-3215 3210,-3215 3210,-3132 3383,-3132 3383,-3215"/>
<text text-anchor="middle" x="3296.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="3296.5" y="-3184.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="3296.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3296.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3296.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_1_0 -->
<g id="edge431" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_1_0</title>
<path fill="none" stroke="black" d="M5131.98,-3269.21C4912.48,-3266.69 4249.24,-3257.51 3699.5,-3234 3565.69,-3228.28 3526.78,-3245.72 3392.88,-3215.09"/>
<polygon fill="black" stroke="black" points="3393.61,-3211.67 3383.07,-3212.8 3392.01,-3218.49 3393.61,-3211.67"/>
</g>
<!-- q_proj_2_1_1 -->
<g id="node208" class="node">
<title>q_proj_2_1_1</title>
<polygon fill="#ccffff" stroke="black" points="3574,-3215 3401,-3215 3401,-3132 3574,-3132 3574,-3215"/>
<text text-anchor="middle" x="3487.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3487.5" y="-3184.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="3487.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3487.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3487.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_1_1 -->
<g id="edge432" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_1_1</title>
<path fill="none" stroke="black" d="M5131.73,-3268.87C4930.55,-3265.65 4360.93,-3255.2 3887.5,-3234 3755.13,-3228.07 3716.53,-3245.42 3584.19,-3215.16"/>
<polygon fill="black" stroke="black" points="3584.61,-3211.67 3574.07,-3212.8 3583.01,-3218.48 3584.61,-3211.67"/>
</g>
<!-- k_proj_2_1_1 -->
<g id="node209" class="node">
<title>k_proj_2_1_1</title>
<polygon fill="#ccffff" stroke="black" points="3765,-3215 3592,-3215 3592,-3132 3765,-3132 3765,-3215"/>
<text text-anchor="middle" x="3678.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3678.5" y="-3184.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="3678.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3678.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3678.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_1_1 -->
<g id="edge433" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_1_1</title>
<path fill="none" stroke="black" d="M5131.69,-3268.34C4951.55,-3264.18 4479.38,-3252.31 4085.5,-3234 3949.98,-3227.7 3910.54,-3246.03 3775,-3215.12"/>
<polygon fill="black" stroke="black" points="3775.6,-3211.67 3765.07,-3212.81 3774.02,-3218.48 3775.6,-3211.67"/>
</g>
<!-- v_proj_2_1_1 -->
<g id="node210" class="node">
<title>v_proj_2_1_1</title>
<polygon fill="#ccffff" stroke="black" points="3956,-3215 3783,-3215 3783,-3132 3956,-3132 3956,-3215"/>
<text text-anchor="middle" x="3869.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3869.5" y="-3184.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="3869.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3869.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3869.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_1_1 -->
<g id="edge434" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_1_1</title>
<path fill="none" stroke="black" d="M5131.92,-3267.76C4972.96,-3262.84 4589.09,-3250.25 4267.5,-3234 4136.03,-3227.36 4097.65,-3245.22 3966.13,-3215.15"/>
<polygon fill="black" stroke="black" points="3966.61,-3211.67 3956.07,-3212.8 3965.01,-3218.48 3966.61,-3211.67"/>
</g>
<!-- q_proj_2_1_2 -->
<g id="node211" class="node">
<title>q_proj_2_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="4147,-3215 3974,-3215 3974,-3132 4147,-3132 4147,-3215"/>
<text text-anchor="middle" x="4060.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="4060.5" y="-3184.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="4060.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4060.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4060.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_1_2 -->
<g id="edge435" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_1_2</title>
<path fill="none" stroke="black" d="M5131.65,-3269.56C4927,-3267.8 4360.44,-3259.19 4157.06,-3215.07"/>
<polygon fill="black" stroke="black" points="4157.6,-3211.6 4147.07,-3212.81 4156.05,-3218.43 4157.6,-3211.6"/>
</g>
<!-- k_proj_2_1_2 -->
<g id="node212" class="node">
<title>k_proj_2_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="4338,-3215 4165,-3215 4165,-3132 4338,-3132 4338,-3215"/>
<text text-anchor="middle" x="4251.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="4251.5" y="-3184.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="4251.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4251.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4251.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_1_2 -->
<g id="edge436" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_1_2</title>
<path fill="none" stroke="black" d="M5131.85,-3268.46C4954.94,-3264.3 4513.3,-3250.8 4348.08,-3215.07"/>
<polygon fill="black" stroke="black" points="4348.6,-3211.6 4338.07,-3212.8 4347.05,-3218.42 4348.6,-3211.6"/>
</g>
<!-- v_proj_2_1_2 -->
<g id="node213" class="node">
<title>v_proj_2_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="4529,-3215 4356,-3215 4356,-3132 4529,-3132 4529,-3215"/>
<text text-anchor="middle" x="4442.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="4442.5" y="-3184.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="4442.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4442.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4442.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_1_2 -->
<g id="edge437" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_1_2</title>
<path fill="none" stroke="black" d="M5131.75,-3266.87C4985.58,-3260.27 4665.81,-3243.35 4538.96,-3215.05"/>
<polygon fill="black" stroke="black" points="4539.63,-3211.61 4529.09,-3212.73 4538.02,-3218.43 4539.63,-3211.61"/>
</g>
<!-- q_proj_2_1_3 -->
<g id="node214" class="node">
<title>q_proj_2_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="4720,-3215 4547,-3215 4547,-3132 4720,-3132 4720,-3215"/>
<text text-anchor="middle" x="4633.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="4633.5" y="-3184.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="4633.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4633.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4633.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_1_3 -->
<g id="edge438" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_1_3</title>
<path fill="none" stroke="black" d="M5131.99,-3268.05C5039.03,-3264.15 4875.55,-3252.47 4730.12,-3215.22"/>
<polygon fill="black" stroke="black" points="4730.68,-3211.75 4720.12,-3212.61 4728.91,-3218.52 4730.68,-3211.75"/>
</g>
<!-- k_proj_2_1_3 -->
<g id="node215" class="node">
<title>k_proj_2_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="4911,-3215 4738,-3215 4738,-3132 4911,-3132 4911,-3215"/>
<text text-anchor="middle" x="4824.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="4824.5" y="-3184.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="4824.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4824.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4824.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_1_3 -->
<g id="edge439" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_1_3</title>
<path fill="none" stroke="black" d="M5131.71,-3260.15C5075.56,-3251.73 4996.87,-3237.75 4920.93,-3215.27"/>
<polygon fill="black" stroke="black" points="4921.78,-3211.87 4911.2,-3212.34 4919.76,-3218.57 4921.78,-3211.87"/>
</g>
<!-- v_proj_2_1_3 -->
<g id="node216" class="node">
<title>v_proj_2_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="5102,-3215 4929,-3215 4929,-3132 5102,-3132 5102,-3215"/>
<text text-anchor="middle" x="5015.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="5015.5" y="-3184.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="5015.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5015.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5015.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_1_3 -->
<g id="edge440" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_1_3</title>
<path fill="none" stroke="black" d="M5170.12,-3251.81C5151.78,-3242.64 5128.63,-3231.07 5105.88,-3219.69"/>
<polygon fill="black" stroke="black" points="5107.36,-3216.52 5096.85,-3215.17 5104.23,-3222.78 5107.36,-3216.52"/>
</g>
<!-- q_proj_2_2_0 -->
<g id="node217" class="node">
<title>q_proj_2_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="5293,-3215 5120,-3215 5120,-3132 5293,-3132 5293,-3215"/>
<text text-anchor="middle" x="5206.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5206.5" y="-3184.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="5206.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5206.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5206.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_2_0 -->
<g id="edge441" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_2_0</title>
<path fill="none" stroke="black" d="M5206.5,-3251.59C5206.5,-3243.94 5206.5,-3234.66 5206.5,-3225.23"/>
<polygon fill="black" stroke="black" points="5210,-3225 5206.5,-3215 5203,-3225 5210,-3225"/>
</g>
<!-- k_proj_2_2_0 -->
<g id="node218" class="node">
<title>k_proj_2_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="5484,-3215 5311,-3215 5311,-3132 5484,-3132 5484,-3215"/>
<text text-anchor="middle" x="5397.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5397.5" y="-3184.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="5397.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5397.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5397.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_2_0 -->
<g id="edge442" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_2_0</title>
<path fill="none" stroke="black" d="M5242.88,-3251.81C5261.22,-3242.64 5284.37,-3231.07 5307.12,-3219.69"/>
<polygon fill="black" stroke="black" points="5308.77,-3222.78 5316.15,-3215.17 5305.64,-3216.52 5308.77,-3222.78"/>
</g>
<!-- v_proj_2_2_0 -->
<g id="node219" class="node">
<title>v_proj_2_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="5675,-3215 5502,-3215 5502,-3132 5675,-3132 5675,-3215"/>
<text text-anchor="middle" x="5588.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5588.5" y="-3184.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="5588.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5588.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5588.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_2_0 -->
<g id="edge443" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_2_0</title>
<path fill="none" stroke="black" d="M5281.01,-3260.04C5336.95,-3251.57 5415.35,-3237.57 5492.1,-3214.93"/>
<polygon fill="black" stroke="black" points="5493.36,-3218.2 5501.94,-3211.98 5491.35,-3211.5 5493.36,-3218.2"/>
</g>
<!-- q_proj_2_2_1 -->
<g id="node220" class="node">
<title>q_proj_2_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="5866,-3215 5693,-3215 5693,-3132 5866,-3132 5866,-3215"/>
<text text-anchor="middle" x="5779.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5779.5" y="-3184.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="5779.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5779.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5779.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_2_1 -->
<g id="edge444" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_2_1</title>
<path fill="none" stroke="black" d="M5281.25,-3267.93C5374.06,-3263.91 5536.9,-3252.1 5682.73,-3214.96"/>
<polygon fill="black" stroke="black" points="5683.96,-3218.26 5692.76,-3212.36 5682.2,-3211.49 5683.96,-3218.26"/>
</g>
<!-- k_proj_2_2_1 -->
<g id="node221" class="node">
<title>k_proj_2_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="6057,-3215 5884,-3215 5884,-3132 6057,-3132 6057,-3215"/>
<text text-anchor="middle" x="5970.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5970.5" y="-3184.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="5970.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5970.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5970.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_2_1 -->
<g id="edge445" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_2_1</title>
<path fill="none" stroke="black" d="M5281.13,-3266.83C5427.06,-3260.16 5746.33,-3243.11 5873.86,-3214.82"/>
<polygon fill="black" stroke="black" points="5874.85,-3218.18 5883.79,-3212.49 5873.26,-3211.36 5874.85,-3218.18"/>
</g>
<!-- v_proj_2_2_1 -->
<g id="node222" class="node">
<title>v_proj_2_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="6248,-3215 6075,-3215 6075,-3132 6248,-3132 6248,-3215"/>
<text text-anchor="middle" x="6161.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="6161.5" y="-3184.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="6161.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6161.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6161.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_2_1 -->
<g id="edge446" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_2_1</title>
<path fill="none" stroke="black" d="M5281.06,-3268.43C5457.74,-3264.19 5898.84,-3250.54 6064.75,-3214.84"/>
<polygon fill="black" stroke="black" points="6065.82,-3218.18 6074.81,-3212.56 6064.28,-3211.35 6065.82,-3218.18"/>
</g>
<!-- q_proj_2_2_2 -->
<g id="node223" class="node">
<title>q_proj_2_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="6439,-3215 6266,-3215 6266,-3132 6439,-3132 6439,-3215"/>
<text text-anchor="middle" x="6352.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6352.5" y="-3184.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="6352.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6352.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6352.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_2_2 -->
<g id="edge447" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_2_2</title>
<path fill="none" stroke="black" d="M5281.24,-3266.81C5416.42,-3260.97 5710.55,-3247.84 5958.5,-3234 6087.77,-3226.79 6125.49,-3244.54 6255.84,-3214.88"/>
<polygon fill="black" stroke="black" points="6256.86,-3218.24 6265.81,-3212.57 6255.27,-3211.42 6256.86,-3218.24"/>
</g>
<!-- k_proj_2_2_2 -->
<g id="node224" class="node">
<title>k_proj_2_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="6630,-3215 6457,-3215 6457,-3132 6630,-3132 6630,-3215"/>
<text text-anchor="middle" x="6543.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6543.5" y="-3184.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="6543.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6543.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6543.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_2_2 -->
<g id="edge448" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_2_2</title>
<path fill="none" stroke="black" d="M5281.23,-3270.18C5510.8,-3270.19 6204.36,-3266.04 6446.99,-3214.79"/>
<polygon fill="black" stroke="black" points="6447.81,-3218.19 6456.82,-3212.63 6446.3,-3211.36 6447.81,-3218.19"/>
</g>
<!-- v_proj_2_2_2 -->
<g id="node225" class="node">
<title>v_proj_2_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="6821,-3215 6648,-3215 6648,-3132 6821,-3132 6821,-3215"/>
<text text-anchor="middle" x="6734.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6734.5" y="-3184.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="6734.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6734.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6734.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_2_2 -->
<g id="edge449" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_2_2</title>
<path fill="none" stroke="black" d="M5281.03,-3268.48C5462.74,-3264.6 5943.05,-3253.23 6343.5,-3234 6471.53,-3227.85 6508.82,-3244.34 6637.94,-3214.86"/>
<polygon fill="black" stroke="black" points="6638.86,-3218.24 6647.81,-3212.56 6637.27,-3211.43 6638.86,-3218.24"/>
</g>
<!-- q_proj_2_2_3 -->
<g id="node226" class="node">
<title>q_proj_2_2_3</title>
<polygon fill="#aaffff" stroke="black" points="7012,-3215 6839,-3215 6839,-3132 7012,-3132 7012,-3215"/>
<text text-anchor="middle" x="6925.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6925.5" y="-3184.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="6925.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6925.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6925.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_2_3 -->
<g id="edge450" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_2_3</title>
<path fill="none" stroke="black" d="M5281.06,-3268.35C5473.41,-3263.97 6002.22,-3251.22 6442.5,-3234 6611.3,-3227.4 6659.76,-3252.3 6828.84,-3214.88"/>
<polygon fill="black" stroke="black" points="6829.84,-3218.24 6838.82,-3212.63 6828.3,-3211.41 6829.84,-3218.24"/>
</g>
<!-- k_proj_2_2_3 -->
<g id="node227" class="node">
<title>k_proj_2_2_3</title>
<polygon fill="#aaffff" stroke="black" points="7203,-3215 7030,-3215 7030,-3132 7203,-3132 7203,-3215"/>
<text text-anchor="middle" x="7116.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7116.5" y="-3184.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="7116.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7116.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7116.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_2_3 -->
<g id="edge451" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_2_3</title>
<path fill="none" stroke="black" d="M5281.05,-3268.56C5489.05,-3264.44 6093.46,-3251.73 6595.5,-3234 6781.23,-3227.44 6834.26,-3255.63 7020.01,-3214.83"/>
<polygon fill="black" stroke="black" points="7020.83,-3218.24 7029.83,-3212.64 7019.3,-3211.41 7020.83,-3218.24"/>
</g>
<!-- v_proj_2_2_3 -->
<g id="node228" class="node">
<title>v_proj_2_2_3</title>
<polygon fill="#aaffff" stroke="black" points="7394,-3215 7221,-3215 7221,-3132 7394,-3132 7394,-3215"/>
<text text-anchor="middle" x="7307.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7307.5" y="-3184.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="7307.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7307.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7307.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_2_3 -->
<g id="edge452" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_2_3</title>
<path fill="none" stroke="black" d="M5281.35,-3268.81C5506.46,-3265.1 6197.1,-3252.89 6769.5,-3234 6962.76,-3227.62 7017.84,-3257.11 7210.93,-3214.85"/>
<polygon fill="black" stroke="black" points="7211.83,-3218.24 7220.83,-3212.65 7210.31,-3211.41 7211.83,-3218.24"/>
</g>
<!-- q_proj_2_3_0 -->
<g id="node229" class="node">
<title>q_proj_2_3_0</title>
<polygon fill="#ff8888" stroke="black" points="7585,-3215 7412,-3215 7412,-3132 7585,-3132 7585,-3215"/>
<text text-anchor="middle" x="7498.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7498.5" y="-3184.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="7498.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7498.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7498.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_3_0 -->
<g id="edge453" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_3_0</title>
<path fill="none" stroke="black" d="M5281.31,-3269.03C5522.92,-3265.76 6304.25,-3254.25 6950.5,-3234 7148.23,-3227.8 7204.5,-3258 7402.01,-3214.83"/>
<polygon fill="black" stroke="black" points="7402.82,-3218.24 7411.83,-3212.65 7401.31,-3211.41 7402.82,-3218.24"/>
</g>
<!-- k_proj_2_3_0 -->
<g id="node230" class="node">
<title>k_proj_2_3_0</title>
<polygon fill="#ff8888" stroke="black" points="7776,-3215 7603,-3215 7603,-3132 7776,-3132 7776,-3215"/>
<text text-anchor="middle" x="7689.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7689.5" y="-3184.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="7689.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7689.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7689.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_3_0 -->
<g id="edge454" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_3_0</title>
<path fill="none" stroke="black" d="M5281.15,-3269.23C5538.94,-3266.45 6415.67,-3255.88 7139.5,-3234 7338.11,-3228 7394.62,-3258.18 7592.97,-3214.84"/>
<polygon fill="black" stroke="black" points="7593.82,-3218.24 7602.83,-3212.66 7592.31,-3211.41 7593.82,-3218.24"/>
</g>
<!-- v_proj_2_3_0 -->
<g id="node231" class="node">
<title>v_proj_2_3_0</title>
<polygon fill="#ff8888" stroke="black" points="7967,-3215 7794,-3215 7794,-3132 7967,-3132 7967,-3215"/>
<text text-anchor="middle" x="7880.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7880.5" y="-3184.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="7880.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7880.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7880.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_3_0 -->
<g id="edge455" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_3_0</title>
<path fill="none" stroke="black" d="M5281.26,-3269.4C5554.87,-3267.07 6527.62,-3257.54 7329.5,-3234 7528.55,-3228.16 7585.18,-3258.27 7783.95,-3214.85"/>
<polygon fill="black" stroke="black" points="7784.82,-3218.24 7793.83,-3212.66 7783.31,-3211.41 7784.82,-3218.24"/>
</g>
<!-- q_proj_2_3_1 -->
<g id="node232" class="node">
<title>q_proj_2_3_1</title>
<polygon fill="#88ff88" stroke="black" points="8158,-3215 7985,-3215 7985,-3132 8158,-3132 8158,-3215"/>
<text text-anchor="middle" x="8071.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="8071.5" y="-3184.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="8071.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8071.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8071.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_3_1 -->
<g id="edge456" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_3_1</title>
<path fill="none" stroke="black" d="M5281.4,-3269.54C5570.21,-3267.64 6639.33,-3259.18 7519.5,-3234 7718.99,-3228.29 7775.75,-3258.36 7974.93,-3214.85"/>
<polygon fill="black" stroke="black" points="7975.82,-3218.24 7984.83,-3212.66 7974.31,-3211.41 7975.82,-3218.24"/>
</g>
<!-- k_proj_2_3_1 -->
<g id="node233" class="node">
<title>k_proj_2_3_1</title>
<polygon fill="#88ff88" stroke="black" points="8349,-3215 8176,-3215 8176,-3132 8349,-3132 8349,-3215"/>
<text text-anchor="middle" x="8262.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="8262.5" y="-3184.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="8262.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8262.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8262.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_3_1 -->
<g id="edge457" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_3_1</title>
<path fill="none" stroke="black" d="M5281.03,-3269.67C5583.74,-3268.17 6750.86,-3260.89 7710.5,-3234 7910,-3228.41 7966.75,-3258.36 8165.93,-3214.85"/>
<polygon fill="black" stroke="black" points="8166.82,-3218.24 8175.83,-3212.66 8165.31,-3211.41 8166.82,-3218.24"/>
</g>
<!-- v_proj_2_3_1 -->
<g id="node234" class="node">
<title>v_proj_2_3_1</title>
<polygon fill="#88ff88" stroke="black" points="8540,-3215 8367,-3215 8367,-3132 8540,-3132 8540,-3215"/>
<text text-anchor="middle" x="8453.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="8453.5" y="-3184.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="8453.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8453.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8453.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_3_1 -->
<g id="edge458" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_3_1</title>
<path fill="none" stroke="black" d="M5281,-3269.78C5597.57,-3268.67 6862.52,-3262.58 7901.5,-3234 8101,-3228.51 8157.75,-3258.36 8356.93,-3214.85"/>
<polygon fill="black" stroke="black" points="8357.82,-3218.24 8366.83,-3212.66 8356.31,-3211.41 8357.82,-3218.24"/>
</g>
<!-- q_proj_2_3_2 -->
<g id="node235" class="node">
<title>q_proj_2_3_2</title>
<polygon fill="#8888ff" stroke="black" points="8731,-3215 8558,-3215 8558,-3132 8731,-3132 8731,-3215"/>
<text text-anchor="middle" x="8644.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8644.5" y="-3184.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="8644.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8644.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8644.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_3_2 -->
<g id="edge459" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_3_2</title>
<path fill="none" stroke="black" d="M5281.21,-3269.87C5611.56,-3269.11 6974.25,-3264.21 8092.5,-3234 8292.44,-3228.6 8349.39,-3258.81 8548.07,-3215.09"/>
<polygon fill="black" stroke="black" points="8548.95,-3218.48 8557.94,-3212.88 8547.42,-3211.64 8548.95,-3218.48"/>
</g>
<!-- k_proj_2_3_2 -->
<g id="node236" class="node">
<title>k_proj_2_3_2</title>
<polygon fill="#8888ff" stroke="black" points="8922,-3215 8749,-3215 8749,-3132 8922,-3132 8922,-3215"/>
<text text-anchor="middle" x="8835.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8835.5" y="-3184.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="8835.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8835.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8835.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_3_2 -->
<g id="edge460" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_3_2</title>
<path fill="none" stroke="black" d="M5281.2,-3269.95C5624.53,-3269.54 7085.56,-3265.9 8283.5,-3234 8483.44,-3228.68 8540.39,-3258.82 8739.07,-3215.09"/>
<polygon fill="black" stroke="black" points="8739.95,-3218.48 8748.94,-3212.88 8738.42,-3211.64 8739.95,-3218.48"/>
</g>
<!-- v_proj_2_3_2 -->
<g id="node237" class="node">
<title>v_proj_2_3_2</title>
<polygon fill="#8888ff" stroke="black" points="9113,-3215 8940,-3215 8940,-3132 9113,-3132 9113,-3215"/>
<text text-anchor="middle" x="9026.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9026.5" y="-3184.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="9026.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="9026.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9026.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_3_2 -->
<g id="edge461" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_3_2</title>
<path fill="none" stroke="black" d="M5281.03,-3270.02C5636.64,-3269.94 7196.53,-3267.6 8474.5,-3234 8674.44,-3228.74 8731.39,-3258.82 8930.07,-3215.09"/>
<polygon fill="black" stroke="black" points="8930.95,-3218.48 8939.94,-3212.88 8929.42,-3211.64 8930.95,-3218.48"/>
</g>
<!-- q_proj_2_3_3 -->
<g id="node238" class="node">
<title>q_proj_2_3_3</title>
<polygon fill="#ffff88" stroke="black" points="9304,-3215 9131,-3215 9131,-3132 9304,-3132 9304,-3215"/>
<text text-anchor="middle" x="9217.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9217.5" y="-3184.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="9217.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="9217.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9217.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_3_3 -->
<g id="edge462" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_3_3</title>
<path fill="none" stroke="black" d="M5281.04,-3270.08C5648.82,-3270.31 7306.97,-3269.22 8664.5,-3234 8864.88,-3228.8 8921.95,-3258.91 9121.05,-3215.09"/>
<polygon fill="black" stroke="black" points="9121.95,-3218.48 9130.94,-3212.88 9120.42,-3211.64 9121.95,-3218.48"/>
</g>
<!-- k_proj_2_3_3 -->
<g id="node239" class="node">
<title>k_proj_2_3_3</title>
<polygon fill="#ffff88" stroke="black" points="9495,-3215 9322,-3215 9322,-3132 9495,-3132 9495,-3215"/>
<text text-anchor="middle" x="9408.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9408.5" y="-3184.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="9408.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="9408.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9408.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_3_3 -->
<g id="edge463" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_3_3</title>
<path fill="none" stroke="black" d="M5281,-3270.14C5660.56,-3270.65 7417.24,-3270.83 8854.5,-3234 9055.32,-3228.85 9112.51,-3258.99 9312.03,-3215.1"/>
<polygon fill="black" stroke="black" points="9312.95,-3218.48 9321.94,-3212.88 9311.42,-3211.64 9312.95,-3218.48"/>
</g>
<!-- v_proj_2_3_3 -->
<g id="node240" class="node">
<title>v_proj_2_3_3</title>
<polygon fill="#ffff88" stroke="black" points="9686,-3215 9513,-3215 9513,-3132 9686,-3132 9686,-3215"/>
<text text-anchor="middle" x="9599.5" y="-3199.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9599.5" y="-3184.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="9599.5" y="-3169.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="9599.5" y="-3154.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9599.5" y="-3139.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_3_3 -->
<g id="edge464" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_3_3</title>
<path fill="none" stroke="black" d="M5281.31,-3270.19C5673.13,-3270.99 7528.4,-3272.5 9045.5,-3234 9246.32,-3228.9 9303.51,-3259 9503.03,-3215.1"/>
<polygon fill="black" stroke="black" points="9503.95,-3218.48 9512.94,-3212.88 9502.42,-3211.64 9503.95,-3218.48"/>
</g>
<!-- ln2_2 -->
<g id="node278" class="node">
<title>ln2_2</title>
<polygon fill="lightgray" stroke="black" points="8127,-2308 7978,-2308 7978,-2270 8127,-2270 8127,-2308"/>
<text text-anchor="middle" x="8052.5" y="-2292.8" font-family="monospace" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8052.5" y="-2277.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- add_2&#45;&gt;ln2_2 -->
<g id="edge614" class="edge">
<title>add_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M8083.41,-2354.87C8076.9,-2341.21 8070.68,-2328.16 8065.55,-2317.38"/>
<polygon fill="black" stroke="black" points="8068.62,-2315.7 8061.16,-2308.18 8062.3,-2318.71 8068.62,-2315.7"/>
</g>
<!-- add2_2 -->
<g id="node279" class="node">
<title>add2_2</title>
<ellipse fill="lightgray" stroke="black" cx="8051.5" cy="-1814.5" rx="105.5" ry="105.5"/>
<text text-anchor="middle" x="8051.5" y="-1825.8" font-family="monospace" font-size="14.00">Add</text>
<text text-anchor="middle" x="8051.5" y="-1810.8" font-family="monospace" font-size="14.00">Residual</text>
<text text-anchor="middle" x="8051.5" y="-1795.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- add_2&#45;&gt;add2_2 -->
<g id="edge615" class="edge">
<title>add_2&#45;&gt;add2_2</title>
<path fill="none" stroke="black" d="M8154.24,-2347.96C8157.38,-2328.83 8159.5,-2308.9 8159.5,-2290 8159.5,-2290 8159.5,-2290 8159.5,-2004 8159.5,-1968.3 8144.73,-1933.23 8126.12,-1903.2"/>
<polygon fill="black" stroke="black" points="8128.86,-1900.98 8120.51,-1894.46 8122.97,-1904.77 8128.86,-1900.98"/>
</g>
<!-- attn_2_0_0 -->
<g id="node241" class="node">
<title>attn_2_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="896,-3081 797,-3081 797,-3013 896,-3013 896,-3081"/>
<text text-anchor="middle" x="846.5" y="-3065.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="846.5" y="-3050.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="846.5" y="-3035.8" font-family="monospace" font-size="14.00">Heads[0&#45;3]</text>
<text text-anchor="middle" x="846.5" y="-3020.8" font-family="monospace" font-size="14.00">Dim[0&#45;127]</text>
</g>
<!-- q_proj_2_0_0&#45;&gt;attn_2_0_0 -->
<g id="edge465" class="edge">
<title>q_proj_2_0_0&#45;&gt;attn_2_0_0</title>
<path fill="none" stroke="black" d="M659.11,-3131.98C671.37,-3120.14 685.71,-3107.98 700.5,-3099 727.07,-3082.86 759.47,-3070.89 786.99,-3062.61"/>
<polygon fill="black" stroke="black" points="788.27,-3065.89 796.89,-3059.73 786.31,-3059.17 788.27,-3065.89"/>
</g>
<!-- q_proj_2_0_0&#45;&gt;attn_2_0_0 -->
<g id="edge466" class="edge">
<title>q_proj_2_0_0&#45;&gt;attn_2_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M691.42,-3131.93C710.17,-3121.08 730.54,-3109.46 749.5,-3099 761.83,-3092.19 775.14,-3085.06 787.84,-3078.35"/>
<polygon fill="red" stroke="red" points="789.73,-3081.31 796.95,-3073.56 786.47,-3075.12 789.73,-3081.31"/>
<text text-anchor="middle" x="787.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_2_0_0&#45;&gt;attn_2_0_0 -->
<g id="edge467" class="edge">
<title>k_proj_2_0_0&#45;&gt;attn_2_0_0</title>
<path fill="none" stroke="black" d="M824.31,-3131.73C827.75,-3118.74 831.57,-3104.31 835.06,-3091.15"/>
<polygon fill="black" stroke="black" points="838.47,-3091.94 837.65,-3081.38 831.71,-3090.15 838.47,-3091.94"/>
</g>
<!-- k_proj_2_0_0&#45;&gt;attn_2_0_0 -->
<g id="edge468" class="edge">
<title>k_proj_2_0_0&#45;&gt;attn_2_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M839,-3131.68C841.65,-3125.92 843.94,-3119.93 845.5,-3114 847.39,-3106.84 848.39,-3099.09 848.83,-3091.5"/>
<polygon fill="red" stroke="red" points="852.33,-3091.42 849.11,-3081.33 845.33,-3091.23 852.33,-3091.42"/>
<text text-anchor="middle" x="886.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_2_0_0&#45;&gt;attn_2_0_0 -->
<g id="edge469" class="edge">
<title>v_proj_2_0_0&#45;&gt;attn_2_0_0</title>
<path fill="none" stroke="black" d="M965.72,-3131.92C954.2,-3120.73 941.24,-3108.94 928.5,-3099 921.04,-3093.18 912.89,-3087.45 904.71,-3082.06"/>
<polygon fill="black" stroke="black" points="906.51,-3079.05 896.21,-3076.56 902.71,-3084.93 906.51,-3079.05"/>
</g>
<!-- v_proj_2_0_0&#45;&gt;attn_2_0_0 -->
<g id="edge470" class="edge">
<title>v_proj_2_0_0&#45;&gt;attn_2_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M980.49,-3131.74C972.32,-3120.16 962.46,-3108.21 951.5,-3099 937.95,-3087.61 921.42,-3078.05 905.52,-3070.41"/>
<polygon fill="red" stroke="red" points="906.81,-3067.14 896.26,-3066.12 903.87,-3073.5 906.81,-3067.14"/>
<text text-anchor="middle" x="1004.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_2_0_1 -->
<g id="node244" class="node">
<title>attn_2_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="1490.5,-3081 1374.5,-3081 1374.5,-3013 1490.5,-3013 1490.5,-3081"/>
<text text-anchor="middle" x="1432.5" y="-3065.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1432.5" y="-3050.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="1432.5" y="-3035.8" font-family="monospace" font-size="14.00">Heads[0&#45;3]</text>
<text text-anchor="middle" x="1432.5" y="-3020.8" font-family="monospace" font-size="14.00">Dim[128&#45;255]</text>
</g>
<!-- q_proj_2_0_1&#45;&gt;attn_2_0_1 -->
<g id="edge474" class="edge">
<title>q_proj_2_0_1&#45;&gt;attn_2_0_1</title>
<path fill="none" stroke="black" d="M1201.03,-3131.73C1204.53,-3119.74 1210.23,-3107.56 1219.5,-3099 1240.52,-3079.61 1310.35,-3065.4 1364.39,-3056.98"/>
<polygon fill="black" stroke="black" points="1364.92,-3060.44 1374.28,-3055.47 1363.87,-3053.52 1364.92,-3060.44"/>
</g>
<!-- q_proj_2_0_1&#45;&gt;attn_2_0_1 -->
<g id="edge475" class="edge">
<title>q_proj_2_0_1&#45;&gt;attn_2_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1267.28,-3131.99C1287.02,-3121.08 1308.5,-3109.42 1328.5,-3099 1340.3,-3092.85 1352.94,-3086.48 1365.2,-3080.4"/>
<polygon fill="red" stroke="red" points="1367.07,-3083.39 1374.49,-3075.83 1363.97,-3077.11 1367.07,-3083.39"/>
<text text-anchor="middle" x="1366.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_2_0_1&#45;&gt;attn_2_0_1 -->
<g id="edge476" class="edge">
<title>k_proj_2_0_1&#45;&gt;attn_2_0_1</title>
<path fill="none" stroke="black" d="M1401.56,-3131.73C1406.41,-3118.61 1411.8,-3104.03 1416.7,-3090.77"/>
<polygon fill="black" stroke="black" points="1419.98,-3091.97 1420.17,-3081.38 1413.42,-3089.55 1419.98,-3091.97"/>
</g>
<!-- k_proj_2_0_1&#45;&gt;attn_2_0_1 -->
<g id="edge477" class="edge">
<title>k_proj_2_0_1&#45;&gt;attn_2_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1417.03,-3131.96C1420.34,-3126.16 1423.3,-3120.08 1425.5,-3114 1428.09,-3106.84 1429.81,-3098.98 1430.93,-3091.26"/>
<polygon fill="red" stroke="red" points="1434.41,-3091.6 1432.09,-3081.26 1427.46,-3090.79 1434.41,-3091.6"/>
<text text-anchor="middle" x="1467.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_2_0_1&#45;&gt;attn_2_0_1 -->
<g id="edge478" class="edge">
<title>v_proj_2_0_1&#45;&gt;attn_2_0_1</title>
<path fill="none" stroke="black" d="M1543.14,-3131.89C1532.83,-3120.69 1521.15,-3108.91 1509.5,-3099 1504.77,-3094.98 1499.71,-3091.01 1494.53,-3087.16"/>
<polygon fill="black" stroke="black" points="1496.47,-3084.25 1486.31,-3081.24 1492.37,-3089.92 1496.47,-3084.25"/>
</g>
<!-- v_proj_2_0_1&#45;&gt;attn_2_0_1 -->
<g id="edge479" class="edge">
<title>v_proj_2_0_1&#45;&gt;attn_2_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1557.97,-3131.78C1551.07,-3120.21 1542.49,-3108.25 1532.5,-3099 1522.87,-3090.09 1511.38,-3082.34 1499.69,-3075.75"/>
<polygon fill="red" stroke="red" points="1501.2,-3072.59 1490.73,-3070.94 1497.89,-3078.76 1501.2,-3072.59"/>
<text text-anchor="middle" x="1583.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_2_0_2 -->
<g id="node246" class="node">
<title>attn_2_0_2</title>
<polygon fill="#ccccff" stroke="black" points="2017.5,-3081 1901.5,-3081 1901.5,-3013 2017.5,-3013 2017.5,-3081"/>
<text text-anchor="middle" x="1959.5" y="-3065.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1959.5" y="-3050.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="1959.5" y="-3035.8" font-family="monospace" font-size="14.00">Heads[0&#45;3]</text>
<text text-anchor="middle" x="1959.5" y="-3020.8" font-family="monospace" font-size="14.00">Dim[256&#45;383]</text>
</g>
<!-- q_proj_2_0_2&#45;&gt;attn_2_0_2 -->
<g id="edge483" class="edge">
<title>q_proj_2_0_2&#45;&gt;attn_2_0_2</title>
<path fill="none" stroke="black" d="M1786.83,-3131.68C1793.77,-3119.82 1802.67,-3107.74 1813.5,-3099 1835.83,-3080.99 1864.95,-3069.13 1891.31,-3061.42"/>
<polygon fill="black" stroke="black" points="1892.55,-3064.71 1901.26,-3058.67 1890.68,-3057.96 1892.55,-3064.71"/>
</g>
<!-- q_proj_2_0_2&#45;&gt;attn_2_0_2 -->
<g id="edge484" class="edge">
<title>q_proj_2_0_2&#45;&gt;attn_2_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1829.44,-3131.87C1845.67,-3121.13 1863.22,-3109.58 1879.5,-3099 1885.67,-3094.99 1892.13,-3090.83 1898.58,-3086.68"/>
<polygon fill="red" stroke="red" points="1900.81,-3089.41 1907.35,-3081.06 1897.04,-3083.51 1900.81,-3089.41"/>
<text text-anchor="middle" x="1917.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_2_0_2&#45;&gt;attn_2_0_2 -->
<g id="edge485" class="edge">
<title>k_proj_2_0_2&#45;&gt;attn_2_0_2</title>
<path fill="none" stroke="black" d="M1959.5,-3131.73C1959.5,-3118.86 1959.5,-3104.6 1959.5,-3091.54"/>
<polygon fill="black" stroke="black" points="1963,-3091.38 1959.5,-3081.38 1956,-3091.38 1963,-3091.38"/>
</g>
<!-- k_proj_2_0_2&#45;&gt;attn_2_0_2 -->
<g id="edge486" class="edge">
<title>k_proj_2_0_2&#45;&gt;attn_2_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1972.01,-3131.81C1973.97,-3121.17 1974.94,-3109.68 1973.5,-3099 1973.16,-3096.45 1972.72,-3093.85 1972.22,-3091.24"/>
<polygon fill="red" stroke="red" points="1975.57,-3090.21 1969.99,-3081.2 1968.74,-3091.72 1975.57,-3090.21"/>
<text text-anchor="middle" x="2012.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_2_0_2&#45;&gt;attn_2_0_2 -->
<g id="edge487" class="edge">
<title>v_proj_2_0_2&#45;&gt;attn_2_0_2</title>
<path fill="none" stroke="black" d="M2100.29,-3131.64C2085.85,-3120.56 2069.84,-3108.9 2054.5,-3099 2045.59,-3093.25 2035.97,-3087.55 2026.39,-3082.15"/>
<polygon fill="black" stroke="black" points="2028.07,-3079.08 2017.63,-3077.29 2024.67,-3085.2 2028.07,-3079.08"/>
</g>
<!-- v_proj_2_0_2&#45;&gt;attn_2_0_2 -->
<g id="edge488" class="edge">
<title>v_proj_2_0_2&#45;&gt;attn_2_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2116.62,-3131.66C2105.62,-3120.08 2092.8,-3108.15 2079.5,-3099 2063.68,-3088.13 2045.18,-3078.86 2027.5,-3071.33"/>
<polygon fill="red" stroke="red" points="2028.37,-3067.9 2017.79,-3067.33 2025.7,-3074.37 2028.37,-3067.9"/>
<text text-anchor="middle" x="2135.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_2_0_3 -->
<g id="node248" class="node">
<title>attn_2_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="2426.5,-3081 2310.5,-3081 2310.5,-3013 2426.5,-3013 2426.5,-3081"/>
<text text-anchor="middle" x="2368.5" y="-3065.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2368.5" y="-3050.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="2368.5" y="-3035.8" font-family="monospace" font-size="14.00">Heads[0&#45;3]</text>
<text text-anchor="middle" x="2368.5" y="-3020.8" font-family="monospace" font-size="14.00">Dim[384&#45;511]</text>
</g>
<!-- q_proj_2_0_3&#45;&gt;attn_2_0_3 -->
<g id="edge492" class="edge">
<title>q_proj_2_0_3&#45;&gt;attn_2_0_3</title>
<path fill="none" stroke="black" d="M2350.34,-3131.73C2353.16,-3118.74 2356.29,-3104.31 2359.14,-3091.15"/>
<polygon fill="black" stroke="black" points="2362.56,-3091.89 2361.26,-3081.38 2355.72,-3090.41 2362.56,-3091.89"/>
</g>
<!-- q_proj_2_0_3&#45;&gt;attn_2_0_3 -->
<g id="edge493" class="edge">
<title>q_proj_2_0_3&#45;&gt;attn_2_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2364.57,-3131.84C2367.01,-3126.01 2369.1,-3119.96 2370.5,-3114 2372.19,-3106.79 2372.9,-3099.01 2373.01,-3091.41"/>
<polygon fill="red" stroke="red" points="2376.51,-3091.17 2372.84,-3081.23 2369.51,-3091.29 2376.51,-3091.17"/>
<text text-anchor="middle" x="2411.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_2_0_3&#45;&gt;attn_2_0_3 -->
<g id="edge494" class="edge">
<title>k_proj_2_0_3&#45;&gt;attn_2_0_3</title>
<path fill="none" stroke="black" d="M2492.11,-3131.89C2480.13,-3120.69 2466.67,-3108.91 2453.5,-3099 2447.73,-3094.66 2441.57,-3090.38 2435.31,-3086.24"/>
<polygon fill="black" stroke="black" points="2437.02,-3083.18 2426.72,-3080.71 2433.23,-3089.07 2437.02,-3083.18"/>
</g>
<!-- k_proj_2_0_3&#45;&gt;attn_2_0_3 -->
<g id="edge495" class="edge">
<title>k_proj_2_0_3&#45;&gt;attn_2_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2507.43,-3131.67C2498.95,-3120.09 2488.75,-3108.15 2477.5,-3099 2465.2,-3088.99 2450.62,-3080.44 2436.19,-3073.36"/>
<polygon fill="red" stroke="red" points="2437.29,-3070 2426.75,-3068.91 2434.3,-3076.34 2437.29,-3070"/>
<text text-anchor="middle" x="2530.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_2_0_3&#45;&gt;attn_2_0_3 -->
<g id="edge496" class="edge">
<title>v_proj_2_0_3&#45;&gt;attn_2_0_3</title>
<path fill="none" stroke="black" d="M2648.02,-3131.95C2624.3,-3120.24 2597.71,-3108.17 2572.5,-3099 2528.22,-3082.89 2476.74,-3070.06 2436.57,-3061.3"/>
<polygon fill="black" stroke="black" points="2437.13,-3057.84 2426.61,-3059.16 2435.66,-3064.68 2437.13,-3057.84"/>
</g>
<!-- v_proj_2_0_3&#45;&gt;attn_2_0_3 -->
<g id="edge497" class="edge">
<title>v_proj_2_0_3&#45;&gt;attn_2_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2666.59,-3131.89C2647.57,-3119.84 2625.78,-3107.58 2604.5,-3099 2550.23,-3077.13 2484.99,-3063.95 2436.87,-3056.48"/>
<polygon fill="red" stroke="red" points="2437.28,-3053 2426.87,-3054.97 2436.24,-3059.93 2437.28,-3053"/>
<text text-anchor="middle" x="2674.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_2_1_0 -->
<g id="node250" class="node">
<title>attn_2_1_0</title>
<polygon fill="#ffccff" stroke="black" points="3205,-3081 3106,-3081 3106,-3013 3205,-3013 3205,-3081"/>
<text text-anchor="middle" x="3155.5" y="-3065.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="3155.5" y="-3050.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3155.5" y="-3035.8" font-family="monospace" font-size="14.00">Heads[4&#45;7]</text>
<text text-anchor="middle" x="3155.5" y="-3020.8" font-family="monospace" font-size="14.00">Dim[0&#45;127]</text>
</g>
<!-- q_proj_2_1_0&#45;&gt;attn_2_1_0 -->
<g id="edge501" class="edge">
<title>q_proj_2_1_0&#45;&gt;attn_2_1_0</title>
<path fill="none" stroke="black" d="M2941.73,-3131.69C2951.46,-3119.69 2963.32,-3107.52 2976.5,-3099 3012.47,-3075.75 3059.17,-3062.91 3095.86,-3055.92"/>
<polygon fill="black" stroke="black" points="3096.7,-3059.33 3105.92,-3054.1 3095.46,-3052.44 3096.7,-3059.33"/>
</g>
<!-- q_proj_2_1_0&#45;&gt;attn_2_1_0 -->
<g id="edge502" class="edge">
<title>q_proj_2_1_0&#45;&gt;attn_2_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2987.36,-3131.97C3007.39,-3121.06 3029.19,-3109.4 3049.5,-3099 3064.63,-3091.25 3081.12,-3083.15 3096.5,-3075.74"/>
<polygon fill="red" stroke="red" points="3098.4,-3078.71 3105.9,-3071.23 3095.37,-3072.4 3098.4,-3078.71"/>
<text text-anchor="middle" x="3087.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_2_1_0&#45;&gt;attn_2_1_0 -->
<g id="edge503" class="edge">
<title>k_proj_2_1_0&#45;&gt;attn_2_1_0</title>
<path fill="none" stroke="black" d="M3121.87,-3131.73C3127.14,-3118.61 3133,-3104.03 3138.32,-3090.77"/>
<polygon fill="black" stroke="black" points="3141.62,-3091.96 3142.09,-3081.38 3135.12,-3089.35 3141.62,-3091.96"/>
</g>
<!-- k_proj_2_1_0&#45;&gt;attn_2_1_0 -->
<g id="edge504" class="edge">
<title>k_proj_2_1_0&#45;&gt;attn_2_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3137.63,-3131.7C3141.06,-3125.98 3144.15,-3120 3146.5,-3114 3149.32,-3106.81 3151.28,-3098.89 3152.63,-3091.1"/>
<polygon fill="red" stroke="red" points="3156.13,-3091.4 3154.09,-3081 3149.2,-3090.4 3156.13,-3091.4"/>
<text text-anchor="middle" x="3189.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_2_1_0&#45;&gt;attn_2_1_0 -->
<g id="edge505" class="edge">
<title>v_proj_2_1_0&#45;&gt;attn_2_1_0</title>
<path fill="none" stroke="black" d="M3263.84,-3131.84C3253.99,-3120.64 3242.78,-3108.87 3231.5,-3099 3225.91,-3094.11 3219.83,-3089.3 3213.62,-3084.71"/>
<polygon fill="black" stroke="black" points="3215.27,-3081.59 3205.11,-3078.6 3211.19,-3087.28 3215.27,-3081.59"/>
</g>
<!-- v_proj_2_1_0&#45;&gt;attn_2_1_0 -->
<g id="edge506" class="edge">
<title>v_proj_2_1_0&#45;&gt;attn_2_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3278.08,-3131.82C3271.5,-3120.24 3263.25,-3108.27 3253.5,-3099 3242.16,-3088.21 3228.09,-3079.11 3214.18,-3071.73"/>
<polygon fill="red" stroke="red" points="3215.6,-3068.52 3205.1,-3067.13 3212.43,-3074.77 3215.6,-3068.52"/>
<text text-anchor="middle" x="3304.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_2_1_1 -->
<g id="node253" class="node">
<title>attn_2_1_1</title>
<polygon fill="#ccffff" stroke="black" points="3763.5,-3081 3647.5,-3081 3647.5,-3013 3763.5,-3013 3763.5,-3081"/>
<text text-anchor="middle" x="3705.5" y="-3065.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3705.5" y="-3050.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3705.5" y="-3035.8" font-family="monospace" font-size="14.00">Heads[4&#45;7]</text>
<text text-anchor="middle" x="3705.5" y="-3020.8" font-family="monospace" font-size="14.00">Dim[128&#45;255]</text>
</g>
<!-- q_proj_2_1_1&#45;&gt;attn_2_1_1 -->
<g id="edge510" class="edge">
<title>q_proj_2_1_1&#45;&gt;attn_2_1_1</title>
<path fill="none" stroke="black" d="M3515.8,-3131.63C3525.65,-3119.77 3537.51,-3107.7 3550.5,-3099 3576.5,-3081.59 3608.93,-3069.71 3637.39,-3061.82"/>
<polygon fill="black" stroke="black" points="3638.51,-3065.15 3647.28,-3059.2 3636.71,-3058.38 3638.51,-3065.15"/>
</g>
<!-- q_proj_2_1_1&#45;&gt;attn_2_1_1 -->
<g id="edge511" class="edge">
<title>q_proj_2_1_1&#45;&gt;attn_2_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3554.8,-3131.98C3573.11,-3121.13 3593,-3109.5 3611.5,-3099 3620.16,-3094.09 3629.32,-3088.99 3638.38,-3084.01"/>
<polygon fill="red" stroke="red" points="3640.3,-3086.95 3647.39,-3079.08 3636.94,-3080.81 3640.3,-3086.95"/>
<text text-anchor="middle" x="3649.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_2_1_1&#45;&gt;attn_2_1_1 -->
<g id="edge512" class="edge">
<title>k_proj_2_1_1&#45;&gt;attn_2_1_1</title>
<path fill="none" stroke="black" d="M3687.34,-3131.73C3690.16,-3118.74 3693.29,-3104.31 3696.14,-3091.15"/>
<polygon fill="black" stroke="black" points="3699.56,-3091.89 3698.26,-3081.38 3692.72,-3090.41 3699.56,-3091.89"/>
</g>
<!-- k_proj_2_1_1&#45;&gt;attn_2_1_1 -->
<g id="edge513" class="edge">
<title>k_proj_2_1_1&#45;&gt;attn_2_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3701.57,-3131.84C3704.01,-3126.01 3706.1,-3119.96 3707.5,-3114 3709.19,-3106.79 3709.9,-3099.01 3710.01,-3091.41"/>
<polygon fill="red" stroke="red" points="3713.51,-3091.17 3709.84,-3081.23 3706.51,-3091.29 3713.51,-3091.17"/>
<text text-anchor="middle" x="3748.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_2_1_1&#45;&gt;attn_2_1_1 -->
<g id="edge514" class="edge">
<title>v_proj_2_1_1&#45;&gt;attn_2_1_1</title>
<path fill="none" stroke="black" d="M3829.11,-3131.89C3817.13,-3120.69 3803.67,-3108.91 3790.5,-3099 3784.73,-3094.66 3778.57,-3090.38 3772.31,-3086.24"/>
<polygon fill="black" stroke="black" points="3774.02,-3083.18 3763.72,-3080.71 3770.23,-3089.07 3774.02,-3083.18"/>
</g>
<!-- v_proj_2_1_1&#45;&gt;attn_2_1_1 -->
<g id="edge515" class="edge">
<title>v_proj_2_1_1&#45;&gt;attn_2_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3844.43,-3131.67C3835.95,-3120.09 3825.75,-3108.15 3814.5,-3099 3802.2,-3088.99 3787.62,-3080.44 3773.19,-3073.36"/>
<polygon fill="red" stroke="red" points="3774.29,-3070 3763.75,-3068.91 3771.3,-3076.34 3774.29,-3070"/>
<text text-anchor="middle" x="3867.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_2_1_2 -->
<g id="node255" class="node">
<title>attn_2_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="4309.5,-3081 4193.5,-3081 4193.5,-3013 4309.5,-3013 4309.5,-3081"/>
<text text-anchor="middle" x="4251.5" y="-3065.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="4251.5" y="-3050.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4251.5" y="-3035.8" font-family="monospace" font-size="14.00">Heads[4&#45;7]</text>
<text text-anchor="middle" x="4251.5" y="-3020.8" font-family="monospace" font-size="14.00">Dim[256&#45;383]</text>
</g>
<!-- q_proj_2_1_2&#45;&gt;attn_2_1_2 -->
<g id="edge519" class="edge">
<title>q_proj_2_1_2&#45;&gt;attn_2_1_2</title>
<path fill="none" stroke="black" d="M4078.83,-3131.68C4085.77,-3119.82 4094.67,-3107.74 4105.5,-3099 4127.83,-3080.99 4156.95,-3069.13 4183.31,-3061.42"/>
<polygon fill="black" stroke="black" points="4184.55,-3064.71 4193.26,-3058.67 4182.68,-3057.96 4184.55,-3064.71"/>
</g>
<!-- q_proj_2_1_2&#45;&gt;attn_2_1_2 -->
<g id="edge520" class="edge">
<title>q_proj_2_1_2&#45;&gt;attn_2_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4121.44,-3131.87C4137.67,-3121.13 4155.22,-3109.58 4171.5,-3099 4177.67,-3094.99 4184.13,-3090.83 4190.58,-3086.68"/>
<polygon fill="red" stroke="red" points="4192.81,-3089.41 4199.35,-3081.06 4189.04,-3083.51 4192.81,-3089.41"/>
<text text-anchor="middle" x="4209.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_2_1_2&#45;&gt;attn_2_1_2 -->
<g id="edge521" class="edge">
<title>k_proj_2_1_2&#45;&gt;attn_2_1_2</title>
<path fill="none" stroke="black" d="M4251.5,-3131.73C4251.5,-3118.86 4251.5,-3104.6 4251.5,-3091.54"/>
<polygon fill="black" stroke="black" points="4255,-3091.38 4251.5,-3081.38 4248,-3091.38 4255,-3091.38"/>
</g>
<!-- k_proj_2_1_2&#45;&gt;attn_2_1_2 -->
<g id="edge522" class="edge">
<title>k_proj_2_1_2&#45;&gt;attn_2_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4264.01,-3131.81C4265.97,-3121.17 4266.94,-3109.68 4265.5,-3099 4265.16,-3096.45 4264.72,-3093.85 4264.22,-3091.24"/>
<polygon fill="red" stroke="red" points="4267.57,-3090.21 4261.99,-3081.2 4260.74,-3091.72 4267.57,-3090.21"/>
<text text-anchor="middle" x="4304.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_2_1_2&#45;&gt;attn_2_1_2 -->
<g id="edge523" class="edge">
<title>v_proj_2_1_2&#45;&gt;attn_2_1_2</title>
<path fill="none" stroke="black" d="M4392.29,-3131.64C4377.85,-3120.56 4361.84,-3108.9 4346.5,-3099 4337.59,-3093.25 4327.97,-3087.55 4318.39,-3082.15"/>
<polygon fill="black" stroke="black" points="4320.07,-3079.08 4309.63,-3077.29 4316.67,-3085.2 4320.07,-3079.08"/>
</g>
<!-- v_proj_2_1_2&#45;&gt;attn_2_1_2 -->
<g id="edge524" class="edge">
<title>v_proj_2_1_2&#45;&gt;attn_2_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4408.62,-3131.66C4397.62,-3120.08 4384.8,-3108.15 4371.5,-3099 4355.68,-3088.13 4337.18,-3078.86 4319.5,-3071.33"/>
<polygon fill="red" stroke="red" points="4320.37,-3067.9 4309.79,-3067.33 4317.7,-3074.37 4320.37,-3067.9"/>
<text text-anchor="middle" x="4427.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_2_1_3 -->
<g id="node257" class="node">
<title>attn_2_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="4797.5,-3081 4681.5,-3081 4681.5,-3013 4797.5,-3013 4797.5,-3081"/>
<text text-anchor="middle" x="4739.5" y="-3065.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="4739.5" y="-3050.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4739.5" y="-3035.8" font-family="monospace" font-size="14.00">Heads[4&#45;7]</text>
<text text-anchor="middle" x="4739.5" y="-3020.8" font-family="monospace" font-size="14.00">Dim[384&#45;511]</text>
</g>
<!-- q_proj_2_1_3&#45;&gt;attn_2_1_3 -->
<g id="edge528" class="edge">
<title>q_proj_2_1_3&#45;&gt;attn_2_1_3</title>
<path fill="none" stroke="black" d="M4656.63,-3131.72C4663.69,-3120.64 4671.88,-3108.96 4680.5,-3099 4683.66,-3095.35 4687.08,-3091.73 4690.63,-3088.2"/>
<polygon fill="black" stroke="black" points="4693.24,-3090.55 4698.05,-3081.11 4688.41,-3085.49 4693.24,-3090.55"/>
</g>
<!-- q_proj_2_1_3&#45;&gt;attn_2_1_3 -->
<g id="edge529" class="edge">
<title>q_proj_2_1_3&#45;&gt;attn_2_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4668.21,-3131.73C4679.82,-3118.1 4692.76,-3102.9 4704.4,-3089.23"/>
<polygon fill="red" stroke="red" points="4707.26,-3091.26 4711.08,-3081.38 4701.93,-3086.72 4707.26,-3091.26"/>
<text text-anchor="middle" x="4734.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_2_1_3&#45;&gt;attn_2_1_3 -->
<g id="edge530" class="edge">
<title>k_proj_2_1_3&#45;&gt;attn_2_1_3</title>
<path fill="none" stroke="black" d="M4802.89,-3131.64C4796.69,-3120.78 4789.65,-3109.24 4782.5,-3099 4780.21,-3095.73 4777.77,-3092.41 4775.24,-3089.13"/>
<polygon fill="black" stroke="black" points="4777.8,-3086.72 4768.84,-3081.06 4772.31,-3091.07 4777.8,-3086.72"/>
</g>
<!-- k_proj_2_1_3&#45;&gt;attn_2_1_3 -->
<g id="edge531" class="edge">
<title>k_proj_2_1_3&#45;&gt;attn_2_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4816.28,-3131.69C4812.85,-3120.49 4808.07,-3108.76 4801.5,-3099 4799.09,-3095.42 4796.36,-3091.97 4793.42,-3088.65"/>
<polygon fill="red" stroke="red" points="4795.68,-3085.96 4786.22,-3081.19 4790.64,-3090.82 4795.68,-3085.96"/>
<text text-anchor="middle" x="4848.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_2_1_3&#45;&gt;attn_2_1_3 -->
<g id="edge532" class="edge">
<title>v_proj_2_1_3&#45;&gt;attn_2_1_3</title>
<path fill="none" stroke="black" d="M4952.3,-3131.94C4932.91,-3120.43 4911.22,-3108.47 4890.5,-3099 4863.94,-3086.86 4833.61,-3076.06 4807.14,-3067.56"/>
<polygon fill="black" stroke="black" points="4808.17,-3064.22 4797.58,-3064.54 4806.06,-3070.89 4808.17,-3064.22"/>
</g>
<!-- v_proj_2_1_3&#45;&gt;attn_2_1_3 -->
<g id="edge533" class="edge">
<title>v_proj_2_1_3&#45;&gt;attn_2_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4969.53,-3131.69C4954.39,-3119.84 4936.95,-3107.75 4919.5,-3099 4884.49,-3081.44 4842.52,-3069.11 4807.91,-3060.98"/>
<polygon fill="red" stroke="red" points="4808.42,-3057.5 4797.9,-3058.69 4806.87,-3064.33 4808.42,-3057.5"/>
<text text-anchor="middle" x="4980.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_2_2_0 -->
<g id="node259" class="node">
<title>attn_2_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="5501,-3081 5394,-3081 5394,-3013 5501,-3013 5501,-3081"/>
<text text-anchor="middle" x="5447.5" y="-3065.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5447.5" y="-3050.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5447.5" y="-3035.8" font-family="monospace" font-size="14.00">Heads[8&#45;11]</text>
<text text-anchor="middle" x="5447.5" y="-3020.8" font-family="monospace" font-size="14.00">Dim[0&#45;127]</text>
</g>
<!-- q_proj_2_2_0&#45;&gt;attn_2_2_0 -->
<g id="edge537" class="edge">
<title>q_proj_2_2_0&#45;&gt;attn_2_2_0</title>
<path fill="none" stroke="black" d="M5233.73,-3131.69C5243.46,-3119.69 5255.32,-3107.52 5268.5,-3099 5303.23,-3076.55 5347.96,-3063.8 5384.03,-3056.67"/>
<polygon fill="black" stroke="black" points="5384.77,-3060.09 5393.95,-3054.8 5383.48,-3053.21 5384.77,-3060.09"/>
</g>
<!-- q_proj_2_2_0&#45;&gt;attn_2_2_0 -->
<g id="edge538" class="edge">
<title>q_proj_2_2_0&#45;&gt;attn_2_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5279.36,-3131.97C5299.39,-3121.06 5321.19,-3109.4 5341.5,-3099 5355.37,-3091.9 5370.38,-3084.5 5384.63,-3077.61"/>
<polygon fill="red" stroke="red" points="5386.37,-3080.66 5393.86,-3073.16 5383.33,-3074.35 5386.37,-3080.66"/>
<text text-anchor="middle" x="5379.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_2_2_0&#45;&gt;attn_2_2_0 -->
<g id="edge539" class="edge">
<title>k_proj_2_2_0&#45;&gt;attn_2_2_0</title>
<path fill="none" stroke="black" d="M5413.87,-3131.73C5419.14,-3118.61 5425,-3104.03 5430.32,-3090.77"/>
<polygon fill="black" stroke="black" points="5433.62,-3091.96 5434.09,-3081.38 5427.12,-3089.35 5433.62,-3091.96"/>
</g>
<!-- k_proj_2_2_0&#45;&gt;attn_2_2_0 -->
<g id="edge540" class="edge">
<title>k_proj_2_2_0&#45;&gt;attn_2_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5429.63,-3131.7C5433.06,-3125.98 5436.15,-3120 5438.5,-3114 5441.32,-3106.81 5443.28,-3098.89 5444.63,-3091.1"/>
<polygon fill="red" stroke="red" points="5448.13,-3091.4 5446.09,-3081 5441.2,-3090.4 5448.13,-3091.4"/>
<text text-anchor="middle" x="5481.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_2_2_0&#45;&gt;attn_2_2_0 -->
<g id="edge541" class="edge">
<title>v_proj_2_2_0&#45;&gt;attn_2_2_0</title>
<path fill="none" stroke="black" d="M5555.84,-3131.84C5545.99,-3120.64 5534.78,-3108.87 5523.5,-3099 5518.87,-3094.95 5513.9,-3090.96 5508.8,-3087.1"/>
<polygon fill="black" stroke="black" points="5510.85,-3084.26 5500.72,-3081.15 5506.7,-3089.9 5510.85,-3084.26"/>
</g>
<!-- v_proj_2_2_0&#45;&gt;attn_2_2_0 -->
<g id="edge542" class="edge">
<title>v_proj_2_2_0&#45;&gt;attn_2_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5570.08,-3131.82C5563.5,-3120.24 5555.25,-3108.27 5545.5,-3099 5535.27,-3089.26 5522.82,-3080.91 5510.27,-3073.95"/>
<polygon fill="red" stroke="red" points="5511.62,-3070.7 5501.14,-3069.12 5508.35,-3076.89 5511.62,-3070.7"/>
<text text-anchor="middle" x="5596.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_2_2_1 -->
<g id="node262" class="node">
<title>attn_2_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="6038.5,-3081 5922.5,-3081 5922.5,-3013 6038.5,-3013 6038.5,-3081"/>
<text text-anchor="middle" x="5980.5" y="-3065.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5980.5" y="-3050.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5980.5" y="-3035.8" font-family="monospace" font-size="14.00">Heads[8&#45;11]</text>
<text text-anchor="middle" x="5980.5" y="-3020.8" font-family="monospace" font-size="14.00">Dim[128&#45;255]</text>
</g>
<!-- q_proj_2_2_1&#45;&gt;attn_2_2_1 -->
<g id="edge546" class="edge">
<title>q_proj_2_2_1&#45;&gt;attn_2_2_1</title>
<path fill="none" stroke="black" d="M5798.64,-3131.95C5805.94,-3119.97 5815.26,-3107.74 5826.5,-3099 5851.26,-3079.75 5883.63,-3067.59 5912.29,-3060.01"/>
<polygon fill="black" stroke="black" points="5913.41,-3063.34 5922.26,-3057.51 5911.7,-3056.55 5913.41,-3063.34"/>
</g>
<!-- q_proj_2_2_1&#45;&gt;attn_2_2_1 -->
<g id="edge547" class="edge">
<title>q_proj_2_2_1&#45;&gt;attn_2_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5842.84,-3131.97C5859.89,-3121.18 5878.35,-3109.57 5895.5,-3099 5902.19,-3094.87 5909.21,-3090.59 5916.21,-3086.35"/>
<polygon fill="red" stroke="red" points="5918.31,-3089.17 5925.06,-3081 5914.69,-3083.18 5918.31,-3089.17"/>
<text text-anchor="middle" x="5933.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_2_2_1&#45;&gt;attn_2_2_1 -->
<g id="edge548" class="edge">
<title>k_proj_2_2_1&#45;&gt;attn_2_2_1</title>
<path fill="none" stroke="black" d="M5973.77,-3131.73C5974.81,-3118.86 5975.95,-3104.6 5977,-3091.54"/>
<polygon fill="black" stroke="black" points="5980.51,-3091.63 5977.82,-3081.38 5973.53,-3091.07 5980.51,-3091.63"/>
</g>
<!-- k_proj_2_2_1&#45;&gt;attn_2_2_1 -->
<g id="edge549" class="edge">
<title>k_proj_2_2_1&#45;&gt;attn_2_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5986.34,-3131.71C5988.06,-3125.84 5989.53,-3119.82 5990.5,-3114 5991.71,-3106.69 5991.7,-3098.92 5990.99,-3091.36"/>
<polygon fill="red" stroke="red" points="5994.44,-3090.72 5989.65,-3081.27 5987.5,-3091.64 5994.44,-3090.72"/>
<text text-anchor="middle" x="6029.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_2_2_1&#45;&gt;attn_2_2_1 -->
<g id="edge550" class="edge">
<title>v_proj_2_2_1&#45;&gt;attn_2_2_1</title>
<path fill="none" stroke="black" d="M6115.05,-3131.99C6101.39,-3120.8 6086.17,-3108.99 6071.5,-3099 6063.91,-3093.83 6055.77,-3088.72 6047.58,-3083.83"/>
<polygon fill="black" stroke="black" points="6049.09,-3080.66 6038.7,-3078.62 6045.55,-3086.7 6049.09,-3080.66"/>
</g>
<!-- v_proj_2_2_1&#45;&gt;attn_2_2_1 -->
<g id="edge551" class="edge">
<title>v_proj_2_2_1&#45;&gt;attn_2_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6130.91,-3131.65C6120.85,-3120.07 6109.02,-3108.14 6096.5,-3099 6081.81,-3088.28 6064.5,-3079.16 6047.81,-3071.73"/>
<polygon fill="red" stroke="red" points="6049.19,-3068.51 6038.62,-3067.78 6046.42,-3074.94 6049.19,-3068.51"/>
<text text-anchor="middle" x="6151.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_2_2_2 -->
<g id="node264" class="node">
<title>attn_2_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="6600.5,-3081 6484.5,-3081 6484.5,-3013 6600.5,-3013 6600.5,-3081"/>
<text text-anchor="middle" x="6542.5" y="-3065.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6542.5" y="-3050.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6542.5" y="-3035.8" font-family="monospace" font-size="14.00">Heads[8&#45;11]</text>
<text text-anchor="middle" x="6542.5" y="-3020.8" font-family="monospace" font-size="14.00">Dim[256&#45;383]</text>
</g>
<!-- q_proj_2_2_2&#45;&gt;attn_2_2_2 -->
<g id="edge555" class="edge">
<title>q_proj_2_2_2&#45;&gt;attn_2_2_2</title>
<path fill="none" stroke="black" d="M6370.84,-3131.69C6377.78,-3119.84 6386.68,-3107.75 6397.5,-3099 6419.58,-3081.15 6448.36,-3069.33 6474.45,-3061.61"/>
<polygon fill="black" stroke="black" points="6475.61,-3064.91 6484.3,-3058.84 6473.72,-3058.17 6475.61,-3064.91"/>
</g>
<!-- q_proj_2_2_2&#45;&gt;attn_2_2_2 -->
<g id="edge556" class="edge">
<title>q_proj_2_2_2&#45;&gt;attn_2_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6413.48,-3131.94C6429.71,-3121.19 6447.25,-3109.62 6463.5,-3099 6469.61,-3095.01 6475.99,-3090.86 6482.36,-3086.72"/>
<polygon fill="red" stroke="red" points="6484.53,-3089.48 6491.02,-3081.11 6480.73,-3083.61 6484.53,-3089.48"/>
<text text-anchor="middle" x="6501.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_2_2_2&#45;&gt;attn_2_2_2 -->
<g id="edge557" class="edge">
<title>k_proj_2_2_2&#45;&gt;attn_2_2_2</title>
<path fill="none" stroke="black" d="M6543.17,-3131.73C6543.07,-3118.86 6542.95,-3104.6 6542.85,-3091.54"/>
<polygon fill="black" stroke="black" points="6546.35,-3091.35 6542.77,-3081.38 6539.35,-3091.41 6546.35,-3091.35"/>
</g>
<!-- k_proj_2_2_2&#45;&gt;attn_2_2_2 -->
<g id="edge558" class="edge">
<title>k_proj_2_2_2&#45;&gt;attn_2_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6556.14,-3131.79C6558.11,-3121.15 6559.04,-3109.67 6557.5,-3099 6557.12,-3096.35 6556.63,-3093.65 6556.07,-3090.94"/>
<polygon fill="red" stroke="red" points="6559.46,-3090.08 6553.74,-3081.17 6552.65,-3091.7 6559.46,-3090.08"/>
<text text-anchor="middle" x="6596.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_2_2_2&#45;&gt;attn_2_2_2 -->
<g id="edge559" class="edge">
<title>v_proj_2_2_2&#45;&gt;attn_2_2_2</title>
<path fill="none" stroke="black" d="M6684.81,-3131.98C6670.24,-3120.79 6654.04,-3108.98 6638.5,-3099 6629.38,-3093.14 6619.52,-3087.35 6609.72,-3081.88"/>
<polygon fill="black" stroke="black" points="6611.2,-3078.7 6600.75,-3076.96 6607.83,-3084.84 6611.2,-3078.7"/>
</g>
<!-- v_proj_2_2_2&#45;&gt;attn_2_2_2 -->
<g id="edge560" class="edge">
<title>v_proj_2_2_2&#45;&gt;attn_2_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6700.63,-3131.63C6689.64,-3120.05 6676.82,-3108.13 6663.5,-3099 6647.25,-3087.86 6628.17,-3078.43 6610.04,-3070.82"/>
<polygon fill="red" stroke="red" points="6611.25,-3067.54 6600.66,-3067.01 6608.61,-3074.02 6611.25,-3067.54"/>
<text text-anchor="middle" x="6719.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_2_2_3 -->
<g id="node266" class="node">
<title>attn_2_2_3</title>
<polygon fill="#aaffff" stroke="black" points="7066.5,-3081 6950.5,-3081 6950.5,-3013 7066.5,-3013 7066.5,-3081"/>
<text text-anchor="middle" x="7008.5" y="-3065.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7008.5" y="-3050.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7008.5" y="-3035.8" font-family="monospace" font-size="14.00">Heads[8&#45;11]</text>
<text text-anchor="middle" x="7008.5" y="-3020.8" font-family="monospace" font-size="14.00">Dim[384&#45;511]</text>
</g>
<!-- q_proj_2_2_3&#45;&gt;attn_2_2_3 -->
<g id="edge564" class="edge">
<title>q_proj_2_2_3&#45;&gt;attn_2_2_3</title>
<path fill="none" stroke="black" d="M6932.49,-3131.7C6935.61,-3120.5 6940.1,-3108.77 6946.5,-3099 6948.86,-3095.39 6951.56,-3091.91 6954.48,-3088.58"/>
<polygon fill="black" stroke="black" points="6957.26,-3090.74 6961.63,-3081.09 6952.19,-3085.91 6957.26,-3090.74"/>
</g>
<!-- q_proj_2_2_3&#45;&gt;attn_2_2_3 -->
<g id="edge565" class="edge">
<title>q_proj_2_2_3&#45;&gt;attn_2_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6952.68,-3131.73C6961.6,-3118.35 6971.52,-3103.46 6980.5,-3090"/>
<polygon fill="red" stroke="red" points="6983.61,-3091.64 6986.25,-3081.38 6977.79,-3087.76 6983.61,-3091.64"/>
<text text-anchor="middle" x="7012.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_2_2_3&#45;&gt;attn_2_2_3 -->
<g id="edge566" class="edge">
<title>k_proj_2_2_3&#45;&gt;attn_2_2_3</title>
<path fill="none" stroke="black" d="M7082.63,-3131.86C7073.56,-3121.11 7063.72,-3109.57 7054.5,-3099 7051.55,-3095.62 7048.48,-3092.14 7045.38,-3088.65"/>
<polygon fill="black" stroke="black" points="7047.87,-3086.18 7038.6,-3081.05 7042.65,-3090.84 7047.87,-3086.18"/>
</g>
<!-- k_proj_2_2_3&#45;&gt;attn_2_2_3 -->
<g id="edge567" class="edge">
<title>k_proj_2_2_3&#45;&gt;attn_2_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7097.59,-3131.63C7091.4,-3120.43 7083.93,-3108.71 7075.5,-3099 7072.17,-3095.16 7068.52,-3091.43 7064.68,-3087.84"/>
<polygon fill="red" stroke="red" points="7066.92,-3085.15 7057.12,-3081.13 7062.27,-3090.39 7066.92,-3085.15"/>
<text text-anchor="middle" x="7125.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_2_2_3&#45;&gt;attn_2_2_3 -->
<g id="edge568" class="edge">
<title>v_proj_2_2_3&#45;&gt;attn_2_2_3</title>
<path fill="none" stroke="black" d="M7235.99,-3131.91C7214.35,-3120.47 7190.29,-3108.55 7167.5,-3099 7138.32,-3086.77 7105.13,-3075.7 7076.64,-3067.02"/>
<polygon fill="black" stroke="black" points="7077.36,-3063.58 7066.78,-3064.05 7075.34,-3070.29 7077.36,-3063.58"/>
</g>
<!-- v_proj_2_2_3&#45;&gt;attn_2_2_3 -->
<g id="edge569" class="edge">
<title>v_proj_2_2_3&#45;&gt;attn_2_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7254.44,-3131.99C7237,-3120.08 7217.05,-3107.88 7197.5,-3099 7159.17,-3081.59 7113.69,-3069.09 7076.95,-3060.82"/>
<polygon fill="red" stroke="red" points="7077.35,-3057.33 7066.83,-3058.6 7075.85,-3064.17 7077.35,-3057.33"/>
<text text-anchor="middle" x="7261.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_2_3_0 -->
<g id="node268" class="node">
<title>attn_2_3_0</title>
<polygon fill="#ff8888" stroke="black" points="7774.5,-3081 7658.5,-3081 7658.5,-3013 7774.5,-3013 7774.5,-3081"/>
<text text-anchor="middle" x="7716.5" y="-3065.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7716.5" y="-3050.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7716.5" y="-3035.8" font-family="monospace" font-size="14.00">Heads[12&#45;15]</text>
<text text-anchor="middle" x="7716.5" y="-3020.8" font-family="monospace" font-size="14.00">Dim[0&#45;127]</text>
</g>
<!-- q_proj_2_3_0&#45;&gt;attn_2_3_0 -->
<g id="edge573" class="edge">
<title>q_proj_2_3_0&#45;&gt;attn_2_3_0</title>
<path fill="none" stroke="black" d="M7517.48,-3131.75C7524.77,-3119.76 7534.13,-3107.57 7545.5,-3099 7575.21,-3076.61 7614.67,-3064 7648.2,-3056.93"/>
<polygon fill="black" stroke="black" points="7649.27,-3060.28 7658.39,-3054.91 7647.9,-3053.42 7649.27,-3060.28"/>
</g>
<!-- q_proj_2_3_0&#45;&gt;attn_2_3_0 -->
<g id="edge574" class="edge">
<title>q_proj_2_3_0&#45;&gt;attn_2_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7565.8,-3131.98C7584.11,-3121.13 7604,-3109.5 7622.5,-3099 7631.16,-3094.09 7640.32,-3088.99 7649.38,-3084.01"/>
<polygon fill="red" stroke="red" points="7651.3,-3086.95 7658.39,-3079.08 7647.94,-3080.81 7651.3,-3086.95"/>
<text text-anchor="middle" x="7660.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_2_3_0&#45;&gt;attn_2_3_0 -->
<g id="edge575" class="edge">
<title>k_proj_2_3_0&#45;&gt;attn_2_3_0</title>
<path fill="none" stroke="black" d="M7698.34,-3131.73C7701.16,-3118.74 7704.29,-3104.31 7707.14,-3091.15"/>
<polygon fill="black" stroke="black" points="7710.56,-3091.89 7709.26,-3081.38 7703.72,-3090.41 7710.56,-3091.89"/>
</g>
<!-- k_proj_2_3_0&#45;&gt;attn_2_3_0 -->
<g id="edge576" class="edge">
<title>k_proj_2_3_0&#45;&gt;attn_2_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7712.57,-3131.84C7715.01,-3126.01 7717.1,-3119.96 7718.5,-3114 7720.19,-3106.79 7720.9,-3099.01 7721.01,-3091.41"/>
<polygon fill="red" stroke="red" points="7724.51,-3091.17 7720.84,-3081.23 7717.51,-3091.29 7724.51,-3091.17"/>
<text text-anchor="middle" x="7759.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_2_3_0&#45;&gt;attn_2_3_0 -->
<g id="edge577" class="edge">
<title>v_proj_2_3_0&#45;&gt;attn_2_3_0</title>
<path fill="none" stroke="black" d="M7840.11,-3131.89C7828.13,-3120.69 7814.67,-3108.91 7801.5,-3099 7795.73,-3094.66 7789.57,-3090.38 7783.31,-3086.24"/>
<polygon fill="black" stroke="black" points="7785.02,-3083.18 7774.72,-3080.71 7781.23,-3089.07 7785.02,-3083.18"/>
</g>
<!-- v_proj_2_3_0&#45;&gt;attn_2_3_0 -->
<g id="edge578" class="edge">
<title>v_proj_2_3_0&#45;&gt;attn_2_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7855.43,-3131.67C7846.95,-3120.09 7836.75,-3108.15 7825.5,-3099 7813.2,-3088.99 7798.62,-3080.44 7784.19,-3073.36"/>
<polygon fill="red" stroke="red" points="7785.29,-3070 7774.75,-3068.91 7782.3,-3076.34 7785.29,-3070"/>
<text text-anchor="middle" x="7878.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_2_3_1 -->
<g id="node271" class="node">
<title>attn_2_3_1</title>
<polygon fill="#88ff88" stroke="black" points="8320.5,-3081 8204.5,-3081 8204.5,-3013 8320.5,-3013 8320.5,-3081"/>
<text text-anchor="middle" x="8262.5" y="-3065.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="8262.5" y="-3050.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8262.5" y="-3035.8" font-family="monospace" font-size="14.00">Heads[12&#45;15]</text>
<text text-anchor="middle" x="8262.5" y="-3020.8" font-family="monospace" font-size="14.00">Dim[128&#45;255]</text>
</g>
<!-- q_proj_2_3_1&#45;&gt;attn_2_3_1 -->
<g id="edge582" class="edge">
<title>q_proj_2_3_1&#45;&gt;attn_2_3_1</title>
<path fill="none" stroke="black" d="M8089.83,-3131.68C8096.77,-3119.82 8105.67,-3107.74 8116.5,-3099 8138.83,-3080.99 8167.95,-3069.13 8194.31,-3061.42"/>
<polygon fill="black" stroke="black" points="8195.55,-3064.71 8204.26,-3058.67 8193.68,-3057.96 8195.55,-3064.71"/>
</g>
<!-- q_proj_2_3_1&#45;&gt;attn_2_3_1 -->
<g id="edge583" class="edge">
<title>q_proj_2_3_1&#45;&gt;attn_2_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8132.44,-3131.87C8148.67,-3121.13 8166.22,-3109.58 8182.5,-3099 8188.67,-3094.99 8195.13,-3090.83 8201.58,-3086.68"/>
<polygon fill="red" stroke="red" points="8203.81,-3089.41 8210.35,-3081.06 8200.04,-3083.51 8203.81,-3089.41"/>
<text text-anchor="middle" x="8220.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_2_3_1&#45;&gt;attn_2_3_1 -->
<g id="edge584" class="edge">
<title>k_proj_2_3_1&#45;&gt;attn_2_3_1</title>
<path fill="none" stroke="black" d="M8262.5,-3131.73C8262.5,-3118.86 8262.5,-3104.6 8262.5,-3091.54"/>
<polygon fill="black" stroke="black" points="8266,-3091.38 8262.5,-3081.38 8259,-3091.38 8266,-3091.38"/>
</g>
<!-- k_proj_2_3_1&#45;&gt;attn_2_3_1 -->
<g id="edge585" class="edge">
<title>k_proj_2_3_1&#45;&gt;attn_2_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8275.01,-3131.81C8276.97,-3121.17 8277.94,-3109.68 8276.5,-3099 8276.16,-3096.45 8275.72,-3093.85 8275.22,-3091.24"/>
<polygon fill="red" stroke="red" points="8278.57,-3090.21 8272.99,-3081.2 8271.74,-3091.72 8278.57,-3090.21"/>
<text text-anchor="middle" x="8315.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_2_3_1&#45;&gt;attn_2_3_1 -->
<g id="edge586" class="edge">
<title>v_proj_2_3_1&#45;&gt;attn_2_3_1</title>
<path fill="none" stroke="black" d="M8403.29,-3131.64C8388.85,-3120.56 8372.84,-3108.9 8357.5,-3099 8348.59,-3093.25 8338.97,-3087.55 8329.39,-3082.15"/>
<polygon fill="black" stroke="black" points="8331.07,-3079.08 8320.63,-3077.29 8327.67,-3085.2 8331.07,-3079.08"/>
</g>
<!-- v_proj_2_3_1&#45;&gt;attn_2_3_1 -->
<g id="edge587" class="edge">
<title>v_proj_2_3_1&#45;&gt;attn_2_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8419.62,-3131.66C8408.62,-3120.08 8395.8,-3108.15 8382.5,-3099 8366.68,-3088.13 8348.18,-3078.86 8330.5,-3071.33"/>
<polygon fill="red" stroke="red" points="8331.37,-3067.9 8320.79,-3067.33 8328.7,-3074.37 8331.37,-3067.9"/>
<text text-anchor="middle" x="8438.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_2_3_2 -->
<g id="node273" class="node">
<title>attn_2_3_2</title>
<polygon fill="#8888ff" stroke="black" points="8872.5,-3081 8756.5,-3081 8756.5,-3013 8872.5,-3013 8872.5,-3081"/>
<text text-anchor="middle" x="8814.5" y="-3065.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8814.5" y="-3050.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8814.5" y="-3035.8" font-family="monospace" font-size="14.00">Heads[12&#45;15]</text>
<text text-anchor="middle" x="8814.5" y="-3020.8" font-family="monospace" font-size="14.00">Dim[256&#45;383]</text>
</g>
<!-- q_proj_2_3_2&#45;&gt;attn_2_3_2 -->
<g id="edge591" class="edge">
<title>q_proj_2_3_2&#45;&gt;attn_2_3_2</title>
<path fill="none" stroke="black" d="M8659,-3131.9C8664.82,-3120.06 8672.56,-3107.92 8682.5,-3099 8700.5,-3082.85 8724.18,-3071.58 8746.5,-3063.83"/>
<polygon fill="black" stroke="black" points="8747.89,-3067.05 8756.3,-3060.61 8745.7,-3060.4 8747.89,-3067.05"/>
</g>
<!-- q_proj_2_3_2&#45;&gt;attn_2_3_2 -->
<g id="edge592" class="edge">
<title>q_proj_2_3_2&#45;&gt;attn_2_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8697.96,-3131.99C8712.37,-3121.19 8727.98,-3109.59 8742.5,-3099 8747.91,-3095.06 8753.56,-3090.98 8759.23,-3086.92"/>
<polygon fill="red" stroke="red" points="8761.4,-3089.67 8767.5,-3081.01 8757.33,-3083.97 8761.4,-3089.67"/>
<text text-anchor="middle" x="8780.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_2_3_2&#45;&gt;attn_2_3_2 -->
<g id="edge593" class="edge">
<title>k_proj_2_3_2&#45;&gt;attn_2_3_2</title>
<path fill="none" stroke="black" d="M8828.62,-3131.73C8826.45,-3118.86 8824.05,-3104.6 8821.84,-3091.54"/>
<polygon fill="black" stroke="black" points="8825.24,-3090.66 8820.13,-3081.38 8818.34,-3091.82 8825.24,-3090.66"/>
</g>
<!-- k_proj_2_3_2&#45;&gt;attn_2_3_2 -->
<g id="edge594" class="edge">
<title>k_proj_2_3_2&#45;&gt;attn_2_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8840.05,-3131.74C8840.31,-3121 8839.75,-3109.48 8837.5,-3099 8836.9,-3096.2 8836.13,-3093.36 8835.24,-3090.54"/>
<polygon fill="red" stroke="red" points="8838.5,-3089.27 8831.81,-3081.05 8831.92,-3091.65 8838.5,-3089.27"/>
<text text-anchor="middle" x="8877.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_2_3_2&#45;&gt;attn_2_3_2 -->
<g id="edge595" class="edge">
<title>v_proj_2_3_2&#45;&gt;attn_2_3_2</title>
<path fill="none" stroke="black" d="M8970.88,-3131.97C8954.64,-3120.78 8936.64,-3108.97 8919.5,-3099 8907.52,-3092.03 8894.45,-3085.14 8881.72,-3078.79"/>
<polygon fill="black" stroke="black" points="8883.05,-3075.55 8872.53,-3074.27 8879.96,-3081.83 8883.05,-3075.55"/>
</g>
<!-- v_proj_2_3_2&#45;&gt;attn_2_3_2 -->
<g id="edge596" class="edge">
<title>v_proj_2_3_2&#45;&gt;attn_2_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8987.66,-3131.97C8975,-3120.27 8960.36,-3108.19 8945.5,-3099 8926.06,-3086.97 8903.31,-3076.92 8882.28,-3069.01"/>
<polygon fill="red" stroke="red" points="8883.35,-3065.67 8872.75,-3065.52 8880.94,-3072.24 8883.35,-3065.67"/>
<text text-anchor="middle" x="9002.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_2_3_3 -->
<g id="node275" class="node">
<title>attn_2_3_3</title>
<polygon fill="#ffff88" stroke="black" points="9416.5,-3081 9300.5,-3081 9300.5,-3013 9416.5,-3013 9416.5,-3081"/>
<text text-anchor="middle" x="9358.5" y="-3065.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9358.5" y="-3050.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="9358.5" y="-3035.8" font-family="monospace" font-size="14.00">Heads[12&#45;15]</text>
<text text-anchor="middle" x="9358.5" y="-3020.8" font-family="monospace" font-size="14.00">Dim[384&#45;511]</text>
</g>
<!-- q_proj_2_3_3&#45;&gt;attn_2_3_3 -->
<g id="edge600" class="edge">
<title>q_proj_2_3_3&#45;&gt;attn_2_3_3</title>
<path fill="none" stroke="black" d="M9242.21,-3131.85C9250.34,-3120.41 9260,-3108.5 9270.5,-3099 9276.9,-3093.21 9284.06,-3087.77 9291.46,-3082.76"/>
<polygon fill="black" stroke="black" points="9293.74,-3085.45 9300.23,-3077.08 9289.94,-3079.58 9293.74,-3085.45"/>
</g>
<!-- q_proj_2_3_3&#45;&gt;attn_2_3_3 -->
<g id="edge601" class="edge">
<title>q_proj_2_3_3&#45;&gt;attn_2_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9261.83,-3131.8C9273.67,-3121.06 9286.52,-3109.53 9298.5,-3099 9302.67,-3095.33 9307.03,-3091.55 9311.41,-3087.77"/>
<polygon fill="red" stroke="red" points="9313.98,-3090.18 9319.29,-3081.01 9309.42,-3084.87 9313.98,-3090.18"/>
<text text-anchor="middle" x="9336.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_2_3_3&#45;&gt;attn_2_3_3 -->
<g id="edge602" class="edge">
<title>k_proj_2_3_3&#45;&gt;attn_2_3_3</title>
<path fill="none" stroke="black" d="M9392.13,-3131.73C9386.86,-3118.61 9381,-3104.03 9375.68,-3090.77"/>
<polygon fill="black" stroke="black" points="9378.88,-3089.35 9371.91,-3081.38 9372.38,-3091.96 9378.88,-3089.35"/>
</g>
<!-- k_proj_2_3_3&#45;&gt;attn_2_3_3 -->
<g id="edge603" class="edge">
<title>k_proj_2_3_3&#45;&gt;attn_2_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9404.68,-3131.88C9402.75,-3120.92 9399.85,-3109.26 9395.5,-3099 9394.16,-3095.83 9392.58,-3092.67 9390.86,-3089.57"/>
<polygon fill="red" stroke="red" points="9393.84,-3087.74 9385.66,-3081 9387.86,-3091.37 9393.84,-3087.74"/>
<text text-anchor="middle" x="9437.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_2_3_3&#45;&gt;attn_2_3_3 -->
<g id="edge604" class="edge">
<title>v_proj_2_3_3&#45;&gt;attn_2_3_3</title>
<path fill="none" stroke="black" d="M9537.31,-3131.96C9519.01,-3120.7 9498.74,-3108.87 9479.5,-3099 9462.56,-3090.3 9443.79,-3081.85 9426.19,-3074.41"/>
<polygon fill="black" stroke="black" points="9427.13,-3071.01 9416.55,-3070.39 9424.43,-3077.47 9427.13,-3071.01"/>
</g>
<!-- v_proj_2_3_3&#45;&gt;attn_2_3_3 -->
<g id="edge605" class="edge">
<title>v_proj_2_3_3&#45;&gt;attn_2_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9554.35,-3131.84C9539.8,-3120.13 9523.11,-3108.08 9506.5,-3099 9481.55,-3085.36 9452.27,-3074.35 9426.37,-3066.1"/>
<polygon fill="red" stroke="red" points="9427.21,-3062.69 9416.62,-3063.07 9425.14,-3069.38 9427.21,-3062.69"/>
<text text-anchor="middle" x="9566.5" y="-3102.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_2_0_0 -->
<g id="node242" class="node">
<title>out_proj_2_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="1378,-2976 1205,-2976 1205,-2893 1378,-2893 1378,-2976"/>
<text text-anchor="middle" x="1291.5" y="-2960.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1291.5" y="-2945.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="1291.5" y="-2930.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1291.5" y="-2915.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1291.5" y="-2900.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_2_0_0&#45;&gt;out_proj_2_0_0 -->
<g id="edge471" class="edge">
<title>attn_2_0_0&#45;&gt;out_proj_2_0_0</title>
<path fill="none" stroke="black" d="M896.25,-3033.65C968.25,-3015.77 1102.9,-2982.33 1194.84,-2959.5"/>
<polygon fill="black" stroke="black" points="1195.85,-2962.86 1204.71,-2957.05 1194.16,-2956.06 1195.85,-2962.86"/>
</g>
<!-- concat_dim_2_0 -->
<g id="node243" class="node">
<title>concat_dim_2_0</title>
<polygon fill="lightyellow" stroke="black" points="1959.5,-2842 1786.5,-2789 1959.5,-2736 2132.5,-2789 1959.5,-2842"/>
<text text-anchor="middle" x="1959.5" y="-2800.3" font-family="monospace" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="1959.5" y="-2785.3" font-family="monospace" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="1959.5" y="-2770.3" font-family="monospace" font-size="14.00">[1024×2048×(4×512)]</text>
</g>
<!-- out_proj_2_0_0&#45;&gt;concat_dim_2_0 -->
<g id="edge472" class="edge">
<title>out_proj_2_0_0&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" d="M1378.18,-2912.55C1441.58,-2897.41 1529.73,-2876.77 1607.5,-2860 1686.45,-2842.97 1775.7,-2825.24 1844.57,-2811.89"/>
<polygon fill="black" stroke="black" points="1845.43,-2815.28 1854.58,-2809.95 1844.1,-2808.41 1845.43,-2815.28"/>
</g>
<!-- out_proj_2_0_0&#45;&gt;concat_dim_2_0 -->
<g id="edge473" class="edge">
<title>out_proj_2_0_0&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1378.31,-2917.39C1438.3,-2906.06 1519.88,-2890.25 1591.5,-2875 1680.5,-2856.05 1781.14,-2832.67 1854.66,-2815.23"/>
<polygon fill="red" stroke="red" points="1855.47,-2818.63 1864.39,-2812.92 1853.85,-2811.82 1855.47,-2818.63"/>
<text text-anchor="middle" x="1690.5" y="-2863.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_heads_2 -->
<g id="node277" class="node">
<title>concat_heads_2</title>
<polygon fill="lightyellow" stroke="black" points="6333.5,-2699 6168.5,-2646 6333.5,-2593 6498.5,-2646 6333.5,-2699"/>
<text text-anchor="middle" x="6333.5" y="-2657.3" font-family="monospace" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="6333.5" y="-2642.3" font-family="monospace" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="6333.5" y="-2627.3" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- concat_dim_2_0&#45;&gt;concat_heads_2 -->
<g id="edge609" class="edge">
<title>concat_dim_2_0&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M2113.25,-2783.04C2789.1,-2761.26 5492.83,-2674.1 6176.05,-2652.08"/>
<polygon fill="black" stroke="black" points="6176.32,-2655.57 6186.2,-2651.75 6176.09,-2648.57 6176.32,-2655.57"/>
</g>
<!-- out_proj_2_0_1 -->
<g id="node245" class="node">
<title>out_proj_2_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="1760,-2976 1587,-2976 1587,-2893 1760,-2893 1760,-2976"/>
<text text-anchor="middle" x="1673.5" y="-2960.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1673.5" y="-2945.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="1673.5" y="-2930.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1673.5" y="-2915.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1673.5" y="-2900.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_2_0_1&#45;&gt;out_proj_2_0_1 -->
<g id="edge480" class="edge">
<title>attn_2_0_1&#45;&gt;out_proj_2_0_1</title>
<path fill="none" stroke="black" d="M1490.53,-3019.39C1516.55,-3007.46 1547.93,-2993.07 1577.31,-2979.61"/>
<polygon fill="black" stroke="black" points="1579.13,-2982.62 1586.76,-2975.27 1576.22,-2976.26 1579.13,-2982.62"/>
</g>
<!-- out_proj_2_0_1&#45;&gt;concat_dim_2_0 -->
<g id="edge481" class="edge">
<title>out_proj_2_0_1&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" d="M1728.08,-2892.9C1744.75,-2881.45 1763.45,-2869.54 1781.5,-2860 1809.2,-2845.36 1840.65,-2832.01 1869.33,-2820.98"/>
<polygon fill="black" stroke="black" points="1870.84,-2824.15 1878.95,-2817.33 1868.35,-2817.61 1870.84,-2824.15"/>
</g>
<!-- out_proj_2_0_1&#45;&gt;concat_dim_2_0 -->
<g id="edge482" class="edge">
<title>out_proj_2_0_1&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1754.31,-2892.95C1795.62,-2872.23 1845.53,-2847.19 1885.78,-2826.99"/>
<polygon fill="red" stroke="red" points="1887.37,-2830.11 1894.74,-2822.49 1884.23,-2823.85 1887.37,-2830.11"/>
<text text-anchor="middle" x="1854.5" y="-2863.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_2_0_2 -->
<g id="node247" class="node">
<title>out_proj_2_0_2</title>
<polygon fill="#ccccff" stroke="black" points="2046,-2976 1873,-2976 1873,-2893 2046,-2893 2046,-2976"/>
<text text-anchor="middle" x="1959.5" y="-2960.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1959.5" y="-2945.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="1959.5" y="-2930.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1959.5" y="-2915.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1959.5" y="-2900.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_2_0_2&#45;&gt;out_proj_2_0_2 -->
<g id="edge489" class="edge">
<title>attn_2_0_2&#45;&gt;out_proj_2_0_2</title>
<path fill="none" stroke="black" d="M1959.5,-3012.85C1959.5,-3004.44 1959.5,-2995.22 1959.5,-2986.16"/>
<polygon fill="black" stroke="black" points="1963,-2986.06 1959.5,-2976.06 1956,-2986.06 1963,-2986.06"/>
</g>
<!-- out_proj_2_0_2&#45;&gt;concat_dim_2_0 -->
<g id="edge490" class="edge">
<title>out_proj_2_0_2&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" d="M1959.5,-2892.76C1959.5,-2880.22 1959.5,-2866.1 1959.5,-2852.45"/>
<polygon fill="black" stroke="black" points="1963,-2852.13 1959.5,-2842.13 1956,-2852.13 1963,-2852.13"/>
</g>
<!-- out_proj_2_0_2&#45;&gt;concat_dim_2_0 -->
<g id="edge491" class="edge">
<title>out_proj_2_0_2&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1970.53,-2892.81C1971.76,-2886.87 1972.81,-2880.81 1973.5,-2875 1974.52,-2866.37 1974.35,-2857.27 1973.49,-2848.37"/>
<polygon fill="red" stroke="red" points="1976.96,-2847.92 1972.24,-2838.44 1970.01,-2848.8 1976.96,-2847.92"/>
<text text-anchor="middle" x="2012.5" y="-2863.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_2_0_3 -->
<g id="node249" class="node">
<title>out_proj_2_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="2332,-2976 2159,-2976 2159,-2893 2332,-2893 2332,-2976"/>
<text text-anchor="middle" x="2245.5" y="-2960.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2245.5" y="-2945.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="2245.5" y="-2930.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2245.5" y="-2915.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2245.5" y="-2900.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_2_0_3&#45;&gt;out_proj_2_0_3 -->
<g id="edge498" class="edge">
<title>attn_2_0_3&#45;&gt;out_proj_2_0_3</title>
<path fill="none" stroke="black" d="M2331.6,-3012.85C2321.13,-3003.45 2309.53,-2993.02 2298.32,-2982.95"/>
<polygon fill="black" stroke="black" points="2300.42,-2980.13 2290.64,-2976.06 2295.74,-2985.34 2300.42,-2980.13"/>
</g>
<!-- out_proj_2_0_3&#45;&gt;concat_dim_2_0 -->
<g id="edge499" class="edge">
<title>out_proj_2_0_3&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" d="M2164.69,-2892.95C2123.38,-2872.23 2073.47,-2847.19 2033.22,-2826.99"/>
<polygon fill="black" stroke="black" points="2034.77,-2823.85 2024.26,-2822.49 2031.63,-2830.11 2034.77,-2823.85"/>
</g>
<!-- out_proj_2_0_3&#45;&gt;concat_dim_2_0 -->
<g id="edge500" class="edge">
<title>out_proj_2_0_3&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2185.87,-2892.93C2168.11,-2881.61 2148.34,-2869.75 2129.5,-2860 2103,-2846.28 2073.19,-2833.25 2046.02,-2822.23"/>
<polygon fill="red" stroke="red" points="2047.11,-2818.9 2036.52,-2818.42 2044.5,-2825.39 2047.11,-2818.9"/>
<text text-anchor="middle" x="2194.5" y="-2863.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_2_1_0 -->
<g id="node251" class="node">
<title>out_proj_2_1_0</title>
<polygon fill="#ffccff" stroke="black" points="3383,-2976 3210,-2976 3210,-2893 3383,-2893 3383,-2976"/>
<text text-anchor="middle" x="3296.5" y="-2960.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="3296.5" y="-2945.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="3296.5" y="-2930.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3296.5" y="-2915.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3296.5" y="-2900.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_2_1_0&#45;&gt;out_proj_2_1_0 -->
<g id="edge507" class="edge">
<title>attn_2_1_0&#45;&gt;out_proj_2_1_0</title>
<path fill="none" stroke="black" d="M3197.8,-3012.85C3210.03,-3003.26 3223.61,-2992.62 3236.69,-2982.37"/>
<polygon fill="black" stroke="black" points="3239.04,-2984.98 3244.75,-2976.06 3234.72,-2979.47 3239.04,-2984.98"/>
</g>
<!-- concat_dim_2_1 -->
<g id="node252" class="node">
<title>concat_dim_2_1</title>
<polygon fill="lightyellow" stroke="black" points="4251.5,-2842 4078.5,-2789 4251.5,-2736 4424.5,-2789 4251.5,-2842"/>
<text text-anchor="middle" x="4251.5" y="-2800.3" font-family="monospace" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="4251.5" y="-2785.3" font-family="monospace" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="4251.5" y="-2770.3" font-family="monospace" font-size="14.00">[1024×2048×(4×512)]</text>
</g>
<!-- out_proj_2_1_0&#45;&gt;concat_dim_2_1 -->
<g id="edge508" class="edge">
<title>out_proj_2_1_0&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" d="M3383.36,-2920.45C3553.4,-2894.9 3930.73,-2838.2 4127.18,-2808.68"/>
<polygon fill="black" stroke="black" points="4127.89,-2812.11 4137.26,-2807.17 4126.85,-2805.19 4127.89,-2812.11"/>
</g>
<!-- out_proj_2_1_0&#45;&gt;concat_dim_2_1 -->
<g id="edge509" class="edge">
<title>out_proj_2_1_0&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3383.13,-2923.17C3473.65,-2912.16 3619.74,-2893.75 3745.5,-2875 3878.94,-2855.11 4031.6,-2829 4134.03,-2811"/>
<polygon fill="red" stroke="red" points="4134.85,-2814.4 4144.09,-2809.22 4133.63,-2807.51 4134.85,-2814.4"/>
<text text-anchor="middle" x="3881.5" y="-2863.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_dim_2_1&#45;&gt;concat_heads_2 -->
<g id="edge610" class="edge">
<title>concat_dim_2_1&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M4390.53,-2778.58C4767.56,-2753.05 5806.74,-2682.67 6189.51,-2656.75"/>
<polygon fill="black" stroke="black" points="6189.8,-2660.24 6199.54,-2656.07 6189.32,-2653.26 6189.8,-2660.24"/>
</g>
<!-- out_proj_2_1_1 -->
<g id="node254" class="node">
<title>out_proj_2_1_1</title>
<polygon fill="#ccffff" stroke="black" points="3956,-2976 3783,-2976 3783,-2893 3956,-2893 3956,-2976"/>
<text text-anchor="middle" x="3869.5" y="-2960.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3869.5" y="-2945.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="3869.5" y="-2930.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3869.5" y="-2915.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3869.5" y="-2900.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_2_1_1&#45;&gt;out_proj_2_1_1 -->
<g id="edge516" class="edge">
<title>attn_2_1_1&#45;&gt;out_proj_2_1_1</title>
<path fill="none" stroke="black" d="M3754.71,-3012.85C3769.19,-3003.08 3785.32,-2992.22 3800.79,-2981.79"/>
<polygon fill="black" stroke="black" points="3802.97,-2984.55 3809.31,-2976.06 3799.06,-2978.74 3802.97,-2984.55"/>
</g>
<!-- out_proj_2_1_1&#45;&gt;concat_dim_2_1 -->
<g id="edge517" class="edge">
<title>out_proj_2_1_1&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" d="M3956.18,-2900.94C4018.89,-2877.38 4103.24,-2845.69 4165.74,-2822.22"/>
<polygon fill="black" stroke="black" points="4167.05,-2825.46 4175.18,-2818.67 4164.59,-2818.91 4167.05,-2825.46"/>
</g>
<!-- out_proj_2_1_1&#45;&gt;concat_dim_2_1 -->
<g id="edge518" class="edge">
<title>out_proj_2_1_1&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.29,-2908.7C3988.36,-2898.96 4024.84,-2887.19 4057.5,-2875 4096.87,-2860.3 4139.75,-2841.79 4175.17,-2825.79"/>
<polygon fill="red" stroke="red" points="4176.81,-2828.89 4184.47,-2821.57 4173.92,-2822.51 4176.81,-2828.89"/>
<text text-anchor="middle" x="4133.5" y="-2863.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_2_1_2 -->
<g id="node256" class="node">
<title>out_proj_2_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="4338,-2976 4165,-2976 4165,-2893 4338,-2893 4338,-2976"/>
<text text-anchor="middle" x="4251.5" y="-2960.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="4251.5" y="-2945.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="4251.5" y="-2930.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4251.5" y="-2915.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4251.5" y="-2900.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_2_1_2&#45;&gt;out_proj_2_1_2 -->
<g id="edge525" class="edge">
<title>attn_2_1_2&#45;&gt;out_proj_2_1_2</title>
<path fill="none" stroke="black" d="M4251.5,-3012.85C4251.5,-3004.44 4251.5,-2995.22 4251.5,-2986.16"/>
<polygon fill="black" stroke="black" points="4255,-2986.06 4251.5,-2976.06 4248,-2986.06 4255,-2986.06"/>
</g>
<!-- out_proj_2_1_2&#45;&gt;concat_dim_2_1 -->
<g id="edge526" class="edge">
<title>out_proj_2_1_2&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" d="M4251.5,-2892.76C4251.5,-2880.22 4251.5,-2866.1 4251.5,-2852.45"/>
<polygon fill="black" stroke="black" points="4255,-2852.13 4251.5,-2842.13 4248,-2852.13 4255,-2852.13"/>
</g>
<!-- out_proj_2_1_2&#45;&gt;concat_dim_2_1 -->
<g id="edge527" class="edge">
<title>out_proj_2_1_2&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4262.53,-2892.81C4263.76,-2886.87 4264.81,-2880.81 4265.5,-2875 4266.52,-2866.37 4266.35,-2857.27 4265.49,-2848.37"/>
<polygon fill="red" stroke="red" points="4268.96,-2847.92 4264.24,-2838.44 4262.01,-2848.8 4268.96,-2847.92"/>
<text text-anchor="middle" x="4304.5" y="-2863.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_2_1_3 -->
<g id="node258" class="node">
<title>out_proj_2_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="4641,-2976 4468,-2976 4468,-2893 4641,-2893 4641,-2976"/>
<text text-anchor="middle" x="4554.5" y="-2960.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="4554.5" y="-2945.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="4554.5" y="-2930.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4554.5" y="-2915.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4554.5" y="-2900.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_2_1_3&#45;&gt;out_proj_2_1_3 -->
<g id="edge534" class="edge">
<title>attn_2_1_3&#45;&gt;out_proj_2_1_3</title>
<path fill="none" stroke="black" d="M4684.24,-3013C4667.59,-3003.05 4649.01,-2991.95 4631.22,-2981.33"/>
<polygon fill="black" stroke="black" points="4632.95,-2978.28 4622.57,-2976.16 4629.36,-2984.29 4632.95,-2978.28"/>
</g>
<!-- out_proj_2_1_3&#45;&gt;concat_dim_2_1 -->
<g id="edge535" class="edge">
<title>out_proj_2_1_3&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" d="M4468.89,-2892.95C4424.54,-2871.95 4370.84,-2846.52 4327.91,-2826.19"/>
<polygon fill="black" stroke="black" points="4329.18,-2822.91 4318.64,-2821.8 4326.18,-2829.24 4329.18,-2822.91"/>
</g>
<!-- out_proj_2_1_3&#45;&gt;concat_dim_2_1 -->
<g id="edge536" class="edge">
<title>out_proj_2_1_3&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4491.15,-2892.89C4472.32,-2881.57 4451.39,-2869.72 4431.5,-2860 4402.55,-2845.85 4369.97,-2832.46 4340.57,-2821.25"/>
<polygon fill="red" stroke="red" points="4341.73,-2817.95 4331.14,-2817.69 4339.26,-2824.5 4341.73,-2817.95"/>
<text text-anchor="middle" x="4497.5" y="-2863.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_2_2_0 -->
<g id="node260" class="node">
<title>out_proj_2_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="5765,-2976 5592,-2976 5592,-2893 5765,-2893 5765,-2976"/>
<text text-anchor="middle" x="5678.5" y="-2960.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5678.5" y="-2945.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="5678.5" y="-2930.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5678.5" y="-2915.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="5678.5" y="-2900.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_2_2_0&#45;&gt;out_proj_2_2_0 -->
<g id="edge543" class="edge">
<title>attn_2_2_0&#45;&gt;out_proj_2_2_0</title>
<path fill="none" stroke="black" d="M5501.08,-3020.37C5525.85,-3008.52 5556.02,-2994.09 5584.41,-2980.51"/>
<polygon fill="black" stroke="black" points="5586.04,-2983.61 5593.55,-2976.14 5583.02,-2977.29 5586.04,-2983.61"/>
</g>
<!-- concat_dim_2_2 -->
<g id="node261" class="node">
<title>concat_dim_2_2</title>
<polygon fill="lightyellow" stroke="black" points="6333.5,-2842 6160.5,-2789 6333.5,-2736 6506.5,-2789 6333.5,-2842"/>
<text text-anchor="middle" x="6333.5" y="-2800.3" font-family="monospace" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="6333.5" y="-2785.3" font-family="monospace" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="6333.5" y="-2770.3" font-family="monospace" font-size="14.00">[1024×2048×(4×512)]</text>
</g>
<!-- out_proj_2_2_0&#45;&gt;concat_dim_2_2 -->
<g id="edge544" class="edge">
<title>out_proj_2_2_0&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" d="M5695.4,-2892.68C5702.56,-2880.23 5712.15,-2867.79 5724.5,-2860 5795.23,-2815.36 6008.67,-2799.15 6162.92,-2793.28"/>
<polygon fill="black" stroke="black" points="6163.13,-2796.78 6172.99,-2792.91 6162.87,-2789.78 6163.13,-2796.78"/>
</g>
<!-- out_proj_2_2_0&#45;&gt;concat_dim_2_2 -->
<g id="edge545" class="edge">
<title>out_proj_2_2_0&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5765.14,-2914.52C5883.49,-2888.59 6095.68,-2842.1 6224.63,-2813.85"/>
<polygon fill="red" stroke="red" points="6225.51,-2817.24 6234.53,-2811.68 6224.02,-2810.4 6225.51,-2817.24"/>
<text text-anchor="middle" x="6044.5" y="-2863.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_dim_2_2&#45;&gt;concat_heads_2 -->
<g id="edge611" class="edge">
<title>concat_dim_2_2&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M6333.5,-2735.9C6333.5,-2727.33 6333.5,-2718.37 6333.5,-2709.57"/>
<polygon fill="black" stroke="black" points="6337,-2709.36 6333.5,-2699.36 6330,-2709.36 6337,-2709.36"/>
</g>
<!-- out_proj_2_2_1 -->
<g id="node263" class="node">
<title>out_proj_2_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="6147,-2976 5974,-2976 5974,-2893 6147,-2893 6147,-2976"/>
<text text-anchor="middle" x="6060.5" y="-2960.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="6060.5" y="-2945.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="6060.5" y="-2930.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6060.5" y="-2915.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6060.5" y="-2900.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_2_2_1&#45;&gt;out_proj_2_2_1 -->
<g id="edge552" class="edge">
<title>attn_2_2_1&#45;&gt;out_proj_2_2_1</title>
<path fill="none" stroke="black" d="M6004.5,-3012.85C6010.98,-3003.9 6018.13,-2994.02 6025.09,-2984.41"/>
<polygon fill="black" stroke="black" points="6028.11,-2986.21 6031.14,-2976.06 6022.44,-2982.1 6028.11,-2986.21"/>
</g>
<!-- out_proj_2_2_1&#45;&gt;concat_dim_2_2 -->
<g id="edge553" class="edge">
<title>out_proj_2_2_1&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" d="M6137.64,-2892.95C6176.61,-2872.47 6223.6,-2847.77 6261.79,-2827.69"/>
<polygon fill="black" stroke="black" points="6263.57,-2830.71 6270.8,-2822.96 6260.32,-2824.51 6263.57,-2830.71"/>
</g>
<!-- out_proj_2_2_1&#45;&gt;concat_dim_2_2 -->
<g id="edge554" class="edge">
<title>out_proj_2_2_1&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6147.18,-2899.66C6164.75,-2892.07 6182.91,-2883.67 6199.5,-2875 6224.18,-2862.1 6250.26,-2846.13 6272.79,-2831.53"/>
<polygon fill="red" stroke="red" points="6274.78,-2834.41 6281.24,-2826.01 6270.95,-2828.55 6274.78,-2834.41"/>
<text text-anchor="middle" x="6264.5" y="-2863.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_2_2_2 -->
<g id="node265" class="node">
<title>out_proj_2_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="6500,-2976 6327,-2976 6327,-2893 6500,-2893 6500,-2976"/>
<text text-anchor="middle" x="6413.5" y="-2960.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6413.5" y="-2945.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="6413.5" y="-2930.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6413.5" y="-2915.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6413.5" y="-2900.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_2_2_2&#45;&gt;out_proj_2_2_2 -->
<g id="edge561" class="edge">
<title>attn_2_2_2&#45;&gt;out_proj_2_2_2</title>
<path fill="none" stroke="black" d="M6503.8,-3012.85C6492.72,-3003.36 6480.42,-2992.82 6468.56,-2982.66"/>
<polygon fill="black" stroke="black" points="6470.72,-2979.9 6460.85,-2976.06 6466.16,-2985.22 6470.72,-2979.9"/>
</g>
<!-- out_proj_2_2_2&#45;&gt;concat_dim_2_2 -->
<g id="edge562" class="edge">
<title>out_proj_2_2_2&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" d="M6390.79,-2892.76C6382.25,-2877.45 6372.42,-2859.81 6363.33,-2843.51"/>
<polygon fill="black" stroke="black" points="6366.3,-2841.64 6358.37,-2834.61 6360.18,-2845.05 6366.3,-2841.64"/>
</g>
<!-- out_proj_2_2_2&#45;&gt;concat_dim_2_2 -->
<g id="edge563" class="edge">
<title>out_proj_2_2_2&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6404.43,-2892.67C6401.16,-2881.71 6396.9,-2870.1 6391.5,-2860 6387.68,-2852.86 6383.06,-2845.77 6378.11,-2838.99"/>
<polygon fill="red" stroke="red" points="6380.56,-2836.43 6371.71,-2830.6 6374.99,-2840.67 6380.56,-2836.43"/>
<text text-anchor="middle" x="6436.5" y="-2863.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_2_2_3 -->
<g id="node267" class="node">
<title>out_proj_2_2_3</title>
<polygon fill="#aaffff" stroke="black" points="6970,-2976 6797,-2976 6797,-2893 6970,-2893 6970,-2976"/>
<text text-anchor="middle" x="6883.5" y="-2960.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6883.5" y="-2945.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="6883.5" y="-2930.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6883.5" y="-2915.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6883.5" y="-2900.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_2_2_3&#45;&gt;out_proj_2_2_3 -->
<g id="edge570" class="edge">
<title>attn_2_2_3&#45;&gt;out_proj_2_2_3</title>
<path fill="none" stroke="black" d="M6971,-3012.85C6960.36,-3003.45 6948.57,-2993.02 6937.18,-2982.95"/>
<polygon fill="black" stroke="black" points="6939.19,-2980.06 6929.38,-2976.06 6934.55,-2985.3 6939.19,-2980.06"/>
</g>
<!-- out_proj_2_2_3&#45;&gt;concat_dim_2_2 -->
<g id="edge571" class="edge">
<title>out_proj_2_2_3&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" d="M6796.96,-2910.92C6698.93,-2885.34 6539.34,-2843.71 6435.38,-2816.58"/>
<polygon fill="black" stroke="black" points="6436.06,-2813.14 6425.5,-2814 6434.29,-2819.91 6436.06,-2813.14"/>
</g>
<!-- out_proj_2_2_3&#45;&gt;concat_dim_2_2 -->
<g id="edge572" class="edge">
<title>out_proj_2_2_3&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6796.86,-2904.63C6752.45,-2890.32 6697.36,-2873.3 6647.5,-2860 6581.17,-2842.31 6506.15,-2825.47 6446.08,-2812.74"/>
<polygon fill="red" stroke="red" points="6446.7,-2809.3 6436.19,-2810.66 6445.25,-2816.15 6446.7,-2809.3"/>
<text text-anchor="middle" x="6738.5" y="-2863.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_2_3_0 -->
<g id="node269" class="node">
<title>out_proj_2_3_0</title>
<polygon fill="#ff8888" stroke="black" points="7967,-2976 7794,-2976 7794,-2893 7967,-2893 7967,-2976"/>
<text text-anchor="middle" x="7880.5" y="-2960.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7880.5" y="-2945.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="7880.5" y="-2930.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7880.5" y="-2915.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="7880.5" y="-2900.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_2_3_0&#45;&gt;out_proj_2_3_0 -->
<g id="edge579" class="edge">
<title>attn_2_3_0&#45;&gt;out_proj_2_3_0</title>
<path fill="none" stroke="black" d="M7765.71,-3012.85C7780.19,-3003.08 7796.32,-2992.22 7811.79,-2981.79"/>
<polygon fill="black" stroke="black" points="7813.97,-2984.55 7820.31,-2976.06 7810.06,-2978.74 7813.97,-2984.55"/>
</g>
<!-- concat_dim_2_3 -->
<g id="node270" class="node">
<title>concat_dim_2_3</title>
<polygon fill="lightyellow" stroke="black" points="8262.5,-2842 8089.5,-2789 8262.5,-2736 8435.5,-2789 8262.5,-2842"/>
<text text-anchor="middle" x="8262.5" y="-2800.3" font-family="monospace" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="8262.5" y="-2785.3" font-family="monospace" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="8262.5" y="-2770.3" font-family="monospace" font-size="14.00">[1024×2048×(4×512)]</text>
</g>
<!-- out_proj_2_3_0&#45;&gt;concat_dim_2_3 -->
<g id="edge580" class="edge">
<title>out_proj_2_3_0&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" d="M7967.18,-2900.94C8029.89,-2877.38 8114.24,-2845.69 8176.74,-2822.22"/>
<polygon fill="black" stroke="black" points="8178.05,-2825.46 8186.18,-2818.67 8175.59,-2818.91 8178.05,-2825.46"/>
</g>
<!-- out_proj_2_3_0&#45;&gt;concat_dim_2_3 -->
<g id="edge581" class="edge">
<title>out_proj_2_3_0&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7967.29,-2908.7C7999.36,-2898.96 8035.84,-2887.19 8068.5,-2875 8107.87,-2860.3 8150.75,-2841.79 8186.17,-2825.79"/>
<polygon fill="red" stroke="red" points="8187.81,-2828.89 8195.47,-2821.57 8184.92,-2822.51 8187.81,-2828.89"/>
<text text-anchor="middle" x="8144.5" y="-2863.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_dim_2_3&#45;&gt;concat_heads_2 -->
<g id="edge612" class="edge">
<title>concat_dim_2_3&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M8125.32,-2777.97C7772.15,-2752.16 6834.31,-2683.61 6475.69,-2657.39"/>
<polygon fill="black" stroke="black" points="6475.73,-2653.89 6465.51,-2656.65 6475.22,-2660.87 6475.73,-2653.89"/>
</g>
<!-- out_proj_2_3_1 -->
<g id="node272" class="node">
<title>out_proj_2_3_1</title>
<polygon fill="#88ff88" stroke="black" points="8349,-2976 8176,-2976 8176,-2893 8349,-2893 8349,-2976"/>
<text text-anchor="middle" x="8262.5" y="-2960.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="8262.5" y="-2945.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="8262.5" y="-2930.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8262.5" y="-2915.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8262.5" y="-2900.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_2_3_1&#45;&gt;out_proj_2_3_1 -->
<g id="edge588" class="edge">
<title>attn_2_3_1&#45;&gt;out_proj_2_3_1</title>
<path fill="none" stroke="black" d="M8262.5,-3012.85C8262.5,-3004.44 8262.5,-2995.22 8262.5,-2986.16"/>
<polygon fill="black" stroke="black" points="8266,-2986.06 8262.5,-2976.06 8259,-2986.06 8266,-2986.06"/>
</g>
<!-- out_proj_2_3_1&#45;&gt;concat_dim_2_3 -->
<g id="edge589" class="edge">
<title>out_proj_2_3_1&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" d="M8262.5,-2892.76C8262.5,-2880.22 8262.5,-2866.1 8262.5,-2852.45"/>
<polygon fill="black" stroke="black" points="8266,-2852.13 8262.5,-2842.13 8259,-2852.13 8266,-2852.13"/>
</g>
<!-- out_proj_2_3_1&#45;&gt;concat_dim_2_3 -->
<g id="edge590" class="edge">
<title>out_proj_2_3_1&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8273.53,-2892.81C8274.76,-2886.87 8275.81,-2880.81 8276.5,-2875 8277.52,-2866.37 8277.35,-2857.27 8276.49,-2848.37"/>
<polygon fill="red" stroke="red" points="8279.96,-2847.92 8275.24,-2838.44 8273.01,-2848.8 8279.96,-2847.92"/>
<text text-anchor="middle" x="8315.5" y="-2863.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_2_3_2 -->
<g id="node274" class="node">
<title>out_proj_2_3_2</title>
<polygon fill="#8888ff" stroke="black" points="8761,-2976 8588,-2976 8588,-2893 8761,-2893 8761,-2976"/>
<text text-anchor="middle" x="8674.5" y="-2960.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8674.5" y="-2945.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="8674.5" y="-2930.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8674.5" y="-2915.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8674.5" y="-2900.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_2_3_2&#45;&gt;out_proj_2_3_2 -->
<g id="edge597" class="edge">
<title>attn_2_3_2&#45;&gt;out_proj_2_3_2</title>
<path fill="none" stroke="black" d="M8772.5,-3012.85C8760.36,-3003.26 8746.87,-2992.62 8733.89,-2982.37"/>
<polygon fill="black" stroke="black" points="8735.9,-2979.5 8725.88,-2976.06 8731.56,-2985 8735.9,-2979.5"/>
</g>
<!-- out_proj_2_3_2&#45;&gt;concat_dim_2_3 -->
<g id="edge598" class="edge">
<title>out_proj_2_3_2&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" d="M8587.88,-2903.33C8518.56,-2879.19 8421.71,-2845.45 8351.72,-2821.07"/>
<polygon fill="black" stroke="black" points="8352.62,-2817.68 8342.02,-2817.7 8350.32,-2824.29 8352.62,-2817.68"/>
</g>
<!-- out_proj_2_3_2&#45;&gt;concat_dim_2_3 -->
<g id="edge599" class="edge">
<title>out_proj_2_3_2&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8587.72,-2894.29C8560.39,-2882.58 8529.92,-2870.16 8501.5,-2860 8456.84,-2844.03 8406.56,-2828.9 8363.69,-2816.81"/>
<polygon fill="red" stroke="red" points="8364.38,-2813.37 8353.81,-2814.04 8362.49,-2820.11 8364.38,-2813.37"/>
<text text-anchor="middle" x="8577.5" y="-2863.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_2_3_3 -->
<g id="node276" class="node">
<title>out_proj_2_3_3</title>
<polygon fill="#ffff88" stroke="black" points="9278,-2976 9105,-2976 9105,-2893 9278,-2893 9278,-2976"/>
<text text-anchor="middle" x="9191.5" y="-2960.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9191.5" y="-2945.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="9191.5" y="-2930.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="9191.5" y="-2915.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="9191.5" y="-2900.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_2_3_3&#45;&gt;out_proj_2_3_3 -->
<g id="edge606" class="edge">
<title>attn_2_3_3&#45;&gt;out_proj_2_3_3</title>
<path fill="none" stroke="black" d="M9308.39,-3012.85C9293.64,-3003.08 9277.22,-2992.22 9261.46,-2981.79"/>
<polygon fill="black" stroke="black" points="9263.06,-2978.65 9252.79,-2976.06 9259.2,-2984.49 9263.06,-2978.65"/>
</g>
<!-- out_proj_2_3_3&#45;&gt;concat_dim_2_3 -->
<g id="edge607" class="edge">
<title>out_proj_2_3_3&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" d="M9104.94,-2920.13C8939.21,-2894.53 8576.66,-2838.53 8385.72,-2809.03"/>
<polygon fill="black" stroke="black" points="8386.06,-2805.54 8375.64,-2807.48 8384.99,-2812.46 8386.06,-2805.54"/>
</g>
<!-- out_proj_2_3_3&#45;&gt;concat_dim_2_3 -->
<g id="edge608" class="edge">
<title>out_proj_2_3_3&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9104.72,-2916.76C9022.06,-2901.09 8894.04,-2877.52 8782.5,-2860 8650.65,-2839.29 8499.38,-2819.35 8394.12,-2806.09"/>
<polygon fill="red" stroke="red" points="8394.43,-2802.6 8384.07,-2804.83 8393.56,-2809.55 8394.43,-2802.6"/>
<text text-anchor="middle" x="8909.5" y="-2863.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_heads_2&#45;&gt;add_2 -->
<g id="edge613" class="edge">
<title>concat_heads_2&#45;&gt;add_2</title>
<path fill="none" stroke="black" d="M6454.76,-2631.93C6783.94,-2596.44 7691.05,-2498.66 8013.17,-2463.93"/>
<polygon fill="black" stroke="black" points="8013.88,-2467.38 8023.45,-2462.82 8013.13,-2460.42 8013.88,-2467.38"/>
</g>
<!-- ffn_dense_h_2 -->
<g id="node280" class="node">
<title>ffn_dense_h_2</title>
<polygon fill="lightgreen" stroke="black" points="8124,-2233 7967,-2233 7967,-2165 8124,-2165 8124,-2233"/>
<text text-anchor="middle" x="8045.5" y="-2217.8" font-family="monospace" font-size="14.00">FFN Dense_H</text>
<text text-anchor="middle" x="8045.5" y="-2202.8" font-family="monospace" font-size="14.00">[1024×2048×32768]</text>
<text text-anchor="middle" x="8045.5" y="-2187.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8045.5" y="-2172.8" font-family="monospace" font-size="14.00">→AllGather</text>
</g>
<!-- ln2_2&#45;&gt;ffn_dense_h_2 -->
<g id="edge616" class="edge">
<title>ln2_2&#45;&gt;ffn_dense_h_2</title>
<path fill="none" stroke="black" d="M8051.05,-2269.77C8050.43,-2262 8049.68,-2252.59 8048.94,-2243.22"/>
<polygon fill="black" stroke="black" points="8052.42,-2242.84 8048.14,-2233.15 8045.44,-2243.4 8052.42,-2242.84"/>
</g>
<!-- ln1_3 -->
<g id="node283" class="node">
<title>ln1_3</title>
<polygon fill="lightgray" stroke="black" points="4745,-1672 4596,-1672 4596,-1634 4745,-1634 4745,-1672"/>
<text text-anchor="middle" x="4670.5" y="-1656.8" font-family="monospace" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="4670.5" y="-1641.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- add2_2&#45;&gt;ln1_3 -->
<g id="edge622" class="edge">
<title>add2_2&#45;&gt;ln1_3</title>
<path fill="none" stroke="black" d="M7946.14,-1808.53C7434.88,-1784.41 5218.28,-1679.84 4755.41,-1658.01"/>
<polygon fill="black" stroke="black" points="4755.29,-1654.5 4745.13,-1657.52 4754.96,-1661.49 4755.29,-1654.5"/>
</g>
<!-- add_3 -->
<g id="node284" class="node">
<title>add_3</title>
<ellipse fill="lightgray" stroke="black" cx="7592.5" cy="-832.5" rx="105.5" ry="105.5"/>
<text text-anchor="middle" x="7592.5" y="-843.8" font-family="monospace" font-size="14.00">Add</text>
<text text-anchor="middle" x="7592.5" y="-828.8" font-family="monospace" font-size="14.00">Residual</text>
<text text-anchor="middle" x="7592.5" y="-813.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- add2_2&#45;&gt;add_3 -->
<g id="edge623" class="edge">
<title>add2_2&#45;&gt;add_3</title>
<path fill="none" stroke="black" d="M8157.02,-1809.55C8437.18,-1797.68 9178.5,-1756.57 9178.5,-1654 9178.5,-1654 9178.5,-1654 9178.5,-1027 9178.5,-878.81 8073.46,-843.19 7708.16,-835.47"/>
<polygon fill="black" stroke="black" points="7708.17,-831.97 7698.1,-835.26 7708.02,-838.96 7708.17,-831.97"/>
</g>
<!-- ffn_act_2 -->
<g id="node281" class="node">
<title>ffn_act_2</title>
<polygon fill="lightgreen" stroke="black" points="8116,-2114 7959,-2114 7959,-2076 8116,-2076 8116,-2114"/>
<text text-anchor="middle" x="8037.5" y="-2098.8" font-family="monospace" font-size="14.00">GELU</text>
<text text-anchor="middle" x="8037.5" y="-2083.8" font-family="monospace" font-size="14.00">[1024×2048×32768]</text>
</g>
<!-- ffn_dense_h_2&#45;&gt;ffn_act_2 -->
<g id="edge617" class="edge">
<title>ffn_dense_h_2&#45;&gt;ffn_act_2</title>
<path fill="none" stroke="black" d="M8042.9,-2164.88C8041.88,-2151.84 8040.72,-2137 8039.73,-2124.45"/>
<polygon fill="black" stroke="black" points="8043.19,-2123.8 8038.92,-2114.11 8036.21,-2124.35 8043.19,-2123.8"/>
</g>
<!-- ffn_dense_h_2&#45;&gt;ffn_act_2 -->
<g id="edge618" class="edge">
<title>ffn_dense_h_2&#45;&gt;ffn_act_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8050.35,-2164.96C8051.15,-2154.38 8051.23,-2142.65 8049.5,-2132 8049.06,-2129.29 8048.45,-2126.51 8047.72,-2123.75"/>
<polygon fill="red" stroke="red" points="8051.03,-2122.58 8044.77,-2114.03 8044.33,-2124.61 8051.03,-2122.58"/>
<text text-anchor="middle" x="8088" y="-2135.8" font-family="Times,serif" font-size="14.00">All&#45;Gather</text>
</g>
<!-- ffn_dense_4h_2 -->
<g id="node282" class="node">
<title>ffn_dense_4h_2</title>
<polygon fill="lightgreen" stroke="black" points="8110,-2039 7961,-2039 7961,-1971 8110,-1971 8110,-2039"/>
<text text-anchor="middle" x="8035.5" y="-2023.8" font-family="monospace" font-size="14.00">FFN Dense_4H</text>
<text text-anchor="middle" x="8035.5" y="-2008.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
<text text-anchor="middle" x="8035.5" y="-1993.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8035.5" y="-1978.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ffn_act_2&#45;&gt;ffn_dense_4h_2 -->
<g id="edge619" class="edge">
<title>ffn_act_2&#45;&gt;ffn_dense_4h_2</title>
<path fill="none" stroke="black" d="M8037.09,-2075.77C8036.91,-2068 8036.7,-2058.59 8036.48,-2049.22"/>
<polygon fill="black" stroke="black" points="8039.98,-2049.07 8036.25,-2039.15 8032.98,-2049.23 8039.98,-2049.07"/>
</g>
<!-- ffn_dense_4h_2&#45;&gt;add2_2 -->
<g id="edge620" class="edge">
<title>ffn_dense_4h_2&#45;&gt;add2_2</title>
<path fill="none" stroke="black" d="M8038.32,-1970.73C8039.33,-1958.88 8040.53,-1944.78 8041.78,-1929.97"/>
<polygon fill="black" stroke="black" points="8045.3,-1929.89 8042.66,-1919.63 8038.33,-1929.3 8045.3,-1929.89"/>
</g>
<!-- ffn_dense_4h_2&#45;&gt;add2_2 -->
<g id="edge621" class="edge">
<title>ffn_dense_4h_2&#45;&gt;add2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8043.51,-1970.95C8044.7,-1965.01 8045.77,-1958.84 8046.5,-1953 8047.43,-1945.58 8048.2,-1937.93 8048.85,-1930.2"/>
<polygon fill="red" stroke="red" points="8052.36,-1930.25 8049.63,-1920.01 8045.38,-1929.71 8052.36,-1930.25"/>
<text text-anchor="middle" x="8086.5" y="-1941.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- q_proj_3_0_0 -->
<g id="node285" class="node">
<title>q_proj_3_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="173,-1597 0,-1597 0,-1514 173,-1514 173,-1597"/>
<text text-anchor="middle" x="86.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="86.5" y="-1566.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="86.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="86.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="86.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_0_0 -->
<g id="edge624" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_0_0</title>
<path fill="none" stroke="black" d="M4595.66,-1651.92C4103.89,-1651.27 1329.04,-1646.33 482.5,-1616 351.81,-1611.32 313.77,-1627.15 183.06,-1597.14"/>
<polygon fill="black" stroke="black" points="183.61,-1593.67 173.07,-1594.8 182.01,-1600.49 183.61,-1593.67"/>
</g>
<!-- k_proj_3_0_0 -->
<g id="node286" class="node">
<title>k_proj_3_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="364,-1597 191,-1597 191,-1514 364,-1514 364,-1597"/>
<text text-anchor="middle" x="277.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="277.5" y="-1566.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="277.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="277.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="277.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_0_0 -->
<g id="edge625" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_0_0</title>
<path fill="none" stroke="black" d="M4595.63,-1651.88C4116.95,-1651.02 1479.48,-1645.05 673.5,-1616 542.81,-1611.29 504.77,-1627.15 374.06,-1597.14"/>
<polygon fill="black" stroke="black" points="374.61,-1593.67 364.07,-1594.8 373.01,-1600.49 374.61,-1593.67"/>
</g>
<!-- v_proj_3_0_0 -->
<g id="node287" class="node">
<title>v_proj_3_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="555,-1597 382,-1597 382,-1514 555,-1514 555,-1597"/>
<text text-anchor="middle" x="468.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="468.5" y="-1566.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="468.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="468.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="468.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_0_0 -->
<g id="edge626" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_0_0</title>
<path fill="none" stroke="black" d="M4595.87,-1651.84C4131.26,-1650.77 1630.1,-1643.76 864.5,-1616 733.81,-1611.26 695.77,-1627.14 565.06,-1597.14"/>
<polygon fill="black" stroke="black" points="565.61,-1593.67 555.07,-1594.8 564.01,-1600.49 565.61,-1593.67"/>
</g>
<!-- q_proj_3_0_1 -->
<g id="node288" class="node">
<title>q_proj_3_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="746,-1597 573,-1597 573,-1514 746,-1514 746,-1597"/>
<text text-anchor="middle" x="659.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="659.5" y="-1566.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="659.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="659.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="659.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_0_1 -->
<g id="edge627" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_0_1</title>
<path fill="none" stroke="black" d="M4595.64,-1651.8C4144.25,-1650.49 1780.52,-1642.47 1055.5,-1616 924.82,-1611.23 886.77,-1627.14 756.06,-1597.14"/>
<polygon fill="black" stroke="black" points="756.61,-1593.67 746.07,-1594.8 755.01,-1600.49 756.61,-1593.67"/>
</g>
<!-- k_proj_3_0_1 -->
<g id="node289" class="node">
<title>k_proj_3_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="937,-1597 764,-1597 764,-1514 937,-1514 937,-1597"/>
<text text-anchor="middle" x="850.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="850.5" y="-1566.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="850.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="850.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="850.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_0_1 -->
<g id="edge628" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_0_1</title>
<path fill="none" stroke="black" d="M4595.73,-1651.75C4158.75,-1650.2 1931.17,-1641.19 1246.5,-1616 1115.82,-1611.19 1077.77,-1627.14 947.06,-1597.14"/>
<polygon fill="black" stroke="black" points="947.61,-1593.67 937.07,-1594.8 946.01,-1600.49 947.61,-1593.67"/>
</g>
<!-- v_proj_3_0_1 -->
<g id="node290" class="node">
<title>v_proj_3_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="1128,-1597 955,-1597 955,-1514 1128,-1514 1128,-1597"/>
<text text-anchor="middle" x="1041.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1041.5" y="-1566.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="1041.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1041.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1041.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_0_1 -->
<g id="edge629" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_0_1</title>
<path fill="none" stroke="black" d="M4595.82,-1651.7C4173.62,-1649.9 2081.87,-1639.91 1437.5,-1616 1306.82,-1611.15 1268.77,-1627.14 1138.06,-1597.14"/>
<polygon fill="black" stroke="black" points="1138.61,-1593.67 1128.07,-1594.8 1137.01,-1600.49 1138.61,-1593.67"/>
</g>
<!-- q_proj_3_0_2 -->
<g id="node291" class="node">
<title>q_proj_3_0_2</title>
<polygon fill="#ccccff" stroke="black" points="1319,-1597 1146,-1597 1146,-1514 1319,-1514 1319,-1597"/>
<text text-anchor="middle" x="1232.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1232.5" y="-1566.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="1232.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1232.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1232.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_0_2 -->
<g id="edge630" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_0_2</title>
<path fill="none" stroke="black" d="M4595.96,-1651.64C4189.07,-1649.58 2232.66,-1638.63 1628.5,-1616 1497.82,-1611.11 1459.77,-1627.14 1329.06,-1597.14"/>
<polygon fill="black" stroke="black" points="1329.61,-1593.67 1319.07,-1594.8 1328.01,-1600.49 1329.61,-1593.67"/>
</g>
<!-- k_proj_3_0_2 -->
<g id="node292" class="node">
<title>k_proj_3_0_2</title>
<polygon fill="#ccccff" stroke="black" points="1510,-1597 1337,-1597 1337,-1514 1510,-1514 1510,-1597"/>
<text text-anchor="middle" x="1423.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1423.5" y="-1566.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="1423.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1423.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1423.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_0_2 -->
<g id="edge631" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_0_2</title>
<path fill="none" stroke="black" d="M4595.88,-1651.57C4204.3,-1649.22 2383.4,-1637.34 1819.5,-1616 1688.82,-1611.05 1650.77,-1627.13 1520.06,-1597.14"/>
<polygon fill="black" stroke="black" points="1520.61,-1593.67 1510.07,-1594.8 1519.01,-1600.49 1520.61,-1593.67"/>
</g>
<!-- v_proj_3_0_2 -->
<g id="node293" class="node">
<title>v_proj_3_0_2</title>
<polygon fill="#ccccff" stroke="black" points="1701,-1597 1528,-1597 1528,-1514 1701,-1514 1701,-1597"/>
<text text-anchor="middle" x="1614.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1614.5" y="-1566.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="1614.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1614.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1614.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_0_2 -->
<g id="edge632" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_0_2</title>
<path fill="none" stroke="black" d="M4595.89,-1652.34C4281.6,-1653.5 3034.47,-1655.22 2010.5,-1616 1879.82,-1610.99 1841.77,-1627.13 1711.06,-1597.14"/>
<polygon fill="black" stroke="black" points="1711.61,-1593.67 1701.07,-1594.8 1710.01,-1600.49 1711.61,-1593.67"/>
</g>
<!-- q_proj_3_0_3 -->
<g id="node294" class="node">
<title>q_proj_3_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="1892,-1597 1719,-1597 1719,-1514 1892,-1514 1892,-1597"/>
<text text-anchor="middle" x="1805.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1805.5" y="-1566.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="1805.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1805.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1805.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_0_3 -->
<g id="edge633" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_0_3</title>
<path fill="none" stroke="black" d="M4595.98,-1652.23C4295.83,-1652.88 3146.32,-1652.69 2201.5,-1616 2070.83,-1610.93 2032.77,-1627.13 1902.06,-1597.14"/>
<polygon fill="black" stroke="black" points="1902.61,-1593.67 1892.07,-1594.8 1901.01,-1600.49 1902.61,-1593.67"/>
</g>
<!-- k_proj_3_0_3 -->
<g id="node295" class="node">
<title>k_proj_3_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="2083,-1597 1910,-1597 1910,-1514 2083,-1514 2083,-1597"/>
<text text-anchor="middle" x="1996.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1996.5" y="-1566.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="1996.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1996.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="1996.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_0_3 -->
<g id="edge634" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_0_3</title>
<path fill="none" stroke="black" d="M4595.77,-1652.09C4309.96,-1652.18 3258.67,-1650.04 2393.5,-1616 2262.4,-1610.84 2224.21,-1627.21 2093.09,-1597.14"/>
<polygon fill="black" stroke="black" points="2093.61,-1593.67 2083.07,-1594.8 2092.01,-1600.49 2093.61,-1593.67"/>
</g>
<!-- v_proj_3_0_3 -->
<g id="node296" class="node">
<title>v_proj_3_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="2274,-1597 2101,-1597 2101,-1514 2274,-1514 2274,-1597"/>
<text text-anchor="middle" x="2187.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="2187.5" y="-1566.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="2187.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2187.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2187.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_0_3 -->
<g id="edge635" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_0_3</title>
<path fill="none" stroke="black" d="M4595.67,-1651.93C4324.99,-1651.43 3371.39,-1647.41 2585.5,-1616 2453.97,-1610.74 2415.65,-1627.29 2284.13,-1597.15"/>
<polygon fill="black" stroke="black" points="2284.61,-1593.67 2274.07,-1594.8 2283.01,-1600.49 2284.61,-1593.67"/>
</g>
<!-- q_proj_3_1_0 -->
<g id="node297" class="node">
<title>q_proj_3_1_0</title>
<polygon fill="#ffccff" stroke="black" points="2465,-1597 2292,-1597 2292,-1514 2465,-1514 2465,-1597"/>
<text text-anchor="middle" x="2378.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2378.5" y="-1566.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="2378.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2378.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2378.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_1_0 -->
<g id="edge636" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_1_0</title>
<path fill="none" stroke="black" d="M4595.73,-1651.72C4341.4,-1650.54 3486.34,-1644.55 2780.5,-1616 2647.11,-1610.6 2608.34,-1627.65 2474.85,-1597.09"/>
<polygon fill="black" stroke="black" points="2475.61,-1593.67 2465.07,-1594.8 2474.01,-1600.49 2475.61,-1593.67"/>
</g>
<!-- k_proj_3_1_0 -->
<g id="node298" class="node">
<title>k_proj_3_1_0</title>
<polygon fill="#ffccff" stroke="black" points="2656,-1597 2483,-1597 2483,-1514 2656,-1514 2656,-1597"/>
<text text-anchor="middle" x="2569.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2569.5" y="-1566.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="2569.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2569.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2569.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_1_0 -->
<g id="edge637" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_1_0</title>
<path fill="none" stroke="black" d="M4595.77,-1651.53C4357.87,-1649.78 3596.84,-1642.37 2967.5,-1616 2835.98,-1610.49 2797.65,-1627.28 2666.13,-1597.15"/>
<polygon fill="black" stroke="black" points="2666.61,-1593.67 2656.07,-1594.8 2665.01,-1600.49 2666.61,-1593.67"/>
</g>
<!-- v_proj_3_1_0 -->
<g id="node299" class="node">
<title>v_proj_3_1_0</title>
<polygon fill="#ffccff" stroke="black" points="2847,-1597 2674,-1597 2674,-1514 2847,-1514 2847,-1597"/>
<text text-anchor="middle" x="2760.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2760.5" y="-1566.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="2760.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2760.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2760.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_1_0 -->
<g id="edge638" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_1_0</title>
<path fill="none" stroke="black" d="M4595.98,-1651.21C4376.48,-1648.69 3713.24,-1639.51 3163.5,-1616 3029.69,-1610.28 2990.78,-1627.72 2856.88,-1597.09"/>
<polygon fill="black" stroke="black" points="2857.61,-1593.67 2847.07,-1594.8 2856.01,-1600.49 2857.61,-1593.67"/>
</g>
<!-- q_proj_3_1_1 -->
<g id="node300" class="node">
<title>q_proj_3_1_1</title>
<polygon fill="#ccffff" stroke="black" points="3038,-1597 2865,-1597 2865,-1514 3038,-1514 3038,-1597"/>
<text text-anchor="middle" x="2951.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2951.5" y="-1566.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="2951.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2951.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="2951.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_1_1 -->
<g id="edge639" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_1_1</title>
<path fill="none" stroke="black" d="M4595.73,-1650.87C4394.55,-1647.65 3824.93,-1637.2 3351.5,-1616 3219.13,-1610.07 3180.53,-1627.42 3048.19,-1597.16"/>
<polygon fill="black" stroke="black" points="3048.61,-1593.67 3038.07,-1594.8 3047.01,-1600.48 3048.61,-1593.67"/>
</g>
<!-- k_proj_3_1_1 -->
<g id="node301" class="node">
<title>k_proj_3_1_1</title>
<polygon fill="#ccffff" stroke="black" points="3229,-1597 3056,-1597 3056,-1514 3229,-1514 3229,-1597"/>
<text text-anchor="middle" x="3142.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3142.5" y="-1566.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="3142.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3142.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3142.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_1_1 -->
<g id="edge640" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_1_1</title>
<path fill="none" stroke="black" d="M4595.69,-1650.34C4415.55,-1646.18 3943.38,-1634.31 3549.5,-1616 3413.98,-1609.7 3374.54,-1628.03 3239,-1597.12"/>
<polygon fill="black" stroke="black" points="3239.6,-1593.67 3229.07,-1594.81 3238.02,-1600.48 3239.6,-1593.67"/>
</g>
<!-- v_proj_3_1_1 -->
<g id="node302" class="node">
<title>v_proj_3_1_1</title>
<polygon fill="#ccffff" stroke="black" points="3420,-1597 3247,-1597 3247,-1514 3420,-1514 3420,-1597"/>
<text text-anchor="middle" x="3333.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3333.5" y="-1566.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="3333.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3333.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3333.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_1_1 -->
<g id="edge641" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_1_1</title>
<path fill="none" stroke="black" d="M4595.92,-1649.76C4436.96,-1644.84 4053.09,-1632.25 3731.5,-1616 3600.03,-1609.36 3561.65,-1627.22 3430.13,-1597.15"/>
<polygon fill="black" stroke="black" points="3430.61,-1593.67 3420.07,-1594.8 3429.01,-1600.48 3430.61,-1593.67"/>
</g>
<!-- q_proj_3_1_2 -->
<g id="node303" class="node">
<title>q_proj_3_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="3611,-1597 3438,-1597 3438,-1514 3611,-1514 3611,-1597"/>
<text text-anchor="middle" x="3524.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="3524.5" y="-1566.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="3524.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3524.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3524.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_1_2 -->
<g id="edge642" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_1_2</title>
<path fill="none" stroke="black" d="M4595.65,-1651.56C4391,-1649.8 3824.44,-1641.19 3621.06,-1597.07"/>
<polygon fill="black" stroke="black" points="3621.6,-1593.6 3611.07,-1594.81 3620.05,-1600.43 3621.6,-1593.6"/>
</g>
<!-- k_proj_3_1_2 -->
<g id="node304" class="node">
<title>k_proj_3_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="3802,-1597 3629,-1597 3629,-1514 3802,-1514 3802,-1597"/>
<text text-anchor="middle" x="3715.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="3715.5" y="-1566.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="3715.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3715.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3715.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_1_2 -->
<g id="edge643" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_1_2</title>
<path fill="none" stroke="black" d="M4595.85,-1650.46C4418.94,-1646.3 3977.3,-1632.8 3812.08,-1597.07"/>
<polygon fill="black" stroke="black" points="3812.6,-1593.6 3802.07,-1594.8 3811.05,-1600.42 3812.6,-1593.6"/>
</g>
<!-- v_proj_3_1_2 -->
<g id="node305" class="node">
<title>v_proj_3_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="3993,-1597 3820,-1597 3820,-1514 3993,-1514 3993,-1597"/>
<text text-anchor="middle" x="3906.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="3906.5" y="-1566.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="3906.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3906.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="3906.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_1_2 -->
<g id="edge644" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_1_2</title>
<path fill="none" stroke="black" d="M4595.75,-1648.87C4449.58,-1642.27 4129.81,-1625.35 4002.96,-1597.05"/>
<polygon fill="black" stroke="black" points="4003.63,-1593.61 3993.09,-1594.73 4002.02,-1600.43 4003.63,-1593.61"/>
</g>
<!-- q_proj_3_1_3 -->
<g id="node306" class="node">
<title>q_proj_3_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="4184,-1597 4011,-1597 4011,-1514 4184,-1514 4184,-1597"/>
<text text-anchor="middle" x="4097.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="4097.5" y="-1566.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="4097.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4097.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4097.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_1_3 -->
<g id="edge645" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_1_3</title>
<path fill="none" stroke="black" d="M4595.99,-1650.05C4503.03,-1646.15 4339.55,-1634.47 4194.12,-1597.22"/>
<polygon fill="black" stroke="black" points="4194.68,-1593.75 4184.12,-1594.61 4192.91,-1600.52 4194.68,-1593.75"/>
</g>
<!-- k_proj_3_1_3 -->
<g id="node307" class="node">
<title>k_proj_3_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="4375,-1597 4202,-1597 4202,-1514 4375,-1514 4375,-1597"/>
<text text-anchor="middle" x="4288.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="4288.5" y="-1566.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="4288.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4288.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4288.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_1_3 -->
<g id="edge646" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_1_3</title>
<path fill="none" stroke="black" d="M4595.71,-1642.15C4539.56,-1633.73 4460.87,-1619.75 4384.93,-1597.27"/>
<polygon fill="black" stroke="black" points="4385.78,-1593.87 4375.2,-1594.34 4383.76,-1600.57 4385.78,-1593.87"/>
</g>
<!-- v_proj_3_1_3 -->
<g id="node308" class="node">
<title>v_proj_3_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="4566,-1597 4393,-1597 4393,-1514 4566,-1514 4566,-1597"/>
<text text-anchor="middle" x="4479.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="4479.5" y="-1566.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="4479.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4479.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4479.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_1_3 -->
<g id="edge647" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_1_3</title>
<path fill="none" stroke="black" d="M4634.12,-1633.81C4615.78,-1624.64 4592.63,-1613.07 4569.88,-1601.69"/>
<polygon fill="black" stroke="black" points="4571.36,-1598.52 4560.85,-1597.17 4568.23,-1604.78 4571.36,-1598.52"/>
</g>
<!-- q_proj_3_2_0 -->
<g id="node309" class="node">
<title>q_proj_3_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="4757,-1597 4584,-1597 4584,-1514 4757,-1514 4757,-1597"/>
<text text-anchor="middle" x="4670.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4670.5" y="-1566.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="4670.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4670.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4670.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_2_0 -->
<g id="edge648" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_2_0</title>
<path fill="none" stroke="black" d="M4670.5,-1633.59C4670.5,-1625.94 4670.5,-1616.66 4670.5,-1607.23"/>
<polygon fill="black" stroke="black" points="4674,-1607 4670.5,-1597 4667,-1607 4674,-1607"/>
</g>
<!-- k_proj_3_2_0 -->
<g id="node310" class="node">
<title>k_proj_3_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="4948,-1597 4775,-1597 4775,-1514 4948,-1514 4948,-1597"/>
<text text-anchor="middle" x="4861.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4861.5" y="-1566.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="4861.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4861.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="4861.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_2_0 -->
<g id="edge649" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_2_0</title>
<path fill="none" stroke="black" d="M4706.88,-1633.81C4725.22,-1624.64 4748.37,-1613.07 4771.12,-1601.69"/>
<polygon fill="black" stroke="black" points="4772.77,-1604.78 4780.15,-1597.17 4769.64,-1598.52 4772.77,-1604.78"/>
</g>
<!-- v_proj_3_2_0 -->
<g id="node311" class="node">
<title>v_proj_3_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="5139,-1597 4966,-1597 4966,-1514 5139,-1514 5139,-1597"/>
<text text-anchor="middle" x="5052.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="5052.5" y="-1566.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="5052.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5052.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5052.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_2_0 -->
<g id="edge650" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_2_0</title>
<path fill="none" stroke="black" d="M4745.01,-1642.04C4800.95,-1633.57 4879.35,-1619.57 4956.1,-1596.93"/>
<polygon fill="black" stroke="black" points="4957.36,-1600.2 4965.94,-1593.98 4955.35,-1593.5 4957.36,-1600.2"/>
</g>
<!-- q_proj_3_2_1 -->
<g id="node312" class="node">
<title>q_proj_3_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="5330,-1597 5157,-1597 5157,-1514 5330,-1514 5330,-1597"/>
<text text-anchor="middle" x="5243.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5243.5" y="-1566.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="5243.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5243.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5243.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_2_1 -->
<g id="edge651" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_2_1</title>
<path fill="none" stroke="black" d="M4745.25,-1649.93C4838.06,-1645.91 5000.9,-1634.1 5146.73,-1596.96"/>
<polygon fill="black" stroke="black" points="5147.96,-1600.26 5156.76,-1594.36 5146.2,-1593.49 5147.96,-1600.26"/>
</g>
<!-- k_proj_3_2_1 -->
<g id="node313" class="node">
<title>k_proj_3_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="5521,-1597 5348,-1597 5348,-1514 5521,-1514 5521,-1597"/>
<text text-anchor="middle" x="5434.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5434.5" y="-1566.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="5434.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5434.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5434.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_2_1 -->
<g id="edge652" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_2_1</title>
<path fill="none" stroke="black" d="M4745.13,-1648.83C4891.06,-1642.16 5210.33,-1625.11 5337.86,-1596.82"/>
<polygon fill="black" stroke="black" points="5338.85,-1600.18 5347.79,-1594.49 5337.26,-1593.36 5338.85,-1600.18"/>
</g>
<!-- v_proj_3_2_1 -->
<g id="node314" class="node">
<title>v_proj_3_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="5712,-1597 5539,-1597 5539,-1514 5712,-1514 5712,-1597"/>
<text text-anchor="middle" x="5625.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5625.5" y="-1566.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="5625.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5625.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5625.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_2_1 -->
<g id="edge653" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_2_1</title>
<path fill="none" stroke="black" d="M4745.06,-1650.43C4921.74,-1646.19 5362.84,-1632.54 5528.75,-1596.84"/>
<polygon fill="black" stroke="black" points="5529.82,-1600.18 5538.81,-1594.56 5528.28,-1593.35 5529.82,-1600.18"/>
</g>
<!-- q_proj_3_2_2 -->
<g id="node315" class="node">
<title>q_proj_3_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="5903,-1597 5730,-1597 5730,-1514 5903,-1514 5903,-1597"/>
<text text-anchor="middle" x="5816.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5816.5" y="-1566.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="5816.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5816.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="5816.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_2_2 -->
<g id="edge654" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_2_2</title>
<path fill="none" stroke="black" d="M4745.24,-1648.81C4880.42,-1642.97 5174.55,-1629.84 5422.5,-1616 5551.77,-1608.79 5589.49,-1626.54 5719.84,-1596.88"/>
<polygon fill="black" stroke="black" points="5720.86,-1600.24 5729.81,-1594.57 5719.27,-1593.42 5720.86,-1600.24"/>
</g>
<!-- k_proj_3_2_2 -->
<g id="node316" class="node">
<title>k_proj_3_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="6094,-1597 5921,-1597 5921,-1514 6094,-1514 6094,-1597"/>
<text text-anchor="middle" x="6007.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6007.5" y="-1566.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="6007.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6007.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6007.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_2_2 -->
<g id="edge655" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_2_2</title>
<path fill="none" stroke="black" d="M4745.23,-1652.18C4974.8,-1652.19 5668.36,-1648.04 5910.99,-1596.79"/>
<polygon fill="black" stroke="black" points="5911.81,-1600.19 5920.82,-1594.63 5910.3,-1593.36 5911.81,-1600.19"/>
</g>
<!-- v_proj_3_2_2 -->
<g id="node317" class="node">
<title>v_proj_3_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="6285,-1597 6112,-1597 6112,-1514 6285,-1514 6285,-1597"/>
<text text-anchor="middle" x="6198.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6198.5" y="-1566.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="6198.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6198.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6198.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_2_2 -->
<g id="edge656" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_2_2</title>
<path fill="none" stroke="black" d="M4745.03,-1650.48C4926.74,-1646.6 5407.05,-1635.23 5807.5,-1616 5935.53,-1609.85 5972.82,-1626.34 6101.94,-1596.86"/>
<polygon fill="black" stroke="black" points="6102.86,-1600.24 6111.81,-1594.56 6101.27,-1593.43 6102.86,-1600.24"/>
</g>
<!-- q_proj_3_2_3 -->
<g id="node318" class="node">
<title>q_proj_3_2_3</title>
<polygon fill="#aaffff" stroke="black" points="6476,-1597 6303,-1597 6303,-1514 6476,-1514 6476,-1597"/>
<text text-anchor="middle" x="6389.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6389.5" y="-1566.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="6389.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6389.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6389.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_2_3 -->
<g id="edge657" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_2_3</title>
<path fill="none" stroke="black" d="M4745.06,-1650.35C4937.41,-1645.97 5466.22,-1633.22 5906.5,-1616 6075.3,-1609.4 6123.76,-1634.3 6292.84,-1596.88"/>
<polygon fill="black" stroke="black" points="6293.84,-1600.24 6302.82,-1594.63 6292.3,-1593.41 6293.84,-1600.24"/>
</g>
<!-- k_proj_3_2_3 -->
<g id="node319" class="node">
<title>k_proj_3_2_3</title>
<polygon fill="#aaffff" stroke="black" points="6667,-1597 6494,-1597 6494,-1514 6667,-1514 6667,-1597"/>
<text text-anchor="middle" x="6580.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6580.5" y="-1566.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="6580.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6580.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6580.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_2_3 -->
<g id="edge658" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_2_3</title>
<path fill="none" stroke="black" d="M4745.05,-1650.56C4953.05,-1646.44 5557.46,-1633.73 6059.5,-1616 6245.23,-1609.44 6298.26,-1637.63 6484.01,-1596.83"/>
<polygon fill="black" stroke="black" points="6484.83,-1600.24 6493.83,-1594.64 6483.3,-1593.41 6484.83,-1600.24"/>
</g>
<!-- v_proj_3_2_3 -->
<g id="node320" class="node">
<title>v_proj_3_2_3</title>
<polygon fill="#aaffff" stroke="black" points="6858,-1597 6685,-1597 6685,-1514 6858,-1514 6858,-1597"/>
<text text-anchor="middle" x="6771.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6771.5" y="-1566.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="6771.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6771.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6771.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_2_3 -->
<g id="edge659" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_2_3</title>
<path fill="none" stroke="black" d="M4745.35,-1650.81C4970.46,-1647.1 5661.1,-1634.89 6233.5,-1616 6426.76,-1609.62 6481.84,-1639.11 6674.93,-1596.85"/>
<polygon fill="black" stroke="black" points="6675.83,-1600.24 6684.83,-1594.65 6674.31,-1593.41 6675.83,-1600.24"/>
</g>
<!-- q_proj_3_3_0 -->
<g id="node321" class="node">
<title>q_proj_3_3_0</title>
<polygon fill="#ff8888" stroke="black" points="7049,-1597 6876,-1597 6876,-1514 7049,-1514 7049,-1597"/>
<text text-anchor="middle" x="6962.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6962.5" y="-1566.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="6962.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6962.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="6962.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_3_0 -->
<g id="edge660" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_3_0</title>
<path fill="none" stroke="black" d="M4745.31,-1651.03C4986.92,-1647.76 5768.25,-1636.25 6414.5,-1616 6612.23,-1609.8 6668.5,-1640 6866.01,-1596.83"/>
<polygon fill="black" stroke="black" points="6866.82,-1600.24 6875.83,-1594.65 6865.31,-1593.41 6866.82,-1600.24"/>
</g>
<!-- k_proj_3_3_0 -->
<g id="node322" class="node">
<title>k_proj_3_3_0</title>
<polygon fill="#ff8888" stroke="black" points="7240,-1597 7067,-1597 7067,-1514 7240,-1514 7240,-1597"/>
<text text-anchor="middle" x="7153.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7153.5" y="-1566.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="7153.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7153.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7153.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_3_0 -->
<g id="edge661" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_3_0</title>
<path fill="none" stroke="black" d="M4745.15,-1651.23C5002.94,-1648.45 5879.67,-1637.88 6603.5,-1616 6802.11,-1610 6858.62,-1640.18 7056.97,-1596.84"/>
<polygon fill="black" stroke="black" points="7057.82,-1600.24 7066.83,-1594.66 7056.31,-1593.41 7057.82,-1600.24"/>
</g>
<!-- v_proj_3_3_0 -->
<g id="node323" class="node">
<title>v_proj_3_3_0</title>
<polygon fill="#ff8888" stroke="black" points="7431,-1597 7258,-1597 7258,-1514 7431,-1514 7431,-1597"/>
<text text-anchor="middle" x="7344.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7344.5" y="-1566.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="7344.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7344.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7344.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_3_0 -->
<g id="edge662" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_3_0</title>
<path fill="none" stroke="black" d="M4745.26,-1651.4C5018.87,-1649.07 5991.62,-1639.54 6793.5,-1616 6992.55,-1610.16 7049.18,-1640.27 7247.95,-1596.85"/>
<polygon fill="black" stroke="black" points="7248.82,-1600.24 7257.83,-1594.66 7247.31,-1593.41 7248.82,-1600.24"/>
</g>
<!-- q_proj_3_3_1 -->
<g id="node324" class="node">
<title>q_proj_3_3_1</title>
<polygon fill="#88ff88" stroke="black" points="7622,-1597 7449,-1597 7449,-1514 7622,-1514 7622,-1597"/>
<text text-anchor="middle" x="7535.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7535.5" y="-1566.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="7535.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7535.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7535.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_3_1 -->
<g id="edge663" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_3_1</title>
<path fill="none" stroke="black" d="M4745.4,-1651.54C5034.21,-1649.64 6103.33,-1641.18 6983.5,-1616 7182.99,-1610.29 7239.75,-1640.36 7438.93,-1596.85"/>
<polygon fill="black" stroke="black" points="7439.82,-1600.24 7448.83,-1594.66 7438.31,-1593.41 7439.82,-1600.24"/>
</g>
<!-- k_proj_3_3_1 -->
<g id="node325" class="node">
<title>k_proj_3_3_1</title>
<polygon fill="#88ff88" stroke="black" points="7813,-1597 7640,-1597 7640,-1514 7813,-1514 7813,-1597"/>
<text text-anchor="middle" x="7726.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7726.5" y="-1566.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="7726.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7726.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7726.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_3_1 -->
<g id="edge664" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_3_1</title>
<path fill="none" stroke="black" d="M4745.03,-1651.67C5047.74,-1650.17 6214.86,-1642.89 7174.5,-1616 7374,-1610.41 7430.75,-1640.36 7629.93,-1596.85"/>
<polygon fill="black" stroke="black" points="7630.82,-1600.24 7639.83,-1594.66 7629.31,-1593.41 7630.82,-1600.24"/>
</g>
<!-- v_proj_3_3_1 -->
<g id="node326" class="node">
<title>v_proj_3_3_1</title>
<polygon fill="#88ff88" stroke="black" points="8004,-1597 7831,-1597 7831,-1514 8004,-1514 8004,-1597"/>
<text text-anchor="middle" x="7917.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7917.5" y="-1566.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="7917.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7917.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7917.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_3_1 -->
<g id="edge665" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_3_1</title>
<path fill="none" stroke="black" d="M4745,-1651.78C5061.57,-1650.67 6326.52,-1644.58 7365.5,-1616 7565,-1610.51 7621.75,-1640.36 7820.93,-1596.85"/>
<polygon fill="black" stroke="black" points="7821.82,-1600.24 7830.83,-1594.66 7820.31,-1593.41 7821.82,-1600.24"/>
</g>
<!-- q_proj_3_3_2 -->
<g id="node327" class="node">
<title>q_proj_3_3_2</title>
<polygon fill="#8888ff" stroke="black" points="8195,-1597 8022,-1597 8022,-1514 8195,-1514 8195,-1597"/>
<text text-anchor="middle" x="8108.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8108.5" y="-1566.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="8108.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8108.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8108.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_3_2 -->
<g id="edge666" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_3_2</title>
<path fill="none" stroke="black" d="M4745.21,-1651.87C5075.56,-1651.12 6438.25,-1646.27 7556.5,-1616 7756,-1610.6 7812.75,-1640.37 8011.93,-1596.85"/>
<polygon fill="black" stroke="black" points="8012.82,-1600.24 8021.83,-1594.66 8011.31,-1593.41 8012.82,-1600.24"/>
</g>
<!-- k_proj_3_3_2 -->
<g id="node328" class="node">
<title>k_proj_3_3_2</title>
<polygon fill="#8888ff" stroke="black" points="8386,-1597 8213,-1597 8213,-1514 8386,-1514 8386,-1597"/>
<text text-anchor="middle" x="8299.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8299.5" y="-1566.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="8299.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8299.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8299.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_3_2 -->
<g id="edge667" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_3_2</title>
<path fill="none" stroke="black" d="M4745.2,-1651.95C5088.53,-1651.55 6549.56,-1647.96 7747.5,-1616 7947,-1610.68 8003.75,-1640.37 8202.93,-1596.85"/>
<polygon fill="black" stroke="black" points="8203.82,-1600.24 8212.83,-1594.66 8202.31,-1593.41 8203.82,-1600.24"/>
</g>
<!-- v_proj_3_3_2 -->
<g id="node329" class="node">
<title>v_proj_3_3_2</title>
<polygon fill="#8888ff" stroke="black" points="8577,-1597 8404,-1597 8404,-1514 8577,-1514 8577,-1597"/>
<text text-anchor="middle" x="8490.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8490.5" y="-1566.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="8490.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8490.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8490.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_3_2 -->
<g id="edge668" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_3_2</title>
<path fill="none" stroke="black" d="M4745.03,-1652.02C5100.64,-1651.96 6660.53,-1649.66 7938.5,-1616 8138,-1610.75 8194.75,-1640.37 8393.93,-1596.85"/>
<polygon fill="black" stroke="black" points="8394.82,-1600.24 8403.83,-1594.66 8393.31,-1593.41 8394.82,-1600.24"/>
</g>
<!-- q_proj_3_3_3 -->
<g id="node330" class="node">
<title>q_proj_3_3_3</title>
<polygon fill="#ffff88" stroke="black" points="8768,-1597 8595,-1597 8595,-1514 8768,-1514 8768,-1597"/>
<text text-anchor="middle" x="8681.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8681.5" y="-1566.8" font-family="monospace" font-size="14.00">Q Proj</text>
<text text-anchor="middle" x="8681.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8681.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8681.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_3_3 -->
<g id="edge669" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_3_3</title>
<path fill="none" stroke="black" d="M4745.06,-1652.08C5112.95,-1652.32 6771.58,-1651.29 8129.5,-1616 8329.44,-1610.8 8386.39,-1640.82 8585.07,-1597.09"/>
<polygon fill="black" stroke="black" points="8585.95,-1600.48 8594.94,-1594.88 8584.42,-1593.64 8585.95,-1600.48"/>
</g>
<!-- k_proj_3_3_3 -->
<g id="node331" class="node">
<title>k_proj_3_3_3</title>
<polygon fill="#ffff88" stroke="black" points="8959,-1597 8786,-1597 8786,-1514 8959,-1514 8959,-1597"/>
<text text-anchor="middle" x="8872.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8872.5" y="-1566.8" font-family="monospace" font-size="14.00">K Proj</text>
<text text-anchor="middle" x="8872.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8872.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="8872.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_3_3 -->
<g id="edge670" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_3_3</title>
<path fill="none" stroke="black" d="M4745.04,-1652.14C5124.81,-1652.68 6882.45,-1652.98 8320.5,-1616 8520.44,-1610.86 8577.39,-1640.82 8776.07,-1597.09"/>
<polygon fill="black" stroke="black" points="8776.95,-1600.48 8785.94,-1594.88 8775.42,-1593.64 8776.95,-1600.48"/>
</g>
<!-- v_proj_3_3_3 -->
<g id="node332" class="node">
<title>v_proj_3_3_3</title>
<polygon fill="#ffff88" stroke="black" points="9150,-1597 8977,-1597 8977,-1514 9150,-1514 9150,-1597"/>
<text text-anchor="middle" x="9063.5" y="-1581.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="9063.5" y="-1566.8" font-family="monospace" font-size="14.00">V Proj</text>
<text text-anchor="middle" x="9063.5" y="-1551.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="9063.5" y="-1536.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="9063.5" y="-1521.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_3_3 -->
<g id="edge671" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_3_3</title>
<path fill="none" stroke="black" d="M4745.03,-1652.19C5136.35,-1653.03 6993.2,-1654.67 8511.5,-1616 8711.45,-1610.91 8768.39,-1640.82 8967.07,-1597.09"/>
<polygon fill="black" stroke="black" points="8967.95,-1600.48 8976.94,-1594.88 8966.42,-1593.64 8967.95,-1600.48"/>
</g>
<!-- ln2_3 -->
<g id="node370" class="node">
<title>ln2_3</title>
<polygon fill="lightgray" stroke="black" points="7614,-690 7465,-690 7465,-652 7614,-652 7614,-690"/>
<text text-anchor="middle" x="7539.5" y="-674.8" font-family="monospace" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="7539.5" y="-659.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- add_3&#45;&gt;ln2_3 -->
<g id="edge821" class="edge">
<title>add_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M7559.39,-731.85C7555.52,-720.22 7551.86,-709.21 7548.76,-699.87"/>
<polygon fill="black" stroke="black" points="7551.99,-698.48 7545.51,-690.09 7545.34,-700.68 7551.99,-698.48"/>
</g>
<!-- add2_3 -->
<g id="node371" class="node">
<title>add2_3</title>
<ellipse fill="lightgray" stroke="black" cx="7538.5" cy="-196.5" rx="105.5" ry="105.5"/>
<text text-anchor="middle" x="7538.5" y="-207.8" font-family="monospace" font-size="14.00">Add</text>
<text text-anchor="middle" x="7538.5" y="-192.8" font-family="monospace" font-size="14.00">Residual</text>
<text text-anchor="middle" x="7538.5" y="-177.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- add_3&#45;&gt;add2_3 -->
<g id="edge822" class="edge">
<title>add_3&#45;&gt;add2_3</title>
<path fill="none" stroke="black" d="M7635.83,-736.23C7642.11,-715.48 7646.5,-693.34 7646.5,-672 7646.5,-672 7646.5,-672 7646.5,-386 7646.5,-350.3 7631.73,-315.23 7613.12,-285.2"/>
<polygon fill="black" stroke="black" points="7615.86,-282.98 7607.51,-276.46 7609.97,-286.77 7615.86,-282.98"/>
</g>
<!-- attn_3_0_0 -->
<g id="node333" class="node">
<title>attn_3_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="345,-1463 246,-1463 246,-1395 345,-1395 345,-1463"/>
<text text-anchor="middle" x="295.5" y="-1447.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="295.5" y="-1432.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="295.5" y="-1417.8" font-family="monospace" font-size="14.00">Heads[0&#45;3]</text>
<text text-anchor="middle" x="295.5" y="-1402.8" font-family="monospace" font-size="14.00">Dim[0&#45;127]</text>
</g>
<!-- q_proj_3_0_0&#45;&gt;attn_3_0_0 -->
<g id="edge672" class="edge">
<title>q_proj_3_0_0&#45;&gt;attn_3_0_0</title>
<path fill="none" stroke="black" d="M114.9,-1513.77C124.75,-1501.92 136.59,-1489.81 149.5,-1481 175.48,-1463.26 208.27,-1451.07 236.19,-1443.07"/>
<polygon fill="black" stroke="black" points="237.13,-1446.45 245.84,-1440.42 235.27,-1439.7 237.13,-1446.45"/>
</g>
<!-- q_proj_3_0_0&#45;&gt;attn_3_0_0 -->
<g id="edge673" class="edge">
<title>q_proj_3_0_0&#45;&gt;attn_3_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M152,-1513.91C169.63,-1503.11 188.74,-1491.52 206.5,-1481 216.34,-1475.17 226.83,-1469.06 237.05,-1463.17"/>
<polygon fill="red" stroke="red" points="239,-1466.09 245.92,-1458.07 235.51,-1460.02 239,-1466.09"/>
<text text-anchor="middle" x="244.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_3_0_0&#45;&gt;attn_3_0_0 -->
<g id="edge674" class="edge">
<title>k_proj_3_0_0&#45;&gt;attn_3_0_0</title>
<path fill="none" stroke="black" d="M283.39,-1513.73C285.25,-1500.86 287.32,-1486.6 289.2,-1473.54"/>
<polygon fill="black" stroke="black" points="292.71,-1473.78 290.67,-1463.38 285.78,-1472.78 292.71,-1473.78"/>
</g>
<!-- k_proj_3_0_0&#45;&gt;attn_3_0_0 -->
<g id="edge675" class="edge">
<title>k_proj_3_0_0&#45;&gt;attn_3_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M294.13,-1513.75C295.93,-1507.88 297.48,-1501.85 298.5,-1496 299.77,-1488.7 300.21,-1480.88 300.15,-1473.26"/>
<polygon fill="red" stroke="red" points="303.65,-1472.95 299.8,-1463.08 296.65,-1473.19 303.65,-1472.95"/>
<text text-anchor="middle" x="338.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_3_0_0&#45;&gt;attn_3_0_0 -->
<g id="edge676" class="edge">
<title>v_proj_3_0_0&#45;&gt;attn_3_0_0</title>
<path fill="none" stroke="black" d="M422.53,-1513.82C409.3,-1502.74 394.61,-1491.04 380.5,-1481 372.1,-1475.03 362.99,-1469.06 353.94,-1463.42"/>
<polygon fill="black" stroke="black" points="355.68,-1460.38 345.32,-1458.13 352.01,-1466.34 355.68,-1460.38"/>
</g>
<!-- v_proj_3_0_0&#45;&gt;attn_3_0_0 -->
<g id="edge677" class="edge">
<title>v_proj_3_0_0&#45;&gt;attn_3_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M437.75,-1513.86C427.69,-1502.28 415.9,-1490.31 403.5,-1481 388.67,-1469.87 371.02,-1460.29 354.33,-1452.54"/>
<polygon fill="red" stroke="red" points="355.74,-1449.33 345.18,-1448.42 352.86,-1455.71 355.74,-1449.33"/>
<text text-anchor="middle" x="458.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_3_0_1 -->
<g id="node336" class="node">
<title>attn_3_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="924.5,-1463 808.5,-1463 808.5,-1395 924.5,-1395 924.5,-1463"/>
<text text-anchor="middle" x="866.5" y="-1447.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="866.5" y="-1432.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="866.5" y="-1417.8" font-family="monospace" font-size="14.00">Heads[0&#45;3]</text>
<text text-anchor="middle" x="866.5" y="-1402.8" font-family="monospace" font-size="14.00">Dim[128&#45;255]</text>
</g>
<!-- q_proj_3_0_1&#45;&gt;attn_3_0_1 -->
<g id="edge681" class="edge">
<title>q_proj_3_0_1&#45;&gt;attn_3_0_1</title>
<path fill="none" stroke="black" d="M678.58,-1513.87C685.88,-1501.89 695.21,-1489.68 706.5,-1481 732.98,-1460.65 767.8,-1448.3 798.19,-1440.87"/>
<polygon fill="black" stroke="black" points="799.35,-1444.19 808.31,-1438.53 797.78,-1437.37 799.35,-1444.19"/>
</g>
<!-- q_proj_3_0_1&#45;&gt;attn_3_0_1 -->
<g id="edge682" class="edge">
<title>q_proj_3_0_1&#45;&gt;attn_3_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M724.46,-1513.92C741.94,-1503.13 760.89,-1491.54 778.5,-1481 785.32,-1476.92 792.46,-1472.7 799.6,-1468.51"/>
<polygon fill="red" stroke="red" points="801.75,-1471.31 808.61,-1463.24 798.21,-1465.26 801.75,-1471.31"/>
<text text-anchor="middle" x="816.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_3_0_1&#45;&gt;attn_3_0_1 -->
<g id="edge683" class="edge">
<title>k_proj_3_0_1&#45;&gt;attn_3_0_1</title>
<path fill="none" stroke="black" d="M855.74,-1513.73C857.39,-1500.86 859.23,-1486.6 860.9,-1473.54"/>
<polygon fill="black" stroke="black" points="864.41,-1473.74 862.21,-1463.38 857.46,-1472.85 864.41,-1473.74"/>
</g>
<!-- k_proj_3_0_1&#45;&gt;attn_3_0_1 -->
<g id="edge684" class="edge">
<title>k_proj_3_0_1&#45;&gt;attn_3_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M868.7,-1513.85C870.68,-1507.96 872.38,-1501.9 873.5,-1496 874.89,-1488.68 875.13,-1480.86 874.71,-1473.24"/>
<polygon fill="red" stroke="red" points="878.18,-1472.7 873.78,-1463.05 871.21,-1473.33 878.18,-1472.7"/>
<text text-anchor="middle" x="913.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_3_0_1&#45;&gt;attn_3_0_1 -->
<g id="edge685" class="edge">
<title>v_proj_3_0_1&#45;&gt;attn_3_0_1</title>
<path fill="none" stroke="black" d="M997.25,-1513.95C984.21,-1502.75 969.63,-1490.95 955.5,-1481 948.59,-1476.13 941.19,-1471.32 933.71,-1466.71"/>
<polygon fill="black" stroke="black" points="935.29,-1463.57 924.93,-1461.39 931.67,-1469.56 935.29,-1463.57"/>
</g>
<!-- v_proj_3_0_1&#45;&gt;attn_3_0_1 -->
<g id="edge686" class="edge">
<title>v_proj_3_0_1&#45;&gt;attn_3_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1012.54,-1513.67C1002.96,-1502.09 991.62,-1490.16 979.5,-1481 965.79,-1470.64 949.64,-1461.78 933.91,-1454.5"/>
<polygon fill="red" stroke="red" points="935.27,-1451.28 924.72,-1450.39 932.42,-1457.67 935.27,-1451.28"/>
<text text-anchor="middle" x="1033.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_3_0_2 -->
<g id="node338" class="node">
<title>attn_3_0_2</title>
<polygon fill="#ccccff" stroke="black" points="1481.5,-1463 1365.5,-1463 1365.5,-1395 1481.5,-1395 1481.5,-1463"/>
<text text-anchor="middle" x="1423.5" y="-1447.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1423.5" y="-1432.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="1423.5" y="-1417.8" font-family="monospace" font-size="14.00">Heads[0&#45;3]</text>
<text text-anchor="middle" x="1423.5" y="-1402.8" font-family="monospace" font-size="14.00">Dim[256&#45;383]</text>
</g>
<!-- q_proj_3_0_2&#45;&gt;attn_3_0_2 -->
<g id="edge690" class="edge">
<title>q_proj_3_0_2&#45;&gt;attn_3_0_2</title>
<path fill="none" stroke="black" d="M1260.31,-1513.66C1269.78,-1501.94 1281.14,-1489.94 1293.5,-1481 1312.07,-1467.57 1334.65,-1457.11 1355.75,-1449.25"/>
<polygon fill="black" stroke="black" points="1357.08,-1452.49 1365.32,-1445.82 1354.72,-1445.9 1357.08,-1452.49"/>
</g>
<!-- q_proj_3_0_2&#45;&gt;attn_3_0_2 -->
<g id="edge691" class="edge">
<title>q_proj_3_0_2&#45;&gt;attn_3_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1293.44,-1513.87C1309.67,-1503.13 1327.22,-1491.58 1343.5,-1481 1349.67,-1476.99 1356.13,-1472.83 1362.58,-1468.68"/>
<polygon fill="red" stroke="red" points="1364.81,-1471.41 1371.35,-1463.06 1361.04,-1465.51 1364.81,-1471.41"/>
<text text-anchor="middle" x="1381.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_3_0_2&#45;&gt;attn_3_0_2 -->
<g id="edge692" class="edge">
<title>k_proj_3_0_2&#45;&gt;attn_3_0_2</title>
<path fill="none" stroke="black" d="M1423.5,-1513.73C1423.5,-1500.86 1423.5,-1486.6 1423.5,-1473.54"/>
<polygon fill="black" stroke="black" points="1427,-1473.38 1423.5,-1463.38 1420,-1473.38 1427,-1473.38"/>
</g>
<!-- k_proj_3_0_2&#45;&gt;attn_3_0_2 -->
<g id="edge693" class="edge">
<title>k_proj_3_0_2&#45;&gt;attn_3_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1436.01,-1513.81C1437.97,-1503.17 1438.94,-1491.68 1437.5,-1481 1437.16,-1478.45 1436.72,-1475.85 1436.22,-1473.24"/>
<polygon fill="red" stroke="red" points="1439.57,-1472.21 1433.99,-1463.2 1432.74,-1473.72 1439.57,-1472.21"/>
<text text-anchor="middle" x="1476.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_3_0_2&#45;&gt;attn_3_0_2 -->
<g id="edge694" class="edge">
<title>v_proj_3_0_2&#45;&gt;attn_3_0_2</title>
<path fill="none" stroke="black" d="M1564.29,-1513.64C1549.85,-1502.56 1533.84,-1490.9 1518.5,-1481 1509.59,-1475.25 1499.97,-1469.55 1490.39,-1464.15"/>
<polygon fill="black" stroke="black" points="1492.07,-1461.08 1481.63,-1459.29 1488.67,-1467.2 1492.07,-1461.08"/>
</g>
<!-- v_proj_3_0_2&#45;&gt;attn_3_0_2 -->
<g id="edge695" class="edge">
<title>v_proj_3_0_2&#45;&gt;attn_3_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1580.62,-1513.66C1569.62,-1502.08 1556.8,-1490.15 1543.5,-1481 1527.68,-1470.13 1509.18,-1460.86 1491.5,-1453.33"/>
<polygon fill="red" stroke="red" points="1492.37,-1449.9 1481.79,-1449.33 1489.7,-1456.37 1492.37,-1449.9"/>
<text text-anchor="middle" x="1599.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_3_0_3 -->
<g id="node340" class="node">
<title>attn_3_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="1890.5,-1463 1774.5,-1463 1774.5,-1395 1890.5,-1395 1890.5,-1463"/>
<text text-anchor="middle" x="1832.5" y="-1447.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1832.5" y="-1432.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="1832.5" y="-1417.8" font-family="monospace" font-size="14.00">Heads[0&#45;3]</text>
<text text-anchor="middle" x="1832.5" y="-1402.8" font-family="monospace" font-size="14.00">Dim[384&#45;511]</text>
</g>
<!-- q_proj_3_0_3&#45;&gt;attn_3_0_3 -->
<g id="edge699" class="edge">
<title>q_proj_3_0_3&#45;&gt;attn_3_0_3</title>
<path fill="none" stroke="black" d="M1814.34,-1513.73C1817.16,-1500.74 1820.29,-1486.31 1823.14,-1473.15"/>
<polygon fill="black" stroke="black" points="1826.56,-1473.89 1825.26,-1463.38 1819.72,-1472.41 1826.56,-1473.89"/>
</g>
<!-- q_proj_3_0_3&#45;&gt;attn_3_0_3 -->
<g id="edge700" class="edge">
<title>q_proj_3_0_3&#45;&gt;attn_3_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1828.57,-1513.84C1831.01,-1508.01 1833.1,-1501.96 1834.5,-1496 1836.19,-1488.79 1836.9,-1481.01 1837.01,-1473.41"/>
<polygon fill="red" stroke="red" points="1840.51,-1473.17 1836.84,-1463.23 1833.51,-1473.29 1840.51,-1473.17"/>
<text text-anchor="middle" x="1875.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_3_0_3&#45;&gt;attn_3_0_3 -->
<g id="edge701" class="edge">
<title>k_proj_3_0_3&#45;&gt;attn_3_0_3</title>
<path fill="none" stroke="black" d="M1956.11,-1513.89C1944.13,-1502.69 1930.67,-1490.91 1917.5,-1481 1911.73,-1476.66 1905.57,-1472.38 1899.31,-1468.24"/>
<polygon fill="black" stroke="black" points="1901.02,-1465.18 1890.72,-1462.71 1897.23,-1471.07 1901.02,-1465.18"/>
</g>
<!-- k_proj_3_0_3&#45;&gt;attn_3_0_3 -->
<g id="edge702" class="edge">
<title>k_proj_3_0_3&#45;&gt;attn_3_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1971.43,-1513.67C1962.95,-1502.09 1952.75,-1490.15 1941.5,-1481 1929.2,-1470.99 1914.62,-1462.44 1900.19,-1455.36"/>
<polygon fill="red" stroke="red" points="1901.29,-1452 1890.75,-1450.91 1898.3,-1458.34 1901.29,-1452"/>
<text text-anchor="middle" x="1994.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_3_0_3&#45;&gt;attn_3_0_3 -->
<g id="edge703" class="edge">
<title>v_proj_3_0_3&#45;&gt;attn_3_0_3</title>
<path fill="none" stroke="black" d="M2112.02,-1513.95C2088.3,-1502.24 2061.71,-1490.17 2036.5,-1481 1992.22,-1464.89 1940.74,-1452.06 1900.57,-1443.3"/>
<polygon fill="black" stroke="black" points="1901.13,-1439.84 1890.61,-1441.16 1899.66,-1446.68 1901.13,-1439.84"/>
</g>
<!-- v_proj_3_0_3&#45;&gt;attn_3_0_3 -->
<g id="edge704" class="edge">
<title>v_proj_3_0_3&#45;&gt;attn_3_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2130.59,-1513.89C2111.57,-1501.84 2089.78,-1489.58 2068.5,-1481 2014.23,-1459.13 1948.99,-1445.95 1900.87,-1438.48"/>
<polygon fill="red" stroke="red" points="1901.28,-1435 1890.87,-1436.97 1900.24,-1441.93 1901.28,-1435"/>
<text text-anchor="middle" x="2138.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_3_1_0 -->
<g id="node342" class="node">
<title>attn_3_1_0</title>
<polygon fill="#ffccff" stroke="black" points="2646,-1463 2547,-1463 2547,-1395 2646,-1395 2646,-1463"/>
<text text-anchor="middle" x="2596.5" y="-1447.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2596.5" y="-1432.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="2596.5" y="-1417.8" font-family="monospace" font-size="14.00">Heads[4&#45;7]</text>
<text text-anchor="middle" x="2596.5" y="-1402.8" font-family="monospace" font-size="14.00">Dim[0&#45;127]</text>
</g>
<!-- q_proj_3_1_0&#45;&gt;attn_3_1_0 -->
<g id="edge708" class="edge">
<title>q_proj_3_1_0&#45;&gt;attn_3_1_0</title>
<path fill="none" stroke="black" d="M2406.8,-1513.63C2416.65,-1501.77 2428.51,-1489.7 2441.5,-1481 2470.05,-1461.88 2506.34,-1449.43 2536.63,-1441.62"/>
<polygon fill="black" stroke="black" points="2537.78,-1444.94 2546.65,-1439.15 2536.1,-1438.15 2537.78,-1444.94"/>
</g>
<!-- q_proj_3_1_0&#45;&gt;attn_3_1_0 -->
<g id="edge709" class="edge">
<title>q_proj_3_1_0&#45;&gt;attn_3_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2445.8,-1513.98C2464.11,-1503.13 2484,-1491.5 2502.5,-1481 2513.82,-1474.57 2526,-1467.84 2537.71,-1461.45"/>
<polygon fill="red" stroke="red" points="2539.43,-1464.5 2546.55,-1456.65 2536.09,-1458.35 2539.43,-1464.5"/>
<text text-anchor="middle" x="2540.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_3_1_0&#45;&gt;attn_3_1_0 -->
<g id="edge710" class="edge">
<title>k_proj_3_1_0&#45;&gt;attn_3_1_0</title>
<path fill="none" stroke="black" d="M2578.34,-1513.73C2581.16,-1500.74 2584.29,-1486.31 2587.14,-1473.15"/>
<polygon fill="black" stroke="black" points="2590.56,-1473.89 2589.26,-1463.38 2583.72,-1472.41 2590.56,-1473.89"/>
</g>
<!-- k_proj_3_1_0&#45;&gt;attn_3_1_0 -->
<g id="edge711" class="edge">
<title>k_proj_3_1_0&#45;&gt;attn_3_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2592.57,-1513.84C2595.01,-1508.01 2597.1,-1501.96 2598.5,-1496 2600.19,-1488.79 2600.9,-1481.01 2601.01,-1473.41"/>
<polygon fill="red" stroke="red" points="2604.51,-1473.17 2600.84,-1463.23 2597.51,-1473.29 2604.51,-1473.17"/>
<text text-anchor="middle" x="2639.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_3_1_0&#45;&gt;attn_3_1_0 -->
<g id="edge712" class="edge">
<title>v_proj_3_1_0&#45;&gt;attn_3_1_0</title>
<path fill="none" stroke="black" d="M2720.11,-1513.89C2708.13,-1502.69 2694.67,-1490.91 2681.5,-1481 2673.16,-1474.73 2664.01,-1468.57 2654.89,-1462.82"/>
<polygon fill="black" stroke="black" points="2656.53,-1459.72 2646.18,-1457.44 2652.85,-1465.67 2656.53,-1459.72"/>
</g>
<!-- v_proj_3_1_0&#45;&gt;attn_3_1_0 -->
<g id="edge713" class="edge">
<title>v_proj_3_1_0&#45;&gt;attn_3_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2735.43,-1513.67C2726.95,-1502.09 2716.75,-1490.15 2705.5,-1481 2690.73,-1468.98 2672.67,-1459.06 2655.52,-1451.26"/>
<polygon fill="red" stroke="red" points="2656.68,-1447.95 2646.12,-1447.15 2653.88,-1454.36 2656.68,-1447.95"/>
<text text-anchor="middle" x="2758.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_3_1_1 -->
<g id="node345" class="node">
<title>attn_3_1_1</title>
<polygon fill="#ccffff" stroke="black" points="3227.5,-1463 3111.5,-1463 3111.5,-1395 3227.5,-1395 3227.5,-1463"/>
<text text-anchor="middle" x="3169.5" y="-1447.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3169.5" y="-1432.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3169.5" y="-1417.8" font-family="monospace" font-size="14.00">Heads[4&#45;7]</text>
<text text-anchor="middle" x="3169.5" y="-1402.8" font-family="monospace" font-size="14.00">Dim[128&#45;255]</text>
</g>
<!-- q_proj_3_1_1&#45;&gt;attn_3_1_1 -->
<g id="edge717" class="edge">
<title>q_proj_3_1_1&#45;&gt;attn_3_1_1</title>
<path fill="none" stroke="black" d="M2970.48,-1513.75C2977.77,-1501.76 2987.13,-1489.57 2998.5,-1481 3028.21,-1458.61 3067.67,-1446 3101.2,-1438.93"/>
<polygon fill="black" stroke="black" points="3102.27,-1442.28 3111.39,-1436.91 3100.9,-1435.42 3102.27,-1442.28"/>
</g>
<!-- q_proj_3_1_1&#45;&gt;attn_3_1_1 -->
<g id="edge718" class="edge">
<title>q_proj_3_1_1&#45;&gt;attn_3_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3018.8,-1513.98C3037.11,-1503.13 3057,-1491.5 3075.5,-1481 3084.16,-1476.09 3093.32,-1470.99 3102.38,-1466.01"/>
<polygon fill="red" stroke="red" points="3104.3,-1468.95 3111.39,-1461.08 3100.94,-1462.81 3104.3,-1468.95"/>
<text text-anchor="middle" x="3113.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_3_1_1&#45;&gt;attn_3_1_1 -->
<g id="edge719" class="edge">
<title>k_proj_3_1_1&#45;&gt;attn_3_1_1</title>
<path fill="none" stroke="black" d="M3151.34,-1513.73C3154.16,-1500.74 3157.29,-1486.31 3160.14,-1473.15"/>
<polygon fill="black" stroke="black" points="3163.56,-1473.89 3162.26,-1463.38 3156.72,-1472.41 3163.56,-1473.89"/>
</g>
<!-- k_proj_3_1_1&#45;&gt;attn_3_1_1 -->
<g id="edge720" class="edge">
<title>k_proj_3_1_1&#45;&gt;attn_3_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3165.57,-1513.84C3168.01,-1508.01 3170.1,-1501.96 3171.5,-1496 3173.19,-1488.79 3173.9,-1481.01 3174.01,-1473.41"/>
<polygon fill="red" stroke="red" points="3177.51,-1473.17 3173.84,-1463.23 3170.51,-1473.29 3177.51,-1473.17"/>
<text text-anchor="middle" x="3212.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_3_1_1&#45;&gt;attn_3_1_1 -->
<g id="edge721" class="edge">
<title>v_proj_3_1_1&#45;&gt;attn_3_1_1</title>
<path fill="none" stroke="black" d="M3293.11,-1513.89C3281.13,-1502.69 3267.67,-1490.91 3254.5,-1481 3248.73,-1476.66 3242.57,-1472.38 3236.31,-1468.24"/>
<polygon fill="black" stroke="black" points="3238.02,-1465.18 3227.72,-1462.71 3234.23,-1471.07 3238.02,-1465.18"/>
</g>
<!-- v_proj_3_1_1&#45;&gt;attn_3_1_1 -->
<g id="edge722" class="edge">
<title>v_proj_3_1_1&#45;&gt;attn_3_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3308.43,-1513.67C3299.95,-1502.09 3289.75,-1490.15 3278.5,-1481 3266.2,-1470.99 3251.62,-1462.44 3237.19,-1455.36"/>
<polygon fill="red" stroke="red" points="3238.29,-1452 3227.75,-1450.91 3235.3,-1458.34 3238.29,-1452"/>
<text text-anchor="middle" x="3331.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_3_1_2 -->
<g id="node347" class="node">
<title>attn_3_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="3773.5,-1463 3657.5,-1463 3657.5,-1395 3773.5,-1395 3773.5,-1463"/>
<text text-anchor="middle" x="3715.5" y="-1447.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="3715.5" y="-1432.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="3715.5" y="-1417.8" font-family="monospace" font-size="14.00">Heads[4&#45;7]</text>
<text text-anchor="middle" x="3715.5" y="-1402.8" font-family="monospace" font-size="14.00">Dim[256&#45;383]</text>
</g>
<!-- q_proj_3_1_2&#45;&gt;attn_3_1_2 -->
<g id="edge726" class="edge">
<title>q_proj_3_1_2&#45;&gt;attn_3_1_2</title>
<path fill="none" stroke="black" d="M3552.31,-1513.66C3561.78,-1501.94 3573.14,-1489.94 3585.5,-1481 3604.07,-1467.57 3626.65,-1457.11 3647.75,-1449.25"/>
<polygon fill="black" stroke="black" points="3649.08,-1452.49 3657.32,-1445.82 3646.72,-1445.9 3649.08,-1452.49"/>
</g>
<!-- q_proj_3_1_2&#45;&gt;attn_3_1_2 -->
<g id="edge727" class="edge">
<title>q_proj_3_1_2&#45;&gt;attn_3_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3585.44,-1513.87C3601.67,-1503.13 3619.22,-1491.58 3635.5,-1481 3641.67,-1476.99 3648.13,-1472.83 3654.58,-1468.68"/>
<polygon fill="red" stroke="red" points="3656.81,-1471.41 3663.35,-1463.06 3653.04,-1465.51 3656.81,-1471.41"/>
<text text-anchor="middle" x="3673.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_3_1_2&#45;&gt;attn_3_1_2 -->
<g id="edge728" class="edge">
<title>k_proj_3_1_2&#45;&gt;attn_3_1_2</title>
<path fill="none" stroke="black" d="M3715.5,-1513.73C3715.5,-1500.86 3715.5,-1486.6 3715.5,-1473.54"/>
<polygon fill="black" stroke="black" points="3719,-1473.38 3715.5,-1463.38 3712,-1473.38 3719,-1473.38"/>
</g>
<!-- k_proj_3_1_2&#45;&gt;attn_3_1_2 -->
<g id="edge729" class="edge">
<title>k_proj_3_1_2&#45;&gt;attn_3_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3728.01,-1513.81C3729.97,-1503.17 3730.94,-1491.68 3729.5,-1481 3729.16,-1478.45 3728.72,-1475.85 3728.22,-1473.24"/>
<polygon fill="red" stroke="red" points="3731.57,-1472.21 3725.99,-1463.2 3724.74,-1473.72 3731.57,-1472.21"/>
<text text-anchor="middle" x="3768.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_3_1_2&#45;&gt;attn_3_1_2 -->
<g id="edge730" class="edge">
<title>v_proj_3_1_2&#45;&gt;attn_3_1_2</title>
<path fill="none" stroke="black" d="M3856.29,-1513.64C3841.85,-1502.56 3825.84,-1490.9 3810.5,-1481 3801.59,-1475.25 3791.97,-1469.55 3782.39,-1464.15"/>
<polygon fill="black" stroke="black" points="3784.07,-1461.08 3773.63,-1459.29 3780.67,-1467.2 3784.07,-1461.08"/>
</g>
<!-- v_proj_3_1_2&#45;&gt;attn_3_1_2 -->
<g id="edge731" class="edge">
<title>v_proj_3_1_2&#45;&gt;attn_3_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3872.62,-1513.66C3861.62,-1502.08 3848.8,-1490.15 3835.5,-1481 3819.68,-1470.13 3801.18,-1460.86 3783.5,-1453.33"/>
<polygon fill="red" stroke="red" points="3784.37,-1449.9 3773.79,-1449.33 3781.7,-1456.37 3784.37,-1449.9"/>
<text text-anchor="middle" x="3891.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_3_1_3 -->
<g id="node349" class="node">
<title>attn_3_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="4182.5,-1463 4066.5,-1463 4066.5,-1395 4182.5,-1395 4182.5,-1463"/>
<text text-anchor="middle" x="4124.5" y="-1447.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="4124.5" y="-1432.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4124.5" y="-1417.8" font-family="monospace" font-size="14.00">Heads[4&#45;7]</text>
<text text-anchor="middle" x="4124.5" y="-1402.8" font-family="monospace" font-size="14.00">Dim[384&#45;511]</text>
</g>
<!-- q_proj_3_1_3&#45;&gt;attn_3_1_3 -->
<g id="edge735" class="edge">
<title>q_proj_3_1_3&#45;&gt;attn_3_1_3</title>
<path fill="none" stroke="black" d="M4106.34,-1513.73C4109.16,-1500.74 4112.29,-1486.31 4115.14,-1473.15"/>
<polygon fill="black" stroke="black" points="4118.56,-1473.89 4117.26,-1463.38 4111.72,-1472.41 4118.56,-1473.89"/>
</g>
<!-- q_proj_3_1_3&#45;&gt;attn_3_1_3 -->
<g id="edge736" class="edge">
<title>q_proj_3_1_3&#45;&gt;attn_3_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4120.57,-1513.84C4123.01,-1508.01 4125.1,-1501.96 4126.5,-1496 4128.19,-1488.79 4128.9,-1481.01 4129.01,-1473.41"/>
<polygon fill="red" stroke="red" points="4132.51,-1473.17 4128.84,-1463.23 4125.51,-1473.29 4132.51,-1473.17"/>
<text text-anchor="middle" x="4167.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_3_1_3&#45;&gt;attn_3_1_3 -->
<g id="edge737" class="edge">
<title>k_proj_3_1_3&#45;&gt;attn_3_1_3</title>
<path fill="none" stroke="black" d="M4248.11,-1513.89C4236.13,-1502.69 4222.67,-1490.91 4209.5,-1481 4203.73,-1476.66 4197.57,-1472.38 4191.31,-1468.24"/>
<polygon fill="black" stroke="black" points="4193.02,-1465.18 4182.72,-1462.71 4189.23,-1471.07 4193.02,-1465.18"/>
</g>
<!-- k_proj_3_1_3&#45;&gt;attn_3_1_3 -->
<g id="edge738" class="edge">
<title>k_proj_3_1_3&#45;&gt;attn_3_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4263.43,-1513.67C4254.95,-1502.09 4244.75,-1490.15 4233.5,-1481 4221.2,-1470.99 4206.62,-1462.44 4192.19,-1455.36"/>
<polygon fill="red" stroke="red" points="4193.29,-1452 4182.75,-1450.91 4190.3,-1458.34 4193.29,-1452"/>
<text text-anchor="middle" x="4286.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_3_1_3&#45;&gt;attn_3_1_3 -->
<g id="edge739" class="edge">
<title>v_proj_3_1_3&#45;&gt;attn_3_1_3</title>
<path fill="none" stroke="black" d="M4404.02,-1513.95C4380.3,-1502.24 4353.71,-1490.17 4328.5,-1481 4284.22,-1464.89 4232.74,-1452.06 4192.57,-1443.3"/>
<polygon fill="black" stroke="black" points="4193.13,-1439.84 4182.61,-1441.16 4191.66,-1446.68 4193.13,-1439.84"/>
</g>
<!-- v_proj_3_1_3&#45;&gt;attn_3_1_3 -->
<g id="edge740" class="edge">
<title>v_proj_3_1_3&#45;&gt;attn_3_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4422.59,-1513.89C4403.57,-1501.84 4381.78,-1489.58 4360.5,-1481 4306.23,-1459.13 4240.99,-1445.95 4192.87,-1438.48"/>
<polygon fill="red" stroke="red" points="4193.28,-1435 4182.87,-1436.97 4192.24,-1441.93 4193.28,-1435"/>
<text text-anchor="middle" x="4430.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_3_2_0 -->
<g id="node351" class="node">
<title>attn_3_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="4941,-1463 4834,-1463 4834,-1395 4941,-1395 4941,-1463"/>
<text text-anchor="middle" x="4887.5" y="-1447.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4887.5" y="-1432.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="4887.5" y="-1417.8" font-family="monospace" font-size="14.00">Heads[8&#45;11]</text>
<text text-anchor="middle" x="4887.5" y="-1402.8" font-family="monospace" font-size="14.00">Dim[0&#45;127]</text>
</g>
<!-- q_proj_3_2_0&#45;&gt;attn_3_2_0 -->
<g id="edge744" class="edge">
<title>q_proj_3_2_0&#45;&gt;attn_3_2_0</title>
<path fill="none" stroke="black" d="M4689.49,-1513.76C4696.78,-1501.77 4706.14,-1489.58 4717.5,-1481 4748.28,-1457.77 4789.59,-1445.06 4823.78,-1438.14"/>
<polygon fill="black" stroke="black" points="4824.51,-1441.56 4833.68,-1436.26 4823.2,-1434.69 4824.51,-1441.56"/>
</g>
<!-- q_proj_3_2_0&#45;&gt;attn_3_2_0 -->
<g id="edge745" class="edge">
<title>q_proj_3_2_0&#45;&gt;attn_3_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4738.16,-1513.84C4756.38,-1503.05 4776.13,-1491.48 4794.5,-1481 4804.27,-1475.43 4814.68,-1469.61 4824.86,-1463.98"/>
<polygon fill="red" stroke="red" points="4826.66,-1466.98 4833.73,-1459.09 4823.28,-1460.85 4826.66,-1466.98"/>
<text text-anchor="middle" x="4832.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_3_2_0&#45;&gt;attn_3_2_0 -->
<g id="edge746" class="edge">
<title>k_proj_3_2_0&#45;&gt;attn_3_2_0</title>
<path fill="none" stroke="black" d="M4870.01,-1513.73C4872.7,-1500.86 4875.68,-1486.6 4878.41,-1473.54"/>
<polygon fill="black" stroke="black" points="4881.91,-1473.88 4880.53,-1463.38 4875.06,-1472.45 4881.91,-1473.88"/>
</g>
<!-- k_proj_3_2_0&#45;&gt;attn_3_2_0 -->
<g id="edge747" class="edge">
<title>k_proj_3_2_0&#45;&gt;attn_3_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4883.77,-1513.79C4886.13,-1507.96 4888.15,-1501.93 4889.5,-1496 4891.14,-1488.78 4891.82,-1480.99 4891.93,-1473.39"/>
<polygon fill="red" stroke="red" points="4895.43,-1473.15 4891.75,-1463.21 4888.43,-1473.27 4895.43,-1473.15"/>
<text text-anchor="middle" x="4930.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_3_2_0&#45;&gt;attn_3_2_0 -->
<g id="edge748" class="edge">
<title>v_proj_3_2_0&#45;&gt;attn_3_2_0</title>
<path fill="none" stroke="black" d="M5011.54,-1513.92C4999.4,-1502.73 4985.8,-1490.94 4972.5,-1481 4965.31,-1475.63 4957.53,-1470.33 4949.68,-1465.3"/>
<polygon fill="black" stroke="black" points="4951.51,-1462.31 4941.18,-1459.95 4947.78,-1468.23 4951.51,-1462.31"/>
</g>
<!-- v_proj_3_2_0&#45;&gt;attn_3_2_0 -->
<g id="edge749" class="edge">
<title>v_proj_3_2_0&#45;&gt;attn_3_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5026.86,-1513.68C5018.22,-1502.1 5007.86,-1490.16 4996.5,-1481 4982.84,-1469.98 4966.4,-1460.7 4950.49,-1453.21"/>
<polygon fill="red" stroke="red" points="4951.76,-1449.94 4941.2,-1449 4948.87,-1456.32 4951.76,-1449.94"/>
<text text-anchor="middle" x="5049.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_3_2_1 -->
<g id="node354" class="node">
<title>attn_3_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="5518.5,-1463 5402.5,-1463 5402.5,-1395 5518.5,-1395 5518.5,-1463"/>
<text text-anchor="middle" x="5460.5" y="-1447.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5460.5" y="-1432.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5460.5" y="-1417.8" font-family="monospace" font-size="14.00">Heads[8&#45;11]</text>
<text text-anchor="middle" x="5460.5" y="-1402.8" font-family="monospace" font-size="14.00">Dim[128&#45;255]</text>
</g>
<!-- q_proj_3_2_1&#45;&gt;attn_3_2_1 -->
<g id="edge753" class="edge">
<title>q_proj_3_2_1&#45;&gt;attn_3_2_1</title>
<path fill="none" stroke="black" d="M5271.81,-1513.64C5281.66,-1501.79 5293.52,-1489.71 5306.5,-1481 5332.23,-1463.73 5364.29,-1451.89 5392.49,-1443.99"/>
<polygon fill="black" stroke="black" points="5393.53,-1447.34 5402.28,-1441.36 5391.72,-1440.58 5393.53,-1447.34"/>
</g>
<!-- q_proj_3_2_1&#45;&gt;attn_3_2_1 -->
<g id="edge754" class="edge">
<title>q_proj_3_2_1&#45;&gt;attn_3_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5311.16,-1513.84C5329.38,-1503.05 5349.13,-1491.48 5367.5,-1481 5375.81,-1476.26 5384.58,-1471.34 5393.27,-1466.52"/>
<polygon fill="red" stroke="red" points="5395.23,-1469.43 5402.29,-1461.53 5391.84,-1463.31 5395.23,-1469.43"/>
<text text-anchor="middle" x="5405.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_3_2_1&#45;&gt;attn_3_2_1 -->
<g id="edge755" class="edge">
<title>k_proj_3_2_1&#45;&gt;attn_3_2_1</title>
<path fill="none" stroke="black" d="M5443.01,-1513.73C5445.7,-1500.86 5448.68,-1486.6 5451.41,-1473.54"/>
<polygon fill="black" stroke="black" points="5454.91,-1473.88 5453.53,-1463.38 5448.06,-1472.45 5454.91,-1473.88"/>
</g>
<!-- k_proj_3_2_1&#45;&gt;attn_3_2_1 -->
<g id="edge756" class="edge">
<title>k_proj_3_2_1&#45;&gt;attn_3_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5456.77,-1513.79C5459.13,-1507.96 5461.15,-1501.93 5462.5,-1496 5464.14,-1488.78 5464.82,-1480.99 5464.93,-1473.39"/>
<polygon fill="red" stroke="red" points="5468.43,-1473.15 5464.75,-1463.21 5461.43,-1473.27 5468.43,-1473.15"/>
<text text-anchor="middle" x="5503.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_3_2_1&#45;&gt;attn_3_2_1 -->
<g id="edge757" class="edge">
<title>v_proj_3_2_1&#45;&gt;attn_3_2_1</title>
<path fill="none" stroke="black" d="M5584.54,-1513.92C5572.4,-1502.73 5558.8,-1490.94 5545.5,-1481 5539.72,-1476.68 5533.55,-1472.41 5527.28,-1468.28"/>
<polygon fill="black" stroke="black" points="5528.99,-1465.22 5518.68,-1462.75 5525.2,-1471.11 5528.99,-1465.22"/>
</g>
<!-- v_proj_3_2_1&#45;&gt;attn_3_2_1 -->
<g id="edge758" class="edge">
<title>v_proj_3_2_1&#45;&gt;attn_3_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5599.86,-1513.68C5591.22,-1502.1 5580.86,-1490.16 5569.5,-1481 5557.16,-1471.05 5542.56,-1462.52 5528.12,-1455.43"/>
<polygon fill="red" stroke="red" points="5529.22,-1452.08 5518.68,-1450.99 5526.24,-1458.42 5529.22,-1452.08"/>
<text text-anchor="middle" x="5622.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_3_2_2 -->
<g id="node356" class="node">
<title>attn_3_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="6057.5,-1463 5941.5,-1463 5941.5,-1395 6057.5,-1395 6057.5,-1463"/>
<text text-anchor="middle" x="5999.5" y="-1447.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5999.5" y="-1432.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="5999.5" y="-1417.8" font-family="monospace" font-size="14.00">Heads[8&#45;11]</text>
<text text-anchor="middle" x="5999.5" y="-1402.8" font-family="monospace" font-size="14.00">Dim[256&#45;383]</text>
</g>
<!-- q_proj_3_2_2&#45;&gt;attn_3_2_2 -->
<g id="edge762" class="edge">
<title>q_proj_3_2_2&#45;&gt;attn_3_2_2</title>
<path fill="none" stroke="black" d="M5844.43,-1513.83C5853.91,-1502.12 5865.24,-1490.07 5877.5,-1481 5893.76,-1468.97 5913.28,-1459.18 5931.89,-1451.51"/>
<polygon fill="black" stroke="black" points="5933.22,-1454.75 5941.22,-1447.8 5930.64,-1448.24 5933.22,-1454.75"/>
</g>
<!-- q_proj_3_2_2&#45;&gt;attn_3_2_2 -->
<g id="edge763" class="edge">
<title>q_proj_3_2_2&#45;&gt;attn_3_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5875.29,-1513.95C5890.93,-1503.2 5907.84,-1491.63 5923.5,-1481 5929.37,-1477.01 5935.51,-1472.86 5941.65,-1468.73"/>
<polygon fill="red" stroke="red" points="5943.64,-1471.61 5949.98,-1463.12 5939.73,-1465.8 5943.64,-1471.61"/>
<text text-anchor="middle" x="5961.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_3_2_2&#45;&gt;attn_3_2_2 -->
<g id="edge764" class="edge">
<title>k_proj_3_2_2&#45;&gt;attn_3_2_2</title>
<path fill="none" stroke="black" d="M6004.88,-1513.73C6004.05,-1500.86 6003.14,-1486.6 6002.3,-1473.54"/>
<polygon fill="black" stroke="black" points="6005.78,-1473.13 6001.64,-1463.38 5998.79,-1473.58 6005.78,-1473.13"/>
</g>
<!-- k_proj_3_2_2&#45;&gt;attn_3_2_2 -->
<g id="edge765" class="edge">
<title>k_proj_3_2_2&#45;&gt;attn_3_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6017.45,-1513.99C6018.88,-1503.24 6019.33,-1491.66 6017.5,-1481 6017.04,-1478.32 6016.45,-1475.59 6015.77,-1472.85"/>
<polygon fill="red" stroke="red" points="6019.08,-1471.69 6012.98,-1463.04 6012.35,-1473.61 6019.08,-1471.69"/>
<text text-anchor="middle" x="6057.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_3_2_2&#45;&gt;attn_3_2_2 -->
<g id="edge766" class="edge">
<title>v_proj_3_2_2&#45;&gt;attn_3_2_2</title>
<path fill="none" stroke="black" d="M6147.24,-1513.91C6132.21,-1502.72 6115.51,-1490.93 6099.5,-1481 6089.05,-1474.52 6077.67,-1468.13 6066.45,-1462.19"/>
<polygon fill="black" stroke="black" points="6068,-1459.05 6057.52,-1457.52 6064.76,-1465.25 6068,-1459.05"/>
</g>
<!-- v_proj_3_2_2&#45;&gt;attn_3_2_2 -->
<g id="edge767" class="edge">
<title>v_proj_3_2_2&#45;&gt;attn_3_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6163.97,-1513.93C6152.58,-1502.23 6139.28,-1490.16 6125.5,-1481 6107.77,-1469.21 6086.88,-1459.4 6067.27,-1451.63"/>
<polygon fill="red" stroke="red" points="6068.35,-1448.3 6057.76,-1447.98 6065.84,-1454.83 6068.35,-1448.3"/>
<text text-anchor="middle" x="6181.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_3_2_3 -->
<g id="node358" class="node">
<title>attn_3_2_3</title>
<polygon fill="#aaffff" stroke="black" points="6568.5,-1463 6452.5,-1463 6452.5,-1395 6568.5,-1395 6568.5,-1463"/>
<text text-anchor="middle" x="6510.5" y="-1447.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6510.5" y="-1432.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="6510.5" y="-1417.8" font-family="monospace" font-size="14.00">Heads[8&#45;11]</text>
<text text-anchor="middle" x="6510.5" y="-1402.8" font-family="monospace" font-size="14.00">Dim[384&#45;511]</text>
</g>
<!-- q_proj_3_2_3&#45;&gt;attn_3_2_3 -->
<g id="edge771" class="edge">
<title>q_proj_3_2_3&#45;&gt;attn_3_2_3</title>
<path fill="none" stroke="black" d="M6404.99,-1513.78C6410.61,-1502.33 6417.78,-1490.44 6426.5,-1481 6431.71,-1475.36 6437.68,-1470.13 6443.99,-1465.33"/>
<polygon fill="black" stroke="black" points="6446.04,-1468.17 6452.13,-1459.5 6441.96,-1462.48 6446.04,-1468.17"/>
</g>
<!-- q_proj_3_2_3&#45;&gt;attn_3_2_3 -->
<g id="edge772" class="edge">
<title>q_proj_3_2_3&#45;&gt;attn_3_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6427.84,-1513.89C6438.07,-1503.15 6449.16,-1491.59 6459.5,-1481 6462.88,-1477.54 6466.39,-1473.97 6469.93,-1470.39"/>
<polygon fill="red" stroke="red" points="6472.63,-1472.64 6477.19,-1463.08 6467.66,-1467.71 6472.63,-1472.64"/>
<text text-anchor="middle" x="6497.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_3_2_3&#45;&gt;attn_3_2_3 -->
<g id="edge773" class="edge">
<title>k_proj_3_2_3&#45;&gt;attn_3_2_3</title>
<path fill="none" stroke="black" d="M6557.58,-1513.73C6550.13,-1500.48 6541.84,-1485.75 6534.33,-1472.38"/>
<polygon fill="black" stroke="black" points="6537.22,-1470.38 6529.27,-1463.38 6531.12,-1473.81 6537.22,-1470.38"/>
</g>
<!-- k_proj_3_2_3&#45;&gt;attn_3_2_3 -->
<g id="edge774" class="edge">
<title>k_proj_3_2_3&#45;&gt;attn_3_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6571.27,-1513.86C6567.84,-1502.79 6563.32,-1491.07 6557.5,-1481 6555.61,-1477.73 6553.48,-1474.5 6551.2,-1471.34"/>
<polygon fill="red" stroke="red" points="6553.75,-1468.93 6544.85,-1463.19 6548.23,-1473.23 6553.75,-1468.93"/>
<text text-anchor="middle" x="6602.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_3_2_3&#45;&gt;attn_3_2_3 -->
<g id="edge775" class="edge">
<title>v_proj_3_2_3&#45;&gt;attn_3_2_3</title>
<path fill="none" stroke="black" d="M6706.01,-1513.91C6686.56,-1502.59 6664.97,-1490.74 6644.5,-1481 6623.35,-1470.94 6599.65,-1461.38 6578.13,-1453.32"/>
<polygon fill="black" stroke="black" points="6579.33,-1450.03 6568.74,-1449.85 6576.9,-1456.6 6579.33,-1450.03"/>
</g>
<!-- v_proj_3_2_3&#45;&gt;attn_3_2_3 -->
<g id="edge776" class="edge">
<title>v_proj_3_2_3&#45;&gt;attn_3_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6723.81,-1513.64C6708.47,-1501.92 6690.91,-1489.92 6673.5,-1481 6643.74,-1465.76 6608.58,-1454.05 6578.54,-1445.72"/>
<polygon fill="red" stroke="red" points="6579.13,-1442.25 6568.57,-1443.02 6577.31,-1449.01 6579.13,-1442.25"/>
<text text-anchor="middle" x="6735.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_3_3_0 -->
<g id="node360" class="node">
<title>attn_3_3_0</title>
<polygon fill="#ff8888" stroke="black" points="7238.5,-1463 7122.5,-1463 7122.5,-1395 7238.5,-1395 7238.5,-1463"/>
<text text-anchor="middle" x="7180.5" y="-1447.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7180.5" y="-1432.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7180.5" y="-1417.8" font-family="monospace" font-size="14.00">Heads[12&#45;15]</text>
<text text-anchor="middle" x="7180.5" y="-1402.8" font-family="monospace" font-size="14.00">Dim[0&#45;127]</text>
</g>
<!-- q_proj_3_3_0&#45;&gt;attn_3_3_0 -->
<g id="edge780" class="edge">
<title>q_proj_3_3_0&#45;&gt;attn_3_3_0</title>
<path fill="none" stroke="black" d="M6981.48,-1513.75C6988.77,-1501.76 6998.13,-1489.57 7009.5,-1481 7039.21,-1458.61 7078.67,-1446 7112.2,-1438.93"/>
<polygon fill="black" stroke="black" points="7113.27,-1442.28 7122.39,-1436.91 7111.9,-1435.42 7113.27,-1442.28"/>
</g>
<!-- q_proj_3_3_0&#45;&gt;attn_3_3_0 -->
<g id="edge781" class="edge">
<title>q_proj_3_3_0&#45;&gt;attn_3_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7029.8,-1513.98C7048.11,-1503.13 7068,-1491.5 7086.5,-1481 7095.16,-1476.09 7104.32,-1470.99 7113.38,-1466.01"/>
<polygon fill="red" stroke="red" points="7115.3,-1468.95 7122.39,-1461.08 7111.94,-1462.81 7115.3,-1468.95"/>
<text text-anchor="middle" x="7124.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_3_3_0&#45;&gt;attn_3_3_0 -->
<g id="edge782" class="edge">
<title>k_proj_3_3_0&#45;&gt;attn_3_3_0</title>
<path fill="none" stroke="black" d="M7162.34,-1513.73C7165.16,-1500.74 7168.29,-1486.31 7171.14,-1473.15"/>
<polygon fill="black" stroke="black" points="7174.56,-1473.89 7173.26,-1463.38 7167.72,-1472.41 7174.56,-1473.89"/>
</g>
<!-- k_proj_3_3_0&#45;&gt;attn_3_3_0 -->
<g id="edge783" class="edge">
<title>k_proj_3_3_0&#45;&gt;attn_3_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7176.57,-1513.84C7179.01,-1508.01 7181.1,-1501.96 7182.5,-1496 7184.19,-1488.79 7184.9,-1481.01 7185.01,-1473.41"/>
<polygon fill="red" stroke="red" points="7188.51,-1473.17 7184.84,-1463.23 7181.51,-1473.29 7188.51,-1473.17"/>
<text text-anchor="middle" x="7223.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_3_3_0&#45;&gt;attn_3_3_0 -->
<g id="edge784" class="edge">
<title>v_proj_3_3_0&#45;&gt;attn_3_3_0</title>
<path fill="none" stroke="black" d="M7304.11,-1513.89C7292.13,-1502.69 7278.67,-1490.91 7265.5,-1481 7259.73,-1476.66 7253.57,-1472.38 7247.31,-1468.24"/>
<polygon fill="black" stroke="black" points="7249.02,-1465.18 7238.72,-1462.71 7245.23,-1471.07 7249.02,-1465.18"/>
</g>
<!-- v_proj_3_3_0&#45;&gt;attn_3_3_0 -->
<g id="edge785" class="edge">
<title>v_proj_3_3_0&#45;&gt;attn_3_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7319.43,-1513.67C7310.95,-1502.09 7300.75,-1490.15 7289.5,-1481 7277.2,-1470.99 7262.62,-1462.44 7248.19,-1455.36"/>
<polygon fill="red" stroke="red" points="7249.29,-1452 7238.75,-1450.91 7246.3,-1458.34 7249.29,-1452"/>
<text text-anchor="middle" x="7342.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_3_3_1 -->
<g id="node363" class="node">
<title>attn_3_3_1</title>
<polygon fill="#88ff88" stroke="black" points="7784.5,-1463 7668.5,-1463 7668.5,-1395 7784.5,-1395 7784.5,-1463"/>
<text text-anchor="middle" x="7726.5" y="-1447.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7726.5" y="-1432.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="7726.5" y="-1417.8" font-family="monospace" font-size="14.00">Heads[12&#45;15]</text>
<text text-anchor="middle" x="7726.5" y="-1402.8" font-family="monospace" font-size="14.00">Dim[128&#45;255]</text>
</g>
<!-- q_proj_3_3_1&#45;&gt;attn_3_3_1 -->
<g id="edge789" class="edge">
<title>q_proj_3_3_1&#45;&gt;attn_3_3_1</title>
<path fill="none" stroke="black" d="M7553.83,-1513.68C7560.77,-1501.82 7569.67,-1489.74 7580.5,-1481 7602.83,-1462.99 7631.95,-1451.13 7658.31,-1443.42"/>
<polygon fill="black" stroke="black" points="7659.55,-1446.71 7668.26,-1440.67 7657.68,-1439.96 7659.55,-1446.71"/>
</g>
<!-- q_proj_3_3_1&#45;&gt;attn_3_3_1 -->
<g id="edge790" class="edge">
<title>q_proj_3_3_1&#45;&gt;attn_3_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7596.44,-1513.87C7612.67,-1503.13 7630.22,-1491.58 7646.5,-1481 7652.67,-1476.99 7659.13,-1472.83 7665.58,-1468.68"/>
<polygon fill="red" stroke="red" points="7667.81,-1471.41 7674.35,-1463.06 7664.04,-1465.51 7667.81,-1471.41"/>
<text text-anchor="middle" x="7684.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_3_3_1&#45;&gt;attn_3_3_1 -->
<g id="edge791" class="edge">
<title>k_proj_3_3_1&#45;&gt;attn_3_3_1</title>
<path fill="none" stroke="black" d="M7726.5,-1513.73C7726.5,-1500.86 7726.5,-1486.6 7726.5,-1473.54"/>
<polygon fill="black" stroke="black" points="7730,-1473.38 7726.5,-1463.38 7723,-1473.38 7730,-1473.38"/>
</g>
<!-- k_proj_3_3_1&#45;&gt;attn_3_3_1 -->
<g id="edge792" class="edge">
<title>k_proj_3_3_1&#45;&gt;attn_3_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7739.01,-1513.81C7740.97,-1503.17 7741.94,-1491.68 7740.5,-1481 7740.16,-1478.45 7739.72,-1475.85 7739.22,-1473.24"/>
<polygon fill="red" stroke="red" points="7742.57,-1472.21 7736.99,-1463.2 7735.74,-1473.72 7742.57,-1472.21"/>
<text text-anchor="middle" x="7779.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_3_3_1&#45;&gt;attn_3_3_1 -->
<g id="edge793" class="edge">
<title>v_proj_3_3_1&#45;&gt;attn_3_3_1</title>
<path fill="none" stroke="black" d="M7867.29,-1513.64C7852.85,-1502.56 7836.84,-1490.9 7821.5,-1481 7812.59,-1475.25 7802.97,-1469.55 7793.39,-1464.15"/>
<polygon fill="black" stroke="black" points="7795.07,-1461.08 7784.63,-1459.29 7791.67,-1467.2 7795.07,-1461.08"/>
</g>
<!-- v_proj_3_3_1&#45;&gt;attn_3_3_1 -->
<g id="edge794" class="edge">
<title>v_proj_3_3_1&#45;&gt;attn_3_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7883.62,-1513.66C7872.62,-1502.08 7859.8,-1490.15 7846.5,-1481 7830.68,-1470.13 7812.18,-1460.86 7794.5,-1453.33"/>
<polygon fill="red" stroke="red" points="7795.37,-1449.9 7784.79,-1449.33 7792.7,-1456.37 7795.37,-1449.9"/>
<text text-anchor="middle" x="7902.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_3_3_2 -->
<g id="node365" class="node">
<title>attn_3_3_2</title>
<polygon fill="#8888ff" stroke="black" points="8336.5,-1463 8220.5,-1463 8220.5,-1395 8336.5,-1395 8336.5,-1463"/>
<text text-anchor="middle" x="8278.5" y="-1447.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8278.5" y="-1432.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8278.5" y="-1417.8" font-family="monospace" font-size="14.00">Heads[12&#45;15]</text>
<text text-anchor="middle" x="8278.5" y="-1402.8" font-family="monospace" font-size="14.00">Dim[256&#45;383]</text>
</g>
<!-- q_proj_3_3_2&#45;&gt;attn_3_3_2 -->
<g id="edge798" class="edge">
<title>q_proj_3_3_2&#45;&gt;attn_3_3_2</title>
<path fill="none" stroke="black" d="M8132.6,-1513.87C8140.96,-1502.17 8151.13,-1490.11 8162.5,-1481 8176.84,-1469.51 8194.17,-1460.08 8211.02,-1452.6"/>
<polygon fill="black" stroke="black" points="8212.47,-1455.79 8220.3,-1448.65 8209.73,-1449.35 8212.47,-1455.79"/>
</g>
<!-- q_proj_3_3_2&#45;&gt;attn_3_3_2 -->
<g id="edge799" class="edge">
<title>q_proj_3_3_2&#45;&gt;attn_3_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8162.85,-1513.91C8177.33,-1503.16 8192.98,-1491.6 8207.5,-1481 8212.85,-1477.09 8218.45,-1473.03 8224.04,-1468.99"/>
<polygon fill="red" stroke="red" points="8226.15,-1471.78 8232.21,-1463.09 8222.05,-1466.1 8226.15,-1471.78"/>
<text text-anchor="middle" x="8245.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_3_3_2&#45;&gt;attn_3_3_2 -->
<g id="edge800" class="edge">
<title>k_proj_3_3_2&#45;&gt;attn_3_3_2</title>
<path fill="none" stroke="black" d="M8292.62,-1513.73C8290.45,-1500.86 8288.05,-1486.6 8285.84,-1473.54"/>
<polygon fill="black" stroke="black" points="8289.24,-1472.66 8284.13,-1463.38 8282.34,-1473.82 8289.24,-1472.66"/>
</g>
<!-- k_proj_3_3_2&#45;&gt;attn_3_3_2 -->
<g id="edge801" class="edge">
<title>k_proj_3_3_2&#45;&gt;attn_3_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8304.91,-1513.73C8305.32,-1502.98 8304.84,-1491.47 8302.5,-1481 8301.9,-1478.32 8301.14,-1475.61 8300.27,-1472.91"/>
<polygon fill="red" stroke="red" points="8303.45,-1471.42 8296.68,-1463.27 8296.89,-1473.87 8303.45,-1471.42"/>
<text text-anchor="middle" x="8343.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_3_3_2&#45;&gt;attn_3_3_2 -->
<g id="edge802" class="edge">
<title>v_proj_3_3_2&#45;&gt;attn_3_3_2</title>
<path fill="none" stroke="black" d="M8436.05,-1513.82C8420.11,-1502.63 8402.42,-1490.86 8385.5,-1481 8372.93,-1473.67 8359.15,-1466.51 8345.78,-1459.97"/>
<polygon fill="black" stroke="black" points="8347.13,-1456.73 8336.6,-1455.55 8344.09,-1463.04 8347.13,-1456.73"/>
</g>
<!-- v_proj_3_3_2&#45;&gt;attn_3_3_2 -->
<g id="edge803" class="edge">
<title>v_proj_3_3_2&#45;&gt;attn_3_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8452.78,-1513.89C8440.44,-1502.18 8426.12,-1490.12 8411.5,-1481 8391.49,-1468.52 8367.92,-1458.25 8346.23,-1450.29"/>
<polygon fill="red" stroke="red" points="8347.34,-1446.97 8336.74,-1446.91 8344.99,-1453.56 8347.34,-1446.97"/>
<text text-anchor="middle" x="8469.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- attn_3_3_3 -->
<g id="node367" class="node">
<title>attn_3_3_3</title>
<polygon fill="#ffff88" stroke="black" points="8873.5,-1463 8757.5,-1463 8757.5,-1395 8873.5,-1395 8873.5,-1463"/>
<text text-anchor="middle" x="8815.5" y="-1447.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8815.5" y="-1432.8" font-family="monospace" font-size="14.00">Attention</text>
<text text-anchor="middle" x="8815.5" y="-1417.8" font-family="monospace" font-size="14.00">Heads[12&#45;15]</text>
<text text-anchor="middle" x="8815.5" y="-1402.8" font-family="monospace" font-size="14.00">Dim[384&#45;511]</text>
</g>
<!-- q_proj_3_3_3&#45;&gt;attn_3_3_3 -->
<g id="edge807" class="edge">
<title>q_proj_3_3_3&#45;&gt;attn_3_3_3</title>
<path fill="none" stroke="black" d="M8706.71,-1513.71C8714.78,-1502.39 8724.29,-1490.58 8734.5,-1481 8739.03,-1476.74 8743.97,-1472.64 8749.09,-1468.74"/>
<polygon fill="black" stroke="black" points="8751.25,-1471.5 8757.28,-1462.79 8747.13,-1465.84 8751.25,-1471.5"/>
</g>
<!-- q_proj_3_3_3&#45;&gt;attn_3_3_3 -->
<g id="edge808" class="edge">
<title>q_proj_3_3_3&#45;&gt;attn_3_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8723.63,-1513.82C8734.89,-1503.07 8747.1,-1491.54 8758.5,-1481 8762.46,-1477.34 8766.6,-1473.56 8770.76,-1469.78"/>
<polygon fill="red" stroke="red" points="8773.17,-1472.32 8778.24,-1463.02 8768.48,-1467.13 8773.17,-1472.32"/>
<text text-anchor="middle" x="8796.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- k_proj_3_3_3&#45;&gt;attn_3_3_3 -->
<g id="edge809" class="edge">
<title>k_proj_3_3_3&#45;&gt;attn_3_3_3</title>
<path fill="none" stroke="black" d="M8853.84,-1513.73C8847.83,-1500.61 8841.15,-1486.03 8835.08,-1472.77"/>
<polygon fill="black" stroke="black" points="8838.13,-1471.01 8830.78,-1463.38 8831.76,-1473.93 8838.13,-1471.01"/>
</g>
<!-- k_proj_3_3_3&#45;&gt;attn_3_3_3 -->
<g id="edge810" class="edge">
<title>k_proj_3_3_3&#45;&gt;attn_3_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8866.4,-1513.75C8863.87,-1502.79 8860.36,-1491.16 8855.5,-1481 8854,-1477.86 8852.27,-1474.73 8850.41,-1471.66"/>
<polygon fill="red" stroke="red" points="8853.25,-1469.61 8844.81,-1463.2 8847.4,-1473.47 8853.25,-1469.61"/>
<text text-anchor="middle" x="8898.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- v_proj_3_3_3&#45;&gt;attn_3_3_3 -->
<g id="edge811" class="edge">
<title>v_proj_3_3_3&#45;&gt;attn_3_3_3</title>
<path fill="none" stroke="black" d="M8999.73,-1513.91C8980.98,-1502.65 8960.2,-1490.83 8940.5,-1481 8922.2,-1471.87 8901.85,-1463.03 8882.98,-1455.36"/>
<polygon fill="black" stroke="black" points="8884.14,-1452.05 8873.56,-1451.57 8881.53,-1458.55 8884.14,-1452.05"/>
</g>
<!-- v_proj_3_3_3&#45;&gt;attn_3_3_3 -->
<g id="edge812" class="edge">
<title>v_proj_3_3_3&#45;&gt;attn_3_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9016.78,-1513.81C9001.75,-1502.11 8984.55,-1490.06 8967.5,-1481 8941.23,-1467.04 8910.4,-1455.84 8883.4,-1447.54"/>
<polygon fill="red" stroke="red" points="8884.23,-1444.13 8873.64,-1444.61 8882.22,-1450.84 8884.23,-1444.13"/>
<text text-anchor="middle" x="9027.5" y="-1484.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_3_0_0 -->
<g id="node334" class="node">
<title>out_proj_3_0_0</title>
<polygon fill="#ffcccc" stroke="black" points="807,-1358 634,-1358 634,-1275 807,-1275 807,-1358"/>
<text text-anchor="middle" x="720.5" y="-1342.8" font-family="monospace" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="720.5" y="-1327.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="720.5" y="-1312.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="720.5" y="-1297.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="720.5" y="-1282.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_3_0_0&#45;&gt;out_proj_3_0_0 -->
<g id="edge678" class="edge">
<title>attn_3_0_0&#45;&gt;out_proj_3_0_0</title>
<path fill="none" stroke="black" d="M345.08,-1415.11C413.19,-1397.4 537.08,-1365.19 623.85,-1342.63"/>
<polygon fill="black" stroke="black" points="624.91,-1345.97 633.71,-1340.06 623.15,-1339.19 624.91,-1345.97"/>
</g>
<!-- concat_dim_3_0 -->
<g id="node335" class="node">
<title>concat_dim_3_0</title>
<polygon fill="lightyellow" stroke="black" points="1423.5,-1224 1250.5,-1171 1423.5,-1118 1596.5,-1171 1423.5,-1224"/>
<text text-anchor="middle" x="1423.5" y="-1182.3" font-family="monospace" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="1423.5" y="-1167.3" font-family="monospace" font-size="14.00">Head Group 0</text>
<text text-anchor="middle" x="1423.5" y="-1152.3" font-family="monospace" font-size="14.00">[1024×2048×(4×512)]</text>
</g>
<!-- out_proj_3_0_0&#45;&gt;concat_dim_3_0 -->
<g id="edge679" class="edge">
<title>out_proj_3_0_0&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" d="M807.05,-1281.27C845.04,-1267.35 890.48,-1252.18 932.5,-1242 1048.7,-1213.85 1183.3,-1195.64 1282.15,-1184.88"/>
<polygon fill="black" stroke="black" points="1282.64,-1188.34 1292.21,-1183.79 1281.89,-1181.38 1282.64,-1188.34"/>
</g>
<!-- out_proj_3_0_0&#45;&gt;concat_dim_3_0 -->
<g id="edge680" class="edge">
<title>out_proj_3_0_0&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M807.47,-1296.73C839.81,-1289.82 876.81,-1281.97 910.5,-1275 1047.73,-1246.6 1205.87,-1215.02 1309.87,-1194.41"/>
<polygon fill="red" stroke="red" points="1310.64,-1197.83 1319.77,-1192.45 1309.28,-1190.96 1310.64,-1197.83"/>
<text text-anchor="middle" x="1104.5" y="-1245.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_heads_3 -->
<g id="node369" class="node">
<title>concat_heads_3</title>
<polygon fill="lightyellow" stroke="black" points="5811.5,-1081 5646.5,-1028 5811.5,-975 5976.5,-1028 5811.5,-1081"/>
<text text-anchor="middle" x="5811.5" y="-1039.3" font-family="monospace" font-size="14.00">Concat Head Groups</text>
<text text-anchor="middle" x="5811.5" y="-1024.3" font-family="monospace" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="5811.5" y="-1009.3" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
</g>
<!-- concat_dim_3_0&#45;&gt;concat_heads_3 -->
<g id="edge816" class="edge">
<title>concat_dim_3_0&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M1577.42,-1165.05C2255.07,-1143.28 4969.43,-1056.06 5654.07,-1034.06"/>
<polygon fill="black" stroke="black" points="5654.37,-1037.55 5664.25,-1033.73 5654.14,-1030.55 5654.37,-1037.55"/>
</g>
<!-- out_proj_3_0_1 -->
<g id="node337" class="node">
<title>out_proj_3_0_1</title>
<polygon fill="#ccffcc" stroke="black" points="1093,-1358 920,-1358 920,-1275 1093,-1275 1093,-1358"/>
<text text-anchor="middle" x="1006.5" y="-1342.8" font-family="monospace" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1006.5" y="-1327.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="1006.5" y="-1312.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1006.5" y="-1297.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1006.5" y="-1282.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_3_0_1&#45;&gt;out_proj_3_0_1 -->
<g id="edge687" class="edge">
<title>attn_3_0_1&#45;&gt;out_proj_3_0_1</title>
<path fill="none" stroke="black" d="M908.5,-1394.85C920.64,-1385.26 934.13,-1374.62 947.11,-1364.37"/>
<polygon fill="black" stroke="black" points="949.44,-1367 955.12,-1358.06 945.1,-1361.5 949.44,-1367"/>
</g>
<!-- out_proj_3_0_1&#45;&gt;concat_dim_3_0 -->
<g id="edge688" class="edge">
<title>out_proj_3_0_1&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" d="M1093.16,-1285.68C1163.46,-1261.48 1262.25,-1227.49 1333.46,-1202.99"/>
<polygon fill="black" stroke="black" points="1335,-1206.16 1343.31,-1199.59 1332.72,-1199.54 1335,-1206.16"/>
</g>
<!-- out_proj_3_0_1&#45;&gt;concat_dim_3_0 -->
<g id="edge689" class="edge">
<title>out_proj_3_0_1&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1093.2,-1292.71C1129.68,-1282.59 1172.41,-1270.02 1210.5,-1257 1254.97,-1241.79 1303.71,-1222.54 1343.34,-1206.2"/>
<polygon fill="red" stroke="red" points="1344.78,-1209.39 1352.68,-1202.33 1342.1,-1202.92 1344.78,-1209.39"/>
<text text-anchor="middle" x="1290.5" y="-1245.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_3_0_2 -->
<g id="node339" class="node">
<title>out_proj_3_0_2</title>
<polygon fill="#ccccff" stroke="black" points="1510,-1358 1337,-1358 1337,-1275 1510,-1275 1510,-1358"/>
<text text-anchor="middle" x="1423.5" y="-1342.8" font-family="monospace" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1423.5" y="-1327.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="1423.5" y="-1312.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1423.5" y="-1297.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1423.5" y="-1282.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_3_0_2&#45;&gt;out_proj_3_0_2 -->
<g id="edge696" class="edge">
<title>attn_3_0_2&#45;&gt;out_proj_3_0_2</title>
<path fill="none" stroke="black" d="M1423.5,-1394.85C1423.5,-1386.44 1423.5,-1377.22 1423.5,-1368.16"/>
<polygon fill="black" stroke="black" points="1427,-1368.06 1423.5,-1358.06 1420,-1368.06 1427,-1368.06"/>
</g>
<!-- out_proj_3_0_2&#45;&gt;concat_dim_3_0 -->
<g id="edge697" class="edge">
<title>out_proj_3_0_2&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" d="M1423.5,-1274.76C1423.5,-1262.22 1423.5,-1248.1 1423.5,-1234.45"/>
<polygon fill="black" stroke="black" points="1427,-1234.13 1423.5,-1224.13 1420,-1234.13 1427,-1234.13"/>
</g>
<!-- out_proj_3_0_2&#45;&gt;concat_dim_3_0 -->
<g id="edge698" class="edge">
<title>out_proj_3_0_2&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1434.53,-1274.81C1435.76,-1268.87 1436.81,-1262.81 1437.5,-1257 1438.52,-1248.37 1438.35,-1239.27 1437.49,-1230.37"/>
<polygon fill="red" stroke="red" points="1440.96,-1229.92 1436.24,-1220.44 1434.01,-1230.8 1440.96,-1229.92"/>
<text text-anchor="middle" x="1476.5" y="-1245.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_3_0_3 -->
<g id="node341" class="node">
<title>out_proj_3_0_3</title>
<polygon fill="#ffffcc" stroke="black" points="1898,-1358 1725,-1358 1725,-1275 1898,-1275 1898,-1358"/>
<text text-anchor="middle" x="1811.5" y="-1342.8" font-family="monospace" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1811.5" y="-1327.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="1811.5" y="-1312.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="1811.5" y="-1297.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="1811.5" y="-1282.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_3_0_3&#45;&gt;out_proj_3_0_3 -->
<g id="edge705" class="edge">
<title>attn_3_0_3&#45;&gt;out_proj_3_0_3</title>
<path fill="none" stroke="black" d="M1826.2,-1394.85C1824.6,-1386.44 1822.85,-1377.22 1821.13,-1368.16"/>
<polygon fill="black" stroke="black" points="1824.51,-1367.23 1819.21,-1358.06 1817.64,-1368.53 1824.51,-1367.23"/>
</g>
<!-- out_proj_3_0_3&#45;&gt;concat_dim_3_0 -->
<g id="edge706" class="edge">
<title>out_proj_3_0_3&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" d="M1724.91,-1283.47C1660.96,-1259.82 1574.29,-1227.77 1510.29,-1204.1"/>
<polygon fill="black" stroke="black" points="1511.22,-1200.71 1500.62,-1200.52 1508.79,-1207.28 1511.22,-1200.71"/>
</g>
<!-- out_proj_3_0_3&#45;&gt;concat_dim_3_0 -->
<g id="edge707" class="edge">
<title>out_proj_3_0_3&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1727.43,-1274.94C1702.6,-1263.62 1675.19,-1251.76 1649.5,-1242 1608.44,-1226.4 1562.25,-1211.62 1522.38,-1199.69"/>
<polygon fill="red" stroke="red" points="1523.24,-1196.3 1512.65,-1196.8 1521.24,-1203.01 1523.24,-1196.3"/>
<text text-anchor="middle" x="1724.5" y="-1245.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_3_1_0 -->
<g id="node343" class="node">
<title>out_proj_3_1_0</title>
<polygon fill="#ffccff" stroke="black" points="2817,-1358 2644,-1358 2644,-1275 2817,-1275 2817,-1358"/>
<text text-anchor="middle" x="2730.5" y="-1342.8" font-family="monospace" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2730.5" y="-1327.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="2730.5" y="-1312.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="2730.5" y="-1297.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="2730.5" y="-1282.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_3_1_0&#45;&gt;out_proj_3_1_0 -->
<g id="edge714" class="edge">
<title>attn_3_1_0&#45;&gt;out_proj_3_1_0</title>
<path fill="none" stroke="black" d="M2636.7,-1394.85C2648.21,-1385.36 2660.99,-1374.82 2673.31,-1364.66"/>
<polygon fill="black" stroke="black" points="2675.83,-1367.12 2681.32,-1358.06 2671.38,-1361.72 2675.83,-1367.12"/>
</g>
<!-- concat_dim_3_1 -->
<g id="node344" class="node">
<title>concat_dim_3_1</title>
<polygon fill="lightyellow" stroke="black" points="3715.5,-1224 3542.5,-1171 3715.5,-1118 3888.5,-1171 3715.5,-1224"/>
<text text-anchor="middle" x="3715.5" y="-1182.3" font-family="monospace" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="3715.5" y="-1167.3" font-family="monospace" font-size="14.00">Head Group 1</text>
<text text-anchor="middle" x="3715.5" y="-1152.3" font-family="monospace" font-size="14.00">[1024×2048×(4×512)]</text>
</g>
<!-- out_proj_3_1_0&#45;&gt;concat_dim_3_1 -->
<g id="edge715" class="edge">
<title>out_proj_3_1_0&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" d="M2817.07,-1285.49C2864.49,-1270.18 2924.62,-1252.61 2979.5,-1242 3175.22,-1204.17 3404.35,-1186.48 3554.31,-1178.41"/>
<polygon fill="black" stroke="black" points="3554.72,-1181.9 3564.52,-1177.87 3554.35,-1174.91 3554.72,-1181.9"/>
</g>
<!-- out_proj_3_1_0&#45;&gt;concat_dim_3_1 -->
<g id="edge716" class="edge">
<title>out_proj_3_1_0&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2817.05,-1302.89C2991.79,-1277.43 3387.3,-1219.81 3590.24,-1190.25"/>
<polygon fill="red" stroke="red" points="3590.96,-1193.68 3600.35,-1188.78 3589.95,-1186.75 3590.96,-1193.68"/>
<text text-anchor="middle" x="3261.5" y="-1245.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_dim_3_1&#45;&gt;concat_heads_3 -->
<g id="edge817" class="edge">
<title>concat_dim_3_1&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M3855.05,-1160.61C4234.59,-1135.08 5282.8,-1064.57 5667.5,-1038.69"/>
<polygon fill="black" stroke="black" points="5667.83,-1042.17 5677.58,-1038.01 5667.36,-1035.19 5667.83,-1042.17"/>
</g>
<!-- out_proj_3_1_1 -->
<g id="node346" class="node">
<title>out_proj_3_1_1</title>
<polygon fill="#ccffff" stroke="black" points="3516,-1358 3343,-1358 3343,-1275 3516,-1275 3516,-1358"/>
<text text-anchor="middle" x="3429.5" y="-1342.8" font-family="monospace" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="3429.5" y="-1327.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="3429.5" y="-1312.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3429.5" y="-1297.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3429.5" y="-1282.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_3_1_1&#45;&gt;out_proj_3_1_1 -->
<g id="edge723" class="edge">
<title>attn_3_1_1&#45;&gt;out_proj_3_1_1</title>
<path fill="none" stroke="black" d="M3227.53,-1403.34C3258.64,-1390.11 3297.8,-1373.47 3333.33,-1358.37"/>
<polygon fill="black" stroke="black" points="3334.92,-1361.5 3342.76,-1354.37 3332.18,-1355.06 3334.92,-1361.5"/>
</g>
<!-- out_proj_3_1_1&#45;&gt;concat_dim_3_1 -->
<g id="edge724" class="edge">
<title>out_proj_3_1_1&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" d="M3510.31,-1274.95C3551.62,-1254.23 3601.53,-1229.19 3641.78,-1208.99"/>
<polygon fill="black" stroke="black" points="3643.37,-1212.11 3650.74,-1204.49 3640.23,-1205.85 3643.37,-1212.11"/>
</g>
<!-- out_proj_3_1_1&#45;&gt;concat_dim_3_1 -->
<g id="edge725" class="edge">
<title>out_proj_3_1_1&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3516.37,-1283.07C3535.76,-1275.11 3556.04,-1266.21 3574.5,-1257 3600.69,-1243.92 3628.5,-1227.71 3652.43,-1212.95"/>
<polygon fill="red" stroke="red" points="3654.41,-1215.84 3661.06,-1207.59 3650.72,-1209.89 3654.41,-1215.84"/>
<text text-anchor="middle" x="3640.5" y="-1245.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_3_1_2 -->
<g id="node348" class="node">
<title>out_proj_3_1_2</title>
<polygon fill="#ffaaaa" stroke="black" points="3802,-1358 3629,-1358 3629,-1275 3802,-1275 3802,-1358"/>
<text text-anchor="middle" x="3715.5" y="-1342.8" font-family="monospace" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="3715.5" y="-1327.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="3715.5" y="-1312.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="3715.5" y="-1297.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="3715.5" y="-1282.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_3_1_2&#45;&gt;out_proj_3_1_2 -->
<g id="edge732" class="edge">
<title>attn_3_1_2&#45;&gt;out_proj_3_1_2</title>
<path fill="none" stroke="black" d="M3715.5,-1394.85C3715.5,-1386.44 3715.5,-1377.22 3715.5,-1368.16"/>
<polygon fill="black" stroke="black" points="3719,-1368.06 3715.5,-1358.06 3712,-1368.06 3719,-1368.06"/>
</g>
<!-- out_proj_3_1_2&#45;&gt;concat_dim_3_1 -->
<g id="edge733" class="edge">
<title>out_proj_3_1_2&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" d="M3715.5,-1274.76C3715.5,-1262.22 3715.5,-1248.1 3715.5,-1234.45"/>
<polygon fill="black" stroke="black" points="3719,-1234.13 3715.5,-1224.13 3712,-1234.13 3719,-1234.13"/>
</g>
<!-- out_proj_3_1_2&#45;&gt;concat_dim_3_1 -->
<g id="edge734" class="edge">
<title>out_proj_3_1_2&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3726.53,-1274.81C3727.76,-1268.87 3728.81,-1262.81 3729.5,-1257 3730.52,-1248.37 3730.35,-1239.27 3729.49,-1230.37"/>
<polygon fill="red" stroke="red" points="3732.96,-1229.92 3728.24,-1220.44 3726.01,-1230.8 3732.96,-1229.92"/>
<text text-anchor="middle" x="3768.5" y="-1245.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_3_1_3 -->
<g id="node350" class="node">
<title>out_proj_3_1_3</title>
<polygon fill="#aaffaa" stroke="black" points="4190,-1358 4017,-1358 4017,-1275 4190,-1275 4190,-1358"/>
<text text-anchor="middle" x="4103.5" y="-1342.8" font-family="monospace" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="4103.5" y="-1327.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="4103.5" y="-1312.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4103.5" y="-1297.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4103.5" y="-1282.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_3_1_3&#45;&gt;out_proj_3_1_3 -->
<g id="edge741" class="edge">
<title>attn_3_1_3&#45;&gt;out_proj_3_1_3</title>
<path fill="none" stroke="black" d="M4118.2,-1394.85C4116.6,-1386.44 4114.85,-1377.22 4113.13,-1368.16"/>
<polygon fill="black" stroke="black" points="4116.51,-1367.23 4111.21,-1358.06 4109.64,-1368.53 4116.51,-1367.23"/>
</g>
<!-- out_proj_3_1_3&#45;&gt;concat_dim_3_1 -->
<g id="edge742" class="edge">
<title>out_proj_3_1_3&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" d="M4016.91,-1283.47C3952.96,-1259.82 3866.29,-1227.77 3802.29,-1204.1"/>
<polygon fill="black" stroke="black" points="3803.22,-1200.71 3792.62,-1200.52 3800.79,-1207.28 3803.22,-1200.71"/>
</g>
<!-- out_proj_3_1_3&#45;&gt;concat_dim_3_1 -->
<g id="edge743" class="edge">
<title>out_proj_3_1_3&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4019.43,-1274.94C3994.6,-1263.62 3967.19,-1251.76 3941.5,-1242 3900.44,-1226.4 3854.25,-1211.62 3814.38,-1199.69"/>
<polygon fill="red" stroke="red" points="3815.24,-1196.3 3804.65,-1196.8 3813.24,-1203.01 3815.24,-1196.3"/>
<text text-anchor="middle" x="4016.5" y="-1245.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_3_2_0 -->
<g id="node352" class="node">
<title>out_proj_3_2_0</title>
<polygon fill="#aaaaff" stroke="black" points="5025,-1358 4852,-1358 4852,-1275 5025,-1275 5025,-1358"/>
<text text-anchor="middle" x="4938.5" y="-1342.8" font-family="monospace" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="4938.5" y="-1327.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="4938.5" y="-1312.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="4938.5" y="-1297.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="4938.5" y="-1282.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_3_2_0&#45;&gt;out_proj_3_2_0 -->
<g id="edge750" class="edge">
<title>attn_3_2_0&#45;&gt;out_proj_3_2_0</title>
<path fill="none" stroke="black" d="M4902.8,-1394.85C4906.81,-1386.17 4911.21,-1376.62 4915.52,-1367.28"/>
<polygon fill="black" stroke="black" points="4918.77,-1368.6 4919.78,-1358.06 4912.41,-1365.67 4918.77,-1368.6"/>
</g>
<!-- concat_dim_3_2 -->
<g id="node353" class="node">
<title>concat_dim_3_2</title>
<polygon fill="lightyellow" stroke="black" points="5811.5,-1224 5638.5,-1171 5811.5,-1118 5984.5,-1171 5811.5,-1224"/>
<text text-anchor="middle" x="5811.5" y="-1182.3" font-family="monospace" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="5811.5" y="-1167.3" font-family="monospace" font-size="14.00">Head Group 2</text>
<text text-anchor="middle" x="5811.5" y="-1152.3" font-family="monospace" font-size="14.00">[1024×2048×(4×512)]</text>
</g>
<!-- out_proj_3_2_0&#45;&gt;concat_dim_3_2 -->
<g id="edge751" class="edge">
<title>out_proj_3_2_0&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" d="M5025.4,-1301.22C5182.12,-1275.46 5512.35,-1221.17 5690.86,-1191.83"/>
<polygon fill="black" stroke="black" points="5691.52,-1195.27 5700.82,-1190.19 5690.38,-1188.36 5691.52,-1195.27"/>
</g>
<!-- out_proj_3_2_0&#45;&gt;concat_dim_3_2 -->
<g id="edge752" class="edge">
<title>out_proj_3_2_0&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5025.07,-1304.27C5108.55,-1293.18 5238.38,-1275.29 5350.5,-1257 5469.27,-1237.63 5604.63,-1212.28 5697.8,-1194.32"/>
<polygon fill="red" stroke="red" points="5698.65,-1197.72 5707.81,-1192.38 5697.33,-1190.84 5698.65,-1197.72"/>
<text text-anchor="middle" x="5477.5" y="-1245.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_dim_3_2&#45;&gt;concat_heads_3 -->
<g id="edge818" class="edge">
<title>concat_dim_3_2&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M5811.5,-1117.9C5811.5,-1109.33 5811.5,-1100.37 5811.5,-1091.57"/>
<polygon fill="black" stroke="black" points="5815,-1091.36 5811.5,-1081.36 5808,-1091.36 5815,-1091.36"/>
</g>
<!-- out_proj_3_2_1 -->
<g id="node355" class="node">
<title>out_proj_3_2_1</title>
<polygon fill="#ffffaa" stroke="black" points="5598,-1358 5425,-1358 5425,-1275 5598,-1275 5598,-1358"/>
<text text-anchor="middle" x="5511.5" y="-1342.8" font-family="monospace" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5511.5" y="-1327.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="5511.5" y="-1312.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5511.5" y="-1297.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="5511.5" y="-1282.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_3_2_1&#45;&gt;out_proj_3_2_1 -->
<g id="edge759" class="edge">
<title>attn_3_2_1&#45;&gt;out_proj_3_2_1</title>
<path fill="none" stroke="black" d="M5475.8,-1394.85C5479.81,-1386.17 5484.21,-1376.62 5488.52,-1367.28"/>
<polygon fill="black" stroke="black" points="5491.77,-1368.6 5492.78,-1358.06 5485.41,-1365.67 5491.77,-1368.6"/>
</g>
<!-- out_proj_3_2_1&#45;&gt;concat_dim_3_2 -->
<g id="edge760" class="edge">
<title>out_proj_3_2_1&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" d="M5596.27,-1274.95C5640.17,-1253.95 5693.34,-1228.52 5735.85,-1208.19"/>
<polygon fill="black" stroke="black" points="5737.51,-1211.27 5745.02,-1203.8 5734.49,-1204.95 5737.51,-1211.27"/>
</g>
<!-- out_proj_3_2_1&#45;&gt;concat_dim_3_2 -->
<g id="edge761" class="edge">
<title>out_proj_3_2_1&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5598.28,-1284.42C5619.55,-1276.11 5642.06,-1266.72 5662.5,-1257 5690.53,-1243.67 5720.43,-1227.1 5746.03,-1212.15"/>
<polygon fill="red" stroke="red" points="5748.05,-1215.02 5754.9,-1206.94 5744.5,-1208.99 5748.05,-1215.02"/>
<text text-anchor="middle" x="5730.5" y="-1245.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_3_2_2 -->
<g id="node357" class="node">
<title>out_proj_3_2_2</title>
<polygon fill="#ffaaff" stroke="black" points="5980,-1358 5807,-1358 5807,-1275 5980,-1275 5980,-1358"/>
<text text-anchor="middle" x="5893.5" y="-1342.8" font-family="monospace" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5893.5" y="-1327.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="5893.5" y="-1312.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="5893.5" y="-1297.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="5893.5" y="-1282.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_3_2_2&#45;&gt;out_proj_3_2_2 -->
<g id="edge768" class="edge">
<title>attn_3_2_2&#45;&gt;out_proj_3_2_2</title>
<path fill="none" stroke="black" d="M5967.7,-1394.85C5958.85,-1385.63 5949.06,-1375.42 5939.58,-1365.53"/>
<polygon fill="black" stroke="black" points="5941.85,-1362.85 5932.4,-1358.06 5936.8,-1367.69 5941.85,-1362.85"/>
</g>
<!-- out_proj_3_2_2&#45;&gt;concat_dim_3_2 -->
<g id="edge769" class="edge">
<title>out_proj_3_2_2&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" d="M5870.22,-1274.76C5861.43,-1259.38 5851.3,-1241.65 5841.95,-1225.28"/>
<polygon fill="black" stroke="black" points="5844.85,-1223.31 5836.85,-1216.36 5838.77,-1226.78 5844.85,-1223.31"/>
</g>
<!-- out_proj_3_2_2&#45;&gt;concat_dim_3_2 -->
<g id="edge770" class="edge">
<title>out_proj_3_2_2&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5883.86,-1274.65C5880.44,-1263.68 5876.03,-1252.08 5870.5,-1242 5866.49,-1234.69 5861.64,-1227.43 5856.47,-1220.52"/>
<polygon fill="red" stroke="red" points="5859.19,-1218.32 5850.29,-1212.58 5853.67,-1222.62 5859.19,-1218.32"/>
<text text-anchor="middle" x="5915.5" y="-1245.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_3_2_3 -->
<g id="node359" class="node">
<title>out_proj_3_2_3</title>
<polygon fill="#aaffff" stroke="black" points="6362,-1358 6189,-1358 6189,-1275 6362,-1275 6362,-1358"/>
<text text-anchor="middle" x="6275.5" y="-1342.8" font-family="monospace" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6275.5" y="-1327.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="6275.5" y="-1312.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="6275.5" y="-1297.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="6275.5" y="-1282.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_3_2_3&#45;&gt;out_proj_3_2_3 -->
<g id="edge777" class="edge">
<title>attn_3_2_3&#45;&gt;out_proj_3_2_3</title>
<path fill="none" stroke="black" d="M6452.41,-1400.69C6427.87,-1389.14 6398.63,-1375.4 6371.06,-1362.43"/>
<polygon fill="black" stroke="black" points="6372.32,-1359.16 6361.78,-1358.07 6369.34,-1365.49 6372.32,-1359.16"/>
</g>
<!-- out_proj_3_2_3&#45;&gt;concat_dim_3_2 -->
<g id="edge778" class="edge">
<title>out_proj_3_2_3&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" d="M6188.77,-1288.68C6108.28,-1263.78 5988.76,-1226.82 5905.9,-1201.2"/>
<polygon fill="black" stroke="black" points="5906.83,-1197.82 5896.24,-1198.21 5904.76,-1204.51 5906.83,-1197.82"/>
</g>
<!-- out_proj_3_2_3&#45;&gt;concat_dim_3_2 -->
<g id="edge779" class="edge">
<title>out_proj_3_2_3&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6188.88,-1281.03C6154.75,-1268.02 6115.04,-1253.57 6078.5,-1242 6025.93,-1225.35 5966.67,-1209.52 5917.36,-1197.14"/>
<polygon fill="red" stroke="red" points="5918.18,-1193.74 5907.63,-1194.72 5916.48,-1200.53 5918.18,-1193.74"/>
<text text-anchor="middle" x="6160.5" y="-1245.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_3_3_0 -->
<g id="node361" class="node">
<title>out_proj_3_3_0</title>
<polygon fill="#ff8888" stroke="black" points="7431,-1358 7258,-1358 7258,-1275 7431,-1275 7431,-1358"/>
<text text-anchor="middle" x="7344.5" y="-1342.8" font-family="monospace" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7344.5" y="-1327.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="7344.5" y="-1312.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7344.5" y="-1297.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="7344.5" y="-1282.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_3_3_0&#45;&gt;out_proj_3_3_0 -->
<g id="edge786" class="edge">
<title>attn_3_3_0&#45;&gt;out_proj_3_3_0</title>
<path fill="none" stroke="black" d="M7229.71,-1394.85C7244.19,-1385.08 7260.32,-1374.22 7275.79,-1363.79"/>
<polygon fill="black" stroke="black" points="7277.97,-1366.55 7284.31,-1358.06 7274.06,-1360.74 7277.97,-1366.55"/>
</g>
<!-- concat_dim_3_3 -->
<g id="node362" class="node">
<title>concat_dim_3_3</title>
<polygon fill="lightyellow" stroke="black" points="7726.5,-1224 7553.5,-1171 7726.5,-1118 7899.5,-1171 7726.5,-1224"/>
<text text-anchor="middle" x="7726.5" y="-1182.3" font-family="monospace" font-size="14.00">Concat Dim Slices</text>
<text text-anchor="middle" x="7726.5" y="-1167.3" font-family="monospace" font-size="14.00">Head Group 3</text>
<text text-anchor="middle" x="7726.5" y="-1152.3" font-family="monospace" font-size="14.00">[1024×2048×(4×512)]</text>
</g>
<!-- out_proj_3_3_0&#45;&gt;concat_dim_3_3 -->
<g id="edge787" class="edge">
<title>out_proj_3_3_0&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" d="M7431.18,-1282.94C7493.89,-1259.38 7578.24,-1227.69 7640.74,-1204.22"/>
<polygon fill="black" stroke="black" points="7642.05,-1207.46 7650.18,-1200.67 7639.59,-1200.91 7642.05,-1207.46"/>
</g>
<!-- out_proj_3_3_0&#45;&gt;concat_dim_3_3 -->
<g id="edge788" class="edge">
<title>out_proj_3_3_0&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7431.29,-1290.7C7463.36,-1280.96 7499.84,-1269.19 7532.5,-1257 7571.87,-1242.3 7614.75,-1223.79 7650.17,-1207.79"/>
<polygon fill="red" stroke="red" points="7651.81,-1210.89 7659.47,-1203.57 7648.92,-1204.51 7651.81,-1210.89"/>
<text text-anchor="middle" x="7608.5" y="-1245.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_dim_3_3&#45;&gt;concat_heads_3 -->
<g id="edge819" class="edge">
<title>concat_dim_3_3&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M7589.55,-1159.92C7238.62,-1134.08 6309.83,-1065.69 5953.47,-1039.45"/>
<polygon fill="black" stroke="black" points="5953.58,-1035.95 5943.35,-1038.71 5953.07,-1042.93 5953.58,-1035.95"/>
</g>
<!-- out_proj_3_3_1 -->
<g id="node364" class="node">
<title>out_proj_3_3_1</title>
<polygon fill="#88ff88" stroke="black" points="7813,-1358 7640,-1358 7640,-1275 7813,-1275 7813,-1358"/>
<text text-anchor="middle" x="7726.5" y="-1342.8" font-family="monospace" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7726.5" y="-1327.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="7726.5" y="-1312.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="7726.5" y="-1297.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="7726.5" y="-1282.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_3_3_1&#45;&gt;out_proj_3_3_1 -->
<g id="edge795" class="edge">
<title>attn_3_3_1&#45;&gt;out_proj_3_3_1</title>
<path fill="none" stroke="black" d="M7726.5,-1394.85C7726.5,-1386.44 7726.5,-1377.22 7726.5,-1368.16"/>
<polygon fill="black" stroke="black" points="7730,-1368.06 7726.5,-1358.06 7723,-1368.06 7730,-1368.06"/>
</g>
<!-- out_proj_3_3_1&#45;&gt;concat_dim_3_3 -->
<g id="edge796" class="edge">
<title>out_proj_3_3_1&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" d="M7726.5,-1274.76C7726.5,-1262.22 7726.5,-1248.1 7726.5,-1234.45"/>
<polygon fill="black" stroke="black" points="7730,-1234.13 7726.5,-1224.13 7723,-1234.13 7730,-1234.13"/>
</g>
<!-- out_proj_3_3_1&#45;&gt;concat_dim_3_3 -->
<g id="edge797" class="edge">
<title>out_proj_3_3_1&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7737.53,-1274.81C7738.76,-1268.87 7739.81,-1262.81 7740.5,-1257 7741.52,-1248.37 7741.35,-1239.27 7740.49,-1230.37"/>
<polygon fill="red" stroke="red" points="7743.96,-1229.92 7739.24,-1220.44 7737.01,-1230.8 7743.96,-1229.92"/>
<text text-anchor="middle" x="7779.5" y="-1245.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_3_3_2 -->
<g id="node366" class="node">
<title>out_proj_3_3_2</title>
<polygon fill="#8888ff" stroke="black" points="8225,-1358 8052,-1358 8052,-1275 8225,-1275 8225,-1358"/>
<text text-anchor="middle" x="8138.5" y="-1342.8" font-family="monospace" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8138.5" y="-1327.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="8138.5" y="-1312.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8138.5" y="-1297.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8138.5" y="-1282.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_3_3_2&#45;&gt;out_proj_3_3_2 -->
<g id="edge804" class="edge">
<title>attn_3_3_2&#45;&gt;out_proj_3_3_2</title>
<path fill="none" stroke="black" d="M8236.5,-1394.85C8224.36,-1385.26 8210.87,-1374.62 8197.89,-1364.37"/>
<polygon fill="black" stroke="black" points="8199.9,-1361.5 8189.88,-1358.06 8195.56,-1367 8199.9,-1361.5"/>
</g>
<!-- out_proj_3_3_2&#45;&gt;concat_dim_3_3 -->
<g id="edge805" class="edge">
<title>out_proj_3_3_2&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" d="M8051.88,-1285.33C7982.56,-1261.19 7885.71,-1227.45 7815.72,-1203.07"/>
<polygon fill="black" stroke="black" points="7816.62,-1199.68 7806.02,-1199.7 7814.32,-1206.29 7816.62,-1199.68"/>
</g>
<!-- out_proj_3_3_2&#45;&gt;concat_dim_3_3 -->
<g id="edge806" class="edge">
<title>out_proj_3_3_2&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8051.72,-1276.29C8024.39,-1264.58 7993.92,-1252.16 7965.5,-1242 7920.84,-1226.03 7870.56,-1210.9 7827.69,-1198.81"/>
<polygon fill="red" stroke="red" points="7828.38,-1195.37 7817.81,-1196.04 7826.49,-1202.11 7828.38,-1195.37"/>
<text text-anchor="middle" x="8042.5" y="-1245.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- out_proj_3_3_3 -->
<g id="node368" class="node">
<title>out_proj_3_3_3</title>
<polygon fill="#ffff88" stroke="black" points="8693,-1358 8520,-1358 8520,-1275 8693,-1275 8693,-1358"/>
<text text-anchor="middle" x="8606.5" y="-1342.8" font-family="monospace" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8606.5" y="-1327.8" font-family="monospace" font-size="14.00">Out Proj</text>
<text text-anchor="middle" x="8606.5" y="-1312.8" font-family="monospace" font-size="14.00">[1024×2048×(4×128)]</text>
<text text-anchor="middle" x="8606.5" y="-1297.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="8606.5" y="-1282.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- attn_3_3_3&#45;&gt;out_proj_3_3_3 -->
<g id="edge813" class="edge">
<title>attn_3_3_3&#45;&gt;out_proj_3_3_3</title>
<path fill="none" stroke="black" d="M8757.28,-1397.22C8737.11,-1386.56 8714.06,-1374.37 8692.15,-1362.78"/>
<polygon fill="black" stroke="black" points="8693.65,-1359.62 8683.17,-1358.04 8690.37,-1365.8 8693.65,-1359.62"/>
</g>
<!-- out_proj_3_3_3&#45;&gt;concat_dim_3_3 -->
<g id="edge814" class="edge">
<title>out_proj_3_3_3&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" d="M8519.71,-1301.35C8361.93,-1275.62 8027.79,-1221.13 7847.65,-1191.75"/>
<polygon fill="black" stroke="black" points="7848.03,-1188.27 7837.6,-1190.12 7846.9,-1195.18 7848.03,-1188.27"/>
</g>
<!-- out_proj_3_3_3&#45;&gt;concat_dim_3_3 -->
<g id="edge815" class="edge">
<title>out_proj_3_3_3&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8519.71,-1297.76C8441.62,-1282.08 8323.63,-1259.12 8220.5,-1242 8097.3,-1221.55 7956.19,-1201.94 7856.41,-1188.7"/>
<polygon fill="red" stroke="red" points="7856.65,-1185.2 7846.28,-1187.36 7855.73,-1192.14 7856.65,-1185.2"/>
<text text-anchor="middle" x="8343.5" y="-1245.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
<!-- concat_heads_3&#45;&gt;add_3 -->
<g id="edge820" class="edge">
<title>concat_heads_3&#45;&gt;add_3</title>
<path fill="none" stroke="black" d="M5932.52,-1013.85C6259.46,-978.33 7157.33,-880.78 7477.34,-846.01"/>
<polygon fill="black" stroke="black" points="7478,-849.46 7487.56,-844.9 7477.24,-842.5 7478,-849.46"/>
</g>
<!-- ffn_dense_h_3 -->
<g id="node372" class="node">
<title>ffn_dense_h_3</title>
<polygon fill="lightgreen" stroke="black" points="7611,-615 7454,-615 7454,-547 7611,-547 7611,-615"/>
<text text-anchor="middle" x="7532.5" y="-599.8" font-family="monospace" font-size="14.00">FFN Dense_H</text>
<text text-anchor="middle" x="7532.5" y="-584.8" font-family="monospace" font-size="14.00">[1024×2048×32768]</text>
<text text-anchor="middle" x="7532.5" y="-569.8" font-family="monospace" font-size="14.00">ColParallel</text>
<text text-anchor="middle" x="7532.5" y="-554.8" font-family="monospace" font-size="14.00">→AllGather</text>
</g>
<!-- ln2_3&#45;&gt;ffn_dense_h_3 -->
<g id="edge823" class="edge">
<title>ln2_3&#45;&gt;ffn_dense_h_3</title>
<path fill="none" stroke="black" d="M7538.05,-651.77C7537.43,-644 7536.68,-634.59 7535.94,-625.22"/>
<polygon fill="black" stroke="black" points="7539.42,-624.84 7535.14,-615.15 7532.44,-625.4 7539.42,-624.84"/>
</g>
<!-- output -->
<g id="node375" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="7538.5" cy="-27" rx="215.5" ry="27"/>
<text text-anchor="middle" x="7538.5" y="-30.8" font-family="monospace" font-size="14.00">Output</text>
<text text-anchor="middle" x="7538.5" y="-15.8" font-family="monospace" font-size="14.00">[Batch=1024, Seq=2048, Hidden=8192]</text>
</g>
<!-- add2_3&#45;&gt;output -->
<g id="edge829" class="edge">
<title>add2_3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7538.5,-90.85C7538.5,-81.47 7538.5,-72.46 7538.5,-64.34"/>
<polygon fill="black" stroke="black" points="7542,-64.22 7538.5,-54.22 7535,-64.22 7542,-64.22"/>
</g>
<!-- ffn_act_3 -->
<g id="node373" class="node">
<title>ffn_act_3</title>
<polygon fill="lightgreen" stroke="black" points="7603,-496 7446,-496 7446,-458 7603,-458 7603,-496"/>
<text text-anchor="middle" x="7524.5" y="-480.8" font-family="monospace" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7524.5" y="-465.8" font-family="monospace" font-size="14.00">[1024×2048×32768]</text>
</g>
<!-- ffn_dense_h_3&#45;&gt;ffn_act_3 -->
<g id="edge824" class="edge">
<title>ffn_dense_h_3&#45;&gt;ffn_act_3</title>
<path fill="none" stroke="black" d="M7529.9,-546.88C7528.88,-533.84 7527.72,-519 7526.73,-506.45"/>
<polygon fill="black" stroke="black" points="7530.19,-505.8 7525.92,-496.11 7523.21,-506.35 7530.19,-505.8"/>
</g>
<!-- ffn_dense_h_3&#45;&gt;ffn_act_3 -->
<g id="edge825" class="edge">
<title>ffn_dense_h_3&#45;&gt;ffn_act_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7537.35,-546.96C7538.15,-536.38 7538.23,-524.65 7536.5,-514 7536.06,-511.29 7535.45,-508.51 7534.72,-505.75"/>
<polygon fill="red" stroke="red" points="7538.03,-504.58 7531.77,-496.03 7531.33,-506.61 7538.03,-504.58"/>
<text text-anchor="middle" x="7575" y="-517.8" font-family="Times,serif" font-size="14.00">All&#45;Gather</text>
</g>
<!-- ffn_dense_4h_3 -->
<g id="node374" class="node">
<title>ffn_dense_4h_3</title>
<polygon fill="lightgreen" stroke="black" points="7598,-421 7449,-421 7449,-353 7598,-353 7598,-421"/>
<text text-anchor="middle" x="7523.5" y="-405.8" font-family="monospace" font-size="14.00">FFN Dense_4H</text>
<text text-anchor="middle" x="7523.5" y="-390.8" font-family="monospace" font-size="14.00">[1024×2048×8192]</text>
<text text-anchor="middle" x="7523.5" y="-375.8" font-family="monospace" font-size="14.00">RowParallel</text>
<text text-anchor="middle" x="7523.5" y="-360.8" font-family="monospace" font-size="14.00">→AllReduce</text>
</g>
<!-- ffn_act_3&#45;&gt;ffn_dense_4h_3 -->
<g id="edge826" class="edge">
<title>ffn_act_3&#45;&gt;ffn_dense_4h_3</title>
<path fill="none" stroke="black" d="M7524.29,-457.77C7524.2,-450 7524.1,-440.59 7523.99,-431.22"/>
<polygon fill="black" stroke="black" points="7527.49,-431.11 7523.88,-421.15 7520.49,-431.19 7527.49,-431.11"/>
</g>
<!-- ffn_dense_4h_3&#45;&gt;add2_3 -->
<g id="edge827" class="edge">
<title>ffn_dense_4h_3&#45;&gt;add2_3</title>
<path fill="none" stroke="black" d="M7526.15,-352.73C7527.08,-340.97 7528.2,-326.98 7529.37,-312.3"/>
<polygon fill="black" stroke="black" points="7532.88,-312.28 7530.18,-302.04 7525.9,-311.73 7532.88,-312.28"/>
</g>
<!-- ffn_dense_4h_3&#45;&gt;add2_3 -->
<g id="edge828" class="edge">
<title>ffn_dense_4h_3&#45;&gt;add2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7530.77,-352.92C7531.85,-346.98 7532.83,-340.83 7533.5,-335 7534.36,-327.58 7535.08,-319.91 7535.69,-312.18"/>
<polygon fill="red" stroke="red" points="7539.19,-312.21 7536.42,-301.99 7532.21,-311.71 7539.19,-312.21"/>
<text text-anchor="middle" x="7573.5" y="-323.8" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
</g>
</g>
</svg>
