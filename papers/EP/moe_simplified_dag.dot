digraph MoE_Simplified_DAG {
	graph [bb="0,0,3351.3,76",
		rankdir=LR,
		splines=ortho
	];
	node [label="\N"];
	input_tokens	[fillcolor=lightblue,
		height=0.52778,
		label="Input Tokens\n1024×512×4096",
		pos="70,38",
		shape=box,
		style=filled,
		width=1.9444];
	layer_0	[fillcolor=lightyellow,
		height=0.73611,
		label="Layer 0\n64 Experts across 64 GPUs\n1 Expert per GPU",
		pos="282,38",
		shape=component,
		style=filled,
		width=2.9444];
	input_tokens -> layer_0	[pos="e,175.66,38 140,38 140,38 165.66,38 165.66,38"];
	comm_0	[fillcolor=lightcoral,
		height=1.0556,
		label="Cross-GPU Communication\nToken Routing & Aggregation",
		pos="661.42,38",
		shape=parallelogram,
		style=filled,
		width=6.5949];
	layer_0 -> comm_0	[pos="e,472.45,38 388.19,38 388.19,38 462.45,38 462.45,38"];
	layer_1	[fillcolor=lightyellow,
		height=0.73611,
		label="Layer 1\n64 Experts across 64 GPUs\n1 Expert per GPU",
		pos="1040.8,38",
		shape=component,
		style=filled,
		width=2.9444];
	comm_0 -> layer_1	[pos="e,934.62,38 850.29,38 850.29,38 924.62,38 924.62,38"];
	comm_1	[fillcolor=lightcoral,
		height=1.0556,
		label="Cross-GPU Communication\nToken Routing & Aggregation",
		pos="1420.2,38",
		shape=parallelogram,
		style=filled,
		width=6.5949];
	layer_1 -> comm_1	[pos="e,1231.3,38 1147,38 1147,38 1221.3,38 1221.3,38"];
	layer_2	[fillcolor=lightyellow,
		height=0.73611,
		label="Layer 2\n64 Experts across 64 GPUs\n1 Expert per GPU",
		pos="1799.7,38",
		shape=component,
		style=filled,
		width=2.9444];
	comm_1 -> layer_2	[pos="e,1693.5,38 1609.1,38 1609.1,38 1683.5,38 1683.5,38"];
	comm_2	[fillcolor=lightcoral,
		height=1.0556,
		label="Cross-GPU Communication\nToken Routing & Aggregation",
		pos="2179.1,38",
		shape=parallelogram,
		style=filled,
		width=6.5949];
	layer_2 -> comm_2	[pos="e,1990.1,38 1905.9,38 1905.9,38 1980.1,38 1980.1,38"];
	layer_3	[fillcolor=lightyellow,
		height=0.73611,
		label="Layer 3\n64 Experts across 64 GPUs\n1 Expert per GPU",
		pos="2558.5,38",
		shape=component,
		style=filled,
		width=2.9444];
	comm_2 -> layer_3	[pos="e,2452.3,38 2368,38 2368,38 2442.3,38 2442.3,38"];
	comm_3	[fillcolor=lightcoral,
		height=1.0556,
		label="Cross-GPU Communication\nToken Routing & Aggregation",
		pos="2937.9,38",
		shape=parallelogram,
		style=filled,
		width=6.5949];
	layer_3 -> comm_3	[pos="e,2748.9,38 2664.7,38 2664.7,38 2738.9,38 2738.9,38"];
	output_tokens	[fillcolor=lightpink,
		height=0.52778,
		label="Output Tokens\n1024×512×4096",
		pos="3281.3,38",
		shape=box,
		style=filled,
		width=1.9444];
	comm_3 -> output_tokens	[pos="e,3211.1,38 3126.7,38 3126.7,38 3201.1,38 3201.1,38"];
}
