<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="7200pt" height="936pt"
 viewBox="0.00 0.00 7200.00 935.69" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.4 0.4) rotate(0) translate(4 2346)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2346 18079,-2346 18079,4 -4,4"/>
<text text-anchor="middle" x="9037.5" y="-7.8" font-family="Times,serif" font-size="14.00">Layer 4 &#45; 64 Experts on GPUs 193&#45;256</text>
<g id="clust1" class="cluster">
<title>cluster_layer1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-1737 8,-2262 18067,-2262 18067,-1737 8,-1737"/>
<text text-anchor="middle" x="9037.5" y="-2246.8" font-family="Times,serif" font-size="14.00">Layer 1 &#45; Expert Parallelism (EP=64)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-1193 8,-1718 18067,-1718 18067,-1193 8,-1193"/>
<text text-anchor="middle" x="9037.5" y="-1702.8" font-family="Times,serif" font-size="14.00">Layer 2 &#45; Expert Parallelism (EP=64)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-649 8,-1174 18067,-1174 18067,-649 8,-649"/>
<text text-anchor="middle" x="9037.5" y="-1158.8" font-family="Times,serif" font-size="14.00">Layer 3 &#45; Expert Parallelism (EP=64)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer4</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-105 8,-630 18067,-630 18067,-105 8,-105"/>
<text text-anchor="middle" x="9037.5" y="-614.8" font-family="Times,serif" font-size="14.00">Layer 4 &#45; Expert Parallelism (EP=64)</text>
</g>
<!-- pre_layer1_norm -->
<g id="node1" class="node">
<title>pre_layer1_norm</title>
<polygon fill="#e6f3ff" stroke="black" points="9026,-2231 8808,-2231 8808,-2178 9026,-2178 9026,-2231"/>
<text text-anchor="middle" x="8917" y="-2215.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8917" y="-2200.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, hidden_size]</text>
<text text-anchor="middle" x="8917" y="-2185.8" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- pre_layer1_attn -->
<g id="node2" class="node">
<title>pre_layer1_attn</title>
<polygon fill="#e6f3ff" stroke="black" points="9026,-2141 8808,-2141 8808,-2088 9026,-2088 9026,-2141"/>
<text text-anchor="middle" x="8917" y="-2125.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="8917" y="-2110.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, hidden_size]</text>
<text text-anchor="middle" x="8917" y="-2095.8" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- pre_layer1_norm&#45;&gt;pre_layer1_attn -->
<g id="edge1" class="edge">
<title>pre_layer1_norm&#45;&gt;pre_layer1_attn</title>
<path fill="none" stroke="black" d="M8917,-2177.57C8917,-2169.34 8917,-2160.08 8917,-2151.28"/>
<polygon fill="black" stroke="black" points="8920.5,-2151.24 8917,-2141.24 8913.5,-2151.24 8920.5,-2151.24"/>
</g>
<!-- router1 -->
<g id="node3" class="node">
<title>router1</title>
<polygon fill="#e6f3ff" stroke="black" points="9022.5,-2051 8811.5,-2051 8811.5,-1998 9022.5,-1998 9022.5,-2051"/>
<text text-anchor="middle" x="8917" y="-2035.8" font-family="Times,serif" font-size="14.00">Router/Gating</text>
<text text-anchor="middle" x="8917" y="-2020.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 64 experts]</text>
<text text-anchor="middle" x="8917" y="-2005.8" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- pre_layer1_attn&#45;&gt;router1 -->
<g id="edge2" class="edge">
<title>pre_layer1_attn&#45;&gt;router1</title>
<path fill="none" stroke="black" d="M8917,-2087.57C8917,-2079.34 8917,-2070.08 8917,-2061.28"/>
<polygon fill="black" stroke="black" points="8920.5,-2061.24 8917,-2051.24 8913.5,-2061.24 8920.5,-2061.24"/>
</g>
<!-- expert1_0 -->
<g id="node4" class="node">
<title>expert1_0</title>
<polygon fill="#e6f3ff" stroke="black" points="283.5,-1932 62.5,-1932 62.5,-1864 283.5,-1864 283.5,-1932"/>
<text text-anchor="middle" x="173" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="173" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="173" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="173" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- router1&#45;&gt;expert1_0 -->
<g id="edge3" class="edge">
<title>router1&#45;&gt;expert1_0</title>
<path fill="none" stroke="black" d="M8811.4,-2023.49C7818.63,-2023.29 159.3,-2020.5 119,-1980 107.34,-1968.28 112.47,-1953.7 123.27,-1940.14"/>
<polygon fill="black" stroke="black" points="126.19,-1942.12 130.19,-1932.31 120.95,-1937.48 126.19,-1942.12"/>
<text text-anchor="middle" x="248.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 0</text>
<text text-anchor="middle" x="248.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_1 -->
<g id="node5" class="node">
<title>expert1_1</title>
<polygon fill="#e6f3ff" stroke="black" points="540.5,-1932 319.5,-1932 319.5,-1864 540.5,-1864 540.5,-1932"/>
<text text-anchor="middle" x="430" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="430" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="430" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="430" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- router1&#45;&gt;expert1_1 -->
<g id="edge4" class="edge">
<title>router1&#45;&gt;expert1_1</title>
<path fill="none" stroke="black" d="M8811.23,-2023.47C7834.9,-2023.12 428.02,-2019.22 389,-1980 378.05,-1968.99 381.6,-1954.45 390.12,-1940.74"/>
<polygon fill="black" stroke="black" points="393.12,-1942.54 395.98,-1932.34 387.38,-1938.54 393.12,-1942.54"/>
<text text-anchor="middle" x="518.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 1</text>
<text text-anchor="middle" x="518.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_2 -->
<g id="node6" class="node">
<title>expert1_2</title>
<polygon fill="#e6f3ff" stroke="black" points="788.5,-1932 567.5,-1932 567.5,-1864 788.5,-1864 788.5,-1932"/>
<text text-anchor="middle" x="678" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="678" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="678" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="678" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- router1&#45;&gt;expert1_2 -->
<g id="edge5" class="edge">
<title>router1&#45;&gt;expert1_2</title>
<path fill="none" stroke="black" d="M8811.24,-2023.45C7852.56,-2022.95 698.72,-2017.92 661,-1980 650.96,-1969.9 651.24,-1955.48 655.36,-1941.6"/>
<polygon fill="black" stroke="black" points="658.67,-1942.72 658.74,-1932.13 652.08,-1940.37 658.67,-1942.72"/>
<text text-anchor="middle" x="790.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 2</text>
<text text-anchor="middle" x="790.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_3 -->
<g id="node7" class="node">
<title>expert1_3</title>
<polygon fill="#e6f3ff" stroke="black" points="1032.5,-1932 811.5,-1932 811.5,-1864 1032.5,-1864 1032.5,-1932"/>
<text text-anchor="middle" x="922" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="922" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="922" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="922" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- router1&#45;&gt;expert1_3 -->
<g id="edge6" class="edge">
<title>router1&#45;&gt;expert1_3</title>
<path fill="none" stroke="black" d="M8811.25,-2023.36C7871.44,-2022.09 983.72,-2011.69 943,-1980 931.47,-1971.03 925.76,-1956.6 923.07,-1942.39"/>
<polygon fill="black" stroke="black" points="926.49,-1941.57 921.61,-1932.16 919.56,-1942.56 926.49,-1941.57"/>
<text text-anchor="middle" x="1072.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 3</text>
<text text-anchor="middle" x="1072.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_4 -->
<g id="node8" class="node">
<title>expert1_4</title>
<polygon fill="#e6f3ff" stroke="black" points="1314.5,-1932 1093.5,-1932 1093.5,-1864 1314.5,-1864 1314.5,-1932"/>
<text text-anchor="middle" x="1204" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1204" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="1204" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="1204" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- router1&#45;&gt;expert1_4 -->
<g id="edge7" class="edge">
<title>router1&#45;&gt;expert1_4</title>
<path fill="none" stroke="black" d="M8811.39,-2023.34C7891.02,-2021.91 1264.23,-2010.53 1225,-1980 1213.47,-1971.02 1207.76,-1956.6 1205.07,-1942.39"/>
<polygon fill="black" stroke="black" points="1208.49,-1941.57 1203.61,-1932.16 1201.56,-1942.56 1208.49,-1941.57"/>
<text text-anchor="middle" x="1354.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 4</text>
<text text-anchor="middle" x="1354.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_5 -->
<g id="node9" class="node">
<title>expert1_5</title>
<polygon fill="#e6f3ff" stroke="black" points="1596.5,-1932 1375.5,-1932 1375.5,-1864 1596.5,-1864 1596.5,-1932"/>
<text text-anchor="middle" x="1486" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="1486" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="1486" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="1486" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- router1&#45;&gt;expert1_5 -->
<g id="edge8" class="edge">
<title>router1&#45;&gt;expert1_5</title>
<path fill="none" stroke="black" d="M8811.39,-2023.32C7910.22,-2021.72 1544.73,-2009.37 1507,-1980 1495.47,-1971.02 1489.76,-1956.6 1487.07,-1942.39"/>
<polygon fill="black" stroke="black" points="1490.49,-1941.57 1485.61,-1932.16 1483.56,-1942.55 1490.49,-1941.57"/>
<text text-anchor="middle" x="1636.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 5</text>
<text text-anchor="middle" x="1636.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_6 -->
<g id="node10" class="node">
<title>expert1_6</title>
<polygon fill="#e6f3ff" stroke="black" points="1878.5,-1932 1657.5,-1932 1657.5,-1864 1878.5,-1864 1878.5,-1932"/>
<text text-anchor="middle" x="1768" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1768" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="1768" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="1768" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- router1&#45;&gt;expert1_6 -->
<g id="edge9" class="edge">
<title>router1&#45;&gt;expert1_6</title>
<path fill="none" stroke="black" d="M8811.27,-2023.29C7929.24,-2021.52 1825.23,-2008.22 1789,-1980 1777.47,-1971.02 1771.76,-1956.59 1769.07,-1942.39"/>
<polygon fill="black" stroke="black" points="1772.49,-1941.56 1767.61,-1932.16 1765.56,-1942.55 1772.49,-1941.56"/>
<text text-anchor="middle" x="1918.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 6</text>
<text text-anchor="middle" x="1918.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_7 -->
<g id="node11" class="node">
<title>expert1_7</title>
<polygon fill="#e6f3ff" stroke="black" points="2160.5,-1932 1939.5,-1932 1939.5,-1864 2160.5,-1864 2160.5,-1932"/>
<text text-anchor="middle" x="2050" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2050" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="2050" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="2050" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- router1&#45;&gt;expert1_7 -->
<g id="edge10" class="edge">
<title>router1&#45;&gt;expert1_7</title>
<path fill="none" stroke="black" d="M8811.41,-2023.27C7949.82,-2021.31 2105.74,-2007.06 2071,-1980 2059.47,-1971.02 2053.76,-1956.59 2051.08,-1942.38"/>
<polygon fill="black" stroke="black" points="2054.49,-1941.56 2049.61,-1932.16 2047.56,-1942.55 2054.49,-1941.56"/>
<text text-anchor="middle" x="2200.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 7</text>
<text text-anchor="middle" x="2200.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_8 -->
<g id="node12" class="node">
<title>expert1_8</title>
<polygon fill="#e6f3ff" stroke="black" points="2442.5,-1932 2221.5,-1932 2221.5,-1864 2442.5,-1864 2442.5,-1932"/>
<text text-anchor="middle" x="2332" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="2332" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="2332" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="2332" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- router1&#45;&gt;expert1_8 -->
<g id="edge11" class="edge">
<title>router1&#45;&gt;expert1_8</title>
<path fill="none" stroke="black" d="M8811.47,-2023.24C7970.48,-2021.1 2386.25,-2005.91 2353,-1980 2341.47,-1971.02 2335.76,-1956.59 2333.08,-1942.38"/>
<polygon fill="black" stroke="black" points="2336.49,-1941.56 2331.62,-1932.16 2329.57,-1942.55 2336.49,-1941.56"/>
<text text-anchor="middle" x="2482.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 8</text>
<text text-anchor="middle" x="2482.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_9 -->
<g id="node13" class="node">
<title>expert1_9</title>
<polygon fill="#e6f3ff" stroke="black" points="2724.5,-1932 2503.5,-1932 2503.5,-1864 2724.5,-1864 2724.5,-1932"/>
<text text-anchor="middle" x="2614" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="2614" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="2614" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="2614" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- router1&#45;&gt;expert1_9 -->
<g id="edge12" class="edge">
<title>router1&#45;&gt;expert1_9</title>
<path fill="none" stroke="black" d="M8811.41,-2023.65C7993.5,-2024.69 2698.5,-2029.49 2635,-1980 2623.47,-1971.02 2617.76,-1956.59 2615.08,-1942.38"/>
<polygon fill="black" stroke="black" points="2618.5,-1941.56 2613.62,-1932.15 2611.57,-1942.55 2618.5,-1941.56"/>
<text text-anchor="middle" x="2764.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 9</text>
<text text-anchor="middle" x="2764.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_10 -->
<g id="node14" class="node">
<title>expert1_10</title>
<polygon fill="#e6f3ff" stroke="black" points="3006.5,-1932 2785.5,-1932 2785.5,-1864 3006.5,-1864 3006.5,-1932"/>
<text text-anchor="middle" x="2896" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="2896" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="2896" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="2896" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- router1&#45;&gt;expert1_10 -->
<g id="edge13" class="edge">
<title>router1&#45;&gt;expert1_10</title>
<path fill="none" stroke="black" d="M8811.45,-2023.61C8014.9,-2024.36 2977.52,-2027.19 2917,-1980 2905.48,-1971.02 2899.77,-1956.59 2897.08,-1942.38"/>
<polygon fill="black" stroke="black" points="2900.5,-1941.56 2895.62,-1932.15 2893.57,-1942.55 2900.5,-1941.56"/>
<text text-anchor="middle" x="3046.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 10</text>
<text text-anchor="middle" x="3046.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_11 -->
<g id="node15" class="node">
<title>expert1_11</title>
<polygon fill="#e6f3ff" stroke="black" points="3288.5,-1932 3067.5,-1932 3067.5,-1864 3288.5,-1864 3288.5,-1932"/>
<text text-anchor="middle" x="3178" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="3178" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="3178" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="3178" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- router1&#45;&gt;expert1_11 -->
<g id="edge14" class="edge">
<title>router1&#45;&gt;expert1_11</title>
<path fill="none" stroke="black" d="M8811.22,-2023.57C8035.68,-2024.01 3256.54,-2024.88 3199,-1980 3187.48,-1971.01 3181.77,-1956.58 3179.08,-1942.38"/>
<polygon fill="black" stroke="black" points="3182.5,-1941.55 3177.62,-1932.15 3175.57,-1942.55 3182.5,-1941.55"/>
<text text-anchor="middle" x="3328.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 11</text>
<text text-anchor="middle" x="3328.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_12 -->
<g id="node16" class="node">
<title>expert1_12</title>
<polygon fill="#e6f3ff" stroke="black" points="3570.5,-1932 3349.5,-1932 3349.5,-1864 3570.5,-1864 3570.5,-1932"/>
<text text-anchor="middle" x="3460" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="3460" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="3460" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="3460" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- router1&#45;&gt;expert1_12 -->
<g id="edge15" class="edge">
<title>router1&#45;&gt;expert1_12</title>
<path fill="none" stroke="black" d="M8811.38,-2023.53C8058.65,-2023.65 3535.57,-2022.58 3481,-1980 3469.48,-1971.01 3463.77,-1956.58 3461.08,-1942.37"/>
<polygon fill="black" stroke="black" points="3464.5,-1941.55 3459.62,-1932.15 3457.57,-1942.54 3464.5,-1941.55"/>
<text text-anchor="middle" x="3610.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 12</text>
<text text-anchor="middle" x="3610.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_13 -->
<g id="node17" class="node">
<title>expert1_13</title>
<polygon fill="#e6f3ff" stroke="black" points="3852.5,-1932 3631.5,-1932 3631.5,-1864 3852.5,-1864 3852.5,-1932"/>
<text text-anchor="middle" x="3742" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="3742" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="3742" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="3742" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- router1&#45;&gt;expert1_13 -->
<g id="edge16" class="edge">
<title>router1&#45;&gt;expert1_13</title>
<path fill="none" stroke="black" d="M8811.37,-2023.48C8081.5,-2023.27 3814.6,-2020.28 3763,-1980 3751.48,-1971.01 3745.77,-1956.58 3743.09,-1942.37"/>
<polygon fill="black" stroke="black" points="3746.5,-1941.55 3741.62,-1932.15 3739.57,-1942.54 3746.5,-1941.55"/>
<text text-anchor="middle" x="3892.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 13</text>
<text text-anchor="middle" x="3892.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_14 -->
<g id="node18" class="node">
<title>expert1_14</title>
<polygon fill="#e6f3ff" stroke="black" points="4134.5,-1932 3913.5,-1932 3913.5,-1864 4134.5,-1864 4134.5,-1932"/>
<text text-anchor="middle" x="4024" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="4024" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4024" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="4024" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- router1&#45;&gt;expert1_14 -->
<g id="edge17" class="edge">
<title>router1&#45;&gt;expert1_14</title>
<path fill="none" stroke="black" d="M8811.27,-2023.43C8104.63,-2022.86 4093.63,-2017.98 4045,-1980 4033.48,-1971.01 4027.77,-1956.57 4025.09,-1942.37"/>
<polygon fill="black" stroke="black" points="4028.51,-1941.55 4023.63,-1932.14 4021.58,-1942.54 4028.51,-1941.55"/>
<text text-anchor="middle" x="4174.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 14</text>
<text text-anchor="middle" x="4174.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_15 -->
<g id="node19" class="node">
<title>expert1_15</title>
<polygon fill="#e6f3ff" stroke="black" points="4416.5,-1932 4195.5,-1932 4195.5,-1864 4416.5,-1864 4416.5,-1932"/>
<text text-anchor="middle" x="4306" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="4306" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4306" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="4306" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- router1&#45;&gt;expert1_15 -->
<g id="edge18" class="edge">
<title>router1&#45;&gt;expert1_15</title>
<path fill="none" stroke="black" d="M8811.43,-2023.37C8129.43,-2022.44 4372.67,-2015.69 4327,-1980 4315.49,-1971 4309.78,-1956.57 4307.09,-1942.36"/>
<polygon fill="black" stroke="black" points="4310.51,-1941.54 4305.63,-1932.14 4303.58,-1942.53 4310.51,-1941.54"/>
<text text-anchor="middle" x="4456.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 15</text>
<text text-anchor="middle" x="4456.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_16 -->
<g id="node20" class="node">
<title>expert1_16</title>
<polygon fill="#e6f3ff" stroke="black" points="4698.5,-1932 4477.5,-1932 4477.5,-1864 4698.5,-1864 4698.5,-1932"/>
<text text-anchor="middle" x="4588" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 16</text>
<text text-anchor="middle" x="4588" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4588" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="4588" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- router1&#45;&gt;expert1_16 -->
<g id="edge19" class="edge">
<title>router1&#45;&gt;expert1_16</title>
<path fill="none" stroke="black" d="M8811.37,-2023.3C8154.18,-2021.99 4651.71,-2013.4 4609,-1980 4597.49,-1971 4591.78,-1956.57 4589.09,-1942.36"/>
<polygon fill="black" stroke="black" points="4592.51,-1941.54 4587.63,-1932.14 4585.58,-1942.53 4592.51,-1941.54"/>
<text text-anchor="middle" x="4738.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 16</text>
<text text-anchor="middle" x="4738.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_17 -->
<g id="node21" class="node">
<title>expert1_17</title>
<polygon fill="#e6f3ff" stroke="black" points="4980.5,-1932 4759.5,-1932 4759.5,-1864 4980.5,-1864 4980.5,-1932"/>
<text text-anchor="middle" x="4870" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 17</text>
<text text-anchor="middle" x="4870" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4870" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="4870" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- router1&#45;&gt;expert1_17 -->
<g id="edge20" class="edge">
<title>router1&#45;&gt;expert1_17</title>
<path fill="none" stroke="black" d="M8811.48,-2023.23C8180.34,-2021.5 4930.76,-2011.11 4891,-1980 4879.49,-1971 4873.79,-1956.56 4871.1,-1942.36"/>
<polygon fill="black" stroke="black" points="4874.52,-1941.54 4869.63,-1932.13 4867.59,-1942.53 4874.52,-1941.54"/>
<text text-anchor="middle" x="5020.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 17</text>
<text text-anchor="middle" x="5020.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_18 -->
<g id="node22" class="node">
<title>expert1_18</title>
<polygon fill="#e6f3ff" stroke="black" points="5262.5,-1932 5041.5,-1932 5041.5,-1864 5262.5,-1864 5262.5,-1932"/>
<text text-anchor="middle" x="5152" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 18</text>
<text text-anchor="middle" x="5152" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5152" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="5152" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- router1&#45;&gt;expert1_18 -->
<g id="edge21" class="edge">
<title>router1&#45;&gt;expert1_18</title>
<path fill="none" stroke="black" d="M8811.11,-2023.14C8205.84,-2020.98 5209.8,-2008.82 5173,-1980 5161.5,-1970.99 5155.79,-1956.56 5153.1,-1942.35"/>
<polygon fill="black" stroke="black" points="5156.52,-1941.53 5151.64,-1932.13 5149.59,-1942.52 5156.52,-1941.53"/>
<text text-anchor="middle" x="5302.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 18</text>
<text text-anchor="middle" x="5302.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_19 -->
<g id="node23" class="node">
<title>expert1_19</title>
<polygon fill="#e6f3ff" stroke="black" points="5544.5,-1932 5323.5,-1932 5323.5,-1864 5544.5,-1864 5544.5,-1932"/>
<text text-anchor="middle" x="5434" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 19</text>
<text text-anchor="middle" x="5434" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5434" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="5434" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;20</text>
</g>
<!-- router1&#45;&gt;expert1_19 -->
<g id="edge22" class="edge">
<title>router1&#45;&gt;expert1_19</title>
<path fill="none" stroke="black" d="M8811.2,-2023.04C8233.88,-2020.41 5488.86,-2006.55 5455,-1980 5443.5,-1970.98 5437.79,-1956.55 5435.11,-1942.34"/>
<polygon fill="black" stroke="black" points="5438.52,-1941.53 5433.64,-1932.12 5431.6,-1942.52 5438.52,-1941.53"/>
<text text-anchor="middle" x="5584.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 19</text>
<text text-anchor="middle" x="5584.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_20 -->
<g id="node24" class="node">
<title>expert1_20</title>
<polygon fill="#e6f3ff" stroke="black" points="5826.5,-1932 5605.5,-1932 5605.5,-1864 5826.5,-1864 5826.5,-1932"/>
<text text-anchor="middle" x="5716" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 20</text>
<text text-anchor="middle" x="5716" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5716" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="5716" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;21</text>
</g>
<!-- router1&#45;&gt;expert1_20 -->
<g id="edge23" class="edge">
<title>router1&#45;&gt;expert1_20</title>
<path fill="none" stroke="black" d="M8811.18,-2023.8C8266.18,-2025.14 5798.81,-2028.51 5737,-1980 5725.5,-1970.98 5719.8,-1956.54 5717.11,-1942.34"/>
<polygon fill="black" stroke="black" points="5720.53,-1941.52 5715.65,-1932.12 5713.6,-1942.51 5720.53,-1941.52"/>
<text text-anchor="middle" x="5866.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 20</text>
<text text-anchor="middle" x="5866.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_21 -->
<g id="node25" class="node">
<title>expert1_21</title>
<polygon fill="#e6f3ff" stroke="black" points="6108.5,-1932 5887.5,-1932 5887.5,-1864 6108.5,-1864 6108.5,-1932"/>
<text text-anchor="middle" x="5998" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 21</text>
<text text-anchor="middle" x="5998" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5998" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="5998" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;22</text>
</g>
<!-- router1&#45;&gt;expert1_21 -->
<g id="edge24" class="edge">
<title>router1&#45;&gt;expert1_21</title>
<path fill="none" stroke="black" d="M8811.33,-2023.67C8296.54,-2024.27 6073.72,-2024.32 6018,-1980 6006.6,-1970.93 6001.07,-1956.48 5998.56,-1942.28"/>
<polygon fill="black" stroke="black" points="6001.99,-1941.53 5997.22,-1932.07 5995.05,-1942.44 6001.99,-1941.53"/>
<text text-anchor="middle" x="6147.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 21</text>
<text text-anchor="middle" x="6147.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_22 -->
<g id="node26" class="node">
<title>expert1_22</title>
<polygon fill="#e6f3ff" stroke="black" points="6390.5,-1932 6169.5,-1932 6169.5,-1864 6390.5,-1864 6390.5,-1932"/>
<text text-anchor="middle" x="6280" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 22</text>
<text text-anchor="middle" x="6280" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="6280" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="6280" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;23</text>
</g>
<!-- router1&#45;&gt;expert1_22 -->
<g id="edge25" class="edge">
<title>router1&#45;&gt;expert1_22</title>
<path fill="none" stroke="black" d="M8811.31,-2023.51C8327.89,-2023.31 6348.7,-2020.07 6299,-1980 6287.69,-1970.88 6282.33,-1956.42 6280,-1942.23"/>
<polygon fill="black" stroke="black" points="6283.44,-1941.54 6278.79,-1932.02 6276.49,-1942.36 6283.44,-1941.54"/>
<text text-anchor="middle" x="6428.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 22</text>
<text text-anchor="middle" x="6428.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_23 -->
<g id="node27" class="node">
<title>expert1_23</title>
<polygon fill="#e6f3ff" stroke="black" points="6672.5,-1932 6451.5,-1932 6451.5,-1864 6672.5,-1864 6672.5,-1932"/>
<text text-anchor="middle" x="6562" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 23</text>
<text text-anchor="middle" x="6562" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="6562" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="6562" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;24</text>
</g>
<!-- router1&#45;&gt;expert1_23 -->
<g id="edge26" class="edge">
<title>router1&#45;&gt;expert1_23</title>
<path fill="none" stroke="black" d="M8811.13,-2023.31C8360.42,-2022.29 6622.54,-2016.03 6579,-1980 6567.95,-1970.86 6562.94,-1956.54 6560.93,-1942.46"/>
<polygon fill="black" stroke="black" points="6564.39,-1941.96 6559.95,-1932.34 6557.42,-1942.63 6564.39,-1941.96"/>
<text text-anchor="middle" x="6708.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 23</text>
<text text-anchor="middle" x="6708.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_24 -->
<g id="node28" class="node">
<title>expert1_24</title>
<polygon fill="#e6f3ff" stroke="black" points="6954.5,-1932 6733.5,-1932 6733.5,-1864 6954.5,-1864 6954.5,-1932"/>
<text text-anchor="middle" x="6844" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 24</text>
<text text-anchor="middle" x="6844" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="6844" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="6844" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;25</text>
</g>
<!-- router1&#45;&gt;expert1_24 -->
<g id="edge27" class="edge">
<title>router1&#45;&gt;expert1_24</title>
<path fill="none" stroke="black" d="M8811.29,-2023.09C8395.6,-2021.25 6894.18,-2012.37 6857,-1980 6846.28,-1970.67 6841.94,-1956.31 6840.64,-1942.25"/>
<polygon fill="black" stroke="black" points="6844.13,-1941.98 6840.18,-1932.15 6837.14,-1942.3 6844.13,-1941.98"/>
<text text-anchor="middle" x="6986.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 24</text>
<text text-anchor="middle" x="6986.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_25 -->
<g id="node29" class="node">
<title>expert1_25</title>
<polygon fill="#e6f3ff" stroke="black" points="7236.5,-1932 7015.5,-1932 7015.5,-1864 7236.5,-1864 7236.5,-1932"/>
<text text-anchor="middle" x="7126" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 25</text>
<text text-anchor="middle" x="7126" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7126" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="7126" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;26</text>
</g>
<!-- router1&#45;&gt;expert1_25 -->
<g id="edge28" class="edge">
<title>router1&#45;&gt;expert1_25</title>
<path fill="none" stroke="black" d="M8811.22,-2022.79C8432.49,-2020.03 7164.87,-2008.67 7134,-1980 7123.75,-1970.48 7120.23,-1956.22 7119.77,-1942.3"/>
<polygon fill="black" stroke="black" points="7123.27,-1942.35 7119.92,-1932.3 7116.27,-1942.24 7123.27,-1942.35"/>
<text text-anchor="middle" x="7263.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 25</text>
<text text-anchor="middle" x="7263.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_26 -->
<g id="node30" class="node">
<title>expert1_26</title>
<polygon fill="#e6f3ff" stroke="black" points="7517.5,-1932 7296.5,-1932 7296.5,-1864 7517.5,-1864 7517.5,-1932"/>
<text text-anchor="middle" x="7407" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 26</text>
<text text-anchor="middle" x="7407" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7407" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="7407" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;27</text>
</g>
<!-- router1&#45;&gt;expert1_26 -->
<g id="edge29" class="edge">
<title>router1&#45;&gt;expert1_26</title>
<path fill="none" stroke="black" d="M8811.44,-2022.39C8472.71,-2018.57 7433.74,-2004.84 7409,-1980 7399.35,-1970.31 7396.74,-1956.3 7397.22,-1942.64"/>
<polygon fill="black" stroke="black" points="7400.73,-1942.62 7398.12,-1932.35 7393.76,-1942.01 7400.73,-1942.62"/>
<text text-anchor="middle" x="7538.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 26</text>
<text text-anchor="middle" x="7538.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_27 -->
<g id="node31" class="node">
<title>expert1_27</title>
<polygon fill="#e6f3ff" stroke="black" points="7797.5,-1932 7576.5,-1932 7576.5,-1864 7797.5,-1864 7797.5,-1932"/>
<text text-anchor="middle" x="7687" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 27</text>
<text text-anchor="middle" x="7687" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7687" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="7687" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;28</text>
</g>
<!-- router1&#45;&gt;expert1_27 -->
<g id="edge30" class="edge">
<title>router1&#45;&gt;expert1_27</title>
<path fill="none" stroke="black" d="M8811.42,-2023.71C8519.77,-2023.79 7721.9,-2020.29 7683,-1980 7673.4,-1970.06 7671.75,-1955.83 7673.37,-1942.06"/>
<polygon fill="black" stroke="black" points="7676.82,-1942.63 7675.05,-1932.19 7669.92,-1941.46 7676.82,-1942.63"/>
<text text-anchor="middle" x="7812.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 27</text>
<text text-anchor="middle" x="7812.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_28 -->
<g id="node32" class="node">
<title>expert1_28</title>
<polygon fill="#e6f3ff" stroke="black" points="8076.5,-1932 7855.5,-1932 7855.5,-1864 8076.5,-1864 8076.5,-1932"/>
<text text-anchor="middle" x="7966" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 28</text>
<text text-anchor="middle" x="7966" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7966" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="7966" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;29</text>
</g>
<!-- router1&#45;&gt;expert1_28 -->
<g id="edge31" class="edge">
<title>router1&#45;&gt;expert1_28</title>
<path fill="none" stroke="black" d="M8811.1,-2022.58C8567.35,-2019.96 7985.15,-2010.5 7956,-1980 7946.39,-1969.94 7945.62,-1955.69 7948.32,-1941.93"/>
<polygon fill="black" stroke="black" points="7951.76,-1942.63 7950.83,-1932.07 7944.98,-1940.9 7951.76,-1942.63"/>
<text text-anchor="middle" x="8085.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 28</text>
<text text-anchor="middle" x="8085.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_29 -->
<g id="node33" class="node">
<title>expert1_29</title>
<polygon fill="#e6f3ff" stroke="black" points="8351.5,-1932 8130.5,-1932 8130.5,-1864 8351.5,-1864 8351.5,-1932"/>
<text text-anchor="middle" x="8241" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 29</text>
<text text-anchor="middle" x="8241" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8241" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="8241" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;30</text>
</g>
<!-- router1&#45;&gt;expert1_29 -->
<g id="edge32" class="edge">
<title>router1&#45;&gt;expert1_29</title>
<path fill="none" stroke="black" d="M8811.2,-2020.58C8622.95,-2014.86 8247.62,-2000.9 8228,-1980 8218.51,-1969.89 8218.12,-1955.75 8221.28,-1942.12"/>
<polygon fill="black" stroke="black" points="8224.69,-1942.92 8224.13,-1932.34 8217.97,-1940.96 8224.69,-1942.92"/>
<text text-anchor="middle" x="8357.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 29</text>
<text text-anchor="middle" x="8357.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_30 -->
<g id="node34" class="node">
<title>expert1_30</title>
<polygon fill="#e6f3ff" stroke="black" points="8619.5,-1932 8398.5,-1932 8398.5,-1864 8619.5,-1864 8619.5,-1932"/>
<text text-anchor="middle" x="8509" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 30</text>
<text text-anchor="middle" x="8509" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8509" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="8509" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;31</text>
</g>
<!-- router1&#45;&gt;expert1_30 -->
<g id="edge33" class="edge">
<title>router1&#45;&gt;expert1_30</title>
<path fill="none" stroke="black" d="M8811.34,-2019.68C8694.96,-2014.36 8521.46,-2002.71 8501,-1980 8491.88,-1969.88 8490.77,-1955.89 8492.92,-1942.38"/>
<polygon fill="black" stroke="black" points="8496.42,-1942.74 8495.12,-1932.22 8489.58,-1941.25 8496.42,-1942.74"/>
<text text-anchor="middle" x="8630.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 30</text>
<text text-anchor="middle" x="8630.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_31 -->
<g id="node35" class="node">
<title>expert1_31</title>
<polygon fill="#e6f3ff" stroke="black" points="8886.5,-1932 8665.5,-1932 8665.5,-1864 8886.5,-1864 8886.5,-1932"/>
<text text-anchor="middle" x="8776" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 31</text>
<text text-anchor="middle" x="8776" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8776" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="8776" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;32</text>
</g>
<!-- router1&#45;&gt;expert1_31 -->
<g id="edge34" class="edge">
<title>router1&#45;&gt;expert1_31</title>
<path fill="none" stroke="black" d="M8811.24,-2008.97C8796.29,-2002.4 8782.73,-1993.1 8773,-1980 8765.04,-1969.29 8763.39,-1955.4 8764.47,-1942.15"/>
<polygon fill="black" stroke="black" points="8767.94,-1942.58 8765.76,-1932.21 8761,-1941.68 8767.94,-1942.58"/>
<text text-anchor="middle" x="8902.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 31</text>
<text text-anchor="middle" x="8902.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_32 -->
<g id="node36" class="node">
<title>expert1_32</title>
<polygon fill="#e6f3ff" stroke="black" points="9146.5,-1932 8925.5,-1932 8925.5,-1864 9146.5,-1864 9146.5,-1932"/>
<text text-anchor="middle" x="9036" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 32</text>
<text text-anchor="middle" x="9036" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9036" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="9036" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;33</text>
</g>
<!-- router1&#45;&gt;expert1_32 -->
<g id="edge35" class="edge">
<title>router1&#45;&gt;expert1_32</title>
<path fill="none" stroke="black" d="M9017.96,-1997.88C9024.9,-1992.93 9031.08,-1987.03 9036,-1980 9043.5,-1969.27 9045.55,-1955.63 9045.11,-1942.62"/>
<polygon fill="black" stroke="black" points="9048.58,-1942.07 9044.29,-1932.38 9041.6,-1942.63 9048.58,-1942.07"/>
<text text-anchor="middle" x="9173.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 32</text>
<text text-anchor="middle" x="9173.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_33 -->
<g id="node37" class="node">
<title>expert1_33</title>
<polygon fill="#e6f3ff" stroke="black" points="9417.5,-1932 9196.5,-1932 9196.5,-1864 9417.5,-1864 9417.5,-1932"/>
<text text-anchor="middle" x="9307" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 33</text>
<text text-anchor="middle" x="9307" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9307" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="9307" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;34</text>
</g>
<!-- router1&#45;&gt;expert1_33 -->
<g id="edge36" class="edge">
<title>router1&#45;&gt;expert1_33</title>
<path fill="none" stroke="black" d="M9022.7,-2018.86C9131.66,-2012.96 9288.26,-2000.94 9307,-1980 9316.04,-1969.89 9318.27,-1955.91 9317.54,-1942.4"/>
<polygon fill="black" stroke="black" points="9321,-1941.82 9316.47,-1932.24 9314.04,-1942.55 9321,-1941.82"/>
<text text-anchor="middle" x="9446.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 33</text>
<text text-anchor="middle" x="9446.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_34 -->
<g id="node38" class="node">
<title>expert1_34</title>
<polygon fill="#e6f3ff" stroke="black" points="9694.5,-1932 9473.5,-1932 9473.5,-1864 9694.5,-1864 9694.5,-1932"/>
<text text-anchor="middle" x="9584" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 34</text>
<text text-anchor="middle" x="9584" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9584" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="9584" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;35</text>
</g>
<!-- router1&#45;&gt;expert1_34 -->
<g id="edge37" class="edge">
<title>router1&#45;&gt;expert1_34</title>
<path fill="none" stroke="black" d="M9022.67,-2024.1C9199.98,-2024.03 9541.85,-2018.77 9580,-1980 9589.6,-1970.24 9592.49,-1956.22 9592.37,-1942.57"/>
<polygon fill="black" stroke="black" points="9595.85,-1942.06 9591.76,-1932.28 9588.86,-1942.47 9595.85,-1942.06"/>
<text text-anchor="middle" x="9721.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 34</text>
<text text-anchor="middle" x="9721.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_35 -->
<g id="node39" class="node">
<title>expert1_35</title>
<polygon fill="#e6f3ff" stroke="black" points="9973.5,-1932 9752.5,-1932 9752.5,-1864 9973.5,-1864 9973.5,-1932"/>
<text text-anchor="middle" x="9863" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 35</text>
<text text-anchor="middle" x="9863" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9863" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="9863" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;36</text>
</g>
<!-- router1&#45;&gt;expert1_35 -->
<g id="edge38" class="edge">
<title>router1&#45;&gt;expert1_35</title>
<path fill="none" stroke="black" d="M9022.83,-2022.26C9261.89,-2018.97 9825.24,-2008.25 9855,-1980 9865.05,-1970.46 9868.57,-1956.36 9869.1,-1942.58"/>
<polygon fill="black" stroke="black" points="9872.59,-1942.14 9868.97,-1932.18 9865.59,-1942.22 9872.59,-1942.14"/>
<text text-anchor="middle" x="9997.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 35</text>
<text text-anchor="middle" x="9997.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_36 -->
<g id="node40" class="node">
<title>expert1_36</title>
<polygon fill="#e6f3ff" stroke="black" points="10254.5,-1932 10033.5,-1932 10033.5,-1864 10254.5,-1864 10254.5,-1932"/>
<text text-anchor="middle" x="10144" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 36</text>
<text text-anchor="middle" x="10144" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10144" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="10144" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;37</text>
</g>
<!-- router1&#45;&gt;expert1_36 -->
<g id="edge39" class="edge">
<title>router1&#45;&gt;expert1_36</title>
<path fill="none" stroke="black" d="M9022.62,-2023.32C9310.43,-2022.36 10089.81,-2016.4 10131,-1980 10141.65,-1970.59 10145.97,-1956.21 10147.28,-1942.16"/>
<polygon fill="black" stroke="black" points="10150.78,-1942.22 10147.75,-1932.07 10143.79,-1941.9 10150.78,-1942.22"/>
<text text-anchor="middle" x="10274.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 36</text>
<text text-anchor="middle" x="10274.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_37 -->
<g id="node41" class="node">
<title>expert1_37</title>
<polygon fill="#e6f3ff" stroke="black" points="10535.5,-1932 10314.5,-1932 10314.5,-1864 10535.5,-1864 10535.5,-1932"/>
<text text-anchor="middle" x="10425" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 37</text>
<text text-anchor="middle" x="10425" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10425" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="10425" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;38</text>
</g>
<!-- router1&#45;&gt;expert1_37 -->
<g id="edge40" class="edge">
<title>router1&#45;&gt;expert1_37</title>
<path fill="none" stroke="black" d="M9022.54,-2023.97C9353.95,-2024.98 10355,-2024.33 10408,-1980 10419,-1970.8 10424,-1956.47 10426.02,-1942.4"/>
<polygon fill="black" stroke="black" points="10429.52,-1942.57 10427,-1932.28 10422.55,-1941.9 10429.52,-1942.57"/>
<text text-anchor="middle" x="10553.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 37</text>
<text text-anchor="middle" x="10553.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_38 -->
<g id="node42" class="node">
<title>expert1_38</title>
<polygon fill="#e6f3ff" stroke="black" points="10817.5,-1932 10596.5,-1932 10596.5,-1864 10817.5,-1864 10817.5,-1932"/>
<text text-anchor="middle" x="10707" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 38</text>
<text text-anchor="middle" x="10707" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10707" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="10707" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;39</text>
</g>
<!-- router1&#45;&gt;expert1_38 -->
<g id="edge41" class="edge">
<title>router1&#45;&gt;expert1_38</title>
<path fill="none" stroke="black" d="M9022.52,-2022.62C9398.83,-2019.28 10654.41,-2006.17 10687,-1980 10698.36,-1970.88 10703.88,-1956.42 10706.4,-1942.22"/>
<polygon fill="black" stroke="black" points="10709.91,-1942.39 10707.74,-1932.02 10702.96,-1941.48 10709.91,-1942.39"/>
<text text-anchor="middle" x="10833.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 38</text>
<text text-anchor="middle" x="10833.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_39 -->
<g id="node43" class="node">
<title>expert1_39</title>
<polygon fill="#e6f3ff" stroke="black" points="11099.5,-1932 10878.5,-1932 10878.5,-1864 11099.5,-1864 11099.5,-1932"/>
<text text-anchor="middle" x="10989" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 39</text>
<text text-anchor="middle" x="10989" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10989" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="10989" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;40</text>
</g>
<!-- router1&#45;&gt;expert1_39 -->
<g id="edge42" class="edge">
<title>router1&#45;&gt;expert1_39</title>
<path fill="none" stroke="black" d="M9022.8,-2022.96C9437.11,-2020.64 10928.37,-2010.19 10967,-1980 10978.55,-1970.97 10984.42,-1956.54 10987.29,-1942.33"/>
<polygon fill="black" stroke="black" points="10990.8,-1942.53 10988.89,-1932.11 10983.88,-1941.45 10990.8,-1942.53"/>
<text text-anchor="middle" x="11114.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 39</text>
<text text-anchor="middle" x="11114.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_40 -->
<g id="node44" class="node">
<title>expert1_40</title>
<polygon fill="#e6f3ff" stroke="black" points="11381.5,-1932 11160.5,-1932 11160.5,-1864 11381.5,-1864 11381.5,-1932"/>
<text text-anchor="middle" x="11271" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 40</text>
<text text-anchor="middle" x="11271" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11271" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="11271" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;41</text>
</g>
<!-- router1&#45;&gt;expert1_40 -->
<g id="edge43" class="edge">
<title>router1&#45;&gt;expert1_40</title>
<path fill="none" stroke="black" d="M9022.87,-2023.23C9472.57,-2021.86 11203.37,-2014.38 11248,-1980 11259.65,-1971.03 11265.69,-1956.6 11268.74,-1942.39"/>
<polygon fill="black" stroke="black" points="11272.25,-1942.61 11270.47,-1932.16 11265.35,-1941.44 11272.25,-1942.61"/>
<text text-anchor="middle" x="11395.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 40</text>
<text text-anchor="middle" x="11395.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_41 -->
<g id="node45" class="node">
<title>expert1_41</title>
<polygon fill="#e6f3ff" stroke="black" points="11663.5,-1932 11442.5,-1932 11442.5,-1864 11663.5,-1864 11663.5,-1932"/>
<text text-anchor="middle" x="11553" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 41</text>
<text text-anchor="middle" x="11553" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11553" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="11553" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;42</text>
</g>
<!-- router1&#45;&gt;expert1_41 -->
<g id="edge44" class="edge">
<title>router1&#45;&gt;expert1_41</title>
<path fill="none" stroke="black" d="M9022.8,-2023.44C9505.58,-2022.93 11478.3,-2018.52 11529,-1980 11540.75,-1971.08 11546.97,-1956.66 11550.19,-1942.44"/>
<polygon fill="black" stroke="black" points="11553.71,-1942.67 11552.05,-1932.21 11546.82,-1941.43 11553.71,-1942.67"/>
<text text-anchor="middle" x="11677.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 41</text>
<text text-anchor="middle" x="11677.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_42 -->
<g id="node46" class="node">
<title>expert1_42</title>
<polygon fill="#e6f3ff" stroke="black" points="11945.5,-1932 11724.5,-1932 11724.5,-1864 11945.5,-1864 11945.5,-1932"/>
<text text-anchor="middle" x="11835" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 42</text>
<text text-anchor="middle" x="11835" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11835" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="11835" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;43</text>
</g>
<!-- router1&#45;&gt;expert1_42 -->
<g id="edge45" class="edge">
<title>router1&#45;&gt;expert1_42</title>
<path fill="none" stroke="black" d="M9022.87,-2023.61C9537.39,-2023.96 11754.39,-2022.94 11811,-1980 11822.75,-1971.08 11828.98,-1956.67 11832.2,-1942.45"/>
<polygon fill="black" stroke="black" points="11835.72,-1942.68 11834.05,-1932.22 11828.83,-1941.44 11835.72,-1942.68"/>
<text text-anchor="middle" x="11959.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 42</text>
<text text-anchor="middle" x="11959.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_43 -->
<g id="node47" class="node">
<title>expert1_43</title>
<polygon fill="#e6f3ff" stroke="black" points="12227.5,-1932 12006.5,-1932 12006.5,-1864 12227.5,-1864 12227.5,-1932"/>
<text text-anchor="middle" x="12117" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 43</text>
<text text-anchor="middle" x="12117" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12117" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="12117" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;44</text>
</g>
<!-- router1&#45;&gt;expert1_43 -->
<g id="edge46" class="edge">
<title>router1&#45;&gt;expert1_43</title>
<path fill="none" stroke="black" d="M9022.65,-2023.76C9566.82,-2024.89 12030.44,-2027.38 12093,-1980 12104.76,-1971.09 12110.98,-1956.68 12114.21,-1942.46"/>
<polygon fill="black" stroke="black" points="12117.72,-1942.69 12116.06,-1932.23 12110.83,-1941.44 12117.72,-1942.69"/>
<text text-anchor="middle" x="12241.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 43</text>
<text text-anchor="middle" x="12241.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_44 -->
<g id="node48" class="node">
<title>expert1_44</title>
<polygon fill="#e6f3ff" stroke="black" points="12509.5,-1932 12288.5,-1932 12288.5,-1864 12509.5,-1864 12509.5,-1932"/>
<text text-anchor="middle" x="12399" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 44</text>
<text text-anchor="middle" x="12399" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12399" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="12399" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;45</text>
</g>
<!-- router1&#45;&gt;expert1_44 -->
<g id="edge47" class="edge">
<title>router1&#45;&gt;expert1_44</title>
<path fill="none" stroke="black" d="M9022.67,-2023.02C9599.23,-2020.28 12340.73,-2005.93 12375,-1980 12386.77,-1971.1 12392.99,-1956.69 12396.21,-1942.47"/>
<polygon fill="black" stroke="black" points="12399.73,-1942.7 12398.06,-1932.23 12392.84,-1941.45 12399.73,-1942.7"/>
<text text-anchor="middle" x="12523.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 44</text>
<text text-anchor="middle" x="12523.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_45 -->
<g id="node49" class="node">
<title>expert1_45</title>
<polygon fill="#e6f3ff" stroke="black" points="12791.5,-1932 12570.5,-1932 12570.5,-1864 12791.5,-1864 12791.5,-1932"/>
<text text-anchor="middle" x="12681" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 45</text>
<text text-anchor="middle" x="12681" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12681" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="12681" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;46</text>
</g>
<!-- router1&#45;&gt;expert1_45 -->
<g id="edge48" class="edge">
<title>router1&#45;&gt;expert1_45</title>
<path fill="none" stroke="black" d="M9022.76,-2023.12C9627.3,-2020.84 12619.75,-2008.16 12657,-1980 12668.77,-1971.1 12675,-1956.69 12678.22,-1942.48"/>
<polygon fill="black" stroke="black" points="12681.73,-1942.7 12680.07,-1932.24 12674.84,-1941.46 12681.73,-1942.7"/>
<text text-anchor="middle" x="12805.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 45</text>
<text text-anchor="middle" x="12805.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_46 -->
<g id="node50" class="node">
<title>expert1_46</title>
<polygon fill="#e6f3ff" stroke="black" points="13073.5,-1932 12852.5,-1932 12852.5,-1864 13073.5,-1864 13073.5,-1932"/>
<text text-anchor="middle" x="12963" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 46</text>
<text text-anchor="middle" x="12963" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12963" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="12963" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;47</text>
</g>
<!-- router1&#45;&gt;expert1_46 -->
<g id="edge49" class="edge">
<title>router1&#45;&gt;expert1_46</title>
<path fill="none" stroke="black" d="M9022.66,-2023.21C9653.7,-2021.36 12898.76,-2010.39 12939,-1980 12950.77,-1971.11 12957,-1956.7 12960.22,-1942.48"/>
<polygon fill="black" stroke="black" points="12963.74,-1942.71 12962.07,-1932.24 12956.85,-1941.46 12963.74,-1942.71"/>
<text text-anchor="middle" x="13087.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 46</text>
<text text-anchor="middle" x="13087.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_47 -->
<g id="node51" class="node">
<title>expert1_47</title>
<polygon fill="#e6f3ff" stroke="black" points="13355.5,-1932 13134.5,-1932 13134.5,-1864 13355.5,-1864 13355.5,-1932"/>
<text text-anchor="middle" x="13245" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 47</text>
<text text-anchor="middle" x="13245" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13245" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="13245" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;48</text>
</g>
<!-- router1&#45;&gt;expert1_47 -->
<g id="edge50" class="edge">
<title>router1&#45;&gt;expert1_47</title>
<path fill="none" stroke="black" d="M9022.52,-2023.28C9679.01,-2021.84 13177.76,-2012.63 13221,-1980 13232.78,-1971.11 13239,-1956.71 13242.22,-1942.49"/>
<polygon fill="black" stroke="black" points="13245.74,-1942.71 13244.07,-1932.25 13238.85,-1941.47 13245.74,-1942.71"/>
<text text-anchor="middle" x="13369.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 47</text>
<text text-anchor="middle" x="13369.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_48 -->
<g id="node52" class="node">
<title>expert1_48</title>
<polygon fill="#e6f3ff" stroke="black" points="13637.5,-1932 13416.5,-1932 13416.5,-1864 13637.5,-1864 13637.5,-1932"/>
<text text-anchor="middle" x="13527" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 48</text>
<text text-anchor="middle" x="13527" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13527" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="13527" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;49</text>
</g>
<!-- router1&#45;&gt;expert1_48 -->
<g id="edge51" class="edge">
<title>router1&#45;&gt;expert1_48</title>
<path fill="none" stroke="black" d="M9022.74,-2023.35C9704.79,-2022.29 13456.77,-2014.86 13503,-1980 13514.78,-1971.12 13521.01,-1956.71 13524.23,-1942.49"/>
<polygon fill="black" stroke="black" points="13527.74,-1942.72 13526.08,-1932.25 13520.86,-1941.47 13527.74,-1942.72"/>
<text text-anchor="middle" x="13651.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 48</text>
<text text-anchor="middle" x="13651.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_49 -->
<g id="node53" class="node">
<title>expert1_49</title>
<polygon fill="#e6f3ff" stroke="black" points="13919.5,-1932 13698.5,-1932 13698.5,-1864 13919.5,-1864 13919.5,-1932"/>
<text text-anchor="middle" x="13809" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 49</text>
<text text-anchor="middle" x="13809" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13809" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="13809" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;50</text>
</g>
<!-- router1&#45;&gt;expert1_49 -->
<g id="edge52" class="edge">
<title>router1&#45;&gt;expert1_49</title>
<path fill="none" stroke="black" d="M9022.63,-2023.41C9728.59,-2022.71 13735.76,-2017.11 13785,-1980 13796.78,-1971.12 13803.01,-1956.71 13806.23,-1942.49"/>
<polygon fill="black" stroke="black" points="13809.75,-1942.72 13808.08,-1932.26 13802.86,-1941.47 13809.75,-1942.72"/>
<text text-anchor="middle" x="13933.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 49</text>
<text text-anchor="middle" x="13933.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_50 -->
<g id="node54" class="node">
<title>expert1_50</title>
<polygon fill="#e6f3ff" stroke="black" points="14201.5,-1932 13980.5,-1932 13980.5,-1864 14201.5,-1864 14201.5,-1932"/>
<text text-anchor="middle" x="14091" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 50</text>
<text text-anchor="middle" x="14091" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14091" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="14091" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;51</text>
</g>
<!-- router1&#45;&gt;expert1_50 -->
<g id="edge53" class="edge">
<title>router1&#45;&gt;expert1_50</title>
<path fill="none" stroke="black" d="M9022.53,-2023.46C9751.73,-2023.11 14014.75,-2019.36 14067,-1980 14078.78,-1971.12 14085.01,-1956.72 14088.23,-1942.5"/>
<polygon fill="black" stroke="black" points="14091.75,-1942.72 14090.08,-1932.26 14084.86,-1941.48 14091.75,-1942.72"/>
<text text-anchor="middle" x="14215.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 50</text>
<text text-anchor="middle" x="14215.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_51 -->
<g id="node55" class="node">
<title>expert1_51</title>
<polygon fill="#e6f3ff" stroke="black" points="14483.5,-1932 14262.5,-1932 14262.5,-1864 14483.5,-1864 14483.5,-1932"/>
<text text-anchor="middle" x="14373" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 51</text>
<text text-anchor="middle" x="14373" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14373" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="14373" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;52</text>
</g>
<!-- router1&#45;&gt;expert1_51 -->
<g id="edge54" class="edge">
<title>router1&#45;&gt;expert1_51</title>
<path fill="none" stroke="black" d="M9022.53,-2023.51C9774.6,-2023.49 14293.75,-2021.6 14349,-1980 14360.79,-1971.13 14367.01,-1956.72 14370.23,-1942.5"/>
<polygon fill="black" stroke="black" points="14373.75,-1942.72 14372.08,-1932.26 14366.86,-1941.48 14373.75,-1942.72"/>
<text text-anchor="middle" x="14497.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 51</text>
<text text-anchor="middle" x="14497.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_52 -->
<g id="node56" class="node">
<title>expert1_52</title>
<polygon fill="#e6f3ff" stroke="black" points="14765.5,-1932 14544.5,-1932 14544.5,-1864 14765.5,-1864 14765.5,-1932"/>
<text text-anchor="middle" x="14655" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 52</text>
<text text-anchor="middle" x="14655" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14655" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="14655" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;53</text>
</g>
<!-- router1&#45;&gt;expert1_52 -->
<g id="edge55" class="edge">
<title>router1&#45;&gt;expert1_52</title>
<path fill="none" stroke="black" d="M9022.7,-2023.55C9797.58,-2023.84 14572.74,-2023.85 14631,-1980 14642.79,-1971.13 14649.02,-1956.72 14652.24,-1942.5"/>
<polygon fill="black" stroke="black" points="14655.75,-1942.73 14654.09,-1932.26 14648.86,-1941.48 14655.75,-1942.73"/>
<text text-anchor="middle" x="14779.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 52</text>
<text text-anchor="middle" x="14779.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_53 -->
<g id="node57" class="node">
<title>expert1_53</title>
<polygon fill="#e6f3ff" stroke="black" points="15047.5,-1932 14826.5,-1932 14826.5,-1864 15047.5,-1864 15047.5,-1932"/>
<text text-anchor="middle" x="14937" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 53</text>
<text text-anchor="middle" x="14937" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14937" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="14937" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;54</text>
</g>
<!-- router1&#45;&gt;expert1_53 -->
<g id="edge56" class="edge">
<title>router1&#45;&gt;expert1_53</title>
<path fill="none" stroke="black" d="M9022.78,-2023.59C9819.71,-2024.19 14851.72,-2026.1 14913,-1980 14924.79,-1971.13 14931.02,-1956.73 14934.24,-1942.51"/>
<polygon fill="black" stroke="black" points="14937.75,-1942.73 14936.09,-1932.27 14930.87,-1941.48 14937.75,-1942.73"/>
<text text-anchor="middle" x="15061.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 53</text>
<text text-anchor="middle" x="15061.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_54 -->
<g id="node58" class="node">
<title>expert1_54</title>
<polygon fill="#e6f3ff" stroke="black" points="15329.5,-1932 15108.5,-1932 15108.5,-1864 15329.5,-1864 15329.5,-1932"/>
<text text-anchor="middle" x="15219" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 54</text>
<text text-anchor="middle" x="15219" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15219" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="15219" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;55</text>
</g>
<!-- router1&#45;&gt;expert1_54 -->
<g id="edge57" class="edge">
<title>router1&#45;&gt;expert1_54</title>
<path fill="none" stroke="black" d="M9022.51,-2023.63C9839.79,-2024.51 15130.7,-2028.36 15195,-1980 15206.79,-1971.13 15213.02,-1956.73 15216.24,-1942.51"/>
<polygon fill="black" stroke="black" points="15219.76,-1942.73 15218.09,-1932.27 15212.87,-1941.49 15219.76,-1942.73"/>
<text text-anchor="middle" x="15343.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 54</text>
<text text-anchor="middle" x="15343.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_55 -->
<g id="node59" class="node">
<title>expert1_55</title>
<polygon fill="#e6f3ff" stroke="black" points="15611.5,-1932 15390.5,-1932 15390.5,-1864 15611.5,-1864 15611.5,-1932"/>
<text text-anchor="middle" x="15501" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 55</text>
<text text-anchor="middle" x="15501" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15501" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="15501" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;56</text>
</g>
<!-- router1&#45;&gt;expert1_55 -->
<g id="edge58" class="edge">
<title>router1&#45;&gt;expert1_55</title>
<path fill="none" stroke="black" d="M9022.55,-2023.66C9860.74,-2024.82 15409.68,-2030.62 15477,-1980 15488.79,-1971.13 15495.02,-1956.73 15498.24,-1942.51"/>
<polygon fill="black" stroke="black" points="15501.76,-1942.73 15500.09,-1932.27 15494.87,-1941.49 15501.76,-1942.73"/>
<text text-anchor="middle" x="15625.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 55</text>
<text text-anchor="middle" x="15625.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_56 -->
<g id="node60" class="node">
<title>expert1_56</title>
<polygon fill="#e6f3ff" stroke="black" points="15893.5,-1932 15672.5,-1932 15672.5,-1864 15893.5,-1864 15893.5,-1932"/>
<text text-anchor="middle" x="15783" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 56</text>
<text text-anchor="middle" x="15783" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15783" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="15783" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;57</text>
</g>
<!-- router1&#45;&gt;expert1_56 -->
<g id="edge59" class="edge">
<title>router1&#45;&gt;expert1_56</title>
<path fill="none" stroke="black" d="M9022.52,-2023.26C9883.55,-2021.22 15723.82,-2006.44 15759,-1980 15770.79,-1971.14 15777.02,-1956.73 15780.24,-1942.51"/>
<polygon fill="black" stroke="black" points="15783.76,-1942.73 15782.09,-1932.27 15776.87,-1941.49 15783.76,-1942.73"/>
<text text-anchor="middle" x="15907.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 56</text>
<text text-anchor="middle" x="15907.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_57 -->
<g id="node61" class="node">
<title>expert1_57</title>
<polygon fill="#e6f3ff" stroke="black" points="16175.5,-1932 15954.5,-1932 15954.5,-1864 16175.5,-1864 16175.5,-1932"/>
<text text-anchor="middle" x="16065" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 57</text>
<text text-anchor="middle" x="16065" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16065" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="16065" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;58</text>
</g>
<!-- router1&#45;&gt;expert1_57 -->
<g id="edge60" class="edge">
<title>router1&#45;&gt;expert1_57</title>
<path fill="none" stroke="black" d="M9022.66,-2023.28C9904.13,-2021.43 16004.31,-2007.57 16041,-1980 16052.79,-1971.14 16059.03,-1956.73 16062.24,-1942.51"/>
<polygon fill="black" stroke="black" points="16065.76,-1942.73 16064.09,-1932.27 16058.87,-1941.49 16065.76,-1942.73"/>
<text text-anchor="middle" x="16189.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 57</text>
<text text-anchor="middle" x="16189.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_58 -->
<g id="node62" class="node">
<title>expert1_58</title>
<polygon fill="#e6f3ff" stroke="black" points="16457.5,-1932 16236.5,-1932 16236.5,-1864 16457.5,-1864 16457.5,-1932"/>
<text text-anchor="middle" x="16347" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 58</text>
<text text-anchor="middle" x="16347" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16347" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="16347" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;59</text>
</g>
<!-- router1&#45;&gt;expert1_58 -->
<g id="edge61" class="edge">
<title>router1&#45;&gt;expert1_58</title>
<path fill="none" stroke="black" d="M9022.54,-2023.31C9923.17,-2021.62 16284.79,-2008.7 16323,-1980 16334.8,-1971.14 16341.03,-1956.74 16344.25,-1942.51"/>
<polygon fill="black" stroke="black" points="16347.76,-1942.74 16346.09,-1932.27 16340.87,-1941.49 16347.76,-1942.74"/>
<text text-anchor="middle" x="16471.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 58</text>
<text text-anchor="middle" x="16471.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_59 -->
<g id="node63" class="node">
<title>expert1_59</title>
<polygon fill="#e6f3ff" stroke="black" points="16739.5,-1932 16518.5,-1932 16518.5,-1864 16739.5,-1864 16739.5,-1932"/>
<text text-anchor="middle" x="16629" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 59</text>
<text text-anchor="middle" x="16629" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16629" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="16629" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;60</text>
</g>
<!-- router1&#45;&gt;expert1_59 -->
<g id="edge62" class="edge">
<title>router1&#45;&gt;expert1_59</title>
<path fill="none" stroke="black" d="M9022.54,-2023.33C9942.38,-2021.81 16565.28,-2009.84 16605,-1980 16616.8,-1971.14 16623.03,-1956.74 16626.25,-1942.52"/>
<polygon fill="black" stroke="black" points="16629.76,-1942.74 16628.09,-1932.27 16622.87,-1941.49 16629.76,-1942.74"/>
<text text-anchor="middle" x="16753.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 59</text>
<text text-anchor="middle" x="16753.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_60 -->
<g id="node64" class="node">
<title>expert1_60</title>
<polygon fill="#e6f3ff" stroke="black" points="17021.5,-1932 16800.5,-1932 16800.5,-1864 17021.5,-1864 17021.5,-1932"/>
<text text-anchor="middle" x="16911" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 60</text>
<text text-anchor="middle" x="16911" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16911" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="16911" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;61</text>
</g>
<!-- router1&#45;&gt;expert1_60 -->
<g id="edge63" class="edge">
<title>router1&#45;&gt;expert1_60</title>
<path fill="none" stroke="black" d="M9022.69,-2023.35C9961.96,-2021.99 16845.76,-2010.97 16887,-1980 16898.8,-1971.14 16905.03,-1956.74 16908.25,-1942.52"/>
<polygon fill="black" stroke="black" points="16911.76,-1942.74 16910.09,-1932.28 16904.88,-1941.5 16911.76,-1942.74"/>
<text text-anchor="middle" x="17035.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 60</text>
<text text-anchor="middle" x="17035.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_61 -->
<g id="node65" class="node">
<title>expert1_61</title>
<polygon fill="#e6f3ff" stroke="black" points="17303.5,-1932 17082.5,-1932 17082.5,-1864 17303.5,-1864 17303.5,-1932"/>
<text text-anchor="middle" x="17193" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 61</text>
<text text-anchor="middle" x="17193" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17193" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="17193" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;62</text>
</g>
<!-- router1&#45;&gt;expert1_61 -->
<g id="edge64" class="edge">
<title>router1&#45;&gt;expert1_61</title>
<path fill="none" stroke="black" d="M9022.64,-2023.37C9980.25,-2022.17 17126.24,-2012.1 17169,-1980 17180.8,-1971.14 17187.03,-1956.74 17190.25,-1942.52"/>
<polygon fill="black" stroke="black" points="17193.76,-1942.74 17192.1,-1932.28 17186.88,-1941.5 17193.76,-1942.74"/>
<text text-anchor="middle" x="17317.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 61</text>
<text text-anchor="middle" x="17317.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_62 -->
<g id="node66" class="node">
<title>expert1_62</title>
<polygon fill="#e6f3ff" stroke="black" points="17585.5,-1932 17364.5,-1932 17364.5,-1864 17585.5,-1864 17585.5,-1932"/>
<text text-anchor="middle" x="17475" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 62</text>
<text text-anchor="middle" x="17475" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17475" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="17475" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;63</text>
</g>
<!-- router1&#45;&gt;expert1_62 -->
<g id="edge65" class="edge">
<title>router1&#45;&gt;expert1_62</title>
<path fill="none" stroke="black" d="M9022.78,-2023.39C9999.17,-2022.34 17406.73,-2013.23 17451,-1980 17462.8,-1971.14 17469.03,-1956.74 17472.25,-1942.52"/>
<polygon fill="black" stroke="black" points="17475.77,-1942.74 17474.1,-1932.28 17468.88,-1941.5 17475.77,-1942.74"/>
<text text-anchor="middle" x="17599.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 62</text>
<text text-anchor="middle" x="17599.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert1_63 -->
<g id="node67" class="node">
<title>expert1_63</title>
<polygon fill="#e6f3ff" stroke="black" points="17867.5,-1932 17646.5,-1932 17646.5,-1864 17867.5,-1864 17867.5,-1932"/>
<text text-anchor="middle" x="17757" y="-1916.8" font-family="Times,serif" font-size="14.00">Expert 63</text>
<text text-anchor="middle" x="17757" y="-1901.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17757" y="-1886.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="17757" y="-1871.8" font-family="Times,serif" font-size="14.00">GPU&#45;64</text>
</g>
<!-- router1&#45;&gt;expert1_63 -->
<g id="edge66" class="edge">
<title>router1&#45;&gt;expert1_63</title>
<path fill="none" stroke="black" d="M9022.74,-2023.41C10016.92,-2022.5 17687.21,-2014.37 17733,-1980 17744.8,-1971.14 17751.03,-1956.74 17754.25,-1942.52"/>
<polygon fill="black" stroke="black" points="17757.77,-1942.74 17756.1,-1932.28 17750.88,-1941.5 17757.77,-1942.74"/>
<text text-anchor="middle" x="17881.5" y="-1968.8" font-family="Times,serif" font-size="14.00">tokens for expert 63</text>
<text text-anchor="middle" x="17881.5" y="-1953.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- agg1 -->
<g id="node68" class="node">
<title>agg1</title>
<polygon fill="#e6f3ff" stroke="black" points="8885,-1798 8667,-1798 8667,-1745 8885,-1745 8885,-1798"/>
<text text-anchor="middle" x="8776" y="-1782.8" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8776" y="-1767.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, hidden_size]</text>
<text text-anchor="middle" x="8776" y="-1752.8" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- expert1_0&#45;&gt;agg1 -->
<g id="edge67" class="edge">
<title>expert1_0&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M209.68,-1863.83C232.02,-1845.9 262.14,-1825.53 293,-1816 397.62,-1783.7 7633.82,-1773.87 8656.38,-1772.64"/>
<polygon fill="black" stroke="black" points="8656.69,-1776.14 8666.69,-1772.62 8656.68,-1769.14 8656.69,-1776.14"/>
<text text-anchor="middle" x="391.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 0</text>
<text text-anchor="middle" x="391.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_1&#45;&gt;agg1 -->
<g id="edge68" class="edge">
<title>expert1_1&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M467.04,-1863.83C489.58,-1845.9 519.94,-1825.53 551,-1816 652.39,-1784.9 7653.88,-1774.05 8656.89,-1772.66"/>
<polygon fill="black" stroke="black" points="8657,-1776.16 8667,-1772.65 8656.99,-1769.16 8657,-1776.16"/>
<text text-anchor="middle" x="649.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 1</text>
<text text-anchor="middle" x="649.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_2&#45;&gt;agg1 -->
<g id="edge69" class="edge">
<title>expert1_2&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M721.02,-1863.98C747.22,-1845.98 782.24,-1825.49 817,-1816 915.86,-1789.01 7670.9,-1774.68 8656.55,-1772.73"/>
<polygon fill="black" stroke="black" points="8656.84,-1776.23 8666.83,-1772.71 8656.83,-1769.23 8656.84,-1776.23"/>
<text text-anchor="middle" x="915.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 2</text>
<text text-anchor="middle" x="915.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_3&#45;&gt;agg1 -->
<g id="edge70" class="edge">
<title>expert1_3&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M978.03,-1863.92C1011.82,-1845.9 1056.43,-1825.4 1099,-1816 1291.65,-1773.44 7699.02,-1772.4 8656.74,-1772.48"/>
<polygon fill="black" stroke="black" points="8656.74,-1775.98 8666.74,-1772.48 8656.74,-1768.98 8656.74,-1775.98"/>
<text text-anchor="middle" x="1197.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 3</text>
<text text-anchor="middle" x="1197.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_4&#45;&gt;agg1 -->
<g id="edge71" class="edge">
<title>expert1_4&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M1260.03,-1863.92C1293.82,-1845.9 1338.43,-1825.41 1381,-1816 1566.28,-1775.05 7719.23,-1772.64 8656.74,-1772.51"/>
<polygon fill="black" stroke="black" points="8656.87,-1776.01 8666.86,-1772.5 8656.86,-1769.01 8656.87,-1776.01"/>
<text text-anchor="middle" x="1479.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 4</text>
<text text-anchor="middle" x="1479.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_5&#45;&gt;agg1 -->
<g id="edge72" class="edge">
<title>expert1_5&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M1542.04,-1863.92C1575.82,-1845.91 1620.43,-1825.41 1663,-1816 1840.91,-1776.66 7739.4,-1772.88 8656.64,-1772.53"/>
<polygon fill="black" stroke="black" points="8656.88,-1776.03 8666.87,-1772.53 8656.87,-1769.03 8656.88,-1776.03"/>
<text text-anchor="middle" x="1761.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 5</text>
<text text-anchor="middle" x="1761.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_6&#45;&gt;agg1 -->
<g id="edge73" class="edge">
<title>expert1_6&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M1824.04,-1863.93C1857.82,-1845.91 1902.44,-1825.42 1945,-1816 2115.56,-1778.26 7761.09,-1773.14 8656.8,-1772.57"/>
<polygon fill="black" stroke="black" points="8656.8,-1776.07 8666.8,-1772.56 8656.8,-1769.07 8656.8,-1776.07"/>
<text text-anchor="middle" x="2043.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 6</text>
<text text-anchor="middle" x="2043.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_7&#45;&gt;agg1 -->
<g id="edge74" class="edge">
<title>expert1_7&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M2106.04,-1863.93C2139.83,-1845.92 2184.44,-1825.42 2227,-1816 2390.19,-1779.87 7781.66,-1773.41 8656.59,-1772.6"/>
<polygon fill="black" stroke="black" points="8656.67,-1776.1 8666.67,-1772.59 8656.67,-1769.1 8656.67,-1776.1"/>
<text text-anchor="middle" x="2325.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 7</text>
<text text-anchor="middle" x="2325.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_8&#45;&gt;agg1 -->
<g id="edge75" class="edge">
<title>expert1_8&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M2388.04,-1863.94C2421.83,-1845.92 2466.44,-1825.43 2509,-1816 2664.85,-1781.47 7804.11,-1773.69 8656.72,-1772.64"/>
<polygon fill="black" stroke="black" points="8656.85,-1776.14 8666.85,-1772.62 8656.85,-1769.14 8656.85,-1776.14"/>
<text text-anchor="middle" x="2607.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 8</text>
<text text-anchor="middle" x="2607.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_9&#45;&gt;agg1 -->
<g id="edge76" class="edge">
<title>expert1_9&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M2670.04,-1863.94C2703.83,-1845.93 2748.44,-1825.44 2791,-1816 2939.5,-1783.07 7825.84,-1773.98 8656.54,-1772.68"/>
<polygon fill="black" stroke="black" points="8656.72,-1776.18 8666.72,-1772.66 8656.71,-1769.18 8656.72,-1776.18"/>
<text text-anchor="middle" x="2889.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 9</text>
<text text-anchor="middle" x="2889.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_10&#45;&gt;agg1 -->
<g id="edge77" class="edge">
<title>expert1_10&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M2952.04,-1863.95C2985.83,-1845.94 3030.44,-1825.45 3073,-1816 3214.18,-1784.67 7849.7,-1774.29 8656.77,-1772.72"/>
<polygon fill="black" stroke="black" points="8656.96,-1776.22 8666.95,-1772.7 8656.94,-1769.22 8656.96,-1776.22"/>
<text text-anchor="middle" x="3171.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 10</text>
<text text-anchor="middle" x="3171.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_11&#45;&gt;agg1 -->
<g id="edge78" class="edge">
<title>expert1_11&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M3234.04,-1863.95C3267.83,-1845.95 3312.44,-1825.45 3355,-1816 3488.85,-1786.26 7873.33,-1774.61 8656.8,-1772.77"/>
<polygon fill="black" stroke="black" points="8656.97,-1776.27 8666.96,-1772.74 8656.96,-1769.27 8656.97,-1776.27"/>
<text text-anchor="middle" x="3453.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 11</text>
<text text-anchor="middle" x="3453.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_12&#45;&gt;agg1 -->
<g id="edge79" class="edge">
<title>expert1_12&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M3516.04,-1863.96C3549.83,-1845.96 3594.45,-1825.46 3637,-1816 3763.53,-1787.86 7897.11,-1774.96 8656.7,-1772.82"/>
<polygon fill="black" stroke="black" points="8656.84,-1776.32 8666.83,-1772.79 8656.82,-1769.32 8656.84,-1776.32"/>
<text text-anchor="middle" x="3735.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 12</text>
<text text-anchor="middle" x="3735.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_13&#45;&gt;agg1 -->
<g id="edge80" class="edge">
<title>expert1_13&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M3798.05,-1863.97C3831.84,-1845.97 3876.45,-1825.47 3919,-1816 4038.23,-1789.45 7922.45,-1775.32 8656.85,-1772.88"/>
<polygon fill="black" stroke="black" points="8656.92,-1776.38 8666.91,-1772.85 8656.9,-1769.38 8656.92,-1776.38"/>
<text text-anchor="middle" x="4017.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 13</text>
<text text-anchor="middle" x="4017.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_14&#45;&gt;agg1 -->
<g id="edge81" class="edge">
<title>expert1_14&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M4080.05,-1863.98C4113.84,-1845.98 4158.45,-1825.49 4201,-1816 4312.93,-1791.05 7947.67,-1775.71 8656.75,-1772.95"/>
<polygon fill="black" stroke="black" points="8656.99,-1776.45 8666.98,-1772.91 8656.97,-1769.45 8656.99,-1776.45"/>
<text text-anchor="middle" x="4299.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 14</text>
<text text-anchor="middle" x="4299.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_15&#45;&gt;agg1 -->
<g id="edge82" class="edge">
<title>expert1_15&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M4362.05,-1863.99C4395.84,-1845.99 4440.45,-1825.5 4483,-1816 4691.94,-1769.35 7984.57,-1771.4 8656.74,-1772.31"/>
<polygon fill="black" stroke="black" points="8656.91,-1775.81 8666.92,-1772.32 8656.92,-1768.81 8656.91,-1775.81"/>
<text text-anchor="middle" x="4581.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 15</text>
<text text-anchor="middle" x="4581.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_16&#45;&gt;agg1 -->
<g id="edge83" class="edge">
<title>expert1_16&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M4644.05,-1864C4677.84,-1846.01 4722.46,-1825.51 4765,-1816 4959.39,-1772.53 8010.96,-1772.02 8656.59,-1772.4"/>
<polygon fill="black" stroke="black" points="8656.84,-1775.9 8666.84,-1772.4 8656.84,-1768.9 8656.84,-1775.9"/>
<text text-anchor="middle" x="4863.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 16</text>
<text text-anchor="middle" x="4863.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_17&#45;&gt;agg1 -->
<g id="edge84" class="edge">
<title>expert1_17&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M4926.45,-1863.8C4960.19,-1845.87 5004.63,-1825.49 5047,-1816 5226.88,-1775.7 8038.75,-1772.68 8656.58,-1772.5"/>
<polygon fill="black" stroke="black" points="8656.83,-1776 8666.83,-1772.5 8656.83,-1769 8656.83,-1776"/>
<text text-anchor="middle" x="5145.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 17</text>
<text text-anchor="middle" x="5145.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_18&#45;&gt;agg1 -->
<g id="edge85" class="edge">
<title>expert1_18&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M5208.45,-1863.82C5242.2,-1845.89 5286.63,-1825.51 5329,-1816 5494.4,-1778.86 8067.76,-1773.39 8656.61,-1772.62"/>
<polygon fill="black" stroke="black" points="8656.82,-1776.12 8666.82,-1772.61 8656.81,-1769.12 8656.82,-1776.12"/>
<text text-anchor="middle" x="5427.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 18</text>
<text text-anchor="middle" x="5427.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_19&#45;&gt;agg1 -->
<g id="edge86" class="edge">
<title>expert1_19&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M5490.46,-1863.84C5524.2,-1845.91 5568.64,-1825.54 5611,-1816 5761.98,-1782.01 8098.7,-1774.15 8656.91,-1772.76"/>
<polygon fill="black" stroke="black" points="8657,-1776.26 8666.99,-1772.74 8656.98,-1769.26 8657,-1776.26"/>
<text text-anchor="middle" x="5709.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 19</text>
<text text-anchor="middle" x="5709.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_20&#45;&gt;agg1 -->
<g id="edge87" class="edge">
<title>expert1_20&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M5772.46,-1863.86C5806.21,-1845.94 5850.64,-1825.57 5893,-1816 6029.54,-1785.16 8128.9,-1775 8656.44,-1772.93"/>
<polygon fill="black" stroke="black" points="8656.74,-1776.43 8666.73,-1772.89 8656.72,-1769.43 8656.74,-1776.43"/>
<text text-anchor="middle" x="5991.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 20</text>
<text text-anchor="middle" x="5991.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_21&#45;&gt;agg1 -->
<g id="edge88" class="edge">
<title>expert1_21&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M6054.12,-1863.88C6087.68,-1845.97 6131.86,-1825.6 6174,-1816 6296.23,-1788.15 8162.74,-1775.89 8656.78,-1773.13"/>
<polygon fill="black" stroke="black" points="8656.81,-1776.63 8666.79,-1773.07 8656.77,-1769.63 8656.81,-1776.63"/>
<text text-anchor="middle" x="6272.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 21</text>
<text text-anchor="middle" x="6272.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_22&#45;&gt;agg1 -->
<g id="edge89" class="edge">
<title>expert1_22&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M6335.79,-1863.91C6369.15,-1846.02 6413.08,-1825.64 6455,-1816 6562.92,-1791.17 8196.87,-1776.91 8656.52,-1773.37"/>
<polygon fill="black" stroke="black" points="8656.85,-1776.87 8666.83,-1773.29 8656.8,-1769.87 8656.85,-1776.87"/>
<text text-anchor="middle" x="6553.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 22</text>
<text text-anchor="middle" x="6553.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_23&#45;&gt;agg1 -->
<g id="edge90" class="edge">
<title>expert1_23&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M6617.11,-1863.95C6650.08,-1846.07 6693.5,-1825.7 6735,-1816 6921.53,-1772.4 8248.59,-1771.42 8656.81,-1772.17"/>
<polygon fill="black" stroke="black" points="8656.86,-1775.67 8666.87,-1772.18 8656.88,-1768.67 8656.86,-1775.67"/>
<text text-anchor="middle" x="6833.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 23</text>
<text text-anchor="middle" x="6833.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_24&#45;&gt;agg1 -->
<g id="edge91" class="edge">
<title>expert1_24&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M6898.48,-1863.8C6930.8,-1845.98 6973.3,-1825.73 7014,-1816 7172.43,-1778.12 8286.44,-1773.16 8656.68,-1772.56"/>
<polygon fill="black" stroke="black" points="8656.89,-1776.06 8666.89,-1772.55 8656.88,-1769.06 8656.89,-1776.06"/>
<text text-anchor="middle" x="7112.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 24</text>
<text text-anchor="middle" x="7112.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_25&#45;&gt;agg1 -->
<g id="edge92" class="edge">
<title>expert1_25&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M7178.76,-1863.87C7210.1,-1846.07 7251.35,-1825.82 7291,-1816 7421.71,-1783.62 8327.39,-1775.12 8656.67,-1773.09"/>
<polygon fill="black" stroke="black" points="8656.74,-1776.59 8666.72,-1773.03 8656.7,-1769.59 8656.74,-1776.59"/>
<text text-anchor="middle" x="7389.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 25</text>
<text text-anchor="middle" x="7389.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_26&#45;&gt;agg1 -->
<g id="edge93" class="edge">
<title>expert1_26&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M7457.02,-1863.96C7486.77,-1846.19 7526.02,-1825.94 7564,-1816 7667.55,-1788.89 8371.41,-1777.4 8656.48,-1773.82"/>
<polygon fill="black" stroke="black" points="8656.9,-1777.32 8666.86,-1773.69 8656.81,-1770.32 8656.9,-1777.32"/>
<text text-anchor="middle" x="7662.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 26</text>
<text text-anchor="middle" x="7662.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_27&#45;&gt;agg1 -->
<g id="edge94" class="edge">
<title>expert1_27&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M7733.2,-1863.88C7760.54,-1846.21 7796.64,-1826.08 7832,-1816 7909.24,-1793.98 8420.61,-1780.2 8656.8,-1774.93"/>
<polygon fill="black" stroke="black" points="8656.89,-1778.43 8666.81,-1774.71 8656.73,-1771.43 8656.89,-1778.43"/>
<text text-anchor="middle" x="7930.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 27</text>
<text text-anchor="middle" x="7930.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_28&#45;&gt;agg1 -->
<g id="edge95" class="edge">
<title>expert1_28&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M8005.84,-1863.88C8029.37,-1846.32 8060.62,-1826.31 8092,-1816 8193.5,-1782.65 8489.19,-1774.69 8656.67,-1772.9"/>
<polygon fill="black" stroke="black" points="8656.81,-1776.4 8666.77,-1772.8 8656.74,-1769.4 8656.81,-1776.4"/>
<text text-anchor="middle" x="8190.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 28</text>
<text text-anchor="middle" x="8190.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_29&#45;&gt;agg1 -->
<g id="edge96" class="edge">
<title>expert1_29&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M8272.4,-1863.84C8290.91,-1846.5 8315.78,-1826.71 8342,-1816 8397.15,-1793.47 8548.44,-1782.2 8656.87,-1776.86"/>
<polygon fill="black" stroke="black" points="8657.08,-1780.36 8666.9,-1776.38 8656.74,-1773.36 8657.08,-1780.36"/>
<text text-anchor="middle" x="8440.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 29</text>
<text text-anchor="middle" x="8440.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_30&#45;&gt;agg1 -->
<g id="edge97" class="edge">
<title>expert1_30&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M8528.25,-1863.98C8539.74,-1847.13 8555.83,-1827.76 8575,-1816 8599.57,-1800.93 8628.64,-1791.04 8656.91,-1784.56"/>
<polygon fill="black" stroke="black" points="8657.84,-1787.94 8666.87,-1782.41 8656.36,-1781.1 8657.84,-1787.94"/>
<text text-anchor="middle" x="8673.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 30</text>
<text text-anchor="middle" x="8673.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_31&#45;&gt;agg1 -->
<g id="edge98" class="edge">
<title>expert1_31&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M8776,-1863.96C8776,-1846.9 8776,-1826.05 8776,-1808.57"/>
<polygon fill="black" stroke="black" points="8779.5,-1808.19 8776,-1798.19 8772.5,-1808.19 8779.5,-1808.19"/>
<text text-anchor="middle" x="8874.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 31</text>
<text text-anchor="middle" x="8874.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_32&#45;&gt;agg1 -->
<g id="edge99" class="edge">
<title>expert1_32&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M9019.54,-1863.99C9009.49,-1847.14 8995.08,-1827.77 8977,-1816 8952.71,-1800.18 8923.62,-1790.02 8895.2,-1783.52"/>
<polygon fill="black" stroke="black" points="8895.7,-1780.05 8885.19,-1781.37 8894.23,-1786.9 8895.7,-1780.05"/>
<text text-anchor="middle" x="9104.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 32</text>
<text text-anchor="middle" x="9104.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_33&#45;&gt;agg1 -->
<g id="edge100" class="edge">
<title>expert1_33&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M9275.97,-1863.84C9257.66,-1846.51 9233.03,-1826.72 9207,-1816 9152.48,-1793.54 9003.02,-1782.28 8895.4,-1776.92"/>
<polygon fill="black" stroke="black" points="8895.28,-1773.41 8885.12,-1776.42 8894.94,-1780.4 8895.28,-1773.41"/>
<text text-anchor="middle" x="9352.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 33</text>
<text text-anchor="middle" x="9352.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_34&#45;&gt;agg1 -->
<g id="edge101" class="edge">
<title>expert1_34&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M9543.09,-1863.89C9518.96,-1846.34 9486.96,-1826.32 9455,-1816 9354.26,-1783.47 9061.71,-1775.17 8895.34,-1773.11"/>
<polygon fill="black" stroke="black" points="8895.1,-1769.61 8885.06,-1772.99 8895.02,-1776.61 8895.1,-1769.61"/>
<text text-anchor="middle" x="9612.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 34</text>
<text text-anchor="middle" x="9612.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_35&#45;&gt;agg1 -->
<g id="edge102" class="edge">
<title>expert1_35&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M9815.75,-1863.89C9787.81,-1846.22 9750.96,-1826.09 9715,-1816 9638.17,-1794.44 9130.6,-1780.43 8895.34,-1775.02"/>
<polygon fill="black" stroke="black" points="8895.11,-1771.52 8885.03,-1774.79 8894.95,-1778.51 8895.11,-1771.52"/>
<text text-anchor="middle" x="9880.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 35</text>
<text text-anchor="middle" x="9880.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_36&#45;&gt;agg1 -->
<g id="edge103" class="edge">
<title>expert1_36&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M10092.6,-1863.96C10062.04,-1846.2 10021.79,-1825.95 9983,-1816 9879.8,-1789.53 9179.72,-1777.67 8895.53,-1773.91"/>
<polygon fill="black" stroke="black" points="8895.23,-1770.4 8885.18,-1773.77 8895.14,-1777.4 8895.23,-1770.4"/>
<text text-anchor="middle" x="10154.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 36</text>
<text text-anchor="middle" x="10154.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_37&#45;&gt;agg1 -->
<g id="edge104" class="edge">
<title>expert1_37&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M10371.2,-1863.87C10339.26,-1846.07 10297.26,-1825.82 10257,-1816 10126.57,-1784.18 9223.89,-1775.33 8895.29,-1773.15"/>
<polygon fill="black" stroke="black" points="8895.28,-1769.65 8885.26,-1773.08 8895.24,-1776.65 8895.28,-1769.65"/>
<text text-anchor="middle" x="10431.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 37</text>
<text text-anchor="middle" x="10431.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_38&#45;&gt;agg1 -->
<g id="edge105" class="edge">
<title>expert1_38&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M10651.49,-1863.8C10618.57,-1845.98 10575.32,-1825.73 10534,-1816 10375.84,-1778.75 9265.06,-1773.37 8895.36,-1772.62"/>
<polygon fill="black" stroke="black" points="8895.18,-1769.12 8885.17,-1772.6 8895.16,-1776.12 8895.18,-1769.12"/>
<text text-anchor="middle" x="10710.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 38</text>
<text text-anchor="middle" x="10710.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_39&#45;&gt;agg1 -->
<g id="edge106" class="edge">
<title>expert1_39&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M10932.86,-1863.96C10899.3,-1846.07 10855.12,-1825.7 10813,-1816 10626.75,-1773.11 9303.09,-1771.63 8895.29,-1772.22"/>
<polygon fill="black" stroke="black" points="8895.24,-1768.72 8885.25,-1772.23 8895.25,-1775.72 8895.24,-1768.72"/>
<text text-anchor="middle" x="10990.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 39</text>
<text text-anchor="middle" x="10990.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_40&#45;&gt;agg1 -->
<g id="edge107" class="edge">
<title>expert1_40&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M11214.18,-1863.91C11180.23,-1846.02 11135.55,-1825.64 11093,-1816 10985.21,-1791.57 9355.03,-1777.03 8895.66,-1773.4"/>
<polygon fill="black" stroke="black" points="8895.38,-1769.9 8885.36,-1773.32 8895.33,-1776.9 8895.38,-1769.9"/>
<text text-anchor="middle" x="11271.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 40</text>
<text text-anchor="middle" x="11271.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_41&#45;&gt;agg1 -->
<g id="edge108" class="edge">
<title>expert1_41&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M11495.85,-1863.88C11461.7,-1845.97 11416.77,-1825.6 11374,-1816 11251.9,-1788.59 9389.21,-1776.01 8895.39,-1773.15"/>
<polygon fill="black" stroke="black" points="8895.06,-1769.65 8885.04,-1773.09 8895.02,-1776.65 8895.06,-1769.65"/>
<text text-anchor="middle" x="11553.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 41</text>
<text text-anchor="middle" x="11553.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_42&#45;&gt;agg1 -->
<g id="edge109" class="edge">
<title>expert1_42&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M11777.86,-1863.86C11743.71,-1845.94 11698.77,-1825.57 11656,-1816 11519.54,-1785.48 9422.41,-1775.08 8895.43,-1772.95"/>
<polygon fill="black" stroke="black" points="8895.17,-1769.44 8885.15,-1772.9 8895.14,-1776.44 8895.17,-1769.44"/>
<text text-anchor="middle" x="11835.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 42</text>
<text text-anchor="middle" x="11835.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_43&#45;&gt;agg1 -->
<g id="edge110" class="edge">
<title>expert1_43&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M12059.86,-1863.83C12025.71,-1845.91 11980.78,-1825.54 11938,-1816 11787.13,-1782.37 9453.92,-1774.24 8895.44,-1772.78"/>
<polygon fill="black" stroke="black" points="8895.36,-1769.28 8885.35,-1772.75 8895.34,-1776.28 8895.36,-1769.28"/>
<text text-anchor="middle" x="12117.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 43</text>
<text text-anchor="middle" x="12117.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_44&#45;&gt;agg1 -->
<g id="edge111" class="edge">
<title>expert1_44&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M12341.86,-1863.82C12307.72,-1845.88 12262.79,-1825.51 12220,-1816 12054.66,-1779.24 9483.6,-1773.47 8895.28,-1772.63"/>
<polygon fill="black" stroke="black" points="8895.09,-1769.13 8885.08,-1772.62 8895.08,-1776.13 8895.09,-1769.13"/>
<text text-anchor="middle" x="12399.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 44</text>
<text text-anchor="middle" x="12399.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_45&#45;&gt;agg1 -->
<g id="edge112" class="edge">
<title>expert1_45&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M12623.87,-1863.8C12589.72,-1845.86 12544.79,-1825.49 12502,-1816 12322.18,-1776.11 9512.64,-1772.77 8895.32,-1772.51"/>
<polygon fill="black" stroke="black" points="8895.08,-1769.01 8885.08,-1772.51 8895.08,-1776.01 8895.08,-1769.01"/>
<text text-anchor="middle" x="12681.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 45</text>
<text text-anchor="middle" x="12681.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_46&#45;&gt;agg1 -->
<g id="edge113" class="edge">
<title>expert1_46&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M12906.27,-1864C12872.08,-1846.01 12826.96,-1825.51 12784,-1816 12589.66,-1772.97 9540.45,-1772.11 8895.32,-1772.41"/>
<polygon fill="black" stroke="black" points="8895.08,-1768.91 8885.08,-1772.42 8895.08,-1775.91 8895.08,-1768.91"/>
<text text-anchor="middle" x="12963.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 46</text>
<text text-anchor="middle" x="12963.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_47&#45;&gt;agg1 -->
<g id="edge114" class="edge">
<title>expert1_47&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M13188.27,-1863.99C13154.08,-1845.99 13108.96,-1825.5 13066,-1816 12857.1,-1769.83 9566.86,-1771.5 8895.18,-1772.32"/>
<polygon fill="black" stroke="black" points="8895,-1768.82 8885,-1772.34 8895.01,-1775.82 8895,-1768.82"/>
<text text-anchor="middle" x="13245.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 47</text>
<text text-anchor="middle" x="13245.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_48&#45;&gt;agg1 -->
<g id="edge115" class="edge">
<title>expert1_48&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M13470.27,-1863.98C13436.08,-1845.98 13390.97,-1825.48 13348,-1816 13124.55,-1766.68 9593.35,-1770.92 8895.33,-1772.24"/>
<polygon fill="black" stroke="black" points="8895.25,-1768.74 8885.26,-1772.26 8895.27,-1775.74 8895.25,-1768.74"/>
<text text-anchor="middle" x="13527.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 48</text>
<text text-anchor="middle" x="13527.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_49&#45;&gt;agg1 -->
<g id="edge116" class="edge">
<title>expert1_49&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M13752.28,-1863.97C13718.09,-1845.97 13672.97,-1825.47 13630,-1816 13510.79,-1789.72 9629.01,-1775.37 8895.08,-1772.89"/>
<polygon fill="black" stroke="black" points="8895.03,-1769.39 8885.02,-1772.86 8895.01,-1776.39 8895.03,-1769.39"/>
<text text-anchor="middle" x="13809.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 49</text>
<text text-anchor="middle" x="13809.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_50&#45;&gt;agg1 -->
<g id="edge117" class="edge">
<title>expert1_50&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M14034.28,-1863.96C14000.09,-1845.95 13954.97,-1825.46 13912,-1816 13785.49,-1788.15 9654.37,-1775.01 8895.23,-1772.83"/>
<polygon fill="black" stroke="black" points="8895.11,-1769.33 8885.1,-1772.8 8895.09,-1776.33 8895.11,-1769.33"/>
<text text-anchor="middle" x="14091.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 50</text>
<text text-anchor="middle" x="14091.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_51&#45;&gt;agg1 -->
<g id="edge118" class="edge">
<title>expert1_51&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M14316.28,-1863.95C14282.09,-1845.95 14236.97,-1825.45 14194,-1816 14060.18,-1786.57 9679.33,-1774.67 8895.45,-1772.78"/>
<polygon fill="black" stroke="black" points="8895.29,-1769.28 8885.28,-1772.75 8895.27,-1776.28 8895.29,-1769.28"/>
<text text-anchor="middle" x="14373.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 51</text>
<text text-anchor="middle" x="14373.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_52&#45;&gt;agg1 -->
<g id="edge119" class="edge">
<title>expert1_52&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M14598.28,-1863.95C14564.09,-1845.94 14518.98,-1825.44 14476,-1816 14334.85,-1784.99 9703.04,-1774.35 8895.49,-1772.73"/>
<polygon fill="black" stroke="black" points="8895.31,-1769.23 8885.3,-1772.71 8895.3,-1776.23 8895.31,-1769.23"/>
<text text-anchor="middle" x="14655.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 52</text>
<text text-anchor="middle" x="14655.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_53&#45;&gt;agg1 -->
<g id="edge120" class="edge">
<title>expert1_53&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M14880.28,-1863.94C14846.09,-1845.93 14800.98,-1825.44 14758,-1816 14609.51,-1783.4 9725.67,-1774.04 8895.4,-1772.68"/>
<polygon fill="black" stroke="black" points="8895.23,-1769.18 8885.23,-1772.67 8895.22,-1776.18 8895.23,-1769.18"/>
<text text-anchor="middle" x="14937.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 53</text>
<text text-anchor="middle" x="14937.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_54&#45;&gt;agg1 -->
<g id="edge121" class="edge">
<title>expert1_54&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M15162.28,-1863.94C15128.1,-1845.92 15082.98,-1825.43 15040,-1816 14884.15,-1781.81 9747.41,-1773.75 8895.23,-1772.64"/>
<polygon fill="black" stroke="black" points="8895.1,-1769.14 8885.1,-1772.63 8895.09,-1776.14 8895.1,-1769.14"/>
<text text-anchor="middle" x="15219.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 54</text>
<text text-anchor="middle" x="15219.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_55&#45;&gt;agg1 -->
<g id="edge122" class="edge">
<title>expert1_55&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M15444.28,-1863.93C15410.1,-1845.92 15364.98,-1825.42 15322,-1816 15158.81,-1780.23 9769.87,-1773.47 8895.36,-1772.61"/>
<polygon fill="black" stroke="black" points="8895.28,-1769.11 8885.28,-1772.6 8895.27,-1776.11 8895.28,-1769.11"/>
<text text-anchor="middle" x="15501.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 55</text>
<text text-anchor="middle" x="15501.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_56&#45;&gt;agg1 -->
<g id="edge123" class="edge">
<title>expert1_56&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M15726.28,-1863.93C15692.1,-1845.91 15646.98,-1825.42 15604,-1816 15433.46,-1778.64 9791.84,-1773.2 8895.48,-1772.57"/>
<polygon fill="black" stroke="black" points="8895.15,-1769.07 8885.15,-1772.57 8895.15,-1776.07 8895.15,-1769.07"/>
<text text-anchor="middle" x="15783.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 56</text>
<text text-anchor="middle" x="15783.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_57&#45;&gt;agg1 -->
<g id="edge124" class="edge">
<title>expert1_57&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M16008.28,-1863.92C15974.1,-1845.9 15928.98,-1825.41 15886,-1816 15708.08,-1777.05 9812.15,-1772.94 8895.31,-1772.54"/>
<polygon fill="black" stroke="black" points="8895.08,-1769.04 8885.08,-1772.54 8895.08,-1776.04 8895.08,-1769.04"/>
<text text-anchor="middle" x="16065.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 57</text>
<text text-anchor="middle" x="16065.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_58&#45;&gt;agg1 -->
<g id="edge125" class="edge">
<title>expert1_58&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M16290.29,-1863.92C16256.1,-1845.9 16210.99,-1825.41 16168,-1816 15982.71,-1775.46 9832.33,-1772.7 8895.21,-1772.51"/>
<polygon fill="black" stroke="black" points="8895.09,-1769.01 8885.09,-1772.51 8895.09,-1776.01 8895.09,-1769.01"/>
<text text-anchor="middle" x="16347.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 58</text>
<text text-anchor="middle" x="16347.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_59&#45;&gt;agg1 -->
<g id="edge126" class="edge">
<title>expert1_59&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M16572.29,-1863.92C16538.1,-1845.9 16492.99,-1825.4 16450,-1816 16257.36,-1773.87 9854.12,-1772.46 8895.57,-1772.49"/>
<polygon fill="black" stroke="black" points="8895.22,-1768.99 8885.22,-1772.49 8895.22,-1775.99 8895.22,-1768.99"/>
<text text-anchor="middle" x="16629.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 59</text>
<text text-anchor="middle" x="16629.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_60&#45;&gt;agg1 -->
<g id="edge127" class="edge">
<title>expert1_60&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M16854.29,-1863.91C16820.1,-1845.89 16774.99,-1825.4 16732,-1816 16531.96,-1772.27 9872.89,-1772.23 8895.32,-1772.46"/>
<polygon fill="black" stroke="black" points="8895.12,-1768.96 8885.12,-1772.46 8895.12,-1775.96 8895.12,-1768.96"/>
<text text-anchor="middle" x="16911.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 60</text>
<text text-anchor="middle" x="16911.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_61&#45;&gt;agg1 -->
<g id="edge128" class="edge">
<title>expert1_61&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M17136.29,-1863.91C17102.1,-1845.89 17056.99,-1825.39 17014,-1816 16806.57,-1770.68 9891.96,-1772.01 8895.23,-1772.44"/>
<polygon fill="black" stroke="black" points="8895.18,-1768.94 8885.18,-1772.44 8895.19,-1775.94 8895.18,-1768.94"/>
<text text-anchor="middle" x="17193.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 61</text>
<text text-anchor="middle" x="17193.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_62&#45;&gt;agg1 -->
<g id="edge129" class="edge">
<title>expert1_62&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M17418.29,-1863.91C17384.1,-1845.88 17338.99,-1825.39 17296,-1816 17081.18,-1769.08 9911.39,-1771.8 8895.29,-1772.42"/>
<polygon fill="black" stroke="black" points="8895.05,-1768.92 8885.05,-1772.42 8895.05,-1775.92 8895.05,-1768.92"/>
<text text-anchor="middle" x="17475.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 62</text>
<text text-anchor="middle" x="17475.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert1_63&#45;&gt;agg1 -->
<g id="edge130" class="edge">
<title>expert1_63&#45;&gt;agg1</title>
<path fill="none" stroke="black" d="M17700.29,-1863.9C17666.11,-1845.88 17620.99,-1825.39 17578,-1816 17355.78,-1767.49 9929.68,-1771.59 8895.17,-1772.4"/>
<polygon fill="black" stroke="black" points="8895.12,-1768.9 8885.12,-1772.41 8895.12,-1775.9 8895.12,-1768.9"/>
<text text-anchor="middle" x="17761.5" y="-1834.8" font-family="Times,serif" font-size="14.00">expert output 63</text>
<text text-anchor="middle" x="17761.5" y="-1819.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- pre_layer2_norm -->
<g id="node69" class="node">
<title>pre_layer2_norm</title>
<polygon fill="#ffe6e6" stroke="black" points="8885,-1687 8667,-1687 8667,-1634 8885,-1634 8885,-1687"/>
<text text-anchor="middle" x="8776" y="-1671.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8776" y="-1656.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, hidden_size]</text>
<text text-anchor="middle" x="8776" y="-1641.8" font-family="Times,serif" font-size="14.00">GPU&#45;65</text>
</g>
<!-- agg1&#45;&gt;pre_layer2_norm -->
<g id="edge522" class="edge">
<title>agg1&#45;&gt;pre_layer2_norm</title>
<path fill="none" stroke="black" d="M8776,-1744.94C8776,-1730.83 8776,-1713.08 8776,-1697.57"/>
<polygon fill="black" stroke="black" points="8779.5,-1697.27 8776,-1687.27 8772.5,-1697.27 8779.5,-1697.27"/>
</g>
<!-- pre_layer2_attn -->
<g id="node70" class="node">
<title>pre_layer2_attn</title>
<polygon fill="#ffe6e6" stroke="black" points="8885,-1597 8667,-1597 8667,-1544 8885,-1544 8885,-1597"/>
<text text-anchor="middle" x="8776" y="-1581.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="8776" y="-1566.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, hidden_size]</text>
<text text-anchor="middle" x="8776" y="-1551.8" font-family="Times,serif" font-size="14.00">GPU&#45;65</text>
</g>
<!-- pre_layer2_norm&#45;&gt;pre_layer2_attn -->
<g id="edge131" class="edge">
<title>pre_layer2_norm&#45;&gt;pre_layer2_attn</title>
<path fill="none" stroke="black" d="M8776,-1633.57C8776,-1625.34 8776,-1616.08 8776,-1607.28"/>
<polygon fill="black" stroke="black" points="8779.5,-1607.24 8776,-1597.24 8772.5,-1607.24 8779.5,-1607.24"/>
</g>
<!-- router2 -->
<g id="node71" class="node">
<title>router2</title>
<polygon fill="#ffe6e6" stroke="black" points="8881.5,-1507 8670.5,-1507 8670.5,-1454 8881.5,-1454 8881.5,-1507"/>
<text text-anchor="middle" x="8776" y="-1491.8" font-family="Times,serif" font-size="14.00">Router/Gating</text>
<text text-anchor="middle" x="8776" y="-1476.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 64 experts]</text>
<text text-anchor="middle" x="8776" y="-1461.8" font-family="Times,serif" font-size="14.00">GPU&#45;65</text>
</g>
<!-- pre_layer2_attn&#45;&gt;router2 -->
<g id="edge132" class="edge">
<title>pre_layer2_attn&#45;&gt;router2</title>
<path fill="none" stroke="black" d="M8776,-1543.57C8776,-1535.34 8776,-1526.08 8776,-1517.28"/>
<polygon fill="black" stroke="black" points="8779.5,-1517.24 8776,-1507.24 8772.5,-1517.24 8779.5,-1517.24"/>
</g>
<!-- expert2_0 -->
<g id="node72" class="node">
<title>expert2_0</title>
<polygon fill="#ffe6e6" stroke="black" points="248.5,-1388 27.5,-1388 27.5,-1320 248.5,-1320 248.5,-1388"/>
<text text-anchor="middle" x="138" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="138" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="138" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="138" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;65</text>
</g>
<!-- router2&#45;&gt;expert2_0 -->
<g id="edge133" class="edge">
<title>router2&#45;&gt;expert2_0</title>
<path fill="none" stroke="black" d="M8670.39,-1479.38C7716.64,-1478.2 619.46,-1468.38 405,-1436 346.84,-1427.22 283.79,-1408.54 233.56,-1391.34"/>
<polygon fill="black" stroke="black" points="234.61,-1388 224.02,-1388.03 232.32,-1394.61 234.61,-1388"/>
<text text-anchor="middle" x="534.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 0</text>
<text text-anchor="middle" x="534.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_1 -->
<g id="node73" class="node">
<title>expert2_1</title>
<polygon fill="#ffe6e6" stroke="black" points="1107.5,-1388 886.5,-1388 886.5,-1320 1107.5,-1320 1107.5,-1388"/>
<text text-anchor="middle" x="997" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="997" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="997" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="997" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;66</text>
</g>
<!-- router2&#45;&gt;expert2_1 -->
<g id="edge134" class="edge">
<title>router2&#45;&gt;expert2_1</title>
<path fill="none" stroke="black" d="M8670.37,-1479.44C7722.36,-1478.85 711.99,-1473.19 675,-1436 665.6,-1426.55 666.34,-1416.14 675,-1406 700.91,-1375.66 795.93,-1363.27 876.08,-1358.26"/>
<polygon fill="black" stroke="black" points="876.5,-1361.74 886.28,-1357.66 876.09,-1354.76 876.5,-1361.74"/>
<text text-anchor="middle" x="804.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 1</text>
<text text-anchor="middle" x="804.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_2 -->
<g id="node74" class="node">
<title>expert2_2</title>
<polygon fill="#ffe6e6" stroke="black" points="1656.5,-1388 1435.5,-1388 1435.5,-1320 1656.5,-1320 1656.5,-1388"/>
<text text-anchor="middle" x="1546" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1546" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="1546" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="1546" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;67</text>
</g>
<!-- router2&#45;&gt;expert2_2 -->
<g id="edge135" class="edge">
<title>router2&#45;&gt;expert2_2</title>
<path fill="none" stroke="black" d="M8670.26,-1479.42C7739.74,-1478.66 980.71,-1471.91 945,-1436 935.6,-1426.55 935.98,-1415.82 945,-1406 949.03,-1401.62 1250.99,-1377.7 1425.3,-1364.23"/>
<polygon fill="black" stroke="black" points="1425.6,-1367.72 1435.3,-1363.46 1425.06,-1360.74 1425.6,-1367.72"/>
<text text-anchor="middle" x="1074.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 2</text>
<text text-anchor="middle" x="1074.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_3 -->
<g id="node75" class="node">
<title>expert2_3</title>
<polygon fill="#ffe6e6" stroke="black" points="2050.5,-1388 1829.5,-1388 1829.5,-1320 2050.5,-1320 2050.5,-1388"/>
<text text-anchor="middle" x="1940" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1940" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="1940" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="1940" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;68</text>
</g>
<!-- router2&#45;&gt;expert2_3 -->
<g id="edge136" class="edge">
<title>router2&#45;&gt;expert2_3</title>
<path fill="none" stroke="black" d="M8670.35,-1479.4C7758.37,-1478.47 1249.43,-1470.63 1215,-1436 1205.6,-1426.54 1205.76,-1415.61 1215,-1406 1232.37,-1387.92 1641,-1390 1666,-1388 1716.27,-1383.98 1771.53,-1377.68 1819.17,-1371.66"/>
<polygon fill="black" stroke="black" points="1819.74,-1375.12 1829.22,-1370.39 1818.85,-1368.18 1819.74,-1375.12"/>
<text text-anchor="middle" x="1344.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 3</text>
<text text-anchor="middle" x="1344.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_4 -->
<g id="node76" class="node">
<title>expert2_4</title>
<polygon fill="#ffe6e6" stroke="black" points="2367.5,-1388 2146.5,-1388 2146.5,-1320 2367.5,-1320 2367.5,-1388"/>
<text text-anchor="middle" x="2257" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2257" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="2257" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="2257" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;69</text>
</g>
<!-- router2&#45;&gt;expert2_4 -->
<g id="edge137" class="edge">
<title>router2&#45;&gt;expert2_4</title>
<path fill="none" stroke="black" d="M8670.29,-1479.38C7776.73,-1478.27 1519.14,-1469.34 1486,-1436 1476.6,-1426.54 1476.72,-1415.57 1486,-1406 1508.2,-1383.09 2028.25,-1391.14 2060,-1388 2084.83,-1385.54 2111.26,-1381.86 2136.44,-1377.83"/>
<polygon fill="black" stroke="black" points="2137.08,-1381.28 2146.39,-1376.22 2135.96,-1374.37 2137.08,-1381.28"/>
<text text-anchor="middle" x="1615.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 4</text>
<text text-anchor="middle" x="1615.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_5 -->
<g id="node77" class="node">
<title>expert2_5</title>
<polygon fill="#ffe6e6" stroke="black" points="2645.5,-1388 2424.5,-1388 2424.5,-1320 2645.5,-1320 2645.5,-1388"/>
<text text-anchor="middle" x="2535" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2535" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="2535" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="2535" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;70</text>
</g>
<!-- router2&#45;&gt;expert2_5 -->
<g id="edge138" class="edge">
<title>router2&#45;&gt;expert2_5</title>
<path fill="none" stroke="black" d="M8670.45,-1479.35C7796.47,-1478.07 1788.86,-1468.06 1757,-1436 1747.6,-1426.54 1747.71,-1415.56 1757,-1406 1781.01,-1381.28 2342.78,-1392.04 2377,-1388 2389.19,-1386.56 2401.83,-1384.65 2414.41,-1382.47"/>
<polygon fill="black" stroke="black" points="2415.25,-1385.87 2424.48,-1380.67 2414.02,-1378.98 2415.25,-1385.87"/>
<text text-anchor="middle" x="1886.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 5</text>
<text text-anchor="middle" x="1886.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_6 -->
<g id="node78" class="node">
<title>expert2_6</title>
<polygon fill="#ffe6e6" stroke="black" points="2903.5,-1388 2682.5,-1388 2682.5,-1320 2903.5,-1320 2903.5,-1388"/>
<text text-anchor="middle" x="2793" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2793" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="2793" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="2793" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;71</text>
</g>
<!-- router2&#45;&gt;expert2_6 -->
<g id="edge139" class="edge">
<title>router2&#45;&gt;expert2_6</title>
<path fill="none" stroke="black" d="M8670.17,-1479.32C7814.54,-1477.85 2058.57,-1466.77 2028,-1436 2018.6,-1426.54 2018.71,-1415.56 2028,-1406 2052.28,-1381.01 2620.45,-1392.58 2655,-1388 2660.71,-1387.24 2666.53,-1386.35 2672.39,-1385.35"/>
<polygon fill="black" stroke="black" points="2673.05,-1388.79 2682.27,-1383.57 2671.81,-1381.9 2673.05,-1388.79"/>
<text text-anchor="middle" x="2157.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 6</text>
<text text-anchor="middle" x="2157.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_7 -->
<g id="node79" class="node">
<title>expert2_7</title>
<polygon fill="#ffe6e6" stroke="black" points="3152.5,-1388 2931.5,-1388 2931.5,-1320 3152.5,-1320 3152.5,-1388"/>
<text text-anchor="middle" x="3042" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3042" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="3042" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="3042" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;72</text>
</g>
<!-- router2&#45;&gt;expert2_7 -->
<g id="edge140" class="edge">
<title>router2&#45;&gt;expert2_7</title>
<path fill="none" stroke="black" d="M8670.49,-1479.3C7835.68,-1477.63 2328.3,-1465.49 2299,-1436 2289.6,-1426.54 2289.71,-1415.57 2299,-1406 2322.77,-1381.52 2879.21,-1392.76 2913,-1388 2915.84,-1387.6 2918.71,-1387.16 2921.6,-1386.69"/>
<polygon fill="black" stroke="black" points="2922.24,-1390.13 2931.49,-1384.95 2921.03,-1383.23 2922.24,-1390.13"/>
<text text-anchor="middle" x="2428.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 7</text>
<text text-anchor="middle" x="2428.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_8 -->
<g id="node80" class="node">
<title>expert2_8</title>
<polygon fill="#ffe6e6" stroke="black" points="3396.5,-1388 3175.5,-1388 3175.5,-1320 3396.5,-1320 3396.5,-1388"/>
<text text-anchor="middle" x="3286" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3286" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="3286" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="3286" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;73</text>
</g>
<!-- router2&#45;&gt;expert2_8 -->
<g id="edge141" class="edge">
<title>router2&#45;&gt;expert2_8</title>
<path fill="none" stroke="black" d="M8670.42,-1479.26C7855.52,-1477.39 2598.01,-1464.21 2570,-1436 2560.61,-1426.54 2560.72,-1415.57 2570,-1406 2592.91,-1382.38 3129.44,-1392.76 3162,-1388 3163.1,-1387.84 3164.21,-1387.67 3165.32,-1387.5"/>
<polygon fill="black" stroke="black" points="3166.12,-1390.91 3175.39,-1385.78 3164.95,-1384.01 3166.12,-1390.91"/>
<text text-anchor="middle" x="2699.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 8</text>
<text text-anchor="middle" x="2699.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_9 -->
<g id="node81" class="node">
<title>expert2_9</title>
<polygon fill="#ffe6e6" stroke="black" points="3637.5,-1388 3416.5,-1388 3416.5,-1320 3637.5,-1320 3637.5,-1388"/>
<text text-anchor="middle" x="3527" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="3527" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="3527" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="3527" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;74</text>
</g>
<!-- router2&#45;&gt;expert2_9 -->
<g id="edge142" class="edge">
<title>router2&#45;&gt;expert2_9</title>
<path fill="none" stroke="black" d="M8670.34,-1479.23C7875.77,-1477.14 2867.73,-1462.93 2841,-1436 2831.61,-1426.54 2831.72,-1415.58 2841,-1406 2862.85,-1383.44 3374.94,-1392.66 3406,-1388 3406.11,-1387.98 3406.22,-1387.97 3406.32,-1387.95"/>
<polygon fill="black" stroke="black" points="3407.15,-1391.36 3416.44,-1386.27 3406,-1384.46 3407.15,-1391.36"/>
<text text-anchor="middle" x="2970.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 9</text>
<text text-anchor="middle" x="2970.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_10 -->
<g id="node82" class="node">
<title>expert2_10</title>
<polygon fill="#ffe6e6" stroke="black" points="3877.5,-1388 3656.5,-1388 3656.5,-1320 3877.5,-1320 3877.5,-1388"/>
<text text-anchor="middle" x="3767" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="3767" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="3767" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="3767" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;75</text>
</g>
<!-- router2&#45;&gt;expert2_10 -->
<g id="edge143" class="edge">
<title>router2&#45;&gt;expert2_10</title>
<path fill="none" stroke="black" d="M8670.26,-1479.19C7896.47,-1476.89 3136.46,-1461.65 3111,-1436 3101.61,-1426.54 3101.73,-1415.59 3111,-1406 3130.58,-1385.75 3565.8,-1391.7 3646.15,-1387.31"/>
<polygon fill="black" stroke="black" points="3646.71,-1390.77 3656.38,-1386.44 3646.12,-1383.8 3646.71,-1390.77"/>
<text text-anchor="middle" x="3240.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 10</text>
<text text-anchor="middle" x="3240.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_11 -->
<g id="node83" class="node">
<title>expert2_11</title>
<polygon fill="#ffe6e6" stroke="black" points="4117.5,-1388 3896.5,-1388 3896.5,-1320 4117.5,-1320 4117.5,-1388"/>
<text text-anchor="middle" x="4007" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4007" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4007" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="4007" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;76</text>
</g>
<!-- router2&#45;&gt;expert2_11 -->
<g id="edge144" class="edge">
<title>router2&#45;&gt;expert2_11</title>
<path fill="none" stroke="black" d="M8670.46,-1479.66C7920.77,-1480.68 3429.37,-1484.76 3381,-1436 3371.61,-1426.53 3371.74,-1415.59 3381,-1406 3399.43,-1386.91 3808.65,-1391.61 3886.16,-1387.31"/>
<polygon fill="black" stroke="black" points="3886.72,-1390.77 3896.38,-1386.43 3886.12,-1383.8 3886.72,-1390.77"/>
<text text-anchor="middle" x="3510.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 11</text>
<text text-anchor="middle" x="3510.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_12 -->
<g id="node84" class="node">
<title>expert2_12</title>
<polygon fill="#ffe6e6" stroke="black" points="4356.5,-1388 4135.5,-1388 4135.5,-1320 4356.5,-1320 4356.5,-1388"/>
<text text-anchor="middle" x="4246" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="4246" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4246" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="4246" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;77</text>
</g>
<!-- router2&#45;&gt;expert2_12 -->
<g id="edge145" class="edge">
<title>router2&#45;&gt;expert2_12</title>
<path fill="none" stroke="black" d="M8670.26,-1479.61C7942,-1480.29 3696.82,-1482.21 3651,-1436 3641.61,-1426.53 3641.75,-1415.6 3651,-1406 3668.28,-1388.05 4051.7,-1391.55 4125.35,-1387.46"/>
<polygon fill="black" stroke="black" points="4125.67,-1390.94 4135.33,-1386.6 4125.07,-1383.97 4125.67,-1390.94"/>
<text text-anchor="middle" x="3780.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 12</text>
<text text-anchor="middle" x="3780.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_13 -->
<g id="node85" class="node">
<title>expert2_13</title>
<polygon fill="#ffe6e6" stroke="black" points="4595.5,-1388 4374.5,-1388 4374.5,-1320 4595.5,-1320 4595.5,-1388"/>
<text text-anchor="middle" x="4485" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="4485" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4485" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="4485" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;78</text>
</g>
<!-- router2&#45;&gt;expert2_13 -->
<g id="edge146" class="edge">
<title>router2&#45;&gt;expert2_13</title>
<path fill="none" stroke="black" d="M8670.24,-1479.56C7964.48,-1479.87 3964.28,-1479.67 3921,-1436 3911.61,-1426.53 3911.76,-1415.62 3921,-1406 3937.07,-1389.27 4292.64,-1391.46 4364.03,-1387.47"/>
<polygon fill="black" stroke="black" points="4364.67,-1390.93 4374.33,-1386.59 4364.07,-1383.96 4364.67,-1390.93"/>
<text text-anchor="middle" x="4050.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 13</text>
<text text-anchor="middle" x="4050.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_14 -->
<g id="node86" class="node">
<title>expert2_14</title>
<polygon fill="#ffe6e6" stroke="black" points="4834.5,-1388 4613.5,-1388 4613.5,-1320 4834.5,-1320 4834.5,-1388"/>
<text text-anchor="middle" x="4724" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="4724" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4724" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="4724" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;79</text>
</g>
<!-- router2&#45;&gt;expert2_14 -->
<g id="edge147" class="edge">
<title>router2&#45;&gt;expert2_14</title>
<path fill="none" stroke="black" d="M8670.42,-1479.51C7988.4,-1479.43 4231.75,-1477.13 4191,-1436 4181.62,-1426.53 4181.78,-1415.63 4191,-1406 4205.9,-1390.44 4535.37,-1391.39 4603.22,-1387.46"/>
<polygon fill="black" stroke="black" points="4603.68,-1390.94 4613.33,-1386.58 4603.06,-1383.96 4603.68,-1390.94"/>
<text text-anchor="middle" x="4320.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 14</text>
<text text-anchor="middle" x="4320.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_15 -->
<g id="node87" class="node">
<title>expert2_15</title>
<polygon fill="#ffe6e6" stroke="black" points="5073.5,-1388 4852.5,-1388 4852.5,-1320 5073.5,-1320 5073.5,-1388"/>
<text text-anchor="middle" x="4963" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="4963" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4963" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="4963" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;80</text>
</g>
<!-- router2&#45;&gt;expert2_15 -->
<g id="edge148" class="edge">
<title>router2&#45;&gt;expert2_15</title>
<path fill="none" stroke="black" d="M8670.34,-1479.44C8012.03,-1478.96 4499.21,-1474.6 4461,-1436 4451.62,-1426.52 4451.8,-1415.65 4461,-1406 4474.7,-1391.64 4777.04,-1391.34 4842.06,-1387.48"/>
<polygon fill="black" stroke="black" points="4842.68,-1390.94 4852.33,-1386.56 4842.06,-1383.96 4842.68,-1390.94"/>
<text text-anchor="middle" x="4590.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 15</text>
<text text-anchor="middle" x="4590.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_16 -->
<g id="node88" class="node">
<title>expert2_16</title>
<polygon fill="#ffe6e6" stroke="black" points="5312.5,-1388 5091.5,-1388 5091.5,-1320 5312.5,-1320 5312.5,-1388"/>
<text text-anchor="middle" x="5202" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 16</text>
<text text-anchor="middle" x="5202" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5202" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="5202" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;81</text>
</g>
<!-- router2&#45;&gt;expert2_16 -->
<g id="edge149" class="edge">
<title>router2&#45;&gt;expert2_16</title>
<path fill="none" stroke="black" d="M8670.37,-1479.37C8036.8,-1478.47 4766.68,-1472.07 4731,-1436 4721.62,-1426.52 4721.82,-1415.67 4731,-1406 4756.45,-1379.22 5012.74,-1392.53 5081.13,-1387.64"/>
<polygon fill="black" stroke="black" points="5081.75,-1391.09 5091.33,-1386.55 5081.01,-1384.13 5081.75,-1391.09"/>
<text text-anchor="middle" x="4860.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 16</text>
<text text-anchor="middle" x="4860.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_17 -->
<g id="node89" class="node">
<title>expert2_17</title>
<polygon fill="#ffe6e6" stroke="black" points="5551.5,-1388 5330.5,-1388 5330.5,-1320 5551.5,-1320 5551.5,-1388"/>
<text text-anchor="middle" x="5441" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 17</text>
<text text-anchor="middle" x="5441" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5441" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="5441" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;82</text>
</g>
<!-- router2&#45;&gt;expert2_17 -->
<g id="edge150" class="edge">
<title>router2&#45;&gt;expert2_17</title>
<path fill="none" stroke="black" d="M8670.11,-1479.29C8061.44,-1477.94 5034.15,-1469.54 5001,-1436 4991.63,-1426.52 4991.84,-1415.69 5001,-1406 5024.06,-1381.61 5255.99,-1392.29 5320.12,-1387.63"/>
<polygon fill="black" stroke="black" points="5320.76,-1391.08 5330.32,-1386.53 5320,-1384.12 5320.76,-1391.08"/>
<text text-anchor="middle" x="5130.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 17</text>
<text text-anchor="middle" x="5130.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_18 -->
<g id="node90" class="node">
<title>expert2_18</title>
<polygon fill="#ffe6e6" stroke="black" points="5790.5,-1388 5569.5,-1388 5569.5,-1320 5790.5,-1320 5790.5,-1388"/>
<text text-anchor="middle" x="5680" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 18</text>
<text text-anchor="middle" x="5680" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5680" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="5680" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;83</text>
</g>
<!-- router2&#45;&gt;expert2_18 -->
<g id="edge151" class="edge">
<title>router2&#45;&gt;expert2_18</title>
<path fill="none" stroke="black" d="M8670.19,-1479.19C8088.18,-1477.37 5301.64,-1467.02 5271,-1436 5261.63,-1426.51 5261.87,-1415.72 5271,-1406 5291.68,-1383.99 5499.62,-1392.08 5559.22,-1387.62"/>
<polygon fill="black" stroke="black" points="5559.76,-1391.08 5569.32,-1386.51 5559,-1384.13 5559.76,-1391.08"/>
<text text-anchor="middle" x="5400.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 18</text>
<text text-anchor="middle" x="5400.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_19 -->
<g id="node91" class="node">
<title>expert2_19</title>
<polygon fill="#ffe6e6" stroke="black" points="6029.5,-1388 5808.5,-1388 5808.5,-1320 6029.5,-1320 6029.5,-1388"/>
<text text-anchor="middle" x="5919" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 19</text>
<text text-anchor="middle" x="5919" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5919" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="5919" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;84</text>
</g>
<!-- router2&#45;&gt;expert2_19 -->
<g id="edge152" class="edge">
<title>router2&#45;&gt;expert2_19</title>
<path fill="none" stroke="black" d="M8670.29,-1479.08C8115.98,-1476.75 5569.12,-1464.5 5541,-1436 5531.64,-1426.51 5531.9,-1415.75 5541,-1406 5559.29,-1386.39 5742.86,-1391.9 5798.11,-1387.63"/>
<polygon fill="black" stroke="black" points="5798.77,-1391.08 5808.31,-1386.48 5797.99,-1384.12 5798.77,-1391.08"/>
<text text-anchor="middle" x="5670.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 19</text>
<text text-anchor="middle" x="5670.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_20 -->
<g id="node92" class="node">
<title>expert2_20</title>
<polygon fill="#ffe6e6" stroke="black" points="6268.5,-1388 6047.5,-1388 6047.5,-1320 6268.5,-1320 6268.5,-1388"/>
<text text-anchor="middle" x="6158" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 20</text>
<text text-anchor="middle" x="6158" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="6158" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="6158" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;85</text>
</g>
<!-- router2&#45;&gt;expert2_20 -->
<g id="edge153" class="edge">
<title>router2&#45;&gt;expert2_20</title>
<path fill="none" stroke="black" d="M8670.16,-1478.95C8144.28,-1476.07 5836.61,-1461.99 5811,-1436 5801.64,-1426.5 5801.95,-1415.79 5811,-1406 5826.93,-1388.76 5986.66,-1391.78 6037.18,-1387.63"/>
<polygon fill="black" stroke="black" points="6037.78,-1391.09 6047.31,-1386.44 6036.97,-1384.13 6037.78,-1391.09"/>
<text text-anchor="middle" x="5940.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 20</text>
<text text-anchor="middle" x="5940.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_21 -->
<g id="node93" class="node">
<title>expert2_21</title>
<polygon fill="#ffe6e6" stroke="black" points="6507.5,-1388 6286.5,-1388 6286.5,-1320 6507.5,-1320 6507.5,-1388"/>
<text text-anchor="middle" x="6397" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 21</text>
<text text-anchor="middle" x="6397" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="6397" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="6397" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;86</text>
</g>
<!-- router2&#45;&gt;expert2_21 -->
<g id="edge154" class="edge">
<title>router2&#45;&gt;expert2_21</title>
<path fill="none" stroke="black" d="M8670.28,-1479.8C8177.41,-1480.96 6127.19,-1482.94 6081,-1436 6071.65,-1426.5 6072.01,-1415.85 6081,-1406 6094.57,-1391.13 6230.44,-1391.72 6276.16,-1387.65"/>
<polygon fill="black" stroke="black" points="6276.8,-1391.1 6286.3,-1386.4 6275.95,-1384.15 6276.8,-1391.1"/>
<text text-anchor="middle" x="6210.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 21</text>
<text text-anchor="middle" x="6210.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_22 -->
<g id="node94" class="node">
<title>expert2_22</title>
<polygon fill="#ffe6e6" stroke="black" points="6746.5,-1388 6525.5,-1388 6525.5,-1320 6746.5,-1320 6746.5,-1388"/>
<text text-anchor="middle" x="6636" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 22</text>
<text text-anchor="middle" x="6636" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="6636" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="6636" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;87</text>
</g>
<!-- router2&#45;&gt;expert2_22 -->
<g id="edge155" class="edge">
<title>router2&#45;&gt;expert2_22</title>
<path fill="none" stroke="black" d="M8670.28,-1479.6C8208.81,-1479.81 6392.21,-1477.95 6351,-1436 6341.66,-1426.49 6342.09,-1415.92 6351,-1406 6374.09,-1380.27 6466.61,-1392.92 6515.32,-1387.78"/>
<polygon fill="black" stroke="black" points="6515.89,-1391.23 6525.29,-1386.34 6514.89,-1384.3 6515.89,-1391.23"/>
<text text-anchor="middle" x="6480.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 22</text>
<text text-anchor="middle" x="6480.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_23 -->
<g id="node95" class="node">
<title>expert2_23</title>
<polygon fill="#ffe6e6" stroke="black" points="6985.5,-1388 6764.5,-1388 6764.5,-1320 6985.5,-1320 6985.5,-1388"/>
<text text-anchor="middle" x="6875" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 23</text>
<text text-anchor="middle" x="6875" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="6875" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="6875" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;88</text>
</g>
<!-- router2&#45;&gt;expert2_23 -->
<g id="edge156" class="edge">
<title>router2&#45;&gt;expert2_23</title>
<path fill="none" stroke="black" d="M8670.38,-1479.36C8242.28,-1478.53 6657.24,-1472.98 6621,-1436 6611.67,-1426.48 6612.22,-1416.03 6621,-1406 6639.34,-1385.05 6713.09,-1392.54 6754.3,-1387.79"/>
<polygon fill="black" stroke="black" points="6754.93,-1391.24 6764.27,-1386.25 6753.85,-1384.32 6754.93,-1391.24"/>
<text text-anchor="middle" x="6750.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 23</text>
<text text-anchor="middle" x="6750.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_24 -->
<g id="node96" class="node">
<title>expert2_24</title>
<polygon fill="#ffe6e6" stroke="black" points="7224.5,-1388 7003.5,-1388 7003.5,-1320 7224.5,-1320 7224.5,-1388"/>
<text text-anchor="middle" x="7114" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 24</text>
<text text-anchor="middle" x="7114" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7114" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="7114" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;89</text>
</g>
<!-- router2&#45;&gt;expert2_24 -->
<g id="edge157" class="edge">
<title>router2&#45;&gt;expert2_24</title>
<path fill="none" stroke="black" d="M8670.21,-1479.04C8277.22,-1477.08 6922.29,-1468.02 6891,-1436 6881.68,-1426.46 6882.41,-1416.2 6891,-1406 6904.63,-1389.81 6959.71,-1392.37 6993.2,-1387.85"/>
<polygon fill="black" stroke="black" points="6993.99,-1391.27 7003.24,-1386.1 6992.79,-1384.37 6993.99,-1391.27"/>
<text text-anchor="middle" x="7020.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 24</text>
<text text-anchor="middle" x="7020.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_25 -->
<g id="node97" class="node">
<title>expert2_25</title>
<polygon fill="#ffe6e6" stroke="black" points="7463.5,-1388 7242.5,-1388 7242.5,-1320 7463.5,-1320 7463.5,-1388"/>
<text text-anchor="middle" x="7353" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 25</text>
<text text-anchor="middle" x="7353" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7353" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="7353" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;90</text>
</g>
<!-- router2&#45;&gt;expert2_25 -->
<g id="edge158" class="edge">
<title>router2&#45;&gt;expert2_25</title>
<path fill="none" stroke="black" d="M8670.43,-1478.62C8315.72,-1475.41 7187.37,-1463.09 7161,-1436 7151.7,-1426.45 7152.78,-1416.5 7161,-1406 7179.84,-1381.96 7198.22,-1393.9 7232.42,-1387.96"/>
<polygon fill="black" stroke="black" points="7233.47,-1391.31 7242.5,-1385.76 7231.98,-1384.47 7233.47,-1391.31"/>
<text text-anchor="middle" x="7290.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 25</text>
<text text-anchor="middle" x="7290.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_26 -->
<g id="node98" class="node">
<title>expert2_26</title>
<polygon fill="#ffe6e6" stroke="black" points="7702.5,-1388 7481.5,-1388 7481.5,-1320 7702.5,-1320 7702.5,-1388"/>
<text text-anchor="middle" x="7592" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 26</text>
<text text-anchor="middle" x="7592" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7592" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="7592" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;91</text>
</g>
<!-- router2&#45;&gt;expert2_26 -->
<g id="edge159" class="edge">
<title>router2&#45;&gt;expert2_26</title>
<path fill="none" stroke="black" d="M8670.46,-1480.04C8360.83,-1481.12 7473.89,-1480.3 7431,-1436 7421.73,-1426.42 7423.12,-1416.76 7431,-1406 7432.75,-1403.61 7449.49,-1397.63 7471.56,-1390.57"/>
<polygon fill="black" stroke="black" points="7472.84,-1393.84 7481.32,-1387.49 7470.73,-1387.16 7472.84,-1393.84"/>
<text text-anchor="middle" x="7560.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 26</text>
<text text-anchor="middle" x="7560.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_27 -->
<g id="node99" class="node">
<title>expert2_27</title>
<polygon fill="#ffe6e6" stroke="black" points="7941.5,-1388 7720.5,-1388 7720.5,-1320 7941.5,-1320 7941.5,-1388"/>
<text text-anchor="middle" x="7831" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 27</text>
<text text-anchor="middle" x="7831" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7831" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="7831" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;92</text>
</g>
<!-- router2&#45;&gt;expert2_27 -->
<g id="edge160" class="edge">
<title>router2&#45;&gt;expert2_27</title>
<path fill="none" stroke="black" d="M8670.02,-1479.12C8405.53,-1477.65 7735.16,-1470.53 7702,-1436 7686.29,-1419.64 7695.58,-1405.16 7714.88,-1393.12"/>
<polygon fill="black" stroke="black" points="7716.75,-1396.09 7723.73,-1388.12 7713.3,-1390 7716.75,-1396.09"/>
<text text-anchor="middle" x="7831.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 27</text>
<text text-anchor="middle" x="7831.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_28 -->
<g id="node100" class="node">
<title>expert2_28</title>
<polygon fill="#ffe6e6" stroke="black" points="8180.5,-1388 7959.5,-1388 7959.5,-1320 8180.5,-1320 8180.5,-1388"/>
<text text-anchor="middle" x="8070" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 28</text>
<text text-anchor="middle" x="8070" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8070" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="8070" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;93</text>
</g>
<!-- router2&#45;&gt;expert2_28 -->
<g id="edge161" class="edge">
<title>router2&#45;&gt;expert2_28</title>
<path fill="none" stroke="black" d="M8670.13,-1477.59C8457.26,-1473.23 7995.63,-1460.94 7972,-1436 7957.98,-1421.2 7966.83,-1406.54 7983.87,-1393.84"/>
<polygon fill="black" stroke="black" points="7985.93,-1396.67 7992.23,-1388.15 7981.99,-1390.88 7985.93,-1396.67"/>
<text text-anchor="middle" x="8101.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 28</text>
<text text-anchor="middle" x="8101.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_29 -->
<g id="node101" class="node">
<title>expert2_29</title>
<polygon fill="#ffe6e6" stroke="black" points="8419.5,-1388 8198.5,-1388 8198.5,-1320 8419.5,-1320 8419.5,-1388"/>
<text text-anchor="middle" x="8309" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 29</text>
<text text-anchor="middle" x="8309" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8309" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="8309" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;94</text>
</g>
<!-- router2&#45;&gt;expert2_29 -->
<g id="edge162" class="edge">
<title>router2&#45;&gt;expert2_29</title>
<path fill="none" stroke="black" d="M8670.25,-1478.41C8522.85,-1475.78 8270.37,-1466.78 8242,-1436 8230.21,-1423.21 8236.49,-1408.71 8249.02,-1395.55"/>
<polygon fill="black" stroke="black" points="8251.71,-1397.82 8256.55,-1388.39 8246.89,-1392.74 8251.71,-1397.82"/>
<text text-anchor="middle" x="8371.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 29</text>
<text text-anchor="middle" x="8371.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_30 -->
<g id="node102" class="node">
<title>expert2_30</title>
<polygon fill="#ffe6e6" stroke="black" points="8658.5,-1388 8437.5,-1388 8437.5,-1320 8658.5,-1320 8658.5,-1388"/>
<text text-anchor="middle" x="8548" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 30</text>
<text text-anchor="middle" x="8548" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8548" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="8548" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;95</text>
</g>
<!-- router2&#45;&gt;expert2_30 -->
<g id="edge163" class="edge">
<title>router2&#45;&gt;expert2_30</title>
<path fill="none" stroke="black" d="M8670.19,-1475.69C8605.94,-1470.89 8532.48,-1460.13 8512,-1436 8502.36,-1424.64 8505.16,-1410.29 8512.37,-1396.84"/>
<polygon fill="black" stroke="black" points="8515.44,-1398.53 8517.65,-1388.17 8509.46,-1394.88 8515.44,-1398.53"/>
<text text-anchor="middle" x="8641.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 30</text>
<text text-anchor="middle" x="8641.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_31 -->
<g id="node103" class="node">
<title>expert2_31</title>
<polygon fill="#ffe6e6" stroke="black" points="8897.5,-1388 8676.5,-1388 8676.5,-1320 8897.5,-1320 8897.5,-1388"/>
<text text-anchor="middle" x="8787" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 31</text>
<text text-anchor="middle" x="8787" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8787" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="8787" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;96</text>
</g>
<!-- router2&#45;&gt;expert2_31 -->
<g id="edge164" class="edge">
<title>router2&#45;&gt;expert2_31</title>
<path fill="none" stroke="black" d="M8775.22,-1453.92C8775.07,-1439.76 8775.35,-1421.87 8777,-1406 8777.27,-1403.45 8777.6,-1400.83 8777.97,-1398.2"/>
<polygon fill="black" stroke="black" points="8781.47,-1398.5 8779.62,-1388.06 8774.56,-1397.37 8781.47,-1398.5"/>
<text text-anchor="middle" x="8906.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 31</text>
<text text-anchor="middle" x="8906.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_32 -->
<g id="node104" class="node">
<title>expert2_32</title>
<polygon fill="#ffe6e6" stroke="black" points="9157.5,-1388 8936.5,-1388 8936.5,-1320 9157.5,-1320 9157.5,-1388"/>
<text text-anchor="middle" x="9047" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 32</text>
<text text-anchor="middle" x="9047" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9047" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="9047" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;97</text>
</g>
<!-- router2&#45;&gt;expert2_32 -->
<g id="edge165" class="edge">
<title>router2&#45;&gt;expert2_32</title>
<path fill="none" stroke="black" d="M8881.63,-1474.34C8943.89,-1468.98 9014.57,-1458.1 9036,-1436 9045.6,-1426.1 9049.5,-1412.03 9050.64,-1398.4"/>
<polygon fill="black" stroke="black" points="9054.15,-1398.25 9051.02,-1388.13 9047.15,-1397.99 9054.15,-1398.25"/>
<text text-anchor="middle" x="9178.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 32</text>
<text text-anchor="middle" x="9178.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_33 -->
<g id="node105" class="node">
<title>expert2_33</title>
<polygon fill="#ffe6e6" stroke="black" points="9428.5,-1388 9207.5,-1388 9207.5,-1320 9428.5,-1320 9428.5,-1388"/>
<text text-anchor="middle" x="9318" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 33</text>
<text text-anchor="middle" x="9318" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9318" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="9318" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;98</text>
</g>
<!-- router2&#45;&gt;expert2_33 -->
<g id="edge166" class="edge">
<title>router2&#45;&gt;expert2_33</title>
<path fill="none" stroke="black" d="M8881.54,-1478.16C9029.08,-1475.22 9282.38,-1465.83 9312,-1436 9321.66,-1426.27 9324.85,-1412.25 9325.09,-1398.6"/>
<polygon fill="black" stroke="black" points="9328.58,-1398.19 9324.75,-1388.31 9321.58,-1398.42 9328.58,-1398.19"/>
<text text-anchor="middle" x="9453.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 33</text>
<text text-anchor="middle" x="9453.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_34 -->
<g id="node106" class="node">
<title>expert2_34</title>
<polygon fill="#ffe6e6" stroke="black" points="9705.5,-1388 9484.5,-1388 9484.5,-1320 9705.5,-1320 9705.5,-1388"/>
<text text-anchor="middle" x="9595" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 34</text>
<text text-anchor="middle" x="9595" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9595" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="9595" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;99</text>
</g>
<!-- router2&#45;&gt;expert2_34 -->
<g id="edge167" class="edge">
<title>router2&#45;&gt;expert2_34</title>
<path fill="none" stroke="black" d="M8881.78,-1477.45C9095.77,-1472.8 9561.92,-1459.98 9587,-1436 9597.01,-1426.43 9600.53,-1412.31 9601.06,-1398.53"/>
<polygon fill="black" stroke="black" points="9604.55,-1398.1 9600.94,-1388.15 9597.55,-1398.19 9604.55,-1398.1"/>
<text text-anchor="middle" x="9729.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 34</text>
<text text-anchor="middle" x="9729.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_35 -->
<g id="node107" class="node">
<title>expert2_35</title>
<polygon fill="#ffe6e6" stroke="black" points="9984.5,-1388 9763.5,-1388 9763.5,-1320 9984.5,-1320 9984.5,-1388"/>
<text text-anchor="middle" x="9874" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 35</text>
<text text-anchor="middle" x="9874" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9874" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="9874" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;100</text>
</g>
<!-- router2&#45;&gt;expert2_35 -->
<g id="edge168" class="edge">
<title>router2&#45;&gt;expert2_35</title>
<path fill="none" stroke="black" d="M8881.53,-1478.9C9147.57,-1476.92 9827.08,-1468.66 9863,-1436 9873.39,-1426.55 9877.39,-1412.3 9878.39,-1398.37"/>
<polygon fill="black" stroke="black" points="9881.89,-1398.45 9878.64,-1388.36 9874.89,-1398.27 9881.89,-1398.45"/>
<text text-anchor="middle" x="10006.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 35</text>
<text text-anchor="middle" x="10006.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_36 -->
<g id="node108" class="node">
<title>expert2_36</title>
<polygon fill="#ffe6e6" stroke="black" points="10265.5,-1388 10044.5,-1388 10044.5,-1320 10265.5,-1320 10265.5,-1388"/>
<text text-anchor="middle" x="10155" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 36</text>
<text text-anchor="middle" x="10155" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10155" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="10155" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;101</text>
</g>
<!-- router2&#45;&gt;expert2_36 -->
<g id="edge169" class="edge">
<title>router2&#45;&gt;expert2_36</title>
<path fill="none" stroke="black" d="M8881.56,-1479.71C9193.53,-1479.88 10092.52,-1476.79 10140,-1436 10150.82,-1426.7 10155.49,-1412.34 10157.15,-1398.29"/>
<polygon fill="black" stroke="black" points="10160.65,-1398.41 10157.88,-1388.18 10153.67,-1397.9 10160.65,-1398.41"/>
<text text-anchor="middle" x="10284.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 36</text>
<text text-anchor="middle" x="10284.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_37 -->
<g id="node109" class="node">
<title>expert2_37</title>
<polygon fill="#ffe6e6" stroke="black" points="10546.5,-1388 10325.5,-1388 10325.5,-1320 10546.5,-1320 10546.5,-1388"/>
<text text-anchor="middle" x="10436" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 37</text>
<text text-anchor="middle" x="10436" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10436" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="10436" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;102</text>
</g>
<!-- router2&#45;&gt;expert2_37 -->
<g id="edge170" class="edge">
<title>router2&#45;&gt;expert2_37</title>
<path fill="none" stroke="black" d="M8881.56,-1478.44C9239.75,-1474.62 10388.29,-1460.48 10418,-1436 10429.09,-1426.86 10434.27,-1412.54 10436.46,-1398.46"/>
<polygon fill="black" stroke="black" points="10439.96,-1398.66 10437.57,-1388.34 10433,-1397.9 10439.96,-1398.66"/>
<text text-anchor="middle" x="10563.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 37</text>
<text text-anchor="middle" x="10563.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_38 -->
<g id="node110" class="node">
<title>expert2_38</title>
<polygon fill="#ffe6e6" stroke="black" points="10828.5,-1388 10607.5,-1388 10607.5,-1320 10828.5,-1320 10828.5,-1388"/>
<text text-anchor="middle" x="10718" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 38</text>
<text text-anchor="middle" x="10718" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10718" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="10718" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;103</text>
</g>
<!-- router2&#45;&gt;expert2_38 -->
<g id="edge171" class="edge">
<title>router2&#45;&gt;expert2_38</title>
<path fill="none" stroke="black" d="M8881.52,-1478.82C9278.45,-1476.05 10661.18,-1464.37 10697,-1436 10708.45,-1426.93 10714.15,-1412.48 10716.84,-1398.28"/>
<polygon fill="black" stroke="black" points="10720.35,-1398.46 10718.31,-1388.07 10713.42,-1397.47 10720.35,-1398.46"/>
<text text-anchor="middle" x="10844.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 38</text>
<text text-anchor="middle" x="10844.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_39 -->
<g id="node111" class="node">
<title>expert2_39</title>
<polygon fill="#ffe6e6" stroke="black" points="11110.5,-1388 10889.5,-1388 10889.5,-1320 11110.5,-1320 11110.5,-1388"/>
<text text-anchor="middle" x="11000" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 39</text>
<text text-anchor="middle" x="11000" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11000" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="11000" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;104</text>
</g>
<!-- router2&#45;&gt;expert2_39 -->
<g id="edge172" class="edge">
<title>router2&#45;&gt;expert2_39</title>
<path fill="none" stroke="black" d="M8881.82,-1479.12C9315.53,-1477.36 10936.23,-1468.59 10978,-1436 10989.56,-1426.98 10995.43,-1412.55 10998.3,-1398.34"/>
<polygon fill="black" stroke="black" points="11001.81,-1398.54 10999.89,-1388.12 10994.89,-1397.46 11001.81,-1398.54"/>
<text text-anchor="middle" x="11125.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 39</text>
<text text-anchor="middle" x="11125.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_40 -->
<g id="node112" class="node">
<title>expert2_40</title>
<polygon fill="#ffe6e6" stroke="black" points="11392.5,-1388 11171.5,-1388 11171.5,-1320 11392.5,-1320 11392.5,-1388"/>
<text text-anchor="middle" x="11282" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 40</text>
<text text-anchor="middle" x="11282" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11282" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="11282" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;105</text>
</g>
<!-- router2&#45;&gt;expert2_40 -->
<g id="edge173" class="edge">
<title>router2&#45;&gt;expert2_40</title>
<path fill="none" stroke="black" d="M8881.62,-1479.35C9349.11,-1478.5 11211.2,-1472.78 11259,-1436 11270.65,-1427.03 11276.7,-1412.61 11279.75,-1398.4"/>
<polygon fill="black" stroke="black" points="11283.26,-1398.61 11281.47,-1388.17 11276.36,-1397.45 11283.26,-1398.61"/>
<text text-anchor="middle" x="11406.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 40</text>
<text text-anchor="middle" x="11406.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_41 -->
<g id="node113" class="node">
<title>expert2_41</title>
<polygon fill="#ffe6e6" stroke="black" points="11674.5,-1388 11453.5,-1388 11453.5,-1320 11674.5,-1320 11674.5,-1388"/>
<text text-anchor="middle" x="11564" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 41</text>
<text text-anchor="middle" x="11564" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11564" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="11564" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;106</text>
</g>
<!-- router2&#45;&gt;expert2_41 -->
<g id="edge174" class="edge">
<title>router2&#45;&gt;expert2_41</title>
<path fill="none" stroke="black" d="M8881.64,-1479.54C9381.37,-1479.5 11486.11,-1476.9 11540,-1436 11551.75,-1427.08 11557.97,-1412.67 11561.2,-1398.45"/>
<polygon fill="black" stroke="black" points="11564.71,-1398.68 11563.05,-1388.22 11557.82,-1397.43 11564.71,-1398.68"/>
<text text-anchor="middle" x="11688.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 41</text>
<text text-anchor="middle" x="11688.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_42 -->
<g id="node114" class="node">
<title>expert2_42</title>
<polygon fill="#ffe6e6" stroke="black" points="11956.5,-1388 11735.5,-1388 11735.5,-1320 11956.5,-1320 11956.5,-1388"/>
<text text-anchor="middle" x="11846" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 42</text>
<text text-anchor="middle" x="11846" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11846" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="11846" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;107</text>
</g>
<!-- router2&#45;&gt;expert2_42 -->
<g id="edge175" class="edge">
<title>router2&#45;&gt;expert2_42</title>
<path fill="none" stroke="black" d="M8881.67,-1479.7C9412.18,-1480.47 11762.18,-1481.33 11822,-1436 11833.76,-1427.09 11839.98,-1412.68 11843.2,-1398.46"/>
<polygon fill="black" stroke="black" points="11846.72,-1398.69 11845.06,-1388.22 11839.83,-1397.44 11846.72,-1398.69"/>
<text text-anchor="middle" x="11970.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 42</text>
<text text-anchor="middle" x="11970.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_43 -->
<g id="node115" class="node">
<title>expert2_43</title>
<polygon fill="#ffe6e6" stroke="black" points="12238.5,-1388 12017.5,-1388 12017.5,-1320 12238.5,-1320 12238.5,-1388"/>
<text text-anchor="middle" x="12128" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 43</text>
<text text-anchor="middle" x="12128" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12128" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="12128" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;108</text>
</g>
<!-- router2&#45;&gt;expert2_43 -->
<g id="edge176" class="edge">
<title>router2&#45;&gt;expert2_43</title>
<path fill="none" stroke="black" d="M8881.82,-1478.96C9445.53,-1476.01 12071.1,-1460.9 12104,-1436 12115.76,-1427.1 12121.99,-1412.68 12125.21,-1398.47"/>
<polygon fill="black" stroke="black" points="12128.73,-1398.69 12127.06,-1388.23 12121.84,-1397.45 12128.73,-1398.69"/>
<text text-anchor="middle" x="12252.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 43</text>
<text text-anchor="middle" x="12252.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_44 -->
<g id="node116" class="node">
<title>expert2_44</title>
<polygon fill="#ffe6e6" stroke="black" points="12520.5,-1388 12299.5,-1388 12299.5,-1320 12520.5,-1320 12520.5,-1388"/>
<text text-anchor="middle" x="12410" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 44</text>
<text text-anchor="middle" x="12410" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12410" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="12410" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;109</text>
</g>
<!-- router2&#45;&gt;expert2_44 -->
<g id="edge177" class="edge">
<title>router2&#45;&gt;expert2_44</title>
<path fill="none" stroke="black" d="M8881.92,-1479.07C9474.15,-1476.59 12350.12,-1463.13 12386,-1436 12397.77,-1427.1 12403.99,-1412.69 12407.21,-1398.47"/>
<polygon fill="black" stroke="black" points="12410.73,-1398.7 12409.07,-1388.24 12403.84,-1397.45 12410.73,-1398.7"/>
<text text-anchor="middle" x="12534.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 44</text>
<text text-anchor="middle" x="12534.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_45 -->
<g id="node117" class="node">
<title>expert2_45</title>
<polygon fill="#ffe6e6" stroke="black" points="12802.5,-1388 12581.5,-1388 12581.5,-1320 12802.5,-1320 12802.5,-1388"/>
<text text-anchor="middle" x="12692" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 45</text>
<text text-anchor="middle" x="12692" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12692" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="12692" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;110</text>
</g>
<!-- router2&#45;&gt;expert2_45 -->
<g id="edge178" class="edge">
<title>router2&#45;&gt;expert2_45</title>
<path fill="none" stroke="black" d="M8881.74,-1479.17C9500.77,-1477.13 12629.14,-1465.36 12668,-1436 12679.77,-1427.11 12686,-1412.7 12689.22,-1398.48"/>
<polygon fill="black" stroke="black" points="12692.74,-1398.71 12691.07,-1388.24 12685.85,-1397.46 12692.74,-1398.71"/>
<text text-anchor="middle" x="12816.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 45</text>
<text text-anchor="middle" x="12816.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_46 -->
<g id="node118" class="node">
<title>expert2_46</title>
<polygon fill="#ffe6e6" stroke="black" points="13084.5,-1388 12863.5,-1388 12863.5,-1320 13084.5,-1320 13084.5,-1388"/>
<text text-anchor="middle" x="12974" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 46</text>
<text text-anchor="middle" x="12974" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12974" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="12974" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;111</text>
</g>
<!-- router2&#45;&gt;expert2_46 -->
<g id="edge179" class="edge">
<title>router2&#45;&gt;expert2_46</title>
<path fill="none" stroke="black" d="M8881.7,-1479.25C9526.87,-1477.62 12908.14,-1467.59 12950,-1436 12961.77,-1427.11 12968,-1412.7 12971.22,-1398.48"/>
<polygon fill="black" stroke="black" points="12974.74,-1398.71 12973.07,-1388.25 12967.85,-1397.46 12974.74,-1398.71"/>
<text text-anchor="middle" x="13098.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 46</text>
<text text-anchor="middle" x="13098.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_47 -->
<g id="node119" class="node">
<title>expert2_47</title>
<polygon fill="#ffe6e6" stroke="black" points="13366.5,-1388 13145.5,-1388 13145.5,-1320 13366.5,-1320 13366.5,-1388"/>
<text text-anchor="middle" x="13256" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 47</text>
<text text-anchor="middle" x="13256" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13256" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="13256" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;112</text>
</g>
<!-- router2&#45;&gt;expert2_47 -->
<g id="edge180" class="edge">
<title>router2&#45;&gt;expert2_47</title>
<path fill="none" stroke="black" d="M8881.7,-1479.32C9552.22,-1478.09 13187.15,-1469.83 13232,-1436 13243.78,-1427.12 13250.01,-1412.71 13253.23,-1398.49"/>
<polygon fill="black" stroke="black" points="13256.74,-1398.71 13255.08,-1388.25 13249.85,-1397.47 13256.74,-1398.71"/>
<text text-anchor="middle" x="13380.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 47</text>
<text text-anchor="middle" x="13380.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_48 -->
<g id="node120" class="node">
<title>expert2_48</title>
<polygon fill="#ffe6e6" stroke="black" points="13648.5,-1388 13427.5,-1388 13427.5,-1320 13648.5,-1320 13648.5,-1388"/>
<text text-anchor="middle" x="13538" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 48</text>
<text text-anchor="middle" x="13538" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13538" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="13538" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;113</text>
</g>
<!-- router2&#45;&gt;expert2_48 -->
<g id="edge181" class="edge">
<title>router2&#45;&gt;expert2_48</title>
<path fill="none" stroke="black" d="M8881.58,-1479.38C9576.35,-1478.52 13466.15,-1472.07 13514,-1436 13525.78,-1427.12 13532.01,-1412.71 13535.23,-1398.49"/>
<polygon fill="black" stroke="black" points="13538.75,-1398.72 13537.08,-1388.25 13531.86,-1397.47 13538.75,-1398.72"/>
<text text-anchor="middle" x="13662.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 48</text>
<text text-anchor="middle" x="13662.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_49 -->
<g id="node121" class="node">
<title>expert2_49</title>
<polygon fill="#ffe6e6" stroke="black" points="13930.5,-1388 13709.5,-1388 13709.5,-1320 13930.5,-1320 13930.5,-1388"/>
<text text-anchor="middle" x="13820" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 49</text>
<text text-anchor="middle" x="13820" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13820" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="13820" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;114</text>
</g>
<!-- router2&#45;&gt;expert2_49 -->
<g id="edge182" class="edge">
<title>router2&#45;&gt;expert2_49</title>
<path fill="none" stroke="black" d="M8881.73,-1479.44C9600.75,-1478.93 13745.15,-1474.32 13796,-1436 13807.78,-1427.12 13814.01,-1412.72 13817.23,-1398.5"/>
<polygon fill="black" stroke="black" points="13820.75,-1398.72 13819.08,-1388.26 13813.86,-1397.48 13820.75,-1398.72"/>
<text text-anchor="middle" x="13944.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 49</text>
<text text-anchor="middle" x="13944.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_50 -->
<g id="node122" class="node">
<title>expert2_50</title>
<polygon fill="#ffe6e6" stroke="black" points="14212.5,-1388 13991.5,-1388 13991.5,-1320 14212.5,-1320 14212.5,-1388"/>
<text text-anchor="middle" x="14102" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 50</text>
<text text-anchor="middle" x="14102" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14102" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="14102" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;115</text>
</g>
<!-- router2&#45;&gt;expert2_50 -->
<g id="edge183" class="edge">
<title>router2&#45;&gt;expert2_50</title>
<path fill="none" stroke="black" d="M8881.66,-1479.49C9623.64,-1479.31 14024.14,-1476.56 14078,-1436 14089.78,-1427.13 14096.01,-1412.72 14099.23,-1398.5"/>
<polygon fill="black" stroke="black" points="14102.75,-1398.72 14101.08,-1388.26 14095.86,-1397.48 14102.75,-1398.72"/>
<text text-anchor="middle" x="14226.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 50</text>
<text text-anchor="middle" x="14226.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_51 -->
<g id="node123" class="node">
<title>expert2_51</title>
<polygon fill="#ffe6e6" stroke="black" points="14494.5,-1388 14273.5,-1388 14273.5,-1320 14494.5,-1320 14494.5,-1388"/>
<text text-anchor="middle" x="14384" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 51</text>
<text text-anchor="middle" x="14384" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14384" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="14384" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;116</text>
</g>
<!-- router2&#45;&gt;expert2_51 -->
<g id="edge184" class="edge">
<title>router2&#45;&gt;expert2_51</title>
<path fill="none" stroke="black" d="M8881.72,-1479.53C9646.46,-1479.68 14303.13,-1478.81 14360,-1436 14371.79,-1427.13 14378.02,-1412.72 14381.24,-1398.5"/>
<polygon fill="black" stroke="black" points="14384.75,-1398.72 14383.08,-1388.26 14377.86,-1397.48 14384.75,-1398.72"/>
<text text-anchor="middle" x="14508.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 51</text>
<text text-anchor="middle" x="14508.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_52 -->
<g id="node124" class="node">
<title>expert2_52</title>
<polygon fill="#ffe6e6" stroke="black" points="14776.5,-1388 14555.5,-1388 14555.5,-1320 14776.5,-1320 14776.5,-1388"/>
<text text-anchor="middle" x="14666" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 52</text>
<text text-anchor="middle" x="14666" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14666" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="14666" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;117</text>
</g>
<!-- router2&#45;&gt;expert2_52 -->
<g id="edge185" class="edge">
<title>router2&#45;&gt;expert2_52</title>
<path fill="none" stroke="black" d="M8881.67,-1479.57C9668.27,-1480.03 14582.11,-1481.06 14642,-1436 14653.79,-1427.13 14660.02,-1412.73 14663.24,-1398.5"/>
<polygon fill="black" stroke="black" points="14666.75,-1398.73 14665.09,-1388.26 14659.87,-1397.48 14666.75,-1398.73"/>
<text text-anchor="middle" x="14790.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 52</text>
<text text-anchor="middle" x="14790.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_53 -->
<g id="node125" class="node">
<title>expert2_53</title>
<polygon fill="#ffe6e6" stroke="black" points="15058.5,-1388 14837.5,-1388 14837.5,-1320 15058.5,-1320 15058.5,-1388"/>
<text text-anchor="middle" x="14948" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 53</text>
<text text-anchor="middle" x="14948" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14948" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="14948" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;118</text>
</g>
<!-- router2&#45;&gt;expert2_53 -->
<g id="edge186" class="edge">
<title>router2&#45;&gt;expert2_53</title>
<path fill="none" stroke="black" d="M8881.56,-1479.61C9689.27,-1480.36 14861.09,-1483.32 14924,-1436 14935.79,-1427.13 14942.02,-1412.73 14945.24,-1398.51"/>
<polygon fill="black" stroke="black" points="14948.76,-1398.73 14947.09,-1388.27 14941.87,-1397.49 14948.76,-1398.73"/>
<text text-anchor="middle" x="15072.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 53</text>
<text text-anchor="middle" x="15072.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_54 -->
<g id="node126" class="node">
<title>expert2_54</title>
<polygon fill="#ffe6e6" stroke="black" points="15340.5,-1388 15119.5,-1388 15119.5,-1320 15340.5,-1320 15340.5,-1388"/>
<text text-anchor="middle" x="15230" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 54</text>
<text text-anchor="middle" x="15230" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15230" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="15230" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;119</text>
</g>
<!-- router2&#45;&gt;expert2_54 -->
<g id="edge187" class="edge">
<title>router2&#45;&gt;expert2_54</title>
<path fill="none" stroke="black" d="M8881.75,-1479.65C9711.09,-1480.68 15140.08,-1485.57 15206,-1436 15217.79,-1427.13 15224.02,-1412.73 15227.24,-1398.51"/>
<polygon fill="black" stroke="black" points="15230.76,-1398.73 15229.09,-1388.27 15223.87,-1397.49 15230.76,-1398.73"/>
<text text-anchor="middle" x="15354.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 54</text>
<text text-anchor="middle" x="15354.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_55 -->
<g id="node127" class="node">
<title>expert2_55</title>
<polygon fill="#ffe6e6" stroke="black" points="15622.5,-1388 15401.5,-1388 15401.5,-1320 15622.5,-1320 15622.5,-1388"/>
<text text-anchor="middle" x="15512" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 55</text>
<text text-anchor="middle" x="15512" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15512" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="15512" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;120</text>
</g>
<!-- router2&#45;&gt;expert2_55 -->
<g id="edge188" class="edge">
<title>router2&#45;&gt;expert2_55</title>
<path fill="none" stroke="black" d="M8881.53,-1479.24C9733.24,-1477.12 15453.52,-1461.92 15488,-1436 15499.79,-1427.14 15506.02,-1412.73 15509.24,-1398.51"/>
<polygon fill="black" stroke="black" points="15512.76,-1398.73 15511.09,-1388.27 15505.87,-1397.49 15512.76,-1398.73"/>
<text text-anchor="middle" x="15636.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 55</text>
<text text-anchor="middle" x="15636.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_56 -->
<g id="node128" class="node">
<title>expert2_56</title>
<polygon fill="#ffe6e6" stroke="black" points="15904.5,-1388 15683.5,-1388 15683.5,-1320 15904.5,-1320 15904.5,-1388"/>
<text text-anchor="middle" x="15794" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 56</text>
<text text-anchor="middle" x="15794" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15794" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="15794" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;121</text>
</g>
<!-- router2&#45;&gt;expert2_56 -->
<g id="edge189" class="edge">
<title>router2&#45;&gt;expert2_56</title>
<path fill="none" stroke="black" d="M8881.79,-1479.27C9754.57,-1477.33 15734.01,-1463.05 15770,-1436 15781.79,-1427.14 15788.02,-1412.73 15791.24,-1398.51"/>
<polygon fill="black" stroke="black" points="15794.76,-1398.73 15793.09,-1388.27 15787.87,-1397.49 15794.76,-1398.73"/>
<text text-anchor="middle" x="15918.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 56</text>
<text text-anchor="middle" x="15918.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_57 -->
<g id="node129" class="node">
<title>expert2_57</title>
<polygon fill="#ffe6e6" stroke="black" points="16186.5,-1388 15965.5,-1388 15965.5,-1320 16186.5,-1320 16186.5,-1388"/>
<text text-anchor="middle" x="16076" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 57</text>
<text text-anchor="middle" x="16076" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16076" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="16076" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;122</text>
</g>
<!-- router2&#45;&gt;expert2_57 -->
<g id="edge190" class="edge">
<title>router2&#45;&gt;expert2_57</title>
<path fill="none" stroke="black" d="M8881.79,-1479.3C9774.35,-1477.53 16014.49,-1464.18 16052,-1436 16063.79,-1427.14 16070.03,-1412.74 16073.24,-1398.51"/>
<polygon fill="black" stroke="black" points="16076.76,-1398.73 16075.09,-1388.27 16069.87,-1397.49 16076.76,-1398.73"/>
<text text-anchor="middle" x="16200.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 57</text>
<text text-anchor="middle" x="16200.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_58 -->
<g id="node130" class="node">
<title>expert2_58</title>
<polygon fill="#ffe6e6" stroke="black" points="16468.5,-1388 16247.5,-1388 16247.5,-1320 16468.5,-1320 16468.5,-1388"/>
<text text-anchor="middle" x="16358" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 58</text>
<text text-anchor="middle" x="16358" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16358" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="16358" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;123</text>
</g>
<!-- router2&#45;&gt;expert2_58 -->
<g id="edge191" class="edge">
<title>router2&#45;&gt;expert2_58</title>
<path fill="none" stroke="black" d="M8881.54,-1479.32C9792.58,-1477.73 16294.97,-1465.31 16334,-1436 16345.8,-1427.14 16352.03,-1412.74 16355.25,-1398.52"/>
<polygon fill="black" stroke="black" points="16358.76,-1398.74 16357.09,-1388.27 16351.87,-1397.49 16358.76,-1398.74"/>
<text text-anchor="middle" x="16482.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 58</text>
<text text-anchor="middle" x="16482.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_59 -->
<g id="node131" class="node">
<title>expert2_59</title>
<polygon fill="#ffe6e6" stroke="black" points="16750.5,-1388 16529.5,-1388 16529.5,-1320 16750.5,-1320 16750.5,-1388"/>
<text text-anchor="middle" x="16640" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 59</text>
<text text-anchor="middle" x="16640" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16640" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="16640" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;124</text>
</g>
<!-- router2&#45;&gt;expert2_59 -->
<g id="edge192" class="edge">
<title>router2&#45;&gt;expert2_59</title>
<path fill="none" stroke="black" d="M8881.79,-1479.34C9812.79,-1477.91 16575.46,-1466.44 16616,-1436 16627.8,-1427.14 16634.03,-1412.74 16637.25,-1398.52"/>
<polygon fill="black" stroke="black" points="16640.76,-1398.74 16639.09,-1388.27 16633.87,-1397.49 16640.76,-1398.74"/>
<text text-anchor="middle" x="16764.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 59</text>
<text text-anchor="middle" x="16764.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_60 -->
<g id="node132" class="node">
<title>expert2_60</title>
<polygon fill="#ffe6e6" stroke="black" points="17032.5,-1388 16811.5,-1388 16811.5,-1320 17032.5,-1320 17032.5,-1388"/>
<text text-anchor="middle" x="16922" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 60</text>
<text text-anchor="middle" x="16922" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16922" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="16922" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;125</text>
</g>
<!-- router2&#45;&gt;expert2_60 -->
<g id="edge193" class="edge">
<title>router2&#45;&gt;expert2_60</title>
<path fill="none" stroke="black" d="M8881.83,-1479.36C9831.7,-1478.09 16855.95,-1467.58 16898,-1436 16909.8,-1427.14 16916.03,-1412.74 16919.25,-1398.52"/>
<polygon fill="black" stroke="black" points="16922.76,-1398.74 16921.1,-1388.28 16915.88,-1397.5 16922.76,-1398.74"/>
<text text-anchor="middle" x="17046.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 60</text>
<text text-anchor="middle" x="17046.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_61 -->
<g id="node133" class="node">
<title>expert2_61</title>
<polygon fill="#ffe6e6" stroke="black" points="17314.5,-1388 17093.5,-1388 17093.5,-1320 17314.5,-1320 17314.5,-1388"/>
<text text-anchor="middle" x="17204" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 61</text>
<text text-anchor="middle" x="17204" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17204" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="17204" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;126</text>
</g>
<!-- router2&#45;&gt;expert2_61 -->
<g id="edge194" class="edge">
<title>router2&#45;&gt;expert2_61</title>
<path fill="none" stroke="black" d="M8881.68,-1479.38C9849.31,-1478.26 17136.43,-1468.71 17180,-1436 17191.8,-1427.14 17198.03,-1412.74 17201.25,-1398.52"/>
<polygon fill="black" stroke="black" points="17204.77,-1398.74 17203.1,-1388.28 17197.88,-1397.5 17204.77,-1398.74"/>
<text text-anchor="middle" x="17328.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 61</text>
<text text-anchor="middle" x="17328.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_62 -->
<g id="node134" class="node">
<title>expert2_62</title>
<polygon fill="#ffe6e6" stroke="black" points="17596.5,-1388 17375.5,-1388 17375.5,-1320 17596.5,-1320 17596.5,-1388"/>
<text text-anchor="middle" x="17486" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 62</text>
<text text-anchor="middle" x="17486" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17486" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="17486" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;127</text>
</g>
<!-- router2&#45;&gt;expert2_62 -->
<g id="edge195" class="edge">
<title>router2&#45;&gt;expert2_62</title>
<path fill="none" stroke="black" d="M8881.72,-1479.4C9867.59,-1478.42 17416.91,-1469.85 17462,-1436 17473.8,-1427.14 17480.03,-1412.74 17483.25,-1398.52"/>
<polygon fill="black" stroke="black" points="17486.77,-1398.74 17485.1,-1388.28 17479.88,-1397.5 17486.77,-1398.74"/>
<text text-anchor="middle" x="17610.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 62</text>
<text text-anchor="middle" x="17610.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert2_63 -->
<g id="node135" class="node">
<title>expert2_63</title>
<polygon fill="#ffe6e6" stroke="black" points="17878.5,-1388 17657.5,-1388 17657.5,-1320 17878.5,-1320 17878.5,-1388"/>
<text text-anchor="middle" x="17768" y="-1372.8" font-family="Times,serif" font-size="14.00">Expert 63</text>
<text text-anchor="middle" x="17768" y="-1357.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17768" y="-1342.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="17768" y="-1327.8" font-family="Times,serif" font-size="14.00">GPU&#45;128</text>
</g>
<!-- router2&#45;&gt;expert2_63 -->
<g id="edge196" class="edge">
<title>router2&#45;&gt;expert2_63</title>
<path fill="none" stroke="black" d="M8881.6,-1479.42C9884.69,-1478.59 17697.39,-1470.98 17744,-1436 17755.8,-1427.14 17762.03,-1412.74 17765.25,-1398.52"/>
<polygon fill="black" stroke="black" points="17768.77,-1398.74 17767.1,-1388.28 17761.88,-1397.5 17768.77,-1398.74"/>
<text text-anchor="middle" x="17892.5" y="-1424.8" font-family="Times,serif" font-size="14.00">tokens for expert 63</text>
<text text-anchor="middle" x="17892.5" y="-1409.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- agg2 -->
<g id="node136" class="node">
<title>agg2</title>
<polygon fill="#ffe6e6" stroke="black" points="9005,-1254 8787,-1254 8787,-1201 9005,-1201 9005,-1254"/>
<text text-anchor="middle" x="8896" y="-1238.8" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8896" y="-1223.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, hidden_size]</text>
<text text-anchor="middle" x="8896" y="-1208.8" font-family="Times,serif" font-size="14.00">GPU&#45;65</text>
</g>
<!-- expert2_0&#45;&gt;agg2 -->
<g id="edge197" class="edge">
<title>expert2_0&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M248.64,-1341.09C430.29,-1322.16 803.19,-1285.93 1120,-1272 1915.99,-1237 7856.42,-1229.56 8776.45,-1228.61"/>
<polygon fill="black" stroke="black" points="8776.72,-1232.11 8786.71,-1228.6 8776.71,-1225.11 8776.72,-1232.11"/>
<text text-anchor="middle" x="1218.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 0</text>
<text text-anchor="middle" x="1218.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_1&#45;&gt;agg2 -->
<g id="edge198" class="edge">
<title>expert2_1&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M1107.72,-1333.07C1224.1,-1313.18 1412.72,-1283.91 1577,-1272 1950.98,-1244.89 7859.1,-1230.79 8776.65,-1228.76"/>
<polygon fill="black" stroke="black" points="8776.9,-1232.26 8786.89,-1228.73 8776.88,-1225.26 8776.9,-1232.26"/>
<text text-anchor="middle" x="1675.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 1</text>
<text text-anchor="middle" x="1675.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_2&#45;&gt;agg2 -->
<g id="edge199" class="edge">
<title>expert2_2&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M1656.84,-1325.58C1740.18,-1306.4 1857.48,-1282.41 1962,-1272 2314.66,-1236.87 7887.08,-1229.56 8776.67,-1228.62"/>
<polygon fill="black" stroke="black" points="8776.92,-1232.12 8786.92,-1228.61 8776.92,-1225.12 8776.92,-1232.12"/>
<text text-anchor="middle" x="2060.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 2</text>
<text text-anchor="middle" x="2060.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_3&#45;&gt;agg2 -->
<g id="edge200" class="edge">
<title>expert2_3&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M2050.75,-1324.58C2130.56,-1305.57 2241.16,-1282.24 2340,-1272 2672.42,-1237.57 7914.34,-1229.7 8776.44,-1228.64"/>
<polygon fill="black" stroke="black" points="8776.68,-1232.14 8786.68,-1228.62 8776.68,-1225.14 8776.68,-1232.14"/>
<text text-anchor="middle" x="2438.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 3</text>
<text text-anchor="middle" x="2438.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_4&#45;&gt;agg2 -->
<g id="edge201" class="edge">
<title>expert2_4&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M2367.6,-1329.13C2383.8,-1325.9 2400.31,-1322.75 2416,-1320 2471.28,-1310.29 2485.59,-1310.93 2541,-1302 2615.88,-1289.93 2633.47,-1278.96 2709,-1272 3022.23,-1243.14 7943.57,-1230.67 8776.64,-1228.76"/>
<polygon fill="black" stroke="black" points="8776.85,-1232.26 8786.85,-1228.74 8776.84,-1225.26 8776.85,-1232.26"/>
<text text-anchor="middle" x="2807.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 4</text>
<text text-anchor="middle" x="2807.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_5&#45;&gt;agg2 -->
<g id="edge202" class="edge">
<title>expert2_5&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M2645.84,-1325.05C2655.33,-1323.15 2664.81,-1321.43 2674,-1320 2777.94,-1303.8 2806.78,-1322.29 2910,-1302 2952.62,-1293.62 2960.12,-1278.91 3003,-1272 3298.09,-1224.47 7966.09,-1227.47 8776.52,-1228.35"/>
<polygon fill="black" stroke="black" points="8776.74,-1231.85 8786.74,-1228.36 8776.75,-1224.85 8776.74,-1231.85"/>
<text text-anchor="middle" x="3101.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 5</text>
<text text-anchor="middle" x="3101.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_6&#45;&gt;agg2 -->
<g id="edge203" class="edge">
<title>expert2_6&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M2903.7,-1323.44C2910.21,-1322.16 2916.67,-1321 2923,-1320 3046.62,-1300.52 3083.66,-1336.33 3204,-1302 3231.15,-1294.25 3232.64,-1278.98 3260,-1272 3398.4,-1236.69 7975.52,-1229.6 8776.87,-1228.63"/>
<polygon fill="black" stroke="black" points="8776.98,-1232.13 8786.98,-1228.62 8776.97,-1225.13 8776.98,-1232.13"/>
<text text-anchor="middle" x="3358.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 6</text>
<text text-anchor="middle" x="3358.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_7&#45;&gt;agg2 -->
<g id="edge204" class="edge">
<title>expert2_7&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M3152.51,-1322.59C3157.39,-1321.64 3162.24,-1320.77 3167,-1320 3231.62,-1309.6 3399.85,-1325.35 3461,-1302 3481.1,-1294.32 3478.7,-1279.14 3499,-1272 3627.74,-1226.72 7994.19,-1227.83 8776.59,-1228.39"/>
<polygon fill="black" stroke="black" points="8776.74,-1231.89 8786.74,-1228.4 8776.75,-1224.89 8776.74,-1231.89"/>
<text text-anchor="middle" x="3597.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 7</text>
<text text-anchor="middle" x="3597.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_8&#45;&gt;agg2 -->
<g id="edge205" class="edge">
<title>expert2_8&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M3396.5,-1322.06C3400.37,-1321.31 3404.21,-1320.62 3408,-1320 3472.15,-1309.46 3641.2,-1329.73 3700,-1302 3716.5,-1294.22 3711.3,-1279.34 3728,-1272 3787.72,-1245.75 8007.61,-1231.28 8776.48,-1228.86"/>
<polygon fill="black" stroke="black" points="8776.74,-1232.36 8786.73,-1228.83 8776.72,-1225.36 8776.74,-1232.36"/>
<text text-anchor="middle" x="3826.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 8</text>
<text text-anchor="middle" x="3826.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_9&#45;&gt;agg2 -->
<g id="edge206" class="edge">
<title>expert2_9&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M3637.58,-1321.88C3641.08,-1321.2 3644.56,-1320.57 3648,-1320 3709.72,-1309.72 3873.8,-1331.47 3929,-1302 3943.82,-1294.09 3936.97,-1279.5 3952,-1272 4007.72,-1244.2 8027.64,-1231.05 8776.59,-1228.84"/>
<polygon fill="black" stroke="black" points="8776.85,-1232.34 8786.84,-1228.81 8776.83,-1225.34 8776.85,-1232.34"/>
<text text-anchor="middle" x="4050.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 9</text>
<text text-anchor="middle" x="4050.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_10&#45;&gt;agg2 -->
<g id="edge207" class="edge">
<title>expert2_10&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M3877.58,-1321.9C3881.09,-1321.21 3884.56,-1320.58 3888,-1320 3946.2,-1310.19 4101.93,-1331.6 4153,-1302 4166.86,-1293.96 4158.91,-1279.63 4173,-1272 4225.19,-1243.76 8047.86,-1231.02 8776.69,-1228.84"/>
<polygon fill="black" stroke="black" points="8776.95,-1232.34 8786.94,-1228.81 8776.93,-1225.34 8776.95,-1232.34"/>
<text text-anchor="middle" x="4271.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 10</text>
<text text-anchor="middle" x="4271.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_11&#45;&gt;agg2 -->
<g id="edge208" class="edge">
<title>expert2_11&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M4117.65,-1321.73C4120.79,-1321.11 4123.91,-1320.53 4127,-1320 4181.24,-1310.66 4326.45,-1329.72 4374,-1302 4387.84,-1293.93 4379.91,-1279.63 4394,-1272 4443.61,-1245.14 8068.09,-1231.34 8776.64,-1228.9"/>
<polygon fill="black" stroke="black" points="8776.87,-1232.4 8786.86,-1228.86 8776.85,-1225.4 8776.87,-1232.4"/>
<text text-anchor="middle" x="4492.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 11</text>
<text text-anchor="middle" x="4492.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_12&#45;&gt;agg2 -->
<g id="edge209" class="edge">
<title>expert2_12&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M4356.65,-1321.75C4359.79,-1321.13 4362.91,-1320.54 4366,-1320 4416.28,-1311.19 4551.28,-1328.35 4595,-1302 4608.52,-1293.85 4600.21,-1279.68 4614,-1272 4660.74,-1245.96 8089.1,-1231.57 8776.7,-1228.94"/>
<polygon fill="black" stroke="black" points="8776.89,-1232.44 8786.87,-1228.9 8776.86,-1225.44 8776.89,-1232.44"/>
<text text-anchor="middle" x="4712.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 12</text>
<text text-anchor="middle" x="4712.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_13&#45;&gt;agg2 -->
<g id="edge210" class="edge">
<title>expert2_13&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M4595.65,-1321.78C4598.8,-1321.15 4601.92,-1320.55 4605,-1320 4651.11,-1311.76 4774.97,-1326.32 4815,-1302 4828.49,-1293.81 4820.21,-1279.68 4834,-1272 4922.34,-1222.76 8115.26,-1226.84 8776.78,-1228.22"/>
<polygon fill="black" stroke="black" points="8776.79,-1231.72 8786.8,-1228.24 8776.81,-1224.72 8776.79,-1231.72"/>
<text text-anchor="middle" x="4932.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 13</text>
<text text-anchor="middle" x="4932.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_14&#45;&gt;agg2 -->
<g id="edge211" class="edge">
<title>expert2_14&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M4834.66,-1321.81C4837.8,-1321.17 4840.92,-1320.56 4844,-1320 4885.93,-1312.32 4998.66,-1324.29 5035,-1302 5048.45,-1293.75 5040.22,-1279.69 5054,-1272 5137.26,-1225.56 8137.28,-1227.38 8776.84,-1228.29"/>
<polygon fill="black" stroke="black" points="8776.99,-1231.79 8787,-1228.31 8777,-1224.79 8776.99,-1231.79"/>
<text text-anchor="middle" x="5152.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 14</text>
<text text-anchor="middle" x="5152.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_15&#45;&gt;agg2 -->
<g id="edge212" class="edge">
<title>expert2_15&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M5073.67,-1321.86C5076.81,-1321.2 5079.92,-1320.58 5083,-1320 5120.77,-1312.88 5222.34,-1322.26 5255,-1302 5268.41,-1293.68 5260.22,-1279.69 5274,-1272 5352.17,-1228.36 8158.62,-1227.94 8776.48,-1228.38"/>
<polygon fill="black" stroke="black" points="8776.74,-1231.88 8786.74,-1228.39 8776.74,-1224.88 8776.74,-1231.88"/>
<text text-anchor="middle" x="5372.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 15</text>
<text text-anchor="middle" x="5372.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_16&#45;&gt;agg2 -->
<g id="edge213" class="edge">
<title>expert2_16&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M5312.68,-1321.91C5315.81,-1321.24 5318.93,-1320.6 5322,-1320 5355.6,-1313.44 5446.03,-1320.23 5475,-1302 5488.36,-1293.59 5480.22,-1279.7 5494,-1272 5567.11,-1231.15 8182.02,-1228.54 8776.56,-1228.47"/>
<polygon fill="black" stroke="black" points="8776.87,-1231.97 8786.87,-1228.47 8776.87,-1224.97 8776.87,-1231.97"/>
<text text-anchor="middle" x="5592.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 16</text>
<text text-anchor="middle" x="5592.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_17&#45;&gt;agg2 -->
<g id="edge214" class="edge">
<title>expert2_17&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M5551.69,-1321.98C5554.82,-1321.29 5557.93,-1320.63 5561,-1320 5619.88,-1308.01 5644.41,-1334.42 5695,-1302 5708.29,-1293.48 5700.23,-1279.7 5714,-1272 5782.05,-1233.94 8205.6,-1229.18 8776.45,-1228.58"/>
<polygon fill="black" stroke="black" points="8776.76,-1232.08 8786.75,-1228.57 8776.75,-1225.08 8776.76,-1232.08"/>
<text text-anchor="middle" x="5812.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 17</text>
<text text-anchor="middle" x="5812.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_18&#45;&gt;agg2 -->
<g id="edge215" class="edge">
<title>expert2_18&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M5790.71,-1322.06C5793.84,-1321.35 5796.94,-1320.66 5800,-1320 5850.58,-1309.12 5871.75,-1330.38 5915,-1302 5928.2,-1293.34 5920.23,-1279.71 5934,-1272 5997.02,-1236.71 8231.18,-1229.86 8776.74,-1228.71"/>
<polygon fill="black" stroke="black" points="8777,-1232.21 8786.99,-1228.69 8776.98,-1225.21 8777,-1232.21"/>
<text text-anchor="middle" x="6032.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 18</text>
<text text-anchor="middle" x="6032.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_19&#45;&gt;agg2 -->
<g id="edge216" class="edge">
<title>expert2_19&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M6029.74,-1322.19C6032.86,-1321.44 6035.95,-1320.7 6039,-1320 6081.3,-1310.24 6099.07,-1326.36 6135,-1302 6148.06,-1293.14 6140.23,-1279.72 6154,-1272 6211.98,-1239.49 8256.75,-1230.59 8776.7,-1228.86"/>
<polygon fill="black" stroke="black" points="8776.86,-1232.35 8786.85,-1228.82 8776.83,-1225.35 8776.86,-1232.35"/>
<text text-anchor="middle" x="6252.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 19</text>
<text text-anchor="middle" x="6252.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_20&#45;&gt;agg2 -->
<g id="edge217" class="edge">
<title>expert2_20&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M6268.78,-1322.37C6271.89,-1321.56 6274.96,-1320.77 6278,-1320 6312.06,-1311.34 6326.35,-1322.36 6355,-1302 6367.86,-1292.86 6360.24,-1279.73 6374,-1272 6426.96,-1242.26 8283.27,-1231.39 8776.61,-1229.03"/>
<polygon fill="black" stroke="black" points="8776.97,-1232.52 8786.96,-1228.98 8776.94,-1225.52 8776.97,-1232.52"/>
<text text-anchor="middle" x="6472.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 20</text>
<text text-anchor="middle" x="6472.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_21&#45;&gt;agg2 -->
<g id="edge218" class="edge">
<title>expert2_21&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M6507.72,-1322.09C6542.92,-1312.11 6573.31,-1303.27 6575,-1302 6587.63,-1292.54 6580.25,-1279.74 6594,-1272 6641.95,-1245.02 8311.34,-1232.26 8776.66,-1229.23"/>
<polygon fill="black" stroke="black" points="8776.79,-1232.73 8786.77,-1229.16 8776.74,-1225.73 8776.79,-1232.73"/>
<text text-anchor="middle" x="6692.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 21</text>
<text text-anchor="middle" x="6692.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_22&#45;&gt;agg2 -->
<g id="edge219" class="edge">
<title>expert2_22&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M6746.7,-1320.44C6770.51,-1312.82 6790.07,-1305.81 6795,-1302 6807.48,-1292.34 6800.25,-1279.75 6814,-1272 6856.97,-1247.76 8341.18,-1233.23 8776.9,-1229.47"/>
<polygon fill="black" stroke="black" points="8777.02,-1232.97 8786.99,-1229.39 8776.96,-1225.97 8777.02,-1232.97"/>
<text text-anchor="middle" x="6912.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 22</text>
<text text-anchor="middle" x="6912.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_23&#45;&gt;agg2 -->
<g id="edge220" class="edge">
<title>expert2_23&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M6985.77,-1320.69C6996.18,-1315.33 7006.13,-1309.14 7015,-1302 7027.29,-1292.1 7020.26,-1279.77 7034,-1272 7109.82,-1229.11 8377.65,-1227.61 8776.73,-1228.2"/>
<polygon fill="black" stroke="black" points="8776.85,-1231.7 8786.85,-1228.22 8776.86,-1224.7 8776.85,-1231.7"/>
<text text-anchor="middle" x="7132.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 23</text>
<text text-anchor="middle" x="7132.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_24&#45;&gt;agg2 -->
<g id="edge221" class="edge">
<title>expert2_24&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M7208.83,-1319.86C7218.16,-1314.63 7227.08,-1308.7 7235,-1302 7247.05,-1291.8 7240.28,-1279.79 7254,-1272 7319.93,-1234.57 8409.78,-1229.31 8776.6,-1228.6"/>
<polygon fill="black" stroke="black" points="8776.72,-1232.1 8786.72,-1228.58 8776.71,-1225.1 8776.72,-1232.1"/>
<text text-anchor="middle" x="7352.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 24</text>
<text text-anchor="middle" x="7352.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_25&#45;&gt;agg2 -->
<g id="edge222" class="edge">
<title>expert2_25&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M7430.58,-1319.97C7439.29,-1314.63 7447.66,-1308.64 7455,-1302 7466.71,-1291.42 7460.29,-1279.82 7474,-1272 7530.12,-1239.99 8444.72,-1231.24 8776.76,-1229.12"/>
<polygon fill="black" stroke="black" points="8776.91,-1232.62 8786.89,-1229.06 8776.87,-1225.62 8776.91,-1232.62"/>
<text text-anchor="middle" x="7572.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 25</text>
<text text-anchor="middle" x="7572.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_26&#45;&gt;agg2 -->
<g id="edge223" class="edge">
<title>expert2_26&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M7653.33,-1319.83C7661.05,-1314.39 7668.5,-1308.41 7675,-1302 7686.24,-1290.92 7680.31,-1279.86 7694,-1272 7740.36,-1245.38 8481.98,-1233.51 8776.65,-1229.83"/>
<polygon fill="black" stroke="black" points="8776.98,-1233.32 8786.94,-1229.7 8776.9,-1226.33 8776.98,-1233.32"/>
<text text-anchor="middle" x="7792.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 26</text>
<text text-anchor="middle" x="7792.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_27&#45;&gt;agg2 -->
<g id="edge224" class="edge">
<title>expert2_27&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M7876.42,-1319.96C7882.99,-1314.31 7889.4,-1308.24 7895,-1302 7905.54,-1290.25 7900.35,-1279.91 7914,-1272 7986.86,-1229.77 8531.18,-1226.8 8776.6,-1227.66"/>
<polygon fill="black" stroke="black" points="8776.62,-1231.16 8786.64,-1227.69 8776.65,-1224.16 8776.62,-1231.16"/>
<text text-anchor="middle" x="8012.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 27</text>
<text text-anchor="middle" x="8012.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_28&#45;&gt;agg2 -->
<g id="edge225" class="edge">
<title>expert2_28&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M8100.08,-1319.99C8105.18,-1314.09 8110.33,-1307.94 8115,-1302 8125.07,-1289.21 8121.78,-1279.93 8136,-1272 8190.39,-1241.68 8576.63,-1232.42 8776.61,-1229.65"/>
<polygon fill="black" stroke="black" points="8776.92,-1233.15 8786.87,-1229.51 8776.82,-1226.15 8776.92,-1233.15"/>
<text text-anchor="middle" x="8234.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 28</text>
<text text-anchor="middle" x="8234.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_29&#45;&gt;agg2 -->
<g id="edge226" class="edge">
<title>expert2_29&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M8325.19,-1319.84C8335.5,-1302.5 8350.58,-1282.71 8370,-1272 8404.67,-1252.88 8632.33,-1239.75 8776.55,-1233.23"/>
<polygon fill="black" stroke="black" points="8776.95,-1236.72 8786.79,-1232.78 8776.64,-1229.73 8776.95,-1236.72"/>
<text text-anchor="middle" x="8468.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 29</text>
<text text-anchor="middle" x="8468.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_30&#45;&gt;agg2 -->
<g id="edge227" class="edge">
<title>expert2_30&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M8561.13,-1319.97C8569.64,-1302.9 8582.45,-1283.32 8600,-1272 8629.02,-1253.28 8707.74,-1242.27 8776.71,-1236.01"/>
<polygon fill="black" stroke="black" points="8777.15,-1239.49 8786.81,-1235.12 8776.54,-1232.51 8777.15,-1239.49"/>
<text text-anchor="middle" x="8698.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 30</text>
<text text-anchor="middle" x="8698.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_31&#45;&gt;agg2 -->
<g id="edge228" class="edge">
<title>expert2_31&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M8794.05,-1319.87C8798.75,-1304 8806.27,-1285.54 8818,-1272 8821.68,-1267.75 8825.88,-1263.83 8830.38,-1260.24"/>
<polygon fill="black" stroke="black" points="8832.76,-1262.84 8838.76,-1254.11 8828.62,-1257.19 8832.76,-1262.84"/>
<text text-anchor="middle" x="8916.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 31</text>
<text text-anchor="middle" x="8916.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_32&#45;&gt;agg2 -->
<g id="edge229" class="edge">
<title>expert2_32&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M9040.62,-1319.83C9035.97,-1303.56 9028.1,-1284.77 9015,-1272 9010.13,-1267.26 9004.7,-1263.02 8998.92,-1259.25"/>
<polygon fill="black" stroke="black" points="9000.6,-1256.17 8990.23,-1254.03 8997,-1262.18 9000.6,-1256.17"/>
<text text-anchor="middle" x="9132.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 32</text>
<text text-anchor="middle" x="9132.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_33&#45;&gt;agg2 -->
<g id="edge230" class="edge">
<title>expert2_33&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M9292.84,-1319.68C9277.98,-1302.53 9257.66,-1282.96 9235,-1272 9197.16,-1253.7 9097.36,-1242.33 9015.77,-1235.83"/>
<polygon fill="black" stroke="black" points="9015.65,-1232.31 9005.41,-1235.02 9015.11,-1239.29 9015.65,-1232.31"/>
<text text-anchor="middle" x="9373.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 33</text>
<text text-anchor="middle" x="9373.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_34&#45;&gt;agg2 -->
<g id="edge231" class="edge">
<title>expert2_34&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M9557.36,-1319.8C9535.25,-1302.33 9505.84,-1282.43 9476,-1272 9393.91,-1243.31 9159.73,-1233.53 9015.27,-1230.21"/>
<polygon fill="black" stroke="black" points="9015.11,-1226.7 9005.03,-1229.98 9014.95,-1233.7 9015.11,-1226.7"/>
<text text-anchor="middle" x="9629.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 34</text>
<text text-anchor="middle" x="9629.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_35&#45;&gt;agg2 -->
<g id="edge232" class="edge">
<title>expert2_35&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M9828.83,-1319.96C9802.08,-1302.31 9766.72,-1282.18 9732,-1272 9601.26,-1233.67 9213.6,-1228.15 9015.48,-1227.94"/>
<polygon fill="black" stroke="black" points="9015.33,-1224.44 9005.32,-1227.94 9015.32,-1231.44 9015.33,-1224.44"/>
<text text-anchor="middle" x="9895.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 35</text>
<text text-anchor="middle" x="9895.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_36&#45;&gt;agg2 -->
<g id="edge233" class="edge">
<title>expert2_36&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M10104.62,-1319.8C10074.9,-1302.1 10035.81,-1281.97 9998,-1272 9905.12,-1247.5 9280.73,-1234.68 9015.17,-1230.28"/>
<polygon fill="black" stroke="black" points="9015.16,-1226.78 9005.1,-1230.12 9015.04,-1233.78 9015.16,-1226.78"/>
<text text-anchor="middle" x="10167.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 36</text>
<text text-anchor="middle" x="10167.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_37&#45;&gt;agg2 -->
<g id="edge234" class="edge">
<title>expert2_37&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M10382.88,-1319.9C10351.34,-1302.12 10309.84,-1281.87 10270,-1272 10150.25,-1242.34 9327.53,-1232.21 9015.58,-1229.42"/>
<polygon fill="black" stroke="black" points="9015.18,-1225.91 9005.15,-1229.32 9015.12,-1232.91 9015.18,-1225.91"/>
<text text-anchor="middle" x="10443.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 37</text>
<text text-anchor="middle" x="10443.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_38&#45;&gt;agg2 -->
<g id="edge235" class="edge">
<title>expert2_38&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M10662.83,-1319.82C10630.1,-1302.01 10587.1,-1281.76 10546,-1272 10398.61,-1236.99 9368.85,-1230.14 9015.04,-1228.81"/>
<polygon fill="black" stroke="black" points="9015.04,-1225.31 9005.02,-1228.78 9015.01,-1232.31 9015.04,-1225.31"/>
<text text-anchor="middle" x="10722.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 38</text>
<text text-anchor="middle" x="10722.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_39&#45;&gt;agg2 -->
<g id="edge236" class="edge">
<title>expert2_39&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M10944.2,-1319.97C10910.84,-1302.1 10866.91,-1281.72 10825,-1272 10649.63,-1231.31 9408.58,-1228.28 9015.26,-1228.36"/>
<polygon fill="black" stroke="black" points="9015,-1224.86 9005,-1228.36 9015,-1231.86 9015,-1224.86"/>
<text text-anchor="middle" x="11002.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 39</text>
<text text-anchor="middle" x="11002.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_40&#45;&gt;agg2 -->
<g id="edge237" class="edge">
<title>expert2_40&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M11225.52,-1319.93C11191.77,-1302.04 11147.34,-1281.66 11105,-1272 10901.38,-1225.52 9445.38,-1226.64 9015.32,-1228.01"/>
<polygon fill="black" stroke="black" points="9015.03,-1224.51 9005.04,-1228.04 9015.05,-1231.51 9015.03,-1224.51"/>
<text text-anchor="middle" x="11283.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 40</text>
<text text-anchor="middle" x="11283.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_41&#45;&gt;agg2 -->
<g id="edge238" class="edge">
<title>expert2_41&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M11507.19,-1319.89C11473.24,-1301.99 11428.56,-1281.62 11386,-1272 11269.41,-1245.65 9495.69,-1232.36 9015.24,-1229.23"/>
<polygon fill="black" stroke="black" points="9015.18,-1225.73 9005.16,-1229.17 9015.14,-1232.73 9015.18,-1225.73"/>
<text text-anchor="middle" x="11564.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 41</text>
<text text-anchor="middle" x="11564.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_42&#45;&gt;agg2 -->
<g id="edge239" class="edge">
<title>expert2_42&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M11788.85,-1319.87C11754.71,-1301.95 11709.77,-1281.58 11667,-1272 11536.08,-1242.68 9529.13,-1231.43 9015.17,-1229.02"/>
<polygon fill="black" stroke="black" points="9015.15,-1225.52 9005.14,-1228.97 9015.12,-1232.52 9015.15,-1225.52"/>
<text text-anchor="middle" x="11846.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 42</text>
<text text-anchor="middle" x="11846.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_43&#45;&gt;agg2 -->
<g id="edge240" class="edge">
<title>expert2_43&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M12070.86,-1319.84C12036.71,-1301.92 11991.78,-1281.55 11949,-1272 11803.69,-1239.57 9561.59,-1230.56 9015.32,-1228.84"/>
<polygon fill="black" stroke="black" points="9015.07,-1225.34 9005.05,-1228.81 9015.04,-1232.34 9015.07,-1225.34"/>
<text text-anchor="middle" x="12128.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 43</text>
<text text-anchor="middle" x="12128.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_44&#45;&gt;agg2 -->
<g id="edge241" class="edge">
<title>expert2_44&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M12352.86,-1319.82C12318.72,-1301.89 12273.78,-1281.52 12231,-1272 12071.25,-1236.45 9592.12,-1229.76 9015.28,-1228.69"/>
<polygon fill="black" stroke="black" points="9015.29,-1225.19 9005.28,-1228.67 9015.27,-1232.19 9015.29,-1225.19"/>
<text text-anchor="middle" x="12410.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 44</text>
<text text-anchor="middle" x="12410.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_45&#45;&gt;agg2 -->
<g id="edge242" class="edge">
<title>expert2_45&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M12634.87,-1319.81C12600.72,-1301.87 12555.79,-1281.5 12513,-1272 12338.78,-1233.32 9621.5,-1229.03 9015.29,-1228.56"/>
<polygon fill="black" stroke="black" points="9015.23,-1225.06 9005.22,-1228.55 9015.22,-1232.06 9015.23,-1225.06"/>
<text text-anchor="middle" x="12692.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 45</text>
<text text-anchor="middle" x="12692.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_46&#45;&gt;agg2 -->
<g id="edge243" class="edge">
<title>expert2_46&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M12916.87,-1319.79C12882.73,-1301.85 12837.79,-1281.48 12795,-1272 12606.26,-1230.18 9649.32,-1228.36 9015.16,-1228.45"/>
<polygon fill="black" stroke="black" points="9015.09,-1224.95 9005.09,-1228.45 9015.09,-1231.95 9015.09,-1224.95"/>
<text text-anchor="middle" x="12974.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 46</text>
<text text-anchor="middle" x="12974.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_47&#45;&gt;agg2 -->
<g id="edge244" class="edge">
<title>expert2_47&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M13199.27,-1319.99C13165.08,-1302 13119.96,-1281.5 13077,-1272 12873.72,-1227.04 9676.3,-1227.73 9015.09,-1228.36"/>
<polygon fill="black" stroke="black" points="9015.07,-1224.86 9005.07,-1228.37 9015.07,-1231.86 9015.07,-1224.86"/>
<text text-anchor="middle" x="13256.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 47</text>
<text text-anchor="middle" x="13256.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_48&#45;&gt;agg2 -->
<g id="edge245" class="edge">
<title>expert2_48&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M13481.27,-1319.98C13447.08,-1301.98 13401.97,-1281.49 13359,-1272 13141.17,-1223.9 9703.07,-1227.14 9015.23,-1228.27"/>
<polygon fill="black" stroke="black" points="9015.05,-1224.77 9005.06,-1228.29 9015.07,-1231.77 9015.05,-1224.77"/>
<text text-anchor="middle" x="13538.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 48</text>
<text text-anchor="middle" x="13538.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_49&#45;&gt;agg2 -->
<g id="edge246" class="edge">
<title>expert2_49&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M13763.27,-1319.97C13729.09,-1301.97 13683.97,-1281.48 13641,-1272 13524.62,-1246.34 9739.94,-1231.52 9015.28,-1228.92"/>
<polygon fill="black" stroke="black" points="9015.11,-1225.41 9005.09,-1228.88 9015.08,-1232.41 9015.11,-1225.41"/>
<text text-anchor="middle" x="13820.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 49</text>
<text text-anchor="middle" x="13820.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_50&#45;&gt;agg2 -->
<g id="edge247" class="edge">
<title>expert2_50&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M14045.28,-1319.96C14011.09,-1301.96 13965.97,-1281.46 13923,-1272 13799.32,-1244.76 9765.37,-1231.15 9015.37,-1228.85"/>
<polygon fill="black" stroke="black" points="9015.11,-1225.35 9005.1,-1228.82 9015.09,-1232.35 9015.11,-1225.35"/>
<text text-anchor="middle" x="14102.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 50</text>
<text text-anchor="middle" x="14102.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_51&#45;&gt;agg2 -->
<g id="edge248" class="edge">
<title>expert2_51&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M14327.28,-1319.96C14293.09,-1301.95 14247.97,-1281.46 14205,-1272 14073.99,-1243.18 9789.18,-1230.8 9015.21,-1228.8"/>
<polygon fill="black" stroke="black" points="9015.17,-1225.3 9005.16,-1228.77 9015.15,-1232.3 9015.17,-1225.3"/>
<text text-anchor="middle" x="14384.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 51</text>
<text text-anchor="middle" x="14384.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_52&#45;&gt;agg2 -->
<g id="edge249" class="edge">
<title>expert2_52&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M14609.28,-1319.95C14575.09,-1301.94 14529.98,-1281.45 14487,-1272 14348.66,-1241.59 9812.57,-1230.47 9015.11,-1228.74"/>
<polygon fill="black" stroke="black" points="9015.06,-1225.24 9005.05,-1228.72 9015.04,-1232.24 9015.06,-1225.24"/>
<text text-anchor="middle" x="14666.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 52</text>
<text text-anchor="middle" x="14666.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_53&#45;&gt;agg2 -->
<g id="edge250" class="edge">
<title>expert2_53&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M14891.28,-1319.94C14857.09,-1301.93 14811.98,-1281.44 14769,-1272 14623.33,-1240.01 9836.01,-1230.16 9015.18,-1228.7"/>
<polygon fill="black" stroke="black" points="9015.13,-1225.2 9005.12,-1228.68 9015.12,-1232.2 9015.13,-1225.2"/>
<text text-anchor="middle" x="14948.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 53</text>
<text text-anchor="middle" x="14948.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_54&#45;&gt;agg2 -->
<g id="edge251" class="edge">
<title>expert2_54&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M15173.28,-1319.94C15139.1,-1301.92 15093.98,-1281.43 15051,-1272 14897.99,-1238.43 9858.53,-1229.86 9015.16,-1228.66"/>
<polygon fill="black" stroke="black" points="9015.14,-1225.16 9005.13,-1228.64 9015.13,-1232.16 9015.14,-1225.16"/>
<text text-anchor="middle" x="15230.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 54</text>
<text text-anchor="middle" x="15230.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_55&#45;&gt;agg2 -->
<g id="edge252" class="edge">
<title>expert2_55&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M15455.28,-1319.93C15421.1,-1301.92 15375.98,-1281.42 15333,-1272 15172.65,-1236.84 9881.63,-1229.58 9015.4,-1228.62"/>
<polygon fill="black" stroke="black" points="9015.11,-1225.12 9005.11,-1228.61 9015.11,-1232.12 9015.11,-1225.12"/>
<text text-anchor="middle" x="15512.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 55</text>
<text text-anchor="middle" x="15512.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_56&#45;&gt;agg2 -->
<g id="edge253" class="edge">
<title>expert2_56&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M15737.28,-1319.93C15703.1,-1301.91 15657.98,-1281.42 15615,-1272 15447.29,-1235.25 9902.95,-1229.3 9015.32,-1228.59"/>
<polygon fill="black" stroke="black" points="9015.1,-1225.09 9005.1,-1228.58 9015.09,-1232.09 9015.1,-1225.09"/>
<text text-anchor="middle" x="15794.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 56</text>
<text text-anchor="middle" x="15794.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_57&#45;&gt;agg2 -->
<g id="edge254" class="edge">
<title>expert2_57&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M16019.28,-1319.92C15985.1,-1301.91 15939.98,-1281.41 15897,-1272 15721.93,-1233.66 9923.92,-1229.04 9015.27,-1228.55"/>
<polygon fill="black" stroke="black" points="9015.13,-1225.05 9005.13,-1228.55 9015.13,-1232.05 9015.13,-1225.05"/>
<text text-anchor="middle" x="16076.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 57</text>
<text text-anchor="middle" x="16076.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_58&#45;&gt;agg2 -->
<g id="edge255" class="edge">
<title>expert2_58&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M16301.29,-1319.92C16267.1,-1301.9 16221.98,-1281.41 16179,-1272 15996.56,-1232.07 9944.73,-1228.79 9015.28,-1228.52"/>
<polygon fill="black" stroke="black" points="9015.24,-1225.02 9005.24,-1228.52 9015.24,-1232.02 9015.24,-1225.02"/>
<text text-anchor="middle" x="16358.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 58</text>
<text text-anchor="middle" x="16358.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_59&#45;&gt;agg2 -->
<g id="edge256" class="edge">
<title>expert2_59&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M16583.29,-1319.92C16549.1,-1301.9 16503.99,-1281.4 16461,-1272 16271.19,-1230.48 9965.44,-1228.55 9015.36,-1228.5"/>
<polygon fill="black" stroke="black" points="9015.1,-1225 9005.1,-1228.5 9015.1,-1232 9015.1,-1225"/>
<text text-anchor="middle" x="16640.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 59</text>
<text text-anchor="middle" x="16640.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_60&#45;&gt;agg2 -->
<g id="edge257" class="edge">
<title>expert2_60&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M16865.29,-1319.91C16831.1,-1301.89 16785.99,-1281.4 16743,-1272 16545.81,-1228.89 9984.76,-1228.32 9015.21,-1228.47"/>
<polygon fill="black" stroke="black" points="9015.09,-1224.97 9005.09,-1228.47 9015.09,-1231.97 9015.09,-1224.97"/>
<text text-anchor="middle" x="16922.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 60</text>
<text text-anchor="middle" x="16922.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_61&#45;&gt;agg2 -->
<g id="edge258" class="edge">
<title>expert2_61&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M17147.29,-1319.91C17113.1,-1301.89 17067.99,-1281.39 17025,-1272 16820.45,-1227.3 10006.02,-1228.1 9015.57,-1228.45"/>
<polygon fill="black" stroke="black" points="9015.23,-1224.95 9005.23,-1228.45 9015.24,-1231.95 9015.23,-1224.95"/>
<text text-anchor="middle" x="17204.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 61</text>
<text text-anchor="middle" x="17204.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_62&#45;&gt;agg2 -->
<g id="edge259" class="edge">
<title>expert2_62&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M17429.29,-1319.91C17395.1,-1301.88 17349.99,-1281.39 17307,-1272 17095.04,-1225.7 10024.28,-1227.88 9015.34,-1228.43"/>
<polygon fill="black" stroke="black" points="9015.18,-1224.93 9005.18,-1228.43 9015.18,-1231.93 9015.18,-1224.93"/>
<text text-anchor="middle" x="17486.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 62</text>
<text text-anchor="middle" x="17486.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert2_63&#45;&gt;agg2 -->
<g id="edge260" class="edge">
<title>expert2_63&#45;&gt;agg2</title>
<path fill="none" stroke="black" d="M17711.29,-1319.9C17677.11,-1301.88 17631.99,-1281.39 17589,-1272 17369.67,-1224.11 10044.86,-1227.67 9015.68,-1228.4"/>
<polygon fill="black" stroke="black" points="9015.31,-1224.9 9005.32,-1228.41 9015.32,-1231.9 9015.31,-1224.9"/>
<text text-anchor="middle" x="17772.5" y="-1290.8" font-family="Times,serif" font-size="14.00">expert output 63</text>
<text text-anchor="middle" x="17772.5" y="-1275.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- pre_layer3_norm -->
<g id="node137" class="node">
<title>pre_layer3_norm</title>
<polygon fill="#e6ffe6" stroke="black" points="9005,-1143 8787,-1143 8787,-1090 9005,-1090 9005,-1143"/>
<text text-anchor="middle" x="8896" y="-1127.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8896" y="-1112.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, hidden_size]</text>
<text text-anchor="middle" x="8896" y="-1097.8" font-family="Times,serif" font-size="14.00">GPU&#45;129</text>
</g>
<!-- agg2&#45;&gt;pre_layer3_norm -->
<g id="edge523" class="edge">
<title>agg2&#45;&gt;pre_layer3_norm</title>
<path fill="none" stroke="black" d="M8896,-1200.94C8896,-1186.83 8896,-1169.08 8896,-1153.57"/>
<polygon fill="black" stroke="black" points="8899.5,-1153.27 8896,-1143.27 8892.5,-1153.27 8899.5,-1153.27"/>
</g>
<!-- pre_layer3_attn -->
<g id="node138" class="node">
<title>pre_layer3_attn</title>
<polygon fill="#e6ffe6" stroke="black" points="9005,-1053 8787,-1053 8787,-1000 9005,-1000 9005,-1053"/>
<text text-anchor="middle" x="8896" y="-1037.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="8896" y="-1022.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, hidden_size]</text>
<text text-anchor="middle" x="8896" y="-1007.8" font-family="Times,serif" font-size="14.00">GPU&#45;129</text>
</g>
<!-- pre_layer3_norm&#45;&gt;pre_layer3_attn -->
<g id="edge261" class="edge">
<title>pre_layer3_norm&#45;&gt;pre_layer3_attn</title>
<path fill="none" stroke="black" d="M8896,-1089.57C8896,-1081.34 8896,-1072.08 8896,-1063.28"/>
<polygon fill="black" stroke="black" points="8899.5,-1063.24 8896,-1053.24 8892.5,-1063.24 8899.5,-1063.24"/>
</g>
<!-- router3 -->
<g id="node139" class="node">
<title>router3</title>
<polygon fill="#e6ffe6" stroke="black" points="9001.5,-963 8790.5,-963 8790.5,-910 9001.5,-910 9001.5,-963"/>
<text text-anchor="middle" x="8896" y="-947.8" font-family="Times,serif" font-size="14.00">Router/Gating</text>
<text text-anchor="middle" x="8896" y="-932.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 64 experts]</text>
<text text-anchor="middle" x="8896" y="-917.8" font-family="Times,serif" font-size="14.00">GPU&#45;129</text>
</g>
<!-- pre_layer3_attn&#45;&gt;router3 -->
<g id="edge262" class="edge">
<title>pre_layer3_attn&#45;&gt;router3</title>
<path fill="none" stroke="black" d="M8896,-999.57C8896,-991.34 8896,-982.08 8896,-973.28"/>
<polygon fill="black" stroke="black" points="8899.5,-973.24 8896,-963.24 8892.5,-973.24 8899.5,-973.24"/>
</g>
<!-- expert3_0 -->
<g id="node140" class="node">
<title>expert3_0</title>
<polygon fill="#e6ffe6" stroke="black" points="283.5,-844 62.5,-844 62.5,-776 283.5,-776 283.5,-844"/>
<text text-anchor="middle" x="173" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="173" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="173" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="173" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;129</text>
</g>
<!-- router3&#45;&gt;expert3_0 -->
<g id="edge263" class="edge">
<title>router3&#45;&gt;expert3_0</title>
<path fill="none" stroke="black" d="M8790.27,-935.48C7798.26,-935.28 159.2,-932.4 119,-892 107.34,-880.28 112.47,-865.7 123.27,-852.14"/>
<polygon fill="black" stroke="black" points="126.19,-854.12 130.19,-844.31 120.95,-849.48 126.19,-854.12"/>
<text text-anchor="middle" x="248.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 0</text>
<text text-anchor="middle" x="248.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_1 -->
<g id="node141" class="node">
<title>expert3_1</title>
<polygon fill="#e6ffe6" stroke="black" points="540.5,-844 319.5,-844 319.5,-776 540.5,-776 540.5,-844"/>
<text text-anchor="middle" x="430" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="430" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="430" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="430" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;130</text>
</g>
<!-- router3&#45;&gt;expert3_1 -->
<g id="edge264" class="edge">
<title>router3&#45;&gt;expert3_1</title>
<path fill="none" stroke="black" d="M8790.49,-935.47C7816.57,-935.11 427.92,-931.12 389,-892 378.05,-880.99 381.6,-866.45 390.12,-852.74"/>
<polygon fill="black" stroke="black" points="393.12,-854.54 395.98,-844.34 387.38,-850.54 393.12,-854.54"/>
<text text-anchor="middle" x="518.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 1</text>
<text text-anchor="middle" x="518.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_2 -->
<g id="node142" class="node">
<title>expert3_2</title>
<polygon fill="#e6ffe6" stroke="black" points="788.5,-844 567.5,-844 567.5,-776 788.5,-776 788.5,-844"/>
<text text-anchor="middle" x="678" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="678" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="678" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="678" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;131</text>
</g>
<!-- router3&#45;&gt;expert3_2 -->
<g id="edge265" class="edge">
<title>router3&#45;&gt;expert3_2</title>
<path fill="none" stroke="black" d="M8790.13,-935.45C7832.4,-934.93 698.62,-929.82 661,-892 650.96,-881.9 651.24,-867.48 655.36,-853.6"/>
<polygon fill="black" stroke="black" points="658.67,-854.72 658.74,-844.13 652.08,-852.37 658.67,-854.72"/>
<text text-anchor="middle" x="790.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 2</text>
<text text-anchor="middle" x="790.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_3 -->
<g id="node143" class="node">
<title>expert3_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1032.5,-844 811.5,-844 811.5,-776 1032.5,-776 1032.5,-844"/>
<text text-anchor="middle" x="922" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="922" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="922" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="922" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;132</text>
</g>
<!-- router3&#45;&gt;expert3_3 -->
<g id="edge266" class="edge">
<title>router3&#45;&gt;expert3_3</title>
<path fill="none" stroke="black" d="M8790.16,-935.36C7851.39,-934.08 983.61,-923.6 943,-892 931.47,-883.03 925.76,-868.6 923.07,-854.39"/>
<polygon fill="black" stroke="black" points="926.49,-853.57 921.61,-844.16 919.56,-854.56 926.49,-853.57"/>
<text text-anchor="middle" x="1072.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 3</text>
<text text-anchor="middle" x="1072.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_4 -->
<g id="node144" class="node">
<title>expert3_4</title>
<polygon fill="#e6ffe6" stroke="black" points="1314.5,-844 1093.5,-844 1093.5,-776 1314.5,-776 1314.5,-844"/>
<text text-anchor="middle" x="1204" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1204" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="1204" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="1204" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;133</text>
</g>
<!-- router3&#45;&gt;expert3_4 -->
<g id="edge267" class="edge">
<title>router3&#45;&gt;expert3_4</title>
<path fill="none" stroke="black" d="M8790.32,-935.34C7871.08,-933.89 1264.11,-922.44 1225,-892 1213.47,-883.02 1207.76,-868.6 1205.07,-854.39"/>
<polygon fill="black" stroke="black" points="1208.49,-853.57 1203.61,-844.16 1201.56,-854.56 1208.49,-853.57"/>
<text text-anchor="middle" x="1354.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 4</text>
<text text-anchor="middle" x="1354.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_5 -->
<g id="node145" class="node">
<title>expert3_5</title>
<polygon fill="#e6ffe6" stroke="black" points="1596.5,-844 1375.5,-844 1375.5,-776 1596.5,-776 1596.5,-844"/>
<text text-anchor="middle" x="1486" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="1486" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="1486" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="1486" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;134</text>
</g>
<!-- router3&#45;&gt;expert3_5 -->
<g id="edge268" class="edge">
<title>router3&#45;&gt;expert3_5</title>
<path fill="none" stroke="black" d="M8790.34,-935.32C7890.41,-933.7 1544.62,-921.29 1507,-892 1495.47,-883.02 1489.76,-868.6 1487.07,-854.39"/>
<polygon fill="black" stroke="black" points="1490.49,-853.57 1485.61,-844.16 1483.56,-854.55 1490.49,-853.57"/>
<text text-anchor="middle" x="1636.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 5</text>
<text text-anchor="middle" x="1636.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_6 -->
<g id="node146" class="node">
<title>expert3_6</title>
<polygon fill="#e6ffe6" stroke="black" points="1878.5,-844 1657.5,-844 1657.5,-776 1878.5,-776 1878.5,-844"/>
<text text-anchor="middle" x="1768" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1768" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="1768" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="1768" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;135</text>
</g>
<!-- router3&#45;&gt;expert3_6 -->
<g id="edge269" class="edge">
<title>router3&#45;&gt;expert3_6</title>
<path fill="none" stroke="black" d="M8790.24,-935.29C7909.55,-933.5 1825.12,-920.13 1789,-892 1777.47,-883.02 1771.76,-868.59 1769.07,-854.39"/>
<polygon fill="black" stroke="black" points="1772.49,-853.56 1767.61,-844.16 1765.56,-854.55 1772.49,-853.56"/>
<text text-anchor="middle" x="1918.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 6</text>
<text text-anchor="middle" x="1918.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_7 -->
<g id="node147" class="node">
<title>expert3_7</title>
<polygon fill="#e6ffe6" stroke="black" points="2160.5,-844 1939.5,-844 1939.5,-776 2160.5,-776 2160.5,-844"/>
<text text-anchor="middle" x="2050" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2050" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="2050" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="2050" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;136</text>
</g>
<!-- router3&#45;&gt;expert3_7 -->
<g id="edge270" class="edge">
<title>router3&#45;&gt;expert3_7</title>
<path fill="none" stroke="black" d="M8790.39,-935.26C7930.25,-933.3 2105.63,-918.97 2071,-892 2059.47,-883.02 2053.76,-868.59 2051.08,-854.38"/>
<polygon fill="black" stroke="black" points="2054.49,-853.56 2049.61,-844.16 2047.56,-854.55 2054.49,-853.56"/>
<text text-anchor="middle" x="2200.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 7</text>
<text text-anchor="middle" x="2200.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_8 -->
<g id="node148" class="node">
<title>expert3_8</title>
<polygon fill="#e6ffe6" stroke="black" points="2442.5,-844 2221.5,-844 2221.5,-776 2442.5,-776 2442.5,-844"/>
<text text-anchor="middle" x="2332" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="2332" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="2332" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="2332" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;137</text>
</g>
<!-- router3&#45;&gt;expert3_8 -->
<g id="edge271" class="edge">
<title>router3&#45;&gt;expert3_8</title>
<path fill="none" stroke="black" d="M8790.47,-935.24C7951.04,-933.08 2386.14,-917.82 2353,-892 2341.47,-883.02 2335.76,-868.59 2333.08,-854.38"/>
<polygon fill="black" stroke="black" points="2336.5,-853.56 2331.62,-844.16 2329.57,-854.55 2336.5,-853.56"/>
<text text-anchor="middle" x="2482.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 8</text>
<text text-anchor="middle" x="2482.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_9 -->
<g id="node149" class="node">
<title>expert3_9</title>
<polygon fill="#e6ffe6" stroke="black" points="2724.5,-844 2503.5,-844 2503.5,-776 2724.5,-776 2724.5,-844"/>
<text text-anchor="middle" x="2614" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="2614" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="2614" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="2614" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;138</text>
</g>
<!-- router3&#45;&gt;expert3_9 -->
<g id="edge272" class="edge">
<title>router3&#45;&gt;expert3_9</title>
<path fill="none" stroke="black" d="M8790.44,-935.64C7974.19,-936.66 2698.28,-941.32 2635,-892 2623.47,-883.02 2617.76,-868.59 2615.08,-854.38"/>
<polygon fill="black" stroke="black" points="2618.5,-853.56 2613.62,-844.15 2611.57,-854.55 2618.5,-853.56"/>
<text text-anchor="middle" x="2764.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 9</text>
<text text-anchor="middle" x="2764.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_10 -->
<g id="node150" class="node">
<title>expert3_10</title>
<polygon fill="#e6ffe6" stroke="black" points="3006.5,-844 2785.5,-844 2785.5,-776 3006.5,-776 3006.5,-844"/>
<text text-anchor="middle" x="2896" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="2896" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="2896" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="2896" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;139</text>
</g>
<!-- router3&#45;&gt;expert3_10 -->
<g id="edge273" class="edge">
<title>router3&#45;&gt;expert3_10</title>
<path fill="none" stroke="black" d="M8790.19,-935.61C7994.39,-936.33 2977.3,-939.01 2917,-892 2905.48,-883.02 2899.77,-868.59 2897.08,-854.38"/>
<polygon fill="black" stroke="black" points="2900.5,-853.56 2895.62,-844.15 2893.57,-854.55 2900.5,-853.56"/>
<text text-anchor="middle" x="3046.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 10</text>
<text text-anchor="middle" x="3046.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_11 -->
<g id="node151" class="node">
<title>expert3_11</title>
<polygon fill="#e6ffe6" stroke="black" points="3288.5,-844 3067.5,-844 3067.5,-776 3288.5,-776 3288.5,-844"/>
<text text-anchor="middle" x="3178" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="3178" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="3178" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="3178" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;140</text>
</g>
<!-- router3&#45;&gt;expert3_11 -->
<g id="edge274" class="edge">
<title>router3&#45;&gt;expert3_11</title>
<path fill="none" stroke="black" d="M8790.3,-935.57C8016.66,-935.98 3256.32,-936.71 3199,-892 3187.48,-883.01 3181.77,-868.58 3179.08,-854.38"/>
<polygon fill="black" stroke="black" points="3182.5,-853.55 3177.62,-844.15 3175.57,-854.55 3182.5,-853.55"/>
<text text-anchor="middle" x="3328.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 11</text>
<text text-anchor="middle" x="3328.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_12 -->
<g id="node152" class="node">
<title>expert3_12</title>
<polygon fill="#e6ffe6" stroke="black" points="3570.5,-844 3349.5,-844 3349.5,-776 3570.5,-776 3570.5,-844"/>
<text text-anchor="middle" x="3460" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="3460" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="3460" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="3460" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;141</text>
</g>
<!-- router3&#45;&gt;expert3_12 -->
<g id="edge275" class="edge">
<title>router3&#45;&gt;expert3_12</title>
<path fill="none" stroke="black" d="M8790.49,-935.53C8039.76,-935.62 3535.35,-934.41 3481,-892 3469.48,-883.01 3463.77,-868.58 3461.08,-854.37"/>
<polygon fill="black" stroke="black" points="3464.5,-853.55 3459.62,-844.15 3457.57,-854.54 3464.5,-853.55"/>
<text text-anchor="middle" x="3610.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 12</text>
<text text-anchor="middle" x="3610.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_13 -->
<g id="node153" class="node">
<title>expert3_13</title>
<polygon fill="#e6ffe6" stroke="black" points="3852.5,-844 3631.5,-844 3631.5,-776 3852.5,-776 3852.5,-844"/>
<text text-anchor="middle" x="3742" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="3742" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="3742" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="3742" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;142</text>
</g>
<!-- router3&#45;&gt;expert3_13 -->
<g id="edge276" class="edge">
<title>router3&#45;&gt;expert3_13</title>
<path fill="none" stroke="black" d="M8790.22,-935.48C8061.64,-935.24 3814.38,-932.1 3763,-892 3751.48,-883.01 3745.77,-868.58 3743.09,-854.37"/>
<polygon fill="black" stroke="black" points="3746.5,-853.55 3741.62,-844.15 3739.57,-854.54 3746.5,-853.55"/>
<text text-anchor="middle" x="3892.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 13</text>
<text text-anchor="middle" x="3892.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_14 -->
<g id="node154" class="node">
<title>expert3_14</title>
<polygon fill="#e6ffe6" stroke="black" points="4134.5,-844 3913.5,-844 3913.5,-776 4134.5,-776 4134.5,-844"/>
<text text-anchor="middle" x="4024" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="4024" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4024" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="4024" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;143</text>
</g>
<!-- router3&#45;&gt;expert3_14 -->
<g id="edge277" class="edge">
<title>router3&#45;&gt;expert3_14</title>
<path fill="none" stroke="black" d="M8790.44,-935.43C8086.06,-934.83 4093.42,-929.81 4045,-892 4033.48,-883.01 4027.78,-868.57 4025.09,-854.37"/>
<polygon fill="black" stroke="black" points="4028.51,-853.55 4023.63,-844.14 4021.58,-854.54 4028.51,-853.55"/>
<text text-anchor="middle" x="4174.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 14</text>
<text text-anchor="middle" x="4174.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_15 -->
<g id="node155" class="node">
<title>expert3_15</title>
<polygon fill="#e6ffe6" stroke="black" points="4416.5,-844 4195.5,-844 4195.5,-776 4416.5,-776 4416.5,-844"/>
<text text-anchor="middle" x="4306" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="4306" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4306" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="4306" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;144</text>
</g>
<!-- router3&#45;&gt;expert3_15 -->
<g id="edge278" class="edge">
<title>router3&#45;&gt;expert3_15</title>
<path fill="none" stroke="black" d="M8790.36,-935.37C8110.02,-934.41 4372.45,-927.52 4327,-892 4315.49,-883 4309.78,-868.57 4307.09,-854.36"/>
<polygon fill="black" stroke="black" points="4310.51,-853.54 4305.63,-844.14 4303.58,-854.53 4310.51,-853.54"/>
<text text-anchor="middle" x="4456.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 15</text>
<text text-anchor="middle" x="4456.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_16 -->
<g id="node156" class="node">
<title>expert3_16</title>
<polygon fill="#e6ffe6" stroke="black" points="4698.5,-844 4477.5,-844 4477.5,-776 4698.5,-776 4698.5,-844"/>
<text text-anchor="middle" x="4588" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 16</text>
<text text-anchor="middle" x="4588" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4588" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="4588" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;145</text>
</g>
<!-- router3&#45;&gt;expert3_16 -->
<g id="edge279" class="edge">
<title>router3&#45;&gt;expert3_16</title>
<path fill="none" stroke="black" d="M8790.36,-935.3C8135.02,-933.95 4651.49,-925.23 4609,-892 4597.49,-883 4591.78,-868.57 4589.09,-854.36"/>
<polygon fill="black" stroke="black" points="4592.51,-853.54 4587.63,-844.14 4585.58,-854.53 4592.51,-853.54"/>
<text text-anchor="middle" x="4738.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 16</text>
<text text-anchor="middle" x="4738.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_17 -->
<g id="node157" class="node">
<title>expert3_17</title>
<polygon fill="#e6ffe6" stroke="black" points="4980.5,-844 4759.5,-844 4759.5,-776 4980.5,-776 4980.5,-844"/>
<text text-anchor="middle" x="4870" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 17</text>
<text text-anchor="middle" x="4870" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4870" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="4870" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;146</text>
</g>
<!-- router3&#45;&gt;expert3_17 -->
<g id="edge280" class="edge">
<title>router3&#45;&gt;expert3_17</title>
<path fill="none" stroke="black" d="M8790.26,-935.22C8160.56,-933.46 4930.54,-922.94 4891,-892 4879.49,-882.99 4873.79,-868.56 4871.1,-854.36"/>
<polygon fill="black" stroke="black" points="4874.52,-853.54 4869.63,-844.13 4867.59,-854.53 4874.52,-853.54"/>
<text text-anchor="middle" x="5020.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 17</text>
<text text-anchor="middle" x="5020.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_18 -->
<g id="node158" class="node">
<title>expert3_18</title>
<polygon fill="#e6ffe6" stroke="black" points="5262.5,-844 5041.5,-844 5041.5,-776 5262.5,-776 5262.5,-844"/>
<text text-anchor="middle" x="5152" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 18</text>
<text text-anchor="middle" x="5152" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5152" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="5152" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;147</text>
</g>
<!-- router3&#45;&gt;expert3_18 -->
<g id="edge281" class="edge">
<title>router3&#45;&gt;expert3_18</title>
<path fill="none" stroke="black" d="M8790.22,-935.13C8187.22,-932.94 5209.59,-920.65 5173,-892 5161.5,-882.99 5155.79,-868.56 5153.1,-854.35"/>
<polygon fill="black" stroke="black" points="5156.52,-853.53 5151.64,-844.13 5149.59,-854.52 5156.52,-853.53"/>
<text text-anchor="middle" x="5302.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 18</text>
<text text-anchor="middle" x="5302.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_19 -->
<g id="node159" class="node">
<title>expert3_19</title>
<polygon fill="#e6ffe6" stroke="black" points="5544.5,-844 5323.5,-844 5323.5,-776 5544.5,-776 5544.5,-844"/>
<text text-anchor="middle" x="5434" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 19</text>
<text text-anchor="middle" x="5434" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5434" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="5434" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;148</text>
</g>
<!-- router3&#45;&gt;expert3_19 -->
<g id="edge282" class="edge">
<title>router3&#45;&gt;expert3_19</title>
<path fill="none" stroke="black" d="M8790.37,-935.03C8215.54,-932.37 5488.65,-918.38 5455,-892 5443.5,-882.98 5437.8,-868.55 5435.11,-854.34"/>
<polygon fill="black" stroke="black" points="5438.53,-853.52 5433.64,-844.12 5431.6,-854.52 5438.53,-853.52"/>
<text text-anchor="middle" x="5584.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 19</text>
<text text-anchor="middle" x="5584.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_20 -->
<g id="node160" class="node">
<title>expert3_20</title>
<polygon fill="#e6ffe6" stroke="black" points="5826.5,-844 5605.5,-844 5605.5,-776 5826.5,-776 5826.5,-844"/>
<text text-anchor="middle" x="5716" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 20</text>
<text text-anchor="middle" x="5716" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5716" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="5716" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;149</text>
</g>
<!-- router3&#45;&gt;expert3_20 -->
<g id="edge283" class="edge">
<title>router3&#45;&gt;expert3_20</title>
<path fill="none" stroke="black" d="M8790.44,-935.79C8248.13,-937.07 5798.38,-940.18 5737,-892 5725.51,-882.98 5719.8,-868.54 5717.11,-854.34"/>
<polygon fill="black" stroke="black" points="5720.53,-853.52 5715.65,-844.12 5713.6,-854.51 5720.53,-853.52"/>
<text text-anchor="middle" x="5866.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 20</text>
<text text-anchor="middle" x="5866.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_21 -->
<g id="node161" class="node">
<title>expert3_21</title>
<polygon fill="#e6ffe6" stroke="black" points="6108.5,-844 5887.5,-844 5887.5,-776 6108.5,-776 6108.5,-844"/>
<text text-anchor="middle" x="5998" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 21</text>
<text text-anchor="middle" x="5998" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5998" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="5998" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;150</text>
</g>
<!-- router3&#45;&gt;expert3_21 -->
<g id="edge284" class="edge">
<title>router3&#45;&gt;expert3_21</title>
<path fill="none" stroke="black" d="M8790.25,-935.66C8277.59,-936.2 6073.29,-935.97 6018,-892 6006.6,-882.93 6001.07,-868.48 5998.56,-854.28"/>
<polygon fill="black" stroke="black" points="6001.99,-853.53 5997.22,-844.07 5995.05,-854.44 6001.99,-853.53"/>
<text text-anchor="middle" x="6147.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 21</text>
<text text-anchor="middle" x="6147.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_22 -->
<g id="node162" class="node">
<title>expert3_22</title>
<polygon fill="#e6ffe6" stroke="black" points="6390.5,-844 6169.5,-844 6169.5,-776 6390.5,-776 6390.5,-844"/>
<text text-anchor="middle" x="6280" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 22</text>
<text text-anchor="middle" x="6280" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="6280" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="6280" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;151</text>
</g>
<!-- router3&#45;&gt;expert3_22 -->
<g id="edge285" class="edge">
<title>router3&#45;&gt;expert3_22</title>
<path fill="none" stroke="black" d="M8790.36,-935.49C8309.43,-935.23 6348.27,-931.73 6299,-892 6287.69,-882.88 6282.33,-868.42 6280,-854.23"/>
<polygon fill="black" stroke="black" points="6283.44,-853.54 6278.79,-844.02 6276.49,-854.36 6283.44,-853.54"/>
<text text-anchor="middle" x="6428.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 22</text>
<text text-anchor="middle" x="6428.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_23 -->
<g id="node163" class="node">
<title>expert3_23</title>
<polygon fill="#e6ffe6" stroke="black" points="6672.5,-844 6451.5,-844 6451.5,-776 6672.5,-776 6672.5,-844"/>
<text text-anchor="middle" x="6562" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 23</text>
<text text-anchor="middle" x="6562" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="6562" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="6562" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;152</text>
</g>
<!-- router3&#45;&gt;expert3_23 -->
<g id="edge286" class="edge">
<title>router3&#45;&gt;expert3_23</title>
<path fill="none" stroke="black" d="M8790.38,-935.28C8342.78,-934.13 6623.32,-927.42 6580,-892 6568.87,-882.9 6563.68,-868.59 6561.5,-854.51"/>
<polygon fill="black" stroke="black" points="6564.96,-853.94 6560.39,-844.38 6558,-854.7 6564.96,-853.94"/>
<text text-anchor="middle" x="6709.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 23</text>
<text text-anchor="middle" x="6709.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_24 -->
<g id="node164" class="node">
<title>expert3_24</title>
<polygon fill="#e6ffe6" stroke="black" points="6954.5,-844 6733.5,-844 6733.5,-776 6954.5,-776 6954.5,-844"/>
<text text-anchor="middle" x="6844" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 24</text>
<text text-anchor="middle" x="6844" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="6844" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="6844" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;153</text>
</g>
<!-- router3&#45;&gt;expert3_24 -->
<g id="edge287" class="edge">
<title>router3&#45;&gt;expert3_24</title>
<path fill="none" stroke="black" d="M8790.44,-935.04C8378,-933.01 6896.11,-923.55 6859,-892 6848.13,-882.76 6843.45,-868.41 6841.79,-854.35"/>
<polygon fill="black" stroke="black" points="6845.27,-853.96 6841.07,-844.24 6838.29,-854.46 6845.27,-853.96"/>
<text text-anchor="middle" x="6988.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 24</text>
<text text-anchor="middle" x="6988.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_25 -->
<g id="node165" class="node">
<title>expert3_25</title>
<polygon fill="#e6ffe6" stroke="black" points="7236.5,-844 7015.5,-844 7015.5,-776 7236.5,-776 7236.5,-844"/>
<text text-anchor="middle" x="7126" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 25</text>
<text text-anchor="middle" x="7126" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7126" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="7126" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;154</text>
</g>
<!-- router3&#45;&gt;expert3_25 -->
<g id="edge288" class="edge">
<title>router3&#45;&gt;expert3_25</title>
<path fill="none" stroke="black" d="M8790.39,-934.72C8415.3,-931.72 7167.93,-919.69 7137,-892 7126.45,-882.55 7122.45,-868.17 7121.5,-854.12"/>
<polygon fill="black" stroke="black" points="7125,-853.96 7121.3,-844.03 7118,-854.1 7125,-853.96"/>
<text text-anchor="middle" x="7266.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 25</text>
<text text-anchor="middle" x="7266.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_26 -->
<g id="node166" class="node">
<title>expert3_26</title>
<polygon fill="#e6ffe6" stroke="black" points="7517.5,-844 7296.5,-844 7296.5,-776 7517.5,-776 7517.5,-844"/>
<text text-anchor="middle" x="7407" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 26</text>
<text text-anchor="middle" x="7407" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7407" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="7407" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;155</text>
</g>
<!-- router3&#45;&gt;expert3_26 -->
<g id="edge289" class="edge">
<title>router3&#45;&gt;expert3_26</title>
<path fill="none" stroke="black" d="M8790.27,-934.27C8455.44,-930.12 7439,-915.61 7414,-892 7403.94,-882.5 7400.56,-868.4 7400.22,-854.62"/>
<polygon fill="black" stroke="black" points="7403.73,-854.3 7400.49,-844.22 7396.73,-854.12 7403.73,-854.3"/>
<text text-anchor="middle" x="7543.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 26</text>
<text text-anchor="middle" x="7543.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_27 -->
<g id="node167" class="node">
<title>expert3_27</title>
<polygon fill="#e6ffe6" stroke="black" points="7798.5,-844 7577.5,-844 7577.5,-776 7798.5,-776 7798.5,-844"/>
<text text-anchor="middle" x="7688" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 27</text>
<text text-anchor="middle" x="7688" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7688" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="7688" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;156</text>
</g>
<!-- router3&#45;&gt;expert3_27 -->
<g id="edge290" class="edge">
<title>router3&#45;&gt;expert3_27</title>
<path fill="none" stroke="black" d="M8790.44,-935.6C8503.35,-935.36 7727.17,-931.09 7689,-892 7679.45,-882.22 7677.01,-868.18 7677.65,-854.54"/>
<polygon fill="black" stroke="black" points="7681.17,-854.55 7678.68,-844.26 7674.2,-853.86 7681.17,-854.55"/>
<text text-anchor="middle" x="7818.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 27</text>
<text text-anchor="middle" x="7818.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_28 -->
<g id="node168" class="node">
<title>expert3_28</title>
<polygon fill="#e6ffe6" stroke="black" points="8078.5,-844 7857.5,-844 7857.5,-776 8078.5,-776 8078.5,-844"/>
<text text-anchor="middle" x="7968" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 28</text>
<text text-anchor="middle" x="7968" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7968" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="7968" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;157</text>
</g>
<!-- router3&#45;&gt;expert3_28 -->
<g id="edge291" class="edge">
<title>router3&#45;&gt;expert3_28</title>
<path fill="none" stroke="black" d="M8790.43,-934.44C8551.97,-931.53 7990.21,-921.56 7962,-892 7952.44,-881.99 7951.1,-867.74 7953.07,-853.98"/>
<polygon fill="black" stroke="black" points="7956.52,-854.61 7955.03,-844.12 7949.65,-853.25 7956.52,-854.61"/>
<text text-anchor="middle" x="8091.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 28</text>
<text text-anchor="middle" x="8091.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_29 -->
<g id="node169" class="node">
<title>expert3_29</title>
<polygon fill="#e6ffe6" stroke="black" points="8355.5,-844 8134.5,-844 8134.5,-776 8355.5,-776 8355.5,-844"/>
<text text-anchor="middle" x="8245" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 29</text>
<text text-anchor="middle" x="8245" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8245" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="8245" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;158</text>
</g>
<!-- router3&#45;&gt;expert3_29 -->
<g id="edge292" class="edge">
<title>router3&#45;&gt;expert3_29</title>
<path fill="none" stroke="black" d="M8790.29,-936.28C8612.94,-936.48 8271.13,-931.64 8234,-892 8224.55,-881.91 8223.89,-867.78 8226.68,-854.14"/>
<polygon fill="black" stroke="black" points="8230.1,-854.92 8229.26,-844.36 8223.33,-853.14 8230.1,-854.92"/>
<text text-anchor="middle" x="8363.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 29</text>
<text text-anchor="middle" x="8363.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_30 -->
<g id="node170" class="node">
<title>expert3_30</title>
<polygon fill="#e6ffe6" stroke="black" points="8627.5,-844 8406.5,-844 8406.5,-776 8627.5,-776 8627.5,-844"/>
<text text-anchor="middle" x="8517" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 30</text>
<text text-anchor="middle" x="8517" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8517" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="8517" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;159</text>
</g>
<!-- router3&#45;&gt;expert3_30 -->
<g id="edge293" class="edge">
<title>router3&#45;&gt;expert3_30</title>
<path fill="none" stroke="black" d="M8790.3,-930.86C8681.34,-924.96 8524.74,-912.94 8506,-892 8496.79,-881.7 8496.17,-867.52 8498.95,-853.9"/>
<polygon fill="black" stroke="black" points="8502.36,-854.7 8501.5,-844.14 8495.58,-852.93 8502.36,-854.7"/>
<text text-anchor="middle" x="8635.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 30</text>
<text text-anchor="middle" x="8635.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_31 -->
<g id="node171" class="node">
<title>expert3_31</title>
<polygon fill="#e6ffe6" stroke="black" points="8897.5,-844 8676.5,-844 8676.5,-776 8897.5,-776 8897.5,-844"/>
<text text-anchor="middle" x="8787" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 31</text>
<text text-anchor="middle" x="8787" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8787" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="8787" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;160</text>
</g>
<!-- router3&#45;&gt;expert3_31 -->
<g id="edge294" class="edge">
<title>router3&#45;&gt;expert3_31</title>
<path fill="none" stroke="black" d="M8795.04,-909.88C8788.1,-904.93 8781.92,-899.03 8777,-892 8769.37,-881.08 8768.69,-867.25 8770.89,-854.13"/>
<polygon fill="black" stroke="black" points="8774.32,-854.81 8773.06,-844.29 8767.49,-853.3 8774.32,-854.81"/>
<text text-anchor="middle" x="8906.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 31</text>
<text text-anchor="middle" x="8906.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_32 -->
<g id="node172" class="node">
<title>expert3_32</title>
<polygon fill="#e6ffe6" stroke="black" points="9157.5,-844 8936.5,-844 8936.5,-776 9157.5,-776 9157.5,-844"/>
<text text-anchor="middle" x="9047" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 32</text>
<text text-anchor="middle" x="9047" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9047" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="9047" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;161</text>
</g>
<!-- router3&#45;&gt;expert3_32 -->
<g id="edge295" class="edge">
<title>router3&#45;&gt;expert3_32</title>
<path fill="none" stroke="black" d="M9001.63,-917.42C9014.7,-911.23 9026.71,-902.98 9036,-892 9044.77,-881.64 9048.52,-867.72 9049.78,-854.34"/>
<polygon fill="black" stroke="black" points="9053.28,-854.45 9050.3,-844.28 9046.29,-854.09 9053.28,-854.45"/>
<text text-anchor="middle" x="9177.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 32</text>
<text text-anchor="middle" x="9177.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_33 -->
<g id="node173" class="node">
<title>expert3_33</title>
<polygon fill="#e6ffe6" stroke="black" points="9428.5,-844 9207.5,-844 9207.5,-776 9428.5,-776 9428.5,-844"/>
<text text-anchor="middle" x="9318" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 33</text>
<text text-anchor="middle" x="9318" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9318" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="9318" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;162</text>
</g>
<!-- router3&#45;&gt;expert3_33 -->
<g id="edge296" class="edge">
<title>router3&#45;&gt;expert3_33</title>
<path fill="none" stroke="black" d="M9001.59,-931.32C9117.36,-925.68 9289.67,-913.73 9311,-892 9320.61,-882.21 9323.94,-868.17 9324.36,-854.53"/>
<polygon fill="black" stroke="black" points="9327.85,-854.18 9324.17,-844.25 9320.85,-854.31 9327.85,-854.18"/>
<text text-anchor="middle" x="9452.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 33</text>
<text text-anchor="middle" x="9452.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_34 -->
<g id="node174" class="node">
<title>expert3_34</title>
<polygon fill="#e6ffe6" stroke="black" points="9705.5,-844 9484.5,-844 9484.5,-776 9705.5,-776 9705.5,-844"/>
<text text-anchor="middle" x="9595" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 34</text>
<text text-anchor="middle" x="9595" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9595" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="9595" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;163</text>
</g>
<!-- router3&#45;&gt;expert3_34 -->
<g id="edge297" class="edge">
<title>router3&#45;&gt;expert3_34</title>
<path fill="none" stroke="black" d="M9001.71,-936.16C9184.64,-936.25 9544.74,-931.34 9586,-892 9596.04,-882.43 9599.71,-868.31 9600.42,-854.54"/>
<polygon fill="black" stroke="black" points="9603.92,-854.15 9600.44,-844.15 9596.92,-854.14 9603.92,-854.15"/>
<text text-anchor="middle" x="9728.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 34</text>
<text text-anchor="middle" x="9728.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_35 -->
<g id="node175" class="node">
<title>expert3_35</title>
<polygon fill="#e6ffe6" stroke="black" points="9984.5,-844 9763.5,-844 9763.5,-776 9984.5,-776 9984.5,-844"/>
<text text-anchor="middle" x="9874" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 35</text>
<text text-anchor="middle" x="9874" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9874" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="9874" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;164</text>
</g>
<!-- router3&#45;&gt;expert3_35 -->
<g id="edge298" class="edge">
<title>router3&#45;&gt;expert3_35</title>
<path fill="none" stroke="black" d="M9001.71,-934.31C9245.83,-931.09 9830.5,-920.44 9862,-892 9872.44,-882.57 9876.61,-868.33 9877.78,-854.4"/>
<polygon fill="black" stroke="black" points="9881.28,-854.51 9878.16,-844.38 9874.29,-854.25 9881.28,-854.51"/>
<text text-anchor="middle" x="10005.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 35</text>
<text text-anchor="middle" x="10005.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_36 -->
<g id="node176" class="node">
<title>expert3_36</title>
<polygon fill="#e6ffe6" stroke="black" points="10265.5,-844 10044.5,-844 10044.5,-776 10265.5,-776 10265.5,-844"/>
<text text-anchor="middle" x="10155" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 36</text>
<text text-anchor="middle" x="10155" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10155" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="10155" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;165</text>
</g>
<!-- router3&#45;&gt;expert3_36 -->
<g id="edge299" class="edge">
<title>router3&#45;&gt;expert3_36</title>
<path fill="none" stroke="black" d="M9001.7,-935.34C9294.27,-934.43 10096.04,-928.58 10139,-892 10149.89,-882.73 10154.72,-868.38 10156.56,-854.32"/>
<polygon fill="black" stroke="black" points="10160.06,-854.47 10157.42,-844.21 10153.09,-853.88 10160.06,-854.47"/>
<text text-anchor="middle" x="10283.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 36</text>
<text text-anchor="middle" x="10283.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_37 -->
<g id="node177" class="node">
<title>expert3_37</title>
<polygon fill="#e6ffe6" stroke="black" points="10546.5,-844 10325.5,-844 10325.5,-776 10546.5,-776 10546.5,-844"/>
<text text-anchor="middle" x="10436" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 37</text>
<text text-anchor="middle" x="10436" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10436" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="10436" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;166</text>
</g>
<!-- router3&#45;&gt;expert3_37 -->
<g id="edge300" class="edge">
<title>router3&#45;&gt;expert3_37</title>
<path fill="none" stroke="black" d="M9001.55,-935.98C9337.37,-937.06 10362.28,-936.65 10417,-892 10428.17,-882.89 10433.51,-868.57 10435.88,-854.5"/>
<polygon fill="black" stroke="black" points="10439.38,-854.72 10437.12,-844.37 10432.43,-853.87 10439.38,-854.72"/>
<text text-anchor="middle" x="10563.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 37</text>
<text text-anchor="middle" x="10563.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_38 -->
<g id="node178" class="node">
<title>expert3_38</title>
<polygon fill="#e6ffe6" stroke="black" points="10828.5,-844 10607.5,-844 10607.5,-776 10828.5,-776 10828.5,-844"/>
<text text-anchor="middle" x="10718" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 38</text>
<text text-anchor="middle" x="10718" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10718" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="10718" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;167</text>
</g>
<!-- router3&#45;&gt;expert3_38 -->
<g id="edge301" class="edge">
<title>router3&#45;&gt;expert3_38</title>
<path fill="none" stroke="black" d="M9001.72,-934.65C9382.55,-931.39 10663.63,-918.47 10697,-892 10708.45,-882.92 10714.14,-868.47 10716.84,-854.27"/>
<polygon fill="black" stroke="black" points="10720.35,-854.45 10718.31,-844.06 10713.42,-853.46 10720.35,-854.45"/>
<text text-anchor="middle" x="10844.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 38</text>
<text text-anchor="middle" x="10844.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_39 -->
<g id="node179" class="node">
<title>expert3_39</title>
<polygon fill="#e6ffe6" stroke="black" points="11110.5,-844 10889.5,-844 10889.5,-776 11110.5,-776 11110.5,-844"/>
<text text-anchor="middle" x="11000" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 39</text>
<text text-anchor="middle" x="11000" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11000" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="11000" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;168</text>
</g>
<!-- router3&#45;&gt;expert3_39 -->
<g id="edge302" class="edge">
<title>router3&#45;&gt;expert3_39</title>
<path fill="none" stroke="black" d="M9001.67,-935C9419.92,-932.8 10938.7,-922.7 10978,-892 10989.55,-882.98 10995.42,-868.54 10998.29,-854.33"/>
<polygon fill="black" stroke="black" points="11001.8,-854.53 10999.89,-844.11 10994.89,-853.45 11001.8,-854.53"/>
<text text-anchor="middle" x="11125.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 39</text>
<text text-anchor="middle" x="11125.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_40 -->
<g id="node180" class="node">
<title>expert3_40</title>
<polygon fill="#e6ffe6" stroke="black" points="11392.5,-844 11171.5,-844 11171.5,-776 11392.5,-776 11392.5,-844"/>
<text text-anchor="middle" x="11282" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 40</text>
<text text-anchor="middle" x="11282" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11282" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="11282" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;169</text>
</g>
<!-- router3&#45;&gt;expert3_40 -->
<g id="edge303" class="edge">
<title>router3&#45;&gt;expert3_40</title>
<path fill="none" stroke="black" d="M9001.8,-935.26C9455.25,-934 11213.7,-926.88 11259,-892 11270.65,-883.03 11276.7,-868.6 11279.74,-854.39"/>
<polygon fill="black" stroke="black" points="11283.26,-854.61 11281.47,-844.16 11276.35,-853.44 11283.26,-854.61"/>
<text text-anchor="middle" x="11406.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 40</text>
<text text-anchor="middle" x="11406.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_41 -->
<g id="node181" class="node">
<title>expert3_41</title>
<polygon fill="#e6ffe6" stroke="black" points="11674.5,-844 11453.5,-844 11453.5,-776 11674.5,-776 11674.5,-844"/>
<text text-anchor="middle" x="11564" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 41</text>
<text text-anchor="middle" x="11564" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11564" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="11564" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;170</text>
</g>
<!-- router3&#45;&gt;expert3_41 -->
<g id="edge304" class="edge">
<title>router3&#45;&gt;expert3_41</title>
<path fill="none" stroke="black" d="M9001.88,-935.46C9488.46,-935.05 11488.63,-931.02 11540,-892 11551.75,-883.08 11557.97,-868.66 11561.19,-854.45"/>
<polygon fill="black" stroke="black" points="11564.71,-854.68 11563.05,-844.21 11557.82,-853.43 11564.71,-854.68"/>
<text text-anchor="middle" x="11688.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 41</text>
<text text-anchor="middle" x="11688.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_42 -->
<g id="node182" class="node">
<title>expert3_42</title>
<polygon fill="#e6ffe6" stroke="black" points="11956.5,-844 11735.5,-844 11735.5,-776 11956.5,-776 11956.5,-844"/>
<text text-anchor="middle" x="11846" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 42</text>
<text text-anchor="middle" x="11846" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11846" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="11846" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;171</text>
</g>
<!-- router3&#45;&gt;expert3_42 -->
<g id="edge305" class="edge">
<title>router3&#45;&gt;expert3_42</title>
<path fill="none" stroke="black" d="M9001.75,-935.63C9519.53,-936.07 11764.71,-935.44 11822,-892 11833.76,-883.09 11839.98,-868.67 11843.2,-854.46"/>
<polygon fill="black" stroke="black" points="11846.72,-854.68 11845.05,-844.22 11839.83,-853.44 11846.72,-854.68"/>
<text text-anchor="middle" x="11970.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 42</text>
<text text-anchor="middle" x="11970.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_43 -->
<g id="node183" class="node">
<title>expert3_43</title>
<polygon fill="#e6ffe6" stroke="black" points="12238.5,-844 12017.5,-844 12017.5,-776 12238.5,-776 12238.5,-844"/>
<text text-anchor="middle" x="12128" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 43</text>
<text text-anchor="middle" x="12128" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12128" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="12128" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;172</text>
</g>
<!-- router3&#45;&gt;expert3_43 -->
<g id="edge306" class="edge">
<title>router3&#45;&gt;expert3_43</title>
<path fill="none" stroke="black" d="M9001.81,-935.78C9549.63,-936.99 12040.78,-939.88 12104,-892 12115.76,-883.09 12121.98,-868.68 12125.21,-854.46"/>
<polygon fill="black" stroke="black" points="12128.72,-854.69 12127.06,-844.23 12121.83,-853.45 12128.72,-854.69"/>
<text text-anchor="middle" x="12252.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 43</text>
<text text-anchor="middle" x="12252.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_44 -->
<g id="node184" class="node">
<title>expert3_44</title>
<polygon fill="#e6ffe6" stroke="black" points="12520.5,-844 12299.5,-844 12299.5,-776 12520.5,-776 12520.5,-844"/>
<text text-anchor="middle" x="12410" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 44</text>
<text text-anchor="middle" x="12410" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12410" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="12410" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;173</text>
</g>
<!-- router3&#45;&gt;expert3_44 -->
<g id="edge307" class="edge">
<title>router3&#45;&gt;expert3_44</title>
<path fill="none" stroke="black" d="M9001.69,-935.03C9581.53,-932.35 12351.39,-918.18 12386,-892 12397.77,-883.1 12403.99,-868.69 12407.21,-854.47"/>
<polygon fill="black" stroke="black" points="12410.73,-854.7 12409.06,-844.24 12403.84,-853.45 12410.73,-854.7"/>
<text text-anchor="middle" x="12534.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 44</text>
<text text-anchor="middle" x="12534.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_45 -->
<g id="node185" class="node">
<title>expert3_45</title>
<polygon fill="#e6ffe6" stroke="black" points="12802.5,-844 12581.5,-844 12581.5,-776 12802.5,-776 12802.5,-844"/>
<text text-anchor="middle" x="12692" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 45</text>
<text text-anchor="middle" x="12692" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12692" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="12692" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;174</text>
</g>
<!-- router3&#45;&gt;expert3_45 -->
<g id="edge308" class="edge">
<title>router3&#45;&gt;expert3_45</title>
<path fill="none" stroke="black" d="M9001.67,-935.13C9609.09,-932.9 12630.41,-920.41 12668,-892 12679.77,-883.11 12686,-868.7 12689.22,-854.48"/>
<polygon fill="black" stroke="black" points="12692.73,-854.7 12691.07,-844.24 12685.84,-853.46 12692.73,-854.7"/>
<text text-anchor="middle" x="12816.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 45</text>
<text text-anchor="middle" x="12816.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_46 -->
<g id="node186" class="node">
<title>expert3_46</title>
<polygon fill="#e6ffe6" stroke="black" points="13084.5,-844 12863.5,-844 12863.5,-776 13084.5,-776 13084.5,-844"/>
<text text-anchor="middle" x="12974" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 46</text>
<text text-anchor="middle" x="12974" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12974" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="12974" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;175</text>
</g>
<!-- router3&#45;&gt;expert3_46 -->
<g id="edge309" class="edge">
<title>router3&#45;&gt;expert3_46</title>
<path fill="none" stroke="black" d="M9001.73,-935.22C9635.91,-933.42 12909.42,-922.64 12950,-892 12961.77,-883.11 12968,-868.7 12971.22,-854.48"/>
<polygon fill="black" stroke="black" points="12974.74,-854.71 12973.07,-844.25 12967.85,-853.46 12974.74,-854.71"/>
<text text-anchor="middle" x="13098.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 46</text>
<text text-anchor="middle" x="13098.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_47 -->
<g id="node187" class="node">
<title>expert3_47</title>
<polygon fill="#e6ffe6" stroke="black" points="13366.5,-844 13145.5,-844 13145.5,-776 13366.5,-776 13366.5,-844"/>
<text text-anchor="middle" x="13256" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 47</text>
<text text-anchor="middle" x="13256" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13256" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="13256" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;176</text>
</g>
<!-- router3&#45;&gt;expert3_47 -->
<g id="edge310" class="edge">
<title>router3&#45;&gt;expert3_47</title>
<path fill="none" stroke="black" d="M9001.5,-935.29C9660.82,-933.89 13188.42,-924.88 13232,-892 13243.78,-883.11 13250,-868.71 13253.22,-854.49"/>
<polygon fill="black" stroke="black" points="13256.74,-854.71 13255.07,-844.25 13249.85,-853.47 13256.74,-854.71"/>
<text text-anchor="middle" x="13380.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 47</text>
<text text-anchor="middle" x="13380.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_48 -->
<g id="node188" class="node">
<title>expert3_48</title>
<polygon fill="#e6ffe6" stroke="black" points="13648.5,-844 13427.5,-844 13427.5,-776 13648.5,-776 13648.5,-844"/>
<text text-anchor="middle" x="13538" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 48</text>
<text text-anchor="middle" x="13538" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13538" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="13538" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;177</text>
</g>
<!-- router3&#45;&gt;expert3_48 -->
<g id="edge311" class="edge">
<title>router3&#45;&gt;expert3_48</title>
<path fill="none" stroke="black" d="M9001.65,-935.36C9686.24,-934.34 13467.42,-927.12 13514,-892 13525.78,-883.12 13532.01,-868.71 13535.23,-854.49"/>
<polygon fill="black" stroke="black" points="13538.74,-854.72 13537.08,-844.25 13531.86,-853.47 13538.74,-854.72"/>
<text text-anchor="middle" x="13662.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 48</text>
<text text-anchor="middle" x="13662.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_49 -->
<g id="node189" class="node">
<title>expert3_49</title>
<polygon fill="#e6ffe6" stroke="black" points="13930.5,-844 13709.5,-844 13709.5,-776 13930.5,-776 13930.5,-844"/>
<text text-anchor="middle" x="13820" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 49</text>
<text text-anchor="middle" x="13820" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13820" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="13820" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;178</text>
</g>
<!-- router3&#45;&gt;expert3_49 -->
<g id="edge312" class="edge">
<title>router3&#45;&gt;expert3_49</title>
<path fill="none" stroke="black" d="M9001.75,-935.42C9710.76,-934.76 13746.42,-929.36 13796,-892 13807.78,-883.12 13814.01,-868.71 13817.23,-854.5"/>
<polygon fill="black" stroke="black" points="13820.75,-854.72 13819.08,-844.26 13813.86,-853.47 13820.75,-854.72"/>
<text text-anchor="middle" x="13944.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 49</text>
<text text-anchor="middle" x="13944.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_50 -->
<g id="node190" class="node">
<title>expert3_50</title>
<polygon fill="#e6ffe6" stroke="black" points="14212.5,-844 13991.5,-844 13991.5,-776 14212.5,-776 14212.5,-844"/>
<text text-anchor="middle" x="14102" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 50</text>
<text text-anchor="middle" x="14102" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14102" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="14102" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;179</text>
</g>
<!-- router3&#45;&gt;expert3_50 -->
<g id="edge313" class="edge">
<title>router3&#45;&gt;expert3_50</title>
<path fill="none" stroke="black" d="M9001.6,-935.47C9733.63,-935.15 14025.42,-931.61 14078,-892 14089.78,-883.12 14096.01,-868.72 14099.23,-854.5"/>
<polygon fill="black" stroke="black" points="14102.75,-854.72 14101.08,-844.26 14095.86,-853.48 14102.75,-854.72"/>
<text text-anchor="middle" x="14226.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 50</text>
<text text-anchor="middle" x="14226.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_51 -->
<g id="node191" class="node">
<title>expert3_51</title>
<polygon fill="#e6ffe6" stroke="black" points="14494.5,-844 14273.5,-844 14273.5,-776 14494.5,-776 14494.5,-844"/>
<text text-anchor="middle" x="14384" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 51</text>
<text text-anchor="middle" x="14384" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14384" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="14384" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;180</text>
</g>
<!-- router3&#45;&gt;expert3_51 -->
<g id="edge314" class="edge">
<title>router3&#45;&gt;expert3_51</title>
<path fill="none" stroke="black" d="M9001.55,-935.52C9756.23,-935.53 14304.4,-933.86 14360,-892 14371.79,-883.13 14378.02,-868.72 14381.23,-854.5"/>
<polygon fill="black" stroke="black" points="14384.75,-854.72 14383.08,-844.26 14377.86,-853.48 14384.75,-854.72"/>
<text text-anchor="middle" x="14508.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 51</text>
<text text-anchor="middle" x="14508.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_52 -->
<g id="node192" class="node">
<title>expert3_52</title>
<polygon fill="#e6ffe6" stroke="black" points="14776.5,-844 14555.5,-844 14555.5,-776 14776.5,-776 14776.5,-844"/>
<text text-anchor="middle" x="14666" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 52</text>
<text text-anchor="middle" x="14666" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14666" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="14666" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;181</text>
</g>
<!-- router3&#45;&gt;expert3_52 -->
<g id="edge315" class="edge">
<title>router3&#45;&gt;expert3_52</title>
<path fill="none" stroke="black" d="M9001.67,-935.56C9778.95,-935.88 14583.39,-936.11 14642,-892 14653.79,-883.13 14660.02,-868.72 14663.24,-854.5"/>
<polygon fill="black" stroke="black" points="14666.75,-854.73 14665.09,-844.26 14659.86,-853.48 14666.75,-854.73"/>
<text text-anchor="middle" x="14790.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 52</text>
<text text-anchor="middle" x="14790.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_53 -->
<g id="node193" class="node">
<title>expert3_53</title>
<polygon fill="#e6ffe6" stroke="black" points="15058.5,-844 14837.5,-844 14837.5,-776 15058.5,-776 15058.5,-844"/>
<text text-anchor="middle" x="14948" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 53</text>
<text text-anchor="middle" x="14948" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14948" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="14948" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;182</text>
</g>
<!-- router3&#45;&gt;expert3_53 -->
<g id="edge316" class="edge">
<title>router3&#45;&gt;expert3_53</title>
<path fill="none" stroke="black" d="M9001.71,-935.6C9800.84,-936.22 14862.38,-938.36 14924,-892 14935.79,-883.13 14942.02,-868.73 14945.24,-854.51"/>
<polygon fill="black" stroke="black" points="14948.75,-854.73 14947.09,-844.27 14941.87,-853.48 14948.75,-854.73"/>
<text text-anchor="middle" x="15072.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 53</text>
<text text-anchor="middle" x="15072.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_54 -->
<g id="node194" class="node">
<title>expert3_54</title>
<polygon fill="#e6ffe6" stroke="black" points="15340.5,-844 15119.5,-844 15119.5,-776 15340.5,-776 15340.5,-844"/>
<text text-anchor="middle" x="15230" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 54</text>
<text text-anchor="middle" x="15230" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15230" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="15230" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;183</text>
</g>
<!-- router3&#45;&gt;expert3_54 -->
<g id="edge317" class="edge">
<title>router3&#45;&gt;expert3_54</title>
<path fill="none" stroke="black" d="M9001.72,-935.63C9822.08,-936.55 15141.36,-940.61 15206,-892 15217.79,-883.13 15224.02,-868.73 15227.24,-854.51"/>
<polygon fill="black" stroke="black" points="15230.76,-854.73 15229.09,-844.27 15223.87,-853.49 15230.76,-854.73"/>
<text text-anchor="middle" x="15354.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 54</text>
<text text-anchor="middle" x="15354.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_55 -->
<g id="node195" class="node">
<title>expert3_55</title>
<polygon fill="#e6ffe6" stroke="black" points="15622.5,-844 15401.5,-844 15401.5,-776 15622.5,-776 15622.5,-844"/>
<text text-anchor="middle" x="15512" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 55</text>
<text text-anchor="middle" x="15512" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15512" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="15512" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;184</text>
</g>
<!-- router3&#45;&gt;expert3_55 -->
<g id="edge318" class="edge">
<title>router3&#45;&gt;expert3_55</title>
<path fill="none" stroke="black" d="M9001.64,-935.23C9845.01,-933.03 15454.16,-917.44 15488,-892 15499.79,-883.13 15506.02,-868.73 15509.24,-854.51"/>
<polygon fill="black" stroke="black" points="15512.76,-854.73 15511.09,-844.27 15505.87,-853.49 15512.76,-854.73"/>
<text text-anchor="middle" x="15636.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 55</text>
<text text-anchor="middle" x="15636.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_56 -->
<g id="node196" class="node">
<title>expert3_56</title>
<polygon fill="#e6ffe6" stroke="black" points="15904.5,-844 15683.5,-844 15683.5,-776 15904.5,-776 15904.5,-844"/>
<text text-anchor="middle" x="15794" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 56</text>
<text text-anchor="middle" x="15794" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15794" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="15794" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;185</text>
</g>
<!-- router3&#45;&gt;expert3_56 -->
<g id="edge319" class="edge">
<title>router3&#45;&gt;expert3_56</title>
<path fill="none" stroke="black" d="M9001.68,-935.26C9865.52,-933.24 15734.65,-918.57 15770,-892 15781.79,-883.14 15788.02,-868.73 15791.24,-854.51"/>
<polygon fill="black" stroke="black" points="15794.76,-854.73 15793.09,-844.27 15787.87,-853.49 15794.76,-854.73"/>
<text text-anchor="middle" x="15918.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 56</text>
<text text-anchor="middle" x="15918.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_57 -->
<g id="node197" class="node">
<title>expert3_57</title>
<polygon fill="#e6ffe6" stroke="black" points="16186.5,-844 15965.5,-844 15965.5,-776 16186.5,-776 16186.5,-844"/>
<text text-anchor="middle" x="16076" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 57</text>
<text text-anchor="middle" x="16076" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16076" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="16076" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;186</text>
</g>
<!-- router3&#45;&gt;expert3_57 -->
<g id="edge320" class="edge">
<title>router3&#45;&gt;expert3_57</title>
<path fill="none" stroke="black" d="M9001.78,-935.29C9885.95,-933.45 16015.14,-919.7 16052,-892 16063.79,-883.14 16070.03,-868.73 16073.24,-854.51"/>
<polygon fill="black" stroke="black" points="16076.76,-854.73 16075.09,-844.27 16069.87,-853.49 16076.76,-854.73"/>
<text text-anchor="middle" x="16200.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 57</text>
<text text-anchor="middle" x="16200.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_58 -->
<g id="node198" class="node">
<title>expert3_58</title>
<polygon fill="#e6ffe6" stroke="black" points="16468.5,-844 16247.5,-844 16247.5,-776 16468.5,-776 16468.5,-844"/>
<text text-anchor="middle" x="16358" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 58</text>
<text text-anchor="middle" x="16358" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16358" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="16358" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;187</text>
</g>
<!-- router3&#45;&gt;expert3_58 -->
<g id="edge321" class="edge">
<title>router3&#45;&gt;expert3_58</title>
<path fill="none" stroke="black" d="M9001.64,-935.31C9904.83,-933.64 16295.62,-920.83 16334,-892 16345.8,-883.14 16352.03,-868.74 16355.25,-854.51"/>
<polygon fill="black" stroke="black" points="16358.76,-854.74 16357.09,-844.27 16351.87,-853.49 16358.76,-854.74"/>
<text text-anchor="middle" x="16482.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 58</text>
<text text-anchor="middle" x="16482.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_59 -->
<g id="node199" class="node">
<title>expert3_59</title>
<polygon fill="#e6ffe6" stroke="black" points="16750.5,-844 16529.5,-844 16529.5,-776 16750.5,-776 16750.5,-844"/>
<text text-anchor="middle" x="16640" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 59</text>
<text text-anchor="middle" x="16640" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16640" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="16640" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;188</text>
</g>
<!-- router3&#45;&gt;expert3_59 -->
<g id="edge322" class="edge">
<title>router3&#45;&gt;expert3_59</title>
<path fill="none" stroke="black" d="M9001.62,-935.33C9923.9,-933.83 16576.1,-921.96 16616,-892 16627.8,-883.14 16634.03,-868.74 16637.25,-854.52"/>
<polygon fill="black" stroke="black" points="16640.76,-854.74 16639.09,-844.27 16633.87,-853.49 16640.76,-854.74"/>
<text text-anchor="middle" x="16764.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 59</text>
<text text-anchor="middle" x="16764.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_60 -->
<g id="node200" class="node">
<title>expert3_60</title>
<polygon fill="#e6ffe6" stroke="black" points="17032.5,-844 16811.5,-844 16811.5,-776 17032.5,-776 17032.5,-844"/>
<text text-anchor="middle" x="16922" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 60</text>
<text text-anchor="middle" x="16922" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16922" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="16922" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;189</text>
</g>
<!-- router3&#45;&gt;expert3_60 -->
<g id="edge323" class="edge">
<title>router3&#45;&gt;expert3_60</title>
<path fill="none" stroke="black" d="M9001.75,-935.35C9943.35,-934.01 16856.59,-923.1 16898,-892 16909.8,-883.14 16916.03,-868.74 16919.25,-854.52"/>
<polygon fill="black" stroke="black" points="16922.76,-854.74 16921.09,-844.28 16915.88,-853.5 16922.76,-854.74"/>
<text text-anchor="middle" x="17046.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 60</text>
<text text-anchor="middle" x="17046.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_61 -->
<g id="node201" class="node">
<title>expert3_61</title>
<polygon fill="#e6ffe6" stroke="black" points="17314.5,-844 17093.5,-844 17093.5,-776 17314.5,-776 17314.5,-844"/>
<text text-anchor="middle" x="17204" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 61</text>
<text text-anchor="middle" x="17204" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17204" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="17204" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;190</text>
</g>
<!-- router3&#45;&gt;expert3_61 -->
<g id="edge324" class="edge">
<title>router3&#45;&gt;expert3_61</title>
<path fill="none" stroke="black" d="M9001.67,-935.37C9961.5,-934.19 17137.07,-924.23 17180,-892 17191.8,-883.14 17198.03,-868.74 17201.25,-854.52"/>
<polygon fill="black" stroke="black" points="17204.76,-854.74 17203.1,-844.28 17197.88,-853.5 17204.76,-854.74"/>
<text text-anchor="middle" x="17328.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 61</text>
<text text-anchor="middle" x="17328.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_62 -->
<g id="node202" class="node">
<title>expert3_62</title>
<polygon fill="#e6ffe6" stroke="black" points="17596.5,-844 17375.5,-844 17375.5,-776 17596.5,-776 17596.5,-844"/>
<text text-anchor="middle" x="17486" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 62</text>
<text text-anchor="middle" x="17486" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17486" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="17486" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;191</text>
</g>
<!-- router3&#45;&gt;expert3_62 -->
<g id="edge325" class="edge">
<title>router3&#45;&gt;expert3_62</title>
<path fill="none" stroke="black" d="M9001.79,-935.39C9980.28,-934.35 17417.56,-925.36 17462,-892 17473.8,-883.14 17480.03,-868.74 17483.25,-854.52"/>
<polygon fill="black" stroke="black" points="17486.77,-854.74 17485.1,-844.28 17479.88,-853.5 17486.77,-854.74"/>
<text text-anchor="middle" x="17610.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 62</text>
<text text-anchor="middle" x="17610.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert3_63 -->
<g id="node203" class="node">
<title>expert3_63</title>
<polygon fill="#e6ffe6" stroke="black" points="17878.5,-844 17657.5,-844 17657.5,-776 17878.5,-776 17878.5,-844"/>
<text text-anchor="middle" x="17768" y="-828.8" font-family="Times,serif" font-size="14.00">Expert 63</text>
<text text-anchor="middle" x="17768" y="-813.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17768" y="-798.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="17768" y="-783.8" font-family="Times,serif" font-size="14.00">GPU&#45;192</text>
</g>
<!-- router3&#45;&gt;expert3_63 -->
<g id="edge326" class="edge">
<title>router3&#45;&gt;expert3_63</title>
<path fill="none" stroke="black" d="M9001.74,-935.41C9997.9,-934.52 17698.04,-926.5 17744,-892 17755.8,-883.14 17762.03,-868.74 17765.25,-854.52"/>
<polygon fill="black" stroke="black" points="17768.77,-854.74 17767.1,-844.28 17761.88,-853.5 17768.77,-854.74"/>
<text text-anchor="middle" x="17892.5" y="-880.8" font-family="Times,serif" font-size="14.00">tokens for expert 63</text>
<text text-anchor="middle" x="17892.5" y="-865.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- agg3 -->
<g id="node204" class="node">
<title>agg3</title>
<polygon fill="#e6ffe6" stroke="black" points="9005,-710 8787,-710 8787,-657 9005,-657 9005,-710"/>
<text text-anchor="middle" x="8896" y="-694.8" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8896" y="-679.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, hidden_size]</text>
<text text-anchor="middle" x="8896" y="-664.8" font-family="Times,serif" font-size="14.00">GPU&#45;129</text>
</g>
<!-- expert3_0&#45;&gt;agg3 -->
<g id="edge327" class="edge">
<title>expert3_0&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M209.68,-775.83C232.02,-757.9 262.14,-737.53 293,-728 399.17,-695.23 7747.15,-685.79 8776.69,-684.63"/>
<polygon fill="black" stroke="black" points="8776.7,-688.13 8786.7,-684.62 8776.7,-681.13 8776.7,-688.13"/>
<text text-anchor="middle" x="391.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 0</text>
<text text-anchor="middle" x="391.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_1&#45;&gt;agg3 -->
<g id="edge328" class="edge">
<title>expert3_1&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M467.03,-775.82C489.58,-757.9 519.94,-737.52 551,-728 653.92,-696.44 7764.96,-685.98 8776.75,-684.65"/>
<polygon fill="black" stroke="black" points="8776.94,-688.15 8786.94,-684.64 8776.94,-681.15 8776.94,-688.15"/>
<text text-anchor="middle" x="649.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 1</text>
<text text-anchor="middle" x="649.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_2&#45;&gt;agg3 -->
<g id="edge329" class="edge">
<title>expert3_2&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M721.02,-775.98C747.22,-757.98 782.24,-737.49 817,-728 917.41,-700.59 7783.12,-686.6 8776.68,-684.72"/>
<polygon fill="black" stroke="black" points="8776.7,-688.22 8786.7,-684.7 8776.69,-681.22 8776.7,-688.22"/>
<text text-anchor="middle" x="915.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 2</text>
<text text-anchor="middle" x="915.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_3&#45;&gt;agg3 -->
<g id="edge330" class="edge">
<title>expert3_3&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M978.03,-775.92C1011.82,-757.9 1056.43,-737.4 1099,-728 1294.79,-684.76 7810.74,-684.3 8776.78,-684.47"/>
<polygon fill="black" stroke="black" points="8776.87,-687.97 8786.87,-684.47 8776.87,-680.97 8776.87,-687.97"/>
<text text-anchor="middle" x="1197.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 3</text>
<text text-anchor="middle" x="1197.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_4&#45;&gt;agg3 -->
<g id="edge331" class="edge">
<title>expert3_4&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M1260.03,-775.92C1293.82,-757.9 1338.43,-737.41 1381,-728 1569.41,-686.36 7830.32,-684.53 8776.68,-684.49"/>
<polygon fill="black" stroke="black" points="8776.9,-687.99 8786.9,-684.49 8776.9,-680.99 8776.9,-687.99"/>
<text text-anchor="middle" x="1479.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 4</text>
<text text-anchor="middle" x="1479.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_5&#45;&gt;agg3 -->
<g id="edge332" class="edge">
<title>expert3_5&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M1542.04,-775.92C1575.82,-757.91 1620.43,-737.41 1663,-728 1844.03,-687.97 7849.82,-684.78 8776.46,-684.52"/>
<polygon fill="black" stroke="black" points="8776.8,-688.02 8786.8,-684.52 8776.8,-681.02 8776.8,-688.02"/>
<text text-anchor="middle" x="1761.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 5</text>
<text text-anchor="middle" x="1761.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_6&#45;&gt;agg3 -->
<g id="edge333" class="edge">
<title>expert3_6&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M1824.04,-775.93C1857.82,-757.91 1902.43,-737.42 1945,-728 2118.69,-689.57 7872.37,-685.03 8776.86,-684.55"/>
<polygon fill="black" stroke="black" points="8776.96,-688.05 8786.96,-684.55 8776.96,-681.05 8776.96,-688.05"/>
<text text-anchor="middle" x="2043.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 6</text>
<text text-anchor="middle" x="2043.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_7&#45;&gt;agg3 -->
<g id="edge334" class="edge">
<title>expert3_7&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M2106.04,-775.93C2139.82,-757.92 2184.44,-737.42 2227,-728 2393.31,-691.18 7892.16,-685.29 8776.51,-684.58"/>
<polygon fill="black" stroke="black" points="8776.7,-688.08 8786.7,-684.58 8776.7,-681.08 8776.7,-688.08"/>
<text text-anchor="middle" x="2325.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 7</text>
<text text-anchor="middle" x="2325.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_8&#45;&gt;agg3 -->
<g id="edge335" class="edge">
<title>expert3_8&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M2388.04,-775.94C2421.83,-757.92 2466.44,-737.43 2509,-728 2667.96,-692.79 7913.84,-685.57 8776.5,-684.62"/>
<polygon fill="black" stroke="black" points="8776.75,-688.12 8786.75,-684.61 8776.75,-681.12 8776.75,-688.12"/>
<text text-anchor="middle" x="2607.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 8</text>
<text text-anchor="middle" x="2607.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_9&#45;&gt;agg3 -->
<g id="edge336" class="edge">
<title>expert3_9&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M2670.04,-775.94C2703.83,-757.93 2748.44,-737.43 2791,-728 2942.62,-694.39 7936.07,-685.86 8776.5,-684.66"/>
<polygon fill="black" stroke="black" points="8776.8,-688.16 8786.79,-684.64 8776.79,-681.16 8776.8,-688.16"/>
<text text-anchor="middle" x="2889.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 9</text>
<text text-anchor="middle" x="2889.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_10&#45;&gt;agg3 -->
<g id="edge337" class="edge">
<title>expert3_10&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M2952.04,-775.95C2985.83,-757.94 3030.44,-737.44 3073,-728 3217.3,-695.99 7960.2,-686.16 8776.86,-684.7"/>
<polygon fill="black" stroke="black" points="8776.87,-688.2 8786.86,-684.68 8776.86,-681.2 8776.87,-688.2"/>
<text text-anchor="middle" x="3171.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 10</text>
<text text-anchor="middle" x="3171.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_11&#45;&gt;agg3 -->
<g id="edge338" class="edge">
<title>expert3_11&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M3234.04,-775.95C3267.83,-757.94 3312.44,-737.45 3355,-728 3491.96,-697.59 7982.83,-686.48 8776.69,-684.75"/>
<polygon fill="black" stroke="black" points="8776.71,-688.25 8786.7,-684.73 8776.7,-681.25 8776.71,-688.25"/>
<text text-anchor="middle" x="3453.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 11</text>
<text text-anchor="middle" x="3453.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_12&#45;&gt;agg3 -->
<g id="edge339" class="edge">
<title>expert3_12&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M3516.04,-775.96C3549.83,-757.95 3594.44,-737.46 3637,-728 3766.64,-699.18 8006.78,-686.81 8776.71,-684.8"/>
<polygon fill="black" stroke="black" points="8776.98,-688.3 8786.97,-684.77 8776.96,-681.3 8776.98,-688.3"/>
<text text-anchor="middle" x="3735.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 12</text>
<text text-anchor="middle" x="3735.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_13&#45;&gt;agg3 -->
<g id="edge340" class="edge">
<title>expert3_13&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M3798.04,-775.97C3831.83,-757.96 3876.45,-737.47 3919,-728 4041.33,-700.78 8030.99,-687.17 8776.62,-684.86"/>
<polygon fill="black" stroke="black" points="8776.84,-688.36 8786.83,-684.82 8776.82,-681.36 8776.84,-688.36"/>
<text text-anchor="middle" x="4017.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 13</text>
<text text-anchor="middle" x="4017.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_14&#45;&gt;agg3 -->
<g id="edge341" class="edge">
<title>expert3_14&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M4080.05,-775.97C4113.84,-757.97 4158.45,-737.48 4201,-728 4316.03,-702.37 8056.91,-687.54 8776.81,-684.92"/>
<polygon fill="black" stroke="black" points="8776.95,-688.42 8786.94,-684.88 8776.92,-681.42 8776.95,-688.42"/>
<text text-anchor="middle" x="4299.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 14</text>
<text text-anchor="middle" x="4299.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_15&#45;&gt;agg3 -->
<g id="edge342" class="edge">
<title>expert3_15&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M4362.05,-775.98C4395.84,-757.99 4440.45,-737.49 4483,-728 4698.14,-680 8093.37,-683.15 8776.72,-684.27"/>
<polygon fill="black" stroke="black" points="8776.82,-687.77 8786.83,-684.29 8776.83,-680.77 8776.82,-687.77"/>
<text text-anchor="middle" x="4581.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 15</text>
<text text-anchor="middle" x="4581.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_16&#45;&gt;agg3 -->
<g id="edge343" class="edge">
<title>expert3_16&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M4644.05,-775.99C4677.84,-758 4722.46,-737.51 4765,-728 4965.57,-683.18 8119.18,-683.75 8776.52,-684.36"/>
<polygon fill="black" stroke="black" points="8776.94,-687.86 8786.95,-684.37 8776.95,-680.86 8776.94,-687.86"/>
<text text-anchor="middle" x="4863.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 16</text>
<text text-anchor="middle" x="4863.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_17&#45;&gt;agg3 -->
<g id="edge344" class="edge">
<title>expert3_17&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M4926.45,-775.8C4960.19,-757.86 5004.62,-737.49 5047,-728 5233.03,-686.35 8146.12,-684.39 8776.36,-684.45"/>
<polygon fill="black" stroke="black" points="8776.82,-687.95 8786.82,-684.46 8776.82,-680.95 8776.82,-687.95"/>
<text text-anchor="middle" x="5145.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 17</text>
<text text-anchor="middle" x="5145.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_18&#45;&gt;agg3 -->
<g id="edge345" class="edge">
<title>expert3_18&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M5208.45,-775.81C5242.2,-757.88 5286.63,-737.51 5329,-728 5500.54,-689.52 8174.81,-685.08 8776.44,-684.57"/>
<polygon fill="black" stroke="black" points="8776.86,-688.07 8786.86,-684.56 8776.86,-681.07 8776.86,-688.07"/>
<text text-anchor="middle" x="5427.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 18</text>
<text text-anchor="middle" x="5427.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_19&#45;&gt;agg3 -->
<g id="edge346" class="edge">
<title>expert3_19&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M5490.45,-775.83C5524.2,-757.9 5568.63,-737.53 5611,-728 5768.11,-692.67 8205.08,-685.82 8776.67,-684.7"/>
<polygon fill="black" stroke="black" points="8777,-688.2 8786.99,-684.68 8776.99,-681.2 8777,-688.2"/>
<text text-anchor="middle" x="5709.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 19</text>
<text text-anchor="middle" x="5709.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_20&#45;&gt;agg3 -->
<g id="edge347" class="edge">
<title>expert3_20&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M5772.46,-775.85C5806.21,-757.93 5850.64,-737.55 5893,-728 6035.7,-695.82 8236.42,-686.63 8776.85,-684.85"/>
<polygon fill="black" stroke="black" points="8777.01,-688.35 8787,-684.82 8776.99,-681.35 8777.01,-688.35"/>
<text text-anchor="middle" x="5991.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 20</text>
<text text-anchor="middle" x="5991.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_21&#45;&gt;agg3 -->
<g id="edge348" class="edge">
<title>expert3_21&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M6054.46,-775.87C6088.22,-757.96 6132.65,-737.59 6175,-728 6303.29,-698.96 8267.83,-687.53 8776.49,-685.04"/>
<polygon fill="black" stroke="black" points="8776.8,-688.54 8786.78,-684.99 8776.76,-681.54 8776.8,-688.54"/>
<text text-anchor="middle" x="6273.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 21</text>
<text text-anchor="middle" x="6273.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_22&#45;&gt;agg3 -->
<g id="edge349" class="edge">
<title>expert3_22&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M6336.13,-775.9C6369.68,-758 6413.86,-737.63 6456,-728 6569.97,-701.97 8301.64,-688.49 8776.41,-685.27"/>
<polygon fill="black" stroke="black" points="8776.74,-688.76 8786.71,-685.2 8776.69,-681.76 8776.74,-688.76"/>
<text text-anchor="middle" x="6554.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 22</text>
<text text-anchor="middle" x="6554.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_23&#45;&gt;agg3 -->
<g id="edge350" class="edge">
<title>expert3_23&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M6617.45,-775.94C6650.61,-758.05 6694.29,-737.67 6736,-728 6934.55,-681.95 8353.09,-682.74 8776.79,-684.03"/>
<polygon fill="black" stroke="black" points="8776.91,-687.53 8786.92,-684.06 8776.93,-680.53 8776.91,-687.53"/>
<text text-anchor="middle" x="6834.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 23</text>
<text text-anchor="middle" x="6834.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_24&#45;&gt;agg3 -->
<g id="edge351" class="edge">
<title>expert3_24&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M6898.78,-775.98C6931.54,-758.11 6974.72,-737.74 7016,-728 7186.33,-687.83 8390.12,-684.43 8776.76,-684.39"/>
<polygon fill="black" stroke="black" points="8776.85,-687.89 8786.85,-684.39 8776.85,-680.89 8776.85,-687.89"/>
<text text-anchor="middle" x="7114.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 24</text>
<text text-anchor="middle" x="7114.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_25&#45;&gt;agg3 -->
<g id="edge352" class="edge">
<title>expert3_25&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M7179.45,-775.83C7211.18,-758.03 7252.93,-737.78 7293,-728 7435.49,-693.23 8429.63,-686.23 8776.73,-684.84"/>
<polygon fill="black" stroke="black" points="8776.83,-688.34 8786.81,-684.8 8776.8,-681.34 8776.83,-688.34"/>
<text text-anchor="middle" x="7391.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 25</text>
<text text-anchor="middle" x="7391.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_26&#45;&gt;agg3 -->
<g id="edge353" class="edge">
<title>expert3_26&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M7458.39,-775.92C7488.94,-758.14 7529.19,-737.89 7568,-728 7683.07,-698.69 8472.2,-688.39 8776.59,-685.48"/>
<polygon fill="black" stroke="black" points="8776.81,-688.98 8786.78,-685.38 8776.74,-681.98 8776.81,-688.98"/>
<text text-anchor="middle" x="7666.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 26</text>
<text text-anchor="middle" x="7666.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_27&#45;&gt;agg3 -->
<g id="edge354" class="edge">
<title>expert3_27&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M7736.29,-775.82C7764.81,-758.13 7802.41,-738 7839,-728 7927.29,-703.87 8518.95,-690.95 8776.55,-686.4"/>
<polygon fill="black" stroke="black" points="8776.75,-689.9 8786.69,-686.23 8776.63,-682.9 8776.75,-689.9"/>
<text text-anchor="middle" x="7937.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 27</text>
<text text-anchor="middle" x="7937.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_28&#45;&gt;agg3 -->
<g id="edge355" class="edge">
<title>expert3_28&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M8010.71,-775.99C8036.07,-758.35 8069.68,-738.22 8103,-728 8225.3,-690.49 8586.93,-684.5 8776.69,-684.05"/>
<polygon fill="black" stroke="black" points="8776.71,-687.55 8786.71,-684.03 8776.7,-680.55 8776.71,-687.55"/>
<text text-anchor="middle" x="8201.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 28</text>
<text text-anchor="middle" x="8201.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_29&#45;&gt;agg3 -->
<g id="edge356" class="edge">
<title>expert3_29&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M8280.73,-775.65C8301.62,-758.25 8329.44,-738.47 8358,-728 8432.12,-700.83 8641.72,-690.58 8776.35,-686.75"/>
<polygon fill="black" stroke="black" points="8776.82,-690.24 8786.72,-686.46 8776.63,-683.24 8776.82,-690.24"/>
<text text-anchor="middle" x="8456.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 29</text>
<text text-anchor="middle" x="8456.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_30&#45;&gt;agg3 -->
<g id="edge357" class="edge">
<title>expert3_30&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M8542.24,-775.85C8557.13,-758.74 8577.44,-739.16 8600,-728 8630.78,-712.77 8708.75,-701.66 8776.94,-694.49"/>
<polygon fill="black" stroke="black" points="8777.34,-697.97 8786.92,-693.46 8776.62,-691 8777.34,-697.97"/>
<text text-anchor="middle" x="8698.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 30</text>
<text text-anchor="middle" x="8698.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_31&#45;&gt;agg3 -->
<g id="edge358" class="edge">
<title>expert3_31&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M8794.05,-775.87C8798.75,-760 8806.27,-741.54 8818,-728 8821.68,-723.75 8825.88,-719.83 8830.38,-716.24"/>
<polygon fill="black" stroke="black" points="8832.76,-718.84 8838.76,-710.11 8828.62,-713.19 8832.76,-718.84"/>
<text text-anchor="middle" x="8916.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 31</text>
<text text-anchor="middle" x="8916.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_32&#45;&gt;agg3 -->
<g id="edge359" class="edge">
<title>expert3_32&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M9040.62,-775.83C9035.97,-759.56 9028.1,-740.77 9015,-728 9010.13,-723.26 9004.7,-719.02 8998.92,-715.25"/>
<polygon fill="black" stroke="black" points="9000.6,-712.17 8990.23,-710.03 8997,-718.18 9000.6,-712.17"/>
<text text-anchor="middle" x="9132.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 32</text>
<text text-anchor="middle" x="9132.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_33&#45;&gt;agg3 -->
<g id="edge360" class="edge">
<title>expert3_33&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M9292.84,-775.68C9277.98,-758.53 9257.66,-738.96 9235,-728 9197.16,-709.7 9097.36,-698.33 9015.77,-691.83"/>
<polygon fill="black" stroke="black" points="9015.65,-688.31 9005.41,-691.02 9015.11,-695.29 9015.65,-688.31"/>
<text text-anchor="middle" x="9373.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 33</text>
<text text-anchor="middle" x="9373.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_34&#45;&gt;agg3 -->
<g id="edge361" class="edge">
<title>expert3_34&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M9557.36,-775.8C9535.25,-758.33 9505.84,-738.43 9476,-728 9393.91,-699.31 9159.73,-689.53 9015.27,-686.21"/>
<polygon fill="black" stroke="black" points="9015.11,-682.7 9005.03,-685.98 9014.95,-689.7 9015.11,-682.7"/>
<text text-anchor="middle" x="9629.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 34</text>
<text text-anchor="middle" x="9629.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_35&#45;&gt;agg3 -->
<g id="edge362" class="edge">
<title>expert3_35&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M9828.83,-775.96C9802.08,-758.31 9766.72,-738.18 9732,-728 9601.26,-689.67 9213.6,-684.15 9015.48,-683.94"/>
<polygon fill="black" stroke="black" points="9015.33,-680.44 9005.32,-683.94 9015.32,-687.44 9015.33,-680.44"/>
<text text-anchor="middle" x="9895.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 35</text>
<text text-anchor="middle" x="9895.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_36&#45;&gt;agg3 -->
<g id="edge363" class="edge">
<title>expert3_36&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M10104.62,-775.8C10074.9,-758.1 10035.81,-737.97 9998,-728 9905.12,-703.5 9280.73,-690.68 9015.17,-686.28"/>
<polygon fill="black" stroke="black" points="9015.16,-682.78 9005.1,-686.12 9015.04,-689.78 9015.16,-682.78"/>
<text text-anchor="middle" x="10167.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 36</text>
<text text-anchor="middle" x="10167.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_37&#45;&gt;agg3 -->
<g id="edge364" class="edge">
<title>expert3_37&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M10382.88,-775.9C10351.34,-758.12 10309.84,-737.87 10270,-728 10150.25,-698.34 9327.53,-688.21 9015.58,-685.42"/>
<polygon fill="black" stroke="black" points="9015.18,-681.91 9005.15,-685.32 9015.12,-688.91 9015.18,-681.91"/>
<text text-anchor="middle" x="10443.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 37</text>
<text text-anchor="middle" x="10443.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_38&#45;&gt;agg3 -->
<g id="edge365" class="edge">
<title>expert3_38&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M10662.83,-775.82C10630.1,-758.01 10587.1,-737.76 10546,-728 10398.61,-692.99 9368.85,-686.14 9015.04,-684.81"/>
<polygon fill="black" stroke="black" points="9015.04,-681.31 9005.02,-684.78 9015.01,-688.31 9015.04,-681.31"/>
<text text-anchor="middle" x="10722.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 38</text>
<text text-anchor="middle" x="10722.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_39&#45;&gt;agg3 -->
<g id="edge366" class="edge">
<title>expert3_39&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M10944.2,-775.97C10910.84,-758.1 10866.91,-737.72 10825,-728 10649.63,-687.31 9408.58,-684.28 9015.26,-684.36"/>
<polygon fill="black" stroke="black" points="9015,-680.86 9005,-684.36 9015,-687.86 9015,-680.86"/>
<text text-anchor="middle" x="11002.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 39</text>
<text text-anchor="middle" x="11002.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_40&#45;&gt;agg3 -->
<g id="edge367" class="edge">
<title>expert3_40&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M11225.52,-775.93C11191.77,-758.04 11147.34,-737.66 11105,-728 10901.38,-681.52 9445.38,-682.64 9015.32,-684.01"/>
<polygon fill="black" stroke="black" points="9015.03,-680.51 9005.04,-684.04 9015.05,-687.51 9015.03,-680.51"/>
<text text-anchor="middle" x="11283.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 40</text>
<text text-anchor="middle" x="11283.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_41&#45;&gt;agg3 -->
<g id="edge368" class="edge">
<title>expert3_41&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M11507.19,-775.89C11473.24,-757.99 11428.56,-737.62 11386,-728 11269.41,-701.65 9495.69,-688.36 9015.24,-685.23"/>
<polygon fill="black" stroke="black" points="9015.18,-681.73 9005.16,-685.17 9015.14,-688.73 9015.18,-681.73"/>
<text text-anchor="middle" x="11564.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 41</text>
<text text-anchor="middle" x="11564.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_42&#45;&gt;agg3 -->
<g id="edge369" class="edge">
<title>expert3_42&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M11788.85,-775.87C11754.71,-757.95 11709.77,-737.58 11667,-728 11536.08,-698.68 9529.13,-687.43 9015.17,-685.02"/>
<polygon fill="black" stroke="black" points="9015.15,-681.52 9005.14,-684.97 9015.12,-688.52 9015.15,-681.52"/>
<text text-anchor="middle" x="11846.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 42</text>
<text text-anchor="middle" x="11846.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_43&#45;&gt;agg3 -->
<g id="edge370" class="edge">
<title>expert3_43&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M12070.86,-775.84C12036.71,-757.92 11991.78,-737.55 11949,-728 11803.69,-695.57 9561.59,-686.56 9015.32,-684.84"/>
<polygon fill="black" stroke="black" points="9015.07,-681.34 9005.05,-684.81 9015.04,-688.34 9015.07,-681.34"/>
<text text-anchor="middle" x="12128.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 43</text>
<text text-anchor="middle" x="12128.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_44&#45;&gt;agg3 -->
<g id="edge371" class="edge">
<title>expert3_44&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M12352.86,-775.82C12318.72,-757.89 12273.78,-737.52 12231,-728 12071.25,-692.45 9592.12,-685.76 9015.28,-684.69"/>
<polygon fill="black" stroke="black" points="9015.29,-681.19 9005.28,-684.67 9015.27,-688.19 9015.29,-681.19"/>
<text text-anchor="middle" x="12410.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 44</text>
<text text-anchor="middle" x="12410.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_45&#45;&gt;agg3 -->
<g id="edge372" class="edge">
<title>expert3_45&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M12634.87,-775.81C12600.72,-757.87 12555.79,-737.5 12513,-728 12338.78,-689.32 9621.5,-685.03 9015.29,-684.56"/>
<polygon fill="black" stroke="black" points="9015.23,-681.06 9005.22,-684.55 9015.22,-688.06 9015.23,-681.06"/>
<text text-anchor="middle" x="12692.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 45</text>
<text text-anchor="middle" x="12692.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_46&#45;&gt;agg3 -->
<g id="edge373" class="edge">
<title>expert3_46&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M12916.87,-775.79C12882.73,-757.85 12837.79,-737.48 12795,-728 12606.26,-686.18 9649.32,-684.36 9015.16,-684.45"/>
<polygon fill="black" stroke="black" points="9015.09,-680.95 9005.09,-684.45 9015.09,-687.95 9015.09,-680.95"/>
<text text-anchor="middle" x="12974.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 46</text>
<text text-anchor="middle" x="12974.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_47&#45;&gt;agg3 -->
<g id="edge374" class="edge">
<title>expert3_47&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M13199.27,-775.99C13165.08,-758 13119.96,-737.5 13077,-728 12873.72,-683.04 9676.3,-683.73 9015.09,-684.36"/>
<polygon fill="black" stroke="black" points="9015.07,-680.86 9005.07,-684.37 9015.07,-687.86 9015.07,-680.86"/>
<text text-anchor="middle" x="13256.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 47</text>
<text text-anchor="middle" x="13256.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_48&#45;&gt;agg3 -->
<g id="edge375" class="edge">
<title>expert3_48&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M13481.27,-775.98C13447.08,-757.98 13401.97,-737.49 13359,-728 13141.17,-679.9 9703.07,-683.14 9015.23,-684.27"/>
<polygon fill="black" stroke="black" points="9015.05,-680.77 9005.06,-684.29 9015.07,-687.77 9015.05,-680.77"/>
<text text-anchor="middle" x="13538.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 48</text>
<text text-anchor="middle" x="13538.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_49&#45;&gt;agg3 -->
<g id="edge376" class="edge">
<title>expert3_49&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M13763.27,-775.97C13729.09,-757.97 13683.97,-737.48 13641,-728 13524.62,-702.34 9739.94,-687.52 9015.28,-684.92"/>
<polygon fill="black" stroke="black" points="9015.11,-681.41 9005.09,-684.88 9015.08,-688.41 9015.11,-681.41"/>
<text text-anchor="middle" x="13820.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 49</text>
<text text-anchor="middle" x="13820.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_50&#45;&gt;agg3 -->
<g id="edge377" class="edge">
<title>expert3_50&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M14045.28,-775.96C14011.09,-757.96 13965.97,-737.46 13923,-728 13799.32,-700.76 9765.37,-687.15 9015.37,-684.85"/>
<polygon fill="black" stroke="black" points="9015.11,-681.35 9005.1,-684.82 9015.09,-688.35 9015.11,-681.35"/>
<text text-anchor="middle" x="14102.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 50</text>
<text text-anchor="middle" x="14102.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_51&#45;&gt;agg3 -->
<g id="edge378" class="edge">
<title>expert3_51&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M14327.28,-775.96C14293.09,-757.95 14247.97,-737.46 14205,-728 14073.99,-699.18 9789.18,-686.8 9015.21,-684.8"/>
<polygon fill="black" stroke="black" points="9015.17,-681.3 9005.16,-684.77 9015.15,-688.3 9015.17,-681.3"/>
<text text-anchor="middle" x="14384.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 51</text>
<text text-anchor="middle" x="14384.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_52&#45;&gt;agg3 -->
<g id="edge379" class="edge">
<title>expert3_52&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M14609.28,-775.95C14575.09,-757.94 14529.98,-737.45 14487,-728 14348.66,-697.59 9812.57,-686.47 9015.11,-684.74"/>
<polygon fill="black" stroke="black" points="9015.06,-681.24 9005.05,-684.72 9015.04,-688.24 9015.06,-681.24"/>
<text text-anchor="middle" x="14666.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 52</text>
<text text-anchor="middle" x="14666.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_53&#45;&gt;agg3 -->
<g id="edge380" class="edge">
<title>expert3_53&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M14891.28,-775.94C14857.09,-757.93 14811.98,-737.44 14769,-728 14623.33,-696.01 9836.01,-686.16 9015.18,-684.7"/>
<polygon fill="black" stroke="black" points="9015.13,-681.2 9005.12,-684.68 9015.12,-688.2 9015.13,-681.2"/>
<text text-anchor="middle" x="14948.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 53</text>
<text text-anchor="middle" x="14948.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_54&#45;&gt;agg3 -->
<g id="edge381" class="edge">
<title>expert3_54&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M15173.28,-775.94C15139.1,-757.92 15093.98,-737.43 15051,-728 14897.99,-694.43 9858.53,-685.86 9015.16,-684.66"/>
<polygon fill="black" stroke="black" points="9015.14,-681.16 9005.13,-684.64 9015.13,-688.16 9015.14,-681.16"/>
<text text-anchor="middle" x="15230.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 54</text>
<text text-anchor="middle" x="15230.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_55&#45;&gt;agg3 -->
<g id="edge382" class="edge">
<title>expert3_55&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M15455.28,-775.93C15421.1,-757.92 15375.98,-737.42 15333,-728 15172.65,-692.84 9881.63,-685.58 9015.4,-684.62"/>
<polygon fill="black" stroke="black" points="9015.11,-681.12 9005.11,-684.61 9015.11,-688.12 9015.11,-681.12"/>
<text text-anchor="middle" x="15512.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 55</text>
<text text-anchor="middle" x="15512.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_56&#45;&gt;agg3 -->
<g id="edge383" class="edge">
<title>expert3_56&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M15737.28,-775.93C15703.1,-757.91 15657.98,-737.42 15615,-728 15447.29,-691.25 9902.95,-685.3 9015.32,-684.59"/>
<polygon fill="black" stroke="black" points="9015.1,-681.09 9005.1,-684.58 9015.09,-688.09 9015.1,-681.09"/>
<text text-anchor="middle" x="15794.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 56</text>
<text text-anchor="middle" x="15794.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_57&#45;&gt;agg3 -->
<g id="edge384" class="edge">
<title>expert3_57&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M16019.28,-775.92C15985.1,-757.91 15939.98,-737.41 15897,-728 15721.93,-689.66 9923.92,-685.04 9015.27,-684.55"/>
<polygon fill="black" stroke="black" points="9015.13,-681.05 9005.13,-684.55 9015.13,-688.05 9015.13,-681.05"/>
<text text-anchor="middle" x="16076.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 57</text>
<text text-anchor="middle" x="16076.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_58&#45;&gt;agg3 -->
<g id="edge385" class="edge">
<title>expert3_58&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M16301.29,-775.92C16267.1,-757.9 16221.98,-737.41 16179,-728 15996.56,-688.07 9944.73,-684.79 9015.28,-684.52"/>
<polygon fill="black" stroke="black" points="9015.24,-681.02 9005.24,-684.52 9015.24,-688.02 9015.24,-681.02"/>
<text text-anchor="middle" x="16358.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 58</text>
<text text-anchor="middle" x="16358.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_59&#45;&gt;agg3 -->
<g id="edge386" class="edge">
<title>expert3_59&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M16583.29,-775.92C16549.1,-757.9 16503.99,-737.4 16461,-728 16271.19,-686.48 9965.44,-684.55 9015.36,-684.5"/>
<polygon fill="black" stroke="black" points="9015.1,-681 9005.1,-684.5 9015.1,-688 9015.1,-681"/>
<text text-anchor="middle" x="16640.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 59</text>
<text text-anchor="middle" x="16640.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_60&#45;&gt;agg3 -->
<g id="edge387" class="edge">
<title>expert3_60&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M16865.29,-775.91C16831.1,-757.89 16785.99,-737.4 16743,-728 16545.81,-684.89 9984.76,-684.32 9015.21,-684.47"/>
<polygon fill="black" stroke="black" points="9015.09,-680.97 9005.09,-684.47 9015.09,-687.97 9015.09,-680.97"/>
<text text-anchor="middle" x="16922.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 60</text>
<text text-anchor="middle" x="16922.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_61&#45;&gt;agg3 -->
<g id="edge388" class="edge">
<title>expert3_61&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M17147.29,-775.91C17113.1,-757.89 17067.99,-737.39 17025,-728 16820.45,-683.3 10006.02,-684.1 9015.57,-684.45"/>
<polygon fill="black" stroke="black" points="9015.23,-680.95 9005.23,-684.45 9015.24,-687.95 9015.23,-680.95"/>
<text text-anchor="middle" x="17204.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 61</text>
<text text-anchor="middle" x="17204.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_62&#45;&gt;agg3 -->
<g id="edge389" class="edge">
<title>expert3_62&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M17429.29,-775.91C17395.1,-757.88 17349.99,-737.39 17307,-728 17095.04,-681.7 10024.28,-683.88 9015.34,-684.43"/>
<polygon fill="black" stroke="black" points="9015.18,-680.93 9005.18,-684.43 9015.18,-687.93 9015.18,-680.93"/>
<text text-anchor="middle" x="17486.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 62</text>
<text text-anchor="middle" x="17486.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert3_63&#45;&gt;agg3 -->
<g id="edge390" class="edge">
<title>expert3_63&#45;&gt;agg3</title>
<path fill="none" stroke="black" d="M17711.29,-775.9C17677.11,-757.88 17631.99,-737.39 17589,-728 17369.67,-680.11 10044.86,-683.67 9015.68,-684.4"/>
<polygon fill="black" stroke="black" points="9015.31,-680.9 9005.32,-684.41 9015.32,-687.9 9015.31,-680.9"/>
<text text-anchor="middle" x="17772.5" y="-746.8" font-family="Times,serif" font-size="14.00">expert output 63</text>
<text text-anchor="middle" x="17772.5" y="-731.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- pre_layer4_norm -->
<g id="node205" class="node">
<title>pre_layer4_norm</title>
<polygon fill="#fff0e6" stroke="black" points="9005,-599 8787,-599 8787,-546 9005,-546 9005,-599"/>
<text text-anchor="middle" x="8896" y="-583.8" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8896" y="-568.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, hidden_size]</text>
<text text-anchor="middle" x="8896" y="-553.8" font-family="Times,serif" font-size="14.00">GPU&#45;193</text>
</g>
<!-- agg3&#45;&gt;pre_layer4_norm -->
<g id="edge524" class="edge">
<title>agg3&#45;&gt;pre_layer4_norm</title>
<path fill="none" stroke="black" d="M8896,-656.94C8896,-642.83 8896,-625.08 8896,-609.57"/>
<polygon fill="black" stroke="black" points="8899.5,-609.27 8896,-599.27 8892.5,-609.27 8899.5,-609.27"/>
</g>
<!-- pre_layer4_attn -->
<g id="node206" class="node">
<title>pre_layer4_attn</title>
<polygon fill="#fff0e6" stroke="black" points="9005,-509 8787,-509 8787,-456 9005,-456 9005,-509"/>
<text text-anchor="middle" x="8896" y="-493.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="8896" y="-478.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, hidden_size]</text>
<text text-anchor="middle" x="8896" y="-463.8" font-family="Times,serif" font-size="14.00">GPU&#45;193</text>
</g>
<!-- pre_layer4_norm&#45;&gt;pre_layer4_attn -->
<g id="edge391" class="edge">
<title>pre_layer4_norm&#45;&gt;pre_layer4_attn</title>
<path fill="none" stroke="black" d="M8896,-545.57C8896,-537.34 8896,-528.08 8896,-519.28"/>
<polygon fill="black" stroke="black" points="8899.5,-519.24 8896,-509.24 8892.5,-519.24 8899.5,-519.24"/>
</g>
<!-- router4 -->
<g id="node207" class="node">
<title>router4</title>
<polygon fill="#fff0e6" stroke="black" points="9001.5,-419 8790.5,-419 8790.5,-366 9001.5,-366 9001.5,-419"/>
<text text-anchor="middle" x="8896" y="-403.8" font-family="Times,serif" font-size="14.00">Router/Gating</text>
<text text-anchor="middle" x="8896" y="-388.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 64 experts]</text>
<text text-anchor="middle" x="8896" y="-373.8" font-family="Times,serif" font-size="14.00">GPU&#45;193</text>
</g>
<!-- pre_layer4_attn&#45;&gt;router4 -->
<g id="edge392" class="edge">
<title>pre_layer4_attn&#45;&gt;router4</title>
<path fill="none" stroke="black" d="M8896,-455.57C8896,-447.34 8896,-438.08 8896,-429.28"/>
<polygon fill="black" stroke="black" points="8899.5,-429.24 8896,-419.24 8892.5,-429.24 8899.5,-429.24"/>
</g>
<!-- expert4_0 -->
<g id="node208" class="node">
<title>expert4_0</title>
<polygon fill="#fff0e6" stroke="black" points="283.5,-300 62.5,-300 62.5,-232 283.5,-232 283.5,-300"/>
<text text-anchor="middle" x="173" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="173" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="173" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="173" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;193</text>
</g>
<!-- router4&#45;&gt;expert4_0 -->
<g id="edge393" class="edge">
<title>router4&#45;&gt;expert4_0</title>
<path fill="none" stroke="black" d="M8790.27,-391.48C7798.26,-391.28 159.2,-388.4 119,-348 107.34,-336.28 112.47,-321.7 123.27,-308.14"/>
<polygon fill="black" stroke="black" points="126.19,-310.12 130.19,-300.31 120.95,-305.48 126.19,-310.12"/>
<text text-anchor="middle" x="248.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 0</text>
<text text-anchor="middle" x="248.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_1 -->
<g id="node209" class="node">
<title>expert4_1</title>
<polygon fill="#fff0e6" stroke="black" points="540.5,-300 319.5,-300 319.5,-232 540.5,-232 540.5,-300"/>
<text text-anchor="middle" x="430" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="430" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="430" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="430" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;194</text>
</g>
<!-- router4&#45;&gt;expert4_1 -->
<g id="edge394" class="edge">
<title>router4&#45;&gt;expert4_1</title>
<path fill="none" stroke="black" d="M8790.49,-391.47C7816.57,-391.11 427.92,-387.12 389,-348 378.05,-336.99 381.6,-322.45 390.12,-308.74"/>
<polygon fill="black" stroke="black" points="393.12,-310.54 395.98,-300.34 387.38,-306.54 393.12,-310.54"/>
<text text-anchor="middle" x="518.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 1</text>
<text text-anchor="middle" x="518.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_2 -->
<g id="node210" class="node">
<title>expert4_2</title>
<polygon fill="#fff0e6" stroke="black" points="788.5,-300 567.5,-300 567.5,-232 788.5,-232 788.5,-300"/>
<text text-anchor="middle" x="678" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="678" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="678" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="678" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;195</text>
</g>
<!-- router4&#45;&gt;expert4_2 -->
<g id="edge395" class="edge">
<title>router4&#45;&gt;expert4_2</title>
<path fill="none" stroke="black" d="M8790.13,-391.45C7832.4,-390.93 698.62,-385.82 661,-348 650.96,-337.9 651.24,-323.48 655.36,-309.6"/>
<polygon fill="black" stroke="black" points="658.67,-310.72 658.74,-300.13 652.08,-308.37 658.67,-310.72"/>
<text text-anchor="middle" x="790.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 2</text>
<text text-anchor="middle" x="790.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_3 -->
<g id="node211" class="node">
<title>expert4_3</title>
<polygon fill="#fff0e6" stroke="black" points="1032.5,-300 811.5,-300 811.5,-232 1032.5,-232 1032.5,-300"/>
<text text-anchor="middle" x="922" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="922" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="922" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="922" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;196</text>
</g>
<!-- router4&#45;&gt;expert4_3 -->
<g id="edge396" class="edge">
<title>router4&#45;&gt;expert4_3</title>
<path fill="none" stroke="black" d="M8790.16,-391.36C7851.39,-390.08 983.61,-379.6 943,-348 931.47,-339.03 925.76,-324.6 923.07,-310.39"/>
<polygon fill="black" stroke="black" points="926.49,-309.57 921.61,-300.16 919.56,-310.56 926.49,-309.57"/>
<text text-anchor="middle" x="1072.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 3</text>
<text text-anchor="middle" x="1072.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_4 -->
<g id="node212" class="node">
<title>expert4_4</title>
<polygon fill="#fff0e6" stroke="black" points="1314.5,-300 1093.5,-300 1093.5,-232 1314.5,-232 1314.5,-300"/>
<text text-anchor="middle" x="1204" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1204" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="1204" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="1204" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;197</text>
</g>
<!-- router4&#45;&gt;expert4_4 -->
<g id="edge397" class="edge">
<title>router4&#45;&gt;expert4_4</title>
<path fill="none" stroke="black" d="M8790.32,-391.34C7871.08,-389.89 1264.11,-378.44 1225,-348 1213.47,-339.02 1207.76,-324.6 1205.07,-310.39"/>
<polygon fill="black" stroke="black" points="1208.49,-309.57 1203.61,-300.16 1201.56,-310.56 1208.49,-309.57"/>
<text text-anchor="middle" x="1354.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 4</text>
<text text-anchor="middle" x="1354.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_5 -->
<g id="node213" class="node">
<title>expert4_5</title>
<polygon fill="#fff0e6" stroke="black" points="1596.5,-300 1375.5,-300 1375.5,-232 1596.5,-232 1596.5,-300"/>
<text text-anchor="middle" x="1486" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="1486" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="1486" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="1486" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;198</text>
</g>
<!-- router4&#45;&gt;expert4_5 -->
<g id="edge398" class="edge">
<title>router4&#45;&gt;expert4_5</title>
<path fill="none" stroke="black" d="M8790.34,-391.32C7890.41,-389.7 1544.62,-377.29 1507,-348 1495.47,-339.02 1489.76,-324.6 1487.07,-310.39"/>
<polygon fill="black" stroke="black" points="1490.49,-309.57 1485.61,-300.16 1483.56,-310.55 1490.49,-309.57"/>
<text text-anchor="middle" x="1636.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 5</text>
<text text-anchor="middle" x="1636.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_6 -->
<g id="node214" class="node">
<title>expert4_6</title>
<polygon fill="#fff0e6" stroke="black" points="1878.5,-300 1657.5,-300 1657.5,-232 1878.5,-232 1878.5,-300"/>
<text text-anchor="middle" x="1768" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1768" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="1768" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="1768" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;199</text>
</g>
<!-- router4&#45;&gt;expert4_6 -->
<g id="edge399" class="edge">
<title>router4&#45;&gt;expert4_6</title>
<path fill="none" stroke="black" d="M8790.24,-391.29C7909.55,-389.5 1825.12,-376.13 1789,-348 1777.47,-339.02 1771.76,-324.59 1769.07,-310.39"/>
<polygon fill="black" stroke="black" points="1772.49,-309.56 1767.61,-300.16 1765.56,-310.55 1772.49,-309.56"/>
<text text-anchor="middle" x="1918.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 6</text>
<text text-anchor="middle" x="1918.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_7 -->
<g id="node215" class="node">
<title>expert4_7</title>
<polygon fill="#fff0e6" stroke="black" points="2160.5,-300 1939.5,-300 1939.5,-232 2160.5,-232 2160.5,-300"/>
<text text-anchor="middle" x="2050" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2050" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="2050" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="2050" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;200</text>
</g>
<!-- router4&#45;&gt;expert4_7 -->
<g id="edge400" class="edge">
<title>router4&#45;&gt;expert4_7</title>
<path fill="none" stroke="black" d="M8790.39,-391.26C7930.25,-389.3 2105.63,-374.97 2071,-348 2059.47,-339.02 2053.76,-324.59 2051.08,-310.38"/>
<polygon fill="black" stroke="black" points="2054.49,-309.56 2049.61,-300.16 2047.56,-310.55 2054.49,-309.56"/>
<text text-anchor="middle" x="2200.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 7</text>
<text text-anchor="middle" x="2200.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_8 -->
<g id="node216" class="node">
<title>expert4_8</title>
<polygon fill="#fff0e6" stroke="black" points="2442.5,-300 2221.5,-300 2221.5,-232 2442.5,-232 2442.5,-300"/>
<text text-anchor="middle" x="2332" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="2332" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="2332" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="2332" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;201</text>
</g>
<!-- router4&#45;&gt;expert4_8 -->
<g id="edge401" class="edge">
<title>router4&#45;&gt;expert4_8</title>
<path fill="none" stroke="black" d="M8790.47,-391.24C7951.04,-389.08 2386.14,-373.82 2353,-348 2341.47,-339.02 2335.76,-324.59 2333.08,-310.38"/>
<polygon fill="black" stroke="black" points="2336.5,-309.56 2331.62,-300.16 2329.57,-310.55 2336.5,-309.56"/>
<text text-anchor="middle" x="2482.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 8</text>
<text text-anchor="middle" x="2482.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_9 -->
<g id="node217" class="node">
<title>expert4_9</title>
<polygon fill="#fff0e6" stroke="black" points="2724.5,-300 2503.5,-300 2503.5,-232 2724.5,-232 2724.5,-300"/>
<text text-anchor="middle" x="2614" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="2614" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="2614" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="2614" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;202</text>
</g>
<!-- router4&#45;&gt;expert4_9 -->
<g id="edge402" class="edge">
<title>router4&#45;&gt;expert4_9</title>
<path fill="none" stroke="black" d="M8790.44,-391.64C7974.19,-392.66 2698.28,-397.32 2635,-348 2623.47,-339.02 2617.76,-324.59 2615.08,-310.38"/>
<polygon fill="black" stroke="black" points="2618.5,-309.56 2613.62,-300.15 2611.57,-310.55 2618.5,-309.56"/>
<text text-anchor="middle" x="2764.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 9</text>
<text text-anchor="middle" x="2764.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_10 -->
<g id="node218" class="node">
<title>expert4_10</title>
<polygon fill="#fff0e6" stroke="black" points="3006.5,-300 2785.5,-300 2785.5,-232 3006.5,-232 3006.5,-300"/>
<text text-anchor="middle" x="2896" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="2896" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="2896" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="2896" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;203</text>
</g>
<!-- router4&#45;&gt;expert4_10 -->
<g id="edge403" class="edge">
<title>router4&#45;&gt;expert4_10</title>
<path fill="none" stroke="black" d="M8790.19,-391.61C7994.39,-392.33 2977.3,-395.01 2917,-348 2905.48,-339.02 2899.77,-324.59 2897.08,-310.38"/>
<polygon fill="black" stroke="black" points="2900.5,-309.56 2895.62,-300.15 2893.57,-310.55 2900.5,-309.56"/>
<text text-anchor="middle" x="3046.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 10</text>
<text text-anchor="middle" x="3046.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_11 -->
<g id="node219" class="node">
<title>expert4_11</title>
<polygon fill="#fff0e6" stroke="black" points="3288.5,-300 3067.5,-300 3067.5,-232 3288.5,-232 3288.5,-300"/>
<text text-anchor="middle" x="3178" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="3178" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="3178" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="3178" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;204</text>
</g>
<!-- router4&#45;&gt;expert4_11 -->
<g id="edge404" class="edge">
<title>router4&#45;&gt;expert4_11</title>
<path fill="none" stroke="black" d="M8790.3,-391.57C8016.66,-391.98 3256.32,-392.71 3199,-348 3187.48,-339.01 3181.77,-324.58 3179.08,-310.38"/>
<polygon fill="black" stroke="black" points="3182.5,-309.55 3177.62,-300.15 3175.57,-310.55 3182.5,-309.55"/>
<text text-anchor="middle" x="3328.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 11</text>
<text text-anchor="middle" x="3328.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_12 -->
<g id="node220" class="node">
<title>expert4_12</title>
<polygon fill="#fff0e6" stroke="black" points="3570.5,-300 3349.5,-300 3349.5,-232 3570.5,-232 3570.5,-300"/>
<text text-anchor="middle" x="3460" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="3460" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="3460" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="3460" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;205</text>
</g>
<!-- router4&#45;&gt;expert4_12 -->
<g id="edge405" class="edge">
<title>router4&#45;&gt;expert4_12</title>
<path fill="none" stroke="black" d="M8790.49,-391.53C8039.76,-391.62 3535.35,-390.41 3481,-348 3469.48,-339.01 3463.77,-324.58 3461.08,-310.37"/>
<polygon fill="black" stroke="black" points="3464.5,-309.55 3459.62,-300.15 3457.57,-310.54 3464.5,-309.55"/>
<text text-anchor="middle" x="3610.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 12</text>
<text text-anchor="middle" x="3610.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_13 -->
<g id="node221" class="node">
<title>expert4_13</title>
<polygon fill="#fff0e6" stroke="black" points="3852.5,-300 3631.5,-300 3631.5,-232 3852.5,-232 3852.5,-300"/>
<text text-anchor="middle" x="3742" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="3742" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="3742" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="3742" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;206</text>
</g>
<!-- router4&#45;&gt;expert4_13 -->
<g id="edge406" class="edge">
<title>router4&#45;&gt;expert4_13</title>
<path fill="none" stroke="black" d="M8790.22,-391.48C8061.64,-391.24 3814.38,-388.1 3763,-348 3751.48,-339.01 3745.77,-324.58 3743.09,-310.37"/>
<polygon fill="black" stroke="black" points="3746.5,-309.55 3741.62,-300.15 3739.57,-310.54 3746.5,-309.55"/>
<text text-anchor="middle" x="3892.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 13</text>
<text text-anchor="middle" x="3892.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_14 -->
<g id="node222" class="node">
<title>expert4_14</title>
<polygon fill="#fff0e6" stroke="black" points="4134.5,-300 3913.5,-300 3913.5,-232 4134.5,-232 4134.5,-300"/>
<text text-anchor="middle" x="4024" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="4024" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4024" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="4024" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;207</text>
</g>
<!-- router4&#45;&gt;expert4_14 -->
<g id="edge407" class="edge">
<title>router4&#45;&gt;expert4_14</title>
<path fill="none" stroke="black" d="M8790.44,-391.43C8086.06,-390.83 4093.42,-385.81 4045,-348 4033.48,-339.01 4027.78,-324.57 4025.09,-310.37"/>
<polygon fill="black" stroke="black" points="4028.51,-309.55 4023.63,-300.14 4021.58,-310.54 4028.51,-309.55"/>
<text text-anchor="middle" x="4174.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 14</text>
<text text-anchor="middle" x="4174.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_15 -->
<g id="node223" class="node">
<title>expert4_15</title>
<polygon fill="#fff0e6" stroke="black" points="4416.5,-300 4195.5,-300 4195.5,-232 4416.5,-232 4416.5,-300"/>
<text text-anchor="middle" x="4306" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="4306" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4306" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="4306" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;208</text>
</g>
<!-- router4&#45;&gt;expert4_15 -->
<g id="edge408" class="edge">
<title>router4&#45;&gt;expert4_15</title>
<path fill="none" stroke="black" d="M8790.36,-391.37C8110.02,-390.41 4372.45,-383.52 4327,-348 4315.49,-339 4309.78,-324.57 4307.09,-310.36"/>
<polygon fill="black" stroke="black" points="4310.51,-309.54 4305.63,-300.14 4303.58,-310.53 4310.51,-309.54"/>
<text text-anchor="middle" x="4456.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 15</text>
<text text-anchor="middle" x="4456.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_16 -->
<g id="node224" class="node">
<title>expert4_16</title>
<polygon fill="#fff0e6" stroke="black" points="4698.5,-300 4477.5,-300 4477.5,-232 4698.5,-232 4698.5,-300"/>
<text text-anchor="middle" x="4588" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 16</text>
<text text-anchor="middle" x="4588" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4588" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="4588" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;209</text>
</g>
<!-- router4&#45;&gt;expert4_16 -->
<g id="edge409" class="edge">
<title>router4&#45;&gt;expert4_16</title>
<path fill="none" stroke="black" d="M8790.36,-391.3C8135.02,-389.95 4651.49,-381.23 4609,-348 4597.49,-339 4591.78,-324.57 4589.09,-310.36"/>
<polygon fill="black" stroke="black" points="4592.51,-309.54 4587.63,-300.14 4585.58,-310.53 4592.51,-309.54"/>
<text text-anchor="middle" x="4738.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 16</text>
<text text-anchor="middle" x="4738.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_17 -->
<g id="node225" class="node">
<title>expert4_17</title>
<polygon fill="#fff0e6" stroke="black" points="4980.5,-300 4759.5,-300 4759.5,-232 4980.5,-232 4980.5,-300"/>
<text text-anchor="middle" x="4870" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 17</text>
<text text-anchor="middle" x="4870" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4870" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="4870" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;210</text>
</g>
<!-- router4&#45;&gt;expert4_17 -->
<g id="edge410" class="edge">
<title>router4&#45;&gt;expert4_17</title>
<path fill="none" stroke="black" d="M8790.26,-391.22C8160.56,-389.46 4930.54,-378.94 4891,-348 4879.49,-338.99 4873.79,-324.56 4871.1,-310.36"/>
<polygon fill="black" stroke="black" points="4874.52,-309.54 4869.63,-300.13 4867.59,-310.53 4874.52,-309.54"/>
<text text-anchor="middle" x="5020.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 17</text>
<text text-anchor="middle" x="5020.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_18 -->
<g id="node226" class="node">
<title>expert4_18</title>
<polygon fill="#fff0e6" stroke="black" points="5262.5,-300 5041.5,-300 5041.5,-232 5262.5,-232 5262.5,-300"/>
<text text-anchor="middle" x="5152" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 18</text>
<text text-anchor="middle" x="5152" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5152" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="5152" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;211</text>
</g>
<!-- router4&#45;&gt;expert4_18 -->
<g id="edge411" class="edge">
<title>router4&#45;&gt;expert4_18</title>
<path fill="none" stroke="black" d="M8790.22,-391.13C8187.22,-388.94 5209.59,-376.65 5173,-348 5161.5,-338.99 5155.79,-324.56 5153.1,-310.35"/>
<polygon fill="black" stroke="black" points="5156.52,-309.53 5151.64,-300.13 5149.59,-310.52 5156.52,-309.53"/>
<text text-anchor="middle" x="5302.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 18</text>
<text text-anchor="middle" x="5302.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_19 -->
<g id="node227" class="node">
<title>expert4_19</title>
<polygon fill="#fff0e6" stroke="black" points="5544.5,-300 5323.5,-300 5323.5,-232 5544.5,-232 5544.5,-300"/>
<text text-anchor="middle" x="5434" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 19</text>
<text text-anchor="middle" x="5434" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5434" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="5434" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;212</text>
</g>
<!-- router4&#45;&gt;expert4_19 -->
<g id="edge412" class="edge">
<title>router4&#45;&gt;expert4_19</title>
<path fill="none" stroke="black" d="M8790.37,-391.03C8215.54,-388.37 5488.65,-374.38 5455,-348 5443.5,-338.98 5437.8,-324.55 5435.11,-310.34"/>
<polygon fill="black" stroke="black" points="5438.53,-309.52 5433.64,-300.12 5431.6,-310.52 5438.53,-309.52"/>
<text text-anchor="middle" x="5584.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 19</text>
<text text-anchor="middle" x="5584.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_20 -->
<g id="node228" class="node">
<title>expert4_20</title>
<polygon fill="#fff0e6" stroke="black" points="5826.5,-300 5605.5,-300 5605.5,-232 5826.5,-232 5826.5,-300"/>
<text text-anchor="middle" x="5716" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 20</text>
<text text-anchor="middle" x="5716" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5716" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="5716" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;213</text>
</g>
<!-- router4&#45;&gt;expert4_20 -->
<g id="edge413" class="edge">
<title>router4&#45;&gt;expert4_20</title>
<path fill="none" stroke="black" d="M8790.44,-391.79C8248.13,-393.07 5798.38,-396.18 5737,-348 5725.51,-338.98 5719.8,-324.54 5717.11,-310.34"/>
<polygon fill="black" stroke="black" points="5720.53,-309.52 5715.65,-300.12 5713.6,-310.51 5720.53,-309.52"/>
<text text-anchor="middle" x="5866.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 20</text>
<text text-anchor="middle" x="5866.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_21 -->
<g id="node229" class="node">
<title>expert4_21</title>
<polygon fill="#fff0e6" stroke="black" points="6108.5,-300 5887.5,-300 5887.5,-232 6108.5,-232 6108.5,-300"/>
<text text-anchor="middle" x="5998" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 21</text>
<text text-anchor="middle" x="5998" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5998" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="5998" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;214</text>
</g>
<!-- router4&#45;&gt;expert4_21 -->
<g id="edge414" class="edge">
<title>router4&#45;&gt;expert4_21</title>
<path fill="none" stroke="black" d="M8790.25,-391.66C8277.59,-392.2 6073.29,-391.97 6018,-348 6006.6,-338.93 6001.07,-324.48 5998.56,-310.28"/>
<polygon fill="black" stroke="black" points="6001.99,-309.53 5997.22,-300.07 5995.05,-310.44 6001.99,-309.53"/>
<text text-anchor="middle" x="6147.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 21</text>
<text text-anchor="middle" x="6147.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_22 -->
<g id="node230" class="node">
<title>expert4_22</title>
<polygon fill="#fff0e6" stroke="black" points="6390.5,-300 6169.5,-300 6169.5,-232 6390.5,-232 6390.5,-300"/>
<text text-anchor="middle" x="6280" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 22</text>
<text text-anchor="middle" x="6280" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="6280" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="6280" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;215</text>
</g>
<!-- router4&#45;&gt;expert4_22 -->
<g id="edge415" class="edge">
<title>router4&#45;&gt;expert4_22</title>
<path fill="none" stroke="black" d="M8790.36,-391.49C8309.43,-391.23 6348.27,-387.73 6299,-348 6287.69,-338.88 6282.33,-324.42 6280,-310.23"/>
<polygon fill="black" stroke="black" points="6283.44,-309.54 6278.79,-300.02 6276.49,-310.36 6283.44,-309.54"/>
<text text-anchor="middle" x="6428.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 22</text>
<text text-anchor="middle" x="6428.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_23 -->
<g id="node231" class="node">
<title>expert4_23</title>
<polygon fill="#fff0e6" stroke="black" points="6672.5,-300 6451.5,-300 6451.5,-232 6672.5,-232 6672.5,-300"/>
<text text-anchor="middle" x="6562" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 23</text>
<text text-anchor="middle" x="6562" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="6562" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="6562" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;216</text>
</g>
<!-- router4&#45;&gt;expert4_23 -->
<g id="edge416" class="edge">
<title>router4&#45;&gt;expert4_23</title>
<path fill="none" stroke="black" d="M8790.38,-391.28C8342.78,-390.13 6623.32,-383.42 6580,-348 6568.87,-338.9 6563.68,-324.59 6561.5,-310.51"/>
<polygon fill="black" stroke="black" points="6564.96,-309.94 6560.39,-300.38 6558,-310.7 6564.96,-309.94"/>
<text text-anchor="middle" x="6709.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 23</text>
<text text-anchor="middle" x="6709.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_24 -->
<g id="node232" class="node">
<title>expert4_24</title>
<polygon fill="#fff0e6" stroke="black" points="6954.5,-300 6733.5,-300 6733.5,-232 6954.5,-232 6954.5,-300"/>
<text text-anchor="middle" x="6844" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 24</text>
<text text-anchor="middle" x="6844" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="6844" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="6844" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;217</text>
</g>
<!-- router4&#45;&gt;expert4_24 -->
<g id="edge417" class="edge">
<title>router4&#45;&gt;expert4_24</title>
<path fill="none" stroke="black" d="M8790.44,-391.04C8378,-389.01 6896.11,-379.55 6859,-348 6848.13,-338.76 6843.45,-324.41 6841.79,-310.35"/>
<polygon fill="black" stroke="black" points="6845.27,-309.96 6841.07,-300.24 6838.29,-310.46 6845.27,-309.96"/>
<text text-anchor="middle" x="6988.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 24</text>
<text text-anchor="middle" x="6988.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_25 -->
<g id="node233" class="node">
<title>expert4_25</title>
<polygon fill="#fff0e6" stroke="black" points="7236.5,-300 7015.5,-300 7015.5,-232 7236.5,-232 7236.5,-300"/>
<text text-anchor="middle" x="7126" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 25</text>
<text text-anchor="middle" x="7126" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7126" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="7126" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;218</text>
</g>
<!-- router4&#45;&gt;expert4_25 -->
<g id="edge418" class="edge">
<title>router4&#45;&gt;expert4_25</title>
<path fill="none" stroke="black" d="M8790.39,-390.72C8415.3,-387.72 7167.93,-375.69 7137,-348 7126.45,-338.55 7122.45,-324.17 7121.5,-310.12"/>
<polygon fill="black" stroke="black" points="7125,-309.96 7121.3,-300.03 7118,-310.1 7125,-309.96"/>
<text text-anchor="middle" x="7266.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 25</text>
<text text-anchor="middle" x="7266.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_26 -->
<g id="node234" class="node">
<title>expert4_26</title>
<polygon fill="#fff0e6" stroke="black" points="7517.5,-300 7296.5,-300 7296.5,-232 7517.5,-232 7517.5,-300"/>
<text text-anchor="middle" x="7407" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 26</text>
<text text-anchor="middle" x="7407" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7407" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="7407" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;219</text>
</g>
<!-- router4&#45;&gt;expert4_26 -->
<g id="edge419" class="edge">
<title>router4&#45;&gt;expert4_26</title>
<path fill="none" stroke="black" d="M8790.27,-390.27C8455.44,-386.12 7439,-371.61 7414,-348 7403.94,-338.5 7400.56,-324.4 7400.22,-310.62"/>
<polygon fill="black" stroke="black" points="7403.73,-310.3 7400.49,-300.22 7396.73,-310.12 7403.73,-310.3"/>
<text text-anchor="middle" x="7543.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 26</text>
<text text-anchor="middle" x="7543.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_27 -->
<g id="node235" class="node">
<title>expert4_27</title>
<polygon fill="#fff0e6" stroke="black" points="7798.5,-300 7577.5,-300 7577.5,-232 7798.5,-232 7798.5,-300"/>
<text text-anchor="middle" x="7688" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 27</text>
<text text-anchor="middle" x="7688" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7688" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="7688" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;220</text>
</g>
<!-- router4&#45;&gt;expert4_27 -->
<g id="edge420" class="edge">
<title>router4&#45;&gt;expert4_27</title>
<path fill="none" stroke="black" d="M8790.44,-391.6C8503.35,-391.36 7727.17,-387.09 7689,-348 7679.45,-338.22 7677.01,-324.18 7677.65,-310.54"/>
<polygon fill="black" stroke="black" points="7681.17,-310.55 7678.68,-300.26 7674.2,-309.86 7681.17,-310.55"/>
<text text-anchor="middle" x="7818.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 27</text>
<text text-anchor="middle" x="7818.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_28 -->
<g id="node236" class="node">
<title>expert4_28</title>
<polygon fill="#fff0e6" stroke="black" points="8078.5,-300 7857.5,-300 7857.5,-232 8078.5,-232 8078.5,-300"/>
<text text-anchor="middle" x="7968" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 28</text>
<text text-anchor="middle" x="7968" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7968" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="7968" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;221</text>
</g>
<!-- router4&#45;&gt;expert4_28 -->
<g id="edge421" class="edge">
<title>router4&#45;&gt;expert4_28</title>
<path fill="none" stroke="black" d="M8790.43,-390.44C8551.97,-387.53 7990.21,-377.56 7962,-348 7952.44,-337.99 7951.1,-323.74 7953.07,-309.98"/>
<polygon fill="black" stroke="black" points="7956.52,-310.61 7955.03,-300.12 7949.65,-309.25 7956.52,-310.61"/>
<text text-anchor="middle" x="8091.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 28</text>
<text text-anchor="middle" x="8091.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_29 -->
<g id="node237" class="node">
<title>expert4_29</title>
<polygon fill="#fff0e6" stroke="black" points="8355.5,-300 8134.5,-300 8134.5,-232 8355.5,-232 8355.5,-300"/>
<text text-anchor="middle" x="8245" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 29</text>
<text text-anchor="middle" x="8245" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8245" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="8245" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;222</text>
</g>
<!-- router4&#45;&gt;expert4_29 -->
<g id="edge422" class="edge">
<title>router4&#45;&gt;expert4_29</title>
<path fill="none" stroke="black" d="M8790.29,-392.28C8612.94,-392.48 8271.13,-387.64 8234,-348 8224.55,-337.91 8223.89,-323.78 8226.68,-310.14"/>
<polygon fill="black" stroke="black" points="8230.1,-310.92 8229.26,-300.36 8223.33,-309.14 8230.1,-310.92"/>
<text text-anchor="middle" x="8363.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 29</text>
<text text-anchor="middle" x="8363.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_30 -->
<g id="node238" class="node">
<title>expert4_30</title>
<polygon fill="#fff0e6" stroke="black" points="8627.5,-300 8406.5,-300 8406.5,-232 8627.5,-232 8627.5,-300"/>
<text text-anchor="middle" x="8517" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 30</text>
<text text-anchor="middle" x="8517" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8517" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="8517" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;223</text>
</g>
<!-- router4&#45;&gt;expert4_30 -->
<g id="edge423" class="edge">
<title>router4&#45;&gt;expert4_30</title>
<path fill="none" stroke="black" d="M8790.3,-386.86C8681.34,-380.96 8524.74,-368.94 8506,-348 8496.79,-337.7 8496.17,-323.52 8498.95,-309.9"/>
<polygon fill="black" stroke="black" points="8502.36,-310.7 8501.5,-300.14 8495.58,-308.93 8502.36,-310.7"/>
<text text-anchor="middle" x="8635.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 30</text>
<text text-anchor="middle" x="8635.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_31 -->
<g id="node239" class="node">
<title>expert4_31</title>
<polygon fill="#fff0e6" stroke="black" points="8897.5,-300 8676.5,-300 8676.5,-232 8897.5,-232 8897.5,-300"/>
<text text-anchor="middle" x="8787" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 31</text>
<text text-anchor="middle" x="8787" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8787" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="8787" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;224</text>
</g>
<!-- router4&#45;&gt;expert4_31 -->
<g id="edge424" class="edge">
<title>router4&#45;&gt;expert4_31</title>
<path fill="none" stroke="black" d="M8795.04,-365.88C8788.1,-360.93 8781.92,-355.03 8777,-348 8769.37,-337.08 8768.69,-323.25 8770.89,-310.13"/>
<polygon fill="black" stroke="black" points="8774.32,-310.81 8773.06,-300.29 8767.49,-309.3 8774.32,-310.81"/>
<text text-anchor="middle" x="8906.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 31</text>
<text text-anchor="middle" x="8906.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_32 -->
<g id="node240" class="node">
<title>expert4_32</title>
<polygon fill="#fff0e6" stroke="black" points="9157.5,-300 8936.5,-300 8936.5,-232 9157.5,-232 9157.5,-300"/>
<text text-anchor="middle" x="9047" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 32</text>
<text text-anchor="middle" x="9047" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9047" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="9047" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;225</text>
</g>
<!-- router4&#45;&gt;expert4_32 -->
<g id="edge425" class="edge">
<title>router4&#45;&gt;expert4_32</title>
<path fill="none" stroke="black" d="M9001.63,-373.42C9014.7,-367.23 9026.71,-358.98 9036,-348 9044.77,-337.64 9048.52,-323.72 9049.78,-310.34"/>
<polygon fill="black" stroke="black" points="9053.28,-310.45 9050.3,-300.28 9046.29,-310.09 9053.28,-310.45"/>
<text text-anchor="middle" x="9177.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 32</text>
<text text-anchor="middle" x="9177.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_33 -->
<g id="node241" class="node">
<title>expert4_33</title>
<polygon fill="#fff0e6" stroke="black" points="9428.5,-300 9207.5,-300 9207.5,-232 9428.5,-232 9428.5,-300"/>
<text text-anchor="middle" x="9318" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 33</text>
<text text-anchor="middle" x="9318" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9318" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="9318" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;226</text>
</g>
<!-- router4&#45;&gt;expert4_33 -->
<g id="edge426" class="edge">
<title>router4&#45;&gt;expert4_33</title>
<path fill="none" stroke="black" d="M9001.59,-387.32C9117.36,-381.68 9289.67,-369.73 9311,-348 9320.61,-338.21 9323.94,-324.17 9324.36,-310.53"/>
<polygon fill="black" stroke="black" points="9327.85,-310.18 9324.17,-300.25 9320.85,-310.31 9327.85,-310.18"/>
<text text-anchor="middle" x="9452.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 33</text>
<text text-anchor="middle" x="9452.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_34 -->
<g id="node242" class="node">
<title>expert4_34</title>
<polygon fill="#fff0e6" stroke="black" points="9705.5,-300 9484.5,-300 9484.5,-232 9705.5,-232 9705.5,-300"/>
<text text-anchor="middle" x="9595" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 34</text>
<text text-anchor="middle" x="9595" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9595" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="9595" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;227</text>
</g>
<!-- router4&#45;&gt;expert4_34 -->
<g id="edge427" class="edge">
<title>router4&#45;&gt;expert4_34</title>
<path fill="none" stroke="black" d="M9001.71,-392.16C9184.64,-392.25 9544.74,-387.34 9586,-348 9596.04,-338.43 9599.71,-324.31 9600.42,-310.54"/>
<polygon fill="black" stroke="black" points="9603.92,-310.15 9600.44,-300.15 9596.92,-310.14 9603.92,-310.15"/>
<text text-anchor="middle" x="9728.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 34</text>
<text text-anchor="middle" x="9728.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_35 -->
<g id="node243" class="node">
<title>expert4_35</title>
<polygon fill="#fff0e6" stroke="black" points="9984.5,-300 9763.5,-300 9763.5,-232 9984.5,-232 9984.5,-300"/>
<text text-anchor="middle" x="9874" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 35</text>
<text text-anchor="middle" x="9874" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9874" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="9874" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;228</text>
</g>
<!-- router4&#45;&gt;expert4_35 -->
<g id="edge428" class="edge">
<title>router4&#45;&gt;expert4_35</title>
<path fill="none" stroke="black" d="M9001.71,-390.31C9245.83,-387.09 9830.5,-376.44 9862,-348 9872.44,-338.57 9876.61,-324.33 9877.78,-310.4"/>
<polygon fill="black" stroke="black" points="9881.28,-310.51 9878.16,-300.38 9874.29,-310.25 9881.28,-310.51"/>
<text text-anchor="middle" x="10005.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 35</text>
<text text-anchor="middle" x="10005.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_36 -->
<g id="node244" class="node">
<title>expert4_36</title>
<polygon fill="#fff0e6" stroke="black" points="10265.5,-300 10044.5,-300 10044.5,-232 10265.5,-232 10265.5,-300"/>
<text text-anchor="middle" x="10155" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 36</text>
<text text-anchor="middle" x="10155" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10155" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="10155" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;229</text>
</g>
<!-- router4&#45;&gt;expert4_36 -->
<g id="edge429" class="edge">
<title>router4&#45;&gt;expert4_36</title>
<path fill="none" stroke="black" d="M9001.7,-391.34C9294.27,-390.43 10096.04,-384.58 10139,-348 10149.89,-338.73 10154.72,-324.38 10156.56,-310.32"/>
<polygon fill="black" stroke="black" points="10160.06,-310.47 10157.42,-300.21 10153.09,-309.88 10160.06,-310.47"/>
<text text-anchor="middle" x="10283.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 36</text>
<text text-anchor="middle" x="10283.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_37 -->
<g id="node245" class="node">
<title>expert4_37</title>
<polygon fill="#fff0e6" stroke="black" points="10546.5,-300 10325.5,-300 10325.5,-232 10546.5,-232 10546.5,-300"/>
<text text-anchor="middle" x="10436" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 37</text>
<text text-anchor="middle" x="10436" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10436" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="10436" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;230</text>
</g>
<!-- router4&#45;&gt;expert4_37 -->
<g id="edge430" class="edge">
<title>router4&#45;&gt;expert4_37</title>
<path fill="none" stroke="black" d="M9001.55,-391.98C9337.37,-393.06 10362.28,-392.65 10417,-348 10428.17,-338.89 10433.51,-324.57 10435.88,-310.5"/>
<polygon fill="black" stroke="black" points="10439.38,-310.72 10437.12,-300.37 10432.43,-309.87 10439.38,-310.72"/>
<text text-anchor="middle" x="10563.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 37</text>
<text text-anchor="middle" x="10563.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_38 -->
<g id="node246" class="node">
<title>expert4_38</title>
<polygon fill="#fff0e6" stroke="black" points="10828.5,-300 10607.5,-300 10607.5,-232 10828.5,-232 10828.5,-300"/>
<text text-anchor="middle" x="10718" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 38</text>
<text text-anchor="middle" x="10718" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10718" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="10718" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;231</text>
</g>
<!-- router4&#45;&gt;expert4_38 -->
<g id="edge431" class="edge">
<title>router4&#45;&gt;expert4_38</title>
<path fill="none" stroke="black" d="M9001.72,-390.65C9382.55,-387.39 10663.63,-374.47 10697,-348 10708.45,-338.92 10714.14,-324.47 10716.84,-310.27"/>
<polygon fill="black" stroke="black" points="10720.35,-310.45 10718.31,-300.06 10713.42,-309.46 10720.35,-310.45"/>
<text text-anchor="middle" x="10844.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 38</text>
<text text-anchor="middle" x="10844.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_39 -->
<g id="node247" class="node">
<title>expert4_39</title>
<polygon fill="#fff0e6" stroke="black" points="11110.5,-300 10889.5,-300 10889.5,-232 11110.5,-232 11110.5,-300"/>
<text text-anchor="middle" x="11000" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 39</text>
<text text-anchor="middle" x="11000" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11000" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="11000" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;232</text>
</g>
<!-- router4&#45;&gt;expert4_39 -->
<g id="edge432" class="edge">
<title>router4&#45;&gt;expert4_39</title>
<path fill="none" stroke="black" d="M9001.67,-391C9419.92,-388.8 10938.7,-378.7 10978,-348 10989.55,-338.98 10995.42,-324.54 10998.29,-310.33"/>
<polygon fill="black" stroke="black" points="11001.8,-310.53 10999.89,-300.11 10994.89,-309.45 11001.8,-310.53"/>
<text text-anchor="middle" x="11125.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 39</text>
<text text-anchor="middle" x="11125.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_40 -->
<g id="node248" class="node">
<title>expert4_40</title>
<polygon fill="#fff0e6" stroke="black" points="11392.5,-300 11171.5,-300 11171.5,-232 11392.5,-232 11392.5,-300"/>
<text text-anchor="middle" x="11282" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 40</text>
<text text-anchor="middle" x="11282" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11282" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="11282" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;233</text>
</g>
<!-- router4&#45;&gt;expert4_40 -->
<g id="edge433" class="edge">
<title>router4&#45;&gt;expert4_40</title>
<path fill="none" stroke="black" d="M9001.8,-391.26C9455.25,-390 11213.7,-382.88 11259,-348 11270.65,-339.03 11276.7,-324.6 11279.74,-310.39"/>
<polygon fill="black" stroke="black" points="11283.26,-310.61 11281.47,-300.16 11276.35,-309.44 11283.26,-310.61"/>
<text text-anchor="middle" x="11406.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 40</text>
<text text-anchor="middle" x="11406.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_41 -->
<g id="node249" class="node">
<title>expert4_41</title>
<polygon fill="#fff0e6" stroke="black" points="11674.5,-300 11453.5,-300 11453.5,-232 11674.5,-232 11674.5,-300"/>
<text text-anchor="middle" x="11564" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 41</text>
<text text-anchor="middle" x="11564" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11564" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="11564" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;234</text>
</g>
<!-- router4&#45;&gt;expert4_41 -->
<g id="edge434" class="edge">
<title>router4&#45;&gt;expert4_41</title>
<path fill="none" stroke="black" d="M9001.88,-391.46C9488.46,-391.05 11488.63,-387.02 11540,-348 11551.75,-339.08 11557.97,-324.66 11561.19,-310.45"/>
<polygon fill="black" stroke="black" points="11564.71,-310.68 11563.05,-300.21 11557.82,-309.43 11564.71,-310.68"/>
<text text-anchor="middle" x="11688.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 41</text>
<text text-anchor="middle" x="11688.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_42 -->
<g id="node250" class="node">
<title>expert4_42</title>
<polygon fill="#fff0e6" stroke="black" points="11956.5,-300 11735.5,-300 11735.5,-232 11956.5,-232 11956.5,-300"/>
<text text-anchor="middle" x="11846" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 42</text>
<text text-anchor="middle" x="11846" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11846" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="11846" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;235</text>
</g>
<!-- router4&#45;&gt;expert4_42 -->
<g id="edge435" class="edge">
<title>router4&#45;&gt;expert4_42</title>
<path fill="none" stroke="black" d="M9001.75,-391.63C9519.53,-392.07 11764.71,-391.44 11822,-348 11833.76,-339.09 11839.98,-324.67 11843.2,-310.46"/>
<polygon fill="black" stroke="black" points="11846.72,-310.68 11845.05,-300.22 11839.83,-309.44 11846.72,-310.68"/>
<text text-anchor="middle" x="11970.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 42</text>
<text text-anchor="middle" x="11970.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_43 -->
<g id="node251" class="node">
<title>expert4_43</title>
<polygon fill="#fff0e6" stroke="black" points="12238.5,-300 12017.5,-300 12017.5,-232 12238.5,-232 12238.5,-300"/>
<text text-anchor="middle" x="12128" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 43</text>
<text text-anchor="middle" x="12128" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12128" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="12128" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;236</text>
</g>
<!-- router4&#45;&gt;expert4_43 -->
<g id="edge436" class="edge">
<title>router4&#45;&gt;expert4_43</title>
<path fill="none" stroke="black" d="M9001.81,-391.78C9549.63,-392.99 12040.78,-395.88 12104,-348 12115.76,-339.09 12121.98,-324.68 12125.21,-310.46"/>
<polygon fill="black" stroke="black" points="12128.72,-310.69 12127.06,-300.23 12121.83,-309.45 12128.72,-310.69"/>
<text text-anchor="middle" x="12252.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 43</text>
<text text-anchor="middle" x="12252.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_44 -->
<g id="node252" class="node">
<title>expert4_44</title>
<polygon fill="#fff0e6" stroke="black" points="12520.5,-300 12299.5,-300 12299.5,-232 12520.5,-232 12520.5,-300"/>
<text text-anchor="middle" x="12410" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 44</text>
<text text-anchor="middle" x="12410" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12410" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="12410" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;237</text>
</g>
<!-- router4&#45;&gt;expert4_44 -->
<g id="edge437" class="edge">
<title>router4&#45;&gt;expert4_44</title>
<path fill="none" stroke="black" d="M9001.69,-391.03C9581.53,-388.35 12351.39,-374.18 12386,-348 12397.77,-339.1 12403.99,-324.69 12407.21,-310.47"/>
<polygon fill="black" stroke="black" points="12410.73,-310.7 12409.06,-300.24 12403.84,-309.45 12410.73,-310.7"/>
<text text-anchor="middle" x="12534.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 44</text>
<text text-anchor="middle" x="12534.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_45 -->
<g id="node253" class="node">
<title>expert4_45</title>
<polygon fill="#fff0e6" stroke="black" points="12802.5,-300 12581.5,-300 12581.5,-232 12802.5,-232 12802.5,-300"/>
<text text-anchor="middle" x="12692" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 45</text>
<text text-anchor="middle" x="12692" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12692" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="12692" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;238</text>
</g>
<!-- router4&#45;&gt;expert4_45 -->
<g id="edge438" class="edge">
<title>router4&#45;&gt;expert4_45</title>
<path fill="none" stroke="black" d="M9001.67,-391.13C9609.09,-388.9 12630.41,-376.41 12668,-348 12679.77,-339.11 12686,-324.7 12689.22,-310.48"/>
<polygon fill="black" stroke="black" points="12692.73,-310.7 12691.07,-300.24 12685.84,-309.46 12692.73,-310.7"/>
<text text-anchor="middle" x="12816.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 45</text>
<text text-anchor="middle" x="12816.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_46 -->
<g id="node254" class="node">
<title>expert4_46</title>
<polygon fill="#fff0e6" stroke="black" points="13084.5,-300 12863.5,-300 12863.5,-232 13084.5,-232 13084.5,-300"/>
<text text-anchor="middle" x="12974" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 46</text>
<text text-anchor="middle" x="12974" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12974" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="12974" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;239</text>
</g>
<!-- router4&#45;&gt;expert4_46 -->
<g id="edge439" class="edge">
<title>router4&#45;&gt;expert4_46</title>
<path fill="none" stroke="black" d="M9001.73,-391.22C9635.91,-389.42 12909.42,-378.64 12950,-348 12961.77,-339.11 12968,-324.7 12971.22,-310.48"/>
<polygon fill="black" stroke="black" points="12974.74,-310.71 12973.07,-300.25 12967.85,-309.46 12974.74,-310.71"/>
<text text-anchor="middle" x="13098.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 46</text>
<text text-anchor="middle" x="13098.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_47 -->
<g id="node255" class="node">
<title>expert4_47</title>
<polygon fill="#fff0e6" stroke="black" points="13366.5,-300 13145.5,-300 13145.5,-232 13366.5,-232 13366.5,-300"/>
<text text-anchor="middle" x="13256" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 47</text>
<text text-anchor="middle" x="13256" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13256" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="13256" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;240</text>
</g>
<!-- router4&#45;&gt;expert4_47 -->
<g id="edge440" class="edge">
<title>router4&#45;&gt;expert4_47</title>
<path fill="none" stroke="black" d="M9001.5,-391.29C9660.82,-389.89 13188.42,-380.88 13232,-348 13243.78,-339.11 13250,-324.71 13253.22,-310.49"/>
<polygon fill="black" stroke="black" points="13256.74,-310.71 13255.07,-300.25 13249.85,-309.47 13256.74,-310.71"/>
<text text-anchor="middle" x="13380.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 47</text>
<text text-anchor="middle" x="13380.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_48 -->
<g id="node256" class="node">
<title>expert4_48</title>
<polygon fill="#fff0e6" stroke="black" points="13648.5,-300 13427.5,-300 13427.5,-232 13648.5,-232 13648.5,-300"/>
<text text-anchor="middle" x="13538" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 48</text>
<text text-anchor="middle" x="13538" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13538" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="13538" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;241</text>
</g>
<!-- router4&#45;&gt;expert4_48 -->
<g id="edge441" class="edge">
<title>router4&#45;&gt;expert4_48</title>
<path fill="none" stroke="black" d="M9001.65,-391.36C9686.24,-390.34 13467.42,-383.12 13514,-348 13525.78,-339.12 13532.01,-324.71 13535.23,-310.49"/>
<polygon fill="black" stroke="black" points="13538.74,-310.72 13537.08,-300.25 13531.86,-309.47 13538.74,-310.72"/>
<text text-anchor="middle" x="13662.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 48</text>
<text text-anchor="middle" x="13662.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_49 -->
<g id="node257" class="node">
<title>expert4_49</title>
<polygon fill="#fff0e6" stroke="black" points="13930.5,-300 13709.5,-300 13709.5,-232 13930.5,-232 13930.5,-300"/>
<text text-anchor="middle" x="13820" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 49</text>
<text text-anchor="middle" x="13820" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13820" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="13820" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;242</text>
</g>
<!-- router4&#45;&gt;expert4_49 -->
<g id="edge442" class="edge">
<title>router4&#45;&gt;expert4_49</title>
<path fill="none" stroke="black" d="M9001.75,-391.42C9710.76,-390.76 13746.42,-385.36 13796,-348 13807.78,-339.12 13814.01,-324.71 13817.23,-310.5"/>
<polygon fill="black" stroke="black" points="13820.75,-310.72 13819.08,-300.26 13813.86,-309.47 13820.75,-310.72"/>
<text text-anchor="middle" x="13944.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 49</text>
<text text-anchor="middle" x="13944.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_50 -->
<g id="node258" class="node">
<title>expert4_50</title>
<polygon fill="#fff0e6" stroke="black" points="14212.5,-300 13991.5,-300 13991.5,-232 14212.5,-232 14212.5,-300"/>
<text text-anchor="middle" x="14102" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 50</text>
<text text-anchor="middle" x="14102" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14102" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="14102" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;243</text>
</g>
<!-- router4&#45;&gt;expert4_50 -->
<g id="edge443" class="edge">
<title>router4&#45;&gt;expert4_50</title>
<path fill="none" stroke="black" d="M9001.6,-391.47C9733.63,-391.15 14025.42,-387.61 14078,-348 14089.78,-339.12 14096.01,-324.72 14099.23,-310.5"/>
<polygon fill="black" stroke="black" points="14102.75,-310.72 14101.08,-300.26 14095.86,-309.48 14102.75,-310.72"/>
<text text-anchor="middle" x="14226.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 50</text>
<text text-anchor="middle" x="14226.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_51 -->
<g id="node259" class="node">
<title>expert4_51</title>
<polygon fill="#fff0e6" stroke="black" points="14494.5,-300 14273.5,-300 14273.5,-232 14494.5,-232 14494.5,-300"/>
<text text-anchor="middle" x="14384" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 51</text>
<text text-anchor="middle" x="14384" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14384" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="14384" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;244</text>
</g>
<!-- router4&#45;&gt;expert4_51 -->
<g id="edge444" class="edge">
<title>router4&#45;&gt;expert4_51</title>
<path fill="none" stroke="black" d="M9001.55,-391.52C9756.23,-391.53 14304.4,-389.86 14360,-348 14371.79,-339.13 14378.02,-324.72 14381.23,-310.5"/>
<polygon fill="black" stroke="black" points="14384.75,-310.72 14383.08,-300.26 14377.86,-309.48 14384.75,-310.72"/>
<text text-anchor="middle" x="14508.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 51</text>
<text text-anchor="middle" x="14508.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_52 -->
<g id="node260" class="node">
<title>expert4_52</title>
<polygon fill="#fff0e6" stroke="black" points="14776.5,-300 14555.5,-300 14555.5,-232 14776.5,-232 14776.5,-300"/>
<text text-anchor="middle" x="14666" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 52</text>
<text text-anchor="middle" x="14666" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14666" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="14666" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;245</text>
</g>
<!-- router4&#45;&gt;expert4_52 -->
<g id="edge445" class="edge">
<title>router4&#45;&gt;expert4_52</title>
<path fill="none" stroke="black" d="M9001.67,-391.56C9778.95,-391.88 14583.39,-392.11 14642,-348 14653.79,-339.13 14660.02,-324.72 14663.24,-310.5"/>
<polygon fill="black" stroke="black" points="14666.75,-310.73 14665.09,-300.26 14659.86,-309.48 14666.75,-310.73"/>
<text text-anchor="middle" x="14790.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 52</text>
<text text-anchor="middle" x="14790.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_53 -->
<g id="node261" class="node">
<title>expert4_53</title>
<polygon fill="#fff0e6" stroke="black" points="15058.5,-300 14837.5,-300 14837.5,-232 15058.5,-232 15058.5,-300"/>
<text text-anchor="middle" x="14948" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 53</text>
<text text-anchor="middle" x="14948" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14948" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="14948" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;246</text>
</g>
<!-- router4&#45;&gt;expert4_53 -->
<g id="edge446" class="edge">
<title>router4&#45;&gt;expert4_53</title>
<path fill="none" stroke="black" d="M9001.71,-391.6C9800.84,-392.22 14862.38,-394.36 14924,-348 14935.79,-339.13 14942.02,-324.73 14945.24,-310.51"/>
<polygon fill="black" stroke="black" points="14948.75,-310.73 14947.09,-300.27 14941.87,-309.48 14948.75,-310.73"/>
<text text-anchor="middle" x="15072.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 53</text>
<text text-anchor="middle" x="15072.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_54 -->
<g id="node262" class="node">
<title>expert4_54</title>
<polygon fill="#fff0e6" stroke="black" points="15340.5,-300 15119.5,-300 15119.5,-232 15340.5,-232 15340.5,-300"/>
<text text-anchor="middle" x="15230" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 54</text>
<text text-anchor="middle" x="15230" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15230" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="15230" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;247</text>
</g>
<!-- router4&#45;&gt;expert4_54 -->
<g id="edge447" class="edge">
<title>router4&#45;&gt;expert4_54</title>
<path fill="none" stroke="black" d="M9001.72,-391.63C9822.08,-392.55 15141.36,-396.61 15206,-348 15217.79,-339.13 15224.02,-324.73 15227.24,-310.51"/>
<polygon fill="black" stroke="black" points="15230.76,-310.73 15229.09,-300.27 15223.87,-309.49 15230.76,-310.73"/>
<text text-anchor="middle" x="15354.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 54</text>
<text text-anchor="middle" x="15354.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_55 -->
<g id="node263" class="node">
<title>expert4_55</title>
<polygon fill="#fff0e6" stroke="black" points="15622.5,-300 15401.5,-300 15401.5,-232 15622.5,-232 15622.5,-300"/>
<text text-anchor="middle" x="15512" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 55</text>
<text text-anchor="middle" x="15512" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15512" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="15512" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;248</text>
</g>
<!-- router4&#45;&gt;expert4_55 -->
<g id="edge448" class="edge">
<title>router4&#45;&gt;expert4_55</title>
<path fill="none" stroke="black" d="M9001.64,-391.23C9845.01,-389.03 15454.16,-373.44 15488,-348 15499.79,-339.13 15506.02,-324.73 15509.24,-310.51"/>
<polygon fill="black" stroke="black" points="15512.76,-310.73 15511.09,-300.27 15505.87,-309.49 15512.76,-310.73"/>
<text text-anchor="middle" x="15636.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 55</text>
<text text-anchor="middle" x="15636.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_56 -->
<g id="node264" class="node">
<title>expert4_56</title>
<polygon fill="#fff0e6" stroke="black" points="15904.5,-300 15683.5,-300 15683.5,-232 15904.5,-232 15904.5,-300"/>
<text text-anchor="middle" x="15794" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 56</text>
<text text-anchor="middle" x="15794" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15794" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="15794" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;249</text>
</g>
<!-- router4&#45;&gt;expert4_56 -->
<g id="edge449" class="edge">
<title>router4&#45;&gt;expert4_56</title>
<path fill="none" stroke="black" d="M9001.68,-391.26C9865.52,-389.24 15734.65,-374.57 15770,-348 15781.79,-339.14 15788.02,-324.73 15791.24,-310.51"/>
<polygon fill="black" stroke="black" points="15794.76,-310.73 15793.09,-300.27 15787.87,-309.49 15794.76,-310.73"/>
<text text-anchor="middle" x="15918.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 56</text>
<text text-anchor="middle" x="15918.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_57 -->
<g id="node265" class="node">
<title>expert4_57</title>
<polygon fill="#fff0e6" stroke="black" points="16186.5,-300 15965.5,-300 15965.5,-232 16186.5,-232 16186.5,-300"/>
<text text-anchor="middle" x="16076" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 57</text>
<text text-anchor="middle" x="16076" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16076" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="16076" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;250</text>
</g>
<!-- router4&#45;&gt;expert4_57 -->
<g id="edge450" class="edge">
<title>router4&#45;&gt;expert4_57</title>
<path fill="none" stroke="black" d="M9001.78,-391.29C9885.95,-389.45 16015.14,-375.7 16052,-348 16063.79,-339.14 16070.03,-324.73 16073.24,-310.51"/>
<polygon fill="black" stroke="black" points="16076.76,-310.73 16075.09,-300.27 16069.87,-309.49 16076.76,-310.73"/>
<text text-anchor="middle" x="16200.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 57</text>
<text text-anchor="middle" x="16200.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_58 -->
<g id="node266" class="node">
<title>expert4_58</title>
<polygon fill="#fff0e6" stroke="black" points="16468.5,-300 16247.5,-300 16247.5,-232 16468.5,-232 16468.5,-300"/>
<text text-anchor="middle" x="16358" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 58</text>
<text text-anchor="middle" x="16358" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16358" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="16358" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;251</text>
</g>
<!-- router4&#45;&gt;expert4_58 -->
<g id="edge451" class="edge">
<title>router4&#45;&gt;expert4_58</title>
<path fill="none" stroke="black" d="M9001.64,-391.31C9904.83,-389.64 16295.62,-376.83 16334,-348 16345.8,-339.14 16352.03,-324.74 16355.25,-310.51"/>
<polygon fill="black" stroke="black" points="16358.76,-310.74 16357.09,-300.27 16351.87,-309.49 16358.76,-310.74"/>
<text text-anchor="middle" x="16482.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 58</text>
<text text-anchor="middle" x="16482.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_59 -->
<g id="node267" class="node">
<title>expert4_59</title>
<polygon fill="#fff0e6" stroke="black" points="16750.5,-300 16529.5,-300 16529.5,-232 16750.5,-232 16750.5,-300"/>
<text text-anchor="middle" x="16640" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 59</text>
<text text-anchor="middle" x="16640" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16640" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="16640" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;252</text>
</g>
<!-- router4&#45;&gt;expert4_59 -->
<g id="edge452" class="edge">
<title>router4&#45;&gt;expert4_59</title>
<path fill="none" stroke="black" d="M9001.62,-391.33C9923.9,-389.83 16576.1,-377.96 16616,-348 16627.8,-339.14 16634.03,-324.74 16637.25,-310.52"/>
<polygon fill="black" stroke="black" points="16640.76,-310.74 16639.09,-300.27 16633.87,-309.49 16640.76,-310.74"/>
<text text-anchor="middle" x="16764.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 59</text>
<text text-anchor="middle" x="16764.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_60 -->
<g id="node268" class="node">
<title>expert4_60</title>
<polygon fill="#fff0e6" stroke="black" points="17032.5,-300 16811.5,-300 16811.5,-232 17032.5,-232 17032.5,-300"/>
<text text-anchor="middle" x="16922" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 60</text>
<text text-anchor="middle" x="16922" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16922" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="16922" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;253</text>
</g>
<!-- router4&#45;&gt;expert4_60 -->
<g id="edge453" class="edge">
<title>router4&#45;&gt;expert4_60</title>
<path fill="none" stroke="black" d="M9001.75,-391.35C9943.35,-390.01 16856.59,-379.1 16898,-348 16909.8,-339.14 16916.03,-324.74 16919.25,-310.52"/>
<polygon fill="black" stroke="black" points="16922.76,-310.74 16921.09,-300.28 16915.88,-309.5 16922.76,-310.74"/>
<text text-anchor="middle" x="17046.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 60</text>
<text text-anchor="middle" x="17046.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_61 -->
<g id="node269" class="node">
<title>expert4_61</title>
<polygon fill="#fff0e6" stroke="black" points="17314.5,-300 17093.5,-300 17093.5,-232 17314.5,-232 17314.5,-300"/>
<text text-anchor="middle" x="17204" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 61</text>
<text text-anchor="middle" x="17204" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17204" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="17204" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;254</text>
</g>
<!-- router4&#45;&gt;expert4_61 -->
<g id="edge454" class="edge">
<title>router4&#45;&gt;expert4_61</title>
<path fill="none" stroke="black" d="M9001.67,-391.37C9961.5,-390.19 17137.07,-380.23 17180,-348 17191.8,-339.14 17198.03,-324.74 17201.25,-310.52"/>
<polygon fill="black" stroke="black" points="17204.76,-310.74 17203.1,-300.28 17197.88,-309.5 17204.76,-310.74"/>
<text text-anchor="middle" x="17328.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 61</text>
<text text-anchor="middle" x="17328.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_62 -->
<g id="node270" class="node">
<title>expert4_62</title>
<polygon fill="#fff0e6" stroke="black" points="17596.5,-300 17375.5,-300 17375.5,-232 17596.5,-232 17596.5,-300"/>
<text text-anchor="middle" x="17486" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 62</text>
<text text-anchor="middle" x="17486" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17486" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="17486" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;255</text>
</g>
<!-- router4&#45;&gt;expert4_62 -->
<g id="edge455" class="edge">
<title>router4&#45;&gt;expert4_62</title>
<path fill="none" stroke="black" d="M9001.79,-391.39C9980.28,-390.35 17417.56,-381.36 17462,-348 17473.8,-339.14 17480.03,-324.74 17483.25,-310.52"/>
<polygon fill="black" stroke="black" points="17486.77,-310.74 17485.1,-300.28 17479.88,-309.5 17486.77,-310.74"/>
<text text-anchor="middle" x="17610.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 62</text>
<text text-anchor="middle" x="17610.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- expert4_63 -->
<g id="node271" class="node">
<title>expert4_63</title>
<polygon fill="#fff0e6" stroke="black" points="17878.5,-300 17657.5,-300 17657.5,-232 17878.5,-232 17878.5,-300"/>
<text text-anchor="middle" x="17768" y="-284.8" font-family="Times,serif" font-size="14.00">Expert 63</text>
<text text-anchor="middle" x="17768" y="-269.8" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17768" y="-254.8" font-family="Times,serif" font-size="14.00">[variable batch, hidden_size]</text>
<text text-anchor="middle" x="17768" y="-239.8" font-family="Times,serif" font-size="14.00">GPU&#45;256</text>
</g>
<!-- router4&#45;&gt;expert4_63 -->
<g id="edge456" class="edge">
<title>router4&#45;&gt;expert4_63</title>
<path fill="none" stroke="black" d="M9001.74,-391.41C9997.9,-390.52 17698.04,-382.5 17744,-348 17755.8,-339.14 17762.03,-324.74 17765.25,-310.52"/>
<polygon fill="black" stroke="black" points="17768.77,-310.74 17767.1,-300.28 17761.88,-309.5 17768.77,-310.74"/>
<text text-anchor="middle" x="17892.5" y="-336.8" font-family="Times,serif" font-size="14.00">tokens for expert 63</text>
<text text-anchor="middle" x="17892.5" y="-321.8" font-family="Times,serif" font-size="14.00">[batch_subset, seq_len, hidden_size]</text>
</g>
<!-- agg4 -->
<g id="node272" class="node">
<title>agg4</title>
<polygon fill="#fff0e6" stroke="black" points="9026,-166 8808,-166 8808,-113 9026,-113 9026,-166"/>
<text text-anchor="middle" x="8917" y="-150.8" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8917" y="-135.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, hidden_size]</text>
<text text-anchor="middle" x="8917" y="-120.8" font-family="Times,serif" font-size="14.00">GPU&#45;193</text>
</g>
<!-- expert4_0&#45;&gt;agg4 -->
<g id="edge457" class="edge">
<title>expert4_0&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M209.68,-231.83C232.02,-213.9 262.14,-193.53 293,-184 399.44,-151.14 7767.28,-141.78 8797.81,-140.63"/>
<polygon fill="black" stroke="black" points="8797.83,-144.13 8807.82,-140.62 8797.82,-137.13 8797.83,-144.13"/>
<text text-anchor="middle" x="391.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 0</text>
<text text-anchor="middle" x="391.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_1&#45;&gt;agg4 -->
<g id="edge458" class="edge">
<title>expert4_1&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M467.03,-231.82C489.58,-213.9 519.94,-193.52 551,-184 654.18,-152.36 7783.11,-141.97 8797.45,-140.65"/>
<polygon fill="black" stroke="black" points="8797.67,-144.15 8807.67,-140.64 8797.66,-137.15 8797.67,-144.15"/>
<text text-anchor="middle" x="649.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 1</text>
<text text-anchor="middle" x="649.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_2&#45;&gt;agg4 -->
<g id="edge459" class="edge">
<title>expert4_2&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M721.02,-231.98C747.22,-213.98 782.24,-193.49 817,-184 917.69,-156.51 7803.03,-142.59 8797.76,-140.72"/>
<polygon fill="black" stroke="black" points="8797.8,-144.22 8807.79,-140.7 8797.78,-137.22 8797.8,-144.22"/>
<text text-anchor="middle" x="915.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 2</text>
<text text-anchor="middle" x="915.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_3&#45;&gt;agg4 -->
<g id="edge460" class="edge">
<title>expert4_3&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M978.03,-231.92C1011.82,-213.9 1056.43,-193.4 1099,-184 1295.35,-140.63 7830.54,-140.28 8797.85,-140.47"/>
<polygon fill="black" stroke="black" points="8797.94,-143.97 8807.94,-140.47 8797.94,-136.97 8797.94,-143.97"/>
<text text-anchor="middle" x="1197.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 3</text>
<text text-anchor="middle" x="1197.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_4&#45;&gt;agg4 -->
<g id="edge461" class="edge">
<title>expert4_4&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M1260.03,-231.92C1293.82,-213.9 1338.43,-193.41 1381,-184 1569.96,-142.24 7849.99,-140.52 8797.72,-140.49"/>
<polygon fill="black" stroke="black" points="8797.95,-143.99 8807.95,-140.49 8797.95,-136.99 8797.95,-143.99"/>
<text text-anchor="middle" x="1479.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 4</text>
<text text-anchor="middle" x="1479.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_5&#45;&gt;agg4 -->
<g id="edge462" class="edge">
<title>expert4_5&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M1542.04,-231.92C1575.82,-213.91 1620.43,-193.41 1663,-184 1844.6,-143.85 7870.85,-140.76 8797.82,-140.52"/>
<polygon fill="black" stroke="black" points="8797.84,-144.02 8807.84,-140.52 8797.84,-137.02 8797.84,-144.02"/>
<text text-anchor="middle" x="1761.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 5</text>
<text text-anchor="middle" x="1761.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_6&#45;&gt;agg4 -->
<g id="edge463" class="edge">
<title>expert4_6&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M1824.04,-231.93C1857.82,-213.91 1902.43,-193.42 1945,-184 2119.24,-145.46 7891.8,-141.01 8797.86,-140.55"/>
<polygon fill="black" stroke="black" points="8797.98,-144.05 8807.97,-140.54 8797.97,-137.05 8797.98,-144.05"/>
<text text-anchor="middle" x="2043.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 6</text>
<text text-anchor="middle" x="2043.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_7&#45;&gt;agg4 -->
<g id="edge464" class="edge">
<title>expert4_7&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M2106.04,-231.93C2139.82,-213.92 2184.44,-193.42 2227,-184 2393.86,-147.07 7911.46,-141.27 8797.49,-140.58"/>
<polygon fill="black" stroke="black" points="8797.7,-144.08 8807.7,-140.57 8797.69,-137.08 8797.7,-144.08"/>
<text text-anchor="middle" x="2325.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 7</text>
<text text-anchor="middle" x="2325.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_8&#45;&gt;agg4 -->
<g id="edge465" class="edge">
<title>expert4_8&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M2388.04,-231.94C2421.83,-213.92 2466.44,-193.43 2509,-184 2668.51,-148.67 7933.01,-141.55 8797.45,-140.62"/>
<polygon fill="black" stroke="black" points="8797.72,-144.12 8807.72,-140.61 8797.72,-137.12 8797.72,-144.12"/>
<text text-anchor="middle" x="2607.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 8</text>
<text text-anchor="middle" x="2607.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_9&#45;&gt;agg4 -->
<g id="edge466" class="edge">
<title>expert4_9&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M2670.04,-231.94C2703.83,-213.93 2748.44,-193.43 2791,-184 2943.18,-150.27 7956.33,-141.83 8797.73,-140.66"/>
<polygon fill="black" stroke="black" points="8797.74,-144.16 8807.74,-140.64 8797.73,-137.16 8797.74,-144.16"/>
<text text-anchor="middle" x="2889.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 9</text>
<text text-anchor="middle" x="2889.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_10&#45;&gt;agg4 -->
<g id="edge467" class="edge">
<title>expert4_10&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M2952.04,-231.95C2985.83,-213.94 3030.44,-193.44 3073,-184 3217.84,-151.87 7979.09,-142.13 8797.76,-140.7"/>
<polygon fill="black" stroke="black" points="8797.79,-144.2 8807.78,-140.68 8797.78,-137.2 8797.79,-144.2"/>
<text text-anchor="middle" x="3171.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 10</text>
<text text-anchor="middle" x="3171.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_11&#45;&gt;agg4 -->
<g id="edge468" class="edge">
<title>expert4_11&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M3234.04,-231.95C3267.83,-213.94 3312.44,-193.45 3355,-184 3492.52,-153.46 8002.77,-142.45 8797.87,-140.74"/>
<polygon fill="black" stroke="black" points="8797.91,-144.24 8807.9,-140.72 8797.9,-137.24 8797.91,-144.24"/>
<text text-anchor="middle" x="3453.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 11</text>
<text text-anchor="middle" x="3453.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_12&#45;&gt;agg4 -->
<g id="edge469" class="edge">
<title>expert4_12&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M3516.04,-231.96C3549.83,-213.95 3594.44,-193.46 3637,-184 3767.19,-155.06 8026.41,-142.78 8797.83,-140.79"/>
<polygon fill="black" stroke="black" points="8797.85,-144.29 8807.84,-140.77 8797.83,-137.29 8797.85,-144.29"/>
<text text-anchor="middle" x="3735.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 12</text>
<text text-anchor="middle" x="3735.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_13&#45;&gt;agg4 -->
<g id="edge470" class="edge">
<title>expert4_13&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M3798.04,-231.97C3831.83,-213.96 3876.45,-193.47 3919,-184 4041.87,-156.66 8050.49,-143.14 8797.72,-140.85"/>
<polygon fill="black" stroke="black" points="8797.96,-144.35 8807.95,-140.82 8797.94,-137.35 8797.96,-144.35"/>
<text text-anchor="middle" x="4017.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 13</text>
<text text-anchor="middle" x="4017.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_14&#45;&gt;agg4 -->
<g id="edge471" class="edge">
<title>expert4_14&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M4080.05,-231.97C4113.84,-213.97 4158.45,-193.48 4201,-184 4316.56,-158.25 8075.17,-143.51 8797.57,-140.92"/>
<polygon fill="black" stroke="black" points="8797.74,-144.42 8807.73,-140.88 8797.72,-137.42 8797.74,-144.42"/>
<text text-anchor="middle" x="4299.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 14</text>
<text text-anchor="middle" x="4299.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_15&#45;&gt;agg4 -->
<g id="edge472" class="edge">
<title>expert4_15&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M4362.05,-231.98C4395.84,-213.99 4440.45,-193.49 4483,-184 4699.22,-135.76 8112.39,-139.1 8797.71,-140.27"/>
<polygon fill="black" stroke="black" points="8797.84,-143.77 8807.84,-140.28 8797.85,-136.77 8797.84,-143.77"/>
<text text-anchor="middle" x="4581.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 15</text>
<text text-anchor="middle" x="4581.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_16&#45;&gt;agg4 -->
<g id="edge473" class="edge">
<title>expert4_16&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M4644.05,-231.99C4677.84,-214 4722.45,-193.51 4765,-184 4966.64,-138.95 8137.95,-139.7 8797.45,-140.35"/>
<polygon fill="black" stroke="black" points="8797.91,-143.85 8807.91,-140.36 8797.91,-136.85 8797.91,-143.85"/>
<text text-anchor="middle" x="4863.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 16</text>
<text text-anchor="middle" x="4863.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_17&#45;&gt;agg4 -->
<g id="edge474" class="edge">
<title>expert4_17&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M4926.45,-231.8C4960.19,-213.86 5004.62,-193.49 5047,-184 5234.14,-142.11 8166.07,-140.34 8797.69,-140.45"/>
<polygon fill="black" stroke="black" points="8797.72,-143.95 8807.72,-140.45 8797.72,-136.95 8797.72,-143.95"/>
<text text-anchor="middle" x="5145.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 17</text>
<text text-anchor="middle" x="5145.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_18&#45;&gt;agg4 -->
<g id="edge475" class="edge">
<title>expert4_18&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M5208.45,-231.81C5242.2,-213.88 5286.63,-193.5 5329,-184 5501.64,-145.28 8194.35,-141.02 8797.67,-140.56"/>
<polygon fill="black" stroke="black" points="8797.7,-144.06 8807.69,-140.55 8797.69,-137.06 8797.7,-144.06"/>
<text text-anchor="middle" x="5427.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 18</text>
<text text-anchor="middle" x="5427.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_19&#45;&gt;agg4 -->
<g id="edge476" class="edge">
<title>expert4_19&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M5490.45,-231.83C5524.2,-213.9 5568.63,-193.53 5611,-184 5769.15,-148.44 8223.01,-141.77 8797.39,-140.69"/>
<polygon fill="black" stroke="black" points="8797.76,-144.19 8807.75,-140.67 8797.75,-137.19 8797.76,-144.19"/>
<text text-anchor="middle" x="5709.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 19</text>
<text text-anchor="middle" x="5709.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_20&#45;&gt;agg4 -->
<g id="edge477" class="edge">
<title>expert4_20&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M5772.46,-231.85C5806.21,-213.92 5850.64,-193.55 5893,-184 6036.74,-151.59 8254.04,-142.57 8797.47,-140.84"/>
<polygon fill="black" stroke="black" points="8797.69,-144.34 8807.67,-140.81 8797.66,-137.34 8797.69,-144.34"/>
<text text-anchor="middle" x="5991.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 20</text>
<text text-anchor="middle" x="5991.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_21&#45;&gt;agg4 -->
<g id="edge478" class="edge">
<title>expert4_21&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M6054.46,-231.87C6088.21,-213.95 6132.65,-193.58 6175,-184 6304.35,-154.73 8286.19,-143.46 8797.42,-141.03"/>
<polygon fill="black" stroke="black" points="8797.78,-144.53 8807.77,-140.98 8797.75,-137.53 8797.78,-144.53"/>
<text text-anchor="middle" x="6273.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 21</text>
<text text-anchor="middle" x="6273.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_22&#45;&gt;agg4 -->
<g id="edge479" class="edge">
<title>expert4_22&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M6336.13,-231.9C6369.68,-213.99 6413.86,-193.62 6456,-184 6571.08,-157.72 8321.33,-144.4 8797.94,-141.24"/>
<polygon fill="black" stroke="black" points="8797.97,-144.74 8807.94,-141.18 8797.92,-137.74 8797.97,-144.74"/>
<text text-anchor="middle" x="6554.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 22</text>
<text text-anchor="middle" x="6554.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_23&#45;&gt;agg4 -->
<g id="edge480" class="edge">
<title>expert4_23&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M6617.45,-231.93C6650.61,-214.04 6694.29,-193.67 6736,-184 6936.65,-137.48 8371.27,-138.61 8797.73,-140"/>
<polygon fill="black" stroke="black" points="8797.91,-143.5 8807.92,-140.03 8797.93,-136.5 8797.91,-143.5"/>
<text text-anchor="middle" x="6834.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 23</text>
<text text-anchor="middle" x="6834.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_24&#45;&gt;agg4 -->
<g id="edge481" class="edge">
<title>expert4_24&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M6898.78,-231.98C6931.54,-214.1 6974.72,-193.73 7016,-184 7188.43,-143.35 8408.29,-140.29 8797.78,-140.36"/>
<polygon fill="black" stroke="black" points="8797.94,-143.86 8807.94,-140.36 8797.94,-136.86 8797.94,-143.86"/>
<text text-anchor="middle" x="7114.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 24</text>
<text text-anchor="middle" x="7114.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_25&#45;&gt;agg4 -->
<g id="edge482" class="edge">
<title>expert4_25&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M7179.45,-231.83C7211.18,-214.02 7252.93,-193.77 7293,-184 7437.57,-148.74 8447.48,-142.05 8797.72,-140.79"/>
<polygon fill="black" stroke="black" points="8797.9,-144.29 8807.89,-140.76 8797.87,-137.29 8797.9,-144.29"/>
<text text-anchor="middle" x="7391.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 25</text>
<text text-anchor="middle" x="7391.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_26&#45;&gt;agg4 -->
<g id="edge483" class="edge">
<title>expert4_26&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M7458.39,-231.91C7488.94,-214.13 7529.19,-193.88 7568,-184 7685.14,-154.19 8489.87,-144.17 8797.65,-141.41"/>
<polygon fill="black" stroke="black" points="8797.97,-144.91 8807.94,-141.32 8797.91,-137.91 8797.97,-144.91"/>
<text text-anchor="middle" x="7666.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 26</text>
<text text-anchor="middle" x="7666.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_27&#45;&gt;agg4 -->
<g id="edge484" class="edge">
<title>expert4_27&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M7736.28,-231.81C7764.81,-214.11 7802.41,-193.98 7839,-184 7929.33,-159.36 8536.21,-146.67 8797.6,-142.3"/>
<polygon fill="black" stroke="black" points="8797.95,-145.79 8807.89,-142.13 8797.84,-138.79 8797.95,-145.79"/>
<text text-anchor="middle" x="7937.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 27</text>
<text text-anchor="middle" x="7937.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_28&#45;&gt;agg4 -->
<g id="edge485" class="edge">
<title>expert4_28&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M8010.71,-231.97C8036.06,-214.33 8069.68,-194.2 8103,-184 8229.22,-145.38 8603.69,-139.95 8797.61,-139.84"/>
<polygon fill="black" stroke="black" points="8797.84,-143.34 8807.84,-139.84 8797.84,-136.34 8797.84,-143.34"/>
<text text-anchor="middle" x="8201.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 28</text>
<text text-anchor="middle" x="8201.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_29&#45;&gt;agg4 -->
<g id="edge486" class="edge">
<title>expert4_29&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M8280.35,-231.61C8301.04,-214.2 8328.62,-194.42 8357,-184 8435.03,-155.35 8657.49,-145.57 8797.4,-142.23"/>
<polygon fill="black" stroke="black" points="8797.83,-145.72 8807.75,-141.99 8797.67,-138.72 8797.83,-145.72"/>
<text text-anchor="middle" x="8455.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 29</text>
<text text-anchor="middle" x="8455.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_30&#45;&gt;agg4 -->
<g id="edge487" class="edge">
<title>expert4_30&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M8541.43,-231.75C8555.9,-214.62 8575.73,-195.05 8598,-184 8632.5,-166.89 8722.3,-155.59 8797.87,-148.81"/>
<polygon fill="black" stroke="black" points="8798.3,-152.29 8807.95,-147.92 8797.68,-145.31 8798.3,-152.29"/>
<text text-anchor="middle" x="8696.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 30</text>
<text text-anchor="middle" x="8696.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_31&#45;&gt;agg4 -->
<g id="edge488" class="edge">
<title>expert4_31&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M8793.4,-231.78C8797.95,-215.7 8805.54,-197.08 8818,-184 8822.33,-179.45 8827.23,-175.35 8832.46,-171.65"/>
<polygon fill="black" stroke="black" points="8834.43,-174.54 8840.93,-166.17 8830.63,-168.67 8834.43,-174.54"/>
<text text-anchor="middle" x="8916.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 31</text>
<text text-anchor="middle" x="8916.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_32&#45;&gt;agg4 -->
<g id="edge489" class="edge">
<title>expert4_32&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M9040.14,-231.79C9035.38,-215.71 9027.56,-197.09 9015,-184 9010.6,-179.42 9005.64,-175.28 9000.33,-171.56"/>
<polygon fill="black" stroke="black" points="9002.05,-168.5 8991.75,-166.04 8998.26,-174.39 9002.05,-168.5"/>
<text text-anchor="middle" x="9131.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 32</text>
<text text-anchor="middle" x="9131.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_33&#45;&gt;agg4 -->
<g id="edge490" class="edge">
<title>expert4_33&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M9292.42,-231.76C9277.34,-214.63 9256.78,-195.06 9234,-184 9199.68,-167.35 9110.96,-156.04 9036.07,-149.14"/>
<polygon fill="black" stroke="black" points="9036.35,-145.65 9026.08,-148.24 9035.72,-152.62 9036.35,-145.65"/>
<text text-anchor="middle" x="9373.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 33</text>
<text text-anchor="middle" x="9373.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_34&#45;&gt;agg4 -->
<g id="edge491" class="edge">
<title>expert4_34&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M9557.35,-231.83C9535.24,-214.37 9505.83,-194.47 9476,-184 9397.77,-156.53 9176.1,-146.36 9036.55,-142.63"/>
<polygon fill="black" stroke="black" points="9036.32,-139.12 9026.23,-142.36 9036.14,-146.12 9036.32,-139.12"/>
<text text-anchor="middle" x="9629.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 34</text>
<text text-anchor="middle" x="9629.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_35&#45;&gt;agg4 -->
<g id="edge492" class="edge">
<title>expert4_35&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M9828.83,-231.98C9802.08,-214.34 9766.72,-194.2 9732,-184 9605.21,-146.73 9230.47,-140.68 9036.44,-140.14"/>
<polygon fill="black" stroke="black" points="9036.21,-136.64 9026.2,-140.12 9036.2,-143.64 9036.21,-136.64"/>
<text text-anchor="middle" x="9895.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 35</text>
<text text-anchor="middle" x="9895.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_36&#45;&gt;agg4 -->
<g id="edge493" class="edge">
<title>expert4_36&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M10104.62,-231.81C10074.9,-214.12 10035.81,-193.99 9998,-184 9907.22,-160.02 9298.77,-146.96 9036.7,-142.39"/>
<polygon fill="black" stroke="black" points="9036.44,-138.89 9026.38,-142.22 9036.32,-145.89 9036.44,-138.89"/>
<text text-anchor="middle" x="10167.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 36</text>
<text text-anchor="middle" x="10167.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_37&#45;&gt;agg4 -->
<g id="edge494" class="edge">
<title>expert4_37&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M10382.88,-231.91C10351.34,-214.13 10309.84,-193.88 10270,-184 10152.29,-154.81 9344.84,-144.41 9036.41,-141.48"/>
<polygon fill="black" stroke="black" points="9036.13,-137.98 9026.09,-141.38 9036.06,-144.98 9036.13,-137.98"/>
<text text-anchor="middle" x="10443.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 37</text>
<text text-anchor="middle" x="10443.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_38&#45;&gt;agg4 -->
<g id="edge495" class="edge">
<title>expert4_38&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M10662.83,-231.83C10630.1,-214.02 10587.1,-193.77 10546,-184 10400.74,-149.46 9387.3,-142.31 9036.32,-140.86"/>
<polygon fill="black" stroke="black" points="9036.15,-137.36 9026.13,-140.82 9036.12,-144.36 9036.15,-137.36"/>
<text text-anchor="middle" x="10722.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 38</text>
<text text-anchor="middle" x="10722.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_39&#45;&gt;agg4 -->
<g id="edge496" class="edge">
<title>expert4_39&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M10944.2,-231.98C10910.83,-214.1 10866.91,-193.73 10825,-184 10651.75,-143.77 9426.83,-140.42 9036.31,-140.39"/>
<polygon fill="black" stroke="black" points="9036.12,-136.89 9026.12,-140.39 9036.12,-143.89 9036.12,-136.89"/>
<text text-anchor="middle" x="11002.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 39</text>
<text text-anchor="middle" x="11002.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_40&#45;&gt;agg4 -->
<g id="edge497" class="edge">
<title>expert4_40&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M11225.52,-231.93C11191.77,-214.04 11147.34,-193.67 11105,-184 10903.5,-137.98 9463.62,-138.77 9036.28,-140.04"/>
<polygon fill="black" stroke="black" points="9036.05,-136.54 9026.06,-140.07 9036.07,-143.54 9036.05,-136.54"/>
<text text-anchor="middle" x="11283.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 40</text>
<text text-anchor="middle" x="11283.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_41&#45;&gt;agg4 -->
<g id="edge498" class="edge">
<title>expert4_41&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M11507.19,-231.9C11473.24,-213.99 11428.55,-193.62 11386,-184 11270.46,-157.88 9513.6,-144.43 9036.04,-141.25"/>
<polygon fill="black" stroke="black" points="9036.04,-137.75 9026.02,-141.18 9036,-144.75 9036.04,-137.75"/>
<text text-anchor="middle" x="11564.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 41</text>
<text text-anchor="middle" x="11564.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_42&#45;&gt;agg4 -->
<g id="edge499" class="edge">
<title>expert4_42&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M11788.85,-231.87C11754.7,-213.95 11709.77,-193.58 11667,-184 11537.18,-154.92 9548.53,-143.5 9036.5,-141.03"/>
<polygon fill="black" stroke="black" points="9036.15,-137.53 9026.14,-140.99 9036.12,-144.53 9036.15,-137.53"/>
<text text-anchor="middle" x="11846.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 42</text>
<text text-anchor="middle" x="11846.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_43&#45;&gt;agg4 -->
<g id="edge500" class="edge">
<title>expert4_43&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M12070.86,-231.84C12036.71,-213.92 11991.78,-193.55 11949,-184 11804.77,-151.8 9580.47,-142.62 9036.4,-140.85"/>
<polygon fill="black" stroke="black" points="9036.19,-137.35 9026.18,-140.82 9036.16,-144.35 9036.19,-137.35"/>
<text text-anchor="middle" x="12128.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 43</text>
<text text-anchor="middle" x="12128.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_44&#45;&gt;agg4 -->
<g id="edge501" class="edge">
<title>expert4_44&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M12352.86,-231.82C12318.72,-213.9 12273.78,-193.52 12231,-184 12072.34,-148.68 9611.3,-141.82 9036.43,-140.7"/>
<polygon fill="black" stroke="black" points="9036.06,-137.2 9026.05,-140.68 9036.04,-144.2 9036.06,-137.2"/>
<text text-anchor="middle" x="12410.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 44</text>
<text text-anchor="middle" x="12410.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_45&#45;&gt;agg4 -->
<g id="edge502" class="edge">
<title>expert4_45&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M12634.87,-231.81C12600.72,-213.87 12555.79,-193.5 12513,-184 12339.84,-145.55 9639.76,-141.09 9036.09,-140.57"/>
<polygon fill="black" stroke="black" points="9036.07,-137.07 9026.07,-140.56 9036.06,-144.07 9036.07,-137.07"/>
<text text-anchor="middle" x="12692.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 45</text>
<text text-anchor="middle" x="12692.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_46&#45;&gt;agg4 -->
<g id="edge503" class="edge">
<title>expert4_46&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M12916.87,-231.79C12882.73,-213.85 12837.79,-193.48 12795,-184 12607.33,-142.41 9667.86,-140.41 9036.03,-140.46"/>
<polygon fill="black" stroke="black" points="9036,-136.96 9026,-140.46 9036,-143.96 9036,-136.96"/>
<text text-anchor="middle" x="12974.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 46</text>
<text text-anchor="middle" x="12974.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_47&#45;&gt;agg4 -->
<g id="edge504" class="edge">
<title>expert4_47&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M13199.27,-231.99C13165.08,-214 13119.96,-193.5 13077,-184 12874.85,-139.28 9696.67,-139.77 9036.51,-140.36"/>
<polygon fill="black" stroke="black" points="9036.03,-136.86 9026.04,-140.37 9036.04,-143.86 9036.03,-136.86"/>
<text text-anchor="middle" x="13256.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 47</text>
<text text-anchor="middle" x="13256.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_48&#45;&gt;agg4 -->
<g id="edge505" class="edge">
<title>expert4_48&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M13481.27,-231.98C13447.08,-213.98 13401.97,-193.49 13359,-184 13142.26,-136.13 9722.12,-139.18 9036.22,-140.28"/>
<polygon fill="black" stroke="black" points="9036.08,-136.78 9026.08,-140.3 9036.09,-143.78 9036.08,-136.78"/>
<text text-anchor="middle" x="13538.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 48</text>
<text text-anchor="middle" x="13538.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_49&#45;&gt;agg4 -->
<g id="edge506" class="edge">
<title>expert4_49&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M13763.27,-231.97C13729.09,-213.97 13683.97,-193.48 13641,-184 13525.17,-158.45 9759.23,-143.55 9036.34,-140.92"/>
<polygon fill="black" stroke="black" points="9036.18,-137.42 9026.17,-140.88 9036.16,-144.42 9036.18,-137.42"/>
<text text-anchor="middle" x="13820.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 49</text>
<text text-anchor="middle" x="13820.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_50&#45;&gt;agg4 -->
<g id="edge507" class="edge">
<title>expert4_50&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M14045.28,-231.96C14011.09,-213.96 13965.97,-193.47 13923,-184 13799.87,-156.88 9784.89,-143.18 9036.47,-140.86"/>
<polygon fill="black" stroke="black" points="9036.23,-137.36 9026.22,-140.83 9036.21,-144.36 9036.23,-137.36"/>
<text text-anchor="middle" x="14102.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 50</text>
<text text-anchor="middle" x="14102.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_51&#45;&gt;agg4 -->
<g id="edge508" class="edge">
<title>expert4_51&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M14327.28,-231.96C14293.09,-213.95 14247.97,-193.46 14205,-184 14074.53,-155.29 9807.78,-142.82 9036.04,-140.8"/>
<polygon fill="black" stroke="black" points="9036.04,-137.3 9026.03,-140.77 9036.02,-144.3 9036.04,-137.3"/>
<text text-anchor="middle" x="14384.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 51</text>
<text text-anchor="middle" x="14384.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_52&#45;&gt;agg4 -->
<g id="edge509" class="edge">
<title>expert4_52&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M14609.28,-231.95C14575.09,-213.94 14529.98,-193.45 14487,-184 14349.22,-153.71 9832.53,-142.49 9036.3,-140.75"/>
<polygon fill="black" stroke="black" points="9036.26,-137.25 9026.25,-140.73 9036.25,-144.25 9036.26,-137.25"/>
<text text-anchor="middle" x="14666.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 52</text>
<text text-anchor="middle" x="14666.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_53&#45;&gt;agg4 -->
<g id="edge510" class="edge">
<title>expert4_53&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M14891.28,-231.94C14857.09,-213.93 14811.98,-193.44 14769,-184 14623.87,-152.13 9854.91,-142.18 9036.08,-140.7"/>
<polygon fill="black" stroke="black" points="9036.05,-137.2 9026.05,-140.68 9036.04,-144.2 9036.05,-137.2"/>
<text text-anchor="middle" x="14948.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 53</text>
<text text-anchor="middle" x="14948.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_54&#45;&gt;agg4 -->
<g id="edge511" class="edge">
<title>expert4_54&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M15173.28,-231.94C15139.1,-213.93 15093.98,-193.43 15051,-184 14898.53,-150.54 9877.58,-141.88 9036.09,-140.66"/>
<polygon fill="black" stroke="black" points="9036.09,-137.16 9026.08,-140.65 9036.08,-144.16 9036.09,-137.16"/>
<text text-anchor="middle" x="15230.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 54</text>
<text text-anchor="middle" x="15230.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_55&#45;&gt;agg4 -->
<g id="edge512" class="edge">
<title>expert4_55&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M15455.28,-231.93C15421.1,-213.92 15375.98,-193.42 15333,-184 15173.2,-148.96 9900.81,-141.6 9036.36,-140.62"/>
<polygon fill="black" stroke="black" points="9036.09,-137.12 9026.08,-140.61 9036.08,-144.12 9036.09,-137.12"/>
<text text-anchor="middle" x="15512.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 55</text>
<text text-anchor="middle" x="15512.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_56&#45;&gt;agg4 -->
<g id="edge513" class="edge">
<title>expert4_56&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M15737.28,-231.93C15703.1,-213.91 15657.98,-193.42 15615,-184 15447.84,-147.37 9922.27,-141.32 9036.3,-140.59"/>
<polygon fill="black" stroke="black" points="9036.1,-137.09 9026.09,-140.58 9036.09,-144.09 9036.1,-137.09"/>
<text text-anchor="middle" x="15794.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 56</text>
<text text-anchor="middle" x="15794.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_57&#45;&gt;agg4 -->
<g id="edge514" class="edge">
<title>expert4_57&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M16019.28,-231.92C15985.1,-213.91 15939.98,-193.41 15897,-184 15722.48,-145.78 9943.37,-141.06 9036.27,-140.56"/>
<polygon fill="black" stroke="black" points="9036.15,-137.06 9026.15,-140.55 9036.15,-144.06 9036.15,-137.06"/>
<text text-anchor="middle" x="16076.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 57</text>
<text text-anchor="middle" x="16076.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_58&#45;&gt;agg4 -->
<g id="edge515" class="edge">
<title>expert4_58&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M16301.29,-231.92C16267.1,-213.9 16221.98,-193.41 16179,-184 15997.11,-144.19 9964.29,-140.81 9036.31,-140.53"/>
<polygon fill="black" stroke="black" points="9036.28,-137.03 9026.28,-140.52 9036.28,-144.03 9036.28,-137.03"/>
<text text-anchor="middle" x="16358.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 58</text>
<text text-anchor="middle" x="16358.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_59&#45;&gt;agg4 -->
<g id="edge516" class="edge">
<title>expert4_59&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M16583.29,-231.92C16549.1,-213.9 16503.99,-193.4 16461,-184 16271.75,-142.6 9985.13,-140.57 9036.41,-140.5"/>
<polygon fill="black" stroke="black" points="9036.16,-137 9026.16,-140.5 9036.16,-144 9036.16,-137"/>
<text text-anchor="middle" x="16640.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 59</text>
<text text-anchor="middle" x="16640.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_60&#45;&gt;agg4 -->
<g id="edge517" class="edge">
<title>expert4_60&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M16865.29,-231.91C16831.1,-213.89 16785.99,-193.4 16743,-184 16546.36,-141.01 10004.56,-140.34 9036.28,-140.47"/>
<polygon fill="black" stroke="black" points="9036.17,-136.97 9026.17,-140.47 9036.17,-143.97 9036.17,-136.97"/>
<text text-anchor="middle" x="16922.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 60</text>
<text text-anchor="middle" x="16922.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_61&#45;&gt;agg4 -->
<g id="edge518" class="edge">
<title>expert4_61&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M17147.29,-231.91C17113.1,-213.89 17067.99,-193.39 17025,-184 16821,-139.42 10025.93,-140.11 9036.65,-140.45"/>
<polygon fill="black" stroke="black" points="9036.32,-136.95 9026.33,-140.45 9036.33,-143.95 9036.32,-136.95"/>
<text text-anchor="middle" x="17204.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 61</text>
<text text-anchor="middle" x="17204.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_62&#45;&gt;agg4 -->
<g id="edge519" class="edge">
<title>expert4_62&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M17429.29,-231.91C17395.1,-213.88 17349.99,-193.39 17307,-184 17095.6,-137.82 10044.31,-139.89 9036.44,-140.43"/>
<polygon fill="black" stroke="black" points="9036.28,-136.93 9026.29,-140.43 9036.29,-143.93 9036.28,-136.93"/>
<text text-anchor="middle" x="17486.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 62</text>
<text text-anchor="middle" x="17486.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- expert4_63&#45;&gt;agg4 -->
<g id="edge520" class="edge">
<title>expert4_63&#45;&gt;agg4</title>
<path fill="none" stroke="black" d="M17711.29,-231.91C17677.11,-213.88 17631.99,-193.39 17589,-184 17370.2,-136.23 10063.09,-139.68 9036.39,-140.41"/>
<polygon fill="black" stroke="black" points="9036.05,-136.91 9026.05,-140.41 9036.05,-143.91 9036.05,-136.91"/>
<text text-anchor="middle" x="17768.5" y="-202.8" font-family="Times,serif" font-size="14.00">expert output 63</text>
<text text-anchor="middle" x="17768.5" y="-187.8" font-family="Times,serif" font-size="14.00">[batch_subset, hidden_size]</text>
</g>
<!-- output -->
<g id="node274" class="node">
<title>output</title>
<polygon fill="#f0f0f0" stroke="black" points="9022,-76 8812,-76 8812,-23 9022,-23 9022,-76"/>
<text text-anchor="middle" x="8917" y="-60.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="8917" y="-45.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, vocab_size]</text>
<text text-anchor="middle" x="8917" y="-30.8" font-family="Times,serif" font-size="14.00">GPU&#45;256</text>
</g>
<!-- agg4&#45;&gt;output -->
<g id="edge525" class="edge">
<title>agg4&#45;&gt;output</title>
<path fill="none" stroke="black" d="M8917,-112.57C8917,-104.34 8917,-95.08 8917,-86.28"/>
<polygon fill="black" stroke="black" points="8920.5,-86.24 8917,-76.24 8913.5,-86.24 8920.5,-86.24"/>
</g>
<!-- input -->
<g id="node273" class="node">
<title>input</title>
<polygon fill="#f0f0f0" stroke="black" points="9069,-2342 8765,-2342 8765,-2289 9069,-2289 9069,-2342"/>
<text text-anchor="middle" x="8917" y="-2326.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="8917" y="-2311.8" font-family="Times,serif" font-size="14.00">[batch_size=1024, seq_len, hidden_size]</text>
<text text-anchor="middle" x="8917" y="-2296.8" font-family="Times,serif" font-size="14.00">GPU&#45;0 (Input Processing)</text>
</g>
<!-- input&#45;&gt;pre_layer1_norm -->
<g id="edge521" class="edge">
<title>input&#45;&gt;pre_layer1_norm</title>
<path fill="none" stroke="black" d="M8917,-2288.94C8917,-2274.83 8917,-2257.08 8917,-2241.57"/>
<polygon fill="black" stroke="black" points="8920.5,-2241.27 8917,-2231.27 8913.5,-2241.27 8920.5,-2241.27"/>
</g>
</g>
</svg>
