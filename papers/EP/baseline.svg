<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: BaselineDeployment Pages: 1 -->
<svg width="5760pt" height="776pt"
 viewBox="0.00 0.00 5760.00 775.52" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.23 0.23) rotate(0) translate(4 3442.12)">
<title>BaselineDeployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3442.12 25591.27,-3442.12 25591.27,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="20718,-3219.95 20718,-3419.51 21008,-3419.51 21008,-3219.95 20718,-3219.95"/>
<text text-anchor="middle" x="20863" y="-3404.31" font-family="Times,serif" font-size="14.00">Input Processing</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_0</title>
<path fill="none" stroke="black" d="M10613,-2479.95C10613,-2479.95 25552,-2479.95 25552,-2479.95 25558,-2479.95 25564,-2485.95 25564,-2491.95 25564,-2491.95 25564,-3188.95 25564,-3188.95 25564,-3194.95 25558,-3200.95 25552,-3200.95 25552,-3200.95 10613,-3200.95 10613,-3200.95 10607,-3200.95 10601,-3194.95 10601,-3188.95 10601,-3188.95 10601,-2491.95 10601,-2491.95 10601,-2485.95 10607,-2479.95 10613,-2479.95"/>
<text text-anchor="middle" x="18082.5" y="-3185.75" font-family="Times,serif" font-size="14.00">MoE Layer 1 &#45; Pipeline Stage 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_1</title>
<path fill="none" stroke="black" d="M7082,-1739.95C7082,-1739.95 22021,-1739.95 22021,-1739.95 22027,-1739.95 22033,-1745.95 22033,-1751.95 22033,-1751.95 22033,-2448.95 22033,-2448.95 22033,-2454.95 22027,-2460.95 22021,-2460.95 22021,-2460.95 7082,-2460.95 7082,-2460.95 7076,-2460.95 7070,-2454.95 7070,-2448.95 7070,-2448.95 7070,-1751.95 7070,-1751.95 7070,-1745.95 7076,-1739.95 7082,-1739.95"/>
<text text-anchor="middle" x="14551.5" y="-2445.75" font-family="Times,serif" font-size="14.00">MoE Layer 2 &#45; Pipeline Stage 1</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_2</title>
<path fill="none" stroke="black" d="M3551,-970.95C3551,-970.95 18490,-970.95 18490,-970.95 18496,-970.95 18502,-976.95 18502,-982.95 18502,-982.95 18502,-1679.95 18502,-1679.95 18502,-1685.95 18496,-1691.95 18490,-1691.95 18490,-1691.95 3551,-1691.95 3551,-1691.95 3545,-1691.95 3539,-1685.95 3539,-1679.95 3539,-1679.95 3539,-982.95 3539,-982.95 3539,-976.95 3545,-970.95 3551,-970.95"/>
<text text-anchor="middle" x="11020.5" y="-1676.75" font-family="Times,serif" font-size="14.00">MoE Layer 3 &#45; Pipeline Stage 2</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer_3</title>
<path fill="none" stroke="black" d="M20,-230.95C20,-230.95 14959,-230.95 14959,-230.95 14965,-230.95 14971,-236.95 14971,-242.95 14971,-242.95 14971,-939.95 14971,-939.95 14971,-945.95 14965,-951.95 14959,-951.95 14959,-951.95 20,-951.95 20,-951.95 14,-951.95 8,-945.95 8,-939.95 8,-939.95 8,-242.95 8,-242.95 8,-236.95 14,-230.95 20,-230.95"/>
<text text-anchor="middle" x="7489.5" y="-936.75" font-family="Times,serif" font-size="14.00">MoE Layer 4 &#45; Pipeline Stage 2</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_output</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7568,-8 7568,-211.95 7858,-211.95 7858,-8 7568,-8"/>
<text text-anchor="middle" x="7713" y="-196.75" font-family="Times,serif" font-size="14.00">Output Processing</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_communication</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="24425,-3294.95 24425,-3430.12 24711,-3430.12 24711,-3294.95 24425,-3294.95"/>
<text text-anchor="middle" x="24568" y="-3414.92" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
</g>
<!-- input_tokens -->
<g id="node1" class="node">
<title>input_tokens</title>
<ellipse fill="white" stroke="black" cx="20863" cy="-3351.04" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="20863" y="-3362.34" font-family="Times,serif" font-size="14.00">Input Tokens</text>
<text text-anchor="middle" x="20863" y="-3347.34" font-family="Times,serif" font-size="14.00">(Batch: 1024 tokens)</text>
<text text-anchor="middle" x="20863" y="-3332.34" font-family="Times,serif" font-size="14.00">Dim: [1024, hidden_size]</text>
</g>
<!-- embed -->
<g id="node2" class="node">
<title>embed</title>
<polygon fill="lightgray" stroke="black" points="20934.5,-3265.95 20791.5,-3265.95 20791.5,-3227.95 20934.5,-3227.95 20934.5,-3265.95"/>
<text text-anchor="middle" x="20863" y="-3250.75" font-family="Times,serif" font-size="14.00">Embedding Layer</text>
<text text-anchor="middle" x="20863" y="-3235.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- input_tokens&#45;&gt;embed -->
<g id="edge1" class="edge">
<title>input_tokens&#45;&gt;embed</title>
<path fill="none" stroke="black" d="M20863,-3313.47C20863,-3301.24 20863,-3287.81 20863,-3276.31"/>
<polygon fill="black" stroke="black" points="20866.5,-3275.97 20863,-3265.97 20859.5,-3275.97 20866.5,-3275.97"/>
</g>
<!-- layer_0_mha -->
<g id="node3" class="node">
<title>layer_0_mha</title>
<polygon fill="lightblue" stroke="black" points="21036.5,-3169.95 20689.5,-3169.95 20689.5,-3086.95 21036.5,-3086.95 21036.5,-3169.95"/>
<text text-anchor="middle" x="20863" y="-3154.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="20863" y="-3139.75" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="20863" y="-3124.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="20863" y="-3109.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
<text text-anchor="middle" x="20863" y="-3094.75" font-family="Times,serif" font-size="14.00">[1024, hidden_size/8] &#45;&gt; [1024, hidden_size/8]</text>
</g>
<!-- embed&#45;&gt;layer_0_mha -->
<g id="edge2" class="edge">
<title>embed&#45;&gt;layer_0_mha</title>
<path fill="none" stroke="black" d="M20863,-3227.75C20863,-3215.03 20863,-3197.37 20863,-3180.53"/>
<polygon fill="black" stroke="black" points="20866.5,-3180.2 20863,-3170.2 20859.5,-3180.2 20866.5,-3180.2"/>
</g>
<!-- layer_0_residual_mha -->
<g id="node4" class="node">
<title>layer_0_residual_mha</title>
<polygon fill="lightgreen" stroke="black" points="21052.5,-3049.95 20673.5,-3049.95 20673.5,-2981.95 21052.5,-2981.95 21052.5,-3049.95"/>
<text text-anchor="middle" x="20863" y="-3034.75" font-family="Times,serif" font-size="14.00">Add &amp; LayerNorm</text>
<text text-anchor="middle" x="20863" y="-3019.75" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="20863" y="-3004.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="20863" y="-2989.75" font-family="Times,serif" font-size="14.00">Add: [1024, hidden_size/8] + [1024, hidden_size/8]</text>
</g>
<!-- layer_0_mha&#45;&gt;layer_0_residual_mha -->
<g id="edge3" class="edge">
<title>layer_0_mha&#45;&gt;layer_0_residual_mha</title>
<path fill="none" stroke="black" d="M20863,-3086.93C20863,-3078.26 20863,-3069.06 20863,-3060.28"/>
<polygon fill="black" stroke="black" points="20866.5,-3060.22 20863,-3050.22 20859.5,-3060.22 20866.5,-3060.22"/>
</g>
<!-- layer_0_gate -->
<g id="node5" class="node">
<title>layer_0_gate</title>
<polygon fill="lightyellow" stroke="black" points="18440,-2944.95 18172,-2944.95 18172,-2861.95 18440,-2861.95 18440,-2944.95"/>
<text text-anchor="middle" x="18306" y="-2929.75" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="18306" y="-2914.75" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="18306" y="-2899.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="18306" y="-2884.75" font-family="Times,serif" font-size="14.00">[1024, hidden_size/8] &#45;&gt; [1024, 64]</text>
<text text-anchor="middle" x="18306" y="-2869.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- layer_0_residual_mha&#45;&gt;layer_0_gate -->
<g id="edge4" class="edge">
<title>layer_0_residual_mha&#45;&gt;layer_0_gate</title>
<path fill="none" stroke="black" d="M20673.42,-3006.76C20183.93,-2985.61 18885.67,-2929.5 18450.49,-2910.7"/>
<polygon fill="black" stroke="black" points="18450.51,-2907.2 18440.37,-2910.26 18450.21,-2914.19 18450.51,-2907.2"/>
</g>
<!-- layer_0_expert_agg -->
<g id="node6" class="node">
<title>layer_0_expert_agg</title>
<polygon fill="lightpink" stroke="black" points="18412,-2675.95 18200,-2675.95 18200,-2592.95 18412,-2592.95 18412,-2675.95"/>
<text text-anchor="middle" x="18306" y="-2660.75" font-family="Times,serif" font-size="14.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="18306" y="-2645.75" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="18306" y="-2630.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="18306" y="-2615.75" font-family="Times,serif" font-size="14.00">AllReduce across 8 GPUs</text>
<text text-anchor="middle" x="18306" y="-2600.75" font-family="Times,serif" font-size="14.00">[1024, hidden_size/8]</text>
</g>
<!-- layer_0_residual_mha&#45;&gt;layer_0_expert_agg -->
<g id="edge5" class="edge">
<title>layer_0_residual_mha&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M21052.6,-3009.45C21633.43,-2992.04 23439.47,-2934.02 24934,-2843.95 25211.22,-2827.25 25739.77,-2910.93 25545,-2712.95 25479.81,-2646.69 19348.42,-2636.71 18422.55,-2635.58"/>
<polygon fill="black" stroke="black" points="18422.23,-2632.08 18412.22,-2635.57 18422.22,-2639.08 18422.23,-2632.08"/>
</g>
<!-- layer_0_expert_0_gpu0 -->
<g id="node8" class="node">
<title>layer_0_expert_0_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="11058.5,-2795.95 10609.5,-2795.95 10609.5,-2712.95 11058.5,-2712.95 11058.5,-2795.95"/>
<text text-anchor="middle" x="10834" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="10834" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="10834" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10834" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="10834" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_0_gpu0 -->
<g id="edge7" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18171.73,-2901.95C17283.69,-2898.55 12270.7,-2877.94 11592,-2843.95 11361.74,-2832.42 11301.54,-2826.75 11068.88,-2796.04"/>
<polygon fill="black" stroke="black" points="11069.12,-2792.55 11058.74,-2794.71 11068.2,-2799.49 11069.12,-2792.55"/>
<text text-anchor="middle" x="11639" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="11639" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_1_gpu0 -->
<g id="node9" class="node">
<title>layer_0_expert_1_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="11525.5,-2795.95 11076.5,-2795.95 11076.5,-2712.95 11525.5,-2712.95 11525.5,-2795.95"/>
<text text-anchor="middle" x="11301" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="11301" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="11301" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11301" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="11301" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_1_gpu0 -->
<g id="edge8" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_1_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18171.92,-2902.54C17383.92,-2902.87 13347.52,-2901.64 12108,-2843.95 11856.08,-2832.23 11790.21,-2828.54 11536.03,-2796.06"/>
<polygon fill="black" stroke="black" points="11536.1,-2792.54 11525.74,-2794.74 11535.21,-2799.48 11536.1,-2792.54"/>
<text text-anchor="middle" x="12155" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="12155" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_2_gpu0 -->
<g id="node10" class="node">
<title>layer_0_expert_2_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="11992.5,-2795.95 11543.5,-2795.95 11543.5,-2712.95 11992.5,-2712.95 11992.5,-2795.95"/>
<text text-anchor="middle" x="11768" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="11768" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="11768" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11768" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="11768" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_2_gpu0 -->
<g id="edge9" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_2_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18171.63,-2901.09C17644.9,-2895.63 15669.87,-2874.22 14044,-2843.95 13139.67,-2827.12 12907.2,-2883.85 12002.71,-2795.98"/>
<polygon fill="black" stroke="black" points="12003,-2792.49 11992.71,-2795 12002.32,-2799.45 12003,-2792.49"/>
<text text-anchor="middle" x="14091" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="14091" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_3_gpu0 -->
<g id="node11" class="node">
<title>layer_0_expert_3_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="12459.5,-2795.95 12010.5,-2795.95 12010.5,-2712.95 12459.5,-2712.95 12459.5,-2795.95"/>
<text text-anchor="middle" x="12235" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="12235" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="12235" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12235" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="12235" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_3_gpu0 -->
<g id="edge10" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_3_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18171.81,-2899.77C17765.37,-2891.63 16511.99,-2866.39 15473,-2843.95 14881.43,-2831.18 14733.62,-2823.8 14142,-2813.95 13959.12,-2810.91 12695.8,-2812.8 12469.96,-2795.9"/>
<polygon fill="black" stroke="black" points="12469.96,-2792.39 12459.7,-2795.06 12469.38,-2799.37 12469.96,-2792.39"/>
<text text-anchor="middle" x="15520" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="15520" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_4_gpu1 -->
<g id="node12" class="node">
<title>layer_0_expert_4_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="12926.5,-2795.95 12477.5,-2795.95 12477.5,-2712.95 12926.5,-2712.95 12926.5,-2795.95"/>
<text text-anchor="middle" x="12702" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="12702" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="12702" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12702" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="12702" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_4_gpu1 -->
<g id="edge11" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_4_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18171.91,-2899.39C17843.47,-2891.72 16972.49,-2870.41 16246,-2843.95 15945.9,-2833.02 15871.2,-2821.65 15571,-2813.95 15281.46,-2806.53 13271.48,-2821.68 12937,-2795.93"/>
<polygon fill="black" stroke="black" points="12936.96,-2792.41 12926.7,-2795.07 12936.38,-2799.39 12936.96,-2792.41"/>
<text text-anchor="middle" x="16293" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="16293" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_0_expert_5_gpu1 -->
<g id="node13" class="node">
<title>layer_0_expert_5_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="13393.5,-2795.95 12944.5,-2795.95 12944.5,-2712.95 13393.5,-2712.95 13393.5,-2795.95"/>
<text text-anchor="middle" x="13169" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="13169" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="13169" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13169" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="13169" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_5_gpu1 -->
<g id="edge12" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_5_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18171.89,-2899.86C17894.97,-2894.02 17239.88,-2877.6 16691,-2843.95 16536.49,-2834.48 16498.63,-2821.1 16344,-2813.95 16020.67,-2799.01 13771.91,-2824.42 13403.79,-2795.91"/>
<polygon fill="black" stroke="black" points="13403.96,-2792.42 13393.7,-2795.08 13403.38,-2799.39 13403.96,-2792.42"/>
<text text-anchor="middle" x="16738" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="16738" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_0_expert_6_gpu1 -->
<g id="node14" class="node">
<title>layer_0_expert_6_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="13860.5,-2795.95 13411.5,-2795.95 13411.5,-2712.95 13860.5,-2712.95 13860.5,-2795.95"/>
<text text-anchor="middle" x="13636" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="13636" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="13636" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13636" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="13636" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_6_gpu1 -->
<g id="edge13" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_6_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18171.65,-2901.82C17930.66,-2899.52 17409.25,-2889.22 16972,-2843.95 16890.02,-2835.47 16871.13,-2820.9 16789,-2813.95 16468.89,-2786.9 14236.17,-2823.99 13870.72,-2795.9"/>
<polygon fill="black" stroke="black" points="13870.96,-2792.41 13860.7,-2795.08 13870.38,-2799.39 13870.96,-2792.41"/>
<text text-anchor="middle" x="17019" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="17019" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_0_expert_7_gpu1 -->
<g id="node15" class="node">
<title>layer_0_expert_7_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="14327.5,-2795.95 13878.5,-2795.95 13878.5,-2712.95 14327.5,-2712.95 14327.5,-2795.95"/>
<text text-anchor="middle" x="14103" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="14103" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="14103" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14103" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="14103" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_7_gpu1 -->
<g id="edge14" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_7_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18171.72,-2899.52C17914.17,-2893.24 17359.63,-2876.35 17171,-2843.95 17124.85,-2836.03 17116.32,-2820.84 17070,-2813.95 16922.38,-2792 14570.68,-2808.85 14337.9,-2795.78"/>
<polygon fill="black" stroke="black" points="14337.92,-2792.28 14327.7,-2795.07 14337.44,-2799.26 14337.92,-2792.28"/>
<text text-anchor="middle" x="17218" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="17218" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_0_expert_8_gpu2 -->
<g id="node16" class="node">
<title>layer_0_expert_8_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="14794.5,-2795.95 14345.5,-2795.95 14345.5,-2712.95 14794.5,-2712.95 14794.5,-2795.95"/>
<text text-anchor="middle" x="14570" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="14570" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="14570" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14570" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="14570" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_8_gpu2 -->
<g id="edge15" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_8_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18171.68,-2901.06C17942.11,-2897.57 17484.01,-2885.47 17329,-2843.95 17300.2,-2836.24 17297.99,-2820.91 17269,-2813.95 17138.3,-2782.6 15021.16,-2807.22 14804.9,-2795.76"/>
<polygon fill="black" stroke="black" points="14804.92,-2792.25 14794.7,-2795.07 14804.44,-2799.24 14804.92,-2792.25"/>
<text text-anchor="middle" x="17376" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="17376" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_0_expert_9_gpu2 -->
<g id="node17" class="node">
<title>layer_0_expert_9_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="15261.5,-2795.95 14812.5,-2795.95 14812.5,-2712.95 15261.5,-2712.95 15261.5,-2795.95"/>
<text text-anchor="middle" x="15037" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="15037" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="15037" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15037" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="15037" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_9_gpu2 -->
<g id="edge16" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_9_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18171.62,-2902.28C17968.16,-2900.47 17592.37,-2890.65 17467,-2843.95 17446.18,-2836.2 17448.05,-2821.07 17427,-2813.95 17371.81,-2795.3 15440.71,-2800.99 15271.7,-2795.55"/>
<polygon fill="black" stroke="black" points="15271.86,-2792.06 15261.7,-2795.07 15271.52,-2799.05 15271.86,-2792.06"/>
<text text-anchor="middle" x="17514" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="17514" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_0_expert_10_gpu2 -->
<g id="node18" class="node">
<title>layer_0_expert_10_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="15728.5,-2795.95 15279.5,-2795.95 15279.5,-2712.95 15728.5,-2712.95 15728.5,-2795.95"/>
<text text-anchor="middle" x="15504" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="15504" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="15504" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15504" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="15504" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_10_gpu2 -->
<g id="edge17" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_10_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18171.65,-2902.59C17994.32,-2900.86 17693,-2890.82 17594,-2843.95 17577.24,-2836.02 17582.04,-2821.28 17565,-2813.95 17519.83,-2794.53 15895.01,-2800.16 15739.1,-2795.54"/>
<polygon fill="black" stroke="black" points="15738.85,-2792.02 15728.7,-2795.06 15738.53,-2799.02 15738.85,-2792.02"/>
<text text-anchor="middle" x="17641" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="17641" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_0_expert_11_gpu2 -->
<g id="node19" class="node">
<title>layer_0_expert_11_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="16195.5,-2795.95 15746.5,-2795.95 15746.5,-2712.95 16195.5,-2712.95 16195.5,-2795.95"/>
<text text-anchor="middle" x="15971" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="15971" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="15971" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15971" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="15971" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_11_gpu2 -->
<g id="edge18" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_11_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18171.72,-2901.09C18022.33,-2897.51 17791.98,-2885.21 17716,-2843.95 17700.99,-2835.81 17707.34,-2821.44 17692,-2813.95 17656.18,-2796.47 16343.49,-2799.49 16205.94,-2795.51"/>
<polygon fill="black" stroke="black" points="16205.85,-2792.01 16195.71,-2795.05 16205.54,-2799 16205.85,-2792.01"/>
<text text-anchor="middle" x="17763" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="17763" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_0_expert_12_gpu3 -->
<g id="node20" class="node">
<title>layer_0_expert_12_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="16662.5,-2795.95 16213.5,-2795.95 16213.5,-2712.95 16662.5,-2712.95 16662.5,-2795.95"/>
<text text-anchor="middle" x="16438" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="16438" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="16438" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16438" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="16438" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_12_gpu3 -->
<g id="edge19" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_12_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18171.86,-2898.16C18052.61,-2892.15 17888.89,-2877.84 17834,-2843.95 17820.36,-2835.54 17828.07,-2821.63 17814,-2813.95 17787.29,-2799.39 16790.62,-2798.93 16672.85,-2795.49"/>
<polygon fill="black" stroke="black" points="16672.85,-2791.99 16662.71,-2795.03 16672.54,-2798.98 16672.85,-2791.99"/>
<text text-anchor="middle" x="17881" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="17881" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_0_expert_13_gpu3 -->
<g id="node21" class="node">
<title>layer_0_expert_13_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="17129.5,-2795.95 16680.5,-2795.95 16680.5,-2712.95 17129.5,-2712.95 17129.5,-2795.95"/>
<text text-anchor="middle" x="16905" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="16905" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="16905" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16905" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="16905" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_13_gpu3 -->
<g id="edge20" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_13_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18171.8,-2891.38C18087.43,-2882.33 17987.98,-2867.18 17952,-2843.95 17938.54,-2835.26 17946.04,-2821.67 17932,-2813.95 17895.01,-2793.61 17241.35,-2799.64 17139.78,-2795.6"/>
<polygon fill="black" stroke="black" points="17139.9,-2792.1 17129.71,-2795 17139.49,-2799.09 17139.9,-2792.1"/>
<text text-anchor="middle" x="17999" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="17999" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_0_expert_14_gpu3 -->
<g id="node22" class="node">
<title>layer_0_expert_14_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="17596.5,-2795.95 17147.5,-2795.95 17147.5,-2712.95 17596.5,-2712.95 17596.5,-2795.95"/>
<text text-anchor="middle" x="17372" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="17372" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="17372" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17372" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="17372" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_14_gpu3 -->
<g id="edge21" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_14_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18171.94,-2887.88C18136.09,-2879.24 18099.01,-2865.56 18069,-2843.95 18056.19,-2834.73 18063.67,-2821.84 18050,-2813.95 18009.24,-2790.43 17687.43,-2800.14 17606.8,-2795.69"/>
<polygon fill="black" stroke="black" points="17606.95,-2792.19 17596.72,-2794.93 17606.42,-2799.17 17606.95,-2792.19"/>
<text text-anchor="middle" x="18116" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="18116" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_0_expert_15_gpu3 -->
<g id="node23" class="node">
<title>layer_0_expert_15_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="18063.5,-2795.95 17614.5,-2795.95 17614.5,-2712.95 18063.5,-2712.95 18063.5,-2795.95"/>
<text text-anchor="middle" x="17839" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="17839" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="17839" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17839" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="17839" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_15_gpu3 -->
<g id="edge22" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_15_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18236.17,-2861.86C18226.62,-2855.99 18217,-2849.92 18208,-2843.95 18189.17,-2831.49 18187.76,-2822.83 18167,-2813.95 18164.08,-2812.7 18124.55,-2805.43 18073.87,-2796.4"/>
<polygon fill="black" stroke="black" points="18074.4,-2792.94 18063.94,-2794.64 18073.18,-2799.83 18074.4,-2792.94"/>
<text text-anchor="middle" x="18255" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="18255" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_0_expert_16_gpu4 -->
<g id="node24" class="node">
<title>layer_0_expert_16_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="18530.5,-2795.95 18081.5,-2795.95 18081.5,-2712.95 18530.5,-2712.95 18530.5,-2795.95"/>
<text text-anchor="middle" x="18306" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 16</text>
<text text-anchor="middle" x="18306" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="18306" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="18306" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="18306" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_16_gpu4 -->
<g id="edge23" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_16_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18306,-2861.9C18306,-2844.7 18306,-2824.46 18306,-2806.28"/>
<polygon fill="black" stroke="black" points="18309.5,-2806.13 18306,-2796.13 18302.5,-2806.13 18309.5,-2806.13"/>
<text text-anchor="middle" x="18353" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="18353" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_0_expert_17_gpu4 -->
<g id="node25" class="node">
<title>layer_0_expert_17_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="18997.5,-2795.95 18548.5,-2795.95 18548.5,-2712.95 18997.5,-2712.95 18997.5,-2795.95"/>
<text text-anchor="middle" x="18773" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 17</text>
<text text-anchor="middle" x="18773" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="18773" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="18773" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="18773" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_17_gpu4 -->
<g id="edge24" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_17_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18434.85,-2861.9C18496.86,-2842.37 18571.3,-2818.94 18634.52,-2799.04"/>
<polygon fill="black" stroke="black" points="18635.68,-2802.35 18644.17,-2796.01 18633.58,-2795.67 18635.68,-2802.35"/>
<text text-anchor="middle" x="18628" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="18628" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_0_expert_18_gpu4 -->
<g id="node26" class="node">
<title>layer_0_expert_18_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="19464.5,-2795.95 19015.5,-2795.95 19015.5,-2712.95 19464.5,-2712.95 19464.5,-2795.95"/>
<text text-anchor="middle" x="19240" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 18</text>
<text text-anchor="middle" x="19240" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="19240" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="19240" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="19240" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_18_gpu4 -->
<g id="edge25" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_18_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18440.19,-2882.93C18579.11,-2862.53 18802.68,-2829.13 19005.32,-2796.22"/>
<polygon fill="black" stroke="black" points="19005.95,-2799.66 19015.26,-2794.6 19004.82,-2792.75 19005.95,-2799.66"/>
<text text-anchor="middle" x="18939" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="18939" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_0_expert_19_gpu4 -->
<g id="node27" class="node">
<title>layer_0_expert_19_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="19931.5,-2795.95 19482.5,-2795.95 19482.5,-2712.95 19931.5,-2712.95 19931.5,-2795.95"/>
<text text-anchor="middle" x="19707" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 19</text>
<text text-anchor="middle" x="19707" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="19707" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="19707" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="19707" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_19_gpu4 -->
<g id="edge26" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_19_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18440,-2894.13C18655.69,-2879.87 19093.23,-2847.37 19472.22,-2796.17"/>
<polygon fill="black" stroke="black" points="19472.85,-2799.62 19482.29,-2794.81 19471.91,-2792.68 19472.85,-2799.62"/>
<text text-anchor="middle" x="19362" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="19362" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_0_expert_20_gpu5 -->
<g id="node28" class="node">
<title>layer_0_expert_20_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="20398.5,-2795.95 19949.5,-2795.95 19949.5,-2712.95 20398.5,-2712.95 20398.5,-2795.95"/>
<text text-anchor="middle" x="20174" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 20</text>
<text text-anchor="middle" x="20174" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="20174" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="20174" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="20174" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_20_gpu5 -->
<g id="edge27" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_20_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18440.11,-2899.74C18718.4,-2892.78 19378.74,-2869.46 19938.98,-2796.19"/>
<polygon fill="black" stroke="black" points="19939.83,-2799.61 19949.29,-2794.84 19938.92,-2792.67 19939.83,-2799.61"/>
<text text-anchor="middle" x="19811" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="19811" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_0_expert_21_gpu5 -->
<g id="node29" class="node">
<title>layer_0_expert_21_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="20865.5,-2795.95 20416.5,-2795.95 20416.5,-2712.95 20865.5,-2712.95 20865.5,-2795.95"/>
<text text-anchor="middle" x="20641" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 21</text>
<text text-anchor="middle" x="20641" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="20641" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="20641" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="20641" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_21_gpu5 -->
<g id="edge28" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_21_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18440.1,-2899.67C18709.67,-2893.59 19336.4,-2876.92 19862,-2843.95 20101.8,-2828.91 20164.74,-2827.54 20406.15,-2796.17"/>
<polygon fill="black" stroke="black" points="20406.83,-2799.61 20416.29,-2794.85 20405.92,-2792.67 20406.83,-2799.61"/>
<text text-anchor="middle" x="20307" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="20307" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_0_expert_22_gpu5 -->
<g id="node30" class="node">
<title>layer_0_expert_22_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="21332.5,-2795.95 20883.5,-2795.95 20883.5,-2712.95 21332.5,-2712.95 21332.5,-2795.95"/>
<text text-anchor="middle" x="21108" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 22</text>
<text text-anchor="middle" x="21108" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="21108" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="21108" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="21108" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_22_gpu5 -->
<g id="edge29" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_22_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18440.28,-2901.6C18768.15,-2898.87 19635.62,-2887.74 20358,-2843.95 20585.08,-2830.19 20644.58,-2826.51 20873.33,-2796.15"/>
<polygon fill="black" stroke="black" points="20873.84,-2799.62 20883.29,-2794.83 20872.92,-2792.68 20873.84,-2799.62"/>
<text text-anchor="middle" x="20772" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="20772" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_0_expert_23_gpu5 -->
<g id="node31" class="node">
<title>layer_0_expert_23_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="21799.5,-2795.95 21350.5,-2795.95 21350.5,-2712.95 21799.5,-2712.95 21799.5,-2795.95"/>
<text text-anchor="middle" x="21575" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 23</text>
<text text-anchor="middle" x="21575" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="21575" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="21575" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="21575" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_23_gpu5 -->
<g id="edge30" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_23_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18440.17,-2902.59C18816.41,-2902.27 19913.44,-2896.52 20823,-2843.95 21050.99,-2830.78 21110.69,-2826.6 21340.29,-2796.16"/>
<polygon fill="black" stroke="black" points="21340.84,-2799.62 21350.29,-2794.83 21339.92,-2792.68 21340.84,-2799.62"/>
<text text-anchor="middle" x="21238" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="21238" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_0_expert_24_gpu6 -->
<g id="node32" class="node">
<title>layer_0_expert_24_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="22266.5,-2795.95 21817.5,-2795.95 21817.5,-2712.95 22266.5,-2712.95 22266.5,-2795.95"/>
<text text-anchor="middle" x="22042" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 24</text>
<text text-anchor="middle" x="22042" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="22042" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="22042" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="22042" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_24_gpu6 -->
<g id="edge31" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_24_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18440.3,-2901.11C18944.29,-2895.89 20723.02,-2875.58 21289,-2843.95 21517.45,-2831.19 21577.24,-2826.65 21807.27,-2796.16"/>
<polygon fill="black" stroke="black" points="21807.84,-2799.62 21817.29,-2794.83 21806.92,-2792.68 21807.84,-2799.62"/>
<text text-anchor="middle" x="21705" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="21705" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_0_expert_25_gpu6 -->
<g id="node33" class="node">
<title>layer_0_expert_25_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="22733.5,-2795.95 22284.5,-2795.95 22284.5,-2712.95 22733.5,-2712.95 22733.5,-2795.95"/>
<text text-anchor="middle" x="22509" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 25</text>
<text text-anchor="middle" x="22509" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="22509" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="22509" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="22509" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_25_gpu6 -->
<g id="edge32" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_25_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18440.09,-2901.49C19035.14,-2897.04 21422.47,-2877.24 21756,-2843.95 21829.3,-2836.64 21845.84,-2822.49 21919,-2813.95 22073.56,-2795.91 22116.37,-2812.86 22274.24,-2796.09"/>
<polygon fill="black" stroke="black" points="22274.75,-2799.56 22284.31,-2795 22273.99,-2792.6 22274.75,-2799.56"/>
<text text-anchor="middle" x="21966" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="21966" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_0_expert_26_gpu6 -->
<g id="node34" class="node">
<title>layer_0_expert_26_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="23200.5,-2795.95 22751.5,-2795.95 22751.5,-2712.95 23200.5,-2712.95 23200.5,-2795.95"/>
<text text-anchor="middle" x="22976" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 26</text>
<text text-anchor="middle" x="22976" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="22976" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="22976" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="22976" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_26_gpu6 -->
<g id="edge33" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_26_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18440.07,-2902.11C19084.19,-2900.24 21837.04,-2889.6 22013,-2843.95 22040.33,-2836.86 22041.71,-2821.19 22069,-2813.95 22138.94,-2795.4 22632.96,-2802.83 22741.3,-2795.88"/>
<polygon fill="black" stroke="black" points="22741.63,-2799.37 22751.32,-2795.09 22741.07,-2792.39 22741.63,-2799.37"/>
<text text-anchor="middle" x="22116" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="22116" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_0_expert_27_gpu6 -->
<g id="node35" class="node">
<title>layer_0_expert_27_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="23667.5,-2795.95 23218.5,-2795.95 23218.5,-2712.95 23667.5,-2712.95 23667.5,-2795.95"/>
<text text-anchor="middle" x="23443" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 27</text>
<text text-anchor="middle" x="23443" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="23443" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="23443" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="23443" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_27_gpu6 -->
<g id="edge34" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_27_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18440.17,-2902.79C19100.85,-2904.13 21983.91,-2906.38 22163,-2843.95 22183.65,-2836.75 22181.36,-2821.18 22202,-2813.95 22252.95,-2796.11 23090.35,-2800.88 23208.18,-2795.74"/>
<polygon fill="black" stroke="black" points="23208.56,-2799.23 23218.32,-2795.12 23208.13,-2792.24 23208.56,-2799.23"/>
<text text-anchor="middle" x="22249" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="22249" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_0_expert_28_gpu7 -->
<g id="node36" class="node">
<title>layer_0_expert_28_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="24134.5,-2795.95 23685.5,-2795.95 23685.5,-2712.95 24134.5,-2712.95 24134.5,-2795.95"/>
<text text-anchor="middle" x="23910" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 28</text>
<text text-anchor="middle" x="23910" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="23910" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="23910" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="23910" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_28_gpu7 -->
<g id="edge35" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_28_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18440.24,-2901.84C19125.52,-2898.52 22204.97,-2881.57 22296,-2843.95 22313.72,-2836.63 22309.28,-2821.26 22327,-2813.95 22394.31,-2786.19 23532.63,-2801.91 23675.19,-2795.76"/>
<polygon fill="black" stroke="black" points="23675.56,-2799.24 23685.33,-2795.14 23675.13,-2792.26 23675.56,-2799.24"/>
<text text-anchor="middle" x="22374" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="22374" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_0_expert_29_gpu7 -->
<g id="node37" class="node">
<title>layer_0_expert_29_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="24601.5,-2795.95 24152.5,-2795.95 24152.5,-2712.95 24601.5,-2712.95 24601.5,-2795.95"/>
<text text-anchor="middle" x="24377" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 29</text>
<text text-anchor="middle" x="24377" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="24377" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="24377" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="24377" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_29_gpu7 -->
<g id="edge36" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_29_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18440.16,-2902.02C19138.4,-2899.55 22328.32,-2886.02 22421,-2843.95 22437.33,-2836.54 22431.65,-2821.34 22448,-2813.95 22489.55,-2795.18 23995.19,-2799.91 24142.26,-2795.61"/>
<polygon fill="black" stroke="black" points="24142.5,-2799.1 24152.33,-2795.15 24142.18,-2792.11 24142.5,-2799.1"/>
<text text-anchor="middle" x="22495" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="22495" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_0_expert_30_gpu7 -->
<g id="node38" class="node">
<title>layer_0_expert_30_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="25068.5,-2795.95 24619.5,-2795.95 24619.5,-2712.95 25068.5,-2712.95 25068.5,-2795.95"/>
<text text-anchor="middle" x="24844" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 30</text>
<text text-anchor="middle" x="24844" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="24844" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="24844" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="24844" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_30_gpu7 -->
<g id="edge37" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_30_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18440.27,-2902.04C19151.07,-2899.68 22446.02,-2886.45 22542,-2843.95 22558.68,-2836.57 22553.3,-2821.3 22570,-2813.95 22620.38,-2791.8 24442.91,-2800.52 24608.92,-2795.64"/>
<polygon fill="black" stroke="black" points="24609.5,-2799.12 24619.33,-2795.16 24609.18,-2792.12 24609.5,-2799.12"/>
<text text-anchor="middle" x="22617" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="22617" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_0_expert_31_gpu7 -->
<g id="node39" class="node">
<title>layer_0_expert_31_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="25535.5,-2795.95 25086.5,-2795.95 25086.5,-2712.95 25535.5,-2712.95 25535.5,-2795.95"/>
<text text-anchor="middle" x="25311" y="-2780.75" font-family="Times,serif" font-size="14.00">Expert 31</text>
<text text-anchor="middle" x="25311" y="-2765.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="25311" y="-2750.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="25311" y="-2735.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="25311" y="-2720.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_31_gpu7 -->
<g id="edge38" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_31_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18440.19,-2900.97C18973.94,-2894.99 20998.15,-2871.7 22664,-2843.95 23733.55,-2826.14 24008.1,-2898.34 25076.1,-2796.1"/>
<polygon fill="black" stroke="black" points="25076.7,-2799.55 25086.32,-2795.11 25076.03,-2792.59 25076.7,-2799.55"/>
<text text-anchor="middle" x="24883" y="-2832.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="24883" y="-2817.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_0_residual_final -->
<g id="node7" class="node">
<title>layer_0_residual_final</title>
<polygon fill="lightgreen" stroke="black" points="18495.5,-2555.95 18116.5,-2555.95 18116.5,-2487.95 18495.5,-2487.95 18495.5,-2555.95"/>
<text text-anchor="middle" x="18306" y="-2540.75" font-family="Times,serif" font-size="14.00">Add &amp; LayerNorm</text>
<text text-anchor="middle" x="18306" y="-2525.75" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="18306" y="-2510.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="18306" y="-2495.75" font-family="Times,serif" font-size="14.00">Add: [1024, hidden_size/8] + [1024, hidden_size/8]</text>
</g>
<!-- layer_0_expert_agg&#45;&gt;layer_0_residual_final -->
<g id="edge6" class="edge">
<title>layer_0_expert_agg&#45;&gt;layer_0_residual_final</title>
<path fill="none" stroke="black" d="M18306,-2592.93C18306,-2584.26 18306,-2575.06 18306,-2566.28"/>
<polygon fill="black" stroke="black" points="18309.5,-2566.22 18306,-2556.22 18302.5,-2566.22 18309.5,-2566.22"/>
</g>
<!-- layer_1_mha -->
<g id="node40" class="node">
<title>layer_1_mha</title>
<polygon fill="lightblue" stroke="black" points="18479.5,-2429.95 18132.5,-2429.95 18132.5,-2346.95 18479.5,-2346.95 18479.5,-2429.95"/>
<text text-anchor="middle" x="18306" y="-2414.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="18306" y="-2399.75" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="18306" y="-2384.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="18306" y="-2369.75" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
<text text-anchor="middle" x="18306" y="-2354.75" font-family="Times,serif" font-size="14.00">[1024, hidden_size/8] &#45;&gt; [1024, hidden_size/8]</text>
</g>
<!-- layer_0_residual_final&#45;&gt;layer_1_mha -->
<g id="edge71" class="edge">
<title>layer_0_residual_final&#45;&gt;layer_1_mha</title>
<path fill="none" stroke="black" d="M18306,-2487.77C18306,-2473.42 18306,-2456.29 18306,-2440.38"/>
<polygon fill="black" stroke="black" points="18309.5,-2440.15 18306,-2430.15 18302.5,-2440.15 18309.5,-2440.15"/>
</g>
<!-- layer_0_expert_0_gpu0&#45;&gt;layer_0_expert_agg -->
<g id="edge39" class="edge">
<title>layer_0_expert_0_gpu0&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M11058.71,-2713.92C11061.83,-2713.58 11064.92,-2713.26 11068,-2712.95 11390.09,-2681.05 11472.38,-2699.63 11796,-2693.95 14382.98,-2648.57 17548.88,-2637.57 18189.72,-2635.76"/>
<polygon fill="black" stroke="black" points="18189.89,-2639.25 18199.88,-2635.73 18189.87,-2632.25 18189.89,-2639.25"/>
</g>
<!-- layer_0_expert_1_gpu0&#45;&gt;layer_0_expert_agg -->
<g id="edge40" class="edge">
<title>layer_0_expert_1_gpu0&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M11525.71,-2713.92C11528.83,-2713.58 11531.92,-2713.26 11535,-2712.95 11858.86,-2680.9 11941.61,-2699.75 12267,-2693.95 14655.48,-2651.39 17575.92,-2638.25 18189.55,-2635.88"/>
<polygon fill="black" stroke="black" points="18189.74,-2639.38 18199.72,-2635.84 18189.71,-2632.38 18189.74,-2639.38"/>
</g>
<!-- layer_0_expert_2_gpu0&#45;&gt;layer_0_expert_agg -->
<g id="edge41" class="edge">
<title>layer_0_expert_2_gpu0&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M11992.71,-2713.92C11995.83,-2713.58 11998.92,-2713.26 12002,-2712.95 12329.84,-2680.55 12413.61,-2699.91 12743,-2693.95 14931.88,-2654.38 17605.75,-2639.02 18189.82,-2636.02"/>
<polygon fill="black" stroke="black" points="18189.95,-2639.52 18199.93,-2635.97 18189.91,-2632.52 18189.95,-2639.52"/>
</g>
<!-- layer_0_expert_3_gpu0&#45;&gt;layer_0_expert_agg -->
<g id="edge42" class="edge">
<title>layer_0_expert_3_gpu0&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M12459.71,-2713.92C12462.83,-2713.58 12465.92,-2713.26 12469,-2712.95 12792.86,-2680.9 12875.61,-2700.04 13201,-2693.95 15198.17,-2656.59 17635.31,-2639.67 18189.99,-2636.16"/>
<polygon fill="black" stroke="black" points="18190.02,-2639.66 18199.99,-2636.1 18189.97,-2632.66 18190.02,-2639.66"/>
</g>
<!-- layer_0_expert_4_gpu1&#45;&gt;layer_0_expert_agg -->
<g id="edge43" class="edge">
<title>layer_0_expert_4_gpu1&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M12926.71,-2713.92C12929.83,-2713.58 12932.92,-2713.26 12936,-2712.95 13263.84,-2680.55 13347.62,-2700.26 13677,-2693.95 15474.6,-2659.55 17665.26,-2640.6 18189.39,-2636.37"/>
<polygon fill="black" stroke="black" points="18189.64,-2639.87 18199.61,-2636.29 18189.58,-2632.87 18189.64,-2639.87"/>
</g>
<!-- layer_0_expert_5_gpu1&#45;&gt;layer_0_expert_agg -->
<g id="edge44" class="edge">
<title>layer_0_expert_5_gpu1&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M13393.71,-2713.92C13396.83,-2713.58 13399.92,-2713.26 13403,-2712.95 13727.3,-2680.86 13810.18,-2700.46 14136,-2693.95 15742.43,-2661.87 17697.31,-2641.45 18189.36,-2636.58"/>
<polygon fill="black" stroke="black" points="18189.7,-2640.08 18199.67,-2636.48 18189.63,-2633.08 18189.7,-2640.08"/>
</g>
<!-- layer_0_expert_6_gpu1&#45;&gt;layer_0_expert_agg -->
<g id="edge45" class="edge">
<title>layer_0_expert_6_gpu1&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M13860.71,-2713.91C13863.83,-2713.58 13866.92,-2713.26 13870,-2712.95 14200.06,-2680.36 14284.41,-2700.8 14616,-2693.95 16023.72,-2664.87 17733.8,-2642.61 18189.74,-2636.89"/>
<polygon fill="black" stroke="black" points="18189.99,-2640.39 18199.95,-2636.76 18189.9,-2633.39 18189.99,-2640.39"/>
</g>
<!-- layer_0_expert_7_gpu1&#45;&gt;layer_0_expert_agg -->
<g id="edge46" class="edge">
<title>layer_0_expert_7_gpu1&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M14327.71,-2713.91C14330.83,-2713.58 14333.92,-2713.26 14337,-2712.95 14667.06,-2680.36 14751.42,-2701.19 15083,-2693.95 16297.8,-2667.46 17770.35,-2643.83 18189.62,-2637.26"/>
<polygon fill="black" stroke="black" points="18189.98,-2640.75 18199.92,-2637.1 18189.87,-2633.75 18189.98,-2640.75"/>
</g>
<!-- layer_0_expert_8_gpu2&#45;&gt;layer_0_expert_agg -->
<g id="edge47" class="edge">
<title>layer_0_expert_8_gpu2&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M14794.71,-2713.91C14797.82,-2713.57 14800.92,-2713.26 14804,-2712.95 15149.55,-2679.03 15237.88,-2701.91 15585,-2693.95 16594.08,-2670.83 17813.72,-2645.56 18189.92,-2637.83"/>
<polygon fill="black" stroke="black" points="18190.07,-2641.33 18199.99,-2637.62 18189.92,-2634.33 18190.07,-2641.33"/>
</g>
<!-- layer_0_expert_9_gpu2&#45;&gt;layer_0_expert_agg -->
<g id="edge48" class="edge">
<title>layer_0_expert_9_gpu2&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M15261.71,-2713.92C15264.83,-2713.58 15267.92,-2713.26 15271,-2712.95 15585.12,-2681.73 15665.44,-2702.15 15981,-2693.95 16828.65,-2671.95 17850.16,-2646.68 18189.88,-2638.31"/>
<polygon fill="black" stroke="black" points="18190.07,-2641.81 18199.98,-2638.06 18189.9,-2634.81 18190.07,-2641.81"/>
</g>
<!-- layer_0_expert_10_gpu2&#45;&gt;layer_0_expert_agg -->
<g id="edge49" class="edge">
<title>layer_0_expert_10_gpu2&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M15728.71,-2713.93C15731.83,-2713.59 15734.92,-2713.26 15738,-2712.95 16223.44,-2663.87 17754.68,-2642.08 18189.7,-2636.78"/>
<polygon fill="black" stroke="black" points="18189.82,-2640.28 18199.77,-2636.66 18189.73,-2633.28 18189.82,-2640.28"/>
</g>
<!-- layer_0_expert_11_gpu2&#45;&gt;layer_0_expert_agg -->
<g id="edge50" class="edge">
<title>layer_0_expert_11_gpu2&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M16195.72,-2713.96C16198.83,-2713.61 16201.92,-2713.27 16205,-2712.95 16594.54,-2672.25 17807.46,-2645.33 18189.53,-2637.68"/>
<polygon fill="black" stroke="black" points="18189.84,-2641.18 18199.77,-2637.48 18189.7,-2634.18 18189.84,-2641.18"/>
</g>
<!-- layer_0_expert_12_gpu3&#45;&gt;layer_0_expert_agg -->
<g id="edge51" class="edge">
<title>layer_0_expert_12_gpu3&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M16662.72,-2714.01C16665.83,-2713.64 16668.93,-2713.29 16672,-2712.95 17238.49,-2650.74 17920.88,-2638.44 18189.39,-2636.03"/>
<polygon fill="black" stroke="black" points="18189.58,-2639.53 18199.54,-2635.94 18189.51,-2632.53 18189.58,-2639.53"/>
</g>
<!-- layer_0_expert_13_gpu3&#45;&gt;layer_0_expert_agg -->
<g id="edge52" class="edge">
<title>layer_0_expert_13_gpu3&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M17129.73,-2714.09C17132.84,-2713.7 17135.93,-2713.32 17139,-2712.95 17522.1,-2667.21 17979.42,-2646.67 18189.72,-2639.13"/>
<polygon fill="black" stroke="black" points="18189.99,-2642.62 18199.86,-2638.77 18189.74,-2635.63 18189.99,-2642.62"/>
</g>
<!-- layer_0_expert_14_gpu3&#45;&gt;layer_0_expert_agg -->
<g id="edge53" class="edge">
<title>layer_0_expert_14_gpu3&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M17596.75,-2714.28C17599.86,-2713.83 17602.94,-2713.39 17606,-2712.95 17810.76,-2683.93 18050.53,-2659.42 18189.65,-2646.14"/>
<polygon fill="black" stroke="black" points="18190.28,-2649.6 18199.9,-2645.16 18189.62,-2642.63 18190.28,-2649.6"/>
</g>
<!-- layer_0_expert_15_gpu3&#45;&gt;layer_0_expert_agg -->
<g id="edge54" class="edge">
<title>layer_0_expert_15_gpu3&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M17999.39,-2712.93C18062.01,-2697.1 18132.44,-2679.31 18189.99,-2664.77"/>
<polygon fill="black" stroke="black" points="18191.01,-2668.12 18199.85,-2662.28 18189.3,-2661.33 18191.01,-2668.12"/>
</g>
<!-- layer_0_expert_16_gpu4&#45;&gt;layer_0_expert_agg -->
<g id="edge55" class="edge">
<title>layer_0_expert_16_gpu4&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M18306,-2712.84C18306,-2704.32 18306,-2695.22 18306,-2686.37"/>
<polygon fill="black" stroke="black" points="18309.5,-2686.14 18306,-2676.14 18302.5,-2686.14 18309.5,-2686.14"/>
</g>
<!-- layer_0_expert_17_gpu4&#45;&gt;layer_0_expert_agg -->
<g id="edge56" class="edge">
<title>layer_0_expert_17_gpu4&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M18612.61,-2712.93C18549.99,-2697.1 18479.56,-2679.31 18422.01,-2664.77"/>
<polygon fill="black" stroke="black" points="18422.7,-2661.33 18412.15,-2662.28 18420.99,-2668.12 18422.7,-2661.33"/>
</g>
<!-- layer_0_expert_18_gpu4&#45;&gt;layer_0_expert_agg -->
<g id="edge57" class="edge">
<title>layer_0_expert_18_gpu4&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M19015.28,-2714.14C19012.51,-2713.74 19009.74,-2713.34 19007,-2712.95 18801.96,-2683.83 18561.85,-2659.36 18422.52,-2646.11"/>
<polygon fill="black" stroke="black" points="18422.54,-2642.59 18412.25,-2645.13 18421.88,-2649.56 18422.54,-2642.59"/>
</g>
<!-- layer_0_expert_19_gpu4&#45;&gt;layer_0_expert_agg -->
<g id="edge58" class="edge">
<title>layer_0_expert_19_gpu4&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M19482.3,-2713.97C19479.52,-2713.62 19476.75,-2713.28 19474,-2712.95 19090.59,-2667.04 18632.87,-2646.59 18422.38,-2639.1"/>
<polygon fill="black" stroke="black" points="18422.36,-2635.59 18412.24,-2638.74 18422.11,-2642.59 18422.36,-2635.59"/>
</g>
<!-- layer_0_expert_20_gpu5&#45;&gt;layer_0_expert_agg -->
<g id="edge59" class="edge">
<title>layer_0_expert_20_gpu5&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M19949.31,-2713.9C19946.53,-2713.57 19943.75,-2713.26 19941,-2712.95 19373.83,-2650.47 18690.52,-2638.32 18422.19,-2635.99"/>
<polygon fill="black" stroke="black" points="18422.07,-2632.49 18412.04,-2635.91 18422.01,-2639.49 18422.07,-2632.49"/>
</g>
<!-- layer_0_expert_21_gpu5&#45;&gt;layer_0_expert_agg -->
<g id="edge60" class="edge">
<title>layer_0_expert_21_gpu5&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M20416.32,-2713.86C20413.53,-2713.54 20410.76,-2713.24 20408,-2712.95 20018.29,-2672.09 18804.78,-2645.27 18422.53,-2637.67"/>
<polygon fill="black" stroke="black" points="18422.35,-2634.17 18412.29,-2637.47 18422.22,-2641.17 18422.35,-2634.17"/>
</g>
<!-- layer_0_expert_22_gpu5&#45;&gt;layer_0_expert_agg -->
<g id="edge61" class="edge">
<title>layer_0_expert_22_gpu5&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M20883.32,-2713.83C20880.53,-2713.53 20877.76,-2713.23 20875,-2712.95 20389.39,-2663.68 18857.54,-2642.02 18422.34,-2636.77"/>
<polygon fill="black" stroke="black" points="18422.31,-2633.27 18412.27,-2636.65 18422.23,-2640.27 18422.31,-2633.27"/>
</g>
<!-- layer_0_expert_23_gpu5&#45;&gt;layer_0_expert_agg -->
<g id="edge62" class="edge">
<title>layer_0_expert_23_gpu5&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M21350.32,-2713.82C21347.53,-2713.52 21344.76,-2713.23 21342,-2712.95 21027.89,-2681.62 20947.56,-2702.14 20632,-2693.95 19783.99,-2671.94 18762.04,-2646.68 18422.17,-2638.31"/>
<polygon fill="black" stroke="black" points="18422.15,-2634.81 18412.07,-2638.06 18421.98,-2641.81 18422.15,-2634.81"/>
</g>
<!-- layer_0_expert_24_gpu6&#45;&gt;layer_0_expert_agg -->
<g id="edge63" class="edge">
<title>layer_0_expert_24_gpu6&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M21817.32,-2713.8C21814.53,-2713.5 21811.76,-2713.22 21809,-2712.95 21129.92,-2646.8 18951.2,-2637.07 18422.43,-2635.68"/>
<polygon fill="black" stroke="black" points="18422.13,-2632.18 18412.13,-2635.65 18422.12,-2639.18 18422.13,-2632.18"/>
</g>
<!-- layer_0_expert_25_gpu6&#45;&gt;layer_0_expert_agg -->
<g id="edge64" class="edge">
<title>layer_0_expert_25_gpu6&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M22284.32,-2713.82C22281.53,-2713.52 22278.76,-2713.23 22276,-2712.95 21959.23,-2681.39 21878.26,-2701.04 21560,-2693.95 20332.17,-2666.63 18843.52,-2643.53 18422.11,-2637.18"/>
<polygon fill="black" stroke="black" points="18422.1,-2633.68 18412.05,-2637.03 18421.99,-2640.68 18422.1,-2633.68"/>
</g>
<!-- layer_0_expert_26_gpu6&#45;&gt;layer_0_expert_agg -->
<g id="edge65" class="edge">
<title>layer_0_expert_26_gpu6&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M22751.32,-2713.79C22748.53,-2713.5 22745.76,-2713.22 22743,-2712.95 22316.88,-2671.96 22208.01,-2701.78 21780,-2693.95 20461.65,-2669.85 18861.82,-2644.26 18422.41,-2637.29"/>
<polygon fill="black" stroke="black" points="18422.3,-2633.79 18412.25,-2637.13 18422.19,-2640.79 18422.3,-2633.79"/>
</g>
<!-- layer_0_expert_27_gpu6&#45;&gt;layer_0_expert_agg -->
<g id="edge66" class="edge">
<title>layer_0_expert_27_gpu6&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M23218.32,-2713.78C23215.53,-2713.49 23212.76,-2713.22 23210,-2712.95 22734.74,-2667.72 22613.34,-2701.82 22136,-2693.95 20670.28,-2669.79 18888.98,-2643.87 18422.35,-2637.13"/>
<polygon fill="black" stroke="black" points="18422.29,-2633.63 18412.24,-2636.98 18422.18,-2640.63 18422.29,-2633.63"/>
</g>
<!-- layer_0_expert_28_gpu7&#45;&gt;layer_0_expert_agg -->
<g id="edge67" class="edge">
<title>layer_0_expert_28_gpu7&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M23685.32,-2713.78C23682.53,-2713.49 23679.76,-2713.21 23677,-2712.95 23179.6,-2665.81 23052.57,-2701.62 22553,-2693.95 20914.09,-2668.81 18919.34,-2643.23 18422.32,-2636.92"/>
<polygon fill="black" stroke="black" points="18422.32,-2633.42 18412.27,-2636.79 18422.23,-2640.42 18422.32,-2633.42"/>
</g>
<!-- layer_0_expert_29_gpu7&#45;&gt;layer_0_expert_agg -->
<g id="edge68" class="edge">
<title>layer_0_expert_29_gpu7&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M24152.32,-2713.78C24149.53,-2713.49 24146.76,-2713.21 24144,-2712.95 23638.19,-2665.08 23509.02,-2701.34 23001,-2693.95 21175.61,-2667.41 18950.91,-2642.54 18422.5,-2636.73"/>
<polygon fill="black" stroke="black" points="18422.24,-2633.22 18412.2,-2636.61 18422.16,-2640.22 18422.24,-2633.22"/>
</g>
<!-- layer_0_expert_30_gpu7&#45;&gt;layer_0_expert_agg -->
<g id="edge69" class="edge">
<title>layer_0_expert_30_gpu7&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M24619.32,-2713.78C24616.53,-2713.49 24613.76,-2713.21 24611,-2712.95 24100.32,-2664.66 23969.91,-2701.09 23457,-2693.95 21440.57,-2665.9 18979.99,-2641.88 18422.13,-2636.55"/>
<polygon fill="black" stroke="black" points="18422.1,-2633.05 18412.07,-2636.46 18422.03,-2640.05 18422.1,-2633.05"/>
</g>
<!-- layer_0_expert_31_gpu7&#45;&gt;layer_0_expert_agg -->
<g id="edge70" class="edge">
<title>layer_0_expert_31_gpu7&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M25086.32,-2713.78C25083.53,-2713.49 25080.76,-2713.21 25078,-2712.95 24564.22,-2664.4 24433.02,-2700.87 23917,-2693.95 21707.86,-2664.36 19009.3,-2641.29 18422.21,-2636.41"/>
<polygon fill="black" stroke="black" points="18422.08,-2632.91 18412.05,-2636.32 18422.02,-2639.91 18422.08,-2632.91"/>
</g>
<!-- layer_1_residual_mha -->
<g id="node41" class="node">
<title>layer_1_residual_mha</title>
<polygon fill="lightgreen" stroke="black" points="18495.5,-2309.95 18116.5,-2309.95 18116.5,-2241.95 18495.5,-2241.95 18495.5,-2309.95"/>
<text text-anchor="middle" x="18306" y="-2294.75" font-family="Times,serif" font-size="14.00">Add &amp; LayerNorm</text>
<text text-anchor="middle" x="18306" y="-2279.75" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="18306" y="-2264.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="18306" y="-2249.75" font-family="Times,serif" font-size="14.00">Add: [1024, hidden_size/8] + [1024, hidden_size/8]</text>
</g>
<!-- layer_1_mha&#45;&gt;layer_1_residual_mha -->
<g id="edge72" class="edge">
<title>layer_1_mha&#45;&gt;layer_1_residual_mha</title>
<path fill="none" stroke="black" d="M18306,-2346.93C18306,-2338.26 18306,-2329.06 18306,-2320.28"/>
<polygon fill="black" stroke="black" points="18309.5,-2320.22 18306,-2310.22 18302.5,-2320.22 18309.5,-2320.22"/>
</g>
<!-- layer_1_gate -->
<g id="node42" class="node">
<title>layer_1_gate</title>
<polygon fill="lightyellow" stroke="black" points="14909,-2204.95 14641,-2204.95 14641,-2121.95 14909,-2121.95 14909,-2204.95"/>
<text text-anchor="middle" x="14775" y="-2189.75" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="14775" y="-2174.75" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="14775" y="-2159.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="14775" y="-2144.75" font-family="Times,serif" font-size="14.00">[1024, hidden_size/8] &#45;&gt; [1024, 64]</text>
<text text-anchor="middle" x="14775" y="-2129.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- layer_1_residual_mha&#45;&gt;layer_1_gate -->
<g id="edge73" class="edge">
<title>layer_1_residual_mha&#45;&gt;layer_1_gate</title>
<path fill="none" stroke="black" d="M18116.47,-2269.02C17487.37,-2249.33 15476.8,-2186.42 14919.46,-2168.97"/>
<polygon fill="black" stroke="black" points="14919.46,-2165.47 14909.35,-2168.66 14919.24,-2172.47 14919.46,-2165.47"/>
</g>
<!-- layer_1_expert_agg -->
<g id="node43" class="node">
<title>layer_1_expert_agg</title>
<polygon fill="lightpink" stroke="black" points="14881,-1935.95 14669,-1935.95 14669,-1852.95 14881,-1852.95 14881,-1935.95"/>
<text text-anchor="middle" x="14775" y="-1920.75" font-family="Times,serif" font-size="14.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="14775" y="-1905.75" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="14775" y="-1890.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="14775" y="-1875.75" font-family="Times,serif" font-size="14.00">AllReduce across 8 GPUs</text>
<text text-anchor="middle" x="14775" y="-1860.75" font-family="Times,serif" font-size="14.00">[1024, hidden_size/8]</text>
</g>
<!-- layer_1_residual_mha&#45;&gt;layer_1_expert_agg -->
<g id="edge74" class="edge">
<title>layer_1_residual_mha&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M18495.92,-2267.5C18991.42,-2247.46 20364.12,-2188.2 21505,-2103.95 21737.96,-2086.75 22177.82,-2139.47 22014,-1972.95 21948.81,-1906.69 15817.42,-1896.71 14891.55,-1895.58"/>
<polygon fill="black" stroke="black" points="14891.23,-1892.08 14881.22,-1895.57 14891.22,-1899.08 14891.23,-1892.08"/>
</g>
<!-- layer_1_expert_0_gpu0 -->
<g id="node45" class="node">
<title>layer_1_expert_0_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="7527.5,-2055.95 7078.5,-2055.95 7078.5,-1972.95 7527.5,-1972.95 7527.5,-2055.95"/>
<text text-anchor="middle" x="7303" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="7303" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="7303" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7303" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="7303" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_0_gpu0 -->
<g id="edge76" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14640.78,-2161.98C13751.74,-2158.72 8726.26,-2138.86 8046,-2103.95 7821.96,-2092.46 7763.36,-2086.32 7537.88,-2056.19"/>
<polygon fill="black" stroke="black" points="7538.09,-2052.68 7527.71,-2054.83 7537.16,-2059.62 7538.09,-2052.68"/>
<text text-anchor="middle" x="8093" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="8093" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_1_expert_1_gpu0 -->
<g id="node46" class="node">
<title>layer_1_expert_1_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="7994.5,-2055.95 7545.5,-2055.95 7545.5,-1972.95 7994.5,-1972.95 7994.5,-2055.95"/>
<text text-anchor="middle" x="7770" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="7770" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="7770" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7770" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="7770" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_1_gpu0 -->
<g id="edge77" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_1_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14640.71,-2162.71C13848.14,-2164 9773.58,-2167.41 8523,-2103.95 8294.49,-2092.36 8234.75,-2086.68 8004.73,-2056.16"/>
<polygon fill="black" stroke="black" points="8005.08,-2052.68 7994.71,-2054.83 8004.16,-2059.62 8005.08,-2052.68"/>
<text text-anchor="middle" x="8570" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="8570" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_1_expert_2_gpu0 -->
<g id="node47" class="node">
<title>layer_1_expert_2_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="8461.5,-2055.95 8012.5,-2055.95 8012.5,-1972.95 8461.5,-1972.95 8461.5,-2055.95"/>
<text text-anchor="middle" x="8237" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="8237" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="8237" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8237" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="8237" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_2_gpu0 -->
<g id="edge78" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_2_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14640.76,-2162.35C13890.09,-2161.56 10205.45,-2155.13 9070,-2103.95 8806.01,-2092.05 8737.07,-2089.62 8471.63,-2056.14"/>
<polygon fill="black" stroke="black" points="8472.06,-2052.66 8461.7,-2054.88 8471.19,-2059.61 8472.06,-2052.66"/>
<text text-anchor="middle" x="9117" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="9117" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_1_expert_3_gpu0 -->
<g id="node48" class="node">
<title>layer_1_expert_3_gpu0</title>
<polygon fill="lightcoral" stroke="black" points="8928.5,-2055.95 8479.5,-2055.95 8479.5,-1972.95 8928.5,-1972.95 8928.5,-2055.95"/>
<text text-anchor="middle" x="8704" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="8704" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="8704" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8704" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="8704" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_3_gpu0 -->
<g id="edge79" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_3_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14640.9,-2161.01C14137.22,-2155.48 12310.41,-2134.39 10805,-2103.95 9978.02,-2087.24 9765.15,-2137.54 8938.74,-2056.09"/>
<polygon fill="black" stroke="black" points="8938.98,-2052.59 8928.68,-2055.09 8938.29,-2059.56 8938.98,-2052.59"/>
<text text-anchor="middle" x="10852" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="10852" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_1_expert_4_gpu1 -->
<g id="node49" class="node">
<title>layer_1_expert_4_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="9395.5,-2055.95 8946.5,-2055.95 8946.5,-1972.95 9395.5,-1972.95 9395.5,-2055.95"/>
<text text-anchor="middle" x="9171" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="9171" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="9171" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9171" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="9171" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_4_gpu1 -->
<g id="edge80" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_4_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14640.99,-2159.56C14254.24,-2151.18 13102.82,-2126.12 12147,-2103.95 11594.1,-2091.13 11455.96,-2083.94 10903,-2073.95 10739.39,-2071 9610.57,-2071.25 9405.77,-2055.98"/>
<polygon fill="black" stroke="black" points="9405.93,-2052.48 9395.67,-2055.15 9405.35,-2059.46 9405.93,-2052.48"/>
<text text-anchor="middle" x="12194" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="12194" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_5_gpu1 -->
<g id="node50" class="node">
<title>layer_1_expert_5_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="9862.5,-2055.95 9413.5,-2055.95 9413.5,-1972.95 9862.5,-1972.95 9862.5,-2055.95"/>
<text text-anchor="middle" x="9638" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="9638" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="9638" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9638" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="9638" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_5_gpu1 -->
<g id="edge81" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_5_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14640.86,-2159.09C14330.35,-2151.14 13538.07,-2129.89 12876,-2103.95 12595.45,-2092.96 12525.65,-2081.69 12245,-2073.95 11984.4,-2066.77 10176.81,-2079.32 9872.85,-2056.01"/>
<polygon fill="black" stroke="black" points="9872.93,-2052.5 9862.67,-2055.16 9872.35,-2059.48 9872.93,-2052.5"/>
<text text-anchor="middle" x="12923" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="12923" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_6_gpu1 -->
<g id="node51" class="node">
<title>layer_1_expert_6_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="10329.5,-2055.95 9880.5,-2055.95 9880.5,-1972.95 10329.5,-1972.95 10329.5,-2055.95"/>
<text text-anchor="middle" x="10105" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="10105" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="10105" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10105" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="10105" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_6_gpu1 -->
<g id="edge82" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_6_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14640.81,-2159.49C14381.38,-2153.24 13793.04,-2136.52 13299,-2103.95 13154.26,-2094.41 13118.88,-2081.12 12974,-2073.95 12684.6,-2059.63 10673.6,-2081.64 10339.94,-2056.02"/>
<polygon fill="black" stroke="black" points="10339.93,-2052.5 10329.67,-2055.17 10339.35,-2059.48 10339.93,-2052.5"/>
<text text-anchor="middle" x="13346" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="13346" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_7_gpu1 -->
<g id="node52" class="node">
<title>layer_1_expert_7_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="10796.5,-2055.95 10347.5,-2055.95 10347.5,-1972.95 10796.5,-1972.95 10796.5,-2055.95"/>
<text text-anchor="middle" x="10572" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="10572" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="10572" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10572" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="10572" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_7_gpu1 -->
<g id="edge83" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_7_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14640.72,-2161.37C14417.56,-2158.36 13956.51,-2146.98 13569,-2103.95 13491.88,-2095.39 13474.29,-2080.91 13397,-2073.95 12826.89,-2022.61 11396.4,-2106.23 10807.04,-2055.98"/>
<polygon fill="black" stroke="black" points="10806.97,-2052.46 10796.7,-2055.07 10806.36,-2059.43 10806.97,-2052.46"/>
<text text-anchor="middle" x="13616" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="13616" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_8_gpu2 -->
<g id="node53" class="node">
<title>layer_1_expert_8_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="11263.5,-2055.95 10814.5,-2055.95 10814.5,-1972.95 11263.5,-1972.95 11263.5,-2055.95"/>
<text text-anchor="middle" x="11039" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="11039" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="11039" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11039" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="11039" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_8_gpu2 -->
<g id="edge84" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_8_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14640.69,-2158.77C14405.26,-2151.64 13927.48,-2133.94 13763,-2103.95 13719.02,-2095.94 13711.16,-2080.86 13667,-2073.95 13407.27,-2033.32 11581.46,-2078.63 11274,-2055.91"/>
<polygon fill="black" stroke="black" points="11273.95,-2052.39 11263.7,-2055.07 11273.39,-2059.37 11273.95,-2052.39"/>
<text text-anchor="middle" x="13810" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="13810" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_1_expert_9_gpu2 -->
<g id="node54" class="node">
<title>layer_1_expert_9_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="11730.5,-2055.95 11281.5,-2055.95 11281.5,-1972.95 11730.5,-1972.95 11730.5,-2055.95"/>
<text text-anchor="middle" x="11506" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="11506" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="11506" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11506" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="11506" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_9_gpu2 -->
<g id="edge85" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_9_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14640.66,-2160.05C14434.45,-2155.21 14049.91,-2141.36 13918,-2103.95 13890.46,-2096.14 13888.76,-2080.94 13861,-2073.95 13749.07,-2045.79 11934.11,-2065.68 11740.69,-2055.73"/>
<polygon fill="black" stroke="black" points="11740.91,-2052.24 11730.7,-2055.07 11740.45,-2059.22 11740.91,-2052.24"/>
<text text-anchor="middle" x="13965" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="13965" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_1_expert_10_gpu2 -->
<g id="node55" class="node">
<title>layer_1_expert_10_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="12197.5,-2055.95 11748.5,-2055.95 11748.5,-1972.95 12197.5,-1972.95 12197.5,-2055.95"/>
<text text-anchor="middle" x="11973" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="11973" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="11973" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11973" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="11973" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_10_gpu2 -->
<g id="edge86" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_10_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14640.94,-2160.8C14462.51,-2157.02 14157.43,-2144.62 14054,-2103.95 14033.97,-2096.08 14036.29,-2081.11 14016,-2073.95 13970.09,-2057.76 12362.39,-2060.32 12208.01,-2055.55"/>
<polygon fill="black" stroke="black" points="12207.86,-2052.03 12197.7,-2055.06 12207.53,-2059.03 12207.86,-2052.03"/>
<text text-anchor="middle" x="14101" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="14101" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_1_expert_11_gpu2 -->
<g id="node56" class="node">
<title>layer_1_expert_11_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="12664.5,-2055.95 12215.5,-2055.95 12215.5,-1972.95 12664.5,-1972.95 12664.5,-2055.95"/>
<text text-anchor="middle" x="12440" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="12440" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="12440" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12440" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="12440" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_11_gpu2 -->
<g id="edge87" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_11_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14640.8,-2159.91C14491.04,-2155.21 14259.43,-2141.86 14181,-2103.95 14164.3,-2095.88 14169.03,-2081.3 14152,-2073.95 14115.63,-2058.26 12811.6,-2059.6 12674.88,-2055.52"/>
<polygon fill="black" stroke="black" points="12674.86,-2052.01 12664.71,-2055.05 12674.53,-2059.01 12674.86,-2052.01"/>
<text text-anchor="middle" x="14228" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="14228" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_1_expert_12_gpu3 -->
<g id="node57" class="node">
<title>layer_1_expert_12_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="13131.5,-2055.95 12682.5,-2055.95 12682.5,-1972.95 13131.5,-1972.95 13131.5,-2055.95"/>
<text text-anchor="middle" x="12907" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="12907" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="12907" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12907" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="12907" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_12_gpu3 -->
<g id="edge88" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_12_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14640.79,-2157.34C14521.66,-2150.75 14358.06,-2136.04 14302,-2103.95 14287.42,-2095.61 14294.01,-2081.51 14279,-2073.95 14224.39,-2046.47 13270.53,-2060.83 13141.96,-2055.64"/>
<polygon fill="black" stroke="black" points="13141.9,-2052.13 13131.71,-2055.03 13141.48,-2059.12 13141.9,-2052.13"/>
<text text-anchor="middle" x="14349" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="14349" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_1_expert_13_gpu3 -->
<g id="node58" class="node">
<title>layer_1_expert_13_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="13598.5,-2055.95 13149.5,-2055.95 13149.5,-1972.95 13598.5,-1972.95 13598.5,-2055.95"/>
<text text-anchor="middle" x="13374" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="13374" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="13374" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13374" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="13374" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_13_gpu3 -->
<g id="edge89" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_13_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14640.88,-2151.47C14556.18,-2142.44 14456.15,-2127.28 14420,-2103.95 14406.54,-2095.26 14414.04,-2081.67 14400,-2073.95 14363.05,-2053.64 13710.22,-2059.64 13608.77,-2055.6"/>
<polygon fill="black" stroke="black" points="13608.9,-2052.1 13598.71,-2055 13608.49,-2059.09 13608.9,-2052.1"/>
<text text-anchor="middle" x="14467" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="14467" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_1_expert_14_gpu3 -->
<g id="node59" class="node">
<title>layer_1_expert_14_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="14065.5,-2055.95 13616.5,-2055.95 13616.5,-1972.95 14065.5,-1972.95 14065.5,-2055.95"/>
<text text-anchor="middle" x="13841" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="13841" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="13841" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13841" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="13841" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_14_gpu3 -->
<g id="edge90" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_14_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14640.96,-2147.34C14605.21,-2138.69 14568.17,-2125.15 14538,-2103.95 14524.89,-2094.74 14531.97,-2081.8 14518,-2073.95 14477.06,-2050.96 14156.22,-2060.18 14075.78,-2055.69"/>
<polygon fill="black" stroke="black" points="14075.95,-2052.2 14065.72,-2054.93 14075.42,-2059.18 14075.95,-2052.2"/>
<text text-anchor="middle" x="14585" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="14585" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_1_expert_15_gpu3 -->
<g id="node60" class="node">
<title>layer_1_expert_15_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="14532.5,-2055.95 14083.5,-2055.95 14083.5,-1972.95 14532.5,-1972.95 14532.5,-2055.95"/>
<text text-anchor="middle" x="14308" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="14308" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="14308" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14308" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="14308" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_15_gpu3 -->
<g id="edge91" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_15_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14705.17,-2121.86C14695.62,-2115.99 14686,-2109.92 14677,-2103.95 14658.17,-2091.49 14656.76,-2082.83 14636,-2073.95 14633.08,-2072.7 14593.55,-2065.43 14542.87,-2056.4"/>
<polygon fill="black" stroke="black" points="14543.4,-2052.94 14532.94,-2054.64 14542.18,-2059.83 14543.4,-2052.94"/>
<text text-anchor="middle" x="14724" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="14724" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_1_expert_16_gpu4 -->
<g id="node61" class="node">
<title>layer_1_expert_16_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="14999.5,-2055.95 14550.5,-2055.95 14550.5,-1972.95 14999.5,-1972.95 14999.5,-2055.95"/>
<text text-anchor="middle" x="14775" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 16</text>
<text text-anchor="middle" x="14775" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="14775" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14775" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="14775" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_16_gpu4 -->
<g id="edge92" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_16_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14775,-2121.9C14775,-2104.7 14775,-2084.46 14775,-2066.28"/>
<polygon fill="black" stroke="black" points="14778.5,-2066.13 14775,-2056.13 14771.5,-2066.13 14778.5,-2066.13"/>
<text text-anchor="middle" x="14822" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="14822" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_1_expert_17_gpu4 -->
<g id="node62" class="node">
<title>layer_1_expert_17_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="15466.5,-2055.95 15017.5,-2055.95 15017.5,-1972.95 15466.5,-1972.95 15466.5,-2055.95"/>
<text text-anchor="middle" x="15242" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 17</text>
<text text-anchor="middle" x="15242" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="15242" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15242" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="15242" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_17_gpu4 -->
<g id="edge93" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_17_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14903.85,-2121.9C14965.86,-2102.37 15040.3,-2078.94 15103.52,-2059.04"/>
<polygon fill="black" stroke="black" points="15104.68,-2062.35 15113.17,-2056.01 15102.58,-2055.67 15104.68,-2062.35"/>
<text text-anchor="middle" x="15097" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="15097" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_1_expert_18_gpu4 -->
<g id="node63" class="node">
<title>layer_1_expert_18_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="15933.5,-2055.95 15484.5,-2055.95 15484.5,-1972.95 15933.5,-1972.95 15933.5,-2055.95"/>
<text text-anchor="middle" x="15709" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 18</text>
<text text-anchor="middle" x="15709" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="15709" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15709" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="15709" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_18_gpu4 -->
<g id="edge94" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_18_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14909.19,-2142.93C15048.11,-2122.53 15271.68,-2089.13 15474.32,-2056.22"/>
<polygon fill="black" stroke="black" points="15474.95,-2059.66 15484.26,-2054.6 15473.82,-2052.75 15474.95,-2059.66"/>
<text text-anchor="middle" x="15408" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="15408" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_1_expert_19_gpu4 -->
<g id="node64" class="node">
<title>layer_1_expert_19_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="16400.5,-2055.95 15951.5,-2055.95 15951.5,-1972.95 16400.5,-1972.95 16400.5,-2055.95"/>
<text text-anchor="middle" x="16176" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 19</text>
<text text-anchor="middle" x="16176" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="16176" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16176" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="16176" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_19_gpu4 -->
<g id="edge95" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_19_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14909,-2154.13C15124.69,-2139.87 15562.23,-2107.37 15941.22,-2056.17"/>
<polygon fill="black" stroke="black" points="15941.85,-2059.62 15951.29,-2054.81 15940.91,-2052.68 15941.85,-2059.62"/>
<text text-anchor="middle" x="15831" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="15831" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_1_expert_20_gpu5 -->
<g id="node65" class="node">
<title>layer_1_expert_20_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="16867.5,-2055.95 16418.5,-2055.95 16418.5,-1972.95 16867.5,-1972.95 16867.5,-2055.95"/>
<text text-anchor="middle" x="16643" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 20</text>
<text text-anchor="middle" x="16643" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="16643" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16643" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="16643" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_20_gpu5 -->
<g id="edge96" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_20_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14909.11,-2159.74C15187.4,-2152.78 15847.74,-2129.46 16407.98,-2056.19"/>
<polygon fill="black" stroke="black" points="16408.83,-2059.61 16418.29,-2054.84 16407.92,-2052.67 16408.83,-2059.61"/>
<text text-anchor="middle" x="16280" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="16280" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_1_expert_21_gpu5 -->
<g id="node66" class="node">
<title>layer_1_expert_21_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="17334.5,-2055.95 16885.5,-2055.95 16885.5,-1972.95 17334.5,-1972.95 17334.5,-2055.95"/>
<text text-anchor="middle" x="17110" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 21</text>
<text text-anchor="middle" x="17110" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="17110" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17110" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="17110" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_21_gpu5 -->
<g id="edge97" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_21_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14909.1,-2159.67C15178.67,-2153.59 15805.4,-2136.92 16331,-2103.95 16570.8,-2088.91 16633.74,-2087.54 16875.15,-2056.17"/>
<polygon fill="black" stroke="black" points="16875.83,-2059.61 16885.29,-2054.85 16874.92,-2052.67 16875.83,-2059.61"/>
<text text-anchor="middle" x="16776" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="16776" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_1_expert_22_gpu5 -->
<g id="node67" class="node">
<title>layer_1_expert_22_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="17801.5,-2055.95 17352.5,-2055.95 17352.5,-1972.95 17801.5,-1972.95 17801.5,-2055.95"/>
<text text-anchor="middle" x="17577" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 22</text>
<text text-anchor="middle" x="17577" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="17577" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17577" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="17577" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_22_gpu5 -->
<g id="edge98" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_22_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14909.28,-2161.6C15237.15,-2158.87 16104.62,-2147.74 16827,-2103.95 17054.08,-2090.19 17113.58,-2086.51 17342.33,-2056.15"/>
<polygon fill="black" stroke="black" points="17342.84,-2059.62 17352.29,-2054.83 17341.92,-2052.68 17342.84,-2059.62"/>
<text text-anchor="middle" x="17241" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="17241" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_1_expert_23_gpu5 -->
<g id="node68" class="node">
<title>layer_1_expert_23_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="18268.5,-2055.95 17819.5,-2055.95 17819.5,-1972.95 18268.5,-1972.95 18268.5,-2055.95"/>
<text text-anchor="middle" x="18044" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 23</text>
<text text-anchor="middle" x="18044" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="18044" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="18044" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="18044" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_23_gpu5 -->
<g id="edge99" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_23_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14909.17,-2162.59C15285.41,-2162.27 16382.44,-2156.52 17292,-2103.95 17519.99,-2090.78 17579.69,-2086.6 17809.29,-2056.16"/>
<polygon fill="black" stroke="black" points="17809.84,-2059.62 17819.29,-2054.83 17808.92,-2052.68 17809.84,-2059.62"/>
<text text-anchor="middle" x="17707" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="17707" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_1_expert_24_gpu6 -->
<g id="node69" class="node">
<title>layer_1_expert_24_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="18735.5,-2055.95 18286.5,-2055.95 18286.5,-1972.95 18735.5,-1972.95 18735.5,-2055.95"/>
<text text-anchor="middle" x="18511" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 24</text>
<text text-anchor="middle" x="18511" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="18511" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="18511" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="18511" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_24_gpu6 -->
<g id="edge100" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_24_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14909.3,-2161.11C15413.29,-2155.89 17192.02,-2135.58 17758,-2103.95 17986.45,-2091.19 18046.24,-2086.65 18276.27,-2056.16"/>
<polygon fill="black" stroke="black" points="18276.84,-2059.62 18286.29,-2054.83 18275.92,-2052.68 18276.84,-2059.62"/>
<text text-anchor="middle" x="18174" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="18174" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_1_expert_25_gpu6 -->
<g id="node70" class="node">
<title>layer_1_expert_25_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="19202.5,-2055.95 18753.5,-2055.95 18753.5,-1972.95 19202.5,-1972.95 19202.5,-2055.95"/>
<text text-anchor="middle" x="18978" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 25</text>
<text text-anchor="middle" x="18978" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="18978" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="18978" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="18978" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_25_gpu6 -->
<g id="edge101" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_25_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14909.06,-2161.53C15461.3,-2157.51 17562.17,-2140.11 18225,-2103.95 18453.47,-2091.49 18513.25,-2086.66 18743.27,-2056.16"/>
<polygon fill="black" stroke="black" points="18743.84,-2059.62 18753.29,-2054.83 18742.92,-2052.68 18743.84,-2059.62"/>
<text text-anchor="middle" x="18651" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="18651" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_1_expert_26_gpu6 -->
<g id="node71" class="node">
<title>layer_1_expert_26_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="19669.5,-2055.95 19220.5,-2055.95 19220.5,-1972.95 19669.5,-1972.95 19669.5,-2055.95"/>
<text text-anchor="middle" x="19445" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 26</text>
<text text-anchor="middle" x="19445" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="19445" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="19445" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="19445" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_26_gpu6 -->
<g id="edge102" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_26_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14909.25,-2161.88C15508.15,-2159.1 17939.99,-2145.42 18702,-2103.95 18926,-2091.76 18984.63,-2086.3 19210.12,-2056.18"/>
<polygon fill="black" stroke="black" points="19210.84,-2059.62 19220.29,-2054.83 19209.91,-2052.68 19210.84,-2059.62"/>
<text text-anchor="middle" x="19111" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="19111" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_1_expert_27_gpu6 -->
<g id="node72" class="node">
<title>layer_1_expert_27_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="20136.5,-2055.95 19687.5,-2055.95 19687.5,-1972.95 20136.5,-1972.95 20136.5,-2055.95"/>
<text text-anchor="middle" x="19912" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 27</text>
<text text-anchor="middle" x="19912" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="19912" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="19912" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="19912" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_27_gpu6 -->
<g id="edge103" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_27_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14909.12,-2162.1C15549.9,-2160.19 18303.79,-2149.44 19162,-2103.95 19389.18,-2091.91 19448.58,-2086.56 19677.33,-2056.16"/>
<polygon fill="black" stroke="black" points="19677.84,-2059.62 19687.29,-2054.83 19676.92,-2052.68 19677.84,-2059.62"/>
<text text-anchor="middle" x="19586" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="19586" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_1_expert_28_gpu7 -->
<g id="node73" class="node">
<title>layer_1_expert_28_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="20603.5,-2055.95 20154.5,-2055.95 20154.5,-1972.95 20603.5,-1972.95 20603.5,-2055.95"/>
<text text-anchor="middle" x="20379" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 28</text>
<text text-anchor="middle" x="20379" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="20379" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="20379" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="20379" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_28_gpu7 -->
<g id="edge104" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_28_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14909.23,-2162.33C15591.44,-2161.47 18679.31,-2154.79 19637,-2103.95 19860.58,-2092.09 19919.08,-2086.27 20144.14,-2056.18"/>
<polygon fill="black" stroke="black" points="20144.84,-2059.62 20154.29,-2054.82 20143.91,-2052.68 20144.84,-2059.62"/>
<text text-anchor="middle" x="20045" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="20045" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_1_expert_29_gpu7 -->
<g id="node74" class="node">
<title>layer_1_expert_29_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="21070.5,-2055.95 20621.5,-2055.95 20621.5,-1972.95 21070.5,-1972.95 21070.5,-2055.95"/>
<text text-anchor="middle" x="20846" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 29</text>
<text text-anchor="middle" x="20846" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="20846" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="20846" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="20846" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_29_gpu7 -->
<g id="edge105" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_29_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14909.23,-2162.46C15629.39,-2162.3 19041.78,-2158.6 20096,-2103.95 20323.19,-2092.18 20382.58,-2086.56 20611.33,-2056.16"/>
<polygon fill="black" stroke="black" points="20611.84,-2059.62 20621.29,-2054.83 20610.92,-2052.68 20611.84,-2059.62"/>
<text text-anchor="middle" x="20520" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="20520" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_1_expert_30_gpu7 -->
<g id="node75" class="node">
<title>layer_1_expert_30_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="21537.5,-2055.95 21088.5,-2055.95 21088.5,-1972.95 21537.5,-1972.95 21537.5,-2055.95"/>
<text text-anchor="middle" x="21313" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 30</text>
<text text-anchor="middle" x="21313" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="21313" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="21313" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="21313" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_30_gpu7 -->
<g id="edge106" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_30_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14909.22,-2162.63C15666.97,-2163.41 19416.73,-2164.1 20571,-2103.95 20794.59,-2092.3 20853.08,-2086.28 21078.14,-2056.18"/>
<polygon fill="black" stroke="black" points="21078.84,-2059.62 21088.29,-2054.82 21077.91,-2052.68 21078.84,-2059.62"/>
<text text-anchor="middle" x="20979" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="20979" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_1_expert_31_gpu7 -->
<g id="node76" class="node">
<title>layer_1_expert_31_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="22004.5,-2055.95 21555.5,-2055.95 21555.5,-1972.95 22004.5,-1972.95 22004.5,-2055.95"/>
<text text-anchor="middle" x="21780" y="-2040.75" font-family="Times,serif" font-size="14.00">Expert 31</text>
<text text-anchor="middle" x="21780" y="-2025.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="21780" y="-2010.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="21780" y="-1995.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="21780" y="-1980.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_31_gpu7 -->
<g id="edge107" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_31_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14909.03,-2162.72C15701.2,-2164.07 19778.67,-2167.78 21030,-2103.95 21257.2,-2092.36 21316.58,-2086.57 21545.33,-2056.16"/>
<polygon fill="black" stroke="black" points="21545.84,-2059.62 21555.29,-2054.83 21544.92,-2052.68 21545.84,-2059.62"/>
<text text-anchor="middle" x="21454" y="-2092.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="21454" y="-2077.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_1_residual_final -->
<g id="node44" class="node">
<title>layer_1_residual_final</title>
<polygon fill="lightgreen" stroke="black" points="14964.5,-1815.95 14585.5,-1815.95 14585.5,-1747.95 14964.5,-1747.95 14964.5,-1815.95"/>
<text text-anchor="middle" x="14775" y="-1800.75" font-family="Times,serif" font-size="14.00">Add &amp; LayerNorm</text>
<text text-anchor="middle" x="14775" y="-1785.75" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="14775" y="-1770.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="14775" y="-1755.75" font-family="Times,serif" font-size="14.00">Add: [1024, hidden_size/8] + [1024, hidden_size/8]</text>
</g>
<!-- layer_1_expert_agg&#45;&gt;layer_1_residual_final -->
<g id="edge75" class="edge">
<title>layer_1_expert_agg&#45;&gt;layer_1_residual_final</title>
<path fill="none" stroke="black" d="M14775,-1852.93C14775,-1844.26 14775,-1835.06 14775,-1826.28"/>
<polygon fill="black" stroke="black" points="14778.5,-1826.22 14775,-1816.22 14771.5,-1826.22 14778.5,-1826.22"/>
</g>
<!-- layer_2_mha -->
<g id="node77" class="node">
<title>layer_2_mha</title>
<polygon fill="lightblue" stroke="black" points="14948.5,-1660.95 14601.5,-1660.95 14601.5,-1577.95 14948.5,-1577.95 14948.5,-1660.95"/>
<text text-anchor="middle" x="14775" y="-1645.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="14775" y="-1630.75" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="14775" y="-1615.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="14775" y="-1600.75" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
<text text-anchor="middle" x="14775" y="-1585.75" font-family="Times,serif" font-size="14.00">[1024, hidden_size/8] &#45;&gt; [1024, hidden_size/8]</text>
</g>
<!-- layer_1_residual_final&#45;&gt;layer_2_mha -->
<g id="edge140" class="edge">
<title>layer_1_residual_final&#45;&gt;layer_2_mha</title>
<path fill="none" stroke="black" d="M14775,-1747.7C14775,-1725.59 14775,-1696.12 14775,-1671.12"/>
<polygon fill="black" stroke="black" points="14778.5,-1671.07 14775,-1661.07 14771.5,-1671.07 14778.5,-1671.07"/>
<text text-anchor="middle" x="14862.5" y="-1718.75" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="14862.5" y="-1703.75" font-family="Times,serif" font-size="14.00">Stage 1 &#45;&gt; Stage 2</text>
</g>
<!-- layer_1_expert_0_gpu0&#45;&gt;layer_1_expert_agg -->
<g id="edge108" class="edge">
<title>layer_1_expert_0_gpu0&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M7527.68,-1973.82C7530.47,-1973.52 7533.24,-1973.23 7536,-1972.95 7858.08,-1940.93 7940.38,-1959.63 8264,-1953.95 10851.38,-1908.57 14017.77,-1897.57 14658.7,-1895.76"/>
<polygon fill="black" stroke="black" points="14658.87,-1899.25 14668.86,-1895.73 14658.85,-1892.25 14658.87,-1899.25"/>
</g>
<!-- layer_1_expert_1_gpu0&#45;&gt;layer_1_expert_agg -->
<g id="edge109" class="edge">
<title>layer_1_expert_1_gpu0&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M7994.68,-1973.82C7997.47,-1973.52 8000.24,-1973.23 8003,-1972.95 8325.52,-1940.89 8407.94,-1959.74 8732,-1953.95 11122.06,-1911.24 14044.44,-1898.22 14658.47,-1895.87"/>
<polygon fill="black" stroke="black" points="14658.67,-1899.37 14668.65,-1895.83 14658.64,-1892.37 14658.67,-1899.37"/>
</g>
<!-- layer_1_expert_2_gpu0&#45;&gt;layer_1_expert_agg -->
<g id="edge110" class="edge">
<title>layer_1_expert_2_gpu0&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M8461.68,-1973.82C8464.47,-1973.52 8467.24,-1973.23 8470,-1972.95 8792.96,-1940.86 8875.5,-1959.88 9200,-1953.95 11393.6,-1913.9 14073.24,-1898.91 14658.57,-1896"/>
<polygon fill="black" stroke="black" points="14658.72,-1899.5 14668.7,-1895.95 14658.68,-1892.5 14658.72,-1899.5"/>
</g>
<!-- layer_1_expert_3_gpu0&#45;&gt;layer_1_expert_agg -->
<g id="edge111" class="edge">
<title>layer_1_expert_3_gpu0&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M8928.68,-1973.82C8931.47,-1973.51 8934.24,-1973.23 8937,-1972.95 9261.29,-1940.74 9344.17,-1960.04 9670,-1953.95 11667.17,-1916.63 14104.31,-1899.68 14658.99,-1896.16"/>
<polygon fill="black" stroke="black" points="14659.02,-1899.66 14668.99,-1896.1 14658.97,-1892.66 14659.02,-1899.66"/>
</g>
<!-- layer_1_expert_4_gpu1&#45;&gt;layer_1_expert_agg -->
<g id="edge112" class="edge">
<title>layer_1_expert_4_gpu1&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M9395.68,-1973.81C9398.47,-1973.51 9401.24,-1973.23 9404,-1972.95 9732.72,-1940.36 9816.73,-1960.26 10147,-1953.95 11944.21,-1919.62 14134.4,-1900.62 14658.42,-1896.37"/>
<polygon fill="black" stroke="black" points="14658.66,-1899.87 14668.63,-1896.29 14658.6,-1892.87 14658.66,-1899.87"/>
</g>
<!-- layer_1_expert_5_gpu1&#45;&gt;layer_1_expert_agg -->
<g id="edge113" class="edge">
<title>layer_1_expert_5_gpu1&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M9862.68,-1973.82C9865.47,-1973.51 9868.24,-1973.23 9871,-1972.95 10196.18,-1940.66 10279.29,-1960.47 10606,-1953.95 12212.04,-1921.93 14166.46,-1901.47 14658.39,-1896.58"/>
<polygon fill="black" stroke="black" points="14658.73,-1900.08 14668.69,-1896.48 14658.66,-1893.08 14658.73,-1900.08"/>
</g>
<!-- layer_1_expert_6_gpu1&#45;&gt;layer_1_expert_agg -->
<g id="edge114" class="edge">
<title>layer_1_expert_6_gpu1&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M10329.68,-1973.81C10332.47,-1973.51 10335.24,-1973.23 10338,-1972.95 10668.49,-1940.21 10752.96,-1960.81 11085,-1953.95 12492.72,-1924.89 14202.8,-1902.62 14658.74,-1896.89"/>
<polygon fill="black" stroke="black" points="14658.99,-1900.39 14668.95,-1896.76 14658.9,-1893.39 14658.99,-1900.39"/>
</g>
<!-- layer_1_expert_7_gpu1&#45;&gt;layer_1_expert_agg -->
<g id="edge115" class="edge">
<title>layer_1_expert_7_gpu1&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M10796.71,-1973.91C10799.83,-1973.58 10802.92,-1973.26 10806,-1972.95 11136.06,-1940.36 11220.42,-1961.19 11552,-1953.95 12766.8,-1927.46 14239.35,-1903.83 14658.62,-1897.26"/>
<polygon fill="black" stroke="black" points="14658.98,-1900.75 14668.92,-1897.1 14658.87,-1893.75 14658.98,-1900.75"/>
</g>
<!-- layer_1_expert_8_gpu2&#45;&gt;layer_1_expert_agg -->
<g id="edge116" class="edge">
<title>layer_1_expert_8_gpu2&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M11263.71,-1973.91C11266.82,-1973.57 11269.92,-1973.26 11273,-1972.95 11618.55,-1939.03 11706.88,-1961.91 12054,-1953.95 13063.08,-1930.83 14282.72,-1905.56 14658.92,-1897.83"/>
<polygon fill="black" stroke="black" points="14659.07,-1901.33 14668.99,-1897.62 14658.92,-1894.33 14659.07,-1901.33"/>
</g>
<!-- layer_1_expert_9_gpu2&#45;&gt;layer_1_expert_agg -->
<g id="edge117" class="edge">
<title>layer_1_expert_9_gpu2&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M11730.71,-1973.92C11733.83,-1973.58 11736.92,-1973.26 11740,-1972.95 12054.12,-1941.73 12134.44,-1962.15 12450,-1953.95 13297.65,-1931.95 14319.16,-1906.68 14658.88,-1898.31"/>
<polygon fill="black" stroke="black" points="14659.07,-1901.81 14668.98,-1898.06 14658.9,-1894.81 14659.07,-1901.81"/>
</g>
<!-- layer_1_expert_10_gpu2&#45;&gt;layer_1_expert_agg -->
<g id="edge118" class="edge">
<title>layer_1_expert_10_gpu2&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M12197.71,-1973.93C12200.83,-1973.59 12203.92,-1973.26 12207,-1972.95 12692.44,-1923.87 14223.68,-1902.08 14658.7,-1896.78"/>
<polygon fill="black" stroke="black" points="14658.82,-1900.28 14668.77,-1896.66 14658.73,-1893.28 14658.82,-1900.28"/>
</g>
<!-- layer_1_expert_11_gpu2&#45;&gt;layer_1_expert_agg -->
<g id="edge119" class="edge">
<title>layer_1_expert_11_gpu2&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M12664.72,-1973.96C12667.83,-1973.61 12670.92,-1973.27 12674,-1972.95 13063.54,-1932.25 14276.46,-1905.33 14658.53,-1897.68"/>
<polygon fill="black" stroke="black" points="14658.84,-1901.18 14668.77,-1897.48 14658.7,-1894.18 14658.84,-1901.18"/>
</g>
<!-- layer_1_expert_12_gpu3&#45;&gt;layer_1_expert_agg -->
<g id="edge120" class="edge">
<title>layer_1_expert_12_gpu3&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M13131.72,-1974.01C13134.83,-1973.64 13137.93,-1973.29 13141,-1972.95 13707.49,-1910.74 14389.88,-1898.44 14658.39,-1896.03"/>
<polygon fill="black" stroke="black" points="14658.58,-1899.53 14668.54,-1895.94 14658.51,-1892.53 14658.58,-1899.53"/>
</g>
<!-- layer_1_expert_13_gpu3&#45;&gt;layer_1_expert_agg -->
<g id="edge121" class="edge">
<title>layer_1_expert_13_gpu3&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M13598.73,-1974.09C13601.84,-1973.7 13604.93,-1973.32 13608,-1972.95 13991.1,-1927.21 14448.42,-1906.67 14658.72,-1899.13"/>
<polygon fill="black" stroke="black" points="14658.99,-1902.62 14668.86,-1898.77 14658.74,-1895.63 14658.99,-1902.62"/>
</g>
<!-- layer_1_expert_14_gpu3&#45;&gt;layer_1_expert_agg -->
<g id="edge122" class="edge">
<title>layer_1_expert_14_gpu3&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M14065.75,-1974.28C14068.86,-1973.83 14071.94,-1973.39 14075,-1972.95 14279.76,-1943.93 14519.53,-1919.42 14658.65,-1906.14"/>
<polygon fill="black" stroke="black" points="14659.28,-1909.6 14668.9,-1905.16 14658.62,-1902.63 14659.28,-1909.6"/>
</g>
<!-- layer_1_expert_15_gpu3&#45;&gt;layer_1_expert_agg -->
<g id="edge123" class="edge">
<title>layer_1_expert_15_gpu3&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M14468.39,-1972.93C14531.01,-1957.1 14601.44,-1939.31 14658.99,-1924.77"/>
<polygon fill="black" stroke="black" points="14660.01,-1928.12 14668.85,-1922.28 14658.3,-1921.33 14660.01,-1928.12"/>
</g>
<!-- layer_1_expert_16_gpu4&#45;&gt;layer_1_expert_agg -->
<g id="edge124" class="edge">
<title>layer_1_expert_16_gpu4&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M14775,-1972.84C14775,-1964.32 14775,-1955.22 14775,-1946.37"/>
<polygon fill="black" stroke="black" points="14778.5,-1946.14 14775,-1936.14 14771.5,-1946.14 14778.5,-1946.14"/>
</g>
<!-- layer_1_expert_17_gpu4&#45;&gt;layer_1_expert_agg -->
<g id="edge125" class="edge">
<title>layer_1_expert_17_gpu4&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M15081.61,-1972.93C15018.99,-1957.1 14948.56,-1939.31 14891.01,-1924.77"/>
<polygon fill="black" stroke="black" points="14891.7,-1921.33 14881.15,-1922.28 14889.99,-1928.12 14891.7,-1921.33"/>
</g>
<!-- layer_1_expert_18_gpu4&#45;&gt;layer_1_expert_agg -->
<g id="edge126" class="edge">
<title>layer_1_expert_18_gpu4&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M15484.28,-1974.14C15481.51,-1973.74 15478.74,-1973.34 15476,-1972.95 15270.96,-1943.83 15030.85,-1919.36 14891.52,-1906.11"/>
<polygon fill="black" stroke="black" points="14891.54,-1902.59 14881.25,-1905.13 14890.88,-1909.56 14891.54,-1902.59"/>
</g>
<!-- layer_1_expert_19_gpu4&#45;&gt;layer_1_expert_agg -->
<g id="edge127" class="edge">
<title>layer_1_expert_19_gpu4&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M15951.3,-1973.97C15948.52,-1973.62 15945.75,-1973.28 15943,-1972.95 15559.59,-1927.04 15101.87,-1906.59 14891.38,-1899.1"/>
<polygon fill="black" stroke="black" points="14891.36,-1895.59 14881.24,-1898.74 14891.11,-1902.59 14891.36,-1895.59"/>
</g>
<!-- layer_1_expert_20_gpu5&#45;&gt;layer_1_expert_agg -->
<g id="edge128" class="edge">
<title>layer_1_expert_20_gpu5&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M16418.31,-1973.9C16415.53,-1973.57 16412.75,-1973.26 16410,-1972.95 15842.83,-1910.47 15159.52,-1898.32 14891.19,-1895.99"/>
<polygon fill="black" stroke="black" points="14891.07,-1892.49 14881.04,-1895.91 14891.01,-1899.49 14891.07,-1892.49"/>
</g>
<!-- layer_1_expert_21_gpu5&#45;&gt;layer_1_expert_agg -->
<g id="edge129" class="edge">
<title>layer_1_expert_21_gpu5&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M16885.32,-1973.86C16882.53,-1973.54 16879.76,-1973.24 16877,-1972.95 16487.29,-1932.09 15273.78,-1905.27 14891.53,-1897.67"/>
<polygon fill="black" stroke="black" points="14891.35,-1894.17 14881.29,-1897.47 14891.22,-1901.17 14891.35,-1894.17"/>
</g>
<!-- layer_1_expert_22_gpu5&#45;&gt;layer_1_expert_agg -->
<g id="edge130" class="edge">
<title>layer_1_expert_22_gpu5&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M17352.32,-1973.83C17349.53,-1973.53 17346.76,-1973.23 17344,-1972.95 16858.39,-1923.68 15326.54,-1902.02 14891.34,-1896.77"/>
<polygon fill="black" stroke="black" points="14891.31,-1893.27 14881.27,-1896.65 14891.23,-1900.27 14891.31,-1893.27"/>
</g>
<!-- layer_1_expert_23_gpu5&#45;&gt;layer_1_expert_agg -->
<g id="edge131" class="edge">
<title>layer_1_expert_23_gpu5&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M17819.32,-1973.82C17816.53,-1973.52 17813.76,-1973.23 17811,-1972.95 17496.89,-1941.62 17416.56,-1962.14 17101,-1953.95 16252.99,-1931.94 15231.04,-1906.68 14891.17,-1898.31"/>
<polygon fill="black" stroke="black" points="14891.15,-1894.81 14881.07,-1898.06 14890.98,-1901.81 14891.15,-1894.81"/>
</g>
<!-- layer_1_expert_24_gpu6&#45;&gt;layer_1_expert_agg -->
<g id="edge132" class="edge">
<title>layer_1_expert_24_gpu6&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M18286.32,-1973.8C18283.53,-1973.5 18280.76,-1973.22 18278,-1972.95 17598.92,-1906.8 15420.2,-1897.07 14891.43,-1895.68"/>
<polygon fill="black" stroke="black" points="14891.13,-1892.18 14881.13,-1895.65 14891.12,-1899.18 14891.13,-1892.18"/>
</g>
<!-- layer_1_expert_25_gpu6&#45;&gt;layer_1_expert_agg -->
<g id="edge133" class="edge">
<title>layer_1_expert_25_gpu6&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M18753.32,-1973.82C18750.53,-1973.52 18747.76,-1973.23 18745,-1972.95 18428.23,-1941.39 18347.26,-1961.04 18029,-1953.95 16801.17,-1926.63 15312.52,-1903.53 14891.11,-1897.18"/>
<polygon fill="black" stroke="black" points="14891.1,-1893.68 14881.05,-1897.03 14890.99,-1900.68 14891.1,-1893.68"/>
</g>
<!-- layer_1_expert_26_gpu6&#45;&gt;layer_1_expert_agg -->
<g id="edge134" class="edge">
<title>layer_1_expert_26_gpu6&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M19220.32,-1973.79C19217.53,-1973.5 19214.76,-1973.22 19212,-1972.95 18785.88,-1931.96 18677.01,-1961.78 18249,-1953.95 16930.65,-1929.85 15330.82,-1904.26 14891.41,-1897.29"/>
<polygon fill="black" stroke="black" points="14891.3,-1893.79 14881.25,-1897.13 14891.19,-1900.79 14891.3,-1893.79"/>
</g>
<!-- layer_1_expert_27_gpu6&#45;&gt;layer_1_expert_agg -->
<g id="edge135" class="edge">
<title>layer_1_expert_27_gpu6&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M19687.32,-1973.78C19684.53,-1973.49 19681.76,-1973.22 19679,-1972.95 19203.74,-1927.72 19082.34,-1961.82 18605,-1953.95 17139.28,-1929.79 15357.98,-1903.87 14891.35,-1897.13"/>
<polygon fill="black" stroke="black" points="14891.29,-1893.63 14881.24,-1896.98 14891.18,-1900.63 14891.29,-1893.63"/>
</g>
<!-- layer_1_expert_28_gpu7&#45;&gt;layer_1_expert_agg -->
<g id="edge136" class="edge">
<title>layer_1_expert_28_gpu7&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M20154.32,-1973.78C20151.53,-1973.49 20148.76,-1973.21 20146,-1972.95 19648.6,-1925.81 19521.57,-1961.62 19022,-1953.95 17383.09,-1928.81 15388.34,-1903.23 14891.32,-1896.92"/>
<polygon fill="black" stroke="black" points="14891.32,-1893.42 14881.27,-1896.79 14891.23,-1900.42 14891.32,-1893.42"/>
</g>
<!-- layer_1_expert_29_gpu7&#45;&gt;layer_1_expert_agg -->
<g id="edge137" class="edge">
<title>layer_1_expert_29_gpu7&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M20621.32,-1973.78C20618.53,-1973.49 20615.76,-1973.21 20613,-1972.95 20107.19,-1925.08 19978.02,-1961.34 19470,-1953.95 17644.61,-1927.41 15419.91,-1902.54 14891.5,-1896.73"/>
<polygon fill="black" stroke="black" points="14891.24,-1893.22 14881.2,-1896.61 14891.16,-1900.22 14891.24,-1893.22"/>
</g>
<!-- layer_1_expert_30_gpu7&#45;&gt;layer_1_expert_agg -->
<g id="edge138" class="edge">
<title>layer_1_expert_30_gpu7&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M21088.32,-1973.78C21085.53,-1973.49 21082.76,-1973.21 21080,-1972.95 20569.32,-1924.66 20438.91,-1961.09 19926,-1953.95 17909.57,-1925.9 15448.99,-1901.88 14891.13,-1896.55"/>
<polygon fill="black" stroke="black" points="14891.1,-1893.05 14881.07,-1896.46 14891.03,-1900.05 14891.1,-1893.05"/>
</g>
<!-- layer_1_expert_31_gpu7&#45;&gt;layer_1_expert_agg -->
<g id="edge139" class="edge">
<title>layer_1_expert_31_gpu7&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M21555.32,-1973.78C21552.53,-1973.49 21549.76,-1973.21 21547,-1972.95 21033.22,-1924.4 20902.02,-1960.87 20386,-1953.95 18176.86,-1924.36 15478.3,-1901.29 14891.21,-1896.41"/>
<polygon fill="black" stroke="black" points="14891.08,-1892.91 14881.05,-1896.32 14891.02,-1899.91 14891.08,-1892.91"/>
</g>
<!-- layer_2_residual_mha -->
<g id="node78" class="node">
<title>layer_2_residual_mha</title>
<polygon fill="lightgreen" stroke="black" points="14964.5,-1540.95 14585.5,-1540.95 14585.5,-1472.95 14964.5,-1472.95 14964.5,-1540.95"/>
<text text-anchor="middle" x="14775" y="-1525.75" font-family="Times,serif" font-size="14.00">Add &amp; LayerNorm</text>
<text text-anchor="middle" x="14775" y="-1510.75" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="14775" y="-1495.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="14775" y="-1480.75" font-family="Times,serif" font-size="14.00">Add: [1024, hidden_size/8] + [1024, hidden_size/8]</text>
</g>
<!-- layer_2_mha&#45;&gt;layer_2_residual_mha -->
<g id="edge141" class="edge">
<title>layer_2_mha&#45;&gt;layer_2_residual_mha</title>
<path fill="none" stroke="black" d="M14775,-1577.93C14775,-1569.26 14775,-1560.06 14775,-1551.28"/>
<polygon fill="black" stroke="black" points="14778.5,-1551.22 14775,-1541.22 14771.5,-1551.22 14778.5,-1551.22"/>
</g>
<!-- layer_2_gate -->
<g id="node79" class="node">
<title>layer_2_gate</title>
<polygon fill="lightyellow" stroke="black" points="11378,-1435.95 11110,-1435.95 11110,-1352.95 11378,-1352.95 11378,-1435.95"/>
<text text-anchor="middle" x="11244" y="-1420.75" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="11244" y="-1405.75" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="11244" y="-1390.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="11244" y="-1375.75" font-family="Times,serif" font-size="14.00">[1024, hidden_size/8] &#45;&gt; [1024, 64]</text>
<text text-anchor="middle" x="11244" y="-1360.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- layer_2_residual_mha&#45;&gt;layer_2_gate -->
<g id="edge142" class="edge">
<title>layer_2_residual_mha&#45;&gt;layer_2_gate</title>
<path fill="none" stroke="black" d="M14585.47,-1500.02C13956.37,-1480.33 11945.8,-1417.42 11388.46,-1399.97"/>
<polygon fill="black" stroke="black" points="11388.46,-1396.47 11378.35,-1399.66 11388.24,-1403.47 11388.46,-1396.47"/>
</g>
<!-- layer_2_expert_agg -->
<g id="node80" class="node">
<title>layer_2_expert_agg</title>
<polygon fill="lightpink" stroke="black" points="11350,-1166.95 11138,-1166.95 11138,-1083.95 11350,-1083.95 11350,-1166.95"/>
<text text-anchor="middle" x="11244" y="-1151.75" font-family="Times,serif" font-size="14.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="11244" y="-1136.75" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="11244" y="-1121.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="11244" y="-1106.75" font-family="Times,serif" font-size="14.00">AllReduce across 8 GPUs</text>
<text text-anchor="middle" x="11244" y="-1091.75" font-family="Times,serif" font-size="14.00">[1024, hidden_size/8]</text>
</g>
<!-- layer_2_residual_mha&#45;&gt;layer_2_expert_agg -->
<g id="edge143" class="edge">
<title>layer_2_residual_mha&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M14964.92,-1498.5C15460.42,-1478.46 16833.12,-1419.2 17974,-1334.95 18206.96,-1317.75 18646.82,-1370.47 18483,-1203.95 18417.81,-1137.69 12286.42,-1127.71 11360.55,-1126.58"/>
<polygon fill="black" stroke="black" points="11360.23,-1123.08 11350.22,-1126.57 11360.22,-1130.08 11360.23,-1123.08"/>
</g>
<!-- layer_2_expert_32_gpu8 -->
<g id="node82" class="node">
<title>layer_2_expert_32_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="3996.5,-1286.95 3547.5,-1286.95 3547.5,-1203.95 3996.5,-1203.95 3996.5,-1286.95"/>
<text text-anchor="middle" x="3772" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 32</text>
<text text-anchor="middle" x="3772" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="3772" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="3772" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="3772" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_32_gpu8 -->
<g id="edge145" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_32_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11109.68,-1393.59C10288.03,-1394.26 5931.46,-1394.85 4597,-1334.95 4336.64,-1323.27 4268.58,-1320.33 4006.9,-1287.17"/>
<polygon fill="black" stroke="black" points="4007.07,-1283.66 3996.7,-1285.88 4006.18,-1290.61 4007.07,-1283.66"/>
<text text-anchor="middle" x="4644" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="4644" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_2_expert_33_gpu8 -->
<g id="node83" class="node">
<title>layer_2_expert_33_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="4463.5,-1286.95 4014.5,-1286.95 4014.5,-1203.95 4463.5,-1203.95 4463.5,-1286.95"/>
<text text-anchor="middle" x="4239" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 33</text>
<text text-anchor="middle" x="4239" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4239" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4239" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="4239" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_33_gpu8 -->
<g id="edge146" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_33_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11109.88,-1392.16C10561.63,-1386.79 8437.17,-1365.08 6690,-1334.95 5707.51,-1318.01 5455.11,-1381.88 4473.8,-1287.09"/>
<polygon fill="black" stroke="black" points="4473.97,-1283.59 4463.68,-1286.11 4473.29,-1290.56 4473.97,-1283.59"/>
<text text-anchor="middle" x="6737" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="6737" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_2_expert_34_gpu8 -->
<g id="node84" class="node">
<title>layer_2_expert_34_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="4930.5,-1286.95 4481.5,-1286.95 4481.5,-1203.95 4930.5,-1203.95 4930.5,-1286.95"/>
<text text-anchor="middle" x="4706" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 34</text>
<text text-anchor="middle" x="4706" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4706" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4706" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="4706" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_34_gpu8 -->
<g id="edge147" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_34_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11109.98,-1391.13C10677.11,-1383.58 9277.27,-1358.85 8119,-1334.95 7527.42,-1322.75 7379.63,-1314.5 6788,-1304.95 6585.58,-1301.69 5185.5,-1305.49 4940.81,-1286.99"/>
<polygon fill="black" stroke="black" points="4940.93,-1283.49 4930.67,-1286.15 4940.35,-1290.47 4940.93,-1283.49"/>
<text text-anchor="middle" x="8166" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="8166" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_2_expert_35_gpu8 -->
<g id="node85" class="node">
<title>layer_2_expert_35_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="5397.5,-1286.95 4948.5,-1286.95 4948.5,-1203.95 5397.5,-1203.95 5397.5,-1286.95"/>
<text text-anchor="middle" x="5173" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 35</text>
<text text-anchor="middle" x="5173" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="5173" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5173" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="5173" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_35_gpu8 -->
<g id="edge148" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_35_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11109.73,-1391.03C10750.2,-1384.35 9735.73,-1364.19 8892,-1334.95 8591.88,-1324.55 8517.2,-1312.58 8217,-1304.95 7907.89,-1297.1 5760.7,-1314.44 5407.82,-1287.01"/>
<polygon fill="black" stroke="black" points="5407.93,-1283.51 5397.67,-1286.17 5407.35,-1290.49 5407.93,-1283.51"/>
<text text-anchor="middle" x="8939" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="8939" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_2_expert_36_gpu9 -->
<g id="node86" class="node">
<title>layer_2_expert_36_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="5864.5,-1286.95 5415.5,-1286.95 5415.5,-1203.95 5864.5,-1203.95 5864.5,-1286.95"/>
<text text-anchor="middle" x="5640" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 36</text>
<text text-anchor="middle" x="5640" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="5640" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5640" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="5640" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_36_gpu9 -->
<g id="edge149" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_36_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11109.79,-1391.9C10798.2,-1387.73 10001.64,-1373.85 9337,-1334.95 9182.47,-1325.91 9144.63,-1312.07 8990,-1304.95 8647.15,-1289.17 6261.63,-1317.2 5874.75,-1287.01"/>
<polygon fill="black" stroke="black" points="5874.93,-1283.51 5864.67,-1286.17 5874.35,-1290.49 5874.93,-1283.51"/>
<text text-anchor="middle" x="9384" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="9384" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_2_expert_37_gpu9 -->
<g id="node87" class="node">
<title>layer_2_expert_37_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="6331.5,-1286.95 5882.5,-1286.95 5882.5,-1203.95 6331.5,-1203.95 6331.5,-1286.95"/>
<text text-anchor="middle" x="6107" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 37</text>
<text text-anchor="middle" x="6107" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="6107" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="6107" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="6107" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_37_gpu9 -->
<g id="edge150" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_37_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11109.77,-1394.36C10831.06,-1394.97 10169.63,-1389.87 9618,-1334.95 9535.99,-1326.79 9517.13,-1311.88 9435,-1304.95 9095.42,-1276.31 6725.9,-1316.76 6341.68,-1287"/>
<polygon fill="black" stroke="black" points="6341.93,-1283.51 6331.67,-1286.17 6341.35,-1290.49 6341.93,-1283.51"/>
<text text-anchor="middle" x="9665" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="9665" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_2_expert_38_gpu9 -->
<g id="node88" class="node">
<title>layer_2_expert_38_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="6798.5,-1286.95 6349.5,-1286.95 6349.5,-1203.95 6798.5,-1203.95 6798.5,-1286.95"/>
<text text-anchor="middle" x="6574" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 38</text>
<text text-anchor="middle" x="6574" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="6574" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="6574" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="6574" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_38_gpu9 -->
<g id="edge151" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_38_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11109.88,-1392.19C10804.17,-1388.62 10063.12,-1375.9 9817,-1334.95 9770.81,-1327.27 9762.32,-1311.83 9716,-1304.95 9558.72,-1281.59 7050.75,-1300.7 6808.72,-1286.87"/>
<polygon fill="black" stroke="black" points="6808.89,-1283.38 6798.67,-1286.17 6808.4,-1290.36 6808.89,-1283.38"/>
<text text-anchor="middle" x="9864" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="9864" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_2_expert_39_gpu9 -->
<g id="node89" class="node">
<title>layer_2_expert_39_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="7265.5,-1286.95 6816.5,-1286.95 6816.5,-1203.95 7265.5,-1203.95 7265.5,-1286.95"/>
<text text-anchor="middle" x="7041" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 39</text>
<text text-anchor="middle" x="7041" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="7041" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7041" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="7041" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_39_gpu9 -->
<g id="edge152" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_39_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11109.84,-1394.28C10828.64,-1394.88 10186.09,-1389.95 9975,-1334.95 9946.15,-1327.44 9943.99,-1311.9 9915,-1304.95 9774.82,-1271.36 7502.15,-1299.05 7275.83,-1286.86"/>
<polygon fill="black" stroke="black" points="7275.89,-1283.36 7265.67,-1286.17 7275.41,-1290.34 7275.89,-1283.36"/>
<text text-anchor="middle" x="10022" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="10022" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_2_expert_40_gpu10 -->
<g id="node90" class="node">
<title>layer_2_expert_40_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="7732.5,-1286.95 7283.5,-1286.95 7283.5,-1203.95 7732.5,-1203.95 7732.5,-1286.95"/>
<text text-anchor="middle" x="7508" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 40</text>
<text text-anchor="middle" x="7508" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="7508" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7508" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="7508" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_40_gpu10 -->
<g id="edge153" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_40_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11109.97,-1390.9C10830.64,-1384.96 10204.48,-1368.09 10113,-1334.95 10092.11,-1327.38 10094.05,-1312.06 10073,-1304.95 10013.24,-1284.78 7920.36,-1292.34 7742.81,-1286.65"/>
<polygon fill="black" stroke="black" points="7742.83,-1283.15 7732.67,-1286.16 7742.49,-1290.14 7742.83,-1283.15"/>
<text text-anchor="middle" x="10160" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="10160" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_2_expert_41_gpu10 -->
<g id="node91" class="node">
<title>layer_2_expert_41_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="8199.5,-1286.95 7750.5,-1286.95 7750.5,-1203.95 8199.5,-1203.95 8199.5,-1286.95"/>
<text text-anchor="middle" x="7975" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 41</text>
<text text-anchor="middle" x="7975" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="7975" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7975" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="7975" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_41_gpu10 -->
<g id="edge154" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_41_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11109.89,-1391.05C10854.55,-1385.68 10317.01,-1370.3 10240,-1334.95 10223.15,-1327.22 10228.04,-1312.27 10211,-1304.95 10161.37,-1283.64 8372.95,-1291.48 8209.9,-1286.63"/>
<polygon fill="black" stroke="black" points="8209.82,-1283.13 8199.67,-1286.16 8209.5,-1290.12 8209.82,-1283.13"/>
<text text-anchor="middle" x="10287" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="10287" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_2_expert_42_gpu10 -->
<g id="node92" class="node">
<title>layer_2_expert_42_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="8666.5,-1286.95 8217.5,-1286.95 8217.5,-1203.95 8666.5,-1203.95 8666.5,-1286.95"/>
<text text-anchor="middle" x="8442" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 42</text>
<text text-anchor="middle" x="8442" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="8442" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8442" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="8442" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_42_gpu10 -->
<g id="edge155" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_42_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11109.88,-1390.48C10879.37,-1384.51 10426.49,-1368.62 10362,-1334.95 10346.86,-1327.05 10353.35,-1312.43 10338,-1304.95 10297.85,-1285.39 8823.93,-1290.77 8677,-1286.61"/>
<polygon fill="black" stroke="black" points="8676.82,-1283.1 8666.67,-1286.15 8676.51,-1290.1 8676.82,-1283.1"/>
<text text-anchor="middle" x="10409" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="10409" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_2_expert_43_gpu10 -->
<g id="node93" class="node">
<title>layer_2_expert_43_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="9133.5,-1286.95 8684.5,-1286.95 8684.5,-1203.95 9133.5,-1203.95 9133.5,-1286.95"/>
<text text-anchor="middle" x="8909" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 43</text>
<text text-anchor="middle" x="8909" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="8909" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8909" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="8909" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_43_gpu10 -->
<g id="edge156" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_43_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11109.64,-1389.52C10904.89,-1382.59 10532.85,-1365.89 10480,-1334.95 10466.17,-1326.86 10474.08,-1312.61 10460,-1304.95 10429.06,-1288.12 9271.86,-1290.16 9143.9,-1286.59"/>
<polygon fill="black" stroke="black" points="9143.82,-1283.08 9133.67,-1286.14 9143.51,-1290.08 9143.82,-1283.08"/>
<text text-anchor="middle" x="10527" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="10527" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_2_expert_44_gpu11 -->
<g id="node94" class="node">
<title>layer_2_expert_44_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="9600.5,-1286.95 9151.5,-1286.95 9151.5,-1203.95 9600.5,-1203.95 9600.5,-1286.95"/>
<text text-anchor="middle" x="9376" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 44</text>
<text text-anchor="middle" x="9376" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="9376" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9376" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="9376" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_44_gpu11 -->
<g id="edge157" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_44_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11109.65,-1387.46C10933.25,-1378.64 10640.83,-1360.43 10598,-1334.95 10584.23,-1326.76 10592.06,-1312.65 10578,-1304.95 10532.52,-1280.07 9725.9,-1291.17 9610.82,-1286.71"/>
<polygon fill="black" stroke="black" points="9610.86,-1283.2 9600.68,-1286.12 9610.46,-1290.19 9610.86,-1283.2"/>
<text text-anchor="middle" x="10645" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="10645" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_2_expert_45_gpu11 -->
<g id="node95" class="node">
<title>layer_2_expert_45_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="10067.5,-1286.95 9618.5,-1286.95 9618.5,-1203.95 10067.5,-1203.95 10067.5,-1286.95"/>
<text text-anchor="middle" x="9843" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 45</text>
<text text-anchor="middle" x="9843" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="9843" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9843" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="9843" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_45_gpu11 -->
<g id="edge158" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_45_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11109.95,-1391.67C10975.27,-1387.61 10778.78,-1374.78 10715,-1334.95 10701.61,-1326.59 10709.71,-1312.76 10696,-1304.95 10667.55,-1288.75 10164.34,-1290.21 10077.74,-1286.68"/>
<polygon fill="black" stroke="black" points="10077.87,-1283.18 10067.68,-1286.08 10077.45,-1290.17 10077.87,-1283.18"/>
<text text-anchor="middle" x="10762" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="10762" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_2_expert_46_gpu11 -->
<g id="node96" class="node">
<title>layer_2_expert_46_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="10534.5,-1286.95 10085.5,-1286.95 10085.5,-1203.95 10534.5,-1203.95 10534.5,-1286.95"/>
<text text-anchor="middle" x="10310" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 46</text>
<text text-anchor="middle" x="10310" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="10310" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10310" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="10310" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_46_gpu11 -->
<g id="edge159" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_46_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11109.94,-1383.27C11037.53,-1375.1 10947.36,-1360.57 10870,-1334.95 10842.82,-1325.95 10840.55,-1312.74 10813,-1304.95 10700.43,-1273.13 10664.38,-1299.73 10544.97,-1287.09"/>
<polygon fill="black" stroke="black" points="10545.03,-1283.58 10534.7,-1285.93 10544.24,-1290.53 10545.03,-1283.58"/>
<text text-anchor="middle" x="10917" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="10917" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_2_expert_47_gpu11 -->
<g id="node97" class="node">
<title>layer_2_expert_47_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="11001.5,-1286.95 10552.5,-1286.95 10552.5,-1203.95 11001.5,-1203.95 11001.5,-1286.95"/>
<text text-anchor="middle" x="10777" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 47</text>
<text text-anchor="middle" x="10777" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="10777" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10777" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="10777" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_47_gpu11 -->
<g id="edge160" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_47_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11115.15,-1352.9C11053.14,-1333.37 10978.7,-1309.94 10915.48,-1290.04"/>
<polygon fill="black" stroke="black" points="10916.42,-1286.67 10905.83,-1287.01 10914.32,-1293.35 10916.42,-1286.67"/>
<text text-anchor="middle" x="11099" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="11099" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_2_expert_48_gpu12 -->
<g id="node98" class="node">
<title>layer_2_expert_48_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="11468.5,-1286.95 11019.5,-1286.95 11019.5,-1203.95 11468.5,-1203.95 11468.5,-1286.95"/>
<text text-anchor="middle" x="11244" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 48</text>
<text text-anchor="middle" x="11244" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="11244" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11244" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="11244" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_48_gpu12 -->
<g id="edge161" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_48_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11244,-1352.9C11244,-1335.7 11244,-1315.46 11244,-1297.28"/>
<polygon fill="black" stroke="black" points="11247.5,-1297.13 11244,-1287.13 11240.5,-1297.13 11247.5,-1297.13"/>
<text text-anchor="middle" x="11291" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="11291" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_2_expert_49_gpu12 -->
<g id="node99" class="node">
<title>layer_2_expert_49_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="11935.5,-1286.95 11486.5,-1286.95 11486.5,-1203.95 11935.5,-1203.95 11935.5,-1286.95"/>
<text text-anchor="middle" x="11711" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 49</text>
<text text-anchor="middle" x="11711" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="11711" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11711" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="11711" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_49_gpu12 -->
<g id="edge162" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_49_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11372.85,-1352.9C11434.86,-1333.37 11509.3,-1309.94 11572.52,-1290.04"/>
<polygon fill="black" stroke="black" points="11573.68,-1293.35 11582.17,-1287.01 11571.58,-1286.67 11573.68,-1293.35"/>
<text text-anchor="middle" x="11566" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="11566" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_2_expert_50_gpu12 -->
<g id="node100" class="node">
<title>layer_2_expert_50_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="12402.5,-1286.95 11953.5,-1286.95 11953.5,-1203.95 12402.5,-1203.95 12402.5,-1286.95"/>
<text text-anchor="middle" x="12178" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 50</text>
<text text-anchor="middle" x="12178" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="12178" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12178" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="12178" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_50_gpu12 -->
<g id="edge163" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_50_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378.19,-1373.93C11517.11,-1353.53 11740.68,-1320.13 11943.32,-1287.22"/>
<polygon fill="black" stroke="black" points="11943.95,-1290.66 11953.26,-1285.6 11942.82,-1283.75 11943.95,-1290.66"/>
<text text-anchor="middle" x="11877" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="11877" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_2_expert_51_gpu12 -->
<g id="node101" class="node">
<title>layer_2_expert_51_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="12869.5,-1286.95 12420.5,-1286.95 12420.5,-1203.95 12869.5,-1203.95 12869.5,-1286.95"/>
<text text-anchor="middle" x="12645" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 51</text>
<text text-anchor="middle" x="12645" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="12645" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12645" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="12645" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_51_gpu12 -->
<g id="edge164" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_51_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378,-1385.13C11593.69,-1370.87 12031.23,-1338.37 12410.22,-1287.17"/>
<polygon fill="black" stroke="black" points="12410.85,-1290.62 12420.29,-1285.81 12409.91,-1283.68 12410.85,-1290.62"/>
<text text-anchor="middle" x="12300" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="12300" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_2_expert_52_gpu13 -->
<g id="node102" class="node">
<title>layer_2_expert_52_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="13336.5,-1286.95 12887.5,-1286.95 12887.5,-1203.95 13336.5,-1203.95 13336.5,-1286.95"/>
<text text-anchor="middle" x="13112" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 52</text>
<text text-anchor="middle" x="13112" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="13112" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13112" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="13112" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_52_gpu13 -->
<g id="edge165" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_52_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378.11,-1390.74C11656.4,-1383.78 12316.74,-1360.46 12876.98,-1287.19"/>
<polygon fill="black" stroke="black" points="12877.83,-1290.61 12887.29,-1285.84 12876.92,-1283.67 12877.83,-1290.61"/>
<text text-anchor="middle" x="12749" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="12749" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_2_expert_53_gpu13 -->
<g id="node103" class="node">
<title>layer_2_expert_53_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="13803.5,-1286.95 13354.5,-1286.95 13354.5,-1203.95 13803.5,-1203.95 13803.5,-1286.95"/>
<text text-anchor="middle" x="13579" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 53</text>
<text text-anchor="middle" x="13579" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="13579" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13579" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="13579" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_53_gpu13 -->
<g id="edge166" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_53_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378.1,-1390.67C11647.67,-1384.59 12274.4,-1367.92 12800,-1334.95 13039.8,-1319.91 13102.74,-1318.54 13344.15,-1287.17"/>
<polygon fill="black" stroke="black" points="13344.83,-1290.61 13354.29,-1285.85 13343.92,-1283.67 13344.83,-1290.61"/>
<text text-anchor="middle" x="13245" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="13245" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_2_expert_54_gpu13 -->
<g id="node104" class="node">
<title>layer_2_expert_54_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="14270.5,-1286.95 13821.5,-1286.95 13821.5,-1203.95 14270.5,-1203.95 14270.5,-1286.95"/>
<text text-anchor="middle" x="14046" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 54</text>
<text text-anchor="middle" x="14046" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="14046" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14046" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="14046" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_54_gpu13 -->
<g id="edge167" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_54_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378.28,-1392.6C11706.15,-1389.87 12573.62,-1378.74 13296,-1334.95 13523.08,-1321.19 13582.58,-1317.51 13811.33,-1287.15"/>
<polygon fill="black" stroke="black" points="13811.84,-1290.62 13821.29,-1285.83 13810.92,-1283.68 13811.84,-1290.62"/>
<text text-anchor="middle" x="13710" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="13710" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_2_expert_55_gpu13 -->
<g id="node105" class="node">
<title>layer_2_expert_55_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="14737.5,-1286.95 14288.5,-1286.95 14288.5,-1203.95 14737.5,-1203.95 14737.5,-1286.95"/>
<text text-anchor="middle" x="14513" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 55</text>
<text text-anchor="middle" x="14513" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="14513" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14513" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="14513" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_55_gpu13 -->
<g id="edge168" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_55_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378.17,-1393.59C11754.41,-1393.27 12851.44,-1387.52 13761,-1334.95 13988.99,-1321.78 14048.69,-1317.6 14278.29,-1287.16"/>
<polygon fill="black" stroke="black" points="14278.84,-1290.62 14288.29,-1285.83 14277.92,-1283.68 14278.84,-1290.62"/>
<text text-anchor="middle" x="14176" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="14176" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_2_expert_56_gpu14 -->
<g id="node106" class="node">
<title>layer_2_expert_56_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="15204.5,-1286.95 14755.5,-1286.95 14755.5,-1203.95 15204.5,-1203.95 15204.5,-1286.95"/>
<text text-anchor="middle" x="14980" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 56</text>
<text text-anchor="middle" x="14980" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="14980" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14980" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="14980" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_56_gpu14 -->
<g id="edge169" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_56_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378.3,-1392.11C11882.29,-1386.89 13661.02,-1366.58 14227,-1334.95 14455.45,-1322.19 14515.24,-1317.65 14745.27,-1287.16"/>
<polygon fill="black" stroke="black" points="14745.84,-1290.62 14755.29,-1285.83 14744.92,-1283.68 14745.84,-1290.62"/>
<text text-anchor="middle" x="14643" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="14643" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_2_expert_57_gpu14 -->
<g id="node107" class="node">
<title>layer_2_expert_57_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="15671.5,-1286.95 15222.5,-1286.95 15222.5,-1203.95 15671.5,-1203.95 15671.5,-1286.95"/>
<text text-anchor="middle" x="15447" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 57</text>
<text text-anchor="middle" x="15447" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15447" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15447" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="15447" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_57_gpu14 -->
<g id="edge170" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_57_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378.06,-1392.53C11930.3,-1388.51 14031.17,-1371.11 14694,-1334.95 14922.47,-1322.49 14982.25,-1317.66 15212.27,-1287.16"/>
<polygon fill="black" stroke="black" points="15212.84,-1290.62 15222.29,-1285.83 15211.92,-1283.68 15212.84,-1290.62"/>
<text text-anchor="middle" x="15120" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="15120" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_2_expert_58_gpu14 -->
<g id="node108" class="node">
<title>layer_2_expert_58_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="16138.5,-1286.95 15689.5,-1286.95 15689.5,-1203.95 16138.5,-1203.95 16138.5,-1286.95"/>
<text text-anchor="middle" x="15914" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 58</text>
<text text-anchor="middle" x="15914" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="15914" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="15914" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="15914" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_58_gpu14 -->
<g id="edge171" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_58_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378.25,-1392.88C11977.15,-1390.1 14408.99,-1376.42 15171,-1334.95 15395,-1322.76 15453.63,-1317.3 15679.12,-1287.18"/>
<polygon fill="black" stroke="black" points="15679.84,-1290.62 15689.29,-1285.83 15678.91,-1283.68 15679.84,-1290.62"/>
<text text-anchor="middle" x="15580" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="15580" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_2_expert_59_gpu14 -->
<g id="node109" class="node">
<title>layer_2_expert_59_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="16605.5,-1286.95 16156.5,-1286.95 16156.5,-1203.95 16605.5,-1203.95 16605.5,-1286.95"/>
<text text-anchor="middle" x="16381" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 59</text>
<text text-anchor="middle" x="16381" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="16381" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16381" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="16381" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_59_gpu14 -->
<g id="edge172" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_59_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378.12,-1393.1C12018.9,-1391.19 14772.79,-1380.44 15631,-1334.95 15858.18,-1322.91 15917.58,-1317.56 16146.33,-1287.16"/>
<polygon fill="black" stroke="black" points="16146.84,-1290.62 16156.29,-1285.83 16145.92,-1283.68 16146.84,-1290.62"/>
<text text-anchor="middle" x="16055" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="16055" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_2_expert_60_gpu15 -->
<g id="node110" class="node">
<title>layer_2_expert_60_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="17072.5,-1286.95 16623.5,-1286.95 16623.5,-1203.95 17072.5,-1203.95 17072.5,-1286.95"/>
<text text-anchor="middle" x="16848" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 60</text>
<text text-anchor="middle" x="16848" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="16848" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="16848" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="16848" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_60_gpu15 -->
<g id="edge173" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_60_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378.23,-1393.33C12060.44,-1392.47 15148.31,-1385.79 16106,-1334.95 16329.58,-1323.09 16388.08,-1317.27 16613.14,-1287.18"/>
<polygon fill="black" stroke="black" points="16613.84,-1290.62 16623.29,-1285.82 16612.91,-1283.68 16613.84,-1290.62"/>
<text text-anchor="middle" x="16514" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="16514" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_2_expert_61_gpu15 -->
<g id="node111" class="node">
<title>layer_2_expert_61_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="17539.5,-1286.95 17090.5,-1286.95 17090.5,-1203.95 17539.5,-1203.95 17539.5,-1286.95"/>
<text text-anchor="middle" x="17315" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 61</text>
<text text-anchor="middle" x="17315" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17315" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17315" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="17315" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_61_gpu15 -->
<g id="edge174" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_61_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378.23,-1393.46C12098.39,-1393.3 15510.78,-1389.6 16565,-1334.95 16792.19,-1323.18 16851.58,-1317.56 17080.33,-1287.16"/>
<polygon fill="black" stroke="black" points="17080.84,-1290.62 17090.29,-1285.83 17079.92,-1283.68 17080.84,-1290.62"/>
<text text-anchor="middle" x="16989" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="16989" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_2_expert_62_gpu15 -->
<g id="node112" class="node">
<title>layer_2_expert_62_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="18006.5,-1286.95 17557.5,-1286.95 17557.5,-1203.95 18006.5,-1203.95 18006.5,-1286.95"/>
<text text-anchor="middle" x="17782" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 62</text>
<text text-anchor="middle" x="17782" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="17782" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="17782" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="17782" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_62_gpu15 -->
<g id="edge175" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_62_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378.22,-1393.63C12135.97,-1394.41 15885.73,-1395.1 17040,-1334.95 17263.59,-1323.3 17322.08,-1317.28 17547.14,-1287.18"/>
<polygon fill="black" stroke="black" points="17547.84,-1290.62 17557.29,-1285.82 17546.91,-1283.68 17547.84,-1290.62"/>
<text text-anchor="middle" x="17448" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="17448" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_2_expert_63_gpu15 -->
<g id="node113" class="node">
<title>layer_2_expert_63_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="18473.5,-1286.95 18024.5,-1286.95 18024.5,-1203.95 18473.5,-1203.95 18473.5,-1286.95"/>
<text text-anchor="middle" x="18249" y="-1271.75" font-family="Times,serif" font-size="14.00">Expert 63</text>
<text text-anchor="middle" x="18249" y="-1256.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="18249" y="-1241.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="18249" y="-1226.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="18249" y="-1211.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_63_gpu15 -->
<g id="edge176" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_63_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11378.03,-1393.72C12170.2,-1395.07 16247.67,-1398.78 17499,-1334.95 17726.2,-1323.36 17785.58,-1317.57 18014.33,-1287.16"/>
<polygon fill="black" stroke="black" points="18014.84,-1290.62 18024.29,-1285.83 18013.92,-1283.68 18014.84,-1290.62"/>
<text text-anchor="middle" x="17923" y="-1323.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="17923" y="-1308.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_2_residual_final -->
<g id="node81" class="node">
<title>layer_2_residual_final</title>
<polygon fill="lightgreen" stroke="black" points="11433.5,-1046.95 11054.5,-1046.95 11054.5,-978.95 11433.5,-978.95 11433.5,-1046.95"/>
<text text-anchor="middle" x="11244" y="-1031.75" font-family="Times,serif" font-size="14.00">Add &amp; LayerNorm</text>
<text text-anchor="middle" x="11244" y="-1016.75" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="11244" y="-1001.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="11244" y="-986.75" font-family="Times,serif" font-size="14.00">Add: [1024, hidden_size/8] + [1024, hidden_size/8]</text>
</g>
<!-- layer_2_expert_agg&#45;&gt;layer_2_residual_final -->
<g id="edge144" class="edge">
<title>layer_2_expert_agg&#45;&gt;layer_2_residual_final</title>
<path fill="none" stroke="black" d="M11244,-1083.93C11244,-1075.26 11244,-1066.06 11244,-1057.28"/>
<polygon fill="black" stroke="black" points="11247.5,-1057.22 11244,-1047.22 11240.5,-1057.22 11247.5,-1057.22"/>
</g>
<!-- layer_3_mha -->
<g id="node114" class="node">
<title>layer_3_mha</title>
<polygon fill="lightblue" stroke="black" points="11417.5,-920.95 11070.5,-920.95 11070.5,-837.95 11417.5,-837.95 11417.5,-920.95"/>
<text text-anchor="middle" x="11244" y="-905.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="11244" y="-890.75" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="11244" y="-875.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="11244" y="-860.75" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
<text text-anchor="middle" x="11244" y="-845.75" font-family="Times,serif" font-size="14.00">[1024, hidden_size/8] &#45;&gt; [1024, hidden_size/8]</text>
</g>
<!-- layer_2_residual_final&#45;&gt;layer_3_mha -->
<g id="edge209" class="edge">
<title>layer_2_residual_final&#45;&gt;layer_3_mha</title>
<path fill="none" stroke="black" d="M11244,-978.77C11244,-964.42 11244,-947.29 11244,-931.38"/>
<polygon fill="black" stroke="black" points="11247.5,-931.15 11244,-921.15 11240.5,-931.15 11247.5,-931.15"/>
</g>
<!-- layer_2_expert_32_gpu8&#45;&gt;layer_2_expert_agg -->
<g id="edge177" class="edge">
<title>layer_2_expert_32_gpu8&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M3996.68,-1204.82C3999.47,-1204.52 4002.24,-1204.23 4005,-1203.95 4327.08,-1171.93 4409.38,-1190.63 4733,-1184.95 7320.38,-1139.57 10486.77,-1128.57 11127.7,-1126.76"/>
<polygon fill="black" stroke="black" points="11127.87,-1130.25 11137.86,-1126.73 11127.85,-1123.25 11127.87,-1130.25"/>
</g>
<!-- layer_2_expert_33_gpu8&#45;&gt;layer_2_expert_agg -->
<g id="edge178" class="edge">
<title>layer_2_expert_33_gpu8&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M4463.68,-1204.82C4466.47,-1204.52 4469.24,-1204.23 4472,-1203.95 4794.52,-1171.89 4876.94,-1190.74 5201,-1184.95 7591.06,-1142.24 10513.44,-1129.22 11127.47,-1126.87"/>
<polygon fill="black" stroke="black" points="11127.67,-1130.37 11137.65,-1126.83 11127.64,-1123.37 11127.67,-1130.37"/>
</g>
<!-- layer_2_expert_34_gpu8&#45;&gt;layer_2_expert_agg -->
<g id="edge179" class="edge">
<title>layer_2_expert_34_gpu8&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M4930.68,-1204.82C4933.47,-1204.52 4936.24,-1204.23 4939,-1203.95 5261.96,-1171.86 5344.5,-1190.88 5669,-1184.95 7862.6,-1144.9 10542.24,-1129.91 11127.57,-1127"/>
<polygon fill="black" stroke="black" points="11127.72,-1130.5 11137.7,-1126.95 11127.68,-1123.5 11127.72,-1130.5"/>
</g>
<!-- layer_2_expert_35_gpu8&#45;&gt;layer_2_expert_agg -->
<g id="edge180" class="edge">
<title>layer_2_expert_35_gpu8&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M5397.68,-1204.82C5400.47,-1204.51 5403.24,-1204.23 5406,-1203.95 5730.29,-1171.74 5813.17,-1191.04 6139,-1184.95 8136.17,-1147.63 10573.31,-1130.68 11127.99,-1127.16"/>
<polygon fill="black" stroke="black" points="11128.02,-1130.66 11137.99,-1127.1 11127.97,-1123.66 11128.02,-1130.66"/>
</g>
<!-- layer_2_expert_36_gpu9&#45;&gt;layer_2_expert_agg -->
<g id="edge181" class="edge">
<title>layer_2_expert_36_gpu9&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M5864.68,-1204.81C5867.47,-1204.51 5870.24,-1204.23 5873,-1203.95 6201.72,-1171.36 6285.73,-1191.26 6616,-1184.95 8413.21,-1150.62 10603.4,-1131.62 11127.42,-1127.37"/>
<polygon fill="black" stroke="black" points="11127.66,-1130.87 11137.63,-1127.29 11127.6,-1123.87 11127.66,-1130.87"/>
</g>
<!-- layer_2_expert_37_gpu9&#45;&gt;layer_2_expert_agg -->
<g id="edge182" class="edge">
<title>layer_2_expert_37_gpu9&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M6331.68,-1204.82C6334.47,-1204.51 6337.24,-1204.23 6340,-1203.95 6664.73,-1171.7 6747.73,-1191.46 7074,-1184.95 8680.43,-1152.89 10635.31,-1132.46 11127.36,-1127.58"/>
<polygon fill="black" stroke="black" points="11127.7,-1131.08 11137.67,-1127.48 11127.63,-1124.08 11127.7,-1131.08"/>
</g>
<!-- layer_2_expert_38_gpu9&#45;&gt;layer_2_expert_agg -->
<g id="edge183" class="edge">
<title>layer_2_expert_38_gpu9&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M6798.68,-1204.81C6801.47,-1204.51 6804.24,-1204.23 6807,-1203.95 7137.05,-1171.24 7221.41,-1191.8 7553,-1184.95 8961.11,-1155.86 10671.64,-1133.61 11127.7,-1127.89"/>
<polygon fill="black" stroke="black" points="11127.96,-1131.39 11137.92,-1127.76 11127.88,-1124.39 11127.96,-1131.39"/>
</g>
<!-- layer_2_expert_39_gpu9&#45;&gt;layer_2_expert_agg -->
<g id="edge184" class="edge">
<title>layer_2_expert_39_gpu9&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M7265.68,-1204.81C7268.47,-1204.51 7271.24,-1204.23 7274,-1203.95 7602.72,-1171.36 7686.75,-1192.17 8017,-1184.95 9233.61,-1158.37 10708.41,-1134.79 11127.78,-1128.25"/>
<polygon fill="black" stroke="black" points="11127.85,-1131.75 11137.79,-1128.09 11127.74,-1124.75 11127.85,-1131.75"/>
</g>
<!-- layer_2_expert_40_gpu10&#45;&gt;layer_2_expert_agg -->
<g id="edge185" class="edge">
<title>layer_2_expert_40_gpu10&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M7732.68,-1204.81C7735.47,-1204.51 7738.24,-1204.23 7741,-1203.95 8082.11,-1170.29 8169.32,-1192.84 8512,-1184.95 9525.45,-1161.62 10750.44,-1136.48 11127.78,-1128.81"/>
<polygon fill="black" stroke="black" points="11127.96,-1132.3 11137.88,-1128.6 11127.81,-1125.31 11127.96,-1132.3"/>
</g>
<!-- layer_2_expert_41_gpu10&#45;&gt;layer_2_expert_agg -->
<g id="edge186" class="edge">
<title>layer_2_expert_41_gpu10&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M8199.68,-1204.82C8202.47,-1204.52 8205.24,-1204.23 8208,-1203.95 8522.55,-1172.58 8602.99,-1193.15 8919,-1184.95 9766.65,-1162.96 10788.16,-1137.69 11127.88,-1129.31"/>
<polygon fill="black" stroke="black" points="11128.07,-1132.81 11137.98,-1129.06 11127.9,-1125.81 11128.07,-1132.81"/>
</g>
<!-- layer_2_expert_42_gpu10&#45;&gt;layer_2_expert_agg -->
<g id="edge187" class="edge">
<title>layer_2_expert_42_gpu10&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M8666.68,-1204.83C8669.47,-1204.53 8672.24,-1204.23 8675,-1203.95 9160.61,-1154.68 10692.46,-1133.02 11127.66,-1127.77"/>
<polygon fill="black" stroke="black" points="11127.77,-1131.27 11137.73,-1127.65 11127.69,-1124.27 11127.77,-1131.27"/>
</g>
<!-- layer_2_expert_43_gpu10&#45;&gt;layer_2_expert_agg -->
<g id="edge188" class="edge">
<title>layer_2_expert_43_gpu10&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M9133.68,-1204.86C9136.47,-1204.54 9139.24,-1204.24 9142,-1203.95 9531.71,-1163.09 10745.22,-1136.27 11127.47,-1128.67"/>
<polygon fill="black" stroke="black" points="11127.78,-1132.17 11137.71,-1128.47 11127.65,-1125.17 11127.78,-1132.17"/>
</g>
<!-- layer_2_expert_44_gpu11&#45;&gt;layer_2_expert_agg -->
<g id="edge189" class="edge">
<title>layer_2_expert_44_gpu11&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M9600.69,-1204.9C9603.47,-1204.57 9606.25,-1204.26 9609,-1203.95 10176.17,-1141.47 10859.48,-1129.32 11127.81,-1126.99"/>
<polygon fill="black" stroke="black" points="11127.99,-1130.49 11137.96,-1126.91 11127.93,-1123.49 11127.99,-1130.49"/>
</g>
<!-- layer_2_expert_45_gpu11&#45;&gt;layer_2_expert_agg -->
<g id="edge190" class="edge">
<title>layer_2_expert_45_gpu11&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M10067.7,-1204.97C10070.48,-1204.62 10073.25,-1204.28 10076,-1203.95 10459.41,-1158.04 10917.13,-1137.59 11127.62,-1130.1"/>
<polygon fill="black" stroke="black" points="11127.89,-1133.59 11137.76,-1129.74 11127.64,-1126.59 11127.89,-1133.59"/>
</g>
<!-- layer_2_expert_46_gpu11&#45;&gt;layer_2_expert_agg -->
<g id="edge191" class="edge">
<title>layer_2_expert_46_gpu11&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M10534.72,-1205.14C10537.49,-1204.74 10540.26,-1204.34 10543,-1203.95 10748.04,-1174.83 10988.15,-1150.36 11127.48,-1137.11"/>
<polygon fill="black" stroke="black" points="11128.12,-1140.56 11137.75,-1136.13 11127.46,-1133.59 11128.12,-1140.56"/>
</g>
<!-- layer_2_expert_47_gpu11&#45;&gt;layer_2_expert_agg -->
<g id="edge192" class="edge">
<title>layer_2_expert_47_gpu11&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M10937.39,-1203.93C11000.01,-1188.1 11070.44,-1170.31 11127.99,-1155.77"/>
<polygon fill="black" stroke="black" points="11129.01,-1159.12 11137.85,-1153.28 11127.3,-1152.33 11129.01,-1159.12"/>
</g>
<!-- layer_2_expert_48_gpu12&#45;&gt;layer_2_expert_agg -->
<g id="edge193" class="edge">
<title>layer_2_expert_48_gpu12&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M11244,-1203.84C11244,-1195.32 11244,-1186.22 11244,-1177.37"/>
<polygon fill="black" stroke="black" points="11247.5,-1177.14 11244,-1167.14 11240.5,-1177.14 11247.5,-1177.14"/>
</g>
<!-- layer_2_expert_49_gpu12&#45;&gt;layer_2_expert_agg -->
<g id="edge194" class="edge">
<title>layer_2_expert_49_gpu12&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M11550.61,-1203.93C11487.99,-1188.1 11417.56,-1170.31 11360.01,-1155.77"/>
<polygon fill="black" stroke="black" points="11360.7,-1152.33 11350.15,-1153.28 11358.99,-1159.12 11360.7,-1152.33"/>
</g>
<!-- layer_2_expert_50_gpu12&#45;&gt;layer_2_expert_agg -->
<g id="edge195" class="edge">
<title>layer_2_expert_50_gpu12&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M11953.28,-1205.14C11950.51,-1204.74 11947.74,-1204.34 11945,-1203.95 11739.96,-1174.83 11499.85,-1150.36 11360.52,-1137.11"/>
<polygon fill="black" stroke="black" points="11360.54,-1133.59 11350.25,-1136.13 11359.88,-1140.56 11360.54,-1133.59"/>
</g>
<!-- layer_2_expert_51_gpu12&#45;&gt;layer_2_expert_agg -->
<g id="edge196" class="edge">
<title>layer_2_expert_51_gpu12&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M12420.3,-1204.97C12417.52,-1204.62 12414.75,-1204.28 12412,-1203.95 12028.59,-1158.04 11570.87,-1137.59 11360.38,-1130.1"/>
<polygon fill="black" stroke="black" points="11360.36,-1126.59 11350.24,-1129.74 11360.11,-1133.59 11360.36,-1126.59"/>
</g>
<!-- layer_2_expert_52_gpu13&#45;&gt;layer_2_expert_agg -->
<g id="edge197" class="edge">
<title>layer_2_expert_52_gpu13&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M12887.31,-1204.9C12884.53,-1204.57 12881.75,-1204.26 12879,-1203.95 12311.83,-1141.47 11628.52,-1129.32 11360.19,-1126.99"/>
<polygon fill="black" stroke="black" points="11360.07,-1123.49 11350.04,-1126.91 11360.01,-1130.49 11360.07,-1123.49"/>
</g>
<!-- layer_2_expert_53_gpu13&#45;&gt;layer_2_expert_agg -->
<g id="edge198" class="edge">
<title>layer_2_expert_53_gpu13&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M13354.32,-1204.86C13351.53,-1204.54 13348.76,-1204.24 13346,-1203.95 12956.29,-1163.09 11742.78,-1136.27 11360.53,-1128.67"/>
<polygon fill="black" stroke="black" points="11360.35,-1125.17 11350.29,-1128.47 11360.22,-1132.17 11360.35,-1125.17"/>
</g>
<!-- layer_2_expert_54_gpu13&#45;&gt;layer_2_expert_agg -->
<g id="edge199" class="edge">
<title>layer_2_expert_54_gpu13&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M13821.32,-1204.83C13818.53,-1204.53 13815.76,-1204.23 13813,-1203.95 13327.39,-1154.68 11795.54,-1133.02 11360.34,-1127.77"/>
<polygon fill="black" stroke="black" points="11360.31,-1124.27 11350.27,-1127.65 11360.23,-1131.27 11360.31,-1124.27"/>
</g>
<!-- layer_2_expert_55_gpu13&#45;&gt;layer_2_expert_agg -->
<g id="edge200" class="edge">
<title>layer_2_expert_55_gpu13&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M14288.32,-1204.82C14285.53,-1204.52 14282.76,-1204.23 14280,-1203.95 13965.89,-1172.62 13885.56,-1193.14 13570,-1184.95 12721.99,-1162.94 11700.04,-1137.68 11360.17,-1129.31"/>
<polygon fill="black" stroke="black" points="11360.15,-1125.81 11350.07,-1129.06 11359.98,-1132.81 11360.15,-1125.81"/>
</g>
<!-- layer_2_expert_56_gpu14&#45;&gt;layer_2_expert_agg -->
<g id="edge201" class="edge">
<title>layer_2_expert_56_gpu14&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M14755.32,-1204.8C14752.53,-1204.5 14749.76,-1204.22 14747,-1203.95 14067.92,-1137.8 11889.2,-1128.07 11360.43,-1126.68"/>
<polygon fill="black" stroke="black" points="11360.13,-1123.18 11350.13,-1126.65 11360.12,-1130.18 11360.13,-1123.18"/>
</g>
<!-- layer_2_expert_57_gpu14&#45;&gt;layer_2_expert_agg -->
<g id="edge202" class="edge">
<title>layer_2_expert_57_gpu14&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M15222.32,-1204.82C15219.53,-1204.52 15216.76,-1204.23 15214,-1203.95 14897.23,-1172.39 14816.26,-1192.04 14498,-1184.95 13270.17,-1157.63 11781.52,-1134.53 11360.11,-1128.18"/>
<polygon fill="black" stroke="black" points="11360.1,-1124.68 11350.05,-1128.03 11359.99,-1131.68 11360.1,-1124.68"/>
</g>
<!-- layer_2_expert_58_gpu14&#45;&gt;layer_2_expert_agg -->
<g id="edge203" class="edge">
<title>layer_2_expert_58_gpu14&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M15689.32,-1204.79C15686.53,-1204.5 15683.76,-1204.22 15681,-1203.95 15254.88,-1162.96 15146.01,-1192.78 14718,-1184.95 13399.65,-1160.85 11799.82,-1135.26 11360.41,-1128.29"/>
<polygon fill="black" stroke="black" points="11360.3,-1124.79 11350.25,-1128.13 11360.19,-1131.79 11360.3,-1124.79"/>
</g>
<!-- layer_2_expert_59_gpu14&#45;&gt;layer_2_expert_agg -->
<g id="edge204" class="edge">
<title>layer_2_expert_59_gpu14&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M16156.32,-1204.78C16153.53,-1204.49 16150.76,-1204.22 16148,-1203.95 15672.74,-1158.72 15551.34,-1192.82 15074,-1184.95 13608.28,-1160.79 11826.98,-1134.87 11360.35,-1128.13"/>
<polygon fill="black" stroke="black" points="11360.29,-1124.63 11350.24,-1127.98 11360.18,-1131.63 11360.29,-1124.63"/>
</g>
<!-- layer_2_expert_60_gpu15&#45;&gt;layer_2_expert_agg -->
<g id="edge205" class="edge">
<title>layer_2_expert_60_gpu15&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M16623.32,-1204.78C16620.53,-1204.49 16617.76,-1204.21 16615,-1203.95 16117.6,-1156.81 15990.57,-1192.62 15491,-1184.95 13852.09,-1159.81 11857.34,-1134.23 11360.32,-1127.92"/>
<polygon fill="black" stroke="black" points="11360.32,-1124.42 11350.27,-1127.79 11360.23,-1131.42 11360.32,-1124.42"/>
</g>
<!-- layer_2_expert_61_gpu15&#45;&gt;layer_2_expert_agg -->
<g id="edge206" class="edge">
<title>layer_2_expert_61_gpu15&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M17090.32,-1204.78C17087.53,-1204.49 17084.76,-1204.21 17082,-1203.95 16576.19,-1156.08 16447.02,-1192.34 15939,-1184.95 14113.61,-1158.41 11888.91,-1133.54 11360.5,-1127.73"/>
<polygon fill="black" stroke="black" points="11360.24,-1124.22 11350.2,-1127.61 11360.16,-1131.22 11360.24,-1124.22"/>
</g>
<!-- layer_2_expert_62_gpu15&#45;&gt;layer_2_expert_agg -->
<g id="edge207" class="edge">
<title>layer_2_expert_62_gpu15&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M17557.32,-1204.78C17554.53,-1204.49 17551.76,-1204.21 17549,-1203.95 17038.32,-1155.66 16907.91,-1192.09 16395,-1184.95 14378.57,-1156.9 11917.99,-1132.88 11360.13,-1127.55"/>
<polygon fill="black" stroke="black" points="11360.1,-1124.05 11350.07,-1127.46 11360.03,-1131.05 11360.1,-1124.05"/>
</g>
<!-- layer_2_expert_63_gpu15&#45;&gt;layer_2_expert_agg -->
<g id="edge208" class="edge">
<title>layer_2_expert_63_gpu15&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M18024.32,-1204.78C18021.53,-1204.49 18018.76,-1204.21 18016,-1203.95 17502.22,-1155.4 17371.02,-1191.87 16855,-1184.95 14645.86,-1155.36 11947.3,-1132.29 11360.21,-1127.41"/>
<polygon fill="black" stroke="black" points="11360.08,-1123.91 11350.05,-1127.32 11360.02,-1130.91 11360.08,-1123.91"/>
</g>
<!-- layer_3_residual_mha -->
<g id="node115" class="node">
<title>layer_3_residual_mha</title>
<polygon fill="lightgreen" stroke="black" points="11433.5,-800.95 11054.5,-800.95 11054.5,-732.95 11433.5,-732.95 11433.5,-800.95"/>
<text text-anchor="middle" x="11244" y="-785.75" font-family="Times,serif" font-size="14.00">Add &amp; LayerNorm</text>
<text text-anchor="middle" x="11244" y="-770.75" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="11244" y="-755.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="11244" y="-740.75" font-family="Times,serif" font-size="14.00">Add: [1024, hidden_size/8] + [1024, hidden_size/8]</text>
</g>
<!-- layer_3_mha&#45;&gt;layer_3_residual_mha -->
<g id="edge210" class="edge">
<title>layer_3_mha&#45;&gt;layer_3_residual_mha</title>
<path fill="none" stroke="black" d="M11244,-837.93C11244,-829.26 11244,-820.06 11244,-811.28"/>
<polygon fill="black" stroke="black" points="11247.5,-811.22 11244,-801.22 11240.5,-811.22 11247.5,-811.22"/>
</g>
<!-- layer_3_gate -->
<g id="node116" class="node">
<title>layer_3_gate</title>
<polygon fill="lightyellow" stroke="black" points="7847,-695.95 7579,-695.95 7579,-612.95 7847,-612.95 7847,-695.95"/>
<text text-anchor="middle" x="7713" y="-680.75" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="7713" y="-665.75" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="7713" y="-650.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="7713" y="-635.75" font-family="Times,serif" font-size="14.00">[1024, hidden_size/8] &#45;&gt; [1024, 64]</text>
<text text-anchor="middle" x="7713" y="-620.75" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- layer_3_residual_mha&#45;&gt;layer_3_gate -->
<g id="edge211" class="edge">
<title>layer_3_residual_mha&#45;&gt;layer_3_gate</title>
<path fill="none" stroke="black" d="M11054.47,-760.02C10425.37,-740.33 8414.8,-677.42 7857.46,-659.97"/>
<polygon fill="black" stroke="black" points="7857.46,-656.47 7847.35,-659.66 7857.24,-663.47 7857.46,-656.47"/>
</g>
<!-- layer_3_expert_agg -->
<g id="node117" class="node">
<title>layer_3_expert_agg</title>
<polygon fill="lightpink" stroke="black" points="7819,-426.95 7607,-426.95 7607,-343.95 7819,-343.95 7819,-426.95"/>
<text text-anchor="middle" x="7713" y="-411.75" font-family="Times,serif" font-size="14.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="7713" y="-396.75" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="7713" y="-381.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="7713" y="-366.75" font-family="Times,serif" font-size="14.00">AllReduce across 8 GPUs</text>
<text text-anchor="middle" x="7713" y="-351.75" font-family="Times,serif" font-size="14.00">[1024, hidden_size/8]</text>
</g>
<!-- layer_3_residual_mha&#45;&gt;layer_3_expert_agg -->
<g id="edge212" class="edge">
<title>layer_3_residual_mha&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M11433.92,-758.5C11929.42,-738.46 13302.12,-679.2 14443,-594.95 14675.96,-577.75 15115.82,-630.47 14952,-463.95 14886.81,-397.69 8755.42,-387.71 7829.55,-386.58"/>
<polygon fill="black" stroke="black" points="7829.23,-383.08 7819.22,-386.57 7829.22,-390.08 7829.23,-383.08"/>
</g>
<!-- layer_3_expert_32_gpu8 -->
<g id="node119" class="node">
<title>layer_3_expert_32_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="465.5,-546.95 16.5,-546.95 16.5,-463.95 465.5,-463.95 465.5,-546.95"/>
<text text-anchor="middle" x="241" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 32</text>
<text text-anchor="middle" x="241" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="241" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="241" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="241" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_32_gpu8 -->
<g id="edge214" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_32_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7578.68,-653.59C6757.03,-654.26 2400.46,-654.85 1066,-594.95 805.64,-583.27 737.58,-580.33 475.9,-547.17"/>
<polygon fill="black" stroke="black" points="476.07,-543.66 465.7,-545.88 475.18,-550.61 476.07,-543.66"/>
<text text-anchor="middle" x="1113" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1113" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_3_expert_33_gpu8 -->
<g id="node120" class="node">
<title>layer_3_expert_33_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="932.5,-546.95 483.5,-546.95 483.5,-463.95 932.5,-463.95 932.5,-546.95"/>
<text text-anchor="middle" x="708" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 33</text>
<text text-anchor="middle" x="708" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="708" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="708" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="708" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_33_gpu8 -->
<g id="edge215" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_33_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7578.88,-652.16C7030.63,-646.79 4906.17,-625.08 3159,-594.95 2176.51,-578.01 1924.11,-641.88 942.8,-547.09"/>
<polygon fill="black" stroke="black" points="942.97,-543.59 932.68,-546.11 942.29,-550.56 942.97,-543.59"/>
<text text-anchor="middle" x="3206" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="3206" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_3_expert_34_gpu8 -->
<g id="node121" class="node">
<title>layer_3_expert_34_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="1399.5,-546.95 950.5,-546.95 950.5,-463.95 1399.5,-463.95 1399.5,-546.95"/>
<text text-anchor="middle" x="1175" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 34</text>
<text text-anchor="middle" x="1175" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1175" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="1175" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="1175" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_34_gpu8 -->
<g id="edge216" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_34_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7578.66,-650.96C7153.32,-643.03 5798.05,-617.62 4676,-594.95 4045.32,-582.21 3887.73,-574.69 3257,-564.95 3054.58,-561.83 1654.5,-565.5 1409.81,-546.99"/>
<polygon fill="black" stroke="black" points="1409.93,-543.49 1399.67,-546.15 1409.35,-550.47 1409.93,-543.49"/>
<text text-anchor="middle" x="4723" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="4723" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_3_expert_35_gpu8 -->
<g id="node122" class="node">
<title>layer_3_expert_35_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="1866.5,-546.95 1417.5,-546.95 1417.5,-463.95 1866.5,-463.95 1866.5,-546.95"/>
<text text-anchor="middle" x="1642" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 35</text>
<text text-anchor="middle" x="1642" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="1642" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="1642" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="1642" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_35_gpu8 -->
<g id="edge217" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_35_gpu8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7578.78,-650.63C7233.05,-643.22 6283.64,-621.86 5493,-594.95 5173.35,-584.07 5093.74,-572.61 4774,-564.95 4455.12,-557.31 2239.72,-575.28 1876.86,-547.02"/>
<polygon fill="black" stroke="black" points="1876.93,-543.51 1866.67,-546.17 1876.35,-550.49 1876.93,-543.51"/>
<text text-anchor="middle" x="5540" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="5540" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_3_expert_36_gpu9 -->
<g id="node123" class="node">
<title>layer_3_expert_36_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="2333.5,-546.95 1884.5,-546.95 1884.5,-463.95 2333.5,-463.95 2333.5,-546.95"/>
<text text-anchor="middle" x="2109" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 36</text>
<text text-anchor="middle" x="2109" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="2109" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="2109" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="2109" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_36_gpu9 -->
<g id="edge218" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_36_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7578.75,-651.16C7285.04,-645.66 6563.46,-629.53 5960,-594.95 5795.73,-585.54 5755.39,-572.08 5591,-564.95 5233.5,-549.45 2745.87,-578.46 2343.87,-547.02"/>
<polygon fill="black" stroke="black" points="2343.93,-543.51 2333.67,-546.17 2343.35,-550.49 2343.93,-543.51"/>
<text text-anchor="middle" x="6007" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="6007" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_3_expert_37_gpu9 -->
<g id="node124" class="node">
<title>layer_3_expert_37_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="2800.5,-546.95 2351.5,-546.95 2351.5,-463.95 2800.5,-463.95 2800.5,-546.95"/>
<text text-anchor="middle" x="2576" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 37</text>
<text text-anchor="middle" x="2576" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="2576" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="2576" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="2576" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_37_gpu9 -->
<g id="edge219" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_37_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7578.95,-653.16C7321.27,-651.47 6739.17,-642.22 6252,-594.95 6165.16,-586.53 6144.97,-571.88 6058,-564.95 5701.3,-536.54 3212.88,-578.23 2810.87,-547.02"/>
<polygon fill="black" stroke="black" points="2810.93,-543.51 2800.67,-546.17 2810.35,-550.49 2810.93,-543.51"/>
<text text-anchor="middle" x="6299" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="6299" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_3_expert_38_gpu9 -->
<g id="node125" class="node">
<title>layer_3_expert_38_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="3267.5,-546.95 2818.5,-546.95 2818.5,-463.95 3267.5,-463.95 3267.5,-546.95"/>
<text text-anchor="middle" x="3043" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 38</text>
<text text-anchor="middle" x="3043" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="3043" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="3043" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="3043" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_38_gpu9 -->
<g id="edge220" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_38_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7578.91,-651.1C7300.67,-645.57 6668.8,-629.55 6456,-594.95 6407.67,-587.1 6398.48,-571.83 6350,-564.95 6183.55,-541.36 3530.94,-561.48 3277.89,-546.89"/>
<polygon fill="black" stroke="black" points="3277.89,-543.38 3267.67,-546.17 3277.4,-550.37 3277.89,-543.38"/>
<text text-anchor="middle" x="6503" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="6503" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_3_expert_39_gpu9 -->
<g id="node126" class="node">
<title>layer_3_expert_39_gpu9</title>
<polygon fill="lightcoral" stroke="black" points="3734.5,-546.95 3285.5,-546.95 3285.5,-463.95 3734.5,-463.95 3734.5,-546.95"/>
<text text-anchor="middle" x="3510" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 39</text>
<text text-anchor="middle" x="3510" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="3510" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="3510" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="3510" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_39_gpu9 -->
<g id="edge221" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_39_gpu9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7578.92,-652.8C7327.65,-650.5 6795.21,-640.24 6617,-594.95 6586.94,-587.31 6584.23,-571.88 6554,-564.95 6404.31,-530.63 3981.02,-559.87 3744.75,-546.86"/>
<polygon fill="black" stroke="black" points="3744.89,-543.36 3734.67,-546.17 3744.41,-550.35 3744.89,-543.36"/>
<text text-anchor="middle" x="6664" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="6664" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_3_expert_40_gpu10 -->
<g id="node127" class="node">
<title>layer_3_expert_40_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="4201.5,-546.95 3752.5,-546.95 3752.5,-463.95 4201.5,-463.95 4201.5,-546.95"/>
<text text-anchor="middle" x="3977" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 40</text>
<text text-anchor="middle" x="3977" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="3977" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="3977" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="3977" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_40_gpu10 -->
<g id="edge222" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_40_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7579,-649.45C7333.85,-641.5 6831.3,-622.13 6756,-594.95 6734.76,-587.29 6736.44,-572.04 6715,-564.95 6650.58,-543.65 4395.9,-552.7 4211.67,-546.66"/>
<polygon fill="black" stroke="black" points="4211.83,-543.16 4201.67,-546.16 4211.49,-550.15 4211.83,-543.16"/>
<text text-anchor="middle" x="6803" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="6803" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_3_expert_41_gpu10 -->
<g id="node128" class="node">
<title>layer_3_expert_41_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="4668.5,-546.95 4219.5,-546.95 4219.5,-463.95 4668.5,-463.95 4668.5,-546.95"/>
<text text-anchor="middle" x="4444" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 41</text>
<text text-anchor="middle" x="4444" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="4444" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4444" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="4444" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_41_gpu10 -->
<g id="edge223" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_41_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7578.6,-649.11C7359.98,-641.28 6945.41,-622.96 6884,-594.95 6866.84,-587.13 6871.39,-572.24 6854,-564.95 6799.75,-542.22 4848.44,-551.83 4678.68,-546.64"/>
<polygon fill="black" stroke="black" points="4678.83,-543.14 4668.67,-546.16 4678.5,-550.13 4678.83,-543.14"/>
<text text-anchor="middle" x="6931" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="6931" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_3_expert_42_gpu10 -->
<g id="node129" class="node">
<title>layer_3_expert_42_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="5135.5,-546.95 4686.5,-546.95 4686.5,-463.95 5135.5,-463.95 5135.5,-546.95"/>
<text text-anchor="middle" x="4911" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 42</text>
<text text-anchor="middle" x="4911" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="4911" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="4911" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="4911" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_42_gpu10 -->
<g id="edge224" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_42_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7578.78,-648.06C7387.79,-639.52 7055.16,-621.13 7006,-594.95 6990.93,-586.93 6997.35,-572.43 6982,-564.95 6937.52,-543.31 5302.02,-551.06 5146.05,-546.62"/>
<polygon fill="black" stroke="black" points="5145.82,-543.11 5135.67,-546.15 5145.51,-550.1 5145.82,-543.11"/>
<text text-anchor="middle" x="7053" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="7053" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_3_expert_43_gpu10 -->
<g id="node130" class="node">
<title>layer_3_expert_43_gpu10</title>
<polygon fill="lightcoral" stroke="black" points="5602.5,-546.95 5153.5,-546.95 5153.5,-463.95 5602.5,-463.95 5602.5,-546.95"/>
<text text-anchor="middle" x="5378" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 43</text>
<text text-anchor="middle" x="5378" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5378" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5378" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="5378" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_43_gpu10 -->
<g id="edge225" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_43_gpu10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7578.95,-653.23C7429.22,-650.74 7198.11,-639.47 7124,-594.95 7110.26,-586.7 7118.08,-572.6 7104,-564.95 7068.83,-545.86 5750.11,-550.4 5612.85,-546.6"/>
<polygon fill="black" stroke="black" points="5612.82,-543.09 5602.67,-546.15 5612.51,-550.08 5612.82,-543.09"/>
<text text-anchor="middle" x="7171" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="7171" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_3_expert_44_gpu11 -->
<g id="node131" class="node">
<title>layer_3_expert_44_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="6069.5,-546.95 5620.5,-546.95 5620.5,-463.95 6069.5,-463.95 6069.5,-546.95"/>
<text text-anchor="middle" x="5845" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 44</text>
<text text-anchor="middle" x="5845" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="5845" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="5845" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="5845" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_44_gpu11 -->
<g id="edge226" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_44_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7578.86,-649.12C7459.88,-643.08 7296.73,-628.75 7242,-594.95 7228.37,-586.53 7236.07,-572.63 7222,-564.95 7195.24,-550.36 6196.82,-549.94 6079.72,-546.58"/>
<polygon fill="black" stroke="black" points="6079.82,-543.08 6069.68,-546.13 6079.51,-550.07 6079.82,-543.08"/>
<text text-anchor="middle" x="7289" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="7289" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_3_expert_45_gpu11 -->
<g id="node132" class="node">
<title>layer_3_expert_45_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="6536.5,-546.95 6087.5,-546.95 6087.5,-463.95 6536.5,-463.95 6536.5,-546.95"/>
<text text-anchor="middle" x="6312" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 45</text>
<text text-anchor="middle" x="6312" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="6312" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="6312" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="6312" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_45_gpu11 -->
<g id="edge227" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_45_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7578.62,-642.65C7494.18,-633.72 7394.7,-618.6 7359,-594.95 7345.84,-586.24 7353.74,-572.72 7340,-564.95 7303.19,-544.15 6648.96,-550.61 6546.97,-546.7"/>
<polygon fill="black" stroke="black" points="6546.86,-543.19 6536.68,-546.1 6546.46,-550.17 6546.86,-543.19"/>
<text text-anchor="middle" x="7406" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="7406" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_3_expert_46_gpu11 -->
<g id="node133" class="node">
<title>layer_3_expert_46_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="7003.5,-546.95 6554.5,-546.95 6554.5,-463.95 7003.5,-463.95 7003.5,-546.95"/>
<text text-anchor="middle" x="6779" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 46</text>
<text text-anchor="middle" x="6779" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="6779" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="6779" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="6779" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_46_gpu11 -->
<g id="edge228" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_46_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7578.94,-638.88C7543.09,-630.24 7506.01,-616.56 7476,-594.95 7463.19,-585.73 7470.67,-572.84 7457,-564.95 7416.15,-541.38 7093.61,-551.16 7013.66,-546.79"/>
<polygon fill="black" stroke="black" points="7013.92,-543.3 7003.69,-546.03 7013.39,-550.28 7013.92,-543.3"/>
<text text-anchor="middle" x="7523" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="7523" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_3_expert_47_gpu11 -->
<g id="node134" class="node">
<title>layer_3_expert_47_gpu11</title>
<polygon fill="lightcoral" stroke="black" points="7470.5,-546.95 7021.5,-546.95 7021.5,-463.95 7470.5,-463.95 7470.5,-546.95"/>
<text text-anchor="middle" x="7246" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 47</text>
<text text-anchor="middle" x="7246" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="7246" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7246" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="7246" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_47_gpu11 -->
<g id="edge229" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_47_gpu11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7643.17,-612.86C7633.62,-606.99 7624,-600.92 7615,-594.95 7596.17,-582.49 7594.76,-573.83 7574,-564.95 7571.08,-563.7 7531.55,-556.43 7480.87,-547.4"/>
<polygon fill="black" stroke="black" points="7481.4,-543.94 7470.94,-545.64 7480.18,-550.83 7481.4,-543.94"/>
<text text-anchor="middle" x="7662" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="7662" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_3_expert_48_gpu12 -->
<g id="node135" class="node">
<title>layer_3_expert_48_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="7937.5,-546.95 7488.5,-546.95 7488.5,-463.95 7937.5,-463.95 7937.5,-546.95"/>
<text text-anchor="middle" x="7713" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 48</text>
<text text-anchor="middle" x="7713" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="7713" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="7713" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="7713" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_48_gpu12 -->
<g id="edge230" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_48_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7713,-612.9C7713,-595.7 7713,-575.46 7713,-557.28"/>
<polygon fill="black" stroke="black" points="7716.5,-557.13 7713,-547.13 7709.5,-557.13 7716.5,-557.13"/>
<text text-anchor="middle" x="7760" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="7760" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_3_expert_49_gpu12 -->
<g id="node136" class="node">
<title>layer_3_expert_49_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="8404.5,-546.95 7955.5,-546.95 7955.5,-463.95 8404.5,-463.95 8404.5,-546.95"/>
<text text-anchor="middle" x="8180" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 49</text>
<text text-anchor="middle" x="8180" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8180" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8180" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="8180" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_49_gpu12 -->
<g id="edge231" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_49_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7841.85,-612.9C7903.86,-593.37 7978.3,-569.94 8041.52,-550.04"/>
<polygon fill="black" stroke="black" points="8042.68,-553.35 8051.17,-547.01 8040.58,-546.67 8042.68,-553.35"/>
<text text-anchor="middle" x="8036" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="8036" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_3_expert_50_gpu12 -->
<g id="node137" class="node">
<title>layer_3_expert_50_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="8871.5,-546.95 8422.5,-546.95 8422.5,-463.95 8871.5,-463.95 8871.5,-546.95"/>
<text text-anchor="middle" x="8647" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 50</text>
<text text-anchor="middle" x="8647" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8647" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="8647" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="8647" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_50_gpu12 -->
<g id="edge232" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_50_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7847.32,-633.85C7986.06,-613.41 8209.11,-580.01 8412.25,-547.07"/>
<polygon fill="black" stroke="black" points="8412.91,-550.51 8422.22,-545.45 8411.79,-543.6 8412.91,-550.51"/>
<text text-anchor="middle" x="8346" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="8346" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_3_expert_51_gpu12 -->
<g id="node138" class="node">
<title>layer_3_expert_51_gpu12</title>
<polygon fill="lightcoral" stroke="black" points="9338.5,-546.95 8889.5,-546.95 8889.5,-463.95 9338.5,-463.95 9338.5,-546.95"/>
<text text-anchor="middle" x="9114" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 51</text>
<text text-anchor="middle" x="9114" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="9114" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9114" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="9114" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_51_gpu12 -->
<g id="edge233" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_51_gpu12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7847.33,-645.07C8062.98,-630.75 8499.8,-598.2 8879.17,-547.04"/>
<polygon fill="black" stroke="black" points="8879.81,-550.48 8889.25,-545.67 8878.87,-543.55 8879.81,-550.48"/>
<text text-anchor="middle" x="8769" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="8769" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_3_expert_52_gpu13 -->
<g id="node139" class="node">
<title>layer_3_expert_52_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="9805.5,-546.95 9356.5,-546.95 9356.5,-463.95 9805.5,-463.95 9805.5,-546.95"/>
<text text-anchor="middle" x="9581" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 52</text>
<text text-anchor="middle" x="9581" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="9581" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="9581" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="9581" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_52_gpu13 -->
<g id="edge234" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_52_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7847.02,-650.7C8125.14,-643.69 8785.06,-620.27 9345.93,-547.06"/>
<polygon fill="black" stroke="black" points="9346.8,-550.48 9356.26,-545.71 9345.89,-543.54 9346.8,-550.48"/>
<text text-anchor="middle" x="9218" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="9218" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_3_expert_53_gpu13 -->
<g id="node140" class="node">
<title>layer_3_expert_53_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="10272.5,-546.95 9823.5,-546.95 9823.5,-463.95 10272.5,-463.95 10272.5,-546.95"/>
<text text-anchor="middle" x="10048" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 53</text>
<text text-anchor="middle" x="10048" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="10048" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10048" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="10048" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_53_gpu13 -->
<g id="edge235" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_53_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7847.1,-650.68C8116.67,-644.61 8743.4,-627.96 9269,-594.95 9508.36,-579.92 9571.17,-578.42 9813.09,-547.04"/>
<polygon fill="black" stroke="black" points="9813.79,-550.48 9823.26,-545.72 9812.89,-543.54 9813.79,-550.48"/>
<text text-anchor="middle" x="9714" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="9714" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_3_expert_54_gpu13 -->
<g id="node141" class="node">
<title>layer_3_expert_54_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="10739.5,-546.95 10290.5,-546.95 10290.5,-463.95 10739.5,-463.95 10739.5,-546.95"/>
<text text-anchor="middle" x="10515" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 54</text>
<text text-anchor="middle" x="10515" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="10515" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10515" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="10515" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_54_gpu13 -->
<g id="edge236" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_54_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7847.28,-652.61C8175.15,-649.9 9042.63,-638.8 9765,-594.95 9991.64,-581.2 10051.01,-577.39 10280.27,-547.03"/>
<polygon fill="black" stroke="black" points="10280.8,-550.49 10290.26,-545.7 10279.88,-543.55 10280.8,-550.49"/>
<text text-anchor="middle" x="10179" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="10179" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_3_expert_55_gpu13 -->
<g id="node142" class="node">
<title>layer_3_expert_55_gpu13</title>
<polygon fill="lightcoral" stroke="black" points="11206.5,-546.95 10757.5,-546.95 10757.5,-463.95 11206.5,-463.95 11206.5,-546.95"/>
<text text-anchor="middle" x="10982" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 55</text>
<text text-anchor="middle" x="10982" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="10982" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="10982" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="10982" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_55_gpu13 -->
<g id="edge237" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_55_gpu13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7847.17,-653.59C8223.41,-653.27 9320.44,-647.52 10230,-594.95 10457.99,-581.78 10517.69,-577.6 10747.29,-547.16"/>
<polygon fill="black" stroke="black" points="10747.84,-550.62 10757.29,-545.83 10746.92,-543.68 10747.84,-550.62"/>
<text text-anchor="middle" x="10646" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="10646" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_3_expert_56_gpu14 -->
<g id="node143" class="node">
<title>layer_3_expert_56_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="11673.5,-546.95 11224.5,-546.95 11224.5,-463.95 11673.5,-463.95 11673.5,-546.95"/>
<text text-anchor="middle" x="11449" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 56</text>
<text text-anchor="middle" x="11449" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="11449" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11449" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="11449" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_56_gpu14 -->
<g id="edge238" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_56_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7847.34,-652.12C8351.51,-646.91 10130.83,-626.64 10697,-594.95 10925.01,-582.19 10984.69,-577.61 11214.29,-547.16"/>
<polygon fill="black" stroke="black" points="11214.84,-550.62 11224.29,-545.83 11213.92,-543.68 11214.84,-550.62"/>
<text text-anchor="middle" x="11112" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="11112" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_3_expert_57_gpu14 -->
<g id="node144" class="node">
<title>layer_3_expert_57_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="12140.5,-546.95 11691.5,-546.95 11691.5,-463.95 12140.5,-463.95 12140.5,-546.95"/>
<text text-anchor="middle" x="11916" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 57</text>
<text text-anchor="middle" x="11916" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="11916" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="11916" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="11916" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_57_gpu14 -->
<g id="edge239" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_57_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7847.06,-652.53C8399.3,-648.51 10500.17,-631.11 11163,-594.95 11391.47,-582.49 11451.25,-577.66 11681.27,-547.16"/>
<polygon fill="black" stroke="black" points="11681.84,-550.62 11691.29,-545.83 11680.92,-543.68 11681.84,-550.62"/>
<text text-anchor="middle" x="11589" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="11589" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_3_expert_58_gpu14 -->
<g id="node145" class="node">
<title>layer_3_expert_58_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="12607.5,-546.95 12158.5,-546.95 12158.5,-463.95 12607.5,-463.95 12607.5,-546.95"/>
<text text-anchor="middle" x="12383" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 58</text>
<text text-anchor="middle" x="12383" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12383" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12383" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="12383" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_58_gpu14 -->
<g id="edge240" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_58_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7847.25,-652.88C8446.15,-650.1 10877.99,-636.42 11640,-594.95 11864,-582.76 11922.63,-577.3 12148.12,-547.18"/>
<polygon fill="black" stroke="black" points="12148.84,-550.62 12158.29,-545.83 12147.91,-543.68 12148.84,-550.62"/>
<text text-anchor="middle" x="12049" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="12049" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_3_expert_59_gpu14 -->
<g id="node146" class="node">
<title>layer_3_expert_59_gpu14</title>
<polygon fill="lightcoral" stroke="black" points="13074.5,-546.95 12625.5,-546.95 12625.5,-463.95 13074.5,-463.95 13074.5,-546.95"/>
<text text-anchor="middle" x="12850" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 59</text>
<text text-anchor="middle" x="12850" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="12850" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="12850" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="12850" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_59_gpu14 -->
<g id="edge241" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_59_gpu14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7847.12,-653.1C8487.9,-651.19 11241.79,-640.44 12100,-594.95 12327.18,-582.91 12386.58,-577.56 12615.33,-547.16"/>
<polygon fill="black" stroke="black" points="12615.84,-550.62 12625.29,-545.83 12614.92,-543.68 12615.84,-550.62"/>
<text text-anchor="middle" x="12524" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="12524" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_3_expert_60_gpu15 -->
<g id="node147" class="node">
<title>layer_3_expert_60_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="13541.5,-546.95 13092.5,-546.95 13092.5,-463.95 13541.5,-463.95 13541.5,-546.95"/>
<text text-anchor="middle" x="13317" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 60</text>
<text text-anchor="middle" x="13317" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="13317" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13317" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="13317" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_60_gpu15 -->
<g id="edge242" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_60_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7847.23,-653.33C8529.44,-652.47 11617.31,-645.79 12575,-594.95 12798.58,-583.09 12857.08,-577.27 13082.14,-547.18"/>
<polygon fill="black" stroke="black" points="13082.84,-550.62 13092.29,-545.82 13081.91,-543.68 13082.84,-550.62"/>
<text text-anchor="middle" x="12983" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="12983" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_3_expert_61_gpu15 -->
<g id="node148" class="node">
<title>layer_3_expert_61_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="14008.5,-546.95 13559.5,-546.95 13559.5,-463.95 14008.5,-463.95 14008.5,-546.95"/>
<text text-anchor="middle" x="13784" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 61</text>
<text text-anchor="middle" x="13784" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="13784" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="13784" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="13784" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_61_gpu15 -->
<g id="edge243" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_61_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7847.23,-653.46C8567.39,-653.3 11979.78,-649.6 13034,-594.95 13261.19,-583.18 13320.58,-577.56 13549.33,-547.16"/>
<polygon fill="black" stroke="black" points="13549.84,-550.62 13559.29,-545.83 13548.92,-543.68 13549.84,-550.62"/>
<text text-anchor="middle" x="13458" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="13458" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_3_expert_62_gpu15 -->
<g id="node149" class="node">
<title>layer_3_expert_62_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="14475.5,-546.95 14026.5,-546.95 14026.5,-463.95 14475.5,-463.95 14475.5,-546.95"/>
<text text-anchor="middle" x="14251" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 62</text>
<text text-anchor="middle" x="14251" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="14251" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14251" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="14251" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_62_gpu15 -->
<g id="edge244" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_62_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7847.22,-653.63C8604.97,-654.41 12354.73,-655.1 13509,-594.95 13732.59,-583.3 13791.08,-577.28 14016.14,-547.18"/>
<polygon fill="black" stroke="black" points="14016.84,-550.62 14026.29,-545.82 14015.91,-543.68 14016.84,-550.62"/>
<text text-anchor="middle" x="13917" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="13917" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_3_expert_63_gpu15 -->
<g id="node150" class="node">
<title>layer_3_expert_63_gpu15</title>
<polygon fill="lightcoral" stroke="black" points="14942.5,-546.95 14493.5,-546.95 14493.5,-463.95 14942.5,-463.95 14942.5,-546.95"/>
<text text-anchor="middle" x="14718" y="-531.75" font-family="Times,serif" font-size="14.00">Expert 63</text>
<text text-anchor="middle" x="14718" y="-516.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="14718" y="-501.75" font-family="Times,serif" font-size="14.00">FFN Layer</text>
<text text-anchor="middle" x="14718" y="-486.75" font-family="Times,serif" font-size="14.00">[local_tokens, hidden_size/8] &#45;&gt; [local_tokens, hidden_size/8]</text>
<text text-anchor="middle" x="14718" y="-471.75" font-family="Times,serif" font-size="14.00">Hidden: 32768/8=4096</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_63_gpu15 -->
<g id="edge245" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_63_gpu15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7847.03,-653.72C8639.2,-655.07 12716.67,-658.78 13968,-594.95 14195.2,-583.36 14254.58,-577.57 14483.33,-547.16"/>
<polygon fill="black" stroke="black" points="14483.84,-550.62 14493.29,-545.83 14482.92,-543.68 14483.84,-550.62"/>
<text text-anchor="middle" x="14392" y="-583.75" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="14392" y="-568.75" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_3_residual_final -->
<g id="node118" class="node">
<title>layer_3_residual_final</title>
<polygon fill="lightgreen" stroke="black" points="7902.5,-306.95 7523.5,-306.95 7523.5,-238.95 7902.5,-238.95 7902.5,-306.95"/>
<text text-anchor="middle" x="7713" y="-291.75" font-family="Times,serif" font-size="14.00">Add &amp; LayerNorm</text>
<text text-anchor="middle" x="7713" y="-276.75" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="7713" y="-261.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="7713" y="-246.75" font-family="Times,serif" font-size="14.00">Add: [1024, hidden_size/8] + [1024, hidden_size/8]</text>
</g>
<!-- layer_3_expert_agg&#45;&gt;layer_3_residual_final -->
<g id="edge213" class="edge">
<title>layer_3_expert_agg&#45;&gt;layer_3_residual_final</title>
<path fill="none" stroke="black" d="M7713,-343.93C7713,-335.26 7713,-326.06 7713,-317.28"/>
<polygon fill="black" stroke="black" points="7716.5,-317.22 7713,-307.22 7709.5,-317.22 7716.5,-317.22"/>
</g>
<!-- final_norm -->
<g id="node151" class="node">
<title>final_norm</title>
<polygon fill="lightgray" stroke="black" points="7782,-180.95 7644,-180.95 7644,-127.95 7782,-127.95 7782,-180.95"/>
<text text-anchor="middle" x="7713" y="-165.75" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="7713" y="-150.75" font-family="Times,serif" font-size="14.00">TP=8</text>
<text text-anchor="middle" x="7713" y="-135.75" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<!-- layer_3_residual_final&#45;&gt;final_norm -->
<g id="edge278" class="edge">
<title>layer_3_residual_final&#45;&gt;final_norm</title>
<path fill="none" stroke="black" d="M7713,-238.88C7713,-224.01 7713,-206.44 7713,-191.26"/>
<polygon fill="black" stroke="black" points="7716.5,-191.2 7713,-181.2 7709.5,-191.2 7716.5,-191.2"/>
</g>
<!-- layer_3_expert_32_gpu8&#45;&gt;layer_3_expert_agg -->
<g id="edge246" class="edge">
<title>layer_3_expert_32_gpu8&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M465.68,-464.82C468.47,-464.52 471.24,-464.23 474,-463.95 796.08,-431.93 878.38,-450.63 1202,-444.95 3789.38,-399.57 6955.77,-388.57 7596.7,-386.76"/>
<polygon fill="black" stroke="black" points="7596.87,-390.25 7606.86,-386.73 7596.85,-383.25 7596.87,-390.25"/>
</g>
<!-- layer_3_expert_33_gpu8&#45;&gt;layer_3_expert_agg -->
<g id="edge247" class="edge">
<title>layer_3_expert_33_gpu8&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M932.68,-464.82C935.47,-464.52 938.24,-464.23 941,-463.95 1263.52,-431.89 1345.94,-450.74 1670,-444.95 4060.06,-402.24 6982.44,-389.22 7596.47,-386.87"/>
<polygon fill="black" stroke="black" points="7596.67,-390.37 7606.65,-386.83 7596.64,-383.37 7596.67,-390.37"/>
</g>
<!-- layer_3_expert_34_gpu8&#45;&gt;layer_3_expert_agg -->
<g id="edge248" class="edge">
<title>layer_3_expert_34_gpu8&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M1399.68,-464.82C1402.47,-464.52 1405.24,-464.23 1408,-463.95 1730.96,-431.86 1813.5,-450.88 2138,-444.95 4331.6,-404.9 7011.24,-389.91 7596.57,-387"/>
<polygon fill="black" stroke="black" points="7596.72,-390.5 7606.7,-386.95 7596.68,-383.5 7596.72,-390.5"/>
</g>
<!-- layer_3_expert_35_gpu8&#45;&gt;layer_3_expert_agg -->
<g id="edge249" class="edge">
<title>layer_3_expert_35_gpu8&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M1866.68,-464.82C1869.47,-464.51 1872.24,-464.23 1875,-463.95 2199.29,-431.74 2282.17,-451.04 2608,-444.95 4605.17,-407.63 7042.31,-390.68 7596.99,-387.16"/>
<polygon fill="black" stroke="black" points="7597.02,-390.66 7606.99,-387.1 7596.97,-383.66 7597.02,-390.66"/>
</g>
<!-- layer_3_expert_36_gpu9&#45;&gt;layer_3_expert_agg -->
<g id="edge250" class="edge">
<title>layer_3_expert_36_gpu9&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M2333.68,-464.81C2336.47,-464.51 2339.24,-464.23 2342,-463.95 2670.72,-431.36 2754.73,-451.26 3085,-444.95 4882.21,-410.62 7072.4,-391.62 7596.42,-387.37"/>
<polygon fill="black" stroke="black" points="7596.66,-390.87 7606.63,-387.29 7596.6,-383.87 7596.66,-390.87"/>
</g>
<!-- layer_3_expert_37_gpu9&#45;&gt;layer_3_expert_agg -->
<g id="edge251" class="edge">
<title>layer_3_expert_37_gpu9&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M2800.68,-464.82C2803.47,-464.51 2806.24,-464.23 2809,-463.95 3133.73,-431.7 3216.73,-451.46 3543,-444.95 5149.43,-412.89 7104.31,-392.46 7596.36,-387.58"/>
<polygon fill="black" stroke="black" points="7596.7,-391.08 7606.67,-387.48 7596.63,-384.08 7596.7,-391.08"/>
</g>
<!-- layer_3_expert_38_gpu9&#45;&gt;layer_3_expert_agg -->
<g id="edge252" class="edge">
<title>layer_3_expert_38_gpu9&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M3267.68,-464.81C3270.47,-464.51 3273.24,-464.23 3276,-463.95 3606.05,-431.24 3690.41,-451.8 4022,-444.95 5430.11,-415.86 7140.64,-393.61 7596.7,-387.89"/>
<polygon fill="black" stroke="black" points="7596.96,-391.39 7606.92,-387.76 7596.88,-384.39 7596.96,-391.39"/>
</g>
<!-- layer_3_expert_39_gpu9&#45;&gt;layer_3_expert_agg -->
<g id="edge253" class="edge">
<title>layer_3_expert_39_gpu9&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M3734.68,-464.81C3737.47,-464.51 3740.24,-464.23 3743,-463.95 4071.72,-431.36 4155.75,-452.17 4486,-444.95 5702.61,-418.37 7177.41,-394.79 7596.78,-388.25"/>
<polygon fill="black" stroke="black" points="7596.85,-391.75 7606.79,-388.09 7596.74,-384.75 7596.85,-391.75"/>
</g>
<!-- layer_3_expert_40_gpu10&#45;&gt;layer_3_expert_agg -->
<g id="edge254" class="edge">
<title>layer_3_expert_40_gpu10&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M4201.68,-464.81C4204.47,-464.51 4207.24,-464.23 4210,-463.95 4551.11,-430.29 4638.32,-452.84 4981,-444.95 5994.45,-421.62 7219.44,-396.48 7596.78,-388.81"/>
<polygon fill="black" stroke="black" points="7596.96,-392.3 7606.88,-388.6 7596.81,-385.31 7596.96,-392.3"/>
</g>
<!-- layer_3_expert_41_gpu10&#45;&gt;layer_3_expert_agg -->
<g id="edge255" class="edge">
<title>layer_3_expert_41_gpu10&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M4668.68,-464.82C4671.47,-464.52 4674.24,-464.23 4677,-463.95 4991.55,-432.58 5071.99,-453.15 5388,-444.95 6235.65,-422.96 7257.16,-397.69 7596.88,-389.31"/>
<polygon fill="black" stroke="black" points="7597.07,-392.81 7606.98,-389.06 7596.9,-385.81 7597.07,-392.81"/>
</g>
<!-- layer_3_expert_42_gpu10&#45;&gt;layer_3_expert_agg -->
<g id="edge256" class="edge">
<title>layer_3_expert_42_gpu10&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M5135.68,-464.83C5138.47,-464.53 5141.24,-464.23 5144,-463.95 5629.61,-414.68 7161.46,-393.02 7596.66,-387.77"/>
<polygon fill="black" stroke="black" points="7596.77,-391.27 7606.73,-387.65 7596.69,-384.27 7596.77,-391.27"/>
</g>
<!-- layer_3_expert_43_gpu10&#45;&gt;layer_3_expert_agg -->
<g id="edge257" class="edge">
<title>layer_3_expert_43_gpu10&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M5602.68,-464.86C5605.47,-464.54 5608.24,-464.24 5611,-463.95 6000.71,-423.09 7214.22,-396.27 7596.47,-388.67"/>
<polygon fill="black" stroke="black" points="7596.78,-392.17 7606.71,-388.47 7596.65,-385.17 7596.78,-392.17"/>
</g>
<!-- layer_3_expert_44_gpu11&#45;&gt;layer_3_expert_agg -->
<g id="edge258" class="edge">
<title>layer_3_expert_44_gpu11&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M6069.69,-464.9C6072.47,-464.57 6075.25,-464.26 6078,-463.95 6645.17,-401.47 7328.48,-389.32 7596.81,-386.99"/>
<polygon fill="black" stroke="black" points="7596.99,-390.49 7606.96,-386.91 7596.93,-383.49 7596.99,-390.49"/>
</g>
<!-- layer_3_expert_45_gpu11&#45;&gt;layer_3_expert_agg -->
<g id="edge259" class="edge">
<title>layer_3_expert_45_gpu11&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M6536.7,-464.97C6539.48,-464.62 6542.25,-464.28 6545,-463.95 6928.41,-418.04 7386.13,-397.59 7596.62,-390.1"/>
<polygon fill="black" stroke="black" points="7596.89,-393.59 7606.76,-389.74 7596.64,-386.59 7596.89,-393.59"/>
</g>
<!-- layer_3_expert_46_gpu11&#45;&gt;layer_3_expert_agg -->
<g id="edge260" class="edge">
<title>layer_3_expert_46_gpu11&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M7003.72,-465.14C7006.49,-464.74 7009.26,-464.34 7012,-463.95 7217.04,-434.83 7457.15,-410.36 7596.48,-397.11"/>
<polygon fill="black" stroke="black" points="7597.12,-400.56 7606.75,-396.13 7596.46,-393.59 7597.12,-400.56"/>
</g>
<!-- layer_3_expert_47_gpu11&#45;&gt;layer_3_expert_agg -->
<g id="edge261" class="edge">
<title>layer_3_expert_47_gpu11&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M7406.39,-463.93C7469.01,-448.1 7539.44,-430.31 7596.99,-415.77"/>
<polygon fill="black" stroke="black" points="7598.01,-419.12 7606.85,-413.28 7596.3,-412.33 7598.01,-419.12"/>
</g>
<!-- layer_3_expert_48_gpu12&#45;&gt;layer_3_expert_agg -->
<g id="edge262" class="edge">
<title>layer_3_expert_48_gpu12&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M7713,-463.84C7713,-455.32 7713,-446.22 7713,-437.37"/>
<polygon fill="black" stroke="black" points="7716.5,-437.14 7713,-427.14 7709.5,-437.14 7716.5,-437.14"/>
</g>
<!-- layer_3_expert_49_gpu12&#45;&gt;layer_3_expert_agg -->
<g id="edge263" class="edge">
<title>layer_3_expert_49_gpu12&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M8019.61,-463.93C7956.99,-448.1 7886.56,-430.31 7829.01,-415.77"/>
<polygon fill="black" stroke="black" points="7829.7,-412.33 7819.15,-413.28 7827.99,-419.12 7829.7,-412.33"/>
</g>
<!-- layer_3_expert_50_gpu12&#45;&gt;layer_3_expert_agg -->
<g id="edge264" class="edge">
<title>layer_3_expert_50_gpu12&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M8422.25,-465.28C8419.14,-464.83 8416.06,-464.39 8413,-463.95 8208.24,-434.93 7968.47,-410.42 7829.35,-397.14"/>
<polygon fill="black" stroke="black" points="7829.38,-393.63 7819.1,-396.16 7828.72,-400.6 7829.38,-393.63"/>
</g>
<!-- layer_3_expert_51_gpu12&#45;&gt;layer_3_expert_agg -->
<g id="edge265" class="edge">
<title>layer_3_expert_51_gpu12&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M8889.27,-465.09C8886.16,-464.7 8883.07,-464.32 8880,-463.95 8496.9,-418.21 8039.58,-397.67 7829.28,-390.13"/>
<polygon fill="black" stroke="black" points="7829.26,-386.63 7819.14,-389.77 7829.01,-393.62 7829.26,-386.63"/>
</g>
<!-- layer_3_expert_52_gpu13&#45;&gt;layer_3_expert_agg -->
<g id="edge266" class="edge">
<title>layer_3_expert_52_gpu13&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M9356.28,-465.01C9353.17,-464.64 9350.07,-464.29 9347,-463.95 8780.51,-401.74 8098.12,-389.44 7829.61,-387.03"/>
<polygon fill="black" stroke="black" points="7829.49,-383.53 7819.46,-386.94 7829.42,-390.53 7829.49,-383.53"/>
</g>
<!-- layer_3_expert_53_gpu13&#45;&gt;layer_3_expert_agg -->
<g id="edge267" class="edge">
<title>layer_3_expert_53_gpu13&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M9823.28,-464.96C9820.17,-464.61 9817.08,-464.27 9814,-463.95 9424.46,-423.25 8211.54,-396.33 7829.47,-388.68"/>
<polygon fill="black" stroke="black" points="7829.3,-385.18 7819.23,-388.48 7829.16,-392.18 7829.3,-385.18"/>
</g>
<!-- layer_3_expert_54_gpu13&#45;&gt;layer_3_expert_agg -->
<g id="edge268" class="edge">
<title>layer_3_expert_54_gpu13&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M10290.29,-464.93C10287.17,-464.59 10284.08,-464.26 10281,-463.95 9795.56,-414.87 8264.32,-393.08 7829.3,-387.78"/>
<polygon fill="black" stroke="black" points="7829.27,-384.28 7819.23,-387.66 7829.18,-391.28 7829.27,-384.28"/>
</g>
<!-- layer_3_expert_55_gpu13&#45;&gt;layer_3_expert_agg -->
<g id="edge269" class="edge">
<title>layer_3_expert_55_gpu13&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M10757.32,-464.82C10754.53,-464.52 10751.76,-464.23 10749,-463.95 10434.89,-432.62 10354.56,-453.14 10039,-444.95 9190.99,-422.94 8169.04,-397.68 7829.17,-389.31"/>
<polygon fill="black" stroke="black" points="7829.15,-385.81 7819.07,-389.06 7828.98,-392.81 7829.15,-385.81"/>
</g>
<!-- layer_3_expert_56_gpu14&#45;&gt;layer_3_expert_agg -->
<g id="edge270" class="edge">
<title>layer_3_expert_56_gpu14&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M11224.32,-464.8C11221.53,-464.5 11218.76,-464.22 11216,-463.95 10536.92,-397.8 8358.2,-388.07 7829.43,-386.68"/>
<polygon fill="black" stroke="black" points="7829.13,-383.18 7819.13,-386.65 7829.12,-390.18 7829.13,-383.18"/>
</g>
<!-- layer_3_expert_57_gpu14&#45;&gt;layer_3_expert_agg -->
<g id="edge271" class="edge">
<title>layer_3_expert_57_gpu14&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M11691.32,-464.82C11688.53,-464.52 11685.76,-464.23 11683,-463.95 11366.23,-432.39 11285.26,-452.04 10967,-444.95 9739.17,-417.63 8250.52,-394.53 7829.11,-388.18"/>
<polygon fill="black" stroke="black" points="7829.1,-384.68 7819.05,-388.03 7828.99,-391.68 7829.1,-384.68"/>
</g>
<!-- layer_3_expert_58_gpu14&#45;&gt;layer_3_expert_agg -->
<g id="edge272" class="edge">
<title>layer_3_expert_58_gpu14&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M12158.32,-464.79C12155.53,-464.5 12152.76,-464.22 12150,-463.95 11723.88,-422.96 11615.01,-452.78 11187,-444.95 9868.65,-420.85 8268.82,-395.26 7829.41,-388.29"/>
<polygon fill="black" stroke="black" points="7829.3,-384.79 7819.25,-388.13 7829.19,-391.79 7829.3,-384.79"/>
</g>
<!-- layer_3_expert_59_gpu14&#45;&gt;layer_3_expert_agg -->
<g id="edge273" class="edge">
<title>layer_3_expert_59_gpu14&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M12625.32,-464.78C12622.53,-464.49 12619.76,-464.22 12617,-463.95 12141.74,-418.72 12020.34,-452.82 11543,-444.95 10077.28,-420.79 8295.98,-394.87 7829.35,-388.13"/>
<polygon fill="black" stroke="black" points="7829.29,-384.63 7819.24,-387.98 7829.18,-391.63 7829.29,-384.63"/>
</g>
<!-- layer_3_expert_60_gpu15&#45;&gt;layer_3_expert_agg -->
<g id="edge274" class="edge">
<title>layer_3_expert_60_gpu15&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M13092.32,-464.78C13089.53,-464.49 13086.76,-464.21 13084,-463.95 12586.6,-416.81 12459.57,-452.62 11960,-444.95 10321.09,-419.81 8326.34,-394.23 7829.32,-387.92"/>
<polygon fill="black" stroke="black" points="7829.32,-384.42 7819.27,-387.79 7829.23,-391.42 7829.32,-384.42"/>
</g>
<!-- layer_3_expert_61_gpu15&#45;&gt;layer_3_expert_agg -->
<g id="edge275" class="edge">
<title>layer_3_expert_61_gpu15&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M13559.32,-464.78C13556.53,-464.49 13553.76,-464.21 13551,-463.95 13045.19,-416.08 12916.02,-452.34 12408,-444.95 10582.61,-418.41 8357.91,-393.54 7829.5,-387.73"/>
<polygon fill="black" stroke="black" points="7829.24,-384.22 7819.2,-387.61 7829.16,-391.22 7829.24,-384.22"/>
</g>
<!-- layer_3_expert_62_gpu15&#45;&gt;layer_3_expert_agg -->
<g id="edge276" class="edge">
<title>layer_3_expert_62_gpu15&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M14026.32,-464.78C14023.53,-464.49 14020.76,-464.21 14018,-463.95 13507.32,-415.66 13376.91,-452.09 12864,-444.95 10847.57,-416.9 8386.99,-392.88 7829.13,-387.55"/>
<polygon fill="black" stroke="black" points="7829.1,-384.05 7819.07,-387.46 7829.03,-391.05 7829.1,-384.05"/>
</g>
<!-- layer_3_expert_63_gpu15&#45;&gt;layer_3_expert_agg -->
<g id="edge277" class="edge">
<title>layer_3_expert_63_gpu15&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M14493.32,-464.78C14490.53,-464.49 14487.76,-464.21 14485,-463.95 13971.22,-415.4 13840.02,-451.87 13324,-444.95 11114.86,-415.36 8416.3,-392.29 7829.21,-387.41"/>
<polygon fill="black" stroke="black" points="7829.08,-383.91 7819.05,-387.32 7829.02,-390.91 7829.08,-383.91"/>
</g>
<!-- output -->
<g id="node152" class="node">
<title>output</title>
<ellipse fill="white" stroke="black" cx="7713" cy="-53.48" rx="137.36" ry="37.45"/>
<text text-anchor="middle" x="7713" y="-64.78" font-family="Times,serif" font-size="14.00">Output Tokens</text>
<text text-anchor="middle" x="7713" y="-49.78" font-family="Times,serif" font-size="14.00">(Batch: 1024 tokens)</text>
<text text-anchor="middle" x="7713" y="-34.78" font-family="Times,serif" font-size="14.00">Dim: [1024, hidden_size]</text>
</g>
<!-- final_norm&#45;&gt;output -->
<g id="edge279" class="edge">
<title>final_norm&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7713,-127.71C7713,-119.63 7713,-110.45 7713,-101.39"/>
<polygon fill="black" stroke="black" points="7716.5,-101.27 7713,-91.27 7709.5,-101.27 7716.5,-101.27"/>
</g>
<!-- pipeline_comm -->
<g id="node153" class="node">
<title>pipeline_comm</title>
<ellipse fill="white" stroke="black" cx="24568" cy="-3351.04" rx="135.11" ry="48.17"/>
<text text-anchor="middle" x="24568" y="-3369.84" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="24568" y="-3354.84" font-family="Times,serif" font-size="14.00">TP=8, PP=2</text>
<text text-anchor="middle" x="24568" y="-3339.84" font-family="Times,serif" font-size="14.00">16 GPUs Total</text>
<text text-anchor="middle" x="24568" y="-3324.84" font-family="Times,serif" font-size="14.00">4 experts per GPU</text>
</g>
</g>
</svg>
