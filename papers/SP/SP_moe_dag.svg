<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_Transformer_RA_SP Pages: 1 -->
<svg width="3600pt" height="1299pt"
 viewBox="0.00 0.00 3600.00 1298.64" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.11 0.11) rotate(0) translate(4 12253)">
<title>MoE_Transformer_RA_SP</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-12253 33974,-12253 33974,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="28324,-12127 28324,-12241 33962,-12241 33962,-12127 28324,-12127"/>
<text text-anchor="middle" x="31143" y="-12225.8" font-family="Times,serif" font-size="14.00">Input Sequence Parallel Split</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer1</title>
<path fill="none" stroke="black" d="M17744,-9130.5C17744,-9130.5 32755,-9130.5 32755,-9130.5 32761,-9130.5 32767,-9136.5 32767,-9142.5 32767,-9142.5 32767,-12096 32767,-12096 32767,-12102 32761,-12108 32755,-12108 32755,-12108 17744,-12108 17744,-12108 17738,-12108 17732,-12102 17732,-12096 17732,-12096 17732,-9142.5 17732,-9142.5 17732,-9136.5 17738,-9130.5 17744,-9130.5"/>
<text text-anchor="middle" x="25249.5" y="-12092.8" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_l1_stage0</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="29642,-11839.83 29642,-11953.83 32759,-11953.83 32759,-11839.83 29642,-11839.83"/>
<text text-anchor="middle" x="31200.5" y="-11938.63" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_l1_stage1</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="29642,-11692.83 29642,-11806.83 32759,-11806.83 32759,-11692.83 29642,-11692.83"/>
<text text-anchor="middle" x="31200.5" y="-11791.63" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_l1_stage2</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="29642,-11545.83 29642,-11659.83 32759,-11659.83 32759,-11545.83 29642,-11545.83"/>
<text text-anchor="middle" x="31200.5" y="-11644.63" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_l1_stage3</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="29642,-11398.83 29642,-11512.83 32759,-11512.83 32759,-11398.83 29642,-11398.83"/>
<text text-anchor="middle" x="31200.5" y="-11497.63" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_l1_stage4</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="29642,-11251.83 29642,-11365.83 32759,-11365.83 32759,-11251.83 29642,-11251.83"/>
<text text-anchor="middle" x="31200.5" y="-11350.63" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_l1_stage5</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="29642,-11104.83 29642,-11218.83 32759,-11218.83 32759,-11104.83 29642,-11104.83"/>
<text text-anchor="middle" x="31200.5" y="-11203.63" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_l1_stage6</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="29642,-10957.83 29642,-11071.83 32759,-11071.83 32759,-10957.83 29642,-10957.83"/>
<text text-anchor="middle" x="31200.5" y="-11056.63" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_l1_stage7</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="29642,-10810.83 29642,-10924.83 32759,-10924.83 32759,-10810.83 29642,-10810.83"/>
<text text-anchor="middle" x="31200.5" y="-10909.63" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_l1_stage8</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="29642,-10663.83 29642,-10777.83 32759,-10777.83 32759,-10663.83 29642,-10663.83"/>
<text text-anchor="middle" x="31200.5" y="-10762.63" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_l1_stage9</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="29642,-10516.83 29642,-10630.83 32759,-10630.83 32759,-10516.83 29642,-10516.83"/>
<text text-anchor="middle" x="31200.5" y="-10615.63" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_l1_stage10</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="29433,-10369.83 29433,-10483.83 32759,-10483.83 32759,-10369.83 29433,-10369.83"/>
<text text-anchor="middle" x="31096" y="-10468.63" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_l1_stage11</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="29433,-10222.83 29433,-10336.83 32759,-10336.83 32759,-10222.83 29433,-10222.83"/>
<text text-anchor="middle" x="31096" y="-10321.63" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_l1_stage12</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="29433,-10075.83 29433,-10189.83 32759,-10189.83 32759,-10075.83 29433,-10075.83"/>
<text text-anchor="middle" x="31096" y="-10174.63" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_l1_stage13</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="29433,-9928.83 29433,-10042.83 32759,-10042.83 32759,-9928.83 29433,-9928.83"/>
<text text-anchor="middle" x="31096" y="-10027.63" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_l1_stage14</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="29433,-9781.83 29433,-9895.83 32759,-9895.83 32759,-9781.83 29433,-9781.83"/>
<text text-anchor="middle" x="31096" y="-9880.63" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_l1_stage15</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="26186,-9634.83 26186,-9748.83 29512,-9748.83 29512,-9634.83 26186,-9634.83"/>
<text text-anchor="middle" x="27849" y="-9733.63" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_layer2</title>
<path fill="none" stroke="black" d="M11802,-6134C11802,-6134 26813,-6134 26813,-6134 26819,-6134 26825,-6140 26825,-6146 26825,-6146 26825,-9099.5 26825,-9099.5 26825,-9105.5 26819,-9111.5 26813,-9111.5 26813,-9111.5 11802,-9111.5 11802,-9111.5 11796,-9111.5 11790,-9105.5 11790,-9099.5 11790,-9099.5 11790,-6146 11790,-6146 11790,-6140 11796,-6134 11802,-6134"/>
<text text-anchor="middle" x="19307.5" y="-9096.3" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_l2_stage0</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="23700,-8843.33 23700,-8957.33 26817,-8957.33 26817,-8843.33 23700,-8843.33"/>
<text text-anchor="middle" x="25258.5" y="-8942.13" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_l2_stage1</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="23700,-8696.33 23700,-8810.33 26817,-8810.33 26817,-8696.33 23700,-8696.33"/>
<text text-anchor="middle" x="25258.5" y="-8795.13" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_l2_stage2</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="23700,-8549.33 23700,-8663.33 26817,-8663.33 26817,-8549.33 23700,-8549.33"/>
<text text-anchor="middle" x="25258.5" y="-8648.13" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_l2_stage3</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="23700,-8402.33 23700,-8516.33 26817,-8516.33 26817,-8402.33 23700,-8402.33"/>
<text text-anchor="middle" x="25258.5" y="-8501.13" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
</g>
<g id="clust24" class="cluster">
<title>cluster_l2_stage4</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="23700,-8255.33 23700,-8369.33 26817,-8369.33 26817,-8255.33 23700,-8255.33"/>
<text text-anchor="middle" x="25258.5" y="-8354.13" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
</g>
<g id="clust25" class="cluster">
<title>cluster_l2_stage5</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="23700,-8108.33 23700,-8222.33 26817,-8222.33 26817,-8108.33 23700,-8108.33"/>
<text text-anchor="middle" x="25258.5" y="-8207.13" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
</g>
<g id="clust26" class="cluster">
<title>cluster_l2_stage6</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="23700,-7961.33 23700,-8075.33 26817,-8075.33 26817,-7961.33 23700,-7961.33"/>
<text text-anchor="middle" x="25258.5" y="-8060.13" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
</g>
<g id="clust27" class="cluster">
<title>cluster_l2_stage7</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="23700,-7814.33 23700,-7928.33 26817,-7928.33 26817,-7814.33 23700,-7814.33"/>
<text text-anchor="middle" x="25258.5" y="-7913.13" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
</g>
<g id="clust28" class="cluster">
<title>cluster_l2_stage8</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="23700,-7667.33 23700,-7781.33 26817,-7781.33 26817,-7667.33 23700,-7667.33"/>
<text text-anchor="middle" x="25258.5" y="-7766.13" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
</g>
<g id="clust29" class="cluster">
<title>cluster_l2_stage9</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="23700,-7520.33 23700,-7634.33 26817,-7634.33 26817,-7520.33 23700,-7520.33"/>
<text text-anchor="middle" x="25258.5" y="-7619.13" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
</g>
<g id="clust30" class="cluster">
<title>cluster_l2_stage10</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="23491,-7373.33 23491,-7487.33 26817,-7487.33 26817,-7373.33 23491,-7373.33"/>
<text text-anchor="middle" x="25154" y="-7472.13" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
</g>
<g id="clust31" class="cluster">
<title>cluster_l2_stage11</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="23491,-7226.33 23491,-7340.33 26817,-7340.33 26817,-7226.33 23491,-7226.33"/>
<text text-anchor="middle" x="25154" y="-7325.13" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
</g>
<g id="clust32" class="cluster">
<title>cluster_l2_stage12</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="23491,-7079.33 23491,-7193.33 26817,-7193.33 26817,-7079.33 23491,-7079.33"/>
<text text-anchor="middle" x="25154" y="-7178.13" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
</g>
<g id="clust33" class="cluster">
<title>cluster_l2_stage13</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="23491,-6932.33 23491,-7046.33 26817,-7046.33 26817,-6932.33 23491,-6932.33"/>
<text text-anchor="middle" x="25154" y="-7031.13" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
</g>
<g id="clust34" class="cluster">
<title>cluster_l2_stage14</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="23491,-6785.33 23491,-6899.33 26817,-6899.33 26817,-6785.33 23491,-6785.33"/>
<text text-anchor="middle" x="25154" y="-6884.13" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
</g>
<g id="clust35" class="cluster">
<title>cluster_l2_stage15</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="20200,-6638.33 20200,-6752.33 23526,-6752.33 23526,-6638.33 20200,-6638.33"/>
<text text-anchor="middle" x="21863" y="-6737.13" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
</g>
<g id="clust36" class="cluster">
<title>cluster_layer3</title>
<path fill="none" stroke="black" d="M5910,-3137.5C5910,-3137.5 20921,-3137.5 20921,-3137.5 20927,-3137.5 20933,-3143.5 20933,-3149.5 20933,-3149.5 20933,-6103 20933,-6103 20933,-6109 20927,-6115 20921,-6115 20921,-6115 5910,-6115 5910,-6115 5904,-6115 5898,-6109 5898,-6103 5898,-6103 5898,-3149.5 5898,-3149.5 5898,-3143.5 5904,-3137.5 5910,-3137.5"/>
<text text-anchor="middle" x="13415.5" y="-6099.8" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<g id="clust37" class="cluster">
<title>cluster_l3_stage0</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="17808,-5846.83 17808,-5960.83 20925,-5960.83 20925,-5846.83 17808,-5846.83"/>
<text text-anchor="middle" x="19366.5" y="-5945.63" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
</g>
<g id="clust38" class="cluster">
<title>cluster_l3_stage1</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="17808,-5699.83 17808,-5813.83 20925,-5813.83 20925,-5699.83 17808,-5699.83"/>
<text text-anchor="middle" x="19366.5" y="-5798.63" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
</g>
<g id="clust39" class="cluster">
<title>cluster_l3_stage2</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="17808,-5552.83 17808,-5666.83 20925,-5666.83 20925,-5552.83 17808,-5552.83"/>
<text text-anchor="middle" x="19366.5" y="-5651.63" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
</g>
<g id="clust40" class="cluster">
<title>cluster_l3_stage3</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="17808,-5405.83 17808,-5519.83 20925,-5519.83 20925,-5405.83 17808,-5405.83"/>
<text text-anchor="middle" x="19366.5" y="-5504.63" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
</g>
<g id="clust41" class="cluster">
<title>cluster_l3_stage4</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="17808,-5258.83 17808,-5372.83 20925,-5372.83 20925,-5258.83 17808,-5258.83"/>
<text text-anchor="middle" x="19366.5" y="-5357.63" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
</g>
<g id="clust42" class="cluster">
<title>cluster_l3_stage5</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="17808,-5111.83 17808,-5225.83 20925,-5225.83 20925,-5111.83 17808,-5111.83"/>
<text text-anchor="middle" x="19366.5" y="-5210.63" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
</g>
<g id="clust43" class="cluster">
<title>cluster_l3_stage6</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="17808,-4964.83 17808,-5078.83 20925,-5078.83 20925,-4964.83 17808,-4964.83"/>
<text text-anchor="middle" x="19366.5" y="-5063.63" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
</g>
<g id="clust44" class="cluster">
<title>cluster_l3_stage7</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="17808,-4817.83 17808,-4931.83 20925,-4931.83 20925,-4817.83 17808,-4817.83"/>
<text text-anchor="middle" x="19366.5" y="-4916.63" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
</g>
<g id="clust45" class="cluster">
<title>cluster_l3_stage8</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="17808,-4670.83 17808,-4784.83 20925,-4784.83 20925,-4670.83 17808,-4670.83"/>
<text text-anchor="middle" x="19366.5" y="-4769.63" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
</g>
<g id="clust46" class="cluster">
<title>cluster_l3_stage9</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="17808,-4523.83 17808,-4637.83 20925,-4637.83 20925,-4523.83 17808,-4523.83"/>
<text text-anchor="middle" x="19366.5" y="-4622.63" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
</g>
<g id="clust47" class="cluster">
<title>cluster_l3_stage10</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="17599,-4376.83 17599,-4490.83 20925,-4490.83 20925,-4376.83 17599,-4376.83"/>
<text text-anchor="middle" x="19262" y="-4475.63" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
</g>
<g id="clust48" class="cluster">
<title>cluster_l3_stage11</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="17599,-4229.83 17599,-4343.83 20925,-4343.83 20925,-4229.83 17599,-4229.83"/>
<text text-anchor="middle" x="19262" y="-4328.63" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
</g>
<g id="clust49" class="cluster">
<title>cluster_l3_stage12</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="17599,-4082.83 17599,-4196.83 20925,-4196.83 20925,-4082.83 17599,-4082.83"/>
<text text-anchor="middle" x="19262" y="-4181.63" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
</g>
<g id="clust50" class="cluster">
<title>cluster_l3_stage13</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="17599,-3935.83 17599,-4049.83 20925,-4049.83 20925,-3935.83 17599,-3935.83"/>
<text text-anchor="middle" x="19262" y="-4034.63" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
</g>
<g id="clust51" class="cluster">
<title>cluster_l3_stage14</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="17599,-3788.83 17599,-3902.83 20925,-3902.83 20925,-3788.83 17599,-3788.83"/>
<text text-anchor="middle" x="19262" y="-3887.63" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
</g>
<g id="clust52" class="cluster">
<title>cluster_l3_stage15</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="14535,-3641.83 14535,-3755.83 17861,-3755.83 17861,-3641.83 14535,-3641.83"/>
<text text-anchor="middle" x="16198" y="-3740.63" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
</g>
<g id="clust53" class="cluster">
<title>cluster_layer4</title>
<path fill="none" stroke="black" d="M20,-141C20,-141 15031,-141 15031,-141 15037,-141 15043,-147 15043,-153 15043,-153 15043,-3106.5 15043,-3106.5 15043,-3112.5 15037,-3118.5 15031,-3118.5 15031,-3118.5 20,-3118.5 20,-3118.5 14,-3118.5 8,-3112.5 8,-3106.5 8,-3106.5 8,-153 8,-153 8,-147 14,-141 20,-141"/>
<text text-anchor="middle" x="7525.5" y="-3103.3" font-family="Times,serif" font-size="14.00">Layer 4</text>
</g>
<g id="clust54" class="cluster">
<title>cluster_l4_stage0</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="11918,-2850.33 11918,-2964.33 15035,-2964.33 15035,-2850.33 11918,-2850.33"/>
<text text-anchor="middle" x="13476.5" y="-2949.13" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
</g>
<g id="clust55" class="cluster">
<title>cluster_l4_stage1</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="11918,-2703.33 11918,-2817.33 15035,-2817.33 15035,-2703.33 11918,-2703.33"/>
<text text-anchor="middle" x="13476.5" y="-2802.13" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
</g>
<g id="clust56" class="cluster">
<title>cluster_l4_stage2</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="11918,-2556.33 11918,-2670.33 15035,-2670.33 15035,-2556.33 11918,-2556.33"/>
<text text-anchor="middle" x="13476.5" y="-2655.13" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
</g>
<g id="clust57" class="cluster">
<title>cluster_l4_stage3</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="11918,-2409.33 11918,-2523.33 15035,-2523.33 15035,-2409.33 11918,-2409.33"/>
<text text-anchor="middle" x="13476.5" y="-2508.13" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
</g>
<g id="clust58" class="cluster">
<title>cluster_l4_stage4</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="11918,-2262.33 11918,-2376.33 15035,-2376.33 15035,-2262.33 11918,-2262.33"/>
<text text-anchor="middle" x="13476.5" y="-2361.13" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
</g>
<g id="clust59" class="cluster">
<title>cluster_l4_stage5</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="11918,-2115.33 11918,-2229.33 15035,-2229.33 15035,-2115.33 11918,-2115.33"/>
<text text-anchor="middle" x="13476.5" y="-2214.13" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
</g>
<g id="clust60" class="cluster">
<title>cluster_l4_stage6</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="11918,-1968.33 11918,-2082.33 15035,-2082.33 15035,-1968.33 11918,-1968.33"/>
<text text-anchor="middle" x="13476.5" y="-2067.13" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
</g>
<g id="clust61" class="cluster">
<title>cluster_l4_stage7</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="11918,-1821.33 11918,-1935.33 15035,-1935.33 15035,-1821.33 11918,-1821.33"/>
<text text-anchor="middle" x="13476.5" y="-1920.13" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
</g>
<g id="clust62" class="cluster">
<title>cluster_l4_stage8</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="11918,-1674.33 11918,-1788.33 15035,-1788.33 15035,-1674.33 11918,-1674.33"/>
<text text-anchor="middle" x="13476.5" y="-1773.13" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
</g>
<g id="clust63" class="cluster">
<title>cluster_l4_stage9</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="11918,-1527.33 11918,-1641.33 15035,-1641.33 15035,-1527.33 11918,-1527.33"/>
<text text-anchor="middle" x="13476.5" y="-1626.13" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
</g>
<g id="clust64" class="cluster">
<title>cluster_l4_stage10</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="11709,-1380.33 11709,-1494.33 15035,-1494.33 15035,-1380.33 11709,-1380.33"/>
<text text-anchor="middle" x="13372" y="-1479.13" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
</g>
<g id="clust65" class="cluster">
<title>cluster_l4_stage11</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="11709,-1233.33 11709,-1347.33 15035,-1347.33 15035,-1233.33 11709,-1233.33"/>
<text text-anchor="middle" x="13372" y="-1332.13" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
</g>
<g id="clust66" class="cluster">
<title>cluster_l4_stage12</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="11709,-1086.33 11709,-1200.33 15035,-1200.33 15035,-1086.33 11709,-1086.33"/>
<text text-anchor="middle" x="13372" y="-1185.13" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
</g>
<g id="clust67" class="cluster">
<title>cluster_l4_stage13</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="11709,-939.33 11709,-1053.33 15035,-1053.33 15035,-939.33 11709,-939.33"/>
<text text-anchor="middle" x="13372" y="-1038.13" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
</g>
<g id="clust68" class="cluster">
<title>cluster_l4_stage14</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="11709,-792.33 11709,-906.33 15035,-906.33 15035,-792.33 11709,-792.33"/>
<text text-anchor="middle" x="13372" y="-891.13" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
</g>
<g id="clust69" class="cluster">
<title>cluster_l4_stage15</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="8562,-645.33 8562,-759.33 11888,-759.33 11888,-645.33 8562,-645.33"/>
<text text-anchor="middle" x="10225" y="-744.13" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
</g>
<g id="clust70" class="cluster">
<title>cluster_output</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="5839,-8 5839,-122 9229,-122 9229,-8 5839,-8"/>
<text text-anchor="middle" x="7534" y="-106.8" font-family="Times,serif" font-size="14.00">Output Gather</text>
</g>
<!-- input_gpu0 -->
<g id="node1" class="node">
<title>input_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="28497" cy="-12172.5" rx="165" ry="37.5"/>
<text text-anchor="middle" x="28497" y="-12183.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="28497" y="-12168.8" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="28497" y="-12153.8" font-family="Times,serif" font-size="14.00">X[:, 0*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu0 -->
<g id="node273" class="node">
<title>l1_qkv_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="28818" cy="-12028.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="28818" y="-12047.72" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="28818" y="-12032.72" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="28818" y="-12017.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="28818" y="-12002.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu0&#45;&gt;l1_qkv_gpu0 -->
<g id="edge2177" class="edge">
<title>input_gpu0&#45;&gt;l1_qkv_gpu0</title>
<path fill="none" stroke="black" d="M28571.05,-12138.84C28621.33,-12116.66 28687.76,-12087.36 28739.05,-12064.74"/>
<polygon fill="black" stroke="black" points="28740.71,-12067.83 28748.45,-12060.59 28737.89,-12061.43 28740.71,-12067.83"/>
</g>
<!-- input_gpu1 -->
<g id="node2" class="node">
<title>input_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="28845" cy="-12172.5" rx="165" ry="37.5"/>
<text text-anchor="middle" x="28845" y="-12183.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="28845" y="-12168.8" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="28845" y="-12153.8" font-family="Times,serif" font-size="14.00">X[:, 1*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu1 -->
<g id="node274" class="node">
<title>l1_qkv_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="29128" cy="-12028.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="29128" y="-12047.72" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="29128" y="-12032.72" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="29128" y="-12017.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="29128" y="-12002.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu1&#45;&gt;l1_qkv_gpu1 -->
<g id="edge2178" class="edge">
<title>input_gpu1&#45;&gt;l1_qkv_gpu1</title>
<path fill="none" stroke="black" d="M28911.71,-12138.12C28954.12,-12116.91 29009.11,-12089.39 29053.03,-12067.42"/>
<polygon fill="black" stroke="black" points="29054.85,-12070.42 29062.23,-12062.82 29051.72,-12064.16 29054.85,-12070.42"/>
</g>
<!-- input_gpu2 -->
<g id="node3" class="node">
<title>input_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="29193" cy="-12172.5" rx="165" ry="37.5"/>
<text text-anchor="middle" x="29193" y="-12183.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="29193" y="-12168.8" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="29193" y="-12153.8" font-family="Times,serif" font-size="14.00">X[:, 2*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu2 -->
<g id="node275" class="node">
<title>l1_qkv_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="29494" cy="-12028.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="29494" y="-12047.72" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="29494" y="-12032.72" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="29494" y="-12017.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="29494" y="-12002.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu2&#45;&gt;l1_qkv_gpu2 -->
<g id="edge2179" class="edge">
<title>input_gpu2&#45;&gt;l1_qkv_gpu2</title>
<path fill="none" stroke="black" d="M29263.19,-12138.48C29309.36,-12116.76 29369.79,-12088.34 29417.24,-12066.02"/>
<polygon fill="black" stroke="black" points="29418.99,-12069.07 29426.55,-12061.64 29416.01,-12062.73 29418.99,-12069.07"/>
</g>
<!-- input_gpu3 -->
<g id="node4" class="node">
<title>input_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="29541" cy="-12172.5" rx="165" ry="37.5"/>
<text text-anchor="middle" x="29541" y="-12183.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="29541" y="-12168.8" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="29541" y="-12153.8" font-family="Times,serif" font-size="14.00">X[:, 3*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu3 -->
<g id="node276" class="node">
<title>l1_qkv_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="29805" cy="-12028.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="29805" y="-12047.72" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="29805" y="-12032.72" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="29805" y="-12017.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="29805" y="-12002.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu3&#45;&gt;l1_qkv_gpu3 -->
<g id="edge2180" class="edge">
<title>input_gpu3&#45;&gt;l1_qkv_gpu3</title>
<path fill="none" stroke="black" d="M29603.9,-12137.77C29642.61,-12117.01 29692.36,-12090.33 29732.69,-12068.7"/>
<polygon fill="black" stroke="black" points="29734.51,-12071.69 29741.67,-12063.88 29731.2,-12065.52 29734.51,-12071.69"/>
</g>
<!-- input_gpu4 -->
<g id="node5" class="node">
<title>input_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="29889" cy="-12172.5" rx="165" ry="37.5"/>
<text text-anchor="middle" x="29889" y="-12183.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="29889" y="-12168.8" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="29889" y="-12153.8" font-family="Times,serif" font-size="14.00">X[:, 4*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu4 -->
<g id="node277" class="node">
<title>l1_qkv_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="30062" cy="-12028.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="30062" y="-12047.72" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="30062" y="-12032.72" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="30062" y="-12017.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="30062" y="-12002.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu4&#45;&gt;l1_qkv_gpu4 -->
<g id="edge2181" class="edge">
<title>input_gpu4&#45;&gt;l1_qkv_gpu4</title>
<path fill="none" stroke="black" d="M29932.21,-12136.14C29954.33,-12118.03 29981.54,-12095.77 30005.32,-12076.3"/>
<polygon fill="black" stroke="black" points="30007.72,-12078.86 30013.24,-12069.82 30003.28,-12073.45 30007.72,-12078.86"/>
</g>
<!-- input_gpu5 -->
<g id="node6" class="node">
<title>input_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="30237" cy="-12172.5" rx="165" ry="37.5"/>
<text text-anchor="middle" x="30237" y="-12183.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="30237" y="-12168.8" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="30237" y="-12153.8" font-family="Times,serif" font-size="14.00">X[:, 5*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu5 -->
<g id="node278" class="node">
<title>l1_qkv_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="30429" cy="-12028.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="30429" y="-12047.72" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="30429" y="-12032.72" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="30429" y="-12017.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="30429" y="-12002.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu5&#45;&gt;l1_qkv_gpu5 -->
<g id="edge2182" class="edge">
<title>input_gpu5&#45;&gt;l1_qkv_gpu5</title>
<path fill="none" stroke="black" d="M30284.46,-12136.5C30309.82,-12117.8 30341.31,-12094.58 30368.42,-12074.58"/>
<polygon fill="black" stroke="black" points="30370.71,-12077.24 30376.69,-12068.49 30366.56,-12071.61 30370.71,-12077.24"/>
</g>
<!-- input_gpu6 -->
<g id="node7" class="node">
<title>input_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="30585" cy="-12172.5" rx="165" ry="37.5"/>
<text text-anchor="middle" x="30585" y="-12183.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="30585" y="-12168.8" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="30585" y="-12153.8" font-family="Times,serif" font-size="14.00">X[:, 6*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu6 -->
<g id="node279" class="node">
<title>l1_qkv_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="30704" cy="-12028.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="30704" y="-12047.72" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="30704" y="-12032.72" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="30704" y="-12017.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="30704" y="-12002.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu6&#45;&gt;l1_qkv_gpu6 -->
<g id="edge2183" class="edge">
<title>input_gpu6&#45;&gt;l1_qkv_gpu6</title>
<path fill="none" stroke="black" d="M30615.34,-12135.4C30629.13,-12118.99 30645.7,-12099.27 30660.77,-12081.35"/>
<polygon fill="black" stroke="black" points="30663.81,-12083.17 30667.57,-12073.26 30658.46,-12078.66 30663.81,-12083.17"/>
</g>
<!-- input_gpu7 -->
<g id="node8" class="node">
<title>input_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="30933" cy="-12172.5" rx="165" ry="37.5"/>
<text text-anchor="middle" x="30933" y="-12183.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="30933" y="-12168.8" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="30933" y="-12153.8" font-family="Times,serif" font-size="14.00">X[:, 7*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu7 -->
<g id="node280" class="node">
<title>l1_qkv_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="31015" cy="-12028.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="31015" y="-12047.72" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="31015" y="-12032.72" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="31015" y="-12017.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="31015" y="-12002.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu7&#45;&gt;l1_qkv_gpu7 -->
<g id="edge2184" class="edge">
<title>input_gpu7&#45;&gt;l1_qkv_gpu7</title>
<path fill="none" stroke="black" d="M30954.12,-12135.04C30963.13,-12119.48 30973.83,-12101 30983.73,-12083.91"/>
<polygon fill="black" stroke="black" points="30986.84,-12085.53 30988.82,-12075.12 30980.78,-12082.02 30986.84,-12085.53"/>
</g>
<!-- input_gpu8 -->
<g id="node9" class="node">
<title>input_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="31281" cy="-12172.5" rx="165" ry="37.5"/>
<text text-anchor="middle" x="31281" y="-12183.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="31281" y="-12168.8" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="31281" y="-12153.8" font-family="Times,serif" font-size="14.00">X[:, 8*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu8 -->
<g id="node281" class="node">
<title>l1_qkv_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="31253" cy="-12028.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="31253" y="-12047.72" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="31253" y="-12032.72" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="31253" y="-12017.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="31253" y="-12002.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu8&#45;&gt;l1_qkv_gpu8 -->
<g id="edge2185" class="edge">
<title>input_gpu8&#45;&gt;l1_qkv_gpu8</title>
<path fill="none" stroke="black" d="M31273.72,-12134.67C31270.83,-12120.08 31267.45,-12102.97 31264.26,-12086.86"/>
<polygon fill="black" stroke="black" points="31267.68,-12086.12 31262.31,-12076.98 31260.82,-12087.47 31267.68,-12086.12"/>
</g>
<!-- input_gpu9 -->
<g id="node10" class="node">
<title>input_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="31629" cy="-12172.5" rx="165" ry="37.5"/>
<text text-anchor="middle" x="31629" y="-12183.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="31629" y="-12168.8" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="31629" y="-12153.8" font-family="Times,serif" font-size="14.00">X[:, 9*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu9 -->
<g id="node282" class="node">
<title>l1_qkv_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="31455" cy="-12028.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="31455" y="-12047.72" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="31455" y="-12032.72" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="31455" y="-12017.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="31455" y="-12002.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu9&#45;&gt;l1_qkv_gpu9 -->
<g id="edge2186" class="edge">
<title>input_gpu9&#45;&gt;l1_qkv_gpu9</title>
<path fill="none" stroke="black" d="M31585.54,-12136.14C31563.29,-12118.03 31535.93,-12095.77 31512.01,-12076.3"/>
<polygon fill="black" stroke="black" points="31514.01,-12073.42 31504.04,-12069.82 31509.59,-12078.85 31514.01,-12073.42"/>
</g>
<!-- input_gpu10 -->
<g id="node11" class="node">
<title>input_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="31983" cy="-12172.5" rx="171.03" ry="37.5"/>
<text text-anchor="middle" x="31983" y="-12183.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="31983" y="-12168.8" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="31983" y="-12153.8" font-family="Times,serif" font-size="14.00">X[:, 10*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu10 -->
<g id="node283" class="node">
<title>l1_qkv_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="31657" cy="-12028.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="31657" y="-12047.72" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="31657" y="-12032.72" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="31657" y="-12017.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="31657" y="-12002.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu10&#45;&gt;l1_qkv_gpu10 -->
<g id="edge2187" class="edge">
<title>input_gpu10&#45;&gt;l1_qkv_gpu10</title>
<path fill="none" stroke="black" d="M31870.89,-12144.09C31825.33,-12132.08 31778.62,-12118.38 31758,-12108 31741.47,-12099.67 31724.97,-12088.46 31710.24,-12077.14"/>
<polygon fill="black" stroke="black" points="31712.28,-12074.29 31702.26,-12070.86 31707.95,-12079.79 31712.28,-12074.29"/>
</g>
<!-- input_gpu11 -->
<g id="node12" class="node">
<title>input_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="32343" cy="-12172.5" rx="171.03" ry="37.5"/>
<text text-anchor="middle" x="32343" y="-12183.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="32343" y="-12168.8" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="32343" y="-12153.8" font-family="Times,serif" font-size="14.00">X[:, 11*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu11 -->
<g id="node284" class="node">
<title>l1_qkv_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="31859" cy="-12028.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="31859" y="-12047.72" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="31859" y="-12032.72" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="31859" y="-12017.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="31859" y="-12002.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu11&#45;&gt;l1_qkv_gpu11 -->
<g id="edge2188" class="edge">
<title>input_gpu11&#45;&gt;l1_qkv_gpu11</title>
<path fill="none" stroke="black" d="M32237.9,-12142.73C32213.46,-12136.81 32187.44,-12131.14 32163,-12127 32073.66,-12111.86 32044.3,-12141.25 31960,-12108 31942.26,-12101 31925.03,-12089.88 31909.97,-12078.2"/>
<polygon fill="black" stroke="black" points="31911.83,-12075.21 31901.84,-12071.68 31907.45,-12080.67 31911.83,-12075.21"/>
</g>
<!-- input_gpu12 -->
<g id="node13" class="node">
<title>input_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="32703" cy="-12172.5" rx="171.03" ry="37.5"/>
<text text-anchor="middle" x="32703" y="-12183.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="32703" y="-12168.8" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="32703" y="-12153.8" font-family="Times,serif" font-size="14.00">X[:, 12*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu12 -->
<g id="node285" class="node">
<title>l1_qkv_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="32061" cy="-12028.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="32061" y="-12047.72" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="32061" y="-12032.72" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="32061" y="-12017.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="32061" y="-12002.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu12&#45;&gt;l1_qkv_gpu12 -->
<g id="edge2189" class="edge">
<title>input_gpu12&#45;&gt;l1_qkv_gpu12</title>
<path fill="none" stroke="black" d="M32599.92,-12142.46C32574.93,-12136.4 32548.15,-12130.74 32523,-12127 32443.54,-12115.19 32237.31,-12135.95 32162,-12108 32143.94,-12101.3 32126.5,-12090.15 32111.35,-12078.34"/>
<polygon fill="black" stroke="black" points="32113.15,-12075.3 32103.17,-12071.74 32108.75,-12080.74 32113.15,-12075.3"/>
</g>
<!-- input_gpu13 -->
<g id="node14" class="node">
<title>input_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="33063" cy="-12172.5" rx="171.03" ry="37.5"/>
<text text-anchor="middle" x="33063" y="-12183.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="33063" y="-12168.8" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="33063" y="-12153.8" font-family="Times,serif" font-size="14.00">X[:, 13*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu13 -->
<g id="node286" class="node">
<title>l1_qkv_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="32263" cy="-12028.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="32263" y="-12047.72" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="32263" y="-12032.72" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="32263" y="-12017.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="32263" y="-12002.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu13&#45;&gt;l1_qkv_gpu13 -->
<g id="edge2190" class="edge">
<title>input_gpu13&#45;&gt;l1_qkv_gpu13</title>
<path fill="none" stroke="black" d="M32960.91,-12142.4C32935.64,-12136.27 32908.5,-12130.58 32883,-12127 32825.86,-12118.98 32418.26,-12127.64 32364,-12108 32345.89,-12101.44 32328.43,-12090.34 32313.28,-12078.53"/>
<polygon fill="black" stroke="black" points="32315.08,-12075.49 32305.11,-12071.92 32310.68,-12080.93 32315.08,-12075.49"/>
</g>
<!-- input_gpu14 -->
<g id="node15" class="node">
<title>input_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="33423" cy="-12172.5" rx="171.03" ry="37.5"/>
<text text-anchor="middle" x="33423" y="-12183.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="33423" y="-12168.8" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="33423" y="-12153.8" font-family="Times,serif" font-size="14.00">X[:, 14*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu14 -->
<g id="node287" class="node">
<title>l1_qkv_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="32465" cy="-12028.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="32465" y="-12047.72" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="32465" y="-12032.72" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="32465" y="-12017.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="32465" y="-12002.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu14&#45;&gt;l1_qkv_gpu14 -->
<g id="edge2191" class="edge">
<title>input_gpu14&#45;&gt;l1_qkv_gpu14</title>
<path fill="none" stroke="black" d="M33320.93,-12142.24C33295.66,-12136.12 33268.52,-12130.47 33243,-12127 33168.43,-12116.85 32636.87,-12133.31 32566,-12108 32547.86,-12101.52 32530.4,-12090.44 32515.24,-12078.63"/>
<polygon fill="black" stroke="black" points="32517.05,-12075.59 32507.07,-12072.02 32512.64,-12081.03 32517.05,-12075.59"/>
</g>
<!-- input_gpu15 -->
<g id="node16" class="node">
<title>input_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="33783" cy="-12172.5" rx="171.03" ry="37.5"/>
<text text-anchor="middle" x="33783" y="-12183.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="33783" y="-12168.8" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="33783" y="-12153.8" font-family="Times,serif" font-size="14.00">X[:, 15*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu15 -->
<g id="node288" class="node">
<title>l1_qkv_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="32667" cy="-12028.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="32667" y="-12047.72" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="32667" y="-12032.72" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="32667" y="-12017.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="32667" y="-12002.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu15&#45;&gt;l1_qkv_gpu15 -->
<g id="edge2192" class="edge">
<title>input_gpu15&#45;&gt;l1_qkv_gpu15</title>
<path fill="none" stroke="black" d="M33677.87,-12142.91C33653.43,-12136.99 33627.42,-12131.26 33603,-12127 33301.81,-12074.41 32940.77,-12046.83 32768.34,-12035.79"/>
<polygon fill="black" stroke="black" points="32768.47,-12032.29 32758.26,-12035.15 32768.02,-12039.28 32768.47,-12032.29"/>
</g>
<!-- l1_attn_stage0_gpu0 -->
<g id="node17" class="node">
<title>l1_attn_stage0_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="29738" cy="-11885.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29738" y="-11896.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="29738" y="-11881.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="29738" y="-11866.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu0 -->
<g id="node33" class="node">
<title>l1_attn_stage1_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="29738" cy="-11738.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29738" y="-11749.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="29738" y="-11734.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="29738" y="-11719.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu0&#45;&gt;l1_attn_stage1_gpu0 -->
<g id="edge17" class="edge">
<title>l1_attn_stage0_gpu0&#45;&gt;l1_attn_stage1_gpu0</title>
<path fill="none" stroke="black" d="M29738,-11847.74C29738,-11829.02 29738,-11806.03 29738,-11786.05"/>
<polygon fill="black" stroke="black" points="29741.5,-11785.91 29738,-11775.91 29734.5,-11785.91 29741.5,-11785.91"/>
</g>
<!-- l1_attn_stage1_gpu[next_gpu] -->
<g id="node1345" class="node">
<title>l1_attn_stage1_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="32925" cy="-11738.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="32925" y="-11734.63" font-family="Times,serif" font-size="14.00">l1_attn_stage1_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage0_gpu0&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge2193" class="edge">
<title>l1_attn_stage0_gpu0&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29791.29,-11855.33C29805.43,-11848.99 29820.95,-11843.18 29836,-11839.83 30065.73,-11788.7 31718.66,-11817.38 31954,-11814.83 31998.94,-11814.34 32718.97,-11815.86 32763,-11806.83 32806.87,-11797.83 32853.77,-11776.91 32885.76,-11760.73"/>
<polygon fill="red" stroke="red" points="32887.49,-11763.78 32894.78,-11756.09 32884.28,-11757.55 32887.49,-11763.78"/>
<text text-anchor="middle" x="31985.5" y="-11818.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu1 -->
<g id="node18" class="node">
<title>l1_attn_stage0_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="29933" cy="-11885.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29933" y="-11896.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="29933" y="-11881.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="29933" y="-11866.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu1 -->
<g id="node34" class="node">
<title>l1_attn_stage1_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="29933" cy="-11738.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29933" y="-11749.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="29933" y="-11734.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="29933" y="-11719.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu1&#45;&gt;l1_attn_stage1_gpu1 -->
<g id="edge18" class="edge">
<title>l1_attn_stage0_gpu1&#45;&gt;l1_attn_stage1_gpu1</title>
<path fill="none" stroke="black" d="M29933,-11847.74C29933,-11829.02 29933,-11806.03 29933,-11786.05"/>
<polygon fill="black" stroke="black" points="29936.5,-11785.91 29933,-11775.91 29929.5,-11785.91 29936.5,-11785.91"/>
</g>
<!-- l1_attn_stage0_gpu1&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge2194" class="edge">
<title>l1_attn_stage0_gpu1&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29986.28,-11855.26C30000.41,-11848.92 30015.94,-11843.13 30031,-11839.83 30085,-11828 31968.82,-11848.09 32021,-11829.83 32031.15,-11826.28 32029.86,-11818.42 32040,-11814.83 32077.87,-11801.45 32723.66,-11814.93 32763,-11806.83 32806.87,-11797.81 32853.77,-11776.89 32885.76,-11760.72"/>
<polygon fill="red" stroke="red" points="32887.48,-11763.76 32894.78,-11756.08 32884.28,-11757.54 32887.48,-11763.76"/>
<text text-anchor="middle" x="32071.5" y="-11818.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu2 -->
<g id="node19" class="node">
<title>l1_attn_stage0_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="30128" cy="-11885.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30128" y="-11896.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="30128" y="-11881.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="30128" y="-11866.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu2 -->
<g id="node35" class="node">
<title>l1_attn_stage1_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="30128" cy="-11738.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30128" y="-11749.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="30128" y="-11734.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="30128" y="-11719.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu2&#45;&gt;l1_attn_stage1_gpu2 -->
<g id="edge19" class="edge">
<title>l1_attn_stage0_gpu2&#45;&gt;l1_attn_stage1_gpu2</title>
<path fill="none" stroke="black" d="M30128,-11847.74C30128,-11829.02 30128,-11806.03 30128,-11786.05"/>
<polygon fill="black" stroke="black" points="30131.5,-11785.91 30128,-11775.91 30124.5,-11785.91 30131.5,-11785.91"/>
</g>
<!-- l1_attn_stage0_gpu2&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge2195" class="edge">
<title>l1_attn_stage0_gpu2&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30181.28,-11855.27C30195.41,-11848.93 30210.94,-11843.13 30226,-11839.83 30277.04,-11828.64 32057.68,-11847.1 32107,-11829.83 32117.15,-11826.28 32115.86,-11818.42 32126,-11814.83 32159.36,-11803.01 32728.34,-11813.99 32763,-11806.83 32806.86,-11797.77 32853.76,-11776.86 32885.75,-11760.7"/>
<polygon fill="red" stroke="red" points="32887.48,-11763.75 32894.77,-11756.07 32884.28,-11757.52 32887.48,-11763.75"/>
<text text-anchor="middle" x="32157.5" y="-11818.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu3 -->
<g id="node20" class="node">
<title>l1_attn_stage0_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="30323" cy="-11885.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30323" y="-11896.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="30323" y="-11881.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="30323" y="-11866.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu3 -->
<g id="node36" class="node">
<title>l1_attn_stage1_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="30323" cy="-11738.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30323" y="-11749.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="30323" y="-11734.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="30323" y="-11719.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu3&#45;&gt;l1_attn_stage1_gpu3 -->
<g id="edge20" class="edge">
<title>l1_attn_stage0_gpu3&#45;&gt;l1_attn_stage1_gpu3</title>
<path fill="none" stroke="black" d="M30323,-11847.74C30323,-11829.02 30323,-11806.03 30323,-11786.05"/>
<polygon fill="black" stroke="black" points="30326.5,-11785.91 30323,-11775.91 30319.5,-11785.91 30326.5,-11785.91"/>
</g>
<!-- l1_attn_stage0_gpu3&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge2196" class="edge">
<title>l1_attn_stage0_gpu3&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30376.28,-11855.27C30390.41,-11848.93 30405.94,-11843.13 30421,-11839.83 30469.08,-11829.28 32146.55,-11846.11 32193,-11829.83 32203.15,-11826.27 32201.86,-11818.43 32212,-11814.83 32240.85,-11804.58 32733.02,-11813.05 32763,-11806.83 32806.85,-11797.73 32853.75,-11776.83 32885.75,-11760.67"/>
<polygon fill="red" stroke="red" points="32887.47,-11763.73 32894.77,-11756.05 32884.27,-11757.5 32887.47,-11763.73"/>
<text text-anchor="middle" x="32243.5" y="-11818.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu4 -->
<g id="node21" class="node">
<title>l1_attn_stage0_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="30518" cy="-11885.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30518" y="-11896.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="30518" y="-11881.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="30518" y="-11866.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu4 -->
<g id="node37" class="node">
<title>l1_attn_stage1_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="30518" cy="-11738.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30518" y="-11749.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="30518" y="-11734.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="30518" y="-11719.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu4&#45;&gt;l1_attn_stage1_gpu4 -->
<g id="edge21" class="edge">
<title>l1_attn_stage0_gpu4&#45;&gt;l1_attn_stage1_gpu4</title>
<path fill="none" stroke="black" d="M30518,-11847.74C30518,-11829.02 30518,-11806.03 30518,-11786.05"/>
<polygon fill="black" stroke="black" points="30521.5,-11785.91 30518,-11775.91 30514.5,-11785.91 30521.5,-11785.91"/>
</g>
<!-- l1_attn_stage0_gpu4&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge2197" class="edge">
<title>l1_attn_stage0_gpu4&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30571.28,-11855.27C30585.41,-11848.93 30600.94,-11843.14 30616,-11839.83 30661.12,-11829.93 32235.41,-11845.11 32279,-11829.83 32289.15,-11826.27 32287.87,-11818.45 32298,-11814.83 32346.67,-11797.47 32712.42,-11817.4 32763,-11806.83 32806.84,-11797.67 32853.74,-11776.78 32885.74,-11760.64"/>
<polygon fill="red" stroke="red" points="32887.46,-11763.7 32894.76,-11756.02 32884.27,-11757.47 32887.46,-11763.7"/>
<text text-anchor="middle" x="32329.5" y="-11818.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu5 -->
<g id="node22" class="node">
<title>l1_attn_stage0_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="30713" cy="-11885.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30713" y="-11896.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="30713" y="-11881.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="30713" y="-11866.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu5 -->
<g id="node38" class="node">
<title>l1_attn_stage1_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="30713" cy="-11738.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30713" y="-11749.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="30713" y="-11734.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="30713" y="-11719.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu5&#45;&gt;l1_attn_stage1_gpu5 -->
<g id="edge22" class="edge">
<title>l1_attn_stage0_gpu5&#45;&gt;l1_attn_stage1_gpu5</title>
<path fill="none" stroke="black" d="M30713,-11847.74C30713,-11829.02 30713,-11806.03 30713,-11786.05"/>
<polygon fill="black" stroke="black" points="30716.5,-11785.91 30713,-11775.91 30709.5,-11785.91 30716.5,-11785.91"/>
</g>
<!-- l1_attn_stage0_gpu5&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge2198" class="edge">
<title>l1_attn_stage0_gpu5&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30766.28,-11855.28C30780.41,-11848.94 30795.94,-11843.14 30811,-11839.83 30853.16,-11830.57 32324.27,-11844.12 32365,-11829.83 32375.15,-11826.27 32373.87,-11818.47 32384,-11814.83 32423.64,-11800.6 32721.79,-11815.53 32763,-11806.83 32806.82,-11797.59 32853.73,-11776.7 32885.73,-11760.6"/>
<polygon fill="red" stroke="red" points="32887.45,-11763.65 32894.75,-11755.98 32884.26,-11757.42 32887.45,-11763.65"/>
<text text-anchor="middle" x="32415.5" y="-11818.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu6 -->
<g id="node23" class="node">
<title>l1_attn_stage0_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="30908" cy="-11885.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30908" y="-11896.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="30908" y="-11881.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="30908" y="-11866.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu6 -->
<g id="node39" class="node">
<title>l1_attn_stage1_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="30908" cy="-11738.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30908" y="-11749.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="30908" y="-11734.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="30908" y="-11719.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu6&#45;&gt;l1_attn_stage1_gpu6 -->
<g id="edge23" class="edge">
<title>l1_attn_stage0_gpu6&#45;&gt;l1_attn_stage1_gpu6</title>
<path fill="none" stroke="black" d="M30908,-11847.74C30908,-11829.02 30908,-11806.03 30908,-11786.05"/>
<polygon fill="black" stroke="black" points="30911.5,-11785.91 30908,-11775.91 30904.5,-11785.91 30911.5,-11785.91"/>
</g>
<!-- l1_attn_stage0_gpu6&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge2199" class="edge">
<title>l1_attn_stage0_gpu6&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30961.28,-11855.28C30975.41,-11848.94 30990.94,-11843.14 31006,-11839.83 31045.2,-11831.21 32413.13,-11843.13 32451,-11829.83 32461.15,-11826.27 32459.89,-11818.5 32470,-11814.83 32500.62,-11803.73 32731.15,-11813.65 32763,-11806.83 32806.66,-11797.48 32853.41,-11776.72 32885.42,-11760.67"/>
<polygon fill="red" stroke="red" points="32887.12,-11763.73 32894.45,-11756.07 32883.95,-11757.49 32887.12,-11763.73"/>
<text text-anchor="middle" x="32501.5" y="-11818.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu7 -->
<g id="node24" class="node">
<title>l1_attn_stage0_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="31103" cy="-11885.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31103" y="-11896.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="31103" y="-11881.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="31103" y="-11866.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu7 -->
<g id="node40" class="node">
<title>l1_attn_stage1_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="31103" cy="-11738.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31103" y="-11749.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="31103" y="-11734.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="31103" y="-11719.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu7&#45;&gt;l1_attn_stage1_gpu7 -->
<g id="edge24" class="edge">
<title>l1_attn_stage0_gpu7&#45;&gt;l1_attn_stage1_gpu7</title>
<path fill="none" stroke="black" d="M31103,-11847.74C31103,-11829.02 31103,-11806.03 31103,-11786.05"/>
<polygon fill="black" stroke="black" points="31106.5,-11785.91 31103,-11775.91 31099.5,-11785.91 31106.5,-11785.91"/>
</g>
<!-- l1_attn_stage0_gpu7&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge2200" class="edge">
<title>l1_attn_stage0_gpu7&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31156.28,-11855.29C31170.42,-11848.95 31185.95,-11843.15 31201,-11839.83 31237.24,-11831.85 32501.99,-11842.13 32537,-11829.83 32547.15,-11826.27 32545.91,-11818.56 32556,-11814.83 32599.19,-11798.9 32718.04,-11816.73 32763,-11806.83 32806.6,-11797.23 32853.37,-11776.51 32885.39,-11760.54"/>
<polygon fill="red" stroke="red" points="32887.08,-11763.6 32894.42,-11755.96 32883.92,-11757.36 32887.08,-11763.6"/>
<text text-anchor="middle" x="32587.5" y="-11818.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu8 -->
<g id="node25" class="node">
<title>l1_attn_stage0_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="31298" cy="-11885.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31298" y="-11896.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="31298" y="-11881.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="31298" y="-11866.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu8 -->
<g id="node41" class="node">
<title>l1_attn_stage1_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="31298" cy="-11738.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31298" y="-11749.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="31298" y="-11734.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="31298" y="-11719.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu8&#45;&gt;l1_attn_stage1_gpu8 -->
<g id="edge25" class="edge">
<title>l1_attn_stage0_gpu8&#45;&gt;l1_attn_stage1_gpu8</title>
<path fill="none" stroke="black" d="M31298,-11847.74C31298,-11829.02 31298,-11806.03 31298,-11786.05"/>
<polygon fill="black" stroke="black" points="31301.5,-11785.91 31298,-11775.91 31294.5,-11785.91 31301.5,-11785.91"/>
</g>
<!-- l1_attn_stage0_gpu8&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge2201" class="edge">
<title>l1_attn_stage0_gpu8&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31351.28,-11855.3C31365.42,-11848.96 31380.95,-11843.15 31396,-11839.83 31462.57,-11825.14 32558.69,-11852.45 32623,-11829.83 32633.15,-11826.26 32631.96,-11818.69 32642,-11814.83 32692.3,-11795.49 32710.53,-11819.14 32763,-11806.83 32806.2,-11796.7 32852.67,-11776.25 32884.71,-11760.5"/>
<polygon fill="red" stroke="red" points="32886.38,-11763.59 32893.77,-11755.99 32883.25,-11757.32 32886.38,-11763.59"/>
<text text-anchor="middle" x="32673.5" y="-11818.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu9 -->
<g id="node26" class="node">
<title>l1_attn_stage0_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="31493" cy="-11885.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31493" y="-11896.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="31493" y="-11881.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="31493" y="-11866.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu9 -->
<g id="node42" class="node">
<title>l1_attn_stage1_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="31493" cy="-11738.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31493" y="-11749.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="31493" y="-11734.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="31493" y="-11719.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu9&#45;&gt;l1_attn_stage1_gpu9 -->
<g id="edge26" class="edge">
<title>l1_attn_stage0_gpu9&#45;&gt;l1_attn_stage1_gpu9</title>
<path fill="none" stroke="black" d="M31493,-11847.74C31493,-11829.02 31493,-11806.03 31493,-11786.05"/>
<polygon fill="black" stroke="black" points="31496.5,-11785.91 31493,-11775.91 31489.5,-11785.91 31496.5,-11785.91"/>
</g>
<!-- l1_attn_stage0_gpu9&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge2202" class="edge">
<title>l1_attn_stage0_gpu9&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31546.28,-11855.3C31560.42,-11848.96 31575.95,-11843.16 31591,-11839.83 31651.65,-11826.42 32650.41,-11850.46 32709,-11829.83 32719.15,-11826.26 32718.3,-11819.48 32728,-11814.83 32742.39,-11807.94 32747.8,-11811.7 32763,-11806.83 32803.94,-11793.73 32848.95,-11774.57 32881.12,-11760.01"/>
<polygon fill="red" stroke="red" points="32882.61,-11763.17 32890.25,-11755.84 32879.7,-11756.81 32882.61,-11763.17"/>
<text text-anchor="middle" x="32759.5" y="-11818.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu10 -->
<g id="node27" class="node">
<title>l1_attn_stage0_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="31688" cy="-11885.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31688" y="-11896.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="31688" y="-11881.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="31688" y="-11866.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu10 -->
<g id="node43" class="node">
<title>l1_attn_stage1_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="31688" cy="-11738.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31688" y="-11749.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="31688" y="-11734.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="31688" y="-11719.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu10&#45;&gt;l1_attn_stage1_gpu10 -->
<g id="edge27" class="edge">
<title>l1_attn_stage0_gpu10&#45;&gt;l1_attn_stage1_gpu10</title>
<path fill="none" stroke="black" d="M31688,-11847.74C31688,-11829.02 31688,-11806.03 31688,-11786.05"/>
<polygon fill="black" stroke="black" points="31691.5,-11785.91 31688,-11775.91 31684.5,-11785.91 31691.5,-11785.91"/>
</g>
<!-- l1_attn_stage0_gpu10&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge2203" class="edge">
<title>l1_attn_stage0_gpu10&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31741.29,-11855.31C31755.42,-11848.97 31770.95,-11843.17 31786,-11839.83 31840.73,-11827.7 32742.13,-11848.48 32795,-11829.83 32805.15,-11826.25 32805.32,-11821.19 32814,-11814.83 32839.22,-11796.34 32868.5,-11776.49 32890.65,-11761.78"/>
<polygon fill="red" stroke="red" points="32892.66,-11764.65 32899.07,-11756.22 32888.8,-11758.81 32892.66,-11764.65"/>
<text text-anchor="middle" x="32845.5" y="-11818.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu11 -->
<g id="node28" class="node">
<title>l1_attn_stage0_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="31883" cy="-11885.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31883" y="-11896.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="31883" y="-11881.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="31883" y="-11866.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu11 -->
<g id="node44" class="node">
<title>l1_attn_stage1_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="31883" cy="-11738.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31883" y="-11749.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="31883" y="-11734.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="31883" y="-11719.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu11&#45;&gt;l1_attn_stage1_gpu11 -->
<g id="edge28" class="edge">
<title>l1_attn_stage0_gpu11&#45;&gt;l1_attn_stage1_gpu11</title>
<path fill="none" stroke="black" d="M31883,-11847.74C31883,-11829.02 31883,-11806.03 31883,-11786.05"/>
<polygon fill="black" stroke="black" points="31886.5,-11785.91 31883,-11775.91 31879.5,-11785.91 31886.5,-11785.91"/>
</g>
<!-- l1_attn_stage0_gpu11&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge2204" class="edge">
<title>l1_attn_stage0_gpu11&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31936.29,-11855.33C31950.42,-11848.99 31965.95,-11843.18 31981,-11839.83 32005.41,-11834.41 32859.88,-11843.21 32881,-11829.83 32902.94,-11815.93 32914.24,-11787.65 32919.85,-11766.39"/>
<polygon fill="red" stroke="red" points="32923.27,-11767.14 32922.18,-11756.6 32916.46,-11765.52 32923.27,-11767.14"/>
<text text-anchor="middle" x="32927.5" y="-11818.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu12 -->
<g id="node29" class="node">
<title>l1_attn_stage0_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="32078" cy="-11885.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32078" y="-11896.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="32078" y="-11881.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="32078" y="-11866.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu12 -->
<g id="node45" class="node">
<title>l1_attn_stage1_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="32078" cy="-11738.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32078" y="-11749.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="32078" y="-11734.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="32078" y="-11719.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu12&#45;&gt;l1_attn_stage1_gpu12 -->
<g id="edge29" class="edge">
<title>l1_attn_stage0_gpu12&#45;&gt;l1_attn_stage1_gpu12</title>
<path fill="none" stroke="black" d="M32022.85,-11855.87C32009.43,-11849.83 31994.93,-11844.03 31981,-11839.83 31967.22,-11835.68 31926.36,-11840.77 31917,-11829.83 31882.08,-11789.03 31922.79,-11829.15 31981,-11806.83 31998.78,-11800.01 32016.42,-11789.27 32031.68,-11778.34"/>
<polygon fill="black" stroke="black" points="32033.93,-11781.02 32039.9,-11772.27 32029.77,-11775.39 32033.93,-11781.02"/>
</g>
<!-- l1_attn_stage0_gpu12&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge2205" class="edge">
<title>l1_attn_stage0_gpu12&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32131.29,-11855.34C32145.43,-11849 32160.95,-11843.19 32176,-11839.83 32197.45,-11835.05 32951.56,-11845.47 32967,-11829.83 32985.16,-11811.44 32967.89,-11783.75 32950.31,-11763.84"/>
<polygon fill="red" stroke="red" points="32952.75,-11761.32 32943.38,-11756.37 32947.61,-11766.08 32952.75,-11761.32"/>
<text text-anchor="middle" x="33005.5" y="-11818.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu13 -->
<g id="node30" class="node">
<title>l1_attn_stage0_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="32273" cy="-11885.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32273" y="-11896.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="32273" y="-11881.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="32273" y="-11866.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu13 -->
<g id="node46" class="node">
<title>l1_attn_stage1_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="32273" cy="-11738.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32273" y="-11749.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="32273" y="-11734.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="32273" y="-11719.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu13&#45;&gt;l1_attn_stage1_gpu13 -->
<g id="edge30" class="edge">
<title>l1_attn_stage0_gpu13&#45;&gt;l1_attn_stage1_gpu13</title>
<path fill="none" stroke="black" d="M32219.7,-11855.39C32205.85,-11849.13 32190.69,-11843.35 32176,-11839.83 32162.37,-11836.57 31933.71,-11839.93 31924,-11829.83 31919.38,-11825.03 31919.36,-11819.62 31924,-11814.83 31933.75,-11804.77 32162.7,-11811.24 32176,-11806.83 32194.4,-11800.74 32212.44,-11789.94 32227.87,-11778.75"/>
<polygon fill="black" stroke="black" points="32230.27,-11781.33 32236.16,-11772.52 32226.06,-11775.73 32230.27,-11781.33"/>
</g>
<!-- l1_attn_stage0_gpu13&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge2206" class="edge">
<title>l1_attn_stage0_gpu13&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32326.3,-11855.36C32340.43,-11849.02 32355.96,-11843.2 32371,-11839.83 32389.49,-11835.69 33039.7,-11843.33 33053,-11829.83 33081.36,-11801.06 33033.79,-11775.22 32988.82,-11758.6"/>
<polygon fill="red" stroke="red" points="32989.88,-11755.26 32979.29,-11755.19 32987.53,-11761.85 32989.88,-11755.26"/>
<text text-anchor="middle" x="33092.5" y="-11818.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu14 -->
<g id="node31" class="node">
<title>l1_attn_stage0_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="32468" cy="-11885.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32468" y="-11896.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="32468" y="-11881.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="32468" y="-11866.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu14 -->
<g id="node47" class="node">
<title>l1_attn_stage1_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="32468" cy="-11738.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32468" y="-11749.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="32468" y="-11734.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="32468" y="-11719.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu14&#45;&gt;l1_attn_stage1_gpu14 -->
<g id="edge31" class="edge">
<title>l1_attn_stage0_gpu14&#45;&gt;l1_attn_stage1_gpu14</title>
<path fill="none" stroke="black" d="M32414.74,-11855.22C32400.89,-11848.96 32385.71,-11843.22 32371,-11839.83 32347.17,-11834.34 31948.09,-11847.32 31931,-11829.83 31926.34,-11825.06 31926.33,-11819.59 31931,-11814.83 31939.56,-11806.11 32359.37,-11810.6 32371,-11806.83 32389.45,-11800.86 32407.49,-11790.1 32422.92,-11778.9"/>
<polygon fill="black" stroke="black" points="32425.32,-11781.47 32431.2,-11772.66 32421.11,-11775.88 32425.32,-11781.47"/>
</g>
<!-- l1_attn_stage0_gpu14&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge2207" class="edge">
<title>l1_attn_stage0_gpu14&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32521.3,-11855.39C32535.44,-11849.05 32550.96,-11843.22 32566,-11839.83 32581.53,-11836.33 33127.84,-11841.19 33139,-11829.83 33179.03,-11789.09 33109.32,-11765.74 33039.01,-11752.99"/>
<polygon fill="red" stroke="red" points="33039.55,-11749.53 33029.1,-11751.26 33038.35,-11756.43 33039.55,-11749.53"/>
<text text-anchor="middle" x="33179.5" y="-11818.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu15 -->
<g id="node32" class="node">
<title>l1_attn_stage0_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="32663" cy="-11885.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32663" y="-11896.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="32663" y="-11881.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="32663" y="-11866.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu15 -->
<g id="node48" class="node">
<title>l1_attn_stage1_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="32663" cy="-11738.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32663" y="-11749.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="32663" y="-11734.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="32663" y="-11719.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu15&#45;&gt;l1_attn_stage1_gpu15 -->
<g id="edge32" class="edge">
<title>l1_attn_stage0_gpu15&#45;&gt;l1_attn_stage1_gpu15</title>
<path fill="none" stroke="black" d="M32610.02,-11855.26C32596.09,-11848.97 32580.82,-11843.19 32566,-11839.83 32548.99,-11835.97 31950.24,-11842.27 31938,-11829.83 31933.32,-11825.08 31933.32,-11819.58 31938,-11814.83 31950.26,-11802.42 32549.39,-11812.16 32566,-11806.83 32584.46,-11800.91 32602.51,-11790.16 32617.94,-11778.96"/>
<polygon fill="black" stroke="black" points="32620.34,-11781.53 32626.22,-11772.72 32616.13,-11775.94 32620.34,-11781.53"/>
</g>
<!-- l1_attn_stage0_gpu15&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge2208" class="edge">
<title>l1_attn_stage0_gpu15&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32751.34,-11882.15C32901.61,-11877.52 33193.83,-11864.17 33225,-11829.83 33277.01,-11772.54 33178.61,-11750.97 33080.88,-11743.12"/>
<polygon fill="red" stroke="red" points="33081.06,-11739.62 33070.82,-11742.36 33080.53,-11746.6 33081.06,-11739.62"/>
<text text-anchor="middle" x="33264.5" y="-11818.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu0 -->
<g id="node49" class="node">
<title>l1_attn_stage2_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="29738" cy="-11591.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29738" y="-11602.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="29738" y="-11587.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="29738" y="-11572.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu0&#45;&gt;l1_attn_stage2_gpu0 -->
<g id="edge33" class="edge">
<title>l1_attn_stage1_gpu0&#45;&gt;l1_attn_stage2_gpu0</title>
<path fill="none" stroke="black" d="M29738,-11700.74C29738,-11682.02 29738,-11659.03 29738,-11639.05"/>
<polygon fill="black" stroke="black" points="29741.5,-11638.91 29738,-11628.91 29734.5,-11638.91 29741.5,-11638.91"/>
</g>
<!-- l1_attn_stage2_gpu[next_gpu] -->
<g id="node1346" class="node">
<title>l1_attn_stage2_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="32925" cy="-11591.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="32925" y="-11587.63" font-family="Times,serif" font-size="14.00">l1_attn_stage2_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage1_gpu0&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge2209" class="edge">
<title>l1_attn_stage1_gpu0&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29791.29,-11708.33C29805.43,-11701.99 29820.95,-11696.18 29836,-11692.83 30065.73,-11641.7 31718.66,-11670.38 31954,-11667.83 31998.94,-11667.34 32718.97,-11668.86 32763,-11659.83 32806.87,-11650.83 32853.77,-11629.91 32885.76,-11613.73"/>
<polygon fill="red" stroke="red" points="32887.49,-11616.78 32894.78,-11609.09 32884.28,-11610.55 32887.49,-11616.78"/>
<text text-anchor="middle" x="31985.5" y="-11671.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu1 -->
<g id="node50" class="node">
<title>l1_attn_stage2_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="29933" cy="-11591.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29933" y="-11602.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="29933" y="-11587.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="29933" y="-11572.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu1&#45;&gt;l1_attn_stage2_gpu1 -->
<g id="edge34" class="edge">
<title>l1_attn_stage1_gpu1&#45;&gt;l1_attn_stage2_gpu1</title>
<path fill="none" stroke="black" d="M29933,-11700.74C29933,-11682.02 29933,-11659.03 29933,-11639.05"/>
<polygon fill="black" stroke="black" points="29936.5,-11638.91 29933,-11628.91 29929.5,-11638.91 29936.5,-11638.91"/>
</g>
<!-- l1_attn_stage1_gpu1&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge2210" class="edge">
<title>l1_attn_stage1_gpu1&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29986.28,-11708.26C30000.41,-11701.92 30015.94,-11696.13 30031,-11692.83 30085,-11681 31968.82,-11701.09 32021,-11682.83 32031.15,-11679.28 32029.86,-11671.42 32040,-11667.83 32077.87,-11654.45 32723.66,-11667.93 32763,-11659.83 32806.87,-11650.81 32853.77,-11629.89 32885.76,-11613.72"/>
<polygon fill="red" stroke="red" points="32887.48,-11616.76 32894.78,-11609.08 32884.28,-11610.54 32887.48,-11616.76"/>
<text text-anchor="middle" x="32071.5" y="-11671.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu2 -->
<g id="node51" class="node">
<title>l1_attn_stage2_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="30128" cy="-11591.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30128" y="-11602.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="30128" y="-11587.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="30128" y="-11572.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu2&#45;&gt;l1_attn_stage2_gpu2 -->
<g id="edge35" class="edge">
<title>l1_attn_stage1_gpu2&#45;&gt;l1_attn_stage2_gpu2</title>
<path fill="none" stroke="black" d="M30128,-11700.74C30128,-11682.02 30128,-11659.03 30128,-11639.05"/>
<polygon fill="black" stroke="black" points="30131.5,-11638.91 30128,-11628.91 30124.5,-11638.91 30131.5,-11638.91"/>
</g>
<!-- l1_attn_stage1_gpu2&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge2211" class="edge">
<title>l1_attn_stage1_gpu2&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30181.28,-11708.27C30195.41,-11701.93 30210.94,-11696.13 30226,-11692.83 30277.04,-11681.64 32057.68,-11700.1 32107,-11682.83 32117.15,-11679.28 32115.86,-11671.42 32126,-11667.83 32159.36,-11656.01 32728.34,-11666.99 32763,-11659.83 32806.86,-11650.77 32853.76,-11629.86 32885.75,-11613.7"/>
<polygon fill="red" stroke="red" points="32887.48,-11616.75 32894.77,-11609.07 32884.28,-11610.52 32887.48,-11616.75"/>
<text text-anchor="middle" x="32157.5" y="-11671.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu3 -->
<g id="node52" class="node">
<title>l1_attn_stage2_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="30323" cy="-11591.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30323" y="-11602.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="30323" y="-11587.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="30323" y="-11572.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu3&#45;&gt;l1_attn_stage2_gpu3 -->
<g id="edge36" class="edge">
<title>l1_attn_stage1_gpu3&#45;&gt;l1_attn_stage2_gpu3</title>
<path fill="none" stroke="black" d="M30323,-11700.74C30323,-11682.02 30323,-11659.03 30323,-11639.05"/>
<polygon fill="black" stroke="black" points="30326.5,-11638.91 30323,-11628.91 30319.5,-11638.91 30326.5,-11638.91"/>
</g>
<!-- l1_attn_stage1_gpu3&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge2212" class="edge">
<title>l1_attn_stage1_gpu3&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30376.28,-11708.27C30390.41,-11701.93 30405.94,-11696.13 30421,-11692.83 30469.08,-11682.28 32146.55,-11699.11 32193,-11682.83 32203.15,-11679.27 32201.86,-11671.43 32212,-11667.83 32240.85,-11657.58 32733.02,-11666.05 32763,-11659.83 32806.85,-11650.73 32853.75,-11629.83 32885.75,-11613.67"/>
<polygon fill="red" stroke="red" points="32887.47,-11616.73 32894.77,-11609.05 32884.27,-11610.5 32887.47,-11616.73"/>
<text text-anchor="middle" x="32243.5" y="-11671.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu4 -->
<g id="node53" class="node">
<title>l1_attn_stage2_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="30518" cy="-11591.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30518" y="-11602.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="30518" y="-11587.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="30518" y="-11572.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu4&#45;&gt;l1_attn_stage2_gpu4 -->
<g id="edge37" class="edge">
<title>l1_attn_stage1_gpu4&#45;&gt;l1_attn_stage2_gpu4</title>
<path fill="none" stroke="black" d="M30518,-11700.74C30518,-11682.02 30518,-11659.03 30518,-11639.05"/>
<polygon fill="black" stroke="black" points="30521.5,-11638.91 30518,-11628.91 30514.5,-11638.91 30521.5,-11638.91"/>
</g>
<!-- l1_attn_stage1_gpu4&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge2213" class="edge">
<title>l1_attn_stage1_gpu4&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30571.28,-11708.27C30585.41,-11701.93 30600.94,-11696.14 30616,-11692.83 30661.12,-11682.93 32235.41,-11698.11 32279,-11682.83 32289.15,-11679.27 32287.87,-11671.45 32298,-11667.83 32346.67,-11650.47 32712.42,-11670.4 32763,-11659.83 32806.84,-11650.67 32853.74,-11629.78 32885.74,-11613.64"/>
<polygon fill="red" stroke="red" points="32887.46,-11616.7 32894.76,-11609.02 32884.27,-11610.47 32887.46,-11616.7"/>
<text text-anchor="middle" x="32329.5" y="-11671.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu5 -->
<g id="node54" class="node">
<title>l1_attn_stage2_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="30713" cy="-11591.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30713" y="-11602.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="30713" y="-11587.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="30713" y="-11572.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu5&#45;&gt;l1_attn_stage2_gpu5 -->
<g id="edge38" class="edge">
<title>l1_attn_stage1_gpu5&#45;&gt;l1_attn_stage2_gpu5</title>
<path fill="none" stroke="black" d="M30713,-11700.74C30713,-11682.02 30713,-11659.03 30713,-11639.05"/>
<polygon fill="black" stroke="black" points="30716.5,-11638.91 30713,-11628.91 30709.5,-11638.91 30716.5,-11638.91"/>
</g>
<!-- l1_attn_stage1_gpu5&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge2214" class="edge">
<title>l1_attn_stage1_gpu5&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30766.28,-11708.28C30780.41,-11701.94 30795.94,-11696.14 30811,-11692.83 30853.16,-11683.57 32324.27,-11697.12 32365,-11682.83 32375.15,-11679.27 32373.87,-11671.47 32384,-11667.83 32423.64,-11653.6 32721.79,-11668.53 32763,-11659.83 32806.82,-11650.59 32853.73,-11629.7 32885.73,-11613.6"/>
<polygon fill="red" stroke="red" points="32887.45,-11616.65 32894.75,-11608.98 32884.26,-11610.42 32887.45,-11616.65"/>
<text text-anchor="middle" x="32415.5" y="-11671.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu6 -->
<g id="node55" class="node">
<title>l1_attn_stage2_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="30908" cy="-11591.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30908" y="-11602.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="30908" y="-11587.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="30908" y="-11572.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu6&#45;&gt;l1_attn_stage2_gpu6 -->
<g id="edge39" class="edge">
<title>l1_attn_stage1_gpu6&#45;&gt;l1_attn_stage2_gpu6</title>
<path fill="none" stroke="black" d="M30908,-11700.74C30908,-11682.02 30908,-11659.03 30908,-11639.05"/>
<polygon fill="black" stroke="black" points="30911.5,-11638.91 30908,-11628.91 30904.5,-11638.91 30911.5,-11638.91"/>
</g>
<!-- l1_attn_stage1_gpu6&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge2215" class="edge">
<title>l1_attn_stage1_gpu6&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30961.28,-11708.28C30975.41,-11701.94 30990.94,-11696.14 31006,-11692.83 31045.2,-11684.21 32413.13,-11696.13 32451,-11682.83 32461.15,-11679.27 32459.89,-11671.5 32470,-11667.83 32500.62,-11656.73 32731.15,-11666.65 32763,-11659.83 32806.66,-11650.48 32853.41,-11629.72 32885.42,-11613.67"/>
<polygon fill="red" stroke="red" points="32887.12,-11616.73 32894.45,-11609.07 32883.95,-11610.49 32887.12,-11616.73"/>
<text text-anchor="middle" x="32501.5" y="-11671.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu7 -->
<g id="node56" class="node">
<title>l1_attn_stage2_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="31103" cy="-11591.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31103" y="-11602.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="31103" y="-11587.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="31103" y="-11572.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu7&#45;&gt;l1_attn_stage2_gpu7 -->
<g id="edge40" class="edge">
<title>l1_attn_stage1_gpu7&#45;&gt;l1_attn_stage2_gpu7</title>
<path fill="none" stroke="black" d="M31103,-11700.74C31103,-11682.02 31103,-11659.03 31103,-11639.05"/>
<polygon fill="black" stroke="black" points="31106.5,-11638.91 31103,-11628.91 31099.5,-11638.91 31106.5,-11638.91"/>
</g>
<!-- l1_attn_stage1_gpu7&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge2216" class="edge">
<title>l1_attn_stage1_gpu7&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31156.28,-11708.29C31170.42,-11701.95 31185.95,-11696.15 31201,-11692.83 31237.24,-11684.85 32501.99,-11695.13 32537,-11682.83 32547.15,-11679.27 32545.91,-11671.56 32556,-11667.83 32599.19,-11651.9 32718.04,-11669.73 32763,-11659.83 32806.6,-11650.23 32853.37,-11629.51 32885.39,-11613.54"/>
<polygon fill="red" stroke="red" points="32887.08,-11616.6 32894.42,-11608.96 32883.92,-11610.36 32887.08,-11616.6"/>
<text text-anchor="middle" x="32587.5" y="-11671.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu8 -->
<g id="node57" class="node">
<title>l1_attn_stage2_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="31298" cy="-11591.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31298" y="-11602.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="31298" y="-11587.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="31298" y="-11572.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu8&#45;&gt;l1_attn_stage2_gpu8 -->
<g id="edge41" class="edge">
<title>l1_attn_stage1_gpu8&#45;&gt;l1_attn_stage2_gpu8</title>
<path fill="none" stroke="black" d="M31298,-11700.74C31298,-11682.02 31298,-11659.03 31298,-11639.05"/>
<polygon fill="black" stroke="black" points="31301.5,-11638.91 31298,-11628.91 31294.5,-11638.91 31301.5,-11638.91"/>
</g>
<!-- l1_attn_stage1_gpu8&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge2217" class="edge">
<title>l1_attn_stage1_gpu8&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31351.28,-11708.3C31365.42,-11701.96 31380.95,-11696.15 31396,-11692.83 31462.57,-11678.14 32558.69,-11705.45 32623,-11682.83 32633.15,-11679.26 32631.96,-11671.69 32642,-11667.83 32692.3,-11648.49 32710.53,-11672.14 32763,-11659.83 32806.2,-11649.7 32852.67,-11629.25 32884.71,-11613.5"/>
<polygon fill="red" stroke="red" points="32886.38,-11616.59 32893.77,-11608.99 32883.25,-11610.32 32886.38,-11616.59"/>
<text text-anchor="middle" x="32673.5" y="-11671.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu9 -->
<g id="node58" class="node">
<title>l1_attn_stage2_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="31493" cy="-11591.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31493" y="-11602.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="31493" y="-11587.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="31493" y="-11572.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu9&#45;&gt;l1_attn_stage2_gpu9 -->
<g id="edge42" class="edge">
<title>l1_attn_stage1_gpu9&#45;&gt;l1_attn_stage2_gpu9</title>
<path fill="none" stroke="black" d="M31493,-11700.74C31493,-11682.02 31493,-11659.03 31493,-11639.05"/>
<polygon fill="black" stroke="black" points="31496.5,-11638.91 31493,-11628.91 31489.5,-11638.91 31496.5,-11638.91"/>
</g>
<!-- l1_attn_stage1_gpu9&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge2218" class="edge">
<title>l1_attn_stage1_gpu9&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31546.28,-11708.3C31560.42,-11701.96 31575.95,-11696.16 31591,-11692.83 31651.65,-11679.42 32650.41,-11703.46 32709,-11682.83 32719.15,-11679.26 32718.3,-11672.48 32728,-11667.83 32742.39,-11660.94 32747.8,-11664.7 32763,-11659.83 32803.94,-11646.73 32848.95,-11627.57 32881.12,-11613.01"/>
<polygon fill="red" stroke="red" points="32882.61,-11616.17 32890.25,-11608.84 32879.7,-11609.81 32882.61,-11616.17"/>
<text text-anchor="middle" x="32759.5" y="-11671.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu10 -->
<g id="node59" class="node">
<title>l1_attn_stage2_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="31688" cy="-11591.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31688" y="-11602.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="31688" y="-11587.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="31688" y="-11572.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu10&#45;&gt;l1_attn_stage2_gpu10 -->
<g id="edge43" class="edge">
<title>l1_attn_stage1_gpu10&#45;&gt;l1_attn_stage2_gpu10</title>
<path fill="none" stroke="black" d="M31688,-11700.74C31688,-11682.02 31688,-11659.03 31688,-11639.05"/>
<polygon fill="black" stroke="black" points="31691.5,-11638.91 31688,-11628.91 31684.5,-11638.91 31691.5,-11638.91"/>
</g>
<!-- l1_attn_stage1_gpu10&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge2219" class="edge">
<title>l1_attn_stage1_gpu10&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31741.29,-11708.31C31755.42,-11701.97 31770.95,-11696.17 31786,-11692.83 31840.73,-11680.7 32742.13,-11701.48 32795,-11682.83 32805.15,-11679.25 32805.32,-11674.19 32814,-11667.83 32839.22,-11649.34 32868.5,-11629.49 32890.65,-11614.78"/>
<polygon fill="red" stroke="red" points="32892.66,-11617.65 32899.07,-11609.22 32888.8,-11611.81 32892.66,-11617.65"/>
<text text-anchor="middle" x="32845.5" y="-11671.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu11 -->
<g id="node60" class="node">
<title>l1_attn_stage2_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="31883" cy="-11591.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31883" y="-11602.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="31883" y="-11587.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="31883" y="-11572.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu11&#45;&gt;l1_attn_stage2_gpu11 -->
<g id="edge44" class="edge">
<title>l1_attn_stage1_gpu11&#45;&gt;l1_attn_stage2_gpu11</title>
<path fill="none" stroke="black" d="M31883,-11700.74C31883,-11682.02 31883,-11659.03 31883,-11639.05"/>
<polygon fill="black" stroke="black" points="31886.5,-11638.91 31883,-11628.91 31879.5,-11638.91 31886.5,-11638.91"/>
</g>
<!-- l1_attn_stage1_gpu11&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge2220" class="edge">
<title>l1_attn_stage1_gpu11&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31936.29,-11708.33C31950.42,-11701.99 31965.95,-11696.18 31981,-11692.83 32005.41,-11687.41 32859.88,-11696.21 32881,-11682.83 32902.94,-11668.93 32914.24,-11640.65 32919.85,-11619.39"/>
<polygon fill="red" stroke="red" points="32923.27,-11620.14 32922.18,-11609.6 32916.46,-11618.52 32923.27,-11620.14"/>
<text text-anchor="middle" x="32927.5" y="-11671.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu12 -->
<g id="node61" class="node">
<title>l1_attn_stage2_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="32078" cy="-11591.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32078" y="-11602.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="32078" y="-11587.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="32078" y="-11572.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu12&#45;&gt;l1_attn_stage2_gpu12 -->
<g id="edge45" class="edge">
<title>l1_attn_stage1_gpu12&#45;&gt;l1_attn_stage2_gpu12</title>
<path fill="none" stroke="black" d="M32022.85,-11708.87C32009.43,-11702.83 31994.93,-11697.03 31981,-11692.83 31967.22,-11688.68 31926.36,-11693.77 31917,-11682.83 31882.08,-11642.03 31922.79,-11682.15 31981,-11659.83 31998.78,-11653.01 32016.42,-11642.27 32031.68,-11631.34"/>
<polygon fill="black" stroke="black" points="32033.93,-11634.02 32039.9,-11625.27 32029.77,-11628.39 32033.93,-11634.02"/>
</g>
<!-- l1_attn_stage1_gpu12&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge2221" class="edge">
<title>l1_attn_stage1_gpu12&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32131.29,-11708.34C32145.43,-11702 32160.95,-11696.19 32176,-11692.83 32197.45,-11688.05 32951.56,-11698.47 32967,-11682.83 32985.16,-11664.44 32967.89,-11636.75 32950.31,-11616.84"/>
<polygon fill="red" stroke="red" points="32952.75,-11614.32 32943.38,-11609.37 32947.61,-11619.08 32952.75,-11614.32"/>
<text text-anchor="middle" x="33005.5" y="-11671.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu13 -->
<g id="node62" class="node">
<title>l1_attn_stage2_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="32273" cy="-11591.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32273" y="-11602.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="32273" y="-11587.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="32273" y="-11572.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu13&#45;&gt;l1_attn_stage2_gpu13 -->
<g id="edge46" class="edge">
<title>l1_attn_stage1_gpu13&#45;&gt;l1_attn_stage2_gpu13</title>
<path fill="none" stroke="black" d="M32219.7,-11708.39C32205.85,-11702.13 32190.69,-11696.35 32176,-11692.83 32162.37,-11689.57 31933.71,-11692.93 31924,-11682.83 31919.38,-11678.03 31919.36,-11672.62 31924,-11667.83 31933.75,-11657.77 32162.7,-11664.24 32176,-11659.83 32194.4,-11653.74 32212.44,-11642.94 32227.87,-11631.75"/>
<polygon fill="black" stroke="black" points="32230.27,-11634.33 32236.16,-11625.52 32226.06,-11628.73 32230.27,-11634.33"/>
</g>
<!-- l1_attn_stage1_gpu13&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge2222" class="edge">
<title>l1_attn_stage1_gpu13&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32326.3,-11708.36C32340.43,-11702.02 32355.96,-11696.2 32371,-11692.83 32389.49,-11688.69 33039.7,-11696.33 33053,-11682.83 33081.36,-11654.06 33033.79,-11628.22 32988.82,-11611.6"/>
<polygon fill="red" stroke="red" points="32989.88,-11608.26 32979.29,-11608.19 32987.53,-11614.85 32989.88,-11608.26"/>
<text text-anchor="middle" x="33092.5" y="-11671.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu14 -->
<g id="node63" class="node">
<title>l1_attn_stage2_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="32468" cy="-11591.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32468" y="-11602.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="32468" y="-11587.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="32468" y="-11572.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu14&#45;&gt;l1_attn_stage2_gpu14 -->
<g id="edge47" class="edge">
<title>l1_attn_stage1_gpu14&#45;&gt;l1_attn_stage2_gpu14</title>
<path fill="none" stroke="black" d="M32414.74,-11708.22C32400.89,-11701.96 32385.71,-11696.22 32371,-11692.83 32347.17,-11687.34 31948.09,-11700.32 31931,-11682.83 31926.34,-11678.06 31926.33,-11672.59 31931,-11667.83 31939.56,-11659.11 32359.37,-11663.6 32371,-11659.83 32389.45,-11653.86 32407.49,-11643.1 32422.92,-11631.9"/>
<polygon fill="black" stroke="black" points="32425.32,-11634.47 32431.2,-11625.66 32421.11,-11628.88 32425.32,-11634.47"/>
</g>
<!-- l1_attn_stage1_gpu14&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge2223" class="edge">
<title>l1_attn_stage1_gpu14&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32521.3,-11708.39C32535.44,-11702.05 32550.96,-11696.22 32566,-11692.83 32581.53,-11689.33 33127.84,-11694.19 33139,-11682.83 33179.03,-11642.09 33109.32,-11618.74 33039.01,-11605.99"/>
<polygon fill="red" stroke="red" points="33039.55,-11602.53 33029.1,-11604.26 33038.35,-11609.43 33039.55,-11602.53"/>
<text text-anchor="middle" x="33179.5" y="-11671.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu15 -->
<g id="node64" class="node">
<title>l1_attn_stage2_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="32663" cy="-11591.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32663" y="-11602.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="32663" y="-11587.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="32663" y="-11572.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu15&#45;&gt;l1_attn_stage2_gpu15 -->
<g id="edge48" class="edge">
<title>l1_attn_stage1_gpu15&#45;&gt;l1_attn_stage2_gpu15</title>
<path fill="none" stroke="black" d="M32610.02,-11708.26C32596.09,-11701.97 32580.82,-11696.19 32566,-11692.83 32548.99,-11688.97 31950.24,-11695.27 31938,-11682.83 31933.32,-11678.08 31933.32,-11672.58 31938,-11667.83 31950.26,-11655.42 32549.39,-11665.16 32566,-11659.83 32584.46,-11653.91 32602.51,-11643.16 32617.94,-11631.96"/>
<polygon fill="black" stroke="black" points="32620.34,-11634.53 32626.22,-11625.72 32616.13,-11628.94 32620.34,-11634.53"/>
</g>
<!-- l1_attn_stage1_gpu15&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge2224" class="edge">
<title>l1_attn_stage1_gpu15&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32718.38,-11709.02C32733.74,-11702.45 32750.68,-11696.36 32767,-11692.83 32791.87,-11687.45 33207.2,-11701.02 33225,-11682.83 33279.67,-11626.96 33178.45,-11605.29 33079.12,-11597.04"/>
<polygon fill="red" stroke="red" points="33079.15,-11593.53 33068.9,-11596.24 33078.6,-11600.51 33079.15,-11593.53"/>
<text text-anchor="middle" x="33265.5" y="-11671.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu0 -->
<g id="node65" class="node">
<title>l1_attn_stage3_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="29738" cy="-11444.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29738" y="-11455.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="29738" y="-11440.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="29738" y="-11425.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu0&#45;&gt;l1_attn_stage3_gpu0 -->
<g id="edge49" class="edge">
<title>l1_attn_stage2_gpu0&#45;&gt;l1_attn_stage3_gpu0</title>
<path fill="none" stroke="black" d="M29738,-11553.74C29738,-11535.02 29738,-11512.03 29738,-11492.05"/>
<polygon fill="black" stroke="black" points="29741.5,-11491.91 29738,-11481.91 29734.5,-11491.91 29741.5,-11491.91"/>
</g>
<!-- l1_attn_stage3_gpu[next_gpu] -->
<g id="node1347" class="node">
<title>l1_attn_stage3_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="32925" cy="-11444.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="32925" y="-11440.63" font-family="Times,serif" font-size="14.00">l1_attn_stage3_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage2_gpu0&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge2225" class="edge">
<title>l1_attn_stage2_gpu0&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29791.29,-11561.33C29805.43,-11554.99 29820.95,-11549.18 29836,-11545.83 30065.73,-11494.7 31718.66,-11523.38 31954,-11520.83 31998.94,-11520.34 32718.97,-11521.86 32763,-11512.83 32806.87,-11503.83 32853.77,-11482.91 32885.76,-11466.73"/>
<polygon fill="red" stroke="red" points="32887.49,-11469.78 32894.78,-11462.09 32884.28,-11463.55 32887.49,-11469.78"/>
<text text-anchor="middle" x="31985.5" y="-11524.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu1 -->
<g id="node66" class="node">
<title>l1_attn_stage3_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="29933" cy="-11444.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29933" y="-11455.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="29933" y="-11440.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="29933" y="-11425.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu1&#45;&gt;l1_attn_stage3_gpu1 -->
<g id="edge50" class="edge">
<title>l1_attn_stage2_gpu1&#45;&gt;l1_attn_stage3_gpu1</title>
<path fill="none" stroke="black" d="M29933,-11553.74C29933,-11535.02 29933,-11512.03 29933,-11492.05"/>
<polygon fill="black" stroke="black" points="29936.5,-11491.91 29933,-11481.91 29929.5,-11491.91 29936.5,-11491.91"/>
</g>
<!-- l1_attn_stage2_gpu1&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge2226" class="edge">
<title>l1_attn_stage2_gpu1&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29986.28,-11561.26C30000.41,-11554.92 30015.94,-11549.13 30031,-11545.83 30085,-11534 31968.82,-11554.09 32021,-11535.83 32031.15,-11532.28 32029.86,-11524.42 32040,-11520.83 32077.87,-11507.45 32723.66,-11520.93 32763,-11512.83 32806.87,-11503.81 32853.77,-11482.89 32885.76,-11466.72"/>
<polygon fill="red" stroke="red" points="32887.48,-11469.76 32894.78,-11462.08 32884.28,-11463.54 32887.48,-11469.76"/>
<text text-anchor="middle" x="32071.5" y="-11524.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu2 -->
<g id="node67" class="node">
<title>l1_attn_stage3_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="30128" cy="-11444.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30128" y="-11455.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="30128" y="-11440.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="30128" y="-11425.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu2&#45;&gt;l1_attn_stage3_gpu2 -->
<g id="edge51" class="edge">
<title>l1_attn_stage2_gpu2&#45;&gt;l1_attn_stage3_gpu2</title>
<path fill="none" stroke="black" d="M30128,-11553.74C30128,-11535.02 30128,-11512.03 30128,-11492.05"/>
<polygon fill="black" stroke="black" points="30131.5,-11491.91 30128,-11481.91 30124.5,-11491.91 30131.5,-11491.91"/>
</g>
<!-- l1_attn_stage2_gpu2&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge2227" class="edge">
<title>l1_attn_stage2_gpu2&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30181.28,-11561.27C30195.41,-11554.93 30210.94,-11549.13 30226,-11545.83 30277.04,-11534.64 32057.68,-11553.1 32107,-11535.83 32117.15,-11532.28 32115.86,-11524.42 32126,-11520.83 32159.36,-11509.01 32728.34,-11519.99 32763,-11512.83 32806.86,-11503.77 32853.76,-11482.86 32885.75,-11466.7"/>
<polygon fill="red" stroke="red" points="32887.48,-11469.75 32894.77,-11462.07 32884.28,-11463.52 32887.48,-11469.75"/>
<text text-anchor="middle" x="32157.5" y="-11524.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu3 -->
<g id="node68" class="node">
<title>l1_attn_stage3_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="30323" cy="-11444.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30323" y="-11455.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="30323" y="-11440.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="30323" y="-11425.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu3&#45;&gt;l1_attn_stage3_gpu3 -->
<g id="edge52" class="edge">
<title>l1_attn_stage2_gpu3&#45;&gt;l1_attn_stage3_gpu3</title>
<path fill="none" stroke="black" d="M30323,-11553.74C30323,-11535.02 30323,-11512.03 30323,-11492.05"/>
<polygon fill="black" stroke="black" points="30326.5,-11491.91 30323,-11481.91 30319.5,-11491.91 30326.5,-11491.91"/>
</g>
<!-- l1_attn_stage2_gpu3&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge2228" class="edge">
<title>l1_attn_stage2_gpu3&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30376.28,-11561.27C30390.41,-11554.93 30405.94,-11549.13 30421,-11545.83 30469.08,-11535.28 32146.55,-11552.11 32193,-11535.83 32203.15,-11532.27 32201.86,-11524.43 32212,-11520.83 32240.85,-11510.58 32733.02,-11519.05 32763,-11512.83 32806.85,-11503.73 32853.75,-11482.83 32885.75,-11466.67"/>
<polygon fill="red" stroke="red" points="32887.47,-11469.73 32894.77,-11462.05 32884.27,-11463.5 32887.47,-11469.73"/>
<text text-anchor="middle" x="32243.5" y="-11524.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu4 -->
<g id="node69" class="node">
<title>l1_attn_stage3_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="30518" cy="-11444.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30518" y="-11455.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="30518" y="-11440.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="30518" y="-11425.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu4&#45;&gt;l1_attn_stage3_gpu4 -->
<g id="edge53" class="edge">
<title>l1_attn_stage2_gpu4&#45;&gt;l1_attn_stage3_gpu4</title>
<path fill="none" stroke="black" d="M30518,-11553.74C30518,-11535.02 30518,-11512.03 30518,-11492.05"/>
<polygon fill="black" stroke="black" points="30521.5,-11491.91 30518,-11481.91 30514.5,-11491.91 30521.5,-11491.91"/>
</g>
<!-- l1_attn_stage2_gpu4&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge2229" class="edge">
<title>l1_attn_stage2_gpu4&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30571.28,-11561.27C30585.41,-11554.93 30600.94,-11549.14 30616,-11545.83 30661.12,-11535.93 32235.41,-11551.11 32279,-11535.83 32289.15,-11532.27 32287.87,-11524.45 32298,-11520.83 32346.67,-11503.47 32712.42,-11523.4 32763,-11512.83 32806.84,-11503.67 32853.74,-11482.78 32885.74,-11466.64"/>
<polygon fill="red" stroke="red" points="32887.46,-11469.7 32894.76,-11462.02 32884.27,-11463.47 32887.46,-11469.7"/>
<text text-anchor="middle" x="32329.5" y="-11524.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu5 -->
<g id="node70" class="node">
<title>l1_attn_stage3_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="30713" cy="-11444.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30713" y="-11455.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="30713" y="-11440.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="30713" y="-11425.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu5&#45;&gt;l1_attn_stage3_gpu5 -->
<g id="edge54" class="edge">
<title>l1_attn_stage2_gpu5&#45;&gt;l1_attn_stage3_gpu5</title>
<path fill="none" stroke="black" d="M30713,-11553.74C30713,-11535.02 30713,-11512.03 30713,-11492.05"/>
<polygon fill="black" stroke="black" points="30716.5,-11491.91 30713,-11481.91 30709.5,-11491.91 30716.5,-11491.91"/>
</g>
<!-- l1_attn_stage2_gpu5&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge2230" class="edge">
<title>l1_attn_stage2_gpu5&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30766.28,-11561.28C30780.41,-11554.94 30795.94,-11549.14 30811,-11545.83 30853.16,-11536.57 32324.27,-11550.12 32365,-11535.83 32375.15,-11532.27 32373.87,-11524.47 32384,-11520.83 32423.64,-11506.6 32721.79,-11521.53 32763,-11512.83 32806.82,-11503.59 32853.73,-11482.7 32885.73,-11466.6"/>
<polygon fill="red" stroke="red" points="32887.45,-11469.65 32894.75,-11461.98 32884.26,-11463.42 32887.45,-11469.65"/>
<text text-anchor="middle" x="32415.5" y="-11524.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu6 -->
<g id="node71" class="node">
<title>l1_attn_stage3_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="30908" cy="-11444.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30908" y="-11455.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="30908" y="-11440.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="30908" y="-11425.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu6&#45;&gt;l1_attn_stage3_gpu6 -->
<g id="edge55" class="edge">
<title>l1_attn_stage2_gpu6&#45;&gt;l1_attn_stage3_gpu6</title>
<path fill="none" stroke="black" d="M30908,-11553.74C30908,-11535.02 30908,-11512.03 30908,-11492.05"/>
<polygon fill="black" stroke="black" points="30911.5,-11491.91 30908,-11481.91 30904.5,-11491.91 30911.5,-11491.91"/>
</g>
<!-- l1_attn_stage2_gpu6&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge2231" class="edge">
<title>l1_attn_stage2_gpu6&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30961.28,-11561.28C30975.41,-11554.94 30990.94,-11549.14 31006,-11545.83 31045.2,-11537.21 32413.13,-11549.13 32451,-11535.83 32461.15,-11532.27 32459.89,-11524.5 32470,-11520.83 32500.62,-11509.73 32731.15,-11519.65 32763,-11512.83 32806.66,-11503.48 32853.41,-11482.72 32885.42,-11466.67"/>
<polygon fill="red" stroke="red" points="32887.12,-11469.73 32894.45,-11462.07 32883.95,-11463.49 32887.12,-11469.73"/>
<text text-anchor="middle" x="32501.5" y="-11524.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu7 -->
<g id="node72" class="node">
<title>l1_attn_stage3_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="31103" cy="-11444.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31103" y="-11455.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="31103" y="-11440.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="31103" y="-11425.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu7&#45;&gt;l1_attn_stage3_gpu7 -->
<g id="edge56" class="edge">
<title>l1_attn_stage2_gpu7&#45;&gt;l1_attn_stage3_gpu7</title>
<path fill="none" stroke="black" d="M31103,-11553.74C31103,-11535.02 31103,-11512.03 31103,-11492.05"/>
<polygon fill="black" stroke="black" points="31106.5,-11491.91 31103,-11481.91 31099.5,-11491.91 31106.5,-11491.91"/>
</g>
<!-- l1_attn_stage2_gpu7&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge2232" class="edge">
<title>l1_attn_stage2_gpu7&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31156.28,-11561.29C31170.42,-11554.95 31185.95,-11549.15 31201,-11545.83 31237.24,-11537.85 32501.99,-11548.13 32537,-11535.83 32547.15,-11532.27 32545.91,-11524.56 32556,-11520.83 32599.19,-11504.9 32718.04,-11522.73 32763,-11512.83 32806.6,-11503.23 32853.37,-11482.51 32885.39,-11466.54"/>
<polygon fill="red" stroke="red" points="32887.08,-11469.6 32894.42,-11461.96 32883.92,-11463.36 32887.08,-11469.6"/>
<text text-anchor="middle" x="32587.5" y="-11524.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu8 -->
<g id="node73" class="node">
<title>l1_attn_stage3_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="31298" cy="-11444.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31298" y="-11455.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="31298" y="-11440.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="31298" y="-11425.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu8&#45;&gt;l1_attn_stage3_gpu8 -->
<g id="edge57" class="edge">
<title>l1_attn_stage2_gpu8&#45;&gt;l1_attn_stage3_gpu8</title>
<path fill="none" stroke="black" d="M31298,-11553.74C31298,-11535.02 31298,-11512.03 31298,-11492.05"/>
<polygon fill="black" stroke="black" points="31301.5,-11491.91 31298,-11481.91 31294.5,-11491.91 31301.5,-11491.91"/>
</g>
<!-- l1_attn_stage2_gpu8&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge2233" class="edge">
<title>l1_attn_stage2_gpu8&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31351.28,-11561.3C31365.42,-11554.96 31380.95,-11549.15 31396,-11545.83 31462.57,-11531.14 32558.69,-11558.45 32623,-11535.83 32633.15,-11532.26 32631.96,-11524.69 32642,-11520.83 32692.3,-11501.49 32710.53,-11525.14 32763,-11512.83 32806.2,-11502.7 32852.67,-11482.25 32884.71,-11466.5"/>
<polygon fill="red" stroke="red" points="32886.38,-11469.59 32893.77,-11461.99 32883.25,-11463.32 32886.38,-11469.59"/>
<text text-anchor="middle" x="32673.5" y="-11524.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu9 -->
<g id="node74" class="node">
<title>l1_attn_stage3_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="31493" cy="-11444.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31493" y="-11455.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="31493" y="-11440.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="31493" y="-11425.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu9&#45;&gt;l1_attn_stage3_gpu9 -->
<g id="edge58" class="edge">
<title>l1_attn_stage2_gpu9&#45;&gt;l1_attn_stage3_gpu9</title>
<path fill="none" stroke="black" d="M31493,-11553.74C31493,-11535.02 31493,-11512.03 31493,-11492.05"/>
<polygon fill="black" stroke="black" points="31496.5,-11491.91 31493,-11481.91 31489.5,-11491.91 31496.5,-11491.91"/>
</g>
<!-- l1_attn_stage2_gpu9&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge2234" class="edge">
<title>l1_attn_stage2_gpu9&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31546.28,-11561.3C31560.42,-11554.96 31575.95,-11549.16 31591,-11545.83 31651.65,-11532.42 32650.41,-11556.46 32709,-11535.83 32719.15,-11532.26 32718.3,-11525.48 32728,-11520.83 32742.39,-11513.94 32747.8,-11517.7 32763,-11512.83 32803.94,-11499.73 32848.95,-11480.57 32881.12,-11466.01"/>
<polygon fill="red" stroke="red" points="32882.61,-11469.17 32890.25,-11461.84 32879.7,-11462.81 32882.61,-11469.17"/>
<text text-anchor="middle" x="32759.5" y="-11524.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu10 -->
<g id="node75" class="node">
<title>l1_attn_stage3_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="31688" cy="-11444.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31688" y="-11455.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="31688" y="-11440.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="31688" y="-11425.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu10&#45;&gt;l1_attn_stage3_gpu10 -->
<g id="edge59" class="edge">
<title>l1_attn_stage2_gpu10&#45;&gt;l1_attn_stage3_gpu10</title>
<path fill="none" stroke="black" d="M31688,-11553.74C31688,-11535.02 31688,-11512.03 31688,-11492.05"/>
<polygon fill="black" stroke="black" points="31691.5,-11491.91 31688,-11481.91 31684.5,-11491.91 31691.5,-11491.91"/>
</g>
<!-- l1_attn_stage2_gpu10&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge2235" class="edge">
<title>l1_attn_stage2_gpu10&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31741.29,-11561.31C31755.42,-11554.97 31770.95,-11549.17 31786,-11545.83 31840.73,-11533.7 32742.13,-11554.48 32795,-11535.83 32805.15,-11532.25 32805.32,-11527.19 32814,-11520.83 32839.22,-11502.34 32868.5,-11482.49 32890.65,-11467.78"/>
<polygon fill="red" stroke="red" points="32892.66,-11470.65 32899.07,-11462.22 32888.8,-11464.81 32892.66,-11470.65"/>
<text text-anchor="middle" x="32845.5" y="-11524.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu11 -->
<g id="node76" class="node">
<title>l1_attn_stage3_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="31883" cy="-11444.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31883" y="-11455.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="31883" y="-11440.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="31883" y="-11425.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu11&#45;&gt;l1_attn_stage3_gpu11 -->
<g id="edge60" class="edge">
<title>l1_attn_stage2_gpu11&#45;&gt;l1_attn_stage3_gpu11</title>
<path fill="none" stroke="black" d="M31883,-11553.74C31883,-11535.02 31883,-11512.03 31883,-11492.05"/>
<polygon fill="black" stroke="black" points="31886.5,-11491.91 31883,-11481.91 31879.5,-11491.91 31886.5,-11491.91"/>
</g>
<!-- l1_attn_stage2_gpu11&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge2236" class="edge">
<title>l1_attn_stage2_gpu11&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31936.29,-11561.33C31950.42,-11554.99 31965.95,-11549.18 31981,-11545.83 32005.41,-11540.41 32859.88,-11549.21 32881,-11535.83 32902.94,-11521.93 32914.24,-11493.65 32919.85,-11472.39"/>
<polygon fill="red" stroke="red" points="32923.27,-11473.14 32922.18,-11462.6 32916.46,-11471.52 32923.27,-11473.14"/>
<text text-anchor="middle" x="32927.5" y="-11524.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu12 -->
<g id="node77" class="node">
<title>l1_attn_stage3_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="32078" cy="-11444.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32078" y="-11455.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="32078" y="-11440.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="32078" y="-11425.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu12&#45;&gt;l1_attn_stage3_gpu12 -->
<g id="edge61" class="edge">
<title>l1_attn_stage2_gpu12&#45;&gt;l1_attn_stage3_gpu12</title>
<path fill="none" stroke="black" d="M32022.85,-11561.87C32009.43,-11555.83 31994.93,-11550.03 31981,-11545.83 31967.22,-11541.68 31926.36,-11546.77 31917,-11535.83 31882.08,-11495.03 31922.79,-11535.15 31981,-11512.83 31998.78,-11506.01 32016.42,-11495.27 32031.68,-11484.34"/>
<polygon fill="black" stroke="black" points="32033.93,-11487.02 32039.9,-11478.27 32029.77,-11481.39 32033.93,-11487.02"/>
</g>
<!-- l1_attn_stage2_gpu12&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge2237" class="edge">
<title>l1_attn_stage2_gpu12&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32131.29,-11561.34C32145.43,-11555 32160.95,-11549.19 32176,-11545.83 32197.45,-11541.05 32951.56,-11551.47 32967,-11535.83 32985.16,-11517.44 32967.89,-11489.75 32950.31,-11469.84"/>
<polygon fill="red" stroke="red" points="32952.75,-11467.32 32943.38,-11462.37 32947.61,-11472.08 32952.75,-11467.32"/>
<text text-anchor="middle" x="33005.5" y="-11524.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu13 -->
<g id="node78" class="node">
<title>l1_attn_stage3_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="32273" cy="-11444.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32273" y="-11455.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="32273" y="-11440.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="32273" y="-11425.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu13&#45;&gt;l1_attn_stage3_gpu13 -->
<g id="edge62" class="edge">
<title>l1_attn_stage2_gpu13&#45;&gt;l1_attn_stage3_gpu13</title>
<path fill="none" stroke="black" d="M32219.7,-11561.39C32205.85,-11555.13 32190.69,-11549.35 32176,-11545.83 32162.37,-11542.57 31933.71,-11545.93 31924,-11535.83 31919.38,-11531.03 31919.36,-11525.62 31924,-11520.83 31933.75,-11510.77 32162.7,-11517.24 32176,-11512.83 32194.4,-11506.74 32212.44,-11495.94 32227.87,-11484.75"/>
<polygon fill="black" stroke="black" points="32230.27,-11487.33 32236.16,-11478.52 32226.06,-11481.73 32230.27,-11487.33"/>
</g>
<!-- l1_attn_stage2_gpu13&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge2238" class="edge">
<title>l1_attn_stage2_gpu13&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32326.3,-11561.36C32340.43,-11555.02 32355.96,-11549.2 32371,-11545.83 32389.49,-11541.69 33039.7,-11549.33 33053,-11535.83 33081.36,-11507.06 33033.79,-11481.22 32988.82,-11464.6"/>
<polygon fill="red" stroke="red" points="32989.88,-11461.26 32979.29,-11461.19 32987.53,-11467.85 32989.88,-11461.26"/>
<text text-anchor="middle" x="33092.5" y="-11524.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu14 -->
<g id="node79" class="node">
<title>l1_attn_stage3_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="32468" cy="-11444.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32468" y="-11455.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="32468" y="-11440.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="32468" y="-11425.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu14&#45;&gt;l1_attn_stage3_gpu14 -->
<g id="edge63" class="edge">
<title>l1_attn_stage2_gpu14&#45;&gt;l1_attn_stage3_gpu14</title>
<path fill="none" stroke="black" d="M32414.74,-11561.22C32400.89,-11554.96 32385.71,-11549.22 32371,-11545.83 32347.17,-11540.34 31948.09,-11553.32 31931,-11535.83 31926.34,-11531.06 31926.33,-11525.59 31931,-11520.83 31939.56,-11512.11 32359.37,-11516.6 32371,-11512.83 32389.45,-11506.86 32407.49,-11496.1 32422.92,-11484.9"/>
<polygon fill="black" stroke="black" points="32425.32,-11487.47 32431.2,-11478.66 32421.11,-11481.88 32425.32,-11487.47"/>
</g>
<!-- l1_attn_stage2_gpu14&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge2239" class="edge">
<title>l1_attn_stage2_gpu14&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32521.3,-11561.39C32535.44,-11555.05 32550.96,-11549.22 32566,-11545.83 32581.53,-11542.33 33127.84,-11547.19 33139,-11535.83 33179.03,-11495.09 33109.32,-11471.74 33039.01,-11458.99"/>
<polygon fill="red" stroke="red" points="33039.55,-11455.53 33029.1,-11457.26 33038.35,-11462.43 33039.55,-11455.53"/>
<text text-anchor="middle" x="33179.5" y="-11524.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu15 -->
<g id="node80" class="node">
<title>l1_attn_stage3_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="32663" cy="-11444.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32663" y="-11455.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="32663" y="-11440.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="32663" y="-11425.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu15&#45;&gt;l1_attn_stage3_gpu15 -->
<g id="edge64" class="edge">
<title>l1_attn_stage2_gpu15&#45;&gt;l1_attn_stage3_gpu15</title>
<path fill="none" stroke="black" d="M32610.02,-11561.26C32596.09,-11554.97 32580.82,-11549.19 32566,-11545.83 32548.99,-11541.97 31950.24,-11548.27 31938,-11535.83 31933.32,-11531.08 31933.32,-11525.58 31938,-11520.83 31950.26,-11508.42 32549.39,-11518.16 32566,-11512.83 32584.46,-11506.91 32602.51,-11496.16 32617.94,-11484.96"/>
<polygon fill="black" stroke="black" points="32620.34,-11487.53 32626.22,-11478.72 32616.13,-11481.94 32620.34,-11487.53"/>
</g>
<!-- l1_attn_stage2_gpu15&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge2240" class="edge">
<title>l1_attn_stage2_gpu15&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32718.38,-11562.02C32733.74,-11555.45 32750.68,-11549.36 32767,-11545.83 32791.87,-11540.45 33207.2,-11554.02 33225,-11535.83 33279.67,-11479.96 33178.45,-11458.29 33079.12,-11450.04"/>
<polygon fill="red" stroke="red" points="33079.15,-11446.53 33068.9,-11449.24 33078.6,-11453.51 33079.15,-11446.53"/>
<text text-anchor="middle" x="33265.5" y="-11524.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu0 -->
<g id="node81" class="node">
<title>l1_attn_stage4_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="29738" cy="-11297.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29738" y="-11308.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="29738" y="-11293.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="29738" y="-11278.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu0&#45;&gt;l1_attn_stage4_gpu0 -->
<g id="edge65" class="edge">
<title>l1_attn_stage3_gpu0&#45;&gt;l1_attn_stage4_gpu0</title>
<path fill="none" stroke="black" d="M29738,-11406.74C29738,-11388.02 29738,-11365.03 29738,-11345.05"/>
<polygon fill="black" stroke="black" points="29741.5,-11344.91 29738,-11334.91 29734.5,-11344.91 29741.5,-11344.91"/>
</g>
<!-- l1_attn_stage4_gpu[next_gpu] -->
<g id="node1348" class="node">
<title>l1_attn_stage4_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="32925" cy="-11297.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="32925" y="-11293.63" font-family="Times,serif" font-size="14.00">l1_attn_stage4_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage3_gpu0&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge2241" class="edge">
<title>l1_attn_stage3_gpu0&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29791.29,-11414.33C29805.43,-11407.99 29820.95,-11402.18 29836,-11398.83 30065.73,-11347.7 31718.66,-11376.38 31954,-11373.83 31998.94,-11373.34 32718.97,-11374.86 32763,-11365.83 32806.87,-11356.83 32853.77,-11335.91 32885.76,-11319.73"/>
<polygon fill="red" stroke="red" points="32887.49,-11322.78 32894.78,-11315.09 32884.28,-11316.55 32887.49,-11322.78"/>
<text text-anchor="middle" x="31985.5" y="-11377.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu1 -->
<g id="node82" class="node">
<title>l1_attn_stage4_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="29933" cy="-11297.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29933" y="-11308.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="29933" y="-11293.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="29933" y="-11278.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu1&#45;&gt;l1_attn_stage4_gpu1 -->
<g id="edge66" class="edge">
<title>l1_attn_stage3_gpu1&#45;&gt;l1_attn_stage4_gpu1</title>
<path fill="none" stroke="black" d="M29933,-11406.74C29933,-11388.02 29933,-11365.03 29933,-11345.05"/>
<polygon fill="black" stroke="black" points="29936.5,-11344.91 29933,-11334.91 29929.5,-11344.91 29936.5,-11344.91"/>
</g>
<!-- l1_attn_stage3_gpu1&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge2242" class="edge">
<title>l1_attn_stage3_gpu1&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29986.28,-11414.26C30000.41,-11407.92 30015.94,-11402.13 30031,-11398.83 30085,-11387 31968.82,-11407.09 32021,-11388.83 32031.15,-11385.28 32029.86,-11377.42 32040,-11373.83 32077.87,-11360.45 32723.66,-11373.93 32763,-11365.83 32806.87,-11356.81 32853.77,-11335.89 32885.76,-11319.72"/>
<polygon fill="red" stroke="red" points="32887.48,-11322.76 32894.78,-11315.08 32884.28,-11316.54 32887.48,-11322.76"/>
<text text-anchor="middle" x="32071.5" y="-11377.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu2 -->
<g id="node83" class="node">
<title>l1_attn_stage4_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="30128" cy="-11297.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30128" y="-11308.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="30128" y="-11293.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="30128" y="-11278.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu2&#45;&gt;l1_attn_stage4_gpu2 -->
<g id="edge67" class="edge">
<title>l1_attn_stage3_gpu2&#45;&gt;l1_attn_stage4_gpu2</title>
<path fill="none" stroke="black" d="M30128,-11406.74C30128,-11388.02 30128,-11365.03 30128,-11345.05"/>
<polygon fill="black" stroke="black" points="30131.5,-11344.91 30128,-11334.91 30124.5,-11344.91 30131.5,-11344.91"/>
</g>
<!-- l1_attn_stage3_gpu2&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge2243" class="edge">
<title>l1_attn_stage3_gpu2&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30181.28,-11414.27C30195.41,-11407.93 30210.94,-11402.13 30226,-11398.83 30277.04,-11387.64 32057.68,-11406.1 32107,-11388.83 32117.15,-11385.28 32115.86,-11377.42 32126,-11373.83 32159.36,-11362.01 32728.34,-11372.99 32763,-11365.83 32806.86,-11356.77 32853.76,-11335.86 32885.75,-11319.7"/>
<polygon fill="red" stroke="red" points="32887.48,-11322.75 32894.77,-11315.07 32884.28,-11316.52 32887.48,-11322.75"/>
<text text-anchor="middle" x="32157.5" y="-11377.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu3 -->
<g id="node84" class="node">
<title>l1_attn_stage4_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="30323" cy="-11297.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30323" y="-11308.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="30323" y="-11293.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="30323" y="-11278.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu3&#45;&gt;l1_attn_stage4_gpu3 -->
<g id="edge68" class="edge">
<title>l1_attn_stage3_gpu3&#45;&gt;l1_attn_stage4_gpu3</title>
<path fill="none" stroke="black" d="M30323,-11406.74C30323,-11388.02 30323,-11365.03 30323,-11345.05"/>
<polygon fill="black" stroke="black" points="30326.5,-11344.91 30323,-11334.91 30319.5,-11344.91 30326.5,-11344.91"/>
</g>
<!-- l1_attn_stage3_gpu3&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge2244" class="edge">
<title>l1_attn_stage3_gpu3&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30376.28,-11414.27C30390.41,-11407.93 30405.94,-11402.13 30421,-11398.83 30469.08,-11388.28 32146.55,-11405.11 32193,-11388.83 32203.15,-11385.27 32201.86,-11377.43 32212,-11373.83 32240.85,-11363.58 32733.02,-11372.05 32763,-11365.83 32806.85,-11356.73 32853.75,-11335.83 32885.75,-11319.67"/>
<polygon fill="red" stroke="red" points="32887.47,-11322.73 32894.77,-11315.05 32884.27,-11316.5 32887.47,-11322.73"/>
<text text-anchor="middle" x="32243.5" y="-11377.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu4 -->
<g id="node85" class="node">
<title>l1_attn_stage4_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="30518" cy="-11297.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30518" y="-11308.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="30518" y="-11293.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="30518" y="-11278.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu4&#45;&gt;l1_attn_stage4_gpu4 -->
<g id="edge69" class="edge">
<title>l1_attn_stage3_gpu4&#45;&gt;l1_attn_stage4_gpu4</title>
<path fill="none" stroke="black" d="M30518,-11406.74C30518,-11388.02 30518,-11365.03 30518,-11345.05"/>
<polygon fill="black" stroke="black" points="30521.5,-11344.91 30518,-11334.91 30514.5,-11344.91 30521.5,-11344.91"/>
</g>
<!-- l1_attn_stage3_gpu4&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge2245" class="edge">
<title>l1_attn_stage3_gpu4&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30571.28,-11414.27C30585.41,-11407.93 30600.94,-11402.14 30616,-11398.83 30661.12,-11388.93 32235.41,-11404.11 32279,-11388.83 32289.15,-11385.27 32287.87,-11377.45 32298,-11373.83 32346.67,-11356.47 32712.42,-11376.4 32763,-11365.83 32806.84,-11356.67 32853.74,-11335.78 32885.74,-11319.64"/>
<polygon fill="red" stroke="red" points="32887.46,-11322.7 32894.76,-11315.02 32884.27,-11316.47 32887.46,-11322.7"/>
<text text-anchor="middle" x="32329.5" y="-11377.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu5 -->
<g id="node86" class="node">
<title>l1_attn_stage4_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="30713" cy="-11297.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30713" y="-11308.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="30713" y="-11293.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="30713" y="-11278.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu5&#45;&gt;l1_attn_stage4_gpu5 -->
<g id="edge70" class="edge">
<title>l1_attn_stage3_gpu5&#45;&gt;l1_attn_stage4_gpu5</title>
<path fill="none" stroke="black" d="M30713,-11406.74C30713,-11388.02 30713,-11365.03 30713,-11345.05"/>
<polygon fill="black" stroke="black" points="30716.5,-11344.91 30713,-11334.91 30709.5,-11344.91 30716.5,-11344.91"/>
</g>
<!-- l1_attn_stage3_gpu5&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge2246" class="edge">
<title>l1_attn_stage3_gpu5&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30766.28,-11414.28C30780.41,-11407.94 30795.94,-11402.14 30811,-11398.83 30853.16,-11389.57 32324.27,-11403.12 32365,-11388.83 32375.15,-11385.27 32373.87,-11377.47 32384,-11373.83 32423.64,-11359.6 32721.79,-11374.53 32763,-11365.83 32806.82,-11356.59 32853.73,-11335.7 32885.73,-11319.6"/>
<polygon fill="red" stroke="red" points="32887.45,-11322.65 32894.75,-11314.98 32884.26,-11316.42 32887.45,-11322.65"/>
<text text-anchor="middle" x="32415.5" y="-11377.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu6 -->
<g id="node87" class="node">
<title>l1_attn_stage4_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="30908" cy="-11297.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30908" y="-11308.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="30908" y="-11293.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="30908" y="-11278.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu6&#45;&gt;l1_attn_stage4_gpu6 -->
<g id="edge71" class="edge">
<title>l1_attn_stage3_gpu6&#45;&gt;l1_attn_stage4_gpu6</title>
<path fill="none" stroke="black" d="M30908,-11406.74C30908,-11388.02 30908,-11365.03 30908,-11345.05"/>
<polygon fill="black" stroke="black" points="30911.5,-11344.91 30908,-11334.91 30904.5,-11344.91 30911.5,-11344.91"/>
</g>
<!-- l1_attn_stage3_gpu6&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge2247" class="edge">
<title>l1_attn_stage3_gpu6&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30961.28,-11414.28C30975.41,-11407.94 30990.94,-11402.14 31006,-11398.83 31045.2,-11390.21 32413.13,-11402.13 32451,-11388.83 32461.15,-11385.27 32459.89,-11377.5 32470,-11373.83 32500.62,-11362.73 32731.15,-11372.65 32763,-11365.83 32806.66,-11356.48 32853.41,-11335.72 32885.42,-11319.67"/>
<polygon fill="red" stroke="red" points="32887.12,-11322.73 32894.45,-11315.07 32883.95,-11316.49 32887.12,-11322.73"/>
<text text-anchor="middle" x="32501.5" y="-11377.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu7 -->
<g id="node88" class="node">
<title>l1_attn_stage4_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="31103" cy="-11297.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31103" y="-11308.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="31103" y="-11293.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="31103" y="-11278.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu7&#45;&gt;l1_attn_stage4_gpu7 -->
<g id="edge72" class="edge">
<title>l1_attn_stage3_gpu7&#45;&gt;l1_attn_stage4_gpu7</title>
<path fill="none" stroke="black" d="M31103,-11406.74C31103,-11388.02 31103,-11365.03 31103,-11345.05"/>
<polygon fill="black" stroke="black" points="31106.5,-11344.91 31103,-11334.91 31099.5,-11344.91 31106.5,-11344.91"/>
</g>
<!-- l1_attn_stage3_gpu7&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge2248" class="edge">
<title>l1_attn_stage3_gpu7&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31156.28,-11414.29C31170.42,-11407.95 31185.95,-11402.15 31201,-11398.83 31237.24,-11390.85 32501.99,-11401.13 32537,-11388.83 32547.15,-11385.27 32545.91,-11377.56 32556,-11373.83 32599.19,-11357.9 32718.04,-11375.73 32763,-11365.83 32806.6,-11356.23 32853.37,-11335.51 32885.39,-11319.54"/>
<polygon fill="red" stroke="red" points="32887.08,-11322.6 32894.42,-11314.96 32883.92,-11316.36 32887.08,-11322.6"/>
<text text-anchor="middle" x="32587.5" y="-11377.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu8 -->
<g id="node89" class="node">
<title>l1_attn_stage4_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="31298" cy="-11297.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31298" y="-11308.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="31298" y="-11293.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="31298" y="-11278.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu8&#45;&gt;l1_attn_stage4_gpu8 -->
<g id="edge73" class="edge">
<title>l1_attn_stage3_gpu8&#45;&gt;l1_attn_stage4_gpu8</title>
<path fill="none" stroke="black" d="M31298,-11406.74C31298,-11388.02 31298,-11365.03 31298,-11345.05"/>
<polygon fill="black" stroke="black" points="31301.5,-11344.91 31298,-11334.91 31294.5,-11344.91 31301.5,-11344.91"/>
</g>
<!-- l1_attn_stage3_gpu8&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge2249" class="edge">
<title>l1_attn_stage3_gpu8&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31351.28,-11414.3C31365.42,-11407.96 31380.95,-11402.15 31396,-11398.83 31462.57,-11384.14 32558.69,-11411.45 32623,-11388.83 32633.15,-11385.26 32631.96,-11377.69 32642,-11373.83 32692.3,-11354.49 32710.53,-11378.14 32763,-11365.83 32806.2,-11355.7 32852.67,-11335.25 32884.71,-11319.5"/>
<polygon fill="red" stroke="red" points="32886.38,-11322.59 32893.77,-11314.99 32883.25,-11316.32 32886.38,-11322.59"/>
<text text-anchor="middle" x="32673.5" y="-11377.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu9 -->
<g id="node90" class="node">
<title>l1_attn_stage4_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="31493" cy="-11297.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31493" y="-11308.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="31493" y="-11293.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="31493" y="-11278.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu9&#45;&gt;l1_attn_stage4_gpu9 -->
<g id="edge74" class="edge">
<title>l1_attn_stage3_gpu9&#45;&gt;l1_attn_stage4_gpu9</title>
<path fill="none" stroke="black" d="M31493,-11406.74C31493,-11388.02 31493,-11365.03 31493,-11345.05"/>
<polygon fill="black" stroke="black" points="31496.5,-11344.91 31493,-11334.91 31489.5,-11344.91 31496.5,-11344.91"/>
</g>
<!-- l1_attn_stage3_gpu9&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge2250" class="edge">
<title>l1_attn_stage3_gpu9&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31546.28,-11414.3C31560.42,-11407.96 31575.95,-11402.16 31591,-11398.83 31651.65,-11385.42 32650.41,-11409.46 32709,-11388.83 32719.15,-11385.26 32718.3,-11378.48 32728,-11373.83 32742.39,-11366.94 32747.8,-11370.7 32763,-11365.83 32803.94,-11352.73 32848.95,-11333.57 32881.12,-11319.01"/>
<polygon fill="red" stroke="red" points="32882.61,-11322.17 32890.25,-11314.84 32879.7,-11315.81 32882.61,-11322.17"/>
<text text-anchor="middle" x="32759.5" y="-11377.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu10 -->
<g id="node91" class="node">
<title>l1_attn_stage4_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="31688" cy="-11297.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31688" y="-11308.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="31688" y="-11293.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="31688" y="-11278.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu10&#45;&gt;l1_attn_stage4_gpu10 -->
<g id="edge75" class="edge">
<title>l1_attn_stage3_gpu10&#45;&gt;l1_attn_stage4_gpu10</title>
<path fill="none" stroke="black" d="M31688,-11406.74C31688,-11388.02 31688,-11365.03 31688,-11345.05"/>
<polygon fill="black" stroke="black" points="31691.5,-11344.91 31688,-11334.91 31684.5,-11344.91 31691.5,-11344.91"/>
</g>
<!-- l1_attn_stage3_gpu10&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge2251" class="edge">
<title>l1_attn_stage3_gpu10&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31741.29,-11414.31C31755.42,-11407.97 31770.95,-11402.17 31786,-11398.83 31840.73,-11386.7 32742.13,-11407.48 32795,-11388.83 32805.15,-11385.25 32805.32,-11380.19 32814,-11373.83 32839.22,-11355.34 32868.5,-11335.49 32890.65,-11320.78"/>
<polygon fill="red" stroke="red" points="32892.66,-11323.65 32899.07,-11315.22 32888.8,-11317.81 32892.66,-11323.65"/>
<text text-anchor="middle" x="32845.5" y="-11377.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu11 -->
<g id="node92" class="node">
<title>l1_attn_stage4_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="31883" cy="-11297.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31883" y="-11308.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="31883" y="-11293.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="31883" y="-11278.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu11&#45;&gt;l1_attn_stage4_gpu11 -->
<g id="edge76" class="edge">
<title>l1_attn_stage3_gpu11&#45;&gt;l1_attn_stage4_gpu11</title>
<path fill="none" stroke="black" d="M31883,-11406.74C31883,-11388.02 31883,-11365.03 31883,-11345.05"/>
<polygon fill="black" stroke="black" points="31886.5,-11344.91 31883,-11334.91 31879.5,-11344.91 31886.5,-11344.91"/>
</g>
<!-- l1_attn_stage3_gpu11&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge2252" class="edge">
<title>l1_attn_stage3_gpu11&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31936.29,-11414.33C31950.42,-11407.99 31965.95,-11402.18 31981,-11398.83 32005.41,-11393.41 32859.88,-11402.21 32881,-11388.83 32902.94,-11374.93 32914.24,-11346.65 32919.85,-11325.39"/>
<polygon fill="red" stroke="red" points="32923.27,-11326.14 32922.18,-11315.6 32916.46,-11324.52 32923.27,-11326.14"/>
<text text-anchor="middle" x="32927.5" y="-11377.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu12 -->
<g id="node93" class="node">
<title>l1_attn_stage4_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="32078" cy="-11297.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32078" y="-11308.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="32078" y="-11293.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="32078" y="-11278.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu12&#45;&gt;l1_attn_stage4_gpu12 -->
<g id="edge77" class="edge">
<title>l1_attn_stage3_gpu12&#45;&gt;l1_attn_stage4_gpu12</title>
<path fill="none" stroke="black" d="M32022.85,-11414.87C32009.43,-11408.83 31994.93,-11403.03 31981,-11398.83 31967.22,-11394.68 31926.36,-11399.77 31917,-11388.83 31882.08,-11348.03 31922.79,-11388.15 31981,-11365.83 31998.78,-11359.01 32016.42,-11348.27 32031.68,-11337.34"/>
<polygon fill="black" stroke="black" points="32033.93,-11340.02 32039.9,-11331.27 32029.77,-11334.39 32033.93,-11340.02"/>
</g>
<!-- l1_attn_stage3_gpu12&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge2253" class="edge">
<title>l1_attn_stage3_gpu12&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32131.29,-11414.34C32145.43,-11408 32160.95,-11402.19 32176,-11398.83 32197.45,-11394.05 32951.56,-11404.47 32967,-11388.83 32985.16,-11370.44 32967.89,-11342.75 32950.31,-11322.84"/>
<polygon fill="red" stroke="red" points="32952.75,-11320.32 32943.38,-11315.37 32947.61,-11325.08 32952.75,-11320.32"/>
<text text-anchor="middle" x="33005.5" y="-11377.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu13 -->
<g id="node94" class="node">
<title>l1_attn_stage4_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="32273" cy="-11297.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32273" y="-11308.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="32273" y="-11293.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="32273" y="-11278.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu13&#45;&gt;l1_attn_stage4_gpu13 -->
<g id="edge78" class="edge">
<title>l1_attn_stage3_gpu13&#45;&gt;l1_attn_stage4_gpu13</title>
<path fill="none" stroke="black" d="M32219.7,-11414.39C32205.85,-11408.13 32190.69,-11402.35 32176,-11398.83 32162.37,-11395.57 31933.71,-11398.93 31924,-11388.83 31919.38,-11384.03 31919.36,-11378.62 31924,-11373.83 31933.75,-11363.77 32162.7,-11370.24 32176,-11365.83 32194.4,-11359.74 32212.44,-11348.94 32227.87,-11337.75"/>
<polygon fill="black" stroke="black" points="32230.27,-11340.33 32236.16,-11331.52 32226.06,-11334.73 32230.27,-11340.33"/>
</g>
<!-- l1_attn_stage3_gpu13&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge2254" class="edge">
<title>l1_attn_stage3_gpu13&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32326.3,-11414.36C32340.43,-11408.02 32355.96,-11402.2 32371,-11398.83 32389.49,-11394.69 33039.7,-11402.33 33053,-11388.83 33081.36,-11360.06 33033.79,-11334.22 32988.82,-11317.6"/>
<polygon fill="red" stroke="red" points="32989.88,-11314.26 32979.29,-11314.19 32987.53,-11320.85 32989.88,-11314.26"/>
<text text-anchor="middle" x="33092.5" y="-11377.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu14 -->
<g id="node95" class="node">
<title>l1_attn_stage4_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="32468" cy="-11297.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32468" y="-11308.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="32468" y="-11293.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="32468" y="-11278.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu14&#45;&gt;l1_attn_stage4_gpu14 -->
<g id="edge79" class="edge">
<title>l1_attn_stage3_gpu14&#45;&gt;l1_attn_stage4_gpu14</title>
<path fill="none" stroke="black" d="M32414.74,-11414.22C32400.89,-11407.96 32385.71,-11402.22 32371,-11398.83 32347.17,-11393.34 31948.09,-11406.32 31931,-11388.83 31926.34,-11384.06 31926.33,-11378.59 31931,-11373.83 31939.56,-11365.11 32359.37,-11369.6 32371,-11365.83 32389.45,-11359.86 32407.49,-11349.1 32422.92,-11337.9"/>
<polygon fill="black" stroke="black" points="32425.32,-11340.47 32431.2,-11331.66 32421.11,-11334.88 32425.32,-11340.47"/>
</g>
<!-- l1_attn_stage3_gpu14&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge2255" class="edge">
<title>l1_attn_stage3_gpu14&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32521.3,-11414.39C32535.44,-11408.05 32550.96,-11402.22 32566,-11398.83 32581.53,-11395.33 33127.84,-11400.19 33139,-11388.83 33179.03,-11348.09 33109.32,-11324.74 33039.01,-11311.99"/>
<polygon fill="red" stroke="red" points="33039.55,-11308.53 33029.1,-11310.26 33038.35,-11315.43 33039.55,-11308.53"/>
<text text-anchor="middle" x="33179.5" y="-11377.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu15 -->
<g id="node96" class="node">
<title>l1_attn_stage4_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="32663" cy="-11297.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32663" y="-11308.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="32663" y="-11293.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="32663" y="-11278.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu15&#45;&gt;l1_attn_stage4_gpu15 -->
<g id="edge80" class="edge">
<title>l1_attn_stage3_gpu15&#45;&gt;l1_attn_stage4_gpu15</title>
<path fill="none" stroke="black" d="M32610.02,-11414.26C32596.09,-11407.97 32580.82,-11402.19 32566,-11398.83 32548.99,-11394.97 31950.24,-11401.27 31938,-11388.83 31933.32,-11384.08 31933.32,-11378.58 31938,-11373.83 31950.26,-11361.42 32549.39,-11371.16 32566,-11365.83 32584.46,-11359.91 32602.51,-11349.16 32617.94,-11337.96"/>
<polygon fill="black" stroke="black" points="32620.34,-11340.53 32626.22,-11331.72 32616.13,-11334.94 32620.34,-11340.53"/>
</g>
<!-- l1_attn_stage3_gpu15&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge2256" class="edge">
<title>l1_attn_stage3_gpu15&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32718.38,-11415.02C32733.74,-11408.45 32750.68,-11402.36 32767,-11398.83 32791.87,-11393.45 33207.2,-11407.02 33225,-11388.83 33279.67,-11332.96 33178.45,-11311.29 33079.12,-11303.04"/>
<polygon fill="red" stroke="red" points="33079.15,-11299.53 33068.9,-11302.24 33078.6,-11306.51 33079.15,-11299.53"/>
<text text-anchor="middle" x="33265.5" y="-11377.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu0 -->
<g id="node97" class="node">
<title>l1_attn_stage5_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="29738" cy="-11150.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29738" y="-11161.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="29738" y="-11146.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="29738" y="-11131.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu0&#45;&gt;l1_attn_stage5_gpu0 -->
<g id="edge81" class="edge">
<title>l1_attn_stage4_gpu0&#45;&gt;l1_attn_stage5_gpu0</title>
<path fill="none" stroke="black" d="M29738,-11259.74C29738,-11241.02 29738,-11218.03 29738,-11198.05"/>
<polygon fill="black" stroke="black" points="29741.5,-11197.91 29738,-11187.91 29734.5,-11197.91 29741.5,-11197.91"/>
</g>
<!-- l1_attn_stage5_gpu[next_gpu] -->
<g id="node1349" class="node">
<title>l1_attn_stage5_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="32925" cy="-11150.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="32925" y="-11146.63" font-family="Times,serif" font-size="14.00">l1_attn_stage5_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage4_gpu0&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge2257" class="edge">
<title>l1_attn_stage4_gpu0&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29791.29,-11267.33C29805.43,-11260.99 29820.95,-11255.18 29836,-11251.83 30065.73,-11200.7 31718.66,-11229.38 31954,-11226.83 31998.94,-11226.34 32718.97,-11227.86 32763,-11218.83 32806.87,-11209.83 32853.77,-11188.91 32885.76,-11172.73"/>
<polygon fill="red" stroke="red" points="32887.49,-11175.78 32894.78,-11168.09 32884.28,-11169.55 32887.49,-11175.78"/>
<text text-anchor="middle" x="31985.5" y="-11230.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu1 -->
<g id="node98" class="node">
<title>l1_attn_stage5_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="29933" cy="-11150.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29933" y="-11161.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="29933" y="-11146.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="29933" y="-11131.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu1&#45;&gt;l1_attn_stage5_gpu1 -->
<g id="edge82" class="edge">
<title>l1_attn_stage4_gpu1&#45;&gt;l1_attn_stage5_gpu1</title>
<path fill="none" stroke="black" d="M29933,-11259.74C29933,-11241.02 29933,-11218.03 29933,-11198.05"/>
<polygon fill="black" stroke="black" points="29936.5,-11197.91 29933,-11187.91 29929.5,-11197.91 29936.5,-11197.91"/>
</g>
<!-- l1_attn_stage4_gpu1&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge2258" class="edge">
<title>l1_attn_stage4_gpu1&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29986.28,-11267.26C30000.41,-11260.92 30015.94,-11255.13 30031,-11251.83 30085,-11240 31968.82,-11260.09 32021,-11241.83 32031.15,-11238.28 32029.86,-11230.42 32040,-11226.83 32077.87,-11213.45 32723.66,-11226.93 32763,-11218.83 32806.87,-11209.81 32853.77,-11188.89 32885.76,-11172.72"/>
<polygon fill="red" stroke="red" points="32887.48,-11175.76 32894.78,-11168.08 32884.28,-11169.54 32887.48,-11175.76"/>
<text text-anchor="middle" x="32071.5" y="-11230.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu2 -->
<g id="node99" class="node">
<title>l1_attn_stage5_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="30128" cy="-11150.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30128" y="-11161.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="30128" y="-11146.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="30128" y="-11131.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu2&#45;&gt;l1_attn_stage5_gpu2 -->
<g id="edge83" class="edge">
<title>l1_attn_stage4_gpu2&#45;&gt;l1_attn_stage5_gpu2</title>
<path fill="none" stroke="black" d="M30128,-11259.74C30128,-11241.02 30128,-11218.03 30128,-11198.05"/>
<polygon fill="black" stroke="black" points="30131.5,-11197.91 30128,-11187.91 30124.5,-11197.91 30131.5,-11197.91"/>
</g>
<!-- l1_attn_stage4_gpu2&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge2259" class="edge">
<title>l1_attn_stage4_gpu2&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30181.28,-11267.27C30195.41,-11260.93 30210.94,-11255.13 30226,-11251.83 30277.04,-11240.64 32057.68,-11259.1 32107,-11241.83 32117.15,-11238.28 32115.86,-11230.42 32126,-11226.83 32159.36,-11215.01 32728.34,-11225.99 32763,-11218.83 32806.86,-11209.77 32853.76,-11188.86 32885.75,-11172.7"/>
<polygon fill="red" stroke="red" points="32887.48,-11175.75 32894.77,-11168.07 32884.28,-11169.52 32887.48,-11175.75"/>
<text text-anchor="middle" x="32157.5" y="-11230.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu3 -->
<g id="node100" class="node">
<title>l1_attn_stage5_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="30323" cy="-11150.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30323" y="-11161.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="30323" y="-11146.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="30323" y="-11131.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu3&#45;&gt;l1_attn_stage5_gpu3 -->
<g id="edge84" class="edge">
<title>l1_attn_stage4_gpu3&#45;&gt;l1_attn_stage5_gpu3</title>
<path fill="none" stroke="black" d="M30323,-11259.74C30323,-11241.02 30323,-11218.03 30323,-11198.05"/>
<polygon fill="black" stroke="black" points="30326.5,-11197.91 30323,-11187.91 30319.5,-11197.91 30326.5,-11197.91"/>
</g>
<!-- l1_attn_stage4_gpu3&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge2260" class="edge">
<title>l1_attn_stage4_gpu3&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30376.28,-11267.27C30390.41,-11260.93 30405.94,-11255.13 30421,-11251.83 30469.08,-11241.28 32146.55,-11258.11 32193,-11241.83 32203.15,-11238.27 32201.86,-11230.43 32212,-11226.83 32240.85,-11216.58 32733.02,-11225.05 32763,-11218.83 32806.85,-11209.73 32853.75,-11188.83 32885.75,-11172.67"/>
<polygon fill="red" stroke="red" points="32887.47,-11175.73 32894.77,-11168.05 32884.27,-11169.5 32887.47,-11175.73"/>
<text text-anchor="middle" x="32243.5" y="-11230.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu4 -->
<g id="node101" class="node">
<title>l1_attn_stage5_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="30518" cy="-11150.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30518" y="-11161.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="30518" y="-11146.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="30518" y="-11131.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu4&#45;&gt;l1_attn_stage5_gpu4 -->
<g id="edge85" class="edge">
<title>l1_attn_stage4_gpu4&#45;&gt;l1_attn_stage5_gpu4</title>
<path fill="none" stroke="black" d="M30518,-11259.74C30518,-11241.02 30518,-11218.03 30518,-11198.05"/>
<polygon fill="black" stroke="black" points="30521.5,-11197.91 30518,-11187.91 30514.5,-11197.91 30521.5,-11197.91"/>
</g>
<!-- l1_attn_stage4_gpu4&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge2261" class="edge">
<title>l1_attn_stage4_gpu4&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30571.28,-11267.27C30585.41,-11260.93 30600.94,-11255.14 30616,-11251.83 30661.12,-11241.93 32235.41,-11257.11 32279,-11241.83 32289.15,-11238.27 32287.87,-11230.45 32298,-11226.83 32346.67,-11209.47 32712.42,-11229.4 32763,-11218.83 32806.84,-11209.67 32853.74,-11188.78 32885.74,-11172.64"/>
<polygon fill="red" stroke="red" points="32887.46,-11175.7 32894.76,-11168.02 32884.27,-11169.47 32887.46,-11175.7"/>
<text text-anchor="middle" x="32329.5" y="-11230.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu5 -->
<g id="node102" class="node">
<title>l1_attn_stage5_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="30713" cy="-11150.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30713" y="-11161.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="30713" y="-11146.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="30713" y="-11131.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu5&#45;&gt;l1_attn_stage5_gpu5 -->
<g id="edge86" class="edge">
<title>l1_attn_stage4_gpu5&#45;&gt;l1_attn_stage5_gpu5</title>
<path fill="none" stroke="black" d="M30713,-11259.74C30713,-11241.02 30713,-11218.03 30713,-11198.05"/>
<polygon fill="black" stroke="black" points="30716.5,-11197.91 30713,-11187.91 30709.5,-11197.91 30716.5,-11197.91"/>
</g>
<!-- l1_attn_stage4_gpu5&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge2262" class="edge">
<title>l1_attn_stage4_gpu5&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30766.28,-11267.28C30780.41,-11260.94 30795.94,-11255.14 30811,-11251.83 30853.16,-11242.57 32324.27,-11256.12 32365,-11241.83 32375.15,-11238.27 32373.87,-11230.47 32384,-11226.83 32423.64,-11212.6 32721.79,-11227.53 32763,-11218.83 32806.82,-11209.59 32853.73,-11188.7 32885.73,-11172.6"/>
<polygon fill="red" stroke="red" points="32887.45,-11175.65 32894.75,-11167.98 32884.26,-11169.42 32887.45,-11175.65"/>
<text text-anchor="middle" x="32415.5" y="-11230.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu6 -->
<g id="node103" class="node">
<title>l1_attn_stage5_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="30908" cy="-11150.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30908" y="-11161.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="30908" y="-11146.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="30908" y="-11131.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu6&#45;&gt;l1_attn_stage5_gpu6 -->
<g id="edge87" class="edge">
<title>l1_attn_stage4_gpu6&#45;&gt;l1_attn_stage5_gpu6</title>
<path fill="none" stroke="black" d="M30908,-11259.74C30908,-11241.02 30908,-11218.03 30908,-11198.05"/>
<polygon fill="black" stroke="black" points="30911.5,-11197.91 30908,-11187.91 30904.5,-11197.91 30911.5,-11197.91"/>
</g>
<!-- l1_attn_stage4_gpu6&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge2263" class="edge">
<title>l1_attn_stage4_gpu6&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30961.28,-11267.28C30975.41,-11260.94 30990.94,-11255.14 31006,-11251.83 31045.2,-11243.21 32413.13,-11255.13 32451,-11241.83 32461.15,-11238.27 32459.89,-11230.5 32470,-11226.83 32500.62,-11215.73 32731.15,-11225.65 32763,-11218.83 32806.66,-11209.48 32853.41,-11188.72 32885.42,-11172.67"/>
<polygon fill="red" stroke="red" points="32887.12,-11175.73 32894.45,-11168.07 32883.95,-11169.49 32887.12,-11175.73"/>
<text text-anchor="middle" x="32501.5" y="-11230.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu7 -->
<g id="node104" class="node">
<title>l1_attn_stage5_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="31103" cy="-11150.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31103" y="-11161.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="31103" y="-11146.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="31103" y="-11131.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu7&#45;&gt;l1_attn_stage5_gpu7 -->
<g id="edge88" class="edge">
<title>l1_attn_stage4_gpu7&#45;&gt;l1_attn_stage5_gpu7</title>
<path fill="none" stroke="black" d="M31103,-11259.74C31103,-11241.02 31103,-11218.03 31103,-11198.05"/>
<polygon fill="black" stroke="black" points="31106.5,-11197.91 31103,-11187.91 31099.5,-11197.91 31106.5,-11197.91"/>
</g>
<!-- l1_attn_stage4_gpu7&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge2264" class="edge">
<title>l1_attn_stage4_gpu7&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31156.28,-11267.29C31170.42,-11260.95 31185.95,-11255.15 31201,-11251.83 31237.24,-11243.85 32501.99,-11254.13 32537,-11241.83 32547.15,-11238.27 32545.91,-11230.56 32556,-11226.83 32599.19,-11210.9 32718.04,-11228.73 32763,-11218.83 32806.6,-11209.23 32853.37,-11188.51 32885.39,-11172.54"/>
<polygon fill="red" stroke="red" points="32887.08,-11175.6 32894.42,-11167.96 32883.92,-11169.36 32887.08,-11175.6"/>
<text text-anchor="middle" x="32587.5" y="-11230.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu8 -->
<g id="node105" class="node">
<title>l1_attn_stage5_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="31298" cy="-11150.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31298" y="-11161.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="31298" y="-11146.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="31298" y="-11131.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu8&#45;&gt;l1_attn_stage5_gpu8 -->
<g id="edge89" class="edge">
<title>l1_attn_stage4_gpu8&#45;&gt;l1_attn_stage5_gpu8</title>
<path fill="none" stroke="black" d="M31298,-11259.74C31298,-11241.02 31298,-11218.03 31298,-11198.05"/>
<polygon fill="black" stroke="black" points="31301.5,-11197.91 31298,-11187.91 31294.5,-11197.91 31301.5,-11197.91"/>
</g>
<!-- l1_attn_stage4_gpu8&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge2265" class="edge">
<title>l1_attn_stage4_gpu8&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31351.28,-11267.3C31365.42,-11260.96 31380.95,-11255.15 31396,-11251.83 31462.57,-11237.14 32558.69,-11264.45 32623,-11241.83 32633.15,-11238.26 32631.96,-11230.69 32642,-11226.83 32692.3,-11207.49 32710.53,-11231.14 32763,-11218.83 32806.2,-11208.7 32852.67,-11188.25 32884.71,-11172.5"/>
<polygon fill="red" stroke="red" points="32886.38,-11175.59 32893.77,-11167.99 32883.25,-11169.32 32886.38,-11175.59"/>
<text text-anchor="middle" x="32673.5" y="-11230.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu9 -->
<g id="node106" class="node">
<title>l1_attn_stage5_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="31493" cy="-11150.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31493" y="-11161.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="31493" y="-11146.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="31493" y="-11131.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu9&#45;&gt;l1_attn_stage5_gpu9 -->
<g id="edge90" class="edge">
<title>l1_attn_stage4_gpu9&#45;&gt;l1_attn_stage5_gpu9</title>
<path fill="none" stroke="black" d="M31493,-11259.74C31493,-11241.02 31493,-11218.03 31493,-11198.05"/>
<polygon fill="black" stroke="black" points="31496.5,-11197.91 31493,-11187.91 31489.5,-11197.91 31496.5,-11197.91"/>
</g>
<!-- l1_attn_stage4_gpu9&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge2266" class="edge">
<title>l1_attn_stage4_gpu9&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31546.28,-11267.3C31560.42,-11260.96 31575.95,-11255.16 31591,-11251.83 31651.65,-11238.42 32650.41,-11262.46 32709,-11241.83 32719.15,-11238.26 32718.3,-11231.48 32728,-11226.83 32742.39,-11219.94 32747.8,-11223.7 32763,-11218.83 32803.94,-11205.73 32848.95,-11186.57 32881.12,-11172.01"/>
<polygon fill="red" stroke="red" points="32882.61,-11175.17 32890.25,-11167.84 32879.7,-11168.81 32882.61,-11175.17"/>
<text text-anchor="middle" x="32759.5" y="-11230.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu10 -->
<g id="node107" class="node">
<title>l1_attn_stage5_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="31688" cy="-11150.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31688" y="-11161.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="31688" y="-11146.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="31688" y="-11131.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu10&#45;&gt;l1_attn_stage5_gpu10 -->
<g id="edge91" class="edge">
<title>l1_attn_stage4_gpu10&#45;&gt;l1_attn_stage5_gpu10</title>
<path fill="none" stroke="black" d="M31688,-11259.74C31688,-11241.02 31688,-11218.03 31688,-11198.05"/>
<polygon fill="black" stroke="black" points="31691.5,-11197.91 31688,-11187.91 31684.5,-11197.91 31691.5,-11197.91"/>
</g>
<!-- l1_attn_stage4_gpu10&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge2267" class="edge">
<title>l1_attn_stage4_gpu10&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31741.29,-11267.31C31755.42,-11260.97 31770.95,-11255.17 31786,-11251.83 31840.73,-11239.7 32742.13,-11260.48 32795,-11241.83 32805.15,-11238.25 32805.32,-11233.19 32814,-11226.83 32839.22,-11208.34 32868.5,-11188.49 32890.65,-11173.78"/>
<polygon fill="red" stroke="red" points="32892.66,-11176.65 32899.07,-11168.22 32888.8,-11170.81 32892.66,-11176.65"/>
<text text-anchor="middle" x="32845.5" y="-11230.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu11 -->
<g id="node108" class="node">
<title>l1_attn_stage5_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="31883" cy="-11150.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31883" y="-11161.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="31883" y="-11146.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="31883" y="-11131.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu11&#45;&gt;l1_attn_stage5_gpu11 -->
<g id="edge92" class="edge">
<title>l1_attn_stage4_gpu11&#45;&gt;l1_attn_stage5_gpu11</title>
<path fill="none" stroke="black" d="M31883,-11259.74C31883,-11241.02 31883,-11218.03 31883,-11198.05"/>
<polygon fill="black" stroke="black" points="31886.5,-11197.91 31883,-11187.91 31879.5,-11197.91 31886.5,-11197.91"/>
</g>
<!-- l1_attn_stage4_gpu11&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge2268" class="edge">
<title>l1_attn_stage4_gpu11&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31936.29,-11267.33C31950.42,-11260.99 31965.95,-11255.18 31981,-11251.83 32005.41,-11246.41 32859.88,-11255.21 32881,-11241.83 32902.94,-11227.93 32914.24,-11199.65 32919.85,-11178.39"/>
<polygon fill="red" stroke="red" points="32923.27,-11179.14 32922.18,-11168.6 32916.46,-11177.52 32923.27,-11179.14"/>
<text text-anchor="middle" x="32927.5" y="-11230.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu12 -->
<g id="node109" class="node">
<title>l1_attn_stage5_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="32078" cy="-11150.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32078" y="-11161.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="32078" y="-11146.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="32078" y="-11131.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu12&#45;&gt;l1_attn_stage5_gpu12 -->
<g id="edge93" class="edge">
<title>l1_attn_stage4_gpu12&#45;&gt;l1_attn_stage5_gpu12</title>
<path fill="none" stroke="black" d="M32022.85,-11267.87C32009.43,-11261.83 31994.93,-11256.03 31981,-11251.83 31967.22,-11247.68 31926.36,-11252.77 31917,-11241.83 31882.08,-11201.03 31922.79,-11241.15 31981,-11218.83 31998.78,-11212.01 32016.42,-11201.27 32031.68,-11190.34"/>
<polygon fill="black" stroke="black" points="32033.93,-11193.02 32039.9,-11184.27 32029.77,-11187.39 32033.93,-11193.02"/>
</g>
<!-- l1_attn_stage4_gpu12&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge2269" class="edge">
<title>l1_attn_stage4_gpu12&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32131.29,-11267.34C32145.43,-11261 32160.95,-11255.19 32176,-11251.83 32197.45,-11247.05 32951.56,-11257.47 32967,-11241.83 32985.16,-11223.44 32967.89,-11195.75 32950.31,-11175.84"/>
<polygon fill="red" stroke="red" points="32952.75,-11173.32 32943.38,-11168.37 32947.61,-11178.08 32952.75,-11173.32"/>
<text text-anchor="middle" x="33005.5" y="-11230.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu13 -->
<g id="node110" class="node">
<title>l1_attn_stage5_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="32273" cy="-11150.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32273" y="-11161.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="32273" y="-11146.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="32273" y="-11131.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu13&#45;&gt;l1_attn_stage5_gpu13 -->
<g id="edge94" class="edge">
<title>l1_attn_stage4_gpu13&#45;&gt;l1_attn_stage5_gpu13</title>
<path fill="none" stroke="black" d="M32219.7,-11267.39C32205.85,-11261.13 32190.69,-11255.35 32176,-11251.83 32162.37,-11248.57 31933.71,-11251.93 31924,-11241.83 31919.38,-11237.03 31919.36,-11231.62 31924,-11226.83 31933.75,-11216.77 32162.7,-11223.24 32176,-11218.83 32194.4,-11212.74 32212.44,-11201.94 32227.87,-11190.75"/>
<polygon fill="black" stroke="black" points="32230.27,-11193.33 32236.16,-11184.52 32226.06,-11187.73 32230.27,-11193.33"/>
</g>
<!-- l1_attn_stage4_gpu13&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge2270" class="edge">
<title>l1_attn_stage4_gpu13&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32326.3,-11267.36C32340.43,-11261.02 32355.96,-11255.2 32371,-11251.83 32389.49,-11247.69 33039.7,-11255.33 33053,-11241.83 33081.36,-11213.06 33033.79,-11187.22 32988.82,-11170.6"/>
<polygon fill="red" stroke="red" points="32989.88,-11167.26 32979.29,-11167.19 32987.53,-11173.85 32989.88,-11167.26"/>
<text text-anchor="middle" x="33092.5" y="-11230.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu14 -->
<g id="node111" class="node">
<title>l1_attn_stage5_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="32468" cy="-11150.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32468" y="-11161.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="32468" y="-11146.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="32468" y="-11131.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu14&#45;&gt;l1_attn_stage5_gpu14 -->
<g id="edge95" class="edge">
<title>l1_attn_stage4_gpu14&#45;&gt;l1_attn_stage5_gpu14</title>
<path fill="none" stroke="black" d="M32414.74,-11267.22C32400.89,-11260.96 32385.71,-11255.22 32371,-11251.83 32347.17,-11246.34 31948.09,-11259.32 31931,-11241.83 31926.34,-11237.06 31926.33,-11231.59 31931,-11226.83 31939.56,-11218.11 32359.37,-11222.6 32371,-11218.83 32389.45,-11212.86 32407.49,-11202.1 32422.92,-11190.9"/>
<polygon fill="black" stroke="black" points="32425.32,-11193.47 32431.2,-11184.66 32421.11,-11187.88 32425.32,-11193.47"/>
</g>
<!-- l1_attn_stage4_gpu14&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge2271" class="edge">
<title>l1_attn_stage4_gpu14&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32521.3,-11267.39C32535.44,-11261.05 32550.96,-11255.22 32566,-11251.83 32581.53,-11248.33 33127.84,-11253.19 33139,-11241.83 33179.03,-11201.09 33109.32,-11177.74 33039.01,-11164.99"/>
<polygon fill="red" stroke="red" points="33039.55,-11161.53 33029.1,-11163.26 33038.35,-11168.43 33039.55,-11161.53"/>
<text text-anchor="middle" x="33179.5" y="-11230.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu15 -->
<g id="node112" class="node">
<title>l1_attn_stage5_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="32663" cy="-11150.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32663" y="-11161.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="32663" y="-11146.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="32663" y="-11131.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu15&#45;&gt;l1_attn_stage5_gpu15 -->
<g id="edge96" class="edge">
<title>l1_attn_stage4_gpu15&#45;&gt;l1_attn_stage5_gpu15</title>
<path fill="none" stroke="black" d="M32610.02,-11267.26C32596.09,-11260.97 32580.82,-11255.19 32566,-11251.83 32548.99,-11247.97 31950.24,-11254.27 31938,-11241.83 31933.32,-11237.08 31933.32,-11231.58 31938,-11226.83 31950.26,-11214.42 32549.39,-11224.16 32566,-11218.83 32584.46,-11212.91 32602.51,-11202.16 32617.94,-11190.96"/>
<polygon fill="black" stroke="black" points="32620.34,-11193.53 32626.22,-11184.72 32616.13,-11187.94 32620.34,-11193.53"/>
</g>
<!-- l1_attn_stage4_gpu15&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge2272" class="edge">
<title>l1_attn_stage4_gpu15&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32718.38,-11268.02C32733.74,-11261.45 32750.68,-11255.36 32767,-11251.83 32791.87,-11246.45 33207.2,-11260.02 33225,-11241.83 33279.67,-11185.96 33178.45,-11164.29 33079.12,-11156.04"/>
<polygon fill="red" stroke="red" points="33079.15,-11152.53 33068.9,-11155.24 33078.6,-11159.51 33079.15,-11152.53"/>
<text text-anchor="middle" x="33265.5" y="-11230.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu0 -->
<g id="node113" class="node">
<title>l1_attn_stage6_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="29738" cy="-11003.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29738" y="-11014.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="29738" y="-10999.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="29738" y="-10984.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu0&#45;&gt;l1_attn_stage6_gpu0 -->
<g id="edge97" class="edge">
<title>l1_attn_stage5_gpu0&#45;&gt;l1_attn_stage6_gpu0</title>
<path fill="none" stroke="black" d="M29738,-11112.74C29738,-11094.02 29738,-11071.03 29738,-11051.05"/>
<polygon fill="black" stroke="black" points="29741.5,-11050.91 29738,-11040.91 29734.5,-11050.91 29741.5,-11050.91"/>
</g>
<!-- l1_attn_stage6_gpu[next_gpu] -->
<g id="node1350" class="node">
<title>l1_attn_stage6_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="32925" cy="-11003.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="32925" y="-10999.63" font-family="Times,serif" font-size="14.00">l1_attn_stage6_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage5_gpu0&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge2273" class="edge">
<title>l1_attn_stage5_gpu0&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29791.29,-11120.33C29805.43,-11113.99 29820.95,-11108.18 29836,-11104.83 30065.73,-11053.7 31718.66,-11082.38 31954,-11079.83 31998.94,-11079.34 32718.97,-11080.86 32763,-11071.83 32806.87,-11062.83 32853.77,-11041.91 32885.76,-11025.73"/>
<polygon fill="red" stroke="red" points="32887.49,-11028.78 32894.78,-11021.09 32884.28,-11022.55 32887.49,-11028.78"/>
<text text-anchor="middle" x="31985.5" y="-11083.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu1 -->
<g id="node114" class="node">
<title>l1_attn_stage6_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="29933" cy="-11003.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29933" y="-11014.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="29933" y="-10999.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="29933" y="-10984.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu1&#45;&gt;l1_attn_stage6_gpu1 -->
<g id="edge98" class="edge">
<title>l1_attn_stage5_gpu1&#45;&gt;l1_attn_stage6_gpu1</title>
<path fill="none" stroke="black" d="M29933,-11112.74C29933,-11094.02 29933,-11071.03 29933,-11051.05"/>
<polygon fill="black" stroke="black" points="29936.5,-11050.91 29933,-11040.91 29929.5,-11050.91 29936.5,-11050.91"/>
</g>
<!-- l1_attn_stage5_gpu1&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge2274" class="edge">
<title>l1_attn_stage5_gpu1&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29986.28,-11120.26C30000.41,-11113.92 30015.94,-11108.13 30031,-11104.83 30085,-11093 31968.82,-11113.09 32021,-11094.83 32031.15,-11091.28 32029.86,-11083.42 32040,-11079.83 32077.87,-11066.45 32723.66,-11079.93 32763,-11071.83 32806.87,-11062.81 32853.77,-11041.89 32885.76,-11025.72"/>
<polygon fill="red" stroke="red" points="32887.48,-11028.76 32894.78,-11021.08 32884.28,-11022.54 32887.48,-11028.76"/>
<text text-anchor="middle" x="32071.5" y="-11083.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu2 -->
<g id="node115" class="node">
<title>l1_attn_stage6_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="30128" cy="-11003.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30128" y="-11014.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="30128" y="-10999.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="30128" y="-10984.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu2&#45;&gt;l1_attn_stage6_gpu2 -->
<g id="edge99" class="edge">
<title>l1_attn_stage5_gpu2&#45;&gt;l1_attn_stage6_gpu2</title>
<path fill="none" stroke="black" d="M30128,-11112.74C30128,-11094.02 30128,-11071.03 30128,-11051.05"/>
<polygon fill="black" stroke="black" points="30131.5,-11050.91 30128,-11040.91 30124.5,-11050.91 30131.5,-11050.91"/>
</g>
<!-- l1_attn_stage5_gpu2&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge2275" class="edge">
<title>l1_attn_stage5_gpu2&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30181.28,-11120.27C30195.41,-11113.93 30210.94,-11108.13 30226,-11104.83 30277.04,-11093.64 32057.68,-11112.1 32107,-11094.83 32117.15,-11091.28 32115.86,-11083.42 32126,-11079.83 32159.36,-11068.01 32728.34,-11078.99 32763,-11071.83 32806.86,-11062.77 32853.76,-11041.86 32885.75,-11025.7"/>
<polygon fill="red" stroke="red" points="32887.48,-11028.75 32894.77,-11021.07 32884.28,-11022.52 32887.48,-11028.75"/>
<text text-anchor="middle" x="32157.5" y="-11083.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu3 -->
<g id="node116" class="node">
<title>l1_attn_stage6_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="30323" cy="-11003.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30323" y="-11014.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="30323" y="-10999.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="30323" y="-10984.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu3&#45;&gt;l1_attn_stage6_gpu3 -->
<g id="edge100" class="edge">
<title>l1_attn_stage5_gpu3&#45;&gt;l1_attn_stage6_gpu3</title>
<path fill="none" stroke="black" d="M30323,-11112.74C30323,-11094.02 30323,-11071.03 30323,-11051.05"/>
<polygon fill="black" stroke="black" points="30326.5,-11050.91 30323,-11040.91 30319.5,-11050.91 30326.5,-11050.91"/>
</g>
<!-- l1_attn_stage5_gpu3&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge2276" class="edge">
<title>l1_attn_stage5_gpu3&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30376.28,-11120.27C30390.41,-11113.93 30405.94,-11108.13 30421,-11104.83 30469.08,-11094.28 32146.55,-11111.11 32193,-11094.83 32203.15,-11091.27 32201.86,-11083.43 32212,-11079.83 32240.85,-11069.58 32733.02,-11078.05 32763,-11071.83 32806.85,-11062.73 32853.75,-11041.83 32885.75,-11025.67"/>
<polygon fill="red" stroke="red" points="32887.47,-11028.73 32894.77,-11021.05 32884.27,-11022.5 32887.47,-11028.73"/>
<text text-anchor="middle" x="32243.5" y="-11083.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu4 -->
<g id="node117" class="node">
<title>l1_attn_stage6_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="30518" cy="-11003.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30518" y="-11014.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="30518" y="-10999.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="30518" y="-10984.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu4&#45;&gt;l1_attn_stage6_gpu4 -->
<g id="edge101" class="edge">
<title>l1_attn_stage5_gpu4&#45;&gt;l1_attn_stage6_gpu4</title>
<path fill="none" stroke="black" d="M30518,-11112.74C30518,-11094.02 30518,-11071.03 30518,-11051.05"/>
<polygon fill="black" stroke="black" points="30521.5,-11050.91 30518,-11040.91 30514.5,-11050.91 30521.5,-11050.91"/>
</g>
<!-- l1_attn_stage5_gpu4&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge2277" class="edge">
<title>l1_attn_stage5_gpu4&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30571.28,-11120.27C30585.41,-11113.93 30600.94,-11108.14 30616,-11104.83 30661.12,-11094.93 32235.41,-11110.11 32279,-11094.83 32289.15,-11091.27 32287.87,-11083.45 32298,-11079.83 32346.67,-11062.47 32712.42,-11082.4 32763,-11071.83 32806.84,-11062.67 32853.74,-11041.78 32885.74,-11025.64"/>
<polygon fill="red" stroke="red" points="32887.46,-11028.7 32894.76,-11021.02 32884.27,-11022.47 32887.46,-11028.7"/>
<text text-anchor="middle" x="32329.5" y="-11083.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu5 -->
<g id="node118" class="node">
<title>l1_attn_stage6_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="30713" cy="-11003.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30713" y="-11014.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="30713" y="-10999.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="30713" y="-10984.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu5&#45;&gt;l1_attn_stage6_gpu5 -->
<g id="edge102" class="edge">
<title>l1_attn_stage5_gpu5&#45;&gt;l1_attn_stage6_gpu5</title>
<path fill="none" stroke="black" d="M30713,-11112.74C30713,-11094.02 30713,-11071.03 30713,-11051.05"/>
<polygon fill="black" stroke="black" points="30716.5,-11050.91 30713,-11040.91 30709.5,-11050.91 30716.5,-11050.91"/>
</g>
<!-- l1_attn_stage5_gpu5&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge2278" class="edge">
<title>l1_attn_stage5_gpu5&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30766.28,-11120.28C30780.41,-11113.94 30795.94,-11108.14 30811,-11104.83 30853.16,-11095.57 32324.27,-11109.12 32365,-11094.83 32375.15,-11091.27 32373.87,-11083.47 32384,-11079.83 32423.64,-11065.6 32721.79,-11080.53 32763,-11071.83 32806.82,-11062.59 32853.73,-11041.7 32885.73,-11025.6"/>
<polygon fill="red" stroke="red" points="32887.45,-11028.65 32894.75,-11020.98 32884.26,-11022.42 32887.45,-11028.65"/>
<text text-anchor="middle" x="32415.5" y="-11083.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu6 -->
<g id="node119" class="node">
<title>l1_attn_stage6_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="30908" cy="-11003.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30908" y="-11014.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="30908" y="-10999.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="30908" y="-10984.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu6&#45;&gt;l1_attn_stage6_gpu6 -->
<g id="edge103" class="edge">
<title>l1_attn_stage5_gpu6&#45;&gt;l1_attn_stage6_gpu6</title>
<path fill="none" stroke="black" d="M30908,-11112.74C30908,-11094.02 30908,-11071.03 30908,-11051.05"/>
<polygon fill="black" stroke="black" points="30911.5,-11050.91 30908,-11040.91 30904.5,-11050.91 30911.5,-11050.91"/>
</g>
<!-- l1_attn_stage5_gpu6&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge2279" class="edge">
<title>l1_attn_stage5_gpu6&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30961.28,-11120.28C30975.41,-11113.94 30990.94,-11108.14 31006,-11104.83 31045.2,-11096.21 32413.13,-11108.13 32451,-11094.83 32461.15,-11091.27 32459.89,-11083.5 32470,-11079.83 32500.62,-11068.73 32731.15,-11078.65 32763,-11071.83 32806.66,-11062.48 32853.41,-11041.72 32885.42,-11025.67"/>
<polygon fill="red" stroke="red" points="32887.12,-11028.73 32894.45,-11021.07 32883.95,-11022.49 32887.12,-11028.73"/>
<text text-anchor="middle" x="32501.5" y="-11083.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu7 -->
<g id="node120" class="node">
<title>l1_attn_stage6_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="31103" cy="-11003.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31103" y="-11014.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="31103" y="-10999.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="31103" y="-10984.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu7&#45;&gt;l1_attn_stage6_gpu7 -->
<g id="edge104" class="edge">
<title>l1_attn_stage5_gpu7&#45;&gt;l1_attn_stage6_gpu7</title>
<path fill="none" stroke="black" d="M31103,-11112.74C31103,-11094.02 31103,-11071.03 31103,-11051.05"/>
<polygon fill="black" stroke="black" points="31106.5,-11050.91 31103,-11040.91 31099.5,-11050.91 31106.5,-11050.91"/>
</g>
<!-- l1_attn_stage5_gpu7&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge2280" class="edge">
<title>l1_attn_stage5_gpu7&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31156.28,-11120.29C31170.42,-11113.95 31185.95,-11108.15 31201,-11104.83 31237.24,-11096.85 32501.99,-11107.13 32537,-11094.83 32547.15,-11091.27 32545.91,-11083.56 32556,-11079.83 32599.19,-11063.9 32718.04,-11081.73 32763,-11071.83 32806.6,-11062.23 32853.37,-11041.51 32885.39,-11025.54"/>
<polygon fill="red" stroke="red" points="32887.08,-11028.6 32894.42,-11020.96 32883.92,-11022.36 32887.08,-11028.6"/>
<text text-anchor="middle" x="32587.5" y="-11083.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu8 -->
<g id="node121" class="node">
<title>l1_attn_stage6_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="31298" cy="-11003.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31298" y="-11014.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="31298" y="-10999.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="31298" y="-10984.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu8&#45;&gt;l1_attn_stage6_gpu8 -->
<g id="edge105" class="edge">
<title>l1_attn_stage5_gpu8&#45;&gt;l1_attn_stage6_gpu8</title>
<path fill="none" stroke="black" d="M31298,-11112.74C31298,-11094.02 31298,-11071.03 31298,-11051.05"/>
<polygon fill="black" stroke="black" points="31301.5,-11050.91 31298,-11040.91 31294.5,-11050.91 31301.5,-11050.91"/>
</g>
<!-- l1_attn_stage5_gpu8&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge2281" class="edge">
<title>l1_attn_stage5_gpu8&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31351.28,-11120.3C31365.42,-11113.96 31380.95,-11108.15 31396,-11104.83 31462.57,-11090.14 32558.69,-11117.45 32623,-11094.83 32633.15,-11091.26 32631.96,-11083.69 32642,-11079.83 32692.3,-11060.49 32710.53,-11084.14 32763,-11071.83 32806.2,-11061.7 32852.67,-11041.25 32884.71,-11025.5"/>
<polygon fill="red" stroke="red" points="32886.38,-11028.59 32893.77,-11020.99 32883.25,-11022.32 32886.38,-11028.59"/>
<text text-anchor="middle" x="32673.5" y="-11083.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu9 -->
<g id="node122" class="node">
<title>l1_attn_stage6_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="31493" cy="-11003.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31493" y="-11014.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="31493" y="-10999.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="31493" y="-10984.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu9&#45;&gt;l1_attn_stage6_gpu9 -->
<g id="edge106" class="edge">
<title>l1_attn_stage5_gpu9&#45;&gt;l1_attn_stage6_gpu9</title>
<path fill="none" stroke="black" d="M31493,-11112.74C31493,-11094.02 31493,-11071.03 31493,-11051.05"/>
<polygon fill="black" stroke="black" points="31496.5,-11050.91 31493,-11040.91 31489.5,-11050.91 31496.5,-11050.91"/>
</g>
<!-- l1_attn_stage5_gpu9&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge2282" class="edge">
<title>l1_attn_stage5_gpu9&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31546.28,-11120.3C31560.42,-11113.96 31575.95,-11108.16 31591,-11104.83 31651.65,-11091.42 32650.41,-11115.46 32709,-11094.83 32719.15,-11091.26 32718.3,-11084.48 32728,-11079.83 32742.39,-11072.94 32747.8,-11076.7 32763,-11071.83 32803.94,-11058.73 32848.95,-11039.57 32881.12,-11025.01"/>
<polygon fill="red" stroke="red" points="32882.61,-11028.17 32890.25,-11020.84 32879.7,-11021.81 32882.61,-11028.17"/>
<text text-anchor="middle" x="32759.5" y="-11083.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu10 -->
<g id="node123" class="node">
<title>l1_attn_stage6_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="31688" cy="-11003.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31688" y="-11014.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="31688" y="-10999.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="31688" y="-10984.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu10&#45;&gt;l1_attn_stage6_gpu10 -->
<g id="edge107" class="edge">
<title>l1_attn_stage5_gpu10&#45;&gt;l1_attn_stage6_gpu10</title>
<path fill="none" stroke="black" d="M31688,-11112.74C31688,-11094.02 31688,-11071.03 31688,-11051.05"/>
<polygon fill="black" stroke="black" points="31691.5,-11050.91 31688,-11040.91 31684.5,-11050.91 31691.5,-11050.91"/>
</g>
<!-- l1_attn_stage5_gpu10&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge2283" class="edge">
<title>l1_attn_stage5_gpu10&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31741.29,-11120.31C31755.42,-11113.97 31770.95,-11108.17 31786,-11104.83 31840.73,-11092.7 32742.13,-11113.48 32795,-11094.83 32805.15,-11091.25 32805.32,-11086.19 32814,-11079.83 32839.22,-11061.34 32868.5,-11041.49 32890.65,-11026.78"/>
<polygon fill="red" stroke="red" points="32892.66,-11029.65 32899.07,-11021.22 32888.8,-11023.81 32892.66,-11029.65"/>
<text text-anchor="middle" x="32845.5" y="-11083.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu11 -->
<g id="node124" class="node">
<title>l1_attn_stage6_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="31883" cy="-11003.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31883" y="-11014.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="31883" y="-10999.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="31883" y="-10984.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu11&#45;&gt;l1_attn_stage6_gpu11 -->
<g id="edge108" class="edge">
<title>l1_attn_stage5_gpu11&#45;&gt;l1_attn_stage6_gpu11</title>
<path fill="none" stroke="black" d="M31883,-11112.74C31883,-11094.02 31883,-11071.03 31883,-11051.05"/>
<polygon fill="black" stroke="black" points="31886.5,-11050.91 31883,-11040.91 31879.5,-11050.91 31886.5,-11050.91"/>
</g>
<!-- l1_attn_stage5_gpu11&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge2284" class="edge">
<title>l1_attn_stage5_gpu11&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31936.29,-11120.33C31950.42,-11113.99 31965.95,-11108.18 31981,-11104.83 32005.41,-11099.41 32859.88,-11108.21 32881,-11094.83 32902.94,-11080.93 32914.24,-11052.65 32919.85,-11031.39"/>
<polygon fill="red" stroke="red" points="32923.27,-11032.14 32922.18,-11021.6 32916.46,-11030.52 32923.27,-11032.14"/>
<text text-anchor="middle" x="32927.5" y="-11083.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu12 -->
<g id="node125" class="node">
<title>l1_attn_stage6_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="32078" cy="-11003.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32078" y="-11014.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="32078" y="-10999.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="32078" y="-10984.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu12&#45;&gt;l1_attn_stage6_gpu12 -->
<g id="edge109" class="edge">
<title>l1_attn_stage5_gpu12&#45;&gt;l1_attn_stage6_gpu12</title>
<path fill="none" stroke="black" d="M32022.85,-11120.87C32009.43,-11114.83 31994.93,-11109.03 31981,-11104.83 31967.22,-11100.68 31926.36,-11105.77 31917,-11094.83 31882.08,-11054.03 31922.79,-11094.15 31981,-11071.83 31998.78,-11065.01 32016.42,-11054.27 32031.68,-11043.34"/>
<polygon fill="black" stroke="black" points="32033.93,-11046.02 32039.9,-11037.27 32029.77,-11040.39 32033.93,-11046.02"/>
</g>
<!-- l1_attn_stage5_gpu12&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge2285" class="edge">
<title>l1_attn_stage5_gpu12&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32131.29,-11120.34C32145.43,-11114 32160.95,-11108.19 32176,-11104.83 32197.45,-11100.05 32951.56,-11110.47 32967,-11094.83 32985.16,-11076.44 32967.89,-11048.75 32950.31,-11028.84"/>
<polygon fill="red" stroke="red" points="32952.75,-11026.32 32943.38,-11021.37 32947.61,-11031.08 32952.75,-11026.32"/>
<text text-anchor="middle" x="33005.5" y="-11083.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu13 -->
<g id="node126" class="node">
<title>l1_attn_stage6_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="32273" cy="-11003.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32273" y="-11014.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="32273" y="-10999.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="32273" y="-10984.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu13&#45;&gt;l1_attn_stage6_gpu13 -->
<g id="edge110" class="edge">
<title>l1_attn_stage5_gpu13&#45;&gt;l1_attn_stage6_gpu13</title>
<path fill="none" stroke="black" d="M32219.7,-11120.39C32205.85,-11114.13 32190.69,-11108.35 32176,-11104.83 32162.37,-11101.57 31933.71,-11104.93 31924,-11094.83 31919.38,-11090.03 31919.36,-11084.62 31924,-11079.83 31933.75,-11069.77 32162.7,-11076.24 32176,-11071.83 32194.4,-11065.74 32212.44,-11054.94 32227.87,-11043.75"/>
<polygon fill="black" stroke="black" points="32230.27,-11046.33 32236.16,-11037.52 32226.06,-11040.73 32230.27,-11046.33"/>
</g>
<!-- l1_attn_stage5_gpu13&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge2286" class="edge">
<title>l1_attn_stage5_gpu13&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32326.3,-11120.36C32340.43,-11114.02 32355.96,-11108.2 32371,-11104.83 32389.49,-11100.69 33039.7,-11108.33 33053,-11094.83 33081.36,-11066.06 33033.79,-11040.22 32988.82,-11023.6"/>
<polygon fill="red" stroke="red" points="32989.88,-11020.26 32979.29,-11020.19 32987.53,-11026.85 32989.88,-11020.26"/>
<text text-anchor="middle" x="33092.5" y="-11083.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu14 -->
<g id="node127" class="node">
<title>l1_attn_stage6_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="32468" cy="-11003.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32468" y="-11014.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="32468" y="-10999.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="32468" y="-10984.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu14&#45;&gt;l1_attn_stage6_gpu14 -->
<g id="edge111" class="edge">
<title>l1_attn_stage5_gpu14&#45;&gt;l1_attn_stage6_gpu14</title>
<path fill="none" stroke="black" d="M32414.74,-11120.22C32400.89,-11113.96 32385.71,-11108.22 32371,-11104.83 32347.17,-11099.34 31948.09,-11112.32 31931,-11094.83 31926.34,-11090.06 31926.33,-11084.59 31931,-11079.83 31939.56,-11071.11 32359.37,-11075.6 32371,-11071.83 32389.45,-11065.86 32407.49,-11055.1 32422.92,-11043.9"/>
<polygon fill="black" stroke="black" points="32425.32,-11046.47 32431.2,-11037.66 32421.11,-11040.88 32425.32,-11046.47"/>
</g>
<!-- l1_attn_stage5_gpu14&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge2287" class="edge">
<title>l1_attn_stage5_gpu14&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32521.3,-11120.39C32535.44,-11114.05 32550.96,-11108.22 32566,-11104.83 32581.53,-11101.33 33127.84,-11106.19 33139,-11094.83 33179.03,-11054.09 33109.32,-11030.74 33039.01,-11017.99"/>
<polygon fill="red" stroke="red" points="33039.55,-11014.53 33029.1,-11016.26 33038.35,-11021.43 33039.55,-11014.53"/>
<text text-anchor="middle" x="33179.5" y="-11083.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu15 -->
<g id="node128" class="node">
<title>l1_attn_stage6_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="32663" cy="-11003.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32663" y="-11014.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="32663" y="-10999.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="32663" y="-10984.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu15&#45;&gt;l1_attn_stage6_gpu15 -->
<g id="edge112" class="edge">
<title>l1_attn_stage5_gpu15&#45;&gt;l1_attn_stage6_gpu15</title>
<path fill="none" stroke="black" d="M32610.02,-11120.26C32596.09,-11113.97 32580.82,-11108.19 32566,-11104.83 32548.99,-11100.97 31950.24,-11107.27 31938,-11094.83 31933.32,-11090.08 31933.32,-11084.58 31938,-11079.83 31950.26,-11067.42 32549.39,-11077.16 32566,-11071.83 32584.46,-11065.91 32602.51,-11055.16 32617.94,-11043.96"/>
<polygon fill="black" stroke="black" points="32620.34,-11046.53 32626.22,-11037.72 32616.13,-11040.94 32620.34,-11046.53"/>
</g>
<!-- l1_attn_stage5_gpu15&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge2288" class="edge">
<title>l1_attn_stage5_gpu15&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32718.38,-11121.02C32733.74,-11114.45 32750.68,-11108.36 32767,-11104.83 32791.87,-11099.45 33207.2,-11113.02 33225,-11094.83 33279.67,-11038.96 33178.45,-11017.29 33079.12,-11009.04"/>
<polygon fill="red" stroke="red" points="33079.15,-11005.53 33068.9,-11008.24 33078.6,-11012.51 33079.15,-11005.53"/>
<text text-anchor="middle" x="33265.5" y="-11083.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu0 -->
<g id="node129" class="node">
<title>l1_attn_stage7_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="29738" cy="-10856.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29738" y="-10867.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="29738" y="-10852.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="29738" y="-10837.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu0&#45;&gt;l1_attn_stage7_gpu0 -->
<g id="edge113" class="edge">
<title>l1_attn_stage6_gpu0&#45;&gt;l1_attn_stage7_gpu0</title>
<path fill="none" stroke="black" d="M29738,-10965.74C29738,-10947.02 29738,-10924.03 29738,-10904.05"/>
<polygon fill="black" stroke="black" points="29741.5,-10903.91 29738,-10893.91 29734.5,-10903.91 29741.5,-10903.91"/>
</g>
<!-- l1_attn_stage7_gpu[next_gpu] -->
<g id="node1351" class="node">
<title>l1_attn_stage7_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="32925" cy="-10856.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="32925" y="-10852.63" font-family="Times,serif" font-size="14.00">l1_attn_stage7_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage6_gpu0&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge2289" class="edge">
<title>l1_attn_stage6_gpu0&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29791.29,-10973.33C29805.43,-10966.99 29820.95,-10961.18 29836,-10957.83 30065.73,-10906.7 31718.66,-10935.38 31954,-10932.83 31998.94,-10932.34 32718.97,-10933.86 32763,-10924.83 32806.87,-10915.83 32853.77,-10894.91 32885.76,-10878.73"/>
<polygon fill="red" stroke="red" points="32887.49,-10881.78 32894.78,-10874.09 32884.28,-10875.55 32887.49,-10881.78"/>
<text text-anchor="middle" x="31985.5" y="-10936.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu1 -->
<g id="node130" class="node">
<title>l1_attn_stage7_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="29933" cy="-10856.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29933" y="-10867.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="29933" y="-10852.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="29933" y="-10837.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu1&#45;&gt;l1_attn_stage7_gpu1 -->
<g id="edge114" class="edge">
<title>l1_attn_stage6_gpu1&#45;&gt;l1_attn_stage7_gpu1</title>
<path fill="none" stroke="black" d="M29933,-10965.74C29933,-10947.02 29933,-10924.03 29933,-10904.05"/>
<polygon fill="black" stroke="black" points="29936.5,-10903.91 29933,-10893.91 29929.5,-10903.91 29936.5,-10903.91"/>
</g>
<!-- l1_attn_stage6_gpu1&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge2290" class="edge">
<title>l1_attn_stage6_gpu1&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29986.28,-10973.26C30000.41,-10966.92 30015.94,-10961.13 30031,-10957.83 30085,-10946 31968.82,-10966.09 32021,-10947.83 32031.15,-10944.28 32029.86,-10936.42 32040,-10932.83 32077.87,-10919.45 32723.66,-10932.93 32763,-10924.83 32806.87,-10915.81 32853.77,-10894.89 32885.76,-10878.72"/>
<polygon fill="red" stroke="red" points="32887.48,-10881.76 32894.78,-10874.08 32884.28,-10875.54 32887.48,-10881.76"/>
<text text-anchor="middle" x="32071.5" y="-10936.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu2 -->
<g id="node131" class="node">
<title>l1_attn_stage7_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="30128" cy="-10856.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30128" y="-10867.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="30128" y="-10852.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="30128" y="-10837.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu2&#45;&gt;l1_attn_stage7_gpu2 -->
<g id="edge115" class="edge">
<title>l1_attn_stage6_gpu2&#45;&gt;l1_attn_stage7_gpu2</title>
<path fill="none" stroke="black" d="M30128,-10965.74C30128,-10947.02 30128,-10924.03 30128,-10904.05"/>
<polygon fill="black" stroke="black" points="30131.5,-10903.91 30128,-10893.91 30124.5,-10903.91 30131.5,-10903.91"/>
</g>
<!-- l1_attn_stage6_gpu2&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge2291" class="edge">
<title>l1_attn_stage6_gpu2&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30181.28,-10973.27C30195.41,-10966.93 30210.94,-10961.13 30226,-10957.83 30277.04,-10946.64 32057.68,-10965.1 32107,-10947.83 32117.15,-10944.28 32115.86,-10936.42 32126,-10932.83 32159.36,-10921.01 32728.34,-10931.99 32763,-10924.83 32806.86,-10915.77 32853.76,-10894.86 32885.75,-10878.7"/>
<polygon fill="red" stroke="red" points="32887.48,-10881.75 32894.77,-10874.07 32884.28,-10875.52 32887.48,-10881.75"/>
<text text-anchor="middle" x="32157.5" y="-10936.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu3 -->
<g id="node132" class="node">
<title>l1_attn_stage7_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="30323" cy="-10856.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30323" y="-10867.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="30323" y="-10852.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="30323" y="-10837.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu3&#45;&gt;l1_attn_stage7_gpu3 -->
<g id="edge116" class="edge">
<title>l1_attn_stage6_gpu3&#45;&gt;l1_attn_stage7_gpu3</title>
<path fill="none" stroke="black" d="M30323,-10965.74C30323,-10947.02 30323,-10924.03 30323,-10904.05"/>
<polygon fill="black" stroke="black" points="30326.5,-10903.91 30323,-10893.91 30319.5,-10903.91 30326.5,-10903.91"/>
</g>
<!-- l1_attn_stage6_gpu3&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge2292" class="edge">
<title>l1_attn_stage6_gpu3&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30376.28,-10973.27C30390.41,-10966.93 30405.94,-10961.13 30421,-10957.83 30469.08,-10947.28 32146.55,-10964.11 32193,-10947.83 32203.15,-10944.27 32201.86,-10936.43 32212,-10932.83 32240.85,-10922.58 32733.02,-10931.05 32763,-10924.83 32806.85,-10915.73 32853.75,-10894.83 32885.75,-10878.67"/>
<polygon fill="red" stroke="red" points="32887.47,-10881.73 32894.77,-10874.05 32884.27,-10875.5 32887.47,-10881.73"/>
<text text-anchor="middle" x="32243.5" y="-10936.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu4 -->
<g id="node133" class="node">
<title>l1_attn_stage7_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="30518" cy="-10856.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30518" y="-10867.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="30518" y="-10852.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="30518" y="-10837.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu4&#45;&gt;l1_attn_stage7_gpu4 -->
<g id="edge117" class="edge">
<title>l1_attn_stage6_gpu4&#45;&gt;l1_attn_stage7_gpu4</title>
<path fill="none" stroke="black" d="M30518,-10965.74C30518,-10947.02 30518,-10924.03 30518,-10904.05"/>
<polygon fill="black" stroke="black" points="30521.5,-10903.91 30518,-10893.91 30514.5,-10903.91 30521.5,-10903.91"/>
</g>
<!-- l1_attn_stage6_gpu4&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge2293" class="edge">
<title>l1_attn_stage6_gpu4&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30571.28,-10973.27C30585.41,-10966.93 30600.94,-10961.14 30616,-10957.83 30661.12,-10947.93 32235.41,-10963.11 32279,-10947.83 32289.15,-10944.27 32287.87,-10936.45 32298,-10932.83 32346.67,-10915.47 32712.42,-10935.4 32763,-10924.83 32806.84,-10915.67 32853.74,-10894.78 32885.74,-10878.64"/>
<polygon fill="red" stroke="red" points="32887.46,-10881.7 32894.76,-10874.02 32884.27,-10875.47 32887.46,-10881.7"/>
<text text-anchor="middle" x="32329.5" y="-10936.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu5 -->
<g id="node134" class="node">
<title>l1_attn_stage7_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="30713" cy="-10856.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30713" y="-10867.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="30713" y="-10852.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="30713" y="-10837.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu5&#45;&gt;l1_attn_stage7_gpu5 -->
<g id="edge118" class="edge">
<title>l1_attn_stage6_gpu5&#45;&gt;l1_attn_stage7_gpu5</title>
<path fill="none" stroke="black" d="M30713,-10965.74C30713,-10947.02 30713,-10924.03 30713,-10904.05"/>
<polygon fill="black" stroke="black" points="30716.5,-10903.91 30713,-10893.91 30709.5,-10903.91 30716.5,-10903.91"/>
</g>
<!-- l1_attn_stage6_gpu5&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge2294" class="edge">
<title>l1_attn_stage6_gpu5&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30766.28,-10973.28C30780.41,-10966.94 30795.94,-10961.14 30811,-10957.83 30853.16,-10948.57 32324.27,-10962.12 32365,-10947.83 32375.15,-10944.27 32373.87,-10936.47 32384,-10932.83 32423.64,-10918.6 32721.79,-10933.53 32763,-10924.83 32806.82,-10915.59 32853.73,-10894.7 32885.73,-10878.6"/>
<polygon fill="red" stroke="red" points="32887.45,-10881.65 32894.75,-10873.98 32884.26,-10875.42 32887.45,-10881.65"/>
<text text-anchor="middle" x="32415.5" y="-10936.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu6 -->
<g id="node135" class="node">
<title>l1_attn_stage7_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="30908" cy="-10856.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30908" y="-10867.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="30908" y="-10852.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="30908" y="-10837.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu6&#45;&gt;l1_attn_stage7_gpu6 -->
<g id="edge119" class="edge">
<title>l1_attn_stage6_gpu6&#45;&gt;l1_attn_stage7_gpu6</title>
<path fill="none" stroke="black" d="M30908,-10965.74C30908,-10947.02 30908,-10924.03 30908,-10904.05"/>
<polygon fill="black" stroke="black" points="30911.5,-10903.91 30908,-10893.91 30904.5,-10903.91 30911.5,-10903.91"/>
</g>
<!-- l1_attn_stage6_gpu6&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge2295" class="edge">
<title>l1_attn_stage6_gpu6&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30961.28,-10973.28C30975.41,-10966.94 30990.94,-10961.14 31006,-10957.83 31045.2,-10949.21 32413.13,-10961.13 32451,-10947.83 32461.15,-10944.27 32459.89,-10936.5 32470,-10932.83 32500.62,-10921.73 32731.15,-10931.65 32763,-10924.83 32806.66,-10915.48 32853.41,-10894.72 32885.42,-10878.67"/>
<polygon fill="red" stroke="red" points="32887.12,-10881.73 32894.45,-10874.07 32883.95,-10875.49 32887.12,-10881.73"/>
<text text-anchor="middle" x="32501.5" y="-10936.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu7 -->
<g id="node136" class="node">
<title>l1_attn_stage7_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="31103" cy="-10856.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31103" y="-10867.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="31103" y="-10852.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="31103" y="-10837.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu7&#45;&gt;l1_attn_stage7_gpu7 -->
<g id="edge120" class="edge">
<title>l1_attn_stage6_gpu7&#45;&gt;l1_attn_stage7_gpu7</title>
<path fill="none" stroke="black" d="M31103,-10965.74C31103,-10947.02 31103,-10924.03 31103,-10904.05"/>
<polygon fill="black" stroke="black" points="31106.5,-10903.91 31103,-10893.91 31099.5,-10903.91 31106.5,-10903.91"/>
</g>
<!-- l1_attn_stage6_gpu7&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge2296" class="edge">
<title>l1_attn_stage6_gpu7&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31156.28,-10973.29C31170.42,-10966.95 31185.95,-10961.15 31201,-10957.83 31237.24,-10949.85 32501.99,-10960.13 32537,-10947.83 32547.15,-10944.27 32545.91,-10936.56 32556,-10932.83 32599.19,-10916.9 32718.04,-10934.73 32763,-10924.83 32806.6,-10915.23 32853.37,-10894.51 32885.39,-10878.54"/>
<polygon fill="red" stroke="red" points="32887.08,-10881.6 32894.42,-10873.96 32883.92,-10875.36 32887.08,-10881.6"/>
<text text-anchor="middle" x="32587.5" y="-10936.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu8 -->
<g id="node137" class="node">
<title>l1_attn_stage7_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="31298" cy="-10856.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31298" y="-10867.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="31298" y="-10852.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="31298" y="-10837.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu8&#45;&gt;l1_attn_stage7_gpu8 -->
<g id="edge121" class="edge">
<title>l1_attn_stage6_gpu8&#45;&gt;l1_attn_stage7_gpu8</title>
<path fill="none" stroke="black" d="M31298,-10965.74C31298,-10947.02 31298,-10924.03 31298,-10904.05"/>
<polygon fill="black" stroke="black" points="31301.5,-10903.91 31298,-10893.91 31294.5,-10903.91 31301.5,-10903.91"/>
</g>
<!-- l1_attn_stage6_gpu8&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge2297" class="edge">
<title>l1_attn_stage6_gpu8&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31351.28,-10973.3C31365.42,-10966.96 31380.95,-10961.15 31396,-10957.83 31462.57,-10943.14 32558.69,-10970.45 32623,-10947.83 32633.15,-10944.26 32631.96,-10936.69 32642,-10932.83 32692.3,-10913.49 32710.53,-10937.14 32763,-10924.83 32806.2,-10914.7 32852.67,-10894.25 32884.71,-10878.5"/>
<polygon fill="red" stroke="red" points="32886.38,-10881.59 32893.77,-10873.99 32883.25,-10875.32 32886.38,-10881.59"/>
<text text-anchor="middle" x="32673.5" y="-10936.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu9 -->
<g id="node138" class="node">
<title>l1_attn_stage7_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="31493" cy="-10856.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31493" y="-10867.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="31493" y="-10852.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="31493" y="-10837.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu9&#45;&gt;l1_attn_stage7_gpu9 -->
<g id="edge122" class="edge">
<title>l1_attn_stage6_gpu9&#45;&gt;l1_attn_stage7_gpu9</title>
<path fill="none" stroke="black" d="M31493,-10965.74C31493,-10947.02 31493,-10924.03 31493,-10904.05"/>
<polygon fill="black" stroke="black" points="31496.5,-10903.91 31493,-10893.91 31489.5,-10903.91 31496.5,-10903.91"/>
</g>
<!-- l1_attn_stage6_gpu9&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge2298" class="edge">
<title>l1_attn_stage6_gpu9&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31546.28,-10973.3C31560.42,-10966.96 31575.95,-10961.16 31591,-10957.83 31651.65,-10944.42 32650.41,-10968.46 32709,-10947.83 32719.15,-10944.26 32718.3,-10937.48 32728,-10932.83 32742.39,-10925.94 32747.8,-10929.7 32763,-10924.83 32803.94,-10911.73 32848.95,-10892.57 32881.12,-10878.01"/>
<polygon fill="red" stroke="red" points="32882.61,-10881.17 32890.25,-10873.84 32879.7,-10874.81 32882.61,-10881.17"/>
<text text-anchor="middle" x="32759.5" y="-10936.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu10 -->
<g id="node139" class="node">
<title>l1_attn_stage7_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="31688" cy="-10856.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31688" y="-10867.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="31688" y="-10852.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="31688" y="-10837.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu10&#45;&gt;l1_attn_stage7_gpu10 -->
<g id="edge123" class="edge">
<title>l1_attn_stage6_gpu10&#45;&gt;l1_attn_stage7_gpu10</title>
<path fill="none" stroke="black" d="M31688,-10965.74C31688,-10947.02 31688,-10924.03 31688,-10904.05"/>
<polygon fill="black" stroke="black" points="31691.5,-10903.91 31688,-10893.91 31684.5,-10903.91 31691.5,-10903.91"/>
</g>
<!-- l1_attn_stage6_gpu10&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge2299" class="edge">
<title>l1_attn_stage6_gpu10&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31741.29,-10973.31C31755.42,-10966.97 31770.95,-10961.17 31786,-10957.83 31840.73,-10945.7 32742.13,-10966.48 32795,-10947.83 32805.15,-10944.25 32805.32,-10939.19 32814,-10932.83 32839.22,-10914.34 32868.5,-10894.49 32890.65,-10879.78"/>
<polygon fill="red" stroke="red" points="32892.66,-10882.65 32899.07,-10874.22 32888.8,-10876.81 32892.66,-10882.65"/>
<text text-anchor="middle" x="32845.5" y="-10936.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu11 -->
<g id="node140" class="node">
<title>l1_attn_stage7_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="31883" cy="-10856.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31883" y="-10867.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="31883" y="-10852.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="31883" y="-10837.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu11&#45;&gt;l1_attn_stage7_gpu11 -->
<g id="edge124" class="edge">
<title>l1_attn_stage6_gpu11&#45;&gt;l1_attn_stage7_gpu11</title>
<path fill="none" stroke="black" d="M31883,-10965.74C31883,-10947.02 31883,-10924.03 31883,-10904.05"/>
<polygon fill="black" stroke="black" points="31886.5,-10903.91 31883,-10893.91 31879.5,-10903.91 31886.5,-10903.91"/>
</g>
<!-- l1_attn_stage6_gpu11&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge2300" class="edge">
<title>l1_attn_stage6_gpu11&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31936.29,-10973.33C31950.42,-10966.99 31965.95,-10961.18 31981,-10957.83 32005.41,-10952.41 32859.88,-10961.21 32881,-10947.83 32902.94,-10933.93 32914.24,-10905.65 32919.85,-10884.39"/>
<polygon fill="red" stroke="red" points="32923.27,-10885.14 32922.18,-10874.6 32916.46,-10883.52 32923.27,-10885.14"/>
<text text-anchor="middle" x="32927.5" y="-10936.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu12 -->
<g id="node141" class="node">
<title>l1_attn_stage7_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="32078" cy="-10856.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32078" y="-10867.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="32078" y="-10852.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="32078" y="-10837.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu12&#45;&gt;l1_attn_stage7_gpu12 -->
<g id="edge125" class="edge">
<title>l1_attn_stage6_gpu12&#45;&gt;l1_attn_stage7_gpu12</title>
<path fill="none" stroke="black" d="M32022.85,-10973.87C32009.43,-10967.83 31994.93,-10962.03 31981,-10957.83 31967.22,-10953.68 31926.36,-10958.77 31917,-10947.83 31882.08,-10907.03 31922.79,-10947.15 31981,-10924.83 31998.78,-10918.01 32016.42,-10907.27 32031.68,-10896.34"/>
<polygon fill="black" stroke="black" points="32033.93,-10899.02 32039.9,-10890.27 32029.77,-10893.39 32033.93,-10899.02"/>
</g>
<!-- l1_attn_stage6_gpu12&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge2301" class="edge">
<title>l1_attn_stage6_gpu12&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32131.29,-10973.34C32145.43,-10967 32160.95,-10961.19 32176,-10957.83 32197.45,-10953.05 32951.56,-10963.47 32967,-10947.83 32985.16,-10929.44 32967.89,-10901.75 32950.31,-10881.84"/>
<polygon fill="red" stroke="red" points="32952.75,-10879.32 32943.38,-10874.37 32947.61,-10884.08 32952.75,-10879.32"/>
<text text-anchor="middle" x="33005.5" y="-10936.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu13 -->
<g id="node142" class="node">
<title>l1_attn_stage7_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="32273" cy="-10856.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32273" y="-10867.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="32273" y="-10852.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="32273" y="-10837.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu13&#45;&gt;l1_attn_stage7_gpu13 -->
<g id="edge126" class="edge">
<title>l1_attn_stage6_gpu13&#45;&gt;l1_attn_stage7_gpu13</title>
<path fill="none" stroke="black" d="M32219.7,-10973.39C32205.85,-10967.13 32190.69,-10961.35 32176,-10957.83 32162.37,-10954.57 31933.71,-10957.93 31924,-10947.83 31919.38,-10943.03 31919.36,-10937.62 31924,-10932.83 31933.75,-10922.77 32162.7,-10929.24 32176,-10924.83 32194.4,-10918.74 32212.44,-10907.94 32227.87,-10896.75"/>
<polygon fill="black" stroke="black" points="32230.27,-10899.33 32236.16,-10890.52 32226.06,-10893.73 32230.27,-10899.33"/>
</g>
<!-- l1_attn_stage6_gpu13&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge2302" class="edge">
<title>l1_attn_stage6_gpu13&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32326.3,-10973.36C32340.43,-10967.02 32355.96,-10961.2 32371,-10957.83 32389.49,-10953.69 33039.7,-10961.33 33053,-10947.83 33081.36,-10919.06 33033.79,-10893.22 32988.82,-10876.6"/>
<polygon fill="red" stroke="red" points="32989.88,-10873.26 32979.29,-10873.19 32987.53,-10879.85 32989.88,-10873.26"/>
<text text-anchor="middle" x="33092.5" y="-10936.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu14 -->
<g id="node143" class="node">
<title>l1_attn_stage7_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="32468" cy="-10856.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32468" y="-10867.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="32468" y="-10852.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="32468" y="-10837.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu14&#45;&gt;l1_attn_stage7_gpu14 -->
<g id="edge127" class="edge">
<title>l1_attn_stage6_gpu14&#45;&gt;l1_attn_stage7_gpu14</title>
<path fill="none" stroke="black" d="M32414.74,-10973.22C32400.89,-10966.96 32385.71,-10961.22 32371,-10957.83 32347.17,-10952.34 31948.09,-10965.32 31931,-10947.83 31926.34,-10943.06 31926.33,-10937.59 31931,-10932.83 31939.56,-10924.11 32359.37,-10928.6 32371,-10924.83 32389.45,-10918.86 32407.49,-10908.1 32422.92,-10896.9"/>
<polygon fill="black" stroke="black" points="32425.32,-10899.47 32431.2,-10890.66 32421.11,-10893.88 32425.32,-10899.47"/>
</g>
<!-- l1_attn_stage6_gpu14&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge2303" class="edge">
<title>l1_attn_stage6_gpu14&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32521.3,-10973.39C32535.44,-10967.05 32550.96,-10961.22 32566,-10957.83 32581.53,-10954.33 33127.84,-10959.19 33139,-10947.83 33179.03,-10907.09 33109.32,-10883.74 33039.01,-10870.99"/>
<polygon fill="red" stroke="red" points="33039.55,-10867.53 33029.1,-10869.26 33038.35,-10874.43 33039.55,-10867.53"/>
<text text-anchor="middle" x="33179.5" y="-10936.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu15 -->
<g id="node144" class="node">
<title>l1_attn_stage7_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="32663" cy="-10856.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32663" y="-10867.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="32663" y="-10852.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="32663" y="-10837.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu15&#45;&gt;l1_attn_stage7_gpu15 -->
<g id="edge128" class="edge">
<title>l1_attn_stage6_gpu15&#45;&gt;l1_attn_stage7_gpu15</title>
<path fill="none" stroke="black" d="M32610.02,-10973.26C32596.09,-10966.97 32580.82,-10961.19 32566,-10957.83 32548.99,-10953.97 31950.24,-10960.27 31938,-10947.83 31933.32,-10943.08 31933.32,-10937.58 31938,-10932.83 31950.26,-10920.42 32549.39,-10930.16 32566,-10924.83 32584.46,-10918.91 32602.51,-10908.16 32617.94,-10896.96"/>
<polygon fill="black" stroke="black" points="32620.34,-10899.53 32626.22,-10890.72 32616.13,-10893.94 32620.34,-10899.53"/>
</g>
<!-- l1_attn_stage6_gpu15&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge2304" class="edge">
<title>l1_attn_stage6_gpu15&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32718.38,-10974.02C32733.74,-10967.45 32750.68,-10961.36 32767,-10957.83 32791.87,-10952.45 33207.2,-10966.02 33225,-10947.83 33279.67,-10891.96 33178.45,-10870.29 33079.12,-10862.04"/>
<polygon fill="red" stroke="red" points="33079.15,-10858.53 33068.9,-10861.24 33078.6,-10865.51 33079.15,-10858.53"/>
<text text-anchor="middle" x="33265.5" y="-10936.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu0 -->
<g id="node145" class="node">
<title>l1_attn_stage8_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="29738" cy="-10709.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29738" y="-10720.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="29738" y="-10705.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="29738" y="-10690.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu0&#45;&gt;l1_attn_stage8_gpu0 -->
<g id="edge129" class="edge">
<title>l1_attn_stage7_gpu0&#45;&gt;l1_attn_stage8_gpu0</title>
<path fill="none" stroke="black" d="M29738,-10818.74C29738,-10800.02 29738,-10777.03 29738,-10757.05"/>
<polygon fill="black" stroke="black" points="29741.5,-10756.91 29738,-10746.91 29734.5,-10756.91 29741.5,-10756.91"/>
</g>
<!-- l1_attn_stage8_gpu[next_gpu] -->
<g id="node1352" class="node">
<title>l1_attn_stage8_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="32925" cy="-10709.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="32925" y="-10705.63" font-family="Times,serif" font-size="14.00">l1_attn_stage8_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage7_gpu0&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge2305" class="edge">
<title>l1_attn_stage7_gpu0&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29791.29,-10826.33C29805.43,-10819.99 29820.95,-10814.18 29836,-10810.83 30065.73,-10759.7 31718.66,-10788.38 31954,-10785.83 31998.94,-10785.34 32718.97,-10786.86 32763,-10777.83 32806.87,-10768.83 32853.77,-10747.91 32885.76,-10731.73"/>
<polygon fill="red" stroke="red" points="32887.49,-10734.78 32894.78,-10727.09 32884.28,-10728.55 32887.49,-10734.78"/>
<text text-anchor="middle" x="31985.5" y="-10789.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu1 -->
<g id="node146" class="node">
<title>l1_attn_stage8_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="29933" cy="-10709.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29933" y="-10720.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="29933" y="-10705.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="29933" y="-10690.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu1&#45;&gt;l1_attn_stage8_gpu1 -->
<g id="edge130" class="edge">
<title>l1_attn_stage7_gpu1&#45;&gt;l1_attn_stage8_gpu1</title>
<path fill="none" stroke="black" d="M29933,-10818.74C29933,-10800.02 29933,-10777.03 29933,-10757.05"/>
<polygon fill="black" stroke="black" points="29936.5,-10756.91 29933,-10746.91 29929.5,-10756.91 29936.5,-10756.91"/>
</g>
<!-- l1_attn_stage7_gpu1&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge2306" class="edge">
<title>l1_attn_stage7_gpu1&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29986.28,-10826.26C30000.41,-10819.92 30015.94,-10814.13 30031,-10810.83 30085,-10799 31968.82,-10819.09 32021,-10800.83 32031.15,-10797.28 32029.86,-10789.42 32040,-10785.83 32077.87,-10772.45 32723.66,-10785.93 32763,-10777.83 32806.87,-10768.81 32853.77,-10747.89 32885.76,-10731.72"/>
<polygon fill="red" stroke="red" points="32887.48,-10734.76 32894.78,-10727.08 32884.28,-10728.54 32887.48,-10734.76"/>
<text text-anchor="middle" x="32071.5" y="-10789.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu2 -->
<g id="node147" class="node">
<title>l1_attn_stage8_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="30128" cy="-10709.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30128" y="-10720.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="30128" y="-10705.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="30128" y="-10690.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu2&#45;&gt;l1_attn_stage8_gpu2 -->
<g id="edge131" class="edge">
<title>l1_attn_stage7_gpu2&#45;&gt;l1_attn_stage8_gpu2</title>
<path fill="none" stroke="black" d="M30128,-10818.74C30128,-10800.02 30128,-10777.03 30128,-10757.05"/>
<polygon fill="black" stroke="black" points="30131.5,-10756.91 30128,-10746.91 30124.5,-10756.91 30131.5,-10756.91"/>
</g>
<!-- l1_attn_stage7_gpu2&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge2307" class="edge">
<title>l1_attn_stage7_gpu2&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30181.28,-10826.27C30195.41,-10819.93 30210.94,-10814.13 30226,-10810.83 30277.04,-10799.64 32057.68,-10818.1 32107,-10800.83 32117.15,-10797.28 32115.86,-10789.42 32126,-10785.83 32159.36,-10774.01 32728.34,-10784.99 32763,-10777.83 32806.86,-10768.77 32853.76,-10747.86 32885.75,-10731.7"/>
<polygon fill="red" stroke="red" points="32887.48,-10734.75 32894.77,-10727.07 32884.28,-10728.52 32887.48,-10734.75"/>
<text text-anchor="middle" x="32157.5" y="-10789.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu3 -->
<g id="node148" class="node">
<title>l1_attn_stage8_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="30323" cy="-10709.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30323" y="-10720.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="30323" y="-10705.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="30323" y="-10690.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu3&#45;&gt;l1_attn_stage8_gpu3 -->
<g id="edge132" class="edge">
<title>l1_attn_stage7_gpu3&#45;&gt;l1_attn_stage8_gpu3</title>
<path fill="none" stroke="black" d="M30323,-10818.74C30323,-10800.02 30323,-10777.03 30323,-10757.05"/>
<polygon fill="black" stroke="black" points="30326.5,-10756.91 30323,-10746.91 30319.5,-10756.91 30326.5,-10756.91"/>
</g>
<!-- l1_attn_stage7_gpu3&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge2308" class="edge">
<title>l1_attn_stage7_gpu3&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30376.28,-10826.27C30390.41,-10819.93 30405.94,-10814.13 30421,-10810.83 30469.08,-10800.28 32146.55,-10817.11 32193,-10800.83 32203.15,-10797.27 32201.86,-10789.43 32212,-10785.83 32240.85,-10775.58 32733.02,-10784.05 32763,-10777.83 32806.85,-10768.73 32853.75,-10747.83 32885.75,-10731.67"/>
<polygon fill="red" stroke="red" points="32887.47,-10734.73 32894.77,-10727.05 32884.27,-10728.5 32887.47,-10734.73"/>
<text text-anchor="middle" x="32243.5" y="-10789.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu4 -->
<g id="node149" class="node">
<title>l1_attn_stage8_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="30518" cy="-10709.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30518" y="-10720.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="30518" y="-10705.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="30518" y="-10690.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu4&#45;&gt;l1_attn_stage8_gpu4 -->
<g id="edge133" class="edge">
<title>l1_attn_stage7_gpu4&#45;&gt;l1_attn_stage8_gpu4</title>
<path fill="none" stroke="black" d="M30518,-10818.74C30518,-10800.02 30518,-10777.03 30518,-10757.05"/>
<polygon fill="black" stroke="black" points="30521.5,-10756.91 30518,-10746.91 30514.5,-10756.91 30521.5,-10756.91"/>
</g>
<!-- l1_attn_stage7_gpu4&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge2309" class="edge">
<title>l1_attn_stage7_gpu4&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30571.28,-10826.27C30585.41,-10819.93 30600.94,-10814.14 30616,-10810.83 30661.12,-10800.93 32235.41,-10816.11 32279,-10800.83 32289.15,-10797.27 32287.87,-10789.45 32298,-10785.83 32346.67,-10768.47 32712.42,-10788.4 32763,-10777.83 32806.84,-10768.67 32853.74,-10747.78 32885.74,-10731.64"/>
<polygon fill="red" stroke="red" points="32887.46,-10734.7 32894.76,-10727.02 32884.27,-10728.47 32887.46,-10734.7"/>
<text text-anchor="middle" x="32329.5" y="-10789.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu5 -->
<g id="node150" class="node">
<title>l1_attn_stage8_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="30713" cy="-10709.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30713" y="-10720.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="30713" y="-10705.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="30713" y="-10690.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu5&#45;&gt;l1_attn_stage8_gpu5 -->
<g id="edge134" class="edge">
<title>l1_attn_stage7_gpu5&#45;&gt;l1_attn_stage8_gpu5</title>
<path fill="none" stroke="black" d="M30713,-10818.74C30713,-10800.02 30713,-10777.03 30713,-10757.05"/>
<polygon fill="black" stroke="black" points="30716.5,-10756.91 30713,-10746.91 30709.5,-10756.91 30716.5,-10756.91"/>
</g>
<!-- l1_attn_stage7_gpu5&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge2310" class="edge">
<title>l1_attn_stage7_gpu5&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30766.28,-10826.28C30780.41,-10819.94 30795.94,-10814.14 30811,-10810.83 30853.16,-10801.57 32324.27,-10815.12 32365,-10800.83 32375.15,-10797.27 32373.87,-10789.47 32384,-10785.83 32423.64,-10771.6 32721.79,-10786.53 32763,-10777.83 32806.82,-10768.59 32853.73,-10747.7 32885.73,-10731.6"/>
<polygon fill="red" stroke="red" points="32887.45,-10734.65 32894.75,-10726.98 32884.26,-10728.42 32887.45,-10734.65"/>
<text text-anchor="middle" x="32415.5" y="-10789.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu6 -->
<g id="node151" class="node">
<title>l1_attn_stage8_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="30908" cy="-10709.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30908" y="-10720.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="30908" y="-10705.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="30908" y="-10690.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu6&#45;&gt;l1_attn_stage8_gpu6 -->
<g id="edge135" class="edge">
<title>l1_attn_stage7_gpu6&#45;&gt;l1_attn_stage8_gpu6</title>
<path fill="none" stroke="black" d="M30908,-10818.74C30908,-10800.02 30908,-10777.03 30908,-10757.05"/>
<polygon fill="black" stroke="black" points="30911.5,-10756.91 30908,-10746.91 30904.5,-10756.91 30911.5,-10756.91"/>
</g>
<!-- l1_attn_stage7_gpu6&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge2311" class="edge">
<title>l1_attn_stage7_gpu6&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30961.28,-10826.28C30975.41,-10819.94 30990.94,-10814.14 31006,-10810.83 31045.2,-10802.21 32413.13,-10814.13 32451,-10800.83 32461.15,-10797.27 32459.89,-10789.5 32470,-10785.83 32500.62,-10774.73 32731.15,-10784.65 32763,-10777.83 32806.66,-10768.48 32853.41,-10747.72 32885.42,-10731.67"/>
<polygon fill="red" stroke="red" points="32887.12,-10734.73 32894.45,-10727.07 32883.95,-10728.49 32887.12,-10734.73"/>
<text text-anchor="middle" x="32501.5" y="-10789.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu7 -->
<g id="node152" class="node">
<title>l1_attn_stage8_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="31103" cy="-10709.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31103" y="-10720.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="31103" y="-10705.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="31103" y="-10690.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu7&#45;&gt;l1_attn_stage8_gpu7 -->
<g id="edge136" class="edge">
<title>l1_attn_stage7_gpu7&#45;&gt;l1_attn_stage8_gpu7</title>
<path fill="none" stroke="black" d="M31103,-10818.74C31103,-10800.02 31103,-10777.03 31103,-10757.05"/>
<polygon fill="black" stroke="black" points="31106.5,-10756.91 31103,-10746.91 31099.5,-10756.91 31106.5,-10756.91"/>
</g>
<!-- l1_attn_stage7_gpu7&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge2312" class="edge">
<title>l1_attn_stage7_gpu7&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31156.28,-10826.29C31170.42,-10819.95 31185.95,-10814.15 31201,-10810.83 31237.24,-10802.85 32501.99,-10813.13 32537,-10800.83 32547.15,-10797.27 32545.91,-10789.56 32556,-10785.83 32599.19,-10769.9 32718.04,-10787.73 32763,-10777.83 32806.6,-10768.23 32853.37,-10747.51 32885.39,-10731.54"/>
<polygon fill="red" stroke="red" points="32887.08,-10734.6 32894.42,-10726.96 32883.92,-10728.36 32887.08,-10734.6"/>
<text text-anchor="middle" x="32587.5" y="-10789.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu8 -->
<g id="node153" class="node">
<title>l1_attn_stage8_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="31298" cy="-10709.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31298" y="-10720.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="31298" y="-10705.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="31298" y="-10690.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu8&#45;&gt;l1_attn_stage8_gpu8 -->
<g id="edge137" class="edge">
<title>l1_attn_stage7_gpu8&#45;&gt;l1_attn_stage8_gpu8</title>
<path fill="none" stroke="black" d="M31298,-10818.74C31298,-10800.02 31298,-10777.03 31298,-10757.05"/>
<polygon fill="black" stroke="black" points="31301.5,-10756.91 31298,-10746.91 31294.5,-10756.91 31301.5,-10756.91"/>
</g>
<!-- l1_attn_stage7_gpu8&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge2313" class="edge">
<title>l1_attn_stage7_gpu8&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31351.28,-10826.3C31365.42,-10819.96 31380.95,-10814.15 31396,-10810.83 31462.57,-10796.14 32558.69,-10823.45 32623,-10800.83 32633.15,-10797.26 32631.96,-10789.69 32642,-10785.83 32692.3,-10766.49 32710.53,-10790.14 32763,-10777.83 32806.2,-10767.7 32852.67,-10747.25 32884.71,-10731.5"/>
<polygon fill="red" stroke="red" points="32886.38,-10734.59 32893.77,-10726.99 32883.25,-10728.32 32886.38,-10734.59"/>
<text text-anchor="middle" x="32673.5" y="-10789.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu9 -->
<g id="node154" class="node">
<title>l1_attn_stage8_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="31493" cy="-10709.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31493" y="-10720.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="31493" y="-10705.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="31493" y="-10690.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu9&#45;&gt;l1_attn_stage8_gpu9 -->
<g id="edge138" class="edge">
<title>l1_attn_stage7_gpu9&#45;&gt;l1_attn_stage8_gpu9</title>
<path fill="none" stroke="black" d="M31493,-10818.74C31493,-10800.02 31493,-10777.03 31493,-10757.05"/>
<polygon fill="black" stroke="black" points="31496.5,-10756.91 31493,-10746.91 31489.5,-10756.91 31496.5,-10756.91"/>
</g>
<!-- l1_attn_stage7_gpu9&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge2314" class="edge">
<title>l1_attn_stage7_gpu9&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31546.28,-10826.3C31560.42,-10819.96 31575.95,-10814.16 31591,-10810.83 31651.65,-10797.42 32650.41,-10821.46 32709,-10800.83 32719.15,-10797.26 32718.3,-10790.48 32728,-10785.83 32742.39,-10778.94 32747.8,-10782.7 32763,-10777.83 32803.94,-10764.73 32848.95,-10745.57 32881.12,-10731.01"/>
<polygon fill="red" stroke="red" points="32882.61,-10734.17 32890.25,-10726.84 32879.7,-10727.81 32882.61,-10734.17"/>
<text text-anchor="middle" x="32759.5" y="-10789.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu10 -->
<g id="node155" class="node">
<title>l1_attn_stage8_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="31688" cy="-10709.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31688" y="-10720.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="31688" y="-10705.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="31688" y="-10690.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu10&#45;&gt;l1_attn_stage8_gpu10 -->
<g id="edge139" class="edge">
<title>l1_attn_stage7_gpu10&#45;&gt;l1_attn_stage8_gpu10</title>
<path fill="none" stroke="black" d="M31688,-10818.74C31688,-10800.02 31688,-10777.03 31688,-10757.05"/>
<polygon fill="black" stroke="black" points="31691.5,-10756.91 31688,-10746.91 31684.5,-10756.91 31691.5,-10756.91"/>
</g>
<!-- l1_attn_stage7_gpu10&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge2315" class="edge">
<title>l1_attn_stage7_gpu10&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31741.29,-10826.31C31755.42,-10819.97 31770.95,-10814.17 31786,-10810.83 31840.73,-10798.7 32742.13,-10819.48 32795,-10800.83 32805.15,-10797.25 32805.32,-10792.19 32814,-10785.83 32839.22,-10767.34 32868.5,-10747.49 32890.65,-10732.78"/>
<polygon fill="red" stroke="red" points="32892.66,-10735.65 32899.07,-10727.22 32888.8,-10729.81 32892.66,-10735.65"/>
<text text-anchor="middle" x="32845.5" y="-10789.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu11 -->
<g id="node156" class="node">
<title>l1_attn_stage8_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="31883" cy="-10709.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31883" y="-10720.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="31883" y="-10705.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="31883" y="-10690.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu11&#45;&gt;l1_attn_stage8_gpu11 -->
<g id="edge140" class="edge">
<title>l1_attn_stage7_gpu11&#45;&gt;l1_attn_stage8_gpu11</title>
<path fill="none" stroke="black" d="M31883,-10818.74C31883,-10800.02 31883,-10777.03 31883,-10757.05"/>
<polygon fill="black" stroke="black" points="31886.5,-10756.91 31883,-10746.91 31879.5,-10756.91 31886.5,-10756.91"/>
</g>
<!-- l1_attn_stage7_gpu11&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge2316" class="edge">
<title>l1_attn_stage7_gpu11&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31936.29,-10826.33C31950.42,-10819.99 31965.95,-10814.18 31981,-10810.83 32005.41,-10805.41 32859.88,-10814.21 32881,-10800.83 32902.94,-10786.93 32914.24,-10758.65 32919.85,-10737.39"/>
<polygon fill="red" stroke="red" points="32923.27,-10738.14 32922.18,-10727.6 32916.46,-10736.52 32923.27,-10738.14"/>
<text text-anchor="middle" x="32927.5" y="-10789.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu12 -->
<g id="node157" class="node">
<title>l1_attn_stage8_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="32078" cy="-10709.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32078" y="-10720.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="32078" y="-10705.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="32078" y="-10690.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu12&#45;&gt;l1_attn_stage8_gpu12 -->
<g id="edge141" class="edge">
<title>l1_attn_stage7_gpu12&#45;&gt;l1_attn_stage8_gpu12</title>
<path fill="none" stroke="black" d="M32022.85,-10826.87C32009.43,-10820.83 31994.93,-10815.03 31981,-10810.83 31967.22,-10806.68 31926.36,-10811.77 31917,-10800.83 31882.08,-10760.03 31922.79,-10800.15 31981,-10777.83 31998.78,-10771.01 32016.42,-10760.27 32031.68,-10749.34"/>
<polygon fill="black" stroke="black" points="32033.93,-10752.02 32039.9,-10743.27 32029.77,-10746.39 32033.93,-10752.02"/>
</g>
<!-- l1_attn_stage7_gpu12&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge2317" class="edge">
<title>l1_attn_stage7_gpu12&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32131.29,-10826.34C32145.43,-10820 32160.95,-10814.19 32176,-10810.83 32197.45,-10806.05 32951.56,-10816.47 32967,-10800.83 32985.16,-10782.44 32967.89,-10754.75 32950.31,-10734.84"/>
<polygon fill="red" stroke="red" points="32952.75,-10732.32 32943.38,-10727.37 32947.61,-10737.08 32952.75,-10732.32"/>
<text text-anchor="middle" x="33005.5" y="-10789.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu13 -->
<g id="node158" class="node">
<title>l1_attn_stage8_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="32273" cy="-10709.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32273" y="-10720.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="32273" y="-10705.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="32273" y="-10690.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu13&#45;&gt;l1_attn_stage8_gpu13 -->
<g id="edge142" class="edge">
<title>l1_attn_stage7_gpu13&#45;&gt;l1_attn_stage8_gpu13</title>
<path fill="none" stroke="black" d="M32219.7,-10826.39C32205.85,-10820.13 32190.69,-10814.35 32176,-10810.83 32162.37,-10807.57 31933.71,-10810.93 31924,-10800.83 31919.38,-10796.03 31919.36,-10790.62 31924,-10785.83 31933.75,-10775.77 32162.7,-10782.24 32176,-10777.83 32194.4,-10771.74 32212.44,-10760.94 32227.87,-10749.75"/>
<polygon fill="black" stroke="black" points="32230.27,-10752.33 32236.16,-10743.52 32226.06,-10746.73 32230.27,-10752.33"/>
</g>
<!-- l1_attn_stage7_gpu13&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge2318" class="edge">
<title>l1_attn_stage7_gpu13&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32326.3,-10826.36C32340.43,-10820.02 32355.96,-10814.2 32371,-10810.83 32389.49,-10806.69 33039.7,-10814.33 33053,-10800.83 33081.36,-10772.06 33033.79,-10746.22 32988.82,-10729.6"/>
<polygon fill="red" stroke="red" points="32989.88,-10726.26 32979.29,-10726.19 32987.53,-10732.85 32989.88,-10726.26"/>
<text text-anchor="middle" x="33092.5" y="-10789.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu14 -->
<g id="node159" class="node">
<title>l1_attn_stage8_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="32468" cy="-10709.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32468" y="-10720.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="32468" y="-10705.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="32468" y="-10690.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu14&#45;&gt;l1_attn_stage8_gpu14 -->
<g id="edge143" class="edge">
<title>l1_attn_stage7_gpu14&#45;&gt;l1_attn_stage8_gpu14</title>
<path fill="none" stroke="black" d="M32414.74,-10826.22C32400.89,-10819.96 32385.71,-10814.22 32371,-10810.83 32347.17,-10805.34 31948.09,-10818.32 31931,-10800.83 31926.34,-10796.06 31926.33,-10790.59 31931,-10785.83 31939.56,-10777.11 32359.37,-10781.6 32371,-10777.83 32389.45,-10771.86 32407.49,-10761.1 32422.92,-10749.9"/>
<polygon fill="black" stroke="black" points="32425.32,-10752.47 32431.2,-10743.66 32421.11,-10746.88 32425.32,-10752.47"/>
</g>
<!-- l1_attn_stage7_gpu14&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge2319" class="edge">
<title>l1_attn_stage7_gpu14&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32521.3,-10826.39C32535.44,-10820.05 32550.96,-10814.22 32566,-10810.83 32581.53,-10807.33 33127.84,-10812.19 33139,-10800.83 33179.03,-10760.09 33109.32,-10736.74 33039.01,-10723.99"/>
<polygon fill="red" stroke="red" points="33039.55,-10720.53 33029.1,-10722.26 33038.35,-10727.43 33039.55,-10720.53"/>
<text text-anchor="middle" x="33179.5" y="-10789.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu15 -->
<g id="node160" class="node">
<title>l1_attn_stage8_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="32663" cy="-10709.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32663" y="-10720.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="32663" y="-10705.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="32663" y="-10690.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu15&#45;&gt;l1_attn_stage8_gpu15 -->
<g id="edge144" class="edge">
<title>l1_attn_stage7_gpu15&#45;&gt;l1_attn_stage8_gpu15</title>
<path fill="none" stroke="black" d="M32610.02,-10826.26C32596.09,-10819.97 32580.82,-10814.19 32566,-10810.83 32548.99,-10806.97 31950.24,-10813.27 31938,-10800.83 31933.32,-10796.08 31933.32,-10790.58 31938,-10785.83 31950.26,-10773.42 32549.39,-10783.16 32566,-10777.83 32584.46,-10771.91 32602.51,-10761.16 32617.94,-10749.96"/>
<polygon fill="black" stroke="black" points="32620.34,-10752.53 32626.22,-10743.72 32616.13,-10746.94 32620.34,-10752.53"/>
</g>
<!-- l1_attn_stage7_gpu15&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge2320" class="edge">
<title>l1_attn_stage7_gpu15&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32718.38,-10827.02C32733.74,-10820.45 32750.68,-10814.36 32767,-10810.83 32791.87,-10805.45 33207.2,-10819.02 33225,-10800.83 33279.67,-10744.96 33178.45,-10723.29 33079.12,-10715.04"/>
<polygon fill="red" stroke="red" points="33079.15,-10711.53 33068.9,-10714.24 33078.6,-10718.51 33079.15,-10711.53"/>
<text text-anchor="middle" x="33265.5" y="-10789.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu0 -->
<g id="node161" class="node">
<title>l1_attn_stage9_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="29738" cy="-10562.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29738" y="-10573.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="29738" y="-10558.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="29738" y="-10543.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu0&#45;&gt;l1_attn_stage9_gpu0 -->
<g id="edge145" class="edge">
<title>l1_attn_stage8_gpu0&#45;&gt;l1_attn_stage9_gpu0</title>
<path fill="none" stroke="black" d="M29738,-10671.74C29738,-10653.02 29738,-10630.03 29738,-10610.05"/>
<polygon fill="black" stroke="black" points="29741.5,-10609.91 29738,-10599.91 29734.5,-10609.91 29741.5,-10609.91"/>
</g>
<!-- l1_attn_stage9_gpu[next_gpu] -->
<g id="node1353" class="node">
<title>l1_attn_stage9_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="32925" cy="-10562.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="32925" y="-10558.63" font-family="Times,serif" font-size="14.00">l1_attn_stage9_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage8_gpu0&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge2321" class="edge">
<title>l1_attn_stage8_gpu0&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29791.29,-10679.33C29805.43,-10672.99 29820.95,-10667.18 29836,-10663.83 30065.73,-10612.7 31718.66,-10641.38 31954,-10638.83 31998.94,-10638.34 32718.97,-10639.86 32763,-10630.83 32806.87,-10621.83 32853.77,-10600.91 32885.76,-10584.73"/>
<polygon fill="red" stroke="red" points="32887.49,-10587.78 32894.78,-10580.09 32884.28,-10581.55 32887.49,-10587.78"/>
<text text-anchor="middle" x="31985.5" y="-10642.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu1 -->
<g id="node162" class="node">
<title>l1_attn_stage9_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="29933" cy="-10562.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="29933" y="-10573.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="29933" y="-10558.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="29933" y="-10543.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu1&#45;&gt;l1_attn_stage9_gpu1 -->
<g id="edge146" class="edge">
<title>l1_attn_stage8_gpu1&#45;&gt;l1_attn_stage9_gpu1</title>
<path fill="none" stroke="black" d="M29933,-10671.74C29933,-10653.02 29933,-10630.03 29933,-10610.05"/>
<polygon fill="black" stroke="black" points="29936.5,-10609.91 29933,-10599.91 29929.5,-10609.91 29936.5,-10609.91"/>
</g>
<!-- l1_attn_stage8_gpu1&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge2322" class="edge">
<title>l1_attn_stage8_gpu1&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29986.28,-10679.26C30000.41,-10672.92 30015.94,-10667.13 30031,-10663.83 30085,-10652 31968.82,-10672.09 32021,-10653.83 32031.15,-10650.28 32029.86,-10642.42 32040,-10638.83 32077.87,-10625.45 32723.66,-10638.93 32763,-10630.83 32806.87,-10621.81 32853.77,-10600.89 32885.76,-10584.72"/>
<polygon fill="red" stroke="red" points="32887.48,-10587.76 32894.78,-10580.08 32884.28,-10581.54 32887.48,-10587.76"/>
<text text-anchor="middle" x="32071.5" y="-10642.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu2 -->
<g id="node163" class="node">
<title>l1_attn_stage9_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="30128" cy="-10562.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30128" y="-10573.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="30128" y="-10558.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="30128" y="-10543.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu2&#45;&gt;l1_attn_stage9_gpu2 -->
<g id="edge147" class="edge">
<title>l1_attn_stage8_gpu2&#45;&gt;l1_attn_stage9_gpu2</title>
<path fill="none" stroke="black" d="M30128,-10671.74C30128,-10653.02 30128,-10630.03 30128,-10610.05"/>
<polygon fill="black" stroke="black" points="30131.5,-10609.91 30128,-10599.91 30124.5,-10609.91 30131.5,-10609.91"/>
</g>
<!-- l1_attn_stage8_gpu2&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge2323" class="edge">
<title>l1_attn_stage8_gpu2&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30181.28,-10679.27C30195.41,-10672.93 30210.94,-10667.13 30226,-10663.83 30277.04,-10652.64 32057.68,-10671.1 32107,-10653.83 32117.15,-10650.28 32115.86,-10642.42 32126,-10638.83 32159.36,-10627.01 32728.34,-10637.99 32763,-10630.83 32806.86,-10621.77 32853.76,-10600.86 32885.75,-10584.7"/>
<polygon fill="red" stroke="red" points="32887.48,-10587.75 32894.77,-10580.07 32884.28,-10581.52 32887.48,-10587.75"/>
<text text-anchor="middle" x="32157.5" y="-10642.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu3 -->
<g id="node164" class="node">
<title>l1_attn_stage9_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="30323" cy="-10562.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30323" y="-10573.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="30323" y="-10558.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="30323" y="-10543.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu3&#45;&gt;l1_attn_stage9_gpu3 -->
<g id="edge148" class="edge">
<title>l1_attn_stage8_gpu3&#45;&gt;l1_attn_stage9_gpu3</title>
<path fill="none" stroke="black" d="M30323,-10671.74C30323,-10653.02 30323,-10630.03 30323,-10610.05"/>
<polygon fill="black" stroke="black" points="30326.5,-10609.91 30323,-10599.91 30319.5,-10609.91 30326.5,-10609.91"/>
</g>
<!-- l1_attn_stage8_gpu3&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge2324" class="edge">
<title>l1_attn_stage8_gpu3&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30376.28,-10679.27C30390.41,-10672.93 30405.94,-10667.13 30421,-10663.83 30469.08,-10653.28 32146.55,-10670.11 32193,-10653.83 32203.15,-10650.27 32201.86,-10642.43 32212,-10638.83 32240.85,-10628.58 32733.02,-10637.05 32763,-10630.83 32806.85,-10621.73 32853.75,-10600.83 32885.75,-10584.67"/>
<polygon fill="red" stroke="red" points="32887.47,-10587.73 32894.77,-10580.05 32884.27,-10581.5 32887.47,-10587.73"/>
<text text-anchor="middle" x="32243.5" y="-10642.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu4 -->
<g id="node165" class="node">
<title>l1_attn_stage9_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="30518" cy="-10562.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30518" y="-10573.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="30518" y="-10558.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="30518" y="-10543.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu4&#45;&gt;l1_attn_stage9_gpu4 -->
<g id="edge149" class="edge">
<title>l1_attn_stage8_gpu4&#45;&gt;l1_attn_stage9_gpu4</title>
<path fill="none" stroke="black" d="M30518,-10671.74C30518,-10653.02 30518,-10630.03 30518,-10610.05"/>
<polygon fill="black" stroke="black" points="30521.5,-10609.91 30518,-10599.91 30514.5,-10609.91 30521.5,-10609.91"/>
</g>
<!-- l1_attn_stage8_gpu4&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge2325" class="edge">
<title>l1_attn_stage8_gpu4&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30571.28,-10679.27C30585.41,-10672.93 30600.94,-10667.14 30616,-10663.83 30661.12,-10653.93 32235.41,-10669.11 32279,-10653.83 32289.15,-10650.27 32287.87,-10642.45 32298,-10638.83 32346.67,-10621.47 32712.42,-10641.4 32763,-10630.83 32806.84,-10621.67 32853.74,-10600.78 32885.74,-10584.64"/>
<polygon fill="red" stroke="red" points="32887.46,-10587.7 32894.76,-10580.02 32884.27,-10581.47 32887.46,-10587.7"/>
<text text-anchor="middle" x="32329.5" y="-10642.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu5 -->
<g id="node166" class="node">
<title>l1_attn_stage9_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="30713" cy="-10562.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30713" y="-10573.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="30713" y="-10558.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="30713" y="-10543.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu5&#45;&gt;l1_attn_stage9_gpu5 -->
<g id="edge150" class="edge">
<title>l1_attn_stage8_gpu5&#45;&gt;l1_attn_stage9_gpu5</title>
<path fill="none" stroke="black" d="M30713,-10671.74C30713,-10653.02 30713,-10630.03 30713,-10610.05"/>
<polygon fill="black" stroke="black" points="30716.5,-10609.91 30713,-10599.91 30709.5,-10609.91 30716.5,-10609.91"/>
</g>
<!-- l1_attn_stage8_gpu5&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge2326" class="edge">
<title>l1_attn_stage8_gpu5&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30766.28,-10679.28C30780.41,-10672.94 30795.94,-10667.14 30811,-10663.83 30853.16,-10654.57 32324.27,-10668.12 32365,-10653.83 32375.15,-10650.27 32373.87,-10642.47 32384,-10638.83 32423.64,-10624.6 32721.79,-10639.53 32763,-10630.83 32806.82,-10621.59 32853.73,-10600.7 32885.73,-10584.6"/>
<polygon fill="red" stroke="red" points="32887.45,-10587.65 32894.75,-10579.98 32884.26,-10581.42 32887.45,-10587.65"/>
<text text-anchor="middle" x="32415.5" y="-10642.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu6 -->
<g id="node167" class="node">
<title>l1_attn_stage9_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="30908" cy="-10562.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="30908" y="-10573.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="30908" y="-10558.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="30908" y="-10543.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu6&#45;&gt;l1_attn_stage9_gpu6 -->
<g id="edge151" class="edge">
<title>l1_attn_stage8_gpu6&#45;&gt;l1_attn_stage9_gpu6</title>
<path fill="none" stroke="black" d="M30908,-10671.74C30908,-10653.02 30908,-10630.03 30908,-10610.05"/>
<polygon fill="black" stroke="black" points="30911.5,-10609.91 30908,-10599.91 30904.5,-10609.91 30911.5,-10609.91"/>
</g>
<!-- l1_attn_stage8_gpu6&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge2327" class="edge">
<title>l1_attn_stage8_gpu6&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30961.28,-10679.28C30975.41,-10672.94 30990.94,-10667.14 31006,-10663.83 31045.2,-10655.21 32413.13,-10667.13 32451,-10653.83 32461.15,-10650.27 32459.89,-10642.5 32470,-10638.83 32500.62,-10627.73 32731.15,-10637.65 32763,-10630.83 32806.66,-10621.48 32853.41,-10600.72 32885.42,-10584.67"/>
<polygon fill="red" stroke="red" points="32887.12,-10587.73 32894.45,-10580.07 32883.95,-10581.49 32887.12,-10587.73"/>
<text text-anchor="middle" x="32501.5" y="-10642.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu7 -->
<g id="node168" class="node">
<title>l1_attn_stage9_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="31103" cy="-10562.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31103" y="-10573.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="31103" y="-10558.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="31103" y="-10543.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu7&#45;&gt;l1_attn_stage9_gpu7 -->
<g id="edge152" class="edge">
<title>l1_attn_stage8_gpu7&#45;&gt;l1_attn_stage9_gpu7</title>
<path fill="none" stroke="black" d="M31103,-10671.74C31103,-10653.02 31103,-10630.03 31103,-10610.05"/>
<polygon fill="black" stroke="black" points="31106.5,-10609.91 31103,-10599.91 31099.5,-10609.91 31106.5,-10609.91"/>
</g>
<!-- l1_attn_stage8_gpu7&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge2328" class="edge">
<title>l1_attn_stage8_gpu7&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31156.28,-10679.29C31170.42,-10672.95 31185.95,-10667.15 31201,-10663.83 31237.24,-10655.85 32501.99,-10666.13 32537,-10653.83 32547.15,-10650.27 32545.91,-10642.56 32556,-10638.83 32599.19,-10622.9 32718.04,-10640.73 32763,-10630.83 32806.6,-10621.23 32853.37,-10600.51 32885.39,-10584.54"/>
<polygon fill="red" stroke="red" points="32887.08,-10587.6 32894.42,-10579.96 32883.92,-10581.36 32887.08,-10587.6"/>
<text text-anchor="middle" x="32587.5" y="-10642.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu8 -->
<g id="node169" class="node">
<title>l1_attn_stage9_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="31298" cy="-10562.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31298" y="-10573.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="31298" y="-10558.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="31298" y="-10543.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu8&#45;&gt;l1_attn_stage9_gpu8 -->
<g id="edge153" class="edge">
<title>l1_attn_stage8_gpu8&#45;&gt;l1_attn_stage9_gpu8</title>
<path fill="none" stroke="black" d="M31298,-10671.74C31298,-10653.02 31298,-10630.03 31298,-10610.05"/>
<polygon fill="black" stroke="black" points="31301.5,-10609.91 31298,-10599.91 31294.5,-10609.91 31301.5,-10609.91"/>
</g>
<!-- l1_attn_stage8_gpu8&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge2329" class="edge">
<title>l1_attn_stage8_gpu8&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31351.28,-10679.3C31365.42,-10672.96 31380.95,-10667.15 31396,-10663.83 31462.57,-10649.14 32558.69,-10676.45 32623,-10653.83 32633.15,-10650.26 32631.96,-10642.69 32642,-10638.83 32692.3,-10619.49 32710.53,-10643.14 32763,-10630.83 32806.2,-10620.7 32852.67,-10600.25 32884.71,-10584.5"/>
<polygon fill="red" stroke="red" points="32886.38,-10587.59 32893.77,-10579.99 32883.25,-10581.32 32886.38,-10587.59"/>
<text text-anchor="middle" x="32673.5" y="-10642.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu9 -->
<g id="node170" class="node">
<title>l1_attn_stage9_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="31493" cy="-10562.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31493" y="-10573.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="31493" y="-10558.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="31493" y="-10543.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu9&#45;&gt;l1_attn_stage9_gpu9 -->
<g id="edge154" class="edge">
<title>l1_attn_stage8_gpu9&#45;&gt;l1_attn_stage9_gpu9</title>
<path fill="none" stroke="black" d="M31493,-10671.74C31493,-10653.02 31493,-10630.03 31493,-10610.05"/>
<polygon fill="black" stroke="black" points="31496.5,-10609.91 31493,-10599.91 31489.5,-10609.91 31496.5,-10609.91"/>
</g>
<!-- l1_attn_stage8_gpu9&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge2330" class="edge">
<title>l1_attn_stage8_gpu9&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31546.28,-10679.3C31560.42,-10672.96 31575.95,-10667.16 31591,-10663.83 31651.65,-10650.42 32650.41,-10674.46 32709,-10653.83 32719.15,-10650.26 32718.3,-10643.48 32728,-10638.83 32742.39,-10631.94 32747.8,-10635.7 32763,-10630.83 32803.94,-10617.73 32848.95,-10598.57 32881.12,-10584.01"/>
<polygon fill="red" stroke="red" points="32882.61,-10587.17 32890.25,-10579.84 32879.7,-10580.81 32882.61,-10587.17"/>
<text text-anchor="middle" x="32759.5" y="-10642.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu10 -->
<g id="node171" class="node">
<title>l1_attn_stage9_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="31688" cy="-10562.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31688" y="-10573.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="31688" y="-10558.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="31688" y="-10543.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu10&#45;&gt;l1_attn_stage9_gpu10 -->
<g id="edge155" class="edge">
<title>l1_attn_stage8_gpu10&#45;&gt;l1_attn_stage9_gpu10</title>
<path fill="none" stroke="black" d="M31688,-10671.74C31688,-10653.02 31688,-10630.03 31688,-10610.05"/>
<polygon fill="black" stroke="black" points="31691.5,-10609.91 31688,-10599.91 31684.5,-10609.91 31691.5,-10609.91"/>
</g>
<!-- l1_attn_stage8_gpu10&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge2331" class="edge">
<title>l1_attn_stage8_gpu10&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31741.29,-10679.31C31755.42,-10672.97 31770.95,-10667.17 31786,-10663.83 31840.73,-10651.7 32742.13,-10672.48 32795,-10653.83 32805.15,-10650.25 32805.32,-10645.19 32814,-10638.83 32839.22,-10620.34 32868.5,-10600.49 32890.65,-10585.78"/>
<polygon fill="red" stroke="red" points="32892.66,-10588.65 32899.07,-10580.22 32888.8,-10582.81 32892.66,-10588.65"/>
<text text-anchor="middle" x="32845.5" y="-10642.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu11 -->
<g id="node172" class="node">
<title>l1_attn_stage9_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="31883" cy="-10562.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="31883" y="-10573.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="31883" y="-10558.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="31883" y="-10543.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu11&#45;&gt;l1_attn_stage9_gpu11 -->
<g id="edge156" class="edge">
<title>l1_attn_stage8_gpu11&#45;&gt;l1_attn_stage9_gpu11</title>
<path fill="none" stroke="black" d="M31883,-10671.74C31883,-10653.02 31883,-10630.03 31883,-10610.05"/>
<polygon fill="black" stroke="black" points="31886.5,-10609.91 31883,-10599.91 31879.5,-10609.91 31886.5,-10609.91"/>
</g>
<!-- l1_attn_stage8_gpu11&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge2332" class="edge">
<title>l1_attn_stage8_gpu11&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31936.29,-10679.33C31950.42,-10672.99 31965.95,-10667.18 31981,-10663.83 32005.41,-10658.41 32859.88,-10667.21 32881,-10653.83 32902.94,-10639.93 32914.24,-10611.65 32919.85,-10590.39"/>
<polygon fill="red" stroke="red" points="32923.27,-10591.14 32922.18,-10580.6 32916.46,-10589.52 32923.27,-10591.14"/>
<text text-anchor="middle" x="32927.5" y="-10642.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu12 -->
<g id="node173" class="node">
<title>l1_attn_stage9_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="32078" cy="-10562.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32078" y="-10573.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="32078" y="-10558.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="32078" y="-10543.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu12&#45;&gt;l1_attn_stage9_gpu12 -->
<g id="edge157" class="edge">
<title>l1_attn_stage8_gpu12&#45;&gt;l1_attn_stage9_gpu12</title>
<path fill="none" stroke="black" d="M32022.85,-10679.87C32009.43,-10673.83 31994.93,-10668.03 31981,-10663.83 31967.22,-10659.68 31926.36,-10664.77 31917,-10653.83 31882.08,-10613.03 31922.79,-10653.15 31981,-10630.83 31998.78,-10624.01 32016.42,-10613.27 32031.68,-10602.34"/>
<polygon fill="black" stroke="black" points="32033.93,-10605.02 32039.9,-10596.27 32029.77,-10599.39 32033.93,-10605.02"/>
</g>
<!-- l1_attn_stage8_gpu12&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge2333" class="edge">
<title>l1_attn_stage8_gpu12&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32131.29,-10679.34C32145.43,-10673 32160.95,-10667.19 32176,-10663.83 32197.45,-10659.05 32951.56,-10669.47 32967,-10653.83 32985.16,-10635.44 32967.89,-10607.75 32950.31,-10587.84"/>
<polygon fill="red" stroke="red" points="32952.75,-10585.32 32943.38,-10580.37 32947.61,-10590.08 32952.75,-10585.32"/>
<text text-anchor="middle" x="33005.5" y="-10642.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu13 -->
<g id="node174" class="node">
<title>l1_attn_stage9_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="32273" cy="-10562.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32273" y="-10573.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="32273" y="-10558.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="32273" y="-10543.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu13&#45;&gt;l1_attn_stage9_gpu13 -->
<g id="edge158" class="edge">
<title>l1_attn_stage8_gpu13&#45;&gt;l1_attn_stage9_gpu13</title>
<path fill="none" stroke="black" d="M32219.7,-10679.39C32205.85,-10673.13 32190.69,-10667.35 32176,-10663.83 32162.37,-10660.57 31933.71,-10663.93 31924,-10653.83 31919.38,-10649.03 31919.36,-10643.62 31924,-10638.83 31933.75,-10628.77 32162.7,-10635.24 32176,-10630.83 32194.4,-10624.74 32212.44,-10613.94 32227.87,-10602.75"/>
<polygon fill="black" stroke="black" points="32230.27,-10605.33 32236.16,-10596.52 32226.06,-10599.73 32230.27,-10605.33"/>
</g>
<!-- l1_attn_stage8_gpu13&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge2334" class="edge">
<title>l1_attn_stage8_gpu13&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32326.3,-10679.36C32340.43,-10673.02 32355.96,-10667.2 32371,-10663.83 32389.49,-10659.69 33039.7,-10667.33 33053,-10653.83 33081.36,-10625.06 33033.79,-10599.22 32988.82,-10582.6"/>
<polygon fill="red" stroke="red" points="32989.88,-10579.26 32979.29,-10579.19 32987.53,-10585.85 32989.88,-10579.26"/>
<text text-anchor="middle" x="33092.5" y="-10642.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu14 -->
<g id="node175" class="node">
<title>l1_attn_stage9_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="32468" cy="-10562.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32468" y="-10573.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="32468" y="-10558.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="32468" y="-10543.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu14&#45;&gt;l1_attn_stage9_gpu14 -->
<g id="edge159" class="edge">
<title>l1_attn_stage8_gpu14&#45;&gt;l1_attn_stage9_gpu14</title>
<path fill="none" stroke="black" d="M32414.74,-10679.22C32400.89,-10672.96 32385.71,-10667.22 32371,-10663.83 32347.17,-10658.34 31948.09,-10671.32 31931,-10653.83 31926.34,-10649.06 31926.33,-10643.59 31931,-10638.83 31939.56,-10630.11 32359.37,-10634.6 32371,-10630.83 32389.45,-10624.86 32407.49,-10614.1 32422.92,-10602.9"/>
<polygon fill="black" stroke="black" points="32425.32,-10605.47 32431.2,-10596.66 32421.11,-10599.88 32425.32,-10605.47"/>
</g>
<!-- l1_attn_stage8_gpu14&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge2335" class="edge">
<title>l1_attn_stage8_gpu14&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32521.3,-10679.39C32535.44,-10673.05 32550.96,-10667.22 32566,-10663.83 32581.53,-10660.33 33127.84,-10665.19 33139,-10653.83 33179.03,-10613.09 33109.32,-10589.74 33039.01,-10576.99"/>
<polygon fill="red" stroke="red" points="33039.55,-10573.53 33029.1,-10575.26 33038.35,-10580.43 33039.55,-10573.53"/>
<text text-anchor="middle" x="33179.5" y="-10642.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu15 -->
<g id="node176" class="node">
<title>l1_attn_stage9_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="32663" cy="-10562.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="32663" y="-10573.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="32663" y="-10558.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="32663" y="-10543.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu15&#45;&gt;l1_attn_stage9_gpu15 -->
<g id="edge160" class="edge">
<title>l1_attn_stage8_gpu15&#45;&gt;l1_attn_stage9_gpu15</title>
<path fill="none" stroke="black" d="M32610.02,-10679.26C32596.09,-10672.97 32580.82,-10667.19 32566,-10663.83 32548.99,-10659.97 31950.24,-10666.27 31938,-10653.83 31933.32,-10649.08 31933.32,-10643.58 31938,-10638.83 31950.26,-10626.42 32549.39,-10636.16 32566,-10630.83 32584.46,-10624.91 32602.51,-10614.16 32617.94,-10602.96"/>
<polygon fill="black" stroke="black" points="32620.34,-10605.53 32626.22,-10596.72 32616.13,-10599.94 32620.34,-10605.53"/>
</g>
<!-- l1_attn_stage8_gpu15&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge2336" class="edge">
<title>l1_attn_stage8_gpu15&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32718.38,-10680.02C32733.74,-10673.45 32750.68,-10667.36 32767,-10663.83 32791.87,-10658.45 33207.2,-10672.02 33225,-10653.83 33279.67,-10597.96 33178.45,-10576.29 33079.12,-10568.04"/>
<polygon fill="red" stroke="red" points="33079.15,-10564.53 33068.9,-10567.24 33078.6,-10571.51 33079.15,-10564.53"/>
<text text-anchor="middle" x="33265.5" y="-10642.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu0 -->
<g id="node177" class="node">
<title>l1_attn_stage10_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="29536" cy="-10415.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29536" y="-10426.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="29536" y="-10411.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="29536" y="-10396.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu0&#45;&gt;l1_attn_stage10_gpu0 -->
<g id="edge161" class="edge">
<title>l1_attn_stage9_gpu0&#45;&gt;l1_attn_stage10_gpu0</title>
<path fill="none" stroke="black" d="M29693.67,-10529.51C29662.97,-10507.47 29621.93,-10478.02 29589.42,-10454.68"/>
<polygon fill="black" stroke="black" points="29591.09,-10451.57 29580.92,-10448.58 29587.01,-10457.25 29591.09,-10451.57"/>
</g>
<!-- l1_attn_stage10_gpu[next_gpu] -->
<g id="node1354" class="node">
<title>l1_attn_stage10_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="32931" cy="-10415.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="32931" y="-10411.63" font-family="Times,serif" font-size="14.00">l1_attn_stage10_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage9_gpu0&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge2337" class="edge">
<title>l1_attn_stage9_gpu0&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29791.29,-10532.33C29805.43,-10525.99 29820.95,-10520.18 29836,-10516.83 30064.1,-10466.05 31705.33,-10494.35 31939,-10491.83 31984.78,-10491.34 32718.1,-10492.74 32763,-10483.83 32808.32,-10474.84 32856.98,-10453.92 32890.21,-10437.73"/>
<polygon fill="red" stroke="red" points="32892.17,-10440.67 32899.58,-10433.1 32889.06,-10434.4 32892.17,-10440.67"/>
<text text-anchor="middle" x="31970.5" y="-10495.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu1 -->
<g id="node178" class="node">
<title>l1_attn_stage10_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="29744" cy="-10415.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29744" y="-10426.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="29744" y="-10411.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="29744" y="-10396.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu1&#45;&gt;l1_attn_stage10_gpu1 -->
<g id="edge162" class="edge">
<title>l1_attn_stage9_gpu1&#45;&gt;l1_attn_stage10_gpu1</title>
<path fill="none" stroke="black" d="M29891.05,-10529.15C29862.62,-10507.34 29824.89,-10478.39 29794.76,-10455.28"/>
<polygon fill="black" stroke="black" points="29796.55,-10452.23 29786.48,-10448.92 29792.29,-10457.79 29796.55,-10452.23"/>
</g>
<!-- l1_attn_stage9_gpu1&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge2338" class="edge">
<title>l1_attn_stage9_gpu1&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29986.28,-10532.26C30000.41,-10525.92 30015.94,-10520.13 30031,-10516.83 30084.59,-10505.09 31954.22,-10524.96 32006,-10506.83 32016.15,-10503.28 32014.86,-10495.42 32025,-10491.83 32063.66,-10478.17 32722.79,-10491.83 32763,-10483.83 32808.31,-10474.81 32856.98,-10453.9 32890.21,-10437.72"/>
<polygon fill="red" stroke="red" points="32892.17,-10440.66 32899.58,-10433.08 32889.06,-10434.38 32892.17,-10440.66"/>
<text text-anchor="middle" x="32056.5" y="-10495.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu2 -->
<g id="node179" class="node">
<title>l1_attn_stage10_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="29952" cy="-10415.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29952" y="-10426.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="29952" y="-10411.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="29952" y="-10396.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu2&#45;&gt;l1_attn_stage10_gpu2 -->
<g id="edge163" class="edge">
<title>l1_attn_stage9_gpu2&#45;&gt;l1_attn_stage10_gpu2</title>
<path fill="none" stroke="black" d="M30088.06,-10528.43C30061.94,-10506.91 30027.66,-10478.67 30000.05,-10455.92"/>
<polygon fill="black" stroke="black" points="30002.03,-10453.01 29992.08,-10449.35 29997.58,-10458.41 30002.03,-10453.01"/>
</g>
<!-- l1_attn_stage9_gpu2&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge2339" class="edge">
<title>l1_attn_stage9_gpu2&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30181.28,-10532.27C30195.41,-10525.93 30210.94,-10520.13 30226,-10516.83 30276.63,-10505.73 32043.08,-10523.96 32092,-10506.83 32102.15,-10503.28 32100.86,-10495.42 32111,-10491.83 32145.15,-10479.74 32727.48,-10490.93 32763,-10483.83 32808.31,-10474.78 32856.97,-10453.87 32890.2,-10437.7"/>
<polygon fill="red" stroke="red" points="32892.16,-10440.64 32899.57,-10433.07 32889.06,-10434.36 32892.16,-10440.64"/>
<text text-anchor="middle" x="32142.5" y="-10495.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu3 -->
<g id="node180" class="node">
<title>l1_attn_stage10_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="30160" cy="-10415.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30160" y="-10426.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="30160" y="-10411.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="30160" y="-10396.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu3&#45;&gt;l1_attn_stage10_gpu3 -->
<g id="edge164" class="edge">
<title>l1_attn_stage9_gpu3&#45;&gt;l1_attn_stage10_gpu3</title>
<path fill="none" stroke="black" d="M30285.6,-10528.07C30261.75,-10506.85 30230.69,-10479.22 30205.43,-10456.74"/>
<polygon fill="black" stroke="black" points="30207.58,-10453.98 30197.79,-10449.95 30202.93,-10459.21 30207.58,-10453.98"/>
</g>
<!-- l1_attn_stage9_gpu3&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge2340" class="edge">
<title>l1_attn_stage9_gpu3&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30376.28,-10532.27C30390.41,-10525.93 30405.94,-10520.14 30421,-10516.83 30468.67,-10506.37 32131.94,-10522.97 32178,-10506.83 32188.15,-10503.27 32186.86,-10495.43 32197,-10491.83 32226.63,-10481.31 32732.17,-10490.02 32763,-10483.83 32808.3,-10474.74 32856.97,-10453.83 32890.2,-10437.68"/>
<polygon fill="red" stroke="red" points="32892.15,-10440.62 32899.57,-10433.05 32889.05,-10434.34 32892.15,-10440.62"/>
<text text-anchor="middle" x="32228.5" y="-10495.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu4 -->
<g id="node181" class="node">
<title>l1_attn_stage10_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="30368" cy="-10415.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30368" y="-10426.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="30368" y="-10411.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="30368" y="-10396.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu4&#45;&gt;l1_attn_stage10_gpu4 -->
<g id="edge165" class="edge">
<title>l1_attn_stage9_gpu4&#45;&gt;l1_attn_stage10_gpu4</title>
<path fill="none" stroke="black" d="M30483.21,-10527.7C30461.5,-10506.71 30433.41,-10479.56 30410.4,-10457.32"/>
<polygon fill="black" stroke="black" points="30412.74,-10454.72 30403.12,-10450.28 30407.88,-10459.75 30412.74,-10454.72"/>
</g>
<!-- l1_attn_stage9_gpu4&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge2341" class="edge">
<title>l1_attn_stage9_gpu4&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30571.28,-10532.27C30585.41,-10525.93 30600.94,-10520.14 30616,-10516.83 30660.71,-10507.01 32220.8,-10521.98 32264,-10506.83 32274.15,-10503.27 32272.87,-10495.44 32283,-10491.83 32333.24,-10473.92 32710.72,-10494.4 32763,-10483.83 32808.29,-10474.68 32856.96,-10453.79 32890.19,-10437.65"/>
<polygon fill="red" stroke="red" points="32892.14,-10440.59 32899.56,-10433.03 32889.05,-10434.31 32892.14,-10440.59"/>
<text text-anchor="middle" x="32314.5" y="-10495.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu5 -->
<g id="node182" class="node">
<title>l1_attn_stage10_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="30576" cy="-10415.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30576" y="-10426.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="30576" y="-10411.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="30576" y="-10396.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu5&#45;&gt;l1_attn_stage10_gpu5 -->
<g id="edge166" class="edge">
<title>l1_attn_stage9_gpu5&#45;&gt;l1_attn_stage10_gpu5</title>
<path fill="none" stroke="black" d="M30680.88,-10527.34C30661.35,-10506.67 30636.27,-10480.12 30615.53,-10458.17"/>
<polygon fill="black" stroke="black" points="30617.81,-10455.48 30608.39,-10450.62 30612.72,-10460.29 30617.81,-10455.48"/>
</g>
<!-- l1_attn_stage9_gpu5&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge2342" class="edge">
<title>l1_attn_stage9_gpu5&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30766.28,-10532.28C30780.41,-10525.94 30795.94,-10520.14 30811,-10516.83 30852.75,-10507.65 32309.66,-10520.98 32350,-10506.83 32360.15,-10503.27 32358.87,-10495.46 32369,-10491.83 32410.22,-10477.05 32720.1,-10492.58 32763,-10483.83 32808.27,-10474.6 32856.94,-10453.72 32890.18,-10437.6"/>
<polygon fill="red" stroke="red" points="32892.13,-10440.55 32899.56,-10432.99 32889.04,-10434.27 32892.13,-10440.55"/>
<text text-anchor="middle" x="32400.5" y="-10495.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu6 -->
<g id="node183" class="node">
<title>l1_attn_stage10_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="30784" cy="-10415.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30784" y="-10426.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="30784" y="-10411.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="30784" y="-10396.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu6&#45;&gt;l1_attn_stage10_gpu6 -->
<g id="edge167" class="edge">
<title>l1_attn_stage9_gpu6&#45;&gt;l1_attn_stage10_gpu6</title>
<path fill="none" stroke="black" d="M30878.3,-10526.6C30860.88,-10506.23 30838.74,-10480.34 30820.29,-10458.77"/>
<polygon fill="black" stroke="black" points="30822.83,-10456.36 30813.67,-10451.03 30817.51,-10460.91 30822.83,-10456.36"/>
</g>
<!-- l1_attn_stage9_gpu6&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge2343" class="edge">
<title>l1_attn_stage9_gpu6&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30961.28,-10532.28C30975.41,-10525.94 30990.94,-10520.15 31006,-10516.83 31044.79,-10508.29 32398.52,-10519.99 32436,-10506.83 32446.15,-10503.27 32444.88,-10495.49 32455,-10491.83 32487.19,-10480.19 32729.48,-10490.77 32763,-10483.83 32808.11,-10474.5 32856.62,-10453.74 32889.86,-10437.68"/>
<polygon fill="red" stroke="red" points="32891.8,-10440.63 32899.24,-10433.08 32888.72,-10434.34 32891.8,-10440.63"/>
<text text-anchor="middle" x="32486.5" y="-10495.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu7 -->
<g id="node184" class="node">
<title>l1_attn_stage10_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="30992" cy="-10415.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30992" y="-10426.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="30992" y="-10411.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="30992" y="-10396.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu7&#45;&gt;l1_attn_stage10_gpu7 -->
<g id="edge168" class="edge">
<title>l1_attn_stage9_gpu7&#45;&gt;l1_attn_stage10_gpu7</title>
<path fill="none" stroke="black" d="M31076.13,-10526.23C31060.71,-10506.09 31041.23,-10480.65 31024.9,-10459.31"/>
<polygon fill="black" stroke="black" points="31027.67,-10457.17 31018.81,-10451.36 31022.11,-10461.43 31027.67,-10457.17"/>
</g>
<!-- l1_attn_stage9_gpu7&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge2344" class="edge">
<title>l1_attn_stage9_gpu7&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31156.28,-10532.29C31170.42,-10525.95 31185.95,-10520.15 31201,-10516.83 31272.67,-10501.04 32452.76,-10531.16 32522,-10506.83 32532.15,-10503.26 32530.9,-10495.54 32541,-10491.83 32587.34,-10474.8 32714.71,-10494.08 32763,-10483.83 32808.06,-10474.27 32856.58,-10453.54 32889.83,-10437.56"/>
<polygon fill="red" stroke="red" points="32891.76,-10440.51 32899.22,-10432.98 32888.69,-10434.22 32891.76,-10440.51"/>
<text text-anchor="middle" x="32572.5" y="-10495.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu8 -->
<g id="node185" class="node">
<title>l1_attn_stage10_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="31200" cy="-10415.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31200" y="-10426.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="31200" y="-10411.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="31200" y="-10396.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu8&#45;&gt;l1_attn_stage10_gpu8 -->
<g id="edge169" class="edge">
<title>l1_attn_stage9_gpu8&#45;&gt;l1_attn_stage10_gpu8</title>
<path fill="none" stroke="black" d="M31274.03,-10525.86C31260.63,-10506.04 31243.82,-10481.17 31229.61,-10460.14"/>
<polygon fill="black" stroke="black" points="31232.4,-10458.01 31223.9,-10451.69 31226.6,-10461.93 31232.4,-10458.01"/>
</g>
<!-- l1_attn_stage9_gpu8&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge2345" class="edge">
<title>l1_attn_stage9_gpu8&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31351.28,-10532.3C31365.42,-10525.96 31380.95,-10520.15 31396,-10516.83 31461.75,-10502.32 32544.48,-10529.18 32608,-10506.83 32618.15,-10503.26 32616.94,-10495.66 32627,-10491.83 32655.3,-10481.07 32733.46,-10490.45 32763,-10483.83 32807.67,-10473.82 32855.88,-10453.36 32889.15,-10437.57"/>
<polygon fill="red" stroke="red" points="32891.06,-10440.54 32898.55,-10433.05 32888.02,-10434.23 32891.06,-10440.54"/>
<text text-anchor="middle" x="32658.5" y="-10495.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu9 -->
<g id="node186" class="node">
<title>l1_attn_stage10_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="31408" cy="-10415.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31408" y="-10426.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="31408" y="-10411.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="31408" y="-10396.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu9&#45;&gt;l1_attn_stage10_gpu9 -->
<g id="edge170" class="edge">
<title>l1_attn_stage9_gpu9&#45;&gt;l1_attn_stage10_gpu9</title>
<path fill="none" stroke="black" d="M31472.21,-10525.86C31460.68,-10506.2 31446.24,-10481.57 31433.98,-10460.65"/>
<polygon fill="black" stroke="black" points="31436.95,-10458.8 31428.87,-10451.94 31430.91,-10462.34 31436.95,-10458.8"/>
</g>
<!-- l1_attn_stage9_gpu9&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge2346" class="edge">
<title>l1_attn_stage9_gpu9&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31546.29,-10532.3C31560.42,-10525.97 31575.95,-10520.16 31591,-10516.83 31650.83,-10503.6 32636.2,-10527.19 32694,-10506.83 32704.15,-10503.26 32703.15,-10496.15 32713,-10491.83 32733.61,-10482.79 32741.31,-10489.84 32763,-10483.83 32806.28,-10471.84 32853.59,-10452.2 32886.94,-10437.19"/>
<polygon fill="red" stroke="red" points="32888.74,-10440.22 32896.4,-10432.9 32885.84,-10433.85 32888.74,-10440.22"/>
<text text-anchor="middle" x="32744.5" y="-10495.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu10 -->
<g id="node187" class="node">
<title>l1_attn_stage10_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="31616" cy="-10415.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31616" y="-10426.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="31616" y="-10411.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="31616" y="-10396.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu10&#45;&gt;l1_attn_stage10_gpu10 -->
<g id="edge171" class="edge">
<title>l1_attn_stage9_gpu10&#45;&gt;l1_attn_stage10_gpu10</title>
<path fill="none" stroke="black" d="M31670.2,-10525.49C31660.6,-10506.14 31648.64,-10482.07 31638.41,-10461.46"/>
<polygon fill="black" stroke="black" points="31641.42,-10459.66 31633.84,-10452.26 31635.16,-10462.78 31641.42,-10459.66"/>
</g>
<!-- l1_attn_stage9_gpu10&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge2347" class="edge">
<title>l1_attn_stage9_gpu10&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31741.29,-10532.32C31755.42,-10525.98 31770.95,-10520.17 31786,-10516.83 31839.92,-10504.88 32727.92,-10525.21 32780,-10506.83 32790.15,-10503.25 32790.08,-10497.85 32799,-10491.83 32828.36,-10472.01 32863.2,-10452.22 32889.72,-10437.88"/>
<polygon fill="red" stroke="red" points="32891.57,-10440.86 32898.73,-10433.05 32888.26,-10434.69 32891.57,-10440.86"/>
<text text-anchor="middle" x="32830.5" y="-10495.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu11 -->
<g id="node188" class="node">
<title>l1_attn_stage10_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="31824" cy="-10415.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31824" y="-10426.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="31824" y="-10411.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="31824" y="-10396.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu11&#45;&gt;l1_attn_stage10_gpu11 -->
<g id="edge172" class="edge">
<title>l1_attn_stage9_gpu11&#45;&gt;l1_attn_stage10_gpu11</title>
<path fill="none" stroke="black" d="M31868.26,-10525.12C31860.49,-10506 31850.86,-10482.35 31842.58,-10461.98"/>
<polygon fill="black" stroke="black" points="31845.76,-10460.53 31838.75,-10452.59 31839.28,-10463.17 31845.76,-10460.53"/>
</g>
<!-- l1_attn_stage9_gpu11&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge2348" class="edge">
<title>l1_attn_stage9_gpu11&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31936.29,-10532.33C31950.42,-10525.99 31965.95,-10520.18 31981,-10516.83 32005,-10511.5 32844.19,-10518.18 32866,-10506.83 32879.7,-10499.71 32901.58,-10466.29 32916.12,-10442.13"/>
<polygon fill="red" stroke="red" points="32919.21,-10443.79 32921.3,-10433.4 32913.19,-10440.21 32919.21,-10443.79"/>
<text text-anchor="middle" x="32912.5" y="-10495.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu12 -->
<g id="node189" class="node">
<title>l1_attn_stage10_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="32032" cy="-10415.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32032" y="-10426.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="32032" y="-10411.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="32032" y="-10396.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu12&#45;&gt;l1_attn_stage10_gpu12 -->
<g id="edge173" class="edge">
<title>l1_attn_stage9_gpu12&#45;&gt;l1_attn_stage10_gpu12</title>
<path fill="none" stroke="black" d="M32023.2,-10532.69C32009.7,-10526.62 31995.07,-10520.85 31981,-10516.83 31963.98,-10511.98 31913.7,-10520.11 31902,-10506.83 31897.59,-10501.83 31898.04,-10497.19 31902,-10491.83 31909.18,-10482.11 31917.05,-10488.95 31928,-10483.83 31945.44,-10475.68 31963.39,-10464.99 31979.36,-10454.52"/>
<polygon fill="black" stroke="black" points="31981.64,-10457.21 31988.02,-10448.75 31977.76,-10451.39 31981.64,-10457.21"/>
</g>
<!-- l1_attn_stage9_gpu12&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge2349" class="edge">
<title>l1_attn_stage9_gpu12&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32131.29,-10532.34C32145.43,-10526 32160.95,-10520.19 32176,-10516.83 32197.04,-10512.14 32936.86,-10522.17 32952,-10506.83 32968.7,-10489.91 32959.21,-10462.47 32948.14,-10442.23"/>
<polygon fill="red" stroke="red" points="32951.11,-10440.37 32943.04,-10433.5 32945.07,-10443.9 32951.11,-10440.37"/>
<text text-anchor="middle" x="32990.5" y="-10495.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu13 -->
<g id="node190" class="node">
<title>l1_attn_stage10_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="32240" cy="-10415.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32240" y="-10426.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="32240" y="-10411.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="32240" y="-10396.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu13&#45;&gt;l1_attn_stage10_gpu13 -->
<g id="edge174" class="edge">
<title>l1_attn_stage9_gpu13&#45;&gt;l1_attn_stage10_gpu13</title>
<path fill="none" stroke="black" d="M32219.71,-10532.37C32205.86,-10526.11 32190.69,-10520.33 32176,-10516.83 32161.56,-10513.39 31919.3,-10517.52 31909,-10506.83 31904.38,-10502.03 31904.37,-10496.63 31909,-10491.83 31917.76,-10482.75 32123.97,-10487.63 32136,-10483.83 32155.58,-10477.66 32175,-10466.72 32191.67,-10455.41"/>
<polygon fill="black" stroke="black" points="32193.94,-10458.1 32200.13,-10449.49 32189.93,-10452.36 32193.94,-10458.1"/>
</g>
<!-- l1_attn_stage9_gpu13&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge2350" class="edge">
<title>l1_attn_stage9_gpu13&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32326.3,-10532.37C32340.43,-10526.03 32355.96,-10520.21 32371,-10516.83 32389.08,-10512.78 33025,-10520.03 33038,-10506.83 33063.61,-10480.84 33022.49,-10454.24 32984.03,-10436.67"/>
<polygon fill="red" stroke="red" points="32985.43,-10433.46 32974.87,-10432.62 32982.61,-10439.86 32985.43,-10433.46"/>
<text text-anchor="middle" x="33076.5" y="-10495.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu14 -->
<g id="node191" class="node">
<title>l1_attn_stage10_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="32448" cy="-10415.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32448" y="-10426.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="32448" y="-10411.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="32448" y="-10396.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu14&#45;&gt;l1_attn_stage10_gpu14 -->
<g id="edge175" class="edge">
<title>l1_attn_stage9_gpu14&#45;&gt;l1_attn_stage10_gpu14</title>
<path fill="none" stroke="black" d="M32414.75,-10532.21C32400.89,-10525.96 32385.72,-10520.22 32371,-10516.83 32346.36,-10511.16 31933.68,-10524.91 31916,-10506.83 31911.34,-10502.07 31911.33,-10496.59 31916,-10491.83 31924.33,-10483.35 32332.63,-10487.31 32344,-10483.83 32363.63,-10477.82 32383.07,-10466.92 32399.73,-10455.61"/>
<polygon fill="black" stroke="black" points="32402.01,-10458.29 32408.18,-10449.68 32397.99,-10452.56 32402.01,-10458.29"/>
</g>
<!-- l1_attn_stage9_gpu14&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge2351" class="edge">
<title>l1_attn_stage9_gpu14&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32521.31,-10532.4C32535.44,-10526.06 32550.96,-10520.23 32566,-10516.83 32581.12,-10513.42 33113.14,-10517.89 33124,-10506.83 33160.82,-10469.35 33097.45,-10445.61 33033.69,-10431.89"/>
<polygon fill="red" stroke="red" points="33034.38,-10428.46 33023.88,-10429.86 33032.96,-10435.32 33034.38,-10428.46"/>
<text text-anchor="middle" x="33163.5" y="-10495.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu15 -->
<g id="node192" class="node">
<title>l1_attn_stage10_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="32656" cy="-10415.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32656" y="-10426.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="32656" y="-10411.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="32656" y="-10396.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu15&#45;&gt;l1_attn_stage10_gpu15 -->
<g id="edge176" class="edge">
<title>l1_attn_stage9_gpu15&#45;&gt;l1_attn_stage10_gpu15</title>
<path fill="none" stroke="black" d="M32610.02,-10532.26C32596.09,-10525.96 32580.82,-10520.19 32566,-10516.83 32548.58,-10512.88 31935.53,-10519.56 31923,-10506.83 31918.32,-10502.08 31918.32,-10496.58 31923,-10491.83 31935.28,-10479.4 32535.28,-10488.9 32552,-10483.83 32571.65,-10477.88 32591.09,-10466.99 32607.75,-10455.67"/>
<polygon fill="black" stroke="black" points="32610.03,-10458.35 32616.2,-10449.74 32606.01,-10452.63 32610.03,-10458.35"/>
</g>
<!-- l1_attn_stage9_gpu15&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge2352" class="edge">
<title>l1_attn_stage9_gpu15&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32718.38,-10533.02C32733.74,-10526.46 32750.69,-10520.37 32767,-10516.83 32791.06,-10511.62 33192.79,-10524.43 33210,-10506.83 33259.67,-10456.03 33172.33,-10433.72 33082.57,-10423.94"/>
<polygon fill="red" stroke="red" points="33082.78,-10420.44 33072.47,-10422.89 33082.05,-10427.4 33082.78,-10420.44"/>
<text text-anchor="middle" x="33249.5" y="-10495.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu0 -->
<g id="node193" class="node">
<title>l1_attn_stage11_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="29536" cy="-10268.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29536" y="-10279.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="29536" y="-10264.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="29536" y="-10249.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu0&#45;&gt;l1_attn_stage11_gpu0 -->
<g id="edge177" class="edge">
<title>l1_attn_stage10_gpu0&#45;&gt;l1_attn_stage11_gpu0</title>
<path fill="none" stroke="black" d="M29536,-10377.74C29536,-10359.02 29536,-10336.03 29536,-10316.05"/>
<polygon fill="black" stroke="black" points="29539.5,-10315.91 29536,-10305.91 29532.5,-10315.91 29539.5,-10315.91"/>
</g>
<!-- l1_attn_stage11_gpu[next_gpu] -->
<g id="node1355" class="node">
<title>l1_attn_stage11_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="32931" cy="-10268.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="32931" y="-10264.63" font-family="Times,serif" font-size="14.00">l1_attn_stage11_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage10_gpu0&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge2353" class="edge">
<title>l1_attn_stage10_gpu0&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29592.98,-10385.2C29607.91,-10378.91 29624.24,-10373.15 29640,-10369.83 29889.97,-10317.18 31683.55,-10347.46 31939,-10344.83 31984.78,-10344.36 32718.1,-10345.74 32763,-10336.83 32808.32,-10327.84 32856.98,-10306.92 32890.21,-10290.73"/>
<polygon fill="red" stroke="red" points="32892.17,-10293.67 32899.58,-10286.1 32889.06,-10287.4 32892.17,-10293.67"/>
<text text-anchor="middle" x="31970.5" y="-10348.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu1 -->
<g id="node194" class="node">
<title>l1_attn_stage11_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="29744" cy="-10268.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29744" y="-10279.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="29744" y="-10264.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="29744" y="-10249.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu1&#45;&gt;l1_attn_stage11_gpu1 -->
<g id="edge178" class="edge">
<title>l1_attn_stage10_gpu1&#45;&gt;l1_attn_stage11_gpu1</title>
<path fill="none" stroke="black" d="M29744,-10377.74C29744,-10359.02 29744,-10336.03 29744,-10316.05"/>
<polygon fill="black" stroke="black" points="29747.5,-10315.91 29744,-10305.91 29740.5,-10315.91 29747.5,-10315.91"/>
</g>
<!-- l1_attn_stage10_gpu1&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge2354" class="edge">
<title>l1_attn_stage10_gpu1&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29800.97,-10385.14C29815.89,-10378.84 29832.23,-10373.1 29848,-10369.83 29906.7,-10357.66 31949.42,-10379.62 32006,-10359.83 32016.16,-10356.28 32014.86,-10348.42 32025,-10344.83 32063.66,-10331.17 32722.79,-10344.83 32763,-10336.83 32808.31,-10327.81 32856.98,-10306.9 32890.21,-10290.72"/>
<polygon fill="red" stroke="red" points="32892.17,-10293.66 32899.58,-10286.08 32889.06,-10287.38 32892.17,-10293.66"/>
<text text-anchor="middle" x="32056.5" y="-10348.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu2 -->
<g id="node195" class="node">
<title>l1_attn_stage11_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="29952" cy="-10268.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29952" y="-10279.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="29952" y="-10264.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="29952" y="-10249.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu2&#45;&gt;l1_attn_stage11_gpu2 -->
<g id="edge179" class="edge">
<title>l1_attn_stage10_gpu2&#45;&gt;l1_attn_stage11_gpu2</title>
<path fill="none" stroke="black" d="M29952,-10377.74C29952,-10359.02 29952,-10336.03 29952,-10316.05"/>
<polygon fill="black" stroke="black" points="29955.5,-10315.91 29952,-10305.91 29948.5,-10315.91 29955.5,-10315.91"/>
</g>
<!-- l1_attn_stage10_gpu2&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge2355" class="edge">
<title>l1_attn_stage10_gpu2&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30008.97,-10385.14C30023.89,-10378.85 30040.23,-10373.1 30056,-10369.83 30111.38,-10358.34 32038.62,-10378.51 32092,-10359.83 32102.16,-10356.28 32100.86,-10348.42 32111,-10344.83 32145.15,-10332.74 32727.48,-10343.93 32763,-10336.83 32808.31,-10327.78 32856.97,-10306.87 32890.2,-10290.7"/>
<polygon fill="red" stroke="red" points="32892.16,-10293.64 32899.57,-10286.07 32889.06,-10287.36 32892.16,-10293.64"/>
<text text-anchor="middle" x="32142.5" y="-10348.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu3 -->
<g id="node196" class="node">
<title>l1_attn_stage11_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="30160" cy="-10268.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30160" y="-10279.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="30160" y="-10264.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="30160" y="-10249.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu3&#45;&gt;l1_attn_stage11_gpu3 -->
<g id="edge180" class="edge">
<title>l1_attn_stage10_gpu3&#45;&gt;l1_attn_stage11_gpu3</title>
<path fill="none" stroke="black" d="M30160,-10377.74C30160,-10359.02 30160,-10336.03 30160,-10316.05"/>
<polygon fill="black" stroke="black" points="30163.5,-10315.91 30160,-10305.91 30156.5,-10315.91 30163.5,-10315.91"/>
</g>
<!-- l1_attn_stage10_gpu3&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge2356" class="edge">
<title>l1_attn_stage10_gpu3&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30216.97,-10385.14C30231.9,-10378.85 30248.23,-10373.11 30264,-10369.83 30316.06,-10359.02 32127.82,-10377.4 32178,-10359.83 32188.15,-10356.28 32186.86,-10348.43 32197,-10344.83 32226.63,-10334.31 32732.17,-10343.02 32763,-10336.83 32808.3,-10327.74 32856.97,-10306.83 32890.2,-10290.68"/>
<polygon fill="red" stroke="red" points="32892.15,-10293.62 32899.57,-10286.05 32889.05,-10287.34 32892.15,-10293.62"/>
<text text-anchor="middle" x="32228.5" y="-10348.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu4 -->
<g id="node197" class="node">
<title>l1_attn_stage11_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="30368" cy="-10268.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30368" y="-10279.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="30368" y="-10264.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="30368" y="-10249.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu4&#45;&gt;l1_attn_stage11_gpu4 -->
<g id="edge181" class="edge">
<title>l1_attn_stage10_gpu4&#45;&gt;l1_attn_stage11_gpu4</title>
<path fill="none" stroke="black" d="M30368,-10377.74C30368,-10359.02 30368,-10336.03 30368,-10316.05"/>
<polygon fill="black" stroke="black" points="30371.5,-10315.91 30368,-10305.91 30364.5,-10315.91 30371.5,-10315.91"/>
</g>
<!-- l1_attn_stage10_gpu4&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge2357" class="edge">
<title>l1_attn_stage10_gpu4&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30424.97,-10385.15C30439.9,-10378.85 30456.23,-10373.11 30472,-10369.83 30520.74,-10359.7 32217.02,-10376.29 32264,-10359.83 32274.15,-10356.27 32272.87,-10348.44 32283,-10344.83 32333.24,-10326.92 32710.72,-10347.4 32763,-10336.83 32808.29,-10327.68 32856.96,-10306.79 32890.19,-10290.65"/>
<polygon fill="red" stroke="red" points="32892.14,-10293.59 32899.56,-10286.03 32889.05,-10287.31 32892.14,-10293.59"/>
<text text-anchor="middle" x="32314.5" y="-10348.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu5 -->
<g id="node198" class="node">
<title>l1_attn_stage11_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="30576" cy="-10268.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30576" y="-10279.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="30576" y="-10264.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="30576" y="-10249.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu5&#45;&gt;l1_attn_stage11_gpu5 -->
<g id="edge182" class="edge">
<title>l1_attn_stage10_gpu5&#45;&gt;l1_attn_stage11_gpu5</title>
<path fill="none" stroke="black" d="M30576,-10377.74C30576,-10359.02 30576,-10336.03 30576,-10316.05"/>
<polygon fill="black" stroke="black" points="30579.5,-10315.91 30576,-10305.91 30572.5,-10315.91 30579.5,-10315.91"/>
</g>
<!-- l1_attn_stage10_gpu5&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge2358" class="edge">
<title>l1_attn_stage10_gpu5&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30632.97,-10385.15C30647.9,-10378.86 30664.23,-10373.11 30680,-10369.83 30725.42,-10360.38 32306.22,-10375.18 32350,-10359.83 32360.15,-10356.27 32358.87,-10348.46 32369,-10344.83 32410.22,-10330.05 32720.1,-10345.58 32763,-10336.83 32808.27,-10327.6 32856.94,-10306.72 32890.18,-10290.6"/>
<polygon fill="red" stroke="red" points="32892.13,-10293.55 32899.56,-10285.99 32889.04,-10287.27 32892.13,-10293.55"/>
<text text-anchor="middle" x="32400.5" y="-10348.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu6 -->
<g id="node199" class="node">
<title>l1_attn_stage11_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="30784" cy="-10268.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30784" y="-10279.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="30784" y="-10264.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="30784" y="-10249.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu6&#45;&gt;l1_attn_stage11_gpu6 -->
<g id="edge183" class="edge">
<title>l1_attn_stage10_gpu6&#45;&gt;l1_attn_stage11_gpu6</title>
<path fill="none" stroke="black" d="M30784,-10377.74C30784,-10359.02 30784,-10336.03 30784,-10316.05"/>
<polygon fill="black" stroke="black" points="30787.5,-10315.91 30784,-10305.91 30780.5,-10315.91 30787.5,-10315.91"/>
</g>
<!-- l1_attn_stage10_gpu6&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge2359" class="edge">
<title>l1_attn_stage10_gpu6&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30840.97,-10385.16C30855.9,-10378.86 30872.23,-10373.12 30888,-10369.83 30930.1,-10361.06 32395.42,-10374.07 32436,-10359.83 32446.15,-10356.27 32444.88,-10348.49 32455,-10344.83 32487.19,-10333.19 32729.48,-10343.77 32763,-10336.83 32808.11,-10327.5 32856.62,-10306.74 32889.86,-10290.68"/>
<polygon fill="red" stroke="red" points="32891.8,-10293.63 32899.24,-10286.08 32888.72,-10287.34 32891.8,-10293.63"/>
<text text-anchor="middle" x="32486.5" y="-10348.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu7 -->
<g id="node200" class="node">
<title>l1_attn_stage11_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="30992" cy="-10268.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30992" y="-10279.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="30992" y="-10264.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="30992" y="-10249.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu7&#45;&gt;l1_attn_stage11_gpu7 -->
<g id="edge184" class="edge">
<title>l1_attn_stage10_gpu7&#45;&gt;l1_attn_stage11_gpu7</title>
<path fill="none" stroke="black" d="M30992,-10377.74C30992,-10359.02 30992,-10336.03 30992,-10316.05"/>
<polygon fill="black" stroke="black" points="30995.5,-10315.91 30992,-10305.91 30988.5,-10315.91 30995.5,-10315.91"/>
</g>
<!-- l1_attn_stage10_gpu7&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge2360" class="edge">
<title>l1_attn_stage10_gpu7&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31048.98,-10385.16C31063.9,-10378.87 31080.24,-10373.12 31096,-10369.83 31134.78,-10361.74 32484.62,-10372.95 32522,-10359.83 32532.15,-10356.27 32530.9,-10348.54 32541,-10344.83 32587.34,-10327.8 32714.71,-10347.08 32763,-10336.83 32808.06,-10327.27 32856.58,-10306.54 32889.83,-10290.56"/>
<polygon fill="red" stroke="red" points="32891.76,-10293.51 32899.22,-10285.98 32888.69,-10287.22 32891.76,-10293.51"/>
<text text-anchor="middle" x="32572.5" y="-10348.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu8 -->
<g id="node201" class="node">
<title>l1_attn_stage11_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="31200" cy="-10268.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31200" y="-10279.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="31200" y="-10264.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="31200" y="-10249.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu8&#45;&gt;l1_attn_stage11_gpu8 -->
<g id="edge185" class="edge">
<title>l1_attn_stage10_gpu8&#45;&gt;l1_attn_stage11_gpu8</title>
<path fill="none" stroke="black" d="M31200,-10377.74C31200,-10359.02 31200,-10336.03 31200,-10316.05"/>
<polygon fill="black" stroke="black" points="31203.5,-10315.91 31200,-10305.91 31196.5,-10315.91 31203.5,-10315.91"/>
</g>
<!-- l1_attn_stage10_gpu8&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge2361" class="edge">
<title>l1_attn_stage10_gpu8&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31256.98,-10385.17C31271.9,-10378.88 31288.24,-10373.13 31304,-10369.83 31374.91,-10355.01 32539.65,-10383.85 32608,-10359.83 32618.15,-10356.26 32616.94,-10348.66 32627,-10344.83 32655.3,-10334.07 32733.46,-10343.45 32763,-10336.83 32807.67,-10326.82 32855.88,-10306.36 32889.15,-10290.57"/>
<polygon fill="red" stroke="red" points="32891.06,-10293.54 32898.55,-10286.05 32888.02,-10287.23 32891.06,-10293.54"/>
<text text-anchor="middle" x="32658.5" y="-10348.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu9 -->
<g id="node202" class="node">
<title>l1_attn_stage11_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="31408" cy="-10268.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31408" y="-10279.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="31408" y="-10264.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="31408" y="-10249.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu9&#45;&gt;l1_attn_stage11_gpu9 -->
<g id="edge186" class="edge">
<title>l1_attn_stage10_gpu9&#45;&gt;l1_attn_stage11_gpu9</title>
<path fill="none" stroke="black" d="M31408,-10377.74C31408,-10359.02 31408,-10336.03 31408,-10316.05"/>
<polygon fill="black" stroke="black" points="31411.5,-10315.91 31408,-10305.91 31404.5,-10315.91 31411.5,-10315.91"/>
</g>
<!-- l1_attn_stage10_gpu9&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge2362" class="edge">
<title>l1_attn_stage10_gpu9&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31464.98,-10385.18C31479.9,-10378.88 31496.24,-10373.13 31512,-10369.83 31576.28,-10356.37 32632.05,-10381.63 32694,-10359.83 32704.15,-10356.26 32703.15,-10349.15 32713,-10344.83 32733.61,-10335.79 32741.31,-10342.84 32763,-10336.83 32806.28,-10324.84 32853.59,-10305.2 32886.94,-10290.19"/>
<polygon fill="red" stroke="red" points="32888.74,-10293.22 32896.4,-10285.9 32885.84,-10286.85 32888.74,-10293.22"/>
<text text-anchor="middle" x="32744.5" y="-10348.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu10 -->
<g id="node203" class="node">
<title>l1_attn_stage11_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="31616" cy="-10268.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31616" y="-10279.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="31616" y="-10264.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="31616" y="-10249.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu10&#45;&gt;l1_attn_stage11_gpu10 -->
<g id="edge187" class="edge">
<title>l1_attn_stage10_gpu10&#45;&gt;l1_attn_stage11_gpu10</title>
<path fill="none" stroke="black" d="M31616,-10377.74C31616,-10359.02 31616,-10336.03 31616,-10316.05"/>
<polygon fill="black" stroke="black" points="31619.5,-10315.91 31616,-10305.91 31612.5,-10315.91 31619.5,-10315.91"/>
</g>
<!-- l1_attn_stage10_gpu10&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge2363" class="edge">
<title>l1_attn_stage10_gpu10&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31672.98,-10385.19C31687.91,-10378.89 31704.24,-10373.14 31720,-10369.83 31777.64,-10357.74 32724.46,-10379.41 32780,-10359.83 32790.15,-10356.26 32790.08,-10350.85 32799,-10344.83 32828.36,-10325.01 32863.2,-10305.22 32889.72,-10290.88"/>
<polygon fill="red" stroke="red" points="32891.57,-10293.86 32898.73,-10286.05 32888.26,-10287.69 32891.57,-10293.86"/>
<text text-anchor="middle" x="32830.5" y="-10348.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu11 -->
<g id="node204" class="node">
<title>l1_attn_stage11_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="31824" cy="-10268.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31824" y="-10279.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="31824" y="-10264.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="31824" y="-10249.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu11&#45;&gt;l1_attn_stage11_gpu11 -->
<g id="edge188" class="edge">
<title>l1_attn_stage10_gpu11&#45;&gt;l1_attn_stage11_gpu11</title>
<path fill="none" stroke="black" d="M31824,-10377.74C31824,-10359.02 31824,-10336.03 31824,-10316.05"/>
<polygon fill="black" stroke="black" points="31827.5,-10315.91 31824,-10305.91 31820.5,-10315.91 31827.5,-10315.91"/>
</g>
<!-- l1_attn_stage10_gpu11&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge2364" class="edge">
<title>l1_attn_stage10_gpu11&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31880.98,-10385.2C31895.91,-10378.91 31912.24,-10373.15 31928,-10369.83 31953.5,-10364.46 32842.88,-10371.85 32866,-10359.83 32879.7,-10352.71 32901.58,-10319.29 32916.12,-10295.13"/>
<polygon fill="red" stroke="red" points="32919.21,-10296.79 32921.3,-10286.4 32913.19,-10293.22 32919.21,-10296.79"/>
<text text-anchor="middle" x="32912.5" y="-10348.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu12 -->
<g id="node205" class="node">
<title>l1_attn_stage11_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="32032" cy="-10268.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32032" y="-10279.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="32032" y="-10264.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="32032" y="-10249.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu12&#45;&gt;l1_attn_stage11_gpu12 -->
<g id="edge189" class="edge">
<title>l1_attn_stage10_gpu12&#45;&gt;l1_attn_stage11_gpu12</title>
<path fill="none" stroke="black" d="M31969.19,-10387.01C31955.64,-10381.24 31941.37,-10375.26 31928,-10369.83 31916.53,-10365.17 31909.01,-10370.04 31902,-10359.83 31898.23,-10354.34 31898.04,-10350.19 31902,-10344.83 31909.18,-10335.11 31917.05,-10341.95 31928,-10336.83 31945.44,-10328.68 31963.39,-10317.99 31979.36,-10307.52"/>
<polygon fill="black" stroke="black" points="31981.64,-10310.21 31988.02,-10301.75 31977.76,-10304.39 31981.64,-10310.21"/>
</g>
<!-- l1_attn_stage10_gpu12&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge2365" class="edge">
<title>l1_attn_stage10_gpu12&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32088.99,-10385.22C32103.91,-10378.92 32120.24,-10373.16 32136,-10369.83 32158.18,-10365.14 32936.07,-10375.96 32952,-10359.83 32968.71,-10342.92 32959.21,-10315.47 32948.15,-10295.23"/>
<polygon fill="red" stroke="red" points="32951.11,-10293.37 32943.04,-10286.51 32945.07,-10296.9 32951.11,-10293.37"/>
<text text-anchor="middle" x="32990.5" y="-10348.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu13 -->
<g id="node206" class="node">
<title>l1_attn_stage11_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="32240" cy="-10268.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32240" y="-10279.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="32240" y="-10264.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="32240" y="-10249.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu13&#45;&gt;l1_attn_stage11_gpu13 -->
<g id="edge190" class="edge">
<title>l1_attn_stage10_gpu13&#45;&gt;l1_attn_stage11_gpu13</title>
<path fill="none" stroke="black" d="M32182.39,-10385.33C32167.62,-10379.12 32151.51,-10373.37 32136,-10369.83 32111.39,-10364.22 31926.45,-10378.07 31909,-10359.83 31904.39,-10355.02 31904.37,-10349.63 31909,-10344.83 31917.76,-10335.75 32123.97,-10340.63 32136,-10336.83 32155.58,-10330.66 32175,-10319.72 32191.67,-10308.41"/>
<polygon fill="black" stroke="black" points="32193.94,-10311.1 32200.13,-10302.49 32189.93,-10305.36 32193.94,-10311.1"/>
</g>
<!-- l1_attn_stage10_gpu13&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge2366" class="edge">
<title>l1_attn_stage10_gpu13&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32296.99,-10385.24C32311.92,-10378.95 32328.25,-10373.18 32344,-10369.83 32362.86,-10365.82 33024.47,-10373.56 33038,-10359.83 33063.62,-10333.84 33022.49,-10307.25 32984.04,-10289.67"/>
<polygon fill="red" stroke="red" points="32985.44,-10286.46 32974.88,-10285.62 32982.61,-10292.87 32985.44,-10286.46"/>
<text text-anchor="middle" x="33076.5" y="-10348.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu14 -->
<g id="node207" class="node">
<title>l1_attn_stage11_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="32448" cy="-10268.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32448" y="-10279.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="32448" y="-10264.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="32448" y="-10249.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu14&#45;&gt;l1_attn_stage11_gpu14 -->
<g id="edge191" class="edge">
<title>l1_attn_stage10_gpu14&#45;&gt;l1_attn_stage11_gpu14</title>
<path fill="none" stroke="black" d="M32390.71,-10385.23C32375.86,-10378.97 32359.64,-10373.23 32344,-10369.83 32320.76,-10364.78 31932.62,-10376.85 31916,-10359.83 31911.34,-10355.06 31911.33,-10349.59 31916,-10344.83 31924.33,-10336.35 32332.63,-10340.31 32344,-10336.83 32363.63,-10330.82 32383.07,-10319.92 32399.73,-10308.61"/>
<polygon fill="black" stroke="black" points="32402.01,-10311.29 32408.18,-10302.68 32397.99,-10305.56 32402.01,-10311.29"/>
</g>
<!-- l1_attn_stage10_gpu14&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge2367" class="edge">
<title>l1_attn_stage10_gpu14&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32505,-10385.28C32519.92,-10378.98 32536.25,-10373.2 32552,-10369.83 32567.54,-10366.51 33112.86,-10371.17 33124,-10359.83 33160.88,-10322.3 33097.24,-10298.54 33033.37,-10284.83"/>
<polygon fill="red" stroke="red" points="33034.05,-10281.4 33023.55,-10282.8 33032.63,-10288.25 33034.05,-10281.4"/>
<text text-anchor="middle" x="33163.5" y="-10348.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu15 -->
<g id="node208" class="node">
<title>l1_attn_stage11_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="32656" cy="-10268.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32656" y="-10279.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="32656" y="-10264.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="32656" y="-10249.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu15&#45;&gt;l1_attn_stage11_gpu15 -->
<g id="edge192" class="edge">
<title>l1_attn_stage10_gpu15&#45;&gt;l1_attn_stage11_gpu15</title>
<path fill="none" stroke="black" d="M32599,-10385.26C32584.08,-10378.96 32567.75,-10373.19 32552,-10369.83 32534.91,-10366.19 31935.26,-10372.29 31923,-10359.83 31918.32,-10355.08 31918.32,-10349.58 31923,-10344.83 31935.28,-10332.4 32535.28,-10341.9 32552,-10336.83 32571.65,-10330.88 32591.09,-10319.99 32607.75,-10308.67"/>
<polygon fill="black" stroke="black" points="32610.03,-10311.35 32616.2,-10302.74 32606.01,-10305.63 32610.03,-10311.35"/>
</g>
<!-- l1_attn_stage10_gpu15&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge2368" class="edge">
<title>l1_attn_stage10_gpu15&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32715.56,-10385.91C32731.88,-10379.39 32749.81,-10373.35 32767,-10369.83 32791.12,-10364.89 33192.79,-10377.43 33210,-10359.83 33259.67,-10309.03 33172.33,-10286.72 33082.57,-10276.94"/>
<polygon fill="red" stroke="red" points="33082.78,-10273.44 33072.47,-10275.89 33082.05,-10280.4 33082.78,-10273.44"/>
<text text-anchor="middle" x="33249.5" y="-10348.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu0 -->
<g id="node209" class="node">
<title>l1_attn_stage12_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="29536" cy="-10121.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29536" y="-10132.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="29536" y="-10117.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="29536" y="-10102.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu0&#45;&gt;l1_attn_stage12_gpu0 -->
<g id="edge193" class="edge">
<title>l1_attn_stage11_gpu0&#45;&gt;l1_attn_stage12_gpu0</title>
<path fill="none" stroke="black" d="M29536,-10230.74C29536,-10212.02 29536,-10189.03 29536,-10169.05"/>
<polygon fill="black" stroke="black" points="29539.5,-10168.91 29536,-10158.91 29532.5,-10168.91 29539.5,-10168.91"/>
</g>
<!-- l1_attn_stage12_gpu[next_gpu] -->
<g id="node1356" class="node">
<title>l1_attn_stage12_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="32931" cy="-10121.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="32931" y="-10117.63" font-family="Times,serif" font-size="14.00">l1_attn_stage12_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage11_gpu0&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge2369" class="edge">
<title>l1_attn_stage11_gpu0&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29592.98,-10238.2C29607.91,-10231.91 29624.24,-10226.15 29640,-10222.83 29889.97,-10170.18 31683.55,-10200.46 31939,-10197.83 31984.78,-10197.36 32718.1,-10198.74 32763,-10189.83 32808.32,-10180.84 32856.98,-10159.92 32890.21,-10143.73"/>
<polygon fill="red" stroke="red" points="32892.17,-10146.67 32899.58,-10139.1 32889.06,-10140.4 32892.17,-10146.67"/>
<text text-anchor="middle" x="31970.5" y="-10201.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu1 -->
<g id="node210" class="node">
<title>l1_attn_stage12_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="29744" cy="-10121.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29744" y="-10132.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="29744" y="-10117.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="29744" y="-10102.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu1&#45;&gt;l1_attn_stage12_gpu1 -->
<g id="edge194" class="edge">
<title>l1_attn_stage11_gpu1&#45;&gt;l1_attn_stage12_gpu1</title>
<path fill="none" stroke="black" d="M29744,-10230.74C29744,-10212.02 29744,-10189.03 29744,-10169.05"/>
<polygon fill="black" stroke="black" points="29747.5,-10168.91 29744,-10158.91 29740.5,-10168.91 29747.5,-10168.91"/>
</g>
<!-- l1_attn_stage11_gpu1&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge2370" class="edge">
<title>l1_attn_stage11_gpu1&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29800.97,-10238.14C29815.89,-10231.84 29832.23,-10226.1 29848,-10222.83 29906.7,-10210.66 31949.42,-10232.62 32006,-10212.83 32016.16,-10209.28 32014.86,-10201.42 32025,-10197.83 32063.66,-10184.17 32722.79,-10197.83 32763,-10189.83 32808.31,-10180.81 32856.98,-10159.9 32890.21,-10143.72"/>
<polygon fill="red" stroke="red" points="32892.17,-10146.66 32899.58,-10139.08 32889.06,-10140.38 32892.17,-10146.66"/>
<text text-anchor="middle" x="32056.5" y="-10201.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu2 -->
<g id="node211" class="node">
<title>l1_attn_stage12_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="29952" cy="-10121.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29952" y="-10132.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="29952" y="-10117.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="29952" y="-10102.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu2&#45;&gt;l1_attn_stage12_gpu2 -->
<g id="edge195" class="edge">
<title>l1_attn_stage11_gpu2&#45;&gt;l1_attn_stage12_gpu2</title>
<path fill="none" stroke="black" d="M29952,-10230.74C29952,-10212.02 29952,-10189.03 29952,-10169.05"/>
<polygon fill="black" stroke="black" points="29955.5,-10168.91 29952,-10158.91 29948.5,-10168.91 29955.5,-10168.91"/>
</g>
<!-- l1_attn_stage11_gpu2&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge2371" class="edge">
<title>l1_attn_stage11_gpu2&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30008.97,-10238.14C30023.89,-10231.85 30040.23,-10226.1 30056,-10222.83 30111.38,-10211.34 32038.62,-10231.51 32092,-10212.83 32102.16,-10209.28 32100.86,-10201.42 32111,-10197.83 32145.15,-10185.74 32727.48,-10196.93 32763,-10189.83 32808.31,-10180.78 32856.97,-10159.87 32890.2,-10143.7"/>
<polygon fill="red" stroke="red" points="32892.16,-10146.64 32899.57,-10139.07 32889.06,-10140.36 32892.16,-10146.64"/>
<text text-anchor="middle" x="32142.5" y="-10201.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu3 -->
<g id="node212" class="node">
<title>l1_attn_stage12_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="30160" cy="-10121.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30160" y="-10132.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="30160" y="-10117.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="30160" y="-10102.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu3&#45;&gt;l1_attn_stage12_gpu3 -->
<g id="edge196" class="edge">
<title>l1_attn_stage11_gpu3&#45;&gt;l1_attn_stage12_gpu3</title>
<path fill="none" stroke="black" d="M30160,-10230.74C30160,-10212.02 30160,-10189.03 30160,-10169.05"/>
<polygon fill="black" stroke="black" points="30163.5,-10168.91 30160,-10158.91 30156.5,-10168.91 30163.5,-10168.91"/>
</g>
<!-- l1_attn_stage11_gpu3&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge2372" class="edge">
<title>l1_attn_stage11_gpu3&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30216.97,-10238.14C30231.9,-10231.85 30248.23,-10226.11 30264,-10222.83 30316.06,-10212.02 32127.82,-10230.4 32178,-10212.83 32188.15,-10209.28 32186.86,-10201.43 32197,-10197.83 32226.63,-10187.31 32732.17,-10196.02 32763,-10189.83 32808.3,-10180.74 32856.97,-10159.83 32890.2,-10143.68"/>
<polygon fill="red" stroke="red" points="32892.15,-10146.62 32899.57,-10139.05 32889.05,-10140.34 32892.15,-10146.62"/>
<text text-anchor="middle" x="32228.5" y="-10201.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu4 -->
<g id="node213" class="node">
<title>l1_attn_stage12_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="30368" cy="-10121.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30368" y="-10132.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="30368" y="-10117.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="30368" y="-10102.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu4&#45;&gt;l1_attn_stage12_gpu4 -->
<g id="edge197" class="edge">
<title>l1_attn_stage11_gpu4&#45;&gt;l1_attn_stage12_gpu4</title>
<path fill="none" stroke="black" d="M30368,-10230.74C30368,-10212.02 30368,-10189.03 30368,-10169.05"/>
<polygon fill="black" stroke="black" points="30371.5,-10168.91 30368,-10158.91 30364.5,-10168.91 30371.5,-10168.91"/>
</g>
<!-- l1_attn_stage11_gpu4&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge2373" class="edge">
<title>l1_attn_stage11_gpu4&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30424.97,-10238.15C30439.9,-10231.85 30456.23,-10226.11 30472,-10222.83 30520.74,-10212.7 32217.02,-10229.29 32264,-10212.83 32274.15,-10209.27 32272.87,-10201.44 32283,-10197.83 32333.24,-10179.92 32710.72,-10200.4 32763,-10189.83 32808.29,-10180.68 32856.96,-10159.79 32890.19,-10143.65"/>
<polygon fill="red" stroke="red" points="32892.14,-10146.59 32899.56,-10139.03 32889.05,-10140.31 32892.14,-10146.59"/>
<text text-anchor="middle" x="32314.5" y="-10201.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu5 -->
<g id="node214" class="node">
<title>l1_attn_stage12_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="30576" cy="-10121.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30576" y="-10132.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="30576" y="-10117.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="30576" y="-10102.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu5&#45;&gt;l1_attn_stage12_gpu5 -->
<g id="edge198" class="edge">
<title>l1_attn_stage11_gpu5&#45;&gt;l1_attn_stage12_gpu5</title>
<path fill="none" stroke="black" d="M30576,-10230.74C30576,-10212.02 30576,-10189.03 30576,-10169.05"/>
<polygon fill="black" stroke="black" points="30579.5,-10168.91 30576,-10158.91 30572.5,-10168.91 30579.5,-10168.91"/>
</g>
<!-- l1_attn_stage11_gpu5&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge2374" class="edge">
<title>l1_attn_stage11_gpu5&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30632.97,-10238.15C30647.9,-10231.86 30664.23,-10226.11 30680,-10222.83 30725.42,-10213.38 32306.22,-10228.18 32350,-10212.83 32360.15,-10209.27 32358.87,-10201.46 32369,-10197.83 32410.22,-10183.05 32720.1,-10198.58 32763,-10189.83 32808.27,-10180.6 32856.94,-10159.72 32890.18,-10143.6"/>
<polygon fill="red" stroke="red" points="32892.13,-10146.55 32899.56,-10138.99 32889.04,-10140.27 32892.13,-10146.55"/>
<text text-anchor="middle" x="32400.5" y="-10201.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu6 -->
<g id="node215" class="node">
<title>l1_attn_stage12_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="30784" cy="-10121.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30784" y="-10132.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="30784" y="-10117.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="30784" y="-10102.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu6&#45;&gt;l1_attn_stage12_gpu6 -->
<g id="edge199" class="edge">
<title>l1_attn_stage11_gpu6&#45;&gt;l1_attn_stage12_gpu6</title>
<path fill="none" stroke="black" d="M30784,-10230.74C30784,-10212.02 30784,-10189.03 30784,-10169.05"/>
<polygon fill="black" stroke="black" points="30787.5,-10168.91 30784,-10158.91 30780.5,-10168.91 30787.5,-10168.91"/>
</g>
<!-- l1_attn_stage11_gpu6&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge2375" class="edge">
<title>l1_attn_stage11_gpu6&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30840.97,-10238.16C30855.9,-10231.86 30872.23,-10226.12 30888,-10222.83 30930.1,-10214.06 32395.42,-10227.07 32436,-10212.83 32446.15,-10209.27 32444.88,-10201.49 32455,-10197.83 32487.19,-10186.19 32729.48,-10196.77 32763,-10189.83 32808.11,-10180.5 32856.62,-10159.74 32889.86,-10143.68"/>
<polygon fill="red" stroke="red" points="32891.8,-10146.63 32899.24,-10139.08 32888.72,-10140.34 32891.8,-10146.63"/>
<text text-anchor="middle" x="32486.5" y="-10201.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu7 -->
<g id="node216" class="node">
<title>l1_attn_stage12_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="30992" cy="-10121.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30992" y="-10132.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="30992" y="-10117.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="30992" y="-10102.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu7&#45;&gt;l1_attn_stage12_gpu7 -->
<g id="edge200" class="edge">
<title>l1_attn_stage11_gpu7&#45;&gt;l1_attn_stage12_gpu7</title>
<path fill="none" stroke="black" d="M30992,-10230.74C30992,-10212.02 30992,-10189.03 30992,-10169.05"/>
<polygon fill="black" stroke="black" points="30995.5,-10168.91 30992,-10158.91 30988.5,-10168.91 30995.5,-10168.91"/>
</g>
<!-- l1_attn_stage11_gpu7&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge2376" class="edge">
<title>l1_attn_stage11_gpu7&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31048.98,-10238.16C31063.9,-10231.87 31080.24,-10226.12 31096,-10222.83 31134.78,-10214.74 32484.62,-10225.95 32522,-10212.83 32532.15,-10209.27 32530.9,-10201.54 32541,-10197.83 32587.34,-10180.8 32714.71,-10200.08 32763,-10189.83 32808.06,-10180.27 32856.58,-10159.54 32889.83,-10143.56"/>
<polygon fill="red" stroke="red" points="32891.76,-10146.51 32899.22,-10138.98 32888.69,-10140.22 32891.76,-10146.51"/>
<text text-anchor="middle" x="32572.5" y="-10201.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu8 -->
<g id="node217" class="node">
<title>l1_attn_stage12_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="31200" cy="-10121.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31200" y="-10132.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="31200" y="-10117.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="31200" y="-10102.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu8&#45;&gt;l1_attn_stage12_gpu8 -->
<g id="edge201" class="edge">
<title>l1_attn_stage11_gpu8&#45;&gt;l1_attn_stage12_gpu8</title>
<path fill="none" stroke="black" d="M31200,-10230.74C31200,-10212.02 31200,-10189.03 31200,-10169.05"/>
<polygon fill="black" stroke="black" points="31203.5,-10168.91 31200,-10158.91 31196.5,-10168.91 31203.5,-10168.91"/>
</g>
<!-- l1_attn_stage11_gpu8&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge2377" class="edge">
<title>l1_attn_stage11_gpu8&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31256.98,-10238.17C31271.9,-10231.88 31288.24,-10226.13 31304,-10222.83 31374.91,-10208.01 32539.65,-10236.85 32608,-10212.83 32618.15,-10209.26 32616.94,-10201.66 32627,-10197.83 32655.3,-10187.07 32733.46,-10196.45 32763,-10189.83 32807.67,-10179.82 32855.88,-10159.36 32889.15,-10143.57"/>
<polygon fill="red" stroke="red" points="32891.06,-10146.54 32898.55,-10139.05 32888.02,-10140.23 32891.06,-10146.54"/>
<text text-anchor="middle" x="32658.5" y="-10201.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu9 -->
<g id="node218" class="node">
<title>l1_attn_stage12_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="31408" cy="-10121.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31408" y="-10132.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="31408" y="-10117.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="31408" y="-10102.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu9&#45;&gt;l1_attn_stage12_gpu9 -->
<g id="edge202" class="edge">
<title>l1_attn_stage11_gpu9&#45;&gt;l1_attn_stage12_gpu9</title>
<path fill="none" stroke="black" d="M31408,-10230.74C31408,-10212.02 31408,-10189.03 31408,-10169.05"/>
<polygon fill="black" stroke="black" points="31411.5,-10168.91 31408,-10158.91 31404.5,-10168.91 31411.5,-10168.91"/>
</g>
<!-- l1_attn_stage11_gpu9&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge2378" class="edge">
<title>l1_attn_stage11_gpu9&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31464.98,-10238.18C31479.9,-10231.88 31496.24,-10226.13 31512,-10222.83 31576.28,-10209.37 32632.05,-10234.63 32694,-10212.83 32704.15,-10209.26 32703.15,-10202.15 32713,-10197.83 32733.61,-10188.79 32741.31,-10195.84 32763,-10189.83 32806.28,-10177.84 32853.59,-10158.2 32886.94,-10143.19"/>
<polygon fill="red" stroke="red" points="32888.74,-10146.22 32896.4,-10138.9 32885.84,-10139.85 32888.74,-10146.22"/>
<text text-anchor="middle" x="32744.5" y="-10201.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu10 -->
<g id="node219" class="node">
<title>l1_attn_stage12_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="31616" cy="-10121.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31616" y="-10132.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="31616" y="-10117.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="31616" y="-10102.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu10&#45;&gt;l1_attn_stage12_gpu10 -->
<g id="edge203" class="edge">
<title>l1_attn_stage11_gpu10&#45;&gt;l1_attn_stage12_gpu10</title>
<path fill="none" stroke="black" d="M31616,-10230.74C31616,-10212.02 31616,-10189.03 31616,-10169.05"/>
<polygon fill="black" stroke="black" points="31619.5,-10168.91 31616,-10158.91 31612.5,-10168.91 31619.5,-10168.91"/>
</g>
<!-- l1_attn_stage11_gpu10&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge2379" class="edge">
<title>l1_attn_stage11_gpu10&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31672.98,-10238.19C31687.91,-10231.89 31704.24,-10226.14 31720,-10222.83 31777.64,-10210.74 32724.46,-10232.41 32780,-10212.83 32790.15,-10209.26 32790.08,-10203.85 32799,-10197.83 32828.36,-10178.01 32863.2,-10158.22 32889.72,-10143.88"/>
<polygon fill="red" stroke="red" points="32891.57,-10146.86 32898.73,-10139.05 32888.26,-10140.69 32891.57,-10146.86"/>
<text text-anchor="middle" x="32830.5" y="-10201.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu11 -->
<g id="node220" class="node">
<title>l1_attn_stage12_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="31824" cy="-10121.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31824" y="-10132.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="31824" y="-10117.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="31824" y="-10102.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu11&#45;&gt;l1_attn_stage12_gpu11 -->
<g id="edge204" class="edge">
<title>l1_attn_stage11_gpu11&#45;&gt;l1_attn_stage12_gpu11</title>
<path fill="none" stroke="black" d="M31824,-10230.74C31824,-10212.02 31824,-10189.03 31824,-10169.05"/>
<polygon fill="black" stroke="black" points="31827.5,-10168.91 31824,-10158.91 31820.5,-10168.91 31827.5,-10168.91"/>
</g>
<!-- l1_attn_stage11_gpu11&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge2380" class="edge">
<title>l1_attn_stage11_gpu11&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31880.98,-10238.2C31895.91,-10231.91 31912.24,-10226.15 31928,-10222.83 31953.5,-10217.46 32842.88,-10224.85 32866,-10212.83 32879.7,-10205.71 32901.58,-10172.29 32916.12,-10148.13"/>
<polygon fill="red" stroke="red" points="32919.21,-10149.79 32921.3,-10139.4 32913.19,-10146.22 32919.21,-10149.79"/>
<text text-anchor="middle" x="32912.5" y="-10201.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu12 -->
<g id="node221" class="node">
<title>l1_attn_stage12_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="32032" cy="-10121.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32032" y="-10132.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="32032" y="-10117.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="32032" y="-10102.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu12&#45;&gt;l1_attn_stage12_gpu12 -->
<g id="edge205" class="edge">
<title>l1_attn_stage11_gpu12&#45;&gt;l1_attn_stage12_gpu12</title>
<path fill="none" stroke="black" d="M31969.19,-10240.01C31955.64,-10234.24 31941.37,-10228.26 31928,-10222.83 31916.53,-10218.17 31909.01,-10223.04 31902,-10212.83 31898.23,-10207.34 31898.04,-10203.19 31902,-10197.83 31909.18,-10188.11 31917.05,-10194.95 31928,-10189.83 31945.44,-10181.68 31963.39,-10170.99 31979.36,-10160.52"/>
<polygon fill="black" stroke="black" points="31981.64,-10163.21 31988.02,-10154.75 31977.76,-10157.39 31981.64,-10163.21"/>
</g>
<!-- l1_attn_stage11_gpu12&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge2381" class="edge">
<title>l1_attn_stage11_gpu12&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32088.99,-10238.22C32103.91,-10231.92 32120.24,-10226.16 32136,-10222.83 32158.18,-10218.14 32936.07,-10228.96 32952,-10212.83 32968.71,-10195.92 32959.21,-10168.47 32948.15,-10148.23"/>
<polygon fill="red" stroke="red" points="32951.11,-10146.37 32943.04,-10139.51 32945.07,-10149.9 32951.11,-10146.37"/>
<text text-anchor="middle" x="32990.5" y="-10201.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu13 -->
<g id="node222" class="node">
<title>l1_attn_stage12_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="32240" cy="-10121.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32240" y="-10132.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="32240" y="-10117.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="32240" y="-10102.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu13&#45;&gt;l1_attn_stage12_gpu13 -->
<g id="edge206" class="edge">
<title>l1_attn_stage11_gpu13&#45;&gt;l1_attn_stage12_gpu13</title>
<path fill="none" stroke="black" d="M32182.39,-10238.33C32167.62,-10232.12 32151.51,-10226.37 32136,-10222.83 32111.39,-10217.22 31926.45,-10231.07 31909,-10212.83 31904.39,-10208.02 31904.37,-10202.63 31909,-10197.83 31917.76,-10188.75 32123.97,-10193.63 32136,-10189.83 32155.58,-10183.66 32175,-10172.72 32191.67,-10161.41"/>
<polygon fill="black" stroke="black" points="32193.94,-10164.1 32200.13,-10155.49 32189.93,-10158.36 32193.94,-10164.1"/>
</g>
<!-- l1_attn_stage11_gpu13&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge2382" class="edge">
<title>l1_attn_stage11_gpu13&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32296.99,-10238.24C32311.92,-10231.95 32328.25,-10226.18 32344,-10222.83 32362.86,-10218.82 33024.47,-10226.56 33038,-10212.83 33063.62,-10186.84 33022.49,-10160.25 32984.04,-10142.67"/>
<polygon fill="red" stroke="red" points="32985.44,-10139.46 32974.88,-10138.62 32982.61,-10145.87 32985.44,-10139.46"/>
<text text-anchor="middle" x="33076.5" y="-10201.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu14 -->
<g id="node223" class="node">
<title>l1_attn_stage12_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="32448" cy="-10121.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32448" y="-10132.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="32448" y="-10117.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="32448" y="-10102.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu14&#45;&gt;l1_attn_stage12_gpu14 -->
<g id="edge207" class="edge">
<title>l1_attn_stage11_gpu14&#45;&gt;l1_attn_stage12_gpu14</title>
<path fill="none" stroke="black" d="M32390.71,-10238.23C32375.86,-10231.97 32359.64,-10226.23 32344,-10222.83 32320.76,-10217.78 31932.62,-10229.85 31916,-10212.83 31911.34,-10208.06 31911.33,-10202.59 31916,-10197.83 31924.33,-10189.35 32332.63,-10193.31 32344,-10189.83 32363.63,-10183.82 32383.07,-10172.92 32399.73,-10161.61"/>
<polygon fill="black" stroke="black" points="32402.01,-10164.29 32408.18,-10155.68 32397.99,-10158.56 32402.01,-10164.29"/>
</g>
<!-- l1_attn_stage11_gpu14&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge2383" class="edge">
<title>l1_attn_stage11_gpu14&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32505,-10238.28C32519.92,-10231.98 32536.25,-10226.2 32552,-10222.83 32567.54,-10219.51 33112.86,-10224.17 33124,-10212.83 33160.88,-10175.3 33097.24,-10151.54 33033.37,-10137.83"/>
<polygon fill="red" stroke="red" points="33034.05,-10134.4 33023.55,-10135.8 33032.63,-10141.25 33034.05,-10134.4"/>
<text text-anchor="middle" x="33163.5" y="-10201.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu15 -->
<g id="node224" class="node">
<title>l1_attn_stage12_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="32656" cy="-10121.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32656" y="-10132.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="32656" y="-10117.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="32656" y="-10102.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu15&#45;&gt;l1_attn_stage12_gpu15 -->
<g id="edge208" class="edge">
<title>l1_attn_stage11_gpu15&#45;&gt;l1_attn_stage12_gpu15</title>
<path fill="none" stroke="black" d="M32599,-10238.26C32584.08,-10231.96 32567.75,-10226.19 32552,-10222.83 32534.91,-10219.19 31935.26,-10225.29 31923,-10212.83 31918.32,-10208.08 31918.32,-10202.58 31923,-10197.83 31935.28,-10185.4 32535.28,-10194.9 32552,-10189.83 32571.65,-10183.88 32591.09,-10172.99 32607.75,-10161.67"/>
<polygon fill="black" stroke="black" points="32610.03,-10164.35 32616.2,-10155.74 32606.01,-10158.63 32610.03,-10164.35"/>
</g>
<!-- l1_attn_stage11_gpu15&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge2384" class="edge">
<title>l1_attn_stage11_gpu15&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32715.56,-10238.91C32731.88,-10232.39 32749.81,-10226.35 32767,-10222.83 32791.12,-10217.89 33192.79,-10230.43 33210,-10212.83 33259.67,-10162.03 33172.33,-10139.72 33082.57,-10129.94"/>
<polygon fill="red" stroke="red" points="33082.78,-10126.44 33072.47,-10128.89 33082.05,-10133.4 33082.78,-10126.44"/>
<text text-anchor="middle" x="33249.5" y="-10201.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu0 -->
<g id="node225" class="node">
<title>l1_attn_stage13_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="29536" cy="-9974.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29536" y="-9985.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="29536" y="-9970.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="29536" y="-9955.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu0&#45;&gt;l1_attn_stage13_gpu0 -->
<g id="edge209" class="edge">
<title>l1_attn_stage12_gpu0&#45;&gt;l1_attn_stage13_gpu0</title>
<path fill="none" stroke="black" d="M29536,-10083.74C29536,-10065.02 29536,-10042.03 29536,-10022.05"/>
<polygon fill="black" stroke="black" points="29539.5,-10021.91 29536,-10011.91 29532.5,-10021.91 29539.5,-10021.91"/>
</g>
<!-- l1_attn_stage13_gpu[next_gpu] -->
<g id="node1357" class="node">
<title>l1_attn_stage13_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="32931" cy="-9974.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="32931" y="-9970.63" font-family="Times,serif" font-size="14.00">l1_attn_stage13_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage12_gpu0&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge2385" class="edge">
<title>l1_attn_stage12_gpu0&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29592.98,-10091.2C29607.91,-10084.91 29624.24,-10079.15 29640,-10075.83 29889.97,-10023.18 31683.55,-10053.46 31939,-10050.83 31984.78,-10050.36 32718.1,-10051.74 32763,-10042.83 32808.32,-10033.84 32856.98,-10012.92 32890.21,-9996.73"/>
<polygon fill="red" stroke="red" points="32892.17,-9999.67 32899.58,-9992.1 32889.06,-9993.4 32892.17,-9999.67"/>
<text text-anchor="middle" x="31970.5" y="-10054.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu1 -->
<g id="node226" class="node">
<title>l1_attn_stage13_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="29744" cy="-9974.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29744" y="-9985.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="29744" y="-9970.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="29744" y="-9955.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu1&#45;&gt;l1_attn_stage13_gpu1 -->
<g id="edge210" class="edge">
<title>l1_attn_stage12_gpu1&#45;&gt;l1_attn_stage13_gpu1</title>
<path fill="none" stroke="black" d="M29744,-10083.74C29744,-10065.02 29744,-10042.03 29744,-10022.05"/>
<polygon fill="black" stroke="black" points="29747.5,-10021.91 29744,-10011.91 29740.5,-10021.91 29747.5,-10021.91"/>
</g>
<!-- l1_attn_stage12_gpu1&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge2386" class="edge">
<title>l1_attn_stage12_gpu1&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29800.97,-10091.14C29815.89,-10084.84 29832.23,-10079.1 29848,-10075.83 29906.7,-10063.66 31949.42,-10085.62 32006,-10065.83 32016.16,-10062.28 32014.86,-10054.42 32025,-10050.83 32063.66,-10037.17 32722.79,-10050.83 32763,-10042.83 32808.31,-10033.81 32856.98,-10012.9 32890.21,-9996.72"/>
<polygon fill="red" stroke="red" points="32892.17,-9999.66 32899.58,-9992.08 32889.06,-9993.38 32892.17,-9999.66"/>
<text text-anchor="middle" x="32056.5" y="-10054.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu2 -->
<g id="node227" class="node">
<title>l1_attn_stage13_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="29952" cy="-9974.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29952" y="-9985.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="29952" y="-9970.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="29952" y="-9955.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu2&#45;&gt;l1_attn_stage13_gpu2 -->
<g id="edge211" class="edge">
<title>l1_attn_stage12_gpu2&#45;&gt;l1_attn_stage13_gpu2</title>
<path fill="none" stroke="black" d="M29952,-10083.74C29952,-10065.02 29952,-10042.03 29952,-10022.05"/>
<polygon fill="black" stroke="black" points="29955.5,-10021.91 29952,-10011.91 29948.5,-10021.91 29955.5,-10021.91"/>
</g>
<!-- l1_attn_stage12_gpu2&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge2387" class="edge">
<title>l1_attn_stage12_gpu2&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30008.97,-10091.14C30023.89,-10084.85 30040.23,-10079.1 30056,-10075.83 30111.38,-10064.34 32038.62,-10084.51 32092,-10065.83 32102.16,-10062.28 32100.86,-10054.42 32111,-10050.83 32145.15,-10038.74 32727.48,-10049.93 32763,-10042.83 32808.31,-10033.78 32856.97,-10012.87 32890.2,-9996.7"/>
<polygon fill="red" stroke="red" points="32892.16,-9999.64 32899.57,-9992.07 32889.06,-9993.36 32892.16,-9999.64"/>
<text text-anchor="middle" x="32142.5" y="-10054.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu3 -->
<g id="node228" class="node">
<title>l1_attn_stage13_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="30160" cy="-9974.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30160" y="-9985.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="30160" y="-9970.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="30160" y="-9955.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu3&#45;&gt;l1_attn_stage13_gpu3 -->
<g id="edge212" class="edge">
<title>l1_attn_stage12_gpu3&#45;&gt;l1_attn_stage13_gpu3</title>
<path fill="none" stroke="black" d="M30160,-10083.74C30160,-10065.02 30160,-10042.03 30160,-10022.05"/>
<polygon fill="black" stroke="black" points="30163.5,-10021.91 30160,-10011.91 30156.5,-10021.91 30163.5,-10021.91"/>
</g>
<!-- l1_attn_stage12_gpu3&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge2388" class="edge">
<title>l1_attn_stage12_gpu3&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30216.97,-10091.14C30231.9,-10084.85 30248.23,-10079.11 30264,-10075.83 30316.06,-10065.02 32127.82,-10083.4 32178,-10065.83 32188.15,-10062.28 32186.86,-10054.43 32197,-10050.83 32226.63,-10040.31 32732.17,-10049.02 32763,-10042.83 32808.3,-10033.74 32856.97,-10012.83 32890.2,-9996.68"/>
<polygon fill="red" stroke="red" points="32892.15,-9999.62 32899.57,-9992.05 32889.05,-9993.34 32892.15,-9999.62"/>
<text text-anchor="middle" x="32228.5" y="-10054.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu4 -->
<g id="node229" class="node">
<title>l1_attn_stage13_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="30368" cy="-9974.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30368" y="-9985.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="30368" y="-9970.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="30368" y="-9955.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu4&#45;&gt;l1_attn_stage13_gpu4 -->
<g id="edge213" class="edge">
<title>l1_attn_stage12_gpu4&#45;&gt;l1_attn_stage13_gpu4</title>
<path fill="none" stroke="black" d="M30368,-10083.74C30368,-10065.02 30368,-10042.03 30368,-10022.05"/>
<polygon fill="black" stroke="black" points="30371.5,-10021.91 30368,-10011.91 30364.5,-10021.91 30371.5,-10021.91"/>
</g>
<!-- l1_attn_stage12_gpu4&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge2389" class="edge">
<title>l1_attn_stage12_gpu4&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30424.97,-10091.15C30439.9,-10084.85 30456.23,-10079.11 30472,-10075.83 30520.74,-10065.7 32217.02,-10082.29 32264,-10065.83 32274.15,-10062.27 32272.87,-10054.44 32283,-10050.83 32333.24,-10032.92 32710.72,-10053.4 32763,-10042.83 32808.29,-10033.68 32856.96,-10012.79 32890.19,-9996.65"/>
<polygon fill="red" stroke="red" points="32892.14,-9999.59 32899.56,-9992.03 32889.05,-9993.31 32892.14,-9999.59"/>
<text text-anchor="middle" x="32314.5" y="-10054.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu5 -->
<g id="node230" class="node">
<title>l1_attn_stage13_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="30576" cy="-9974.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30576" y="-9985.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="30576" y="-9970.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="30576" y="-9955.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu5&#45;&gt;l1_attn_stage13_gpu5 -->
<g id="edge214" class="edge">
<title>l1_attn_stage12_gpu5&#45;&gt;l1_attn_stage13_gpu5</title>
<path fill="none" stroke="black" d="M30576,-10083.74C30576,-10065.02 30576,-10042.03 30576,-10022.05"/>
<polygon fill="black" stroke="black" points="30579.5,-10021.91 30576,-10011.91 30572.5,-10021.91 30579.5,-10021.91"/>
</g>
<!-- l1_attn_stage12_gpu5&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge2390" class="edge">
<title>l1_attn_stage12_gpu5&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30632.97,-10091.15C30647.9,-10084.86 30664.23,-10079.11 30680,-10075.83 30725.42,-10066.38 32306.22,-10081.18 32350,-10065.83 32360.15,-10062.27 32358.87,-10054.46 32369,-10050.83 32410.22,-10036.05 32720.1,-10051.58 32763,-10042.83 32808.27,-10033.6 32856.94,-10012.72 32890.18,-9996.6"/>
<polygon fill="red" stroke="red" points="32892.13,-9999.55 32899.56,-9991.99 32889.04,-9993.27 32892.13,-9999.55"/>
<text text-anchor="middle" x="32400.5" y="-10054.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu6 -->
<g id="node231" class="node">
<title>l1_attn_stage13_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="30784" cy="-9974.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30784" y="-9985.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="30784" y="-9970.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="30784" y="-9955.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu6&#45;&gt;l1_attn_stage13_gpu6 -->
<g id="edge215" class="edge">
<title>l1_attn_stage12_gpu6&#45;&gt;l1_attn_stage13_gpu6</title>
<path fill="none" stroke="black" d="M30784,-10083.74C30784,-10065.02 30784,-10042.03 30784,-10022.05"/>
<polygon fill="black" stroke="black" points="30787.5,-10021.91 30784,-10011.91 30780.5,-10021.91 30787.5,-10021.91"/>
</g>
<!-- l1_attn_stage12_gpu6&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge2391" class="edge">
<title>l1_attn_stage12_gpu6&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30840.97,-10091.16C30855.9,-10084.86 30872.23,-10079.12 30888,-10075.83 30930.1,-10067.06 32395.42,-10080.07 32436,-10065.83 32446.15,-10062.27 32444.88,-10054.49 32455,-10050.83 32487.19,-10039.19 32729.48,-10049.77 32763,-10042.83 32808.11,-10033.5 32856.62,-10012.74 32889.86,-9996.68"/>
<polygon fill="red" stroke="red" points="32891.8,-9999.63 32899.24,-9992.08 32888.72,-9993.34 32891.8,-9999.63"/>
<text text-anchor="middle" x="32486.5" y="-10054.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu7 -->
<g id="node232" class="node">
<title>l1_attn_stage13_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="30992" cy="-9974.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30992" y="-9985.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="30992" y="-9970.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="30992" y="-9955.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu7&#45;&gt;l1_attn_stage13_gpu7 -->
<g id="edge216" class="edge">
<title>l1_attn_stage12_gpu7&#45;&gt;l1_attn_stage13_gpu7</title>
<path fill="none" stroke="black" d="M30992,-10083.74C30992,-10065.02 30992,-10042.03 30992,-10022.05"/>
<polygon fill="black" stroke="black" points="30995.5,-10021.91 30992,-10011.91 30988.5,-10021.91 30995.5,-10021.91"/>
</g>
<!-- l1_attn_stage12_gpu7&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge2392" class="edge">
<title>l1_attn_stage12_gpu7&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31048.98,-10091.16C31063.9,-10084.87 31080.24,-10079.12 31096,-10075.83 31134.78,-10067.74 32484.62,-10078.95 32522,-10065.83 32532.15,-10062.27 32530.9,-10054.54 32541,-10050.83 32587.34,-10033.8 32714.71,-10053.08 32763,-10042.83 32808.06,-10033.27 32856.58,-10012.54 32889.83,-9996.56"/>
<polygon fill="red" stroke="red" points="32891.76,-9999.51 32899.22,-9991.98 32888.69,-9993.22 32891.76,-9999.51"/>
<text text-anchor="middle" x="32572.5" y="-10054.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu8 -->
<g id="node233" class="node">
<title>l1_attn_stage13_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="31200" cy="-9974.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31200" y="-9985.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="31200" y="-9970.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="31200" y="-9955.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu8&#45;&gt;l1_attn_stage13_gpu8 -->
<g id="edge217" class="edge">
<title>l1_attn_stage12_gpu8&#45;&gt;l1_attn_stage13_gpu8</title>
<path fill="none" stroke="black" d="M31200,-10083.74C31200,-10065.02 31200,-10042.03 31200,-10022.05"/>
<polygon fill="black" stroke="black" points="31203.5,-10021.91 31200,-10011.91 31196.5,-10021.91 31203.5,-10021.91"/>
</g>
<!-- l1_attn_stage12_gpu8&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge2393" class="edge">
<title>l1_attn_stage12_gpu8&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31256.98,-10091.17C31271.9,-10084.88 31288.24,-10079.13 31304,-10075.83 31374.91,-10061.01 32539.65,-10089.85 32608,-10065.83 32618.15,-10062.26 32616.94,-10054.66 32627,-10050.83 32655.3,-10040.07 32733.46,-10049.45 32763,-10042.83 32807.67,-10032.82 32855.88,-10012.36 32889.15,-9996.57"/>
<polygon fill="red" stroke="red" points="32891.06,-9999.54 32898.55,-9992.05 32888.02,-9993.23 32891.06,-9999.54"/>
<text text-anchor="middle" x="32658.5" y="-10054.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu9 -->
<g id="node234" class="node">
<title>l1_attn_stage13_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="31408" cy="-9974.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31408" y="-9985.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="31408" y="-9970.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="31408" y="-9955.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu9&#45;&gt;l1_attn_stage13_gpu9 -->
<g id="edge218" class="edge">
<title>l1_attn_stage12_gpu9&#45;&gt;l1_attn_stage13_gpu9</title>
<path fill="none" stroke="black" d="M31408,-10083.74C31408,-10065.02 31408,-10042.03 31408,-10022.05"/>
<polygon fill="black" stroke="black" points="31411.5,-10021.91 31408,-10011.91 31404.5,-10021.91 31411.5,-10021.91"/>
</g>
<!-- l1_attn_stage12_gpu9&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge2394" class="edge">
<title>l1_attn_stage12_gpu9&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31464.98,-10091.18C31479.9,-10084.88 31496.24,-10079.13 31512,-10075.83 31576.28,-10062.37 32632.05,-10087.63 32694,-10065.83 32704.15,-10062.26 32703.15,-10055.15 32713,-10050.83 32733.61,-10041.79 32741.31,-10048.84 32763,-10042.83 32806.28,-10030.84 32853.59,-10011.2 32886.94,-9996.19"/>
<polygon fill="red" stroke="red" points="32888.74,-9999.22 32896.4,-9991.9 32885.84,-9992.85 32888.74,-9999.22"/>
<text text-anchor="middle" x="32744.5" y="-10054.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu10 -->
<g id="node235" class="node">
<title>l1_attn_stage13_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="31616" cy="-9974.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31616" y="-9985.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="31616" y="-9970.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="31616" y="-9955.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu10&#45;&gt;l1_attn_stage13_gpu10 -->
<g id="edge219" class="edge">
<title>l1_attn_stage12_gpu10&#45;&gt;l1_attn_stage13_gpu10</title>
<path fill="none" stroke="black" d="M31616,-10083.74C31616,-10065.02 31616,-10042.03 31616,-10022.05"/>
<polygon fill="black" stroke="black" points="31619.5,-10021.91 31616,-10011.91 31612.5,-10021.91 31619.5,-10021.91"/>
</g>
<!-- l1_attn_stage12_gpu10&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge2395" class="edge">
<title>l1_attn_stage12_gpu10&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31672.98,-10091.19C31687.91,-10084.89 31704.24,-10079.14 31720,-10075.83 31777.64,-10063.74 32724.46,-10085.41 32780,-10065.83 32790.15,-10062.26 32790.08,-10056.85 32799,-10050.83 32828.36,-10031.01 32863.2,-10011.22 32889.72,-9996.88"/>
<polygon fill="red" stroke="red" points="32891.57,-9999.86 32898.73,-9992.05 32888.26,-9993.69 32891.57,-9999.86"/>
<text text-anchor="middle" x="32830.5" y="-10054.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu11 -->
<g id="node236" class="node">
<title>l1_attn_stage13_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="31824" cy="-9974.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31824" y="-9985.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="31824" y="-9970.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="31824" y="-9955.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu11&#45;&gt;l1_attn_stage13_gpu11 -->
<g id="edge220" class="edge">
<title>l1_attn_stage12_gpu11&#45;&gt;l1_attn_stage13_gpu11</title>
<path fill="none" stroke="black" d="M31824,-10083.74C31824,-10065.02 31824,-10042.03 31824,-10022.05"/>
<polygon fill="black" stroke="black" points="31827.5,-10021.91 31824,-10011.91 31820.5,-10021.91 31827.5,-10021.91"/>
</g>
<!-- l1_attn_stage12_gpu11&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge2396" class="edge">
<title>l1_attn_stage12_gpu11&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31880.98,-10091.2C31895.91,-10084.91 31912.24,-10079.15 31928,-10075.83 31953.5,-10070.46 32842.88,-10077.85 32866,-10065.83 32879.7,-10058.71 32901.58,-10025.29 32916.12,-10001.13"/>
<polygon fill="red" stroke="red" points="32919.21,-10002.79 32921.3,-9992.4 32913.19,-9999.22 32919.21,-10002.79"/>
<text text-anchor="middle" x="32912.5" y="-10054.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu12 -->
<g id="node237" class="node">
<title>l1_attn_stage13_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="32032" cy="-9974.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32032" y="-9985.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="32032" y="-9970.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="32032" y="-9955.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu12&#45;&gt;l1_attn_stage13_gpu12 -->
<g id="edge221" class="edge">
<title>l1_attn_stage12_gpu12&#45;&gt;l1_attn_stage13_gpu12</title>
<path fill="none" stroke="black" d="M31969.19,-10093.01C31955.64,-10087.24 31941.37,-10081.26 31928,-10075.83 31916.53,-10071.17 31909.01,-10076.04 31902,-10065.83 31898.23,-10060.34 31898.04,-10056.19 31902,-10050.83 31909.18,-10041.11 31917.05,-10047.95 31928,-10042.83 31945.44,-10034.68 31963.39,-10023.99 31979.36,-10013.52"/>
<polygon fill="black" stroke="black" points="31981.64,-10016.21 31988.02,-10007.75 31977.76,-10010.39 31981.64,-10016.21"/>
</g>
<!-- l1_attn_stage12_gpu12&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge2397" class="edge">
<title>l1_attn_stage12_gpu12&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32088.99,-10091.22C32103.91,-10084.92 32120.24,-10079.16 32136,-10075.83 32158.18,-10071.14 32936.07,-10081.96 32952,-10065.83 32968.71,-10048.92 32959.21,-10021.47 32948.15,-10001.23"/>
<polygon fill="red" stroke="red" points="32951.11,-9999.37 32943.04,-9992.51 32945.07,-10002.9 32951.11,-9999.37"/>
<text text-anchor="middle" x="32990.5" y="-10054.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu13 -->
<g id="node238" class="node">
<title>l1_attn_stage13_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="32240" cy="-9974.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32240" y="-9985.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="32240" y="-9970.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="32240" y="-9955.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu13&#45;&gt;l1_attn_stage13_gpu13 -->
<g id="edge222" class="edge">
<title>l1_attn_stage12_gpu13&#45;&gt;l1_attn_stage13_gpu13</title>
<path fill="none" stroke="black" d="M32182.39,-10091.33C32167.62,-10085.12 32151.51,-10079.37 32136,-10075.83 32111.39,-10070.22 31926.45,-10084.07 31909,-10065.83 31904.39,-10061.02 31904.37,-10055.63 31909,-10050.83 31917.76,-10041.75 32123.97,-10046.63 32136,-10042.83 32155.58,-10036.66 32175,-10025.72 32191.67,-10014.41"/>
<polygon fill="black" stroke="black" points="32193.94,-10017.1 32200.13,-10008.49 32189.93,-10011.36 32193.94,-10017.1"/>
</g>
<!-- l1_attn_stage12_gpu13&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge2398" class="edge">
<title>l1_attn_stage12_gpu13&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32296.99,-10091.24C32311.92,-10084.95 32328.25,-10079.18 32344,-10075.83 32362.86,-10071.82 33024.47,-10079.56 33038,-10065.83 33063.62,-10039.84 33022.49,-10013.25 32984.04,-9995.67"/>
<polygon fill="red" stroke="red" points="32985.44,-9992.46 32974.88,-9991.62 32982.61,-9998.87 32985.44,-9992.46"/>
<text text-anchor="middle" x="33076.5" y="-10054.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu14 -->
<g id="node239" class="node">
<title>l1_attn_stage13_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="32448" cy="-9974.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32448" y="-9985.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="32448" y="-9970.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="32448" y="-9955.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu14&#45;&gt;l1_attn_stage13_gpu14 -->
<g id="edge223" class="edge">
<title>l1_attn_stage12_gpu14&#45;&gt;l1_attn_stage13_gpu14</title>
<path fill="none" stroke="black" d="M32390.71,-10091.23C32375.86,-10084.97 32359.64,-10079.23 32344,-10075.83 32320.76,-10070.78 31932.62,-10082.85 31916,-10065.83 31911.34,-10061.06 31911.33,-10055.59 31916,-10050.83 31924.33,-10042.35 32332.63,-10046.31 32344,-10042.83 32363.63,-10036.82 32383.07,-10025.92 32399.73,-10014.61"/>
<polygon fill="black" stroke="black" points="32402.01,-10017.29 32408.18,-10008.68 32397.99,-10011.56 32402.01,-10017.29"/>
</g>
<!-- l1_attn_stage12_gpu14&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge2399" class="edge">
<title>l1_attn_stage12_gpu14&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32505,-10091.28C32519.92,-10084.98 32536.25,-10079.2 32552,-10075.83 32567.54,-10072.51 33112.86,-10077.17 33124,-10065.83 33160.88,-10028.3 33097.24,-10004.54 33033.37,-9990.83"/>
<polygon fill="red" stroke="red" points="33034.05,-9987.4 33023.55,-9988.8 33032.63,-9994.25 33034.05,-9987.4"/>
<text text-anchor="middle" x="33163.5" y="-10054.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu15 -->
<g id="node240" class="node">
<title>l1_attn_stage13_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="32656" cy="-9974.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32656" y="-9985.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="32656" y="-9970.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="32656" y="-9955.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu15&#45;&gt;l1_attn_stage13_gpu15 -->
<g id="edge224" class="edge">
<title>l1_attn_stage12_gpu15&#45;&gt;l1_attn_stage13_gpu15</title>
<path fill="none" stroke="black" d="M32599,-10091.26C32584.08,-10084.96 32567.75,-10079.19 32552,-10075.83 32534.91,-10072.19 31935.26,-10078.29 31923,-10065.83 31918.32,-10061.08 31918.32,-10055.58 31923,-10050.83 31935.28,-10038.4 32535.28,-10047.9 32552,-10042.83 32571.65,-10036.88 32591.09,-10025.99 32607.75,-10014.67"/>
<polygon fill="black" stroke="black" points="32610.03,-10017.35 32616.2,-10008.74 32606.01,-10011.63 32610.03,-10017.35"/>
</g>
<!-- l1_attn_stage12_gpu15&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge2400" class="edge">
<title>l1_attn_stage12_gpu15&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32715.56,-10091.91C32731.88,-10085.39 32749.81,-10079.35 32767,-10075.83 32791.12,-10070.89 33192.79,-10083.43 33210,-10065.83 33259.67,-10015.03 33172.33,-9992.72 33082.57,-9982.94"/>
<polygon fill="red" stroke="red" points="33082.78,-9979.44 33072.47,-9981.89 33082.05,-9986.4 33082.78,-9979.44"/>
<text text-anchor="middle" x="33249.5" y="-10054.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu0 -->
<g id="node241" class="node">
<title>l1_attn_stage14_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="29536" cy="-9827.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29536" y="-9838.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="29536" y="-9823.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="29536" y="-9808.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu0&#45;&gt;l1_attn_stage14_gpu0 -->
<g id="edge225" class="edge">
<title>l1_attn_stage13_gpu0&#45;&gt;l1_attn_stage14_gpu0</title>
<path fill="none" stroke="black" d="M29536,-9936.74C29536,-9918.02 29536,-9895.03 29536,-9875.05"/>
<polygon fill="black" stroke="black" points="29539.5,-9874.91 29536,-9864.91 29532.5,-9874.91 29539.5,-9874.91"/>
</g>
<!-- l1_attn_stage14_gpu[next_gpu] -->
<g id="node1358" class="node">
<title>l1_attn_stage14_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="32931" cy="-9827.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="32931" y="-9823.63" font-family="Times,serif" font-size="14.00">l1_attn_stage14_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage13_gpu0&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge2401" class="edge">
<title>l1_attn_stage13_gpu0&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29592.98,-9944.2C29607.91,-9937.91 29624.24,-9932.15 29640,-9928.83 29889.97,-9876.18 31683.55,-9906.46 31939,-9903.83 31984.78,-9903.36 32718.1,-9904.74 32763,-9895.83 32808.32,-9886.84 32856.98,-9865.92 32890.21,-9849.73"/>
<polygon fill="red" stroke="red" points="32892.17,-9852.67 32899.58,-9845.1 32889.06,-9846.4 32892.17,-9852.67"/>
<text text-anchor="middle" x="31970.5" y="-9907.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu1 -->
<g id="node242" class="node">
<title>l1_attn_stage14_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="29744" cy="-9827.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29744" y="-9838.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="29744" y="-9823.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="29744" y="-9808.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu1&#45;&gt;l1_attn_stage14_gpu1 -->
<g id="edge226" class="edge">
<title>l1_attn_stage13_gpu1&#45;&gt;l1_attn_stage14_gpu1</title>
<path fill="none" stroke="black" d="M29744,-9936.74C29744,-9918.02 29744,-9895.03 29744,-9875.05"/>
<polygon fill="black" stroke="black" points="29747.5,-9874.91 29744,-9864.91 29740.5,-9874.91 29747.5,-9874.91"/>
</g>
<!-- l1_attn_stage13_gpu1&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge2402" class="edge">
<title>l1_attn_stage13_gpu1&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29800.97,-9944.14C29815.89,-9937.84 29832.23,-9932.1 29848,-9928.83 29906.7,-9916.66 31949.42,-9938.62 32006,-9918.83 32016.16,-9915.28 32014.86,-9907.42 32025,-9903.83 32063.66,-9890.17 32722.79,-9903.83 32763,-9895.83 32808.31,-9886.81 32856.98,-9865.9 32890.21,-9849.72"/>
<polygon fill="red" stroke="red" points="32892.17,-9852.66 32899.58,-9845.08 32889.06,-9846.38 32892.17,-9852.66"/>
<text text-anchor="middle" x="32056.5" y="-9907.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu2 -->
<g id="node243" class="node">
<title>l1_attn_stage14_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="29952" cy="-9827.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29952" y="-9838.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="29952" y="-9823.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="29952" y="-9808.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu2&#45;&gt;l1_attn_stage14_gpu2 -->
<g id="edge227" class="edge">
<title>l1_attn_stage13_gpu2&#45;&gt;l1_attn_stage14_gpu2</title>
<path fill="none" stroke="black" d="M29952,-9936.74C29952,-9918.02 29952,-9895.03 29952,-9875.05"/>
<polygon fill="black" stroke="black" points="29955.5,-9874.91 29952,-9864.91 29948.5,-9874.91 29955.5,-9874.91"/>
</g>
<!-- l1_attn_stage13_gpu2&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge2403" class="edge">
<title>l1_attn_stage13_gpu2&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30008.97,-9944.14C30023.89,-9937.85 30040.23,-9932.1 30056,-9928.83 30111.38,-9917.34 32038.62,-9937.51 32092,-9918.83 32102.16,-9915.28 32100.86,-9907.42 32111,-9903.83 32145.15,-9891.74 32727.48,-9902.93 32763,-9895.83 32808.31,-9886.78 32856.97,-9865.87 32890.2,-9849.7"/>
<polygon fill="red" stroke="red" points="32892.16,-9852.64 32899.57,-9845.07 32889.06,-9846.36 32892.16,-9852.64"/>
<text text-anchor="middle" x="32142.5" y="-9907.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu3 -->
<g id="node244" class="node">
<title>l1_attn_stage14_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="30160" cy="-9827.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30160" y="-9838.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="30160" y="-9823.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="30160" y="-9808.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu3&#45;&gt;l1_attn_stage14_gpu3 -->
<g id="edge228" class="edge">
<title>l1_attn_stage13_gpu3&#45;&gt;l1_attn_stage14_gpu3</title>
<path fill="none" stroke="black" d="M30160,-9936.74C30160,-9918.02 30160,-9895.03 30160,-9875.05"/>
<polygon fill="black" stroke="black" points="30163.5,-9874.91 30160,-9864.91 30156.5,-9874.91 30163.5,-9874.91"/>
</g>
<!-- l1_attn_stage13_gpu3&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge2404" class="edge">
<title>l1_attn_stage13_gpu3&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30216.97,-9944.14C30231.9,-9937.85 30248.23,-9932.11 30264,-9928.83 30316.06,-9918.02 32127.82,-9936.4 32178,-9918.83 32188.15,-9915.28 32186.86,-9907.43 32197,-9903.83 32226.63,-9893.31 32732.17,-9902.02 32763,-9895.83 32808.3,-9886.74 32856.97,-9865.83 32890.2,-9849.68"/>
<polygon fill="red" stroke="red" points="32892.15,-9852.62 32899.57,-9845.05 32889.05,-9846.34 32892.15,-9852.62"/>
<text text-anchor="middle" x="32228.5" y="-9907.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu4 -->
<g id="node245" class="node">
<title>l1_attn_stage14_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="30368" cy="-9827.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30368" y="-9838.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="30368" y="-9823.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="30368" y="-9808.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu4&#45;&gt;l1_attn_stage14_gpu4 -->
<g id="edge229" class="edge">
<title>l1_attn_stage13_gpu4&#45;&gt;l1_attn_stage14_gpu4</title>
<path fill="none" stroke="black" d="M30368,-9936.74C30368,-9918.02 30368,-9895.03 30368,-9875.05"/>
<polygon fill="black" stroke="black" points="30371.5,-9874.91 30368,-9864.91 30364.5,-9874.91 30371.5,-9874.91"/>
</g>
<!-- l1_attn_stage13_gpu4&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge2405" class="edge">
<title>l1_attn_stage13_gpu4&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30424.97,-9944.15C30439.9,-9937.85 30456.23,-9932.11 30472,-9928.83 30520.74,-9918.7 32217.02,-9935.29 32264,-9918.83 32274.15,-9915.27 32272.87,-9907.44 32283,-9903.83 32333.24,-9885.92 32710.72,-9906.4 32763,-9895.83 32808.29,-9886.68 32856.96,-9865.79 32890.19,-9849.65"/>
<polygon fill="red" stroke="red" points="32892.14,-9852.59 32899.56,-9845.03 32889.05,-9846.31 32892.14,-9852.59"/>
<text text-anchor="middle" x="32314.5" y="-9907.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu5 -->
<g id="node246" class="node">
<title>l1_attn_stage14_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="30576" cy="-9827.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30576" y="-9838.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="30576" y="-9823.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="30576" y="-9808.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu5&#45;&gt;l1_attn_stage14_gpu5 -->
<g id="edge230" class="edge">
<title>l1_attn_stage13_gpu5&#45;&gt;l1_attn_stage14_gpu5</title>
<path fill="none" stroke="black" d="M30576,-9936.74C30576,-9918.02 30576,-9895.03 30576,-9875.05"/>
<polygon fill="black" stroke="black" points="30579.5,-9874.91 30576,-9864.91 30572.5,-9874.91 30579.5,-9874.91"/>
</g>
<!-- l1_attn_stage13_gpu5&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge2406" class="edge">
<title>l1_attn_stage13_gpu5&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30632.97,-9944.15C30647.9,-9937.86 30664.23,-9932.11 30680,-9928.83 30725.42,-9919.38 32306.22,-9934.18 32350,-9918.83 32360.15,-9915.27 32358.87,-9907.46 32369,-9903.83 32410.22,-9889.05 32720.1,-9904.58 32763,-9895.83 32808.27,-9886.6 32856.94,-9865.72 32890.18,-9849.6"/>
<polygon fill="red" stroke="red" points="32892.13,-9852.55 32899.56,-9844.99 32889.04,-9846.27 32892.13,-9852.55"/>
<text text-anchor="middle" x="32400.5" y="-9907.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu6 -->
<g id="node247" class="node">
<title>l1_attn_stage14_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="30784" cy="-9827.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30784" y="-9838.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="30784" y="-9823.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="30784" y="-9808.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu6&#45;&gt;l1_attn_stage14_gpu6 -->
<g id="edge231" class="edge">
<title>l1_attn_stage13_gpu6&#45;&gt;l1_attn_stage14_gpu6</title>
<path fill="none" stroke="black" d="M30784,-9936.74C30784,-9918.02 30784,-9895.03 30784,-9875.05"/>
<polygon fill="black" stroke="black" points="30787.5,-9874.91 30784,-9864.91 30780.5,-9874.91 30787.5,-9874.91"/>
</g>
<!-- l1_attn_stage13_gpu6&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge2407" class="edge">
<title>l1_attn_stage13_gpu6&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30840.97,-9944.16C30855.9,-9937.86 30872.23,-9932.12 30888,-9928.83 30930.1,-9920.06 32395.42,-9933.07 32436,-9918.83 32446.15,-9915.27 32444.88,-9907.49 32455,-9903.83 32487.19,-9892.19 32729.48,-9902.77 32763,-9895.83 32808.11,-9886.5 32856.62,-9865.74 32889.86,-9849.68"/>
<polygon fill="red" stroke="red" points="32891.8,-9852.63 32899.24,-9845.08 32888.72,-9846.34 32891.8,-9852.63"/>
<text text-anchor="middle" x="32486.5" y="-9907.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu7 -->
<g id="node248" class="node">
<title>l1_attn_stage14_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="30992" cy="-9827.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="30992" y="-9838.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="30992" y="-9823.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="30992" y="-9808.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu7&#45;&gt;l1_attn_stage14_gpu7 -->
<g id="edge232" class="edge">
<title>l1_attn_stage13_gpu7&#45;&gt;l1_attn_stage14_gpu7</title>
<path fill="none" stroke="black" d="M30992,-9936.74C30992,-9918.02 30992,-9895.03 30992,-9875.05"/>
<polygon fill="black" stroke="black" points="30995.5,-9874.91 30992,-9864.91 30988.5,-9874.91 30995.5,-9874.91"/>
</g>
<!-- l1_attn_stage13_gpu7&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge2408" class="edge">
<title>l1_attn_stage13_gpu7&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31048.98,-9944.16C31063.9,-9937.87 31080.24,-9932.12 31096,-9928.83 31134.78,-9920.74 32484.62,-9931.95 32522,-9918.83 32532.15,-9915.27 32530.9,-9907.54 32541,-9903.83 32587.34,-9886.8 32714.71,-9906.08 32763,-9895.83 32808.06,-9886.27 32856.58,-9865.54 32889.83,-9849.56"/>
<polygon fill="red" stroke="red" points="32891.76,-9852.51 32899.22,-9844.98 32888.69,-9846.22 32891.76,-9852.51"/>
<text text-anchor="middle" x="32572.5" y="-9907.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu8 -->
<g id="node249" class="node">
<title>l1_attn_stage14_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="31200" cy="-9827.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31200" y="-9838.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="31200" y="-9823.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="31200" y="-9808.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu8&#45;&gt;l1_attn_stage14_gpu8 -->
<g id="edge233" class="edge">
<title>l1_attn_stage13_gpu8&#45;&gt;l1_attn_stage14_gpu8</title>
<path fill="none" stroke="black" d="M31200,-9936.74C31200,-9918.02 31200,-9895.03 31200,-9875.05"/>
<polygon fill="black" stroke="black" points="31203.5,-9874.91 31200,-9864.91 31196.5,-9874.91 31203.5,-9874.91"/>
</g>
<!-- l1_attn_stage13_gpu8&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge2409" class="edge">
<title>l1_attn_stage13_gpu8&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31256.98,-9944.17C31271.9,-9937.88 31288.24,-9932.13 31304,-9928.83 31374.91,-9914.01 32539.65,-9942.85 32608,-9918.83 32618.15,-9915.26 32616.94,-9907.66 32627,-9903.83 32655.3,-9893.07 32733.46,-9902.45 32763,-9895.83 32807.67,-9885.82 32855.88,-9865.36 32889.15,-9849.57"/>
<polygon fill="red" stroke="red" points="32891.06,-9852.54 32898.55,-9845.05 32888.02,-9846.23 32891.06,-9852.54"/>
<text text-anchor="middle" x="32658.5" y="-9907.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu9 -->
<g id="node250" class="node">
<title>l1_attn_stage14_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="31408" cy="-9827.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31408" y="-9838.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="31408" y="-9823.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="31408" y="-9808.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu9&#45;&gt;l1_attn_stage14_gpu9 -->
<g id="edge234" class="edge">
<title>l1_attn_stage13_gpu9&#45;&gt;l1_attn_stage14_gpu9</title>
<path fill="none" stroke="black" d="M31408,-9936.74C31408,-9918.02 31408,-9895.03 31408,-9875.05"/>
<polygon fill="black" stroke="black" points="31411.5,-9874.91 31408,-9864.91 31404.5,-9874.91 31411.5,-9874.91"/>
</g>
<!-- l1_attn_stage13_gpu9&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge2410" class="edge">
<title>l1_attn_stage13_gpu9&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31464.98,-9944.18C31479.9,-9937.88 31496.24,-9932.13 31512,-9928.83 31576.28,-9915.37 32632.05,-9940.63 32694,-9918.83 32704.15,-9915.26 32703.15,-9908.15 32713,-9903.83 32733.61,-9894.79 32741.31,-9901.84 32763,-9895.83 32806.28,-9883.84 32853.59,-9864.2 32886.94,-9849.19"/>
<polygon fill="red" stroke="red" points="32888.74,-9852.22 32896.4,-9844.9 32885.84,-9845.85 32888.74,-9852.22"/>
<text text-anchor="middle" x="32744.5" y="-9907.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu10 -->
<g id="node251" class="node">
<title>l1_attn_stage14_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="31616" cy="-9827.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31616" y="-9838.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="31616" y="-9823.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="31616" y="-9808.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu10&#45;&gt;l1_attn_stage14_gpu10 -->
<g id="edge235" class="edge">
<title>l1_attn_stage13_gpu10&#45;&gt;l1_attn_stage14_gpu10</title>
<path fill="none" stroke="black" d="M31616,-9936.74C31616,-9918.02 31616,-9895.03 31616,-9875.05"/>
<polygon fill="black" stroke="black" points="31619.5,-9874.91 31616,-9864.91 31612.5,-9874.91 31619.5,-9874.91"/>
</g>
<!-- l1_attn_stage13_gpu10&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge2411" class="edge">
<title>l1_attn_stage13_gpu10&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31672.98,-9944.19C31687.91,-9937.89 31704.24,-9932.14 31720,-9928.83 31777.64,-9916.74 32724.46,-9938.41 32780,-9918.83 32790.15,-9915.26 32790.08,-9909.85 32799,-9903.83 32828.36,-9884.01 32863.2,-9864.22 32889.72,-9849.88"/>
<polygon fill="red" stroke="red" points="32891.57,-9852.86 32898.73,-9845.05 32888.26,-9846.69 32891.57,-9852.86"/>
<text text-anchor="middle" x="32830.5" y="-9907.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu11 -->
<g id="node252" class="node">
<title>l1_attn_stage14_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="31824" cy="-9827.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="31824" y="-9838.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="31824" y="-9823.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="31824" y="-9808.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu11&#45;&gt;l1_attn_stage14_gpu11 -->
<g id="edge236" class="edge">
<title>l1_attn_stage13_gpu11&#45;&gt;l1_attn_stage14_gpu11</title>
<path fill="none" stroke="black" d="M31824,-9936.74C31824,-9918.02 31824,-9895.03 31824,-9875.05"/>
<polygon fill="black" stroke="black" points="31827.5,-9874.91 31824,-9864.91 31820.5,-9874.91 31827.5,-9874.91"/>
</g>
<!-- l1_attn_stage13_gpu11&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge2412" class="edge">
<title>l1_attn_stage13_gpu11&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31880.98,-9944.2C31895.91,-9937.91 31912.24,-9932.15 31928,-9928.83 31953.5,-9923.46 32842.88,-9930.85 32866,-9918.83 32879.7,-9911.71 32901.58,-9878.29 32916.12,-9854.13"/>
<polygon fill="red" stroke="red" points="32919.21,-9855.79 32921.3,-9845.4 32913.19,-9852.22 32919.21,-9855.79"/>
<text text-anchor="middle" x="32912.5" y="-9907.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu12 -->
<g id="node253" class="node">
<title>l1_attn_stage14_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="32032" cy="-9827.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32032" y="-9838.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="32032" y="-9823.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="32032" y="-9808.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu12&#45;&gt;l1_attn_stage14_gpu12 -->
<g id="edge237" class="edge">
<title>l1_attn_stage13_gpu12&#45;&gt;l1_attn_stage14_gpu12</title>
<path fill="none" stroke="black" d="M31969.19,-9946.01C31955.64,-9940.24 31941.37,-9934.26 31928,-9928.83 31916.53,-9924.17 31909.01,-9929.04 31902,-9918.83 31898.23,-9913.34 31898.04,-9909.19 31902,-9903.83 31909.18,-9894.11 31917.05,-9900.95 31928,-9895.83 31945.44,-9887.68 31963.39,-9876.99 31979.36,-9866.52"/>
<polygon fill="black" stroke="black" points="31981.64,-9869.21 31988.02,-9860.75 31977.76,-9863.39 31981.64,-9869.21"/>
</g>
<!-- l1_attn_stage13_gpu12&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge2413" class="edge">
<title>l1_attn_stage13_gpu12&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32088.99,-9944.22C32103.91,-9937.92 32120.24,-9932.16 32136,-9928.83 32158.18,-9924.14 32936.07,-9934.96 32952,-9918.83 32968.71,-9901.92 32959.21,-9874.47 32948.15,-9854.23"/>
<polygon fill="red" stroke="red" points="32951.11,-9852.37 32943.04,-9845.51 32945.07,-9855.9 32951.11,-9852.37"/>
<text text-anchor="middle" x="32990.5" y="-9907.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu13 -->
<g id="node254" class="node">
<title>l1_attn_stage14_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="32240" cy="-9827.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32240" y="-9838.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="32240" y="-9823.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="32240" y="-9808.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu13&#45;&gt;l1_attn_stage14_gpu13 -->
<g id="edge238" class="edge">
<title>l1_attn_stage13_gpu13&#45;&gt;l1_attn_stage14_gpu13</title>
<path fill="none" stroke="black" d="M32182.39,-9944.33C32167.62,-9938.12 32151.51,-9932.37 32136,-9928.83 32111.39,-9923.22 31926.45,-9937.07 31909,-9918.83 31904.39,-9914.02 31904.37,-9908.63 31909,-9903.83 31917.76,-9894.75 32123.97,-9899.63 32136,-9895.83 32155.58,-9889.66 32175,-9878.72 32191.67,-9867.41"/>
<polygon fill="black" stroke="black" points="32193.94,-9870.1 32200.13,-9861.49 32189.93,-9864.36 32193.94,-9870.1"/>
</g>
<!-- l1_attn_stage13_gpu13&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge2414" class="edge">
<title>l1_attn_stage13_gpu13&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32296.99,-9944.24C32311.92,-9937.95 32328.25,-9932.18 32344,-9928.83 32362.86,-9924.82 33024.47,-9932.56 33038,-9918.83 33063.62,-9892.84 33022.49,-9866.25 32984.04,-9848.67"/>
<polygon fill="red" stroke="red" points="32985.44,-9845.46 32974.88,-9844.62 32982.61,-9851.87 32985.44,-9845.46"/>
<text text-anchor="middle" x="33076.5" y="-9907.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu14 -->
<g id="node255" class="node">
<title>l1_attn_stage14_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="32448" cy="-9827.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32448" y="-9838.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="32448" y="-9823.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="32448" y="-9808.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu14&#45;&gt;l1_attn_stage14_gpu14 -->
<g id="edge239" class="edge">
<title>l1_attn_stage13_gpu14&#45;&gt;l1_attn_stage14_gpu14</title>
<path fill="none" stroke="black" d="M32390.71,-9944.23C32375.86,-9937.97 32359.64,-9932.23 32344,-9928.83 32320.76,-9923.78 31932.62,-9935.85 31916,-9918.83 31911.34,-9914.06 31911.33,-9908.59 31916,-9903.83 31924.33,-9895.35 32332.63,-9899.31 32344,-9895.83 32363.63,-9889.82 32383.07,-9878.92 32399.73,-9867.61"/>
<polygon fill="black" stroke="black" points="32402.01,-9870.29 32408.18,-9861.68 32397.99,-9864.56 32402.01,-9870.29"/>
</g>
<!-- l1_attn_stage13_gpu14&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge2415" class="edge">
<title>l1_attn_stage13_gpu14&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32505,-9944.28C32519.92,-9937.98 32536.25,-9932.2 32552,-9928.83 32567.54,-9925.51 33112.86,-9930.17 33124,-9918.83 33160.88,-9881.3 33097.24,-9857.54 33033.37,-9843.83"/>
<polygon fill="red" stroke="red" points="33034.05,-9840.4 33023.55,-9841.8 33032.63,-9847.25 33034.05,-9840.4"/>
<text text-anchor="middle" x="33163.5" y="-9907.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu15 -->
<g id="node256" class="node">
<title>l1_attn_stage14_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="32656" cy="-9827.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="32656" y="-9838.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="32656" y="-9823.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="32656" y="-9808.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu15&#45;&gt;l1_attn_stage14_gpu15 -->
<g id="edge240" class="edge">
<title>l1_attn_stage13_gpu15&#45;&gt;l1_attn_stage14_gpu15</title>
<path fill="none" stroke="black" d="M32599,-9944.26C32584.08,-9937.96 32567.75,-9932.19 32552,-9928.83 32534.91,-9925.19 31935.26,-9931.29 31923,-9918.83 31918.32,-9914.08 31918.32,-9908.58 31923,-9903.83 31935.28,-9891.4 32535.28,-9900.9 32552,-9895.83 32571.65,-9889.88 32591.09,-9878.99 32607.75,-9867.67"/>
<polygon fill="black" stroke="black" points="32610.03,-9870.35 32616.2,-9861.74 32606.01,-9864.63 32610.03,-9870.35"/>
</g>
<!-- l1_attn_stage13_gpu15&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge2416" class="edge">
<title>l1_attn_stage13_gpu15&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32715.56,-9944.91C32731.88,-9938.39 32749.81,-9932.35 32767,-9928.83 32791.12,-9923.89 33192.79,-9936.43 33210,-9918.83 33259.67,-9868.03 33172.33,-9845.72 33082.57,-9835.94"/>
<polygon fill="red" stroke="red" points="33082.78,-9832.44 33072.47,-9834.89 33082.05,-9839.4 33082.78,-9832.44"/>
<text text-anchor="middle" x="33249.5" y="-9907.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu0 -->
<g id="node257" class="node">
<title>l1_attn_stage15_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="26289" cy="-9680.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26289" y="-9691.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="26289" y="-9676.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="26289" y="-9661.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu0&#45;&gt;l1_attn_stage15_gpu0 -->
<g id="edge241" class="edge">
<title>l1_attn_stage14_gpu0&#45;&gt;l1_attn_stage15_gpu0</title>
<path fill="none" stroke="black" d="M29440.91,-9825.74C29089.42,-9823.26 27830.28,-9811.94 26793,-9771.83 26615.06,-9764.95 26562.22,-9804.27 26393,-9748.83 26373.66,-9742.5 26354.43,-9731.64 26337.86,-9720.46"/>
<polygon fill="black" stroke="black" points="26339.65,-9717.45 26329.45,-9714.61 26335.65,-9723.19 26339.65,-9717.45"/>
</g>
<!-- l1_attn_stage15_gpu[next_gpu] -->
<g id="node1359" class="node">
<title>l1_attn_stage15_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="32931" cy="-9680.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="32931" y="-9676.63" font-family="Times,serif" font-size="14.00">l1_attn_stage15_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage14_gpu0&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge2417" class="edge">
<title>l1_attn_stage14_gpu0&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29594.96,-9797.87C29609.42,-9791.8 29625.05,-9785.98 29640,-9781.83 29718.68,-9760.02 29740.62,-9763.39 29822,-9756.83 30402.19,-9710.09 32210.49,-9688.53 32766.6,-9682.89"/>
<polygon fill="red" stroke="red" points="32766.74,-9686.38 32776.7,-9682.78 32766.67,-9679.39 32766.74,-9686.38"/>
<text text-anchor="middle" x="29853.5" y="-9760.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu1 -->
<g id="node258" class="node">
<title>l1_attn_stage15_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="26497" cy="-9680.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26497" y="-9691.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="26497" y="-9676.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="26497" y="-9661.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu1&#45;&gt;l1_attn_stage15_gpu1 -->
<g id="edge242" class="edge">
<title>l1_attn_stage14_gpu1&#45;&gt;l1_attn_stage15_gpu1</title>
<path fill="none" stroke="black" d="M29687.3,-9797.24C29672.31,-9790.9 29655.87,-9785.11 29640,-9781.83 29565.47,-9766.41 26976.05,-9774.89 26900,-9771.83 26766.83,-9766.47 26727.25,-9791.55 26601,-9748.83 26581.73,-9742.31 26562.51,-9731.4 26545.93,-9720.24"/>
<polygon fill="black" stroke="black" points="26547.73,-9717.22 26537.52,-9714.4 26543.73,-9722.97 26547.73,-9717.22"/>
</g>
<!-- l1_attn_stage14_gpu1&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge2418" class="edge">
<title>l1_attn_stage14_gpu1&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M29802.96,-9797.87C29817.42,-9791.8 29833.05,-9785.98 29848,-9781.83 29926.68,-9760.02 29948.62,-9763.46 30030,-9756.83 30567.79,-9713.03 32236.52,-9689.67 32767.2,-9683.21"/>
<polygon fill="red" stroke="red" points="32767.27,-9686.71 32777.23,-9683.09 32767.19,-9679.71 32767.27,-9686.71"/>
<text text-anchor="middle" x="30061.5" y="-9760.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu2 -->
<g id="node259" class="node">
<title>l1_attn_stage15_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="26705" cy="-9680.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26705" y="-9691.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="26705" y="-9676.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="26705" y="-9661.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu2&#45;&gt;l1_attn_stage15_gpu2 -->
<g id="edge243" class="edge">
<title>l1_attn_stage14_gpu2&#45;&gt;l1_attn_stage15_gpu2</title>
<path fill="none" stroke="black" d="M29895.3,-9797.24C29880.31,-9790.9 29863.87,-9785.11 29848,-9781.83 29773.47,-9766.41 27184.05,-9774.89 27108,-9771.83 26974.83,-9766.47 26935.25,-9791.55 26809,-9748.83 26789.73,-9742.31 26770.51,-9731.4 26753.93,-9720.24"/>
<polygon fill="black" stroke="black" points="26755.73,-9717.22 26745.52,-9714.4 26751.73,-9722.97 26755.73,-9717.22"/>
</g>
<!-- l1_attn_stage14_gpu2&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge2419" class="edge">
<title>l1_attn_stage14_gpu2&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30010.96,-9797.87C30025.42,-9791.8 30041.05,-9785.98 30056,-9781.83 30134.68,-9760.02 30156.63,-9763.54 30238,-9756.83 30733.36,-9715.99 32262.41,-9690.92 32767.32,-9683.59"/>
<polygon fill="red" stroke="red" points="32767.65,-9687.09 32777.6,-9683.44 32767.55,-9680.09 32767.65,-9687.09"/>
<text text-anchor="middle" x="30269.5" y="-9760.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu3 -->
<g id="node260" class="node">
<title>l1_attn_stage15_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26913" cy="-9680.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26913" y="-9691.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="26913" y="-9676.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26913" y="-9661.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu3&#45;&gt;l1_attn_stage15_gpu3 -->
<g id="edge244" class="edge">
<title>l1_attn_stage14_gpu3&#45;&gt;l1_attn_stage15_gpu3</title>
<path fill="none" stroke="black" d="M30103.3,-9797.24C30088.31,-9790.9 30071.87,-9785.11 30056,-9781.83 29981.47,-9766.41 27392.05,-9774.89 27316,-9771.83 27182.83,-9766.47 27143.25,-9791.55 27017,-9748.83 26997.73,-9742.31 26978.51,-9731.4 26961.93,-9720.24"/>
<polygon fill="black" stroke="black" points="26963.73,-9717.22 26953.52,-9714.4 26959.73,-9722.97 26963.73,-9717.22"/>
</g>
<!-- l1_attn_stage14_gpu3&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge2420" class="edge">
<title>l1_attn_stage14_gpu3&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30218.96,-9797.87C30233.42,-9791.8 30249.05,-9785.98 30264,-9781.83 30342.68,-9760.02 30364.64,-9763.64 30446,-9756.83 30899.37,-9718.91 32291.16,-9692.25 32768.41,-9684.01"/>
<polygon fill="red" stroke="red" points="32768.54,-9687.51 32778.48,-9683.84 32768.42,-9680.51 32768.54,-9687.51"/>
<text text-anchor="middle" x="30477.5" y="-9760.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu4 -->
<g id="node261" class="node">
<title>l1_attn_stage15_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="27121" cy="-9680.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="27121" y="-9691.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="27121" y="-9676.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="27121" y="-9661.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu4&#45;&gt;l1_attn_stage15_gpu4 -->
<g id="edge245" class="edge">
<title>l1_attn_stage14_gpu4&#45;&gt;l1_attn_stage15_gpu4</title>
<path fill="none" stroke="black" d="M30311.3,-9797.24C30296.31,-9790.9 30279.87,-9785.11 30264,-9781.83 30189.47,-9766.41 27600.05,-9774.89 27524,-9771.83 27390.83,-9766.47 27351.25,-9791.55 27225,-9748.83 27205.73,-9742.31 27186.51,-9731.4 27169.93,-9720.24"/>
<polygon fill="black" stroke="black" points="27171.73,-9717.22 27161.52,-9714.4 27167.73,-9722.97 27171.73,-9717.22"/>
</g>
<!-- l1_attn_stage14_gpu4&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge2421" class="edge">
<title>l1_attn_stage14_gpu4&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30426.96,-9797.87C30441.42,-9791.8 30457.05,-9785.98 30472,-9781.83 30550.68,-9760.02 30572.65,-9763.75 30654,-9756.83 31442.42,-9689.79 32389.1,-9681.42 32765.24,-9680.97"/>
<polygon fill="red" stroke="red" points="32765.38,-9684.47 32775.38,-9680.96 32765.38,-9677.47 32765.38,-9684.47"/>
<text text-anchor="middle" x="30685.5" y="-9760.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu5 -->
<g id="node262" class="node">
<title>l1_attn_stage15_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="27329" cy="-9680.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="27329" y="-9691.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="27329" y="-9676.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="27329" y="-9661.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu5&#45;&gt;l1_attn_stage15_gpu5 -->
<g id="edge246" class="edge">
<title>l1_attn_stage14_gpu5&#45;&gt;l1_attn_stage15_gpu5</title>
<path fill="none" stroke="black" d="M30519.3,-9797.24C30504.31,-9790.9 30487.87,-9785.11 30472,-9781.83 30397.47,-9766.41 27808.05,-9774.89 27732,-9771.83 27598.83,-9766.47 27559.25,-9791.55 27433,-9748.83 27413.73,-9742.31 27394.51,-9731.4 27377.93,-9720.24"/>
<polygon fill="black" stroke="black" points="27379.73,-9717.22 27369.52,-9714.4 27375.73,-9722.97 27379.73,-9717.22"/>
</g>
<!-- l1_attn_stage14_gpu5&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge2422" class="edge">
<title>l1_attn_stage14_gpu5&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30634.96,-9797.87C30649.42,-9791.8 30665.05,-9785.98 30680,-9781.83 30758.68,-9760.02 30780.66,-9763.88 30862,-9756.83 31568.32,-9695.59 32414.46,-9683.9 32765.67,-9681.76"/>
<polygon fill="red" stroke="red" points="32765.94,-9685.26 32775.92,-9681.7 32765.9,-9678.26 32765.94,-9685.26"/>
<text text-anchor="middle" x="30893.5" y="-9760.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu6 -->
<g id="node263" class="node">
<title>l1_attn_stage15_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="27537" cy="-9680.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="27537" y="-9691.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="27537" y="-9676.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="27537" y="-9661.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu6&#45;&gt;l1_attn_stage15_gpu6 -->
<g id="edge247" class="edge">
<title>l1_attn_stage14_gpu6&#45;&gt;l1_attn_stage15_gpu6</title>
<path fill="none" stroke="black" d="M30727.3,-9797.24C30712.31,-9790.9 30695.87,-9785.11 30680,-9781.83 30605.47,-9766.41 28016.05,-9774.89 27940,-9771.83 27806.83,-9766.47 27767.25,-9791.55 27641,-9748.83 27621.73,-9742.31 27602.51,-9731.4 27585.93,-9720.24"/>
<polygon fill="black" stroke="black" points="27587.73,-9717.22 27577.52,-9714.4 27583.73,-9722.97 27587.73,-9717.22"/>
</g>
<!-- l1_attn_stage14_gpu6&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge2423" class="edge">
<title>l1_attn_stage14_gpu6&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M30842.96,-9797.87C30857.42,-9791.8 30873.05,-9785.98 30888,-9781.83 30966.68,-9760.02 30988.67,-9764.05 31070,-9756.83 31694.71,-9701.38 32441.06,-9686.62 32766.14,-9682.72"/>
<polygon fill="red" stroke="red" points="32766.62,-9686.21 32776.58,-9682.59 32766.54,-9679.21 32766.62,-9686.21"/>
<text text-anchor="middle" x="31101.5" y="-9760.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu7 -->
<g id="node264" class="node">
<title>l1_attn_stage15_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="27745" cy="-9680.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="27745" y="-9691.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="27745" y="-9676.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="27745" y="-9661.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu7&#45;&gt;l1_attn_stage15_gpu7 -->
<g id="edge248" class="edge">
<title>l1_attn_stage14_gpu7&#45;&gt;l1_attn_stage15_gpu7</title>
<path fill="none" stroke="black" d="M30935.3,-9797.24C30920.31,-9790.9 30903.87,-9785.11 30888,-9781.83 30813.47,-9766.41 28224.05,-9774.89 28148,-9771.83 28014.83,-9766.47 27975.25,-9791.55 27849,-9748.83 27829.73,-9742.31 27810.51,-9731.4 27793.93,-9720.24"/>
<polygon fill="black" stroke="black" points="27795.73,-9717.22 27785.52,-9714.4 27791.73,-9722.97 27795.73,-9717.22"/>
</g>
<!-- l1_attn_stage14_gpu7&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge2424" class="edge">
<title>l1_attn_stage14_gpu7&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31050.96,-9797.87C31065.42,-9791.8 31081.05,-9785.98 31096,-9781.83 31174.68,-9760.02 31196.69,-9764.26 31278,-9756.83 31822.27,-9707.12 32470.48,-9689.6 32767.57,-9683.88"/>
<polygon fill="red" stroke="red" points="32768.06,-9687.37 32777.99,-9683.68 32767.93,-9680.37 32768.06,-9687.37"/>
<text text-anchor="middle" x="31309.5" y="-9760.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu8 -->
<g id="node265" class="node">
<title>l1_attn_stage15_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="27953" cy="-9680.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="27953" y="-9691.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="27953" y="-9676.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="27953" y="-9661.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu8&#45;&gt;l1_attn_stage15_gpu8 -->
<g id="edge249" class="edge">
<title>l1_attn_stage14_gpu8&#45;&gt;l1_attn_stage15_gpu8</title>
<path fill="none" stroke="black" d="M31143.3,-9797.24C31128.31,-9790.9 31111.87,-9785.11 31096,-9781.83 31021.44,-9766.41 28431.08,-9774.9 28355,-9771.83 28222.27,-9766.47 28182.83,-9791.42 28057,-9748.83 28037.73,-9742.31 28018.51,-9731.4 28001.93,-9720.23"/>
<polygon fill="black" stroke="black" points="28003.73,-9717.22 27993.52,-9714.39 27999.74,-9722.97 28003.73,-9717.22"/>
</g>
<!-- l1_attn_stage14_gpu8&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge2425" class="edge">
<title>l1_attn_stage14_gpu8&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31258.96,-9797.87C31273.42,-9791.8 31289.05,-9785.98 31304,-9781.83 31382.68,-9760.02 31404.71,-9764.52 31486,-9756.83 31951.29,-9712.8 32503.47,-9692.89 32770.5,-9685.3"/>
<polygon fill="red" stroke="red" points="32770.76,-9688.79 32780.66,-9685.01 32770.56,-9681.8 32770.76,-9688.79"/>
<text text-anchor="middle" x="31517.5" y="-9760.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu9 -->
<g id="node266" class="node">
<title>l1_attn_stage15_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="28161" cy="-9680.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="28161" y="-9691.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="28161" y="-9676.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="28161" y="-9661.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu9&#45;&gt;l1_attn_stage15_gpu9 -->
<g id="edge250" class="edge">
<title>l1_attn_stage14_gpu9&#45;&gt;l1_attn_stage15_gpu9</title>
<path fill="none" stroke="black" d="M31351.3,-9797.24C31336.31,-9790.9 31319.87,-9785.11 31304,-9781.83 31229.38,-9766.4 28637.13,-9774.92 28561,-9771.83 28429.16,-9766.48 28389.98,-9791.17 28265,-9748.83 28245.73,-9742.3 28226.51,-9731.39 28209.93,-9720.23"/>
<polygon fill="black" stroke="black" points="28211.73,-9717.21 28201.52,-9714.39 28207.74,-9722.97 28211.73,-9717.21"/>
</g>
<!-- l1_attn_stage14_gpu9&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge2426" class="edge">
<title>l1_attn_stage14_gpu9&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31466.96,-9797.87C31481.42,-9791.8 31497.05,-9785.98 31512,-9781.83 31590.68,-9760.02 31612.75,-9764.88 31694,-9756.83 32081.66,-9718.43 32539.74,-9696.58 32774.71,-9687.08"/>
<polygon fill="red" stroke="red" points="32775.19,-9690.57 32785.04,-9686.67 32774.91,-9683.57 32775.19,-9690.57"/>
<text text-anchor="middle" x="31725.5" y="-9760.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu10 -->
<g id="node267" class="node">
<title>l1_attn_stage15_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="28369" cy="-9680.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="28369" y="-9691.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="28369" y="-9676.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="28369" y="-9661.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu10&#45;&gt;l1_attn_stage15_gpu10 -->
<g id="edge251" class="edge">
<title>l1_attn_stage14_gpu10&#45;&gt;l1_attn_stage15_gpu10</title>
<path fill="none" stroke="black" d="M31559.3,-9797.24C31544.31,-9790.9 31527.87,-9785.11 31512,-9781.83 31437.28,-9766.37 28841.24,-9774.97 28765,-9771.83 28634.93,-9766.48 28596.28,-9790.66 28473,-9748.83 28453.73,-9742.29 28434.52,-9731.38 28417.94,-9720.22"/>
<polygon fill="black" stroke="black" points="28419.73,-9717.2 28409.52,-9714.38 28415.74,-9722.95 28419.73,-9717.2"/>
</g>
<!-- l1_attn_stage14_gpu10&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge2427" class="edge">
<title>l1_attn_stage14_gpu10&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31674.96,-9797.87C31689.42,-9791.8 31705.05,-9785.98 31720,-9781.83 31798.68,-9760.02 31820.8,-9765.38 31902,-9756.83 32214.92,-9723.89 32582.89,-9700.61 32783.03,-9689.24"/>
<polygon fill="red" stroke="red" points="32783.24,-9692.73 32793.02,-9688.67 32782.84,-9685.75 32783.24,-9692.73"/>
<text text-anchor="middle" x="31933.5" y="-9760.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu11 -->
<g id="node268" class="node">
<title>l1_attn_stage15_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="28577" cy="-9680.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="28577" y="-9691.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="28577" y="-9676.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="28577" y="-9661.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu11&#45;&gt;l1_attn_stage15_gpu11 -->
<g id="edge252" class="edge">
<title>l1_attn_stage14_gpu11&#45;&gt;l1_attn_stage15_gpu11</title>
<path fill="none" stroke="black" d="M31767.3,-9797.24C31752.31,-9790.9 31735.87,-9785.11 31720,-9781.83 31645.09,-9766.34 29042.43,-9775.05 28966,-9771.83 28839.03,-9766.49 28801.3,-9789.78 28681,-9748.83 28661.74,-9742.27 28642.52,-9731.36 28625.94,-9720.19"/>
<polygon fill="black" stroke="black" points="28627.74,-9717.18 28617.53,-9714.36 28623.75,-9722.93 28627.74,-9717.18"/>
</g>
<!-- l1_attn_stage14_gpu11&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge2428" class="edge">
<title>l1_attn_stage14_gpu11&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M31882.96,-9797.87C31897.42,-9791.8 31913.05,-9785.98 31928,-9781.83 32006.68,-9760.02 32028.88,-9766.13 32110,-9756.83 32351.14,-9729.2 32633.05,-9705.04 32795.92,-9691.89"/>
<polygon fill="red" stroke="red" points="32796.3,-9695.37 32805.99,-9691.08 32795.74,-9688.39 32796.3,-9695.37"/>
<text text-anchor="middle" x="32141.5" y="-9760.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu12 -->
<g id="node269" class="node">
<title>l1_attn_stage15_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="28785" cy="-9680.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="28785" y="-9691.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="28785" y="-9676.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="28785" y="-9661.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu12&#45;&gt;l1_attn_stage15_gpu12 -->
<g id="edge253" class="edge">
<title>l1_attn_stage14_gpu12&#45;&gt;l1_attn_stage15_gpu12</title>
<path fill="none" stroke="black" d="M31975.3,-9797.24C31960.31,-9790.9 31943.87,-9785.11 31928,-9781.83 31852.68,-9766.25 29235.84,-9775.24 29159,-9771.83 29038.68,-9766.5 29002.92,-9787.9 28889,-9748.83 28869.75,-9742.23 28850.54,-9731.3 28833.96,-9720.14"/>
<polygon fill="black" stroke="black" points="28835.76,-9717.13 28825.55,-9714.31 28831.77,-9722.88 28835.76,-9717.13"/>
</g>
<!-- l1_attn_stage14_gpu12&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge2429" class="edge">
<title>l1_attn_stage14_gpu12&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32090.95,-9797.83C32105.41,-9791.76 32121.04,-9785.95 32136,-9781.83 32353.76,-9721.89 32615.06,-9697.56 32777.1,-9687.78"/>
<polygon fill="red" stroke="red" points="32777.37,-9691.27 32787.14,-9687.18 32776.95,-9684.28 32777.37,-9691.27"/>
<text text-anchor="middle" x="32251.5" y="-9760.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu13 -->
<g id="node270" class="node">
<title>l1_attn_stage15_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="28993" cy="-9680.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="28993" y="-9691.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="28993" y="-9676.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="28993" y="-9661.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu13&#45;&gt;l1_attn_stage15_gpu13 -->
<g id="edge254" class="edge">
<title>l1_attn_stage14_gpu13&#45;&gt;l1_attn_stage15_gpu13</title>
<path fill="none" stroke="black" d="M32183.3,-9797.24C32168.31,-9790.9 32151.87,-9785.11 32136,-9781.83 32059.86,-9766.08 29414.66,-9775.68 29337,-9771.83 29229.98,-9766.52 29198.18,-9784.12 29097,-9748.83 29077.96,-9742.19 29058.93,-9731.37 29042.45,-9720.32"/>
<polygon fill="black" stroke="black" points="29044.3,-9717.34 29034.08,-9714.54 29040.32,-9723.11 29044.3,-9717.34"/>
</g>
<!-- l1_attn_stage14_gpu13&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge2430" class="edge">
<title>l1_attn_stage14_gpu13&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32299.61,-9798C32313.91,-9791.99 32329.31,-9786.17 32344,-9781.83 32500.74,-9735.58 32687.69,-9708.13 32807.81,-9693.9"/>
<polygon fill="red" stroke="red" points="32808.25,-9697.37 32817.78,-9692.73 32807.44,-9690.42 32808.25,-9697.37"/>
<text text-anchor="middle" x="32469.5" y="-9760.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu14 -->
<g id="node271" class="node">
<title>l1_attn_stage15_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="29201" cy="-9680.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29201" y="-9691.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="29201" y="-9676.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="29201" y="-9661.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu14&#45;&gt;l1_attn_stage15_gpu14 -->
<g id="edge255" class="edge">
<title>l1_attn_stage14_gpu14&#45;&gt;l1_attn_stage15_gpu14</title>
<path fill="none" stroke="black" d="M32391.3,-9797.24C32376.31,-9790.9 32359.87,-9785.11 32344,-9781.83 32266.26,-9765.76 29565.22,-9776.98 29486,-9771.83 29405.08,-9766.57 29381.15,-9776.72 29305,-9748.83 29286.07,-9741.9 29267.06,-9731 29250.58,-9719.97"/>
<polygon fill="black" stroke="black" points="29252.42,-9716.99 29242.2,-9714.21 29248.46,-9722.76 29252.42,-9716.99"/>
</g>
<!-- l1_attn_stage14_gpu14&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge2431" class="edge">
<title>l1_attn_stage14_gpu14&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32509.01,-9798.48C32522.99,-9792.59 32537.89,-9786.69 32552,-9781.83 32653.63,-9746.82 32774.09,-9716.76 32851.48,-9698.87"/>
<polygon fill="red" stroke="red" points="32852.67,-9702.19 32861.63,-9696.53 32851.1,-9695.36 32852.67,-9702.19"/>
<text text-anchor="middle" x="32654.5" y="-9760.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu15 -->
<g id="node272" class="node">
<title>l1_attn_stage15_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="29409" cy="-9680.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="29409" y="-9691.63" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="29409" y="-9676.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="29409" y="-9661.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu15&#45;&gt;l1_attn_stage15_gpu15 -->
<g id="edge256" class="edge">
<title>l1_attn_stage14_gpu15&#45;&gt;l1_attn_stage15_gpu15</title>
<path fill="none" stroke="black" d="M32599.31,-9797.24C32584.31,-9790.9 32567.87,-9785.11 32552,-9781.83 32471.02,-9765.09 29655.1,-9792.39 29575,-9771.83 29534.6,-9761.46 29493.42,-9739.09 29462.17,-9719.19"/>
<polygon fill="black" stroke="black" points="29463.93,-9716.16 29453.63,-9713.66 29460.12,-9722.03 29463.93,-9716.16"/>
</g>
<!-- l1_attn_stage14_gpu15&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge2432" class="edge">
<title>l1_attn_stage14_gpu15&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M32711.98,-9796.81C32764.84,-9768.95 32842.84,-9727.81 32890.09,-9702.9"/>
<polygon fill="red" stroke="red" points="32891.91,-9705.9 32899.12,-9698.14 32888.64,-9699.71 32891.91,-9705.9"/>
<text text-anchor="middle" x="32816.5" y="-9760.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_out_gpu0 -->
<g id="node289" class="node">
<title>l1_attn_out_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24762" cy="-9557.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="24762" y="-9576.55" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="24762" y="-9561.55" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24762" y="-9546.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="24762" y="-9531.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu0&#45;&gt;l1_attn_out_gpu0 -->
<g id="edge257" class="edge">
<title>l1_attn_stage15_gpu0&#45;&gt;l1_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M26194.75,-9674.7C26006.59,-9665.43 25571.01,-9643.85 25205,-9624.83 25047.65,-9616.65 25002.85,-9647.87 24851,-9605.83 24842.22,-9603.4 24833.32,-9600.01 24824.72,-9596.14"/>
<polygon fill="black" stroke="black" points="24826.06,-9592.9 24815.52,-9591.79 24823.06,-9599.23 24826.06,-9592.9"/>
</g>
<!-- l1_attn_out_gpu1 -->
<g id="node290" class="node">
<title>l1_attn_out_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24935" cy="-9557.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="24935" y="-9576.55" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="24935" y="-9561.55" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24935" y="-9546.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="24935" y="-9531.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu1&#45;&gt;l1_attn_out_gpu1 -->
<g id="edge258" class="edge">
<title>l1_attn_stage15_gpu1&#45;&gt;l1_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M26440.02,-9650.19C26425.09,-9643.9 26408.76,-9638.14 26393,-9634.83 26338.9,-9623.46 25453.25,-9626.71 25398,-9624.83 25252.51,-9619.88 25213.8,-9634.13 25071,-9605.83 25049.84,-9601.64 25027.49,-9594.92 25007.15,-9587.85"/>
<polygon fill="black" stroke="black" points="25008.25,-9584.53 24997.65,-9584.48 25005.9,-9591.13 25008.25,-9584.53"/>
</g>
<!-- l1_attn_out_gpu2 -->
<g id="node291" class="node">
<title>l1_attn_out_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25155" cy="-9557.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="25155" y="-9576.55" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="25155" y="-9561.55" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25155" y="-9546.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="25155" y="-9531.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu2&#45;&gt;l1_attn_out_gpu2 -->
<g id="edge259" class="edge">
<title>l1_attn_stage15_gpu2&#45;&gt;l1_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M26648.01,-9650.23C26633.09,-9643.93 26616.75,-9638.17 26601,-9634.83 26559.2,-9625.98 25874.71,-9625.8 25832,-9624.83 25701.3,-9621.87 25370.36,-9639.37 25244,-9605.83 25235.19,-9603.49 25226.28,-9600.15 25217.67,-9596.32"/>
<polygon fill="black" stroke="black" points="25219,-9593.08 25208.47,-9591.99 25216.02,-9599.41 25219,-9593.08"/>
</g>
<!-- l1_attn_out_gpu3 -->
<g id="node292" class="node">
<title>l1_attn_out_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="25328" cy="-9557.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="25328" y="-9576.55" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="25328" y="-9561.55" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="25328" y="-9546.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="25328" y="-9531.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu3&#45;&gt;l1_attn_out_gpu3 -->
<g id="edge260" class="edge">
<title>l1_attn_stage15_gpu3&#45;&gt;l1_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M26855.99,-9650.33C26841.07,-9644.03 26824.74,-9638.24 26809,-9634.83 26525.28,-9573.39 25790.35,-9647.06 25503,-9605.83 25469.98,-9601.09 25434.29,-9592.2 25403.81,-9583.41"/>
<polygon fill="black" stroke="black" points="25404.69,-9580.02 25394.11,-9580.57 25402.72,-9586.74 25404.69,-9580.02"/>
</g>
<!-- l1_attn_out_gpu4 -->
<g id="node293" class="node">
<title>l1_attn_out_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25587" cy="-9557.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="25587" y="-9576.55" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="25587" y="-9561.55" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25587" y="-9546.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="25587" y="-9531.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu4&#45;&gt;l1_attn_out_gpu4 -->
<g id="edge261" class="edge">
<title>l1_attn_stage15_gpu4&#45;&gt;l1_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M27063.71,-9650.25C27048.86,-9644 27032.64,-9638.25 27017,-9634.83 26774.42,-9581.82 26147.35,-9627.56 25900,-9605.83 25821.02,-9598.89 25731.64,-9584.82 25668.68,-9573.86"/>
<polygon fill="black" stroke="black" points="25669.26,-9570.41 25658.8,-9572.13 25668.05,-9577.3 25669.26,-9570.41"/>
</g>
<!-- l1_attn_out_gpu5 -->
<g id="node294" class="node">
<title>l1_attn_out_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="25984" cy="-9557.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="25984" y="-9576.55" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="25984" y="-9561.55" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="25984" y="-9546.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="25984" y="-9531.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu5&#45;&gt;l1_attn_out_gpu5 -->
<g id="edge262" class="edge">
<title>l1_attn_stage15_gpu5&#45;&gt;l1_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M27271.39,-9650.32C27256.62,-9644.11 27240.51,-9638.36 27225,-9634.83 27078.82,-9601.58 26700.62,-9615.26 26551,-9605.83 26379.4,-9595.02 26179.02,-9577.14 26068.33,-9566.81"/>
<polygon fill="black" stroke="black" points="26068.51,-9563.31 26058.23,-9565.86 26067.86,-9570.28 26068.51,-9563.31"/>
</g>
<!-- l1_attn_out_gpu6 -->
<g id="node295" class="node">
<title>l1_attn_out_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="26635" cy="-9557.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="26635" y="-9576.55" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="26635" y="-9561.55" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="26635" y="-9546.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="26635" y="-9531.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu6&#45;&gt;l1_attn_out_gpu6 -->
<g id="edge263" class="edge">
<title>l1_attn_stage15_gpu6&#45;&gt;l1_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M27478.72,-9650.59C27464.11,-9644.45 27448.24,-9638.67 27433,-9634.83 27292.37,-9599.42 27252.38,-9619.46 27108,-9605.83 26971.85,-9592.98 26813.77,-9577.04 26719.2,-9567.39"/>
<polygon fill="black" stroke="black" points="26719.42,-9563.9 26709.12,-9566.36 26718.71,-9570.86 26719.42,-9563.9"/>
</g>
<!-- l1_attn_out_gpu7 -->
<g id="node296" class="node">
<title>l1_attn_out_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="27192" cy="-9557.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="27192" y="-9576.55" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="27192" y="-9561.55" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="27192" y="-9546.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="27192" y="-9531.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu7&#45;&gt;l1_attn_out_gpu7 -->
<g id="edge264" class="edge">
<title>l1_attn_stage15_gpu7&#45;&gt;l1_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M27686.37,-9650.79C27671.83,-9644.68 27656.08,-9638.86 27641,-9634.83 27535.07,-9606.53 27504.03,-9624.63 27396,-9605.83 27354.42,-9598.59 27308.58,-9588.23 27270.91,-9579.08"/>
<polygon fill="black" stroke="black" points="27271.56,-9575.63 27261.02,-9576.65 27269.9,-9582.43 27271.56,-9575.63"/>
</g>
<!-- l1_attn_out_gpu8 -->
<g id="node297" class="node">
<title>l1_attn_out_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="27480" cy="-9557.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="27480" y="-9576.55" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="27480" y="-9561.55" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="27480" y="-9546.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="27480" y="-9531.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu8&#45;&gt;l1_attn_out_gpu8 -->
<g id="edge265" class="edge">
<title>l1_attn_stage15_gpu8&#45;&gt;l1_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M27893.01,-9651.24C27878.78,-9645.26 27863.52,-9639.39 27849,-9634.83 27796.51,-9618.37 27653.71,-9590.7 27561.93,-9573.65"/>
<polygon fill="black" stroke="black" points="27562.3,-9570.16 27551.83,-9571.78 27561.02,-9577.04 27562.3,-9570.16"/>
</g>
<!-- l1_attn_out_gpu9 -->
<g id="node298" class="node">
<title>l1_attn_out_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="27819" cy="-9557.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="27819" y="-9576.55" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="27819" y="-9561.55" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="27819" y="-9546.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="27819" y="-9531.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu9&#45;&gt;l1_attn_out_gpu9 -->
<g id="edge266" class="edge">
<title>l1_attn_stage15_gpu9&#45;&gt;l1_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M28099.25,-9651.77C28085.44,-9645.93 28070.8,-9639.98 28057,-9634.83 28004.06,-9615.1 27943.39,-9595.75 27896.55,-9581.5"/>
<polygon fill="black" stroke="black" points="27897.36,-9578.09 27886.78,-9578.54 27895.33,-9584.79 27897.36,-9578.09"/>
</g>
<!-- l1_attn_out_gpu10 -->
<g id="node299" class="node">
<title>l1_attn_out_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="28128" cy="-9557.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="28128" y="-9576.55" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="28128" y="-9561.55" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="28128" y="-9546.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="28128" y="-9531.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu10&#45;&gt;l1_attn_out_gpu10 -->
<g id="edge267" class="edge">
<title>l1_attn_stage15_gpu10&#45;&gt;l1_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M28311.27,-9650.45C28276.49,-9633.04 28232.01,-9610.79 28195.59,-9592.56"/>
<polygon fill="black" stroke="black" points="28197.02,-9589.37 28186.51,-9588.02 28193.89,-9595.63 28197.02,-9589.37"/>
</g>
<!-- l1_attn_out_gpu11 -->
<g id="node300" class="node">
<title>l1_attn_out_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="28472" cy="-9557.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="28472" y="-9576.55" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="28472" y="-9561.55" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="28472" y="-9546.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="28472" y="-9531.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu11&#45;&gt;l1_attn_out_gpu11 -->
<g id="edge268" class="edge">
<title>l1_attn_stage15_gpu11&#45;&gt;l1_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M28546.63,-9644.45C28536.79,-9633.16 28525.69,-9620.4 28515.11,-9608.25"/>
<polygon fill="black" stroke="black" points="28517.45,-9605.62 28508.25,-9600.38 28512.18,-9610.22 28517.45,-9605.62"/>
</g>
<!-- l1_attn_out_gpu12 -->
<g id="node301" class="node">
<title>l1_attn_out_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="28703" cy="-9557.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="28703" y="-9576.55" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="28703" y="-9561.55" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="28703" y="-9546.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="28703" y="-9531.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu12&#45;&gt;l1_attn_out_gpu12 -->
<g id="edge269" class="edge">
<title>l1_attn_stage15_gpu12&#45;&gt;l1_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M28760.84,-9643.8C28753.76,-9633.4 28745.88,-9621.8 28738.26,-9610.6"/>
<polygon fill="black" stroke="black" points="28741.02,-9608.43 28732.5,-9602.13 28735.23,-9612.37 28741.02,-9608.43"/>
</g>
<!-- l1_attn_out_gpu13 -->
<g id="node302" class="node">
<title>l1_attn_out_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="28922" cy="-9557.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="28922" y="-9576.55" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="28922" y="-9561.55" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="28922" y="-9546.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="28922" y="-9531.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu13&#45;&gt;l1_attn_out_gpu13 -->
<g id="edge270" class="edge">
<title>l1_attn_stage15_gpu13&#45;&gt;l1_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M28971.89,-9643.48C28966.08,-9633.61 28959.65,-9622.68 28953.39,-9612.06"/>
<polygon fill="black" stroke="black" points="28956.28,-9610.07 28948.19,-9603.23 28950.25,-9613.62 28956.28,-9610.07"/>
</g>
<!-- l1_attn_out_gpu14 -->
<g id="node303" class="node">
<title>l1_attn_out_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="29148" cy="-9557.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="29148" y="-9576.55" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="29148" y="-9561.55" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="29148" y="-9546.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="29148" y="-9531.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu14&#45;&gt;l1_attn_out_gpu14 -->
<g id="edge271" class="edge">
<title>l1_attn_stage15_gpu14&#45;&gt;l1_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M29185.1,-9643.15C29181.03,-9633.9 29176.57,-9623.74 29172.19,-9613.77"/>
<polygon fill="black" stroke="black" points="29175.26,-9612.06 29168.03,-9604.31 29168.85,-9614.88 29175.26,-9612.06"/>
</g>
<!-- l1_attn_out_gpu15 -->
<g id="node304" class="node">
<title>l1_attn_out_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="29340" cy="-9557.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="29340" y="-9576.55" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="29340" y="-9561.55" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="29340" y="-9546.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="29340" y="-9531.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu15&#45;&gt;l1_attn_out_gpu15 -->
<g id="edge272" class="edge">
<title>l1_attn_stage15_gpu15&#45;&gt;l1_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M29388.48,-9643.48C29382.84,-9633.61 29376.59,-9622.68 29370.5,-9612.06"/>
<polygon fill="black" stroke="black" points="29373.45,-9610.17 29365.45,-9603.23 29367.38,-9613.64 29373.45,-9610.17"/>
</g>
<!-- l1_qkv_gpu0&#45;&gt;l1_attn_stage0_gpu0 -->
<g id="edge1" class="edge">
<title>l1_qkv_gpu0&#45;&gt;l1_attn_stage0_gpu0</title>
<path fill="none" stroke="black" d="M28900.55,-12007.53C28938.85,-11998.53 28985.08,-11988.32 29027,-11980.83 29246,-11941.69 29505.6,-11911.16 29642.48,-11896.28"/>
<polygon fill="black" stroke="black" points="29642.96,-11899.75 29652.53,-11895.19 29642.21,-11892.79 29642.96,-11899.75"/>
</g>
<!-- l1_qkv_gpu1&#45;&gt;l1_attn_stage0_gpu1 -->
<g id="edge2" class="edge">
<title>l1_qkv_gpu1&#45;&gt;l1_attn_stage0_gpu1</title>
<path fill="none" stroke="black" d="M29212.96,-12010.25C29264.77,-12000.13 29332.45,-11988.03 29393,-11980.83 29490.94,-11969.19 29742.84,-11986.2 29836,-11953.83 29854.15,-11947.53 29872,-11936.8 29887.35,-11925.73"/>
<polygon fill="black" stroke="black" points="29889.68,-11928.36 29895.6,-11919.57 29885.49,-11922.75 29889.68,-11928.36"/>
</g>
<!-- l1_qkv_gpu2&#45;&gt;l1_attn_stage0_gpu2 -->
<g id="edge3" class="edge">
<title>l1_qkv_gpu2&#45;&gt;l1_attn_stage0_gpu2</title>
<path fill="none" stroke="black" d="M29575.78,-12006.82C29614.43,-11997.56 29661.34,-11987.34 29704,-11980.83 29848.16,-11958.83 29893.77,-12003.17 30031,-11953.83 30049.08,-11947.33 30066.92,-11936.55 30082.26,-11925.5"/>
<polygon fill="black" stroke="black" points="30084.59,-11928.13 30090.52,-11919.35 30080.41,-11922.51 30084.59,-11928.13"/>
</g>
<!-- l1_qkv_gpu3&#45;&gt;l1_attn_stage0_gpu3 -->
<g id="edge4" class="edge">
<title>l1_qkv_gpu3&#45;&gt;l1_attn_stage0_gpu3</title>
<path fill="none" stroke="black" d="M29881.22,-12001.72C29906.37,-11993.94 29934.65,-11986.1 29961,-11980.83 30077.09,-11957.62 30114.98,-11994.95 30226,-11953.83 30243.86,-11947.22 30261.51,-11936.53 30276.77,-11925.59"/>
<polygon fill="black" stroke="black" points="30279.03,-11928.27 30284.99,-11919.5 30274.87,-11922.64 30279.03,-11928.27"/>
</g>
<!-- l1_qkv_gpu4&#45;&gt;l1_attn_stage0_gpu4 -->
<g id="edge5" class="edge">
<title>l1_qkv_gpu4&#45;&gt;l1_attn_stage0_gpu4</title>
<path fill="none" stroke="black" d="M30149.6,-12014C30239.61,-11998.96 30373.13,-11974.4 30421,-11953.83 30438.18,-11946.45 30455.42,-11935.77 30470.5,-11925.08"/>
<polygon fill="black" stroke="black" points="30472.61,-11927.87 30478.64,-11919.16 30468.49,-11922.21 30472.61,-11927.87"/>
</g>
<!-- l1_qkv_gpu5&#45;&gt;l1_attn_stage0_gpu5 -->
<g id="edge6" class="edge">
<title>l1_qkv_gpu5&#45;&gt;l1_attn_stage0_gpu5</title>
<path fill="none" stroke="black" d="M30505.86,-12002.03C30540.36,-11989.26 30581.08,-11972.57 30616,-11953.83 30631.87,-11945.32 30648.26,-11934.7 30662.95,-11924.44"/>
<polygon fill="black" stroke="black" points="30665.25,-11927.09 30671.38,-11918.45 30661.2,-11921.38 30665.25,-11927.09"/>
</g>
<!-- l1_qkv_gpu6&#45;&gt;l1_attn_stage0_gpu6 -->
<g id="edge7" class="edge">
<title>l1_qkv_gpu6&#45;&gt;l1_attn_stage0_gpu6</title>
<path fill="none" stroke="black" d="M30758.73,-11990.06C30775.5,-11978.45 30794.02,-11965.62 30811,-11953.83 30824.96,-11944.14 30840.04,-11933.66 30854.05,-11923.91"/>
<polygon fill="black" stroke="black" points="30856.41,-11926.53 30862.62,-11917.95 30852.41,-11920.79 30856.41,-11926.53"/>
</g>
<!-- l1_qkv_gpu7&#45;&gt;l1_attn_stage0_gpu7 -->
<g id="edge8" class="edge">
<title>l1_qkv_gpu7&#45;&gt;l1_attn_stage0_gpu7</title>
<path fill="none" stroke="black" d="M31043.09,-11982.73C31053.44,-11966.07 31065.16,-11947.22 31075.46,-11930.64"/>
<polygon fill="black" stroke="black" points="31078.72,-11932.03 31081.03,-11921.69 31072.77,-11928.33 31078.72,-11932.03"/>
</g>
<!-- l1_qkv_gpu8&#45;&gt;l1_attn_stage0_gpu8 -->
<g id="edge9" class="edge">
<title>l1_qkv_gpu8&#45;&gt;l1_attn_stage0_gpu8</title>
<path fill="none" stroke="black" d="M31267.86,-11981.16C31272.82,-11965.57 31278.33,-11948.21 31283.28,-11932.65"/>
<polygon fill="black" stroke="black" points="31286.74,-11933.31 31286.43,-11922.72 31280.07,-11931.19 31286.74,-11933.31"/>
</g>
<!-- l1_qkv_gpu9&#45;&gt;l1_attn_stage0_gpu9 -->
<g id="edge10" class="edge">
<title>l1_qkv_gpu9&#45;&gt;l1_attn_stage0_gpu9</title>
<path fill="none" stroke="black" d="M31467.55,-11981.16C31471.73,-11965.57 31476.39,-11948.21 31480.57,-11932.65"/>
<polygon fill="black" stroke="black" points="31484.02,-11933.29 31483.23,-11922.72 31477.26,-11931.47 31484.02,-11933.29"/>
</g>
<!-- l1_qkv_gpu10&#45;&gt;l1_attn_stage0_gpu10 -->
<g id="edge11" class="edge">
<title>l1_qkv_gpu10&#45;&gt;l1_attn_stage0_gpu10</title>
<path fill="none" stroke="black" d="M31667.32,-11980.77C31670.7,-11965.33 31674.46,-11948.19 31677.83,-11932.8"/>
<polygon fill="black" stroke="black" points="31681.26,-11933.49 31679.98,-11922.97 31674.42,-11931.99 31681.26,-11933.49"/>
</g>
<!-- l1_qkv_gpu11&#45;&gt;l1_attn_stage0_gpu11 -->
<g id="edge12" class="edge">
<title>l1_qkv_gpu11&#45;&gt;l1_attn_stage0_gpu11</title>
<path fill="none" stroke="black" d="M31866.99,-11980.77C31869.58,-11965.48 31872.46,-11948.52 31875.05,-11933.24"/>
<polygon fill="black" stroke="black" points="31878.57,-11933.42 31876.79,-11922.97 31871.67,-11932.25 31878.57,-11933.42"/>
</g>
<!-- l1_qkv_gpu12&#45;&gt;l1_attn_stage0_gpu12 -->
<g id="edge13" class="edge">
<title>l1_qkv_gpu12&#45;&gt;l1_attn_stage0_gpu12</title>
<path fill="none" stroke="black" d="M32066.66,-11980.77C32068.5,-11965.48 32070.53,-11948.52 32072.37,-11933.24"/>
<polygon fill="black" stroke="black" points="32075.88,-11933.32 32073.6,-11922.97 32068.93,-11932.49 32075.88,-11933.32"/>
</g>
<!-- l1_qkv_gpu13&#45;&gt;l1_attn_stage0_gpu13 -->
<g id="edge14" class="edge">
<title>l1_qkv_gpu13&#45;&gt;l1_attn_stage0_gpu13</title>
<path fill="none" stroke="black" d="M32266.33,-11980.77C32267.41,-11965.48 32268.61,-11948.52 32269.69,-11933.24"/>
<polygon fill="black" stroke="black" points="32273.2,-11933.2 32270.41,-11922.97 32266.22,-11932.7 32273.2,-11933.2"/>
</g>
<!-- l1_qkv_gpu14&#45;&gt;l1_attn_stage0_gpu14 -->
<g id="edge15" class="edge">
<title>l1_qkv_gpu14&#45;&gt;l1_attn_stage0_gpu14</title>
<path fill="none" stroke="black" d="M32466,-11980.77C32466.32,-11965.48 32466.68,-11948.52 32467.01,-11933.24"/>
<polygon fill="black" stroke="black" points="32470.51,-11933.05 32467.22,-11922.97 32463.51,-11932.9 32470.51,-11933.05"/>
</g>
<!-- l1_qkv_gpu15&#45;&gt;l1_attn_stage0_gpu15 -->
<g id="edge16" class="edge">
<title>l1_qkv_gpu15&#45;&gt;l1_attn_stage0_gpu15</title>
<path fill="none" stroke="black" d="M32665.67,-11980.77C32665.24,-11965.48 32664.76,-11948.52 32664.33,-11933.24"/>
<polygon fill="black" stroke="black" points="32667.82,-11932.87 32664.04,-11922.97 32660.82,-11933.07 32667.82,-11932.87"/>
</g>
<!-- l1_gate_gpu0 -->
<g id="node305" class="node">
<title>l1_gate_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24699" cy="-9435.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="24699" y="-9446.47" font-family="Times,serif" font-size="14.00">L1 Gate</text>
<text text-anchor="middle" x="24699" y="-9431.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24699" y="-9416.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l1_attn_out_gpu0&#45;&gt;l1_gate_gpu0 -->
<g id="edge273" class="edge">
<title>l1_attn_out_gpu0&#45;&gt;l1_gate_gpu0</title>
<path fill="none" stroke="black" d="M24738.54,-9511.85C24733.24,-9501.7 24727.61,-9490.92 24722.31,-9480.78"/>
<polygon fill="black" stroke="black" points="24725.29,-9478.93 24717.56,-9471.69 24719.09,-9482.17 24725.29,-9478.93"/>
</g>
<!-- l1_gate_gpu1 -->
<g id="node306" class="node">
<title>l1_gate_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24877" cy="-9435.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="24877" y="-9446.47" font-family="Times,serif" font-size="14.00">L1 Gate</text>
<text text-anchor="middle" x="24877" y="-9431.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24877" y="-9416.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l1_attn_out_gpu1&#45;&gt;l1_gate_gpu1 -->
<g id="edge274" class="edge">
<title>l1_attn_out_gpu1&#45;&gt;l1_gate_gpu1</title>
<path fill="none" stroke="black" d="M24913.24,-9511.5C24908.46,-9501.58 24903.41,-9491.07 24898.64,-9481.16"/>
<polygon fill="black" stroke="black" points="24901.66,-9479.36 24894.17,-9471.87 24895.35,-9482.4 24901.66,-9479.36"/>
</g>
<!-- l1_gate_gpu2 -->
<g id="node307" class="node">
<title>l1_gate_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25055" cy="-9435.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="25055" y="-9446.47" font-family="Times,serif" font-size="14.00">L1 Gate</text>
<text text-anchor="middle" x="25055" y="-9431.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25055" y="-9416.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l1_attn_out_gpu2&#45;&gt;l1_gate_gpu2 -->
<g id="edge275" class="edge">
<title>l1_attn_out_gpu2&#45;&gt;l1_gate_gpu2</title>
<path fill="none" stroke="black" d="M25120.31,-9514.91C25110.5,-9503.09 25099.82,-9490.21 25089.99,-9478.36"/>
<polygon fill="black" stroke="black" points="25092.43,-9475.81 25083.35,-9470.35 25087.04,-9480.28 25092.43,-9475.81"/>
</g>
<!-- l1_gate_gpu3 -->
<g id="node308" class="node">
<title>l1_gate_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="25233" cy="-9435.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="25233" y="-9446.47" font-family="Times,serif" font-size="14.00">L1 Gate</text>
<text text-anchor="middle" x="25233" y="-9431.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="25233" y="-9416.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l1_attn_out_gpu3&#45;&gt;l1_gate_gpu3 -->
<g id="edge276" class="edge">
<title>l1_attn_out_gpu3&#45;&gt;l1_gate_gpu3</title>
<path fill="none" stroke="black" d="M25294.77,-9514.57C25285.56,-9502.88 25275.55,-9490.17 25266.33,-9478.47"/>
<polygon fill="black" stroke="black" points="25269.03,-9476.24 25260.09,-9470.55 25263.53,-9480.57 25269.03,-9476.24"/>
</g>
<!-- l1_gate_gpu4 -->
<g id="node309" class="node">
<title>l1_gate_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25411" cy="-9435.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="25411" y="-9446.47" font-family="Times,serif" font-size="14.00">L1 Gate</text>
<text text-anchor="middle" x="25411" y="-9431.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25411" y="-9416.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l1_attn_out_gpu4&#45;&gt;l1_gate_gpu4 -->
<g id="edge277" class="edge">
<title>l1_attn_out_gpu4&#45;&gt;l1_gate_gpu4</title>
<path fill="none" stroke="black" d="M25536.09,-9521.87C25513.31,-9506.26 25486.46,-9487.87 25463.49,-9472.13"/>
<polygon fill="black" stroke="black" points="25465.45,-9469.23 25455.22,-9466.46 25461.49,-9475 25465.45,-9469.23"/>
</g>
<!-- l1_gate_gpu5 -->
<g id="node310" class="node">
<title>l1_gate_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="25589" cy="-9435.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="25589" y="-9446.47" font-family="Times,serif" font-size="14.00">L1 Gate</text>
<text text-anchor="middle" x="25589" y="-9431.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="25589" y="-9416.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l1_attn_out_gpu5&#45;&gt;l1_gate_gpu5 -->
<g id="edge278" class="edge">
<title>l1_attn_out_gpu5&#45;&gt;l1_gate_gpu5</title>
<path fill="none" stroke="black" d="M25914,-9540.08C25851.5,-9524.59 25757.78,-9499.87 25678,-9472.67 25671.05,-9470.29 25663.85,-9467.66 25656.71,-9464.92"/>
<polygon fill="black" stroke="black" points="25657.61,-9461.52 25647.02,-9461.14 25655.07,-9468.04 25657.61,-9461.52"/>
</g>
<!-- l1_gate_gpu6 -->
<g id="node311" class="node">
<title>l1_gate_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="25767" cy="-9435.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="25767" y="-9446.47" font-family="Times,serif" font-size="14.00">L1 Gate</text>
<text text-anchor="middle" x="25767" y="-9431.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="25767" y="-9416.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l1_attn_out_gpu6&#45;&gt;l1_gate_gpu6 -->
<g id="edge279" class="edge">
<title>l1_attn_out_gpu6&#45;&gt;l1_gate_gpu6</title>
<path fill="none" stroke="black" d="M26560.62,-9551.4C26392.67,-9538.9 25988.43,-9506.25 25856,-9472.67 25848.29,-9470.71 25840.37,-9468.22 25832.58,-9465.46"/>
<polygon fill="black" stroke="black" points="25833.76,-9462.16 25823.17,-9461.98 25831.33,-9468.73 25833.76,-9462.16"/>
</g>
<!-- l1_gate_gpu7 -->
<g id="node312" class="node">
<title>l1_gate_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="25945" cy="-9435.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="25945" y="-9446.47" font-family="Times,serif" font-size="14.00">L1 Gate</text>
<text text-anchor="middle" x="25945" y="-9431.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="25945" y="-9416.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l1_attn_out_gpu7&#45;&gt;l1_gate_gpu7 -->
<g id="edge280" class="edge">
<title>l1_attn_out_gpu7&#45;&gt;l1_gate_gpu7</title>
<path fill="none" stroke="black" d="M27118.37,-9548.12C27025.43,-9537.53 26860.58,-9519.75 26719,-9509.67 26533.08,-9496.43 26486.09,-9502.31 26300,-9491.67 26181.67,-9484.9 26149.4,-9499.71 26034,-9472.67 26026.26,-9470.85 26018.31,-9468.45 26010.51,-9465.74"/>
<polygon fill="black" stroke="black" points="26011.68,-9462.44 26001.09,-9462.3 26009.28,-9469.01 26011.68,-9462.44"/>
</g>
<!-- l1_gate_gpu8 -->
<g id="node313" class="node">
<title>l1_gate_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="26123" cy="-9435.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="26123" y="-9446.47" font-family="Times,serif" font-size="14.00">L1 Gate</text>
<text text-anchor="middle" x="26123" y="-9431.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="26123" y="-9416.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l1_attn_out_gpu8&#45;&gt;l1_gate_gpu8 -->
<g id="edge281" class="edge">
<title>l1_attn_out_gpu8&#45;&gt;l1_gate_gpu8</title>
<path fill="none" stroke="black" d="M27411.7,-9537.31C27372.37,-9527.05 27321.8,-9515.41 27276,-9509.67 27102.43,-9487.88 26663.75,-9499.65 26489,-9491.67 26365.73,-9486.03 26332.18,-9500.66 26212,-9472.67 26204.14,-9470.83 26196.07,-9468.39 26188.16,-9465.64"/>
<polygon fill="black" stroke="black" points="26189.2,-9462.29 26178.6,-9462.14 26186.79,-9468.86 26189.2,-9462.29"/>
</g>
<!-- l1_gate_gpu9 -->
<g id="node314" class="node">
<title>l1_gate_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26301" cy="-9435.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="26301" y="-9446.47" font-family="Times,serif" font-size="14.00">L1 Gate</text>
<text text-anchor="middle" x="26301" y="-9431.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26301" y="-9416.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l1_attn_out_gpu9&#45;&gt;l1_gate_gpu9 -->
<g id="edge282" class="edge">
<title>l1_attn_out_gpu9&#45;&gt;l1_gate_gpu9</title>
<path fill="none" stroke="black" d="M27748.82,-9540.62C27697.84,-9529.68 27627.04,-9516.09 27564,-9509.67 27370.52,-9489.94 26883.31,-9499.83 26689,-9491.67 26555.96,-9486.07 26519.76,-9502.55 26390,-9472.67 26382.13,-9470.85 26374.06,-9468.42 26366.15,-9465.68"/>
<polygon fill="black" stroke="black" points="26367.19,-9462.33 26356.59,-9462.18 26364.78,-9468.9 26367.19,-9462.33"/>
</g>
<!-- l1_gate_gpu10 -->
<g id="node315" class="node">
<title>l1_gate_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="26479" cy="-9435.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="26479" y="-9446.47" font-family="Times,serif" font-size="14.00">L1 Gate</text>
<text text-anchor="middle" x="26479" y="-9431.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="26479" y="-9416.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l1_attn_out_gpu10&#45;&gt;l1_gate_gpu10 -->
<g id="edge283" class="edge">
<title>l1_attn_out_gpu10&#45;&gt;l1_gate_gpu10</title>
<path fill="none" stroke="black" d="M28058.62,-9538.7C28014.41,-9528.09 27955.74,-9515.61 27903,-9509.67 27684.13,-9485 27132.11,-9499.74 26912,-9491.67 26758.98,-9486.05 26717.36,-9506.41 26568,-9472.67 26560.12,-9470.89 26552.05,-9468.48 26544.13,-9465.74"/>
<polygon fill="black" stroke="black" points="26545.17,-9462.39 26534.58,-9462.26 26542.77,-9468.97 26545.17,-9462.39"/>
</g>
<!-- l1_gate_gpu11 -->
<g id="node316" class="node">
<title>l1_gate_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="26657" cy="-9435.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="26657" y="-9446.47" font-family="Times,serif" font-size="14.00">L1 Gate</text>
<text text-anchor="middle" x="26657" y="-9431.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="26657" y="-9416.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l1_attn_out_gpu11&#45;&gt;l1_gate_gpu11 -->
<g id="edge284" class="edge">
<title>l1_attn_out_gpu11&#45;&gt;l1_gate_gpu11</title>
<path fill="none" stroke="black" d="M28401.53,-9540.8C28349.47,-9529.8 28276.71,-9516.05 28212,-9509.67 27983.52,-9487.14 27408.48,-9498.7 27179,-9491.67 26986.46,-9485.76 26934.13,-9514.05 26746,-9472.67 26738.11,-9470.93 26730.03,-9468.55 26722.11,-9465.83"/>
<polygon fill="black" stroke="black" points="26723.15,-9462.48 26712.55,-9462.36 26720.76,-9469.06 26723.15,-9462.48"/>
</g>
<!-- l1_gate_gpu12 -->
<g id="node317" class="node">
<title>l1_gate_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="26835" cy="-9435.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="26835" y="-9446.47" font-family="Times,serif" font-size="14.00">L1 Gate</text>
<text text-anchor="middle" x="26835" y="-9431.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="26835" y="-9416.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l1_attn_out_gpu12&#45;&gt;l1_gate_gpu12 -->
<g id="edge285" class="edge">
<title>l1_attn_out_gpu12&#45;&gt;l1_gate_gpu12</title>
<path fill="none" stroke="black" d="M28639.6,-9531.97C28614.05,-9523.17 28584.03,-9514.3 28556,-9509.67 28444.06,-9491.16 27648.43,-9494.43 27535,-9491.67 27263.39,-9485.05 27189.71,-9529.34 26924,-9472.67 26916.1,-9470.98 26908.02,-9468.63 26900.09,-9465.93"/>
<polygon fill="black" stroke="black" points="26901.12,-9462.58 26890.53,-9462.47 26898.75,-9469.16 26901.12,-9462.58"/>
</g>
<!-- l1_gate_gpu13 -->
<g id="node318" class="node">
<title>l1_gate_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="27013" cy="-9435.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="27013" y="-9446.47" font-family="Times,serif" font-size="14.00">L1 Gate</text>
<text text-anchor="middle" x="27013" y="-9431.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="27013" y="-9416.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l1_attn_out_gpu13&#45;&gt;l1_gate_gpu13 -->
<g id="edge286" class="edge">
<title>l1_attn_out_gpu13&#45;&gt;l1_gate_gpu13</title>
<path fill="none" stroke="black" d="M28859.92,-9530.52C28837.37,-9522.23 28811.43,-9514.08 28787,-9509.67 28602.72,-9476.37 27285.32,-9510.89 27102,-9472.67 27094.1,-9471.02 27086,-9468.69 27078.08,-9466"/>
<polygon fill="black" stroke="black" points="27079.11,-9462.65 27068.51,-9462.56 27076.74,-9469.24 27079.11,-9462.65"/>
</g>
<!-- l1_gate_gpu14 -->
<g id="node319" class="node">
<title>l1_gate_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="27191" cy="-9435.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="27191" y="-9446.47" font-family="Times,serif" font-size="14.00">L1 Gate</text>
<text text-anchor="middle" x="27191" y="-9431.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="27191" y="-9416.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l1_attn_out_gpu14&#45;&gt;l1_gate_gpu14 -->
<g id="edge287" class="edge">
<title>l1_attn_out_gpu14&#45;&gt;l1_gate_gpu14</title>
<path fill="none" stroke="black" d="M29084.67,-9531.54C29060.45,-9523.02 29032.32,-9514.46 29006,-9509.67 28669.45,-9448.31 27599.75,-9438.16 27281.29,-9436.49"/>
<polygon fill="black" stroke="black" points="27281.2,-9432.99 27271.18,-9436.44 27281.17,-9439.99 27281.2,-9432.99"/>
</g>
<!-- l1_gate_gpu15 -->
<g id="node320" class="node">
<title>l1_gate_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="28780" cy="-9435.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="28780" y="-9446.47" font-family="Times,serif" font-size="14.00">L1 Gate</text>
<text text-anchor="middle" x="28780" y="-9431.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="28780" y="-9416.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l1_attn_out_gpu15&#45;&gt;l1_gate_gpu15 -->
<g id="edge288" class="edge">
<title>l1_attn_out_gpu15&#45;&gt;l1_gate_gpu15</title>
<path fill="none" stroke="black" d="M29281.01,-9527.87C29265.37,-9521.09 29248.29,-9514.46 29232,-9509.67 29108.68,-9473.38 28960.83,-9453.61 28868.63,-9443.97"/>
<polygon fill="black" stroke="black" points="28868.8,-9440.47 28858.5,-9442.93 28868.09,-9447.43 28868.8,-9440.47"/>
</g>
<!-- l1_expert0_gpu0 -->
<g id="node321" class="node">
<title>l1_expert0_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="23894" cy="-9298.58" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="23894" y="-9317.38" font-family="Times,serif" font-size="14.00">L1 Expert0</text>
<text text-anchor="middle" x="23894" y="-9302.38" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="23894" y="-9287.38" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="23894" y="-9272.38" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l1_gate_gpu0&#45;&gt;l1_expert0_gpu0 -->
<g id="edge289" class="edge">
<title>l1_gate_gpu0&#45;&gt;l1_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M24618.79,-9434.38C24118.95,-9435.55 21450.39,-9439.02 21392,-9379.67 21387.32,-9374.91 21387.31,-9369.4 21392,-9364.67 21411.55,-9344.93 23364.26,-9348.09 23392,-9346.67 23541.23,-9339.01 23714.66,-9320.63 23813.66,-9309.23"/>
<polygon fill="black" stroke="black" points="23814.35,-9312.67 23823.88,-9308.05 23813.55,-9305.72 23814.35,-9312.67"/>
<text text-anchor="middle" x="21437.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l1_expert1_gpu1 -->
<g id="node322" class="node">
<title>l1_expert1_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24539" cy="-9298.58" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="24539" y="-9317.38" font-family="Times,serif" font-size="14.00">L1 Expert1</text>
<text text-anchor="middle" x="24539" y="-9302.38" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24539" y="-9287.38" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="24539" y="-9272.38" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l1_gate_gpu0&#45;&gt;l1_expert1_gpu1 -->
<g id="edge290" class="edge">
<title>l1_gate_gpu0&#45;&gt;l1_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M24619.02,-9434.14C24324.79,-9433.68 23317.03,-9428.52 23270,-9379.67 23265.38,-9374.86 23265.35,-9369.44 23270,-9364.67 23283.67,-9350.64 23955.44,-9347.73 23975,-9346.67 24147.44,-9337.27 24348.96,-9318.58 24458.34,-9307.79"/>
<polygon fill="black" stroke="black" points="24458.7,-9311.27 24468.31,-9306.8 24458.01,-9304.31 24458.7,-9311.27"/>
<text text-anchor="middle" x="23315.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l1_expert2_gpu2 -->
<g id="node323" class="node">
<title>l1_expert2_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="26838" cy="-9298.58" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="26838" y="-9317.38" font-family="Times,serif" font-size="14.00">L1 Expert2</text>
<text text-anchor="middle" x="26838" y="-9302.38" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="26838" y="-9287.38" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="26838" y="-9272.38" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l1_gate_gpu0&#45;&gt;l1_expert2_gpu2 -->
<g id="edge291" class="edge">
<title>l1_gate_gpu0&#45;&gt;l1_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M24754.01,-9407.83C24765.03,-9403.64 24776.7,-9399.94 24788,-9397.67 24818.16,-9391.59 26981.33,-9401.51 27003,-9379.67 27036.49,-9345.9 26974.74,-9324.27 26917.48,-9312.12"/>
<polygon fill="black" stroke="black" points="26918.1,-9308.67 26907.6,-9310.1 26916.7,-9315.53 26918.1,-9308.67"/>
<text text-anchor="middle" x="27056.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l1_expert3_gpu3 -->
<g id="node324" class="node">
<title>l1_expert3_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="25710" cy="-9298.58" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="25710" y="-9317.38" font-family="Times,serif" font-size="14.00">L1 Expert3</text>
<text text-anchor="middle" x="25710" y="-9302.38" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="25710" y="-9287.38" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="25710" y="-9272.38" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l1_gate_gpu0&#45;&gt;l1_expert3_gpu3 -->
<g id="edge292" class="edge">
<title>l1_gate_gpu0&#45;&gt;l1_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M24754.57,-9408.06C24765.45,-9403.9 24776.92,-9400.16 24788,-9397.67 24861.17,-9381.21 25054.83,-9406.14 25125,-9379.67 25135.07,-9375.87 25134.05,-9368.77 25144,-9364.67 25229.71,-9329.29 25493.47,-9310.82 25628.5,-9303.47"/>
<polygon fill="black" stroke="black" points="25628.99,-9306.95 25638.79,-9302.92 25628.62,-9299.96 25628.99,-9306.95"/>
<text text-anchor="middle" x="25189.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l1_expert4_gpu4 -->
<g id="node325" class="node">
<title>l1_expert4_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="29625" cy="-9298.58" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="29625" y="-9317.38" font-family="Times,serif" font-size="14.00">L1 Expert4</text>
<text text-anchor="middle" x="29625" y="-9302.38" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="29625" y="-9287.38" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="29625" y="-9272.38" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l1_gate_gpu0&#45;&gt;l1_expert4_gpu4 -->
<g id="edge293" class="edge">
<title>l1_gate_gpu0&#45;&gt;l1_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M24754,-9407.78C24765.02,-9403.6 24776.7,-9399.91 24788,-9397.67 24828.45,-9389.63 30697.88,-9408.87 30727,-9379.67 30799.75,-9306.7 29974.1,-9299.8 29706.86,-9299.47"/>
<polygon fill="black" stroke="black" points="29706.83,-9295.97 29696.83,-9299.46 29706.83,-9302.97 29706.83,-9295.97"/>
<text text-anchor="middle" x="30776.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l1_expert5_gpu5 -->
<g id="node326" class="node">
<title>l1_expert5_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="28070" cy="-9298.58" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="28070" y="-9317.38" font-family="Times,serif" font-size="14.00">L1 Expert5</text>
<text text-anchor="middle" x="28070" y="-9302.38" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="28070" y="-9287.38" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="28070" y="-9272.38" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l1_gate_gpu0&#45;&gt;l1_expert5_gpu5 -->
<g id="edge294" class="edge">
<title>l1_gate_gpu0&#45;&gt;l1_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M24754,-9407.8C24765.02,-9403.61 24776.7,-9399.92 24788,-9397.67 24815.57,-9392.17 28816.17,-9399.59 28836,-9379.67 28840.7,-9374.94 28840.51,-9369.57 28836,-9364.67 28790.4,-9315.02 28339.69,-9303.2 28151.69,-9300.42"/>
<polygon fill="black" stroke="black" points="28151.63,-9296.92 28141.59,-9300.28 28151.53,-9303.92 28151.63,-9296.92"/>
<text text-anchor="middle" x="28884.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l1_expert6_gpu6 -->
<g id="node327" class="node">
<title>l1_expert6_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="21897" cy="-9298.58" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="21897" y="-9317.38" font-family="Times,serif" font-size="14.00">L1 Expert6</text>
<text text-anchor="middle" x="21897" y="-9302.38" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="21897" y="-9287.38" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="21897" y="-9272.38" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l1_gate_gpu0&#45;&gt;l1_expert6_gpu6 -->
<g id="edge295" class="edge">
<title>l1_gate_gpu0&#45;&gt;l1_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M24618.74,-9433.92C23848.36,-9431.53 17790.79,-9411.7 17759,-9379.67 17754.3,-9374.93 17754.32,-9369.42 17759,-9364.67 17795.94,-9327.14 21237.26,-9303.75 21815.1,-9300.09"/>
<polygon fill="black" stroke="black" points="21815.45,-9303.59 21825.42,-9300.02 21815.4,-9296.59 21815.45,-9303.59"/>
<text text-anchor="middle" x="17804.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l1_expert7_gpu7 -->
<g id="node328" class="node">
<title>l1_expert7_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="23311" cy="-9298.58" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="23311" y="-9317.38" font-family="Times,serif" font-size="14.00">L1 Expert7</text>
<text text-anchor="middle" x="23311" y="-9302.38" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="23311" y="-9287.38" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="23311" y="-9272.38" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l1_gate_gpu0&#45;&gt;l1_expert7_gpu7 -->
<g id="edge296" class="edge">
<title>l1_gate_gpu0&#45;&gt;l1_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M24618.85,-9434.09C23967.2,-9433.41 19560.91,-9427.07 19514,-9379.67 19509.31,-9374.93 19509.3,-9369.4 19514,-9364.67 19526.06,-9352.52 21960.89,-9347.03 21978,-9346.67 22452.13,-9336.56 23020.74,-9312.49 23229.24,-9303.27"/>
<polygon fill="black" stroke="black" points="23229.66,-9306.75 23239.49,-9302.81 23229.35,-9299.76 23229.66,-9306.75"/>
<text text-anchor="middle" x="19559.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l1_gate_gpu1&#45;&gt;l1_expert0_gpu0 -->
<g id="edge313" class="edge">
<title>l1_gate_gpu1&#45;&gt;l1_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M24822,-9407.81C24810.97,-9403.62 24799.3,-9399.92 24788,-9397.67 24743.3,-9388.73 21538.14,-9411.99 21506,-9379.67 21501.3,-9374.94 21501.31,-9369.4 21506,-9364.67 21524.43,-9346.05 23365.84,-9348.01 23392,-9346.67 23541.23,-9338.97 23714.66,-9320.6 23813.66,-9309.22"/>
<polygon fill="black" stroke="black" points="23814.35,-9312.66 23823.88,-9308.03 23813.55,-9305.7 23814.35,-9312.66"/>
<text text-anchor="middle" x="21551.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l1_gate_gpu1&#45;&gt;l1_expert1_gpu1 -->
<g id="edge314" class="edge">
<title>l1_gate_gpu1&#45;&gt;l1_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M24821.99,-9407.87C24810.96,-9403.68 24799.29,-9399.97 24788,-9397.67 24749.78,-9389.88 23411.4,-9407.42 23384,-9379.67 23379.32,-9374.92 23379.36,-9369.45 23384,-9364.67 23406.87,-9341.09 23942.2,-9348.53 23975,-9346.67 24147.42,-9336.85 24348.94,-9318.32 24458.33,-9307.67"/>
<polygon fill="black" stroke="black" points="24458.69,-9311.15 24468.3,-9306.69 24458.01,-9304.18 24458.69,-9311.15"/>
<text text-anchor="middle" x="23429.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l1_gate_gpu1&#45;&gt;l1_expert2_gpu2 -->
<g id="edge315" class="edge">
<title>l1_gate_gpu1&#45;&gt;l1_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M24932.01,-9407.83C24943.03,-9403.64 24954.7,-9399.94 24966,-9397.67 24995.29,-9391.77 27095.96,-9400.88 27117,-9379.67 27179.67,-9316.47 27023.07,-9302.35 26919.92,-9299.68"/>
<polygon fill="black" stroke="black" points="26919.88,-9296.18 26909.8,-9299.45 26919.72,-9303.17 26919.88,-9296.18"/>
<text text-anchor="middle" x="27170.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l1_gate_gpu1&#45;&gt;l1_expert3_gpu3 -->
<g id="edge316" class="edge">
<title>l1_gate_gpu1&#45;&gt;l1_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M24932.6,-9408.17C24943.47,-9404 24954.94,-9400.23 24966,-9397.67 25084.46,-9370.24 25125.5,-9423.3 25239,-9379.67 25249.04,-9375.8 25248.11,-9368.91 25258,-9364.67 25322.99,-9336.75 25516.97,-9316.13 25628.55,-9306.2"/>
<polygon fill="black" stroke="black" points="25629.1,-9309.66 25638.75,-9305.3 25628.49,-9302.69 25629.1,-9309.66"/>
<text text-anchor="middle" x="25303.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l1_gate_gpu1&#45;&gt;l1_expert4_gpu4 -->
<g id="edge317" class="edge">
<title>l1_gate_gpu1&#45;&gt;l1_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M24932,-9407.79C24943.02,-9403.6 24954.7,-9399.91 24966,-9397.67 25006.23,-9389.67 30844.04,-9408.72 30873,-9379.67 30877.71,-9374.94 30877.59,-9369.5 30873,-9364.67 30832.81,-9322.33 29978.04,-9305.18 29706.81,-9300.79"/>
<polygon fill="black" stroke="black" points="29706.7,-9297.28 29696.64,-9300.62 29706.58,-9304.28 29706.7,-9297.28"/>
<text text-anchor="middle" x="30921.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l1_gate_gpu1&#45;&gt;l1_expert5_gpu5 -->
<g id="edge318" class="edge">
<title>l1_gate_gpu1&#45;&gt;l1_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M24932,-9407.8C24943.02,-9403.61 24954.7,-9399.92 24966,-9397.67 24993.44,-9392.19 28975.26,-9399.49 28995,-9379.67 28999.7,-9374.94 28999.55,-9369.54 28995,-9364.67 28938.17,-9303.69 28367.87,-9298.78 28152.11,-9299.12"/>
<polygon fill="black" stroke="black" points="28151.79,-9295.63 28141.8,-9299.15 28151.81,-9302.63 28151.79,-9295.63"/>
<text text-anchor="middle" x="29043.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l1_gate_gpu1&#45;&gt;l1_expert6_gpu6 -->
<g id="edge319" class="edge">
<title>l1_gate_gpu1&#45;&gt;l1_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M24822,-9407.78C24810.98,-9403.59 24799.3,-9399.91 24788,-9397.67 24764.45,-9392.99 17889.96,-9396.67 17873,-9379.67 17868.29,-9374.95 17868.32,-9369.42 17873,-9364.67 17908.86,-9328.22 21246.58,-9303.99 21815.11,-9300.13"/>
<polygon fill="black" stroke="black" points="21815.3,-9303.62 21825.27,-9300.06 21815.25,-9296.62 21815.3,-9303.62"/>
<text text-anchor="middle" x="17918.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l1_gate_gpu1&#45;&gt;l1_expert7_gpu7 -->
<g id="edge320" class="edge">
<title>l1_gate_gpu1&#45;&gt;l1_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M24822,-9407.79C24810.98,-9403.6 24799.3,-9399.91 24788,-9397.67 24752.85,-9390.67 19653.29,-9405.05 19628,-9379.67 19623.29,-9374.94 19623.3,-9369.4 19628,-9364.67 19639.5,-9353.08 21961.68,-9347.02 21978,-9346.67 22452.12,-9336.48 23020.74,-9312.46 23229.24,-9303.26"/>
<polygon fill="black" stroke="black" points="23229.66,-9306.74 23239.49,-9302.8 23229.35,-9299.75 23229.66,-9306.74"/>
<text text-anchor="middle" x="19673.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l1_gate_gpu2&#45;&gt;l1_expert0_gpu0 -->
<g id="edge337" class="edge">
<title>l1_gate_gpu2&#45;&gt;l1_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25000,-9407.81C24988.97,-9403.62 24977.3,-9399.92 24966,-9397.67 24943.21,-9393.11 21636.39,-9396.14 21620,-9379.67 21615.3,-9374.94 21615.31,-9369.4 21620,-9364.67 21637.31,-9347.17 23367.42,-9347.94 23392,-9346.67 23541.23,-9338.92 23714.66,-9320.57 23813.66,-9309.2"/>
<polygon fill="black" stroke="black" points="23814.35,-9312.64 23823.88,-9308.02 23813.55,-9305.69 23814.35,-9312.64"/>
<text text-anchor="middle" x="21665.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l1_gate_gpu2&#45;&gt;l1_expert1_gpu1 -->
<g id="edge338" class="edge">
<title>l1_gate_gpu2&#45;&gt;l1_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M24999.99,-9407.87C24988.96,-9403.67 24977.29,-9399.96 24966,-9397.67 24926.04,-9389.53 23526.66,-9408.68 23498,-9379.67 23493.31,-9374.92 23493.38,-9369.47 23498,-9364.67 23516.39,-9345.56 23948.53,-9348.27 23975,-9346.67 24147.38,-9336.22 24348.92,-9317.93 24458.32,-9307.48"/>
<polygon fill="black" stroke="black" points="24458.67,-9310.96 24468.29,-9306.53 24458,-9304 24458.67,-9310.96"/>
<text text-anchor="middle" x="23543.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l1_gate_gpu2&#45;&gt;l1_expert2_gpu2 -->
<g id="edge339" class="edge">
<title>l1_gate_gpu2&#45;&gt;l1_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25110.01,-9407.84C25121.03,-9403.64 25132.7,-9399.94 25144,-9397.67 25172.42,-9391.94 27210.59,-9400.25 27231,-9379.67 27276.7,-9333.57 27047.36,-9312.14 26919.38,-9303.9"/>
<polygon fill="black" stroke="black" points="26919.41,-9300.39 26909.21,-9303.25 26918.97,-9307.38 26919.41,-9300.39"/>
<text text-anchor="middle" x="27281.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l1_gate_gpu2&#45;&gt;l1_expert3_gpu3 -->
<g id="edge340" class="edge">
<title>l1_gate_gpu2&#45;&gt;l1_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25111.12,-9408.16C25121.85,-9404.05 25133.13,-9400.3 25144,-9397.67 25234.61,-9375.73 25266.32,-9414 25353,-9379.67 25363,-9375.7 25362.22,-9369.14 25372,-9364.67 25454.48,-9326.91 25557.97,-9311.05 25628.57,-9304.39"/>
<polygon fill="black" stroke="black" points="25629.09,-9307.86 25638.74,-9303.47 25628.46,-9300.88 25629.09,-9307.86"/>
<text text-anchor="middle" x="25417.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l1_gate_gpu2&#45;&gt;l1_expert4_gpu4 -->
<g id="edge341" class="edge">
<title>l1_gate_gpu2&#45;&gt;l1_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25110,-9407.79C25121.02,-9403.6 25132.7,-9399.91 25144,-9397.67 25183.8,-9389.76 30958.35,-9408.4 30987,-9379.67 30991.71,-9374.94 30991.6,-9369.49 30987,-9364.67 30942.68,-9318.17 29994.28,-9303.73 29706.85,-9300.41"/>
<polygon fill="black" stroke="black" points="29706.53,-9296.91 29696.5,-9300.3 29706.45,-9303.91 29706.53,-9296.91"/>
<text text-anchor="middle" x="31035.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l1_gate_gpu2&#45;&gt;l1_expert5_gpu5 -->
<g id="edge342" class="edge">
<title>l1_gate_gpu2&#45;&gt;l1_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25110,-9407.8C25121.02,-9403.61 25132.7,-9399.92 25144,-9397.67 25171,-9392.28 29089.57,-9399.18 29109,-9379.67 29177.14,-9311.22 28408.68,-9301.24 28151.89,-9299.81"/>
<polygon fill="black" stroke="black" points="28151.53,-9296.31 28141.51,-9299.76 28151.49,-9303.31 28151.53,-9296.31"/>
<text text-anchor="middle" x="29158.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l1_gate_gpu2&#45;&gt;l1_expert6_gpu6 -->
<g id="edge343" class="edge">
<title>l1_gate_gpu2&#45;&gt;l1_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25000,-9407.78C24988.98,-9403.59 24977.3,-9399.91 24966,-9397.67 24942.23,-9392.95 18004.11,-9396.82 17987,-9379.67 17982.29,-9374.95 17982.33,-9369.42 17987,-9364.67 18056.55,-9293.95 21259.14,-9298.11 21815.15,-9299.37"/>
<polygon fill="black" stroke="black" points="21815.47,-9302.87 21825.48,-9299.39 21815.49,-9295.87 21815.47,-9302.87"/>
<text text-anchor="middle" x="18032.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l1_gate_gpu2&#45;&gt;l1_expert7_gpu7 -->
<g id="edge344" class="edge">
<title>l1_gate_gpu2&#45;&gt;l1_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25000,-9407.79C24988.98,-9403.6 24977.3,-9399.91 24966,-9397.67 24930.42,-9390.59 19767.61,-9405.36 19742,-9379.67 19737.29,-9374.94 19737.3,-9369.4 19742,-9364.67 19752.94,-9353.64 21962.48,-9347 21978,-9346.67 22452.12,-9336.39 23020.74,-9312.42 23229.24,-9303.25"/>
<polygon fill="black" stroke="black" points="23229.66,-9306.73 23239.49,-9302.79 23229.35,-9299.74 23229.66,-9306.73"/>
<text text-anchor="middle" x="19787.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l1_gate_gpu3&#45;&gt;l1_expert0_gpu0 -->
<g id="edge361" class="edge">
<title>l1_gate_gpu3&#45;&gt;l1_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25178,-9407.81C25166.97,-9403.62 25155.3,-9399.92 25144,-9397.67 25120.78,-9393.02 21750.7,-9396.45 21734,-9379.67 21729.3,-9374.94 21729.31,-9369.4 21734,-9364.67 21750.2,-9348.29 23369,-9347.87 23392,-9346.67 23541.23,-9338.87 23714.66,-9320.54 23813.66,-9309.18"/>
<polygon fill="black" stroke="black" points="23814.35,-9312.63 23823.88,-9308 23813.55,-9305.67 23814.35,-9312.63"/>
<text text-anchor="middle" x="21779.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l1_gate_gpu3&#45;&gt;l1_expert1_gpu1 -->
<g id="edge362" class="edge">
<title>l1_gate_gpu3&#45;&gt;l1_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25177.99,-9407.86C25166.96,-9403.67 25155.29,-9399.96 25144,-9397.67 25102.29,-9389.19 23641.92,-9409.93 23612,-9379.67 23607.31,-9374.92 23607.4,-9369.49 23612,-9364.67 23625.92,-9350.04 23954.85,-9348.01 23975,-9346.67 24147.32,-9335.2 24348.88,-9317.29 24458.3,-9307.18"/>
<polygon fill="black" stroke="black" points="24458.64,-9310.66 24468.27,-9306.26 24457.99,-9303.69 24458.64,-9310.66"/>
<text text-anchor="middle" x="23657.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l1_gate_gpu3&#45;&gt;l1_expert2_gpu2 -->
<g id="edge363" class="edge">
<title>l1_gate_gpu3&#45;&gt;l1_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25288.01,-9407.84C25299.03,-9403.65 25310.7,-9399.94 25322,-9397.67 25349.54,-9392.11 27325.22,-9399.62 27345,-9379.67 27406.34,-9317.77 27078.03,-9303.71 26919.64,-9300.52"/>
<polygon fill="black" stroke="black" points="26919.53,-9297.01 26909.46,-9300.32 26919.39,-9304.01 26919.53,-9297.01"/>
<text text-anchor="middle" x="27397.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l1_gate_gpu3&#45;&gt;l1_expert3_gpu3 -->
<g id="edge364" class="edge">
<title>l1_gate_gpu3&#45;&gt;l1_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25289.68,-9408.31C25300.26,-9404.24 25311.34,-9400.46 25322,-9397.67 25384.82,-9381.2 25407.08,-9404.71 25467,-9379.67 25476.93,-9375.52 25476.43,-9369.59 25486,-9364.67 25531.69,-9341.14 25587.13,-9324.94 25631.42,-9314.59"/>
<polygon fill="black" stroke="black" points="25632.3,-9317.98 25641.27,-9312.34 25630.74,-9311.16 25632.3,-9317.98"/>
<text text-anchor="middle" x="25531.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l1_gate_gpu3&#45;&gt;l1_expert4_gpu4 -->
<g id="edge365" class="edge">
<title>l1_gate_gpu3&#45;&gt;l1_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25288,-9407.79C25299.02,-9403.6 25310.7,-9399.91 25322,-9397.67 25361.36,-9389.84 31072.67,-9408.09 31101,-9379.67 31105.71,-9374.94 31105.61,-9369.48 31101,-9364.67 31052.51,-9313.99 30009.03,-9302.4 29706.51,-9300.1"/>
<polygon fill="black" stroke="black" points="29706.52,-9296.6 29696.5,-9300.02 29706.47,-9303.6 29706.52,-9296.6"/>
<text text-anchor="middle" x="31149.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l1_gate_gpu3&#45;&gt;l1_expert5_gpu5 -->
<g id="edge366" class="edge">
<title>l1_gate_gpu3&#45;&gt;l1_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25288,-9407.8C25299.03,-9403.61 25310.7,-9399.92 25322,-9397.67 25348.57,-9392.37 29203.89,-9398.87 29223,-9379.67 29299.39,-9302.92 28427.27,-9298.66 28151.83,-9299.21"/>
<polygon fill="black" stroke="black" points="28151.49,-9295.71 28141.5,-9299.23 28151.51,-9302.71 28151.49,-9295.71"/>
<text text-anchor="middle" x="29272.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l1_gate_gpu3&#45;&gt;l1_expert6_gpu6 -->
<g id="edge367" class="edge">
<title>l1_gate_gpu3&#45;&gt;l1_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25178,-9407.78C25166.98,-9403.59 25155.3,-9399.91 25144,-9397.67 25120.01,-9392.91 18118.27,-9396.98 18101,-9379.67 18096.29,-9374.95 18096.33,-9369.42 18101,-9364.67 18168.4,-9296.1 21267.83,-9298.46 21814.93,-9299.41"/>
<polygon fill="black" stroke="black" points="21815.1,-9302.91 21825.11,-9299.43 21815.11,-9295.91 21815.1,-9302.91"/>
<text text-anchor="middle" x="18146.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l1_gate_gpu3&#45;&gt;l1_expert7_gpu7 -->
<g id="edge368" class="edge">
<title>l1_gate_gpu3&#45;&gt;l1_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25178,-9407.79C25166.98,-9403.6 25155.3,-9399.91 25144,-9397.67 25107.98,-9390.5 19881.92,-9405.68 19856,-9379.67 19851.29,-9374.94 19851.31,-9369.4 19856,-9364.67 19876.75,-9343.74 21948.53,-9347.31 21978,-9346.67 22452.12,-9336.28 23020.73,-9312.38 23229.24,-9303.23"/>
<polygon fill="black" stroke="black" points="23229.66,-9306.72 23239.49,-9302.78 23229.35,-9299.73 23229.66,-9306.72"/>
<text text-anchor="middle" x="19901.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l1_gate_gpu4&#45;&gt;l1_expert0_gpu0 -->
<g id="edge385" class="edge">
<title>l1_gate_gpu4&#45;&gt;l1_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25356,-9407.8C25344.97,-9403.61 25333.3,-9399.92 25322,-9397.67 25298.34,-9392.94 21865.01,-9396.77 21848,-9379.67 21843.3,-9374.94 21843.31,-9369.41 21848,-9364.67 21863.08,-9349.41 23370.58,-9347.79 23392,-9346.67 23541.22,-9338.81 23714.65,-9320.5 23813.65,-9309.16"/>
<polygon fill="black" stroke="black" points="23814.35,-9312.61 23823.88,-9307.99 23813.55,-9305.65 23814.35,-9312.61"/>
<text text-anchor="middle" x="21893.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l1_gate_gpu4&#45;&gt;l1_expert1_gpu1 -->
<g id="edge386" class="edge">
<title>l1_gate_gpu4&#45;&gt;l1_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25355.99,-9407.86C25344.96,-9403.67 25333.29,-9399.96 25322,-9397.67 25278.55,-9388.85 23757.17,-9411.19 23726,-9379.67 23721.31,-9374.92 23721.46,-9369.55 23726,-9364.67 23744.89,-9344.36 23947.34,-9348.82 23975,-9346.67 24147.18,-9333.26 24348.79,-9316.07 24458.26,-9306.61"/>
<polygon fill="black" stroke="black" points="24458.58,-9310.09 24468.24,-9305.74 24457.97,-9303.12 24458.58,-9310.09"/>
<text text-anchor="middle" x="23771.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l1_gate_gpu4&#45;&gt;l1_expert2_gpu2 -->
<g id="edge387" class="edge">
<title>l1_gate_gpu4&#45;&gt;l1_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25466.01,-9407.84C25477.03,-9403.65 25488.7,-9399.95 25500,-9397.67 25526.67,-9392.28 27439.85,-9398.99 27459,-9379.67 27463.69,-9374.93 27463.46,-9369.62 27459,-9364.67 27423.55,-9325.31 27080.22,-9308.11 26919.82,-9302.18"/>
<polygon fill="black" stroke="black" points="26919.64,-9298.67 26909.52,-9301.8 26919.39,-9305.66 26919.64,-9298.67"/>
<text text-anchor="middle" x="27507.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l1_gate_gpu4&#45;&gt;l1_expert3_gpu3 -->
<g id="edge388" class="edge">
<title>l1_gate_gpu4&#45;&gt;l1_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25468.4,-9408.95C25478.81,-9404.87 25489.64,-9400.91 25500,-9397.67 25535.19,-9386.63 25547.69,-9395.49 25581,-9379.67 25590.72,-9375.05 25591.13,-9370.75 25600,-9364.67 25614.68,-9354.59 25630.97,-9344.44 25646.41,-9335.24"/>
<polygon fill="black" stroke="black" points="25648.55,-9338.05 25655.39,-9329.95 25645,-9332.02 25648.55,-9338.05"/>
<text text-anchor="middle" x="25645.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l1_gate_gpu4&#45;&gt;l1_expert4_gpu4 -->
<g id="edge389" class="edge">
<title>l1_gate_gpu4&#45;&gt;l1_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25466,-9407.79C25477.02,-9403.6 25488.7,-9399.91 25500,-9397.67 25538.93,-9389.93 31186.98,-9407.77 31215,-9379.67 31219.71,-9374.94 31219.62,-9369.47 31215,-9364.67 31162.35,-9309.81 30024.17,-9301.17 29706.62,-9299.83"/>
<polygon fill="black" stroke="black" points="29706.58,-9296.33 29696.57,-9299.79 29706.55,-9303.33 29706.58,-9296.33"/>
<text text-anchor="middle" x="31263.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l1_gate_gpu4&#45;&gt;l1_expert5_gpu5 -->
<g id="edge390" class="edge">
<title>l1_gate_gpu4&#45;&gt;l1_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25466,-9407.8C25477.03,-9403.61 25488.7,-9399.92 25500,-9397.67 25526.13,-9392.45 29318.2,-9398.55 29337,-9379.67 29341.7,-9374.94 29341.59,-9369.5 29337,-9364.67 29296.14,-9321.65 28426.41,-9304.94 28152.11,-9300.72"/>
<polygon fill="black" stroke="black" points="28151.88,-9297.22 28141.83,-9300.57 28151.77,-9304.22 28151.88,-9297.22"/>
<text text-anchor="middle" x="29385.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l1_gate_gpu4&#45;&gt;l1_expert6_gpu6 -->
<g id="edge391" class="edge">
<title>l1_gate_gpu4&#45;&gt;l1_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25356,-9407.78C25344.98,-9403.59 25333.3,-9399.91 25322,-9397.67 25297.79,-9392.86 18232.43,-9397.14 18215,-9379.67 18210.29,-9374.95 18210.33,-9369.42 18215,-9364.67 18280.25,-9298.25 21277.26,-9298.82 21814.87,-9299.46"/>
<polygon fill="black" stroke="black" points="21815.24,-9302.96 21825.25,-9299.47 21815.25,-9295.96 21815.24,-9302.96"/>
<text text-anchor="middle" x="18260.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l1_gate_gpu4&#45;&gt;l1_expert7_gpu7 -->
<g id="edge392" class="edge">
<title>l1_gate_gpu4&#45;&gt;l1_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25356,-9407.79C25344.98,-9403.6 25333.3,-9399.91 25322,-9397.67 25285.55,-9390.42 19996.24,-9405.99 19970,-9379.67 19965.29,-9374.94 19965.31,-9369.4 19970,-9364.67 19989.63,-9344.86 21950.12,-9347.28 21978,-9346.67 22452.12,-9336.17 23020.73,-9312.33 23229.24,-9303.22"/>
<polygon fill="black" stroke="black" points="23229.65,-9306.71 23239.49,-9302.77 23229.35,-9299.71 23229.65,-9306.71"/>
<text text-anchor="middle" x="20015.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l1_gate_gpu5&#45;&gt;l1_expert0_gpu0 -->
<g id="edge409" class="edge">
<title>l1_gate_gpu5&#45;&gt;l1_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25534,-9407.8C25522.97,-9403.61 25511.3,-9399.92 25500,-9397.67 25475.91,-9392.85 21979.33,-9397.08 21962,-9379.67 21957.3,-9374.94 21957.32,-9369.41 21962,-9364.67 21975.96,-9350.53 23372.17,-9347.72 23392,-9346.67 23541.16,-9338.74 23714.51,-9320.46 23813.53,-9309.15"/>
<polygon fill="black" stroke="black" points="23813.93,-9312.63 23823.47,-9308.01 23813.13,-9305.68 23813.93,-9312.63"/>
<text text-anchor="middle" x="22007.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l1_gate_gpu5&#45;&gt;l1_expert1_gpu1 -->
<g id="edge410" class="edge">
<title>l1_gate_gpu5&#45;&gt;l1_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25533.99,-9407.86C25522.96,-9403.66 25511.29,-9399.95 25500,-9397.67 25454.81,-9388.5 23872.43,-9412.45 23840,-9379.67 23835.31,-9374.93 23835.51,-9369.59 23840,-9364.67 23845.17,-9358.99 24275.01,-9321.95 24457.99,-9306.42"/>
<polygon fill="black" stroke="black" points="24458.43,-9309.89 24468.1,-9305.56 24457.84,-9302.92 24458.43,-9309.89"/>
<text text-anchor="middle" x="23885.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l1_gate_gpu5&#45;&gt;l1_expert2_gpu2 -->
<g id="edge411" class="edge">
<title>l1_gate_gpu5&#45;&gt;l1_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25644.01,-9407.84C25655.03,-9403.65 25666.7,-9399.95 25678,-9397.67 25703.8,-9392.45 27554.48,-9398.36 27573,-9379.67 27577.69,-9374.93 27577.5,-9369.58 27573,-9364.67 27529.57,-9317.22 27101.95,-9304.16 26919.65,-9300.74"/>
<polygon fill="black" stroke="black" points="26919.64,-9297.24 26909.58,-9300.55 26919.51,-9304.24 26919.64,-9297.24"/>
<text text-anchor="middle" x="27621.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l1_gate_gpu5&#45;&gt;l1_expert3_gpu3 -->
<g id="edge412" class="edge">
<title>l1_gate_gpu5&#45;&gt;l1_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25653.36,-9412.72C25669.09,-9404.64 25684.43,-9393.85 25695,-9379.67 25700.04,-9372.9 25703.55,-9364.94 25705.96,-9356.71"/>
<polygon fill="black" stroke="black" points="25709.37,-9357.52 25708.32,-9346.97 25702.57,-9355.87 25709.37,-9357.52"/>
<text text-anchor="middle" x="25747.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l1_gate_gpu5&#45;&gt;l1_expert4_gpu4 -->
<g id="edge413" class="edge">
<title>l1_gate_gpu5&#45;&gt;l1_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25644,-9407.79C25655.02,-9403.6 25666.7,-9399.91 25678,-9397.67 25716.49,-9390.02 31301.3,-9407.46 31329,-9379.67 31333.71,-9374.94 31333.62,-9369.47 31329,-9364.67 31272.17,-9305.62 30038.51,-9300.03 29706.6,-9299.59"/>
<polygon fill="black" stroke="black" points="29706.58,-9296.09 29696.58,-9299.58 29706.58,-9303.09 29706.58,-9296.09"/>
<text text-anchor="middle" x="31377.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l1_gate_gpu5&#45;&gt;l1_expert5_gpu5 -->
<g id="edge414" class="edge">
<title>l1_gate_gpu5&#45;&gt;l1_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25644,-9407.8C25655.03,-9403.61 25666.7,-9399.92 25678,-9397.67 25703.69,-9392.54 29432.52,-9398.24 29451,-9379.67 29455.7,-9374.94 29455.6,-9369.49 29451,-9364.67 29405.97,-9317.47 28441.29,-9303.49 28151.56,-9300.35"/>
<polygon fill="black" stroke="black" points="28151.58,-9296.85 28141.55,-9300.25 28151.51,-9303.85 28151.58,-9296.85"/>
<text text-anchor="middle" x="29499.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l1_gate_gpu5&#45;&gt;l1_expert6_gpu6 -->
<g id="edge415" class="edge">
<title>l1_gate_gpu5&#45;&gt;l1_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25534,-9407.78C25522.98,-9403.59 25511.3,-9399.91 25500,-9397.67 25475.58,-9392.82 18346.58,-9397.29 18329,-9379.67 18324.29,-9374.95 18324.33,-9369.42 18329,-9364.67 18392.13,-9300.37 21288.71,-9299.19 21815.32,-9299.5"/>
<polygon fill="black" stroke="black" points="21815.48,-9303 21825.49,-9299.51 21815.49,-9296 21815.48,-9303"/>
<text text-anchor="middle" x="18374.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l1_gate_gpu5&#45;&gt;l1_expert7_gpu7 -->
<g id="edge416" class="edge">
<title>l1_gate_gpu5&#45;&gt;l1_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25534,-9407.79C25522.98,-9403.6 25511.3,-9399.91 25500,-9397.67 25463.11,-9390.33 20110.55,-9406.3 20084,-9379.67 20079.29,-9374.94 20079.31,-9369.4 20084,-9364.67 20102.51,-9345.98 21951.7,-9347.25 21978,-9346.67 22452.12,-9336.04 23020.73,-9312.28 23229.24,-9303.2"/>
<polygon fill="black" stroke="black" points="23229.65,-9306.69 23239.49,-9302.76 23229.35,-9299.7 23229.65,-9306.69"/>
<text text-anchor="middle" x="20129.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l1_gate_gpu6&#45;&gt;l1_expert0_gpu0 -->
<g id="edge433" class="edge">
<title>l1_gate_gpu6&#45;&gt;l1_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25712,-9407.8C25700.97,-9403.61 25689.3,-9399.92 25678,-9397.67 25653.47,-9392.77 22093.64,-9397.4 22076,-9379.67 22071.3,-9374.94 22071.32,-9369.41 22076,-9364.67 22088.84,-9351.65 23373.75,-9347.64 23392,-9346.67 23541.16,-9338.66 23714.51,-9320.41 23813.53,-9309.13"/>
<polygon fill="black" stroke="black" points="23813.93,-9312.6 23823.47,-9307.99 23813.13,-9305.65 23813.93,-9312.6"/>
<text text-anchor="middle" x="22121.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l1_gate_gpu6&#45;&gt;l1_expert1_gpu1 -->
<g id="edge434" class="edge">
<title>l1_gate_gpu6&#45;&gt;l1_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25711.99,-9407.85C25700.97,-9403.66 25689.29,-9399.95 25678,-9397.67 25654.53,-9392.91 23970.84,-9396.69 23954,-9379.67 23949.31,-9374.93 23949.55,-9369.63 23954,-9364.67 23986.95,-9327.84 24304.09,-9309.51 24457.15,-9302.75"/>
<polygon fill="black" stroke="black" points="24457.6,-9306.23 24467.43,-9302.3 24457.29,-9299.24 24457.6,-9306.23"/>
<text text-anchor="middle" x="23999.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l1_gate_gpu6&#45;&gt;l1_expert2_gpu2 -->
<g id="edge435" class="edge">
<title>l1_gate_gpu6&#45;&gt;l1_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25822.01,-9407.85C25833.03,-9403.65 25844.71,-9399.95 25856,-9397.67 25880.93,-9392.62 27669.11,-9397.74 27687,-9379.67 27691.69,-9374.93 27691.53,-9369.56 27687,-9364.67 27635.56,-9309.13 27123,-9300.8 26920.08,-9299.69"/>
<polygon fill="black" stroke="black" points="26919.8,-9296.19 26909.78,-9299.64 26919.77,-9303.19 26919.8,-9296.19"/>
<text text-anchor="middle" x="27735.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l1_gate_gpu6&#45;&gt;l1_expert3_gpu3 -->
<g id="edge436" class="edge">
<title>l1_gate_gpu6&#45;&gt;l1_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25802.74,-9401.32C25810.94,-9389.86 25815.56,-9376.83 25809,-9364.67 25801.75,-9351.23 25790.38,-9340.11 25777.89,-9331.09"/>
<polygon fill="black" stroke="black" points="25779.8,-9328.16 25769.55,-9325.47 25775.89,-9333.96 25779.8,-9328.16"/>
<text text-anchor="middle" x="25857.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l1_gate_gpu6&#45;&gt;l1_expert4_gpu4 -->
<g id="edge437" class="edge">
<title>l1_gate_gpu6&#45;&gt;l1_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25822,-9407.79C25833.02,-9403.6 25844.7,-9399.91 25856,-9397.67 25894.05,-9390.1 31415.61,-9407.14 31443,-9379.67 31447.71,-9374.94 31447.63,-9369.46 31443,-9364.67 31381.99,-9301.43 30052.97,-9298.96 29706.82,-9299.39"/>
<polygon fill="black" stroke="black" points="29706.62,-9295.89 29696.63,-9299.4 29706.63,-9302.89 29706.62,-9295.89"/>
<text text-anchor="middle" x="31491.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l1_gate_gpu6&#45;&gt;l1_expert5_gpu5 -->
<g id="edge438" class="edge">
<title>l1_gate_gpu6&#45;&gt;l1_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25822,-9407.8C25833.03,-9403.61 25844.7,-9399.92 25856,-9397.67 25881.26,-9392.62 29546.83,-9397.92 29565,-9379.67 29569.7,-9374.94 29569.61,-9369.48 29565,-9364.67 29515.84,-9313.32 28457.78,-9302.2 28152.04,-9300.05"/>
<polygon fill="black" stroke="black" points="28151.94,-9296.55 28141.92,-9299.98 28151.9,-9303.55 28151.94,-9296.55"/>
<text text-anchor="middle" x="29613.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l1_gate_gpu6&#45;&gt;l1_expert6_gpu6 -->
<g id="edge439" class="edge">
<title>l1_gate_gpu6&#45;&gt;l1_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25712,-9407.78C25700.98,-9403.59 25689.3,-9399.91 25678,-9397.67 25653.36,-9392.78 18460.74,-9397.45 18443,-9379.67 18438.29,-9374.95 18438.33,-9369.42 18443,-9364.67 18503.98,-9302.52 21297.79,-9299.57 21815.08,-9299.55"/>
<polygon fill="black" stroke="black" points="21815.44,-9303.05 21825.44,-9299.55 21815.44,-9296.05 21815.44,-9303.05"/>
<text text-anchor="middle" x="18488.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l1_gate_gpu6&#45;&gt;l1_expert7_gpu7 -->
<g id="edge440" class="edge">
<title>l1_gate_gpu6&#45;&gt;l1_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25712,-9407.79C25700.98,-9403.6 25689.3,-9399.91 25678,-9397.67 25640.67,-9390.25 20224.87,-9406.62 20198,-9379.67 20193.29,-9374.94 20193.31,-9369.4 20198,-9364.67 20215.39,-9347.09 21953.28,-9347.23 21978,-9346.67 22452.11,-9335.9 23020.73,-9312.23 23229.24,-9303.19"/>
<polygon fill="black" stroke="black" points="23229.65,-9306.67 23239.49,-9302.74 23229.35,-9299.68 23229.65,-9306.67"/>
<text text-anchor="middle" x="20243.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l1_gate_gpu7&#45;&gt;l1_expert0_gpu0 -->
<g id="edge457" class="edge">
<title>l1_gate_gpu7&#45;&gt;l1_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25890,-9407.8C25878.97,-9403.61 25867.3,-9399.92 25856,-9397.67 25831.03,-9392.68 22207.96,-9397.71 22190,-9379.67 22185.3,-9374.94 22185.32,-9369.41 22190,-9364.67 22213.43,-9340.88 23358.66,-9348.48 23392,-9346.67 23541,-9338.57 23714.16,-9320.38 23813.23,-9309.13"/>
<polygon fill="black" stroke="black" points="23813.93,-9312.57 23823.46,-9307.96 23813.13,-9305.62 23813.93,-9312.57"/>
<text text-anchor="middle" x="22235.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l1_gate_gpu7&#45;&gt;l1_expert1_gpu1 -->
<g id="edge458" class="edge">
<title>l1_gate_gpu7&#45;&gt;l1_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25889.99,-9407.85C25878.97,-9403.66 25867.29,-9399.95 25856,-9397.67 25831.66,-9392.74 24085.47,-9397.31 24068,-9379.67 24011.67,-9322.76 24308.18,-9306.14 24457.38,-9301.41"/>
<polygon fill="black" stroke="black" points="24457.54,-9304.9 24467.43,-9301.1 24457.32,-9297.91 24457.54,-9304.9"/>
<text text-anchor="middle" x="24113.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l1_gate_gpu7&#45;&gt;l1_expert2_gpu2 -->
<g id="edge459" class="edge">
<title>l1_gate_gpu7&#45;&gt;l1_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26000.01,-9407.85C26011.03,-9403.66 26022.71,-9399.95 26034,-9397.67 26058.06,-9392.8 27783.73,-9397.11 27801,-9379.67 27863.5,-9316.52 27163.19,-9303.04 26919.69,-9300.27"/>
<polygon fill="black" stroke="black" points="26919.52,-9296.77 26909.48,-9300.16 26919.44,-9303.77 26919.52,-9296.77"/>
<text text-anchor="middle" x="27849.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l1_gate_gpu7&#45;&gt;l1_expert3_gpu3 -->
<g id="edge460" class="edge">
<title>l1_gate_gpu7&#45;&gt;l1_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25931.63,-9398C25925.67,-9386 25917.56,-9373.47 25907,-9364.67 25873.98,-9337.15 25828.94,-9321.14 25790.25,-9311.89"/>
<polygon fill="black" stroke="black" points="25790.58,-9308.38 25780.05,-9309.57 25789.02,-9315.2 25790.58,-9308.38"/>
<text text-anchor="middle" x="25965.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l1_gate_gpu7&#45;&gt;l1_expert4_gpu4 -->
<g id="edge461" class="edge">
<title>l1_gate_gpu7&#45;&gt;l1_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26000,-9407.79C26011.02,-9403.6 26022.7,-9399.91 26034,-9397.67 26071.62,-9390.19 31529.92,-9406.83 31557,-9379.67 31561.71,-9374.94 31561.63,-9369.46 31557,-9364.67 31491.78,-9297.21 30065.79,-9297.94 29706.57,-9299.21"/>
<polygon fill="black" stroke="black" points="29706.5,-9295.71 29696.51,-9299.24 29706.52,-9302.71 29706.5,-9295.71"/>
<text text-anchor="middle" x="31605.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l1_gate_gpu7&#45;&gt;l1_expert5_gpu5 -->
<g id="edge462" class="edge">
<title>l1_gate_gpu7&#45;&gt;l1_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26000,-9407.8C26011.03,-9403.61 26022.7,-9399.92 26034,-9397.67 26058.82,-9392.71 29661.15,-9397.61 29679,-9379.67 29683.7,-9374.94 29683.62,-9369.47 29679,-9364.67 29652.29,-9336.85 28475.47,-9308.62 28151.7,-9301.36"/>
<polygon fill="black" stroke="black" points="28151.53,-9297.86 28141.45,-9301.14 28151.37,-9304.86 28151.53,-9297.86"/>
<text text-anchor="middle" x="29727.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l1_gate_gpu7&#45;&gt;l1_expert6_gpu6 -->
<g id="edge463" class="edge">
<title>l1_gate_gpu7&#45;&gt;l1_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25890,-9407.78C25878.98,-9403.59 25867.3,-9399.91 25856,-9397.67 25831.14,-9392.73 18574.9,-9397.61 18557,-9379.67 18552.29,-9374.95 18552.33,-9369.42 18557,-9364.67 18615.86,-9304.65 21308.91,-9299.96 21815.36,-9299.61"/>
<polygon fill="black" stroke="black" points="21815.51,-9303.11 21825.51,-9299.6 21815.5,-9296.11 21815.51,-9303.11"/>
<text text-anchor="middle" x="18602.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l1_gate_gpu7&#45;&gt;l1_expert7_gpu7 -->
<g id="edge464" class="edge">
<title>l1_gate_gpu7&#45;&gt;l1_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M25890,-9407.79C25878.98,-9403.6 25867.3,-9399.91 25856,-9397.67 25818.24,-9390.16 20339.18,-9406.93 20312,-9379.67 20307.29,-9374.94 20307.31,-9369.4 20312,-9364.67 20328.27,-9348.21 21954.87,-9347.2 21978,-9346.67 22452.11,-9335.73 23020.73,-9312.16 23229.24,-9303.17"/>
<polygon fill="black" stroke="black" points="23229.65,-9306.65 23239.49,-9302.72 23229.35,-9299.66 23229.65,-9306.65"/>
<text text-anchor="middle" x="20357.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l1_gate_gpu8&#45;&gt;l1_expert0_gpu0 -->
<g id="edge481" class="edge">
<title>l1_gate_gpu8&#45;&gt;l1_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26068,-9407.8C26056.97,-9403.61 26045.3,-9399.92 26034,-9397.67 26008.6,-9392.6 22322.27,-9398.03 22304,-9379.67 22299.3,-9374.94 22299.33,-9369.42 22304,-9364.67 22325.2,-9343.12 23361.82,-9348.33 23392,-9346.67 23540.99,-9338.46 23714.15,-9320.3 23813.23,-9309.09"/>
<polygon fill="black" stroke="black" points="23813.92,-9312.53 23823.46,-9307.93 23813.13,-9305.58 23813.92,-9312.53"/>
<text text-anchor="middle" x="22349.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l1_gate_gpu8&#45;&gt;l1_expert1_gpu1 -->
<g id="edge482" class="edge">
<title>l1_gate_gpu8&#45;&gt;l1_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26067.99,-9407.85C26056.97,-9403.65 26045.29,-9399.95 26034,-9397.67 26008.79,-9392.57 24200.1,-9397.94 24182,-9379.67 24141.18,-9338.44 24340.4,-9315.27 24457.87,-9305.38"/>
<polygon fill="black" stroke="black" points="24458.24,-9308.86 24467.92,-9304.55 24457.67,-9301.89 24458.24,-9308.86"/>
<text text-anchor="middle" x="24227.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l1_gate_gpu8&#45;&gt;l1_expert2_gpu2 -->
<g id="edge483" class="edge">
<title>l1_gate_gpu8&#45;&gt;l1_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26178.01,-9407.85C26189.03,-9403.66 26200.71,-9399.95 26212,-9397.67 26235.18,-9392.97 27898.36,-9396.48 27915,-9379.67 27985.64,-9308.27 27183.59,-9300.29 26920.18,-9299.58"/>
<polygon fill="black" stroke="black" points="26919.92,-9296.08 26909.92,-9299.56 26919.91,-9303.08 26919.92,-9296.08"/>
<text text-anchor="middle" x="27964.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l1_gate_gpu8&#45;&gt;l1_expert3_gpu3 -->
<g id="edge484" class="edge">
<title>l1_gate_gpu8&#45;&gt;l1_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26082.12,-9402.86C26062.7,-9389.32 26038.6,-9374.4 26015,-9364.67 25942.21,-9334.66 25853.72,-9317.74 25790.83,-9308.73"/>
<polygon fill="black" stroke="black" points="25790.97,-9305.21 25780.58,-9307.29 25790,-9312.14 25790.97,-9305.21"/>
<text text-anchor="middle" x="26088.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l1_gate_gpu8&#45;&gt;l1_expert4_gpu4 -->
<g id="edge485" class="edge">
<title>l1_gate_gpu8&#45;&gt;l1_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26178,-9407.79C26189.02,-9403.6 26200.7,-9399.91 26212,-9397.67 26249.18,-9390.27 31644.24,-9406.52 31671,-9379.67 31675.71,-9374.94 31675.64,-9369.45 31671,-9364.67 31636.24,-9328.79 30083.56,-9305.72 29706.74,-9300.64"/>
<polygon fill="black" stroke="black" points="29706.51,-9297.14 29696.47,-9300.5 29706.42,-9304.14 29706.51,-9297.14"/>
<text text-anchor="middle" x="31719.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l1_gate_gpu8&#45;&gt;l1_expert5_gpu5 -->
<g id="edge486" class="edge">
<title>l1_gate_gpu8&#45;&gt;l1_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26178,-9407.8C26189.03,-9403.61 26200.7,-9399.92 26212,-9397.67 26236.39,-9392.8 29775.46,-9397.29 29793,-9379.67 29797.7,-9374.94 29797.62,-9369.47 29793,-9364.67 29778.58,-9349.69 28491.24,-9311.68 28151.46,-9301.9"/>
<polygon fill="black" stroke="black" points="28151.55,-9298.41 28141.45,-9301.62 28151.35,-9305.4 28151.55,-9298.41"/>
<text text-anchor="middle" x="29841.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l1_gate_gpu8&#45;&gt;l1_expert6_gpu6 -->
<g id="edge487" class="edge">
<title>l1_gate_gpu8&#45;&gt;l1_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26068,-9407.78C26056.98,-9403.59 26045.3,-9399.91 26034,-9397.67 26008.92,-9392.69 18689.06,-9397.77 18671,-9379.67 18666.29,-9374.95 18666.33,-9369.43 18671,-9364.67 18727.71,-9306.8 21317.97,-9300.37 21815.01,-9299.67"/>
<polygon fill="black" stroke="black" points="21815.33,-9303.17 21825.32,-9299.65 21815.32,-9296.17 21815.33,-9303.17"/>
<text text-anchor="middle" x="18716.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l1_gate_gpu8&#45;&gt;l1_expert7_gpu7 -->
<g id="edge488" class="edge">
<title>l1_gate_gpu8&#45;&gt;l1_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26068,-9407.79C26056.98,-9403.6 26045.3,-9399.91 26034,-9397.67 25995.8,-9390.07 20453.49,-9407.25 20426,-9379.67 20421.29,-9374.94 20421.31,-9369.41 20426,-9364.67 20441.15,-9349.33 21956.45,-9347.17 21978,-9346.67 22452.1,-9335.54 23020.73,-9312.09 23229.24,-9303.15"/>
<polygon fill="black" stroke="black" points="23229.65,-9306.63 23239.49,-9302.7 23229.35,-9299.64 23229.65,-9306.63"/>
<text text-anchor="middle" x="20471.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l1_gate_gpu9&#45;&gt;l1_expert0_gpu0 -->
<g id="edge489" class="edge">
<title>l1_gate_gpu9&#45;&gt;l1_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26246,-9407.8C26234.97,-9403.61 26223.3,-9399.92 26212,-9397.67 26186.16,-9392.51 22436.59,-9398.34 22418,-9379.67 22413.3,-9374.94 22413.33,-9369.42 22418,-9364.67 22436.96,-9345.35 23364.98,-9348.18 23392,-9346.67 23540.99,-9338.31 23714.15,-9320.21 23813.22,-9309.04"/>
<polygon fill="black" stroke="black" points="23813.92,-9312.48 23823.46,-9307.88 23813.13,-9305.53 23813.92,-9312.48"/>
<text text-anchor="middle" x="22463.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l1_gate_gpu9&#45;&gt;l1_expert1_gpu1 -->
<g id="edge490" class="edge">
<title>l1_gate_gpu9&#45;&gt;l1_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26245.99,-9407.84C26234.97,-9403.65 26223.3,-9399.95 26212,-9397.67 26185.91,-9392.4 24314.73,-9398.57 24296,-9379.67 24242.87,-9326.03 24367.38,-9308.32 24457.08,-9302.47"/>
<polygon fill="black" stroke="black" points="24457.52,-9305.95 24467.29,-9301.84 24457.09,-9298.96 24457.52,-9305.95"/>
<text text-anchor="middle" x="24341.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l1_gate_gpu9&#45;&gt;l1_expert2_gpu2 -->
<g id="edge491" class="edge">
<title>l1_gate_gpu9&#45;&gt;l1_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26356.01,-9407.86C26367.04,-9403.66 26378.71,-9399.96 26390,-9397.67 26434.62,-9388.62 27996.98,-9412.04 28029,-9379.67 28033.69,-9374.93 28033.58,-9369.51 28029,-9364.67 27990.89,-9324.42 27183.19,-9305.96 26920.06,-9301"/>
<polygon fill="black" stroke="black" points="26919.88,-9297.5 26909.81,-9300.81 26919.75,-9304.5 26919.88,-9297.5"/>
<text text-anchor="middle" x="28077.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l1_gate_gpu9&#45;&gt;l1_expert3_gpu3 -->
<g id="edge492" class="edge">
<title>l1_gate_gpu9&#45;&gt;l1_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26243.09,-9409.28C26197.37,-9389.66 26140.8,-9365.46 26138,-9364.67 26019.95,-9331.11 25878.37,-9313.88 25791.3,-9305.8"/>
<polygon fill="black" stroke="black" points="25791.5,-9302.31 25781.22,-9304.89 25790.86,-9309.28 25791.5,-9302.31"/>
<text text-anchor="middle" x="26216.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l1_gate_gpu9&#45;&gt;l1_expert4_gpu4 -->
<g id="edge493" class="edge">
<title>l1_gate_gpu9&#45;&gt;l1_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26356,-9407.79C26367.02,-9403.6 26378.7,-9399.91 26390,-9397.67 26426.75,-9390.36 31758.55,-9406.2 31785,-9379.67 31789.71,-9374.94 31789.64,-9369.45 31785,-9364.67 31748.14,-9326.68 30096.62,-9305.08 29706.82,-9300.5"/>
<polygon fill="black" stroke="black" points="29706.79,-9297 29696.75,-9300.38 29706.7,-9304 29706.79,-9297"/>
<text text-anchor="middle" x="31833.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l1_gate_gpu9&#45;&gt;l1_expert5_gpu5 -->
<g id="edge494" class="edge">
<title>l1_gate_gpu9&#45;&gt;l1_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26356,-9407.8C26367.03,-9403.61 26378.7,-9399.92 26390,-9397.67 26413.95,-9392.88 29889.77,-9396.98 29907,-9379.67 29911.7,-9374.94 29911.63,-9369.46 29907,-9364.67 29899.27,-9356.65 28506.6,-9313.08 28151.6,-9302.1"/>
<polygon fill="black" stroke="black" points="28151.5,-9298.59 28141.4,-9301.78 28151.29,-9305.59 28151.5,-9298.59"/>
<text text-anchor="middle" x="29955.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l1_gate_gpu9&#45;&gt;l1_expert6_gpu6 -->
<g id="edge495" class="edge">
<title>l1_gate_gpu9&#45;&gt;l1_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26246,-9407.78C26234.98,-9403.59 26223.3,-9399.91 26212,-9397.67 26186.7,-9392.65 18803.21,-9397.92 18785,-9379.67 18780.29,-9374.95 18780.34,-9369.43 18785,-9364.67 18839.58,-9308.93 21329.05,-9300.79 21815.18,-9299.73"/>
<polygon fill="black" stroke="black" points="21815.28,-9303.23 21825.28,-9299.71 21815.27,-9296.23 21815.28,-9303.23"/>
<text text-anchor="middle" x="18830.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l1_gate_gpu9&#45;&gt;l1_expert7_gpu7 -->
<g id="edge496" class="edge">
<title>l1_gate_gpu9&#45;&gt;l1_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26246,-9407.79C26234.98,-9403.6 26223.3,-9399.91 26212,-9397.67 26173.37,-9389.99 20567.81,-9407.56 20540,-9379.67 20535.29,-9374.94 20535.32,-9369.41 20540,-9364.67 20554.03,-9350.45 21958.03,-9347.14 21978,-9346.67 22452.1,-9335.33 23020.73,-9312 23229.24,-9303.12"/>
<polygon fill="black" stroke="black" points="23229.65,-9306.6 23239.49,-9302.68 23229.35,-9299.61 23229.65,-9306.6"/>
<text text-anchor="middle" x="20585.5" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l1_gate_gpu10&#45;&gt;l1_expert0_gpu0 -->
<g id="edge497" class="edge">
<title>l1_gate_gpu10&#45;&gt;l1_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26424,-9407.8C26412.97,-9403.61 26401.3,-9399.92 26390,-9397.67 26363.73,-9392.42 22550.9,-9398.65 22532,-9379.67 22527.3,-9374.94 22527.34,-9369.43 22532,-9364.67 22548.72,-9347.59 23368.14,-9348.03 23392,-9346.67 23540.97,-9338.13 23714.14,-9320.09 23813.22,-9308.98"/>
<polygon fill="black" stroke="black" points="23813.91,-9312.42 23823.46,-9307.83 23813.13,-9305.47 23813.91,-9312.42"/>
<text text-anchor="middle" x="22582" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l1_gate_gpu10&#45;&gt;l1_expert1_gpu1 -->
<g id="edge498" class="edge">
<title>l1_gate_gpu10&#45;&gt;l1_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26423.99,-9407.84C26412.97,-9403.65 26401.3,-9399.94 26390,-9397.67 26363.04,-9392.22 24429.36,-9399.2 24410,-9379.67 24385.04,-9354.48 24421.93,-9333.65 24462.56,-9319.55"/>
<polygon fill="black" stroke="black" points="24463.71,-9322.86 24472.1,-9316.38 24461.51,-9316.21 24463.71,-9322.86"/>
<text text-anchor="middle" x="24460" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l1_gate_gpu10&#45;&gt;l1_expert2_gpu2 -->
<g id="edge499" class="edge">
<title>l1_gate_gpu10&#45;&gt;l1_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26534.01,-9407.86C26545.04,-9403.67 26556.71,-9399.96 26568,-9397.67 26610.88,-9388.96 28112.24,-9410.78 28143,-9379.67 28147.69,-9374.92 28147.6,-9369.5 28143,-9364.67 28121.84,-9342.42 27202.49,-9311.23 26919.82,-9302.15"/>
<polygon fill="black" stroke="black" points="26919.74,-9298.65 26909.63,-9301.83 26919.52,-9305.65 26919.74,-9298.65"/>
<text text-anchor="middle" x="28196" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l1_gate_gpu10&#45;&gt;l1_expert3_gpu3 -->
<g id="edge500" class="edge">
<title>l1_gate_gpu10&#45;&gt;l1_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26422.19,-9408.76C26411.63,-9404.64 26400.59,-9400.73 26390,-9397.67 26345.78,-9384.86 26330.81,-9396.58 26288,-9379.67 26276.65,-9375.18 26276.48,-9368.82 26265,-9364.67 26179.87,-9333.85 25923.88,-9313.37 25791.4,-9304.54"/>
<polygon fill="black" stroke="black" points="25791.52,-9301.04 25781.31,-9303.87 25791.06,-9308.02 25791.52,-9301.04"/>
<text text-anchor="middle" x="26338" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l1_gate_gpu10&#45;&gt;l1_expert4_gpu4 -->
<g id="edge501" class="edge">
<title>l1_gate_gpu10&#45;&gt;l1_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26534,-9407.79C26545.02,-9403.6 26556.7,-9399.91 26568,-9397.67 26604.31,-9390.45 31872.87,-9405.89 31899,-9379.67 31903.71,-9374.94 31903.65,-9369.45 31899,-9364.67 31860.03,-9324.56 30109.18,-9304.47 29706.82,-9300.38"/>
<polygon fill="black" stroke="black" points="29706.76,-9296.87 29696.72,-9300.27 29706.69,-9303.87 29706.76,-9296.87"/>
<text text-anchor="middle" x="31952" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l1_gate_gpu10&#45;&gt;l1_expert5_gpu5 -->
<g id="edge502" class="edge">
<title>l1_gate_gpu10&#45;&gt;l1_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26534,-9407.8C26545.03,-9403.62 26556.7,-9399.92 26568,-9397.67 26591.51,-9392.97 30004.09,-9396.67 30021,-9379.67 30025.7,-9374.94 30025.63,-9369.46 30021,-9364.67 30016.87,-9360.39 28520.92,-9313.6 28151.66,-9302.12"/>
<polygon fill="black" stroke="black" points="28151.69,-9298.62 28141.58,-9301.8 28151.47,-9305.61 28151.69,-9298.62"/>
<text text-anchor="middle" x="30074" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l1_gate_gpu10&#45;&gt;l1_expert6_gpu6 -->
<g id="edge503" class="edge">
<title>l1_gate_gpu10&#45;&gt;l1_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26424,-9407.78C26412.98,-9403.59 26401.3,-9399.91 26390,-9397.67 26364.49,-9392.6 18917.37,-9398.08 18899,-9379.67 18894.29,-9374.95 18894.34,-9369.43 18899,-9364.67 18951.45,-9311.06 21339.67,-9301.22 21815.17,-9299.8"/>
<polygon fill="black" stroke="black" points="21815.39,-9303.29 21825.38,-9299.76 21815.37,-9296.29 21815.39,-9303.29"/>
<text text-anchor="middle" x="18949" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l1_gate_gpu10&#45;&gt;l1_expert7_gpu7 -->
<g id="edge504" class="edge">
<title>l1_gate_gpu10&#45;&gt;l1_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26424,-9407.79C26412.98,-9403.6 26401.3,-9399.91 26390,-9397.67 26350.93,-9389.9 20682.12,-9407.88 20654,-9379.67 20649.29,-9374.94 20649.32,-9369.41 20654,-9364.67 20666.92,-9351.57 21959.61,-9347.11 21978,-9346.67 22452.09,-9335.07 23020.72,-9311.9 23229.24,-9303.09"/>
<polygon fill="black" stroke="black" points="23229.65,-9306.57 23239.49,-9302.65 23229.35,-9299.58 23229.65,-9306.57"/>
<text text-anchor="middle" x="20704" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l1_gate_gpu11&#45;&gt;l1_expert0_gpu0 -->
<g id="edge505" class="edge">
<title>l1_gate_gpu11&#45;&gt;l1_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26602,-9407.8C26590.98,-9403.61 26579.3,-9399.92 26568,-9397.67 26541.35,-9392.35 22674.17,-9398.92 22655,-9379.67 22650.3,-9374.94 22650.34,-9369.44 22655,-9364.67 22669.3,-9350.01 23371.56,-9347.87 23392,-9346.67 23540.96,-9337.87 23714.13,-9319.91 23813.22,-9308.89"/>
<polygon fill="black" stroke="black" points="23813.9,-9312.34 23823.45,-9307.75 23813.13,-9305.38 23813.9,-9312.34"/>
<text text-anchor="middle" x="22705" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l1_gate_gpu11&#45;&gt;l1_expert1_gpu1 -->
<g id="edge506" class="edge">
<title>l1_gate_gpu11&#45;&gt;l1_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26601.99,-9407.84C26590.97,-9403.65 26579.3,-9399.94 26568,-9397.67 26540.29,-9392.08 24552.9,-9399.74 24533,-9379.67 24526.58,-9373.19 24523.83,-9364.8 24523.3,-9355.89"/>
<polygon fill="black" stroke="black" points="24526.8,-9355.78 24523.56,-9345.69 24519.81,-9355.6 24526.8,-9355.78"/>
<text text-anchor="middle" x="24583" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l1_gate_gpu11&#45;&gt;l1_expert2_gpu2 -->
<g id="edge507" class="edge">
<title>l1_gate_gpu11&#45;&gt;l1_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26712.01,-9407.86C26723.04,-9403.67 26734.71,-9399.96 26746,-9397.67 26787.38,-9389.25 28236.32,-9409.7 28266,-9379.67 28270.69,-9374.92 28270.61,-9369.49 28266,-9364.67 28260.14,-9358.53 27221.49,-9315.35 26919.47,-9302.92"/>
<polygon fill="black" stroke="black" points="26919.6,-9299.43 26909.47,-9302.51 26919.31,-9306.42 26919.6,-9299.43"/>
<text text-anchor="middle" x="28319" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l1_gate_gpu11&#45;&gt;l1_expert3_gpu3 -->
<g id="edge508" class="edge">
<title>l1_gate_gpu11&#45;&gt;l1_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26600.82,-9408.41C26590.1,-9404.28 26578.84,-9400.45 26568,-9397.67 26499.98,-9380.18 26477.07,-9403.49 26411,-9379.67 26399.52,-9375.53 26399.52,-9368.7 26388,-9364.67 26279.92,-9326.82 25947.32,-9308.99 25791.77,-9302.55"/>
<polygon fill="black" stroke="black" points="25791.47,-9299.03 25781.34,-9302.12 25791.19,-9306.03 25791.47,-9299.03"/>
<text text-anchor="middle" x="26461" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l1_gate_gpu11&#45;&gt;l1_expert4_gpu4 -->
<g id="edge509" class="edge">
<title>l1_gate_gpu11&#45;&gt;l1_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26712,-9407.79C26723.02,-9403.6 26734.7,-9399.91 26746,-9397.67 26781.94,-9390.52 31996.14,-9405.62 32022,-9379.67 32026.71,-9374.94 32026.65,-9369.44 32022,-9364.67 31980.74,-9322.27 30122.31,-9303.85 29706.81,-9300.25"/>
<polygon fill="black" stroke="black" points="29706.71,-9296.75 29696.68,-9300.17 29706.65,-9303.75 29706.71,-9296.75"/>
<text text-anchor="middle" x="32075" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l1_gate_gpu11&#45;&gt;l1_expert5_gpu5 -->
<g id="edge510" class="edge">
<title>l1_gate_gpu11&#45;&gt;l1_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26712,-9407.81C26723.03,-9403.62 26734.7,-9399.92 26746,-9397.67 26769.14,-9393.04 30127.36,-9396.4 30144,-9379.67 30148.7,-9374.94 30148.64,-9369.45 30144,-9364.67 30132.41,-9352.72 29561.64,-9347.18 29545,-9346.67 29013.74,-9330.2 28374.87,-9309.5 28151.69,-9302.24"/>
<polygon fill="black" stroke="black" points="28151.48,-9298.73 28141.37,-9301.91 28151.26,-9305.73 28151.48,-9298.73"/>
<text text-anchor="middle" x="30197" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l1_gate_gpu11&#45;&gt;l1_expert6_gpu6 -->
<g id="edge511" class="edge">
<title>l1_gate_gpu11&#45;&gt;l1_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26602,-9407.78C26590.98,-9403.59 26579.3,-9399.91 26568,-9397.67 26542.3,-9392.57 19040.51,-9398.21 19022,-9379.67 19017.29,-9374.95 19017.34,-9369.43 19022,-9364.67 19072.16,-9313.36 21351.55,-9301.71 21815.21,-9299.87"/>
<polygon fill="black" stroke="black" points="21815.51,-9303.37 21825.5,-9299.83 21815.49,-9296.37 21815.51,-9303.37"/>
<text text-anchor="middle" x="19072" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l1_gate_gpu11&#45;&gt;l1_expert7_gpu7 -->
<g id="edge512" class="edge">
<title>l1_gate_gpu11&#45;&gt;l1_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26602,-9407.79C26590.98,-9403.6 26579.3,-9399.91 26568,-9397.67 26528.56,-9389.83 20805.39,-9408.15 20777,-9379.67 20772.29,-9374.94 20772.32,-9369.41 20777,-9364.67 20788.71,-9352.78 21961.32,-9347.08 21978,-9346.67 22452.08,-9334.74 23020.72,-9311.76 23229.24,-9303.05"/>
<polygon fill="black" stroke="black" points="23229.64,-9306.53 23239.49,-9302.62 23229.35,-9299.54 23229.64,-9306.53"/>
<text text-anchor="middle" x="20827" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l1_gate_gpu12&#45;&gt;l1_expert0_gpu0 -->
<g id="edge513" class="edge">
<title>l1_gate_gpu12&#45;&gt;l1_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26780,-9407.8C26768.98,-9403.61 26757.3,-9399.92 26746,-9397.67 26718.98,-9392.28 22797.44,-9399.19 22778,-9379.67 22773.3,-9374.94 22773.36,-9369.45 22778,-9364.67 22801.77,-9340.18 23357.94,-9348.76 23392,-9346.67 23540.94,-9337.51 23714.11,-9319.67 23813.21,-9308.77"/>
<polygon fill="black" stroke="black" points="23813.89,-9312.22 23823.45,-9307.64 23813.12,-9305.26 23813.89,-9312.22"/>
<text text-anchor="middle" x="22828" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l1_gate_gpu12&#45;&gt;l1_expert1_gpu1 -->
<g id="edge514" class="edge">
<title>l1_gate_gpu12&#45;&gt;l1_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26779.99,-9407.84C26768.97,-9403.64 26757.3,-9399.94 26746,-9397.67 26632.17,-9374.72 24766.78,-9414.47 24656,-9379.67 24654.13,-9379.08 24625.14,-9359.23 24596.48,-9339.45"/>
<polygon fill="black" stroke="black" points="24598.25,-9336.42 24588.03,-9333.61 24594.27,-9342.18 24598.25,-9336.42"/>
<text text-anchor="middle" x="24706" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l1_gate_gpu12&#45;&gt;l1_expert2_gpu2 -->
<g id="edge515" class="edge">
<title>l1_gate_gpu12&#45;&gt;l1_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26890.01,-9407.87C26901.04,-9403.67 26912.71,-9399.96 26924,-9397.67 26963.88,-9389.55 28360.4,-9408.62 28389,-9379.67 28393.68,-9374.92 28393.61,-9369.48 28389,-9364.67 28387.39,-9362.99 27238.73,-9315.95 26919.46,-9302.91"/>
<polygon fill="black" stroke="black" points="26919.49,-9299.41 26909.36,-9302.49 26919.21,-9306.4 26919.49,-9299.41"/>
<text text-anchor="middle" x="28442" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l1_gate_gpu12&#45;&gt;l1_expert3_gpu3 -->
<g id="edge516" class="edge">
<title>l1_gate_gpu12&#45;&gt;l1_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26778.88,-9408.15C26768.16,-9404.04 26756.88,-9400.29 26746,-9397.67 26654.08,-9375.47 26623.42,-9410.42 26534,-9379.67 26522.46,-9375.7 26522.55,-9368.61 26511,-9364.67 26379.56,-9319.72 25967.94,-9305.32 25791.55,-9301.14"/>
<polygon fill="black" stroke="black" points="25791.63,-9297.64 25781.55,-9300.9 25791.47,-9304.63 25791.63,-9297.64"/>
<text text-anchor="middle" x="26584" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l1_gate_gpu12&#45;&gt;l1_expert4_gpu4 -->
<g id="edge517" class="edge">
<title>l1_gate_gpu12&#45;&gt;l1_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26890,-9407.79C26901.02,-9403.6 26912.7,-9399.91 26924,-9397.67 26959.56,-9390.59 32119.41,-9405.35 32145,-9379.67 32149.71,-9374.94 32149.65,-9369.44 32145,-9364.67 32101.46,-9319.98 30135.12,-9303.26 29706.8,-9300.14"/>
<polygon fill="black" stroke="black" points="29706.7,-9296.64 29696.67,-9300.07 29706.65,-9303.64 29706.7,-9296.64"/>
<text text-anchor="middle" x="32198" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l1_gate_gpu12&#45;&gt;l1_expert5_gpu5 -->
<g id="edge518" class="edge">
<title>l1_gate_gpu12&#45;&gt;l1_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26890,-9407.81C26901.03,-9403.62 26912.7,-9399.92 26924,-9397.67 26946.77,-9393.11 30250.63,-9396.13 30267,-9379.67 30271.7,-9374.94 30271.65,-9369.44 30267,-9364.67 30252.99,-9350.3 29565.05,-9347.24 29545,-9346.67 29013.7,-9331.56 28374.85,-9310.02 28151.68,-9302.39"/>
<polygon fill="black" stroke="black" points="28151.48,-9298.88 28141.37,-9302.04 28151.25,-9305.88 28151.48,-9298.88"/>
<text text-anchor="middle" x="30320" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l1_gate_gpu12&#45;&gt;l1_expert6_gpu6 -->
<g id="edge519" class="edge">
<title>l1_gate_gpu12&#45;&gt;l1_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26780,-9407.78C26768.98,-9403.59 26757.3,-9399.91 26746,-9397.67 26720.11,-9392.53 19163.64,-9398.35 19145,-9379.67 19140.29,-9374.95 19140.34,-9369.43 19145,-9364.67 19192.87,-9315.65 21364.3,-9302.22 21815.45,-9299.96"/>
<polygon fill="black" stroke="black" points="21815.48,-9303.46 21825.47,-9299.91 21815.45,-9296.46 21815.48,-9303.46"/>
<text text-anchor="middle" x="19195" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l1_gate_gpu12&#45;&gt;l1_expert7_gpu7 -->
<g id="edge520" class="edge">
<title>l1_gate_gpu12&#45;&gt;l1_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26780,-9407.79C26768.98,-9403.6 26757.3,-9399.91 26746,-9397.67 26706.18,-9389.75 20928.66,-9408.42 20900,-9379.67 20895.29,-9374.94 20895.33,-9369.42 20900,-9364.67 20921,-9343.31 21948.06,-9347.44 21978,-9346.67 22452.07,-9334.34 23020.72,-9311.6 23229.24,-9303"/>
<polygon fill="black" stroke="black" points="23229.64,-9306.49 23239.49,-9302.58 23229.35,-9299.49 23229.64,-9306.49"/>
<text text-anchor="middle" x="20950" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l1_gate_gpu13&#45;&gt;l1_expert0_gpu0 -->
<g id="edge521" class="edge">
<title>l1_gate_gpu13&#45;&gt;l1_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26958,-9407.8C26946.98,-9403.61 26935.3,-9399.92 26924,-9397.67 26896.6,-9392.2 22920.71,-9399.46 22901,-9379.67 22896.3,-9374.94 22896.37,-9369.46 22901,-9364.67 22919.94,-9345.01 23364.76,-9348.44 23392,-9346.67 23540.9,-9336.96 23714.09,-9319.3 23813.2,-9308.59"/>
<polygon fill="black" stroke="black" points="23813.87,-9312.04 23823.44,-9307.48 23813.12,-9305.08 23813.87,-9312.04"/>
<text text-anchor="middle" x="22951" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l1_gate_gpu13&#45;&gt;l1_expert1_gpu1 -->
<g id="edge522" class="edge">
<title>l1_gate_gpu13&#45;&gt;l1_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26957.99,-9407.83C26946.97,-9403.64 26935.3,-9399.94 26924,-9397.67 26807.18,-9374.13 24893.09,-9414.1 24779,-9379.67 24767.32,-9376.14 24767.07,-9369.8 24756,-9364.67 24711.58,-9344.04 24659.03,-9328.08 24616.77,-9317.13"/>
<polygon fill="black" stroke="black" points="24617.37,-9313.67 24606.82,-9314.59 24615.64,-9320.46 24617.37,-9313.67"/>
<text text-anchor="middle" x="24829" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l1_gate_gpu13&#45;&gt;l1_expert2_gpu2 -->
<g id="edge523" class="edge">
<title>l1_gate_gpu13&#45;&gt;l1_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M27068.01,-9407.87C27079.04,-9403.68 27090.71,-9399.97 27102,-9397.67 27139.95,-9389.93 28468.79,-9407.22 28496,-9379.67 28500.68,-9374.92 28500.63,-9369.46 28496,-9364.67 28476.47,-9344.42 28018.11,-9347.74 27990,-9346.67 27588.35,-9331.31 27108,-9311.08 26919.55,-9303.06"/>
<polygon fill="black" stroke="black" points="26919.58,-9299.56 26909.44,-9302.63 26919.29,-9306.56 26919.58,-9299.56"/>
<text text-anchor="middle" x="28549" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l1_gate_gpu13&#45;&gt;l1_expert3_gpu3 -->
<g id="edge524" class="edge">
<title>l1_gate_gpu13&#45;&gt;l1_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26957.4,-9408.18C26946.53,-9404.01 26935.06,-9400.23 26924,-9397.67 26808.15,-9370.75 26769.8,-9417.37 26657,-9379.67 26645.43,-9375.8 26645.57,-9368.55 26634,-9364.67 26479.09,-9312.62 25987.77,-9302.19 25791.83,-9300.1"/>
<polygon fill="black" stroke="black" points="25791.63,-9296.6 25781.6,-9300 25791.56,-9303.6 25791.63,-9296.6"/>
<text text-anchor="middle" x="26707" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l1_gate_gpu13&#45;&gt;l1_expert4_gpu4 -->
<g id="edge525" class="edge">
<title>l1_gate_gpu13&#45;&gt;l1_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M27068,-9407.79C27079.02,-9403.6 27090.7,-9399.91 27102,-9397.67 27137.19,-9390.67 32242.68,-9405.08 32268,-9379.67 32272.71,-9374.94 32272.66,-9369.44 32268,-9364.67 32222.17,-9317.69 30147.76,-9302.7 29706.84,-9300.04"/>
<polygon fill="black" stroke="black" points="29706.75,-9296.54 29696.73,-9299.98 29706.71,-9303.54 29706.75,-9296.54"/>
<text text-anchor="middle" x="32321" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l1_gate_gpu13&#45;&gt;l1_expert5_gpu5 -->
<g id="edge526" class="edge">
<title>l1_gate_gpu13&#45;&gt;l1_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M27068,-9407.81C27079.03,-9403.62 27090.7,-9399.92 27102,-9397.67 27146.78,-9388.71 30357.8,-9412.05 30390,-9379.67 30394.7,-9374.94 30394.66,-9369.43 30390,-9364.67 30373.58,-9347.89 29568.47,-9347.29 29545,-9346.67 29013.67,-9332.53 28374.84,-9310.38 28151.68,-9302.49"/>
<polygon fill="black" stroke="black" points="28151.49,-9298.98 28141.37,-9302.13 28151.24,-9305.98 28151.49,-9298.98"/>
<text text-anchor="middle" x="30443" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l1_gate_gpu13&#45;&gt;l1_expert6_gpu6 -->
<g id="edge527" class="edge">
<title>l1_gate_gpu13&#45;&gt;l1_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26958,-9407.78C26946.98,-9403.59 26935.3,-9399.91 26924,-9397.67 26897.92,-9392.49 19286.78,-9398.48 19268,-9379.67 19263.29,-9374.95 19263.34,-9369.44 19268,-9364.67 19313.57,-9317.95 21375.89,-9302.76 21815.23,-9300.05"/>
<polygon fill="black" stroke="black" points="21815.33,-9303.55 21825.31,-9299.99 21815.29,-9296.55 21815.33,-9303.55"/>
<text text-anchor="middle" x="19318" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l1_gate_gpu13&#45;&gt;l1_expert7_gpu7 -->
<g id="edge528" class="edge">
<title>l1_gate_gpu13&#45;&gt;l1_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M26958,-9407.79C26946.98,-9403.6 26935.3,-9399.91 26924,-9397.67 26883.81,-9389.68 21051.93,-9408.69 21023,-9379.67 21018.29,-9374.94 21018.33,-9369.42 21023,-9364.67 21041.58,-9345.73 21951.48,-9347.38 21978,-9346.67 22452.06,-9333.83 23020.71,-9311.4 23229.24,-9302.94"/>
<polygon fill="black" stroke="black" points="23229.64,-9306.43 23239.49,-9302.52 23229.35,-9299.43 23229.64,-9306.43"/>
<text text-anchor="middle" x="21073" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l1_gate_gpu14&#45;&gt;l1_expert0_gpu0 -->
<g id="edge529" class="edge">
<title>l1_gate_gpu14&#45;&gt;l1_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M27136,-9407.8C27124.98,-9403.61 27113.3,-9399.92 27102,-9397.67 27074.23,-9392.13 23043.98,-9399.73 23024,-9379.67 23019.3,-9374.94 23019.4,-9369.49 23024,-9364.67 23038.12,-9349.84 23371.58,-9348.12 23392,-9346.67 23540.84,-9336.05 23714.05,-9318.7 23813.18,-9308.28"/>
<polygon fill="black" stroke="black" points="23813.84,-9311.73 23823.42,-9307.2 23813.11,-9304.77 23813.84,-9311.73"/>
<text text-anchor="middle" x="23074" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l1_gate_gpu14&#45;&gt;l1_expert1_gpu1 -->
<g id="edge530" class="edge">
<title>l1_gate_gpu14&#45;&gt;l1_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M27135.99,-9407.83C27124.97,-9403.64 27113.3,-9399.94 27102,-9397.67 26982.18,-9373.54 25019.02,-9414.97 24902,-9379.67 24890.32,-9376.14 24890.32,-9369.23 24879,-9364.67 24794.4,-9330.53 24690.6,-9313.99 24620.1,-9306.19"/>
<polygon fill="black" stroke="black" points="24620.27,-9302.68 24609.95,-9305.1 24619.52,-9309.64 24620.27,-9302.68"/>
<text text-anchor="middle" x="24952" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l1_gate_gpu14&#45;&gt;l1_expert2_gpu2 -->
<g id="edge531" class="edge">
<title>l1_gate_gpu14&#45;&gt;l1_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M27271.03,-9434.11C27563.04,-9433.5 28556.6,-9427.89 28603,-9379.67 28607.62,-9374.86 28607.64,-9369.45 28603,-9364.67 28591.13,-9352.44 28007.02,-9347.26 27990,-9346.67 27588.3,-9332.56 27107.99,-9311.61 26919.54,-9303.24"/>
<polygon fill="black" stroke="black" points="26919.58,-9299.74 26909.44,-9302.79 26919.27,-9306.73 26919.58,-9299.74"/>
<text text-anchor="middle" x="28656" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l1_gate_gpu14&#45;&gt;l1_expert3_gpu3 -->
<g id="edge532" class="edge">
<title>l1_gate_gpu14&#45;&gt;l1_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M27135.42,-9408.08C27124.55,-9403.92 27113.08,-9400.17 27102,-9397.67 26962.2,-9366.03 26916.2,-9424.33 26780,-9379.67 26768.4,-9375.86 26768.58,-9368.5 26757,-9364.67 26578.4,-9305.48 26006.08,-9299.44 25791.91,-9299.31"/>
<polygon fill="black" stroke="black" points="25791.68,-9295.81 25781.68,-9299.3 25791.68,-9302.81 25791.68,-9295.81"/>
<text text-anchor="middle" x="26830" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l1_gate_gpu14&#45;&gt;l1_expert4_gpu4 -->
<g id="edge533" class="edge">
<title>l1_gate_gpu14&#45;&gt;l1_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M27270.67,-9431.68C27494.47,-9424.82 28147.93,-9405.59 28691,-9397.67 28716.69,-9397.29 32372.88,-9397.88 32391,-9379.67 32395.7,-9374.94 32395.66,-9369.43 32391,-9364.67 32342.87,-9315.39 30159.23,-9302.16 29706.6,-9299.95"/>
<polygon fill="black" stroke="black" points="29706.57,-9296.45 29696.55,-9299.9 29706.53,-9303.45 29706.57,-9296.45"/>
<text text-anchor="middle" x="32444" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l1_gate_gpu14&#45;&gt;l1_expert5_gpu5 -->
<g id="edge534" class="edge">
<title>l1_gate_gpu14&#45;&gt;l1_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M27271.08,-9431.81C27495.26,-9425.3 28148.28,-9406.95 28691,-9397.67 28716.3,-9397.23 30495.19,-9397.65 30513,-9379.67 30517.69,-9374.93 30517.67,-9369.42 30513,-9364.67 30494.16,-9345.47 29571.88,-9347.34 29545,-9346.67 29013.65,-9333.25 28374.84,-9310.66 28151.68,-9302.57"/>
<polygon fill="black" stroke="black" points="28151.49,-9299.06 28141.37,-9302.2 28151.23,-9306.06 28151.49,-9299.06"/>
<text text-anchor="middle" x="30566" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l1_gate_gpu14&#45;&gt;l1_expert6_gpu6 -->
<g id="edge535" class="edge">
<title>l1_gate_gpu14&#45;&gt;l1_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M27136,-9407.78C27124.98,-9403.59 27113.3,-9399.91 27102,-9397.67 27075.79,-9392.47 19424.87,-9398.58 19406,-9379.67 19401.29,-9374.95 19401.35,-9369.44 19406,-9364.67 19449.01,-9320.52 21390.64,-9303.39 21815.45,-9300.16"/>
<polygon fill="black" stroke="black" points="21815.52,-9303.66 21825.49,-9300.09 21815.47,-9296.66 21815.52,-9303.66"/>
<text text-anchor="middle" x="19456" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l1_gate_gpu14&#45;&gt;l1_expert7_gpu7 -->
<g id="edge536" class="edge">
<title>l1_gate_gpu14&#45;&gt;l1_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M27136,-9407.78C27124.98,-9403.6 27113.3,-9399.91 27102,-9397.67 27061.43,-9389.61 21175.2,-9408.96 21146,-9379.67 21141.29,-9374.94 21141.34,-9369.43 21146,-9364.67 21162.17,-9348.14 21954.89,-9347.32 21978,-9346.67 22452.04,-9333.17 23020.7,-9311.13 23229.23,-9302.86"/>
<polygon fill="black" stroke="black" points="23229.63,-9306.35 23239.48,-9302.45 23229.35,-9299.35 23229.63,-9306.35"/>
<text text-anchor="middle" x="21196" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l1_gate_gpu15&#45;&gt;l1_expert0_gpu0 -->
<g id="edge537" class="edge">
<title>l1_gate_gpu15&#45;&gt;l1_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M28700.33,-9431.77C28476.53,-9425.13 27823.06,-9406.44 27280,-9397.67 27217.26,-9396.65 25080.2,-9400.48 25021,-9379.67 25010.85,-9376.1 25012.1,-9368.36 25002,-9364.67 24945.31,-9343.93 24519.26,-9350.17 24459,-9346.67 24286.29,-9336.61 24084.4,-9318.17 23974.82,-9307.6"/>
<polygon fill="black" stroke="black" points="23975.12,-9304.11 23964.83,-9306.63 23974.44,-9311.08 23975.12,-9304.11"/>
<text text-anchor="middle" x="25071" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l1_gate_gpu15&#45;&gt;l1_expert1_gpu1 -->
<g id="edge538" class="edge">
<title>l1_gate_gpu15&#45;&gt;l1_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M28700.18,-9432.19C28344.51,-9423.34 26920.49,-9387.48 26899,-9379.67 26888.89,-9375.99 26890.14,-9368.27 26880,-9364.67 26814.56,-9341.42 25699.42,-9348.66 25630,-9346.67 25252.44,-9335.8 24801.76,-9313.33 24620.45,-9303.9"/>
<polygon fill="black" stroke="black" points="24620.63,-9300.4 24610.46,-9303.38 24620.26,-9307.39 24620.63,-9300.4"/>
<text text-anchor="middle" x="26949" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l1_gate_gpu15&#45;&gt;l1_expert2_gpu2 -->
<g id="edge539" class="edge">
<title>l1_gate_gpu15&#45;&gt;l1_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M28859.93,-9433.3C29209.64,-9429.34 30588.9,-9411.7 30620,-9379.67 30624.64,-9374.88 30624.7,-9369.4 30620,-9364.67 30607.13,-9351.71 28008.26,-9347.1 27990,-9346.67 27588.17,-9337.08 27107.93,-9313.56 26919.52,-9303.87"/>
<polygon fill="black" stroke="black" points="26919.59,-9300.37 26909.42,-9303.35 26919.23,-9307.36 26919.59,-9300.37"/>
<text text-anchor="middle" x="30673" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l1_gate_gpu15&#45;&gt;l1_expert3_gpu3 -->
<g id="edge540" class="edge">
<title>l1_gate_gpu15&#45;&gt;l1_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M28754.63,-9399.22C28742.75,-9385.78 28727.38,-9371.92 28710,-9364.67 28659.96,-9343.77 26812.2,-9348.13 26758,-9346.67 26397.42,-9336.91 25967.5,-9314.07 25791.35,-9304.23"/>
<polygon fill="black" stroke="black" points="25791.31,-9300.72 25781.13,-9303.65 25790.92,-9307.71 25791.31,-9300.72"/>
<text text-anchor="middle" x="28782" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l1_gate_gpu15&#45;&gt;l1_expert4_gpu4 -->
<g id="edge541" class="edge">
<title>l1_gate_gpu15&#45;&gt;l1_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M28860.34,-9433.79C29409.32,-9431.15 32586.78,-9414.37 32621,-9379.67 32625.68,-9374.92 32625.66,-9369.43 32621,-9364.67 32568.58,-9311.1 30181.96,-9301.23 29706.78,-9299.8"/>
<polygon fill="black" stroke="black" points="29706.58,-9296.3 29696.57,-9299.77 29706.56,-9303.3 29706.58,-9296.3"/>
<text text-anchor="middle" x="32674" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l1_gate_gpu15&#45;&gt;l1_expert5_gpu5 -->
<g id="edge542" class="edge">
<title>l1_gate_gpu15&#45;&gt;l1_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M28860.26,-9433.76C29400.04,-9430.94 32480.78,-9413.37 32514,-9379.67 32518.68,-9374.92 32518.7,-9369.39 32514,-9364.67 32499.46,-9350.04 29565.61,-9347.06 29545,-9346.67 29013.58,-9336.57 28374.81,-9311.92 28151.67,-9302.93"/>
<polygon fill="black" stroke="black" points="28151.49,-9299.42 28141.36,-9302.51 28151.21,-9306.41 28151.49,-9299.42"/>
<text text-anchor="middle" x="32567" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l1_gate_gpu15&#45;&gt;l1_expert6_gpu6 -->
<g id="edge543" class="edge">
<title>l1_gate_gpu15&#45;&gt;l1_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M28700.33,-9431.63C28476.53,-9424.63 27823.08,-9405.09 27280,-9397.67 27259.18,-9397.38 21298.7,-9394.41 21284,-9379.67 21279.29,-9374.94 21279.54,-9369.62 21284,-9364.67 21318.91,-9325.86 21656.62,-9308.4 21815.34,-9302.29"/>
<polygon fill="black" stroke="black" points="21815.67,-9305.78 21825.53,-9301.9 21815.4,-9298.79 21815.67,-9305.78"/>
<text text-anchor="middle" x="21334" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l1_gate_gpu15&#45;&gt;l1_expert7_gpu7 -->
<g id="edge544" class="edge">
<title>l1_gate_gpu15&#45;&gt;l1_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M28700.33,-9431.67C28476.53,-9424.77 27823.07,-9405.46 27280,-9397.67 27251.41,-9397.25 23182.18,-9399.93 23162,-9379.67 23132.33,-9349.86 23182.48,-9328.34 23232.43,-9315.17"/>
<polygon fill="black" stroke="black" points="23233.56,-9318.49 23242.39,-9312.64 23231.84,-9311.7 23233.56,-9318.49"/>
<text text-anchor="middle" x="23212" y="-9368.47" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l1_expert_agg_gpu0 -->
<g id="node329" class="node">
<title>l1_expert_agg_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24930" cy="-9176" rx="85" ry="37.5"/>
<text text-anchor="middle" x="24930" y="-9187.3" font-family="Times,serif" font-size="14.00">L1 Expert Agg</text>
<text text-anchor="middle" x="24930" y="-9172.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24930" y="-9157.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge297" class="edge">
<title>l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M23964.85,-9290.84C24071.81,-9280.86 24280.97,-9262.07 24459,-9250.5 24544.47,-9244.94 24762.43,-9258.62 24844,-9232.5 24856.81,-9228.4 24869.57,-9221.87 24881.18,-9214.7"/>
<polygon fill="black" stroke="black" points="24883.31,-9217.49 24889.82,-9209.13 24879.52,-9211.61 24883.31,-9217.49"/>
</g>
<!-- l1_expert_agg_gpu1 -->
<g id="node330" class="node">
<title>l1_expert_agg_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24554" cy="-9176" rx="85" ry="37.5"/>
<text text-anchor="middle" x="24554" y="-9187.3" font-family="Times,serif" font-size="14.00">L1 Expert Agg</text>
<text text-anchor="middle" x="24554" y="-9172.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24554" y="-9157.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge298" class="edge">
<title>l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M23965.23,-9292.6C24128.7,-9280.87 24518.45,-9251.1 24540,-9232.5 24543.09,-9229.84 24545.54,-9226.6 24547.49,-9223.05"/>
<polygon fill="black" stroke="black" points="24550.77,-9224.27 24551.36,-9213.7 24544.3,-9221.6 24550.77,-9224.27"/>
</g>
<!-- l1_expert_agg_gpu2 -->
<g id="node331" class="node">
<title>l1_expert_agg_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25870" cy="-9176" rx="85" ry="37.5"/>
<text text-anchor="middle" x="25870" y="-9187.3" font-family="Times,serif" font-size="14.00">L1 Expert Agg</text>
<text text-anchor="middle" x="25870" y="-9172.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25870" y="-9157.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge299" class="edge">
<title>l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M23964.8,-9290.08C24071.71,-9279.11 24280.8,-9259.07 24459,-9250.5 24497.32,-9248.65 25807.18,-9252.36 25840,-9232.5 25844.57,-9229.73 25848.48,-9226.01 25851.83,-9221.79"/>
<polygon fill="black" stroke="black" points="25854.93,-9223.45 25857.59,-9213.19 25849.12,-9219.56 25854.93,-9223.45"/>
</g>
<!-- l1_expert_agg_gpu3 -->
<g id="node332" class="node">
<title>l1_expert_agg_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26246" cy="-9176" rx="85" ry="37.5"/>
<text text-anchor="middle" x="26246" y="-9187.3" font-family="Times,serif" font-size="14.00">L1 Expert Agg</text>
<text text-anchor="middle" x="26246" y="-9172.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26246" y="-9157.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge300" class="edge">
<title>l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M23964.8,-9290.01C24071.71,-9278.96 24280.79,-9258.83 24459,-9250.5 24507.67,-9248.22 26170.77,-9256.81 26213,-9232.5 26217.92,-9229.67 26222.18,-9225.79 26225.86,-9221.38"/>
<polygon fill="black" stroke="black" points="26228.88,-9223.17 26231.85,-9213 26223.19,-9219.09 26228.88,-9223.17"/>
</g>
<!-- l1_expert_agg_gpu4 -->
<g id="node333" class="node">
<title>l1_expert_agg_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25118" cy="-9176" rx="85" ry="37.5"/>
<text text-anchor="middle" x="25118" y="-9187.3" font-family="Times,serif" font-size="14.00">L1 Expert Agg</text>
<text text-anchor="middle" x="25118" y="-9172.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25118" y="-9157.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge301" class="edge">
<title>l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M23964.82,-9290.42C24071.76,-9279.9 24280.87,-9260.43 24459,-9250.5 24494.35,-9248.53 25067,-9252.8 25096,-9232.5 25099.83,-9229.82 25102.99,-9226.36 25105.6,-9222.48"/>
<polygon fill="black" stroke="black" points="25108.81,-9223.92 25110.49,-9213.46 25102.65,-9220.58 25108.81,-9223.92"/>
</g>
<!-- l1_expert_agg_gpu5 -->
<g id="node334" class="node">
<title>l1_expert_agg_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="26058" cy="-9176" rx="85" ry="37.5"/>
<text text-anchor="middle" x="26058" y="-9187.3" font-family="Times,serif" font-size="14.00">L1 Expert Agg</text>
<text text-anchor="middle" x="26058" y="-9172.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="26058" y="-9157.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge302" class="edge">
<title>l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M23964.8,-9290.04C24071.71,-9279.03 24280.79,-9258.94 24459,-9250.5 24502.34,-9248.45 25982.86,-9253.19 26021,-9232.5 26026.28,-9229.63 26030.94,-9225.65 26035.02,-9221.12"/>
<polygon fill="black" stroke="black" points="26037.91,-9223.1 26041.33,-9213.07 26032.4,-9218.78 26037.91,-9223.1"/>
</g>
<!-- l1_expert_agg_gpu6 -->
<g id="node335" class="node">
<title>l1_expert_agg_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="23990" cy="-9176" rx="85" ry="37.5"/>
<text text-anchor="middle" x="23990" y="-9187.3" font-family="Times,serif" font-size="14.00">L1 Expert Agg</text>
<text text-anchor="middle" x="23990" y="-9172.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="23990" y="-9157.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge303" class="edge">
<title>l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M23947.27,-9266.19C23959.34,-9256.77 23970.95,-9245.44 23979,-9232.5 23980.76,-9229.66 23982.25,-9226.6 23983.51,-9223.42"/>
<polygon fill="black" stroke="black" points="23986.92,-9224.25 23986.62,-9213.66 23980.25,-9222.12 23986.92,-9224.25"/>
</g>
<!-- l1_expert_agg_gpu7 -->
<g id="node336" class="node">
<title>l1_expert_agg_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="26622" cy="-9176" rx="85" ry="37.5"/>
<text text-anchor="middle" x="26622" y="-9187.3" font-family="Times,serif" font-size="14.00">L1 Expert Agg</text>
<text text-anchor="middle" x="26622" y="-9172.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="26622" y="-9157.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge304" class="edge">
<title>l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M23964.36,-9290.02C24071.13,-9278.93 24280.54,-9258.68 24459,-9250.5 24488.58,-9249.14 26565.52,-9247.59 26591,-9232.5 26595.75,-9229.69 26599.82,-9225.85 26603.31,-9221.51"/>
<polygon fill="black" stroke="black" points="26606.2,-9223.47 26608.96,-9213.24 26600.43,-9219.52 26606.2,-9223.47"/>
</g>
<!-- l1_expert_agg_gpu8 -->
<g id="node337" class="node">
<title>l1_expert_agg_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="23802" cy="-9176" rx="85" ry="37.5"/>
<text text-anchor="middle" x="23802" y="-9187.3" font-family="Times,serif" font-size="14.00">L1 Expert Agg</text>
<text text-anchor="middle" x="23802" y="-9172.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="23802" y="-9157.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge305" class="edge">
<title>l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M23840.89,-9266.37C23828.97,-9256.95 23817.61,-9245.57 23810,-9232.5 23808.33,-9229.64 23806.97,-9226.56 23805.86,-9223.37"/>
<polygon fill="black" stroke="black" points="23809.2,-9222.32 23803.22,-9213.58 23802.44,-9224.14 23809.2,-9222.32"/>
</g>
<!-- l1_expert_agg_gpu9 -->
<g id="node338" class="node">
<title>l1_expert_agg_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26434" cy="-9176" rx="85" ry="37.5"/>
<text text-anchor="middle" x="26434" y="-9187.3" font-family="Times,serif" font-size="14.00">L1 Expert Agg</text>
<text text-anchor="middle" x="26434" y="-9172.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26434" y="-9157.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge306" class="edge">
<title>l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M23964.8,-9289.99C24071.71,-9278.91 24280.79,-9258.74 24459,-9250.5 24512.78,-9248.01 26349.65,-9258.12 26397,-9232.5 26402.35,-9229.6 26407.06,-9225.56 26411.17,-9220.96"/>
<polygon fill="black" stroke="black" points="26414.15,-9222.84 26417.53,-9212.8 26408.62,-9218.54 26414.15,-9222.84"/>
</g>
<!-- l1_expert_agg_gpu10 -->
<g id="node339" class="node">
<title>l1_expert_agg_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="24178" cy="-9176" rx="85" ry="37.5"/>
<text text-anchor="middle" x="24178" y="-9187.3" font-family="Times,serif" font-size="14.00">L1 Expert Agg</text>
<text text-anchor="middle" x="24178" y="-9172.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="24178" y="-9157.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge307" class="edge">
<title>l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M23964.33,-9289.3C24035.31,-9279.49 24138.28,-9260.83 24166,-9232.5 24168.67,-9229.77 24170.81,-9226.59 24172.52,-9223.16"/>
<polygon fill="black" stroke="black" points="24175.85,-9224.24 24176.09,-9213.65 24169.3,-9221.78 24175.85,-9224.24"/>
</g>
<!-- l1_expert_agg_gpu11 -->
<g id="node340" class="node">
<title>l1_expert_agg_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="25306" cy="-9176" rx="85" ry="37.5"/>
<text text-anchor="middle" x="25306" y="-9187.3" font-family="Times,serif" font-size="14.00">L1 Expert Agg</text>
<text text-anchor="middle" x="25306" y="-9172.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="25306" y="-9157.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge308" class="edge">
<title>l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M23964.81,-9290.28C24071.74,-9279.56 24280.84,-9259.85 24459,-9250.5 24481.92,-9249.3 25266.26,-9245.75 25285,-9232.5 25288.79,-9229.82 25291.9,-9226.36 25294.45,-9222.48"/>
<polygon fill="black" stroke="black" points="25297.64,-9223.94 25299.18,-9213.45 25291.44,-9220.69 25297.64,-9223.94"/>
</g>
<!-- l1_expert_agg_gpu12 -->
<g id="node341" class="node">
<title>l1_expert_agg_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="24366" cy="-9176" rx="85" ry="37.5"/>
<text text-anchor="middle" x="24366" y="-9187.3" font-family="Times,serif" font-size="14.00">L1 Expert Agg</text>
<text text-anchor="middle" x="24366" y="-9172.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="24366" y="-9157.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge309" class="edge">
<title>l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M23965.63,-9295.91C24047.35,-9291.76 24183.56,-9277.9 24291,-9232.5 24301.17,-9228.2 24311.24,-9222.26 24320.54,-9215.86"/>
<polygon fill="black" stroke="black" points="24322.77,-9218.56 24328.85,-9209.88 24318.68,-9212.88 24322.77,-9218.56"/>
</g>
<!-- l1_expert_agg_gpu13 -->
<g id="node342" class="node">
<title>l1_expert_agg_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="25494" cy="-9176" rx="85" ry="37.5"/>
<text text-anchor="middle" x="25494" y="-9187.3" font-family="Times,serif" font-size="14.00">L1 Expert Agg</text>
<text text-anchor="middle" x="25494" y="-9172.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="25494" y="-9157.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge310" class="edge">
<title>l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M23964.81,-9290.18C24071.73,-9279.35 24280.82,-9259.49 24459,-9250.5 24487.14,-9249.08 25449.96,-9248.72 25473,-9232.5 25476.8,-9229.82 25479.91,-9226.37 25482.46,-9222.49"/>
<polygon fill="black" stroke="black" points="25485.65,-9223.95 25487.19,-9213.47 25479.45,-9220.7 25485.65,-9223.95"/>
</g>
<!-- l1_expert_agg_gpu14 -->
<g id="node343" class="node">
<title>l1_expert_agg_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="24742" cy="-9176" rx="85" ry="37.5"/>
<text text-anchor="middle" x="24742" y="-9187.3" font-family="Times,serif" font-size="14.00">L1 Expert Agg</text>
<text text-anchor="middle" x="24742" y="-9172.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="24742" y="-9157.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge311" class="edge">
<title>l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M23964.88,-9291.35C24071.89,-9282.01 24281.11,-9264.04 24459,-9250.5 24487.98,-9248.29 24696.53,-9249.65 24720,-9232.5 24723.73,-9229.78 24726.82,-9226.32 24729.39,-9222.47"/>
<polygon fill="black" stroke="black" points="24732.54,-9224.01 24734.22,-9213.55 24726.38,-9220.68 24732.54,-9224.01"/>
</g>
<!-- l1_expert_agg_gpu15 -->
<g id="node344" class="node">
<title>l1_expert_agg_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="25682" cy="-9176" rx="85" ry="37.5"/>
<text text-anchor="middle" x="25682" y="-9187.3" font-family="Times,serif" font-size="14.00">L1 Expert Agg</text>
<text text-anchor="middle" x="25682" y="-9172.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="25682" y="-9157.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge312" class="edge">
<title>l1_expert0_gpu0&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M23964.81,-9290.12C24071.72,-9279.21 24280.81,-9259.25 24459,-9250.5 24492.35,-9248.86 25633.67,-9251.68 25661,-9232.5 25664.8,-9229.83 25667.92,-9226.38 25670.47,-9222.5"/>
<polygon fill="black" stroke="black" points="25673.65,-9223.97 25675.2,-9213.49 25667.45,-9220.71 25673.65,-9223.97"/>
</g>
<!-- l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge321" class="edge">
<title>l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M24609.82,-9291.64C24675.45,-9284.14 24774.61,-9267.69 24854,-9232.5 24864.06,-9228.04 24874.09,-9222.08 24883.41,-9215.72"/>
<polygon fill="black" stroke="black" points="24885.62,-9218.45 24891.75,-9209.81 24881.57,-9212.74 24885.62,-9218.45"/>
</g>
<!-- l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge322" class="edge">
<title>l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M24545.66,-9250.68C24546.47,-9244.57 24547.27,-9238.39 24548,-9232.5 24548.35,-9229.66 24548.7,-9226.73 24549.04,-9223.78"/>
<polygon fill="black" stroke="black" points="24552.53,-9224.07 24550.18,-9213.74 24545.58,-9223.28 24552.53,-9224.07"/>
</g>
<!-- l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge323" class="edge">
<title>l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M24610.59,-9294.56C24882.61,-9283 25837.44,-9241.8 25850,-9232.5 25853.66,-9229.79 25856.66,-9226.34 25859.11,-9222.49"/>
<polygon fill="black" stroke="black" points="25862.23,-9224.07 25863.64,-9213.57 25855.99,-9220.9 25862.23,-9224.07"/>
</g>
<!-- l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge324" class="edge">
<title>l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M24610.47,-9294.18C24784.73,-9285.96 25245.4,-9264.63 25630,-9250.5 25662.94,-9249.29 26195.87,-9251.22 26223,-9232.5 26226.87,-9229.83 26230.09,-9226.37 26232.77,-9222.5"/>
<polygon fill="black" stroke="black" points="26235.99,-9223.92 26237.82,-9213.48 26229.88,-9220.5 26235.99,-9223.92"/>
</g>
<!-- l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge325" class="edge">
<title>l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M24610.36,-9293.92C24754.26,-9285.89 25068.69,-9264.84 25105,-9232.5 25108.03,-9229.8 25110.42,-9226.54 25112.31,-9222.97"/>
<polygon fill="black" stroke="black" points="25115.59,-9224.18 25116.01,-9213.6 25109.08,-9221.61 25115.59,-9224.18"/>
</g>
<!-- l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge326" class="edge">
<title>l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M24610.4,-9294.51C24908.09,-9281.7 26035.08,-9233.15 26036,-9232.5 26039.81,-9229.79 26042.96,-9226.31 26045.56,-9222.42"/>
<polygon fill="black" stroke="black" points="26048.77,-9223.85 26050.44,-9213.38 26042.61,-9220.52 26048.77,-9223.85"/>
</g>
<!-- l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge327" class="edge">
<title>l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M24467.71,-9292.54C24352.72,-9283.64 24131.9,-9263.13 24060,-9232.5 24050.48,-9228.45 24041.18,-9222.74 24032.61,-9216.51"/>
<polygon fill="black" stroke="black" points="24034.72,-9213.72 24024.65,-9210.42 24030.47,-9219.28 24034.72,-9213.72"/>
</g>
<!-- l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge328" class="edge">
<title>l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M24610.46,-9293.89C24784.7,-9285.02 25245.32,-9262.36 25630,-9250.5 25656.96,-9249.67 26578.95,-9248.04 26601,-9232.5 26604.8,-9229.82 26607.91,-9226.37 26610.46,-9222.49"/>
<polygon fill="black" stroke="black" points="26613.64,-9223.95 26615.19,-9213.47 26607.44,-9220.7 26613.64,-9223.95"/>
</g>
<!-- l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge329" class="edge">
<title>l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M24468.12,-9291.6C24294.79,-9276.89 23862.63,-9239.62 23849,-9232.5 23842.83,-9229.28 23837.14,-9224.88 23832.01,-9219.95"/>
<polygon fill="black" stroke="black" points="23834.31,-9217.29 23824.9,-9212.42 23829.23,-9222.1 23834.31,-9217.29"/>
</g>
<!-- l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge330" class="edge">
<title>l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M24610.46,-9294C24784.71,-9285.37 25245.35,-9263.22 25630,-9250.5 25651.72,-9249.78 26394.17,-9244.91 26412,-9232.5 26415.84,-9229.83 26419,-9226.38 26421.62,-9222.5"/>
<polygon fill="black" stroke="black" points="26424.82,-9223.94 26426.51,-9213.48 26418.66,-9220.61 26424.82,-9223.94"/>
</g>
<!-- l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge331" class="edge">
<title>l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M24468.68,-9289.81C24386.24,-9279.62 24255.69,-9259.77 24215,-9232.5 24210.31,-9229.36 24206.07,-9225.4 24202.27,-9221.05"/>
<polygon fill="black" stroke="black" points="24204.81,-9218.62 24195.91,-9212.89 24199.29,-9222.93 24204.81,-9218.62"/>
</g>
<!-- l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge332" class="edge">
<title>l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M24610.46,-9296.12C24788.66,-9291.81 25242.05,-9276.59 25293,-9232.5 25296.07,-9229.84 25298.49,-9226.61 25300.39,-9223.06"/>
<polygon fill="black" stroke="black" points="25303.66,-9224.3 25304.11,-9213.71 25297.16,-9221.71 25303.66,-9224.3"/>
</g>
<!-- l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge333" class="edge">
<title>l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M24475.68,-9276.12C24450.86,-9265.62 24423.29,-9251.15 24402,-9232.5 24398.1,-9229.09 24394.46,-9225.15 24391.11,-9220.99"/>
<polygon fill="black" stroke="black" points="24393.79,-9218.73 24385.02,-9212.78 24388.16,-9222.89 24393.79,-9218.73"/>
</g>
<!-- l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge334" class="edge">
<title>l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M24610.72,-9297.45C24819.32,-9296.39 25415.21,-9288.46 25481,-9232.5 25484.13,-9229.83 25486.59,-9226.57 25488.51,-9222.98"/>
<polygon fill="black" stroke="black" points="25491.84,-9224.09 25492.25,-9213.5 25485.32,-9221.52 25491.84,-9224.09"/>
</g>
<!-- l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge335" class="edge">
<title>l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M24609.57,-9289.85C24649.59,-9281.86 24697.59,-9265.59 24728,-9232.5 24730.57,-9229.7 24732.69,-9226.5 24734.43,-9223.08"/>
<polygon fill="black" stroke="black" points="24737.74,-9224.22 24738.2,-9213.63 24731.24,-9221.62 24737.74,-9224.22"/>
</g>
<!-- l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge336" class="edge">
<title>l1_expert1_gpu1&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M24610.59,-9295.8C24852.75,-9289.48 25628.41,-9266.62 25669,-9232.5 25672.15,-9229.85 25674.62,-9226.6 25676.54,-9223.01"/>
<polygon fill="black" stroke="black" points="25679.86,-9224.14 25680.3,-9213.55 25673.36,-9221.56 25679.86,-9224.14"/>
</g>
<!-- l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge345" class="edge">
<title>l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M26766.61,-9293.84C26597.31,-9285.08 26158.11,-9263.05 25791,-9250.5 25705.58,-9247.58 25104.07,-9256.37 25022,-9232.5 25007.88,-9228.39 24993.74,-9221.55 24980.92,-9214.05"/>
<polygon fill="black" stroke="black" points="24982.64,-9211 24972.28,-9208.78 24978.99,-9216.98 24982.64,-9211"/>
</g>
<!-- l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge346" class="edge">
<title>l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M26766.62,-9293.66C26597.33,-9284.52 26158.15,-9261.72 25791,-9250.5 25667.37,-9246.72 24798.74,-9259.31 24678,-9232.5 24656.63,-9227.75 24634.46,-9219.16 24614.88,-9210.12"/>
<polygon fill="black" stroke="black" points="24616.32,-9206.93 24605.78,-9205.81 24613.32,-9213.26 24616.32,-9206.93"/>
</g>
<!-- l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge347" class="edge">
<title>l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M26766.46,-9297.79C26581.27,-9297.48 26090.21,-9290.99 25940,-9232.5 25930.25,-9228.7 25920.78,-9223.05 25912.12,-9216.79"/>
<polygon fill="black" stroke="black" points="25914.15,-9213.94 25904.08,-9210.64 25909.9,-9219.5 25914.15,-9213.94"/>
</g>
<!-- l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge348" class="edge">
<title>l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M26766.62,-9293.53C26643.05,-9285.73 26394.83,-9266.31 26315,-9232.5 26305.66,-9228.54 26296.55,-9222.94 26288.17,-9216.8"/>
<polygon fill="black" stroke="black" points="26290.1,-9213.87 26280.05,-9210.52 26285.82,-9219.4 26290.1,-9213.87"/>
</g>
<!-- l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge349" class="edge">
<title>l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M26766.61,-9293.99C26597.29,-9285.54 26158.07,-9264.13 25791,-9250.5 25756.9,-9249.23 25208.54,-9245.54 25177,-9232.5 25168.87,-9229.14 25161.2,-9224.11 25154.24,-9218.43"/>
<polygon fill="black" stroke="black" points="25156.22,-9215.51 25146.41,-9211.51 25151.59,-9220.76 25156.22,-9215.51"/>
</g>
<!-- l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge350" class="edge">
<title>l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M26766.68,-9294.89C26591.62,-9287.77 26150.81,-9266.65 26094,-9232.5 26088.96,-9229.47 26084.49,-9225.42 26080.57,-9220.9"/>
<polygon fill="black" stroke="black" points="26083.33,-9218.75 26074.48,-9212.91 26077.76,-9222.99 26083.33,-9218.75"/>
</g>
<!-- l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge351" class="edge">
<title>l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M26766.62,-9293.53C26597.34,-9284.1 26158.18,-9260.73 25791,-9250.5 25698.36,-9247.92 24213.77,-9251.19 24123,-9232.5 24099.52,-9227.66 24074.98,-9218.67 24053.47,-9209.31"/>
<polygon fill="black" stroke="black" points="24054.69,-9206.03 24044.13,-9205.15 24051.84,-9212.42 24054.69,-9206.03"/>
</g>
<!-- l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge352" class="edge">
<title>l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M26783.49,-9267.15C26752.76,-9250 26714.3,-9228.53 26682.63,-9210.84"/>
<polygon fill="black" stroke="black" points="26684.32,-9207.78 26673.88,-9205.96 26680.91,-9213.89 26684.32,-9207.78"/>
</g>
<!-- l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge353" class="edge">
<title>l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M26766.63,-9293.5C26597.34,-9284 26158.18,-9260.48 25791,-9250.5 25738.02,-9249.06 23933.55,-9248.42 23883,-9232.5 23870.94,-9228.7 23859.07,-9222.44 23848.29,-9215.47"/>
<polygon fill="black" stroke="black" points="23850.13,-9212.49 23839.9,-9209.76 23846.19,-9218.28 23850.13,-9212.49"/>
</g>
<!-- l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge354" class="edge">
<title>l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M26766.63,-9293.69C26696.64,-9287.62 26588.31,-9272.1 26503,-9232.5 26493.9,-9228.27 26484.96,-9222.6 26476.68,-9216.48"/>
<polygon fill="black" stroke="black" points="26478.7,-9213.62 26468.65,-9210.26 26474.41,-9219.15 26478.7,-9213.62"/>
</g>
<!-- l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge355" class="edge">
<title>l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M26766.62,-9293.55C26597.34,-9284.18 26158.17,-9260.9 25791,-9250.5 25748.29,-9249.29 24293.5,-9246.12 24253,-9232.5 24242.08,-9228.83 24231.43,-9222.91 24221.75,-9216.27"/>
<polygon fill="black" stroke="black" points="24223.66,-9213.34 24213.51,-9210.3 24219.55,-9219 24223.66,-9213.34"/>
</g>
<!-- l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge356" class="edge">
<title>l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M26766.6,-9294.3C26597.25,-9286.54 26157.97,-9266.5 25791,-9250.5 25743.67,-9248.43 25408.66,-9250.88 25365,-9232.5 25356.9,-9229.09 25349.23,-9224.03 25342.27,-9218.34"/>
<polygon fill="black" stroke="black" points="25344.26,-9215.42 25334.45,-9211.42 25339.62,-9220.66 25344.26,-9215.42"/>
</g>
<!-- l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge357" class="edge">
<title>l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M26766.62,-9293.59C26597.33,-9284.3 26158.16,-9261.2 25791,-9250.5 25715.97,-9248.31 24511.05,-9256.71 24440,-9232.5 24429.18,-9228.81 24418.66,-9222.89 24409.11,-9216.25"/>
<polygon fill="black" stroke="black" points="24411.11,-9213.38 24400.98,-9210.28 24406.97,-9219.02 24411.11,-9213.38"/>
</g>
<!-- l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge358" class="edge">
<title>l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M26766.54,-9294.63C26500.48,-9283.55 25581.11,-9244.47 25553,-9232.5 25544.91,-9229.05 25537.25,-9223.98 25530.3,-9218.28"/>
<polygon fill="black" stroke="black" points="25532.28,-9215.36 25522.47,-9211.36 25527.64,-9220.6 25532.28,-9215.36"/>
</g>
<!-- l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge359" class="edge">
<title>l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M26766.62,-9293.71C26597.32,-9284.68 26158.14,-9262.09 25791,-9250.5 25736.02,-9248.76 24851.95,-9253.23 24801,-9232.5 24792.86,-9229.18 24785.17,-9224.18 24778.2,-9218.5"/>
<polygon fill="black" stroke="black" points="24780.19,-9215.59 24770.37,-9211.6 24775.56,-9220.84 24780.19,-9215.59"/>
</g>
<!-- l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge360" class="edge">
<title>l1_expert2_gpu2&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M26766.42,-9297.19C26560.44,-9295.42 25969.11,-9285.73 25784,-9232.5 25768.04,-9227.91 25751.78,-9220.52 25737.08,-9212.62"/>
<polygon fill="black" stroke="black" points="25738.58,-9209.45 25728.14,-9207.65 25735.18,-9215.57 25738.58,-9209.45"/>
</g>
<!-- l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge369" class="edge">
<title>l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M25638.46,-9295.86C25459.44,-9290.94 25002.62,-9274.38 24949,-9232.5 24945.57,-9229.82 24942.75,-9226.49 24940.44,-9222.79"/>
<polygon fill="black" stroke="black" points="24943.5,-9221.07 24935.92,-9213.66 24937.22,-9224.18 24943.5,-9221.07"/>
</g>
<!-- l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge370" class="edge">
<title>l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M25638.35,-9297.23C25432.14,-9295.58 24840.18,-9286.16 24655,-9232.5 24639.17,-9227.91 24623.06,-9220.53 24608.5,-9212.62"/>
<polygon fill="black" stroke="black" points="24610.08,-9209.5 24599.65,-9207.65 24606.66,-9215.6 24610.08,-9209.5"/>
</g>
<!-- l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge371" class="edge">
<title>l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M25777.79,-9282.47C25806.48,-9272.76 25837.85,-9257.18 25858,-9232.5 25860.28,-9229.7 25862.16,-9226.57 25863.7,-9223.26"/>
<polygon fill="black" stroke="black" points="25867.09,-9224.16 25867.19,-9213.57 25860.51,-9221.78 25867.09,-9224.16"/>
</g>
<!-- l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge372" class="edge">
<title>l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M25781.71,-9298.42C25909.21,-9298.38 26168.06,-9290.88 26233,-9232.5 26236.02,-9229.79 26238.4,-9226.52 26240.28,-9222.94"/>
<polygon fill="black" stroke="black" points="26243.57,-9224.14 26243.97,-9213.56 26237.05,-9221.58 26243.57,-9224.14"/>
</g>
<!-- l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge373" class="edge">
<title>l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M25638.5,-9296.66C25507.09,-9293.76 25233.35,-9281.8 25154,-9232.5 25149.18,-9229.51 25144.89,-9225.6 25141.09,-9221.25"/>
<polygon fill="black" stroke="black" points="25143.64,-9218.84 25134.78,-9213.04 25138.09,-9223.1 25143.64,-9218.84"/>
</g>
<!-- l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge374" class="edge">
<title>l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M25781.09,-9292.86C25868.33,-9285.58 26009.21,-9268.5 26046,-9232.5 26048.77,-9229.79 26050.97,-9226.6 26052.72,-9223.15"/>
<polygon fill="black" stroke="black" points="26056.09,-9224.12 26056.33,-9213.53 26049.54,-9221.66 26056.09,-9224.12"/>
</g>
<!-- l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge375" class="edge">
<title>l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M25638.59,-9294.29C25464.48,-9286.29 25004.22,-9265.45 24620,-9250.5 24562.23,-9248.25 24156,-9246.85 24100,-9232.5 24082.08,-9227.91 24063.71,-9220.08 24047.25,-9211.73"/>
<polygon fill="black" stroke="black" points="24048.79,-9208.59 24038.31,-9207.06 24045.55,-9214.8 24048.79,-9208.59"/>
</g>
<!-- l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge376" class="edge">
<title>l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M25781.56,-9297.31C25983.88,-9295.86 26549.37,-9286.95 26611,-9232.5 26613.93,-9229.91 26616.22,-9226.78 26617.99,-9223.34"/>
<polygon fill="black" stroke="black" points="26621.38,-9224.28 26621.56,-9213.68 26614.81,-9221.85 26621.38,-9224.28"/>
</g>
<!-- l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge377" class="edge">
<title>l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M25638.6,-9294.02C25464.51,-9285.46 25004.29,-9263.42 24620,-9250.5 24578.46,-9249.1 23911.09,-9246.64 23872,-9232.5 23862.05,-9228.9 23852.44,-9223.28 23843.68,-9216.97"/>
<polygon fill="black" stroke="black" points="23845.64,-9214.06 23835.57,-9210.75 23841.38,-9219.61 23845.64,-9214.06"/>
</g>
<!-- l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge378" class="edge">
<title>l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M25781.59,-9295.77C25952.69,-9290.79 26374.71,-9274.35 26422,-9232.5 26425.03,-9229.82 26427.39,-9226.57 26429.23,-9223.01"/>
<polygon fill="black" stroke="black" points="26432.51,-9224.24 26432.79,-9213.65 26425.96,-9221.75 26432.51,-9224.24"/>
</g>
<!-- l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge379" class="edge">
<title>l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M25638.72,-9294.51C25344.81,-9281.84 24242.09,-9234.21 24238,-9232.5 24229.81,-9229.08 24222.04,-9224.02 24214.98,-9218.33"/>
<polygon fill="black" stroke="black" points="24216.87,-9215.33 24207.03,-9211.41 24212.27,-9220.61 24216.87,-9215.33"/>
</g>
<!-- l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge380" class="edge">
<title>l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M25638.99,-9291.76C25546.13,-9283.03 25389.66,-9264.08 25342,-9232.5 25337.33,-9229.41 25333.14,-9225.48 25329.4,-9221.15"/>
<polygon fill="black" stroke="black" points="25332.03,-9218.82 25323.18,-9213 25326.47,-9223.07 25332.03,-9218.82"/>
</g>
<!-- l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge381" class="edge">
<title>l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M25638.54,-9294.63C25372.48,-9283.55 24453.11,-9244.47 24425,-9232.5 24416.91,-9229.05 24409.25,-9223.98 24402.3,-9218.28"/>
<polygon fill="black" stroke="black" points="24404.28,-9215.36 24394.47,-9211.36 24399.64,-9220.6 24404.28,-9215.36"/>
</g>
<!-- l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge382" class="edge">
<title>l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M25641.52,-9283.95C25605.51,-9274.19 25562.27,-9258.12 25530,-9232.5 25525.73,-9229.11 25521.8,-9225.06 25518.24,-9220.72"/>
<polygon fill="black" stroke="black" points="25521.02,-9218.59 25512.23,-9212.68 25515.41,-9222.78 25521.02,-9218.59"/>
</g>
<!-- l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge383" class="edge">
<title>l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M25638.38,-9296.24C25432.9,-9291.87 24851.45,-9275.79 24778,-9232.5 24772.93,-9229.51 24768.45,-9225.49 24764.52,-9220.98"/>
<polygon fill="black" stroke="black" points="24767.28,-9218.83 24758.43,-9213.01 24761.72,-9223.08 24767.28,-9218.83"/>
</g>
<!-- l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge384" class="edge">
<title>l1_expert3_gpu3&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M25699.17,-9250.96C25697.07,-9241.91 25694.87,-9232.42 25692.77,-9223.38"/>
<polygon fill="black" stroke="black" points="25696.12,-9222.35 25690.45,-9213.4 25689.31,-9223.93 25696.12,-9222.35"/>
</g>
<!-- l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge393" class="edge">
<title>l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M29553.69,-9294.66C29340.69,-9286.06 28690.49,-9260.84 28151,-9250.5 27525.55,-9238.51 25961.22,-9253.52 25336,-9232.5 25197.15,-9227.83 25159.71,-9243.22 25024,-9213.5 25015.61,-9211.66 25006.99,-9209.19 24998.53,-9206.39"/>
<polygon fill="black" stroke="black" points="24999.66,-9203.08 24989.07,-9203.11 24997.37,-9209.69 24999.66,-9203.08"/>
</g>
<!-- l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge394" class="edge">
<title>l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M29553.69,-9294.64C29340.69,-9285.99 28690.49,-9260.63 28151,-9250.5 27442,-9237.18 25668.73,-9256.06 24960,-9232.5 24821.15,-9227.88 24783.71,-9243.22 24648,-9213.5 24639.61,-9211.66 24630.99,-9209.19 24622.53,-9206.39"/>
<polygon fill="black" stroke="black" points="24623.66,-9203.08 24613.07,-9203.11 24621.37,-9209.69 24623.66,-9203.08"/>
</g>
<!-- l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge395" class="edge">
<title>l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M29553.69,-9294.74C29340.68,-9286.37 28690.47,-9261.71 28151,-9250.5 27320.03,-9233.23 27111.65,-9261.37 26281,-9232.5 26139.94,-9227.6 26101.89,-9243.63 25964,-9213.5 25955.61,-9211.67 25946.99,-9209.2 25938.53,-9206.4"/>
<polygon fill="black" stroke="black" points="25939.66,-9203.09 25929.06,-9203.12 25937.37,-9209.7 25939.66,-9203.09"/>
</g>
<!-- l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge396" class="edge">
<title>l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M29553.69,-9294.83C29340.68,-9286.7 28690.45,-9262.64 28151,-9250.5 27539.55,-9236.73 27386.36,-9249.84 26775,-9232.5 26581.56,-9227.01 26529.39,-9253.27 26340,-9213.5 26331.54,-9211.72 26322.84,-9209.27 26314.31,-9206.47"/>
<polygon fill="black" stroke="black" points="26315.37,-9203.14 26304.78,-9203.18 26313.09,-9209.75 26315.37,-9203.14"/>
</g>
<!-- l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge397" class="edge">
<title>l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M29553.69,-9294.67C29340.69,-9286.11 28690.49,-9260.96 28151,-9250.5 26983.64,-9227.86 26690.91,-9272 25524,-9232.5 25385.16,-9227.8 25347.71,-9243.22 25212,-9213.5 25203.61,-9211.66 25194.99,-9209.19 25186.53,-9206.39"/>
<polygon fill="black" stroke="black" points="25187.66,-9203.08 25177.07,-9203.11 25185.37,-9209.69 25187.66,-9203.08"/>
</g>
<!-- l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge398" class="edge">
<title>l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M29553.69,-9294.76C29340.68,-9286.46 28690.47,-9261.97 28151,-9250.5 27396.02,-9234.44 27206.64,-9260.37 26452,-9232.5 26318.49,-9227.57 26282.47,-9242.24 26152,-9213.5 26143.62,-9211.65 26134.99,-9209.17 26126.53,-9206.37"/>
<polygon fill="black" stroke="black" points="26127.66,-9203.06 26117.07,-9203.09 26125.37,-9209.67 26127.66,-9203.06"/>
</g>
<!-- l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge399" class="edge">
<title>l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M29553.69,-9294.62C29340.69,-9285.91 28690.5,-9260.41 28151,-9250.5 27316.69,-9235.18 25230,-9259.87 24396,-9232.5 24257.15,-9227.94 24219.71,-9243.22 24084,-9213.5 24075.61,-9211.66 24066.99,-9209.19 24058.53,-9206.39"/>
<polygon fill="black" stroke="black" points="24059.66,-9203.08 24049.07,-9203.11 24057.37,-9209.69 24059.66,-9203.08"/>
</g>
<!-- l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge400" class="edge">
<title>l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M29553.85,-9292.7C29375.41,-9280.63 28894.46,-9249.06 28493,-9231.5 27812.67,-9201.74 26992.45,-9184.18 26717.23,-9178.79"/>
<polygon fill="black" stroke="black" points="26716.95,-9175.28 26706.88,-9178.59 26716.81,-9182.28 26716.95,-9175.28"/>
</g>
<!-- l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge401" class="edge">
<title>l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M29553.69,-9294.61C29340.69,-9285.89 28690.5,-9260.34 28151,-9250.5 27274.91,-9234.51 25083.76,-9261.14 24208,-9232.5 24138.58,-9230.23 23963.85,-9228.36 23896,-9213.5 23887.61,-9211.66 23878.99,-9209.19 23870.53,-9206.39"/>
<polygon fill="black" stroke="black" points="23871.66,-9203.08 23861.07,-9203.11 23869.37,-9209.69 23871.66,-9203.08"/>
</g>
<!-- l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge402" class="edge">
<title>l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M29553.68,-9295.07C29340.65,-9287.63 28690.39,-9265.26 28151,-9250.5 27970.69,-9245.56 26704.91,-9248.73 26528,-9213.5 26519.45,-9211.8 26510.68,-9209.38 26502.09,-9206.58"/>
<polygon fill="black" stroke="black" points="26503.08,-9203.22 26492.48,-9203.29 26500.81,-9209.84 26503.08,-9203.22"/>
</g>
<!-- l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge403" class="edge">
<title>l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M29553.69,-9294.62C29340.69,-9285.93 28690.5,-9260.47 28151,-9250.5 27358.46,-9235.84 25376.25,-9258.6 24584,-9232.5 24445.15,-9227.92 24407.71,-9243.22 24272,-9213.5 24263.61,-9211.66 24254.99,-9209.19 24246.53,-9206.39"/>
<polygon fill="black" stroke="black" points="24247.66,-9203.08 24237.07,-9203.11 24245.37,-9209.69 24247.66,-9203.08"/>
</g>
<!-- l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge404" class="edge">
<title>l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M29553.69,-9294.68C29340.69,-9286.16 28690.49,-9261.1 28151,-9250.5 27067.18,-9229.19 26795.4,-9269.46 25712,-9232.5 25573.16,-9227.76 25535.71,-9243.22 25400,-9213.5 25391.61,-9211.66 25382.99,-9209.19 25374.53,-9206.39"/>
<polygon fill="black" stroke="black" points="25375.66,-9203.08 25365.07,-9203.11 25373.37,-9209.69 25375.66,-9203.08"/>
</g>
<!-- l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge405" class="edge">
<title>l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M29553.69,-9294.63C29340.69,-9285.96 28690.5,-9260.55 28151,-9250.5 27400.23,-9236.51 25522.49,-9257.33 24772,-9232.5 24633.15,-9227.9 24595.71,-9243.22 24460,-9213.5 24451.61,-9211.66 24442.99,-9209.19 24434.53,-9206.39"/>
<polygon fill="black" stroke="black" points="24435.66,-9203.08 24425.07,-9203.11 24433.37,-9209.69 24435.66,-9203.08"/>
</g>
<!-- l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge406" class="edge">
<title>l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M29553.69,-9294.7C29340.69,-9286.22 28690.48,-9261.27 28151,-9250.5 27150.28,-9230.52 26899.33,-9267.03 25899,-9232.5 25760.6,-9227.72 25723.27,-9243.14 25588,-9213.5 25579.61,-9211.66 25570.99,-9209.19 25562.53,-9206.39"/>
<polygon fill="black" stroke="black" points="25563.66,-9203.08 25553.07,-9203.11 25561.37,-9209.69 25563.66,-9203.08"/>
</g>
<!-- l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge407" class="edge">
<title>l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M29553.69,-9294.65C29340.69,-9286.03 28690.49,-9260.73 28151,-9250.5 27483.77,-9237.84 25814.97,-9254.79 25148,-9232.5 25009.15,-9227.86 24971.71,-9243.22 24836,-9213.5 24827.61,-9211.66 24818.99,-9209.19 24810.53,-9206.39"/>
<polygon fill="black" stroke="black" points="24811.66,-9203.08 24801.07,-9203.11 24809.37,-9209.69 24811.66,-9203.08"/>
</g>
<!-- l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge408" class="edge">
<title>l1_expert4_gpu4&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M29553.69,-9294.72C29340.68,-9286.28 28690.48,-9261.46 28151,-9250.5 27232.93,-9231.84 27002.69,-9264.69 26085,-9232.5 25947.49,-9227.68 25910.4,-9242.97 25776,-9213.5 25767.61,-9211.66 25758.99,-9209.19 25750.53,-9206.39"/>
<polygon fill="black" stroke="black" points="25751.66,-9203.08 25741.07,-9203.11 25749.37,-9209.69 25751.66,-9203.08"/>
</g>
<!-- l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge417" class="edge">
<title>l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M27998.64,-9293.93C27817.98,-9284.84 27327.85,-9261.18 26919,-9250.5 26215.64,-9232.12 26039.14,-9257.89 25336,-9232.5 25197.17,-9227.49 25159.71,-9243.22 25024,-9213.5 25015.61,-9211.66 25006.99,-9209.19 24998.53,-9206.39"/>
<polygon fill="black" stroke="black" points="24999.66,-9203.08 24989.07,-9203.11 24997.37,-9209.69 24999.66,-9203.08"/>
</g>
<!-- l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge418" class="edge">
<title>l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M27998.64,-9293.88C27817.99,-9284.66 27327.86,-9260.74 26919,-9250.5 26048.57,-9228.7 25830.17,-9262.97 24960,-9232.5 24821.16,-9227.64 24783.71,-9243.22 24648,-9213.5 24639.61,-9211.66 24630.99,-9209.19 24622.53,-9206.39"/>
<polygon fill="black" stroke="black" points="24623.66,-9203.08 24613.07,-9203.11 24621.37,-9209.69 24623.66,-9203.08"/>
</g>
<!-- l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge419" class="edge">
<title>l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M27998.62,-9294.37C27817.94,-9286.29 27327.74,-9264.78 26919,-9250.5 26643.05,-9240.86 26573.86,-9244.34 26298,-9232.5 26149.45,-9226.12 26109.31,-9245.02 25964,-9213.5 25955.61,-9211.68 25946.98,-9209.22 25938.52,-9206.42"/>
<polygon fill="black" stroke="black" points="25939.65,-9203.11 25929.06,-9203.15 25937.36,-9209.73 25939.65,-9203.11"/>
</g>
<!-- l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge420" class="edge">
<title>l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M27998.68,-9294.43C27794.27,-9285.34 27188.68,-9258.12 26686,-9232.5 26532.19,-9224.66 26490.54,-9246 26340,-9213.5 26331.61,-9211.69 26322.98,-9209.23 26314.52,-9206.44"/>
<polygon fill="black" stroke="black" points="26315.65,-9203.13 26305.05,-9203.17 26313.36,-9209.74 26315.65,-9203.13"/>
</g>
<!-- l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge421" class="edge">
<title>l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M27998.64,-9293.97C27817.98,-9284.97 27327.84,-9261.5 26919,-9250.5 26299.62,-9233.83 26144.19,-9255.28 25525,-9232.5 25385.73,-9227.38 25348.14,-9243.3 25212,-9213.5 25203.61,-9211.66 25194.99,-9209.19 25186.53,-9206.39"/>
<polygon fill="black" stroke="black" points="25187.66,-9203.08 25177.06,-9203.11 25185.37,-9209.7 25187.66,-9203.08"/>
</g>
<!-- l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge422" class="edge">
<title>l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M27998.61,-9294.63C27817.9,-9287.17 27327.65,-9266.98 26919,-9250.5 26717.67,-9242.38 26667.24,-9242.58 26466,-9232.5 26326.36,-9225.5 26288.58,-9243.38 26152,-9213.5 26143.61,-9211.66 26134.99,-9209.19 26126.53,-9206.4"/>
<polygon fill="black" stroke="black" points="26127.66,-9203.08 26117.06,-9203.12 26125.37,-9209.7 26127.66,-9203.08"/>
</g>
<!-- l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge423" class="edge">
<title>l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M27998.64,-9293.82C27817.99,-9284.49 27327.87,-9260.32 26919,-9250.5 25797.96,-9223.58 25516.71,-9270.59 24396,-9232.5 24257.16,-9227.78 24219.71,-9243.22 24084,-9213.5 24075.61,-9211.66 24066.99,-9209.19 24058.53,-9206.39"/>
<polygon fill="black" stroke="black" points="24059.66,-9203.08 24049.07,-9203.11 24057.37,-9209.69 24059.66,-9203.08"/>
</g>
<!-- l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge424" class="edge">
<title>l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M27999.18,-9291.68C27760.51,-9271.81 26985.48,-9207.27 26715.65,-9184.8"/>
<polygon fill="black" stroke="black" points="26715.75,-9181.29 26705.5,-9183.95 26715.17,-9188.27 26715.75,-9181.29"/>
</g>
<!-- l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge425" class="edge">
<title>l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M27998.64,-9293.81C27817.99,-9284.45 27327.87,-9260.22 26919,-9250.5 25714.42,-9221.87 25412.23,-9273.13 24208,-9232.5 24069.16,-9227.81 24031.71,-9243.22 23896,-9213.5 23887.61,-9211.66 23878.99,-9209.19 23870.53,-9206.39"/>
<polygon fill="black" stroke="black" points="23871.66,-9203.08 23861.07,-9203.11 23869.37,-9209.69 23871.66,-9203.08"/>
</g>
<!-- l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge426" class="edge">
<title>l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M27998.57,-9295.01C27714.42,-9284.61 26672.64,-9244.69 26528,-9213.5 26519.55,-9211.68 26510.85,-9209.2 26502.33,-9206.38"/>
<polygon fill="black" stroke="black" points="26503.39,-9203.05 26492.8,-9203.08 26501.1,-9209.66 26503.39,-9203.05"/>
</g>
<!-- l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge427" class="edge">
<title>l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M27998.64,-9293.84C27817.99,-9284.54 27327.87,-9260.43 26919,-9250.5 25881.5,-9225.29 25621.2,-9268.05 24584,-9232.5 24445.16,-9227.74 24407.71,-9243.22 24272,-9213.5 24263.61,-9211.66 24254.99,-9209.19 24246.53,-9206.39"/>
<polygon fill="black" stroke="black" points="24247.66,-9203.08 24237.07,-9203.11 24245.37,-9209.69 24247.66,-9203.08"/>
</g>
<!-- l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge428" class="edge">
<title>l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M27998.63,-9294.02C27817.97,-9285.14 27327.83,-9261.91 26919,-9250.5 26384.04,-9235.56 26249.79,-9252.61 25715,-9232.5 25574.84,-9227.23 25537.02,-9243.46 25400,-9213.5 25391.61,-9211.66 25382.99,-9209.19 25374.53,-9206.4"/>
<polygon fill="black" stroke="black" points="25375.66,-9203.08 25365.06,-9203.12 25373.37,-9209.7 25375.66,-9203.08"/>
</g>
<!-- l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge429" class="edge">
<title>l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M27998.64,-9293.86C27817.99,-9284.6 27327.86,-9260.57 26919,-9250.5 25965.03,-9226.99 25725.68,-9265.51 24772,-9232.5 24633.16,-9227.69 24595.71,-9243.22 24460,-9213.5 24451.61,-9211.66 24442.99,-9209.19 24434.53,-9206.39"/>
<polygon fill="black" stroke="black" points="24435.66,-9203.08 24425.07,-9203.11 24433.37,-9209.69 24435.66,-9203.08"/>
</g>
<!-- l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge430" class="edge">
<title>l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M27998.63,-9294.09C27817.97,-9285.37 27327.81,-9262.49 26919,-9250.5 26469.34,-9237.3 26356.51,-9249.88 25907,-9232.5 25765.08,-9227.01 25726.76,-9243.79 25588,-9213.5 25579.61,-9211.67 25570.99,-9209.2 25562.53,-9206.4"/>
<polygon fill="black" stroke="black" points="25563.66,-9203.09 25553.06,-9203.12 25561.37,-9209.71 25563.66,-9203.09"/>
</g>
<!-- l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge431" class="edge">
<title>l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M27998.64,-9293.9C27817.98,-9284.74 27327.85,-9260.94 26919,-9250.5 26132.1,-9230.41 25934.66,-9260.43 25148,-9232.5 25009.16,-9227.57 24971.71,-9243.22 24836,-9213.5 24827.61,-9211.66 24818.99,-9209.19 24810.53,-9206.39"/>
<polygon fill="black" stroke="black" points="24811.66,-9203.08 24801.07,-9203.11 24809.37,-9209.69 24811.66,-9203.08"/>
</g>
<!-- l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge432" class="edge">
<title>l1_expert5_gpu5&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M27998.63,-9294.19C27817.96,-9285.7 27327.79,-9263.3 26919,-9250.5 26551.09,-9238.98 26458.78,-9247.58 26091,-9232.5 25950.86,-9226.75 25913.02,-9243.46 25776,-9213.5 25767.61,-9211.66 25758.99,-9209.19 25750.53,-9206.4"/>
<polygon fill="black" stroke="black" points="25751.66,-9203.08 25741.06,-9203.12 25749.37,-9209.7 25751.66,-9203.08"/>
</g>
<!-- l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge441" class="edge">
<title>l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M21968.57,-9294.57C22168.26,-9286.27 22748.56,-9262.86 23231,-9250.5 23731.79,-9237.66 23857.24,-9246.45 24358,-9232.5 24570.53,-9226.58 24627.84,-9256.79 24836,-9213.5 24844.47,-9211.74 24853.17,-9209.3 24861.7,-9206.5"/>
<polygon fill="black" stroke="black" points="24862.92,-9209.79 24871.23,-9203.22 24860.64,-9203.17 24862.92,-9209.79"/>
</g>
<!-- l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge442" class="edge">
<title>l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M21968.57,-9294.77C22168.28,-9286.98 22748.61,-9264.77 23231,-9250.5 23566.06,-9240.59 23649.96,-9243.2 23985,-9232.5 24196.17,-9225.76 24253.15,-9256.55 24460,-9213.5 24468.47,-9211.74 24477.17,-9209.29 24485.7,-9206.5"/>
<polygon fill="black" stroke="black" points="24486.92,-9209.78 24495.23,-9203.22 24484.64,-9203.17 24486.92,-9209.78"/>
</g>
<!-- l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge443" class="edge">
<title>l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M21968.56,-9294.39C22168.24,-9285.61 22748.52,-9261.11 23231,-9250.5 24149.92,-9230.29 24380.12,-9254.79 25299,-9232.5 25511.11,-9227.35 25568.28,-9256.71 25776,-9213.5 25784.47,-9211.74 25793.17,-9209.3 25801.7,-9206.5"/>
<polygon fill="black" stroke="black" points="25802.92,-9209.79 25811.23,-9203.22 25800.64,-9203.17 25802.92,-9209.79"/>
</g>
<!-- l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge444" class="edge">
<title>l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M21968.56,-9294.35C22168.24,-9285.49 22748.51,-9260.79 23231,-9250.5 24317,-9227.34 24589.05,-9258.12 25675,-9232.5 25887.11,-9227.49 25944.28,-9256.71 26152,-9213.5 26160.47,-9211.74 26169.17,-9209.3 26177.7,-9206.5"/>
<polygon fill="black" stroke="black" points="26178.92,-9209.79 26187.23,-9203.22 26176.64,-9203.17 26178.92,-9209.79"/>
</g>
<!-- l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge445" class="edge">
<title>l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M21968.56,-9294.51C22168.25,-9286.06 22748.54,-9262.31 23231,-9250.5 23815.77,-9236.18 23962.27,-9248.14 24547,-9232.5 24759.09,-9226.83 24816.28,-9256.71 25024,-9213.5 25032.47,-9211.74 25041.17,-9209.3 25049.7,-9206.5"/>
<polygon fill="black" stroke="black" points="25050.92,-9209.79 25059.23,-9203.22 25048.64,-9203.17 25050.92,-9209.79"/>
</g>
<!-- l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge446" class="edge">
<title>l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M21968.56,-9294.37C22168.24,-9285.55 22748.51,-9260.94 23231,-9250.5 24233.46,-9228.81 24484.59,-9256.46 25487,-9232.5 25699.11,-9227.43 25756.28,-9256.71 25964,-9213.5 25972.47,-9211.74 25981.17,-9209.3 25989.7,-9206.5"/>
<polygon fill="black" stroke="black" points="25990.92,-9209.79 25999.23,-9203.22 25988.64,-9203.17 25990.92,-9209.79"/>
</g>
<!-- l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge447" class="edge">
<title>l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M21968.39,-9295.24C22313.91,-9283.79 23799.9,-9233.6 23896,-9213.5 23904.47,-9211.73 23913.17,-9209.28 23921.69,-9206.48"/>
<polygon fill="black" stroke="black" points="23922.91,-9209.77 23931.23,-9203.2 23920.63,-9203.15 23922.91,-9209.77"/>
</g>
<!-- l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge448" class="edge">
<title>l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M21968.56,-9294.33C22168.24,-9285.41 22748.5,-9260.55 23231,-9250.5 24484.09,-9224.39 24797.98,-9261.45 26051,-9232.5 26263.11,-9227.6 26320.28,-9256.71 26528,-9213.5 26536.47,-9211.74 26545.17,-9209.3 26553.7,-9206.5"/>
<polygon fill="black" stroke="black" points="26554.92,-9209.79 26563.23,-9203.22 26552.64,-9203.17 26554.92,-9209.79"/>
</g>
<!-- l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge449" class="edge">
<title>l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M21968.2,-9293.08C22261.44,-9274.51 23375.8,-9203.98 23707.99,-9182.95"/>
<polygon fill="black" stroke="black" points="23708.3,-9186.44 23718.06,-9182.31 23707.86,-9179.45 23708.3,-9186.44"/>
</g>
<!-- l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge450" class="edge">
<title>l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M21968.56,-9294.34C22168.24,-9285.45 22748.51,-9260.66 23231,-9250.5 24400.55,-9225.87 24693.51,-9259.78 25863,-9232.5 26075.11,-9227.55 26132.28,-9256.71 26340,-9213.5 26348.47,-9211.74 26357.17,-9209.3 26365.7,-9206.5"/>
<polygon fill="black" stroke="black" points="26366.92,-9209.79 26375.23,-9203.22 26364.64,-9203.17 26366.92,-9209.79"/>
</g>
<!-- l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge451" class="edge">
<title>l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M21968.4,-9295.01C22205.02,-9286.46 22985.07,-9258.1 23630,-9232.5 23831.8,-9224.49 23886.32,-9254.83 24084,-9213.5 24092.47,-9211.73 24101.17,-9209.28 24109.69,-9206.49"/>
<polygon fill="black" stroke="black" points="24110.91,-9209.77 24119.23,-9203.2 24108.63,-9203.15 24110.91,-9209.77"/>
</g>
<!-- l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge452" class="edge">
<title>l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M21968.56,-9294.47C22168.25,-9285.91 22748.53,-9261.9 23231,-9250.5 23899.31,-9234.71 24066.73,-9249.8 24735,-9232.5 24947.1,-9227.01 25004.28,-9256.71 25212,-9213.5 25220.47,-9211.74 25229.17,-9209.3 25237.7,-9206.5"/>
<polygon fill="black" stroke="black" points="25238.92,-9209.79 25247.23,-9203.22 25236.64,-9203.17 25238.92,-9209.79"/>
</g>
<!-- l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge453" class="edge">
<title>l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M21968.58,-9294.96C22168.3,-9287.65 22748.67,-9266.57 23231,-9250.5 23486.09,-9242 23549.93,-9241.69 23805,-9232.5 24012.59,-9225.02 24068.64,-9255.89 24272,-9213.5 24280.47,-9211.73 24289.17,-9209.29 24297.7,-9206.5"/>
<polygon fill="black" stroke="black" points="24298.92,-9209.78 24307.23,-9203.21 24296.63,-9203.16 24298.92,-9209.78"/>
</g>
<!-- l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge454" class="edge">
<title>l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M21968.56,-9294.44C22168.25,-9285.79 22748.53,-9261.58 23231,-9250.5 23982.84,-9233.23 24171.2,-9251.47 24923,-9232.5 25135.1,-9227.15 25192.28,-9256.71 25400,-9213.5 25408.47,-9211.74 25417.17,-9209.3 25425.7,-9206.5"/>
<polygon fill="black" stroke="black" points="25426.92,-9209.79 25435.23,-9203.22 25424.64,-9203.17 25426.92,-9209.79"/>
</g>
<!-- l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge455" class="edge">
<title>l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M21968.57,-9294.65C22168.27,-9286.56 22748.58,-9263.65 23231,-9250.5 23647.37,-9239.15 23751.66,-9244.74 24168,-9232.5 24381.41,-9226.23 24438.97,-9256.95 24648,-9213.5 24656.47,-9211.74 24665.17,-9209.3 24673.7,-9206.51"/>
<polygon fill="black" stroke="black" points="24674.92,-9209.79 24683.23,-9203.22 24672.64,-9203.17 24674.92,-9209.79"/>
</g>
<!-- l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge456" class="edge">
<title>l1_expert6_gpu6&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M21968.56,-9294.41C22168.25,-9285.69 22748.52,-9261.32 23231,-9250.5 24066.38,-9231.76 24275.66,-9253.13 25111,-9232.5 25323.1,-9227.26 25380.28,-9256.71 25588,-9213.5 25596.47,-9211.74 25605.17,-9209.3 25613.7,-9206.5"/>
<polygon fill="black" stroke="black" points="25614.92,-9209.79 25623.23,-9203.22 25612.64,-9203.17 25614.92,-9209.79"/>
</g>
<!-- l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu0 -->
<g id="edge465" class="edge">
<title>l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M23381.27,-9289.31C23478.39,-9278.26 23659.21,-9259.09 23814,-9250.5 23870.7,-9247.35 24781.35,-9247.95 24836,-9232.5 24850.52,-9228.39 24865.1,-9221.47 24878.3,-9213.89"/>
<polygon fill="black" stroke="black" points="24880.42,-9216.7 24887.2,-9208.55 24876.83,-9210.69 24880.42,-9216.7"/>
</g>
<!-- l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu1 -->
<g id="edge466" class="edge">
<title>l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M23381.28,-9289.48C23478.41,-9278.62 23659.25,-9259.67 23814,-9250.5 23853.89,-9248.14 24500.41,-9255.62 24533,-9232.5 24536.79,-9229.81 24539.89,-9226.35 24542.44,-9222.47"/>
<polygon fill="black" stroke="black" points="24545.63,-9223.92 24547.17,-9213.44 24539.43,-9220.67 24545.63,-9223.92"/>
</g>
<!-- l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu2 -->
<g id="edge467" class="edge">
<title>l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M23381.26,-9289.12C23478.37,-9277.85 23659.18,-9258.42 23814,-9250.5 23869.79,-9247.64 25774.68,-9256.76 25825,-9232.5 25831.31,-9229.46 25837.02,-9225.06 25842.09,-9220.05"/>
<polygon fill="black" stroke="black" points="25844.94,-9222.12 25849.07,-9212.37 25839.76,-9217.42 25844.94,-9222.12"/>
</g>
<!-- l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu3 -->
<g id="edge468" class="edge">
<title>l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M23381.25,-9289.09C23478.36,-9277.78 23659.17,-9258.31 23814,-9250.5 23847.1,-9248.83 26170.06,-9246.71 26200,-9232.5 26206.38,-9229.47 26212.18,-9225.08 26217.35,-9220.07"/>
<polygon fill="black" stroke="black" points="26220.24,-9222.11 26224.47,-9212.39 26215.11,-9217.35 26220.24,-9222.11"/>
</g>
<!-- l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu4 -->
<g id="edge469" class="edge">
<title>l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M23381.26,-9289.23C23478.38,-9278.1 23659.2,-9258.83 23814,-9250.5 23849.15,-9248.61 25050.09,-9249.33 25081,-9232.5 25086.28,-9229.63 25090.94,-9225.64 25095.01,-9221.1"/>
<polygon fill="black" stroke="black" points="25097.9,-9223.09 25101.32,-9213.06 25092.39,-9218.77 25097.9,-9223.09"/>
</g>
<!-- l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu5 -->
<g id="edge470" class="edge">
<title>l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M23381.26,-9289.1C23478.37,-9277.82 23659.18,-9258.37 23814,-9250.5 23874.59,-9247.42 25941.6,-9254.85 25998,-9232.5 26006.52,-9229.12 26014.57,-9223.91 26021.83,-9218.01"/>
<polygon fill="black" stroke="black" points="26024.18,-9220.61 26029.39,-9211.39 26019.56,-9215.34 26024.18,-9220.61"/>
</g>
<!-- l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu6 -->
<g id="edge471" class="edge">
<title>l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M23381.87,-9291.79C23529.34,-9279.45 23859.58,-9250.27 23908,-9232.5 23919.71,-9228.2 23931.38,-9221.87 23942.08,-9215.02"/>
<polygon fill="black" stroke="black" points="23944.07,-9217.9 23950.44,-9209.44 23940.18,-9212.08 23944.07,-9217.9"/>
</g>
<!-- l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu7 -->
<g id="edge472" class="edge">
<title>l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M23381.25,-9289.06C23478.36,-9277.73 23659.17,-9258.24 23814,-9250.5 23852.31,-9248.58 26541.33,-9248.93 26576,-9232.5 26582.38,-9229.47 26588.19,-9225.08 26593.36,-9220.08"/>
<polygon fill="black" stroke="black" points="26596.25,-9222.11 26600.47,-9212.4 26591.11,-9217.36 26596.25,-9222.11"/>
</g>
<!-- l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu8 -->
<g id="edge473" class="edge">
<title>l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M23377.73,-9281.19C23466.24,-9259.46 23622.45,-9221.09 23718.63,-9197.47"/>
<polygon fill="black" stroke="black" points="23719.73,-9200.81 23728.61,-9195.02 23718.06,-9194.01 23719.73,-9200.81"/>
</g>
<!-- l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu9 -->
<g id="edge474" class="edge">
<title>l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M23381.25,-9289.07C23478.36,-9277.76 23659.17,-9258.27 23814,-9250.5 23885.02,-9246.93 26307.87,-9258.66 26374,-9232.5 26382.53,-9229.13 26390.57,-9223.92 26397.84,-9218.02"/>
<polygon fill="black" stroke="black" points="26400.18,-9220.62 26405.4,-9211.4 26395.57,-9215.35 26400.18,-9220.62"/>
</g>
<!-- l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu10 -->
<g id="edge475" class="edge">
<title>l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M23381.73,-9290.04C23479.01,-9279.88 23659.61,-9261.77 23814,-9250.5 23852.06,-9247.72 24126.18,-9255.01 24157,-9232.5 24160.7,-9229.79 24163.75,-9226.35 24166.27,-9222.51"/>
<polygon fill="black" stroke="black" points="24169.4,-9224.07 24170.95,-9213.59 24163.2,-9220.82 24169.4,-9224.07"/>
</g>
<!-- l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu11 -->
<g id="edge476" class="edge">
<title>l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M23381.26,-9289.19C23478.38,-9278.01 23659.19,-9258.68 23814,-9250.5 23854.53,-9248.36 25240.12,-9253.26 25275,-9232.5 25279.74,-9229.68 25283.81,-9225.84 25287.3,-9221.49"/>
<polygon fill="black" stroke="black" points="25290.2,-9223.45 25292.95,-9213.22 25284.42,-9219.5 25290.2,-9223.45"/>
</g>
<!-- l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu12 -->
<g id="edge477" class="edge">
<title>l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M23381.3,-9289.78C23478.45,-9279.27 23659.31,-9260.71 23814,-9250.5 23865.81,-9247.08 24231.52,-9248.26 24281,-9232.5 24293.71,-9228.45 24306.34,-9221.94 24317.82,-9214.78"/>
<polygon fill="black" stroke="black" points="24319.89,-9217.61 24326.36,-9209.21 24316.07,-9211.74 24319.89,-9217.61"/>
</g>
<!-- l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu13 -->
<g id="edge478" class="edge">
<title>l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M23381.26,-9289.16C23478.37,-9277.94 23659.19,-9258.58 23814,-9250.5 23859.75,-9248.11 25423.62,-9255.9 25463,-9232.5 25467.74,-9229.68 25471.82,-9225.84 25475.3,-9221.5"/>
<polygon fill="black" stroke="black" points="25478.2,-9223.46 25480.95,-9213.23 25472.42,-9219.51 25478.2,-9223.46"/>
</g>
<!-- l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu14 -->
<g id="edge479" class="edge">
<title>l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M23381.27,-9289.37C23478.4,-9278.39 23659.23,-9259.29 23814,-9250.5 23863.43,-9247.69 24661.59,-9256.3 24705,-9232.5 24710.27,-9229.61 24714.92,-9225.61 24718.99,-9221.07"/>
<polygon fill="black" stroke="black" points="24721.89,-9223.05 24725.3,-9213.02 24716.38,-9218.74 24721.89,-9223.05"/>
</g>
<!-- l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu15 -->
<g id="edge480" class="edge">
<title>l1_expert7_gpu7&#45;&gt;l1_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M23381.26,-9289.14C23478.37,-9277.89 23659.18,-9258.49 23814,-9250.5 23839.48,-9249.18 25629.06,-9245.52 25651,-9232.5 25655.75,-9229.68 25659.82,-9225.85 25663.3,-9221.5"/>
<polygon fill="black" stroke="black" points="25666.2,-9223.47 25668.96,-9213.24 25660.42,-9219.52 25666.2,-9223.47"/>
</g>
<!-- l2_qkv_gpu0 -->
<g id="node601" class="node">
<title>l2_qkv_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24907" cy="-9032.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="24907" y="-9051.22" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="24907" y="-9036.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24907" y="-9021.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="24907" y="-9006.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_expert_agg_gpu0&#45;&gt;l2_qkv_gpu0 -->
<g id="edge2433" class="edge">
<title>l1_expert_agg_gpu0&#45;&gt;l2_qkv_gpu0</title>
<path fill="none" stroke="black" d="M24924.08,-9138.54C24921.7,-9123.88 24918.89,-9106.64 24916.26,-9090.4"/>
<polygon fill="black" stroke="black" points="24919.7,-9089.76 24914.64,-9080.45 24912.79,-9090.88 24919.7,-9089.76"/>
</g>
<!-- l2_qkv_gpu1 -->
<g id="node602" class="node">
<title>l2_qkv_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24503" cy="-9032.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="24503" y="-9051.22" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="24503" y="-9036.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24503" y="-9021.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="24503" y="-9006.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_expert_agg_gpu1&#45;&gt;l2_qkv_gpu1 -->
<g id="edge2434" class="edge">
<title>l1_expert_agg_gpu1&#45;&gt;l2_qkv_gpu1</title>
<path fill="none" stroke="black" d="M24541,-9138.9C24535.6,-9123.91 24529.2,-9106.15 24523.21,-9089.52"/>
<polygon fill="black" stroke="black" points="24526.42,-9088.11 24519.74,-9079.89 24519.84,-9090.48 24526.42,-9088.11"/>
</g>
<!-- l2_qkv_gpu2 -->
<g id="node603" class="node">
<title>l2_qkv_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25917" cy="-9032.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="25917" y="-9051.22" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="25917" y="-9036.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25917" y="-9021.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="25917" y="-9006.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_expert_agg_gpu2&#45;&gt;l2_qkv_gpu2 -->
<g id="edge2435" class="edge">
<title>l1_expert_agg_gpu2&#45;&gt;l2_qkv_gpu2</title>
<path fill="none" stroke="black" d="M25882.1,-9138.54C25887.06,-9123.61 25892.91,-9105.99 25898.39,-9089.48"/>
<polygon fill="black" stroke="black" points="25901.73,-9090.52 25901.56,-9079.93 25895.09,-9088.31 25901.73,-9090.52"/>
</g>
<!-- l2_qkv_gpu3 -->
<g id="node604" class="node">
<title>l2_qkv_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26321" cy="-9032.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="26321" y="-9051.22" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="26321" y="-9036.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26321" y="-9021.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="26321" y="-9006.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_expert_agg_gpu3&#45;&gt;l2_qkv_gpu3 -->
<g id="edge2436" class="edge">
<title>l1_expert_agg_gpu3&#45;&gt;l2_qkv_gpu3</title>
<path fill="none" stroke="black" d="M26264.93,-9139.27C26273.17,-9123.71 26283.01,-9105.14 26292.13,-9087.92"/>
<polygon fill="black" stroke="black" points="26295.23,-9089.53 26296.82,-9079.06 26289.05,-9086.26 26295.23,-9089.53"/>
</g>
<!-- l2_qkv_gpu4 -->
<g id="node605" class="node">
<title>l2_qkv_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25109" cy="-9032.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="25109" y="-9051.22" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="25109" y="-9036.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25109" y="-9021.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="25109" y="-9006.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_expert_agg_gpu4&#45;&gt;l2_qkv_gpu4 -->
<g id="edge2437" class="edge">
<title>l1_expert_agg_gpu4&#45;&gt;l2_qkv_gpu4</title>
<path fill="none" stroke="black" d="M25115.66,-9138.17C25114.74,-9123.72 25113.66,-9106.79 25112.65,-9090.81"/>
<polygon fill="black" stroke="black" points="25116.12,-9090.24 25111.99,-9080.48 25109.13,-9090.69 25116.12,-9090.24"/>
</g>
<!-- l2_qkv_gpu5 -->
<g id="node606" class="node">
<title>l2_qkv_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="26119" cy="-9032.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="26119" y="-9051.22" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="26119" y="-9036.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="26119" y="-9021.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="26119" y="-9006.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_expert_agg_gpu5&#45;&gt;l2_qkv_gpu5 -->
<g id="edge2438" class="edge">
<title>l1_expert_agg_gpu5&#45;&gt;l2_qkv_gpu5</title>
<path fill="none" stroke="black" d="M26073.55,-9138.9C26080.1,-9123.7 26087.88,-9105.65 26095.13,-9088.82"/>
<polygon fill="black" stroke="black" points="26098.35,-9090.19 26099.09,-9079.63 26091.92,-9087.42 26098.35,-9090.19"/>
</g>
<!-- l2_qkv_gpu6 -->
<g id="node607" class="node">
<title>l2_qkv_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="23897" cy="-9032.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="23897" y="-9051.22" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="23897" y="-9036.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="23897" y="-9021.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="23897" y="-9006.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_expert_agg_gpu6&#45;&gt;l2_qkv_gpu6 -->
<g id="edge2439" class="edge">
<title>l1_expert_agg_gpu6&#45;&gt;l2_qkv_gpu6</title>
<path fill="none" stroke="black" d="M23966.77,-9139.64C23956.28,-9123.66 23943.65,-9104.44 23932.04,-9086.76"/>
<polygon fill="black" stroke="black" points="23934.85,-9084.67 23926.44,-9078.23 23929,-9088.51 23934.85,-9084.67"/>
</g>
<!-- l2_qkv_gpu7 -->
<g id="node608" class="node">
<title>l2_qkv_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="26725" cy="-9032.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="26725" y="-9051.22" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="26725" y="-9036.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="26725" y="-9021.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="26725" y="-9006.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_expert_agg_gpu7&#45;&gt;l2_qkv_gpu7 -->
<g id="edge2440" class="edge">
<title>l1_expert_agg_gpu7&#45;&gt;l2_qkv_gpu7</title>
<path fill="none" stroke="black" d="M26647.46,-9140C26659.34,-9123.67 26673.73,-9103.89 26686.88,-9085.82"/>
<polygon fill="black" stroke="black" points="26689.76,-9087.8 26692.81,-9077.66 26684.1,-9083.69 26689.76,-9087.8"/>
</g>
<!-- l2_qkv_gpu8 -->
<g id="node609" class="node">
<title>l2_qkv_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="23695" cy="-9032.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="23695" y="-9051.22" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="23695" y="-9036.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="23695" y="-9021.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="23695" y="-9006.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_expert_agg_gpu8&#45;&gt;l2_qkv_gpu8 -->
<g id="edge2441" class="edge">
<title>l1_expert_agg_gpu8&#45;&gt;l2_qkv_gpu8</title>
<path fill="none" stroke="black" d="M23775.55,-9140C23763.15,-9123.6 23748.13,-9103.71 23734.43,-9085.58"/>
<polygon fill="black" stroke="black" points="23737.06,-9083.26 23728.24,-9077.4 23731.48,-9087.48 23737.06,-9083.26"/>
</g>
<!-- l2_qkv_gpu9 -->
<g id="node610" class="node">
<title>l2_qkv_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26523" cy="-9032.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="26523" y="-9051.22" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="26523" y="-9036.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26523" y="-9021.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="26523" y="-9006.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_expert_agg_gpu9&#45;&gt;l2_qkv_gpu9 -->
<g id="edge2442" class="edge">
<title>l1_expert_agg_gpu9&#45;&gt;l2_qkv_gpu9</title>
<path fill="none" stroke="black" d="M26456.23,-9139.64C26466.27,-9123.66 26478.36,-9104.44 26489.47,-9086.76"/>
<polygon fill="black" stroke="black" points="26492.47,-9088.56 26494.83,-9078.23 26486.54,-9084.83 26492.47,-9088.56"/>
</g>
<!-- l2_qkv_gpu10 -->
<g id="node611" class="node">
<title>l2_qkv_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="24099" cy="-9032.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="24099" y="-9051.22" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="24099" y="-9036.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="24099" y="-9021.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="24099" y="-9006.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_expert_agg_gpu10&#45;&gt;l2_qkv_gpu10 -->
<g id="edge2443" class="edge">
<title>l1_expert_agg_gpu10&#45;&gt;l2_qkv_gpu10</title>
<path fill="none" stroke="black" d="M24158.06,-9139.27C24149.35,-9123.65 24138.93,-9104.97 24129.28,-9087.69"/>
<polygon fill="black" stroke="black" points="24132.25,-9085.82 24124.32,-9078.8 24126.14,-9089.24 24132.25,-9085.82"/>
</g>
<!-- l2_qkv_gpu11 -->
<g id="node612" class="node">
<title>l2_qkv_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="25311" cy="-9032.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="25311" y="-9051.22" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="25311" y="-9036.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="25311" y="-9021.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="25311" y="-9006.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_expert_agg_gpu11&#45;&gt;l2_qkv_gpu11 -->
<g id="edge2444" class="edge">
<title>l1_expert_agg_gpu11&#45;&gt;l2_qkv_gpu11</title>
<path fill="none" stroke="black" d="M25307.3,-9138.17C25307.81,-9123.79 25308.4,-9106.95 25308.97,-9091.04"/>
<polygon fill="black" stroke="black" points="25312.47,-9090.86 25309.33,-9080.75 25305.48,-9090.62 25312.47,-9090.86"/>
</g>
<!-- l2_qkv_gpu12 -->
<g id="node613" class="node">
<title>l2_qkv_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="24301" cy="-9032.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="24301" y="-9051.22" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="24301" y="-9036.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="24301" y="-9021.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="24301" y="-9006.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_expert_agg_gpu12&#45;&gt;l2_qkv_gpu12 -->
<g id="edge2445" class="edge">
<title>l1_expert_agg_gpu12&#45;&gt;l2_qkv_gpu12</title>
<path fill="none" stroke="black" d="M24349.43,-9138.9C24342.42,-9123.63 24334.09,-9105.49 24326.33,-9088.59"/>
<polygon fill="black" stroke="black" points="24329.45,-9086.99 24322.09,-9079.36 24323.09,-9089.91 24329.45,-9086.99"/>
</g>
<!-- l2_qkv_gpu13 -->
<g id="node614" class="node">
<title>l2_qkv_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="25513" cy="-9032.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="25513" y="-9051.22" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="25513" y="-9036.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="25513" y="-9021.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="25513" y="-9006.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_expert_agg_gpu13&#45;&gt;l2_qkv_gpu13 -->
<g id="edge2446" class="edge">
<title>l1_expert_agg_gpu13&#45;&gt;l2_qkv_gpu13</title>
<path fill="none" stroke="black" d="M25498.89,-9138.54C25500.86,-9123.88 25503.17,-9106.64 25505.35,-9090.4"/>
<polygon fill="black" stroke="black" points="25508.83,-9090.83 25506.69,-9080.45 25501.89,-9089.9 25508.83,-9090.83"/>
</g>
<!-- l2_qkv_gpu14 -->
<g id="node615" class="node">
<title>l2_qkv_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="24705" cy="-9032.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="24705" y="-9051.22" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="24705" y="-9036.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="24705" y="-9021.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="24705" y="-9006.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_expert_agg_gpu14&#45;&gt;l2_qkv_gpu14 -->
<g id="edge2447" class="edge">
<title>l1_expert_agg_gpu14&#45;&gt;l2_qkv_gpu14</title>
<path fill="none" stroke="black" d="M24732.47,-9138.54C24728.62,-9123.81 24724.09,-9106.48 24719.83,-9090.17"/>
<polygon fill="black" stroke="black" points="24723.14,-9088.98 24717.22,-9080.19 24716.37,-9090.75 24723.14,-9088.98"/>
</g>
<!-- l2_qkv_gpu15 -->
<g id="node616" class="node">
<title>l2_qkv_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="25715" cy="-9032.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="25715" y="-9051.22" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="25715" y="-9036.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="25715" y="-9021.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="25715" y="-9006.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_expert_agg_gpu15&#45;&gt;l2_qkv_gpu15 -->
<g id="edge2448" class="edge">
<title>l1_expert_agg_gpu15&#45;&gt;l2_qkv_gpu15</title>
<path fill="none" stroke="black" d="M25690.5,-9138.54C25693.93,-9123.81 25697.97,-9106.48 25701.77,-9090.17"/>
<polygon fill="black" stroke="black" points="25705.24,-9090.72 25704.1,-9080.19 25698.42,-9089.13 25705.24,-9090.72"/>
</g>
<!-- l2_attn_stage0_gpu0 -->
<g id="node345" class="node">
<title>l2_attn_stage0_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24966" cy="-8888.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24966" y="-8900.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="24966" y="-8885.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24966" y="-8870.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu0 -->
<g id="node361" class="node">
<title>l2_attn_stage1_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24966" cy="-8741.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24966" y="-8753.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="24966" y="-8738.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24966" y="-8723.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu0&#45;&gt;l2_attn_stage1_gpu0 -->
<g id="edge561" class="edge">
<title>l2_attn_stage0_gpu0&#45;&gt;l2_attn_stage1_gpu0</title>
<path fill="none" stroke="black" d="M24966,-8851.24C24966,-8832.52 24966,-8809.53 24966,-8789.55"/>
<polygon fill="black" stroke="black" points="24969.5,-8789.41 24966,-8779.41 24962.5,-8789.41 24969.5,-8789.41"/>
</g>
<!-- l2_attn_stage1_gpu[next_gpu] -->
<g id="node1360" class="node">
<title>l2_attn_stage1_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="26983" cy="-8741.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="26983" y="-8738.13" font-family="Times,serif" font-size="14.00">l2_attn_stage1_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage0_gpu0&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge2449" class="edge">
<title>l2_attn_stage0_gpu0&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25019.28,-8858.78C25033.41,-8852.44 25048.94,-8846.64 25064,-8843.33 25103.2,-8834.71 26471.13,-8846.63 26509,-8833.33 26519.15,-8829.77 26517.89,-8822 26528,-8818.33 26558.62,-8807.23 26789.15,-8817.15 26821,-8810.33 26864.66,-8800.98 26911.41,-8780.22 26943.42,-8764.17"/>
<polygon fill="red" stroke="red" points="26945.12,-8767.23 26952.45,-8759.57 26941.95,-8760.99 26945.12,-8767.23"/>
<text text-anchor="middle" x="26559.5" y="-8822.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu1 -->
<g id="node346" class="node">
<title>l2_attn_stage0_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24576" cy="-8888.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24576" y="-8900.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="24576" y="-8885.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24576" y="-8870.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu1 -->
<g id="node362" class="node">
<title>l2_attn_stage1_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24576" cy="-8741.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24576" y="-8753.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="24576" y="-8738.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24576" y="-8723.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu1&#45;&gt;l2_attn_stage1_gpu1 -->
<g id="edge562" class="edge">
<title>l2_attn_stage0_gpu1&#45;&gt;l2_attn_stage1_gpu1</title>
<path fill="none" stroke="black" d="M24576,-8851.24C24576,-8832.52 24576,-8809.53 24576,-8789.55"/>
<polygon fill="black" stroke="black" points="24579.5,-8789.41 24576,-8779.41 24572.5,-8789.41 24579.5,-8789.41"/>
</g>
<!-- l2_attn_stage0_gpu1&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge2450" class="edge">
<title>l2_attn_stage0_gpu1&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24629.28,-8858.77C24643.41,-8852.43 24658.94,-8846.64 24674,-8843.33 24719.12,-8833.43 26293.41,-8848.61 26337,-8833.33 26347.15,-8829.77 26345.87,-8821.95 26356,-8818.33 26404.67,-8800.97 26770.42,-8820.9 26821,-8810.33 26864.84,-8801.17 26911.74,-8780.28 26943.74,-8764.14"/>
<polygon fill="red" stroke="red" points="26945.46,-8767.2 26952.76,-8759.52 26942.27,-8760.97 26945.46,-8767.2"/>
<text text-anchor="middle" x="26387.5" y="-8822.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu2 -->
<g id="node347" class="node">
<title>l2_attn_stage0_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25941" cy="-8888.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25941" y="-8900.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="25941" y="-8885.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25941" y="-8870.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu2 -->
<g id="node363" class="node">
<title>l2_attn_stage1_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25941" cy="-8741.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25941" y="-8753.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="25941" y="-8738.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25941" y="-8723.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu2&#45;&gt;l2_attn_stage1_gpu2 -->
<g id="edge563" class="edge">
<title>l2_attn_stage0_gpu2&#45;&gt;l2_attn_stage1_gpu2</title>
<path fill="none" stroke="black" d="M25941,-8851.24C25941,-8832.52 25941,-8809.53 25941,-8789.55"/>
<polygon fill="black" stroke="black" points="25944.5,-8789.41 25941,-8779.41 25937.5,-8789.41 25944.5,-8789.41"/>
</g>
<!-- l2_attn_stage0_gpu2&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge2451" class="edge">
<title>l2_attn_stage0_gpu2&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25994.29,-8858.83C26008.42,-8852.49 26023.95,-8846.68 26039,-8843.33 26063.41,-8837.91 26917.88,-8846.71 26939,-8833.33 26960.94,-8819.43 26972.24,-8791.15 26977.85,-8769.89"/>
<polygon fill="red" stroke="red" points="26981.27,-8770.64 26980.18,-8760.1 26974.46,-8769.02 26981.27,-8770.64"/>
<text text-anchor="middle" x="26985.5" y="-8822.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu3 -->
<g id="node348" class="node">
<title>l2_attn_stage0_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26331" cy="-8888.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26331" y="-8900.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="26331" y="-8885.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26331" y="-8870.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu3 -->
<g id="node364" class="node">
<title>l2_attn_stage1_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26331" cy="-8741.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26331" y="-8753.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="26331" y="-8738.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26331" y="-8723.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu3&#45;&gt;l2_attn_stage1_gpu3 -->
<g id="edge564" class="edge">
<title>l2_attn_stage0_gpu3&#45;&gt;l2_attn_stage1_gpu3</title>
<path fill="none" stroke="black" d="M26277.7,-8858.89C26263.85,-8852.63 26248.69,-8846.85 26234,-8843.33 26220.37,-8840.07 25991.71,-8843.43 25982,-8833.33 25977.38,-8828.53 25977.36,-8823.12 25982,-8818.33 25991.75,-8808.27 26220.7,-8814.74 26234,-8810.33 26252.4,-8804.24 26270.44,-8793.44 26285.87,-8782.25"/>
<polygon fill="black" stroke="black" points="26288.27,-8784.83 26294.16,-8776.02 26284.06,-8779.23 26288.27,-8784.83"/>
</g>
<!-- l2_attn_stage0_gpu3&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge2452" class="edge">
<title>l2_attn_stage0_gpu3&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26384.3,-8858.86C26398.43,-8852.52 26413.96,-8846.7 26429,-8843.33 26447.49,-8839.19 27097.7,-8846.83 27111,-8833.33 27139.36,-8804.56 27091.79,-8778.72 27046.82,-8762.1"/>
<polygon fill="red" stroke="red" points="27047.88,-8758.76 27037.29,-8758.69 27045.53,-8765.35 27047.88,-8758.76"/>
<text text-anchor="middle" x="27150.5" y="-8822.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu4 -->
<g id="node349" class="node">
<title>l2_attn_stage0_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25161" cy="-8888.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25161" y="-8900.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="25161" y="-8885.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25161" y="-8870.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu4 -->
<g id="node365" class="node">
<title>l2_attn_stage1_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25161" cy="-8741.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25161" y="-8753.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="25161" y="-8738.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25161" y="-8723.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu4&#45;&gt;l2_attn_stage1_gpu4 -->
<g id="edge565" class="edge">
<title>l2_attn_stage0_gpu4&#45;&gt;l2_attn_stage1_gpu4</title>
<path fill="none" stroke="black" d="M25161,-8851.24C25161,-8832.52 25161,-8809.53 25161,-8789.55"/>
<polygon fill="black" stroke="black" points="25164.5,-8789.41 25161,-8779.41 25157.5,-8789.41 25164.5,-8789.41"/>
</g>
<!-- l2_attn_stage0_gpu4&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge2453" class="edge">
<title>l2_attn_stage0_gpu4&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25214.28,-8858.79C25228.42,-8852.45 25243.95,-8846.65 25259,-8843.33 25295.24,-8835.35 26559.99,-8845.63 26595,-8833.33 26605.15,-8829.77 26603.91,-8822.06 26614,-8818.33 26657.19,-8802.4 26776.04,-8820.23 26821,-8810.33 26864.6,-8800.73 26911.37,-8780.01 26943.39,-8764.04"/>
<polygon fill="red" stroke="red" points="26945.08,-8767.1 26952.42,-8759.46 26941.92,-8760.86 26945.08,-8767.1"/>
<text text-anchor="middle" x="26645.5" y="-8822.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu5 -->
<g id="node350" class="node">
<title>l2_attn_stage0_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="26136" cy="-8888.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26136" y="-8900.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="26136" y="-8885.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="26136" y="-8870.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu5 -->
<g id="node366" class="node">
<title>l2_attn_stage1_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="26136" cy="-8741.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26136" y="-8753.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="26136" y="-8738.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="26136" y="-8723.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu5&#45;&gt;l2_attn_stage1_gpu5 -->
<g id="edge566" class="edge">
<title>l2_attn_stage0_gpu5&#45;&gt;l2_attn_stage1_gpu5</title>
<path fill="none" stroke="black" d="M26080.85,-8859.37C26067.43,-8853.33 26052.93,-8847.53 26039,-8843.33 26025.22,-8839.18 25984.36,-8844.27 25975,-8833.33 25940.08,-8792.53 25980.79,-8832.65 26039,-8810.33 26056.78,-8803.51 26074.42,-8792.77 26089.68,-8781.84"/>
<polygon fill="black" stroke="black" points="26091.93,-8784.53 26097.9,-8775.77 26087.77,-8778.89 26091.93,-8784.53"/>
</g>
<!-- l2_attn_stage0_gpu5&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge2454" class="edge">
<title>l2_attn_stage0_gpu5&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26189.29,-8858.84C26203.43,-8852.5 26218.95,-8846.69 26234,-8843.33 26255.45,-8838.55 27009.56,-8848.97 27025,-8833.33 27043.16,-8814.94 27025.89,-8787.25 27008.31,-8767.34"/>
<polygon fill="red" stroke="red" points="27010.75,-8764.82 27001.38,-8759.87 27005.61,-8769.58 27010.75,-8764.82"/>
<text text-anchor="middle" x="27063.5" y="-8822.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu6 -->
<g id="node351" class="node">
<title>l2_attn_stage0_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="23991" cy="-8888.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23991" y="-8900.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="23991" y="-8885.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="23991" y="-8870.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu6 -->
<g id="node367" class="node">
<title>l2_attn_stage1_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="23991" cy="-8741.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23991" y="-8753.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="23991" y="-8738.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="23991" y="-8723.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu6&#45;&gt;l2_attn_stage1_gpu6 -->
<g id="edge567" class="edge">
<title>l2_attn_stage0_gpu6&#45;&gt;l2_attn_stage1_gpu6</title>
<path fill="none" stroke="black" d="M23991,-8851.24C23991,-8832.52 23991,-8809.53 23991,-8789.55"/>
<polygon fill="black" stroke="black" points="23994.5,-8789.41 23991,-8779.41 23987.5,-8789.41 23994.5,-8789.41"/>
</g>
<!-- l2_attn_stage0_gpu6&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge2455" class="edge">
<title>l2_attn_stage0_gpu6&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24044.28,-8858.76C24058.41,-8852.42 24073.94,-8846.63 24089,-8843.33 24143,-8831.5 26026.82,-8851.59 26079,-8833.33 26089.15,-8829.78 26087.86,-8821.92 26098,-8818.33 26135.87,-8804.95 26781.66,-8818.43 26821,-8810.33 26864.87,-8801.31 26911.77,-8780.39 26943.76,-8764.22"/>
<polygon fill="red" stroke="red" points="26945.48,-8767.27 26952.78,-8759.58 26942.28,-8761.04 26945.48,-8767.27"/>
<text text-anchor="middle" x="26129.5" y="-8822.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu7 -->
<g id="node352" class="node">
<title>l2_attn_stage0_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="26721" cy="-8888.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26721" y="-8900.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="26721" y="-8885.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="26721" y="-8870.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu7 -->
<g id="node368" class="node">
<title>l2_attn_stage1_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="26721" cy="-8741.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26721" y="-8753.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="26721" y="-8738.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="26721" y="-8723.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu7&#45;&gt;l2_attn_stage1_gpu7 -->
<g id="edge568" class="edge">
<title>l2_attn_stage0_gpu7&#45;&gt;l2_attn_stage1_gpu7</title>
<path fill="none" stroke="black" d="M26668.02,-8858.76C26654.09,-8852.47 26638.82,-8846.69 26624,-8843.33 26606.99,-8839.47 26008.24,-8845.77 25996,-8833.33 25991.32,-8828.58 25991.32,-8823.08 25996,-8818.33 26008.26,-8805.92 26607.39,-8815.66 26624,-8810.33 26642.46,-8804.41 26660.51,-8793.66 26675.94,-8782.46"/>
<polygon fill="black" stroke="black" points="26678.34,-8785.03 26684.22,-8776.22 26674.13,-8779.44 26678.34,-8785.03"/>
</g>
<!-- l2_attn_stage0_gpu7&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge2456" class="edge">
<title>l2_attn_stage0_gpu7&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26809.34,-8885.65C26959.61,-8881.02 27251.83,-8867.67 27283,-8833.33 27335.01,-8776.04 27236.61,-8754.47 27138.88,-8746.62"/>
<polygon fill="red" stroke="red" points="27139.06,-8743.12 27128.82,-8745.86 27138.53,-8750.1 27139.06,-8743.12"/>
<text text-anchor="middle" x="27322.5" y="-8822.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu8 -->
<g id="node353" class="node">
<title>l2_attn_stage0_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="23796" cy="-8888.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23796" y="-8900.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="23796" y="-8885.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="23796" y="-8870.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu8 -->
<g id="node369" class="node">
<title>l2_attn_stage1_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="23796" cy="-8741.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23796" y="-8753.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="23796" y="-8738.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="23796" y="-8723.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu8&#45;&gt;l2_attn_stage1_gpu8 -->
<g id="edge569" class="edge">
<title>l2_attn_stage0_gpu8&#45;&gt;l2_attn_stage1_gpu8</title>
<path fill="none" stroke="black" d="M23796,-8851.24C23796,-8832.52 23796,-8809.53 23796,-8789.55"/>
<polygon fill="black" stroke="black" points="23799.5,-8789.41 23796,-8779.41 23792.5,-8789.41 23799.5,-8789.41"/>
</g>
<!-- l2_attn_stage0_gpu8&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge2457" class="edge">
<title>l2_attn_stage0_gpu8&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23849.29,-8858.83C23863.43,-8852.49 23878.95,-8846.68 23894,-8843.33 24123.73,-8792.2 25776.66,-8820.88 26012,-8818.33 26056.94,-8817.84 26776.97,-8819.36 26821,-8810.33 26864.87,-8801.33 26911.77,-8780.41 26943.76,-8764.23"/>
<polygon fill="red" stroke="red" points="26945.49,-8767.28 26952.78,-8759.59 26942.28,-8761.05 26945.49,-8767.28"/>
<text text-anchor="middle" x="26043.5" y="-8822.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu9 -->
<g id="node354" class="node">
<title>l2_attn_stage0_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26526" cy="-8888.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26526" y="-8900.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="26526" y="-8885.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26526" y="-8870.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu9 -->
<g id="node370" class="node">
<title>l2_attn_stage1_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26526" cy="-8741.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26526" y="-8753.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="26526" y="-8738.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26526" y="-8723.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu9&#45;&gt;l2_attn_stage1_gpu9 -->
<g id="edge570" class="edge">
<title>l2_attn_stage0_gpu9&#45;&gt;l2_attn_stage1_gpu9</title>
<path fill="none" stroke="black" d="M26472.74,-8858.72C26458.89,-8852.46 26443.71,-8846.72 26429,-8843.33 26405.17,-8837.84 26006.09,-8850.82 25989,-8833.33 25984.34,-8828.56 25984.33,-8823.09 25989,-8818.33 25997.56,-8809.61 26417.37,-8814.1 26429,-8810.33 26447.45,-8804.36 26465.49,-8793.6 26480.92,-8782.4"/>
<polygon fill="black" stroke="black" points="26483.32,-8784.97 26489.2,-8776.16 26479.11,-8779.38 26483.32,-8784.97"/>
</g>
<!-- l2_attn_stage0_gpu9&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge2458" class="edge">
<title>l2_attn_stage0_gpu9&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26579.3,-8858.89C26593.44,-8852.55 26608.96,-8846.72 26624,-8843.33 26639.53,-8839.83 27185.84,-8844.69 27197,-8833.33 27237.03,-8792.59 27167.32,-8769.24 27097.01,-8756.49"/>
<polygon fill="red" stroke="red" points="27097.55,-8753.03 27087.1,-8754.76 27096.35,-8759.93 27097.55,-8753.03"/>
<text text-anchor="middle" x="27237.5" y="-8822.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu10 -->
<g id="node355" class="node">
<title>l2_attn_stage0_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="24186" cy="-8888.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24186" y="-8900.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="24186" y="-8885.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="24186" y="-8870.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu10 -->
<g id="node371" class="node">
<title>l2_attn_stage1_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="24186" cy="-8741.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24186" y="-8753.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="24186" y="-8738.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="24186" y="-8723.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu10&#45;&gt;l2_attn_stage1_gpu10 -->
<g id="edge571" class="edge">
<title>l2_attn_stage0_gpu10&#45;&gt;l2_attn_stage1_gpu10</title>
<path fill="none" stroke="black" d="M24186,-8851.24C24186,-8832.52 24186,-8809.53 24186,-8789.55"/>
<polygon fill="black" stroke="black" points="24189.5,-8789.41 24186,-8779.41 24182.5,-8789.41 24189.5,-8789.41"/>
</g>
<!-- l2_attn_stage0_gpu10&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge2459" class="edge">
<title>l2_attn_stage0_gpu10&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24239.28,-8858.77C24253.41,-8852.43 24268.94,-8846.63 24284,-8843.33 24335.04,-8832.14 26115.68,-8850.6 26165,-8833.33 26175.15,-8829.78 26173.86,-8821.92 26184,-8818.33 26217.36,-8806.52 26786.34,-8817.49 26821,-8810.33 26864.86,-8801.27 26911.76,-8780.36 26943.75,-8764.2"/>
<polygon fill="red" stroke="red" points="26945.48,-8767.25 26952.77,-8759.57 26942.28,-8761.02 26945.48,-8767.25"/>
<text text-anchor="middle" x="26215.5" y="-8822.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu11 -->
<g id="node356" class="node">
<title>l2_attn_stage0_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="25356" cy="-8888.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25356" y="-8900.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="25356" y="-8885.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="25356" y="-8870.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu11 -->
<g id="node372" class="node">
<title>l2_attn_stage1_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="25356" cy="-8741.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25356" y="-8753.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="25356" y="-8738.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="25356" y="-8723.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu11&#45;&gt;l2_attn_stage1_gpu11 -->
<g id="edge572" class="edge">
<title>l2_attn_stage0_gpu11&#45;&gt;l2_attn_stage1_gpu11</title>
<path fill="none" stroke="black" d="M25356,-8851.24C25356,-8832.52 25356,-8809.53 25356,-8789.55"/>
<polygon fill="black" stroke="black" points="25359.5,-8789.41 25356,-8779.41 25352.5,-8789.41 25359.5,-8789.41"/>
</g>
<!-- l2_attn_stage0_gpu11&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge2460" class="edge">
<title>l2_attn_stage0_gpu11&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25409.28,-8858.8C25423.42,-8852.46 25438.95,-8846.65 25454,-8843.33 25520.57,-8828.64 26616.69,-8855.95 26681,-8833.33 26691.15,-8829.76 26689.96,-8822.19 26700,-8818.33 26750.3,-8798.99 26768.53,-8822.64 26821,-8810.33 26864.2,-8800.2 26910.67,-8779.75 26942.71,-8764"/>
<polygon fill="red" stroke="red" points="26944.38,-8767.09 26951.77,-8759.49 26941.25,-8760.82 26944.38,-8767.09"/>
<text text-anchor="middle" x="26731.5" y="-8822.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu12 -->
<g id="node357" class="node">
<title>l2_attn_stage0_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="24381" cy="-8888.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24381" y="-8900.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="24381" y="-8885.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="24381" y="-8870.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu12 -->
<g id="node373" class="node">
<title>l2_attn_stage1_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="24381" cy="-8741.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24381" y="-8753.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="24381" y="-8738.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="24381" y="-8723.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu12&#45;&gt;l2_attn_stage1_gpu12 -->
<g id="edge573" class="edge">
<title>l2_attn_stage0_gpu12&#45;&gt;l2_attn_stage1_gpu12</title>
<path fill="none" stroke="black" d="M24381,-8851.24C24381,-8832.52 24381,-8809.53 24381,-8789.55"/>
<polygon fill="black" stroke="black" points="24384.5,-8789.41 24381,-8779.41 24377.5,-8789.41 24384.5,-8789.41"/>
</g>
<!-- l2_attn_stage0_gpu12&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge2461" class="edge">
<title>l2_attn_stage0_gpu12&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24434.28,-8858.77C24448.41,-8852.43 24463.94,-8846.64 24479,-8843.33 24527.08,-8832.79 26204.55,-8849.61 26251,-8833.33 26261.15,-8829.78 26259.86,-8821.93 26270,-8818.33 26298.85,-8808.08 26791.02,-8816.55 26821,-8810.33 26864.85,-8801.23 26911.75,-8780.33 26943.75,-8764.18"/>
<polygon fill="red" stroke="red" points="26945.47,-8767.23 26952.77,-8759.55 26942.27,-8761 26945.47,-8767.23"/>
<text text-anchor="middle" x="26301.5" y="-8822.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu13 -->
<g id="node358" class="node">
<title>l2_attn_stage0_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="25551" cy="-8888.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25551" y="-8900.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="25551" y="-8885.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="25551" y="-8870.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu13 -->
<g id="node374" class="node">
<title>l2_attn_stage1_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="25551" cy="-8741.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25551" y="-8753.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="25551" y="-8738.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="25551" y="-8723.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu13&#45;&gt;l2_attn_stage1_gpu13 -->
<g id="edge574" class="edge">
<title>l2_attn_stage0_gpu13&#45;&gt;l2_attn_stage1_gpu13</title>
<path fill="none" stroke="black" d="M25551,-8851.24C25551,-8832.52 25551,-8809.53 25551,-8789.55"/>
<polygon fill="black" stroke="black" points="25554.5,-8789.41 25551,-8779.41 25547.5,-8789.41 25554.5,-8789.41"/>
</g>
<!-- l2_attn_stage0_gpu13&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge2462" class="edge">
<title>l2_attn_stage0_gpu13&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25604.28,-8858.8C25618.42,-8852.46 25633.95,-8846.66 25649,-8843.33 25709.65,-8829.92 26708.41,-8853.97 26767,-8833.33 26777.15,-8829.76 26776.3,-8822.98 26786,-8818.33 26800.39,-8811.44 26805.8,-8815.2 26821,-8810.33 26861.94,-8797.23 26906.95,-8778.07 26939.12,-8763.51"/>
<polygon fill="red" stroke="red" points="26940.61,-8766.68 26948.25,-8759.34 26937.7,-8760.31 26940.61,-8766.68"/>
<text text-anchor="middle" x="26817.5" y="-8822.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu14 -->
<g id="node359" class="node">
<title>l2_attn_stage0_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="24771" cy="-8888.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24771" y="-8900.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="24771" y="-8885.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="24771" y="-8870.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu14 -->
<g id="node375" class="node">
<title>l2_attn_stage1_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="24771" cy="-8741.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24771" y="-8753.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="24771" y="-8738.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="24771" y="-8723.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu14&#45;&gt;l2_attn_stage1_gpu14 -->
<g id="edge575" class="edge">
<title>l2_attn_stage0_gpu14&#45;&gt;l2_attn_stage1_gpu14</title>
<path fill="none" stroke="black" d="M24771,-8851.24C24771,-8832.52 24771,-8809.53 24771,-8789.55"/>
<polygon fill="black" stroke="black" points="24774.5,-8789.41 24771,-8779.41 24767.5,-8789.41 24774.5,-8789.41"/>
</g>
<!-- l2_attn_stage0_gpu14&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge2463" class="edge">
<title>l2_attn_stage0_gpu14&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24824.28,-8858.78C24838.41,-8852.44 24853.94,-8846.64 24869,-8843.33 24911.16,-8834.07 26382.27,-8847.62 26423,-8833.33 26433.15,-8829.77 26431.87,-8821.97 26442,-8818.33 26481.64,-8804.1 26779.79,-8819.03 26821,-8810.33 26864.82,-8801.09 26911.73,-8780.2 26943.73,-8764.1"/>
<polygon fill="red" stroke="red" points="26945.45,-8767.15 26952.75,-8759.48 26942.26,-8760.92 26945.45,-8767.15"/>
<text text-anchor="middle" x="26473.5" y="-8822.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu15 -->
<g id="node360" class="node">
<title>l2_attn_stage0_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="25746" cy="-8888.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25746" y="-8900.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="25746" y="-8885.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="25746" y="-8870.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu15 -->
<g id="node376" class="node">
<title>l2_attn_stage1_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="25746" cy="-8741.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25746" y="-8753.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="25746" y="-8738.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="25746" y="-8723.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu15&#45;&gt;l2_attn_stage1_gpu15 -->
<g id="edge576" class="edge">
<title>l2_attn_stage0_gpu15&#45;&gt;l2_attn_stage1_gpu15</title>
<path fill="none" stroke="black" d="M25746,-8851.24C25746,-8832.52 25746,-8809.53 25746,-8789.55"/>
<polygon fill="black" stroke="black" points="25749.5,-8789.41 25746,-8779.41 25742.5,-8789.41 25749.5,-8789.41"/>
</g>
<!-- l2_attn_stage0_gpu15&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge2464" class="edge">
<title>l2_attn_stage0_gpu15&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25799.29,-8858.81C25813.42,-8852.47 25828.95,-8846.67 25844,-8843.33 25898.73,-8831.2 26800.13,-8851.98 26853,-8833.33 26863.15,-8829.75 26863.32,-8824.69 26872,-8818.33 26897.22,-8799.84 26926.5,-8779.99 26948.65,-8765.28"/>
<polygon fill="red" stroke="red" points="26950.66,-8768.15 26957.07,-8759.72 26946.8,-8762.31 26950.66,-8768.15"/>
<text text-anchor="middle" x="26903.5" y="-8822.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu0 -->
<g id="node377" class="node">
<title>l2_attn_stage2_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24966" cy="-8594.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24966" y="-8606.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="24966" y="-8591.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24966" y="-8576.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu0&#45;&gt;l2_attn_stage2_gpu0 -->
<g id="edge577" class="edge">
<title>l2_attn_stage1_gpu0&#45;&gt;l2_attn_stage2_gpu0</title>
<path fill="none" stroke="black" d="M24966,-8704.24C24966,-8685.52 24966,-8662.53 24966,-8642.55"/>
<polygon fill="black" stroke="black" points="24969.5,-8642.41 24966,-8632.41 24962.5,-8642.41 24969.5,-8642.41"/>
</g>
<!-- l2_attn_stage2_gpu[next_gpu] -->
<g id="node1361" class="node">
<title>l2_attn_stage2_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="26983" cy="-8594.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="26983" y="-8591.13" font-family="Times,serif" font-size="14.00">l2_attn_stage2_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage1_gpu0&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge2465" class="edge">
<title>l2_attn_stage1_gpu0&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25019.28,-8711.78C25033.41,-8705.44 25048.94,-8699.64 25064,-8696.33 25103.2,-8687.71 26471.13,-8699.63 26509,-8686.33 26519.15,-8682.77 26517.89,-8675 26528,-8671.33 26558.62,-8660.23 26789.15,-8670.15 26821,-8663.33 26864.66,-8653.98 26911.41,-8633.22 26943.42,-8617.17"/>
<polygon fill="red" stroke="red" points="26945.12,-8620.23 26952.45,-8612.57 26941.95,-8613.99 26945.12,-8620.23"/>
<text text-anchor="middle" x="26559.5" y="-8675.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu1 -->
<g id="node378" class="node">
<title>l2_attn_stage2_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24576" cy="-8594.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24576" y="-8606.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="24576" y="-8591.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24576" y="-8576.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu1&#45;&gt;l2_attn_stage2_gpu1 -->
<g id="edge578" class="edge">
<title>l2_attn_stage1_gpu1&#45;&gt;l2_attn_stage2_gpu1</title>
<path fill="none" stroke="black" d="M24576,-8704.24C24576,-8685.52 24576,-8662.53 24576,-8642.55"/>
<polygon fill="black" stroke="black" points="24579.5,-8642.41 24576,-8632.41 24572.5,-8642.41 24579.5,-8642.41"/>
</g>
<!-- l2_attn_stage1_gpu1&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge2466" class="edge">
<title>l2_attn_stage1_gpu1&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24629.28,-8711.77C24643.41,-8705.43 24658.94,-8699.64 24674,-8696.33 24719.12,-8686.43 26293.41,-8701.61 26337,-8686.33 26347.15,-8682.77 26345.87,-8674.95 26356,-8671.33 26404.67,-8653.97 26770.42,-8673.9 26821,-8663.33 26864.84,-8654.17 26911.74,-8633.28 26943.74,-8617.14"/>
<polygon fill="red" stroke="red" points="26945.46,-8620.2 26952.76,-8612.52 26942.27,-8613.97 26945.46,-8620.2"/>
<text text-anchor="middle" x="26387.5" y="-8675.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu2 -->
<g id="node379" class="node">
<title>l2_attn_stage2_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25941" cy="-8594.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25941" y="-8606.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="25941" y="-8591.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25941" y="-8576.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu2&#45;&gt;l2_attn_stage2_gpu2 -->
<g id="edge579" class="edge">
<title>l2_attn_stage1_gpu2&#45;&gt;l2_attn_stage2_gpu2</title>
<path fill="none" stroke="black" d="M25941,-8704.24C25941,-8685.52 25941,-8662.53 25941,-8642.55"/>
<polygon fill="black" stroke="black" points="25944.5,-8642.41 25941,-8632.41 25937.5,-8642.41 25944.5,-8642.41"/>
</g>
<!-- l2_attn_stage1_gpu2&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge2467" class="edge">
<title>l2_attn_stage1_gpu2&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25994.29,-8711.83C26008.42,-8705.49 26023.95,-8699.68 26039,-8696.33 26063.41,-8690.91 26917.88,-8699.71 26939,-8686.33 26960.94,-8672.43 26972.24,-8644.15 26977.85,-8622.89"/>
<polygon fill="red" stroke="red" points="26981.27,-8623.64 26980.18,-8613.1 26974.46,-8622.02 26981.27,-8623.64"/>
<text text-anchor="middle" x="26985.5" y="-8675.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu3 -->
<g id="node380" class="node">
<title>l2_attn_stage2_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26331" cy="-8594.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26331" y="-8606.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="26331" y="-8591.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26331" y="-8576.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu3&#45;&gt;l2_attn_stage2_gpu3 -->
<g id="edge580" class="edge">
<title>l2_attn_stage1_gpu3&#45;&gt;l2_attn_stage2_gpu3</title>
<path fill="none" stroke="black" d="M26277.7,-8711.89C26263.85,-8705.63 26248.69,-8699.85 26234,-8696.33 26220.37,-8693.07 25991.71,-8696.43 25982,-8686.33 25977.38,-8681.53 25977.36,-8676.12 25982,-8671.33 25991.75,-8661.27 26220.7,-8667.74 26234,-8663.33 26252.4,-8657.24 26270.44,-8646.44 26285.87,-8635.25"/>
<polygon fill="black" stroke="black" points="26288.27,-8637.83 26294.16,-8629.02 26284.06,-8632.23 26288.27,-8637.83"/>
</g>
<!-- l2_attn_stage1_gpu3&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge2468" class="edge">
<title>l2_attn_stage1_gpu3&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26384.3,-8711.86C26398.43,-8705.52 26413.96,-8699.7 26429,-8696.33 26447.49,-8692.19 27097.7,-8699.83 27111,-8686.33 27139.36,-8657.56 27091.79,-8631.72 27046.82,-8615.1"/>
<polygon fill="red" stroke="red" points="27047.88,-8611.76 27037.29,-8611.69 27045.53,-8618.35 27047.88,-8611.76"/>
<text text-anchor="middle" x="27150.5" y="-8675.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu4 -->
<g id="node381" class="node">
<title>l2_attn_stage2_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25161" cy="-8594.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25161" y="-8606.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="25161" y="-8591.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25161" y="-8576.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu4&#45;&gt;l2_attn_stage2_gpu4 -->
<g id="edge581" class="edge">
<title>l2_attn_stage1_gpu4&#45;&gt;l2_attn_stage2_gpu4</title>
<path fill="none" stroke="black" d="M25161,-8704.24C25161,-8685.52 25161,-8662.53 25161,-8642.55"/>
<polygon fill="black" stroke="black" points="25164.5,-8642.41 25161,-8632.41 25157.5,-8642.41 25164.5,-8642.41"/>
</g>
<!-- l2_attn_stage1_gpu4&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge2469" class="edge">
<title>l2_attn_stage1_gpu4&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25214.28,-8711.79C25228.42,-8705.45 25243.95,-8699.65 25259,-8696.33 25295.24,-8688.35 26559.99,-8698.63 26595,-8686.33 26605.15,-8682.77 26603.91,-8675.06 26614,-8671.33 26657.19,-8655.4 26776.04,-8673.23 26821,-8663.33 26864.6,-8653.73 26911.37,-8633.01 26943.39,-8617.04"/>
<polygon fill="red" stroke="red" points="26945.08,-8620.1 26952.42,-8612.46 26941.92,-8613.86 26945.08,-8620.1"/>
<text text-anchor="middle" x="26645.5" y="-8675.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu5 -->
<g id="node382" class="node">
<title>l2_attn_stage2_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="26136" cy="-8594.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26136" y="-8606.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="26136" y="-8591.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="26136" y="-8576.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu5&#45;&gt;l2_attn_stage2_gpu5 -->
<g id="edge582" class="edge">
<title>l2_attn_stage1_gpu5&#45;&gt;l2_attn_stage2_gpu5</title>
<path fill="none" stroke="black" d="M26080.85,-8712.37C26067.43,-8706.33 26052.93,-8700.53 26039,-8696.33 26025.22,-8692.18 25984.36,-8697.27 25975,-8686.33 25940.08,-8645.53 25980.79,-8685.65 26039,-8663.33 26056.78,-8656.51 26074.42,-8645.77 26089.68,-8634.84"/>
<polygon fill="black" stroke="black" points="26091.93,-8637.53 26097.9,-8628.77 26087.77,-8631.89 26091.93,-8637.53"/>
</g>
<!-- l2_attn_stage1_gpu5&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge2470" class="edge">
<title>l2_attn_stage1_gpu5&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26189.29,-8711.84C26203.43,-8705.5 26218.95,-8699.69 26234,-8696.33 26255.45,-8691.55 27009.56,-8701.97 27025,-8686.33 27043.16,-8667.94 27025.89,-8640.25 27008.31,-8620.34"/>
<polygon fill="red" stroke="red" points="27010.75,-8617.82 27001.38,-8612.87 27005.61,-8622.58 27010.75,-8617.82"/>
<text text-anchor="middle" x="27063.5" y="-8675.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu6 -->
<g id="node383" class="node">
<title>l2_attn_stage2_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="23991" cy="-8594.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23991" y="-8606.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="23991" y="-8591.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="23991" y="-8576.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu6&#45;&gt;l2_attn_stage2_gpu6 -->
<g id="edge583" class="edge">
<title>l2_attn_stage1_gpu6&#45;&gt;l2_attn_stage2_gpu6</title>
<path fill="none" stroke="black" d="M23991,-8704.24C23991,-8685.52 23991,-8662.53 23991,-8642.55"/>
<polygon fill="black" stroke="black" points="23994.5,-8642.41 23991,-8632.41 23987.5,-8642.41 23994.5,-8642.41"/>
</g>
<!-- l2_attn_stage1_gpu6&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge2471" class="edge">
<title>l2_attn_stage1_gpu6&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24044.28,-8711.76C24058.41,-8705.42 24073.94,-8699.63 24089,-8696.33 24143,-8684.5 26026.82,-8704.59 26079,-8686.33 26089.15,-8682.78 26087.86,-8674.92 26098,-8671.33 26135.87,-8657.95 26781.66,-8671.43 26821,-8663.33 26864.87,-8654.31 26911.77,-8633.39 26943.76,-8617.22"/>
<polygon fill="red" stroke="red" points="26945.48,-8620.27 26952.78,-8612.58 26942.28,-8614.04 26945.48,-8620.27"/>
<text text-anchor="middle" x="26129.5" y="-8675.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu7 -->
<g id="node384" class="node">
<title>l2_attn_stage2_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="26721" cy="-8594.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26721" y="-8606.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="26721" y="-8591.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="26721" y="-8576.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu7&#45;&gt;l2_attn_stage2_gpu7 -->
<g id="edge584" class="edge">
<title>l2_attn_stage1_gpu7&#45;&gt;l2_attn_stage2_gpu7</title>
<path fill="none" stroke="black" d="M26668.02,-8711.76C26654.09,-8705.47 26638.82,-8699.69 26624,-8696.33 26606.99,-8692.47 26008.24,-8698.77 25996,-8686.33 25991.32,-8681.58 25991.32,-8676.08 25996,-8671.33 26008.26,-8658.92 26607.39,-8668.66 26624,-8663.33 26642.46,-8657.41 26660.51,-8646.66 26675.94,-8635.46"/>
<polygon fill="black" stroke="black" points="26678.34,-8638.03 26684.22,-8629.22 26674.13,-8632.44 26678.34,-8638.03"/>
</g>
<!-- l2_attn_stage1_gpu7&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge2472" class="edge">
<title>l2_attn_stage1_gpu7&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26776.38,-8712.52C26791.74,-8705.95 26808.68,-8699.86 26825,-8696.33 26849.87,-8690.95 27265.2,-8704.52 27283,-8686.33 27337.67,-8630.46 27236.45,-8608.8 27137.12,-8600.54"/>
<polygon fill="red" stroke="red" points="27137.15,-8597.03 27126.9,-8599.74 27136.6,-8604.01 27137.15,-8597.03"/>
<text text-anchor="middle" x="27323.5" y="-8675.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu8 -->
<g id="node385" class="node">
<title>l2_attn_stage2_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="23796" cy="-8594.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23796" y="-8606.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="23796" y="-8591.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="23796" y="-8576.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu8&#45;&gt;l2_attn_stage2_gpu8 -->
<g id="edge585" class="edge">
<title>l2_attn_stage1_gpu8&#45;&gt;l2_attn_stage2_gpu8</title>
<path fill="none" stroke="black" d="M23796,-8704.24C23796,-8685.52 23796,-8662.53 23796,-8642.55"/>
<polygon fill="black" stroke="black" points="23799.5,-8642.41 23796,-8632.41 23792.5,-8642.41 23799.5,-8642.41"/>
</g>
<!-- l2_attn_stage1_gpu8&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge2473" class="edge">
<title>l2_attn_stage1_gpu8&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23849.29,-8711.83C23863.43,-8705.49 23878.95,-8699.68 23894,-8696.33 24123.73,-8645.2 25776.66,-8673.88 26012,-8671.33 26056.94,-8670.84 26776.97,-8672.36 26821,-8663.33 26864.87,-8654.33 26911.77,-8633.41 26943.76,-8617.23"/>
<polygon fill="red" stroke="red" points="26945.49,-8620.28 26952.78,-8612.59 26942.28,-8614.05 26945.49,-8620.28"/>
<text text-anchor="middle" x="26043.5" y="-8675.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu9 -->
<g id="node386" class="node">
<title>l2_attn_stage2_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26526" cy="-8594.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26526" y="-8606.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="26526" y="-8591.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26526" y="-8576.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu9&#45;&gt;l2_attn_stage2_gpu9 -->
<g id="edge586" class="edge">
<title>l2_attn_stage1_gpu9&#45;&gt;l2_attn_stage2_gpu9</title>
<path fill="none" stroke="black" d="M26472.74,-8711.72C26458.89,-8705.46 26443.71,-8699.72 26429,-8696.33 26405.17,-8690.84 26006.09,-8703.82 25989,-8686.33 25984.34,-8681.56 25984.33,-8676.09 25989,-8671.33 25997.56,-8662.61 26417.37,-8667.1 26429,-8663.33 26447.45,-8657.36 26465.49,-8646.6 26480.92,-8635.4"/>
<polygon fill="black" stroke="black" points="26483.32,-8637.97 26489.2,-8629.16 26479.11,-8632.38 26483.32,-8637.97"/>
</g>
<!-- l2_attn_stage1_gpu9&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge2474" class="edge">
<title>l2_attn_stage1_gpu9&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26579.3,-8711.89C26593.44,-8705.55 26608.96,-8699.72 26624,-8696.33 26639.53,-8692.83 27185.84,-8697.69 27197,-8686.33 27237.03,-8645.59 27167.32,-8622.24 27097.01,-8609.49"/>
<polygon fill="red" stroke="red" points="27097.55,-8606.03 27087.1,-8607.76 27096.35,-8612.93 27097.55,-8606.03"/>
<text text-anchor="middle" x="27237.5" y="-8675.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu10 -->
<g id="node387" class="node">
<title>l2_attn_stage2_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="24186" cy="-8594.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24186" y="-8606.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="24186" y="-8591.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="24186" y="-8576.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu10&#45;&gt;l2_attn_stage2_gpu10 -->
<g id="edge587" class="edge">
<title>l2_attn_stage1_gpu10&#45;&gt;l2_attn_stage2_gpu10</title>
<path fill="none" stroke="black" d="M24186,-8704.24C24186,-8685.52 24186,-8662.53 24186,-8642.55"/>
<polygon fill="black" stroke="black" points="24189.5,-8642.41 24186,-8632.41 24182.5,-8642.41 24189.5,-8642.41"/>
</g>
<!-- l2_attn_stage1_gpu10&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge2475" class="edge">
<title>l2_attn_stage1_gpu10&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24239.28,-8711.77C24253.41,-8705.43 24268.94,-8699.63 24284,-8696.33 24335.04,-8685.14 26115.68,-8703.6 26165,-8686.33 26175.15,-8682.78 26173.86,-8674.92 26184,-8671.33 26217.36,-8659.52 26786.34,-8670.49 26821,-8663.33 26864.86,-8654.27 26911.76,-8633.36 26943.75,-8617.2"/>
<polygon fill="red" stroke="red" points="26945.48,-8620.25 26952.77,-8612.57 26942.28,-8614.02 26945.48,-8620.25"/>
<text text-anchor="middle" x="26215.5" y="-8675.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu11 -->
<g id="node388" class="node">
<title>l2_attn_stage2_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="25356" cy="-8594.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25356" y="-8606.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="25356" y="-8591.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="25356" y="-8576.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu11&#45;&gt;l2_attn_stage2_gpu11 -->
<g id="edge588" class="edge">
<title>l2_attn_stage1_gpu11&#45;&gt;l2_attn_stage2_gpu11</title>
<path fill="none" stroke="black" d="M25356,-8704.24C25356,-8685.52 25356,-8662.53 25356,-8642.55"/>
<polygon fill="black" stroke="black" points="25359.5,-8642.41 25356,-8632.41 25352.5,-8642.41 25359.5,-8642.41"/>
</g>
<!-- l2_attn_stage1_gpu11&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge2476" class="edge">
<title>l2_attn_stage1_gpu11&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25409.28,-8711.8C25423.42,-8705.46 25438.95,-8699.65 25454,-8696.33 25520.57,-8681.64 26616.69,-8708.95 26681,-8686.33 26691.15,-8682.76 26689.96,-8675.19 26700,-8671.33 26750.3,-8651.99 26768.53,-8675.64 26821,-8663.33 26864.2,-8653.2 26910.67,-8632.75 26942.71,-8617"/>
<polygon fill="red" stroke="red" points="26944.38,-8620.09 26951.77,-8612.49 26941.25,-8613.82 26944.38,-8620.09"/>
<text text-anchor="middle" x="26731.5" y="-8675.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu12 -->
<g id="node389" class="node">
<title>l2_attn_stage2_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="24381" cy="-8594.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24381" y="-8606.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="24381" y="-8591.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="24381" y="-8576.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu12&#45;&gt;l2_attn_stage2_gpu12 -->
<g id="edge589" class="edge">
<title>l2_attn_stage1_gpu12&#45;&gt;l2_attn_stage2_gpu12</title>
<path fill="none" stroke="black" d="M24381,-8704.24C24381,-8685.52 24381,-8662.53 24381,-8642.55"/>
<polygon fill="black" stroke="black" points="24384.5,-8642.41 24381,-8632.41 24377.5,-8642.41 24384.5,-8642.41"/>
</g>
<!-- l2_attn_stage1_gpu12&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge2477" class="edge">
<title>l2_attn_stage1_gpu12&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24434.28,-8711.77C24448.41,-8705.43 24463.94,-8699.64 24479,-8696.33 24527.08,-8685.79 26204.55,-8702.61 26251,-8686.33 26261.15,-8682.78 26259.86,-8674.93 26270,-8671.33 26298.85,-8661.08 26791.02,-8669.55 26821,-8663.33 26864.85,-8654.23 26911.75,-8633.33 26943.75,-8617.18"/>
<polygon fill="red" stroke="red" points="26945.47,-8620.23 26952.77,-8612.55 26942.27,-8614 26945.47,-8620.23"/>
<text text-anchor="middle" x="26301.5" y="-8675.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu13 -->
<g id="node390" class="node">
<title>l2_attn_stage2_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="25551" cy="-8594.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25551" y="-8606.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="25551" y="-8591.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="25551" y="-8576.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu13&#45;&gt;l2_attn_stage2_gpu13 -->
<g id="edge590" class="edge">
<title>l2_attn_stage1_gpu13&#45;&gt;l2_attn_stage2_gpu13</title>
<path fill="none" stroke="black" d="M25551,-8704.24C25551,-8685.52 25551,-8662.53 25551,-8642.55"/>
<polygon fill="black" stroke="black" points="25554.5,-8642.41 25551,-8632.41 25547.5,-8642.41 25554.5,-8642.41"/>
</g>
<!-- l2_attn_stage1_gpu13&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge2478" class="edge">
<title>l2_attn_stage1_gpu13&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25604.28,-8711.8C25618.42,-8705.46 25633.95,-8699.66 25649,-8696.33 25709.65,-8682.92 26708.41,-8706.97 26767,-8686.33 26777.15,-8682.76 26776.3,-8675.98 26786,-8671.33 26800.39,-8664.44 26805.8,-8668.2 26821,-8663.33 26861.94,-8650.23 26906.95,-8631.07 26939.12,-8616.51"/>
<polygon fill="red" stroke="red" points="26940.61,-8619.68 26948.25,-8612.34 26937.7,-8613.31 26940.61,-8619.68"/>
<text text-anchor="middle" x="26817.5" y="-8675.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu14 -->
<g id="node391" class="node">
<title>l2_attn_stage2_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="24771" cy="-8594.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24771" y="-8606.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="24771" y="-8591.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="24771" y="-8576.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu14&#45;&gt;l2_attn_stage2_gpu14 -->
<g id="edge591" class="edge">
<title>l2_attn_stage1_gpu14&#45;&gt;l2_attn_stage2_gpu14</title>
<path fill="none" stroke="black" d="M24771,-8704.24C24771,-8685.52 24771,-8662.53 24771,-8642.55"/>
<polygon fill="black" stroke="black" points="24774.5,-8642.41 24771,-8632.41 24767.5,-8642.41 24774.5,-8642.41"/>
</g>
<!-- l2_attn_stage1_gpu14&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge2479" class="edge">
<title>l2_attn_stage1_gpu14&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24824.28,-8711.78C24838.41,-8705.44 24853.94,-8699.64 24869,-8696.33 24911.16,-8687.07 26382.27,-8700.62 26423,-8686.33 26433.15,-8682.77 26431.87,-8674.97 26442,-8671.33 26481.64,-8657.1 26779.79,-8672.03 26821,-8663.33 26864.82,-8654.09 26911.73,-8633.2 26943.73,-8617.1"/>
<polygon fill="red" stroke="red" points="26945.45,-8620.15 26952.75,-8612.48 26942.26,-8613.92 26945.45,-8620.15"/>
<text text-anchor="middle" x="26473.5" y="-8675.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu15 -->
<g id="node392" class="node">
<title>l2_attn_stage2_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="25746" cy="-8594.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25746" y="-8606.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="25746" y="-8591.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="25746" y="-8576.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu15&#45;&gt;l2_attn_stage2_gpu15 -->
<g id="edge592" class="edge">
<title>l2_attn_stage1_gpu15&#45;&gt;l2_attn_stage2_gpu15</title>
<path fill="none" stroke="black" d="M25746,-8704.24C25746,-8685.52 25746,-8662.53 25746,-8642.55"/>
<polygon fill="black" stroke="black" points="25749.5,-8642.41 25746,-8632.41 25742.5,-8642.41 25749.5,-8642.41"/>
</g>
<!-- l2_attn_stage1_gpu15&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge2480" class="edge">
<title>l2_attn_stage1_gpu15&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25799.29,-8711.81C25813.42,-8705.47 25828.95,-8699.67 25844,-8696.33 25898.73,-8684.2 26800.13,-8704.98 26853,-8686.33 26863.15,-8682.75 26863.32,-8677.69 26872,-8671.33 26897.22,-8652.84 26926.5,-8632.99 26948.65,-8618.28"/>
<polygon fill="red" stroke="red" points="26950.66,-8621.15 26957.07,-8612.72 26946.8,-8615.31 26950.66,-8621.15"/>
<text text-anchor="middle" x="26903.5" y="-8675.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu0 -->
<g id="node393" class="node">
<title>l2_attn_stage3_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24966" cy="-8447.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24966" y="-8459.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="24966" y="-8444.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24966" y="-8429.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu0&#45;&gt;l2_attn_stage3_gpu0 -->
<g id="edge593" class="edge">
<title>l2_attn_stage2_gpu0&#45;&gt;l2_attn_stage3_gpu0</title>
<path fill="none" stroke="black" d="M24966,-8557.24C24966,-8538.52 24966,-8515.53 24966,-8495.55"/>
<polygon fill="black" stroke="black" points="24969.5,-8495.41 24966,-8485.41 24962.5,-8495.41 24969.5,-8495.41"/>
</g>
<!-- l2_attn_stage3_gpu[next_gpu] -->
<g id="node1362" class="node">
<title>l2_attn_stage3_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="26983" cy="-8447.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="26983" y="-8444.13" font-family="Times,serif" font-size="14.00">l2_attn_stage3_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage2_gpu0&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge2481" class="edge">
<title>l2_attn_stage2_gpu0&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25019.28,-8564.78C25033.41,-8558.44 25048.94,-8552.64 25064,-8549.33 25103.2,-8540.71 26471.13,-8552.63 26509,-8539.33 26519.15,-8535.77 26517.89,-8528 26528,-8524.33 26558.62,-8513.23 26789.15,-8523.15 26821,-8516.33 26864.66,-8506.98 26911.41,-8486.22 26943.42,-8470.17"/>
<polygon fill="red" stroke="red" points="26945.12,-8473.23 26952.45,-8465.57 26941.95,-8466.99 26945.12,-8473.23"/>
<text text-anchor="middle" x="26559.5" y="-8528.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu1 -->
<g id="node394" class="node">
<title>l2_attn_stage3_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24576" cy="-8447.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24576" y="-8459.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="24576" y="-8444.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24576" y="-8429.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu1&#45;&gt;l2_attn_stage3_gpu1 -->
<g id="edge594" class="edge">
<title>l2_attn_stage2_gpu1&#45;&gt;l2_attn_stage3_gpu1</title>
<path fill="none" stroke="black" d="M24576,-8557.24C24576,-8538.52 24576,-8515.53 24576,-8495.55"/>
<polygon fill="black" stroke="black" points="24579.5,-8495.41 24576,-8485.41 24572.5,-8495.41 24579.5,-8495.41"/>
</g>
<!-- l2_attn_stage2_gpu1&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge2482" class="edge">
<title>l2_attn_stage2_gpu1&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24629.28,-8564.77C24643.41,-8558.43 24658.94,-8552.64 24674,-8549.33 24719.12,-8539.43 26293.41,-8554.61 26337,-8539.33 26347.15,-8535.77 26345.87,-8527.95 26356,-8524.33 26404.67,-8506.97 26770.42,-8526.9 26821,-8516.33 26864.84,-8507.17 26911.74,-8486.28 26943.74,-8470.14"/>
<polygon fill="red" stroke="red" points="26945.46,-8473.2 26952.76,-8465.52 26942.27,-8466.97 26945.46,-8473.2"/>
<text text-anchor="middle" x="26387.5" y="-8528.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu2 -->
<g id="node395" class="node">
<title>l2_attn_stage3_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25941" cy="-8447.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25941" y="-8459.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="25941" y="-8444.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25941" y="-8429.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu2&#45;&gt;l2_attn_stage3_gpu2 -->
<g id="edge595" class="edge">
<title>l2_attn_stage2_gpu2&#45;&gt;l2_attn_stage3_gpu2</title>
<path fill="none" stroke="black" d="M25941,-8557.24C25941,-8538.52 25941,-8515.53 25941,-8495.55"/>
<polygon fill="black" stroke="black" points="25944.5,-8495.41 25941,-8485.41 25937.5,-8495.41 25944.5,-8495.41"/>
</g>
<!-- l2_attn_stage2_gpu2&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge2483" class="edge">
<title>l2_attn_stage2_gpu2&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25994.29,-8564.83C26008.42,-8558.49 26023.95,-8552.68 26039,-8549.33 26063.41,-8543.91 26917.88,-8552.71 26939,-8539.33 26960.94,-8525.43 26972.24,-8497.15 26977.85,-8475.89"/>
<polygon fill="red" stroke="red" points="26981.27,-8476.64 26980.18,-8466.1 26974.46,-8475.02 26981.27,-8476.64"/>
<text text-anchor="middle" x="26985.5" y="-8528.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu3 -->
<g id="node396" class="node">
<title>l2_attn_stage3_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26331" cy="-8447.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26331" y="-8459.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="26331" y="-8444.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26331" y="-8429.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu3&#45;&gt;l2_attn_stage3_gpu3 -->
<g id="edge596" class="edge">
<title>l2_attn_stage2_gpu3&#45;&gt;l2_attn_stage3_gpu3</title>
<path fill="none" stroke="black" d="M26277.7,-8564.89C26263.85,-8558.63 26248.69,-8552.85 26234,-8549.33 26220.37,-8546.07 25991.71,-8549.43 25982,-8539.33 25977.38,-8534.53 25977.36,-8529.12 25982,-8524.33 25991.75,-8514.27 26220.7,-8520.74 26234,-8516.33 26252.4,-8510.24 26270.44,-8499.44 26285.87,-8488.25"/>
<polygon fill="black" stroke="black" points="26288.27,-8490.83 26294.16,-8482.02 26284.06,-8485.23 26288.27,-8490.83"/>
</g>
<!-- l2_attn_stage2_gpu3&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge2484" class="edge">
<title>l2_attn_stage2_gpu3&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26384.3,-8564.86C26398.43,-8558.52 26413.96,-8552.7 26429,-8549.33 26447.49,-8545.19 27097.7,-8552.83 27111,-8539.33 27139.36,-8510.56 27091.79,-8484.72 27046.82,-8468.1"/>
<polygon fill="red" stroke="red" points="27047.88,-8464.76 27037.29,-8464.69 27045.53,-8471.35 27047.88,-8464.76"/>
<text text-anchor="middle" x="27150.5" y="-8528.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu4 -->
<g id="node397" class="node">
<title>l2_attn_stage3_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25161" cy="-8447.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25161" y="-8459.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="25161" y="-8444.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25161" y="-8429.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu4&#45;&gt;l2_attn_stage3_gpu4 -->
<g id="edge597" class="edge">
<title>l2_attn_stage2_gpu4&#45;&gt;l2_attn_stage3_gpu4</title>
<path fill="none" stroke="black" d="M25161,-8557.24C25161,-8538.52 25161,-8515.53 25161,-8495.55"/>
<polygon fill="black" stroke="black" points="25164.5,-8495.41 25161,-8485.41 25157.5,-8495.41 25164.5,-8495.41"/>
</g>
<!-- l2_attn_stage2_gpu4&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge2485" class="edge">
<title>l2_attn_stage2_gpu4&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25214.28,-8564.79C25228.42,-8558.45 25243.95,-8552.65 25259,-8549.33 25295.24,-8541.35 26559.99,-8551.63 26595,-8539.33 26605.15,-8535.77 26603.91,-8528.06 26614,-8524.33 26657.19,-8508.4 26776.04,-8526.23 26821,-8516.33 26864.6,-8506.73 26911.37,-8486.01 26943.39,-8470.04"/>
<polygon fill="red" stroke="red" points="26945.08,-8473.1 26952.42,-8465.46 26941.92,-8466.86 26945.08,-8473.1"/>
<text text-anchor="middle" x="26645.5" y="-8528.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu5 -->
<g id="node398" class="node">
<title>l2_attn_stage3_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="26136" cy="-8447.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26136" y="-8459.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="26136" y="-8444.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="26136" y="-8429.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu5&#45;&gt;l2_attn_stage3_gpu5 -->
<g id="edge598" class="edge">
<title>l2_attn_stage2_gpu5&#45;&gt;l2_attn_stage3_gpu5</title>
<path fill="none" stroke="black" d="M26080.85,-8565.37C26067.43,-8559.33 26052.93,-8553.53 26039,-8549.33 26025.22,-8545.18 25984.36,-8550.27 25975,-8539.33 25940.08,-8498.53 25980.79,-8538.65 26039,-8516.33 26056.78,-8509.51 26074.42,-8498.77 26089.68,-8487.84"/>
<polygon fill="black" stroke="black" points="26091.93,-8490.53 26097.9,-8481.77 26087.77,-8484.89 26091.93,-8490.53"/>
</g>
<!-- l2_attn_stage2_gpu5&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge2486" class="edge">
<title>l2_attn_stage2_gpu5&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26189.29,-8564.84C26203.43,-8558.5 26218.95,-8552.69 26234,-8549.33 26255.45,-8544.55 27009.56,-8554.97 27025,-8539.33 27043.16,-8520.94 27025.89,-8493.25 27008.31,-8473.34"/>
<polygon fill="red" stroke="red" points="27010.75,-8470.82 27001.38,-8465.87 27005.61,-8475.58 27010.75,-8470.82"/>
<text text-anchor="middle" x="27063.5" y="-8528.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu6 -->
<g id="node399" class="node">
<title>l2_attn_stage3_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="23991" cy="-8447.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23991" y="-8459.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="23991" y="-8444.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="23991" y="-8429.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu6&#45;&gt;l2_attn_stage3_gpu6 -->
<g id="edge599" class="edge">
<title>l2_attn_stage2_gpu6&#45;&gt;l2_attn_stage3_gpu6</title>
<path fill="none" stroke="black" d="M23991,-8557.24C23991,-8538.52 23991,-8515.53 23991,-8495.55"/>
<polygon fill="black" stroke="black" points="23994.5,-8495.41 23991,-8485.41 23987.5,-8495.41 23994.5,-8495.41"/>
</g>
<!-- l2_attn_stage2_gpu6&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge2487" class="edge">
<title>l2_attn_stage2_gpu6&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24044.28,-8564.76C24058.41,-8558.42 24073.94,-8552.63 24089,-8549.33 24143,-8537.5 26026.82,-8557.59 26079,-8539.33 26089.15,-8535.78 26087.86,-8527.92 26098,-8524.33 26135.87,-8510.95 26781.66,-8524.43 26821,-8516.33 26864.87,-8507.31 26911.77,-8486.39 26943.76,-8470.22"/>
<polygon fill="red" stroke="red" points="26945.48,-8473.27 26952.78,-8465.58 26942.28,-8467.04 26945.48,-8473.27"/>
<text text-anchor="middle" x="26129.5" y="-8528.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu7 -->
<g id="node400" class="node">
<title>l2_attn_stage3_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="26721" cy="-8447.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26721" y="-8459.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="26721" y="-8444.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="26721" y="-8429.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu7&#45;&gt;l2_attn_stage3_gpu7 -->
<g id="edge600" class="edge">
<title>l2_attn_stage2_gpu7&#45;&gt;l2_attn_stage3_gpu7</title>
<path fill="none" stroke="black" d="M26668.02,-8564.76C26654.09,-8558.47 26638.82,-8552.69 26624,-8549.33 26606.99,-8545.47 26008.24,-8551.77 25996,-8539.33 25991.32,-8534.58 25991.32,-8529.08 25996,-8524.33 26008.26,-8511.92 26607.39,-8521.66 26624,-8516.33 26642.46,-8510.41 26660.51,-8499.66 26675.94,-8488.46"/>
<polygon fill="black" stroke="black" points="26678.34,-8491.03 26684.22,-8482.22 26674.13,-8485.44 26678.34,-8491.03"/>
</g>
<!-- l2_attn_stage2_gpu7&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge2488" class="edge">
<title>l2_attn_stage2_gpu7&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26776.38,-8565.52C26791.74,-8558.95 26808.68,-8552.86 26825,-8549.33 26849.87,-8543.95 27265.2,-8557.52 27283,-8539.33 27337.67,-8483.46 27236.45,-8461.8 27137.12,-8453.54"/>
<polygon fill="red" stroke="red" points="27137.15,-8450.03 27126.9,-8452.74 27136.6,-8457.01 27137.15,-8450.03"/>
<text text-anchor="middle" x="27323.5" y="-8528.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu8 -->
<g id="node401" class="node">
<title>l2_attn_stage3_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="23796" cy="-8447.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23796" y="-8459.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="23796" y="-8444.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="23796" y="-8429.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu8&#45;&gt;l2_attn_stage3_gpu8 -->
<g id="edge601" class="edge">
<title>l2_attn_stage2_gpu8&#45;&gt;l2_attn_stage3_gpu8</title>
<path fill="none" stroke="black" d="M23796,-8557.24C23796,-8538.52 23796,-8515.53 23796,-8495.55"/>
<polygon fill="black" stroke="black" points="23799.5,-8495.41 23796,-8485.41 23792.5,-8495.41 23799.5,-8495.41"/>
</g>
<!-- l2_attn_stage2_gpu8&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge2489" class="edge">
<title>l2_attn_stage2_gpu8&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23849.29,-8564.83C23863.43,-8558.49 23878.95,-8552.68 23894,-8549.33 24123.73,-8498.2 25776.66,-8526.88 26012,-8524.33 26056.94,-8523.84 26776.97,-8525.36 26821,-8516.33 26864.87,-8507.33 26911.77,-8486.41 26943.76,-8470.23"/>
<polygon fill="red" stroke="red" points="26945.49,-8473.28 26952.78,-8465.59 26942.28,-8467.05 26945.49,-8473.28"/>
<text text-anchor="middle" x="26043.5" y="-8528.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu9 -->
<g id="node402" class="node">
<title>l2_attn_stage3_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26526" cy="-8447.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26526" y="-8459.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="26526" y="-8444.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26526" y="-8429.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu9&#45;&gt;l2_attn_stage3_gpu9 -->
<g id="edge602" class="edge">
<title>l2_attn_stage2_gpu9&#45;&gt;l2_attn_stage3_gpu9</title>
<path fill="none" stroke="black" d="M26472.74,-8564.72C26458.89,-8558.46 26443.71,-8552.72 26429,-8549.33 26405.17,-8543.84 26006.09,-8556.82 25989,-8539.33 25984.34,-8534.56 25984.33,-8529.09 25989,-8524.33 25997.56,-8515.61 26417.37,-8520.1 26429,-8516.33 26447.45,-8510.36 26465.49,-8499.6 26480.92,-8488.4"/>
<polygon fill="black" stroke="black" points="26483.32,-8490.97 26489.2,-8482.16 26479.11,-8485.38 26483.32,-8490.97"/>
</g>
<!-- l2_attn_stage2_gpu9&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge2490" class="edge">
<title>l2_attn_stage2_gpu9&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26579.3,-8564.89C26593.44,-8558.55 26608.96,-8552.72 26624,-8549.33 26639.53,-8545.83 27185.84,-8550.69 27197,-8539.33 27237.03,-8498.59 27167.32,-8475.24 27097.01,-8462.49"/>
<polygon fill="red" stroke="red" points="27097.55,-8459.03 27087.1,-8460.76 27096.35,-8465.93 27097.55,-8459.03"/>
<text text-anchor="middle" x="27237.5" y="-8528.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu10 -->
<g id="node403" class="node">
<title>l2_attn_stage3_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="24186" cy="-8447.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24186" y="-8459.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="24186" y="-8444.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="24186" y="-8429.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu10&#45;&gt;l2_attn_stage3_gpu10 -->
<g id="edge603" class="edge">
<title>l2_attn_stage2_gpu10&#45;&gt;l2_attn_stage3_gpu10</title>
<path fill="none" stroke="black" d="M24186,-8557.24C24186,-8538.52 24186,-8515.53 24186,-8495.55"/>
<polygon fill="black" stroke="black" points="24189.5,-8495.41 24186,-8485.41 24182.5,-8495.41 24189.5,-8495.41"/>
</g>
<!-- l2_attn_stage2_gpu10&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge2491" class="edge">
<title>l2_attn_stage2_gpu10&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24239.28,-8564.77C24253.41,-8558.43 24268.94,-8552.63 24284,-8549.33 24335.04,-8538.14 26115.68,-8556.6 26165,-8539.33 26175.15,-8535.78 26173.86,-8527.92 26184,-8524.33 26217.36,-8512.52 26786.34,-8523.49 26821,-8516.33 26864.86,-8507.27 26911.76,-8486.36 26943.75,-8470.2"/>
<polygon fill="red" stroke="red" points="26945.48,-8473.25 26952.77,-8465.57 26942.28,-8467.02 26945.48,-8473.25"/>
<text text-anchor="middle" x="26215.5" y="-8528.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu11 -->
<g id="node404" class="node">
<title>l2_attn_stage3_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="25356" cy="-8447.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25356" y="-8459.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="25356" y="-8444.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="25356" y="-8429.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu11&#45;&gt;l2_attn_stage3_gpu11 -->
<g id="edge604" class="edge">
<title>l2_attn_stage2_gpu11&#45;&gt;l2_attn_stage3_gpu11</title>
<path fill="none" stroke="black" d="M25356,-8557.24C25356,-8538.52 25356,-8515.53 25356,-8495.55"/>
<polygon fill="black" stroke="black" points="25359.5,-8495.41 25356,-8485.41 25352.5,-8495.41 25359.5,-8495.41"/>
</g>
<!-- l2_attn_stage2_gpu11&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge2492" class="edge">
<title>l2_attn_stage2_gpu11&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25409.28,-8564.8C25423.42,-8558.46 25438.95,-8552.65 25454,-8549.33 25520.57,-8534.64 26616.69,-8561.95 26681,-8539.33 26691.15,-8535.76 26689.96,-8528.19 26700,-8524.33 26750.3,-8504.99 26768.53,-8528.64 26821,-8516.33 26864.2,-8506.2 26910.67,-8485.75 26942.71,-8470"/>
<polygon fill="red" stroke="red" points="26944.38,-8473.09 26951.77,-8465.49 26941.25,-8466.82 26944.38,-8473.09"/>
<text text-anchor="middle" x="26731.5" y="-8528.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu12 -->
<g id="node405" class="node">
<title>l2_attn_stage3_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="24381" cy="-8447.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24381" y="-8459.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="24381" y="-8444.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="24381" y="-8429.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu12&#45;&gt;l2_attn_stage3_gpu12 -->
<g id="edge605" class="edge">
<title>l2_attn_stage2_gpu12&#45;&gt;l2_attn_stage3_gpu12</title>
<path fill="none" stroke="black" d="M24381,-8557.24C24381,-8538.52 24381,-8515.53 24381,-8495.55"/>
<polygon fill="black" stroke="black" points="24384.5,-8495.41 24381,-8485.41 24377.5,-8495.41 24384.5,-8495.41"/>
</g>
<!-- l2_attn_stage2_gpu12&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge2493" class="edge">
<title>l2_attn_stage2_gpu12&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24434.28,-8564.77C24448.41,-8558.43 24463.94,-8552.64 24479,-8549.33 24527.08,-8538.79 26204.55,-8555.61 26251,-8539.33 26261.15,-8535.78 26259.86,-8527.93 26270,-8524.33 26298.85,-8514.08 26791.02,-8522.55 26821,-8516.33 26864.85,-8507.23 26911.75,-8486.33 26943.75,-8470.18"/>
<polygon fill="red" stroke="red" points="26945.47,-8473.23 26952.77,-8465.55 26942.27,-8467 26945.47,-8473.23"/>
<text text-anchor="middle" x="26301.5" y="-8528.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu13 -->
<g id="node406" class="node">
<title>l2_attn_stage3_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="25551" cy="-8447.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25551" y="-8459.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="25551" y="-8444.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="25551" y="-8429.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu13&#45;&gt;l2_attn_stage3_gpu13 -->
<g id="edge606" class="edge">
<title>l2_attn_stage2_gpu13&#45;&gt;l2_attn_stage3_gpu13</title>
<path fill="none" stroke="black" d="M25551,-8557.24C25551,-8538.52 25551,-8515.53 25551,-8495.55"/>
<polygon fill="black" stroke="black" points="25554.5,-8495.41 25551,-8485.41 25547.5,-8495.41 25554.5,-8495.41"/>
</g>
<!-- l2_attn_stage2_gpu13&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge2494" class="edge">
<title>l2_attn_stage2_gpu13&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25604.28,-8564.8C25618.42,-8558.46 25633.95,-8552.66 25649,-8549.33 25709.65,-8535.92 26708.41,-8559.97 26767,-8539.33 26777.15,-8535.76 26776.3,-8528.98 26786,-8524.33 26800.39,-8517.44 26805.8,-8521.2 26821,-8516.33 26861.94,-8503.23 26906.95,-8484.07 26939.12,-8469.51"/>
<polygon fill="red" stroke="red" points="26940.61,-8472.68 26948.25,-8465.34 26937.7,-8466.31 26940.61,-8472.68"/>
<text text-anchor="middle" x="26817.5" y="-8528.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu14 -->
<g id="node407" class="node">
<title>l2_attn_stage3_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="24771" cy="-8447.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24771" y="-8459.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="24771" y="-8444.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="24771" y="-8429.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu14&#45;&gt;l2_attn_stage3_gpu14 -->
<g id="edge607" class="edge">
<title>l2_attn_stage2_gpu14&#45;&gt;l2_attn_stage3_gpu14</title>
<path fill="none" stroke="black" d="M24771,-8557.24C24771,-8538.52 24771,-8515.53 24771,-8495.55"/>
<polygon fill="black" stroke="black" points="24774.5,-8495.41 24771,-8485.41 24767.5,-8495.41 24774.5,-8495.41"/>
</g>
<!-- l2_attn_stage2_gpu14&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge2495" class="edge">
<title>l2_attn_stage2_gpu14&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24824.28,-8564.78C24838.41,-8558.44 24853.94,-8552.64 24869,-8549.33 24911.16,-8540.07 26382.27,-8553.62 26423,-8539.33 26433.15,-8535.77 26431.87,-8527.97 26442,-8524.33 26481.64,-8510.1 26779.79,-8525.03 26821,-8516.33 26864.82,-8507.09 26911.73,-8486.2 26943.73,-8470.1"/>
<polygon fill="red" stroke="red" points="26945.45,-8473.15 26952.75,-8465.48 26942.26,-8466.92 26945.45,-8473.15"/>
<text text-anchor="middle" x="26473.5" y="-8528.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu15 -->
<g id="node408" class="node">
<title>l2_attn_stage3_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="25746" cy="-8447.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25746" y="-8459.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="25746" y="-8444.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="25746" y="-8429.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu15&#45;&gt;l2_attn_stage3_gpu15 -->
<g id="edge608" class="edge">
<title>l2_attn_stage2_gpu15&#45;&gt;l2_attn_stage3_gpu15</title>
<path fill="none" stroke="black" d="M25746,-8557.24C25746,-8538.52 25746,-8515.53 25746,-8495.55"/>
<polygon fill="black" stroke="black" points="25749.5,-8495.41 25746,-8485.41 25742.5,-8495.41 25749.5,-8495.41"/>
</g>
<!-- l2_attn_stage2_gpu15&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge2496" class="edge">
<title>l2_attn_stage2_gpu15&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25799.29,-8564.81C25813.42,-8558.47 25828.95,-8552.67 25844,-8549.33 25898.73,-8537.2 26800.13,-8557.98 26853,-8539.33 26863.15,-8535.75 26863.32,-8530.69 26872,-8524.33 26897.22,-8505.84 26926.5,-8485.99 26948.65,-8471.28"/>
<polygon fill="red" stroke="red" points="26950.66,-8474.15 26957.07,-8465.72 26946.8,-8468.31 26950.66,-8474.15"/>
<text text-anchor="middle" x="26903.5" y="-8528.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu0 -->
<g id="node409" class="node">
<title>l2_attn_stage4_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24966" cy="-8300.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24966" y="-8312.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="24966" y="-8297.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24966" y="-8282.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu0&#45;&gt;l2_attn_stage4_gpu0 -->
<g id="edge609" class="edge">
<title>l2_attn_stage3_gpu0&#45;&gt;l2_attn_stage4_gpu0</title>
<path fill="none" stroke="black" d="M24966,-8410.24C24966,-8391.52 24966,-8368.53 24966,-8348.55"/>
<polygon fill="black" stroke="black" points="24969.5,-8348.41 24966,-8338.41 24962.5,-8348.41 24969.5,-8348.41"/>
</g>
<!-- l2_attn_stage4_gpu[next_gpu] -->
<g id="node1363" class="node">
<title>l2_attn_stage4_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="26983" cy="-8300.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="26983" y="-8297.13" font-family="Times,serif" font-size="14.00">l2_attn_stage4_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage3_gpu0&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge2497" class="edge">
<title>l2_attn_stage3_gpu0&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25019.28,-8417.78C25033.41,-8411.44 25048.94,-8405.64 25064,-8402.33 25103.2,-8393.71 26471.13,-8405.63 26509,-8392.33 26519.15,-8388.77 26517.89,-8381 26528,-8377.33 26558.62,-8366.23 26789.15,-8376.15 26821,-8369.33 26864.66,-8359.98 26911.41,-8339.22 26943.42,-8323.17"/>
<polygon fill="red" stroke="red" points="26945.12,-8326.23 26952.45,-8318.57 26941.95,-8319.99 26945.12,-8326.23"/>
<text text-anchor="middle" x="26559.5" y="-8381.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu1 -->
<g id="node410" class="node">
<title>l2_attn_stage4_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24576" cy="-8300.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24576" y="-8312.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="24576" y="-8297.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24576" y="-8282.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu1&#45;&gt;l2_attn_stage4_gpu1 -->
<g id="edge610" class="edge">
<title>l2_attn_stage3_gpu1&#45;&gt;l2_attn_stage4_gpu1</title>
<path fill="none" stroke="black" d="M24576,-8410.24C24576,-8391.52 24576,-8368.53 24576,-8348.55"/>
<polygon fill="black" stroke="black" points="24579.5,-8348.41 24576,-8338.41 24572.5,-8348.41 24579.5,-8348.41"/>
</g>
<!-- l2_attn_stage3_gpu1&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge2498" class="edge">
<title>l2_attn_stage3_gpu1&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24629.28,-8417.77C24643.41,-8411.43 24658.94,-8405.64 24674,-8402.33 24719.12,-8392.43 26293.41,-8407.61 26337,-8392.33 26347.15,-8388.77 26345.87,-8380.95 26356,-8377.33 26404.67,-8359.97 26770.42,-8379.9 26821,-8369.33 26864.84,-8360.17 26911.74,-8339.28 26943.74,-8323.14"/>
<polygon fill="red" stroke="red" points="26945.46,-8326.2 26952.76,-8318.52 26942.27,-8319.97 26945.46,-8326.2"/>
<text text-anchor="middle" x="26387.5" y="-8381.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu2 -->
<g id="node411" class="node">
<title>l2_attn_stage4_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25941" cy="-8300.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25941" y="-8312.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="25941" y="-8297.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25941" y="-8282.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu2&#45;&gt;l2_attn_stage4_gpu2 -->
<g id="edge611" class="edge">
<title>l2_attn_stage3_gpu2&#45;&gt;l2_attn_stage4_gpu2</title>
<path fill="none" stroke="black" d="M25941,-8410.24C25941,-8391.52 25941,-8368.53 25941,-8348.55"/>
<polygon fill="black" stroke="black" points="25944.5,-8348.41 25941,-8338.41 25937.5,-8348.41 25944.5,-8348.41"/>
</g>
<!-- l2_attn_stage3_gpu2&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge2499" class="edge">
<title>l2_attn_stage3_gpu2&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25994.29,-8417.83C26008.42,-8411.49 26023.95,-8405.68 26039,-8402.33 26063.41,-8396.91 26917.88,-8405.71 26939,-8392.33 26960.94,-8378.43 26972.24,-8350.15 26977.85,-8328.89"/>
<polygon fill="red" stroke="red" points="26981.27,-8329.64 26980.18,-8319.1 26974.46,-8328.02 26981.27,-8329.64"/>
<text text-anchor="middle" x="26985.5" y="-8381.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu3 -->
<g id="node412" class="node">
<title>l2_attn_stage4_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26331" cy="-8300.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26331" y="-8312.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="26331" y="-8297.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26331" y="-8282.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu3&#45;&gt;l2_attn_stage4_gpu3 -->
<g id="edge612" class="edge">
<title>l2_attn_stage3_gpu3&#45;&gt;l2_attn_stage4_gpu3</title>
<path fill="none" stroke="black" d="M26277.7,-8417.89C26263.85,-8411.63 26248.69,-8405.85 26234,-8402.33 26220.37,-8399.07 25991.71,-8402.43 25982,-8392.33 25977.38,-8387.53 25977.36,-8382.12 25982,-8377.33 25991.75,-8367.27 26220.7,-8373.74 26234,-8369.33 26252.4,-8363.24 26270.44,-8352.44 26285.87,-8341.25"/>
<polygon fill="black" stroke="black" points="26288.27,-8343.83 26294.16,-8335.02 26284.06,-8338.23 26288.27,-8343.83"/>
</g>
<!-- l2_attn_stage3_gpu3&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge2500" class="edge">
<title>l2_attn_stage3_gpu3&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26384.3,-8417.86C26398.43,-8411.52 26413.96,-8405.7 26429,-8402.33 26447.49,-8398.19 27097.7,-8405.83 27111,-8392.33 27139.36,-8363.56 27091.79,-8337.72 27046.82,-8321.1"/>
<polygon fill="red" stroke="red" points="27047.88,-8317.76 27037.29,-8317.69 27045.53,-8324.35 27047.88,-8317.76"/>
<text text-anchor="middle" x="27150.5" y="-8381.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu4 -->
<g id="node413" class="node">
<title>l2_attn_stage4_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25161" cy="-8300.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25161" y="-8312.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="25161" y="-8297.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25161" y="-8282.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu4&#45;&gt;l2_attn_stage4_gpu4 -->
<g id="edge613" class="edge">
<title>l2_attn_stage3_gpu4&#45;&gt;l2_attn_stage4_gpu4</title>
<path fill="none" stroke="black" d="M25161,-8410.24C25161,-8391.52 25161,-8368.53 25161,-8348.55"/>
<polygon fill="black" stroke="black" points="25164.5,-8348.41 25161,-8338.41 25157.5,-8348.41 25164.5,-8348.41"/>
</g>
<!-- l2_attn_stage3_gpu4&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge2501" class="edge">
<title>l2_attn_stage3_gpu4&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25214.28,-8417.79C25228.42,-8411.45 25243.95,-8405.65 25259,-8402.33 25295.24,-8394.35 26559.99,-8404.63 26595,-8392.33 26605.15,-8388.77 26603.91,-8381.06 26614,-8377.33 26657.19,-8361.4 26776.04,-8379.23 26821,-8369.33 26864.6,-8359.73 26911.37,-8339.01 26943.39,-8323.04"/>
<polygon fill="red" stroke="red" points="26945.08,-8326.1 26952.42,-8318.46 26941.92,-8319.86 26945.08,-8326.1"/>
<text text-anchor="middle" x="26645.5" y="-8381.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu5 -->
<g id="node414" class="node">
<title>l2_attn_stage4_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="26136" cy="-8300.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26136" y="-8312.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="26136" y="-8297.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="26136" y="-8282.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu5&#45;&gt;l2_attn_stage4_gpu5 -->
<g id="edge614" class="edge">
<title>l2_attn_stage3_gpu5&#45;&gt;l2_attn_stage4_gpu5</title>
<path fill="none" stroke="black" d="M26080.85,-8418.37C26067.43,-8412.33 26052.93,-8406.53 26039,-8402.33 26025.22,-8398.18 25984.36,-8403.27 25975,-8392.33 25940.08,-8351.53 25980.79,-8391.65 26039,-8369.33 26056.78,-8362.51 26074.42,-8351.77 26089.68,-8340.84"/>
<polygon fill="black" stroke="black" points="26091.93,-8343.53 26097.9,-8334.77 26087.77,-8337.89 26091.93,-8343.53"/>
</g>
<!-- l2_attn_stage3_gpu5&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge2502" class="edge">
<title>l2_attn_stage3_gpu5&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26189.29,-8417.84C26203.43,-8411.5 26218.95,-8405.69 26234,-8402.33 26255.45,-8397.55 27009.56,-8407.97 27025,-8392.33 27043.16,-8373.94 27025.89,-8346.25 27008.31,-8326.34"/>
<polygon fill="red" stroke="red" points="27010.75,-8323.82 27001.38,-8318.87 27005.61,-8328.58 27010.75,-8323.82"/>
<text text-anchor="middle" x="27063.5" y="-8381.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu6 -->
<g id="node415" class="node">
<title>l2_attn_stage4_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="23991" cy="-8300.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23991" y="-8312.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="23991" y="-8297.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="23991" y="-8282.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu6&#45;&gt;l2_attn_stage4_gpu6 -->
<g id="edge615" class="edge">
<title>l2_attn_stage3_gpu6&#45;&gt;l2_attn_stage4_gpu6</title>
<path fill="none" stroke="black" d="M23991,-8410.24C23991,-8391.52 23991,-8368.53 23991,-8348.55"/>
<polygon fill="black" stroke="black" points="23994.5,-8348.41 23991,-8338.41 23987.5,-8348.41 23994.5,-8348.41"/>
</g>
<!-- l2_attn_stage3_gpu6&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge2503" class="edge">
<title>l2_attn_stage3_gpu6&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24044.28,-8417.76C24058.41,-8411.42 24073.94,-8405.63 24089,-8402.33 24143,-8390.5 26026.82,-8410.59 26079,-8392.33 26089.15,-8388.78 26087.86,-8380.92 26098,-8377.33 26135.87,-8363.95 26781.66,-8377.43 26821,-8369.33 26864.87,-8360.31 26911.77,-8339.39 26943.76,-8323.22"/>
<polygon fill="red" stroke="red" points="26945.48,-8326.27 26952.78,-8318.58 26942.28,-8320.04 26945.48,-8326.27"/>
<text text-anchor="middle" x="26129.5" y="-8381.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu7 -->
<g id="node416" class="node">
<title>l2_attn_stage4_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="26721" cy="-8300.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26721" y="-8312.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="26721" y="-8297.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="26721" y="-8282.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu7&#45;&gt;l2_attn_stage4_gpu7 -->
<g id="edge616" class="edge">
<title>l2_attn_stage3_gpu7&#45;&gt;l2_attn_stage4_gpu7</title>
<path fill="none" stroke="black" d="M26668.02,-8417.76C26654.09,-8411.47 26638.82,-8405.69 26624,-8402.33 26606.99,-8398.47 26008.24,-8404.77 25996,-8392.33 25991.32,-8387.58 25991.32,-8382.08 25996,-8377.33 26008.26,-8364.92 26607.39,-8374.66 26624,-8369.33 26642.46,-8363.41 26660.51,-8352.66 26675.94,-8341.46"/>
<polygon fill="black" stroke="black" points="26678.34,-8344.03 26684.22,-8335.22 26674.13,-8338.44 26678.34,-8344.03"/>
</g>
<!-- l2_attn_stage3_gpu7&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge2504" class="edge">
<title>l2_attn_stage3_gpu7&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26776.38,-8418.52C26791.74,-8411.95 26808.68,-8405.86 26825,-8402.33 26849.87,-8396.95 27265.2,-8410.52 27283,-8392.33 27337.67,-8336.46 27236.45,-8314.8 27137.12,-8306.54"/>
<polygon fill="red" stroke="red" points="27137.15,-8303.03 27126.9,-8305.74 27136.6,-8310.01 27137.15,-8303.03"/>
<text text-anchor="middle" x="27323.5" y="-8381.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu8 -->
<g id="node417" class="node">
<title>l2_attn_stage4_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="23796" cy="-8300.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23796" y="-8312.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="23796" y="-8297.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="23796" y="-8282.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu8&#45;&gt;l2_attn_stage4_gpu8 -->
<g id="edge617" class="edge">
<title>l2_attn_stage3_gpu8&#45;&gt;l2_attn_stage4_gpu8</title>
<path fill="none" stroke="black" d="M23796,-8410.24C23796,-8391.52 23796,-8368.53 23796,-8348.55"/>
<polygon fill="black" stroke="black" points="23799.5,-8348.41 23796,-8338.41 23792.5,-8348.41 23799.5,-8348.41"/>
</g>
<!-- l2_attn_stage3_gpu8&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge2505" class="edge">
<title>l2_attn_stage3_gpu8&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23849.29,-8417.83C23863.43,-8411.49 23878.95,-8405.68 23894,-8402.33 24123.73,-8351.2 25776.66,-8379.88 26012,-8377.33 26056.94,-8376.84 26776.97,-8378.36 26821,-8369.33 26864.87,-8360.33 26911.77,-8339.41 26943.76,-8323.23"/>
<polygon fill="red" stroke="red" points="26945.49,-8326.28 26952.78,-8318.59 26942.28,-8320.05 26945.49,-8326.28"/>
<text text-anchor="middle" x="26043.5" y="-8381.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu9 -->
<g id="node418" class="node">
<title>l2_attn_stage4_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26526" cy="-8300.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26526" y="-8312.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="26526" y="-8297.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26526" y="-8282.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu9&#45;&gt;l2_attn_stage4_gpu9 -->
<g id="edge618" class="edge">
<title>l2_attn_stage3_gpu9&#45;&gt;l2_attn_stage4_gpu9</title>
<path fill="none" stroke="black" d="M26472.74,-8417.72C26458.89,-8411.46 26443.71,-8405.72 26429,-8402.33 26405.17,-8396.84 26006.09,-8409.82 25989,-8392.33 25984.34,-8387.56 25984.33,-8382.09 25989,-8377.33 25997.56,-8368.61 26417.37,-8373.1 26429,-8369.33 26447.45,-8363.36 26465.49,-8352.6 26480.92,-8341.4"/>
<polygon fill="black" stroke="black" points="26483.32,-8343.97 26489.2,-8335.16 26479.11,-8338.38 26483.32,-8343.97"/>
</g>
<!-- l2_attn_stage3_gpu9&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge2506" class="edge">
<title>l2_attn_stage3_gpu9&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26579.3,-8417.89C26593.44,-8411.55 26608.96,-8405.72 26624,-8402.33 26639.53,-8398.83 27185.84,-8403.69 27197,-8392.33 27237.03,-8351.59 27167.32,-8328.24 27097.01,-8315.49"/>
<polygon fill="red" stroke="red" points="27097.55,-8312.03 27087.1,-8313.76 27096.35,-8318.93 27097.55,-8312.03"/>
<text text-anchor="middle" x="27237.5" y="-8381.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu10 -->
<g id="node419" class="node">
<title>l2_attn_stage4_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="24186" cy="-8300.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24186" y="-8312.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="24186" y="-8297.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="24186" y="-8282.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu10&#45;&gt;l2_attn_stage4_gpu10 -->
<g id="edge619" class="edge">
<title>l2_attn_stage3_gpu10&#45;&gt;l2_attn_stage4_gpu10</title>
<path fill="none" stroke="black" d="M24186,-8410.24C24186,-8391.52 24186,-8368.53 24186,-8348.55"/>
<polygon fill="black" stroke="black" points="24189.5,-8348.41 24186,-8338.41 24182.5,-8348.41 24189.5,-8348.41"/>
</g>
<!-- l2_attn_stage3_gpu10&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge2507" class="edge">
<title>l2_attn_stage3_gpu10&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24239.28,-8417.77C24253.41,-8411.43 24268.94,-8405.63 24284,-8402.33 24335.04,-8391.14 26115.68,-8409.6 26165,-8392.33 26175.15,-8388.78 26173.86,-8380.92 26184,-8377.33 26217.36,-8365.52 26786.34,-8376.49 26821,-8369.33 26864.86,-8360.27 26911.76,-8339.36 26943.75,-8323.2"/>
<polygon fill="red" stroke="red" points="26945.48,-8326.25 26952.77,-8318.57 26942.28,-8320.02 26945.48,-8326.25"/>
<text text-anchor="middle" x="26215.5" y="-8381.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu11 -->
<g id="node420" class="node">
<title>l2_attn_stage4_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="25356" cy="-8300.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25356" y="-8312.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="25356" y="-8297.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="25356" y="-8282.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu11&#45;&gt;l2_attn_stage4_gpu11 -->
<g id="edge620" class="edge">
<title>l2_attn_stage3_gpu11&#45;&gt;l2_attn_stage4_gpu11</title>
<path fill="none" stroke="black" d="M25356,-8410.24C25356,-8391.52 25356,-8368.53 25356,-8348.55"/>
<polygon fill="black" stroke="black" points="25359.5,-8348.41 25356,-8338.41 25352.5,-8348.41 25359.5,-8348.41"/>
</g>
<!-- l2_attn_stage3_gpu11&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge2508" class="edge">
<title>l2_attn_stage3_gpu11&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25409.28,-8417.8C25423.42,-8411.46 25438.95,-8405.65 25454,-8402.33 25520.57,-8387.64 26616.69,-8414.95 26681,-8392.33 26691.15,-8388.76 26689.96,-8381.19 26700,-8377.33 26750.3,-8357.99 26768.53,-8381.64 26821,-8369.33 26864.2,-8359.2 26910.67,-8338.75 26942.71,-8323"/>
<polygon fill="red" stroke="red" points="26944.38,-8326.09 26951.77,-8318.49 26941.25,-8319.82 26944.38,-8326.09"/>
<text text-anchor="middle" x="26731.5" y="-8381.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu12 -->
<g id="node421" class="node">
<title>l2_attn_stage4_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="24381" cy="-8300.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24381" y="-8312.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="24381" y="-8297.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="24381" y="-8282.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu12&#45;&gt;l2_attn_stage4_gpu12 -->
<g id="edge621" class="edge">
<title>l2_attn_stage3_gpu12&#45;&gt;l2_attn_stage4_gpu12</title>
<path fill="none" stroke="black" d="M24381,-8410.24C24381,-8391.52 24381,-8368.53 24381,-8348.55"/>
<polygon fill="black" stroke="black" points="24384.5,-8348.41 24381,-8338.41 24377.5,-8348.41 24384.5,-8348.41"/>
</g>
<!-- l2_attn_stage3_gpu12&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge2509" class="edge">
<title>l2_attn_stage3_gpu12&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24434.28,-8417.77C24448.41,-8411.43 24463.94,-8405.64 24479,-8402.33 24527.08,-8391.79 26204.55,-8408.61 26251,-8392.33 26261.15,-8388.78 26259.86,-8380.93 26270,-8377.33 26298.85,-8367.08 26791.02,-8375.55 26821,-8369.33 26864.85,-8360.23 26911.75,-8339.33 26943.75,-8323.18"/>
<polygon fill="red" stroke="red" points="26945.47,-8326.23 26952.77,-8318.55 26942.27,-8320 26945.47,-8326.23"/>
<text text-anchor="middle" x="26301.5" y="-8381.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu13 -->
<g id="node422" class="node">
<title>l2_attn_stage4_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="25551" cy="-8300.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25551" y="-8312.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="25551" y="-8297.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="25551" y="-8282.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu13&#45;&gt;l2_attn_stage4_gpu13 -->
<g id="edge622" class="edge">
<title>l2_attn_stage3_gpu13&#45;&gt;l2_attn_stage4_gpu13</title>
<path fill="none" stroke="black" d="M25551,-8410.24C25551,-8391.52 25551,-8368.53 25551,-8348.55"/>
<polygon fill="black" stroke="black" points="25554.5,-8348.41 25551,-8338.41 25547.5,-8348.41 25554.5,-8348.41"/>
</g>
<!-- l2_attn_stage3_gpu13&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge2510" class="edge">
<title>l2_attn_stage3_gpu13&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25604.28,-8417.8C25618.42,-8411.46 25633.95,-8405.66 25649,-8402.33 25709.65,-8388.92 26708.41,-8412.97 26767,-8392.33 26777.15,-8388.76 26776.3,-8381.98 26786,-8377.33 26800.39,-8370.44 26805.8,-8374.2 26821,-8369.33 26861.94,-8356.23 26906.95,-8337.07 26939.12,-8322.51"/>
<polygon fill="red" stroke="red" points="26940.61,-8325.68 26948.25,-8318.34 26937.7,-8319.31 26940.61,-8325.68"/>
<text text-anchor="middle" x="26817.5" y="-8381.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu14 -->
<g id="node423" class="node">
<title>l2_attn_stage4_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="24771" cy="-8300.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24771" y="-8312.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="24771" y="-8297.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="24771" y="-8282.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu14&#45;&gt;l2_attn_stage4_gpu14 -->
<g id="edge623" class="edge">
<title>l2_attn_stage3_gpu14&#45;&gt;l2_attn_stage4_gpu14</title>
<path fill="none" stroke="black" d="M24771,-8410.24C24771,-8391.52 24771,-8368.53 24771,-8348.55"/>
<polygon fill="black" stroke="black" points="24774.5,-8348.41 24771,-8338.41 24767.5,-8348.41 24774.5,-8348.41"/>
</g>
<!-- l2_attn_stage3_gpu14&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge2511" class="edge">
<title>l2_attn_stage3_gpu14&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24824.28,-8417.78C24838.41,-8411.44 24853.94,-8405.64 24869,-8402.33 24911.16,-8393.07 26382.27,-8406.62 26423,-8392.33 26433.15,-8388.77 26431.87,-8380.97 26442,-8377.33 26481.64,-8363.1 26779.79,-8378.03 26821,-8369.33 26864.82,-8360.09 26911.73,-8339.2 26943.73,-8323.1"/>
<polygon fill="red" stroke="red" points="26945.45,-8326.15 26952.75,-8318.48 26942.26,-8319.92 26945.45,-8326.15"/>
<text text-anchor="middle" x="26473.5" y="-8381.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu15 -->
<g id="node424" class="node">
<title>l2_attn_stage4_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="25746" cy="-8300.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25746" y="-8312.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="25746" y="-8297.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="25746" y="-8282.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu15&#45;&gt;l2_attn_stage4_gpu15 -->
<g id="edge624" class="edge">
<title>l2_attn_stage3_gpu15&#45;&gt;l2_attn_stage4_gpu15</title>
<path fill="none" stroke="black" d="M25746,-8410.24C25746,-8391.52 25746,-8368.53 25746,-8348.55"/>
<polygon fill="black" stroke="black" points="25749.5,-8348.41 25746,-8338.41 25742.5,-8348.41 25749.5,-8348.41"/>
</g>
<!-- l2_attn_stage3_gpu15&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge2512" class="edge">
<title>l2_attn_stage3_gpu15&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25799.29,-8417.81C25813.42,-8411.47 25828.95,-8405.67 25844,-8402.33 25898.73,-8390.2 26800.13,-8410.98 26853,-8392.33 26863.15,-8388.75 26863.32,-8383.69 26872,-8377.33 26897.22,-8358.84 26926.5,-8338.99 26948.65,-8324.28"/>
<polygon fill="red" stroke="red" points="26950.66,-8327.15 26957.07,-8318.72 26946.8,-8321.31 26950.66,-8327.15"/>
<text text-anchor="middle" x="26903.5" y="-8381.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu0 -->
<g id="node425" class="node">
<title>l2_attn_stage5_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24966" cy="-8153.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24966" y="-8165.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="24966" y="-8150.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24966" y="-8135.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu0&#45;&gt;l2_attn_stage5_gpu0 -->
<g id="edge625" class="edge">
<title>l2_attn_stage4_gpu0&#45;&gt;l2_attn_stage5_gpu0</title>
<path fill="none" stroke="black" d="M24966,-8263.24C24966,-8244.52 24966,-8221.53 24966,-8201.55"/>
<polygon fill="black" stroke="black" points="24969.5,-8201.41 24966,-8191.41 24962.5,-8201.41 24969.5,-8201.41"/>
</g>
<!-- l2_attn_stage5_gpu[next_gpu] -->
<g id="node1364" class="node">
<title>l2_attn_stage5_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="26983" cy="-8153.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="26983" y="-8150.13" font-family="Times,serif" font-size="14.00">l2_attn_stage5_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage4_gpu0&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge2513" class="edge">
<title>l2_attn_stage4_gpu0&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25019.28,-8270.78C25033.41,-8264.44 25048.94,-8258.64 25064,-8255.33 25103.2,-8246.71 26471.13,-8258.63 26509,-8245.33 26519.15,-8241.77 26517.89,-8234 26528,-8230.33 26558.62,-8219.23 26789.15,-8229.15 26821,-8222.33 26864.66,-8212.98 26911.41,-8192.22 26943.42,-8176.17"/>
<polygon fill="red" stroke="red" points="26945.12,-8179.23 26952.45,-8171.57 26941.95,-8172.99 26945.12,-8179.23"/>
<text text-anchor="middle" x="26559.5" y="-8234.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu1 -->
<g id="node426" class="node">
<title>l2_attn_stage5_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24576" cy="-8153.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24576" y="-8165.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="24576" y="-8150.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24576" y="-8135.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu1&#45;&gt;l2_attn_stage5_gpu1 -->
<g id="edge626" class="edge">
<title>l2_attn_stage4_gpu1&#45;&gt;l2_attn_stage5_gpu1</title>
<path fill="none" stroke="black" d="M24576,-8263.24C24576,-8244.52 24576,-8221.53 24576,-8201.55"/>
<polygon fill="black" stroke="black" points="24579.5,-8201.41 24576,-8191.41 24572.5,-8201.41 24579.5,-8201.41"/>
</g>
<!-- l2_attn_stage4_gpu1&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge2514" class="edge">
<title>l2_attn_stage4_gpu1&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24629.28,-8270.77C24643.41,-8264.43 24658.94,-8258.64 24674,-8255.33 24719.12,-8245.43 26293.41,-8260.61 26337,-8245.33 26347.15,-8241.77 26345.87,-8233.95 26356,-8230.33 26404.67,-8212.97 26770.42,-8232.9 26821,-8222.33 26864.84,-8213.17 26911.74,-8192.28 26943.74,-8176.14"/>
<polygon fill="red" stroke="red" points="26945.46,-8179.2 26952.76,-8171.52 26942.27,-8172.97 26945.46,-8179.2"/>
<text text-anchor="middle" x="26387.5" y="-8234.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu2 -->
<g id="node427" class="node">
<title>l2_attn_stage5_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25941" cy="-8153.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25941" y="-8165.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="25941" y="-8150.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25941" y="-8135.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu2&#45;&gt;l2_attn_stage5_gpu2 -->
<g id="edge627" class="edge">
<title>l2_attn_stage4_gpu2&#45;&gt;l2_attn_stage5_gpu2</title>
<path fill="none" stroke="black" d="M25941,-8263.24C25941,-8244.52 25941,-8221.53 25941,-8201.55"/>
<polygon fill="black" stroke="black" points="25944.5,-8201.41 25941,-8191.41 25937.5,-8201.41 25944.5,-8201.41"/>
</g>
<!-- l2_attn_stage4_gpu2&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge2515" class="edge">
<title>l2_attn_stage4_gpu2&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25994.29,-8270.83C26008.42,-8264.49 26023.95,-8258.68 26039,-8255.33 26063.41,-8249.91 26917.88,-8258.71 26939,-8245.33 26960.94,-8231.43 26972.24,-8203.15 26977.85,-8181.89"/>
<polygon fill="red" stroke="red" points="26981.27,-8182.64 26980.18,-8172.1 26974.46,-8181.02 26981.27,-8182.64"/>
<text text-anchor="middle" x="26985.5" y="-8234.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu3 -->
<g id="node428" class="node">
<title>l2_attn_stage5_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26331" cy="-8153.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26331" y="-8165.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="26331" y="-8150.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26331" y="-8135.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu3&#45;&gt;l2_attn_stage5_gpu3 -->
<g id="edge628" class="edge">
<title>l2_attn_stage4_gpu3&#45;&gt;l2_attn_stage5_gpu3</title>
<path fill="none" stroke="black" d="M26277.7,-8270.89C26263.85,-8264.63 26248.69,-8258.85 26234,-8255.33 26220.37,-8252.07 25991.71,-8255.43 25982,-8245.33 25977.38,-8240.53 25977.36,-8235.12 25982,-8230.33 25991.75,-8220.27 26220.7,-8226.74 26234,-8222.33 26252.4,-8216.24 26270.44,-8205.44 26285.87,-8194.25"/>
<polygon fill="black" stroke="black" points="26288.27,-8196.83 26294.16,-8188.02 26284.06,-8191.23 26288.27,-8196.83"/>
</g>
<!-- l2_attn_stage4_gpu3&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge2516" class="edge">
<title>l2_attn_stage4_gpu3&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26384.3,-8270.86C26398.43,-8264.52 26413.96,-8258.7 26429,-8255.33 26447.49,-8251.19 27097.7,-8258.83 27111,-8245.33 27139.36,-8216.56 27091.79,-8190.72 27046.82,-8174.1"/>
<polygon fill="red" stroke="red" points="27047.88,-8170.76 27037.29,-8170.69 27045.53,-8177.35 27047.88,-8170.76"/>
<text text-anchor="middle" x="27150.5" y="-8234.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu4 -->
<g id="node429" class="node">
<title>l2_attn_stage5_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25161" cy="-8153.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25161" y="-8165.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="25161" y="-8150.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25161" y="-8135.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu4&#45;&gt;l2_attn_stage5_gpu4 -->
<g id="edge629" class="edge">
<title>l2_attn_stage4_gpu4&#45;&gt;l2_attn_stage5_gpu4</title>
<path fill="none" stroke="black" d="M25161,-8263.24C25161,-8244.52 25161,-8221.53 25161,-8201.55"/>
<polygon fill="black" stroke="black" points="25164.5,-8201.41 25161,-8191.41 25157.5,-8201.41 25164.5,-8201.41"/>
</g>
<!-- l2_attn_stage4_gpu4&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge2517" class="edge">
<title>l2_attn_stage4_gpu4&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25214.28,-8270.79C25228.42,-8264.45 25243.95,-8258.65 25259,-8255.33 25295.24,-8247.35 26559.99,-8257.63 26595,-8245.33 26605.15,-8241.77 26603.91,-8234.06 26614,-8230.33 26657.19,-8214.4 26776.04,-8232.23 26821,-8222.33 26864.6,-8212.73 26911.37,-8192.01 26943.39,-8176.04"/>
<polygon fill="red" stroke="red" points="26945.08,-8179.1 26952.42,-8171.46 26941.92,-8172.86 26945.08,-8179.1"/>
<text text-anchor="middle" x="26645.5" y="-8234.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu5 -->
<g id="node430" class="node">
<title>l2_attn_stage5_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="26136" cy="-8153.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26136" y="-8165.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="26136" y="-8150.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="26136" y="-8135.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu5&#45;&gt;l2_attn_stage5_gpu5 -->
<g id="edge630" class="edge">
<title>l2_attn_stage4_gpu5&#45;&gt;l2_attn_stage5_gpu5</title>
<path fill="none" stroke="black" d="M26080.85,-8271.37C26067.43,-8265.33 26052.93,-8259.53 26039,-8255.33 26025.22,-8251.18 25984.36,-8256.27 25975,-8245.33 25940.08,-8204.53 25980.79,-8244.65 26039,-8222.33 26056.78,-8215.51 26074.42,-8204.77 26089.68,-8193.84"/>
<polygon fill="black" stroke="black" points="26091.93,-8196.53 26097.9,-8187.77 26087.77,-8190.89 26091.93,-8196.53"/>
</g>
<!-- l2_attn_stage4_gpu5&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge2518" class="edge">
<title>l2_attn_stage4_gpu5&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26189.29,-8270.84C26203.43,-8264.5 26218.95,-8258.69 26234,-8255.33 26255.45,-8250.55 27009.56,-8260.97 27025,-8245.33 27043.16,-8226.94 27025.89,-8199.25 27008.31,-8179.34"/>
<polygon fill="red" stroke="red" points="27010.75,-8176.82 27001.38,-8171.87 27005.61,-8181.58 27010.75,-8176.82"/>
<text text-anchor="middle" x="27063.5" y="-8234.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu6 -->
<g id="node431" class="node">
<title>l2_attn_stage5_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="23991" cy="-8153.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23991" y="-8165.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="23991" y="-8150.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="23991" y="-8135.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu6&#45;&gt;l2_attn_stage5_gpu6 -->
<g id="edge631" class="edge">
<title>l2_attn_stage4_gpu6&#45;&gt;l2_attn_stage5_gpu6</title>
<path fill="none" stroke="black" d="M23991,-8263.24C23991,-8244.52 23991,-8221.53 23991,-8201.55"/>
<polygon fill="black" stroke="black" points="23994.5,-8201.41 23991,-8191.41 23987.5,-8201.41 23994.5,-8201.41"/>
</g>
<!-- l2_attn_stage4_gpu6&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge2519" class="edge">
<title>l2_attn_stage4_gpu6&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24044.28,-8270.76C24058.41,-8264.42 24073.94,-8258.63 24089,-8255.33 24143,-8243.5 26026.82,-8263.59 26079,-8245.33 26089.15,-8241.78 26087.86,-8233.92 26098,-8230.33 26135.87,-8216.95 26781.66,-8230.43 26821,-8222.33 26864.87,-8213.31 26911.77,-8192.39 26943.76,-8176.22"/>
<polygon fill="red" stroke="red" points="26945.48,-8179.27 26952.78,-8171.58 26942.28,-8173.04 26945.48,-8179.27"/>
<text text-anchor="middle" x="26129.5" y="-8234.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu7 -->
<g id="node432" class="node">
<title>l2_attn_stage5_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="26721" cy="-8153.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26721" y="-8165.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="26721" y="-8150.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="26721" y="-8135.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu7&#45;&gt;l2_attn_stage5_gpu7 -->
<g id="edge632" class="edge">
<title>l2_attn_stage4_gpu7&#45;&gt;l2_attn_stage5_gpu7</title>
<path fill="none" stroke="black" d="M26668.02,-8270.76C26654.09,-8264.47 26638.82,-8258.69 26624,-8255.33 26606.99,-8251.47 26008.24,-8257.77 25996,-8245.33 25991.32,-8240.58 25991.32,-8235.08 25996,-8230.33 26008.26,-8217.92 26607.39,-8227.66 26624,-8222.33 26642.46,-8216.41 26660.51,-8205.66 26675.94,-8194.46"/>
<polygon fill="black" stroke="black" points="26678.34,-8197.03 26684.22,-8188.22 26674.13,-8191.44 26678.34,-8197.03"/>
</g>
<!-- l2_attn_stage4_gpu7&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge2520" class="edge">
<title>l2_attn_stage4_gpu7&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26776.38,-8271.52C26791.74,-8264.95 26808.68,-8258.86 26825,-8255.33 26849.87,-8249.95 27265.2,-8263.52 27283,-8245.33 27337.67,-8189.46 27236.45,-8167.8 27137.12,-8159.54"/>
<polygon fill="red" stroke="red" points="27137.15,-8156.03 27126.9,-8158.74 27136.6,-8163.01 27137.15,-8156.03"/>
<text text-anchor="middle" x="27323.5" y="-8234.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu8 -->
<g id="node433" class="node">
<title>l2_attn_stage5_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="23796" cy="-8153.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23796" y="-8165.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="23796" y="-8150.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="23796" y="-8135.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu8&#45;&gt;l2_attn_stage5_gpu8 -->
<g id="edge633" class="edge">
<title>l2_attn_stage4_gpu8&#45;&gt;l2_attn_stage5_gpu8</title>
<path fill="none" stroke="black" d="M23796,-8263.24C23796,-8244.52 23796,-8221.53 23796,-8201.55"/>
<polygon fill="black" stroke="black" points="23799.5,-8201.41 23796,-8191.41 23792.5,-8201.41 23799.5,-8201.41"/>
</g>
<!-- l2_attn_stage4_gpu8&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge2521" class="edge">
<title>l2_attn_stage4_gpu8&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23849.29,-8270.83C23863.43,-8264.49 23878.95,-8258.68 23894,-8255.33 24123.73,-8204.2 25776.66,-8232.88 26012,-8230.33 26056.94,-8229.84 26776.97,-8231.36 26821,-8222.33 26864.87,-8213.33 26911.77,-8192.41 26943.76,-8176.23"/>
<polygon fill="red" stroke="red" points="26945.49,-8179.28 26952.78,-8171.59 26942.28,-8173.05 26945.49,-8179.28"/>
<text text-anchor="middle" x="26043.5" y="-8234.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu9 -->
<g id="node434" class="node">
<title>l2_attn_stage5_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26526" cy="-8153.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26526" y="-8165.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="26526" y="-8150.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26526" y="-8135.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu9&#45;&gt;l2_attn_stage5_gpu9 -->
<g id="edge634" class="edge">
<title>l2_attn_stage4_gpu9&#45;&gt;l2_attn_stage5_gpu9</title>
<path fill="none" stroke="black" d="M26472.74,-8270.72C26458.89,-8264.46 26443.71,-8258.72 26429,-8255.33 26405.17,-8249.84 26006.09,-8262.82 25989,-8245.33 25984.34,-8240.56 25984.33,-8235.09 25989,-8230.33 25997.56,-8221.61 26417.37,-8226.1 26429,-8222.33 26447.45,-8216.36 26465.49,-8205.6 26480.92,-8194.4"/>
<polygon fill="black" stroke="black" points="26483.32,-8196.97 26489.2,-8188.16 26479.11,-8191.38 26483.32,-8196.97"/>
</g>
<!-- l2_attn_stage4_gpu9&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge2522" class="edge">
<title>l2_attn_stage4_gpu9&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26579.3,-8270.89C26593.44,-8264.55 26608.96,-8258.72 26624,-8255.33 26639.53,-8251.83 27185.84,-8256.69 27197,-8245.33 27237.03,-8204.59 27167.32,-8181.24 27097.01,-8168.49"/>
<polygon fill="red" stroke="red" points="27097.55,-8165.03 27087.1,-8166.76 27096.35,-8171.93 27097.55,-8165.03"/>
<text text-anchor="middle" x="27237.5" y="-8234.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu10 -->
<g id="node435" class="node">
<title>l2_attn_stage5_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="24186" cy="-8153.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24186" y="-8165.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="24186" y="-8150.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="24186" y="-8135.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu10&#45;&gt;l2_attn_stage5_gpu10 -->
<g id="edge635" class="edge">
<title>l2_attn_stage4_gpu10&#45;&gt;l2_attn_stage5_gpu10</title>
<path fill="none" stroke="black" d="M24186,-8263.24C24186,-8244.52 24186,-8221.53 24186,-8201.55"/>
<polygon fill="black" stroke="black" points="24189.5,-8201.41 24186,-8191.41 24182.5,-8201.41 24189.5,-8201.41"/>
</g>
<!-- l2_attn_stage4_gpu10&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge2523" class="edge">
<title>l2_attn_stage4_gpu10&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24239.28,-8270.77C24253.41,-8264.43 24268.94,-8258.63 24284,-8255.33 24335.04,-8244.14 26115.68,-8262.6 26165,-8245.33 26175.15,-8241.78 26173.86,-8233.92 26184,-8230.33 26217.36,-8218.52 26786.34,-8229.49 26821,-8222.33 26864.86,-8213.27 26911.76,-8192.36 26943.75,-8176.2"/>
<polygon fill="red" stroke="red" points="26945.48,-8179.25 26952.77,-8171.57 26942.28,-8173.02 26945.48,-8179.25"/>
<text text-anchor="middle" x="26215.5" y="-8234.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu11 -->
<g id="node436" class="node">
<title>l2_attn_stage5_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="25356" cy="-8153.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25356" y="-8165.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="25356" y="-8150.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="25356" y="-8135.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu11&#45;&gt;l2_attn_stage5_gpu11 -->
<g id="edge636" class="edge">
<title>l2_attn_stage4_gpu11&#45;&gt;l2_attn_stage5_gpu11</title>
<path fill="none" stroke="black" d="M25356,-8263.24C25356,-8244.52 25356,-8221.53 25356,-8201.55"/>
<polygon fill="black" stroke="black" points="25359.5,-8201.41 25356,-8191.41 25352.5,-8201.41 25359.5,-8201.41"/>
</g>
<!-- l2_attn_stage4_gpu11&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge2524" class="edge">
<title>l2_attn_stage4_gpu11&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25409.28,-8270.8C25423.42,-8264.46 25438.95,-8258.65 25454,-8255.33 25520.57,-8240.64 26616.69,-8267.95 26681,-8245.33 26691.15,-8241.76 26689.96,-8234.19 26700,-8230.33 26750.3,-8210.99 26768.53,-8234.64 26821,-8222.33 26864.2,-8212.2 26910.67,-8191.75 26942.71,-8176"/>
<polygon fill="red" stroke="red" points="26944.38,-8179.09 26951.77,-8171.49 26941.25,-8172.82 26944.38,-8179.09"/>
<text text-anchor="middle" x="26731.5" y="-8234.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu12 -->
<g id="node437" class="node">
<title>l2_attn_stage5_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="24381" cy="-8153.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24381" y="-8165.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="24381" y="-8150.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="24381" y="-8135.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu12&#45;&gt;l2_attn_stage5_gpu12 -->
<g id="edge637" class="edge">
<title>l2_attn_stage4_gpu12&#45;&gt;l2_attn_stage5_gpu12</title>
<path fill="none" stroke="black" d="M24381,-8263.24C24381,-8244.52 24381,-8221.53 24381,-8201.55"/>
<polygon fill="black" stroke="black" points="24384.5,-8201.41 24381,-8191.41 24377.5,-8201.41 24384.5,-8201.41"/>
</g>
<!-- l2_attn_stage4_gpu12&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge2525" class="edge">
<title>l2_attn_stage4_gpu12&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24434.28,-8270.77C24448.41,-8264.43 24463.94,-8258.64 24479,-8255.33 24527.08,-8244.79 26204.55,-8261.61 26251,-8245.33 26261.15,-8241.78 26259.86,-8233.93 26270,-8230.33 26298.85,-8220.08 26791.02,-8228.55 26821,-8222.33 26864.85,-8213.23 26911.75,-8192.33 26943.75,-8176.18"/>
<polygon fill="red" stroke="red" points="26945.47,-8179.23 26952.77,-8171.55 26942.27,-8173 26945.47,-8179.23"/>
<text text-anchor="middle" x="26301.5" y="-8234.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu13 -->
<g id="node438" class="node">
<title>l2_attn_stage5_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="25551" cy="-8153.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25551" y="-8165.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="25551" y="-8150.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="25551" y="-8135.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu13&#45;&gt;l2_attn_stage5_gpu13 -->
<g id="edge638" class="edge">
<title>l2_attn_stage4_gpu13&#45;&gt;l2_attn_stage5_gpu13</title>
<path fill="none" stroke="black" d="M25551,-8263.24C25551,-8244.52 25551,-8221.53 25551,-8201.55"/>
<polygon fill="black" stroke="black" points="25554.5,-8201.41 25551,-8191.41 25547.5,-8201.41 25554.5,-8201.41"/>
</g>
<!-- l2_attn_stage4_gpu13&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge2526" class="edge">
<title>l2_attn_stage4_gpu13&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25604.28,-8270.8C25618.42,-8264.46 25633.95,-8258.66 25649,-8255.33 25709.65,-8241.92 26708.41,-8265.97 26767,-8245.33 26777.15,-8241.76 26776.3,-8234.98 26786,-8230.33 26800.39,-8223.44 26805.8,-8227.2 26821,-8222.33 26861.94,-8209.23 26906.95,-8190.07 26939.12,-8175.51"/>
<polygon fill="red" stroke="red" points="26940.61,-8178.68 26948.25,-8171.34 26937.7,-8172.31 26940.61,-8178.68"/>
<text text-anchor="middle" x="26817.5" y="-8234.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu14 -->
<g id="node439" class="node">
<title>l2_attn_stage5_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="24771" cy="-8153.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24771" y="-8165.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="24771" y="-8150.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="24771" y="-8135.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu14&#45;&gt;l2_attn_stage5_gpu14 -->
<g id="edge639" class="edge">
<title>l2_attn_stage4_gpu14&#45;&gt;l2_attn_stage5_gpu14</title>
<path fill="none" stroke="black" d="M24771,-8263.24C24771,-8244.52 24771,-8221.53 24771,-8201.55"/>
<polygon fill="black" stroke="black" points="24774.5,-8201.41 24771,-8191.41 24767.5,-8201.41 24774.5,-8201.41"/>
</g>
<!-- l2_attn_stage4_gpu14&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge2527" class="edge">
<title>l2_attn_stage4_gpu14&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24824.28,-8270.78C24838.41,-8264.44 24853.94,-8258.64 24869,-8255.33 24911.16,-8246.07 26382.27,-8259.62 26423,-8245.33 26433.15,-8241.77 26431.87,-8233.97 26442,-8230.33 26481.64,-8216.1 26779.79,-8231.03 26821,-8222.33 26864.82,-8213.09 26911.73,-8192.2 26943.73,-8176.1"/>
<polygon fill="red" stroke="red" points="26945.45,-8179.15 26952.75,-8171.48 26942.26,-8172.92 26945.45,-8179.15"/>
<text text-anchor="middle" x="26473.5" y="-8234.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu15 -->
<g id="node440" class="node">
<title>l2_attn_stage5_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="25746" cy="-8153.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25746" y="-8165.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="25746" y="-8150.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="25746" y="-8135.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu15&#45;&gt;l2_attn_stage5_gpu15 -->
<g id="edge640" class="edge">
<title>l2_attn_stage4_gpu15&#45;&gt;l2_attn_stage5_gpu15</title>
<path fill="none" stroke="black" d="M25746,-8263.24C25746,-8244.52 25746,-8221.53 25746,-8201.55"/>
<polygon fill="black" stroke="black" points="25749.5,-8201.41 25746,-8191.41 25742.5,-8201.41 25749.5,-8201.41"/>
</g>
<!-- l2_attn_stage4_gpu15&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge2528" class="edge">
<title>l2_attn_stage4_gpu15&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25799.29,-8270.81C25813.42,-8264.47 25828.95,-8258.67 25844,-8255.33 25898.73,-8243.2 26800.13,-8263.98 26853,-8245.33 26863.15,-8241.75 26863.32,-8236.69 26872,-8230.33 26897.22,-8211.84 26926.5,-8191.99 26948.65,-8177.28"/>
<polygon fill="red" stroke="red" points="26950.66,-8180.15 26957.07,-8171.72 26946.8,-8174.31 26950.66,-8180.15"/>
<text text-anchor="middle" x="26903.5" y="-8234.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu0 -->
<g id="node441" class="node">
<title>l2_attn_stage6_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24966" cy="-8006.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24966" y="-8018.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="24966" y="-8003.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24966" y="-7988.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu0&#45;&gt;l2_attn_stage6_gpu0 -->
<g id="edge641" class="edge">
<title>l2_attn_stage5_gpu0&#45;&gt;l2_attn_stage6_gpu0</title>
<path fill="none" stroke="black" d="M24966,-8116.24C24966,-8097.52 24966,-8074.53 24966,-8054.55"/>
<polygon fill="black" stroke="black" points="24969.5,-8054.41 24966,-8044.41 24962.5,-8054.41 24969.5,-8054.41"/>
</g>
<!-- l2_attn_stage6_gpu[next_gpu] -->
<g id="node1365" class="node">
<title>l2_attn_stage6_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="26983" cy="-8006.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="26983" y="-8003.13" font-family="Times,serif" font-size="14.00">l2_attn_stage6_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage5_gpu0&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge2529" class="edge">
<title>l2_attn_stage5_gpu0&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25019.28,-8123.78C25033.41,-8117.44 25048.94,-8111.64 25064,-8108.33 25103.2,-8099.71 26471.13,-8111.63 26509,-8098.33 26519.15,-8094.77 26517.89,-8087 26528,-8083.33 26558.62,-8072.23 26789.15,-8082.15 26821,-8075.33 26864.66,-8065.98 26911.41,-8045.22 26943.42,-8029.17"/>
<polygon fill="red" stroke="red" points="26945.12,-8032.23 26952.45,-8024.57 26941.95,-8025.99 26945.12,-8032.23"/>
<text text-anchor="middle" x="26559.5" y="-8087.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu1 -->
<g id="node442" class="node">
<title>l2_attn_stage6_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24576" cy="-8006.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24576" y="-8018.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="24576" y="-8003.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24576" y="-7988.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu1&#45;&gt;l2_attn_stage6_gpu1 -->
<g id="edge642" class="edge">
<title>l2_attn_stage5_gpu1&#45;&gt;l2_attn_stage6_gpu1</title>
<path fill="none" stroke="black" d="M24576,-8116.24C24576,-8097.52 24576,-8074.53 24576,-8054.55"/>
<polygon fill="black" stroke="black" points="24579.5,-8054.41 24576,-8044.41 24572.5,-8054.41 24579.5,-8054.41"/>
</g>
<!-- l2_attn_stage5_gpu1&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge2530" class="edge">
<title>l2_attn_stage5_gpu1&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24629.28,-8123.77C24643.41,-8117.43 24658.94,-8111.64 24674,-8108.33 24719.12,-8098.43 26293.41,-8113.61 26337,-8098.33 26347.15,-8094.77 26345.87,-8086.95 26356,-8083.33 26404.67,-8065.97 26770.42,-8085.9 26821,-8075.33 26864.84,-8066.17 26911.74,-8045.28 26943.74,-8029.14"/>
<polygon fill="red" stroke="red" points="26945.46,-8032.2 26952.76,-8024.52 26942.27,-8025.97 26945.46,-8032.2"/>
<text text-anchor="middle" x="26387.5" y="-8087.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu2 -->
<g id="node443" class="node">
<title>l2_attn_stage6_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25941" cy="-8006.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25941" y="-8018.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="25941" y="-8003.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25941" y="-7988.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu2&#45;&gt;l2_attn_stage6_gpu2 -->
<g id="edge643" class="edge">
<title>l2_attn_stage5_gpu2&#45;&gt;l2_attn_stage6_gpu2</title>
<path fill="none" stroke="black" d="M25941,-8116.24C25941,-8097.52 25941,-8074.53 25941,-8054.55"/>
<polygon fill="black" stroke="black" points="25944.5,-8054.41 25941,-8044.41 25937.5,-8054.41 25944.5,-8054.41"/>
</g>
<!-- l2_attn_stage5_gpu2&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge2531" class="edge">
<title>l2_attn_stage5_gpu2&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25994.29,-8123.83C26008.42,-8117.49 26023.95,-8111.68 26039,-8108.33 26063.41,-8102.91 26917.88,-8111.71 26939,-8098.33 26960.94,-8084.43 26972.24,-8056.15 26977.85,-8034.89"/>
<polygon fill="red" stroke="red" points="26981.27,-8035.64 26980.18,-8025.1 26974.46,-8034.02 26981.27,-8035.64"/>
<text text-anchor="middle" x="26985.5" y="-8087.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu3 -->
<g id="node444" class="node">
<title>l2_attn_stage6_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26331" cy="-8006.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26331" y="-8018.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="26331" y="-8003.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26331" y="-7988.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu3&#45;&gt;l2_attn_stage6_gpu3 -->
<g id="edge644" class="edge">
<title>l2_attn_stage5_gpu3&#45;&gt;l2_attn_stage6_gpu3</title>
<path fill="none" stroke="black" d="M26277.7,-8123.89C26263.85,-8117.63 26248.69,-8111.85 26234,-8108.33 26220.37,-8105.07 25991.71,-8108.43 25982,-8098.33 25977.38,-8093.53 25977.36,-8088.12 25982,-8083.33 25991.75,-8073.27 26220.7,-8079.74 26234,-8075.33 26252.4,-8069.24 26270.44,-8058.44 26285.87,-8047.25"/>
<polygon fill="black" stroke="black" points="26288.27,-8049.83 26294.16,-8041.02 26284.06,-8044.23 26288.27,-8049.83"/>
</g>
<!-- l2_attn_stage5_gpu3&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge2532" class="edge">
<title>l2_attn_stage5_gpu3&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26384.3,-8123.86C26398.43,-8117.52 26413.96,-8111.7 26429,-8108.33 26447.49,-8104.19 27097.7,-8111.83 27111,-8098.33 27139.36,-8069.56 27091.79,-8043.72 27046.82,-8027.1"/>
<polygon fill="red" stroke="red" points="27047.88,-8023.76 27037.29,-8023.69 27045.53,-8030.35 27047.88,-8023.76"/>
<text text-anchor="middle" x="27150.5" y="-8087.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu4 -->
<g id="node445" class="node">
<title>l2_attn_stage6_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25161" cy="-8006.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25161" y="-8018.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="25161" y="-8003.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25161" y="-7988.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu4&#45;&gt;l2_attn_stage6_gpu4 -->
<g id="edge645" class="edge">
<title>l2_attn_stage5_gpu4&#45;&gt;l2_attn_stage6_gpu4</title>
<path fill="none" stroke="black" d="M25161,-8116.24C25161,-8097.52 25161,-8074.53 25161,-8054.55"/>
<polygon fill="black" stroke="black" points="25164.5,-8054.41 25161,-8044.41 25157.5,-8054.41 25164.5,-8054.41"/>
</g>
<!-- l2_attn_stage5_gpu4&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge2533" class="edge">
<title>l2_attn_stage5_gpu4&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25214.28,-8123.79C25228.42,-8117.45 25243.95,-8111.65 25259,-8108.33 25295.24,-8100.35 26559.99,-8110.63 26595,-8098.33 26605.15,-8094.77 26603.91,-8087.06 26614,-8083.33 26657.19,-8067.4 26776.04,-8085.23 26821,-8075.33 26864.6,-8065.73 26911.37,-8045.01 26943.39,-8029.04"/>
<polygon fill="red" stroke="red" points="26945.08,-8032.1 26952.42,-8024.46 26941.92,-8025.86 26945.08,-8032.1"/>
<text text-anchor="middle" x="26645.5" y="-8087.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu5 -->
<g id="node446" class="node">
<title>l2_attn_stage6_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="26136" cy="-8006.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26136" y="-8018.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="26136" y="-8003.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="26136" y="-7988.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu5&#45;&gt;l2_attn_stage6_gpu5 -->
<g id="edge646" class="edge">
<title>l2_attn_stage5_gpu5&#45;&gt;l2_attn_stage6_gpu5</title>
<path fill="none" stroke="black" d="M26080.85,-8124.37C26067.43,-8118.33 26052.93,-8112.53 26039,-8108.33 26025.22,-8104.18 25984.36,-8109.27 25975,-8098.33 25940.08,-8057.53 25980.79,-8097.65 26039,-8075.33 26056.78,-8068.51 26074.42,-8057.77 26089.68,-8046.84"/>
<polygon fill="black" stroke="black" points="26091.93,-8049.53 26097.9,-8040.77 26087.77,-8043.89 26091.93,-8049.53"/>
</g>
<!-- l2_attn_stage5_gpu5&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge2534" class="edge">
<title>l2_attn_stage5_gpu5&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26189.29,-8123.84C26203.43,-8117.5 26218.95,-8111.69 26234,-8108.33 26255.45,-8103.55 27009.56,-8113.97 27025,-8098.33 27043.16,-8079.94 27025.89,-8052.25 27008.31,-8032.34"/>
<polygon fill="red" stroke="red" points="27010.75,-8029.82 27001.38,-8024.87 27005.61,-8034.58 27010.75,-8029.82"/>
<text text-anchor="middle" x="27063.5" y="-8087.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu6 -->
<g id="node447" class="node">
<title>l2_attn_stage6_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="23991" cy="-8006.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23991" y="-8018.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="23991" y="-8003.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="23991" y="-7988.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu6&#45;&gt;l2_attn_stage6_gpu6 -->
<g id="edge647" class="edge">
<title>l2_attn_stage5_gpu6&#45;&gt;l2_attn_stage6_gpu6</title>
<path fill="none" stroke="black" d="M23991,-8116.24C23991,-8097.52 23991,-8074.53 23991,-8054.55"/>
<polygon fill="black" stroke="black" points="23994.5,-8054.41 23991,-8044.41 23987.5,-8054.41 23994.5,-8054.41"/>
</g>
<!-- l2_attn_stage5_gpu6&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge2535" class="edge">
<title>l2_attn_stage5_gpu6&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24044.28,-8123.76C24058.41,-8117.42 24073.94,-8111.63 24089,-8108.33 24143,-8096.5 26026.82,-8116.59 26079,-8098.33 26089.15,-8094.78 26087.86,-8086.92 26098,-8083.33 26135.87,-8069.95 26781.66,-8083.43 26821,-8075.33 26864.87,-8066.31 26911.77,-8045.39 26943.76,-8029.22"/>
<polygon fill="red" stroke="red" points="26945.48,-8032.27 26952.78,-8024.58 26942.28,-8026.04 26945.48,-8032.27"/>
<text text-anchor="middle" x="26129.5" y="-8087.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu7 -->
<g id="node448" class="node">
<title>l2_attn_stage6_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="26721" cy="-8006.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26721" y="-8018.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="26721" y="-8003.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="26721" y="-7988.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu7&#45;&gt;l2_attn_stage6_gpu7 -->
<g id="edge648" class="edge">
<title>l2_attn_stage5_gpu7&#45;&gt;l2_attn_stage6_gpu7</title>
<path fill="none" stroke="black" d="M26668.02,-8123.76C26654.09,-8117.47 26638.82,-8111.69 26624,-8108.33 26606.99,-8104.47 26008.24,-8110.77 25996,-8098.33 25991.32,-8093.58 25991.32,-8088.08 25996,-8083.33 26008.26,-8070.92 26607.39,-8080.66 26624,-8075.33 26642.46,-8069.41 26660.51,-8058.66 26675.94,-8047.46"/>
<polygon fill="black" stroke="black" points="26678.34,-8050.03 26684.22,-8041.22 26674.13,-8044.44 26678.34,-8050.03"/>
</g>
<!-- l2_attn_stage5_gpu7&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge2536" class="edge">
<title>l2_attn_stage5_gpu7&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26776.38,-8124.52C26791.74,-8117.95 26808.68,-8111.86 26825,-8108.33 26849.87,-8102.95 27265.2,-8116.52 27283,-8098.33 27337.67,-8042.46 27236.45,-8020.8 27137.12,-8012.54"/>
<polygon fill="red" stroke="red" points="27137.15,-8009.03 27126.9,-8011.74 27136.6,-8016.01 27137.15,-8009.03"/>
<text text-anchor="middle" x="27323.5" y="-8087.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu8 -->
<g id="node449" class="node">
<title>l2_attn_stage6_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="23796" cy="-8006.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23796" y="-8018.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="23796" y="-8003.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="23796" y="-7988.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu8&#45;&gt;l2_attn_stage6_gpu8 -->
<g id="edge649" class="edge">
<title>l2_attn_stage5_gpu8&#45;&gt;l2_attn_stage6_gpu8</title>
<path fill="none" stroke="black" d="M23796,-8116.24C23796,-8097.52 23796,-8074.53 23796,-8054.55"/>
<polygon fill="black" stroke="black" points="23799.5,-8054.41 23796,-8044.41 23792.5,-8054.41 23799.5,-8054.41"/>
</g>
<!-- l2_attn_stage5_gpu8&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge2537" class="edge">
<title>l2_attn_stage5_gpu8&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23849.29,-8123.83C23863.43,-8117.49 23878.95,-8111.68 23894,-8108.33 24123.73,-8057.2 25776.66,-8085.88 26012,-8083.33 26056.94,-8082.84 26776.97,-8084.36 26821,-8075.33 26864.87,-8066.33 26911.77,-8045.41 26943.76,-8029.23"/>
<polygon fill="red" stroke="red" points="26945.49,-8032.28 26952.78,-8024.59 26942.28,-8026.05 26945.49,-8032.28"/>
<text text-anchor="middle" x="26043.5" y="-8087.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu9 -->
<g id="node450" class="node">
<title>l2_attn_stage6_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26526" cy="-8006.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26526" y="-8018.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="26526" y="-8003.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26526" y="-7988.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu9&#45;&gt;l2_attn_stage6_gpu9 -->
<g id="edge650" class="edge">
<title>l2_attn_stage5_gpu9&#45;&gt;l2_attn_stage6_gpu9</title>
<path fill="none" stroke="black" d="M26472.74,-8123.72C26458.89,-8117.46 26443.71,-8111.72 26429,-8108.33 26405.17,-8102.84 26006.09,-8115.82 25989,-8098.33 25984.34,-8093.56 25984.33,-8088.09 25989,-8083.33 25997.56,-8074.61 26417.37,-8079.1 26429,-8075.33 26447.45,-8069.36 26465.49,-8058.6 26480.92,-8047.4"/>
<polygon fill="black" stroke="black" points="26483.32,-8049.97 26489.2,-8041.16 26479.11,-8044.38 26483.32,-8049.97"/>
</g>
<!-- l2_attn_stage5_gpu9&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge2538" class="edge">
<title>l2_attn_stage5_gpu9&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26579.3,-8123.89C26593.44,-8117.55 26608.96,-8111.72 26624,-8108.33 26639.53,-8104.83 27185.84,-8109.69 27197,-8098.33 27237.03,-8057.59 27167.32,-8034.24 27097.01,-8021.49"/>
<polygon fill="red" stroke="red" points="27097.55,-8018.03 27087.1,-8019.76 27096.35,-8024.93 27097.55,-8018.03"/>
<text text-anchor="middle" x="27237.5" y="-8087.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu10 -->
<g id="node451" class="node">
<title>l2_attn_stage6_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="24186" cy="-8006.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24186" y="-8018.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="24186" y="-8003.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="24186" y="-7988.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu10&#45;&gt;l2_attn_stage6_gpu10 -->
<g id="edge651" class="edge">
<title>l2_attn_stage5_gpu10&#45;&gt;l2_attn_stage6_gpu10</title>
<path fill="none" stroke="black" d="M24186,-8116.24C24186,-8097.52 24186,-8074.53 24186,-8054.55"/>
<polygon fill="black" stroke="black" points="24189.5,-8054.41 24186,-8044.41 24182.5,-8054.41 24189.5,-8054.41"/>
</g>
<!-- l2_attn_stage5_gpu10&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge2539" class="edge">
<title>l2_attn_stage5_gpu10&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24239.28,-8123.77C24253.41,-8117.43 24268.94,-8111.63 24284,-8108.33 24335.04,-8097.14 26115.68,-8115.6 26165,-8098.33 26175.15,-8094.78 26173.86,-8086.92 26184,-8083.33 26217.36,-8071.52 26786.34,-8082.49 26821,-8075.33 26864.86,-8066.27 26911.76,-8045.36 26943.75,-8029.2"/>
<polygon fill="red" stroke="red" points="26945.48,-8032.25 26952.77,-8024.57 26942.28,-8026.02 26945.48,-8032.25"/>
<text text-anchor="middle" x="26215.5" y="-8087.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu11 -->
<g id="node452" class="node">
<title>l2_attn_stage6_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="25356" cy="-8006.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25356" y="-8018.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="25356" y="-8003.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="25356" y="-7988.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu11&#45;&gt;l2_attn_stage6_gpu11 -->
<g id="edge652" class="edge">
<title>l2_attn_stage5_gpu11&#45;&gt;l2_attn_stage6_gpu11</title>
<path fill="none" stroke="black" d="M25356,-8116.24C25356,-8097.52 25356,-8074.53 25356,-8054.55"/>
<polygon fill="black" stroke="black" points="25359.5,-8054.41 25356,-8044.41 25352.5,-8054.41 25359.5,-8054.41"/>
</g>
<!-- l2_attn_stage5_gpu11&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge2540" class="edge">
<title>l2_attn_stage5_gpu11&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25409.28,-8123.8C25423.42,-8117.46 25438.95,-8111.65 25454,-8108.33 25520.57,-8093.64 26616.69,-8120.95 26681,-8098.33 26691.15,-8094.76 26689.96,-8087.19 26700,-8083.33 26750.3,-8063.99 26768.53,-8087.64 26821,-8075.33 26864.2,-8065.2 26910.67,-8044.75 26942.71,-8029"/>
<polygon fill="red" stroke="red" points="26944.38,-8032.09 26951.77,-8024.49 26941.25,-8025.82 26944.38,-8032.09"/>
<text text-anchor="middle" x="26731.5" y="-8087.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu12 -->
<g id="node453" class="node">
<title>l2_attn_stage6_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="24381" cy="-8006.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24381" y="-8018.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="24381" y="-8003.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="24381" y="-7988.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu12&#45;&gt;l2_attn_stage6_gpu12 -->
<g id="edge653" class="edge">
<title>l2_attn_stage5_gpu12&#45;&gt;l2_attn_stage6_gpu12</title>
<path fill="none" stroke="black" d="M24381,-8116.24C24381,-8097.52 24381,-8074.53 24381,-8054.55"/>
<polygon fill="black" stroke="black" points="24384.5,-8054.41 24381,-8044.41 24377.5,-8054.41 24384.5,-8054.41"/>
</g>
<!-- l2_attn_stage5_gpu12&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge2541" class="edge">
<title>l2_attn_stage5_gpu12&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24434.28,-8123.77C24448.41,-8117.43 24463.94,-8111.64 24479,-8108.33 24527.08,-8097.79 26204.55,-8114.61 26251,-8098.33 26261.15,-8094.78 26259.86,-8086.93 26270,-8083.33 26298.85,-8073.08 26791.02,-8081.55 26821,-8075.33 26864.85,-8066.23 26911.75,-8045.33 26943.75,-8029.18"/>
<polygon fill="red" stroke="red" points="26945.47,-8032.23 26952.77,-8024.55 26942.27,-8026 26945.47,-8032.23"/>
<text text-anchor="middle" x="26301.5" y="-8087.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu13 -->
<g id="node454" class="node">
<title>l2_attn_stage6_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="25551" cy="-8006.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25551" y="-8018.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="25551" y="-8003.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="25551" y="-7988.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu13&#45;&gt;l2_attn_stage6_gpu13 -->
<g id="edge654" class="edge">
<title>l2_attn_stage5_gpu13&#45;&gt;l2_attn_stage6_gpu13</title>
<path fill="none" stroke="black" d="M25551,-8116.24C25551,-8097.52 25551,-8074.53 25551,-8054.55"/>
<polygon fill="black" stroke="black" points="25554.5,-8054.41 25551,-8044.41 25547.5,-8054.41 25554.5,-8054.41"/>
</g>
<!-- l2_attn_stage5_gpu13&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge2542" class="edge">
<title>l2_attn_stage5_gpu13&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25604.28,-8123.8C25618.42,-8117.46 25633.95,-8111.66 25649,-8108.33 25709.65,-8094.92 26708.41,-8118.97 26767,-8098.33 26777.15,-8094.76 26776.3,-8087.98 26786,-8083.33 26800.39,-8076.44 26805.8,-8080.2 26821,-8075.33 26861.94,-8062.23 26906.95,-8043.07 26939.12,-8028.51"/>
<polygon fill="red" stroke="red" points="26940.61,-8031.68 26948.25,-8024.34 26937.7,-8025.31 26940.61,-8031.68"/>
<text text-anchor="middle" x="26817.5" y="-8087.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu14 -->
<g id="node455" class="node">
<title>l2_attn_stage6_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="24771" cy="-8006.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24771" y="-8018.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="24771" y="-8003.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="24771" y="-7988.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu14&#45;&gt;l2_attn_stage6_gpu14 -->
<g id="edge655" class="edge">
<title>l2_attn_stage5_gpu14&#45;&gt;l2_attn_stage6_gpu14</title>
<path fill="none" stroke="black" d="M24771,-8116.24C24771,-8097.52 24771,-8074.53 24771,-8054.55"/>
<polygon fill="black" stroke="black" points="24774.5,-8054.41 24771,-8044.41 24767.5,-8054.41 24774.5,-8054.41"/>
</g>
<!-- l2_attn_stage5_gpu14&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge2543" class="edge">
<title>l2_attn_stage5_gpu14&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24824.28,-8123.78C24838.41,-8117.44 24853.94,-8111.64 24869,-8108.33 24911.16,-8099.07 26382.27,-8112.62 26423,-8098.33 26433.15,-8094.77 26431.87,-8086.97 26442,-8083.33 26481.64,-8069.1 26779.79,-8084.03 26821,-8075.33 26864.82,-8066.09 26911.73,-8045.2 26943.73,-8029.1"/>
<polygon fill="red" stroke="red" points="26945.45,-8032.15 26952.75,-8024.48 26942.26,-8025.92 26945.45,-8032.15"/>
<text text-anchor="middle" x="26473.5" y="-8087.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu15 -->
<g id="node456" class="node">
<title>l2_attn_stage6_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="25746" cy="-8006.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25746" y="-8018.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="25746" y="-8003.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="25746" y="-7988.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu15&#45;&gt;l2_attn_stage6_gpu15 -->
<g id="edge656" class="edge">
<title>l2_attn_stage5_gpu15&#45;&gt;l2_attn_stage6_gpu15</title>
<path fill="none" stroke="black" d="M25746,-8116.24C25746,-8097.52 25746,-8074.53 25746,-8054.55"/>
<polygon fill="black" stroke="black" points="25749.5,-8054.41 25746,-8044.41 25742.5,-8054.41 25749.5,-8054.41"/>
</g>
<!-- l2_attn_stage5_gpu15&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge2544" class="edge">
<title>l2_attn_stage5_gpu15&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25799.29,-8123.81C25813.42,-8117.47 25828.95,-8111.67 25844,-8108.33 25898.73,-8096.2 26800.13,-8116.98 26853,-8098.33 26863.15,-8094.75 26863.32,-8089.69 26872,-8083.33 26897.22,-8064.84 26926.5,-8044.99 26948.65,-8030.28"/>
<polygon fill="red" stroke="red" points="26950.66,-8033.15 26957.07,-8024.72 26946.8,-8027.31 26950.66,-8033.15"/>
<text text-anchor="middle" x="26903.5" y="-8087.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu0 -->
<g id="node457" class="node">
<title>l2_attn_stage7_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24966" cy="-7859.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24966" y="-7871.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="24966" y="-7856.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24966" y="-7841.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu0&#45;&gt;l2_attn_stage7_gpu0 -->
<g id="edge657" class="edge">
<title>l2_attn_stage6_gpu0&#45;&gt;l2_attn_stage7_gpu0</title>
<path fill="none" stroke="black" d="M24966,-7969.24C24966,-7950.52 24966,-7927.53 24966,-7907.55"/>
<polygon fill="black" stroke="black" points="24969.5,-7907.41 24966,-7897.41 24962.5,-7907.41 24969.5,-7907.41"/>
</g>
<!-- l2_attn_stage7_gpu[next_gpu] -->
<g id="node1366" class="node">
<title>l2_attn_stage7_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="26983" cy="-7859.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="26983" y="-7856.13" font-family="Times,serif" font-size="14.00">l2_attn_stage7_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage6_gpu0&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge2545" class="edge">
<title>l2_attn_stage6_gpu0&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25019.28,-7976.78C25033.41,-7970.44 25048.94,-7964.64 25064,-7961.33 25103.2,-7952.71 26471.13,-7964.63 26509,-7951.33 26519.15,-7947.77 26517.89,-7940 26528,-7936.33 26558.62,-7925.23 26789.15,-7935.15 26821,-7928.33 26864.66,-7918.98 26911.41,-7898.22 26943.42,-7882.17"/>
<polygon fill="red" stroke="red" points="26945.12,-7885.23 26952.45,-7877.57 26941.95,-7878.99 26945.12,-7885.23"/>
<text text-anchor="middle" x="26559.5" y="-7940.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu1 -->
<g id="node458" class="node">
<title>l2_attn_stage7_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24576" cy="-7859.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24576" y="-7871.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="24576" y="-7856.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24576" y="-7841.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu1&#45;&gt;l2_attn_stage7_gpu1 -->
<g id="edge658" class="edge">
<title>l2_attn_stage6_gpu1&#45;&gt;l2_attn_stage7_gpu1</title>
<path fill="none" stroke="black" d="M24576,-7969.24C24576,-7950.52 24576,-7927.53 24576,-7907.55"/>
<polygon fill="black" stroke="black" points="24579.5,-7907.41 24576,-7897.41 24572.5,-7907.41 24579.5,-7907.41"/>
</g>
<!-- l2_attn_stage6_gpu1&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge2546" class="edge">
<title>l2_attn_stage6_gpu1&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24629.28,-7976.77C24643.41,-7970.43 24658.94,-7964.64 24674,-7961.33 24719.12,-7951.43 26293.41,-7966.61 26337,-7951.33 26347.15,-7947.77 26345.87,-7939.95 26356,-7936.33 26404.67,-7918.97 26770.42,-7938.9 26821,-7928.33 26864.84,-7919.17 26911.74,-7898.28 26943.74,-7882.14"/>
<polygon fill="red" stroke="red" points="26945.46,-7885.2 26952.76,-7877.52 26942.27,-7878.97 26945.46,-7885.2"/>
<text text-anchor="middle" x="26387.5" y="-7940.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu2 -->
<g id="node459" class="node">
<title>l2_attn_stage7_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25941" cy="-7859.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25941" y="-7871.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="25941" y="-7856.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25941" y="-7841.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu2&#45;&gt;l2_attn_stage7_gpu2 -->
<g id="edge659" class="edge">
<title>l2_attn_stage6_gpu2&#45;&gt;l2_attn_stage7_gpu2</title>
<path fill="none" stroke="black" d="M25941,-7969.24C25941,-7950.52 25941,-7927.53 25941,-7907.55"/>
<polygon fill="black" stroke="black" points="25944.5,-7907.41 25941,-7897.41 25937.5,-7907.41 25944.5,-7907.41"/>
</g>
<!-- l2_attn_stage6_gpu2&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge2547" class="edge">
<title>l2_attn_stage6_gpu2&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25994.29,-7976.83C26008.42,-7970.49 26023.95,-7964.68 26039,-7961.33 26063.41,-7955.91 26917.88,-7964.71 26939,-7951.33 26960.94,-7937.43 26972.24,-7909.15 26977.85,-7887.89"/>
<polygon fill="red" stroke="red" points="26981.27,-7888.64 26980.18,-7878.1 26974.46,-7887.02 26981.27,-7888.64"/>
<text text-anchor="middle" x="26985.5" y="-7940.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu3 -->
<g id="node460" class="node">
<title>l2_attn_stage7_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26331" cy="-7859.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26331" y="-7871.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="26331" y="-7856.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26331" y="-7841.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu3&#45;&gt;l2_attn_stage7_gpu3 -->
<g id="edge660" class="edge">
<title>l2_attn_stage6_gpu3&#45;&gt;l2_attn_stage7_gpu3</title>
<path fill="none" stroke="black" d="M26277.7,-7976.89C26263.85,-7970.63 26248.69,-7964.85 26234,-7961.33 26220.37,-7958.07 25991.71,-7961.43 25982,-7951.33 25977.38,-7946.53 25977.36,-7941.12 25982,-7936.33 25991.75,-7926.27 26220.7,-7932.74 26234,-7928.33 26252.4,-7922.24 26270.44,-7911.44 26285.87,-7900.25"/>
<polygon fill="black" stroke="black" points="26288.27,-7902.83 26294.16,-7894.02 26284.06,-7897.23 26288.27,-7902.83"/>
</g>
<!-- l2_attn_stage6_gpu3&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge2548" class="edge">
<title>l2_attn_stage6_gpu3&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26384.3,-7976.86C26398.43,-7970.52 26413.96,-7964.7 26429,-7961.33 26447.49,-7957.19 27097.7,-7964.83 27111,-7951.33 27139.36,-7922.56 27091.79,-7896.72 27046.82,-7880.1"/>
<polygon fill="red" stroke="red" points="27047.88,-7876.76 27037.29,-7876.69 27045.53,-7883.35 27047.88,-7876.76"/>
<text text-anchor="middle" x="27150.5" y="-7940.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu4 -->
<g id="node461" class="node">
<title>l2_attn_stage7_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25161" cy="-7859.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25161" y="-7871.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="25161" y="-7856.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25161" y="-7841.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu4&#45;&gt;l2_attn_stage7_gpu4 -->
<g id="edge661" class="edge">
<title>l2_attn_stage6_gpu4&#45;&gt;l2_attn_stage7_gpu4</title>
<path fill="none" stroke="black" d="M25161,-7969.24C25161,-7950.52 25161,-7927.53 25161,-7907.55"/>
<polygon fill="black" stroke="black" points="25164.5,-7907.41 25161,-7897.41 25157.5,-7907.41 25164.5,-7907.41"/>
</g>
<!-- l2_attn_stage6_gpu4&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge2549" class="edge">
<title>l2_attn_stage6_gpu4&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25214.28,-7976.79C25228.42,-7970.45 25243.95,-7964.65 25259,-7961.33 25295.24,-7953.35 26559.99,-7963.63 26595,-7951.33 26605.15,-7947.77 26603.91,-7940.06 26614,-7936.33 26657.19,-7920.4 26776.04,-7938.23 26821,-7928.33 26864.6,-7918.73 26911.37,-7898.01 26943.39,-7882.04"/>
<polygon fill="red" stroke="red" points="26945.08,-7885.1 26952.42,-7877.46 26941.92,-7878.86 26945.08,-7885.1"/>
<text text-anchor="middle" x="26645.5" y="-7940.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu5 -->
<g id="node462" class="node">
<title>l2_attn_stage7_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="26136" cy="-7859.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26136" y="-7871.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="26136" y="-7856.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="26136" y="-7841.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu5&#45;&gt;l2_attn_stage7_gpu5 -->
<g id="edge662" class="edge">
<title>l2_attn_stage6_gpu5&#45;&gt;l2_attn_stage7_gpu5</title>
<path fill="none" stroke="black" d="M26080.85,-7977.37C26067.43,-7971.33 26052.93,-7965.53 26039,-7961.33 26025.22,-7957.18 25984.36,-7962.27 25975,-7951.33 25940.08,-7910.53 25980.79,-7950.65 26039,-7928.33 26056.78,-7921.51 26074.42,-7910.77 26089.68,-7899.84"/>
<polygon fill="black" stroke="black" points="26091.93,-7902.53 26097.9,-7893.77 26087.77,-7896.89 26091.93,-7902.53"/>
</g>
<!-- l2_attn_stage6_gpu5&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge2550" class="edge">
<title>l2_attn_stage6_gpu5&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26189.29,-7976.84C26203.43,-7970.5 26218.95,-7964.69 26234,-7961.33 26255.45,-7956.55 27009.56,-7966.97 27025,-7951.33 27043.16,-7932.94 27025.89,-7905.25 27008.31,-7885.34"/>
<polygon fill="red" stroke="red" points="27010.75,-7882.82 27001.38,-7877.87 27005.61,-7887.58 27010.75,-7882.82"/>
<text text-anchor="middle" x="27063.5" y="-7940.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu6 -->
<g id="node463" class="node">
<title>l2_attn_stage7_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="23991" cy="-7859.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23991" y="-7871.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="23991" y="-7856.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="23991" y="-7841.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu6&#45;&gt;l2_attn_stage7_gpu6 -->
<g id="edge663" class="edge">
<title>l2_attn_stage6_gpu6&#45;&gt;l2_attn_stage7_gpu6</title>
<path fill="none" stroke="black" d="M23991,-7969.24C23991,-7950.52 23991,-7927.53 23991,-7907.55"/>
<polygon fill="black" stroke="black" points="23994.5,-7907.41 23991,-7897.41 23987.5,-7907.41 23994.5,-7907.41"/>
</g>
<!-- l2_attn_stage6_gpu6&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge2551" class="edge">
<title>l2_attn_stage6_gpu6&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24044.28,-7976.76C24058.41,-7970.42 24073.94,-7964.63 24089,-7961.33 24143,-7949.5 26026.82,-7969.59 26079,-7951.33 26089.15,-7947.78 26087.86,-7939.92 26098,-7936.33 26135.87,-7922.95 26781.66,-7936.43 26821,-7928.33 26864.87,-7919.31 26911.77,-7898.39 26943.76,-7882.22"/>
<polygon fill="red" stroke="red" points="26945.48,-7885.27 26952.78,-7877.58 26942.28,-7879.04 26945.48,-7885.27"/>
<text text-anchor="middle" x="26129.5" y="-7940.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu7 -->
<g id="node464" class="node">
<title>l2_attn_stage7_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="26721" cy="-7859.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26721" y="-7871.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="26721" y="-7856.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="26721" y="-7841.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu7&#45;&gt;l2_attn_stage7_gpu7 -->
<g id="edge664" class="edge">
<title>l2_attn_stage6_gpu7&#45;&gt;l2_attn_stage7_gpu7</title>
<path fill="none" stroke="black" d="M26668.02,-7976.76C26654.09,-7970.47 26638.82,-7964.69 26624,-7961.33 26606.99,-7957.47 26008.24,-7963.77 25996,-7951.33 25991.32,-7946.58 25991.32,-7941.08 25996,-7936.33 26008.26,-7923.92 26607.39,-7933.66 26624,-7928.33 26642.46,-7922.41 26660.51,-7911.66 26675.94,-7900.46"/>
<polygon fill="black" stroke="black" points="26678.34,-7903.03 26684.22,-7894.22 26674.13,-7897.44 26678.34,-7903.03"/>
</g>
<!-- l2_attn_stage6_gpu7&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge2552" class="edge">
<title>l2_attn_stage6_gpu7&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26776.38,-7977.52C26791.74,-7970.95 26808.68,-7964.86 26825,-7961.33 26849.87,-7955.95 27265.2,-7969.52 27283,-7951.33 27337.67,-7895.46 27236.45,-7873.8 27137.12,-7865.54"/>
<polygon fill="red" stroke="red" points="27137.15,-7862.03 27126.9,-7864.74 27136.6,-7869.01 27137.15,-7862.03"/>
<text text-anchor="middle" x="27323.5" y="-7940.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu8 -->
<g id="node465" class="node">
<title>l2_attn_stage7_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="23796" cy="-7859.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23796" y="-7871.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="23796" y="-7856.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="23796" y="-7841.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu8&#45;&gt;l2_attn_stage7_gpu8 -->
<g id="edge665" class="edge">
<title>l2_attn_stage6_gpu8&#45;&gt;l2_attn_stage7_gpu8</title>
<path fill="none" stroke="black" d="M23796,-7969.24C23796,-7950.52 23796,-7927.53 23796,-7907.55"/>
<polygon fill="black" stroke="black" points="23799.5,-7907.41 23796,-7897.41 23792.5,-7907.41 23799.5,-7907.41"/>
</g>
<!-- l2_attn_stage6_gpu8&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge2553" class="edge">
<title>l2_attn_stage6_gpu8&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23849.29,-7976.83C23863.43,-7970.49 23878.95,-7964.68 23894,-7961.33 24123.73,-7910.2 25776.66,-7938.88 26012,-7936.33 26056.94,-7935.84 26776.97,-7937.36 26821,-7928.33 26864.87,-7919.33 26911.77,-7898.41 26943.76,-7882.23"/>
<polygon fill="red" stroke="red" points="26945.49,-7885.28 26952.78,-7877.59 26942.28,-7879.05 26945.49,-7885.28"/>
<text text-anchor="middle" x="26043.5" y="-7940.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu9 -->
<g id="node466" class="node">
<title>l2_attn_stage7_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26526" cy="-7859.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26526" y="-7871.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="26526" y="-7856.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26526" y="-7841.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu9&#45;&gt;l2_attn_stage7_gpu9 -->
<g id="edge666" class="edge">
<title>l2_attn_stage6_gpu9&#45;&gt;l2_attn_stage7_gpu9</title>
<path fill="none" stroke="black" d="M26472.74,-7976.72C26458.89,-7970.46 26443.71,-7964.72 26429,-7961.33 26405.17,-7955.84 26006.09,-7968.82 25989,-7951.33 25984.34,-7946.56 25984.33,-7941.09 25989,-7936.33 25997.56,-7927.61 26417.37,-7932.1 26429,-7928.33 26447.45,-7922.36 26465.49,-7911.6 26480.92,-7900.4"/>
<polygon fill="black" stroke="black" points="26483.32,-7902.97 26489.2,-7894.16 26479.11,-7897.38 26483.32,-7902.97"/>
</g>
<!-- l2_attn_stage6_gpu9&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge2554" class="edge">
<title>l2_attn_stage6_gpu9&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26579.3,-7976.89C26593.44,-7970.55 26608.96,-7964.72 26624,-7961.33 26639.53,-7957.83 27185.84,-7962.69 27197,-7951.33 27237.03,-7910.59 27167.32,-7887.24 27097.01,-7874.49"/>
<polygon fill="red" stroke="red" points="27097.55,-7871.03 27087.1,-7872.76 27096.35,-7877.93 27097.55,-7871.03"/>
<text text-anchor="middle" x="27237.5" y="-7940.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu10 -->
<g id="node467" class="node">
<title>l2_attn_stage7_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="24186" cy="-7859.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24186" y="-7871.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="24186" y="-7856.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="24186" y="-7841.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu10&#45;&gt;l2_attn_stage7_gpu10 -->
<g id="edge667" class="edge">
<title>l2_attn_stage6_gpu10&#45;&gt;l2_attn_stage7_gpu10</title>
<path fill="none" stroke="black" d="M24186,-7969.24C24186,-7950.52 24186,-7927.53 24186,-7907.55"/>
<polygon fill="black" stroke="black" points="24189.5,-7907.41 24186,-7897.41 24182.5,-7907.41 24189.5,-7907.41"/>
</g>
<!-- l2_attn_stage6_gpu10&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge2555" class="edge">
<title>l2_attn_stage6_gpu10&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24239.28,-7976.77C24253.41,-7970.43 24268.94,-7964.63 24284,-7961.33 24335.04,-7950.14 26115.68,-7968.6 26165,-7951.33 26175.15,-7947.78 26173.86,-7939.92 26184,-7936.33 26217.36,-7924.52 26786.34,-7935.49 26821,-7928.33 26864.86,-7919.27 26911.76,-7898.36 26943.75,-7882.2"/>
<polygon fill="red" stroke="red" points="26945.48,-7885.25 26952.77,-7877.57 26942.28,-7879.02 26945.48,-7885.25"/>
<text text-anchor="middle" x="26215.5" y="-7940.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu11 -->
<g id="node468" class="node">
<title>l2_attn_stage7_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="25356" cy="-7859.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25356" y="-7871.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="25356" y="-7856.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="25356" y="-7841.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu11&#45;&gt;l2_attn_stage7_gpu11 -->
<g id="edge668" class="edge">
<title>l2_attn_stage6_gpu11&#45;&gt;l2_attn_stage7_gpu11</title>
<path fill="none" stroke="black" d="M25356,-7969.24C25356,-7950.52 25356,-7927.53 25356,-7907.55"/>
<polygon fill="black" stroke="black" points="25359.5,-7907.41 25356,-7897.41 25352.5,-7907.41 25359.5,-7907.41"/>
</g>
<!-- l2_attn_stage6_gpu11&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge2556" class="edge">
<title>l2_attn_stage6_gpu11&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25409.28,-7976.8C25423.42,-7970.46 25438.95,-7964.65 25454,-7961.33 25520.57,-7946.64 26616.69,-7973.95 26681,-7951.33 26691.15,-7947.76 26689.96,-7940.19 26700,-7936.33 26750.3,-7916.99 26768.53,-7940.64 26821,-7928.33 26864.2,-7918.2 26910.67,-7897.75 26942.71,-7882"/>
<polygon fill="red" stroke="red" points="26944.38,-7885.09 26951.77,-7877.49 26941.25,-7878.82 26944.38,-7885.09"/>
<text text-anchor="middle" x="26731.5" y="-7940.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu12 -->
<g id="node469" class="node">
<title>l2_attn_stage7_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="24381" cy="-7859.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24381" y="-7871.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="24381" y="-7856.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="24381" y="-7841.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu12&#45;&gt;l2_attn_stage7_gpu12 -->
<g id="edge669" class="edge">
<title>l2_attn_stage6_gpu12&#45;&gt;l2_attn_stage7_gpu12</title>
<path fill="none" stroke="black" d="M24381,-7969.24C24381,-7950.52 24381,-7927.53 24381,-7907.55"/>
<polygon fill="black" stroke="black" points="24384.5,-7907.41 24381,-7897.41 24377.5,-7907.41 24384.5,-7907.41"/>
</g>
<!-- l2_attn_stage6_gpu12&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge2557" class="edge">
<title>l2_attn_stage6_gpu12&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24434.28,-7976.77C24448.41,-7970.43 24463.94,-7964.64 24479,-7961.33 24527.08,-7950.79 26204.55,-7967.61 26251,-7951.33 26261.15,-7947.78 26259.86,-7939.93 26270,-7936.33 26298.85,-7926.08 26791.02,-7934.55 26821,-7928.33 26864.85,-7919.23 26911.75,-7898.33 26943.75,-7882.18"/>
<polygon fill="red" stroke="red" points="26945.47,-7885.23 26952.77,-7877.55 26942.27,-7879 26945.47,-7885.23"/>
<text text-anchor="middle" x="26301.5" y="-7940.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu13 -->
<g id="node470" class="node">
<title>l2_attn_stage7_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="25551" cy="-7859.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25551" y="-7871.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="25551" y="-7856.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="25551" y="-7841.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu13&#45;&gt;l2_attn_stage7_gpu13 -->
<g id="edge670" class="edge">
<title>l2_attn_stage6_gpu13&#45;&gt;l2_attn_stage7_gpu13</title>
<path fill="none" stroke="black" d="M25551,-7969.24C25551,-7950.52 25551,-7927.53 25551,-7907.55"/>
<polygon fill="black" stroke="black" points="25554.5,-7907.41 25551,-7897.41 25547.5,-7907.41 25554.5,-7907.41"/>
</g>
<!-- l2_attn_stage6_gpu13&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge2558" class="edge">
<title>l2_attn_stage6_gpu13&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25604.28,-7976.8C25618.42,-7970.46 25633.95,-7964.66 25649,-7961.33 25709.65,-7947.92 26708.41,-7971.97 26767,-7951.33 26777.15,-7947.76 26776.3,-7940.98 26786,-7936.33 26800.39,-7929.44 26805.8,-7933.2 26821,-7928.33 26861.94,-7915.23 26906.95,-7896.07 26939.12,-7881.51"/>
<polygon fill="red" stroke="red" points="26940.61,-7884.68 26948.25,-7877.34 26937.7,-7878.31 26940.61,-7884.68"/>
<text text-anchor="middle" x="26817.5" y="-7940.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu14 -->
<g id="node471" class="node">
<title>l2_attn_stage7_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="24771" cy="-7859.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24771" y="-7871.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="24771" y="-7856.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="24771" y="-7841.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu14&#45;&gt;l2_attn_stage7_gpu14 -->
<g id="edge671" class="edge">
<title>l2_attn_stage6_gpu14&#45;&gt;l2_attn_stage7_gpu14</title>
<path fill="none" stroke="black" d="M24771,-7969.24C24771,-7950.52 24771,-7927.53 24771,-7907.55"/>
<polygon fill="black" stroke="black" points="24774.5,-7907.41 24771,-7897.41 24767.5,-7907.41 24774.5,-7907.41"/>
</g>
<!-- l2_attn_stage6_gpu14&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge2559" class="edge">
<title>l2_attn_stage6_gpu14&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24824.28,-7976.78C24838.41,-7970.44 24853.94,-7964.64 24869,-7961.33 24911.16,-7952.07 26382.27,-7965.62 26423,-7951.33 26433.15,-7947.77 26431.87,-7939.97 26442,-7936.33 26481.64,-7922.1 26779.79,-7937.03 26821,-7928.33 26864.82,-7919.09 26911.73,-7898.2 26943.73,-7882.1"/>
<polygon fill="red" stroke="red" points="26945.45,-7885.15 26952.75,-7877.48 26942.26,-7878.92 26945.45,-7885.15"/>
<text text-anchor="middle" x="26473.5" y="-7940.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu15 -->
<g id="node472" class="node">
<title>l2_attn_stage7_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="25746" cy="-7859.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25746" y="-7871.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="25746" y="-7856.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="25746" y="-7841.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu15&#45;&gt;l2_attn_stage7_gpu15 -->
<g id="edge672" class="edge">
<title>l2_attn_stage6_gpu15&#45;&gt;l2_attn_stage7_gpu15</title>
<path fill="none" stroke="black" d="M25746,-7969.24C25746,-7950.52 25746,-7927.53 25746,-7907.55"/>
<polygon fill="black" stroke="black" points="25749.5,-7907.41 25746,-7897.41 25742.5,-7907.41 25749.5,-7907.41"/>
</g>
<!-- l2_attn_stage6_gpu15&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge2560" class="edge">
<title>l2_attn_stage6_gpu15&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25799.29,-7976.81C25813.42,-7970.47 25828.95,-7964.67 25844,-7961.33 25898.73,-7949.2 26800.13,-7969.98 26853,-7951.33 26863.15,-7947.75 26863.32,-7942.69 26872,-7936.33 26897.22,-7917.84 26926.5,-7897.99 26948.65,-7883.28"/>
<polygon fill="red" stroke="red" points="26950.66,-7886.15 26957.07,-7877.72 26946.8,-7880.31 26950.66,-7886.15"/>
<text text-anchor="middle" x="26903.5" y="-7940.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu0 -->
<g id="node473" class="node">
<title>l2_attn_stage8_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24966" cy="-7712.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24966" y="-7724.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="24966" y="-7709.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24966" y="-7694.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu0&#45;&gt;l2_attn_stage8_gpu0 -->
<g id="edge673" class="edge">
<title>l2_attn_stage7_gpu0&#45;&gt;l2_attn_stage8_gpu0</title>
<path fill="none" stroke="black" d="M24966,-7822.24C24966,-7803.52 24966,-7780.53 24966,-7760.55"/>
<polygon fill="black" stroke="black" points="24969.5,-7760.41 24966,-7750.41 24962.5,-7760.41 24969.5,-7760.41"/>
</g>
<!-- l2_attn_stage8_gpu[next_gpu] -->
<g id="node1367" class="node">
<title>l2_attn_stage8_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="26983" cy="-7712.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="26983" y="-7709.13" font-family="Times,serif" font-size="14.00">l2_attn_stage8_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage7_gpu0&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge2561" class="edge">
<title>l2_attn_stage7_gpu0&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25019.28,-7829.78C25033.41,-7823.44 25048.94,-7817.64 25064,-7814.33 25103.2,-7805.71 26471.13,-7817.63 26509,-7804.33 26519.15,-7800.77 26517.89,-7793 26528,-7789.33 26558.62,-7778.23 26789.15,-7788.15 26821,-7781.33 26864.66,-7771.98 26911.41,-7751.22 26943.42,-7735.17"/>
<polygon fill="red" stroke="red" points="26945.12,-7738.23 26952.45,-7730.57 26941.95,-7731.99 26945.12,-7738.23"/>
<text text-anchor="middle" x="26559.5" y="-7793.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu1 -->
<g id="node474" class="node">
<title>l2_attn_stage8_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24576" cy="-7712.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24576" y="-7724.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="24576" y="-7709.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24576" y="-7694.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu1&#45;&gt;l2_attn_stage8_gpu1 -->
<g id="edge674" class="edge">
<title>l2_attn_stage7_gpu1&#45;&gt;l2_attn_stage8_gpu1</title>
<path fill="none" stroke="black" d="M24576,-7822.24C24576,-7803.52 24576,-7780.53 24576,-7760.55"/>
<polygon fill="black" stroke="black" points="24579.5,-7760.41 24576,-7750.41 24572.5,-7760.41 24579.5,-7760.41"/>
</g>
<!-- l2_attn_stage7_gpu1&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge2562" class="edge">
<title>l2_attn_stage7_gpu1&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24629.28,-7829.77C24643.41,-7823.43 24658.94,-7817.64 24674,-7814.33 24719.12,-7804.43 26293.41,-7819.61 26337,-7804.33 26347.15,-7800.77 26345.87,-7792.95 26356,-7789.33 26404.67,-7771.97 26770.42,-7791.9 26821,-7781.33 26864.84,-7772.17 26911.74,-7751.28 26943.74,-7735.14"/>
<polygon fill="red" stroke="red" points="26945.46,-7738.2 26952.76,-7730.52 26942.27,-7731.97 26945.46,-7738.2"/>
<text text-anchor="middle" x="26387.5" y="-7793.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu2 -->
<g id="node475" class="node">
<title>l2_attn_stage8_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25941" cy="-7712.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25941" y="-7724.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="25941" y="-7709.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25941" y="-7694.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu2&#45;&gt;l2_attn_stage8_gpu2 -->
<g id="edge675" class="edge">
<title>l2_attn_stage7_gpu2&#45;&gt;l2_attn_stage8_gpu2</title>
<path fill="none" stroke="black" d="M25941,-7822.24C25941,-7803.52 25941,-7780.53 25941,-7760.55"/>
<polygon fill="black" stroke="black" points="25944.5,-7760.41 25941,-7750.41 25937.5,-7760.41 25944.5,-7760.41"/>
</g>
<!-- l2_attn_stage7_gpu2&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge2563" class="edge">
<title>l2_attn_stage7_gpu2&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25994.29,-7829.83C26008.42,-7823.49 26023.95,-7817.68 26039,-7814.33 26063.41,-7808.91 26917.88,-7817.71 26939,-7804.33 26960.94,-7790.43 26972.24,-7762.15 26977.85,-7740.89"/>
<polygon fill="red" stroke="red" points="26981.27,-7741.64 26980.18,-7731.1 26974.46,-7740.02 26981.27,-7741.64"/>
<text text-anchor="middle" x="26985.5" y="-7793.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu3 -->
<g id="node476" class="node">
<title>l2_attn_stage8_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26331" cy="-7712.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26331" y="-7724.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="26331" y="-7709.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26331" y="-7694.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu3&#45;&gt;l2_attn_stage8_gpu3 -->
<g id="edge676" class="edge">
<title>l2_attn_stage7_gpu3&#45;&gt;l2_attn_stage8_gpu3</title>
<path fill="none" stroke="black" d="M26277.7,-7829.89C26263.85,-7823.63 26248.69,-7817.85 26234,-7814.33 26220.37,-7811.07 25991.71,-7814.43 25982,-7804.33 25977.38,-7799.53 25977.36,-7794.12 25982,-7789.33 25991.75,-7779.27 26220.7,-7785.74 26234,-7781.33 26252.4,-7775.24 26270.44,-7764.44 26285.87,-7753.25"/>
<polygon fill="black" stroke="black" points="26288.27,-7755.83 26294.16,-7747.02 26284.06,-7750.23 26288.27,-7755.83"/>
</g>
<!-- l2_attn_stage7_gpu3&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge2564" class="edge">
<title>l2_attn_stage7_gpu3&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26384.3,-7829.86C26398.43,-7823.52 26413.96,-7817.7 26429,-7814.33 26447.49,-7810.19 27097.7,-7817.83 27111,-7804.33 27139.36,-7775.56 27091.79,-7749.72 27046.82,-7733.1"/>
<polygon fill="red" stroke="red" points="27047.88,-7729.76 27037.29,-7729.69 27045.53,-7736.35 27047.88,-7729.76"/>
<text text-anchor="middle" x="27150.5" y="-7793.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu4 -->
<g id="node477" class="node">
<title>l2_attn_stage8_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25161" cy="-7712.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25161" y="-7724.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="25161" y="-7709.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25161" y="-7694.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu4&#45;&gt;l2_attn_stage8_gpu4 -->
<g id="edge677" class="edge">
<title>l2_attn_stage7_gpu4&#45;&gt;l2_attn_stage8_gpu4</title>
<path fill="none" stroke="black" d="M25161,-7822.24C25161,-7803.52 25161,-7780.53 25161,-7760.55"/>
<polygon fill="black" stroke="black" points="25164.5,-7760.41 25161,-7750.41 25157.5,-7760.41 25164.5,-7760.41"/>
</g>
<!-- l2_attn_stage7_gpu4&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge2565" class="edge">
<title>l2_attn_stage7_gpu4&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25214.28,-7829.79C25228.42,-7823.45 25243.95,-7817.65 25259,-7814.33 25295.24,-7806.35 26559.99,-7816.63 26595,-7804.33 26605.15,-7800.77 26603.91,-7793.06 26614,-7789.33 26657.19,-7773.4 26776.04,-7791.23 26821,-7781.33 26864.6,-7771.73 26911.37,-7751.01 26943.39,-7735.04"/>
<polygon fill="red" stroke="red" points="26945.08,-7738.1 26952.42,-7730.46 26941.92,-7731.86 26945.08,-7738.1"/>
<text text-anchor="middle" x="26645.5" y="-7793.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu5 -->
<g id="node478" class="node">
<title>l2_attn_stage8_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="26136" cy="-7712.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26136" y="-7724.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="26136" y="-7709.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="26136" y="-7694.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu5&#45;&gt;l2_attn_stage8_gpu5 -->
<g id="edge678" class="edge">
<title>l2_attn_stage7_gpu5&#45;&gt;l2_attn_stage8_gpu5</title>
<path fill="none" stroke="black" d="M26080.85,-7830.37C26067.43,-7824.33 26052.93,-7818.53 26039,-7814.33 26025.22,-7810.18 25984.36,-7815.27 25975,-7804.33 25940.08,-7763.53 25980.79,-7803.65 26039,-7781.33 26056.78,-7774.51 26074.42,-7763.77 26089.68,-7752.84"/>
<polygon fill="black" stroke="black" points="26091.93,-7755.53 26097.9,-7746.77 26087.77,-7749.89 26091.93,-7755.53"/>
</g>
<!-- l2_attn_stage7_gpu5&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge2566" class="edge">
<title>l2_attn_stage7_gpu5&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26189.29,-7829.84C26203.43,-7823.5 26218.95,-7817.69 26234,-7814.33 26255.45,-7809.55 27009.56,-7819.97 27025,-7804.33 27043.16,-7785.94 27025.89,-7758.25 27008.31,-7738.34"/>
<polygon fill="red" stroke="red" points="27010.75,-7735.82 27001.38,-7730.87 27005.61,-7740.58 27010.75,-7735.82"/>
<text text-anchor="middle" x="27063.5" y="-7793.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu6 -->
<g id="node479" class="node">
<title>l2_attn_stage8_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="23991" cy="-7712.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23991" y="-7724.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="23991" y="-7709.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="23991" y="-7694.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu6&#45;&gt;l2_attn_stage8_gpu6 -->
<g id="edge679" class="edge">
<title>l2_attn_stage7_gpu6&#45;&gt;l2_attn_stage8_gpu6</title>
<path fill="none" stroke="black" d="M23991,-7822.24C23991,-7803.52 23991,-7780.53 23991,-7760.55"/>
<polygon fill="black" stroke="black" points="23994.5,-7760.41 23991,-7750.41 23987.5,-7760.41 23994.5,-7760.41"/>
</g>
<!-- l2_attn_stage7_gpu6&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge2567" class="edge">
<title>l2_attn_stage7_gpu6&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24044.28,-7829.76C24058.41,-7823.42 24073.94,-7817.63 24089,-7814.33 24143,-7802.5 26026.82,-7822.59 26079,-7804.33 26089.15,-7800.78 26087.86,-7792.92 26098,-7789.33 26135.87,-7775.95 26781.66,-7789.43 26821,-7781.33 26864.87,-7772.31 26911.77,-7751.39 26943.76,-7735.22"/>
<polygon fill="red" stroke="red" points="26945.48,-7738.27 26952.78,-7730.58 26942.28,-7732.04 26945.48,-7738.27"/>
<text text-anchor="middle" x="26129.5" y="-7793.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu7 -->
<g id="node480" class="node">
<title>l2_attn_stage8_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="26721" cy="-7712.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26721" y="-7724.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="26721" y="-7709.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="26721" y="-7694.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu7&#45;&gt;l2_attn_stage8_gpu7 -->
<g id="edge680" class="edge">
<title>l2_attn_stage7_gpu7&#45;&gt;l2_attn_stage8_gpu7</title>
<path fill="none" stroke="black" d="M26668.02,-7829.76C26654.09,-7823.47 26638.82,-7817.69 26624,-7814.33 26606.99,-7810.47 26008.24,-7816.77 25996,-7804.33 25991.32,-7799.58 25991.32,-7794.08 25996,-7789.33 26008.26,-7776.92 26607.39,-7786.66 26624,-7781.33 26642.46,-7775.41 26660.51,-7764.66 26675.94,-7753.46"/>
<polygon fill="black" stroke="black" points="26678.34,-7756.03 26684.22,-7747.22 26674.13,-7750.44 26678.34,-7756.03"/>
</g>
<!-- l2_attn_stage7_gpu7&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge2568" class="edge">
<title>l2_attn_stage7_gpu7&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26776.38,-7830.52C26791.74,-7823.95 26808.68,-7817.86 26825,-7814.33 26849.87,-7808.95 27265.2,-7822.52 27283,-7804.33 27337.67,-7748.46 27236.45,-7726.8 27137.12,-7718.54"/>
<polygon fill="red" stroke="red" points="27137.15,-7715.03 27126.9,-7717.74 27136.6,-7722.01 27137.15,-7715.03"/>
<text text-anchor="middle" x="27323.5" y="-7793.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu8 -->
<g id="node481" class="node">
<title>l2_attn_stage8_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="23796" cy="-7712.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23796" y="-7724.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="23796" y="-7709.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="23796" y="-7694.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu8&#45;&gt;l2_attn_stage8_gpu8 -->
<g id="edge681" class="edge">
<title>l2_attn_stage7_gpu8&#45;&gt;l2_attn_stage8_gpu8</title>
<path fill="none" stroke="black" d="M23796,-7822.24C23796,-7803.52 23796,-7780.53 23796,-7760.55"/>
<polygon fill="black" stroke="black" points="23799.5,-7760.41 23796,-7750.41 23792.5,-7760.41 23799.5,-7760.41"/>
</g>
<!-- l2_attn_stage7_gpu8&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge2569" class="edge">
<title>l2_attn_stage7_gpu8&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23849.29,-7829.83C23863.43,-7823.49 23878.95,-7817.68 23894,-7814.33 24123.73,-7763.2 25776.66,-7791.88 26012,-7789.33 26056.94,-7788.84 26776.97,-7790.36 26821,-7781.33 26864.87,-7772.33 26911.77,-7751.41 26943.76,-7735.23"/>
<polygon fill="red" stroke="red" points="26945.49,-7738.28 26952.78,-7730.59 26942.28,-7732.05 26945.49,-7738.28"/>
<text text-anchor="middle" x="26043.5" y="-7793.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu9 -->
<g id="node482" class="node">
<title>l2_attn_stage8_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26526" cy="-7712.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26526" y="-7724.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="26526" y="-7709.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26526" y="-7694.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu9&#45;&gt;l2_attn_stage8_gpu9 -->
<g id="edge682" class="edge">
<title>l2_attn_stage7_gpu9&#45;&gt;l2_attn_stage8_gpu9</title>
<path fill="none" stroke="black" d="M26472.74,-7829.72C26458.89,-7823.46 26443.71,-7817.72 26429,-7814.33 26405.17,-7808.84 26006.09,-7821.82 25989,-7804.33 25984.34,-7799.56 25984.33,-7794.09 25989,-7789.33 25997.56,-7780.61 26417.37,-7785.1 26429,-7781.33 26447.45,-7775.36 26465.49,-7764.6 26480.92,-7753.4"/>
<polygon fill="black" stroke="black" points="26483.32,-7755.97 26489.2,-7747.16 26479.11,-7750.38 26483.32,-7755.97"/>
</g>
<!-- l2_attn_stage7_gpu9&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge2570" class="edge">
<title>l2_attn_stage7_gpu9&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26579.3,-7829.89C26593.44,-7823.55 26608.96,-7817.72 26624,-7814.33 26639.53,-7810.83 27185.84,-7815.69 27197,-7804.33 27237.03,-7763.59 27167.32,-7740.24 27097.01,-7727.49"/>
<polygon fill="red" stroke="red" points="27097.55,-7724.03 27087.1,-7725.76 27096.35,-7730.93 27097.55,-7724.03"/>
<text text-anchor="middle" x="27237.5" y="-7793.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu10 -->
<g id="node483" class="node">
<title>l2_attn_stage8_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="24186" cy="-7712.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24186" y="-7724.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="24186" y="-7709.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="24186" y="-7694.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu10&#45;&gt;l2_attn_stage8_gpu10 -->
<g id="edge683" class="edge">
<title>l2_attn_stage7_gpu10&#45;&gt;l2_attn_stage8_gpu10</title>
<path fill="none" stroke="black" d="M24186,-7822.24C24186,-7803.52 24186,-7780.53 24186,-7760.55"/>
<polygon fill="black" stroke="black" points="24189.5,-7760.41 24186,-7750.41 24182.5,-7760.41 24189.5,-7760.41"/>
</g>
<!-- l2_attn_stage7_gpu10&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge2571" class="edge">
<title>l2_attn_stage7_gpu10&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24239.28,-7829.77C24253.41,-7823.43 24268.94,-7817.63 24284,-7814.33 24335.04,-7803.14 26115.68,-7821.6 26165,-7804.33 26175.15,-7800.78 26173.86,-7792.92 26184,-7789.33 26217.36,-7777.52 26786.34,-7788.49 26821,-7781.33 26864.86,-7772.27 26911.76,-7751.36 26943.75,-7735.2"/>
<polygon fill="red" stroke="red" points="26945.48,-7738.25 26952.77,-7730.57 26942.28,-7732.02 26945.48,-7738.25"/>
<text text-anchor="middle" x="26215.5" y="-7793.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu11 -->
<g id="node484" class="node">
<title>l2_attn_stage8_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="25356" cy="-7712.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25356" y="-7724.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="25356" y="-7709.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="25356" y="-7694.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu11&#45;&gt;l2_attn_stage8_gpu11 -->
<g id="edge684" class="edge">
<title>l2_attn_stage7_gpu11&#45;&gt;l2_attn_stage8_gpu11</title>
<path fill="none" stroke="black" d="M25356,-7822.24C25356,-7803.52 25356,-7780.53 25356,-7760.55"/>
<polygon fill="black" stroke="black" points="25359.5,-7760.41 25356,-7750.41 25352.5,-7760.41 25359.5,-7760.41"/>
</g>
<!-- l2_attn_stage7_gpu11&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge2572" class="edge">
<title>l2_attn_stage7_gpu11&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25409.28,-7829.8C25423.42,-7823.46 25438.95,-7817.65 25454,-7814.33 25520.57,-7799.64 26616.69,-7826.95 26681,-7804.33 26691.15,-7800.76 26689.96,-7793.19 26700,-7789.33 26750.3,-7769.99 26768.53,-7793.64 26821,-7781.33 26864.2,-7771.2 26910.67,-7750.75 26942.71,-7735"/>
<polygon fill="red" stroke="red" points="26944.38,-7738.09 26951.77,-7730.49 26941.25,-7731.82 26944.38,-7738.09"/>
<text text-anchor="middle" x="26731.5" y="-7793.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu12 -->
<g id="node485" class="node">
<title>l2_attn_stage8_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="24381" cy="-7712.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24381" y="-7724.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="24381" y="-7709.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="24381" y="-7694.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu12&#45;&gt;l2_attn_stage8_gpu12 -->
<g id="edge685" class="edge">
<title>l2_attn_stage7_gpu12&#45;&gt;l2_attn_stage8_gpu12</title>
<path fill="none" stroke="black" d="M24381,-7822.24C24381,-7803.52 24381,-7780.53 24381,-7760.55"/>
<polygon fill="black" stroke="black" points="24384.5,-7760.41 24381,-7750.41 24377.5,-7760.41 24384.5,-7760.41"/>
</g>
<!-- l2_attn_stage7_gpu12&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge2573" class="edge">
<title>l2_attn_stage7_gpu12&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24434.28,-7829.77C24448.41,-7823.43 24463.94,-7817.64 24479,-7814.33 24527.08,-7803.79 26204.55,-7820.61 26251,-7804.33 26261.15,-7800.78 26259.86,-7792.93 26270,-7789.33 26298.85,-7779.08 26791.02,-7787.55 26821,-7781.33 26864.85,-7772.23 26911.75,-7751.33 26943.75,-7735.18"/>
<polygon fill="red" stroke="red" points="26945.47,-7738.23 26952.77,-7730.55 26942.27,-7732 26945.47,-7738.23"/>
<text text-anchor="middle" x="26301.5" y="-7793.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu13 -->
<g id="node486" class="node">
<title>l2_attn_stage8_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="25551" cy="-7712.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25551" y="-7724.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="25551" y="-7709.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="25551" y="-7694.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu13&#45;&gt;l2_attn_stage8_gpu13 -->
<g id="edge686" class="edge">
<title>l2_attn_stage7_gpu13&#45;&gt;l2_attn_stage8_gpu13</title>
<path fill="none" stroke="black" d="M25551,-7822.24C25551,-7803.52 25551,-7780.53 25551,-7760.55"/>
<polygon fill="black" stroke="black" points="25554.5,-7760.41 25551,-7750.41 25547.5,-7760.41 25554.5,-7760.41"/>
</g>
<!-- l2_attn_stage7_gpu13&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge2574" class="edge">
<title>l2_attn_stage7_gpu13&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25604.28,-7829.8C25618.42,-7823.46 25633.95,-7817.66 25649,-7814.33 25709.65,-7800.92 26708.41,-7824.97 26767,-7804.33 26777.15,-7800.76 26776.3,-7793.98 26786,-7789.33 26800.39,-7782.44 26805.8,-7786.2 26821,-7781.33 26861.94,-7768.23 26906.95,-7749.07 26939.12,-7734.51"/>
<polygon fill="red" stroke="red" points="26940.61,-7737.68 26948.25,-7730.34 26937.7,-7731.31 26940.61,-7737.68"/>
<text text-anchor="middle" x="26817.5" y="-7793.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu14 -->
<g id="node487" class="node">
<title>l2_attn_stage8_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="24771" cy="-7712.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24771" y="-7724.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="24771" y="-7709.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="24771" y="-7694.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu14&#45;&gt;l2_attn_stage8_gpu14 -->
<g id="edge687" class="edge">
<title>l2_attn_stage7_gpu14&#45;&gt;l2_attn_stage8_gpu14</title>
<path fill="none" stroke="black" d="M24771,-7822.24C24771,-7803.52 24771,-7780.53 24771,-7760.55"/>
<polygon fill="black" stroke="black" points="24774.5,-7760.41 24771,-7750.41 24767.5,-7760.41 24774.5,-7760.41"/>
</g>
<!-- l2_attn_stage7_gpu14&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge2575" class="edge">
<title>l2_attn_stage7_gpu14&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24824.28,-7829.78C24838.41,-7823.44 24853.94,-7817.64 24869,-7814.33 24911.16,-7805.07 26382.27,-7818.62 26423,-7804.33 26433.15,-7800.77 26431.87,-7792.97 26442,-7789.33 26481.64,-7775.1 26779.79,-7790.03 26821,-7781.33 26864.82,-7772.09 26911.73,-7751.2 26943.73,-7735.1"/>
<polygon fill="red" stroke="red" points="26945.45,-7738.15 26952.75,-7730.48 26942.26,-7731.92 26945.45,-7738.15"/>
<text text-anchor="middle" x="26473.5" y="-7793.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu15 -->
<g id="node488" class="node">
<title>l2_attn_stage8_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="25746" cy="-7712.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25746" y="-7724.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="25746" y="-7709.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="25746" y="-7694.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu15&#45;&gt;l2_attn_stage8_gpu15 -->
<g id="edge688" class="edge">
<title>l2_attn_stage7_gpu15&#45;&gt;l2_attn_stage8_gpu15</title>
<path fill="none" stroke="black" d="M25746,-7822.24C25746,-7803.52 25746,-7780.53 25746,-7760.55"/>
<polygon fill="black" stroke="black" points="25749.5,-7760.41 25746,-7750.41 25742.5,-7760.41 25749.5,-7760.41"/>
</g>
<!-- l2_attn_stage7_gpu15&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge2576" class="edge">
<title>l2_attn_stage7_gpu15&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25799.29,-7829.81C25813.42,-7823.47 25828.95,-7817.67 25844,-7814.33 25898.73,-7802.2 26800.13,-7822.98 26853,-7804.33 26863.15,-7800.75 26863.32,-7795.69 26872,-7789.33 26897.22,-7770.84 26926.5,-7750.99 26948.65,-7736.28"/>
<polygon fill="red" stroke="red" points="26950.66,-7739.15 26957.07,-7730.72 26946.8,-7733.31 26950.66,-7739.15"/>
<text text-anchor="middle" x="26903.5" y="-7793.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu0 -->
<g id="node489" class="node">
<title>l2_attn_stage9_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24966" cy="-7565.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24966" y="-7577.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="24966" y="-7562.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24966" y="-7547.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu0&#45;&gt;l2_attn_stage9_gpu0 -->
<g id="edge689" class="edge">
<title>l2_attn_stage8_gpu0&#45;&gt;l2_attn_stage9_gpu0</title>
<path fill="none" stroke="black" d="M24966,-7675.24C24966,-7656.52 24966,-7633.53 24966,-7613.55"/>
<polygon fill="black" stroke="black" points="24969.5,-7613.41 24966,-7603.41 24962.5,-7613.41 24969.5,-7613.41"/>
</g>
<!-- l2_attn_stage9_gpu[next_gpu] -->
<g id="node1368" class="node">
<title>l2_attn_stage9_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="26983" cy="-7565.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="26983" y="-7562.13" font-family="Times,serif" font-size="14.00">l2_attn_stage9_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage8_gpu0&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge2577" class="edge">
<title>l2_attn_stage8_gpu0&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25019.28,-7682.78C25033.41,-7676.44 25048.94,-7670.64 25064,-7667.33 25103.2,-7658.71 26471.13,-7670.63 26509,-7657.33 26519.15,-7653.77 26517.89,-7646 26528,-7642.33 26558.62,-7631.23 26789.15,-7641.15 26821,-7634.33 26864.66,-7624.98 26911.41,-7604.22 26943.42,-7588.17"/>
<polygon fill="red" stroke="red" points="26945.12,-7591.23 26952.45,-7583.57 26941.95,-7584.99 26945.12,-7591.23"/>
<text text-anchor="middle" x="26559.5" y="-7646.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu1 -->
<g id="node490" class="node">
<title>l2_attn_stage9_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24576" cy="-7565.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24576" y="-7577.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="24576" y="-7562.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24576" y="-7547.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu1&#45;&gt;l2_attn_stage9_gpu1 -->
<g id="edge690" class="edge">
<title>l2_attn_stage8_gpu1&#45;&gt;l2_attn_stage9_gpu1</title>
<path fill="none" stroke="black" d="M24576,-7675.24C24576,-7656.52 24576,-7633.53 24576,-7613.55"/>
<polygon fill="black" stroke="black" points="24579.5,-7613.41 24576,-7603.41 24572.5,-7613.41 24579.5,-7613.41"/>
</g>
<!-- l2_attn_stage8_gpu1&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge2578" class="edge">
<title>l2_attn_stage8_gpu1&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24629.28,-7682.77C24643.41,-7676.43 24658.94,-7670.64 24674,-7667.33 24719.12,-7657.43 26293.41,-7672.61 26337,-7657.33 26347.15,-7653.77 26345.87,-7645.95 26356,-7642.33 26404.67,-7624.97 26770.42,-7644.9 26821,-7634.33 26864.84,-7625.17 26911.74,-7604.28 26943.74,-7588.14"/>
<polygon fill="red" stroke="red" points="26945.46,-7591.2 26952.76,-7583.52 26942.27,-7584.97 26945.46,-7591.2"/>
<text text-anchor="middle" x="26387.5" y="-7646.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu2 -->
<g id="node491" class="node">
<title>l2_attn_stage9_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25941" cy="-7565.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25941" y="-7577.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="25941" y="-7562.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25941" y="-7547.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu2&#45;&gt;l2_attn_stage9_gpu2 -->
<g id="edge691" class="edge">
<title>l2_attn_stage8_gpu2&#45;&gt;l2_attn_stage9_gpu2</title>
<path fill="none" stroke="black" d="M25941,-7675.24C25941,-7656.52 25941,-7633.53 25941,-7613.55"/>
<polygon fill="black" stroke="black" points="25944.5,-7613.41 25941,-7603.41 25937.5,-7613.41 25944.5,-7613.41"/>
</g>
<!-- l2_attn_stage8_gpu2&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge2579" class="edge">
<title>l2_attn_stage8_gpu2&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25994.29,-7682.83C26008.42,-7676.49 26023.95,-7670.68 26039,-7667.33 26063.41,-7661.91 26917.88,-7670.71 26939,-7657.33 26960.94,-7643.43 26972.24,-7615.15 26977.85,-7593.89"/>
<polygon fill="red" stroke="red" points="26981.27,-7594.64 26980.18,-7584.1 26974.46,-7593.02 26981.27,-7594.64"/>
<text text-anchor="middle" x="26985.5" y="-7646.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu3 -->
<g id="node492" class="node">
<title>l2_attn_stage9_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26331" cy="-7565.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26331" y="-7577.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="26331" y="-7562.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26331" y="-7547.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu3&#45;&gt;l2_attn_stage9_gpu3 -->
<g id="edge692" class="edge">
<title>l2_attn_stage8_gpu3&#45;&gt;l2_attn_stage9_gpu3</title>
<path fill="none" stroke="black" d="M26277.7,-7682.89C26263.85,-7676.63 26248.69,-7670.85 26234,-7667.33 26220.37,-7664.07 25991.71,-7667.43 25982,-7657.33 25977.38,-7652.53 25977.36,-7647.12 25982,-7642.33 25991.75,-7632.27 26220.7,-7638.74 26234,-7634.33 26252.4,-7628.24 26270.44,-7617.44 26285.87,-7606.25"/>
<polygon fill="black" stroke="black" points="26288.27,-7608.83 26294.16,-7600.02 26284.06,-7603.23 26288.27,-7608.83"/>
</g>
<!-- l2_attn_stage8_gpu3&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge2580" class="edge">
<title>l2_attn_stage8_gpu3&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26384.3,-7682.86C26398.43,-7676.52 26413.96,-7670.7 26429,-7667.33 26447.49,-7663.19 27097.7,-7670.83 27111,-7657.33 27139.36,-7628.56 27091.79,-7602.72 27046.82,-7586.1"/>
<polygon fill="red" stroke="red" points="27047.88,-7582.76 27037.29,-7582.69 27045.53,-7589.35 27047.88,-7582.76"/>
<text text-anchor="middle" x="27150.5" y="-7646.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu4 -->
<g id="node493" class="node">
<title>l2_attn_stage9_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25161" cy="-7565.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25161" y="-7577.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="25161" y="-7562.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25161" y="-7547.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu4&#45;&gt;l2_attn_stage9_gpu4 -->
<g id="edge693" class="edge">
<title>l2_attn_stage8_gpu4&#45;&gt;l2_attn_stage9_gpu4</title>
<path fill="none" stroke="black" d="M25161,-7675.24C25161,-7656.52 25161,-7633.53 25161,-7613.55"/>
<polygon fill="black" stroke="black" points="25164.5,-7613.41 25161,-7603.41 25157.5,-7613.41 25164.5,-7613.41"/>
</g>
<!-- l2_attn_stage8_gpu4&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge2581" class="edge">
<title>l2_attn_stage8_gpu4&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25214.28,-7682.79C25228.42,-7676.45 25243.95,-7670.65 25259,-7667.33 25295.24,-7659.35 26559.99,-7669.63 26595,-7657.33 26605.15,-7653.77 26603.91,-7646.06 26614,-7642.33 26657.19,-7626.4 26776.04,-7644.23 26821,-7634.33 26864.6,-7624.73 26911.37,-7604.01 26943.39,-7588.04"/>
<polygon fill="red" stroke="red" points="26945.08,-7591.1 26952.42,-7583.46 26941.92,-7584.86 26945.08,-7591.1"/>
<text text-anchor="middle" x="26645.5" y="-7646.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu5 -->
<g id="node494" class="node">
<title>l2_attn_stage9_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="26136" cy="-7565.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26136" y="-7577.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="26136" y="-7562.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="26136" y="-7547.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu5&#45;&gt;l2_attn_stage9_gpu5 -->
<g id="edge694" class="edge">
<title>l2_attn_stage8_gpu5&#45;&gt;l2_attn_stage9_gpu5</title>
<path fill="none" stroke="black" d="M26080.85,-7683.37C26067.43,-7677.33 26052.93,-7671.53 26039,-7667.33 26025.22,-7663.18 25984.36,-7668.27 25975,-7657.33 25940.08,-7616.53 25980.79,-7656.65 26039,-7634.33 26056.78,-7627.51 26074.42,-7616.77 26089.68,-7605.84"/>
<polygon fill="black" stroke="black" points="26091.93,-7608.53 26097.9,-7599.77 26087.77,-7602.89 26091.93,-7608.53"/>
</g>
<!-- l2_attn_stage8_gpu5&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge2582" class="edge">
<title>l2_attn_stage8_gpu5&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26189.29,-7682.84C26203.43,-7676.5 26218.95,-7670.69 26234,-7667.33 26255.45,-7662.55 27009.56,-7672.97 27025,-7657.33 27043.16,-7638.94 27025.89,-7611.25 27008.31,-7591.34"/>
<polygon fill="red" stroke="red" points="27010.75,-7588.82 27001.38,-7583.87 27005.61,-7593.58 27010.75,-7588.82"/>
<text text-anchor="middle" x="27063.5" y="-7646.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu6 -->
<g id="node495" class="node">
<title>l2_attn_stage9_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="23991" cy="-7565.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23991" y="-7577.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="23991" y="-7562.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="23991" y="-7547.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu6&#45;&gt;l2_attn_stage9_gpu6 -->
<g id="edge695" class="edge">
<title>l2_attn_stage8_gpu6&#45;&gt;l2_attn_stage9_gpu6</title>
<path fill="none" stroke="black" d="M23991,-7675.24C23991,-7656.52 23991,-7633.53 23991,-7613.55"/>
<polygon fill="black" stroke="black" points="23994.5,-7613.41 23991,-7603.41 23987.5,-7613.41 23994.5,-7613.41"/>
</g>
<!-- l2_attn_stage8_gpu6&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge2583" class="edge">
<title>l2_attn_stage8_gpu6&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24044.28,-7682.76C24058.41,-7676.42 24073.94,-7670.63 24089,-7667.33 24143,-7655.5 26026.82,-7675.59 26079,-7657.33 26089.15,-7653.78 26087.86,-7645.92 26098,-7642.33 26135.87,-7628.95 26781.66,-7642.43 26821,-7634.33 26864.87,-7625.31 26911.77,-7604.39 26943.76,-7588.22"/>
<polygon fill="red" stroke="red" points="26945.48,-7591.27 26952.78,-7583.58 26942.28,-7585.04 26945.48,-7591.27"/>
<text text-anchor="middle" x="26129.5" y="-7646.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu7 -->
<g id="node496" class="node">
<title>l2_attn_stage9_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="26721" cy="-7565.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26721" y="-7577.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="26721" y="-7562.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="26721" y="-7547.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu7&#45;&gt;l2_attn_stage9_gpu7 -->
<g id="edge696" class="edge">
<title>l2_attn_stage8_gpu7&#45;&gt;l2_attn_stage9_gpu7</title>
<path fill="none" stroke="black" d="M26668.02,-7682.76C26654.09,-7676.47 26638.82,-7670.69 26624,-7667.33 26606.99,-7663.47 26008.24,-7669.77 25996,-7657.33 25991.32,-7652.58 25991.32,-7647.08 25996,-7642.33 26008.26,-7629.92 26607.39,-7639.66 26624,-7634.33 26642.46,-7628.41 26660.51,-7617.66 26675.94,-7606.46"/>
<polygon fill="black" stroke="black" points="26678.34,-7609.03 26684.22,-7600.22 26674.13,-7603.44 26678.34,-7609.03"/>
</g>
<!-- l2_attn_stage8_gpu7&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge2584" class="edge">
<title>l2_attn_stage8_gpu7&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26776.38,-7683.52C26791.74,-7676.95 26808.68,-7670.86 26825,-7667.33 26849.87,-7661.95 27265.2,-7675.52 27283,-7657.33 27337.67,-7601.46 27236.45,-7579.8 27137.12,-7571.54"/>
<polygon fill="red" stroke="red" points="27137.15,-7568.03 27126.9,-7570.74 27136.6,-7575.01 27137.15,-7568.03"/>
<text text-anchor="middle" x="27323.5" y="-7646.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu8 -->
<g id="node497" class="node">
<title>l2_attn_stage9_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="23796" cy="-7565.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="23796" y="-7577.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="23796" y="-7562.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="23796" y="-7547.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu8&#45;&gt;l2_attn_stage9_gpu8 -->
<g id="edge697" class="edge">
<title>l2_attn_stage8_gpu8&#45;&gt;l2_attn_stage9_gpu8</title>
<path fill="none" stroke="black" d="M23796,-7675.24C23796,-7656.52 23796,-7633.53 23796,-7613.55"/>
<polygon fill="black" stroke="black" points="23799.5,-7613.41 23796,-7603.41 23792.5,-7613.41 23799.5,-7613.41"/>
</g>
<!-- l2_attn_stage8_gpu8&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge2585" class="edge">
<title>l2_attn_stage8_gpu8&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23849.29,-7682.83C23863.43,-7676.49 23878.95,-7670.68 23894,-7667.33 24123.73,-7616.2 25776.66,-7644.88 26012,-7642.33 26056.94,-7641.84 26776.97,-7643.36 26821,-7634.33 26864.87,-7625.33 26911.77,-7604.41 26943.76,-7588.23"/>
<polygon fill="red" stroke="red" points="26945.49,-7591.28 26952.78,-7583.59 26942.28,-7585.05 26945.49,-7591.28"/>
<text text-anchor="middle" x="26043.5" y="-7646.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu9 -->
<g id="node498" class="node">
<title>l2_attn_stage9_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26526" cy="-7565.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="26526" y="-7577.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="26526" y="-7562.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26526" y="-7547.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu9&#45;&gt;l2_attn_stage9_gpu9 -->
<g id="edge698" class="edge">
<title>l2_attn_stage8_gpu9&#45;&gt;l2_attn_stage9_gpu9</title>
<path fill="none" stroke="black" d="M26472.74,-7682.72C26458.89,-7676.46 26443.71,-7670.72 26429,-7667.33 26405.17,-7661.84 26006.09,-7674.82 25989,-7657.33 25984.34,-7652.56 25984.33,-7647.09 25989,-7642.33 25997.56,-7633.61 26417.37,-7638.1 26429,-7634.33 26447.45,-7628.36 26465.49,-7617.6 26480.92,-7606.4"/>
<polygon fill="black" stroke="black" points="26483.32,-7608.97 26489.2,-7600.16 26479.11,-7603.38 26483.32,-7608.97"/>
</g>
<!-- l2_attn_stage8_gpu9&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge2586" class="edge">
<title>l2_attn_stage8_gpu9&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26579.3,-7682.89C26593.44,-7676.55 26608.96,-7670.72 26624,-7667.33 26639.53,-7663.83 27185.84,-7668.69 27197,-7657.33 27237.03,-7616.59 27167.32,-7593.24 27097.01,-7580.49"/>
<polygon fill="red" stroke="red" points="27097.55,-7577.03 27087.1,-7578.76 27096.35,-7583.93 27097.55,-7577.03"/>
<text text-anchor="middle" x="27237.5" y="-7646.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu10 -->
<g id="node499" class="node">
<title>l2_attn_stage9_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="24186" cy="-7565.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24186" y="-7577.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="24186" y="-7562.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="24186" y="-7547.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu10&#45;&gt;l2_attn_stage9_gpu10 -->
<g id="edge699" class="edge">
<title>l2_attn_stage8_gpu10&#45;&gt;l2_attn_stage9_gpu10</title>
<path fill="none" stroke="black" d="M24186,-7675.24C24186,-7656.52 24186,-7633.53 24186,-7613.55"/>
<polygon fill="black" stroke="black" points="24189.5,-7613.41 24186,-7603.41 24182.5,-7613.41 24189.5,-7613.41"/>
</g>
<!-- l2_attn_stage8_gpu10&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge2587" class="edge">
<title>l2_attn_stage8_gpu10&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24239.28,-7682.77C24253.41,-7676.43 24268.94,-7670.63 24284,-7667.33 24335.04,-7656.14 26115.68,-7674.6 26165,-7657.33 26175.15,-7653.78 26173.86,-7645.92 26184,-7642.33 26217.36,-7630.52 26786.34,-7641.49 26821,-7634.33 26864.86,-7625.27 26911.76,-7604.36 26943.75,-7588.2"/>
<polygon fill="red" stroke="red" points="26945.48,-7591.25 26952.77,-7583.57 26942.28,-7585.02 26945.48,-7591.25"/>
<text text-anchor="middle" x="26215.5" y="-7646.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu11 -->
<g id="node500" class="node">
<title>l2_attn_stage9_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="25356" cy="-7565.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25356" y="-7577.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="25356" y="-7562.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="25356" y="-7547.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu11&#45;&gt;l2_attn_stage9_gpu11 -->
<g id="edge700" class="edge">
<title>l2_attn_stage8_gpu11&#45;&gt;l2_attn_stage9_gpu11</title>
<path fill="none" stroke="black" d="M25356,-7675.24C25356,-7656.52 25356,-7633.53 25356,-7613.55"/>
<polygon fill="black" stroke="black" points="25359.5,-7613.41 25356,-7603.41 25352.5,-7613.41 25359.5,-7613.41"/>
</g>
<!-- l2_attn_stage8_gpu11&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge2588" class="edge">
<title>l2_attn_stage8_gpu11&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25409.28,-7682.8C25423.42,-7676.46 25438.95,-7670.65 25454,-7667.33 25520.57,-7652.64 26616.69,-7679.95 26681,-7657.33 26691.15,-7653.76 26689.96,-7646.19 26700,-7642.33 26750.3,-7622.99 26768.53,-7646.64 26821,-7634.33 26864.2,-7624.2 26910.67,-7603.75 26942.71,-7588"/>
<polygon fill="red" stroke="red" points="26944.38,-7591.09 26951.77,-7583.49 26941.25,-7584.82 26944.38,-7591.09"/>
<text text-anchor="middle" x="26731.5" y="-7646.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu12 -->
<g id="node501" class="node">
<title>l2_attn_stage9_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="24381" cy="-7565.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24381" y="-7577.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="24381" y="-7562.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="24381" y="-7547.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu12&#45;&gt;l2_attn_stage9_gpu12 -->
<g id="edge701" class="edge">
<title>l2_attn_stage8_gpu12&#45;&gt;l2_attn_stage9_gpu12</title>
<path fill="none" stroke="black" d="M24381,-7675.24C24381,-7656.52 24381,-7633.53 24381,-7613.55"/>
<polygon fill="black" stroke="black" points="24384.5,-7613.41 24381,-7603.41 24377.5,-7613.41 24384.5,-7613.41"/>
</g>
<!-- l2_attn_stage8_gpu12&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge2589" class="edge">
<title>l2_attn_stage8_gpu12&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24434.28,-7682.77C24448.41,-7676.43 24463.94,-7670.64 24479,-7667.33 24527.08,-7656.79 26204.55,-7673.61 26251,-7657.33 26261.15,-7653.78 26259.86,-7645.93 26270,-7642.33 26298.85,-7632.08 26791.02,-7640.55 26821,-7634.33 26864.85,-7625.23 26911.75,-7604.33 26943.75,-7588.18"/>
<polygon fill="red" stroke="red" points="26945.47,-7591.23 26952.77,-7583.55 26942.27,-7585 26945.47,-7591.23"/>
<text text-anchor="middle" x="26301.5" y="-7646.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu13 -->
<g id="node502" class="node">
<title>l2_attn_stage9_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="25551" cy="-7565.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25551" y="-7577.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="25551" y="-7562.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="25551" y="-7547.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu13&#45;&gt;l2_attn_stage9_gpu13 -->
<g id="edge702" class="edge">
<title>l2_attn_stage8_gpu13&#45;&gt;l2_attn_stage9_gpu13</title>
<path fill="none" stroke="black" d="M25551,-7675.24C25551,-7656.52 25551,-7633.53 25551,-7613.55"/>
<polygon fill="black" stroke="black" points="25554.5,-7613.41 25551,-7603.41 25547.5,-7613.41 25554.5,-7613.41"/>
</g>
<!-- l2_attn_stage8_gpu13&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge2590" class="edge">
<title>l2_attn_stage8_gpu13&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25604.28,-7682.8C25618.42,-7676.46 25633.95,-7670.66 25649,-7667.33 25709.65,-7653.92 26708.41,-7677.97 26767,-7657.33 26777.15,-7653.76 26776.3,-7646.98 26786,-7642.33 26800.39,-7635.44 26805.8,-7639.2 26821,-7634.33 26861.94,-7621.23 26906.95,-7602.07 26939.12,-7587.51"/>
<polygon fill="red" stroke="red" points="26940.61,-7590.68 26948.25,-7583.34 26937.7,-7584.31 26940.61,-7590.68"/>
<text text-anchor="middle" x="26817.5" y="-7646.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu14 -->
<g id="node503" class="node">
<title>l2_attn_stage9_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="24771" cy="-7565.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="24771" y="-7577.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="24771" y="-7562.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="24771" y="-7547.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu14&#45;&gt;l2_attn_stage9_gpu14 -->
<g id="edge703" class="edge">
<title>l2_attn_stage8_gpu14&#45;&gt;l2_attn_stage9_gpu14</title>
<path fill="none" stroke="black" d="M24771,-7675.24C24771,-7656.52 24771,-7633.53 24771,-7613.55"/>
<polygon fill="black" stroke="black" points="24774.5,-7613.41 24771,-7603.41 24767.5,-7613.41 24774.5,-7613.41"/>
</g>
<!-- l2_attn_stage8_gpu14&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge2591" class="edge">
<title>l2_attn_stage8_gpu14&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24824.28,-7682.78C24838.41,-7676.44 24853.94,-7670.64 24869,-7667.33 24911.16,-7658.07 26382.27,-7671.62 26423,-7657.33 26433.15,-7653.77 26431.87,-7645.97 26442,-7642.33 26481.64,-7628.1 26779.79,-7643.03 26821,-7634.33 26864.82,-7625.09 26911.73,-7604.2 26943.73,-7588.1"/>
<polygon fill="red" stroke="red" points="26945.45,-7591.15 26952.75,-7583.48 26942.26,-7584.92 26945.45,-7591.15"/>
<text text-anchor="middle" x="26473.5" y="-7646.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu15 -->
<g id="node504" class="node">
<title>l2_attn_stage9_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="25746" cy="-7565.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="25746" y="-7577.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="25746" y="-7562.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="25746" y="-7547.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu15&#45;&gt;l2_attn_stage9_gpu15 -->
<g id="edge704" class="edge">
<title>l2_attn_stage8_gpu15&#45;&gt;l2_attn_stage9_gpu15</title>
<path fill="none" stroke="black" d="M25746,-7675.24C25746,-7656.52 25746,-7633.53 25746,-7613.55"/>
<polygon fill="black" stroke="black" points="25749.5,-7613.41 25746,-7603.41 25742.5,-7613.41 25749.5,-7613.41"/>
</g>
<!-- l2_attn_stage8_gpu15&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge2592" class="edge">
<title>l2_attn_stage8_gpu15&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25799.29,-7682.81C25813.42,-7676.47 25828.95,-7670.67 25844,-7667.33 25898.73,-7655.2 26800.13,-7675.98 26853,-7657.33 26863.15,-7653.75 26863.32,-7648.69 26872,-7642.33 26897.22,-7623.84 26926.5,-7603.99 26948.65,-7589.28"/>
<polygon fill="red" stroke="red" points="26950.66,-7592.15 26957.07,-7583.72 26946.8,-7586.31 26950.66,-7592.15"/>
<text text-anchor="middle" x="26903.5" y="-7646.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu0 -->
<g id="node505" class="node">
<title>l2_attn_stage10_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24842" cy="-7418.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24842" y="-7430.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="24842" y="-7415.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24842" y="-7400.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu0&#45;&gt;l2_attn_stage10_gpu0 -->
<g id="edge705" class="edge">
<title>l2_attn_stage9_gpu0&#45;&gt;l2_attn_stage10_gpu0</title>
<path fill="none" stroke="black" d="M24936.3,-7530.1C24918.88,-7509.73 24896.74,-7483.84 24878.29,-7462.27"/>
<polygon fill="black" stroke="black" points="24880.83,-7459.86 24871.67,-7454.53 24875.51,-7464.41 24880.83,-7459.86"/>
</g>
<!-- l2_attn_stage10_gpu[next_gpu] -->
<g id="node1369" class="node">
<title>l2_attn_stage10_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="26989" cy="-7418.83" rx="155.5" ry="18"/>
<text text-anchor="middle" x="26989" y="-7415.13" font-family="Times,serif" font-size="14.00">l2_attn_stage10_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage9_gpu0&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge2593" class="edge">
<title>l2_attn_stage9_gpu0&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25019.28,-7535.78C25033.41,-7529.44 25048.94,-7523.65 25064,-7520.33 25102.79,-7511.79 26456.52,-7523.49 26494,-7510.33 26504.15,-7506.77 26502.88,-7498.99 26513,-7495.33 26545.19,-7483.69 26787.48,-7494.27 26821,-7487.33 26866.11,-7478 26914.62,-7457.24 26947.86,-7441.18"/>
<polygon fill="red" stroke="red" points="26949.8,-7444.13 26957.24,-7436.58 26946.72,-7437.84 26949.8,-7444.13"/>
<text text-anchor="middle" x="26544.5" y="-7499.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu1 -->
<g id="node506" class="node">
<title>l2_attn_stage10_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24426" cy="-7418.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24426" y="-7430.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="24426" y="-7415.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24426" y="-7400.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu1&#45;&gt;l2_attn_stage10_gpu1 -->
<g id="edge706" class="edge">
<title>l2_attn_stage9_gpu1&#45;&gt;l2_attn_stage10_gpu1</title>
<path fill="none" stroke="black" d="M24541.21,-7531.2C24519.5,-7510.22 24491.41,-7483.06 24468.4,-7460.82"/>
<polygon fill="black" stroke="black" points="24470.74,-7458.22 24461.12,-7453.78 24465.88,-7463.25 24470.74,-7458.22"/>
</g>
<!-- l2_attn_stage9_gpu1&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge2594" class="edge">
<title>l2_attn_stage9_gpu1&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24629.28,-7535.77C24643.41,-7529.44 24658.94,-7523.64 24674,-7520.33 24718.71,-7510.51 26278.8,-7525.48 26322,-7510.33 26332.15,-7506.77 26330.87,-7498.95 26341,-7495.33 26391.24,-7477.42 26768.72,-7497.9 26821,-7487.33 26866.29,-7478.18 26914.96,-7457.29 26948.19,-7441.15"/>
<polygon fill="red" stroke="red" points="26950.14,-7444.09 26957.56,-7436.53 26947.05,-7437.81 26950.14,-7444.09"/>
<text text-anchor="middle" x="26372.5" y="-7499.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu2 -->
<g id="node507" class="node">
<title>l2_attn_stage10_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25882" cy="-7418.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25882" y="-7430.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="25882" y="-7415.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25882" y="-7400.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu2&#45;&gt;l2_attn_stage10_gpu2 -->
<g id="edge707" class="edge">
<title>l2_attn_stage9_gpu2&#45;&gt;l2_attn_stage10_gpu2</title>
<path fill="none" stroke="black" d="M25926.26,-7528.62C25918.49,-7509.5 25908.86,-7485.85 25900.58,-7465.48"/>
<polygon fill="black" stroke="black" points="25903.76,-7464.03 25896.75,-7456.09 25897.28,-7466.67 25903.76,-7464.03"/>
</g>
<!-- l2_attn_stage9_gpu2&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge2595" class="edge">
<title>l2_attn_stage9_gpu2&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25994.29,-7535.83C26008.42,-7529.49 26023.95,-7523.68 26039,-7520.33 26063,-7515 26902.19,-7521.68 26924,-7510.33 26937.7,-7503.21 26959.58,-7469.79 26974.12,-7445.63"/>
<polygon fill="red" stroke="red" points="26977.21,-7447.29 26979.3,-7436.9 26971.19,-7443.72 26977.21,-7447.29"/>
<text text-anchor="middle" x="26970.5" y="-7499.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu3 -->
<g id="node508" class="node">
<title>l2_attn_stage10_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26298" cy="-7418.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26298" y="-7430.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="26298" y="-7415.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26298" y="-7400.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu3&#45;&gt;l2_attn_stage10_gpu3 -->
<g id="edge708" class="edge">
<title>l2_attn_stage9_gpu3&#45;&gt;l2_attn_stage10_gpu3</title>
<path fill="none" stroke="black" d="M26277.71,-7535.87C26263.86,-7529.61 26248.69,-7523.83 26234,-7520.33 26219.56,-7516.89 25977.3,-7521.02 25967,-7510.33 25962.38,-7505.53 25962.37,-7500.13 25967,-7495.33 25975.76,-7486.25 26181.97,-7491.13 26194,-7487.33 26213.58,-7481.16 26233,-7470.22 26249.67,-7458.91"/>
<polygon fill="black" stroke="black" points="26251.94,-7461.6 26258.13,-7453 26247.93,-7455.87 26251.94,-7461.6"/>
</g>
<!-- l2_attn_stage9_gpu3&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge2596" class="edge">
<title>l2_attn_stage9_gpu3&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26384.3,-7535.87C26398.43,-7529.53 26413.96,-7523.71 26429,-7520.33 26447.08,-7516.28 27083,-7523.53 27096,-7510.33 27121.61,-7484.34 27080.49,-7457.74 27042.03,-7440.17"/>
<polygon fill="red" stroke="red" points="27043.43,-7436.96 27032.87,-7436.12 27040.61,-7443.36 27043.43,-7436.96"/>
<text text-anchor="middle" x="27134.5" y="-7499.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu4 -->
<g id="node509" class="node">
<title>l2_attn_stage10_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25050" cy="-7418.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25050" y="-7430.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="25050" y="-7415.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25050" y="-7400.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu4&#45;&gt;l2_attn_stage10_gpu4 -->
<g id="edge709" class="edge">
<title>l2_attn_stage9_gpu4&#45;&gt;l2_attn_stage10_gpu4</title>
<path fill="none" stroke="black" d="M25134.13,-7529.73C25118.71,-7509.59 25099.23,-7484.15 25082.9,-7462.82"/>
<polygon fill="black" stroke="black" points="25085.67,-7460.67 25076.81,-7454.86 25080.11,-7464.93 25085.67,-7460.67"/>
</g>
<!-- l2_attn_stage9_gpu4&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge2597" class="edge">
<title>l2_attn_stage9_gpu4&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25214.28,-7535.79C25228.42,-7529.45 25243.95,-7523.65 25259,-7520.33 25330.67,-7504.54 26510.76,-7534.66 26580,-7510.33 26590.15,-7506.77 26588.9,-7499.04 26599,-7495.33 26645.34,-7478.31 26772.71,-7497.58 26821,-7487.33 26866.06,-7477.77 26914.58,-7457.04 26947.83,-7441.06"/>
<polygon fill="red" stroke="red" points="26949.76,-7444.01 26957.22,-7436.48 26946.69,-7437.72 26949.76,-7444.01"/>
<text text-anchor="middle" x="26630.5" y="-7499.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu5 -->
<g id="node510" class="node">
<title>l2_attn_stage10_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="26090" cy="-7418.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26090" y="-7430.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="26090" y="-7415.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="26090" y="-7400.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu5&#45;&gt;l2_attn_stage10_gpu5 -->
<g id="edge710" class="edge">
<title>l2_attn_stage9_gpu5&#45;&gt;l2_attn_stage10_gpu5</title>
<path fill="none" stroke="black" d="M26081.2,-7536.19C26067.7,-7530.12 26053.07,-7524.35 26039,-7520.33 26021.98,-7515.48 25971.7,-7523.61 25960,-7510.33 25955.59,-7505.33 25956.04,-7500.69 25960,-7495.33 25967.18,-7485.61 25975.05,-7492.45 25986,-7487.33 26003.44,-7479.18 26021.39,-7468.49 26037.36,-7458.02"/>
<polygon fill="black" stroke="black" points="26039.64,-7460.71 26046.02,-7452.25 26035.76,-7454.89 26039.64,-7460.71"/>
</g>
<!-- l2_attn_stage9_gpu5&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge2598" class="edge">
<title>l2_attn_stage9_gpu5&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26189.29,-7535.84C26203.43,-7529.5 26218.95,-7523.69 26234,-7520.33 26255.04,-7515.64 26994.86,-7525.67 27010,-7510.33 27026.7,-7493.41 27017.21,-7465.97 27006.14,-7445.73"/>
<polygon fill="red" stroke="red" points="27009.11,-7443.87 27001.04,-7437 27003.07,-7447.4 27009.11,-7443.87"/>
<text text-anchor="middle" x="27048.5" y="-7499.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu6 -->
<g id="node511" class="node">
<title>l2_attn_stage10_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="23802" cy="-7418.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="23802" y="-7430.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="23802" y="-7415.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="23802" y="-7400.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu6&#45;&gt;l2_attn_stage10_gpu6 -->
<g id="edge711" class="edge">
<title>l2_attn_stage9_gpu6&#45;&gt;l2_attn_stage10_gpu6</title>
<path fill="none" stroke="black" d="M23949.05,-7532.65C23920.62,-7510.84 23882.89,-7481.89 23852.76,-7458.78"/>
<polygon fill="black" stroke="black" points="23854.55,-7455.73 23844.48,-7452.42 23850.29,-7461.29 23854.55,-7455.73"/>
</g>
<!-- l2_attn_stage9_gpu6&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge2599" class="edge">
<title>l2_attn_stage9_gpu6&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24044.28,-7535.76C24058.41,-7529.43 24073.94,-7523.63 24089,-7520.33 24142.59,-7508.59 26012.22,-7528.46 26064,-7510.33 26074.15,-7506.78 26072.86,-7498.92 26083,-7495.33 26121.66,-7481.68 26780.79,-7495.34 26821,-7487.33 26866.31,-7478.31 26914.98,-7457.4 26948.21,-7441.22"/>
<polygon fill="red" stroke="red" points="26950.17,-7444.16 26957.58,-7436.58 26947.06,-7437.88 26950.17,-7444.16"/>
<text text-anchor="middle" x="26114.5" y="-7499.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu7 -->
<g id="node512" class="node">
<title>l2_attn_stage10_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="26714" cy="-7418.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26714" y="-7430.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="26714" y="-7415.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="26714" y="-7400.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu7&#45;&gt;l2_attn_stage10_gpu7 -->
<g id="edge712" class="edge">
<title>l2_attn_stage9_gpu7&#45;&gt;l2_attn_stage10_gpu7</title>
<path fill="none" stroke="black" d="M26668.02,-7535.76C26654.09,-7529.46 26638.82,-7523.69 26624,-7520.33 26606.58,-7516.38 25993.53,-7523.06 25981,-7510.33 25976.32,-7505.58 25976.32,-7500.08 25981,-7495.33 25993.28,-7482.9 26593.28,-7492.4 26610,-7487.33 26629.65,-7481.38 26649.09,-7470.49 26665.75,-7459.18"/>
<polygon fill="black" stroke="black" points="26668.03,-7461.85 26674.2,-7453.24 26664.01,-7456.13 26668.03,-7461.85"/>
</g>
<!-- l2_attn_stage9_gpu7&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge2600" class="edge">
<title>l2_attn_stage9_gpu7&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26776.38,-7536.53C26791.74,-7529.96 26808.69,-7523.87 26825,-7520.33 26849.06,-7515.12 27250.79,-7527.93 27268,-7510.33 27317.67,-7459.53 27230.33,-7437.22 27140.57,-7427.44"/>
<polygon fill="red" stroke="red" points="27140.78,-7423.94 27130.47,-7426.39 27140.05,-7430.9 27140.78,-7423.94"/>
<text text-anchor="middle" x="27307.5" y="-7499.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu8 -->
<g id="node513" class="node">
<title>l2_attn_stage10_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="23594" cy="-7418.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="23594" y="-7430.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="23594" y="-7415.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="23594" y="-7400.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu8&#45;&gt;l2_attn_stage10_gpu8 -->
<g id="edge713" class="edge">
<title>l2_attn_stage9_gpu8&#45;&gt;l2_attn_stage10_gpu8</title>
<path fill="none" stroke="black" d="M23751.67,-7533.01C23720.97,-7510.97 23679.93,-7481.52 23647.42,-7458.18"/>
<polygon fill="black" stroke="black" points="23649.09,-7455.07 23638.92,-7452.08 23645.01,-7460.75 23649.09,-7455.07"/>
</g>
<!-- l2_attn_stage9_gpu8&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge2601" class="edge">
<title>l2_attn_stage9_gpu8&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23849.29,-7535.83C23863.43,-7529.49 23878.95,-7523.68 23894,-7520.33 24122.1,-7469.55 25763.33,-7497.86 25997,-7495.33 26042.78,-7494.84 26776.1,-7496.24 26821,-7487.33 26866.32,-7478.34 26914.98,-7457.42 26948.21,-7441.23"/>
<polygon fill="red" stroke="red" points="26950.17,-7444.17 26957.58,-7436.6 26947.06,-7437.9 26950.17,-7444.17"/>
<text text-anchor="middle" x="26028.5" y="-7499.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu9 -->
<g id="node514" class="node">
<title>l2_attn_stage10_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26506" cy="-7418.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26506" y="-7430.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="26506" y="-7415.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26506" y="-7400.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu9&#45;&gt;l2_attn_stage10_gpu9 -->
<g id="edge714" class="edge">
<title>l2_attn_stage9_gpu9&#45;&gt;l2_attn_stage10_gpu9</title>
<path fill="none" stroke="black" d="M26472.75,-7535.71C26458.89,-7529.46 26443.72,-7523.72 26429,-7520.33 26404.36,-7514.67 25991.68,-7528.41 25974,-7510.33 25969.34,-7505.57 25969.33,-7500.09 25974,-7495.33 25982.33,-7486.85 26390.63,-7490.81 26402,-7487.33 26421.63,-7481.32 26441.07,-7470.42 26457.73,-7459.11"/>
<polygon fill="black" stroke="black" points="26460.01,-7461.79 26466.18,-7453.18 26455.99,-7456.06 26460.01,-7461.79"/>
</g>
<!-- l2_attn_stage9_gpu9&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge2602" class="edge">
<title>l2_attn_stage9_gpu9&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26579.31,-7535.9C26593.44,-7529.56 26608.96,-7523.73 26624,-7520.33 26639.12,-7516.92 27171.14,-7521.39 27182,-7510.33 27218.82,-7472.85 27155.45,-7449.11 27091.69,-7435.4"/>
<polygon fill="red" stroke="red" points="27092.38,-7431.96 27081.88,-7433.36 27090.96,-7438.82 27092.38,-7431.96"/>
<text text-anchor="middle" x="27221.5" y="-7499.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu10 -->
<g id="node515" class="node">
<title>l2_attn_stage10_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="24010" cy="-7418.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24010" y="-7430.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="24010" y="-7415.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="24010" y="-7400.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu10&#45;&gt;l2_attn_stage10_gpu10 -->
<g id="edge715" class="edge">
<title>l2_attn_stage9_gpu10&#45;&gt;l2_attn_stage10_gpu10</title>
<path fill="none" stroke="black" d="M24146.06,-7531.93C24119.94,-7510.41 24085.66,-7482.17 24058.05,-7459.42"/>
<polygon fill="black" stroke="black" points="24060.03,-7456.51 24050.08,-7452.86 24055.58,-7461.92 24060.03,-7456.51"/>
</g>
<!-- l2_attn_stage9_gpu10&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge2603" class="edge">
<title>l2_attn_stage9_gpu10&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24239.28,-7535.77C24253.41,-7529.43 24268.94,-7523.63 24284,-7520.33 24334.63,-7509.23 26101.08,-7527.46 26150,-7510.33 26160.15,-7506.78 26158.86,-7498.92 26169,-7495.33 26203.15,-7483.24 26785.48,-7494.43 26821,-7487.33 26866.31,-7478.28 26914.97,-7457.37 26948.2,-7441.2"/>
<polygon fill="red" stroke="red" points="26950.16,-7444.14 26957.57,-7436.57 26947.06,-7437.86 26950.16,-7444.14"/>
<text text-anchor="middle" x="26200.5" y="-7499.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu11 -->
<g id="node516" class="node">
<title>l2_attn_stage10_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="25258" cy="-7418.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25258" y="-7430.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="25258" y="-7415.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="25258" y="-7400.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu11&#45;&gt;l2_attn_stage10_gpu11 -->
<g id="edge716" class="edge">
<title>l2_attn_stage9_gpu11&#45;&gt;l2_attn_stage10_gpu11</title>
<path fill="none" stroke="black" d="M25332.03,-7529.36C25318.63,-7509.54 25301.82,-7484.67 25287.61,-7463.64"/>
<polygon fill="black" stroke="black" points="25290.4,-7461.51 25281.9,-7455.19 25284.6,-7465.43 25290.4,-7461.51"/>
</g>
<!-- l2_attn_stage9_gpu11&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge2604" class="edge">
<title>l2_attn_stage9_gpu11&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25409.28,-7535.8C25423.42,-7529.46 25438.95,-7523.65 25454,-7520.33 25519.75,-7505.82 26602.48,-7532.68 26666,-7510.33 26676.15,-7506.76 26674.94,-7499.16 26685,-7495.33 26713.3,-7484.57 26791.46,-7493.95 26821,-7487.33 26865.67,-7477.33 26913.88,-7456.86 26947.15,-7441.07"/>
<polygon fill="red" stroke="red" points="26949.06,-7444.04 26956.55,-7436.55 26946.02,-7437.73 26949.06,-7444.04"/>
<text text-anchor="middle" x="26716.5" y="-7499.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu12 -->
<g id="node517" class="node">
<title>l2_attn_stage10_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="24218" cy="-7418.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24218" y="-7430.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="24218" y="-7415.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="24218" y="-7400.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu12&#45;&gt;l2_attn_stage10_gpu12 -->
<g id="edge717" class="edge">
<title>l2_attn_stage9_gpu12&#45;&gt;l2_attn_stage10_gpu12</title>
<path fill="none" stroke="black" d="M24343.6,-7531.57C24319.75,-7510.35 24288.69,-7482.72 24263.43,-7460.24"/>
<polygon fill="black" stroke="black" points="24265.58,-7457.48 24255.79,-7453.45 24260.93,-7462.71 24265.58,-7457.48"/>
</g>
<!-- l2_attn_stage9_gpu12&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge2605" class="edge">
<title>l2_attn_stage9_gpu12&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24434.28,-7535.77C24448.41,-7529.43 24463.94,-7523.64 24479,-7520.33 24526.67,-7509.87 26189.94,-7526.47 26236,-7510.33 26246.15,-7506.77 26244.86,-7498.93 26255,-7495.33 26284.63,-7484.81 26790.17,-7493.52 26821,-7487.33 26866.3,-7478.24 26914.97,-7457.33 26948.2,-7441.18"/>
<polygon fill="red" stroke="red" points="26950.15,-7444.12 26957.57,-7436.55 26947.05,-7437.84 26950.15,-7444.12"/>
<text text-anchor="middle" x="26286.5" y="-7499.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu13 -->
<g id="node518" class="node">
<title>l2_attn_stage10_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="25466" cy="-7418.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25466" y="-7430.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="25466" y="-7415.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="25466" y="-7400.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu13&#45;&gt;l2_attn_stage10_gpu13 -->
<g id="edge718" class="edge">
<title>l2_attn_stage9_gpu13&#45;&gt;l2_attn_stage10_gpu13</title>
<path fill="none" stroke="black" d="M25530.21,-7529.36C25518.68,-7509.7 25504.24,-7485.07 25491.98,-7464.15"/>
<polygon fill="black" stroke="black" points="25494.95,-7462.3 25486.87,-7455.44 25488.91,-7465.84 25494.95,-7462.3"/>
</g>
<!-- l2_attn_stage9_gpu13&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge2606" class="edge">
<title>l2_attn_stage9_gpu13&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25604.29,-7535.81C25618.42,-7529.47 25633.95,-7523.66 25649,-7520.33 25708.83,-7507.1 26694.2,-7530.69 26752,-7510.33 26762.15,-7506.76 26761.15,-7499.65 26771,-7495.33 26791.61,-7486.29 26799.31,-7493.34 26821,-7487.33 26864.28,-7475.34 26911.59,-7455.7 26944.94,-7440.69"/>
<polygon fill="red" stroke="red" points="26946.74,-7443.72 26954.4,-7436.4 26943.84,-7437.35 26946.74,-7443.72"/>
<text text-anchor="middle" x="26802.5" y="-7499.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu14 -->
<g id="node519" class="node">
<title>l2_attn_stage10_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="24634" cy="-7418.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24634" y="-7430.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="24634" y="-7415.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="24634" y="-7400.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu14&#45;&gt;l2_attn_stage10_gpu14 -->
<g id="edge719" class="edge">
<title>l2_attn_stage9_gpu14&#45;&gt;l2_attn_stage10_gpu14</title>
<path fill="none" stroke="black" d="M24738.88,-7530.84C24719.35,-7510.17 24694.27,-7483.62 24673.53,-7461.67"/>
<polygon fill="black" stroke="black" points="24675.81,-7458.98 24666.39,-7454.12 24670.72,-7463.79 24675.81,-7458.98"/>
</g>
<!-- l2_attn_stage9_gpu14&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge2607" class="edge">
<title>l2_attn_stage9_gpu14&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24824.28,-7535.78C24838.41,-7529.44 24853.94,-7523.64 24869,-7520.33 24910.75,-7511.15 26367.66,-7524.48 26408,-7510.33 26418.15,-7506.77 26416.87,-7498.96 26427,-7495.33 26468.22,-7480.55 26778.1,-7496.08 26821,-7487.33 26866.27,-7478.1 26914.94,-7457.22 26948.18,-7441.1"/>
<polygon fill="red" stroke="red" points="26950.13,-7444.05 26957.56,-7436.49 26947.04,-7437.77 26950.13,-7444.05"/>
<text text-anchor="middle" x="26458.5" y="-7499.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu15 -->
<g id="node520" class="node">
<title>l2_attn_stage10_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="25674" cy="-7418.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25674" y="-7430.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="25674" y="-7415.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="25674" y="-7400.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu15&#45;&gt;l2_attn_stage10_gpu15 -->
<g id="edge720" class="edge">
<title>l2_attn_stage9_gpu15&#45;&gt;l2_attn_stage10_gpu15</title>
<path fill="none" stroke="black" d="M25728.2,-7528.99C25718.6,-7509.64 25706.64,-7485.57 25696.41,-7464.96"/>
<polygon fill="black" stroke="black" points="25699.42,-7463.17 25691.84,-7455.77 25693.16,-7466.28 25699.42,-7463.17"/>
</g>
<!-- l2_attn_stage9_gpu15&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge2608" class="edge">
<title>l2_attn_stage9_gpu15&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25799.29,-7535.82C25813.42,-7529.48 25828.95,-7523.67 25844,-7520.33 25897.92,-7508.38 26785.92,-7528.71 26838,-7510.33 26848.15,-7506.75 26848.08,-7501.35 26857,-7495.33 26886.36,-7475.51 26921.2,-7455.72 26947.72,-7441.38"/>
<polygon fill="red" stroke="red" points="26949.57,-7444.36 26956.73,-7436.55 26946.26,-7438.19 26949.57,-7444.36"/>
<text text-anchor="middle" x="26888.5" y="-7499.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu0 -->
<g id="node521" class="node">
<title>l2_attn_stage11_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24842" cy="-7271.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24842" y="-7283.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="24842" y="-7268.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24842" y="-7253.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu0&#45;&gt;l2_attn_stage11_gpu0 -->
<g id="edge721" class="edge">
<title>l2_attn_stage10_gpu0&#45;&gt;l2_attn_stage11_gpu0</title>
<path fill="none" stroke="black" d="M24842,-7381.24C24842,-7362.52 24842,-7339.53 24842,-7319.55"/>
<polygon fill="black" stroke="black" points="24845.5,-7319.41 24842,-7309.41 24838.5,-7319.41 24845.5,-7319.41"/>
</g>
<!-- l2_attn_stage11_gpu[next_gpu] -->
<g id="node1370" class="node">
<title>l2_attn_stage11_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="26989" cy="-7271.83" rx="155.5" ry="18"/>
<text text-anchor="middle" x="26989" y="-7268.13" font-family="Times,serif" font-size="14.00">l2_attn_stage11_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage10_gpu0&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge2609" class="edge">
<title>l2_attn_stage10_gpu0&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24898.97,-7388.66C24913.9,-7382.36 24930.23,-7376.62 24946,-7373.33 24988.1,-7364.56 26453.42,-7377.57 26494,-7363.33 26504.15,-7359.77 26502.88,-7351.99 26513,-7348.33 26545.19,-7336.69 26787.48,-7347.27 26821,-7340.33 26866.11,-7331 26914.62,-7310.24 26947.86,-7294.18"/>
<polygon fill="red" stroke="red" points="26949.8,-7297.13 26957.24,-7289.58 26946.72,-7290.84 26949.8,-7297.13"/>
<text text-anchor="middle" x="26544.5" y="-7352.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu1 -->
<g id="node522" class="node">
<title>l2_attn_stage11_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24426" cy="-7271.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24426" y="-7283.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="24426" y="-7268.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24426" y="-7253.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu1&#45;&gt;l2_attn_stage11_gpu1 -->
<g id="edge722" class="edge">
<title>l2_attn_stage10_gpu1&#45;&gt;l2_attn_stage11_gpu1</title>
<path fill="none" stroke="black" d="M24426,-7381.24C24426,-7362.52 24426,-7339.53 24426,-7319.55"/>
<polygon fill="black" stroke="black" points="24429.5,-7319.41 24426,-7309.41 24422.5,-7319.41 24429.5,-7319.41"/>
</g>
<!-- l2_attn_stage10_gpu1&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge2610" class="edge">
<title>l2_attn_stage10_gpu1&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24482.97,-7388.65C24497.9,-7382.35 24514.23,-7376.61 24530,-7373.33 24578.74,-7363.2 26275.02,-7379.79 26322,-7363.33 26332.15,-7359.78 26330.87,-7351.95 26341,-7348.33 26391.24,-7330.42 26768.72,-7350.9 26821,-7340.33 26866.29,-7331.18 26914.96,-7310.29 26948.19,-7294.15"/>
<polygon fill="red" stroke="red" points="26950.14,-7297.09 26957.56,-7289.53 26947.05,-7290.81 26950.14,-7297.09"/>
<text text-anchor="middle" x="26372.5" y="-7352.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu2 -->
<g id="node523" class="node">
<title>l2_attn_stage11_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25882" cy="-7271.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25882" y="-7283.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="25882" y="-7268.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25882" y="-7253.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu2&#45;&gt;l2_attn_stage11_gpu2 -->
<g id="edge723" class="edge">
<title>l2_attn_stage10_gpu2&#45;&gt;l2_attn_stage11_gpu2</title>
<path fill="none" stroke="black" d="M25882,-7381.24C25882,-7362.52 25882,-7339.53 25882,-7319.55"/>
<polygon fill="black" stroke="black" points="25885.5,-7319.41 25882,-7309.41 25878.5,-7319.41 25885.5,-7319.41"/>
</g>
<!-- l2_attn_stage10_gpu2&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge2611" class="edge">
<title>l2_attn_stage10_gpu2&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25938.98,-7388.7C25953.91,-7382.41 25970.24,-7376.65 25986,-7373.33 26011.5,-7367.96 26900.88,-7375.35 26924,-7363.33 26937.7,-7356.21 26959.58,-7322.79 26974.12,-7298.63"/>
<polygon fill="red" stroke="red" points="26977.21,-7300.29 26979.3,-7289.9 26971.19,-7296.72 26977.21,-7300.29"/>
<text text-anchor="middle" x="26970.5" y="-7352.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu3 -->
<g id="node524" class="node">
<title>l2_attn_stage11_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26298" cy="-7271.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26298" y="-7283.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="26298" y="-7268.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26298" y="-7253.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu3&#45;&gt;l2_attn_stage11_gpu3 -->
<g id="edge724" class="edge">
<title>l2_attn_stage10_gpu3&#45;&gt;l2_attn_stage11_gpu3</title>
<path fill="none" stroke="black" d="M26240.39,-7388.84C26225.62,-7382.62 26209.51,-7376.87 26194,-7373.33 26169.39,-7367.72 25984.45,-7381.57 25967,-7363.33 25962.39,-7358.52 25962.37,-7353.13 25967,-7348.33 25975.76,-7339.25 26181.97,-7344.13 26194,-7340.33 26213.58,-7334.16 26233,-7323.22 26249.67,-7311.91"/>
<polygon fill="black" stroke="black" points="26251.94,-7314.6 26258.13,-7306 26247.93,-7308.87 26251.94,-7314.6"/>
</g>
<!-- l2_attn_stage10_gpu3&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge2612" class="edge">
<title>l2_attn_stage10_gpu3&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26354.99,-7388.74C26369.92,-7382.45 26386.25,-7376.68 26402,-7373.33 26420.86,-7369.33 27082.47,-7377.06 27096,-7363.33 27121.62,-7337.35 27080.49,-7310.75 27042.04,-7293.17"/>
<polygon fill="red" stroke="red" points="27043.44,-7289.96 27032.88,-7289.12 27040.61,-7296.37 27043.44,-7289.96"/>
<text text-anchor="middle" x="27134.5" y="-7352.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu4 -->
<g id="node525" class="node">
<title>l2_attn_stage11_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25050" cy="-7271.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25050" y="-7283.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="25050" y="-7268.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25050" y="-7253.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu4&#45;&gt;l2_attn_stage11_gpu4 -->
<g id="edge725" class="edge">
<title>l2_attn_stage10_gpu4&#45;&gt;l2_attn_stage11_gpu4</title>
<path fill="none" stroke="black" d="M25050,-7381.24C25050,-7362.52 25050,-7339.53 25050,-7319.55"/>
<polygon fill="black" stroke="black" points="25053.5,-7319.41 25050,-7309.41 25046.5,-7319.41 25053.5,-7319.41"/>
</g>
<!-- l2_attn_stage10_gpu4&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge2613" class="edge">
<title>l2_attn_stage10_gpu4&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25106.98,-7388.66C25121.9,-7382.37 25138.24,-7376.62 25154,-7373.33 25192.78,-7365.24 26542.62,-7376.45 26580,-7363.33 26590.15,-7359.77 26588.9,-7352.04 26599,-7348.33 26645.34,-7331.31 26772.71,-7350.58 26821,-7340.33 26866.06,-7330.77 26914.58,-7310.04 26947.83,-7294.06"/>
<polygon fill="red" stroke="red" points="26949.76,-7297.01 26957.22,-7289.48 26946.69,-7290.72 26949.76,-7297.01"/>
<text text-anchor="middle" x="26630.5" y="-7352.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu5 -->
<g id="node526" class="node">
<title>l2_attn_stage11_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="26090" cy="-7271.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26090" y="-7283.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="26090" y="-7268.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="26090" y="-7253.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu5&#45;&gt;l2_attn_stage11_gpu5 -->
<g id="edge726" class="edge">
<title>l2_attn_stage10_gpu5&#45;&gt;l2_attn_stage11_gpu5</title>
<path fill="none" stroke="black" d="M26027.19,-7390.51C26013.64,-7384.74 25999.37,-7378.76 25986,-7373.33 25974.53,-7368.67 25967.01,-7373.54 25960,-7363.33 25956.23,-7357.84 25956.04,-7353.69 25960,-7348.33 25967.18,-7338.61 25975.05,-7345.45 25986,-7340.33 26003.44,-7332.18 26021.39,-7321.49 26037.36,-7311.02"/>
<polygon fill="black" stroke="black" points="26039.64,-7313.71 26046.02,-7305.25 26035.76,-7307.89 26039.64,-7313.71"/>
</g>
<!-- l2_attn_stage10_gpu5&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge2614" class="edge">
<title>l2_attn_stage10_gpu5&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26146.99,-7388.72C26161.91,-7382.42 26178.24,-7376.66 26194,-7373.33 26216.18,-7368.64 26994.07,-7379.46 27010,-7363.33 27026.71,-7346.42 27017.21,-7318.97 27006.15,-7298.73"/>
<polygon fill="red" stroke="red" points="27009.11,-7296.87 27001.04,-7290.01 27003.07,-7300.4 27009.11,-7296.87"/>
<text text-anchor="middle" x="27048.5" y="-7352.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu6 -->
<g id="node527" class="node">
<title>l2_attn_stage11_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="23802" cy="-7271.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="23802" y="-7283.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="23802" y="-7268.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="23802" y="-7253.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu6&#45;&gt;l2_attn_stage11_gpu6 -->
<g id="edge727" class="edge">
<title>l2_attn_stage10_gpu6&#45;&gt;l2_attn_stage11_gpu6</title>
<path fill="none" stroke="black" d="M23802,-7381.24C23802,-7362.52 23802,-7339.53 23802,-7319.55"/>
<polygon fill="black" stroke="black" points="23805.5,-7319.41 23802,-7309.41 23798.5,-7319.41 23805.5,-7319.41"/>
</g>
<!-- l2_attn_stage10_gpu6&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge2615" class="edge">
<title>l2_attn_stage10_gpu6&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23858.97,-7388.64C23873.89,-7382.34 23890.23,-7376.6 23906,-7373.33 23964.7,-7361.16 26007.42,-7383.12 26064,-7363.33 26074.16,-7359.78 26072.86,-7351.92 26083,-7348.33 26121.66,-7334.68 26780.79,-7348.34 26821,-7340.33 26866.31,-7331.31 26914.98,-7310.4 26948.21,-7294.22"/>
<polygon fill="red" stroke="red" points="26950.17,-7297.16 26957.58,-7289.58 26947.06,-7290.88 26950.17,-7297.16"/>
<text text-anchor="middle" x="26114.5" y="-7352.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu7 -->
<g id="node528" class="node">
<title>l2_attn_stage11_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="26714" cy="-7271.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26714" y="-7283.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="26714" y="-7268.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="26714" y="-7253.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu7&#45;&gt;l2_attn_stage11_gpu7 -->
<g id="edge728" class="edge">
<title>l2_attn_stage10_gpu7&#45;&gt;l2_attn_stage11_gpu7</title>
<path fill="none" stroke="black" d="M26657,-7388.76C26642.08,-7382.46 26625.75,-7376.69 26610,-7373.33 26592.91,-7369.69 25993.26,-7375.79 25981,-7363.33 25976.32,-7358.58 25976.32,-7353.08 25981,-7348.33 25993.28,-7335.9 26593.28,-7345.4 26610,-7340.33 26629.65,-7334.38 26649.09,-7323.49 26665.75,-7312.18"/>
<polygon fill="black" stroke="black" points="26668.03,-7314.85 26674.2,-7306.24 26664.01,-7309.13 26668.03,-7314.85"/>
</g>
<!-- l2_attn_stage10_gpu7&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge2616" class="edge">
<title>l2_attn_stage10_gpu7&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26773.56,-7389.41C26789.88,-7382.89 26807.81,-7376.85 26825,-7373.33 26849.12,-7368.39 27250.79,-7380.93 27268,-7363.33 27317.67,-7312.53 27230.33,-7290.22 27140.57,-7280.44"/>
<polygon fill="red" stroke="red" points="27140.78,-7276.94 27130.47,-7279.39 27140.05,-7283.9 27140.78,-7276.94"/>
<text text-anchor="middle" x="27307.5" y="-7352.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu8 -->
<g id="node529" class="node">
<title>l2_attn_stage11_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="23594" cy="-7271.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="23594" y="-7283.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="23594" y="-7268.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="23594" y="-7253.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu8&#45;&gt;l2_attn_stage11_gpu8 -->
<g id="edge729" class="edge">
<title>l2_attn_stage10_gpu8&#45;&gt;l2_attn_stage11_gpu8</title>
<path fill="none" stroke="black" d="M23594,-7381.24C23594,-7362.52 23594,-7339.53 23594,-7319.55"/>
<polygon fill="black" stroke="black" points="23597.5,-7319.41 23594,-7309.41 23590.5,-7319.41 23597.5,-7319.41"/>
</g>
<!-- l2_attn_stage10_gpu8&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge2617" class="edge">
<title>l2_attn_stage10_gpu8&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23650.98,-7388.7C23665.91,-7382.41 23682.24,-7376.65 23698,-7373.33 23947.97,-7320.68 25741.55,-7350.96 25997,-7348.33 26042.78,-7347.86 26776.1,-7349.24 26821,-7340.33 26866.32,-7331.34 26914.98,-7310.42 26948.21,-7294.23"/>
<polygon fill="red" stroke="red" points="26950.17,-7297.17 26957.58,-7289.6 26947.06,-7290.9 26950.17,-7297.17"/>
<text text-anchor="middle" x="26028.5" y="-7352.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu9 -->
<g id="node530" class="node">
<title>l2_attn_stage11_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26506" cy="-7271.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26506" y="-7283.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="26506" y="-7268.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26506" y="-7253.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu9&#45;&gt;l2_attn_stage11_gpu9 -->
<g id="edge730" class="edge">
<title>l2_attn_stage10_gpu9&#45;&gt;l2_attn_stage11_gpu9</title>
<path fill="none" stroke="black" d="M26448.71,-7388.73C26433.86,-7382.47 26417.64,-7376.73 26402,-7373.33 26378.76,-7368.28 25990.62,-7380.35 25974,-7363.33 25969.34,-7358.56 25969.33,-7353.09 25974,-7348.33 25982.33,-7339.85 26390.63,-7343.81 26402,-7340.33 26421.63,-7334.32 26441.07,-7323.42 26457.73,-7312.11"/>
<polygon fill="black" stroke="black" points="26460.01,-7314.79 26466.18,-7306.18 26455.99,-7309.06 26460.01,-7314.79"/>
</g>
<!-- l2_attn_stage10_gpu9&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge2618" class="edge">
<title>l2_attn_stage10_gpu9&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26563,-7388.78C26577.92,-7382.48 26594.25,-7376.7 26610,-7373.33 26625.54,-7370.01 27170.86,-7374.67 27182,-7363.33 27218.88,-7325.8 27155.24,-7302.04 27091.37,-7288.33"/>
<polygon fill="red" stroke="red" points="27092.05,-7284.9 27081.55,-7286.3 27090.63,-7291.75 27092.05,-7284.9"/>
<text text-anchor="middle" x="27221.5" y="-7352.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu10 -->
<g id="node531" class="node">
<title>l2_attn_stage11_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="24010" cy="-7271.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24010" y="-7283.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="24010" y="-7268.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="24010" y="-7253.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu10&#45;&gt;l2_attn_stage11_gpu10 -->
<g id="edge731" class="edge">
<title>l2_attn_stage10_gpu10&#45;&gt;l2_attn_stage11_gpu10</title>
<path fill="none" stroke="black" d="M24010,-7381.24C24010,-7362.52 24010,-7339.53 24010,-7319.55"/>
<polygon fill="black" stroke="black" points="24013.5,-7319.41 24010,-7309.41 24006.5,-7319.41 24013.5,-7319.41"/>
</g>
<!-- l2_attn_stage10_gpu10&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge2619" class="edge">
<title>l2_attn_stage10_gpu10&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24066.97,-7388.64C24081.89,-7382.35 24098.23,-7376.6 24114,-7373.33 24169.38,-7361.84 26096.62,-7382.01 26150,-7363.33 26160.16,-7359.78 26158.86,-7351.92 26169,-7348.33 26203.15,-7336.24 26785.48,-7347.43 26821,-7340.33 26866.31,-7331.28 26914.97,-7310.37 26948.2,-7294.2"/>
<polygon fill="red" stroke="red" points="26950.16,-7297.14 26957.57,-7289.57 26947.06,-7290.86 26950.16,-7297.14"/>
<text text-anchor="middle" x="26200.5" y="-7352.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu11 -->
<g id="node532" class="node">
<title>l2_attn_stage11_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="25258" cy="-7271.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25258" y="-7283.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="25258" y="-7268.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="25258" y="-7253.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu11&#45;&gt;l2_attn_stage11_gpu11 -->
<g id="edge732" class="edge">
<title>l2_attn_stage10_gpu11&#45;&gt;l2_attn_stage11_gpu11</title>
<path fill="none" stroke="black" d="M25258,-7381.24C25258,-7362.52 25258,-7339.53 25258,-7319.55"/>
<polygon fill="black" stroke="black" points="25261.5,-7319.41 25258,-7309.41 25254.5,-7319.41 25261.5,-7319.41"/>
</g>
<!-- l2_attn_stage10_gpu11&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge2620" class="edge">
<title>l2_attn_stage10_gpu11&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25314.98,-7388.67C25329.9,-7382.38 25346.24,-7376.63 25362,-7373.33 25432.91,-7358.51 26597.65,-7387.35 26666,-7363.33 26676.15,-7359.76 26674.94,-7352.16 26685,-7348.33 26713.3,-7337.57 26791.46,-7346.95 26821,-7340.33 26865.67,-7330.33 26913.88,-7309.86 26947.15,-7294.07"/>
<polygon fill="red" stroke="red" points="26949.06,-7297.04 26956.55,-7289.55 26946.02,-7290.73 26949.06,-7297.04"/>
<text text-anchor="middle" x="26716.5" y="-7352.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu12 -->
<g id="node533" class="node">
<title>l2_attn_stage11_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="24218" cy="-7271.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24218" y="-7283.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="24218" y="-7268.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="24218" y="-7253.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu12&#45;&gt;l2_attn_stage11_gpu12 -->
<g id="edge733" class="edge">
<title>l2_attn_stage10_gpu12&#45;&gt;l2_attn_stage11_gpu12</title>
<path fill="none" stroke="black" d="M24218,-7381.24C24218,-7362.52 24218,-7339.53 24218,-7319.55"/>
<polygon fill="black" stroke="black" points="24221.5,-7319.41 24218,-7309.41 24214.5,-7319.41 24221.5,-7319.41"/>
</g>
<!-- l2_attn_stage10_gpu12&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge2621" class="edge">
<title>l2_attn_stage10_gpu12&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24274.97,-7388.64C24289.9,-7382.35 24306.23,-7376.61 24322,-7373.33 24374.06,-7362.52 26185.82,-7380.9 26236,-7363.33 26246.15,-7359.78 26244.86,-7351.93 26255,-7348.33 26284.63,-7337.81 26790.17,-7346.52 26821,-7340.33 26866.3,-7331.24 26914.97,-7310.33 26948.2,-7294.18"/>
<polygon fill="red" stroke="red" points="26950.15,-7297.12 26957.57,-7289.55 26947.05,-7290.84 26950.15,-7297.12"/>
<text text-anchor="middle" x="26286.5" y="-7352.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu13 -->
<g id="node534" class="node">
<title>l2_attn_stage11_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="25466" cy="-7271.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25466" y="-7283.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="25466" y="-7268.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="25466" y="-7253.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu13&#45;&gt;l2_attn_stage11_gpu13 -->
<g id="edge734" class="edge">
<title>l2_attn_stage10_gpu13&#45;&gt;l2_attn_stage11_gpu13</title>
<path fill="none" stroke="black" d="M25466,-7381.24C25466,-7362.52 25466,-7339.53 25466,-7319.55"/>
<polygon fill="black" stroke="black" points="25469.5,-7319.41 25466,-7309.41 25462.5,-7319.41 25469.5,-7319.41"/>
</g>
<!-- l2_attn_stage10_gpu13&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge2622" class="edge">
<title>l2_attn_stage10_gpu13&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25522.98,-7388.68C25537.9,-7382.38 25554.24,-7376.63 25570,-7373.33 25634.28,-7359.88 26690.05,-7385.13 26752,-7363.33 26762.15,-7359.76 26761.15,-7352.65 26771,-7348.33 26791.61,-7339.29 26799.31,-7346.34 26821,-7340.33 26864.28,-7328.34 26911.59,-7308.7 26944.94,-7293.69"/>
<polygon fill="red" stroke="red" points="26946.74,-7296.72 26954.4,-7289.4 26943.84,-7290.35 26946.74,-7296.72"/>
<text text-anchor="middle" x="26802.5" y="-7352.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu14 -->
<g id="node535" class="node">
<title>l2_attn_stage11_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="24634" cy="-7271.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24634" y="-7283.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="24634" y="-7268.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="24634" y="-7253.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu14&#45;&gt;l2_attn_stage11_gpu14 -->
<g id="edge735" class="edge">
<title>l2_attn_stage10_gpu14&#45;&gt;l2_attn_stage11_gpu14</title>
<path fill="none" stroke="black" d="M24634,-7381.24C24634,-7362.52 24634,-7339.53 24634,-7319.55"/>
<polygon fill="black" stroke="black" points="24637.5,-7319.41 24634,-7309.41 24630.5,-7319.41 24637.5,-7319.41"/>
</g>
<!-- l2_attn_stage10_gpu14&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge2623" class="edge">
<title>l2_attn_stage10_gpu14&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24690.97,-7388.65C24705.9,-7382.36 24722.23,-7376.61 24738,-7373.33 24783.42,-7363.88 26364.22,-7378.68 26408,-7363.33 26418.15,-7359.77 26416.87,-7351.96 26427,-7348.33 26468.22,-7333.55 26778.1,-7349.08 26821,-7340.33 26866.27,-7331.1 26914.94,-7310.22 26948.18,-7294.1"/>
<polygon fill="red" stroke="red" points="26950.13,-7297.05 26957.56,-7289.49 26947.04,-7290.77 26950.13,-7297.05"/>
<text text-anchor="middle" x="26458.5" y="-7352.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu15 -->
<g id="node536" class="node">
<title>l2_attn_stage11_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="25674" cy="-7271.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25674" y="-7283.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="25674" y="-7268.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="25674" y="-7253.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu15&#45;&gt;l2_attn_stage11_gpu15 -->
<g id="edge736" class="edge">
<title>l2_attn_stage10_gpu15&#45;&gt;l2_attn_stage11_gpu15</title>
<path fill="none" stroke="black" d="M25674,-7381.24C25674,-7362.52 25674,-7339.53 25674,-7319.55"/>
<polygon fill="black" stroke="black" points="25677.5,-7319.41 25674,-7309.41 25670.5,-7319.41 25677.5,-7319.41"/>
</g>
<!-- l2_attn_stage10_gpu15&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge2624" class="edge">
<title>l2_attn_stage10_gpu15&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25730.98,-7388.69C25745.91,-7382.39 25762.24,-7376.64 25778,-7373.33 25835.64,-7361.24 26782.46,-7382.91 26838,-7363.33 26848.15,-7359.76 26848.08,-7354.35 26857,-7348.33 26886.36,-7328.51 26921.2,-7308.72 26947.72,-7294.38"/>
<polygon fill="red" stroke="red" points="26949.57,-7297.36 26956.73,-7289.55 26946.26,-7291.19 26949.57,-7297.36"/>
<text text-anchor="middle" x="26888.5" y="-7352.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu0 -->
<g id="node537" class="node">
<title>l2_attn_stage12_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24842" cy="-7124.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24842" y="-7136.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="24842" y="-7121.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24842" y="-7106.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu0&#45;&gt;l2_attn_stage12_gpu0 -->
<g id="edge737" class="edge">
<title>l2_attn_stage11_gpu0&#45;&gt;l2_attn_stage12_gpu0</title>
<path fill="none" stroke="black" d="M24842,-7234.24C24842,-7215.52 24842,-7192.53 24842,-7172.55"/>
<polygon fill="black" stroke="black" points="24845.5,-7172.41 24842,-7162.41 24838.5,-7172.41 24845.5,-7172.41"/>
</g>
<!-- l2_attn_stage12_gpu[next_gpu] -->
<g id="node1371" class="node">
<title>l2_attn_stage12_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="26989" cy="-7124.83" rx="155.5" ry="18"/>
<text text-anchor="middle" x="26989" y="-7121.13" font-family="Times,serif" font-size="14.00">l2_attn_stage12_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage11_gpu0&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge2625" class="edge">
<title>l2_attn_stage11_gpu0&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24898.97,-7241.66C24913.9,-7235.36 24930.23,-7229.62 24946,-7226.33 24988.1,-7217.56 26453.42,-7230.57 26494,-7216.33 26504.15,-7212.77 26502.88,-7204.99 26513,-7201.33 26545.19,-7189.69 26787.48,-7200.27 26821,-7193.33 26866.11,-7184 26914.62,-7163.24 26947.86,-7147.18"/>
<polygon fill="red" stroke="red" points="26949.8,-7150.13 26957.24,-7142.58 26946.72,-7143.84 26949.8,-7150.13"/>
<text text-anchor="middle" x="26544.5" y="-7205.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu1 -->
<g id="node538" class="node">
<title>l2_attn_stage12_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24426" cy="-7124.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24426" y="-7136.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="24426" y="-7121.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24426" y="-7106.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu1&#45;&gt;l2_attn_stage12_gpu1 -->
<g id="edge738" class="edge">
<title>l2_attn_stage11_gpu1&#45;&gt;l2_attn_stage12_gpu1</title>
<path fill="none" stroke="black" d="M24426,-7234.24C24426,-7215.52 24426,-7192.53 24426,-7172.55"/>
<polygon fill="black" stroke="black" points="24429.5,-7172.41 24426,-7162.41 24422.5,-7172.41 24429.5,-7172.41"/>
</g>
<!-- l2_attn_stage11_gpu1&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge2626" class="edge">
<title>l2_attn_stage11_gpu1&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24482.97,-7241.65C24497.9,-7235.35 24514.23,-7229.61 24530,-7226.33 24578.74,-7216.2 26275.02,-7232.79 26322,-7216.33 26332.15,-7212.78 26330.87,-7204.95 26341,-7201.33 26391.24,-7183.42 26768.72,-7203.9 26821,-7193.33 26866.29,-7184.18 26914.96,-7163.29 26948.19,-7147.15"/>
<polygon fill="red" stroke="red" points="26950.14,-7150.09 26957.56,-7142.53 26947.05,-7143.81 26950.14,-7150.09"/>
<text text-anchor="middle" x="26372.5" y="-7205.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu2 -->
<g id="node539" class="node">
<title>l2_attn_stage12_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25882" cy="-7124.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25882" y="-7136.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="25882" y="-7121.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25882" y="-7106.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu2&#45;&gt;l2_attn_stage12_gpu2 -->
<g id="edge739" class="edge">
<title>l2_attn_stage11_gpu2&#45;&gt;l2_attn_stage12_gpu2</title>
<path fill="none" stroke="black" d="M25882,-7234.24C25882,-7215.52 25882,-7192.53 25882,-7172.55"/>
<polygon fill="black" stroke="black" points="25885.5,-7172.41 25882,-7162.41 25878.5,-7172.41 25885.5,-7172.41"/>
</g>
<!-- l2_attn_stage11_gpu2&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge2627" class="edge">
<title>l2_attn_stage11_gpu2&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25938.98,-7241.7C25953.91,-7235.41 25970.24,-7229.65 25986,-7226.33 26011.5,-7220.96 26900.88,-7228.35 26924,-7216.33 26937.7,-7209.21 26959.58,-7175.79 26974.12,-7151.63"/>
<polygon fill="red" stroke="red" points="26977.21,-7153.29 26979.3,-7142.9 26971.19,-7149.72 26977.21,-7153.29"/>
<text text-anchor="middle" x="26970.5" y="-7205.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu3 -->
<g id="node540" class="node">
<title>l2_attn_stage12_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26298" cy="-7124.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26298" y="-7136.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="26298" y="-7121.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26298" y="-7106.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu3&#45;&gt;l2_attn_stage12_gpu3 -->
<g id="edge740" class="edge">
<title>l2_attn_stage11_gpu3&#45;&gt;l2_attn_stage12_gpu3</title>
<path fill="none" stroke="black" d="M26240.39,-7241.84C26225.62,-7235.62 26209.51,-7229.87 26194,-7226.33 26169.39,-7220.72 25984.45,-7234.57 25967,-7216.33 25962.39,-7211.52 25962.37,-7206.13 25967,-7201.33 25975.76,-7192.25 26181.97,-7197.13 26194,-7193.33 26213.58,-7187.16 26233,-7176.22 26249.67,-7164.91"/>
<polygon fill="black" stroke="black" points="26251.94,-7167.6 26258.13,-7159 26247.93,-7161.87 26251.94,-7167.6"/>
</g>
<!-- l2_attn_stage11_gpu3&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge2628" class="edge">
<title>l2_attn_stage11_gpu3&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26354.99,-7241.74C26369.92,-7235.45 26386.25,-7229.68 26402,-7226.33 26420.86,-7222.33 27082.47,-7230.06 27096,-7216.33 27121.62,-7190.35 27080.49,-7163.75 27042.04,-7146.17"/>
<polygon fill="red" stroke="red" points="27043.44,-7142.96 27032.88,-7142.12 27040.61,-7149.37 27043.44,-7142.96"/>
<text text-anchor="middle" x="27134.5" y="-7205.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu4 -->
<g id="node541" class="node">
<title>l2_attn_stage12_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25050" cy="-7124.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25050" y="-7136.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="25050" y="-7121.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25050" y="-7106.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu4&#45;&gt;l2_attn_stage12_gpu4 -->
<g id="edge741" class="edge">
<title>l2_attn_stage11_gpu4&#45;&gt;l2_attn_stage12_gpu4</title>
<path fill="none" stroke="black" d="M25050,-7234.24C25050,-7215.52 25050,-7192.53 25050,-7172.55"/>
<polygon fill="black" stroke="black" points="25053.5,-7172.41 25050,-7162.41 25046.5,-7172.41 25053.5,-7172.41"/>
</g>
<!-- l2_attn_stage11_gpu4&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge2629" class="edge">
<title>l2_attn_stage11_gpu4&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25106.98,-7241.66C25121.9,-7235.37 25138.24,-7229.62 25154,-7226.33 25192.78,-7218.24 26542.62,-7229.45 26580,-7216.33 26590.15,-7212.77 26588.9,-7205.04 26599,-7201.33 26645.34,-7184.31 26772.71,-7203.58 26821,-7193.33 26866.06,-7183.77 26914.58,-7163.04 26947.83,-7147.06"/>
<polygon fill="red" stroke="red" points="26949.76,-7150.01 26957.22,-7142.48 26946.69,-7143.72 26949.76,-7150.01"/>
<text text-anchor="middle" x="26630.5" y="-7205.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu5 -->
<g id="node542" class="node">
<title>l2_attn_stage12_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="26090" cy="-7124.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26090" y="-7136.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="26090" y="-7121.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="26090" y="-7106.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu5&#45;&gt;l2_attn_stage12_gpu5 -->
<g id="edge742" class="edge">
<title>l2_attn_stage11_gpu5&#45;&gt;l2_attn_stage12_gpu5</title>
<path fill="none" stroke="black" d="M26027.19,-7243.51C26013.64,-7237.74 25999.37,-7231.76 25986,-7226.33 25974.53,-7221.67 25967.01,-7226.54 25960,-7216.33 25956.23,-7210.84 25956.04,-7206.69 25960,-7201.33 25967.18,-7191.61 25975.05,-7198.45 25986,-7193.33 26003.44,-7185.18 26021.39,-7174.49 26037.36,-7164.02"/>
<polygon fill="black" stroke="black" points="26039.64,-7166.71 26046.02,-7158.25 26035.76,-7160.89 26039.64,-7166.71"/>
</g>
<!-- l2_attn_stage11_gpu5&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge2630" class="edge">
<title>l2_attn_stage11_gpu5&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26146.99,-7241.72C26161.91,-7235.42 26178.24,-7229.66 26194,-7226.33 26216.18,-7221.64 26994.07,-7232.46 27010,-7216.33 27026.71,-7199.42 27017.21,-7171.97 27006.15,-7151.73"/>
<polygon fill="red" stroke="red" points="27009.11,-7149.87 27001.04,-7143.01 27003.07,-7153.4 27009.11,-7149.87"/>
<text text-anchor="middle" x="27048.5" y="-7205.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu6 -->
<g id="node543" class="node">
<title>l2_attn_stage12_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="23802" cy="-7124.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="23802" y="-7136.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="23802" y="-7121.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="23802" y="-7106.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu6&#45;&gt;l2_attn_stage12_gpu6 -->
<g id="edge743" class="edge">
<title>l2_attn_stage11_gpu6&#45;&gt;l2_attn_stage12_gpu6</title>
<path fill="none" stroke="black" d="M23802,-7234.24C23802,-7215.52 23802,-7192.53 23802,-7172.55"/>
<polygon fill="black" stroke="black" points="23805.5,-7172.41 23802,-7162.41 23798.5,-7172.41 23805.5,-7172.41"/>
</g>
<!-- l2_attn_stage11_gpu6&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge2631" class="edge">
<title>l2_attn_stage11_gpu6&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23858.97,-7241.64C23873.89,-7235.34 23890.23,-7229.6 23906,-7226.33 23964.7,-7214.16 26007.42,-7236.12 26064,-7216.33 26074.16,-7212.78 26072.86,-7204.92 26083,-7201.33 26121.66,-7187.68 26780.79,-7201.34 26821,-7193.33 26866.31,-7184.31 26914.98,-7163.4 26948.21,-7147.22"/>
<polygon fill="red" stroke="red" points="26950.17,-7150.16 26957.58,-7142.58 26947.06,-7143.88 26950.17,-7150.16"/>
<text text-anchor="middle" x="26114.5" y="-7205.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu7 -->
<g id="node544" class="node">
<title>l2_attn_stage12_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="26714" cy="-7124.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26714" y="-7136.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="26714" y="-7121.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="26714" y="-7106.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu7&#45;&gt;l2_attn_stage12_gpu7 -->
<g id="edge744" class="edge">
<title>l2_attn_stage11_gpu7&#45;&gt;l2_attn_stage12_gpu7</title>
<path fill="none" stroke="black" d="M26657,-7241.76C26642.08,-7235.46 26625.75,-7229.69 26610,-7226.33 26592.91,-7222.69 25993.26,-7228.79 25981,-7216.33 25976.32,-7211.58 25976.32,-7206.08 25981,-7201.33 25993.28,-7188.9 26593.28,-7198.4 26610,-7193.33 26629.65,-7187.38 26649.09,-7176.49 26665.75,-7165.18"/>
<polygon fill="black" stroke="black" points="26668.03,-7167.85 26674.2,-7159.24 26664.01,-7162.13 26668.03,-7167.85"/>
</g>
<!-- l2_attn_stage11_gpu7&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge2632" class="edge">
<title>l2_attn_stage11_gpu7&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26773.56,-7242.41C26789.88,-7235.89 26807.81,-7229.85 26825,-7226.33 26849.12,-7221.39 27250.79,-7233.93 27268,-7216.33 27317.67,-7165.53 27230.33,-7143.22 27140.57,-7133.44"/>
<polygon fill="red" stroke="red" points="27140.78,-7129.94 27130.47,-7132.39 27140.05,-7136.9 27140.78,-7129.94"/>
<text text-anchor="middle" x="27307.5" y="-7205.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu8 -->
<g id="node545" class="node">
<title>l2_attn_stage12_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="23594" cy="-7124.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="23594" y="-7136.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="23594" y="-7121.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="23594" y="-7106.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu8&#45;&gt;l2_attn_stage12_gpu8 -->
<g id="edge745" class="edge">
<title>l2_attn_stage11_gpu8&#45;&gt;l2_attn_stage12_gpu8</title>
<path fill="none" stroke="black" d="M23594,-7234.24C23594,-7215.52 23594,-7192.53 23594,-7172.55"/>
<polygon fill="black" stroke="black" points="23597.5,-7172.41 23594,-7162.41 23590.5,-7172.41 23597.5,-7172.41"/>
</g>
<!-- l2_attn_stage11_gpu8&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge2633" class="edge">
<title>l2_attn_stage11_gpu8&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23650.98,-7241.7C23665.91,-7235.41 23682.24,-7229.65 23698,-7226.33 23947.97,-7173.68 25741.55,-7203.96 25997,-7201.33 26042.78,-7200.86 26776.1,-7202.24 26821,-7193.33 26866.32,-7184.34 26914.98,-7163.42 26948.21,-7147.23"/>
<polygon fill="red" stroke="red" points="26950.17,-7150.17 26957.58,-7142.6 26947.06,-7143.9 26950.17,-7150.17"/>
<text text-anchor="middle" x="26028.5" y="-7205.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu9 -->
<g id="node546" class="node">
<title>l2_attn_stage12_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26506" cy="-7124.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26506" y="-7136.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="26506" y="-7121.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26506" y="-7106.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu9&#45;&gt;l2_attn_stage12_gpu9 -->
<g id="edge746" class="edge">
<title>l2_attn_stage11_gpu9&#45;&gt;l2_attn_stage12_gpu9</title>
<path fill="none" stroke="black" d="M26448.71,-7241.73C26433.86,-7235.47 26417.64,-7229.73 26402,-7226.33 26378.76,-7221.28 25990.62,-7233.35 25974,-7216.33 25969.34,-7211.56 25969.33,-7206.09 25974,-7201.33 25982.33,-7192.85 26390.63,-7196.81 26402,-7193.33 26421.63,-7187.32 26441.07,-7176.42 26457.73,-7165.11"/>
<polygon fill="black" stroke="black" points="26460.01,-7167.79 26466.18,-7159.18 26455.99,-7162.06 26460.01,-7167.79"/>
</g>
<!-- l2_attn_stage11_gpu9&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge2634" class="edge">
<title>l2_attn_stage11_gpu9&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26563,-7241.78C26577.92,-7235.48 26594.25,-7229.7 26610,-7226.33 26625.54,-7223.01 27170.86,-7227.67 27182,-7216.33 27218.88,-7178.8 27155.24,-7155.04 27091.37,-7141.33"/>
<polygon fill="red" stroke="red" points="27092.05,-7137.9 27081.55,-7139.3 27090.63,-7144.75 27092.05,-7137.9"/>
<text text-anchor="middle" x="27221.5" y="-7205.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu10 -->
<g id="node547" class="node">
<title>l2_attn_stage12_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="24010" cy="-7124.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24010" y="-7136.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="24010" y="-7121.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="24010" y="-7106.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu10&#45;&gt;l2_attn_stage12_gpu10 -->
<g id="edge747" class="edge">
<title>l2_attn_stage11_gpu10&#45;&gt;l2_attn_stage12_gpu10</title>
<path fill="none" stroke="black" d="M24010,-7234.24C24010,-7215.52 24010,-7192.53 24010,-7172.55"/>
<polygon fill="black" stroke="black" points="24013.5,-7172.41 24010,-7162.41 24006.5,-7172.41 24013.5,-7172.41"/>
</g>
<!-- l2_attn_stage11_gpu10&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge2635" class="edge">
<title>l2_attn_stage11_gpu10&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24066.97,-7241.64C24081.89,-7235.35 24098.23,-7229.6 24114,-7226.33 24169.38,-7214.84 26096.62,-7235.01 26150,-7216.33 26160.16,-7212.78 26158.86,-7204.92 26169,-7201.33 26203.15,-7189.24 26785.48,-7200.43 26821,-7193.33 26866.31,-7184.28 26914.97,-7163.37 26948.2,-7147.2"/>
<polygon fill="red" stroke="red" points="26950.16,-7150.14 26957.57,-7142.57 26947.06,-7143.86 26950.16,-7150.14"/>
<text text-anchor="middle" x="26200.5" y="-7205.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu11 -->
<g id="node548" class="node">
<title>l2_attn_stage12_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="25258" cy="-7124.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25258" y="-7136.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="25258" y="-7121.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="25258" y="-7106.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu11&#45;&gt;l2_attn_stage12_gpu11 -->
<g id="edge748" class="edge">
<title>l2_attn_stage11_gpu11&#45;&gt;l2_attn_stage12_gpu11</title>
<path fill="none" stroke="black" d="M25258,-7234.24C25258,-7215.52 25258,-7192.53 25258,-7172.55"/>
<polygon fill="black" stroke="black" points="25261.5,-7172.41 25258,-7162.41 25254.5,-7172.41 25261.5,-7172.41"/>
</g>
<!-- l2_attn_stage11_gpu11&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge2636" class="edge">
<title>l2_attn_stage11_gpu11&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25314.98,-7241.67C25329.9,-7235.38 25346.24,-7229.63 25362,-7226.33 25432.91,-7211.51 26597.65,-7240.35 26666,-7216.33 26676.15,-7212.76 26674.94,-7205.16 26685,-7201.33 26713.3,-7190.57 26791.46,-7199.95 26821,-7193.33 26865.67,-7183.33 26913.88,-7162.86 26947.15,-7147.07"/>
<polygon fill="red" stroke="red" points="26949.06,-7150.04 26956.55,-7142.55 26946.02,-7143.73 26949.06,-7150.04"/>
<text text-anchor="middle" x="26716.5" y="-7205.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu12 -->
<g id="node549" class="node">
<title>l2_attn_stage12_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="24218" cy="-7124.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24218" y="-7136.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="24218" y="-7121.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="24218" y="-7106.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu12&#45;&gt;l2_attn_stage12_gpu12 -->
<g id="edge749" class="edge">
<title>l2_attn_stage11_gpu12&#45;&gt;l2_attn_stage12_gpu12</title>
<path fill="none" stroke="black" d="M24218,-7234.24C24218,-7215.52 24218,-7192.53 24218,-7172.55"/>
<polygon fill="black" stroke="black" points="24221.5,-7172.41 24218,-7162.41 24214.5,-7172.41 24221.5,-7172.41"/>
</g>
<!-- l2_attn_stage11_gpu12&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge2637" class="edge">
<title>l2_attn_stage11_gpu12&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24274.97,-7241.64C24289.9,-7235.35 24306.23,-7229.61 24322,-7226.33 24374.06,-7215.52 26185.82,-7233.9 26236,-7216.33 26246.15,-7212.78 26244.86,-7204.93 26255,-7201.33 26284.63,-7190.81 26790.17,-7199.52 26821,-7193.33 26866.3,-7184.24 26914.97,-7163.33 26948.2,-7147.18"/>
<polygon fill="red" stroke="red" points="26950.15,-7150.12 26957.57,-7142.55 26947.05,-7143.84 26950.15,-7150.12"/>
<text text-anchor="middle" x="26286.5" y="-7205.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu13 -->
<g id="node550" class="node">
<title>l2_attn_stage12_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="25466" cy="-7124.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25466" y="-7136.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="25466" y="-7121.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="25466" y="-7106.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu13&#45;&gt;l2_attn_stage12_gpu13 -->
<g id="edge750" class="edge">
<title>l2_attn_stage11_gpu13&#45;&gt;l2_attn_stage12_gpu13</title>
<path fill="none" stroke="black" d="M25466,-7234.24C25466,-7215.52 25466,-7192.53 25466,-7172.55"/>
<polygon fill="black" stroke="black" points="25469.5,-7172.41 25466,-7162.41 25462.5,-7172.41 25469.5,-7172.41"/>
</g>
<!-- l2_attn_stage11_gpu13&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge2638" class="edge">
<title>l2_attn_stage11_gpu13&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25522.98,-7241.68C25537.9,-7235.38 25554.24,-7229.63 25570,-7226.33 25634.28,-7212.88 26690.05,-7238.13 26752,-7216.33 26762.15,-7212.76 26761.15,-7205.65 26771,-7201.33 26791.61,-7192.29 26799.31,-7199.34 26821,-7193.33 26864.28,-7181.34 26911.59,-7161.7 26944.94,-7146.69"/>
<polygon fill="red" stroke="red" points="26946.74,-7149.72 26954.4,-7142.4 26943.84,-7143.35 26946.74,-7149.72"/>
<text text-anchor="middle" x="26802.5" y="-7205.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu14 -->
<g id="node551" class="node">
<title>l2_attn_stage12_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="24634" cy="-7124.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24634" y="-7136.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="24634" y="-7121.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="24634" y="-7106.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu14&#45;&gt;l2_attn_stage12_gpu14 -->
<g id="edge751" class="edge">
<title>l2_attn_stage11_gpu14&#45;&gt;l2_attn_stage12_gpu14</title>
<path fill="none" stroke="black" d="M24634,-7234.24C24634,-7215.52 24634,-7192.53 24634,-7172.55"/>
<polygon fill="black" stroke="black" points="24637.5,-7172.41 24634,-7162.41 24630.5,-7172.41 24637.5,-7172.41"/>
</g>
<!-- l2_attn_stage11_gpu14&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge2639" class="edge">
<title>l2_attn_stage11_gpu14&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24690.97,-7241.65C24705.9,-7235.36 24722.23,-7229.61 24738,-7226.33 24783.42,-7216.88 26364.22,-7231.68 26408,-7216.33 26418.15,-7212.77 26416.87,-7204.96 26427,-7201.33 26468.22,-7186.55 26778.1,-7202.08 26821,-7193.33 26866.27,-7184.1 26914.94,-7163.22 26948.18,-7147.1"/>
<polygon fill="red" stroke="red" points="26950.13,-7150.05 26957.56,-7142.49 26947.04,-7143.77 26950.13,-7150.05"/>
<text text-anchor="middle" x="26458.5" y="-7205.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu15 -->
<g id="node552" class="node">
<title>l2_attn_stage12_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="25674" cy="-7124.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25674" y="-7136.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="25674" y="-7121.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="25674" y="-7106.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu15&#45;&gt;l2_attn_stage12_gpu15 -->
<g id="edge752" class="edge">
<title>l2_attn_stage11_gpu15&#45;&gt;l2_attn_stage12_gpu15</title>
<path fill="none" stroke="black" d="M25674,-7234.24C25674,-7215.52 25674,-7192.53 25674,-7172.55"/>
<polygon fill="black" stroke="black" points="25677.5,-7172.41 25674,-7162.41 25670.5,-7172.41 25677.5,-7172.41"/>
</g>
<!-- l2_attn_stage11_gpu15&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge2640" class="edge">
<title>l2_attn_stage11_gpu15&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25730.98,-7241.69C25745.91,-7235.39 25762.24,-7229.64 25778,-7226.33 25835.64,-7214.24 26782.46,-7235.91 26838,-7216.33 26848.15,-7212.76 26848.08,-7207.35 26857,-7201.33 26886.36,-7181.51 26921.2,-7161.72 26947.72,-7147.38"/>
<polygon fill="red" stroke="red" points="26949.57,-7150.36 26956.73,-7142.55 26946.26,-7144.19 26949.57,-7150.36"/>
<text text-anchor="middle" x="26888.5" y="-7205.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu0 -->
<g id="node553" class="node">
<title>l2_attn_stage13_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24842" cy="-6977.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24842" y="-6989.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="24842" y="-6974.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24842" y="-6959.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu0&#45;&gt;l2_attn_stage13_gpu0 -->
<g id="edge753" class="edge">
<title>l2_attn_stage12_gpu0&#45;&gt;l2_attn_stage13_gpu0</title>
<path fill="none" stroke="black" d="M24842,-7087.24C24842,-7068.52 24842,-7045.53 24842,-7025.55"/>
<polygon fill="black" stroke="black" points="24845.5,-7025.41 24842,-7015.41 24838.5,-7025.41 24845.5,-7025.41"/>
</g>
<!-- l2_attn_stage13_gpu[next_gpu] -->
<g id="node1372" class="node">
<title>l2_attn_stage13_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="26989" cy="-6977.83" rx="155.5" ry="18"/>
<text text-anchor="middle" x="26989" y="-6974.13" font-family="Times,serif" font-size="14.00">l2_attn_stage13_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage12_gpu0&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge2641" class="edge">
<title>l2_attn_stage12_gpu0&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24898.97,-7094.66C24913.9,-7088.36 24930.23,-7082.62 24946,-7079.33 24988.1,-7070.56 26453.42,-7083.57 26494,-7069.33 26504.15,-7065.77 26502.88,-7057.99 26513,-7054.33 26545.19,-7042.69 26787.48,-7053.27 26821,-7046.33 26866.11,-7037 26914.62,-7016.24 26947.86,-7000.18"/>
<polygon fill="red" stroke="red" points="26949.8,-7003.13 26957.24,-6995.58 26946.72,-6996.84 26949.8,-7003.13"/>
<text text-anchor="middle" x="26544.5" y="-7058.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu1 -->
<g id="node554" class="node">
<title>l2_attn_stage13_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24426" cy="-6977.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24426" y="-6989.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="24426" y="-6974.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24426" y="-6959.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu1&#45;&gt;l2_attn_stage13_gpu1 -->
<g id="edge754" class="edge">
<title>l2_attn_stage12_gpu1&#45;&gt;l2_attn_stage13_gpu1</title>
<path fill="none" stroke="black" d="M24426,-7087.24C24426,-7068.52 24426,-7045.53 24426,-7025.55"/>
<polygon fill="black" stroke="black" points="24429.5,-7025.41 24426,-7015.41 24422.5,-7025.41 24429.5,-7025.41"/>
</g>
<!-- l2_attn_stage12_gpu1&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge2642" class="edge">
<title>l2_attn_stage12_gpu1&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24482.97,-7094.65C24497.9,-7088.35 24514.23,-7082.61 24530,-7079.33 24578.74,-7069.2 26275.02,-7085.79 26322,-7069.33 26332.15,-7065.78 26330.87,-7057.95 26341,-7054.33 26391.24,-7036.42 26768.72,-7056.9 26821,-7046.33 26866.29,-7037.18 26914.96,-7016.29 26948.19,-7000.15"/>
<polygon fill="red" stroke="red" points="26950.14,-7003.09 26957.56,-6995.53 26947.05,-6996.81 26950.14,-7003.09"/>
<text text-anchor="middle" x="26372.5" y="-7058.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu2 -->
<g id="node555" class="node">
<title>l2_attn_stage13_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25882" cy="-6977.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25882" y="-6989.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="25882" y="-6974.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25882" y="-6959.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu2&#45;&gt;l2_attn_stage13_gpu2 -->
<g id="edge755" class="edge">
<title>l2_attn_stage12_gpu2&#45;&gt;l2_attn_stage13_gpu2</title>
<path fill="none" stroke="black" d="M25882,-7087.24C25882,-7068.52 25882,-7045.53 25882,-7025.55"/>
<polygon fill="black" stroke="black" points="25885.5,-7025.41 25882,-7015.41 25878.5,-7025.41 25885.5,-7025.41"/>
</g>
<!-- l2_attn_stage12_gpu2&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge2643" class="edge">
<title>l2_attn_stage12_gpu2&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25938.98,-7094.7C25953.91,-7088.41 25970.24,-7082.65 25986,-7079.33 26011.5,-7073.96 26900.88,-7081.35 26924,-7069.33 26937.7,-7062.21 26959.58,-7028.79 26974.12,-7004.63"/>
<polygon fill="red" stroke="red" points="26977.21,-7006.29 26979.3,-6995.9 26971.19,-7002.72 26977.21,-7006.29"/>
<text text-anchor="middle" x="26970.5" y="-7058.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu3 -->
<g id="node556" class="node">
<title>l2_attn_stage13_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26298" cy="-6977.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26298" y="-6989.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="26298" y="-6974.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26298" y="-6959.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu3&#45;&gt;l2_attn_stage13_gpu3 -->
<g id="edge756" class="edge">
<title>l2_attn_stage12_gpu3&#45;&gt;l2_attn_stage13_gpu3</title>
<path fill="none" stroke="black" d="M26240.39,-7094.84C26225.62,-7088.62 26209.51,-7082.87 26194,-7079.33 26169.39,-7073.72 25984.45,-7087.57 25967,-7069.33 25962.39,-7064.52 25962.37,-7059.13 25967,-7054.33 25975.76,-7045.25 26181.97,-7050.13 26194,-7046.33 26213.58,-7040.16 26233,-7029.22 26249.67,-7017.91"/>
<polygon fill="black" stroke="black" points="26251.94,-7020.6 26258.13,-7012 26247.93,-7014.87 26251.94,-7020.6"/>
</g>
<!-- l2_attn_stage12_gpu3&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge2644" class="edge">
<title>l2_attn_stage12_gpu3&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26354.99,-7094.74C26369.92,-7088.45 26386.25,-7082.68 26402,-7079.33 26420.86,-7075.33 27082.47,-7083.06 27096,-7069.33 27121.62,-7043.35 27080.49,-7016.75 27042.04,-6999.17"/>
<polygon fill="red" stroke="red" points="27043.44,-6995.96 27032.88,-6995.12 27040.61,-7002.37 27043.44,-6995.96"/>
<text text-anchor="middle" x="27134.5" y="-7058.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu4 -->
<g id="node557" class="node">
<title>l2_attn_stage13_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25050" cy="-6977.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25050" y="-6989.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="25050" y="-6974.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25050" y="-6959.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu4&#45;&gt;l2_attn_stage13_gpu4 -->
<g id="edge757" class="edge">
<title>l2_attn_stage12_gpu4&#45;&gt;l2_attn_stage13_gpu4</title>
<path fill="none" stroke="black" d="M25050,-7087.24C25050,-7068.52 25050,-7045.53 25050,-7025.55"/>
<polygon fill="black" stroke="black" points="25053.5,-7025.41 25050,-7015.41 25046.5,-7025.41 25053.5,-7025.41"/>
</g>
<!-- l2_attn_stage12_gpu4&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge2645" class="edge">
<title>l2_attn_stage12_gpu4&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25106.98,-7094.66C25121.9,-7088.37 25138.24,-7082.62 25154,-7079.33 25192.78,-7071.24 26542.62,-7082.45 26580,-7069.33 26590.15,-7065.77 26588.9,-7058.04 26599,-7054.33 26645.34,-7037.31 26772.71,-7056.58 26821,-7046.33 26866.06,-7036.77 26914.58,-7016.04 26947.83,-7000.06"/>
<polygon fill="red" stroke="red" points="26949.76,-7003.01 26957.22,-6995.48 26946.69,-6996.72 26949.76,-7003.01"/>
<text text-anchor="middle" x="26630.5" y="-7058.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu5 -->
<g id="node558" class="node">
<title>l2_attn_stage13_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="26090" cy="-6977.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26090" y="-6989.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="26090" y="-6974.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="26090" y="-6959.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu5&#45;&gt;l2_attn_stage13_gpu5 -->
<g id="edge758" class="edge">
<title>l2_attn_stage12_gpu5&#45;&gt;l2_attn_stage13_gpu5</title>
<path fill="none" stroke="black" d="M26027.19,-7096.51C26013.64,-7090.74 25999.37,-7084.76 25986,-7079.33 25974.53,-7074.67 25967.01,-7079.54 25960,-7069.33 25956.23,-7063.84 25956.04,-7059.69 25960,-7054.33 25967.18,-7044.61 25975.05,-7051.45 25986,-7046.33 26003.44,-7038.18 26021.39,-7027.49 26037.36,-7017.02"/>
<polygon fill="black" stroke="black" points="26039.64,-7019.71 26046.02,-7011.25 26035.76,-7013.89 26039.64,-7019.71"/>
</g>
<!-- l2_attn_stage12_gpu5&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge2646" class="edge">
<title>l2_attn_stage12_gpu5&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26146.99,-7094.72C26161.91,-7088.42 26178.24,-7082.66 26194,-7079.33 26216.18,-7074.64 26994.07,-7085.46 27010,-7069.33 27026.71,-7052.42 27017.21,-7024.97 27006.15,-7004.73"/>
<polygon fill="red" stroke="red" points="27009.11,-7002.87 27001.04,-6996.01 27003.07,-7006.4 27009.11,-7002.87"/>
<text text-anchor="middle" x="27048.5" y="-7058.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu6 -->
<g id="node559" class="node">
<title>l2_attn_stage13_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="23802" cy="-6977.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="23802" y="-6989.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="23802" y="-6974.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="23802" y="-6959.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu6&#45;&gt;l2_attn_stage13_gpu6 -->
<g id="edge759" class="edge">
<title>l2_attn_stage12_gpu6&#45;&gt;l2_attn_stage13_gpu6</title>
<path fill="none" stroke="black" d="M23802,-7087.24C23802,-7068.52 23802,-7045.53 23802,-7025.55"/>
<polygon fill="black" stroke="black" points="23805.5,-7025.41 23802,-7015.41 23798.5,-7025.41 23805.5,-7025.41"/>
</g>
<!-- l2_attn_stage12_gpu6&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge2647" class="edge">
<title>l2_attn_stage12_gpu6&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23858.97,-7094.64C23873.89,-7088.34 23890.23,-7082.6 23906,-7079.33 23964.7,-7067.16 26007.42,-7089.12 26064,-7069.33 26074.16,-7065.78 26072.86,-7057.92 26083,-7054.33 26121.66,-7040.68 26780.79,-7054.34 26821,-7046.33 26866.31,-7037.31 26914.98,-7016.4 26948.21,-7000.22"/>
<polygon fill="red" stroke="red" points="26950.17,-7003.16 26957.58,-6995.58 26947.06,-6996.88 26950.17,-7003.16"/>
<text text-anchor="middle" x="26114.5" y="-7058.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu7 -->
<g id="node560" class="node">
<title>l2_attn_stage13_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="26714" cy="-6977.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26714" y="-6989.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="26714" y="-6974.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="26714" y="-6959.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu7&#45;&gt;l2_attn_stage13_gpu7 -->
<g id="edge760" class="edge">
<title>l2_attn_stage12_gpu7&#45;&gt;l2_attn_stage13_gpu7</title>
<path fill="none" stroke="black" d="M26657,-7094.76C26642.08,-7088.46 26625.75,-7082.69 26610,-7079.33 26592.91,-7075.69 25993.26,-7081.79 25981,-7069.33 25976.32,-7064.58 25976.32,-7059.08 25981,-7054.33 25993.28,-7041.9 26593.28,-7051.4 26610,-7046.33 26629.65,-7040.38 26649.09,-7029.49 26665.75,-7018.18"/>
<polygon fill="black" stroke="black" points="26668.03,-7020.85 26674.2,-7012.24 26664.01,-7015.13 26668.03,-7020.85"/>
</g>
<!-- l2_attn_stage12_gpu7&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge2648" class="edge">
<title>l2_attn_stage12_gpu7&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26773.56,-7095.41C26789.88,-7088.89 26807.81,-7082.85 26825,-7079.33 26849.12,-7074.39 27250.79,-7086.93 27268,-7069.33 27317.67,-7018.53 27230.33,-6996.22 27140.57,-6986.44"/>
<polygon fill="red" stroke="red" points="27140.78,-6982.94 27130.47,-6985.39 27140.05,-6989.9 27140.78,-6982.94"/>
<text text-anchor="middle" x="27307.5" y="-7058.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu8 -->
<g id="node561" class="node">
<title>l2_attn_stage13_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="23594" cy="-6977.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="23594" y="-6989.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="23594" y="-6974.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="23594" y="-6959.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu8&#45;&gt;l2_attn_stage13_gpu8 -->
<g id="edge761" class="edge">
<title>l2_attn_stage12_gpu8&#45;&gt;l2_attn_stage13_gpu8</title>
<path fill="none" stroke="black" d="M23594,-7087.24C23594,-7068.52 23594,-7045.53 23594,-7025.55"/>
<polygon fill="black" stroke="black" points="23597.5,-7025.41 23594,-7015.41 23590.5,-7025.41 23597.5,-7025.41"/>
</g>
<!-- l2_attn_stage12_gpu8&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge2649" class="edge">
<title>l2_attn_stage12_gpu8&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23650.98,-7094.7C23665.91,-7088.41 23682.24,-7082.65 23698,-7079.33 23947.97,-7026.68 25741.55,-7056.96 25997,-7054.33 26042.78,-7053.86 26776.1,-7055.24 26821,-7046.33 26866.32,-7037.34 26914.98,-7016.42 26948.21,-7000.23"/>
<polygon fill="red" stroke="red" points="26950.17,-7003.17 26957.58,-6995.6 26947.06,-6996.9 26950.17,-7003.17"/>
<text text-anchor="middle" x="26028.5" y="-7058.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu9 -->
<g id="node562" class="node">
<title>l2_attn_stage13_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26506" cy="-6977.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26506" y="-6989.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="26506" y="-6974.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26506" y="-6959.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu9&#45;&gt;l2_attn_stage13_gpu9 -->
<g id="edge762" class="edge">
<title>l2_attn_stage12_gpu9&#45;&gt;l2_attn_stage13_gpu9</title>
<path fill="none" stroke="black" d="M26448.71,-7094.73C26433.86,-7088.47 26417.64,-7082.73 26402,-7079.33 26378.76,-7074.28 25990.62,-7086.35 25974,-7069.33 25969.34,-7064.56 25969.33,-7059.09 25974,-7054.33 25982.33,-7045.85 26390.63,-7049.81 26402,-7046.33 26421.63,-7040.32 26441.07,-7029.42 26457.73,-7018.11"/>
<polygon fill="black" stroke="black" points="26460.01,-7020.79 26466.18,-7012.18 26455.99,-7015.06 26460.01,-7020.79"/>
</g>
<!-- l2_attn_stage12_gpu9&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge2650" class="edge">
<title>l2_attn_stage12_gpu9&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26563,-7094.78C26577.92,-7088.48 26594.25,-7082.7 26610,-7079.33 26625.54,-7076.01 27170.86,-7080.67 27182,-7069.33 27218.88,-7031.8 27155.24,-7008.04 27091.37,-6994.33"/>
<polygon fill="red" stroke="red" points="27092.05,-6990.9 27081.55,-6992.3 27090.63,-6997.75 27092.05,-6990.9"/>
<text text-anchor="middle" x="27221.5" y="-7058.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu10 -->
<g id="node563" class="node">
<title>l2_attn_stage13_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="24010" cy="-6977.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24010" y="-6989.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="24010" y="-6974.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="24010" y="-6959.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu10&#45;&gt;l2_attn_stage13_gpu10 -->
<g id="edge763" class="edge">
<title>l2_attn_stage12_gpu10&#45;&gt;l2_attn_stage13_gpu10</title>
<path fill="none" stroke="black" d="M24010,-7087.24C24010,-7068.52 24010,-7045.53 24010,-7025.55"/>
<polygon fill="black" stroke="black" points="24013.5,-7025.41 24010,-7015.41 24006.5,-7025.41 24013.5,-7025.41"/>
</g>
<!-- l2_attn_stage12_gpu10&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge2651" class="edge">
<title>l2_attn_stage12_gpu10&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24066.97,-7094.64C24081.89,-7088.35 24098.23,-7082.6 24114,-7079.33 24169.38,-7067.84 26096.62,-7088.01 26150,-7069.33 26160.16,-7065.78 26158.86,-7057.92 26169,-7054.33 26203.15,-7042.24 26785.48,-7053.43 26821,-7046.33 26866.31,-7037.28 26914.97,-7016.37 26948.2,-7000.2"/>
<polygon fill="red" stroke="red" points="26950.16,-7003.14 26957.57,-6995.57 26947.06,-6996.86 26950.16,-7003.14"/>
<text text-anchor="middle" x="26200.5" y="-7058.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu11 -->
<g id="node564" class="node">
<title>l2_attn_stage13_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="25258" cy="-6977.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25258" y="-6989.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="25258" y="-6974.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="25258" y="-6959.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu11&#45;&gt;l2_attn_stage13_gpu11 -->
<g id="edge764" class="edge">
<title>l2_attn_stage12_gpu11&#45;&gt;l2_attn_stage13_gpu11</title>
<path fill="none" stroke="black" d="M25258,-7087.24C25258,-7068.52 25258,-7045.53 25258,-7025.55"/>
<polygon fill="black" stroke="black" points="25261.5,-7025.41 25258,-7015.41 25254.5,-7025.41 25261.5,-7025.41"/>
</g>
<!-- l2_attn_stage12_gpu11&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge2652" class="edge">
<title>l2_attn_stage12_gpu11&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25314.98,-7094.67C25329.9,-7088.38 25346.24,-7082.63 25362,-7079.33 25432.91,-7064.51 26597.65,-7093.35 26666,-7069.33 26676.15,-7065.76 26674.94,-7058.16 26685,-7054.33 26713.3,-7043.57 26791.46,-7052.95 26821,-7046.33 26865.67,-7036.33 26913.88,-7015.86 26947.15,-7000.07"/>
<polygon fill="red" stroke="red" points="26949.06,-7003.04 26956.55,-6995.55 26946.02,-6996.73 26949.06,-7003.04"/>
<text text-anchor="middle" x="26716.5" y="-7058.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu12 -->
<g id="node565" class="node">
<title>l2_attn_stage13_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="24218" cy="-6977.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24218" y="-6989.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="24218" y="-6974.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="24218" y="-6959.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu12&#45;&gt;l2_attn_stage13_gpu12 -->
<g id="edge765" class="edge">
<title>l2_attn_stage12_gpu12&#45;&gt;l2_attn_stage13_gpu12</title>
<path fill="none" stroke="black" d="M24218,-7087.24C24218,-7068.52 24218,-7045.53 24218,-7025.55"/>
<polygon fill="black" stroke="black" points="24221.5,-7025.41 24218,-7015.41 24214.5,-7025.41 24221.5,-7025.41"/>
</g>
<!-- l2_attn_stage12_gpu12&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge2653" class="edge">
<title>l2_attn_stage12_gpu12&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24274.97,-7094.64C24289.9,-7088.35 24306.23,-7082.61 24322,-7079.33 24374.06,-7068.52 26185.82,-7086.9 26236,-7069.33 26246.15,-7065.78 26244.86,-7057.93 26255,-7054.33 26284.63,-7043.81 26790.17,-7052.52 26821,-7046.33 26866.3,-7037.24 26914.97,-7016.33 26948.2,-7000.18"/>
<polygon fill="red" stroke="red" points="26950.15,-7003.12 26957.57,-6995.55 26947.05,-6996.84 26950.15,-7003.12"/>
<text text-anchor="middle" x="26286.5" y="-7058.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu13 -->
<g id="node566" class="node">
<title>l2_attn_stage13_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="25466" cy="-6977.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25466" y="-6989.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="25466" y="-6974.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="25466" y="-6959.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu13&#45;&gt;l2_attn_stage13_gpu13 -->
<g id="edge766" class="edge">
<title>l2_attn_stage12_gpu13&#45;&gt;l2_attn_stage13_gpu13</title>
<path fill="none" stroke="black" d="M25466,-7087.24C25466,-7068.52 25466,-7045.53 25466,-7025.55"/>
<polygon fill="black" stroke="black" points="25469.5,-7025.41 25466,-7015.41 25462.5,-7025.41 25469.5,-7025.41"/>
</g>
<!-- l2_attn_stage12_gpu13&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge2654" class="edge">
<title>l2_attn_stage12_gpu13&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25522.98,-7094.68C25537.9,-7088.38 25554.24,-7082.63 25570,-7079.33 25634.28,-7065.88 26690.05,-7091.13 26752,-7069.33 26762.15,-7065.76 26761.15,-7058.65 26771,-7054.33 26791.61,-7045.29 26799.31,-7052.34 26821,-7046.33 26864.28,-7034.34 26911.59,-7014.7 26944.94,-6999.69"/>
<polygon fill="red" stroke="red" points="26946.74,-7002.72 26954.4,-6995.4 26943.84,-6996.35 26946.74,-7002.72"/>
<text text-anchor="middle" x="26802.5" y="-7058.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu14 -->
<g id="node567" class="node">
<title>l2_attn_stage13_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="24634" cy="-6977.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24634" y="-6989.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="24634" y="-6974.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="24634" y="-6959.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu14&#45;&gt;l2_attn_stage13_gpu14 -->
<g id="edge767" class="edge">
<title>l2_attn_stage12_gpu14&#45;&gt;l2_attn_stage13_gpu14</title>
<path fill="none" stroke="black" d="M24634,-7087.24C24634,-7068.52 24634,-7045.53 24634,-7025.55"/>
<polygon fill="black" stroke="black" points="24637.5,-7025.41 24634,-7015.41 24630.5,-7025.41 24637.5,-7025.41"/>
</g>
<!-- l2_attn_stage12_gpu14&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge2655" class="edge">
<title>l2_attn_stage12_gpu14&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24690.97,-7094.65C24705.9,-7088.36 24722.23,-7082.61 24738,-7079.33 24783.42,-7069.88 26364.22,-7084.68 26408,-7069.33 26418.15,-7065.77 26416.87,-7057.96 26427,-7054.33 26468.22,-7039.55 26778.1,-7055.08 26821,-7046.33 26866.27,-7037.1 26914.94,-7016.22 26948.18,-7000.1"/>
<polygon fill="red" stroke="red" points="26950.13,-7003.05 26957.56,-6995.49 26947.04,-6996.77 26950.13,-7003.05"/>
<text text-anchor="middle" x="26458.5" y="-7058.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu15 -->
<g id="node568" class="node">
<title>l2_attn_stage13_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="25674" cy="-6977.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25674" y="-6989.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="25674" y="-6974.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="25674" y="-6959.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu15&#45;&gt;l2_attn_stage13_gpu15 -->
<g id="edge768" class="edge">
<title>l2_attn_stage12_gpu15&#45;&gt;l2_attn_stage13_gpu15</title>
<path fill="none" stroke="black" d="M25674,-7087.24C25674,-7068.52 25674,-7045.53 25674,-7025.55"/>
<polygon fill="black" stroke="black" points="25677.5,-7025.41 25674,-7015.41 25670.5,-7025.41 25677.5,-7025.41"/>
</g>
<!-- l2_attn_stage12_gpu15&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge2656" class="edge">
<title>l2_attn_stage12_gpu15&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25730.98,-7094.69C25745.91,-7088.39 25762.24,-7082.64 25778,-7079.33 25835.64,-7067.24 26782.46,-7088.91 26838,-7069.33 26848.15,-7065.76 26848.08,-7060.35 26857,-7054.33 26886.36,-7034.51 26921.2,-7014.72 26947.72,-7000.38"/>
<polygon fill="red" stroke="red" points="26949.57,-7003.36 26956.73,-6995.55 26946.26,-6997.19 26949.57,-7003.36"/>
<text text-anchor="middle" x="26888.5" y="-7058.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu0 -->
<g id="node569" class="node">
<title>l2_attn_stage14_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="24842" cy="-6830.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24842" y="-6842.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="24842" y="-6827.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="24842" y="-6812.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu0&#45;&gt;l2_attn_stage14_gpu0 -->
<g id="edge769" class="edge">
<title>l2_attn_stage13_gpu0&#45;&gt;l2_attn_stage14_gpu0</title>
<path fill="none" stroke="black" d="M24842,-6940.24C24842,-6921.52 24842,-6898.53 24842,-6878.55"/>
<polygon fill="black" stroke="black" points="24845.5,-6878.41 24842,-6868.41 24838.5,-6878.41 24845.5,-6878.41"/>
</g>
<!-- l2_attn_stage14_gpu[next_gpu] -->
<g id="node1373" class="node">
<title>l2_attn_stage14_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="26989" cy="-6830.83" rx="155.5" ry="18"/>
<text text-anchor="middle" x="26989" y="-6827.13" font-family="Times,serif" font-size="14.00">l2_attn_stage14_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage13_gpu0&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge2657" class="edge">
<title>l2_attn_stage13_gpu0&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24898.97,-6947.66C24913.9,-6941.36 24930.23,-6935.62 24946,-6932.33 24988.1,-6923.56 26453.42,-6936.57 26494,-6922.33 26504.15,-6918.77 26502.88,-6910.99 26513,-6907.33 26545.19,-6895.69 26787.48,-6906.27 26821,-6899.33 26866.11,-6890 26914.62,-6869.24 26947.86,-6853.18"/>
<polygon fill="red" stroke="red" points="26949.8,-6856.13 26957.24,-6848.58 26946.72,-6849.84 26949.8,-6856.13"/>
<text text-anchor="middle" x="26544.5" y="-6911.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu1 -->
<g id="node570" class="node">
<title>l2_attn_stage14_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="24426" cy="-6830.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24426" y="-6842.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="24426" y="-6827.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="24426" y="-6812.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu1&#45;&gt;l2_attn_stage14_gpu1 -->
<g id="edge770" class="edge">
<title>l2_attn_stage13_gpu1&#45;&gt;l2_attn_stage14_gpu1</title>
<path fill="none" stroke="black" d="M24426,-6940.24C24426,-6921.52 24426,-6898.53 24426,-6878.55"/>
<polygon fill="black" stroke="black" points="24429.5,-6878.41 24426,-6868.41 24422.5,-6878.41 24429.5,-6878.41"/>
</g>
<!-- l2_attn_stage13_gpu1&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge2658" class="edge">
<title>l2_attn_stage13_gpu1&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24482.97,-6947.65C24497.9,-6941.35 24514.23,-6935.61 24530,-6932.33 24578.74,-6922.2 26275.02,-6938.79 26322,-6922.33 26332.15,-6918.78 26330.87,-6910.95 26341,-6907.33 26391.24,-6889.42 26768.72,-6909.9 26821,-6899.33 26866.29,-6890.18 26914.96,-6869.29 26948.19,-6853.15"/>
<polygon fill="red" stroke="red" points="26950.14,-6856.09 26957.56,-6848.53 26947.05,-6849.81 26950.14,-6856.09"/>
<text text-anchor="middle" x="26372.5" y="-6911.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu2 -->
<g id="node571" class="node">
<title>l2_attn_stage14_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="25882" cy="-6830.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25882" y="-6842.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="25882" y="-6827.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="25882" y="-6812.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu2&#45;&gt;l2_attn_stage14_gpu2 -->
<g id="edge771" class="edge">
<title>l2_attn_stage13_gpu2&#45;&gt;l2_attn_stage14_gpu2</title>
<path fill="none" stroke="black" d="M25882,-6940.24C25882,-6921.52 25882,-6898.53 25882,-6878.55"/>
<polygon fill="black" stroke="black" points="25885.5,-6878.41 25882,-6868.41 25878.5,-6878.41 25885.5,-6878.41"/>
</g>
<!-- l2_attn_stage13_gpu2&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge2659" class="edge">
<title>l2_attn_stage13_gpu2&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25938.98,-6947.7C25953.91,-6941.41 25970.24,-6935.65 25986,-6932.33 26011.5,-6926.96 26900.88,-6934.35 26924,-6922.33 26937.7,-6915.21 26959.58,-6881.79 26974.12,-6857.63"/>
<polygon fill="red" stroke="red" points="26977.21,-6859.29 26979.3,-6848.9 26971.19,-6855.72 26977.21,-6859.29"/>
<text text-anchor="middle" x="26970.5" y="-6911.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu3 -->
<g id="node572" class="node">
<title>l2_attn_stage14_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="26298" cy="-6830.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26298" y="-6842.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="26298" y="-6827.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="26298" y="-6812.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu3&#45;&gt;l2_attn_stage14_gpu3 -->
<g id="edge772" class="edge">
<title>l2_attn_stage13_gpu3&#45;&gt;l2_attn_stage14_gpu3</title>
<path fill="none" stroke="black" d="M26240.39,-6947.84C26225.62,-6941.62 26209.51,-6935.87 26194,-6932.33 26169.39,-6926.72 25984.45,-6940.57 25967,-6922.33 25962.39,-6917.52 25962.37,-6912.13 25967,-6907.33 25975.76,-6898.25 26181.97,-6903.13 26194,-6899.33 26213.58,-6893.16 26233,-6882.22 26249.67,-6870.91"/>
<polygon fill="black" stroke="black" points="26251.94,-6873.6 26258.13,-6865 26247.93,-6867.87 26251.94,-6873.6"/>
</g>
<!-- l2_attn_stage13_gpu3&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge2660" class="edge">
<title>l2_attn_stage13_gpu3&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26354.99,-6947.74C26369.92,-6941.45 26386.25,-6935.68 26402,-6932.33 26420.86,-6928.33 27082.47,-6936.06 27096,-6922.33 27121.62,-6896.35 27080.49,-6869.75 27042.04,-6852.17"/>
<polygon fill="red" stroke="red" points="27043.44,-6848.96 27032.88,-6848.12 27040.61,-6855.37 27043.44,-6848.96"/>
<text text-anchor="middle" x="27134.5" y="-6911.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu4 -->
<g id="node573" class="node">
<title>l2_attn_stage14_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="25050" cy="-6830.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25050" y="-6842.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="25050" y="-6827.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="25050" y="-6812.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu4&#45;&gt;l2_attn_stage14_gpu4 -->
<g id="edge773" class="edge">
<title>l2_attn_stage13_gpu4&#45;&gt;l2_attn_stage14_gpu4</title>
<path fill="none" stroke="black" d="M25050,-6940.24C25050,-6921.52 25050,-6898.53 25050,-6878.55"/>
<polygon fill="black" stroke="black" points="25053.5,-6878.41 25050,-6868.41 25046.5,-6878.41 25053.5,-6878.41"/>
</g>
<!-- l2_attn_stage13_gpu4&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge2661" class="edge">
<title>l2_attn_stage13_gpu4&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25106.98,-6947.66C25121.9,-6941.37 25138.24,-6935.62 25154,-6932.33 25192.78,-6924.24 26542.62,-6935.45 26580,-6922.33 26590.15,-6918.77 26588.9,-6911.04 26599,-6907.33 26645.34,-6890.31 26772.71,-6909.58 26821,-6899.33 26866.06,-6889.77 26914.58,-6869.04 26947.83,-6853.06"/>
<polygon fill="red" stroke="red" points="26949.76,-6856.01 26957.22,-6848.48 26946.69,-6849.72 26949.76,-6856.01"/>
<text text-anchor="middle" x="26630.5" y="-6911.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu5 -->
<g id="node574" class="node">
<title>l2_attn_stage14_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="26090" cy="-6830.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26090" y="-6842.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="26090" y="-6827.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="26090" y="-6812.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu5&#45;&gt;l2_attn_stage14_gpu5 -->
<g id="edge774" class="edge">
<title>l2_attn_stage13_gpu5&#45;&gt;l2_attn_stage14_gpu5</title>
<path fill="none" stroke="black" d="M26027.19,-6949.51C26013.64,-6943.74 25999.37,-6937.76 25986,-6932.33 25974.53,-6927.67 25967.01,-6932.54 25960,-6922.33 25956.23,-6916.84 25956.04,-6912.69 25960,-6907.33 25967.18,-6897.61 25975.05,-6904.45 25986,-6899.33 26003.44,-6891.18 26021.39,-6880.49 26037.36,-6870.02"/>
<polygon fill="black" stroke="black" points="26039.64,-6872.71 26046.02,-6864.25 26035.76,-6866.89 26039.64,-6872.71"/>
</g>
<!-- l2_attn_stage13_gpu5&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge2662" class="edge">
<title>l2_attn_stage13_gpu5&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26146.99,-6947.72C26161.91,-6941.42 26178.24,-6935.66 26194,-6932.33 26216.18,-6927.64 26994.07,-6938.46 27010,-6922.33 27026.71,-6905.42 27017.21,-6877.97 27006.15,-6857.73"/>
<polygon fill="red" stroke="red" points="27009.11,-6855.87 27001.04,-6849.01 27003.07,-6859.4 27009.11,-6855.87"/>
<text text-anchor="middle" x="27048.5" y="-6911.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu6 -->
<g id="node575" class="node">
<title>l2_attn_stage14_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="23802" cy="-6830.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="23802" y="-6842.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="23802" y="-6827.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="23802" y="-6812.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu6&#45;&gt;l2_attn_stage14_gpu6 -->
<g id="edge775" class="edge">
<title>l2_attn_stage13_gpu6&#45;&gt;l2_attn_stage14_gpu6</title>
<path fill="none" stroke="black" d="M23802,-6940.24C23802,-6921.52 23802,-6898.53 23802,-6878.55"/>
<polygon fill="black" stroke="black" points="23805.5,-6878.41 23802,-6868.41 23798.5,-6878.41 23805.5,-6878.41"/>
</g>
<!-- l2_attn_stage13_gpu6&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge2663" class="edge">
<title>l2_attn_stage13_gpu6&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23858.97,-6947.64C23873.89,-6941.34 23890.23,-6935.6 23906,-6932.33 23964.7,-6920.16 26007.42,-6942.12 26064,-6922.33 26074.16,-6918.78 26072.86,-6910.92 26083,-6907.33 26121.66,-6893.68 26780.79,-6907.34 26821,-6899.33 26866.31,-6890.31 26914.98,-6869.4 26948.21,-6853.22"/>
<polygon fill="red" stroke="red" points="26950.17,-6856.16 26957.58,-6848.58 26947.06,-6849.88 26950.17,-6856.16"/>
<text text-anchor="middle" x="26114.5" y="-6911.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu7 -->
<g id="node576" class="node">
<title>l2_attn_stage14_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="26714" cy="-6830.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26714" y="-6842.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="26714" y="-6827.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="26714" y="-6812.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu7&#45;&gt;l2_attn_stage14_gpu7 -->
<g id="edge776" class="edge">
<title>l2_attn_stage13_gpu7&#45;&gt;l2_attn_stage14_gpu7</title>
<path fill="none" stroke="black" d="M26657,-6947.76C26642.08,-6941.46 26625.75,-6935.69 26610,-6932.33 26592.91,-6928.69 25993.26,-6934.79 25981,-6922.33 25976.32,-6917.58 25976.32,-6912.08 25981,-6907.33 25993.28,-6894.9 26593.28,-6904.4 26610,-6899.33 26629.65,-6893.38 26649.09,-6882.49 26665.75,-6871.18"/>
<polygon fill="black" stroke="black" points="26668.03,-6873.85 26674.2,-6865.24 26664.01,-6868.13 26668.03,-6873.85"/>
</g>
<!-- l2_attn_stage13_gpu7&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge2664" class="edge">
<title>l2_attn_stage13_gpu7&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26773.56,-6948.41C26789.88,-6941.89 26807.81,-6935.85 26825,-6932.33 26849.12,-6927.39 27250.79,-6939.93 27268,-6922.33 27317.67,-6871.53 27230.33,-6849.22 27140.57,-6839.44"/>
<polygon fill="red" stroke="red" points="27140.78,-6835.94 27130.47,-6838.39 27140.05,-6842.9 27140.78,-6835.94"/>
<text text-anchor="middle" x="27307.5" y="-6911.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu8 -->
<g id="node577" class="node">
<title>l2_attn_stage14_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="23594" cy="-6830.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="23594" y="-6842.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="23594" y="-6827.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="23594" y="-6812.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu8&#45;&gt;l2_attn_stage14_gpu8 -->
<g id="edge777" class="edge">
<title>l2_attn_stage13_gpu8&#45;&gt;l2_attn_stage14_gpu8</title>
<path fill="none" stroke="black" d="M23594,-6940.24C23594,-6921.52 23594,-6898.53 23594,-6878.55"/>
<polygon fill="black" stroke="black" points="23597.5,-6878.41 23594,-6868.41 23590.5,-6878.41 23597.5,-6878.41"/>
</g>
<!-- l2_attn_stage13_gpu8&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge2665" class="edge">
<title>l2_attn_stage13_gpu8&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23650.98,-6947.7C23665.91,-6941.41 23682.24,-6935.65 23698,-6932.33 23947.97,-6879.68 25741.55,-6909.96 25997,-6907.33 26042.78,-6906.86 26776.1,-6908.24 26821,-6899.33 26866.32,-6890.34 26914.98,-6869.42 26948.21,-6853.23"/>
<polygon fill="red" stroke="red" points="26950.17,-6856.17 26957.58,-6848.6 26947.06,-6849.9 26950.17,-6856.17"/>
<text text-anchor="middle" x="26028.5" y="-6911.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu9 -->
<g id="node578" class="node">
<title>l2_attn_stage14_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="26506" cy="-6830.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="26506" y="-6842.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="26506" y="-6827.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="26506" y="-6812.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu9&#45;&gt;l2_attn_stage14_gpu9 -->
<g id="edge778" class="edge">
<title>l2_attn_stage13_gpu9&#45;&gt;l2_attn_stage14_gpu9</title>
<path fill="none" stroke="black" d="M26448.71,-6947.73C26433.86,-6941.47 26417.64,-6935.73 26402,-6932.33 26378.76,-6927.28 25990.62,-6939.35 25974,-6922.33 25969.34,-6917.56 25969.33,-6912.09 25974,-6907.33 25982.33,-6898.85 26390.63,-6902.81 26402,-6899.33 26421.63,-6893.32 26441.07,-6882.42 26457.73,-6871.11"/>
<polygon fill="black" stroke="black" points="26460.01,-6873.79 26466.18,-6865.18 26455.99,-6868.06 26460.01,-6873.79"/>
</g>
<!-- l2_attn_stage13_gpu9&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge2666" class="edge">
<title>l2_attn_stage13_gpu9&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26563,-6947.78C26577.92,-6941.48 26594.25,-6935.7 26610,-6932.33 26625.54,-6929.01 27170.86,-6933.67 27182,-6922.33 27218.88,-6884.8 27155.24,-6861.04 27091.37,-6847.33"/>
<polygon fill="red" stroke="red" points="27092.05,-6843.9 27081.55,-6845.3 27090.63,-6850.75 27092.05,-6843.9"/>
<text text-anchor="middle" x="27221.5" y="-6911.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu10 -->
<g id="node579" class="node">
<title>l2_attn_stage14_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="24010" cy="-6830.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24010" y="-6842.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="24010" y="-6827.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="24010" y="-6812.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu10&#45;&gt;l2_attn_stage14_gpu10 -->
<g id="edge779" class="edge">
<title>l2_attn_stage13_gpu10&#45;&gt;l2_attn_stage14_gpu10</title>
<path fill="none" stroke="black" d="M24010,-6940.24C24010,-6921.52 24010,-6898.53 24010,-6878.55"/>
<polygon fill="black" stroke="black" points="24013.5,-6878.41 24010,-6868.41 24006.5,-6878.41 24013.5,-6878.41"/>
</g>
<!-- l2_attn_stage13_gpu10&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge2667" class="edge">
<title>l2_attn_stage13_gpu10&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24066.97,-6947.64C24081.89,-6941.35 24098.23,-6935.6 24114,-6932.33 24169.38,-6920.84 26096.62,-6941.01 26150,-6922.33 26160.16,-6918.78 26158.86,-6910.92 26169,-6907.33 26203.15,-6895.24 26785.48,-6906.43 26821,-6899.33 26866.31,-6890.28 26914.97,-6869.37 26948.2,-6853.2"/>
<polygon fill="red" stroke="red" points="26950.16,-6856.14 26957.57,-6848.57 26947.06,-6849.86 26950.16,-6856.14"/>
<text text-anchor="middle" x="26200.5" y="-6911.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu11 -->
<g id="node580" class="node">
<title>l2_attn_stage14_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="25258" cy="-6830.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25258" y="-6842.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="25258" y="-6827.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="25258" y="-6812.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu11&#45;&gt;l2_attn_stage14_gpu11 -->
<g id="edge780" class="edge">
<title>l2_attn_stage13_gpu11&#45;&gt;l2_attn_stage14_gpu11</title>
<path fill="none" stroke="black" d="M25258,-6940.24C25258,-6921.52 25258,-6898.53 25258,-6878.55"/>
<polygon fill="black" stroke="black" points="25261.5,-6878.41 25258,-6868.41 25254.5,-6878.41 25261.5,-6878.41"/>
</g>
<!-- l2_attn_stage13_gpu11&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge2668" class="edge">
<title>l2_attn_stage13_gpu11&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25314.98,-6947.67C25329.9,-6941.38 25346.24,-6935.63 25362,-6932.33 25432.91,-6917.51 26597.65,-6946.35 26666,-6922.33 26676.15,-6918.76 26674.94,-6911.16 26685,-6907.33 26713.3,-6896.57 26791.46,-6905.95 26821,-6899.33 26865.67,-6889.33 26913.88,-6868.86 26947.15,-6853.07"/>
<polygon fill="red" stroke="red" points="26949.06,-6856.04 26956.55,-6848.55 26946.02,-6849.73 26949.06,-6856.04"/>
<text text-anchor="middle" x="26716.5" y="-6911.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu12 -->
<g id="node581" class="node">
<title>l2_attn_stage14_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="24218" cy="-6830.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24218" y="-6842.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="24218" y="-6827.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="24218" y="-6812.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu12&#45;&gt;l2_attn_stage14_gpu12 -->
<g id="edge781" class="edge">
<title>l2_attn_stage13_gpu12&#45;&gt;l2_attn_stage14_gpu12</title>
<path fill="none" stroke="black" d="M24218,-6940.24C24218,-6921.52 24218,-6898.53 24218,-6878.55"/>
<polygon fill="black" stroke="black" points="24221.5,-6878.41 24218,-6868.41 24214.5,-6878.41 24221.5,-6878.41"/>
</g>
<!-- l2_attn_stage13_gpu12&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge2669" class="edge">
<title>l2_attn_stage13_gpu12&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24274.97,-6947.64C24289.9,-6941.35 24306.23,-6935.61 24322,-6932.33 24374.06,-6921.52 26185.82,-6939.9 26236,-6922.33 26246.15,-6918.78 26244.86,-6910.93 26255,-6907.33 26284.63,-6896.81 26790.17,-6905.52 26821,-6899.33 26866.3,-6890.24 26914.97,-6869.33 26948.2,-6853.18"/>
<polygon fill="red" stroke="red" points="26950.15,-6856.12 26957.57,-6848.55 26947.05,-6849.84 26950.15,-6856.12"/>
<text text-anchor="middle" x="26286.5" y="-6911.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu13 -->
<g id="node582" class="node">
<title>l2_attn_stage14_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="25466" cy="-6830.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25466" y="-6842.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="25466" y="-6827.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="25466" y="-6812.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu13&#45;&gt;l2_attn_stage14_gpu13 -->
<g id="edge782" class="edge">
<title>l2_attn_stage13_gpu13&#45;&gt;l2_attn_stage14_gpu13</title>
<path fill="none" stroke="black" d="M25466,-6940.24C25466,-6921.52 25466,-6898.53 25466,-6878.55"/>
<polygon fill="black" stroke="black" points="25469.5,-6878.41 25466,-6868.41 25462.5,-6878.41 25469.5,-6878.41"/>
</g>
<!-- l2_attn_stage13_gpu13&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge2670" class="edge">
<title>l2_attn_stage13_gpu13&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25522.98,-6947.68C25537.9,-6941.38 25554.24,-6935.63 25570,-6932.33 25634.28,-6918.88 26690.05,-6944.13 26752,-6922.33 26762.15,-6918.76 26761.15,-6911.65 26771,-6907.33 26791.61,-6898.29 26799.31,-6905.34 26821,-6899.33 26864.28,-6887.34 26911.59,-6867.7 26944.94,-6852.69"/>
<polygon fill="red" stroke="red" points="26946.74,-6855.72 26954.4,-6848.4 26943.84,-6849.35 26946.74,-6855.72"/>
<text text-anchor="middle" x="26802.5" y="-6911.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu14 -->
<g id="node583" class="node">
<title>l2_attn_stage14_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="24634" cy="-6830.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="24634" y="-6842.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="24634" y="-6827.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="24634" y="-6812.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu14&#45;&gt;l2_attn_stage14_gpu14 -->
<g id="edge783" class="edge">
<title>l2_attn_stage13_gpu14&#45;&gt;l2_attn_stage14_gpu14</title>
<path fill="none" stroke="black" d="M24634,-6940.24C24634,-6921.52 24634,-6898.53 24634,-6878.55"/>
<polygon fill="black" stroke="black" points="24637.5,-6878.41 24634,-6868.41 24630.5,-6878.41 24637.5,-6878.41"/>
</g>
<!-- l2_attn_stage13_gpu14&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge2671" class="edge">
<title>l2_attn_stage13_gpu14&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24690.97,-6947.65C24705.9,-6941.36 24722.23,-6935.61 24738,-6932.33 24783.42,-6922.88 26364.22,-6937.68 26408,-6922.33 26418.15,-6918.77 26416.87,-6910.96 26427,-6907.33 26468.22,-6892.55 26778.1,-6908.08 26821,-6899.33 26866.27,-6890.1 26914.94,-6869.22 26948.18,-6853.1"/>
<polygon fill="red" stroke="red" points="26950.13,-6856.05 26957.56,-6848.49 26947.04,-6849.77 26950.13,-6856.05"/>
<text text-anchor="middle" x="26458.5" y="-6911.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu15 -->
<g id="node584" class="node">
<title>l2_attn_stage14_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="25674" cy="-6830.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="25674" y="-6842.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="25674" y="-6827.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="25674" y="-6812.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu15&#45;&gt;l2_attn_stage14_gpu15 -->
<g id="edge784" class="edge">
<title>l2_attn_stage13_gpu15&#45;&gt;l2_attn_stage14_gpu15</title>
<path fill="none" stroke="black" d="M25674,-6940.24C25674,-6921.52 25674,-6898.53 25674,-6878.55"/>
<polygon fill="black" stroke="black" points="25677.5,-6878.41 25674,-6868.41 25670.5,-6878.41 25677.5,-6878.41"/>
</g>
<!-- l2_attn_stage13_gpu15&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge2672" class="edge">
<title>l2_attn_stage13_gpu15&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25730.98,-6947.69C25745.91,-6941.39 25762.24,-6935.64 25778,-6932.33 25835.64,-6920.24 26782.46,-6941.91 26838,-6922.33 26848.15,-6918.76 26848.08,-6913.35 26857,-6907.33 26886.36,-6887.51 26921.2,-6867.72 26947.72,-6853.38"/>
<polygon fill="red" stroke="red" points="26949.57,-6856.36 26956.73,-6848.55 26946.26,-6850.19 26949.57,-6856.36"/>
<text text-anchor="middle" x="26888.5" y="-6911.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu0 -->
<g id="node585" class="node">
<title>l2_attn_stage15_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="21551" cy="-6683.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="21551" y="-6695.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="21551" y="-6680.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="21551" y="-6665.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu0&#45;&gt;l2_attn_stage15_gpu0 -->
<g id="edge785" class="edge">
<title>l2_attn_stage14_gpu0&#45;&gt;l2_attn_stage15_gpu0</title>
<path fill="none" stroke="black" d="M24785.3,-6800.74C24770.31,-6794.4 24753.87,-6788.61 24738,-6785.33 24661.94,-6769.6 22019.6,-6778.58 21942,-6775.33 21814.15,-6769.99 21776.15,-6793.54 21655,-6752.33 21635.74,-6745.78 21616.52,-6734.86 21599.94,-6723.7"/>
<polygon fill="black" stroke="black" points="21601.74,-6720.69 21591.53,-6717.86 21597.75,-6726.44 21601.74,-6720.69"/>
</g>
<!-- l2_attn_stage15_gpu[next_gpu] -->
<g id="node1374" class="node">
<title>l2_attn_stage15_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="26989" cy="-6683.83" rx="155.5" ry="18"/>
<text text-anchor="middle" x="26989" y="-6680.13" font-family="Times,serif" font-size="14.00">l2_attn_stage15_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage14_gpu0&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge2673" class="edge">
<title>l2_attn_stage14_gpu0&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24900.96,-6801.37C24915.42,-6795.3 24931.05,-6789.48 24946,-6785.33 25024.68,-6763.52 25046.67,-6767.55 25128,-6760.33 25752.71,-6704.88 26499.06,-6690.12 26824.14,-6686.22"/>
<polygon fill="red" stroke="red" points="26824.62,-6689.71 26834.58,-6686.09 26824.54,-6682.71 26824.62,-6689.71"/>
<text text-anchor="middle" x="25159.5" y="-6764.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu1 -->
<g id="node586" class="node">
<title>l2_attn_stage15_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="21135" cy="-6683.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="21135" y="-6695.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="21135" y="-6680.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="21135" y="-6665.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu1&#45;&gt;l2_attn_stage15_gpu1 -->
<g id="edge786" class="edge">
<title>l2_attn_stage14_gpu1&#45;&gt;l2_attn_stage15_gpu1</title>
<path fill="none" stroke="black" d="M24369.3,-6800.74C24354.31,-6794.4 24337.87,-6788.61 24322,-6785.33 24248.85,-6770.2 21707.66,-6777.65 21633,-6775.33 21457.68,-6769.89 21405.67,-6807.01 21239,-6752.33 21219.67,-6745.99 21200.43,-6735.13 21183.86,-6723.95"/>
<polygon fill="black" stroke="black" points="21185.66,-6720.94 21175.45,-6718.1 21181.66,-6726.68 21185.66,-6720.94"/>
</g>
<!-- l2_attn_stage14_gpu1&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge2674" class="edge">
<title>l2_attn_stage14_gpu1&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24484.96,-6801.37C24499.42,-6795.3 24515.05,-6789.48 24530,-6785.33 24608.68,-6763.52 24630.65,-6767.25 24712,-6760.33 25500.42,-6693.29 26447.1,-6684.92 26823.24,-6684.47"/>
<polygon fill="red" stroke="red" points="26823.38,-6687.97 26833.38,-6684.46 26823.38,-6680.97 26823.38,-6687.97"/>
<text text-anchor="middle" x="24743.5" y="-6764.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu2 -->
<g id="node587" class="node">
<title>l2_attn_stage15_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="22591" cy="-6683.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="22591" y="-6695.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="22591" y="-6680.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="22591" y="-6665.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu2&#45;&gt;l2_attn_stage15_gpu2 -->
<g id="edge787" class="edge">
<title>l2_attn_stage14_gpu2&#45;&gt;l2_attn_stage15_gpu2</title>
<path fill="none" stroke="black" d="M25825.3,-6800.74C25810.31,-6794.4 25793.87,-6788.61 25778,-6785.33 25699.55,-6769.11 22973.97,-6780.08 22894,-6775.33 22805.12,-6770.06 22778.78,-6782.48 22695,-6752.33 22676.03,-6745.51 22657.02,-6734.64 22640.53,-6723.6"/>
<polygon fill="black" stroke="black" points="22642.38,-6720.62 22632.16,-6717.83 22638.41,-6726.39 22642.38,-6720.62"/>
</g>
<!-- l2_attn_stage14_gpu2&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge2675" class="edge">
<title>l2_attn_stage14_gpu2&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25940.96,-6801.37C25955.42,-6795.3 25971.05,-6789.48 25986,-6785.33 26064.68,-6763.52 26086.88,-6769.63 26168,-6760.33 26409.14,-6732.7 26691.05,-6708.54 26853.92,-6695.39"/>
<polygon fill="red" stroke="red" points="26854.3,-6698.87 26863.99,-6694.58 26853.74,-6691.89 26854.3,-6698.87"/>
<text text-anchor="middle" x="26199.5" y="-6764.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu3 -->
<g id="node588" class="node">
<title>l2_attn_stage15_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="23007" cy="-6683.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="23007" y="-6695.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="23007" y="-6680.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="23007" y="-6665.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu3&#45;&gt;l2_attn_stage15_gpu3 -->
<g id="edge788" class="edge">
<title>l2_attn_stage14_gpu3&#45;&gt;l2_attn_stage15_gpu3</title>
<path fill="none" stroke="black" d="M26241.3,-6800.74C26226.31,-6794.4 26209.87,-6788.61 26194,-6785.33 26115.55,-6769.11 23389.97,-6780.08 23310,-6775.33 23221.12,-6770.06 23194.78,-6782.48 23111,-6752.33 23092.03,-6745.51 23073.02,-6734.64 23056.53,-6723.6"/>
<polygon fill="black" stroke="black" points="23058.38,-6720.62 23048.16,-6717.83 23054.41,-6726.39 23058.38,-6720.62"/>
</g>
<!-- l2_attn_stage14_gpu3&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge2676" class="edge">
<title>l2_attn_stage14_gpu3&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26357.61,-6801.5C26371.91,-6795.49 26387.31,-6789.67 26402,-6785.33 26558.74,-6739.08 26745.69,-6711.63 26865.81,-6697.4"/>
<polygon fill="red" stroke="red" points="26866.25,-6700.87 26875.78,-6696.23 26865.44,-6693.92 26866.25,-6700.87"/>
<text text-anchor="middle" x="26527.5" y="-6764.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu4 -->
<g id="node589" class="node">
<title>l2_attn_stage15_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="21759" cy="-6683.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="21759" y="-6695.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="21759" y="-6680.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="21759" y="-6665.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu4&#45;&gt;l2_attn_stage15_gpu4 -->
<g id="edge789" class="edge">
<title>l2_attn_stage14_gpu4&#45;&gt;l2_attn_stage15_gpu4</title>
<path fill="none" stroke="black" d="M24993.3,-6800.74C24978.31,-6794.4 24961.87,-6788.61 24946,-6785.33 24869.59,-6769.53 22214.95,-6778.74 22137,-6775.33 22014.91,-6770 21978.62,-6791.9 21863,-6752.33 21843.75,-6745.74 21824.54,-6734.82 21807.96,-6723.66"/>
<polygon fill="black" stroke="black" points="21809.75,-6720.64 21799.54,-6717.82 21805.76,-6726.4 21809.75,-6720.64"/>
</g>
<!-- l2_attn_stage14_gpu4&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge2677" class="edge">
<title>l2_attn_stage14_gpu4&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25108.96,-6801.37C25123.42,-6795.3 25139.05,-6789.48 25154,-6785.33 25232.68,-6763.52 25254.69,-6767.76 25336,-6760.33 25880.27,-6710.63 26528.48,-6693.1 26825.57,-6687.38"/>
<polygon fill="red" stroke="red" points="26826.06,-6690.87 26835.99,-6687.18 26825.93,-6683.87 26826.06,-6690.87"/>
<text text-anchor="middle" x="25367.5" y="-6764.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu5 -->
<g id="node590" class="node">
<title>l2_attn_stage15_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="22799" cy="-6683.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="22799" y="-6695.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="22799" y="-6680.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="22799" y="-6665.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu5&#45;&gt;l2_attn_stage15_gpu5 -->
<g id="edge790" class="edge">
<title>l2_attn_stage14_gpu5&#45;&gt;l2_attn_stage15_gpu5</title>
<path fill="none" stroke="black" d="M26033.3,-6800.74C26018.31,-6794.4 26001.87,-6788.61 25986,-6785.33 25908.42,-6769.29 23213.12,-6779.4 23134,-6775.33 23030.96,-6770.03 23000.35,-6786.49 22903,-6752.33 22883.97,-6745.66 22864.95,-6734.83 22848.47,-6723.78"/>
<polygon fill="black" stroke="black" points="22850.31,-6720.8 22840.1,-6718 22846.34,-6726.56 22850.31,-6720.8"/>
</g>
<!-- l2_attn_stage14_gpu5&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge2678" class="edge">
<title>l2_attn_stage14_gpu5&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26148.95,-6801.33C26163.41,-6795.26 26179.04,-6789.45 26194,-6785.33 26411.76,-6725.39 26673.06,-6701.06 26835.1,-6691.28"/>
<polygon fill="red" stroke="red" points="26835.37,-6694.77 26845.14,-6690.68 26834.95,-6687.78 26835.37,-6694.77"/>
<text text-anchor="middle" x="26309.5" y="-6764.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu6 -->
<g id="node591" class="node">
<title>l2_attn_stage15_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="20511" cy="-6683.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20511" y="-6695.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="20511" y="-6680.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="20511" y="-6665.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu6&#45;&gt;l2_attn_stage15_gpu6 -->
<g id="edge791" class="edge">
<title>l2_attn_stage14_gpu6&#45;&gt;l2_attn_stage15_gpu6</title>
<path fill="none" stroke="black" d="M23745.3,-6800.74C23730.31,-6794.4 23713.87,-6788.61 23698,-6785.33 23620.91,-6769.39 20942.63,-6779.1 20864,-6775.33 20752.99,-6770.02 20720,-6788.76 20615,-6752.33 20595.95,-6745.72 20576.92,-6734.91 20560.44,-6723.86"/>
<polygon fill="black" stroke="black" points="20562.29,-6720.88 20552.07,-6718.08 20558.31,-6726.64 20562.29,-6720.88"/>
</g>
<!-- l2_attn_stage14_gpu6&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge2679" class="edge">
<title>l2_attn_stage14_gpu6&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23860.96,-6801.37C23875.42,-6795.3 23891.05,-6789.48 23906,-6785.33 23984.68,-6763.52 24006.62,-6766.96 24088,-6760.33 24625.79,-6716.53 26294.52,-6693.17 26825.2,-6686.71"/>
<polygon fill="red" stroke="red" points="26825.27,-6690.21 26835.23,-6686.59 26825.19,-6683.21 26825.27,-6690.21"/>
<text text-anchor="middle" x="24119.5" y="-6764.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu7 -->
<g id="node592" class="node">
<title>l2_attn_stage15_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="23423" cy="-6683.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="23423" y="-6695.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="23423" y="-6680.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="23423" y="-6665.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu7&#45;&gt;l2_attn_stage15_gpu7 -->
<g id="edge792" class="edge">
<title>l2_attn_stage14_gpu7&#45;&gt;l2_attn_stage15_gpu7</title>
<path fill="none" stroke="black" d="M26657.3,-6800.74C26642.31,-6794.4 26625.87,-6788.61 26610,-6785.33 26531.49,-6769.1 23803.29,-6787.14 23724,-6775.33 23645.36,-6763.63 23558.73,-6735.93 23498.68,-6714.23"/>
<polygon fill="black" stroke="black" points="23499.87,-6710.94 23489.28,-6710.81 23497.47,-6717.52 23499.87,-6710.94"/>
</g>
<!-- l2_attn_stage14_gpu7&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge2680" class="edge">
<title>l2_attn_stage14_gpu7&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26769.98,-6800.31C26822.84,-6772.45 26900.84,-6731.32 26948.09,-6706.4"/>
<polygon fill="red" stroke="red" points="26949.91,-6709.4 26957.12,-6701.64 26946.64,-6703.21 26949.91,-6709.4"/>
<text text-anchor="middle" x="26874.5" y="-6764.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu8 -->
<g id="node593" class="node">
<title>l2_attn_stage15_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20303" cy="-6683.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20303" y="-6695.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="20303" y="-6680.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20303" y="-6665.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu8&#45;&gt;l2_attn_stage15_gpu8 -->
<g id="edge793" class="edge">
<title>l2_attn_stage14_gpu8&#45;&gt;l2_attn_stage15_gpu8</title>
<path fill="none" stroke="black" d="M23498.78,-6829.1C23058.34,-6825.56 21215.59,-6809 20640,-6775.33 20536.12,-6769.26 20505.2,-6786.74 20407,-6752.33 20387.97,-6745.66 20368.94,-6734.84 20352.46,-6723.79"/>
<polygon fill="black" stroke="black" points="20354.31,-6720.81 20344.09,-6718.01 20350.34,-6726.57 20354.31,-6720.81"/>
</g>
<!-- l2_attn_stage14_gpu8&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge2681" class="edge">
<title>l2_attn_stage14_gpu8&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M23652.96,-6801.37C23667.42,-6795.3 23683.05,-6789.48 23698,-6785.33 23776.68,-6763.52 23798.62,-6766.89 23880,-6760.33 24460.19,-6713.59 26268.49,-6692.03 26824.6,-6686.39"/>
<polygon fill="red" stroke="red" points="26824.74,-6689.89 26834.7,-6686.28 26824.67,-6682.89 26824.74,-6689.89"/>
<text text-anchor="middle" x="23911.5" y="-6764.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu9 -->
<g id="node594" class="node">
<title>l2_attn_stage15_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="23215" cy="-6683.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="23215" y="-6695.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="23215" y="-6680.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="23215" y="-6665.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu9&#45;&gt;l2_attn_stage15_gpu9 -->
<g id="edge794" class="edge">
<title>l2_attn_stage14_gpu9&#45;&gt;l2_attn_stage15_gpu9</title>
<path fill="none" stroke="black" d="M26449.3,-6800.74C26434.31,-6794.4 26417.87,-6788.61 26402,-6785.33 26327.19,-6769.86 23728.34,-6778.1 23652,-6775.33 23503.75,-6769.95 23459.71,-6799.33 23319,-6752.33 23299.7,-6745.89 23280.48,-6735 23263.9,-6723.83"/>
<polygon fill="black" stroke="black" points="23265.7,-6720.81 23255.49,-6717.98 23261.7,-6726.56 23265.7,-6720.81"/>
</g>
<!-- l2_attn_stage14_gpu9&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge2682" class="edge">
<title>l2_attn_stage14_gpu9&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M26567.01,-6801.98C26580.99,-6796.09 26595.89,-6790.19 26610,-6785.33 26711.63,-6750.32 26832.09,-6720.26 26909.48,-6702.37"/>
<polygon fill="red" stroke="red" points="26910.67,-6705.69 26919.63,-6700.03 26909.1,-6698.86 26910.67,-6705.69"/>
<text text-anchor="middle" x="26712.5" y="-6764.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu10 -->
<g id="node595" class="node">
<title>l2_attn_stage15_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="20719" cy="-6683.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20719" y="-6695.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="20719" y="-6680.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="20719" y="-6665.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu10&#45;&gt;l2_attn_stage15_gpu10 -->
<g id="edge795" class="edge">
<title>l2_attn_stage14_gpu10&#45;&gt;l2_attn_stage15_gpu10</title>
<path fill="none" stroke="black" d="M23953.3,-6800.74C23938.31,-6794.4 23921.87,-6788.61 23906,-6785.33 23827.55,-6769.11 21101.97,-6780.08 21022,-6775.33 20933.12,-6770.06 20906.78,-6782.48 20823,-6752.33 20804.03,-6745.51 20785.02,-6734.64 20768.53,-6723.6"/>
<polygon fill="black" stroke="black" points="20770.38,-6720.62 20760.16,-6717.83 20766.41,-6726.39 20770.38,-6720.62"/>
</g>
<!-- l2_attn_stage14_gpu10&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge2683" class="edge">
<title>l2_attn_stage14_gpu10&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24068.96,-6801.37C24083.42,-6795.3 24099.05,-6789.48 24114,-6785.33 24192.68,-6763.52 24214.63,-6767.04 24296,-6760.33 24791.36,-6719.49 26320.41,-6694.42 26825.32,-6687.09"/>
<polygon fill="red" stroke="red" points="26825.65,-6690.59 26835.6,-6686.94 26825.55,-6683.59 26825.65,-6690.59"/>
<text text-anchor="middle" x="24327.5" y="-6764.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu11 -->
<g id="node596" class="node">
<title>l2_attn_stage15_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="21967" cy="-6683.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="21967" y="-6695.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="21967" y="-6680.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="21967" y="-6665.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu11&#45;&gt;l2_attn_stage15_gpu11 -->
<g id="edge796" class="edge">
<title>l2_attn_stage14_gpu11&#45;&gt;l2_attn_stage15_gpu11</title>
<path fill="none" stroke="black" d="M25201.3,-6800.74C25186.31,-6794.4 25169.87,-6788.61 25154,-6785.33 25076.91,-6769.39 22398.63,-6779.1 22320,-6775.33 22208.99,-6770.02 22176,-6788.76 22071,-6752.33 22051.95,-6745.72 22032.92,-6734.91 22016.44,-6723.86"/>
<polygon fill="black" stroke="black" points="22018.29,-6720.88 22008.07,-6718.08 22014.31,-6726.64 22018.29,-6720.88"/>
</g>
<!-- l2_attn_stage14_gpu11&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge2684" class="edge">
<title>l2_attn_stage14_gpu11&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25316.96,-6801.37C25331.42,-6795.3 25347.05,-6789.48 25362,-6785.33 25440.68,-6763.52 25462.71,-6768.02 25544,-6760.33 26009.29,-6716.3 26561.47,-6696.39 26828.5,-6688.8"/>
<polygon fill="red" stroke="red" points="26828.76,-6692.29 26838.66,-6688.51 26828.56,-6685.3 26828.76,-6692.29"/>
<text text-anchor="middle" x="25575.5" y="-6764.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu12 -->
<g id="node597" class="node">
<title>l2_attn_stage15_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="20927" cy="-6683.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20927" y="-6695.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="20927" y="-6680.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="20927" y="-6665.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu12&#45;&gt;l2_attn_stage15_gpu12 -->
<g id="edge797" class="edge">
<title>l2_attn_stage14_gpu12&#45;&gt;l2_attn_stage15_gpu12</title>
<path fill="none" stroke="black" d="M24161.3,-6800.74C24146.31,-6794.4 24129.87,-6788.61 24114,-6785.33 24036.45,-6769.3 21342.09,-6779.38 21263,-6775.33 21159.52,-6770.03 21128.78,-6786.62 21031,-6752.33 21011.97,-6745.66 20992.95,-6734.83 20976.47,-6723.79"/>
<polygon fill="black" stroke="black" points="20978.31,-6720.81 20968.09,-6718.01 20974.34,-6726.57 20978.31,-6720.81"/>
</g>
<!-- l2_attn_stage14_gpu12&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge2685" class="edge">
<title>l2_attn_stage14_gpu12&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24276.96,-6801.37C24291.42,-6795.3 24307.05,-6789.48 24322,-6785.33 24400.68,-6763.52 24422.64,-6767.14 24504,-6760.33 24957.37,-6722.41 26349.16,-6695.75 26826.41,-6687.51"/>
<polygon fill="red" stroke="red" points="26826.54,-6691.01 26836.48,-6687.34 26826.42,-6684.01 26826.54,-6691.01"/>
<text text-anchor="middle" x="24535.5" y="-6764.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu13 -->
<g id="node598" class="node">
<title>l2_attn_stage15_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="22175" cy="-6683.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="22175" y="-6695.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="22175" y="-6680.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="22175" y="-6665.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu13&#45;&gt;l2_attn_stage15_gpu13 -->
<g id="edge798" class="edge">
<title>l2_attn_stage14_gpu13&#45;&gt;l2_attn_stage15_gpu13</title>
<path fill="none" stroke="black" d="M25409.3,-6800.74C25394.31,-6794.4 25377.87,-6788.61 25362,-6785.33 25283.55,-6769.11 22557.97,-6780.08 22478,-6775.33 22389.12,-6770.06 22362.78,-6782.48 22279,-6752.33 22260.03,-6745.51 22241.02,-6734.64 22224.53,-6723.6"/>
<polygon fill="black" stroke="black" points="22226.38,-6720.62 22216.16,-6717.83 22222.41,-6726.39 22226.38,-6720.62"/>
</g>
<!-- l2_attn_stage14_gpu13&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge2686" class="edge">
<title>l2_attn_stage14_gpu13&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25524.96,-6801.37C25539.42,-6795.3 25555.05,-6789.48 25570,-6785.33 25648.68,-6763.52 25670.75,-6768.38 25752,-6760.33 26139.66,-6721.93 26597.74,-6700.08 26832.71,-6690.58"/>
<polygon fill="red" stroke="red" points="26833.19,-6694.07 26843.04,-6690.17 26832.91,-6687.07 26833.19,-6694.07"/>
<text text-anchor="middle" x="25783.5" y="-6764.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu14 -->
<g id="node599" class="node">
<title>l2_attn_stage15_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="21343" cy="-6683.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="21343" y="-6695.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="21343" y="-6680.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="21343" y="-6665.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu14&#45;&gt;l2_attn_stage15_gpu14 -->
<g id="edge799" class="edge">
<title>l2_attn_stage14_gpu14&#45;&gt;l2_attn_stage15_gpu14</title>
<path fill="none" stroke="black" d="M24577.3,-6800.74C24562.31,-6794.4 24545.87,-6788.61 24530,-6785.33 24452.42,-6769.29 21757.12,-6779.4 21678,-6775.33 21574.96,-6770.03 21544.35,-6786.49 21447,-6752.33 21427.97,-6745.66 21408.95,-6734.83 21392.47,-6723.78"/>
<polygon fill="black" stroke="black" points="21394.31,-6720.8 21384.1,-6718 21390.34,-6726.56 21394.31,-6720.8"/>
</g>
<!-- l2_attn_stage14_gpu14&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge2687" class="edge">
<title>l2_attn_stage14_gpu14&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M24692.96,-6801.37C24707.42,-6795.3 24723.05,-6789.48 24738,-6785.33 24816.68,-6763.52 24838.66,-6767.39 24920,-6760.33 25626.32,-6699.09 26472.46,-6687.4 26823.67,-6685.26"/>
<polygon fill="red" stroke="red" points="26823.94,-6688.76 26833.92,-6685.2 26823.9,-6681.76 26823.94,-6688.76"/>
<text text-anchor="middle" x="24951.5" y="-6764.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu15 -->
<g id="node600" class="node">
<title>l2_attn_stage15_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="22383" cy="-6683.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="22383" y="-6695.13" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="22383" y="-6680.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22383" y="-6665.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu15&#45;&gt;l2_attn_stage15_gpu15 -->
<g id="edge800" class="edge">
<title>l2_attn_stage14_gpu15&#45;&gt;l2_attn_stage15_gpu15</title>
<path fill="none" stroke="black" d="M25617.3,-6800.74C25602.31,-6794.4 25585.87,-6788.61 25570,-6785.33 25492.42,-6769.29 22797.12,-6779.4 22718,-6775.33 22614.96,-6770.03 22584.35,-6786.49 22487,-6752.33 22467.97,-6745.66 22448.95,-6734.83 22432.47,-6723.78"/>
<polygon fill="black" stroke="black" points="22434.31,-6720.8 22424.1,-6718 22430.34,-6726.56 22434.31,-6720.8"/>
</g>
<!-- l2_attn_stage14_gpu15&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge2688" class="edge">
<title>l2_attn_stage14_gpu15&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M25732.96,-6801.37C25747.42,-6795.3 25763.05,-6789.48 25778,-6785.33 25856.68,-6763.52 25878.8,-6768.88 25960,-6760.33 26272.92,-6727.39 26640.89,-6704.11 26841.03,-6692.74"/>
<polygon fill="red" stroke="red" points="26841.24,-6696.23 26851.02,-6692.17 26840.84,-6689.25 26841.24,-6696.23"/>
<text text-anchor="middle" x="25991.5" y="-6764.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_out_gpu0 -->
<g id="node617" class="node">
<title>l2_attn_out_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20846" cy="-6561.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="20846" y="-6580.05" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="20846" y="-6565.05" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20846" y="-6550.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="20846" y="-6535.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu0&#45;&gt;l2_attn_out_gpu0 -->
<g id="edge801" class="edge">
<title>l2_attn_stage15_gpu0&#45;&gt;l2_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M21492.07,-6654.26C21477.61,-6648.19 21461.97,-6642.4 21447,-6638.33 21267.26,-6589.53 21048.6,-6571.84 20930.87,-6565.57"/>
<polygon fill="black" stroke="black" points="20931.01,-6562.07 20920.84,-6565.05 20930.65,-6569.06 20931.01,-6562.07"/>
</g>
<!-- l2_attn_out_gpu1 -->
<g id="node618" class="node">
<title>l2_attn_out_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19638" cy="-6561.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="19638" y="-6580.05" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="19638" y="-6565.05" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19638" y="-6550.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="19638" y="-6535.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu1&#45;&gt;l2_attn_out_gpu1 -->
<g id="edge802" class="edge">
<title>l2_attn_stage15_gpu1&#45;&gt;l2_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M21077.69,-6653.81C21062.85,-6647.56 21046.63,-6641.79 21031,-6638.33 20828.68,-6593.58 20305.75,-6623.09 20099,-6609.33 19966.89,-6600.54 19814.11,-6583.59 19721.84,-6572.61"/>
<polygon fill="black" stroke="black" points="19722.06,-6569.11 19711.72,-6571.4 19721.23,-6576.06 19722.06,-6569.11"/>
</g>
<!-- l2_attn_out_gpu2 -->
<g id="node619" class="node">
<title>l2_attn_out_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="22233" cy="-6561.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="22233" y="-6580.05" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="22233" y="-6565.05" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="22233" y="-6550.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="22233" y="-6535.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu2&#45;&gt;l2_attn_out_gpu2 -->
<g id="edge803" class="edge">
<title>l2_attn_stage15_gpu2&#45;&gt;l2_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M22530.68,-6654.78C22516.54,-6648.83 22501.4,-6642.96 22487,-6638.33 22430.23,-6620.08 22413.11,-6626.48 22356,-6609.33 22339.25,-6604.3 22321.53,-6598.07 22304.91,-6591.81"/>
<polygon fill="black" stroke="black" points="22305.86,-6588.43 22295.27,-6588.13 22303.37,-6594.97 22305.86,-6588.43"/>
</g>
<!-- l2_attn_out_gpu3 -->
<g id="node620" class="node">
<title>l2_attn_out_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="22647" cy="-6561.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="22647" y="-6580.05" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="22647" y="-6565.05" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="22647" y="-6550.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="22647" y="-6535.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu3&#45;&gt;l2_attn_out_gpu3 -->
<g id="edge804" class="edge">
<title>l2_attn_stage15_gpu3&#45;&gt;l2_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M22946.69,-6654.76C22932.55,-6648.81 22917.4,-6642.95 22903,-6638.33 22845.8,-6619.99 22828.56,-6626.48 22771,-6609.33 22754.03,-6604.28 22736.06,-6598.01 22719.23,-6591.71"/>
<polygon fill="black" stroke="black" points="22720.06,-6588.28 22709.47,-6588.01 22717.58,-6594.83 22720.06,-6588.28"/>
</g>
<!-- l2_attn_out_gpu4 -->
<g id="node621" class="node">
<title>l2_attn_out_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="21439" cy="-6561.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="21439" y="-6580.05" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="21439" y="-6565.05" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="21439" y="-6550.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="21439" y="-6535.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu4&#45;&gt;l2_attn_out_gpu4 -->
<g id="edge805" class="edge">
<title>l2_attn_stage15_gpu4&#45;&gt;l2_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M21698.01,-6654.92C21684.03,-6649.03 21669.13,-6643.15 21655,-6638.33 21606.34,-6621.73 21591.49,-6626.44 21543,-6609.33 21531.28,-6605.19 21519.05,-6600.26 21507.28,-6595.16"/>
<polygon fill="black" stroke="black" points="21508.51,-6591.88 21497.95,-6591.05 21505.69,-6598.29 21508.51,-6591.88"/>
</g>
<!-- l2_attn_out_gpu5 -->
<g id="node622" class="node">
<title>l2_attn_out_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="22440" cy="-6561.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="22440" y="-6580.05" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="22440" y="-6565.05" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="22440" y="-6550.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="22440" y="-6535.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu5&#45;&gt;l2_attn_out_gpu5 -->
<g id="edge806" class="edge">
<title>l2_attn_stage15_gpu5&#45;&gt;l2_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M22738.69,-6654.76C22724.55,-6648.81 22709.4,-6642.95 22695,-6638.33 22637.8,-6619.99 22620.54,-6626.56 22563,-6609.33 22546.25,-6604.32 22528.52,-6598.09 22511.91,-6591.83"/>
<polygon fill="black" stroke="black" points="22512.86,-6588.45 22502.27,-6588.15 22510.36,-6594.99 22512.86,-6588.45"/>
</g>
<!-- l2_attn_out_gpu6 -->
<g id="node623" class="node">
<title>l2_attn_out_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19117" cy="-6561.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="19117" y="-6580.05" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="19117" y="-6565.05" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19117" y="-6550.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="19117" y="-6535.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu6&#45;&gt;l2_attn_out_gpu6 -->
<g id="edge807" class="edge">
<title>l2_attn_stage15_gpu6&#45;&gt;l2_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M20454.02,-6653.7C20439.09,-6647.4 20422.76,-6641.64 20407,-6638.33 20352.96,-6626.97 19468.15,-6631.2 19413,-6628.33 19322.95,-6623.65 19297.69,-6634.17 19211,-6609.33 19201.09,-6606.49 19190.99,-6602.62 19181.25,-6598.3"/>
<polygon fill="black" stroke="black" points="19182.58,-6595.06 19172.04,-6594.04 19179.65,-6601.42 19182.58,-6595.06"/>
</g>
<!-- l2_attn_out_gpu7 -->
<g id="node624" class="node">
<title>l2_attn_out_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="23063" cy="-6561.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="23063" y="-6580.05" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="23063" y="-6565.05" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="23063" y="-6550.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="23063" y="-6535.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu7&#45;&gt;l2_attn_out_gpu7 -->
<g id="edge808" class="edge">
<title>l2_attn_stage15_gpu7&#45;&gt;l2_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M23361.6,-6655.17C23347.71,-6649.31 23332.95,-6643.37 23319,-6638.33 23260.31,-6617.14 23192.58,-6597.2 23141.54,-6583.06"/>
<polygon fill="black" stroke="black" points="23142.45,-6579.68 23131.88,-6580.39 23140.59,-6586.43 23142.45,-6579.68"/>
</g>
<!-- l2_attn_out_gpu8 -->
<g id="node625" class="node">
<title>l2_attn_out_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="18817" cy="-6561.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="18817" y="-6580.05" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="18817" y="-6565.05" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="18817" y="-6550.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="18817" y="-6535.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu8&#45;&gt;l2_attn_out_gpu8 -->
<g id="edge809" class="edge">
<title>l2_attn_stage15_gpu8&#45;&gt;l2_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M20207.71,-6682.41C19995.64,-6680.35 19468.98,-6669.09 19033,-6609.33 18987.16,-6603.05 18936.59,-6592.24 18895.91,-6582.56"/>
<polygon fill="black" stroke="black" points="18896.6,-6579.13 18886.06,-6580.2 18894.96,-6585.94 18896.6,-6579.13"/>
</g>
<!-- l2_attn_out_gpu9 -->
<g id="node626" class="node">
<title>l2_attn_out_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="22855" cy="-6561.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="22855" y="-6580.05" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="22855" y="-6565.05" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="22855" y="-6550.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="22855" y="-6535.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu9&#45;&gt;l2_attn_out_gpu9 -->
<g id="edge810" class="edge">
<title>l2_attn_stage15_gpu9&#45;&gt;l2_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M23154.69,-6654.76C23140.55,-6648.81 23125.4,-6642.95 23111,-6638.33 23053.8,-6619.99 23036.56,-6626.48 22979,-6609.33 22962.03,-6604.28 22944.06,-6598.01 22927.23,-6591.71"/>
<polygon fill="black" stroke="black" points="22928.06,-6588.28 22917.47,-6588.01 22925.58,-6594.83 22928.06,-6588.28"/>
</g>
<!-- l2_attn_out_gpu10 -->
<g id="node627" class="node">
<title>l2_attn_out_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="19295" cy="-6561.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="19295" y="-6580.05" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="19295" y="-6565.05" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="19295" y="-6550.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="19295" y="-6535.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu10&#45;&gt;l2_attn_out_gpu10 -->
<g id="edge811" class="edge">
<title>l2_attn_stage15_gpu10&#45;&gt;l2_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M20662.02,-6653.69C20647.1,-6647.39 20630.76,-6641.64 20615,-6638.33 20556.77,-6626.11 19603.38,-6632.12 19544,-6628.33 19472.53,-6623.77 19452.36,-6630.66 19384,-6609.33 19375.42,-6606.66 19366.7,-6603.16 19358.24,-6599.27"/>
<polygon fill="black" stroke="black" points="19359.71,-6596.09 19349.18,-6594.93 19356.68,-6602.41 19359.71,-6596.09"/>
</g>
<!-- l2_attn_out_gpu11 -->
<g id="node628" class="node">
<title>l2_attn_out_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="21627" cy="-6561.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="21627" y="-6580.05" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="21627" y="-6565.05" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="21627" y="-6550.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="21627" y="-6535.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu11&#45;&gt;l2_attn_out_gpu11 -->
<g id="edge812" class="edge">
<title>l2_attn_stage15_gpu11&#45;&gt;l2_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M21906.35,-6654.82C21892.29,-6648.91 21877.27,-6643.04 21863,-6638.33 21810.08,-6620.86 21794.03,-6626.47 21741,-6609.33 21726.63,-6604.69 21711.52,-6599.03 21697.17,-6593.26"/>
<polygon fill="black" stroke="black" points="21698.45,-6590.01 21687.87,-6589.47 21695.8,-6596.49 21698.45,-6590.01"/>
</g>
<!-- l2_attn_out_gpu12 -->
<g id="node629" class="node">
<title>l2_attn_out_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="19468" cy="-6561.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="19468" y="-6580.05" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="19468" y="-6565.05" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19468" y="-6550.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="19468" y="-6535.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu12&#45;&gt;l2_attn_out_gpu12 -->
<g id="edge813" class="edge">
<title>l2_attn_stage15_gpu12&#45;&gt;l2_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M20870.01,-6653.73C20855.09,-6647.43 20838.75,-6641.67 20823,-6638.33 20781.85,-6629.62 20108.05,-6629.39 20066,-6628.33 19952.18,-6625.47 19663.76,-6639.59 19554,-6609.33 19545.86,-6607.09 19537.65,-6603.95 19529.7,-6600.34"/>
<polygon fill="black" stroke="black" points="19531.03,-6597.1 19520.5,-6595.92 19528,-6603.41 19531.03,-6597.1"/>
</g>
<!-- l2_attn_out_gpu13 -->
<g id="node630" class="node">
<title>l2_attn_out_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="21825" cy="-6561.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="21825" y="-6580.05" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="21825" y="-6565.05" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="21825" y="-6550.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="21825" y="-6535.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu13&#45;&gt;l2_attn_out_gpu13 -->
<g id="edge814" class="edge">
<title>l2_attn_stage15_gpu13&#45;&gt;l2_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M22114.66,-6654.85C22100.52,-6648.9 22085.38,-6643.01 22071,-6638.33 22015.94,-6620.43 21999.3,-6626.48 21944,-6609.33 21928.36,-6604.48 21911.86,-6598.52 21896.29,-6592.49"/>
<polygon fill="black" stroke="black" points="21897.33,-6589.14 21886.74,-6588.74 21894.77,-6595.66 21897.33,-6589.14"/>
</g>
<!-- l2_attn_out_gpu14 -->
<g id="node631" class="node">
<title>l2_attn_out_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="20183" cy="-6561.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="20183" y="-6580.05" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="20183" y="-6565.05" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="20183" y="-6550.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="20183" y="-6535.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu14&#45;&gt;l2_attn_out_gpu14 -->
<g id="edge815" class="edge">
<title>l2_attn_stage15_gpu14&#45;&gt;l2_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M21285.35,-6654.02C21270.58,-6647.8 21254.48,-6642 21239,-6638.33 21032.32,-6589.39 20973.86,-6624.38 20762,-6609.33 20586.16,-6596.84 20380.51,-6579.46 20267.74,-6569.68"/>
<polygon fill="black" stroke="black" points="20267.72,-6566.17 20257.45,-6568.79 20267.11,-6573.14 20267.72,-6566.17"/>
</g>
<!-- l2_attn_out_gpu15 -->
<g id="node632" class="node">
<title>l2_attn_out_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="22028" cy="-6561.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="22028" y="-6580.05" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="22028" y="-6565.05" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="22028" y="-6550.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="22028" y="-6535.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu15&#45;&gt;l2_attn_out_gpu15 -->
<g id="edge816" class="edge">
<title>l2_attn_stage15_gpu15&#45;&gt;l2_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M22322.68,-6654.79C22308.54,-6648.85 22293.39,-6642.97 22279,-6638.33 22222.66,-6620.17 22205.64,-6626.56 22149,-6609.33 22132.78,-6604.4 22115.64,-6598.3 22099.52,-6592.14"/>
<polygon fill="black" stroke="black" points="22100.76,-6588.87 22090.17,-6588.52 22098.23,-6595.39 22100.76,-6588.87"/>
</g>
<!-- l2_qkv_gpu0&#45;&gt;l2_attn_stage0_gpu0 -->
<g id="edge545" class="edge">
<title>l2_qkv_gpu0&#45;&gt;l2_attn_stage0_gpu0</title>
<path fill="none" stroke="black" d="M24926.32,-8985.06C24932.94,-8969.16 24940.35,-8951.39 24946.95,-8935.55"/>
<polygon fill="black" stroke="black" points="24950.33,-8936.54 24950.94,-8925.97 24943.87,-8933.85 24950.33,-8936.54"/>
</g>
<!-- l2_qkv_gpu1&#45;&gt;l2_attn_stage0_gpu1 -->
<g id="edge546" class="edge">
<title>l2_qkv_gpu1&#45;&gt;l2_attn_stage0_gpu1</title>
<path fill="none" stroke="black" d="M24526.5,-8985.84C24534.86,-8969.62 24544.27,-8951.37 24552.62,-8935.17"/>
<polygon fill="black" stroke="black" points="24555.93,-8936.4 24557.4,-8925.9 24549.71,-8933.19 24555.93,-8936.4"/>
</g>
<!-- l2_qkv_gpu2&#45;&gt;l2_attn_stage0_gpu2 -->
<g id="edge547" class="edge">
<title>l2_qkv_gpu2&#45;&gt;l2_attn_stage0_gpu2</title>
<path fill="none" stroke="black" d="M25924.99,-8984.27C25927.58,-8968.98 25930.46,-8952.02 25933.05,-8936.74"/>
<polygon fill="black" stroke="black" points="25936.57,-8936.92 25934.79,-8926.47 25929.67,-8935.75 25936.57,-8936.92"/>
</g>
<!-- l2_qkv_gpu3&#45;&gt;l2_attn_stage0_gpu3 -->
<g id="edge548" class="edge">
<title>l2_qkv_gpu3&#45;&gt;l2_attn_stage0_gpu3</title>
<path fill="none" stroke="black" d="M26324.33,-8984.27C26325.41,-8968.98 26326.61,-8952.02 26327.69,-8936.74"/>
<polygon fill="black" stroke="black" points="26331.2,-8936.7 26328.41,-8926.47 26324.22,-8936.2 26331.2,-8936.7"/>
</g>
<!-- l2_qkv_gpu4&#45;&gt;l2_attn_stage0_gpu4 -->
<g id="edge549" class="edge">
<title>l2_qkv_gpu4&#45;&gt;l2_attn_stage0_gpu4</title>
<path fill="none" stroke="black" d="M25126.03,-8985.06C25131.86,-8969.16 25138.39,-8951.39 25144.21,-8935.55"/>
<polygon fill="black" stroke="black" points="25147.57,-8936.56 25147.73,-8925.97 25141,-8934.15 25147.57,-8936.56"/>
</g>
<!-- l2_qkv_gpu5&#45;&gt;l2_attn_stage0_gpu5 -->
<g id="edge550" class="edge">
<title>l2_qkv_gpu5&#45;&gt;l2_attn_stage0_gpu5</title>
<path fill="none" stroke="black" d="M26124.66,-8984.27C26126.5,-8968.98 26128.53,-8952.02 26130.37,-8936.74"/>
<polygon fill="black" stroke="black" points="26133.88,-8936.82 26131.6,-8926.47 26126.93,-8935.99 26133.88,-8936.82"/>
</g>
<!-- l2_qkv_gpu6&#45;&gt;l2_attn_stage0_gpu6 -->
<g id="edge551" class="edge">
<title>l2_qkv_gpu6&#45;&gt;l2_attn_stage0_gpu6</title>
<path fill="none" stroke="black" d="M23926.74,-8986.62C23937.92,-8969.78 23950.61,-8950.67 23961.74,-8933.91"/>
<polygon fill="black" stroke="black" points="23964.79,-8935.64 23967.4,-8925.38 23958.95,-8931.77 23964.79,-8935.64"/>
</g>
<!-- l2_qkv_gpu7&#45;&gt;l2_attn_stage0_gpu7 -->
<g id="edge552" class="edge">
<title>l2_qkv_gpu7&#45;&gt;l2_attn_stage0_gpu7</title>
<path fill="none" stroke="black" d="M26723.67,-8984.27C26723.24,-8968.98 26722.76,-8952.02 26722.33,-8936.74"/>
<polygon fill="black" stroke="black" points="26725.82,-8936.37 26722.04,-8926.47 26718.82,-8936.57 26725.82,-8936.37"/>
</g>
<!-- l2_qkv_gpu8&#45;&gt;l2_attn_stage0_gpu8 -->
<g id="edge553" class="edge">
<title>l2_qkv_gpu8&#45;&gt;l2_attn_stage0_gpu8</title>
<path fill="none" stroke="black" d="M23726.68,-8987.01C23738.91,-8969.86 23752.86,-8950.31 23765.02,-8933.26"/>
<polygon fill="black" stroke="black" points="23767.88,-8935.28 23770.83,-8925.11 23762.18,-8931.22 23767.88,-8935.28"/>
</g>
<!-- l2_qkv_gpu9&#45;&gt;l2_attn_stage0_gpu9 -->
<g id="edge554" class="edge">
<title>l2_qkv_gpu9&#45;&gt;l2_attn_stage0_gpu9</title>
<path fill="none" stroke="black" d="M26524,-8984.27C26524.32,-8968.98 26524.68,-8952.02 26525.01,-8936.74"/>
<polygon fill="black" stroke="black" points="26528.51,-8936.55 26525.22,-8926.47 26521.51,-8936.4 26528.51,-8936.55"/>
</g>
<!-- l2_qkv_gpu10&#45;&gt;l2_attn_stage0_gpu10 -->
<g id="edge555" class="edge">
<title>l2_qkv_gpu10&#45;&gt;l2_attn_stage0_gpu10</title>
<path fill="none" stroke="black" d="M24126.77,-8986.23C24137,-8969.57 24148.59,-8950.72 24158.78,-8934.14"/>
<polygon fill="black" stroke="black" points="24162.02,-8935.54 24164.28,-8925.19 24156.06,-8931.87 24162.02,-8935.54"/>
</g>
<!-- l2_qkv_gpu11&#45;&gt;l2_attn_stage0_gpu11 -->
<g id="edge556" class="edge">
<title>l2_qkv_gpu11&#45;&gt;l2_attn_stage0_gpu11</title>
<path fill="none" stroke="black" d="M25325.86,-8984.66C25330.82,-8969.07 25336.33,-8951.71 25341.28,-8936.15"/>
<polygon fill="black" stroke="black" points="25344.74,-8936.81 25344.43,-8926.22 25338.07,-8934.69 25344.74,-8936.81"/>
</g>
<!-- l2_qkv_gpu12&#45;&gt;l2_attn_stage0_gpu12 -->
<g id="edge557" class="edge">
<title>l2_qkv_gpu12&#45;&gt;l2_attn_stage0_gpu12</title>
<path fill="none" stroke="black" d="M24326.75,-8985.84C24336.08,-8969.33 24346.59,-8950.72 24355.87,-8934.31"/>
<polygon fill="black" stroke="black" points="24359,-8935.88 24360.88,-8925.45 24352.91,-8932.43 24359,-8935.88"/>
</g>
<!-- l2_qkv_gpu13&#45;&gt;l2_attn_stage0_gpu13 -->
<g id="edge558" class="edge">
<title>l2_qkv_gpu13&#45;&gt;l2_attn_stage0_gpu13</title>
<path fill="none" stroke="black" d="M25525.55,-8984.66C25529.73,-8969.07 25534.39,-8951.71 25538.57,-8936.15"/>
<polygon fill="black" stroke="black" points="25542.02,-8936.79 25541.23,-8926.22 25535.26,-8934.97 25542.02,-8936.79"/>
</g>
<!-- l2_qkv_gpu14&#45;&gt;l2_attn_stage0_gpu14 -->
<g id="edge559" class="edge">
<title>l2_qkv_gpu14&#45;&gt;l2_attn_stage0_gpu14</title>
<path fill="none" stroke="black" d="M24726.43,-8985.45C24733.98,-8969.25 24742.46,-8951.06 24749.97,-8934.94"/>
<polygon fill="black" stroke="black" points="24753.22,-8936.25 24754.28,-8925.71 24746.88,-8933.29 24753.22,-8936.25"/>
</g>
<!-- l2_qkv_gpu15&#45;&gt;l2_attn_stage0_gpu15 -->
<g id="edge560" class="edge">
<title>l2_qkv_gpu15&#45;&gt;l2_attn_stage0_gpu15</title>
<path fill="none" stroke="black" d="M25725.32,-8984.27C25728.7,-8968.83 25732.46,-8951.69 25735.83,-8936.3"/>
<polygon fill="black" stroke="black" points="25739.26,-8936.99 25737.98,-8926.47 25732.42,-8935.49 25739.26,-8936.99"/>
</g>
<!-- l2_gate_gpu0 -->
<g id="node633" class="node">
<title>l2_gate_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="19861" cy="-6438.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="19861" y="-6449.97" font-family="Times,serif" font-size="14.00">L2 Gate</text>
<text text-anchor="middle" x="19861" y="-6434.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="19861" y="-6419.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l2_attn_out_gpu0&#45;&gt;l2_gate_gpu0 -->
<g id="edge817" class="edge">
<title>l2_attn_out_gpu0&#45;&gt;l2_gate_gpu0</title>
<path fill="none" stroke="black" d="M20771.63,-6554.54C20571.08,-6538.96 20028.89,-6495.59 19950,-6476.17 19942.28,-6474.26 19934.34,-6471.81 19926.55,-6469.07"/>
<polygon fill="black" stroke="black" points="19927.73,-6465.77 19917.14,-6465.6 19925.31,-6472.34 19927.73,-6465.77"/>
</g>
<!-- l2_gate_gpu1 -->
<g id="node658" class="node">
<title>l2_gate_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19505" cy="-6438.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="19505" y="-6449.97" font-family="Times,serif" font-size="14.00">L2 Gate</text>
<text text-anchor="middle" x="19505" y="-6434.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19505" y="-6419.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l2_attn_out_gpu1&#45;&gt;l2_gate_gpu1 -->
<g id="edge842" class="edge">
<title>l2_attn_out_gpu1&#45;&gt;l2_gate_gpu1</title>
<path fill="none" stroke="black" d="M19595.19,-6521.43C19580.31,-6507.95 19563.62,-6492.81 19548.68,-6479.27"/>
<polygon fill="black" stroke="black" points="19550.8,-6476.47 19541.04,-6472.34 19546.1,-6481.65 19550.8,-6476.47"/>
</g>
<!-- l2_gate_gpu2 -->
<g id="node659" class="node">
<title>l2_gate_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20751" cy="-6438.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="20751" y="-6449.97" font-family="Times,serif" font-size="14.00">L2 Gate</text>
<text text-anchor="middle" x="20751" y="-6434.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20751" y="-6419.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l2_attn_out_gpu2&#45;&gt;l2_gate_gpu2 -->
<g id="edge867" class="edge">
<title>l2_attn_out_gpu2&#45;&gt;l2_gate_gpu2</title>
<path fill="none" stroke="black" d="M22173.01,-6532.08C22153.93,-6524.44 22132.46,-6517.18 22112,-6513.17 21991.72,-6489.57 21131.32,-6503.02 21009,-6495.17 20933.57,-6490.32 20913.22,-6494.91 20840,-6476.17 20832.29,-6474.19 20824.37,-6471.69 20816.59,-6468.92"/>
<polygon fill="black" stroke="black" points="20817.77,-6465.63 20807.18,-6465.44 20815.34,-6472.19 20817.77,-6465.63"/>
</g>
<!-- l2_gate_gpu3 -->
<g id="node660" class="node">
<title>l2_gate_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="21107" cy="-6438.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="21107" y="-6449.97" font-family="Times,serif" font-size="14.00">L2 Gate</text>
<text text-anchor="middle" x="21107" y="-6434.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="21107" y="-6419.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l2_attn_out_gpu3&#45;&gt;l2_gate_gpu3 -->
<g id="edge892" class="edge">
<title>l2_attn_out_gpu3&#45;&gt;l2_gate_gpu3</title>
<path fill="none" stroke="black" d="M22586.58,-6532.47C22567.03,-6524.75 22544.97,-6517.34 22524,-6513.17 22379.23,-6484.31 21340.42,-6506.72 21196,-6476.17 21188.1,-6474.49 21180.01,-6472.15 21172.09,-6469.45"/>
<polygon fill="black" stroke="black" points="21173.12,-6466.1 21162.52,-6466 21170.74,-6472.69 21173.12,-6466.1"/>
</g>
<!-- l2_gate_gpu4 -->
<g id="node661" class="node">
<title>l2_gate_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="20039" cy="-6438.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="20039" y="-6449.97" font-family="Times,serif" font-size="14.00">L2 Gate</text>
<text text-anchor="middle" x="20039" y="-6434.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="20039" y="-6419.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l2_attn_out_gpu4&#45;&gt;l2_gate_gpu4 -->
<g id="edge917" class="edge">
<title>l2_attn_out_gpu4&#45;&gt;l2_gate_gpu4</title>
<path fill="none" stroke="black" d="M21365.35,-6552.02C21266.46,-6541.3 21085.23,-6522.79 20930,-6513.17 20677.47,-6497.51 20613.61,-6509.45 20361,-6495.17 20257.27,-6489.3 20229.04,-6500.39 20128,-6476.17 20120.26,-6474.31 20112.33,-6471.88 20104.53,-6469.16"/>
<polygon fill="black" stroke="black" points="20105.7,-6465.86 20095.11,-6465.71 20103.3,-6472.44 20105.7,-6465.86"/>
</g>
<!-- l2_gate_gpu5 -->
<g id="node662" class="node">
<title>l2_gate_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="20929" cy="-6438.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="20929" y="-6449.97" font-family="Times,serif" font-size="14.00">L2 Gate</text>
<text text-anchor="middle" x="20929" y="-6434.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="20929" y="-6419.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l2_attn_out_gpu5&#45;&gt;l2_gate_gpu5 -->
<g id="edge942" class="edge">
<title>l2_attn_out_gpu5&#45;&gt;l2_gate_gpu5</title>
<path fill="none" stroke="black" d="M22379.59,-6532.43C22360.03,-6524.7 22337.97,-6517.31 22317,-6513.17 22236.42,-6497.25 21660.1,-6497.56 21578,-6495.17 21329.07,-6487.91 21261.48,-6528.46 21018,-6476.17 21010.11,-6474.47 21002.02,-6472.11 20994.1,-6469.41"/>
<polygon fill="black" stroke="black" points="20995.13,-6466.06 20984.53,-6465.95 20992.75,-6472.64 20995.13,-6466.06"/>
</g>
<!-- l2_gate_gpu6 -->
<g id="node663" class="node">
<title>l2_gate_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="18971" cy="-6438.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="18971" y="-6449.97" font-family="Times,serif" font-size="14.00">L2 Gate</text>
<text text-anchor="middle" x="18971" y="-6434.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="18971" y="-6419.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l2_attn_out_gpu6&#45;&gt;l2_gate_gpu6 -->
<g id="edge967" class="edge">
<title>l2_attn_out_gpu6&#45;&gt;l2_gate_gpu6</title>
<path fill="none" stroke="black" d="M19071.61,-6522.76C19054.47,-6508.61 19034.96,-6492.49 19017.71,-6478.25"/>
<polygon fill="black" stroke="black" points="19019.9,-6475.52 19009.96,-6471.85 19015.44,-6480.91 19019.9,-6475.52"/>
</g>
<!-- l2_gate_gpu7 -->
<g id="node664" class="node">
<title>l2_gate_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="22856" cy="-6438.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="22856" y="-6449.97" font-family="Times,serif" font-size="14.00">L2 Gate</text>
<text text-anchor="middle" x="22856" y="-6434.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="22856" y="-6419.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l2_attn_out_gpu7&#45;&gt;l2_gate_gpu7 -->
<g id="edge992" class="edge">
<title>l2_attn_out_gpu7&#45;&gt;l2_gate_gpu7</title>
<path fill="none" stroke="black" d="M23008.07,-6528.25C22979.09,-6511.37 22943.54,-6490.66 22914.1,-6473.51"/>
<polygon fill="black" stroke="black" points="22915.57,-6470.32 22905.17,-6468.31 22912.05,-6476.37 22915.57,-6470.32"/>
</g>
<!-- l2_gate_gpu8 -->
<g id="node665" class="node">
<title>l2_gate_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="18793" cy="-6438.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="18793" y="-6449.97" font-family="Times,serif" font-size="14.00">L2 Gate</text>
<text text-anchor="middle" x="18793" y="-6434.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="18793" y="-6419.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l2_attn_out_gpu8&#45;&gt;l2_gate_gpu8 -->
<g id="edge1017" class="edge">
<title>l2_attn_out_gpu8&#45;&gt;l2_gate_gpu8</title>
<path fill="none" stroke="black" d="M18807.65,-6513.28C18805.87,-6504.35 18804.01,-6495 18802.24,-6486.08"/>
<polygon fill="black" stroke="black" points="18805.66,-6485.36 18800.28,-6476.24 18798.8,-6486.73 18805.66,-6485.36"/>
</g>
<!-- l2_gate_gpu9 -->
<g id="node666" class="node">
<title>l2_gate_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="21285" cy="-6438.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="21285" y="-6449.97" font-family="Times,serif" font-size="14.00">L2 Gate</text>
<text text-anchor="middle" x="21285" y="-6434.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="21285" y="-6419.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l2_attn_out_gpu9&#45;&gt;l2_gate_gpu9 -->
<g id="edge1026" class="edge">
<title>l2_attn_out_gpu9&#45;&gt;l2_gate_gpu9</title>
<path fill="none" stroke="black" d="M22794.33,-6532.89C22774.53,-6525.14 22752.18,-6517.61 22731,-6513.17 22470.2,-6458.44 21649.52,-6443.95 21375.26,-6440.58"/>
<polygon fill="black" stroke="black" points="21375,-6437.08 21364.96,-6440.46 21374.91,-6444.08 21375,-6437.08"/>
</g>
<!-- l2_gate_gpu10 -->
<g id="node667" class="node">
<title>l2_gate_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="19149" cy="-6438.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="19149" y="-6449.97" font-family="Times,serif" font-size="14.00">L2 Gate</text>
<text text-anchor="middle" x="19149" y="-6434.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="19149" y="-6419.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l2_attn_out_gpu10&#45;&gt;l2_gate_gpu10 -->
<g id="edge1035" class="edge">
<title>l2_attn_out_gpu10&#45;&gt;l2_gate_gpu10</title>
<path fill="none" stroke="black" d="M19249.61,-6522.76C19232.47,-6508.61 19212.96,-6492.49 19195.71,-6478.25"/>
<polygon fill="black" stroke="black" points="19197.9,-6475.52 19187.96,-6471.85 19193.44,-6480.91 19197.9,-6475.52"/>
</g>
<!-- l2_gate_gpu11 -->
<g id="node668" class="node">
<title>l2_gate_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="20217" cy="-6438.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="20217" y="-6449.97" font-family="Times,serif" font-size="14.00">L2 Gate</text>
<text text-anchor="middle" x="20217" y="-6434.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="20217" y="-6419.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l2_attn_out_gpu11&#45;&gt;l2_gate_gpu11 -->
<g id="edge1044" class="edge">
<title>l2_attn_out_gpu11&#45;&gt;l2_gate_gpu11</title>
<path fill="none" stroke="black" d="M21570.42,-6529.63C21555.42,-6522.92 21538.95,-6516.76 21523,-6513.17 21414.04,-6488.63 20629.52,-6501.15 20518,-6495.17 20423.54,-6490.09 20397.9,-6498.59 20306,-6476.17 20298.27,-6474.28 20290.34,-6471.83 20282.54,-6469.1"/>
<polygon fill="black" stroke="black" points="20283.72,-6465.8 20273.13,-6465.64 20281.31,-6472.37 20283.72,-6465.8"/>
</g>
<!-- l2_gate_gpu12 -->
<g id="node669" class="node">
<title>l2_gate_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="19327" cy="-6438.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="19327" y="-6449.97" font-family="Times,serif" font-size="14.00">L2 Gate</text>
<text text-anchor="middle" x="19327" y="-6434.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="19327" y="-6419.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l2_attn_out_gpu12&#45;&gt;l2_gate_gpu12 -->
<g id="edge1053" class="edge">
<title>l2_attn_out_gpu12&#45;&gt;l2_gate_gpu12</title>
<path fill="none" stroke="black" d="M19423.39,-6522.1C19407.16,-6508.22 19388.81,-6492.53 19372.51,-6478.59"/>
<polygon fill="black" stroke="black" points="19374.57,-6475.74 19364.69,-6471.9 19370.02,-6481.06 19374.57,-6475.74"/>
</g>
<!-- l2_gate_gpu13 -->
<g id="node670" class="node">
<title>l2_gate_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="20395" cy="-6438.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="20395" y="-6449.97" font-family="Times,serif" font-size="14.00">L2 Gate</text>
<text text-anchor="middle" x="20395" y="-6434.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="20395" y="-6419.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l2_attn_out_gpu13&#45;&gt;l2_gate_gpu13 -->
<g id="edge1062" class="edge">
<title>l2_attn_out_gpu13&#45;&gt;l2_gate_gpu13</title>
<path fill="none" stroke="black" d="M21766.28,-6531.12C21748.9,-6523.85 21729.55,-6517.03 21711,-6513.17 21609.93,-6492.1 20885.15,-6499.45 20782,-6495.17 20649.4,-6489.66 20613.33,-6505.96 20484,-6476.17 20476.13,-6474.35 20468.06,-6471.92 20460.15,-6469.17"/>
<polygon fill="black" stroke="black" points="20461.19,-6465.83 20450.59,-6465.68 20458.78,-6472.4 20461.19,-6465.83"/>
</g>
<!-- l2_gate_gpu14 -->
<g id="node671" class="node">
<title>l2_gate_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19683" cy="-6438.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="19683" y="-6449.97" font-family="Times,serif" font-size="14.00">L2 Gate</text>
<text text-anchor="middle" x="19683" y="-6434.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19683" y="-6419.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l2_attn_out_gpu14&#45;&gt;l2_gate_gpu14 -->
<g id="edge1071" class="edge">
<title>l2_attn_out_gpu14&#45;&gt;l2_gate_gpu14</title>
<path fill="none" stroke="black" d="M20109.96,-6549.55C20026.97,-6536.43 19888.01,-6511.48 19772,-6476.17 19764.7,-6473.94 19757.17,-6471.35 19749.72,-6468.59"/>
<polygon fill="black" stroke="black" points="19750.95,-6465.31 19740.36,-6465.02 19748.46,-6471.85 19750.95,-6465.31"/>
</g>
<!-- l2_gate_gpu15 -->
<g id="node672" class="node">
<title>l2_gate_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20573" cy="-6438.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="20573" y="-6449.97" font-family="Times,serif" font-size="14.00">L2 Gate</text>
<text text-anchor="middle" x="20573" y="-6434.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20573" y="-6419.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l2_attn_out_gpu15&#45;&gt;l2_gate_gpu15 -->
<g id="edge1080" class="edge">
<title>l2_attn_out_gpu15&#45;&gt;l2_gate_gpu15</title>
<path fill="none" stroke="black" d="M21968.43,-6531.84C21949.82,-6524.3 21928.94,-6517.15 21909,-6513.17 21796.21,-6490.65 20988.85,-6501.3 20874,-6495.17 20779.53,-6490.12 20753.9,-6498.59 20662,-6476.17 20654.27,-6474.28 20646.34,-6471.83 20638.54,-6469.1"/>
<polygon fill="black" stroke="black" points="20639.72,-6465.8 20629.13,-6465.64 20637.31,-6472.37 20639.72,-6465.8"/>
</g>
<!-- l2_expert0_gpu0 -->
<g id="node634" class="node">
<title>l2_expert0_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="16376" cy="-6302.08" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="16376" y="-6320.88" font-family="Times,serif" font-size="14.00">L2 Expert0</text>
<text text-anchor="middle" x="16376" y="-6305.88" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="16376" y="-6290.88" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="16376" y="-6275.88" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l2_gate_gpu0&#45;&gt;l2_expert0_gpu0 -->
<g id="edge818" class="edge">
<title>l2_gate_gpu0&#45;&gt;l2_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19806,-6411.28C19794.98,-6407.09 19783.3,-6403.41 19772,-6401.17 19747.33,-6396.27 12545.76,-6400.97 12528,-6383.17 12523.29,-6378.45 12523.33,-6372.92 12528,-6368.17 12596.38,-6298.62 15743.23,-6301.8 16294.13,-6302.89"/>
<polygon fill="black" stroke="black" points="16294.37,-6306.39 16304.37,-6302.91 16294.38,-6299.39 16294.37,-6306.39"/>
<text text-anchor="middle" x="12573.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l2_expert1_gpu1 -->
<g id="node635" class="node">
<title>l2_expert1_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="18647" cy="-6302.08" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="18647" y="-6320.88" font-family="Times,serif" font-size="14.00">L2 Expert1</text>
<text text-anchor="middle" x="18647" y="-6305.88" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="18647" y="-6290.88" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="18647" y="-6275.88" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l2_gate_gpu0&#45;&gt;l2_expert1_gpu1 -->
<g id="edge819" class="edge">
<title>l2_gate_gpu0&#45;&gt;l2_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19805.99,-6411.35C19794.97,-6407.16 19783.29,-6403.45 19772,-6401.17 19748.53,-6396.41 18064.84,-6400.19 18048,-6383.17 18043.31,-6378.43 18043.55,-6373.13 18048,-6368.17 18081.94,-6330.33 18409.61,-6312.43 18565.44,-6306.01"/>
<polygon fill="black" stroke="black" points="18565.6,-6309.5 18575.45,-6305.6 18565.32,-6302.51 18565.6,-6309.5"/>
<text text-anchor="middle" x="18093.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l2_expert2_gpu2 -->
<g id="node636" class="node">
<title>l2_expert2_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="17395" cy="-6302.08" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="17395" y="-6320.88" font-family="Times,serif" font-size="14.00">L2 Expert2</text>
<text text-anchor="middle" x="17395" y="-6305.88" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="17395" y="-6290.88" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="17395" y="-6275.88" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l2_gate_gpu0&#45;&gt;l2_expert2_gpu2 -->
<g id="edge820" class="edge">
<title>l2_gate_gpu0&#45;&gt;l2_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19806,-6411.29C19794.98,-6407.1 19783.3,-6403.41 19772,-6401.17 19734.67,-6393.75 14318.87,-6410.12 14292,-6383.17 14287.29,-6378.44 14287.31,-6372.9 14292,-6368.17 14313.16,-6346.82 16425.96,-6351.04 16456,-6350.17 16773.31,-6340.89 17150.43,-6318.54 17313.35,-6308.33"/>
<polygon fill="black" stroke="black" points="17314.01,-6311.79 17323.77,-6307.67 17313.57,-6304.81 17314.01,-6311.79"/>
<text text-anchor="middle" x="14337.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l2_expert3_gpu3 -->
<g id="node637" class="node">
<title>l2_expert3_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="23677" cy="-6302.08" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="23677" y="-6320.88" font-family="Times,serif" font-size="14.00">L2 Expert3</text>
<text text-anchor="middle" x="23677" y="-6305.88" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="23677" y="-6290.88" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="23677" y="-6275.88" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l2_gate_gpu0&#45;&gt;l2_expert3_gpu3 -->
<g id="edge821" class="edge">
<title>l2_gate_gpu0&#45;&gt;l2_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19916,-6411.29C19927.02,-6407.1 19938.7,-6403.41 19950,-6401.17 19988.05,-6393.6 25509.61,-6410.64 25537,-6383.17 25541.71,-6378.44 25541.63,-6372.96 25537,-6368.17 25474.44,-6303.38 24109.64,-6302.08 23758.69,-6302.82"/>
<polygon fill="black" stroke="black" points="23758.6,-6299.32 23748.6,-6302.84 23758.61,-6306.32 23758.6,-6299.32"/>
<text text-anchor="middle" x="25585.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l2_expert4_gpu4 -->
<g id="node638" class="node">
<title>l2_expert4_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="22133" cy="-6302.08" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="22133" y="-6320.88" font-family="Times,serif" font-size="14.00">L2 Expert4</text>
<text text-anchor="middle" x="22133" y="-6305.88" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="22133" y="-6290.88" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="22133" y="-6275.88" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l2_gate_gpu0&#45;&gt;l2_expert4_gpu4 -->
<g id="edge822" class="edge">
<title>l2_gate_gpu0&#45;&gt;l2_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19916,-6411.3C19927.03,-6407.11 19938.7,-6403.42 19950,-6401.17 19975.26,-6396.12 23640.83,-6401.42 23659,-6383.17 23663.7,-6378.44 23663.61,-6372.98 23659,-6368.17 23608.72,-6315.69 22525.15,-6305.36 22215.16,-6303.48"/>
<polygon fill="black" stroke="black" points="22214.93,-6299.98 22204.9,-6303.42 22214.88,-6306.98 22214.93,-6299.98"/>
<text text-anchor="middle" x="23707.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l2_expert5_gpu5 -->
<g id="node639" class="node">
<title>l2_expert5_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="18000" cy="-6302.08" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="18000" y="-6320.88" font-family="Times,serif" font-size="14.00">L2 Expert5</text>
<text text-anchor="middle" x="18000" y="-6305.88" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="18000" y="-6290.88" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="18000" y="-6275.88" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l2_gate_gpu0&#45;&gt;l2_expert5_gpu5 -->
<g id="edge823" class="edge">
<title>l2_gate_gpu0&#45;&gt;l2_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19806,-6411.3C19794.97,-6407.11 19783.3,-6403.42 19772,-6401.17 19747.47,-6396.27 16187.64,-6400.9 16170,-6383.17 16165.3,-6378.44 16165.32,-6372.91 16170,-6368.17 16182.73,-6355.26 17456.9,-6351.1 17475,-6350.17 17632.87,-6342.01 17816.74,-6323.42 17919.63,-6312.19"/>
<polygon fill="black" stroke="black" points="17920.08,-6315.67 17929.64,-6311.1 17919.32,-6308.71 17920.08,-6315.67"/>
<text text-anchor="middle" x="16215.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l2_expert6_gpu6 -->
<g id="node640" class="node">
<title>l2_expert6_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19795" cy="-6302.08" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="19795" y="-6320.88" font-family="Times,serif" font-size="14.00">L2 Expert6</text>
<text text-anchor="middle" x="19795" y="-6305.88" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19795" y="-6290.88" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="19795" y="-6275.88" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l2_gate_gpu0&#45;&gt;l2_expert6_gpu6 -->
<g id="edge824" class="edge">
<title>l2_gate_gpu0&#45;&gt;l2_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19896.76,-6405.02C19905.14,-6393.46 19909.86,-6380.32 19903,-6368.17 19894.4,-6352.95 19880.67,-6340.89 19865.83,-6331.51"/>
<polygon fill="black" stroke="black" points="19867.39,-6328.36 19857,-6326.29 19863.83,-6334.39 19867.39,-6328.36"/>
<text text-anchor="middle" x="19951.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l2_expert7_gpu7 -->
<g id="node641" class="node">
<title>l2_expert7_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="20924" cy="-6302.08" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="20924" y="-6320.88" font-family="Times,serif" font-size="14.00">L2 Expert7</text>
<text text-anchor="middle" x="20924" y="-6305.88" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="20924" y="-6290.88" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="20924" y="-6275.88" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l2_gate_gpu0&#45;&gt;l2_expert7_gpu7 -->
<g id="edge825" class="edge">
<title>l2_gate_gpu0&#45;&gt;l2_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19916.01,-6411.35C19927.03,-6407.15 19938.71,-6403.45 19950,-6401.17 19974.93,-6396.13 21763.11,-6401.24 21781,-6383.17 21785.69,-6378.43 21785.53,-6373.05 21781,-6368.17 21728.97,-6312.04 21209.92,-6304.07 21005.81,-6303.12"/>
<polygon fill="black" stroke="black" points="21005.76,-6299.62 20995.75,-6303.08 21005.74,-6306.62 21005.76,-6299.62"/>
<text text-anchor="middle" x="21829.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l2_expert_agg_gpu0 -->
<g id="node642" class="node">
<title>l2_expert_agg_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20730" cy="-6179.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="20730" y="-6190.8" font-family="Times,serif" font-size="14.00">L2 Expert Agg</text>
<text text-anchor="middle" x="20730" y="-6175.8" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20730" y="-6160.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge826" class="edge">
<title>l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M16447.15,-6296.46C16603.74,-6286.52 16990.07,-6263.26 17314,-6254 18457.12,-6221.33 18743.57,-6254.5 19887,-6236 20219.95,-6230.61 20309.5,-6282.46 20636,-6217 20644.54,-6215.29 20653.32,-6212.86 20661.91,-6210.06"/>
<polygon fill="black" stroke="black" points="20663.19,-6213.32 20671.51,-6206.76 20660.92,-6206.7 20663.19,-6213.32"/>
</g>
<!-- l2_expert_agg_gpu1 -->
<g id="node643" class="node">
<title>l2_expert_agg_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19414" cy="-6179.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="19414" y="-6190.8" font-family="Times,serif" font-size="14.00">L2 Expert Agg</text>
<text text-anchor="middle" x="19414" y="-6175.8" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19414" y="-6160.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge827" class="edge">
<title>l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M16447.15,-6296.58C16603.75,-6286.86 16990.09,-6264.03 17314,-6254 17993.72,-6232.95 18164.18,-6253.56 18844,-6236 19055.65,-6230.53 19112.72,-6260.13 19320,-6217 19328.47,-6215.24 19337.17,-6212.8 19345.7,-6210"/>
<polygon fill="black" stroke="black" points="19346.92,-6213.28 19355.23,-6206.72 19344.64,-6206.67 19346.92,-6213.28"/>
</g>
<!-- l2_expert_agg_gpu2 -->
<g id="node644" class="node">
<title>l2_expert_agg_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20542" cy="-6179.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="20542" y="-6190.8" font-family="Times,serif" font-size="14.00">L2 Expert Agg</text>
<text text-anchor="middle" x="20542" y="-6175.8" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20542" y="-6160.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge828" class="edge">
<title>l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M16447.15,-6296.46C16603.74,-6286.53 16990.07,-6263.28 17314,-6254 18435.35,-6221.87 18716.4,-6257.46 19838,-6236 20109.19,-6230.81 20182.21,-6271.09 20448,-6217 20456.54,-6215.26 20465.31,-6212.82 20473.9,-6210.01"/>
<polygon fill="black" stroke="black" points="20475.18,-6213.27 20483.5,-6206.71 20472.91,-6206.65 20475.18,-6213.27"/>
</g>
<!-- l2_expert_agg_gpu3 -->
<g id="node645" class="node">
<title>l2_expert_agg_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="19978" cy="-6179.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="19978" y="-6190.8" font-family="Times,serif" font-size="14.00">L2 Expert Agg</text>
<text text-anchor="middle" x="19978" y="-6175.8" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="19978" y="-6160.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge829" class="edge">
<title>l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M16447.15,-6296.53C16603.75,-6286.72 16990.08,-6263.72 17314,-6254 18127.9,-6229.58 18331.87,-6250.48 19146,-6236 19474.06,-6230.16 19562.31,-6281.56 19884,-6217 19892.54,-6215.28 19901.32,-6212.86 19909.91,-6210.06"/>
<polygon fill="black" stroke="black" points="19911.19,-6213.32 19919.51,-6206.76 19908.92,-6206.7 19911.19,-6213.32"/>
</g>
<!-- l2_expert_agg_gpu4 -->
<g id="node646" class="node">
<title>l2_expert_agg_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="18286" cy="-6179.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="18286" y="-6190.8" font-family="Times,serif" font-size="14.00">L2 Expert Agg</text>
<text text-anchor="middle" x="18286" y="-6175.8" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="18286" y="-6160.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge830" class="edge">
<title>l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M16447.18,-6297.31C16603.83,-6289.06 16990.28,-6268.94 17314,-6254 17509.08,-6244.99 18000.85,-6256.99 18192,-6217 18200.47,-6215.23 18209.17,-6212.78 18217.69,-6209.98"/>
<polygon fill="black" stroke="black" points="18218.91,-6213.27 18227.23,-6206.7 18216.63,-6206.65 18218.91,-6213.27"/>
</g>
<!-- l2_expert_agg_gpu5 -->
<g id="node647" class="node">
<title>l2_expert_agg_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="19038" cy="-6179.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="19038" y="-6190.8" font-family="Times,serif" font-size="14.00">L2 Expert Agg</text>
<text text-anchor="middle" x="19038" y="-6175.8" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="19038" y="-6160.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge831" class="edge">
<title>l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M16447.16,-6296.67C16603.76,-6287.13 16990.11,-6264.62 17314,-6254 17832.89,-6236.98 17963.03,-6250.67 18482,-6236 18687.42,-6230.19 18742.83,-6258.98 18944,-6217 18952.47,-6215.23 18961.17,-6212.79 18969.69,-6209.99"/>
<polygon fill="black" stroke="black" points="18970.91,-6213.27 18979.23,-6206.71 18968.63,-6206.66 18970.91,-6213.27"/>
</g>
<!-- l2_expert_agg_gpu6 -->
<g id="node648" class="node">
<title>l2_expert_agg_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19790" cy="-6179.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="19790" y="-6190.8" font-family="Times,serif" font-size="14.00">L2 Expert Agg</text>
<text text-anchor="middle" x="19790" y="-6175.8" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19790" y="-6160.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge832" class="edge">
<title>l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M16447.15,-6296.54C16603.75,-6286.75 16990.08,-6263.77 17314,-6254 18102.57,-6230.22 18300.24,-6252.34 19089,-6236 19358.85,-6230.41 19431.52,-6270.84 19696,-6217 19704.54,-6215.26 19713.31,-6212.82 19721.9,-6210.01"/>
<polygon fill="black" stroke="black" points="19723.18,-6213.27 19731.5,-6206.71 19720.91,-6206.65 19723.18,-6213.27"/>
</g>
<!-- l2_expert_agg_gpu7 -->
<g id="node649" class="node">
<title>l2_expert_agg_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="18474" cy="-6179.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="18474" y="-6190.8" font-family="Times,serif" font-size="14.00">L2 Expert Agg</text>
<text text-anchor="middle" x="18474" y="-6175.8" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="18474" y="-6160.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge833" class="edge">
<title>l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M16447.16,-6296.88C16603.78,-6287.78 16990.16,-6266.07 17314,-6254 17641.87,-6241.77 17724.18,-6249.49 18052,-6236 18197.9,-6230 18237.31,-6248.03 18380,-6217 18388.39,-6215.17 18397.01,-6212.71 18405.48,-6209.92"/>
<polygon fill="black" stroke="black" points="18406.64,-6213.22 18414.94,-6206.64 18404.35,-6206.6 18406.64,-6213.22"/>
</g>
<!-- l2_expert_agg_gpu8 -->
<g id="node650" class="node">
<title>l2_expert_agg_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20166" cy="-6179.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="20166" y="-6190.8" font-family="Times,serif" font-size="14.00">L2 Expert Agg</text>
<text text-anchor="middle" x="20166" y="-6175.8" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20166" y="-6160.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge834" class="edge">
<title>l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M16447.15,-6296.49C16603.74,-6286.62 16990.07,-6263.48 17314,-6254 18270.07,-6226.02 18509.71,-6254.99 19466,-6236 19735.41,-6230.65 19807.95,-6270.76 20072,-6217 20080.54,-6215.26 20089.31,-6212.82 20097.9,-6210.01"/>
<polygon fill="black" stroke="black" points="20099.18,-6213.27 20107.5,-6206.71 20096.91,-6206.65 20099.18,-6213.27"/>
</g>
<!-- l2_expert_agg_gpu9 -->
<g id="node651" class="node">
<title>l2_expert_agg_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="19602" cy="-6179.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="19602" y="-6190.8" font-family="Times,serif" font-size="14.00">L2 Expert Agg</text>
<text text-anchor="middle" x="19602" y="-6175.8" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="19602" y="-6160.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge835" class="edge">
<title>l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M16447.15,-6296.55C16603.75,-6286.77 16990.08,-6263.82 17314,-6254 18077.69,-6230.84 18269.2,-6255.27 19033,-6236 19244.21,-6230.67 19301.15,-6260.05 19508,-6217 19516.47,-6215.24 19525.17,-6212.8 19533.7,-6210"/>
<polygon fill="black" stroke="black" points="19534.92,-6213.28 19543.23,-6206.72 19532.64,-6206.67 19534.92,-6213.28"/>
</g>
<!-- l2_expert_agg_gpu10 -->
<g id="node652" class="node">
<title>l2_expert_agg_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="17910" cy="-6179.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="17910" y="-6190.8" font-family="Times,serif" font-size="14.00">L2 Expert Agg</text>
<text text-anchor="middle" x="17910" y="-6175.8" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17910" y="-6160.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge836" class="edge">
<title>l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M16446.91,-6295.51C16696.46,-6275.89 17534.25,-6210.04 17816.37,-6187.86"/>
<polygon fill="black" stroke="black" points="17816.88,-6191.33 17826.57,-6187.06 17816.33,-6184.35 17816.88,-6191.33"/>
</g>
<!-- l2_expert_agg_gpu11 -->
<g id="node653" class="node">
<title>l2_expert_agg_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="18662" cy="-6179.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="18662" y="-6190.8" font-family="Times,serif" font-size="14.00">L2 Expert Agg</text>
<text text-anchor="middle" x="18662" y="-6175.8" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18662" y="-6160.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge837" class="edge">
<title>l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M16447.16,-6296.81C16603.77,-6287.56 16990.14,-6265.58 17314,-6254 17688.51,-6240.6 17782.46,-6248.65 18157,-6236 18339.76,-6229.82 18389.09,-6254.81 18568,-6217 18576.46,-6215.21 18585.16,-6212.75 18593.69,-6209.95"/>
<polygon fill="black" stroke="black" points="18594.91,-6213.23 18603.22,-6206.66 18592.62,-6206.62 18594.91,-6213.23"/>
</g>
<!-- l2_expert_agg_gpu12 -->
<g id="node654" class="node">
<title>l2_expert_agg_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="18098" cy="-6179.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="18098" y="-6190.8" font-family="Times,serif" font-size="14.00">L2 Expert Agg</text>
<text text-anchor="middle" x="18098" y="-6175.8" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18098" y="-6160.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge838" class="edge">
<title>l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M16447.32,-6297.47C16759.98,-6281.65 17994.33,-6219.07 18004,-6217 18012.46,-6215.19 18021.15,-6212.72 18029.68,-6209.91"/>
<polygon fill="black" stroke="black" points="18030.9,-6213.19 18039.21,-6206.61 18028.61,-6206.57 18030.9,-6213.19"/>
</g>
<!-- l2_expert_agg_gpu13 -->
<g id="node655" class="node">
<title>l2_expert_agg_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="18850" cy="-6179.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="18850" y="-6190.8" font-family="Times,serif" font-size="14.00">L2 Expert Agg</text>
<text text-anchor="middle" x="18850" y="-6175.8" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18850" y="-6160.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge839" class="edge">
<title>l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M16447.16,-6296.73C16603.76,-6287.32 16990.12,-6265.05 17314,-6254 17756.04,-6238.91 17866.91,-6249.39 18309,-6236 18507.75,-6229.98 18561.38,-6257.76 18756,-6217 18764.47,-6215.23 18773.16,-6212.78 18781.69,-6209.98"/>
<polygon fill="black" stroke="black" points="18782.91,-6213.26 18791.23,-6206.69 18780.63,-6206.65 18782.91,-6213.26"/>
</g>
<!-- l2_expert_agg_gpu14 -->
<g id="node656" class="node">
<title>l2_expert_agg_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19226" cy="-6179.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="19226" y="-6190.8" font-family="Times,serif" font-size="14.00">L2 Expert Agg</text>
<text text-anchor="middle" x="19226" y="-6175.8" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19226" y="-6160.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge840" class="edge">
<title>l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M16447.15,-6296.62C16603.75,-6286.98 16990.1,-6264.29 17314,-6254 17912.42,-6234.99 18062.5,-6252.07 18661,-6236 18870.43,-6230.38 18926.9,-6259.72 19132,-6217 19140.47,-6215.24 19149.17,-6212.79 19157.7,-6210"/>
<polygon fill="black" stroke="black" points="19158.92,-6213.28 19167.23,-6206.71 19156.63,-6206.66 19158.92,-6213.28"/>
</g>
<!-- l2_expert_agg_gpu15 -->
<g id="node657" class="node">
<title>l2_expert_agg_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20354" cy="-6179.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="20354" y="-6190.8" font-family="Times,serif" font-size="14.00">L2 Expert Agg</text>
<text text-anchor="middle" x="20354" y="-6175.8" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20354" y="-6160.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge841" class="edge">
<title>l2_expert0_gpu0&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M16447.15,-6296.49C16603.74,-6286.61 16990.07,-6263.45 17314,-6254 18291.84,-6225.47 18536.88,-6252.47 19515,-6236 19846.17,-6230.42 19935.25,-6282.13 20260,-6217 20268.54,-6215.29 20277.32,-6212.86 20285.91,-6210.06"/>
<polygon fill="black" stroke="black" points="20287.19,-6213.32 20295.51,-6206.76 20284.92,-6206.7 20287.19,-6213.32"/>
</g>
<!-- l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge851" class="edge">
<title>l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M18718.22,-6297.3C18889.74,-6288.34 19339.35,-6265.67 19715,-6254 19742.66,-6253.14 20688.63,-6252.29 20711,-6236 20714.57,-6233.4 20717.47,-6230.1 20719.83,-6226.39"/>
<polygon fill="black" stroke="black" points="20723.09,-6227.7 20724.42,-6217.18 20716.83,-6224.57 20723.09,-6227.7"/>
</g>
<!-- l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge852" class="edge">
<title>l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M18718.6,-6299.68C18897.14,-6295.51 19351.36,-6280.58 19402,-6236 19405.03,-6233.33 19407.4,-6230.09 19409.25,-6226.53"/>
<polygon fill="black" stroke="black" points="19412.52,-6227.76 19412.81,-6217.17 19405.98,-6225.27 19412.52,-6227.76"/>
</g>
<!-- l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge853" class="edge">
<title>l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M18718.22,-6297.41C18889.75,-6288.69 19339.37,-6266.51 19715,-6254 19759.32,-6252.52 20475.33,-6259.4 20513,-6236 20517.45,-6233.24 20521.24,-6229.55 20524.48,-6225.39"/>
<polygon fill="black" stroke="black" points="20527.49,-6227.19 20530.04,-6216.91 20521.63,-6223.35 20527.49,-6227.19"/>
</g>
<!-- l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge854" class="edge">
<title>l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M18718.53,-6298.05C18990.32,-6286.47 19944.37,-6245.19 19957,-6236 19960.71,-6233.3 19963.76,-6229.86 19966.27,-6226.02"/>
<polygon fill="black" stroke="black" points="19969.41,-6227.59 19970.96,-6217.11 19963.21,-6224.33 19969.41,-6227.59"/>
</g>
<!-- l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge855" class="edge">
<title>l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M18576.4,-6293.42C18493.65,-6283.33 18362.64,-6263.6 18322,-6236 18317.37,-6232.85 18313.19,-6228.89 18309.47,-6224.54"/>
<polygon fill="black" stroke="black" points="18312.1,-6222.22 18303.26,-6216.38 18306.53,-6226.46 18312.1,-6222.22"/>
</g>
<!-- l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge856" class="edge">
<title>l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M18718.34,-6298.13C18815.69,-6292.6 18982.97,-6277.22 19026,-6236 19028.8,-6233.32 19031.02,-6230.15 19032.78,-6226.71"/>
<polygon fill="black" stroke="black" points="19036.14,-6227.71 19036.42,-6217.12 19029.6,-6225.23 19036.14,-6227.71"/>
</g>
<!-- l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge857" class="edge">
<title>l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M18718.59,-6299.3C18960.75,-6292.98 19736.41,-6270.12 19777,-6236 19780.15,-6233.35 19782.62,-6230.1 19784.54,-6226.51"/>
<polygon fill="black" stroke="black" points="19787.86,-6227.64 19788.3,-6217.05 19781.36,-6225.06 19787.86,-6227.64"/>
</g>
<!-- l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge858" class="edge">
<title>l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M18593.79,-6269.95C18576.93,-6259.59 18558.41,-6247.71 18542,-6236 18534.87,-6230.91 18527.51,-6225.31 18520.38,-6219.68"/>
<polygon fill="black" stroke="black" points="18522.15,-6216.61 18512.16,-6213.09 18517.77,-6222.07 18522.15,-6216.61"/>
</g>
<!-- l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge859" class="edge">
<title>l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M18718.24,-6297.88C18889.8,-6290.2 19339.51,-6270.12 19715,-6254 19738.94,-6252.97 20126.68,-6250.18 20146,-6236 20149.68,-6233.3 20152.68,-6229.86 20155.13,-6226.02"/>
<polygon fill="black" stroke="black" points="20158.25,-6227.61 20159.66,-6217.11 20152.01,-6224.44 20158.25,-6227.61"/>
</g>
<!-- l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge860" class="edge">
<title>l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M18718.84,-6301C18927.79,-6300.11 19524.62,-6292.58 19590,-6236 19593.06,-6233.35 19595.44,-6230.13 19597.29,-6226.58"/>
<polygon fill="black" stroke="black" points="19600.56,-6227.83 19600.87,-6217.24 19594.03,-6225.33 19600.56,-6227.83"/>
</g>
<!-- l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge861" class="edge">
<title>l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M18575.99,-6295.51C18407.65,-6282.13 17996.37,-6248.39 17969,-6236 17961.08,-6232.41 17953.55,-6227.32 17946.67,-6221.66"/>
<polygon fill="black" stroke="black" points="17948.74,-6218.82 17938.92,-6214.82 17944.1,-6224.06 17948.74,-6218.82"/>
</g>
<!-- l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge862" class="edge">
<title>l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M18653.66,-6254.18C18654.47,-6248.07 18655.27,-6241.89 18656,-6236 18656.35,-6233.16 18656.7,-6230.23 18657.04,-6227.28"/>
<polygon fill="black" stroke="black" points="18660.53,-6227.57 18658.18,-6217.24 18653.58,-6226.78 18660.53,-6227.57"/>
</g>
<!-- l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge863" class="edge">
<title>l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M18576,-6296.15C18460.87,-6287.36 18239.04,-6266.98 18167,-6236 18157.68,-6231.99 18148.58,-6226.36 18140.2,-6220.21"/>
<polygon fill="black" stroke="black" points="18142.14,-6217.28 18132.09,-6213.93 18137.85,-6222.82 18142.14,-6217.28"/>
</g>
<!-- l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge864" class="edge">
<title>l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M18717.57,-6293.35C18757.59,-6285.36 18805.59,-6269.09 18836,-6236 18838.57,-6233.2 18840.69,-6230 18842.43,-6226.58"/>
<polygon fill="black" stroke="black" points="18845.74,-6227.72 18846.2,-6217.13 18839.24,-6225.12 18845.74,-6227.72"/>
</g>
<!-- l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge865" class="edge">
<title>l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M18718.25,-6297.5C18862.37,-6289.59 19177.88,-6268.72 19214,-6236 19217,-6233.28 19219.34,-6230.02 19221.17,-6226.44"/>
<polygon fill="black" stroke="black" points="19224.45,-6227.65 19224.7,-6217.06 19217.9,-6225.18 19224.45,-6227.65"/>
</g>
<!-- l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge866" class="edge">
<title>l2_expert1_gpu1&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M18718.23,-6297.58C18889.76,-6289.21 19339.42,-6267.76 19715,-6254 19749.27,-6252.74 20303.92,-6255.68 20332,-6236 20335.83,-6233.32 20338.99,-6229.86 20341.6,-6225.98"/>
<polygon fill="black" stroke="black" points="20344.8,-6227.41 20346.48,-6216.95 20338.65,-6224.08 20344.8,-6227.41"/>
</g>
<!-- l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge876" class="edge">
<title>l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M17465.22,-6292.9C17565.64,-6281.63 17756.15,-6261.83 17919,-6254 17957.21,-6252.16 20637.61,-6250.52 20673,-6236 20680.99,-6232.72 20688.48,-6227.73 20695.23,-6222.07"/>
<polygon fill="black" stroke="black" points="20697.77,-6224.49 20702.81,-6215.16 20693.06,-6219.31 20697.77,-6224.49"/>
</g>
<!-- l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge877" class="edge">
<title>l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M17465.23,-6293.03C17565.65,-6281.92 17756.17,-6262.3 17919,-6254 17959.59,-6251.93 19346.93,-6256.55 19382,-6236 19386.8,-6233.19 19390.94,-6229.36 19394.51,-6225.01"/>
<polygon fill="black" stroke="black" points="19397.43,-6226.94 19400.31,-6216.75 19391.7,-6222.92 19397.43,-6226.94"/>
</g>
<!-- l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge878" class="edge">
<title>l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M17465.22,-6292.92C17565.64,-6281.66 17756.15,-6261.88 17919,-6254 17989.23,-6250.6 20382.33,-6255.09 20450,-6236 20464.15,-6232.01 20478.31,-6225.21 20491.12,-6217.72"/>
<polygon fill="black" stroke="black" points="20493.05,-6220.64 20499.77,-6212.45 20489.41,-6214.67 20493.05,-6220.64"/>
</g>
<!-- l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge879" class="edge">
<title>l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M17465.22,-6292.96C17565.65,-6281.75 17756.16,-6262.03 17919,-6254 17974.91,-6251.24 19883.71,-6260.58 19934,-6236 19940.16,-6232.99 19945.72,-6228.65 19950.66,-6223.72"/>
<polygon fill="black" stroke="black" points="19953.38,-6225.93 19957.44,-6216.14 19948.16,-6221.26 19953.38,-6225.93"/>
</g>
<!-- l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge880" class="edge">
<title>l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M17465.7,-6293.88C17566.31,-6283.82 17756.6,-6265.52 17919,-6254 17957.4,-6251.28 18233.91,-6258.7 18265,-6236 18268.7,-6233.3 18271.76,-6229.85 18274.27,-6226.01"/>
<polygon fill="black" stroke="black" points="18277.4,-6227.58 18278.95,-6217.1 18271.2,-6224.32 18277.4,-6227.58"/>
</g>
<!-- l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge881" class="edge">
<title>l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M17465.65,-6293.08C17566.2,-6282.07 17756.42,-6262.64 17919,-6254 17949.18,-6252.4 18981.06,-6251.51 19007,-6236 19011.74,-6233.17 19015.8,-6229.32 19019.29,-6224.97"/>
<polygon fill="black" stroke="black" points="19022.19,-6226.93 19024.93,-6216.7 19016.4,-6222.99 19022.19,-6226.93"/>
</g>
<!-- l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge882" class="edge">
<title>l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M17465.22,-6292.98C17565.65,-6281.8 17756.16,-6262.1 17919,-6254 17969.86,-6251.47 19707.08,-6259.97 19752,-6236 19757.41,-6233.11 19762.2,-6229.07 19766.4,-6224.47"/>
<polygon fill="black" stroke="black" points="19769.41,-6226.32 19772.91,-6216.32 19763.94,-6221.95 19769.41,-6226.32"/>
</g>
<!-- l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge883" class="edge">
<title>l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M17465.68,-6293.57C17566.26,-6283.15 17756.52,-6264.41 17919,-6254 17971.04,-6250.66 18338.27,-6251.7 18388,-6236 18400.83,-6231.95 18413.59,-6225.44 18425.2,-6218.28"/>
<polygon fill="black" stroke="black" points="18427.33,-6221.07 18433.84,-6212.71 18423.54,-6215.19 18427.33,-6221.07"/>
</g>
<!-- l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge884" class="edge">
<title>l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M17465.22,-6292.94C17565.64,-6281.71 17756.16,-6261.97 17919,-6254 17949.55,-6252.5 20093.44,-6249.27 20121,-6236 20127.31,-6232.96 20133.02,-6228.57 20138.1,-6223.56"/>
<polygon fill="black" stroke="black" points="20140.94,-6225.63 20145.07,-6215.87 20135.76,-6220.93 20140.94,-6225.63"/>
</g>
<!-- l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge885" class="edge">
<title>l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M17465.22,-6293C17565.65,-6281.85 17756.17,-6262.19 17919,-6254 17964.86,-6251.69 19532.69,-6259.73 19572,-6236 19576.57,-6233.24 19580.49,-6229.52 19583.84,-6225.3"/>
<polygon fill="black" stroke="black" points="19586.94,-6226.96 19589.6,-6216.71 19581.12,-6223.07 19586.94,-6226.96"/>
</g>
<!-- l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge886" class="edge">
<title>l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M17462.06,-6285.38C17555.26,-6263.56 17723.9,-6224.07 17825.55,-6200.27"/>
<polygon fill="black" stroke="black" points="17826.54,-6203.63 17835.48,-6197.95 17824.95,-6196.82 17826.54,-6203.63"/>
</g>
<!-- l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge887" class="edge">
<title>l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M17465.66,-6293.27C17566.22,-6282.49 17756.46,-6263.33 17919,-6254 17958.89,-6251.71 18604.88,-6258.36 18638,-6236 18642.03,-6233.28 18645.39,-6229.73 18648.18,-6225.73"/>
<polygon fill="black" stroke="black" points="18651.23,-6227.45 18653.17,-6217.04 18645.16,-6223.97 18651.23,-6227.45"/>
</g>
<!-- l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge888" class="edge">
<title>l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M17465.91,-6295.47C17617.1,-6283.23 17961.5,-6253.81 18012,-6236 18024.42,-6231.62 18036.85,-6225.12 18048.26,-6218.1"/>
<polygon fill="black" stroke="black" points="18050.22,-6221 18056.76,-6212.66 18046.45,-6215.11 18050.22,-6221"/>
</g>
<!-- l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge889" class="edge">
<title>l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M17465.66,-6293.16C17566.21,-6282.25 17756.43,-6262.92 17919,-6254 17968.77,-6251.27 18772.76,-6260.79 18816,-6236 18820.96,-6233.15 18825.29,-6229.26 18829.04,-6224.85"/>
<polygon fill="black" stroke="black" points="18832.1,-6226.6 18835.19,-6216.46 18826.46,-6222.46 18832.1,-6226.6"/>
</g>
<!-- l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge890" class="edge">
<title>l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M17465.65,-6293.03C17566.19,-6281.96 17756.41,-6262.44 17919,-6254 17954.23,-6252.17 19158.01,-6252.87 19189,-6236 19194.28,-6233.13 19198.94,-6229.14 19203.01,-6224.6"/>
<polygon fill="black" stroke="black" points="19205.9,-6226.59 19209.32,-6216.56 19200.39,-6222.27 19205.9,-6226.59"/>
</g>
<!-- l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge891" class="edge">
<title>l2_expert2_gpu2&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M17465.22,-6292.93C17565.64,-6281.69 17756.15,-6261.92 17919,-6254 17984.9,-6250.79 20232.66,-6260.29 20294,-6236 20302.53,-6232.62 20310.57,-6227.41 20317.83,-6221.51"/>
<polygon fill="black" stroke="black" points="20320.18,-6224.12 20325.4,-6214.89 20315.57,-6218.85 20320.18,-6224.12"/>
</g>
<!-- l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge901" class="edge">
<title>l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M23605.94,-6296.14C23429.42,-6284.03 22956.71,-6252.56 22562,-6235 21897.43,-6205.43 21096.51,-6187.81 20825.16,-6182.34"/>
<polygon fill="black" stroke="black" points="20825.02,-6178.84 20814.95,-6182.14 20824.88,-6185.84 20825.02,-6178.84"/>
</g>
<!-- l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge902" class="edge">
<title>l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M23605.47,-6298.16C23393.28,-6289.61 22748.83,-6264.61 22214,-6254 21150.18,-6232.88 20883.41,-6272.35 19820,-6236 19681.16,-6231.25 19643.71,-6246.72 19508,-6217 19499.61,-6215.16 19490.99,-6212.69 19482.53,-6209.89"/>
<polygon fill="black" stroke="black" points="19483.66,-6206.58 19473.07,-6206.61 19481.37,-6213.19 19483.66,-6206.58"/>
</g>
<!-- l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge903" class="edge">
<title>l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M23605.46,-6298.56C23393.24,-6291.12 22748.73,-6268.87 22214,-6254 22038.69,-6249.12 20807.99,-6251.31 20636,-6217 20627.46,-6215.29 20618.68,-6212.87 20610.09,-6210.08"/>
<polygon fill="black" stroke="black" points="20611.08,-6206.72 20600.48,-6206.78 20608.81,-6213.34 20611.08,-6206.72"/>
</g>
<!-- l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge904" class="edge">
<title>l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M23605.47,-6298.21C23393.27,-6289.83 22748.81,-6265.24 22214,-6254 21402.58,-6236.95 21199.1,-6264.36 20388,-6236 20247.39,-6231.08 20209.45,-6247.05 20072,-6217 20063.61,-6215.17 20054.99,-6212.69 20046.53,-6209.9"/>
<polygon fill="black" stroke="black" points="20047.66,-6206.59 20037.06,-6206.62 20045.37,-6213.2 20047.66,-6206.59"/>
</g>
<!-- l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge905" class="edge">
<title>l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M23605.47,-6298.09C23393.28,-6289.38 22748.84,-6263.97 22214,-6254 21431.68,-6239.41 19475.03,-6261.71 18693,-6236 18553.71,-6231.42 18516.14,-6246.8 18380,-6217 18371.61,-6215.16 18362.99,-6212.69 18354.53,-6209.89"/>
<polygon fill="black" stroke="black" points="18355.66,-6206.58 18345.06,-6206.61 18353.37,-6213.2 18355.66,-6206.58"/>
</g>
<!-- l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge906" class="edge">
<title>l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M23605.47,-6298.13C23393.28,-6289.51 22748.83,-6264.34 22214,-6254 20983.09,-6230.2 20674.44,-6277.43 19444,-6236 19305.16,-6231.32 19267.71,-6246.72 19132,-6217 19123.61,-6215.16 19114.99,-6212.69 19106.53,-6209.89"/>
<polygon fill="black" stroke="black" points="19107.66,-6206.58 19097.07,-6206.61 19105.37,-6213.19 19107.66,-6206.58"/>
</g>
<!-- l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge907" class="edge">
<title>l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M23605.47,-6298.19C23393.28,-6289.74 22748.82,-6264.99 22214,-6254 21318.15,-6235.59 21093.5,-6267.07 20198,-6236 20058.27,-6231.15 20020.58,-6246.88 19884,-6217 19875.61,-6215.16 19866.99,-6212.69 19858.53,-6209.9"/>
<polygon fill="black" stroke="black" points="19859.66,-6206.58 19849.06,-6206.62 19857.37,-6213.2 19859.66,-6206.58"/>
</g>
<!-- l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge908" class="edge">
<title>l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M23605.47,-6298.1C23393.28,-6289.41 22748.84,-6264.05 22214,-6254 21473.45,-6240.09 19621.27,-6260.45 18881,-6236 18741.71,-6231.4 18704.14,-6246.8 18568,-6217 18559.61,-6215.16 18550.99,-6212.69 18542.53,-6209.89"/>
<polygon fill="black" stroke="black" points="18543.66,-6206.58 18533.06,-6206.61 18541.37,-6213.2 18543.66,-6206.58"/>
</g>
<!-- l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge909" class="edge">
<title>l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M23605.46,-6298.24C23393.27,-6289.92 22748.81,-6265.51 22214,-6254 21478.13,-6238.16 21293.53,-6263.43 20558,-6236 20425.38,-6231.05 20389.6,-6245.58 20260,-6217 20251.62,-6215.15 20242.99,-6212.67 20234.53,-6209.87"/>
<polygon fill="black" stroke="black" points="20235.67,-6206.56 20225.07,-6206.59 20233.37,-6213.17 20235.67,-6206.56"/>
</g>
<!-- l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge910" class="edge">
<title>l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M23605.47,-6298.17C23393.28,-6289.67 22748.82,-6264.79 22214,-6254 21234.17,-6234.24 20988.45,-6269.7 20009,-6236 19869.72,-6231.21 19832.14,-6246.8 19696,-6217 19687.61,-6215.16 19678.99,-6212.69 19670.53,-6209.89"/>
<polygon fill="black" stroke="black" points="19671.66,-6206.58 19661.06,-6206.61 19669.37,-6213.2 19671.66,-6206.58"/>
</g>
<!-- l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge911" class="edge">
<title>l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M23605.47,-6298.08C23393.28,-6289.33 22748.84,-6263.84 22214,-6254 21348.14,-6238.07 19182.55,-6264.25 18317,-6236 18247.35,-6233.73 18072.07,-6231.9 18004,-6217 17995.61,-6215.16 17986.99,-6212.69 17978.53,-6209.89"/>
<polygon fill="black" stroke="black" points="17979.66,-6206.58 17969.06,-6206.61 17977.37,-6213.2 17979.66,-6206.58"/>
</g>
<!-- l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge912" class="edge">
<title>l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M23605.47,-6298.11C23393.28,-6289.44 22748.84,-6264.13 22214,-6254 21515.23,-6240.76 19767.52,-6259.18 19069,-6236 18929.71,-6231.38 18892.14,-6246.8 18756,-6217 18747.61,-6215.16 18738.99,-6212.69 18730.53,-6209.89"/>
<polygon fill="black" stroke="black" points="18731.66,-6206.58 18721.06,-6206.61 18729.37,-6213.2 18731.66,-6206.58"/>
</g>
<!-- l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge913" class="edge">
<title>l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M23605.47,-6298.09C23393.28,-6289.35 22748.84,-6263.9 22214,-6254 21389.91,-6238.74 19328.79,-6262.98 18505,-6236 18365.71,-6231.44 18328.14,-6246.8 18192,-6217 18183.61,-6215.16 18174.99,-6212.69 18166.53,-6209.89"/>
<polygon fill="black" stroke="black" points="18167.66,-6206.58 18157.06,-6206.61 18165.37,-6213.2 18167.66,-6206.58"/>
</g>
<!-- l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge914" class="edge">
<title>l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M23605.47,-6298.12C23393.28,-6289.47 22748.83,-6264.23 22214,-6254 21557,-6241.43 19913.76,-6257.92 19257,-6236 19117.71,-6231.35 19080.14,-6246.8 18944,-6217 18935.61,-6215.16 18926.99,-6212.69 18918.53,-6209.89"/>
<polygon fill="black" stroke="black" points="18919.66,-6206.58 18909.06,-6206.61 18917.37,-6213.2 18919.66,-6206.58"/>
</g>
<!-- l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge915" class="edge">
<title>l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M23605.47,-6298.14C23393.28,-6289.55 22748.83,-6264.47 22214,-6254 21066.64,-6231.54 20778.92,-6274.89 19632,-6236 19493.16,-6231.29 19455.71,-6246.72 19320,-6217 19311.61,-6215.16 19302.99,-6212.69 19294.53,-6209.89"/>
<polygon fill="black" stroke="black" points="19295.66,-6206.58 19285.07,-6206.61 19293.37,-6213.19 19295.66,-6206.58"/>
</g>
<!-- l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge916" class="edge">
<title>l2_expert3_gpu3&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M23605.46,-6298.31C23393.27,-6290.2 22748.79,-6266.29 22214,-6254 21634.1,-6240.67 21488.84,-6251.94 20909,-6236 20704.01,-6230.36 20648.74,-6258.9 20448,-6217 20439.53,-6215.23 20430.83,-6212.79 20422.31,-6209.99"/>
<polygon fill="black" stroke="black" points="20423.37,-6206.66 20412.77,-6206.71 20421.09,-6213.27 20423.37,-6206.66"/>
</g>
<!-- l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge926" class="edge">
<title>l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M22061.98,-6294.98C21828.77,-6274.93 21086.36,-6211.13 20823.42,-6188.53"/>
<polygon fill="black" stroke="black" points="20823.4,-6185.01 20813.14,-6187.64 20822.8,-6191.99 20823.4,-6185.01"/>
</g>
<!-- l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge927" class="edge">
<title>l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M22061.76,-6297.45C21883.66,-6288.52 21404.69,-6265.37 21005,-6254 20478.04,-6239.01 20345.79,-6256.08 19819,-6236 19680.62,-6230.72 19643.27,-6246.64 19508,-6217 19499.61,-6215.16 19490.99,-6212.69 19482.53,-6209.89"/>
<polygon fill="black" stroke="black" points="19483.66,-6206.58 19473.07,-6206.61 19481.37,-6213.19 19483.66,-6206.58"/>
</g>
<!-- l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge928" class="edge">
<title>l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M22061.29,-6298.38C21782.07,-6287.66 20776,-6247.32 20636,-6217 20627.61,-6215.18 20618.98,-6212.72 20610.52,-6209.93"/>
<polygon fill="black" stroke="black" points="20611.65,-6206.62 20601.06,-6206.66 20609.36,-6213.23 20611.65,-6206.62"/>
</g>
<!-- l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge929" class="edge">
<title>l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M22061.74,-6298.06C21883.59,-6290.5 21404.52,-6270.26 21005,-6254 20803.23,-6245.79 20752.78,-6244 20551,-6236 20338.11,-6227.56 20280.59,-6260.37 20072,-6217 20063.53,-6215.24 20054.83,-6212.8 20046.3,-6210.01"/>
<polygon fill="black" stroke="black" points="20047.36,-6206.67 20036.77,-6206.72 20045.08,-6213.29 20047.36,-6206.67"/>
</g>
<!-- l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge930" class="edge">
<title>l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M22061.76,-6297.27C21883.68,-6287.92 21404.73,-6263.9 21005,-6254 19978.17,-6228.58 19720.54,-6271.03 18694,-6236 18554.27,-6231.23 18516.58,-6246.88 18380,-6217 18371.61,-6215.16 18362.99,-6212.69 18354.53,-6209.9"/>
<polygon fill="black" stroke="black" points="18355.66,-6206.58 18345.06,-6206.62 18353.37,-6213.2 18355.66,-6206.58"/>
</g>
<!-- l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge931" class="edge">
<title>l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M22061.76,-6297.36C21883.67,-6288.22 21404.71,-6264.65 21005,-6254 20312.31,-6235.55 20138.49,-6260.93 19446,-6236 19306.28,-6230.97 19268.58,-6246.88 19132,-6217 19123.61,-6215.16 19114.99,-6212.69 19106.53,-6209.9"/>
<polygon fill="black" stroke="black" points="19107.66,-6206.58 19097.06,-6206.62 19105.37,-6213.2 19107.66,-6206.58"/>
</g>
<!-- l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge932" class="edge">
<title>l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M22061.75,-6297.62C21883.65,-6289.07 21404.65,-6266.73 21005,-6254 20641.1,-6242.41 20549.76,-6251.43 20186,-6236 20051.63,-6230.3 20015.35,-6245.9 19884,-6217 19875.61,-6215.15 19866.99,-6212.68 19858.53,-6209.88"/>
<polygon fill="black" stroke="black" points="19859.66,-6206.56 19849.07,-6206.59 19857.37,-6213.18 19859.66,-6206.56"/>
</g>
<!-- l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge933" class="edge">
<title>l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M22061.76,-6297.29C21883.68,-6287.97 21404.72,-6264.03 21005,-6254 20061.71,-6230.32 19825.03,-6268.51 18882,-6236 18742.27,-6231.18 18704.58,-6246.88 18568,-6217 18559.61,-6215.16 18550.99,-6212.69 18542.53,-6209.9"/>
<polygon fill="black" stroke="black" points="18543.66,-6206.58 18533.06,-6206.62 18541.37,-6213.2 18543.66,-6206.58"/>
</g>
<!-- l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge934" class="edge">
<title>l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M22061.73,-6298.1C21883.59,-6290.66 21404.5,-6270.64 21005,-6254 20812.56,-6245.98 20764.36,-6245.85 20572,-6236 20433.26,-6228.89 20395.71,-6246.72 20260,-6217 20251.61,-6215.16 20242.99,-6212.69 20234.53,-6209.89"/>
<polygon fill="black" stroke="black" points="20235.66,-6206.58 20225.07,-6206.61 20233.37,-6213.19 20235.66,-6206.58"/>
</g>
<!-- l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge935" class="edge">
<title>l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M22061.75,-6297.53C21883.66,-6288.77 21404.67,-6265.99 21005,-6254 20566.9,-6240.86 20456.97,-6252.87 20019,-6236 19875.3,-6230.46 19836.51,-6247.62 19696,-6217 19687.61,-6215.17 19678.99,-6212.7 19670.52,-6209.91"/>
<polygon fill="black" stroke="black" points="19671.66,-6206.6 19661.06,-6206.63 19669.36,-6213.21 19671.66,-6206.6"/>
</g>
<!-- l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge936" class="edge">
<title>l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M22061.76,-6297.24C21883.68,-6287.83 21404.73,-6263.68 21005,-6254 19811.1,-6225.09 19511.58,-6276.08 18318,-6236 18178.27,-6231.31 18140.58,-6246.88 18004,-6217 17995.61,-6215.16 17986.99,-6212.69 17978.53,-6209.9"/>
<polygon fill="black" stroke="black" points="17979.66,-6206.58 17969.06,-6206.62 17977.37,-6213.2 17979.66,-6206.58"/>
</g>
<!-- l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge937" class="edge">
<title>l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M22061.76,-6297.31C21883.68,-6288.04 21404.72,-6264.2 21005,-6254 20145.24,-6232.06 19929.51,-6265.98 19070,-6236 18930.27,-6231.13 18892.58,-6246.88 18756,-6217 18747.61,-6215.16 18738.99,-6212.69 18730.53,-6209.9"/>
<polygon fill="black" stroke="black" points="18731.66,-6206.58 18721.06,-6206.62 18729.37,-6213.2 18731.66,-6206.58"/>
</g>
<!-- l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge938" class="edge">
<title>l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M22061.76,-6297.25C21883.68,-6287.87 21404.73,-6263.78 21005,-6254 19894.64,-6226.83 19616.06,-6273.55 18506,-6236 18366.27,-6231.27 18328.58,-6246.88 18192,-6217 18183.61,-6215.16 18174.99,-6212.69 18166.53,-6209.9"/>
<polygon fill="black" stroke="black" points="18167.66,-6206.58 18157.06,-6206.62 18165.37,-6213.2 18167.66,-6206.58"/>
</g>
<!-- l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge939" class="edge">
<title>l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M22061.76,-6297.33C21883.67,-6288.12 21404.71,-6264.4 21005,-6254 20228.78,-6233.81 20034,-6263.46 19258,-6236 19118.28,-6231.06 19080.58,-6246.88 18944,-6217 18935.61,-6215.16 18926.99,-6212.69 18918.53,-6209.9"/>
<polygon fill="black" stroke="black" points="18919.66,-6206.58 18909.06,-6206.62 18917.37,-6213.2 18919.66,-6206.58"/>
</g>
<!-- l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge940" class="edge">
<title>l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M22061.76,-6297.4C21883.67,-6288.35 21404.7,-6264.97 21005,-6254 20397.18,-6237.32 20244.65,-6258.19 19637,-6236 19495.95,-6230.85 19457.89,-6247.13 19320,-6217 19311.61,-6215.17 19302.99,-6212.7 19294.53,-6209.9"/>
<polygon fill="black" stroke="black" points="19295.66,-6206.59 19285.06,-6206.62 19293.37,-6213.2 19295.66,-6206.59"/>
</g>
<!-- l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge941" class="edge">
<title>l2_expert4_gpu4&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M22061.68,-6297.7C21862.68,-6288.24 21284.44,-6260.58 20804,-6236 20645.76,-6227.9 20602.91,-6250.32 20448,-6217 20439.54,-6215.18 20430.85,-6212.7 20422.33,-6209.89"/>
<polygon fill="black" stroke="black" points="20423.39,-6206.56 20412.8,-6206.59 20421.1,-6213.17 20423.39,-6206.56"/>
</g>
<!-- l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge951" class="edge">
<title>l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M18070.48,-6293.52C18177.44,-6282.43 18387.22,-6262.18 18566,-6254 18595.55,-6252.65 20670.25,-6250.57 20696,-6236 20700.98,-6233.18 20705.32,-6229.31 20709.08,-6224.91"/>
<polygon fill="black" stroke="black" points="20712.13,-6226.66 20715.23,-6216.53 20706.49,-6222.52 20712.13,-6226.66"/>
</g>
<!-- l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge952" class="edge">
<title>l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M18070.5,-6293.82C18177.47,-6283.12 18387.28,-6263.37 18566,-6254 18588.92,-6252.8 19373.16,-6249.1 19392,-6236 19395.84,-6233.33 19399.01,-6229.88 19401.62,-6226.01"/>
<polygon fill="black" stroke="black" points="19404.82,-6227.45 19406.51,-6216.99 19398.67,-6224.11 19404.82,-6227.45"/>
</g>
<!-- l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge953" class="edge">
<title>l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M18070.48,-6293.54C18177.44,-6282.47 18387.23,-6262.26 18566,-6254 18619.39,-6251.53 20441.06,-6257.48 20490,-6236 20497.23,-6232.83 20503.91,-6228.11 20509.92,-6222.75"/>
<polygon fill="black" stroke="black" points="20512.45,-6225.16 20517.15,-6215.67 20507.55,-6220.16 20512.45,-6225.16"/>
</g>
<!-- l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge954" class="edge">
<title>l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M18070.49,-6293.62C18177.45,-6282.67 18387.24,-6262.59 18566,-6254 18604.32,-6252.16 19914.04,-6255.63 19947,-6236 19951.74,-6233.18 19955.81,-6229.34 19959.3,-6224.99"/>
<polygon fill="black" stroke="black" points="19962.19,-6226.95 19964.95,-6216.72 19956.41,-6223 19962.19,-6226.95"/>
</g>
<!-- l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge955" class="edge">
<title>l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M18070.16,-6292.78C18141.33,-6282.94 18244.89,-6264.22 18273,-6236 18275.71,-6233.28 18277.89,-6230.11 18279.65,-6226.69"/>
<polygon fill="black" stroke="black" points="18282.99,-6227.78 18283.38,-6217.19 18276.47,-6225.22 18282.99,-6227.78"/>
</g>
<!-- l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge956" class="edge">
<title>l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M18070.96,-6294.19C18178.11,-6284.01 18387.62,-6264.97 18566,-6254 18591.03,-6252.46 18996.66,-6250.66 19017,-6236 19020.72,-6233.32 19023.78,-6229.89 19026.3,-6226.06"/>
<polygon fill="black" stroke="black" points="19029.43,-6227.63 19031,-6217.15 19023.24,-6224.37 19029.43,-6227.63"/>
</g>
<!-- l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge957" class="edge">
<title>l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M18070.49,-6293.67C18177.46,-6282.77 18387.25,-6262.76 18566,-6254 18599.32,-6252.37 19739.4,-6254.74 19767,-6236 19770.89,-6233.36 19774.13,-6229.92 19776.81,-6226.06"/>
<polygon fill="black" stroke="black" points="19780.03,-6227.49 19781.87,-6217.05 19773.92,-6224.06 19780.03,-6227.49"/>
</g>
<!-- l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge958" class="edge">
<title>l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M18071.39,-6299.34C18153.23,-6295.13 18289.98,-6281.21 18398,-6236 18408.27,-6231.7 18418.46,-6225.76 18427.88,-6219.35"/>
<polygon fill="black" stroke="black" points="18430.17,-6222.02 18436.29,-6213.37 18426.12,-6216.31 18430.17,-6222.02"/>
</g>
<!-- l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge959" class="edge">
<title>l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M18070.49,-6293.59C18177.45,-6282.58 18387.23,-6262.45 18566,-6254 18609.57,-6251.94 20098.67,-6258.55 20136,-6236 20140.57,-6233.24 20144.49,-6229.52 20147.84,-6225.3"/>
<polygon fill="black" stroke="black" points="20150.94,-6226.96 20153.59,-6216.7 20145.12,-6223.06 20150.94,-6226.96"/>
</g>
<!-- l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge960" class="edge">
<title>l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M18070.49,-6293.73C18177.46,-6282.91 18387.26,-6263.01 18566,-6254 18594.19,-6252.58 19559.05,-6252.43 19582,-6236 19585.76,-6233.31 19588.81,-6229.85 19591.29,-6225.97"/>
<polygon fill="black" stroke="black" points="19594.47,-6227.44 19595.86,-6216.94 19588.22,-6224.28 19594.47,-6227.44"/>
</g>
<!-- l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge961" class="edge">
<title>l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M17964.69,-6260C17958.3,-6252.16 17951.83,-6243.92 17946,-6236 17943.21,-6232.21 17940.4,-6228.21 17937.63,-6224.17"/>
<polygon fill="black" stroke="black" points="17940.53,-6222.21 17932.05,-6215.86 17934.72,-6226.11 17940.53,-6222.21"/>
</g>
<!-- l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge962" class="edge">
<title>l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M18071.01,-6296.1C18234.51,-6284.34 18625.25,-6254.45 18647,-6236 18650.12,-6233.35 18652.63,-6230.13 18654.64,-6226.58"/>
<polygon fill="black" stroke="black" points="18657.92,-6227.81 18658.67,-6217.24 18651.49,-6225.03 18657.92,-6227.81"/>
</g>
<!-- l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge963" class="edge">
<title>l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M18033.73,-6259.58C18043.26,-6247.85 18053.66,-6235.06 18063.25,-6223.25"/>
<polygon fill="black" stroke="black" points="18066.16,-6225.23 18069.75,-6215.26 18060.73,-6220.81 18066.16,-6225.23"/>
</g>
<!-- l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge964" class="edge">
<title>l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M18071.01,-6294.86C18178.21,-6285.53 18387.8,-6267.58 18566,-6254 18594.87,-6251.8 18802.36,-6252.73 18826,-6236 18829.97,-6233.19 18833.29,-6229.58 18836.06,-6225.55"/>
<polygon fill="black" stroke="black" points="18839.12,-6227.25 18841.02,-6216.82 18833.04,-6223.79 18839.12,-6227.25"/>
</g>
<!-- l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge965" class="edge">
<title>l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M18070.5,-6293.97C18177.49,-6283.45 18387.31,-6263.94 18566,-6254 18601.4,-6252.03 19174.95,-6256.34 19204,-6236 19207.83,-6233.32 19210.99,-6229.86 19213.6,-6225.98"/>
<polygon fill="black" stroke="black" points="19216.81,-6227.42 19218.49,-6216.96 19210.65,-6224.09 19216.81,-6227.42"/>
</g>
<!-- l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge966" class="edge">
<title>l2_expert5_gpu5&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M18070.48,-6293.56C18177.45,-6282.52 18387.23,-6262.34 18566,-6254 18614.59,-6251.73 20274.23,-6259.17 20317,-6236 20322.35,-6233.1 20327.06,-6229.06 20331.17,-6224.46"/>
<polygon fill="black" stroke="black" points="20334.14,-6226.33 20337.53,-6216.29 20328.62,-6222.03 20334.14,-6226.33"/>
</g>
<!-- l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge976" class="edge">
<title>l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M19866.79,-6301.06C20073.35,-6300.33 20658.41,-6293.16 20721,-6236 20723.87,-6233.38 20726.07,-6230.23 20727.73,-6226.77"/>
<polygon fill="black" stroke="black" points="20731.11,-6227.69 20730.97,-6217.1 20724.48,-6225.47 20731.11,-6227.69"/>
</g>
<!-- l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge977" class="edge">
<title>l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M19724.12,-6295.63C19659.1,-6288.49 19561.42,-6272.29 19484,-6236 19474.84,-6231.7 19465.8,-6225.99 19457.41,-6219.87"/>
<polygon fill="black" stroke="black" points="19459.34,-6216.93 19449.27,-6213.64 19455.09,-6222.49 19459.34,-6216.93"/>
</g>
<!-- l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge978" class="edge">
<title>l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M19866.66,-6299.37C20041.33,-6294.54 20478.36,-6278.33 20528,-6236 20531.1,-6233.35 20533.57,-6230.13 20535.52,-6226.59"/>
<polygon fill="black" stroke="black" points="20538.8,-6227.82 20539.41,-6217.25 20532.34,-6225.14 20538.8,-6227.82"/>
</g>
<!-- l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge979" class="edge">
<title>l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M19864.63,-6291.12C19900.27,-6282.43 19941.42,-6266.22 19967,-6236 19969.32,-6233.25 19971.21,-6230.16 19972.73,-6226.87"/>
<polygon fill="black" stroke="black" points="19976.11,-6227.81 19976.13,-6217.22 19969.5,-6225.49 19976.11,-6227.81"/>
</g>
<!-- l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge980" class="edge">
<title>l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M19723.31,-6297.95C19431.6,-6285.18 18349.02,-6237.7 18345,-6236 18336.9,-6232.58 18329.24,-6227.51 18322.28,-6221.82"/>
<polygon fill="black" stroke="black" points="18324.27,-6218.9 18314.46,-6214.9 18319.63,-6224.14 18324.27,-6218.9"/>
</g>
<!-- l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge981" class="edge">
<title>l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M19723.58,-6299.43C19571.05,-6295.08 19218.39,-6280.4 19108,-6236 19098.3,-6232.1 19088.85,-6226.4 19080.19,-6220.12"/>
<polygon fill="black" stroke="black" points="19082.22,-6217.27 19072.15,-6213.96 19077.96,-6222.82 19082.22,-6217.27"/>
</g>
<!-- l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge982" class="edge">
<title>l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M19793.04,-6253.77C19792.68,-6245.04 19792.3,-6235.94 19791.94,-6227.23"/>
<polygon fill="black" stroke="black" points="19795.43,-6227.08 19791.52,-6217.24 19788.44,-6227.37 19795.43,-6227.08"/>
</g>
<!-- l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge983" class="edge">
<title>l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M19723.46,-6298.99C19479.91,-6291.62 18691.93,-6265.73 18582,-6236 18564.73,-6231.33 18547.05,-6223.66 18531.12,-6215.49"/>
<polygon fill="black" stroke="black" points="18532.44,-6212.22 18521.96,-6210.64 18529.16,-6218.41 18532.44,-6212.22"/>
</g>
<!-- l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge984" class="edge">
<title>l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M19866.52,-6297.34C19959.27,-6290.98 20113.93,-6274.75 20154,-6236 20156.79,-6233.31 20159,-6230.13 20160.75,-6226.68"/>
<polygon fill="black" stroke="black" points="20164.12,-6227.67 20164.38,-6217.08 20157.57,-6225.2 20164.12,-6227.67"/>
</g>
<!-- l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge985" class="edge">
<title>l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M19737.2,-6273.68C19715.87,-6262.82 19691.84,-6249.66 19671,-6236 19663.35,-6230.98 19655.53,-6225.3 19648.04,-6219.54"/>
<polygon fill="black" stroke="black" points="19650.08,-6216.69 19640.05,-6213.27 19645.76,-6222.2 19650.08,-6216.69"/>
</g>
<!-- l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge986" class="edge">
<title>l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M19723.78,-6297.45C19552.25,-6288.82 19102.61,-6266.83 18727,-6254 18685.73,-6252.59 18023.01,-6249.53 17984,-6236 17973.2,-6232.25 17962.69,-6226.3 17953.14,-6219.66"/>
<polygon fill="black" stroke="black" points="17955.14,-6216.79 17945.01,-6213.69 17951,-6222.43 17955.14,-6216.79"/>
</g>
<!-- l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge987" class="edge">
<title>l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M19723.46,-6300.62C19520.43,-6298.66 18943.69,-6288.49 18763,-6236 18747.17,-6231.4 18731.06,-6224.01 18716.5,-6216.11"/>
<polygon fill="black" stroke="black" points="18718.09,-6212.98 18707.65,-6211.14 18714.66,-6219.08 18718.09,-6212.98"/>
</g>
<!-- l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge988" class="edge">
<title>l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M19723.77,-6297.71C19552.22,-6289.64 19102.54,-6268.78 18727,-6254 18669.23,-6251.73 18262.98,-6250.46 18207,-6236 18189.22,-6231.41 18171.01,-6223.58 18154.69,-6215.23"/>
<polygon fill="black" stroke="black" points="18156.32,-6212.13 18145.84,-6210.56 18153.05,-6218.32 18156.32,-6212.13"/>
</g>
<!-- l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge989" class="edge">
<title>l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M19723.35,-6299.6C19521.36,-6294.91 18957.4,-6278.16 18886,-6236 18880.93,-6233.01 18876.45,-6228.99 18872.52,-6224.47"/>
<polygon fill="black" stroke="black" points="18875.28,-6222.32 18866.43,-6216.5 18869.72,-6226.57 18875.28,-6222.32"/>
</g>
<!-- l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge990" class="edge">
<title>l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M19723.93,-6296.58C19604.86,-6288.26 19370.68,-6268.3 19295,-6236 19285.67,-6232.02 19276.56,-6226.4 19268.18,-6220.25"/>
<polygon fill="black" stroke="black" points="19270.12,-6217.32 19260.07,-6213.97 19265.84,-6222.86 19270.12,-6217.32"/>
</g>
<!-- l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge991" class="edge">
<title>l2_expert6_gpu6&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M19866.15,-6297.18C20006.27,-6288.85 20307.4,-6267.47 20342,-6236 20344.99,-6233.28 20347.33,-6230 20349.15,-6226.43"/>
<polygon fill="black" stroke="black" points="20352.44,-6227.63 20352.69,-6217.04 20345.89,-6225.16 20352.44,-6227.63"/>
</g>
<!-- l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu0 -->
<g id="edge1001" class="edge">
<title>l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M20872.01,-6268.77C20845.68,-6252.4 20813.66,-6232.5 20786.7,-6215.74"/>
<polygon fill="black" stroke="black" points="20788.47,-6212.72 20778.13,-6210.42 20784.78,-6218.67 20788.47,-6212.72"/>
</g>
<!-- l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu1 -->
<g id="edge1002" class="edge">
<title>l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M20852.62,-6297.86C20568.41,-6285.03 19532.12,-6238.13 19524,-6236 19506.11,-6231.3 19487.75,-6223.44 19471.28,-6215.09"/>
<polygon fill="black" stroke="black" points="19472.83,-6211.95 19462.35,-6210.42 19469.59,-6218.16 19472.83,-6211.95"/>
</g>
<!-- l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu2 -->
<g id="edge1003" class="edge">
<title>l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M20852.93,-6295.87C20787.44,-6288.9 20688.92,-6272.79 20611,-6236 20602.03,-6231.76 20593.21,-6226.14 20585.01,-6220.1"/>
<polygon fill="black" stroke="black" points="20587.11,-6217.29 20577.06,-6213.95 20582.83,-6222.83 20587.11,-6217.29"/>
</g>
<!-- l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu3 -->
<g id="edge1004" class="edge">
<title>l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M20852.37,-6299.56C20650.46,-6294.75 20086.66,-6277.71 20015,-6236 20009.87,-6233.01 20005.31,-6229 20001.3,-6224.49"/>
<polygon fill="black" stroke="black" points="20003.98,-6222.24 19995.07,-6216.52 19998.47,-6226.55 20003.98,-6222.24"/>
</g>
<!-- l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu4 -->
<g id="edge1005" class="edge">
<title>l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M20852.87,-6297.08C20683.65,-6287.72 20243.75,-6264.44 19876,-6254 19833.9,-6252.8 18399.87,-6249.55 18360,-6236 18349.18,-6232.32 18338.66,-6226.4 18329.11,-6219.77"/>
<polygon fill="black" stroke="black" points="18331.11,-6216.89 18320.98,-6213.79 18326.96,-6222.53 18331.11,-6216.89"/>
</g>
<!-- l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu5 -->
<g id="edge1006" class="edge">
<title>l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M20852.55,-6297.37C20683.07,-6288.69 20243.45,-6266.79 19876,-6254 19795.14,-6251.18 19226.48,-6255.7 19148,-6236 19129.97,-6231.47 19111.5,-6223.62 19094.98,-6215.23"/>
<polygon fill="black" stroke="black" points="19096.49,-6212.07 19086.01,-6210.53 19093.24,-6218.27 19096.49,-6212.07"/>
</g>
<!-- l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu6 -->
<g id="edge1007" class="edge">
<title>l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M20852.19,-6300.54C20649.09,-6298.36 20073.62,-6287.67 19893,-6236 19876.83,-6231.37 19860.34,-6223.93 19845.43,-6215.98"/>
<polygon fill="black" stroke="black" points="19846.82,-6212.75 19836.37,-6210.99 19843.44,-6218.88 19846.82,-6212.75"/>
</g>
<!-- l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu7 -->
<g id="edge1008" class="edge">
<title>l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M20852.87,-6297.13C20683.64,-6287.9 20243.74,-6264.86 19876,-6254 19805.41,-6251.91 18674.1,-6250.54 18605,-6236 18581.95,-6231.15 18557.88,-6222.21 18536.77,-6212.9"/>
<polygon fill="black" stroke="black" points="18538.15,-6209.68 18527.6,-6208.75 18535.27,-6216.06 18538.15,-6209.68"/>
</g>
<!-- l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu8 -->
<g id="edge1009" class="edge">
<title>l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M20852.47,-6299.44C20699.72,-6295.11 20346.55,-6280.45 20236,-6236 20226.3,-6232.1 20216.85,-6226.4 20208.19,-6220.12"/>
<polygon fill="black" stroke="black" points="20210.22,-6217.27 20200.15,-6213.96 20205.96,-6222.82 20210.22,-6217.27"/>
</g>
<!-- l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu9 -->
<g id="edge1010" class="edge">
<title>l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M20852.4,-6298.06C20600.36,-6287.32 19766.28,-6250.84 19711,-6236 19693.51,-6231.3 19675.58,-6223.58 19659.44,-6215.37"/>
<polygon fill="black" stroke="black" points="19660.65,-6212.04 19650.17,-6210.49 19657.39,-6218.24 19660.65,-6212.04"/>
</g>
<!-- l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu10 -->
<g id="edge1011" class="edge">
<title>l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M20852.87,-6297.02C20683.66,-6287.54 20243.76,-6264.02 19876,-6254 19823.77,-6252.58 18045.01,-6251.14 17995,-6236 17982.23,-6232.13 17969.58,-6225.7 17958.1,-6218.56"/>
<polygon fill="black" stroke="black" points="17959.84,-6215.52 17949.56,-6212.99 17956.02,-6221.38 17959.84,-6215.52"/>
</g>
<!-- l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu11 -->
<g id="edge1012" class="edge">
<title>l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M20852.87,-6297.19C20683.64,-6288.08 20243.73,-6265.29 19876,-6254 19754.93,-6250.28 18904.24,-6262.28 18786,-6236 18764.63,-6231.25 18742.46,-6222.65 18722.88,-6213.62"/>
<polygon fill="black" stroke="black" points="18724.32,-6210.43 18713.78,-6209.31 18721.32,-6216.75 18724.32,-6210.43"/>
</g>
<!-- l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu12 -->
<g id="edge1013" class="edge">
<title>l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M20852.87,-6297.05C20683.65,-6287.65 20243.76,-6264.27 19876,-6254 19784.59,-6251.45 18319.54,-6254.57 18230,-6236 18206.68,-6231.16 18182.32,-6222.17 18160.97,-6212.81"/>
<polygon fill="black" stroke="black" points="18162.26,-6209.55 18151.7,-6208.65 18159.39,-6215.94 18162.26,-6209.55"/>
</g>
<!-- l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu13 -->
<g id="edge1014" class="edge">
<title>l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M20852.55,-6297.22C20683.09,-6288.21 20243.49,-6265.67 19876,-6254 19822.3,-6252.29 18958.76,-6256.26 18909,-6236 18900.86,-6232.68 18893.17,-6227.67 18886.2,-6222"/>
<polygon fill="black" stroke="black" points="18888.19,-6219.08 18878.37,-6215.09 18883.56,-6224.33 18888.19,-6219.08"/>
</g>
<!-- l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu14 -->
<g id="edge1015" class="edge">
<title>l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M20852.54,-6297.58C20683.05,-6289.35 20243.39,-6268.36 19876,-6254 19815.9,-6251.65 19393.24,-6251 19335,-6236 19317.22,-6231.42 19299.01,-6223.6 19282.69,-6215.25"/>
<polygon fill="black" stroke="black" points="19284.31,-6212.15 19273.84,-6210.58 19281.05,-6218.34 19284.31,-6212.15"/>
</g>
<!-- l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu15 -->
<g id="edge1016" class="edge">
<title>l2_expert7_gpu7&#45;&gt;l2_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M20852.78,-6296.59C20733.48,-6288.29 20498.83,-6268.35 20423,-6236 20413.67,-6232.02 20404.56,-6226.4 20396.18,-6220.25"/>
<polygon fill="black" stroke="black" points="20398.12,-6217.33 20388.07,-6213.97 20393.84,-6222.86 20398.12,-6217.33"/>
</g>
<!-- l3_qkv_gpu0 -->
<g id="node929" class="node">
<title>l3_qkv_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20833" cy="-6035.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="20833" y="-6054.72" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="20833" y="-6039.72" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20833" y="-6024.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="20833" y="-6009.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_expert_agg_gpu0&#45;&gt;l3_qkv_gpu0 -->
<g id="edge2689" class="edge">
<title>l2_expert_agg_gpu0&#45;&gt;l3_qkv_gpu0</title>
<path fill="none" stroke="black" d="M20755.46,-6143.5C20767.34,-6127.17 20781.73,-6107.39 20794.88,-6089.32"/>
<polygon fill="black" stroke="black" points="20797.76,-6091.3 20800.81,-6081.16 20792.1,-6087.19 20797.76,-6091.3"/>
</g>
<!-- l3_qkv_gpu1 -->
<g id="node930" class="node">
<title>l3_qkv_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19419" cy="-6035.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="19419" y="-6054.72" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="19419" y="-6039.72" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19419" y="-6024.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="19419" y="-6009.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_expert_agg_gpu1&#45;&gt;l3_qkv_gpu1 -->
<g id="edge2690" class="edge">
<title>l2_expert_agg_gpu1&#45;&gt;l3_qkv_gpu1</title>
<path fill="none" stroke="black" d="M19415.3,-6141.67C19415.81,-6127.29 19416.4,-6110.45 19416.97,-6094.54"/>
<polygon fill="black" stroke="black" points="19420.47,-6094.36 19417.33,-6084.25 19413.48,-6094.12 19420.47,-6094.36"/>
</g>
<!-- l3_qkv_gpu2 -->
<g id="node931" class="node">
<title>l3_qkv_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20631" cy="-6035.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="20631" y="-6054.72" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="20631" y="-6039.72" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20631" y="-6024.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="20631" y="-6009.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_expert_agg_gpu2&#45;&gt;l3_qkv_gpu2 -->
<g id="edge2691" class="edge">
<title>l2_expert_agg_gpu2&#45;&gt;l3_qkv_gpu2</title>
<path fill="none" stroke="black" d="M20564.23,-6143.14C20574.27,-6127.16 20586.36,-6107.94 20597.47,-6090.26"/>
<polygon fill="black" stroke="black" points="20600.47,-6092.06 20602.83,-6081.73 20594.54,-6088.33 20600.47,-6092.06"/>
</g>
<!-- l3_qkv_gpu3 -->
<g id="node932" class="node">
<title>l3_qkv_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="20025" cy="-6035.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="20025" y="-6054.72" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="20025" y="-6039.72" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="20025" y="-6024.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="20025" y="-6009.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_expert_agg_gpu3&#45;&gt;l3_qkv_gpu3 -->
<g id="edge2692" class="edge">
<title>l2_expert_agg_gpu3&#45;&gt;l3_qkv_gpu3</title>
<path fill="none" stroke="black" d="M19990.1,-6142.04C19995.06,-6127.11 20000.91,-6109.49 20006.39,-6092.98"/>
<polygon fill="black" stroke="black" points="20009.73,-6094.02 20009.56,-6083.43 20003.09,-6091.81 20009.73,-6094.02"/>
</g>
<!-- l3_qkv_gpu4 -->
<g id="node933" class="node">
<title>l3_qkv_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="18207" cy="-6035.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="18207" y="-6054.72" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="18207" y="-6039.72" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="18207" y="-6024.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18207" y="-6009.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_expert_agg_gpu4&#45;&gt;l3_qkv_gpu4 -->
<g id="edge2693" class="edge">
<title>l2_expert_agg_gpu4&#45;&gt;l3_qkv_gpu4</title>
<path fill="none" stroke="black" d="M18266.06,-6142.77C18257.35,-6127.15 18246.93,-6108.47 18237.28,-6091.19"/>
<polygon fill="black" stroke="black" points="18240.25,-6089.33 18232.32,-6082.3 18234.14,-6092.74 18240.25,-6089.33"/>
</g>
<!-- l3_qkv_gpu5 -->
<g id="node934" class="node">
<title>l3_qkv_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="19015" cy="-6035.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="19015" y="-6054.72" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="19015" y="-6039.72" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="19015" y="-6024.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="19015" y="-6009.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_expert_agg_gpu5&#45;&gt;l3_qkv_gpu5 -->
<g id="edge2694" class="edge">
<title>l2_expert_agg_gpu5&#45;&gt;l3_qkv_gpu5</title>
<path fill="none" stroke="black" d="M19032.08,-6142.04C19029.7,-6127.38 19026.89,-6110.14 19024.26,-6093.9"/>
<polygon fill="black" stroke="black" points="19027.7,-6093.26 19022.64,-6083.95 19020.79,-6094.38 19027.7,-6093.26"/>
</g>
<!-- l3_qkv_gpu6 -->
<g id="node935" class="node">
<title>l3_qkv_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19823" cy="-6035.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="19823" y="-6054.72" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="19823" y="-6039.72" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19823" y="-6024.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="19823" y="-6009.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_expert_agg_gpu6&#45;&gt;l3_qkv_gpu6 -->
<g id="edge2695" class="edge">
<title>l2_expert_agg_gpu6&#45;&gt;l3_qkv_gpu6</title>
<path fill="none" stroke="black" d="M19798.5,-6142.04C19801.93,-6127.31 19805.97,-6109.98 19809.77,-6093.67"/>
<polygon fill="black" stroke="black" points="19813.24,-6094.22 19812.1,-6083.69 19806.42,-6092.63 19813.24,-6094.22"/>
</g>
<!-- l3_qkv_gpu7 -->
<g id="node936" class="node">
<title>l3_qkv_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="18409" cy="-6035.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="18409" y="-6054.72" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="18409" y="-6039.72" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="18409" y="-6024.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18409" y="-6009.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_expert_agg_gpu7&#45;&gt;l3_qkv_gpu7 -->
<g id="edge2696" class="edge">
<title>l2_expert_agg_gpu7&#45;&gt;l3_qkv_gpu7</title>
<path fill="none" stroke="black" d="M18457.43,-6142.41C18450.42,-6127.13 18442.09,-6108.99 18434.33,-6092.09"/>
<polygon fill="black" stroke="black" points="18437.45,-6090.49 18430.09,-6082.86 18431.09,-6093.41 18437.45,-6090.49"/>
</g>
<!-- l3_qkv_gpu8 -->
<g id="node937" class="node">
<title>l3_qkv_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20227" cy="-6035.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="20227" y="-6054.72" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="20227" y="-6039.72" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20227" y="-6024.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="20227" y="-6009.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_expert_agg_gpu8&#45;&gt;l3_qkv_gpu8 -->
<g id="edge2697" class="edge">
<title>l2_expert_agg_gpu8&#45;&gt;l3_qkv_gpu8</title>
<path fill="none" stroke="black" d="M20181.55,-6142.41C20188.1,-6127.2 20195.88,-6109.15 20203.13,-6092.32"/>
<polygon fill="black" stroke="black" points="20206.35,-6093.69 20207.09,-6083.13 20199.92,-6090.92 20206.35,-6093.69"/>
</g>
<!-- l3_qkv_gpu9 -->
<g id="node938" class="node">
<title>l3_qkv_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="19621" cy="-6035.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="19621" y="-6054.72" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="19621" y="-6039.72" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="19621" y="-6024.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="19621" y="-6009.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_expert_agg_gpu9&#45;&gt;l3_qkv_gpu9 -->
<g id="edge2698" class="edge">
<title>l2_expert_agg_gpu9&#45;&gt;l3_qkv_gpu9</title>
<path fill="none" stroke="black" d="M19606.89,-6142.04C19608.86,-6127.38 19611.17,-6110.14 19613.35,-6093.9"/>
<polygon fill="black" stroke="black" points="19616.83,-6094.33 19614.69,-6083.95 19609.89,-6093.4 19616.83,-6094.33"/>
</g>
<!-- l3_qkv_gpu10 -->
<g id="node939" class="node">
<title>l3_qkv_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="17803" cy="-6035.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="17803" y="-6054.72" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="17803" y="-6039.72" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17803" y="-6024.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="17803" y="-6009.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_expert_agg_gpu10&#45;&gt;l3_qkv_gpu10 -->
<g id="edge2699" class="edge">
<title>l2_expert_agg_gpu10&#45;&gt;l3_qkv_gpu10</title>
<path fill="none" stroke="black" d="M17883.55,-6143.5C17871.15,-6127.1 17856.13,-6107.21 17842.43,-6089.08"/>
<polygon fill="black" stroke="black" points="17845.06,-6086.76 17836.24,-6080.9 17839.48,-6090.99 17845.06,-6086.76"/>
</g>
<!-- l3_qkv_gpu11 -->
<g id="node940" class="node">
<title>l3_qkv_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="18611" cy="-6035.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="18611" y="-6054.72" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="18611" y="-6039.72" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18611" y="-6024.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18611" y="-6009.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_expert_agg_gpu11&#45;&gt;l3_qkv_gpu11 -->
<g id="edge2700" class="edge">
<title>l2_expert_agg_gpu11&#45;&gt;l3_qkv_gpu11</title>
<path fill="none" stroke="black" d="M18649,-6142.41C18643.6,-6127.41 18637.2,-6109.65 18631.21,-6093.02"/>
<polygon fill="black" stroke="black" points="18634.42,-6091.61 18627.74,-6083.39 18627.84,-6093.98 18634.42,-6091.61"/>
</g>
<!-- l3_qkv_gpu12 -->
<g id="node941" class="node">
<title>l3_qkv_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="18005" cy="-6035.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="18005" y="-6054.72" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="18005" y="-6039.72" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18005" y="-6024.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18005" y="-6009.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_expert_agg_gpu12&#45;&gt;l3_qkv_gpu12 -->
<g id="edge2701" class="edge">
<title>l2_expert_agg_gpu12&#45;&gt;l3_qkv_gpu12</title>
<path fill="none" stroke="black" d="M18074.77,-6143.14C18064.28,-6127.16 18051.65,-6107.94 18040.04,-6090.26"/>
<polygon fill="black" stroke="black" points="18042.85,-6088.17 18034.44,-6081.73 18037,-6092.01 18042.85,-6088.17"/>
</g>
<!-- l3_qkv_gpu13 -->
<g id="node942" class="node">
<title>l3_qkv_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="18813" cy="-6035.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="18813" y="-6054.72" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="18813" y="-6039.72" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18813" y="-6024.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="18813" y="-6009.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_expert_agg_gpu13&#45;&gt;l3_qkv_gpu13 -->
<g id="edge2702" class="edge">
<title>l2_expert_agg_gpu13&#45;&gt;l3_qkv_gpu13</title>
<path fill="none" stroke="black" d="M18840.47,-6142.04C18836.62,-6127.31 18832.09,-6109.98 18827.83,-6093.67"/>
<polygon fill="black" stroke="black" points="18831.14,-6092.48 18825.22,-6083.69 18824.37,-6094.25 18831.14,-6092.48"/>
</g>
<!-- l3_qkv_gpu14 -->
<g id="node943" class="node">
<title>l3_qkv_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19217" cy="-6035.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="19217" y="-6054.72" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="19217" y="-6039.72" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19217" y="-6024.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="19217" y="-6009.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_expert_agg_gpu14&#45;&gt;l3_qkv_gpu14 -->
<g id="edge2703" class="edge">
<title>l2_expert_agg_gpu14&#45;&gt;l3_qkv_gpu14</title>
<path fill="none" stroke="black" d="M19223.66,-6141.67C19222.74,-6127.22 19221.66,-6110.29 19220.65,-6094.31"/>
<polygon fill="black" stroke="black" points="19224.12,-6093.74 19219.99,-6083.98 19217.13,-6094.19 19224.12,-6093.74"/>
</g>
<!-- l3_qkv_gpu15 -->
<g id="node944" class="node">
<title>l3_qkv_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20429" cy="-6035.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="20429" y="-6054.72" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="20429" y="-6039.72" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20429" y="-6024.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="20429" y="-6009.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_expert_agg_gpu15&#45;&gt;l3_qkv_gpu15 -->
<g id="edge2704" class="edge">
<title>l2_expert_agg_gpu15&#45;&gt;l3_qkv_gpu15</title>
<path fill="none" stroke="black" d="M20372.93,-6142.77C20381.17,-6127.22 20391.01,-6108.64 20400.13,-6091.42"/>
<polygon fill="black" stroke="black" points="20403.23,-6093.04 20404.82,-6082.56 20397.05,-6089.76 20403.23,-6093.04"/>
</g>
<!-- l2_gate_gpu1&#45;&gt;l2_expert0_gpu0 -->
<g id="edge843" class="edge">
<title>l2_gate_gpu1&#45;&gt;l2_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19450,-6411.28C19438.98,-6407.09 19427.3,-6403.41 19416,-6401.17 19391.73,-6396.35 12308.47,-6400.68 12291,-6383.17 12286.29,-6378.45 12286.32,-6372.92 12291,-6368.17 12327.44,-6331.14 15721.11,-6307.36 16294.24,-6303.6"/>
<polygon fill="black" stroke="black" points="16294.51,-6307.1 16304.48,-6303.54 16294.46,-6300.1 16294.51,-6307.1"/>
<text text-anchor="middle" x="12336.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l2_gate_gpu1&#45;&gt;l2_expert1_gpu1 -->
<g id="edge844" class="edge">
<title>l2_gate_gpu1&#45;&gt;l2_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19449.99,-6411.36C19438.96,-6407.17 19427.29,-6403.46 19416,-6401.17 19372.3,-6392.3 17842.35,-6414.87 17811,-6383.17 17768.65,-6340.34 18019.94,-6354.67 18080,-6350.17 18253.37,-6337.17 18456.36,-6319.79 18566.29,-6310.19"/>
<polygon fill="black" stroke="black" points="18566.66,-6313.68 18576.31,-6309.32 18566.05,-6306.7 18566.66,-6313.68"/>
<text text-anchor="middle" x="17856.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l2_gate_gpu1&#45;&gt;l2_expert2_gpu2 -->
<g id="edge845" class="edge">
<title>l2_gate_gpu1&#45;&gt;l2_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19450,-6411.29C19438.98,-6407.1 19427.3,-6403.41 19416,-6401.17 19379.49,-6393.91 14081.28,-6409.53 14055,-6383.17 14050.29,-6378.44 14050.3,-6372.9 14055,-6368.17 14066.75,-6356.33 16439.33,-6350.65 16456,-6350.17 16773.31,-6341.03 17150.43,-6318.6 17313.35,-6308.35"/>
<polygon fill="black" stroke="black" points="17314.01,-6311.81 17323.77,-6307.69 17313.57,-6304.83 17314.01,-6311.81"/>
<text text-anchor="middle" x="14100.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l2_gate_gpu1&#45;&gt;l2_expert3_gpu3 -->
<g id="edge846" class="edge">
<title>l2_gate_gpu1&#45;&gt;l2_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19560,-6411.29C19571.02,-6407.1 19582.7,-6403.41 19594,-6401.17 19632.87,-6393.44 25272.02,-6411.23 25300,-6383.17 25304.71,-6378.44 25304.62,-6372.97 25300,-6368.17 25246.14,-6312.1 24080.53,-6304.33 23758.68,-6303.26"/>
<polygon fill="black" stroke="black" points="23758.51,-6299.76 23748.5,-6303.22 23758.49,-6306.76 23758.51,-6299.76"/>
<text text-anchor="middle" x="25348.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l2_gate_gpu1&#45;&gt;l2_expert4_gpu4 -->
<g id="edge847" class="edge">
<title>l2_gate_gpu1&#45;&gt;l2_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19560,-6411.3C19571.03,-6407.11 19582.7,-6403.42 19594,-6401.17 19620.07,-6395.96 23403.25,-6402.01 23422,-6383.17 23426.7,-6378.44 23426.59,-6373 23422,-6368.17 23380.34,-6324.35 22492.55,-6308.15 22215.1,-6304.15"/>
<polygon fill="black" stroke="black" points="22214.75,-6300.64 22204.7,-6304 22214.65,-6307.64 22214.75,-6300.64"/>
<text text-anchor="middle" x="23470.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l2_gate_gpu1&#45;&gt;l2_expert5_gpu5 -->
<g id="edge848" class="edge">
<title>l2_gate_gpu1&#45;&gt;l2_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19450,-6411.3C19438.97,-6407.12 19427.3,-6403.42 19416,-6401.17 19392.28,-6396.43 15950.06,-6400.31 15933,-6383.17 15928.3,-6378.44 15928.31,-6372.91 15933,-6368.17 15948.06,-6352.93 17453.61,-6351.25 17475,-6350.17 17632.88,-6342.18 17816.75,-6323.53 17919.64,-6312.25"/>
<polygon fill="black" stroke="black" points="17920.08,-6315.72 17929.64,-6311.15 17919.32,-6308.76 17920.08,-6315.72"/>
<text text-anchor="middle" x="15978.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l2_gate_gpu1&#45;&gt;l2_expert6_gpu6 -->
<g id="edge849" class="edge">
<title>l2_gate_gpu1&#45;&gt;l2_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19562.96,-6412.49C19573.2,-6408.45 19583.84,-6404.5 19594,-6401.17 19625.34,-6390.88 19636.39,-6397.71 19666,-6383.17 19675.66,-6378.42 19676.13,-6374.25 19685,-6368.17 19699.68,-6358.09 19715.97,-6347.94 19731.41,-6338.75"/>
<polygon fill="black" stroke="black" points="19733.55,-6341.55 19740.39,-6333.45 19730,-6335.52 19733.55,-6341.55"/>
<text text-anchor="middle" x="19730.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l2_gate_gpu1&#45;&gt;l2_expert7_gpu7 -->
<g id="edge850" class="edge">
<title>l2_gate_gpu1&#45;&gt;l2_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19560.01,-6411.34C19571.03,-6407.15 19582.7,-6403.45 19594,-6401.17 19620.55,-6395.81 21524.94,-6402.41 21544,-6383.17 21548.69,-6378.43 21548.46,-6373.12 21544,-6368.17 21508.61,-6328.87 21165.83,-6311.64 21005.69,-6305.69"/>
<polygon fill="black" stroke="black" points="21005.53,-6302.18 20995.41,-6305.31 21005.27,-6309.17 21005.53,-6302.18"/>
<text text-anchor="middle" x="21592.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l2_gate_gpu2&#45;&gt;l2_expert0_gpu0 -->
<g id="edge868" class="edge">
<title>l2_gate_gpu2&#45;&gt;l2_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20696,-6411.28C20684.98,-6407.09 20673.3,-6403.41 20662,-6401.17 20636.33,-6396.07 13143.48,-6401.69 13125,-6383.17 13120.29,-6378.45 13120.33,-6372.93 13125,-6368.17 13182.18,-6309.83 15795.17,-6303.78 16294.14,-6303.15"/>
<polygon fill="black" stroke="black" points="16294.15,-6306.65 16304.15,-6303.14 16294.14,-6299.65 16294.15,-6306.65"/>
<text text-anchor="middle" x="13170.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l2_gate_gpu2&#45;&gt;l2_expert1_gpu1 -->
<g id="edge869" class="edge">
<title>l2_gate_gpu2&#45;&gt;l2_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20695.99,-6411.34C20684.97,-6407.15 20673.3,-6403.44 20662,-6401.17 20634.54,-6395.63 18664.72,-6403.06 18645,-6383.17 18638.67,-6376.78 18635.66,-6368.51 18634.71,-6359.71"/>
<polygon fill="black" stroke="black" points="18638.21,-6359.53 18634.43,-6349.63 18631.21,-6359.73 18638.21,-6359.53"/>
<text text-anchor="middle" x="18690.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l2_gate_gpu2&#45;&gt;l2_expert2_gpu2 -->
<g id="edge870" class="edge">
<title>l2_gate_gpu2&#45;&gt;l2_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20696,-6411.29C20684.98,-6407.1 20673.3,-6403.41 20662,-6401.17 20622.68,-6393.35 14917.3,-6411.56 14889,-6383.17 14884.29,-6378.44 14884.31,-6372.91 14889,-6368.17 14904.3,-6352.69 16434.24,-6350.84 16456,-6350.17 16773.29,-6340.39 17150.42,-6318.3 17313.35,-6308.24"/>
<polygon fill="black" stroke="black" points="17314.01,-6311.71 17323.77,-6307.59 17313.57,-6304.72 17314.01,-6311.71"/>
<text text-anchor="middle" x="14934.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l2_gate_gpu2&#45;&gt;l2_expert3_gpu3 -->
<g id="edge871" class="edge">
<title>l2_gate_gpu2&#45;&gt;l2_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20806,-6411.29C20817.02,-6407.1 20828.7,-6403.41 20840,-6401.17 20876.06,-6394 26108.05,-6409.21 26134,-6383.17 26138.71,-6378.44 26138.65,-6372.94 26134,-6368.17 26091.63,-6324.66 24180.52,-6307.05 23758.78,-6303.7"/>
<polygon fill="black" stroke="black" points="23758.53,-6300.19 23748.51,-6303.62 23758.48,-6307.19 23758.53,-6300.19"/>
<text text-anchor="middle" x="26182.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l2_gate_gpu2&#45;&gt;l2_expert4_gpu4 -->
<g id="edge872" class="edge">
<title>l2_gate_gpu2&#45;&gt;l2_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20806,-6411.31C20817.03,-6407.12 20828.7,-6403.42 20840,-6401.17 20863.26,-6396.52 24239.27,-6399.98 24256,-6383.17 24260.7,-6378.44 24260.65,-6372.94 24256,-6368.17 24243.23,-6355.04 23615.3,-6350.71 23597,-6350.17 23070.3,-6334.5 22437.09,-6313.35 22214.86,-6305.85"/>
<polygon fill="black" stroke="black" points="22214.71,-6302.35 22204.59,-6305.51 22214.47,-6309.34 22214.71,-6302.35"/>
<text text-anchor="middle" x="24304.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l2_gate_gpu2&#45;&gt;l2_expert5_gpu5 -->
<g id="edge873" class="edge">
<title>l2_gate_gpu2&#45;&gt;l2_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20696,-6411.3C20684.97,-6407.11 20673.3,-6403.42 20662,-6401.17 20635.47,-6395.87 16786.08,-6402.34 16767,-6383.17 16762.3,-6378.44 16762.35,-6372.94 16767,-6368.17 16780.73,-6354.08 17455.36,-6351.29 17475,-6350.17 17632.82,-6341.09 17816.71,-6322.82 17919.62,-6311.9"/>
<polygon fill="black" stroke="black" points="17920.05,-6315.38 17929.62,-6310.84 17919.31,-6308.42 17920.05,-6315.38"/>
<text text-anchor="middle" x="16812.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l2_gate_gpu2&#45;&gt;l2_expert6_gpu6 -->
<g id="edge874" class="edge">
<title>l2_gate_gpu2&#45;&gt;l2_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20694.3,-6411.86C20683.73,-6407.78 20672.65,-6403.99 20662,-6401.17 20601.78,-6385.21 20581.45,-6404.72 20523,-6383.17 20511.55,-6378.94 20511.53,-6372.18 20500,-6368.17 20386.84,-6328.77 20037.12,-6311.63 19876.81,-6305.7"/>
<polygon fill="black" stroke="black" points="19876.65,-6302.19 19866.53,-6305.32 19876.39,-6309.19 19876.65,-6302.19"/>
<text text-anchor="middle" x="20568.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l2_gate_gpu2&#45;&gt;l2_expert7_gpu7 -->
<g id="edge875" class="edge">
<title>l2_gate_gpu2&#45;&gt;l2_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20806.01,-6411.36C20817.04,-6407.17 20828.71,-6403.46 20840,-6401.17 20881.87,-6392.66 22347.97,-6413.55 22378,-6383.17 22382.69,-6378.42 22382.61,-6372.98 22378,-6368.17 22372.02,-6361.91 21310.88,-6318.68 21005.4,-6306.35"/>
<polygon fill="black" stroke="black" points="21005.41,-6302.85 20995.28,-6305.95 21005.13,-6309.85 21005.41,-6302.85"/>
<text text-anchor="middle" x="22426.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l2_gate_gpu3&#45;&gt;l2_expert0_gpu0 -->
<g id="edge893" class="edge">
<title>l2_gate_gpu3&#45;&gt;l2_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M21052,-6411.28C21040.98,-6407.09 21029.3,-6403.41 21018,-6401.17 20991.89,-6395.99 13371.8,-6402.01 13353,-6383.17 13348.29,-6378.45 13348.34,-6372.93 13353,-6368.17 13405.92,-6314.09 15816.61,-6304.63 16294.26,-6303.28"/>
<polygon fill="black" stroke="black" points="16294.52,-6306.78 16304.51,-6303.25 16294.5,-6299.78 16294.52,-6306.78"/>
<text text-anchor="middle" x="13398.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l2_gate_gpu3&#45;&gt;l2_expert1_gpu1 -->
<g id="edge894" class="edge">
<title>l2_gate_gpu3&#45;&gt;l2_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M21051.99,-6411.33C21040.97,-6407.14 21029.3,-6403.44 21018,-6401.17 20901.18,-6377.63 18987.09,-6417.6 18873,-6383.17 18861.32,-6379.64 18861.02,-6373.41 18850,-6368.17 18809.64,-6348.96 18762.18,-6333.39 18723.31,-6322.3"/>
<polygon fill="black" stroke="black" points="18724.19,-6318.92 18713.62,-6319.58 18722.3,-6325.66 18724.19,-6318.92"/>
<text text-anchor="middle" x="18918.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l2_gate_gpu3&#45;&gt;l2_expert2_gpu2 -->
<g id="edge895" class="edge">
<title>l2_gate_gpu3&#45;&gt;l2_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M21052,-6411.29C21040.98,-6407.1 21029.3,-6403.41 21018,-6401.17 20977.81,-6393.18 15145.93,-6412.19 15117,-6383.17 15112.29,-6378.44 15112.32,-6372.91 15117,-6368.17 15130.06,-6354.93 16437.41,-6350.76 16456,-6350.17 16773.28,-6340.08 17150.41,-6318.15 17313.35,-6308.19"/>
<polygon fill="black" stroke="black" points="17314,-6311.65 17323.77,-6307.55 17313.57,-6304.67 17314,-6311.65"/>
<text text-anchor="middle" x="15162.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l2_gate_gpu3&#45;&gt;l2_expert3_gpu3 -->
<g id="edge896" class="edge">
<title>l2_gate_gpu3&#45;&gt;l2_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M21162,-6411.29C21173.02,-6407.1 21184.7,-6403.41 21196,-6401.17 21231.19,-6394.17 26336.68,-6408.58 26362,-6383.17 26366.71,-6378.44 26366.66,-6372.94 26362,-6368.17 26315.38,-6320.41 24203.5,-6306.01 23758.69,-6303.51"/>
<polygon fill="black" stroke="black" points="23758.52,-6300.01 23748.5,-6303.45 23758.48,-6307.01 23758.52,-6300.01"/>
<text text-anchor="middle" x="26410.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l2_gate_gpu3&#45;&gt;l2_expert4_gpu4 -->
<g id="edge897" class="edge">
<title>l2_gate_gpu3&#45;&gt;l2_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M21162,-6411.31C21173.03,-6407.12 21184.7,-6403.42 21196,-6401.17 21240.78,-6392.21 24451.8,-6415.55 24484,-6383.17 24488.7,-6378.44 24488.67,-6372.93 24484,-6368.17 24466.75,-6350.56 23621.64,-6350.81 23597,-6350.17 23070.25,-6336.35 22437.07,-6314.05 22214.86,-6306.06"/>
<polygon fill="black" stroke="black" points="22214.71,-6302.55 22204.59,-6305.69 22214.46,-6309.54 22214.71,-6302.55"/>
<text text-anchor="middle" x="24532.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l2_gate_gpu3&#45;&gt;l2_expert5_gpu5 -->
<g id="edge898" class="edge">
<title>l2_gate_gpu3&#45;&gt;l2_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M21052,-6411.3C21040.98,-6407.11 21029.3,-6403.42 21018,-6401.17 20990.6,-6395.7 17014.71,-6402.96 16995,-6383.17 16990.3,-6378.44 16990.38,-6372.97 16995,-6368.17 17013.51,-6348.95 17448.37,-6351.86 17475,-6350.17 17632.77,-6340.14 17816.67,-6322.21 17919.6,-6311.6"/>
<polygon fill="black" stroke="black" points="17920.02,-6315.08 17929.61,-6310.57 17919.3,-6308.11 17920.02,-6315.08"/>
<text text-anchor="middle" x="17040.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l2_gate_gpu3&#45;&gt;l2_expert6_gpu6 -->
<g id="edge899" class="edge">
<title>l2_gate_gpu3&#45;&gt;l2_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M21051.4,-6411.68C21040.53,-6407.52 21029.06,-6403.74 21018,-6401.17 20902.15,-6374.25 20863.8,-6420.87 20751,-6383.17 20739.43,-6379.3 20739.57,-6372.05 20728,-6368.17 20571.3,-6315.58 20073.78,-6305.47 19876.61,-6303.54"/>
<polygon fill="black" stroke="black" points="19876.64,-6300.04 19866.6,-6303.44 19876.57,-6307.04 19876.64,-6300.04"/>
<text text-anchor="middle" x="20796.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l2_gate_gpu3&#45;&gt;l2_expert7_gpu7 -->
<g id="edge900" class="edge">
<title>l2_gate_gpu3&#45;&gt;l2_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M21162.01,-6411.37C21173.04,-6407.18 21184.71,-6403.47 21196,-6401.17 21233.95,-6393.43 22562.79,-6410.72 22590,-6383.17 22594.68,-6378.42 22594.63,-6372.96 22590,-6368.17 22569.25,-6346.71 22082.83,-6351.29 22053,-6350.17 21660.5,-6335.4 21191.37,-6314.93 21005.55,-6306.71"/>
<polygon fill="black" stroke="black" points="21005.47,-6303.21 20995.32,-6306.26 21005.16,-6310.2 21005.47,-6303.21"/>
<text text-anchor="middle" x="22638.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l2_gate_gpu4&#45;&gt;l2_expert0_gpu0 -->
<g id="edge918" class="edge">
<title>l2_gate_gpu4&#45;&gt;l2_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19984,-6411.28C19972.98,-6407.09 19961.3,-6403.41 19950,-6401.17 19925.11,-6396.23 12659.92,-6401.13 12642,-6383.17 12637.29,-6378.45 12637.33,-6372.92 12642,-6368.17 12708.25,-6300.75 15753.86,-6302.15 16294.41,-6302.94"/>
<polygon fill="black" stroke="black" points="16294.46,-6306.44 16304.46,-6302.95 16294.47,-6299.44 16294.46,-6306.44"/>
<text text-anchor="middle" x="12687.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l2_gate_gpu4&#45;&gt;l2_expert1_gpu1 -->
<g id="edge919" class="edge">
<title>l2_gate_gpu4&#45;&gt;l2_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19983.99,-6411.35C19972.97,-6407.16 19961.29,-6403.45 19950,-6401.17 19925.66,-6396.24 18179.47,-6400.81 18162,-6383.17 18103.75,-6324.32 18412.45,-6308.67 18565.29,-6304.54"/>
<polygon fill="black" stroke="black" points="18565.66,-6308.04 18575.57,-6304.28 18565.48,-6301.04 18565.66,-6308.04"/>
<text text-anchor="middle" x="18207.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l2_gate_gpu4&#45;&gt;l2_expert2_gpu2 -->
<g id="edge920" class="edge">
<title>l2_gate_gpu4&#45;&gt;l2_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19984,-6411.29C19972.98,-6407.1 19961.3,-6403.41 19950,-6401.17 19912.24,-6393.66 14433.18,-6410.43 14406,-6383.17 14401.29,-6378.44 14401.31,-6372.9 14406,-6368.17 14426.05,-6347.94 16427.54,-6351 16456,-6350.17 16773.3,-6340.82 17150.42,-6318.5 17313.35,-6308.31"/>
<polygon fill="black" stroke="black" points="17314.01,-6311.78 17323.77,-6307.66 17313.57,-6304.79 17314.01,-6311.78"/>
<text text-anchor="middle" x="14451.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l2_gate_gpu4&#45;&gt;l2_expert3_gpu3 -->
<g id="edge921" class="edge">
<title>l2_gate_gpu4&#45;&gt;l2_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20094,-6411.29C20105.02,-6407.1 20116.7,-6403.41 20128,-6401.17 20165.62,-6393.69 25623.92,-6410.33 25651,-6383.17 25655.71,-6378.44 25655.64,-6372.96 25651,-6368.17 25584.25,-6299.18 24123.33,-6301.09 23758.83,-6302.64"/>
<polygon fill="black" stroke="black" points="23758.61,-6299.14 23748.62,-6302.69 23758.64,-6306.14 23758.61,-6299.14"/>
<text text-anchor="middle" x="25699.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l2_gate_gpu4&#45;&gt;l2_expert4_gpu4 -->
<g id="edge922" class="edge">
<title>l2_gate_gpu4&#45;&gt;l2_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20094,-6411.3C20105.03,-6407.11 20116.7,-6403.42 20128,-6401.17 20152.82,-6396.21 23755.15,-6401.11 23773,-6383.17 23777.7,-6378.44 23777.62,-6372.97 23773,-6368.17 23759.35,-6353.96 22544.61,-6315.71 22214.82,-6305.57"/>
<polygon fill="black" stroke="black" points="22214.49,-6302.06 22204.39,-6305.25 22214.28,-6309.06 22214.49,-6302.06"/>
<text text-anchor="middle" x="23821.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l2_gate_gpu4&#45;&gt;l2_expert5_gpu5 -->
<g id="edge923" class="edge">
<title>l2_gate_gpu4&#45;&gt;l2_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19984,-6411.3C19972.97,-6407.11 19961.3,-6403.42 19950,-6401.17 19925.03,-6396.18 16301.96,-6401.21 16284,-6383.17 16279.3,-6378.44 16279.32,-6372.92 16284,-6368.17 16307.22,-6344.59 17441.96,-6351.89 17475,-6350.17 17632.87,-6341.91 17816.74,-6323.35 17919.63,-6312.16"/>
<polygon fill="black" stroke="black" points="17920.08,-6315.63 17929.64,-6311.07 17919.32,-6308.67 17920.08,-6315.63"/>
<text text-anchor="middle" x="16329.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l2_gate_gpu4&#45;&gt;l2_expert6_gpu6 -->
<g id="edge924" class="edge">
<title>l2_gate_gpu4&#45;&gt;l2_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20025.7,-6401.43C20019.74,-6389.42 20011.62,-6376.9 20001,-6368.17 19965.41,-6338.89 19916.53,-6322.73 19875.31,-6313.83"/>
<polygon fill="black" stroke="black" points="19875.78,-6310.36 19865.28,-6311.78 19874.38,-6317.21 19875.78,-6310.36"/>
<text text-anchor="middle" x="20059.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l2_gate_gpu4&#45;&gt;l2_expert7_gpu7 -->
<g id="edge925" class="edge">
<title>l2_gate_gpu4&#45;&gt;l2_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20094.01,-6411.35C20105.03,-6407.16 20116.71,-6403.45 20128,-6401.17 20152.06,-6396.3 21877.73,-6400.61 21895,-6383.17 21958.05,-6319.47 21251.07,-6306.35 21005.94,-6303.72"/>
<polygon fill="black" stroke="black" points="21005.7,-6300.22 20995.66,-6303.61 21005.63,-6307.22 21005.7,-6300.22"/>
<text text-anchor="middle" x="21943.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l2_gate_gpu5&#45;&gt;l2_expert0_gpu0 -->
<g id="edge943" class="edge">
<title>l2_gate_gpu5&#45;&gt;l2_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20874,-6411.28C20862.98,-6407.09 20851.3,-6403.41 20840,-6401.17 20814.11,-6396.03 13257.64,-6401.85 13239,-6383.17 13234.29,-6378.45 13234.34,-6372.93 13239,-6368.17 13294.06,-6311.96 15806.19,-6304.19 16294.32,-6303.21"/>
<polygon fill="black" stroke="black" points="16294.45,-6306.71 16304.45,-6303.19 16294.44,-6299.71 16294.45,-6306.71"/>
<text text-anchor="middle" x="13284.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l2_gate_gpu5&#45;&gt;l2_expert1_gpu1 -->
<g id="edge944" class="edge">
<title>l2_gate_gpu5&#45;&gt;l2_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20873.99,-6411.34C20862.97,-6407.14 20851.3,-6403.44 20840,-6401.17 20726.66,-6378.32 18868.94,-6418.95 18759,-6383.17 18755.47,-6382.02 18729.02,-6363.15 18702.71,-6344.01"/>
<polygon fill="black" stroke="black" points="18704.72,-6341.15 18694.58,-6338.09 18700.6,-6346.8 18704.72,-6341.15"/>
<text text-anchor="middle" x="18804.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l2_gate_gpu5&#45;&gt;l2_expert2_gpu2 -->
<g id="edge945" class="edge">
<title>l2_gate_gpu5&#45;&gt;l2_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20874,-6411.29C20862.98,-6407.1 20851.3,-6403.41 20840,-6401.17 20800.24,-6393.27 15031.62,-6411.87 15003,-6383.17 14998.29,-6378.44 14998.32,-6372.91 15003,-6368.17 15017.18,-6353.81 16435.83,-6350.8 16456,-6350.17 16773.29,-6340.25 17150.42,-6318.23 17313.35,-6308.21"/>
<polygon fill="black" stroke="black" points="17314,-6311.68 17323.77,-6307.57 17313.57,-6304.69 17314,-6311.68"/>
<text text-anchor="middle" x="15048.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l2_gate_gpu5&#45;&gt;l2_expert3_gpu3 -->
<g id="edge946" class="edge">
<title>l2_gate_gpu5&#45;&gt;l2_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20984,-6411.29C20995.02,-6407.1 21006.7,-6403.41 21018,-6401.17 21053.62,-6394.08 26222.36,-6408.89 26248,-6383.17 26252.71,-6378.44 26252.65,-6372.94 26248,-6368.17 26203.52,-6322.54 24193.07,-6306.53 23759.04,-6303.6"/>
<polygon fill="black" stroke="black" points="23758.8,-6300.1 23748.78,-6303.53 23758.75,-6307.1 23758.8,-6300.1"/>
<text text-anchor="middle" x="26296.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l2_gate_gpu5&#45;&gt;l2_expert4_gpu4 -->
<g id="edge947" class="edge">
<title>l2_gate_gpu5&#45;&gt;l2_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20984,-6411.31C20995.03,-6407.12 21006.7,-6403.42 21018,-6401.17 21040.83,-6396.6 24353.58,-6399.67 24370,-6383.17 24374.7,-6378.44 24374.66,-6372.93 24370,-6368.17 24354.99,-6352.8 23618.47,-6350.76 23597,-6350.17 23070.27,-6335.56 22437.08,-6313.75 22214.86,-6305.97"/>
<polygon fill="black" stroke="black" points="22214.71,-6302.46 22204.59,-6305.61 22214.46,-6309.46 22214.71,-6302.46"/>
<text text-anchor="middle" x="24418.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l2_gate_gpu5&#45;&gt;l2_expert5_gpu5 -->
<g id="edge948" class="edge">
<title>l2_gate_gpu5&#45;&gt;l2_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20874,-6411.3C20862.98,-6407.11 20851.3,-6403.42 20840,-6401.17 20813.04,-6395.79 16900.4,-6402.65 16881,-6383.17 16876.3,-6378.44 16876.36,-6372.95 16881,-6368.17 16903.99,-6344.47 17442.04,-6352.14 17475,-6350.17 17632.8,-6340.71 17816.69,-6322.57 17919.61,-6311.78"/>
<polygon fill="black" stroke="black" points="17920.04,-6315.26 17929.62,-6310.73 17919.31,-6308.29 17920.04,-6315.26"/>
<text text-anchor="middle" x="16926.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l2_gate_gpu5&#45;&gt;l2_expert6_gpu6 -->
<g id="edge949" class="edge">
<title>l2_gate_gpu5&#45;&gt;l2_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20872.87,-6411.69C20862.15,-6407.57 20850.87,-6403.81 20840,-6401.17 20751.99,-6379.74 20722.6,-6412.79 20637,-6383.17 20625.47,-6379.17 20625.55,-6372.1 20614,-6368.17 20479.17,-6322.19 20056.13,-6308.34 19876.72,-6304.47"/>
<polygon fill="black" stroke="black" points="19876.63,-6300.97 19866.56,-6304.26 19876.48,-6307.97 19876.63,-6300.97"/>
<text text-anchor="middle" x="20682.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l2_gate_gpu5&#45;&gt;l2_expert7_gpu7 -->
<g id="edge950" class="edge">
<title>l2_gate_gpu5&#45;&gt;l2_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20984.01,-6411.37C20995.04,-6407.17 21006.71,-6403.46 21018,-6401.17 21058.13,-6393 22463.22,-6412.3 22492,-6383.17 22496.69,-6378.42 22496.62,-6372.98 22492,-6368.17 22475.1,-6350.56 22077.39,-6351.17 22053,-6350.17 21660.56,-6333.94 21191.4,-6314.29 21005.56,-6306.5"/>
<polygon fill="black" stroke="black" points="21005.47,-6303 20995.33,-6306.07 21005.17,-6309.99 21005.47,-6303"/>
<text text-anchor="middle" x="22540.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l2_gate_gpu6&#45;&gt;l2_expert0_gpu0 -->
<g id="edge968" class="edge">
<title>l2_gate_gpu6&#45;&gt;l2_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M18916,-6411.28C18904.98,-6407.09 18893.3,-6403.41 18882,-6401.17 18858.33,-6396.47 11948.04,-6400.25 11931,-6383.17 11926.29,-6378.45 11926.32,-6372.91 11931,-6368.17 11970.82,-6327.76 15690.72,-6306.66 16293.82,-6303.5"/>
<polygon fill="black" stroke="black" points="16294.18,-6307 16304.16,-6303.45 16294.14,-6300 16294.18,-6307"/>
<text text-anchor="middle" x="11976.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l2_gate_gpu6&#45;&gt;l2_expert1_gpu1 -->
<g id="edge969" class="edge">
<title>l2_gate_gpu6&#45;&gt;l2_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M18915.99,-6411.37C18904.96,-6407.18 18893.29,-6403.46 18882,-6401.17 18843.05,-6393.23 17478.93,-6411.45 17451,-6383.17 17446.32,-6378.42 17446.35,-6372.95 17451,-6368.17 17463.18,-6355.63 18062.55,-6351.14 18080,-6350.17 18253.58,-6340.48 18456.49,-6321.86 18566.36,-6311.16"/>
<polygon fill="black" stroke="black" points="18566.76,-6314.64 18576.37,-6310.19 18566.08,-6307.68 18566.76,-6314.64"/>
<text text-anchor="middle" x="17496.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l2_gate_gpu6&#45;&gt;l2_expert2_gpu2 -->
<g id="edge970" class="edge">
<title>l2_gate_gpu6&#45;&gt;l2_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M18916,-6411.29C18904.98,-6407.1 18893.3,-6403.41 18882,-6401.17 18846.67,-6394.14 13720.43,-6408.68 13695,-6383.17 13690.29,-6378.44 13690.3,-6372.9 13695,-6368.17 13708.51,-6354.56 16436.83,-6350.71 16456,-6350.17 16773.31,-6341.18 17150.43,-6318.67 17313.36,-6308.38"/>
<polygon fill="black" stroke="black" points="17314.02,-6311.84 17323.77,-6307.72 17313.57,-6304.86 17314.02,-6311.84"/>
<text text-anchor="middle" x="13740.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l2_gate_gpu6&#45;&gt;l2_expert3_gpu3 -->
<g id="edge971" class="edge">
<title>l2_gate_gpu6&#45;&gt;l2_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19026,-6411.29C19037.02,-6407.1 19048.7,-6403.41 19060,-6401.17 19100.05,-6393.21 24911.17,-6412.08 24940,-6383.17 24944.71,-6378.44 24944.59,-6373 24940,-6368.17 24899.27,-6325.29 24032.29,-6308.48 23758.85,-6304.24"/>
<polygon fill="black" stroke="black" points="23758.65,-6300.73 23748.6,-6304.08 23758.55,-6307.73 23758.65,-6300.73"/>
<text text-anchor="middle" x="24988.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l2_gate_gpu6&#45;&gt;l2_expert4_gpu4 -->
<g id="edge972" class="edge">
<title>l2_gate_gpu6&#45;&gt;l2_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19026,-6411.3C19037.02,-6407.11 19048.7,-6403.42 19060,-6401.17 19087.26,-6395.73 23042.39,-6402.86 23062,-6383.17 23066.7,-6378.44 23066.55,-6373.04 23062,-6368.17 23004.85,-6306.87 22430.91,-6302.17 22214.76,-6302.6"/>
<polygon fill="black" stroke="black" points="22214.73,-6299.1 22204.74,-6302.62 22214.75,-6306.1 22214.73,-6299.1"/>
<text text-anchor="middle" x="23110.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l2_gate_gpu6&#45;&gt;l2_expert5_gpu5 -->
<g id="edge973" class="edge">
<title>l2_gate_gpu6&#45;&gt;l2_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M18916,-6411.31C18904.97,-6407.12 18893.3,-6403.42 18882,-6401.17 18836.93,-6392.16 15605.41,-6415.75 15573,-6383.17 15568.3,-6378.44 15568.31,-6372.9 15573,-6368.17 15591.59,-6349.4 17448.61,-6351.47 17475,-6350.17 17632.89,-6342.35 17816.75,-6323.64 17919.64,-6312.3"/>
<polygon fill="black" stroke="black" points="17920.09,-6315.77 17929.64,-6311.19 17919.32,-6308.82 17920.09,-6315.77"/>
<text text-anchor="middle" x="15618.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l2_gate_gpu6&#45;&gt;l2_expert6_gpu6 -->
<g id="edge974" class="edge">
<title>l2_gate_gpu6&#45;&gt;l2_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19027.09,-6411.55C19037.82,-6407.45 19049.11,-6403.73 19060,-6401.17 19166.71,-6376.05 19203.82,-6422.88 19306,-6383.17 19316.03,-6379.27 19315.1,-6372.38 19325,-6368.17 19393.23,-6339.08 19598,-6318.71 19713.48,-6309.19"/>
<polygon fill="black" stroke="black" points="19714.01,-6312.66 19723.69,-6308.36 19713.44,-6305.68 19714.01,-6312.66"/>
<text text-anchor="middle" x="19370.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l2_gate_gpu6&#45;&gt;l2_expert7_gpu7 -->
<g id="edge975" class="edge">
<title>l2_gate_gpu6&#45;&gt;l2_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19026.01,-6411.33C19037.03,-6407.14 19048.7,-6403.44 19060,-6401.17 19088.92,-6395.34 21163.23,-6404.11 21184,-6383.17 21241.65,-6325.02 21101.98,-6308.9 21005.81,-6304.55"/>
<polygon fill="black" stroke="black" points="21005.91,-6301.05 20995.77,-6304.13 21005.61,-6308.05 21005.91,-6301.05"/>
<text text-anchor="middle" x="21239.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l2_gate_gpu7&#45;&gt;l2_expert0_gpu0 -->
<g id="edge993" class="edge">
<title>l2_gate_gpu7&#45;&gt;l2_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M22776.09,-6435.09C22553.85,-6428.06 21909.6,-6408.56 21374,-6401.17 21353.12,-6400.88 15375.74,-6397.95 15361,-6383.17 15294.53,-6316.49 16041.66,-6305.33 16294.25,-6303.46"/>
<polygon fill="black" stroke="black" points="16294.49,-6306.96 16304.47,-6303.39 16294.44,-6299.96 16294.49,-6306.96"/>
<text text-anchor="middle" x="15406.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l2_gate_gpu7&#45;&gt;l2_expert1_gpu1 -->
<g id="edge994" class="edge">
<title>l2_gate_gpu7&#45;&gt;l2_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M22776.18,-6435.69C22420.51,-6426.85 20996.49,-6390.98 20975,-6383.17 20964.89,-6379.49 20966.14,-6371.77 20956,-6368.17 20891.03,-6345.08 19783.92,-6352.18 19715,-6350.17 19346.48,-6339.37 18906.82,-6316.98 18728.31,-6307.49"/>
<polygon fill="black" stroke="black" points="18728.39,-6303.99 18718.22,-6306.95 18728.01,-6310.98 18728.39,-6303.99"/>
<text text-anchor="middle" x="21020.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l2_gate_gpu7&#45;&gt;l2_expert2_gpu2 -->
<g id="edge995" class="edge">
<title>l2_gate_gpu7&#45;&gt;l2_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M22776.09,-6435.13C22553.85,-6428.19 21909.59,-6408.93 21374,-6401.17 21345.29,-6400.75 17259.26,-6403.51 17239,-6383.17 17207.61,-6351.64 17262.91,-6330 17316.14,-6317.25"/>
<polygon fill="black" stroke="black" points="17317.08,-6320.62 17326.04,-6314.97 17315.51,-6313.8 17317.08,-6320.62"/>
<text text-anchor="middle" x="17284.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l2_gate_gpu7&#45;&gt;l2_expert3_gpu3 -->
<g id="edge996" class="edge">
<title>l2_gate_gpu7&#45;&gt;l2_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M22936.16,-6437.29C23483.84,-6434.64 26653.86,-6417.79 26688,-6383.17 26692.68,-6378.42 26692.66,-6372.93 26688,-6368.17 26635.3,-6314.32 24235.46,-6304.67 23758.8,-6303.29"/>
<polygon fill="black" stroke="black" points="23758.58,-6299.79 23748.57,-6303.26 23758.56,-6306.79 23758.58,-6299.79"/>
<text text-anchor="middle" x="26736.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l2_gate_gpu7&#45;&gt;l2_expert4_gpu4 -->
<g id="edge997" class="edge">
<title>l2_gate_gpu7&#45;&gt;l2_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M22936.26,-6437.26C23476.04,-6434.44 26556.78,-6416.87 26590,-6383.17 26594.68,-6378.42 26594.7,-6372.89 26590,-6368.17 26575.35,-6353.42 23617.78,-6350.56 23597,-6350.17 23070.16,-6340.11 22437.04,-6315.49 22214.85,-6306.47"/>
<polygon fill="black" stroke="black" points="22214.72,-6302.96 22204.58,-6306.05 22214.43,-6309.95 22214.72,-6302.96"/>
<text text-anchor="middle" x="26638.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l2_gate_gpu7&#45;&gt;l2_expert5_gpu5 -->
<g id="edge998" class="edge">
<title>l2_gate_gpu7&#45;&gt;l2_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M22776.09,-6435.23C22553.85,-6428.55 21909.58,-6409.88 21374,-6401.17 21310.76,-6400.14 19156.67,-6404.15 19097,-6383.17 19086.85,-6379.6 19088.1,-6371.87 19078,-6368.17 19024.56,-6348.55 18622.82,-6353.53 18566,-6350.17 18392.99,-6339.93 18190.75,-6321.56 18080.96,-6311.04"/>
<polygon fill="black" stroke="black" points="18081.25,-6307.55 18070.96,-6310.08 18080.58,-6314.52 18081.25,-6307.55"/>
<text text-anchor="middle" x="19142.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l2_gate_gpu7&#45;&gt;l2_expert6_gpu6 -->
<g id="edge999" class="edge">
<title>l2_gate_gpu7&#45;&gt;l2_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M22830.63,-6402.72C22818.75,-6389.28 22803.38,-6375.42 22786,-6368.17 22736.22,-6347.38 20897.93,-6351.63 20844,-6350.17 20483.08,-6340.4 20052.75,-6317.56 19876.43,-6307.73"/>
<polygon fill="black" stroke="black" points="19876.38,-6304.22 19866.2,-6307.15 19875.99,-6311.21 19876.38,-6304.22"/>
<text text-anchor="middle" x="22853.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l2_gate_gpu7&#45;&gt;l2_expert7_gpu7 -->
<g id="edge1000" class="edge">
<title>l2_gate_gpu7&#45;&gt;l2_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M22935.93,-6436.8C23285.64,-6432.84 24664.9,-6415.2 24696,-6383.17 24700.64,-6378.38 24700.7,-6372.9 24696,-6368.17 24683.07,-6355.14 22071.35,-6350.61 22053,-6350.17 21660.34,-6340.64 21191.3,-6317.22 21005.53,-6307.46"/>
<polygon fill="black" stroke="black" points="21005.47,-6303.95 20995.3,-6306.92 21005.1,-6310.94 21005.47,-6303.95"/>
<text text-anchor="middle" x="24744.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l2_gate_gpu8&#45;&gt;l2_expert0_gpu0 -->
<g id="edge1018" class="edge">
<title>l2_gate_gpu8&#45;&gt;l2_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M18712.93,-6437.42C17941.13,-6435.06 11848.96,-6415.38 11817,-6383.17 11812.3,-6378.43 11812.32,-6372.91 11817,-6368.17 11857.91,-6326.67 15683.09,-6306.44 16294.11,-6303.47"/>
<polygon fill="black" stroke="black" points="16294.17,-6306.97 16304.16,-6303.42 16294.14,-6299.97 16294.17,-6306.97"/>
<text text-anchor="middle" x="11862.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l2_gate_gpu8&#45;&gt;l2_expert1_gpu1 -->
<g id="edge1019" class="edge">
<title>l2_gate_gpu8&#45;&gt;l2_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M18712.79,-6437.7C18414.66,-6437.46 17385,-6432.99 17337,-6383.17 17332.37,-6378.36 17332.34,-6372.94 17337,-6368.17 17351.42,-6353.39 18059.38,-6351.27 18080,-6350.17 18253.6,-6340.86 18456.51,-6322.1 18566.36,-6311.28"/>
<polygon fill="black" stroke="black" points="18566.77,-6314.75 18576.38,-6310.29 18566.08,-6307.79 18566.77,-6314.75"/>
<text text-anchor="middle" x="17382.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l2_gate_gpu8&#45;&gt;l2_expert2_gpu2 -->
<g id="edge1020" class="edge">
<title>l2_gate_gpu8&#45;&gt;l2_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M18712.95,-6437.6C18059.72,-6436.95 13628.17,-6430.83 13581,-6383.17 13576.31,-6378.43 13576.3,-6372.89 13581,-6368.17 13595.07,-6354 16436.04,-6350.73 16456,-6350.17 16773.32,-6341.22 17150.43,-6318.69 17313.36,-6308.38"/>
<polygon fill="black" stroke="black" points="17314.02,-6311.85 17323.77,-6307.72 17313.57,-6304.86 17314.02,-6311.85"/>
<text text-anchor="middle" x="13626.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l2_gate_gpu8&#45;&gt;l2_expert3_gpu3 -->
<g id="edge1021" class="edge">
<title>l2_gate_gpu8&#45;&gt;l2_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M18848,-6411.29C18859.02,-6407.1 18870.7,-6403.41 18882,-6401.17 18922.27,-6393.17 24765.01,-6412.24 24794,-6383.17 24867.82,-6309.12 24028.92,-6302.97 23759.04,-6302.89"/>
<polygon fill="black" stroke="black" points="23758.92,-6299.39 23748.92,-6302.89 23758.92,-6306.39 23758.92,-6299.39"/>
<text text-anchor="middle" x="24843.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l2_gate_gpu8&#45;&gt;l2_expert4_gpu4 -->
<g id="edge1022" class="edge">
<title>l2_gate_gpu8&#45;&gt;l2_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M18848,-6411.3C18859.02,-6407.11 18870.7,-6403.42 18882,-6401.17 18909.38,-6395.7 22883.3,-6402.95 22903,-6383.17 22907.7,-6378.44 22907.51,-6373.07 22903,-6368.17 22857.12,-6318.24 22403.54,-6306.58 22214.77,-6303.88"/>
<polygon fill="black" stroke="black" points="22214.67,-6300.38 22204.63,-6303.74 22214.58,-6307.38 22214.67,-6300.38"/>
<text text-anchor="middle" x="22951.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l2_gate_gpu8&#45;&gt;l2_expert5_gpu5 -->
<g id="edge1023" class="edge">
<title>l2_gate_gpu8&#45;&gt;l2_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M18712.95,-6437.89C18211.12,-6439.14 15517.9,-6443.04 15459,-6383.17 15454.32,-6378.41 15454.31,-6372.9 15459,-6368.17 15478.71,-6348.28 17447.03,-6351.54 17475,-6350.17 17632.89,-6342.39 17816.75,-6323.67 17919.64,-6312.32"/>
<polygon fill="black" stroke="black" points="17920.09,-6315.79 17929.64,-6311.21 17919.32,-6308.83 17920.09,-6315.79"/>
<text text-anchor="middle" x="15504.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l2_gate_gpu8&#45;&gt;l2_expert6_gpu6 -->
<g id="edge1024" class="edge">
<title>l2_gate_gpu8&#45;&gt;l2_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M18848.58,-6411.6C18859.46,-6407.44 18870.93,-6403.68 18882,-6401.17 18949.29,-6385.86 19127.5,-6407.68 19192,-6383.17 19202.06,-6379.34 19201.05,-6372.25 19211,-6368.17 19300.02,-6331.61 19574.99,-6313.59 19713.5,-6306.64"/>
<polygon fill="black" stroke="black" points="19713.82,-6310.12 19723.63,-6306.13 19713.47,-6303.13 19713.82,-6310.12"/>
<text text-anchor="middle" x="19256.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l2_gate_gpu8&#45;&gt;l2_expert7_gpu7 -->
<g id="edge1025" class="edge">
<title>l2_gate_gpu8&#45;&gt;l2_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M18848.01,-6411.33C18859.03,-6407.14 18870.7,-6403.44 18882,-6401.17 18911.79,-6395.17 21048.6,-6404.74 21070,-6383.17 21098.96,-6353.96 21050.65,-6332.49 21002,-6319.17"/>
<polygon fill="black" stroke="black" points="21002.85,-6315.77 20992.29,-6316.61 21001.07,-6322.54 21002.85,-6315.77"/>
<text text-anchor="middle" x="21122.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l2_gate_gpu9&#45;&gt;l2_expert0_gpu0 -->
<g id="edge1027" class="edge">
<title>l2_gate_gpu9&#45;&gt;l2_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M21230,-6411.28C21218.98,-6407.09 21207.3,-6403.41 21196,-6401.17 21169.73,-6395.96 13501.92,-6402.12 13483,-6383.17 13478.29,-6378.45 13478.34,-6372.93 13483,-6368.17 13533.49,-6316.53 15828.38,-6305.14 16294.08,-6303.36"/>
<polygon fill="black" stroke="black" points="16294.42,-6306.86 16304.41,-6303.32 16294.4,-6299.86 16294.42,-6306.86"/>
<text text-anchor="middle" x="13528.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l2_gate_gpu9&#45;&gt;l2_expert1_gpu1 -->
<g id="edge1028" class="edge">
<title>l2_gate_gpu9&#45;&gt;l2_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M21229.99,-6411.33C21218.97,-6407.14 21207.3,-6403.44 21196,-6401.17 21075.69,-6376.94 19104.5,-6418.62 18987,-6383.17 18975.32,-6379.64 18975.29,-6372.81 18964,-6368.17 18887.31,-6336.62 18793.67,-6319.82 18728.12,-6311.24"/>
<polygon fill="black" stroke="black" points="18728.21,-6307.72 18717.85,-6309.93 18727.33,-6314.67 18728.21,-6307.72"/>
<text text-anchor="middle" x="19032.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l2_gate_gpu9&#45;&gt;l2_expert2_gpu2 -->
<g id="edge1029" class="edge">
<title>l2_gate_gpu9&#45;&gt;l2_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M21230,-6411.29C21218.98,-6407.1 21207.3,-6403.41 21196,-6401.17 21155.37,-6393.09 15260.25,-6412.5 15231,-6383.17 15226.29,-6378.44 15226.32,-6372.91 15231,-6368.17 15242.94,-6356.05 16438.99,-6350.72 16456,-6350.17 16773.27,-6339.88 17150.41,-6318.05 17313.35,-6308.15"/>
<polygon fill="black" stroke="black" points="17314,-6311.62 17323.77,-6307.52 17313.57,-6304.63 17314,-6311.62"/>
<text text-anchor="middle" x="15276.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l2_gate_gpu9&#45;&gt;l2_expert3_gpu3 -->
<g id="edge1030" class="edge">
<title>l2_gate_gpu9&#45;&gt;l2_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M21364.91,-6435.14C21587.15,-6428.24 22231.41,-6409.06 22767,-6401.17 22792.75,-6400.79 26457.83,-6401.42 26476,-6383.17 26480.7,-6378.44 26480.66,-6372.93 26476,-6368.17 26427.26,-6318.28 24215.21,-6305.53 23758.83,-6303.43"/>
<polygon fill="black" stroke="black" points="23758.72,-6299.92 23748.7,-6303.38 23758.68,-6306.92 23758.72,-6299.92"/>
<text text-anchor="middle" x="26524.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l2_gate_gpu9&#45;&gt;l2_expert4_gpu4 -->
<g id="edge1031" class="edge">
<title>l2_gate_gpu9&#45;&gt;l2_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M21364.91,-6435.28C21587.16,-6428.74 22231.43,-6410.39 22767,-6401.17 22792.43,-6400.73 24580.11,-6401.24 24598,-6383.17 24602.69,-6378.43 24602.67,-6372.92 24598,-6368.17 24578.51,-6348.32 23624.8,-6350.86 23597,-6350.17 23070.23,-6336.96 22437.06,-6314.29 22214.86,-6306.12"/>
<polygon fill="black" stroke="black" points="22214.71,-6302.61 22204.59,-6305.74 22214.45,-6309.61 22214.71,-6302.61"/>
<text text-anchor="middle" x="24646.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l2_gate_gpu9&#45;&gt;l2_expert5_gpu5 -->
<g id="edge1032" class="edge">
<title>l2_gate_gpu9&#45;&gt;l2_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M21230,-6411.3C21218.98,-6407.11 21207.3,-6403.42 21196,-6401.17 21168.17,-6395.62 17129.03,-6403.28 17109,-6383.17 17104.3,-6378.44 17104.4,-6372.99 17109,-6368.17 17123.04,-6353.42 17454.69,-6351.58 17475,-6350.17 17632.48,-6339.24 17816.12,-6321.66 17919.15,-6311.35"/>
<polygon fill="black" stroke="black" points="17919.57,-6314.83 17929.17,-6310.35 17918.87,-6307.86 17919.57,-6314.83"/>
<text text-anchor="middle" x="17154.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l2_gate_gpu9&#45;&gt;l2_expert6_gpu6 -->
<g id="edge1033" class="edge">
<title>l2_gate_gpu9&#45;&gt;l2_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M21229.43,-6411.56C21218.55,-6407.41 21207.08,-6403.66 21196,-6401.17 21052.28,-6368.76 21005.03,-6428.97 20865,-6383.17 20853.4,-6379.37 20853.58,-6372 20842,-6368.17 20663.4,-6308.98 20091.08,-6302.94 19876.91,-6302.81"/>
<polygon fill="black" stroke="black" points="19876.68,-6299.31 19866.68,-6302.8 19876.68,-6306.31 19876.68,-6299.31"/>
<text text-anchor="middle" x="20910.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l2_gate_gpu9&#45;&gt;l2_expert7_gpu7 -->
<g id="edge1034" class="edge">
<title>l2_gate_gpu9&#45;&gt;l2_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M21365.02,-6437.59C21655.8,-6436.91 22641.92,-6431.07 22688,-6383.17 22692.62,-6378.36 22692.65,-6372.95 22688,-6368.17 22675.7,-6355.51 22070.64,-6350.78 22053,-6350.17 21660.46,-6336.42 21191.36,-6315.37 21005.55,-6306.86"/>
<polygon fill="black" stroke="black" points="21005.47,-6303.35 20995.32,-6306.39 21005.15,-6310.34 21005.47,-6303.35"/>
<text text-anchor="middle" x="22736.5" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l2_gate_gpu10&#45;&gt;l2_expert0_gpu0 -->
<g id="edge1036" class="edge">
<title>l2_gate_gpu10&#45;&gt;l2_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19094,-6411.28C19082.98,-6407.09 19071.3,-6403.41 19060,-6401.17 19036.11,-6396.42 12062.2,-6400.41 12045,-6383.17 12040.29,-6378.45 12040.32,-6372.91 12045,-6368.17 12083.75,-6328.83 15700.64,-6306.87 16294.06,-6303.53"/>
<polygon fill="black" stroke="black" points="16294.25,-6307.03 16304.23,-6303.47 16294.21,-6300.03 16294.25,-6307.03"/>
<text text-anchor="middle" x="12095" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l2_gate_gpu10&#45;&gt;l2_expert1_gpu1 -->
<g id="edge1037" class="edge">
<title>l2_gate_gpu10&#45;&gt;l2_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19093.99,-6411.37C19082.96,-6407.17 19071.29,-6403.46 19060,-6401.17 19019.3,-6392.89 17594.19,-6412.71 17565,-6383.17 17560.31,-6378.42 17560.37,-6372.96 17565,-6368.17 17584.89,-6347.57 18051.42,-6351.85 18080,-6350.17 18253.55,-6339.93 18456.47,-6321.52 18566.35,-6311"/>
<polygon fill="black" stroke="black" points="18566.74,-6314.48 18576.36,-6310.04 18566.07,-6307.51 18566.74,-6314.48"/>
<text text-anchor="middle" x="17615" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l2_gate_gpu10&#45;&gt;l2_expert2_gpu2 -->
<g id="edge1038" class="edge">
<title>l2_gate_gpu10&#45;&gt;l2_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19094,-6411.29C19082.98,-6407.1 19071.3,-6403.41 19060,-6401.17 19024.23,-6394.05 13834.74,-6408.99 13809,-6383.17 13804.29,-6378.44 13804.3,-6372.9 13809,-6368.17 13821.95,-6355.12 16437.63,-6350.69 16456,-6350.17 16773.31,-6341.14 17150.43,-6318.65 17313.36,-6308.37"/>
<polygon fill="black" stroke="black" points="17314.02,-6311.83 17323.77,-6307.71 17313.57,-6304.85 17314.02,-6311.83"/>
<text text-anchor="middle" x="13859" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l2_gate_gpu10&#45;&gt;l2_expert3_gpu3 -->
<g id="edge1039" class="edge">
<title>l2_gate_gpu10&#45;&gt;l2_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19204,-6411.29C19215.02,-6407.1 19226.7,-6403.41 19238,-6401.17 19277.61,-6393.29 25025.48,-6411.77 25054,-6383.17 25058.71,-6378.44 25058.6,-6372.99 25054,-6368.17 25009.13,-6321.13 24048.31,-6307.05 23758.82,-6303.87"/>
<polygon fill="black" stroke="black" points="23758.85,-6300.37 23748.81,-6303.76 23758.77,-6307.37 23758.85,-6300.37"/>
<text text-anchor="middle" x="25107" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l2_gate_gpu10&#45;&gt;l2_expert4_gpu4 -->
<g id="edge1040" class="edge">
<title>l2_gate_gpu10&#45;&gt;l2_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19204,-6411.3C19215.02,-6407.11 19226.7,-6403.42 19238,-6401.17 19264.82,-6395.82 23156.71,-6402.55 23176,-6383.17 23244.43,-6314.42 22472.22,-6304.64 22214.82,-6303.29"/>
<polygon fill="black" stroke="black" points="22214.8,-6299.79 22204.78,-6303.24 22214.77,-6306.79 22214.8,-6299.79"/>
<text text-anchor="middle" x="23230" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l2_gate_gpu10&#45;&gt;l2_expert5_gpu5 -->
<g id="edge1041" class="edge">
<title>l2_gate_gpu10&#45;&gt;l2_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19094,-6411.31C19082.97,-6407.12 19071.3,-6403.42 19060,-6401.17 19037.03,-6396.57 15703.52,-6399.77 15687,-6383.17 15682.3,-6378.44 15682.31,-6372.9 15687,-6368.17 15704.47,-6350.52 17450.2,-6351.4 17475,-6350.17 17632.89,-6342.3 17816.75,-6323.61 17919.64,-6312.29"/>
<polygon fill="black" stroke="black" points="17920.09,-6315.76 17929.64,-6311.18 17919.32,-6308.8 17920.09,-6315.76"/>
<text text-anchor="middle" x="15737" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l2_gate_gpu10&#45;&gt;l2_expert6_gpu6 -->
<g id="edge1042" class="edge">
<title>l2_gate_gpu10&#45;&gt;l2_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19205.15,-6411.78C19215.87,-6407.66 19227.14,-6403.87 19238,-6401.17 19316.88,-6381.54 19344.62,-6413.57 19420,-6383.17 19429.98,-6379.14 19429.2,-6372.6 19439,-6368.17 19527.45,-6328.18 19638.78,-6312.76 19713.18,-6306.81"/>
<polygon fill="black" stroke="black" points="19713.72,-6310.28 19723.43,-6306.03 19713.19,-6303.3 19713.72,-6310.28"/>
<text text-anchor="middle" x="19489" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l2_gate_gpu10&#45;&gt;l2_expert7_gpu7 -->
<g id="edge1043" class="edge">
<title>l2_gate_gpu10&#45;&gt;l2_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19204.01,-6411.34C19215.03,-6407.14 19226.7,-6403.44 19238,-6401.17 19266.05,-6395.51 21277.86,-6403.49 21298,-6383.17 21341.14,-6339.65 21127.69,-6317.25 21005.2,-6308.14"/>
<polygon fill="black" stroke="black" points="21005.32,-6304.64 20995.09,-6307.41 21004.81,-6311.63 21005.32,-6304.64"/>
<text text-anchor="middle" x="21353" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l2_gate_gpu11&#45;&gt;l2_expert0_gpu0 -->
<g id="edge1045" class="edge">
<title>l2_gate_gpu11&#45;&gt;l2_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20162,-6411.28C20150.98,-6407.09 20139.3,-6403.41 20128,-6401.17 20102.89,-6396.19 12774.08,-6401.29 12756,-6383.17 12751.29,-6378.45 12751.33,-6372.92 12756,-6368.17 12820.09,-6302.91 15761.98,-6302.52 16293.98,-6302.98"/>
<polygon fill="black" stroke="black" points="16294.25,-6306.48 16304.25,-6302.99 16294.26,-6299.48 16294.25,-6306.48"/>
<text text-anchor="middle" x="12806" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l2_gate_gpu11&#45;&gt;l2_expert1_gpu1 -->
<g id="edge1046" class="edge">
<title>l2_gate_gpu11&#45;&gt;l2_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20161.99,-6411.35C20150.97,-6407.15 20139.29,-6403.45 20128,-6401.17 20102.79,-6396.07 18294.1,-6401.44 18276,-6383.17 18233.33,-6340.07 18443.84,-6317.55 18565.49,-6308.29"/>
<polygon fill="black" stroke="black" points="18565.82,-6311.78 18575.54,-6307.54 18565.3,-6304.79 18565.82,-6311.78"/>
<text text-anchor="middle" x="18326" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l2_gate_gpu11&#45;&gt;l2_expert2_gpu2 -->
<g id="edge1047" class="edge">
<title>l2_gate_gpu11&#45;&gt;l2_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20162,-6411.29C20150.98,-6407.1 20139.3,-6403.41 20128,-6401.17 20089.8,-6393.57 14547.49,-6410.75 14520,-6383.17 14515.29,-6378.44 14515.31,-6372.9 14520,-6368.17 14538.93,-6349.06 16429.12,-6350.96 16456,-6350.17 16773.3,-6340.74 17150.42,-6318.46 17313.35,-6308.3"/>
<polygon fill="black" stroke="black" points="17314.01,-6311.77 17323.77,-6307.65 17313.57,-6304.78 17314.01,-6311.77"/>
<text text-anchor="middle" x="14570" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l2_gate_gpu11&#45;&gt;l2_expert3_gpu3 -->
<g id="edge1048" class="edge">
<title>l2_gate_gpu11&#45;&gt;l2_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20272,-6411.29C20283.02,-6407.1 20294.7,-6403.41 20306,-6401.17 20343.18,-6393.77 25738.24,-6410.02 25765,-6383.17 25769.71,-6378.44 25769.64,-6372.95 25765,-6368.17 25729.47,-6331.51 24140.69,-6308.98 23758.87,-6304.09"/>
<polygon fill="black" stroke="black" points="23758.78,-6300.59 23748.73,-6303.96 23758.69,-6307.59 23758.78,-6300.59"/>
<text text-anchor="middle" x="25818" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l2_gate_gpu11&#45;&gt;l2_expert4_gpu4 -->
<g id="edge1049" class="edge">
<title>l2_gate_gpu11&#45;&gt;l2_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20272,-6411.3C20283.03,-6407.11 20294.7,-6403.42 20306,-6401.17 20330.39,-6396.3 23869.46,-6400.79 23887,-6383.17 23891.7,-6378.44 23891.63,-6372.97 23887,-6368.17 23872.3,-6352.91 22558.17,-6315.01 22214.49,-6305.35"/>
<polygon fill="black" stroke="black" points="22214.46,-6301.85 22204.37,-6305.07 22214.26,-6308.85 22214.46,-6301.85"/>
<text text-anchor="middle" x="23940" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l2_gate_gpu11&#45;&gt;l2_expert5_gpu5 -->
<g id="edge1050" class="edge">
<title>l2_gate_gpu11&#45;&gt;l2_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20162,-6411.3C20150.97,-6407.11 20139.3,-6403.42 20128,-6401.17 20102.6,-6396.1 16416.27,-6401.53 16398,-6383.17 16393.3,-6378.44 16393.33,-6372.92 16398,-6368.17 16418.98,-6346.83 17445.12,-6351.75 17475,-6350.17 17632.86,-6341.78 17816.73,-6323.27 17919.63,-6312.12"/>
<polygon fill="black" stroke="black" points="17920.07,-6315.59 17929.63,-6311.03 17919.31,-6308.63 17920.07,-6315.59"/>
<text text-anchor="middle" x="16448" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l2_gate_gpu11&#45;&gt;l2_expert6_gpu6 -->
<g id="edge1051" class="edge">
<title>l2_gate_gpu11&#45;&gt;l2_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20176.15,-6406.29C20156.73,-6392.75 20132.63,-6377.83 20109,-6368.17 20033.18,-6337.17 19940.8,-6320.3 19875.93,-6311.57"/>
<polygon fill="black" stroke="black" points="19876.13,-6308.06 19865.76,-6310.23 19875.22,-6315 19876.13,-6308.06"/>
<text text-anchor="middle" x="20187" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l2_gate_gpu11&#45;&gt;l2_expert7_gpu7 -->
<g id="edge1052" class="edge">
<title>l2_gate_gpu11&#45;&gt;l2_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20272.01,-6411.35C20283.03,-6407.16 20294.71,-6403.45 20306,-6401.17 20329.18,-6396.47 21992.36,-6399.98 22009,-6383.17 22080.24,-6311.16 21270.29,-6303.6 21005.88,-6303.04"/>
<polygon fill="black" stroke="black" points="21005.58,-6299.54 20995.58,-6303.02 21005.57,-6306.54 21005.58,-6299.54"/>
<text text-anchor="middle" x="22063" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l2_gate_gpu12&#45;&gt;l2_expert0_gpu0 -->
<g id="edge1054" class="edge">
<title>l2_gate_gpu12&#45;&gt;l2_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19272,-6411.28C19260.98,-6407.09 19249.3,-6403.41 19238,-6401.17 19213.92,-6396.39 12185.34,-6400.55 12168,-6383.17 12163.29,-6378.45 12163.32,-6372.92 12168,-6368.17 12205.6,-6329.98 15710.53,-6307.11 16294.08,-6303.57"/>
<polygon fill="black" stroke="black" points="16294.12,-6307.07 16304.09,-6303.51 16294.07,-6300.07 16294.12,-6307.07"/>
<text text-anchor="middle" x="12218" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l2_gate_gpu12&#45;&gt;l2_expert1_gpu1 -->
<g id="edge1055" class="edge">
<title>l2_gate_gpu12&#45;&gt;l2_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19271.99,-6411.36C19260.96,-6407.17 19249.29,-6403.46 19238,-6401.17 19195.8,-6392.59 17718.27,-6413.79 17688,-6383.17 17683.31,-6378.42 17683.4,-6372.99 17688,-6368.17 17703.06,-6352.4 18058.24,-6351.57 18080,-6350.17 18253.49,-6338.98 18456.44,-6320.92 18566.33,-6310.73"/>
<polygon fill="black" stroke="black" points="18566.71,-6314.21 18576.35,-6309.79 18566.06,-6307.24 18566.71,-6314.21"/>
<text text-anchor="middle" x="17738" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l2_gate_gpu12&#45;&gt;l2_expert2_gpu2 -->
<g id="edge1056" class="edge">
<title>l2_gate_gpu12&#45;&gt;l2_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19272,-6411.29C19260.98,-6407.1 19249.3,-6403.41 19238,-6401.17 19201.86,-6393.98 13958.01,-6409.26 13932,-6383.17 13927.29,-6378.44 13927.3,-6372.9 13932,-6368.17 13944.35,-6355.73 16438.48,-6350.67 16456,-6350.17 16773.31,-6341.08 17150.43,-6318.63 17313.36,-6308.36"/>
<polygon fill="black" stroke="black" points="17314.01,-6311.82 17323.77,-6307.7 17313.57,-6304.84 17314.01,-6311.82"/>
<text text-anchor="middle" x="13982" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l2_gate_gpu12&#45;&gt;l2_expert3_gpu3 -->
<g id="edge1057" class="edge">
<title>l2_gate_gpu12&#45;&gt;l2_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19382,-6411.29C19393.02,-6407.1 19404.7,-6403.41 19416,-6401.17 19455.24,-6393.37 25148.75,-6411.5 25177,-6383.17 25181.71,-6378.44 25181.61,-6372.98 25177,-6368.17 25127.65,-6316.62 24064.87,-6305.64 23758.8,-6303.54"/>
<polygon fill="black" stroke="black" points="23758.69,-6300.04 23748.67,-6303.47 23758.64,-6307.04 23758.69,-6300.04"/>
<text text-anchor="middle" x="25230" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l2_gate_gpu12&#45;&gt;l2_expert4_gpu4 -->
<g id="edge1058" class="edge">
<title>l2_gate_gpu12&#45;&gt;l2_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19382,-6411.3C19393.03,-6407.11 19404.7,-6403.42 19416,-6401.17 19442.44,-6395.89 23279.98,-6402.28 23299,-6383.17 23376.33,-6305.48 22492.41,-6301.88 22214.86,-6302.65"/>
<polygon fill="black" stroke="black" points="22214.84,-6299.15 22204.85,-6302.68 22214.86,-6306.15 22214.84,-6299.15"/>
<text text-anchor="middle" x="23353" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l2_gate_gpu12&#45;&gt;l2_expert5_gpu5 -->
<g id="edge1059" class="edge">
<title>l2_gate_gpu12&#45;&gt;l2_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19272,-6411.31C19260.97,-6407.12 19249.3,-6403.42 19238,-6401.17 19214.66,-6396.5 15826.79,-6400.04 15810,-6383.17 15805.3,-6378.44 15805.31,-6372.91 15810,-6368.17 15826.26,-6351.72 17451.9,-6351.32 17475,-6350.17 17632.89,-6342.24 17816.75,-6323.57 17919.64,-6312.27"/>
<polygon fill="black" stroke="black" points="17920.09,-6315.74 17929.64,-6311.16 17919.32,-6308.78 17920.09,-6315.74"/>
<text text-anchor="middle" x="15860" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l2_gate_gpu12&#45;&gt;l2_expert6_gpu6 -->
<g id="edge1060" class="edge">
<title>l2_gate_gpu12&#45;&gt;l2_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19383.72,-6411.96C19394.29,-6407.88 19405.36,-6404.05 19416,-6401.17 19471.02,-6386.23 19490.59,-6405.6 19543,-6383.17 19552.89,-6378.93 19552.41,-6373.04 19562,-6368.17 19610.4,-6343.56 19669.32,-6327.21 19715.81,-6317.05"/>
<polygon fill="black" stroke="black" points="19716.78,-6320.42 19725.83,-6314.91 19715.32,-6313.58 19716.78,-6320.42"/>
<text text-anchor="middle" x="19612" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l2_gate_gpu12&#45;&gt;l2_expert7_gpu7 -->
<g id="edge1061" class="edge">
<title>l2_gate_gpu12&#45;&gt;l2_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19382.01,-6411.34C19393.03,-6407.15 19404.7,-6403.44 19416,-6401.17 19443.3,-6395.66 21401.4,-6402.95 21421,-6383.17 21480.97,-6322.65 21161.32,-6307.86 21005.5,-6304.25"/>
<polygon fill="black" stroke="black" points="21005.55,-6300.75 20995.48,-6304.03 21005.4,-6307.75 21005.55,-6300.75"/>
<text text-anchor="middle" x="21478" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l2_gate_gpu13&#45;&gt;l2_expert0_gpu0 -->
<g id="edge1063" class="edge">
<title>l2_gate_gpu13&#45;&gt;l2_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20340,-6411.28C20328.98,-6407.09 20317.3,-6403.41 20306,-6401.17 20280.7,-6396.15 12897.21,-6401.42 12879,-6383.17 12874.29,-6378.45 12874.33,-6372.92 12879,-6368.17 12940.8,-6305.21 15773.75,-6302.92 16294.28,-6303.04"/>
<polygon fill="black" stroke="black" points="16294.34,-6306.53 16304.34,-6303.04 16294.34,-6299.53 16294.34,-6306.53"/>
<text text-anchor="middle" x="12929" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l2_gate_gpu13&#45;&gt;l2_expert1_gpu1 -->
<g id="edge1064" class="edge">
<title>l2_gate_gpu13&#45;&gt;l2_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20339.99,-6411.34C20328.97,-6407.15 20317.3,-6403.45 20306,-6401.17 20280.04,-6395.92 18417.64,-6401.98 18399,-6383.17 18344.52,-6328.17 18473.63,-6310.92 18565.26,-6305.52"/>
<polygon fill="black" stroke="black" points="18565.61,-6309.01 18575.4,-6304.96 18565.22,-6302.02 18565.61,-6309.01"/>
<text text-anchor="middle" x="18449" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l2_gate_gpu13&#45;&gt;l2_expert2_gpu2 -->
<g id="edge1065" class="edge">
<title>l2_gate_gpu13&#45;&gt;l2_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20340,-6411.29C20328.98,-6407.1 20317.3,-6403.41 20306,-6401.17 20267.43,-6393.5 14670.76,-6411.02 14643,-6383.17 14638.29,-6378.44 14638.31,-6372.9 14643,-6368.17 14660.72,-6350.27 16430.83,-6350.92 16456,-6350.17 16773.3,-6340.64 17150.42,-6318.41 17313.35,-6308.28"/>
<polygon fill="black" stroke="black" points="17314.01,-6311.75 17323.77,-6307.63 17313.57,-6304.76 17314.01,-6311.75"/>
<text text-anchor="middle" x="14693" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l2_gate_gpu13&#45;&gt;l2_expert3_gpu3 -->
<g id="edge1066" class="edge">
<title>l2_gate_gpu13&#45;&gt;l2_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20450,-6411.29C20461.02,-6407.1 20472.7,-6403.41 20484,-6401.17 20520.81,-6393.85 25861.51,-6409.75 25888,-6383.17 25892.71,-6378.44 25892.64,-6372.95 25888,-6368.17 25850.19,-6329.23 24154.18,-6308.3 23758.79,-6303.94"/>
<polygon fill="black" stroke="black" points="23758.62,-6300.44 23748.58,-6303.83 23758.54,-6307.44 23758.62,-6300.44"/>
<text text-anchor="middle" x="25941" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l2_gate_gpu13&#45;&gt;l2_expert4_gpu4 -->
<g id="edge1067" class="edge">
<title>l2_gate_gpu13&#45;&gt;l2_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20450,-6411.3C20461.03,-6407.11 20472.7,-6403.42 20484,-6401.17 20508.01,-6396.37 23992.73,-6400.52 24010,-6383.17 24014.7,-6378.44 24014.63,-6372.96 24010,-6368.17 24006.04,-6364.07 22574.67,-6317.4 22214.5,-6305.72"/>
<polygon fill="black" stroke="black" points="22214.52,-6302.22 22204.41,-6305.39 22214.29,-6309.22 22214.52,-6302.22"/>
<text text-anchor="middle" x="24063" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l2_gate_gpu13&#45;&gt;l2_expert5_gpu5 -->
<g id="edge1068" class="edge">
<title>l2_gate_gpu13&#45;&gt;l2_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20340,-6411.3C20328.97,-6407.11 20317.3,-6403.42 20306,-6401.17 20280.22,-6396.02 16539.54,-6401.8 16521,-6383.17 16516.3,-6378.44 16516.33,-6372.92 16521,-6368.17 16539.56,-6349.25 17448.53,-6351.6 17475,-6350.17 17632.85,-6341.61 17816.73,-6323.16 17919.63,-6312.07"/>
<polygon fill="black" stroke="black" points="17920.07,-6315.54 17929.63,-6310.98 17919.31,-6308.58 17920.07,-6315.54"/>
<text text-anchor="middle" x="16571" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l2_gate_gpu13&#45;&gt;l2_expert6_gpu6 -->
<g id="edge1069" class="edge">
<title>l2_gate_gpu13&#45;&gt;l2_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20339.42,-6411.67C20299.59,-6393.2 20251.24,-6371.16 20241,-6368.17 20116.79,-6331.85 19966.94,-6315.3 19876.41,-6308.12"/>
<polygon fill="black" stroke="black" points="19876.45,-6304.62 19866.21,-6307.34 19875.91,-6311.6 19876.45,-6304.62"/>
<text text-anchor="middle" x="20324" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l2_gate_gpu13&#45;&gt;l2_expert7_gpu7 -->
<g id="edge1070" class="edge">
<title>l2_gate_gpu13&#45;&gt;l2_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20450.01,-6411.36C20461.04,-6407.16 20472.71,-6403.46 20484,-6401.17 20528.87,-6392.07 22099.81,-6415.71 22132,-6383.17 22136.69,-6378.43 22136.59,-6373 22132,-6368.17 22112.59,-6347.68 21273.85,-6315.7 21005.59,-6305.98"/>
<polygon fill="black" stroke="black" points="21005.65,-6302.48 20995.53,-6305.62 21005.4,-6309.48 21005.65,-6302.48"/>
<text text-anchor="middle" x="22185" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l2_gate_gpu14&#45;&gt;l2_expert0_gpu0 -->
<g id="edge1072" class="edge">
<title>l2_gate_gpu14&#45;&gt;l2_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19628,-6411.28C19616.98,-6407.09 19605.3,-6403.41 19594,-6401.17 19569.52,-6396.31 12422.63,-6400.84 12405,-6383.17 12400.29,-6378.45 12400.32,-6372.92 12405,-6368.17 12475.7,-6296.3 15733.25,-6301.43 16294.18,-6302.85"/>
<polygon fill="black" stroke="black" points="16294.2,-6306.35 16304.21,-6302.87 16294.22,-6299.35 16294.2,-6306.35"/>
<text text-anchor="middle" x="12455" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l2_gate_gpu14&#45;&gt;l2_expert1_gpu1 -->
<g id="edge1073" class="edge">
<title>l2_gate_gpu14&#45;&gt;l2_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19627.99,-6411.36C19616.96,-6407.16 19605.29,-6403.45 19594,-6401.17 19571.28,-6396.56 17941.3,-6399.65 17925,-6383.17 17920.31,-6378.43 17920.5,-6373.09 17925,-6368.17 17930.37,-6362.29 18378.57,-6325.02 18566.01,-6309.67"/>
<polygon fill="black" stroke="black" points="18566.41,-6313.15 18576.09,-6308.85 18565.84,-6306.18 18566.41,-6313.15"/>
<text text-anchor="middle" x="17975" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l2_gate_gpu14&#45;&gt;l2_expert2_gpu2 -->
<g id="edge1074" class="edge">
<title>l2_gate_gpu14&#45;&gt;l2_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19628,-6411.29C19616.98,-6407.1 19605.3,-6403.41 19594,-6401.17 19557.05,-6393.82 14195.6,-6409.85 14169,-6383.17 14164.29,-6378.44 14164.3,-6372.9 14169,-6368.17 14191.37,-6345.62 16424.25,-6351.09 16456,-6350.17 16773.31,-6340.97 17150.43,-6318.57 17313.35,-6308.34"/>
<polygon fill="black" stroke="black" points="17314.01,-6311.8 17323.77,-6307.68 17313.57,-6304.82 17314.01,-6311.8"/>
<text text-anchor="middle" x="14219" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l2_gate_gpu14&#45;&gt;l2_expert3_gpu3 -->
<g id="edge1075" class="edge">
<title>l2_gate_gpu14&#45;&gt;l2_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19738,-6411.29C19749.02,-6407.1 19760.7,-6403.41 19772,-6401.17 19810.43,-6393.53 25386.34,-6410.91 25414,-6383.17 25418.71,-6378.44 25418.62,-6372.97 25414,-6368.17 25355.97,-6307.92 24094.99,-6303.21 23758.77,-6303.03"/>
<polygon fill="black" stroke="black" points="23758.62,-6299.53 23748.62,-6303.03 23758.62,-6306.53 23758.62,-6299.53"/>
<text text-anchor="middle" x="25467" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l2_gate_gpu14&#45;&gt;l2_expert4_gpu4 -->
<g id="edge1076" class="edge">
<title>l2_gate_gpu14&#45;&gt;l2_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19738,-6411.3C19749.03,-6407.11 19760.7,-6403.42 19772,-6401.17 19797.63,-6396.05 23517.56,-6401.69 23536,-6383.17 23540.7,-6378.44 23540.6,-6372.99 23536,-6368.17 23490.19,-6320.18 22507.97,-6306.74 22214.86,-6303.8"/>
<polygon fill="black" stroke="black" points="22214.76,-6300.29 22204.73,-6303.69 22214.69,-6307.29 22214.76,-6300.29"/>
<text text-anchor="middle" x="23589" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l2_gate_gpu14&#45;&gt;l2_expert5_gpu5 -->
<g id="edge1077" class="edge">
<title>l2_gate_gpu14&#45;&gt;l2_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19628,-6411.3C19616.97,-6407.11 19605.3,-6403.42 19594,-6401.17 19569.84,-6396.34 16064.37,-6400.63 16047,-6383.17 16042.3,-6378.44 16042.32,-6372.91 16047,-6368.17 16060.94,-6354.05 17455.19,-6351.18 17475,-6350.17 17632.88,-6342.1 17816.74,-6323.48 17919.63,-6312.22"/>
<polygon fill="black" stroke="black" points="17920.08,-6315.7 17929.64,-6311.12 17919.32,-6308.74 17920.08,-6315.7"/>
<text text-anchor="middle" x="16097" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l2_gate_gpu14&#45;&gt;l2_expert6_gpu6 -->
<g id="edge1078" class="edge">
<title>l2_gate_gpu14&#45;&gt;l2_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19743.73,-6414.2C19757.5,-6406.26 19770.77,-6396.04 19780,-6383.17 19784.92,-6376.31 19788.36,-6368.3 19790.74,-6360.04"/>
<polygon fill="black" stroke="black" points="19794.15,-6360.84 19793.08,-6350.3 19787.34,-6359.2 19794.15,-6360.84"/>
<text text-anchor="middle" x="19837" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l2_gate_gpu14&#45;&gt;l2_expert7_gpu7 -->
<g id="edge1079" class="edge">
<title>l2_gate_gpu14&#45;&gt;l2_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M19738.01,-6411.34C19749.03,-6407.15 19760.71,-6403.45 19772,-6401.17 19797.68,-6395.98 21639.57,-6401.78 21658,-6383.17 21662.69,-6378.43 21662.5,-6373.08 21658,-6368.17 21614.63,-6320.78 21187.59,-6307.69 21005.54,-6304.25"/>
<polygon fill="black" stroke="black" points="21005.54,-6300.75 20995.48,-6304.06 21005.41,-6307.74 21005.54,-6300.75"/>
<text text-anchor="middle" x="21711" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l2_gate_gpu15&#45;&gt;l2_expert0_gpu0 -->
<g id="edge1081" class="edge">
<title>l2_gate_gpu15&#45;&gt;l2_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20518,-6411.28C20506.98,-6407.09 20495.3,-6403.41 20484,-6401.17 20458.52,-6396.11 13020.35,-6401.56 13002,-6383.17 12997.29,-6378.45 12997.33,-6372.92 13002,-6368.17 13061.48,-6307.53 15783.38,-6303.34 16293.94,-6303.09"/>
<polygon fill="black" stroke="black" points="16294.17,-6306.59 16304.17,-6303.09 16294.17,-6299.59 16294.17,-6306.59"/>
<text text-anchor="middle" x="13052" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l2_gate_gpu15&#45;&gt;l2_expert1_gpu1 -->
<g id="edge1082" class="edge">
<title>l2_gate_gpu15&#45;&gt;l2_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20517.99,-6411.34C20506.97,-6407.15 20495.3,-6403.45 20484,-6401.17 20457.29,-6395.77 18541.18,-6402.52 18522,-6383.17 18498,-6358.95 18532.19,-6338.37 18570.83,-6324.14"/>
<polygon fill="black" stroke="black" points="18572.44,-6327.29 18580.72,-6320.67 18570.12,-6320.68 18572.44,-6327.29"/>
<text text-anchor="middle" x="18572" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l2_gate_gpu15&#45;&gt;l2_expert2_gpu2 -->
<g id="edge1083" class="edge">
<title>l2_gate_gpu15&#45;&gt;l2_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20518,-6411.29C20506.98,-6407.1 20495.3,-6403.41 20484,-6401.17 20445.05,-6393.43 14794.03,-6411.29 14766,-6383.17 14761.29,-6378.44 14761.31,-6372.9 14766,-6368.17 14782.51,-6351.48 16432.54,-6350.88 16456,-6350.17 16773.29,-6340.52 17150.42,-6318.36 17313.35,-6308.26"/>
<polygon fill="black" stroke="black" points="17314.01,-6311.73 17323.77,-6307.62 17313.57,-6304.74 17314.01,-6311.73"/>
<text text-anchor="middle" x="14816" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l2_gate_gpu15&#45;&gt;l2_expert3_gpu3 -->
<g id="edge1084" class="edge">
<title>l2_gate_gpu15&#45;&gt;l2_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20628,-6411.29C20639.02,-6407.1 20650.7,-6403.41 20662,-6401.17 20698.43,-6393.92 25984.78,-6409.48 26011,-6383.17 26015.71,-6378.44 26015.65,-6372.94 26011,-6368.17 25970.92,-6326.95 24168.04,-6307.67 23758.96,-6303.82"/>
<polygon fill="black" stroke="black" points="23758.73,-6300.31 23748.7,-6303.72 23758.66,-6307.31 23758.73,-6300.31"/>
<text text-anchor="middle" x="26064" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l2_gate_gpu15&#45;&gt;l2_expert4_gpu4 -->
<g id="edge1085" class="edge">
<title>l2_gate_gpu15&#45;&gt;l2_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20628,-6411.3C20639.03,-6407.12 20650.7,-6403.42 20662,-6401.17 20685.64,-6396.44 24116,-6400.25 24133,-6383.17 24137.7,-6378.44 24137.64,-6372.96 24133,-6368.17 24131.94,-6367.07 22590.09,-6317.7 22214.67,-6305.69"/>
<polygon fill="black" stroke="black" points="22214.54,-6302.19 22204.43,-6305.37 22214.32,-6309.18 22214.54,-6302.19"/>
<text text-anchor="middle" x="24186" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l2_gate_gpu15&#45;&gt;l2_expert5_gpu5 -->
<g id="edge1086" class="edge">
<title>l2_gate_gpu15&#45;&gt;l2_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20518,-6411.3C20506.97,-6407.11 20495.3,-6403.42 20484,-6401.17 20457.85,-6395.95 16662.81,-6402.07 16644,-6383.17 16639.3,-6378.44 16639.34,-6372.93 16644,-6368.17 16660.15,-6351.66 17451.95,-6351.45 17475,-6350.17 17632.84,-6341.39 17816.72,-6323.02 17919.62,-6312"/>
<polygon fill="black" stroke="black" points="17920.06,-6315.47 17929.63,-6310.92 17919.31,-6308.51 17920.06,-6315.47"/>
<text text-anchor="middle" x="16694" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l2_gate_gpu15&#45;&gt;l2_expert6_gpu6 -->
<g id="edge1087" class="edge">
<title>l2_gate_gpu15&#45;&gt;l2_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20515.62,-6412.39C20505.21,-6408.31 20494.37,-6404.38 20484,-6401.17 20447.53,-6389.88 20435.25,-6397.84 20400,-6383.17 20388.73,-6378.48 20388.49,-6372.29 20377,-6368.17 20286.85,-6335.81 20014.15,-6315.83 19876.44,-6307.53"/>
<polygon fill="black" stroke="black" points="19876.55,-6304.03 19866.36,-6306.93 19876.13,-6311.02 19876.55,-6304.03"/>
<text text-anchor="middle" x="20450" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l2_gate_gpu15&#45;&gt;l2_expert7_gpu7 -->
<g id="edge1088" class="edge">
<title>l2_gate_gpu15&#45;&gt;l2_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M20628.01,-6411.36C20639.04,-6407.17 20650.71,-6403.46 20662,-6401.17 20705.37,-6392.36 22223.89,-6414.63 22255,-6383.17 22259.69,-6378.43 22259.6,-6372.99 22255,-6368.17 22244.17,-6356.79 21293.68,-6317.87 21005.75,-6306.33"/>
<polygon fill="black" stroke="black" points="21005.51,-6302.82 20995.38,-6305.92 21005.23,-6309.81 21005.51,-6302.82"/>
<text text-anchor="middle" x="22308" y="-6371.97" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l3_attn_stage0_gpu0 -->
<g id="node673" class="node">
<title>l3_attn_stage0_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20829" cy="-5892.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20829" y="-5903.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="20829" y="-5888.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20829" y="-5873.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu0 -->
<g id="node689" class="node">
<title>l3_attn_stage1_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20829" cy="-5745.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20829" y="-5756.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="20829" y="-5741.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20829" y="-5726.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu0&#45;&gt;l3_attn_stage1_gpu0 -->
<g id="edge1105" class="edge">
<title>l3_attn_stage0_gpu0&#45;&gt;l3_attn_stage1_gpu0</title>
<path fill="none" stroke="black" d="M20776.02,-5862.26C20762.09,-5855.97 20746.82,-5850.19 20732,-5846.83 20714.99,-5842.97 20116.24,-5849.27 20104,-5836.83 20099.32,-5832.08 20099.32,-5826.58 20104,-5821.83 20116.26,-5809.42 20715.39,-5819.16 20732,-5813.83 20750.46,-5807.91 20768.51,-5797.16 20783.94,-5785.96"/>
<polygon fill="black" stroke="black" points="20786.34,-5788.53 20792.22,-5779.72 20782.13,-5782.94 20786.34,-5788.53"/>
</g>
<!-- l3_attn_stage1_gpu[next_gpu] -->
<g id="node1375" class="node">
<title>l3_attn_stage1_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="21091" cy="-5745.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="21091" y="-5741.63" font-family="Times,serif" font-size="14.00">l3_attn_stage1_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage0_gpu0&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge2705" class="edge">
<title>l3_attn_stage0_gpu0&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20917.34,-5889.15C21067.61,-5884.53 21359.83,-5871.17 21391,-5836.83 21443.01,-5779.54 21344.61,-5757.97 21246.88,-5750.12"/>
<polygon fill="red" stroke="red" points="21247.06,-5746.62 21236.82,-5749.36 21246.53,-5753.6 21247.06,-5746.62"/>
<text text-anchor="middle" x="21430.5" y="-5825.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu1 -->
<g id="node674" class="node">
<title>l3_attn_stage0_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19464" cy="-5892.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19464" y="-5903.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="19464" y="-5888.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19464" y="-5873.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu1 -->
<g id="node690" class="node">
<title>l3_attn_stage1_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19464" cy="-5745.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19464" y="-5756.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="19464" y="-5741.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19464" y="-5726.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu1&#45;&gt;l3_attn_stage1_gpu1 -->
<g id="edge1106" class="edge">
<title>l3_attn_stage0_gpu1&#45;&gt;l3_attn_stage1_gpu1</title>
<path fill="none" stroke="black" d="M19464,-5854.74C19464,-5836.02 19464,-5813.03 19464,-5793.05"/>
<polygon fill="black" stroke="black" points="19467.5,-5792.91 19464,-5782.91 19460.5,-5792.91 19467.5,-5792.91"/>
</g>
<!-- l3_attn_stage0_gpu1&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge2706" class="edge">
<title>l3_attn_stage0_gpu1&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19517.28,-5862.3C19531.42,-5855.96 19546.95,-5850.15 19562,-5846.83 19628.57,-5832.14 20724.69,-5859.45 20789,-5836.83 20799.15,-5833.26 20797.96,-5825.69 20808,-5821.83 20858.3,-5802.49 20876.53,-5826.14 20929,-5813.83 20972.2,-5803.7 21018.67,-5783.25 21050.71,-5767.5"/>
<polygon fill="red" stroke="red" points="21052.38,-5770.59 21059.77,-5762.99 21049.25,-5764.32 21052.38,-5770.59"/>
<text text-anchor="middle" x="20839.5" y="-5825.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu2 -->
<g id="node675" class="node">
<title>l3_attn_stage0_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20634" cy="-5892.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20634" y="-5903.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="20634" y="-5888.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20634" y="-5873.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu2 -->
<g id="node691" class="node">
<title>l3_attn_stage1_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20634" cy="-5745.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20634" y="-5756.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="20634" y="-5741.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20634" y="-5726.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu2&#45;&gt;l3_attn_stage1_gpu2 -->
<g id="edge1107" class="edge">
<title>l3_attn_stage0_gpu2&#45;&gt;l3_attn_stage1_gpu2</title>
<path fill="none" stroke="black" d="M20580.74,-5862.22C20566.89,-5855.96 20551.71,-5850.22 20537,-5846.83 20513.17,-5841.34 20114.09,-5854.32 20097,-5836.83 20092.34,-5832.07 20092.33,-5826.59 20097,-5821.83 20105.56,-5813.11 20525.37,-5817.6 20537,-5813.83 20555.45,-5807.86 20573.49,-5797.1 20588.92,-5785.9"/>
<polygon fill="black" stroke="black" points="20591.32,-5788.47 20597.2,-5779.66 20587.11,-5782.88 20591.32,-5788.47"/>
</g>
<!-- l3_attn_stage0_gpu2&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge2707" class="edge">
<title>l3_attn_stage0_gpu2&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20687.3,-5862.39C20701.44,-5856.05 20716.96,-5850.22 20732,-5846.83 20747.53,-5843.33 21293.84,-5848.19 21305,-5836.83 21345.03,-5796.1 21275.32,-5772.74 21205.01,-5759.99"/>
<polygon fill="red" stroke="red" points="21205.55,-5756.53 21195.1,-5758.27 21204.35,-5763.43 21205.55,-5756.53"/>
<text text-anchor="middle" x="21345.5" y="-5825.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu3 -->
<g id="node676" class="node">
<title>l3_attn_stage0_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="20049" cy="-5892.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20049" y="-5903.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="20049" y="-5888.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="20049" y="-5873.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu3 -->
<g id="node692" class="node">
<title>l3_attn_stage1_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="20049" cy="-5745.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20049" y="-5756.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="20049" y="-5741.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="20049" y="-5726.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu3&#45;&gt;l3_attn_stage1_gpu3 -->
<g id="edge1108" class="edge">
<title>l3_attn_stage0_gpu3&#45;&gt;l3_attn_stage1_gpu3</title>
<path fill="none" stroke="black" d="M20049,-5854.74C20049,-5836.02 20049,-5813.03 20049,-5793.05"/>
<polygon fill="black" stroke="black" points="20052.5,-5792.91 20049,-5782.91 20045.5,-5792.91 20052.5,-5792.91"/>
</g>
<!-- l3_attn_stage0_gpu3&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge2708" class="edge">
<title>l3_attn_stage0_gpu3&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20102.29,-5862.33C20116.42,-5855.99 20131.95,-5850.18 20147,-5846.83 20171.41,-5841.41 21025.88,-5850.21 21047,-5836.83 21068.94,-5822.93 21080.24,-5794.65 21085.85,-5773.39"/>
<polygon fill="red" stroke="red" points="21089.27,-5774.14 21088.18,-5763.6 21082.46,-5772.52 21089.27,-5774.14"/>
<text text-anchor="middle" x="21093.5" y="-5825.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu4 -->
<g id="node677" class="node">
<title>l3_attn_stage0_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="18294" cy="-5892.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18294" y="-5903.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="18294" y="-5888.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="18294" y="-5873.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu4 -->
<g id="node693" class="node">
<title>l3_attn_stage1_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="18294" cy="-5745.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18294" y="-5756.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="18294" y="-5741.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="18294" y="-5726.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu4&#45;&gt;l3_attn_stage1_gpu4 -->
<g id="edge1109" class="edge">
<title>l3_attn_stage0_gpu4&#45;&gt;l3_attn_stage1_gpu4</title>
<path fill="none" stroke="black" d="M18294,-5854.74C18294,-5836.02 18294,-5813.03 18294,-5793.05"/>
<polygon fill="black" stroke="black" points="18297.5,-5792.91 18294,-5782.91 18290.5,-5792.91 18297.5,-5792.91"/>
</g>
<!-- l3_attn_stage0_gpu4&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge2709" class="edge">
<title>l3_attn_stage0_gpu4&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18346.96,-5862.15C18360.88,-5855.86 18376.17,-5850.11 18391,-5846.83 18442.04,-5835.54 20223.66,-5854.11 20273,-5836.83 20283.15,-5833.28 20281.86,-5825.42 20292,-5821.83 20325.36,-5810.02 20894.34,-5820.99 20929,-5813.83 20972.86,-5804.77 21019.76,-5783.86 21051.75,-5767.7"/>
<polygon fill="red" stroke="red" points="21053.48,-5770.75 21060.77,-5763.07 21050.28,-5764.52 21053.48,-5770.75"/>
<text text-anchor="middle" x="20323.5" y="-5825.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu5 -->
<g id="node678" class="node">
<title>l3_attn_stage0_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="19074" cy="-5892.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19074" y="-5903.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="19074" y="-5888.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="19074" y="-5873.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu5 -->
<g id="node694" class="node">
<title>l3_attn_stage1_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="19074" cy="-5745.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19074" y="-5756.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="19074" y="-5741.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="19074" y="-5726.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu5&#45;&gt;l3_attn_stage1_gpu5 -->
<g id="edge1110" class="edge">
<title>l3_attn_stage0_gpu5&#45;&gt;l3_attn_stage1_gpu5</title>
<path fill="none" stroke="black" d="M19074,-5854.74C19074,-5836.02 19074,-5813.03 19074,-5793.05"/>
<polygon fill="black" stroke="black" points="19077.5,-5792.91 19074,-5782.91 19070.5,-5792.91 19077.5,-5792.91"/>
</g>
<!-- l3_attn_stage0_gpu5&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge2710" class="edge">
<title>l3_attn_stage0_gpu5&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19126.96,-5862.17C19140.89,-5855.88 19156.17,-5850.13 19171,-5846.83 19210.21,-5838.13 20579.1,-5850.14 20617,-5836.83 20627.15,-5833.27 20625.89,-5825.5 20636,-5821.83 20666.62,-5810.73 20897.15,-5820.65 20929,-5813.83 20972.66,-5804.48 21019.41,-5783.72 21051.42,-5767.67"/>
<polygon fill="red" stroke="red" points="21053.12,-5770.73 21060.45,-5763.07 21049.95,-5764.49 21053.12,-5770.73"/>
<text text-anchor="middle" x="20667.5" y="-5825.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu6 -->
<g id="node679" class="node">
<title>l3_attn_stage0_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19854" cy="-5892.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19854" y="-5903.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="19854" y="-5888.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19854" y="-5873.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu6 -->
<g id="node695" class="node">
<title>l3_attn_stage1_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19854" cy="-5745.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19854" y="-5756.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="19854" y="-5741.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19854" y="-5726.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu6&#45;&gt;l3_attn_stage1_gpu6 -->
<g id="edge1111" class="edge">
<title>l3_attn_stage0_gpu6&#45;&gt;l3_attn_stage1_gpu6</title>
<path fill="none" stroke="black" d="M19854,-5854.74C19854,-5836.02 19854,-5813.03 19854,-5793.05"/>
<polygon fill="black" stroke="black" points="19857.5,-5792.91 19854,-5782.91 19850.5,-5792.91 19857.5,-5792.91"/>
</g>
<!-- l3_attn_stage0_gpu6&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge2711" class="edge">
<title>l3_attn_stage0_gpu6&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19907.29,-5862.31C19921.42,-5855.97 19936.95,-5850.17 19952,-5846.83 20006.73,-5834.7 20908.13,-5855.48 20961,-5836.83 20971.15,-5833.25 20971.32,-5828.2 20980,-5821.83 21005.22,-5803.34 21034.5,-5783.49 21056.65,-5768.78"/>
<polygon fill="red" stroke="red" points="21058.66,-5771.65 21065.07,-5763.22 21054.8,-5765.81 21058.66,-5771.65"/>
<text text-anchor="middle" x="21011.5" y="-5825.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu7 -->
<g id="node680" class="node">
<title>l3_attn_stage0_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="18489" cy="-5892.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18489" y="-5903.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="18489" y="-5888.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="18489" y="-5873.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu7 -->
<g id="node696" class="node">
<title>l3_attn_stage1_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="18489" cy="-5745.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18489" y="-5756.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="18489" y="-5741.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="18489" y="-5726.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu7&#45;&gt;l3_attn_stage1_gpu7 -->
<g id="edge1112" class="edge">
<title>l3_attn_stage0_gpu7&#45;&gt;l3_attn_stage1_gpu7</title>
<path fill="none" stroke="black" d="M18489,-5854.74C18489,-5836.02 18489,-5813.03 18489,-5793.05"/>
<polygon fill="black" stroke="black" points="18492.5,-5792.91 18489,-5782.91 18485.5,-5792.91 18492.5,-5792.91"/>
</g>
<!-- l3_attn_stage0_gpu7&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge2712" class="edge">
<title>l3_attn_stage0_gpu7&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18541.96,-5862.16C18555.88,-5855.86 18571.17,-5850.12 18586,-5846.83 18634.09,-5836.19 20312.52,-5853.12 20359,-5836.83 20369.15,-5833.28 20367.86,-5825.43 20378,-5821.83 20406.85,-5811.58 20899.02,-5820.05 20929,-5813.83 20972.85,-5804.73 21019.75,-5783.83 21051.75,-5767.68"/>
<polygon fill="red" stroke="red" points="21053.47,-5770.73 21060.77,-5763.05 21050.27,-5764.5 21053.47,-5770.73"/>
<text text-anchor="middle" x="20409.5" y="-5825.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu8 -->
<g id="node681" class="node">
<title>l3_attn_stage0_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20244" cy="-5892.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20244" y="-5903.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="20244" y="-5888.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20244" y="-5873.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu8 -->
<g id="node697" class="node">
<title>l3_attn_stage1_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20244" cy="-5745.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20244" y="-5756.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="20244" y="-5741.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20244" y="-5726.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu8&#45;&gt;l3_attn_stage1_gpu8 -->
<g id="edge1113" class="edge">
<title>l3_attn_stage0_gpu8&#45;&gt;l3_attn_stage1_gpu8</title>
<path fill="none" stroke="black" d="M20188.85,-5862.87C20175.43,-5856.83 20160.93,-5851.03 20147,-5846.83 20133.22,-5842.68 20092.36,-5847.77 20083,-5836.83 20048.08,-5796.03 20088.79,-5836.15 20147,-5813.83 20164.78,-5807.02 20182.42,-5796.27 20197.68,-5785.34"/>
<polygon fill="black" stroke="black" points="20199.93,-5788.03 20205.9,-5779.27 20195.77,-5782.39 20199.93,-5788.03"/>
</g>
<!-- l3_attn_stage0_gpu8&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge2713" class="edge">
<title>l3_attn_stage0_gpu8&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20297.29,-5862.34C20311.43,-5856 20326.95,-5850.19 20342,-5846.83 20363.45,-5842.05 21117.56,-5852.47 21133,-5836.83 21151.16,-5818.44 21133.89,-5790.75 21116.31,-5770.84"/>
<polygon fill="red" stroke="red" points="21118.75,-5768.32 21109.38,-5763.37 21113.61,-5773.08 21118.75,-5768.32"/>
<text text-anchor="middle" x="21171.5" y="-5825.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu9 -->
<g id="node682" class="node">
<title>l3_attn_stage0_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="19659" cy="-5892.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19659" y="-5903.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="19659" y="-5888.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="19659" y="-5873.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu9 -->
<g id="node698" class="node">
<title>l3_attn_stage1_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="19659" cy="-5745.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19659" y="-5756.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="19659" y="-5741.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="19659" y="-5726.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu9&#45;&gt;l3_attn_stage1_gpu9 -->
<g id="edge1114" class="edge">
<title>l3_attn_stage0_gpu9&#45;&gt;l3_attn_stage1_gpu9</title>
<path fill="none" stroke="black" d="M19659,-5854.74C19659,-5836.02 19659,-5813.03 19659,-5793.05"/>
<polygon fill="black" stroke="black" points="19662.5,-5792.91 19659,-5782.91 19655.5,-5792.91 19662.5,-5792.91"/>
</g>
<!-- l3_attn_stage0_gpu9&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge2714" class="edge">
<title>l3_attn_stage0_gpu9&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19712.28,-5862.3C19726.42,-5855.97 19741.95,-5850.16 19757,-5846.83 19817.65,-5833.42 20816.41,-5857.47 20875,-5836.83 20885.15,-5833.26 20884.3,-5826.48 20894,-5821.83 20908.39,-5814.94 20913.8,-5818.7 20929,-5813.83 20969.94,-5800.73 21014.95,-5781.57 21047.12,-5767.01"/>
<polygon fill="red" stroke="red" points="21048.61,-5770.18 21056.25,-5762.84 21045.7,-5763.81 21048.61,-5770.18"/>
<text text-anchor="middle" x="20925.5" y="-5825.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu10 -->
<g id="node683" class="node">
<title>l3_attn_stage0_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="17904" cy="-5892.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="17904" y="-5903.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="17904" y="-5888.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17904" y="-5873.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu10 -->
<g id="node699" class="node">
<title>l3_attn_stage1_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="17904" cy="-5745.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="17904" y="-5756.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="17904" y="-5741.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17904" y="-5726.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu10&#45;&gt;l3_attn_stage1_gpu10 -->
<g id="edge1115" class="edge">
<title>l3_attn_stage0_gpu10&#45;&gt;l3_attn_stage1_gpu10</title>
<path fill="none" stroke="black" d="M17904,-5854.74C17904,-5836.02 17904,-5813.03 17904,-5793.05"/>
<polygon fill="black" stroke="black" points="17907.5,-5792.91 17904,-5782.91 17900.5,-5792.91 17907.5,-5792.91"/>
</g>
<!-- l3_attn_stage0_gpu10&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge2715" class="edge">
<title>l3_attn_stage0_gpu10&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17956.97,-5862.22C17970.9,-5855.92 17986.18,-5850.16 18001,-5846.83 18230.74,-5795.23 19884.55,-5824.39 20120,-5821.83 20164.94,-5821.35 20884.97,-5822.87 20929,-5813.83 20972.87,-5804.83 21019.77,-5783.91 21051.76,-5767.73"/>
<polygon fill="red" stroke="red" points="21053.49,-5770.78 21060.78,-5763.09 21050.28,-5764.55 21053.49,-5770.78"/>
<text text-anchor="middle" x="20151.5" y="-5825.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu11 -->
<g id="node684" class="node">
<title>l3_attn_stage0_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="18684" cy="-5892.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18684" y="-5903.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="18684" y="-5888.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18684" y="-5873.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu11 -->
<g id="node700" class="node">
<title>l3_attn_stage1_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="18684" cy="-5745.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18684" y="-5756.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="18684" y="-5741.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18684" y="-5726.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu11&#45;&gt;l3_attn_stage1_gpu11 -->
<g id="edge1116" class="edge">
<title>l3_attn_stage0_gpu11&#45;&gt;l3_attn_stage1_gpu11</title>
<path fill="none" stroke="black" d="M18684,-5854.74C18684,-5836.02 18684,-5813.03 18684,-5793.05"/>
<polygon fill="black" stroke="black" points="18687.5,-5792.91 18684,-5782.91 18680.5,-5792.91 18687.5,-5792.91"/>
</g>
<!-- l3_attn_stage0_gpu11&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge2716" class="edge">
<title>l3_attn_stage0_gpu11&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18736.96,-5862.16C18750.88,-5855.87 18766.17,-5850.12 18781,-5846.83 18826.13,-5836.83 20401.38,-5852.12 20445,-5836.83 20455.15,-5833.27 20453.87,-5825.45 20464,-5821.83 20512.67,-5804.47 20878.42,-5824.4 20929,-5813.83 20972.84,-5804.67 21019.74,-5783.78 21051.74,-5767.64"/>
<polygon fill="red" stroke="red" points="21053.46,-5770.7 21060.76,-5763.02 21050.27,-5764.47 21053.46,-5770.7"/>
<text text-anchor="middle" x="20495.5" y="-5825.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu12 -->
<g id="node685" class="node">
<title>l3_attn_stage0_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="18099" cy="-5892.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18099" y="-5903.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="18099" y="-5888.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18099" y="-5873.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu12 -->
<g id="node701" class="node">
<title>l3_attn_stage1_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="18099" cy="-5745.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18099" y="-5756.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="18099" y="-5741.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18099" y="-5726.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu12&#45;&gt;l3_attn_stage1_gpu12 -->
<g id="edge1117" class="edge">
<title>l3_attn_stage0_gpu12&#45;&gt;l3_attn_stage1_gpu12</title>
<path fill="none" stroke="black" d="M18099,-5854.74C18099,-5836.02 18099,-5813.03 18099,-5793.05"/>
<polygon fill="black" stroke="black" points="18102.5,-5792.91 18099,-5782.91 18095.5,-5792.91 18102.5,-5792.91"/>
</g>
<!-- l3_attn_stage0_gpu12&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge2717" class="edge">
<title>l3_attn_stage0_gpu12&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18151.96,-5862.15C18165.88,-5855.86 18181.17,-5850.11 18196,-5846.83 18250,-5834.89 20134.8,-5855.1 20187,-5836.83 20197.15,-5833.28 20195.86,-5825.42 20206,-5821.83 20243.87,-5808.45 20889.66,-5821.93 20929,-5813.83 20972.87,-5804.81 21019.77,-5783.89 21051.76,-5767.72"/>
<polygon fill="red" stroke="red" points="21053.48,-5770.77 21060.78,-5763.08 21050.28,-5764.54 21053.48,-5770.77"/>
<text text-anchor="middle" x="20237.5" y="-5825.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu13 -->
<g id="node686" class="node">
<title>l3_attn_stage0_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="18879" cy="-5892.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18879" y="-5903.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="18879" y="-5888.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18879" y="-5873.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu13 -->
<g id="node702" class="node">
<title>l3_attn_stage1_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="18879" cy="-5745.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18879" y="-5756.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="18879" y="-5741.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18879" y="-5726.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu13&#45;&gt;l3_attn_stage1_gpu13 -->
<g id="edge1118" class="edge">
<title>l3_attn_stage0_gpu13&#45;&gt;l3_attn_stage1_gpu13</title>
<path fill="none" stroke="black" d="M18879,-5854.74C18879,-5836.02 18879,-5813.03 18879,-5793.05"/>
<polygon fill="black" stroke="black" points="18882.5,-5792.91 18879,-5782.91 18875.5,-5792.91 18882.5,-5792.91"/>
</g>
<!-- l3_attn_stage0_gpu13&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge2718" class="edge">
<title>l3_attn_stage0_gpu13&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18931.96,-5862.16C18945.89,-5855.87 18961.17,-5850.12 18976,-5846.83 19018.17,-5837.48 20490.24,-5851.13 20531,-5836.83 20541.15,-5833.27 20539.87,-5825.47 20550,-5821.83 20589.64,-5807.6 20887.79,-5822.53 20929,-5813.83 20972.82,-5804.59 21019.73,-5783.7 21051.73,-5767.6"/>
<polygon fill="red" stroke="red" points="21053.45,-5770.65 21060.75,-5762.98 21050.26,-5764.42 21053.45,-5770.65"/>
<text text-anchor="middle" x="20581.5" y="-5825.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu14 -->
<g id="node687" class="node">
<title>l3_attn_stage0_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19269" cy="-5892.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19269" y="-5903.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="19269" y="-5888.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19269" y="-5873.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu14 -->
<g id="node703" class="node">
<title>l3_attn_stage1_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19269" cy="-5745.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19269" y="-5756.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="19269" y="-5741.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19269" y="-5726.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu14&#45;&gt;l3_attn_stage1_gpu14 -->
<g id="edge1119" class="edge">
<title>l3_attn_stage0_gpu14&#45;&gt;l3_attn_stage1_gpu14</title>
<path fill="none" stroke="black" d="M19269,-5854.74C19269,-5836.02 19269,-5813.03 19269,-5793.05"/>
<polygon fill="black" stroke="black" points="19272.5,-5792.91 19269,-5782.91 19265.5,-5792.91 19272.5,-5792.91"/>
</g>
<!-- l3_attn_stage0_gpu14&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge2719" class="edge">
<title>l3_attn_stage0_gpu14&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19322.28,-5862.29C19336.42,-5855.95 19351.95,-5850.15 19367,-5846.83 19403.24,-5838.85 20667.99,-5849.14 20703,-5836.83 20713.15,-5833.27 20711.91,-5825.56 20722,-5821.83 20765.19,-5805.9 20884.04,-5823.73 20929,-5813.83 20972.6,-5804.23 21019.37,-5783.51 21051.39,-5767.54"/>
<polygon fill="red" stroke="red" points="21053.08,-5770.6 21060.42,-5762.96 21049.92,-5764.36 21053.08,-5770.6"/>
<text text-anchor="middle" x="20753.5" y="-5825.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu15 -->
<g id="node688" class="node">
<title>l3_attn_stage0_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20439" cy="-5892.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20439" y="-5903.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="20439" y="-5888.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20439" y="-5873.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu15 -->
<g id="node704" class="node">
<title>l3_attn_stage1_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20439" cy="-5745.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20439" y="-5756.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="20439" y="-5741.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20439" y="-5726.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu15&#45;&gt;l3_attn_stage1_gpu15 -->
<g id="edge1120" class="edge">
<title>l3_attn_stage0_gpu15&#45;&gt;l3_attn_stage1_gpu15</title>
<path fill="none" stroke="black" d="M20385.7,-5862.39C20371.85,-5856.13 20356.69,-5850.35 20342,-5846.83 20328.37,-5843.57 20099.71,-5846.93 20090,-5836.83 20085.38,-5832.03 20085.36,-5826.62 20090,-5821.83 20099.75,-5811.77 20328.7,-5818.24 20342,-5813.83 20360.4,-5807.74 20378.44,-5796.94 20393.87,-5785.75"/>
<polygon fill="black" stroke="black" points="20396.27,-5788.33 20402.16,-5779.52 20392.06,-5782.73 20396.27,-5788.33"/>
</g>
<!-- l3_attn_stage0_gpu15&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge2720" class="edge">
<title>l3_attn_stage0_gpu15&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20492.3,-5862.36C20506.43,-5856.02 20521.96,-5850.2 20537,-5846.83 20555.49,-5842.69 21205.7,-5850.33 21219,-5836.83 21247.36,-5808.06 21199.79,-5782.22 21154.82,-5765.6"/>
<polygon fill="red" stroke="red" points="21155.88,-5762.26 21145.29,-5762.19 21153.53,-5768.85 21155.88,-5762.26"/>
<text text-anchor="middle" x="21258.5" y="-5825.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu0 -->
<g id="node705" class="node">
<title>l3_attn_stage2_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20829" cy="-5598.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20829" y="-5609.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="20829" y="-5594.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20829" y="-5579.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu0&#45;&gt;l3_attn_stage2_gpu0 -->
<g id="edge1121" class="edge">
<title>l3_attn_stage1_gpu0&#45;&gt;l3_attn_stage2_gpu0</title>
<path fill="none" stroke="black" d="M20776.02,-5715.26C20762.09,-5708.97 20746.82,-5703.19 20732,-5699.83 20714.99,-5695.97 20116.24,-5702.27 20104,-5689.83 20099.32,-5685.08 20099.32,-5679.58 20104,-5674.83 20116.26,-5662.42 20715.39,-5672.16 20732,-5666.83 20750.46,-5660.91 20768.51,-5650.16 20783.94,-5638.96"/>
<polygon fill="black" stroke="black" points="20786.34,-5641.53 20792.22,-5632.72 20782.13,-5635.94 20786.34,-5641.53"/>
</g>
<!-- l3_attn_stage2_gpu[next_gpu] -->
<g id="node1376" class="node">
<title>l3_attn_stage2_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="21091" cy="-5598.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="21091" y="-5594.63" font-family="Times,serif" font-size="14.00">l3_attn_stage2_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage1_gpu0&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge2721" class="edge">
<title>l3_attn_stage1_gpu0&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20884.38,-5716.02C20899.74,-5709.45 20916.68,-5703.36 20933,-5699.83 20957.87,-5694.45 21373.2,-5708.02 21391,-5689.83 21445.67,-5633.96 21344.45,-5612.3 21245.12,-5604.04"/>
<polygon fill="red" stroke="red" points="21245.15,-5600.53 21234.9,-5603.24 21244.6,-5607.51 21245.15,-5600.53"/>
<text text-anchor="middle" x="21431.5" y="-5678.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu1 -->
<g id="node706" class="node">
<title>l3_attn_stage2_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19464" cy="-5598.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19464" y="-5609.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="19464" y="-5594.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19464" y="-5579.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu1&#45;&gt;l3_attn_stage2_gpu1 -->
<g id="edge1122" class="edge">
<title>l3_attn_stage1_gpu1&#45;&gt;l3_attn_stage2_gpu1</title>
<path fill="none" stroke="black" d="M19464,-5707.74C19464,-5689.02 19464,-5666.03 19464,-5646.05"/>
<polygon fill="black" stroke="black" points="19467.5,-5645.91 19464,-5635.91 19460.5,-5645.91 19467.5,-5645.91"/>
</g>
<!-- l3_attn_stage1_gpu1&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge2722" class="edge">
<title>l3_attn_stage1_gpu1&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19517.28,-5715.3C19531.42,-5708.96 19546.95,-5703.15 19562,-5699.83 19628.57,-5685.14 20724.69,-5712.45 20789,-5689.83 20799.15,-5686.26 20797.96,-5678.69 20808,-5674.83 20858.3,-5655.49 20876.53,-5679.14 20929,-5666.83 20972.2,-5656.7 21018.67,-5636.25 21050.71,-5620.5"/>
<polygon fill="red" stroke="red" points="21052.38,-5623.59 21059.77,-5615.99 21049.25,-5617.32 21052.38,-5623.59"/>
<text text-anchor="middle" x="20839.5" y="-5678.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu2 -->
<g id="node707" class="node">
<title>l3_attn_stage2_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20634" cy="-5598.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20634" y="-5609.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="20634" y="-5594.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20634" y="-5579.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu2&#45;&gt;l3_attn_stage2_gpu2 -->
<g id="edge1123" class="edge">
<title>l3_attn_stage1_gpu2&#45;&gt;l3_attn_stage2_gpu2</title>
<path fill="none" stroke="black" d="M20580.74,-5715.22C20566.89,-5708.96 20551.71,-5703.22 20537,-5699.83 20513.17,-5694.34 20114.09,-5707.32 20097,-5689.83 20092.34,-5685.07 20092.33,-5679.59 20097,-5674.83 20105.56,-5666.11 20525.37,-5670.6 20537,-5666.83 20555.45,-5660.86 20573.49,-5650.1 20588.92,-5638.9"/>
<polygon fill="black" stroke="black" points="20591.32,-5641.47 20597.2,-5632.66 20587.11,-5635.88 20591.32,-5641.47"/>
</g>
<!-- l3_attn_stage1_gpu2&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge2723" class="edge">
<title>l3_attn_stage1_gpu2&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20687.3,-5715.39C20701.44,-5709.05 20716.96,-5703.22 20732,-5699.83 20747.53,-5696.33 21293.84,-5701.19 21305,-5689.83 21345.03,-5649.1 21275.32,-5625.74 21205.01,-5612.99"/>
<polygon fill="red" stroke="red" points="21205.55,-5609.53 21195.1,-5611.27 21204.35,-5616.43 21205.55,-5609.53"/>
<text text-anchor="middle" x="21345.5" y="-5678.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu3 -->
<g id="node708" class="node">
<title>l3_attn_stage2_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="20049" cy="-5598.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20049" y="-5609.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="20049" y="-5594.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="20049" y="-5579.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu3&#45;&gt;l3_attn_stage2_gpu3 -->
<g id="edge1124" class="edge">
<title>l3_attn_stage1_gpu3&#45;&gt;l3_attn_stage2_gpu3</title>
<path fill="none" stroke="black" d="M20049,-5707.74C20049,-5689.02 20049,-5666.03 20049,-5646.05"/>
<polygon fill="black" stroke="black" points="20052.5,-5645.91 20049,-5635.91 20045.5,-5645.91 20052.5,-5645.91"/>
</g>
<!-- l3_attn_stage1_gpu3&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge2724" class="edge">
<title>l3_attn_stage1_gpu3&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20102.29,-5715.33C20116.42,-5708.99 20131.95,-5703.18 20147,-5699.83 20171.41,-5694.41 21025.88,-5703.21 21047,-5689.83 21068.94,-5675.93 21080.24,-5647.65 21085.85,-5626.39"/>
<polygon fill="red" stroke="red" points="21089.27,-5627.14 21088.18,-5616.6 21082.46,-5625.52 21089.27,-5627.14"/>
<text text-anchor="middle" x="21093.5" y="-5678.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu4 -->
<g id="node709" class="node">
<title>l3_attn_stage2_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="18294" cy="-5598.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18294" y="-5609.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="18294" y="-5594.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="18294" y="-5579.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu4&#45;&gt;l3_attn_stage2_gpu4 -->
<g id="edge1125" class="edge">
<title>l3_attn_stage1_gpu4&#45;&gt;l3_attn_stage2_gpu4</title>
<path fill="none" stroke="black" d="M18294,-5707.74C18294,-5689.02 18294,-5666.03 18294,-5646.05"/>
<polygon fill="black" stroke="black" points="18297.5,-5645.91 18294,-5635.91 18290.5,-5645.91 18297.5,-5645.91"/>
</g>
<!-- l3_attn_stage1_gpu4&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge2725" class="edge">
<title>l3_attn_stage1_gpu4&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18346.96,-5715.15C18360.88,-5708.86 18376.17,-5703.11 18391,-5699.83 18442.04,-5688.54 20223.66,-5707.11 20273,-5689.83 20283.15,-5686.28 20281.86,-5678.42 20292,-5674.83 20325.36,-5663.02 20894.34,-5673.99 20929,-5666.83 20972.86,-5657.77 21019.76,-5636.86 21051.75,-5620.7"/>
<polygon fill="red" stroke="red" points="21053.48,-5623.75 21060.77,-5616.07 21050.28,-5617.52 21053.48,-5623.75"/>
<text text-anchor="middle" x="20323.5" y="-5678.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu5 -->
<g id="node710" class="node">
<title>l3_attn_stage2_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="19074" cy="-5598.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19074" y="-5609.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="19074" y="-5594.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="19074" y="-5579.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu5&#45;&gt;l3_attn_stage2_gpu5 -->
<g id="edge1126" class="edge">
<title>l3_attn_stage1_gpu5&#45;&gt;l3_attn_stage2_gpu5</title>
<path fill="none" stroke="black" d="M19074,-5707.74C19074,-5689.02 19074,-5666.03 19074,-5646.05"/>
<polygon fill="black" stroke="black" points="19077.5,-5645.91 19074,-5635.91 19070.5,-5645.91 19077.5,-5645.91"/>
</g>
<!-- l3_attn_stage1_gpu5&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge2726" class="edge">
<title>l3_attn_stage1_gpu5&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19126.96,-5715.17C19140.89,-5708.88 19156.17,-5703.13 19171,-5699.83 19210.21,-5691.13 20579.1,-5703.14 20617,-5689.83 20627.15,-5686.27 20625.89,-5678.5 20636,-5674.83 20666.62,-5663.73 20897.15,-5673.65 20929,-5666.83 20972.66,-5657.48 21019.41,-5636.72 21051.42,-5620.67"/>
<polygon fill="red" stroke="red" points="21053.12,-5623.73 21060.45,-5616.07 21049.95,-5617.49 21053.12,-5623.73"/>
<text text-anchor="middle" x="20667.5" y="-5678.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu6 -->
<g id="node711" class="node">
<title>l3_attn_stage2_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19854" cy="-5598.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19854" y="-5609.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="19854" y="-5594.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19854" y="-5579.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu6&#45;&gt;l3_attn_stage2_gpu6 -->
<g id="edge1127" class="edge">
<title>l3_attn_stage1_gpu6&#45;&gt;l3_attn_stage2_gpu6</title>
<path fill="none" stroke="black" d="M19854,-5707.74C19854,-5689.02 19854,-5666.03 19854,-5646.05"/>
<polygon fill="black" stroke="black" points="19857.5,-5645.91 19854,-5635.91 19850.5,-5645.91 19857.5,-5645.91"/>
</g>
<!-- l3_attn_stage1_gpu6&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge2727" class="edge">
<title>l3_attn_stage1_gpu6&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19907.29,-5715.31C19921.42,-5708.97 19936.95,-5703.17 19952,-5699.83 20006.73,-5687.7 20908.13,-5708.48 20961,-5689.83 20971.15,-5686.25 20971.32,-5681.2 20980,-5674.83 21005.22,-5656.34 21034.5,-5636.49 21056.65,-5621.78"/>
<polygon fill="red" stroke="red" points="21058.66,-5624.65 21065.07,-5616.22 21054.8,-5618.81 21058.66,-5624.65"/>
<text text-anchor="middle" x="21011.5" y="-5678.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu7 -->
<g id="node712" class="node">
<title>l3_attn_stage2_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="18489" cy="-5598.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18489" y="-5609.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="18489" y="-5594.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="18489" y="-5579.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu7&#45;&gt;l3_attn_stage2_gpu7 -->
<g id="edge1128" class="edge">
<title>l3_attn_stage1_gpu7&#45;&gt;l3_attn_stage2_gpu7</title>
<path fill="none" stroke="black" d="M18489,-5707.74C18489,-5689.02 18489,-5666.03 18489,-5646.05"/>
<polygon fill="black" stroke="black" points="18492.5,-5645.91 18489,-5635.91 18485.5,-5645.91 18492.5,-5645.91"/>
</g>
<!-- l3_attn_stage1_gpu7&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge2728" class="edge">
<title>l3_attn_stage1_gpu7&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18541.96,-5715.16C18555.88,-5708.86 18571.17,-5703.12 18586,-5699.83 18634.09,-5689.19 20312.52,-5706.12 20359,-5689.83 20369.15,-5686.28 20367.86,-5678.43 20378,-5674.83 20406.85,-5664.58 20899.02,-5673.05 20929,-5666.83 20972.85,-5657.73 21019.75,-5636.83 21051.75,-5620.68"/>
<polygon fill="red" stroke="red" points="21053.47,-5623.73 21060.77,-5616.05 21050.27,-5617.5 21053.47,-5623.73"/>
<text text-anchor="middle" x="20409.5" y="-5678.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu8 -->
<g id="node713" class="node">
<title>l3_attn_stage2_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20244" cy="-5598.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20244" y="-5609.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="20244" y="-5594.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20244" y="-5579.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu8&#45;&gt;l3_attn_stage2_gpu8 -->
<g id="edge1129" class="edge">
<title>l3_attn_stage1_gpu8&#45;&gt;l3_attn_stage2_gpu8</title>
<path fill="none" stroke="black" d="M20188.85,-5715.87C20175.43,-5709.83 20160.93,-5704.03 20147,-5699.83 20133.22,-5695.68 20092.36,-5700.77 20083,-5689.83 20048.08,-5649.03 20088.79,-5689.15 20147,-5666.83 20164.78,-5660.02 20182.42,-5649.27 20197.68,-5638.34"/>
<polygon fill="black" stroke="black" points="20199.93,-5641.03 20205.9,-5632.27 20195.77,-5635.39 20199.93,-5641.03"/>
</g>
<!-- l3_attn_stage1_gpu8&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge2729" class="edge">
<title>l3_attn_stage1_gpu8&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20297.29,-5715.34C20311.43,-5709 20326.95,-5703.19 20342,-5699.83 20363.45,-5695.05 21117.56,-5705.47 21133,-5689.83 21151.16,-5671.44 21133.89,-5643.75 21116.31,-5623.84"/>
<polygon fill="red" stroke="red" points="21118.75,-5621.32 21109.38,-5616.37 21113.61,-5626.08 21118.75,-5621.32"/>
<text text-anchor="middle" x="21171.5" y="-5678.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu9 -->
<g id="node714" class="node">
<title>l3_attn_stage2_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="19659" cy="-5598.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19659" y="-5609.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="19659" y="-5594.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="19659" y="-5579.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu9&#45;&gt;l3_attn_stage2_gpu9 -->
<g id="edge1130" class="edge">
<title>l3_attn_stage1_gpu9&#45;&gt;l3_attn_stage2_gpu9</title>
<path fill="none" stroke="black" d="M19659,-5707.74C19659,-5689.02 19659,-5666.03 19659,-5646.05"/>
<polygon fill="black" stroke="black" points="19662.5,-5645.91 19659,-5635.91 19655.5,-5645.91 19662.5,-5645.91"/>
</g>
<!-- l3_attn_stage1_gpu9&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge2730" class="edge">
<title>l3_attn_stage1_gpu9&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19712.28,-5715.3C19726.42,-5708.97 19741.95,-5703.16 19757,-5699.83 19817.65,-5686.42 20816.41,-5710.47 20875,-5689.83 20885.15,-5686.26 20884.3,-5679.48 20894,-5674.83 20908.39,-5667.94 20913.8,-5671.7 20929,-5666.83 20969.94,-5653.73 21014.95,-5634.57 21047.12,-5620.01"/>
<polygon fill="red" stroke="red" points="21048.61,-5623.18 21056.25,-5615.84 21045.7,-5616.81 21048.61,-5623.18"/>
<text text-anchor="middle" x="20925.5" y="-5678.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu10 -->
<g id="node715" class="node">
<title>l3_attn_stage2_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="17904" cy="-5598.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="17904" y="-5609.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="17904" y="-5594.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17904" y="-5579.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu10&#45;&gt;l3_attn_stage2_gpu10 -->
<g id="edge1131" class="edge">
<title>l3_attn_stage1_gpu10&#45;&gt;l3_attn_stage2_gpu10</title>
<path fill="none" stroke="black" d="M17904,-5707.74C17904,-5689.02 17904,-5666.03 17904,-5646.05"/>
<polygon fill="black" stroke="black" points="17907.5,-5645.91 17904,-5635.91 17900.5,-5645.91 17907.5,-5645.91"/>
</g>
<!-- l3_attn_stage1_gpu10&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge2731" class="edge">
<title>l3_attn_stage1_gpu10&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17956.97,-5715.22C17970.9,-5708.92 17986.18,-5703.16 18001,-5699.83 18230.74,-5648.23 19884.55,-5677.39 20120,-5674.83 20164.94,-5674.35 20884.97,-5675.87 20929,-5666.83 20972.87,-5657.83 21019.77,-5636.91 21051.76,-5620.73"/>
<polygon fill="red" stroke="red" points="21053.49,-5623.78 21060.78,-5616.09 21050.28,-5617.55 21053.49,-5623.78"/>
<text text-anchor="middle" x="20151.5" y="-5678.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu11 -->
<g id="node716" class="node">
<title>l3_attn_stage2_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="18684" cy="-5598.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18684" y="-5609.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="18684" y="-5594.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18684" y="-5579.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu11&#45;&gt;l3_attn_stage2_gpu11 -->
<g id="edge1132" class="edge">
<title>l3_attn_stage1_gpu11&#45;&gt;l3_attn_stage2_gpu11</title>
<path fill="none" stroke="black" d="M18684,-5707.74C18684,-5689.02 18684,-5666.03 18684,-5646.05"/>
<polygon fill="black" stroke="black" points="18687.5,-5645.91 18684,-5635.91 18680.5,-5645.91 18687.5,-5645.91"/>
</g>
<!-- l3_attn_stage1_gpu11&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge2732" class="edge">
<title>l3_attn_stage1_gpu11&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18736.96,-5715.16C18750.88,-5708.87 18766.17,-5703.12 18781,-5699.83 18826.13,-5689.83 20401.38,-5705.12 20445,-5689.83 20455.15,-5686.27 20453.87,-5678.45 20464,-5674.83 20512.67,-5657.47 20878.42,-5677.4 20929,-5666.83 20972.84,-5657.67 21019.74,-5636.78 21051.74,-5620.64"/>
<polygon fill="red" stroke="red" points="21053.46,-5623.7 21060.76,-5616.02 21050.27,-5617.47 21053.46,-5623.7"/>
<text text-anchor="middle" x="20495.5" y="-5678.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu12 -->
<g id="node717" class="node">
<title>l3_attn_stage2_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="18099" cy="-5598.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18099" y="-5609.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="18099" y="-5594.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18099" y="-5579.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu12&#45;&gt;l3_attn_stage2_gpu12 -->
<g id="edge1133" class="edge">
<title>l3_attn_stage1_gpu12&#45;&gt;l3_attn_stage2_gpu12</title>
<path fill="none" stroke="black" d="M18099,-5707.74C18099,-5689.02 18099,-5666.03 18099,-5646.05"/>
<polygon fill="black" stroke="black" points="18102.5,-5645.91 18099,-5635.91 18095.5,-5645.91 18102.5,-5645.91"/>
</g>
<!-- l3_attn_stage1_gpu12&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge2733" class="edge">
<title>l3_attn_stage1_gpu12&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18151.96,-5715.15C18165.88,-5708.86 18181.17,-5703.11 18196,-5699.83 18250,-5687.89 20134.8,-5708.1 20187,-5689.83 20197.15,-5686.28 20195.86,-5678.42 20206,-5674.83 20243.87,-5661.45 20889.66,-5674.93 20929,-5666.83 20972.87,-5657.81 21019.77,-5636.89 21051.76,-5620.72"/>
<polygon fill="red" stroke="red" points="21053.48,-5623.77 21060.78,-5616.08 21050.28,-5617.54 21053.48,-5623.77"/>
<text text-anchor="middle" x="20237.5" y="-5678.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu13 -->
<g id="node718" class="node">
<title>l3_attn_stage2_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="18879" cy="-5598.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18879" y="-5609.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="18879" y="-5594.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18879" y="-5579.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu13&#45;&gt;l3_attn_stage2_gpu13 -->
<g id="edge1134" class="edge">
<title>l3_attn_stage1_gpu13&#45;&gt;l3_attn_stage2_gpu13</title>
<path fill="none" stroke="black" d="M18879,-5707.74C18879,-5689.02 18879,-5666.03 18879,-5646.05"/>
<polygon fill="black" stroke="black" points="18882.5,-5645.91 18879,-5635.91 18875.5,-5645.91 18882.5,-5645.91"/>
</g>
<!-- l3_attn_stage1_gpu13&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge2734" class="edge">
<title>l3_attn_stage1_gpu13&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18931.96,-5715.16C18945.89,-5708.87 18961.17,-5703.12 18976,-5699.83 19018.17,-5690.48 20490.24,-5704.13 20531,-5689.83 20541.15,-5686.27 20539.87,-5678.47 20550,-5674.83 20589.64,-5660.6 20887.79,-5675.53 20929,-5666.83 20972.82,-5657.59 21019.73,-5636.7 21051.73,-5620.6"/>
<polygon fill="red" stroke="red" points="21053.45,-5623.65 21060.75,-5615.98 21050.26,-5617.42 21053.45,-5623.65"/>
<text text-anchor="middle" x="20581.5" y="-5678.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu14 -->
<g id="node719" class="node">
<title>l3_attn_stage2_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19269" cy="-5598.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19269" y="-5609.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="19269" y="-5594.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19269" y="-5579.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu14&#45;&gt;l3_attn_stage2_gpu14 -->
<g id="edge1135" class="edge">
<title>l3_attn_stage1_gpu14&#45;&gt;l3_attn_stage2_gpu14</title>
<path fill="none" stroke="black" d="M19269,-5707.74C19269,-5689.02 19269,-5666.03 19269,-5646.05"/>
<polygon fill="black" stroke="black" points="19272.5,-5645.91 19269,-5635.91 19265.5,-5645.91 19272.5,-5645.91"/>
</g>
<!-- l3_attn_stage1_gpu14&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge2735" class="edge">
<title>l3_attn_stage1_gpu14&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19322.28,-5715.29C19336.42,-5708.95 19351.95,-5703.15 19367,-5699.83 19403.24,-5691.85 20667.99,-5702.14 20703,-5689.83 20713.15,-5686.27 20711.91,-5678.56 20722,-5674.83 20765.19,-5658.9 20884.04,-5676.73 20929,-5666.83 20972.6,-5657.23 21019.37,-5636.51 21051.39,-5620.54"/>
<polygon fill="red" stroke="red" points="21053.08,-5623.6 21060.42,-5615.96 21049.92,-5617.36 21053.08,-5623.6"/>
<text text-anchor="middle" x="20753.5" y="-5678.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu15 -->
<g id="node720" class="node">
<title>l3_attn_stage2_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20439" cy="-5598.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20439" y="-5609.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="20439" y="-5594.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20439" y="-5579.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu15&#45;&gt;l3_attn_stage2_gpu15 -->
<g id="edge1136" class="edge">
<title>l3_attn_stage1_gpu15&#45;&gt;l3_attn_stage2_gpu15</title>
<path fill="none" stroke="black" d="M20385.7,-5715.39C20371.85,-5709.13 20356.69,-5703.35 20342,-5699.83 20328.37,-5696.57 20099.71,-5699.93 20090,-5689.83 20085.38,-5685.03 20085.36,-5679.62 20090,-5674.83 20099.75,-5664.77 20328.7,-5671.24 20342,-5666.83 20360.4,-5660.74 20378.44,-5649.94 20393.87,-5638.75"/>
<polygon fill="black" stroke="black" points="20396.27,-5641.33 20402.16,-5632.52 20392.06,-5635.73 20396.27,-5641.33"/>
</g>
<!-- l3_attn_stage1_gpu15&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge2736" class="edge">
<title>l3_attn_stage1_gpu15&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20492.3,-5715.36C20506.43,-5709.02 20521.96,-5703.2 20537,-5699.83 20555.49,-5695.69 21205.7,-5703.33 21219,-5689.83 21247.36,-5661.06 21199.79,-5635.22 21154.82,-5618.6"/>
<polygon fill="red" stroke="red" points="21155.88,-5615.26 21145.29,-5615.19 21153.53,-5621.85 21155.88,-5615.26"/>
<text text-anchor="middle" x="21258.5" y="-5678.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu0 -->
<g id="node721" class="node">
<title>l3_attn_stage3_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20829" cy="-5451.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20829" y="-5462.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="20829" y="-5447.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20829" y="-5432.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu0&#45;&gt;l3_attn_stage3_gpu0 -->
<g id="edge1137" class="edge">
<title>l3_attn_stage2_gpu0&#45;&gt;l3_attn_stage3_gpu0</title>
<path fill="none" stroke="black" d="M20776.02,-5568.26C20762.09,-5561.97 20746.82,-5556.19 20732,-5552.83 20714.99,-5548.97 20116.24,-5555.27 20104,-5542.83 20099.32,-5538.08 20099.32,-5532.58 20104,-5527.83 20116.26,-5515.42 20715.39,-5525.16 20732,-5519.83 20750.46,-5513.91 20768.51,-5503.16 20783.94,-5491.96"/>
<polygon fill="black" stroke="black" points="20786.34,-5494.53 20792.22,-5485.72 20782.13,-5488.94 20786.34,-5494.53"/>
</g>
<!-- l3_attn_stage3_gpu[next_gpu] -->
<g id="node1377" class="node">
<title>l3_attn_stage3_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="21091" cy="-5451.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="21091" y="-5447.63" font-family="Times,serif" font-size="14.00">l3_attn_stage3_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage2_gpu0&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge2737" class="edge">
<title>l3_attn_stage2_gpu0&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20884.38,-5569.02C20899.74,-5562.45 20916.68,-5556.36 20933,-5552.83 20957.87,-5547.45 21373.2,-5561.02 21391,-5542.83 21445.67,-5486.96 21344.45,-5465.3 21245.12,-5457.04"/>
<polygon fill="red" stroke="red" points="21245.15,-5453.53 21234.9,-5456.24 21244.6,-5460.51 21245.15,-5453.53"/>
<text text-anchor="middle" x="21431.5" y="-5531.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu1 -->
<g id="node722" class="node">
<title>l3_attn_stage3_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19464" cy="-5451.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19464" y="-5462.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="19464" y="-5447.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19464" y="-5432.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu1&#45;&gt;l3_attn_stage3_gpu1 -->
<g id="edge1138" class="edge">
<title>l3_attn_stage2_gpu1&#45;&gt;l3_attn_stage3_gpu1</title>
<path fill="none" stroke="black" d="M19464,-5560.74C19464,-5542.02 19464,-5519.03 19464,-5499.05"/>
<polygon fill="black" stroke="black" points="19467.5,-5498.91 19464,-5488.91 19460.5,-5498.91 19467.5,-5498.91"/>
</g>
<!-- l3_attn_stage2_gpu1&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge2738" class="edge">
<title>l3_attn_stage2_gpu1&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19517.28,-5568.3C19531.42,-5561.96 19546.95,-5556.15 19562,-5552.83 19628.57,-5538.14 20724.69,-5565.45 20789,-5542.83 20799.15,-5539.26 20797.96,-5531.69 20808,-5527.83 20858.3,-5508.49 20876.53,-5532.14 20929,-5519.83 20972.2,-5509.7 21018.67,-5489.25 21050.71,-5473.5"/>
<polygon fill="red" stroke="red" points="21052.38,-5476.59 21059.77,-5468.99 21049.25,-5470.32 21052.38,-5476.59"/>
<text text-anchor="middle" x="20839.5" y="-5531.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu2 -->
<g id="node723" class="node">
<title>l3_attn_stage3_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20634" cy="-5451.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20634" y="-5462.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="20634" y="-5447.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20634" y="-5432.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu2&#45;&gt;l3_attn_stage3_gpu2 -->
<g id="edge1139" class="edge">
<title>l3_attn_stage2_gpu2&#45;&gt;l3_attn_stage3_gpu2</title>
<path fill="none" stroke="black" d="M20580.74,-5568.22C20566.89,-5561.96 20551.71,-5556.22 20537,-5552.83 20513.17,-5547.34 20114.09,-5560.32 20097,-5542.83 20092.34,-5538.07 20092.33,-5532.59 20097,-5527.83 20105.56,-5519.11 20525.37,-5523.6 20537,-5519.83 20555.45,-5513.86 20573.49,-5503.1 20588.92,-5491.9"/>
<polygon fill="black" stroke="black" points="20591.32,-5494.47 20597.2,-5485.66 20587.11,-5488.88 20591.32,-5494.47"/>
</g>
<!-- l3_attn_stage2_gpu2&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge2739" class="edge">
<title>l3_attn_stage2_gpu2&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20687.3,-5568.39C20701.44,-5562.05 20716.96,-5556.22 20732,-5552.83 20747.53,-5549.33 21293.84,-5554.19 21305,-5542.83 21345.03,-5502.1 21275.32,-5478.74 21205.01,-5465.99"/>
<polygon fill="red" stroke="red" points="21205.55,-5462.53 21195.1,-5464.27 21204.35,-5469.43 21205.55,-5462.53"/>
<text text-anchor="middle" x="21345.5" y="-5531.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu3 -->
<g id="node724" class="node">
<title>l3_attn_stage3_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="20049" cy="-5451.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20049" y="-5462.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="20049" y="-5447.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="20049" y="-5432.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu3&#45;&gt;l3_attn_stage3_gpu3 -->
<g id="edge1140" class="edge">
<title>l3_attn_stage2_gpu3&#45;&gt;l3_attn_stage3_gpu3</title>
<path fill="none" stroke="black" d="M20049,-5560.74C20049,-5542.02 20049,-5519.03 20049,-5499.05"/>
<polygon fill="black" stroke="black" points="20052.5,-5498.91 20049,-5488.91 20045.5,-5498.91 20052.5,-5498.91"/>
</g>
<!-- l3_attn_stage2_gpu3&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge2740" class="edge">
<title>l3_attn_stage2_gpu3&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20102.29,-5568.33C20116.42,-5561.99 20131.95,-5556.18 20147,-5552.83 20171.41,-5547.41 21025.88,-5556.21 21047,-5542.83 21068.94,-5528.93 21080.24,-5500.65 21085.85,-5479.39"/>
<polygon fill="red" stroke="red" points="21089.27,-5480.14 21088.18,-5469.6 21082.46,-5478.52 21089.27,-5480.14"/>
<text text-anchor="middle" x="21093.5" y="-5531.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu4 -->
<g id="node725" class="node">
<title>l3_attn_stage3_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="18294" cy="-5451.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18294" y="-5462.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="18294" y="-5447.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="18294" y="-5432.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu4&#45;&gt;l3_attn_stage3_gpu4 -->
<g id="edge1141" class="edge">
<title>l3_attn_stage2_gpu4&#45;&gt;l3_attn_stage3_gpu4</title>
<path fill="none" stroke="black" d="M18294,-5560.74C18294,-5542.02 18294,-5519.03 18294,-5499.05"/>
<polygon fill="black" stroke="black" points="18297.5,-5498.91 18294,-5488.91 18290.5,-5498.91 18297.5,-5498.91"/>
</g>
<!-- l3_attn_stage2_gpu4&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge2741" class="edge">
<title>l3_attn_stage2_gpu4&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18346.96,-5568.15C18360.88,-5561.86 18376.17,-5556.11 18391,-5552.83 18442.04,-5541.54 20223.66,-5560.11 20273,-5542.83 20283.15,-5539.28 20281.86,-5531.42 20292,-5527.83 20325.36,-5516.02 20894.34,-5526.99 20929,-5519.83 20972.86,-5510.77 21019.76,-5489.86 21051.75,-5473.7"/>
<polygon fill="red" stroke="red" points="21053.48,-5476.75 21060.77,-5469.07 21050.28,-5470.52 21053.48,-5476.75"/>
<text text-anchor="middle" x="20323.5" y="-5531.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu5 -->
<g id="node726" class="node">
<title>l3_attn_stage3_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="19074" cy="-5451.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19074" y="-5462.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="19074" y="-5447.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="19074" y="-5432.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu5&#45;&gt;l3_attn_stage3_gpu5 -->
<g id="edge1142" class="edge">
<title>l3_attn_stage2_gpu5&#45;&gt;l3_attn_stage3_gpu5</title>
<path fill="none" stroke="black" d="M19074,-5560.74C19074,-5542.02 19074,-5519.03 19074,-5499.05"/>
<polygon fill="black" stroke="black" points="19077.5,-5498.91 19074,-5488.91 19070.5,-5498.91 19077.5,-5498.91"/>
</g>
<!-- l3_attn_stage2_gpu5&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge2742" class="edge">
<title>l3_attn_stage2_gpu5&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19126.96,-5568.17C19140.89,-5561.88 19156.17,-5556.13 19171,-5552.83 19210.21,-5544.13 20579.1,-5556.14 20617,-5542.83 20627.15,-5539.27 20625.89,-5531.5 20636,-5527.83 20666.62,-5516.73 20897.15,-5526.65 20929,-5519.83 20972.66,-5510.48 21019.41,-5489.72 21051.42,-5473.67"/>
<polygon fill="red" stroke="red" points="21053.12,-5476.73 21060.45,-5469.07 21049.95,-5470.49 21053.12,-5476.73"/>
<text text-anchor="middle" x="20667.5" y="-5531.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu6 -->
<g id="node727" class="node">
<title>l3_attn_stage3_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19854" cy="-5451.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19854" y="-5462.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="19854" y="-5447.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19854" y="-5432.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu6&#45;&gt;l3_attn_stage3_gpu6 -->
<g id="edge1143" class="edge">
<title>l3_attn_stage2_gpu6&#45;&gt;l3_attn_stage3_gpu6</title>
<path fill="none" stroke="black" d="M19854,-5560.74C19854,-5542.02 19854,-5519.03 19854,-5499.05"/>
<polygon fill="black" stroke="black" points="19857.5,-5498.91 19854,-5488.91 19850.5,-5498.91 19857.5,-5498.91"/>
</g>
<!-- l3_attn_stage2_gpu6&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge2743" class="edge">
<title>l3_attn_stage2_gpu6&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19907.29,-5568.31C19921.42,-5561.97 19936.95,-5556.17 19952,-5552.83 20006.73,-5540.7 20908.13,-5561.48 20961,-5542.83 20971.15,-5539.25 20971.32,-5534.2 20980,-5527.83 21005.22,-5509.34 21034.5,-5489.49 21056.65,-5474.78"/>
<polygon fill="red" stroke="red" points="21058.66,-5477.65 21065.07,-5469.22 21054.8,-5471.81 21058.66,-5477.65"/>
<text text-anchor="middle" x="21011.5" y="-5531.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu7 -->
<g id="node728" class="node">
<title>l3_attn_stage3_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="18489" cy="-5451.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18489" y="-5462.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="18489" y="-5447.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="18489" y="-5432.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu7&#45;&gt;l3_attn_stage3_gpu7 -->
<g id="edge1144" class="edge">
<title>l3_attn_stage2_gpu7&#45;&gt;l3_attn_stage3_gpu7</title>
<path fill="none" stroke="black" d="M18489,-5560.74C18489,-5542.02 18489,-5519.03 18489,-5499.05"/>
<polygon fill="black" stroke="black" points="18492.5,-5498.91 18489,-5488.91 18485.5,-5498.91 18492.5,-5498.91"/>
</g>
<!-- l3_attn_stage2_gpu7&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge2744" class="edge">
<title>l3_attn_stage2_gpu7&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18541.96,-5568.16C18555.88,-5561.86 18571.17,-5556.12 18586,-5552.83 18634.09,-5542.19 20312.52,-5559.12 20359,-5542.83 20369.15,-5539.28 20367.86,-5531.43 20378,-5527.83 20406.85,-5517.58 20899.02,-5526.05 20929,-5519.83 20972.85,-5510.73 21019.75,-5489.83 21051.75,-5473.68"/>
<polygon fill="red" stroke="red" points="21053.47,-5476.73 21060.77,-5469.05 21050.27,-5470.5 21053.47,-5476.73"/>
<text text-anchor="middle" x="20409.5" y="-5531.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu8 -->
<g id="node729" class="node">
<title>l3_attn_stage3_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20244" cy="-5451.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20244" y="-5462.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="20244" y="-5447.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20244" y="-5432.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu8&#45;&gt;l3_attn_stage3_gpu8 -->
<g id="edge1145" class="edge">
<title>l3_attn_stage2_gpu8&#45;&gt;l3_attn_stage3_gpu8</title>
<path fill="none" stroke="black" d="M20188.85,-5568.87C20175.43,-5562.83 20160.93,-5557.03 20147,-5552.83 20133.22,-5548.68 20092.36,-5553.77 20083,-5542.83 20048.08,-5502.03 20088.79,-5542.15 20147,-5519.83 20164.78,-5513.02 20182.42,-5502.27 20197.68,-5491.34"/>
<polygon fill="black" stroke="black" points="20199.93,-5494.03 20205.9,-5485.27 20195.77,-5488.39 20199.93,-5494.03"/>
</g>
<!-- l3_attn_stage2_gpu8&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge2745" class="edge">
<title>l3_attn_stage2_gpu8&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20297.29,-5568.34C20311.43,-5562 20326.95,-5556.19 20342,-5552.83 20363.45,-5548.05 21117.56,-5558.47 21133,-5542.83 21151.16,-5524.44 21133.89,-5496.75 21116.31,-5476.84"/>
<polygon fill="red" stroke="red" points="21118.75,-5474.32 21109.38,-5469.37 21113.61,-5479.08 21118.75,-5474.32"/>
<text text-anchor="middle" x="21171.5" y="-5531.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu9 -->
<g id="node730" class="node">
<title>l3_attn_stage3_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="19659" cy="-5451.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19659" y="-5462.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="19659" y="-5447.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="19659" y="-5432.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu9&#45;&gt;l3_attn_stage3_gpu9 -->
<g id="edge1146" class="edge">
<title>l3_attn_stage2_gpu9&#45;&gt;l3_attn_stage3_gpu9</title>
<path fill="none" stroke="black" d="M19659,-5560.74C19659,-5542.02 19659,-5519.03 19659,-5499.05"/>
<polygon fill="black" stroke="black" points="19662.5,-5498.91 19659,-5488.91 19655.5,-5498.91 19662.5,-5498.91"/>
</g>
<!-- l3_attn_stage2_gpu9&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge2746" class="edge">
<title>l3_attn_stage2_gpu9&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19712.28,-5568.3C19726.42,-5561.97 19741.95,-5556.16 19757,-5552.83 19817.65,-5539.42 20816.41,-5563.47 20875,-5542.83 20885.15,-5539.26 20884.3,-5532.48 20894,-5527.83 20908.39,-5520.94 20913.8,-5524.7 20929,-5519.83 20969.94,-5506.73 21014.95,-5487.57 21047.12,-5473.01"/>
<polygon fill="red" stroke="red" points="21048.61,-5476.18 21056.25,-5468.84 21045.7,-5469.81 21048.61,-5476.18"/>
<text text-anchor="middle" x="20925.5" y="-5531.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu10 -->
<g id="node731" class="node">
<title>l3_attn_stage3_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="17904" cy="-5451.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="17904" y="-5462.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="17904" y="-5447.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17904" y="-5432.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu10&#45;&gt;l3_attn_stage3_gpu10 -->
<g id="edge1147" class="edge">
<title>l3_attn_stage2_gpu10&#45;&gt;l3_attn_stage3_gpu10</title>
<path fill="none" stroke="black" d="M17904,-5560.74C17904,-5542.02 17904,-5519.03 17904,-5499.05"/>
<polygon fill="black" stroke="black" points="17907.5,-5498.91 17904,-5488.91 17900.5,-5498.91 17907.5,-5498.91"/>
</g>
<!-- l3_attn_stage2_gpu10&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge2747" class="edge">
<title>l3_attn_stage2_gpu10&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17956.97,-5568.22C17970.9,-5561.92 17986.18,-5556.16 18001,-5552.83 18230.74,-5501.23 19884.55,-5530.39 20120,-5527.83 20164.94,-5527.35 20884.97,-5528.87 20929,-5519.83 20972.87,-5510.83 21019.77,-5489.91 21051.76,-5473.73"/>
<polygon fill="red" stroke="red" points="21053.49,-5476.78 21060.78,-5469.09 21050.28,-5470.55 21053.49,-5476.78"/>
<text text-anchor="middle" x="20151.5" y="-5531.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu11 -->
<g id="node732" class="node">
<title>l3_attn_stage3_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="18684" cy="-5451.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18684" y="-5462.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="18684" y="-5447.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18684" y="-5432.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu11&#45;&gt;l3_attn_stage3_gpu11 -->
<g id="edge1148" class="edge">
<title>l3_attn_stage2_gpu11&#45;&gt;l3_attn_stage3_gpu11</title>
<path fill="none" stroke="black" d="M18684,-5560.74C18684,-5542.02 18684,-5519.03 18684,-5499.05"/>
<polygon fill="black" stroke="black" points="18687.5,-5498.91 18684,-5488.91 18680.5,-5498.91 18687.5,-5498.91"/>
</g>
<!-- l3_attn_stage2_gpu11&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge2748" class="edge">
<title>l3_attn_stage2_gpu11&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18736.96,-5568.16C18750.88,-5561.87 18766.17,-5556.12 18781,-5552.83 18826.13,-5542.83 20401.38,-5558.12 20445,-5542.83 20455.15,-5539.27 20453.87,-5531.45 20464,-5527.83 20512.67,-5510.47 20878.42,-5530.4 20929,-5519.83 20972.84,-5510.67 21019.74,-5489.78 21051.74,-5473.64"/>
<polygon fill="red" stroke="red" points="21053.46,-5476.7 21060.76,-5469.02 21050.27,-5470.47 21053.46,-5476.7"/>
<text text-anchor="middle" x="20495.5" y="-5531.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu12 -->
<g id="node733" class="node">
<title>l3_attn_stage3_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="18099" cy="-5451.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18099" y="-5462.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="18099" y="-5447.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18099" y="-5432.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu12&#45;&gt;l3_attn_stage3_gpu12 -->
<g id="edge1149" class="edge">
<title>l3_attn_stage2_gpu12&#45;&gt;l3_attn_stage3_gpu12</title>
<path fill="none" stroke="black" d="M18099,-5560.74C18099,-5542.02 18099,-5519.03 18099,-5499.05"/>
<polygon fill="black" stroke="black" points="18102.5,-5498.91 18099,-5488.91 18095.5,-5498.91 18102.5,-5498.91"/>
</g>
<!-- l3_attn_stage2_gpu12&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge2749" class="edge">
<title>l3_attn_stage2_gpu12&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18151.96,-5568.15C18165.88,-5561.86 18181.17,-5556.11 18196,-5552.83 18250,-5540.89 20134.8,-5561.1 20187,-5542.83 20197.15,-5539.28 20195.86,-5531.42 20206,-5527.83 20243.87,-5514.45 20889.66,-5527.93 20929,-5519.83 20972.87,-5510.81 21019.77,-5489.89 21051.76,-5473.72"/>
<polygon fill="red" stroke="red" points="21053.48,-5476.77 21060.78,-5469.08 21050.28,-5470.54 21053.48,-5476.77"/>
<text text-anchor="middle" x="20237.5" y="-5531.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu13 -->
<g id="node734" class="node">
<title>l3_attn_stage3_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="18879" cy="-5451.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18879" y="-5462.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="18879" y="-5447.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18879" y="-5432.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu13&#45;&gt;l3_attn_stage3_gpu13 -->
<g id="edge1150" class="edge">
<title>l3_attn_stage2_gpu13&#45;&gt;l3_attn_stage3_gpu13</title>
<path fill="none" stroke="black" d="M18879,-5560.74C18879,-5542.02 18879,-5519.03 18879,-5499.05"/>
<polygon fill="black" stroke="black" points="18882.5,-5498.91 18879,-5488.91 18875.5,-5498.91 18882.5,-5498.91"/>
</g>
<!-- l3_attn_stage2_gpu13&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge2750" class="edge">
<title>l3_attn_stage2_gpu13&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18931.96,-5568.16C18945.89,-5561.87 18961.17,-5556.12 18976,-5552.83 19018.17,-5543.48 20490.24,-5557.13 20531,-5542.83 20541.15,-5539.27 20539.87,-5531.47 20550,-5527.83 20589.64,-5513.6 20887.79,-5528.53 20929,-5519.83 20972.82,-5510.59 21019.73,-5489.7 21051.73,-5473.6"/>
<polygon fill="red" stroke="red" points="21053.45,-5476.65 21060.75,-5468.98 21050.26,-5470.42 21053.45,-5476.65"/>
<text text-anchor="middle" x="20581.5" y="-5531.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu14 -->
<g id="node735" class="node">
<title>l3_attn_stage3_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19269" cy="-5451.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19269" y="-5462.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="19269" y="-5447.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19269" y="-5432.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu14&#45;&gt;l3_attn_stage3_gpu14 -->
<g id="edge1151" class="edge">
<title>l3_attn_stage2_gpu14&#45;&gt;l3_attn_stage3_gpu14</title>
<path fill="none" stroke="black" d="M19269,-5560.74C19269,-5542.02 19269,-5519.03 19269,-5499.05"/>
<polygon fill="black" stroke="black" points="19272.5,-5498.91 19269,-5488.91 19265.5,-5498.91 19272.5,-5498.91"/>
</g>
<!-- l3_attn_stage2_gpu14&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge2751" class="edge">
<title>l3_attn_stage2_gpu14&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19322.28,-5568.29C19336.42,-5561.95 19351.95,-5556.15 19367,-5552.83 19403.24,-5544.85 20667.99,-5555.14 20703,-5542.83 20713.15,-5539.27 20711.91,-5531.56 20722,-5527.83 20765.19,-5511.9 20884.04,-5529.73 20929,-5519.83 20972.6,-5510.23 21019.37,-5489.51 21051.39,-5473.54"/>
<polygon fill="red" stroke="red" points="21053.08,-5476.6 21060.42,-5468.96 21049.92,-5470.36 21053.08,-5476.6"/>
<text text-anchor="middle" x="20753.5" y="-5531.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu15 -->
<g id="node736" class="node">
<title>l3_attn_stage3_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20439" cy="-5451.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20439" y="-5462.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="20439" y="-5447.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20439" y="-5432.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu15&#45;&gt;l3_attn_stage3_gpu15 -->
<g id="edge1152" class="edge">
<title>l3_attn_stage2_gpu15&#45;&gt;l3_attn_stage3_gpu15</title>
<path fill="none" stroke="black" d="M20385.7,-5568.39C20371.85,-5562.13 20356.69,-5556.35 20342,-5552.83 20328.37,-5549.57 20099.71,-5552.93 20090,-5542.83 20085.38,-5538.03 20085.36,-5532.62 20090,-5527.83 20099.75,-5517.77 20328.7,-5524.24 20342,-5519.83 20360.4,-5513.74 20378.44,-5502.94 20393.87,-5491.75"/>
<polygon fill="black" stroke="black" points="20396.27,-5494.33 20402.16,-5485.52 20392.06,-5488.73 20396.27,-5494.33"/>
</g>
<!-- l3_attn_stage2_gpu15&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge2752" class="edge">
<title>l3_attn_stage2_gpu15&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20492.3,-5568.36C20506.43,-5562.02 20521.96,-5556.2 20537,-5552.83 20555.49,-5548.69 21205.7,-5556.33 21219,-5542.83 21247.36,-5514.06 21199.79,-5488.22 21154.82,-5471.6"/>
<polygon fill="red" stroke="red" points="21155.88,-5468.26 21145.29,-5468.19 21153.53,-5474.85 21155.88,-5468.26"/>
<text text-anchor="middle" x="21258.5" y="-5531.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu0 -->
<g id="node737" class="node">
<title>l3_attn_stage4_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20829" cy="-5304.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20829" y="-5315.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="20829" y="-5300.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20829" y="-5285.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu0&#45;&gt;l3_attn_stage4_gpu0 -->
<g id="edge1153" class="edge">
<title>l3_attn_stage3_gpu0&#45;&gt;l3_attn_stage4_gpu0</title>
<path fill="none" stroke="black" d="M20776.02,-5421.26C20762.09,-5414.97 20746.82,-5409.19 20732,-5405.83 20714.99,-5401.97 20116.24,-5408.27 20104,-5395.83 20099.32,-5391.08 20099.32,-5385.58 20104,-5380.83 20116.26,-5368.42 20715.39,-5378.16 20732,-5372.83 20750.46,-5366.91 20768.51,-5356.16 20783.94,-5344.96"/>
<polygon fill="black" stroke="black" points="20786.34,-5347.53 20792.22,-5338.72 20782.13,-5341.94 20786.34,-5347.53"/>
</g>
<!-- l3_attn_stage4_gpu[next_gpu] -->
<g id="node1378" class="node">
<title>l3_attn_stage4_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="21091" cy="-5304.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="21091" y="-5300.63" font-family="Times,serif" font-size="14.00">l3_attn_stage4_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage3_gpu0&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge2753" class="edge">
<title>l3_attn_stage3_gpu0&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20884.38,-5422.02C20899.74,-5415.45 20916.68,-5409.36 20933,-5405.83 20957.87,-5400.45 21373.2,-5414.02 21391,-5395.83 21445.67,-5339.96 21344.45,-5318.3 21245.12,-5310.04"/>
<polygon fill="red" stroke="red" points="21245.15,-5306.53 21234.9,-5309.24 21244.6,-5313.51 21245.15,-5306.53"/>
<text text-anchor="middle" x="21431.5" y="-5384.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu1 -->
<g id="node738" class="node">
<title>l3_attn_stage4_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19464" cy="-5304.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19464" y="-5315.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="19464" y="-5300.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19464" y="-5285.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu1&#45;&gt;l3_attn_stage4_gpu1 -->
<g id="edge1154" class="edge">
<title>l3_attn_stage3_gpu1&#45;&gt;l3_attn_stage4_gpu1</title>
<path fill="none" stroke="black" d="M19464,-5413.74C19464,-5395.02 19464,-5372.03 19464,-5352.05"/>
<polygon fill="black" stroke="black" points="19467.5,-5351.91 19464,-5341.91 19460.5,-5351.91 19467.5,-5351.91"/>
</g>
<!-- l3_attn_stage3_gpu1&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge2754" class="edge">
<title>l3_attn_stage3_gpu1&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19517.28,-5421.3C19531.42,-5414.96 19546.95,-5409.15 19562,-5405.83 19628.57,-5391.14 20724.69,-5418.45 20789,-5395.83 20799.15,-5392.26 20797.96,-5384.69 20808,-5380.83 20858.3,-5361.49 20876.53,-5385.14 20929,-5372.83 20972.2,-5362.7 21018.67,-5342.25 21050.71,-5326.5"/>
<polygon fill="red" stroke="red" points="21052.38,-5329.59 21059.77,-5321.99 21049.25,-5323.32 21052.38,-5329.59"/>
<text text-anchor="middle" x="20839.5" y="-5384.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu2 -->
<g id="node739" class="node">
<title>l3_attn_stage4_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20634" cy="-5304.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20634" y="-5315.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="20634" y="-5300.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20634" y="-5285.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu2&#45;&gt;l3_attn_stage4_gpu2 -->
<g id="edge1155" class="edge">
<title>l3_attn_stage3_gpu2&#45;&gt;l3_attn_stage4_gpu2</title>
<path fill="none" stroke="black" d="M20580.74,-5421.22C20566.89,-5414.96 20551.71,-5409.22 20537,-5405.83 20513.17,-5400.34 20114.09,-5413.32 20097,-5395.83 20092.34,-5391.07 20092.33,-5385.59 20097,-5380.83 20105.56,-5372.11 20525.37,-5376.6 20537,-5372.83 20555.45,-5366.86 20573.49,-5356.1 20588.92,-5344.9"/>
<polygon fill="black" stroke="black" points="20591.32,-5347.47 20597.2,-5338.66 20587.11,-5341.88 20591.32,-5347.47"/>
</g>
<!-- l3_attn_stage3_gpu2&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge2755" class="edge">
<title>l3_attn_stage3_gpu2&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20687.3,-5421.39C20701.44,-5415.05 20716.96,-5409.22 20732,-5405.83 20747.53,-5402.33 21293.84,-5407.19 21305,-5395.83 21345.03,-5355.1 21275.32,-5331.74 21205.01,-5318.99"/>
<polygon fill="red" stroke="red" points="21205.55,-5315.53 21195.1,-5317.27 21204.35,-5322.43 21205.55,-5315.53"/>
<text text-anchor="middle" x="21345.5" y="-5384.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu3 -->
<g id="node740" class="node">
<title>l3_attn_stage4_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="20049" cy="-5304.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20049" y="-5315.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="20049" y="-5300.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="20049" y="-5285.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu3&#45;&gt;l3_attn_stage4_gpu3 -->
<g id="edge1156" class="edge">
<title>l3_attn_stage3_gpu3&#45;&gt;l3_attn_stage4_gpu3</title>
<path fill="none" stroke="black" d="M20049,-5413.74C20049,-5395.02 20049,-5372.03 20049,-5352.05"/>
<polygon fill="black" stroke="black" points="20052.5,-5351.91 20049,-5341.91 20045.5,-5351.91 20052.5,-5351.91"/>
</g>
<!-- l3_attn_stage3_gpu3&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge2756" class="edge">
<title>l3_attn_stage3_gpu3&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20102.29,-5421.33C20116.42,-5414.99 20131.95,-5409.18 20147,-5405.83 20171.41,-5400.41 21025.88,-5409.21 21047,-5395.83 21068.94,-5381.93 21080.24,-5353.65 21085.85,-5332.39"/>
<polygon fill="red" stroke="red" points="21089.27,-5333.14 21088.18,-5322.6 21082.46,-5331.52 21089.27,-5333.14"/>
<text text-anchor="middle" x="21093.5" y="-5384.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu4 -->
<g id="node741" class="node">
<title>l3_attn_stage4_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="18294" cy="-5304.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18294" y="-5315.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="18294" y="-5300.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="18294" y="-5285.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu4&#45;&gt;l3_attn_stage4_gpu4 -->
<g id="edge1157" class="edge">
<title>l3_attn_stage3_gpu4&#45;&gt;l3_attn_stage4_gpu4</title>
<path fill="none" stroke="black" d="M18294,-5413.74C18294,-5395.02 18294,-5372.03 18294,-5352.05"/>
<polygon fill="black" stroke="black" points="18297.5,-5351.91 18294,-5341.91 18290.5,-5351.91 18297.5,-5351.91"/>
</g>
<!-- l3_attn_stage3_gpu4&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge2757" class="edge">
<title>l3_attn_stage3_gpu4&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18346.96,-5421.15C18360.88,-5414.86 18376.17,-5409.11 18391,-5405.83 18442.04,-5394.54 20223.66,-5413.11 20273,-5395.83 20283.15,-5392.28 20281.86,-5384.42 20292,-5380.83 20325.36,-5369.02 20894.34,-5379.99 20929,-5372.83 20972.86,-5363.77 21019.76,-5342.86 21051.75,-5326.7"/>
<polygon fill="red" stroke="red" points="21053.48,-5329.75 21060.77,-5322.07 21050.28,-5323.52 21053.48,-5329.75"/>
<text text-anchor="middle" x="20323.5" y="-5384.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu5 -->
<g id="node742" class="node">
<title>l3_attn_stage4_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="19074" cy="-5304.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19074" y="-5315.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="19074" y="-5300.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="19074" y="-5285.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu5&#45;&gt;l3_attn_stage4_gpu5 -->
<g id="edge1158" class="edge">
<title>l3_attn_stage3_gpu5&#45;&gt;l3_attn_stage4_gpu5</title>
<path fill="none" stroke="black" d="M19074,-5413.74C19074,-5395.02 19074,-5372.03 19074,-5352.05"/>
<polygon fill="black" stroke="black" points="19077.5,-5351.91 19074,-5341.91 19070.5,-5351.91 19077.5,-5351.91"/>
</g>
<!-- l3_attn_stage3_gpu5&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge2758" class="edge">
<title>l3_attn_stage3_gpu5&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19126.96,-5421.17C19140.89,-5414.88 19156.17,-5409.13 19171,-5405.83 19210.21,-5397.13 20579.1,-5409.14 20617,-5395.83 20627.15,-5392.27 20625.89,-5384.5 20636,-5380.83 20666.62,-5369.73 20897.15,-5379.65 20929,-5372.83 20972.66,-5363.48 21019.41,-5342.72 21051.42,-5326.67"/>
<polygon fill="red" stroke="red" points="21053.12,-5329.73 21060.45,-5322.07 21049.95,-5323.49 21053.12,-5329.73"/>
<text text-anchor="middle" x="20667.5" y="-5384.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu6 -->
<g id="node743" class="node">
<title>l3_attn_stage4_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19854" cy="-5304.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19854" y="-5315.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="19854" y="-5300.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19854" y="-5285.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu6&#45;&gt;l3_attn_stage4_gpu6 -->
<g id="edge1159" class="edge">
<title>l3_attn_stage3_gpu6&#45;&gt;l3_attn_stage4_gpu6</title>
<path fill="none" stroke="black" d="M19854,-5413.74C19854,-5395.02 19854,-5372.03 19854,-5352.05"/>
<polygon fill="black" stroke="black" points="19857.5,-5351.91 19854,-5341.91 19850.5,-5351.91 19857.5,-5351.91"/>
</g>
<!-- l3_attn_stage3_gpu6&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge2759" class="edge">
<title>l3_attn_stage3_gpu6&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19907.29,-5421.31C19921.42,-5414.97 19936.95,-5409.17 19952,-5405.83 20006.73,-5393.7 20908.13,-5414.48 20961,-5395.83 20971.15,-5392.25 20971.32,-5387.2 20980,-5380.83 21005.22,-5362.34 21034.5,-5342.49 21056.65,-5327.78"/>
<polygon fill="red" stroke="red" points="21058.66,-5330.65 21065.07,-5322.22 21054.8,-5324.81 21058.66,-5330.65"/>
<text text-anchor="middle" x="21011.5" y="-5384.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu7 -->
<g id="node744" class="node">
<title>l3_attn_stage4_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="18489" cy="-5304.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18489" y="-5315.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="18489" y="-5300.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="18489" y="-5285.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu7&#45;&gt;l3_attn_stage4_gpu7 -->
<g id="edge1160" class="edge">
<title>l3_attn_stage3_gpu7&#45;&gt;l3_attn_stage4_gpu7</title>
<path fill="none" stroke="black" d="M18489,-5413.74C18489,-5395.02 18489,-5372.03 18489,-5352.05"/>
<polygon fill="black" stroke="black" points="18492.5,-5351.91 18489,-5341.91 18485.5,-5351.91 18492.5,-5351.91"/>
</g>
<!-- l3_attn_stage3_gpu7&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge2760" class="edge">
<title>l3_attn_stage3_gpu7&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18541.96,-5421.16C18555.88,-5414.86 18571.17,-5409.12 18586,-5405.83 18634.09,-5395.19 20312.52,-5412.12 20359,-5395.83 20369.15,-5392.28 20367.86,-5384.43 20378,-5380.83 20406.85,-5370.58 20899.02,-5379.05 20929,-5372.83 20972.85,-5363.73 21019.75,-5342.83 21051.75,-5326.68"/>
<polygon fill="red" stroke="red" points="21053.47,-5329.73 21060.77,-5322.05 21050.27,-5323.5 21053.47,-5329.73"/>
<text text-anchor="middle" x="20409.5" y="-5384.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu8 -->
<g id="node745" class="node">
<title>l3_attn_stage4_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20244" cy="-5304.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20244" y="-5315.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="20244" y="-5300.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20244" y="-5285.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu8&#45;&gt;l3_attn_stage4_gpu8 -->
<g id="edge1161" class="edge">
<title>l3_attn_stage3_gpu8&#45;&gt;l3_attn_stage4_gpu8</title>
<path fill="none" stroke="black" d="M20188.85,-5421.87C20175.43,-5415.83 20160.93,-5410.03 20147,-5405.83 20133.22,-5401.68 20092.36,-5406.77 20083,-5395.83 20048.08,-5355.03 20088.79,-5395.15 20147,-5372.83 20164.78,-5366.02 20182.42,-5355.27 20197.68,-5344.34"/>
<polygon fill="black" stroke="black" points="20199.93,-5347.03 20205.9,-5338.27 20195.77,-5341.39 20199.93,-5347.03"/>
</g>
<!-- l3_attn_stage3_gpu8&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge2761" class="edge">
<title>l3_attn_stage3_gpu8&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20297.29,-5421.34C20311.43,-5415 20326.95,-5409.19 20342,-5405.83 20363.45,-5401.05 21117.56,-5411.47 21133,-5395.83 21151.16,-5377.44 21133.89,-5349.75 21116.31,-5329.84"/>
<polygon fill="red" stroke="red" points="21118.75,-5327.32 21109.38,-5322.37 21113.61,-5332.08 21118.75,-5327.32"/>
<text text-anchor="middle" x="21171.5" y="-5384.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu9 -->
<g id="node746" class="node">
<title>l3_attn_stage4_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="19659" cy="-5304.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19659" y="-5315.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="19659" y="-5300.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="19659" y="-5285.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu9&#45;&gt;l3_attn_stage4_gpu9 -->
<g id="edge1162" class="edge">
<title>l3_attn_stage3_gpu9&#45;&gt;l3_attn_stage4_gpu9</title>
<path fill="none" stroke="black" d="M19659,-5413.74C19659,-5395.02 19659,-5372.03 19659,-5352.05"/>
<polygon fill="black" stroke="black" points="19662.5,-5351.91 19659,-5341.91 19655.5,-5351.91 19662.5,-5351.91"/>
</g>
<!-- l3_attn_stage3_gpu9&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge2762" class="edge">
<title>l3_attn_stage3_gpu9&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19712.28,-5421.3C19726.42,-5414.97 19741.95,-5409.16 19757,-5405.83 19817.65,-5392.42 20816.41,-5416.47 20875,-5395.83 20885.15,-5392.26 20884.3,-5385.48 20894,-5380.83 20908.39,-5373.94 20913.8,-5377.7 20929,-5372.83 20969.94,-5359.73 21014.95,-5340.57 21047.12,-5326.01"/>
<polygon fill="red" stroke="red" points="21048.61,-5329.18 21056.25,-5321.84 21045.7,-5322.81 21048.61,-5329.18"/>
<text text-anchor="middle" x="20925.5" y="-5384.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu10 -->
<g id="node747" class="node">
<title>l3_attn_stage4_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="17904" cy="-5304.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="17904" y="-5315.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="17904" y="-5300.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17904" y="-5285.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu10&#45;&gt;l3_attn_stage4_gpu10 -->
<g id="edge1163" class="edge">
<title>l3_attn_stage3_gpu10&#45;&gt;l3_attn_stage4_gpu10</title>
<path fill="none" stroke="black" d="M17904,-5413.74C17904,-5395.02 17904,-5372.03 17904,-5352.05"/>
<polygon fill="black" stroke="black" points="17907.5,-5351.91 17904,-5341.91 17900.5,-5351.91 17907.5,-5351.91"/>
</g>
<!-- l3_attn_stage3_gpu10&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge2763" class="edge">
<title>l3_attn_stage3_gpu10&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17956.97,-5421.22C17970.9,-5414.92 17986.18,-5409.16 18001,-5405.83 18230.74,-5354.23 19884.55,-5383.39 20120,-5380.83 20164.94,-5380.35 20884.97,-5381.87 20929,-5372.83 20972.87,-5363.83 21019.77,-5342.91 21051.76,-5326.73"/>
<polygon fill="red" stroke="red" points="21053.49,-5329.78 21060.78,-5322.09 21050.28,-5323.55 21053.49,-5329.78"/>
<text text-anchor="middle" x="20151.5" y="-5384.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu11 -->
<g id="node748" class="node">
<title>l3_attn_stage4_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="18684" cy="-5304.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18684" y="-5315.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="18684" y="-5300.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18684" y="-5285.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu11&#45;&gt;l3_attn_stage4_gpu11 -->
<g id="edge1164" class="edge">
<title>l3_attn_stage3_gpu11&#45;&gt;l3_attn_stage4_gpu11</title>
<path fill="none" stroke="black" d="M18684,-5413.74C18684,-5395.02 18684,-5372.03 18684,-5352.05"/>
<polygon fill="black" stroke="black" points="18687.5,-5351.91 18684,-5341.91 18680.5,-5351.91 18687.5,-5351.91"/>
</g>
<!-- l3_attn_stage3_gpu11&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge2764" class="edge">
<title>l3_attn_stage3_gpu11&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18736.96,-5421.16C18750.88,-5414.87 18766.17,-5409.12 18781,-5405.83 18826.13,-5395.83 20401.38,-5411.12 20445,-5395.83 20455.15,-5392.27 20453.87,-5384.45 20464,-5380.83 20512.67,-5363.47 20878.42,-5383.4 20929,-5372.83 20972.84,-5363.67 21019.74,-5342.78 21051.74,-5326.64"/>
<polygon fill="red" stroke="red" points="21053.46,-5329.7 21060.76,-5322.02 21050.27,-5323.47 21053.46,-5329.7"/>
<text text-anchor="middle" x="20495.5" y="-5384.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu12 -->
<g id="node749" class="node">
<title>l3_attn_stage4_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="18099" cy="-5304.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18099" y="-5315.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="18099" y="-5300.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18099" y="-5285.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu12&#45;&gt;l3_attn_stage4_gpu12 -->
<g id="edge1165" class="edge">
<title>l3_attn_stage3_gpu12&#45;&gt;l3_attn_stage4_gpu12</title>
<path fill="none" stroke="black" d="M18099,-5413.74C18099,-5395.02 18099,-5372.03 18099,-5352.05"/>
<polygon fill="black" stroke="black" points="18102.5,-5351.91 18099,-5341.91 18095.5,-5351.91 18102.5,-5351.91"/>
</g>
<!-- l3_attn_stage3_gpu12&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge2765" class="edge">
<title>l3_attn_stage3_gpu12&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18151.96,-5421.15C18165.88,-5414.86 18181.17,-5409.11 18196,-5405.83 18250,-5393.89 20134.8,-5414.1 20187,-5395.83 20197.15,-5392.28 20195.86,-5384.42 20206,-5380.83 20243.87,-5367.45 20889.66,-5380.93 20929,-5372.83 20972.87,-5363.81 21019.77,-5342.89 21051.76,-5326.72"/>
<polygon fill="red" stroke="red" points="21053.48,-5329.77 21060.78,-5322.08 21050.28,-5323.54 21053.48,-5329.77"/>
<text text-anchor="middle" x="20237.5" y="-5384.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu13 -->
<g id="node750" class="node">
<title>l3_attn_stage4_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="18879" cy="-5304.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18879" y="-5315.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="18879" y="-5300.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18879" y="-5285.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu13&#45;&gt;l3_attn_stage4_gpu13 -->
<g id="edge1166" class="edge">
<title>l3_attn_stage3_gpu13&#45;&gt;l3_attn_stage4_gpu13</title>
<path fill="none" stroke="black" d="M18879,-5413.74C18879,-5395.02 18879,-5372.03 18879,-5352.05"/>
<polygon fill="black" stroke="black" points="18882.5,-5351.91 18879,-5341.91 18875.5,-5351.91 18882.5,-5351.91"/>
</g>
<!-- l3_attn_stage3_gpu13&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge2766" class="edge">
<title>l3_attn_stage3_gpu13&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18931.96,-5421.16C18945.89,-5414.87 18961.17,-5409.12 18976,-5405.83 19018.17,-5396.48 20490.24,-5410.13 20531,-5395.83 20541.15,-5392.27 20539.87,-5384.47 20550,-5380.83 20589.64,-5366.6 20887.79,-5381.53 20929,-5372.83 20972.82,-5363.59 21019.73,-5342.7 21051.73,-5326.6"/>
<polygon fill="red" stroke="red" points="21053.45,-5329.65 21060.75,-5321.98 21050.26,-5323.42 21053.45,-5329.65"/>
<text text-anchor="middle" x="20581.5" y="-5384.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu14 -->
<g id="node751" class="node">
<title>l3_attn_stage4_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19269" cy="-5304.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19269" y="-5315.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="19269" y="-5300.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19269" y="-5285.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu14&#45;&gt;l3_attn_stage4_gpu14 -->
<g id="edge1167" class="edge">
<title>l3_attn_stage3_gpu14&#45;&gt;l3_attn_stage4_gpu14</title>
<path fill="none" stroke="black" d="M19269,-5413.74C19269,-5395.02 19269,-5372.03 19269,-5352.05"/>
<polygon fill="black" stroke="black" points="19272.5,-5351.91 19269,-5341.91 19265.5,-5351.91 19272.5,-5351.91"/>
</g>
<!-- l3_attn_stage3_gpu14&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge2767" class="edge">
<title>l3_attn_stage3_gpu14&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19322.28,-5421.29C19336.42,-5414.95 19351.95,-5409.15 19367,-5405.83 19403.24,-5397.85 20667.99,-5408.14 20703,-5395.83 20713.15,-5392.27 20711.91,-5384.56 20722,-5380.83 20765.19,-5364.9 20884.04,-5382.73 20929,-5372.83 20972.6,-5363.23 21019.37,-5342.51 21051.39,-5326.54"/>
<polygon fill="red" stroke="red" points="21053.08,-5329.6 21060.42,-5321.96 21049.92,-5323.36 21053.08,-5329.6"/>
<text text-anchor="middle" x="20753.5" y="-5384.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu15 -->
<g id="node752" class="node">
<title>l3_attn_stage4_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20439" cy="-5304.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20439" y="-5315.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="20439" y="-5300.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20439" y="-5285.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu15&#45;&gt;l3_attn_stage4_gpu15 -->
<g id="edge1168" class="edge">
<title>l3_attn_stage3_gpu15&#45;&gt;l3_attn_stage4_gpu15</title>
<path fill="none" stroke="black" d="M20385.7,-5421.39C20371.85,-5415.13 20356.69,-5409.35 20342,-5405.83 20328.37,-5402.57 20099.71,-5405.93 20090,-5395.83 20085.38,-5391.03 20085.36,-5385.62 20090,-5380.83 20099.75,-5370.77 20328.7,-5377.24 20342,-5372.83 20360.4,-5366.74 20378.44,-5355.94 20393.87,-5344.75"/>
<polygon fill="black" stroke="black" points="20396.27,-5347.33 20402.16,-5338.52 20392.06,-5341.73 20396.27,-5347.33"/>
</g>
<!-- l3_attn_stage3_gpu15&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge2768" class="edge">
<title>l3_attn_stage3_gpu15&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20492.3,-5421.36C20506.43,-5415.02 20521.96,-5409.2 20537,-5405.83 20555.49,-5401.69 21205.7,-5409.33 21219,-5395.83 21247.36,-5367.06 21199.79,-5341.22 21154.82,-5324.6"/>
<polygon fill="red" stroke="red" points="21155.88,-5321.26 21145.29,-5321.19 21153.53,-5327.85 21155.88,-5321.26"/>
<text text-anchor="middle" x="21258.5" y="-5384.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu0 -->
<g id="node753" class="node">
<title>l3_attn_stage5_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20829" cy="-5157.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20829" y="-5168.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="20829" y="-5153.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20829" y="-5138.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu0&#45;&gt;l3_attn_stage5_gpu0 -->
<g id="edge1169" class="edge">
<title>l3_attn_stage4_gpu0&#45;&gt;l3_attn_stage5_gpu0</title>
<path fill="none" stroke="black" d="M20776.02,-5274.26C20762.09,-5267.97 20746.82,-5262.19 20732,-5258.83 20714.99,-5254.97 20116.24,-5261.27 20104,-5248.83 20099.32,-5244.08 20099.32,-5238.58 20104,-5233.83 20116.26,-5221.42 20715.39,-5231.16 20732,-5225.83 20750.46,-5219.91 20768.51,-5209.16 20783.94,-5197.96"/>
<polygon fill="black" stroke="black" points="20786.34,-5200.53 20792.22,-5191.72 20782.13,-5194.94 20786.34,-5200.53"/>
</g>
<!-- l3_attn_stage5_gpu[next_gpu] -->
<g id="node1379" class="node">
<title>l3_attn_stage5_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="21091" cy="-5157.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="21091" y="-5153.63" font-family="Times,serif" font-size="14.00">l3_attn_stage5_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage4_gpu0&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge2769" class="edge">
<title>l3_attn_stage4_gpu0&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20884.38,-5275.02C20899.74,-5268.45 20916.68,-5262.36 20933,-5258.83 20957.87,-5253.45 21373.2,-5267.02 21391,-5248.83 21445.67,-5192.96 21344.45,-5171.3 21245.12,-5163.04"/>
<polygon fill="red" stroke="red" points="21245.15,-5159.53 21234.9,-5162.24 21244.6,-5166.51 21245.15,-5159.53"/>
<text text-anchor="middle" x="21431.5" y="-5237.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu1 -->
<g id="node754" class="node">
<title>l3_attn_stage5_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19464" cy="-5157.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19464" y="-5168.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="19464" y="-5153.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19464" y="-5138.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu1&#45;&gt;l3_attn_stage5_gpu1 -->
<g id="edge1170" class="edge">
<title>l3_attn_stage4_gpu1&#45;&gt;l3_attn_stage5_gpu1</title>
<path fill="none" stroke="black" d="M19464,-5266.74C19464,-5248.02 19464,-5225.03 19464,-5205.05"/>
<polygon fill="black" stroke="black" points="19467.5,-5204.91 19464,-5194.91 19460.5,-5204.91 19467.5,-5204.91"/>
</g>
<!-- l3_attn_stage4_gpu1&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge2770" class="edge">
<title>l3_attn_stage4_gpu1&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19517.28,-5274.3C19531.42,-5267.96 19546.95,-5262.15 19562,-5258.83 19628.57,-5244.14 20724.69,-5271.45 20789,-5248.83 20799.15,-5245.26 20797.96,-5237.69 20808,-5233.83 20858.3,-5214.49 20876.53,-5238.14 20929,-5225.83 20972.2,-5215.7 21018.67,-5195.25 21050.71,-5179.5"/>
<polygon fill="red" stroke="red" points="21052.38,-5182.59 21059.77,-5174.99 21049.25,-5176.32 21052.38,-5182.59"/>
<text text-anchor="middle" x="20839.5" y="-5237.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu2 -->
<g id="node755" class="node">
<title>l3_attn_stage5_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20634" cy="-5157.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20634" y="-5168.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="20634" y="-5153.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20634" y="-5138.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu2&#45;&gt;l3_attn_stage5_gpu2 -->
<g id="edge1171" class="edge">
<title>l3_attn_stage4_gpu2&#45;&gt;l3_attn_stage5_gpu2</title>
<path fill="none" stroke="black" d="M20580.74,-5274.22C20566.89,-5267.96 20551.71,-5262.22 20537,-5258.83 20513.17,-5253.34 20114.09,-5266.32 20097,-5248.83 20092.34,-5244.07 20092.33,-5238.59 20097,-5233.83 20105.56,-5225.11 20525.37,-5229.6 20537,-5225.83 20555.45,-5219.86 20573.49,-5209.1 20588.92,-5197.9"/>
<polygon fill="black" stroke="black" points="20591.32,-5200.47 20597.2,-5191.66 20587.11,-5194.88 20591.32,-5200.47"/>
</g>
<!-- l3_attn_stage4_gpu2&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge2771" class="edge">
<title>l3_attn_stage4_gpu2&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20687.3,-5274.39C20701.44,-5268.05 20716.96,-5262.22 20732,-5258.83 20747.53,-5255.33 21293.84,-5260.19 21305,-5248.83 21345.03,-5208.1 21275.32,-5184.74 21205.01,-5171.99"/>
<polygon fill="red" stroke="red" points="21205.55,-5168.53 21195.1,-5170.27 21204.35,-5175.43 21205.55,-5168.53"/>
<text text-anchor="middle" x="21345.5" y="-5237.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu3 -->
<g id="node756" class="node">
<title>l3_attn_stage5_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="20049" cy="-5157.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20049" y="-5168.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="20049" y="-5153.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="20049" y="-5138.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu3&#45;&gt;l3_attn_stage5_gpu3 -->
<g id="edge1172" class="edge">
<title>l3_attn_stage4_gpu3&#45;&gt;l3_attn_stage5_gpu3</title>
<path fill="none" stroke="black" d="M20049,-5266.74C20049,-5248.02 20049,-5225.03 20049,-5205.05"/>
<polygon fill="black" stroke="black" points="20052.5,-5204.91 20049,-5194.91 20045.5,-5204.91 20052.5,-5204.91"/>
</g>
<!-- l3_attn_stage4_gpu3&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge2772" class="edge">
<title>l3_attn_stage4_gpu3&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20102.29,-5274.33C20116.42,-5267.99 20131.95,-5262.18 20147,-5258.83 20171.41,-5253.41 21025.88,-5262.21 21047,-5248.83 21068.94,-5234.93 21080.24,-5206.65 21085.85,-5185.39"/>
<polygon fill="red" stroke="red" points="21089.27,-5186.14 21088.18,-5175.6 21082.46,-5184.52 21089.27,-5186.14"/>
<text text-anchor="middle" x="21093.5" y="-5237.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu4 -->
<g id="node757" class="node">
<title>l3_attn_stage5_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="18294" cy="-5157.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18294" y="-5168.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="18294" y="-5153.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="18294" y="-5138.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu4&#45;&gt;l3_attn_stage5_gpu4 -->
<g id="edge1173" class="edge">
<title>l3_attn_stage4_gpu4&#45;&gt;l3_attn_stage5_gpu4</title>
<path fill="none" stroke="black" d="M18294,-5266.74C18294,-5248.02 18294,-5225.03 18294,-5205.05"/>
<polygon fill="black" stroke="black" points="18297.5,-5204.91 18294,-5194.91 18290.5,-5204.91 18297.5,-5204.91"/>
</g>
<!-- l3_attn_stage4_gpu4&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge2773" class="edge">
<title>l3_attn_stage4_gpu4&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18346.96,-5274.15C18360.88,-5267.86 18376.17,-5262.11 18391,-5258.83 18442.04,-5247.54 20223.66,-5266.11 20273,-5248.83 20283.15,-5245.28 20281.86,-5237.42 20292,-5233.83 20325.36,-5222.02 20894.34,-5232.99 20929,-5225.83 20972.86,-5216.77 21019.76,-5195.86 21051.75,-5179.7"/>
<polygon fill="red" stroke="red" points="21053.48,-5182.75 21060.77,-5175.07 21050.28,-5176.52 21053.48,-5182.75"/>
<text text-anchor="middle" x="20323.5" y="-5237.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu5 -->
<g id="node758" class="node">
<title>l3_attn_stage5_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="19074" cy="-5157.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19074" y="-5168.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="19074" y="-5153.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="19074" y="-5138.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu5&#45;&gt;l3_attn_stage5_gpu5 -->
<g id="edge1174" class="edge">
<title>l3_attn_stage4_gpu5&#45;&gt;l3_attn_stage5_gpu5</title>
<path fill="none" stroke="black" d="M19074,-5266.74C19074,-5248.02 19074,-5225.03 19074,-5205.05"/>
<polygon fill="black" stroke="black" points="19077.5,-5204.91 19074,-5194.91 19070.5,-5204.91 19077.5,-5204.91"/>
</g>
<!-- l3_attn_stage4_gpu5&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge2774" class="edge">
<title>l3_attn_stage4_gpu5&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19126.96,-5274.17C19140.89,-5267.88 19156.17,-5262.13 19171,-5258.83 19210.21,-5250.13 20579.1,-5262.14 20617,-5248.83 20627.15,-5245.27 20625.89,-5237.5 20636,-5233.83 20666.62,-5222.73 20897.15,-5232.65 20929,-5225.83 20972.66,-5216.48 21019.41,-5195.72 21051.42,-5179.67"/>
<polygon fill="red" stroke="red" points="21053.12,-5182.73 21060.45,-5175.07 21049.95,-5176.49 21053.12,-5182.73"/>
<text text-anchor="middle" x="20667.5" y="-5237.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu6 -->
<g id="node759" class="node">
<title>l3_attn_stage5_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19854" cy="-5157.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19854" y="-5168.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="19854" y="-5153.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19854" y="-5138.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu6&#45;&gt;l3_attn_stage5_gpu6 -->
<g id="edge1175" class="edge">
<title>l3_attn_stage4_gpu6&#45;&gt;l3_attn_stage5_gpu6</title>
<path fill="none" stroke="black" d="M19854,-5266.74C19854,-5248.02 19854,-5225.03 19854,-5205.05"/>
<polygon fill="black" stroke="black" points="19857.5,-5204.91 19854,-5194.91 19850.5,-5204.91 19857.5,-5204.91"/>
</g>
<!-- l3_attn_stage4_gpu6&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge2775" class="edge">
<title>l3_attn_stage4_gpu6&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19907.29,-5274.31C19921.42,-5267.97 19936.95,-5262.17 19952,-5258.83 20006.73,-5246.7 20908.13,-5267.48 20961,-5248.83 20971.15,-5245.25 20971.32,-5240.2 20980,-5233.83 21005.22,-5215.34 21034.5,-5195.49 21056.65,-5180.78"/>
<polygon fill="red" stroke="red" points="21058.66,-5183.65 21065.07,-5175.22 21054.8,-5177.81 21058.66,-5183.65"/>
<text text-anchor="middle" x="21011.5" y="-5237.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu7 -->
<g id="node760" class="node">
<title>l3_attn_stage5_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="18489" cy="-5157.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18489" y="-5168.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="18489" y="-5153.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="18489" y="-5138.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu7&#45;&gt;l3_attn_stage5_gpu7 -->
<g id="edge1176" class="edge">
<title>l3_attn_stage4_gpu7&#45;&gt;l3_attn_stage5_gpu7</title>
<path fill="none" stroke="black" d="M18489,-5266.74C18489,-5248.02 18489,-5225.03 18489,-5205.05"/>
<polygon fill="black" stroke="black" points="18492.5,-5204.91 18489,-5194.91 18485.5,-5204.91 18492.5,-5204.91"/>
</g>
<!-- l3_attn_stage4_gpu7&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge2776" class="edge">
<title>l3_attn_stage4_gpu7&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18541.96,-5274.16C18555.88,-5267.86 18571.17,-5262.12 18586,-5258.83 18634.09,-5248.19 20312.52,-5265.12 20359,-5248.83 20369.15,-5245.28 20367.86,-5237.43 20378,-5233.83 20406.85,-5223.58 20899.02,-5232.05 20929,-5225.83 20972.85,-5216.73 21019.75,-5195.83 21051.75,-5179.68"/>
<polygon fill="red" stroke="red" points="21053.47,-5182.73 21060.77,-5175.05 21050.27,-5176.5 21053.47,-5182.73"/>
<text text-anchor="middle" x="20409.5" y="-5237.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu8 -->
<g id="node761" class="node">
<title>l3_attn_stage5_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20244" cy="-5157.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20244" y="-5168.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="20244" y="-5153.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20244" y="-5138.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu8&#45;&gt;l3_attn_stage5_gpu8 -->
<g id="edge1177" class="edge">
<title>l3_attn_stage4_gpu8&#45;&gt;l3_attn_stage5_gpu8</title>
<path fill="none" stroke="black" d="M20188.85,-5274.87C20175.43,-5268.83 20160.93,-5263.03 20147,-5258.83 20133.22,-5254.68 20092.36,-5259.77 20083,-5248.83 20048.08,-5208.03 20088.79,-5248.15 20147,-5225.83 20164.78,-5219.02 20182.42,-5208.27 20197.68,-5197.34"/>
<polygon fill="black" stroke="black" points="20199.93,-5200.03 20205.9,-5191.27 20195.77,-5194.39 20199.93,-5200.03"/>
</g>
<!-- l3_attn_stage4_gpu8&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge2777" class="edge">
<title>l3_attn_stage4_gpu8&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20297.29,-5274.34C20311.43,-5268 20326.95,-5262.19 20342,-5258.83 20363.45,-5254.05 21117.56,-5264.47 21133,-5248.83 21151.16,-5230.44 21133.89,-5202.75 21116.31,-5182.84"/>
<polygon fill="red" stroke="red" points="21118.75,-5180.32 21109.38,-5175.37 21113.61,-5185.08 21118.75,-5180.32"/>
<text text-anchor="middle" x="21171.5" y="-5237.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu9 -->
<g id="node762" class="node">
<title>l3_attn_stage5_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="19659" cy="-5157.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19659" y="-5168.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="19659" y="-5153.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="19659" y="-5138.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu9&#45;&gt;l3_attn_stage5_gpu9 -->
<g id="edge1178" class="edge">
<title>l3_attn_stage4_gpu9&#45;&gt;l3_attn_stage5_gpu9</title>
<path fill="none" stroke="black" d="M19659,-5266.74C19659,-5248.02 19659,-5225.03 19659,-5205.05"/>
<polygon fill="black" stroke="black" points="19662.5,-5204.91 19659,-5194.91 19655.5,-5204.91 19662.5,-5204.91"/>
</g>
<!-- l3_attn_stage4_gpu9&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge2778" class="edge">
<title>l3_attn_stage4_gpu9&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19712.28,-5274.3C19726.42,-5267.97 19741.95,-5262.16 19757,-5258.83 19817.65,-5245.42 20816.41,-5269.47 20875,-5248.83 20885.15,-5245.26 20884.3,-5238.48 20894,-5233.83 20908.39,-5226.94 20913.8,-5230.7 20929,-5225.83 20969.94,-5212.73 21014.95,-5193.57 21047.12,-5179.01"/>
<polygon fill="red" stroke="red" points="21048.61,-5182.18 21056.25,-5174.84 21045.7,-5175.81 21048.61,-5182.18"/>
<text text-anchor="middle" x="20925.5" y="-5237.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu10 -->
<g id="node763" class="node">
<title>l3_attn_stage5_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="17904" cy="-5157.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="17904" y="-5168.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="17904" y="-5153.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17904" y="-5138.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu10&#45;&gt;l3_attn_stage5_gpu10 -->
<g id="edge1179" class="edge">
<title>l3_attn_stage4_gpu10&#45;&gt;l3_attn_stage5_gpu10</title>
<path fill="none" stroke="black" d="M17904,-5266.74C17904,-5248.02 17904,-5225.03 17904,-5205.05"/>
<polygon fill="black" stroke="black" points="17907.5,-5204.91 17904,-5194.91 17900.5,-5204.91 17907.5,-5204.91"/>
</g>
<!-- l3_attn_stage4_gpu10&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge2779" class="edge">
<title>l3_attn_stage4_gpu10&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17956.97,-5274.22C17970.9,-5267.92 17986.18,-5262.16 18001,-5258.83 18230.74,-5207.23 19884.55,-5236.39 20120,-5233.83 20164.94,-5233.35 20884.97,-5234.87 20929,-5225.83 20972.87,-5216.83 21019.77,-5195.91 21051.76,-5179.73"/>
<polygon fill="red" stroke="red" points="21053.49,-5182.78 21060.78,-5175.09 21050.28,-5176.55 21053.49,-5182.78"/>
<text text-anchor="middle" x="20151.5" y="-5237.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu11 -->
<g id="node764" class="node">
<title>l3_attn_stage5_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="18684" cy="-5157.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18684" y="-5168.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="18684" y="-5153.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18684" y="-5138.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu11&#45;&gt;l3_attn_stage5_gpu11 -->
<g id="edge1180" class="edge">
<title>l3_attn_stage4_gpu11&#45;&gt;l3_attn_stage5_gpu11</title>
<path fill="none" stroke="black" d="M18684,-5266.74C18684,-5248.02 18684,-5225.03 18684,-5205.05"/>
<polygon fill="black" stroke="black" points="18687.5,-5204.91 18684,-5194.91 18680.5,-5204.91 18687.5,-5204.91"/>
</g>
<!-- l3_attn_stage4_gpu11&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge2780" class="edge">
<title>l3_attn_stage4_gpu11&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18736.96,-5274.16C18750.88,-5267.87 18766.17,-5262.12 18781,-5258.83 18826.13,-5248.83 20401.38,-5264.12 20445,-5248.83 20455.15,-5245.27 20453.87,-5237.45 20464,-5233.83 20512.67,-5216.47 20878.42,-5236.4 20929,-5225.83 20972.84,-5216.67 21019.74,-5195.78 21051.74,-5179.64"/>
<polygon fill="red" stroke="red" points="21053.46,-5182.7 21060.76,-5175.02 21050.27,-5176.47 21053.46,-5182.7"/>
<text text-anchor="middle" x="20495.5" y="-5237.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu12 -->
<g id="node765" class="node">
<title>l3_attn_stage5_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="18099" cy="-5157.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18099" y="-5168.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="18099" y="-5153.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18099" y="-5138.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu12&#45;&gt;l3_attn_stage5_gpu12 -->
<g id="edge1181" class="edge">
<title>l3_attn_stage4_gpu12&#45;&gt;l3_attn_stage5_gpu12</title>
<path fill="none" stroke="black" d="M18099,-5266.74C18099,-5248.02 18099,-5225.03 18099,-5205.05"/>
<polygon fill="black" stroke="black" points="18102.5,-5204.91 18099,-5194.91 18095.5,-5204.91 18102.5,-5204.91"/>
</g>
<!-- l3_attn_stage4_gpu12&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge2781" class="edge">
<title>l3_attn_stage4_gpu12&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18151.96,-5274.15C18165.88,-5267.86 18181.17,-5262.11 18196,-5258.83 18250,-5246.89 20134.8,-5267.1 20187,-5248.83 20197.15,-5245.28 20195.86,-5237.42 20206,-5233.83 20243.87,-5220.45 20889.66,-5233.93 20929,-5225.83 20972.87,-5216.81 21019.77,-5195.89 21051.76,-5179.72"/>
<polygon fill="red" stroke="red" points="21053.48,-5182.77 21060.78,-5175.08 21050.28,-5176.54 21053.48,-5182.77"/>
<text text-anchor="middle" x="20237.5" y="-5237.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu13 -->
<g id="node766" class="node">
<title>l3_attn_stage5_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="18879" cy="-5157.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18879" y="-5168.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="18879" y="-5153.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18879" y="-5138.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu13&#45;&gt;l3_attn_stage5_gpu13 -->
<g id="edge1182" class="edge">
<title>l3_attn_stage4_gpu13&#45;&gt;l3_attn_stage5_gpu13</title>
<path fill="none" stroke="black" d="M18879,-5266.74C18879,-5248.02 18879,-5225.03 18879,-5205.05"/>
<polygon fill="black" stroke="black" points="18882.5,-5204.91 18879,-5194.91 18875.5,-5204.91 18882.5,-5204.91"/>
</g>
<!-- l3_attn_stage4_gpu13&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge2782" class="edge">
<title>l3_attn_stage4_gpu13&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18931.96,-5274.16C18945.89,-5267.87 18961.17,-5262.12 18976,-5258.83 19018.17,-5249.48 20490.24,-5263.13 20531,-5248.83 20541.15,-5245.27 20539.87,-5237.47 20550,-5233.83 20589.64,-5219.6 20887.79,-5234.53 20929,-5225.83 20972.82,-5216.59 21019.73,-5195.7 21051.73,-5179.6"/>
<polygon fill="red" stroke="red" points="21053.45,-5182.65 21060.75,-5174.98 21050.26,-5176.42 21053.45,-5182.65"/>
<text text-anchor="middle" x="20581.5" y="-5237.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu14 -->
<g id="node767" class="node">
<title>l3_attn_stage5_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19269" cy="-5157.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19269" y="-5168.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="19269" y="-5153.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19269" y="-5138.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu14&#45;&gt;l3_attn_stage5_gpu14 -->
<g id="edge1183" class="edge">
<title>l3_attn_stage4_gpu14&#45;&gt;l3_attn_stage5_gpu14</title>
<path fill="none" stroke="black" d="M19269,-5266.74C19269,-5248.02 19269,-5225.03 19269,-5205.05"/>
<polygon fill="black" stroke="black" points="19272.5,-5204.91 19269,-5194.91 19265.5,-5204.91 19272.5,-5204.91"/>
</g>
<!-- l3_attn_stage4_gpu14&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge2783" class="edge">
<title>l3_attn_stage4_gpu14&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19322.28,-5274.29C19336.42,-5267.95 19351.95,-5262.15 19367,-5258.83 19403.24,-5250.85 20667.99,-5261.14 20703,-5248.83 20713.15,-5245.27 20711.91,-5237.56 20722,-5233.83 20765.19,-5217.9 20884.04,-5235.73 20929,-5225.83 20972.6,-5216.23 21019.37,-5195.51 21051.39,-5179.54"/>
<polygon fill="red" stroke="red" points="21053.08,-5182.6 21060.42,-5174.96 21049.92,-5176.36 21053.08,-5182.6"/>
<text text-anchor="middle" x="20753.5" y="-5237.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu15 -->
<g id="node768" class="node">
<title>l3_attn_stage5_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20439" cy="-5157.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20439" y="-5168.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="20439" y="-5153.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20439" y="-5138.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu15&#45;&gt;l3_attn_stage5_gpu15 -->
<g id="edge1184" class="edge">
<title>l3_attn_stage4_gpu15&#45;&gt;l3_attn_stage5_gpu15</title>
<path fill="none" stroke="black" d="M20385.7,-5274.39C20371.85,-5268.13 20356.69,-5262.35 20342,-5258.83 20328.37,-5255.57 20099.71,-5258.93 20090,-5248.83 20085.38,-5244.03 20085.36,-5238.62 20090,-5233.83 20099.75,-5223.77 20328.7,-5230.24 20342,-5225.83 20360.4,-5219.74 20378.44,-5208.94 20393.87,-5197.75"/>
<polygon fill="black" stroke="black" points="20396.27,-5200.33 20402.16,-5191.52 20392.06,-5194.73 20396.27,-5200.33"/>
</g>
<!-- l3_attn_stage4_gpu15&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge2784" class="edge">
<title>l3_attn_stage4_gpu15&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20492.3,-5274.36C20506.43,-5268.02 20521.96,-5262.2 20537,-5258.83 20555.49,-5254.69 21205.7,-5262.33 21219,-5248.83 21247.36,-5220.06 21199.79,-5194.22 21154.82,-5177.6"/>
<polygon fill="red" stroke="red" points="21155.88,-5174.26 21145.29,-5174.19 21153.53,-5180.85 21155.88,-5174.26"/>
<text text-anchor="middle" x="21258.5" y="-5237.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu0 -->
<g id="node769" class="node">
<title>l3_attn_stage6_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20829" cy="-5010.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20829" y="-5021.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="20829" y="-5006.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20829" y="-4991.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu0&#45;&gt;l3_attn_stage6_gpu0 -->
<g id="edge1185" class="edge">
<title>l3_attn_stage5_gpu0&#45;&gt;l3_attn_stage6_gpu0</title>
<path fill="none" stroke="black" d="M20776.02,-5127.26C20762.09,-5120.97 20746.82,-5115.19 20732,-5111.83 20714.99,-5107.97 20116.24,-5114.27 20104,-5101.83 20099.32,-5097.08 20099.32,-5091.58 20104,-5086.83 20116.26,-5074.42 20715.39,-5084.16 20732,-5078.83 20750.46,-5072.91 20768.51,-5062.16 20783.94,-5050.96"/>
<polygon fill="black" stroke="black" points="20786.34,-5053.53 20792.22,-5044.72 20782.13,-5047.94 20786.34,-5053.53"/>
</g>
<!-- l3_attn_stage6_gpu[next_gpu] -->
<g id="node1380" class="node">
<title>l3_attn_stage6_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="21091" cy="-5010.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="21091" y="-5006.63" font-family="Times,serif" font-size="14.00">l3_attn_stage6_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage5_gpu0&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge2785" class="edge">
<title>l3_attn_stage5_gpu0&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20884.38,-5128.02C20899.74,-5121.45 20916.68,-5115.36 20933,-5111.83 20957.87,-5106.45 21373.2,-5120.02 21391,-5101.83 21445.67,-5045.96 21344.45,-5024.3 21245.12,-5016.04"/>
<polygon fill="red" stroke="red" points="21245.15,-5012.53 21234.9,-5015.24 21244.6,-5019.51 21245.15,-5012.53"/>
<text text-anchor="middle" x="21431.5" y="-5090.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu1 -->
<g id="node770" class="node">
<title>l3_attn_stage6_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19464" cy="-5010.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19464" y="-5021.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="19464" y="-5006.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19464" y="-4991.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu1&#45;&gt;l3_attn_stage6_gpu1 -->
<g id="edge1186" class="edge">
<title>l3_attn_stage5_gpu1&#45;&gt;l3_attn_stage6_gpu1</title>
<path fill="none" stroke="black" d="M19464,-5119.74C19464,-5101.02 19464,-5078.03 19464,-5058.05"/>
<polygon fill="black" stroke="black" points="19467.5,-5057.91 19464,-5047.91 19460.5,-5057.91 19467.5,-5057.91"/>
</g>
<!-- l3_attn_stage5_gpu1&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge2786" class="edge">
<title>l3_attn_stage5_gpu1&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19517.28,-5127.3C19531.42,-5120.96 19546.95,-5115.15 19562,-5111.83 19628.57,-5097.14 20724.69,-5124.45 20789,-5101.83 20799.15,-5098.26 20797.96,-5090.69 20808,-5086.83 20858.3,-5067.49 20876.53,-5091.14 20929,-5078.83 20972.2,-5068.7 21018.67,-5048.25 21050.71,-5032.5"/>
<polygon fill="red" stroke="red" points="21052.38,-5035.59 21059.77,-5027.99 21049.25,-5029.32 21052.38,-5035.59"/>
<text text-anchor="middle" x="20839.5" y="-5090.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu2 -->
<g id="node771" class="node">
<title>l3_attn_stage6_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20634" cy="-5010.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20634" y="-5021.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="20634" y="-5006.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20634" y="-4991.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu2&#45;&gt;l3_attn_stage6_gpu2 -->
<g id="edge1187" class="edge">
<title>l3_attn_stage5_gpu2&#45;&gt;l3_attn_stage6_gpu2</title>
<path fill="none" stroke="black" d="M20580.74,-5127.22C20566.89,-5120.96 20551.71,-5115.22 20537,-5111.83 20513.17,-5106.34 20114.09,-5119.32 20097,-5101.83 20092.34,-5097.07 20092.33,-5091.59 20097,-5086.83 20105.56,-5078.11 20525.37,-5082.6 20537,-5078.83 20555.45,-5072.86 20573.49,-5062.1 20588.92,-5050.9"/>
<polygon fill="black" stroke="black" points="20591.32,-5053.47 20597.2,-5044.66 20587.11,-5047.88 20591.32,-5053.47"/>
</g>
<!-- l3_attn_stage5_gpu2&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge2787" class="edge">
<title>l3_attn_stage5_gpu2&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20687.3,-5127.39C20701.44,-5121.05 20716.96,-5115.22 20732,-5111.83 20747.53,-5108.33 21293.84,-5113.19 21305,-5101.83 21345.03,-5061.1 21275.32,-5037.74 21205.01,-5024.99"/>
<polygon fill="red" stroke="red" points="21205.55,-5021.53 21195.1,-5023.27 21204.35,-5028.43 21205.55,-5021.53"/>
<text text-anchor="middle" x="21345.5" y="-5090.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu3 -->
<g id="node772" class="node">
<title>l3_attn_stage6_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="20049" cy="-5010.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20049" y="-5021.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="20049" y="-5006.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="20049" y="-4991.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu3&#45;&gt;l3_attn_stage6_gpu3 -->
<g id="edge1188" class="edge">
<title>l3_attn_stage5_gpu3&#45;&gt;l3_attn_stage6_gpu3</title>
<path fill="none" stroke="black" d="M20049,-5119.74C20049,-5101.02 20049,-5078.03 20049,-5058.05"/>
<polygon fill="black" stroke="black" points="20052.5,-5057.91 20049,-5047.91 20045.5,-5057.91 20052.5,-5057.91"/>
</g>
<!-- l3_attn_stage5_gpu3&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge2788" class="edge">
<title>l3_attn_stage5_gpu3&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20102.29,-5127.33C20116.42,-5120.99 20131.95,-5115.18 20147,-5111.83 20171.41,-5106.41 21025.88,-5115.21 21047,-5101.83 21068.94,-5087.93 21080.24,-5059.65 21085.85,-5038.39"/>
<polygon fill="red" stroke="red" points="21089.27,-5039.14 21088.18,-5028.6 21082.46,-5037.52 21089.27,-5039.14"/>
<text text-anchor="middle" x="21093.5" y="-5090.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu4 -->
<g id="node773" class="node">
<title>l3_attn_stage6_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="18294" cy="-5010.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18294" y="-5021.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="18294" y="-5006.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="18294" y="-4991.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu4&#45;&gt;l3_attn_stage6_gpu4 -->
<g id="edge1189" class="edge">
<title>l3_attn_stage5_gpu4&#45;&gt;l3_attn_stage6_gpu4</title>
<path fill="none" stroke="black" d="M18294,-5119.74C18294,-5101.02 18294,-5078.03 18294,-5058.05"/>
<polygon fill="black" stroke="black" points="18297.5,-5057.91 18294,-5047.91 18290.5,-5057.91 18297.5,-5057.91"/>
</g>
<!-- l3_attn_stage5_gpu4&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge2789" class="edge">
<title>l3_attn_stage5_gpu4&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18346.96,-5127.15C18360.88,-5120.86 18376.17,-5115.11 18391,-5111.83 18442.04,-5100.54 20223.66,-5119.11 20273,-5101.83 20283.15,-5098.28 20281.86,-5090.42 20292,-5086.83 20325.36,-5075.02 20894.34,-5085.99 20929,-5078.83 20972.86,-5069.77 21019.76,-5048.86 21051.75,-5032.7"/>
<polygon fill="red" stroke="red" points="21053.48,-5035.75 21060.77,-5028.07 21050.28,-5029.52 21053.48,-5035.75"/>
<text text-anchor="middle" x="20323.5" y="-5090.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu5 -->
<g id="node774" class="node">
<title>l3_attn_stage6_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="19074" cy="-5010.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19074" y="-5021.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="19074" y="-5006.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="19074" y="-4991.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu5&#45;&gt;l3_attn_stage6_gpu5 -->
<g id="edge1190" class="edge">
<title>l3_attn_stage5_gpu5&#45;&gt;l3_attn_stage6_gpu5</title>
<path fill="none" stroke="black" d="M19074,-5119.74C19074,-5101.02 19074,-5078.03 19074,-5058.05"/>
<polygon fill="black" stroke="black" points="19077.5,-5057.91 19074,-5047.91 19070.5,-5057.91 19077.5,-5057.91"/>
</g>
<!-- l3_attn_stage5_gpu5&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge2790" class="edge">
<title>l3_attn_stage5_gpu5&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19126.96,-5127.17C19140.89,-5120.88 19156.17,-5115.13 19171,-5111.83 19210.21,-5103.13 20579.1,-5115.14 20617,-5101.83 20627.15,-5098.27 20625.89,-5090.5 20636,-5086.83 20666.62,-5075.73 20897.15,-5085.65 20929,-5078.83 20972.66,-5069.48 21019.41,-5048.72 21051.42,-5032.67"/>
<polygon fill="red" stroke="red" points="21053.12,-5035.73 21060.45,-5028.07 21049.95,-5029.49 21053.12,-5035.73"/>
<text text-anchor="middle" x="20667.5" y="-5090.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu6 -->
<g id="node775" class="node">
<title>l3_attn_stage6_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19854" cy="-5010.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19854" y="-5021.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="19854" y="-5006.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19854" y="-4991.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu6&#45;&gt;l3_attn_stage6_gpu6 -->
<g id="edge1191" class="edge">
<title>l3_attn_stage5_gpu6&#45;&gt;l3_attn_stage6_gpu6</title>
<path fill="none" stroke="black" d="M19854,-5119.74C19854,-5101.02 19854,-5078.03 19854,-5058.05"/>
<polygon fill="black" stroke="black" points="19857.5,-5057.91 19854,-5047.91 19850.5,-5057.91 19857.5,-5057.91"/>
</g>
<!-- l3_attn_stage5_gpu6&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge2791" class="edge">
<title>l3_attn_stage5_gpu6&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19907.29,-5127.31C19921.42,-5120.97 19936.95,-5115.17 19952,-5111.83 20006.73,-5099.7 20908.13,-5120.48 20961,-5101.83 20971.15,-5098.25 20971.32,-5093.2 20980,-5086.83 21005.22,-5068.34 21034.5,-5048.49 21056.65,-5033.78"/>
<polygon fill="red" stroke="red" points="21058.66,-5036.65 21065.07,-5028.22 21054.8,-5030.81 21058.66,-5036.65"/>
<text text-anchor="middle" x="21011.5" y="-5090.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu7 -->
<g id="node776" class="node">
<title>l3_attn_stage6_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="18489" cy="-5010.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18489" y="-5021.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="18489" y="-5006.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="18489" y="-4991.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu7&#45;&gt;l3_attn_stage6_gpu7 -->
<g id="edge1192" class="edge">
<title>l3_attn_stage5_gpu7&#45;&gt;l3_attn_stage6_gpu7</title>
<path fill="none" stroke="black" d="M18489,-5119.74C18489,-5101.02 18489,-5078.03 18489,-5058.05"/>
<polygon fill="black" stroke="black" points="18492.5,-5057.91 18489,-5047.91 18485.5,-5057.91 18492.5,-5057.91"/>
</g>
<!-- l3_attn_stage5_gpu7&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge2792" class="edge">
<title>l3_attn_stage5_gpu7&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18541.96,-5127.16C18555.88,-5120.86 18571.17,-5115.12 18586,-5111.83 18634.09,-5101.19 20312.52,-5118.12 20359,-5101.83 20369.15,-5098.28 20367.86,-5090.43 20378,-5086.83 20406.85,-5076.58 20899.02,-5085.05 20929,-5078.83 20972.85,-5069.73 21019.75,-5048.83 21051.75,-5032.68"/>
<polygon fill="red" stroke="red" points="21053.47,-5035.73 21060.77,-5028.05 21050.27,-5029.5 21053.47,-5035.73"/>
<text text-anchor="middle" x="20409.5" y="-5090.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu8 -->
<g id="node777" class="node">
<title>l3_attn_stage6_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20244" cy="-5010.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20244" y="-5021.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="20244" y="-5006.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20244" y="-4991.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu8&#45;&gt;l3_attn_stage6_gpu8 -->
<g id="edge1193" class="edge">
<title>l3_attn_stage5_gpu8&#45;&gt;l3_attn_stage6_gpu8</title>
<path fill="none" stroke="black" d="M20188.85,-5127.87C20175.43,-5121.83 20160.93,-5116.03 20147,-5111.83 20133.22,-5107.68 20092.36,-5112.77 20083,-5101.83 20048.08,-5061.03 20088.79,-5101.15 20147,-5078.83 20164.78,-5072.02 20182.42,-5061.27 20197.68,-5050.34"/>
<polygon fill="black" stroke="black" points="20199.93,-5053.03 20205.9,-5044.27 20195.77,-5047.39 20199.93,-5053.03"/>
</g>
<!-- l3_attn_stage5_gpu8&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge2793" class="edge">
<title>l3_attn_stage5_gpu8&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20297.29,-5127.34C20311.43,-5121 20326.95,-5115.19 20342,-5111.83 20363.45,-5107.05 21117.56,-5117.47 21133,-5101.83 21151.16,-5083.44 21133.89,-5055.75 21116.31,-5035.84"/>
<polygon fill="red" stroke="red" points="21118.75,-5033.32 21109.38,-5028.37 21113.61,-5038.08 21118.75,-5033.32"/>
<text text-anchor="middle" x="21171.5" y="-5090.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu9 -->
<g id="node778" class="node">
<title>l3_attn_stage6_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="19659" cy="-5010.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19659" y="-5021.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="19659" y="-5006.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="19659" y="-4991.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu9&#45;&gt;l3_attn_stage6_gpu9 -->
<g id="edge1194" class="edge">
<title>l3_attn_stage5_gpu9&#45;&gt;l3_attn_stage6_gpu9</title>
<path fill="none" stroke="black" d="M19659,-5119.74C19659,-5101.02 19659,-5078.03 19659,-5058.05"/>
<polygon fill="black" stroke="black" points="19662.5,-5057.91 19659,-5047.91 19655.5,-5057.91 19662.5,-5057.91"/>
</g>
<!-- l3_attn_stage5_gpu9&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge2794" class="edge">
<title>l3_attn_stage5_gpu9&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19712.28,-5127.3C19726.42,-5120.97 19741.95,-5115.16 19757,-5111.83 19817.65,-5098.42 20816.41,-5122.47 20875,-5101.83 20885.15,-5098.26 20884.3,-5091.48 20894,-5086.83 20908.39,-5079.94 20913.8,-5083.7 20929,-5078.83 20969.94,-5065.73 21014.95,-5046.57 21047.12,-5032.01"/>
<polygon fill="red" stroke="red" points="21048.61,-5035.18 21056.25,-5027.84 21045.7,-5028.81 21048.61,-5035.18"/>
<text text-anchor="middle" x="20925.5" y="-5090.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu10 -->
<g id="node779" class="node">
<title>l3_attn_stage6_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="17904" cy="-5010.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="17904" y="-5021.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="17904" y="-5006.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17904" y="-4991.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu10&#45;&gt;l3_attn_stage6_gpu10 -->
<g id="edge1195" class="edge">
<title>l3_attn_stage5_gpu10&#45;&gt;l3_attn_stage6_gpu10</title>
<path fill="none" stroke="black" d="M17904,-5119.74C17904,-5101.02 17904,-5078.03 17904,-5058.05"/>
<polygon fill="black" stroke="black" points="17907.5,-5057.91 17904,-5047.91 17900.5,-5057.91 17907.5,-5057.91"/>
</g>
<!-- l3_attn_stage5_gpu10&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge2795" class="edge">
<title>l3_attn_stage5_gpu10&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17956.97,-5127.22C17970.9,-5120.92 17986.18,-5115.16 18001,-5111.83 18230.74,-5060.23 19884.55,-5089.39 20120,-5086.83 20164.94,-5086.35 20884.97,-5087.87 20929,-5078.83 20972.87,-5069.83 21019.77,-5048.91 21051.76,-5032.73"/>
<polygon fill="red" stroke="red" points="21053.49,-5035.78 21060.78,-5028.09 21050.28,-5029.55 21053.49,-5035.78"/>
<text text-anchor="middle" x="20151.5" y="-5090.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu11 -->
<g id="node780" class="node">
<title>l3_attn_stage6_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="18684" cy="-5010.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18684" y="-5021.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="18684" y="-5006.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18684" y="-4991.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu11&#45;&gt;l3_attn_stage6_gpu11 -->
<g id="edge1196" class="edge">
<title>l3_attn_stage5_gpu11&#45;&gt;l3_attn_stage6_gpu11</title>
<path fill="none" stroke="black" d="M18684,-5119.74C18684,-5101.02 18684,-5078.03 18684,-5058.05"/>
<polygon fill="black" stroke="black" points="18687.5,-5057.91 18684,-5047.91 18680.5,-5057.91 18687.5,-5057.91"/>
</g>
<!-- l3_attn_stage5_gpu11&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge2796" class="edge">
<title>l3_attn_stage5_gpu11&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18736.96,-5127.16C18750.88,-5120.87 18766.17,-5115.12 18781,-5111.83 18826.13,-5101.83 20401.38,-5117.12 20445,-5101.83 20455.15,-5098.27 20453.87,-5090.45 20464,-5086.83 20512.67,-5069.47 20878.42,-5089.4 20929,-5078.83 20972.84,-5069.67 21019.74,-5048.78 21051.74,-5032.64"/>
<polygon fill="red" stroke="red" points="21053.46,-5035.7 21060.76,-5028.02 21050.27,-5029.47 21053.46,-5035.7"/>
<text text-anchor="middle" x="20495.5" y="-5090.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu12 -->
<g id="node781" class="node">
<title>l3_attn_stage6_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="18099" cy="-5010.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18099" y="-5021.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="18099" y="-5006.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18099" y="-4991.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu12&#45;&gt;l3_attn_stage6_gpu12 -->
<g id="edge1197" class="edge">
<title>l3_attn_stage5_gpu12&#45;&gt;l3_attn_stage6_gpu12</title>
<path fill="none" stroke="black" d="M18099,-5119.74C18099,-5101.02 18099,-5078.03 18099,-5058.05"/>
<polygon fill="black" stroke="black" points="18102.5,-5057.91 18099,-5047.91 18095.5,-5057.91 18102.5,-5057.91"/>
</g>
<!-- l3_attn_stage5_gpu12&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge2797" class="edge">
<title>l3_attn_stage5_gpu12&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18151.96,-5127.15C18165.88,-5120.86 18181.17,-5115.11 18196,-5111.83 18250,-5099.89 20134.8,-5120.1 20187,-5101.83 20197.15,-5098.28 20195.86,-5090.42 20206,-5086.83 20243.87,-5073.45 20889.66,-5086.93 20929,-5078.83 20972.87,-5069.81 21019.77,-5048.89 21051.76,-5032.72"/>
<polygon fill="red" stroke="red" points="21053.48,-5035.77 21060.78,-5028.08 21050.28,-5029.54 21053.48,-5035.77"/>
<text text-anchor="middle" x="20237.5" y="-5090.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu13 -->
<g id="node782" class="node">
<title>l3_attn_stage6_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="18879" cy="-5010.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18879" y="-5021.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="18879" y="-5006.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18879" y="-4991.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu13&#45;&gt;l3_attn_stage6_gpu13 -->
<g id="edge1198" class="edge">
<title>l3_attn_stage5_gpu13&#45;&gt;l3_attn_stage6_gpu13</title>
<path fill="none" stroke="black" d="M18879,-5119.74C18879,-5101.02 18879,-5078.03 18879,-5058.05"/>
<polygon fill="black" stroke="black" points="18882.5,-5057.91 18879,-5047.91 18875.5,-5057.91 18882.5,-5057.91"/>
</g>
<!-- l3_attn_stage5_gpu13&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge2798" class="edge">
<title>l3_attn_stage5_gpu13&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18931.96,-5127.16C18945.89,-5120.87 18961.17,-5115.12 18976,-5111.83 19018.17,-5102.48 20490.24,-5116.13 20531,-5101.83 20541.15,-5098.27 20539.87,-5090.47 20550,-5086.83 20589.64,-5072.6 20887.79,-5087.53 20929,-5078.83 20972.82,-5069.59 21019.73,-5048.7 21051.73,-5032.6"/>
<polygon fill="red" stroke="red" points="21053.45,-5035.65 21060.75,-5027.98 21050.26,-5029.42 21053.45,-5035.65"/>
<text text-anchor="middle" x="20581.5" y="-5090.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu14 -->
<g id="node783" class="node">
<title>l3_attn_stage6_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19269" cy="-5010.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19269" y="-5021.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="19269" y="-5006.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19269" y="-4991.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu14&#45;&gt;l3_attn_stage6_gpu14 -->
<g id="edge1199" class="edge">
<title>l3_attn_stage5_gpu14&#45;&gt;l3_attn_stage6_gpu14</title>
<path fill="none" stroke="black" d="M19269,-5119.74C19269,-5101.02 19269,-5078.03 19269,-5058.05"/>
<polygon fill="black" stroke="black" points="19272.5,-5057.91 19269,-5047.91 19265.5,-5057.91 19272.5,-5057.91"/>
</g>
<!-- l3_attn_stage5_gpu14&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge2799" class="edge">
<title>l3_attn_stage5_gpu14&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19322.28,-5127.29C19336.42,-5120.95 19351.95,-5115.15 19367,-5111.83 19403.24,-5103.85 20667.99,-5114.14 20703,-5101.83 20713.15,-5098.27 20711.91,-5090.56 20722,-5086.83 20765.19,-5070.9 20884.04,-5088.73 20929,-5078.83 20972.6,-5069.23 21019.37,-5048.51 21051.39,-5032.54"/>
<polygon fill="red" stroke="red" points="21053.08,-5035.6 21060.42,-5027.96 21049.92,-5029.36 21053.08,-5035.6"/>
<text text-anchor="middle" x="20753.5" y="-5090.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu15 -->
<g id="node784" class="node">
<title>l3_attn_stage6_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20439" cy="-5010.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20439" y="-5021.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="20439" y="-5006.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20439" y="-4991.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu15&#45;&gt;l3_attn_stage6_gpu15 -->
<g id="edge1200" class="edge">
<title>l3_attn_stage5_gpu15&#45;&gt;l3_attn_stage6_gpu15</title>
<path fill="none" stroke="black" d="M20385.7,-5127.39C20371.85,-5121.13 20356.69,-5115.35 20342,-5111.83 20328.37,-5108.57 20099.71,-5111.93 20090,-5101.83 20085.38,-5097.03 20085.36,-5091.62 20090,-5086.83 20099.75,-5076.77 20328.7,-5083.24 20342,-5078.83 20360.4,-5072.74 20378.44,-5061.94 20393.87,-5050.75"/>
<polygon fill="black" stroke="black" points="20396.27,-5053.33 20402.16,-5044.52 20392.06,-5047.73 20396.27,-5053.33"/>
</g>
<!-- l3_attn_stage5_gpu15&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge2800" class="edge">
<title>l3_attn_stage5_gpu15&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20492.3,-5127.36C20506.43,-5121.02 20521.96,-5115.2 20537,-5111.83 20555.49,-5107.69 21205.7,-5115.33 21219,-5101.83 21247.36,-5073.06 21199.79,-5047.22 21154.82,-5030.6"/>
<polygon fill="red" stroke="red" points="21155.88,-5027.26 21145.29,-5027.19 21153.53,-5033.85 21155.88,-5027.26"/>
<text text-anchor="middle" x="21258.5" y="-5090.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu0 -->
<g id="node785" class="node">
<title>l3_attn_stage7_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20829" cy="-4863.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20829" y="-4874.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="20829" y="-4859.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20829" y="-4844.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu0&#45;&gt;l3_attn_stage7_gpu0 -->
<g id="edge1201" class="edge">
<title>l3_attn_stage6_gpu0&#45;&gt;l3_attn_stage7_gpu0</title>
<path fill="none" stroke="black" d="M20776.02,-4980.26C20762.09,-4973.97 20746.82,-4968.19 20732,-4964.83 20714.99,-4960.97 20116.24,-4967.27 20104,-4954.83 20099.32,-4950.08 20099.32,-4944.58 20104,-4939.83 20116.26,-4927.42 20715.39,-4937.16 20732,-4931.83 20750.46,-4925.91 20768.51,-4915.16 20783.94,-4903.96"/>
<polygon fill="black" stroke="black" points="20786.34,-4906.53 20792.22,-4897.72 20782.13,-4900.94 20786.34,-4906.53"/>
</g>
<!-- l3_attn_stage7_gpu[next_gpu] -->
<g id="node1381" class="node">
<title>l3_attn_stage7_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="21091" cy="-4863.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="21091" y="-4859.63" font-family="Times,serif" font-size="14.00">l3_attn_stage7_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage6_gpu0&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge2801" class="edge">
<title>l3_attn_stage6_gpu0&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20884.38,-4981.02C20899.74,-4974.45 20916.68,-4968.36 20933,-4964.83 20957.87,-4959.45 21373.2,-4973.02 21391,-4954.83 21445.67,-4898.96 21344.45,-4877.3 21245.12,-4869.04"/>
<polygon fill="red" stroke="red" points="21245.15,-4865.53 21234.9,-4868.24 21244.6,-4872.51 21245.15,-4865.53"/>
<text text-anchor="middle" x="21431.5" y="-4943.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu1 -->
<g id="node786" class="node">
<title>l3_attn_stage7_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19464" cy="-4863.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19464" y="-4874.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="19464" y="-4859.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19464" y="-4844.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu1&#45;&gt;l3_attn_stage7_gpu1 -->
<g id="edge1202" class="edge">
<title>l3_attn_stage6_gpu1&#45;&gt;l3_attn_stage7_gpu1</title>
<path fill="none" stroke="black" d="M19464,-4972.74C19464,-4954.02 19464,-4931.03 19464,-4911.05"/>
<polygon fill="black" stroke="black" points="19467.5,-4910.91 19464,-4900.91 19460.5,-4910.91 19467.5,-4910.91"/>
</g>
<!-- l3_attn_stage6_gpu1&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge2802" class="edge">
<title>l3_attn_stage6_gpu1&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19517.28,-4980.3C19531.42,-4973.96 19546.95,-4968.15 19562,-4964.83 19628.57,-4950.14 20724.69,-4977.45 20789,-4954.83 20799.15,-4951.26 20797.96,-4943.69 20808,-4939.83 20858.3,-4920.49 20876.53,-4944.14 20929,-4931.83 20972.2,-4921.7 21018.67,-4901.25 21050.71,-4885.5"/>
<polygon fill="red" stroke="red" points="21052.38,-4888.59 21059.77,-4880.99 21049.25,-4882.32 21052.38,-4888.59"/>
<text text-anchor="middle" x="20839.5" y="-4943.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu2 -->
<g id="node787" class="node">
<title>l3_attn_stage7_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20634" cy="-4863.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20634" y="-4874.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="20634" y="-4859.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20634" y="-4844.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu2&#45;&gt;l3_attn_stage7_gpu2 -->
<g id="edge1203" class="edge">
<title>l3_attn_stage6_gpu2&#45;&gt;l3_attn_stage7_gpu2</title>
<path fill="none" stroke="black" d="M20580.74,-4980.22C20566.89,-4973.96 20551.71,-4968.22 20537,-4964.83 20513.17,-4959.34 20114.09,-4972.32 20097,-4954.83 20092.34,-4950.07 20092.33,-4944.59 20097,-4939.83 20105.56,-4931.11 20525.37,-4935.6 20537,-4931.83 20555.45,-4925.86 20573.49,-4915.1 20588.92,-4903.9"/>
<polygon fill="black" stroke="black" points="20591.32,-4906.47 20597.2,-4897.66 20587.11,-4900.88 20591.32,-4906.47"/>
</g>
<!-- l3_attn_stage6_gpu2&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge2803" class="edge">
<title>l3_attn_stage6_gpu2&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20687.3,-4980.39C20701.44,-4974.05 20716.96,-4968.22 20732,-4964.83 20747.53,-4961.33 21293.84,-4966.19 21305,-4954.83 21345.03,-4914.1 21275.32,-4890.74 21205.01,-4877.99"/>
<polygon fill="red" stroke="red" points="21205.55,-4874.53 21195.1,-4876.27 21204.35,-4881.43 21205.55,-4874.53"/>
<text text-anchor="middle" x="21345.5" y="-4943.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu3 -->
<g id="node788" class="node">
<title>l3_attn_stage7_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="20049" cy="-4863.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20049" y="-4874.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="20049" y="-4859.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="20049" y="-4844.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu3&#45;&gt;l3_attn_stage7_gpu3 -->
<g id="edge1204" class="edge">
<title>l3_attn_stage6_gpu3&#45;&gt;l3_attn_stage7_gpu3</title>
<path fill="none" stroke="black" d="M20049,-4972.74C20049,-4954.02 20049,-4931.03 20049,-4911.05"/>
<polygon fill="black" stroke="black" points="20052.5,-4910.91 20049,-4900.91 20045.5,-4910.91 20052.5,-4910.91"/>
</g>
<!-- l3_attn_stage6_gpu3&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge2804" class="edge">
<title>l3_attn_stage6_gpu3&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20102.29,-4980.33C20116.42,-4973.99 20131.95,-4968.18 20147,-4964.83 20171.41,-4959.41 21025.88,-4968.21 21047,-4954.83 21068.94,-4940.93 21080.24,-4912.65 21085.85,-4891.39"/>
<polygon fill="red" stroke="red" points="21089.27,-4892.14 21088.18,-4881.6 21082.46,-4890.52 21089.27,-4892.14"/>
<text text-anchor="middle" x="21093.5" y="-4943.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu4 -->
<g id="node789" class="node">
<title>l3_attn_stage7_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="18294" cy="-4863.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18294" y="-4874.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="18294" y="-4859.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="18294" y="-4844.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu4&#45;&gt;l3_attn_stage7_gpu4 -->
<g id="edge1205" class="edge">
<title>l3_attn_stage6_gpu4&#45;&gt;l3_attn_stage7_gpu4</title>
<path fill="none" stroke="black" d="M18294,-4972.74C18294,-4954.02 18294,-4931.03 18294,-4911.05"/>
<polygon fill="black" stroke="black" points="18297.5,-4910.91 18294,-4900.91 18290.5,-4910.91 18297.5,-4910.91"/>
</g>
<!-- l3_attn_stage6_gpu4&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge2805" class="edge">
<title>l3_attn_stage6_gpu4&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18346.96,-4980.15C18360.88,-4973.86 18376.17,-4968.11 18391,-4964.83 18442.04,-4953.54 20223.66,-4972.11 20273,-4954.83 20283.15,-4951.28 20281.86,-4943.42 20292,-4939.83 20325.36,-4928.02 20894.34,-4938.99 20929,-4931.83 20972.86,-4922.77 21019.76,-4901.86 21051.75,-4885.7"/>
<polygon fill="red" stroke="red" points="21053.48,-4888.75 21060.77,-4881.07 21050.28,-4882.52 21053.48,-4888.75"/>
<text text-anchor="middle" x="20323.5" y="-4943.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu5 -->
<g id="node790" class="node">
<title>l3_attn_stage7_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="19074" cy="-4863.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19074" y="-4874.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="19074" y="-4859.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="19074" y="-4844.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu5&#45;&gt;l3_attn_stage7_gpu5 -->
<g id="edge1206" class="edge">
<title>l3_attn_stage6_gpu5&#45;&gt;l3_attn_stage7_gpu5</title>
<path fill="none" stroke="black" d="M19074,-4972.74C19074,-4954.02 19074,-4931.03 19074,-4911.05"/>
<polygon fill="black" stroke="black" points="19077.5,-4910.91 19074,-4900.91 19070.5,-4910.91 19077.5,-4910.91"/>
</g>
<!-- l3_attn_stage6_gpu5&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge2806" class="edge">
<title>l3_attn_stage6_gpu5&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19126.96,-4980.17C19140.89,-4973.88 19156.17,-4968.13 19171,-4964.83 19210.21,-4956.13 20579.1,-4968.14 20617,-4954.83 20627.15,-4951.27 20625.89,-4943.5 20636,-4939.83 20666.62,-4928.73 20897.15,-4938.65 20929,-4931.83 20972.66,-4922.48 21019.41,-4901.72 21051.42,-4885.67"/>
<polygon fill="red" stroke="red" points="21053.12,-4888.73 21060.45,-4881.07 21049.95,-4882.49 21053.12,-4888.73"/>
<text text-anchor="middle" x="20667.5" y="-4943.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu6 -->
<g id="node791" class="node">
<title>l3_attn_stage7_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19854" cy="-4863.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19854" y="-4874.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="19854" y="-4859.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19854" y="-4844.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu6&#45;&gt;l3_attn_stage7_gpu6 -->
<g id="edge1207" class="edge">
<title>l3_attn_stage6_gpu6&#45;&gt;l3_attn_stage7_gpu6</title>
<path fill="none" stroke="black" d="M19854,-4972.74C19854,-4954.02 19854,-4931.03 19854,-4911.05"/>
<polygon fill="black" stroke="black" points="19857.5,-4910.91 19854,-4900.91 19850.5,-4910.91 19857.5,-4910.91"/>
</g>
<!-- l3_attn_stage6_gpu6&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge2807" class="edge">
<title>l3_attn_stage6_gpu6&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19907.29,-4980.31C19921.42,-4973.97 19936.95,-4968.17 19952,-4964.83 20006.73,-4952.7 20908.13,-4973.48 20961,-4954.83 20971.15,-4951.25 20971.32,-4946.2 20980,-4939.83 21005.22,-4921.34 21034.5,-4901.49 21056.65,-4886.78"/>
<polygon fill="red" stroke="red" points="21058.66,-4889.65 21065.07,-4881.22 21054.8,-4883.81 21058.66,-4889.65"/>
<text text-anchor="middle" x="21011.5" y="-4943.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu7 -->
<g id="node792" class="node">
<title>l3_attn_stage7_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="18489" cy="-4863.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18489" y="-4874.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="18489" y="-4859.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="18489" y="-4844.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu7&#45;&gt;l3_attn_stage7_gpu7 -->
<g id="edge1208" class="edge">
<title>l3_attn_stage6_gpu7&#45;&gt;l3_attn_stage7_gpu7</title>
<path fill="none" stroke="black" d="M18489,-4972.74C18489,-4954.02 18489,-4931.03 18489,-4911.05"/>
<polygon fill="black" stroke="black" points="18492.5,-4910.91 18489,-4900.91 18485.5,-4910.91 18492.5,-4910.91"/>
</g>
<!-- l3_attn_stage6_gpu7&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge2808" class="edge">
<title>l3_attn_stage6_gpu7&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18541.96,-4980.16C18555.88,-4973.86 18571.17,-4968.12 18586,-4964.83 18634.09,-4954.19 20312.52,-4971.12 20359,-4954.83 20369.15,-4951.28 20367.86,-4943.43 20378,-4939.83 20406.85,-4929.58 20899.02,-4938.05 20929,-4931.83 20972.85,-4922.73 21019.75,-4901.83 21051.75,-4885.68"/>
<polygon fill="red" stroke="red" points="21053.47,-4888.73 21060.77,-4881.05 21050.27,-4882.5 21053.47,-4888.73"/>
<text text-anchor="middle" x="20409.5" y="-4943.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu8 -->
<g id="node793" class="node">
<title>l3_attn_stage7_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20244" cy="-4863.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20244" y="-4874.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="20244" y="-4859.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20244" y="-4844.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu8&#45;&gt;l3_attn_stage7_gpu8 -->
<g id="edge1209" class="edge">
<title>l3_attn_stage6_gpu8&#45;&gt;l3_attn_stage7_gpu8</title>
<path fill="none" stroke="black" d="M20188.85,-4980.87C20175.43,-4974.83 20160.93,-4969.03 20147,-4964.83 20133.22,-4960.68 20092.36,-4965.77 20083,-4954.83 20048.08,-4914.03 20088.79,-4954.15 20147,-4931.83 20164.78,-4925.02 20182.42,-4914.27 20197.68,-4903.34"/>
<polygon fill="black" stroke="black" points="20199.93,-4906.03 20205.9,-4897.27 20195.77,-4900.39 20199.93,-4906.03"/>
</g>
<!-- l3_attn_stage6_gpu8&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge2809" class="edge">
<title>l3_attn_stage6_gpu8&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20297.29,-4980.34C20311.43,-4974 20326.95,-4968.19 20342,-4964.83 20363.45,-4960.05 21117.56,-4970.47 21133,-4954.83 21151.16,-4936.44 21133.89,-4908.75 21116.31,-4888.84"/>
<polygon fill="red" stroke="red" points="21118.75,-4886.32 21109.38,-4881.37 21113.61,-4891.08 21118.75,-4886.32"/>
<text text-anchor="middle" x="21171.5" y="-4943.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu9 -->
<g id="node794" class="node">
<title>l3_attn_stage7_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="19659" cy="-4863.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19659" y="-4874.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="19659" y="-4859.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="19659" y="-4844.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu9&#45;&gt;l3_attn_stage7_gpu9 -->
<g id="edge1210" class="edge">
<title>l3_attn_stage6_gpu9&#45;&gt;l3_attn_stage7_gpu9</title>
<path fill="none" stroke="black" d="M19659,-4972.74C19659,-4954.02 19659,-4931.03 19659,-4911.05"/>
<polygon fill="black" stroke="black" points="19662.5,-4910.91 19659,-4900.91 19655.5,-4910.91 19662.5,-4910.91"/>
</g>
<!-- l3_attn_stage6_gpu9&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge2810" class="edge">
<title>l3_attn_stage6_gpu9&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19712.28,-4980.3C19726.42,-4973.97 19741.95,-4968.16 19757,-4964.83 19817.65,-4951.42 20816.41,-4975.47 20875,-4954.83 20885.15,-4951.26 20884.3,-4944.48 20894,-4939.83 20908.39,-4932.94 20913.8,-4936.7 20929,-4931.83 20969.94,-4918.73 21014.95,-4899.57 21047.12,-4885.01"/>
<polygon fill="red" stroke="red" points="21048.61,-4888.18 21056.25,-4880.84 21045.7,-4881.81 21048.61,-4888.18"/>
<text text-anchor="middle" x="20925.5" y="-4943.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu10 -->
<g id="node795" class="node">
<title>l3_attn_stage7_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="17904" cy="-4863.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="17904" y="-4874.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="17904" y="-4859.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17904" y="-4844.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu10&#45;&gt;l3_attn_stage7_gpu10 -->
<g id="edge1211" class="edge">
<title>l3_attn_stage6_gpu10&#45;&gt;l3_attn_stage7_gpu10</title>
<path fill="none" stroke="black" d="M17904,-4972.74C17904,-4954.02 17904,-4931.03 17904,-4911.05"/>
<polygon fill="black" stroke="black" points="17907.5,-4910.91 17904,-4900.91 17900.5,-4910.91 17907.5,-4910.91"/>
</g>
<!-- l3_attn_stage6_gpu10&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge2811" class="edge">
<title>l3_attn_stage6_gpu10&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17956.97,-4980.22C17970.9,-4973.92 17986.18,-4968.16 18001,-4964.83 18230.74,-4913.23 19884.55,-4942.39 20120,-4939.83 20164.94,-4939.35 20884.97,-4940.87 20929,-4931.83 20972.87,-4922.83 21019.77,-4901.91 21051.76,-4885.73"/>
<polygon fill="red" stroke="red" points="21053.49,-4888.78 21060.78,-4881.09 21050.28,-4882.55 21053.49,-4888.78"/>
<text text-anchor="middle" x="20151.5" y="-4943.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu11 -->
<g id="node796" class="node">
<title>l3_attn_stage7_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="18684" cy="-4863.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18684" y="-4874.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="18684" y="-4859.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18684" y="-4844.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu11&#45;&gt;l3_attn_stage7_gpu11 -->
<g id="edge1212" class="edge">
<title>l3_attn_stage6_gpu11&#45;&gt;l3_attn_stage7_gpu11</title>
<path fill="none" stroke="black" d="M18684,-4972.74C18684,-4954.02 18684,-4931.03 18684,-4911.05"/>
<polygon fill="black" stroke="black" points="18687.5,-4910.91 18684,-4900.91 18680.5,-4910.91 18687.5,-4910.91"/>
</g>
<!-- l3_attn_stage6_gpu11&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge2812" class="edge">
<title>l3_attn_stage6_gpu11&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18736.96,-4980.16C18750.88,-4973.87 18766.17,-4968.12 18781,-4964.83 18826.13,-4954.83 20401.38,-4970.12 20445,-4954.83 20455.15,-4951.27 20453.87,-4943.45 20464,-4939.83 20512.67,-4922.47 20878.42,-4942.4 20929,-4931.83 20972.84,-4922.67 21019.74,-4901.78 21051.74,-4885.64"/>
<polygon fill="red" stroke="red" points="21053.46,-4888.7 21060.76,-4881.02 21050.27,-4882.47 21053.46,-4888.7"/>
<text text-anchor="middle" x="20495.5" y="-4943.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu12 -->
<g id="node797" class="node">
<title>l3_attn_stage7_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="18099" cy="-4863.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18099" y="-4874.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="18099" y="-4859.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18099" y="-4844.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu12&#45;&gt;l3_attn_stage7_gpu12 -->
<g id="edge1213" class="edge">
<title>l3_attn_stage6_gpu12&#45;&gt;l3_attn_stage7_gpu12</title>
<path fill="none" stroke="black" d="M18099,-4972.74C18099,-4954.02 18099,-4931.03 18099,-4911.05"/>
<polygon fill="black" stroke="black" points="18102.5,-4910.91 18099,-4900.91 18095.5,-4910.91 18102.5,-4910.91"/>
</g>
<!-- l3_attn_stage6_gpu12&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge2813" class="edge">
<title>l3_attn_stage6_gpu12&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18151.96,-4980.15C18165.88,-4973.86 18181.17,-4968.11 18196,-4964.83 18250,-4952.89 20134.8,-4973.1 20187,-4954.83 20197.15,-4951.28 20195.86,-4943.42 20206,-4939.83 20243.87,-4926.45 20889.66,-4939.93 20929,-4931.83 20972.87,-4922.81 21019.77,-4901.89 21051.76,-4885.72"/>
<polygon fill="red" stroke="red" points="21053.48,-4888.77 21060.78,-4881.08 21050.28,-4882.54 21053.48,-4888.77"/>
<text text-anchor="middle" x="20237.5" y="-4943.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu13 -->
<g id="node798" class="node">
<title>l3_attn_stage7_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="18879" cy="-4863.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18879" y="-4874.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="18879" y="-4859.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18879" y="-4844.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu13&#45;&gt;l3_attn_stage7_gpu13 -->
<g id="edge1214" class="edge">
<title>l3_attn_stage6_gpu13&#45;&gt;l3_attn_stage7_gpu13</title>
<path fill="none" stroke="black" d="M18879,-4972.74C18879,-4954.02 18879,-4931.03 18879,-4911.05"/>
<polygon fill="black" stroke="black" points="18882.5,-4910.91 18879,-4900.91 18875.5,-4910.91 18882.5,-4910.91"/>
</g>
<!-- l3_attn_stage6_gpu13&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge2814" class="edge">
<title>l3_attn_stage6_gpu13&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18931.96,-4980.16C18945.89,-4973.87 18961.17,-4968.12 18976,-4964.83 19018.17,-4955.48 20490.24,-4969.13 20531,-4954.83 20541.15,-4951.27 20539.87,-4943.47 20550,-4939.83 20589.64,-4925.6 20887.79,-4940.53 20929,-4931.83 20972.82,-4922.59 21019.73,-4901.7 21051.73,-4885.6"/>
<polygon fill="red" stroke="red" points="21053.45,-4888.65 21060.75,-4880.98 21050.26,-4882.42 21053.45,-4888.65"/>
<text text-anchor="middle" x="20581.5" y="-4943.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu14 -->
<g id="node799" class="node">
<title>l3_attn_stage7_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19269" cy="-4863.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19269" y="-4874.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="19269" y="-4859.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19269" y="-4844.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu14&#45;&gt;l3_attn_stage7_gpu14 -->
<g id="edge1215" class="edge">
<title>l3_attn_stage6_gpu14&#45;&gt;l3_attn_stage7_gpu14</title>
<path fill="none" stroke="black" d="M19269,-4972.74C19269,-4954.02 19269,-4931.03 19269,-4911.05"/>
<polygon fill="black" stroke="black" points="19272.5,-4910.91 19269,-4900.91 19265.5,-4910.91 19272.5,-4910.91"/>
</g>
<!-- l3_attn_stage6_gpu14&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge2815" class="edge">
<title>l3_attn_stage6_gpu14&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19322.28,-4980.29C19336.42,-4973.95 19351.95,-4968.15 19367,-4964.83 19403.24,-4956.85 20667.99,-4967.14 20703,-4954.83 20713.15,-4951.27 20711.91,-4943.56 20722,-4939.83 20765.19,-4923.9 20884.04,-4941.73 20929,-4931.83 20972.6,-4922.23 21019.37,-4901.51 21051.39,-4885.54"/>
<polygon fill="red" stroke="red" points="21053.08,-4888.6 21060.42,-4880.96 21049.92,-4882.36 21053.08,-4888.6"/>
<text text-anchor="middle" x="20753.5" y="-4943.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu15 -->
<g id="node800" class="node">
<title>l3_attn_stage7_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20439" cy="-4863.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20439" y="-4874.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="20439" y="-4859.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20439" y="-4844.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu15&#45;&gt;l3_attn_stage7_gpu15 -->
<g id="edge1216" class="edge">
<title>l3_attn_stage6_gpu15&#45;&gt;l3_attn_stage7_gpu15</title>
<path fill="none" stroke="black" d="M20385.7,-4980.39C20371.85,-4974.13 20356.69,-4968.35 20342,-4964.83 20328.37,-4961.57 20099.71,-4964.93 20090,-4954.83 20085.38,-4950.03 20085.36,-4944.62 20090,-4939.83 20099.75,-4929.77 20328.7,-4936.24 20342,-4931.83 20360.4,-4925.74 20378.44,-4914.94 20393.87,-4903.75"/>
<polygon fill="black" stroke="black" points="20396.27,-4906.33 20402.16,-4897.52 20392.06,-4900.73 20396.27,-4906.33"/>
</g>
<!-- l3_attn_stage6_gpu15&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge2816" class="edge">
<title>l3_attn_stage6_gpu15&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20492.3,-4980.36C20506.43,-4974.02 20521.96,-4968.2 20537,-4964.83 20555.49,-4960.69 21205.7,-4968.33 21219,-4954.83 21247.36,-4926.06 21199.79,-4900.22 21154.82,-4883.6"/>
<polygon fill="red" stroke="red" points="21155.88,-4880.26 21145.29,-4880.19 21153.53,-4886.85 21155.88,-4880.26"/>
<text text-anchor="middle" x="21258.5" y="-4943.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu0 -->
<g id="node801" class="node">
<title>l3_attn_stage8_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20829" cy="-4716.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20829" y="-4727.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="20829" y="-4712.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20829" y="-4697.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu0&#45;&gt;l3_attn_stage8_gpu0 -->
<g id="edge1217" class="edge">
<title>l3_attn_stage7_gpu0&#45;&gt;l3_attn_stage8_gpu0</title>
<path fill="none" stroke="black" d="M20776.02,-4833.26C20762.09,-4826.97 20746.82,-4821.19 20732,-4817.83 20714.99,-4813.97 20116.24,-4820.27 20104,-4807.83 20099.32,-4803.08 20099.32,-4797.58 20104,-4792.83 20116.26,-4780.42 20715.39,-4790.16 20732,-4784.83 20750.46,-4778.91 20768.51,-4768.16 20783.94,-4756.96"/>
<polygon fill="black" stroke="black" points="20786.34,-4759.53 20792.22,-4750.72 20782.13,-4753.94 20786.34,-4759.53"/>
</g>
<!-- l3_attn_stage8_gpu[next_gpu] -->
<g id="node1382" class="node">
<title>l3_attn_stage8_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="21091" cy="-4716.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="21091" y="-4712.63" font-family="Times,serif" font-size="14.00">l3_attn_stage8_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage7_gpu0&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge2817" class="edge">
<title>l3_attn_stage7_gpu0&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20884.38,-4834.02C20899.74,-4827.45 20916.68,-4821.36 20933,-4817.83 20957.87,-4812.45 21373.2,-4826.02 21391,-4807.83 21445.67,-4751.96 21344.45,-4730.3 21245.12,-4722.04"/>
<polygon fill="red" stroke="red" points="21245.15,-4718.53 21234.9,-4721.24 21244.6,-4725.51 21245.15,-4718.53"/>
<text text-anchor="middle" x="21431.5" y="-4796.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu1 -->
<g id="node802" class="node">
<title>l3_attn_stage8_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19464" cy="-4716.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19464" y="-4727.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="19464" y="-4712.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19464" y="-4697.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu1&#45;&gt;l3_attn_stage8_gpu1 -->
<g id="edge1218" class="edge">
<title>l3_attn_stage7_gpu1&#45;&gt;l3_attn_stage8_gpu1</title>
<path fill="none" stroke="black" d="M19464,-4825.74C19464,-4807.02 19464,-4784.03 19464,-4764.05"/>
<polygon fill="black" stroke="black" points="19467.5,-4763.91 19464,-4753.91 19460.5,-4763.91 19467.5,-4763.91"/>
</g>
<!-- l3_attn_stage7_gpu1&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge2818" class="edge">
<title>l3_attn_stage7_gpu1&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19517.28,-4833.3C19531.42,-4826.96 19546.95,-4821.15 19562,-4817.83 19628.57,-4803.14 20724.69,-4830.45 20789,-4807.83 20799.15,-4804.26 20797.96,-4796.69 20808,-4792.83 20858.3,-4773.49 20876.53,-4797.14 20929,-4784.83 20972.2,-4774.7 21018.67,-4754.25 21050.71,-4738.5"/>
<polygon fill="red" stroke="red" points="21052.38,-4741.59 21059.77,-4733.99 21049.25,-4735.32 21052.38,-4741.59"/>
<text text-anchor="middle" x="20839.5" y="-4796.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu2 -->
<g id="node803" class="node">
<title>l3_attn_stage8_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20634" cy="-4716.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20634" y="-4727.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="20634" y="-4712.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20634" y="-4697.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu2&#45;&gt;l3_attn_stage8_gpu2 -->
<g id="edge1219" class="edge">
<title>l3_attn_stage7_gpu2&#45;&gt;l3_attn_stage8_gpu2</title>
<path fill="none" stroke="black" d="M20580.74,-4833.22C20566.89,-4826.96 20551.71,-4821.22 20537,-4817.83 20513.17,-4812.34 20114.09,-4825.32 20097,-4807.83 20092.34,-4803.07 20092.33,-4797.59 20097,-4792.83 20105.56,-4784.11 20525.37,-4788.6 20537,-4784.83 20555.45,-4778.86 20573.49,-4768.1 20588.92,-4756.9"/>
<polygon fill="black" stroke="black" points="20591.32,-4759.47 20597.2,-4750.66 20587.11,-4753.88 20591.32,-4759.47"/>
</g>
<!-- l3_attn_stage7_gpu2&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge2819" class="edge">
<title>l3_attn_stage7_gpu2&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20687.3,-4833.39C20701.44,-4827.05 20716.96,-4821.22 20732,-4817.83 20747.53,-4814.33 21293.84,-4819.19 21305,-4807.83 21345.03,-4767.1 21275.32,-4743.74 21205.01,-4730.99"/>
<polygon fill="red" stroke="red" points="21205.55,-4727.53 21195.1,-4729.27 21204.35,-4734.43 21205.55,-4727.53"/>
<text text-anchor="middle" x="21345.5" y="-4796.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu3 -->
<g id="node804" class="node">
<title>l3_attn_stage8_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="20049" cy="-4716.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20049" y="-4727.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="20049" y="-4712.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="20049" y="-4697.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu3&#45;&gt;l3_attn_stage8_gpu3 -->
<g id="edge1220" class="edge">
<title>l3_attn_stage7_gpu3&#45;&gt;l3_attn_stage8_gpu3</title>
<path fill="none" stroke="black" d="M20049,-4825.74C20049,-4807.02 20049,-4784.03 20049,-4764.05"/>
<polygon fill="black" stroke="black" points="20052.5,-4763.91 20049,-4753.91 20045.5,-4763.91 20052.5,-4763.91"/>
</g>
<!-- l3_attn_stage7_gpu3&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge2820" class="edge">
<title>l3_attn_stage7_gpu3&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20102.29,-4833.33C20116.42,-4826.99 20131.95,-4821.18 20147,-4817.83 20171.41,-4812.41 21025.88,-4821.21 21047,-4807.83 21068.94,-4793.93 21080.24,-4765.65 21085.85,-4744.39"/>
<polygon fill="red" stroke="red" points="21089.27,-4745.14 21088.18,-4734.6 21082.46,-4743.52 21089.27,-4745.14"/>
<text text-anchor="middle" x="21093.5" y="-4796.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu4 -->
<g id="node805" class="node">
<title>l3_attn_stage8_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="18294" cy="-4716.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18294" y="-4727.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="18294" y="-4712.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="18294" y="-4697.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu4&#45;&gt;l3_attn_stage8_gpu4 -->
<g id="edge1221" class="edge">
<title>l3_attn_stage7_gpu4&#45;&gt;l3_attn_stage8_gpu4</title>
<path fill="none" stroke="black" d="M18294,-4825.74C18294,-4807.02 18294,-4784.03 18294,-4764.05"/>
<polygon fill="black" stroke="black" points="18297.5,-4763.91 18294,-4753.91 18290.5,-4763.91 18297.5,-4763.91"/>
</g>
<!-- l3_attn_stage7_gpu4&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge2821" class="edge">
<title>l3_attn_stage7_gpu4&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18346.96,-4833.15C18360.88,-4826.86 18376.17,-4821.11 18391,-4817.83 18442.04,-4806.54 20223.66,-4825.11 20273,-4807.83 20283.15,-4804.28 20281.86,-4796.42 20292,-4792.83 20325.36,-4781.02 20894.34,-4791.99 20929,-4784.83 20972.86,-4775.77 21019.76,-4754.86 21051.75,-4738.7"/>
<polygon fill="red" stroke="red" points="21053.48,-4741.75 21060.77,-4734.07 21050.28,-4735.52 21053.48,-4741.75"/>
<text text-anchor="middle" x="20323.5" y="-4796.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu5 -->
<g id="node806" class="node">
<title>l3_attn_stage8_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="19074" cy="-4716.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19074" y="-4727.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="19074" y="-4712.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="19074" y="-4697.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu5&#45;&gt;l3_attn_stage8_gpu5 -->
<g id="edge1222" class="edge">
<title>l3_attn_stage7_gpu5&#45;&gt;l3_attn_stage8_gpu5</title>
<path fill="none" stroke="black" d="M19074,-4825.74C19074,-4807.02 19074,-4784.03 19074,-4764.05"/>
<polygon fill="black" stroke="black" points="19077.5,-4763.91 19074,-4753.91 19070.5,-4763.91 19077.5,-4763.91"/>
</g>
<!-- l3_attn_stage7_gpu5&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge2822" class="edge">
<title>l3_attn_stage7_gpu5&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19126.96,-4833.17C19140.89,-4826.88 19156.17,-4821.13 19171,-4817.83 19210.21,-4809.13 20579.1,-4821.14 20617,-4807.83 20627.15,-4804.27 20625.89,-4796.5 20636,-4792.83 20666.62,-4781.73 20897.15,-4791.65 20929,-4784.83 20972.66,-4775.48 21019.41,-4754.72 21051.42,-4738.67"/>
<polygon fill="red" stroke="red" points="21053.12,-4741.73 21060.45,-4734.07 21049.95,-4735.49 21053.12,-4741.73"/>
<text text-anchor="middle" x="20667.5" y="-4796.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu6 -->
<g id="node807" class="node">
<title>l3_attn_stage8_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19854" cy="-4716.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19854" y="-4727.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="19854" y="-4712.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19854" y="-4697.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu6&#45;&gt;l3_attn_stage8_gpu6 -->
<g id="edge1223" class="edge">
<title>l3_attn_stage7_gpu6&#45;&gt;l3_attn_stage8_gpu6</title>
<path fill="none" stroke="black" d="M19854,-4825.74C19854,-4807.02 19854,-4784.03 19854,-4764.05"/>
<polygon fill="black" stroke="black" points="19857.5,-4763.91 19854,-4753.91 19850.5,-4763.91 19857.5,-4763.91"/>
</g>
<!-- l3_attn_stage7_gpu6&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge2823" class="edge">
<title>l3_attn_stage7_gpu6&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19907.29,-4833.31C19921.42,-4826.97 19936.95,-4821.17 19952,-4817.83 20006.73,-4805.7 20908.13,-4826.48 20961,-4807.83 20971.15,-4804.25 20971.32,-4799.2 20980,-4792.83 21005.22,-4774.34 21034.5,-4754.49 21056.65,-4739.78"/>
<polygon fill="red" stroke="red" points="21058.66,-4742.65 21065.07,-4734.22 21054.8,-4736.81 21058.66,-4742.65"/>
<text text-anchor="middle" x="21011.5" y="-4796.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu7 -->
<g id="node808" class="node">
<title>l3_attn_stage8_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="18489" cy="-4716.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18489" y="-4727.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="18489" y="-4712.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="18489" y="-4697.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu7&#45;&gt;l3_attn_stage8_gpu7 -->
<g id="edge1224" class="edge">
<title>l3_attn_stage7_gpu7&#45;&gt;l3_attn_stage8_gpu7</title>
<path fill="none" stroke="black" d="M18489,-4825.74C18489,-4807.02 18489,-4784.03 18489,-4764.05"/>
<polygon fill="black" stroke="black" points="18492.5,-4763.91 18489,-4753.91 18485.5,-4763.91 18492.5,-4763.91"/>
</g>
<!-- l3_attn_stage7_gpu7&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge2824" class="edge">
<title>l3_attn_stage7_gpu7&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18541.96,-4833.16C18555.88,-4826.86 18571.17,-4821.12 18586,-4817.83 18634.09,-4807.19 20312.52,-4824.12 20359,-4807.83 20369.15,-4804.28 20367.86,-4796.43 20378,-4792.83 20406.85,-4782.58 20899.02,-4791.05 20929,-4784.83 20972.85,-4775.73 21019.75,-4754.83 21051.75,-4738.68"/>
<polygon fill="red" stroke="red" points="21053.47,-4741.73 21060.77,-4734.05 21050.27,-4735.5 21053.47,-4741.73"/>
<text text-anchor="middle" x="20409.5" y="-4796.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu8 -->
<g id="node809" class="node">
<title>l3_attn_stage8_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20244" cy="-4716.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20244" y="-4727.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="20244" y="-4712.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20244" y="-4697.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu8&#45;&gt;l3_attn_stage8_gpu8 -->
<g id="edge1225" class="edge">
<title>l3_attn_stage7_gpu8&#45;&gt;l3_attn_stage8_gpu8</title>
<path fill="none" stroke="black" d="M20188.85,-4833.87C20175.43,-4827.83 20160.93,-4822.03 20147,-4817.83 20133.22,-4813.68 20092.36,-4818.77 20083,-4807.83 20048.08,-4767.03 20088.79,-4807.15 20147,-4784.83 20164.78,-4778.02 20182.42,-4767.27 20197.68,-4756.34"/>
<polygon fill="black" stroke="black" points="20199.93,-4759.03 20205.9,-4750.27 20195.77,-4753.39 20199.93,-4759.03"/>
</g>
<!-- l3_attn_stage7_gpu8&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge2825" class="edge">
<title>l3_attn_stage7_gpu8&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20297.29,-4833.34C20311.43,-4827 20326.95,-4821.19 20342,-4817.83 20363.45,-4813.05 21117.56,-4823.47 21133,-4807.83 21151.16,-4789.44 21133.89,-4761.75 21116.31,-4741.84"/>
<polygon fill="red" stroke="red" points="21118.75,-4739.32 21109.38,-4734.37 21113.61,-4744.08 21118.75,-4739.32"/>
<text text-anchor="middle" x="21171.5" y="-4796.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu9 -->
<g id="node810" class="node">
<title>l3_attn_stage8_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="19659" cy="-4716.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19659" y="-4727.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="19659" y="-4712.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="19659" y="-4697.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu9&#45;&gt;l3_attn_stage8_gpu9 -->
<g id="edge1226" class="edge">
<title>l3_attn_stage7_gpu9&#45;&gt;l3_attn_stage8_gpu9</title>
<path fill="none" stroke="black" d="M19659,-4825.74C19659,-4807.02 19659,-4784.03 19659,-4764.05"/>
<polygon fill="black" stroke="black" points="19662.5,-4763.91 19659,-4753.91 19655.5,-4763.91 19662.5,-4763.91"/>
</g>
<!-- l3_attn_stage7_gpu9&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge2826" class="edge">
<title>l3_attn_stage7_gpu9&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19712.28,-4833.3C19726.42,-4826.97 19741.95,-4821.16 19757,-4817.83 19817.65,-4804.42 20816.41,-4828.47 20875,-4807.83 20885.15,-4804.26 20884.3,-4797.48 20894,-4792.83 20908.39,-4785.94 20913.8,-4789.7 20929,-4784.83 20969.94,-4771.73 21014.95,-4752.57 21047.12,-4738.01"/>
<polygon fill="red" stroke="red" points="21048.61,-4741.18 21056.25,-4733.84 21045.7,-4734.81 21048.61,-4741.18"/>
<text text-anchor="middle" x="20925.5" y="-4796.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu10 -->
<g id="node811" class="node">
<title>l3_attn_stage8_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="17904" cy="-4716.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="17904" y="-4727.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="17904" y="-4712.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17904" y="-4697.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu10&#45;&gt;l3_attn_stage8_gpu10 -->
<g id="edge1227" class="edge">
<title>l3_attn_stage7_gpu10&#45;&gt;l3_attn_stage8_gpu10</title>
<path fill="none" stroke="black" d="M17904,-4825.74C17904,-4807.02 17904,-4784.03 17904,-4764.05"/>
<polygon fill="black" stroke="black" points="17907.5,-4763.91 17904,-4753.91 17900.5,-4763.91 17907.5,-4763.91"/>
</g>
<!-- l3_attn_stage7_gpu10&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge2827" class="edge">
<title>l3_attn_stage7_gpu10&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17956.97,-4833.22C17970.9,-4826.92 17986.18,-4821.16 18001,-4817.83 18230.74,-4766.23 19884.55,-4795.39 20120,-4792.83 20164.94,-4792.35 20884.97,-4793.87 20929,-4784.83 20972.87,-4775.83 21019.77,-4754.91 21051.76,-4738.73"/>
<polygon fill="red" stroke="red" points="21053.49,-4741.78 21060.78,-4734.09 21050.28,-4735.55 21053.49,-4741.78"/>
<text text-anchor="middle" x="20151.5" y="-4796.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu11 -->
<g id="node812" class="node">
<title>l3_attn_stage8_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="18684" cy="-4716.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18684" y="-4727.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="18684" y="-4712.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18684" y="-4697.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu11&#45;&gt;l3_attn_stage8_gpu11 -->
<g id="edge1228" class="edge">
<title>l3_attn_stage7_gpu11&#45;&gt;l3_attn_stage8_gpu11</title>
<path fill="none" stroke="black" d="M18684,-4825.74C18684,-4807.02 18684,-4784.03 18684,-4764.05"/>
<polygon fill="black" stroke="black" points="18687.5,-4763.91 18684,-4753.91 18680.5,-4763.91 18687.5,-4763.91"/>
</g>
<!-- l3_attn_stage7_gpu11&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge2828" class="edge">
<title>l3_attn_stage7_gpu11&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18736.96,-4833.16C18750.88,-4826.87 18766.17,-4821.12 18781,-4817.83 18826.13,-4807.83 20401.38,-4823.12 20445,-4807.83 20455.15,-4804.27 20453.87,-4796.45 20464,-4792.83 20512.67,-4775.47 20878.42,-4795.4 20929,-4784.83 20972.84,-4775.67 21019.74,-4754.78 21051.74,-4738.64"/>
<polygon fill="red" stroke="red" points="21053.46,-4741.7 21060.76,-4734.02 21050.27,-4735.47 21053.46,-4741.7"/>
<text text-anchor="middle" x="20495.5" y="-4796.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu12 -->
<g id="node813" class="node">
<title>l3_attn_stage8_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="18099" cy="-4716.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18099" y="-4727.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="18099" y="-4712.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18099" y="-4697.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu12&#45;&gt;l3_attn_stage8_gpu12 -->
<g id="edge1229" class="edge">
<title>l3_attn_stage7_gpu12&#45;&gt;l3_attn_stage8_gpu12</title>
<path fill="none" stroke="black" d="M18099,-4825.74C18099,-4807.02 18099,-4784.03 18099,-4764.05"/>
<polygon fill="black" stroke="black" points="18102.5,-4763.91 18099,-4753.91 18095.5,-4763.91 18102.5,-4763.91"/>
</g>
<!-- l3_attn_stage7_gpu12&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge2829" class="edge">
<title>l3_attn_stage7_gpu12&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18151.96,-4833.15C18165.88,-4826.86 18181.17,-4821.11 18196,-4817.83 18250,-4805.89 20134.8,-4826.1 20187,-4807.83 20197.15,-4804.28 20195.86,-4796.42 20206,-4792.83 20243.87,-4779.45 20889.66,-4792.93 20929,-4784.83 20972.87,-4775.81 21019.77,-4754.89 21051.76,-4738.72"/>
<polygon fill="red" stroke="red" points="21053.48,-4741.77 21060.78,-4734.08 21050.28,-4735.54 21053.48,-4741.77"/>
<text text-anchor="middle" x="20237.5" y="-4796.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu13 -->
<g id="node814" class="node">
<title>l3_attn_stage8_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="18879" cy="-4716.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18879" y="-4727.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="18879" y="-4712.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18879" y="-4697.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu13&#45;&gt;l3_attn_stage8_gpu13 -->
<g id="edge1230" class="edge">
<title>l3_attn_stage7_gpu13&#45;&gt;l3_attn_stage8_gpu13</title>
<path fill="none" stroke="black" d="M18879,-4825.74C18879,-4807.02 18879,-4784.03 18879,-4764.05"/>
<polygon fill="black" stroke="black" points="18882.5,-4763.91 18879,-4753.91 18875.5,-4763.91 18882.5,-4763.91"/>
</g>
<!-- l3_attn_stage7_gpu13&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge2830" class="edge">
<title>l3_attn_stage7_gpu13&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18931.96,-4833.16C18945.89,-4826.87 18961.17,-4821.12 18976,-4817.83 19018.17,-4808.48 20490.24,-4822.13 20531,-4807.83 20541.15,-4804.27 20539.87,-4796.47 20550,-4792.83 20589.64,-4778.6 20887.79,-4793.53 20929,-4784.83 20972.82,-4775.59 21019.73,-4754.7 21051.73,-4738.6"/>
<polygon fill="red" stroke="red" points="21053.45,-4741.65 21060.75,-4733.98 21050.26,-4735.42 21053.45,-4741.65"/>
<text text-anchor="middle" x="20581.5" y="-4796.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu14 -->
<g id="node815" class="node">
<title>l3_attn_stage8_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19269" cy="-4716.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19269" y="-4727.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="19269" y="-4712.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19269" y="-4697.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu14&#45;&gt;l3_attn_stage8_gpu14 -->
<g id="edge1231" class="edge">
<title>l3_attn_stage7_gpu14&#45;&gt;l3_attn_stage8_gpu14</title>
<path fill="none" stroke="black" d="M19269,-4825.74C19269,-4807.02 19269,-4784.03 19269,-4764.05"/>
<polygon fill="black" stroke="black" points="19272.5,-4763.91 19269,-4753.91 19265.5,-4763.91 19272.5,-4763.91"/>
</g>
<!-- l3_attn_stage7_gpu14&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge2831" class="edge">
<title>l3_attn_stage7_gpu14&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19322.28,-4833.29C19336.42,-4826.95 19351.95,-4821.15 19367,-4817.83 19403.24,-4809.85 20667.99,-4820.14 20703,-4807.83 20713.15,-4804.27 20711.91,-4796.56 20722,-4792.83 20765.19,-4776.9 20884.04,-4794.73 20929,-4784.83 20972.6,-4775.23 21019.37,-4754.51 21051.39,-4738.54"/>
<polygon fill="red" stroke="red" points="21053.08,-4741.6 21060.42,-4733.96 21049.92,-4735.36 21053.08,-4741.6"/>
<text text-anchor="middle" x="20753.5" y="-4796.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu15 -->
<g id="node816" class="node">
<title>l3_attn_stage8_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20439" cy="-4716.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20439" y="-4727.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="20439" y="-4712.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20439" y="-4697.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu15&#45;&gt;l3_attn_stage8_gpu15 -->
<g id="edge1232" class="edge">
<title>l3_attn_stage7_gpu15&#45;&gt;l3_attn_stage8_gpu15</title>
<path fill="none" stroke="black" d="M20385.7,-4833.39C20371.85,-4827.13 20356.69,-4821.35 20342,-4817.83 20328.37,-4814.57 20099.71,-4817.93 20090,-4807.83 20085.38,-4803.03 20085.36,-4797.62 20090,-4792.83 20099.75,-4782.77 20328.7,-4789.24 20342,-4784.83 20360.4,-4778.74 20378.44,-4767.94 20393.87,-4756.75"/>
<polygon fill="black" stroke="black" points="20396.27,-4759.33 20402.16,-4750.52 20392.06,-4753.73 20396.27,-4759.33"/>
</g>
<!-- l3_attn_stage7_gpu15&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge2832" class="edge">
<title>l3_attn_stage7_gpu15&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20492.3,-4833.36C20506.43,-4827.02 20521.96,-4821.2 20537,-4817.83 20555.49,-4813.69 21205.7,-4821.33 21219,-4807.83 21247.36,-4779.06 21199.79,-4753.22 21154.82,-4736.6"/>
<polygon fill="red" stroke="red" points="21155.88,-4733.26 21145.29,-4733.19 21153.53,-4739.85 21155.88,-4733.26"/>
<text text-anchor="middle" x="21258.5" y="-4796.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu0 -->
<g id="node817" class="node">
<title>l3_attn_stage9_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20829" cy="-4569.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20829" y="-4580.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="20829" y="-4565.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20829" y="-4550.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu0&#45;&gt;l3_attn_stage9_gpu0 -->
<g id="edge1233" class="edge">
<title>l3_attn_stage8_gpu0&#45;&gt;l3_attn_stage9_gpu0</title>
<path fill="none" stroke="black" d="M20776.02,-4686.26C20762.09,-4679.97 20746.82,-4674.19 20732,-4670.83 20714.99,-4666.97 20116.24,-4673.27 20104,-4660.83 20099.32,-4656.08 20099.32,-4650.58 20104,-4645.83 20116.26,-4633.42 20715.39,-4643.16 20732,-4637.83 20750.46,-4631.91 20768.51,-4621.16 20783.94,-4609.96"/>
<polygon fill="black" stroke="black" points="20786.34,-4612.53 20792.22,-4603.72 20782.13,-4606.94 20786.34,-4612.53"/>
</g>
<!-- l3_attn_stage9_gpu[next_gpu] -->
<g id="node1383" class="node">
<title>l3_attn_stage9_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="21091" cy="-4569.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="21091" y="-4565.63" font-family="Times,serif" font-size="14.00">l3_attn_stage9_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage8_gpu0&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge2833" class="edge">
<title>l3_attn_stage8_gpu0&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20884.38,-4687.02C20899.74,-4680.45 20916.68,-4674.36 20933,-4670.83 20957.87,-4665.45 21373.2,-4679.02 21391,-4660.83 21445.67,-4604.96 21344.45,-4583.3 21245.12,-4575.04"/>
<polygon fill="red" stroke="red" points="21245.15,-4571.53 21234.9,-4574.24 21244.6,-4578.51 21245.15,-4571.53"/>
<text text-anchor="middle" x="21431.5" y="-4649.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu1 -->
<g id="node818" class="node">
<title>l3_attn_stage9_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19464" cy="-4569.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19464" y="-4580.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="19464" y="-4565.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19464" y="-4550.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu1&#45;&gt;l3_attn_stage9_gpu1 -->
<g id="edge1234" class="edge">
<title>l3_attn_stage8_gpu1&#45;&gt;l3_attn_stage9_gpu1</title>
<path fill="none" stroke="black" d="M19464,-4678.74C19464,-4660.02 19464,-4637.03 19464,-4617.05"/>
<polygon fill="black" stroke="black" points="19467.5,-4616.91 19464,-4606.91 19460.5,-4616.91 19467.5,-4616.91"/>
</g>
<!-- l3_attn_stage8_gpu1&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge2834" class="edge">
<title>l3_attn_stage8_gpu1&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19517.28,-4686.3C19531.42,-4679.96 19546.95,-4674.15 19562,-4670.83 19628.57,-4656.14 20724.69,-4683.45 20789,-4660.83 20799.15,-4657.26 20797.96,-4649.69 20808,-4645.83 20858.3,-4626.49 20876.53,-4650.14 20929,-4637.83 20972.2,-4627.7 21018.67,-4607.25 21050.71,-4591.5"/>
<polygon fill="red" stroke="red" points="21052.38,-4594.59 21059.77,-4586.99 21049.25,-4588.32 21052.38,-4594.59"/>
<text text-anchor="middle" x="20839.5" y="-4649.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu2 -->
<g id="node819" class="node">
<title>l3_attn_stage9_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20634" cy="-4569.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20634" y="-4580.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="20634" y="-4565.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20634" y="-4550.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu2&#45;&gt;l3_attn_stage9_gpu2 -->
<g id="edge1235" class="edge">
<title>l3_attn_stage8_gpu2&#45;&gt;l3_attn_stage9_gpu2</title>
<path fill="none" stroke="black" d="M20580.74,-4686.22C20566.89,-4679.96 20551.71,-4674.22 20537,-4670.83 20513.17,-4665.34 20114.09,-4678.32 20097,-4660.83 20092.34,-4656.07 20092.33,-4650.59 20097,-4645.83 20105.56,-4637.11 20525.37,-4641.6 20537,-4637.83 20555.45,-4631.86 20573.49,-4621.1 20588.92,-4609.9"/>
<polygon fill="black" stroke="black" points="20591.32,-4612.47 20597.2,-4603.66 20587.11,-4606.88 20591.32,-4612.47"/>
</g>
<!-- l3_attn_stage8_gpu2&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge2835" class="edge">
<title>l3_attn_stage8_gpu2&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20687.3,-4686.39C20701.44,-4680.05 20716.96,-4674.22 20732,-4670.83 20747.53,-4667.33 21293.84,-4672.19 21305,-4660.83 21345.03,-4620.1 21275.32,-4596.74 21205.01,-4583.99"/>
<polygon fill="red" stroke="red" points="21205.55,-4580.53 21195.1,-4582.27 21204.35,-4587.43 21205.55,-4580.53"/>
<text text-anchor="middle" x="21345.5" y="-4649.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu3 -->
<g id="node820" class="node">
<title>l3_attn_stage9_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="20049" cy="-4569.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20049" y="-4580.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="20049" y="-4565.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="20049" y="-4550.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu3&#45;&gt;l3_attn_stage9_gpu3 -->
<g id="edge1236" class="edge">
<title>l3_attn_stage8_gpu3&#45;&gt;l3_attn_stage9_gpu3</title>
<path fill="none" stroke="black" d="M20049,-4678.74C20049,-4660.02 20049,-4637.03 20049,-4617.05"/>
<polygon fill="black" stroke="black" points="20052.5,-4616.91 20049,-4606.91 20045.5,-4616.91 20052.5,-4616.91"/>
</g>
<!-- l3_attn_stage8_gpu3&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge2836" class="edge">
<title>l3_attn_stage8_gpu3&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20102.29,-4686.33C20116.42,-4679.99 20131.95,-4674.18 20147,-4670.83 20171.41,-4665.41 21025.88,-4674.21 21047,-4660.83 21068.94,-4646.93 21080.24,-4618.65 21085.85,-4597.39"/>
<polygon fill="red" stroke="red" points="21089.27,-4598.14 21088.18,-4587.6 21082.46,-4596.52 21089.27,-4598.14"/>
<text text-anchor="middle" x="21093.5" y="-4649.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu4 -->
<g id="node821" class="node">
<title>l3_attn_stage9_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="18294" cy="-4569.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18294" y="-4580.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="18294" y="-4565.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="18294" y="-4550.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu4&#45;&gt;l3_attn_stage9_gpu4 -->
<g id="edge1237" class="edge">
<title>l3_attn_stage8_gpu4&#45;&gt;l3_attn_stage9_gpu4</title>
<path fill="none" stroke="black" d="M18294,-4678.74C18294,-4660.02 18294,-4637.03 18294,-4617.05"/>
<polygon fill="black" stroke="black" points="18297.5,-4616.91 18294,-4606.91 18290.5,-4616.91 18297.5,-4616.91"/>
</g>
<!-- l3_attn_stage8_gpu4&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge2837" class="edge">
<title>l3_attn_stage8_gpu4&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18346.96,-4686.15C18360.88,-4679.86 18376.17,-4674.11 18391,-4670.83 18442.04,-4659.54 20223.66,-4678.11 20273,-4660.83 20283.15,-4657.28 20281.86,-4649.42 20292,-4645.83 20325.36,-4634.02 20894.34,-4644.99 20929,-4637.83 20972.86,-4628.77 21019.76,-4607.86 21051.75,-4591.7"/>
<polygon fill="red" stroke="red" points="21053.48,-4594.75 21060.77,-4587.07 21050.28,-4588.52 21053.48,-4594.75"/>
<text text-anchor="middle" x="20323.5" y="-4649.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu5 -->
<g id="node822" class="node">
<title>l3_attn_stage9_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="19074" cy="-4569.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19074" y="-4580.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="19074" y="-4565.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="19074" y="-4550.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu5&#45;&gt;l3_attn_stage9_gpu5 -->
<g id="edge1238" class="edge">
<title>l3_attn_stage8_gpu5&#45;&gt;l3_attn_stage9_gpu5</title>
<path fill="none" stroke="black" d="M19074,-4678.74C19074,-4660.02 19074,-4637.03 19074,-4617.05"/>
<polygon fill="black" stroke="black" points="19077.5,-4616.91 19074,-4606.91 19070.5,-4616.91 19077.5,-4616.91"/>
</g>
<!-- l3_attn_stage8_gpu5&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge2838" class="edge">
<title>l3_attn_stage8_gpu5&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19126.96,-4686.17C19140.89,-4679.88 19156.17,-4674.13 19171,-4670.83 19210.21,-4662.13 20579.1,-4674.14 20617,-4660.83 20627.15,-4657.27 20625.89,-4649.5 20636,-4645.83 20666.62,-4634.73 20897.15,-4644.65 20929,-4637.83 20972.66,-4628.48 21019.41,-4607.72 21051.42,-4591.67"/>
<polygon fill="red" stroke="red" points="21053.12,-4594.73 21060.45,-4587.07 21049.95,-4588.49 21053.12,-4594.73"/>
<text text-anchor="middle" x="20667.5" y="-4649.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu6 -->
<g id="node823" class="node">
<title>l3_attn_stage9_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19854" cy="-4569.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19854" y="-4580.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="19854" y="-4565.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19854" y="-4550.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu6&#45;&gt;l3_attn_stage9_gpu6 -->
<g id="edge1239" class="edge">
<title>l3_attn_stage8_gpu6&#45;&gt;l3_attn_stage9_gpu6</title>
<path fill="none" stroke="black" d="M19854,-4678.74C19854,-4660.02 19854,-4637.03 19854,-4617.05"/>
<polygon fill="black" stroke="black" points="19857.5,-4616.91 19854,-4606.91 19850.5,-4616.91 19857.5,-4616.91"/>
</g>
<!-- l3_attn_stage8_gpu6&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge2839" class="edge">
<title>l3_attn_stage8_gpu6&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19907.29,-4686.31C19921.42,-4679.97 19936.95,-4674.17 19952,-4670.83 20006.73,-4658.7 20908.13,-4679.48 20961,-4660.83 20971.15,-4657.25 20971.32,-4652.2 20980,-4645.83 21005.22,-4627.34 21034.5,-4607.49 21056.65,-4592.78"/>
<polygon fill="red" stroke="red" points="21058.66,-4595.65 21065.07,-4587.22 21054.8,-4589.81 21058.66,-4595.65"/>
<text text-anchor="middle" x="21011.5" y="-4649.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu7 -->
<g id="node824" class="node">
<title>l3_attn_stage9_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="18489" cy="-4569.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18489" y="-4580.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="18489" y="-4565.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="18489" y="-4550.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu7&#45;&gt;l3_attn_stage9_gpu7 -->
<g id="edge1240" class="edge">
<title>l3_attn_stage8_gpu7&#45;&gt;l3_attn_stage9_gpu7</title>
<path fill="none" stroke="black" d="M18489,-4678.74C18489,-4660.02 18489,-4637.03 18489,-4617.05"/>
<polygon fill="black" stroke="black" points="18492.5,-4616.91 18489,-4606.91 18485.5,-4616.91 18492.5,-4616.91"/>
</g>
<!-- l3_attn_stage8_gpu7&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge2840" class="edge">
<title>l3_attn_stage8_gpu7&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18541.96,-4686.16C18555.88,-4679.86 18571.17,-4674.12 18586,-4670.83 18634.09,-4660.19 20312.52,-4677.12 20359,-4660.83 20369.15,-4657.28 20367.86,-4649.43 20378,-4645.83 20406.85,-4635.58 20899.02,-4644.05 20929,-4637.83 20972.85,-4628.73 21019.75,-4607.83 21051.75,-4591.68"/>
<polygon fill="red" stroke="red" points="21053.47,-4594.73 21060.77,-4587.05 21050.27,-4588.5 21053.47,-4594.73"/>
<text text-anchor="middle" x="20409.5" y="-4649.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu8 -->
<g id="node825" class="node">
<title>l3_attn_stage9_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20244" cy="-4569.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20244" y="-4580.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="20244" y="-4565.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20244" y="-4550.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu8&#45;&gt;l3_attn_stage9_gpu8 -->
<g id="edge1241" class="edge">
<title>l3_attn_stage8_gpu8&#45;&gt;l3_attn_stage9_gpu8</title>
<path fill="none" stroke="black" d="M20188.85,-4686.87C20175.43,-4680.83 20160.93,-4675.03 20147,-4670.83 20133.22,-4666.68 20092.36,-4671.77 20083,-4660.83 20048.08,-4620.03 20088.79,-4660.15 20147,-4637.83 20164.78,-4631.02 20182.42,-4620.27 20197.68,-4609.34"/>
<polygon fill="black" stroke="black" points="20199.93,-4612.03 20205.9,-4603.27 20195.77,-4606.39 20199.93,-4612.03"/>
</g>
<!-- l3_attn_stage8_gpu8&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge2841" class="edge">
<title>l3_attn_stage8_gpu8&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20297.29,-4686.34C20311.43,-4680 20326.95,-4674.19 20342,-4670.83 20363.45,-4666.05 21117.56,-4676.47 21133,-4660.83 21151.16,-4642.44 21133.89,-4614.75 21116.31,-4594.84"/>
<polygon fill="red" stroke="red" points="21118.75,-4592.32 21109.38,-4587.37 21113.61,-4597.08 21118.75,-4592.32"/>
<text text-anchor="middle" x="21171.5" y="-4649.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu9 -->
<g id="node826" class="node">
<title>l3_attn_stage9_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="19659" cy="-4569.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19659" y="-4580.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="19659" y="-4565.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="19659" y="-4550.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu9&#45;&gt;l3_attn_stage9_gpu9 -->
<g id="edge1242" class="edge">
<title>l3_attn_stage8_gpu9&#45;&gt;l3_attn_stage9_gpu9</title>
<path fill="none" stroke="black" d="M19659,-4678.74C19659,-4660.02 19659,-4637.03 19659,-4617.05"/>
<polygon fill="black" stroke="black" points="19662.5,-4616.91 19659,-4606.91 19655.5,-4616.91 19662.5,-4616.91"/>
</g>
<!-- l3_attn_stage8_gpu9&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge2842" class="edge">
<title>l3_attn_stage8_gpu9&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19712.28,-4686.3C19726.42,-4679.97 19741.95,-4674.16 19757,-4670.83 19817.65,-4657.42 20816.41,-4681.47 20875,-4660.83 20885.15,-4657.26 20884.3,-4650.48 20894,-4645.83 20908.39,-4638.94 20913.8,-4642.7 20929,-4637.83 20969.94,-4624.73 21014.95,-4605.57 21047.12,-4591.01"/>
<polygon fill="red" stroke="red" points="21048.61,-4594.18 21056.25,-4586.84 21045.7,-4587.81 21048.61,-4594.18"/>
<text text-anchor="middle" x="20925.5" y="-4649.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu10 -->
<g id="node827" class="node">
<title>l3_attn_stage9_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="17904" cy="-4569.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="17904" y="-4580.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="17904" y="-4565.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17904" y="-4550.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu10&#45;&gt;l3_attn_stage9_gpu10 -->
<g id="edge1243" class="edge">
<title>l3_attn_stage8_gpu10&#45;&gt;l3_attn_stage9_gpu10</title>
<path fill="none" stroke="black" d="M17904,-4678.74C17904,-4660.02 17904,-4637.03 17904,-4617.05"/>
<polygon fill="black" stroke="black" points="17907.5,-4616.91 17904,-4606.91 17900.5,-4616.91 17907.5,-4616.91"/>
</g>
<!-- l3_attn_stage8_gpu10&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge2843" class="edge">
<title>l3_attn_stage8_gpu10&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17956.97,-4686.22C17970.9,-4679.92 17986.18,-4674.16 18001,-4670.83 18230.74,-4619.23 19884.55,-4648.39 20120,-4645.83 20164.94,-4645.35 20884.97,-4646.87 20929,-4637.83 20972.87,-4628.83 21019.77,-4607.91 21051.76,-4591.73"/>
<polygon fill="red" stroke="red" points="21053.49,-4594.78 21060.78,-4587.09 21050.28,-4588.55 21053.49,-4594.78"/>
<text text-anchor="middle" x="20151.5" y="-4649.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu11 -->
<g id="node828" class="node">
<title>l3_attn_stage9_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="18684" cy="-4569.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18684" y="-4580.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="18684" y="-4565.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18684" y="-4550.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu11&#45;&gt;l3_attn_stage9_gpu11 -->
<g id="edge1244" class="edge">
<title>l3_attn_stage8_gpu11&#45;&gt;l3_attn_stage9_gpu11</title>
<path fill="none" stroke="black" d="M18684,-4678.74C18684,-4660.02 18684,-4637.03 18684,-4617.05"/>
<polygon fill="black" stroke="black" points="18687.5,-4616.91 18684,-4606.91 18680.5,-4616.91 18687.5,-4616.91"/>
</g>
<!-- l3_attn_stage8_gpu11&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge2844" class="edge">
<title>l3_attn_stage8_gpu11&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18736.96,-4686.16C18750.88,-4679.87 18766.17,-4674.12 18781,-4670.83 18826.13,-4660.83 20401.38,-4676.12 20445,-4660.83 20455.15,-4657.27 20453.87,-4649.45 20464,-4645.83 20512.67,-4628.47 20878.42,-4648.4 20929,-4637.83 20972.84,-4628.67 21019.74,-4607.78 21051.74,-4591.64"/>
<polygon fill="red" stroke="red" points="21053.46,-4594.7 21060.76,-4587.02 21050.27,-4588.47 21053.46,-4594.7"/>
<text text-anchor="middle" x="20495.5" y="-4649.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu12 -->
<g id="node829" class="node">
<title>l3_attn_stage9_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="18099" cy="-4569.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18099" y="-4580.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="18099" y="-4565.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="18099" y="-4550.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu12&#45;&gt;l3_attn_stage9_gpu12 -->
<g id="edge1245" class="edge">
<title>l3_attn_stage8_gpu12&#45;&gt;l3_attn_stage9_gpu12</title>
<path fill="none" stroke="black" d="M18099,-4678.74C18099,-4660.02 18099,-4637.03 18099,-4617.05"/>
<polygon fill="black" stroke="black" points="18102.5,-4616.91 18099,-4606.91 18095.5,-4616.91 18102.5,-4616.91"/>
</g>
<!-- l3_attn_stage8_gpu12&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge2845" class="edge">
<title>l3_attn_stage8_gpu12&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18151.96,-4686.15C18165.88,-4679.86 18181.17,-4674.11 18196,-4670.83 18250,-4658.89 20134.8,-4679.1 20187,-4660.83 20197.15,-4657.28 20195.86,-4649.42 20206,-4645.83 20243.87,-4632.45 20889.66,-4645.93 20929,-4637.83 20972.87,-4628.81 21019.77,-4607.89 21051.76,-4591.72"/>
<polygon fill="red" stroke="red" points="21053.48,-4594.77 21060.78,-4587.08 21050.28,-4588.54 21053.48,-4594.77"/>
<text text-anchor="middle" x="20237.5" y="-4649.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu13 -->
<g id="node830" class="node">
<title>l3_attn_stage9_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="18879" cy="-4569.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="18879" y="-4580.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="18879" y="-4565.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18879" y="-4550.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu13&#45;&gt;l3_attn_stage9_gpu13 -->
<g id="edge1246" class="edge">
<title>l3_attn_stage8_gpu13&#45;&gt;l3_attn_stage9_gpu13</title>
<path fill="none" stroke="black" d="M18879,-4678.74C18879,-4660.02 18879,-4637.03 18879,-4617.05"/>
<polygon fill="black" stroke="black" points="18882.5,-4616.91 18879,-4606.91 18875.5,-4616.91 18882.5,-4616.91"/>
</g>
<!-- l3_attn_stage8_gpu13&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge2846" class="edge">
<title>l3_attn_stage8_gpu13&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18931.96,-4686.16C18945.89,-4679.87 18961.17,-4674.12 18976,-4670.83 19018.17,-4661.48 20490.24,-4675.13 20531,-4660.83 20541.15,-4657.27 20539.87,-4649.47 20550,-4645.83 20589.64,-4631.6 20887.79,-4646.53 20929,-4637.83 20972.82,-4628.59 21019.73,-4607.7 21051.73,-4591.6"/>
<polygon fill="red" stroke="red" points="21053.45,-4594.65 21060.75,-4586.98 21050.26,-4588.42 21053.45,-4594.65"/>
<text text-anchor="middle" x="20581.5" y="-4649.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu14 -->
<g id="node831" class="node">
<title>l3_attn_stage9_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19269" cy="-4569.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="19269" y="-4580.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="19269" y="-4565.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19269" y="-4550.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu14&#45;&gt;l3_attn_stage9_gpu14 -->
<g id="edge1247" class="edge">
<title>l3_attn_stage8_gpu14&#45;&gt;l3_attn_stage9_gpu14</title>
<path fill="none" stroke="black" d="M19269,-4678.74C19269,-4660.02 19269,-4637.03 19269,-4617.05"/>
<polygon fill="black" stroke="black" points="19272.5,-4616.91 19269,-4606.91 19265.5,-4616.91 19272.5,-4616.91"/>
</g>
<!-- l3_attn_stage8_gpu14&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge2847" class="edge">
<title>l3_attn_stage8_gpu14&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19322.28,-4686.29C19336.42,-4679.95 19351.95,-4674.15 19367,-4670.83 19403.24,-4662.85 20667.99,-4673.14 20703,-4660.83 20713.15,-4657.27 20711.91,-4649.56 20722,-4645.83 20765.19,-4629.9 20884.04,-4647.73 20929,-4637.83 20972.6,-4628.23 21019.37,-4607.51 21051.39,-4591.54"/>
<polygon fill="red" stroke="red" points="21053.08,-4594.6 21060.42,-4586.96 21049.92,-4588.36 21053.08,-4594.6"/>
<text text-anchor="middle" x="20753.5" y="-4649.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu15 -->
<g id="node832" class="node">
<title>l3_attn_stage9_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20439" cy="-4569.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="20439" y="-4580.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="20439" y="-4565.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20439" y="-4550.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu15&#45;&gt;l3_attn_stage9_gpu15 -->
<g id="edge1248" class="edge">
<title>l3_attn_stage8_gpu15&#45;&gt;l3_attn_stage9_gpu15</title>
<path fill="none" stroke="black" d="M20385.7,-4686.39C20371.85,-4680.13 20356.69,-4674.35 20342,-4670.83 20328.37,-4667.57 20099.71,-4670.93 20090,-4660.83 20085.38,-4656.03 20085.36,-4650.62 20090,-4645.83 20099.75,-4635.77 20328.7,-4642.24 20342,-4637.83 20360.4,-4631.74 20378.44,-4620.94 20393.87,-4609.75"/>
<polygon fill="black" stroke="black" points="20396.27,-4612.33 20402.16,-4603.52 20392.06,-4606.73 20396.27,-4612.33"/>
</g>
<!-- l3_attn_stage8_gpu15&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge2848" class="edge">
<title>l3_attn_stage8_gpu15&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20492.3,-4686.36C20506.43,-4680.02 20521.96,-4674.2 20537,-4670.83 20555.49,-4666.69 21205.7,-4674.33 21219,-4660.83 21247.36,-4632.06 21199.79,-4606.22 21154.82,-4589.6"/>
<polygon fill="red" stroke="red" points="21155.88,-4586.26 21145.29,-4586.19 21153.53,-4592.85 21155.88,-4586.26"/>
<text text-anchor="middle" x="21258.5" y="-4649.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu0 -->
<g id="node833" class="node">
<title>l3_attn_stage10_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20822" cy="-4422.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20822" y="-4433.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="20822" y="-4418.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20822" y="-4403.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu0&#45;&gt;l3_attn_stage10_gpu0 -->
<g id="edge1249" class="edge">
<title>l3_attn_stage9_gpu0&#45;&gt;l3_attn_stage10_gpu0</title>
<path fill="none" stroke="black" d="M20776.02,-4539.26C20762.09,-4532.96 20746.82,-4527.19 20732,-4523.83 20714.58,-4519.88 20101.53,-4526.56 20089,-4513.83 20084.32,-4509.08 20084.32,-4503.58 20089,-4498.83 20101.28,-4486.4 20701.28,-4495.9 20718,-4490.83 20737.65,-4484.88 20757.09,-4473.99 20773.75,-4462.68"/>
<polygon fill="black" stroke="black" points="20776.03,-4465.35 20782.2,-4456.74 20772.01,-4459.63 20776.03,-4465.35"/>
</g>
<!-- l3_attn_stage10_gpu[next_gpu] -->
<g id="node1384" class="node">
<title>l3_attn_stage10_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="21097" cy="-4422.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="21097" y="-4418.63" font-family="Times,serif" font-size="14.00">l3_attn_stage10_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage9_gpu0&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge2849" class="edge">
<title>l3_attn_stage9_gpu0&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20884.38,-4540.03C20899.74,-4533.46 20916.69,-4527.37 20933,-4523.83 20957.06,-4518.62 21358.79,-4531.44 21376,-4513.83 21425.67,-4463.03 21338.33,-4440.72 21248.57,-4430.94"/>
<polygon fill="red" stroke="red" points="21248.78,-4427.44 21238.47,-4429.89 21248.05,-4434.4 21248.78,-4427.44"/>
<text text-anchor="middle" x="21415.5" y="-4502.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu1 -->
<g id="node834" class="node">
<title>l3_attn_stage10_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19366" cy="-4422.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19366" y="-4433.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="19366" y="-4418.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19366" y="-4403.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu1&#45;&gt;l3_attn_stage10_gpu1 -->
<g id="edge1250" class="edge">
<title>l3_attn_stage9_gpu1&#45;&gt;l3_attn_stage10_gpu1</title>
<path fill="none" stroke="black" d="M19440.03,-4532.86C19426.63,-4513.04 19409.82,-4488.17 19395.61,-4467.14"/>
<polygon fill="black" stroke="black" points="19398.4,-4465.01 19389.9,-4458.69 19392.6,-4468.93 19398.4,-4465.01"/>
</g>
<!-- l3_attn_stage9_gpu1&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge2850" class="edge">
<title>l3_attn_stage9_gpu1&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19517.28,-4539.3C19531.42,-4532.96 19546.95,-4527.16 19562,-4523.83 19627.75,-4509.32 20710.48,-4536.18 20774,-4513.83 20784.15,-4510.26 20782.94,-4502.66 20793,-4498.83 20821.3,-4488.07 20899.46,-4497.45 20929,-4490.83 20973.67,-4480.83 21021.88,-4460.36 21055.15,-4444.58"/>
<polygon fill="red" stroke="red" points="21057.06,-4447.54 21064.55,-4440.05 21054.02,-4441.23 21057.06,-4447.54"/>
<text text-anchor="middle" x="20824.5" y="-4502.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu2 -->
<g id="node835" class="node">
<title>l3_attn_stage10_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20614" cy="-4422.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20614" y="-4433.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="20614" y="-4418.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20614" y="-4403.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu2&#45;&gt;l3_attn_stage10_gpu2 -->
<g id="edge1251" class="edge">
<title>l3_attn_stage9_gpu2&#45;&gt;l3_attn_stage10_gpu2</title>
<path fill="none" stroke="black" d="M20580.75,-4539.21C20566.89,-4532.96 20551.72,-4527.22 20537,-4523.83 20512.36,-4518.17 20099.68,-4531.91 20082,-4513.83 20077.34,-4509.07 20077.33,-4503.59 20082,-4498.83 20090.33,-4490.35 20498.63,-4494.31 20510,-4490.83 20529.63,-4484.82 20549.07,-4473.92 20565.73,-4462.61"/>
<polygon fill="black" stroke="black" points="20568.01,-4465.29 20574.18,-4456.68 20563.99,-4459.56 20568.01,-4465.29"/>
</g>
<!-- l3_attn_stage9_gpu2&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge2851" class="edge">
<title>l3_attn_stage9_gpu2&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20687.31,-4539.4C20701.44,-4533.06 20716.96,-4527.23 20732,-4523.83 20747.12,-4520.42 21279.14,-4524.89 21290,-4513.83 21326.82,-4476.35 21263.45,-4452.61 21199.69,-4438.9"/>
<polygon fill="red" stroke="red" points="21200.38,-4435.47 21189.88,-4436.86 21198.96,-4442.32 21200.38,-4435.47"/>
<text text-anchor="middle" x="21329.5" y="-4502.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu3 -->
<g id="node836" class="node">
<title>l3_attn_stage10_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="19990" cy="-4422.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19990" y="-4433.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="19990" y="-4418.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="19990" y="-4403.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu3&#45;&gt;l3_attn_stage10_gpu3 -->
<g id="edge1252" class="edge">
<title>l3_attn_stage9_gpu3&#45;&gt;l3_attn_stage10_gpu3</title>
<path fill="none" stroke="black" d="M20034.26,-4532.12C20026.49,-4513 20016.86,-4489.35 20008.58,-4468.98"/>
<polygon fill="black" stroke="black" points="20011.76,-4467.53 20004.75,-4459.59 20005.28,-4470.17 20011.76,-4467.53"/>
</g>
<!-- l3_attn_stage9_gpu3&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge2852" class="edge">
<title>l3_attn_stage9_gpu3&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20102.29,-4539.33C20116.42,-4532.99 20131.95,-4527.18 20147,-4523.83 20171,-4518.5 21010.19,-4525.18 21032,-4513.83 21045.7,-4506.71 21067.58,-4473.29 21082.12,-4449.13"/>
<polygon fill="red" stroke="red" points="21085.21,-4450.79 21087.3,-4440.4 21079.19,-4447.22 21085.21,-4450.79"/>
<text text-anchor="middle" x="21078.5" y="-4502.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu4 -->
<g id="node837" class="node">
<title>l3_attn_stage10_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="18118" cy="-4422.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18118" y="-4433.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="18118" y="-4418.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="18118" y="-4403.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu4&#45;&gt;l3_attn_stage10_gpu4 -->
<g id="edge1253" class="edge">
<title>l3_attn_stage9_gpu4&#45;&gt;l3_attn_stage10_gpu4</title>
<path fill="none" stroke="black" d="M18254.06,-4535.43C18227.94,-4513.91 18193.66,-4485.67 18166.05,-4462.92"/>
<polygon fill="black" stroke="black" points="18168.03,-4460.01 18158.08,-4456.36 18163.58,-4465.42 18168.03,-4460.01"/>
</g>
<!-- l3_attn_stage9_gpu4&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge2853" class="edge">
<title>l3_attn_stage9_gpu4&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18346.96,-4539.15C18360.88,-4532.86 18376.17,-4527.11 18391,-4523.83 18441.64,-4512.63 20209.05,-4530.97 20258,-4513.83 20268.15,-4510.28 20266.86,-4502.42 20277,-4498.83 20311.15,-4486.74 20893.48,-4497.93 20929,-4490.83 20974.31,-4481.78 21022.97,-4460.87 21056.2,-4444.7"/>
<polygon fill="red" stroke="red" points="21058.16,-4447.64 21065.57,-4440.07 21055.06,-4441.37 21058.16,-4447.64"/>
<text text-anchor="middle" x="20308.5" y="-4502.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu5 -->
<g id="node838" class="node">
<title>l3_attn_stage10_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="18950" cy="-4422.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18950" y="-4433.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="18950" y="-4418.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="18950" y="-4403.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu5&#45;&gt;l3_attn_stage10_gpu5 -->
<g id="edge1254" class="edge">
<title>l3_attn_stage9_gpu5&#45;&gt;l3_attn_stage10_gpu5</title>
<path fill="none" stroke="black" d="M19044.3,-4533.6C19026.88,-4513.23 19004.74,-4487.34 18986.29,-4465.77"/>
<polygon fill="black" stroke="black" points="18988.83,-4463.36 18979.67,-4458.03 18983.51,-4467.91 18988.83,-4463.36"/>
</g>
<!-- l3_attn_stage9_gpu5&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge2854" class="edge">
<title>l3_attn_stage9_gpu5&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19126.96,-4539.17C19140.89,-4532.88 19156.17,-4527.13 19171,-4523.83 19209.81,-4515.21 20564.49,-4527 20602,-4513.83 20612.15,-4510.27 20610.88,-4502.49 20621,-4498.83 20653.19,-4487.19 20895.48,-4497.77 20929,-4490.83 20974.11,-4481.5 21022.62,-4460.74 21055.86,-4444.68"/>
<polygon fill="red" stroke="red" points="21057.8,-4447.63 21065.24,-4440.08 21054.72,-4441.35 21057.8,-4447.63"/>
<text text-anchor="middle" x="20652.5" y="-4502.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu6 -->
<g id="node839" class="node">
<title>l3_attn_stage10_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19782" cy="-4422.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19782" y="-4433.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="19782" y="-4418.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19782" y="-4403.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu6&#45;&gt;l3_attn_stage10_gpu6 -->
<g id="edge1255" class="edge">
<title>l3_attn_stage9_gpu6&#45;&gt;l3_attn_stage10_gpu6</title>
<path fill="none" stroke="black" d="M19836.2,-4532.49C19826.6,-4513.14 19814.64,-4489.07 19804.41,-4468.46"/>
<polygon fill="black" stroke="black" points="19807.42,-4466.67 19799.84,-4459.27 19801.16,-4469.78 19807.42,-4466.67"/>
</g>
<!-- l3_attn_stage9_gpu6&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge2855" class="edge">
<title>l3_attn_stage9_gpu6&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19907.29,-4539.32C19921.42,-4532.98 19936.95,-4527.17 19952,-4523.83 20005.92,-4511.88 20893.92,-4532.21 20946,-4513.83 20956.15,-4510.25 20956.08,-4504.85 20965,-4498.83 20994.36,-4479.01 21029.2,-4459.22 21055.72,-4444.88"/>
<polygon fill="red" stroke="red" points="21057.57,-4447.86 21064.73,-4440.05 21054.26,-4441.69 21057.57,-4447.86"/>
<text text-anchor="middle" x="20996.5" y="-4502.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu7 -->
<g id="node840" class="node">
<title>l3_attn_stage10_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="18326" cy="-4422.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18326" y="-4433.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="18326" y="-4418.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="18326" y="-4403.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu7&#45;&gt;l3_attn_stage10_gpu7 -->
<g id="edge1256" class="edge">
<title>l3_attn_stage9_gpu7&#45;&gt;l3_attn_stage10_gpu7</title>
<path fill="none" stroke="black" d="M18451.6,-4535.07C18427.75,-4513.85 18396.69,-4486.22 18371.43,-4463.74"/>
<polygon fill="black" stroke="black" points="18373.58,-4460.98 18363.79,-4456.95 18368.93,-4466.21 18373.58,-4460.98"/>
</g>
<!-- l3_attn_stage9_gpu7&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge2856" class="edge">
<title>l3_attn_stage9_gpu7&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18541.96,-4539.16C18555.88,-4532.86 18571.17,-4527.12 18586,-4523.83 18633.68,-4513.28 20297.91,-4529.98 20344,-4513.83 20354.15,-4510.28 20352.86,-4502.43 20363,-4498.83 20392.63,-4488.31 20898.17,-4497.02 20929,-4490.83 20974.3,-4481.74 21022.97,-4460.84 21056.2,-4444.68"/>
<polygon fill="red" stroke="red" points="21058.15,-4447.62 21065.57,-4440.05 21055.05,-4441.34 21058.15,-4447.62"/>
<text text-anchor="middle" x="20394.5" y="-4502.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu8 -->
<g id="node841" class="node">
<title>l3_attn_stage10_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20198" cy="-4422.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20198" y="-4433.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="20198" y="-4418.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20198" y="-4403.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu8&#45;&gt;l3_attn_stage10_gpu8 -->
<g id="edge1257" class="edge">
<title>l3_attn_stage9_gpu8&#45;&gt;l3_attn_stage10_gpu8</title>
<path fill="none" stroke="black" d="M20189.2,-4539.69C20175.7,-4533.63 20161.07,-4527.85 20147,-4523.83 20129.98,-4518.98 20079.7,-4527.11 20068,-4513.83 20063.59,-4508.83 20064.04,-4504.2 20068,-4498.83 20075.18,-4489.11 20083.05,-4495.95 20094,-4490.83 20111.44,-4482.68 20129.39,-4471.99 20145.36,-4461.52"/>
<polygon fill="black" stroke="black" points="20147.64,-4464.21 20154.02,-4455.75 20143.76,-4458.39 20147.64,-4464.21"/>
</g>
<!-- l3_attn_stage9_gpu8&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge2857" class="edge">
<title>l3_attn_stage9_gpu8&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20297.29,-4539.35C20311.43,-4533.01 20326.95,-4527.19 20342,-4523.83 20363.04,-4519.14 21102.86,-4529.17 21118,-4513.83 21134.7,-4496.91 21125.21,-4469.47 21114.14,-4449.23"/>
<polygon fill="red" stroke="red" points="21117.11,-4447.37 21109.04,-4440.5 21111.07,-4450.9 21117.11,-4447.37"/>
<text text-anchor="middle" x="21156.5" y="-4502.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu9 -->
<g id="node842" class="node">
<title>l3_attn_stage10_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="19574" cy="-4422.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19574" y="-4433.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="19574" y="-4418.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="19574" y="-4403.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu9&#45;&gt;l3_attn_stage10_gpu9 -->
<g id="edge1258" class="edge">
<title>l3_attn_stage9_gpu9&#45;&gt;l3_attn_stage10_gpu9</title>
<path fill="none" stroke="black" d="M19638.21,-4532.86C19626.68,-4513.2 19612.24,-4488.57 19599.98,-4467.65"/>
<polygon fill="black" stroke="black" points="19602.95,-4465.8 19594.87,-4458.94 19596.91,-4469.34 19602.95,-4465.8"/>
</g>
<!-- l3_attn_stage9_gpu9&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge2858" class="edge">
<title>l3_attn_stage9_gpu9&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19712.29,-4539.31C19726.42,-4532.97 19741.95,-4527.16 19757,-4523.83 19816.83,-4510.6 20802.2,-4534.19 20860,-4513.83 20870.15,-4510.26 20869.15,-4503.16 20879,-4498.83 20899.61,-4489.79 20907.31,-4496.84 20929,-4490.83 20972.28,-4478.84 21019.59,-4459.2 21052.94,-4444.19"/>
<polygon fill="red" stroke="red" points="21054.74,-4447.22 21062.4,-4439.9 21051.84,-4440.85 21054.74,-4447.22"/>
<text text-anchor="middle" x="20910.5" y="-4502.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu10 -->
<g id="node843" class="node">
<title>l3_attn_stage10_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="17702" cy="-4422.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="17702" y="-4433.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="17702" y="-4418.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17702" y="-4403.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu10&#45;&gt;l3_attn_stage10_gpu10 -->
<g id="edge1259" class="edge">
<title>l3_attn_stage9_gpu10&#45;&gt;l3_attn_stage10_gpu10</title>
<path fill="none" stroke="black" d="M17859.67,-4536.51C17828.97,-4514.47 17787.93,-4485.02 17755.42,-4461.68"/>
<polygon fill="black" stroke="black" points="17757.09,-4458.57 17746.92,-4455.58 17753.01,-4464.26 17757.09,-4458.57"/>
</g>
<!-- l3_attn_stage9_gpu10&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge2859" class="edge">
<title>l3_attn_stage9_gpu10&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17956.97,-4539.22C17970.9,-4532.93 17986.18,-4527.16 18001,-4523.83 18229.11,-4472.58 19871.22,-4501.36 20105,-4498.83 20150.78,-4498.34 20884.1,-4499.74 20929,-4490.83 20974.32,-4481.84 21022.98,-4460.92 21056.21,-4444.74"/>
<polygon fill="red" stroke="red" points="21058.17,-4447.67 21065.58,-4440.1 21055.06,-4441.4 21058.17,-4447.67"/>
<text text-anchor="middle" x="20136.5" y="-4502.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu11 -->
<g id="node844" class="node">
<title>l3_attn_stage10_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="18534" cy="-4422.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18534" y="-4433.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="18534" y="-4418.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18534" y="-4403.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu11&#45;&gt;l3_attn_stage10_gpu11 -->
<g id="edge1260" class="edge">
<title>l3_attn_stage9_gpu11&#45;&gt;l3_attn_stage10_gpu11</title>
<path fill="none" stroke="black" d="M18649.21,-4534.7C18627.5,-4513.72 18599.41,-4486.56 18576.4,-4464.32"/>
<polygon fill="black" stroke="black" points="18578.74,-4461.72 18569.12,-4457.28 18573.88,-4466.75 18578.74,-4461.72"/>
</g>
<!-- l3_attn_stage9_gpu11&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge2860" class="edge">
<title>l3_attn_stage9_gpu11&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18736.96,-4539.16C18750.88,-4532.87 18766.17,-4527.12 18781,-4523.83 18825.72,-4513.92 20386.77,-4528.99 20430,-4513.83 20440.15,-4510.27 20438.87,-4502.45 20449,-4498.83 20499.24,-4480.92 20876.72,-4501.4 20929,-4490.83 20974.29,-4481.68 21022.96,-4460.79 21056.19,-4444.65"/>
<polygon fill="red" stroke="red" points="21058.14,-4447.59 21065.56,-4440.03 21055.05,-4441.31 21058.14,-4447.59"/>
<text text-anchor="middle" x="20480.5" y="-4502.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu12 -->
<g id="node845" class="node">
<title>l3_attn_stage10_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="17910" cy="-4422.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="17910" y="-4433.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="17910" y="-4418.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17910" y="-4403.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu12&#45;&gt;l3_attn_stage10_gpu12 -->
<g id="edge1261" class="edge">
<title>l3_attn_stage9_gpu12&#45;&gt;l3_attn_stage10_gpu12</title>
<path fill="none" stroke="black" d="M18057.05,-4536.15C18028.62,-4514.34 17990.89,-4485.39 17960.76,-4462.28"/>
<polygon fill="black" stroke="black" points="17962.55,-4459.23 17952.48,-4455.92 17958.29,-4464.79 17962.55,-4459.23"/>
</g>
<!-- l3_attn_stage9_gpu12&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge2861" class="edge">
<title>l3_attn_stage9_gpu12&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18151.96,-4539.15C18165.88,-4532.86 18181.17,-4527.11 18196,-4523.83 18249.6,-4511.98 20120.19,-4531.97 20172,-4513.83 20182.15,-4510.28 20180.86,-4502.42 20191,-4498.83 20229.66,-4485.18 20888.79,-4498.84 20929,-4490.83 20974.31,-4481.81 21022.98,-4460.9 21056.21,-4444.72"/>
<polygon fill="red" stroke="red" points="21058.17,-4447.66 21065.58,-4440.09 21055.06,-4441.38 21058.17,-4447.66"/>
<text text-anchor="middle" x="20222.5" y="-4502.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu13 -->
<g id="node846" class="node">
<title>l3_attn_stage10_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="18742" cy="-4422.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18742" y="-4433.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="18742" y="-4418.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18742" y="-4403.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu13&#45;&gt;l3_attn_stage10_gpu13 -->
<g id="edge1262" class="edge">
<title>l3_attn_stage9_gpu13&#45;&gt;l3_attn_stage10_gpu13</title>
<path fill="none" stroke="black" d="M18846.88,-4534.34C18827.35,-4513.67 18802.27,-4487.12 18781.53,-4465.17"/>
<polygon fill="black" stroke="black" points="18783.81,-4462.48 18774.39,-4457.62 18778.72,-4467.29 18783.81,-4462.48"/>
</g>
<!-- l3_attn_stage9_gpu13&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge2862" class="edge">
<title>l3_attn_stage9_gpu13&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18931.96,-4539.17C18945.89,-4532.87 18961.17,-4527.12 18976,-4523.83 19017.76,-4514.57 20475.63,-4527.99 20516,-4513.83 20526.15,-4510.27 20524.87,-4502.46 20535,-4498.83 20576.22,-4484.05 20886.1,-4499.58 20929,-4490.83 20974.27,-4481.6 21022.94,-4460.72 21056.18,-4444.6"/>
<polygon fill="red" stroke="red" points="21058.13,-4447.55 21065.56,-4439.99 21055.04,-4441.27 21058.13,-4447.55"/>
<text text-anchor="middle" x="20566.5" y="-4502.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu14 -->
<g id="node847" class="node">
<title>l3_attn_stage10_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19158" cy="-4422.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19158" y="-4433.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="19158" y="-4418.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19158" y="-4403.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu14&#45;&gt;l3_attn_stage10_gpu14 -->
<g id="edge1263" class="edge">
<title>l3_attn_stage9_gpu14&#45;&gt;l3_attn_stage10_gpu14</title>
<path fill="none" stroke="black" d="M19242.13,-4533.23C19226.71,-4513.09 19207.23,-4487.65 19190.9,-4466.32"/>
<polygon fill="black" stroke="black" points="19193.67,-4464.17 19184.81,-4458.36 19188.11,-4468.43 19193.67,-4464.17"/>
</g>
<!-- l3_attn_stage9_gpu14&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge2863" class="edge">
<title>l3_attn_stage9_gpu14&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19322.28,-4539.29C19336.42,-4532.95 19351.95,-4527.15 19367,-4523.83 19438.67,-4508.04 20618.76,-4538.16 20688,-4513.83 20698.15,-4510.27 20696.9,-4502.54 20707,-4498.83 20753.34,-4481.81 20880.71,-4501.08 20929,-4490.83 20974.06,-4481.27 21022.58,-4460.54 21055.83,-4444.56"/>
<polygon fill="red" stroke="red" points="21057.76,-4447.51 21065.22,-4439.98 21054.69,-4441.22 21057.76,-4447.51"/>
<text text-anchor="middle" x="20738.5" y="-4502.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu15 -->
<g id="node848" class="node">
<title>l3_attn_stage10_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20406" cy="-4422.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20406" y="-4433.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="20406" y="-4418.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20406" y="-4403.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu15&#45;&gt;l3_attn_stage10_gpu15 -->
<g id="edge1264" class="edge">
<title>l3_attn_stage9_gpu15&#45;&gt;l3_attn_stage10_gpu15</title>
<path fill="none" stroke="black" d="M20385.71,-4539.37C20371.86,-4533.11 20356.69,-4527.33 20342,-4523.83 20327.56,-4520.39 20085.3,-4524.52 20075,-4513.83 20070.38,-4509.03 20070.37,-4503.63 20075,-4498.83 20083.76,-4489.75 20289.97,-4494.63 20302,-4490.83 20321.58,-4484.66 20341,-4473.72 20357.67,-4462.41"/>
<polygon fill="black" stroke="black" points="20359.94,-4465.1 20366.13,-4456.5 20355.93,-4459.37 20359.94,-4465.1"/>
</g>
<!-- l3_attn_stage9_gpu15&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge2864" class="edge">
<title>l3_attn_stage9_gpu15&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20492.3,-4539.37C20506.43,-4533.03 20521.96,-4527.21 20537,-4523.83 20555.08,-4519.78 21191,-4527.03 21204,-4513.83 21229.61,-4487.84 21188.49,-4461.24 21150.03,-4443.67"/>
<polygon fill="red" stroke="red" points="21151.43,-4440.46 21140.87,-4439.62 21148.61,-4446.86 21151.43,-4440.46"/>
<text text-anchor="middle" x="21242.5" y="-4502.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu0 -->
<g id="node849" class="node">
<title>l3_attn_stage11_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20822" cy="-4275.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20822" y="-4286.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="20822" y="-4271.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20822" y="-4256.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu0&#45;&gt;l3_attn_stage11_gpu0 -->
<g id="edge1265" class="edge">
<title>l3_attn_stage10_gpu0&#45;&gt;l3_attn_stage11_gpu0</title>
<path fill="none" stroke="black" d="M20765,-4392.26C20750.08,-4385.96 20733.75,-4380.19 20718,-4376.83 20700.91,-4373.19 20101.26,-4379.29 20089,-4366.83 20084.32,-4362.08 20084.32,-4356.58 20089,-4351.83 20101.28,-4339.4 20701.28,-4348.9 20718,-4343.83 20737.65,-4337.88 20757.09,-4326.99 20773.75,-4315.68"/>
<polygon fill="black" stroke="black" points="20776.03,-4318.35 20782.2,-4309.74 20772.01,-4312.63 20776.03,-4318.35"/>
</g>
<!-- l3_attn_stage11_gpu[next_gpu] -->
<g id="node1385" class="node">
<title>l3_attn_stage11_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="21097" cy="-4275.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="21097" y="-4271.63" font-family="Times,serif" font-size="14.00">l3_attn_stage11_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage10_gpu0&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge2865" class="edge">
<title>l3_attn_stage10_gpu0&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20881.56,-4392.91C20897.88,-4386.4 20915.81,-4380.35 20933,-4376.83 20957.12,-4371.9 21358.79,-4384.44 21376,-4366.83 21425.67,-4316.03 21338.33,-4293.72 21248.57,-4283.94"/>
<polygon fill="red" stroke="red" points="21248.78,-4280.44 21238.47,-4282.89 21248.05,-4287.4 21248.78,-4280.44"/>
<text text-anchor="middle" x="21415.5" y="-4355.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu1 -->
<g id="node850" class="node">
<title>l3_attn_stage11_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19366" cy="-4275.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19366" y="-4286.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="19366" y="-4271.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19366" y="-4256.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu1&#45;&gt;l3_attn_stage11_gpu1 -->
<g id="edge1266" class="edge">
<title>l3_attn_stage10_gpu1&#45;&gt;l3_attn_stage11_gpu1</title>
<path fill="none" stroke="black" d="M19366,-4384.74C19366,-4366.02 19366,-4343.03 19366,-4323.05"/>
<polygon fill="black" stroke="black" points="19369.5,-4322.91 19366,-4312.91 19362.5,-4322.91 19369.5,-4322.91"/>
</g>
<!-- l3_attn_stage10_gpu1&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge2866" class="edge">
<title>l3_attn_stage10_gpu1&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19422.98,-4392.17C19437.9,-4385.88 19454.24,-4380.13 19470,-4376.83 19540.91,-4362.01 20705.65,-4390.85 20774,-4366.83 20784.15,-4363.27 20782.94,-4355.66 20793,-4351.83 20821.3,-4341.07 20899.46,-4350.45 20929,-4343.83 20973.67,-4333.83 21021.88,-4313.36 21055.15,-4297.58"/>
<polygon fill="red" stroke="red" points="21057.06,-4300.54 21064.55,-4293.05 21054.02,-4294.23 21057.06,-4300.54"/>
<text text-anchor="middle" x="20824.5" y="-4355.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu2 -->
<g id="node851" class="node">
<title>l3_attn_stage11_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20614" cy="-4275.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20614" y="-4286.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="20614" y="-4271.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20614" y="-4256.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu2&#45;&gt;l3_attn_stage11_gpu2 -->
<g id="edge1267" class="edge">
<title>l3_attn_stage10_gpu2&#45;&gt;l3_attn_stage11_gpu2</title>
<path fill="none" stroke="black" d="M20556.71,-4392.23C20541.86,-4385.97 20525.64,-4380.23 20510,-4376.83 20486.76,-4371.79 20098.62,-4383.85 20082,-4366.83 20077.34,-4362.06 20077.33,-4356.59 20082,-4351.83 20090.33,-4343.35 20498.63,-4347.31 20510,-4343.83 20529.63,-4337.82 20549.07,-4326.92 20565.73,-4315.61"/>
<polygon fill="black" stroke="black" points="20568.01,-4318.29 20574.18,-4309.68 20563.99,-4312.56 20568.01,-4318.29"/>
</g>
<!-- l3_attn_stage10_gpu2&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge2867" class="edge">
<title>l3_attn_stage10_gpu2&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20671,-4392.28C20685.92,-4385.98 20702.25,-4380.2 20718,-4376.83 20733.54,-4373.51 21278.86,-4378.17 21290,-4366.83 21326.88,-4329.3 21263.24,-4305.54 21199.37,-4291.83"/>
<polygon fill="red" stroke="red" points="21200.05,-4288.4 21189.55,-4289.8 21198.63,-4295.25 21200.05,-4288.4"/>
<text text-anchor="middle" x="21329.5" y="-4355.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu3 -->
<g id="node852" class="node">
<title>l3_attn_stage11_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="19990" cy="-4275.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19990" y="-4286.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="19990" y="-4271.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="19990" y="-4256.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu3&#45;&gt;l3_attn_stage11_gpu3 -->
<g id="edge1268" class="edge">
<title>l3_attn_stage10_gpu3&#45;&gt;l3_attn_stage11_gpu3</title>
<path fill="none" stroke="black" d="M19990,-4384.74C19990,-4366.02 19990,-4343.03 19990,-4323.05"/>
<polygon fill="black" stroke="black" points="19993.5,-4322.91 19990,-4312.91 19986.5,-4322.91 19993.5,-4322.91"/>
</g>
<!-- l3_attn_stage10_gpu3&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge2868" class="edge">
<title>l3_attn_stage10_gpu3&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20046.98,-4392.2C20061.91,-4385.91 20078.24,-4380.15 20094,-4376.83 20119.5,-4371.46 21008.88,-4378.85 21032,-4366.83 21045.7,-4359.71 21067.58,-4326.29 21082.12,-4302.13"/>
<polygon fill="red" stroke="red" points="21085.21,-4303.79 21087.3,-4293.4 21079.19,-4300.22 21085.21,-4303.79"/>
<text text-anchor="middle" x="21078.5" y="-4355.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu4 -->
<g id="node853" class="node">
<title>l3_attn_stage11_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="18118" cy="-4275.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18118" y="-4286.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="18118" y="-4271.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="18118" y="-4256.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu4&#45;&gt;l3_attn_stage11_gpu4 -->
<g id="edge1269" class="edge">
<title>l3_attn_stage10_gpu4&#45;&gt;l3_attn_stage11_gpu4</title>
<path fill="none" stroke="black" d="M18118,-4384.74C18118,-4366.02 18118,-4343.03 18118,-4323.05"/>
<polygon fill="black" stroke="black" points="18121.5,-4322.91 18118,-4312.91 18114.5,-4322.91 18121.5,-4322.91"/>
</g>
<!-- l3_attn_stage10_gpu4&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge2869" class="edge">
<title>l3_attn_stage10_gpu4&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18174.97,-4392.14C18189.89,-4385.85 18206.23,-4380.1 18222,-4376.83 18277.38,-4365.34 20204.62,-4385.51 20258,-4366.83 20268.16,-4363.28 20266.86,-4355.42 20277,-4351.83 20311.15,-4339.74 20893.48,-4350.93 20929,-4343.83 20974.31,-4334.78 21022.97,-4313.87 21056.2,-4297.7"/>
<polygon fill="red" stroke="red" points="21058.16,-4300.64 21065.57,-4293.07 21055.06,-4294.37 21058.16,-4300.64"/>
<text text-anchor="middle" x="20308.5" y="-4355.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu5 -->
<g id="node854" class="node">
<title>l3_attn_stage11_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="18950" cy="-4275.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18950" y="-4286.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="18950" y="-4271.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="18950" y="-4256.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu5&#45;&gt;l3_attn_stage11_gpu5 -->
<g id="edge1270" class="edge">
<title>l3_attn_stage10_gpu5&#45;&gt;l3_attn_stage11_gpu5</title>
<path fill="none" stroke="black" d="M18950,-4384.74C18950,-4366.02 18950,-4343.03 18950,-4323.05"/>
<polygon fill="black" stroke="black" points="18953.5,-4322.91 18950,-4312.91 18946.5,-4322.91 18953.5,-4322.91"/>
</g>
<!-- l3_attn_stage10_gpu5&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge2870" class="edge">
<title>l3_attn_stage10_gpu5&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19006.97,-4392.16C19021.9,-4385.86 19038.23,-4380.12 19054,-4376.83 19096.1,-4368.06 20561.42,-4381.07 20602,-4366.83 20612.15,-4363.27 20610.88,-4355.49 20621,-4351.83 20653.19,-4340.19 20895.48,-4350.77 20929,-4343.83 20974.11,-4334.5 21022.62,-4313.74 21055.86,-4297.68"/>
<polygon fill="red" stroke="red" points="21057.8,-4300.63 21065.24,-4293.08 21054.72,-4294.35 21057.8,-4300.63"/>
<text text-anchor="middle" x="20652.5" y="-4355.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu6 -->
<g id="node855" class="node">
<title>l3_attn_stage11_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19782" cy="-4275.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19782" y="-4286.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="19782" y="-4271.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19782" y="-4256.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu6&#45;&gt;l3_attn_stage11_gpu6 -->
<g id="edge1271" class="edge">
<title>l3_attn_stage10_gpu6&#45;&gt;l3_attn_stage11_gpu6</title>
<path fill="none" stroke="black" d="M19782,-4384.74C19782,-4366.02 19782,-4343.03 19782,-4323.05"/>
<polygon fill="black" stroke="black" points="19785.5,-4322.91 19782,-4312.91 19778.5,-4322.91 19785.5,-4322.91"/>
</g>
<!-- l3_attn_stage10_gpu6&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge2871" class="edge">
<title>l3_attn_stage10_gpu6&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19838.98,-4392.19C19853.91,-4385.89 19870.24,-4380.14 19886,-4376.83 19943.64,-4364.74 20890.46,-4386.41 20946,-4366.83 20956.15,-4363.26 20956.08,-4357.85 20965,-4351.83 20994.36,-4332.01 21029.2,-4312.22 21055.72,-4297.88"/>
<polygon fill="red" stroke="red" points="21057.57,-4300.86 21064.73,-4293.05 21054.26,-4294.69 21057.57,-4300.86"/>
<text text-anchor="middle" x="20996.5" y="-4355.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu7 -->
<g id="node856" class="node">
<title>l3_attn_stage11_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="18326" cy="-4275.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18326" y="-4286.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="18326" y="-4271.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="18326" y="-4256.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu7&#45;&gt;l3_attn_stage11_gpu7 -->
<g id="edge1272" class="edge">
<title>l3_attn_stage10_gpu7&#45;&gt;l3_attn_stage11_gpu7</title>
<path fill="none" stroke="black" d="M18326,-4384.74C18326,-4366.02 18326,-4343.03 18326,-4323.05"/>
<polygon fill="black" stroke="black" points="18329.5,-4322.91 18326,-4312.91 18322.5,-4322.91 18329.5,-4322.91"/>
</g>
<!-- l3_attn_stage10_gpu7&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge2872" class="edge">
<title>l3_attn_stage10_gpu7&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18382.97,-4392.14C18397.9,-4385.85 18414.23,-4380.11 18430,-4376.83 18482.06,-4366.02 20293.82,-4384.4 20344,-4366.83 20354.15,-4363.28 20352.86,-4355.43 20363,-4351.83 20392.63,-4341.31 20898.17,-4350.02 20929,-4343.83 20974.3,-4334.74 21022.97,-4313.84 21056.2,-4297.68"/>
<polygon fill="red" stroke="red" points="21058.15,-4300.62 21065.57,-4293.05 21055.05,-4294.34 21058.15,-4300.62"/>
<text text-anchor="middle" x="20394.5" y="-4355.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu8 -->
<g id="node857" class="node">
<title>l3_attn_stage11_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20198" cy="-4275.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20198" y="-4286.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="20198" y="-4271.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20198" y="-4256.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu8&#45;&gt;l3_attn_stage11_gpu8 -->
<g id="edge1273" class="edge">
<title>l3_attn_stage10_gpu8&#45;&gt;l3_attn_stage11_gpu8</title>
<path fill="none" stroke="black" d="M20135.19,-4394.01C20121.64,-4388.24 20107.37,-4382.26 20094,-4376.83 20082.53,-4372.17 20075.01,-4377.04 20068,-4366.83 20064.23,-4361.34 20064.04,-4357.2 20068,-4351.83 20075.18,-4342.11 20083.05,-4348.95 20094,-4343.83 20111.44,-4335.68 20129.39,-4324.99 20145.36,-4314.52"/>
<polygon fill="black" stroke="black" points="20147.64,-4317.21 20154.02,-4308.75 20143.76,-4311.39 20147.64,-4317.21"/>
</g>
<!-- l3_attn_stage10_gpu8&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge2873" class="edge">
<title>l3_attn_stage10_gpu8&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20254.99,-4392.22C20269.91,-4385.93 20286.24,-4380.16 20302,-4376.83 20324.18,-4372.15 21102.07,-4382.96 21118,-4366.83 21134.71,-4349.92 21125.21,-4322.47 21114.15,-4302.23"/>
<polygon fill="red" stroke="red" points="21117.11,-4300.37 21109.04,-4293.51 21111.07,-4303.9 21117.11,-4300.37"/>
<text text-anchor="middle" x="21156.5" y="-4355.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu9 -->
<g id="node858" class="node">
<title>l3_attn_stage11_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="19574" cy="-4275.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19574" y="-4286.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="19574" y="-4271.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="19574" y="-4256.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu9&#45;&gt;l3_attn_stage11_gpu9 -->
<g id="edge1274" class="edge">
<title>l3_attn_stage10_gpu9&#45;&gt;l3_attn_stage11_gpu9</title>
<path fill="none" stroke="black" d="M19574,-4384.74C19574,-4366.02 19574,-4343.03 19574,-4323.05"/>
<polygon fill="black" stroke="black" points="19577.5,-4322.91 19574,-4312.91 19570.5,-4322.91 19577.5,-4322.91"/>
</g>
<!-- l3_attn_stage10_gpu9&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge2874" class="edge">
<title>l3_attn_stage10_gpu9&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19630.98,-4392.18C19645.9,-4385.88 19662.24,-4380.13 19678,-4376.83 19742.28,-4363.38 20798.05,-4388.63 20860,-4366.83 20870.15,-4363.26 20869.15,-4356.16 20879,-4351.83 20899.61,-4342.79 20907.31,-4349.84 20929,-4343.83 20972.28,-4331.84 21019.59,-4312.2 21052.94,-4297.19"/>
<polygon fill="red" stroke="red" points="21054.74,-4300.22 21062.4,-4292.9 21051.84,-4293.85 21054.74,-4300.22"/>
<text text-anchor="middle" x="20910.5" y="-4355.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu10 -->
<g id="node859" class="node">
<title>l3_attn_stage11_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="17702" cy="-4275.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="17702" y="-4286.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="17702" y="-4271.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17702" y="-4256.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu10&#45;&gt;l3_attn_stage11_gpu10 -->
<g id="edge1275" class="edge">
<title>l3_attn_stage10_gpu10&#45;&gt;l3_attn_stage11_gpu10</title>
<path fill="none" stroke="black" d="M17702,-4384.74C17702,-4366.02 17702,-4343.03 17702,-4323.05"/>
<polygon fill="black" stroke="black" points="17705.5,-4322.91 17702,-4312.91 17698.5,-4322.91 17705.5,-4322.91"/>
</g>
<!-- l3_attn_stage10_gpu10&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge2875" class="edge">
<title>l3_attn_stage10_gpu10&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17758.98,-4392.2C17773.91,-4385.91 17790.24,-4380.15 17806,-4376.83 18055.97,-4324.18 19849.55,-4354.46 20105,-4351.83 20150.78,-4351.36 20884.1,-4352.74 20929,-4343.83 20974.32,-4334.84 21022.98,-4313.92 21056.21,-4297.74"/>
<polygon fill="red" stroke="red" points="21058.17,-4300.67 21065.58,-4293.1 21055.06,-4294.4 21058.17,-4300.67"/>
<text text-anchor="middle" x="20136.5" y="-4355.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu11 -->
<g id="node860" class="node">
<title>l3_attn_stage11_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="18534" cy="-4275.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18534" y="-4286.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="18534" y="-4271.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18534" y="-4256.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu11&#45;&gt;l3_attn_stage11_gpu11 -->
<g id="edge1276" class="edge">
<title>l3_attn_stage10_gpu11&#45;&gt;l3_attn_stage11_gpu11</title>
<path fill="none" stroke="black" d="M18534,-4384.74C18534,-4366.02 18534,-4343.03 18534,-4323.05"/>
<polygon fill="black" stroke="black" points="18537.5,-4322.91 18534,-4312.91 18530.5,-4322.91 18537.5,-4322.91"/>
</g>
<!-- l3_attn_stage10_gpu11&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge2876" class="edge">
<title>l3_attn_stage10_gpu11&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18590.97,-4392.15C18605.9,-4385.85 18622.23,-4380.11 18638,-4376.83 18686.74,-4366.7 20383.02,-4383.29 20430,-4366.83 20440.15,-4363.28 20438.87,-4355.45 20449,-4351.83 20499.24,-4333.92 20876.72,-4354.4 20929,-4343.83 20974.29,-4334.68 21022.96,-4313.79 21056.19,-4297.65"/>
<polygon fill="red" stroke="red" points="21058.14,-4300.59 21065.56,-4293.03 21055.05,-4294.31 21058.14,-4300.59"/>
<text text-anchor="middle" x="20480.5" y="-4355.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu12 -->
<g id="node861" class="node">
<title>l3_attn_stage11_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="17910" cy="-4275.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="17910" y="-4286.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="17910" y="-4271.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17910" y="-4256.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu12&#45;&gt;l3_attn_stage11_gpu12 -->
<g id="edge1277" class="edge">
<title>l3_attn_stage10_gpu12&#45;&gt;l3_attn_stage11_gpu12</title>
<path fill="none" stroke="black" d="M17910,-4384.74C17910,-4366.02 17910,-4343.03 17910,-4323.05"/>
<polygon fill="black" stroke="black" points="17913.5,-4322.91 17910,-4312.91 17906.5,-4322.91 17913.5,-4322.91"/>
</g>
<!-- l3_attn_stage10_gpu12&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge2877" class="edge">
<title>l3_attn_stage10_gpu12&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17966.97,-4392.14C17981.89,-4385.84 17998.23,-4380.1 18014,-4376.83 18072.7,-4364.66 20115.42,-4386.62 20172,-4366.83 20182.16,-4363.28 20180.86,-4355.42 20191,-4351.83 20229.66,-4338.18 20888.79,-4351.84 20929,-4343.83 20974.31,-4334.81 21022.98,-4313.9 21056.21,-4297.72"/>
<polygon fill="red" stroke="red" points="21058.17,-4300.66 21065.58,-4293.09 21055.06,-4294.38 21058.17,-4300.66"/>
<text text-anchor="middle" x="20222.5" y="-4355.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu13 -->
<g id="node862" class="node">
<title>l3_attn_stage11_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="18742" cy="-4275.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18742" y="-4286.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="18742" y="-4271.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18742" y="-4256.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu13&#45;&gt;l3_attn_stage11_gpu13 -->
<g id="edge1278" class="edge">
<title>l3_attn_stage10_gpu13&#45;&gt;l3_attn_stage11_gpu13</title>
<path fill="none" stroke="black" d="M18742,-4384.74C18742,-4366.02 18742,-4343.03 18742,-4323.05"/>
<polygon fill="black" stroke="black" points="18745.5,-4322.91 18742,-4312.91 18738.5,-4322.91 18745.5,-4322.91"/>
</g>
<!-- l3_attn_stage10_gpu13&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge2878" class="edge">
<title>l3_attn_stage10_gpu13&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18798.97,-4392.15C18813.9,-4385.86 18830.23,-4380.11 18846,-4376.83 18891.42,-4367.38 20472.22,-4382.18 20516,-4366.83 20526.15,-4363.27 20524.87,-4355.46 20535,-4351.83 20576.22,-4337.05 20886.1,-4352.58 20929,-4343.83 20974.27,-4334.6 21022.94,-4313.72 21056.18,-4297.6"/>
<polygon fill="red" stroke="red" points="21058.13,-4300.55 21065.56,-4292.99 21055.04,-4294.27 21058.13,-4300.55"/>
<text text-anchor="middle" x="20566.5" y="-4355.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu14 -->
<g id="node863" class="node">
<title>l3_attn_stage11_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19158" cy="-4275.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19158" y="-4286.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="19158" y="-4271.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19158" y="-4256.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu14&#45;&gt;l3_attn_stage11_gpu14 -->
<g id="edge1279" class="edge">
<title>l3_attn_stage10_gpu14&#45;&gt;l3_attn_stage11_gpu14</title>
<path fill="none" stroke="black" d="M19158,-4384.74C19158,-4366.02 19158,-4343.03 19158,-4323.05"/>
<polygon fill="black" stroke="black" points="19161.5,-4322.91 19158,-4312.91 19154.5,-4322.91 19161.5,-4322.91"/>
</g>
<!-- l3_attn_stage10_gpu14&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge2879" class="edge">
<title>l3_attn_stage10_gpu14&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19214.98,-4392.16C19229.9,-4385.87 19246.24,-4380.12 19262,-4376.83 19300.78,-4368.74 20650.62,-4379.95 20688,-4366.83 20698.15,-4363.27 20696.9,-4355.54 20707,-4351.83 20753.34,-4334.81 20880.71,-4354.08 20929,-4343.83 20974.06,-4334.27 21022.58,-4313.54 21055.83,-4297.56"/>
<polygon fill="red" stroke="red" points="21057.76,-4300.51 21065.22,-4292.98 21054.69,-4294.22 21057.76,-4300.51"/>
<text text-anchor="middle" x="20738.5" y="-4355.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu15 -->
<g id="node864" class="node">
<title>l3_attn_stage11_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20406" cy="-4275.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20406" y="-4286.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="20406" y="-4271.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20406" y="-4256.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu15&#45;&gt;l3_attn_stage11_gpu15 -->
<g id="edge1280" class="edge">
<title>l3_attn_stage10_gpu15&#45;&gt;l3_attn_stage11_gpu15</title>
<path fill="none" stroke="black" d="M20348.39,-4392.34C20333.62,-4386.12 20317.51,-4380.37 20302,-4376.83 20277.39,-4371.22 20092.45,-4385.07 20075,-4366.83 20070.39,-4362.02 20070.37,-4356.63 20075,-4351.83 20083.76,-4342.75 20289.97,-4347.63 20302,-4343.83 20321.58,-4337.66 20341,-4326.72 20357.67,-4315.41"/>
<polygon fill="black" stroke="black" points="20359.94,-4318.1 20366.13,-4309.5 20355.93,-4312.37 20359.94,-4318.1"/>
</g>
<!-- l3_attn_stage10_gpu15&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge2880" class="edge">
<title>l3_attn_stage10_gpu15&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20462.99,-4392.24C20477.92,-4385.95 20494.25,-4380.18 20510,-4376.83 20528.86,-4372.83 21190.47,-4380.56 21204,-4366.83 21229.62,-4340.85 21188.49,-4314.25 21150.04,-4296.67"/>
<polygon fill="red" stroke="red" points="21151.44,-4293.46 21140.88,-4292.62 21148.61,-4299.87 21151.44,-4293.46"/>
<text text-anchor="middle" x="21242.5" y="-4355.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu0 -->
<g id="node865" class="node">
<title>l3_attn_stage12_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20822" cy="-4128.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20822" y="-4139.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="20822" y="-4124.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20822" y="-4109.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu0&#45;&gt;l3_attn_stage12_gpu0 -->
<g id="edge1281" class="edge">
<title>l3_attn_stage11_gpu0&#45;&gt;l3_attn_stage12_gpu0</title>
<path fill="none" stroke="black" d="M20765,-4245.26C20750.08,-4238.96 20733.75,-4233.19 20718,-4229.83 20700.91,-4226.19 20101.26,-4232.29 20089,-4219.83 20084.32,-4215.08 20084.32,-4209.58 20089,-4204.83 20101.28,-4192.4 20701.28,-4201.9 20718,-4196.83 20737.65,-4190.88 20757.09,-4179.99 20773.75,-4168.68"/>
<polygon fill="black" stroke="black" points="20776.03,-4171.35 20782.2,-4162.74 20772.01,-4165.63 20776.03,-4171.35"/>
</g>
<!-- l3_attn_stage12_gpu[next_gpu] -->
<g id="node1386" class="node">
<title>l3_attn_stage12_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="21097" cy="-4128.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="21097" y="-4124.63" font-family="Times,serif" font-size="14.00">l3_attn_stage12_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage11_gpu0&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge2881" class="edge">
<title>l3_attn_stage11_gpu0&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20881.56,-4245.91C20897.88,-4239.4 20915.81,-4233.35 20933,-4229.83 20957.12,-4224.9 21358.79,-4237.44 21376,-4219.83 21425.67,-4169.03 21338.33,-4146.72 21248.57,-4136.94"/>
<polygon fill="red" stroke="red" points="21248.78,-4133.44 21238.47,-4135.89 21248.05,-4140.4 21248.78,-4133.44"/>
<text text-anchor="middle" x="21415.5" y="-4208.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu1 -->
<g id="node866" class="node">
<title>l3_attn_stage12_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19366" cy="-4128.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19366" y="-4139.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="19366" y="-4124.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19366" y="-4109.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu1&#45;&gt;l3_attn_stage12_gpu1 -->
<g id="edge1282" class="edge">
<title>l3_attn_stage11_gpu1&#45;&gt;l3_attn_stage12_gpu1</title>
<path fill="none" stroke="black" d="M19366,-4237.74C19366,-4219.02 19366,-4196.03 19366,-4176.05"/>
<polygon fill="black" stroke="black" points="19369.5,-4175.91 19366,-4165.91 19362.5,-4175.91 19369.5,-4175.91"/>
</g>
<!-- l3_attn_stage11_gpu1&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge2882" class="edge">
<title>l3_attn_stage11_gpu1&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19422.98,-4245.17C19437.9,-4238.88 19454.24,-4233.13 19470,-4229.83 19540.91,-4215.01 20705.65,-4243.85 20774,-4219.83 20784.15,-4216.27 20782.94,-4208.66 20793,-4204.83 20821.3,-4194.07 20899.46,-4203.45 20929,-4196.83 20973.67,-4186.83 21021.88,-4166.36 21055.15,-4150.58"/>
<polygon fill="red" stroke="red" points="21057.06,-4153.54 21064.55,-4146.05 21054.02,-4147.23 21057.06,-4153.54"/>
<text text-anchor="middle" x="20824.5" y="-4208.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu2 -->
<g id="node867" class="node">
<title>l3_attn_stage12_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20614" cy="-4128.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20614" y="-4139.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="20614" y="-4124.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20614" y="-4109.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu2&#45;&gt;l3_attn_stage12_gpu2 -->
<g id="edge1283" class="edge">
<title>l3_attn_stage11_gpu2&#45;&gt;l3_attn_stage12_gpu2</title>
<path fill="none" stroke="black" d="M20556.71,-4245.23C20541.86,-4238.97 20525.64,-4233.23 20510,-4229.83 20486.76,-4224.79 20098.62,-4236.85 20082,-4219.83 20077.34,-4215.06 20077.33,-4209.59 20082,-4204.83 20090.33,-4196.35 20498.63,-4200.31 20510,-4196.83 20529.63,-4190.82 20549.07,-4179.92 20565.73,-4168.61"/>
<polygon fill="black" stroke="black" points="20568.01,-4171.29 20574.18,-4162.68 20563.99,-4165.56 20568.01,-4171.29"/>
</g>
<!-- l3_attn_stage11_gpu2&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge2883" class="edge">
<title>l3_attn_stage11_gpu2&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20671,-4245.28C20685.92,-4238.98 20702.25,-4233.2 20718,-4229.83 20733.54,-4226.51 21278.86,-4231.17 21290,-4219.83 21326.88,-4182.3 21263.24,-4158.54 21199.37,-4144.83"/>
<polygon fill="red" stroke="red" points="21200.05,-4141.4 21189.55,-4142.8 21198.63,-4148.25 21200.05,-4141.4"/>
<text text-anchor="middle" x="21329.5" y="-4208.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu3 -->
<g id="node868" class="node">
<title>l3_attn_stage12_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="19990" cy="-4128.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19990" y="-4139.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="19990" y="-4124.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="19990" y="-4109.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu3&#45;&gt;l3_attn_stage12_gpu3 -->
<g id="edge1284" class="edge">
<title>l3_attn_stage11_gpu3&#45;&gt;l3_attn_stage12_gpu3</title>
<path fill="none" stroke="black" d="M19990,-4237.74C19990,-4219.02 19990,-4196.03 19990,-4176.05"/>
<polygon fill="black" stroke="black" points="19993.5,-4175.91 19990,-4165.91 19986.5,-4175.91 19993.5,-4175.91"/>
</g>
<!-- l3_attn_stage11_gpu3&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge2884" class="edge">
<title>l3_attn_stage11_gpu3&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20046.98,-4245.2C20061.91,-4238.91 20078.24,-4233.15 20094,-4229.83 20119.5,-4224.46 21008.88,-4231.85 21032,-4219.83 21045.7,-4212.71 21067.58,-4179.29 21082.12,-4155.13"/>
<polygon fill="red" stroke="red" points="21085.21,-4156.79 21087.3,-4146.4 21079.19,-4153.22 21085.21,-4156.79"/>
<text text-anchor="middle" x="21078.5" y="-4208.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu4 -->
<g id="node869" class="node">
<title>l3_attn_stage12_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="18118" cy="-4128.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18118" y="-4139.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="18118" y="-4124.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="18118" y="-4109.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu4&#45;&gt;l3_attn_stage12_gpu4 -->
<g id="edge1285" class="edge">
<title>l3_attn_stage11_gpu4&#45;&gt;l3_attn_stage12_gpu4</title>
<path fill="none" stroke="black" d="M18118,-4237.74C18118,-4219.02 18118,-4196.03 18118,-4176.05"/>
<polygon fill="black" stroke="black" points="18121.5,-4175.91 18118,-4165.91 18114.5,-4175.91 18121.5,-4175.91"/>
</g>
<!-- l3_attn_stage11_gpu4&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge2885" class="edge">
<title>l3_attn_stage11_gpu4&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18174.97,-4245.14C18189.89,-4238.85 18206.23,-4233.1 18222,-4229.83 18277.38,-4218.34 20204.62,-4238.51 20258,-4219.83 20268.16,-4216.28 20266.86,-4208.42 20277,-4204.83 20311.15,-4192.74 20893.48,-4203.93 20929,-4196.83 20974.31,-4187.78 21022.97,-4166.87 21056.2,-4150.7"/>
<polygon fill="red" stroke="red" points="21058.16,-4153.64 21065.57,-4146.07 21055.06,-4147.37 21058.16,-4153.64"/>
<text text-anchor="middle" x="20308.5" y="-4208.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu5 -->
<g id="node870" class="node">
<title>l3_attn_stage12_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="18950" cy="-4128.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18950" y="-4139.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="18950" y="-4124.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="18950" y="-4109.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu5&#45;&gt;l3_attn_stage12_gpu5 -->
<g id="edge1286" class="edge">
<title>l3_attn_stage11_gpu5&#45;&gt;l3_attn_stage12_gpu5</title>
<path fill="none" stroke="black" d="M18950,-4237.74C18950,-4219.02 18950,-4196.03 18950,-4176.05"/>
<polygon fill="black" stroke="black" points="18953.5,-4175.91 18950,-4165.91 18946.5,-4175.91 18953.5,-4175.91"/>
</g>
<!-- l3_attn_stage11_gpu5&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge2886" class="edge">
<title>l3_attn_stage11_gpu5&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19006.97,-4245.16C19021.9,-4238.86 19038.23,-4233.12 19054,-4229.83 19096.1,-4221.06 20561.42,-4234.07 20602,-4219.83 20612.15,-4216.27 20610.88,-4208.49 20621,-4204.83 20653.19,-4193.19 20895.48,-4203.77 20929,-4196.83 20974.11,-4187.5 21022.62,-4166.74 21055.86,-4150.68"/>
<polygon fill="red" stroke="red" points="21057.8,-4153.63 21065.24,-4146.08 21054.72,-4147.35 21057.8,-4153.63"/>
<text text-anchor="middle" x="20652.5" y="-4208.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu6 -->
<g id="node871" class="node">
<title>l3_attn_stage12_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19782" cy="-4128.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19782" y="-4139.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="19782" y="-4124.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19782" y="-4109.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu6&#45;&gt;l3_attn_stage12_gpu6 -->
<g id="edge1287" class="edge">
<title>l3_attn_stage11_gpu6&#45;&gt;l3_attn_stage12_gpu6</title>
<path fill="none" stroke="black" d="M19782,-4237.74C19782,-4219.02 19782,-4196.03 19782,-4176.05"/>
<polygon fill="black" stroke="black" points="19785.5,-4175.91 19782,-4165.91 19778.5,-4175.91 19785.5,-4175.91"/>
</g>
<!-- l3_attn_stage11_gpu6&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge2887" class="edge">
<title>l3_attn_stage11_gpu6&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19838.98,-4245.19C19853.91,-4238.89 19870.24,-4233.14 19886,-4229.83 19943.64,-4217.74 20890.46,-4239.41 20946,-4219.83 20956.15,-4216.26 20956.08,-4210.85 20965,-4204.83 20994.36,-4185.01 21029.2,-4165.22 21055.72,-4150.88"/>
<polygon fill="red" stroke="red" points="21057.57,-4153.86 21064.73,-4146.05 21054.26,-4147.69 21057.57,-4153.86"/>
<text text-anchor="middle" x="20996.5" y="-4208.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu7 -->
<g id="node872" class="node">
<title>l3_attn_stage12_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="18326" cy="-4128.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18326" y="-4139.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="18326" y="-4124.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="18326" y="-4109.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu7&#45;&gt;l3_attn_stage12_gpu7 -->
<g id="edge1288" class="edge">
<title>l3_attn_stage11_gpu7&#45;&gt;l3_attn_stage12_gpu7</title>
<path fill="none" stroke="black" d="M18326,-4237.74C18326,-4219.02 18326,-4196.03 18326,-4176.05"/>
<polygon fill="black" stroke="black" points="18329.5,-4175.91 18326,-4165.91 18322.5,-4175.91 18329.5,-4175.91"/>
</g>
<!-- l3_attn_stage11_gpu7&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge2888" class="edge">
<title>l3_attn_stage11_gpu7&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18382.97,-4245.14C18397.9,-4238.85 18414.23,-4233.11 18430,-4229.83 18482.06,-4219.02 20293.82,-4237.4 20344,-4219.83 20354.15,-4216.28 20352.86,-4208.43 20363,-4204.83 20392.63,-4194.31 20898.17,-4203.02 20929,-4196.83 20974.3,-4187.74 21022.97,-4166.84 21056.2,-4150.68"/>
<polygon fill="red" stroke="red" points="21058.15,-4153.62 21065.57,-4146.05 21055.05,-4147.34 21058.15,-4153.62"/>
<text text-anchor="middle" x="20394.5" y="-4208.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu8 -->
<g id="node873" class="node">
<title>l3_attn_stage12_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20198" cy="-4128.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20198" y="-4139.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="20198" y="-4124.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20198" y="-4109.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu8&#45;&gt;l3_attn_stage12_gpu8 -->
<g id="edge1289" class="edge">
<title>l3_attn_stage11_gpu8&#45;&gt;l3_attn_stage12_gpu8</title>
<path fill="none" stroke="black" d="M20135.19,-4247.01C20121.64,-4241.24 20107.37,-4235.26 20094,-4229.83 20082.53,-4225.17 20075.01,-4230.04 20068,-4219.83 20064.23,-4214.34 20064.04,-4210.2 20068,-4204.83 20075.18,-4195.11 20083.05,-4201.95 20094,-4196.83 20111.44,-4188.68 20129.39,-4177.99 20145.36,-4167.52"/>
<polygon fill="black" stroke="black" points="20147.64,-4170.21 20154.02,-4161.75 20143.76,-4164.39 20147.64,-4170.21"/>
</g>
<!-- l3_attn_stage11_gpu8&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge2889" class="edge">
<title>l3_attn_stage11_gpu8&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20254.99,-4245.22C20269.91,-4238.93 20286.24,-4233.16 20302,-4229.83 20324.18,-4225.15 21102.07,-4235.96 21118,-4219.83 21134.71,-4202.92 21125.21,-4175.47 21114.15,-4155.23"/>
<polygon fill="red" stroke="red" points="21117.11,-4153.37 21109.04,-4146.51 21111.07,-4156.9 21117.11,-4153.37"/>
<text text-anchor="middle" x="21156.5" y="-4208.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu9 -->
<g id="node874" class="node">
<title>l3_attn_stage12_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="19574" cy="-4128.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19574" y="-4139.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="19574" y="-4124.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="19574" y="-4109.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu9&#45;&gt;l3_attn_stage12_gpu9 -->
<g id="edge1290" class="edge">
<title>l3_attn_stage11_gpu9&#45;&gt;l3_attn_stage12_gpu9</title>
<path fill="none" stroke="black" d="M19574,-4237.74C19574,-4219.02 19574,-4196.03 19574,-4176.05"/>
<polygon fill="black" stroke="black" points="19577.5,-4175.91 19574,-4165.91 19570.5,-4175.91 19577.5,-4175.91"/>
</g>
<!-- l3_attn_stage11_gpu9&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge2890" class="edge">
<title>l3_attn_stage11_gpu9&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19630.98,-4245.18C19645.9,-4238.88 19662.24,-4233.13 19678,-4229.83 19742.28,-4216.38 20798.05,-4241.63 20860,-4219.83 20870.15,-4216.26 20869.15,-4209.16 20879,-4204.83 20899.61,-4195.79 20907.31,-4202.84 20929,-4196.83 20972.28,-4184.84 21019.59,-4165.2 21052.94,-4150.19"/>
<polygon fill="red" stroke="red" points="21054.74,-4153.22 21062.4,-4145.9 21051.84,-4146.85 21054.74,-4153.22"/>
<text text-anchor="middle" x="20910.5" y="-4208.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu10 -->
<g id="node875" class="node">
<title>l3_attn_stage12_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="17702" cy="-4128.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="17702" y="-4139.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="17702" y="-4124.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17702" y="-4109.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu10&#45;&gt;l3_attn_stage12_gpu10 -->
<g id="edge1291" class="edge">
<title>l3_attn_stage11_gpu10&#45;&gt;l3_attn_stage12_gpu10</title>
<path fill="none" stroke="black" d="M17702,-4237.74C17702,-4219.02 17702,-4196.03 17702,-4176.05"/>
<polygon fill="black" stroke="black" points="17705.5,-4175.91 17702,-4165.91 17698.5,-4175.91 17705.5,-4175.91"/>
</g>
<!-- l3_attn_stage11_gpu10&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge2891" class="edge">
<title>l3_attn_stage11_gpu10&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17758.98,-4245.2C17773.91,-4238.91 17790.24,-4233.15 17806,-4229.83 18055.97,-4177.18 19849.55,-4207.46 20105,-4204.83 20150.78,-4204.36 20884.1,-4205.74 20929,-4196.83 20974.32,-4187.84 21022.98,-4166.92 21056.21,-4150.74"/>
<polygon fill="red" stroke="red" points="21058.17,-4153.67 21065.58,-4146.1 21055.06,-4147.4 21058.17,-4153.67"/>
<text text-anchor="middle" x="20136.5" y="-4208.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu11 -->
<g id="node876" class="node">
<title>l3_attn_stage12_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="18534" cy="-4128.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18534" y="-4139.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="18534" y="-4124.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18534" y="-4109.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu11&#45;&gt;l3_attn_stage12_gpu11 -->
<g id="edge1292" class="edge">
<title>l3_attn_stage11_gpu11&#45;&gt;l3_attn_stage12_gpu11</title>
<path fill="none" stroke="black" d="M18534,-4237.74C18534,-4219.02 18534,-4196.03 18534,-4176.05"/>
<polygon fill="black" stroke="black" points="18537.5,-4175.91 18534,-4165.91 18530.5,-4175.91 18537.5,-4175.91"/>
</g>
<!-- l3_attn_stage11_gpu11&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge2892" class="edge">
<title>l3_attn_stage11_gpu11&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18590.97,-4245.15C18605.9,-4238.85 18622.23,-4233.11 18638,-4229.83 18686.74,-4219.7 20383.02,-4236.29 20430,-4219.83 20440.15,-4216.28 20438.87,-4208.45 20449,-4204.83 20499.24,-4186.92 20876.72,-4207.4 20929,-4196.83 20974.29,-4187.68 21022.96,-4166.79 21056.19,-4150.65"/>
<polygon fill="red" stroke="red" points="21058.14,-4153.59 21065.56,-4146.03 21055.05,-4147.31 21058.14,-4153.59"/>
<text text-anchor="middle" x="20480.5" y="-4208.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu12 -->
<g id="node877" class="node">
<title>l3_attn_stage12_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="17910" cy="-4128.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="17910" y="-4139.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="17910" y="-4124.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17910" y="-4109.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu12&#45;&gt;l3_attn_stage12_gpu12 -->
<g id="edge1293" class="edge">
<title>l3_attn_stage11_gpu12&#45;&gt;l3_attn_stage12_gpu12</title>
<path fill="none" stroke="black" d="M17910,-4237.74C17910,-4219.02 17910,-4196.03 17910,-4176.05"/>
<polygon fill="black" stroke="black" points="17913.5,-4175.91 17910,-4165.91 17906.5,-4175.91 17913.5,-4175.91"/>
</g>
<!-- l3_attn_stage11_gpu12&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge2893" class="edge">
<title>l3_attn_stage11_gpu12&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17966.97,-4245.14C17981.89,-4238.84 17998.23,-4233.1 18014,-4229.83 18072.7,-4217.66 20115.42,-4239.62 20172,-4219.83 20182.16,-4216.28 20180.86,-4208.42 20191,-4204.83 20229.66,-4191.18 20888.79,-4204.84 20929,-4196.83 20974.31,-4187.81 21022.98,-4166.9 21056.21,-4150.72"/>
<polygon fill="red" stroke="red" points="21058.17,-4153.66 21065.58,-4146.09 21055.06,-4147.38 21058.17,-4153.66"/>
<text text-anchor="middle" x="20222.5" y="-4208.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu13 -->
<g id="node878" class="node">
<title>l3_attn_stage12_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="18742" cy="-4128.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18742" y="-4139.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="18742" y="-4124.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18742" y="-4109.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu13&#45;&gt;l3_attn_stage12_gpu13 -->
<g id="edge1294" class="edge">
<title>l3_attn_stage11_gpu13&#45;&gt;l3_attn_stage12_gpu13</title>
<path fill="none" stroke="black" d="M18742,-4237.74C18742,-4219.02 18742,-4196.03 18742,-4176.05"/>
<polygon fill="black" stroke="black" points="18745.5,-4175.91 18742,-4165.91 18738.5,-4175.91 18745.5,-4175.91"/>
</g>
<!-- l3_attn_stage11_gpu13&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge2894" class="edge">
<title>l3_attn_stage11_gpu13&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18798.97,-4245.15C18813.9,-4238.86 18830.23,-4233.11 18846,-4229.83 18891.42,-4220.38 20472.22,-4235.18 20516,-4219.83 20526.15,-4216.27 20524.87,-4208.46 20535,-4204.83 20576.22,-4190.05 20886.1,-4205.58 20929,-4196.83 20974.27,-4187.6 21022.94,-4166.72 21056.18,-4150.6"/>
<polygon fill="red" stroke="red" points="21058.13,-4153.55 21065.56,-4145.99 21055.04,-4147.27 21058.13,-4153.55"/>
<text text-anchor="middle" x="20566.5" y="-4208.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu14 -->
<g id="node879" class="node">
<title>l3_attn_stage12_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19158" cy="-4128.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19158" y="-4139.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="19158" y="-4124.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19158" y="-4109.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu14&#45;&gt;l3_attn_stage12_gpu14 -->
<g id="edge1295" class="edge">
<title>l3_attn_stage11_gpu14&#45;&gt;l3_attn_stage12_gpu14</title>
<path fill="none" stroke="black" d="M19158,-4237.74C19158,-4219.02 19158,-4196.03 19158,-4176.05"/>
<polygon fill="black" stroke="black" points="19161.5,-4175.91 19158,-4165.91 19154.5,-4175.91 19161.5,-4175.91"/>
</g>
<!-- l3_attn_stage11_gpu14&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge2895" class="edge">
<title>l3_attn_stage11_gpu14&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19214.98,-4245.16C19229.9,-4238.87 19246.24,-4233.12 19262,-4229.83 19300.78,-4221.74 20650.62,-4232.95 20688,-4219.83 20698.15,-4216.27 20696.9,-4208.54 20707,-4204.83 20753.34,-4187.81 20880.71,-4207.08 20929,-4196.83 20974.06,-4187.27 21022.58,-4166.54 21055.83,-4150.56"/>
<polygon fill="red" stroke="red" points="21057.76,-4153.51 21065.22,-4145.98 21054.69,-4147.22 21057.76,-4153.51"/>
<text text-anchor="middle" x="20738.5" y="-4208.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu15 -->
<g id="node880" class="node">
<title>l3_attn_stage12_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20406" cy="-4128.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20406" y="-4139.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="20406" y="-4124.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20406" y="-4109.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu15&#45;&gt;l3_attn_stage12_gpu15 -->
<g id="edge1296" class="edge">
<title>l3_attn_stage11_gpu15&#45;&gt;l3_attn_stage12_gpu15</title>
<path fill="none" stroke="black" d="M20348.39,-4245.34C20333.62,-4239.12 20317.51,-4233.37 20302,-4229.83 20277.39,-4224.22 20092.45,-4238.07 20075,-4219.83 20070.39,-4215.02 20070.37,-4209.63 20075,-4204.83 20083.76,-4195.75 20289.97,-4200.63 20302,-4196.83 20321.58,-4190.66 20341,-4179.72 20357.67,-4168.41"/>
<polygon fill="black" stroke="black" points="20359.94,-4171.1 20366.13,-4162.5 20355.93,-4165.37 20359.94,-4171.1"/>
</g>
<!-- l3_attn_stage11_gpu15&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge2896" class="edge">
<title>l3_attn_stage11_gpu15&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20462.99,-4245.24C20477.92,-4238.95 20494.25,-4233.18 20510,-4229.83 20528.86,-4225.83 21190.47,-4233.56 21204,-4219.83 21229.62,-4193.85 21188.49,-4167.25 21150.04,-4149.67"/>
<polygon fill="red" stroke="red" points="21151.44,-4146.46 21140.88,-4145.62 21148.61,-4152.87 21151.44,-4146.46"/>
<text text-anchor="middle" x="21242.5" y="-4208.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu0 -->
<g id="node881" class="node">
<title>l3_attn_stage13_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20822" cy="-3981.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20822" y="-3992.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="20822" y="-3977.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20822" y="-3962.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu0&#45;&gt;l3_attn_stage13_gpu0 -->
<g id="edge1297" class="edge">
<title>l3_attn_stage12_gpu0&#45;&gt;l3_attn_stage13_gpu0</title>
<path fill="none" stroke="black" d="M20765,-4098.26C20750.08,-4091.96 20733.75,-4086.19 20718,-4082.83 20700.91,-4079.19 20101.26,-4085.29 20089,-4072.83 20084.32,-4068.08 20084.32,-4062.58 20089,-4057.83 20101.28,-4045.4 20701.28,-4054.9 20718,-4049.83 20737.65,-4043.88 20757.09,-4032.99 20773.75,-4021.68"/>
<polygon fill="black" stroke="black" points="20776.03,-4024.35 20782.2,-4015.74 20772.01,-4018.63 20776.03,-4024.35"/>
</g>
<!-- l3_attn_stage13_gpu[next_gpu] -->
<g id="node1387" class="node">
<title>l3_attn_stage13_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="21097" cy="-3981.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="21097" y="-3977.63" font-family="Times,serif" font-size="14.00">l3_attn_stage13_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage12_gpu0&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge2897" class="edge">
<title>l3_attn_stage12_gpu0&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20881.56,-4098.91C20897.88,-4092.4 20915.81,-4086.35 20933,-4082.83 20957.12,-4077.9 21358.79,-4090.44 21376,-4072.83 21425.67,-4022.03 21338.33,-3999.72 21248.57,-3989.94"/>
<polygon fill="red" stroke="red" points="21248.78,-3986.44 21238.47,-3988.89 21248.05,-3993.4 21248.78,-3986.44"/>
<text text-anchor="middle" x="21415.5" y="-4061.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu1 -->
<g id="node882" class="node">
<title>l3_attn_stage13_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19366" cy="-3981.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19366" y="-3992.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="19366" y="-3977.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19366" y="-3962.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu1&#45;&gt;l3_attn_stage13_gpu1 -->
<g id="edge1298" class="edge">
<title>l3_attn_stage12_gpu1&#45;&gt;l3_attn_stage13_gpu1</title>
<path fill="none" stroke="black" d="M19366,-4090.74C19366,-4072.02 19366,-4049.03 19366,-4029.05"/>
<polygon fill="black" stroke="black" points="19369.5,-4028.91 19366,-4018.91 19362.5,-4028.91 19369.5,-4028.91"/>
</g>
<!-- l3_attn_stage12_gpu1&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge2898" class="edge">
<title>l3_attn_stage12_gpu1&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19422.98,-4098.17C19437.9,-4091.88 19454.24,-4086.13 19470,-4082.83 19540.91,-4068.01 20705.65,-4096.85 20774,-4072.83 20784.15,-4069.27 20782.94,-4061.66 20793,-4057.83 20821.3,-4047.07 20899.46,-4056.45 20929,-4049.83 20973.67,-4039.83 21021.88,-4019.36 21055.15,-4003.58"/>
<polygon fill="red" stroke="red" points="21057.06,-4006.54 21064.55,-3999.05 21054.02,-4000.23 21057.06,-4006.54"/>
<text text-anchor="middle" x="20824.5" y="-4061.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu2 -->
<g id="node883" class="node">
<title>l3_attn_stage13_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20614" cy="-3981.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20614" y="-3992.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="20614" y="-3977.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20614" y="-3962.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu2&#45;&gt;l3_attn_stage13_gpu2 -->
<g id="edge1299" class="edge">
<title>l3_attn_stage12_gpu2&#45;&gt;l3_attn_stage13_gpu2</title>
<path fill="none" stroke="black" d="M20556.71,-4098.23C20541.86,-4091.97 20525.64,-4086.23 20510,-4082.83 20486.76,-4077.79 20098.62,-4089.85 20082,-4072.83 20077.34,-4068.06 20077.33,-4062.59 20082,-4057.83 20090.33,-4049.35 20498.63,-4053.31 20510,-4049.83 20529.63,-4043.82 20549.07,-4032.92 20565.73,-4021.61"/>
<polygon fill="black" stroke="black" points="20568.01,-4024.29 20574.18,-4015.68 20563.99,-4018.56 20568.01,-4024.29"/>
</g>
<!-- l3_attn_stage12_gpu2&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge2899" class="edge">
<title>l3_attn_stage12_gpu2&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20671,-4098.28C20685.92,-4091.98 20702.25,-4086.2 20718,-4082.83 20733.54,-4079.51 21278.86,-4084.17 21290,-4072.83 21326.88,-4035.3 21263.24,-4011.54 21199.37,-3997.83"/>
<polygon fill="red" stroke="red" points="21200.05,-3994.4 21189.55,-3995.8 21198.63,-4001.25 21200.05,-3994.4"/>
<text text-anchor="middle" x="21329.5" y="-4061.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu3 -->
<g id="node884" class="node">
<title>l3_attn_stage13_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="19990" cy="-3981.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19990" y="-3992.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="19990" y="-3977.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="19990" y="-3962.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu3&#45;&gt;l3_attn_stage13_gpu3 -->
<g id="edge1300" class="edge">
<title>l3_attn_stage12_gpu3&#45;&gt;l3_attn_stage13_gpu3</title>
<path fill="none" stroke="black" d="M19990,-4090.74C19990,-4072.02 19990,-4049.03 19990,-4029.05"/>
<polygon fill="black" stroke="black" points="19993.5,-4028.91 19990,-4018.91 19986.5,-4028.91 19993.5,-4028.91"/>
</g>
<!-- l3_attn_stage12_gpu3&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge2900" class="edge">
<title>l3_attn_stage12_gpu3&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20046.98,-4098.2C20061.91,-4091.91 20078.24,-4086.15 20094,-4082.83 20119.5,-4077.46 21008.88,-4084.85 21032,-4072.83 21045.7,-4065.71 21067.58,-4032.29 21082.12,-4008.13"/>
<polygon fill="red" stroke="red" points="21085.21,-4009.79 21087.3,-3999.4 21079.19,-4006.22 21085.21,-4009.79"/>
<text text-anchor="middle" x="21078.5" y="-4061.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu4 -->
<g id="node885" class="node">
<title>l3_attn_stage13_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="18118" cy="-3981.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18118" y="-3992.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="18118" y="-3977.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="18118" y="-3962.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu4&#45;&gt;l3_attn_stage13_gpu4 -->
<g id="edge1301" class="edge">
<title>l3_attn_stage12_gpu4&#45;&gt;l3_attn_stage13_gpu4</title>
<path fill="none" stroke="black" d="M18118,-4090.74C18118,-4072.02 18118,-4049.03 18118,-4029.05"/>
<polygon fill="black" stroke="black" points="18121.5,-4028.91 18118,-4018.91 18114.5,-4028.91 18121.5,-4028.91"/>
</g>
<!-- l3_attn_stage12_gpu4&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge2901" class="edge">
<title>l3_attn_stage12_gpu4&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18174.97,-4098.14C18189.89,-4091.85 18206.23,-4086.1 18222,-4082.83 18277.38,-4071.34 20204.62,-4091.51 20258,-4072.83 20268.16,-4069.28 20266.86,-4061.42 20277,-4057.83 20311.15,-4045.74 20893.48,-4056.93 20929,-4049.83 20974.31,-4040.78 21022.97,-4019.87 21056.2,-4003.7"/>
<polygon fill="red" stroke="red" points="21058.16,-4006.64 21065.57,-3999.07 21055.06,-4000.37 21058.16,-4006.64"/>
<text text-anchor="middle" x="20308.5" y="-4061.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu5 -->
<g id="node886" class="node">
<title>l3_attn_stage13_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="18950" cy="-3981.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18950" y="-3992.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="18950" y="-3977.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="18950" y="-3962.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu5&#45;&gt;l3_attn_stage13_gpu5 -->
<g id="edge1302" class="edge">
<title>l3_attn_stage12_gpu5&#45;&gt;l3_attn_stage13_gpu5</title>
<path fill="none" stroke="black" d="M18950,-4090.74C18950,-4072.02 18950,-4049.03 18950,-4029.05"/>
<polygon fill="black" stroke="black" points="18953.5,-4028.91 18950,-4018.91 18946.5,-4028.91 18953.5,-4028.91"/>
</g>
<!-- l3_attn_stage12_gpu5&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge2902" class="edge">
<title>l3_attn_stage12_gpu5&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19006.97,-4098.16C19021.9,-4091.86 19038.23,-4086.12 19054,-4082.83 19096.1,-4074.06 20561.42,-4087.07 20602,-4072.83 20612.15,-4069.27 20610.88,-4061.49 20621,-4057.83 20653.19,-4046.19 20895.48,-4056.77 20929,-4049.83 20974.11,-4040.5 21022.62,-4019.74 21055.86,-4003.68"/>
<polygon fill="red" stroke="red" points="21057.8,-4006.63 21065.24,-3999.08 21054.72,-4000.35 21057.8,-4006.63"/>
<text text-anchor="middle" x="20652.5" y="-4061.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu6 -->
<g id="node887" class="node">
<title>l3_attn_stage13_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19782" cy="-3981.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19782" y="-3992.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="19782" y="-3977.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19782" y="-3962.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu6&#45;&gt;l3_attn_stage13_gpu6 -->
<g id="edge1303" class="edge">
<title>l3_attn_stage12_gpu6&#45;&gt;l3_attn_stage13_gpu6</title>
<path fill="none" stroke="black" d="M19782,-4090.74C19782,-4072.02 19782,-4049.03 19782,-4029.05"/>
<polygon fill="black" stroke="black" points="19785.5,-4028.91 19782,-4018.91 19778.5,-4028.91 19785.5,-4028.91"/>
</g>
<!-- l3_attn_stage12_gpu6&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge2903" class="edge">
<title>l3_attn_stage12_gpu6&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19838.98,-4098.19C19853.91,-4091.89 19870.24,-4086.14 19886,-4082.83 19943.64,-4070.74 20890.46,-4092.41 20946,-4072.83 20956.15,-4069.26 20956.08,-4063.85 20965,-4057.83 20994.36,-4038.01 21029.2,-4018.22 21055.72,-4003.88"/>
<polygon fill="red" stroke="red" points="21057.57,-4006.86 21064.73,-3999.05 21054.26,-4000.69 21057.57,-4006.86"/>
<text text-anchor="middle" x="20996.5" y="-4061.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu7 -->
<g id="node888" class="node">
<title>l3_attn_stage13_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="18326" cy="-3981.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18326" y="-3992.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="18326" y="-3977.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="18326" y="-3962.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu7&#45;&gt;l3_attn_stage13_gpu7 -->
<g id="edge1304" class="edge">
<title>l3_attn_stage12_gpu7&#45;&gt;l3_attn_stage13_gpu7</title>
<path fill="none" stroke="black" d="M18326,-4090.74C18326,-4072.02 18326,-4049.03 18326,-4029.05"/>
<polygon fill="black" stroke="black" points="18329.5,-4028.91 18326,-4018.91 18322.5,-4028.91 18329.5,-4028.91"/>
</g>
<!-- l3_attn_stage12_gpu7&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge2904" class="edge">
<title>l3_attn_stage12_gpu7&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18382.97,-4098.14C18397.9,-4091.85 18414.23,-4086.11 18430,-4082.83 18482.06,-4072.02 20293.82,-4090.4 20344,-4072.83 20354.15,-4069.28 20352.86,-4061.43 20363,-4057.83 20392.63,-4047.31 20898.17,-4056.02 20929,-4049.83 20974.3,-4040.74 21022.97,-4019.84 21056.2,-4003.68"/>
<polygon fill="red" stroke="red" points="21058.15,-4006.62 21065.57,-3999.05 21055.05,-4000.34 21058.15,-4006.62"/>
<text text-anchor="middle" x="20394.5" y="-4061.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu8 -->
<g id="node889" class="node">
<title>l3_attn_stage13_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20198" cy="-3981.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20198" y="-3992.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="20198" y="-3977.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20198" y="-3962.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu8&#45;&gt;l3_attn_stage13_gpu8 -->
<g id="edge1305" class="edge">
<title>l3_attn_stage12_gpu8&#45;&gt;l3_attn_stage13_gpu8</title>
<path fill="none" stroke="black" d="M20135.19,-4100.01C20121.64,-4094.24 20107.37,-4088.26 20094,-4082.83 20082.53,-4078.17 20075.01,-4083.04 20068,-4072.83 20064.23,-4067.34 20064.04,-4063.2 20068,-4057.83 20075.18,-4048.11 20083.05,-4054.95 20094,-4049.83 20111.44,-4041.68 20129.39,-4030.99 20145.36,-4020.52"/>
<polygon fill="black" stroke="black" points="20147.64,-4023.21 20154.02,-4014.75 20143.76,-4017.39 20147.64,-4023.21"/>
</g>
<!-- l3_attn_stage12_gpu8&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge2905" class="edge">
<title>l3_attn_stage12_gpu8&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20254.99,-4098.22C20269.91,-4091.93 20286.24,-4086.16 20302,-4082.83 20324.18,-4078.15 21102.07,-4088.96 21118,-4072.83 21134.71,-4055.92 21125.21,-4028.47 21114.15,-4008.23"/>
<polygon fill="red" stroke="red" points="21117.11,-4006.37 21109.04,-3999.51 21111.07,-4009.9 21117.11,-4006.37"/>
<text text-anchor="middle" x="21156.5" y="-4061.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu9 -->
<g id="node890" class="node">
<title>l3_attn_stage13_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="19574" cy="-3981.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19574" y="-3992.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="19574" y="-3977.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="19574" y="-3962.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu9&#45;&gt;l3_attn_stage13_gpu9 -->
<g id="edge1306" class="edge">
<title>l3_attn_stage12_gpu9&#45;&gt;l3_attn_stage13_gpu9</title>
<path fill="none" stroke="black" d="M19574,-4090.74C19574,-4072.02 19574,-4049.03 19574,-4029.05"/>
<polygon fill="black" stroke="black" points="19577.5,-4028.91 19574,-4018.91 19570.5,-4028.91 19577.5,-4028.91"/>
</g>
<!-- l3_attn_stage12_gpu9&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge2906" class="edge">
<title>l3_attn_stage12_gpu9&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19630.98,-4098.18C19645.9,-4091.88 19662.24,-4086.13 19678,-4082.83 19742.28,-4069.38 20798.05,-4094.63 20860,-4072.83 20870.15,-4069.26 20869.15,-4062.16 20879,-4057.83 20899.61,-4048.79 20907.31,-4055.84 20929,-4049.83 20972.28,-4037.84 21019.59,-4018.2 21052.94,-4003.19"/>
<polygon fill="red" stroke="red" points="21054.74,-4006.22 21062.4,-3998.9 21051.84,-3999.85 21054.74,-4006.22"/>
<text text-anchor="middle" x="20910.5" y="-4061.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu10 -->
<g id="node891" class="node">
<title>l3_attn_stage13_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="17702" cy="-3981.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="17702" y="-3992.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="17702" y="-3977.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17702" y="-3962.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu10&#45;&gt;l3_attn_stage13_gpu10 -->
<g id="edge1307" class="edge">
<title>l3_attn_stage12_gpu10&#45;&gt;l3_attn_stage13_gpu10</title>
<path fill="none" stroke="black" d="M17702,-4090.74C17702,-4072.02 17702,-4049.03 17702,-4029.05"/>
<polygon fill="black" stroke="black" points="17705.5,-4028.91 17702,-4018.91 17698.5,-4028.91 17705.5,-4028.91"/>
</g>
<!-- l3_attn_stage12_gpu10&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge2907" class="edge">
<title>l3_attn_stage12_gpu10&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17758.98,-4098.2C17773.91,-4091.91 17790.24,-4086.15 17806,-4082.83 18055.97,-4030.18 19849.55,-4060.46 20105,-4057.83 20150.78,-4057.36 20884.1,-4058.74 20929,-4049.83 20974.32,-4040.84 21022.98,-4019.92 21056.21,-4003.74"/>
<polygon fill="red" stroke="red" points="21058.17,-4006.67 21065.58,-3999.1 21055.06,-4000.4 21058.17,-4006.67"/>
<text text-anchor="middle" x="20136.5" y="-4061.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu11 -->
<g id="node892" class="node">
<title>l3_attn_stage13_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="18534" cy="-3981.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18534" y="-3992.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="18534" y="-3977.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18534" y="-3962.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu11&#45;&gt;l3_attn_stage13_gpu11 -->
<g id="edge1308" class="edge">
<title>l3_attn_stage12_gpu11&#45;&gt;l3_attn_stage13_gpu11</title>
<path fill="none" stroke="black" d="M18534,-4090.74C18534,-4072.02 18534,-4049.03 18534,-4029.05"/>
<polygon fill="black" stroke="black" points="18537.5,-4028.91 18534,-4018.91 18530.5,-4028.91 18537.5,-4028.91"/>
</g>
<!-- l3_attn_stage12_gpu11&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge2908" class="edge">
<title>l3_attn_stage12_gpu11&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18590.97,-4098.15C18605.9,-4091.85 18622.23,-4086.11 18638,-4082.83 18686.74,-4072.7 20383.02,-4089.29 20430,-4072.83 20440.15,-4069.28 20438.87,-4061.45 20449,-4057.83 20499.24,-4039.92 20876.72,-4060.4 20929,-4049.83 20974.29,-4040.68 21022.96,-4019.79 21056.19,-4003.65"/>
<polygon fill="red" stroke="red" points="21058.14,-4006.59 21065.56,-3999.03 21055.05,-4000.31 21058.14,-4006.59"/>
<text text-anchor="middle" x="20480.5" y="-4061.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu12 -->
<g id="node893" class="node">
<title>l3_attn_stage13_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="17910" cy="-3981.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="17910" y="-3992.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="17910" y="-3977.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17910" y="-3962.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu12&#45;&gt;l3_attn_stage13_gpu12 -->
<g id="edge1309" class="edge">
<title>l3_attn_stage12_gpu12&#45;&gt;l3_attn_stage13_gpu12</title>
<path fill="none" stroke="black" d="M17910,-4090.74C17910,-4072.02 17910,-4049.03 17910,-4029.05"/>
<polygon fill="black" stroke="black" points="17913.5,-4028.91 17910,-4018.91 17906.5,-4028.91 17913.5,-4028.91"/>
</g>
<!-- l3_attn_stage12_gpu12&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge2909" class="edge">
<title>l3_attn_stage12_gpu12&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17966.97,-4098.14C17981.89,-4091.84 17998.23,-4086.1 18014,-4082.83 18072.7,-4070.66 20115.42,-4092.62 20172,-4072.83 20182.16,-4069.28 20180.86,-4061.42 20191,-4057.83 20229.66,-4044.18 20888.79,-4057.84 20929,-4049.83 20974.31,-4040.81 21022.98,-4019.9 21056.21,-4003.72"/>
<polygon fill="red" stroke="red" points="21058.17,-4006.66 21065.58,-3999.09 21055.06,-4000.38 21058.17,-4006.66"/>
<text text-anchor="middle" x="20222.5" y="-4061.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu13 -->
<g id="node894" class="node">
<title>l3_attn_stage13_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="18742" cy="-3981.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18742" y="-3992.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="18742" y="-3977.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18742" y="-3962.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu13&#45;&gt;l3_attn_stage13_gpu13 -->
<g id="edge1310" class="edge">
<title>l3_attn_stage12_gpu13&#45;&gt;l3_attn_stage13_gpu13</title>
<path fill="none" stroke="black" d="M18742,-4090.74C18742,-4072.02 18742,-4049.03 18742,-4029.05"/>
<polygon fill="black" stroke="black" points="18745.5,-4028.91 18742,-4018.91 18738.5,-4028.91 18745.5,-4028.91"/>
</g>
<!-- l3_attn_stage12_gpu13&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge2910" class="edge">
<title>l3_attn_stage12_gpu13&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18798.97,-4098.15C18813.9,-4091.86 18830.23,-4086.11 18846,-4082.83 18891.42,-4073.38 20472.22,-4088.18 20516,-4072.83 20526.15,-4069.27 20524.87,-4061.46 20535,-4057.83 20576.22,-4043.05 20886.1,-4058.58 20929,-4049.83 20974.27,-4040.6 21022.94,-4019.72 21056.18,-4003.6"/>
<polygon fill="red" stroke="red" points="21058.13,-4006.55 21065.56,-3998.99 21055.04,-4000.27 21058.13,-4006.55"/>
<text text-anchor="middle" x="20566.5" y="-4061.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu14 -->
<g id="node895" class="node">
<title>l3_attn_stage13_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19158" cy="-3981.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19158" y="-3992.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="19158" y="-3977.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19158" y="-3962.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu14&#45;&gt;l3_attn_stage13_gpu14 -->
<g id="edge1311" class="edge">
<title>l3_attn_stage12_gpu14&#45;&gt;l3_attn_stage13_gpu14</title>
<path fill="none" stroke="black" d="M19158,-4090.74C19158,-4072.02 19158,-4049.03 19158,-4029.05"/>
<polygon fill="black" stroke="black" points="19161.5,-4028.91 19158,-4018.91 19154.5,-4028.91 19161.5,-4028.91"/>
</g>
<!-- l3_attn_stage12_gpu14&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge2911" class="edge">
<title>l3_attn_stage12_gpu14&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19214.98,-4098.16C19229.9,-4091.87 19246.24,-4086.12 19262,-4082.83 19300.78,-4074.74 20650.62,-4085.95 20688,-4072.83 20698.15,-4069.27 20696.9,-4061.54 20707,-4057.83 20753.34,-4040.81 20880.71,-4060.08 20929,-4049.83 20974.06,-4040.27 21022.58,-4019.54 21055.83,-4003.56"/>
<polygon fill="red" stroke="red" points="21057.76,-4006.51 21065.22,-3998.98 21054.69,-4000.22 21057.76,-4006.51"/>
<text text-anchor="middle" x="20738.5" y="-4061.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu15 -->
<g id="node896" class="node">
<title>l3_attn_stage13_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20406" cy="-3981.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20406" y="-3992.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="20406" y="-3977.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20406" y="-3962.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu15&#45;&gt;l3_attn_stage13_gpu15 -->
<g id="edge1312" class="edge">
<title>l3_attn_stage12_gpu15&#45;&gt;l3_attn_stage13_gpu15</title>
<path fill="none" stroke="black" d="M20348.39,-4098.34C20333.62,-4092.12 20317.51,-4086.37 20302,-4082.83 20277.39,-4077.22 20092.45,-4091.07 20075,-4072.83 20070.39,-4068.02 20070.37,-4062.63 20075,-4057.83 20083.76,-4048.75 20289.97,-4053.63 20302,-4049.83 20321.58,-4043.66 20341,-4032.72 20357.67,-4021.41"/>
<polygon fill="black" stroke="black" points="20359.94,-4024.1 20366.13,-4015.5 20355.93,-4018.37 20359.94,-4024.1"/>
</g>
<!-- l3_attn_stage12_gpu15&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge2912" class="edge">
<title>l3_attn_stage12_gpu15&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20462.99,-4098.24C20477.92,-4091.95 20494.25,-4086.18 20510,-4082.83 20528.86,-4078.83 21190.47,-4086.56 21204,-4072.83 21229.62,-4046.85 21188.49,-4020.25 21150.04,-4002.67"/>
<polygon fill="red" stroke="red" points="21151.44,-3999.46 21140.88,-3998.62 21148.61,-4005.87 21151.44,-3999.46"/>
<text text-anchor="middle" x="21242.5" y="-4061.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu0 -->
<g id="node897" class="node">
<title>l3_attn_stage14_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="20822" cy="-3834.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20822" y="-3845.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="20822" y="-3830.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="20822" y="-3815.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu0&#45;&gt;l3_attn_stage14_gpu0 -->
<g id="edge1313" class="edge">
<title>l3_attn_stage13_gpu0&#45;&gt;l3_attn_stage14_gpu0</title>
<path fill="none" stroke="black" d="M20765,-3951.26C20750.08,-3944.96 20733.75,-3939.19 20718,-3935.83 20700.91,-3932.19 20101.26,-3938.29 20089,-3925.83 20084.32,-3921.08 20084.32,-3915.58 20089,-3910.83 20101.28,-3898.4 20701.28,-3907.9 20718,-3902.83 20737.65,-3896.88 20757.09,-3885.99 20773.75,-3874.68"/>
<polygon fill="black" stroke="black" points="20776.03,-3877.35 20782.2,-3868.74 20772.01,-3871.63 20776.03,-3877.35"/>
</g>
<!-- l3_attn_stage14_gpu[next_gpu] -->
<g id="node1388" class="node">
<title>l3_attn_stage14_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="21097" cy="-3834.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="21097" y="-3830.63" font-family="Times,serif" font-size="14.00">l3_attn_stage14_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage13_gpu0&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge2913" class="edge">
<title>l3_attn_stage13_gpu0&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20881.56,-3951.91C20897.88,-3945.4 20915.81,-3939.35 20933,-3935.83 20957.12,-3930.9 21358.79,-3943.44 21376,-3925.83 21425.67,-3875.03 21338.33,-3852.72 21248.57,-3842.94"/>
<polygon fill="red" stroke="red" points="21248.78,-3839.44 21238.47,-3841.89 21248.05,-3846.4 21248.78,-3839.44"/>
<text text-anchor="middle" x="21415.5" y="-3914.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu1 -->
<g id="node898" class="node">
<title>l3_attn_stage14_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="19366" cy="-3834.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19366" y="-3845.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="19366" y="-3830.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="19366" y="-3815.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu1&#45;&gt;l3_attn_stage14_gpu1 -->
<g id="edge1314" class="edge">
<title>l3_attn_stage13_gpu1&#45;&gt;l3_attn_stage14_gpu1</title>
<path fill="none" stroke="black" d="M19366,-3943.74C19366,-3925.02 19366,-3902.03 19366,-3882.05"/>
<polygon fill="black" stroke="black" points="19369.5,-3881.91 19366,-3871.91 19362.5,-3881.91 19369.5,-3881.91"/>
</g>
<!-- l3_attn_stage13_gpu1&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge2914" class="edge">
<title>l3_attn_stage13_gpu1&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19422.98,-3951.17C19437.9,-3944.88 19454.24,-3939.13 19470,-3935.83 19540.91,-3921.01 20705.65,-3949.85 20774,-3925.83 20784.15,-3922.27 20782.94,-3914.66 20793,-3910.83 20821.3,-3900.07 20899.46,-3909.45 20929,-3902.83 20973.67,-3892.83 21021.88,-3872.36 21055.15,-3856.58"/>
<polygon fill="red" stroke="red" points="21057.06,-3859.54 21064.55,-3852.05 21054.02,-3853.23 21057.06,-3859.54"/>
<text text-anchor="middle" x="20824.5" y="-3914.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu2 -->
<g id="node899" class="node">
<title>l3_attn_stage14_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="20614" cy="-3834.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20614" y="-3845.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="20614" y="-3830.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="20614" y="-3815.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu2&#45;&gt;l3_attn_stage14_gpu2 -->
<g id="edge1315" class="edge">
<title>l3_attn_stage13_gpu2&#45;&gt;l3_attn_stage14_gpu2</title>
<path fill="none" stroke="black" d="M20556.71,-3951.23C20541.86,-3944.97 20525.64,-3939.23 20510,-3935.83 20486.76,-3930.79 20098.62,-3942.85 20082,-3925.83 20077.34,-3921.06 20077.33,-3915.59 20082,-3910.83 20090.33,-3902.35 20498.63,-3906.31 20510,-3902.83 20529.63,-3896.82 20549.07,-3885.92 20565.73,-3874.61"/>
<polygon fill="black" stroke="black" points="20568.01,-3877.29 20574.18,-3868.68 20563.99,-3871.56 20568.01,-3877.29"/>
</g>
<!-- l3_attn_stage13_gpu2&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge2915" class="edge">
<title>l3_attn_stage13_gpu2&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20671,-3951.28C20685.92,-3944.98 20702.25,-3939.2 20718,-3935.83 20733.54,-3932.51 21278.86,-3937.17 21290,-3925.83 21326.88,-3888.3 21263.24,-3864.54 21199.37,-3850.83"/>
<polygon fill="red" stroke="red" points="21200.05,-3847.4 21189.55,-3848.8 21198.63,-3854.25 21200.05,-3847.4"/>
<text text-anchor="middle" x="21329.5" y="-3914.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu3 -->
<g id="node900" class="node">
<title>l3_attn_stage14_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="19990" cy="-3834.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19990" y="-3845.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="19990" y="-3830.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="19990" y="-3815.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu3&#45;&gt;l3_attn_stage14_gpu3 -->
<g id="edge1316" class="edge">
<title>l3_attn_stage13_gpu3&#45;&gt;l3_attn_stage14_gpu3</title>
<path fill="none" stroke="black" d="M19990,-3943.74C19990,-3925.02 19990,-3902.03 19990,-3882.05"/>
<polygon fill="black" stroke="black" points="19993.5,-3881.91 19990,-3871.91 19986.5,-3881.91 19993.5,-3881.91"/>
</g>
<!-- l3_attn_stage13_gpu3&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge2916" class="edge">
<title>l3_attn_stage13_gpu3&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20046.98,-3951.2C20061.91,-3944.91 20078.24,-3939.15 20094,-3935.83 20119.5,-3930.46 21008.88,-3937.85 21032,-3925.83 21045.7,-3918.71 21067.58,-3885.29 21082.12,-3861.13"/>
<polygon fill="red" stroke="red" points="21085.21,-3862.79 21087.3,-3852.4 21079.19,-3859.22 21085.21,-3862.79"/>
<text text-anchor="middle" x="21078.5" y="-3914.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu4 -->
<g id="node901" class="node">
<title>l3_attn_stage14_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="18118" cy="-3834.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18118" y="-3845.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="18118" y="-3830.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="18118" y="-3815.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu4&#45;&gt;l3_attn_stage14_gpu4 -->
<g id="edge1317" class="edge">
<title>l3_attn_stage13_gpu4&#45;&gt;l3_attn_stage14_gpu4</title>
<path fill="none" stroke="black" d="M18118,-3943.74C18118,-3925.02 18118,-3902.03 18118,-3882.05"/>
<polygon fill="black" stroke="black" points="18121.5,-3881.91 18118,-3871.91 18114.5,-3881.91 18121.5,-3881.91"/>
</g>
<!-- l3_attn_stage13_gpu4&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge2917" class="edge">
<title>l3_attn_stage13_gpu4&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18174.97,-3951.14C18189.89,-3944.85 18206.23,-3939.1 18222,-3935.83 18277.38,-3924.34 20204.62,-3944.51 20258,-3925.83 20268.16,-3922.28 20266.86,-3914.42 20277,-3910.83 20311.15,-3898.74 20893.48,-3909.93 20929,-3902.83 20974.31,-3893.78 21022.97,-3872.87 21056.2,-3856.7"/>
<polygon fill="red" stroke="red" points="21058.16,-3859.64 21065.57,-3852.07 21055.06,-3853.37 21058.16,-3859.64"/>
<text text-anchor="middle" x="20308.5" y="-3914.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu5 -->
<g id="node902" class="node">
<title>l3_attn_stage14_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="18950" cy="-3834.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18950" y="-3845.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="18950" y="-3830.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="18950" y="-3815.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu5&#45;&gt;l3_attn_stage14_gpu5 -->
<g id="edge1318" class="edge">
<title>l3_attn_stage13_gpu5&#45;&gt;l3_attn_stage14_gpu5</title>
<path fill="none" stroke="black" d="M18950,-3943.74C18950,-3925.02 18950,-3902.03 18950,-3882.05"/>
<polygon fill="black" stroke="black" points="18953.5,-3881.91 18950,-3871.91 18946.5,-3881.91 18953.5,-3881.91"/>
</g>
<!-- l3_attn_stage13_gpu5&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge2918" class="edge">
<title>l3_attn_stage13_gpu5&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19006.97,-3951.16C19021.9,-3944.86 19038.23,-3939.12 19054,-3935.83 19096.1,-3927.06 20561.42,-3940.07 20602,-3925.83 20612.15,-3922.27 20610.88,-3914.49 20621,-3910.83 20653.19,-3899.19 20895.48,-3909.77 20929,-3902.83 20974.11,-3893.5 21022.62,-3872.74 21055.86,-3856.68"/>
<polygon fill="red" stroke="red" points="21057.8,-3859.63 21065.24,-3852.08 21054.72,-3853.35 21057.8,-3859.63"/>
<text text-anchor="middle" x="20652.5" y="-3914.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu6 -->
<g id="node903" class="node">
<title>l3_attn_stage14_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="19782" cy="-3834.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19782" y="-3845.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="19782" y="-3830.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="19782" y="-3815.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu6&#45;&gt;l3_attn_stage14_gpu6 -->
<g id="edge1319" class="edge">
<title>l3_attn_stage13_gpu6&#45;&gt;l3_attn_stage14_gpu6</title>
<path fill="none" stroke="black" d="M19782,-3943.74C19782,-3925.02 19782,-3902.03 19782,-3882.05"/>
<polygon fill="black" stroke="black" points="19785.5,-3881.91 19782,-3871.91 19778.5,-3881.91 19785.5,-3881.91"/>
</g>
<!-- l3_attn_stage13_gpu6&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge2919" class="edge">
<title>l3_attn_stage13_gpu6&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19838.98,-3951.19C19853.91,-3944.89 19870.24,-3939.14 19886,-3935.83 19943.64,-3923.74 20890.46,-3945.41 20946,-3925.83 20956.15,-3922.26 20956.08,-3916.85 20965,-3910.83 20994.36,-3891.01 21029.2,-3871.22 21055.72,-3856.88"/>
<polygon fill="red" stroke="red" points="21057.57,-3859.86 21064.73,-3852.05 21054.26,-3853.69 21057.57,-3859.86"/>
<text text-anchor="middle" x="20996.5" y="-3914.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu7 -->
<g id="node904" class="node">
<title>l3_attn_stage14_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="18326" cy="-3834.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18326" y="-3845.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="18326" y="-3830.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="18326" y="-3815.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu7&#45;&gt;l3_attn_stage14_gpu7 -->
<g id="edge1320" class="edge">
<title>l3_attn_stage13_gpu7&#45;&gt;l3_attn_stage14_gpu7</title>
<path fill="none" stroke="black" d="M18326,-3943.74C18326,-3925.02 18326,-3902.03 18326,-3882.05"/>
<polygon fill="black" stroke="black" points="18329.5,-3881.91 18326,-3871.91 18322.5,-3881.91 18329.5,-3881.91"/>
</g>
<!-- l3_attn_stage13_gpu7&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge2920" class="edge">
<title>l3_attn_stage13_gpu7&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18382.97,-3951.14C18397.9,-3944.85 18414.23,-3939.11 18430,-3935.83 18482.06,-3925.02 20293.82,-3943.4 20344,-3925.83 20354.15,-3922.28 20352.86,-3914.43 20363,-3910.83 20392.63,-3900.31 20898.17,-3909.02 20929,-3902.83 20974.3,-3893.74 21022.97,-3872.84 21056.2,-3856.68"/>
<polygon fill="red" stroke="red" points="21058.15,-3859.62 21065.57,-3852.05 21055.05,-3853.34 21058.15,-3859.62"/>
<text text-anchor="middle" x="20394.5" y="-3914.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu8 -->
<g id="node905" class="node">
<title>l3_attn_stage14_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="20198" cy="-3834.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20198" y="-3845.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="20198" y="-3830.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="20198" y="-3815.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu8&#45;&gt;l3_attn_stage14_gpu8 -->
<g id="edge1321" class="edge">
<title>l3_attn_stage13_gpu8&#45;&gt;l3_attn_stage14_gpu8</title>
<path fill="none" stroke="black" d="M20135.19,-3953.01C20121.64,-3947.24 20107.37,-3941.26 20094,-3935.83 20082.53,-3931.17 20075.01,-3936.04 20068,-3925.83 20064.23,-3920.34 20064.04,-3916.2 20068,-3910.83 20075.18,-3901.11 20083.05,-3907.95 20094,-3902.83 20111.44,-3894.68 20129.39,-3883.99 20145.36,-3873.52"/>
<polygon fill="black" stroke="black" points="20147.64,-3876.21 20154.02,-3867.75 20143.76,-3870.39 20147.64,-3876.21"/>
</g>
<!-- l3_attn_stage13_gpu8&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge2921" class="edge">
<title>l3_attn_stage13_gpu8&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20254.99,-3951.22C20269.91,-3944.93 20286.24,-3939.16 20302,-3935.83 20324.18,-3931.15 21102.07,-3941.96 21118,-3925.83 21134.71,-3908.92 21125.21,-3881.47 21114.15,-3861.23"/>
<polygon fill="red" stroke="red" points="21117.11,-3859.37 21109.04,-3852.51 21111.07,-3862.9 21117.11,-3859.37"/>
<text text-anchor="middle" x="21156.5" y="-3914.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu9 -->
<g id="node906" class="node">
<title>l3_attn_stage14_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="19574" cy="-3834.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19574" y="-3845.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="19574" y="-3830.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="19574" y="-3815.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu9&#45;&gt;l3_attn_stage14_gpu9 -->
<g id="edge1322" class="edge">
<title>l3_attn_stage13_gpu9&#45;&gt;l3_attn_stage14_gpu9</title>
<path fill="none" stroke="black" d="M19574,-3943.74C19574,-3925.02 19574,-3902.03 19574,-3882.05"/>
<polygon fill="black" stroke="black" points="19577.5,-3881.91 19574,-3871.91 19570.5,-3881.91 19577.5,-3881.91"/>
</g>
<!-- l3_attn_stage13_gpu9&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge2922" class="edge">
<title>l3_attn_stage13_gpu9&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19630.98,-3951.18C19645.9,-3944.88 19662.24,-3939.13 19678,-3935.83 19742.28,-3922.38 20798.05,-3947.63 20860,-3925.83 20870.15,-3922.26 20869.15,-3915.16 20879,-3910.83 20899.61,-3901.79 20907.31,-3908.84 20929,-3902.83 20972.28,-3890.84 21019.59,-3871.2 21052.94,-3856.19"/>
<polygon fill="red" stroke="red" points="21054.74,-3859.22 21062.4,-3851.9 21051.84,-3852.85 21054.74,-3859.22"/>
<text text-anchor="middle" x="20910.5" y="-3914.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu10 -->
<g id="node907" class="node">
<title>l3_attn_stage14_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="17702" cy="-3834.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="17702" y="-3845.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="17702" y="-3830.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="17702" y="-3815.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu10&#45;&gt;l3_attn_stage14_gpu10 -->
<g id="edge1323" class="edge">
<title>l3_attn_stage13_gpu10&#45;&gt;l3_attn_stage14_gpu10</title>
<path fill="none" stroke="black" d="M17702,-3943.74C17702,-3925.02 17702,-3902.03 17702,-3882.05"/>
<polygon fill="black" stroke="black" points="17705.5,-3881.91 17702,-3871.91 17698.5,-3881.91 17705.5,-3881.91"/>
</g>
<!-- l3_attn_stage13_gpu10&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge2923" class="edge">
<title>l3_attn_stage13_gpu10&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17758.98,-3951.2C17773.91,-3944.91 17790.24,-3939.15 17806,-3935.83 18055.97,-3883.18 19849.55,-3913.46 20105,-3910.83 20150.78,-3910.36 20884.1,-3911.74 20929,-3902.83 20974.32,-3893.84 21022.98,-3872.92 21056.21,-3856.74"/>
<polygon fill="red" stroke="red" points="21058.17,-3859.67 21065.58,-3852.1 21055.06,-3853.4 21058.17,-3859.67"/>
<text text-anchor="middle" x="20136.5" y="-3914.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu11 -->
<g id="node908" class="node">
<title>l3_attn_stage14_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="18534" cy="-3834.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18534" y="-3845.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="18534" y="-3830.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="18534" y="-3815.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu11&#45;&gt;l3_attn_stage14_gpu11 -->
<g id="edge1324" class="edge">
<title>l3_attn_stage13_gpu11&#45;&gt;l3_attn_stage14_gpu11</title>
<path fill="none" stroke="black" d="M18534,-3943.74C18534,-3925.02 18534,-3902.03 18534,-3882.05"/>
<polygon fill="black" stroke="black" points="18537.5,-3881.91 18534,-3871.91 18530.5,-3881.91 18537.5,-3881.91"/>
</g>
<!-- l3_attn_stage13_gpu11&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge2924" class="edge">
<title>l3_attn_stage13_gpu11&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18590.97,-3951.15C18605.9,-3944.85 18622.23,-3939.11 18638,-3935.83 18686.74,-3925.7 20383.02,-3942.29 20430,-3925.83 20440.15,-3922.28 20438.87,-3914.45 20449,-3910.83 20499.24,-3892.92 20876.72,-3913.4 20929,-3902.83 20974.29,-3893.68 21022.96,-3872.79 21056.19,-3856.65"/>
<polygon fill="red" stroke="red" points="21058.14,-3859.59 21065.56,-3852.03 21055.05,-3853.31 21058.14,-3859.59"/>
<text text-anchor="middle" x="20480.5" y="-3914.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu12 -->
<g id="node909" class="node">
<title>l3_attn_stage14_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="17910" cy="-3834.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="17910" y="-3845.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="17910" y="-3830.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="17910" y="-3815.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu12&#45;&gt;l3_attn_stage14_gpu12 -->
<g id="edge1325" class="edge">
<title>l3_attn_stage13_gpu12&#45;&gt;l3_attn_stage14_gpu12</title>
<path fill="none" stroke="black" d="M17910,-3943.74C17910,-3925.02 17910,-3902.03 17910,-3882.05"/>
<polygon fill="black" stroke="black" points="17913.5,-3881.91 17910,-3871.91 17906.5,-3881.91 17913.5,-3881.91"/>
</g>
<!-- l3_attn_stage13_gpu12&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge2925" class="edge">
<title>l3_attn_stage13_gpu12&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17966.97,-3951.14C17981.89,-3944.84 17998.23,-3939.1 18014,-3935.83 18072.7,-3923.66 20115.42,-3945.62 20172,-3925.83 20182.16,-3922.28 20180.86,-3914.42 20191,-3910.83 20229.66,-3897.18 20888.79,-3910.84 20929,-3902.83 20974.31,-3893.81 21022.98,-3872.9 21056.21,-3856.72"/>
<polygon fill="red" stroke="red" points="21058.17,-3859.66 21065.58,-3852.09 21055.06,-3853.38 21058.17,-3859.66"/>
<text text-anchor="middle" x="20222.5" y="-3914.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu13 -->
<g id="node910" class="node">
<title>l3_attn_stage14_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="18742" cy="-3834.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="18742" y="-3845.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="18742" y="-3830.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="18742" y="-3815.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu13&#45;&gt;l3_attn_stage14_gpu13 -->
<g id="edge1326" class="edge">
<title>l3_attn_stage13_gpu13&#45;&gt;l3_attn_stage14_gpu13</title>
<path fill="none" stroke="black" d="M18742,-3943.74C18742,-3925.02 18742,-3902.03 18742,-3882.05"/>
<polygon fill="black" stroke="black" points="18745.5,-3881.91 18742,-3871.91 18738.5,-3881.91 18745.5,-3881.91"/>
</g>
<!-- l3_attn_stage13_gpu13&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge2926" class="edge">
<title>l3_attn_stage13_gpu13&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18798.97,-3951.15C18813.9,-3944.86 18830.23,-3939.11 18846,-3935.83 18891.42,-3926.38 20472.22,-3941.18 20516,-3925.83 20526.15,-3922.27 20524.87,-3914.46 20535,-3910.83 20576.22,-3896.05 20886.1,-3911.58 20929,-3902.83 20974.27,-3893.6 21022.94,-3872.72 21056.18,-3856.6"/>
<polygon fill="red" stroke="red" points="21058.13,-3859.55 21065.56,-3851.99 21055.04,-3853.27 21058.13,-3859.55"/>
<text text-anchor="middle" x="20566.5" y="-3914.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu14 -->
<g id="node911" class="node">
<title>l3_attn_stage14_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="19158" cy="-3834.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="19158" y="-3845.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="19158" y="-3830.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="19158" y="-3815.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu14&#45;&gt;l3_attn_stage14_gpu14 -->
<g id="edge1327" class="edge">
<title>l3_attn_stage13_gpu14&#45;&gt;l3_attn_stage14_gpu14</title>
<path fill="none" stroke="black" d="M19158,-3943.74C19158,-3925.02 19158,-3902.03 19158,-3882.05"/>
<polygon fill="black" stroke="black" points="19161.5,-3881.91 19158,-3871.91 19154.5,-3881.91 19161.5,-3881.91"/>
</g>
<!-- l3_attn_stage13_gpu14&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge2927" class="edge">
<title>l3_attn_stage13_gpu14&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19214.98,-3951.16C19229.9,-3944.87 19246.24,-3939.12 19262,-3935.83 19300.78,-3927.74 20650.62,-3938.95 20688,-3925.83 20698.15,-3922.27 20696.9,-3914.54 20707,-3910.83 20753.34,-3893.81 20880.71,-3913.08 20929,-3902.83 20974.06,-3893.27 21022.58,-3872.54 21055.83,-3856.56"/>
<polygon fill="red" stroke="red" points="21057.76,-3859.51 21065.22,-3851.98 21054.69,-3853.22 21057.76,-3859.51"/>
<text text-anchor="middle" x="20738.5" y="-3914.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu15 -->
<g id="node912" class="node">
<title>l3_attn_stage14_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="20406" cy="-3834.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="20406" y="-3845.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="20406" y="-3830.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="20406" y="-3815.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu15&#45;&gt;l3_attn_stage14_gpu15 -->
<g id="edge1328" class="edge">
<title>l3_attn_stage13_gpu15&#45;&gt;l3_attn_stage14_gpu15</title>
<path fill="none" stroke="black" d="M20348.39,-3951.34C20333.62,-3945.12 20317.51,-3939.37 20302,-3935.83 20277.39,-3930.22 20092.45,-3944.07 20075,-3925.83 20070.39,-3921.02 20070.37,-3915.63 20075,-3910.83 20083.76,-3901.75 20289.97,-3906.63 20302,-3902.83 20321.58,-3896.66 20341,-3885.72 20357.67,-3874.41"/>
<polygon fill="black" stroke="black" points="20359.94,-3877.1 20366.13,-3868.5 20355.93,-3871.37 20359.94,-3877.1"/>
</g>
<!-- l3_attn_stage13_gpu15&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge2928" class="edge">
<title>l3_attn_stage13_gpu15&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20462.99,-3951.24C20477.92,-3944.95 20494.25,-3939.18 20510,-3935.83 20528.86,-3931.83 21190.47,-3939.56 21204,-3925.83 21229.62,-3899.85 21188.49,-3873.25 21150.04,-3855.67"/>
<polygon fill="red" stroke="red" points="21151.44,-3852.46 21140.88,-3851.62 21148.61,-3858.87 21151.44,-3852.46"/>
<text text-anchor="middle" x="21242.5" y="-3914.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu0 -->
<g id="node913" class="node">
<title>l3_attn_stage15_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="17758" cy="-3687.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="17758" y="-3698.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="17758" y="-3683.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="17758" y="-3668.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu0&#45;&gt;l3_attn_stage15_gpu0 -->
<g id="edge1329" class="edge">
<title>l3_attn_stage14_gpu0&#45;&gt;l3_attn_stage15_gpu0</title>
<path fill="none" stroke="black" d="M20765.3,-3804.24C20750.31,-3797.9 20733.87,-3792.11 20718,-3788.83 20678.75,-3780.72 17868.19,-3796.07 17832,-3778.83 17811.53,-3769.08 17794.83,-3750.61 17782.51,-3732.88"/>
<polygon fill="black" stroke="black" points="17785.26,-3730.69 17776.82,-3724.28 17779.42,-3734.55 17785.26,-3730.69"/>
</g>
<!-- l3_attn_stage15_gpu[next_gpu] -->
<g id="node1389" class="node">
<title>l3_attn_stage15_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="21097" cy="-3687.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="21097" y="-3683.63" font-family="Times,serif" font-size="14.00">l3_attn_stage15_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage14_gpu0&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge2929" class="edge">
<title>l3_attn_stage14_gpu0&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20877.98,-3803.81C20930.84,-3775.95 21008.84,-3734.82 21056.09,-3709.9"/>
<polygon fill="red" stroke="red" points="21057.91,-3712.9 21065.12,-3705.14 21054.64,-3706.71 21057.91,-3712.9"/>
<text text-anchor="middle" x="20982.5" y="-3767.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu1 -->
<g id="node914" class="node">
<title>l3_attn_stage15_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="16302" cy="-3687.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="16302" y="-3698.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="16302" y="-3683.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="16302" y="-3668.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu1&#45;&gt;l3_attn_stage15_gpu1 -->
<g id="edge1330" class="edge">
<title>l3_attn_stage14_gpu1&#45;&gt;l3_attn_stage15_gpu1</title>
<path fill="none" stroke="black" d="M19309.3,-3804.24C19294.31,-3797.9 19277.87,-3792.12 19262,-3788.83 19189.72,-3773.88 16678.68,-3783.22 16605,-3778.83 16516.12,-3773.55 16489.78,-3785.98 16406,-3755.83 16387.03,-3749.01 16368.02,-3738.14 16351.53,-3727.1"/>
<polygon fill="black" stroke="black" points="16353.38,-3724.12 16343.16,-3721.33 16349.41,-3729.89 16353.38,-3724.12"/>
</g>
<!-- l3_attn_stage14_gpu1&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge2930" class="edge">
<title>l3_attn_stage14_gpu1&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19424.96,-3804.87C19439.42,-3798.8 19455.05,-3792.98 19470,-3788.83 19548.68,-3767.02 19570.71,-3771.53 19652,-3763.83 20117.29,-3719.8 20669.47,-3699.89 20936.5,-3692.3"/>
<polygon fill="red" stroke="red" points="20936.76,-3695.79 20946.66,-3692.01 20936.56,-3688.8 20936.76,-3695.79"/>
<text text-anchor="middle" x="19683.5" y="-3767.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu2 -->
<g id="node915" class="node">
<title>l3_attn_stage15_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="17550" cy="-3687.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="17550" y="-3698.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="17550" y="-3683.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="17550" y="-3668.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu2&#45;&gt;l3_attn_stage15_gpu2 -->
<g id="edge1331" class="edge">
<title>l3_attn_stage14_gpu2&#45;&gt;l3_attn_stage15_gpu2</title>
<path fill="none" stroke="black" d="M20557.3,-3804.24C20542.31,-3797.9 20525.87,-3792.12 20510,-3788.83 20436.5,-3773.63 17882.84,-3784.53 17808,-3778.83 17739,-3773.58 17718.72,-3780.34 17654,-3755.83 17635.31,-3748.76 17616.51,-3737.94 17600.12,-3727.02"/>
<polygon fill="black" stroke="black" points="17602.02,-3724.08 17591.79,-3721.32 17598.07,-3729.86 17602.02,-3724.08"/>
</g>
<!-- l3_attn_stage14_gpu2&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge2931" class="edge">
<title>l3_attn_stage14_gpu2&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20675.01,-3805.48C20688.99,-3799.59 20703.89,-3793.69 20718,-3788.83 20819.63,-3753.82 20940.09,-3723.76 21017.48,-3705.87"/>
<polygon fill="red" stroke="red" points="21018.67,-3709.19 21027.63,-3703.53 21017.1,-3702.36 21018.67,-3709.19"/>
<text text-anchor="middle" x="20820.5" y="-3767.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu3 -->
<g id="node916" class="node">
<title>l3_attn_stage15_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="16926" cy="-3687.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="16926" y="-3698.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="16926" y="-3683.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="16926" y="-3668.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu3&#45;&gt;l3_attn_stage15_gpu3 -->
<g id="edge1332" class="edge">
<title>l3_attn_stage14_gpu3&#45;&gt;l3_attn_stage15_gpu3</title>
<path fill="none" stroke="black" d="M19933.03,-3804.13C19918.11,-3797.83 19901.77,-3792.1 19886,-3788.83 19815.09,-3774.16 17351.33,-3782.31 17279,-3778.83 17167.99,-3773.5 17135,-3792.26 17030,-3755.83 17010.95,-3749.22 16991.92,-3738.41 16975.44,-3727.36"/>
<polygon fill="black" stroke="black" points="16977.29,-3724.39 16967.07,-3721.58 16973.31,-3730.15 16977.29,-3724.39"/>
</g>
<!-- l3_attn_stage14_gpu3&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge2932" class="edge">
<title>l3_attn_stage14_gpu3&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20048.96,-3804.87C20063.42,-3798.8 20079.05,-3792.98 20094,-3788.83 20172.68,-3767.02 20194.88,-3773.13 20276,-3763.83 20517.14,-3736.2 20799.05,-3712.05 20961.92,-3698.89"/>
<polygon fill="red" stroke="red" points="20962.3,-3702.37 20971.99,-3698.08 20961.74,-3695.39 20962.3,-3702.37"/>
<text text-anchor="middle" x="20307.5" y="-3767.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu4 -->
<g id="node917" class="node">
<title>l3_attn_stage15_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="15054" cy="-3687.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="15054" y="-3698.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="15054" y="-3683.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="15054" y="-3668.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu4&#45;&gt;l3_attn_stage15_gpu4 -->
<g id="edge1333" class="edge">
<title>l3_attn_stage14_gpu4&#45;&gt;l3_attn_stage15_gpu4</title>
<path fill="none" stroke="black" d="M18061.03,-3804.13C18046.11,-3797.84 18029.77,-3792.1 18014,-3788.83 17943.77,-3774.3 15503.65,-3781.97 15432,-3778.83 15309.91,-3773.48 15273.62,-3795.4 15158,-3755.83 15138.75,-3749.24 15119.54,-3738.32 15102.96,-3727.16"/>
<polygon fill="black" stroke="black" points="15104.75,-3724.14 15094.54,-3721.32 15100.76,-3729.9 15104.75,-3724.14"/>
</g>
<!-- l3_attn_stage14_gpu4&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge2933" class="edge">
<title>l3_attn_stage14_gpu4&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18176.96,-3804.87C18191.42,-3798.79 18207.05,-3792.97 18222,-3788.83 18301.11,-3766.93 18323.19,-3770.55 18405,-3763.83 18900.19,-3723.18 20428.66,-3697.99 20933.38,-3690.61"/>
<polygon fill="red" stroke="red" points="20933.71,-3694.1 20943.66,-3690.46 20933.61,-3687.1 20933.71,-3694.1"/>
<text text-anchor="middle" x="18436.5" y="-3767.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu5 -->
<g id="node918" class="node">
<title>l3_attn_stage15_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="15886" cy="-3687.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="15886" y="-3698.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="15886" y="-3683.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15886" y="-3668.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu5&#45;&gt;l3_attn_stage15_gpu5 -->
<g id="edge1334" class="edge">
<title>l3_attn_stage14_gpu5&#45;&gt;l3_attn_stage15_gpu5</title>
<path fill="none" stroke="black" d="M18893.03,-3804.13C18878.11,-3797.84 18861.77,-3792.1 18846,-3788.83 18777.83,-3774.72 16409.57,-3781.25 16340,-3778.83 16184.2,-3773.41 16137.94,-3804.97 15990,-3755.83 15970.69,-3749.42 15951.46,-3738.54 15934.89,-3727.37"/>
<polygon fill="black" stroke="black" points="15936.68,-3724.35 15926.47,-3721.52 15932.69,-3730.1 15936.68,-3724.35"/>
</g>
<!-- l3_attn_stage14_gpu5&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge2934" class="edge">
<title>l3_attn_stage14_gpu5&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19008.96,-3804.87C19023.42,-3798.79 19039.05,-3792.97 19054,-3788.83 19133.11,-3766.93 19155.23,-3771.06 19237,-3763.83 19861.4,-3708.64 20607.34,-3693.74 20932.23,-3689.76"/>
<polygon fill="red" stroke="red" points="20932.71,-3693.26 20942.66,-3689.63 20932.62,-3686.26 20932.71,-3693.26"/>
<text text-anchor="middle" x="19268.5" y="-3767.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu6 -->
<g id="node919" class="node">
<title>l3_attn_stage15_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="16718" cy="-3687.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="16718" y="-3698.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="16718" y="-3683.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="16718" y="-3668.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu6&#45;&gt;l3_attn_stage15_gpu6 -->
<g id="edge1335" class="edge">
<title>l3_attn_stage14_gpu6&#45;&gt;l3_attn_stage15_gpu6</title>
<path fill="none" stroke="black" d="M19725.3,-3804.24C19710.31,-3797.9 19693.87,-3792.12 19678,-3788.83 19606.68,-3774.07 17128.74,-3782.54 17056,-3778.83 16951.63,-3773.52 16920.63,-3790.37 16822,-3755.83 16802.97,-3749.17 16783.94,-3738.34 16767.46,-3727.3"/>
<polygon fill="black" stroke="black" points="16769.31,-3724.32 16759.09,-3721.52 16765.33,-3730.08 16769.31,-3724.32"/>
</g>
<!-- l3_attn_stage14_gpu6&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge2935" class="edge">
<title>l3_attn_stage14_gpu6&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19840.96,-3804.87C19855.42,-3798.8 19871.05,-3792.98 19886,-3788.83 19964.68,-3767.02 19986.8,-3772.38 20068,-3763.83 20380.92,-3730.89 20748.89,-3707.61 20949.03,-3696.24"/>
<polygon fill="red" stroke="red" points="20949.24,-3699.73 20959.02,-3695.68 20948.84,-3692.75 20949.24,-3699.73"/>
<text text-anchor="middle" x="20099.5" y="-3767.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu7 -->
<g id="node920" class="node">
<title>l3_attn_stage15_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="15262" cy="-3687.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="15262" y="-3698.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="15262" y="-3683.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15262" y="-3668.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu7&#45;&gt;l3_attn_stage15_gpu7 -->
<g id="edge1336" class="edge">
<title>l3_attn_stage14_gpu7&#45;&gt;l3_attn_stage15_gpu7</title>
<path fill="none" stroke="black" d="M18269.03,-3804.13C18254.11,-3797.83 18237.77,-3792.1 18222,-3788.83 18151.09,-3774.16 15687.33,-3782.31 15615,-3778.83 15503.99,-3773.5 15471,-3792.26 15366,-3755.83 15346.95,-3749.22 15327.92,-3738.41 15311.44,-3727.36"/>
<polygon fill="black" stroke="black" points="15313.29,-3724.39 15303.07,-3721.58 15309.31,-3730.15 15313.29,-3724.39"/>
</g>
<!-- l3_attn_stage14_gpu7&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge2936" class="edge">
<title>l3_attn_stage14_gpu7&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18384.96,-3804.87C18399.42,-3798.79 18415.05,-3792.97 18430,-3788.83 18509.11,-3766.93 18531.19,-3770.64 18613,-3763.83 19066.07,-3726.11 20456.61,-3699.33 20934.06,-3691.04"/>
<polygon fill="red" stroke="red" points="20934.19,-3694.54 20944.13,-3690.86 20934.07,-3687.54 20934.19,-3694.54"/>
<text text-anchor="middle" x="18644.5" y="-3767.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu8 -->
<g id="node921" class="node">
<title>l3_attn_stage15_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="17134" cy="-3687.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="17134" y="-3698.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="17134" y="-3683.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="17134" y="-3668.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu8&#45;&gt;l3_attn_stage15_gpu8 -->
<g id="edge1337" class="edge">
<title>l3_attn_stage14_gpu8&#45;&gt;l3_attn_stage15_gpu8</title>
<path fill="none" stroke="black" d="M20141.3,-3804.24C20126.31,-3797.9 20109.87,-3792.12 20094,-3788.83 20021.72,-3773.88 17510.68,-3783.22 17437,-3778.83 17348.12,-3773.55 17321.78,-3785.98 17238,-3755.83 17219.03,-3749.01 17200.02,-3738.14 17183.53,-3727.1"/>
<polygon fill="black" stroke="black" points="17185.38,-3724.12 17175.16,-3721.33 17181.41,-3729.89 17185.38,-3724.12"/>
</g>
<!-- l3_attn_stage14_gpu8&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge2937" class="edge">
<title>l3_attn_stage14_gpu8&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20256.95,-3804.84C20271.41,-3798.76 20287.04,-3792.95 20302,-3788.83 20519.76,-3728.89 20781.06,-3704.56 20943.1,-3694.78"/>
<polygon fill="red" stroke="red" points="20943.37,-3698.27 20953.14,-3694.18 20942.95,-3691.28 20943.37,-3698.27"/>
<text text-anchor="middle" x="20417.5" y="-3767.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu9 -->
<g id="node922" class="node">
<title>l3_attn_stage15_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="16510" cy="-3687.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="16510" y="-3698.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="16510" y="-3683.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="16510" y="-3668.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu9&#45;&gt;l3_attn_stage15_gpu9 -->
<g id="edge1338" class="edge">
<title>l3_attn_stage14_gpu9&#45;&gt;l3_attn_stage15_gpu9</title>
<path fill="none" stroke="black" d="M19517.3,-3804.24C19502.31,-3797.9 19485.87,-3792.12 19470,-3788.83 19398.62,-3774.06 16918.79,-3782.57 16846,-3778.83 16742.52,-3773.52 16711.78,-3790.12 16614,-3755.83 16594.97,-3749.16 16575.95,-3738.33 16559.47,-3727.29"/>
<polygon fill="black" stroke="black" points="16561.31,-3724.31 16551.09,-3721.51 16557.34,-3730.07 16561.31,-3724.31"/>
</g>
<!-- l3_attn_stage14_gpu9&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge2938" class="edge">
<title>l3_attn_stage14_gpu9&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19632.96,-3804.87C19647.42,-3798.8 19663.05,-3792.98 19678,-3788.83 19756.68,-3767.02 19778.75,-3771.88 19860,-3763.83 20247.66,-3725.43 20705.74,-3703.58 20940.71,-3694.08"/>
<polygon fill="red" stroke="red" points="20941.19,-3697.57 20951.04,-3693.67 20940.91,-3690.57 20941.19,-3697.57"/>
<text text-anchor="middle" x="19891.5" y="-3767.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu10 -->
<g id="node923" class="node">
<title>l3_attn_stage15_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="14638" cy="-3687.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14638" y="-3698.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="14638" y="-3683.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="14638" y="-3668.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu10&#45;&gt;l3_attn_stage15_gpu10 -->
<g id="edge1339" class="edge">
<title>l3_attn_stage14_gpu10&#45;&gt;l3_attn_stage15_gpu10</title>
<path fill="none" stroke="black" d="M17607.08,-3832.62C17269.71,-3829.82 16097.01,-3817.73 15130,-3778.83 14957.39,-3771.89 14906.12,-3809.76 14742,-3755.83 14722.67,-3749.48 14703.44,-3738.62 14686.86,-3727.44"/>
<polygon fill="black" stroke="black" points="14688.66,-3724.43 14678.45,-3721.59 14684.66,-3730.17 14688.66,-3724.43"/>
</g>
<!-- l3_attn_stage14_gpu10&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge2939" class="edge">
<title>l3_attn_stage14_gpu10&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17760.96,-3804.87C17775.42,-3798.79 17791.05,-3792.97 17806,-3788.83 17885.11,-3766.93 17907.17,-3770.4 17989,-3763.83 18569.02,-3717.31 20376.72,-3695.6 20932.66,-3689.9"/>
<polygon fill="red" stroke="red" points="20932.79,-3693.4 20942.75,-3689.8 20932.72,-3686.4 20932.79,-3693.4"/>
<text text-anchor="middle" x="18020.5" y="-3767.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu11 -->
<g id="node924" class="node">
<title>l3_attn_stage15_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="15470" cy="-3687.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="15470" y="-3698.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="15470" y="-3683.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="15470" y="-3668.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu11&#45;&gt;l3_attn_stage15_gpu11 -->
<g id="edge1340" class="edge">
<title>l3_attn_stage14_gpu11&#45;&gt;l3_attn_stage15_gpu11</title>
<path fill="none" stroke="black" d="M18477.3,-3804.24C18462.31,-3797.9 18445.87,-3792.12 18430,-3788.83 18357.72,-3773.88 15846.68,-3783.22 15773,-3778.83 15684.12,-3773.55 15657.78,-3785.98 15574,-3755.83 15555.03,-3749.01 15536.02,-3738.14 15519.53,-3727.1"/>
<polygon fill="black" stroke="black" points="15521.38,-3724.12 15511.16,-3721.33 15517.41,-3729.89 15521.38,-3724.12"/>
</g>
<!-- l3_attn_stage14_gpu11&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge2940" class="edge">
<title>l3_attn_stage14_gpu11&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18592.96,-3804.87C18607.42,-3798.79 18623.05,-3792.97 18638,-3788.83 18717.11,-3766.93 18739.2,-3770.76 18821,-3763.83 19609.1,-3697.11 20555.35,-3688.56 20931.31,-3688.01"/>
<polygon fill="red" stroke="red" points="20931.46,-3691.51 20941.45,-3688 20931.45,-3684.51 20931.46,-3691.51"/>
<text text-anchor="middle" x="18852.5" y="-3767.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu12 -->
<g id="node925" class="node">
<title>l3_attn_stage15_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14846" cy="-3687.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14846" y="-3698.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="14846" y="-3683.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14846" y="-3668.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu12&#45;&gt;l3_attn_stage15_gpu12 -->
<g id="edge1341" class="edge">
<title>l3_attn_stage14_gpu12&#45;&gt;l3_attn_stage15_gpu12</title>
<path fill="none" stroke="black" d="M17853.3,-3804.24C17838.31,-3797.9 17821.87,-3792.12 17806,-3788.83 17734.6,-3774.06 15253.82,-3782.59 15181,-3778.83 15077.96,-3773.52 15047.35,-3789.99 14950,-3755.83 14930.97,-3749.16 14911.95,-3738.33 14895.47,-3727.28"/>
<polygon fill="black" stroke="black" points="14897.31,-3724.3 14887.1,-3721.51 14893.34,-3730.06 14897.31,-3724.3"/>
</g>
<!-- l3_attn_stage14_gpu12&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge2941" class="edge">
<title>l3_attn_stage14_gpu12&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M17968.96,-3804.87C17983.42,-3798.79 17999.05,-3792.97 18014,-3788.83 18093.11,-3766.93 18115.18,-3770.47 18197,-3763.83 18734.62,-3720.24 20402.77,-3696.74 20933.26,-3690.23"/>
<polygon fill="red" stroke="red" points="20933.33,-3693.73 20943.28,-3690.11 20933.24,-3686.73 20933.33,-3693.73"/>
<text text-anchor="middle" x="18228.5" y="-3767.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu13 -->
<g id="node926" class="node">
<title>l3_attn_stage15_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="15678" cy="-3687.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="15678" y="-3698.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="15678" y="-3683.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="15678" y="-3668.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu13&#45;&gt;l3_attn_stage15_gpu13 -->
<g id="edge1342" class="edge">
<title>l3_attn_stage14_gpu13&#45;&gt;l3_attn_stage15_gpu13</title>
<path fill="none" stroke="black" d="M18685.03,-3804.13C18670.11,-3797.83 18653.77,-3792.1 18638,-3788.83 18566.79,-3774.1 16092.63,-3782.47 16020,-3778.83 15913.86,-3773.51 15882.33,-3790.87 15782,-3755.83 15762.96,-3749.18 15743.94,-3738.36 15727.46,-3727.31"/>
<polygon fill="black" stroke="black" points="15729.3,-3724.34 15719.08,-3721.54 15725.33,-3730.1 15729.3,-3724.34"/>
</g>
<!-- l3_attn_stage14_gpu13&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge2942" class="edge">
<title>l3_attn_stage14_gpu13&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M18800.96,-3804.87C18815.42,-3798.79 18831.05,-3792.97 18846,-3788.83 18925.11,-3766.93 18947.22,-3770.89 19029,-3763.83 19734.78,-3702.89 20580.19,-3691.04 20931.43,-3688.81"/>
<polygon fill="red" stroke="red" points="20931.7,-3692.31 20941.67,-3688.74 20931.65,-3685.31 20931.7,-3692.31"/>
<text text-anchor="middle" x="19060.5" y="-3767.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu14 -->
<g id="node927" class="node">
<title>l3_attn_stage15_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="16094" cy="-3687.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="16094" y="-3698.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="16094" y="-3683.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="16094" y="-3668.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu14&#45;&gt;l3_attn_stage15_gpu14 -->
<g id="edge1343" class="edge">
<title>l3_attn_stage14_gpu14&#45;&gt;l3_attn_stage15_gpu14</title>
<path fill="none" stroke="black" d="M19101.3,-3804.24C19086.31,-3797.9 19069.87,-3792.12 19054,-3788.83 18982.62,-3774.06 16502.79,-3782.57 16430,-3778.83 16326.52,-3773.52 16295.78,-3790.12 16198,-3755.83 16178.97,-3749.16 16159.95,-3738.33 16143.47,-3727.29"/>
<polygon fill="black" stroke="black" points="16145.31,-3724.31 16135.09,-3721.51 16141.34,-3730.07 16145.31,-3724.31"/>
</g>
<!-- l3_attn_stage14_gpu14&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge2943" class="edge">
<title>l3_attn_stage14_gpu14&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M19216.96,-3804.87C19231.42,-3798.8 19247.05,-3792.98 19262,-3788.83 19340.68,-3767.02 19362.69,-3771.26 19444,-3763.83 19988.27,-3714.13 20636.48,-3696.6 20933.57,-3690.88"/>
<polygon fill="red" stroke="red" points="20934.06,-3694.37 20943.99,-3690.68 20933.93,-3687.37 20934.06,-3694.37"/>
<text text-anchor="middle" x="19475.5" y="-3767.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu15 -->
<g id="node928" class="node">
<title>l3_attn_stage15_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="17342" cy="-3687.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="17342" y="-3698.63" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="17342" y="-3683.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="17342" y="-3668.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu15&#45;&gt;l3_attn_stage15_gpu15 -->
<g id="edge1344" class="edge">
<title>l3_attn_stage14_gpu15&#45;&gt;l3_attn_stage15_gpu15</title>
<path fill="none" stroke="black" d="M20349.3,-3804.24C20334.31,-3797.9 20317.87,-3792.12 20302,-3788.83 20230.54,-3774.04 17747.87,-3782.62 17675,-3778.83 17572.85,-3773.52 17542.51,-3789.74 17446,-3755.83 17426.98,-3749.15 17407.95,-3738.32 17391.47,-3727.27"/>
<polygon fill="black" stroke="black" points="17393.32,-3724.29 17383.1,-3721.5 17389.34,-3730.06 17393.32,-3724.29"/>
</g>
<!-- l3_attn_stage14_gpu15&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge2944" class="edge">
<title>l3_attn_stage14_gpu15&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M20465.61,-3805C20479.91,-3798.99 20495.31,-3793.17 20510,-3788.83 20666.74,-3742.58 20853.69,-3715.13 20973.81,-3700.9"/>
<polygon fill="red" stroke="red" points="20974.25,-3704.37 20983.78,-3699.73 20973.44,-3697.42 20974.25,-3704.37"/>
<text text-anchor="middle" x="20635.5" y="-3767.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_out_gpu0 -->
<g id="node945" class="node">
<title>l3_attn_out_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="17493" cy="-3564.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="17493" y="-3583.55" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="17493" y="-3568.55" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="17493" y="-3553.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="17493" y="-3538.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu0&#45;&gt;l3_attn_out_gpu0 -->
<g id="edge1345" class="edge">
<title>l3_attn_stage15_gpu0&#45;&gt;l3_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M17696.87,-3658.52C17656.94,-3640.35 17604.68,-3616.57 17563.07,-3597.63"/>
<polygon fill="black" stroke="black" points="17564.37,-3594.38 17553.82,-3593.43 17561.47,-3600.75 17564.37,-3594.38"/>
</g>
<!-- l3_attn_out_gpu1 -->
<g id="node946" class="node">
<title>l3_attn_out_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="15437" cy="-3564.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="15437" y="-3583.55" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="15437" y="-3568.55" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="15437" y="-3553.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15437" y="-3538.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu1&#45;&gt;l3_attn_out_gpu1 -->
<g id="edge1346" class="edge">
<title>l3_attn_stage15_gpu1&#45;&gt;l3_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M16244.67,-3657.4C16229.83,-3651.14 16213.61,-3645.35 16198,-3641.83 16142.68,-3629.36 15999.65,-3634.42 15943,-3631.83 15780.73,-3624.43 15737.61,-3643.06 15578,-3612.83 15555.46,-3608.56 15531.57,-3601.58 15509.99,-3594.29"/>
<polygon fill="black" stroke="black" points="15510.85,-3590.88 15500.25,-3590.92 15508.56,-3597.5 15510.85,-3590.88"/>
</g>
<!-- l3_attn_out_gpu2 -->
<g id="node947" class="node">
<title>l3_attn_out_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="16702" cy="-3564.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="16702" y="-3583.55" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="16702" y="-3568.55" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="16702" y="-3553.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16702" y="-3538.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu2&#45;&gt;l3_attn_out_gpu2 -->
<g id="edge1347" class="edge">
<title>l3_attn_stage15_gpu2&#45;&gt;l3_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M17491.42,-3657.62C17476.87,-3651.52 17461.12,-3645.74 17446,-3641.83 17212.99,-3581.56 16927.35,-3568.68 16787.46,-3566.16"/>
<polygon fill="black" stroke="black" points="16787.29,-3562.66 16777.23,-3565.99 16787.17,-3569.66 16787.29,-3562.66"/>
</g>
<!-- l3_attn_out_gpu3 -->
<g id="node948" class="node">
<title>l3_attn_out_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="16091" cy="-3564.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="16091" y="-3583.55" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="16091" y="-3568.55" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="16091" y="-3553.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16091" y="-3538.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu3&#45;&gt;l3_attn_out_gpu3 -->
<g id="edge1348" class="edge">
<title>l3_attn_stage15_gpu3&#45;&gt;l3_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M16868.68,-3657.39C16853.83,-3651.13 16837.62,-3645.35 16822,-3641.83 16765.37,-3629.09 16618.98,-3634.54 16561,-3631.83 16408.05,-3624.68 16366.87,-3644.21 16217,-3612.83 16198.68,-3609 16179.48,-3602.95 16161.74,-3596.45"/>
<polygon fill="black" stroke="black" points="16162.65,-3593.05 16152.06,-3592.8 16160.18,-3599.6 16162.65,-3593.05"/>
</g>
<!-- l3_attn_out_gpu4 -->
<g id="node949" class="node">
<title>l3_attn_out_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="14230" cy="-3564.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="14230" y="-3583.55" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="14230" y="-3568.55" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="14230" y="-3553.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14230" y="-3538.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu4&#45;&gt;l3_attn_out_gpu4 -->
<g id="edge1349" class="edge">
<title>l3_attn_stage15_gpu4&#45;&gt;l3_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M14996.71,-3657.26C14981.86,-3651.01 14965.64,-3645.25 14950,-3641.83 14909.17,-3632.9 14615.74,-3634.02 14574,-3631.83 14465.82,-3626.17 14435.77,-3640.38 14331,-3612.83 14319.38,-3609.78 14307.45,-3605.43 14296.05,-3600.6"/>
<polygon fill="black" stroke="black" points="14297.18,-3597.28 14286.62,-3596.45 14294.36,-3603.68 14297.18,-3597.28"/>
</g>
<!-- l3_attn_out_gpu5 -->
<g id="node950" class="node">
<title>l3_attn_out_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="15023" cy="-3564.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="15023" y="-3583.55" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="15023" y="-3568.55" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="15023" y="-3553.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15023" y="-3538.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu5&#45;&gt;l3_attn_out_gpu5 -->
<g id="edge1350" class="edge">
<title>l3_attn_stage15_gpu5&#45;&gt;l3_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M15828.7,-3657.31C15813.85,-3651.05 15797.63,-3645.29 15782,-3641.83 15711.23,-3626.19 15528.39,-3635.41 15456,-3631.83 15331.86,-3625.7 15299.23,-3635.37 15177,-3612.83 15150.66,-3607.98 15122.48,-3600.16 15097.51,-3592.28"/>
<polygon fill="black" stroke="black" points="15098.34,-3588.88 15087.75,-3589.15 15096.2,-3595.54 15098.34,-3588.88"/>
</g>
<!-- l3_attn_out_gpu6 -->
<g id="node951" class="node">
<title>l3_attn_out_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="15879" cy="-3564.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="15879" y="-3583.55" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="15879" y="-3568.55" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="15879" y="-3553.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15879" y="-3538.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu6&#45;&gt;l3_attn_out_gpu6 -->
<g id="edge1351" class="edge">
<title>l3_attn_stage15_gpu6&#45;&gt;l3_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M16660.68,-3657.39C16645.83,-3651.14 16629.61,-3645.35 16614,-3641.83 16557.81,-3629.18 16412.54,-3634.51 16355,-3631.83 16200.27,-3624.62 16158.7,-3644.14 16007,-3612.83 15988.04,-3608.92 15968.14,-3602.71 15949.83,-3596.06"/>
<polygon fill="black" stroke="black" points="15951,-3592.76 15940.41,-3592.55 15948.56,-3599.32 15951,-3592.76"/>
</g>
<!-- l3_attn_out_gpu7 -->
<g id="node952" class="node">
<title>l3_attn_out_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14415" cy="-3564.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="14415" y="-3583.55" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="14415" y="-3568.55" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14415" y="-3553.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14415" y="-3538.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu7&#45;&gt;l3_attn_out_gpu7 -->
<g id="edge1352" class="edge">
<title>l3_attn_stage15_gpu7&#45;&gt;l3_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M15204.71,-3657.24C15189.86,-3650.98 15173.64,-3645.24 15158,-3641.83 15113.26,-3632.09 14791.73,-3634.21 14746,-3631.83 14640.03,-3626.32 14610.15,-3641.56 14508,-3612.83 14498.33,-3610.11 14488.48,-3606.36 14478.99,-3602.15"/>
<polygon fill="black" stroke="black" points="14480.18,-3598.84 14469.63,-3597.81 14477.23,-3605.19 14480.18,-3598.84"/>
</g>
<!-- l3_attn_out_gpu8 -->
<g id="node953" class="node">
<title>l3_attn_out_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="16301" cy="-3564.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="16301" y="-3583.55" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="16301" y="-3568.55" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="16301" y="-3553.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16301" y="-3538.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu8&#45;&gt;l3_attn_out_gpu8 -->
<g id="edge1353" class="edge">
<title>l3_attn_stage15_gpu8&#45;&gt;l3_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M17076.38,-3657.38C17061.61,-3651.16 17045.5,-3645.4 17030,-3641.83 16768.09,-3581.57 16689.18,-3667.31 16426,-3612.83 16407.89,-3609.08 16388.94,-3603.1 16371.42,-3596.65"/>
<polygon fill="black" stroke="black" points="16372.45,-3593.29 16361.85,-3593.02 16369.96,-3599.84 16372.45,-3593.29"/>
</g>
<!-- l3_attn_out_gpu9 -->
<g id="node954" class="node">
<title>l3_attn_out_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="15662" cy="-3564.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="15662" y="-3583.55" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="15662" y="-3568.55" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="15662" y="-3553.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15662" y="-3538.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu9&#45;&gt;l3_attn_out_gpu9 -->
<g id="edge1354" class="edge">
<title>l3_attn_stage15_gpu9&#45;&gt;l3_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M16452.68,-3657.39C16437.83,-3651.14 16421.61,-3645.35 16406,-3641.83 16349.81,-3629.18 16204.54,-3634.5 16147,-3631.83 15990.5,-3624.59 15948.64,-3643.51 15795,-3612.83 15774.67,-3608.77 15753.24,-3602.25 15733.66,-3595.34"/>
<polygon fill="black" stroke="black" points="15734.81,-3592.03 15724.22,-3591.92 15732.43,-3598.61 15734.81,-3592.03"/>
</g>
<!-- l3_attn_out_gpu10 -->
<g id="node955" class="node">
<title>l3_attn_out_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="13084" cy="-3564.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="13084" y="-3583.55" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="13084" y="-3568.55" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="13084" y="-3553.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13084" y="-3538.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu10&#45;&gt;l3_attn_out_gpu10 -->
<g id="edge1355" class="edge">
<title>l3_attn_stage15_gpu10&#45;&gt;l3_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M14542.88,-3686.92C14260.77,-3687.81 13432.28,-3684.13 13173,-3612.83 13164.21,-3610.42 13155.31,-3607.03 13146.71,-3603.17"/>
<polygon fill="black" stroke="black" points="13148.05,-3599.93 13137.51,-3598.82 13145.05,-3606.26 13148.05,-3599.93"/>
</g>
<!-- l3_attn_out_gpu11 -->
<g id="node956" class="node">
<title>l3_attn_out_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="14592" cy="-3564.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="14592" y="-3583.55" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="14592" y="-3568.55" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="14592" y="-3553.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14592" y="-3538.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu11&#45;&gt;l3_attn_out_gpu11 -->
<g id="edge1356" class="edge">
<title>l3_attn_stage15_gpu11&#45;&gt;l3_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M15412.38,-3657.36C15397.61,-3651.14 15381.51,-3645.38 15366,-3641.83 15361.73,-3640.85 14740.31,-3613.62 14736,-3612.83 14712.56,-3608.54 14687.68,-3601.39 14665.31,-3593.94"/>
<polygon fill="black" stroke="black" points="14666.15,-3590.53 14655.55,-3590.63 14663.89,-3597.16 14666.15,-3590.53"/>
</g>
<!-- l3_attn_out_gpu12 -->
<g id="node957" class="node">
<title>l3_attn_out_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="13257" cy="-3564.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="13257" y="-3583.55" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="13257" y="-3568.55" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="13257" y="-3553.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="13257" y="-3538.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu12&#45;&gt;l3_attn_out_gpu12 -->
<g id="edge1357" class="edge">
<title>l3_attn_stage15_gpu12&#45;&gt;l3_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M14788.38,-3657.39C14773.61,-3651.17 14757.5,-3645.4 14742,-3641.83 14733.92,-3639.97 14154.28,-3613.25 14146,-3612.83 13850.53,-3597.82 13499.87,-3578.93 13341.76,-3570.36"/>
<polygon fill="black" stroke="black" points="13341.81,-3566.86 13331.63,-3569.81 13341.43,-3573.85 13341.81,-3566.86"/>
</g>
<!-- l3_attn_out_gpu13 -->
<g id="node958" class="node">
<title>l3_attn_out_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="14820" cy="-3564.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="14820" y="-3583.55" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="14820" y="-3568.55" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="14820" y="-3553.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="14820" y="-3538.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu13&#45;&gt;l3_attn_out_gpu13 -->
<g id="edge1358" class="edge">
<title>l3_attn_stage15_gpu13&#45;&gt;l3_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M15620.71,-3657.24C15605.86,-3650.99 15589.64,-3645.24 15574,-3641.83 15530.67,-3632.38 15219.29,-3634.17 15175,-3631.83 15069.92,-3626.29 15041.49,-3636.67 14939,-3612.83 14922.78,-3609.06 14905.86,-3603.46 14890.04,-3597.43"/>
<polygon fill="black" stroke="black" points="14890.93,-3594.02 14880.34,-3593.63 14888.38,-3600.54 14890.93,-3594.02"/>
</g>
<!-- l3_attn_out_gpu14 -->
<g id="node959" class="node">
<title>l3_attn_out_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="15261" cy="-3564.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="15261" y="-3583.55" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="15261" y="-3568.55" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="15261" y="-3553.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="15261" y="-3538.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu14&#45;&gt;l3_attn_out_gpu14 -->
<g id="edge1359" class="edge">
<title>l3_attn_stage15_gpu14&#45;&gt;l3_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M16036.71,-3657.25C16021.86,-3650.99 16005.64,-3645.24 15990,-3641.83 15946.89,-3632.43 15637.07,-3634.13 15593,-3631.83 15486.14,-3626.26 15455.95,-3641.99 15353,-3612.83 15343.55,-3610.16 15333.93,-3606.47 15324.65,-3602.33"/>
<polygon fill="black" stroke="black" points="15326.05,-3599.12 15315.5,-3598.06 15323.08,-3605.46 15326.05,-3599.12"/>
</g>
<!-- l3_attn_out_gpu15 -->
<g id="node960" class="node">
<title>l3_attn_out_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="16510" cy="-3564.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="16510" y="-3583.55" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="16510" y="-3568.55" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="16510" y="-3553.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="16510" y="-3538.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu15&#45;&gt;l3_attn_out_gpu15 -->
<g id="edge1360" class="edge">
<title>l3_attn_stage15_gpu15&#45;&gt;l3_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M17284.38,-3657.37C17269.61,-3651.15 17253.5,-3645.39 17238,-3641.83 17170.78,-3626.41 16685.16,-3628.48 16618,-3612.83 16604.45,-3609.68 16590.49,-3604.88 16577.27,-3599.53"/>
<polygon fill="black" stroke="black" points="16578.38,-3596.19 16567.8,-3595.55 16575.67,-3602.65 16578.38,-3596.19"/>
</g>
<!-- l3_qkv_gpu0&#45;&gt;l3_attn_stage0_gpu0 -->
<g id="edge1089" class="edge">
<title>l3_qkv_gpu0&#45;&gt;l3_attn_stage0_gpu0</title>
<path fill="none" stroke="black" d="M20831.67,-5987.77C20831.24,-5972.48 20830.76,-5955.52 20830.33,-5940.24"/>
<polygon fill="black" stroke="black" points="20833.82,-5939.87 20830.04,-5929.98 20826.82,-5940.07 20833.82,-5939.87"/>
</g>
<!-- l3_qkv_gpu1&#45;&gt;l3_attn_stage0_gpu1 -->
<g id="edge1090" class="edge">
<title>l3_qkv_gpu1&#45;&gt;l3_attn_stage0_gpu1</title>
<path fill="none" stroke="black" d="M19433.86,-5988.16C19438.82,-5972.57 19444.33,-5955.21 19449.28,-5939.65"/>
<polygon fill="black" stroke="black" points="19452.74,-5940.31 19452.43,-5929.72 19446.07,-5938.19 19452.74,-5940.31"/>
</g>
<!-- l3_qkv_gpu2&#45;&gt;l3_attn_stage0_gpu2 -->
<g id="edge1091" class="edge">
<title>l3_qkv_gpu2&#45;&gt;l3_attn_stage0_gpu2</title>
<path fill="none" stroke="black" d="M20632,-5987.77C20632.32,-5972.48 20632.68,-5955.52 20633.01,-5940.24"/>
<polygon fill="black" stroke="black" points="20636.51,-5940.05 20633.22,-5929.98 20629.51,-5939.9 20636.51,-5940.05"/>
</g>
<!-- l3_qkv_gpu3&#45;&gt;l3_attn_stage0_gpu3 -->
<g id="edge1092" class="edge">
<title>l3_qkv_gpu3&#45;&gt;l3_attn_stage0_gpu3</title>
<path fill="none" stroke="black" d="M20032.99,-5987.77C20035.58,-5972.48 20038.46,-5955.52 20041.05,-5940.24"/>
<polygon fill="black" stroke="black" points="20044.57,-5940.42 20042.79,-5929.98 20037.67,-5939.25 20044.57,-5940.42"/>
</g>
<!-- l3_qkv_gpu4&#45;&gt;l3_attn_stage0_gpu4 -->
<g id="edge1093" class="edge">
<title>l3_qkv_gpu4&#45;&gt;l3_attn_stage0_gpu4</title>
<path fill="none" stroke="black" d="M18234.77,-5989.73C18245,-5973.07 18256.59,-5954.22 18266.78,-5937.64"/>
<polygon fill="black" stroke="black" points="18270.02,-5939.04 18272.28,-5928.69 18264.06,-5935.37 18270.02,-5939.04"/>
</g>
<!-- l3_qkv_gpu5&#45;&gt;l3_attn_stage0_gpu5 -->
<g id="edge1094" class="edge">
<title>l3_qkv_gpu5&#45;&gt;l3_attn_stage0_gpu5</title>
<path fill="none" stroke="black" d="M19034.32,-5988.56C19040.94,-5972.66 19048.35,-5954.89 19054.95,-5939.05"/>
<polygon fill="black" stroke="black" points="19058.33,-5940.04 19058.94,-5929.47 19051.87,-5937.35 19058.33,-5940.04"/>
</g>
<!-- l3_qkv_gpu6&#45;&gt;l3_attn_stage0_gpu6 -->
<g id="edge1095" class="edge">
<title>l3_qkv_gpu6&#45;&gt;l3_attn_stage0_gpu6</title>
<path fill="none" stroke="black" d="M19833.32,-5987.77C19836.7,-5972.33 19840.46,-5955.19 19843.83,-5939.8"/>
<polygon fill="black" stroke="black" points="19847.26,-5940.49 19845.98,-5929.98 19840.42,-5939 19847.26,-5940.49"/>
</g>
<!-- l3_qkv_gpu7&#45;&gt;l3_attn_stage0_gpu7 -->
<g id="edge1096" class="edge">
<title>l3_qkv_gpu7&#45;&gt;l3_attn_stage0_gpu7</title>
<path fill="none" stroke="black" d="M18434.75,-5989.34C18444.08,-5972.83 18454.59,-5954.22 18463.87,-5937.81"/>
<polygon fill="black" stroke="black" points="18467,-5939.38 18468.88,-5928.95 18460.91,-5935.93 18467,-5939.38"/>
</g>
<!-- l3_qkv_gpu8&#45;&gt;l3_attn_stage0_gpu8 -->
<g id="edge1097" class="edge">
<title>l3_qkv_gpu8&#45;&gt;l3_attn_stage0_gpu8</title>
<path fill="none" stroke="black" d="M20232.66,-5987.77C20234.5,-5972.48 20236.53,-5955.52 20238.37,-5940.24"/>
<polygon fill="black" stroke="black" points="20241.88,-5940.32 20239.6,-5929.98 20234.93,-5939.49 20241.88,-5940.32"/>
</g>
<!-- l3_qkv_gpu9&#45;&gt;l3_attn_stage0_gpu9 -->
<g id="edge1098" class="edge">
<title>l3_qkv_gpu9&#45;&gt;l3_attn_stage0_gpu9</title>
<path fill="none" stroke="black" d="M19633.55,-5988.16C19637.73,-5972.57 19642.39,-5955.21 19646.57,-5939.65"/>
<polygon fill="black" stroke="black" points="19650.02,-5940.29 19649.23,-5929.72 19643.26,-5938.47 19650.02,-5940.29"/>
</g>
<!-- l3_qkv_gpu10&#45;&gt;l3_attn_stage0_gpu10 -->
<g id="edge1099" class="edge">
<title>l3_qkv_gpu10&#45;&gt;l3_attn_stage0_gpu10</title>
<path fill="none" stroke="black" d="M17834.68,-5990.51C17846.91,-5973.36 17860.86,-5953.81 17873.02,-5936.76"/>
<polygon fill="black" stroke="black" points="17875.88,-5938.78 17878.83,-5928.61 17870.18,-5934.72 17875.88,-5938.78"/>
</g>
<!-- l3_qkv_gpu11&#45;&gt;l3_attn_stage0_gpu11 -->
<g id="edge1100" class="edge">
<title>l3_qkv_gpu11&#45;&gt;l3_attn_stage0_gpu11</title>
<path fill="none" stroke="black" d="M18634.5,-5989.34C18642.86,-5973.12 18652.27,-5954.87 18660.62,-5938.67"/>
<polygon fill="black" stroke="black" points="18663.93,-5939.9 18665.4,-5929.4 18657.71,-5936.69 18663.93,-5939.9"/>
</g>
<!-- l3_qkv_gpu12&#45;&gt;l3_attn_stage0_gpu12 -->
<g id="edge1101" class="edge">
<title>l3_qkv_gpu12&#45;&gt;l3_attn_stage0_gpu12</title>
<path fill="none" stroke="black" d="M18034.74,-5990.12C18045.92,-5973.28 18058.61,-5954.17 18069.74,-5937.41"/>
<polygon fill="black" stroke="black" points="18072.79,-5939.14 18075.4,-5928.88 18066.95,-5935.27 18072.79,-5939.14"/>
</g>
<!-- l3_qkv_gpu13&#45;&gt;l3_attn_stage0_gpu13 -->
<g id="edge1102" class="edge">
<title>l3_qkv_gpu13&#45;&gt;l3_attn_stage0_gpu13</title>
<path fill="none" stroke="black" d="M18834.43,-5988.95C18841.98,-5972.75 18850.46,-5954.56 18857.97,-5938.44"/>
<polygon fill="black" stroke="black" points="18861.22,-5939.75 18862.28,-5929.21 18854.88,-5936.79 18861.22,-5939.75"/>
</g>
<!-- l3_qkv_gpu14&#45;&gt;l3_attn_stage0_gpu14 -->
<g id="edge1103" class="edge">
<title>l3_qkv_gpu14&#45;&gt;l3_attn_stage0_gpu14</title>
<path fill="none" stroke="black" d="M19234.03,-5988.56C19239.86,-5972.66 19246.39,-5954.89 19252.21,-5939.05"/>
<polygon fill="black" stroke="black" points="19255.57,-5940.06 19255.73,-5929.47 19249,-5937.65 19255.57,-5940.06"/>
</g>
<!-- l3_qkv_gpu15&#45;&gt;l3_attn_stage0_gpu15 -->
<g id="edge1104" class="edge">
<title>l3_qkv_gpu15&#45;&gt;l3_attn_stage0_gpu15</title>
<path fill="none" stroke="black" d="M20432.33,-5987.77C20433.41,-5972.48 20434.61,-5955.52 20435.69,-5940.24"/>
<polygon fill="black" stroke="black" points="20439.2,-5940.2 20436.41,-5929.98 20432.22,-5939.7 20439.2,-5940.2"/>
</g>
<!-- l3_gate_gpu0 -->
<g id="node961" class="node">
<title>l3_gate_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="16964" cy="-3442.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="16964" y="-3453.47" font-family="Times,serif" font-size="14.00">L3 Gate</text>
<text text-anchor="middle" x="16964" y="-3438.47" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="16964" y="-3423.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l3_attn_out_gpu0&#45;&gt;l3_gate_gpu0 -->
<g id="edge1361" class="edge">
<title>l3_attn_out_gpu0&#45;&gt;l3_gate_gpu0</title>
<path fill="none" stroke="black" d="M17422.75,-3547.74C17325.01,-3525.46 17148.39,-3485.2 17045.14,-3461.66"/>
<polygon fill="black" stroke="black" points="17045.91,-3458.25 17035.38,-3459.44 17044.36,-3465.07 17045.91,-3458.25"/>
</g>
<!-- l3_gate_gpu1 -->
<g id="node986" class="node">
<title>l3_gate_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14334" cy="-3442.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="14334" y="-3453.47" font-family="Times,serif" font-size="14.00">L3 Gate</text>
<text text-anchor="middle" x="14334" y="-3438.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14334" y="-3423.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l3_attn_out_gpu1&#45;&gt;l3_gate_gpu1 -->
<g id="edge1386" class="edge">
<title>l3_attn_out_gpu1&#45;&gt;l3_gate_gpu1</title>
<path fill="none" stroke="black" d="M15383.13,-3531.14C15370.99,-3525.24 15357.87,-3519.93 15345,-3516.67 15263.88,-3496.09 14675.5,-3504.35 14592,-3498.67 14516.59,-3493.54 14496.22,-3498.41 14423,-3479.67 14415.29,-3477.69 14407.37,-3475.19 14399.59,-3472.43"/>
<polygon fill="black" stroke="black" points="14400.77,-3469.13 14390.18,-3468.94 14398.34,-3475.69 14400.77,-3469.13"/>
</g>
<!-- l3_gate_gpu2 -->
<g id="node987" class="node">
<title>l3_gate_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="15402" cy="-3442.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="15402" y="-3453.47" font-family="Times,serif" font-size="14.00">L3 Gate</text>
<text text-anchor="middle" x="15402" y="-3438.47" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="15402" y="-3423.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l3_attn_out_gpu2&#45;&gt;l3_gate_gpu2 -->
<g id="edge1411" class="edge">
<title>l3_attn_out_gpu2&#45;&gt;l3_gate_gpu2</title>
<path fill="none" stroke="black" d="M16644.16,-3534.12C16628.28,-3527.22 16610.8,-3520.71 16594,-3516.67 16384.97,-3466.32 15732.29,-3449.31 15491.98,-3444.66"/>
<polygon fill="black" stroke="black" points="15491.95,-3441.16 15481.89,-3444.47 15491.82,-3448.16 15491.95,-3441.16"/>
</g>
<!-- l3_gate_gpu3 -->
<g id="node988" class="node">
<title>l3_gate_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14868" cy="-3442.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="14868" y="-3453.47" font-family="Times,serif" font-size="14.00">L3 Gate</text>
<text text-anchor="middle" x="14868" y="-3438.47" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14868" y="-3423.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l3_attn_out_gpu3&#45;&gt;l3_gate_gpu3 -->
<g id="edge1436" class="edge">
<title>l3_attn_out_gpu3&#45;&gt;l3_gate_gpu3</title>
<path fill="none" stroke="black" d="M16029.99,-3536.65C16009.16,-3528.67 15985.45,-3520.93 15963,-3516.67 15789.61,-3483.76 15345.21,-3508.55 15169,-3498.67 15074.55,-3493.37 15048.9,-3502.09 14957,-3479.67 14949.27,-3477.78 14941.34,-3475.33 14933.54,-3472.6"/>
<polygon fill="black" stroke="black" points="14934.72,-3469.3 14924.13,-3469.14 14932.31,-3475.87 14934.72,-3469.3"/>
</g>
<!-- l3_gate_gpu4 -->
<g id="node989" class="node">
<title>l3_gate_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13266" cy="-3442.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="13266" y="-3453.47" font-family="Times,serif" font-size="14.00">L3 Gate</text>
<text text-anchor="middle" x="13266" y="-3438.47" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13266" y="-3423.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l3_attn_out_gpu4&#45;&gt;l3_gate_gpu4 -->
<g id="edge1461" class="edge">
<title>l3_attn_out_gpu4&#45;&gt;l3_gate_gpu4</title>
<path fill="none" stroke="black" d="M14154.72,-3563.88C14001.73,-3562.55 13644.44,-3551.26 13355,-3479.67 13347.28,-3477.76 13339.35,-3475.29 13331.56,-3472.55"/>
<polygon fill="black" stroke="black" points="13332.73,-3469.25 13322.14,-3469.08 13330.31,-3475.82 13332.73,-3469.25"/>
</g>
<!-- l3_gate_gpu5 -->
<g id="node990" class="node">
<title>l3_gate_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="13978" cy="-3442.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="13978" y="-3453.47" font-family="Times,serif" font-size="14.00">L3 Gate</text>
<text text-anchor="middle" x="13978" y="-3438.47" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13978" y="-3423.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l3_attn_out_gpu5&#45;&gt;l3_gate_gpu5 -->
<g id="edge1486" class="edge">
<title>l3_attn_out_gpu5&#45;&gt;l3_gate_gpu5</title>
<path fill="none" stroke="black" d="M14963.41,-3535.46C14944.8,-3527.92 14923.92,-3520.74 14904,-3516.67 14758.52,-3486.9 14384.14,-3508.97 14236,-3498.67 14160.6,-3493.42 14140.22,-3498.41 14067,-3479.67 14059.29,-3477.69 14051.37,-3475.19 14043.59,-3472.43"/>
<polygon fill="black" stroke="black" points="14044.77,-3469.13 14034.18,-3468.94 14042.34,-3475.69 14044.77,-3469.13"/>
</g>
<!-- l3_gate_gpu6 -->
<g id="node991" class="node">
<title>l3_gate_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14690" cy="-3442.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="14690" y="-3453.47" font-family="Times,serif" font-size="14.00">L3 Gate</text>
<text text-anchor="middle" x="14690" y="-3438.47" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14690" y="-3423.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l3_attn_out_gpu6&#45;&gt;l3_gate_gpu6 -->
<g id="edge1511" class="edge">
<title>l3_attn_out_gpu6&#45;&gt;l3_gate_gpu6</title>
<path fill="none" stroke="black" d="M15817.2,-3537.31C15795.14,-3529.1 15769.85,-3521.06 15746,-3516.67 15585.55,-3487.07 15174.93,-3507.3 15012,-3498.67 14908.25,-3493.17 14880.04,-3503.89 14779,-3479.67 14771.26,-3477.81 14763.33,-3475.38 14755.53,-3472.66"/>
<polygon fill="black" stroke="black" points="14756.7,-3469.36 14746.11,-3469.21 14754.3,-3475.94 14756.7,-3469.36"/>
</g>
<!-- l3_gate_gpu7 -->
<g id="node992" class="node">
<title>l3_gate_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="13444" cy="-3442.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="13444" y="-3453.47" font-family="Times,serif" font-size="14.00">L3 Gate</text>
<text text-anchor="middle" x="13444" y="-3438.47" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="13444" y="-3423.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l3_attn_out_gpu7&#45;&gt;l3_gate_gpu7 -->
<g id="edge1536" class="edge">
<title>l3_attn_out_gpu7&#45;&gt;l3_gate_gpu7</title>
<path fill="none" stroke="black" d="M14358.75,-3532.76C14344.54,-3526.28 14329.04,-3520.32 14314,-3516.67 14216.53,-3493.01 13963.18,-3503.55 13863,-3498.67 13716.26,-3491.51 13676.26,-3512.21 13533,-3479.67 13525.13,-3477.88 13517.05,-3475.46 13509.14,-3472.72"/>
<polygon fill="black" stroke="black" points="13510.17,-3469.38 13499.58,-3469.24 13507.78,-3475.95 13510.17,-3469.38"/>
</g>
<!-- l3_gate_gpu8 -->
<g id="node993" class="node">
<title>l3_gate_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="15046" cy="-3442.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="15046" y="-3453.47" font-family="Times,serif" font-size="14.00">L3 Gate</text>
<text text-anchor="middle" x="15046" y="-3438.47" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="15046" y="-3423.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l3_attn_out_gpu8&#45;&gt;l3_gate_gpu8 -->
<g id="edge1561" class="edge">
<title>l3_attn_out_gpu8&#45;&gt;l3_gate_gpu8</title>
<path fill="none" stroke="black" d="M16240.35,-3536.38C16220,-3528.48 16196.9,-3520.86 16175,-3516.67 16079.93,-3498.47 15400.59,-3505.08 15304,-3498.67 15228.58,-3493.66 15208.22,-3498.41 15135,-3479.67 15127.29,-3477.69 15119.37,-3475.19 15111.59,-3472.43"/>
<polygon fill="black" stroke="black" points="15112.77,-3469.13 15102.18,-3468.94 15110.34,-3475.69 15112.77,-3469.13"/>
</g>
<!-- l3_gate_gpu9 -->
<g id="node994" class="node">
<title>l3_gate_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="14512" cy="-3442.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="14512" y="-3453.47" font-family="Times,serif" font-size="14.00">L3 Gate</text>
<text text-anchor="middle" x="14512" y="-3438.47" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="14512" y="-3423.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l3_attn_out_gpu9&#45;&gt;l3_gate_gpu9 -->
<g id="edge1570" class="edge">
<title>l3_attn_out_gpu9&#45;&gt;l3_gate_gpu9</title>
<path fill="none" stroke="black" d="M15599.17,-3538.31C15575.12,-3529.76 15547.18,-3521.25 15521,-3516.67 15356.56,-3487.91 14936.55,-3510 14770,-3498.67 14694.59,-3493.53 14674.22,-3498.41 14601,-3479.67 14593.29,-3477.69 14585.37,-3475.19 14577.59,-3472.43"/>
<polygon fill="black" stroke="black" points="14578.77,-3469.13 14568.18,-3468.94 14576.34,-3475.69 14578.77,-3469.13"/>
</g>
<!-- l3_gate_gpu10 -->
<g id="node995" class="node">
<title>l3_gate_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12910" cy="-3442.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="12910" y="-3453.47" font-family="Times,serif" font-size="14.00">L3 Gate</text>
<text text-anchor="middle" x="12910" y="-3438.47" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12910" y="-3423.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l3_attn_out_gpu10&#45;&gt;l3_gate_gpu10 -->
<g id="edge1579" class="edge">
<title>l3_attn_out_gpu10&#45;&gt;l3_gate_gpu10</title>
<path fill="none" stroke="black" d="M13033.67,-3528.87C13011.33,-3513.39 12985.05,-3495.17 12962.46,-3479.52"/>
<polygon fill="black" stroke="black" points="12964.22,-3476.48 12954.01,-3473.66 12960.23,-3482.24 12964.22,-3476.48"/>
</g>
<!-- l3_gate_gpu11 -->
<g id="node996" class="node">
<title>l3_gate_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="13622" cy="-3442.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="13622" y="-3453.47" font-family="Times,serif" font-size="14.00">L3 Gate</text>
<text text-anchor="middle" x="13622" y="-3438.47" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="13622" y="-3423.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l3_attn_out_gpu11&#45;&gt;l3_gate_gpu11 -->
<g id="edge1588" class="edge">
<title>l3_attn_out_gpu11&#45;&gt;l3_gate_gpu11</title>
<path fill="none" stroke="black" d="M14537.5,-3531.2C14525.23,-3525.29 14511.98,-3519.96 14499,-3516.67 14432.31,-3499.72 13948.64,-3503.51 13880,-3498.67 13804.6,-3493.34 13784.22,-3498.41 13711,-3479.67 13703.29,-3477.69 13695.37,-3475.19 13687.59,-3472.43"/>
<polygon fill="black" stroke="black" points="13688.77,-3469.13 13678.18,-3468.94 13686.34,-3475.69 13688.77,-3469.13"/>
</g>
<!-- l3_gate_gpu12 -->
<g id="node997" class="node">
<title>l3_gate_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="13088" cy="-3442.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="13088" y="-3453.47" font-family="Times,serif" font-size="14.00">L3 Gate</text>
<text text-anchor="middle" x="13088" y="-3438.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="13088" y="-3423.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l3_attn_out_gpu12&#45;&gt;l3_gate_gpu12 -->
<g id="edge1597" class="edge">
<title>l3_attn_out_gpu12&#45;&gt;l3_gate_gpu12</title>
<path fill="none" stroke="black" d="M13207.21,-3528.22C13185.89,-3513.01 13161.01,-3495.26 13139.51,-3479.92"/>
<polygon fill="black" stroke="black" points="13141.31,-3476.9 13131.14,-3473.95 13137.25,-3482.6 13141.31,-3476.9"/>
</g>
<!-- l3_gate_gpu13 -->
<g id="node998" class="node">
<title>l3_gate_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13800" cy="-3442.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="13800" y="-3453.47" font-family="Times,serif" font-size="14.00">L3 Gate</text>
<text text-anchor="middle" x="13800" y="-3438.47" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13800" y="-3423.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l3_attn_out_gpu13&#45;&gt;l3_gate_gpu13 -->
<g id="edge1606" class="edge">
<title>l3_attn_out_gpu13&#45;&gt;l3_gate_gpu13</title>
<path fill="none" stroke="black" d="M14756.84,-3538.79C14732.04,-3530.13 14703.07,-3521.42 14676,-3516.67 14550.08,-3494.58 14228.61,-3506.38 14101,-3498.67 14006.57,-3492.96 13980.9,-3502.09 13889,-3479.67 13881.27,-3477.78 13873.34,-3475.33 13865.54,-3472.6"/>
<polygon fill="black" stroke="black" points="13866.72,-3469.3 13856.13,-3469.14 13864.31,-3475.87 13866.72,-3469.3"/>
</g>
<!-- l3_gate_gpu14 -->
<g id="node999" class="node">
<title>l3_gate_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="14156" cy="-3442.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="14156" y="-3453.47" font-family="Times,serif" font-size="14.00">L3 Gate</text>
<text text-anchor="middle" x="14156" y="-3438.47" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="14156" y="-3423.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l3_attn_out_gpu14&#45;&gt;l3_gate_gpu14 -->
<g id="edge1615" class="edge">
<title>l3_attn_out_gpu14&#45;&gt;l3_gate_gpu14</title>
<path fill="none" stroke="black" d="M15196.71,-3539.96C15169.44,-3530.96 15137.06,-3521.68 15107,-3516.67 14917.88,-3485.12 14431.97,-3522.13 14245,-3479.67 14237.13,-3477.88 14229.05,-3475.46 14221.14,-3472.72"/>
<polygon fill="black" stroke="black" points="14222.17,-3469.38 14211.58,-3469.24 14219.78,-3475.95 14222.17,-3469.38"/>
</g>
<!-- l3_gate_gpu15 -->
<g id="node1000" class="node">
<title>l3_gate_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="15224" cy="-3442.17" rx="80" ry="37.5"/>
<text text-anchor="middle" x="15224" y="-3453.47" font-family="Times,serif" font-size="14.00">L3 Gate</text>
<text text-anchor="middle" x="15224" y="-3438.47" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="15224" y="-3423.47" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l3_attn_out_gpu15&#45;&gt;l3_gate_gpu15 -->
<g id="edge1624" class="edge">
<title>l3_attn_out_gpu15&#45;&gt;l3_gate_gpu15</title>
<path fill="none" stroke="black" d="M16449.18,-3536.31C16429.15,-3528.5 16406.49,-3520.96 16385,-3516.67 16268.13,-3493.3 15429.52,-3504.73 15313,-3479.67 15305.11,-3477.97 15297.02,-3475.61 15289.1,-3472.9"/>
<polygon fill="black" stroke="black" points="15290.13,-3469.55 15279.53,-3469.44 15287.75,-3476.14 15290.13,-3469.55"/>
</g>
<!-- l3_expert0_gpu0 -->
<g id="node962" class="node">
<title>l3_expert0_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="11685" cy="-3305.58" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="11685" y="-3324.38" font-family="Times,serif" font-size="14.00">L3 Expert0</text>
<text text-anchor="middle" x="11685" y="-3309.38" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="11685" y="-3294.38" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="11685" y="-3279.38" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l3_gate_gpu0&#45;&gt;l3_expert0_gpu0 -->
<g id="edge1362" class="edge">
<title>l3_gate_gpu0&#45;&gt;l3_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M16884.18,-3438.61C16662.92,-3431.67 16023.02,-3412.41 15491,-3404.67 15462.23,-3404.25 11367.3,-3407.06 11347,-3386.67 11308.63,-3348.13 11492.11,-3324.14 11603.88,-3313.33"/>
<polygon fill="black" stroke="black" points="11604.51,-3316.79 11614.13,-3312.36 11603.84,-3309.82 11604.51,-3316.79"/>
<text text-anchor="middle" x="11392.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l3_expert1_gpu1 -->
<g id="node963" class="node">
<title>l3_expert1_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="12112" cy="-3305.58" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="12112" y="-3324.38" font-family="Times,serif" font-size="14.00">L3 Expert1</text>
<text text-anchor="middle" x="12112" y="-3309.38" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12112" y="-3294.38" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="12112" y="-3279.38" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l3_gate_gpu0&#45;&gt;l3_expert1_gpu1 -->
<g id="edge1363" class="edge">
<title>l3_gate_gpu0&#45;&gt;l3_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M16884.17,-3438.71C16662.91,-3432.02 16023.01,-3413.35 15491,-3404.67 15427.51,-3403.63 13264.91,-3407.73 13205,-3386.67 13194.85,-3383.1 13196.1,-3375.37 13186,-3371.67 13131.93,-3351.84 12725.49,-3357.1 12668,-3353.67 12498.67,-3343.56 12300.86,-3325.25 12192.75,-3314.69"/>
<polygon fill="black" stroke="black" points="12192.87,-3311.18 12182.57,-3313.69 12192.18,-3318.15 12192.87,-3311.18"/>
<text text-anchor="middle" x="13250.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l3_expert2_gpu2 -->
<g id="node964" class="node">
<title>l3_expert2_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="18131" cy="-3305.58" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="18131" y="-3324.38" font-family="Times,serif" font-size="14.00">L3 Expert2</text>
<text text-anchor="middle" x="18131" y="-3309.38" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="18131" y="-3294.38" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="18131" y="-3279.38" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l3_gate_gpu0&#45;&gt;l3_expert2_gpu2 -->
<g id="edge1364" class="edge">
<title>l3_gate_gpu0&#45;&gt;l3_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M17044.16,-3440.79C17591.84,-3438.14 20761.86,-3421.29 20796,-3386.67 20800.68,-3381.92 20800.66,-3376.44 20796,-3371.67 20749.76,-3324.28 18655.85,-3309.6 18212.8,-3307.02"/>
<polygon fill="black" stroke="black" points="18212.67,-3303.52 18202.64,-3306.97 18212.62,-3310.52 18212.67,-3303.52"/>
<text text-anchor="middle" x="20844.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l3_expert3_gpu3 -->
<g id="node965" class="node">
<title>l3_expert3_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="12749" cy="-3305.58" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="12749" y="-3324.38" font-family="Times,serif" font-size="14.00">L3 Expert3</text>
<text text-anchor="middle" x="12749" y="-3309.38" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12749" y="-3294.38" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="12749" y="-3279.38" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l3_gate_gpu0&#45;&gt;l3_expert3_gpu3 -->
<g id="edge1365" class="edge">
<title>l3_gate_gpu0&#45;&gt;l3_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M16884.18,-3439.19C16528.51,-3430.35 15104.49,-3394.48 15083,-3386.67 15072.89,-3382.99 15074.14,-3375.27 15064,-3371.67 14999.5,-3348.74 13900.42,-3355.65 13832,-3353.67 13457.62,-3342.8 13010.82,-3320.37 12830.45,-3310.93"/>
<polygon fill="black" stroke="black" points="12830.42,-3307.42 12820.25,-3310.39 12830.06,-3314.41 12830.42,-3307.42"/>
<text text-anchor="middle" x="15128.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l3_expert4_gpu4 -->
<g id="node966" class="node">
<title>l3_expert4_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="10010" cy="-3305.58" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="10010" y="-3324.38" font-family="Times,serif" font-size="14.00">L3 Expert4</text>
<text text-anchor="middle" x="10010" y="-3309.38" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10010" y="-3294.38" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="10010" y="-3279.38" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l3_gate_gpu0&#45;&gt;l3_expert4_gpu4 -->
<g id="edge1366" class="edge">
<title>l3_gate_gpu0&#45;&gt;l3_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M16884.18,-3438.58C16662.92,-3431.53 16023.03,-3412.05 15491,-3404.67 15470.09,-3404.38 9483.76,-3401.47 9469,-3386.67 9402.76,-3320.23 9761.15,-3308.64 9928.07,-3306.81"/>
<polygon fill="black" stroke="black" points="9928.34,-3310.31 9938.3,-3306.71 9928.27,-3303.31 9928.34,-3310.31"/>
<text text-anchor="middle" x="9514.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l3_expert5_gpu5 -->
<g id="node967" class="node">
<title>l3_expert5_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="13913" cy="-3305.58" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="13913" y="-3324.38" font-family="Times,serif" font-size="14.00">L3 Expert5</text>
<text text-anchor="middle" x="13913" y="-3309.38" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13913" y="-3294.38" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="13913" y="-3279.38" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l3_gate_gpu0&#45;&gt;l3_expert5_gpu5 -->
<g id="edge1367" class="edge">
<title>l3_gate_gpu0&#45;&gt;l3_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M16940,-3406.25C16928.69,-3392.81 16913.93,-3378.96 16897,-3371.67 16847.53,-3350.37 15011.84,-3355.13 14958,-3353.67 14598.67,-3343.91 14170.29,-3321.09 13994.44,-3311.24"/>
<polygon fill="black" stroke="black" points="13994.42,-3307.74 13984.24,-3310.67 13994.03,-3314.73 13994.42,-3307.74"/>
<text text-anchor="middle" x="16965.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l3_expert6_gpu6 -->
<g id="node968" class="node">
<title>l3_expert6_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="16059" cy="-3305.58" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="16059" y="-3324.38" font-family="Times,serif" font-size="14.00">L3 Expert6</text>
<text text-anchor="middle" x="16059" y="-3309.38" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="16059" y="-3294.38" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="16059" y="-3279.38" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l3_gate_gpu0&#45;&gt;l3_expert6_gpu6 -->
<g id="edge1368" class="edge">
<title>l3_gate_gpu0&#45;&gt;l3_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M17044.26,-3440.76C17584.04,-3437.94 20664.78,-3420.37 20698,-3386.67 20702.68,-3381.92 20702.7,-3376.4 20698,-3371.67 20685.04,-3358.62 18068.39,-3353.95 18050,-3353.67 17308.47,-3342.38 16411.84,-3316.95 16140.57,-3309"/>
<polygon fill="black" stroke="black" points="16140.52,-3305.5 16130.42,-3308.71 16140.31,-3312.5 16140.52,-3305.5"/>
<text text-anchor="middle" x="20746.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l3_expert7_gpu7 -->
<g id="node969" class="node">
<title>l3_expert7_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="15039" cy="-3305.58" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="15039" y="-3324.38" font-family="Times,serif" font-size="14.00">L3 Expert7</text>
<text text-anchor="middle" x="15039" y="-3309.38" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="15039" y="-3294.38" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="15039" y="-3279.38" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l3_gate_gpu0&#45;&gt;l3_expert7_gpu7 -->
<g id="edge1369" class="edge">
<title>l3_gate_gpu0&#45;&gt;l3_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M17043.98,-3440.3C17393.87,-3436.34 18773.89,-3418.71 18805,-3386.67 18809.64,-3381.88 18809.7,-3376.4 18805,-3371.67 18791.16,-3357.74 15997.62,-3354.22 15978,-3353.67 15660.69,-3344.7 15283.57,-3322.19 15120.64,-3311.88"/>
<polygon fill="black" stroke="black" points="15120.43,-3308.36 15110.23,-3311.22 15119.98,-3315.35 15120.43,-3308.36"/>
<text text-anchor="middle" x="18854.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l3_expert_agg_gpu0 -->
<g id="node970" class="node">
<title>l3_expert_agg_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="13525" cy="-3183" rx="85" ry="37.5"/>
<text text-anchor="middle" x="13525" y="-3194.3" font-family="Times,serif" font-size="14.00">L3 Expert Agg</text>
<text text-anchor="middle" x="13525" y="-3179.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13525" y="-3164.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1370" class="edge">
<title>l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M11753.99,-3292.66C11823.64,-3281.22 11934.42,-3264.66 12031,-3257.5 12109.29,-3251.7 13369.16,-3263.2 13444,-3239.5 13456.05,-3235.68 13467.92,-3229.42 13478.7,-3222.44"/>
<polygon fill="black" stroke="black" points="13480.8,-3225.25 13487.09,-3216.73 13476.86,-3219.47 13480.8,-3225.25"/>
</g>
<!-- l3_expert_agg_gpu1 -->
<g id="node971" class="node">
<title>l3_expert_agg_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14277" cy="-3183" rx="85" ry="37.5"/>
<text text-anchor="middle" x="14277" y="-3194.3" font-family="Times,serif" font-size="14.00">L3 Expert Agg</text>
<text text-anchor="middle" x="14277" y="-3179.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14277" y="-3164.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1371" class="edge">
<title>l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M11753.99,-3292.56C11823.63,-3281.05 11934.4,-3264.44 12031,-3257.5 12091.57,-3253.15 14160.55,-3261.87 14217,-3239.5 14225.52,-3236.12 14233.57,-3230.91 14240.83,-3225.01"/>
<polygon fill="black" stroke="black" points="14243.18,-3227.61 14248.39,-3218.39 14238.56,-3222.34 14243.18,-3227.61"/>
</g>
<!-- l3_expert_agg_gpu2 -->
<g id="node972" class="node">
<title>l3_expert_agg_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="12397" cy="-3183" rx="85" ry="37.5"/>
<text text-anchor="middle" x="12397" y="-3194.3" font-family="Times,serif" font-size="14.00">L3 Expert Agg</text>
<text text-anchor="middle" x="12397" y="-3179.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12397" y="-3164.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1372" class="edge">
<title>l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11754.41,-3293.66C11824.15,-3283.03 11934.79,-3267.13 12031,-3257.5 12093.04,-3251.29 12251.79,-3259.03 12311,-3239.5 12323.64,-3235.33 12336.25,-3228.85 12347.76,-3221.77"/>
<polygon fill="black" stroke="black" points="12349.8,-3224.61 12356.33,-3216.26 12346.02,-3218.72 12349.8,-3224.61"/>
</g>
<!-- l3_expert_agg_gpu3 -->
<g id="node973" class="node">
<title>l3_expert_agg_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14653" cy="-3183" rx="85" ry="37.5"/>
<text text-anchor="middle" x="14653" y="-3194.3" font-family="Times,serif" font-size="14.00">L3 Expert Agg</text>
<text text-anchor="middle" x="14653" y="-3179.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14653" y="-3164.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1373" class="edge">
<title>l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M11753.99,-3292.54C11823.63,-3281.01 11934.4,-3264.39 12031,-3257.5 12101.18,-3252.5 14496.42,-3259.1 14564,-3239.5 14577.65,-3235.54 14591.25,-3228.83 14603.56,-3221.43"/>
<polygon fill="black" stroke="black" points="14605.68,-3224.23 14612.28,-3215.94 14601.95,-3218.3 14605.68,-3224.23"/>
</g>
<!-- l3_expert_agg_gpu4 -->
<g id="node974" class="node">
<title>l3_expert_agg_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13901" cy="-3183" rx="85" ry="37.5"/>
<text text-anchor="middle" x="13901" y="-3194.3" font-family="Times,serif" font-size="14.00">L3 Expert Agg</text>
<text text-anchor="middle" x="13901" y="-3179.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13901" y="-3164.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1374" class="edge">
<title>l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M11753.99,-3292.6C11823.63,-3281.11 11934.41,-3264.52 12031,-3257.5 12081.76,-3253.81 13818.1,-3263.46 13863,-3239.5 13868.41,-3236.61 13873.2,-3232.57 13877.4,-3227.98"/>
<polygon fill="black" stroke="black" points="13880.41,-3229.82 13883.91,-3219.82 13874.94,-3225.45 13880.41,-3229.82"/>
</g>
<!-- l3_expert_agg_gpu5 -->
<g id="node975" class="node">
<title>l3_expert_agg_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="12021" cy="-3183" rx="85" ry="37.5"/>
<text text-anchor="middle" x="12021" y="-3194.3" font-family="Times,serif" font-size="14.00">L3 Expert Agg</text>
<text text-anchor="middle" x="12021" y="-3179.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12021" y="-3164.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1375" class="edge">
<title>l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M11747.8,-3282.04C11804.03,-3261.86 11886.56,-3232.25 11946.19,-3210.85"/>
<polygon fill="black" stroke="black" points="11947.7,-3214.03 11955.93,-3207.35 11945.33,-3207.44 11947.7,-3214.03"/>
</g>
<!-- l3_expert_agg_gpu6 -->
<g id="node976" class="node">
<title>l3_expert_agg_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14465" cy="-3183" rx="85" ry="37.5"/>
<text text-anchor="middle" x="14465" y="-3194.3" font-family="Times,serif" font-size="14.00">L3 Expert Agg</text>
<text text-anchor="middle" x="14465" y="-3179.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14465" y="-3164.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1376" class="edge">
<title>l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M11753.99,-3292.55C11823.63,-3281.03 11934.4,-3264.41 12031,-3257.5 12096.78,-3252.79 14343.69,-3263.78 14405,-3239.5 14413.53,-3236.12 14421.57,-3230.92 14428.83,-3225.01"/>
<polygon fill="black" stroke="black" points="14431.18,-3227.62 14436.4,-3218.39 14426.57,-3222.35 14431.18,-3227.62"/>
</g>
<!-- l3_expert_agg_gpu7 -->
<g id="node977" class="node">
<title>l3_expert_agg_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14089" cy="-3183" rx="85" ry="37.5"/>
<text text-anchor="middle" x="14089" y="-3194.3" font-family="Times,serif" font-size="14.00">L3 Expert Agg</text>
<text text-anchor="middle" x="14089" y="-3179.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14089" y="-3164.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1377" class="edge">
<title>l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M11753.99,-3292.58C11823.63,-3281.08 11934.41,-3264.47 12031,-3257.5 12086.94,-3253.46 14000.35,-3265.58 14050,-3239.5 14055.61,-3236.55 14060.59,-3232.39 14064.94,-3227.66"/>
<polygon fill="black" stroke="black" points="14067.71,-3229.81 14071.29,-3219.84 14062.27,-3225.4 14067.71,-3229.81"/>
</g>
<!-- l3_expert_agg_gpu8 -->
<g id="node978" class="node">
<title>l3_expert_agg_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="12773" cy="-3183" rx="85" ry="37.5"/>
<text text-anchor="middle" x="12773" y="-3194.3" font-family="Times,serif" font-size="14.00">L3 Expert Agg</text>
<text text-anchor="middle" x="12773" y="-3179.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12773" y="-3164.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1378" class="edge">
<title>l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M11754.01,-3292.91C11823.68,-3281.66 11934.47,-3265.25 12031,-3257.5 12070.88,-3254.3 12718.19,-3262.4 12751,-3239.5 12754.83,-3236.83 12758,-3233.37 12760.61,-3229.49"/>
<polygon fill="black" stroke="black" points="12763.81,-3230.93 12765.5,-3220.47 12757.66,-3227.6 12763.81,-3230.93"/>
</g>
<!-- l3_expert_agg_gpu9 -->
<g id="node979" class="node">
<title>l3_expert_agg_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="12961" cy="-3183" rx="85" ry="37.5"/>
<text text-anchor="middle" x="12961" y="-3194.3" font-family="Times,serif" font-size="14.00">L3 Expert Agg</text>
<text text-anchor="middle" x="12961" y="-3179.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12961" y="-3164.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1379" class="edge">
<title>l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M11754.01,-3292.8C11823.66,-3281.48 11934.45,-3265.01 12031,-3257.5 12080.91,-3253.62 12889.44,-3265.87 12932,-3239.5 12936.45,-3236.74 12940.25,-3233.06 12943.49,-3228.9"/>
<polygon fill="black" stroke="black" points="12946.49,-3230.7 12949.05,-3220.42 12940.64,-3226.86 12946.49,-3230.7"/>
</g>
<!-- l3_expert_agg_gpu10 -->
<g id="node980" class="node">
<title>l3_expert_agg_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12209" cy="-3183" rx="85" ry="37.5"/>
<text text-anchor="middle" x="12209" y="-3194.3" font-family="Times,serif" font-size="14.00">L3 Expert Agg</text>
<text text-anchor="middle" x="12209" y="-3179.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12209" y="-3164.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1380" class="edge">
<title>l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11755.19,-3295.01C11875.03,-3278.56 12107.92,-3246.03 12125,-3239.5 12136.85,-3234.97 12148.74,-3228.54 12159.68,-3221.66"/>
<polygon fill="black" stroke="black" points="12161.78,-3224.47 12168.24,-3216.07 12157.95,-3218.61 12161.78,-3224.47"/>
</g>
<!-- l3_expert_agg_gpu11 -->
<g id="node981" class="node">
<title>l3_expert_agg_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="12585" cy="-3183" rx="85" ry="37.5"/>
<text text-anchor="middle" x="12585" y="-3194.3" font-family="Times,serif" font-size="14.00">L3 Expert Agg</text>
<text text-anchor="middle" x="12585" y="-3179.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12585" y="-3164.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1381" class="edge">
<title>l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M11754.36,-3293.04C11824.05,-3281.93 11934.65,-3265.66 12031,-3257.5 12060.47,-3255 12538.82,-3256.53 12563,-3239.5 12566.82,-3236.81 12569.98,-3233.34 12572.59,-3229.46"/>
<polygon fill="black" stroke="black" points="12575.79,-3230.89 12577.47,-3220.43 12569.63,-3227.56 12575.79,-3230.89"/>
</g>
<!-- l3_expert_agg_gpu12 -->
<g id="node982" class="node">
<title>l3_expert_agg_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14841" cy="-3183" rx="85" ry="37.5"/>
<text text-anchor="middle" x="14841" y="-3194.3" font-family="Times,serif" font-size="14.00">L3 Expert Agg</text>
<text text-anchor="middle" x="14841" y="-3179.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14841" y="-3164.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1382" class="edge">
<title>l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M11753.99,-3292.53C11823.63,-3280.99 11934.4,-3264.36 12031,-3257.5 12107.28,-3252.08 14713.25,-3268.52 14784,-3239.5 14791.99,-3236.22 14799.48,-3231.23 14806.23,-3225.57"/>
<polygon fill="black" stroke="black" points="14808.77,-3227.99 14813.81,-3218.66 14804.06,-3222.81 14808.77,-3227.99"/>
</g>
<!-- l3_expert_agg_gpu13 -->
<g id="node983" class="node">
<title>l3_expert_agg_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13149" cy="-3183" rx="85" ry="37.5"/>
<text text-anchor="middle" x="13149" y="-3194.3" font-family="Times,serif" font-size="14.00">L3 Expert Agg</text>
<text text-anchor="middle" x="13149" y="-3179.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13149" y="-3164.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1383" class="edge">
<title>l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M11754,-3292.74C11823.65,-3281.36 11934.43,-3264.85 12031,-3257.5 12060.95,-3255.22 13085.64,-3253.89 13112,-3239.5 13117.27,-3236.62 13121.93,-3232.63 13126,-3228.09"/>
<polygon fill="black" stroke="black" points="13128.9,-3230.08 13132.31,-3220.05 13123.39,-3225.76 13128.9,-3230.08"/>
</g>
<!-- l3_expert_agg_gpu14 -->
<g id="node984" class="node">
<title>l3_expert_agg_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="13713" cy="-3183" rx="85" ry="37.5"/>
<text text-anchor="middle" x="13713" y="-3194.3" font-family="Times,serif" font-size="14.00">L3 Expert Agg</text>
<text text-anchor="middle" x="13713" y="-3179.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13713" y="-3164.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1384" class="edge">
<title>l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M11753.99,-3292.62C11823.64,-3281.15 11934.41,-3264.57 12031,-3257.5 12076.58,-3254.16 13635.83,-3261.28 13676,-3239.5 13681.35,-3236.6 13686.06,-3232.55 13690.17,-3227.95"/>
<polygon fill="black" stroke="black" points="13693.14,-3229.83 13696.53,-3219.79 13687.62,-3225.53 13693.14,-3229.83"/>
</g>
<!-- l3_expert_agg_gpu15 -->
<g id="node985" class="node">
<title>l3_expert_agg_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="13337" cy="-3183" rx="85" ry="37.5"/>
<text text-anchor="middle" x="13337" y="-3194.3" font-family="Times,serif" font-size="14.00">L3 Expert Agg</text>
<text text-anchor="middle" x="13337" y="-3179.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13337" y="-3164.3" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1385" class="edge">
<title>l3_expert0_gpu0&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M11754,-3292.7C11823.65,-3281.3 11934.43,-3264.76 12031,-3257.5 12098.04,-3252.46 13176.2,-3257.4 13241,-3239.5 13256.07,-3235.34 13271.24,-3228.23 13284.93,-3220.47"/>
<polygon fill="black" stroke="black" points="13286.86,-3223.39 13293.7,-3215.29 13283.3,-3217.36 13286.86,-3223.39"/>
</g>
<!-- l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1395" class="edge">
<title>l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M12182.56,-3297.19C12288.03,-3286.45 12493.15,-3266.82 12668,-3257.5 12713.28,-3255.09 13443.74,-3260.37 13484,-3239.5 13489.72,-3236.53 13494.85,-3232.36 13499.38,-3227.62"/>
<polygon fill="black" stroke="black" points="13502.22,-3229.69 13506.01,-3219.8 13496.88,-3225.17 13502.22,-3229.69"/>
</g>
<!-- l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1396" class="edge">
<title>l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M12182.54,-3296.95C12288.01,-3285.91 12493.1,-3265.89 12668,-3257.5 12711.62,-3255.41 14201.62,-3260.33 14240,-3239.5 14245.28,-3236.63 14249.94,-3232.65 14254.02,-3228.12"/>
<polygon fill="black" stroke="black" points="14256.91,-3230.1 14260.33,-3220.08 14251.4,-3225.78 14256.91,-3230.1"/>
</g>
<!-- l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1397" class="edge">
<title>l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M12179.59,-3289.56C12221.61,-3278.78 12276.02,-3262.14 12321,-3239.5 12330.61,-3234.66 12340.3,-3228.64 12349.4,-3222.37"/>
<polygon fill="black" stroke="black" points="12351.45,-3225.21 12357.57,-3216.56 12347.39,-3219.5 12351.45,-3225.21"/>
</g>
<!-- l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1398" class="edge">
<title>l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M12182.54,-3296.9C12288,-3285.8 12493.09,-3265.71 12668,-3257.5 12721.78,-3254.98 14557.26,-3262.37 14606,-3239.5 14612.6,-3236.4 14618.62,-3231.88 14623.97,-3226.73"/>
<polygon fill="black" stroke="black" points="14626.57,-3229.08 14630.86,-3219.39 14621.47,-3224.29 14626.57,-3229.08"/>
</g>
<!-- l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1399" class="edge">
<title>l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M12182.55,-3297.02C12288.01,-3286.08 12493.12,-3266.19 12668,-3257.5 12701.57,-3255.83 13850.19,-3258.38 13878,-3239.5 13881.89,-3236.86 13885.13,-3233.42 13887.81,-3229.56"/>
<polygon fill="black" stroke="black" points="13891.03,-3230.99 13892.87,-3220.55 13884.92,-3227.56 13891.03,-3230.99"/>
</g>
<!-- l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1400" class="edge">
<title>l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M12058.72,-3273.46C12046.81,-3264.04 12035.5,-3252.64 12028,-3239.5 12026.36,-3236.63 12025.04,-3233.55 12023.97,-3230.35"/>
<polygon fill="black" stroke="black" points="12027.34,-3229.38 12021.49,-3220.55 12020.55,-3231.11 12027.34,-3229.38"/>
</g>
<!-- l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1401" class="edge">
<title>l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M12182.54,-3296.92C12288,-3285.84 12493.1,-3265.79 12668,-3257.5 12716.84,-3255.19 14385.01,-3262.79 14428,-3239.5 14433.35,-3236.6 14438.06,-3232.56 14442.17,-3227.96"/>
<polygon fill="black" stroke="black" points="14445.14,-3229.84 14448.53,-3219.8 14439.62,-3225.53 14445.14,-3229.84"/>
</g>
<!-- l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1402" class="edge">
<title>l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M12182.55,-3296.98C12288.01,-3285.98 12493.11,-3266.02 12668,-3257.5 12706.62,-3255.62 14027.06,-3259.75 14060,-3239.5 14064.52,-3236.72 14068.36,-3232.99 14071.63,-3228.77"/>
<polygon fill="black" stroke="black" points="14074.71,-3230.46 14077.23,-3220.17 14068.84,-3226.64 14074.71,-3230.46"/>
</g>
<!-- l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1403" class="edge">
<title>l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M12183.03,-3299.62C12346.58,-3287.92 12737.41,-3258.13 12759,-3239.5 12762.09,-3236.84 12764.54,-3233.6 12766.49,-3230.05"/>
<polygon fill="black" stroke="black" points="12769.77,-3231.28 12770.36,-3220.7 12763.3,-3228.6 12769.77,-3231.28"/>
</g>
<!-- l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1404" class="edge">
<title>l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M12183.06,-3298.14C12288.75,-3288.66 12493.64,-3270.65 12668,-3257.5 12698.2,-3255.22 12915.66,-3257.53 12940,-3239.5 12943.69,-3236.77 12946.72,-3233.31 12949.23,-3229.46"/>
<polygon fill="black" stroke="black" points="12952.37,-3231.01 12953.91,-3220.53 12946.17,-3227.77 12952.37,-3231.01"/>
</g>
<!-- l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1405" class="edge">
<title>l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M12165.11,-3273.09C12177.18,-3263.67 12188.84,-3252.37 12197,-3239.5 12198.79,-3236.67 12200.32,-3233.61 12201.63,-3230.44"/>
<polygon fill="black" stroke="black" points="12205.04,-3231.27 12204.9,-3220.67 12198.4,-3229.04 12205.04,-3231.27"/>
</g>
<!-- l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1406" class="edge">
<title>l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12183.49,-3304.01C12298.31,-3301.57 12516.56,-3290.18 12572,-3239.5 12575,-3236.76 12577.37,-3233.47 12579.23,-3229.89"/>
<polygon fill="black" stroke="black" points="12582.53,-3231.08 12582.91,-3220.49 12576.01,-3228.53 12582.53,-3231.08"/>
</g>
<!-- l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1407" class="edge">
<title>l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M12182.54,-3296.88C12288,-3285.75 12493.09,-3265.63 12668,-3257.5 12697.68,-3256.12 14781.14,-3254.13 14807,-3239.5 14811.98,-3236.68 14816.32,-3232.81 14820.08,-3228.41"/>
<polygon fill="black" stroke="black" points="14823.13,-3230.16 14826.23,-3220.03 14817.49,-3226.02 14823.13,-3230.16"/>
</g>
<!-- l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1408" class="edge">
<title>l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M12182.58,-3297.57C12288.08,-3287.33 12493.24,-3268.32 12668,-3257.5 12693.47,-3255.92 13106.18,-3254.25 13127,-3239.5 13130.81,-3236.8 13133.97,-3233.33 13136.57,-3229.44"/>
<polygon fill="black" stroke="black" points="13139.78,-3230.87 13141.45,-3220.4 13133.62,-3227.54 13139.78,-3230.87"/>
</g>
<!-- l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1409" class="edge">
<title>l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M12182.55,-3297.09C12288.02,-3286.22 12493.13,-3266.43 12668,-3257.5 12696.38,-3256.05 13667.63,-3255.68 13691,-3239.5 13694.84,-3236.84 13698.01,-3233.39 13700.63,-3229.52"/>
<polygon fill="black" stroke="black" points="13703.83,-3230.97 13705.52,-3220.51 13697.68,-3227.63 13703.83,-3230.97"/>
</g>
<!-- l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1410" class="edge">
<title>l3_expert1_gpu1&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M12182.57,-3297.39C12288.06,-3286.9 12493.19,-3267.59 12668,-3257.5 12732.7,-3253.76 13189.12,-3258.77 13251,-3239.5 13263.84,-3235.5 13276.61,-3229.01 13288.23,-3221.86"/>
<polygon fill="black" stroke="black" points="13290.36,-3224.65 13296.86,-3216.29 13286.56,-3218.76 13290.36,-3224.65"/>
</g>
<!-- l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1420" class="edge">
<title>l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M18059.55,-3302.49C17801.08,-3295.02 16890.44,-3269.44 16139,-3257.5 15158.2,-3241.91 14912.34,-3273.23 13932,-3239.5 13792.72,-3234.71 13755.14,-3250.3 13619,-3220.5 13610.61,-3218.66 13601.99,-3216.19 13593.53,-3213.39"/>
<polygon fill="black" stroke="black" points="13594.66,-3210.08 13584.06,-3210.11 13592.37,-3216.7 13594.66,-3210.08"/>
</g>
<!-- l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1421" class="edge">
<title>l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M18059.54,-3302.64C17801.07,-3295.64 16890.4,-3271.49 16139,-3257.5 15551.49,-3246.56 15404.38,-3256.01 14817,-3239.5 14618.68,-3233.93 14565.19,-3261.17 14371,-3220.5 14362.53,-3218.73 14353.84,-3216.28 14345.31,-3213.48"/>
<polygon fill="black" stroke="black" points="14346.37,-3210.15 14335.78,-3210.19 14344.09,-3216.76 14346.37,-3210.15"/>
</g>
<!-- l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1422" class="edge">
<title>l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M18059.55,-3302.42C17801.08,-3294.71 16890.45,-3268.41 16139,-3257.5 15397.96,-3246.74 13544.72,-3263.96 12804,-3239.5 12664.71,-3234.9 12627.14,-3250.3 12491,-3220.5 12482.61,-3218.66 12473.99,-3216.19 12465.53,-3213.39"/>
<polygon fill="black" stroke="black" points="12466.66,-3210.08 12456.06,-3210.11 12464.37,-3216.7 12466.66,-3210.08"/>
</g>
<!-- l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1423" class="edge">
<title>l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M18059.23,-3302.88C17571.99,-3291.33 14768.05,-3224.71 14747,-3220.5 14738.46,-3218.79 14729.68,-3216.36 14721.09,-3213.57"/>
<polygon fill="black" stroke="black" points="14722.08,-3210.21 14711.49,-3210.27 14719.81,-3216.83 14722.08,-3210.21"/>
</g>
<!-- l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1424" class="edge">
<title>l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M18059.54,-3302.54C17801.08,-3295.22 16890.43,-3270.09 16139,-3257.5 15328.85,-3243.93 15125.78,-3267.45 14316,-3239.5 14173.17,-3234.57 14134.63,-3250.96 13995,-3220.5 13986.61,-3218.67 13977.99,-3216.2 13969.53,-3213.41"/>
<polygon fill="black" stroke="black" points="13970.66,-3210.09 13960.06,-3210.13 13968.37,-3216.71 13970.66,-3210.09"/>
</g>
<!-- l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1425" class="edge">
<title>l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M18059.55,-3302.41C17801.09,-3294.65 16890.46,-3268.2 16139,-3257.5 15314.41,-3245.76 13252.23,-3266.49 12428,-3239.5 12358.35,-3237.22 12183.07,-3235.4 12115,-3220.5 12106.61,-3218.66 12097.99,-3216.19 12089.53,-3213.39"/>
<polygon fill="black" stroke="black" points="12090.66,-3210.08 12080.06,-3210.11 12088.37,-3216.7 12090.66,-3210.08"/>
</g>
<!-- l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1426" class="edge">
<title>l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M18059.54,-3302.89C17801.05,-3296.76 16890.32,-3275.18 16139,-3257.5 15963.44,-3253.37 14731.21,-3254.85 14559,-3220.5 14550.46,-3218.8 14541.68,-3216.37 14533.09,-3213.58"/>
<polygon fill="black" stroke="black" points="14534.08,-3210.22 14523.48,-3210.28 14531.81,-3216.84 14534.08,-3210.22"/>
</g>
<!-- l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1427" class="edge">
<title>l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M18059.54,-3302.56C17801.07,-3295.33 16890.42,-3270.45 16139,-3257.5 15400.84,-3244.78 15215.74,-3267.23 14478,-3239.5 14346.71,-3234.56 14311.29,-3248.83 14183,-3220.5 14174.62,-3218.65 14165.99,-3216.17 14157.53,-3213.36"/>
<polygon fill="black" stroke="black" points="14158.67,-3210.05 14148.07,-3210.08 14156.37,-3216.67 14158.67,-3210.05"/>
</g>
<!-- l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1428" class="edge">
<title>l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M18059.55,-3302.44C17801.08,-3294.79 16890.45,-3268.66 16139,-3257.5 15481.5,-3247.73 13837.2,-3261.43 13180,-3239.5 13040.71,-3234.85 13003.14,-3250.3 12867,-3220.5 12858.61,-3218.66 12849.99,-3216.19 12841.53,-3213.39"/>
<polygon fill="black" stroke="black" points="12842.66,-3210.08 12832.06,-3210.11 12840.37,-3216.7 12842.66,-3210.08"/>
</g>
<!-- l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1429" class="edge">
<title>l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M18059.55,-3302.45C17801.08,-3294.83 16890.45,-3268.82 16139,-3257.5 15523.28,-3248.22 13983.44,-3260.16 13368,-3239.5 13228.71,-3234.82 13191.14,-3250.3 13055,-3220.5 13046.61,-3218.66 13037.99,-3216.19 13029.53,-3213.39"/>
<polygon fill="black" stroke="black" points="13030.66,-3210.08 13020.06,-3210.11 13028.37,-3216.7 13030.66,-3210.08"/>
</g>
<!-- l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1430" class="edge">
<title>l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M18059.55,-3302.42C17801.09,-3294.68 16890.46,-3268.3 16139,-3257.5 15356.18,-3246.25 13398.48,-3265.23 12616,-3239.5 12476.71,-3234.92 12439.14,-3250.3 12303,-3220.5 12294.61,-3218.66 12285.99,-3216.19 12277.53,-3213.39"/>
<polygon fill="black" stroke="black" points="12278.66,-3210.08 12268.06,-3210.11 12276.37,-3216.7 12278.66,-3210.08"/>
</g>
<!-- l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1431" class="edge">
<title>l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M18059.55,-3302.43C17801.08,-3294.75 16890.45,-3268.53 16139,-3257.5 15439.73,-3247.24 13690.96,-3262.7 12992,-3239.5 12852.71,-3234.88 12815.14,-3250.3 12679,-3220.5 12670.61,-3218.66 12661.99,-3216.19 12653.53,-3213.39"/>
<polygon fill="black" stroke="black" points="12654.66,-3210.08 12644.06,-3210.11 12652.37,-3216.7 12654.66,-3210.08"/>
</g>
<!-- l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1432" class="edge">
<title>l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M18059.86,-3300.51C17860.67,-3289.23 17280.46,-3257.17 16798,-3238.5 16082.57,-3210.81 15219.49,-3191.79 14936.14,-3185.92"/>
<polygon fill="black" stroke="black" points="14935.97,-3182.41 14925.9,-3185.71 14935.83,-3189.41 14935.97,-3182.41"/>
</g>
<!-- l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1433" class="edge">
<title>l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M18059.55,-3302.46C17801.08,-3294.89 16890.44,-3269 16139,-3257.5 15565.05,-3248.72 14129.69,-3258.9 13556,-3239.5 13416.71,-3234.79 13379.14,-3250.3 13243,-3220.5 13234.61,-3218.66 13225.99,-3216.19 13217.53,-3213.39"/>
<polygon fill="black" stroke="black" points="13218.66,-3210.08 13208.06,-3210.11 13216.37,-3216.7 13218.66,-3210.08"/>
</g>
<!-- l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1434" class="edge">
<title>l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M18059.55,-3302.51C17801.08,-3295.11 16890.43,-3269.73 16139,-3257.5 15240.86,-3242.89 15015.71,-3270.9 14118,-3239.5 13979.6,-3234.66 13942.27,-3250.14 13807,-3220.5 13798.61,-3218.66 13789.99,-3216.19 13781.53,-3213.39"/>
<polygon fill="black" stroke="black" points="13782.66,-3210.08 13772.07,-3210.11 13780.37,-3216.69 13782.66,-3210.08"/>
</g>
<!-- l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1435" class="edge">
<title>l3_expert2_gpu2&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M18059.55,-3302.48C17801.08,-3294.95 16890.44,-3269.2 16139,-3257.5 15074.65,-3240.92 14807.86,-3275.76 13744,-3239.5 13604.71,-3234.75 13567.14,-3250.3 13431,-3220.5 13422.61,-3218.66 13413.99,-3216.19 13405.53,-3213.39"/>
<polygon fill="black" stroke="black" points="13406.66,-3210.08 13396.06,-3210.11 13404.37,-3216.7 13406.66,-3210.08"/>
</g>
<!-- l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1445" class="edge">
<title>l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M12820.63,-3302.89C12999.26,-3298.03 13453.97,-3281.64 13507,-3239.5 13510.39,-3236.81 13513.15,-3233.46 13515.4,-3229.77"/>
<polygon fill="black" stroke="black" points="13518.61,-3231.16 13519.76,-3220.63 13512.29,-3228.14 13518.61,-3231.16"/>
</g>
<!-- l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1446" class="edge">
<title>l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M12820.28,-3301.46C12993.53,-3293.88 13450.55,-3273.91 13832,-3257.5 13855.5,-3256.49 14235.83,-3253.13 14255,-3239.5 14258.81,-3236.79 14261.96,-3233.32 14264.56,-3229.43"/>
<polygon fill="black" stroke="black" points="14267.77,-3230.85 14269.44,-3220.39 14261.61,-3227.53 14267.77,-3230.85"/>
</g>
<!-- l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1447" class="edge">
<title>l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M12678.32,-3297.29C12619.22,-3289.12 12533.92,-3272.45 12466,-3239.5 12457.08,-3235.17 12448.27,-3229.5 12440.09,-3223.44"/>
<polygon fill="black" stroke="black" points="12442.19,-3220.63 12432.13,-3217.28 12437.9,-3226.17 12442.19,-3220.63"/>
</g>
<!-- l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1448" class="edge">
<title>l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M12820.26,-3300.97C12993.47,-3292.3 13450.4,-3270.1 13832,-3257.5 13854.16,-3256.77 14611.7,-3252.02 14630,-3239.5 14633.88,-3236.84 14637.11,-3233.4 14639.79,-3229.53"/>
<polygon fill="black" stroke="black" points="14643.01,-3230.95 14644.84,-3220.52 14636.9,-3227.53 14643.01,-3230.95"/>
</g>
<!-- l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1449" class="edge">
<title>l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M12820.73,-3302.83C13064.34,-3296.59 13847.06,-3273.91 13888,-3239.5 13891.15,-3236.85 13893.62,-3233.6 13895.54,-3230.02"/>
<polygon fill="black" stroke="black" points="13898.86,-3231.14 13899.3,-3220.55 13892.36,-3228.56 13898.86,-3231.14"/>
</g>
<!-- l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1450" class="edge">
<title>l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M12678.2,-3298.56C12506.19,-3283.83 12079.4,-3246.69 12066,-3239.5 12059.98,-3236.27 12054.46,-3231.86 12049.52,-3226.93"/>
<polygon fill="black" stroke="black" points="12052,-3224.45 12042.68,-3219.4 12046.81,-3229.16 12052,-3224.45"/>
</g>
<!-- l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1451" class="edge">
<title>l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M12820.27,-3301.14C12993.49,-3292.84 13450.45,-3271.41 13832,-3257.5 13865.94,-3256.26 14415.19,-3258.99 14443,-3239.5 14446.83,-3236.82 14449.99,-3233.36 14452.6,-3229.48"/>
<polygon fill="black" stroke="black" points="14455.8,-3230.91 14457.48,-3220.45 14449.65,-3227.58 14455.8,-3230.91"/>
</g>
<!-- l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1452" class="edge">
<title>l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M12820.67,-3301.59C13094.15,-3290.09 14057.41,-3248.98 14070,-3239.5 14073.52,-3236.85 14076.4,-3233.5 14078.75,-3229.78"/>
<polygon fill="black" stroke="black" points="14082.02,-3231.06 14083.31,-3220.54 14075.74,-3227.95 14082.02,-3231.06"/>
</g>
<!-- l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1453" class="edge">
<title>l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M12762.81,-3258.23C12764.38,-3251.97 12765.83,-3245.6 12767,-3239.5 12767.55,-3236.64 12768.05,-3233.7 12768.5,-3230.71"/>
<polygon fill="black" stroke="black" points="12772.01,-3230.93 12769.9,-3220.55 12765.07,-3229.98 12772.01,-3230.93"/>
</g>
<!-- l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1454" class="edge">
<title>l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M12820.04,-3298.62C12862.88,-3291.3 12915.32,-3275.12 12948,-3239.5 12950.56,-3236.71 12952.64,-3233.52 12954.34,-3230.1"/>
<polygon fill="black" stroke="black" points="12957.64,-3231.25 12957.97,-3220.66 12951.11,-3228.74 12957.64,-3231.25"/>
</g>
<!-- l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1455" class="edge">
<title>l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M12677.52,-3302.65C12556,-3298.19 12315.46,-3283.86 12245,-3239.5 12240.2,-3236.48 12235.91,-3232.56 12232.12,-3228.2"/>
<polygon fill="black" stroke="black" points="12234.68,-3225.78 12225.82,-3219.97 12229.12,-3230.04 12234.68,-3225.78"/>
</g>
<!-- l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1456" class="edge">
<title>l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M12698.09,-3271.29C12683.35,-3261.33 12667.37,-3250.2 12653,-3239.5 12646.06,-3234.33 12638.85,-3228.73 12631.84,-3223.13"/>
<polygon fill="black" stroke="black" points="12633.71,-3220.14 12623.72,-3216.59 12629.32,-3225.59 12633.71,-3220.14"/>
</g>
<!-- l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1457" class="edge">
<title>l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M12820.26,-3300.86C12993.46,-3291.95 13450.37,-3269.26 13832,-3257.5 13859.49,-3256.65 14799.77,-3255.69 14822,-3239.5 14825.57,-3236.9 14828.47,-3233.6 14830.83,-3229.89"/>
<polygon fill="black" stroke="black" points="14834.09,-3231.2 14835.42,-3220.68 14827.83,-3228.07 14834.09,-3231.2"/>
</g>
<!-- l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1458" class="edge">
<title>l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M12820.49,-3301.81C12919.57,-3296.46 13091.47,-3281.29 13136,-3239.5 13138.84,-3236.84 13141.11,-3233.68 13142.92,-3230.25"/>
<polygon fill="black" stroke="black" points="13146.29,-3231.26 13146.73,-3220.67 13139.78,-3228.67 13146.29,-3231.26"/>
</g>
<!-- l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1459" class="edge">
<title>l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M12820.78,-3304.56C13031.03,-3303.81 13634.9,-3296.66 13701,-3239.5 13704.06,-3236.85 13706.44,-3233.63 13708.3,-3230.09"/>
<polygon fill="black" stroke="black" points="13711.56,-3231.34 13711.87,-3220.75 13705.03,-3228.83 13711.56,-3231.34"/>
</g>
<!-- l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1460" class="edge">
<title>l3_expert3_gpu3&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M12820.17,-3299.94C12941.38,-3291.3 13182.42,-3270.76 13261,-3239.5 13271.57,-3235.3 13282.01,-3229.27 13291.61,-3222.74"/>
<polygon fill="black" stroke="black" points="13293.7,-3225.54 13299.81,-3216.89 13289.64,-3219.84 13293.7,-3225.54"/>
</g>
<!-- l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1470" class="edge">
<title>l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M10081.48,-3302.09C10305.8,-3294.36 11015.82,-3270.51 11604,-3257.5 12147.93,-3245.47 12284.09,-3252.07 12828,-3239.5 13096.06,-3233.31 13168.26,-3274.02 13431,-3220.5 13439.54,-3218.76 13448.31,-3216.32 13456.9,-3213.51"/>
<polygon fill="black" stroke="black" points="13458.18,-3216.77 13466.5,-3210.21 13455.9,-3210.15 13458.18,-3216.77"/>
</g>
<!-- l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1471" class="edge">
<title>l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10081.48,-3301.95C10305.79,-3293.8 11015.79,-3268.86 11604,-3257.5 12482.54,-3240.53 12702.48,-3257.36 13581,-3239.5 13848.63,-3234.06 13920.7,-3273.93 14183,-3220.5 14191.54,-3218.76 14200.31,-3216.32 14208.9,-3213.51"/>
<polygon fill="black" stroke="black" points="14210.18,-3216.77 14218.5,-3210.21 14207.9,-3210.15 14210.18,-3216.77"/>
</g>
<!-- l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1472" class="edge">
<title>l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M10081.35,-3302.17C10325.92,-3293.87 11152.9,-3265.57 11836,-3239.5 12043.58,-3231.58 12099.64,-3262.89 12303,-3220.5 12311.47,-3218.73 12320.17,-3216.29 12328.7,-3213.5"/>
<polygon fill="black" stroke="black" points="12329.92,-3216.78 12338.23,-3210.21 12327.63,-3210.16 12329.92,-3216.78"/>
</g>
<!-- l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1473" class="edge">
<title>l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M10081.48,-3301.91C10305.78,-3293.66 11015.78,-3268.44 11604,-3257.5 12649.63,-3238.06 12911.39,-3260 13957,-3239.5 14224.64,-3234.25 14296.7,-3273.93 14559,-3220.5 14567.54,-3218.76 14576.31,-3216.32 14584.9,-3213.51"/>
<polygon fill="black" stroke="black" points="14586.18,-3216.77 14594.5,-3210.21 14583.9,-3210.15 14586.18,-3216.77"/>
</g>
<!-- l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1474" class="edge">
<title>l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M10081.48,-3302.01C10305.79,-3294.02 11015.8,-3269.49 11604,-3257.5 12315.45,-3242.99 12493.56,-3254.72 13205,-3239.5 13472.63,-3233.77 13544.7,-3273.93 13807,-3220.5 13815.54,-3218.76 13824.31,-3216.32 13832.9,-3213.51"/>
<polygon fill="black" stroke="black" points="13834.18,-3216.77 13842.5,-3210.21 13831.9,-3210.15 13834.18,-3216.77"/>
</g>
<!-- l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1475" class="edge">
<title>l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M10081.28,-3300.31C10386.17,-3282.03 11580.83,-3210.39 11926.7,-3189.65"/>
<polygon fill="black" stroke="black" points="11927.16,-3193.13 11936.93,-3189.04 11926.74,-3186.15 11927.16,-3193.13"/>
</g>
<!-- l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1476" class="edge">
<title>l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M10081.48,-3301.94C10305.79,-3293.78 11015.79,-3268.79 11604,-3257.5 12507.42,-3240.16 12733.55,-3255.19 13637,-3239.5 13963.28,-3233.83 14051.05,-3284.73 14371,-3220.5 14379.54,-3218.78 14388.32,-3216.36 14396.91,-3213.56"/>
<polygon fill="black" stroke="black" points="14398.19,-3216.82 14406.51,-3210.26 14395.92,-3210.2 14398.19,-3216.82"/>
</g>
<!-- l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1477" class="edge">
<title>l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M10081.48,-3302C10305.79,-3293.98 11015.8,-3269.38 11604,-3257.5 12340.34,-3242.63 12524.64,-3253.03 13261,-3239.5 13587.28,-3233.5 13675.05,-3284.73 13995,-3220.5 14003.54,-3218.78 14012.32,-3216.36 14020.91,-3213.56"/>
<polygon fill="black" stroke="black" points="14022.19,-3216.82 14030.51,-3210.26 14019.92,-3210.2 14022.19,-3216.82"/>
</g>
<!-- l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1478" class="edge">
<title>l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M10081.56,-3302.47C10453.07,-3291.48 12146.83,-3241.38 12201,-3239.5 12413.48,-3232.12 12470.84,-3263.79 12679,-3220.5 12687.47,-3218.74 12696.17,-3216.3 12704.7,-3213.5"/>
<polygon fill="black" stroke="black" points="12705.92,-3216.79 12714.23,-3210.22 12703.64,-3210.17 12705.92,-3216.79"/>
</g>
<!-- l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1479" class="edge">
<title>l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10081.49,-3302.31C10305.82,-3295.19 11015.88,-3272.95 11604,-3257.5 11951.53,-3248.37 12038.52,-3250.36 12386,-3239.5 12599.84,-3232.82 12657.53,-3264.04 12867,-3220.5 12875.47,-3218.74 12884.17,-3216.3 12892.7,-3213.51"/>
<polygon fill="black" stroke="black" points="12893.92,-3216.79 12902.23,-3210.22 12891.64,-3210.17 12893.92,-3216.79"/>
</g>
<!-- l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1480" class="edge">
<title>l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M10081.6,-3302.39C10438.62,-3291.35 12013.45,-3241.63 12115,-3220.5 12123.47,-3218.74 12132.17,-3216.3 12140.7,-3213.5"/>
<polygon fill="black" stroke="black" points="12141.92,-3216.79 12150.23,-3210.22 12139.64,-3210.17 12141.92,-3216.79"/>
</g>
<!-- l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1481" class="edge">
<title>l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M10081.56,-3302.46C10341.41,-3294.71 11259.68,-3266.96 12017,-3239.5 12227.7,-3231.86 12284.59,-3263.46 12491,-3220.5 12499.47,-3218.74 12508.17,-3216.3 12516.7,-3213.5"/>
<polygon fill="black" stroke="black" points="12517.92,-3216.78 12526.23,-3210.22 12515.64,-3210.17 12517.92,-3216.78"/>
</g>
<!-- l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1482" class="edge">
<title>l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M10081.48,-3301.91C10305.78,-3293.64 11015.78,-3268.39 11604,-3257.5 12671.85,-3237.73 12939.12,-3257.21 14007,-3239.5 14335.95,-3234.04 14424.43,-3285.22 14747,-3220.5 14755.54,-3218.79 14764.32,-3216.36 14772.91,-3213.56"/>
<polygon fill="black" stroke="black" points="14774.19,-3216.82 14782.51,-3210.26 14771.92,-3210.2 14774.19,-3216.82"/>
</g>
<!-- l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1483" class="edge">
<title>l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M10081.49,-3302.19C10305.81,-3294.74 11015.85,-3271.63 11604,-3257.5 12036.39,-3247.11 12144.66,-3252.09 12577,-3239.5 12789.52,-3233.31 12846.84,-3263.79 13055,-3220.5 13063.47,-3218.74 13072.17,-3216.3 13080.7,-3213.5"/>
<polygon fill="black" stroke="black" points="13081.92,-3216.79 13090.23,-3210.22 13079.64,-3210.17 13081.92,-3216.79"/>
</g>
<!-- l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1484" class="edge">
<title>l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M10081.48,-3302.08C10305.8,-3294.3 11015.82,-3270.32 11604,-3257.5 12173.25,-3245.09 12315.72,-3250.87 12885,-3239.5 13211.27,-3232.98 13299.05,-3284.73 13619,-3220.5 13627.54,-3218.78 13636.32,-3216.36 13644.91,-3213.56"/>
<polygon fill="black" stroke="black" points="13646.19,-3216.82 13654.51,-3210.26 13643.92,-3210.2 13646.19,-3216.82"/>
</g>
<!-- l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1485" class="edge">
<title>l3_expert4_gpu4&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M10081.48,-3302.11C10305.8,-3294.44 11015.83,-3270.74 11604,-3257.5 12120.82,-3245.87 12250.25,-3253.81 12767,-3239.5 12978.64,-3233.64 13035.72,-3263.63 13243,-3220.5 13251.47,-3218.74 13260.17,-3216.3 13268.7,-3213.5"/>
<polygon fill="black" stroke="black" points="13269.92,-3216.79 13278.23,-3210.22 13267.64,-3210.17 13269.92,-3216.79"/>
</g>
<!-- l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1495" class="edge">
<title>l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M13841.85,-3299.75C13775.13,-3293.02 13673.93,-3277.06 13594,-3239.5 13585.03,-3235.28 13576.19,-3229.67 13568,-3223.63"/>
<polygon fill="black" stroke="black" points="13570.1,-3220.82 13560.04,-3217.48 13565.82,-3226.36 13570.1,-3220.82"/>
</g>
<!-- l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1496" class="edge">
<title>l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M13984.31,-3300.56C14075.38,-3293.92 14225.92,-3277.42 14265,-3239.5 14267.78,-3236.8 14269.99,-3233.62 14271.74,-3230.17"/>
<polygon fill="black" stroke="black" points="14275.11,-3231.16 14275.37,-3220.57 14268.56,-3228.69 14275.11,-3231.16"/>
</g>
<!-- l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1497" class="edge">
<title>l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M13841.73,-3301.49C13557.86,-3289.13 12522.32,-3243.82 12506,-3239.5 12488.5,-3234.87 12470.56,-3227.17 12454.42,-3218.95"/>
<polygon fill="black" stroke="black" points="12455.62,-3215.63 12445.14,-3214.08 12452.37,-3221.83 12455.62,-3215.63"/>
</g>
<!-- l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1498" class="edge">
<title>l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M13984.67,-3303.24C14159.87,-3299.25 14599,-3284.8 14646,-3239.5 14648.75,-3236.85 14650.82,-3233.71 14652.35,-3230.28"/>
<polygon fill="black" stroke="black" points="14655.7,-3231.29 14655.26,-3220.71 14649.01,-3229.26 14655.7,-3231.29"/>
</g>
<!-- l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1499" class="edge">
<title>l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M13908.29,-3257.27C13907.42,-3248.55 13906.52,-3239.44 13905.65,-3230.73"/>
<polygon fill="black" stroke="black" points="13909.13,-3230.34 13904.66,-3220.74 13902.16,-3231.03 13909.13,-3230.34"/>
</g>
<!-- l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1500" class="edge">
<title>l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M13841.67,-3301.01C13668.3,-3292.44 13210.94,-3270.44 12829,-3257.5 12787.9,-3256.11 12127.57,-3253.77 12089,-3239.5 12079.25,-3235.89 12069.87,-3230.27 12061.36,-3223.96"/>
<polygon fill="black" stroke="black" points="12063.49,-3221.18 12053.47,-3217.74 12059.16,-3226.68 12063.49,-3221.18"/>
</g>
<!-- l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1501" class="edge">
<title>l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M13984.31,-3300.56C14123.09,-3292.06 14418.95,-3270.52 14453,-3239.5 14455.99,-3236.78 14458.33,-3233.5 14460.15,-3229.92"/>
<polygon fill="black" stroke="black" points="14463.44,-3231.12 14463.68,-3220.53 14456.88,-3228.66 14463.44,-3231.12"/>
</g>
<!-- l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1502" class="edge">
<title>l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M13982.35,-3293.24C14015.96,-3284.21 14054.13,-3268.11 14078,-3239.5 14080.3,-3236.74 14082.17,-3233.63 14083.69,-3230.34"/>
<polygon fill="black" stroke="black" points="14087.07,-3231.27 14087.07,-3220.67 14080.46,-3228.95 14087.07,-3231.27"/>
</g>
<!-- l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1503" class="edge">
<title>l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M13841.34,-3304.15C13637.27,-3302.28 13056.03,-3292.34 12874,-3239.5 12858.17,-3234.9 12842.06,-3227.52 12827.5,-3219.61"/>
<polygon fill="black" stroke="black" points="12829.09,-3216.49 12818.65,-3214.64 12825.66,-3222.59 12829.09,-3216.49"/>
</g>
<!-- l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1504" class="edge">
<title>l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M13841.52,-3303.15C13638.61,-3298.56 13069.04,-3282.01 12997,-3239.5 12991.93,-3236.51 12987.45,-3232.49 12983.52,-3227.98"/>
<polygon fill="black" stroke="black" points="12986.28,-3225.83 12977.43,-3220.01 12980.72,-3230.08 12986.28,-3225.83"/>
</g>
<!-- l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1505" class="edge">
<title>l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M13841.67,-3301.2C13668.28,-3293.05 13210.89,-3271.92 12829,-3257.5 12766.68,-3255.15 12325.6,-3263.41 12268,-3239.5 12259.88,-3236.13 12252.2,-3231.09 12245.24,-3225.41"/>
<polygon fill="black" stroke="black" points="12247.23,-3222.49 12237.42,-3218.49 12242.59,-3227.74 12247.23,-3222.49"/>
</g>
<!-- l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1506" class="edge">
<title>l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M13841.48,-3302.51C13597.01,-3295.2 12803.63,-3269.4 12693,-3239.5 12675.73,-3234.83 12658.05,-3227.16 12642.12,-3218.99"/>
<polygon fill="black" stroke="black" points="12643.44,-3215.73 12632.96,-3214.14 12640.16,-3221.92 12643.44,-3215.73"/>
</g>
<!-- l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1507" class="edge">
<title>l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M13984.61,-3304.52C14189.94,-3303.67 14769.94,-3296.21 14832,-3239.5 14834.87,-3236.88 14837.07,-3233.72 14838.73,-3230.27"/>
<polygon fill="black" stroke="black" points="14842.11,-3231.19 14841.97,-3220.59 14835.47,-3228.96 14842.11,-3231.19"/>
</g>
<!-- l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1508" class="edge">
<title>l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M13841.64,-3301.74C13669.28,-3294.37 13240.4,-3272.88 13185,-3239.5 13179.96,-3236.46 13175.49,-3232.42 13171.57,-3227.89"/>
<polygon fill="black" stroke="black" points="13174.34,-3225.74 13165.49,-3219.9 13168.77,-3229.98 13174.34,-3225.74"/>
</g>
<!-- l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1509" class="edge">
<title>l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M13853.81,-3278.52C13830.78,-3267.53 13804.57,-3253.94 13782,-3239.5 13774.2,-3234.51 13766.25,-3228.8 13758.66,-3222.98"/>
<polygon fill="black" stroke="black" points="13760.61,-3220.06 13750.58,-3216.65 13756.29,-3225.57 13760.61,-3220.06"/>
</g>
<!-- l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1510" class="edge">
<title>l3_expert5_gpu5&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M13841.89,-3300.23C13721.47,-3292.07 13482.96,-3272.27 13406,-3239.5 13396.66,-3235.52 13387.56,-3229.91 13379.18,-3223.77"/>
<polygon fill="black" stroke="black" points="13381.11,-3220.84 13371.06,-3217.49 13376.83,-3226.37 13381.11,-3220.84"/>
</g>
<!-- l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1520" class="edge">
<title>l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M15987.69,-3300.16C15830.76,-3290.62 15443.58,-3268.09 15119,-3257.5 14592.55,-3240.32 14460.35,-3259.36 13934,-3239.5 13793.85,-3234.21 13756.02,-3250.47 13619,-3220.5 13610.61,-3218.67 13601.99,-3216.19 13593.53,-3213.4"/>
<polygon fill="black" stroke="black" points="13594.66,-3210.09 13584.06,-3210.12 13592.37,-3216.7 13594.66,-3210.09"/>
</g>
<!-- l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1521" class="edge">
<title>l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M15987.66,-3300.99C15830.65,-3293.1 15443.35,-3273.64 15119,-3257.5 14952.78,-3249.23 14533.77,-3255.18 14371,-3220.5 14362.54,-3218.7 14353.85,-3216.23 14345.32,-3213.42"/>
<polygon fill="black" stroke="black" points="14346.38,-3210.09 14335.79,-3210.13 14344.1,-3216.7 14346.38,-3210.09"/>
</g>
<!-- l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1522" class="edge">
<title>l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M15987.7,-3299.98C15830.77,-3290.08 15443.62,-3266.89 15119,-3257.5 14090.95,-3227.77 13832.88,-3274.57 12805,-3239.5 12665.27,-3234.73 12627.58,-3250.38 12491,-3220.5 12482.61,-3218.66 12473.99,-3216.19 12465.53,-3213.4"/>
<polygon fill="black" stroke="black" points="12466.66,-3210.08 12456.06,-3210.12 12464.37,-3216.7 12466.66,-3210.08"/>
</g>
<!-- l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1523" class="edge">
<title>l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M15987.57,-3301.28C15731.49,-3289.29 14868.26,-3247.26 14747,-3220.5 14738.62,-3218.65 14729.99,-3216.17 14721.53,-3213.37"/>
<polygon fill="black" stroke="black" points="14722.67,-3210.05 14712.07,-3210.08 14720.37,-3216.67 14722.67,-3210.05"/>
</g>
<!-- l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1524" class="edge">
<title>l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M15987.69,-3300.33C15830.74,-3291.12 15443.54,-3269.22 15119,-3257.5 14758.26,-3244.47 14667.67,-3254.47 14307,-3239.5 14168.2,-3233.74 14130.71,-3250.22 13995,-3220.5 13986.61,-3218.66 13977.99,-3216.19 13969.53,-3213.39"/>
<polygon fill="black" stroke="black" points="13970.66,-3210.08 13960.07,-3210.11 13968.37,-3216.69 13970.66,-3210.08"/>
</g>
<!-- l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1525" class="edge">
<title>l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M15987.7,-3299.95C15830.77,-3290 15443.62,-3266.71 15119,-3257.5 13923.9,-3223.59 13623.91,-3279.62 12429,-3239.5 12289.27,-3234.81 12251.58,-3250.38 12115,-3220.5 12106.61,-3218.66 12097.99,-3216.19 12089.53,-3213.4"/>
<polygon fill="black" stroke="black" points="12090.66,-3210.08 12080.06,-3210.12 12088.37,-3216.7 12090.66,-3210.08"/>
</g>
<!-- l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1526" class="edge">
<title>l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M15987.53,-3300.88C15693.94,-3285.64 14594.33,-3228.15 14559,-3220.5 14550.61,-3218.68 14541.98,-3216.22 14533.52,-3213.43"/>
<polygon fill="black" stroke="black" points="14534.65,-3210.12 14524.06,-3210.16 14532.36,-3216.74 14534.65,-3210.12"/>
</g>
<!-- l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1527" class="edge">
<title>l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M15987.68,-3300.52C15830.72,-3291.7 15443.49,-3270.52 15119,-3257.5 14853.76,-3246.86 14787.21,-3250.93 14522,-3239.5 14371.24,-3233 14330.49,-3252.43 14183,-3220.5 14174.61,-3218.68 14165.98,-3216.22 14157.52,-3213.43"/>
<polygon fill="black" stroke="black" points="14158.65,-3210.12 14148.06,-3210.16 14156.36,-3216.74 14158.65,-3210.12"/>
</g>
<!-- l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1528" class="edge">
<title>l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M15987.7,-3300.02C15830.77,-3290.19 15443.61,-3267.13 15119,-3257.5 14258.01,-3231.95 14041.85,-3269.52 13181,-3239.5 13041.27,-3234.63 13003.58,-3250.38 12867,-3220.5 12858.61,-3218.66 12849.99,-3216.19 12841.53,-3213.4"/>
<polygon fill="black" stroke="black" points="12842.66,-3210.08 12832.06,-3210.12 12840.37,-3216.7 12842.66,-3210.08"/>
</g>
<!-- l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1529" class="edge">
<title>l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M15987.7,-3300.04C15830.77,-3290.26 15443.61,-3267.29 15119,-3257.5 14341.53,-3234.04 14146.33,-3267 13369,-3239.5 13229.28,-3234.56 13191.58,-3250.38 13055,-3220.5 13046.61,-3218.66 13037.99,-3216.19 13029.53,-3213.4"/>
<polygon fill="black" stroke="black" points="13030.66,-3210.08 13020.06,-3210.12 13028.37,-3216.7 13030.66,-3210.08"/>
</g>
<!-- l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1530" class="edge">
<title>l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M15987.7,-3299.97C15830.77,-3290.04 15443.62,-3266.79 15119,-3257.5 14007.43,-3225.68 13728.39,-3277.1 12617,-3239.5 12477.27,-3234.77 12439.58,-3250.38 12303,-3220.5 12294.61,-3218.66 12285.99,-3216.19 12277.53,-3213.4"/>
<polygon fill="black" stroke="black" points="12278.66,-3210.08 12268.06,-3210.12 12276.37,-3216.7 12278.66,-3210.08"/>
</g>
<!-- l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1531" class="edge">
<title>l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M15987.7,-3300C15830.77,-3290.13 15443.62,-3267 15119,-3257.5 14174.48,-3229.86 13937.36,-3272.05 12993,-3239.5 12853.27,-3234.68 12815.58,-3250.38 12679,-3220.5 12670.61,-3218.66 12661.99,-3216.19 12653.53,-3213.4"/>
<polygon fill="black" stroke="black" points="12654.66,-3210.08 12644.06,-3210.12 12652.37,-3216.7 12654.66,-3210.08"/>
</g>
<!-- l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1532" class="edge">
<title>l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M15988.25,-3297.58C15779.88,-3276.95 15168.45,-3216.42 14933.99,-3193.21"/>
<polygon fill="black" stroke="black" points="14934.08,-3189.7 14923.78,-3192.19 14933.39,-3196.66 14934.08,-3189.7"/>
</g>
<!-- l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1533" class="edge">
<title>l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M15987.7,-3300.07C15830.76,-3290.35 15443.6,-3267.5 15119,-3257.5 14425.06,-3236.13 14250.82,-3264.47 13557,-3239.5 13417.28,-3234.47 13379.58,-3250.38 13243,-3220.5 13234.61,-3218.66 13225.99,-3216.19 13217.53,-3213.4"/>
<polygon fill="black" stroke="black" points="13218.66,-3210.08 13208.06,-3210.12 13216.37,-3216.7 13218.66,-3210.08"/>
</g>
<!-- l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1534" class="edge">
<title>l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M15987.69,-3300.23C15830.75,-3290.83 15443.57,-3268.56 15119,-3257.5 14677.41,-3242.45 14566.52,-3256.68 14125,-3239.5 13983.52,-3233.99 13945.32,-3250.71 13807,-3220.5 13798.61,-3218.67 13789.99,-3216.2 13781.53,-3213.4"/>
<polygon fill="black" stroke="black" points="13782.66,-3210.09 13772.06,-3210.12 13780.37,-3216.7 13782.66,-3210.09"/>
</g>
<!-- l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1535" class="edge">
<title>l3_expert6_gpu6&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M15987.69,-3300.11C15830.76,-3290.46 15443.59,-3267.75 15119,-3257.5 14508.59,-3238.22 14355.31,-3261.95 13745,-3239.5 13605.28,-3234.36 13567.58,-3250.38 13431,-3220.5 13422.61,-3218.66 13413.99,-3216.19 13405.53,-3213.4"/>
<polygon fill="black" stroke="black" points="13406.66,-3210.08 13396.06,-3210.12 13404.37,-3216.7 13406.66,-3210.08"/>
</g>
<!-- l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu0 -->
<g id="edge1545" class="edge">
<title>l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M14967.37,-3301.37C14682.13,-3288.54 13642.15,-3241.65 13634,-3239.5 13616.5,-3234.87 13598.56,-3227.17 13582.42,-3218.95"/>
<polygon fill="black" stroke="black" points="13583.62,-3215.63 13573.14,-3214.07 13580.37,-3221.83 13583.62,-3215.63"/>
</g>
<!-- l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu1 -->
<g id="edge1546" class="edge">
<title>l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M14967.35,-3302.98C14813.87,-3298.73 14458.27,-3284.21 14347,-3239.5 14337.29,-3235.6 14327.84,-3229.9 14319.19,-3223.63"/>
<polygon fill="black" stroke="black" points="14321.22,-3220.77 14311.15,-3217.47 14316.96,-3226.33 14321.22,-3220.77"/>
</g>
<!-- l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu2 -->
<g id="edge1547" class="edge">
<title>l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M14967.69,-3300.57C14798.56,-3291.22 14359.82,-3268.01 13993,-3257.5 13911.69,-3255.17 12608.63,-3256.07 12529,-3239.5 12505.68,-3234.65 12481.32,-3225.65 12459.97,-3216.29"/>
<polygon fill="black" stroke="black" points="12461.26,-3213.04 12450.71,-3212.13 12458.39,-3219.42 12461.26,-3213.04"/>
</g>
<!-- l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu3 -->
<g id="edge1548" class="edge">
<title>l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M14968.16,-3298.88C14902.83,-3291.56 14804.41,-3275.23 14726,-3239.5 14716.45,-3235.15 14706.97,-3229.36 14698.17,-3223.16"/>
<polygon fill="black" stroke="black" points="14700.09,-3220.22 14689.96,-3217.12 14695.94,-3225.86 14700.09,-3220.22"/>
</g>
<!-- l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu4 -->
<g id="edge1549" class="edge">
<title>l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M14967.27,-3304.06C14763.71,-3301.94 14185.44,-3291.38 14004,-3239.5 13987.83,-3234.87 13971.34,-3227.43 13956.43,-3219.48"/>
<polygon fill="black" stroke="black" points="13957.82,-3216.25 13947.37,-3214.49 13954.44,-3222.38 13957.82,-3216.25"/>
</g>
<!-- l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu5 -->
<g id="edge1550" class="edge">
<title>l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M14967.69,-3300.5C14798.57,-3291.01 14359.83,-3267.5 13993,-3257.5 13940.43,-3256.07 12150.06,-3255.59 12100,-3239.5 12088.41,-3235.77 12077.03,-3229.69 12066.68,-3222.89"/>
<polygon fill="black" stroke="black" points="12068.46,-3219.87 12058.25,-3217.05 12064.47,-3225.62 12068.46,-3219.87"/>
</g>
<!-- l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu6 -->
<g id="edge1551" class="edge">
<title>l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M14967.71,-3299.94C14848.28,-3291.4 14613.32,-3271.12 14537,-3239.5 14527.17,-3235.42 14517.52,-3229.64 14508.64,-3223.34"/>
<polygon fill="black" stroke="black" points="14510.48,-3220.35 14500.38,-3217.18 14506.3,-3225.96 14510.48,-3220.35"/>
</g>
<!-- l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu7 -->
<g id="edge1552" class="edge">
<title>l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M14967.46,-3304.73C14784.71,-3304.26 14304.78,-3297.37 14158,-3239.5 14148.35,-3235.7 14139,-3230.04 14130.46,-3223.78"/>
<polygon fill="black" stroke="black" points="14132.58,-3221 14122.53,-3217.63 14128.29,-3226.53 14132.58,-3221"/>
</g>
<!-- l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu8 -->
<g id="edge1553" class="edge">
<title>l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M14967.69,-3300.67C14798.56,-3291.54 14359.8,-3268.76 13993,-3257.5 13871.26,-3253.76 13015.89,-3265.92 12897,-3239.5 12875.63,-3234.75 12853.46,-3226.15 12833.88,-3217.12"/>
<polygon fill="black" stroke="black" points="12835.32,-3213.93 12824.78,-3212.81 12832.32,-3220.25 12835.32,-3213.93"/>
</g>
<!-- l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu9 -->
<g id="edge1554" class="edge">
<title>l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M14967.69,-3300.75C14798.55,-3291.78 14359.78,-3269.33 13993,-3257.5 13890.48,-3254.19 13169.51,-3264.4 13070,-3239.5 13052.18,-3235.04 13033.97,-3227.26 13017.65,-3218.91"/>
<polygon fill="black" stroke="black" points="13019.27,-3215.81 13008.8,-3214.23 13016,-3222 13019.27,-3215.81"/>
</g>
<!-- l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu10 -->
<g id="edge1555" class="edge">
<title>l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M14967.69,-3300.52C14798.57,-3291.08 14359.83,-3267.68 13993,-3257.5 13945.52,-3256.18 12327.99,-3254.76 12283,-3239.5 12272.18,-3235.83 12261.66,-3229.91 12252.1,-3223.28"/>
<polygon fill="black" stroke="black" points="12254.1,-3220.41 12243.97,-3217.3 12249.96,-3226.05 12254.1,-3220.41"/>
</g>
<!-- l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu11 -->
<g id="edge1556" class="edge">
<title>l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M14967.69,-3300.61C14798.56,-3291.36 14359.81,-3268.34 13993,-3257.5 13922.08,-3255.4 12785.43,-3254.11 12716,-3239.5 12692.94,-3234.65 12668.88,-3225.71 12647.77,-3216.4"/>
<polygon fill="black" stroke="black" points="12649.15,-3213.18 12638.6,-3212.25 12646.27,-3219.56 12649.15,-3213.18"/>
</g>
<!-- l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu12 -->
<g id="edge1557" class="edge">
<title>l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M14986.72,-3272.74C14959.63,-3256.25 14926.49,-3236.06 14898.66,-3219.12"/>
<polygon fill="black" stroke="black" points="14900.19,-3215.95 14889.83,-3213.74 14896.55,-3221.93 14900.19,-3215.95"/>
</g>
<!-- l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu13 -->
<g id="edge1558" class="edge">
<title>l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M14967.68,-3300.83C14798.54,-3292.05 14359.76,-3269.96 13993,-3257.5 13949.4,-3256.02 13248.37,-3256.04 13208,-3239.5 13199.86,-3236.17 13192.18,-3231.15 13185.22,-3225.47"/>
<polygon fill="black" stroke="black" points="13187.2,-3222.55 13177.39,-3218.56 13182.57,-3227.8 13187.2,-3222.55"/>
</g>
<!-- l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu14 -->
<g id="edge1559" class="edge">
<title>l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M14967.6,-3301.58C14715.26,-3290.88 13877.5,-3254.39 13822,-3239.5 13804.51,-3234.81 13786.58,-3227.08 13770.44,-3218.87"/>
<polygon fill="black" stroke="black" points="13771.65,-3215.55 13761.17,-3213.99 13768.39,-3221.74 13771.65,-3215.55"/>
</g>
<!-- l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu15 -->
<g id="edge1560" class="edge">
<title>l3_expert7_gpu7&#45;&gt;l3_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M14967.68,-3301.03C14798.52,-3292.69 14359.7,-3271.47 13993,-3257.5 13928.9,-3255.06 13476.85,-3259.79 13416,-3239.5 13404.45,-3235.65 13393.09,-3229.51 13382.74,-3222.7"/>
<polygon fill="black" stroke="black" points="13384.52,-3219.67 13374.31,-3216.85 13380.53,-3225.43 13384.52,-3219.67"/>
</g>
<!-- l4_qkv_gpu0 -->
<g id="node1257" class="node">
<title>l4_qkv_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="13529" cy="-3039.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="13529" y="-3058.22" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="13529" y="-3043.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13529" y="-3028.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13529" y="-3013.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_expert_agg_gpu0&#45;&gt;l4_qkv_gpu0 -->
<g id="edge2945" class="edge">
<title>l3_expert_agg_gpu0&#45;&gt;l4_qkv_gpu0</title>
<path fill="none" stroke="black" d="M13526.04,-3145.17C13526.45,-3130.79 13526.92,-3113.95 13527.37,-3098.04"/>
<polygon fill="black" stroke="black" points="13530.88,-3097.84 13527.66,-3087.75 13523.88,-3097.64 13530.88,-3097.84"/>
</g>
<!-- l4_qkv_gpu1 -->
<g id="node1258" class="node">
<title>l4_qkv_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14337" cy="-3039.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="14337" y="-3058.22" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="14337" y="-3043.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14337" y="-3028.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14337" y="-3013.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_expert_agg_gpu1&#45;&gt;l4_qkv_gpu1 -->
<g id="edge2946" class="edge">
<title>l3_expert_agg_gpu1&#45;&gt;l4_qkv_gpu1</title>
<path fill="none" stroke="black" d="M14292.3,-3145.91C14298.68,-3130.84 14306.25,-3112.99 14313.32,-3096.29"/>
<polygon fill="black" stroke="black" points="14316.74,-3097.2 14317.42,-3086.63 14310.29,-3094.47 14316.74,-3097.2"/>
</g>
<!-- l4_qkv_gpu2 -->
<g id="node1259" class="node">
<title>l4_qkv_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="12317" cy="-3039.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="12317" y="-3058.22" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="12317" y="-3043.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12317" y="-3028.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12317" y="-3013.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_expert_agg_gpu2&#45;&gt;l4_qkv_gpu2 -->
<g id="edge2947" class="edge">
<title>l3_expert_agg_gpu2&#45;&gt;l4_qkv_gpu2</title>
<path fill="none" stroke="black" d="M12376.81,-3146.27C12367.98,-3130.65 12357.43,-3111.97 12347.66,-3094.69"/>
<polygon fill="black" stroke="black" points="12350.61,-3092.78 12342.64,-3085.8 12344.51,-3096.23 12350.61,-3092.78"/>
</g>
<!-- l4_qkv_gpu3 -->
<g id="node1260" class="node">
<title>l4_qkv_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14741" cy="-3039.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="14741" y="-3058.22" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="14741" y="-3043.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14741" y="-3028.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14741" y="-3013.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_expert_agg_gpu3&#45;&gt;l4_qkv_gpu3 -->
<g id="edge2948" class="edge">
<title>l3_expert_agg_gpu3&#45;&gt;l4_qkv_gpu3</title>
<path fill="none" stroke="black" d="M14674.98,-3146.64C14684.87,-3130.73 14696.75,-3111.61 14707.7,-3094"/>
<polygon fill="black" stroke="black" points="14710.68,-3095.83 14712.98,-3085.49 14704.73,-3092.14 14710.68,-3095.83"/>
</g>
<!-- l4_qkv_gpu4 -->
<g id="node1261" class="node">
<title>l4_qkv_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13933" cy="-3039.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="13933" y="-3058.22" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="13933" y="-3043.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13933" y="-3028.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13933" y="-3013.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_expert_agg_gpu4&#45;&gt;l4_qkv_gpu4 -->
<g id="edge2949" class="edge">
<title>l3_expert_agg_gpu4&#45;&gt;l4_qkv_gpu4</title>
<path fill="none" stroke="black" d="M13909.24,-3145.54C13912.57,-3130.81 13916.49,-3113.48 13920.17,-3097.17"/>
<polygon fill="black" stroke="black" points="13923.64,-3097.71 13922.43,-3087.19 13916.81,-3096.17 13923.64,-3097.71"/>
</g>
<!-- l4_qkv_gpu5 -->
<g id="node1262" class="node">
<title>l4_qkv_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="11913" cy="-3039.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="11913" y="-3058.22" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="11913" y="-3043.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="11913" y="-3028.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="11913" y="-3013.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_expert_agg_gpu5&#45;&gt;l4_qkv_gpu5 -->
<g id="edge2950" class="edge">
<title>l3_expert_agg_gpu5&#45;&gt;l4_qkv_gpu5</title>
<path fill="none" stroke="black" d="M11994.3,-3147C11981.79,-3130.6 11966.62,-3110.71 11952.79,-3092.58"/>
<polygon fill="black" stroke="black" points="11955.4,-3090.23 11946.55,-3084.4 11949.83,-3094.47 11955.4,-3090.23"/>
</g>
<!-- l4_qkv_gpu6 -->
<g id="node1263" class="node">
<title>l4_qkv_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14539" cy="-3039.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="14539" y="-3058.22" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="14539" y="-3043.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14539" y="-3028.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14539" y="-3013.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_expert_agg_gpu6&#45;&gt;l4_qkv_gpu6 -->
<g id="edge2951" class="edge">
<title>l3_expert_agg_gpu6&#45;&gt;l4_qkv_gpu6</title>
<path fill="none" stroke="black" d="M14483.67,-3146.27C14491.73,-3130.86 14501.34,-3112.48 14510.27,-3095.39"/>
<polygon fill="black" stroke="black" points="14513.61,-3096.54 14515.14,-3086.06 14507.41,-3093.3 14513.61,-3096.54"/>
</g>
<!-- l4_qkv_gpu7 -->
<g id="node1264" class="node">
<title>l4_qkv_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14135" cy="-3039.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="14135" y="-3058.22" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="14135" y="-3043.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14135" y="-3028.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14135" y="-3013.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_expert_agg_gpu7&#45;&gt;l4_qkv_gpu7 -->
<g id="edge2952" class="edge">
<title>l3_expert_agg_gpu7&#45;&gt;l4_qkv_gpu7</title>
<path fill="none" stroke="black" d="M14100.85,-3145.54C14105.7,-3130.61 14111.42,-3112.99 14116.78,-3096.48"/>
<polygon fill="black" stroke="black" points="14120.13,-3097.52 14119.89,-3086.93 14113.47,-3095.36 14120.13,-3097.52"/>
</g>
<!-- l4_qkv_gpu8 -->
<g id="node1265" class="node">
<title>l4_qkv_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="12721" cy="-3039.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="12721" y="-3058.22" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="12721" y="-3043.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12721" y="-3028.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12721" y="-3013.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_expert_agg_gpu8&#45;&gt;l4_qkv_gpu8 -->
<g id="edge2953" class="edge">
<title>l3_expert_agg_gpu8&#45;&gt;l4_qkv_gpu8</title>
<path fill="none" stroke="black" d="M12759.74,-3145.91C12754.23,-3130.91 12747.71,-3113.15 12741.61,-3096.52"/>
<polygon fill="black" stroke="black" points="12744.8,-3095.07 12738.07,-3086.89 12738.23,-3097.48 12744.8,-3095.07"/>
</g>
<!-- l4_qkv_gpu9 -->
<g id="node1266" class="node">
<title>l4_qkv_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="12923" cy="-3039.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="12923" y="-3058.22" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="12923" y="-3043.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12923" y="-3028.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12923" y="-3013.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_expert_agg_gpu9&#45;&gt;l4_qkv_gpu9 -->
<g id="edge2954" class="edge">
<title>l3_expert_agg_gpu9&#45;&gt;l4_qkv_gpu9</title>
<path fill="none" stroke="black" d="M12951.21,-3145.54C12947.26,-3130.81 12942.61,-3113.48 12938.23,-3097.17"/>
<polygon fill="black" stroke="black" points="12941.53,-3095.94 12935.55,-3087.19 12934.77,-3097.75 12941.53,-3095.94"/>
</g>
<!-- l4_qkv_gpu10 -->
<g id="node1267" class="node">
<title>l4_qkv_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12115" cy="-3039.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="12115" y="-3058.22" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="12115" y="-3043.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12115" y="-3028.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12115" y="-3013.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_expert_agg_gpu10&#45;&gt;l4_qkv_gpu10 -->
<g id="edge2955" class="edge">
<title>l3_expert_agg_gpu10&#45;&gt;l4_qkv_gpu10</title>
<path fill="none" stroke="black" d="M12185.52,-3146.64C12174.87,-3130.59 12162.04,-3111.27 12150.26,-3093.53"/>
<polygon fill="black" stroke="black" points="12153.03,-3091.36 12144.58,-3084.97 12147.19,-3095.24 12153.03,-3091.36"/>
</g>
<!-- l4_qkv_gpu11 -->
<g id="node1268" class="node">
<title>l4_qkv_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="12519" cy="-3039.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="12519" y="-3058.22" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="12519" y="-3043.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12519" y="-3028.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="12519" y="-3013.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_expert_agg_gpu11&#45;&gt;l4_qkv_gpu11 -->
<g id="edge2956" class="edge">
<title>l3_expert_agg_gpu11&#45;&gt;l4_qkv_gpu11</title>
<path fill="none" stroke="black" d="M12568.17,-3145.91C12561.05,-3130.63 12552.6,-3112.49 12544.72,-3095.59"/>
<polygon fill="black" stroke="black" points="12547.82,-3093.95 12540.42,-3086.36 12541.47,-3096.91 12547.82,-3093.95"/>
</g>
<!-- l4_qkv_gpu12 -->
<g id="node1269" class="node">
<title>l4_qkv_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14943" cy="-3039.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="14943" y="-3058.22" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="14943" y="-3043.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14943" y="-3028.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="14943" y="-3013.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_expert_agg_gpu12&#45;&gt;l4_qkv_gpu12 -->
<g id="edge2957" class="edge">
<title>l3_expert_agg_gpu12&#45;&gt;l4_qkv_gpu12</title>
<path fill="none" stroke="black" d="M14866.21,-3147C14877.98,-3130.67 14892.23,-3110.89 14905.25,-3092.82"/>
<polygon fill="black" stroke="black" points="14908.12,-3094.82 14911.13,-3084.66 14902.44,-3090.73 14908.12,-3094.82"/>
</g>
<!-- l4_qkv_gpu13 -->
<g id="node1270" class="node">
<title>l4_qkv_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13125" cy="-3039.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="13125" y="-3058.22" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="13125" y="-3043.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13125" y="-3028.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13125" y="-3013.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_expert_agg_gpu13&#45;&gt;l4_qkv_gpu13 -->
<g id="edge2958" class="edge">
<title>l3_expert_agg_gpu13&#45;&gt;l4_qkv_gpu13</title>
<path fill="none" stroke="black" d="M13142.82,-3145.54C13140.34,-3130.88 13137.41,-3113.64 13134.66,-3097.4"/>
<polygon fill="black" stroke="black" points="13138.1,-3096.73 13132.97,-3087.45 13131.19,-3097.9 13138.1,-3096.73"/>
</g>
<!-- l4_qkv_gpu14 -->
<g id="node1271" class="node">
<title>l4_qkv_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="13731" cy="-3039.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="13731" y="-3058.22" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="13731" y="-3043.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13731" y="-3028.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13731" y="-3013.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_expert_agg_gpu14&#45;&gt;l4_qkv_gpu14 -->
<g id="edge2959" class="edge">
<title>l3_expert_agg_gpu14&#45;&gt;l4_qkv_gpu14</title>
<path fill="none" stroke="black" d="M13717.64,-3145.54C13719.5,-3130.88 13721.69,-3113.64 13723.76,-3097.4"/>
<polygon fill="black" stroke="black" points="13727.23,-3097.81 13725.02,-3087.45 13720.29,-3096.93 13727.23,-3097.81"/>
</g>
<!-- l4_qkv_gpu15 -->
<g id="node1272" class="node">
<title>l4_qkv_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="13327" cy="-3039.42" rx="92" ry="48.17"/>
<text text-anchor="middle" x="13327" y="-3058.22" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="13327" y="-3043.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13327" y="-3028.22" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="13327" y="-3013.22" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_expert_agg_gpu15&#45;&gt;l4_qkv_gpu15 -->
<g id="edge2960" class="edge">
<title>l3_expert_agg_gpu15&#45;&gt;l4_qkv_gpu15</title>
<path fill="none" stroke="black" d="M13334.4,-3145.17C13333.38,-3130.72 13332.18,-3113.79 13331.05,-3097.81"/>
<polygon fill="black" stroke="black" points="13334.52,-3097.21 13330.32,-3087.49 13327.54,-3097.71 13334.52,-3097.21"/>
</g>
<!-- l3_gate_gpu1&#45;&gt;l3_expert0_gpu0 -->
<g id="edge1387" class="edge">
<title>l3_gate_gpu1&#45;&gt;l3_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14279,-3414.79C14267.98,-3410.6 14256.3,-3406.91 14245,-3404.67 14206.86,-3397.09 8673.45,-3414.2 8646,-3386.67 8641.29,-3381.94 8641.32,-3376.41 8646,-3371.67 8660.09,-3357.4 10069.95,-3354.09 10090,-3353.67 10669.94,-3341.49 11368.23,-3317.73 11603.3,-3309.49"/>
<polygon fill="black" stroke="black" points="11603.6,-3312.98 11613.47,-3309.13 11603.36,-3305.98 11603.6,-3312.98"/>
<text text-anchor="middle" x="8691.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l3_gate_gpu1&#45;&gt;l3_expert1_gpu1 -->
<g id="edge1388" class="edge">
<title>l3_gate_gpu1&#45;&gt;l3_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14279,-3414.8C14267.97,-3410.61 14256.3,-3406.92 14245,-3404.67 14219.66,-3399.61 10542.23,-3404.98 10524,-3386.67 10519.3,-3381.94 10519.32,-3376.41 10524,-3371.67 10548.2,-3347.11 11730.62,-3356.24 11765,-3353.67 11857.31,-3346.76 11962.57,-3331.41 12032.71,-3320.11"/>
<polygon fill="black" stroke="black" points="12033.49,-3323.53 12042.8,-3318.47 12032.37,-3316.62 12033.49,-3323.53"/>
<text text-anchor="middle" x="10569.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l3_gate_gpu1&#45;&gt;l3_expert2_gpu2 -->
<g id="edge1389" class="edge">
<title>l3_gate_gpu1&#45;&gt;l3_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14389,-3414.79C14400.02,-3410.6 14411.7,-3406.91 14423,-3404.67 14460.24,-3397.26 19864.19,-3413.56 19891,-3386.67 19895.71,-3381.94 19895.63,-3376.47 19891,-3371.67 19832.13,-3310.58 18552.39,-3306.5 18213,-3306.49"/>
<polygon fill="black" stroke="black" points="18212.76,-3302.99 18202.76,-3306.49 18212.76,-3309.99 18212.76,-3302.99"/>
<text text-anchor="middle" x="19939.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l3_gate_gpu1&#45;&gt;l3_expert3_gpu3 -->
<g id="edge1390" class="edge">
<title>l3_gate_gpu1&#45;&gt;l3_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14278.99,-3414.85C14267.97,-3410.65 14256.29,-3406.95 14245,-3404.67 14219.91,-3399.59 12420.01,-3404.86 12402,-3386.67 12362.52,-3346.79 12553.49,-3323.2 12667.95,-3312.85"/>
<polygon fill="black" stroke="black" points="12668.45,-3316.32 12678.1,-3311.95 12667.83,-3309.35 12668.45,-3316.32"/>
<text text-anchor="middle" x="12447.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l3_gate_gpu1&#45;&gt;l3_expert4_gpu4 -->
<g id="edge1391" class="edge">
<title>l3_gate_gpu1&#45;&gt;l3_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14279,-3414.78C14267.98,-3410.59 14256.3,-3406.91 14245,-3404.67 14219.92,-3399.69 6900.06,-3404.77 6882,-3386.67 6877.29,-3381.95 6877.34,-3376.43 6882,-3371.67 6936.88,-3315.63 9440.48,-3307.73 9928.16,-3306.72"/>
<polygon fill="black" stroke="black" points="9928.29,-3310.22 9938.28,-3306.7 9928.27,-3303.22 9928.29,-3310.22"/>
<text text-anchor="middle" x="6927.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l3_gate_gpu1&#45;&gt;l3_expert5_gpu5 -->
<g id="edge1392" class="edge">
<title>l3_gate_gpu1&#45;&gt;l3_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14296.22,-3408.73C14278.88,-3395.39 14257.44,-3380.93 14236,-3371.67 14157.71,-3337.84 14061.05,-3321.34 13993.98,-3313.46"/>
<polygon fill="black" stroke="black" points="13994.22,-3309.96 13983.89,-3312.31 13993.43,-3316.92 13994.22,-3309.96"/>
<text text-anchor="middle" x="14308.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l3_gate_gpu1&#45;&gt;l3_expert6_gpu6 -->
<g id="edge1393" class="edge">
<title>l3_gate_gpu1&#45;&gt;l3_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14389,-3414.8C14400.03,-3410.61 14411.7,-3406.92 14423,-3404.67 14447.45,-3399.78 17995.42,-3404.34 18013,-3386.67 18017.7,-3381.94 18017.63,-3376.46 18013,-3371.67 17946.99,-3303.42 16503.21,-3304.76 16140.9,-3306.17"/>
<polygon fill="black" stroke="black" points="16140.74,-3302.67 16130.75,-3306.21 16140.77,-3309.67 16140.74,-3302.67"/>
<text text-anchor="middle" x="18062.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l3_gate_gpu1&#45;&gt;l3_expert7_gpu7 -->
<g id="edge1394" class="edge">
<title>l3_gate_gpu1&#45;&gt;l3_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14389.01,-3414.85C14400.03,-3410.66 14411.71,-3406.95 14423,-3404.67 14446.31,-3399.95 16118.27,-3403.57 16135,-3386.67 16139.69,-3381.93 16139.57,-3376.52 16135,-3371.67 16117.61,-3353.22 15371.82,-3320.47 15120.61,-3309.94"/>
<polygon fill="black" stroke="black" points="15120.59,-3306.44 15110.45,-3309.52 15120.3,-3313.43 15120.59,-3306.44"/>
<text text-anchor="middle" x="16184.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l3_gate_gpu2&#45;&gt;l3_expert0_gpu0 -->
<g id="edge1412" class="edge">
<title>l3_gate_gpu2&#45;&gt;l3_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15347,-3414.79C15335.98,-3410.6 15324.3,-3406.91 15313,-3404.67 15272.31,-3396.58 9368.29,-3416.05 9339,-3386.67 9334.29,-3381.94 9334.34,-3376.44 9339,-3371.67 9353.58,-3356.74 10069.14,-3354.22 10090,-3353.67 10669.86,-3338.16 11368.2,-3316.52 11603.29,-3309.15"/>
<polygon fill="black" stroke="black" points="11603.58,-3312.65 11613.47,-3308.84 11603.36,-3305.65 11603.58,-3312.65"/>
<text text-anchor="middle" x="9384.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l3_gate_gpu2&#45;&gt;l3_expert1_gpu1 -->
<g id="edge1413" class="edge">
<title>l3_gate_gpu2&#45;&gt;l3_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15347,-3414.8C15335.98,-3410.61 15324.3,-3406.92 15313,-3404.67 15285.1,-3399.1 11237.07,-3406.82 11217,-3386.67 11212.3,-3381.94 11212.36,-3376.46 11217,-3371.67 11238.18,-3349.78 11734.65,-3356.22 11765,-3353.67 11857.24,-3345.91 11962.51,-3330.73 12032.68,-3319.69"/>
<polygon fill="black" stroke="black" points="12033.44,-3323.12 12042.77,-3318.1 12032.35,-3316.2 12033.44,-3323.12"/>
<text text-anchor="middle" x="11262.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l3_gate_gpu2&#45;&gt;l3_expert2_gpu2 -->
<g id="edge1414" class="edge">
<title>l3_gate_gpu2&#45;&gt;l3_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15481.82,-3438.63C15703.08,-3431.72 16342.98,-3412.55 16875,-3404.67 16900.75,-3404.28 20565.83,-3404.92 20584,-3386.67 20588.7,-3381.94 20588.65,-3376.44 20584,-3371.67 20541.71,-3328.24 18634.74,-3310.58 18212.99,-3307.2"/>
<polygon fill="black" stroke="black" points="18212.74,-3303.7 18202.72,-3307.12 18212.69,-3310.7 18212.74,-3303.7"/>
<text text-anchor="middle" x="20632.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l3_gate_gpu2&#45;&gt;l3_expert3_gpu3 -->
<g id="edge1415" class="edge">
<title>l3_gate_gpu2&#45;&gt;l3_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15346.99,-3414.83C15335.97,-3410.64 15324.3,-3406.94 15313,-3404.67 15192.2,-3380.35 13212.97,-3422.26 13095,-3386.67 13083.32,-3383.14 13083.3,-3376.29 13072,-3371.67 12993.19,-3339.42 12896.82,-3322.67 12829.96,-3314.3"/>
<polygon fill="black" stroke="black" points="12830.25,-3310.81 12819.9,-3313.07 12829.41,-3317.75 12830.25,-3310.81"/>
<text text-anchor="middle" x="13140.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l3_gate_gpu2&#45;&gt;l3_expert4_gpu4 -->
<g id="edge1416" class="edge">
<title>l3_gate_gpu2&#45;&gt;l3_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15347,-3414.78C15335.98,-3410.59 15324.3,-3406.91 15313,-3404.67 15286.7,-3399.45 7609.94,-3405.65 7591,-3386.67 7586.29,-3381.95 7586.35,-3376.44 7591,-3371.67 7632.66,-3328.87 9510.17,-3310.74 9928.12,-3307.23"/>
<polygon fill="black" stroke="black" points="9928.34,-3310.73 9938.31,-3307.15 9928.28,-3303.73 9928.34,-3310.73"/>
<text text-anchor="middle" x="7636.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l3_gate_gpu2&#45;&gt;l3_expert5_gpu5 -->
<g id="edge1417" class="edge">
<title>l3_gate_gpu2&#45;&gt;l3_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15346.43,-3415.05C15335.55,-3410.9 15324.08,-3407.16 15313,-3404.67 15239.18,-3388.08 15044.93,-3410.14 14973,-3386.67 14961.4,-3382.88 14961.58,-3375.51 14950,-3371.67 14773.33,-3313.06 14207.6,-3306.65 13994.89,-3306.37"/>
<polygon fill="black" stroke="black" points="13994.73,-3302.87 13984.73,-3306.36 13994.73,-3309.87 13994.73,-3302.87"/>
<text text-anchor="middle" x="15018.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l3_gate_gpu2&#45;&gt;l3_expert6_gpu6 -->
<g id="edge1418" class="edge">
<title>l3_gate_gpu2&#45;&gt;l3_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15481.83,-3438.77C15703.09,-3432.21 16343,-3413.87 16875,-3404.67 16900.43,-3404.23 18688.11,-3404.74 18706,-3386.67 18710.69,-3381.93 18710.66,-3376.44 18706,-3371.67 18703.13,-3368.72 16585.98,-3318.94 16140.61,-3308.49"/>
<polygon fill="black" stroke="black" points="16140.48,-3304.99 16130.4,-3308.25 16140.32,-3311.99 16140.48,-3304.99"/>
<text text-anchor="middle" x="18755.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l3_gate_gpu2&#45;&gt;l3_expert7_gpu7 -->
<g id="edge1419" class="edge">
<title>l3_gate_gpu2&#45;&gt;l3_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15482.12,-3441.07C15772.08,-3440.33 16752.19,-3434.3 16798,-3386.67 16802.62,-3381.86 16802.66,-3376.43 16798,-3371.67 16782.07,-3355.38 16000.77,-3354.49 15978,-3353.67 15660.76,-3342.23 15283.61,-3321 15120.66,-3311.45"/>
<polygon fill="black" stroke="black" points="15120.43,-3307.93 15110.24,-3310.84 15120.02,-3314.92 15120.43,-3307.93"/>
<text text-anchor="middle" x="16847.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l3_gate_gpu3&#45;&gt;l3_expert0_gpu0 -->
<g id="edge1437" class="edge">
<title>l3_gate_gpu3&#45;&gt;l3_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14813,-3414.79C14801.98,-3410.6 14790.3,-3406.91 14779,-3404.67 14739.56,-3396.83 9016.39,-3415.15 8988,-3386.67 8983.29,-3381.94 8983.32,-3376.42 8988,-3371.67 9009.47,-3349.84 10059.39,-3354.37 10090,-3353.67 10669.91,-3340.37 11368.22,-3317.33 11603.3,-3309.37"/>
<polygon fill="black" stroke="black" points="11603.59,-3312.87 11613.47,-3309.03 11603.36,-3305.87 11603.59,-3312.87"/>
<text text-anchor="middle" x="9033.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l3_gate_gpu3&#45;&gt;l3_expert1_gpu1 -->
<g id="edge1438" class="edge">
<title>l3_gate_gpu3&#45;&gt;l3_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14813,-3414.8C14801.98,-3410.61 14790.3,-3406.92 14779,-3404.67 14752.35,-3399.35 10885.17,-3405.93 10866,-3386.67 10861.3,-3381.94 10861.33,-3376.43 10866,-3371.67 10883.48,-3353.83 11740.1,-3355.6 11765,-3353.67 11857.29,-3346.5 11962.55,-3331.21 12032.7,-3319.98"/>
<polygon fill="black" stroke="black" points="12033.48,-3323.4 12042.79,-3318.36 12032.36,-3316.49 12033.48,-3323.4"/>
<text text-anchor="middle" x="10911.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l3_gate_gpu3&#45;&gt;l3_expert2_gpu2 -->
<g id="edge1439" class="edge">
<title>l3_gate_gpu3&#45;&gt;l3_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14923,-3414.79C14934.02,-3410.6 14945.7,-3406.91 14957,-3404.67 14992.94,-3397.52 20207.14,-3412.62 20233,-3386.67 20237.71,-3381.94 20237.64,-3376.45 20233,-3371.67 20197.21,-3334.75 18596.04,-3312.4 18212.79,-3307.57"/>
<polygon fill="black" stroke="black" points="18212.65,-3304.07 18202.61,-3307.44 18212.57,-3311.07 18212.65,-3304.07"/>
<text text-anchor="middle" x="20281.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l3_gate_gpu3&#45;&gt;l3_expert3_gpu3 -->
<g id="edge1440" class="edge">
<title>l3_gate_gpu3&#45;&gt;l3_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14812.99,-3414.84C14801.97,-3410.65 14790.3,-3406.94 14779,-3404.67 14751.29,-3399.08 12763.9,-3406.74 12744,-3386.67 12737.59,-3380.2 12734.78,-3371.81 12734.15,-3362.9"/>
<polygon fill="black" stroke="black" points="12737.65,-3362.75 12734.29,-3352.7 12730.65,-3362.65 12737.65,-3362.75"/>
<text text-anchor="middle" x="12789.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l3_gate_gpu3&#45;&gt;l3_expert4_gpu4 -->
<g id="edge1441" class="edge">
<title>l3_gate_gpu3&#45;&gt;l3_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14813,-3414.78C14801.98,-3410.59 14790.3,-3406.91 14779,-3404.67 14753.27,-3399.56 7242.53,-3405.24 7224,-3386.67 7219.29,-3381.95 7219.34,-3376.43 7224,-3371.67 7272.49,-3322.03 9473.1,-3309.08 9928.18,-3306.93"/>
<polygon fill="black" stroke="black" points="9928.3,-3310.43 9938.28,-3306.89 9928.27,-3303.43 9928.3,-3310.43"/>
<text text-anchor="middle" x="7269.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l3_gate_gpu3&#45;&gt;l3_expert5_gpu5 -->
<g id="edge1442" class="edge">
<title>l3_gate_gpu3&#45;&gt;l3_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14811.82,-3415.41C14801.1,-3411.28 14789.84,-3407.45 14779,-3404.67 14710.98,-3387.18 14688.07,-3410.49 14622,-3386.67 14610.52,-3382.53 14610.52,-3375.69 14599,-3371.67 14489.39,-3333.36 14151.59,-3315.72 13994.67,-3309.44"/>
<polygon fill="black" stroke="black" points="13994.73,-3305.94 13984.6,-3309.04 13994.46,-3312.93 13994.73,-3305.94"/>
<text text-anchor="middle" x="14667.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l3_gate_gpu3&#45;&gt;l3_expert6_gpu6 -->
<g id="edge1443" class="edge">
<title>l3_gate_gpu3&#45;&gt;l3_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14923,-3414.81C14934.03,-3410.62 14945.7,-3406.92 14957,-3404.67 14980.14,-3400.04 18338.36,-3403.4 18355,-3386.67 18359.7,-3381.94 18359.65,-3376.45 18355,-3371.67 18335.3,-3351.39 16547.51,-3315.94 16140.72,-3308.13"/>
<polygon fill="black" stroke="black" points="16140.58,-3304.63 16130.51,-3307.94 16140.45,-3311.63 16140.58,-3304.63"/>
<text text-anchor="middle" x="18404.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l3_gate_gpu3&#45;&gt;l3_expert7_gpu7 -->
<g id="edge1444" class="edge">
<title>l3_gate_gpu3&#45;&gt;l3_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14923.01,-3414.87C14934.04,-3410.67 14945.71,-3406.96 14957,-3404.67 14998.38,-3396.26 16447.32,-3416.7 16477,-3386.67 16481.69,-3381.92 16481.63,-3376.46 16477,-3371.67 16457.74,-3351.7 16005.71,-3354.86 15978,-3353.67 15660.85,-3340 15283.65,-3319.92 15120.67,-3311.06"/>
<polygon fill="black" stroke="black" points="15120.43,-3307.55 15110.25,-3310.5 15120.05,-3314.54 15120.43,-3307.55"/>
<text text-anchor="middle" x="16526.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l3_gate_gpu4&#45;&gt;l3_expert0_gpu0 -->
<g id="edge1462" class="edge">
<title>l3_gate_gpu4&#45;&gt;l3_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13211,-3414.79C13199.98,-3410.6 13188.3,-3406.91 13177,-3404.67 13141.3,-3397.57 7960.7,-3412.45 7935,-3386.67 7930.29,-3381.94 7930.31,-3376.4 7935,-3371.67 7956.08,-3350.41 10060.07,-3354.23 10090,-3353.67 10669.96,-3342.69 11368.24,-3318.17 11603.3,-3309.61"/>
<polygon fill="black" stroke="black" points="11603.61,-3313.1 11613.47,-3309.23 11603.35,-3306.1 11603.61,-3313.1"/>
<text text-anchor="middle" x="7980.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l3_gate_gpu4&#45;&gt;l3_expert1_gpu1 -->
<g id="edge1463" class="edge">
<title>l3_gate_gpu4&#45;&gt;l3_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13211,-3414.81C13199.97,-3410.62 13188.3,-3406.92 13177,-3404.67 13154.09,-3400.09 9829.47,-3403.23 9813,-3386.67 9808.3,-3381.94 9808.31,-3376.4 9813,-3371.67 9832.08,-3352.41 11737.96,-3355.62 11765,-3353.67 11857.47,-3346.99 11962.91,-3331.56 12033.05,-3320.18"/>
<polygon fill="black" stroke="black" points="12033.83,-3323.59 12043.14,-3318.53 12032.7,-3316.69 12033.83,-3323.59"/>
<text text-anchor="middle" x="9858.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l3_gate_gpu4&#45;&gt;l3_expert2_gpu2 -->
<g id="edge1464" class="edge">
<title>l3_gate_gpu4&#45;&gt;l3_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13321,-3414.79C13332.02,-3410.6 13343.7,-3406.91 13355,-3404.67 13394.68,-3396.78 19151.44,-3415.31 19180,-3386.67 19248.91,-3317.54 18471.29,-3308.02 18212.85,-3306.76"/>
<polygon fill="black" stroke="black" points="18212.79,-3303.26 18202.77,-3306.71 18212.76,-3310.26 18212.79,-3303.26"/>
<text text-anchor="middle" x="19230.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l3_gate_gpu4&#45;&gt;l3_expert3_gpu3 -->
<g id="edge1465" class="edge">
<title>l3_gate_gpu4&#45;&gt;l3_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13210.99,-3414.87C13199.96,-3410.67 13188.29,-3406.96 13177,-3404.67 13136.55,-3396.44 11720.01,-3416.03 11691,-3386.67 11686.31,-3381.92 11686.37,-3376.46 11691,-3371.67 11710.34,-3351.62 12164.2,-3355.34 12192,-3353.67 12361.62,-3343.46 12559.79,-3325.19 12668.1,-3314.66"/>
<polygon fill="black" stroke="black" points="12668.69,-3318.12 12678.3,-3313.66 12668.01,-3311.15 12668.69,-3318.12"/>
<text text-anchor="middle" x="11736.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l3_gate_gpu4&#45;&gt;l3_expert4_gpu4 -->
<g id="edge1466" class="edge">
<title>l3_gate_gpu4&#45;&gt;l3_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13211,-3414.78C13199.98,-3410.59 13188.3,-3406.91 13177,-3404.67 13153.14,-3399.93 6188.18,-3403.89 6171,-3386.67 6166.29,-3381.95 6166.33,-3376.42 6171,-3371.67 6239.2,-3302.3 9377.04,-3305.33 9927.89,-3306.4"/>
<polygon fill="black" stroke="black" points="9928.12,-3309.9 9938.12,-3306.42 9928.13,-3302.9 9928.12,-3309.9"/>
<text text-anchor="middle" x="6216.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l3_gate_gpu4&#45;&gt;l3_expert5_gpu5 -->
<g id="edge1467" class="edge">
<title>l3_gate_gpu4&#45;&gt;l3_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13322.14,-3415.23C13332.86,-3411.12 13344.14,-3407.34 13355,-3404.67 13437.79,-3384.27 13466.85,-3418.38 13546,-3386.67 13555.99,-3382.66 13555.21,-3376.12 13565,-3371.67 13650.91,-3332.62 13758.94,-3317 13831.66,-3310.75"/>
<polygon fill="black" stroke="black" points="13832,-3314.23 13841.68,-3309.93 13831.43,-3307.26 13832,-3314.23"/>
<text text-anchor="middle" x="13610.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l3_gate_gpu4&#45;&gt;l3_expert6_gpu6 -->
<g id="edge1468" class="edge">
<title>l3_gate_gpu4&#45;&gt;l3_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13321,-3414.8C13332.02,-3410.61 13343.7,-3406.92 13355,-3404.67 13381.88,-3399.3 17282.66,-3406.09 17302,-3386.67 17306.7,-3381.94 17306.59,-3376.5 17302,-3371.67 17262,-3329.52 16411.6,-3312.25 16140.95,-3307.81"/>
<polygon fill="black" stroke="black" points="16140.85,-3304.31 16130.8,-3307.64 16140.74,-3311.31 16140.85,-3304.31"/>
<text text-anchor="middle" x="17351.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l3_gate_gpu4&#45;&gt;l3_expert7_gpu7 -->
<g id="edge1469" class="edge">
<title>l3_gate_gpu4&#45;&gt;l3_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13321.01,-3414.84C13332.03,-3410.64 13343.7,-3406.94 13355,-3404.67 13383.17,-3398.99 15403.77,-3407.07 15424,-3386.67 15468.63,-3341.64 15245.88,-3319.8 15120.21,-3311.2"/>
<polygon fill="black" stroke="black" points="15120.43,-3307.7 15110.22,-3310.53 15119.96,-3314.69 15120.43,-3307.7"/>
<text text-anchor="middle" x="15475.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l3_gate_gpu5&#45;&gt;l3_expert0_gpu0 -->
<g id="edge1487" class="edge">
<title>l3_gate_gpu5&#45;&gt;l3_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13923,-3414.79C13911.98,-3410.6 13900.3,-3406.91 13889,-3404.67 13851.67,-3397.25 8435.87,-3413.62 8409,-3386.67 8404.29,-3381.94 8404.31,-3376.41 8409,-3371.67 8425.42,-3355.07 10066.66,-3354.14 10090,-3353.67 10669.95,-3342 11368.24,-3317.92 11603.3,-3309.54"/>
<polygon fill="black" stroke="black" points="11603.6,-3313.03 11613.47,-3309.17 11603.36,-3306.03 11603.6,-3313.03"/>
<text text-anchor="middle" x="8454.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l3_gate_gpu5&#45;&gt;l3_expert1_gpu1 -->
<g id="edge1488" class="edge">
<title>l3_gate_gpu5&#45;&gt;l3_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13923,-3414.8C13911.97,-3410.61 13900.3,-3406.92 13889,-3404.67 13864.47,-3399.77 10304.64,-3404.4 10287,-3386.67 10282.3,-3381.94 10282.31,-3376.41 10287,-3371.67 10301.43,-3357.06 11744.53,-3355.17 11765,-3353.67 11857.32,-3346.87 11962.57,-3331.5 12032.72,-3320.16"/>
<polygon fill="black" stroke="black" points="12033.5,-3323.58 12042.81,-3318.52 12032.37,-3316.67 12033.5,-3323.58"/>
<text text-anchor="middle" x="10332.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l3_gate_gpu5&#45;&gt;l3_expert2_gpu2 -->
<g id="edge1489" class="edge">
<title>l3_gate_gpu5&#45;&gt;l3_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14033,-3414.79C14044.02,-3410.6 14055.7,-3406.91 14067,-3404.67 14105.05,-3397.1 19626.61,-3414.15 19654,-3386.67 19658.71,-3381.94 19658.61,-3376.48 19654,-3371.67 19603.82,-3319.29 18522.38,-3308.89 18213,-3306.98"/>
<polygon fill="black" stroke="black" points="18212.78,-3303.48 18202.76,-3306.92 18212.74,-3310.48 18212.78,-3303.48"/>
<text text-anchor="middle" x="19702.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l3_gate_gpu5&#45;&gt;l3_expert3_gpu3 -->
<g id="edge1490" class="edge">
<title>l3_gate_gpu5&#45;&gt;l3_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13922.99,-3414.85C13911.97,-3410.66 13900.29,-3406.95 13889,-3404.67 13865.53,-3399.91 12181.84,-3403.69 12165,-3386.67 12160.31,-3381.93 12160.55,-3376.63 12165,-3371.67 12197.9,-3334.9 12514.49,-3316.54 12667.29,-3309.76"/>
<polygon fill="black" stroke="black" points="12667.72,-3313.24 12677.56,-3309.31 12667.41,-3306.25 12667.72,-3313.24"/>
<text text-anchor="middle" x="12210.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l3_gate_gpu5&#45;&gt;l3_expert4_gpu4 -->
<g id="edge1491" class="edge">
<title>l3_gate_gpu5&#45;&gt;l3_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13923,-3414.78C13911.98,-3410.59 13900.3,-3406.91 13889,-3404.67 13864.33,-3399.77 6662.76,-3404.47 6645,-3386.67 6640.29,-3381.95 6640.33,-3376.43 6645,-3371.67 6704.32,-3311.19 9418.96,-3306.87 9928.16,-3306.6"/>
<polygon fill="black" stroke="black" points="9928.36,-3310.1 9938.36,-3306.59 9928.36,-3303.1 9928.36,-3310.1"/>
<text text-anchor="middle" x="6690.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l3_gate_gpu5&#45;&gt;l3_expert5_gpu5 -->
<g id="edge1492" class="edge">
<title>l3_gate_gpu5&#45;&gt;l3_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14013.73,-3408.54C14022.11,-3396.98 14026.84,-3383.83 14020,-3371.67 14011.54,-3356.61 13998.03,-3344.64 13983.42,-3335.28"/>
<polygon fill="black" stroke="black" points="13985.1,-3332.2 13974.72,-3330.07 13981.5,-3338.21 13985.1,-3332.2"/>
<text text-anchor="middle" x="14069.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l3_gate_gpu5&#45;&gt;l3_expert6_gpu6 -->
<g id="edge1493" class="edge">
<title>l3_gate_gpu5&#45;&gt;l3_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14033,-3414.8C14044.03,-3410.61 14055.7,-3406.92 14067,-3404.67 14092.26,-3399.62 17757.83,-3404.92 17776,-3386.67 17780.7,-3381.94 17780.62,-3376.47 17776,-3371.67 17718.69,-3312.15 16474.27,-3306.9 16140.67,-3306.57"/>
<polygon fill="black" stroke="black" points="16140.6,-3303.07 16130.59,-3306.56 16140.59,-3310.07 16140.6,-3303.07"/>
<text text-anchor="middle" x="17825.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l3_gate_gpu5&#45;&gt;l3_expert7_gpu7 -->
<g id="edge1494" class="edge">
<title>l3_gate_gpu5&#45;&gt;l3_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14033.01,-3414.85C14044.03,-3410.65 14055.71,-3406.95 14067,-3404.67 14091.93,-3399.63 15880.11,-3404.74 15898,-3386.67 15902.69,-3381.93 15902.53,-3376.55 15898,-3371.67 15845.82,-3315.38 15324.96,-3307.51 15120.64,-3306.61"/>
<polygon fill="black" stroke="black" points="15120.58,-3303.11 15110.56,-3306.57 15120.55,-3310.11 15120.58,-3303.11"/>
<text text-anchor="middle" x="15947.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l3_gate_gpu6&#45;&gt;l3_expert0_gpu0 -->
<g id="edge1512" class="edge">
<title>l3_gate_gpu6&#45;&gt;l3_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14635,-3414.79C14623.98,-3410.6 14612.3,-3406.91 14601,-3404.67 14561.99,-3396.91 8902.08,-3414.83 8874,-3386.67 8869.29,-3381.94 8869.32,-3376.41 8874,-3371.67 8885.85,-3359.63 10073.11,-3354.04 10090,-3353.67 10669.92,-3340.82 11368.23,-3317.49 11603.3,-3309.42"/>
<polygon fill="black" stroke="black" points="11603.6,-3312.91 11613.47,-3309.07 11603.36,-3305.92 11603.6,-3312.91"/>
<text text-anchor="middle" x="8919.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l3_gate_gpu6&#45;&gt;l3_expert1_gpu1 -->
<g id="edge1513" class="edge">
<title>l3_gate_gpu6&#45;&gt;l3_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14635,-3414.8C14623.97,-3410.61 14612.3,-3406.92 14601,-3404.67 14574.79,-3399.44 10770.86,-3405.61 10752,-3386.67 10747.3,-3381.94 10747.33,-3376.42 10752,-3371.67 10771.72,-3351.59 11736.94,-3355.81 11765,-3353.67 11857.3,-3346.61 11962.56,-3331.29 12032.71,-3320.03"/>
<polygon fill="black" stroke="black" points="12033.48,-3323.45 12042.8,-3318.4 12032.37,-3316.54 12033.48,-3323.45"/>
<text text-anchor="middle" x="10797.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l3_gate_gpu6&#45;&gt;l3_expert2_gpu2 -->
<g id="edge1514" class="edge">
<title>l3_gate_gpu6&#45;&gt;l3_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14745,-3414.79C14756.02,-3410.6 14767.7,-3406.91 14779,-3404.67 14815.37,-3397.43 20092.82,-3412.93 20119,-3386.67 20123.71,-3381.94 20123.64,-3376.46 20119,-3371.67 20085.31,-3336.85 18582.37,-3313.05 18212.55,-3307.72"/>
<polygon fill="black" stroke="black" points="18212.52,-3304.22 18202.47,-3307.57 18212.41,-3311.22 18212.52,-3304.22"/>
<text text-anchor="middle" x="20167.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l3_gate_gpu6&#45;&gt;l3_expert3_gpu3 -->
<g id="edge1515" class="edge">
<title>l3_gate_gpu6&#45;&gt;l3_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14634.99,-3414.84C14623.97,-3410.65 14612.3,-3406.95 14601,-3404.67 14574.17,-3399.25 12649.27,-3406.11 12630,-3386.67 12607.31,-3363.77 12637.99,-3343.56 12673.86,-3329.16"/>
<polygon fill="black" stroke="black" points="12675.48,-3332.29 12683.57,-3325.45 12672.98,-3325.75 12675.48,-3332.29"/>
<text text-anchor="middle" x="12675.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l3_gate_gpu6&#45;&gt;l3_expert4_gpu4 -->
<g id="edge1516" class="edge">
<title>l3_gate_gpu6&#45;&gt;l3_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14635,-3414.78C14623.98,-3410.59 14612.3,-3406.91 14601,-3404.67 14575.49,-3399.61 7128.37,-3405.08 7110,-3386.67 7105.29,-3381.95 7105.34,-3376.43 7110,-3371.67 7160.62,-3319.89 9462.18,-3308.61 9928.22,-3306.86"/>
<polygon fill="black" stroke="black" points="9928.25,-3310.36 9938.24,-3306.82 9928.22,-3303.36 9928.25,-3310.36"/>
<text text-anchor="middle" x="7155.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l3_gate_gpu6&#45;&gt;l3_expert5_gpu5 -->
<g id="edge1517" class="edge">
<title>l3_gate_gpu6&#45;&gt;l3_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14632.67,-3415.72C14622.26,-3411.65 14611.4,-3407.77 14601,-3404.67 14560.66,-3392.62 14547.03,-3402.46 14508,-3386.67 14496.69,-3382.09 14496.48,-3375.8 14485,-3371.67 14396.73,-3339.88 14130.31,-3319.72 13994.5,-3311.22"/>
<polygon fill="black" stroke="black" points="13994.35,-3307.7 13984.16,-3310.58 13993.92,-3314.69 13994.35,-3307.7"/>
<text text-anchor="middle" x="14553.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l3_gate_gpu6&#45;&gt;l3_expert6_gpu6 -->
<g id="edge1518" class="edge">
<title>l3_gate_gpu6&#45;&gt;l3_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14745,-3414.81C14756.03,-3410.62 14767.7,-3406.92 14779,-3404.67 14802.58,-3399.96 18224.04,-3403.71 18241,-3386.67 18245.7,-3381.94 18245.64,-3376.45 18241,-3371.67 18222.35,-3352.45 16535.21,-3316.42 16140.8,-3308.26"/>
<polygon fill="black" stroke="black" points="16140.69,-3304.75 16130.62,-3308.05 16140.54,-3311.75 16140.69,-3304.75"/>
<text text-anchor="middle" x="18290.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l3_gate_gpu6&#45;&gt;l3_expert7_gpu7 -->
<g id="edge1519" class="edge">
<title>l3_gate_gpu6&#45;&gt;l3_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14745.01,-3414.86C14756.04,-3410.67 14767.71,-3406.96 14779,-3404.67 14822.12,-3395.91 16332.06,-3417.96 16363,-3386.67 16367.69,-3381.93 16367.6,-3376.49 16363,-3371.67 16348.22,-3356.18 15999.39,-3354.7 15978,-3353.67 15660.93,-3338.3 15283.69,-3319.11 15120.69,-3310.77"/>
<polygon fill="black" stroke="black" points="15120.43,-3307.25 15110.26,-3310.24 15120.07,-3314.24 15120.43,-3307.25"/>
<text text-anchor="middle" x="16412.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l3_gate_gpu7&#45;&gt;l3_expert0_gpu0 -->
<g id="edge1537" class="edge">
<title>l3_gate_gpu7&#45;&gt;l3_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13389,-3414.79C13377.98,-3410.6 13366.3,-3406.91 13355,-3404.67 13318.86,-3397.48 8075.01,-3412.77 8049,-3386.67 8044.29,-3381.94 8044.31,-3376.4 8049,-3371.67 8068.96,-3351.53 10061.66,-3354.21 10090,-3353.67 10669.96,-3342.55 11368.24,-3318.12 11603.3,-3309.59"/>
<polygon fill="black" stroke="black" points="11603.61,-3313.08 11613.47,-3309.22 11603.35,-3306.09 11603.61,-3313.08"/>
<text text-anchor="middle" x="8094.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l3_gate_gpu7&#45;&gt;l3_expert1_gpu1 -->
<g id="edge1538" class="edge">
<title>l3_gate_gpu7&#45;&gt;l3_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13389,-3414.81C13377.97,-3410.62 13366.3,-3406.92 13355,-3404.67 13331.66,-3400 9943.79,-3403.54 9927,-3386.67 9922.3,-3381.94 9922.31,-3376.4 9927,-3371.67 9944.96,-3353.53 11739.54,-3355.51 11765,-3353.67 11857.33,-3346.98 11962.58,-3331.59 12032.72,-3320.22"/>
<polygon fill="black" stroke="black" points="12033.5,-3323.63 12042.81,-3318.57 12032.38,-3316.73 12033.5,-3323.63"/>
<text text-anchor="middle" x="9972.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l3_gate_gpu7&#45;&gt;l3_expert2_gpu2 -->
<g id="edge1539" class="edge">
<title>l3_gate_gpu7&#45;&gt;l3_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13499,-3414.79C13510.02,-3410.6 13521.7,-3406.91 13533,-3404.67 13572.24,-3396.87 19265.75,-3415 19294,-3386.67 19371.15,-3309.28 18490.38,-3305.47 18213.06,-3306.17"/>
<polygon fill="black" stroke="black" points="18212.66,-3302.67 18202.67,-3306.2 18212.68,-3309.67 18212.66,-3302.67"/>
<text text-anchor="middle" x="19344.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l3_gate_gpu7&#45;&gt;l3_expert3_gpu3 -->
<g id="edge1540" class="edge">
<title>l3_gate_gpu7&#45;&gt;l3_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13388.99,-3414.86C13377.96,-3410.67 13366.29,-3406.96 13355,-3404.67 13312.8,-3396.09 11835.27,-3417.29 11805,-3386.67 11800.31,-3381.92 11800.4,-3376.49 11805,-3371.67 11819.86,-3356.1 12170.52,-3355.07 12192,-3353.67 12361.57,-3342.56 12559.76,-3324.62 12668.09,-3314.39"/>
<polygon fill="black" stroke="black" points="12668.66,-3317.85 12678.28,-3313.42 12668,-3310.88 12668.66,-3317.85"/>
<text text-anchor="middle" x="11850.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l3_gate_gpu7&#45;&gt;l3_expert4_gpu4 -->
<g id="edge1541" class="edge">
<title>l3_gate_gpu7&#45;&gt;l3_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13389,-3414.78C13377.98,-3410.59 13366.3,-3406.91 13355,-3404.67 13330.92,-3399.89 6302.34,-3404.05 6285,-3386.67 6280.29,-3381.95 6280.33,-3376.42 6285,-3371.67 6351.07,-3304.43 9387.74,-3305.68 9928.18,-3306.44"/>
<polygon fill="black" stroke="black" points="9928.22,-3309.94 9938.23,-3306.45 9928.23,-3302.94 9928.22,-3309.94"/>
<text text-anchor="middle" x="6330.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l3_gate_gpu7&#45;&gt;l3_expert5_gpu5 -->
<g id="edge1542" class="edge">
<title>l3_gate_gpu7&#45;&gt;l3_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13500.72,-3415.46C13511.29,-3411.38 13522.36,-3407.55 13533,-3404.67 13588.02,-3389.74 13607.59,-3409.1 13660,-3386.67 13669.89,-3382.43 13669.41,-3376.54 13679,-3371.67 13727.69,-3346.95 13787,-3330.58 13833.72,-3320.44"/>
<polygon fill="black" stroke="black" points="13834.74,-3323.81 13843.79,-3318.31 13833.29,-3316.96 13834.74,-3323.81"/>
<text text-anchor="middle" x="13724.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l3_gate_gpu7&#45;&gt;l3_expert6_gpu6 -->
<g id="edge1543" class="edge">
<title>l3_gate_gpu7&#45;&gt;l3_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13499,-3414.8C13510.03,-3410.61 13521.7,-3406.92 13533,-3404.67 13559.44,-3399.39 17396.98,-3405.78 17416,-3386.67 17420.7,-3381.94 17420.6,-3376.49 17416,-3371.67 17371.87,-3325.37 16428,-3310.8 16141.03,-3307.43"/>
<polygon fill="black" stroke="black" points="16140.74,-3303.93 16130.7,-3307.31 16140.66,-3310.93 16140.74,-3303.93"/>
<text text-anchor="middle" x="17465.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l3_gate_gpu7&#45;&gt;l3_expert7_gpu7 -->
<g id="edge1544" class="edge">
<title>l3_gate_gpu7&#45;&gt;l3_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13499.01,-3414.84C13510.03,-3410.65 13521.7,-3406.95 13533,-3404.67 13560.3,-3399.16 15518.4,-3406.45 15538,-3386.67 15598.25,-3325.88 15276.87,-3311.23 15120.53,-3307.7"/>
<polygon fill="black" stroke="black" points="15120.55,-3304.2 15110.48,-3307.49 15120.4,-3311.2 15120.55,-3304.2"/>
<text text-anchor="middle" x="15591.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l3_gate_gpu8&#45;&gt;l3_expert0_gpu0 -->
<g id="edge1562" class="edge">
<title>l3_gate_gpu8&#45;&gt;l3_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14991,-3414.79C14979.98,-3410.6 14968.3,-3406.91 14957,-3404.67 14917.12,-3396.74 9130.71,-3415.46 9102,-3386.67 9097.29,-3381.94 9097.33,-3376.42 9102,-3371.67 9121.23,-3352.08 10062.56,-3354.32 10090,-3353.67 10669.9,-3339.82 11368.22,-3317.13 11603.29,-3309.32"/>
<polygon fill="black" stroke="black" points="11603.59,-3312.81 11613.47,-3308.98 11603.36,-3305.82 11603.59,-3312.81"/>
<text text-anchor="middle" x="9147.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l3_gate_gpu8&#45;&gt;l3_expert1_gpu1 -->
<g id="edge1563" class="edge">
<title>l3_gate_gpu8&#45;&gt;l3_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14991,-3414.8C14979.98,-3410.61 14968.3,-3406.92 14957,-3404.67 14929.92,-3399.26 10999.48,-3406.24 10980,-3386.67 10975.3,-3381.94 10975.34,-3376.43 10980,-3371.67 10995.25,-3356.07 11743.26,-3355.39 11765,-3353.67 11857.28,-3346.37 11962.54,-3331.1 12032.7,-3319.92"/>
<polygon fill="black" stroke="black" points="12033.47,-3323.34 12042.79,-3318.3 12032.36,-3316.43 12033.47,-3323.34"/>
<text text-anchor="middle" x="11025.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l3_gate_gpu8&#45;&gt;l3_expert2_gpu2 -->
<g id="edge1564" class="edge">
<title>l3_gate_gpu8&#45;&gt;l3_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15101,-3414.79C15112.02,-3410.6 15123.7,-3406.91 15135,-3404.67 15170.5,-3397.61 20321.45,-3412.3 20347,-3386.67 20351.71,-3381.94 20351.64,-3376.45 20347,-3371.67 20309.11,-3332.64 18609.26,-3311.78 18212.97,-3307.44"/>
<polygon fill="black" stroke="black" points="18212.78,-3303.94 18202.74,-3307.33 18212.7,-3310.94 18212.78,-3303.94"/>
<text text-anchor="middle" x="20395.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l3_gate_gpu8&#45;&gt;l3_expert3_gpu3 -->
<g id="edge1565" class="edge">
<title>l3_gate_gpu8&#45;&gt;l3_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14990.99,-3414.84C14979.97,-3410.64 14968.3,-3406.94 14957,-3404.67 14842.68,-3381.63 12968.65,-3423.47 12858,-3386.67 12854.58,-3385.53 12829.39,-3367.08 12804.09,-3348.18"/>
<polygon fill="black" stroke="black" points="12806,-3345.24 12795.9,-3342.04 12801.81,-3350.84 12806,-3345.24"/>
<text text-anchor="middle" x="12903.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l3_gate_gpu8&#45;&gt;l3_expert4_gpu4 -->
<g id="edge1566" class="edge">
<title>l3_gate_gpu8&#45;&gt;l3_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14991,-3414.78C14979.98,-3410.59 14968.3,-3406.91 14957,-3404.67 14931.05,-3399.52 7356.68,-3405.39 7338,-3386.67 7333.29,-3381.95 7333.34,-3376.44 7338,-3371.67 7384.38,-3324.15 9484.91,-3309.57 9928.34,-3307.02"/>
<polygon fill="black" stroke="black" points="9928.53,-3310.52 9938.51,-3306.96 9928.49,-3303.52 9928.53,-3310.52"/>
<text text-anchor="middle" x="7383.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l3_gate_gpu8&#45;&gt;l3_expert5_gpu5 -->
<g id="edge1567" class="edge">
<title>l3_gate_gpu8&#45;&gt;l3_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14989.89,-3415.12C14979.16,-3411.02 14967.88,-3407.27 14957,-3404.67 14861.17,-3381.7 14829.24,-3418.56 14736,-3386.67 14724.45,-3382.72 14724.55,-3375.62 14713,-3371.67 14581.79,-3326.79 14171.02,-3312.35 13994.72,-3308.15"/>
<polygon fill="black" stroke="black" points="13994.54,-3304.65 13984.46,-3307.91 13994.38,-3311.64 13994.54,-3304.65"/>
<text text-anchor="middle" x="14781.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l3_gate_gpu8&#45;&gt;l3_expert6_gpu6 -->
<g id="edge1568" class="edge">
<title>l3_gate_gpu8&#45;&gt;l3_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15101,-3414.81C15112.03,-3410.62 15123.7,-3406.92 15135,-3404.67 15157.7,-3400.13 18452.67,-3403.08 18469,-3386.67 18473.7,-3381.94 18473.65,-3376.44 18469,-3371.67 18458.62,-3361 16560.81,-3317.83 16140.7,-3308.41"/>
<polygon fill="black" stroke="black" points="16140.54,-3304.9 16130.46,-3308.18 16140.38,-3311.9 16140.54,-3304.9"/>
<text text-anchor="middle" x="18518.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l3_gate_gpu8&#45;&gt;l3_expert7_gpu7 -->
<g id="edge1569" class="edge">
<title>l3_gate_gpu8&#45;&gt;l3_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15101.01,-3414.87C15112.04,-3410.68 15123.71,-3406.96 15135,-3404.67 15174.64,-3396.6 16562.58,-3415.44 16591,-3386.67 16595.68,-3381.92 16595.64,-3376.45 16591,-3371.67 16579.13,-3359.44 15995.02,-3354.34 15978,-3353.67 15660.81,-3341.06 15283.63,-3320.43 15120.67,-3311.25"/>
<polygon fill="black" stroke="black" points="15120.43,-3307.73 15110.24,-3310.66 15120.03,-3314.72 15120.43,-3307.73"/>
<text text-anchor="middle" x="16640.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l3_gate_gpu9&#45;&gt;l3_expert0_gpu0 -->
<g id="edge1571" class="edge">
<title>l3_gate_gpu9&#45;&gt;l3_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14457,-3414.79C14445.98,-3410.6 14434.3,-3406.91 14423,-3404.67 14384.43,-3397 8787.76,-3414.52 8760,-3386.67 8755.29,-3381.94 8755.32,-3376.41 8760,-3371.67 8772.97,-3358.51 10071.53,-3354.06 10090,-3353.67 10669.93,-3341.18 11368.23,-3317.62 11603.3,-3309.46"/>
<polygon fill="black" stroke="black" points="11603.6,-3312.95 11613.47,-3309.1 11603.36,-3305.95 11603.6,-3312.95"/>
<text text-anchor="middle" x="8805.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l3_gate_gpu9&#45;&gt;l3_expert1_gpu1 -->
<g id="edge1572" class="edge">
<title>l3_gate_gpu9&#45;&gt;l3_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14457,-3414.8C14445.97,-3410.61 14434.3,-3406.92 14423,-3404.67 14397.22,-3399.52 10656.54,-3405.3 10638,-3386.67 10633.3,-3381.94 10633.32,-3376.42 10638,-3371.67 10659.96,-3349.35 11733.78,-3356.03 11765,-3353.67 11857.3,-3346.69 11962.56,-3331.36 12032.71,-3320.08"/>
<polygon fill="black" stroke="black" points="12033.49,-3323.5 12042.8,-3318.44 12032.37,-3316.59 12033.49,-3323.5"/>
<text text-anchor="middle" x="10683.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l3_gate_gpu9&#45;&gt;l3_expert2_gpu2 -->
<g id="edge1573" class="edge">
<title>l3_gate_gpu9&#45;&gt;l3_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14567,-3414.79C14578.02,-3410.6 14589.7,-3406.91 14601,-3404.67 14637.81,-3397.35 19978.51,-3413.25 20005,-3386.67 20009.71,-3381.94 20009.63,-3376.46 20005,-3371.67 19941.93,-3306.36 18565.36,-3305.45 18212.72,-3306.3"/>
<polygon fill="black" stroke="black" points="18212.57,-3302.8 18202.58,-3306.32 18212.59,-3309.8 18212.57,-3302.8"/>
<text text-anchor="middle" x="20053.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l3_gate_gpu9&#45;&gt;l3_expert3_gpu3 -->
<g id="edge1574" class="edge">
<title>l3_gate_gpu9&#45;&gt;l3_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14456.99,-3414.84C14445.97,-3410.65 14434.3,-3406.95 14423,-3404.67 14397.04,-3399.42 12534.64,-3405.48 12516,-3386.67 12465.4,-3335.59 12581.71,-3317.06 12667.55,-3310.36"/>
<polygon fill="black" stroke="black" points="12667.87,-3313.84 12677.59,-3309.62 12667.36,-3306.86 12667.87,-3313.84"/>
<text text-anchor="middle" x="12561.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l3_gate_gpu9&#45;&gt;l3_expert4_gpu4 -->
<g id="edge1575" class="edge">
<title>l3_gate_gpu9&#45;&gt;l3_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14457,-3414.78C14445.98,-3410.59 14434.3,-3406.91 14423,-3404.67 14397.7,-3399.65 7014.21,-3404.92 6996,-3386.67 6991.29,-3381.95 6991.34,-3376.43 6996,-3371.67 7048.75,-3317.77 9450.99,-3308.16 9928.12,-3306.79"/>
<polygon fill="black" stroke="black" points="9928.37,-3310.29 9938.36,-3306.76 9928.35,-3303.29 9928.37,-3310.29"/>
<text text-anchor="middle" x="7041.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l3_gate_gpu9&#45;&gt;l3_expert5_gpu5 -->
<g id="edge1576" class="edge">
<title>l3_gate_gpu9&#45;&gt;l3_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14456.42,-3415.17C14416.59,-3396.7 14368.24,-3374.66 14358,-3371.67 14234.25,-3335.47 14084.99,-3318.89 13994.62,-3311.68"/>
<polygon fill="black" stroke="black" points="13994.68,-3308.17 13984.44,-3310.89 13994.13,-3315.15 13994.68,-3308.17"/>
<text text-anchor="middle" x="14437.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l3_gate_gpu9&#45;&gt;l3_expert6_gpu6 -->
<g id="edge1577" class="edge">
<title>l3_gate_gpu9&#45;&gt;l3_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14567,-3414.8C14578.03,-3410.62 14589.7,-3406.92 14601,-3404.67 14625.01,-3399.87 18109.73,-3404.02 18127,-3386.67 18131.7,-3381.94 18131.64,-3376.45 18127,-3371.67 18091.84,-3335.38 16519.98,-3312.59 16140.71,-3307.61"/>
<polygon fill="black" stroke="black" points="16140.68,-3304.11 16130.64,-3307.48 16140.59,-3311.11 16140.68,-3304.11"/>
<text text-anchor="middle" x="18176.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l3_gate_gpu9&#45;&gt;l3_expert7_gpu7 -->
<g id="edge1578" class="edge">
<title>l3_gate_gpu9&#45;&gt;l3_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14567.01,-3414.86C14578.04,-3410.66 14589.71,-3406.96 14601,-3404.67 14645.87,-3395.57 16216.81,-3419.21 16249,-3386.67 16253.69,-3381.93 16253.59,-3376.51 16249,-3371.67 16244.13,-3366.53 15391.17,-3323.98 15120.45,-3310.59"/>
<polygon fill="black" stroke="black" points="15120.46,-3307.09 15110.3,-3310.09 15120.11,-3314.08 15120.46,-3307.09"/>
<text text-anchor="middle" x="16298.5" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l3_gate_gpu10&#45;&gt;l3_expert0_gpu0 -->
<g id="edge1580" class="edge">
<title>l3_gate_gpu10&#45;&gt;l3_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M12829.81,-3441.1C12175.46,-3440.47 7736.25,-3434.41 7689,-3386.67 7684.31,-3381.93 7684.3,-3376.4 7689,-3371.67 7700.75,-3359.83 10073.33,-3353.97 10090,-3353.67 10669.97,-3342.93 11368.24,-3318.26 11603.3,-3309.63"/>
<polygon fill="black" stroke="black" points="11603.61,-3313.12 11613.48,-3309.26 11603.35,-3306.13 11603.61,-3313.12"/>
<text text-anchor="middle" x="7739" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l3_gate_gpu10&#45;&gt;l3_expert1_gpu1 -->
<g id="edge1581" class="edge">
<title>l3_gate_gpu10&#45;&gt;l3_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M12829.73,-3441.4C12326.54,-3442.67 9626.06,-3446.7 9567,-3386.67 9562.32,-3381.91 9562.31,-3376.4 9567,-3371.67 9588.5,-3349.99 11734.55,-3355.85 11765,-3353.67 11857.48,-3347.04 11962.91,-3331.6 12033.05,-3320.2"/>
<polygon fill="black" stroke="black" points="12033.84,-3323.62 12043.14,-3318.55 12032.7,-3316.71 12033.84,-3323.62"/>
<text text-anchor="middle" x="9617" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l3_gate_gpu10&#45;&gt;l3_expert2_gpu2 -->
<g id="edge1582" class="edge">
<title>l3_gate_gpu10&#45;&gt;l3_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M12965,-3414.79C12976.02,-3410.6 12987.7,-3406.91 12999,-3404.67 13039.22,-3396.68 18875.05,-3415.71 18904,-3386.67 18908.71,-3381.94 18908.51,-3376.57 18904,-3371.67 18857.91,-3321.53 18402.04,-3309.99 18212.75,-3307.35"/>
<polygon fill="black" stroke="black" points="18212.62,-3303.85 18202.57,-3307.22 18212.52,-3310.85 18212.62,-3303.85"/>
<text text-anchor="middle" x="18958" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l3_gate_gpu10&#45;&gt;l3_expert3_gpu3 -->
<g id="edge1583" class="edge">
<title>l3_gate_gpu10&#45;&gt;l3_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M12829.81,-3441.22C12530.51,-3441.05 11493.33,-3436.83 11445,-3386.67 11440.37,-3381.87 11440.34,-3376.44 11445,-3371.67 11459.5,-3356.81 12171.27,-3354.79 12192,-3353.67 12361.68,-3344.46 12559.83,-3325.82 12668.12,-3314.96"/>
<polygon fill="black" stroke="black" points="12668.72,-3318.42 12678.31,-3313.93 12668.01,-3311.45 12668.72,-3318.42"/>
<text text-anchor="middle" x="11495" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l3_gate_gpu10&#45;&gt;l3_expert4_gpu4 -->
<g id="edge1584" class="edge">
<title>l3_gate_gpu10&#45;&gt;l3_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M12829.83,-3440.93C12057.03,-3438.57 5957,-3418.92 5925,-3386.67 5920.3,-3381.93 5920.32,-3376.42 5925,-3371.67 5961.44,-3334.64 9355.11,-3310.86 9928.24,-3307.11"/>
<polygon fill="black" stroke="black" points="9928.51,-3310.6 9938.48,-3307.04 9928.46,-3303.6 9928.51,-3310.6"/>
<text text-anchor="middle" x="5975" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l3_gate_gpu10&#45;&gt;l3_expert5_gpu5 -->
<g id="edge1585" class="edge">
<title>l3_gate_gpu10&#45;&gt;l3_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M12965.58,-3415.11C12976.46,-3410.95 12987.93,-3407.19 12999,-3404.67 13064.33,-3389.75 13237.38,-3410.52 13300,-3386.67 13310.05,-3382.84 13309.04,-3375.74 13319,-3371.67 13409.79,-3334.48 13690.67,-3316.72 13831.19,-3309.97"/>
<polygon fill="black" stroke="black" points="13831.65,-3313.46 13841.48,-3309.49 13831.32,-3306.46 13831.65,-3313.46"/>
<text text-anchor="middle" x="13369" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l3_gate_gpu10&#45;&gt;l3_expert6_gpu6 -->
<g id="edge1586" class="edge">
<title>l3_gate_gpu10&#45;&gt;l3_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M12965,-3414.8C12976.02,-3410.61 12987.7,-3406.92 12999,-3404.67 13026.35,-3399.21 16995.32,-3406.43 17015,-3386.67 17077.16,-3324.23 16383.51,-3310.3 16140.95,-3307.34"/>
<polygon fill="black" stroke="black" points="16140.83,-3303.84 16130.78,-3307.22 16140.74,-3310.84 16140.83,-3303.84"/>
<text text-anchor="middle" x="17069" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l3_gate_gpu10&#45;&gt;l3_expert7_gpu7 -->
<g id="edge1587" class="edge">
<title>l3_gate_gpu10&#45;&gt;l3_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M12965.01,-3414.83C12976.03,-3410.64 12987.7,-3406.94 12999,-3404.67 13028.67,-3398.69 15156.69,-3408.15 15178,-3386.67 15205.28,-3359.16 15161.87,-3337.9 15116.54,-3324.22"/>
<polygon fill="black" stroke="black" points="15117.44,-3320.84 15106.86,-3321.42 15115.5,-3327.56 15117.44,-3320.84"/>
<text text-anchor="middle" x="15237" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l3_gate_gpu11&#45;&gt;l3_expert0_gpu0 -->
<g id="edge1589" class="edge">
<title>l3_gate_gpu11&#45;&gt;l3_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13567,-3414.79C13555.98,-3410.6 13544.3,-3406.91 13533,-3404.67 13496.42,-3397.39 8189.33,-3413.08 8163,-3386.67 8158.29,-3381.94 8158.31,-3376.4 8163,-3371.67 8181.84,-3352.65 10063.24,-3354.19 10090,-3353.67 10669.96,-3342.4 11368.24,-3318.06 11603.3,-3309.58"/>
<polygon fill="black" stroke="black" points="11603.61,-3313.07 11613.47,-3309.21 11603.35,-3306.07 11603.61,-3313.07"/>
<text text-anchor="middle" x="8213" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l3_gate_gpu11&#45;&gt;l3_expert1_gpu1 -->
<g id="edge1590" class="edge">
<title>l3_gate_gpu11&#45;&gt;l3_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13567,-3414.81C13555.97,-3410.62 13544.3,-3406.92 13533,-3404.67 13509.22,-3399.92 10058.1,-3403.86 10041,-3386.67 10036.3,-3381.94 10036.31,-3376.4 10041,-3371.67 10057.84,-3354.65 11741.12,-3355.4 11765,-3353.67 11857.32,-3346.95 11962.58,-3331.56 12032.72,-3320.2"/>
<polygon fill="black" stroke="black" points="12033.5,-3323.62 12042.81,-3318.56 12032.37,-3316.71 12033.5,-3323.62"/>
<text text-anchor="middle" x="10091" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l3_gate_gpu11&#45;&gt;l3_expert2_gpu2 -->
<g id="edge1591" class="edge">
<title>l3_gate_gpu11&#45;&gt;l3_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13677,-3414.79C13688.02,-3410.6 13699.7,-3406.91 13711,-3404.67 13749.8,-3396.95 19380.07,-3414.69 19408,-3386.67 19412.71,-3381.94 19412.59,-3376.5 19408,-3371.67 19366.76,-3328.27 18488.22,-3311.8 18212.81,-3307.69"/>
<polygon fill="black" stroke="black" points="18212.54,-3304.18 18202.49,-3307.53 18212.44,-3311.18 18212.54,-3304.18"/>
<text text-anchor="middle" x="19461" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l3_gate_gpu11&#45;&gt;l3_expert3_gpu3 -->
<g id="edge1592" class="edge">
<title>l3_gate_gpu11&#45;&gt;l3_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13566.99,-3414.86C13555.96,-3410.67 13544.29,-3406.96 13533,-3404.67 13489.06,-3395.75 11950.53,-3418.55 11919,-3386.67 11876.03,-3343.22 12131.06,-3358.25 12192,-3353.67 12361.45,-3340.92 12559.68,-3323.58 12668.05,-3313.9"/>
<polygon fill="black" stroke="black" points="12668.6,-3317.36 12678.25,-3312.98 12667.98,-3310.39 12668.6,-3317.36"/>
<text text-anchor="middle" x="11969" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l3_gate_gpu11&#45;&gt;l3_expert4_gpu4 -->
<g id="edge1593" class="edge">
<title>l3_gate_gpu11&#45;&gt;l3_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13567,-3414.78C13555.98,-3410.59 13544.3,-3406.91 13533,-3404.67 13508.7,-3399.85 6416.49,-3404.2 6399,-3386.67 6394.29,-3381.95 6394.33,-3376.42 6399,-3371.67 6462.93,-3306.57 9397.51,-3306.05 9928.19,-3306.49"/>
<polygon fill="black" stroke="black" points="9928.43,-3309.99 9938.43,-3306.49 9928.43,-3302.99 9928.43,-3309.99"/>
<text text-anchor="middle" x="6449" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l3_gate_gpu11&#45;&gt;l3_expert5_gpu5 -->
<g id="edge1594" class="edge">
<title>l3_gate_gpu11&#45;&gt;l3_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13680.05,-3416.28C13690.29,-3412.2 13700.9,-3408.17 13711,-3404.67 13738.51,-3395.13 13748.08,-3399.94 13774,-3386.67 13783.58,-3381.76 13784.02,-3377.59 13793,-3371.67 13809.94,-3360.51 13828.96,-3349.53 13846.78,-3339.87"/>
<polygon fill="black" stroke="black" points="13848.82,-3342.75 13855.98,-3334.94 13845.51,-3336.58 13848.82,-3342.75"/>
<text text-anchor="middle" x="13843" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l3_gate_gpu11&#45;&gt;l3_expert6_gpu6 -->
<g id="edge1595" class="edge">
<title>l3_gate_gpu11&#45;&gt;l3_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13677,-3414.8C13688.03,-3410.61 13699.7,-3406.92 13711,-3404.67 13737.01,-3399.48 17511.29,-3405.46 17530,-3386.67 17534.7,-3381.94 17534.61,-3376.48 17530,-3371.67 17481.7,-3321.18 16442.91,-3309.46 16140.75,-3307.11"/>
<polygon fill="black" stroke="black" points="16140.77,-3303.61 16130.74,-3307.03 16140.71,-3310.61 16140.77,-3303.61"/>
<text text-anchor="middle" x="17584" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l3_gate_gpu11&#45;&gt;l3_expert7_gpu7 -->
<g id="edge1596" class="edge">
<title>l3_gate_gpu11&#45;&gt;l3_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13677.01,-3414.84C13688.03,-3410.65 13699.7,-3406.95 13711,-3404.67 13737.43,-3399.33 15633.03,-3405.82 15652,-3386.67 15656.69,-3381.93 15656.46,-3376.62 15652,-3371.67 15617.09,-3332.86 15279.38,-3315.4 15120.66,-3309.29"/>
<polygon fill="black" stroke="black" points="15120.6,-3305.79 15110.47,-3308.91 15120.33,-3312.78 15120.6,-3305.79"/>
<text text-anchor="middle" x="15706" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l3_gate_gpu12&#45;&gt;l3_expert0_gpu0 -->
<g id="edge1598" class="edge">
<title>l3_gate_gpu12&#45;&gt;l3_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13033,-3414.79C13021.98,-3410.6 13010.3,-3406.91 12999,-3404.67 12963.67,-3397.64 7837.43,-3412.18 7812,-3386.67 7807.29,-3381.94 7807.3,-3376.4 7812,-3371.67 7823.14,-3360.44 10074.18,-3353.96 10090,-3353.67 10669.96,-3342.82 11368.24,-3318.22 11603.3,-3309.62"/>
<polygon fill="black" stroke="black" points="11603.61,-3313.11 11613.48,-3309.25 11603.35,-3306.11 11603.61,-3313.11"/>
<text text-anchor="middle" x="7862" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l3_gate_gpu12&#45;&gt;l3_expert1_gpu1 -->
<g id="edge1599" class="edge">
<title>l3_gate_gpu12&#45;&gt;l3_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13033,-3414.81C13021.97,-3410.62 13010.3,-3406.93 12999,-3404.67 12953.93,-3395.66 9722.41,-3419.25 9690,-3386.67 9685.3,-3381.94 9685.31,-3376.4 9690,-3371.67 9710.29,-3351.2 11736.25,-3355.73 11765,-3353.67 11857.47,-3347.02 11962.91,-3331.58 12033.05,-3320.19"/>
<polygon fill="black" stroke="black" points="12033.83,-3323.61 12043.14,-3318.54 12032.7,-3316.7 12033.83,-3323.61"/>
<text text-anchor="middle" x="9740" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l3_gate_gpu12&#45;&gt;l3_expert2_gpu2 -->
<g id="edge1600" class="edge">
<title>l3_gate_gpu12&#45;&gt;l3_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13143,-3414.79C13154.02,-3410.6 13165.7,-3406.91 13177,-3404.67 13217.05,-3396.71 19028.17,-3415.58 19057,-3386.67 19061.71,-3381.94 19061.55,-3376.54 19057,-3371.67 19000.07,-3310.59 18428.51,-3305.75 18212.82,-3306.12"/>
<polygon fill="black" stroke="black" points="18212.5,-3302.62 18202.51,-3306.14 18212.52,-3309.62 18212.5,-3302.62"/>
<text text-anchor="middle" x="19111" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l3_gate_gpu12&#45;&gt;l3_expert3_gpu3 -->
<g id="edge1601" class="edge">
<title>l3_gate_gpu12&#45;&gt;l3_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13032.99,-3414.87C13021.96,-3410.68 13010.29,-3406.97 12999,-3404.67 12960.05,-3396.73 11595.93,-3414.95 11568,-3386.67 11563.32,-3381.92 11563.35,-3376.45 11568,-3371.67 11580.08,-3359.23 12174.69,-3354.65 12192,-3353.67 12361.66,-3344.06 12559.82,-3325.56 12668.11,-3314.84"/>
<polygon fill="black" stroke="black" points="12668.7,-3318.3 12678.31,-3313.82 12668.01,-3311.33 12668.7,-3318.3"/>
<text text-anchor="middle" x="11618" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l3_gate_gpu12&#45;&gt;l3_expert4_gpu4 -->
<g id="edge1602" class="edge">
<title>l3_gate_gpu12&#45;&gt;l3_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13033,-3414.78C13021.98,-3410.59 13010.3,-3406.91 12999,-3404.67 12975.33,-3399.97 6065.04,-3403.75 6048,-3386.67 6043.29,-3381.95 6043.32,-3376.42 6048,-3371.67 6118.54,-3299.96 9368.71,-3304.96 9928.37,-3306.35"/>
<polygon fill="black" stroke="black" points="9928.37,-3309.85 9938.37,-3306.38 9928.38,-3302.85 9928.37,-3309.85"/>
<text text-anchor="middle" x="6098" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l3_gate_gpu12&#45;&gt;l3_expert5_gpu5 -->
<g id="edge1603" class="edge">
<title>l3_gate_gpu12&#45;&gt;l3_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13144.09,-3415.05C13154.82,-3410.95 13166.11,-3407.23 13177,-3404.67 13283.71,-3379.55 13320.82,-3426.38 13423,-3386.67 13433.03,-3382.77 13432.1,-3375.88 13442,-3371.67 13510.46,-3342.49 13716.14,-3322.13 13831.78,-3312.64"/>
<polygon fill="black" stroke="black" points="13832.31,-3316.1 13842,-3311.81 13831.75,-3309.13 13832.31,-3316.1"/>
<text text-anchor="middle" x="13492" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l3_gate_gpu12&#45;&gt;l3_expert6_gpu6 -->
<g id="edge1604" class="edge">
<title>l3_gate_gpu12&#45;&gt;l3_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13143,-3414.8C13154.02,-3410.61 13165.7,-3406.92 13177,-3404.67 13204.26,-3399.23 17159.39,-3406.36 17179,-3386.67 17253,-3312.33 16410.88,-3306.38 16140.79,-3306.37"/>
<polygon fill="black" stroke="black" points="16140.66,-3302.87 16130.66,-3306.38 16140.66,-3309.87 16140.66,-3302.87"/>
<text text-anchor="middle" x="17234" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l3_gate_gpu12&#45;&gt;l3_expert7_gpu7 -->
<g id="edge1605" class="edge">
<title>l3_gate_gpu12&#45;&gt;l3_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13143.01,-3414.84C13154.03,-3410.64 13165.7,-3406.94 13177,-3404.67 13205.92,-3398.84 15280.23,-3407.61 15301,-3386.67 15359.22,-3327.95 15217.54,-3312.05 15120.61,-3307.89"/>
<polygon fill="black" stroke="black" points="15120.63,-3304.39 15110.5,-3307.49 15120.36,-3311.38 15120.63,-3304.39"/>
<text text-anchor="middle" x="15362" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l3_gate_gpu13&#45;&gt;l3_expert0_gpu0 -->
<g id="edge1607" class="edge">
<title>l3_gate_gpu13&#45;&gt;l3_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13745,-3414.79C13733.98,-3410.6 13722.3,-3406.91 13711,-3404.67 13674.05,-3397.32 8312.6,-3413.35 8286,-3386.67 8281.29,-3381.94 8281.31,-3376.4 8286,-3371.67 8303.63,-3353.86 10064.95,-3354.16 10090,-3353.67 10669.95,-3342.21 11368.24,-3318 11603.3,-3309.56"/>
<polygon fill="black" stroke="black" points="11603.61,-3313.05 11613.47,-3309.19 11603.35,-3306.05 11603.61,-3313.05"/>
<text text-anchor="middle" x="8336" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l3_gate_gpu13&#45;&gt;l3_expert1_gpu1 -->
<g id="edge1608" class="edge">
<title>l3_gate_gpu13&#45;&gt;l3_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13745,-3414.8C13733.97,-3410.61 13722.3,-3406.92 13711,-3404.67 13686.84,-3399.84 10181.37,-3404.13 10164,-3386.67 10159.3,-3381.94 10159.31,-3376.41 10164,-3371.67 10179.64,-3355.85 11742.82,-3355.29 11765,-3353.67 11857.32,-3346.91 11962.57,-3331.53 12032.72,-3320.18"/>
<polygon fill="black" stroke="black" points="12033.5,-3323.6 12042.81,-3318.54 12032.37,-3316.69 12033.5,-3323.6"/>
<text text-anchor="middle" x="10214" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l3_gate_gpu13&#45;&gt;l3_expert2_gpu2 -->
<g id="edge1609" class="edge">
<title>l3_gate_gpu13&#45;&gt;l3_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13855,-3414.79C13866.02,-3410.6 13877.7,-3406.91 13889,-3404.67 13927.43,-3397.03 19503.34,-3414.42 19531,-3386.67 19535.71,-3381.94 19535.6,-3376.49 19531,-3371.67 19485.29,-3323.78 18505.17,-3310.27 18212.69,-3307.3"/>
<polygon fill="black" stroke="black" points="18212.61,-3303.8 18202.58,-3307.2 18212.54,-3310.8 18212.61,-3303.8"/>
<text text-anchor="middle" x="19584" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l3_gate_gpu13&#45;&gt;l3_expert3_gpu3 -->
<g id="edge1610" class="edge">
<title>l3_gate_gpu13&#45;&gt;l3_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13744.99,-3414.86C13733.96,-3410.66 13722.29,-3406.96 13711,-3404.67 13688.28,-3400.06 12058.3,-3403.15 12042,-3386.67 12037.31,-3381.93 12037.51,-3376.59 12042,-3371.67 12047.24,-3365.93 12483.05,-3328.83 12667.74,-3313.35"/>
<polygon fill="black" stroke="black" points="12668.27,-3316.82 12677.94,-3312.5 12667.68,-3309.85 12668.27,-3316.82"/>
<text text-anchor="middle" x="12092" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l3_gate_gpu13&#45;&gt;l3_expert4_gpu4 -->
<g id="edge1611" class="edge">
<title>l3_gate_gpu13&#45;&gt;l3_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13745,-3414.78C13733.98,-3410.59 13722.3,-3406.91 13711,-3404.67 13686.52,-3399.81 6539.63,-3404.34 6522,-3386.67 6517.29,-3381.95 6517.33,-3376.42 6522,-3371.67 6583.62,-3308.88 9407.79,-3306.45 9928.08,-3306.54"/>
<polygon fill="black" stroke="black" points="9928.13,-3310.04 9938.13,-3306.54 9928.13,-3303.04 9928.13,-3310.04"/>
<text text-anchor="middle" x="6572" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l3_gate_gpu13&#45;&gt;l3_expert5_gpu5 -->
<g id="edge1612" class="edge">
<title>l3_gate_gpu13&#45;&gt;l3_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13860.62,-3417.62C13874.4,-3409.68 13887.69,-3399.48 13897,-3386.67 13901.97,-3379.82 13905.49,-3371.82 13907.97,-3363.57"/>
<polygon fill="black" stroke="black" points="13911.38,-3364.38 13910.43,-3353.82 13904.59,-3362.67 13911.38,-3364.38"/>
<text text-anchor="middle" x="13955" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l3_gate_gpu13&#45;&gt;l3_expert6_gpu6 -->
<g id="edge1613" class="edge">
<title>l3_gate_gpu13&#45;&gt;l3_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13855,-3414.8C13866.03,-3410.61 13877.7,-3406.92 13889,-3404.67 13914.63,-3399.55 17634.56,-3405.19 17653,-3386.67 17657.7,-3381.94 17657.62,-3376.48 17653,-3371.67 17600.2,-3316.66 16458.54,-3308.13 16140.56,-3306.82"/>
<polygon fill="black" stroke="black" points="16140.51,-3303.32 16130.49,-3306.78 16140.48,-3310.32 16140.51,-3303.32"/>
<text text-anchor="middle" x="17707" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l3_gate_gpu13&#45;&gt;l3_expert7_gpu7 -->
<g id="edge1614" class="edge">
<title>l3_gate_gpu13&#45;&gt;l3_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M13855.01,-3414.84C13866.03,-3410.65 13877.71,-3406.95 13889,-3404.67 13914.68,-3399.48 15756.57,-3405.28 15775,-3386.67 15779.69,-3381.93 15779.5,-3376.58 15775,-3371.67 15731.51,-3324.16 15303.31,-3311.14 15120.76,-3307.73"/>
<polygon fill="black" stroke="black" points="15120.74,-3304.23 15110.67,-3307.55 15120.61,-3311.23 15120.74,-3304.23"/>
<text text-anchor="middle" x="15829" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l3_gate_gpu14&#45;&gt;l3_expert0_gpu0 -->
<g id="edge1616" class="edge">
<title>l3_gate_gpu14&#45;&gt;l3_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14101,-3414.79C14089.98,-3410.6 14078.3,-3406.91 14067,-3404.67 14029.24,-3397.16 8550.18,-3413.93 8523,-3386.67 8518.29,-3381.94 8518.31,-3376.41 8523,-3371.67 8538.3,-3356.19 10068.24,-3354.11 10090,-3353.67 10669.94,-3341.78 11368.23,-3317.84 11603.3,-3309.51"/>
<polygon fill="black" stroke="black" points="11603.6,-3313.01 11613.47,-3309.15 11603.36,-3306.01 11603.6,-3313.01"/>
<text text-anchor="middle" x="8573" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l3_gate_gpu14&#45;&gt;l3_expert1_gpu1 -->
<g id="edge1617" class="edge">
<title>l3_gate_gpu14&#45;&gt;l3_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14101,-3414.8C14089.97,-3410.61 14078.3,-3406.92 14067,-3404.67 14042.03,-3399.68 10418.96,-3404.71 10401,-3386.67 10396.3,-3381.94 10396.32,-3376.41 10401,-3371.67 10414.31,-3358.18 11746.11,-3355.07 11765,-3353.67 11857.31,-3346.82 11962.57,-3331.46 12032.71,-3320.14"/>
<polygon fill="black" stroke="black" points="12033.49,-3323.56 12042.8,-3318.5 12032.37,-3316.65 12033.49,-3323.56"/>
<text text-anchor="middle" x="10451" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l3_gate_gpu14&#45;&gt;l3_expert2_gpu2 -->
<g id="edge1618" class="edge">
<title>l3_gate_gpu14&#45;&gt;l3_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14211,-3414.79C14222.02,-3410.6 14233.7,-3406.91 14245,-3404.67 14282.62,-3397.19 19740.92,-3413.83 19768,-3386.67 19772.71,-3381.94 19772.62,-3376.47 19768,-3371.67 19713.64,-3315.1 18536.69,-3307.69 18212.84,-3306.73"/>
<polygon fill="black" stroke="black" points="18212.6,-3303.23 18202.59,-3306.7 18212.58,-3310.23 18212.6,-3303.23"/>
<text text-anchor="middle" x="19821" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l3_gate_gpu14&#45;&gt;l3_expert3_gpu3 -->
<g id="edge1619" class="edge">
<title>l3_gate_gpu14&#45;&gt;l3_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14100.99,-3414.85C14089.97,-3410.66 14078.29,-3406.95 14067,-3404.67 14042.66,-3399.74 12296.47,-3404.31 12279,-3386.67 12222.79,-3329.88 12518.67,-3313.2 12667.56,-3308.43"/>
<polygon fill="black" stroke="black" points="12667.69,-3311.93 12677.58,-3308.12 12667.48,-3304.93 12667.69,-3311.93"/>
<text text-anchor="middle" x="12329" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l3_gate_gpu14&#45;&gt;l3_expert4_gpu4 -->
<g id="edge1620" class="edge">
<title>l3_gate_gpu14&#45;&gt;l3_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14101,-3414.78C14089.98,-3410.59 14078.3,-3406.91 14067,-3404.67 14042.11,-3399.73 6776.92,-3404.63 6759,-3386.67 6754.29,-3381.95 6754.33,-3376.43 6759,-3371.67 6816.18,-3313.33 9429.17,-3307.28 9928.14,-3306.65"/>
<polygon fill="black" stroke="black" points="9928.15,-3310.15 9938.15,-3306.64 9928.14,-3303.15 9928.15,-3310.15"/>
<text text-anchor="middle" x="6809" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l3_gate_gpu14&#45;&gt;l3_expert5_gpu5 -->
<g id="edge1621" class="edge">
<title>l3_gate_gpu14&#45;&gt;l3_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14143.23,-3404.93C14137.45,-3392.92 14129.51,-3380.41 14119,-3371.67 14083.57,-3342.2 14034.7,-3326.02 13993.44,-3317.17"/>
<polygon fill="black" stroke="black" points="13993.9,-3313.69 13983.41,-3315.13 13992.51,-3320.55 13993.9,-3313.69"/>
<text text-anchor="middle" x="14182" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l3_gate_gpu14&#45;&gt;l3_expert6_gpu6 -->
<g id="edge1622" class="edge">
<title>l3_gate_gpu14&#45;&gt;l3_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14211,-3414.8C14222.03,-3410.61 14233.7,-3406.92 14245,-3404.67 14269.82,-3399.71 17872.15,-3404.61 17890,-3386.67 17894.7,-3381.94 17894.63,-3376.46 17890,-3371.67 17828.51,-3307.96 16488.54,-3305.84 16140.83,-3306.37"/>
<polygon fill="black" stroke="black" points="16140.58,-3302.87 16130.59,-3306.38 16140.59,-3309.87 16140.58,-3302.87"/>
<text text-anchor="middle" x="17944" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l3_gate_gpu14&#45;&gt;l3_expert7_gpu7 -->
<g id="edge1623" class="edge">
<title>l3_gate_gpu14&#45;&gt;l3_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M14211.01,-3414.85C14222.03,-3410.66 14233.71,-3406.95 14245,-3404.67 14269.06,-3399.8 15994.73,-3404.11 16012,-3386.67 16075.18,-3322.84 15366.75,-3309.8 15121.1,-3307.21"/>
<polygon fill="black" stroke="black" points="15120.85,-3303.71 15110.81,-3307.1 15120.77,-3310.71 15120.85,-3303.71"/>
<text text-anchor="middle" x="16066" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l3_gate_gpu15&#45;&gt;l3_expert0_gpu0 -->
<g id="edge1625" class="edge">
<title>l3_gate_gpu15&#45;&gt;l3_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15169,-3414.79C15157.98,-3410.6 15146.3,-3406.91 15135,-3404.67 15094.68,-3396.66 9245.02,-3415.78 9216,-3386.67 9211.29,-3381.94 9211.33,-3376.43 9216,-3371.67 9232.99,-3354.32 10065.72,-3354.27 10090,-3353.67 10669.88,-3339.14 11368.21,-3316.88 11603.29,-3309.25"/>
<polygon fill="black" stroke="black" points="11603.59,-3312.74 11613.47,-3308.92 11603.36,-3305.75 11603.59,-3312.74"/>
<text text-anchor="middle" x="9266" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l3_gate_gpu15&#45;&gt;l3_expert1_gpu1 -->
<g id="edge1626" class="edge">
<title>l3_gate_gpu15&#45;&gt;l3_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15169,-3414.8C15157.98,-3410.61 15146.3,-3406.92 15135,-3404.67 15107.48,-3399.18 11113.8,-3406.55 11094,-3386.67 11089.3,-3381.94 11089.35,-3376.44 11094,-3371.67 11107.01,-3358.31 11746.42,-3355.17 11765,-3353.67 11857.27,-3346.19 11962.53,-3330.95 12032.69,-3319.83"/>
<polygon fill="black" stroke="black" points="12033.46,-3323.25 12042.78,-3318.22 12032.36,-3316.34 12033.46,-3323.25"/>
<text text-anchor="middle" x="11144" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l3_gate_gpu15&#45;&gt;l3_expert2_gpu2 -->
<g id="edge1627" class="edge">
<title>l3_gate_gpu15&#45;&gt;l3_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15279,-3414.79C15290.02,-3410.6 15301.7,-3406.91 15313,-3404.67 15348.06,-3397.69 20435.77,-3411.99 20461,-3386.67 20465.71,-3381.94 20465.65,-3376.45 20461,-3371.67 20420.99,-3330.52 18621.2,-3311.18 18212.82,-3307.32"/>
<polygon fill="black" stroke="black" points="18212.61,-3303.82 18202.57,-3307.22 18212.54,-3310.82 18212.61,-3303.82"/>
<text text-anchor="middle" x="20514" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l3_gate_gpu15&#45;&gt;l3_expert3_gpu3 -->
<g id="edge1628" class="edge">
<title>l3_gate_gpu15&#45;&gt;l3_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15168.99,-3414.83C15157.97,-3410.64 15146.3,-3406.94 15135,-3404.67 15017.2,-3380.94 13087.05,-3421.39 12972,-3386.67 12960.32,-3383.14 12960.01,-3376.93 12949,-3371.67 12909.69,-3352.86 12863.57,-3337.44 12825.53,-3326.34"/>
<polygon fill="black" stroke="black" points="12826.11,-3322.87 12815.54,-3323.47 12824.18,-3329.6 12826.11,-3322.87"/>
<text text-anchor="middle" x="13022" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l3_gate_gpu15&#45;&gt;l3_expert4_gpu4 -->
<g id="edge1629" class="edge">
<title>l3_gate_gpu15&#45;&gt;l3_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15169,-3414.78C15157.98,-3410.59 15146.3,-3406.91 15135,-3404.67 15108.83,-3399.48 7470.84,-3405.55 7452,-3386.67 7447.29,-3381.95 7447.35,-3376.44 7452,-3371.67 7496.24,-3326.28 9495.45,-3310.09 9928.02,-3307.11"/>
<polygon fill="black" stroke="black" points="9928.28,-3310.61 9938.25,-3307.04 9928.23,-3303.61 9928.28,-3310.61"/>
<text text-anchor="middle" x="7502" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l3_gate_gpu15&#45;&gt;l3_expert5_gpu5 -->
<g id="edge1630" class="edge">
<title>l3_gate_gpu15&#45;&gt;l3_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15168.41,-3415.14C15157.53,-3410.98 15146.07,-3407.21 15135,-3404.67 15011.31,-3376.21 14970.46,-3426.65 14850,-3386.67 14838.42,-3382.82 14838.57,-3375.56 14827,-3371.67 14673.96,-3320.19 14188.94,-3309.43 13994.65,-3307.18"/>
<polygon fill="black" stroke="black" points="13994.54,-3303.68 13984.5,-3307.06 13994.46,-3310.68 13994.54,-3303.68"/>
<text text-anchor="middle" x="14900" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l3_gate_gpu15&#45;&gt;l3_expert6_gpu6 -->
<g id="edge1631" class="edge">
<title>l3_gate_gpu15&#45;&gt;l3_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15279,-3414.81C15290.03,-3410.62 15301.7,-3406.93 15313,-3404.67 15357.54,-3395.76 18550.97,-3418.87 18583,-3386.67 18587.7,-3381.94 18587.65,-3376.44 18583,-3371.67 18577.54,-3366.07 16573.9,-3318.68 16140.88,-3308.5"/>
<polygon fill="black" stroke="black" points="16140.72,-3305 16130.64,-3308.26 16140.55,-3312 16140.72,-3305"/>
<text text-anchor="middle" x="18637" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l3_gate_gpu15&#45;&gt;l3_expert7_gpu7 -->
<g id="edge1632" class="edge">
<title>l3_gate_gpu15&#45;&gt;l3_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15279.01,-3414.88C15290.04,-3410.68 15301.71,-3406.97 15313,-3404.67 15350.48,-3397.02 16663.13,-3413.89 16690,-3386.67 16694.68,-3381.92 16694.65,-3376.44 16690,-3371.67 16676.19,-3357.5 15997.77,-3354.41 15978,-3353.67 15660.78,-3341.71 15283.62,-3320.74 15120.66,-3311.36"/>
<polygon fill="black" stroke="black" points="15120.43,-3307.84 15110.24,-3310.76 15120.02,-3314.83 15120.43,-3307.84"/>
<text text-anchor="middle" x="16744" y="-3375.47" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l4_attn_stage0_gpu0 -->
<g id="node1001" class="node">
<title>l4_attn_stage0_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="13574" cy="-2895.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13574" y="-2907.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="13574" y="-2892.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13574" y="-2877.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu0 -->
<g id="node1017" class="node">
<title>l4_attn_stage1_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="13574" cy="-2748.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13574" y="-2760.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="13574" y="-2745.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13574" y="-2730.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu0&#45;&gt;l4_attn_stage1_gpu0 -->
<g id="edge1649" class="edge">
<title>l4_attn_stage0_gpu0&#45;&gt;l4_attn_stage1_gpu0</title>
<path fill="none" stroke="black" d="M13574,-2858.24C13574,-2839.53 13574,-2816.53 13574,-2796.55"/>
<polygon fill="black" stroke="black" points="13577.5,-2796.41 13574,-2786.41 13570.5,-2796.41 13577.5,-2796.41"/>
</g>
<!-- l4_attn_stage1_gpu[next_gpu] -->
<g id="node1390" class="node">
<title>l4_attn_stage1_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="15201" cy="-2748.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="15201" y="-2745.13" font-family="Times,serif" font-size="14.00">l4_attn_stage1_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage0_gpu0&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2961" class="edge">
<title>l4_attn_stage0_gpu0&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13626.97,-2865.68C13640.89,-2859.39 13656.17,-2853.64 13671,-2850.33 13737.59,-2835.5 14834.64,-2862.97 14899,-2840.33 14909.15,-2836.76 14907.96,-2829.2 14918,-2825.33 14968.3,-2805.99 14986.53,-2829.64 15039,-2817.33 15082.2,-2807.2 15128.67,-2786.75 15160.71,-2771.01"/>
<polygon fill="red" stroke="red" points="15162.38,-2774.09 15169.77,-2766.49 15159.25,-2767.82 15162.38,-2774.09"/>
<text text-anchor="middle" x="14949.5" y="-2829.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu1 -->
<g id="node1002" class="node">
<title>l4_attn_stage0_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14354" cy="-2895.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14354" y="-2907.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="14354" y="-2892.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14354" y="-2877.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu1 -->
<g id="node1018" class="node">
<title>l4_attn_stage1_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14354" cy="-2748.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14354" y="-2760.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="14354" y="-2745.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14354" y="-2730.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu1&#45;&gt;l4_attn_stage1_gpu1 -->
<g id="edge1650" class="edge">
<title>l4_attn_stage0_gpu1&#45;&gt;l4_attn_stage1_gpu1</title>
<path fill="none" stroke="black" d="M14298.51,-2866.52C14284.88,-2860.44 14270.14,-2854.58 14256,-2850.33 14242.42,-2846.25 14202.2,-2851.11 14193,-2840.33 14158.44,-2799.85 14200.28,-2838.61 14256,-2817.33 14273.91,-2810.49 14291.72,-2799.74 14307.14,-2788.81"/>
<polygon fill="black" stroke="black" points="14309.44,-2791.47 14315.45,-2782.75 14305.31,-2785.82 14309.44,-2791.47"/>
</g>
<!-- l4_attn_stage0_gpu1&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2962" class="edge">
<title>l4_attn_stage0_gpu1&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14406.98,-2865.73C14420.9,-2859.43 14436.18,-2853.67 14451,-2850.33 14472.46,-2845.5 15227.54,-2855.99 15243,-2840.33 15261.16,-2821.94 15243.89,-2794.25 15226.31,-2774.34"/>
<polygon fill="red" stroke="red" points="15228.75,-2771.82 15219.38,-2766.87 15223.61,-2776.58 15228.75,-2771.82"/>
<text text-anchor="middle" x="15282.5" y="-2829.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu2 -->
<g id="node1003" class="node">
<title>l4_attn_stage0_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="12404" cy="-2895.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12404" y="-2907.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="12404" y="-2892.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12404" y="-2877.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu2 -->
<g id="node1019" class="node">
<title>l4_attn_stage1_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="12404" cy="-2748.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12404" y="-2760.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="12404" y="-2745.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12404" y="-2730.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu2&#45;&gt;l4_attn_stage1_gpu2 -->
<g id="edge1651" class="edge">
<title>l4_attn_stage0_gpu2&#45;&gt;l4_attn_stage1_gpu2</title>
<path fill="none" stroke="black" d="M12404,-2858.24C12404,-2839.53 12404,-2816.53 12404,-2796.55"/>
<polygon fill="black" stroke="black" points="12407.5,-2796.41 12404,-2786.41 12400.5,-2796.41 12407.5,-2796.41"/>
</g>
<!-- l4_attn_stage0_gpu2&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2963" class="edge">
<title>l4_attn_stage0_gpu2&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12456.96,-2865.65C12470.88,-2859.36 12486.17,-2853.61 12501,-2850.33 12552.04,-2839.04 14333.66,-2857.61 14383,-2840.33 14393.15,-2836.78 14391.86,-2828.93 14402,-2825.33 14435.36,-2813.52 15004.34,-2824.49 15039,-2817.33 15082.86,-2808.27 15129.76,-2787.36 15161.75,-2771.2"/>
<polygon fill="red" stroke="red" points="15163.48,-2774.25 15170.77,-2766.57 15160.28,-2768.02 15163.48,-2774.25"/>
<text text-anchor="middle" x="14433.5" y="-2829.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu3 -->
<g id="node1004" class="node">
<title>l4_attn_stage0_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14744" cy="-2895.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14744" y="-2907.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="14744" y="-2892.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14744" y="-2877.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu3 -->
<g id="node1020" class="node">
<title>l4_attn_stage1_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14744" cy="-2748.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14744" y="-2760.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="14744" y="-2745.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14744" y="-2730.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu3&#45;&gt;l4_attn_stage1_gpu3 -->
<g id="edge1652" class="edge">
<title>l4_attn_stage0_gpu3&#45;&gt;l4_attn_stage1_gpu3</title>
<path fill="none" stroke="black" d="M14690.43,-2865.83C14676.36,-2859.54 14660.94,-2853.74 14646,-2850.33 14622.22,-2844.9 14224.05,-2857.78 14207,-2840.33 14202.34,-2835.57 14202.33,-2830.09 14207,-2825.33 14215.55,-2816.63 14634.39,-2821.06 14646,-2817.33 14664.59,-2811.36 14682.81,-2800.6 14698.4,-2789.4"/>
<polygon fill="black" stroke="black" points="14700.84,-2791.94 14706.77,-2783.16 14696.66,-2786.33 14700.84,-2791.94"/>
</g>
<!-- l4_attn_stage0_gpu3&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2964" class="edge">
<title>l4_attn_stage0_gpu3&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14796.99,-2865.78C14810.91,-2859.48 14826.19,-2853.7 14841,-2850.33 14856.55,-2846.79 15403.82,-2851.71 15415,-2840.33 15455.03,-2799.6 15385.32,-2776.24 15315.01,-2763.49"/>
<polygon fill="red" stroke="red" points="15315.55,-2760.04 15305.1,-2761.77 15314.35,-2766.93 15315.55,-2760.04"/>
<text text-anchor="middle" x="15456.5" y="-2829.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu4 -->
<g id="node1005" class="node">
<title>l4_attn_stage0_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13964" cy="-2895.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13964" y="-2907.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="13964" y="-2892.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13964" y="-2877.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu4 -->
<g id="node1021" class="node">
<title>l4_attn_stage1_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13964" cy="-2748.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13964" y="-2760.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="13964" y="-2745.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13964" y="-2730.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu4&#45;&gt;l4_attn_stage1_gpu4 -->
<g id="edge1653" class="edge">
<title>l4_attn_stage0_gpu4&#45;&gt;l4_attn_stage1_gpu4</title>
<path fill="none" stroke="black" d="M13964,-2858.24C13964,-2839.53 13964,-2816.53 13964,-2796.55"/>
<polygon fill="black" stroke="black" points="13967.5,-2796.41 13964,-2786.41 13960.5,-2796.41 13967.5,-2796.41"/>
</g>
<!-- l4_attn_stage0_gpu4&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2965" class="edge">
<title>l4_attn_stage0_gpu4&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14016.97,-2865.7C14030.89,-2859.41 14046.17,-2853.65 14061,-2850.33 14115.76,-2838.09 15018.08,-2859 15071,-2840.33 15081.15,-2836.75 15081.32,-2831.7 15090,-2825.33 15115.22,-2806.84 15144.5,-2786.99 15166.65,-2772.29"/>
<polygon fill="red" stroke="red" points="15168.66,-2775.15 15175.07,-2766.72 15164.8,-2769.31 15168.66,-2775.15"/>
<text text-anchor="middle" x="15121.5" y="-2829.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu5 -->
<g id="node1006" class="node">
<title>l4_attn_stage0_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="12014" cy="-2895.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12014" y="-2907.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="12014" y="-2892.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12014" y="-2877.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu5 -->
<g id="node1022" class="node">
<title>l4_attn_stage1_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="12014" cy="-2748.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12014" y="-2760.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="12014" y="-2745.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12014" y="-2730.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu5&#45;&gt;l4_attn_stage1_gpu5 -->
<g id="edge1654" class="edge">
<title>l4_attn_stage0_gpu5&#45;&gt;l4_attn_stage1_gpu5</title>
<path fill="none" stroke="black" d="M12014,-2858.24C12014,-2839.53 12014,-2816.53 12014,-2796.55"/>
<polygon fill="black" stroke="black" points="12017.5,-2796.41 12014,-2786.41 12010.5,-2796.41 12017.5,-2796.41"/>
</g>
<!-- l4_attn_stage0_gpu5&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2966" class="edge">
<title>l4_attn_stage0_gpu5&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12066.97,-2865.72C12080.9,-2859.43 12096.18,-2853.66 12111,-2850.33 12340.74,-2798.73 13994.55,-2827.89 14230,-2825.33 14274.94,-2824.85 14994.97,-2826.37 15039,-2817.33 15082.87,-2808.33 15129.77,-2787.41 15161.76,-2771.23"/>
<polygon fill="red" stroke="red" points="15163.49,-2774.28 15170.78,-2766.59 15160.28,-2768.05 15163.49,-2774.28"/>
<text text-anchor="middle" x="14261.5" y="-2829.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu6 -->
<g id="node1007" class="node">
<title>l4_attn_stage0_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14549" cy="-2895.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14549" y="-2907.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="14549" y="-2892.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14549" y="-2877.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu6 -->
<g id="node1023" class="node">
<title>l4_attn_stage1_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14549" cy="-2748.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14549" y="-2760.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="14549" y="-2745.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14549" y="-2730.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu6&#45;&gt;l4_attn_stage1_gpu6 -->
<g id="edge1655" class="edge">
<title>l4_attn_stage0_gpu6&#45;&gt;l4_attn_stage1_gpu6</title>
<path fill="none" stroke="black" d="M14495.13,-2865.89C14481.13,-2859.64 14465.82,-2853.85 14451,-2850.33 14437.42,-2847.11 14209.67,-2850.4 14200,-2840.33 14195.38,-2835.53 14195.36,-2830.12 14200,-2825.33 14209.71,-2815.31 14437.75,-2821.69 14451,-2817.33 14469.55,-2811.24 14487.76,-2800.44 14503.35,-2789.25"/>
<polygon fill="black" stroke="black" points="14505.79,-2791.8 14511.73,-2783.02 14501.61,-2786.18 14505.79,-2791.8"/>
</g>
<!-- l4_attn_stage0_gpu6&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2967" class="edge">
<title>l4_attn_stage0_gpu6&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14601.98,-2865.75C14615.9,-2859.45 14631.18,-2853.68 14646,-2850.33 14664.51,-2846.15 15315.68,-2853.85 15329,-2840.33 15357.36,-2811.56 15309.79,-2785.73 15264.82,-2769.1"/>
<polygon fill="red" stroke="red" points="15265.88,-2765.76 15255.29,-2765.69 15263.53,-2772.35 15265.88,-2765.76"/>
<text text-anchor="middle" x="15369.5" y="-2829.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu7 -->
<g id="node1008" class="node">
<title>l4_attn_stage0_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14159" cy="-2895.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14159" y="-2907.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="14159" y="-2892.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14159" y="-2877.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu7 -->
<g id="node1024" class="node">
<title>l4_attn_stage1_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14159" cy="-2748.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14159" y="-2760.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="14159" y="-2745.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14159" y="-2730.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu7&#45;&gt;l4_attn_stage1_gpu7 -->
<g id="edge1656" class="edge">
<title>l4_attn_stage0_gpu7&#45;&gt;l4_attn_stage1_gpu7</title>
<path fill="none" stroke="black" d="M14159,-2858.24C14159,-2839.53 14159,-2816.53 14159,-2796.55"/>
<polygon fill="black" stroke="black" points="14162.5,-2796.41 14159,-2786.41 14155.5,-2796.41 14162.5,-2796.41"/>
</g>
<!-- l4_attn_stage0_gpu7&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2968" class="edge">
<title>l4_attn_stage0_gpu7&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14211.97,-2865.71C14225.9,-2859.42 14241.18,-2853.66 14256,-2850.33 14280.42,-2844.86 15135.86,-2853.73 15157,-2840.33 15178.94,-2826.43 15190.24,-2798.16 15195.85,-2776.89"/>
<polygon fill="red" stroke="red" points="15199.27,-2777.64 15198.18,-2767.1 15192.46,-2776.02 15199.27,-2777.64"/>
<text text-anchor="middle" x="15204.5" y="-2829.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu8 -->
<g id="node1009" class="node">
<title>l4_attn_stage0_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="12794" cy="-2895.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12794" y="-2907.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="12794" y="-2892.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12794" y="-2877.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu8 -->
<g id="node1025" class="node">
<title>l4_attn_stage1_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="12794" cy="-2748.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12794" y="-2760.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="12794" y="-2745.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12794" y="-2730.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu8&#45;&gt;l4_attn_stage1_gpu8 -->
<g id="edge1657" class="edge">
<title>l4_attn_stage0_gpu8&#45;&gt;l4_attn_stage1_gpu8</title>
<path fill="none" stroke="black" d="M12794,-2858.24C12794,-2839.53 12794,-2816.53 12794,-2796.55"/>
<polygon fill="black" stroke="black" points="12797.5,-2796.41 12794,-2786.41 12790.5,-2796.41 12797.5,-2796.41"/>
</g>
<!-- l4_attn_stage0_gpu8&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2969" class="edge">
<title>l4_attn_stage0_gpu8&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12846.96,-2865.66C12860.88,-2859.37 12876.17,-2853.62 12891,-2850.33 12936.13,-2840.33 14511.38,-2855.62 14555,-2840.33 14565.15,-2836.77 14563.87,-2828.95 14574,-2825.33 14622.67,-2807.97 14988.42,-2827.9 15039,-2817.33 15082.84,-2808.17 15129.74,-2787.28 15161.74,-2771.14"/>
<polygon fill="red" stroke="red" points="15163.46,-2774.2 15170.76,-2766.52 15160.27,-2767.97 15163.46,-2774.2"/>
<text text-anchor="middle" x="14605.5" y="-2829.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu9 -->
<g id="node1010" class="node">
<title>l4_attn_stage0_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="12989" cy="-2895.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12989" y="-2907.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="12989" y="-2892.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12989" y="-2877.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu9 -->
<g id="node1026" class="node">
<title>l4_attn_stage1_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="12989" cy="-2748.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12989" y="-2760.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="12989" y="-2745.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12989" y="-2730.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu9&#45;&gt;l4_attn_stage1_gpu9 -->
<g id="edge1658" class="edge">
<title>l4_attn_stage0_gpu9&#45;&gt;l4_attn_stage1_gpu9</title>
<path fill="none" stroke="black" d="M12989,-2858.24C12989,-2839.53 12989,-2816.53 12989,-2796.55"/>
<polygon fill="black" stroke="black" points="12992.5,-2796.41 12989,-2786.41 12985.5,-2796.41 12992.5,-2796.41"/>
</g>
<!-- l4_attn_stage0_gpu9&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2970" class="edge">
<title>l4_attn_stage0_gpu9&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13041.96,-2865.66C13055.89,-2859.37 13071.17,-2853.62 13086,-2850.33 13128.17,-2840.98 14600.24,-2854.63 14641,-2840.33 14651.15,-2836.77 14649.87,-2828.97 14660,-2825.33 14699.64,-2811.1 14997.79,-2826.03 15039,-2817.33 15082.82,-2808.09 15129.73,-2787.2 15161.73,-2771.1"/>
<polygon fill="red" stroke="red" points="15163.45,-2774.15 15170.75,-2766.48 15160.26,-2767.92 15163.45,-2774.15"/>
<text text-anchor="middle" x="14691.5" y="-2829.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu10 -->
<g id="node1011" class="node">
<title>l4_attn_stage0_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12209" cy="-2895.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12209" y="-2907.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="12209" y="-2892.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12209" y="-2877.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu10 -->
<g id="node1027" class="node">
<title>l4_attn_stage1_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12209" cy="-2748.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12209" y="-2760.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="12209" y="-2745.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12209" y="-2730.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu10&#45;&gt;l4_attn_stage1_gpu10 -->
<g id="edge1659" class="edge">
<title>l4_attn_stage0_gpu10&#45;&gt;l4_attn_stage1_gpu10</title>
<path fill="none" stroke="black" d="M12209,-2858.24C12209,-2839.53 12209,-2816.53 12209,-2796.55"/>
<polygon fill="black" stroke="black" points="12212.5,-2796.41 12209,-2786.41 12205.5,-2796.41 12212.5,-2796.41"/>
</g>
<!-- l4_attn_stage0_gpu10&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2971" class="edge">
<title>l4_attn_stage0_gpu10&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12261.96,-2865.65C12275.88,-2859.36 12291.17,-2853.61 12306,-2850.33 12360,-2838.39 14244.8,-2858.6 14297,-2840.33 14307.15,-2836.78 14305.86,-2828.92 14316,-2825.33 14353.87,-2811.95 14999.66,-2825.43 15039,-2817.33 15082.87,-2808.31 15129.77,-2787.39 15161.76,-2771.22"/>
<polygon fill="red" stroke="red" points="15163.48,-2774.27 15170.78,-2766.58 15160.28,-2768.04 15163.48,-2774.27"/>
<text text-anchor="middle" x="14347.5" y="-2829.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu11 -->
<g id="node1012" class="node">
<title>l4_attn_stage0_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="12599" cy="-2895.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12599" y="-2907.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="12599" y="-2892.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12599" y="-2877.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu11 -->
<g id="node1028" class="node">
<title>l4_attn_stage1_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="12599" cy="-2748.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12599" y="-2760.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="12599" y="-2745.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12599" y="-2730.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu11&#45;&gt;l4_attn_stage1_gpu11 -->
<g id="edge1660" class="edge">
<title>l4_attn_stage0_gpu11&#45;&gt;l4_attn_stage1_gpu11</title>
<path fill="none" stroke="black" d="M12599,-2858.24C12599,-2839.53 12599,-2816.53 12599,-2796.55"/>
<polygon fill="black" stroke="black" points="12602.5,-2796.41 12599,-2786.41 12595.5,-2796.41 12602.5,-2796.41"/>
</g>
<!-- l4_attn_stage0_gpu11&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2972" class="edge">
<title>l4_attn_stage0_gpu11&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12651.96,-2865.66C12665.88,-2859.36 12681.17,-2853.62 12696,-2850.33 12744.09,-2839.69 14422.52,-2856.62 14469,-2840.33 14479.15,-2836.78 14477.86,-2828.94 14488,-2825.33 14516.85,-2815.08 15009.02,-2823.55 15039,-2817.33 15082.85,-2808.23 15129.75,-2787.33 15161.75,-2771.18"/>
<polygon fill="red" stroke="red" points="15163.47,-2774.23 15170.77,-2766.55 15160.27,-2768 15163.47,-2774.23"/>
<text text-anchor="middle" x="14519.5" y="-2829.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu12 -->
<g id="node1013" class="node">
<title>l4_attn_stage0_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14939" cy="-2895.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14939" y="-2907.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="14939" y="-2892.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14939" y="-2877.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu12 -->
<g id="node1029" class="node">
<title>l4_attn_stage1_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14939" cy="-2748.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14939" y="-2760.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="14939" y="-2745.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14939" y="-2730.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu12&#45;&gt;l4_attn_stage1_gpu12 -->
<g id="edge1661" class="edge">
<title>l4_attn_stage0_gpu12&#45;&gt;l4_attn_stage1_gpu12</title>
<path fill="none" stroke="black" d="M14885.7,-2865.88C14871.56,-2859.54 14856.04,-2853.71 14841,-2850.33 14824.01,-2846.51 14226.22,-2852.75 14214,-2840.33 14209.32,-2835.58 14209.32,-2830.08 14214,-2825.33 14226.24,-2812.94 14824.4,-2822.61 14841,-2817.33 14859.6,-2811.42 14877.83,-2800.67 14893.42,-2789.46"/>
<polygon fill="black" stroke="black" points="14895.87,-2792 14901.79,-2783.22 14891.68,-2786.39 14895.87,-2792"/>
</g>
<!-- l4_attn_stage0_gpu12&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2973" class="edge">
<title>l4_attn_stage0_gpu12&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M15027.34,-2892.65C15177.61,-2888.03 15469.83,-2874.67 15501,-2840.33 15553.01,-2783.04 15454.61,-2761.47 15356.88,-2753.62"/>
<polygon fill="red" stroke="red" points="15357.06,-2750.12 15346.82,-2752.86 15356.53,-2757.1 15357.06,-2750.12"/>
<text text-anchor="middle" x="15541.5" y="-2829.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu13 -->
<g id="node1014" class="node">
<title>l4_attn_stage0_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13184" cy="-2895.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13184" y="-2907.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="13184" y="-2892.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13184" y="-2877.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu13 -->
<g id="node1030" class="node">
<title>l4_attn_stage1_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13184" cy="-2748.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13184" y="-2760.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="13184" y="-2745.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13184" y="-2730.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu13&#45;&gt;l4_attn_stage1_gpu13 -->
<g id="edge1662" class="edge">
<title>l4_attn_stage0_gpu13&#45;&gt;l4_attn_stage1_gpu13</title>
<path fill="none" stroke="black" d="M13184,-2858.24C13184,-2839.53 13184,-2816.53 13184,-2796.55"/>
<polygon fill="black" stroke="black" points="13187.5,-2796.41 13184,-2786.41 13180.5,-2796.41 13187.5,-2796.41"/>
</g>
<!-- l4_attn_stage0_gpu13&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2974" class="edge">
<title>l4_attn_stage0_gpu13&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13236.96,-2865.67C13250.89,-2859.38 13266.17,-2853.63 13281,-2850.33 13320.21,-2841.63 14689.1,-2853.64 14727,-2840.33 14737.15,-2836.77 14735.89,-2829 14746,-2825.33 14776.62,-2814.23 15007.15,-2824.16 15039,-2817.33 15082.66,-2807.98 15129.41,-2787.22 15161.42,-2771.17"/>
<polygon fill="red" stroke="red" points="15163.12,-2774.23 15170.45,-2766.58 15159.95,-2767.99 15163.12,-2774.23"/>
<text text-anchor="middle" x="14777.5" y="-2829.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu14 -->
<g id="node1015" class="node">
<title>l4_attn_stage0_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="13769" cy="-2895.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13769" y="-2907.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="13769" y="-2892.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13769" y="-2877.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu14 -->
<g id="node1031" class="node">
<title>l4_attn_stage1_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="13769" cy="-2748.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13769" y="-2760.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="13769" y="-2745.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13769" y="-2730.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu14&#45;&gt;l4_attn_stage1_gpu14 -->
<g id="edge1663" class="edge">
<title>l4_attn_stage0_gpu14&#45;&gt;l4_attn_stage1_gpu14</title>
<path fill="none" stroke="black" d="M13769,-2858.24C13769,-2839.53 13769,-2816.53 13769,-2796.55"/>
<polygon fill="black" stroke="black" points="13772.5,-2796.41 13769,-2786.41 13765.5,-2796.41 13772.5,-2796.41"/>
</g>
<!-- l4_attn_stage0_gpu14&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2975" class="edge">
<title>l4_attn_stage0_gpu14&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13821.97,-2865.69C13835.89,-2859.4 13851.17,-2853.64 13866,-2850.33 13926.68,-2836.79 14926.36,-2860.98 14985,-2840.33 14995.15,-2836.76 14994.3,-2829.98 15004,-2825.33 15018.39,-2818.44 15023.8,-2822.2 15039,-2817.33 15079.94,-2804.23 15124.95,-2785.07 15157.12,-2770.51"/>
<polygon fill="red" stroke="red" points="15158.61,-2773.68 15166.25,-2766.34 15155.7,-2767.31 15158.61,-2773.68"/>
<text text-anchor="middle" x="15035.5" y="-2829.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu15 -->
<g id="node1016" class="node">
<title>l4_attn_stage0_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="13379" cy="-2895.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13379" y="-2907.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="13379" y="-2892.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13379" y="-2877.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu15 -->
<g id="node1032" class="node">
<title>l4_attn_stage1_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="13379" cy="-2748.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13379" y="-2760.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="13379" y="-2745.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13379" y="-2730.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu15&#45;&gt;l4_attn_stage1_gpu15 -->
<g id="edge1664" class="edge">
<title>l4_attn_stage0_gpu15&#45;&gt;l4_attn_stage1_gpu15</title>
<path fill="none" stroke="black" d="M13379,-2858.24C13379,-2839.53 13379,-2816.53 13379,-2796.55"/>
<polygon fill="black" stroke="black" points="13382.5,-2796.41 13379,-2786.41 13375.5,-2796.41 13382.5,-2796.41"/>
</g>
<!-- l4_attn_stage0_gpu15&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2976" class="edge">
<title>l4_attn_stage0_gpu15&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13431.96,-2865.68C13445.89,-2859.38 13461.17,-2853.63 13476,-2850.33 13548.51,-2834.21 14742.92,-2864.96 14813,-2840.33 14823.15,-2836.77 14821.91,-2829.06 14832,-2825.33 14875.19,-2809.4 14994.04,-2827.23 15039,-2817.33 15082.6,-2807.73 15129.37,-2787.01 15161.39,-2771.04"/>
<polygon fill="red" stroke="red" points="15163.08,-2774.1 15170.42,-2766.46 15159.92,-2767.86 15163.08,-2774.1"/>
<text text-anchor="middle" x="14863.5" y="-2829.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu0 -->
<g id="node1033" class="node">
<title>l4_attn_stage2_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="13574" cy="-2601.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13574" y="-2613.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="13574" y="-2598.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13574" y="-2583.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu0&#45;&gt;l4_attn_stage2_gpu0 -->
<g id="edge1665" class="edge">
<title>l4_attn_stage1_gpu0&#45;&gt;l4_attn_stage2_gpu0</title>
<path fill="none" stroke="black" d="M13574,-2711.24C13574,-2692.53 13574,-2669.53 13574,-2649.55"/>
<polygon fill="black" stroke="black" points="13577.5,-2649.41 13574,-2639.41 13570.5,-2649.41 13577.5,-2649.41"/>
</g>
<!-- l4_attn_stage2_gpu[next_gpu] -->
<g id="node1391" class="node">
<title>l4_attn_stage2_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="15201" cy="-2601.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="15201" y="-2598.13" font-family="Times,serif" font-size="14.00">l4_attn_stage2_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage1_gpu0&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2977" class="edge">
<title>l4_attn_stage1_gpu0&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13626.97,-2718.68C13640.89,-2712.39 13656.17,-2706.64 13671,-2703.33 13737.59,-2688.5 14834.64,-2715.97 14899,-2693.33 14909.15,-2689.76 14907.96,-2682.2 14918,-2678.33 14968.3,-2658.99 14986.53,-2682.64 15039,-2670.33 15082.2,-2660.2 15128.67,-2639.75 15160.71,-2624.01"/>
<polygon fill="red" stroke="red" points="15162.38,-2627.09 15169.77,-2619.49 15159.25,-2620.82 15162.38,-2627.09"/>
<text text-anchor="middle" x="14949.5" y="-2682.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu1 -->
<g id="node1034" class="node">
<title>l4_attn_stage2_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14354" cy="-2601.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14354" y="-2613.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="14354" y="-2598.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14354" y="-2583.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu1&#45;&gt;l4_attn_stage2_gpu1 -->
<g id="edge1666" class="edge">
<title>l4_attn_stage1_gpu1&#45;&gt;l4_attn_stage2_gpu1</title>
<path fill="none" stroke="black" d="M14298.51,-2719.52C14284.88,-2713.44 14270.14,-2707.58 14256,-2703.33 14242.42,-2699.25 14202.2,-2704.11 14193,-2693.33 14158.44,-2652.85 14200.28,-2691.61 14256,-2670.33 14273.91,-2663.49 14291.72,-2652.74 14307.14,-2641.81"/>
<polygon fill="black" stroke="black" points="14309.44,-2644.47 14315.45,-2635.75 14305.31,-2638.82 14309.44,-2644.47"/>
</g>
<!-- l4_attn_stage1_gpu1&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2978" class="edge">
<title>l4_attn_stage1_gpu1&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14406.98,-2718.73C14420.9,-2712.43 14436.18,-2706.67 14451,-2703.33 14472.46,-2698.5 15227.54,-2708.99 15243,-2693.33 15261.16,-2674.94 15243.89,-2647.25 15226.31,-2627.34"/>
<polygon fill="red" stroke="red" points="15228.75,-2624.82 15219.38,-2619.87 15223.61,-2629.58 15228.75,-2624.82"/>
<text text-anchor="middle" x="15282.5" y="-2682.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu2 -->
<g id="node1035" class="node">
<title>l4_attn_stage2_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="12404" cy="-2601.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12404" y="-2613.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="12404" y="-2598.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12404" y="-2583.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu2&#45;&gt;l4_attn_stage2_gpu2 -->
<g id="edge1667" class="edge">
<title>l4_attn_stage1_gpu2&#45;&gt;l4_attn_stage2_gpu2</title>
<path fill="none" stroke="black" d="M12404,-2711.24C12404,-2692.53 12404,-2669.53 12404,-2649.55"/>
<polygon fill="black" stroke="black" points="12407.5,-2649.41 12404,-2639.41 12400.5,-2649.41 12407.5,-2649.41"/>
</g>
<!-- l4_attn_stage1_gpu2&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2979" class="edge">
<title>l4_attn_stage1_gpu2&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12456.96,-2718.65C12470.88,-2712.36 12486.17,-2706.61 12501,-2703.33 12552.04,-2692.04 14333.66,-2710.61 14383,-2693.33 14393.15,-2689.78 14391.86,-2681.93 14402,-2678.33 14435.36,-2666.52 15004.34,-2677.49 15039,-2670.33 15082.86,-2661.27 15129.76,-2640.36 15161.75,-2624.2"/>
<polygon fill="red" stroke="red" points="15163.48,-2627.25 15170.77,-2619.57 15160.28,-2621.02 15163.48,-2627.25"/>
<text text-anchor="middle" x="14433.5" y="-2682.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu3 -->
<g id="node1036" class="node">
<title>l4_attn_stage2_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14744" cy="-2601.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14744" y="-2613.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="14744" y="-2598.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14744" y="-2583.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu3&#45;&gt;l4_attn_stage2_gpu3 -->
<g id="edge1668" class="edge">
<title>l4_attn_stage1_gpu3&#45;&gt;l4_attn_stage2_gpu3</title>
<path fill="none" stroke="black" d="M14690.43,-2718.83C14676.36,-2712.54 14660.94,-2706.74 14646,-2703.33 14622.22,-2697.9 14224.05,-2710.78 14207,-2693.33 14202.34,-2688.57 14202.33,-2683.09 14207,-2678.33 14215.55,-2669.63 14634.39,-2674.06 14646,-2670.33 14664.59,-2664.36 14682.81,-2653.6 14698.4,-2642.4"/>
<polygon fill="black" stroke="black" points="14700.84,-2644.94 14706.77,-2636.16 14696.66,-2639.33 14700.84,-2644.94"/>
</g>
<!-- l4_attn_stage1_gpu3&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2980" class="edge">
<title>l4_attn_stage1_gpu3&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14796.99,-2718.78C14810.91,-2712.48 14826.19,-2706.7 14841,-2703.33 14856.55,-2699.79 15403.82,-2704.71 15415,-2693.33 15455.03,-2652.6 15385.32,-2629.24 15315.01,-2616.49"/>
<polygon fill="red" stroke="red" points="15315.55,-2613.04 15305.1,-2614.77 15314.35,-2619.93 15315.55,-2613.04"/>
<text text-anchor="middle" x="15456.5" y="-2682.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu4 -->
<g id="node1037" class="node">
<title>l4_attn_stage2_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13964" cy="-2601.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13964" y="-2613.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="13964" y="-2598.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13964" y="-2583.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu4&#45;&gt;l4_attn_stage2_gpu4 -->
<g id="edge1669" class="edge">
<title>l4_attn_stage1_gpu4&#45;&gt;l4_attn_stage2_gpu4</title>
<path fill="none" stroke="black" d="M13964,-2711.24C13964,-2692.53 13964,-2669.53 13964,-2649.55"/>
<polygon fill="black" stroke="black" points="13967.5,-2649.41 13964,-2639.41 13960.5,-2649.41 13967.5,-2649.41"/>
</g>
<!-- l4_attn_stage1_gpu4&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2981" class="edge">
<title>l4_attn_stage1_gpu4&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14016.97,-2718.7C14030.89,-2712.41 14046.17,-2706.65 14061,-2703.33 14115.76,-2691.09 15018.08,-2712 15071,-2693.33 15081.15,-2689.75 15081.32,-2684.7 15090,-2678.33 15115.22,-2659.84 15144.5,-2639.99 15166.65,-2625.29"/>
<polygon fill="red" stroke="red" points="15168.66,-2628.15 15175.07,-2619.72 15164.8,-2622.31 15168.66,-2628.15"/>
<text text-anchor="middle" x="15121.5" y="-2682.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu5 -->
<g id="node1038" class="node">
<title>l4_attn_stage2_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="12014" cy="-2601.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12014" y="-2613.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="12014" y="-2598.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12014" y="-2583.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu5&#45;&gt;l4_attn_stage2_gpu5 -->
<g id="edge1670" class="edge">
<title>l4_attn_stage1_gpu5&#45;&gt;l4_attn_stage2_gpu5</title>
<path fill="none" stroke="black" d="M12014,-2711.24C12014,-2692.53 12014,-2669.53 12014,-2649.55"/>
<polygon fill="black" stroke="black" points="12017.5,-2649.41 12014,-2639.41 12010.5,-2649.41 12017.5,-2649.41"/>
</g>
<!-- l4_attn_stage1_gpu5&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2982" class="edge">
<title>l4_attn_stage1_gpu5&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12066.97,-2718.72C12080.9,-2712.43 12096.18,-2706.66 12111,-2703.33 12340.74,-2651.73 13994.55,-2680.89 14230,-2678.33 14274.94,-2677.85 14994.97,-2679.37 15039,-2670.33 15082.87,-2661.33 15129.77,-2640.41 15161.76,-2624.23"/>
<polygon fill="red" stroke="red" points="15163.49,-2627.28 15170.78,-2619.59 15160.28,-2621.05 15163.49,-2627.28"/>
<text text-anchor="middle" x="14261.5" y="-2682.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu6 -->
<g id="node1039" class="node">
<title>l4_attn_stage2_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14549" cy="-2601.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14549" y="-2613.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="14549" y="-2598.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14549" y="-2583.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu6&#45;&gt;l4_attn_stage2_gpu6 -->
<g id="edge1671" class="edge">
<title>l4_attn_stage1_gpu6&#45;&gt;l4_attn_stage2_gpu6</title>
<path fill="none" stroke="black" d="M14495.13,-2718.89C14481.13,-2712.64 14465.82,-2706.85 14451,-2703.33 14437.42,-2700.11 14209.67,-2703.4 14200,-2693.33 14195.38,-2688.53 14195.36,-2683.12 14200,-2678.33 14209.71,-2668.31 14437.75,-2674.69 14451,-2670.33 14469.55,-2664.24 14487.76,-2653.44 14503.35,-2642.25"/>
<polygon fill="black" stroke="black" points="14505.79,-2644.8 14511.73,-2636.02 14501.61,-2639.18 14505.79,-2644.8"/>
</g>
<!-- l4_attn_stage1_gpu6&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2983" class="edge">
<title>l4_attn_stage1_gpu6&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14601.98,-2718.75C14615.9,-2712.45 14631.18,-2706.68 14646,-2703.33 14664.51,-2699.15 15315.68,-2706.85 15329,-2693.33 15357.36,-2664.56 15309.79,-2638.73 15264.82,-2622.1"/>
<polygon fill="red" stroke="red" points="15265.88,-2618.76 15255.29,-2618.69 15263.53,-2625.35 15265.88,-2618.76"/>
<text text-anchor="middle" x="15369.5" y="-2682.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu7 -->
<g id="node1040" class="node">
<title>l4_attn_stage2_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14159" cy="-2601.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14159" y="-2613.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="14159" y="-2598.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14159" y="-2583.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu7&#45;&gt;l4_attn_stage2_gpu7 -->
<g id="edge1672" class="edge">
<title>l4_attn_stage1_gpu7&#45;&gt;l4_attn_stage2_gpu7</title>
<path fill="none" stroke="black" d="M14159,-2711.24C14159,-2692.53 14159,-2669.53 14159,-2649.55"/>
<polygon fill="black" stroke="black" points="14162.5,-2649.41 14159,-2639.41 14155.5,-2649.41 14162.5,-2649.41"/>
</g>
<!-- l4_attn_stage1_gpu7&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2984" class="edge">
<title>l4_attn_stage1_gpu7&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14211.97,-2718.71C14225.9,-2712.42 14241.18,-2706.66 14256,-2703.33 14280.42,-2697.86 15135.86,-2706.73 15157,-2693.33 15178.94,-2679.43 15190.24,-2651.16 15195.85,-2629.89"/>
<polygon fill="red" stroke="red" points="15199.27,-2630.64 15198.18,-2620.1 15192.46,-2629.02 15199.27,-2630.64"/>
<text text-anchor="middle" x="15204.5" y="-2682.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu8 -->
<g id="node1041" class="node">
<title>l4_attn_stage2_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="12794" cy="-2601.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12794" y="-2613.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="12794" y="-2598.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12794" y="-2583.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu8&#45;&gt;l4_attn_stage2_gpu8 -->
<g id="edge1673" class="edge">
<title>l4_attn_stage1_gpu8&#45;&gt;l4_attn_stage2_gpu8</title>
<path fill="none" stroke="black" d="M12794,-2711.24C12794,-2692.53 12794,-2669.53 12794,-2649.55"/>
<polygon fill="black" stroke="black" points="12797.5,-2649.41 12794,-2639.41 12790.5,-2649.41 12797.5,-2649.41"/>
</g>
<!-- l4_attn_stage1_gpu8&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2985" class="edge">
<title>l4_attn_stage1_gpu8&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12846.96,-2718.66C12860.88,-2712.37 12876.17,-2706.62 12891,-2703.33 12936.13,-2693.33 14511.38,-2708.62 14555,-2693.33 14565.15,-2689.77 14563.87,-2681.95 14574,-2678.33 14622.67,-2660.97 14988.42,-2680.9 15039,-2670.33 15082.84,-2661.17 15129.74,-2640.28 15161.74,-2624.14"/>
<polygon fill="red" stroke="red" points="15163.46,-2627.2 15170.76,-2619.52 15160.27,-2620.97 15163.46,-2627.2"/>
<text text-anchor="middle" x="14605.5" y="-2682.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu9 -->
<g id="node1042" class="node">
<title>l4_attn_stage2_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="12989" cy="-2601.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12989" y="-2613.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="12989" y="-2598.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12989" y="-2583.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu9&#45;&gt;l4_attn_stage2_gpu9 -->
<g id="edge1674" class="edge">
<title>l4_attn_stage1_gpu9&#45;&gt;l4_attn_stage2_gpu9</title>
<path fill="none" stroke="black" d="M12989,-2711.24C12989,-2692.53 12989,-2669.53 12989,-2649.55"/>
<polygon fill="black" stroke="black" points="12992.5,-2649.41 12989,-2639.41 12985.5,-2649.41 12992.5,-2649.41"/>
</g>
<!-- l4_attn_stage1_gpu9&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2986" class="edge">
<title>l4_attn_stage1_gpu9&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13041.96,-2718.66C13055.89,-2712.37 13071.17,-2706.62 13086,-2703.33 13128.17,-2693.98 14600.24,-2707.63 14641,-2693.33 14651.15,-2689.77 14649.87,-2681.97 14660,-2678.33 14699.64,-2664.1 14997.79,-2679.03 15039,-2670.33 15082.82,-2661.09 15129.73,-2640.2 15161.73,-2624.1"/>
<polygon fill="red" stroke="red" points="15163.45,-2627.15 15170.75,-2619.48 15160.26,-2620.92 15163.45,-2627.15"/>
<text text-anchor="middle" x="14691.5" y="-2682.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu10 -->
<g id="node1043" class="node">
<title>l4_attn_stage2_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12209" cy="-2601.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12209" y="-2613.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="12209" y="-2598.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12209" y="-2583.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu10&#45;&gt;l4_attn_stage2_gpu10 -->
<g id="edge1675" class="edge">
<title>l4_attn_stage1_gpu10&#45;&gt;l4_attn_stage2_gpu10</title>
<path fill="none" stroke="black" d="M12209,-2711.24C12209,-2692.53 12209,-2669.53 12209,-2649.55"/>
<polygon fill="black" stroke="black" points="12212.5,-2649.41 12209,-2639.41 12205.5,-2649.41 12212.5,-2649.41"/>
</g>
<!-- l4_attn_stage1_gpu10&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2987" class="edge">
<title>l4_attn_stage1_gpu10&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12261.96,-2718.65C12275.88,-2712.36 12291.17,-2706.61 12306,-2703.33 12360,-2691.39 14244.8,-2711.6 14297,-2693.33 14307.15,-2689.78 14305.86,-2681.92 14316,-2678.33 14353.87,-2664.95 14999.66,-2678.43 15039,-2670.33 15082.87,-2661.31 15129.77,-2640.39 15161.76,-2624.22"/>
<polygon fill="red" stroke="red" points="15163.48,-2627.27 15170.78,-2619.58 15160.28,-2621.04 15163.48,-2627.27"/>
<text text-anchor="middle" x="14347.5" y="-2682.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu11 -->
<g id="node1044" class="node">
<title>l4_attn_stage2_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="12599" cy="-2601.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12599" y="-2613.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="12599" y="-2598.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12599" y="-2583.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu11&#45;&gt;l4_attn_stage2_gpu11 -->
<g id="edge1676" class="edge">
<title>l4_attn_stage1_gpu11&#45;&gt;l4_attn_stage2_gpu11</title>
<path fill="none" stroke="black" d="M12599,-2711.24C12599,-2692.53 12599,-2669.53 12599,-2649.55"/>
<polygon fill="black" stroke="black" points="12602.5,-2649.41 12599,-2639.41 12595.5,-2649.41 12602.5,-2649.41"/>
</g>
<!-- l4_attn_stage1_gpu11&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2988" class="edge">
<title>l4_attn_stage1_gpu11&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12651.96,-2718.66C12665.88,-2712.36 12681.17,-2706.62 12696,-2703.33 12744.09,-2692.69 14422.52,-2709.62 14469,-2693.33 14479.15,-2689.78 14477.86,-2681.94 14488,-2678.33 14516.85,-2668.08 15009.02,-2676.55 15039,-2670.33 15082.85,-2661.23 15129.75,-2640.33 15161.75,-2624.18"/>
<polygon fill="red" stroke="red" points="15163.47,-2627.23 15170.77,-2619.55 15160.27,-2621 15163.47,-2627.23"/>
<text text-anchor="middle" x="14519.5" y="-2682.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu12 -->
<g id="node1045" class="node">
<title>l4_attn_stage2_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14939" cy="-2601.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14939" y="-2613.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="14939" y="-2598.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14939" y="-2583.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu12&#45;&gt;l4_attn_stage2_gpu12 -->
<g id="edge1677" class="edge">
<title>l4_attn_stage1_gpu12&#45;&gt;l4_attn_stage2_gpu12</title>
<path fill="none" stroke="black" d="M14885.7,-2718.88C14871.56,-2712.54 14856.04,-2706.71 14841,-2703.33 14824.01,-2699.51 14226.22,-2705.75 14214,-2693.33 14209.32,-2688.58 14209.32,-2683.08 14214,-2678.33 14226.24,-2665.94 14824.4,-2675.61 14841,-2670.33 14859.6,-2664.42 14877.83,-2653.67 14893.42,-2642.46"/>
<polygon fill="black" stroke="black" points="14895.87,-2645 14901.79,-2636.22 14891.68,-2639.39 14895.87,-2645"/>
</g>
<!-- l4_attn_stage1_gpu12&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2989" class="edge">
<title>l4_attn_stage1_gpu12&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14994.09,-2719.4C15009.23,-2712.88 15025.92,-2706.84 15042,-2703.33 15066.92,-2697.9 15483.16,-2711.56 15501,-2693.33 15555.67,-2637.46 15454.45,-2615.8 15355.12,-2607.54"/>
<polygon fill="red" stroke="red" points="15355.15,-2604.03 15344.9,-2606.74 15354.6,-2611.01 15355.15,-2604.03"/>
<text text-anchor="middle" x="15542.5" y="-2682.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu13 -->
<g id="node1046" class="node">
<title>l4_attn_stage2_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13184" cy="-2601.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13184" y="-2613.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="13184" y="-2598.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13184" y="-2583.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu13&#45;&gt;l4_attn_stage2_gpu13 -->
<g id="edge1678" class="edge">
<title>l4_attn_stage1_gpu13&#45;&gt;l4_attn_stage2_gpu13</title>
<path fill="none" stroke="black" d="M13184,-2711.24C13184,-2692.53 13184,-2669.53 13184,-2649.55"/>
<polygon fill="black" stroke="black" points="13187.5,-2649.41 13184,-2639.41 13180.5,-2649.41 13187.5,-2649.41"/>
</g>
<!-- l4_attn_stage1_gpu13&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2990" class="edge">
<title>l4_attn_stage1_gpu13&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13236.96,-2718.67C13250.89,-2712.38 13266.17,-2706.63 13281,-2703.33 13320.21,-2694.63 14689.1,-2706.64 14727,-2693.33 14737.15,-2689.77 14735.89,-2682 14746,-2678.33 14776.62,-2667.23 15007.15,-2677.16 15039,-2670.33 15082.66,-2660.98 15129.41,-2640.22 15161.42,-2624.17"/>
<polygon fill="red" stroke="red" points="15163.12,-2627.23 15170.45,-2619.58 15159.95,-2620.99 15163.12,-2627.23"/>
<text text-anchor="middle" x="14777.5" y="-2682.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu14 -->
<g id="node1047" class="node">
<title>l4_attn_stage2_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="13769" cy="-2601.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13769" y="-2613.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="13769" y="-2598.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13769" y="-2583.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu14&#45;&gt;l4_attn_stage2_gpu14 -->
<g id="edge1679" class="edge">
<title>l4_attn_stage1_gpu14&#45;&gt;l4_attn_stage2_gpu14</title>
<path fill="none" stroke="black" d="M13769,-2711.24C13769,-2692.53 13769,-2669.53 13769,-2649.55"/>
<polygon fill="black" stroke="black" points="13772.5,-2649.41 13769,-2639.41 13765.5,-2649.41 13772.5,-2649.41"/>
</g>
<!-- l4_attn_stage1_gpu14&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2991" class="edge">
<title>l4_attn_stage1_gpu14&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13821.97,-2718.69C13835.89,-2712.4 13851.17,-2706.64 13866,-2703.33 13926.68,-2689.79 14926.36,-2713.98 14985,-2693.33 14995.15,-2689.76 14994.3,-2682.98 15004,-2678.33 15018.39,-2671.44 15023.8,-2675.2 15039,-2670.33 15079.94,-2657.23 15124.95,-2638.07 15157.12,-2623.51"/>
<polygon fill="red" stroke="red" points="15158.61,-2626.68 15166.25,-2619.34 15155.7,-2620.31 15158.61,-2626.68"/>
<text text-anchor="middle" x="15035.5" y="-2682.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu15 -->
<g id="node1048" class="node">
<title>l4_attn_stage2_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="13379" cy="-2601.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13379" y="-2613.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="13379" y="-2598.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13379" y="-2583.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu15&#45;&gt;l4_attn_stage2_gpu15 -->
<g id="edge1680" class="edge">
<title>l4_attn_stage1_gpu15&#45;&gt;l4_attn_stage2_gpu15</title>
<path fill="none" stroke="black" d="M13379,-2711.24C13379,-2692.53 13379,-2669.53 13379,-2649.55"/>
<polygon fill="black" stroke="black" points="13382.5,-2649.41 13379,-2639.41 13375.5,-2649.41 13382.5,-2649.41"/>
</g>
<!-- l4_attn_stage1_gpu15&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2992" class="edge">
<title>l4_attn_stage1_gpu15&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13431.96,-2718.68C13445.89,-2712.38 13461.17,-2706.63 13476,-2703.33 13548.51,-2687.21 14742.92,-2717.96 14813,-2693.33 14823.15,-2689.77 14821.91,-2682.06 14832,-2678.33 14875.19,-2662.4 14994.04,-2680.23 15039,-2670.33 15082.6,-2660.73 15129.37,-2640.01 15161.39,-2624.04"/>
<polygon fill="red" stroke="red" points="15163.08,-2627.1 15170.42,-2619.46 15159.92,-2620.86 15163.08,-2627.1"/>
<text text-anchor="middle" x="14863.5" y="-2682.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu0 -->
<g id="node1049" class="node">
<title>l4_attn_stage3_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="13574" cy="-2454.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13574" y="-2466.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="13574" y="-2451.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13574" y="-2436.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu0&#45;&gt;l4_attn_stage3_gpu0 -->
<g id="edge1681" class="edge">
<title>l4_attn_stage2_gpu0&#45;&gt;l4_attn_stage3_gpu0</title>
<path fill="none" stroke="black" d="M13574,-2564.24C13574,-2545.53 13574,-2522.53 13574,-2502.55"/>
<polygon fill="black" stroke="black" points="13577.5,-2502.41 13574,-2492.41 13570.5,-2502.41 13577.5,-2502.41"/>
</g>
<!-- l4_attn_stage3_gpu[next_gpu] -->
<g id="node1392" class="node">
<title>l4_attn_stage3_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="15201" cy="-2454.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="15201" y="-2451.13" font-family="Times,serif" font-size="14.00">l4_attn_stage3_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage2_gpu0&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2993" class="edge">
<title>l4_attn_stage2_gpu0&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13626.97,-2571.68C13640.89,-2565.39 13656.17,-2559.64 13671,-2556.33 13737.59,-2541.5 14834.64,-2568.97 14899,-2546.33 14909.15,-2542.76 14907.96,-2535.2 14918,-2531.33 14968.3,-2511.99 14986.53,-2535.64 15039,-2523.33 15082.2,-2513.2 15128.67,-2492.75 15160.71,-2477.01"/>
<polygon fill="red" stroke="red" points="15162.38,-2480.09 15169.77,-2472.49 15159.25,-2473.82 15162.38,-2480.09"/>
<text text-anchor="middle" x="14949.5" y="-2535.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu1 -->
<g id="node1050" class="node">
<title>l4_attn_stage3_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14354" cy="-2454.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14354" y="-2466.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="14354" y="-2451.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14354" y="-2436.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu1&#45;&gt;l4_attn_stage3_gpu1 -->
<g id="edge1682" class="edge">
<title>l4_attn_stage2_gpu1&#45;&gt;l4_attn_stage3_gpu1</title>
<path fill="none" stroke="black" d="M14298.51,-2572.52C14284.88,-2566.44 14270.14,-2560.58 14256,-2556.33 14242.42,-2552.25 14202.2,-2557.11 14193,-2546.33 14158.44,-2505.85 14200.28,-2544.61 14256,-2523.33 14273.91,-2516.49 14291.72,-2505.74 14307.14,-2494.81"/>
<polygon fill="black" stroke="black" points="14309.44,-2497.47 14315.45,-2488.75 14305.31,-2491.82 14309.44,-2497.47"/>
</g>
<!-- l4_attn_stage2_gpu1&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2994" class="edge">
<title>l4_attn_stage2_gpu1&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14406.98,-2571.73C14420.9,-2565.43 14436.18,-2559.67 14451,-2556.33 14472.46,-2551.5 15227.54,-2561.99 15243,-2546.33 15261.16,-2527.94 15243.89,-2500.25 15226.31,-2480.34"/>
<polygon fill="red" stroke="red" points="15228.75,-2477.82 15219.38,-2472.87 15223.61,-2482.58 15228.75,-2477.82"/>
<text text-anchor="middle" x="15282.5" y="-2535.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu2 -->
<g id="node1051" class="node">
<title>l4_attn_stage3_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="12404" cy="-2454.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12404" y="-2466.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="12404" y="-2451.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12404" y="-2436.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu2&#45;&gt;l4_attn_stage3_gpu2 -->
<g id="edge1683" class="edge">
<title>l4_attn_stage2_gpu2&#45;&gt;l4_attn_stage3_gpu2</title>
<path fill="none" stroke="black" d="M12404,-2564.24C12404,-2545.53 12404,-2522.53 12404,-2502.55"/>
<polygon fill="black" stroke="black" points="12407.5,-2502.41 12404,-2492.41 12400.5,-2502.41 12407.5,-2502.41"/>
</g>
<!-- l4_attn_stage2_gpu2&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2995" class="edge">
<title>l4_attn_stage2_gpu2&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12456.96,-2571.65C12470.88,-2565.36 12486.17,-2559.61 12501,-2556.33 12552.04,-2545.04 14333.66,-2563.61 14383,-2546.33 14393.15,-2542.78 14391.86,-2534.93 14402,-2531.33 14435.36,-2519.52 15004.34,-2530.49 15039,-2523.33 15082.86,-2514.27 15129.76,-2493.36 15161.75,-2477.2"/>
<polygon fill="red" stroke="red" points="15163.48,-2480.25 15170.77,-2472.57 15160.28,-2474.02 15163.48,-2480.25"/>
<text text-anchor="middle" x="14433.5" y="-2535.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu3 -->
<g id="node1052" class="node">
<title>l4_attn_stage3_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14744" cy="-2454.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14744" y="-2466.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="14744" y="-2451.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14744" y="-2436.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu3&#45;&gt;l4_attn_stage3_gpu3 -->
<g id="edge1684" class="edge">
<title>l4_attn_stage2_gpu3&#45;&gt;l4_attn_stage3_gpu3</title>
<path fill="none" stroke="black" d="M14690.43,-2571.83C14676.36,-2565.54 14660.94,-2559.74 14646,-2556.33 14622.22,-2550.9 14224.05,-2563.78 14207,-2546.33 14202.34,-2541.57 14202.33,-2536.09 14207,-2531.33 14215.55,-2522.63 14634.39,-2527.06 14646,-2523.33 14664.59,-2517.36 14682.81,-2506.6 14698.4,-2495.4"/>
<polygon fill="black" stroke="black" points="14700.84,-2497.94 14706.77,-2489.16 14696.66,-2492.33 14700.84,-2497.94"/>
</g>
<!-- l4_attn_stage2_gpu3&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2996" class="edge">
<title>l4_attn_stage2_gpu3&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14796.99,-2571.78C14810.91,-2565.48 14826.19,-2559.7 14841,-2556.33 14856.55,-2552.79 15403.82,-2557.71 15415,-2546.33 15455.03,-2505.6 15385.32,-2482.24 15315.01,-2469.49"/>
<polygon fill="red" stroke="red" points="15315.55,-2466.04 15305.1,-2467.77 15314.35,-2472.93 15315.55,-2466.04"/>
<text text-anchor="middle" x="15456.5" y="-2535.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu4 -->
<g id="node1053" class="node">
<title>l4_attn_stage3_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13964" cy="-2454.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13964" y="-2466.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="13964" y="-2451.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13964" y="-2436.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu4&#45;&gt;l4_attn_stage3_gpu4 -->
<g id="edge1685" class="edge">
<title>l4_attn_stage2_gpu4&#45;&gt;l4_attn_stage3_gpu4</title>
<path fill="none" stroke="black" d="M13964,-2564.24C13964,-2545.53 13964,-2522.53 13964,-2502.55"/>
<polygon fill="black" stroke="black" points="13967.5,-2502.41 13964,-2492.41 13960.5,-2502.41 13967.5,-2502.41"/>
</g>
<!-- l4_attn_stage2_gpu4&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2997" class="edge">
<title>l4_attn_stage2_gpu4&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14016.97,-2571.7C14030.89,-2565.41 14046.17,-2559.65 14061,-2556.33 14115.76,-2544.09 15018.08,-2565 15071,-2546.33 15081.15,-2542.75 15081.32,-2537.7 15090,-2531.33 15115.22,-2512.84 15144.5,-2492.99 15166.65,-2478.29"/>
<polygon fill="red" stroke="red" points="15168.66,-2481.15 15175.07,-2472.72 15164.8,-2475.31 15168.66,-2481.15"/>
<text text-anchor="middle" x="15121.5" y="-2535.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu5 -->
<g id="node1054" class="node">
<title>l4_attn_stage3_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="12014" cy="-2454.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12014" y="-2466.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="12014" y="-2451.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12014" y="-2436.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu5&#45;&gt;l4_attn_stage3_gpu5 -->
<g id="edge1686" class="edge">
<title>l4_attn_stage2_gpu5&#45;&gt;l4_attn_stage3_gpu5</title>
<path fill="none" stroke="black" d="M12014,-2564.24C12014,-2545.53 12014,-2522.53 12014,-2502.55"/>
<polygon fill="black" stroke="black" points="12017.5,-2502.41 12014,-2492.41 12010.5,-2502.41 12017.5,-2502.41"/>
</g>
<!-- l4_attn_stage2_gpu5&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2998" class="edge">
<title>l4_attn_stage2_gpu5&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12066.97,-2571.72C12080.9,-2565.43 12096.18,-2559.66 12111,-2556.33 12340.74,-2504.73 13994.55,-2533.89 14230,-2531.33 14274.94,-2530.85 14994.97,-2532.37 15039,-2523.33 15082.87,-2514.33 15129.77,-2493.41 15161.76,-2477.23"/>
<polygon fill="red" stroke="red" points="15163.49,-2480.28 15170.78,-2472.59 15160.28,-2474.05 15163.49,-2480.28"/>
<text text-anchor="middle" x="14261.5" y="-2535.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu6 -->
<g id="node1055" class="node">
<title>l4_attn_stage3_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14549" cy="-2454.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14549" y="-2466.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="14549" y="-2451.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14549" y="-2436.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu6&#45;&gt;l4_attn_stage3_gpu6 -->
<g id="edge1687" class="edge">
<title>l4_attn_stage2_gpu6&#45;&gt;l4_attn_stage3_gpu6</title>
<path fill="none" stroke="black" d="M14495.13,-2571.89C14481.13,-2565.64 14465.82,-2559.85 14451,-2556.33 14437.42,-2553.11 14209.67,-2556.4 14200,-2546.33 14195.38,-2541.53 14195.36,-2536.12 14200,-2531.33 14209.71,-2521.31 14437.75,-2527.69 14451,-2523.33 14469.55,-2517.24 14487.76,-2506.44 14503.35,-2495.25"/>
<polygon fill="black" stroke="black" points="14505.79,-2497.8 14511.73,-2489.02 14501.61,-2492.18 14505.79,-2497.8"/>
</g>
<!-- l4_attn_stage2_gpu6&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2999" class="edge">
<title>l4_attn_stage2_gpu6&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14601.98,-2571.75C14615.9,-2565.45 14631.18,-2559.68 14646,-2556.33 14664.51,-2552.15 15315.68,-2559.85 15329,-2546.33 15357.36,-2517.56 15309.79,-2491.73 15264.82,-2475.1"/>
<polygon fill="red" stroke="red" points="15265.88,-2471.76 15255.29,-2471.69 15263.53,-2478.35 15265.88,-2471.76"/>
<text text-anchor="middle" x="15369.5" y="-2535.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu7 -->
<g id="node1056" class="node">
<title>l4_attn_stage3_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14159" cy="-2454.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14159" y="-2466.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="14159" y="-2451.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14159" y="-2436.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu7&#45;&gt;l4_attn_stage3_gpu7 -->
<g id="edge1688" class="edge">
<title>l4_attn_stage2_gpu7&#45;&gt;l4_attn_stage3_gpu7</title>
<path fill="none" stroke="black" d="M14159,-2564.24C14159,-2545.53 14159,-2522.53 14159,-2502.55"/>
<polygon fill="black" stroke="black" points="14162.5,-2502.41 14159,-2492.41 14155.5,-2502.41 14162.5,-2502.41"/>
</g>
<!-- l4_attn_stage2_gpu7&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge3000" class="edge">
<title>l4_attn_stage2_gpu7&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14211.97,-2571.71C14225.9,-2565.42 14241.18,-2559.66 14256,-2556.33 14280.42,-2550.86 15135.86,-2559.73 15157,-2546.33 15178.94,-2532.43 15190.24,-2504.16 15195.85,-2482.89"/>
<polygon fill="red" stroke="red" points="15199.27,-2483.64 15198.18,-2473.1 15192.46,-2482.02 15199.27,-2483.64"/>
<text text-anchor="middle" x="15204.5" y="-2535.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu8 -->
<g id="node1057" class="node">
<title>l4_attn_stage3_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="12794" cy="-2454.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12794" y="-2466.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="12794" y="-2451.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12794" y="-2436.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu8&#45;&gt;l4_attn_stage3_gpu8 -->
<g id="edge1689" class="edge">
<title>l4_attn_stage2_gpu8&#45;&gt;l4_attn_stage3_gpu8</title>
<path fill="none" stroke="black" d="M12794,-2564.24C12794,-2545.53 12794,-2522.53 12794,-2502.55"/>
<polygon fill="black" stroke="black" points="12797.5,-2502.41 12794,-2492.41 12790.5,-2502.41 12797.5,-2502.41"/>
</g>
<!-- l4_attn_stage2_gpu8&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge3001" class="edge">
<title>l4_attn_stage2_gpu8&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12846.96,-2571.66C12860.88,-2565.37 12876.17,-2559.62 12891,-2556.33 12936.13,-2546.33 14511.38,-2561.62 14555,-2546.33 14565.15,-2542.77 14563.87,-2534.95 14574,-2531.33 14622.67,-2513.97 14988.42,-2533.9 15039,-2523.33 15082.84,-2514.17 15129.74,-2493.28 15161.74,-2477.14"/>
<polygon fill="red" stroke="red" points="15163.46,-2480.2 15170.76,-2472.52 15160.27,-2473.97 15163.46,-2480.2"/>
<text text-anchor="middle" x="14605.5" y="-2535.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu9 -->
<g id="node1058" class="node">
<title>l4_attn_stage3_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="12989" cy="-2454.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12989" y="-2466.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="12989" y="-2451.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12989" y="-2436.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu9&#45;&gt;l4_attn_stage3_gpu9 -->
<g id="edge1690" class="edge">
<title>l4_attn_stage2_gpu9&#45;&gt;l4_attn_stage3_gpu9</title>
<path fill="none" stroke="black" d="M12989,-2564.24C12989,-2545.53 12989,-2522.53 12989,-2502.55"/>
<polygon fill="black" stroke="black" points="12992.5,-2502.41 12989,-2492.41 12985.5,-2502.41 12992.5,-2502.41"/>
</g>
<!-- l4_attn_stage2_gpu9&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge3002" class="edge">
<title>l4_attn_stage2_gpu9&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13041.96,-2571.66C13055.89,-2565.37 13071.17,-2559.62 13086,-2556.33 13128.17,-2546.98 14600.24,-2560.63 14641,-2546.33 14651.15,-2542.77 14649.87,-2534.97 14660,-2531.33 14699.64,-2517.1 14997.79,-2532.03 15039,-2523.33 15082.82,-2514.09 15129.73,-2493.2 15161.73,-2477.1"/>
<polygon fill="red" stroke="red" points="15163.45,-2480.15 15170.75,-2472.48 15160.26,-2473.92 15163.45,-2480.15"/>
<text text-anchor="middle" x="14691.5" y="-2535.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu10 -->
<g id="node1059" class="node">
<title>l4_attn_stage3_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12209" cy="-2454.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12209" y="-2466.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="12209" y="-2451.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12209" y="-2436.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu10&#45;&gt;l4_attn_stage3_gpu10 -->
<g id="edge1691" class="edge">
<title>l4_attn_stage2_gpu10&#45;&gt;l4_attn_stage3_gpu10</title>
<path fill="none" stroke="black" d="M12209,-2564.24C12209,-2545.53 12209,-2522.53 12209,-2502.55"/>
<polygon fill="black" stroke="black" points="12212.5,-2502.41 12209,-2492.41 12205.5,-2502.41 12212.5,-2502.41"/>
</g>
<!-- l4_attn_stage2_gpu10&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge3003" class="edge">
<title>l4_attn_stage2_gpu10&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12261.96,-2571.65C12275.88,-2565.36 12291.17,-2559.61 12306,-2556.33 12360,-2544.39 14244.8,-2564.6 14297,-2546.33 14307.15,-2542.78 14305.86,-2534.92 14316,-2531.33 14353.87,-2517.95 14999.66,-2531.43 15039,-2523.33 15082.87,-2514.31 15129.77,-2493.39 15161.76,-2477.22"/>
<polygon fill="red" stroke="red" points="15163.48,-2480.27 15170.78,-2472.58 15160.28,-2474.04 15163.48,-2480.27"/>
<text text-anchor="middle" x="14347.5" y="-2535.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu11 -->
<g id="node1060" class="node">
<title>l4_attn_stage3_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="12599" cy="-2454.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12599" y="-2466.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="12599" y="-2451.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12599" y="-2436.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu11&#45;&gt;l4_attn_stage3_gpu11 -->
<g id="edge1692" class="edge">
<title>l4_attn_stage2_gpu11&#45;&gt;l4_attn_stage3_gpu11</title>
<path fill="none" stroke="black" d="M12599,-2564.24C12599,-2545.53 12599,-2522.53 12599,-2502.55"/>
<polygon fill="black" stroke="black" points="12602.5,-2502.41 12599,-2492.41 12595.5,-2502.41 12602.5,-2502.41"/>
</g>
<!-- l4_attn_stage2_gpu11&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge3004" class="edge">
<title>l4_attn_stage2_gpu11&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12651.96,-2571.66C12665.88,-2565.36 12681.17,-2559.62 12696,-2556.33 12744.09,-2545.69 14422.52,-2562.62 14469,-2546.33 14479.15,-2542.78 14477.86,-2534.94 14488,-2531.33 14516.85,-2521.08 15009.02,-2529.55 15039,-2523.33 15082.85,-2514.23 15129.75,-2493.33 15161.75,-2477.18"/>
<polygon fill="red" stroke="red" points="15163.47,-2480.23 15170.77,-2472.55 15160.27,-2474 15163.47,-2480.23"/>
<text text-anchor="middle" x="14519.5" y="-2535.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu12 -->
<g id="node1061" class="node">
<title>l4_attn_stage3_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14939" cy="-2454.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14939" y="-2466.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="14939" y="-2451.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14939" y="-2436.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu12&#45;&gt;l4_attn_stage3_gpu12 -->
<g id="edge1693" class="edge">
<title>l4_attn_stage2_gpu12&#45;&gt;l4_attn_stage3_gpu12</title>
<path fill="none" stroke="black" d="M14885.7,-2571.88C14871.56,-2565.54 14856.04,-2559.71 14841,-2556.33 14824.01,-2552.51 14226.22,-2558.75 14214,-2546.33 14209.32,-2541.58 14209.32,-2536.08 14214,-2531.33 14226.24,-2518.94 14824.4,-2528.61 14841,-2523.33 14859.6,-2517.42 14877.83,-2506.67 14893.42,-2495.46"/>
<polygon fill="black" stroke="black" points="14895.87,-2498 14901.79,-2489.22 14891.68,-2492.39 14895.87,-2498"/>
</g>
<!-- l4_attn_stage2_gpu12&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge3005" class="edge">
<title>l4_attn_stage2_gpu12&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14994.09,-2572.4C15009.23,-2565.88 15025.92,-2559.84 15042,-2556.33 15066.92,-2550.9 15483.16,-2564.56 15501,-2546.33 15555.67,-2490.46 15454.45,-2468.8 15355.12,-2460.54"/>
<polygon fill="red" stroke="red" points="15355.15,-2457.03 15344.9,-2459.74 15354.6,-2464.01 15355.15,-2457.03"/>
<text text-anchor="middle" x="15542.5" y="-2535.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu13 -->
<g id="node1062" class="node">
<title>l4_attn_stage3_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13184" cy="-2454.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13184" y="-2466.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="13184" y="-2451.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13184" y="-2436.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu13&#45;&gt;l4_attn_stage3_gpu13 -->
<g id="edge1694" class="edge">
<title>l4_attn_stage2_gpu13&#45;&gt;l4_attn_stage3_gpu13</title>
<path fill="none" stroke="black" d="M13184,-2564.24C13184,-2545.53 13184,-2522.53 13184,-2502.55"/>
<polygon fill="black" stroke="black" points="13187.5,-2502.41 13184,-2492.41 13180.5,-2502.41 13187.5,-2502.41"/>
</g>
<!-- l4_attn_stage2_gpu13&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge3006" class="edge">
<title>l4_attn_stage2_gpu13&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13236.96,-2571.67C13250.89,-2565.38 13266.17,-2559.63 13281,-2556.33 13320.21,-2547.63 14689.1,-2559.64 14727,-2546.33 14737.15,-2542.77 14735.89,-2535 14746,-2531.33 14776.62,-2520.23 15007.15,-2530.16 15039,-2523.33 15082.66,-2513.98 15129.41,-2493.22 15161.42,-2477.17"/>
<polygon fill="red" stroke="red" points="15163.12,-2480.23 15170.45,-2472.58 15159.95,-2473.99 15163.12,-2480.23"/>
<text text-anchor="middle" x="14777.5" y="-2535.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu14 -->
<g id="node1063" class="node">
<title>l4_attn_stage3_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="13769" cy="-2454.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13769" y="-2466.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="13769" y="-2451.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13769" y="-2436.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu14&#45;&gt;l4_attn_stage3_gpu14 -->
<g id="edge1695" class="edge">
<title>l4_attn_stage2_gpu14&#45;&gt;l4_attn_stage3_gpu14</title>
<path fill="none" stroke="black" d="M13769,-2564.24C13769,-2545.53 13769,-2522.53 13769,-2502.55"/>
<polygon fill="black" stroke="black" points="13772.5,-2502.41 13769,-2492.41 13765.5,-2502.41 13772.5,-2502.41"/>
</g>
<!-- l4_attn_stage2_gpu14&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge3007" class="edge">
<title>l4_attn_stage2_gpu14&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13821.97,-2571.69C13835.89,-2565.4 13851.17,-2559.64 13866,-2556.33 13926.68,-2542.79 14926.36,-2566.98 14985,-2546.33 14995.15,-2542.76 14994.3,-2535.98 15004,-2531.33 15018.39,-2524.44 15023.8,-2528.2 15039,-2523.33 15079.94,-2510.23 15124.95,-2491.07 15157.12,-2476.51"/>
<polygon fill="red" stroke="red" points="15158.61,-2479.68 15166.25,-2472.34 15155.7,-2473.31 15158.61,-2479.68"/>
<text text-anchor="middle" x="15035.5" y="-2535.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu15 -->
<g id="node1064" class="node">
<title>l4_attn_stage3_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="13379" cy="-2454.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13379" y="-2466.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="13379" y="-2451.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13379" y="-2436.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu15&#45;&gt;l4_attn_stage3_gpu15 -->
<g id="edge1696" class="edge">
<title>l4_attn_stage2_gpu15&#45;&gt;l4_attn_stage3_gpu15</title>
<path fill="none" stroke="black" d="M13379,-2564.24C13379,-2545.53 13379,-2522.53 13379,-2502.55"/>
<polygon fill="black" stroke="black" points="13382.5,-2502.41 13379,-2492.41 13375.5,-2502.41 13382.5,-2502.41"/>
</g>
<!-- l4_attn_stage2_gpu15&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge3008" class="edge">
<title>l4_attn_stage2_gpu15&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13431.96,-2571.68C13445.89,-2565.38 13461.17,-2559.63 13476,-2556.33 13548.51,-2540.21 14742.92,-2570.96 14813,-2546.33 14823.15,-2542.77 14821.91,-2535.06 14832,-2531.33 14875.19,-2515.4 14994.04,-2533.23 15039,-2523.33 15082.6,-2513.73 15129.37,-2493.01 15161.39,-2477.04"/>
<polygon fill="red" stroke="red" points="15163.08,-2480.1 15170.42,-2472.46 15159.92,-2473.86 15163.08,-2480.1"/>
<text text-anchor="middle" x="14863.5" y="-2535.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu0 -->
<g id="node1065" class="node">
<title>l4_attn_stage4_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="13574" cy="-2307.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13574" y="-2319.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="13574" y="-2304.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13574" y="-2289.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu0&#45;&gt;l4_attn_stage4_gpu0 -->
<g id="edge1697" class="edge">
<title>l4_attn_stage3_gpu0&#45;&gt;l4_attn_stage4_gpu0</title>
<path fill="none" stroke="black" d="M13574,-2417.24C13574,-2398.53 13574,-2375.53 13574,-2355.55"/>
<polygon fill="black" stroke="black" points="13577.5,-2355.41 13574,-2345.41 13570.5,-2355.41 13577.5,-2355.41"/>
</g>
<!-- l4_attn_stage4_gpu[next_gpu] -->
<g id="node1393" class="node">
<title>l4_attn_stage4_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="15201" cy="-2307.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="15201" y="-2304.13" font-family="Times,serif" font-size="14.00">l4_attn_stage4_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage3_gpu0&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge3009" class="edge">
<title>l4_attn_stage3_gpu0&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13626.97,-2424.68C13640.89,-2418.39 13656.17,-2412.64 13671,-2409.33 13737.59,-2394.5 14834.64,-2421.97 14899,-2399.33 14909.15,-2395.76 14907.96,-2388.2 14918,-2384.33 14968.3,-2364.99 14986.53,-2388.64 15039,-2376.33 15082.2,-2366.2 15128.67,-2345.75 15160.71,-2330.01"/>
<polygon fill="red" stroke="red" points="15162.38,-2333.09 15169.77,-2325.49 15159.25,-2326.82 15162.38,-2333.09"/>
<text text-anchor="middle" x="14949.5" y="-2388.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu1 -->
<g id="node1066" class="node">
<title>l4_attn_stage4_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14354" cy="-2307.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14354" y="-2319.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="14354" y="-2304.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14354" y="-2289.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu1&#45;&gt;l4_attn_stage4_gpu1 -->
<g id="edge1698" class="edge">
<title>l4_attn_stage3_gpu1&#45;&gt;l4_attn_stage4_gpu1</title>
<path fill="none" stroke="black" d="M14298.51,-2425.52C14284.88,-2419.44 14270.14,-2413.58 14256,-2409.33 14242.42,-2405.25 14202.2,-2410.11 14193,-2399.33 14158.44,-2358.85 14200.28,-2397.61 14256,-2376.33 14273.91,-2369.49 14291.72,-2358.74 14307.14,-2347.81"/>
<polygon fill="black" stroke="black" points="14309.44,-2350.47 14315.45,-2341.75 14305.31,-2344.82 14309.44,-2350.47"/>
</g>
<!-- l4_attn_stage3_gpu1&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge3010" class="edge">
<title>l4_attn_stage3_gpu1&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14406.98,-2424.73C14420.9,-2418.43 14436.18,-2412.67 14451,-2409.33 14472.46,-2404.5 15227.54,-2414.99 15243,-2399.33 15261.16,-2380.94 15243.89,-2353.25 15226.31,-2333.34"/>
<polygon fill="red" stroke="red" points="15228.75,-2330.82 15219.38,-2325.87 15223.61,-2335.58 15228.75,-2330.82"/>
<text text-anchor="middle" x="15282.5" y="-2388.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu2 -->
<g id="node1067" class="node">
<title>l4_attn_stage4_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="12404" cy="-2307.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12404" y="-2319.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="12404" y="-2304.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12404" y="-2289.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu2&#45;&gt;l4_attn_stage4_gpu2 -->
<g id="edge1699" class="edge">
<title>l4_attn_stage3_gpu2&#45;&gt;l4_attn_stage4_gpu2</title>
<path fill="none" stroke="black" d="M12404,-2417.24C12404,-2398.53 12404,-2375.53 12404,-2355.55"/>
<polygon fill="black" stroke="black" points="12407.5,-2355.41 12404,-2345.41 12400.5,-2355.41 12407.5,-2355.41"/>
</g>
<!-- l4_attn_stage3_gpu2&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge3011" class="edge">
<title>l4_attn_stage3_gpu2&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12456.96,-2424.65C12470.88,-2418.36 12486.17,-2412.61 12501,-2409.33 12552.04,-2398.04 14333.66,-2416.61 14383,-2399.33 14393.15,-2395.78 14391.86,-2387.93 14402,-2384.33 14435.36,-2372.52 15004.34,-2383.49 15039,-2376.33 15082.86,-2367.27 15129.76,-2346.36 15161.75,-2330.2"/>
<polygon fill="red" stroke="red" points="15163.48,-2333.25 15170.77,-2325.57 15160.28,-2327.02 15163.48,-2333.25"/>
<text text-anchor="middle" x="14433.5" y="-2388.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu3 -->
<g id="node1068" class="node">
<title>l4_attn_stage4_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14744" cy="-2307.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14744" y="-2319.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="14744" y="-2304.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14744" y="-2289.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu3&#45;&gt;l4_attn_stage4_gpu3 -->
<g id="edge1700" class="edge">
<title>l4_attn_stage3_gpu3&#45;&gt;l4_attn_stage4_gpu3</title>
<path fill="none" stroke="black" d="M14690.43,-2424.83C14676.36,-2418.54 14660.94,-2412.74 14646,-2409.33 14622.22,-2403.9 14224.05,-2416.78 14207,-2399.33 14202.34,-2394.57 14202.33,-2389.09 14207,-2384.33 14215.55,-2375.63 14634.39,-2380.06 14646,-2376.33 14664.59,-2370.36 14682.81,-2359.6 14698.4,-2348.4"/>
<polygon fill="black" stroke="black" points="14700.84,-2350.94 14706.77,-2342.16 14696.66,-2345.33 14700.84,-2350.94"/>
</g>
<!-- l4_attn_stage3_gpu3&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge3012" class="edge">
<title>l4_attn_stage3_gpu3&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14796.99,-2424.78C14810.91,-2418.48 14826.19,-2412.7 14841,-2409.33 14856.55,-2405.79 15403.82,-2410.71 15415,-2399.33 15455.03,-2358.6 15385.32,-2335.24 15315.01,-2322.49"/>
<polygon fill="red" stroke="red" points="15315.55,-2319.04 15305.1,-2320.77 15314.35,-2325.93 15315.55,-2319.04"/>
<text text-anchor="middle" x="15456.5" y="-2388.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu4 -->
<g id="node1069" class="node">
<title>l4_attn_stage4_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13964" cy="-2307.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13964" y="-2319.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="13964" y="-2304.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13964" y="-2289.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu4&#45;&gt;l4_attn_stage4_gpu4 -->
<g id="edge1701" class="edge">
<title>l4_attn_stage3_gpu4&#45;&gt;l4_attn_stage4_gpu4</title>
<path fill="none" stroke="black" d="M13964,-2417.24C13964,-2398.53 13964,-2375.53 13964,-2355.55"/>
<polygon fill="black" stroke="black" points="13967.5,-2355.41 13964,-2345.41 13960.5,-2355.41 13967.5,-2355.41"/>
</g>
<!-- l4_attn_stage3_gpu4&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge3013" class="edge">
<title>l4_attn_stage3_gpu4&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14016.97,-2424.7C14030.89,-2418.41 14046.17,-2412.65 14061,-2409.33 14115.76,-2397.09 15018.08,-2418 15071,-2399.33 15081.15,-2395.75 15081.32,-2390.7 15090,-2384.33 15115.22,-2365.84 15144.5,-2345.99 15166.65,-2331.29"/>
<polygon fill="red" stroke="red" points="15168.66,-2334.15 15175.07,-2325.72 15164.8,-2328.31 15168.66,-2334.15"/>
<text text-anchor="middle" x="15121.5" y="-2388.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu5 -->
<g id="node1070" class="node">
<title>l4_attn_stage4_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="12014" cy="-2307.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12014" y="-2319.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="12014" y="-2304.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12014" y="-2289.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu5&#45;&gt;l4_attn_stage4_gpu5 -->
<g id="edge1702" class="edge">
<title>l4_attn_stage3_gpu5&#45;&gt;l4_attn_stage4_gpu5</title>
<path fill="none" stroke="black" d="M12014,-2417.24C12014,-2398.53 12014,-2375.53 12014,-2355.55"/>
<polygon fill="black" stroke="black" points="12017.5,-2355.41 12014,-2345.41 12010.5,-2355.41 12017.5,-2355.41"/>
</g>
<!-- l4_attn_stage3_gpu5&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge3014" class="edge">
<title>l4_attn_stage3_gpu5&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12066.97,-2424.72C12080.9,-2418.43 12096.18,-2412.66 12111,-2409.33 12340.74,-2357.73 13994.55,-2386.89 14230,-2384.33 14274.94,-2383.85 14994.97,-2385.37 15039,-2376.33 15082.87,-2367.33 15129.77,-2346.41 15161.76,-2330.23"/>
<polygon fill="red" stroke="red" points="15163.49,-2333.28 15170.78,-2325.59 15160.28,-2327.05 15163.49,-2333.28"/>
<text text-anchor="middle" x="14261.5" y="-2388.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu6 -->
<g id="node1071" class="node">
<title>l4_attn_stage4_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14549" cy="-2307.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14549" y="-2319.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="14549" y="-2304.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14549" y="-2289.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu6&#45;&gt;l4_attn_stage4_gpu6 -->
<g id="edge1703" class="edge">
<title>l4_attn_stage3_gpu6&#45;&gt;l4_attn_stage4_gpu6</title>
<path fill="none" stroke="black" d="M14495.13,-2424.89C14481.13,-2418.64 14465.82,-2412.85 14451,-2409.33 14437.42,-2406.11 14209.67,-2409.4 14200,-2399.33 14195.38,-2394.53 14195.36,-2389.12 14200,-2384.33 14209.71,-2374.31 14437.75,-2380.69 14451,-2376.33 14469.55,-2370.24 14487.76,-2359.44 14503.35,-2348.25"/>
<polygon fill="black" stroke="black" points="14505.79,-2350.8 14511.73,-2342.02 14501.61,-2345.18 14505.79,-2350.8"/>
</g>
<!-- l4_attn_stage3_gpu6&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge3015" class="edge">
<title>l4_attn_stage3_gpu6&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14601.98,-2424.75C14615.9,-2418.45 14631.18,-2412.68 14646,-2409.33 14664.51,-2405.15 15315.68,-2412.85 15329,-2399.33 15357.36,-2370.56 15309.79,-2344.73 15264.82,-2328.1"/>
<polygon fill="red" stroke="red" points="15265.88,-2324.76 15255.29,-2324.69 15263.53,-2331.35 15265.88,-2324.76"/>
<text text-anchor="middle" x="15369.5" y="-2388.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu7 -->
<g id="node1072" class="node">
<title>l4_attn_stage4_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14159" cy="-2307.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14159" y="-2319.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="14159" y="-2304.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14159" y="-2289.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu7&#45;&gt;l4_attn_stage4_gpu7 -->
<g id="edge1704" class="edge">
<title>l4_attn_stage3_gpu7&#45;&gt;l4_attn_stage4_gpu7</title>
<path fill="none" stroke="black" d="M14159,-2417.24C14159,-2398.53 14159,-2375.53 14159,-2355.55"/>
<polygon fill="black" stroke="black" points="14162.5,-2355.41 14159,-2345.41 14155.5,-2355.41 14162.5,-2355.41"/>
</g>
<!-- l4_attn_stage3_gpu7&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge3016" class="edge">
<title>l4_attn_stage3_gpu7&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14211.97,-2424.71C14225.9,-2418.42 14241.18,-2412.66 14256,-2409.33 14280.42,-2403.86 15135.86,-2412.73 15157,-2399.33 15178.94,-2385.43 15190.24,-2357.16 15195.85,-2335.89"/>
<polygon fill="red" stroke="red" points="15199.27,-2336.64 15198.18,-2326.1 15192.46,-2335.02 15199.27,-2336.64"/>
<text text-anchor="middle" x="15204.5" y="-2388.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu8 -->
<g id="node1073" class="node">
<title>l4_attn_stage4_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="12794" cy="-2307.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12794" y="-2319.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="12794" y="-2304.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12794" y="-2289.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu8&#45;&gt;l4_attn_stage4_gpu8 -->
<g id="edge1705" class="edge">
<title>l4_attn_stage3_gpu8&#45;&gt;l4_attn_stage4_gpu8</title>
<path fill="none" stroke="black" d="M12794,-2417.24C12794,-2398.53 12794,-2375.53 12794,-2355.55"/>
<polygon fill="black" stroke="black" points="12797.5,-2355.41 12794,-2345.41 12790.5,-2355.41 12797.5,-2355.41"/>
</g>
<!-- l4_attn_stage3_gpu8&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge3017" class="edge">
<title>l4_attn_stage3_gpu8&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12846.96,-2424.66C12860.88,-2418.37 12876.17,-2412.62 12891,-2409.33 12936.13,-2399.33 14511.38,-2414.62 14555,-2399.33 14565.15,-2395.77 14563.87,-2387.95 14574,-2384.33 14622.67,-2366.97 14988.42,-2386.9 15039,-2376.33 15082.84,-2367.17 15129.74,-2346.28 15161.74,-2330.14"/>
<polygon fill="red" stroke="red" points="15163.46,-2333.2 15170.76,-2325.52 15160.27,-2326.97 15163.46,-2333.2"/>
<text text-anchor="middle" x="14605.5" y="-2388.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu9 -->
<g id="node1074" class="node">
<title>l4_attn_stage4_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="12989" cy="-2307.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12989" y="-2319.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="12989" y="-2304.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12989" y="-2289.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu9&#45;&gt;l4_attn_stage4_gpu9 -->
<g id="edge1706" class="edge">
<title>l4_attn_stage3_gpu9&#45;&gt;l4_attn_stage4_gpu9</title>
<path fill="none" stroke="black" d="M12989,-2417.24C12989,-2398.53 12989,-2375.53 12989,-2355.55"/>
<polygon fill="black" stroke="black" points="12992.5,-2355.41 12989,-2345.41 12985.5,-2355.41 12992.5,-2355.41"/>
</g>
<!-- l4_attn_stage3_gpu9&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge3018" class="edge">
<title>l4_attn_stage3_gpu9&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13041.96,-2424.66C13055.89,-2418.37 13071.17,-2412.62 13086,-2409.33 13128.17,-2399.98 14600.24,-2413.63 14641,-2399.33 14651.15,-2395.77 14649.87,-2387.97 14660,-2384.33 14699.64,-2370.1 14997.79,-2385.03 15039,-2376.33 15082.82,-2367.09 15129.73,-2346.2 15161.73,-2330.1"/>
<polygon fill="red" stroke="red" points="15163.45,-2333.15 15170.75,-2325.48 15160.26,-2326.92 15163.45,-2333.15"/>
<text text-anchor="middle" x="14691.5" y="-2388.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu10 -->
<g id="node1075" class="node">
<title>l4_attn_stage4_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12209" cy="-2307.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12209" y="-2319.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="12209" y="-2304.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12209" y="-2289.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu10&#45;&gt;l4_attn_stage4_gpu10 -->
<g id="edge1707" class="edge">
<title>l4_attn_stage3_gpu10&#45;&gt;l4_attn_stage4_gpu10</title>
<path fill="none" stroke="black" d="M12209,-2417.24C12209,-2398.53 12209,-2375.53 12209,-2355.55"/>
<polygon fill="black" stroke="black" points="12212.5,-2355.41 12209,-2345.41 12205.5,-2355.41 12212.5,-2355.41"/>
</g>
<!-- l4_attn_stage3_gpu10&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge3019" class="edge">
<title>l4_attn_stage3_gpu10&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12261.96,-2424.65C12275.88,-2418.36 12291.17,-2412.61 12306,-2409.33 12360,-2397.39 14244.8,-2417.6 14297,-2399.33 14307.15,-2395.78 14305.86,-2387.92 14316,-2384.33 14353.87,-2370.95 14999.66,-2384.43 15039,-2376.33 15082.87,-2367.31 15129.77,-2346.39 15161.76,-2330.22"/>
<polygon fill="red" stroke="red" points="15163.48,-2333.27 15170.78,-2325.58 15160.28,-2327.04 15163.48,-2333.27"/>
<text text-anchor="middle" x="14347.5" y="-2388.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu11 -->
<g id="node1076" class="node">
<title>l4_attn_stage4_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="12599" cy="-2307.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12599" y="-2319.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="12599" y="-2304.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12599" y="-2289.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu11&#45;&gt;l4_attn_stage4_gpu11 -->
<g id="edge1708" class="edge">
<title>l4_attn_stage3_gpu11&#45;&gt;l4_attn_stage4_gpu11</title>
<path fill="none" stroke="black" d="M12599,-2417.24C12599,-2398.53 12599,-2375.53 12599,-2355.55"/>
<polygon fill="black" stroke="black" points="12602.5,-2355.41 12599,-2345.41 12595.5,-2355.41 12602.5,-2355.41"/>
</g>
<!-- l4_attn_stage3_gpu11&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge3020" class="edge">
<title>l4_attn_stage3_gpu11&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12651.96,-2424.66C12665.88,-2418.36 12681.17,-2412.62 12696,-2409.33 12744.09,-2398.69 14422.52,-2415.62 14469,-2399.33 14479.15,-2395.78 14477.86,-2387.94 14488,-2384.33 14516.85,-2374.08 15009.02,-2382.55 15039,-2376.33 15082.85,-2367.23 15129.75,-2346.33 15161.75,-2330.18"/>
<polygon fill="red" stroke="red" points="15163.47,-2333.23 15170.77,-2325.55 15160.27,-2327 15163.47,-2333.23"/>
<text text-anchor="middle" x="14519.5" y="-2388.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu12 -->
<g id="node1077" class="node">
<title>l4_attn_stage4_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14939" cy="-2307.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14939" y="-2319.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="14939" y="-2304.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14939" y="-2289.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu12&#45;&gt;l4_attn_stage4_gpu12 -->
<g id="edge1709" class="edge">
<title>l4_attn_stage3_gpu12&#45;&gt;l4_attn_stage4_gpu12</title>
<path fill="none" stroke="black" d="M14885.7,-2424.88C14871.56,-2418.54 14856.04,-2412.71 14841,-2409.33 14824.01,-2405.51 14226.22,-2411.75 14214,-2399.33 14209.32,-2394.58 14209.32,-2389.08 14214,-2384.33 14226.24,-2371.94 14824.4,-2381.61 14841,-2376.33 14859.6,-2370.42 14877.83,-2359.67 14893.42,-2348.46"/>
<polygon fill="black" stroke="black" points="14895.87,-2351 14901.79,-2342.22 14891.68,-2345.39 14895.87,-2351"/>
</g>
<!-- l4_attn_stage3_gpu12&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge3021" class="edge">
<title>l4_attn_stage3_gpu12&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14994.09,-2425.4C15009.23,-2418.88 15025.92,-2412.84 15042,-2409.33 15066.92,-2403.9 15483.16,-2417.56 15501,-2399.33 15555.67,-2343.46 15454.45,-2321.8 15355.12,-2313.54"/>
<polygon fill="red" stroke="red" points="15355.15,-2310.03 15344.9,-2312.74 15354.6,-2317.01 15355.15,-2310.03"/>
<text text-anchor="middle" x="15542.5" y="-2388.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu13 -->
<g id="node1078" class="node">
<title>l4_attn_stage4_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13184" cy="-2307.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13184" y="-2319.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="13184" y="-2304.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13184" y="-2289.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu13&#45;&gt;l4_attn_stage4_gpu13 -->
<g id="edge1710" class="edge">
<title>l4_attn_stage3_gpu13&#45;&gt;l4_attn_stage4_gpu13</title>
<path fill="none" stroke="black" d="M13184,-2417.24C13184,-2398.53 13184,-2375.53 13184,-2355.55"/>
<polygon fill="black" stroke="black" points="13187.5,-2355.41 13184,-2345.41 13180.5,-2355.41 13187.5,-2355.41"/>
</g>
<!-- l4_attn_stage3_gpu13&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge3022" class="edge">
<title>l4_attn_stage3_gpu13&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13236.96,-2424.67C13250.89,-2418.38 13266.17,-2412.63 13281,-2409.33 13320.21,-2400.63 14689.1,-2412.64 14727,-2399.33 14737.15,-2395.77 14735.89,-2388 14746,-2384.33 14776.62,-2373.23 15007.15,-2383.16 15039,-2376.33 15082.66,-2366.98 15129.41,-2346.22 15161.42,-2330.17"/>
<polygon fill="red" stroke="red" points="15163.12,-2333.23 15170.45,-2325.58 15159.95,-2326.99 15163.12,-2333.23"/>
<text text-anchor="middle" x="14777.5" y="-2388.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu14 -->
<g id="node1079" class="node">
<title>l4_attn_stage4_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="13769" cy="-2307.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13769" y="-2319.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="13769" y="-2304.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13769" y="-2289.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu14&#45;&gt;l4_attn_stage4_gpu14 -->
<g id="edge1711" class="edge">
<title>l4_attn_stage3_gpu14&#45;&gt;l4_attn_stage4_gpu14</title>
<path fill="none" stroke="black" d="M13769,-2417.24C13769,-2398.53 13769,-2375.53 13769,-2355.55"/>
<polygon fill="black" stroke="black" points="13772.5,-2355.41 13769,-2345.41 13765.5,-2355.41 13772.5,-2355.41"/>
</g>
<!-- l4_attn_stage3_gpu14&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge3023" class="edge">
<title>l4_attn_stage3_gpu14&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13821.97,-2424.69C13835.89,-2418.4 13851.17,-2412.64 13866,-2409.33 13926.68,-2395.79 14926.36,-2419.98 14985,-2399.33 14995.15,-2395.76 14994.3,-2388.98 15004,-2384.33 15018.39,-2377.44 15023.8,-2381.2 15039,-2376.33 15079.94,-2363.23 15124.95,-2344.07 15157.12,-2329.51"/>
<polygon fill="red" stroke="red" points="15158.61,-2332.68 15166.25,-2325.34 15155.7,-2326.31 15158.61,-2332.68"/>
<text text-anchor="middle" x="15035.5" y="-2388.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu15 -->
<g id="node1080" class="node">
<title>l4_attn_stage4_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="13379" cy="-2307.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13379" y="-2319.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="13379" y="-2304.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13379" y="-2289.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu15&#45;&gt;l4_attn_stage4_gpu15 -->
<g id="edge1712" class="edge">
<title>l4_attn_stage3_gpu15&#45;&gt;l4_attn_stage4_gpu15</title>
<path fill="none" stroke="black" d="M13379,-2417.24C13379,-2398.53 13379,-2375.53 13379,-2355.55"/>
<polygon fill="black" stroke="black" points="13382.5,-2355.41 13379,-2345.41 13375.5,-2355.41 13382.5,-2355.41"/>
</g>
<!-- l4_attn_stage3_gpu15&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge3024" class="edge">
<title>l4_attn_stage3_gpu15&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13431.96,-2424.68C13445.89,-2418.38 13461.17,-2412.63 13476,-2409.33 13548.51,-2393.21 14742.92,-2423.96 14813,-2399.33 14823.15,-2395.77 14821.91,-2388.06 14832,-2384.33 14875.19,-2368.4 14994.04,-2386.23 15039,-2376.33 15082.6,-2366.73 15129.37,-2346.01 15161.39,-2330.04"/>
<polygon fill="red" stroke="red" points="15163.08,-2333.1 15170.42,-2325.46 15159.92,-2326.86 15163.08,-2333.1"/>
<text text-anchor="middle" x="14863.5" y="-2388.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu0 -->
<g id="node1081" class="node">
<title>l4_attn_stage5_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="13574" cy="-2160.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13574" y="-2172.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="13574" y="-2157.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13574" y="-2142.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu0&#45;&gt;l4_attn_stage5_gpu0 -->
<g id="edge1713" class="edge">
<title>l4_attn_stage4_gpu0&#45;&gt;l4_attn_stage5_gpu0</title>
<path fill="none" stroke="black" d="M13574,-2270.24C13574,-2251.53 13574,-2228.53 13574,-2208.55"/>
<polygon fill="black" stroke="black" points="13577.5,-2208.41 13574,-2198.41 13570.5,-2208.41 13577.5,-2208.41"/>
</g>
<!-- l4_attn_stage5_gpu[next_gpu] -->
<g id="node1394" class="node">
<title>l4_attn_stage5_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="15201" cy="-2160.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="15201" y="-2157.13" font-family="Times,serif" font-size="14.00">l4_attn_stage5_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage4_gpu0&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge3025" class="edge">
<title>l4_attn_stage4_gpu0&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13626.97,-2277.68C13640.89,-2271.39 13656.17,-2265.64 13671,-2262.33 13737.59,-2247.5 14834.64,-2274.97 14899,-2252.33 14909.15,-2248.76 14907.96,-2241.2 14918,-2237.33 14968.3,-2217.99 14986.53,-2241.64 15039,-2229.33 15082.2,-2219.2 15128.67,-2198.75 15160.71,-2183.01"/>
<polygon fill="red" stroke="red" points="15162.38,-2186.09 15169.77,-2178.49 15159.25,-2179.82 15162.38,-2186.09"/>
<text text-anchor="middle" x="14949.5" y="-2241.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu1 -->
<g id="node1082" class="node">
<title>l4_attn_stage5_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14354" cy="-2160.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14354" y="-2172.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="14354" y="-2157.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14354" y="-2142.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu1&#45;&gt;l4_attn_stage5_gpu1 -->
<g id="edge1714" class="edge">
<title>l4_attn_stage4_gpu1&#45;&gt;l4_attn_stage5_gpu1</title>
<path fill="none" stroke="black" d="M14298.51,-2278.52C14284.88,-2272.44 14270.14,-2266.58 14256,-2262.33 14242.42,-2258.25 14202.2,-2263.11 14193,-2252.33 14158.44,-2211.85 14200.28,-2250.61 14256,-2229.33 14273.91,-2222.49 14291.72,-2211.74 14307.14,-2200.81"/>
<polygon fill="black" stroke="black" points="14309.44,-2203.47 14315.45,-2194.75 14305.31,-2197.82 14309.44,-2203.47"/>
</g>
<!-- l4_attn_stage4_gpu1&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge3026" class="edge">
<title>l4_attn_stage4_gpu1&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14406.98,-2277.73C14420.9,-2271.43 14436.18,-2265.67 14451,-2262.33 14472.46,-2257.5 15227.54,-2267.99 15243,-2252.33 15261.16,-2233.94 15243.89,-2206.25 15226.31,-2186.34"/>
<polygon fill="red" stroke="red" points="15228.75,-2183.82 15219.38,-2178.87 15223.61,-2188.58 15228.75,-2183.82"/>
<text text-anchor="middle" x="15282.5" y="-2241.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu2 -->
<g id="node1083" class="node">
<title>l4_attn_stage5_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="12404" cy="-2160.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12404" y="-2172.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="12404" y="-2157.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12404" y="-2142.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu2&#45;&gt;l4_attn_stage5_gpu2 -->
<g id="edge1715" class="edge">
<title>l4_attn_stage4_gpu2&#45;&gt;l4_attn_stage5_gpu2</title>
<path fill="none" stroke="black" d="M12404,-2270.24C12404,-2251.53 12404,-2228.53 12404,-2208.55"/>
<polygon fill="black" stroke="black" points="12407.5,-2208.41 12404,-2198.41 12400.5,-2208.41 12407.5,-2208.41"/>
</g>
<!-- l4_attn_stage4_gpu2&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge3027" class="edge">
<title>l4_attn_stage4_gpu2&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12456.96,-2277.65C12470.88,-2271.36 12486.17,-2265.61 12501,-2262.33 12552.04,-2251.04 14333.66,-2269.61 14383,-2252.33 14393.15,-2248.78 14391.86,-2240.93 14402,-2237.33 14435.36,-2225.52 15004.34,-2236.49 15039,-2229.33 15082.86,-2220.27 15129.76,-2199.36 15161.75,-2183.2"/>
<polygon fill="red" stroke="red" points="15163.48,-2186.25 15170.77,-2178.57 15160.28,-2180.02 15163.48,-2186.25"/>
<text text-anchor="middle" x="14433.5" y="-2241.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu3 -->
<g id="node1084" class="node">
<title>l4_attn_stage5_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14744" cy="-2160.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14744" y="-2172.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="14744" y="-2157.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14744" y="-2142.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu3&#45;&gt;l4_attn_stage5_gpu3 -->
<g id="edge1716" class="edge">
<title>l4_attn_stage4_gpu3&#45;&gt;l4_attn_stage5_gpu3</title>
<path fill="none" stroke="black" d="M14690.43,-2277.83C14676.36,-2271.54 14660.94,-2265.74 14646,-2262.33 14622.22,-2256.9 14224.05,-2269.78 14207,-2252.33 14202.34,-2247.57 14202.33,-2242.09 14207,-2237.33 14215.55,-2228.63 14634.39,-2233.06 14646,-2229.33 14664.59,-2223.36 14682.81,-2212.6 14698.4,-2201.4"/>
<polygon fill="black" stroke="black" points="14700.84,-2203.94 14706.77,-2195.16 14696.66,-2198.33 14700.84,-2203.94"/>
</g>
<!-- l4_attn_stage4_gpu3&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge3028" class="edge">
<title>l4_attn_stage4_gpu3&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14796.99,-2277.78C14810.91,-2271.48 14826.19,-2265.7 14841,-2262.33 14856.55,-2258.79 15403.82,-2263.71 15415,-2252.33 15455.03,-2211.6 15385.32,-2188.24 15315.01,-2175.49"/>
<polygon fill="red" stroke="red" points="15315.55,-2172.04 15305.1,-2173.77 15314.35,-2178.93 15315.55,-2172.04"/>
<text text-anchor="middle" x="15456.5" y="-2241.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu4 -->
<g id="node1085" class="node">
<title>l4_attn_stage5_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13964" cy="-2160.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13964" y="-2172.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="13964" y="-2157.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13964" y="-2142.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu4&#45;&gt;l4_attn_stage5_gpu4 -->
<g id="edge1717" class="edge">
<title>l4_attn_stage4_gpu4&#45;&gt;l4_attn_stage5_gpu4</title>
<path fill="none" stroke="black" d="M13964,-2270.24C13964,-2251.53 13964,-2228.53 13964,-2208.55"/>
<polygon fill="black" stroke="black" points="13967.5,-2208.41 13964,-2198.41 13960.5,-2208.41 13967.5,-2208.41"/>
</g>
<!-- l4_attn_stage4_gpu4&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge3029" class="edge">
<title>l4_attn_stage4_gpu4&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14016.97,-2277.7C14030.89,-2271.41 14046.17,-2265.65 14061,-2262.33 14115.76,-2250.09 15018.08,-2271 15071,-2252.33 15081.15,-2248.75 15081.32,-2243.7 15090,-2237.33 15115.22,-2218.84 15144.5,-2198.99 15166.65,-2184.29"/>
<polygon fill="red" stroke="red" points="15168.66,-2187.15 15175.07,-2178.72 15164.8,-2181.31 15168.66,-2187.15"/>
<text text-anchor="middle" x="15121.5" y="-2241.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu5 -->
<g id="node1086" class="node">
<title>l4_attn_stage5_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="12014" cy="-2160.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12014" y="-2172.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="12014" y="-2157.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12014" y="-2142.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu5&#45;&gt;l4_attn_stage5_gpu5 -->
<g id="edge1718" class="edge">
<title>l4_attn_stage4_gpu5&#45;&gt;l4_attn_stage5_gpu5</title>
<path fill="none" stroke="black" d="M12014,-2270.24C12014,-2251.53 12014,-2228.53 12014,-2208.55"/>
<polygon fill="black" stroke="black" points="12017.5,-2208.41 12014,-2198.41 12010.5,-2208.41 12017.5,-2208.41"/>
</g>
<!-- l4_attn_stage4_gpu5&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge3030" class="edge">
<title>l4_attn_stage4_gpu5&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12066.97,-2277.72C12080.9,-2271.43 12096.18,-2265.66 12111,-2262.33 12340.74,-2210.73 13994.55,-2239.89 14230,-2237.33 14274.94,-2236.85 14994.97,-2238.37 15039,-2229.33 15082.87,-2220.33 15129.77,-2199.41 15161.76,-2183.23"/>
<polygon fill="red" stroke="red" points="15163.49,-2186.28 15170.78,-2178.59 15160.28,-2180.05 15163.49,-2186.28"/>
<text text-anchor="middle" x="14261.5" y="-2241.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu6 -->
<g id="node1087" class="node">
<title>l4_attn_stage5_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14549" cy="-2160.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14549" y="-2172.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="14549" y="-2157.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14549" y="-2142.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu6&#45;&gt;l4_attn_stage5_gpu6 -->
<g id="edge1719" class="edge">
<title>l4_attn_stage4_gpu6&#45;&gt;l4_attn_stage5_gpu6</title>
<path fill="none" stroke="black" d="M14495.13,-2277.89C14481.13,-2271.64 14465.82,-2265.85 14451,-2262.33 14437.42,-2259.11 14209.67,-2262.4 14200,-2252.33 14195.38,-2247.53 14195.36,-2242.12 14200,-2237.33 14209.71,-2227.31 14437.75,-2233.69 14451,-2229.33 14469.55,-2223.24 14487.76,-2212.44 14503.35,-2201.25"/>
<polygon fill="black" stroke="black" points="14505.79,-2203.8 14511.73,-2195.02 14501.61,-2198.18 14505.79,-2203.8"/>
</g>
<!-- l4_attn_stage4_gpu6&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge3031" class="edge">
<title>l4_attn_stage4_gpu6&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14601.98,-2277.75C14615.9,-2271.45 14631.18,-2265.68 14646,-2262.33 14664.51,-2258.15 15315.68,-2265.85 15329,-2252.33 15357.36,-2223.56 15309.79,-2197.73 15264.82,-2181.1"/>
<polygon fill="red" stroke="red" points="15265.88,-2177.76 15255.29,-2177.69 15263.53,-2184.35 15265.88,-2177.76"/>
<text text-anchor="middle" x="15369.5" y="-2241.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu7 -->
<g id="node1088" class="node">
<title>l4_attn_stage5_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14159" cy="-2160.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14159" y="-2172.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="14159" y="-2157.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14159" y="-2142.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu7&#45;&gt;l4_attn_stage5_gpu7 -->
<g id="edge1720" class="edge">
<title>l4_attn_stage4_gpu7&#45;&gt;l4_attn_stage5_gpu7</title>
<path fill="none" stroke="black" d="M14159,-2270.24C14159,-2251.53 14159,-2228.53 14159,-2208.55"/>
<polygon fill="black" stroke="black" points="14162.5,-2208.41 14159,-2198.41 14155.5,-2208.41 14162.5,-2208.41"/>
</g>
<!-- l4_attn_stage4_gpu7&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge3032" class="edge">
<title>l4_attn_stage4_gpu7&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14211.97,-2277.71C14225.9,-2271.42 14241.18,-2265.66 14256,-2262.33 14280.42,-2256.86 15135.86,-2265.73 15157,-2252.33 15178.94,-2238.43 15190.24,-2210.16 15195.85,-2188.89"/>
<polygon fill="red" stroke="red" points="15199.27,-2189.64 15198.18,-2179.1 15192.46,-2188.02 15199.27,-2189.64"/>
<text text-anchor="middle" x="15204.5" y="-2241.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu8 -->
<g id="node1089" class="node">
<title>l4_attn_stage5_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="12794" cy="-2160.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12794" y="-2172.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="12794" y="-2157.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12794" y="-2142.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu8&#45;&gt;l4_attn_stage5_gpu8 -->
<g id="edge1721" class="edge">
<title>l4_attn_stage4_gpu8&#45;&gt;l4_attn_stage5_gpu8</title>
<path fill="none" stroke="black" d="M12794,-2270.24C12794,-2251.53 12794,-2228.53 12794,-2208.55"/>
<polygon fill="black" stroke="black" points="12797.5,-2208.41 12794,-2198.41 12790.5,-2208.41 12797.5,-2208.41"/>
</g>
<!-- l4_attn_stage4_gpu8&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge3033" class="edge">
<title>l4_attn_stage4_gpu8&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12846.96,-2277.66C12860.88,-2271.37 12876.17,-2265.62 12891,-2262.33 12936.13,-2252.33 14511.38,-2267.62 14555,-2252.33 14565.15,-2248.77 14563.87,-2240.95 14574,-2237.33 14622.67,-2219.97 14988.42,-2239.9 15039,-2229.33 15082.84,-2220.17 15129.74,-2199.28 15161.74,-2183.14"/>
<polygon fill="red" stroke="red" points="15163.46,-2186.2 15170.76,-2178.52 15160.27,-2179.97 15163.46,-2186.2"/>
<text text-anchor="middle" x="14605.5" y="-2241.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu9 -->
<g id="node1090" class="node">
<title>l4_attn_stage5_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="12989" cy="-2160.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12989" y="-2172.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="12989" y="-2157.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12989" y="-2142.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu9&#45;&gt;l4_attn_stage5_gpu9 -->
<g id="edge1722" class="edge">
<title>l4_attn_stage4_gpu9&#45;&gt;l4_attn_stage5_gpu9</title>
<path fill="none" stroke="black" d="M12989,-2270.24C12989,-2251.53 12989,-2228.53 12989,-2208.55"/>
<polygon fill="black" stroke="black" points="12992.5,-2208.41 12989,-2198.41 12985.5,-2208.41 12992.5,-2208.41"/>
</g>
<!-- l4_attn_stage4_gpu9&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge3034" class="edge">
<title>l4_attn_stage4_gpu9&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13041.96,-2277.66C13055.89,-2271.37 13071.17,-2265.62 13086,-2262.33 13128.17,-2252.98 14600.24,-2266.63 14641,-2252.33 14651.15,-2248.77 14649.87,-2240.97 14660,-2237.33 14699.64,-2223.1 14997.79,-2238.03 15039,-2229.33 15082.82,-2220.09 15129.73,-2199.2 15161.73,-2183.1"/>
<polygon fill="red" stroke="red" points="15163.45,-2186.15 15170.75,-2178.48 15160.26,-2179.92 15163.45,-2186.15"/>
<text text-anchor="middle" x="14691.5" y="-2241.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu10 -->
<g id="node1091" class="node">
<title>l4_attn_stage5_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12209" cy="-2160.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12209" y="-2172.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="12209" y="-2157.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12209" y="-2142.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu10&#45;&gt;l4_attn_stage5_gpu10 -->
<g id="edge1723" class="edge">
<title>l4_attn_stage4_gpu10&#45;&gt;l4_attn_stage5_gpu10</title>
<path fill="none" stroke="black" d="M12209,-2270.24C12209,-2251.53 12209,-2228.53 12209,-2208.55"/>
<polygon fill="black" stroke="black" points="12212.5,-2208.41 12209,-2198.41 12205.5,-2208.41 12212.5,-2208.41"/>
</g>
<!-- l4_attn_stage4_gpu10&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge3035" class="edge">
<title>l4_attn_stage4_gpu10&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12261.96,-2277.65C12275.88,-2271.36 12291.17,-2265.61 12306,-2262.33 12360,-2250.39 14244.8,-2270.6 14297,-2252.33 14307.15,-2248.78 14305.86,-2240.92 14316,-2237.33 14353.87,-2223.95 14999.66,-2237.43 15039,-2229.33 15082.87,-2220.31 15129.77,-2199.39 15161.76,-2183.22"/>
<polygon fill="red" stroke="red" points="15163.48,-2186.27 15170.78,-2178.58 15160.28,-2180.04 15163.48,-2186.27"/>
<text text-anchor="middle" x="14347.5" y="-2241.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu11 -->
<g id="node1092" class="node">
<title>l4_attn_stage5_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="12599" cy="-2160.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12599" y="-2172.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="12599" y="-2157.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12599" y="-2142.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu11&#45;&gt;l4_attn_stage5_gpu11 -->
<g id="edge1724" class="edge">
<title>l4_attn_stage4_gpu11&#45;&gt;l4_attn_stage5_gpu11</title>
<path fill="none" stroke="black" d="M12599,-2270.24C12599,-2251.53 12599,-2228.53 12599,-2208.55"/>
<polygon fill="black" stroke="black" points="12602.5,-2208.41 12599,-2198.41 12595.5,-2208.41 12602.5,-2208.41"/>
</g>
<!-- l4_attn_stage4_gpu11&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge3036" class="edge">
<title>l4_attn_stage4_gpu11&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12651.96,-2277.66C12665.88,-2271.36 12681.17,-2265.62 12696,-2262.33 12744.09,-2251.69 14422.52,-2268.62 14469,-2252.33 14479.15,-2248.78 14477.86,-2240.94 14488,-2237.33 14516.85,-2227.08 15009.02,-2235.55 15039,-2229.33 15082.85,-2220.23 15129.75,-2199.33 15161.75,-2183.18"/>
<polygon fill="red" stroke="red" points="15163.47,-2186.23 15170.77,-2178.55 15160.27,-2180 15163.47,-2186.23"/>
<text text-anchor="middle" x="14519.5" y="-2241.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu12 -->
<g id="node1093" class="node">
<title>l4_attn_stage5_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14939" cy="-2160.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14939" y="-2172.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="14939" y="-2157.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14939" y="-2142.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu12&#45;&gt;l4_attn_stage5_gpu12 -->
<g id="edge1725" class="edge">
<title>l4_attn_stage4_gpu12&#45;&gt;l4_attn_stage5_gpu12</title>
<path fill="none" stroke="black" d="M14885.7,-2277.88C14871.56,-2271.54 14856.04,-2265.71 14841,-2262.33 14824.01,-2258.51 14226.22,-2264.75 14214,-2252.33 14209.32,-2247.58 14209.32,-2242.08 14214,-2237.33 14226.24,-2224.94 14824.4,-2234.61 14841,-2229.33 14859.6,-2223.42 14877.83,-2212.67 14893.42,-2201.46"/>
<polygon fill="black" stroke="black" points="14895.87,-2204 14901.79,-2195.22 14891.68,-2198.39 14895.87,-2204"/>
</g>
<!-- l4_attn_stage4_gpu12&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge3037" class="edge">
<title>l4_attn_stage4_gpu12&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14994.09,-2278.4C15009.23,-2271.88 15025.92,-2265.84 15042,-2262.33 15066.92,-2256.9 15483.16,-2270.56 15501,-2252.33 15555.67,-2196.46 15454.45,-2174.8 15355.12,-2166.54"/>
<polygon fill="red" stroke="red" points="15355.15,-2163.03 15344.9,-2165.74 15354.6,-2170.01 15355.15,-2163.03"/>
<text text-anchor="middle" x="15542.5" y="-2241.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu13 -->
<g id="node1094" class="node">
<title>l4_attn_stage5_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13184" cy="-2160.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13184" y="-2172.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="13184" y="-2157.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13184" y="-2142.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu13&#45;&gt;l4_attn_stage5_gpu13 -->
<g id="edge1726" class="edge">
<title>l4_attn_stage4_gpu13&#45;&gt;l4_attn_stage5_gpu13</title>
<path fill="none" stroke="black" d="M13184,-2270.24C13184,-2251.53 13184,-2228.53 13184,-2208.55"/>
<polygon fill="black" stroke="black" points="13187.5,-2208.41 13184,-2198.41 13180.5,-2208.41 13187.5,-2208.41"/>
</g>
<!-- l4_attn_stage4_gpu13&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge3038" class="edge">
<title>l4_attn_stage4_gpu13&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13236.96,-2277.67C13250.89,-2271.38 13266.17,-2265.63 13281,-2262.33 13320.21,-2253.63 14689.1,-2265.64 14727,-2252.33 14737.15,-2248.77 14735.89,-2241 14746,-2237.33 14776.62,-2226.23 15007.15,-2236.16 15039,-2229.33 15082.66,-2219.98 15129.41,-2199.22 15161.42,-2183.17"/>
<polygon fill="red" stroke="red" points="15163.12,-2186.23 15170.45,-2178.58 15159.95,-2179.99 15163.12,-2186.23"/>
<text text-anchor="middle" x="14777.5" y="-2241.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu14 -->
<g id="node1095" class="node">
<title>l4_attn_stage5_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="13769" cy="-2160.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13769" y="-2172.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="13769" y="-2157.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13769" y="-2142.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu14&#45;&gt;l4_attn_stage5_gpu14 -->
<g id="edge1727" class="edge">
<title>l4_attn_stage4_gpu14&#45;&gt;l4_attn_stage5_gpu14</title>
<path fill="none" stroke="black" d="M13769,-2270.24C13769,-2251.53 13769,-2228.53 13769,-2208.55"/>
<polygon fill="black" stroke="black" points="13772.5,-2208.41 13769,-2198.41 13765.5,-2208.41 13772.5,-2208.41"/>
</g>
<!-- l4_attn_stage4_gpu14&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge3039" class="edge">
<title>l4_attn_stage4_gpu14&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13821.97,-2277.69C13835.89,-2271.4 13851.17,-2265.64 13866,-2262.33 13926.68,-2248.79 14926.36,-2272.98 14985,-2252.33 14995.15,-2248.76 14994.3,-2241.98 15004,-2237.33 15018.39,-2230.44 15023.8,-2234.2 15039,-2229.33 15079.94,-2216.23 15124.95,-2197.07 15157.12,-2182.51"/>
<polygon fill="red" stroke="red" points="15158.61,-2185.68 15166.25,-2178.34 15155.7,-2179.31 15158.61,-2185.68"/>
<text text-anchor="middle" x="15035.5" y="-2241.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu15 -->
<g id="node1096" class="node">
<title>l4_attn_stage5_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="13379" cy="-2160.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13379" y="-2172.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="13379" y="-2157.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13379" y="-2142.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu15&#45;&gt;l4_attn_stage5_gpu15 -->
<g id="edge1728" class="edge">
<title>l4_attn_stage4_gpu15&#45;&gt;l4_attn_stage5_gpu15</title>
<path fill="none" stroke="black" d="M13379,-2270.24C13379,-2251.53 13379,-2228.53 13379,-2208.55"/>
<polygon fill="black" stroke="black" points="13382.5,-2208.41 13379,-2198.41 13375.5,-2208.41 13382.5,-2208.41"/>
</g>
<!-- l4_attn_stage4_gpu15&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge3040" class="edge">
<title>l4_attn_stage4_gpu15&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13431.96,-2277.68C13445.89,-2271.38 13461.17,-2265.63 13476,-2262.33 13548.51,-2246.21 14742.92,-2276.96 14813,-2252.33 14823.15,-2248.77 14821.91,-2241.06 14832,-2237.33 14875.19,-2221.4 14994.04,-2239.23 15039,-2229.33 15082.6,-2219.73 15129.37,-2199.01 15161.39,-2183.04"/>
<polygon fill="red" stroke="red" points="15163.08,-2186.1 15170.42,-2178.46 15159.92,-2179.86 15163.08,-2186.1"/>
<text text-anchor="middle" x="14863.5" y="-2241.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu0 -->
<g id="node1097" class="node">
<title>l4_attn_stage6_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="13574" cy="-2013.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13574" y="-2025.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="13574" y="-2010.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13574" y="-1995.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu0&#45;&gt;l4_attn_stage6_gpu0 -->
<g id="edge1729" class="edge">
<title>l4_attn_stage5_gpu0&#45;&gt;l4_attn_stage6_gpu0</title>
<path fill="none" stroke="black" d="M13574,-2123.24C13574,-2104.53 13574,-2081.53 13574,-2061.55"/>
<polygon fill="black" stroke="black" points="13577.5,-2061.41 13574,-2051.41 13570.5,-2061.41 13577.5,-2061.41"/>
</g>
<!-- l4_attn_stage6_gpu[next_gpu] -->
<g id="node1395" class="node">
<title>l4_attn_stage6_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="15201" cy="-2013.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="15201" y="-2010.13" font-family="Times,serif" font-size="14.00">l4_attn_stage6_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage5_gpu0&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge3041" class="edge">
<title>l4_attn_stage5_gpu0&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13626.97,-2130.68C13640.89,-2124.39 13656.17,-2118.64 13671,-2115.33 13737.59,-2100.5 14834.64,-2127.97 14899,-2105.33 14909.15,-2101.76 14907.96,-2094.2 14918,-2090.33 14968.3,-2070.99 14986.53,-2094.64 15039,-2082.33 15082.2,-2072.2 15128.67,-2051.75 15160.71,-2036.01"/>
<polygon fill="red" stroke="red" points="15162.38,-2039.09 15169.77,-2031.49 15159.25,-2032.82 15162.38,-2039.09"/>
<text text-anchor="middle" x="14949.5" y="-2094.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu1 -->
<g id="node1098" class="node">
<title>l4_attn_stage6_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14354" cy="-2013.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14354" y="-2025.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="14354" y="-2010.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14354" y="-1995.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu1&#45;&gt;l4_attn_stage6_gpu1 -->
<g id="edge1730" class="edge">
<title>l4_attn_stage5_gpu1&#45;&gt;l4_attn_stage6_gpu1</title>
<path fill="none" stroke="black" d="M14298.51,-2131.52C14284.88,-2125.44 14270.14,-2119.58 14256,-2115.33 14242.42,-2111.25 14202.2,-2116.11 14193,-2105.33 14158.44,-2064.85 14200.28,-2103.61 14256,-2082.33 14273.91,-2075.49 14291.72,-2064.74 14307.14,-2053.81"/>
<polygon fill="black" stroke="black" points="14309.44,-2056.47 14315.45,-2047.75 14305.31,-2050.82 14309.44,-2056.47"/>
</g>
<!-- l4_attn_stage5_gpu1&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge3042" class="edge">
<title>l4_attn_stage5_gpu1&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14406.98,-2130.73C14420.9,-2124.43 14436.18,-2118.67 14451,-2115.33 14472.46,-2110.5 15227.54,-2120.99 15243,-2105.33 15261.16,-2086.94 15243.89,-2059.25 15226.31,-2039.34"/>
<polygon fill="red" stroke="red" points="15228.75,-2036.82 15219.38,-2031.87 15223.61,-2041.58 15228.75,-2036.82"/>
<text text-anchor="middle" x="15282.5" y="-2094.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu2 -->
<g id="node1099" class="node">
<title>l4_attn_stage6_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="12404" cy="-2013.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12404" y="-2025.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="12404" y="-2010.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12404" y="-1995.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu2&#45;&gt;l4_attn_stage6_gpu2 -->
<g id="edge1731" class="edge">
<title>l4_attn_stage5_gpu2&#45;&gt;l4_attn_stage6_gpu2</title>
<path fill="none" stroke="black" d="M12404,-2123.24C12404,-2104.53 12404,-2081.53 12404,-2061.55"/>
<polygon fill="black" stroke="black" points="12407.5,-2061.41 12404,-2051.41 12400.5,-2061.41 12407.5,-2061.41"/>
</g>
<!-- l4_attn_stage5_gpu2&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge3043" class="edge">
<title>l4_attn_stage5_gpu2&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12456.96,-2130.65C12470.88,-2124.36 12486.17,-2118.61 12501,-2115.33 12552.04,-2104.04 14333.66,-2122.61 14383,-2105.33 14393.15,-2101.78 14391.86,-2093.93 14402,-2090.33 14435.36,-2078.52 15004.34,-2089.49 15039,-2082.33 15082.86,-2073.27 15129.76,-2052.36 15161.75,-2036.2"/>
<polygon fill="red" stroke="red" points="15163.48,-2039.25 15170.77,-2031.57 15160.28,-2033.02 15163.48,-2039.25"/>
<text text-anchor="middle" x="14433.5" y="-2094.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu3 -->
<g id="node1100" class="node">
<title>l4_attn_stage6_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14744" cy="-2013.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14744" y="-2025.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="14744" y="-2010.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14744" y="-1995.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu3&#45;&gt;l4_attn_stage6_gpu3 -->
<g id="edge1732" class="edge">
<title>l4_attn_stage5_gpu3&#45;&gt;l4_attn_stage6_gpu3</title>
<path fill="none" stroke="black" d="M14690.43,-2130.83C14676.36,-2124.54 14660.94,-2118.74 14646,-2115.33 14622.22,-2109.9 14224.05,-2122.78 14207,-2105.33 14202.34,-2100.57 14202.33,-2095.09 14207,-2090.33 14215.55,-2081.63 14634.39,-2086.06 14646,-2082.33 14664.59,-2076.36 14682.81,-2065.6 14698.4,-2054.4"/>
<polygon fill="black" stroke="black" points="14700.84,-2056.94 14706.77,-2048.16 14696.66,-2051.33 14700.84,-2056.94"/>
</g>
<!-- l4_attn_stage5_gpu3&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge3044" class="edge">
<title>l4_attn_stage5_gpu3&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14796.99,-2130.78C14810.91,-2124.48 14826.19,-2118.7 14841,-2115.33 14856.55,-2111.79 15403.82,-2116.71 15415,-2105.33 15455.03,-2064.6 15385.32,-2041.24 15315.01,-2028.49"/>
<polygon fill="red" stroke="red" points="15315.55,-2025.04 15305.1,-2026.77 15314.35,-2031.93 15315.55,-2025.04"/>
<text text-anchor="middle" x="15456.5" y="-2094.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu4 -->
<g id="node1101" class="node">
<title>l4_attn_stage6_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13964" cy="-2013.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13964" y="-2025.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="13964" y="-2010.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13964" y="-1995.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu4&#45;&gt;l4_attn_stage6_gpu4 -->
<g id="edge1733" class="edge">
<title>l4_attn_stage5_gpu4&#45;&gt;l4_attn_stage6_gpu4</title>
<path fill="none" stroke="black" d="M13964,-2123.24C13964,-2104.53 13964,-2081.53 13964,-2061.55"/>
<polygon fill="black" stroke="black" points="13967.5,-2061.41 13964,-2051.41 13960.5,-2061.41 13967.5,-2061.41"/>
</g>
<!-- l4_attn_stage5_gpu4&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge3045" class="edge">
<title>l4_attn_stage5_gpu4&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14016.97,-2130.7C14030.89,-2124.41 14046.17,-2118.65 14061,-2115.33 14115.76,-2103.09 15018.08,-2124 15071,-2105.33 15081.15,-2101.75 15081.32,-2096.7 15090,-2090.33 15115.22,-2071.84 15144.5,-2051.99 15166.65,-2037.29"/>
<polygon fill="red" stroke="red" points="15168.66,-2040.15 15175.07,-2031.72 15164.8,-2034.31 15168.66,-2040.15"/>
<text text-anchor="middle" x="15121.5" y="-2094.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu5 -->
<g id="node1102" class="node">
<title>l4_attn_stage6_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="12014" cy="-2013.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12014" y="-2025.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="12014" y="-2010.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12014" y="-1995.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu5&#45;&gt;l4_attn_stage6_gpu5 -->
<g id="edge1734" class="edge">
<title>l4_attn_stage5_gpu5&#45;&gt;l4_attn_stage6_gpu5</title>
<path fill="none" stroke="black" d="M12014,-2123.24C12014,-2104.53 12014,-2081.53 12014,-2061.55"/>
<polygon fill="black" stroke="black" points="12017.5,-2061.41 12014,-2051.41 12010.5,-2061.41 12017.5,-2061.41"/>
</g>
<!-- l4_attn_stage5_gpu5&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge3046" class="edge">
<title>l4_attn_stage5_gpu5&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12066.97,-2130.72C12080.9,-2124.43 12096.18,-2118.66 12111,-2115.33 12340.74,-2063.73 13994.55,-2092.89 14230,-2090.33 14274.94,-2089.85 14994.97,-2091.37 15039,-2082.33 15082.87,-2073.33 15129.77,-2052.41 15161.76,-2036.23"/>
<polygon fill="red" stroke="red" points="15163.49,-2039.28 15170.78,-2031.59 15160.28,-2033.05 15163.49,-2039.28"/>
<text text-anchor="middle" x="14261.5" y="-2094.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu6 -->
<g id="node1103" class="node">
<title>l4_attn_stage6_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14549" cy="-2013.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14549" y="-2025.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="14549" y="-2010.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14549" y="-1995.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu6&#45;&gt;l4_attn_stage6_gpu6 -->
<g id="edge1735" class="edge">
<title>l4_attn_stage5_gpu6&#45;&gt;l4_attn_stage6_gpu6</title>
<path fill="none" stroke="black" d="M14495.13,-2130.89C14481.13,-2124.64 14465.82,-2118.85 14451,-2115.33 14437.42,-2112.11 14209.67,-2115.4 14200,-2105.33 14195.38,-2100.53 14195.36,-2095.12 14200,-2090.33 14209.71,-2080.31 14437.75,-2086.69 14451,-2082.33 14469.55,-2076.24 14487.76,-2065.44 14503.35,-2054.25"/>
<polygon fill="black" stroke="black" points="14505.79,-2056.8 14511.73,-2048.02 14501.61,-2051.18 14505.79,-2056.8"/>
</g>
<!-- l4_attn_stage5_gpu6&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge3047" class="edge">
<title>l4_attn_stage5_gpu6&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14601.98,-2130.75C14615.9,-2124.45 14631.18,-2118.68 14646,-2115.33 14664.51,-2111.15 15315.68,-2118.85 15329,-2105.33 15357.36,-2076.56 15309.79,-2050.73 15264.82,-2034.1"/>
<polygon fill="red" stroke="red" points="15265.88,-2030.76 15255.29,-2030.69 15263.53,-2037.35 15265.88,-2030.76"/>
<text text-anchor="middle" x="15369.5" y="-2094.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu7 -->
<g id="node1104" class="node">
<title>l4_attn_stage6_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14159" cy="-2013.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14159" y="-2025.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="14159" y="-2010.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14159" y="-1995.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu7&#45;&gt;l4_attn_stage6_gpu7 -->
<g id="edge1736" class="edge">
<title>l4_attn_stage5_gpu7&#45;&gt;l4_attn_stage6_gpu7</title>
<path fill="none" stroke="black" d="M14159,-2123.24C14159,-2104.53 14159,-2081.53 14159,-2061.55"/>
<polygon fill="black" stroke="black" points="14162.5,-2061.41 14159,-2051.41 14155.5,-2061.41 14162.5,-2061.41"/>
</g>
<!-- l4_attn_stage5_gpu7&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge3048" class="edge">
<title>l4_attn_stage5_gpu7&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14211.97,-2130.71C14225.9,-2124.42 14241.18,-2118.66 14256,-2115.33 14280.42,-2109.86 15135.86,-2118.73 15157,-2105.33 15178.94,-2091.43 15190.24,-2063.16 15195.85,-2041.89"/>
<polygon fill="red" stroke="red" points="15199.27,-2042.64 15198.18,-2032.1 15192.46,-2041.02 15199.27,-2042.64"/>
<text text-anchor="middle" x="15204.5" y="-2094.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu8 -->
<g id="node1105" class="node">
<title>l4_attn_stage6_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="12794" cy="-2013.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12794" y="-2025.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="12794" y="-2010.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12794" y="-1995.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu8&#45;&gt;l4_attn_stage6_gpu8 -->
<g id="edge1737" class="edge">
<title>l4_attn_stage5_gpu8&#45;&gt;l4_attn_stage6_gpu8</title>
<path fill="none" stroke="black" d="M12794,-2123.24C12794,-2104.53 12794,-2081.53 12794,-2061.55"/>
<polygon fill="black" stroke="black" points="12797.5,-2061.41 12794,-2051.41 12790.5,-2061.41 12797.5,-2061.41"/>
</g>
<!-- l4_attn_stage5_gpu8&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge3049" class="edge">
<title>l4_attn_stage5_gpu8&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12846.96,-2130.66C12860.88,-2124.37 12876.17,-2118.62 12891,-2115.33 12936.13,-2105.33 14511.38,-2120.62 14555,-2105.33 14565.15,-2101.77 14563.87,-2093.95 14574,-2090.33 14622.67,-2072.97 14988.42,-2092.9 15039,-2082.33 15082.84,-2073.17 15129.74,-2052.28 15161.74,-2036.14"/>
<polygon fill="red" stroke="red" points="15163.46,-2039.2 15170.76,-2031.52 15160.27,-2032.97 15163.46,-2039.2"/>
<text text-anchor="middle" x="14605.5" y="-2094.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu9 -->
<g id="node1106" class="node">
<title>l4_attn_stage6_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="12989" cy="-2013.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12989" y="-2025.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="12989" y="-2010.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12989" y="-1995.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu9&#45;&gt;l4_attn_stage6_gpu9 -->
<g id="edge1738" class="edge">
<title>l4_attn_stage5_gpu9&#45;&gt;l4_attn_stage6_gpu9</title>
<path fill="none" stroke="black" d="M12989,-2123.24C12989,-2104.53 12989,-2081.53 12989,-2061.55"/>
<polygon fill="black" stroke="black" points="12992.5,-2061.41 12989,-2051.41 12985.5,-2061.41 12992.5,-2061.41"/>
</g>
<!-- l4_attn_stage5_gpu9&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge3050" class="edge">
<title>l4_attn_stage5_gpu9&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13041.96,-2130.66C13055.89,-2124.37 13071.17,-2118.62 13086,-2115.33 13128.17,-2105.98 14600.24,-2119.63 14641,-2105.33 14651.15,-2101.77 14649.87,-2093.97 14660,-2090.33 14699.64,-2076.1 14997.79,-2091.03 15039,-2082.33 15082.82,-2073.09 15129.73,-2052.2 15161.73,-2036.1"/>
<polygon fill="red" stroke="red" points="15163.45,-2039.15 15170.75,-2031.48 15160.26,-2032.92 15163.45,-2039.15"/>
<text text-anchor="middle" x="14691.5" y="-2094.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu10 -->
<g id="node1107" class="node">
<title>l4_attn_stage6_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12209" cy="-2013.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12209" y="-2025.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="12209" y="-2010.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12209" y="-1995.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu10&#45;&gt;l4_attn_stage6_gpu10 -->
<g id="edge1739" class="edge">
<title>l4_attn_stage5_gpu10&#45;&gt;l4_attn_stage6_gpu10</title>
<path fill="none" stroke="black" d="M12209,-2123.24C12209,-2104.53 12209,-2081.53 12209,-2061.55"/>
<polygon fill="black" stroke="black" points="12212.5,-2061.41 12209,-2051.41 12205.5,-2061.41 12212.5,-2061.41"/>
</g>
<!-- l4_attn_stage5_gpu10&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge3051" class="edge">
<title>l4_attn_stage5_gpu10&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12261.96,-2130.65C12275.88,-2124.36 12291.17,-2118.61 12306,-2115.33 12360,-2103.39 14244.8,-2123.6 14297,-2105.33 14307.15,-2101.78 14305.86,-2093.92 14316,-2090.33 14353.87,-2076.95 14999.66,-2090.43 15039,-2082.33 15082.87,-2073.31 15129.77,-2052.39 15161.76,-2036.22"/>
<polygon fill="red" stroke="red" points="15163.48,-2039.27 15170.78,-2031.58 15160.28,-2033.04 15163.48,-2039.27"/>
<text text-anchor="middle" x="14347.5" y="-2094.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu11 -->
<g id="node1108" class="node">
<title>l4_attn_stage6_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="12599" cy="-2013.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12599" y="-2025.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="12599" y="-2010.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12599" y="-1995.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu11&#45;&gt;l4_attn_stage6_gpu11 -->
<g id="edge1740" class="edge">
<title>l4_attn_stage5_gpu11&#45;&gt;l4_attn_stage6_gpu11</title>
<path fill="none" stroke="black" d="M12599,-2123.24C12599,-2104.53 12599,-2081.53 12599,-2061.55"/>
<polygon fill="black" stroke="black" points="12602.5,-2061.41 12599,-2051.41 12595.5,-2061.41 12602.5,-2061.41"/>
</g>
<!-- l4_attn_stage5_gpu11&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge3052" class="edge">
<title>l4_attn_stage5_gpu11&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12651.96,-2130.66C12665.88,-2124.36 12681.17,-2118.62 12696,-2115.33 12744.09,-2104.69 14422.52,-2121.62 14469,-2105.33 14479.15,-2101.78 14477.86,-2093.94 14488,-2090.33 14516.85,-2080.08 15009.02,-2088.55 15039,-2082.33 15082.85,-2073.23 15129.75,-2052.33 15161.75,-2036.18"/>
<polygon fill="red" stroke="red" points="15163.47,-2039.23 15170.77,-2031.55 15160.27,-2033 15163.47,-2039.23"/>
<text text-anchor="middle" x="14519.5" y="-2094.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu12 -->
<g id="node1109" class="node">
<title>l4_attn_stage6_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14939" cy="-2013.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14939" y="-2025.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="14939" y="-2010.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14939" y="-1995.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu12&#45;&gt;l4_attn_stage6_gpu12 -->
<g id="edge1741" class="edge">
<title>l4_attn_stage5_gpu12&#45;&gt;l4_attn_stage6_gpu12</title>
<path fill="none" stroke="black" d="M14885.7,-2130.88C14871.56,-2124.54 14856.04,-2118.71 14841,-2115.33 14824.01,-2111.51 14226.22,-2117.75 14214,-2105.33 14209.32,-2100.58 14209.32,-2095.08 14214,-2090.33 14226.24,-2077.94 14824.4,-2087.61 14841,-2082.33 14859.6,-2076.42 14877.83,-2065.67 14893.42,-2054.46"/>
<polygon fill="black" stroke="black" points="14895.87,-2057 14901.79,-2048.22 14891.68,-2051.39 14895.87,-2057"/>
</g>
<!-- l4_attn_stage5_gpu12&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge3053" class="edge">
<title>l4_attn_stage5_gpu12&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14994.09,-2131.4C15009.23,-2124.88 15025.92,-2118.84 15042,-2115.33 15066.92,-2109.9 15483.16,-2123.56 15501,-2105.33 15555.67,-2049.46 15454.45,-2027.8 15355.12,-2019.54"/>
<polygon fill="red" stroke="red" points="15355.15,-2016.03 15344.9,-2018.74 15354.6,-2023.01 15355.15,-2016.03"/>
<text text-anchor="middle" x="15542.5" y="-2094.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu13 -->
<g id="node1110" class="node">
<title>l4_attn_stage6_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13184" cy="-2013.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13184" y="-2025.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="13184" y="-2010.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13184" y="-1995.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu13&#45;&gt;l4_attn_stage6_gpu13 -->
<g id="edge1742" class="edge">
<title>l4_attn_stage5_gpu13&#45;&gt;l4_attn_stage6_gpu13</title>
<path fill="none" stroke="black" d="M13184,-2123.24C13184,-2104.53 13184,-2081.53 13184,-2061.55"/>
<polygon fill="black" stroke="black" points="13187.5,-2061.41 13184,-2051.41 13180.5,-2061.41 13187.5,-2061.41"/>
</g>
<!-- l4_attn_stage5_gpu13&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge3054" class="edge">
<title>l4_attn_stage5_gpu13&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13236.96,-2130.67C13250.89,-2124.38 13266.17,-2118.63 13281,-2115.33 13320.21,-2106.63 14689.1,-2118.64 14727,-2105.33 14737.15,-2101.77 14735.89,-2094 14746,-2090.33 14776.62,-2079.23 15007.15,-2089.16 15039,-2082.33 15082.66,-2072.98 15129.41,-2052.22 15161.42,-2036.17"/>
<polygon fill="red" stroke="red" points="15163.12,-2039.23 15170.45,-2031.58 15159.95,-2032.99 15163.12,-2039.23"/>
<text text-anchor="middle" x="14777.5" y="-2094.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu14 -->
<g id="node1111" class="node">
<title>l4_attn_stage6_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="13769" cy="-2013.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13769" y="-2025.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="13769" y="-2010.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13769" y="-1995.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu14&#45;&gt;l4_attn_stage6_gpu14 -->
<g id="edge1743" class="edge">
<title>l4_attn_stage5_gpu14&#45;&gt;l4_attn_stage6_gpu14</title>
<path fill="none" stroke="black" d="M13769,-2123.24C13769,-2104.53 13769,-2081.53 13769,-2061.55"/>
<polygon fill="black" stroke="black" points="13772.5,-2061.41 13769,-2051.41 13765.5,-2061.41 13772.5,-2061.41"/>
</g>
<!-- l4_attn_stage5_gpu14&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge3055" class="edge">
<title>l4_attn_stage5_gpu14&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13821.97,-2130.69C13835.89,-2124.4 13851.17,-2118.64 13866,-2115.33 13926.68,-2101.79 14926.36,-2125.98 14985,-2105.33 14995.15,-2101.76 14994.3,-2094.98 15004,-2090.33 15018.39,-2083.44 15023.8,-2087.2 15039,-2082.33 15079.94,-2069.23 15124.95,-2050.07 15157.12,-2035.51"/>
<polygon fill="red" stroke="red" points="15158.61,-2038.68 15166.25,-2031.34 15155.7,-2032.31 15158.61,-2038.68"/>
<text text-anchor="middle" x="15035.5" y="-2094.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu15 -->
<g id="node1112" class="node">
<title>l4_attn_stage6_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="13379" cy="-2013.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13379" y="-2025.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="13379" y="-2010.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13379" y="-1995.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu15&#45;&gt;l4_attn_stage6_gpu15 -->
<g id="edge1744" class="edge">
<title>l4_attn_stage5_gpu15&#45;&gt;l4_attn_stage6_gpu15</title>
<path fill="none" stroke="black" d="M13379,-2123.24C13379,-2104.53 13379,-2081.53 13379,-2061.55"/>
<polygon fill="black" stroke="black" points="13382.5,-2061.41 13379,-2051.41 13375.5,-2061.41 13382.5,-2061.41"/>
</g>
<!-- l4_attn_stage5_gpu15&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge3056" class="edge">
<title>l4_attn_stage5_gpu15&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13431.96,-2130.68C13445.89,-2124.38 13461.17,-2118.63 13476,-2115.33 13548.51,-2099.21 14742.92,-2129.96 14813,-2105.33 14823.15,-2101.77 14821.91,-2094.06 14832,-2090.33 14875.19,-2074.4 14994.04,-2092.23 15039,-2082.33 15082.6,-2072.73 15129.37,-2052.01 15161.39,-2036.04"/>
<polygon fill="red" stroke="red" points="15163.08,-2039.1 15170.42,-2031.46 15159.92,-2032.86 15163.08,-2039.1"/>
<text text-anchor="middle" x="14863.5" y="-2094.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu0 -->
<g id="node1113" class="node">
<title>l4_attn_stage7_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="13574" cy="-1866.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13574" y="-1878.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="13574" y="-1863.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13574" y="-1848.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu0&#45;&gt;l4_attn_stage7_gpu0 -->
<g id="edge1745" class="edge">
<title>l4_attn_stage6_gpu0&#45;&gt;l4_attn_stage7_gpu0</title>
<path fill="none" stroke="black" d="M13574,-1976.24C13574,-1957.53 13574,-1934.53 13574,-1914.55"/>
<polygon fill="black" stroke="black" points="13577.5,-1914.41 13574,-1904.41 13570.5,-1914.41 13577.5,-1914.41"/>
</g>
<!-- l4_attn_stage7_gpu[next_gpu] -->
<g id="node1396" class="node">
<title>l4_attn_stage7_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="15201" cy="-1866.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="15201" y="-1863.13" font-family="Times,serif" font-size="14.00">l4_attn_stage7_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage6_gpu0&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge3057" class="edge">
<title>l4_attn_stage6_gpu0&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13626.97,-1983.68C13640.89,-1977.39 13656.17,-1971.64 13671,-1968.33 13737.59,-1953.5 14834.64,-1980.97 14899,-1958.33 14909.15,-1954.76 14907.96,-1947.2 14918,-1943.33 14968.3,-1923.99 14986.53,-1947.64 15039,-1935.33 15082.2,-1925.2 15128.67,-1904.75 15160.71,-1889.01"/>
<polygon fill="red" stroke="red" points="15162.38,-1892.09 15169.77,-1884.49 15159.25,-1885.82 15162.38,-1892.09"/>
<text text-anchor="middle" x="14949.5" y="-1947.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu1 -->
<g id="node1114" class="node">
<title>l4_attn_stage7_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14354" cy="-1866.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14354" y="-1878.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="14354" y="-1863.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14354" y="-1848.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu1&#45;&gt;l4_attn_stage7_gpu1 -->
<g id="edge1746" class="edge">
<title>l4_attn_stage6_gpu1&#45;&gt;l4_attn_stage7_gpu1</title>
<path fill="none" stroke="black" d="M14298.51,-1984.52C14284.88,-1978.44 14270.14,-1972.58 14256,-1968.33 14242.42,-1964.25 14202.2,-1969.11 14193,-1958.33 14158.44,-1917.85 14200.28,-1956.61 14256,-1935.33 14273.91,-1928.49 14291.72,-1917.74 14307.14,-1906.81"/>
<polygon fill="black" stroke="black" points="14309.44,-1909.47 14315.45,-1900.75 14305.31,-1903.82 14309.44,-1909.47"/>
</g>
<!-- l4_attn_stage6_gpu1&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge3058" class="edge">
<title>l4_attn_stage6_gpu1&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14406.98,-1983.73C14420.9,-1977.43 14436.18,-1971.67 14451,-1968.33 14472.46,-1963.5 15227.54,-1973.99 15243,-1958.33 15261.16,-1939.94 15243.89,-1912.25 15226.31,-1892.34"/>
<polygon fill="red" stroke="red" points="15228.75,-1889.82 15219.38,-1884.87 15223.61,-1894.58 15228.75,-1889.82"/>
<text text-anchor="middle" x="15282.5" y="-1947.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu2 -->
<g id="node1115" class="node">
<title>l4_attn_stage7_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="12404" cy="-1866.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12404" y="-1878.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="12404" y="-1863.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12404" y="-1848.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu2&#45;&gt;l4_attn_stage7_gpu2 -->
<g id="edge1747" class="edge">
<title>l4_attn_stage6_gpu2&#45;&gt;l4_attn_stage7_gpu2</title>
<path fill="none" stroke="black" d="M12404,-1976.24C12404,-1957.53 12404,-1934.53 12404,-1914.55"/>
<polygon fill="black" stroke="black" points="12407.5,-1914.41 12404,-1904.41 12400.5,-1914.41 12407.5,-1914.41"/>
</g>
<!-- l4_attn_stage6_gpu2&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge3059" class="edge">
<title>l4_attn_stage6_gpu2&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12456.96,-1983.65C12470.88,-1977.36 12486.17,-1971.61 12501,-1968.33 12552.04,-1957.04 14333.66,-1975.61 14383,-1958.33 14393.15,-1954.78 14391.86,-1946.93 14402,-1943.33 14435.36,-1931.52 15004.34,-1942.49 15039,-1935.33 15082.86,-1926.27 15129.76,-1905.36 15161.75,-1889.2"/>
<polygon fill="red" stroke="red" points="15163.48,-1892.25 15170.77,-1884.57 15160.28,-1886.02 15163.48,-1892.25"/>
<text text-anchor="middle" x="14433.5" y="-1947.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu3 -->
<g id="node1116" class="node">
<title>l4_attn_stage7_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14744" cy="-1866.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14744" y="-1878.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="14744" y="-1863.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14744" y="-1848.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu3&#45;&gt;l4_attn_stage7_gpu3 -->
<g id="edge1748" class="edge">
<title>l4_attn_stage6_gpu3&#45;&gt;l4_attn_stage7_gpu3</title>
<path fill="none" stroke="black" d="M14690.43,-1983.83C14676.36,-1977.54 14660.94,-1971.74 14646,-1968.33 14622.22,-1962.9 14224.05,-1975.78 14207,-1958.33 14202.34,-1953.57 14202.33,-1948.09 14207,-1943.33 14215.55,-1934.63 14634.39,-1939.06 14646,-1935.33 14664.59,-1929.36 14682.81,-1918.6 14698.4,-1907.4"/>
<polygon fill="black" stroke="black" points="14700.84,-1909.94 14706.77,-1901.16 14696.66,-1904.33 14700.84,-1909.94"/>
</g>
<!-- l4_attn_stage6_gpu3&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge3060" class="edge">
<title>l4_attn_stage6_gpu3&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14796.99,-1983.78C14810.91,-1977.48 14826.19,-1971.7 14841,-1968.33 14856.55,-1964.79 15403.82,-1969.71 15415,-1958.33 15455.03,-1917.6 15385.32,-1894.24 15315.01,-1881.49"/>
<polygon fill="red" stroke="red" points="15315.55,-1878.04 15305.1,-1879.77 15314.35,-1884.93 15315.55,-1878.04"/>
<text text-anchor="middle" x="15456.5" y="-1947.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu4 -->
<g id="node1117" class="node">
<title>l4_attn_stage7_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13964" cy="-1866.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13964" y="-1878.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="13964" y="-1863.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13964" y="-1848.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu4&#45;&gt;l4_attn_stage7_gpu4 -->
<g id="edge1749" class="edge">
<title>l4_attn_stage6_gpu4&#45;&gt;l4_attn_stage7_gpu4</title>
<path fill="none" stroke="black" d="M13964,-1976.24C13964,-1957.53 13964,-1934.53 13964,-1914.55"/>
<polygon fill="black" stroke="black" points="13967.5,-1914.41 13964,-1904.41 13960.5,-1914.41 13967.5,-1914.41"/>
</g>
<!-- l4_attn_stage6_gpu4&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge3061" class="edge">
<title>l4_attn_stage6_gpu4&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14016.97,-1983.7C14030.89,-1977.41 14046.17,-1971.65 14061,-1968.33 14115.76,-1956.09 15018.08,-1977 15071,-1958.33 15081.15,-1954.75 15081.32,-1949.7 15090,-1943.33 15115.22,-1924.84 15144.5,-1904.99 15166.65,-1890.29"/>
<polygon fill="red" stroke="red" points="15168.66,-1893.15 15175.07,-1884.72 15164.8,-1887.31 15168.66,-1893.15"/>
<text text-anchor="middle" x="15121.5" y="-1947.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu5 -->
<g id="node1118" class="node">
<title>l4_attn_stage7_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="12014" cy="-1866.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12014" y="-1878.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="12014" y="-1863.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12014" y="-1848.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu5&#45;&gt;l4_attn_stage7_gpu5 -->
<g id="edge1750" class="edge">
<title>l4_attn_stage6_gpu5&#45;&gt;l4_attn_stage7_gpu5</title>
<path fill="none" stroke="black" d="M12014,-1976.24C12014,-1957.53 12014,-1934.53 12014,-1914.55"/>
<polygon fill="black" stroke="black" points="12017.5,-1914.41 12014,-1904.41 12010.5,-1914.41 12017.5,-1914.41"/>
</g>
<!-- l4_attn_stage6_gpu5&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge3062" class="edge">
<title>l4_attn_stage6_gpu5&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12066.97,-1983.72C12080.9,-1977.43 12096.18,-1971.66 12111,-1968.33 12340.74,-1916.73 13994.55,-1945.89 14230,-1943.33 14274.94,-1942.85 14994.97,-1944.37 15039,-1935.33 15082.87,-1926.33 15129.77,-1905.41 15161.76,-1889.23"/>
<polygon fill="red" stroke="red" points="15163.49,-1892.28 15170.78,-1884.59 15160.28,-1886.05 15163.49,-1892.28"/>
<text text-anchor="middle" x="14261.5" y="-1947.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu6 -->
<g id="node1119" class="node">
<title>l4_attn_stage7_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14549" cy="-1866.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14549" y="-1878.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="14549" y="-1863.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14549" y="-1848.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu6&#45;&gt;l4_attn_stage7_gpu6 -->
<g id="edge1751" class="edge">
<title>l4_attn_stage6_gpu6&#45;&gt;l4_attn_stage7_gpu6</title>
<path fill="none" stroke="black" d="M14495.13,-1983.89C14481.13,-1977.64 14465.82,-1971.85 14451,-1968.33 14437.42,-1965.11 14209.67,-1968.4 14200,-1958.33 14195.38,-1953.53 14195.36,-1948.12 14200,-1943.33 14209.71,-1933.31 14437.75,-1939.69 14451,-1935.33 14469.55,-1929.24 14487.76,-1918.44 14503.35,-1907.25"/>
<polygon fill="black" stroke="black" points="14505.79,-1909.8 14511.73,-1901.02 14501.61,-1904.18 14505.79,-1909.8"/>
</g>
<!-- l4_attn_stage6_gpu6&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge3063" class="edge">
<title>l4_attn_stage6_gpu6&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14601.98,-1983.75C14615.9,-1977.45 14631.18,-1971.68 14646,-1968.33 14664.51,-1964.15 15315.68,-1971.85 15329,-1958.33 15357.36,-1929.56 15309.79,-1903.73 15264.82,-1887.1"/>
<polygon fill="red" stroke="red" points="15265.88,-1883.76 15255.29,-1883.69 15263.53,-1890.35 15265.88,-1883.76"/>
<text text-anchor="middle" x="15369.5" y="-1947.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu7 -->
<g id="node1120" class="node">
<title>l4_attn_stage7_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14159" cy="-1866.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14159" y="-1878.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="14159" y="-1863.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14159" y="-1848.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu7&#45;&gt;l4_attn_stage7_gpu7 -->
<g id="edge1752" class="edge">
<title>l4_attn_stage6_gpu7&#45;&gt;l4_attn_stage7_gpu7</title>
<path fill="none" stroke="black" d="M14159,-1976.24C14159,-1957.53 14159,-1934.53 14159,-1914.55"/>
<polygon fill="black" stroke="black" points="14162.5,-1914.41 14159,-1904.41 14155.5,-1914.41 14162.5,-1914.41"/>
</g>
<!-- l4_attn_stage6_gpu7&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge3064" class="edge">
<title>l4_attn_stage6_gpu7&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14211.97,-1983.71C14225.9,-1977.42 14241.18,-1971.66 14256,-1968.33 14280.42,-1962.86 15135.86,-1971.73 15157,-1958.33 15178.94,-1944.43 15190.24,-1916.16 15195.85,-1894.89"/>
<polygon fill="red" stroke="red" points="15199.27,-1895.64 15198.18,-1885.1 15192.46,-1894.02 15199.27,-1895.64"/>
<text text-anchor="middle" x="15204.5" y="-1947.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu8 -->
<g id="node1121" class="node">
<title>l4_attn_stage7_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="12794" cy="-1866.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12794" y="-1878.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="12794" y="-1863.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12794" y="-1848.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu8&#45;&gt;l4_attn_stage7_gpu8 -->
<g id="edge1753" class="edge">
<title>l4_attn_stage6_gpu8&#45;&gt;l4_attn_stage7_gpu8</title>
<path fill="none" stroke="black" d="M12794,-1976.24C12794,-1957.53 12794,-1934.53 12794,-1914.55"/>
<polygon fill="black" stroke="black" points="12797.5,-1914.41 12794,-1904.41 12790.5,-1914.41 12797.5,-1914.41"/>
</g>
<!-- l4_attn_stage6_gpu8&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge3065" class="edge">
<title>l4_attn_stage6_gpu8&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12846.96,-1983.66C12860.88,-1977.37 12876.17,-1971.62 12891,-1968.33 12936.13,-1958.33 14511.38,-1973.62 14555,-1958.33 14565.15,-1954.77 14563.87,-1946.95 14574,-1943.33 14622.67,-1925.97 14988.42,-1945.9 15039,-1935.33 15082.84,-1926.17 15129.74,-1905.28 15161.74,-1889.14"/>
<polygon fill="red" stroke="red" points="15163.46,-1892.2 15170.76,-1884.52 15160.27,-1885.97 15163.46,-1892.2"/>
<text text-anchor="middle" x="14605.5" y="-1947.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu9 -->
<g id="node1122" class="node">
<title>l4_attn_stage7_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="12989" cy="-1866.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12989" y="-1878.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="12989" y="-1863.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12989" y="-1848.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu9&#45;&gt;l4_attn_stage7_gpu9 -->
<g id="edge1754" class="edge">
<title>l4_attn_stage6_gpu9&#45;&gt;l4_attn_stage7_gpu9</title>
<path fill="none" stroke="black" d="M12989,-1976.24C12989,-1957.53 12989,-1934.53 12989,-1914.55"/>
<polygon fill="black" stroke="black" points="12992.5,-1914.41 12989,-1904.41 12985.5,-1914.41 12992.5,-1914.41"/>
</g>
<!-- l4_attn_stage6_gpu9&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge3066" class="edge">
<title>l4_attn_stage6_gpu9&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13041.96,-1983.66C13055.89,-1977.37 13071.17,-1971.62 13086,-1968.33 13128.17,-1958.98 14600.24,-1972.63 14641,-1958.33 14651.15,-1954.77 14649.87,-1946.97 14660,-1943.33 14699.64,-1929.1 14997.79,-1944.03 15039,-1935.33 15082.82,-1926.09 15129.73,-1905.2 15161.73,-1889.1"/>
<polygon fill="red" stroke="red" points="15163.45,-1892.15 15170.75,-1884.48 15160.26,-1885.92 15163.45,-1892.15"/>
<text text-anchor="middle" x="14691.5" y="-1947.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu10 -->
<g id="node1123" class="node">
<title>l4_attn_stage7_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12209" cy="-1866.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12209" y="-1878.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="12209" y="-1863.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12209" y="-1848.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu10&#45;&gt;l4_attn_stage7_gpu10 -->
<g id="edge1755" class="edge">
<title>l4_attn_stage6_gpu10&#45;&gt;l4_attn_stage7_gpu10</title>
<path fill="none" stroke="black" d="M12209,-1976.24C12209,-1957.53 12209,-1934.53 12209,-1914.55"/>
<polygon fill="black" stroke="black" points="12212.5,-1914.41 12209,-1904.41 12205.5,-1914.41 12212.5,-1914.41"/>
</g>
<!-- l4_attn_stage6_gpu10&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge3067" class="edge">
<title>l4_attn_stage6_gpu10&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12261.96,-1983.65C12275.88,-1977.36 12291.17,-1971.61 12306,-1968.33 12360,-1956.39 14244.8,-1976.6 14297,-1958.33 14307.15,-1954.78 14305.86,-1946.92 14316,-1943.33 14353.87,-1929.95 14999.66,-1943.43 15039,-1935.33 15082.87,-1926.31 15129.77,-1905.39 15161.76,-1889.22"/>
<polygon fill="red" stroke="red" points="15163.48,-1892.27 15170.78,-1884.58 15160.28,-1886.04 15163.48,-1892.27"/>
<text text-anchor="middle" x="14347.5" y="-1947.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu11 -->
<g id="node1124" class="node">
<title>l4_attn_stage7_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="12599" cy="-1866.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12599" y="-1878.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="12599" y="-1863.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12599" y="-1848.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu11&#45;&gt;l4_attn_stage7_gpu11 -->
<g id="edge1756" class="edge">
<title>l4_attn_stage6_gpu11&#45;&gt;l4_attn_stage7_gpu11</title>
<path fill="none" stroke="black" d="M12599,-1976.24C12599,-1957.53 12599,-1934.53 12599,-1914.55"/>
<polygon fill="black" stroke="black" points="12602.5,-1914.41 12599,-1904.41 12595.5,-1914.41 12602.5,-1914.41"/>
</g>
<!-- l4_attn_stage6_gpu11&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge3068" class="edge">
<title>l4_attn_stage6_gpu11&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12651.96,-1983.66C12665.88,-1977.36 12681.17,-1971.62 12696,-1968.33 12744.09,-1957.69 14422.52,-1974.62 14469,-1958.33 14479.15,-1954.78 14477.86,-1946.94 14488,-1943.33 14516.85,-1933.08 15009.02,-1941.55 15039,-1935.33 15082.85,-1926.23 15129.75,-1905.33 15161.75,-1889.18"/>
<polygon fill="red" stroke="red" points="15163.47,-1892.23 15170.77,-1884.55 15160.27,-1886 15163.47,-1892.23"/>
<text text-anchor="middle" x="14519.5" y="-1947.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu12 -->
<g id="node1125" class="node">
<title>l4_attn_stage7_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14939" cy="-1866.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14939" y="-1878.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="14939" y="-1863.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14939" y="-1848.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu12&#45;&gt;l4_attn_stage7_gpu12 -->
<g id="edge1757" class="edge">
<title>l4_attn_stage6_gpu12&#45;&gt;l4_attn_stage7_gpu12</title>
<path fill="none" stroke="black" d="M14885.7,-1983.88C14871.56,-1977.54 14856.04,-1971.71 14841,-1968.33 14824.01,-1964.51 14226.22,-1970.75 14214,-1958.33 14209.32,-1953.58 14209.32,-1948.08 14214,-1943.33 14226.24,-1930.94 14824.4,-1940.61 14841,-1935.33 14859.6,-1929.42 14877.83,-1918.67 14893.42,-1907.46"/>
<polygon fill="black" stroke="black" points="14895.87,-1910 14901.79,-1901.22 14891.68,-1904.39 14895.87,-1910"/>
</g>
<!-- l4_attn_stage6_gpu12&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge3069" class="edge">
<title>l4_attn_stage6_gpu12&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14994.09,-1984.4C15009.23,-1977.88 15025.92,-1971.84 15042,-1968.33 15066.92,-1962.9 15483.16,-1976.56 15501,-1958.33 15555.67,-1902.46 15454.45,-1880.8 15355.12,-1872.54"/>
<polygon fill="red" stroke="red" points="15355.15,-1869.03 15344.9,-1871.74 15354.6,-1876.01 15355.15,-1869.03"/>
<text text-anchor="middle" x="15542.5" y="-1947.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu13 -->
<g id="node1126" class="node">
<title>l4_attn_stage7_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13184" cy="-1866.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13184" y="-1878.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="13184" y="-1863.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13184" y="-1848.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu13&#45;&gt;l4_attn_stage7_gpu13 -->
<g id="edge1758" class="edge">
<title>l4_attn_stage6_gpu13&#45;&gt;l4_attn_stage7_gpu13</title>
<path fill="none" stroke="black" d="M13184,-1976.24C13184,-1957.53 13184,-1934.53 13184,-1914.55"/>
<polygon fill="black" stroke="black" points="13187.5,-1914.41 13184,-1904.41 13180.5,-1914.41 13187.5,-1914.41"/>
</g>
<!-- l4_attn_stage6_gpu13&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge3070" class="edge">
<title>l4_attn_stage6_gpu13&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13236.96,-1983.67C13250.89,-1977.38 13266.17,-1971.63 13281,-1968.33 13320.21,-1959.63 14689.1,-1971.64 14727,-1958.33 14737.15,-1954.77 14735.89,-1947 14746,-1943.33 14776.62,-1932.23 15007.15,-1942.16 15039,-1935.33 15082.66,-1925.98 15129.41,-1905.22 15161.42,-1889.17"/>
<polygon fill="red" stroke="red" points="15163.12,-1892.23 15170.45,-1884.58 15159.95,-1885.99 15163.12,-1892.23"/>
<text text-anchor="middle" x="14777.5" y="-1947.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu14 -->
<g id="node1127" class="node">
<title>l4_attn_stage7_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="13769" cy="-1866.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13769" y="-1878.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="13769" y="-1863.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13769" y="-1848.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu14&#45;&gt;l4_attn_stage7_gpu14 -->
<g id="edge1759" class="edge">
<title>l4_attn_stage6_gpu14&#45;&gt;l4_attn_stage7_gpu14</title>
<path fill="none" stroke="black" d="M13769,-1976.24C13769,-1957.53 13769,-1934.53 13769,-1914.55"/>
<polygon fill="black" stroke="black" points="13772.5,-1914.41 13769,-1904.41 13765.5,-1914.41 13772.5,-1914.41"/>
</g>
<!-- l4_attn_stage6_gpu14&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge3071" class="edge">
<title>l4_attn_stage6_gpu14&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13821.97,-1983.69C13835.89,-1977.4 13851.17,-1971.64 13866,-1968.33 13926.68,-1954.79 14926.36,-1978.98 14985,-1958.33 14995.15,-1954.76 14994.3,-1947.98 15004,-1943.33 15018.39,-1936.44 15023.8,-1940.2 15039,-1935.33 15079.94,-1922.23 15124.95,-1903.07 15157.12,-1888.51"/>
<polygon fill="red" stroke="red" points="15158.61,-1891.68 15166.25,-1884.34 15155.7,-1885.31 15158.61,-1891.68"/>
<text text-anchor="middle" x="15035.5" y="-1947.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu15 -->
<g id="node1128" class="node">
<title>l4_attn_stage7_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="13379" cy="-1866.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13379" y="-1878.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="13379" y="-1863.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13379" y="-1848.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu15&#45;&gt;l4_attn_stage7_gpu15 -->
<g id="edge1760" class="edge">
<title>l4_attn_stage6_gpu15&#45;&gt;l4_attn_stage7_gpu15</title>
<path fill="none" stroke="black" d="M13379,-1976.24C13379,-1957.53 13379,-1934.53 13379,-1914.55"/>
<polygon fill="black" stroke="black" points="13382.5,-1914.41 13379,-1904.41 13375.5,-1914.41 13382.5,-1914.41"/>
</g>
<!-- l4_attn_stage6_gpu15&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge3072" class="edge">
<title>l4_attn_stage6_gpu15&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13431.96,-1983.68C13445.89,-1977.38 13461.17,-1971.63 13476,-1968.33 13548.51,-1952.21 14742.92,-1982.96 14813,-1958.33 14823.15,-1954.77 14821.91,-1947.06 14832,-1943.33 14875.19,-1927.4 14994.04,-1945.23 15039,-1935.33 15082.6,-1925.73 15129.37,-1905.01 15161.39,-1889.04"/>
<polygon fill="red" stroke="red" points="15163.08,-1892.1 15170.42,-1884.46 15159.92,-1885.86 15163.08,-1892.1"/>
<text text-anchor="middle" x="14863.5" y="-1947.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu0 -->
<g id="node1129" class="node">
<title>l4_attn_stage8_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="13574" cy="-1719.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13574" y="-1731.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="13574" y="-1716.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13574" y="-1701.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu0&#45;&gt;l4_attn_stage8_gpu0 -->
<g id="edge1761" class="edge">
<title>l4_attn_stage7_gpu0&#45;&gt;l4_attn_stage8_gpu0</title>
<path fill="none" stroke="black" d="M13574,-1829.24C13574,-1810.53 13574,-1787.53 13574,-1767.55"/>
<polygon fill="black" stroke="black" points="13577.5,-1767.41 13574,-1757.41 13570.5,-1767.41 13577.5,-1767.41"/>
</g>
<!-- l4_attn_stage8_gpu[next_gpu] -->
<g id="node1397" class="node">
<title>l4_attn_stage8_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="15201" cy="-1719.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="15201" y="-1716.13" font-family="Times,serif" font-size="14.00">l4_attn_stage8_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage7_gpu0&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge3073" class="edge">
<title>l4_attn_stage7_gpu0&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13626.97,-1836.68C13640.89,-1830.39 13656.17,-1824.64 13671,-1821.33 13737.59,-1806.5 14834.64,-1833.97 14899,-1811.33 14909.15,-1807.76 14907.96,-1800.2 14918,-1796.33 14968.3,-1776.99 14986.53,-1800.64 15039,-1788.33 15082.2,-1778.2 15128.67,-1757.75 15160.71,-1742.01"/>
<polygon fill="red" stroke="red" points="15162.38,-1745.09 15169.77,-1737.49 15159.25,-1738.82 15162.38,-1745.09"/>
<text text-anchor="middle" x="14949.5" y="-1800.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu1 -->
<g id="node1130" class="node">
<title>l4_attn_stage8_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14354" cy="-1719.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14354" y="-1731.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="14354" y="-1716.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14354" y="-1701.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu1&#45;&gt;l4_attn_stage8_gpu1 -->
<g id="edge1762" class="edge">
<title>l4_attn_stage7_gpu1&#45;&gt;l4_attn_stage8_gpu1</title>
<path fill="none" stroke="black" d="M14298.51,-1837.52C14284.88,-1831.44 14270.14,-1825.58 14256,-1821.33 14242.42,-1817.25 14202.2,-1822.11 14193,-1811.33 14158.44,-1770.85 14200.28,-1809.61 14256,-1788.33 14273.91,-1781.49 14291.72,-1770.74 14307.14,-1759.81"/>
<polygon fill="black" stroke="black" points="14309.44,-1762.47 14315.45,-1753.75 14305.31,-1756.82 14309.44,-1762.47"/>
</g>
<!-- l4_attn_stage7_gpu1&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge3074" class="edge">
<title>l4_attn_stage7_gpu1&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14406.98,-1836.73C14420.9,-1830.43 14436.18,-1824.67 14451,-1821.33 14472.46,-1816.5 15227.54,-1826.99 15243,-1811.33 15261.16,-1792.94 15243.89,-1765.25 15226.31,-1745.34"/>
<polygon fill="red" stroke="red" points="15228.75,-1742.82 15219.38,-1737.87 15223.61,-1747.58 15228.75,-1742.82"/>
<text text-anchor="middle" x="15282.5" y="-1800.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu2 -->
<g id="node1131" class="node">
<title>l4_attn_stage8_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="12404" cy="-1719.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12404" y="-1731.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="12404" y="-1716.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12404" y="-1701.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu2&#45;&gt;l4_attn_stage8_gpu2 -->
<g id="edge1763" class="edge">
<title>l4_attn_stage7_gpu2&#45;&gt;l4_attn_stage8_gpu2</title>
<path fill="none" stroke="black" d="M12404,-1829.24C12404,-1810.53 12404,-1787.53 12404,-1767.55"/>
<polygon fill="black" stroke="black" points="12407.5,-1767.41 12404,-1757.41 12400.5,-1767.41 12407.5,-1767.41"/>
</g>
<!-- l4_attn_stage7_gpu2&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge3075" class="edge">
<title>l4_attn_stage7_gpu2&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12456.96,-1836.65C12470.88,-1830.36 12486.17,-1824.61 12501,-1821.33 12552.04,-1810.04 14333.66,-1828.61 14383,-1811.33 14393.15,-1807.78 14391.86,-1799.93 14402,-1796.33 14435.36,-1784.52 15004.34,-1795.49 15039,-1788.33 15082.86,-1779.27 15129.76,-1758.36 15161.75,-1742.2"/>
<polygon fill="red" stroke="red" points="15163.48,-1745.25 15170.77,-1737.57 15160.28,-1739.02 15163.48,-1745.25"/>
<text text-anchor="middle" x="14433.5" y="-1800.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu3 -->
<g id="node1132" class="node">
<title>l4_attn_stage8_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14744" cy="-1719.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14744" y="-1731.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="14744" y="-1716.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14744" y="-1701.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu3&#45;&gt;l4_attn_stage8_gpu3 -->
<g id="edge1764" class="edge">
<title>l4_attn_stage7_gpu3&#45;&gt;l4_attn_stage8_gpu3</title>
<path fill="none" stroke="black" d="M14690.43,-1836.83C14676.36,-1830.54 14660.94,-1824.74 14646,-1821.33 14622.22,-1815.9 14224.05,-1828.78 14207,-1811.33 14202.34,-1806.57 14202.33,-1801.09 14207,-1796.33 14215.55,-1787.63 14634.39,-1792.06 14646,-1788.33 14664.59,-1782.36 14682.81,-1771.6 14698.4,-1760.4"/>
<polygon fill="black" stroke="black" points="14700.84,-1762.94 14706.77,-1754.16 14696.66,-1757.33 14700.84,-1762.94"/>
</g>
<!-- l4_attn_stage7_gpu3&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge3076" class="edge">
<title>l4_attn_stage7_gpu3&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14796.99,-1836.78C14810.91,-1830.48 14826.19,-1824.7 14841,-1821.33 14856.55,-1817.79 15403.82,-1822.71 15415,-1811.33 15455.03,-1770.6 15385.32,-1747.24 15315.01,-1734.49"/>
<polygon fill="red" stroke="red" points="15315.55,-1731.04 15305.1,-1732.77 15314.35,-1737.93 15315.55,-1731.04"/>
<text text-anchor="middle" x="15456.5" y="-1800.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu4 -->
<g id="node1133" class="node">
<title>l4_attn_stage8_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13964" cy="-1719.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13964" y="-1731.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="13964" y="-1716.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13964" y="-1701.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu4&#45;&gt;l4_attn_stage8_gpu4 -->
<g id="edge1765" class="edge">
<title>l4_attn_stage7_gpu4&#45;&gt;l4_attn_stage8_gpu4</title>
<path fill="none" stroke="black" d="M13964,-1829.24C13964,-1810.53 13964,-1787.53 13964,-1767.55"/>
<polygon fill="black" stroke="black" points="13967.5,-1767.41 13964,-1757.41 13960.5,-1767.41 13967.5,-1767.41"/>
</g>
<!-- l4_attn_stage7_gpu4&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge3077" class="edge">
<title>l4_attn_stage7_gpu4&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14016.97,-1836.7C14030.89,-1830.41 14046.17,-1824.65 14061,-1821.33 14115.76,-1809.09 15018.08,-1830 15071,-1811.33 15081.15,-1807.75 15081.32,-1802.7 15090,-1796.33 15115.22,-1777.84 15144.5,-1757.99 15166.65,-1743.29"/>
<polygon fill="red" stroke="red" points="15168.66,-1746.15 15175.07,-1737.72 15164.8,-1740.31 15168.66,-1746.15"/>
<text text-anchor="middle" x="15121.5" y="-1800.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu5 -->
<g id="node1134" class="node">
<title>l4_attn_stage8_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="12014" cy="-1719.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12014" y="-1731.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="12014" y="-1716.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12014" y="-1701.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu5&#45;&gt;l4_attn_stage8_gpu5 -->
<g id="edge1766" class="edge">
<title>l4_attn_stage7_gpu5&#45;&gt;l4_attn_stage8_gpu5</title>
<path fill="none" stroke="black" d="M12014,-1829.24C12014,-1810.53 12014,-1787.53 12014,-1767.55"/>
<polygon fill="black" stroke="black" points="12017.5,-1767.41 12014,-1757.41 12010.5,-1767.41 12017.5,-1767.41"/>
</g>
<!-- l4_attn_stage7_gpu5&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge3078" class="edge">
<title>l4_attn_stage7_gpu5&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12066.97,-1836.72C12080.9,-1830.43 12096.18,-1824.66 12111,-1821.33 12340.74,-1769.73 13994.55,-1798.89 14230,-1796.33 14274.94,-1795.85 14994.97,-1797.37 15039,-1788.33 15082.87,-1779.33 15129.77,-1758.41 15161.76,-1742.23"/>
<polygon fill="red" stroke="red" points="15163.49,-1745.28 15170.78,-1737.59 15160.28,-1739.05 15163.49,-1745.28"/>
<text text-anchor="middle" x="14261.5" y="-1800.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu6 -->
<g id="node1135" class="node">
<title>l4_attn_stage8_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14549" cy="-1719.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14549" y="-1731.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="14549" y="-1716.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14549" y="-1701.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu6&#45;&gt;l4_attn_stage8_gpu6 -->
<g id="edge1767" class="edge">
<title>l4_attn_stage7_gpu6&#45;&gt;l4_attn_stage8_gpu6</title>
<path fill="none" stroke="black" d="M14495.13,-1836.89C14481.13,-1830.64 14465.82,-1824.85 14451,-1821.33 14437.42,-1818.11 14209.67,-1821.4 14200,-1811.33 14195.38,-1806.53 14195.36,-1801.12 14200,-1796.33 14209.71,-1786.31 14437.75,-1792.69 14451,-1788.33 14469.55,-1782.24 14487.76,-1771.44 14503.35,-1760.25"/>
<polygon fill="black" stroke="black" points="14505.79,-1762.8 14511.73,-1754.02 14501.61,-1757.18 14505.79,-1762.8"/>
</g>
<!-- l4_attn_stage7_gpu6&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge3079" class="edge">
<title>l4_attn_stage7_gpu6&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14601.98,-1836.75C14615.9,-1830.45 14631.18,-1824.68 14646,-1821.33 14664.51,-1817.15 15315.68,-1824.85 15329,-1811.33 15357.36,-1782.56 15309.79,-1756.73 15264.82,-1740.1"/>
<polygon fill="red" stroke="red" points="15265.88,-1736.76 15255.29,-1736.69 15263.53,-1743.35 15265.88,-1736.76"/>
<text text-anchor="middle" x="15369.5" y="-1800.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu7 -->
<g id="node1136" class="node">
<title>l4_attn_stage8_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14159" cy="-1719.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14159" y="-1731.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="14159" y="-1716.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14159" y="-1701.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu7&#45;&gt;l4_attn_stage8_gpu7 -->
<g id="edge1768" class="edge">
<title>l4_attn_stage7_gpu7&#45;&gt;l4_attn_stage8_gpu7</title>
<path fill="none" stroke="black" d="M14159,-1829.24C14159,-1810.53 14159,-1787.53 14159,-1767.55"/>
<polygon fill="black" stroke="black" points="14162.5,-1767.41 14159,-1757.41 14155.5,-1767.41 14162.5,-1767.41"/>
</g>
<!-- l4_attn_stage7_gpu7&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge3080" class="edge">
<title>l4_attn_stage7_gpu7&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14211.97,-1836.71C14225.9,-1830.42 14241.18,-1824.66 14256,-1821.33 14280.42,-1815.86 15135.86,-1824.73 15157,-1811.33 15178.94,-1797.43 15190.24,-1769.16 15195.85,-1747.89"/>
<polygon fill="red" stroke="red" points="15199.27,-1748.64 15198.18,-1738.1 15192.46,-1747.02 15199.27,-1748.64"/>
<text text-anchor="middle" x="15204.5" y="-1800.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu8 -->
<g id="node1137" class="node">
<title>l4_attn_stage8_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="12794" cy="-1719.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12794" y="-1731.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="12794" y="-1716.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12794" y="-1701.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu8&#45;&gt;l4_attn_stage8_gpu8 -->
<g id="edge1769" class="edge">
<title>l4_attn_stage7_gpu8&#45;&gt;l4_attn_stage8_gpu8</title>
<path fill="none" stroke="black" d="M12794,-1829.24C12794,-1810.53 12794,-1787.53 12794,-1767.55"/>
<polygon fill="black" stroke="black" points="12797.5,-1767.41 12794,-1757.41 12790.5,-1767.41 12797.5,-1767.41"/>
</g>
<!-- l4_attn_stage7_gpu8&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge3081" class="edge">
<title>l4_attn_stage7_gpu8&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12846.96,-1836.66C12860.88,-1830.37 12876.17,-1824.62 12891,-1821.33 12936.13,-1811.33 14511.38,-1826.62 14555,-1811.33 14565.15,-1807.77 14563.87,-1799.95 14574,-1796.33 14622.67,-1778.97 14988.42,-1798.9 15039,-1788.33 15082.84,-1779.17 15129.74,-1758.28 15161.74,-1742.14"/>
<polygon fill="red" stroke="red" points="15163.46,-1745.2 15170.76,-1737.52 15160.27,-1738.97 15163.46,-1745.2"/>
<text text-anchor="middle" x="14605.5" y="-1800.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu9 -->
<g id="node1138" class="node">
<title>l4_attn_stage8_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="12989" cy="-1719.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12989" y="-1731.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="12989" y="-1716.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12989" y="-1701.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu9&#45;&gt;l4_attn_stage8_gpu9 -->
<g id="edge1770" class="edge">
<title>l4_attn_stage7_gpu9&#45;&gt;l4_attn_stage8_gpu9</title>
<path fill="none" stroke="black" d="M12989,-1829.24C12989,-1810.53 12989,-1787.53 12989,-1767.55"/>
<polygon fill="black" stroke="black" points="12992.5,-1767.41 12989,-1757.41 12985.5,-1767.41 12992.5,-1767.41"/>
</g>
<!-- l4_attn_stage7_gpu9&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge3082" class="edge">
<title>l4_attn_stage7_gpu9&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13041.96,-1836.66C13055.89,-1830.37 13071.17,-1824.62 13086,-1821.33 13128.17,-1811.98 14600.24,-1825.63 14641,-1811.33 14651.15,-1807.77 14649.87,-1799.97 14660,-1796.33 14699.64,-1782.1 14997.79,-1797.03 15039,-1788.33 15082.82,-1779.09 15129.73,-1758.2 15161.73,-1742.1"/>
<polygon fill="red" stroke="red" points="15163.45,-1745.15 15170.75,-1737.48 15160.26,-1738.92 15163.45,-1745.15"/>
<text text-anchor="middle" x="14691.5" y="-1800.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu10 -->
<g id="node1139" class="node">
<title>l4_attn_stage8_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12209" cy="-1719.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12209" y="-1731.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="12209" y="-1716.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12209" y="-1701.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu10&#45;&gt;l4_attn_stage8_gpu10 -->
<g id="edge1771" class="edge">
<title>l4_attn_stage7_gpu10&#45;&gt;l4_attn_stage8_gpu10</title>
<path fill="none" stroke="black" d="M12209,-1829.24C12209,-1810.53 12209,-1787.53 12209,-1767.55"/>
<polygon fill="black" stroke="black" points="12212.5,-1767.41 12209,-1757.41 12205.5,-1767.41 12212.5,-1767.41"/>
</g>
<!-- l4_attn_stage7_gpu10&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge3083" class="edge">
<title>l4_attn_stage7_gpu10&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12261.96,-1836.65C12275.88,-1830.36 12291.17,-1824.61 12306,-1821.33 12360,-1809.39 14244.8,-1829.6 14297,-1811.33 14307.15,-1807.78 14305.86,-1799.92 14316,-1796.33 14353.87,-1782.95 14999.66,-1796.43 15039,-1788.33 15082.87,-1779.31 15129.77,-1758.39 15161.76,-1742.22"/>
<polygon fill="red" stroke="red" points="15163.48,-1745.27 15170.78,-1737.58 15160.28,-1739.04 15163.48,-1745.27"/>
<text text-anchor="middle" x="14347.5" y="-1800.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu11 -->
<g id="node1140" class="node">
<title>l4_attn_stage8_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="12599" cy="-1719.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12599" y="-1731.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="12599" y="-1716.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12599" y="-1701.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu11&#45;&gt;l4_attn_stage8_gpu11 -->
<g id="edge1772" class="edge">
<title>l4_attn_stage7_gpu11&#45;&gt;l4_attn_stage8_gpu11</title>
<path fill="none" stroke="black" d="M12599,-1829.24C12599,-1810.53 12599,-1787.53 12599,-1767.55"/>
<polygon fill="black" stroke="black" points="12602.5,-1767.41 12599,-1757.41 12595.5,-1767.41 12602.5,-1767.41"/>
</g>
<!-- l4_attn_stage7_gpu11&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge3084" class="edge">
<title>l4_attn_stage7_gpu11&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12651.96,-1836.66C12665.88,-1830.36 12681.17,-1824.62 12696,-1821.33 12744.09,-1810.69 14422.52,-1827.62 14469,-1811.33 14479.15,-1807.78 14477.86,-1799.94 14488,-1796.33 14516.85,-1786.08 15009.02,-1794.55 15039,-1788.33 15082.85,-1779.23 15129.75,-1758.33 15161.75,-1742.18"/>
<polygon fill="red" stroke="red" points="15163.47,-1745.23 15170.77,-1737.55 15160.27,-1739 15163.47,-1745.23"/>
<text text-anchor="middle" x="14519.5" y="-1800.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu12 -->
<g id="node1141" class="node">
<title>l4_attn_stage8_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14939" cy="-1719.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14939" y="-1731.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="14939" y="-1716.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14939" y="-1701.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu12&#45;&gt;l4_attn_stage8_gpu12 -->
<g id="edge1773" class="edge">
<title>l4_attn_stage7_gpu12&#45;&gt;l4_attn_stage8_gpu12</title>
<path fill="none" stroke="black" d="M14885.7,-1836.88C14871.56,-1830.54 14856.04,-1824.71 14841,-1821.33 14824.01,-1817.51 14226.22,-1823.75 14214,-1811.33 14209.32,-1806.58 14209.32,-1801.08 14214,-1796.33 14226.24,-1783.94 14824.4,-1793.61 14841,-1788.33 14859.6,-1782.42 14877.83,-1771.67 14893.42,-1760.46"/>
<polygon fill="black" stroke="black" points="14895.87,-1763 14901.79,-1754.22 14891.68,-1757.39 14895.87,-1763"/>
</g>
<!-- l4_attn_stage7_gpu12&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge3085" class="edge">
<title>l4_attn_stage7_gpu12&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14994.09,-1837.4C15009.23,-1830.88 15025.92,-1824.84 15042,-1821.33 15066.92,-1815.9 15483.16,-1829.56 15501,-1811.33 15555.67,-1755.46 15454.45,-1733.8 15355.12,-1725.54"/>
<polygon fill="red" stroke="red" points="15355.15,-1722.03 15344.9,-1724.74 15354.6,-1729.01 15355.15,-1722.03"/>
<text text-anchor="middle" x="15542.5" y="-1800.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu13 -->
<g id="node1142" class="node">
<title>l4_attn_stage8_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13184" cy="-1719.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13184" y="-1731.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="13184" y="-1716.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13184" y="-1701.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu13&#45;&gt;l4_attn_stage8_gpu13 -->
<g id="edge1774" class="edge">
<title>l4_attn_stage7_gpu13&#45;&gt;l4_attn_stage8_gpu13</title>
<path fill="none" stroke="black" d="M13184,-1829.24C13184,-1810.53 13184,-1787.53 13184,-1767.55"/>
<polygon fill="black" stroke="black" points="13187.5,-1767.41 13184,-1757.41 13180.5,-1767.41 13187.5,-1767.41"/>
</g>
<!-- l4_attn_stage7_gpu13&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge3086" class="edge">
<title>l4_attn_stage7_gpu13&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13236.96,-1836.67C13250.89,-1830.38 13266.17,-1824.63 13281,-1821.33 13320.21,-1812.63 14689.1,-1824.64 14727,-1811.33 14737.15,-1807.77 14735.89,-1800 14746,-1796.33 14776.62,-1785.23 15007.15,-1795.16 15039,-1788.33 15082.66,-1778.98 15129.41,-1758.22 15161.42,-1742.17"/>
<polygon fill="red" stroke="red" points="15163.12,-1745.23 15170.45,-1737.58 15159.95,-1738.99 15163.12,-1745.23"/>
<text text-anchor="middle" x="14777.5" y="-1800.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu14 -->
<g id="node1143" class="node">
<title>l4_attn_stage8_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="13769" cy="-1719.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13769" y="-1731.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="13769" y="-1716.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13769" y="-1701.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu14&#45;&gt;l4_attn_stage8_gpu14 -->
<g id="edge1775" class="edge">
<title>l4_attn_stage7_gpu14&#45;&gt;l4_attn_stage8_gpu14</title>
<path fill="none" stroke="black" d="M13769,-1829.24C13769,-1810.53 13769,-1787.53 13769,-1767.55"/>
<polygon fill="black" stroke="black" points="13772.5,-1767.41 13769,-1757.41 13765.5,-1767.41 13772.5,-1767.41"/>
</g>
<!-- l4_attn_stage7_gpu14&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge3087" class="edge">
<title>l4_attn_stage7_gpu14&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13821.97,-1836.69C13835.89,-1830.4 13851.17,-1824.64 13866,-1821.33 13926.68,-1807.79 14926.36,-1831.98 14985,-1811.33 14995.15,-1807.76 14994.3,-1800.98 15004,-1796.33 15018.39,-1789.44 15023.8,-1793.2 15039,-1788.33 15079.94,-1775.23 15124.95,-1756.07 15157.12,-1741.51"/>
<polygon fill="red" stroke="red" points="15158.61,-1744.68 15166.25,-1737.34 15155.7,-1738.31 15158.61,-1744.68"/>
<text text-anchor="middle" x="15035.5" y="-1800.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu15 -->
<g id="node1144" class="node">
<title>l4_attn_stage8_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="13379" cy="-1719.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13379" y="-1731.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="13379" y="-1716.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13379" y="-1701.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu15&#45;&gt;l4_attn_stage8_gpu15 -->
<g id="edge1776" class="edge">
<title>l4_attn_stage7_gpu15&#45;&gt;l4_attn_stage8_gpu15</title>
<path fill="none" stroke="black" d="M13379,-1829.24C13379,-1810.53 13379,-1787.53 13379,-1767.55"/>
<polygon fill="black" stroke="black" points="13382.5,-1767.41 13379,-1757.41 13375.5,-1767.41 13382.5,-1767.41"/>
</g>
<!-- l4_attn_stage7_gpu15&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge3088" class="edge">
<title>l4_attn_stage7_gpu15&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13431.96,-1836.68C13445.89,-1830.38 13461.17,-1824.63 13476,-1821.33 13548.51,-1805.21 14742.92,-1835.96 14813,-1811.33 14823.15,-1807.77 14821.91,-1800.06 14832,-1796.33 14875.19,-1780.4 14994.04,-1798.23 15039,-1788.33 15082.6,-1778.73 15129.37,-1758.01 15161.39,-1742.04"/>
<polygon fill="red" stroke="red" points="15163.08,-1745.1 15170.42,-1737.46 15159.92,-1738.86 15163.08,-1745.1"/>
<text text-anchor="middle" x="14863.5" y="-1800.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu0 -->
<g id="node1145" class="node">
<title>l4_attn_stage9_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="13574" cy="-1572.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13574" y="-1584.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="13574" y="-1569.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13574" y="-1554.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu0&#45;&gt;l4_attn_stage9_gpu0 -->
<g id="edge1777" class="edge">
<title>l4_attn_stage8_gpu0&#45;&gt;l4_attn_stage9_gpu0</title>
<path fill="none" stroke="black" d="M13574,-1682.24C13574,-1663.53 13574,-1640.53 13574,-1620.55"/>
<polygon fill="black" stroke="black" points="13577.5,-1620.41 13574,-1610.41 13570.5,-1620.41 13577.5,-1620.41"/>
</g>
<!-- l4_attn_stage9_gpu[next_gpu] -->
<g id="node1398" class="node">
<title>l4_attn_stage9_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="15201" cy="-1572.83" rx="149.5" ry="18"/>
<text text-anchor="middle" x="15201" y="-1569.13" font-family="Times,serif" font-size="14.00">l4_attn_stage9_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage8_gpu0&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge3089" class="edge">
<title>l4_attn_stage8_gpu0&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13626.97,-1689.68C13640.89,-1683.39 13656.17,-1677.64 13671,-1674.33 13737.59,-1659.5 14834.64,-1686.97 14899,-1664.33 14909.15,-1660.76 14907.96,-1653.2 14918,-1649.33 14968.3,-1629.99 14986.53,-1653.64 15039,-1641.33 15082.2,-1631.2 15128.67,-1610.75 15160.71,-1595.01"/>
<polygon fill="red" stroke="red" points="15162.38,-1598.09 15169.77,-1590.49 15159.25,-1591.82 15162.38,-1598.09"/>
<text text-anchor="middle" x="14949.5" y="-1653.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu1 -->
<g id="node1146" class="node">
<title>l4_attn_stage9_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14354" cy="-1572.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14354" y="-1584.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="14354" y="-1569.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14354" y="-1554.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu1&#45;&gt;l4_attn_stage9_gpu1 -->
<g id="edge1778" class="edge">
<title>l4_attn_stage8_gpu1&#45;&gt;l4_attn_stage9_gpu1</title>
<path fill="none" stroke="black" d="M14298.51,-1690.52C14284.88,-1684.44 14270.14,-1678.58 14256,-1674.33 14242.42,-1670.25 14202.2,-1675.11 14193,-1664.33 14158.44,-1623.85 14200.28,-1662.61 14256,-1641.33 14273.91,-1634.49 14291.72,-1623.74 14307.14,-1612.81"/>
<polygon fill="black" stroke="black" points="14309.44,-1615.47 14315.45,-1606.75 14305.31,-1609.82 14309.44,-1615.47"/>
</g>
<!-- l4_attn_stage8_gpu1&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge3090" class="edge">
<title>l4_attn_stage8_gpu1&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14406.98,-1689.73C14420.9,-1683.43 14436.18,-1677.67 14451,-1674.33 14472.46,-1669.5 15227.54,-1679.99 15243,-1664.33 15261.16,-1645.94 15243.89,-1618.25 15226.31,-1598.34"/>
<polygon fill="red" stroke="red" points="15228.75,-1595.82 15219.38,-1590.87 15223.61,-1600.58 15228.75,-1595.82"/>
<text text-anchor="middle" x="15282.5" y="-1653.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu2 -->
<g id="node1147" class="node">
<title>l4_attn_stage9_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="12404" cy="-1572.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12404" y="-1584.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="12404" y="-1569.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12404" y="-1554.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu2&#45;&gt;l4_attn_stage9_gpu2 -->
<g id="edge1779" class="edge">
<title>l4_attn_stage8_gpu2&#45;&gt;l4_attn_stage9_gpu2</title>
<path fill="none" stroke="black" d="M12404,-1682.24C12404,-1663.53 12404,-1640.53 12404,-1620.55"/>
<polygon fill="black" stroke="black" points="12407.5,-1620.41 12404,-1610.41 12400.5,-1620.41 12407.5,-1620.41"/>
</g>
<!-- l4_attn_stage8_gpu2&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge3091" class="edge">
<title>l4_attn_stage8_gpu2&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12456.96,-1689.65C12470.88,-1683.36 12486.17,-1677.61 12501,-1674.33 12552.04,-1663.04 14333.66,-1681.61 14383,-1664.33 14393.15,-1660.78 14391.86,-1652.93 14402,-1649.33 14435.36,-1637.52 15004.34,-1648.49 15039,-1641.33 15082.86,-1632.27 15129.76,-1611.36 15161.75,-1595.2"/>
<polygon fill="red" stroke="red" points="15163.48,-1598.25 15170.77,-1590.57 15160.28,-1592.02 15163.48,-1598.25"/>
<text text-anchor="middle" x="14433.5" y="-1653.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu3 -->
<g id="node1148" class="node">
<title>l4_attn_stage9_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14744" cy="-1572.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14744" y="-1584.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="14744" y="-1569.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14744" y="-1554.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu3&#45;&gt;l4_attn_stage9_gpu3 -->
<g id="edge1780" class="edge">
<title>l4_attn_stage8_gpu3&#45;&gt;l4_attn_stage9_gpu3</title>
<path fill="none" stroke="black" d="M14690.43,-1689.83C14676.36,-1683.54 14660.94,-1677.74 14646,-1674.33 14622.22,-1668.9 14224.05,-1681.78 14207,-1664.33 14202.34,-1659.57 14202.33,-1654.09 14207,-1649.33 14215.55,-1640.63 14634.39,-1645.06 14646,-1641.33 14664.59,-1635.36 14682.81,-1624.6 14698.4,-1613.4"/>
<polygon fill="black" stroke="black" points="14700.84,-1615.94 14706.77,-1607.16 14696.66,-1610.33 14700.84,-1615.94"/>
</g>
<!-- l4_attn_stage8_gpu3&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge3092" class="edge">
<title>l4_attn_stage8_gpu3&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14796.99,-1689.78C14810.91,-1683.48 14826.19,-1677.7 14841,-1674.33 14856.55,-1670.79 15403.82,-1675.71 15415,-1664.33 15455.03,-1623.6 15385.32,-1600.24 15315.01,-1587.49"/>
<polygon fill="red" stroke="red" points="15315.55,-1584.04 15305.1,-1585.77 15314.35,-1590.93 15315.55,-1584.04"/>
<text text-anchor="middle" x="15456.5" y="-1653.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu4 -->
<g id="node1149" class="node">
<title>l4_attn_stage9_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13964" cy="-1572.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13964" y="-1584.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="13964" y="-1569.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13964" y="-1554.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu4&#45;&gt;l4_attn_stage9_gpu4 -->
<g id="edge1781" class="edge">
<title>l4_attn_stage8_gpu4&#45;&gt;l4_attn_stage9_gpu4</title>
<path fill="none" stroke="black" d="M13964,-1682.24C13964,-1663.53 13964,-1640.53 13964,-1620.55"/>
<polygon fill="black" stroke="black" points="13967.5,-1620.41 13964,-1610.41 13960.5,-1620.41 13967.5,-1620.41"/>
</g>
<!-- l4_attn_stage8_gpu4&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge3093" class="edge">
<title>l4_attn_stage8_gpu4&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14016.97,-1689.7C14030.89,-1683.41 14046.17,-1677.65 14061,-1674.33 14115.76,-1662.09 15018.08,-1683 15071,-1664.33 15081.15,-1660.75 15081.32,-1655.7 15090,-1649.33 15115.22,-1630.84 15144.5,-1610.99 15166.65,-1596.29"/>
<polygon fill="red" stroke="red" points="15168.66,-1599.15 15175.07,-1590.72 15164.8,-1593.31 15168.66,-1599.15"/>
<text text-anchor="middle" x="15121.5" y="-1653.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu5 -->
<g id="node1150" class="node">
<title>l4_attn_stage9_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="12014" cy="-1572.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12014" y="-1584.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="12014" y="-1569.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12014" y="-1554.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu5&#45;&gt;l4_attn_stage9_gpu5 -->
<g id="edge1782" class="edge">
<title>l4_attn_stage8_gpu5&#45;&gt;l4_attn_stage9_gpu5</title>
<path fill="none" stroke="black" d="M12014,-1682.24C12014,-1663.53 12014,-1640.53 12014,-1620.55"/>
<polygon fill="black" stroke="black" points="12017.5,-1620.41 12014,-1610.41 12010.5,-1620.41 12017.5,-1620.41"/>
</g>
<!-- l4_attn_stage8_gpu5&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge3094" class="edge">
<title>l4_attn_stage8_gpu5&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12066.97,-1689.72C12080.9,-1683.43 12096.18,-1677.66 12111,-1674.33 12340.74,-1622.73 13994.55,-1651.89 14230,-1649.33 14274.94,-1648.85 14994.97,-1650.37 15039,-1641.33 15082.87,-1632.33 15129.77,-1611.41 15161.76,-1595.23"/>
<polygon fill="red" stroke="red" points="15163.49,-1598.28 15170.78,-1590.59 15160.28,-1592.05 15163.49,-1598.28"/>
<text text-anchor="middle" x="14261.5" y="-1653.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu6 -->
<g id="node1151" class="node">
<title>l4_attn_stage9_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14549" cy="-1572.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14549" y="-1584.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="14549" y="-1569.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14549" y="-1554.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu6&#45;&gt;l4_attn_stage9_gpu6 -->
<g id="edge1783" class="edge">
<title>l4_attn_stage8_gpu6&#45;&gt;l4_attn_stage9_gpu6</title>
<path fill="none" stroke="black" d="M14495.13,-1689.89C14481.13,-1683.64 14465.82,-1677.85 14451,-1674.33 14437.42,-1671.11 14209.67,-1674.4 14200,-1664.33 14195.38,-1659.53 14195.36,-1654.12 14200,-1649.33 14209.71,-1639.31 14437.75,-1645.69 14451,-1641.33 14469.55,-1635.24 14487.76,-1624.44 14503.35,-1613.25"/>
<polygon fill="black" stroke="black" points="14505.79,-1615.8 14511.73,-1607.02 14501.61,-1610.18 14505.79,-1615.8"/>
</g>
<!-- l4_attn_stage8_gpu6&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge3095" class="edge">
<title>l4_attn_stage8_gpu6&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14601.98,-1689.75C14615.9,-1683.45 14631.18,-1677.68 14646,-1674.33 14664.51,-1670.15 15315.68,-1677.85 15329,-1664.33 15357.36,-1635.56 15309.79,-1609.73 15264.82,-1593.1"/>
<polygon fill="red" stroke="red" points="15265.88,-1589.76 15255.29,-1589.69 15263.53,-1596.35 15265.88,-1589.76"/>
<text text-anchor="middle" x="15369.5" y="-1653.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu7 -->
<g id="node1152" class="node">
<title>l4_attn_stage9_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14159" cy="-1572.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14159" y="-1584.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="14159" y="-1569.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14159" y="-1554.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu7&#45;&gt;l4_attn_stage9_gpu7 -->
<g id="edge1784" class="edge">
<title>l4_attn_stage8_gpu7&#45;&gt;l4_attn_stage9_gpu7</title>
<path fill="none" stroke="black" d="M14159,-1682.24C14159,-1663.53 14159,-1640.53 14159,-1620.55"/>
<polygon fill="black" stroke="black" points="14162.5,-1620.41 14159,-1610.41 14155.5,-1620.41 14162.5,-1620.41"/>
</g>
<!-- l4_attn_stage8_gpu7&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge3096" class="edge">
<title>l4_attn_stage8_gpu7&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14211.97,-1689.71C14225.9,-1683.42 14241.18,-1677.66 14256,-1674.33 14280.42,-1668.86 15135.86,-1677.73 15157,-1664.33 15178.94,-1650.43 15190.24,-1622.16 15195.85,-1600.89"/>
<polygon fill="red" stroke="red" points="15199.27,-1601.64 15198.18,-1591.1 15192.46,-1600.02 15199.27,-1601.64"/>
<text text-anchor="middle" x="15204.5" y="-1653.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu8 -->
<g id="node1153" class="node">
<title>l4_attn_stage9_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="12794" cy="-1572.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12794" y="-1584.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="12794" y="-1569.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12794" y="-1554.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu8&#45;&gt;l4_attn_stage9_gpu8 -->
<g id="edge1785" class="edge">
<title>l4_attn_stage8_gpu8&#45;&gt;l4_attn_stage9_gpu8</title>
<path fill="none" stroke="black" d="M12794,-1682.24C12794,-1663.53 12794,-1640.53 12794,-1620.55"/>
<polygon fill="black" stroke="black" points="12797.5,-1620.41 12794,-1610.41 12790.5,-1620.41 12797.5,-1620.41"/>
</g>
<!-- l4_attn_stage8_gpu8&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge3097" class="edge">
<title>l4_attn_stage8_gpu8&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12846.96,-1689.66C12860.88,-1683.37 12876.17,-1677.62 12891,-1674.33 12936.13,-1664.33 14511.38,-1679.62 14555,-1664.33 14565.15,-1660.77 14563.87,-1652.95 14574,-1649.33 14622.67,-1631.97 14988.42,-1651.9 15039,-1641.33 15082.84,-1632.17 15129.74,-1611.28 15161.74,-1595.14"/>
<polygon fill="red" stroke="red" points="15163.46,-1598.2 15170.76,-1590.52 15160.27,-1591.97 15163.46,-1598.2"/>
<text text-anchor="middle" x="14605.5" y="-1653.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu9 -->
<g id="node1154" class="node">
<title>l4_attn_stage9_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="12989" cy="-1572.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12989" y="-1584.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="12989" y="-1569.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12989" y="-1554.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu9&#45;&gt;l4_attn_stage9_gpu9 -->
<g id="edge1786" class="edge">
<title>l4_attn_stage8_gpu9&#45;&gt;l4_attn_stage9_gpu9</title>
<path fill="none" stroke="black" d="M12989,-1682.24C12989,-1663.53 12989,-1640.53 12989,-1620.55"/>
<polygon fill="black" stroke="black" points="12992.5,-1620.41 12989,-1610.41 12985.5,-1620.41 12992.5,-1620.41"/>
</g>
<!-- l4_attn_stage8_gpu9&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge3098" class="edge">
<title>l4_attn_stage8_gpu9&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13041.96,-1689.66C13055.89,-1683.37 13071.17,-1677.62 13086,-1674.33 13128.17,-1664.98 14600.24,-1678.63 14641,-1664.33 14651.15,-1660.77 14649.87,-1652.97 14660,-1649.33 14699.64,-1635.1 14997.79,-1650.03 15039,-1641.33 15082.82,-1632.09 15129.73,-1611.2 15161.73,-1595.1"/>
<polygon fill="red" stroke="red" points="15163.45,-1598.15 15170.75,-1590.48 15160.26,-1591.92 15163.45,-1598.15"/>
<text text-anchor="middle" x="14691.5" y="-1653.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu10 -->
<g id="node1155" class="node">
<title>l4_attn_stage9_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12209" cy="-1572.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12209" y="-1584.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="12209" y="-1569.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12209" y="-1554.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu10&#45;&gt;l4_attn_stage9_gpu10 -->
<g id="edge1787" class="edge">
<title>l4_attn_stage8_gpu10&#45;&gt;l4_attn_stage9_gpu10</title>
<path fill="none" stroke="black" d="M12209,-1682.24C12209,-1663.53 12209,-1640.53 12209,-1620.55"/>
<polygon fill="black" stroke="black" points="12212.5,-1620.41 12209,-1610.41 12205.5,-1620.41 12212.5,-1620.41"/>
</g>
<!-- l4_attn_stage8_gpu10&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge3099" class="edge">
<title>l4_attn_stage8_gpu10&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12261.96,-1689.65C12275.88,-1683.36 12291.17,-1677.61 12306,-1674.33 12360,-1662.39 14244.8,-1682.6 14297,-1664.33 14307.15,-1660.78 14305.86,-1652.92 14316,-1649.33 14353.87,-1635.95 14999.66,-1649.43 15039,-1641.33 15082.87,-1632.31 15129.77,-1611.39 15161.76,-1595.22"/>
<polygon fill="red" stroke="red" points="15163.48,-1598.27 15170.78,-1590.58 15160.28,-1592.04 15163.48,-1598.27"/>
<text text-anchor="middle" x="14347.5" y="-1653.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu11 -->
<g id="node1156" class="node">
<title>l4_attn_stage9_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="12599" cy="-1572.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="12599" y="-1584.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="12599" y="-1569.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12599" y="-1554.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu11&#45;&gt;l4_attn_stage9_gpu11 -->
<g id="edge1788" class="edge">
<title>l4_attn_stage8_gpu11&#45;&gt;l4_attn_stage9_gpu11</title>
<path fill="none" stroke="black" d="M12599,-1682.24C12599,-1663.53 12599,-1640.53 12599,-1620.55"/>
<polygon fill="black" stroke="black" points="12602.5,-1620.41 12599,-1610.41 12595.5,-1620.41 12602.5,-1620.41"/>
</g>
<!-- l4_attn_stage8_gpu11&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge3100" class="edge">
<title>l4_attn_stage8_gpu11&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12651.96,-1689.66C12665.88,-1683.36 12681.17,-1677.62 12696,-1674.33 12744.09,-1663.69 14422.52,-1680.62 14469,-1664.33 14479.15,-1660.78 14477.86,-1652.94 14488,-1649.33 14516.85,-1639.08 15009.02,-1647.55 15039,-1641.33 15082.85,-1632.23 15129.75,-1611.33 15161.75,-1595.18"/>
<polygon fill="red" stroke="red" points="15163.47,-1598.23 15170.77,-1590.55 15160.27,-1592 15163.47,-1598.23"/>
<text text-anchor="middle" x="14519.5" y="-1653.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu12 -->
<g id="node1157" class="node">
<title>l4_attn_stage9_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14939" cy="-1572.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="14939" y="-1584.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="14939" y="-1569.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14939" y="-1554.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu12&#45;&gt;l4_attn_stage9_gpu12 -->
<g id="edge1789" class="edge">
<title>l4_attn_stage8_gpu12&#45;&gt;l4_attn_stage9_gpu12</title>
<path fill="none" stroke="black" d="M14885.7,-1689.88C14871.56,-1683.54 14856.04,-1677.71 14841,-1674.33 14824.01,-1670.51 14226.22,-1676.75 14214,-1664.33 14209.32,-1659.58 14209.32,-1654.08 14214,-1649.33 14226.24,-1636.94 14824.4,-1646.61 14841,-1641.33 14859.6,-1635.42 14877.83,-1624.67 14893.42,-1613.46"/>
<polygon fill="black" stroke="black" points="14895.87,-1616 14901.79,-1607.22 14891.68,-1610.39 14895.87,-1616"/>
</g>
<!-- l4_attn_stage8_gpu12&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge3101" class="edge">
<title>l4_attn_stage8_gpu12&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14994.09,-1690.4C15009.23,-1683.88 15025.92,-1677.84 15042,-1674.33 15066.92,-1668.9 15483.16,-1682.56 15501,-1664.33 15555.67,-1608.46 15454.45,-1586.8 15355.12,-1578.54"/>
<polygon fill="red" stroke="red" points="15355.15,-1575.03 15344.9,-1577.74 15354.6,-1582.01 15355.15,-1575.03"/>
<text text-anchor="middle" x="15542.5" y="-1653.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu13 -->
<g id="node1158" class="node">
<title>l4_attn_stage9_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13184" cy="-1572.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13184" y="-1584.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="13184" y="-1569.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13184" y="-1554.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu13&#45;&gt;l4_attn_stage9_gpu13 -->
<g id="edge1790" class="edge">
<title>l4_attn_stage8_gpu13&#45;&gt;l4_attn_stage9_gpu13</title>
<path fill="none" stroke="black" d="M13184,-1682.24C13184,-1663.53 13184,-1640.53 13184,-1620.55"/>
<polygon fill="black" stroke="black" points="13187.5,-1620.41 13184,-1610.41 13180.5,-1620.41 13187.5,-1620.41"/>
</g>
<!-- l4_attn_stage8_gpu13&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge3102" class="edge">
<title>l4_attn_stage8_gpu13&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13236.96,-1689.67C13250.89,-1683.38 13266.17,-1677.63 13281,-1674.33 13320.21,-1665.63 14689.1,-1677.64 14727,-1664.33 14737.15,-1660.77 14735.89,-1653 14746,-1649.33 14776.62,-1638.23 15007.15,-1648.16 15039,-1641.33 15082.66,-1631.98 15129.41,-1611.22 15161.42,-1595.17"/>
<polygon fill="red" stroke="red" points="15163.12,-1598.23 15170.45,-1590.58 15159.95,-1591.99 15163.12,-1598.23"/>
<text text-anchor="middle" x="14777.5" y="-1653.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu14 -->
<g id="node1159" class="node">
<title>l4_attn_stage9_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="13769" cy="-1572.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13769" y="-1584.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="13769" y="-1569.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13769" y="-1554.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu14&#45;&gt;l4_attn_stage9_gpu14 -->
<g id="edge1791" class="edge">
<title>l4_attn_stage8_gpu14&#45;&gt;l4_attn_stage9_gpu14</title>
<path fill="none" stroke="black" d="M13769,-1682.24C13769,-1663.53 13769,-1640.53 13769,-1620.55"/>
<polygon fill="black" stroke="black" points="13772.5,-1620.41 13769,-1610.41 13765.5,-1620.41 13772.5,-1620.41"/>
</g>
<!-- l4_attn_stage8_gpu14&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge3103" class="edge">
<title>l4_attn_stage8_gpu14&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13821.97,-1689.69C13835.89,-1683.4 13851.17,-1677.64 13866,-1674.33 13926.68,-1660.79 14926.36,-1684.98 14985,-1664.33 14995.15,-1660.76 14994.3,-1653.98 15004,-1649.33 15018.39,-1642.44 15023.8,-1646.2 15039,-1641.33 15079.94,-1628.23 15124.95,-1609.07 15157.12,-1594.51"/>
<polygon fill="red" stroke="red" points="15158.61,-1597.68 15166.25,-1590.34 15155.7,-1591.31 15158.61,-1597.68"/>
<text text-anchor="middle" x="15035.5" y="-1653.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu15 -->
<g id="node1160" class="node">
<title>l4_attn_stage9_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="13379" cy="-1572.83" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="13379" y="-1584.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="13379" y="-1569.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13379" y="-1554.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu15&#45;&gt;l4_attn_stage9_gpu15 -->
<g id="edge1792" class="edge">
<title>l4_attn_stage8_gpu15&#45;&gt;l4_attn_stage9_gpu15</title>
<path fill="none" stroke="black" d="M13379,-1682.24C13379,-1663.53 13379,-1640.53 13379,-1620.55"/>
<polygon fill="black" stroke="black" points="13382.5,-1620.41 13379,-1610.41 13375.5,-1620.41 13382.5,-1620.41"/>
</g>
<!-- l4_attn_stage8_gpu15&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge3104" class="edge">
<title>l4_attn_stage8_gpu15&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13431.96,-1689.68C13445.89,-1683.38 13461.17,-1677.63 13476,-1674.33 13548.51,-1658.21 14742.92,-1688.96 14813,-1664.33 14823.15,-1660.77 14821.91,-1653.06 14832,-1649.33 14875.19,-1633.4 14994.04,-1651.23 15039,-1641.33 15082.6,-1631.73 15129.37,-1611.01 15161.39,-1595.04"/>
<polygon fill="red" stroke="red" points="15163.08,-1598.1 15170.42,-1590.46 15159.92,-1591.86 15163.08,-1598.1"/>
<text text-anchor="middle" x="14863.5" y="-1653.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu0 -->
<g id="node1161" class="node">
<title>l4_attn_stage10_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="13476" cy="-1425.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13476" y="-1437.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="13476" y="-1422.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13476" y="-1407.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu0&#45;&gt;l4_attn_stage10_gpu0 -->
<g id="edge1793" class="edge">
<title>l4_attn_stage9_gpu0&#45;&gt;l4_attn_stage10_gpu0</title>
<path fill="none" stroke="black" d="M13550.03,-1536.36C13536.63,-1516.54 13519.82,-1491.67 13505.61,-1470.64"/>
<polygon fill="black" stroke="black" points="13508.4,-1468.51 13499.9,-1462.19 13502.6,-1472.43 13508.4,-1468.51"/>
</g>
<!-- l4_attn_stage10_gpu[next_gpu] -->
<g id="node1399" class="node">
<title>l4_attn_stage10_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="15207" cy="-1425.83" rx="155.5" ry="18"/>
<text text-anchor="middle" x="15207" y="-1422.13" font-family="Times,serif" font-size="14.00">l4_attn_stage10_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage9_gpu0&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge3105" class="edge">
<title>l4_attn_stage9_gpu0&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13626.97,-1542.68C13640.89,-1536.39 13656.17,-1530.64 13671,-1527.33 13736.78,-1512.68 14820.43,-1539.7 14884,-1517.33 14894.15,-1513.76 14892.94,-1506.16 14903,-1502.33 14931.3,-1491.57 15009.46,-1500.95 15039,-1494.33 15083.67,-1484.33 15131.88,-1463.86 15165.15,-1448.08"/>
<polygon fill="red" stroke="red" points="15167.06,-1451.04 15174.55,-1443.55 15164.02,-1444.74 15167.06,-1451.04"/>
<text text-anchor="middle" x="14934.5" y="-1506.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu1 -->
<g id="node1162" class="node">
<title>l4_attn_stage10_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14308" cy="-1425.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14308" y="-1437.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="14308" y="-1422.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14308" y="-1407.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu1&#45;&gt;l4_attn_stage10_gpu1 -->
<g id="edge1794" class="edge">
<title>l4_attn_stage9_gpu1&#45;&gt;l4_attn_stage10_gpu1</title>
<path fill="none" stroke="black" d="M14298.86,-1543.33C14285.15,-1537.22 14270.29,-1531.39 14256,-1527.33 14239.19,-1522.56 14189.54,-1530.45 14178,-1517.33 14173.6,-1512.33 14174.04,-1507.7 14178,-1502.33 14185.18,-1492.61 14193.05,-1499.45 14204,-1494.33 14221.44,-1486.18 14239.39,-1475.49 14255.36,-1465.02"/>
<polygon fill="black" stroke="black" points="14257.64,-1467.71 14264.02,-1459.25 14253.76,-1461.89 14257.64,-1467.71"/>
</g>
<!-- l4_attn_stage9_gpu1&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge3106" class="edge">
<title>l4_attn_stage9_gpu1&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14406.98,-1542.73C14420.9,-1536.44 14436.18,-1530.67 14451,-1527.33 14472.06,-1522.59 15212.84,-1532.69 15228,-1517.33 15244.71,-1500.41 15235.21,-1472.97 15224.14,-1452.73"/>
<polygon fill="red" stroke="red" points="15227.11,-1450.87 15219.04,-1444 15221.07,-1454.4 15227.11,-1450.87"/>
<text text-anchor="middle" x="15267.5" y="-1506.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu2 -->
<g id="node1163" class="node">
<title>l4_attn_stage10_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="12228" cy="-1425.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12228" y="-1437.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="12228" y="-1422.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12228" y="-1407.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu2&#45;&gt;l4_attn_stage10_gpu2 -->
<g id="edge1795" class="edge">
<title>l4_attn_stage9_gpu2&#45;&gt;l4_attn_stage10_gpu2</title>
<path fill="none" stroke="black" d="M12364.06,-1538.93C12337.94,-1517.41 12303.66,-1489.17 12276.05,-1466.42"/>
<polygon fill="black" stroke="black" points="12278.03,-1463.51 12268.08,-1459.86 12273.58,-1468.92 12278.03,-1463.51"/>
</g>
<!-- l4_attn_stage9_gpu2&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge3107" class="edge">
<title>l4_attn_stage9_gpu2&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12456.96,-1542.65C12470.88,-1536.36 12486.17,-1530.62 12501,-1527.33 12551.64,-1516.13 14319.05,-1534.47 14368,-1517.33 14378.15,-1513.78 14376.86,-1505.92 14387,-1502.33 14421.15,-1490.24 15003.48,-1501.43 15039,-1494.33 15084.31,-1485.28 15132.97,-1464.37 15166.2,-1448.2"/>
<polygon fill="red" stroke="red" points="15168.16,-1451.14 15175.57,-1443.57 15165.06,-1444.87 15168.16,-1451.14"/>
<text text-anchor="middle" x="14418.5" y="-1506.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu3 -->
<g id="node1164" class="node">
<title>l4_attn_stage10_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14724" cy="-1425.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14724" y="-1437.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="14724" y="-1422.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14724" y="-1407.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu3&#45;&gt;l4_attn_stage10_gpu3 -->
<g id="edge1796" class="edge">
<title>l4_attn_stage9_gpu3&#45;&gt;l4_attn_stage10_gpu3</title>
<path fill="none" stroke="black" d="M14690.43,-1542.83C14676.36,-1536.53 14660.94,-1530.74 14646,-1527.33 14621.4,-1521.73 14209.64,-1535.37 14192,-1517.33 14187.34,-1512.57 14187.33,-1507.09 14192,-1502.33 14200.33,-1493.85 14608.63,-1497.82 14620,-1494.33 14639.63,-1488.32 14659.07,-1477.42 14675.73,-1466.11"/>
<polygon fill="black" stroke="black" points="14678.01,-1468.79 14684.18,-1460.18 14673.99,-1463.06 14678.01,-1468.79"/>
</g>
<!-- l4_attn_stage9_gpu3&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge3108" class="edge">
<title>l4_attn_stage9_gpu3&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14796.99,-1542.78C14810.91,-1536.49 14826.19,-1530.71 14841,-1527.33 14856.14,-1523.88 15389.12,-1528.41 15400,-1517.33 15436.82,-1479.85 15373.45,-1456.11 15309.69,-1442.4"/>
<polygon fill="red" stroke="red" points="15310.38,-1438.97 15299.88,-1440.36 15308.96,-1445.82 15310.38,-1438.97"/>
<text text-anchor="middle" x="15440.5" y="-1506.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu4 -->
<g id="node1165" class="node">
<title>l4_attn_stage10_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13892" cy="-1425.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13892" y="-1437.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="13892" y="-1422.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13892" y="-1407.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu4&#45;&gt;l4_attn_stage10_gpu4 -->
<g id="edge1797" class="edge">
<title>l4_attn_stage9_gpu4&#45;&gt;l4_attn_stage10_gpu4</title>
<path fill="none" stroke="black" d="M13946.2,-1535.99C13936.6,-1516.65 13924.64,-1492.57 13914.41,-1471.96"/>
<polygon fill="black" stroke="black" points="13917.42,-1470.17 13909.84,-1462.77 13911.16,-1473.28 13917.42,-1470.17"/>
</g>
<!-- l4_attn_stage9_gpu4&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge3109" class="edge">
<title>l4_attn_stage9_gpu4&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14016.97,-1542.7C14030.89,-1536.41 14046.17,-1530.65 14061,-1527.33 14114.95,-1515.26 15003.87,-1535.73 15056,-1517.33 15066.15,-1513.75 15066.08,-1508.35 15075,-1502.33 15104.36,-1482.51 15139.2,-1462.72 15165.72,-1448.38"/>
<polygon fill="red" stroke="red" points="15167.57,-1451.36 15174.73,-1443.55 15164.26,-1445.19 15167.57,-1451.36"/>
<text text-anchor="middle" x="15106.5" y="-1506.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu5 -->
<g id="node1166" class="node">
<title>l4_attn_stage10_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="11812" cy="-1425.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="11812" y="-1437.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="11812" y="-1422.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="11812" y="-1407.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu5&#45;&gt;l4_attn_stage10_gpu5 -->
<g id="edge1798" class="edge">
<title>l4_attn_stage9_gpu5&#45;&gt;l4_attn_stage10_gpu5</title>
<path fill="none" stroke="black" d="M11969.67,-1540.01C11938.97,-1517.97 11897.93,-1488.52 11865.42,-1465.18"/>
<polygon fill="black" stroke="black" points="11867.09,-1462.07 11856.92,-1459.08 11863.01,-1467.76 11867.09,-1462.07"/>
</g>
<!-- l4_attn_stage9_gpu5&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge3110" class="edge">
<title>l4_attn_stage9_gpu5&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12066.97,-1542.72C12080.9,-1536.43 12096.18,-1530.66 12111,-1527.33 12339.11,-1476.08 13981.22,-1504.86 14215,-1502.33 14260.78,-1501.84 14994.1,-1503.24 15039,-1494.33 15084.32,-1485.34 15132.98,-1464.42 15166.21,-1448.24"/>
<polygon fill="red" stroke="red" points="15168.17,-1451.17 15175.58,-1443.6 15165.06,-1444.9 15168.17,-1451.17"/>
<text text-anchor="middle" x="14246.5" y="-1506.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu6 -->
<g id="node1167" class="node">
<title>l4_attn_stage10_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14516" cy="-1425.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14516" y="-1437.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="14516" y="-1422.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14516" y="-1407.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu6&#45;&gt;l4_attn_stage10_gpu6 -->
<g id="edge1799" class="edge">
<title>l4_attn_stage9_gpu6&#45;&gt;l4_attn_stage10_gpu6</title>
<path fill="none" stroke="black" d="M14495.39,-1542.99C14481.33,-1536.69 14465.91,-1530.85 14451,-1527.33 14436.61,-1523.93 14195.26,-1527.98 14185,-1517.33 14180.38,-1512.53 14180.37,-1507.13 14185,-1502.33 14193.76,-1493.25 14399.97,-1498.13 14412,-1494.33 14431.58,-1488.16 14451,-1477.22 14467.67,-1465.92"/>
<polygon fill="black" stroke="black" points="14469.94,-1468.6 14476.13,-1460 14465.93,-1462.87 14469.94,-1468.6"/>
</g>
<!-- l4_attn_stage9_gpu6&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge3111" class="edge">
<title>l4_attn_stage9_gpu6&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14601.98,-1542.75C14615.9,-1536.46 14631.18,-1530.69 14646,-1527.33 14664.1,-1523.24 15300.98,-1530.55 15314,-1517.33 15339.61,-1491.34 15298.49,-1464.74 15260.03,-1447.17"/>
<polygon fill="red" stroke="red" points="15261.43,-1443.96 15250.87,-1443.12 15258.61,-1450.36 15261.43,-1443.96"/>
<text text-anchor="middle" x="15353.5" y="-1506.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu7 -->
<g id="node1168" class="node">
<title>l4_attn_stage10_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14100" cy="-1425.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14100" y="-1437.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="14100" y="-1422.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14100" y="-1407.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu7&#45;&gt;l4_attn_stage10_gpu7 -->
<g id="edge1800" class="edge">
<title>l4_attn_stage9_gpu7&#45;&gt;l4_attn_stage10_gpu7</title>
<path fill="none" stroke="black" d="M14144.26,-1535.62C14136.49,-1516.5 14126.86,-1492.85 14118.58,-1472.49"/>
<polygon fill="black" stroke="black" points="14121.76,-1471.03 14114.75,-1463.09 14115.28,-1473.67 14121.76,-1471.03"/>
</g>
<!-- l4_attn_stage9_gpu7&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge3112" class="edge">
<title>l4_attn_stage9_gpu7&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14211.97,-1542.71C14225.9,-1536.42 14241.18,-1530.66 14256,-1527.33 14280.02,-1521.94 15120.16,-1528.69 15142,-1517.33 15155.7,-1510.21 15177.58,-1476.79 15192.12,-1452.63"/>
<polygon fill="red" stroke="red" points="15195.21,-1454.29 15197.3,-1443.9 15189.19,-1450.72 15195.21,-1454.29"/>
<text text-anchor="middle" x="15189.5" y="-1506.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu8 -->
<g id="node1169" class="node">
<title>l4_attn_stage10_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="12644" cy="-1425.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12644" y="-1437.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="12644" y="-1422.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12644" y="-1407.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu8&#45;&gt;l4_attn_stage10_gpu8 -->
<g id="edge1801" class="edge">
<title>l4_attn_stage9_gpu8&#45;&gt;l4_attn_stage10_gpu8</title>
<path fill="none" stroke="black" d="M12759.21,-1538.2C12737.5,-1517.22 12709.41,-1490.06 12686.4,-1467.82"/>
<polygon fill="black" stroke="black" points="12688.74,-1465.22 12679.12,-1460.78 12683.88,-1470.25 12688.74,-1465.22"/>
</g>
<!-- l4_attn_stage9_gpu8&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge3113" class="edge">
<title>l4_attn_stage9_gpu8&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12846.96,-1542.66C12860.88,-1536.37 12876.17,-1530.62 12891,-1527.33 12935.72,-1517.42 14496.77,-1532.49 14540,-1517.33 14550.15,-1513.77 14548.87,-1505.95 14559,-1502.33 14609.24,-1484.42 14986.72,-1504.9 15039,-1494.33 15084.29,-1485.18 15132.96,-1464.29 15166.19,-1448.15"/>
<polygon fill="red" stroke="red" points="15168.14,-1451.09 15175.56,-1443.53 15165.05,-1444.81 15168.14,-1451.09"/>
<text text-anchor="middle" x="14590.5" y="-1506.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu9 -->
<g id="node1170" class="node">
<title>l4_attn_stage10_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="12852" cy="-1425.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12852" y="-1437.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="12852" y="-1422.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12852" y="-1407.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu9&#45;&gt;l4_attn_stage10_gpu9 -->
<g id="edge1802" class="edge">
<title>l4_attn_stage9_gpu9&#45;&gt;l4_attn_stage10_gpu9</title>
<path fill="none" stroke="black" d="M12956.88,-1537.84C12937.35,-1517.17 12912.27,-1490.62 12891.53,-1468.67"/>
<polygon fill="black" stroke="black" points="12893.81,-1465.98 12884.39,-1461.12 12888.72,-1470.79 12893.81,-1465.98"/>
</g>
<!-- l4_attn_stage9_gpu9&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge3114" class="edge">
<title>l4_attn_stage9_gpu9&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13041.96,-1542.67C13055.89,-1536.37 13071.17,-1530.62 13086,-1527.33 13127.76,-1518.07 14585.63,-1531.49 14626,-1517.33 14636.15,-1513.77 14634.87,-1505.96 14645,-1502.33 14686.22,-1487.55 14996.1,-1503.08 15039,-1494.33 15084.27,-1485.1 15132.94,-1464.22 15166.18,-1448.11"/>
<polygon fill="red" stroke="red" points="15168.13,-1451.05 15175.56,-1443.49 15165.04,-1444.77 15168.13,-1451.05"/>
<text text-anchor="middle" x="14676.5" y="-1506.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu10 -->
<g id="node1171" class="node">
<title>l4_attn_stage10_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12020" cy="-1425.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12020" y="-1437.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="12020" y="-1422.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12020" y="-1407.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu10&#45;&gt;l4_attn_stage10_gpu10 -->
<g id="edge1803" class="edge">
<title>l4_attn_stage9_gpu10&#45;&gt;l4_attn_stage10_gpu10</title>
<path fill="none" stroke="black" d="M12167.05,-1539.65C12138.62,-1517.84 12100.89,-1488.89 12070.76,-1465.78"/>
<polygon fill="black" stroke="black" points="12072.55,-1462.73 12062.48,-1459.42 12068.29,-1468.29 12072.55,-1462.73"/>
</g>
<!-- l4_attn_stage9_gpu10&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge3115" class="edge">
<title>l4_attn_stage9_gpu10&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12261.96,-1542.65C12275.88,-1536.36 12291.17,-1530.61 12306,-1527.33 12359.6,-1515.48 14230.19,-1535.47 14282,-1517.33 14292.15,-1513.78 14290.86,-1505.92 14301,-1502.33 14339.66,-1488.68 14998.79,-1502.34 15039,-1494.33 15084.31,-1485.32 15132.98,-1464.4 15166.21,-1448.22"/>
<polygon fill="red" stroke="red" points="15168.17,-1451.16 15175.58,-1443.59 15165.06,-1444.88 15168.17,-1451.16"/>
<text text-anchor="middle" x="14332.5" y="-1506.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu11 -->
<g id="node1172" class="node">
<title>l4_attn_stage10_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="12436" cy="-1425.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12436" y="-1437.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="12436" y="-1422.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12436" y="-1407.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu11&#45;&gt;l4_attn_stage10_gpu11 -->
<g id="edge1804" class="edge">
<title>l4_attn_stage9_gpu11&#45;&gt;l4_attn_stage10_gpu11</title>
<path fill="none" stroke="black" d="M12561.6,-1538.57C12537.75,-1517.35 12506.69,-1489.72 12481.43,-1467.24"/>
<polygon fill="black" stroke="black" points="12483.58,-1464.48 12473.79,-1460.45 12478.93,-1469.71 12483.58,-1464.48"/>
</g>
<!-- l4_attn_stage9_gpu11&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge3116" class="edge">
<title>l4_attn_stage9_gpu11&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12651.96,-1542.66C12665.88,-1536.36 12681.17,-1530.62 12696,-1527.33 12743.68,-1516.78 14407.91,-1533.48 14454,-1517.33 14464.15,-1513.78 14462.86,-1505.93 14473,-1502.33 14502.63,-1491.81 15008.17,-1500.52 15039,-1494.33 15084.3,-1485.24 15132.97,-1464.34 15166.2,-1448.18"/>
<polygon fill="red" stroke="red" points="15168.15,-1451.12 15175.57,-1443.55 15165.05,-1444.84 15168.15,-1451.12"/>
<text text-anchor="middle" x="14504.5" y="-1506.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu12 -->
<g id="node1173" class="node">
<title>l4_attn_stage10_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14932" cy="-1425.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14932" y="-1437.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="14932" y="-1422.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14932" y="-1407.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu12&#45;&gt;l4_attn_stage10_gpu12 -->
<g id="edge1805" class="edge">
<title>l4_attn_stage9_gpu12&#45;&gt;l4_attn_stage10_gpu12</title>
<path fill="none" stroke="black" d="M14885.7,-1542.87C14871.57,-1536.53 14856.04,-1530.71 14841,-1527.33 14823.6,-1523.42 14211.51,-1530.04 14199,-1517.33 14194.32,-1512.58 14194.32,-1507.08 14199,-1502.33 14211.28,-1489.9 14811.28,-1499.4 14828,-1494.33 14847.65,-1488.38 14867.09,-1477.49 14883.75,-1466.18"/>
<polygon fill="black" stroke="black" points="14886.03,-1468.85 14892.2,-1460.24 14882.01,-1463.13 14886.03,-1468.85"/>
</g>
<!-- l4_attn_stage9_gpu12&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge3117" class="edge">
<title>l4_attn_stage9_gpu12&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14994.09,-1543.41C15009.23,-1536.89 15025.92,-1530.85 15042,-1527.33 15066.1,-1522.07 15468.75,-1534.97 15486,-1517.33 15535.67,-1466.53 15448.33,-1444.22 15358.57,-1434.44"/>
<polygon fill="red" stroke="red" points="15358.78,-1430.94 15348.47,-1433.39 15358.05,-1437.91 15358.78,-1430.94"/>
<text text-anchor="middle" x="15526.5" y="-1506.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu13 -->
<g id="node1174" class="node">
<title>l4_attn_stage10_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13060" cy="-1425.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13060" y="-1437.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="13060" y="-1422.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13060" y="-1407.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu13&#45;&gt;l4_attn_stage10_gpu13 -->
<g id="edge1806" class="edge">
<title>l4_attn_stage9_gpu13&#45;&gt;l4_attn_stage10_gpu13</title>
<path fill="none" stroke="black" d="M13154.3,-1537.1C13136.88,-1516.73 13114.74,-1490.84 13096.29,-1469.27"/>
<polygon fill="black" stroke="black" points="13098.83,-1466.86 13089.67,-1461.53 13093.51,-1471.41 13098.83,-1466.86"/>
</g>
<!-- l4_attn_stage9_gpu13&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge3118" class="edge">
<title>l4_attn_stage9_gpu13&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13236.96,-1542.67C13250.89,-1536.38 13266.17,-1530.63 13281,-1527.33 13319.81,-1518.71 14674.49,-1530.5 14712,-1517.33 14722.15,-1513.77 14720.88,-1505.99 14731,-1502.33 14763.19,-1490.69 15005.48,-1501.27 15039,-1494.33 15084.11,-1485 15132.62,-1464.24 15165.86,-1448.18"/>
<polygon fill="red" stroke="red" points="15167.8,-1451.13 15175.24,-1443.58 15164.72,-1444.85 15167.8,-1451.13"/>
<text text-anchor="middle" x="14762.5" y="-1506.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu14 -->
<g id="node1175" class="node">
<title>l4_attn_stage10_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="13684" cy="-1425.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13684" y="-1437.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="13684" y="-1422.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13684" y="-1407.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu14&#45;&gt;l4_attn_stage10_gpu14 -->
<g id="edge1807" class="edge">
<title>l4_attn_stage9_gpu14&#45;&gt;l4_attn_stage10_gpu14</title>
<path fill="none" stroke="black" d="M13748.21,-1536.36C13736.68,-1516.7 13722.24,-1492.07 13709.98,-1471.15"/>
<polygon fill="black" stroke="black" points="13712.95,-1469.3 13704.87,-1462.44 13706.91,-1472.84 13712.95,-1469.3"/>
</g>
<!-- l4_attn_stage9_gpu14&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge3119" class="edge">
<title>l4_attn_stage9_gpu14&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13821.97,-1542.69C13835.89,-1536.4 13851.17,-1530.64 13866,-1527.33 13925.86,-1513.97 14912.15,-1537.71 14970,-1517.33 14980.15,-1513.76 14979.15,-1506.66 14989,-1502.33 15009.61,-1493.29 15017.31,-1500.34 15039,-1494.33 15082.28,-1482.34 15129.59,-1462.7 15162.94,-1447.69"/>
<polygon fill="red" stroke="red" points="15164.74,-1450.72 15172.4,-1443.4 15161.84,-1444.35 15164.74,-1450.72"/>
<text text-anchor="middle" x="15020.5" y="-1506.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu15 -->
<g id="node1176" class="node">
<title>l4_attn_stage10_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="13268" cy="-1425.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13268" y="-1437.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="13268" y="-1422.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13268" y="-1407.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu15&#45;&gt;l4_attn_stage10_gpu15 -->
<g id="edge1808" class="edge">
<title>l4_attn_stage9_gpu15&#45;&gt;l4_attn_stage10_gpu15</title>
<path fill="none" stroke="black" d="M13352.13,-1536.73C13336.71,-1516.59 13317.23,-1491.15 13300.9,-1469.82"/>
<polygon fill="black" stroke="black" points="13303.67,-1467.67 13294.81,-1461.86 13298.11,-1471.93 13303.67,-1467.67"/>
</g>
<!-- l4_attn_stage9_gpu15&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge3120" class="edge">
<title>l4_attn_stage9_gpu15&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13431.97,-1542.68C13445.89,-1536.38 13461.17,-1530.63 13476,-1527.33 13547.69,-1511.39 14728.71,-1541.68 14798,-1517.33 14808.15,-1513.77 14806.9,-1506.04 14817,-1502.33 14863.34,-1485.31 14990.71,-1504.58 15039,-1494.33 15084.06,-1484.77 15132.58,-1464.04 15165.83,-1448.06"/>
<polygon fill="red" stroke="red" points="15167.76,-1451.01 15175.22,-1443.48 15164.69,-1444.72 15167.76,-1451.01"/>
<text text-anchor="middle" x="14848.5" y="-1506.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu0 -->
<g id="node1177" class="node">
<title>l4_attn_stage11_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="13476" cy="-1278.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13476" y="-1290.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="13476" y="-1275.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13476" y="-1260.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu0&#45;&gt;l4_attn_stage11_gpu0 -->
<g id="edge1809" class="edge">
<title>l4_attn_stage10_gpu0&#45;&gt;l4_attn_stage11_gpu0</title>
<path fill="none" stroke="black" d="M13476,-1388.24C13476,-1369.53 13476,-1346.53 13476,-1326.55"/>
<polygon fill="black" stroke="black" points="13479.5,-1326.41 13476,-1316.41 13472.5,-1326.41 13479.5,-1326.41"/>
</g>
<!-- l4_attn_stage11_gpu[next_gpu] -->
<g id="node1400" class="node">
<title>l4_attn_stage11_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="15207" cy="-1278.83" rx="155.5" ry="18"/>
<text text-anchor="middle" x="15207" y="-1275.13" font-family="Times,serif" font-size="14.00">l4_attn_stage11_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage10_gpu0&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge3121" class="edge">
<title>l4_attn_stage10_gpu0&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13532.98,-1395.67C13547.9,-1389.38 13564.24,-1383.63 13580,-1380.33 13650.91,-1365.52 14815.65,-1394.35 14884,-1370.33 14894.15,-1366.77 14892.94,-1359.16 14903,-1355.33 14931.3,-1344.57 15009.46,-1353.95 15039,-1347.33 15083.67,-1337.33 15131.88,-1316.86 15165.15,-1301.08"/>
<polygon fill="red" stroke="red" points="15167.06,-1304.04 15174.55,-1296.55 15164.02,-1297.74 15167.06,-1304.04"/>
<text text-anchor="middle" x="14934.5" y="-1359.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu1 -->
<g id="node1178" class="node">
<title>l4_attn_stage11_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14308" cy="-1278.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14308" y="-1290.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="14308" y="-1275.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14308" y="-1260.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu1&#45;&gt;l4_attn_stage11_gpu1 -->
<g id="edge1810" class="edge">
<title>l4_attn_stage10_gpu1&#45;&gt;l4_attn_stage11_gpu1</title>
<path fill="none" stroke="black" d="M14245.19,-1397.51C14231.64,-1391.74 14217.37,-1385.76 14204,-1380.33 14192.53,-1375.67 14185.01,-1380.54 14178,-1370.33 14174.23,-1364.84 14174.04,-1360.7 14178,-1355.33 14185.18,-1345.61 14193.05,-1352.45 14204,-1347.33 14221.44,-1339.18 14239.39,-1328.49 14255.36,-1318.02"/>
<polygon fill="black" stroke="black" points="14257.64,-1320.71 14264.02,-1312.25 14253.76,-1314.89 14257.64,-1320.71"/>
</g>
<!-- l4_attn_stage10_gpu1&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge3122" class="edge">
<title>l4_attn_stage10_gpu1&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14364.99,-1395.72C14379.91,-1389.43 14396.24,-1383.66 14412,-1380.33 14434.18,-1375.65 15212.07,-1386.46 15228,-1370.33 15244.71,-1353.42 15235.21,-1325.97 15224.15,-1305.73"/>
<polygon fill="red" stroke="red" points="15227.11,-1303.87 15219.04,-1297.01 15221.07,-1307.41 15227.11,-1303.87"/>
<text text-anchor="middle" x="15267.5" y="-1359.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu2 -->
<g id="node1179" class="node">
<title>l4_attn_stage11_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="12228" cy="-1278.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12228" y="-1290.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="12228" y="-1275.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12228" y="-1260.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu2&#45;&gt;l4_attn_stage11_gpu2 -->
<g id="edge1811" class="edge">
<title>l4_attn_stage10_gpu2&#45;&gt;l4_attn_stage11_gpu2</title>
<path fill="none" stroke="black" d="M12228,-1388.24C12228,-1369.53 12228,-1346.53 12228,-1326.55"/>
<polygon fill="black" stroke="black" points="12231.5,-1326.41 12228,-1316.41 12224.5,-1326.41 12231.5,-1326.41"/>
</g>
<!-- l4_attn_stage10_gpu2&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge3123" class="edge">
<title>l4_attn_stage10_gpu2&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12284.97,-1395.64C12299.89,-1389.35 12316.23,-1383.61 12332,-1380.33 12387.38,-1368.84 14314.62,-1389.01 14368,-1370.33 14378.16,-1366.78 14376.86,-1358.92 14387,-1355.33 14421.15,-1343.24 15003.48,-1354.43 15039,-1347.33 15084.31,-1338.28 15132.97,-1317.37 15166.2,-1301.2"/>
<polygon fill="red" stroke="red" points="15168.16,-1304.14 15175.57,-1296.57 15165.06,-1297.87 15168.16,-1304.14"/>
<text text-anchor="middle" x="14418.5" y="-1359.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu3 -->
<g id="node1180" class="node">
<title>l4_attn_stage11_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14724" cy="-1278.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14724" y="-1290.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="14724" y="-1275.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14724" y="-1260.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu3&#45;&gt;l4_attn_stage11_gpu3 -->
<g id="edge1812" class="edge">
<title>l4_attn_stage10_gpu3&#45;&gt;l4_attn_stage11_gpu3</title>
<path fill="none" stroke="black" d="M14666.71,-1395.73C14651.86,-1389.47 14635.64,-1383.73 14620,-1380.33 14596.76,-1375.29 14208.62,-1387.35 14192,-1370.33 14187.34,-1365.56 14187.33,-1360.09 14192,-1355.33 14200.33,-1346.85 14608.63,-1350.82 14620,-1347.33 14639.63,-1341.32 14659.07,-1330.42 14675.73,-1319.11"/>
<polygon fill="black" stroke="black" points="14678.01,-1321.79 14684.18,-1313.18 14673.99,-1316.06 14678.01,-1321.79"/>
</g>
<!-- l4_attn_stage10_gpu3&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge3124" class="edge">
<title>l4_attn_stage10_gpu3&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14781,-1395.78C14795.92,-1389.48 14812.25,-1383.7 14828,-1380.33 14843.54,-1377.01 15388.86,-1381.67 15400,-1370.33 15436.88,-1332.8 15373.24,-1309.04 15309.37,-1295.33"/>
<polygon fill="red" stroke="red" points="15310.05,-1291.9 15299.55,-1293.3 15308.63,-1298.75 15310.05,-1291.9"/>
<text text-anchor="middle" x="15440.5" y="-1359.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu4 -->
<g id="node1181" class="node">
<title>l4_attn_stage11_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13892" cy="-1278.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13892" y="-1290.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="13892" y="-1275.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13892" y="-1260.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu4&#45;&gt;l4_attn_stage11_gpu4 -->
<g id="edge1813" class="edge">
<title>l4_attn_stage10_gpu4&#45;&gt;l4_attn_stage11_gpu4</title>
<path fill="none" stroke="black" d="M13892,-1388.24C13892,-1369.53 13892,-1346.53 13892,-1326.55"/>
<polygon fill="black" stroke="black" points="13895.5,-1326.41 13892,-1316.41 13888.5,-1326.41 13895.5,-1326.41"/>
</g>
<!-- l4_attn_stage10_gpu4&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge3125" class="edge">
<title>l4_attn_stage10_gpu4&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13948.98,-1395.69C13963.91,-1389.4 13980.24,-1383.64 13996,-1380.33 14053.64,-1368.24 15000.46,-1389.91 15056,-1370.33 15066.15,-1366.76 15066.08,-1361.35 15075,-1355.33 15104.36,-1335.51 15139.2,-1315.72 15165.72,-1301.38"/>
<polygon fill="red" stroke="red" points="15167.57,-1304.36 15174.73,-1296.55 15164.26,-1298.19 15167.57,-1304.36"/>
<text text-anchor="middle" x="15106.5" y="-1359.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu5 -->
<g id="node1182" class="node">
<title>l4_attn_stage11_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="11812" cy="-1278.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="11812" y="-1290.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="11812" y="-1275.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="11812" y="-1260.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu5&#45;&gt;l4_attn_stage11_gpu5 -->
<g id="edge1814" class="edge">
<title>l4_attn_stage10_gpu5&#45;&gt;l4_attn_stage11_gpu5</title>
<path fill="none" stroke="black" d="M11812,-1388.24C11812,-1369.53 11812,-1346.53 11812,-1326.55"/>
<polygon fill="black" stroke="black" points="11815.5,-1326.41 11812,-1316.41 11808.5,-1326.41 11815.5,-1326.41"/>
</g>
<!-- l4_attn_stage10_gpu5&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge3126" class="edge">
<title>l4_attn_stage10_gpu5&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11868.98,-1395.71C11883.91,-1389.41 11900.24,-1383.65 11916,-1380.33 12165.97,-1327.68 13959.55,-1357.96 14215,-1355.33 14260.78,-1354.86 14994.1,-1356.24 15039,-1347.33 15084.32,-1338.34 15132.98,-1317.42 15166.21,-1301.24"/>
<polygon fill="red" stroke="red" points="15168.17,-1304.17 15175.58,-1296.6 15165.06,-1297.9 15168.17,-1304.17"/>
<text text-anchor="middle" x="14246.5" y="-1359.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu6 -->
<g id="node1183" class="node">
<title>l4_attn_stage11_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14516" cy="-1278.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14516" y="-1290.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="14516" y="-1275.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14516" y="-1260.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu6&#45;&gt;l4_attn_stage11_gpu6 -->
<g id="edge1815" class="edge">
<title>l4_attn_stage10_gpu6&#45;&gt;l4_attn_stage11_gpu6</title>
<path fill="none" stroke="black" d="M14458.39,-1395.84C14443.62,-1389.62 14427.51,-1383.87 14412,-1380.33 14387.39,-1374.72 14202.45,-1388.57 14185,-1370.33 14180.39,-1365.52 14180.37,-1360.13 14185,-1355.33 14193.76,-1346.25 14399.97,-1351.13 14412,-1347.33 14431.58,-1341.16 14451,-1330.22 14467.67,-1318.92"/>
<polygon fill="black" stroke="black" points="14469.94,-1321.6 14476.13,-1313 14465.93,-1315.87 14469.94,-1321.6"/>
</g>
<!-- l4_attn_stage10_gpu6&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge3127" class="edge">
<title>l4_attn_stage10_gpu6&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14572.99,-1395.74C14587.92,-1389.45 14604.25,-1383.68 14620,-1380.33 14638.86,-1376.33 15300.47,-1384.06 15314,-1370.33 15339.62,-1344.35 15298.49,-1317.75 15260.04,-1300.17"/>
<polygon fill="red" stroke="red" points="15261.44,-1296.96 15250.88,-1296.12 15258.61,-1303.37 15261.44,-1296.96"/>
<text text-anchor="middle" x="15353.5" y="-1359.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu7 -->
<g id="node1184" class="node">
<title>l4_attn_stage11_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14100" cy="-1278.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14100" y="-1290.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="14100" y="-1275.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14100" y="-1260.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu7&#45;&gt;l4_attn_stage11_gpu7 -->
<g id="edge1816" class="edge">
<title>l4_attn_stage10_gpu7&#45;&gt;l4_attn_stage11_gpu7</title>
<path fill="none" stroke="black" d="M14100,-1388.24C14100,-1369.53 14100,-1346.53 14100,-1326.55"/>
<polygon fill="black" stroke="black" points="14103.5,-1326.41 14100,-1316.41 14096.5,-1326.41 14103.5,-1326.41"/>
</g>
<!-- l4_attn_stage10_gpu7&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge3128" class="edge">
<title>l4_attn_stage10_gpu7&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14156.98,-1395.7C14171.91,-1389.41 14188.24,-1383.65 14204,-1380.33 14229.5,-1374.97 15118.88,-1382.35 15142,-1370.33 15155.7,-1363.21 15177.58,-1329.79 15192.12,-1305.63"/>
<polygon fill="red" stroke="red" points="15195.21,-1307.29 15197.3,-1296.9 15189.19,-1303.72 15195.21,-1307.29"/>
<text text-anchor="middle" x="15189.5" y="-1359.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu8 -->
<g id="node1185" class="node">
<title>l4_attn_stage11_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="12644" cy="-1278.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12644" y="-1290.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="12644" y="-1275.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12644" y="-1260.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu8&#45;&gt;l4_attn_stage11_gpu8 -->
<g id="edge1817" class="edge">
<title>l4_attn_stage10_gpu8&#45;&gt;l4_attn_stage11_gpu8</title>
<path fill="none" stroke="black" d="M12644,-1388.24C12644,-1369.53 12644,-1346.53 12644,-1326.55"/>
<polygon fill="black" stroke="black" points="12647.5,-1326.41 12644,-1316.41 12640.5,-1326.41 12647.5,-1326.41"/>
</g>
<!-- l4_attn_stage10_gpu8&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge3129" class="edge">
<title>l4_attn_stage10_gpu8&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12700.97,-1395.65C12715.9,-1389.35 12732.23,-1383.61 12748,-1380.33 12796.74,-1370.2 14493.02,-1386.79 14540,-1370.33 14550.15,-1366.78 14548.87,-1358.95 14559,-1355.33 14609.24,-1337.42 14986.72,-1357.9 15039,-1347.33 15084.29,-1338.18 15132.96,-1317.29 15166.19,-1301.15"/>
<polygon fill="red" stroke="red" points="15168.14,-1304.09 15175.56,-1296.53 15165.05,-1297.81 15168.14,-1304.09"/>
<text text-anchor="middle" x="14590.5" y="-1359.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu9 -->
<g id="node1186" class="node">
<title>l4_attn_stage11_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="12852" cy="-1278.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12852" y="-1290.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="12852" y="-1275.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12852" y="-1260.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu9&#45;&gt;l4_attn_stage11_gpu9 -->
<g id="edge1818" class="edge">
<title>l4_attn_stage10_gpu9&#45;&gt;l4_attn_stage11_gpu9</title>
<path fill="none" stroke="black" d="M12852,-1388.24C12852,-1369.53 12852,-1346.53 12852,-1326.55"/>
<polygon fill="black" stroke="black" points="12855.5,-1326.41 12852,-1316.41 12848.5,-1326.41 12855.5,-1326.41"/>
</g>
<!-- l4_attn_stage10_gpu9&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge3130" class="edge">
<title>l4_attn_stage10_gpu9&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12908.97,-1395.65C12923.9,-1389.36 12940.23,-1383.61 12956,-1380.33 13001.42,-1370.88 14582.22,-1385.68 14626,-1370.33 14636.15,-1366.77 14634.87,-1358.96 14645,-1355.33 14686.22,-1340.55 14996.1,-1356.08 15039,-1347.33 15084.27,-1338.1 15132.94,-1317.22 15166.18,-1301.11"/>
<polygon fill="red" stroke="red" points="15168.13,-1304.05 15175.56,-1296.49 15165.04,-1297.77 15168.13,-1304.05"/>
<text text-anchor="middle" x="14676.5" y="-1359.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu10 -->
<g id="node1187" class="node">
<title>l4_attn_stage11_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12020" cy="-1278.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12020" y="-1290.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="12020" y="-1275.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12020" y="-1260.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu10&#45;&gt;l4_attn_stage11_gpu10 -->
<g id="edge1819" class="edge">
<title>l4_attn_stage10_gpu10&#45;&gt;l4_attn_stage11_gpu10</title>
<path fill="none" stroke="black" d="M12020,-1388.24C12020,-1369.53 12020,-1346.53 12020,-1326.55"/>
<polygon fill="black" stroke="black" points="12023.5,-1326.41 12020,-1316.41 12016.5,-1326.41 12023.5,-1326.41"/>
</g>
<!-- l4_attn_stage10_gpu10&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge3131" class="edge">
<title>l4_attn_stage10_gpu10&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12076.97,-1395.64C12091.89,-1389.34 12108.23,-1383.6 12124,-1380.33 12182.7,-1368.16 14225.42,-1390.12 14282,-1370.33 14292.16,-1366.78 14290.86,-1358.92 14301,-1355.33 14339.66,-1341.68 14998.79,-1355.34 15039,-1347.33 15084.31,-1338.32 15132.98,-1317.4 15166.21,-1301.22"/>
<polygon fill="red" stroke="red" points="15168.17,-1304.16 15175.58,-1296.59 15165.06,-1297.88 15168.17,-1304.16"/>
<text text-anchor="middle" x="14332.5" y="-1359.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu11 -->
<g id="node1188" class="node">
<title>l4_attn_stage11_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="12436" cy="-1278.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12436" y="-1290.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="12436" y="-1275.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12436" y="-1260.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu11&#45;&gt;l4_attn_stage11_gpu11 -->
<g id="edge1820" class="edge">
<title>l4_attn_stage10_gpu11&#45;&gt;l4_attn_stage11_gpu11</title>
<path fill="none" stroke="black" d="M12436,-1388.24C12436,-1369.53 12436,-1346.53 12436,-1326.55"/>
<polygon fill="black" stroke="black" points="12439.5,-1326.41 12436,-1316.41 12432.5,-1326.41 12439.5,-1326.41"/>
</g>
<!-- l4_attn_stage10_gpu11&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge3132" class="edge">
<title>l4_attn_stage10_gpu11&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12492.97,-1395.64C12507.9,-1389.35 12524.23,-1383.61 12540,-1380.33 12592.06,-1369.52 14403.82,-1387.9 14454,-1370.33 14464.15,-1366.78 14462.86,-1358.93 14473,-1355.33 14502.63,-1344.81 15008.17,-1353.52 15039,-1347.33 15084.3,-1338.24 15132.97,-1317.34 15166.2,-1301.18"/>
<polygon fill="red" stroke="red" points="15168.15,-1304.12 15175.57,-1296.55 15165.05,-1297.84 15168.15,-1304.12"/>
<text text-anchor="middle" x="14504.5" y="-1359.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu12 -->
<g id="node1189" class="node">
<title>l4_attn_stage11_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14932" cy="-1278.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14932" y="-1290.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="14932" y="-1275.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14932" y="-1260.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu12&#45;&gt;l4_attn_stage11_gpu12 -->
<g id="edge1821" class="edge">
<title>l4_attn_stage10_gpu12&#45;&gt;l4_attn_stage11_gpu12</title>
<path fill="none" stroke="black" d="M14875,-1395.76C14860.08,-1389.46 14843.75,-1383.69 14828,-1380.33 14810.91,-1376.69 14211.26,-1382.79 14199,-1370.33 14194.32,-1365.58 14194.32,-1360.08 14199,-1355.33 14211.28,-1342.9 14811.28,-1352.4 14828,-1347.33 14847.65,-1341.38 14867.09,-1330.49 14883.75,-1319.18"/>
<polygon fill="black" stroke="black" points="14886.03,-1321.85 14892.2,-1313.24 14882.01,-1316.13 14886.03,-1321.85"/>
</g>
<!-- l4_attn_stage10_gpu12&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge3133" class="edge">
<title>l4_attn_stage10_gpu12&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14991,-1396.41C15007.17,-1389.89 15024.95,-1383.85 15042,-1380.33 15066.16,-1375.35 15468.75,-1387.97 15486,-1370.33 15535.67,-1319.53 15448.33,-1297.22 15358.57,-1287.44"/>
<polygon fill="red" stroke="red" points="15358.78,-1283.94 15348.47,-1286.39 15358.05,-1290.91 15358.78,-1283.94"/>
<text text-anchor="middle" x="15526.5" y="-1359.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu13 -->
<g id="node1190" class="node">
<title>l4_attn_stage11_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13060" cy="-1278.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13060" y="-1290.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="13060" y="-1275.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13060" y="-1260.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu13&#45;&gt;l4_attn_stage11_gpu13 -->
<g id="edge1822" class="edge">
<title>l4_attn_stage10_gpu13&#45;&gt;l4_attn_stage11_gpu13</title>
<path fill="none" stroke="black" d="M13060,-1388.24C13060,-1369.53 13060,-1346.53 13060,-1326.55"/>
<polygon fill="black" stroke="black" points="13063.5,-1326.41 13060,-1316.41 13056.5,-1326.41 13063.5,-1326.41"/>
</g>
<!-- l4_attn_stage10_gpu13&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge3134" class="edge">
<title>l4_attn_stage10_gpu13&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13116.97,-1395.66C13131.9,-1389.36 13148.23,-1383.62 13164,-1380.33 13206.1,-1371.56 14671.42,-1384.57 14712,-1370.33 14722.15,-1366.77 14720.88,-1358.99 14731,-1355.33 14763.19,-1343.69 15005.48,-1354.27 15039,-1347.33 15084.11,-1338 15132.62,-1317.24 15165.86,-1301.18"/>
<polygon fill="red" stroke="red" points="15167.8,-1304.13 15175.24,-1296.58 15164.72,-1297.85 15167.8,-1304.13"/>
<text text-anchor="middle" x="14762.5" y="-1359.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu14 -->
<g id="node1191" class="node">
<title>l4_attn_stage11_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="13684" cy="-1278.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13684" y="-1290.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="13684" y="-1275.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13684" y="-1260.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu14&#45;&gt;l4_attn_stage11_gpu14 -->
<g id="edge1823" class="edge">
<title>l4_attn_stage10_gpu14&#45;&gt;l4_attn_stage11_gpu14</title>
<path fill="none" stroke="black" d="M13684,-1388.24C13684,-1369.53 13684,-1346.53 13684,-1326.55"/>
<polygon fill="black" stroke="black" points="13687.5,-1326.41 13684,-1316.41 13680.5,-1326.41 13687.5,-1326.41"/>
</g>
<!-- l4_attn_stage10_gpu14&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge3135" class="edge">
<title>l4_attn_stage10_gpu14&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13740.98,-1395.68C13755.9,-1389.38 13772.24,-1383.63 13788,-1380.33 13852.28,-1366.88 14908.05,-1392.13 14970,-1370.33 14980.15,-1366.76 14979.15,-1359.66 14989,-1355.33 15009.61,-1346.29 15017.31,-1353.34 15039,-1347.33 15082.28,-1335.34 15129.59,-1315.7 15162.94,-1300.69"/>
<polygon fill="red" stroke="red" points="15164.74,-1303.72 15172.4,-1296.4 15161.84,-1297.35 15164.74,-1303.72"/>
<text text-anchor="middle" x="15020.5" y="-1359.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu15 -->
<g id="node1192" class="node">
<title>l4_attn_stage11_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="13268" cy="-1278.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13268" y="-1290.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="13268" y="-1275.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13268" y="-1260.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu15&#45;&gt;l4_attn_stage11_gpu15 -->
<g id="edge1824" class="edge">
<title>l4_attn_stage10_gpu15&#45;&gt;l4_attn_stage11_gpu15</title>
<path fill="none" stroke="black" d="M13268,-1388.24C13268,-1369.53 13268,-1346.53 13268,-1326.55"/>
<polygon fill="black" stroke="black" points="13271.5,-1326.41 13268,-1316.41 13264.5,-1326.41 13271.5,-1326.41"/>
</g>
<!-- l4_attn_stage10_gpu15&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge3136" class="edge">
<title>l4_attn_stage10_gpu15&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13324.98,-1395.66C13339.9,-1389.37 13356.24,-1383.62 13372,-1380.33 13410.78,-1372.24 14760.62,-1383.46 14798,-1370.33 14808.15,-1366.77 14806.9,-1359.04 14817,-1355.33 14863.34,-1338.31 14990.71,-1357.58 15039,-1347.33 15084.06,-1337.77 15132.58,-1317.04 15165.83,-1301.06"/>
<polygon fill="red" stroke="red" points="15167.76,-1304.01 15175.22,-1296.48 15164.69,-1297.72 15167.76,-1304.01"/>
<text text-anchor="middle" x="14848.5" y="-1359.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu0 -->
<g id="node1193" class="node">
<title>l4_attn_stage12_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="13476" cy="-1131.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13476" y="-1143.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="13476" y="-1128.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13476" y="-1113.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu0&#45;&gt;l4_attn_stage12_gpu0 -->
<g id="edge1825" class="edge">
<title>l4_attn_stage11_gpu0&#45;&gt;l4_attn_stage12_gpu0</title>
<path fill="none" stroke="black" d="M13476,-1241.24C13476,-1222.53 13476,-1199.53 13476,-1179.55"/>
<polygon fill="black" stroke="black" points="13479.5,-1179.41 13476,-1169.41 13472.5,-1179.41 13479.5,-1179.41"/>
</g>
<!-- l4_attn_stage12_gpu[next_gpu] -->
<g id="node1401" class="node">
<title>l4_attn_stage12_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="15207" cy="-1131.83" rx="155.5" ry="18"/>
<text text-anchor="middle" x="15207" y="-1128.13" font-family="Times,serif" font-size="14.00">l4_attn_stage12_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage11_gpu0&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge3137" class="edge">
<title>l4_attn_stage11_gpu0&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13532.98,-1248.67C13547.9,-1242.38 13564.24,-1236.63 13580,-1233.33 13650.91,-1218.52 14815.65,-1247.35 14884,-1223.33 14894.15,-1219.77 14892.94,-1212.16 14903,-1208.33 14931.3,-1197.57 15009.46,-1206.95 15039,-1200.33 15083.67,-1190.33 15131.88,-1169.86 15165.15,-1154.08"/>
<polygon fill="red" stroke="red" points="15167.06,-1157.04 15174.55,-1149.55 15164.02,-1150.74 15167.06,-1157.04"/>
<text text-anchor="middle" x="14934.5" y="-1212.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu1 -->
<g id="node1194" class="node">
<title>l4_attn_stage12_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14308" cy="-1131.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14308" y="-1143.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="14308" y="-1128.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14308" y="-1113.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu1&#45;&gt;l4_attn_stage12_gpu1 -->
<g id="edge1826" class="edge">
<title>l4_attn_stage11_gpu1&#45;&gt;l4_attn_stage12_gpu1</title>
<path fill="none" stroke="black" d="M14245.19,-1250.51C14231.64,-1244.74 14217.37,-1238.76 14204,-1233.33 14192.53,-1228.67 14185.01,-1233.54 14178,-1223.33 14174.23,-1217.84 14174.04,-1213.7 14178,-1208.33 14185.18,-1198.61 14193.05,-1205.45 14204,-1200.33 14221.44,-1192.18 14239.39,-1181.49 14255.36,-1171.02"/>
<polygon fill="black" stroke="black" points="14257.64,-1173.71 14264.02,-1165.25 14253.76,-1167.89 14257.64,-1173.71"/>
</g>
<!-- l4_attn_stage11_gpu1&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge3138" class="edge">
<title>l4_attn_stage11_gpu1&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14364.99,-1248.72C14379.91,-1242.43 14396.24,-1236.66 14412,-1233.33 14434.18,-1228.65 15212.07,-1239.46 15228,-1223.33 15244.71,-1206.42 15235.21,-1178.97 15224.15,-1158.73"/>
<polygon fill="red" stroke="red" points="15227.11,-1156.87 15219.04,-1150.01 15221.07,-1160.41 15227.11,-1156.87"/>
<text text-anchor="middle" x="15267.5" y="-1212.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu2 -->
<g id="node1195" class="node">
<title>l4_attn_stage12_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="12228" cy="-1131.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12228" y="-1143.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="12228" y="-1128.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12228" y="-1113.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu2&#45;&gt;l4_attn_stage12_gpu2 -->
<g id="edge1827" class="edge">
<title>l4_attn_stage11_gpu2&#45;&gt;l4_attn_stage12_gpu2</title>
<path fill="none" stroke="black" d="M12228,-1241.24C12228,-1222.53 12228,-1199.53 12228,-1179.55"/>
<polygon fill="black" stroke="black" points="12231.5,-1179.41 12228,-1169.41 12224.5,-1179.41 12231.5,-1179.41"/>
</g>
<!-- l4_attn_stage11_gpu2&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge3139" class="edge">
<title>l4_attn_stage11_gpu2&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12284.97,-1248.64C12299.89,-1242.35 12316.23,-1236.61 12332,-1233.33 12387.38,-1221.84 14314.62,-1242.01 14368,-1223.33 14378.16,-1219.78 14376.86,-1211.92 14387,-1208.33 14421.15,-1196.24 15003.48,-1207.43 15039,-1200.33 15084.31,-1191.28 15132.97,-1170.37 15166.2,-1154.2"/>
<polygon fill="red" stroke="red" points="15168.16,-1157.14 15175.57,-1149.57 15165.06,-1150.87 15168.16,-1157.14"/>
<text text-anchor="middle" x="14418.5" y="-1212.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu3 -->
<g id="node1196" class="node">
<title>l4_attn_stage12_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14724" cy="-1131.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14724" y="-1143.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="14724" y="-1128.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14724" y="-1113.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu3&#45;&gt;l4_attn_stage12_gpu3 -->
<g id="edge1828" class="edge">
<title>l4_attn_stage11_gpu3&#45;&gt;l4_attn_stage12_gpu3</title>
<path fill="none" stroke="black" d="M14666.71,-1248.73C14651.86,-1242.47 14635.64,-1236.73 14620,-1233.33 14596.76,-1228.29 14208.62,-1240.35 14192,-1223.33 14187.34,-1218.56 14187.33,-1213.09 14192,-1208.33 14200.33,-1199.85 14608.63,-1203.82 14620,-1200.33 14639.63,-1194.32 14659.07,-1183.42 14675.73,-1172.11"/>
<polygon fill="black" stroke="black" points="14678.01,-1174.79 14684.18,-1166.18 14673.99,-1169.06 14678.01,-1174.79"/>
</g>
<!-- l4_attn_stage11_gpu3&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge3140" class="edge">
<title>l4_attn_stage11_gpu3&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14781,-1248.78C14795.92,-1242.48 14812.25,-1236.7 14828,-1233.33 14843.54,-1230.01 15388.86,-1234.67 15400,-1223.33 15436.88,-1185.8 15373.24,-1162.04 15309.37,-1148.33"/>
<polygon fill="red" stroke="red" points="15310.05,-1144.9 15299.55,-1146.3 15308.63,-1151.75 15310.05,-1144.9"/>
<text text-anchor="middle" x="15440.5" y="-1212.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu4 -->
<g id="node1197" class="node">
<title>l4_attn_stage12_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13892" cy="-1131.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13892" y="-1143.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="13892" y="-1128.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13892" y="-1113.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu4&#45;&gt;l4_attn_stage12_gpu4 -->
<g id="edge1829" class="edge">
<title>l4_attn_stage11_gpu4&#45;&gt;l4_attn_stage12_gpu4</title>
<path fill="none" stroke="black" d="M13892,-1241.24C13892,-1222.53 13892,-1199.53 13892,-1179.55"/>
<polygon fill="black" stroke="black" points="13895.5,-1179.41 13892,-1169.41 13888.5,-1179.41 13895.5,-1179.41"/>
</g>
<!-- l4_attn_stage11_gpu4&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge3141" class="edge">
<title>l4_attn_stage11_gpu4&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13948.98,-1248.69C13963.91,-1242.4 13980.24,-1236.64 13996,-1233.33 14053.64,-1221.24 15000.46,-1242.91 15056,-1223.33 15066.15,-1219.76 15066.08,-1214.35 15075,-1208.33 15104.36,-1188.51 15139.2,-1168.72 15165.72,-1154.38"/>
<polygon fill="red" stroke="red" points="15167.57,-1157.36 15174.73,-1149.55 15164.26,-1151.19 15167.57,-1157.36"/>
<text text-anchor="middle" x="15106.5" y="-1212.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu5 -->
<g id="node1198" class="node">
<title>l4_attn_stage12_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="11812" cy="-1131.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="11812" y="-1143.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="11812" y="-1128.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="11812" y="-1113.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu5&#45;&gt;l4_attn_stage12_gpu5 -->
<g id="edge1830" class="edge">
<title>l4_attn_stage11_gpu5&#45;&gt;l4_attn_stage12_gpu5</title>
<path fill="none" stroke="black" d="M11812,-1241.24C11812,-1222.53 11812,-1199.53 11812,-1179.55"/>
<polygon fill="black" stroke="black" points="11815.5,-1179.41 11812,-1169.41 11808.5,-1179.41 11815.5,-1179.41"/>
</g>
<!-- l4_attn_stage11_gpu5&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge3142" class="edge">
<title>l4_attn_stage11_gpu5&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11868.98,-1248.71C11883.91,-1242.41 11900.24,-1236.65 11916,-1233.33 12165.97,-1180.68 13959.55,-1210.96 14215,-1208.33 14260.78,-1207.86 14994.1,-1209.24 15039,-1200.33 15084.32,-1191.34 15132.98,-1170.42 15166.21,-1154.24"/>
<polygon fill="red" stroke="red" points="15168.17,-1157.17 15175.58,-1149.6 15165.06,-1150.9 15168.17,-1157.17"/>
<text text-anchor="middle" x="14246.5" y="-1212.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu6 -->
<g id="node1199" class="node">
<title>l4_attn_stage12_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14516" cy="-1131.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14516" y="-1143.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="14516" y="-1128.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14516" y="-1113.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu6&#45;&gt;l4_attn_stage12_gpu6 -->
<g id="edge1831" class="edge">
<title>l4_attn_stage11_gpu6&#45;&gt;l4_attn_stage12_gpu6</title>
<path fill="none" stroke="black" d="M14458.39,-1248.84C14443.62,-1242.62 14427.51,-1236.87 14412,-1233.33 14387.39,-1227.72 14202.45,-1241.57 14185,-1223.33 14180.39,-1218.52 14180.37,-1213.13 14185,-1208.33 14193.76,-1199.25 14399.97,-1204.13 14412,-1200.33 14431.58,-1194.16 14451,-1183.22 14467.67,-1171.92"/>
<polygon fill="black" stroke="black" points="14469.94,-1174.6 14476.13,-1166 14465.93,-1168.87 14469.94,-1174.6"/>
</g>
<!-- l4_attn_stage11_gpu6&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge3143" class="edge">
<title>l4_attn_stage11_gpu6&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14572.99,-1248.74C14587.92,-1242.45 14604.25,-1236.68 14620,-1233.33 14638.86,-1229.33 15300.47,-1237.06 15314,-1223.33 15339.62,-1197.35 15298.49,-1170.75 15260.04,-1153.17"/>
<polygon fill="red" stroke="red" points="15261.44,-1149.96 15250.88,-1149.12 15258.61,-1156.37 15261.44,-1149.96"/>
<text text-anchor="middle" x="15353.5" y="-1212.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu7 -->
<g id="node1200" class="node">
<title>l4_attn_stage12_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14100" cy="-1131.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14100" y="-1143.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="14100" y="-1128.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14100" y="-1113.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu7&#45;&gt;l4_attn_stage12_gpu7 -->
<g id="edge1832" class="edge">
<title>l4_attn_stage11_gpu7&#45;&gt;l4_attn_stage12_gpu7</title>
<path fill="none" stroke="black" d="M14100,-1241.24C14100,-1222.53 14100,-1199.53 14100,-1179.55"/>
<polygon fill="black" stroke="black" points="14103.5,-1179.41 14100,-1169.41 14096.5,-1179.41 14103.5,-1179.41"/>
</g>
<!-- l4_attn_stage11_gpu7&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge3144" class="edge">
<title>l4_attn_stage11_gpu7&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14156.98,-1248.7C14171.91,-1242.41 14188.24,-1236.65 14204,-1233.33 14229.5,-1227.97 15118.88,-1235.35 15142,-1223.33 15155.7,-1216.21 15177.58,-1182.79 15192.12,-1158.63"/>
<polygon fill="red" stroke="red" points="15195.21,-1160.29 15197.3,-1149.9 15189.19,-1156.72 15195.21,-1160.29"/>
<text text-anchor="middle" x="15189.5" y="-1212.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu8 -->
<g id="node1201" class="node">
<title>l4_attn_stage12_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="12644" cy="-1131.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12644" y="-1143.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="12644" y="-1128.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12644" y="-1113.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu8&#45;&gt;l4_attn_stage12_gpu8 -->
<g id="edge1833" class="edge">
<title>l4_attn_stage11_gpu8&#45;&gt;l4_attn_stage12_gpu8</title>
<path fill="none" stroke="black" d="M12644,-1241.24C12644,-1222.53 12644,-1199.53 12644,-1179.55"/>
<polygon fill="black" stroke="black" points="12647.5,-1179.41 12644,-1169.41 12640.5,-1179.41 12647.5,-1179.41"/>
</g>
<!-- l4_attn_stage11_gpu8&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge3145" class="edge">
<title>l4_attn_stage11_gpu8&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12700.97,-1248.65C12715.9,-1242.35 12732.23,-1236.61 12748,-1233.33 12796.74,-1223.2 14493.02,-1239.79 14540,-1223.33 14550.15,-1219.78 14548.87,-1211.95 14559,-1208.33 14609.24,-1190.42 14986.72,-1210.9 15039,-1200.33 15084.29,-1191.18 15132.96,-1170.29 15166.19,-1154.15"/>
<polygon fill="red" stroke="red" points="15168.14,-1157.09 15175.56,-1149.53 15165.05,-1150.81 15168.14,-1157.09"/>
<text text-anchor="middle" x="14590.5" y="-1212.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu9 -->
<g id="node1202" class="node">
<title>l4_attn_stage12_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="12852" cy="-1131.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12852" y="-1143.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="12852" y="-1128.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12852" y="-1113.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu9&#45;&gt;l4_attn_stage12_gpu9 -->
<g id="edge1834" class="edge">
<title>l4_attn_stage11_gpu9&#45;&gt;l4_attn_stage12_gpu9</title>
<path fill="none" stroke="black" d="M12852,-1241.24C12852,-1222.53 12852,-1199.53 12852,-1179.55"/>
<polygon fill="black" stroke="black" points="12855.5,-1179.41 12852,-1169.41 12848.5,-1179.41 12855.5,-1179.41"/>
</g>
<!-- l4_attn_stage11_gpu9&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge3146" class="edge">
<title>l4_attn_stage11_gpu9&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12908.97,-1248.65C12923.9,-1242.36 12940.23,-1236.61 12956,-1233.33 13001.42,-1223.88 14582.22,-1238.68 14626,-1223.33 14636.15,-1219.77 14634.87,-1211.96 14645,-1208.33 14686.22,-1193.55 14996.1,-1209.08 15039,-1200.33 15084.27,-1191.1 15132.94,-1170.22 15166.18,-1154.11"/>
<polygon fill="red" stroke="red" points="15168.13,-1157.05 15175.56,-1149.49 15165.04,-1150.77 15168.13,-1157.05"/>
<text text-anchor="middle" x="14676.5" y="-1212.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu10 -->
<g id="node1203" class="node">
<title>l4_attn_stage12_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12020" cy="-1131.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12020" y="-1143.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="12020" y="-1128.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12020" y="-1113.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu10&#45;&gt;l4_attn_stage12_gpu10 -->
<g id="edge1835" class="edge">
<title>l4_attn_stage11_gpu10&#45;&gt;l4_attn_stage12_gpu10</title>
<path fill="none" stroke="black" d="M12020,-1241.24C12020,-1222.53 12020,-1199.53 12020,-1179.55"/>
<polygon fill="black" stroke="black" points="12023.5,-1179.41 12020,-1169.41 12016.5,-1179.41 12023.5,-1179.41"/>
</g>
<!-- l4_attn_stage11_gpu10&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge3147" class="edge">
<title>l4_attn_stage11_gpu10&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12076.97,-1248.64C12091.89,-1242.34 12108.23,-1236.6 12124,-1233.33 12182.7,-1221.16 14225.42,-1243.12 14282,-1223.33 14292.16,-1219.78 14290.86,-1211.92 14301,-1208.33 14339.66,-1194.68 14998.79,-1208.34 15039,-1200.33 15084.31,-1191.32 15132.98,-1170.4 15166.21,-1154.22"/>
<polygon fill="red" stroke="red" points="15168.17,-1157.16 15175.58,-1149.59 15165.06,-1150.88 15168.17,-1157.16"/>
<text text-anchor="middle" x="14332.5" y="-1212.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu11 -->
<g id="node1204" class="node">
<title>l4_attn_stage12_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="12436" cy="-1131.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12436" y="-1143.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="12436" y="-1128.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12436" y="-1113.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu11&#45;&gt;l4_attn_stage12_gpu11 -->
<g id="edge1836" class="edge">
<title>l4_attn_stage11_gpu11&#45;&gt;l4_attn_stage12_gpu11</title>
<path fill="none" stroke="black" d="M12436,-1241.24C12436,-1222.53 12436,-1199.53 12436,-1179.55"/>
<polygon fill="black" stroke="black" points="12439.5,-1179.41 12436,-1169.41 12432.5,-1179.41 12439.5,-1179.41"/>
</g>
<!-- l4_attn_stage11_gpu11&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge3148" class="edge">
<title>l4_attn_stage11_gpu11&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12492.97,-1248.64C12507.9,-1242.35 12524.23,-1236.61 12540,-1233.33 12592.06,-1222.52 14403.82,-1240.9 14454,-1223.33 14464.15,-1219.78 14462.86,-1211.93 14473,-1208.33 14502.63,-1197.81 15008.17,-1206.52 15039,-1200.33 15084.3,-1191.24 15132.97,-1170.34 15166.2,-1154.18"/>
<polygon fill="red" stroke="red" points="15168.15,-1157.12 15175.57,-1149.55 15165.05,-1150.84 15168.15,-1157.12"/>
<text text-anchor="middle" x="14504.5" y="-1212.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu12 -->
<g id="node1205" class="node">
<title>l4_attn_stage12_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14932" cy="-1131.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14932" y="-1143.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="14932" y="-1128.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14932" y="-1113.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu12&#45;&gt;l4_attn_stage12_gpu12 -->
<g id="edge1837" class="edge">
<title>l4_attn_stage11_gpu12&#45;&gt;l4_attn_stage12_gpu12</title>
<path fill="none" stroke="black" d="M14875,-1248.76C14860.08,-1242.46 14843.75,-1236.69 14828,-1233.33 14810.91,-1229.69 14211.26,-1235.79 14199,-1223.33 14194.32,-1218.58 14194.32,-1213.08 14199,-1208.33 14211.28,-1195.9 14811.28,-1205.4 14828,-1200.33 14847.65,-1194.38 14867.09,-1183.49 14883.75,-1172.18"/>
<polygon fill="black" stroke="black" points="14886.03,-1174.85 14892.2,-1166.24 14882.01,-1169.13 14886.03,-1174.85"/>
</g>
<!-- l4_attn_stage11_gpu12&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge3149" class="edge">
<title>l4_attn_stage11_gpu12&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14991,-1249.41C15007.17,-1242.89 15024.95,-1236.85 15042,-1233.33 15066.16,-1228.35 15468.75,-1240.97 15486,-1223.33 15535.67,-1172.53 15448.33,-1150.22 15358.57,-1140.44"/>
<polygon fill="red" stroke="red" points="15358.78,-1136.94 15348.47,-1139.39 15358.05,-1143.91 15358.78,-1136.94"/>
<text text-anchor="middle" x="15526.5" y="-1212.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu13 -->
<g id="node1206" class="node">
<title>l4_attn_stage12_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13060" cy="-1131.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13060" y="-1143.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="13060" y="-1128.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13060" y="-1113.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu13&#45;&gt;l4_attn_stage12_gpu13 -->
<g id="edge1838" class="edge">
<title>l4_attn_stage11_gpu13&#45;&gt;l4_attn_stage12_gpu13</title>
<path fill="none" stroke="black" d="M13060,-1241.24C13060,-1222.53 13060,-1199.53 13060,-1179.55"/>
<polygon fill="black" stroke="black" points="13063.5,-1179.41 13060,-1169.41 13056.5,-1179.41 13063.5,-1179.41"/>
</g>
<!-- l4_attn_stage11_gpu13&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge3150" class="edge">
<title>l4_attn_stage11_gpu13&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13116.97,-1248.66C13131.9,-1242.36 13148.23,-1236.62 13164,-1233.33 13206.1,-1224.56 14671.42,-1237.57 14712,-1223.33 14722.15,-1219.77 14720.88,-1211.99 14731,-1208.33 14763.19,-1196.69 15005.48,-1207.27 15039,-1200.33 15084.11,-1191 15132.62,-1170.24 15165.86,-1154.18"/>
<polygon fill="red" stroke="red" points="15167.8,-1157.13 15175.24,-1149.58 15164.72,-1150.85 15167.8,-1157.13"/>
<text text-anchor="middle" x="14762.5" y="-1212.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu14 -->
<g id="node1207" class="node">
<title>l4_attn_stage12_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="13684" cy="-1131.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13684" y="-1143.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="13684" y="-1128.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13684" y="-1113.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu14&#45;&gt;l4_attn_stage12_gpu14 -->
<g id="edge1839" class="edge">
<title>l4_attn_stage11_gpu14&#45;&gt;l4_attn_stage12_gpu14</title>
<path fill="none" stroke="black" d="M13684,-1241.24C13684,-1222.53 13684,-1199.53 13684,-1179.55"/>
<polygon fill="black" stroke="black" points="13687.5,-1179.41 13684,-1169.41 13680.5,-1179.41 13687.5,-1179.41"/>
</g>
<!-- l4_attn_stage11_gpu14&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge3151" class="edge">
<title>l4_attn_stage11_gpu14&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13740.98,-1248.68C13755.9,-1242.38 13772.24,-1236.63 13788,-1233.33 13852.28,-1219.88 14908.05,-1245.13 14970,-1223.33 14980.15,-1219.76 14979.15,-1212.66 14989,-1208.33 15009.61,-1199.29 15017.31,-1206.34 15039,-1200.33 15082.28,-1188.34 15129.59,-1168.7 15162.94,-1153.69"/>
<polygon fill="red" stroke="red" points="15164.74,-1156.72 15172.4,-1149.4 15161.84,-1150.35 15164.74,-1156.72"/>
<text text-anchor="middle" x="15020.5" y="-1212.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu15 -->
<g id="node1208" class="node">
<title>l4_attn_stage12_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="13268" cy="-1131.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13268" y="-1143.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="13268" y="-1128.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13268" y="-1113.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu15&#45;&gt;l4_attn_stage12_gpu15 -->
<g id="edge1840" class="edge">
<title>l4_attn_stage11_gpu15&#45;&gt;l4_attn_stage12_gpu15</title>
<path fill="none" stroke="black" d="M13268,-1241.24C13268,-1222.53 13268,-1199.53 13268,-1179.55"/>
<polygon fill="black" stroke="black" points="13271.5,-1179.41 13268,-1169.41 13264.5,-1179.41 13271.5,-1179.41"/>
</g>
<!-- l4_attn_stage11_gpu15&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge3152" class="edge">
<title>l4_attn_stage11_gpu15&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13324.98,-1248.66C13339.9,-1242.37 13356.24,-1236.62 13372,-1233.33 13410.78,-1225.24 14760.62,-1236.46 14798,-1223.33 14808.15,-1219.77 14806.9,-1212.04 14817,-1208.33 14863.34,-1191.31 14990.71,-1210.58 15039,-1200.33 15084.06,-1190.77 15132.58,-1170.04 15165.83,-1154.06"/>
<polygon fill="red" stroke="red" points="15167.76,-1157.01 15175.22,-1149.48 15164.69,-1150.72 15167.76,-1157.01"/>
<text text-anchor="middle" x="14848.5" y="-1212.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu0 -->
<g id="node1209" class="node">
<title>l4_attn_stage13_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="13476" cy="-984.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13476" y="-996.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="13476" y="-981.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13476" y="-966.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu0&#45;&gt;l4_attn_stage13_gpu0 -->
<g id="edge1841" class="edge">
<title>l4_attn_stage12_gpu0&#45;&gt;l4_attn_stage13_gpu0</title>
<path fill="none" stroke="black" d="M13476,-1094.24C13476,-1075.53 13476,-1052.53 13476,-1032.55"/>
<polygon fill="black" stroke="black" points="13479.5,-1032.41 13476,-1022.41 13472.5,-1032.41 13479.5,-1032.41"/>
</g>
<!-- l4_attn_stage13_gpu[next_gpu] -->
<g id="node1402" class="node">
<title>l4_attn_stage13_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="15207" cy="-984.83" rx="155.5" ry="18"/>
<text text-anchor="middle" x="15207" y="-981.13" font-family="Times,serif" font-size="14.00">l4_attn_stage13_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage12_gpu0&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge3153" class="edge">
<title>l4_attn_stage12_gpu0&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13532.98,-1101.67C13547.9,-1095.38 13564.24,-1089.63 13580,-1086.33 13650.91,-1071.52 14815.65,-1100.35 14884,-1076.33 14894.15,-1072.77 14892.94,-1065.16 14903,-1061.33 14931.3,-1050.57 15009.46,-1059.95 15039,-1053.33 15083.67,-1043.33 15131.88,-1022.86 15165.15,-1007.08"/>
<polygon fill="red" stroke="red" points="15167.06,-1010.04 15174.55,-1002.55 15164.02,-1003.74 15167.06,-1010.04"/>
<text text-anchor="middle" x="14934.5" y="-1065.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu1 -->
<g id="node1210" class="node">
<title>l4_attn_stage13_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14308" cy="-984.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14308" y="-996.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="14308" y="-981.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14308" y="-966.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu1&#45;&gt;l4_attn_stage13_gpu1 -->
<g id="edge1842" class="edge">
<title>l4_attn_stage12_gpu1&#45;&gt;l4_attn_stage13_gpu1</title>
<path fill="none" stroke="black" d="M14245.19,-1103.51C14231.64,-1097.74 14217.37,-1091.76 14204,-1086.33 14192.53,-1081.67 14185.01,-1086.54 14178,-1076.33 14174.23,-1070.84 14174.04,-1066.7 14178,-1061.33 14185.18,-1051.61 14193.05,-1058.45 14204,-1053.33 14221.44,-1045.18 14239.39,-1034.49 14255.36,-1024.02"/>
<polygon fill="black" stroke="black" points="14257.64,-1026.71 14264.02,-1018.25 14253.76,-1020.89 14257.64,-1026.71"/>
</g>
<!-- l4_attn_stage12_gpu1&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge3154" class="edge">
<title>l4_attn_stage12_gpu1&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14364.99,-1101.72C14379.91,-1095.43 14396.24,-1089.66 14412,-1086.33 14434.18,-1081.65 15212.07,-1092.46 15228,-1076.33 15244.71,-1059.42 15235.21,-1031.97 15224.15,-1011.73"/>
<polygon fill="red" stroke="red" points="15227.11,-1009.87 15219.04,-1003.01 15221.07,-1013.41 15227.11,-1009.87"/>
<text text-anchor="middle" x="15267.5" y="-1065.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu2 -->
<g id="node1211" class="node">
<title>l4_attn_stage13_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="12228" cy="-984.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12228" y="-996.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="12228" y="-981.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12228" y="-966.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu2&#45;&gt;l4_attn_stage13_gpu2 -->
<g id="edge1843" class="edge">
<title>l4_attn_stage12_gpu2&#45;&gt;l4_attn_stage13_gpu2</title>
<path fill="none" stroke="black" d="M12228,-1094.24C12228,-1075.53 12228,-1052.53 12228,-1032.55"/>
<polygon fill="black" stroke="black" points="12231.5,-1032.41 12228,-1022.41 12224.5,-1032.41 12231.5,-1032.41"/>
</g>
<!-- l4_attn_stage12_gpu2&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge3155" class="edge">
<title>l4_attn_stage12_gpu2&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12284.97,-1101.64C12299.89,-1095.35 12316.23,-1089.61 12332,-1086.33 12387.38,-1074.84 14314.62,-1095.01 14368,-1076.33 14378.16,-1072.78 14376.86,-1064.92 14387,-1061.33 14421.15,-1049.24 15003.48,-1060.43 15039,-1053.33 15084.31,-1044.28 15132.97,-1023.37 15166.2,-1007.2"/>
<polygon fill="red" stroke="red" points="15168.16,-1010.14 15175.57,-1002.57 15165.06,-1003.87 15168.16,-1010.14"/>
<text text-anchor="middle" x="14418.5" y="-1065.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu3 -->
<g id="node1212" class="node">
<title>l4_attn_stage13_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14724" cy="-984.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14724" y="-996.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="14724" y="-981.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14724" y="-966.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu3&#45;&gt;l4_attn_stage13_gpu3 -->
<g id="edge1844" class="edge">
<title>l4_attn_stage12_gpu3&#45;&gt;l4_attn_stage13_gpu3</title>
<path fill="none" stroke="black" d="M14666.71,-1101.73C14651.86,-1095.47 14635.64,-1089.73 14620,-1086.33 14596.76,-1081.29 14208.62,-1093.35 14192,-1076.33 14187.34,-1071.56 14187.33,-1066.09 14192,-1061.33 14200.33,-1052.85 14608.63,-1056.82 14620,-1053.33 14639.63,-1047.32 14659.07,-1036.42 14675.73,-1025.11"/>
<polygon fill="black" stroke="black" points="14678.01,-1027.79 14684.18,-1019.18 14673.99,-1022.06 14678.01,-1027.79"/>
</g>
<!-- l4_attn_stage12_gpu3&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge3156" class="edge">
<title>l4_attn_stage12_gpu3&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14781,-1101.78C14795.92,-1095.48 14812.25,-1089.7 14828,-1086.33 14843.54,-1083.01 15388.86,-1087.67 15400,-1076.33 15436.88,-1038.8 15373.24,-1015.04 15309.37,-1001.33"/>
<polygon fill="red" stroke="red" points="15310.05,-997.9 15299.55,-999.3 15308.63,-1004.75 15310.05,-997.9"/>
<text text-anchor="middle" x="15440.5" y="-1065.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu4 -->
<g id="node1213" class="node">
<title>l4_attn_stage13_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13892" cy="-984.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13892" y="-996.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="13892" y="-981.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13892" y="-966.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu4&#45;&gt;l4_attn_stage13_gpu4 -->
<g id="edge1845" class="edge">
<title>l4_attn_stage12_gpu4&#45;&gt;l4_attn_stage13_gpu4</title>
<path fill="none" stroke="black" d="M13892,-1094.24C13892,-1075.53 13892,-1052.53 13892,-1032.55"/>
<polygon fill="black" stroke="black" points="13895.5,-1032.41 13892,-1022.41 13888.5,-1032.41 13895.5,-1032.41"/>
</g>
<!-- l4_attn_stage12_gpu4&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge3157" class="edge">
<title>l4_attn_stage12_gpu4&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13948.98,-1101.69C13963.91,-1095.4 13980.24,-1089.64 13996,-1086.33 14053.64,-1074.24 15000.46,-1095.91 15056,-1076.33 15066.15,-1072.76 15066.08,-1067.35 15075,-1061.33 15104.36,-1041.51 15139.2,-1021.72 15165.72,-1007.38"/>
<polygon fill="red" stroke="red" points="15167.57,-1010.36 15174.73,-1002.55 15164.26,-1004.19 15167.57,-1010.36"/>
<text text-anchor="middle" x="15106.5" y="-1065.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu5 -->
<g id="node1214" class="node">
<title>l4_attn_stage13_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="11812" cy="-984.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="11812" y="-996.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="11812" y="-981.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="11812" y="-966.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu5&#45;&gt;l4_attn_stage13_gpu5 -->
<g id="edge1846" class="edge">
<title>l4_attn_stage12_gpu5&#45;&gt;l4_attn_stage13_gpu5</title>
<path fill="none" stroke="black" d="M11812,-1094.24C11812,-1075.53 11812,-1052.53 11812,-1032.55"/>
<polygon fill="black" stroke="black" points="11815.5,-1032.41 11812,-1022.41 11808.5,-1032.41 11815.5,-1032.41"/>
</g>
<!-- l4_attn_stage12_gpu5&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge3158" class="edge">
<title>l4_attn_stage12_gpu5&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11868.98,-1101.71C11883.91,-1095.41 11900.24,-1089.65 11916,-1086.33 12165.97,-1033.68 13959.55,-1063.96 14215,-1061.33 14260.78,-1060.86 14994.1,-1062.24 15039,-1053.33 15084.32,-1044.34 15132.98,-1023.42 15166.21,-1007.24"/>
<polygon fill="red" stroke="red" points="15168.17,-1010.17 15175.58,-1002.6 15165.06,-1003.9 15168.17,-1010.17"/>
<text text-anchor="middle" x="14246.5" y="-1065.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu6 -->
<g id="node1215" class="node">
<title>l4_attn_stage13_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14516" cy="-984.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14516" y="-996.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="14516" y="-981.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14516" y="-966.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu6&#45;&gt;l4_attn_stage13_gpu6 -->
<g id="edge1847" class="edge">
<title>l4_attn_stage12_gpu6&#45;&gt;l4_attn_stage13_gpu6</title>
<path fill="none" stroke="black" d="M14458.39,-1101.84C14443.62,-1095.62 14427.51,-1089.87 14412,-1086.33 14387.39,-1080.72 14202.45,-1094.57 14185,-1076.33 14180.39,-1071.52 14180.37,-1066.13 14185,-1061.33 14193.76,-1052.25 14399.97,-1057.13 14412,-1053.33 14431.58,-1047.16 14451,-1036.22 14467.67,-1024.92"/>
<polygon fill="black" stroke="black" points="14469.94,-1027.6 14476.13,-1019 14465.93,-1021.87 14469.94,-1027.6"/>
</g>
<!-- l4_attn_stage12_gpu6&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge3159" class="edge">
<title>l4_attn_stage12_gpu6&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14572.99,-1101.74C14587.92,-1095.45 14604.25,-1089.68 14620,-1086.33 14638.86,-1082.33 15300.47,-1090.06 15314,-1076.33 15339.62,-1050.35 15298.49,-1023.75 15260.04,-1006.17"/>
<polygon fill="red" stroke="red" points="15261.44,-1002.96 15250.88,-1002.12 15258.61,-1009.37 15261.44,-1002.96"/>
<text text-anchor="middle" x="15353.5" y="-1065.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu7 -->
<g id="node1216" class="node">
<title>l4_attn_stage13_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14100" cy="-984.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14100" y="-996.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="14100" y="-981.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14100" y="-966.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu7&#45;&gt;l4_attn_stage13_gpu7 -->
<g id="edge1848" class="edge">
<title>l4_attn_stage12_gpu7&#45;&gt;l4_attn_stage13_gpu7</title>
<path fill="none" stroke="black" d="M14100,-1094.24C14100,-1075.53 14100,-1052.53 14100,-1032.55"/>
<polygon fill="black" stroke="black" points="14103.5,-1032.41 14100,-1022.41 14096.5,-1032.41 14103.5,-1032.41"/>
</g>
<!-- l4_attn_stage12_gpu7&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge3160" class="edge">
<title>l4_attn_stage12_gpu7&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14156.98,-1101.7C14171.91,-1095.41 14188.24,-1089.65 14204,-1086.33 14229.5,-1080.97 15118.88,-1088.35 15142,-1076.33 15155.7,-1069.21 15177.58,-1035.79 15192.12,-1011.63"/>
<polygon fill="red" stroke="red" points="15195.21,-1013.29 15197.3,-1002.9 15189.19,-1009.72 15195.21,-1013.29"/>
<text text-anchor="middle" x="15189.5" y="-1065.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu8 -->
<g id="node1217" class="node">
<title>l4_attn_stage13_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="12644" cy="-984.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12644" y="-996.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="12644" y="-981.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12644" y="-966.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu8&#45;&gt;l4_attn_stage13_gpu8 -->
<g id="edge1849" class="edge">
<title>l4_attn_stage12_gpu8&#45;&gt;l4_attn_stage13_gpu8</title>
<path fill="none" stroke="black" d="M12644,-1094.24C12644,-1075.53 12644,-1052.53 12644,-1032.55"/>
<polygon fill="black" stroke="black" points="12647.5,-1032.41 12644,-1022.41 12640.5,-1032.41 12647.5,-1032.41"/>
</g>
<!-- l4_attn_stage12_gpu8&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge3161" class="edge">
<title>l4_attn_stage12_gpu8&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12700.97,-1101.65C12715.9,-1095.35 12732.23,-1089.61 12748,-1086.33 12796.74,-1076.2 14493.02,-1092.79 14540,-1076.33 14550.15,-1072.78 14548.87,-1064.95 14559,-1061.33 14609.24,-1043.42 14986.72,-1063.9 15039,-1053.33 15084.29,-1044.18 15132.96,-1023.29 15166.19,-1007.15"/>
<polygon fill="red" stroke="red" points="15168.14,-1010.09 15175.56,-1002.53 15165.05,-1003.81 15168.14,-1010.09"/>
<text text-anchor="middle" x="14590.5" y="-1065.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu9 -->
<g id="node1218" class="node">
<title>l4_attn_stage13_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="12852" cy="-984.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12852" y="-996.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="12852" y="-981.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12852" y="-966.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu9&#45;&gt;l4_attn_stage13_gpu9 -->
<g id="edge1850" class="edge">
<title>l4_attn_stage12_gpu9&#45;&gt;l4_attn_stage13_gpu9</title>
<path fill="none" stroke="black" d="M12852,-1094.24C12852,-1075.53 12852,-1052.53 12852,-1032.55"/>
<polygon fill="black" stroke="black" points="12855.5,-1032.41 12852,-1022.41 12848.5,-1032.41 12855.5,-1032.41"/>
</g>
<!-- l4_attn_stage12_gpu9&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge3162" class="edge">
<title>l4_attn_stage12_gpu9&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12908.97,-1101.65C12923.9,-1095.36 12940.23,-1089.61 12956,-1086.33 13001.42,-1076.88 14582.22,-1091.68 14626,-1076.33 14636.15,-1072.77 14634.87,-1064.96 14645,-1061.33 14686.22,-1046.55 14996.1,-1062.08 15039,-1053.33 15084.27,-1044.1 15132.94,-1023.22 15166.18,-1007.11"/>
<polygon fill="red" stroke="red" points="15168.13,-1010.05 15175.56,-1002.49 15165.04,-1003.77 15168.13,-1010.05"/>
<text text-anchor="middle" x="14676.5" y="-1065.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu10 -->
<g id="node1219" class="node">
<title>l4_attn_stage13_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12020" cy="-984.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12020" y="-996.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="12020" y="-981.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12020" y="-966.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu10&#45;&gt;l4_attn_stage13_gpu10 -->
<g id="edge1851" class="edge">
<title>l4_attn_stage12_gpu10&#45;&gt;l4_attn_stage13_gpu10</title>
<path fill="none" stroke="black" d="M12020,-1094.24C12020,-1075.53 12020,-1052.53 12020,-1032.55"/>
<polygon fill="black" stroke="black" points="12023.5,-1032.41 12020,-1022.41 12016.5,-1032.41 12023.5,-1032.41"/>
</g>
<!-- l4_attn_stage12_gpu10&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge3163" class="edge">
<title>l4_attn_stage12_gpu10&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12076.97,-1101.64C12091.89,-1095.34 12108.23,-1089.6 12124,-1086.33 12182.7,-1074.16 14225.42,-1096.12 14282,-1076.33 14292.16,-1072.78 14290.86,-1064.92 14301,-1061.33 14339.66,-1047.68 14998.79,-1061.34 15039,-1053.33 15084.31,-1044.32 15132.98,-1023.4 15166.21,-1007.22"/>
<polygon fill="red" stroke="red" points="15168.17,-1010.16 15175.58,-1002.59 15165.06,-1003.88 15168.17,-1010.16"/>
<text text-anchor="middle" x="14332.5" y="-1065.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu11 -->
<g id="node1220" class="node">
<title>l4_attn_stage13_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="12436" cy="-984.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12436" y="-996.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="12436" y="-981.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12436" y="-966.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu11&#45;&gt;l4_attn_stage13_gpu11 -->
<g id="edge1852" class="edge">
<title>l4_attn_stage12_gpu11&#45;&gt;l4_attn_stage13_gpu11</title>
<path fill="none" stroke="black" d="M12436,-1094.24C12436,-1075.53 12436,-1052.53 12436,-1032.55"/>
<polygon fill="black" stroke="black" points="12439.5,-1032.41 12436,-1022.41 12432.5,-1032.41 12439.5,-1032.41"/>
</g>
<!-- l4_attn_stage12_gpu11&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge3164" class="edge">
<title>l4_attn_stage12_gpu11&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12492.97,-1101.64C12507.9,-1095.35 12524.23,-1089.61 12540,-1086.33 12592.06,-1075.52 14403.82,-1093.9 14454,-1076.33 14464.15,-1072.78 14462.86,-1064.93 14473,-1061.33 14502.63,-1050.81 15008.17,-1059.52 15039,-1053.33 15084.3,-1044.24 15132.97,-1023.34 15166.2,-1007.18"/>
<polygon fill="red" stroke="red" points="15168.15,-1010.12 15175.57,-1002.55 15165.05,-1003.84 15168.15,-1010.12"/>
<text text-anchor="middle" x="14504.5" y="-1065.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu12 -->
<g id="node1221" class="node">
<title>l4_attn_stage13_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14932" cy="-984.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14932" y="-996.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="14932" y="-981.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14932" y="-966.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu12&#45;&gt;l4_attn_stage13_gpu12 -->
<g id="edge1853" class="edge">
<title>l4_attn_stage12_gpu12&#45;&gt;l4_attn_stage13_gpu12</title>
<path fill="none" stroke="black" d="M14875,-1101.76C14860.08,-1095.46 14843.75,-1089.69 14828,-1086.33 14810.91,-1082.69 14211.26,-1088.79 14199,-1076.33 14194.32,-1071.58 14194.32,-1066.08 14199,-1061.33 14211.28,-1048.9 14811.28,-1058.4 14828,-1053.33 14847.65,-1047.38 14867.09,-1036.49 14883.75,-1025.18"/>
<polygon fill="black" stroke="black" points="14886.03,-1027.85 14892.2,-1019.24 14882.01,-1022.13 14886.03,-1027.85"/>
</g>
<!-- l4_attn_stage12_gpu12&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge3165" class="edge">
<title>l4_attn_stage12_gpu12&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14991,-1102.41C15007.17,-1095.89 15024.95,-1089.85 15042,-1086.33 15066.16,-1081.35 15468.75,-1093.97 15486,-1076.33 15535.67,-1025.53 15448.33,-1003.22 15358.57,-993.44"/>
<polygon fill="red" stroke="red" points="15358.78,-989.94 15348.47,-992.39 15358.05,-996.91 15358.78,-989.94"/>
<text text-anchor="middle" x="15526.5" y="-1065.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu13 -->
<g id="node1222" class="node">
<title>l4_attn_stage13_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13060" cy="-984.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13060" y="-996.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="13060" y="-981.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13060" y="-966.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu13&#45;&gt;l4_attn_stage13_gpu13 -->
<g id="edge1854" class="edge">
<title>l4_attn_stage12_gpu13&#45;&gt;l4_attn_stage13_gpu13</title>
<path fill="none" stroke="black" d="M13060,-1094.24C13060,-1075.53 13060,-1052.53 13060,-1032.55"/>
<polygon fill="black" stroke="black" points="13063.5,-1032.41 13060,-1022.41 13056.5,-1032.41 13063.5,-1032.41"/>
</g>
<!-- l4_attn_stage12_gpu13&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge3166" class="edge">
<title>l4_attn_stage12_gpu13&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13116.97,-1101.66C13131.9,-1095.36 13148.23,-1089.62 13164,-1086.33 13206.1,-1077.56 14671.42,-1090.57 14712,-1076.33 14722.15,-1072.77 14720.88,-1064.99 14731,-1061.33 14763.19,-1049.69 15005.48,-1060.27 15039,-1053.33 15084.11,-1044 15132.62,-1023.24 15165.86,-1007.18"/>
<polygon fill="red" stroke="red" points="15167.8,-1010.13 15175.24,-1002.58 15164.72,-1003.85 15167.8,-1010.13"/>
<text text-anchor="middle" x="14762.5" y="-1065.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu14 -->
<g id="node1223" class="node">
<title>l4_attn_stage13_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="13684" cy="-984.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13684" y="-996.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="13684" y="-981.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13684" y="-966.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu14&#45;&gt;l4_attn_stage13_gpu14 -->
<g id="edge1855" class="edge">
<title>l4_attn_stage12_gpu14&#45;&gt;l4_attn_stage13_gpu14</title>
<path fill="none" stroke="black" d="M13684,-1094.24C13684,-1075.53 13684,-1052.53 13684,-1032.55"/>
<polygon fill="black" stroke="black" points="13687.5,-1032.41 13684,-1022.41 13680.5,-1032.41 13687.5,-1032.41"/>
</g>
<!-- l4_attn_stage12_gpu14&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge3167" class="edge">
<title>l4_attn_stage12_gpu14&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13740.98,-1101.68C13755.9,-1095.38 13772.24,-1089.63 13788,-1086.33 13852.28,-1072.88 14908.05,-1098.13 14970,-1076.33 14980.15,-1072.76 14979.15,-1065.66 14989,-1061.33 15009.61,-1052.29 15017.31,-1059.34 15039,-1053.33 15082.28,-1041.34 15129.59,-1021.7 15162.94,-1006.69"/>
<polygon fill="red" stroke="red" points="15164.74,-1009.72 15172.4,-1002.4 15161.84,-1003.35 15164.74,-1009.72"/>
<text text-anchor="middle" x="15020.5" y="-1065.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu15 -->
<g id="node1224" class="node">
<title>l4_attn_stage13_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="13268" cy="-984.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13268" y="-996.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="13268" y="-981.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13268" y="-966.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu15&#45;&gt;l4_attn_stage13_gpu15 -->
<g id="edge1856" class="edge">
<title>l4_attn_stage12_gpu15&#45;&gt;l4_attn_stage13_gpu15</title>
<path fill="none" stroke="black" d="M13268,-1094.24C13268,-1075.53 13268,-1052.53 13268,-1032.55"/>
<polygon fill="black" stroke="black" points="13271.5,-1032.41 13268,-1022.41 13264.5,-1032.41 13271.5,-1032.41"/>
</g>
<!-- l4_attn_stage12_gpu15&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge3168" class="edge">
<title>l4_attn_stage12_gpu15&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13324.98,-1101.66C13339.9,-1095.37 13356.24,-1089.62 13372,-1086.33 13410.78,-1078.24 14760.62,-1089.46 14798,-1076.33 14808.15,-1072.77 14806.9,-1065.04 14817,-1061.33 14863.34,-1044.31 14990.71,-1063.58 15039,-1053.33 15084.06,-1043.77 15132.58,-1023.04 15165.83,-1007.06"/>
<polygon fill="red" stroke="red" points="15167.76,-1010.01 15175.22,-1002.48 15164.69,-1003.72 15167.76,-1010.01"/>
<text text-anchor="middle" x="14848.5" y="-1065.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu0 -->
<g id="node1225" class="node">
<title>l4_attn_stage14_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="13476" cy="-837.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13476" y="-849.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="13476" y="-834.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13476" y="-819.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu0&#45;&gt;l4_attn_stage14_gpu0 -->
<g id="edge1857" class="edge">
<title>l4_attn_stage13_gpu0&#45;&gt;l4_attn_stage14_gpu0</title>
<path fill="none" stroke="black" d="M13476,-947.24C13476,-928.53 13476,-905.53 13476,-885.55"/>
<polygon fill="black" stroke="black" points="13479.5,-885.41 13476,-875.41 13472.5,-885.41 13479.5,-885.41"/>
</g>
<!-- l4_attn_stage14_gpu[next_gpu] -->
<g id="node1403" class="node">
<title>l4_attn_stage14_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="15207" cy="-837.83" rx="155.5" ry="18"/>
<text text-anchor="middle" x="15207" y="-834.13" font-family="Times,serif" font-size="14.00">l4_attn_stage14_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage13_gpu0&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge3169" class="edge">
<title>l4_attn_stage13_gpu0&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13532.98,-954.67C13547.9,-948.38 13564.24,-942.63 13580,-939.33 13650.91,-924.52 14815.65,-953.35 14884,-929.33 14894.15,-925.77 14892.94,-918.16 14903,-914.33 14931.3,-903.57 15009.46,-912.95 15039,-906.33 15083.67,-896.33 15131.88,-875.86 15165.15,-860.08"/>
<polygon fill="red" stroke="red" points="15167.06,-863.04 15174.55,-855.55 15164.02,-856.74 15167.06,-863.04"/>
<text text-anchor="middle" x="14934.5" y="-918.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu1 -->
<g id="node1226" class="node">
<title>l4_attn_stage14_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="14308" cy="-837.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14308" y="-849.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="14308" y="-834.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14308" y="-819.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu1&#45;&gt;l4_attn_stage14_gpu1 -->
<g id="edge1858" class="edge">
<title>l4_attn_stage13_gpu1&#45;&gt;l4_attn_stage14_gpu1</title>
<path fill="none" stroke="black" d="M14245.19,-956.51C14231.64,-950.74 14217.37,-944.76 14204,-939.33 14192.53,-934.67 14185.01,-939.54 14178,-929.33 14174.23,-923.84 14174.04,-919.7 14178,-914.33 14185.18,-904.61 14193.05,-911.45 14204,-906.33 14221.44,-898.18 14239.39,-887.49 14255.36,-877.02"/>
<polygon fill="black" stroke="black" points="14257.64,-879.71 14264.02,-871.25 14253.76,-873.89 14257.64,-879.71"/>
</g>
<!-- l4_attn_stage13_gpu1&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge3170" class="edge">
<title>l4_attn_stage13_gpu1&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14364.99,-954.72C14379.91,-948.43 14396.24,-942.66 14412,-939.33 14434.18,-934.65 15212.07,-945.46 15228,-929.33 15244.71,-912.42 15235.21,-884.97 15224.15,-864.73"/>
<polygon fill="red" stroke="red" points="15227.11,-862.87 15219.04,-856.01 15221.07,-866.41 15227.11,-862.87"/>
<text text-anchor="middle" x="15267.5" y="-918.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu2 -->
<g id="node1227" class="node">
<title>l4_attn_stage14_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="12228" cy="-837.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12228" y="-849.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="12228" y="-834.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12228" y="-819.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu2&#45;&gt;l4_attn_stage14_gpu2 -->
<g id="edge1859" class="edge">
<title>l4_attn_stage13_gpu2&#45;&gt;l4_attn_stage14_gpu2</title>
<path fill="none" stroke="black" d="M12228,-947.24C12228,-928.53 12228,-905.53 12228,-885.55"/>
<polygon fill="black" stroke="black" points="12231.5,-885.41 12228,-875.41 12224.5,-885.41 12231.5,-885.41"/>
</g>
<!-- l4_attn_stage13_gpu2&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge3171" class="edge">
<title>l4_attn_stage13_gpu2&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12284.97,-954.64C12299.89,-948.35 12316.23,-942.61 12332,-939.33 12387.38,-927.84 14314.62,-948.01 14368,-929.33 14378.16,-925.78 14376.86,-917.92 14387,-914.33 14421.15,-902.24 15003.48,-913.43 15039,-906.33 15084.31,-897.28 15132.97,-876.37 15166.2,-860.2"/>
<polygon fill="red" stroke="red" points="15168.16,-863.14 15175.57,-855.57 15165.06,-856.87 15168.16,-863.14"/>
<text text-anchor="middle" x="14418.5" y="-918.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu3 -->
<g id="node1228" class="node">
<title>l4_attn_stage14_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="14724" cy="-837.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14724" y="-849.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="14724" y="-834.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14724" y="-819.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu3&#45;&gt;l4_attn_stage14_gpu3 -->
<g id="edge1860" class="edge">
<title>l4_attn_stage13_gpu3&#45;&gt;l4_attn_stage14_gpu3</title>
<path fill="none" stroke="black" d="M14666.71,-954.73C14651.86,-948.47 14635.64,-942.73 14620,-939.33 14596.76,-934.29 14208.62,-946.35 14192,-929.33 14187.34,-924.56 14187.33,-919.09 14192,-914.33 14200.33,-905.85 14608.63,-909.82 14620,-906.33 14639.63,-900.32 14659.07,-889.42 14675.73,-878.11"/>
<polygon fill="black" stroke="black" points="14678.01,-880.79 14684.18,-872.18 14673.99,-875.06 14678.01,-880.79"/>
</g>
<!-- l4_attn_stage13_gpu3&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge3172" class="edge">
<title>l4_attn_stage13_gpu3&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14781,-954.78C14795.92,-948.48 14812.25,-942.7 14828,-939.33 14843.54,-936.01 15388.86,-940.67 15400,-929.33 15436.88,-891.8 15373.24,-868.04 15309.37,-854.33"/>
<polygon fill="red" stroke="red" points="15310.05,-850.9 15299.55,-852.3 15308.63,-857.75 15310.05,-850.9"/>
<text text-anchor="middle" x="15440.5" y="-918.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu4 -->
<g id="node1229" class="node">
<title>l4_attn_stage14_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="13892" cy="-837.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13892" y="-849.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="13892" y="-834.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13892" y="-819.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu4&#45;&gt;l4_attn_stage14_gpu4 -->
<g id="edge1861" class="edge">
<title>l4_attn_stage13_gpu4&#45;&gt;l4_attn_stage14_gpu4</title>
<path fill="none" stroke="black" d="M13892,-947.24C13892,-928.53 13892,-905.53 13892,-885.55"/>
<polygon fill="black" stroke="black" points="13895.5,-885.41 13892,-875.41 13888.5,-885.41 13895.5,-885.41"/>
</g>
<!-- l4_attn_stage13_gpu4&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge3173" class="edge">
<title>l4_attn_stage13_gpu4&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13948.98,-954.69C13963.91,-948.4 13980.24,-942.64 13996,-939.33 14053.64,-927.24 15000.46,-948.91 15056,-929.33 15066.15,-925.76 15066.08,-920.35 15075,-914.33 15104.36,-894.51 15139.2,-874.72 15165.72,-860.38"/>
<polygon fill="red" stroke="red" points="15167.57,-863.36 15174.73,-855.55 15164.26,-857.19 15167.57,-863.36"/>
<text text-anchor="middle" x="15106.5" y="-918.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu5 -->
<g id="node1230" class="node">
<title>l4_attn_stage14_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="11812" cy="-837.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="11812" y="-849.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="11812" y="-834.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="11812" y="-819.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu5&#45;&gt;l4_attn_stage14_gpu5 -->
<g id="edge1862" class="edge">
<title>l4_attn_stage13_gpu5&#45;&gt;l4_attn_stage14_gpu5</title>
<path fill="none" stroke="black" d="M11812,-947.24C11812,-928.53 11812,-905.53 11812,-885.55"/>
<polygon fill="black" stroke="black" points="11815.5,-885.41 11812,-875.41 11808.5,-885.41 11815.5,-885.41"/>
</g>
<!-- l4_attn_stage13_gpu5&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge3174" class="edge">
<title>l4_attn_stage13_gpu5&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11868.98,-954.71C11883.91,-948.41 11900.24,-942.65 11916,-939.33 12165.97,-886.68 13959.55,-916.96 14215,-914.33 14260.78,-913.86 14994.1,-915.24 15039,-906.33 15084.32,-897.34 15132.98,-876.42 15166.21,-860.24"/>
<polygon fill="red" stroke="red" points="15168.17,-863.17 15175.58,-855.6 15165.06,-856.9 15168.17,-863.17"/>
<text text-anchor="middle" x="14246.5" y="-918.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu6 -->
<g id="node1231" class="node">
<title>l4_attn_stage14_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="14516" cy="-837.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14516" y="-849.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="14516" y="-834.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="14516" y="-819.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu6&#45;&gt;l4_attn_stage14_gpu6 -->
<g id="edge1863" class="edge">
<title>l4_attn_stage13_gpu6&#45;&gt;l4_attn_stage14_gpu6</title>
<path fill="none" stroke="black" d="M14458.39,-954.84C14443.62,-948.62 14427.51,-942.87 14412,-939.33 14387.39,-933.72 14202.45,-947.57 14185,-929.33 14180.39,-924.52 14180.37,-919.13 14185,-914.33 14193.76,-905.25 14399.97,-910.13 14412,-906.33 14431.58,-900.16 14451,-889.22 14467.67,-877.92"/>
<polygon fill="black" stroke="black" points="14469.94,-880.6 14476.13,-872 14465.93,-874.87 14469.94,-880.6"/>
</g>
<!-- l4_attn_stage13_gpu6&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge3175" class="edge">
<title>l4_attn_stage13_gpu6&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14572.99,-954.74C14587.92,-948.45 14604.25,-942.68 14620,-939.33 14638.86,-935.33 15300.47,-943.06 15314,-929.33 15339.62,-903.35 15298.49,-876.75 15260.04,-859.17"/>
<polygon fill="red" stroke="red" points="15261.44,-855.96 15250.88,-855.12 15258.61,-862.37 15261.44,-855.96"/>
<text text-anchor="middle" x="15353.5" y="-918.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu7 -->
<g id="node1232" class="node">
<title>l4_attn_stage14_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="14100" cy="-837.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14100" y="-849.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="14100" y="-834.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="14100" y="-819.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu7&#45;&gt;l4_attn_stage14_gpu7 -->
<g id="edge1864" class="edge">
<title>l4_attn_stage13_gpu7&#45;&gt;l4_attn_stage14_gpu7</title>
<path fill="none" stroke="black" d="M14100,-947.24C14100,-928.53 14100,-905.53 14100,-885.55"/>
<polygon fill="black" stroke="black" points="14103.5,-885.41 14100,-875.41 14096.5,-885.41 14103.5,-885.41"/>
</g>
<!-- l4_attn_stage13_gpu7&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge3176" class="edge">
<title>l4_attn_stage13_gpu7&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14156.98,-954.7C14171.91,-948.41 14188.24,-942.65 14204,-939.33 14229.5,-933.97 15118.88,-941.35 15142,-929.33 15155.7,-922.21 15177.58,-888.79 15192.12,-864.63"/>
<polygon fill="red" stroke="red" points="15195.21,-866.29 15197.3,-855.9 15189.19,-862.72 15195.21,-866.29"/>
<text text-anchor="middle" x="15189.5" y="-918.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu8 -->
<g id="node1233" class="node">
<title>l4_attn_stage14_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="12644" cy="-837.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12644" y="-849.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="12644" y="-834.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="12644" y="-819.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu8&#45;&gt;l4_attn_stage14_gpu8 -->
<g id="edge1865" class="edge">
<title>l4_attn_stage13_gpu8&#45;&gt;l4_attn_stage14_gpu8</title>
<path fill="none" stroke="black" d="M12644,-947.24C12644,-928.53 12644,-905.53 12644,-885.55"/>
<polygon fill="black" stroke="black" points="12647.5,-885.41 12644,-875.41 12640.5,-885.41 12647.5,-885.41"/>
</g>
<!-- l4_attn_stage13_gpu8&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge3177" class="edge">
<title>l4_attn_stage13_gpu8&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12700.97,-954.65C12715.9,-948.35 12732.23,-942.61 12748,-939.33 12796.74,-929.2 14493.02,-945.79 14540,-929.33 14550.15,-925.78 14548.87,-917.95 14559,-914.33 14609.24,-896.42 14986.72,-916.9 15039,-906.33 15084.29,-897.18 15132.96,-876.29 15166.19,-860.15"/>
<polygon fill="red" stroke="red" points="15168.14,-863.09 15175.56,-855.53 15165.05,-856.81 15168.14,-863.09"/>
<text text-anchor="middle" x="14590.5" y="-918.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu9 -->
<g id="node1234" class="node">
<title>l4_attn_stage14_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="12852" cy="-837.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12852" y="-849.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="12852" y="-834.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="12852" y="-819.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu9&#45;&gt;l4_attn_stage14_gpu9 -->
<g id="edge1866" class="edge">
<title>l4_attn_stage13_gpu9&#45;&gt;l4_attn_stage14_gpu9</title>
<path fill="none" stroke="black" d="M12852,-947.24C12852,-928.53 12852,-905.53 12852,-885.55"/>
<polygon fill="black" stroke="black" points="12855.5,-885.41 12852,-875.41 12848.5,-885.41 12855.5,-885.41"/>
</g>
<!-- l4_attn_stage13_gpu9&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge3178" class="edge">
<title>l4_attn_stage13_gpu9&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12908.97,-954.65C12923.9,-948.36 12940.23,-942.61 12956,-939.33 13001.42,-929.88 14582.22,-944.68 14626,-929.33 14636.15,-925.77 14634.87,-917.96 14645,-914.33 14686.22,-899.55 14996.1,-915.08 15039,-906.33 15084.27,-897.1 15132.94,-876.22 15166.18,-860.11"/>
<polygon fill="red" stroke="red" points="15168.13,-863.05 15175.56,-855.49 15165.04,-856.77 15168.13,-863.05"/>
<text text-anchor="middle" x="14676.5" y="-918.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu10 -->
<g id="node1235" class="node">
<title>l4_attn_stage14_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="12020" cy="-837.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12020" y="-849.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="12020" y="-834.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="12020" y="-819.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu10&#45;&gt;l4_attn_stage14_gpu10 -->
<g id="edge1867" class="edge">
<title>l4_attn_stage13_gpu10&#45;&gt;l4_attn_stage14_gpu10</title>
<path fill="none" stroke="black" d="M12020,-947.24C12020,-928.53 12020,-905.53 12020,-885.55"/>
<polygon fill="black" stroke="black" points="12023.5,-885.41 12020,-875.41 12016.5,-885.41 12023.5,-885.41"/>
</g>
<!-- l4_attn_stage13_gpu10&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge3179" class="edge">
<title>l4_attn_stage13_gpu10&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12076.97,-954.64C12091.89,-948.34 12108.23,-942.6 12124,-939.33 12182.7,-927.16 14225.42,-949.12 14282,-929.33 14292.16,-925.78 14290.86,-917.92 14301,-914.33 14339.66,-900.68 14998.79,-914.34 15039,-906.33 15084.31,-897.32 15132.98,-876.4 15166.21,-860.22"/>
<polygon fill="red" stroke="red" points="15168.17,-863.16 15175.58,-855.59 15165.06,-856.88 15168.17,-863.16"/>
<text text-anchor="middle" x="14332.5" y="-918.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu11 -->
<g id="node1236" class="node">
<title>l4_attn_stage14_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="12436" cy="-837.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="12436" y="-849.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="12436" y="-834.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="12436" y="-819.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu11&#45;&gt;l4_attn_stage14_gpu11 -->
<g id="edge1868" class="edge">
<title>l4_attn_stage13_gpu11&#45;&gt;l4_attn_stage14_gpu11</title>
<path fill="none" stroke="black" d="M12436,-947.24C12436,-928.53 12436,-905.53 12436,-885.55"/>
<polygon fill="black" stroke="black" points="12439.5,-885.41 12436,-875.41 12432.5,-885.41 12439.5,-885.41"/>
</g>
<!-- l4_attn_stage13_gpu11&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge3180" class="edge">
<title>l4_attn_stage13_gpu11&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12492.97,-954.64C12507.9,-948.35 12524.23,-942.61 12540,-939.33 12592.06,-928.52 14403.82,-946.9 14454,-929.33 14464.15,-925.78 14462.86,-917.93 14473,-914.33 14502.63,-903.81 15008.17,-912.52 15039,-906.33 15084.3,-897.24 15132.97,-876.34 15166.2,-860.18"/>
<polygon fill="red" stroke="red" points="15168.15,-863.12 15175.57,-855.55 15165.05,-856.84 15168.15,-863.12"/>
<text text-anchor="middle" x="14504.5" y="-918.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu12 -->
<g id="node1237" class="node">
<title>l4_attn_stage14_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="14932" cy="-837.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="14932" y="-849.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="14932" y="-834.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="14932" y="-819.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu12&#45;&gt;l4_attn_stage14_gpu12 -->
<g id="edge1869" class="edge">
<title>l4_attn_stage13_gpu12&#45;&gt;l4_attn_stage14_gpu12</title>
<path fill="none" stroke="black" d="M14875,-954.76C14860.08,-948.46 14843.75,-942.69 14828,-939.33 14810.91,-935.69 14211.26,-941.79 14199,-929.33 14194.32,-924.58 14194.32,-919.08 14199,-914.33 14211.28,-901.9 14811.28,-911.4 14828,-906.33 14847.65,-900.38 14867.09,-889.49 14883.75,-878.18"/>
<polygon fill="black" stroke="black" points="14886.03,-880.85 14892.2,-872.24 14882.01,-875.13 14886.03,-880.85"/>
</g>
<!-- l4_attn_stage13_gpu12&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge3181" class="edge">
<title>l4_attn_stage13_gpu12&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14991,-955.41C15007.17,-948.89 15024.95,-942.85 15042,-939.33 15066.16,-934.35 15468.75,-946.97 15486,-929.33 15535.67,-878.53 15448.33,-856.22 15358.57,-846.44"/>
<polygon fill="red" stroke="red" points="15358.78,-842.94 15348.47,-845.39 15358.05,-849.91 15358.78,-842.94"/>
<text text-anchor="middle" x="15526.5" y="-918.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu13 -->
<g id="node1238" class="node">
<title>l4_attn_stage14_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="13060" cy="-837.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13060" y="-849.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="13060" y="-834.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="13060" y="-819.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu13&#45;&gt;l4_attn_stage14_gpu13 -->
<g id="edge1870" class="edge">
<title>l4_attn_stage13_gpu13&#45;&gt;l4_attn_stage14_gpu13</title>
<path fill="none" stroke="black" d="M13060,-947.24C13060,-928.53 13060,-905.53 13060,-885.55"/>
<polygon fill="black" stroke="black" points="13063.5,-885.41 13060,-875.41 13056.5,-885.41 13063.5,-885.41"/>
</g>
<!-- l4_attn_stage13_gpu13&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge3182" class="edge">
<title>l4_attn_stage13_gpu13&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13116.97,-954.66C13131.9,-948.36 13148.23,-942.62 13164,-939.33 13206.1,-930.56 14671.42,-943.57 14712,-929.33 14722.15,-925.77 14720.88,-917.99 14731,-914.33 14763.19,-902.69 15005.48,-913.27 15039,-906.33 15084.11,-897 15132.62,-876.24 15165.86,-860.18"/>
<polygon fill="red" stroke="red" points="15167.8,-863.13 15175.24,-855.58 15164.72,-856.85 15167.8,-863.13"/>
<text text-anchor="middle" x="14762.5" y="-918.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu14 -->
<g id="node1239" class="node">
<title>l4_attn_stage14_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="13684" cy="-837.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13684" y="-849.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="13684" y="-834.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="13684" y="-819.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu14&#45;&gt;l4_attn_stage14_gpu14 -->
<g id="edge1871" class="edge">
<title>l4_attn_stage13_gpu14&#45;&gt;l4_attn_stage14_gpu14</title>
<path fill="none" stroke="black" d="M13684,-947.24C13684,-928.53 13684,-905.53 13684,-885.55"/>
<polygon fill="black" stroke="black" points="13687.5,-885.41 13684,-875.41 13680.5,-885.41 13687.5,-885.41"/>
</g>
<!-- l4_attn_stage13_gpu14&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge3183" class="edge">
<title>l4_attn_stage13_gpu14&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13740.98,-954.68C13755.9,-948.38 13772.24,-942.63 13788,-939.33 13852.28,-925.88 14908.05,-951.13 14970,-929.33 14980.15,-925.76 14979.15,-918.66 14989,-914.33 15009.61,-905.29 15017.31,-912.34 15039,-906.33 15082.28,-894.34 15129.59,-874.7 15162.94,-859.69"/>
<polygon fill="red" stroke="red" points="15164.74,-862.72 15172.4,-855.4 15161.84,-856.35 15164.74,-862.72"/>
<text text-anchor="middle" x="15020.5" y="-918.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu15 -->
<g id="node1240" class="node">
<title>l4_attn_stage14_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="13268" cy="-837.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="13268" y="-849.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="13268" y="-834.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="13268" y="-819.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu15&#45;&gt;l4_attn_stage14_gpu15 -->
<g id="edge1872" class="edge">
<title>l4_attn_stage13_gpu15&#45;&gt;l4_attn_stage14_gpu15</title>
<path fill="none" stroke="black" d="M13268,-947.24C13268,-928.53 13268,-905.53 13268,-885.55"/>
<polygon fill="black" stroke="black" points="13271.5,-885.41 13268,-875.41 13264.5,-885.41 13271.5,-885.41"/>
</g>
<!-- l4_attn_stage13_gpu15&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge3184" class="edge">
<title>l4_attn_stage13_gpu15&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13324.98,-954.66C13339.9,-948.37 13356.24,-942.62 13372,-939.33 13410.78,-931.24 14760.62,-942.46 14798,-929.33 14808.15,-925.77 14806.9,-918.04 14817,-914.33 14863.34,-897.31 14990.71,-916.58 15039,-906.33 15084.06,-896.77 15132.58,-876.04 15165.83,-860.06"/>
<polygon fill="red" stroke="red" points="15167.76,-863.01 15175.22,-855.48 15164.69,-856.72 15167.76,-863.01"/>
<text text-anchor="middle" x="14848.5" y="-918.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu0 -->
<g id="node1241" class="node">
<title>l4_attn_stage15_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="10329" cy="-690.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="10329" y="-702.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="10329" y="-687.13" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="10329" y="-672.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu0&#45;&gt;l4_attn_stage15_gpu0 -->
<g id="edge1873" class="edge">
<title>l4_attn_stage14_gpu0&#45;&gt;l4_attn_stage15_gpu0</title>
<path fill="none" stroke="black" d="M13419.3,-807.74C13404.31,-801.4 13387.87,-795.62 13372,-792.33 13297.47,-776.92 10707.98,-786.85 10632,-782.33 10543.12,-777.05 10516.78,-789.48 10433,-759.33 10414.03,-752.51 10395.02,-741.64 10378.53,-730.6"/>
<polygon fill="black" stroke="black" points="10380.38,-727.62 10370.16,-724.83 10376.41,-733.39 10380.38,-727.62"/>
</g>
<!-- l4_attn_stage15_gpu[next_gpu] -->
<g id="node1404" class="node">
<title>l4_attn_stage15_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="15207" cy="-690.83" rx="155.5" ry="18"/>
<text text-anchor="middle" x="15207" y="-687.13" font-family="Times,serif" font-size="14.00">l4_attn_stage15_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage14_gpu0&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge3185" class="edge">
<title>l4_attn_stage14_gpu0&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13533.31,-807.82C13548.16,-801.56 13564.37,-795.79 13580,-792.33 13648.59,-777.14 13828.01,-800.02 13896,-782.33 13910.04,-778.68 13911.01,-771.18 13925,-767.33 14130.67,-710.84 14744.99,-696.62 15042.26,-693.04"/>
<polygon fill="red" stroke="red" points="15042.31,-696.54 15052.27,-692.92 15042.23,-689.54 15042.31,-696.54"/>
<text text-anchor="middle" x="13956.5" y="-771.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu1 -->
<g id="node1242" class="node">
<title>l4_attn_stage15_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="11161" cy="-690.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="11161" y="-702.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="11161" y="-687.13" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="11161" y="-672.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu1&#45;&gt;l4_attn_stage15_gpu1 -->
<g id="edge1874" class="edge">
<title>l4_attn_stage14_gpu1&#45;&gt;l4_attn_stage15_gpu1</title>
<path fill="none" stroke="black" d="M14251.3,-807.74C14236.31,-801.4 14219.87,-795.62 14204,-792.33 14129.47,-776.92 11539.98,-786.85 11464,-782.33 11375.12,-777.05 11348.78,-789.48 11265,-759.33 11246.03,-752.51 11227.02,-741.64 11210.53,-730.6"/>
<polygon fill="black" stroke="black" points="11212.38,-727.62 11202.16,-724.83 11208.41,-733.39 11212.38,-727.62"/>
</g>
<!-- l4_attn_stage14_gpu1&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge3186" class="edge">
<title>l4_attn_stage14_gpu1&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14366.95,-808.33C14381.41,-802.26 14397.04,-796.45 14412,-792.33 14629.78,-732.47 14891.08,-708.11 15053.1,-698.31"/>
<polygon fill="red" stroke="red" points="15053.38,-701.8 15063.15,-697.71 15052.96,-694.81 15053.38,-701.8"/>
<text text-anchor="middle" x="14528.5" y="-771.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu2 -->
<g id="node1243" class="node">
<title>l4_attn_stage15_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="9081" cy="-690.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="9081" y="-702.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="9081" y="-687.13" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="9081" y="-672.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu2&#45;&gt;l4_attn_stage15_gpu2 -->
<g id="edge1875" class="edge">
<title>l4_attn_stage14_gpu2&#45;&gt;l4_attn_stage15_gpu2</title>
<path fill="none" stroke="black" d="M12171.3,-807.74C12156.31,-801.4 12139.87,-795.62 12124,-792.33 12049.47,-776.92 9459.98,-786.85 9384,-782.33 9295.12,-777.05 9268.78,-789.48 9185,-759.33 9166.03,-752.51 9147.02,-741.64 9130.53,-730.6"/>
<polygon fill="black" stroke="black" points="9132.38,-727.62 9122.16,-724.83 9128.41,-733.39 9132.38,-727.62"/>
</g>
<!-- l4_attn_stage14_gpu2&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge3187" class="edge">
<title>l4_attn_stage14_gpu2&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12285.3,-807.77C12300.15,-801.52 12316.37,-795.76 12332,-792.33 12411.26,-774.95 12616.12,-788.84 12697,-782.33 12747.06,-778.31 12758.95,-771.46 12809,-767.33 13645.56,-698.32 14651.06,-691.18 15041.11,-691.26"/>
<polygon fill="red" stroke="red" points="15041.33,-694.76 15051.34,-691.26 15041.34,-687.76 15041.33,-694.76"/>
<text text-anchor="middle" x="12840.5" y="-771.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu3 -->
<g id="node1244" class="node">
<title>l4_attn_stage15_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="11577" cy="-690.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="11577" y="-702.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="11577" y="-687.13" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11577" y="-672.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu3&#45;&gt;l4_attn_stage15_gpu3 -->
<g id="edge1876" class="edge">
<title>l4_attn_stage14_gpu3&#45;&gt;l4_attn_stage15_gpu3</title>
<path fill="none" stroke="black" d="M14667.3,-807.74C14652.31,-801.4 14635.87,-795.61 14620,-792.33 14544.3,-776.68 11914.09,-788.12 11837,-782.33 11767.11,-777.08 11746.56,-784.09 11681,-759.33 11662.31,-752.28 11643.5,-741.46 11627.11,-730.54"/>
<polygon fill="black" stroke="black" points="11629.01,-727.6 11618.78,-724.84 11625.06,-733.38 11629.01,-727.6"/>
</g>
<!-- l4_attn_stage14_gpu3&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge3188" class="edge">
<title>l4_attn_stage14_gpu3&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14785.01,-808.98C14798.99,-803.09 14813.89,-797.19 14828,-792.33 14929.63,-757.32 15050.09,-727.26 15127.48,-709.37"/>
<polygon fill="red" stroke="red" points="15128.67,-712.69 15137.63,-707.03 15127.1,-705.86 15128.67,-712.69"/>
<text text-anchor="middle" x="14931.5" y="-771.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu4 -->
<g id="node1245" class="node">
<title>l4_attn_stage15_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="10745" cy="-690.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="10745" y="-702.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="10745" y="-687.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10745" y="-672.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu4&#45;&gt;l4_attn_stage15_gpu4 -->
<g id="edge1877" class="edge">
<title>l4_attn_stage14_gpu4&#45;&gt;l4_attn_stage15_gpu4</title>
<path fill="none" stroke="black" d="M13835.03,-807.63C13820.11,-801.34 13803.77,-795.6 13788,-792.33 13717.58,-777.76 11270.87,-784.83 11199,-782.33 11043.2,-776.92 10996.94,-808.47 10849,-759.33 10829.69,-752.92 10810.46,-742.04 10793.89,-730.87"/>
<polygon fill="black" stroke="black" points="10795.68,-727.85 10785.47,-725.02 10791.69,-733.6 10795.68,-727.85"/>
</g>
<!-- l4_attn_stage14_gpu4&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge3189" class="edge">
<title>l4_attn_stage14_gpu4&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13950.62,-808.27C13965.17,-802.16 13980.91,-796.35 13996,-792.33 14033.19,-782.44 14043.87,-787.5 14082,-782.33 14125.23,-776.48 14135.66,-772.27 14179,-767.33 14490.02,-731.92 14855.96,-709.65 15056.56,-699.1"/>
<polygon fill="red" stroke="red" points="15056.78,-702.59 15066.58,-698.57 15056.41,-695.6 15056.78,-702.59"/>
<text text-anchor="middle" x="14210.5" y="-771.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu5 -->
<g id="node1246" class="node">
<title>l4_attn_stage15_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="8665" cy="-690.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="8665" y="-702.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="8665" y="-687.13" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="8665" y="-672.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu5&#45;&gt;l4_attn_stage15_gpu5 -->
<g id="edge1878" class="edge">
<title>l4_attn_stage14_gpu5&#45;&gt;l4_attn_stage15_gpu5</title>
<path fill="none" stroke="black" d="M11716.75,-836.24C11286.35,-833.36 9520.32,-819.46 8968,-782.33 8879.17,-776.36 8852.78,-789.48 8769,-759.33 8750.03,-752.51 8731.02,-741.64 8714.53,-730.6"/>
<polygon fill="black" stroke="black" points="8716.38,-727.62 8706.16,-724.83 8712.41,-733.39 8716.38,-727.62"/>
</g>
<!-- l4_attn_stage14_gpu5&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge3190" class="edge">
<title>l4_attn_stage14_gpu5&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M11869.98,-808.12C11884.67,-801.94 11900.65,-796.13 11916,-792.33 12050.18,-759.16 12087.97,-774.64 12226,-767.33 13298.62,-710.54 14590.69,-696.21 15041.93,-692.82"/>
<polygon fill="red" stroke="red" points="15042.14,-696.32 15052.11,-692.75 15042.08,-689.32 15042.14,-696.32"/>
<text text-anchor="middle" x="12257.5" y="-771.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu6 -->
<g id="node1247" class="node">
<title>l4_attn_stage15_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="11369" cy="-690.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="11369" y="-702.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="11369" y="-687.13" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11369" y="-672.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu6&#45;&gt;l4_attn_stage15_gpu6 -->
<g id="edge1879" class="edge">
<title>l4_attn_stage14_gpu6&#45;&gt;l4_attn_stage15_gpu6</title>
<path fill="none" stroke="black" d="M14459.3,-807.74C14444.31,-801.4 14427.87,-795.62 14412,-792.33 14338.31,-777.09 11778.15,-786.22 11703,-782.33 11600.41,-777.03 11569.93,-793.37 11473,-759.33 11453.98,-752.65 11434.95,-741.82 11418.47,-730.78"/>
<polygon fill="black" stroke="black" points="11420.32,-727.8 11410.1,-725 11416.34,-733.56 11420.32,-727.8"/>
</g>
<!-- l4_attn_stage14_gpu6&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge3191" class="edge">
<title>l4_attn_stage14_gpu6&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14575.61,-808.5C14589.91,-802.49 14605.31,-796.67 14620,-792.33 14776.74,-746.08 14963.69,-718.63 15083.81,-704.4"/>
<polygon fill="red" stroke="red" points="15084.25,-707.87 15093.78,-703.23 15083.44,-700.92 15084.25,-707.87"/>
<text text-anchor="middle" x="14746.5" y="-771.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu7 -->
<g id="node1248" class="node">
<title>l4_attn_stage15_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="10953" cy="-690.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="10953" y="-702.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="10953" y="-687.13" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10953" y="-672.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu7&#45;&gt;l4_attn_stage15_gpu7 -->
<g id="edge1880" class="edge">
<title>l4_attn_stage14_gpu7&#45;&gt;l4_attn_stage15_gpu7</title>
<path fill="none" stroke="black" d="M14043.3,-807.74C14028.31,-801.4 14011.87,-795.62 13996,-792.33 13922.36,-777.1 11364.1,-786.19 11289,-782.33 11185.52,-777.02 11154.78,-793.62 11057,-759.33 11037.97,-752.66 11018.95,-741.83 11002.47,-730.79"/>
<polygon fill="black" stroke="black" points="11004.31,-727.81 10994.09,-725.01 11000.34,-733.57 11004.31,-727.81"/>
</g>
<!-- l4_attn_stage14_gpu7&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge3192" class="edge">
<title>l4_attn_stage14_gpu7&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14158.96,-808.37C14173.42,-802.29 14189.05,-796.47 14204,-792.33 14283.11,-770.43 14305.44,-776.65 14387,-767.33 14627.86,-739.81 14909.42,-715.62 15072.08,-702.43"/>
<polygon fill="red" stroke="red" points="15072.46,-705.91 15082.14,-701.61 15071.89,-698.93 15072.46,-705.91"/>
<text text-anchor="middle" x="14418.5" y="-771.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu8 -->
<g id="node1249" class="node">
<title>l4_attn_stage15_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="9497" cy="-690.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="9497" y="-702.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="9497" y="-687.13" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="9497" y="-672.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu8&#45;&gt;l4_attn_stage15_gpu8 -->
<g id="edge1881" class="edge">
<title>l4_attn_stage14_gpu8&#45;&gt;l4_attn_stage15_gpu8</title>
<path fill="none" stroke="black" d="M12587.3,-807.74C12572.31,-801.4 12555.87,-795.62 12540,-792.33 12467.51,-777.33 9948.96,-785.57 9875,-782.33 9752.91,-776.99 9716.62,-798.9 9601,-759.33 9581.75,-752.75 9562.54,-741.82 9545.96,-730.66"/>
<polygon fill="black" stroke="black" points="9547.75,-727.64 9537.54,-724.82 9543.76,-733.4 9547.75,-727.64"/>
</g>
<!-- l4_attn_stage14_gpu8&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge3193" class="edge">
<title>l4_attn_stage14_gpu8&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12701,-807.8C12715.93,-801.5 12732.26,-795.72 12748,-792.33 12804.39,-780.21 13209.4,-785.41 13267,-782.33 13343.18,-778.26 13361.87,-772.29 13438,-767.33 14030.96,-728.69 14737.06,-705.36 15047.36,-696.25"/>
<polygon fill="red" stroke="red" points="15047.88,-699.73 15057.78,-695.94 15047.68,-692.74 15047.88,-699.73"/>
<text text-anchor="middle" x="13469.5" y="-771.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu9 -->
<g id="node1250" class="node">
<title>l4_attn_stage15_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="9705" cy="-690.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="9705" y="-702.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="9705" y="-687.13" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="9705" y="-672.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu9&#45;&gt;l4_attn_stage15_gpu9 -->
<g id="edge1882" class="edge">
<title>l4_attn_stage14_gpu9&#45;&gt;l4_attn_stage15_gpu9</title>
<path fill="none" stroke="black" d="M12795.3,-807.74C12780.31,-801.4 12763.87,-795.62 12748,-792.33 12674.83,-777.19 10132.64,-785.91 10058,-782.33 9946.99,-777.01 9914,-795.76 9809,-759.33 9789.95,-752.72 9770.92,-741.92 9754.44,-730.86"/>
<polygon fill="black" stroke="black" points="9756.29,-727.89 9746.07,-725.08 9752.31,-733.65 9756.29,-727.89"/>
</g>
<!-- l4_attn_stage14_gpu9&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge3194" class="edge">
<title>l4_attn_stage14_gpu9&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12909,-807.79C12923.92,-801.49 12940.25,-795.71 12956,-792.33 13015.65,-779.54 13444.22,-787.66 13505,-782.33 13547.58,-778.6 13557.48,-771.68 13600,-767.33 14125.51,-713.66 14751.67,-698.09 15042.92,-693.61"/>
<polygon fill="red" stroke="red" points="15043.19,-697.11 15053.14,-693.46 15043.09,-690.11 15043.19,-697.11"/>
<text text-anchor="middle" x="13631.5" y="-771.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu10 -->
<g id="node1251" class="node">
<title>l4_attn_stage15_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="8873" cy="-690.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="8873" y="-702.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="8873" y="-687.13" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="8873" y="-672.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu10&#45;&gt;l4_attn_stage15_gpu10 -->
<g id="edge1883" class="edge">
<title>l4_attn_stage14_gpu10&#45;&gt;l4_attn_stage15_gpu10</title>
<path fill="none" stroke="black" d="M11963.3,-807.74C11948.31,-801.4 11931.87,-795.62 11916,-792.33 11842.36,-777.1 9284.1,-786.19 9209,-782.33 9105.52,-777.02 9074.78,-793.62 8977,-759.33 8957.97,-752.66 8938.95,-741.83 8922.47,-730.79"/>
<polygon fill="black" stroke="black" points="8924.31,-727.81 8914.09,-725.01 8920.34,-733.57 8924.31,-727.81"/>
</g>
<!-- l4_attn_stage14_gpu10&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge3195" class="edge">
<title>l4_attn_stage14_gpu10&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12077.62,-807.89C12092.4,-801.68 12108.5,-795.91 12124,-792.33 12151.42,-786 12601.88,-768.44 12630,-767.33 13543.67,-731.38 14640.18,-704.73 15045.88,-695.43"/>
<polygon fill="red" stroke="red" points="15046.01,-698.93 15055.92,-695.2 15045.84,-691.93 15046.01,-698.93"/>
<text text-anchor="middle" x="12661.5" y="-771.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu11 -->
<g id="node1252" class="node">
<title>l4_attn_stage15_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="9289" cy="-690.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="9289" y="-702.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="9289" y="-687.13" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="9289" y="-672.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu11&#45;&gt;l4_attn_stage15_gpu11 -->
<g id="edge1884" class="edge">
<title>l4_attn_stage14_gpu11&#45;&gt;l4_attn_stage15_gpu11</title>
<path fill="none" stroke="black" d="M12379.3,-807.74C12364.31,-801.4 12347.87,-795.62 12332,-792.33 12258.34,-777.09 9699.12,-786.2 9624,-782.33 9520.96,-777.03 9490.35,-793.49 9393,-759.33 9373.97,-752.66 9354.95,-741.83 9338.47,-730.78"/>
<polygon fill="black" stroke="black" points="9340.31,-727.8 9330.1,-725.01 9336.34,-733.57 9340.31,-727.8"/>
</g>
<!-- l4_attn_stage14_gpu11&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge3196" class="edge">
<title>l4_attn_stage14_gpu11&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M12493.3,-807.8C12508.15,-801.54 12524.37,-795.78 12540,-792.33 12612.95,-776.25 12801.35,-785.17 12876,-782.33 13020.05,-776.86 13055.97,-773.38 13200,-767.33 13889.57,-738.4 14712.63,-709.07 15050.51,-697.26"/>
<polygon fill="red" stroke="red" points="15050.74,-700.75 15060.61,-696.91 15050.5,-693.76 15050.74,-700.75"/>
<text text-anchor="middle" x="13231.5" y="-771.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu12 -->
<g id="node1253" class="node">
<title>l4_attn_stage15_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="11785" cy="-690.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="11785" y="-702.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="11785" y="-687.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11785" y="-672.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu12&#45;&gt;l4_attn_stage15_gpu12 -->
<g id="edge1885" class="edge">
<title>l4_attn_stage14_gpu12&#45;&gt;l4_attn_stage15_gpu12</title>
<path fill="none" stroke="black" d="M14875.3,-807.74C14860.31,-801.4 14843.87,-795.62 14828,-792.33 14755.32,-777.29 12229.68,-791.33 12156,-782.33 12055.23,-770.03 11942.27,-740.06 11867.76,-717.97"/>
<polygon fill="black" stroke="black" points="11868.55,-714.55 11857.97,-715.04 11866.55,-721.26 11868.55,-714.55"/>
</g>
<!-- l4_attn_stage14_gpu12&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge3197" class="edge">
<title>l4_attn_stage14_gpu12&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M14987.98,-807.32C15040.84,-779.45 15118.84,-738.32 15166.09,-713.4"/>
<polygon fill="red" stroke="red" points="15167.91,-716.4 15175.12,-708.64 15164.64,-710.21 15167.91,-716.4"/>
<text text-anchor="middle" x="15093.5" y="-771.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu13 -->
<g id="node1254" class="node">
<title>l4_attn_stage15_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="9913" cy="-690.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="9913" y="-702.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="9913" y="-687.13" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="9913" y="-672.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu13&#45;&gt;l4_attn_stage15_gpu13 -->
<g id="edge1886" class="edge">
<title>l4_attn_stage14_gpu13&#45;&gt;l4_attn_stage15_gpu13</title>
<path fill="none" stroke="black" d="M13003.3,-807.74C12988.31,-801.4 12971.87,-795.62 12956,-792.33 12881.47,-776.92 10291.98,-786.85 10216,-782.33 10127.12,-777.05 10100.78,-789.48 10017,-759.33 9998.03,-752.51 9979.02,-741.64 9962.53,-730.6"/>
<polygon fill="black" stroke="black" points="9964.38,-727.62 9954.16,-724.83 9960.41,-733.39 9964.38,-727.62"/>
</g>
<!-- l4_attn_stage14_gpu13&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge3198" class="edge">
<title>l4_attn_stage14_gpu13&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13117.01,-807.8C13131.93,-801.51 13148.26,-795.72 13164,-792.33 13273.29,-768.8 13556.27,-797.78 13667,-782.33 13692.94,-778.71 13698.11,-771.35 13724,-767.33 13974.87,-728.37 14717.55,-704.67 15046.78,-695.81"/>
<polygon fill="red" stroke="red" points="15046.97,-699.31 15056.88,-695.54 15046.78,-692.31 15046.97,-699.31"/>
<text text-anchor="middle" x="13755.5" y="-771.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu14 -->
<g id="node1255" class="node">
<title>l4_attn_stage15_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="10537" cy="-690.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="10537" y="-702.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="10537" y="-687.13" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="10537" y="-672.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu14&#45;&gt;l4_attn_stage15_gpu14 -->
<g id="edge1887" class="edge">
<title>l4_attn_stage14_gpu14&#45;&gt;l4_attn_stage15_gpu14</title>
<path fill="none" stroke="black" d="M13627.3,-807.74C13612.31,-801.4 13595.87,-795.62 13580,-792.33 13506.53,-777.13 10953.93,-786.08 10879,-782.33 10772.86,-777.02 10741.33,-794.37 10641,-759.33 10621.96,-752.68 10602.94,-741.86 10586.46,-730.82"/>
<polygon fill="black" stroke="black" points="10588.3,-727.84 10578.08,-725.04 10584.33,-733.6 10588.3,-727.84"/>
</g>
<!-- l4_attn_stage14_gpu14&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge3199" class="edge">
<title>l4_attn_stage14_gpu14&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13741.62,-807.89C13756.4,-801.68 13772.5,-795.91 13788,-792.33 13832.23,-782.13 13948.82,-796.33 13992,-782.33 14003.61,-778.57 14003.42,-771.18 14015,-767.33 14200.58,-705.71 14759.72,-693.91 15041.25,-691.96"/>
<polygon fill="red" stroke="red" points="15041.58,-695.46 15051.56,-691.9 15041.54,-688.46 15041.58,-695.46"/>
<text text-anchor="middle" x="14046.5" y="-771.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu15 -->
<g id="node1256" class="node">
<title>l4_attn_stage15_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="10121" cy="-690.83" rx="95" ry="37.5"/>
<text text-anchor="middle" x="10121" y="-702.13" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="10121" y="-687.13" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="10121" y="-672.13" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu15&#45;&gt;l4_attn_stage15_gpu15 -->
<g id="edge1888" class="edge">
<title>l4_attn_stage14_gpu15&#45;&gt;l4_attn_stage15_gpu15</title>
<path fill="none" stroke="black" d="M13211.3,-807.74C13196.31,-801.4 13179.87,-795.62 13164,-792.33 13090.36,-777.1 10532.1,-786.19 10457,-782.33 10353.52,-777.02 10322.78,-793.62 10225,-759.33 10205.97,-752.66 10186.95,-741.83 10170.47,-730.79"/>
<polygon fill="black" stroke="black" points="10172.31,-727.81 10162.09,-725.01 10168.34,-733.57 10172.31,-727.81"/>
</g>
<!-- l4_attn_stage14_gpu15&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge3200" class="edge">
<title>l4_attn_stage14_gpu15&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M13325.29,-807.73C13340.14,-801.48 13356.36,-795.73 13372,-792.33 13463.01,-772.55 13699.72,-800.83 13791,-782.33 13808.8,-778.73 13811.26,-771.21 13829,-767.33 14056.06,-717.67 14730.46,-699.92 15043.71,-694.23"/>
<polygon fill="red" stroke="red" points="15043.85,-697.73 15053.79,-694.05 15043.72,-690.73 15043.85,-697.73"/>
<text text-anchor="middle" x="13860.5" y="-771.13" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_out_gpu0 -->
<g id="node1273" class="node">
<title>l4_attn_out_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="8559" cy="-568.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="8559" y="-587.05" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="8559" y="-572.05" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8559" y="-557.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="8559" y="-542.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu0&#45;&gt;l4_attn_out_gpu0 -->
<g id="edge1889" class="edge">
<title>l4_attn_stage15_gpu0&#45;&gt;l4_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M10271.39,-660.85C10256.61,-654.64 10240.51,-648.88 10225,-645.33 10186.1,-636.43 8977.93,-586.41 8643.86,-572.71"/>
<polygon fill="black" stroke="black" points="8643.89,-569.21 8633.76,-572.3 8643.6,-576.21 8643.89,-569.21"/>
</g>
<!-- l4_attn_out_gpu1 -->
<g id="node1274" class="node">
<title>l4_attn_out_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="11035" cy="-568.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="11035" y="-587.05" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="11035" y="-572.05" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="11035" y="-557.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="11035" y="-542.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu1&#45;&gt;l4_attn_out_gpu1 -->
<g id="edge1890" class="edge">
<title>l4_attn_stage15_gpu1&#45;&gt;l4_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M11125.57,-655.92C11112.67,-643.58 11097.85,-629.4 11083.99,-616.13"/>
<polygon fill="black" stroke="black" points="11086.05,-613.26 11076.4,-608.87 11081.21,-618.32 11086.05,-613.26"/>
</g>
<!-- l4_attn_out_gpu2 -->
<g id="node1275" class="node">
<title>l4_attn_out_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="7377" cy="-568.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="7377" y="-587.05" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="7377" y="-572.05" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7377" y="-557.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="7377" y="-542.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu2&#45;&gt;l4_attn_out_gpu2 -->
<g id="edge1891" class="edge">
<title>l4_attn_stage15_gpu2&#45;&gt;l4_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M9024.02,-660.68C9009.1,-654.38 8992.76,-648.63 8977,-645.33 8911.85,-631.7 7845.52,-637.62 7779,-635.33 7639.27,-630.53 7599.52,-654.41 7465,-616.33 7456.52,-613.93 7447.94,-610.63 7439.63,-606.87"/>
<polygon fill="black" stroke="black" points="7440.91,-603.61 7430.38,-602.47 7437.9,-609.93 7440.91,-603.61"/>
</g>
<!-- l4_attn_out_gpu3 -->
<g id="node1276" class="node">
<title>l4_attn_out_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="11436" cy="-568.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="11436" y="-587.05" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="11436" y="-572.05" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11436" y="-557.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="11436" y="-542.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu3&#45;&gt;l4_attn_out_gpu3 -->
<g id="edge1892" class="edge">
<title>l4_attn_stage15_gpu3&#45;&gt;l4_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M11538.1,-656.56C11522.69,-643.38 11504.74,-628.03 11488.22,-613.91"/>
<polygon fill="black" stroke="black" points="11490.12,-610.93 11480.25,-607.09 11485.57,-616.25 11490.12,-610.93"/>
</g>
<!-- l4_attn_out_gpu4 -->
<g id="node1277" class="node">
<title>l4_attn_out_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="10007" cy="-568.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="10007" y="-587.05" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="10007" y="-572.05" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10007" y="-557.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="10007" y="-542.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu4&#45;&gt;l4_attn_out_gpu4 -->
<g id="edge1893" class="edge">
<title>l4_attn_stage15_gpu4&#45;&gt;l4_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M10686.37,-661.31C10671.82,-655.2 10656.08,-649.38 10641,-645.33 10449.1,-593.9 10215.18,-577.19 10092.11,-571.8"/>
<polygon fill="black" stroke="black" points="10092.14,-568.29 10082,-571.37 10091.84,-575.29 10092.14,-568.29"/>
</g>
<!-- l4_attn_out_gpu5 -->
<g id="node1278" class="node">
<title>l4_attn_out_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="7026" cy="-568.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="7026" y="-587.05" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="7026" y="-572.05" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="7026" y="-557.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="7026" y="-542.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu5&#45;&gt;l4_attn_out_gpu5 -->
<g id="edge1894" class="edge">
<title>l4_attn_stage15_gpu5&#45;&gt;l4_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M8569.91,-688.58C8345.11,-685.09 7763.38,-672.86 7279,-635.33 7205.84,-629.67 7185.08,-638.09 7115,-616.33 7106.42,-613.67 7097.69,-610.18 7089.23,-606.3"/>
<polygon fill="black" stroke="black" points="7090.7,-603.12 7080.17,-601.95 7087.67,-609.43 7090.7,-603.12"/>
</g>
<!-- l4_attn_out_gpu6 -->
<g id="node1279" class="node">
<title>l4_attn_out_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="11233" cy="-568.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="11233" y="-587.05" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="11233" y="-572.05" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11233" y="-557.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="11233" y="-542.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu6&#45;&gt;l4_attn_out_gpu6 -->
<g id="edge1895" class="edge">
<title>l4_attn_stage15_gpu6&#45;&gt;l4_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M11331.12,-656.24C11316.53,-643.31 11299.62,-628.32 11283.99,-614.46"/>
<polygon fill="black" stroke="black" points="11286.24,-611.78 11276.44,-607.77 11281.6,-617.02 11286.24,-611.78"/>
</g>
<!-- l4_attn_out_gpu7 -->
<g id="node1280" class="node">
<title>l4_attn_out_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="10847" cy="-568.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="10847" y="-587.05" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="10847" y="-572.05" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10847" y="-557.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="10847" y="-542.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu7&#45;&gt;l4_attn_out_gpu7 -->
<g id="edge1896" class="edge">
<title>l4_attn_stage15_gpu7&#45;&gt;l4_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M10922.62,-655.28C10912.49,-643.75 10901,-630.68 10890.09,-618.27"/>
<polygon fill="black" stroke="black" points="10892.62,-615.85 10883.39,-610.65 10887.36,-620.47 10892.62,-615.85"/>
</g>
<!-- l4_attn_out_gpu8 -->
<g id="node1281" class="node">
<title>l4_attn_out_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="7732" cy="-568.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="7732" y="-587.05" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="7732" y="-572.05" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7732" y="-557.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="7732" y="-542.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu8&#45;&gt;l4_attn_out_gpu8 -->
<g id="edge1897" class="edge">
<title>l4_attn_stage15_gpu8&#45;&gt;l4_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M9440.02,-660.69C9425.1,-654.39 9408.76,-648.64 9393,-645.33 9334.55,-633.07 8377.7,-637.15 8318,-635.33 8154.3,-630.35 8112.35,-637.91 7950,-616.33 7903.55,-610.16 7852.3,-599.3 7811.16,-589.57"/>
<polygon fill="black" stroke="black" points="7811.74,-586.11 7801.21,-587.18 7810.12,-592.91 7811.74,-586.11"/>
</g>
<!-- l4_attn_out_gpu9 -->
<g id="node1282" class="node">
<title>l4_attn_out_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="8034" cy="-568.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="8034" y="-587.05" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="8034" y="-572.05" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="8034" y="-557.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="8034" y="-542.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu9&#45;&gt;l4_attn_out_gpu9 -->
<g id="edge1898" class="edge">
<title>l4_attn_stage15_gpu9&#45;&gt;l4_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M9648.02,-660.7C9633.09,-654.4 9616.76,-648.65 9601,-645.33 9547.23,-634.03 8666.93,-636.68 8612,-635.33 8503.51,-632.67 8228.87,-644.28 8124,-616.33 8114.89,-613.91 8105.67,-610.44 8096.77,-606.48"/>
<polygon fill="black" stroke="black" points="8098.17,-603.27 8087.63,-602.19 8095.2,-609.61 8098.17,-603.27"/>
</g>
<!-- l4_attn_out_gpu10 -->
<g id="node1283" class="node">
<title>l4_attn_out_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="7199" cy="-568.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="7199" y="-587.05" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="7199" y="-572.05" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="7199" y="-557.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="7199" y="-542.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu10&#45;&gt;l4_attn_out_gpu10 -->
<g id="edge1899" class="edge">
<title>l4_attn_stage15_gpu10&#45;&gt;l4_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M8816.02,-660.68C8801.1,-654.38 8784.76,-648.63 8769,-645.33 8703.91,-631.71 7638.45,-637.87 7572,-635.33 7447.8,-630.59 7412.91,-649.03 7293,-616.33 7282.99,-613.6 7272.79,-609.77 7262.98,-605.45"/>
<polygon fill="black" stroke="black" points="7264.26,-602.18 7253.72,-601.18 7261.33,-608.54 7264.26,-602.18"/>
</g>
<!-- l4_attn_out_gpu11 -->
<g id="node1284" class="node">
<title>l4_attn_out_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="7549" cy="-568.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="7549" y="-587.05" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="7549" y="-572.05" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7549" y="-557.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="7549" y="-542.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu11&#45;&gt;l4_attn_out_gpu11 -->
<g id="edge1900" class="edge">
<title>l4_attn_stage15_gpu11&#45;&gt;l4_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M9232.02,-660.68C9217.1,-654.39 9200.76,-648.64 9185,-645.33 9123.17,-632.38 8111.14,-637.11 8048,-635.33 7870.09,-630.33 7820.63,-659.62 7648,-616.33 7636.68,-613.49 7625.1,-609.31 7614.04,-604.6"/>
<polygon fill="black" stroke="black" points="7615.44,-601.39 7604.88,-600.53 7612.6,-607.79 7615.44,-601.39"/>
</g>
<!-- l4_attn_out_gpu12 -->
<g id="node1285" class="node">
<title>l4_attn_out_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="11641" cy="-568.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="11641" y="-587.05" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="11641" y="-572.05" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11641" y="-557.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="11641" y="-542.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu12&#45;&gt;l4_attn_out_gpu12 -->
<g id="edge1901" class="edge">
<title>l4_attn_stage15_gpu12&#45;&gt;l4_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M11745.27,-656.56C11729.32,-643.2 11710.7,-627.61 11693.64,-613.33"/>
<polygon fill="black" stroke="black" points="11695.84,-610.61 11685.93,-606.87 11691.35,-615.98 11695.84,-610.61"/>
</g>
<!-- l4_attn_out_gpu13 -->
<g id="node1286" class="node">
<title>l4_attn_out_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="8208" cy="-568.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="8208" y="-587.05" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="8208" y="-572.05" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="8208" y="-557.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="8208" y="-542.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu13&#45;&gt;l4_attn_out_gpu13 -->
<g id="edge1902" class="edge">
<title>l4_attn_stage15_gpu13&#45;&gt;l4_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M9856.01,-660.73C9841.09,-654.43 9824.75,-648.67 9809,-645.33 9766.6,-636.36 9072.33,-636.18 9029,-635.33 8948.21,-633.76 8380.39,-635.95 8302,-616.33 8291.87,-613.8 8281.57,-610.04 8271.69,-605.74"/>
<polygon fill="black" stroke="black" points="8272.91,-602.45 8262.36,-601.47 8269.99,-608.82 8272.91,-602.45"/>
</g>
<!-- l4_attn_out_gpu14 -->
<g id="node1287" class="node">
<title>l4_attn_out_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="9782" cy="-568.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="9782" y="-587.05" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="9782" y="-572.05" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="9782" y="-557.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="9782" y="-542.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu14&#45;&gt;l4_attn_out_gpu14 -->
<g id="edge1903" class="edge">
<title>l4_attn_stage15_gpu14&#45;&gt;l4_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M10479.36,-660.98C10464.58,-654.76 10448.49,-648.97 10433,-645.33 10211.97,-593.45 10145.97,-659.11 9923,-616.33 9900.47,-612.01 9876.59,-605.01 9855.01,-597.72"/>
<polygon fill="black" stroke="black" points="9855.86,-594.31 9845.27,-594.36 9853.58,-600.93 9855.86,-594.31"/>
</g>
<!-- l4_attn_out_gpu15 -->
<g id="node1288" class="node">
<title>l4_attn_out_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="8386" cy="-568.25" rx="75" ry="48.17"/>
<text text-anchor="middle" x="8386" y="-587.05" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="8386" y="-572.05" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8386" y="-557.05" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="8386" y="-542.05" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu15&#45;&gt;l4_attn_out_gpu15 -->
<g id="edge1904" class="edge">
<title>l4_attn_stage15_gpu15&#45;&gt;l4_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M10064,-660.79C10049.07,-654.5 10032.74,-648.71 10017,-645.33 9933.23,-627.34 8557.96,-637.76 8475,-616.33 8465.96,-614 8456.81,-610.59 8448,-606.65"/>
<polygon fill="black" stroke="black" points="8449.49,-603.48 8438.95,-602.38 8446.5,-609.81 8449.49,-603.48"/>
</g>
<!-- l4_qkv_gpu0&#45;&gt;l4_attn_stage0_gpu0 -->
<g id="edge1633" class="edge">
<title>l4_qkv_gpu0&#45;&gt;l4_attn_stage0_gpu0</title>
<path fill="none" stroke="black" d="M13543.86,-2991.66C13548.82,-2976.07 13554.33,-2958.71 13559.28,-2943.15"/>
<polygon fill="black" stroke="black" points="13562.74,-2943.81 13562.43,-2933.22 13556.07,-2941.69 13562.74,-2943.81"/>
</g>
<!-- l4_qkv_gpu1&#45;&gt;l4_attn_stage0_gpu1 -->
<g id="edge1634" class="edge">
<title>l4_qkv_gpu1&#45;&gt;l4_attn_stage0_gpu1</title>
<path fill="none" stroke="black" d="M14342.66,-2991.27C14344.5,-2975.98 14346.53,-2959.02 14348.37,-2943.74"/>
<polygon fill="black" stroke="black" points="14351.88,-2943.82 14349.6,-2933.48 14344.93,-2942.99 14351.88,-2943.82"/>
</g>
<!-- l4_qkv_gpu2&#45;&gt;l4_attn_stage0_gpu2 -->
<g id="edge1635" class="edge">
<title>l4_qkv_gpu2&#45;&gt;l4_attn_stage0_gpu2</title>
<path fill="none" stroke="black" d="M12344.77,-2993.23C12355,-2976.57 12366.59,-2957.72 12376.78,-2941.14"/>
<polygon fill="black" stroke="black" points="12380.02,-2942.54 12382.28,-2932.19 12374.06,-2938.87 12380.02,-2942.54"/>
</g>
<!-- l4_qkv_gpu3&#45;&gt;l4_attn_stage0_gpu3 -->
<g id="edge1636" class="edge">
<title>l4_qkv_gpu3&#45;&gt;l4_attn_stage0_gpu3</title>
<path fill="none" stroke="black" d="M14742,-2991.27C14742.32,-2975.98 14742.68,-2959.02 14743.01,-2943.74"/>
<polygon fill="black" stroke="black" points="14746.51,-2943.55 14743.22,-2933.48 14739.51,-2943.4 14746.51,-2943.55"/>
</g>
<!-- l4_qkv_gpu4&#45;&gt;l4_attn_stage0_gpu4 -->
<g id="edge1637" class="edge">
<title>l4_qkv_gpu4&#45;&gt;l4_attn_stage0_gpu4</title>
<path fill="none" stroke="black" d="M13943.32,-2991.27C13946.7,-2975.83 13950.46,-2958.69 13953.83,-2943.3"/>
<polygon fill="black" stroke="black" points="13957.26,-2943.99 13955.98,-2933.48 13950.42,-2942.5 13957.26,-2943.99"/>
</g>
<!-- l4_qkv_gpu5&#45;&gt;l4_attn_stage0_gpu5 -->
<g id="edge1638" class="edge">
<title>l4_qkv_gpu5&#45;&gt;l4_attn_stage0_gpu5</title>
<path fill="none" stroke="black" d="M11944.68,-2994.01C11956.91,-2976.86 11970.86,-2957.31 11983.02,-2940.26"/>
<polygon fill="black" stroke="black" points="11985.88,-2942.28 11988.83,-2932.11 11980.18,-2938.22 11985.88,-2942.28"/>
</g>
<!-- l4_qkv_gpu6&#45;&gt;l4_attn_stage0_gpu6 -->
<g id="edge1639" class="edge">
<title>l4_qkv_gpu6&#45;&gt;l4_attn_stage0_gpu6</title>
<path fill="none" stroke="black" d="M14542.33,-2991.27C14543.41,-2975.98 14544.61,-2959.02 14545.69,-2943.74"/>
<polygon fill="black" stroke="black" points="14549.2,-2943.7 14546.41,-2933.48 14542.22,-2943.2 14549.2,-2943.7"/>
</g>
<!-- l4_qkv_gpu7&#45;&gt;l4_attn_stage0_gpu7 -->
<g id="edge1640" class="edge">
<title>l4_qkv_gpu7&#45;&gt;l4_attn_stage0_gpu7</title>
<path fill="none" stroke="black" d="M14142.99,-2991.27C14145.58,-2975.98 14148.46,-2959.02 14151.05,-2943.74"/>
<polygon fill="black" stroke="black" points="14154.57,-2943.92 14152.79,-2933.48 14147.67,-2942.75 14154.57,-2943.92"/>
</g>
<!-- l4_qkv_gpu8&#45;&gt;l4_attn_stage0_gpu8 -->
<g id="edge1641" class="edge">
<title>l4_qkv_gpu8&#45;&gt;l4_attn_stage0_gpu8</title>
<path fill="none" stroke="black" d="M12744.5,-2992.84C12752.86,-2976.62 12762.27,-2958.37 12770.62,-2942.17"/>
<polygon fill="black" stroke="black" points="12773.93,-2943.4 12775.4,-2932.9 12767.71,-2940.19 12773.93,-2943.4"/>
</g>
<!-- l4_qkv_gpu9&#45;&gt;l4_attn_stage0_gpu9 -->
<g id="edge1642" class="edge">
<title>l4_qkv_gpu9&#45;&gt;l4_attn_stage0_gpu9</title>
<path fill="none" stroke="black" d="M12944.43,-2992.45C12951.98,-2976.25 12960.46,-2958.06 12967.97,-2941.94"/>
<polygon fill="black" stroke="black" points="12971.22,-2943.25 12972.28,-2932.71 12964.88,-2940.29 12971.22,-2943.25"/>
</g>
<!-- l4_qkv_gpu10&#45;&gt;l4_attn_stage0_gpu10 -->
<g id="edge1643" class="edge">
<title>l4_qkv_gpu10&#45;&gt;l4_attn_stage0_gpu10</title>
<path fill="none" stroke="black" d="M12144.74,-2993.62C12155.92,-2976.79 12168.61,-2957.67 12179.74,-2940.91"/>
<polygon fill="black" stroke="black" points="12182.79,-2942.64 12185.4,-2932.38 12176.95,-2938.77 12182.79,-2942.64"/>
</g>
<!-- l4_qkv_gpu11&#45;&gt;l4_attn_stage0_gpu11 -->
<g id="edge1644" class="edge">
<title>l4_qkv_gpu11&#45;&gt;l4_attn_stage0_gpu11</title>
<path fill="none" stroke="black" d="M12544.75,-2992.84C12554.08,-2976.33 12564.59,-2957.72 12573.87,-2941.31"/>
<polygon fill="black" stroke="black" points="12577,-2942.88 12578.88,-2932.45 12570.91,-2939.43 12577,-2942.88"/>
</g>
<!-- l4_qkv_gpu12&#45;&gt;l4_attn_stage0_gpu12 -->
<g id="edge1645" class="edge">
<title>l4_qkv_gpu12&#45;&gt;l4_attn_stage0_gpu12</title>
<path fill="none" stroke="black" d="M14941.67,-2991.27C14941.24,-2975.98 14940.76,-2959.02 14940.33,-2943.74"/>
<polygon fill="black" stroke="black" points="14943.82,-2943.37 14940.04,-2933.48 14936.82,-2943.57 14943.82,-2943.37"/>
</g>
<!-- l4_qkv_gpu13&#45;&gt;l4_attn_stage0_gpu13 -->
<g id="edge1646" class="edge">
<title>l4_qkv_gpu13&#45;&gt;l4_attn_stage0_gpu13</title>
<path fill="none" stroke="black" d="M13144.32,-2992.06C13150.94,-2976.16 13158.35,-2958.39 13164.95,-2942.55"/>
<polygon fill="black" stroke="black" points="13168.33,-2943.54 13168.94,-2932.97 13161.87,-2940.85 13168.33,-2943.54"/>
</g>
<!-- l4_qkv_gpu14&#45;&gt;l4_attn_stage0_gpu14 -->
<g id="edge1647" class="edge">
<title>l4_qkv_gpu14&#45;&gt;l4_attn_stage0_gpu14</title>
<path fill="none" stroke="black" d="M13743.55,-2991.66C13747.73,-2976.07 13752.39,-2958.71 13756.57,-2943.15"/>
<polygon fill="black" stroke="black" points="13760.02,-2943.79 13759.23,-2933.22 13753.26,-2941.97 13760.02,-2943.79"/>
</g>
<!-- l4_qkv_gpu15&#45;&gt;l4_attn_stage0_gpu15 -->
<g id="edge1648" class="edge">
<title>l4_qkv_gpu15&#45;&gt;l4_attn_stage0_gpu15</title>
<path fill="none" stroke="black" d="M13344.03,-2992.06C13349.86,-2976.16 13356.39,-2958.39 13362.21,-2942.55"/>
<polygon fill="black" stroke="black" points="13365.57,-2943.56 13365.73,-2932.97 13359,-2941.15 13365.57,-2943.56"/>
</g>
<!-- l4_gate_gpu0 -->
<g id="node1289" class="node">
<title>l4_gate_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="8426" cy="-445.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="8426" y="-456.97" font-family="Times,serif" font-size="14.00">L4 Gate</text>
<text text-anchor="middle" x="8426" y="-441.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8426" y="-426.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l4_attn_out_gpu0&#45;&gt;l4_gate_gpu0 -->
<g id="edge1905" class="edge">
<title>l4_attn_out_gpu0&#45;&gt;l4_gate_gpu0</title>
<path fill="none" stroke="black" d="M8516.19,-528.43C8501.31,-514.95 8484.62,-499.82 8469.68,-486.27"/>
<polygon fill="black" stroke="black" points="8471.8,-483.47 8462.04,-479.35 8467.1,-488.66 8471.8,-483.47"/>
</g>
<!-- l4_gate_gpu1 -->
<g id="node1314" class="node">
<title>l4_gate_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="9138" cy="-445.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="9138" y="-456.97" font-family="Times,serif" font-size="14.00">L4 Gate</text>
<text text-anchor="middle" x="9138" y="-441.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9138" y="-426.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l4_attn_out_gpu1&#45;&gt;l4_gate_gpu1 -->
<g id="edge1930" class="edge">
<title>l4_attn_out_gpu1&#45;&gt;l4_gate_gpu1</title>
<path fill="none" stroke="black" d="M10978.44,-536.57C10963.44,-529.86 10946.96,-523.71 10931,-520.17 10847.74,-501.69 9481.12,-507.44 9396,-502.17 9320.56,-497.5 9300.22,-501.91 9227,-483.17 9219.29,-481.19 9211.37,-478.69 9203.59,-475.93"/>
<polygon fill="black" stroke="black" points="9204.77,-472.63 9194.18,-472.44 9202.34,-479.2 9204.77,-472.63"/>
</g>
<!-- l4_gate_gpu2 -->
<g id="node1315" class="node">
<title>l4_gate_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="7358" cy="-445.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="7358" y="-456.97" font-family="Times,serif" font-size="14.00">L4 Gate</text>
<text text-anchor="middle" x="7358" y="-441.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="7358" y="-426.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l4_attn_out_gpu2&#45;&gt;l4_gate_gpu2 -->
<g id="edge1955" class="edge">
<title>l4_attn_out_gpu2&#45;&gt;l4_gate_gpu2</title>
<path fill="none" stroke="black" d="M7369.6,-520.28C7368.21,-511.44 7366.75,-502.2 7365.36,-493.37"/>
<polygon fill="black" stroke="black" points="7368.78,-492.57 7363.76,-483.24 7361.86,-493.66 7368.78,-492.57"/>
</g>
<!-- l4_gate_gpu3 -->
<g id="node1316" class="node">
<title>l4_gate_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="9494" cy="-445.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="9494" y="-456.97" font-family="Times,serif" font-size="14.00">L4 Gate</text>
<text text-anchor="middle" x="9494" y="-441.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="9494" y="-426.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l4_attn_out_gpu3&#45;&gt;l4_gate_gpu3 -->
<g id="edge1980" class="edge">
<title>l4_attn_out_gpu3&#45;&gt;l4_gate_gpu3</title>
<path fill="none" stroke="black" d="M11376.07,-539C11357.53,-531.51 11336.78,-524.35 11317,-520.17 11146.93,-484.18 9927.95,-455.86 9584.1,-448.53"/>
<polygon fill="black" stroke="black" points="9584.01,-445.02 9573.94,-448.31 9583.86,-452.02 9584.01,-445.02"/>
</g>
<!-- l4_gate_gpu4 -->
<g id="node1317" class="node">
<title>l4_gate_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="8782" cy="-445.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="8782" y="-456.97" font-family="Times,serif" font-size="14.00">L4 Gate</text>
<text text-anchor="middle" x="8782" y="-441.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8782" y="-426.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l4_attn_out_gpu4&#45;&gt;l4_gate_gpu4 -->
<g id="edge2005" class="edge">
<title>l4_attn_out_gpu4&#45;&gt;l4_gate_gpu4</title>
<path fill="none" stroke="black" d="M9944.17,-541.78C9920.13,-533.23 9892.19,-524.72 9866,-520.17 9685.11,-488.74 9223.19,-514.44 9040,-502.17 8964.58,-497.12 8944.22,-501.91 8871,-483.17 8863.29,-481.19 8855.37,-478.69 8847.59,-475.93"/>
<polygon fill="black" stroke="black" points="8848.77,-472.63 8838.18,-472.44 8846.34,-479.2 8848.77,-472.63"/>
</g>
<!-- l4_gate_gpu5 -->
<g id="node1318" class="node">
<title>l4_gate_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="7002" cy="-445.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="7002" y="-456.97" font-family="Times,serif" font-size="14.00">L4 Gate</text>
<text text-anchor="middle" x="7002" y="-441.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="7002" y="-426.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l4_attn_out_gpu5&#45;&gt;l4_gate_gpu5 -->
<g id="edge2030" class="edge">
<title>l4_attn_out_gpu5&#45;&gt;l4_gate_gpu5</title>
<path fill="none" stroke="black" d="M7016.65,-520.28C7014.87,-511.35 7013.01,-502 7011.24,-493.08"/>
<polygon fill="black" stroke="black" points="7014.66,-492.36 7009.28,-483.24 7007.8,-493.73 7014.66,-492.36"/>
</g>
<!-- l4_gate_gpu6 -->
<g id="node1319" class="node">
<title>l4_gate_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="9316" cy="-445.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="9316" y="-456.97" font-family="Times,serif" font-size="14.00">L4 Gate</text>
<text text-anchor="middle" x="9316" y="-441.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9316" y="-426.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l4_attn_out_gpu6&#45;&gt;l4_gate_gpu6 -->
<g id="edge2055" class="edge">
<title>l4_attn_out_gpu6&#45;&gt;l4_gate_gpu6</title>
<path fill="none" stroke="black" d="M11174.27,-538.15C11156.9,-530.88 11137.55,-524.05 11119,-520.17 11025.78,-500.63 9498.24,-502.59 9405,-483.17 9397.1,-481.52 9389,-479.19 9381.08,-476.5"/>
<polygon fill="black" stroke="black" points="9382.1,-473.15 9371.51,-473.06 9379.73,-479.74 9382.1,-473.15"/>
</g>
<!-- l4_gate_gpu7 -->
<g id="node1320" class="node">
<title>l4_gate_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="8960" cy="-445.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="8960" y="-456.97" font-family="Times,serif" font-size="14.00">L4 Gate</text>
<text text-anchor="middle" x="8960" y="-441.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="8960" y="-426.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l4_attn_out_gpu7&#45;&gt;l4_gate_gpu7 -->
<g id="edge2080" class="edge">
<title>l4_attn_out_gpu7&#45;&gt;l4_gate_gpu7</title>
<path fill="none" stroke="black" d="M10772.48,-561.6C10636.93,-551.56 10340.97,-530.66 10091,-520.17 9722.35,-504.7 9629.41,-522.65 9261,-502.17 9166.55,-496.92 9140.9,-505.59 9049,-483.17 9041.27,-481.28 9033.34,-478.83 9025.54,-476.1"/>
<polygon fill="black" stroke="black" points="9026.72,-472.8 9016.13,-472.64 9024.31,-479.37 9026.72,-472.8"/>
</g>
<!-- l4_gate_gpu8 -->
<g id="node1321" class="node">
<title>l4_gate_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="7714" cy="-445.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="7714" y="-456.97" font-family="Times,serif" font-size="14.00">L4 Gate</text>
<text text-anchor="middle" x="7714" y="-441.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7714" y="-426.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l4_attn_out_gpu8&#45;&gt;l4_gate_gpu8 -->
<g id="edge2105" class="edge">
<title>l4_attn_out_gpu8&#45;&gt;l4_gate_gpu8</title>
<path fill="none" stroke="black" d="M7724.99,-520.28C7723.67,-511.44 7722.29,-502.2 7720.97,-493.37"/>
<polygon fill="black" stroke="black" points="7724.4,-492.61 7719.46,-483.24 7717.47,-493.64 7724.4,-492.61"/>
</g>
<!-- l4_gate_gpu9 -->
<g id="node1322" class="node">
<title>l4_gate_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="7892" cy="-445.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="7892" y="-456.97" font-family="Times,serif" font-size="14.00">L4 Gate</text>
<text text-anchor="middle" x="7892" y="-441.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="7892" y="-426.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l4_attn_out_gpu9&#45;&gt;l4_gate_gpu9 -->
<g id="edge2114" class="edge">
<title>l4_attn_out_gpu9&#45;&gt;l4_gate_gpu9</title>
<path fill="none" stroke="black" d="M7989.46,-529.43C7973.1,-515.54 7954.56,-499.79 7938.07,-485.79"/>
<polygon fill="black" stroke="black" points="7940.05,-482.88 7930.16,-479.07 7935.52,-488.21 7940.05,-482.88"/>
</g>
<!-- l4_gate_gpu10 -->
<g id="node1323" class="node">
<title>l4_gate_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="7180" cy="-445.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="7180" y="-456.97" font-family="Times,serif" font-size="14.00">L4 Gate</text>
<text text-anchor="middle" x="7180" y="-441.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="7180" y="-426.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l4_attn_out_gpu10&#45;&gt;l4_gate_gpu10 -->
<g id="edge2123" class="edge">
<title>l4_attn_out_gpu10&#45;&gt;l4_gate_gpu10</title>
<path fill="none" stroke="black" d="M7191.6,-520.28C7190.21,-511.44 7188.75,-502.2 7187.36,-493.37"/>
<polygon fill="black" stroke="black" points="7190.78,-492.57 7185.76,-483.24 7183.86,-493.66 7190.78,-492.57"/>
</g>
<!-- l4_gate_gpu11 -->
<g id="node1324" class="node">
<title>l4_gate_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="7536" cy="-445.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="7536" y="-456.97" font-family="Times,serif" font-size="14.00">L4 Gate</text>
<text text-anchor="middle" x="7536" y="-441.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7536" y="-426.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l4_attn_out_gpu11&#45;&gt;l4_gate_gpu11 -->
<g id="edge2132" class="edge">
<title>l4_attn_out_gpu11&#45;&gt;l4_gate_gpu11</title>
<path fill="none" stroke="black" d="M7543.9,-519.94C7542.96,-511.21 7541.98,-502.11 7541.04,-493.4"/>
<polygon fill="black" stroke="black" points="7544.51,-492.97 7539.96,-483.4 7537.55,-493.72 7544.51,-492.97"/>
</g>
<!-- l4_gate_gpu12 -->
<g id="node1325" class="node">
<title>l4_gate_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="11056" cy="-445.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="11056" y="-456.97" font-family="Times,serif" font-size="14.00">L4 Gate</text>
<text text-anchor="middle" x="11056" y="-441.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="11056" y="-426.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l4_attn_out_gpu12&#45;&gt;l4_gate_gpu12 -->
<g id="edge2141" class="edge">
<title>l4_attn_out_gpu12&#45;&gt;l4_gate_gpu12</title>
<path fill="none" stroke="black" d="M11579.68,-540.46C11560.81,-533.02 11539.8,-525.52 11520,-520.17 11391.62,-485.45 11238.54,-465.14 11144.3,-454.97"/>
<polygon fill="black" stroke="black" points="11144.56,-451.48 11134.24,-453.9 11143.81,-458.44 11144.56,-451.48"/>
</g>
<!-- l4_gate_gpu13 -->
<g id="node1326" class="node">
<title>l4_gate_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="8070" cy="-445.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="8070" y="-456.97" font-family="Times,serif" font-size="14.00">L4 Gate</text>
<text text-anchor="middle" x="8070" y="-441.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="8070" y="-426.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l4_attn_out_gpu13&#45;&gt;l4_gate_gpu13 -->
<g id="edge2150" class="edge">
<title>l4_attn_out_gpu13&#45;&gt;l4_gate_gpu13</title>
<path fill="none" stroke="black" d="M8164.34,-529.1C8148.59,-515.34 8130.81,-499.8 8114.95,-485.95"/>
<polygon fill="black" stroke="black" points="8117.18,-483.24 8107.34,-479.3 8112.57,-488.51 8117.18,-483.24"/>
</g>
<!-- l4_gate_gpu14 -->
<g id="node1327" class="node">
<title>l4_gate_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="8604" cy="-445.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="8604" y="-456.97" font-family="Times,serif" font-size="14.00">L4 Gate</text>
<text text-anchor="middle" x="8604" y="-441.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="8604" y="-426.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l4_attn_out_gpu14&#45;&gt;l4_gate_gpu14 -->
<g id="edge2159" class="edge">
<title>l4_attn_out_gpu14&#45;&gt;l4_gate_gpu14</title>
<path fill="none" stroke="black" d="M9707.47,-562.11C9556.16,-551.58 9202.1,-526.5 8905,-502.17 8810.72,-494.44 8784.9,-505.59 8693,-483.17 8685.27,-481.28 8677.34,-478.83 8669.54,-476.1"/>
<polygon fill="black" stroke="black" points="8670.72,-472.8 8660.13,-472.64 8668.31,-479.37 8670.72,-472.8"/>
</g>
<!-- l4_gate_gpu15 -->
<g id="node1328" class="node">
<title>l4_gate_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="8248" cy="-445.67" rx="80" ry="37.5"/>
<text text-anchor="middle" x="8248" y="-456.97" font-family="Times,serif" font-size="14.00">L4 Gate</text>
<text text-anchor="middle" x="8248" y="-441.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8248" y="-426.97" font-family="Times,serif" font-size="14.00">Top&#45;2 routing</text>
</g>
<!-- l4_attn_out_gpu15&#45;&gt;l4_gate_gpu15 -->
<g id="edge2168" class="edge">
<title>l4_attn_out_gpu15&#45;&gt;l4_gate_gpu15</title>
<path fill="none" stroke="black" d="M8342.34,-529.1C8326.59,-515.34 8308.81,-499.8 8292.95,-485.95"/>
<polygon fill="black" stroke="black" points="8295.18,-483.24 8285.34,-479.3 8290.57,-488.51 8295.18,-483.24"/>
</g>
<!-- l4_expert0_gpu0 -->
<g id="node1290" class="node">
<title>l4_expert0_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="5594" cy="-309.08" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="5594" y="-327.88" font-family="Times,serif" font-size="14.00">L4 Expert0</text>
<text text-anchor="middle" x="5594" y="-312.88" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="5594" y="-297.88" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="5594" y="-282.88" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l4_gate_gpu0&#45;&gt;l4_expert0_gpu0 -->
<g id="edge1906" class="edge">
<title>l4_gate_gpu0&#45;&gt;l4_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8371,-418.29C8359.98,-414.1 8348.3,-410.41 8337,-408.17 8298.86,-400.59 2765.45,-417.7 2738,-390.17 2733.29,-385.44 2733.31,-379.91 2738,-375.17 2752.89,-360.1 4241.82,-357.67 4263,-357.17 4736.39,-346 5304.16,-322.57 5512.36,-313.64"/>
<polygon fill="black" stroke="black" points="5512.76,-317.13 5522.6,-313.2 5512.46,-310.13 5512.76,-317.13"/>
<text text-anchor="middle" x="2783.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l4_expert1_gpu1 -->
<g id="node1291" class="node">
<title>l4_expert1_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="9133" cy="-309.08" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="9133" y="-327.88" font-family="Times,serif" font-size="14.00">L4 Expert1</text>
<text text-anchor="middle" x="9133" y="-312.88" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="9133" y="-297.88" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="9133" y="-282.88" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l4_gate_gpu0&#45;&gt;l4_expert1_gpu1 -->
<g id="edge1907" class="edge">
<title>l4_gate_gpu0&#45;&gt;l4_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8481.01,-418.35C8492.03,-414.16 8503.71,-410.45 8515,-408.17 8538.31,-403.45 10210.27,-407.07 10227,-390.17 10298.88,-317.53 9481.22,-310.4 9215.1,-309.99"/>
<polygon fill="black" stroke="black" points="9214.73,-306.49 9204.73,-309.98 9214.73,-313.49 9214.73,-306.49"/>
<text text-anchor="middle" x="10277.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l4_expert2_gpu2 -->
<g id="node1292" class="node">
<title>l4_expert2_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="8003" cy="-309.08" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="8003" y="-327.88" font-family="Times,serif" font-size="14.00">L4 Expert2</text>
<text text-anchor="middle" x="8003" y="-312.88" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="8003" y="-297.88" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="8003" y="-282.88" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l4_gate_gpu0&#45;&gt;l4_expert2_gpu2 -->
<g id="edge1908" class="edge">
<title>l4_gate_gpu0&#45;&gt;l4_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8388.22,-412.22C8370.89,-398.88 8349.45,-384.42 8328,-375.17 8249.1,-341.13 8151.66,-324.66 8084.15,-316.84"/>
<polygon fill="black" stroke="black" points="8084.33,-313.34 8074,-315.7 8083.55,-320.29 8084.33,-313.34"/>
<text text-anchor="middle" x="8400.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l4_expert3_gpu3 -->
<g id="node1293" class="node">
<title>l4_expert3_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="6848" cy="-309.08" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="6848" y="-327.88" font-family="Times,serif" font-size="14.00">L4 Expert3</text>
<text text-anchor="middle" x="6848" y="-312.88" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="6848" y="-297.88" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="6848" y="-282.88" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l4_gate_gpu0&#45;&gt;l4_expert3_gpu3 -->
<g id="edge1909" class="edge">
<title>l4_gate_gpu0&#45;&gt;l4_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8370.99,-418.35C8359.97,-414.15 8348.29,-410.45 8337,-408.17 8311.91,-403.09 6512.01,-408.36 6494,-390.17 6453.56,-349.33 6650.53,-326.02 6767.08,-316"/>
<polygon fill="black" stroke="black" points="6767.39,-319.49 6777.06,-315.16 6766.8,-312.52 6767.39,-319.49"/>
<text text-anchor="middle" x="6539.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l4_expert4_gpu4 -->
<g id="node1294" class="node">
<title>l4_expert4_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="11887" cy="-309.08" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="11887" y="-327.88" font-family="Times,serif" font-size="14.00">L4 Expert4</text>
<text text-anchor="middle" x="11887" y="-312.88" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11887" y="-297.88" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="11887" y="-282.88" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l4_gate_gpu0&#45;&gt;l4_expert4_gpu4 -->
<g id="edge1910" class="edge">
<title>l4_gate_gpu0&#45;&gt;l4_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8481,-418.29C8492.02,-414.1 8503.7,-410.41 8515,-408.17 8552.24,-400.76 13956.19,-417.06 13983,-390.17 13987.71,-385.44 13987.64,-379.95 13983,-375.17 13947.32,-338.37 12351.59,-315.94 11968.87,-311.08"/>
<polygon fill="black" stroke="black" points="11968.75,-307.58 11958.71,-310.95 11968.66,-314.58 11968.75,-307.58"/>
<text text-anchor="middle" x="14032.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l4_expert5_gpu5 -->
<g id="node1295" class="node">
<title>l4_expert5_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="6209" cy="-309.08" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="6209" y="-327.88" font-family="Times,serif" font-size="14.00">L4 Expert5</text>
<text text-anchor="middle" x="6209" y="-312.88" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="6209" y="-297.88" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="6209" y="-282.88" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l4_gate_gpu0&#45;&gt;l4_expert5_gpu5 -->
<g id="edge1911" class="edge">
<title>l4_gate_gpu0&#45;&gt;l4_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8371,-418.3C8359.97,-414.11 8348.3,-410.42 8337,-408.17 8311.66,-403.11 4634.23,-408.48 4616,-390.17 4611.3,-385.44 4611.33,-379.92 4616,-375.17 4636.61,-354.21 5644.65,-358.71 5674,-357.17 5835.53,-348.7 6023.81,-330.09 6128.41,-318.97"/>
<polygon fill="black" stroke="black" points="6129.01,-322.42 6138.58,-317.88 6128.26,-315.46 6129.01,-322.42"/>
<text text-anchor="middle" x="4661.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l4_expert6_gpu6 -->
<g id="node1296" class="node">
<title>l4_expert6_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="4183" cy="-309.08" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="4183" y="-327.88" font-family="Times,serif" font-size="14.00">L4 Expert6</text>
<text text-anchor="middle" x="4183" y="-312.88" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="4183" y="-297.88" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="4183" y="-282.88" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l4_gate_gpu0&#45;&gt;l4_expert6_gpu6 -->
<g id="edge1912" class="edge">
<title>l4_gate_gpu0&#45;&gt;l4_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8371,-418.28C8359.98,-414.09 8348.3,-410.41 8337,-408.17 8311.95,-403.2 1001.03,-408.24 983,-390.17 978.29,-385.45 978.33,-379.93 983,-375.17 1039.22,-317.79 3605.88,-310.97 4100.87,-310.18"/>
<polygon fill="black" stroke="black" points="4101.15,-313.68 4111.15,-310.17 4101.14,-306.68 4101.15,-313.68"/>
<text text-anchor="middle" x="1028.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l4_expert7_gpu7 -->
<g id="node1297" class="node">
<title>l4_expert7_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="10343" cy="-309.08" rx="71.5" ry="48.17"/>
<text text-anchor="middle" x="10343" y="-327.88" font-family="Times,serif" font-size="14.00">L4 Expert7</text>
<text text-anchor="middle" x="10343" y="-312.88" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10343" y="-297.88" font-family="Times,serif" font-size="14.00">FFN Expert</text>
<text text-anchor="middle" x="10343" y="-282.88" font-family="Times,serif" font-size="14.00">4h→h</text>
</g>
<!-- l4_gate_gpu0&#45;&gt;l4_expert7_gpu7 -->
<g id="edge1913" class="edge">
<title>l4_gate_gpu0&#45;&gt;l4_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8481,-418.3C8492.03,-414.11 8503.7,-410.42 8515,-408.17 8539.45,-403.28 12087.42,-407.84 12105,-390.17 12109.7,-385.44 12109.63,-379.97 12105,-375.17 12097.61,-367.5 10770.56,-323.95 10424.66,-312.72"/>
<polygon fill="black" stroke="black" points="10424.58,-309.22 10414.47,-312.39 10424.36,-316.21 10424.58,-309.22"/>
<text text-anchor="middle" x="12154.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu0</text>
</g>
<!-- l4_expert_agg_gpu0 -->
<g id="node1298" class="node">
<title>l4_expert_agg_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="8939" cy="-186.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="8939" y="-197.8" font-family="Times,serif" font-size="14.00">L4 Expert Agg</text>
<text text-anchor="middle" x="8939" y="-182.8" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="8939" y="-167.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu0 -->
<g id="edge1914" class="edge">
<title>l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M5664.28,-300.05C5766.28,-288.81 5961.36,-268.87 6128,-261 6166.42,-259.18 8862.62,-260.24 8897,-243 8902.88,-240.05 8908.16,-235.84 8912.83,-231.05"/>
<polygon fill="black" stroke="black" points="8915.79,-232.98 8919.67,-223.12 8910.48,-228.41 8915.79,-232.98"/>
</g>
<!-- l4_expert_agg_gpu1 -->
<g id="node1299" class="node">
<title>l4_expert_agg_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="7435" cy="-186.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="7435" y="-197.8" font-family="Times,serif" font-size="14.00">L4 Expert Agg</text>
<text text-anchor="middle" x="7435" y="-182.8" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="7435" y="-167.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu1 -->
<g id="edge1915" class="edge">
<title>l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M5664.29,-300.22C5766.29,-289.19 5961.39,-269.51 6128,-261 6163.24,-259.2 7367.01,-259.87 7398,-243 7403.28,-240.13 7407.94,-236.14 7412.01,-231.6"/>
<polygon fill="black" stroke="black" points="7414.9,-233.59 7418.32,-223.56 7409.39,-229.27 7414.9,-233.59"/>
</g>
<!-- l4_expert_agg_gpu2 -->
<g id="node1300" class="node">
<title>l4_expert_agg_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="6495" cy="-186.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="6495" y="-197.8" font-family="Times,serif" font-size="14.00">L4 Expert Agg</text>
<text text-anchor="middle" x="6495" y="-182.8" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6495" y="-167.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu2 -->
<g id="edge1916" class="edge">
<title>l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M5664.77,-301.03C5766.95,-291.02 5961.82,-272.65 6128,-261 6166.4,-258.31 6442.91,-265.7 6474,-243 6477.7,-240.3 6480.76,-236.85 6483.27,-233.01"/>
<polygon fill="black" stroke="black" points="6486.4,-234.58 6487.95,-224.1 6480.2,-231.32 6486.4,-234.58"/>
</g>
<!-- l4_expert_agg_gpu3 -->
<g id="node1301" class="node">
<title>l4_expert_agg_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="6871" cy="-186.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="6871" y="-197.8" font-family="Times,serif" font-size="14.00">L4 Expert Agg</text>
<text text-anchor="middle" x="6871" y="-182.8" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="6871" y="-167.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu3 -->
<g id="edge1917" class="edge">
<title>l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M5664.73,-300.42C5766.87,-289.69 5961.67,-270.42 6128,-261 6167.56,-258.76 6807.22,-263.72 6841,-243 6845.55,-240.21 6849.46,-236.47 6852.8,-232.24"/>
<polygon fill="black" stroke="black" points="6855.9,-233.89 6858.55,-223.63 6850.08,-230 6855.9,-233.89"/>
</g>
<!-- l4_expert_agg_gpu4 -->
<g id="node1302" class="node">
<title>l4_expert_agg_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="8187" cy="-186.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="8187" y="-197.8" font-family="Times,serif" font-size="14.00">L4 Expert Agg</text>
<text text-anchor="middle" x="8187" y="-182.8" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8187" y="-167.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu4 -->
<g id="edge1918" class="edge">
<title>l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M5664.28,-300.1C5766.28,-288.93 5961.37,-269.08 6128,-261 6183.88,-258.29 8091.6,-267.3 8142,-243 8148.31,-239.96 8154.02,-235.56 8159.09,-230.55"/>
<polygon fill="black" stroke="black" points="8161.94,-232.63 8166.07,-222.87 8156.76,-227.92 8161.94,-232.63"/>
</g>
<!-- l4_expert_agg_gpu5 -->
<g id="node1303" class="node">
<title>l4_expert_agg_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="6119" cy="-186.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="6119" y="-197.8" font-family="Times,serif" font-size="14.00">L4 Expert Agg</text>
<text text-anchor="middle" x="6119" y="-182.8" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="6119" y="-167.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu5 -->
<g id="edge1919" class="edge">
<title>l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M5661.29,-292.63C5756.58,-270.74 5930.77,-230.73 6034.6,-206.89"/>
<polygon fill="black" stroke="black" points="6035.46,-210.28 6044.42,-204.63 6033.89,-203.46 6035.46,-210.28"/>
</g>
<!-- l4_expert_agg_gpu6 -->
<g id="node1304" class="node">
<title>l4_expert_agg_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="7623" cy="-186.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="7623" y="-197.8" font-family="Times,serif" font-size="14.00">L4 Expert Agg</text>
<text text-anchor="middle" x="7623" y="-182.8" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="7623" y="-167.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu6 -->
<g id="edge1920" class="edge">
<title>l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M5664.29,-300.18C5766.29,-289.1 5961.39,-269.37 6128,-261 6168.06,-258.99 7535.37,-259.36 7572,-243 7579.14,-239.81 7585.73,-235.09 7591.63,-229.72"/>
<polygon fill="black" stroke="black" points="7594.12,-232.18 7598.73,-222.64 7589.18,-227.22 7594.12,-232.18"/>
</g>
<!-- l4_expert_agg_gpu7 -->
<g id="node1305" class="node">
<title>l4_expert_agg_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="7811" cy="-186.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="7811" y="-197.8" font-family="Times,serif" font-size="14.00">L4 Expert Agg</text>
<text text-anchor="middle" x="7811" y="-182.8" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="7811" y="-167.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu7 -->
<g id="edge1921" class="edge">
<title>l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M5664.28,-300.15C5766.29,-289.03 5961.38,-269.24 6128,-261 6173.67,-258.74 7733.8,-264.8 7774,-243 7779.35,-240.1 7784.06,-236.05 7788.17,-231.45"/>
<polygon fill="black" stroke="black" points="7791.14,-233.33 7794.53,-223.29 7785.62,-229.03 7791.14,-233.33"/>
</g>
<!-- l4_expert_agg_gpu8 -->
<g id="node1306" class="node">
<title>l4_expert_agg_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="7999" cy="-186.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="7999" y="-197.8" font-family="Times,serif" font-size="14.00">L4 Expert Agg</text>
<text text-anchor="middle" x="7999" y="-182.8" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7999" y="-167.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu8 -->
<g id="edge1922" class="edge">
<title>l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M5664.28,-300.12C5766.28,-288.97 5961.37,-269.15 6128,-261 6178.86,-258.51 7916.08,-266.97 7961,-243 7966.41,-240.11 7971.2,-236.07 7975.4,-231.48"/>
<polygon fill="black" stroke="black" points="7978.41,-233.32 7981.91,-223.32 7972.94,-228.95 7978.41,-233.32"/>
</g>
<!-- l4_expert_agg_gpu9 -->
<g id="node1307" class="node">
<title>l4_expert_agg_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="7059" cy="-186.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="7059" y="-197.8" font-family="Times,serif" font-size="14.00">L4 Expert Agg</text>
<text text-anchor="middle" x="7059" y="-182.8" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="7059" y="-167.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu9 -->
<g id="edge1923" class="edge">
<title>l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M5664.72,-300.31C5766.85,-289.43 5961.65,-270 6128,-261 6177.6,-258.32 6978.44,-266.88 7022,-243 7027.27,-240.11 7031.92,-236.11 7035.99,-231.57"/>
<polygon fill="black" stroke="black" points="7038.89,-233.56 7042.3,-223.53 7033.38,-229.24 7038.89,-233.56"/>
</g>
<!-- l4_expert_agg_gpu10 -->
<g id="node1308" class="node">
<title>l4_expert_agg_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="6307" cy="-186.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="6307" y="-197.8" font-family="Times,serif" font-size="14.00">L4 Expert Agg</text>
<text text-anchor="middle" x="6307" y="-182.8" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6307" y="-167.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu10 -->
<g id="edge1924" class="edge">
<title>l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M5664.93,-301.89C5839.97,-286.53 6278.83,-247.63 6285,-243 6288.69,-240.23 6291.76,-236.75 6294.32,-232.88"/>
<polygon fill="black" stroke="black" points="6297.48,-234.4 6299.14,-223.93 6291.32,-231.08 6297.48,-234.4"/>
</g>
<!-- l4_expert_agg_gpu11 -->
<g id="node1309" class="node">
<title>l4_expert_agg_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="8375" cy="-186.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="8375" y="-197.8" font-family="Times,serif" font-size="14.00">L4 Expert Agg</text>
<text text-anchor="middle" x="8375" y="-182.8" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="8375" y="-167.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu11 -->
<g id="edge1925" class="edge">
<title>l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M5664.28,-300.09C5766.28,-288.89 5961.37,-269.02 6128,-261 6188.68,-258.08 8258.52,-265.38 8315,-243 8323.52,-239.62 8331.57,-234.41 8338.83,-228.51"/>
<polygon fill="black" stroke="black" points="8341.18,-231.11 8346.39,-221.89 8336.56,-225.84 8341.18,-231.11"/>
</g>
<!-- l4_expert_agg_gpu12 -->
<g id="node1310" class="node">
<title>l4_expert_agg_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="8563" cy="-186.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="8563" y="-197.8" font-family="Times,serif" font-size="14.00">L4 Expert Agg</text>
<text text-anchor="middle" x="8563" y="-182.8" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8563" y="-167.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu12 -->
<g id="edge1926" class="edge">
<title>l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M5664.28,-300.07C5766.28,-288.86 5961.37,-268.96 6128,-261 6193.9,-257.85 8441.66,-267.29 8503,-243 8511.53,-239.62 8519.57,-234.42 8526.83,-228.52"/>
<polygon fill="black" stroke="black" points="8529.18,-231.12 8534.4,-221.9 8524.57,-225.85 8529.18,-231.12"/>
</g>
<!-- l4_expert_agg_gpu13 -->
<g id="node1311" class="node">
<title>l4_expert_agg_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="7247" cy="-186.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="7247" y="-197.8" font-family="Times,serif" font-size="14.00">L4 Expert Agg</text>
<text text-anchor="middle" x="7247" y="-182.8" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7247" y="-167.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu13 -->
<g id="edge1927" class="edge">
<title>l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M5664.29,-300.27C5766.3,-289.31 5961.4,-269.71 6128,-261 6158.19,-259.42 7190.06,-258.51 7216,-243 7220.74,-240.17 7224.8,-236.32 7228.29,-231.97"/>
<polygon fill="black" stroke="black" points="7231.19,-233.93 7233.93,-223.7 7225.4,-229.99 7231.19,-233.93"/>
</g>
<!-- l4_expert_agg_gpu14 -->
<g id="node1312" class="node">
<title>l4_expert_agg_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="6683" cy="-186.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="6683" y="-197.8" font-family="Times,serif" font-size="14.00">L4 Expert Agg</text>
<text text-anchor="middle" x="6683" y="-182.8" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="6683" y="-167.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu14 -->
<g id="edge1928" class="edge">
<title>l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M5664.74,-300.62C5766.89,-290.11 5961.72,-271.13 6128,-261 6157.63,-259.2 6637.87,-260.28 6662,-243 6665.78,-240.3 6668.88,-236.82 6671.42,-232.93"/>
<polygon fill="black" stroke="black" points="6674.61,-234.38 6676.14,-223.9 6668.4,-231.14 6674.61,-234.38"/>
</g>
<!-- l4_expert_agg_gpu15 -->
<g id="node1313" class="node">
<title>l4_expert_agg_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="8751" cy="-186.5" rx="85" ry="37.5"/>
<text text-anchor="middle" x="8751" y="-197.8" font-family="Times,serif" font-size="14.00">L4 Expert Agg</text>
<text text-anchor="middle" x="8751" y="-182.8" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8751" y="-167.8" font-family="Times,serif" font-size="14.00">Weighted sum</text>
</g>
<!-- l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu15 -->
<g id="edge1929" class="edge">
<title>l4_expert0_gpu0&#45;&gt;l4_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M5664.28,-300.06C5766.28,-288.84 5961.36,-268.93 6128,-261 6198.31,-257.66 8594.4,-262.61 8662,-243 8675.65,-239.04 8689.25,-232.34 8701.56,-224.93"/>
<polygon fill="black" stroke="black" points="8703.68,-227.73 8710.28,-219.44 8699.95,-221.8 8703.68,-227.73"/>
</g>
<!-- l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu0 -->
<g id="edge1939" class="edge">
<title>l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M9081.01,-275.77C9054.68,-259.4 9022.66,-239.5 8995.7,-222.74"/>
<polygon fill="black" stroke="black" points="8997.47,-219.72 8987.13,-217.42 8993.78,-225.67 8997.47,-219.72"/>
</g>
<!-- l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu1 -->
<g id="edge1940" class="edge">
<title>l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M9061.72,-304.61C8892.13,-296.4 8451.32,-275.42 8083,-261 8023.23,-258.66 7602.95,-257.82 7545,-243 7527.08,-238.42 7508.71,-230.6 7492.24,-222.25"/>
<polygon fill="black" stroke="black" points="7493.79,-219.11 7483.31,-217.57 7490.55,-225.31 7493.79,-219.11"/>
</g>
<!-- l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu2 -->
<g id="edge1941" class="edge">
<title>l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M9061.73,-304.08C8892.19,-294.72 8451.45,-271.45 8083,-261 8040.96,-259.81 6608.82,-256.54 6569,-243 6558.18,-239.32 6547.66,-233.4 6538.11,-226.77"/>
<polygon fill="black" stroke="black" points="6540.11,-223.89 6529.98,-220.79 6535.96,-229.54 6540.11,-223.89"/>
</g>
<!-- l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu3 -->
<g id="edge1942" class="edge">
<title>l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M9061.73,-304.19C8892.18,-295.07 8451.43,-272.26 8083,-261 8021.74,-259.13 7039.48,-257.78 6980,-243 6962.09,-238.55 6943.78,-230.72 6927.4,-222.33"/>
<polygon fill="black" stroke="black" points="6928.99,-219.21 6918.52,-217.62 6925.72,-225.4 6928.99,-219.21"/>
</g>
<!-- l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu4 -->
<g id="edge1943" class="edge">
<title>l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M9061.22,-308.14C8879.07,-307.42 8402.96,-299.99 8257,-243 8247.26,-239.2 8237.79,-233.54 8229.13,-227.28"/>
<polygon fill="black" stroke="black" points="8231.16,-224.43 8221.09,-221.13 8226.9,-229.99 8231.16,-224.43"/>
</g>
<!-- l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu5 -->
<g id="edge1944" class="edge">
<title>l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M9061.74,-304.03C8892.2,-294.57 8451.46,-271.08 8083,-261 7981.81,-258.23 6360.38,-262.24 6261,-243 6235.08,-237.98 6207.79,-228.45 6184.15,-218.68"/>
<polygon fill="black" stroke="black" points="6185.51,-215.45 6174.94,-214.78 6182.78,-221.9 6185.51,-215.45"/>
</g>
<!-- l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu6 -->
<g id="edge1945" class="edge">
<title>l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M9061.33,-304.89C8772.23,-291.99 7707.07,-244.38 7703,-243 7691.37,-239.07 7679.89,-232.9 7669.42,-226.07"/>
<polygon fill="black" stroke="black" points="7671.11,-222.99 7660.88,-220.22 7667.16,-228.76 7671.11,-222.99"/>
</g>
<!-- l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu7 -->
<g id="edge1946" class="edge">
<title>l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M9061.4,-305.06C8809.36,-294.32 7975.28,-257.84 7920,-243 7902.51,-238.31 7884.58,-230.58 7868.44,-222.37"/>
<polygon fill="black" stroke="black" points="7869.65,-219.04 7859.17,-217.49 7866.39,-225.24 7869.65,-219.04"/>
</g>
<!-- l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu8 -->
<g id="edge1947" class="edge">
<title>l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M9061.47,-307.58C8858.47,-305.52 8281.8,-295.12 8101,-243 8085.04,-238.4 8068.78,-231.01 8054.08,-223.1"/>
<polygon fill="black" stroke="black" points="8055.58,-219.94 8045.14,-218.14 8052.18,-226.05 8055.58,-219.94"/>
</g>
<!-- l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu9 -->
<g id="edge1948" class="edge">
<title>l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M9061.73,-304.27C8892.17,-295.33 8451.41,-272.88 8083,-261 7981.37,-257.72 7266.64,-267.7 7168,-243 7150.18,-238.54 7131.97,-230.76 7115.65,-222.41"/>
<polygon fill="black" stroke="black" points="7117.27,-219.31 7106.8,-217.73 7114,-225.5 7117.27,-219.31"/>
</g>
<!-- l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu10 -->
<g id="edge1949" class="edge">
<title>l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M9061.73,-304.05C8892.19,-294.65 8451.46,-271.28 8083,-261 7991.7,-258.45 6528.44,-261.55 6439,-243 6415.68,-238.16 6391.32,-229.17 6369.97,-219.81"/>
<polygon fill="black" stroke="black" points="6371.26,-216.56 6360.7,-215.65 6368.39,-222.94 6371.26,-216.56"/>
</g>
<!-- l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu11 -->
<g id="edge1950" class="edge">
<title>l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M9061.47,-306.44C8908.72,-302.11 8555.55,-287.46 8445,-243 8435.3,-239.1 8425.85,-233.4 8417.19,-227.12"/>
<polygon fill="black" stroke="black" points="8419.22,-224.27 8409.15,-220.97 8414.96,-229.82 8419.22,-224.27"/>
</g>
<!-- l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu12 -->
<g id="edge1951" class="edge">
<title>l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M9061.56,-304.75C8917.55,-297.34 8603.14,-277.38 8569,-243 8566.39,-240.38 8564.43,-237.3 8562.98,-233.97"/>
<polygon fill="black" stroke="black" points="8566.25,-232.69 8560.12,-224.05 8559.53,-234.63 8566.25,-232.69"/>
</g>
<!-- l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu13 -->
<g id="edge1952" class="edge">
<title>l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M9061.72,-304.39C8892.16,-295.72 8451.38,-273.82 8083,-261 8002.25,-258.19 7434.33,-262.82 7356,-243 7338.2,-238.49 7319.98,-230.7 7303.67,-222.35"/>
<polygon fill="black" stroke="black" points="7305.29,-219.25 7294.81,-217.67 7302.02,-225.44 7305.29,-219.25"/>
</g>
<!-- l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu14 -->
<g id="edge1953" class="edge">
<title>l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M9061.73,-304.13C8892.19,-294.9 8451.44,-271.86 8083,-261 8012.19,-258.91 6877.19,-258.18 6808,-243 6786.48,-238.28 6764.13,-229.69 6744.39,-220.65"/>
<polygon fill="black" stroke="black" points="6745.76,-217.43 6735.22,-216.34 6742.78,-223.76 6745.76,-217.43"/>
</g>
<!-- l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu15 -->
<g id="edge1954" class="edge">
<title>l4_expert1_gpu1&#45;&gt;l4_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M9062.06,-301.72C8998.06,-294 8902.51,-277.44 8826,-243 8816.05,-238.52 8806.14,-232.55 8796.94,-226.19"/>
<polygon fill="black" stroke="black" points="8798.87,-223.27 8788.71,-220.27 8794.79,-228.96 8798.87,-223.27"/>
</g>
<!-- l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu0 -->
<g id="edge1964" class="edge">
<title>l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M8074.5,-308.07C8280.95,-307.36 8867.31,-300.25 8930,-243 8932.87,-240.38 8935.07,-237.23 8936.73,-233.78"/>
<polygon fill="black" stroke="black" points="8940.11,-234.69 8939.97,-224.1 8933.48,-232.47 8940.11,-234.69"/>
</g>
<!-- l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu1 -->
<g id="edge1965" class="edge">
<title>l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M7931.76,-303.47C7813.06,-295.01 7580.39,-274.89 7505,-243 7495.47,-238.97 7486.16,-233.27 7477.6,-227.05"/>
<polygon fill="black" stroke="black" points="7479.7,-224.26 7469.63,-220.97 7475.45,-229.82 7479.7,-224.26"/>
</g>
<!-- l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu2 -->
<g id="edge1966" class="edge">
<title>l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M7931.36,-304.95C7639.85,-292.18 6558.01,-244.7 6554,-243 6545.9,-239.58 6538.24,-234.51 6531.28,-228.82"/>
<polygon fill="black" stroke="black" points="6533.27,-225.9 6523.46,-221.9 6528.63,-231.15 6533.27,-225.9"/>
</g>
<!-- l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu3 -->
<g id="edge1967" class="edge">
<title>l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M7931.27,-306.21C7707.53,-300.02 7031.87,-278.56 6940,-243 6930.33,-239.26 6920.97,-233.63 6912.42,-227.38"/>
<polygon fill="black" stroke="black" points="6914.54,-224.6 6904.49,-221.24 6910.25,-230.13 6914.54,-224.6"/>
</g>
<!-- l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu4 -->
<g id="edge1968" class="edge">
<title>l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M8072.85,-297.84C8108.33,-289.07 8149.27,-272.88 8175,-243 8177.36,-240.27 8179.28,-237.18 8180.86,-233.89"/>
<polygon fill="black" stroke="black" points="8184.23,-234.85 8184.41,-224.25 8177.67,-232.42 8184.23,-234.85"/>
</g>
<!-- l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu5 -->
<g id="edge1969" class="edge">
<title>l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M7931.63,-304.53C7759.21,-296.05 7306.29,-274.31 6928,-261 6852.8,-258.35 6324.56,-258.86 6251,-243 6227.82,-238 6203.59,-229.03 6182.31,-219.73"/>
<polygon fill="black" stroke="black" points="6183.62,-216.48 6173.07,-215.59 6180.76,-222.87 6183.62,-216.48"/>
</g>
<!-- l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu6 -->
<g id="edge1970" class="edge">
<title>l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M7932.04,-302.56C7867.22,-295.37 7770.04,-279.14 7693,-243 7683.84,-238.7 7674.8,-232.99 7666.42,-226.86"/>
<polygon fill="black" stroke="black" points="7668.34,-223.93 7658.27,-220.63 7664.09,-229.49 7668.34,-223.93"/>
</g>
<!-- l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu7 -->
<g id="edge1971" class="edge">
<title>l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M7945.37,-280.47C7924.29,-269.63 7900.59,-256.55 7880,-243 7872.36,-237.97 7864.55,-232.29 7857.05,-226.52"/>
<polygon fill="black" stroke="black" points="7859.09,-223.67 7849.07,-220.25 7854.77,-229.18 7859.09,-223.67"/>
</g>
<!-- l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu8 -->
<g id="edge1972" class="edge">
<title>l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M8001.43,-260.77C8001.14,-252.14 8000.85,-243.14 8000.56,-234.51"/>
<polygon fill="black" stroke="black" points="8004.05,-234.12 8000.22,-224.24 7997.05,-234.35 8004.05,-234.12"/>
</g>
<!-- l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu9 -->
<g id="edge1973" class="edge">
<title>l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M7931.28,-308.19C7749.28,-307.6 7273.59,-300.45 7128,-243 7118.35,-239.19 7109,-233.54 7100.46,-227.28"/>
<polygon fill="black" stroke="black" points="7102.58,-224.49 7092.53,-221.13 7098.29,-230.02 7102.58,-224.49"/>
</g>
<!-- l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu10 -->
<g id="edge1974" class="edge">
<title>l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M7931.62,-304.74C7759.18,-296.72 7306.23,-275.93 6928,-261 6871.12,-258.75 6471.11,-257.25 6416,-243 6398.22,-238.4 6380.01,-230.58 6363.7,-222.23"/>
<polygon fill="black" stroke="black" points="6365.32,-219.13 6354.84,-217.56 6362.05,-225.32 6365.32,-219.13"/>
</g>
<!-- l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu11 -->
<g id="edge1975" class="edge">
<title>l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M8074.33,-304.39C8167.28,-298.08 8322.75,-281.9 8363,-243 8365.79,-240.31 8368,-237.13 8369.75,-233.69"/>
<polygon fill="black" stroke="black" points="8373.12,-234.67 8373.38,-224.08 8366.57,-232.2 8373.12,-234.67"/>
</g>
<!-- l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu12 -->
<g id="edge1976" class="edge">
<title>l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M8074.28,-304.19C8214.65,-295.88 8516.34,-274.53 8551,-243 8553.99,-240.28 8556.33,-237.01 8558.15,-233.43"/>
<polygon fill="black" stroke="black" points="8561.44,-234.63 8561.69,-224.04 8554.89,-232.16 8561.44,-234.63"/>
</g>
<!-- l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu13 -->
<g id="edge1977" class="edge">
<title>l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M7931.55,-306.49C7778.98,-302.25 7426.23,-287.79 7316,-243 7306.39,-239.1 7297.06,-233.4 7288.52,-227.12"/>
<polygon fill="black" stroke="black" points="7290.64,-224.34 7280.6,-220.97 7286.35,-229.86 7290.64,-224.34"/>
</g>
<!-- l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu14 -->
<g id="edge1978" class="edge">
<title>l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M7931.53,-305.14C7678.93,-294.61 6840.33,-258.66 6785,-243 6768.94,-238.45 6752.59,-231.04 6737.83,-223.09"/>
<polygon fill="black" stroke="black" points="6739.3,-219.9 6728.86,-218.09 6735.89,-226.02 6739.3,-219.9"/>
</g>
<!-- l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu15 -->
<g id="edge1979" class="edge">
<title>l4_expert2_gpu2&#45;&gt;l4_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M8074.48,-306.82C8250.93,-302.99 8696.38,-288.85 8744,-243 8746.75,-240.35 8748.82,-237.21 8750.36,-233.78"/>
<polygon fill="black" stroke="black" points="8753.71,-234.8 8753.27,-224.21 8747.01,-232.76 8753.71,-234.8"/>
</g>
<!-- l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu0 -->
<g id="edge1989" class="edge">
<title>l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M6919.3,-304.32C7091.54,-295.37 7544.01,-272.69 7922,-261 7949.77,-260.14 8899.81,-259.72 8922,-243 8925.49,-240.37 8928.28,-237.05 8930.51,-233.33"/>
<polygon fill="black" stroke="black" points="8933.76,-234.65 8934.78,-224.11 8927.4,-231.72 8933.76,-234.65"/>
</g>
<!-- l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu1 -->
<g id="edge1990" class="edge">
<title>l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M6919.42,-304.61C7065.18,-296.87 7386.28,-276.21 7423,-243 7426,-240.29 7428.34,-237.02 7430.17,-233.44"/>
<polygon fill="black" stroke="black" points="7433.45,-234.65 7433.71,-224.06 7426.9,-232.18 7433.45,-234.65"/>
</g>
<!-- l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu2 -->
<g id="edge1991" class="edge">
<title>l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M6777.71,-300.05C6696.92,-289.73 6570.38,-269.88 6531,-243 6526.38,-239.84 6522.21,-235.88 6518.49,-231.52"/>
<polygon fill="black" stroke="black" points="6521.12,-229.2 6512.28,-223.36 6515.55,-233.44 6521.12,-229.2"/>
</g>
<!-- l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu3 -->
<g id="edge1992" class="edge">
<title>l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M6856.96,-261.12C6858.66,-252.18 6860.45,-242.83 6862.15,-233.91"/>
<polygon fill="black" stroke="black" points="6865.59,-234.55 6864.02,-224.07 6858.71,-233.24 6865.59,-234.55"/>
</g>
<!-- l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu4 -->
<g id="edge1993" class="edge">
<title>l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M6919.56,-305.08C7192.61,-293.56 8154.35,-252.36 8167,-243 8170.66,-240.29 8173.66,-236.84 8176.11,-233"/>
<polygon fill="black" stroke="black" points="8179.23,-234.58 8180.64,-224.08 8172.99,-231.41 8179.23,-234.58"/>
</g>
<!-- l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu5 -->
<g id="edge1994" class="edge">
<title>l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M6776.16,-308.96C6658.92,-308.53 6420.25,-299.9 6228,-243 6210.81,-237.91 6193.1,-230.14 6177.09,-222.01"/>
<polygon fill="black" stroke="black" points="6178.36,-218.73 6167.87,-217.21 6175.12,-224.93 6178.36,-218.73"/>
</g>
<!-- l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu6 -->
<g id="edge1995" class="edge">
<title>l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M6919.56,-306.69C7099.18,-302.52 7558.43,-287.59 7610,-243 7613.07,-240.35 7615.49,-237.12 7617.39,-233.57"/>
<polygon fill="black" stroke="black" points="7620.66,-234.81 7621.11,-224.22 7614.16,-232.21 7620.66,-234.81"/>
</g>
<!-- l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu7 -->
<g id="edge1996" class="edge">
<title>l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M6919.7,-308.05C7129.74,-307.29 7732.97,-300.11 7799,-243 7802.06,-240.35 7804.44,-237.13 7806.3,-233.59"/>
<polygon fill="black" stroke="black" points="7809.56,-234.84 7809.87,-224.25 7803.03,-232.33 7809.56,-234.84"/>
</g>
<!-- l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu8 -->
<g id="edge1997" class="edge">
<title>l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M6919.67,-306.33C7163.06,-300.08 7945.1,-277.38 7986,-243 7989.15,-240.35 7991.62,-237.1 7993.54,-233.52"/>
<polygon fill="black" stroke="black" points="7996.86,-234.64 7997.3,-224.05 7990.36,-232.06 7996.86,-234.64"/>
</g>
<!-- l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu9 -->
<g id="edge1998" class="edge">
<title>l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M6919.17,-301.94C6961.71,-294.54 7013.61,-278.35 7046,-243 7048.56,-240.21 7050.64,-237.01 7052.33,-233.6"/>
<polygon fill="black" stroke="black" points="7055.64,-234.75 7055.97,-224.16 7049.11,-232.23 7055.64,-234.75"/>
</g>
<!-- l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu10 -->
<g id="edge1999" class="edge">
<title>l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M6776.81,-302.94C6663.21,-293.96 6446.54,-273.43 6376,-243 6366.68,-238.98 6357.58,-233.35 6349.21,-227.19"/>
<polygon fill="black" stroke="black" points="6351.15,-224.27 6341.1,-220.91 6346.86,-229.8 6351.15,-224.27"/>
</g>
<!-- l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu11 -->
<g id="edge2000" class="edge">
<title>l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M6919.32,-304.91C7091.61,-297.24 7544.17,-277.17 7922,-261 7945.94,-259.98 8333.46,-256.88 8353,-243 8356.81,-240.29 8359.96,-236.82 8362.57,-232.93"/>
<polygon fill="black" stroke="black" points="8365.77,-234.36 8367.44,-223.89 8359.61,-231.03 8365.77,-234.36"/>
</g>
<!-- l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu12 -->
<g id="edge2001" class="edge">
<title>l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M6919.31,-304.59C7091.57,-296.24 7544.08,-274.78 7922,-261 7956.38,-259.75 8512.83,-262.74 8541,-243 8544.83,-240.32 8547.99,-236.86 8550.6,-232.98"/>
<polygon fill="black" stroke="black" points="8553.8,-234.41 8555.49,-223.95 8547.65,-231.08 8553.8,-234.41"/>
</g>
<!-- l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu13 -->
<g id="edge2002" class="edge">
<title>l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M6919.31,-305.28C7018.13,-299.91 7189.59,-284.69 7234,-243 7236.84,-240.34 7239.11,-237.18 7240.92,-233.75"/>
<polygon fill="black" stroke="black" points="7244.29,-234.75 7244.73,-224.17 7237.78,-232.17 7244.29,-234.75"/>
</g>
<!-- l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu14 -->
<g id="edge2003" class="edge">
<title>l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M6795.4,-276.18C6779.53,-266.03 6762.27,-254.45 6747,-243 6740.55,-238.16 6733.92,-232.85 6727.49,-227.49"/>
<polygon fill="black" stroke="black" points="6729.38,-224.5 6719.48,-220.7 6724.85,-229.84 6729.38,-224.5"/>
</g>
<!-- l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu15 -->
<g id="edge2004" class="edge">
<title>l4_expert3_gpu3&#45;&gt;l4_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M6919.3,-304.43C7091.55,-295.71 7544.03,-273.5 7922,-261 7944.38,-260.26 8709.52,-255.65 8728,-243 8731.88,-240.34 8735.11,-236.9 8737.79,-233.03"/>
<polygon fill="black" stroke="black" points="8741.01,-234.45 8742.84,-224.02 8734.9,-231.03 8741.01,-234.45"/>
</g>
<!-- l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu0 -->
<g id="edge2014" class="edge">
<title>l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M11815.59,-305.16C11418.64,-288.93 9485.41,-209.85 9033.58,-191.37"/>
<polygon fill="black" stroke="black" points="9033.63,-187.87 9023.5,-190.96 9033.35,-194.86 9033.63,-187.87"/>
</g>
<!-- l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu1 -->
<g id="edge2015" class="edge">
<title>l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M11815.42,-305.14C11603.09,-296.56 10958.2,-271.47 10423,-261 9276.08,-238.56 8988.48,-281.77 7842,-243 7702.71,-238.29 7665.14,-253.8 7529,-224 7520.61,-222.16 7511.99,-219.69 7503.53,-216.89"/>
<polygon fill="black" stroke="black" points="7504.66,-213.58 7494.06,-213.62 7502.37,-220.2 7504.66,-213.58"/>
</g>
<!-- l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu2 -->
<g id="edge2016" class="edge">
<title>l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M11815.42,-305.1C11603.09,-296.38 10958.2,-270.97 10423,-261 9640.68,-246.42 7684.03,-268.71 6902,-243 6762.71,-238.42 6725.14,-253.8 6589,-224 6580.61,-222.16 6571.99,-219.69 6563.53,-216.89"/>
<polygon fill="black" stroke="black" points="6564.66,-213.58 6554.06,-213.62 6562.37,-220.2 6564.66,-213.58"/>
</g>
<!-- l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu3 -->
<g id="edge2017" class="edge">
<title>l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M11815.42,-305.11C11603.09,-296.44 10958.2,-271.14 10423,-261 9724.22,-247.77 7976.52,-266.18 7278,-243 7138.71,-238.38 7101.14,-253.8 6965,-224 6956.61,-222.16 6947.99,-219.69 6939.53,-216.89"/>
<polygon fill="black" stroke="black" points="6940.66,-213.58 6930.06,-213.62 6938.37,-220.2 6940.66,-213.58"/>
</g>
<!-- l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu4 -->
<g id="edge2018" class="edge">
<title>l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M11815.42,-305.22C11603.08,-296.83 10958.18,-272.25 10423,-261 9612.47,-243.97 9409.22,-271.18 8599,-243 8457.5,-238.08 8419.32,-254.21 8281,-224 8272.61,-222.17 8263.99,-219.7 8255.53,-216.9"/>
<polygon fill="black" stroke="black" points="8256.66,-213.59 8246.06,-213.62 8254.37,-220.2 8256.66,-213.59"/>
</g>
<!-- l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu5 -->
<g id="edge2019" class="edge">
<title>l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M11815.42,-305.08C11603.09,-296.33 10958.21,-270.84 10423,-261 9557.14,-245.08 7391.55,-271.25 6526,-243 6456.35,-240.73 6281.07,-238.9 6213,-224 6204.61,-222.16 6195.99,-219.69 6187.53,-216.89"/>
<polygon fill="black" stroke="black" points="6188.66,-213.58 6178.06,-213.62 6186.37,-220.2 6188.66,-213.58"/>
</g>
<!-- l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu6 -->
<g id="edge2020" class="edge">
<title>l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M11815.42,-305.16C11603.08,-296.61 10958.19,-271.62 10423,-261 9359.62,-239.9 9092.97,-279.23 8030,-243 7890.71,-238.25 7853.14,-253.8 7717,-224 7708.61,-222.16 7699.99,-219.69 7691.53,-216.89"/>
<polygon fill="black" stroke="black" points="7692.66,-213.58 7682.06,-213.62 7690.37,-220.2 7692.66,-213.58"/>
</g>
<!-- l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu7 -->
<g id="edge2021" class="edge">
<title>l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M11815.42,-305.17C11603.08,-296.67 10958.19,-271.79 10423,-261 9442.72,-241.24 9196.89,-276.81 8217,-243 8078.16,-238.21 8040.71,-253.72 7905,-224 7896.61,-222.16 7887.99,-219.69 7879.53,-216.89"/>
<polygon fill="black" stroke="black" points="7880.66,-213.58 7870.07,-213.61 7878.37,-220.2 7880.66,-213.58"/>
</g>
<!-- l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu8 -->
<g id="edge2022" class="edge">
<title>l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M11815.42,-305.19C11603.08,-296.74 10958.18,-271.99 10423,-261 9525.38,-242.57 9300.26,-274.47 8403,-243 8265.05,-238.16 8227.83,-253.56 8093,-224 8084.61,-222.16 8075.99,-219.69 8067.53,-216.89"/>
<polygon fill="black" stroke="black" points="8068.66,-213.58 8058.07,-213.61 8066.37,-220.19 8068.66,-213.58"/>
</g>
<!-- l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu9 -->
<g id="edge2023" class="edge">
<title>l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M11815.42,-305.12C11603.09,-296.47 10958.2,-271.23 10423,-261 9766,-248.44 8122.76,-264.92 7466,-243 7326.71,-238.35 7289.14,-253.8 7153,-224 7144.61,-222.16 7135.99,-219.69 7127.53,-216.89"/>
<polygon fill="black" stroke="black" points="7128.66,-213.58 7118.06,-213.62 7126.37,-220.2 7128.66,-213.58"/>
</g>
<!-- l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu10 -->
<g id="edge2024" class="edge">
<title>l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M11815.42,-305.09C11603.09,-296.35 10958.21,-270.9 10423,-261 9598.91,-245.75 7537.79,-269.98 6714,-243 6574.71,-238.44 6537.14,-253.8 6401,-224 6392.61,-222.16 6383.99,-219.69 6375.53,-216.89"/>
<polygon fill="black" stroke="black" points="6376.66,-213.58 6366.06,-213.62 6374.37,-220.2 6376.66,-213.58"/>
</g>
<!-- l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu11 -->
<g id="edge2025" class="edge">
<title>l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M11815.42,-305.24C11603.08,-296.93 10958.17,-272.51 10423,-261 9687.57,-245.18 9503.09,-270.33 8768,-243 8634.94,-238.05 8599.04,-252.66 8469,-224 8460.62,-222.15 8451.99,-219.67 8443.53,-216.87"/>
<polygon fill="black" stroke="black" points="8444.67,-213.56 8434.07,-213.59 8442.37,-220.17 8444.67,-213.56"/>
</g>
<!-- l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu12 -->
<g id="edge2026" class="edge">
<title>l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M11815.41,-305.32C11603.07,-297.21 10958.16,-273.3 10423,-261 9843.54,-247.68 9698.39,-258.91 9119,-243 8913.57,-237.36 8858.17,-265.98 8657,-224 8648.53,-222.23 8639.83,-219.79 8631.31,-216.99"/>
<polygon fill="black" stroke="black" points="8632.37,-213.66 8621.77,-213.71 8630.09,-220.28 8632.37,-213.66"/>
</g>
<!-- l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu13 -->
<g id="edge2027" class="edge">
<title>l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M11815.42,-305.13C11603.09,-296.51 10958.2,-271.34 10423,-261 9192.54,-237.22 8884,-284.3 7654,-243 7514.71,-238.32 7477.14,-253.8 7341,-224 7332.61,-222.16 7323.99,-219.69 7315.53,-216.89"/>
<polygon fill="black" stroke="black" points="7316.66,-213.58 7306.06,-213.62 7314.37,-220.2 7316.66,-213.58"/>
</g>
<!-- l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu14 -->
<g id="edge2028" class="edge">
<title>l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M11815.42,-305.1C11603.09,-296.41 10958.2,-271.05 10423,-261 9682.45,-247.09 7830.27,-267.45 7090,-243 6950.71,-238.4 6913.14,-253.8 6777,-224 6768.61,-222.16 6759.99,-219.69 6751.53,-216.89"/>
<polygon fill="black" stroke="black" points="6752.66,-213.58 6742.06,-213.62 6750.37,-220.2 6752.66,-213.58"/>
</g>
<!-- l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu15 -->
<g id="edge2029" class="edge">
<title>l4_expert4_gpu4&#45;&gt;l4_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M11815.41,-305.56C11603.05,-298.12 10958.09,-275.88 10423,-261 10247.69,-256.13 9016.99,-258.31 8845,-224 8836.46,-222.3 8827.68,-219.87 8819.09,-217.08"/>
<polygon fill="black" stroke="black" points="8820.08,-213.72 8809.48,-213.78 8817.81,-220.34 8820.08,-213.72"/>
</g>
<!-- l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu0 -->
<g id="edge2039" class="edge">
<title>l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M6279.36,-300.42C6385.06,-289.31 6591.22,-269.14 6767,-261 6796.76,-259.62 8886.81,-258.91 8912,-243 8916.25,-240.32 8919.85,-236.75 8922.89,-232.72"/>
<polygon fill="black" stroke="black" points="8926.06,-234.26 8928.39,-223.92 8920.12,-230.55 8926.06,-234.26"/>
</g>
<!-- l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu1 -->
<g id="edge2040" class="edge">
<title>l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M6279.82,-300.82C6385.69,-290.26 6591.55,-270.84 6767,-261 6802.85,-258.99 7383.59,-263.59 7413,-243 7416.83,-240.32 7419.99,-236.86 7422.6,-232.98"/>
<polygon fill="black" stroke="black" points="7425.81,-234.42 7427.49,-223.96 7419.65,-231.09 7425.81,-234.42"/>
</g>
<!-- l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu2 -->
<g id="edge2041" class="edge">
<title>l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M6279.16,-299.79C6350.33,-289.94 6453.89,-271.22 6482,-243 6484.71,-240.28 6486.89,-237.11 6488.65,-233.69"/>
<polygon fill="black" stroke="black" points="6491.99,-234.78 6492.38,-224.19 6485.47,-232.22 6491.99,-234.78"/>
</g>
<!-- l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu3 -->
<g id="edge2042" class="edge">
<title>l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M6279.97,-302.92C6442.35,-290.83 6828.72,-260.4 6851,-243 6854.45,-240.31 6857.31,-236.96 6859.67,-233.26"/>
<polygon fill="black" stroke="black" points="6862.91,-234.62 6864.34,-224.12 6856.67,-231.44 6862.91,-234.62"/>
</g>
<!-- l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu4 -->
<g id="edge2043" class="edge">
<title>l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M6279.36,-300.53C6385.08,-289.54 6591.24,-269.54 6767,-261 6805.57,-259.13 8123.96,-262.99 8157,-243 8161.57,-240.24 8165.48,-236.51 8168.83,-232.29"/>
<polygon fill="black" stroke="black" points="8171.93,-233.95 8174.59,-223.7 8166.12,-230.06 8171.93,-233.95"/>
</g>
<!-- l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu5 -->
<g id="edge2044" class="edge">
<title>l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M6177.52,-265.91C6168.96,-254.43 6159.67,-241.99 6151.07,-230.47"/>
<polygon fill="black" stroke="black" points="6153.74,-228.19 6144.95,-222.27 6148.13,-232.38 6153.74,-228.19"/>
</g>
<!-- l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu6 -->
<g id="edge2045" class="edge">
<title>l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M6279.81,-300.68C6385.67,-289.94 6591.52,-270.3 6767,-261 6812.95,-258.56 7556.08,-267.54 7595,-243 7599.39,-240.23 7603.13,-236.54 7606.29,-232.37"/>
<polygon fill="black" stroke="black" points="7609.27,-234.2 7611.7,-223.88 7603.37,-230.44 7609.27,-234.2"/>
</g>
<!-- l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu7 -->
<g id="edge2046" class="edge">
<title>l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M6279.81,-300.59C6385.66,-289.73 6591.5,-269.94 6767,-261 6795.36,-259.56 7765.65,-259.16 7789,-243 7792.84,-240.34 7796.01,-236.89 7798.63,-233.02"/>
<polygon fill="black" stroke="black" points="7801.83,-234.47 7803.52,-224.01 7795.68,-231.13 7801.83,-234.47"/>
</g>
<!-- l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu8 -->
<g id="edge2047" class="edge">
<title>l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M6279.8,-300.53C6385.65,-289.59 6591.49,-269.7 6767,-261 6800.55,-259.34 7948.21,-261.86 7976,-243 7979.89,-240.36 7983.13,-236.93 7985.81,-233.06"/>
<polygon fill="black" stroke="black" points="7989.03,-234.49 7990.87,-224.06 7982.92,-231.06 7989.03,-234.49"/>
</g>
<!-- l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu9 -->
<g id="edge2048" class="edge">
<title>l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M6279.88,-301.7C6385.82,-292.25 6591.78,-274.23 6767,-261 6796.98,-258.74 7012.71,-260.71 7037,-243 7040.73,-240.28 7043.83,-236.83 7046.4,-232.98"/>
<polygon fill="black" stroke="black" points="7049.55,-234.52 7051.23,-224.06 7043.39,-231.19 7049.55,-234.52"/>
</g>
<!-- l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu10 -->
<g id="edge2049" class="edge">
<title>l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M6261.96,-276.5C6274.03,-267.08 6285.73,-255.8 6294,-243 6295.88,-240.09 6297.49,-236.93 6298.87,-233.65"/>
<polygon fill="black" stroke="black" points="6302.18,-234.78 6302.17,-224.19 6295.58,-232.48 6302.18,-234.78"/>
</g>
<!-- l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu11 -->
<g id="edge2050" class="edge">
<title>l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M6279.36,-300.49C6385.07,-289.47 6591.23,-269.41 6767,-261 6810.59,-258.91 8299.64,-263.81 8338,-243 8343.28,-240.13 8347.94,-236.15 8352.02,-231.62"/>
<polygon fill="black" stroke="black" points="8354.91,-233.6 8358.33,-223.58 8349.4,-229.28 8354.91,-233.6"/>
</g>
<!-- l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu12 -->
<g id="edge2051" class="edge">
<title>l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M6279.36,-300.47C6385.07,-289.4 6591.23,-269.3 6767,-261 6815.81,-258.69 8483.04,-266.28 8526,-243 8531.35,-240.1 8536.06,-236.06 8540.17,-231.46"/>
<polygon fill="black" stroke="black" points="8543.14,-233.34 8546.53,-223.3 8537.62,-229.03 8543.14,-233.34"/>
</g>
<!-- l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu13 -->
<g id="edge2052" class="edge">
<title>l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M6279.83,-301.08C6385.72,-290.84 6591.61,-271.83 6767,-261 6792.47,-259.43 7205.29,-257.91 7226,-243 7229.72,-240.32 7232.78,-236.89 7235.3,-233.06"/>
<polygon fill="black" stroke="black" points="7238.43,-234.64 7240,-224.16 7232.24,-231.37 7238.43,-234.64"/>
</g>
<!-- l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu14 -->
<g id="edge2053" class="edge">
<title>l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M6280.64,-307.53C6395.71,-305.12 6614.44,-293.78 6670,-243 6673,-240.26 6675.37,-236.98 6677.23,-233.39"/>
<polygon fill="black" stroke="black" points="6680.53,-234.58 6680.91,-223.99 6674.01,-232.03 6680.53,-234.58"/>
</g>
<!-- l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu15 -->
<g id="edge2054" class="edge">
<title>l4_expert5_gpu5&#45;&gt;l4_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M6279.36,-300.44C6385.07,-289.35 6591.23,-269.22 6767,-261 6820.75,-258.49 8655.29,-265.86 8704,-243 8710.6,-239.9 8716.62,-235.38 8721.97,-230.23"/>
<polygon fill="black" stroke="black" points="8724.57,-232.58 8728.86,-222.89 8719.47,-227.79 8724.57,-232.58"/>
</g>
<!-- l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu0 -->
<g id="edge2064" class="edge">
<title>l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M4254.35,-304.84C4453.43,-295.96 5031.95,-271.19 5513,-261 6662.1,-236.67 6949.79,-261.63 8099,-243 8430.62,-237.62 8519.81,-289.22 8845,-224 8853.54,-222.29 8862.32,-219.86 8870.91,-217.06"/>
<polygon fill="black" stroke="black" points="8872.19,-220.32 8880.51,-213.76 8869.92,-213.7 8872.19,-220.32"/>
</g>
<!-- l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu1 -->
<g id="edge2065" class="edge">
<title>l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M4254.35,-305C4453.44,-296.51 5031.99,-272.68 5513,-261 6120.87,-246.24 6273.17,-259.55 6881,-243 7085.54,-237.43 7140.7,-265.82 7341,-224 7349.47,-222.23 7358.17,-219.79 7366.69,-216.99"/>
<polygon fill="black" stroke="black" points="7367.91,-220.27 7376.23,-213.71 7365.63,-213.66 7367.91,-220.27"/>
</g>
<!-- l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu2 -->
<g id="edge2066" class="edge">
<title>l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M4254.59,-305.53C4631.96,-292.05 6374.08,-229.57 6401,-224 6409.47,-222.25 6418.17,-219.81 6426.7,-217.02"/>
<polygon fill="black" stroke="black" points="6427.92,-220.3 6436.23,-213.74 6425.64,-213.68 6427.92,-220.3"/>
</g>
<!-- l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu3 -->
<g id="edge2067" class="edge">
<title>l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M4254.35,-305.15C4453.45,-297.04 5032.02,-274.1 5513,-261 5932.48,-249.58 6037.69,-259.44 6457,-243 6599.36,-237.42 6637.8,-254.37 6777,-224 6785.39,-222.17 6794.01,-219.7 6802.47,-216.91"/>
<polygon fill="black" stroke="black" points="6803.63,-220.21 6811.94,-213.63 6801.34,-213.59 6803.63,-220.21"/>
</g>
<!-- l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu4 -->
<g id="edge2068" class="edge">
<title>l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M4254.35,-304.88C4453.43,-296.1 5031.96,-271.57 5513,-261 6448.81,-240.44 6683.24,-265.75 7619,-243 7829.77,-237.88 7886.59,-266.96 8093,-224 8101.47,-222.24 8110.17,-219.8 8118.7,-217"/>
<polygon fill="black" stroke="black" points="8119.92,-220.28 8128.23,-213.72 8117.64,-213.67 8119.92,-220.28"/>
</g>
<!-- l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu5 -->
<g id="edge2069" class="edge">
<title>l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M4254.2,-303.65C4550.86,-285.17 5688.86,-214.29 6024.99,-193.36"/>
<polygon fill="black" stroke="black" points="6025.41,-196.84 6035.18,-192.72 6024.98,-189.85 6025.41,-196.84"/>
</g>
<!-- l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu6 -->
<g id="edge2070" class="edge">
<title>l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M4254.35,-304.96C4453.44,-296.38 5031.98,-272.31 5513,-261 6199.97,-244.84 6372.07,-260.88 7059,-243 7267.99,-237.56 7324.33,-266.64 7529,-224 7537.47,-222.24 7546.17,-219.79 7554.7,-217"/>
<polygon fill="black" stroke="black" points="7555.92,-220.28 7564.23,-213.71 7553.63,-213.66 7555.92,-220.28"/>
</g>
<!-- l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu7 -->
<g id="edge2071" class="edge">
<title>l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M4254.35,-304.93C4453.43,-296.27 5031.97,-272.02 5513,-261 6280.84,-243.41 6473.2,-262.32 7241,-243 7452.66,-237.67 7509.72,-267.13 7717,-224 7725.47,-222.24 7734.17,-219.8 7742.7,-217"/>
<polygon fill="black" stroke="black" points="7743.92,-220.29 7752.23,-213.72 7741.64,-213.67 7743.92,-220.29"/>
</g>
<!-- l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu8 -->
<g id="edge2072" class="edge">
<title>l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M4254.35,-304.9C4453.43,-296.18 5031.96,-271.77 5513,-261 6364.82,-241.93 6578.22,-264.03 7430,-243 7641.22,-237.79 7698.15,-267.05 7905,-224 7913.47,-222.24 7922.17,-219.8 7930.7,-217"/>
<polygon fill="black" stroke="black" points="7931.92,-220.29 7940.23,-213.72 7929.64,-213.67 7931.92,-220.29"/>
</g>
<!-- l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu9 -->
<g id="edge2073" class="edge">
<title>l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M4254.35,-305.1C4453.45,-296.88 5032.01,-273.66 5513,-261 5976.91,-248.79 6093.17,-257.8 6557,-243 6738.44,-237.21 6787.4,-261.57 6965,-224 6973.46,-222.21 6982.16,-219.75 6990.69,-216.95"/>
<polygon fill="black" stroke="black" points="6991.91,-220.23 7000.22,-213.66 6989.62,-213.61 6991.91,-220.23"/>
</g>
<!-- l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu10 -->
<g id="edge2074" class="edge">
<title>l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M4254.53,-305.44C4609.2,-292.3 6164.07,-234.22 6213,-224 6221.47,-222.23 6230.17,-219.79 6238.69,-216.99"/>
<polygon fill="black" stroke="black" points="6239.91,-220.27 6248.23,-213.7 6237.63,-213.66 6239.91,-220.27"/>
</g>
<!-- l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu11 -->
<g id="edge2075" class="edge">
<title>l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M4254.35,-304.88C4453.43,-296.08 5031.96,-271.52 5513,-261 6473.69,-240 6714.27,-262.06 7675,-243 7944.41,-237.66 8016.95,-277.76 8281,-224 8289.54,-222.26 8298.31,-219.82 8306.9,-217.01"/>
<polygon fill="black" stroke="black" points="8308.18,-220.27 8316.5,-213.71 8305.91,-213.65 8308.18,-220.27"/>
</g>
<!-- l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu12 -->
<g id="edge2076" class="edge">
<title>l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M4254.35,-304.87C4453.43,-296.06 5031.96,-271.47 5513,-261 6495.91,-239.61 6742,-259.55 7725,-243 8055.73,-237.43 8144.69,-289.05 8469,-224 8477.54,-222.29 8486.32,-219.86 8494.91,-217.06"/>
<polygon fill="black" stroke="black" points="8496.19,-220.32 8504.51,-213.76 8493.92,-213.7 8496.19,-220.32"/>
</g>
<!-- l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu13 -->
<g id="edge2077" class="edge">
<title>l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M4254.35,-305.05C4453.44,-296.68 5032,-273.14 5513,-261 6044,-247.6 6177.05,-258.33 6708,-243 6905.88,-237.29 6959.25,-264.59 7153,-224 7161.47,-222.23 7170.16,-219.78 7178.69,-216.98"/>
<polygon fill="black" stroke="black" points="7179.91,-220.26 7188.22,-213.69 7177.63,-213.64 7179.91,-220.26"/>
</g>
<!-- l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu14 -->
<g id="edge2078" class="edge">
<title>l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M4254.37,-305.53C4453.5,-298.42 5032.14,-277.78 5513,-261 5752.11,-252.66 6354.63,-272.09 6589,-224 6597.47,-222.26 6606.18,-219.83 6614.71,-217.05"/>
<polygon fill="black" stroke="black" points="6615.92,-220.33 6624.24,-213.77 6613.65,-213.71 6615.92,-220.33"/>
</g>
<!-- l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu15 -->
<g id="edge2079" class="edge">
<title>l4_expert6_gpu6&#45;&gt;l4_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M4254.35,-304.85C4453.43,-295.97 5031.95,-271.22 5513,-261 6639.89,-237.06 6922.07,-264.6 8049,-243 8319.3,-237.82 8392.08,-277.93 8657,-224 8665.54,-222.26 8674.31,-219.82 8682.9,-217.01"/>
<polygon fill="black" stroke="black" points="8684.18,-220.27 8692.5,-213.71 8681.91,-213.65 8684.18,-220.27"/>
</g>
<!-- l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu0 -->
<g id="edge2089" class="edge">
<title>l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu0</title>
<path fill="none" stroke="black" d="M10271.93,-301.98C10038.55,-281.94 9295.62,-218.13 9032.48,-195.53"/>
<polygon fill="black" stroke="black" points="9032.46,-192.01 9022.2,-194.65 9031.86,-198.99 9032.46,-192.01"/>
</g>
<!-- l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu1 -->
<g id="edge2090" class="edge">
<title>l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu1</title>
<path fill="none" stroke="black" d="M10271.63,-304.4C10093.23,-295.36 9613.41,-271.97 9213,-261 8604.73,-244.33 8452.09,-265.32 7844,-243 7703.84,-237.85 7666.02,-253.97 7529,-224 7520.61,-222.17 7511.99,-219.69 7503.53,-216.9"/>
<polygon fill="black" stroke="black" points="7504.66,-213.59 7494.06,-213.62 7502.37,-220.2 7504.66,-213.59"/>
</g>
<!-- l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu2 -->
<g id="edge2091" class="edge">
<title>l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu2</title>
<path fill="none" stroke="black" d="M10271.64,-304.27C10093.24,-294.92 9613.43,-270.9 9213,-261 8186.62,-235.63 7929.1,-278.02 6903,-243 6763.27,-238.23 6725.58,-253.88 6589,-224 6580.61,-222.16 6571.99,-219.69 6563.53,-216.9"/>
<polygon fill="black" stroke="black" points="6564.66,-213.58 6554.06,-213.62 6562.37,-220.2 6564.66,-213.58"/>
</g>
<!-- l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu3 -->
<g id="edge2092" class="edge">
<title>l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu3</title>
<path fill="none" stroke="black" d="M10271.63,-304.31C10093.23,-295.04 9613.43,-271.2 9213,-261 8353.69,-239.1 8138.07,-272.97 7279,-243 7139.27,-238.13 7101.58,-253.88 6965,-224 6956.61,-222.16 6947.99,-219.69 6939.53,-216.9"/>
<polygon fill="black" stroke="black" points="6940.66,-213.58 6930.06,-213.62 6938.37,-220.2 6940.66,-213.58"/>
</g>
<!-- l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu4 -->
<g id="edge2093" class="edge">
<title>l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu4</title>
<path fill="none" stroke="black" d="M10271.62,-304.83C10093.18,-296.76 9613.3,-275.42 9213,-261 8949.94,-251.52 8883.99,-254.34 8621,-243 8469.79,-236.48 8428.92,-256.01 8281,-224 8272.61,-222.18 8263.98,-219.72 8255.52,-216.93"/>
<polygon fill="black" stroke="black" points="8256.65,-213.62 8246.05,-213.66 8254.36,-220.24 8256.65,-213.62"/>
</g>
<!-- l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu5 -->
<g id="edge2094" class="edge">
<title>l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu5</title>
<path fill="none" stroke="black" d="M10271.64,-304.24C10093.24,-294.83 9613.44,-270.68 9213,-261 8019.54,-232.15 7720.13,-283.07 6527,-243 6387.27,-238.31 6349.58,-253.88 6213,-224 6204.61,-222.16 6195.99,-219.69 6187.53,-216.9"/>
<polygon fill="black" stroke="black" points="6188.66,-213.58 6178.06,-213.62 6186.37,-220.2 6188.66,-213.58"/>
</g>
<!-- l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu6 -->
<g id="edge2095" class="edge">
<title>l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu6</title>
<path fill="none" stroke="black" d="M10271.63,-304.45C10093.22,-295.53 9613.39,-272.39 9213,-261 8688.71,-246.08 8557.13,-262.74 8033,-243 7892.4,-237.7 7854.45,-254.05 7717,-224 7708.61,-222.17 7699.99,-219.7 7691.53,-216.9"/>
<polygon fill="black" stroke="black" points="7692.66,-213.59 7682.06,-213.62 7690.37,-220.2 7692.66,-213.59"/>
</g>
<!-- l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu7 -->
<g id="edge2096" class="edge">
<title>l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu7</title>
<path fill="none" stroke="black" d="M10271.63,-304.53C10093.21,-295.77 9613.38,-272.98 9213,-261 8773.57,-247.85 8663.3,-260.07 8224,-243 8082.08,-237.48 8043.76,-254.29 7905,-224 7896.61,-222.17 7887.99,-219.7 7879.53,-216.9"/>
<polygon fill="black" stroke="black" points="7880.66,-213.59 7870.06,-213.63 7878.37,-220.21 7880.66,-213.59"/>
</g>
<!-- l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu8 -->
<g id="edge2097" class="edge">
<title>l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu8</title>
<path fill="none" stroke="black" d="M10271.63,-304.63C10093.2,-296.1 9613.35,-273.8 9213,-261 8854.43,-249.53 8764.45,-257.87 8406,-243 8266.75,-237.22 8229.14,-253.8 8093,-224 8084.61,-222.16 8075.99,-219.69 8067.53,-216.89"/>
<polygon fill="black" stroke="black" points="8068.66,-213.58 8058.06,-213.62 8066.37,-220.2 8068.66,-213.58"/>
</g>
<!-- l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu9 -->
<g id="edge2098" class="edge">
<title>l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu9</title>
<path fill="none" stroke="black" d="M10271.63,-304.33C10093.23,-295.12 9613.42,-271.4 9213,-261 8437.22,-240.84 8242.56,-270.44 7467,-243 7327.28,-238.06 7289.58,-253.88 7153,-224 7144.61,-222.16 7135.99,-219.69 7127.53,-216.9"/>
<polygon fill="black" stroke="black" points="7128.66,-213.58 7118.06,-213.62 7126.37,-220.2 7128.66,-213.58"/>
</g>
<!-- l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu10 -->
<g id="edge2099" class="edge">
<title>l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu10</title>
<path fill="none" stroke="black" d="M10271.64,-304.26C10093.24,-294.87 9613.44,-270.78 9213,-261 8103.08,-233.89 7824.62,-280.54 6715,-243 6575.27,-238.27 6537.58,-253.88 6401,-224 6392.61,-222.16 6383.99,-219.69 6375.53,-216.9"/>
<polygon fill="black" stroke="black" points="6376.66,-213.58 6366.06,-213.62 6374.37,-220.2 6376.66,-213.58"/>
</g>
<!-- l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu11 -->
<g id="edge2100" class="edge">
<title>l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu11</title>
<path fill="none" stroke="black" d="M10271.59,-305.11C9966.39,-292.39 8786.72,-243.24 8782,-243 8642.82,-235.87 8605.14,-253.8 8469,-224 8460.61,-222.16 8451.99,-219.69 8443.53,-216.89"/>
<polygon fill="black" stroke="black" points="8444.66,-213.58 8434.06,-213.62 8442.37,-220.2 8444.66,-213.58"/>
</g>
<!-- l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu12 -->
<g id="edge2101" class="edge">
<title>l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu12</title>
<path fill="none" stroke="black" d="M10271.68,-304.7C10072.69,-295.23 9494.44,-267.55 9014,-243 8855.32,-234.89 8812.34,-257.4 8657,-224 8648.54,-222.18 8639.85,-219.71 8631.33,-216.89"/>
<polygon fill="black" stroke="black" points="8632.39,-213.56 8621.8,-213.59 8630.1,-220.17 8632.39,-213.56"/>
</g>
<!-- l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu13 -->
<g id="edge2102" class="edge">
<title>l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu13</title>
<path fill="none" stroke="black" d="M10271.63,-304.36C10093.23,-295.23 9613.41,-271.65 9213,-261 8520.75,-242.58 8347.04,-267.92 7655,-243 7515.28,-237.97 7477.58,-253.88 7341,-224 7332.61,-222.16 7323.99,-219.69 7315.53,-216.9"/>
<polygon fill="black" stroke="black" points="7316.66,-213.58 7306.06,-213.62 7314.37,-220.2 7316.66,-213.58"/>
</g>
<!-- l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu14 -->
<g id="edge2103" class="edge">
<title>l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu14</title>
<path fill="none" stroke="black" d="M10271.64,-304.29C10093.24,-294.98 9613.43,-271.04 9213,-261 8270.15,-237.36 8033.59,-275.49 7091,-243 6951.27,-238.18 6913.58,-253.88 6777,-224 6768.61,-222.16 6759.99,-219.69 6751.53,-216.9"/>
<polygon fill="black" stroke="black" points="6752.66,-213.58 6742.06,-213.62 6750.37,-220.2 6752.66,-213.58"/>
</g>
<!-- l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu15 -->
<g id="edge2104" class="edge">
<title>l4_expert7_gpu7&#45;&gt;l4_expert_agg_gpu15</title>
<path fill="none" stroke="black" d="M10271.24,-305.38C9991.83,-294.67 8985.1,-254.33 8845,-224 8836.61,-222.18 8827.98,-219.72 8819.52,-216.93"/>
<polygon fill="black" stroke="black" points="8820.65,-213.62 8810.06,-213.66 8818.36,-220.24 8820.65,-213.62"/>
</g>
<!-- output_gpu0 -->
<g id="node1329" class="node">
<title>output_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="9124" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="9124" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="9124" y="-49.8" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="9124" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_expert_agg_gpu0&#45;&gt;output_gpu0 -->
<g id="edge3201" class="edge">
<title>l4_expert_agg_gpu0&#45;&gt;output_gpu0</title>
<path fill="none" stroke="black" d="M8983.31,-154.12C9009.37,-135.67 9042.51,-112.2 9070.08,-92.68"/>
<polygon fill="black" stroke="black" points="9072.3,-95.4 9078.44,-86.76 9068.26,-89.68 9072.3,-95.4"/>
</g>
<!-- output_gpu1 -->
<g id="node1330" class="node">
<title>output_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="7428" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="7428" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="7428" y="-49.8" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="7428" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_expert_agg_gpu1&#45;&gt;output_gpu1 -->
<g id="edge3202" class="edge">
<title>l4_expert_agg_gpu1&#45;&gt;output_gpu1</title>
<path fill="none" stroke="black" d="M7433.05,-149.01C7432.26,-134.23 7431.34,-116.98 7430.5,-101.29"/>
<polygon fill="black" stroke="black" points="7433.99,-101.05 7429.96,-91.25 7427,-101.42 7433.99,-101.05"/>
</g>
<!-- output_gpu2 -->
<g id="node1331" class="node">
<title>output_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="6368" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="6368" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="6368" y="-49.8" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="6368" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_expert_agg_gpu2&#45;&gt;output_gpu2 -->
<g id="edge3203" class="edge">
<title>l4_expert_agg_gpu2&#45;&gt;output_gpu2</title>
<path fill="none" stroke="black" d="M6462.29,-151.76C6445.96,-134.92 6426.04,-114.37 6408.72,-96.51"/>
<polygon fill="black" stroke="black" points="6410.95,-93.78 6401.48,-89.03 6405.93,-98.65 6410.95,-93.78"/>
</g>
<!-- output_gpu3 -->
<g id="node1332" class="node">
<title>output_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="6792" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="6792" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="6792" y="-49.8" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="6792" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_expert_agg_gpu3&#45;&gt;output_gpu3 -->
<g id="edge3204" class="edge">
<title>l4_expert_agg_gpu3&#45;&gt;output_gpu3</title>
<path fill="none" stroke="black" d="M6849.62,-150.05C6840.21,-134.45 6829.06,-115.95 6819.08,-99.4"/>
<polygon fill="black" stroke="black" points="6821.83,-97.19 6813.67,-90.43 6815.84,-100.81 6821.83,-97.19"/>
</g>
<!-- output_gpu4 -->
<g id="node1333" class="node">
<title>output_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="8276" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="8276" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="8276" y="-49.8" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="8276" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_expert_agg_gpu4&#45;&gt;output_gpu4 -->
<g id="edge3205" class="edge">
<title>l4_expert_agg_gpu4&#45;&gt;output_gpu4</title>
<path fill="none" stroke="black" d="M8210.85,-150.39C8221.64,-134.52 8234.5,-115.58 8245.94,-98.74"/>
<polygon fill="black" stroke="black" points="8249.05,-100.4 8251.77,-90.16 8243.26,-96.46 8249.05,-100.4"/>
</g>
<!-- output_gpu5 -->
<g id="node1334" class="node">
<title>output_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="5944" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="5944" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="5944" y="-49.8" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="5944" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_expert_agg_gpu5&#45;&gt;output_gpu5 -->
<g id="edge3206" class="edge">
<title>l4_expert_agg_gpu5&#45;&gt;output_gpu5</title>
<path fill="none" stroke="black" d="M6076.64,-153.79C6052.27,-135.55 6021.46,-112.49 5995.68,-93.18"/>
<polygon fill="black" stroke="black" points="5997.6,-90.25 5987.49,-87.06 5993.4,-95.85 5997.6,-90.25"/>
</g>
<!-- output_gpu6 -->
<g id="node1335" class="node">
<title>output_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="7640" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="7640" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="7640" y="-49.8" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="7640" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_expert_agg_gpu6&#45;&gt;output_gpu6 -->
<g id="edge3207" class="edge">
<title>l4_expert_agg_gpu6&#45;&gt;output_gpu6</title>
<path fill="none" stroke="black" d="M7627.74,-149.01C7629.65,-134.23 7631.89,-116.98 7633.93,-101.29"/>
<polygon fill="black" stroke="black" points="7637.41,-101.62 7635.23,-91.25 7630.47,-100.72 7637.41,-101.62"/>
</g>
<!-- output_gpu7 -->
<g id="node1336" class="node">
<title>output_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="7852" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="7852" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="7852" y="-49.8" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="7852" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_expert_agg_gpu7&#45;&gt;output_gpu7 -->
<g id="edge3208" class="edge">
<title>l4_expert_agg_gpu7&#45;&gt;output_gpu7</title>
<path fill="none" stroke="black" d="M7822.42,-149.01C7827.13,-133.96 7832.64,-116.36 7837.62,-100.45"/>
<polygon fill="black" stroke="black" points="7840.99,-101.38 7840.64,-90.8 7834.31,-99.29 7840.99,-101.38"/>
</g>
<!-- output_gpu8 -->
<g id="node1337" class="node">
<title>output_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="8064" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="8064" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="8064" y="-49.8" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="8064" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_expert_agg_gpu8&#45;&gt;output_gpu8 -->
<g id="edge3209" class="edge">
<title>l4_expert_agg_gpu8&#45;&gt;output_gpu8</title>
<path fill="none" stroke="black" d="M8016.76,-149.7C8024.37,-134.38 8033.34,-116.3 8041.4,-100.04"/>
<polygon fill="black" stroke="black" points="8044.72,-101.22 8046.03,-90.71 8038.45,-98.11 8044.72,-101.22"/>
</g>
<!-- output_gpu9 -->
<g id="node1338" class="node">
<title>output_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="7004" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="7004" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="7004" y="-49.8" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="7004" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_expert_agg_gpu9&#45;&gt;output_gpu9 -->
<g id="edge3210" class="edge">
<title>l4_expert_agg_gpu9&#45;&gt;output_gpu9</title>
<path fill="none" stroke="black" d="M7043.83,-149.36C7037.45,-134.16 7029.95,-116.31 7023.19,-100.22"/>
<polygon fill="black" stroke="black" points="7026.41,-98.85 7019.32,-90.98 7019.96,-101.56 7026.41,-98.85"/>
</g>
<!-- output_gpu10 -->
<g id="node1339" class="node">
<title>output_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="6156" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="6156" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="6156" y="-49.8" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6156" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_expert_agg_gpu10&#45;&gt;output_gpu10 -->
<g id="edge3211" class="edge">
<title>l4_expert_agg_gpu10&#45;&gt;output_gpu10</title>
<path fill="none" stroke="black" d="M6269.29,-152.78C6248.98,-135.16 6223.76,-113.29 6202.28,-94.65"/>
<polygon fill="black" stroke="black" points="6204.39,-91.85 6194.55,-87.94 6199.81,-97.14 6204.39,-91.85"/>
</g>
<!-- output_gpu11 -->
<g id="node1340" class="node">
<title>output_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="8488" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="8488" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="8488" y="-49.8" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="8488" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_expert_agg_gpu11&#45;&gt;output_gpu11 -->
<g id="edge3212" class="edge">
<title>l4_expert_agg_gpu11&#45;&gt;output_gpu11</title>
<path fill="none" stroke="black" d="M8404.69,-151.08C8418.87,-134.65 8435.97,-114.81 8450.99,-97.41"/>
<polygon fill="black" stroke="black" points="8453.84,-99.46 8457.72,-89.6 8448.54,-94.89 8453.84,-99.46"/>
</g>
<!-- output_gpu12 -->
<g id="node1341" class="node">
<title>output_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="8700" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="8700" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="8700" y="-49.8" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="8700" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_expert_agg_gpu12&#45;&gt;output_gpu12 -->
<g id="edge3213" class="edge">
<title>l4_expert_agg_gpu12&#45;&gt;output_gpu12</title>
<path fill="none" stroke="black" d="M8597.93,-152.1C8615.84,-134.97 8637.83,-113.95 8656.8,-95.8"/>
<polygon fill="black" stroke="black" points="8659.38,-98.19 8664.18,-88.75 8654.54,-93.13 8659.38,-98.19"/>
</g>
<!-- output_gpu13 -->
<g id="node1342" class="node">
<title>output_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="7216" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="7216" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="7216" y="-49.8" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="7216" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_expert_agg_gpu13&#45;&gt;output_gpu13 -->
<g id="edge3214" class="edge">
<title>l4_expert_agg_gpu13&#45;&gt;output_gpu13</title>
<path fill="none" stroke="black" d="M7238.36,-149.01C7234.87,-134.23 7230.78,-116.98 7227.07,-101.29"/>
<polygon fill="black" stroke="black" points="7230.41,-100.17 7224.7,-91.25 7223.59,-101.79 7230.41,-100.17"/>
</g>
<!-- output_gpu14 -->
<g id="node1343" class="node">
<title>output_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="6580" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="6580" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="6580" y="-49.8" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="6580" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_expert_agg_gpu14&#45;&gt;output_gpu14 -->
<g id="edge3215" class="edge">
<title>l4_expert_agg_gpu14&#45;&gt;output_gpu14</title>
<path fill="none" stroke="black" d="M6655.67,-150.74C6642.97,-134.58 6627.73,-115.2 6614.27,-98.08"/>
<polygon fill="black" stroke="black" points="6616.75,-95.58 6607.82,-89.88 6611.25,-99.9 6616.75,-95.58"/>
</g>
<!-- output_gpu15 -->
<g id="node1344" class="node">
<title>output_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="8912" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="8912" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="8912" y="-49.8" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="8912" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_expert_agg_gpu15&#45;&gt;output_gpu15 -->
<g id="edge3216" class="edge">
<title>l4_expert_agg_gpu15&#45;&gt;output_gpu15</title>
<path fill="none" stroke="black" d="M8790.8,-153.12C8812.7,-135.29 8840.07,-113.03 8863.25,-94.16"/>
<polygon fill="black" stroke="black" points="8865.71,-96.67 8871.26,-87.65 8861.3,-91.24 8865.71,-96.67"/>
</g>
<!-- l4_gate_gpu1&#45;&gt;l4_expert0_gpu0 -->
<g id="edge1931" class="edge">
<title>l4_gate_gpu1&#45;&gt;l4_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9083,-418.29C9071.98,-414.1 9060.3,-410.41 9049,-408.17 9009.18,-400.25 3231.66,-418.92 3203,-390.17 3198.29,-385.45 3198.33,-379.92 3203,-375.17 3223.65,-354.17 4233.56,-357.94 4263,-357.17 4736.36,-344.78 5304.15,-322.08 5512.36,-313.49"/>
<polygon fill="black" stroke="black" points="5512.75,-316.98 5522.59,-313.07 5512.46,-309.99 5512.75,-316.98"/>
<text text-anchor="middle" x="3248.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l4_gate_gpu1&#45;&gt;l4_expert1_gpu1 -->
<g id="edge1932" class="edge">
<title>l4_gate_gpu1&#45;&gt;l4_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9193.01,-418.37C9204.04,-414.17 9215.71,-410.46 9227,-408.17 9266.88,-400.05 10663.4,-419.12 10692,-390.17 10696.68,-385.42 10696.61,-379.98 10692,-375.17 10692,-375.17 9534.95,-326.86 9214.44,-313.48"/>
<polygon fill="black" stroke="black" points="9214.43,-309.98 9204.29,-313.06 9214.14,-316.97 9214.43,-309.98"/>
<text text-anchor="middle" x="10741.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l4_gate_gpu1&#45;&gt;l4_expert2_gpu2 -->
<g id="edge1933" class="edge">
<title>l4_gate_gpu1&#45;&gt;l4_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9081.88,-418.65C9071.16,-414.54 9059.88,-410.79 9049,-408.17 8957.08,-385.97 8926.42,-420.92 8837,-390.17 8825.46,-386.2 8825.55,-379.11 8814,-375.17 8680.66,-329.64 8262.61,-315.55 8084.58,-311.54"/>
<polygon fill="black" stroke="black" points="8084.56,-308.04 8074.49,-311.32 8084.41,-315.04 8084.56,-308.04"/>
<text text-anchor="middle" x="8882.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l4_gate_gpu1&#45;&gt;l4_expert3_gpu3 -->
<g id="edge1934" class="edge">
<title>l4_gate_gpu1&#45;&gt;l4_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9082.99,-418.34C9071.97,-414.14 9060.3,-410.44 9049,-408.17 8935.17,-385.22 7069.34,-426.34 6959,-390.17 6955.52,-389.03 6929.7,-370.45 6903.83,-351.47"/>
<polygon fill="black" stroke="black" points="6905.59,-348.42 6895.46,-345.32 6901.45,-354.06 6905.59,-348.42"/>
<text text-anchor="middle" x="7004.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l4_gate_gpu1&#45;&gt;l4_expert4_gpu4 -->
<g id="edge1935" class="edge">
<title>l4_gate_gpu1&#45;&gt;l4_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9193,-418.29C9204.02,-414.1 9215.7,-410.41 9227,-408.17 9262.56,-401.09 14422.41,-415.85 14448,-390.17 14452.71,-385.44 14452.65,-379.94 14448,-375.17 14403.69,-329.72 12401.07,-313.57 11968.72,-310.61"/>
<polygon fill="black" stroke="black" points="11968.52,-307.11 11958.5,-310.54 11968.47,-314.11 11968.52,-307.11"/>
<text text-anchor="middle" x="14497.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l4_gate_gpu1&#45;&gt;l4_expert5_gpu5 -->
<g id="edge1936" class="edge">
<title>l4_gate_gpu1&#45;&gt;l4_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9083,-418.3C9071.98,-414.11 9060.3,-410.42 9049,-408.17 9021.98,-402.78 5100.44,-409.7 5081,-390.17 5076.3,-385.44 5076.36,-379.95 5081,-375.17 5103.95,-351.51 5641.1,-359.11 5674,-357.17 5835.47,-347.62 6023.77,-329.39 6128.39,-318.63"/>
<polygon fill="black" stroke="black" points="6128.97,-322.09 6138.56,-317.58 6128.25,-315.13 6128.97,-322.09"/>
<text text-anchor="middle" x="5126.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l4_gate_gpu1&#45;&gt;l4_expert6_gpu6 -->
<g id="edge1937" class="edge">
<title>l4_gate_gpu1&#45;&gt;l4_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9083,-418.28C9071.98,-414.09 9060.3,-410.41 9049,-408.17 9023.11,-403.03 1466.64,-408.85 1448,-390.17 1443.29,-385.45 1443.34,-379.94 1448,-375.17 1495.53,-326.49 3650.2,-312.81 4100.89,-310.47"/>
<polygon fill="black" stroke="black" points="4101.23,-313.97 4111.22,-310.42 4101.2,-306.97 4101.23,-313.97"/>
<text text-anchor="middle" x="1493.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l4_gate_gpu1&#45;&gt;l4_expert7_gpu7 -->
<g id="edge1938" class="edge">
<title>l4_gate_gpu1&#45;&gt;l4_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9193,-418.31C9204.03,-414.12 9215.7,-410.43 9227,-408.17 9249.77,-403.62 12553.63,-406.63 12570,-390.17 12574.7,-385.44 12574.66,-379.94 12570,-375.17 12555.17,-359.98 11827.22,-357.76 11806,-357.17 11279.63,-342.5 10646.87,-320.73 10424.81,-312.96"/>
<polygon fill="black" stroke="black" points="10424.66,-309.46 10414.54,-312.6 10424.41,-316.45 10424.66,-309.46"/>
<text text-anchor="middle" x="12619.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu1</text>
</g>
<!-- l4_gate_gpu2&#45;&gt;l4_expert0_gpu0 -->
<g id="edge1956" class="edge">
<title>l4_gate_gpu2&#45;&gt;l4_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7303,-418.29C7291.98,-414.1 7280.3,-410.41 7269,-408.17 7233.3,-401.07 2052.7,-415.95 2027,-390.17 2022.29,-385.44 2022.3,-379.9 2027,-375.17 2037.94,-364.14 4247.48,-357.5 4263,-357.17 4736.41,-346.89 5304.17,-322.92 5512.37,-313.75"/>
<polygon fill="black" stroke="black" points="5512.76,-317.23 5522.6,-313.3 5512.46,-310.24 5512.76,-317.23"/>
<text text-anchor="middle" x="2072.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l4_gate_gpu2&#45;&gt;l4_expert1_gpu1 -->
<g id="edge1957" class="edge">
<title>l4_gate_gpu2&#45;&gt;l4_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7413.01,-418.34C7424.03,-414.15 7435.7,-410.44 7447,-408.17 7475.17,-402.49 9495.77,-410.57 9516,-390.17 9560.31,-345.47 9339.83,-323.52 9214.66,-314.81"/>
<polygon fill="black" stroke="black" points="9214.55,-311.29 9204.33,-314.1 9214.07,-318.28 9214.55,-311.29"/>
<text text-anchor="middle" x="9567.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l4_gate_gpu2&#45;&gt;l4_expert2_gpu2 -->
<g id="edge1958" class="edge">
<title>l4_gate_gpu2&#45;&gt;l4_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7414.14,-418.74C7424.86,-414.62 7436.14,-410.84 7447,-408.17 7529.79,-387.77 7558.85,-421.88 7638,-390.17 7647.99,-386.16 7647.21,-379.62 7657,-375.17 7742.1,-336.43 7849.05,-320.75 7921.34,-314.4"/>
<polygon fill="black" stroke="black" points="7922.08,-317.85 7931.75,-313.53 7921.49,-310.88 7922.08,-317.85"/>
<text text-anchor="middle" x="7702.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l4_gate_gpu2&#45;&gt;l4_expert3_gpu3 -->
<g id="edge1959" class="edge">
<title>l4_gate_gpu2&#45;&gt;l4_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7302.99,-418.37C7291.96,-414.17 7280.29,-410.46 7269,-408.17 7228.55,-399.94 5812.01,-419.53 5783,-390.17 5778.31,-385.42 5778.37,-379.96 5783,-375.17 5802.53,-354.93 6260.92,-358.85 6289,-357.17 6459.47,-346.96 6658.66,-328.65 6767.26,-318.12"/>
<polygon fill="black" stroke="black" points="6767.87,-321.58 6777.48,-317.13 6767.19,-314.61 6767.87,-321.58"/>
<text text-anchor="middle" x="5828.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l4_gate_gpu2&#45;&gt;l4_expert4_gpu4 -->
<g id="edge1960" class="edge">
<title>l4_gate_gpu2&#45;&gt;l4_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7413,-418.29C7424.02,-414.1 7435.7,-410.41 7447,-408.17 7486.68,-400.28 13243.44,-418.81 13272,-390.17 13276.71,-385.45 13276.6,-379.99 13272,-375.17 13226.84,-327.83 12259.36,-313.96 11968.8,-310.85"/>
<polygon fill="black" stroke="black" points="11968.79,-307.35 11958.75,-310.74 11968.72,-314.35 11968.79,-307.35"/>
<text text-anchor="middle" x="13321.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l4_gate_gpu2&#45;&gt;l4_expert5_gpu5 -->
<g id="edge1961" class="edge">
<title>l4_gate_gpu2&#45;&gt;l4_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7303,-418.31C7291.97,-414.12 7280.3,-410.43 7269,-408.17 7246.09,-403.59 3921.47,-406.73 3905,-390.17 3900.3,-385.44 3900.31,-379.9 3905,-375.17 3922.29,-357.7 5649.46,-358.37 5674,-357.17 5835.55,-349.25 6023.82,-330.44 6128.42,-319.14"/>
<polygon fill="black" stroke="black" points="6129.02,-322.59 6138.59,-318.04 6128.27,-315.63 6129.02,-322.59"/>
<text text-anchor="middle" x="3950.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l4_gate_gpu2&#45;&gt;l4_expert6_gpu6 -->
<g id="edge1962" class="edge">
<title>l4_gate_gpu2&#45;&gt;l4_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7303,-418.28C7291.98,-414.09 7280.3,-410.41 7269,-408.17 7245.17,-403.44 289.16,-407.37 272,-390.17 267.29,-385.45 267.33,-379.92 272,-375.17 341.57,-304.43 3544.98,-308.61 4101.13,-309.87"/>
<polygon fill="black" stroke="black" points="4101.45,-313.37 4111.46,-309.89 4101.47,-306.37 4101.45,-313.37"/>
<text text-anchor="middle" x="317.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l4_gate_gpu2&#45;&gt;l4_expert7_gpu7 -->
<g id="edge1963" class="edge">
<title>l4_gate_gpu2&#45;&gt;l4_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7413,-418.3C7424.02,-414.11 7435.7,-410.42 7447,-408.17 7473.88,-402.8 11374.66,-409.59 11394,-390.17 11462.99,-320.86 10683.92,-311.46 10425,-310.24"/>
<polygon fill="black" stroke="black" points="10424.92,-306.74 10414.9,-310.2 10424.89,-313.74 10424.92,-306.74"/>
<text text-anchor="middle" x="11444.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu2</text>
</g>
<!-- l4_gate_gpu3&#45;&gt;l4_expert0_gpu0 -->
<g id="edge1981" class="edge">
<title>l4_gate_gpu3&#45;&gt;l4_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9439,-418.29C9427.98,-414.1 9416.3,-410.41 9405,-408.17 9364.31,-400.08 3460.29,-419.55 3431,-390.17 3426.29,-385.45 3426.34,-379.93 3431,-375.17 3447.17,-358.64 4239.89,-357.83 4263,-357.17 4736.33,-343.68 5304.14,-321.64 5512.36,-313.36"/>
<polygon fill="black" stroke="black" points="5512.74,-316.85 5522.59,-312.95 5512.46,-309.85 5512.74,-316.85"/>
<text text-anchor="middle" x="3476.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l4_gate_gpu3&#45;&gt;l4_expert1_gpu1 -->
<g id="edge1982" class="edge">
<title>l4_gate_gpu3&#45;&gt;l4_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9574.12,-444.57C9864.08,-443.83 10844.19,-437.8 10890,-390.17 10894.62,-385.36 10894.65,-379.95 10890,-375.17 10877.84,-362.65 10279.44,-357.78 10262,-357.17 9869.47,-343.36 9400.36,-322.35 9214.55,-313.85"/>
<polygon fill="black" stroke="black" points="9214.47,-310.34 9204.32,-313.38 9214.15,-317.33 9214.47,-310.34"/>
<text text-anchor="middle" x="10939.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l4_gate_gpu3&#45;&gt;l4_expert2_gpu2 -->
<g id="edge1983" class="edge">
<title>l4_gate_gpu3&#45;&gt;l4_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9438.43,-418.55C9427.55,-414.4 9416.08,-410.66 9405,-408.17 9331.18,-391.58 9136.93,-413.64 9065,-390.17 9053.4,-386.38 9053.58,-379.01 9042,-375.17 8864.88,-316.43 8297.5,-310.1 8084.67,-309.85"/>
<polygon fill="black" stroke="black" points="8084.5,-306.35 8074.5,-309.85 8084.5,-313.35 8084.5,-306.35"/>
<text text-anchor="middle" x="9110.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l4_gate_gpu3&#45;&gt;l4_expert3_gpu3 -->
<g id="edge1984" class="edge">
<title>l4_gate_gpu3&#45;&gt;l4_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9438.99,-418.33C9427.97,-414.14 9416.3,-410.44 9405,-408.17 9284.2,-383.85 7304.97,-425.76 7187,-390.17 7175.32,-386.64 7175.29,-379.81 7164,-375.17 7087.55,-343.69 6994.21,-326.88 6928.87,-318.28"/>
<polygon fill="black" stroke="black" points="6928.99,-314.77 6918.63,-316.97 6928.1,-321.71 6928.99,-314.77"/>
<text text-anchor="middle" x="7232.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l4_gate_gpu3&#45;&gt;l4_expert4_gpu4 -->
<g id="edge1985" class="edge">
<title>l4_gate_gpu3&#45;&gt;l4_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9573.82,-442.13C9795.08,-435.22 10434.98,-416.05 10967,-408.17 10992.75,-407.78 14657.83,-408.42 14676,-390.17 14680.7,-385.44 14680.66,-379.94 14676,-375.17 14627.45,-325.47 12424.48,-312.57 11968.91,-310.43"/>
<polygon fill="black" stroke="black" points="11968.81,-306.93 11958.79,-310.39 11968.78,-313.93 11968.81,-306.93"/>
<text text-anchor="middle" x="14725.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l4_gate_gpu3&#45;&gt;l4_expert5_gpu5 -->
<g id="edge1986" class="edge">
<title>l4_gate_gpu3&#45;&gt;l4_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9439,-418.3C9427.98,-414.11 9416.3,-410.42 9405,-408.17 9377.1,-402.6 5329.07,-410.32 5309,-390.17 5304.3,-385.44 5304.4,-380 5309,-375.17 5323,-360.46 5653.75,-358.56 5674,-357.17 5835.14,-346.11 6023.18,-328.46 6127.92,-318.2"/>
<polygon fill="black" stroke="black" points="6128.49,-321.66 6138.11,-317.2 6127.81,-314.69 6128.49,-321.66"/>
<text text-anchor="middle" x="5354.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l4_gate_gpu3&#45;&gt;l4_expert6_gpu6 -->
<g id="edge1987" class="edge">
<title>l4_gate_gpu3&#45;&gt;l4_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9439,-418.28C9427.98,-414.09 9416.3,-410.41 9405,-408.17 9378.73,-402.96 1710.92,-409.13 1692,-390.17 1687.29,-385.45 1687.35,-379.94 1692,-375.17 1735.01,-331.02 3676.64,-313.89 4101.45,-310.67"/>
<polygon fill="black" stroke="black" points="4101.52,-314.17 4111.49,-310.59 4101.47,-307.17 4101.52,-314.17"/>
<text text-anchor="middle" x="1737.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l4_gate_gpu3&#45;&gt;l4_expert7_gpu7 -->
<g id="edge1988" class="edge">
<title>l4_gate_gpu3&#45;&gt;l4_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9573.83,-442.27C9795.09,-435.71 10435,-417.37 10967,-408.17 10992.43,-407.73 12780.11,-408.24 12798,-390.17 12802.69,-385.43 12802.67,-379.92 12798,-375.17 12778.69,-355.5 11833.55,-357.86 11806,-357.17 11279.59,-343.92 10646.86,-321.27 10424.8,-313.12"/>
<polygon fill="black" stroke="black" points="10424.66,-309.61 10414.54,-312.74 10424.4,-316.61 10424.66,-309.61"/>
<text text-anchor="middle" x="12847.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu3</text>
</g>
<!-- l4_gate_gpu4&#45;&gt;l4_expert0_gpu0 -->
<g id="edge2006" class="edge">
<title>l4_gate_gpu4&#45;&gt;l4_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8727,-418.29C8715.98,-414.1 8704.3,-410.41 8693,-408.17 8654.05,-400.43 3003.03,-418.29 2975,-390.17 2970.29,-385.45 2970.32,-379.91 2975,-375.17 2987.56,-362.43 4245.11,-357.61 4263,-357.17 4736.38,-345.49 5304.16,-322.36 5512.36,-313.58"/>
<polygon fill="black" stroke="black" points="5512.75,-317.07 5522.6,-313.15 5512.46,-310.07 5512.75,-317.07"/>
<text text-anchor="middle" x="3020.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l4_gate_gpu4&#45;&gt;l4_expert1_gpu1 -->
<g id="edge2007" class="edge">
<title>l4_gate_gpu4&#45;&gt;l4_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8837.01,-418.36C8848.04,-414.17 8859.71,-410.46 8871,-408.17 8914.37,-399.36 10432.89,-421.63 10464,-390.17 10468.69,-385.43 10468.6,-379.99 10464,-375.17 10453.17,-363.8 9502.68,-324.87 9214.75,-313.33"/>
<polygon fill="black" stroke="black" points="9214.51,-309.82 9204.38,-312.92 9214.23,-316.82 9214.51,-309.82"/>
<text text-anchor="middle" x="10513.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l4_gate_gpu4&#45;&gt;l4_expert2_gpu2 -->
<g id="edge2008" class="edge">
<title>l4_gate_gpu4&#45;&gt;l4_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8724.62,-419.39C8714.21,-415.31 8703.37,-411.38 8693,-408.17 8656.53,-396.88 8644.25,-404.84 8609,-390.17 8597.73,-385.48 8597.49,-379.29 8586,-375.17 8495.64,-342.74 8222.17,-322.78 8084.31,-314.51"/>
<polygon fill="black" stroke="black" points="8084.41,-311.01 8074.22,-313.91 8083.99,-317.99 8084.41,-311.01"/>
<text text-anchor="middle" x="8654.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l4_gate_gpu4&#45;&gt;l4_expert3_gpu3 -->
<g id="edge2009" class="edge">
<title>l4_gate_gpu4&#45;&gt;l4_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8726.99,-418.34C8715.97,-414.15 8704.3,-410.45 8693,-408.17 8666.29,-402.77 6750.18,-409.52 6731,-390.17 6708.73,-367.7 6738.31,-347.6 6773.29,-333.17"/>
<polygon fill="black" stroke="black" points="6774.74,-336.35 6782.76,-329.43 6772.17,-329.84 6774.74,-336.35"/>
<text text-anchor="middle" x="6776.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l4_gate_gpu4&#45;&gt;l4_expert4_gpu4 -->
<g id="edge2010" class="edge">
<title>l4_gate_gpu4&#45;&gt;l4_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8837,-418.29C8848.02,-414.1 8859.7,-410.41 8871,-408.17 8907.43,-400.92 14193.78,-416.48 14220,-390.17 14224.71,-385.44 14224.65,-379.95 14220,-375.17 14179.94,-333.97 12377.83,-314.67 11968.93,-310.82"/>
<polygon fill="black" stroke="black" points="11968.7,-307.31 11958.67,-310.72 11968.63,-314.31 11968.7,-307.31"/>
<text text-anchor="middle" x="14269.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l4_gate_gpu4&#45;&gt;l4_expert5_gpu5 -->
<g id="edge2011" class="edge">
<title>l4_gate_gpu4&#45;&gt;l4_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8727,-418.3C8715.97,-414.11 8704.3,-410.42 8693,-408.17 8666.85,-402.95 4871.81,-409.07 4853,-390.17 4848.3,-385.44 4848.34,-379.93 4853,-375.17 4868.95,-358.86 5651.22,-358.42 5674,-357.17 5835.5,-348.3 6023.79,-329.83 6128.4,-318.84"/>
<polygon fill="black" stroke="black" points="6128.99,-322.3 6138.57,-317.77 6128.26,-315.34 6128.99,-322.3"/>
<text text-anchor="middle" x="4898.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l4_gate_gpu4&#45;&gt;l4_expert6_gpu6 -->
<g id="edge2012" class="edge">
<title>l4_gate_gpu4&#45;&gt;l4_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8727,-418.28C8715.98,-414.09 8704.3,-410.41 8693,-408.17 8667.55,-403.12 1238.33,-408.54 1220,-390.17 1215.29,-385.45 1215.34,-379.93 1220,-375.17 1271.8,-322.21 3629.63,-311.86 4101.36,-310.32"/>
<polygon fill="black" stroke="black" points="4101.51,-313.82 4111.49,-310.28 4101.48,-306.82 4101.51,-313.82"/>
<text text-anchor="middle" x="1265.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l4_gate_gpu4&#45;&gt;l4_expert7_gpu7 -->
<g id="edge2013" class="edge">
<title>l4_gate_gpu4&#45;&gt;l4_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8837,-418.31C8848.03,-414.12 8859.7,-410.42 8871,-408.17 8894.64,-403.44 12325,-407.26 12342,-390.17 12346.7,-385.44 12346.64,-379.96 12342,-375.17 12340.94,-374.07 10799.87,-324.7 10424.63,-312.69"/>
<polygon fill="black" stroke="black" points="10424.51,-309.19 10414.4,-312.37 10424.28,-316.18 10424.51,-309.19"/>
<text text-anchor="middle" x="12391.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu4</text>
</g>
<!-- l4_gate_gpu5&#45;&gt;l4_expert0_gpu0 -->
<g id="edge2031" class="edge">
<title>l4_gate_gpu5&#45;&gt;l4_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M6921.95,-444.6C6268.72,-443.95 1837.17,-437.83 1790,-390.17 1785.31,-385.43 1785.3,-379.9 1790,-375.17 1802.1,-362.98 4245.83,-357.53 4263,-357.17 4736.42,-347.07 5304.17,-323 5512.37,-313.77"/>
<polygon fill="black" stroke="black" points="5512.77,-317.26 5522.6,-313.32 5512.45,-310.26 5512.77,-317.26"/>
<text text-anchor="middle" x="1835.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l4_gate_gpu5&#45;&gt;l4_expert1_gpu1 -->
<g id="edge2032" class="edge">
<title>l4_gate_gpu5&#45;&gt;l4_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7057.01,-418.33C7068.03,-414.14 7079.7,-410.44 7091,-408.17 7120.79,-402.17 9257.6,-411.74 9279,-390.17 9307.96,-360.96 9259.65,-339.49 9211,-326.17"/>
<polygon fill="black" stroke="black" points="9211.85,-322.77 9201.29,-323.61 9210.07,-329.54 9211.85,-322.77"/>
<text text-anchor="middle" x="9332.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l4_gate_gpu5&#45;&gt;l4_expert2_gpu2 -->
<g id="edge2033" class="edge">
<title>l4_gate_gpu5&#45;&gt;l4_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7057.58,-418.6C7068.46,-414.44 7079.93,-410.68 7091,-408.17 7158.29,-392.87 7336.5,-414.68 7401,-390.17 7411.06,-386.34 7410.05,-379.25 7420,-375.17 7508.8,-338.69 7783.01,-320.64 7921.37,-313.66"/>
<polygon fill="black" stroke="black" points="7921.68,-317.15 7931.5,-313.16 7921.33,-310.16 7921.68,-317.15"/>
<text text-anchor="middle" x="7465.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l4_gate_gpu5&#45;&gt;l4_expert3_gpu3 -->
<g id="edge2034" class="edge">
<title>l4_gate_gpu5&#45;&gt;l4_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M6921.79,-444.7C6623.66,-444.46 5594,-440 5546,-390.17 5541.37,-385.37 5541.34,-379.94 5546,-375.17 5560.42,-360.39 6268.39,-358.28 6289,-357.17 6459.52,-347.93 6658.7,-329.26 6767.28,-318.41"/>
<polygon fill="black" stroke="black" points="6767.9,-321.86 6777.5,-317.38 6767.2,-314.9 6767.9,-321.86"/>
<text text-anchor="middle" x="5591.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l4_gate_gpu5&#45;&gt;l4_expert4_gpu4 -->
<g id="edge2035" class="edge">
<title>l4_gate_gpu5&#45;&gt;l4_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7057,-418.29C7068.02,-414.1 7079.7,-410.41 7091,-408.17 7131.28,-400.16 12976,-419.25 13005,-390.17 13078.93,-316.01 12238.27,-309.94 11968.65,-309.89"/>
<polygon fill="black" stroke="black" points="11968.54,-306.39 11958.54,-309.89 11968.54,-313.39 11968.54,-306.39"/>
<text text-anchor="middle" x="13055.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l4_gate_gpu5&#45;&gt;l4_expert5_gpu5 -->
<g id="edge2036" class="edge">
<title>l4_gate_gpu5&#45;&gt;l4_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M6921.95,-444.9C6420.12,-446.14 3726.9,-450.04 3668,-390.17 3663.32,-385.41 3663.31,-379.9 3668,-375.17 3687.61,-355.38 5646.17,-358.51 5674,-357.17 5835.56,-349.34 6023.83,-330.5 6128.42,-319.17"/>
<polygon fill="black" stroke="black" points="6129.02,-322.62 6138.59,-318.06 6128.27,-315.67 6129.02,-322.62"/>
<text text-anchor="middle" x="3713.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l4_gate_gpu5&#45;&gt;l4_expert6_gpu6 -->
<g id="edge2037" class="edge">
<title>l4_gate_gpu5&#45;&gt;l4_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M6922.04,-444.43C6151.23,-442.06 66.92,-422.34 35,-390.17 30.3,-385.43 30.32,-379.92 35,-375.17 72.03,-337.55 3521.67,-314.24 4100.91,-310.59"/>
<polygon fill="black" stroke="black" points="4101.27,-314.09 4111.25,-310.52 4101.23,-307.09 4101.27,-314.09"/>
<text text-anchor="middle" x="80.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l4_gate_gpu5&#45;&gt;l4_expert7_gpu7 -->
<g id="edge2038" class="edge">
<title>l4_gate_gpu5&#45;&gt;l4_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7057,-418.3C7068.02,-414.11 7079.7,-410.42 7091,-408.17 7118.41,-402.7 11096.28,-409.98 11116,-390.17 11120.7,-385.44 11120.51,-380.07 11116,-375.17 11069.91,-325.03 10614.04,-313.49 10424.75,-310.85"/>
<polygon fill="black" stroke="black" points="10424.62,-307.35 10414.57,-310.72 10424.52,-314.35 10424.62,-307.35"/>
<text text-anchor="middle" x="11165.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu5</text>
</g>
<!-- l4_gate_gpu6&#45;&gt;l4_expert0_gpu0 -->
<g id="edge2056" class="edge">
<title>l4_gate_gpu6&#45;&gt;l4_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9261,-418.29C9249.98,-414.1 9238.3,-410.41 9227,-408.17 9186.74,-400.17 3345.98,-419.23 3317,-390.17 3312.29,-385.45 3312.33,-379.93 3317,-375.17 3335.41,-356.41 4236.73,-357.88 4263,-357.17 4736.35,-344.29 5304.15,-321.88 5512.36,-313.44"/>
<polygon fill="black" stroke="black" points="5512.74,-316.92 5522.59,-313.02 5512.46,-309.93 5512.74,-316.92"/>
<text text-anchor="middle" x="3362.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l4_gate_gpu6&#45;&gt;l4_expert1_gpu1 -->
<g id="edge2057" class="edge">
<title>l4_gate_gpu6&#45;&gt;l4_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9371.01,-418.38C9382.04,-414.18 9393.71,-410.47 9405,-408.17 9442.73,-400.48 10763.95,-417.57 10791,-390.17 10795.68,-385.42 10795.63,-379.96 10791,-375.17 10770.56,-354.02 10291.38,-358.28 10262,-357.17 9869.51,-342.3 9400.37,-321.89 9214.55,-313.7"/>
<polygon fill="black" stroke="black" points="9214.47,-310.19 9204.32,-313.25 9214.16,-317.19 9214.47,-310.19"/>
<text text-anchor="middle" x="10840.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l4_gate_gpu6&#45;&gt;l4_expert2_gpu2 -->
<g id="edge2058" class="edge">
<title>l4_gate_gpu6&#45;&gt;l4_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9260.4,-418.66C9249.53,-414.5 9238.06,-410.72 9227,-408.17 9107.23,-380.48 9067.63,-429.01 8951,-390.17 8939.42,-386.31 8939.57,-379.05 8928,-375.17 8772.92,-323.07 8281.07,-312.67 8084.92,-310.6"/>
<polygon fill="black" stroke="black" points="8084.71,-307.1 8074.67,-310.5 8084.64,-314.1 8084.71,-307.1"/>
<text text-anchor="middle" x="8996.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l4_gate_gpu6&#45;&gt;l4_expert3_gpu3 -->
<g id="edge2059" class="edge">
<title>l4_gate_gpu6&#45;&gt;l4_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9260.99,-418.33C9249.97,-414.14 9238.3,-410.44 9227,-408.17 9109.69,-384.54 7187.57,-424.75 7073,-390.17 7061.32,-386.64 7061.02,-380.42 7050,-375.17 7009.99,-356.09 6962.97,-340.57 6924.37,-329.48"/>
<polygon fill="black" stroke="black" points="6925.32,-326.11 6914.75,-326.76 6923.42,-332.85 6925.32,-326.11"/>
<text text-anchor="middle" x="7118.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l4_gate_gpu6&#45;&gt;l4_expert4_gpu4 -->
<g id="edge2060" class="edge">
<title>l4_gate_gpu6&#45;&gt;l4_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9371,-418.29C9382.02,-414.1 9393.7,-410.41 9405,-408.17 9440.12,-401.18 14536.72,-415.53 14562,-390.17 14566.71,-385.44 14566.66,-379.94 14562,-375.17 14515.57,-327.59 12412.68,-313.06 11968.75,-310.52"/>
<polygon fill="black" stroke="black" points="11968.59,-307.02 11958.57,-310.46 11968.55,-314.02 11968.59,-307.02"/>
<text text-anchor="middle" x="14611.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l4_gate_gpu6&#45;&gt;l4_expert5_gpu5 -->
<g id="edge2061" class="edge">
<title>l4_gate_gpu6&#45;&gt;l4_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9261,-418.3C9249.98,-414.11 9238.3,-410.42 9227,-408.17 9199.54,-402.69 5214.75,-410.01 5195,-390.17 5190.3,-385.44 5190.38,-379.97 5195,-375.17 5213.47,-355.99 5647.42,-358.83 5674,-357.17 5835.43,-347.04 6023.74,-329.02 6128.38,-318.45"/>
<polygon fill="black" stroke="black" points="6128.95,-321.91 6138.55,-317.42 6128.25,-314.94 6128.95,-321.91"/>
<text text-anchor="middle" x="5240.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l4_gate_gpu6&#45;&gt;l4_expert6_gpu6 -->
<g id="edge2062" class="edge">
<title>l4_gate_gpu6&#45;&gt;l4_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9261,-418.28C9249.98,-414.09 9238.3,-410.41 9227,-408.17 9200.89,-402.99 1580.8,-409.01 1562,-390.17 1557.29,-385.45 1557.34,-379.94 1562,-375.17 1607.43,-328.59 3663.47,-313.29 4101.48,-310.56"/>
<polygon fill="black" stroke="black" points="4101.55,-314.06 4111.53,-310.49 4101.51,-307.06 4101.55,-314.06"/>
<text text-anchor="middle" x="1607.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l4_gate_gpu6&#45;&gt;l4_expert7_gpu7 -->
<g id="edge2063" class="edge">
<title>l4_gate_gpu6&#45;&gt;l4_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9371,-418.31C9382.03,-414.12 9393.7,-410.43 9405,-408.17 9449.66,-399.24 12651.89,-422.46 12684,-390.17 12688.7,-385.44 12688.67,-379.93 12684,-375.17 12666.93,-357.74 11830.39,-357.81 11806,-357.17 11279.61,-343.3 10646.86,-321.03 10424.8,-313.05"/>
<polygon fill="black" stroke="black" points="10424.66,-309.54 10414.54,-312.68 10424.41,-316.54 10424.66,-309.54"/>
<text text-anchor="middle" x="12733.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu6</text>
</g>
<!-- l4_gate_gpu7&#45;&gt;l4_expert0_gpu0 -->
<g id="edge2081" class="edge">
<title>l4_gate_gpu7&#45;&gt;l4_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8905,-418.29C8893.98,-414.1 8882.3,-410.41 8871,-408.17 8831.62,-400.34 3117.35,-418.6 3089,-390.17 3084.29,-385.45 3084.32,-379.92 3089,-375.17 3100.44,-363.55 4246.7,-357.58 4263,-357.17 4736.37,-345.17 5304.16,-322.23 5512.36,-313.54"/>
<polygon fill="black" stroke="black" points="5512.75,-317.03 5522.6,-313.11 5512.46,-310.03 5512.75,-317.03"/>
<text text-anchor="middle" x="3134.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l4_gate_gpu7&#45;&gt;l4_expert1_gpu1 -->
<g id="edge2082" class="edge">
<title>l4_gate_gpu7&#45;&gt;l4_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9015.01,-418.37C9026.04,-414.17 9037.71,-410.46 9049,-408.17 9090.62,-399.71 10548.14,-420.38 10578,-390.17 10582.69,-385.42 10582.61,-379.99 10578,-375.17 10572.06,-368.95 9518.67,-325.74 9214.41,-313.38"/>
<polygon fill="black" stroke="black" points="9214.46,-309.88 9204.33,-312.97 9214.18,-316.87 9214.46,-309.88"/>
<text text-anchor="middle" x="10627.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l4_gate_gpu7&#45;&gt;l4_expert2_gpu2 -->
<g id="edge2083" class="edge">
<title>l4_gate_gpu7&#45;&gt;l4_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8903.8,-418.98C8893.08,-414.84 8881.83,-410.99 8871,-408.17 8806.88,-391.45 8785.26,-412.85 8723,-390.17 8711.53,-385.99 8711.52,-379.18 8700,-375.17 8588.34,-336.23 8243.68,-318.88 8084.78,-312.8"/>
<polygon fill="black" stroke="black" points="8084.71,-309.29 8074.58,-312.42 8084.44,-316.29 8084.71,-309.29"/>
<text text-anchor="middle" x="8768.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l4_gate_gpu7&#45;&gt;l4_expert3_gpu3 -->
<g id="edge2084" class="edge">
<title>l4_gate_gpu7&#45;&gt;l4_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8904.99,-418.34C8893.97,-414.15 8882.3,-410.44 8871,-408.17 8843.42,-402.6 6864.81,-410.15 6845,-390.17 6838.67,-383.78 6835.72,-375.51 6834.86,-366.71"/>
<polygon fill="black" stroke="black" points="6838.36,-366.58 6834.71,-356.63 6831.36,-366.68 6838.36,-366.58"/>
<text text-anchor="middle" x="6890.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l4_gate_gpu7&#45;&gt;l4_expert4_gpu4 -->
<g id="edge2085" class="edge">
<title>l4_gate_gpu7&#45;&gt;l4_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9015,-418.29C9026.02,-414.1 9037.7,-410.41 9049,-408.17 9085,-401.01 14308.09,-416.16 14334,-390.17 14338.71,-385.44 14338.65,-379.94 14334,-375.17 14291.81,-331.84 12389.5,-314.1 11968.79,-310.71"/>
<polygon fill="black" stroke="black" points="11968.57,-307.21 11958.54,-310.62 11968.51,-314.2 11968.57,-307.21"/>
<text text-anchor="middle" x="14383.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l4_gate_gpu7&#45;&gt;l4_expert5_gpu5 -->
<g id="edge2086" class="edge">
<title>l4_gate_gpu7&#45;&gt;l4_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8905,-418.3C8893.98,-414.11 8882.3,-410.42 8871,-408.17 8844.41,-402.86 4986.13,-409.38 4967,-390.17 4962.3,-385.44 4962.35,-379.94 4967,-375.17 4980.71,-361.1 5654.39,-358.28 5674,-357.17 5835.49,-348.01 6023.78,-329.65 6128.4,-318.75"/>
<polygon fill="black" stroke="black" points="6128.98,-322.21 6138.57,-317.69 6128.26,-315.25 6128.98,-322.21"/>
<text text-anchor="middle" x="5012.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l4_gate_gpu7&#45;&gt;l4_expert6_gpu6 -->
<g id="edge2087" class="edge">
<title>l4_gate_gpu7&#45;&gt;l4_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8905,-418.28C8893.98,-414.09 8882.3,-410.41 8871,-408.17 8845.33,-403.08 1352.48,-408.69 1334,-390.17 1329.29,-385.45 1329.34,-379.93 1334,-375.17 1383.67,-324.35 3640.05,-312.32 4101.21,-310.39"/>
<polygon fill="black" stroke="black" points="4101.46,-313.89 4111.44,-310.35 4101.43,-306.89 4101.46,-313.89"/>
<text text-anchor="middle" x="1379.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l4_gate_gpu7&#45;&gt;l4_expert7_gpu7 -->
<g id="edge2088" class="edge">
<title>l4_gate_gpu7&#45;&gt;l4_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M9015,-418.31C9026.03,-414.12 9037.7,-410.42 9049,-408.17 9072.2,-403.53 12439.31,-406.94 12456,-390.17 12460.7,-385.44 12460.65,-379.95 12456,-375.17 12443.41,-362.22 11824.05,-357.71 11806,-357.17 11279.66,-341.41 10646.88,-320.31 10424.81,-312.84"/>
<polygon fill="black" stroke="black" points="10424.66,-309.34 10414.55,-312.5 10424.42,-316.33 10424.66,-309.34"/>
<text text-anchor="middle" x="12505.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu7</text>
</g>
<!-- l4_gate_gpu8&#45;&gt;l4_expert0_gpu0 -->
<g id="edge2106" class="edge">
<title>l4_gate_gpu8&#45;&gt;l4_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7659,-418.29C7647.98,-414.1 7636.3,-410.41 7625,-408.17 7588.49,-400.91 2290.28,-416.54 2264,-390.17 2259.29,-385.44 2259.31,-379.9 2264,-375.17 2283.54,-355.45 4235.24,-357.78 4263,-357.17 4736.41,-346.66 5304.17,-322.83 5512.36,-313.72"/>
<polygon fill="black" stroke="black" points="5512.76,-317.21 5522.6,-313.27 5512.46,-310.21 5512.76,-317.21"/>
<text text-anchor="middle" x="2309.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l4_gate_gpu8&#45;&gt;l4_expert1_gpu1 -->
<g id="edge2107" class="edge">
<title>l4_gate_gpu8&#45;&gt;l4_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7769.01,-418.34C7780.03,-414.15 7791.7,-410.45 7803,-408.17 7829.55,-402.81 9733.94,-409.41 9753,-390.17 9757.69,-385.43 9757.46,-380.12 9753,-375.17 9717.61,-335.87 9374.83,-318.64 9214.69,-312.69"/>
<polygon fill="black" stroke="black" points="9214.53,-309.18 9204.41,-312.31 9214.27,-316.17 9214.53,-309.18"/>
<text text-anchor="middle" x="9802.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l4_gate_gpu8&#45;&gt;l4_expert2_gpu2 -->
<g id="edge2108" class="edge">
<title>l4_gate_gpu8&#45;&gt;l4_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7771.96,-419.49C7782.2,-415.45 7792.84,-411.5 7803,-408.17 7834.34,-397.88 7845.39,-404.71 7875,-390.17 7884.66,-385.42 7885.14,-381.27 7894,-375.17 7908.49,-365.18 7924.54,-355.1 7939.77,-345.94"/>
<polygon fill="black" stroke="black" points="7941.83,-348.79 7948.63,-340.67 7938.25,-342.78 7941.83,-348.79"/>
<text text-anchor="middle" x="7939.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l4_gate_gpu8&#45;&gt;l4_expert3_gpu3 -->
<g id="edge2109" class="edge">
<title>l4_gate_gpu8&#45;&gt;l4_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7658.99,-418.36C7647.96,-414.17 7636.29,-410.46 7625,-408.17 7581.3,-399.3 6051.35,-421.87 6020,-390.17 5977.65,-347.34 6228.95,-361.7 6289,-357.17 6459.05,-344.32 6658,-327.02 6766.76,-317.37"/>
<polygon fill="black" stroke="black" points="6767.35,-320.83 6777,-316.46 6766.73,-313.86 6767.35,-320.83"/>
<text text-anchor="middle" x="6065.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l4_gate_gpu8&#45;&gt;l4_expert4_gpu4 -->
<g id="edge2110" class="edge">
<title>l4_gate_gpu8&#45;&gt;l4_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7769,-418.29C7780.02,-414.1 7791.7,-410.41 7803,-408.17 7841.87,-400.44 13481.02,-418.23 13509,-390.17 13513.71,-385.45 13513.62,-379.97 13509,-375.17 13455.19,-319.15 12290.94,-311.35 11968.9,-310.26"/>
<polygon fill="black" stroke="black" points="11968.72,-306.76 11958.71,-310.23 11968.7,-313.76 11968.72,-306.76"/>
<text text-anchor="middle" x="13558.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l4_gate_gpu8&#45;&gt;l4_expert5_gpu5 -->
<g id="edge2111" class="edge">
<title>l4_gate_gpu8&#45;&gt;l4_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7659,-418.31C7647.97,-414.12 7636.3,-410.42 7625,-408.17 7601.28,-403.43 4159.06,-407.31 4142,-390.17 4137.3,-385.44 4137.31,-379.91 4142,-375.17 4156.96,-360.03 5652.75,-358.23 5674,-357.17 5835.55,-349.12 6023.82,-330.36 6128.42,-319.1"/>
<polygon fill="black" stroke="black" points="6129.02,-322.55 6138.58,-318 6128.27,-315.6 6129.02,-322.55"/>
<text text-anchor="middle" x="4187.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l4_gate_gpu8&#45;&gt;l4_expert6_gpu6 -->
<g id="edge2112" class="edge">
<title>l4_gate_gpu8&#45;&gt;l4_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7659,-418.28C7647.98,-414.09 7636.3,-410.41 7625,-408.17 7600.76,-403.36 526.45,-407.66 509,-390.17 504.29,-385.45 504.33,-379.92 509,-375.17 574.11,-308.89 3564.6,-309.34 4101.05,-309.96"/>
<polygon fill="black" stroke="black" points="4101.4,-313.46 4111.4,-309.97 4101.41,-306.46 4101.4,-313.46"/>
<text text-anchor="middle" x="554.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l4_gate_gpu8&#45;&gt;l4_expert7_gpu7 -->
<g id="edge2113" class="edge">
<title>l4_gate_gpu8&#45;&gt;l4_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7769,-418.3C7780.03,-414.11 7791.7,-410.42 7803,-408.17 7829.07,-402.96 11612.25,-409.01 11631,-390.17 11635.7,-385.44 11635.59,-380 11631,-375.17 11589.38,-331.39 10702.28,-315.16 10425.04,-311.15"/>
<polygon fill="black" stroke="black" points="10424.7,-307.65 10414.65,-311 10424.6,-314.65 10424.7,-307.65"/>
<text text-anchor="middle" x="11680.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu8</text>
</g>
<!-- l4_gate_gpu9&#45;&gt;l4_expert0_gpu0 -->
<g id="edge2115" class="edge">
<title>l4_gate_gpu9&#45;&gt;l4_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7837,-418.29C7825.98,-414.1 7814.3,-410.41 7803,-408.17 7766.05,-400.82 2404.6,-416.85 2378,-390.17 2373.29,-385.44 2373.31,-379.9 2378,-375.17 2396.42,-356.57 4236.82,-357.75 4263,-357.17 4736.4,-346.53 5304.17,-322.78 5512.36,-313.71"/>
<polygon fill="black" stroke="black" points="5512.76,-317.19 5522.6,-313.26 5512.46,-310.2 5512.76,-317.19"/>
<text text-anchor="middle" x="2423.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l4_gate_gpu9&#45;&gt;l4_expert1_gpu1 -->
<g id="edge2116" class="edge">
<title>l4_gate_gpu9&#45;&gt;l4_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7947.01,-418.35C7958.03,-414.15 7969.71,-410.45 7981,-408.17 8006.68,-402.98 9848.57,-408.78 9867,-390.17 9871.69,-385.43 9871.5,-380.08 9867,-375.17 9823.63,-327.79 9396.59,-314.69 9214.54,-311.25"/>
<polygon fill="black" stroke="black" points="9214.54,-307.75 9204.48,-311.06 9214.41,-314.75 9214.54,-307.75"/>
<text text-anchor="middle" x="9916.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l4_gate_gpu9&#45;&gt;l4_expert2_gpu2 -->
<g id="edge2117" class="edge">
<title>l4_gate_gpu9&#45;&gt;l4_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7952.84,-421.28C7966.61,-413.33 7979.85,-403.09 7989,-390.17 7993.81,-383.37 7997.15,-375.45 7999.44,-367.29"/>
<polygon fill="black" stroke="black" points="8002.91,-367.8 8001.73,-357.27 7996.09,-366.24 8002.91,-367.8"/>
<text text-anchor="middle" x="8042.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l4_gate_gpu9&#45;&gt;l4_expert3_gpu3 -->
<g id="edge2118" class="edge">
<title>l4_gate_gpu9&#45;&gt;l4_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7836.99,-418.36C7825.96,-414.16 7814.29,-410.46 7803,-408.17 7780.28,-403.56 6150.3,-406.65 6134,-390.17 6129.31,-385.43 6129.51,-380.09 6134,-375.17 6139.3,-369.36 6581.47,-332.14 6767.23,-316.74"/>
<polygon fill="black" stroke="black" points="6767.54,-320.23 6777.22,-315.91 6766.97,-313.25 6767.54,-320.23"/>
<text text-anchor="middle" x="6179.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l4_gate_gpu9&#45;&gt;l4_expert4_gpu4 -->
<g id="edge2119" class="edge">
<title>l4_gate_gpu9&#45;&gt;l4_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7947,-418.29C7958.02,-414.1 7969.7,-410.41 7981,-408.17 8019.43,-400.53 13595.34,-417.92 13623,-390.17 13627.71,-385.44 13627.62,-379.97 13623,-375.17 13565,-314.95 12304.75,-310.22 11968.72,-310.03"/>
<polygon fill="black" stroke="black" points="11968.58,-306.53 11958.58,-310.03 11968.58,-313.53 11968.58,-306.53"/>
<text text-anchor="middle" x="13672.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l4_gate_gpu9&#45;&gt;l4_expert5_gpu5 -->
<g id="edge2120" class="edge">
<title>l4_gate_gpu9&#45;&gt;l4_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7837,-418.3C7825.97,-414.12 7814.3,-410.42 7803,-408.17 7778.84,-403.34 4273.37,-407.63 4256,-390.17 4251.3,-385.44 4251.32,-379.91 4256,-375.17 4269.84,-361.15 5654.33,-358.16 5674,-357.17 5835.54,-349.04 6023.82,-330.31 6128.42,-319.08"/>
<polygon fill="black" stroke="black" points="6129.02,-322.53 6138.58,-317.98 6128.26,-315.57 6129.02,-322.53"/>
<text text-anchor="middle" x="4301.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l4_gate_gpu9&#45;&gt;l4_expert6_gpu6 -->
<g id="edge2121" class="edge">
<title>l4_gate_gpu9&#45;&gt;l4_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7837,-418.28C7825.98,-414.09 7814.3,-410.41 7803,-408.17 7778.55,-403.32 640.61,-407.82 623,-390.17 618.29,-385.45 618.33,-379.92 623,-375.17 685.97,-311.03 3574.53,-309.71 4101.08,-310.01"/>
<polygon fill="black" stroke="black" points="4101.25,-313.51 4111.25,-310.01 4101.25,-306.51 4101.25,-313.51"/>
<text text-anchor="middle" x="668.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l4_gate_gpu9&#45;&gt;l4_expert7_gpu7 -->
<g id="edge2122" class="edge">
<title>l4_gate_gpu9&#45;&gt;l4_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7947,-418.3C7958.03,-414.11 7969.7,-410.42 7981,-408.17 8006.63,-403.05 11726.56,-408.69 11745,-390.17 11749.7,-385.44 11749.6,-379.99 11745,-375.17 11699.22,-327.21 10717.7,-313.75 10424.8,-310.8"/>
<polygon fill="black" stroke="black" points="10424.71,-307.3 10414.68,-310.7 10424.64,-314.3 10424.71,-307.3"/>
<text text-anchor="middle" x="11794.5" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu9</text>
</g>
<!-- l4_gate_gpu10&#45;&gt;l4_expert0_gpu0 -->
<g id="edge2124" class="edge">
<title>l4_gate_gpu10&#45;&gt;l4_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7125,-418.29C7113.98,-414.1 7102.3,-410.41 7091,-408.17 7055.67,-401.14 1929.43,-415.68 1904,-390.17 1899.29,-385.44 1899.3,-379.9 1904,-375.17 1915.54,-363.54 4246.62,-357.52 4263,-357.17 4736.41,-346.99 5304.17,-322.96 5512.37,-313.76"/>
<polygon fill="black" stroke="black" points="5512.76,-317.25 5522.6,-313.31 5512.45,-310.25 5512.76,-317.25"/>
<text text-anchor="middle" x="1954" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l4_gate_gpu10&#45;&gt;l4_expert1_gpu1 -->
<g id="edge2125" class="edge">
<title>l4_gate_gpu10&#45;&gt;l4_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7235.01,-418.34C7246.03,-414.14 7257.7,-410.44 7269,-408.17 7297.92,-402.34 9372.23,-411.12 9393,-390.17 9450.65,-332.02 9310.98,-315.9 9214.81,-311.55"/>
<polygon fill="black" stroke="black" points="9214.91,-308.06 9204.77,-311.14 9214.61,-315.05 9214.91,-308.06"/>
<text text-anchor="middle" x="9454" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l4_gate_gpu10&#45;&gt;l4_expert2_gpu2 -->
<g id="edge2126" class="edge">
<title>l4_gate_gpu10&#45;&gt;l4_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7236.09,-418.55C7246.82,-414.45 7258.11,-410.73 7269,-408.17 7375.71,-383.06 7412.82,-429.88 7515,-390.17 7525.03,-386.27 7524.1,-379.39 7534,-375.17 7602.08,-346.14 7806.42,-325.74 7921.66,-316.2"/>
<polygon fill="black" stroke="black" points="7922.16,-319.67 7931.84,-315.37 7921.59,-312.7 7922.16,-319.67"/>
<text text-anchor="middle" x="7584" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l4_gate_gpu10&#45;&gt;l4_expert3_gpu3 -->
<g id="edge2127" class="edge">
<title>l4_gate_gpu10&#45;&gt;l4_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7124.99,-418.37C7113.96,-414.18 7102.29,-410.47 7091,-408.17 7052.05,-400.23 5687.93,-418.45 5660,-390.17 5655.32,-385.42 5655.35,-379.95 5660,-375.17 5672.18,-362.63 6271.55,-358.15 6289,-357.17 6459.5,-347.55 6658.69,-329.02 6767.27,-318.3"/>
<polygon fill="black" stroke="black" points="6767.89,-321.75 6777.49,-317.28 6767.2,-314.79 6767.89,-321.75"/>
<text text-anchor="middle" x="5710" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l4_gate_gpu10&#45;&gt;l4_expert4_gpu4 -->
<g id="edge2128" class="edge">
<title>l4_gate_gpu10&#45;&gt;l4_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7235,-418.29C7246.02,-414.1 7257.7,-410.41 7269,-408.17 7309.05,-400.21 13120.17,-419.08 13149,-390.17 13153.71,-385.45 13153.59,-380 13149,-375.17 13108.31,-332.32 12242.01,-315.49 11968.79,-311.24"/>
<polygon fill="black" stroke="black" points="11968.6,-307.74 11958.54,-311.08 11968.49,-314.73 11968.6,-307.74"/>
<text text-anchor="middle" x="13203" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l4_gate_gpu10&#45;&gt;l4_expert5_gpu5 -->
<g id="edge2129" class="edge">
<title>l4_gate_gpu10&#45;&gt;l4_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7125,-418.31C7113.97,-414.12 7102.3,-410.43 7091,-408.17 7045.93,-399.16 3814.41,-422.75 3782,-390.17 3777.3,-385.44 3777.31,-379.9 3782,-375.17 3800.49,-356.5 5647.75,-358.44 5674,-357.17 5835.56,-349.3 6023.82,-330.48 6128.42,-319.16"/>
<polygon fill="black" stroke="black" points="6129.02,-322.61 6138.59,-318.05 6128.27,-315.65 6129.02,-322.61"/>
<text text-anchor="middle" x="3832" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l4_gate_gpu10&#45;&gt;l4_expert6_gpu6 -->
<g id="edge2130" class="edge">
<title>l4_gate_gpu10&#45;&gt;l4_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7125,-418.28C7113.98,-414.09 7102.3,-410.41 7091,-408.17 7067.36,-403.47 166.02,-407.23 149,-390.17 144.29,-385.45 144.32,-379.92 149,-375.17 184.96,-338.62 3532.74,-314.46 4101.36,-310.62"/>
<polygon fill="black" stroke="black" points="4101.55,-314.12 4111.52,-310.55 4101.5,-307.12 4101.55,-314.12"/>
<text text-anchor="middle" x="199" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l4_gate_gpu10&#45;&gt;l4_expert7_gpu7 -->
<g id="edge2131" class="edge">
<title>l4_gate_gpu10&#45;&gt;l4_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7235,-418.3C7246.02,-414.11 7257.7,-410.42 7269,-408.17 7296.26,-402.73 11251.39,-409.86 11271,-390.17 11275.7,-385.44 11275.55,-380.04 11271,-375.17 11213.91,-313.94 10640.59,-309.2 10424.67,-309.61"/>
<polygon fill="black" stroke="black" points="10424.65,-306.11 10414.66,-309.63 10424.67,-313.11 10424.65,-306.11"/>
<text text-anchor="middle" x="11325" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu10</text>
</g>
<!-- l4_gate_gpu11&#45;&gt;l4_expert0_gpu0 -->
<g id="edge2133" class="edge">
<title>l4_gate_gpu11&#45;&gt;l4_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7481,-418.29C7469.98,-414.1 7458.3,-410.41 7447,-408.17 7410.86,-400.98 2167.01,-416.27 2141,-390.17 2136.29,-385.44 2136.31,-379.9 2141,-375.17 2161.75,-354.24 4233.53,-357.81 4263,-357.17 4736.41,-346.79 5304.17,-322.88 5512.37,-313.74"/>
<polygon fill="black" stroke="black" points="5512.76,-317.22 5522.6,-313.28 5512.46,-310.23 5512.76,-317.22"/>
<text text-anchor="middle" x="2191" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l4_gate_gpu11&#45;&gt;l4_expert1_gpu1 -->
<g id="edge2134" class="edge">
<title>l4_gate_gpu11&#45;&gt;l4_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7591.01,-418.34C7602.03,-414.15 7613.7,-410.45 7625,-408.17 7652.3,-402.66 9610.4,-409.95 9630,-390.17 9689.97,-329.65 9370.32,-314.86 9214.5,-311.25"/>
<polygon fill="black" stroke="black" points="9214.55,-307.75 9204.48,-311.03 9214.4,-314.75 9214.55,-307.75"/>
<text text-anchor="middle" x="9688" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l4_gate_gpu11&#45;&gt;l4_expert2_gpu2 -->
<g id="edge2135" class="edge">
<title>l4_gate_gpu11&#45;&gt;l4_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7592.72,-418.96C7603.29,-414.88 7614.36,-411.05 7625,-408.17 7680.02,-393.24 7699.59,-412.6 7752,-390.17 7761.89,-385.93 7761.41,-380.05 7771,-375.17 7819.1,-350.68 7877.65,-334.34 7923.9,-324.16"/>
<polygon fill="black" stroke="black" points="7924.83,-327.54 7933.87,-322.02 7923.36,-320.7 7924.83,-327.54"/>
<text text-anchor="middle" x="7821" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l4_gate_gpu11&#45;&gt;l4_expert3_gpu3 -->
<g id="edge2136" class="edge">
<title>l4_gate_gpu11&#45;&gt;l4_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7480.99,-418.36C7469.96,-414.17 7458.29,-410.46 7447,-408.17 7404.8,-399.6 5927.27,-420.79 5897,-390.17 5892.31,-385.43 5892.4,-379.99 5897,-375.17 5912.06,-359.4 6267.25,-358.58 6289,-357.17 6459.18,-346.1 6658.08,-328.14 6766.79,-317.9"/>
<polygon fill="black" stroke="black" points="6767.4,-321.36 6777.03,-316.93 6766.75,-314.39 6767.4,-321.36"/>
<text text-anchor="middle" x="5947" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l4_gate_gpu11&#45;&gt;l4_expert4_gpu4 -->
<g id="edge2137" class="edge">
<title>l4_gate_gpu11&#45;&gt;l4_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7591,-418.29C7602.02,-414.1 7613.7,-410.41 7625,-408.17 7664.24,-400.37 13357.75,-418.5 13386,-390.17 13390.71,-385.45 13390.61,-379.98 13386,-375.17 13336.68,-323.66 12274.62,-312.65 11968.74,-310.54"/>
<polygon fill="black" stroke="black" points="11968.64,-307.04 11958.62,-310.47 11968.59,-314.04 11968.64,-307.04"/>
<text text-anchor="middle" x="13440" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l4_gate_gpu11&#45;&gt;l4_expert5_gpu5 -->
<g id="edge2138" class="edge">
<title>l4_gate_gpu11&#45;&gt;l4_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7481,-418.31C7469.97,-414.12 7458.3,-410.42 7447,-408.17 7423.66,-403.5 4035.79,-407.04 4019,-390.17 4014.3,-385.44 4014.31,-379.91 4019,-375.17 4035.17,-358.82 5651.04,-358.3 5674,-357.17 5835.55,-349.19 6023.82,-330.4 6128.42,-319.12"/>
<polygon fill="black" stroke="black" points="6129.02,-322.58 6138.58,-318.02 6128.27,-315.62 6129.02,-322.58"/>
<text text-anchor="middle" x="4069" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l4_gate_gpu11&#45;&gt;l4_expert6_gpu6 -->
<g id="edge2139" class="edge">
<title>l4_gate_gpu11&#45;&gt;l4_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7481,-418.28C7469.98,-414.09 7458.3,-410.41 7447,-408.17 7422.95,-403.39 403.31,-407.53 386,-390.17 381.29,-385.45 381.33,-379.92 386,-375.17 453.43,-306.57 3555.32,-308.96 4101.35,-309.91"/>
<polygon fill="black" stroke="black" points="4101.49,-313.41 4111.5,-309.93 4101.51,-306.41 4101.49,-313.41"/>
<text text-anchor="middle" x="436" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l4_gate_gpu11&#45;&gt;l4_expert7_gpu7 -->
<g id="edge2140" class="edge">
<title>l4_gate_gpu11&#45;&gt;l4_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M7591,-418.3C7602.03,-414.11 7613.7,-410.42 7625,-408.17 7651.44,-402.89 11488.98,-409.28 11508,-390.17 11585.26,-312.55 10702.1,-308.9 10424.79,-309.66"/>
<polygon fill="black" stroke="black" points="10424.78,-306.16 10414.79,-309.69 10424.8,-313.16 10424.78,-306.16"/>
<text text-anchor="middle" x="11563" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu11</text>
</g>
<!-- l4_gate_gpu12&#45;&gt;l4_expert0_gpu0 -->
<g id="edge2142" class="edge">
<title>l4_gate_gpu12&#45;&gt;l4_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M10976.18,-442.12C10754.92,-435.17 10115.02,-415.91 9583,-408.17 9554.23,-407.75 5459.3,-410.56 5439,-390.17 5407.87,-358.9 5462.36,-337.28 5515.11,-324.46"/>
<polygon fill="black" stroke="black" points="5515.98,-327.85 5524.92,-322.17 5514.39,-321.04 5515.98,-327.85"/>
<text text-anchor="middle" x="5489" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l4_gate_gpu12&#45;&gt;l4_expert1_gpu1 -->
<g id="edge2143" class="edge">
<title>l4_gate_gpu12&#45;&gt;l4_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M11135.98,-443.8C11485.87,-439.84 12865.89,-422.21 12897,-390.17 12901.64,-385.38 12901.7,-379.9 12897,-375.17 12884.1,-362.18 10280.29,-357.61 10262,-357.17 9869.34,-347.64 9400.3,-324.22 9214.53,-314.46"/>
<polygon fill="black" stroke="black" points="9214.47,-310.95 9204.3,-313.92 9214.1,-317.94 9214.47,-310.95"/>
<text text-anchor="middle" x="12951" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l4_gate_gpu12&#45;&gt;l4_expert2_gpu2 -->
<g id="edge2144" class="edge">
<title>l4_gate_gpu12&#45;&gt;l4_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M11032,-409.75C11020.68,-396.31 11005.93,-382.46 10989,-375.17 10939.58,-353.89 9105.79,-358.62 9052,-357.17 8691.08,-347.39 8260.75,-324.56 8084.43,-314.73"/>
<polygon fill="black" stroke="black" points="8084.38,-311.22 8074.2,-314.15 8083.99,-318.21 8084.38,-311.22"/>
<text text-anchor="middle" x="11062" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l4_gate_gpu12&#45;&gt;l4_expert3_gpu3 -->
<g id="edge2145" class="edge">
<title>l4_gate_gpu12&#45;&gt;l4_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M10976.18,-442.69C10620.51,-433.85 9196.49,-397.98 9175,-390.17 9164.89,-386.49 9166.14,-378.77 9156,-375.17 9091.39,-352.21 7990.53,-359.17 7922,-357.17 7551.19,-346.34 7108.74,-323.94 6929.44,-314.47"/>
<polygon fill="black" stroke="black" points="6929.47,-310.96 6919.3,-313.93 6929.1,-317.95 6929.47,-310.96"/>
<text text-anchor="middle" x="9225" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l4_gate_gpu12&#45;&gt;l4_expert4_gpu4 -->
<g id="edge2146" class="edge">
<title>l4_gate_gpu12&#45;&gt;l4_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M11136.37,-444.29C11685.48,-441.65 14863.77,-424.88 14898,-390.17 14902.68,-385.42 14902.66,-379.93 14898,-375.17 14845.3,-321.32 12445.46,-311.67 11968.8,-310.29"/>
<polygon fill="black" stroke="black" points="11968.58,-306.79 11958.57,-310.26 11968.56,-313.79 11968.58,-306.79"/>
<text text-anchor="middle" x="14952" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l4_gate_gpu12&#45;&gt;l4_expert5_gpu5 -->
<g id="edge2147" class="edge">
<title>l4_gate_gpu12&#45;&gt;l4_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M10976.17,-442.21C10754.91,-435.52 10115.01,-416.85 9583,-408.17 9519.51,-407.13 7356.91,-411.23 7297,-390.17 7286.85,-386.6 7288.1,-378.87 7278,-375.17 7224.67,-355.59 6823.71,-360.56 6767,-357.17 6597.07,-347.01 6398.55,-328.72 6290.04,-318.17"/>
<polygon fill="black" stroke="black" points="6290.12,-314.67 6279.83,-317.18 6289.44,-321.63 6290.12,-314.67"/>
<text text-anchor="middle" x="7347" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l4_gate_gpu12&#45;&gt;l4_expert6_gpu6 -->
<g id="edge2148" class="edge">
<title>l4_gate_gpu12&#45;&gt;l4_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M10976.18,-442.08C10754.92,-435.03 10115.03,-415.55 9583,-408.17 9562.09,-407.88 3575.76,-404.97 3561,-390.17 3556.29,-385.45 3556.54,-380.12 3561,-375.17 3596.53,-335.72 3940.82,-318.56 4101.35,-312.66"/>
<polygon fill="black" stroke="black" points="4101.79,-316.14 4111.66,-312.28 4101.53,-309.15 4101.79,-316.14"/>
<text text-anchor="middle" x="3611" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l4_gate_gpu12&#45;&gt;l4_expert7_gpu7 -->
<g id="edge2149" class="edge">
<title>l4_gate_gpu12&#45;&gt;l4_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M11136.26,-444.26C11676.04,-441.44 14756.78,-423.87 14790,-390.17 14794.68,-385.42 14794.7,-379.89 14790,-375.17 14775.39,-360.47 11826.72,-357.56 11806,-357.17 11279.52,-347.11 10646.83,-322.49 10424.79,-313.47"/>
<polygon fill="black" stroke="black" points="10424.67,-309.96 10414.53,-313.05 10424.38,-316.95 10424.67,-309.96"/>
<text text-anchor="middle" x="14844" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu12</text>
</g>
<!-- l4_gate_gpu13&#45;&gt;l4_expert0_gpu0 -->
<g id="edge2151" class="edge">
<title>l4_gate_gpu13&#45;&gt;l4_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8015,-418.29C8003.98,-414.1 7992.3,-410.41 7981,-408.17 7943.61,-400.73 2518.91,-417.16 2492,-390.17 2487.29,-385.44 2487.31,-379.9 2492,-375.17 2509.31,-357.68 4238.41,-357.73 4263,-357.17 4736.4,-346.39 5304.17,-322.72 5512.36,-313.69"/>
<polygon fill="black" stroke="black" points="5512.76,-317.17 5522.6,-313.24 5512.46,-310.18 5512.76,-317.17"/>
<text text-anchor="middle" x="2542" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l4_gate_gpu13&#45;&gt;l4_expert1_gpu1 -->
<g id="edge2152" class="edge">
<title>l4_gate_gpu13&#45;&gt;l4_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8125.01,-418.35C8136.03,-414.16 8147.71,-410.45 8159,-408.17 8183.8,-403.15 9963.19,-408.15 9981,-390.17 9985.69,-385.43 9985.53,-380.06 9981,-375.17 9929.63,-319.7 9417.66,-311.33 9214.99,-310.2"/>
<polygon fill="black" stroke="black" points="9214.72,-306.69 9204.7,-310.14 9214.68,-313.69 9214.72,-306.69"/>
<text text-anchor="middle" x="10035" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l4_gate_gpu13&#45;&gt;l4_expert2_gpu2 -->
<g id="edge2153" class="edge">
<title>l4_gate_gpu13&#45;&gt;l4_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8099.52,-410.72C8105.93,-399.29 8109.18,-386.56 8103,-375.17 8095.63,-361.57 8084.05,-350.37 8071.35,-341.33"/>
<polygon fill="black" stroke="black" points="8073.14,-338.31 8062.88,-335.69 8069.27,-344.14 8073.14,-338.31"/>
<text text-anchor="middle" x="8157" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l4_gate_gpu13&#45;&gt;l4_expert3_gpu3 -->
<g id="edge2154" class="edge">
<title>l4_gate_gpu13&#45;&gt;l4_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8014.99,-418.35C8003.97,-414.16 7992.29,-410.45 7981,-408.17 7957.41,-403.39 6264.93,-407.28 6248,-390.17 6243.31,-385.43 6243.55,-380.13 6248,-375.17 6282.02,-337.25 6610.63,-319.38 6766.6,-312.98"/>
<polygon fill="black" stroke="black" points="6766.77,-316.48 6776.62,-312.58 6766.48,-309.49 6766.77,-316.48"/>
<text text-anchor="middle" x="6298" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l4_gate_gpu13&#45;&gt;l4_expert4_gpu4 -->
<g id="edge2155" class="edge">
<title>l4_gate_gpu13&#45;&gt;l4_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8125,-418.29C8136.02,-414.1 8147.7,-410.41 8159,-408.17 8196.99,-400.61 13709.65,-417.6 13737,-390.17 13741.71,-385.44 13741.63,-379.96 13737,-375.17 13674.8,-310.74 12318.06,-309.17 11968.54,-309.84"/>
<polygon fill="black" stroke="black" points="11968.49,-306.34 11958.5,-309.86 11968.5,-313.34 11968.49,-306.34"/>
<text text-anchor="middle" x="13791" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l4_gate_gpu13&#45;&gt;l4_expert5_gpu5 -->
<g id="edge2156" class="edge">
<title>l4_gate_gpu13&#45;&gt;l4_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8015,-418.3C8003.97,-414.11 7992.3,-410.42 7981,-408.17 7956.41,-403.26 4387.69,-407.94 4370,-390.17 4365.3,-385.44 4365.32,-379.91 4370,-375.17 4382.72,-362.27 5655.91,-358.09 5674,-357.17 5835.54,-348.95 6023.81,-330.25 6128.41,-319.05"/>
<polygon fill="black" stroke="black" points="6129.01,-322.5 6138.58,-317.95 6128.26,-315.54 6129.01,-322.5"/>
<text text-anchor="middle" x="4420" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l4_gate_gpu13&#45;&gt;l4_expert6_gpu6 -->
<g id="edge2157" class="edge">
<title>l4_gate_gpu13&#45;&gt;l4_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8015,-418.28C8003.98,-414.09 7992.3,-410.41 7981,-408.17 7956.33,-403.27 754.76,-407.97 737,-390.17 732.29,-385.45 732.33,-379.92 737,-375.17 797.83,-313.18 3583.69,-310.1 4100.86,-310.06"/>
<polygon fill="black" stroke="black" points="4101.21,-313.56 4111.21,-310.06 4101.21,-306.56 4101.21,-313.56"/>
<text text-anchor="middle" x="787" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l4_gate_gpu13&#45;&gt;l4_expert7_gpu7 -->
<g id="edge2158" class="edge">
<title>l4_gate_gpu13&#45;&gt;l4_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8125,-418.3C8136.03,-414.11 8147.7,-410.42 8159,-408.17 8184.2,-403.14 11840.88,-408.38 11859,-390.17 11863.7,-385.44 11863.61,-379.98 11859,-375.17 11809.08,-323.06 10733.8,-312.47 10425.15,-310.5"/>
<polygon fill="black" stroke="black" points="10424.95,-307 10414.93,-310.44 10424.91,-314 10424.95,-307"/>
<text text-anchor="middle" x="11913" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu13</text>
</g>
<!-- l4_gate_gpu14&#45;&gt;l4_expert0_gpu0 -->
<g id="edge2160" class="edge">
<title>l4_gate_gpu14&#45;&gt;l4_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8549,-418.29C8537.98,-414.1 8526.3,-410.41 8515,-408.17 8476.43,-400.5 2879.76,-418.02 2852,-390.17 2847.29,-385.44 2847.32,-379.91 2852,-375.17 2865.77,-361.22 4243.41,-357.64 4263,-357.17 4736.39,-345.78 5304.16,-322.48 5512.36,-313.61"/>
<polygon fill="black" stroke="black" points="5512.76,-317.1 5522.6,-313.18 5512.46,-310.11 5512.76,-317.1"/>
<text text-anchor="middle" x="2902" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l4_gate_gpu14&#45;&gt;l4_expert1_gpu1 -->
<g id="edge2161" class="edge">
<title>l4_gate_gpu14&#45;&gt;l4_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8659.01,-418.36C8670.04,-414.16 8681.71,-410.46 8693,-408.17 8737.87,-399.07 10308.81,-422.71 10341,-390.17 10345.69,-385.43 10345.59,-380.01 10341,-375.17 10321.59,-354.68 9482.85,-322.7 9214.59,-312.98"/>
<polygon fill="black" stroke="black" points="9214.65,-309.48 9204.53,-312.62 9214.4,-316.48 9214.65,-309.48"/>
<text text-anchor="middle" x="10395" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l4_gate_gpu14&#45;&gt;l4_expert2_gpu2 -->
<g id="edge2162" class="edge">
<title>l4_gate_gpu14&#45;&gt;l4_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8548.42,-418.67C8508.59,-400.2 8460.24,-378.16 8450,-375.17 8325.51,-338.79 8175.32,-322.26 8084.59,-315.1"/>
<polygon fill="black" stroke="black" points="8084.61,-311.59 8074.37,-314.32 8084.07,-318.57 8084.61,-311.59"/>
<text text-anchor="middle" x="8534" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l4_gate_gpu14&#45;&gt;l4_expert3_gpu3 -->
<g id="edge2163" class="edge">
<title>l4_gate_gpu14&#45;&gt;l4_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8548.99,-418.34C8537.97,-414.15 8526.3,-410.45 8515,-408.17 8489.04,-402.92 6626.64,-408.98 6608,-390.17 6555.61,-337.28 6677.76,-319.32 6766.32,-313.22"/>
<polygon fill="black" stroke="black" points="6766.64,-316.71 6776.4,-312.57 6766.19,-309.72 6766.64,-316.71"/>
<text text-anchor="middle" x="6658" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l4_gate_gpu14&#45;&gt;l4_expert4_gpu4 -->
<g id="edge2164" class="edge">
<title>l4_gate_gpu14&#45;&gt;l4_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8659,-418.29C8670.02,-414.1 8681.7,-410.41 8693,-408.17 8729.81,-400.85 14070.51,-416.75 14097,-390.17 14101.71,-385.44 14101.64,-379.95 14097,-375.17 14059.21,-336.25 12363.97,-315.3 11968.75,-310.95"/>
<polygon fill="black" stroke="black" points="11968.58,-307.44 11958.55,-310.83 11968.51,-314.44 11968.58,-307.44"/>
<text text-anchor="middle" x="14151" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l4_gate_gpu14&#45;&gt;l4_expert5_gpu5 -->
<g id="edge2165" class="edge">
<title>l4_gate_gpu14&#45;&gt;l4_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8549,-418.3C8537.97,-414.11 8526.3,-410.42 8515,-408.17 8489.22,-403.02 4748.54,-408.8 4730,-390.17 4725.3,-385.44 4725.33,-379.93 4730,-375.17 4748.37,-356.45 5647.81,-358.57 5674,-357.17 5835.52,-348.53 6023.8,-329.98 6128.41,-318.91"/>
<polygon fill="black" stroke="black" points="6129,-322.37 6138.57,-317.84 6128.26,-315.41 6129,-322.37"/>
<text text-anchor="middle" x="4780" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l4_gate_gpu14&#45;&gt;l4_expert6_gpu6 -->
<g id="edge2166" class="edge">
<title>l4_gate_gpu14&#45;&gt;l4_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8549,-418.28C8537.98,-414.09 8526.3,-410.41 8515,-408.17 8489.74,-403.16 1115.19,-408.4 1097,-390.17 1092.29,-385.45 1092.34,-379.93 1097,-375.17 1151.11,-319.91 3618.47,-311.38 4101.48,-310.24"/>
<polygon fill="black" stroke="black" points="4101.52,-313.74 4111.51,-310.22 4101.5,-306.74 4101.52,-313.74"/>
<text text-anchor="middle" x="1147" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l4_gate_gpu14&#45;&gt;l4_expert7_gpu7 -->
<g id="edge2167" class="edge">
<title>l4_gate_gpu14&#45;&gt;l4_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8659,-418.31C8670.03,-414.12 8681.7,-410.42 8693,-408.17 8717.01,-403.37 12201.73,-407.53 12219,-390.17 12223.7,-385.44 12223.63,-379.96 12219,-375.17 12215.04,-371.07 10784.43,-324.4 10424.45,-312.72"/>
<polygon fill="black" stroke="black" points="10424.48,-309.22 10414.37,-312.39 10424.25,-316.22 10424.48,-309.22"/>
<text text-anchor="middle" x="12273" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu14</text>
</g>
<!-- l4_gate_gpu15&#45;&gt;l4_expert0_gpu0 -->
<g id="edge2169" class="edge">
<title>l4_gate_gpu15&#45;&gt;l4_expert0_gpu0</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8193,-418.29C8181.98,-414.1 8170.3,-410.41 8159,-408.17 8121.24,-400.66 2642.18,-417.43 2615,-390.17 2610.29,-385.44 2610.31,-379.91 2615,-375.17 2631.1,-358.89 4240.12,-357.7 4263,-357.17 4736.4,-346.21 5304.17,-322.65 5512.36,-313.67"/>
<polygon fill="black" stroke="black" points="5512.76,-317.15 5522.6,-313.22 5512.46,-310.16 5512.76,-317.15"/>
<text text-anchor="middle" x="2665" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l4_gate_gpu15&#45;&gt;l4_expert1_gpu1 -->
<g id="edge2170" class="edge">
<title>l4_gate_gpu15&#45;&gt;l4_expert1_gpu1</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8303.01,-418.35C8314.03,-414.16 8325.71,-410.45 8337,-408.17 8361.06,-403.3 10086.73,-407.61 10104,-390.17 10167.05,-326.47 9460.07,-313.35 9214.94,-310.72"/>
<polygon fill="black" stroke="black" points="9214.7,-307.22 9204.66,-310.62 9214.63,-314.22 9214.7,-307.22"/>
<text text-anchor="middle" x="10158" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l4_gate_gpu15&#45;&gt;l4_expert2_gpu2 -->
<g id="edge2171" class="edge">
<title>l4_gate_gpu15&#45;&gt;l4_expert2_gpu2</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8235.25,-408.42C8229.47,-396.41 8221.52,-383.89 8211,-375.17 8175.01,-345.31 8125.29,-329.11 8083.48,-320.35"/>
<polygon fill="black" stroke="black" points="8084.08,-316.9 8073.59,-318.38 8082.72,-323.76 8084.08,-316.9"/>
<text text-anchor="middle" x="8274" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l4_gate_gpu15&#45;&gt;l4_expert3_gpu3 -->
<g id="edge2172" class="edge">
<title>l4_gate_gpu15&#45;&gt;l4_expert3_gpu3</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8192.99,-418.35C8181.97,-414.16 8170.29,-410.45 8159,-408.17 8134.66,-403.24 6388.47,-407.82 6371,-390.17 6313.86,-332.45 6615.4,-316.23 6766.21,-311.75"/>
<polygon fill="black" stroke="black" points="6766.46,-315.25 6776.36,-311.46 6766.26,-308.25 6766.46,-315.25"/>
<text text-anchor="middle" x="6421" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l4_gate_gpu15&#45;&gt;l4_expert4_gpu4 -->
<g id="edge2173" class="edge">
<title>l4_gate_gpu15&#45;&gt;l4_expert4_gpu4</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8303,-418.29C8314.02,-414.1 8325.7,-410.41 8337,-408.17 8374.62,-400.69 13832.92,-417.33 13860,-390.17 13864.71,-385.44 13864.64,-379.96 13860,-375.17 13793.28,-306.21 12333.11,-308.1 11968.79,-309.65"/>
<polygon fill="black" stroke="black" points="11968.57,-306.15 11958.59,-309.69 11968.6,-313.15 11968.57,-306.15"/>
<text text-anchor="middle" x="13914" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l4_gate_gpu15&#45;&gt;l4_expert5_gpu5 -->
<g id="edge2174" class="edge">
<title>l4_gate_gpu15&#45;&gt;l4_expert5_gpu5</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8193,-418.3C8181.97,-414.11 8170.3,-410.42 8159,-408.17 8134.03,-403.18 4510.96,-408.21 4493,-390.17 4488.3,-385.44 4488.32,-379.92 4493,-375.17 4516.02,-351.79 5641.23,-358.86 5674,-357.17 5835.53,-348.84 6023.81,-330.18 6128.41,-319.01"/>
<polygon fill="black" stroke="black" points="6129.01,-322.47 6138.58,-317.92 6128.26,-315.51 6129.01,-322.47"/>
<text text-anchor="middle" x="4543" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l4_gate_gpu15&#45;&gt;l4_expert6_gpu6 -->
<g id="edge2175" class="edge">
<title>l4_gate_gpu15&#45;&gt;l4_expert6_gpu6</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8193,-418.28C8181.98,-414.09 8170.3,-410.41 8159,-408.17 8134.14,-403.24 877.9,-408.11 860,-390.17 855.29,-385.45 855.33,-379.93 860,-375.17 918.54,-315.47 3596.47,-310.52 4101.37,-310.12"/>
<polygon fill="black" stroke="black" points="4101.49,-313.62 4111.49,-310.11 4101.48,-306.62 4101.49,-313.62"/>
<text text-anchor="middle" x="910" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
<!-- l4_gate_gpu15&#45;&gt;l4_expert7_gpu7 -->
<g id="edge2176" class="edge">
<title>l4_gate_gpu15&#45;&gt;l4_expert7_gpu7</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8303,-418.3C8314.03,-414.11 8325.7,-410.42 8337,-408.17 8361.82,-403.21 11964.15,-408.11 11982,-390.17 11986.7,-385.44 11986.62,-379.97 11982,-375.17 11968.36,-360.97 10754.36,-322.71 10424.77,-312.57"/>
<polygon fill="black" stroke="black" points="10424.45,-309.06 10414.35,-312.25 10424.24,-316.06 10424.45,-309.06"/>
<text text-anchor="middle" x="12036" y="-378.97" font-family="Times,serif" font-size="14.00">tokens_gpu15</text>
</g>
</g>
</svg>
