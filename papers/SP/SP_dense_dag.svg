<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="9263pt" height="20528pt"
 viewBox="0.00 0.00 9263.00 20528.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 20524)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-20524 9259,-20524 9259,4 -4,4"/>
<text text-anchor="middle" x="4627.5" y="-37.8" font-family="Times,serif" font-size="14.00">Dense Transformer (4L) &#45; 16 GPUs &#45; Ring Attention + Sequence Parallelism</text>
<text text-anchor="middle" x="4627.5" y="-22.8" font-family="Times,serif" font-size="14.00">Global: B=1024, L=16384, d_model=4096, H=32</text>
<text text-anchor="middle" x="4627.5" y="-7.8" font-family="Times,serif" font-size="14.00">Per GPU: L/P=1024, Sequence Parallel</text>
<g id="clust1" class="cluster">
<title>cluster_gpu_0</title>
<path fill="lightblue" stroke="lightblue" d="M20,-61C20,-61 430,-61 430,-61 436,-61 442,-67 442,-73 442,-73 442,-20500 442,-20500 442,-20506 436,-20512 430,-20512 430,-20512 20,-20512 20,-20512 14,-20512 8,-20506 8,-20500 8,-20500 8,-73 8,-73 8,-67 14,-61 20,-61"/>
<text text-anchor="middle" x="225" y="-20496.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_gpu_1</title>
<path fill="lightblue" stroke="lightblue" d="M607,-61C607,-61 1017,-61 1017,-61 1023,-61 1029,-67 1029,-73 1029,-73 1029,-20500 1029,-20500 1029,-20506 1023,-20512 1017,-20512 1017,-20512 607,-20512 607,-20512 601,-20512 595,-20506 595,-20500 595,-20500 595,-73 595,-73 595,-67 601,-61 607,-61"/>
<text text-anchor="middle" x="812" y="-20496.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_gpu_2</title>
<path fill="lightblue" stroke="lightblue" d="M1194,-61C1194,-61 1604,-61 1604,-61 1610,-61 1616,-67 1616,-73 1616,-73 1616,-20500 1616,-20500 1616,-20506 1610,-20512 1604,-20512 1604,-20512 1194,-20512 1194,-20512 1188,-20512 1182,-20506 1182,-20500 1182,-20500 1182,-73 1182,-73 1182,-67 1188,-61 1194,-61"/>
<text text-anchor="middle" x="1399" y="-20496.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_gpu_3</title>
<path fill="lightblue" stroke="lightblue" d="M1781,-61C1781,-61 2191,-61 2191,-61 2197,-61 2203,-67 2203,-73 2203,-73 2203,-20500 2203,-20500 2203,-20506 2197,-20512 2191,-20512 2191,-20512 1781,-20512 1781,-20512 1775,-20512 1769,-20506 1769,-20500 1769,-20500 1769,-73 1769,-73 1769,-67 1775,-61 1781,-61"/>
<text text-anchor="middle" x="1986" y="-20496.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_gpu_4</title>
<path fill="lightblue" stroke="lightblue" d="M2368,-61C2368,-61 2778,-61 2778,-61 2784,-61 2790,-67 2790,-73 2790,-73 2790,-20500 2790,-20500 2790,-20506 2784,-20512 2778,-20512 2778,-20512 2368,-20512 2368,-20512 2362,-20512 2356,-20506 2356,-20500 2356,-20500 2356,-73 2356,-73 2356,-67 2362,-61 2368,-61"/>
<text text-anchor="middle" x="2573" y="-20496.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<g id="clust26" class="cluster">
<title>cluster_gpu_5</title>
<path fill="lightblue" stroke="lightblue" d="M2955,-61C2955,-61 3365,-61 3365,-61 3371,-61 3377,-67 3377,-73 3377,-73 3377,-20500 3377,-20500 3377,-20506 3371,-20512 3365,-20512 3365,-20512 2955,-20512 2955,-20512 2949,-20512 2943,-20506 2943,-20500 2943,-20500 2943,-73 2943,-73 2943,-67 2949,-61 2955,-61"/>
<text text-anchor="middle" x="3160" y="-20496.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<g id="clust31" class="cluster">
<title>cluster_gpu_6</title>
<path fill="lightblue" stroke="lightblue" d="M3542,-61C3542,-61 3952,-61 3952,-61 3958,-61 3964,-67 3964,-73 3964,-73 3964,-20500 3964,-20500 3964,-20506 3958,-20512 3952,-20512 3952,-20512 3542,-20512 3542,-20512 3536,-20512 3530,-20506 3530,-20500 3530,-20500 3530,-73 3530,-73 3530,-67 3536,-61 3542,-61"/>
<text text-anchor="middle" x="3747" y="-20496.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<g id="clust36" class="cluster">
<title>cluster_gpu_7</title>
<path fill="lightblue" stroke="lightblue" d="M4129,-61C4129,-61 4539,-61 4539,-61 4545,-61 4551,-67 4551,-73 4551,-73 4551,-20500 4551,-20500 4551,-20506 4545,-20512 4539,-20512 4539,-20512 4129,-20512 4129,-20512 4123,-20512 4117,-20506 4117,-20500 4117,-20500 4117,-73 4117,-73 4117,-67 4123,-61 4129,-61"/>
<text text-anchor="middle" x="4334" y="-20496.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<g id="clust41" class="cluster">
<title>cluster_gpu_8</title>
<path fill="lightblue" stroke="lightblue" d="M4716,-61C4716,-61 5126,-61 5126,-61 5132,-61 5138,-67 5138,-73 5138,-73 5138,-20500 5138,-20500 5138,-20506 5132,-20512 5126,-20512 5126,-20512 4716,-20512 4716,-20512 4710,-20512 4704,-20506 4704,-20500 4704,-20500 4704,-73 4704,-73 4704,-67 4710,-61 4716,-61"/>
<text text-anchor="middle" x="4921" y="-20496.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<g id="clust46" class="cluster">
<title>cluster_gpu_9</title>
<path fill="lightblue" stroke="lightblue" d="M5303,-61C5303,-61 5713,-61 5713,-61 5719,-61 5725,-67 5725,-73 5725,-73 5725,-20500 5725,-20500 5725,-20506 5719,-20512 5713,-20512 5713,-20512 5303,-20512 5303,-20512 5297,-20512 5291,-20506 5291,-20500 5291,-20500 5291,-73 5291,-73 5291,-67 5297,-61 5303,-61"/>
<text text-anchor="middle" x="5508" y="-20496.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<g id="clust51" class="cluster">
<title>cluster_gpu_10</title>
<path fill="lightblue" stroke="lightblue" d="M5890,-61C5890,-61 6300,-61 6300,-61 6306,-61 6312,-67 6312,-73 6312,-73 6312,-20500 6312,-20500 6312,-20506 6306,-20512 6300,-20512 6300,-20512 5890,-20512 5890,-20512 5884,-20512 5878,-20506 5878,-20500 5878,-20500 5878,-73 5878,-73 5878,-67 5884,-61 5890,-61"/>
<text text-anchor="middle" x="6095" y="-20496.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<g id="clust56" class="cluster">
<title>cluster_gpu_11</title>
<path fill="lightblue" stroke="lightblue" d="M6477,-61C6477,-61 6887,-61 6887,-61 6893,-61 6899,-67 6899,-73 6899,-73 6899,-20500 6899,-20500 6899,-20506 6893,-20512 6887,-20512 6887,-20512 6477,-20512 6477,-20512 6471,-20512 6465,-20506 6465,-20500 6465,-20500 6465,-73 6465,-73 6465,-67 6471,-61 6477,-61"/>
<text text-anchor="middle" x="6682" y="-20496.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<g id="clust61" class="cluster">
<title>cluster_gpu_12</title>
<path fill="lightblue" stroke="lightblue" d="M7064,-61C7064,-61 7474,-61 7474,-61 7480,-61 7486,-67 7486,-73 7486,-73 7486,-20500 7486,-20500 7486,-20506 7480,-20512 7474,-20512 7474,-20512 7064,-20512 7064,-20512 7058,-20512 7052,-20506 7052,-20500 7052,-20500 7052,-73 7052,-73 7052,-67 7058,-61 7064,-61"/>
<text text-anchor="middle" x="7269" y="-20496.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<g id="clust66" class="cluster">
<title>cluster_gpu_13</title>
<path fill="lightblue" stroke="lightblue" d="M7651,-61C7651,-61 8061,-61 8061,-61 8067,-61 8073,-67 8073,-73 8073,-73 8073,-20500 8073,-20500 8073,-20506 8067,-20512 8061,-20512 8061,-20512 7651,-20512 7651,-20512 7645,-20512 7639,-20506 7639,-20500 7639,-20500 7639,-73 7639,-73 7639,-67 7645,-61 7651,-61"/>
<text text-anchor="middle" x="7856" y="-20496.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<g id="clust71" class="cluster">
<title>cluster_gpu_14</title>
<path fill="lightblue" stroke="lightblue" d="M8238,-61C8238,-61 8648,-61 8648,-61 8654,-61 8660,-67 8660,-73 8660,-73 8660,-20500 8660,-20500 8660,-20506 8654,-20512 8648,-20512 8648,-20512 8238,-20512 8238,-20512 8232,-20512 8226,-20506 8226,-20500 8226,-20500 8226,-73 8226,-73 8226,-67 8232,-61 8238,-61"/>
<text text-anchor="middle" x="8443" y="-20496.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<g id="clust76" class="cluster">
<title>cluster_gpu_15</title>
<path fill="lightblue" stroke="lightblue" d="M8825,-61C8825,-61 9235,-61 9235,-61 9241,-61 9247,-67 9247,-73 9247,-73 9247,-20500 9247,-20500 9247,-20506 9241,-20512 9235,-20512 9235,-20512 8825,-20512 8825,-20512 8819,-20512 8813,-20506 8813,-20500 8813,-20500 8813,-73 8813,-73 8813,-67 8819,-61 8825,-61"/>
<text text-anchor="middle" x="9030" y="-20496.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- input_0 -->
<g id="node1" class="node">
<title>input_0</title>
<polygon fill="lightgreen" stroke="black" points="318.5,-20458 131.5,-20458 131.5,-20420 318.5,-20420 318.5,-20458"/>
<text text-anchor="middle" x="225" y="-20442.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="225" y="-20427.8" font-family="Times,serif" font-size="14.00">X[0]: 1024×1024×4096</text>
</g>
<!-- qkv_proj_0_0 -->
<g id="node2" class="node">
<title>qkv_proj_0_0</title>
<polygon fill="none" stroke="black" points="307.5,-20347 142.5,-20347 142.5,-20294 307.5,-20294 307.5,-20347"/>
<text text-anchor="middle" x="225" y="-20331.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="225" y="-20316.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="225" y="-20301.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- input_0&#45;&gt;qkv_proj_0_0 -->
<g id="edge1" class="edge">
<title>input_0&#45;&gt;qkv_proj_0_0</title>
<path fill="none" stroke="black" d="M225,-20419.96C225,-20419.96 225,-20357.44 225,-20357.44"/>
<polygon fill="black" stroke="black" points="228.5,-20357.44 225,-20347.44 221.5,-20357.44 228.5,-20357.44"/>
</g>
<!-- qkv_reshape_0_0 -->
<g id="node3" class="node">
<title>qkv_reshape_0_0</title>
<ellipse fill="none" stroke="black" cx="225" cy="-20194" rx="148" ry="27"/>
<text text-anchor="middle" x="225" y="-20197.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="225" y="-20182.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_0_0&#45;&gt;qkv_reshape_0_0 -->
<g id="edge2" class="edge">
<title>qkv_proj_0_0&#45;&gt;qkv_reshape_0_0</title>
<path fill="none" stroke="black" d="M225,-20293.98C225,-20293.98 225,-20231.36 225,-20231.36"/>
<polygon fill="black" stroke="black" points="228.5,-20231.36 225,-20221.36 221.5,-20231.36 228.5,-20231.36"/>
</g>
<!-- ring_attn_0_0_stage_0 -->
<g id="node4" class="node">
<title>ring_attn_0_0_stage_0</title>
<polygon fill="yellow" stroke="black" points="225,-20050 16,-19982 225,-19914 434,-19982 225,-20050"/>
<text text-anchor="middle" x="225" y="-20000.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-19985.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="225" y="-19970.8" font-family="Times,serif" font-size="14.00">Q[0]×K[0]×V[0]</text>
<text text-anchor="middle" x="225" y="-19955.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- qkv_reshape_0_0&#45;&gt;ring_attn_0_0_stage_0 -->
<g id="edge3" class="edge">
<title>qkv_reshape_0_0&#45;&gt;ring_attn_0_0_stage_0</title>
<path fill="none" stroke="black" d="M225,-20166.72C225,-20166.72 225,-20060.16 225,-20060.16"/>
<polygon fill="black" stroke="black" points="228.5,-20060.16 225,-20050.16 221.5,-20060.16 228.5,-20060.16"/>
</g>
<!-- ring_attn_0_0_stage_1 -->
<g id="node5" class="node">
<title>ring_attn_0_0_stage_1</title>
<polygon fill="yellow" stroke="black" points="225,-19797 16,-19729 225,-19661 434,-19729 225,-19797"/>
<text text-anchor="middle" x="225" y="-19747.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-19732.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="225" y="-19717.8" font-family="Times,serif" font-size="14.00">Q[0]×K[15]×V[15]</text>
<text text-anchor="middle" x="225" y="-19702.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_0&#45;&gt;ring_attn_0_0_stage_1 -->
<g id="edge4" class="edge">
<title>ring_attn_0_0_stage_0&#45;&gt;ring_attn_0_0_stage_1</title>
<path fill="none" stroke="black" d="M155.33,-19936.48C155.33,-19936.48 155.33,-19784.58 155.33,-19784.58"/>
<polygon fill="black" stroke="black" points="158.83,-19784.58 155.33,-19774.58 151.83,-19784.58 158.83,-19784.58"/>
</g>
<!-- ring_attn_0_1_stage_0 -->
<g id="node102" class="node">
<title>ring_attn_0_1_stage_0</title>
<polygon fill="yellow" stroke="black" points="812,-20050 603,-19982 812,-19914 1021,-19982 812,-20050"/>
<text text-anchor="middle" x="812" y="-20000.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-19985.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="812" y="-19970.8" font-family="Times,serif" font-size="14.00">Q[1]×K[1]×V[1]</text>
<text text-anchor="middle" x="812" y="-19955.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_0&#45;&gt;ring_attn_0_1_stage_0 -->
<g id="edge1553" class="edge">
<title>ring_attn_0_0_stage_0&#45;&gt;ring_attn_0_1_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-19982C434.02,-19982 592.86,-19982 592.86,-19982"/>
<polygon fill="red" stroke="red" points="592.86,-19985.5 602.86,-19982 592.86,-19978.5 592.86,-19985.5"/>
</g>
<!-- ring_attn_0_0_stage_2 -->
<g id="node6" class="node">
<title>ring_attn_0_0_stage_2</title>
<polygon fill="yellow" stroke="black" points="225,-19544 16,-19476 225,-19408 434,-19476 225,-19544"/>
<text text-anchor="middle" x="225" y="-19494.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-19479.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="225" y="-19464.8" font-family="Times,serif" font-size="14.00">Q[0]×K[14]×V[14]</text>
<text text-anchor="middle" x="225" y="-19449.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_1&#45;&gt;ring_attn_0_0_stage_2 -->
<g id="edge5" class="edge">
<title>ring_attn_0_0_stage_1&#45;&gt;ring_attn_0_0_stage_2</title>
<path fill="none" stroke="black" d="M155.33,-19683.48C155.33,-19683.48 155.33,-19531.58 155.33,-19531.58"/>
<polygon fill="black" stroke="black" points="158.83,-19531.58 155.33,-19521.58 151.83,-19531.58 158.83,-19531.58"/>
</g>
<!-- ring_attn_0_1_stage_1 -->
<g id="node103" class="node">
<title>ring_attn_0_1_stage_1</title>
<polygon fill="yellow" stroke="black" points="812,-19797 603,-19729 812,-19661 1021,-19729 812,-19797"/>
<text text-anchor="middle" x="812" y="-19747.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-19732.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="812" y="-19717.8" font-family="Times,serif" font-size="14.00">Q[1]×K[0]×V[0]</text>
<text text-anchor="middle" x="812" y="-19702.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_1&#45;&gt;ring_attn_0_1_stage_1 -->
<g id="edge1554" class="edge">
<title>ring_attn_0_0_stage_1&#45;&gt;ring_attn_0_1_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-19729C434.02,-19729 592.86,-19729 592.86,-19729"/>
<polygon fill="red" stroke="red" points="592.86,-19732.5 602.86,-19729 592.86,-19725.5 592.86,-19732.5"/>
</g>
<!-- ring_attn_0_0_stage_3 -->
<g id="node7" class="node">
<title>ring_attn_0_0_stage_3</title>
<polygon fill="yellow" stroke="black" points="225,-19291 16,-19223 225,-19155 434,-19223 225,-19291"/>
<text text-anchor="middle" x="225" y="-19241.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-19226.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="225" y="-19211.8" font-family="Times,serif" font-size="14.00">Q[0]×K[13]×V[13]</text>
<text text-anchor="middle" x="225" y="-19196.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_2&#45;&gt;ring_attn_0_0_stage_3 -->
<g id="edge6" class="edge">
<title>ring_attn_0_0_stage_2&#45;&gt;ring_attn_0_0_stage_3</title>
<path fill="none" stroke="black" d="M155.33,-19430.48C155.33,-19430.48 155.33,-19278.58 155.33,-19278.58"/>
<polygon fill="black" stroke="black" points="158.83,-19278.58 155.33,-19268.58 151.83,-19278.58 158.83,-19278.58"/>
</g>
<!-- ring_attn_0_1_stage_2 -->
<g id="node104" class="node">
<title>ring_attn_0_1_stage_2</title>
<polygon fill="yellow" stroke="black" points="812,-19544 603,-19476 812,-19408 1021,-19476 812,-19544"/>
<text text-anchor="middle" x="812" y="-19494.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-19479.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="812" y="-19464.8" font-family="Times,serif" font-size="14.00">Q[1]×K[15]×V[15]</text>
<text text-anchor="middle" x="812" y="-19449.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_2&#45;&gt;ring_attn_0_1_stage_2 -->
<g id="edge1555" class="edge">
<title>ring_attn_0_0_stage_2&#45;&gt;ring_attn_0_1_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-19476C434.02,-19476 592.86,-19476 592.86,-19476"/>
<polygon fill="red" stroke="red" points="592.86,-19479.5 602.86,-19476 592.86,-19472.5 592.86,-19479.5"/>
</g>
<!-- ring_attn_0_0_stage_4 -->
<g id="node8" class="node">
<title>ring_attn_0_0_stage_4</title>
<polygon fill="yellow" stroke="black" points="225,-19038 16,-18970 225,-18902 434,-18970 225,-19038"/>
<text text-anchor="middle" x="225" y="-18988.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-18973.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="225" y="-18958.8" font-family="Times,serif" font-size="14.00">Q[0]×K[12]×V[12]</text>
<text text-anchor="middle" x="225" y="-18943.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_3&#45;&gt;ring_attn_0_0_stage_4 -->
<g id="edge7" class="edge">
<title>ring_attn_0_0_stage_3&#45;&gt;ring_attn_0_0_stage_4</title>
<path fill="none" stroke="black" d="M225,-19154.87C225,-19154.87 225,-19048.25 225,-19048.25"/>
<polygon fill="black" stroke="black" points="228.5,-19048.25 225,-19038.25 221.5,-19048.25 228.5,-19048.25"/>
</g>
<!-- ring_attn_0_1_stage_3 -->
<g id="node105" class="node">
<title>ring_attn_0_1_stage_3</title>
<polygon fill="yellow" stroke="black" points="812,-19291 603,-19223 812,-19155 1021,-19223 812,-19291"/>
<text text-anchor="middle" x="812" y="-19241.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-19226.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="812" y="-19211.8" font-family="Times,serif" font-size="14.00">Q[1]×K[14]×V[14]</text>
<text text-anchor="middle" x="812" y="-19196.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_3&#45;&gt;ring_attn_0_1_stage_3 -->
<g id="edge1556" class="edge">
<title>ring_attn_0_0_stage_3&#45;&gt;ring_attn_0_1_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-19223C434.02,-19223 592.86,-19223 592.86,-19223"/>
<polygon fill="red" stroke="red" points="592.86,-19226.5 602.86,-19223 592.86,-19219.5 592.86,-19226.5"/>
</g>
<!-- ring_attn_0_0_stage_5 -->
<g id="node9" class="node">
<title>ring_attn_0_0_stage_5</title>
<polygon fill="yellow" stroke="black" points="225,-18785 16,-18717 225,-18649 434,-18717 225,-18785"/>
<text text-anchor="middle" x="225" y="-18735.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-18720.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="225" y="-18705.8" font-family="Times,serif" font-size="14.00">Q[0]×K[11]×V[11]</text>
<text text-anchor="middle" x="225" y="-18690.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_4&#45;&gt;ring_attn_0_0_stage_5 -->
<g id="edge8" class="edge">
<title>ring_attn_0_0_stage_4&#45;&gt;ring_attn_0_0_stage_5</title>
<path fill="none" stroke="black" d="M155.33,-18924.48C155.33,-18924.48 155.33,-18772.58 155.33,-18772.58"/>
<polygon fill="black" stroke="black" points="158.83,-18772.58 155.33,-18762.58 151.83,-18772.58 158.83,-18772.58"/>
</g>
<!-- ring_attn_0_1_stage_4 -->
<g id="node106" class="node">
<title>ring_attn_0_1_stage_4</title>
<polygon fill="yellow" stroke="black" points="812,-19038 603,-18970 812,-18902 1021,-18970 812,-19038"/>
<text text-anchor="middle" x="812" y="-18988.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-18973.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="812" y="-18958.8" font-family="Times,serif" font-size="14.00">Q[1]×K[13]×V[13]</text>
<text text-anchor="middle" x="812" y="-18943.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_4&#45;&gt;ring_attn_0_1_stage_4 -->
<g id="edge1557" class="edge">
<title>ring_attn_0_0_stage_4&#45;&gt;ring_attn_0_1_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-18970C434.02,-18970 592.86,-18970 592.86,-18970"/>
<polygon fill="red" stroke="red" points="592.86,-18973.5 602.86,-18970 592.86,-18966.5 592.86,-18973.5"/>
</g>
<!-- ring_attn_0_0_stage_6 -->
<g id="node10" class="node">
<title>ring_attn_0_0_stage_6</title>
<polygon fill="yellow" stroke="black" points="225,-18532 16,-18464 225,-18396 434,-18464 225,-18532"/>
<text text-anchor="middle" x="225" y="-18482.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-18467.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="225" y="-18452.8" font-family="Times,serif" font-size="14.00">Q[0]×K[10]×V[10]</text>
<text text-anchor="middle" x="225" y="-18437.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_5&#45;&gt;ring_attn_0_0_stage_6 -->
<g id="edge9" class="edge">
<title>ring_attn_0_0_stage_5&#45;&gt;ring_attn_0_0_stage_6</title>
<path fill="none" stroke="black" d="M155.33,-18671.48C155.33,-18671.48 155.33,-18519.58 155.33,-18519.58"/>
<polygon fill="black" stroke="black" points="158.83,-18519.58 155.33,-18509.58 151.83,-18519.58 158.83,-18519.58"/>
</g>
<!-- ring_attn_0_1_stage_5 -->
<g id="node107" class="node">
<title>ring_attn_0_1_stage_5</title>
<polygon fill="yellow" stroke="black" points="812,-18785 603,-18717 812,-18649 1021,-18717 812,-18785"/>
<text text-anchor="middle" x="812" y="-18735.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-18720.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="812" y="-18705.8" font-family="Times,serif" font-size="14.00">Q[1]×K[12]×V[12]</text>
<text text-anchor="middle" x="812" y="-18690.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_5&#45;&gt;ring_attn_0_1_stage_5 -->
<g id="edge1558" class="edge">
<title>ring_attn_0_0_stage_5&#45;&gt;ring_attn_0_1_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-18717C434.02,-18717 592.86,-18717 592.86,-18717"/>
<polygon fill="red" stroke="red" points="592.86,-18720.5 602.86,-18717 592.86,-18713.5 592.86,-18720.5"/>
</g>
<!-- ring_attn_0_0_stage_7 -->
<g id="node11" class="node">
<title>ring_attn_0_0_stage_7</title>
<polygon fill="yellow" stroke="black" points="225,-18279 16,-18211 225,-18143 434,-18211 225,-18279"/>
<text text-anchor="middle" x="225" y="-18229.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-18214.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="225" y="-18199.8" font-family="Times,serif" font-size="14.00">Q[0]×K[9]×V[9]</text>
<text text-anchor="middle" x="225" y="-18184.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_6&#45;&gt;ring_attn_0_0_stage_7 -->
<g id="edge10" class="edge">
<title>ring_attn_0_0_stage_6&#45;&gt;ring_attn_0_0_stage_7</title>
<path fill="none" stroke="black" d="M120.5,-18429.88C120.5,-18429.88 120.5,-18255.39 120.5,-18255.39"/>
<polygon fill="black" stroke="black" points="124,-18255.39 120.5,-18245.39 117,-18255.39 124,-18255.39"/>
</g>
<!-- ring_attn_0_1_stage_6 -->
<g id="node108" class="node">
<title>ring_attn_0_1_stage_6</title>
<polygon fill="yellow" stroke="black" points="812,-18532 603,-18464 812,-18396 1021,-18464 812,-18532"/>
<text text-anchor="middle" x="812" y="-18482.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-18467.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="812" y="-18452.8" font-family="Times,serif" font-size="14.00">Q[1]×K[11]×V[11]</text>
<text text-anchor="middle" x="812" y="-18437.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_6&#45;&gt;ring_attn_0_1_stage_6 -->
<g id="edge1559" class="edge">
<title>ring_attn_0_0_stage_6&#45;&gt;ring_attn_0_1_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-18464C434.02,-18464 592.86,-18464 592.86,-18464"/>
<polygon fill="red" stroke="red" points="592.86,-18467.5 602.86,-18464 592.86,-18460.5 592.86,-18467.5"/>
</g>
<!-- ring_attn_0_0_stage_8 -->
<g id="node12" class="node">
<title>ring_attn_0_0_stage_8</title>
<polygon fill="yellow" stroke="black" points="225,-18026 16,-17958 225,-17890 434,-17958 225,-18026"/>
<text text-anchor="middle" x="225" y="-17976.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-17961.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="225" y="-17946.8" font-family="Times,serif" font-size="14.00">Q[0]×K[8]×V[8]</text>
<text text-anchor="middle" x="225" y="-17931.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_7&#45;&gt;ring_attn_0_0_stage_8 -->
<g id="edge11" class="edge">
<title>ring_attn_0_0_stage_7&#45;&gt;ring_attn_0_0_stage_8</title>
<path fill="none" stroke="black" d="M155.33,-18165.48C155.33,-18165.48 155.33,-18013.58 155.33,-18013.58"/>
<polygon fill="black" stroke="black" points="158.83,-18013.58 155.33,-18003.58 151.83,-18013.58 158.83,-18013.58"/>
</g>
<!-- ring_attn_0_1_stage_7 -->
<g id="node109" class="node">
<title>ring_attn_0_1_stage_7</title>
<polygon fill="yellow" stroke="black" points="812,-18279 603,-18211 812,-18143 1021,-18211 812,-18279"/>
<text text-anchor="middle" x="812" y="-18229.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-18214.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="812" y="-18199.8" font-family="Times,serif" font-size="14.00">Q[1]×K[10]×V[10]</text>
<text text-anchor="middle" x="812" y="-18184.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_7&#45;&gt;ring_attn_0_1_stage_7 -->
<g id="edge1560" class="edge">
<title>ring_attn_0_0_stage_7&#45;&gt;ring_attn_0_1_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-18211C434.02,-18211 592.86,-18211 592.86,-18211"/>
<polygon fill="red" stroke="red" points="592.86,-18214.5 602.86,-18211 592.86,-18207.5 592.86,-18214.5"/>
</g>
<!-- ring_attn_0_0_stage_9 -->
<g id="node13" class="node">
<title>ring_attn_0_0_stage_9</title>
<polygon fill="yellow" stroke="black" points="225,-17773 16,-17705 225,-17637 434,-17705 225,-17773"/>
<text text-anchor="middle" x="225" y="-17723.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-17708.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="225" y="-17693.8" font-family="Times,serif" font-size="14.00">Q[0]×K[7]×V[7]</text>
<text text-anchor="middle" x="225" y="-17678.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_8&#45;&gt;ring_attn_0_0_stage_9 -->
<g id="edge12" class="edge">
<title>ring_attn_0_0_stage_8&#45;&gt;ring_attn_0_0_stage_9</title>
<path fill="none" stroke="black" d="M155.33,-17912.48C155.33,-17912.48 155.33,-17760.58 155.33,-17760.58"/>
<polygon fill="black" stroke="black" points="158.83,-17760.58 155.33,-17750.58 151.83,-17760.58 158.83,-17760.58"/>
</g>
<!-- ring_attn_0_1_stage_8 -->
<g id="node110" class="node">
<title>ring_attn_0_1_stage_8</title>
<polygon fill="yellow" stroke="black" points="812,-18026 603,-17958 812,-17890 1021,-17958 812,-18026"/>
<text text-anchor="middle" x="812" y="-17976.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-17961.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="812" y="-17946.8" font-family="Times,serif" font-size="14.00">Q[1]×K[9]×V[9]</text>
<text text-anchor="middle" x="812" y="-17931.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_8&#45;&gt;ring_attn_0_1_stage_8 -->
<g id="edge1561" class="edge">
<title>ring_attn_0_0_stage_8&#45;&gt;ring_attn_0_1_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-17958C434.02,-17958 592.86,-17958 592.86,-17958"/>
<polygon fill="red" stroke="red" points="592.86,-17961.5 602.86,-17958 592.86,-17954.5 592.86,-17961.5"/>
</g>
<!-- ring_attn_0_0_stage_10 -->
<g id="node14" class="node">
<title>ring_attn_0_0_stage_10</title>
<polygon fill="yellow" stroke="black" points="225,-17520 16,-17452 225,-17384 434,-17452 225,-17520"/>
<text text-anchor="middle" x="225" y="-17470.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-17455.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="225" y="-17440.8" font-family="Times,serif" font-size="14.00">Q[0]×K[6]×V[6]</text>
<text text-anchor="middle" x="225" y="-17425.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_9&#45;&gt;ring_attn_0_0_stage_10 -->
<g id="edge13" class="edge">
<title>ring_attn_0_0_stage_9&#45;&gt;ring_attn_0_0_stage_10</title>
<path fill="none" stroke="black" d="M155.33,-17659.48C155.33,-17659.48 155.33,-17507.58 155.33,-17507.58"/>
<polygon fill="black" stroke="black" points="158.83,-17507.58 155.33,-17497.58 151.83,-17507.58 158.83,-17507.58"/>
</g>
<!-- ring_attn_0_1_stage_9 -->
<g id="node111" class="node">
<title>ring_attn_0_1_stage_9</title>
<polygon fill="yellow" stroke="black" points="812,-17773 603,-17705 812,-17637 1021,-17705 812,-17773"/>
<text text-anchor="middle" x="812" y="-17723.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-17708.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="812" y="-17693.8" font-family="Times,serif" font-size="14.00">Q[1]×K[8]×V[8]</text>
<text text-anchor="middle" x="812" y="-17678.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_9&#45;&gt;ring_attn_0_1_stage_9 -->
<g id="edge1562" class="edge">
<title>ring_attn_0_0_stage_9&#45;&gt;ring_attn_0_1_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-17705C434.02,-17705 592.86,-17705 592.86,-17705"/>
<polygon fill="red" stroke="red" points="592.86,-17708.5 602.86,-17705 592.86,-17701.5 592.86,-17708.5"/>
</g>
<!-- ring_attn_0_0_stage_11 -->
<g id="node15" class="node">
<title>ring_attn_0_0_stage_11</title>
<polygon fill="yellow" stroke="black" points="225,-17267 16,-17199 225,-17131 434,-17199 225,-17267"/>
<text text-anchor="middle" x="225" y="-17217.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-17202.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="225" y="-17187.8" font-family="Times,serif" font-size="14.00">Q[0]×K[5]×V[5]</text>
<text text-anchor="middle" x="225" y="-17172.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_10&#45;&gt;ring_attn_0_0_stage_11 -->
<g id="edge14" class="edge">
<title>ring_attn_0_0_stage_10&#45;&gt;ring_attn_0_0_stage_11</title>
<path fill="none" stroke="black" d="M155.33,-17406.48C155.33,-17406.48 155.33,-17254.58 155.33,-17254.58"/>
<polygon fill="black" stroke="black" points="158.83,-17254.58 155.33,-17244.58 151.83,-17254.58 158.83,-17254.58"/>
</g>
<!-- ring_attn_0_1_stage_10 -->
<g id="node112" class="node">
<title>ring_attn_0_1_stage_10</title>
<polygon fill="yellow" stroke="black" points="812,-17520 603,-17452 812,-17384 1021,-17452 812,-17520"/>
<text text-anchor="middle" x="812" y="-17470.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-17455.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="812" y="-17440.8" font-family="Times,serif" font-size="14.00">Q[1]×K[7]×V[7]</text>
<text text-anchor="middle" x="812" y="-17425.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_10&#45;&gt;ring_attn_0_1_stage_10 -->
<g id="edge1563" class="edge">
<title>ring_attn_0_0_stage_10&#45;&gt;ring_attn_0_1_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-17452C434.02,-17452 592.86,-17452 592.86,-17452"/>
<polygon fill="red" stroke="red" points="592.86,-17455.5 602.86,-17452 592.86,-17448.5 592.86,-17455.5"/>
</g>
<!-- ring_attn_0_0_stage_12 -->
<g id="node16" class="node">
<title>ring_attn_0_0_stage_12</title>
<polygon fill="yellow" stroke="black" points="225,-17014 16,-16946 225,-16878 434,-16946 225,-17014"/>
<text text-anchor="middle" x="225" y="-16964.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-16949.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="225" y="-16934.8" font-family="Times,serif" font-size="14.00">Q[0]×K[4]×V[4]</text>
<text text-anchor="middle" x="225" y="-16919.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_11&#45;&gt;ring_attn_0_0_stage_12 -->
<g id="edge15" class="edge">
<title>ring_attn_0_0_stage_11&#45;&gt;ring_attn_0_0_stage_12</title>
<path fill="none" stroke="black" d="M155.33,-17153.48C155.33,-17153.48 155.33,-17001.58 155.33,-17001.58"/>
<polygon fill="black" stroke="black" points="158.83,-17001.58 155.33,-16991.58 151.83,-17001.58 158.83,-17001.58"/>
</g>
<!-- ring_attn_0_1_stage_11 -->
<g id="node113" class="node">
<title>ring_attn_0_1_stage_11</title>
<polygon fill="yellow" stroke="black" points="812,-17267 603,-17199 812,-17131 1021,-17199 812,-17267"/>
<text text-anchor="middle" x="812" y="-17217.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-17202.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="812" y="-17187.8" font-family="Times,serif" font-size="14.00">Q[1]×K[6]×V[6]</text>
<text text-anchor="middle" x="812" y="-17172.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_11&#45;&gt;ring_attn_0_1_stage_11 -->
<g id="edge1564" class="edge">
<title>ring_attn_0_0_stage_11&#45;&gt;ring_attn_0_1_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-17199C434.02,-17199 592.86,-17199 592.86,-17199"/>
<polygon fill="red" stroke="red" points="592.86,-17202.5 602.86,-17199 592.86,-17195.5 592.86,-17202.5"/>
</g>
<!-- ring_attn_0_0_stage_13 -->
<g id="node17" class="node">
<title>ring_attn_0_0_stage_13</title>
<polygon fill="yellow" stroke="black" points="225,-16761 16,-16693 225,-16625 434,-16693 225,-16761"/>
<text text-anchor="middle" x="225" y="-16711.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-16696.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="225" y="-16681.8" font-family="Times,serif" font-size="14.00">Q[0]×K[3]×V[3]</text>
<text text-anchor="middle" x="225" y="-16666.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_12&#45;&gt;ring_attn_0_0_stage_13 -->
<g id="edge16" class="edge">
<title>ring_attn_0_0_stage_12&#45;&gt;ring_attn_0_0_stage_13</title>
<path fill="none" stroke="black" d="M155.33,-16900.48C155.33,-16900.48 155.33,-16748.58 155.33,-16748.58"/>
<polygon fill="black" stroke="black" points="158.83,-16748.58 155.33,-16738.58 151.83,-16748.58 158.83,-16748.58"/>
</g>
<!-- ring_attn_0_1_stage_12 -->
<g id="node114" class="node">
<title>ring_attn_0_1_stage_12</title>
<polygon fill="yellow" stroke="black" points="812,-17014 603,-16946 812,-16878 1021,-16946 812,-17014"/>
<text text-anchor="middle" x="812" y="-16964.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-16949.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="812" y="-16934.8" font-family="Times,serif" font-size="14.00">Q[1]×K[5]×V[5]</text>
<text text-anchor="middle" x="812" y="-16919.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_12&#45;&gt;ring_attn_0_1_stage_12 -->
<g id="edge1565" class="edge">
<title>ring_attn_0_0_stage_12&#45;&gt;ring_attn_0_1_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-16946C434.02,-16946 592.86,-16946 592.86,-16946"/>
<polygon fill="red" stroke="red" points="592.86,-16949.5 602.86,-16946 592.86,-16942.5 592.86,-16949.5"/>
</g>
<!-- ring_attn_0_0_stage_14 -->
<g id="node18" class="node">
<title>ring_attn_0_0_stage_14</title>
<polygon fill="yellow" stroke="black" points="225,-16508 16,-16440 225,-16372 434,-16440 225,-16508"/>
<text text-anchor="middle" x="225" y="-16458.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-16443.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="225" y="-16428.8" font-family="Times,serif" font-size="14.00">Q[0]×K[2]×V[2]</text>
<text text-anchor="middle" x="225" y="-16413.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_13&#45;&gt;ring_attn_0_0_stage_14 -->
<g id="edge17" class="edge">
<title>ring_attn_0_0_stage_13&#45;&gt;ring_attn_0_0_stage_14</title>
<path fill="none" stroke="black" d="M225,-16624.87C225,-16624.87 225,-16518.25 225,-16518.25"/>
<polygon fill="black" stroke="black" points="228.5,-16518.25 225,-16508.25 221.5,-16518.25 228.5,-16518.25"/>
</g>
<!-- ring_attn_0_1_stage_13 -->
<g id="node115" class="node">
<title>ring_attn_0_1_stage_13</title>
<polygon fill="yellow" stroke="black" points="812,-16761 603,-16693 812,-16625 1021,-16693 812,-16761"/>
<text text-anchor="middle" x="812" y="-16711.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-16696.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="812" y="-16681.8" font-family="Times,serif" font-size="14.00">Q[1]×K[4]×V[4]</text>
<text text-anchor="middle" x="812" y="-16666.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_13&#45;&gt;ring_attn_0_1_stage_13 -->
<g id="edge1566" class="edge">
<title>ring_attn_0_0_stage_13&#45;&gt;ring_attn_0_1_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-16693C434.02,-16693 592.86,-16693 592.86,-16693"/>
<polygon fill="red" stroke="red" points="592.86,-16696.5 602.86,-16693 592.86,-16689.5 592.86,-16696.5"/>
</g>
<!-- ring_attn_0_0_stage_15 -->
<g id="node19" class="node">
<title>ring_attn_0_0_stage_15</title>
<polygon fill="yellow" stroke="black" points="225,-16255 16,-16187 225,-16119 434,-16187 225,-16255"/>
<text text-anchor="middle" x="225" y="-16205.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-16190.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="225" y="-16175.8" font-family="Times,serif" font-size="14.00">Q[0]×K[1]×V[1]</text>
<text text-anchor="middle" x="225" y="-16160.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_14&#45;&gt;ring_attn_0_0_stage_15 -->
<g id="edge18" class="edge">
<title>ring_attn_0_0_stage_14&#45;&gt;ring_attn_0_0_stage_15</title>
<path fill="none" stroke="black" d="M155.33,-16394.48C155.33,-16394.48 155.33,-16242.58 155.33,-16242.58"/>
<polygon fill="black" stroke="black" points="158.83,-16242.58 155.33,-16232.58 151.83,-16242.58 158.83,-16242.58"/>
</g>
<!-- ring_attn_0_1_stage_14 -->
<g id="node116" class="node">
<title>ring_attn_0_1_stage_14</title>
<polygon fill="yellow" stroke="black" points="812,-16508 603,-16440 812,-16372 1021,-16440 812,-16508"/>
<text text-anchor="middle" x="812" y="-16458.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-16443.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="812" y="-16428.8" font-family="Times,serif" font-size="14.00">Q[1]×K[3]×V[3]</text>
<text text-anchor="middle" x="812" y="-16413.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_14&#45;&gt;ring_attn_0_1_stage_14 -->
<g id="edge1567" class="edge">
<title>ring_attn_0_0_stage_14&#45;&gt;ring_attn_0_1_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-16440C434.02,-16440 592.86,-16440 592.86,-16440"/>
<polygon fill="red" stroke="red" points="592.86,-16443.5 602.86,-16440 592.86,-16436.5 592.86,-16443.5"/>
</g>
<!-- attn_out_0_0 -->
<g id="node20" class="node">
<title>attn_out_0_0</title>
<polygon fill="none" stroke="black" points="294.5,-16046 155.5,-16046 155.5,-15993 294.5,-15993 294.5,-16046"/>
<text text-anchor="middle" x="225" y="-16030.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="225" y="-16015.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="225" y="-16000.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_0_0_stage_15&#45;&gt;attn_out_0_0 -->
<g id="edge19" class="edge">
<title>ring_attn_0_0_stage_15&#45;&gt;attn_out_0_0</title>
<path fill="none" stroke="black" d="M225,-16118.87C225,-16118.87 225,-16056.18 225,-16056.18"/>
<polygon fill="black" stroke="black" points="228.5,-16056.18 225,-16046.18 221.5,-16056.18 228.5,-16056.18"/>
</g>
<!-- ring_attn_0_1_stage_15 -->
<g id="node117" class="node">
<title>ring_attn_0_1_stage_15</title>
<polygon fill="yellow" stroke="black" points="812,-16255 603,-16187 812,-16119 1021,-16187 812,-16255"/>
<text text-anchor="middle" x="812" y="-16205.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-16190.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="812" y="-16175.8" font-family="Times,serif" font-size="14.00">Q[1]×K[2]×V[2]</text>
<text text-anchor="middle" x="812" y="-16160.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_0_stage_15&#45;&gt;ring_attn_0_1_stage_15 -->
<g id="edge1568" class="edge">
<title>ring_attn_0_0_stage_15&#45;&gt;ring_attn_0_1_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-16187C434.02,-16187 592.86,-16187 592.86,-16187"/>
<polygon fill="red" stroke="red" points="592.86,-16190.5 602.86,-16187 592.86,-16183.5 592.86,-16190.5"/>
</g>
<!-- attn_residual_0_0 -->
<g id="node21" class="node">
<title>attn_residual_0_0</title>
<ellipse fill="none" stroke="black" cx="225" cy="-15893" rx="105.5" ry="27"/>
<text text-anchor="middle" x="225" y="-15896.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="225" y="-15881.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_0_0&#45;&gt;attn_residual_0_0 -->
<g id="edge20" class="edge">
<title>attn_out_0_0&#45;&gt;attn_residual_0_0</title>
<path fill="none" stroke="black" d="M225,-15992.98C225,-15992.98 225,-15930.36 225,-15930.36"/>
<polygon fill="black" stroke="black" points="228.5,-15930.36 225,-15920.36 221.5,-15930.36 228.5,-15930.36"/>
</g>
<!-- ffn_up_0_0 -->
<g id="node22" class="node">
<title>ffn_up_0_0</title>
<polygon fill="none" stroke="black" points="304,-15793 146,-15793 146,-15740 304,-15740 304,-15793"/>
<text text-anchor="middle" x="225" y="-15777.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="225" y="-15762.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="225" y="-15747.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_0_0&#45;&gt;ffn_up_0_0 -->
<g id="edge21" class="edge">
<title>attn_residual_0_0&#45;&gt;ffn_up_0_0</title>
<path fill="none" stroke="black" d="M225,-15865.86C225,-15865.86 225,-15803.16 225,-15803.16"/>
<polygon fill="black" stroke="black" points="228.5,-15803.16 225,-15793.16 221.5,-15803.16 228.5,-15803.16"/>
</g>
<!-- ffn_gelu_0_0 -->
<g id="node23" class="node">
<title>ffn_gelu_0_0</title>
<ellipse fill="none" stroke="black" cx="225" cy="-15640" rx="105.5" ry="27"/>
<text text-anchor="middle" x="225" y="-15643.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="225" y="-15628.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_0_0&#45;&gt;ffn_gelu_0_0 -->
<g id="edge22" class="edge">
<title>ffn_up_0_0&#45;&gt;ffn_gelu_0_0</title>
<path fill="none" stroke="black" d="M225,-15739.98C225,-15739.98 225,-15677.36 225,-15677.36"/>
<polygon fill="black" stroke="black" points="228.5,-15677.36 225,-15667.36 221.5,-15677.36 228.5,-15677.36"/>
</g>
<!-- ffn_down_0_0 -->
<g id="node24" class="node">
<title>ffn_down_0_0</title>
<polygon fill="none" stroke="black" points="314,-15540 136,-15540 136,-15487 314,-15487 314,-15540"/>
<text text-anchor="middle" x="225" y="-15524.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="225" y="-15509.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="225" y="-15494.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_0_0&#45;&gt;ffn_down_0_0 -->
<g id="edge23" class="edge">
<title>ffn_gelu_0_0&#45;&gt;ffn_down_0_0</title>
<path fill="none" stroke="black" d="M225,-15612.86C225,-15612.86 225,-15550.16 225,-15550.16"/>
<polygon fill="black" stroke="black" points="228.5,-15550.16 225,-15540.16 221.5,-15550.16 228.5,-15550.16"/>
</g>
<!-- ffn_residual_0_0 -->
<g id="node25" class="node">
<title>ffn_residual_0_0</title>
<ellipse fill="none" stroke="black" cx="225" cy="-15387" rx="105.5" ry="27"/>
<text text-anchor="middle" x="225" y="-15390.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="225" y="-15375.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_0_0&#45;&gt;ffn_residual_0_0 -->
<g id="edge24" class="edge">
<title>ffn_down_0_0&#45;&gt;ffn_residual_0_0</title>
<path fill="none" stroke="black" d="M225,-15486.98C225,-15486.98 225,-15424.36 225,-15424.36"/>
<polygon fill="black" stroke="black" points="228.5,-15424.36 225,-15414.36 221.5,-15424.36 228.5,-15424.36"/>
</g>
<!-- qkv_proj_1_0 -->
<g id="node26" class="node">
<title>qkv_proj_1_0</title>
<polygon fill="none" stroke="black" points="307.5,-15287 142.5,-15287 142.5,-15234 307.5,-15234 307.5,-15287"/>
<text text-anchor="middle" x="225" y="-15271.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="225" y="-15256.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="225" y="-15241.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_0_0&#45;&gt;qkv_proj_1_0 -->
<g id="edge25" class="edge">
<title>ffn_residual_0_0&#45;&gt;qkv_proj_1_0</title>
<path fill="none" stroke="black" d="M225,-15359.86C225,-15359.86 225,-15297.16 225,-15297.16"/>
<polygon fill="black" stroke="black" points="228.5,-15297.16 225,-15287.16 221.5,-15297.16 228.5,-15297.16"/>
</g>
<!-- qkv_reshape_1_0 -->
<g id="node27" class="node">
<title>qkv_reshape_1_0</title>
<ellipse fill="none" stroke="black" cx="225" cy="-15134" rx="148" ry="27"/>
<text text-anchor="middle" x="225" y="-15137.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="225" y="-15122.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_1_0&#45;&gt;qkv_reshape_1_0 -->
<g id="edge26" class="edge">
<title>qkv_proj_1_0&#45;&gt;qkv_reshape_1_0</title>
<path fill="none" stroke="black" d="M225,-15233.98C225,-15233.98 225,-15171.36 225,-15171.36"/>
<polygon fill="black" stroke="black" points="228.5,-15171.36 225,-15161.36 221.5,-15171.36 228.5,-15171.36"/>
</g>
<!-- ring_attn_1_0_stage_0 -->
<g id="node28" class="node">
<title>ring_attn_1_0_stage_0</title>
<polygon fill="yellow" stroke="black" points="225,-14990 16,-14922 225,-14854 434,-14922 225,-14990"/>
<text text-anchor="middle" x="225" y="-14940.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-14925.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="225" y="-14910.8" font-family="Times,serif" font-size="14.00">Q[0]×K[0]×V[0]</text>
<text text-anchor="middle" x="225" y="-14895.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- qkv_reshape_1_0&#45;&gt;ring_attn_1_0_stage_0 -->
<g id="edge27" class="edge">
<title>qkv_reshape_1_0&#45;&gt;ring_attn_1_0_stage_0</title>
<path fill="none" stroke="black" d="M225,-15106.72C225,-15106.72 225,-15000.16 225,-15000.16"/>
<polygon fill="black" stroke="black" points="228.5,-15000.16 225,-14990.16 221.5,-15000.16 228.5,-15000.16"/>
</g>
<!-- ring_attn_1_0_stage_1 -->
<g id="node29" class="node">
<title>ring_attn_1_0_stage_1</title>
<polygon fill="yellow" stroke="black" points="225,-14737 16,-14669 225,-14601 434,-14669 225,-14737"/>
<text text-anchor="middle" x="225" y="-14687.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-14672.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="225" y="-14657.8" font-family="Times,serif" font-size="14.00">Q[0]×K[15]×V[15]</text>
<text text-anchor="middle" x="225" y="-14642.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_0&#45;&gt;ring_attn_1_0_stage_1 -->
<g id="edge28" class="edge">
<title>ring_attn_1_0_stage_0&#45;&gt;ring_attn_1_0_stage_1</title>
<path fill="none" stroke="black" d="M155.33,-14876.48C155.33,-14876.48 155.33,-14724.58 155.33,-14724.58"/>
<polygon fill="black" stroke="black" points="158.83,-14724.58 155.33,-14714.58 151.83,-14724.58 158.83,-14724.58"/>
</g>
<!-- ring_attn_1_1_stage_0 -->
<g id="node126" class="node">
<title>ring_attn_1_1_stage_0</title>
<polygon fill="yellow" stroke="black" points="812,-14990 603,-14922 812,-14854 1021,-14922 812,-14990"/>
<text text-anchor="middle" x="812" y="-14940.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-14925.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="812" y="-14910.8" font-family="Times,serif" font-size="14.00">Q[1]×K[1]×V[1]</text>
<text text-anchor="middle" x="812" y="-14895.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_0&#45;&gt;ring_attn_1_1_stage_0 -->
<g id="edge1569" class="edge">
<title>ring_attn_1_0_stage_0&#45;&gt;ring_attn_1_1_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-14922C434.02,-14922 592.86,-14922 592.86,-14922"/>
<polygon fill="red" stroke="red" points="592.86,-14925.5 602.86,-14922 592.86,-14918.5 592.86,-14925.5"/>
</g>
<!-- ring_attn_1_0_stage_2 -->
<g id="node30" class="node">
<title>ring_attn_1_0_stage_2</title>
<polygon fill="yellow" stroke="black" points="225,-14484 16,-14416 225,-14348 434,-14416 225,-14484"/>
<text text-anchor="middle" x="225" y="-14434.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-14419.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="225" y="-14404.8" font-family="Times,serif" font-size="14.00">Q[0]×K[14]×V[14]</text>
<text text-anchor="middle" x="225" y="-14389.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_1&#45;&gt;ring_attn_1_0_stage_2 -->
<g id="edge29" class="edge">
<title>ring_attn_1_0_stage_1&#45;&gt;ring_attn_1_0_stage_2</title>
<path fill="none" stroke="black" d="M155.33,-14623.48C155.33,-14623.48 155.33,-14471.58 155.33,-14471.58"/>
<polygon fill="black" stroke="black" points="158.83,-14471.58 155.33,-14461.58 151.83,-14471.58 158.83,-14471.58"/>
</g>
<!-- ring_attn_1_1_stage_1 -->
<g id="node127" class="node">
<title>ring_attn_1_1_stage_1</title>
<polygon fill="yellow" stroke="black" points="812,-14737 603,-14669 812,-14601 1021,-14669 812,-14737"/>
<text text-anchor="middle" x="812" y="-14687.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-14672.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="812" y="-14657.8" font-family="Times,serif" font-size="14.00">Q[1]×K[0]×V[0]</text>
<text text-anchor="middle" x="812" y="-14642.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_1&#45;&gt;ring_attn_1_1_stage_1 -->
<g id="edge1570" class="edge">
<title>ring_attn_1_0_stage_1&#45;&gt;ring_attn_1_1_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-14669C434.02,-14669 592.86,-14669 592.86,-14669"/>
<polygon fill="red" stroke="red" points="592.86,-14672.5 602.86,-14669 592.86,-14665.5 592.86,-14672.5"/>
</g>
<!-- ring_attn_1_0_stage_3 -->
<g id="node31" class="node">
<title>ring_attn_1_0_stage_3</title>
<polygon fill="yellow" stroke="black" points="225,-14231 16,-14163 225,-14095 434,-14163 225,-14231"/>
<text text-anchor="middle" x="225" y="-14181.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-14166.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="225" y="-14151.8" font-family="Times,serif" font-size="14.00">Q[0]×K[13]×V[13]</text>
<text text-anchor="middle" x="225" y="-14136.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_2&#45;&gt;ring_attn_1_0_stage_3 -->
<g id="edge30" class="edge">
<title>ring_attn_1_0_stage_2&#45;&gt;ring_attn_1_0_stage_3</title>
<path fill="none" stroke="black" d="M155.33,-14370.48C155.33,-14370.48 155.33,-14218.58 155.33,-14218.58"/>
<polygon fill="black" stroke="black" points="158.83,-14218.58 155.33,-14208.58 151.83,-14218.58 158.83,-14218.58"/>
</g>
<!-- ring_attn_1_1_stage_2 -->
<g id="node128" class="node">
<title>ring_attn_1_1_stage_2</title>
<polygon fill="yellow" stroke="black" points="812,-14484 603,-14416 812,-14348 1021,-14416 812,-14484"/>
<text text-anchor="middle" x="812" y="-14434.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-14419.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="812" y="-14404.8" font-family="Times,serif" font-size="14.00">Q[1]×K[15]×V[15]</text>
<text text-anchor="middle" x="812" y="-14389.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_2&#45;&gt;ring_attn_1_1_stage_2 -->
<g id="edge1571" class="edge">
<title>ring_attn_1_0_stage_2&#45;&gt;ring_attn_1_1_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-14416C434.02,-14416 592.86,-14416 592.86,-14416"/>
<polygon fill="red" stroke="red" points="592.86,-14419.5 602.86,-14416 592.86,-14412.5 592.86,-14419.5"/>
</g>
<!-- ring_attn_1_0_stage_4 -->
<g id="node32" class="node">
<title>ring_attn_1_0_stage_4</title>
<polygon fill="yellow" stroke="black" points="225,-13978 16,-13910 225,-13842 434,-13910 225,-13978"/>
<text text-anchor="middle" x="225" y="-13928.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-13913.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="225" y="-13898.8" font-family="Times,serif" font-size="14.00">Q[0]×K[12]×V[12]</text>
<text text-anchor="middle" x="225" y="-13883.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_3&#45;&gt;ring_attn_1_0_stage_4 -->
<g id="edge31" class="edge">
<title>ring_attn_1_0_stage_3&#45;&gt;ring_attn_1_0_stage_4</title>
<path fill="none" stroke="black" d="M225,-14094.87C225,-14094.87 225,-13988.25 225,-13988.25"/>
<polygon fill="black" stroke="black" points="228.5,-13988.25 225,-13978.25 221.5,-13988.25 228.5,-13988.25"/>
</g>
<!-- ring_attn_1_1_stage_3 -->
<g id="node129" class="node">
<title>ring_attn_1_1_stage_3</title>
<polygon fill="yellow" stroke="black" points="812,-14231 603,-14163 812,-14095 1021,-14163 812,-14231"/>
<text text-anchor="middle" x="812" y="-14181.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-14166.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="812" y="-14151.8" font-family="Times,serif" font-size="14.00">Q[1]×K[14]×V[14]</text>
<text text-anchor="middle" x="812" y="-14136.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_3&#45;&gt;ring_attn_1_1_stage_3 -->
<g id="edge1572" class="edge">
<title>ring_attn_1_0_stage_3&#45;&gt;ring_attn_1_1_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-14163C434.02,-14163 592.86,-14163 592.86,-14163"/>
<polygon fill="red" stroke="red" points="592.86,-14166.5 602.86,-14163 592.86,-14159.5 592.86,-14166.5"/>
</g>
<!-- ring_attn_1_0_stage_5 -->
<g id="node33" class="node">
<title>ring_attn_1_0_stage_5</title>
<polygon fill="yellow" stroke="black" points="225,-13725 16,-13657 225,-13589 434,-13657 225,-13725"/>
<text text-anchor="middle" x="225" y="-13675.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-13660.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="225" y="-13645.8" font-family="Times,serif" font-size="14.00">Q[0]×K[11]×V[11]</text>
<text text-anchor="middle" x="225" y="-13630.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_4&#45;&gt;ring_attn_1_0_stage_5 -->
<g id="edge32" class="edge">
<title>ring_attn_1_0_stage_4&#45;&gt;ring_attn_1_0_stage_5</title>
<path fill="none" stroke="black" d="M120.5,-13875.88C120.5,-13875.88 120.5,-13701.39 120.5,-13701.39"/>
<polygon fill="black" stroke="black" points="124,-13701.39 120.5,-13691.39 117,-13701.39 124,-13701.39"/>
</g>
<!-- ring_attn_1_1_stage_4 -->
<g id="node130" class="node">
<title>ring_attn_1_1_stage_4</title>
<polygon fill="yellow" stroke="black" points="812,-13978 603,-13910 812,-13842 1021,-13910 812,-13978"/>
<text text-anchor="middle" x="812" y="-13928.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-13913.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="812" y="-13898.8" font-family="Times,serif" font-size="14.00">Q[1]×K[13]×V[13]</text>
<text text-anchor="middle" x="812" y="-13883.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_4&#45;&gt;ring_attn_1_1_stage_4 -->
<g id="edge1573" class="edge">
<title>ring_attn_1_0_stage_4&#45;&gt;ring_attn_1_1_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-13910C434.02,-13910 592.86,-13910 592.86,-13910"/>
<polygon fill="red" stroke="red" points="592.86,-13913.5 602.86,-13910 592.86,-13906.5 592.86,-13913.5"/>
</g>
<!-- ring_attn_1_0_stage_6 -->
<g id="node34" class="node">
<title>ring_attn_1_0_stage_6</title>
<polygon fill="yellow" stroke="black" points="225,-13472 16,-13404 225,-13336 434,-13404 225,-13472"/>
<text text-anchor="middle" x="225" y="-13422.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-13407.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="225" y="-13392.8" font-family="Times,serif" font-size="14.00">Q[0]×K[10]×V[10]</text>
<text text-anchor="middle" x="225" y="-13377.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_5&#45;&gt;ring_attn_1_0_stage_6 -->
<g id="edge33" class="edge">
<title>ring_attn_1_0_stage_5&#45;&gt;ring_attn_1_0_stage_6</title>
<path fill="none" stroke="black" d="M225,-13588.87C225,-13588.87 225,-13482.25 225,-13482.25"/>
<polygon fill="black" stroke="black" points="228.5,-13482.25 225,-13472.25 221.5,-13482.25 228.5,-13482.25"/>
</g>
<!-- ring_attn_1_1_stage_5 -->
<g id="node131" class="node">
<title>ring_attn_1_1_stage_5</title>
<polygon fill="yellow" stroke="black" points="812,-13725 603,-13657 812,-13589 1021,-13657 812,-13725"/>
<text text-anchor="middle" x="812" y="-13675.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-13660.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="812" y="-13645.8" font-family="Times,serif" font-size="14.00">Q[1]×K[12]×V[12]</text>
<text text-anchor="middle" x="812" y="-13630.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_5&#45;&gt;ring_attn_1_1_stage_5 -->
<g id="edge1574" class="edge">
<title>ring_attn_1_0_stage_5&#45;&gt;ring_attn_1_1_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-13657C434.02,-13657 592.86,-13657 592.86,-13657"/>
<polygon fill="red" stroke="red" points="592.86,-13660.5 602.86,-13657 592.86,-13653.5 592.86,-13660.5"/>
</g>
<!-- ring_attn_1_0_stage_7 -->
<g id="node35" class="node">
<title>ring_attn_1_0_stage_7</title>
<polygon fill="yellow" stroke="black" points="225,-13219 16,-13151 225,-13083 434,-13151 225,-13219"/>
<text text-anchor="middle" x="225" y="-13169.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-13154.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="225" y="-13139.8" font-family="Times,serif" font-size="14.00">Q[0]×K[9]×V[9]</text>
<text text-anchor="middle" x="225" y="-13124.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_6&#45;&gt;ring_attn_1_0_stage_7 -->
<g id="edge34" class="edge">
<title>ring_attn_1_0_stage_6&#45;&gt;ring_attn_1_0_stage_7</title>
<path fill="none" stroke="black" d="M155.33,-13358.48C155.33,-13358.48 155.33,-13206.58 155.33,-13206.58"/>
<polygon fill="black" stroke="black" points="158.83,-13206.58 155.33,-13196.58 151.83,-13206.58 158.83,-13206.58"/>
</g>
<!-- ring_attn_1_1_stage_6 -->
<g id="node132" class="node">
<title>ring_attn_1_1_stage_6</title>
<polygon fill="yellow" stroke="black" points="812,-13472 603,-13404 812,-13336 1021,-13404 812,-13472"/>
<text text-anchor="middle" x="812" y="-13422.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-13407.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="812" y="-13392.8" font-family="Times,serif" font-size="14.00">Q[1]×K[11]×V[11]</text>
<text text-anchor="middle" x="812" y="-13377.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_6&#45;&gt;ring_attn_1_1_stage_6 -->
<g id="edge1575" class="edge">
<title>ring_attn_1_0_stage_6&#45;&gt;ring_attn_1_1_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-13404C434.02,-13404 592.86,-13404 592.86,-13404"/>
<polygon fill="red" stroke="red" points="592.86,-13407.5 602.86,-13404 592.86,-13400.5 592.86,-13407.5"/>
</g>
<!-- ring_attn_1_0_stage_8 -->
<g id="node36" class="node">
<title>ring_attn_1_0_stage_8</title>
<polygon fill="yellow" stroke="black" points="225,-12966 16,-12898 225,-12830 434,-12898 225,-12966"/>
<text text-anchor="middle" x="225" y="-12916.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-12901.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="225" y="-12886.8" font-family="Times,serif" font-size="14.00">Q[0]×K[8]×V[8]</text>
<text text-anchor="middle" x="225" y="-12871.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_7&#45;&gt;ring_attn_1_0_stage_8 -->
<g id="edge35" class="edge">
<title>ring_attn_1_0_stage_7&#45;&gt;ring_attn_1_0_stage_8</title>
<path fill="none" stroke="black" d="M155.33,-13105.48C155.33,-13105.48 155.33,-12953.58 155.33,-12953.58"/>
<polygon fill="black" stroke="black" points="158.83,-12953.58 155.33,-12943.58 151.83,-12953.58 158.83,-12953.58"/>
</g>
<!-- ring_attn_1_1_stage_7 -->
<g id="node133" class="node">
<title>ring_attn_1_1_stage_7</title>
<polygon fill="yellow" stroke="black" points="812,-13219 603,-13151 812,-13083 1021,-13151 812,-13219"/>
<text text-anchor="middle" x="812" y="-13169.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-13154.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="812" y="-13139.8" font-family="Times,serif" font-size="14.00">Q[1]×K[10]×V[10]</text>
<text text-anchor="middle" x="812" y="-13124.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_7&#45;&gt;ring_attn_1_1_stage_7 -->
<g id="edge1576" class="edge">
<title>ring_attn_1_0_stage_7&#45;&gt;ring_attn_1_1_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-13151C434.02,-13151 592.86,-13151 592.86,-13151"/>
<polygon fill="red" stroke="red" points="592.86,-13154.5 602.86,-13151 592.86,-13147.5 592.86,-13154.5"/>
</g>
<!-- ring_attn_1_0_stage_9 -->
<g id="node37" class="node">
<title>ring_attn_1_0_stage_9</title>
<polygon fill="yellow" stroke="black" points="225,-12713 16,-12645 225,-12577 434,-12645 225,-12713"/>
<text text-anchor="middle" x="225" y="-12663.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-12648.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="225" y="-12633.8" font-family="Times,serif" font-size="14.00">Q[0]×K[7]×V[7]</text>
<text text-anchor="middle" x="225" y="-12618.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_8&#45;&gt;ring_attn_1_0_stage_9 -->
<g id="edge36" class="edge">
<title>ring_attn_1_0_stage_8&#45;&gt;ring_attn_1_0_stage_9</title>
<path fill="none" stroke="black" d="M155.33,-12852.48C155.33,-12852.48 155.33,-12700.58 155.33,-12700.58"/>
<polygon fill="black" stroke="black" points="158.83,-12700.58 155.33,-12690.58 151.83,-12700.58 158.83,-12700.58"/>
</g>
<!-- ring_attn_1_1_stage_8 -->
<g id="node134" class="node">
<title>ring_attn_1_1_stage_8</title>
<polygon fill="yellow" stroke="black" points="812,-12966 603,-12898 812,-12830 1021,-12898 812,-12966"/>
<text text-anchor="middle" x="812" y="-12916.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-12901.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="812" y="-12886.8" font-family="Times,serif" font-size="14.00">Q[1]×K[9]×V[9]</text>
<text text-anchor="middle" x="812" y="-12871.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_8&#45;&gt;ring_attn_1_1_stage_8 -->
<g id="edge1577" class="edge">
<title>ring_attn_1_0_stage_8&#45;&gt;ring_attn_1_1_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-12898C434.02,-12898 592.86,-12898 592.86,-12898"/>
<polygon fill="red" stroke="red" points="592.86,-12901.5 602.86,-12898 592.86,-12894.5 592.86,-12901.5"/>
</g>
<!-- ring_attn_1_0_stage_10 -->
<g id="node38" class="node">
<title>ring_attn_1_0_stage_10</title>
<polygon fill="yellow" stroke="black" points="225,-12460 16,-12392 225,-12324 434,-12392 225,-12460"/>
<text text-anchor="middle" x="225" y="-12410.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-12395.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="225" y="-12380.8" font-family="Times,serif" font-size="14.00">Q[0]×K[6]×V[6]</text>
<text text-anchor="middle" x="225" y="-12365.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_9&#45;&gt;ring_attn_1_0_stage_10 -->
<g id="edge37" class="edge">
<title>ring_attn_1_0_stage_9&#45;&gt;ring_attn_1_0_stage_10</title>
<path fill="none" stroke="black" d="M155.33,-12599.48C155.33,-12599.48 155.33,-12447.58 155.33,-12447.58"/>
<polygon fill="black" stroke="black" points="158.83,-12447.58 155.33,-12437.58 151.83,-12447.58 158.83,-12447.58"/>
</g>
<!-- ring_attn_1_1_stage_9 -->
<g id="node135" class="node">
<title>ring_attn_1_1_stage_9</title>
<polygon fill="yellow" stroke="black" points="812,-12713 603,-12645 812,-12577 1021,-12645 812,-12713"/>
<text text-anchor="middle" x="812" y="-12663.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-12648.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="812" y="-12633.8" font-family="Times,serif" font-size="14.00">Q[1]×K[8]×V[8]</text>
<text text-anchor="middle" x="812" y="-12618.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_9&#45;&gt;ring_attn_1_1_stage_9 -->
<g id="edge1578" class="edge">
<title>ring_attn_1_0_stage_9&#45;&gt;ring_attn_1_1_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-12645C434.02,-12645 592.86,-12645 592.86,-12645"/>
<polygon fill="red" stroke="red" points="592.86,-12648.5 602.86,-12645 592.86,-12641.5 592.86,-12648.5"/>
</g>
<!-- ring_attn_1_0_stage_11 -->
<g id="node39" class="node">
<title>ring_attn_1_0_stage_11</title>
<polygon fill="yellow" stroke="black" points="225,-12207 16,-12139 225,-12071 434,-12139 225,-12207"/>
<text text-anchor="middle" x="225" y="-12157.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-12142.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="225" y="-12127.8" font-family="Times,serif" font-size="14.00">Q[0]×K[5]×V[5]</text>
<text text-anchor="middle" x="225" y="-12112.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_10&#45;&gt;ring_attn_1_0_stage_11 -->
<g id="edge38" class="edge">
<title>ring_attn_1_0_stage_10&#45;&gt;ring_attn_1_0_stage_11</title>
<path fill="none" stroke="black" d="M120.5,-12357.88C120.5,-12357.88 120.5,-12183.39 120.5,-12183.39"/>
<polygon fill="black" stroke="black" points="124,-12183.39 120.5,-12173.39 117,-12183.39 124,-12183.39"/>
</g>
<!-- ring_attn_1_1_stage_10 -->
<g id="node136" class="node">
<title>ring_attn_1_1_stage_10</title>
<polygon fill="yellow" stroke="black" points="812,-12460 603,-12392 812,-12324 1021,-12392 812,-12460"/>
<text text-anchor="middle" x="812" y="-12410.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-12395.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="812" y="-12380.8" font-family="Times,serif" font-size="14.00">Q[1]×K[7]×V[7]</text>
<text text-anchor="middle" x="812" y="-12365.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_10&#45;&gt;ring_attn_1_1_stage_10 -->
<g id="edge1579" class="edge">
<title>ring_attn_1_0_stage_10&#45;&gt;ring_attn_1_1_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-12392C434.02,-12392 592.86,-12392 592.86,-12392"/>
<polygon fill="red" stroke="red" points="592.86,-12395.5 602.86,-12392 592.86,-12388.5 592.86,-12395.5"/>
</g>
<!-- ring_attn_1_0_stage_12 -->
<g id="node40" class="node">
<title>ring_attn_1_0_stage_12</title>
<polygon fill="yellow" stroke="black" points="225,-11954 16,-11886 225,-11818 434,-11886 225,-11954"/>
<text text-anchor="middle" x="225" y="-11904.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-11889.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="225" y="-11874.8" font-family="Times,serif" font-size="14.00">Q[0]×K[4]×V[4]</text>
<text text-anchor="middle" x="225" y="-11859.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_11&#45;&gt;ring_attn_1_0_stage_12 -->
<g id="edge39" class="edge">
<title>ring_attn_1_0_stage_11&#45;&gt;ring_attn_1_0_stage_12</title>
<path fill="none" stroke="black" d="M155.33,-12093.48C155.33,-12093.48 155.33,-11941.58 155.33,-11941.58"/>
<polygon fill="black" stroke="black" points="158.83,-11941.58 155.33,-11931.58 151.83,-11941.58 158.83,-11941.58"/>
</g>
<!-- ring_attn_1_1_stage_11 -->
<g id="node137" class="node">
<title>ring_attn_1_1_stage_11</title>
<polygon fill="yellow" stroke="black" points="812,-12207 603,-12139 812,-12071 1021,-12139 812,-12207"/>
<text text-anchor="middle" x="812" y="-12157.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-12142.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="812" y="-12127.8" font-family="Times,serif" font-size="14.00">Q[1]×K[6]×V[6]</text>
<text text-anchor="middle" x="812" y="-12112.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_11&#45;&gt;ring_attn_1_1_stage_11 -->
<g id="edge1580" class="edge">
<title>ring_attn_1_0_stage_11&#45;&gt;ring_attn_1_1_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-12139C434.02,-12139 592.86,-12139 592.86,-12139"/>
<polygon fill="red" stroke="red" points="592.86,-12142.5 602.86,-12139 592.86,-12135.5 592.86,-12142.5"/>
</g>
<!-- ring_attn_1_0_stage_13 -->
<g id="node41" class="node">
<title>ring_attn_1_0_stage_13</title>
<polygon fill="yellow" stroke="black" points="225,-11701 16,-11633 225,-11565 434,-11633 225,-11701"/>
<text text-anchor="middle" x="225" y="-11651.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-11636.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="225" y="-11621.8" font-family="Times,serif" font-size="14.00">Q[0]×K[3]×V[3]</text>
<text text-anchor="middle" x="225" y="-11606.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_12&#45;&gt;ring_attn_1_0_stage_13 -->
<g id="edge40" class="edge">
<title>ring_attn_1_0_stage_12&#45;&gt;ring_attn_1_0_stage_13</title>
<path fill="none" stroke="black" d="M155.33,-11840.48C155.33,-11840.48 155.33,-11688.58 155.33,-11688.58"/>
<polygon fill="black" stroke="black" points="158.83,-11688.58 155.33,-11678.58 151.83,-11688.58 158.83,-11688.58"/>
</g>
<!-- ring_attn_1_1_stage_12 -->
<g id="node138" class="node">
<title>ring_attn_1_1_stage_12</title>
<polygon fill="yellow" stroke="black" points="812,-11954 603,-11886 812,-11818 1021,-11886 812,-11954"/>
<text text-anchor="middle" x="812" y="-11904.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-11889.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="812" y="-11874.8" font-family="Times,serif" font-size="14.00">Q[1]×K[5]×V[5]</text>
<text text-anchor="middle" x="812" y="-11859.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_12&#45;&gt;ring_attn_1_1_stage_12 -->
<g id="edge1581" class="edge">
<title>ring_attn_1_0_stage_12&#45;&gt;ring_attn_1_1_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-11886C434.02,-11886 592.86,-11886 592.86,-11886"/>
<polygon fill="red" stroke="red" points="592.86,-11889.5 602.86,-11886 592.86,-11882.5 592.86,-11889.5"/>
</g>
<!-- ring_attn_1_0_stage_14 -->
<g id="node42" class="node">
<title>ring_attn_1_0_stage_14</title>
<polygon fill="yellow" stroke="black" points="225,-11448 16,-11380 225,-11312 434,-11380 225,-11448"/>
<text text-anchor="middle" x="225" y="-11398.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-11383.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="225" y="-11368.8" font-family="Times,serif" font-size="14.00">Q[0]×K[2]×V[2]</text>
<text text-anchor="middle" x="225" y="-11353.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_13&#45;&gt;ring_attn_1_0_stage_14 -->
<g id="edge41" class="edge">
<title>ring_attn_1_0_stage_13&#45;&gt;ring_attn_1_0_stage_14</title>
<path fill="none" stroke="black" d="M225,-11564.87C225,-11564.87 225,-11458.25 225,-11458.25"/>
<polygon fill="black" stroke="black" points="228.5,-11458.25 225,-11448.25 221.5,-11458.25 228.5,-11458.25"/>
</g>
<!-- ring_attn_1_1_stage_13 -->
<g id="node139" class="node">
<title>ring_attn_1_1_stage_13</title>
<polygon fill="yellow" stroke="black" points="812,-11701 603,-11633 812,-11565 1021,-11633 812,-11701"/>
<text text-anchor="middle" x="812" y="-11651.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-11636.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="812" y="-11621.8" font-family="Times,serif" font-size="14.00">Q[1]×K[4]×V[4]</text>
<text text-anchor="middle" x="812" y="-11606.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_13&#45;&gt;ring_attn_1_1_stage_13 -->
<g id="edge1582" class="edge">
<title>ring_attn_1_0_stage_13&#45;&gt;ring_attn_1_1_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-11633C434.02,-11633 592.86,-11633 592.86,-11633"/>
<polygon fill="red" stroke="red" points="592.86,-11636.5 602.86,-11633 592.86,-11629.5 592.86,-11636.5"/>
</g>
<!-- ring_attn_1_0_stage_15 -->
<g id="node43" class="node">
<title>ring_attn_1_0_stage_15</title>
<polygon fill="yellow" stroke="black" points="225,-11195 16,-11127 225,-11059 434,-11127 225,-11195"/>
<text text-anchor="middle" x="225" y="-11145.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-11130.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="225" y="-11115.8" font-family="Times,serif" font-size="14.00">Q[0]×K[1]×V[1]</text>
<text text-anchor="middle" x="225" y="-11100.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_14&#45;&gt;ring_attn_1_0_stage_15 -->
<g id="edge42" class="edge">
<title>ring_attn_1_0_stage_14&#45;&gt;ring_attn_1_0_stage_15</title>
<path fill="none" stroke="black" d="M155.33,-11334.48C155.33,-11334.48 155.33,-11182.58 155.33,-11182.58"/>
<polygon fill="black" stroke="black" points="158.83,-11182.58 155.33,-11172.58 151.83,-11182.58 158.83,-11182.58"/>
</g>
<!-- ring_attn_1_1_stage_14 -->
<g id="node140" class="node">
<title>ring_attn_1_1_stage_14</title>
<polygon fill="yellow" stroke="black" points="812,-11448 603,-11380 812,-11312 1021,-11380 812,-11448"/>
<text text-anchor="middle" x="812" y="-11398.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-11383.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="812" y="-11368.8" font-family="Times,serif" font-size="14.00">Q[1]×K[3]×V[3]</text>
<text text-anchor="middle" x="812" y="-11353.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_14&#45;&gt;ring_attn_1_1_stage_14 -->
<g id="edge1583" class="edge">
<title>ring_attn_1_0_stage_14&#45;&gt;ring_attn_1_1_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-11380C434.02,-11380 592.86,-11380 592.86,-11380"/>
<polygon fill="red" stroke="red" points="592.86,-11383.5 602.86,-11380 592.86,-11376.5 592.86,-11383.5"/>
</g>
<!-- attn_out_1_0 -->
<g id="node44" class="node">
<title>attn_out_1_0</title>
<polygon fill="none" stroke="black" points="294.5,-10986 155.5,-10986 155.5,-10933 294.5,-10933 294.5,-10986"/>
<text text-anchor="middle" x="225" y="-10970.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="225" y="-10955.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="225" y="-10940.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_1_0_stage_15&#45;&gt;attn_out_1_0 -->
<g id="edge43" class="edge">
<title>ring_attn_1_0_stage_15&#45;&gt;attn_out_1_0</title>
<path fill="none" stroke="black" d="M225,-11058.87C225,-11058.87 225,-10996.18 225,-10996.18"/>
<polygon fill="black" stroke="black" points="228.5,-10996.18 225,-10986.18 221.5,-10996.18 228.5,-10996.18"/>
</g>
<!-- ring_attn_1_1_stage_15 -->
<g id="node141" class="node">
<title>ring_attn_1_1_stage_15</title>
<polygon fill="yellow" stroke="black" points="812,-11195 603,-11127 812,-11059 1021,-11127 812,-11195"/>
<text text-anchor="middle" x="812" y="-11145.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-11130.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="812" y="-11115.8" font-family="Times,serif" font-size="14.00">Q[1]×K[2]×V[2]</text>
<text text-anchor="middle" x="812" y="-11100.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_0_stage_15&#45;&gt;ring_attn_1_1_stage_15 -->
<g id="edge1584" class="edge">
<title>ring_attn_1_0_stage_15&#45;&gt;ring_attn_1_1_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-11127C434.02,-11127 592.86,-11127 592.86,-11127"/>
<polygon fill="red" stroke="red" points="592.86,-11130.5 602.86,-11127 592.86,-11123.5 592.86,-11130.5"/>
</g>
<!-- attn_residual_1_0 -->
<g id="node45" class="node">
<title>attn_residual_1_0</title>
<ellipse fill="none" stroke="black" cx="225" cy="-10833" rx="105.5" ry="27"/>
<text text-anchor="middle" x="225" y="-10836.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="225" y="-10821.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_1_0&#45;&gt;attn_residual_1_0 -->
<g id="edge44" class="edge">
<title>attn_out_1_0&#45;&gt;attn_residual_1_0</title>
<path fill="none" stroke="black" d="M225,-10932.98C225,-10932.98 225,-10870.36 225,-10870.36"/>
<polygon fill="black" stroke="black" points="228.5,-10870.36 225,-10860.36 221.5,-10870.36 228.5,-10870.36"/>
</g>
<!-- ffn_up_1_0 -->
<g id="node46" class="node">
<title>ffn_up_1_0</title>
<polygon fill="none" stroke="black" points="304,-10733 146,-10733 146,-10680 304,-10680 304,-10733"/>
<text text-anchor="middle" x="225" y="-10717.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="225" y="-10702.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="225" y="-10687.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_1_0&#45;&gt;ffn_up_1_0 -->
<g id="edge45" class="edge">
<title>attn_residual_1_0&#45;&gt;ffn_up_1_0</title>
<path fill="none" stroke="black" d="M225,-10805.86C225,-10805.86 225,-10743.16 225,-10743.16"/>
<polygon fill="black" stroke="black" points="228.5,-10743.16 225,-10733.16 221.5,-10743.16 228.5,-10743.16"/>
</g>
<!-- ffn_gelu_1_0 -->
<g id="node47" class="node">
<title>ffn_gelu_1_0</title>
<ellipse fill="none" stroke="black" cx="225" cy="-10580" rx="105.5" ry="27"/>
<text text-anchor="middle" x="225" y="-10583.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="225" y="-10568.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_1_0&#45;&gt;ffn_gelu_1_0 -->
<g id="edge46" class="edge">
<title>ffn_up_1_0&#45;&gt;ffn_gelu_1_0</title>
<path fill="none" stroke="black" d="M225,-10679.98C225,-10679.98 225,-10617.36 225,-10617.36"/>
<polygon fill="black" stroke="black" points="228.5,-10617.36 225,-10607.36 221.5,-10617.36 228.5,-10617.36"/>
</g>
<!-- ffn_down_1_0 -->
<g id="node48" class="node">
<title>ffn_down_1_0</title>
<polygon fill="none" stroke="black" points="314,-10480 136,-10480 136,-10427 314,-10427 314,-10480"/>
<text text-anchor="middle" x="225" y="-10464.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="225" y="-10449.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="225" y="-10434.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_1_0&#45;&gt;ffn_down_1_0 -->
<g id="edge47" class="edge">
<title>ffn_gelu_1_0&#45;&gt;ffn_down_1_0</title>
<path fill="none" stroke="black" d="M225,-10552.86C225,-10552.86 225,-10490.16 225,-10490.16"/>
<polygon fill="black" stroke="black" points="228.5,-10490.16 225,-10480.16 221.5,-10490.16 228.5,-10490.16"/>
</g>
<!-- ffn_residual_1_0 -->
<g id="node49" class="node">
<title>ffn_residual_1_0</title>
<ellipse fill="none" stroke="black" cx="225" cy="-10327" rx="105.5" ry="27"/>
<text text-anchor="middle" x="225" y="-10330.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="225" y="-10315.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_1_0&#45;&gt;ffn_residual_1_0 -->
<g id="edge48" class="edge">
<title>ffn_down_1_0&#45;&gt;ffn_residual_1_0</title>
<path fill="none" stroke="black" d="M225,-10426.98C225,-10426.98 225,-10364.36 225,-10364.36"/>
<polygon fill="black" stroke="black" points="228.5,-10364.36 225,-10354.36 221.5,-10364.36 228.5,-10364.36"/>
</g>
<!-- qkv_proj_2_0 -->
<g id="node50" class="node">
<title>qkv_proj_2_0</title>
<polygon fill="none" stroke="black" points="307.5,-10227 142.5,-10227 142.5,-10174 307.5,-10174 307.5,-10227"/>
<text text-anchor="middle" x="225" y="-10211.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="225" y="-10196.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="225" y="-10181.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_1_0&#45;&gt;qkv_proj_2_0 -->
<g id="edge49" class="edge">
<title>ffn_residual_1_0&#45;&gt;qkv_proj_2_0</title>
<path fill="none" stroke="black" d="M225,-10299.86C225,-10299.86 225,-10237.16 225,-10237.16"/>
<polygon fill="black" stroke="black" points="228.5,-10237.16 225,-10227.16 221.5,-10237.16 228.5,-10237.16"/>
</g>
<!-- qkv_reshape_2_0 -->
<g id="node51" class="node">
<title>qkv_reshape_2_0</title>
<ellipse fill="none" stroke="black" cx="225" cy="-10074" rx="148" ry="27"/>
<text text-anchor="middle" x="225" y="-10077.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="225" y="-10062.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_2_0&#45;&gt;qkv_reshape_2_0 -->
<g id="edge50" class="edge">
<title>qkv_proj_2_0&#45;&gt;qkv_reshape_2_0</title>
<path fill="none" stroke="black" d="M225,-10173.98C225,-10173.98 225,-10111.36 225,-10111.36"/>
<polygon fill="black" stroke="black" points="228.5,-10111.36 225,-10101.36 221.5,-10111.36 228.5,-10111.36"/>
</g>
<!-- ring_attn_2_0_stage_0 -->
<g id="node52" class="node">
<title>ring_attn_2_0_stage_0</title>
<polygon fill="yellow" stroke="black" points="225,-9930 16,-9862 225,-9794 434,-9862 225,-9930"/>
<text text-anchor="middle" x="225" y="-9880.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-9865.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="225" y="-9850.8" font-family="Times,serif" font-size="14.00">Q[0]×K[0]×V[0]</text>
<text text-anchor="middle" x="225" y="-9835.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- qkv_reshape_2_0&#45;&gt;ring_attn_2_0_stage_0 -->
<g id="edge51" class="edge">
<title>qkv_reshape_2_0&#45;&gt;ring_attn_2_0_stage_0</title>
<path fill="none" stroke="black" d="M225,-10046.72C225,-10046.72 225,-9940.16 225,-9940.16"/>
<polygon fill="black" stroke="black" points="228.5,-9940.16 225,-9930.16 221.5,-9940.16 228.5,-9940.16"/>
</g>
<!-- ring_attn_2_0_stage_1 -->
<g id="node53" class="node">
<title>ring_attn_2_0_stage_1</title>
<polygon fill="yellow" stroke="black" points="225,-9677 16,-9609 225,-9541 434,-9609 225,-9677"/>
<text text-anchor="middle" x="225" y="-9627.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-9612.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="225" y="-9597.8" font-family="Times,serif" font-size="14.00">Q[0]×K[15]×V[15]</text>
<text text-anchor="middle" x="225" y="-9582.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_0&#45;&gt;ring_attn_2_0_stage_1 -->
<g id="edge52" class="edge">
<title>ring_attn_2_0_stage_0&#45;&gt;ring_attn_2_0_stage_1</title>
<path fill="none" stroke="black" d="M225,-9793.87C225,-9793.87 225,-9687.25 225,-9687.25"/>
<polygon fill="black" stroke="black" points="228.5,-9687.25 225,-9677.25 221.5,-9687.25 228.5,-9687.25"/>
</g>
<!-- ring_attn_2_1_stage_0 -->
<g id="node150" class="node">
<title>ring_attn_2_1_stage_0</title>
<polygon fill="yellow" stroke="black" points="812,-9930 603,-9862 812,-9794 1021,-9862 812,-9930"/>
<text text-anchor="middle" x="812" y="-9880.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-9865.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="812" y="-9850.8" font-family="Times,serif" font-size="14.00">Q[1]×K[1]×V[1]</text>
<text text-anchor="middle" x="812" y="-9835.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_0&#45;&gt;ring_attn_2_1_stage_0 -->
<g id="edge1585" class="edge">
<title>ring_attn_2_0_stage_0&#45;&gt;ring_attn_2_1_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-9862C434.02,-9862 592.86,-9862 592.86,-9862"/>
<polygon fill="red" stroke="red" points="592.86,-9865.5 602.86,-9862 592.86,-9858.5 592.86,-9865.5"/>
</g>
<!-- ring_attn_2_0_stage_2 -->
<g id="node54" class="node">
<title>ring_attn_2_0_stage_2</title>
<polygon fill="yellow" stroke="black" points="225,-9424 16,-9356 225,-9288 434,-9356 225,-9424"/>
<text text-anchor="middle" x="225" y="-9374.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-9359.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="225" y="-9344.8" font-family="Times,serif" font-size="14.00">Q[0]×K[14]×V[14]</text>
<text text-anchor="middle" x="225" y="-9329.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_1&#45;&gt;ring_attn_2_0_stage_2 -->
<g id="edge53" class="edge">
<title>ring_attn_2_0_stage_1&#45;&gt;ring_attn_2_0_stage_2</title>
<path fill="none" stroke="black" d="M120.5,-9574.88C120.5,-9574.88 120.5,-9400.39 120.5,-9400.39"/>
<polygon fill="black" stroke="black" points="124,-9400.39 120.5,-9390.39 117,-9400.39 124,-9400.39"/>
</g>
<!-- ring_attn_2_1_stage_1 -->
<g id="node151" class="node">
<title>ring_attn_2_1_stage_1</title>
<polygon fill="yellow" stroke="black" points="812,-9677 603,-9609 812,-9541 1021,-9609 812,-9677"/>
<text text-anchor="middle" x="812" y="-9627.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-9612.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="812" y="-9597.8" font-family="Times,serif" font-size="14.00">Q[1]×K[0]×V[0]</text>
<text text-anchor="middle" x="812" y="-9582.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_1&#45;&gt;ring_attn_2_1_stage_1 -->
<g id="edge1586" class="edge">
<title>ring_attn_2_0_stage_1&#45;&gt;ring_attn_2_1_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-9609C434.02,-9609 592.86,-9609 592.86,-9609"/>
<polygon fill="red" stroke="red" points="592.86,-9612.5 602.86,-9609 592.86,-9605.5 592.86,-9612.5"/>
</g>
<!-- ring_attn_2_0_stage_3 -->
<g id="node55" class="node">
<title>ring_attn_2_0_stage_3</title>
<polygon fill="yellow" stroke="black" points="225,-9171 16,-9103 225,-9035 434,-9103 225,-9171"/>
<text text-anchor="middle" x="225" y="-9121.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-9106.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="225" y="-9091.8" font-family="Times,serif" font-size="14.00">Q[0]×K[13]×V[13]</text>
<text text-anchor="middle" x="225" y="-9076.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_2&#45;&gt;ring_attn_2_0_stage_3 -->
<g id="edge54" class="edge">
<title>ring_attn_2_0_stage_2&#45;&gt;ring_attn_2_0_stage_3</title>
<path fill="none" stroke="black" d="M155.33,-9310.48C155.33,-9310.48 155.33,-9158.58 155.33,-9158.58"/>
<polygon fill="black" stroke="black" points="158.83,-9158.58 155.33,-9148.58 151.83,-9158.58 158.83,-9158.58"/>
</g>
<!-- ring_attn_2_1_stage_2 -->
<g id="node152" class="node">
<title>ring_attn_2_1_stage_2</title>
<polygon fill="yellow" stroke="black" points="812,-9424 603,-9356 812,-9288 1021,-9356 812,-9424"/>
<text text-anchor="middle" x="812" y="-9374.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-9359.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="812" y="-9344.8" font-family="Times,serif" font-size="14.00">Q[1]×K[15]×V[15]</text>
<text text-anchor="middle" x="812" y="-9329.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_2&#45;&gt;ring_attn_2_1_stage_2 -->
<g id="edge1587" class="edge">
<title>ring_attn_2_0_stage_2&#45;&gt;ring_attn_2_1_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-9356C434.02,-9356 592.86,-9356 592.86,-9356"/>
<polygon fill="red" stroke="red" points="592.86,-9359.5 602.86,-9356 592.86,-9352.5 592.86,-9359.5"/>
</g>
<!-- ring_attn_2_0_stage_4 -->
<g id="node56" class="node">
<title>ring_attn_2_0_stage_4</title>
<polygon fill="yellow" stroke="black" points="225,-8918 16,-8850 225,-8782 434,-8850 225,-8918"/>
<text text-anchor="middle" x="225" y="-8868.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-8853.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="225" y="-8838.8" font-family="Times,serif" font-size="14.00">Q[0]×K[12]×V[12]</text>
<text text-anchor="middle" x="225" y="-8823.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_3&#45;&gt;ring_attn_2_0_stage_4 -->
<g id="edge55" class="edge">
<title>ring_attn_2_0_stage_3&#45;&gt;ring_attn_2_0_stage_4</title>
<path fill="none" stroke="black" d="M155.33,-9057.48C155.33,-9057.48 155.33,-8905.58 155.33,-8905.58"/>
<polygon fill="black" stroke="black" points="158.83,-8905.58 155.33,-8895.58 151.83,-8905.58 158.83,-8905.58"/>
</g>
<!-- ring_attn_2_1_stage_3 -->
<g id="node153" class="node">
<title>ring_attn_2_1_stage_3</title>
<polygon fill="yellow" stroke="black" points="812,-9171 603,-9103 812,-9035 1021,-9103 812,-9171"/>
<text text-anchor="middle" x="812" y="-9121.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-9106.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="812" y="-9091.8" font-family="Times,serif" font-size="14.00">Q[1]×K[14]×V[14]</text>
<text text-anchor="middle" x="812" y="-9076.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_3&#45;&gt;ring_attn_2_1_stage_3 -->
<g id="edge1588" class="edge">
<title>ring_attn_2_0_stage_3&#45;&gt;ring_attn_2_1_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-9103C434.02,-9103 592.86,-9103 592.86,-9103"/>
<polygon fill="red" stroke="red" points="592.86,-9106.5 602.86,-9103 592.86,-9099.5 592.86,-9106.5"/>
</g>
<!-- ring_attn_2_0_stage_5 -->
<g id="node57" class="node">
<title>ring_attn_2_0_stage_5</title>
<polygon fill="yellow" stroke="black" points="225,-8665 16,-8597 225,-8529 434,-8597 225,-8665"/>
<text text-anchor="middle" x="225" y="-8615.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-8600.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="225" y="-8585.8" font-family="Times,serif" font-size="14.00">Q[0]×K[11]×V[11]</text>
<text text-anchor="middle" x="225" y="-8570.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_4&#45;&gt;ring_attn_2_0_stage_5 -->
<g id="edge56" class="edge">
<title>ring_attn_2_0_stage_4&#45;&gt;ring_attn_2_0_stage_5</title>
<path fill="none" stroke="black" d="M225,-8781.87C225,-8781.87 225,-8675.25 225,-8675.25"/>
<polygon fill="black" stroke="black" points="228.5,-8675.25 225,-8665.25 221.5,-8675.25 228.5,-8675.25"/>
</g>
<!-- ring_attn_2_1_stage_4 -->
<g id="node154" class="node">
<title>ring_attn_2_1_stage_4</title>
<polygon fill="yellow" stroke="black" points="812,-8918 603,-8850 812,-8782 1021,-8850 812,-8918"/>
<text text-anchor="middle" x="812" y="-8868.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-8853.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="812" y="-8838.8" font-family="Times,serif" font-size="14.00">Q[1]×K[13]×V[13]</text>
<text text-anchor="middle" x="812" y="-8823.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_4&#45;&gt;ring_attn_2_1_stage_4 -->
<g id="edge1589" class="edge">
<title>ring_attn_2_0_stage_4&#45;&gt;ring_attn_2_1_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-8850C434.02,-8850 592.86,-8850 592.86,-8850"/>
<polygon fill="red" stroke="red" points="592.86,-8853.5 602.86,-8850 592.86,-8846.5 592.86,-8853.5"/>
</g>
<!-- ring_attn_2_0_stage_6 -->
<g id="node58" class="node">
<title>ring_attn_2_0_stage_6</title>
<polygon fill="yellow" stroke="black" points="225,-8412 16,-8344 225,-8276 434,-8344 225,-8412"/>
<text text-anchor="middle" x="225" y="-8362.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-8347.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="225" y="-8332.8" font-family="Times,serif" font-size="14.00">Q[0]×K[10]×V[10]</text>
<text text-anchor="middle" x="225" y="-8317.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_5&#45;&gt;ring_attn_2_0_stage_6 -->
<g id="edge57" class="edge">
<title>ring_attn_2_0_stage_5&#45;&gt;ring_attn_2_0_stage_6</title>
<path fill="none" stroke="black" d="M155.33,-8551.48C155.33,-8551.48 155.33,-8399.58 155.33,-8399.58"/>
<polygon fill="black" stroke="black" points="158.83,-8399.58 155.33,-8389.58 151.83,-8399.58 158.83,-8399.58"/>
</g>
<!-- ring_attn_2_1_stage_5 -->
<g id="node155" class="node">
<title>ring_attn_2_1_stage_5</title>
<polygon fill="yellow" stroke="black" points="812,-8665 603,-8597 812,-8529 1021,-8597 812,-8665"/>
<text text-anchor="middle" x="812" y="-8615.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-8600.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="812" y="-8585.8" font-family="Times,serif" font-size="14.00">Q[1]×K[12]×V[12]</text>
<text text-anchor="middle" x="812" y="-8570.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_5&#45;&gt;ring_attn_2_1_stage_5 -->
<g id="edge1590" class="edge">
<title>ring_attn_2_0_stage_5&#45;&gt;ring_attn_2_1_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-8597C434.02,-8597 592.86,-8597 592.86,-8597"/>
<polygon fill="red" stroke="red" points="592.86,-8600.5 602.86,-8597 592.86,-8593.5 592.86,-8600.5"/>
</g>
<!-- ring_attn_2_0_stage_7 -->
<g id="node59" class="node">
<title>ring_attn_2_0_stage_7</title>
<polygon fill="yellow" stroke="black" points="225,-8159 16,-8091 225,-8023 434,-8091 225,-8159"/>
<text text-anchor="middle" x="225" y="-8109.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-8094.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="225" y="-8079.8" font-family="Times,serif" font-size="14.00">Q[0]×K[9]×V[9]</text>
<text text-anchor="middle" x="225" y="-8064.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_6&#45;&gt;ring_attn_2_0_stage_7 -->
<g id="edge58" class="edge">
<title>ring_attn_2_0_stage_6&#45;&gt;ring_attn_2_0_stage_7</title>
<path fill="none" stroke="black" d="M155.33,-8298.48C155.33,-8298.48 155.33,-8146.58 155.33,-8146.58"/>
<polygon fill="black" stroke="black" points="158.83,-8146.58 155.33,-8136.58 151.83,-8146.58 158.83,-8146.58"/>
</g>
<!-- ring_attn_2_1_stage_6 -->
<g id="node156" class="node">
<title>ring_attn_2_1_stage_6</title>
<polygon fill="yellow" stroke="black" points="812,-8412 603,-8344 812,-8276 1021,-8344 812,-8412"/>
<text text-anchor="middle" x="812" y="-8362.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-8347.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="812" y="-8332.8" font-family="Times,serif" font-size="14.00">Q[1]×K[11]×V[11]</text>
<text text-anchor="middle" x="812" y="-8317.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_6&#45;&gt;ring_attn_2_1_stage_6 -->
<g id="edge1591" class="edge">
<title>ring_attn_2_0_stage_6&#45;&gt;ring_attn_2_1_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-8344C434.02,-8344 592.86,-8344 592.86,-8344"/>
<polygon fill="red" stroke="red" points="592.86,-8347.5 602.86,-8344 592.86,-8340.5 592.86,-8347.5"/>
</g>
<!-- ring_attn_2_0_stage_8 -->
<g id="node60" class="node">
<title>ring_attn_2_0_stage_8</title>
<polygon fill="yellow" stroke="black" points="225,-7906 16,-7838 225,-7770 434,-7838 225,-7906"/>
<text text-anchor="middle" x="225" y="-7856.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-7841.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="225" y="-7826.8" font-family="Times,serif" font-size="14.00">Q[0]×K[8]×V[8]</text>
<text text-anchor="middle" x="225" y="-7811.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_7&#45;&gt;ring_attn_2_0_stage_8 -->
<g id="edge59" class="edge">
<title>ring_attn_2_0_stage_7&#45;&gt;ring_attn_2_0_stage_8</title>
<path fill="none" stroke="black" d="M155.33,-8045.48C155.33,-8045.48 155.33,-7893.58 155.33,-7893.58"/>
<polygon fill="black" stroke="black" points="158.83,-7893.58 155.33,-7883.58 151.83,-7893.58 158.83,-7893.58"/>
</g>
<!-- ring_attn_2_1_stage_7 -->
<g id="node157" class="node">
<title>ring_attn_2_1_stage_7</title>
<polygon fill="yellow" stroke="black" points="812,-8159 603,-8091 812,-8023 1021,-8091 812,-8159"/>
<text text-anchor="middle" x="812" y="-8109.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-8094.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="812" y="-8079.8" font-family="Times,serif" font-size="14.00">Q[1]×K[10]×V[10]</text>
<text text-anchor="middle" x="812" y="-8064.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_7&#45;&gt;ring_attn_2_1_stage_7 -->
<g id="edge1592" class="edge">
<title>ring_attn_2_0_stage_7&#45;&gt;ring_attn_2_1_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-8091C434.02,-8091 592.86,-8091 592.86,-8091"/>
<polygon fill="red" stroke="red" points="592.86,-8094.5 602.86,-8091 592.86,-8087.5 592.86,-8094.5"/>
</g>
<!-- ring_attn_2_0_stage_9 -->
<g id="node61" class="node">
<title>ring_attn_2_0_stage_9</title>
<polygon fill="yellow" stroke="black" points="225,-7653 16,-7585 225,-7517 434,-7585 225,-7653"/>
<text text-anchor="middle" x="225" y="-7603.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-7588.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="225" y="-7573.8" font-family="Times,serif" font-size="14.00">Q[0]×K[7]×V[7]</text>
<text text-anchor="middle" x="225" y="-7558.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_8&#45;&gt;ring_attn_2_0_stage_9 -->
<g id="edge60" class="edge">
<title>ring_attn_2_0_stage_8&#45;&gt;ring_attn_2_0_stage_9</title>
<path fill="none" stroke="black" d="M155.33,-7792.48C155.33,-7792.48 155.33,-7640.58 155.33,-7640.58"/>
<polygon fill="black" stroke="black" points="158.83,-7640.58 155.33,-7630.58 151.83,-7640.58 158.83,-7640.58"/>
</g>
<!-- ring_attn_2_1_stage_8 -->
<g id="node158" class="node">
<title>ring_attn_2_1_stage_8</title>
<polygon fill="yellow" stroke="black" points="812,-7906 603,-7838 812,-7770 1021,-7838 812,-7906"/>
<text text-anchor="middle" x="812" y="-7856.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-7841.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="812" y="-7826.8" font-family="Times,serif" font-size="14.00">Q[1]×K[9]×V[9]</text>
<text text-anchor="middle" x="812" y="-7811.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_8&#45;&gt;ring_attn_2_1_stage_8 -->
<g id="edge1593" class="edge">
<title>ring_attn_2_0_stage_8&#45;&gt;ring_attn_2_1_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-7838C434.02,-7838 592.86,-7838 592.86,-7838"/>
<polygon fill="red" stroke="red" points="592.86,-7841.5 602.86,-7838 592.86,-7834.5 592.86,-7841.5"/>
</g>
<!-- ring_attn_2_0_stage_10 -->
<g id="node62" class="node">
<title>ring_attn_2_0_stage_10</title>
<polygon fill="yellow" stroke="black" points="225,-7400 16,-7332 225,-7264 434,-7332 225,-7400"/>
<text text-anchor="middle" x="225" y="-7350.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-7335.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="225" y="-7320.8" font-family="Times,serif" font-size="14.00">Q[0]×K[6]×V[6]</text>
<text text-anchor="middle" x="225" y="-7305.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_9&#45;&gt;ring_attn_2_0_stage_10 -->
<g id="edge61" class="edge">
<title>ring_attn_2_0_stage_9&#45;&gt;ring_attn_2_0_stage_10</title>
<path fill="none" stroke="black" d="M120.5,-7550.88C120.5,-7550.88 120.5,-7376.39 120.5,-7376.39"/>
<polygon fill="black" stroke="black" points="124,-7376.39 120.5,-7366.39 117,-7376.39 124,-7376.39"/>
</g>
<!-- ring_attn_2_1_stage_9 -->
<g id="node159" class="node">
<title>ring_attn_2_1_stage_9</title>
<polygon fill="yellow" stroke="black" points="812,-7653 603,-7585 812,-7517 1021,-7585 812,-7653"/>
<text text-anchor="middle" x="812" y="-7603.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-7588.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="812" y="-7573.8" font-family="Times,serif" font-size="14.00">Q[1]×K[8]×V[8]</text>
<text text-anchor="middle" x="812" y="-7558.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_9&#45;&gt;ring_attn_2_1_stage_9 -->
<g id="edge1594" class="edge">
<title>ring_attn_2_0_stage_9&#45;&gt;ring_attn_2_1_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-7585C434.02,-7585 592.86,-7585 592.86,-7585"/>
<polygon fill="red" stroke="red" points="592.86,-7588.5 602.86,-7585 592.86,-7581.5 592.86,-7588.5"/>
</g>
<!-- ring_attn_2_0_stage_11 -->
<g id="node63" class="node">
<title>ring_attn_2_0_stage_11</title>
<polygon fill="yellow" stroke="black" points="225,-7147 16,-7079 225,-7011 434,-7079 225,-7147"/>
<text text-anchor="middle" x="225" y="-7097.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-7082.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="225" y="-7067.8" font-family="Times,serif" font-size="14.00">Q[0]×K[5]×V[5]</text>
<text text-anchor="middle" x="225" y="-7052.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_10&#45;&gt;ring_attn_2_0_stage_11 -->
<g id="edge62" class="edge">
<title>ring_attn_2_0_stage_10&#45;&gt;ring_attn_2_0_stage_11</title>
<path fill="none" stroke="black" d="M155.33,-7286.48C155.33,-7286.48 155.33,-7134.58 155.33,-7134.58"/>
<polygon fill="black" stroke="black" points="158.83,-7134.58 155.33,-7124.58 151.83,-7134.58 158.83,-7134.58"/>
</g>
<!-- ring_attn_2_1_stage_10 -->
<g id="node160" class="node">
<title>ring_attn_2_1_stage_10</title>
<polygon fill="yellow" stroke="black" points="812,-7400 603,-7332 812,-7264 1021,-7332 812,-7400"/>
<text text-anchor="middle" x="812" y="-7350.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-7335.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="812" y="-7320.8" font-family="Times,serif" font-size="14.00">Q[1]×K[7]×V[7]</text>
<text text-anchor="middle" x="812" y="-7305.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_10&#45;&gt;ring_attn_2_1_stage_10 -->
<g id="edge1595" class="edge">
<title>ring_attn_2_0_stage_10&#45;&gt;ring_attn_2_1_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-7332C434.02,-7332 592.86,-7332 592.86,-7332"/>
<polygon fill="red" stroke="red" points="592.86,-7335.5 602.86,-7332 592.86,-7328.5 592.86,-7335.5"/>
</g>
<!-- ring_attn_2_0_stage_12 -->
<g id="node64" class="node">
<title>ring_attn_2_0_stage_12</title>
<polygon fill="yellow" stroke="black" points="225,-6894 16,-6826 225,-6758 434,-6826 225,-6894"/>
<text text-anchor="middle" x="225" y="-6844.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-6829.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="225" y="-6814.8" font-family="Times,serif" font-size="14.00">Q[0]×K[4]×V[4]</text>
<text text-anchor="middle" x="225" y="-6799.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_11&#45;&gt;ring_attn_2_0_stage_12 -->
<g id="edge63" class="edge">
<title>ring_attn_2_0_stage_11&#45;&gt;ring_attn_2_0_stage_12</title>
<path fill="none" stroke="black" d="M225,-7010.87C225,-7010.87 225,-6904.25 225,-6904.25"/>
<polygon fill="black" stroke="black" points="228.5,-6904.25 225,-6894.25 221.5,-6904.25 228.5,-6904.25"/>
</g>
<!-- ring_attn_2_1_stage_11 -->
<g id="node161" class="node">
<title>ring_attn_2_1_stage_11</title>
<polygon fill="yellow" stroke="black" points="812,-7147 603,-7079 812,-7011 1021,-7079 812,-7147"/>
<text text-anchor="middle" x="812" y="-7097.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-7082.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="812" y="-7067.8" font-family="Times,serif" font-size="14.00">Q[1]×K[6]×V[6]</text>
<text text-anchor="middle" x="812" y="-7052.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_11&#45;&gt;ring_attn_2_1_stage_11 -->
<g id="edge1596" class="edge">
<title>ring_attn_2_0_stage_11&#45;&gt;ring_attn_2_1_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-7079C434.02,-7079 592.86,-7079 592.86,-7079"/>
<polygon fill="red" stroke="red" points="592.86,-7082.5 602.86,-7079 592.86,-7075.5 592.86,-7082.5"/>
</g>
<!-- ring_attn_2_0_stage_13 -->
<g id="node65" class="node">
<title>ring_attn_2_0_stage_13</title>
<polygon fill="yellow" stroke="black" points="225,-6641 16,-6573 225,-6505 434,-6573 225,-6641"/>
<text text-anchor="middle" x="225" y="-6591.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-6576.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="225" y="-6561.8" font-family="Times,serif" font-size="14.00">Q[0]×K[3]×V[3]</text>
<text text-anchor="middle" x="225" y="-6546.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_12&#45;&gt;ring_attn_2_0_stage_13 -->
<g id="edge64" class="edge">
<title>ring_attn_2_0_stage_12&#45;&gt;ring_attn_2_0_stage_13</title>
<path fill="none" stroke="black" d="M155.33,-6780.48C155.33,-6780.48 155.33,-6628.58 155.33,-6628.58"/>
<polygon fill="black" stroke="black" points="158.83,-6628.58 155.33,-6618.58 151.83,-6628.58 158.83,-6628.58"/>
</g>
<!-- ring_attn_2_1_stage_12 -->
<g id="node162" class="node">
<title>ring_attn_2_1_stage_12</title>
<polygon fill="yellow" stroke="black" points="812,-6894 603,-6826 812,-6758 1021,-6826 812,-6894"/>
<text text-anchor="middle" x="812" y="-6844.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-6829.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="812" y="-6814.8" font-family="Times,serif" font-size="14.00">Q[1]×K[5]×V[5]</text>
<text text-anchor="middle" x="812" y="-6799.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_12&#45;&gt;ring_attn_2_1_stage_12 -->
<g id="edge1597" class="edge">
<title>ring_attn_2_0_stage_12&#45;&gt;ring_attn_2_1_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-6826C434.02,-6826 592.86,-6826 592.86,-6826"/>
<polygon fill="red" stroke="red" points="592.86,-6829.5 602.86,-6826 592.86,-6822.5 592.86,-6829.5"/>
</g>
<!-- ring_attn_2_0_stage_14 -->
<g id="node66" class="node">
<title>ring_attn_2_0_stage_14</title>
<polygon fill="yellow" stroke="black" points="225,-6388 16,-6320 225,-6252 434,-6320 225,-6388"/>
<text text-anchor="middle" x="225" y="-6338.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-6323.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="225" y="-6308.8" font-family="Times,serif" font-size="14.00">Q[0]×K[2]×V[2]</text>
<text text-anchor="middle" x="225" y="-6293.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_13&#45;&gt;ring_attn_2_0_stage_14 -->
<g id="edge65" class="edge">
<title>ring_attn_2_0_stage_13&#45;&gt;ring_attn_2_0_stage_14</title>
<path fill="none" stroke="black" d="M155.33,-6527.48C155.33,-6527.48 155.33,-6375.58 155.33,-6375.58"/>
<polygon fill="black" stroke="black" points="158.83,-6375.58 155.33,-6365.58 151.83,-6375.58 158.83,-6375.58"/>
</g>
<!-- ring_attn_2_1_stage_13 -->
<g id="node163" class="node">
<title>ring_attn_2_1_stage_13</title>
<polygon fill="yellow" stroke="black" points="812,-6641 603,-6573 812,-6505 1021,-6573 812,-6641"/>
<text text-anchor="middle" x="812" y="-6591.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-6576.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="812" y="-6561.8" font-family="Times,serif" font-size="14.00">Q[1]×K[4]×V[4]</text>
<text text-anchor="middle" x="812" y="-6546.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_13&#45;&gt;ring_attn_2_1_stage_13 -->
<g id="edge1598" class="edge">
<title>ring_attn_2_0_stage_13&#45;&gt;ring_attn_2_1_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-6573C434.02,-6573 592.86,-6573 592.86,-6573"/>
<polygon fill="red" stroke="red" points="592.86,-6576.5 602.86,-6573 592.86,-6569.5 592.86,-6576.5"/>
</g>
<!-- ring_attn_2_0_stage_15 -->
<g id="node67" class="node">
<title>ring_attn_2_0_stage_15</title>
<polygon fill="yellow" stroke="black" points="225,-6135 16,-6067 225,-5999 434,-6067 225,-6135"/>
<text text-anchor="middle" x="225" y="-6085.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-6070.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="225" y="-6055.8" font-family="Times,serif" font-size="14.00">Q[0]×K[1]×V[1]</text>
<text text-anchor="middle" x="225" y="-6040.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_14&#45;&gt;ring_attn_2_0_stage_15 -->
<g id="edge66" class="edge">
<title>ring_attn_2_0_stage_14&#45;&gt;ring_attn_2_0_stage_15</title>
<path fill="none" stroke="black" d="M155.33,-6274.48C155.33,-6274.48 155.33,-6122.58 155.33,-6122.58"/>
<polygon fill="black" stroke="black" points="158.83,-6122.58 155.33,-6112.58 151.83,-6122.58 158.83,-6122.58"/>
</g>
<!-- ring_attn_2_1_stage_14 -->
<g id="node164" class="node">
<title>ring_attn_2_1_stage_14</title>
<polygon fill="yellow" stroke="black" points="812,-6388 603,-6320 812,-6252 1021,-6320 812,-6388"/>
<text text-anchor="middle" x="812" y="-6338.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-6323.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="812" y="-6308.8" font-family="Times,serif" font-size="14.00">Q[1]×K[3]×V[3]</text>
<text text-anchor="middle" x="812" y="-6293.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_14&#45;&gt;ring_attn_2_1_stage_14 -->
<g id="edge1599" class="edge">
<title>ring_attn_2_0_stage_14&#45;&gt;ring_attn_2_1_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-6320C434.02,-6320 592.86,-6320 592.86,-6320"/>
<polygon fill="red" stroke="red" points="592.86,-6323.5 602.86,-6320 592.86,-6316.5 592.86,-6323.5"/>
</g>
<!-- attn_out_2_0 -->
<g id="node68" class="node">
<title>attn_out_2_0</title>
<polygon fill="none" stroke="black" points="294.5,-5926 155.5,-5926 155.5,-5873 294.5,-5873 294.5,-5926"/>
<text text-anchor="middle" x="225" y="-5910.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="225" y="-5895.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="225" y="-5880.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_2_0_stage_15&#45;&gt;attn_out_2_0 -->
<g id="edge67" class="edge">
<title>ring_attn_2_0_stage_15&#45;&gt;attn_out_2_0</title>
<path fill="none" stroke="black" d="M225,-5998.87C225,-5998.87 225,-5936.18 225,-5936.18"/>
<polygon fill="black" stroke="black" points="228.5,-5936.18 225,-5926.18 221.5,-5936.18 228.5,-5936.18"/>
</g>
<!-- ring_attn_2_1_stage_15 -->
<g id="node165" class="node">
<title>ring_attn_2_1_stage_15</title>
<polygon fill="yellow" stroke="black" points="812,-6135 603,-6067 812,-5999 1021,-6067 812,-6135"/>
<text text-anchor="middle" x="812" y="-6085.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-6070.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="812" y="-6055.8" font-family="Times,serif" font-size="14.00">Q[1]×K[2]×V[2]</text>
<text text-anchor="middle" x="812" y="-6040.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_0_stage_15&#45;&gt;ring_attn_2_1_stage_15 -->
<g id="edge1600" class="edge">
<title>ring_attn_2_0_stage_15&#45;&gt;ring_attn_2_1_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-6067C434.02,-6067 592.86,-6067 592.86,-6067"/>
<polygon fill="red" stroke="red" points="592.86,-6070.5 602.86,-6067 592.86,-6063.5 592.86,-6070.5"/>
</g>
<!-- attn_residual_2_0 -->
<g id="node69" class="node">
<title>attn_residual_2_0</title>
<ellipse fill="none" stroke="black" cx="225" cy="-5773" rx="105.5" ry="27"/>
<text text-anchor="middle" x="225" y="-5776.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="225" y="-5761.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_2_0&#45;&gt;attn_residual_2_0 -->
<g id="edge68" class="edge">
<title>attn_out_2_0&#45;&gt;attn_residual_2_0</title>
<path fill="none" stroke="black" d="M225,-5872.98C225,-5872.98 225,-5810.36 225,-5810.36"/>
<polygon fill="black" stroke="black" points="228.5,-5810.36 225,-5800.36 221.5,-5810.36 228.5,-5810.36"/>
</g>
<!-- ffn_up_2_0 -->
<g id="node70" class="node">
<title>ffn_up_2_0</title>
<polygon fill="none" stroke="black" points="304,-5673 146,-5673 146,-5620 304,-5620 304,-5673"/>
<text text-anchor="middle" x="225" y="-5657.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="225" y="-5642.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="225" y="-5627.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_2_0&#45;&gt;ffn_up_2_0 -->
<g id="edge69" class="edge">
<title>attn_residual_2_0&#45;&gt;ffn_up_2_0</title>
<path fill="none" stroke="black" d="M225,-5745.86C225,-5745.86 225,-5683.16 225,-5683.16"/>
<polygon fill="black" stroke="black" points="228.5,-5683.16 225,-5673.16 221.5,-5683.16 228.5,-5683.16"/>
</g>
<!-- ffn_gelu_2_0 -->
<g id="node71" class="node">
<title>ffn_gelu_2_0</title>
<ellipse fill="none" stroke="black" cx="225" cy="-5520" rx="105.5" ry="27"/>
<text text-anchor="middle" x="225" y="-5523.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="225" y="-5508.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_2_0&#45;&gt;ffn_gelu_2_0 -->
<g id="edge70" class="edge">
<title>ffn_up_2_0&#45;&gt;ffn_gelu_2_0</title>
<path fill="none" stroke="black" d="M225,-5619.98C225,-5619.98 225,-5557.36 225,-5557.36"/>
<polygon fill="black" stroke="black" points="228.5,-5557.36 225,-5547.36 221.5,-5557.36 228.5,-5557.36"/>
</g>
<!-- ffn_down_2_0 -->
<g id="node72" class="node">
<title>ffn_down_2_0</title>
<polygon fill="none" stroke="black" points="314,-5420 136,-5420 136,-5367 314,-5367 314,-5420"/>
<text text-anchor="middle" x="225" y="-5404.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="225" y="-5389.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="225" y="-5374.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_2_0&#45;&gt;ffn_down_2_0 -->
<g id="edge71" class="edge">
<title>ffn_gelu_2_0&#45;&gt;ffn_down_2_0</title>
<path fill="none" stroke="black" d="M225,-5492.86C225,-5492.86 225,-5430.16 225,-5430.16"/>
<polygon fill="black" stroke="black" points="228.5,-5430.16 225,-5420.16 221.5,-5430.16 228.5,-5430.16"/>
</g>
<!-- ffn_residual_2_0 -->
<g id="node73" class="node">
<title>ffn_residual_2_0</title>
<ellipse fill="none" stroke="black" cx="225" cy="-5267" rx="105.5" ry="27"/>
<text text-anchor="middle" x="225" y="-5270.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="225" y="-5255.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_2_0&#45;&gt;ffn_residual_2_0 -->
<g id="edge72" class="edge">
<title>ffn_down_2_0&#45;&gt;ffn_residual_2_0</title>
<path fill="none" stroke="black" d="M225,-5366.98C225,-5366.98 225,-5304.36 225,-5304.36"/>
<polygon fill="black" stroke="black" points="228.5,-5304.36 225,-5294.36 221.5,-5304.36 228.5,-5304.36"/>
</g>
<!-- qkv_proj_3_0 -->
<g id="node74" class="node">
<title>qkv_proj_3_0</title>
<polygon fill="none" stroke="black" points="307.5,-5167 142.5,-5167 142.5,-5114 307.5,-5114 307.5,-5167"/>
<text text-anchor="middle" x="225" y="-5151.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="225" y="-5136.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="225" y="-5121.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_2_0&#45;&gt;qkv_proj_3_0 -->
<g id="edge73" class="edge">
<title>ffn_residual_2_0&#45;&gt;qkv_proj_3_0</title>
<path fill="none" stroke="black" d="M225,-5239.86C225,-5239.86 225,-5177.16 225,-5177.16"/>
<polygon fill="black" stroke="black" points="228.5,-5177.16 225,-5167.16 221.5,-5177.16 228.5,-5177.16"/>
</g>
<!-- qkv_reshape_3_0 -->
<g id="node75" class="node">
<title>qkv_reshape_3_0</title>
<ellipse fill="none" stroke="black" cx="225" cy="-5014" rx="148" ry="27"/>
<text text-anchor="middle" x="225" y="-5017.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="225" y="-5002.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_3_0&#45;&gt;qkv_reshape_3_0 -->
<g id="edge74" class="edge">
<title>qkv_proj_3_0&#45;&gt;qkv_reshape_3_0</title>
<path fill="none" stroke="black" d="M225,-5113.98C225,-5113.98 225,-5051.36 225,-5051.36"/>
<polygon fill="black" stroke="black" points="228.5,-5051.36 225,-5041.36 221.5,-5051.36 228.5,-5051.36"/>
</g>
<!-- ring_attn_3_0_stage_0 -->
<g id="node76" class="node">
<title>ring_attn_3_0_stage_0</title>
<polygon fill="yellow" stroke="black" points="225,-4870 16,-4802 225,-4734 434,-4802 225,-4870"/>
<text text-anchor="middle" x="225" y="-4820.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-4805.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="225" y="-4790.8" font-family="Times,serif" font-size="14.00">Q[0]×K[0]×V[0]</text>
<text text-anchor="middle" x="225" y="-4775.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- qkv_reshape_3_0&#45;&gt;ring_attn_3_0_stage_0 -->
<g id="edge75" class="edge">
<title>qkv_reshape_3_0&#45;&gt;ring_attn_3_0_stage_0</title>
<path fill="none" stroke="black" d="M225,-4986.72C225,-4986.72 225,-4880.16 225,-4880.16"/>
<polygon fill="black" stroke="black" points="228.5,-4880.16 225,-4870.16 221.5,-4880.16 228.5,-4880.16"/>
</g>
<!-- ring_attn_3_0_stage_1 -->
<g id="node77" class="node">
<title>ring_attn_3_0_stage_1</title>
<polygon fill="yellow" stroke="black" points="225,-4617 16,-4549 225,-4481 434,-4549 225,-4617"/>
<text text-anchor="middle" x="225" y="-4567.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-4552.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="225" y="-4537.8" font-family="Times,serif" font-size="14.00">Q[0]×K[15]×V[15]</text>
<text text-anchor="middle" x="225" y="-4522.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_0&#45;&gt;ring_attn_3_0_stage_1 -->
<g id="edge76" class="edge">
<title>ring_attn_3_0_stage_0&#45;&gt;ring_attn_3_0_stage_1</title>
<path fill="none" stroke="black" d="M225,-4733.87C225,-4733.87 225,-4627.25 225,-4627.25"/>
<polygon fill="black" stroke="black" points="228.5,-4627.25 225,-4617.25 221.5,-4627.25 228.5,-4627.25"/>
</g>
<!-- ring_attn_3_1_stage_0 -->
<g id="node174" class="node">
<title>ring_attn_3_1_stage_0</title>
<polygon fill="yellow" stroke="black" points="812,-4870 603,-4802 812,-4734 1021,-4802 812,-4870"/>
<text text-anchor="middle" x="812" y="-4820.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-4805.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="812" y="-4790.8" font-family="Times,serif" font-size="14.00">Q[1]×K[1]×V[1]</text>
<text text-anchor="middle" x="812" y="-4775.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_0&#45;&gt;ring_attn_3_1_stage_0 -->
<g id="edge1601" class="edge">
<title>ring_attn_3_0_stage_0&#45;&gt;ring_attn_3_1_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-4802C434.02,-4802 592.86,-4802 592.86,-4802"/>
<polygon fill="red" stroke="red" points="592.86,-4805.5 602.86,-4802 592.86,-4798.5 592.86,-4805.5"/>
</g>
<!-- ring_attn_3_0_stage_2 -->
<g id="node78" class="node">
<title>ring_attn_3_0_stage_2</title>
<polygon fill="yellow" stroke="black" points="225,-4364 16,-4296 225,-4228 434,-4296 225,-4364"/>
<text text-anchor="middle" x="225" y="-4314.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-4299.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="225" y="-4284.8" font-family="Times,serif" font-size="14.00">Q[0]×K[14]×V[14]</text>
<text text-anchor="middle" x="225" y="-4269.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_1&#45;&gt;ring_attn_3_0_stage_2 -->
<g id="edge77" class="edge">
<title>ring_attn_3_0_stage_1&#45;&gt;ring_attn_3_0_stage_2</title>
<path fill="none" stroke="black" d="M120.5,-4514.88C120.5,-4514.88 120.5,-4340.39 120.5,-4340.39"/>
<polygon fill="black" stroke="black" points="124,-4340.39 120.5,-4330.39 117,-4340.39 124,-4340.39"/>
</g>
<!-- ring_attn_3_1_stage_1 -->
<g id="node175" class="node">
<title>ring_attn_3_1_stage_1</title>
<polygon fill="yellow" stroke="black" points="812,-4617 603,-4549 812,-4481 1021,-4549 812,-4617"/>
<text text-anchor="middle" x="812" y="-4567.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-4552.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="812" y="-4537.8" font-family="Times,serif" font-size="14.00">Q[1]×K[0]×V[0]</text>
<text text-anchor="middle" x="812" y="-4522.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_1&#45;&gt;ring_attn_3_1_stage_1 -->
<g id="edge1602" class="edge">
<title>ring_attn_3_0_stage_1&#45;&gt;ring_attn_3_1_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-4549C434.02,-4549 592.86,-4549 592.86,-4549"/>
<polygon fill="red" stroke="red" points="592.86,-4552.5 602.86,-4549 592.86,-4545.5 592.86,-4552.5"/>
</g>
<!-- ring_attn_3_0_stage_3 -->
<g id="node79" class="node">
<title>ring_attn_3_0_stage_3</title>
<polygon fill="yellow" stroke="black" points="225,-4111 16,-4043 225,-3975 434,-4043 225,-4111"/>
<text text-anchor="middle" x="225" y="-4061.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-4046.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="225" y="-4031.8" font-family="Times,serif" font-size="14.00">Q[0]×K[13]×V[13]</text>
<text text-anchor="middle" x="225" y="-4016.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_2&#45;&gt;ring_attn_3_0_stage_3 -->
<g id="edge78" class="edge">
<title>ring_attn_3_0_stage_2&#45;&gt;ring_attn_3_0_stage_3</title>
<path fill="none" stroke="black" d="M155.33,-4250.48C155.33,-4250.48 155.33,-4098.58 155.33,-4098.58"/>
<polygon fill="black" stroke="black" points="158.83,-4098.58 155.33,-4088.58 151.83,-4098.58 158.83,-4098.58"/>
</g>
<!-- ring_attn_3_1_stage_2 -->
<g id="node176" class="node">
<title>ring_attn_3_1_stage_2</title>
<polygon fill="yellow" stroke="black" points="812,-4364 603,-4296 812,-4228 1021,-4296 812,-4364"/>
<text text-anchor="middle" x="812" y="-4314.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-4299.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="812" y="-4284.8" font-family="Times,serif" font-size="14.00">Q[1]×K[15]×V[15]</text>
<text text-anchor="middle" x="812" y="-4269.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_2&#45;&gt;ring_attn_3_1_stage_2 -->
<g id="edge1603" class="edge">
<title>ring_attn_3_0_stage_2&#45;&gt;ring_attn_3_1_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-4296C434.02,-4296 592.86,-4296 592.86,-4296"/>
<polygon fill="red" stroke="red" points="592.86,-4299.5 602.86,-4296 592.86,-4292.5 592.86,-4299.5"/>
</g>
<!-- ring_attn_3_0_stage_4 -->
<g id="node80" class="node">
<title>ring_attn_3_0_stage_4</title>
<polygon fill="yellow" stroke="black" points="225,-3858 16,-3790 225,-3722 434,-3790 225,-3858"/>
<text text-anchor="middle" x="225" y="-3808.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-3793.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="225" y="-3778.8" font-family="Times,serif" font-size="14.00">Q[0]×K[12]×V[12]</text>
<text text-anchor="middle" x="225" y="-3763.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_3&#45;&gt;ring_attn_3_0_stage_4 -->
<g id="edge79" class="edge">
<title>ring_attn_3_0_stage_3&#45;&gt;ring_attn_3_0_stage_4</title>
<path fill="none" stroke="black" d="M155.33,-3997.48C155.33,-3997.48 155.33,-3845.58 155.33,-3845.58"/>
<polygon fill="black" stroke="black" points="158.83,-3845.58 155.33,-3835.58 151.83,-3845.58 158.83,-3845.58"/>
</g>
<!-- ring_attn_3_1_stage_3 -->
<g id="node177" class="node">
<title>ring_attn_3_1_stage_3</title>
<polygon fill="yellow" stroke="black" points="812,-4111 603,-4043 812,-3975 1021,-4043 812,-4111"/>
<text text-anchor="middle" x="812" y="-4061.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-4046.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="812" y="-4031.8" font-family="Times,serif" font-size="14.00">Q[1]×K[14]×V[14]</text>
<text text-anchor="middle" x="812" y="-4016.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_3&#45;&gt;ring_attn_3_1_stage_3 -->
<g id="edge1604" class="edge">
<title>ring_attn_3_0_stage_3&#45;&gt;ring_attn_3_1_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-4043C434.02,-4043 592.86,-4043 592.86,-4043"/>
<polygon fill="red" stroke="red" points="592.86,-4046.5 602.86,-4043 592.86,-4039.5 592.86,-4046.5"/>
</g>
<!-- ring_attn_3_0_stage_5 -->
<g id="node81" class="node">
<title>ring_attn_3_0_stage_5</title>
<polygon fill="yellow" stroke="black" points="225,-3605 16,-3537 225,-3469 434,-3537 225,-3605"/>
<text text-anchor="middle" x="225" y="-3555.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-3540.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="225" y="-3525.8" font-family="Times,serif" font-size="14.00">Q[0]×K[11]×V[11]</text>
<text text-anchor="middle" x="225" y="-3510.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_4&#45;&gt;ring_attn_3_0_stage_5 -->
<g id="edge80" class="edge">
<title>ring_attn_3_0_stage_4&#45;&gt;ring_attn_3_0_stage_5</title>
<path fill="none" stroke="black" d="M155.33,-3744.48C155.33,-3744.48 155.33,-3592.58 155.33,-3592.58"/>
<polygon fill="black" stroke="black" points="158.83,-3592.58 155.33,-3582.58 151.83,-3592.58 158.83,-3592.58"/>
</g>
<!-- ring_attn_3_1_stage_4 -->
<g id="node178" class="node">
<title>ring_attn_3_1_stage_4</title>
<polygon fill="yellow" stroke="black" points="812,-3858 603,-3790 812,-3722 1021,-3790 812,-3858"/>
<text text-anchor="middle" x="812" y="-3808.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-3793.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="812" y="-3778.8" font-family="Times,serif" font-size="14.00">Q[1]×K[13]×V[13]</text>
<text text-anchor="middle" x="812" y="-3763.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_4&#45;&gt;ring_attn_3_1_stage_4 -->
<g id="edge1605" class="edge">
<title>ring_attn_3_0_stage_4&#45;&gt;ring_attn_3_1_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-3790C434.02,-3790 592.86,-3790 592.86,-3790"/>
<polygon fill="red" stroke="red" points="592.86,-3793.5 602.86,-3790 592.86,-3786.5 592.86,-3793.5"/>
</g>
<!-- ring_attn_3_0_stage_6 -->
<g id="node82" class="node">
<title>ring_attn_3_0_stage_6</title>
<polygon fill="yellow" stroke="black" points="225,-3352 16,-3284 225,-3216 434,-3284 225,-3352"/>
<text text-anchor="middle" x="225" y="-3302.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-3287.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="225" y="-3272.8" font-family="Times,serif" font-size="14.00">Q[0]×K[10]×V[10]</text>
<text text-anchor="middle" x="225" y="-3257.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_5&#45;&gt;ring_attn_3_0_stage_6 -->
<g id="edge81" class="edge">
<title>ring_attn_3_0_stage_5&#45;&gt;ring_attn_3_0_stage_6</title>
<path fill="none" stroke="black" d="M155.33,-3491.48C155.33,-3491.48 155.33,-3339.58 155.33,-3339.58"/>
<polygon fill="black" stroke="black" points="158.83,-3339.58 155.33,-3329.58 151.83,-3339.58 158.83,-3339.58"/>
</g>
<!-- ring_attn_3_1_stage_5 -->
<g id="node179" class="node">
<title>ring_attn_3_1_stage_5</title>
<polygon fill="yellow" stroke="black" points="812,-3605 603,-3537 812,-3469 1021,-3537 812,-3605"/>
<text text-anchor="middle" x="812" y="-3555.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-3540.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="812" y="-3525.8" font-family="Times,serif" font-size="14.00">Q[1]×K[12]×V[12]</text>
<text text-anchor="middle" x="812" y="-3510.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_5&#45;&gt;ring_attn_3_1_stage_5 -->
<g id="edge1606" class="edge">
<title>ring_attn_3_0_stage_5&#45;&gt;ring_attn_3_1_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-3537C434.02,-3537 592.86,-3537 592.86,-3537"/>
<polygon fill="red" stroke="red" points="592.86,-3540.5 602.86,-3537 592.86,-3533.5 592.86,-3540.5"/>
</g>
<!-- ring_attn_3_0_stage_7 -->
<g id="node83" class="node">
<title>ring_attn_3_0_stage_7</title>
<polygon fill="yellow" stroke="black" points="225,-3099 16,-3031 225,-2963 434,-3031 225,-3099"/>
<text text-anchor="middle" x="225" y="-3049.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-3034.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="225" y="-3019.8" font-family="Times,serif" font-size="14.00">Q[0]×K[9]×V[9]</text>
<text text-anchor="middle" x="225" y="-3004.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_6&#45;&gt;ring_attn_3_0_stage_7 -->
<g id="edge82" class="edge">
<title>ring_attn_3_0_stage_6&#45;&gt;ring_attn_3_0_stage_7</title>
<path fill="none" stroke="black" d="M155.33,-3238.48C155.33,-3238.48 155.33,-3086.58 155.33,-3086.58"/>
<polygon fill="black" stroke="black" points="158.83,-3086.58 155.33,-3076.58 151.83,-3086.58 158.83,-3086.58"/>
</g>
<!-- ring_attn_3_1_stage_6 -->
<g id="node180" class="node">
<title>ring_attn_3_1_stage_6</title>
<polygon fill="yellow" stroke="black" points="812,-3352 603,-3284 812,-3216 1021,-3284 812,-3352"/>
<text text-anchor="middle" x="812" y="-3302.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-3287.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="812" y="-3272.8" font-family="Times,serif" font-size="14.00">Q[1]×K[11]×V[11]</text>
<text text-anchor="middle" x="812" y="-3257.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_6&#45;&gt;ring_attn_3_1_stage_6 -->
<g id="edge1607" class="edge">
<title>ring_attn_3_0_stage_6&#45;&gt;ring_attn_3_1_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-3284C434.02,-3284 592.86,-3284 592.86,-3284"/>
<polygon fill="red" stroke="red" points="592.86,-3287.5 602.86,-3284 592.86,-3280.5 592.86,-3287.5"/>
</g>
<!-- ring_attn_3_0_stage_8 -->
<g id="node84" class="node">
<title>ring_attn_3_0_stage_8</title>
<polygon fill="yellow" stroke="black" points="225,-2846 16,-2778 225,-2710 434,-2778 225,-2846"/>
<text text-anchor="middle" x="225" y="-2796.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-2781.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="225" y="-2766.8" font-family="Times,serif" font-size="14.00">Q[0]×K[8]×V[8]</text>
<text text-anchor="middle" x="225" y="-2751.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_7&#45;&gt;ring_attn_3_0_stage_8 -->
<g id="edge83" class="edge">
<title>ring_attn_3_0_stage_7&#45;&gt;ring_attn_3_0_stage_8</title>
<path fill="none" stroke="black" d="M225,-2962.87C225,-2962.87 225,-2856.25 225,-2856.25"/>
<polygon fill="black" stroke="black" points="228.5,-2856.25 225,-2846.25 221.5,-2856.25 228.5,-2856.25"/>
</g>
<!-- ring_attn_3_1_stage_7 -->
<g id="node181" class="node">
<title>ring_attn_3_1_stage_7</title>
<polygon fill="yellow" stroke="black" points="812,-3099 603,-3031 812,-2963 1021,-3031 812,-3099"/>
<text text-anchor="middle" x="812" y="-3049.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-3034.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="812" y="-3019.8" font-family="Times,serif" font-size="14.00">Q[1]×K[10]×V[10]</text>
<text text-anchor="middle" x="812" y="-3004.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_7&#45;&gt;ring_attn_3_1_stage_7 -->
<g id="edge1608" class="edge">
<title>ring_attn_3_0_stage_7&#45;&gt;ring_attn_3_1_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-3031C434.02,-3031 592.86,-3031 592.86,-3031"/>
<polygon fill="red" stroke="red" points="592.86,-3034.5 602.86,-3031 592.86,-3027.5 592.86,-3034.5"/>
</g>
<!-- ring_attn_3_0_stage_9 -->
<g id="node85" class="node">
<title>ring_attn_3_0_stage_9</title>
<polygon fill="yellow" stroke="black" points="225,-2593 16,-2525 225,-2457 434,-2525 225,-2593"/>
<text text-anchor="middle" x="225" y="-2543.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-2528.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="225" y="-2513.8" font-family="Times,serif" font-size="14.00">Q[0]×K[7]×V[7]</text>
<text text-anchor="middle" x="225" y="-2498.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_8&#45;&gt;ring_attn_3_0_stage_9 -->
<g id="edge84" class="edge">
<title>ring_attn_3_0_stage_8&#45;&gt;ring_attn_3_0_stage_9</title>
<path fill="none" stroke="black" d="M155.33,-2732.48C155.33,-2732.48 155.33,-2580.58 155.33,-2580.58"/>
<polygon fill="black" stroke="black" points="158.83,-2580.58 155.33,-2570.58 151.83,-2580.58 158.83,-2580.58"/>
</g>
<!-- ring_attn_3_1_stage_8 -->
<g id="node182" class="node">
<title>ring_attn_3_1_stage_8</title>
<polygon fill="yellow" stroke="black" points="812,-2846 603,-2778 812,-2710 1021,-2778 812,-2846"/>
<text text-anchor="middle" x="812" y="-2796.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-2781.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="812" y="-2766.8" font-family="Times,serif" font-size="14.00">Q[1]×K[9]×V[9]</text>
<text text-anchor="middle" x="812" y="-2751.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_8&#45;&gt;ring_attn_3_1_stage_8 -->
<g id="edge1609" class="edge">
<title>ring_attn_3_0_stage_8&#45;&gt;ring_attn_3_1_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-2778C434.02,-2778 592.86,-2778 592.86,-2778"/>
<polygon fill="red" stroke="red" points="592.86,-2781.5 602.86,-2778 592.86,-2774.5 592.86,-2781.5"/>
</g>
<!-- ring_attn_3_0_stage_10 -->
<g id="node86" class="node">
<title>ring_attn_3_0_stage_10</title>
<polygon fill="yellow" stroke="black" points="225,-2340 16,-2272 225,-2204 434,-2272 225,-2340"/>
<text text-anchor="middle" x="225" y="-2290.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-2275.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="225" y="-2260.8" font-family="Times,serif" font-size="14.00">Q[0]×K[6]×V[6]</text>
<text text-anchor="middle" x="225" y="-2245.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_9&#45;&gt;ring_attn_3_0_stage_10 -->
<g id="edge85" class="edge">
<title>ring_attn_3_0_stage_9&#45;&gt;ring_attn_3_0_stage_10</title>
<path fill="none" stroke="black" d="M120.5,-2490.88C120.5,-2490.88 120.5,-2316.39 120.5,-2316.39"/>
<polygon fill="black" stroke="black" points="124,-2316.39 120.5,-2306.39 117,-2316.39 124,-2316.39"/>
</g>
<!-- ring_attn_3_1_stage_9 -->
<g id="node183" class="node">
<title>ring_attn_3_1_stage_9</title>
<polygon fill="yellow" stroke="black" points="812,-2593 603,-2525 812,-2457 1021,-2525 812,-2593"/>
<text text-anchor="middle" x="812" y="-2543.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-2528.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="812" y="-2513.8" font-family="Times,serif" font-size="14.00">Q[1]×K[8]×V[8]</text>
<text text-anchor="middle" x="812" y="-2498.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_9&#45;&gt;ring_attn_3_1_stage_9 -->
<g id="edge1610" class="edge">
<title>ring_attn_3_0_stage_9&#45;&gt;ring_attn_3_1_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-2525C434.02,-2525 592.86,-2525 592.86,-2525"/>
<polygon fill="red" stroke="red" points="592.86,-2528.5 602.86,-2525 592.86,-2521.5 592.86,-2528.5"/>
</g>
<!-- ring_attn_3_0_stage_11 -->
<g id="node87" class="node">
<title>ring_attn_3_0_stage_11</title>
<polygon fill="yellow" stroke="black" points="225,-2087 16,-2019 225,-1951 434,-2019 225,-2087"/>
<text text-anchor="middle" x="225" y="-2037.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-2022.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="225" y="-2007.8" font-family="Times,serif" font-size="14.00">Q[0]×K[5]×V[5]</text>
<text text-anchor="middle" x="225" y="-1992.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_10&#45;&gt;ring_attn_3_0_stage_11 -->
<g id="edge86" class="edge">
<title>ring_attn_3_0_stage_10&#45;&gt;ring_attn_3_0_stage_11</title>
<path fill="none" stroke="black" d="M155.33,-2226.48C155.33,-2226.48 155.33,-2074.58 155.33,-2074.58"/>
<polygon fill="black" stroke="black" points="158.83,-2074.58 155.33,-2064.58 151.83,-2074.58 158.83,-2074.58"/>
</g>
<!-- ring_attn_3_1_stage_10 -->
<g id="node184" class="node">
<title>ring_attn_3_1_stage_10</title>
<polygon fill="yellow" stroke="black" points="812,-2340 603,-2272 812,-2204 1021,-2272 812,-2340"/>
<text text-anchor="middle" x="812" y="-2290.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-2275.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="812" y="-2260.8" font-family="Times,serif" font-size="14.00">Q[1]×K[7]×V[7]</text>
<text text-anchor="middle" x="812" y="-2245.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_10&#45;&gt;ring_attn_3_1_stage_10 -->
<g id="edge1611" class="edge">
<title>ring_attn_3_0_stage_10&#45;&gt;ring_attn_3_1_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-2272C434.02,-2272 592.86,-2272 592.86,-2272"/>
<polygon fill="red" stroke="red" points="592.86,-2275.5 602.86,-2272 592.86,-2268.5 592.86,-2275.5"/>
</g>
<!-- ring_attn_3_0_stage_12 -->
<g id="node88" class="node">
<title>ring_attn_3_0_stage_12</title>
<polygon fill="yellow" stroke="black" points="225,-1834 16,-1766 225,-1698 434,-1766 225,-1834"/>
<text text-anchor="middle" x="225" y="-1784.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-1769.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="225" y="-1754.8" font-family="Times,serif" font-size="14.00">Q[0]×K[4]×V[4]</text>
<text text-anchor="middle" x="225" y="-1739.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_11&#45;&gt;ring_attn_3_0_stage_12 -->
<g id="edge87" class="edge">
<title>ring_attn_3_0_stage_11&#45;&gt;ring_attn_3_0_stage_12</title>
<path fill="none" stroke="black" d="M225,-1950.87C225,-1950.87 225,-1844.25 225,-1844.25"/>
<polygon fill="black" stroke="black" points="228.5,-1844.25 225,-1834.25 221.5,-1844.25 228.5,-1844.25"/>
</g>
<!-- ring_attn_3_1_stage_11 -->
<g id="node185" class="node">
<title>ring_attn_3_1_stage_11</title>
<polygon fill="yellow" stroke="black" points="812,-2087 603,-2019 812,-1951 1021,-2019 812,-2087"/>
<text text-anchor="middle" x="812" y="-2037.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-2022.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="812" y="-2007.8" font-family="Times,serif" font-size="14.00">Q[1]×K[6]×V[6]</text>
<text text-anchor="middle" x="812" y="-1992.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_11&#45;&gt;ring_attn_3_1_stage_11 -->
<g id="edge1612" class="edge">
<title>ring_attn_3_0_stage_11&#45;&gt;ring_attn_3_1_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-2019C434.02,-2019 592.86,-2019 592.86,-2019"/>
<polygon fill="red" stroke="red" points="592.86,-2022.5 602.86,-2019 592.86,-2015.5 592.86,-2022.5"/>
</g>
<!-- ring_attn_3_0_stage_13 -->
<g id="node89" class="node">
<title>ring_attn_3_0_stage_13</title>
<polygon fill="yellow" stroke="black" points="225,-1581 16,-1513 225,-1445 434,-1513 225,-1581"/>
<text text-anchor="middle" x="225" y="-1531.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-1516.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="225" y="-1501.8" font-family="Times,serif" font-size="14.00">Q[0]×K[3]×V[3]</text>
<text text-anchor="middle" x="225" y="-1486.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_12&#45;&gt;ring_attn_3_0_stage_13 -->
<g id="edge88" class="edge">
<title>ring_attn_3_0_stage_12&#45;&gt;ring_attn_3_0_stage_13</title>
<path fill="none" stroke="black" d="M155.33,-1720.48C155.33,-1720.48 155.33,-1568.58 155.33,-1568.58"/>
<polygon fill="black" stroke="black" points="158.83,-1568.58 155.33,-1558.58 151.83,-1568.58 158.83,-1568.58"/>
</g>
<!-- ring_attn_3_1_stage_12 -->
<g id="node186" class="node">
<title>ring_attn_3_1_stage_12</title>
<polygon fill="yellow" stroke="black" points="812,-1834 603,-1766 812,-1698 1021,-1766 812,-1834"/>
<text text-anchor="middle" x="812" y="-1784.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-1769.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="812" y="-1754.8" font-family="Times,serif" font-size="14.00">Q[1]×K[5]×V[5]</text>
<text text-anchor="middle" x="812" y="-1739.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_12&#45;&gt;ring_attn_3_1_stage_12 -->
<g id="edge1613" class="edge">
<title>ring_attn_3_0_stage_12&#45;&gt;ring_attn_3_1_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-1766C434.02,-1766 592.86,-1766 592.86,-1766"/>
<polygon fill="red" stroke="red" points="592.86,-1769.5 602.86,-1766 592.86,-1762.5 592.86,-1769.5"/>
</g>
<!-- ring_attn_3_0_stage_14 -->
<g id="node90" class="node">
<title>ring_attn_3_0_stage_14</title>
<polygon fill="yellow" stroke="black" points="225,-1328 16,-1260 225,-1192 434,-1260 225,-1328"/>
<text text-anchor="middle" x="225" y="-1278.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-1263.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="225" y="-1248.8" font-family="Times,serif" font-size="14.00">Q[0]×K[2]×V[2]</text>
<text text-anchor="middle" x="225" y="-1233.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_13&#45;&gt;ring_attn_3_0_stage_14 -->
<g id="edge89" class="edge">
<title>ring_attn_3_0_stage_13&#45;&gt;ring_attn_3_0_stage_14</title>
<path fill="none" stroke="black" d="M155.33,-1467.48C155.33,-1467.48 155.33,-1315.58 155.33,-1315.58"/>
<polygon fill="black" stroke="black" points="158.83,-1315.58 155.33,-1305.58 151.83,-1315.58 158.83,-1315.58"/>
</g>
<!-- ring_attn_3_1_stage_13 -->
<g id="node187" class="node">
<title>ring_attn_3_1_stage_13</title>
<polygon fill="yellow" stroke="black" points="812,-1581 603,-1513 812,-1445 1021,-1513 812,-1581"/>
<text text-anchor="middle" x="812" y="-1531.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-1516.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="812" y="-1501.8" font-family="Times,serif" font-size="14.00">Q[1]×K[4]×V[4]</text>
<text text-anchor="middle" x="812" y="-1486.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_13&#45;&gt;ring_attn_3_1_stage_13 -->
<g id="edge1614" class="edge">
<title>ring_attn_3_0_stage_13&#45;&gt;ring_attn_3_1_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-1513C434.02,-1513 592.86,-1513 592.86,-1513"/>
<polygon fill="red" stroke="red" points="592.86,-1516.5 602.86,-1513 592.86,-1509.5 592.86,-1516.5"/>
</g>
<!-- ring_attn_3_0_stage_15 -->
<g id="node91" class="node">
<title>ring_attn_3_0_stage_15</title>
<polygon fill="yellow" stroke="black" points="225,-1075 16,-1007 225,-939 434,-1007 225,-1075"/>
<text text-anchor="middle" x="225" y="-1025.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="225" y="-1010.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="225" y="-995.8" font-family="Times,serif" font-size="14.00">Q[0]×K[1]×V[1]</text>
<text text-anchor="middle" x="225" y="-980.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_14&#45;&gt;ring_attn_3_0_stage_15 -->
<g id="edge90" class="edge">
<title>ring_attn_3_0_stage_14&#45;&gt;ring_attn_3_0_stage_15</title>
<path fill="none" stroke="black" d="M155.33,-1214.48C155.33,-1214.48 155.33,-1062.58 155.33,-1062.58"/>
<polygon fill="black" stroke="black" points="158.83,-1062.58 155.33,-1052.58 151.83,-1062.58 158.83,-1062.58"/>
</g>
<!-- ring_attn_3_1_stage_14 -->
<g id="node188" class="node">
<title>ring_attn_3_1_stage_14</title>
<polygon fill="yellow" stroke="black" points="812,-1328 603,-1260 812,-1192 1021,-1260 812,-1328"/>
<text text-anchor="middle" x="812" y="-1278.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-1263.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="812" y="-1248.8" font-family="Times,serif" font-size="14.00">Q[1]×K[3]×V[3]</text>
<text text-anchor="middle" x="812" y="-1233.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_14&#45;&gt;ring_attn_3_1_stage_14 -->
<g id="edge1615" class="edge">
<title>ring_attn_3_0_stage_14&#45;&gt;ring_attn_3_1_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-1260C434.02,-1260 592.86,-1260 592.86,-1260"/>
<polygon fill="red" stroke="red" points="592.86,-1263.5 602.86,-1260 592.86,-1256.5 592.86,-1263.5"/>
</g>
<!-- attn_out_3_0 -->
<g id="node92" class="node">
<title>attn_out_3_0</title>
<polygon fill="none" stroke="black" points="294.5,-866 155.5,-866 155.5,-813 294.5,-813 294.5,-866"/>
<text text-anchor="middle" x="225" y="-850.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="225" y="-835.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="225" y="-820.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_3_0_stage_15&#45;&gt;attn_out_3_0 -->
<g id="edge91" class="edge">
<title>ring_attn_3_0_stage_15&#45;&gt;attn_out_3_0</title>
<path fill="none" stroke="black" d="M225,-938.87C225,-938.87 225,-876.18 225,-876.18"/>
<polygon fill="black" stroke="black" points="228.5,-876.18 225,-866.18 221.5,-876.18 228.5,-876.18"/>
</g>
<!-- ring_attn_3_1_stage_15 -->
<g id="node189" class="node">
<title>ring_attn_3_1_stage_15</title>
<polygon fill="yellow" stroke="black" points="812,-1075 603,-1007 812,-939 1021,-1007 812,-1075"/>
<text text-anchor="middle" x="812" y="-1025.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="812" y="-1010.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="812" y="-995.8" font-family="Times,serif" font-size="14.00">Q[1]×K[2]×V[2]</text>
<text text-anchor="middle" x="812" y="-980.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_0_stage_15&#45;&gt;ring_attn_3_1_stage_15 -->
<g id="edge1616" class="edge">
<title>ring_attn_3_0_stage_15&#45;&gt;ring_attn_3_1_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.02,-1007C434.02,-1007 592.86,-1007 592.86,-1007"/>
<polygon fill="red" stroke="red" points="592.86,-1010.5 602.86,-1007 592.86,-1003.5 592.86,-1010.5"/>
</g>
<!-- attn_residual_3_0 -->
<g id="node93" class="node">
<title>attn_residual_3_0</title>
<ellipse fill="none" stroke="black" cx="225" cy="-713" rx="105.5" ry="27"/>
<text text-anchor="middle" x="225" y="-716.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="225" y="-701.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_3_0&#45;&gt;attn_residual_3_0 -->
<g id="edge92" class="edge">
<title>attn_out_3_0&#45;&gt;attn_residual_3_0</title>
<path fill="none" stroke="black" d="M225,-812.98C225,-812.98 225,-750.36 225,-750.36"/>
<polygon fill="black" stroke="black" points="228.5,-750.36 225,-740.36 221.5,-750.36 228.5,-750.36"/>
</g>
<!-- ffn_up_3_0 -->
<g id="node94" class="node">
<title>ffn_up_3_0</title>
<polygon fill="none" stroke="black" points="304,-613 146,-613 146,-560 304,-560 304,-613"/>
<text text-anchor="middle" x="225" y="-597.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="225" y="-582.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="225" y="-567.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_3_0&#45;&gt;ffn_up_3_0 -->
<g id="edge93" class="edge">
<title>attn_residual_3_0&#45;&gt;ffn_up_3_0</title>
<path fill="none" stroke="black" d="M225,-685.86C225,-685.86 225,-623.16 225,-623.16"/>
<polygon fill="black" stroke="black" points="228.5,-623.16 225,-613.16 221.5,-623.16 228.5,-623.16"/>
</g>
<!-- ffn_gelu_3_0 -->
<g id="node95" class="node">
<title>ffn_gelu_3_0</title>
<ellipse fill="none" stroke="black" cx="225" cy="-460" rx="105.5" ry="27"/>
<text text-anchor="middle" x="225" y="-463.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="225" y="-448.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_3_0&#45;&gt;ffn_gelu_3_0 -->
<g id="edge94" class="edge">
<title>ffn_up_3_0&#45;&gt;ffn_gelu_3_0</title>
<path fill="none" stroke="black" d="M225,-559.98C225,-559.98 225,-497.36 225,-497.36"/>
<polygon fill="black" stroke="black" points="228.5,-497.36 225,-487.36 221.5,-497.36 228.5,-497.36"/>
</g>
<!-- ffn_down_3_0 -->
<g id="node96" class="node">
<title>ffn_down_3_0</title>
<polygon fill="none" stroke="black" points="314,-360 136,-360 136,-307 314,-307 314,-360"/>
<text text-anchor="middle" x="225" y="-344.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="225" y="-329.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="225" y="-314.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_3_0&#45;&gt;ffn_down_3_0 -->
<g id="edge95" class="edge">
<title>ffn_gelu_3_0&#45;&gt;ffn_down_3_0</title>
<path fill="none" stroke="black" d="M225,-432.86C225,-432.86 225,-370.16 225,-370.16"/>
<polygon fill="black" stroke="black" points="228.5,-370.16 225,-360.16 221.5,-370.16 228.5,-370.16"/>
</g>
<!-- ffn_residual_3_0 -->
<g id="node97" class="node">
<title>ffn_residual_3_0</title>
<ellipse fill="none" stroke="black" cx="225" cy="-207" rx="105.5" ry="27"/>
<text text-anchor="middle" x="225" y="-210.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="225" y="-195.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_3_0&#45;&gt;ffn_residual_3_0 -->
<g id="edge96" class="edge">
<title>ffn_down_3_0&#45;&gt;ffn_residual_3_0</title>
<path fill="none" stroke="black" d="M225,-306.98C225,-306.98 225,-244.36 225,-244.36"/>
<polygon fill="black" stroke="black" points="228.5,-244.36 225,-234.36 221.5,-244.36 228.5,-244.36"/>
</g>
<!-- output_0 -->
<g id="node98" class="node">
<title>output_0</title>
<polygon fill="lightcoral" stroke="black" points="318,-107 132,-107 132,-69 318,-69 318,-107"/>
<text text-anchor="middle" x="225" y="-91.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="225" y="-76.8" font-family="Times,serif" font-size="14.00">Y[0]: 1024×1024×4096</text>
</g>
<!-- ffn_residual_3_0&#45;&gt;output_0 -->
<g id="edge97" class="edge">
<title>ffn_residual_3_0&#45;&gt;output_0</title>
<path fill="none" stroke="black" d="M225,-180C225,-180 225,-117.12 225,-117.12"/>
<polygon fill="black" stroke="black" points="228.5,-117.12 225,-107.12 221.5,-117.12 228.5,-117.12"/>
</g>
<!-- input_1 -->
<g id="node99" class="node">
<title>input_1</title>
<polygon fill="lightgreen" stroke="black" points="905.5,-20458 718.5,-20458 718.5,-20420 905.5,-20420 905.5,-20458"/>
<text text-anchor="middle" x="812" y="-20442.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="812" y="-20427.8" font-family="Times,serif" font-size="14.00">X[1]: 1024×1024×4096</text>
</g>
<!-- qkv_proj_0_1 -->
<g id="node100" class="node">
<title>qkv_proj_0_1</title>
<polygon fill="none" stroke="black" points="894.5,-20347 729.5,-20347 729.5,-20294 894.5,-20294 894.5,-20347"/>
<text text-anchor="middle" x="812" y="-20331.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="812" y="-20316.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="812" y="-20301.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- input_1&#45;&gt;qkv_proj_0_1 -->
<g id="edge98" class="edge">
<title>input_1&#45;&gt;qkv_proj_0_1</title>
<path fill="none" stroke="black" d="M812,-20419.96C812,-20419.96 812,-20357.44 812,-20357.44"/>
<polygon fill="black" stroke="black" points="815.5,-20357.44 812,-20347.44 808.5,-20357.44 815.5,-20357.44"/>
</g>
<!-- qkv_reshape_0_1 -->
<g id="node101" class="node">
<title>qkv_reshape_0_1</title>
<ellipse fill="none" stroke="black" cx="812" cy="-20194" rx="148" ry="27"/>
<text text-anchor="middle" x="812" y="-20197.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="812" y="-20182.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_0_1&#45;&gt;qkv_reshape_0_1 -->
<g id="edge99" class="edge">
<title>qkv_proj_0_1&#45;&gt;qkv_reshape_0_1</title>
<path fill="none" stroke="black" d="M812,-20293.98C812,-20293.98 812,-20231.36 812,-20231.36"/>
<polygon fill="black" stroke="black" points="815.5,-20231.36 812,-20221.36 808.5,-20231.36 815.5,-20231.36"/>
</g>
<!-- qkv_reshape_0_1&#45;&gt;ring_attn_0_1_stage_0 -->
<g id="edge100" class="edge">
<title>qkv_reshape_0_1&#45;&gt;ring_attn_0_1_stage_0</title>
<path fill="none" stroke="black" d="M812,-20166.72C812,-20166.72 812,-20060.16 812,-20060.16"/>
<polygon fill="black" stroke="black" points="815.5,-20060.16 812,-20050.16 808.5,-20060.16 815.5,-20060.16"/>
</g>
<!-- ring_attn_0_1_stage_0&#45;&gt;ring_attn_0_1_stage_1 -->
<g id="edge101" class="edge">
<title>ring_attn_0_1_stage_0&#45;&gt;ring_attn_0_1_stage_1</title>
<path fill="none" stroke="black" d="M812,-19913.87C812,-19913.87 812,-19807.25 812,-19807.25"/>
<polygon fill="black" stroke="black" points="815.5,-19807.25 812,-19797.25 808.5,-19807.25 815.5,-19807.25"/>
</g>
<!-- ring_attn_0_2_stage_0 -->
<g id="node200" class="node">
<title>ring_attn_0_2_stage_0</title>
<polygon fill="yellow" stroke="black" points="1399,-20050 1190,-19982 1399,-19914 1608,-19982 1399,-20050"/>
<text text-anchor="middle" x="1399" y="-20000.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-19985.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="1399" y="-19970.8" font-family="Times,serif" font-size="14.00">Q[2]×K[2]×V[2]</text>
<text text-anchor="middle" x="1399" y="-19955.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_1_stage_0&#45;&gt;ring_attn_0_2_stage_0 -->
<g id="edge1617" class="edge">
<title>ring_attn_0_1_stage_0&#45;&gt;ring_attn_0_2_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-19982C1021.02,-19982 1179.86,-19982 1179.86,-19982"/>
<polygon fill="red" stroke="red" points="1179.86,-19985.5 1189.86,-19982 1179.86,-19978.5 1179.86,-19985.5"/>
</g>
<!-- ring_attn_0_1_stage_1&#45;&gt;ring_attn_0_1_stage_2 -->
<g id="edge102" class="edge">
<title>ring_attn_0_1_stage_1&#45;&gt;ring_attn_0_1_stage_2</title>
<path fill="none" stroke="black" d="M812,-19660.87C812,-19660.87 812,-19554.25 812,-19554.25"/>
<polygon fill="black" stroke="black" points="815.5,-19554.25 812,-19544.25 808.5,-19554.25 815.5,-19554.25"/>
</g>
<!-- ring_attn_0_2_stage_1 -->
<g id="node201" class="node">
<title>ring_attn_0_2_stage_1</title>
<polygon fill="yellow" stroke="black" points="1399,-19797 1190,-19729 1399,-19661 1608,-19729 1399,-19797"/>
<text text-anchor="middle" x="1399" y="-19747.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-19732.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="1399" y="-19717.8" font-family="Times,serif" font-size="14.00">Q[2]×K[1]×V[1]</text>
<text text-anchor="middle" x="1399" y="-19702.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_1_stage_1&#45;&gt;ring_attn_0_2_stage_1 -->
<g id="edge1618" class="edge">
<title>ring_attn_0_1_stage_1&#45;&gt;ring_attn_0_2_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-19729C1021.02,-19729 1179.86,-19729 1179.86,-19729"/>
<polygon fill="red" stroke="red" points="1179.86,-19732.5 1189.86,-19729 1179.86,-19725.5 1179.86,-19732.5"/>
</g>
<!-- ring_attn_0_1_stage_2&#45;&gt;ring_attn_0_1_stage_3 -->
<g id="edge103" class="edge">
<title>ring_attn_0_1_stage_2&#45;&gt;ring_attn_0_1_stage_3</title>
<path fill="none" stroke="black" d="M812,-19407.87C812,-19407.87 812,-19301.25 812,-19301.25"/>
<polygon fill="black" stroke="black" points="815.5,-19301.25 812,-19291.25 808.5,-19301.25 815.5,-19301.25"/>
</g>
<!-- ring_attn_0_2_stage_2 -->
<g id="node202" class="node">
<title>ring_attn_0_2_stage_2</title>
<polygon fill="yellow" stroke="black" points="1399,-19544 1190,-19476 1399,-19408 1608,-19476 1399,-19544"/>
<text text-anchor="middle" x="1399" y="-19494.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-19479.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="1399" y="-19464.8" font-family="Times,serif" font-size="14.00">Q[2]×K[0]×V[0]</text>
<text text-anchor="middle" x="1399" y="-19449.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_1_stage_2&#45;&gt;ring_attn_0_2_stage_2 -->
<g id="edge1619" class="edge">
<title>ring_attn_0_1_stage_2&#45;&gt;ring_attn_0_2_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-19476C1021.02,-19476 1179.86,-19476 1179.86,-19476"/>
<polygon fill="red" stroke="red" points="1179.86,-19479.5 1189.86,-19476 1179.86,-19472.5 1179.86,-19479.5"/>
</g>
<!-- ring_attn_0_1_stage_3&#45;&gt;ring_attn_0_1_stage_4 -->
<g id="edge104" class="edge">
<title>ring_attn_0_1_stage_3&#45;&gt;ring_attn_0_1_stage_4</title>
<path fill="none" stroke="black" d="M812,-19154.87C812,-19154.87 812,-19048.25 812,-19048.25"/>
<polygon fill="black" stroke="black" points="815.5,-19048.25 812,-19038.25 808.5,-19048.25 815.5,-19048.25"/>
</g>
<!-- ring_attn_0_2_stage_3 -->
<g id="node203" class="node">
<title>ring_attn_0_2_stage_3</title>
<polygon fill="yellow" stroke="black" points="1399,-19291 1190,-19223 1399,-19155 1608,-19223 1399,-19291"/>
<text text-anchor="middle" x="1399" y="-19241.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-19226.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="1399" y="-19211.8" font-family="Times,serif" font-size="14.00">Q[2]×K[15]×V[15]</text>
<text text-anchor="middle" x="1399" y="-19196.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_1_stage_3&#45;&gt;ring_attn_0_2_stage_3 -->
<g id="edge1620" class="edge">
<title>ring_attn_0_1_stage_3&#45;&gt;ring_attn_0_2_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-19223C1021.02,-19223 1179.86,-19223 1179.86,-19223"/>
<polygon fill="red" stroke="red" points="1179.86,-19226.5 1189.86,-19223 1179.86,-19219.5 1179.86,-19226.5"/>
</g>
<!-- ring_attn_0_1_stage_4&#45;&gt;ring_attn_0_1_stage_5 -->
<g id="edge105" class="edge">
<title>ring_attn_0_1_stage_4&#45;&gt;ring_attn_0_1_stage_5</title>
<path fill="none" stroke="black" d="M812,-18901.87C812,-18901.87 812,-18795.25 812,-18795.25"/>
<polygon fill="black" stroke="black" points="815.5,-18795.25 812,-18785.25 808.5,-18795.25 815.5,-18795.25"/>
</g>
<!-- ring_attn_0_2_stage_4 -->
<g id="node204" class="node">
<title>ring_attn_0_2_stage_4</title>
<polygon fill="yellow" stroke="black" points="1399,-19038 1190,-18970 1399,-18902 1608,-18970 1399,-19038"/>
<text text-anchor="middle" x="1399" y="-18988.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-18973.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="1399" y="-18958.8" font-family="Times,serif" font-size="14.00">Q[2]×K[14]×V[14]</text>
<text text-anchor="middle" x="1399" y="-18943.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_1_stage_4&#45;&gt;ring_attn_0_2_stage_4 -->
<g id="edge1621" class="edge">
<title>ring_attn_0_1_stage_4&#45;&gt;ring_attn_0_2_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-18970C1021.02,-18970 1179.86,-18970 1179.86,-18970"/>
<polygon fill="red" stroke="red" points="1179.86,-18973.5 1189.86,-18970 1179.86,-18966.5 1179.86,-18973.5"/>
</g>
<!-- ring_attn_0_1_stage_5&#45;&gt;ring_attn_0_1_stage_6 -->
<g id="edge106" class="edge">
<title>ring_attn_0_1_stage_5&#45;&gt;ring_attn_0_1_stage_6</title>
<path fill="none" stroke="black" d="M812,-18648.87C812,-18648.87 812,-18542.25 812,-18542.25"/>
<polygon fill="black" stroke="black" points="815.5,-18542.25 812,-18532.25 808.5,-18542.25 815.5,-18542.25"/>
</g>
<!-- ring_attn_0_2_stage_5 -->
<g id="node205" class="node">
<title>ring_attn_0_2_stage_5</title>
<polygon fill="yellow" stroke="black" points="1399,-18785 1190,-18717 1399,-18649 1608,-18717 1399,-18785"/>
<text text-anchor="middle" x="1399" y="-18735.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-18720.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="1399" y="-18705.8" font-family="Times,serif" font-size="14.00">Q[2]×K[13]×V[13]</text>
<text text-anchor="middle" x="1399" y="-18690.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_1_stage_5&#45;&gt;ring_attn_0_2_stage_5 -->
<g id="edge1622" class="edge">
<title>ring_attn_0_1_stage_5&#45;&gt;ring_attn_0_2_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-18717C1021.02,-18717 1179.86,-18717 1179.86,-18717"/>
<polygon fill="red" stroke="red" points="1179.86,-18720.5 1189.86,-18717 1179.86,-18713.5 1179.86,-18720.5"/>
</g>
<!-- ring_attn_0_1_stage_6&#45;&gt;ring_attn_0_1_stage_7 -->
<g id="edge107" class="edge">
<title>ring_attn_0_1_stage_6&#45;&gt;ring_attn_0_1_stage_7</title>
<path fill="none" stroke="black" d="M812,-18395.87C812,-18395.87 812,-18289.25 812,-18289.25"/>
<polygon fill="black" stroke="black" points="815.5,-18289.25 812,-18279.25 808.5,-18289.25 815.5,-18289.25"/>
</g>
<!-- ring_attn_0_2_stage_6 -->
<g id="node206" class="node">
<title>ring_attn_0_2_stage_6</title>
<polygon fill="yellow" stroke="black" points="1399,-18532 1190,-18464 1399,-18396 1608,-18464 1399,-18532"/>
<text text-anchor="middle" x="1399" y="-18482.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-18467.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="1399" y="-18452.8" font-family="Times,serif" font-size="14.00">Q[2]×K[12]×V[12]</text>
<text text-anchor="middle" x="1399" y="-18437.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_1_stage_6&#45;&gt;ring_attn_0_2_stage_6 -->
<g id="edge1623" class="edge">
<title>ring_attn_0_1_stage_6&#45;&gt;ring_attn_0_2_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-18464C1021.02,-18464 1179.86,-18464 1179.86,-18464"/>
<polygon fill="red" stroke="red" points="1179.86,-18467.5 1189.86,-18464 1179.86,-18460.5 1179.86,-18467.5"/>
</g>
<!-- ring_attn_0_1_stage_7&#45;&gt;ring_attn_0_1_stage_8 -->
<g id="edge108" class="edge">
<title>ring_attn_0_1_stage_7&#45;&gt;ring_attn_0_1_stage_8</title>
<path fill="none" stroke="black" d="M812,-18142.87C812,-18142.87 812,-18036.25 812,-18036.25"/>
<polygon fill="black" stroke="black" points="815.5,-18036.25 812,-18026.25 808.5,-18036.25 815.5,-18036.25"/>
</g>
<!-- ring_attn_0_2_stage_7 -->
<g id="node207" class="node">
<title>ring_attn_0_2_stage_7</title>
<polygon fill="yellow" stroke="black" points="1399,-18279 1190,-18211 1399,-18143 1608,-18211 1399,-18279"/>
<text text-anchor="middle" x="1399" y="-18229.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-18214.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="1399" y="-18199.8" font-family="Times,serif" font-size="14.00">Q[2]×K[11]×V[11]</text>
<text text-anchor="middle" x="1399" y="-18184.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_1_stage_7&#45;&gt;ring_attn_0_2_stage_7 -->
<g id="edge1624" class="edge">
<title>ring_attn_0_1_stage_7&#45;&gt;ring_attn_0_2_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-18211C1021.02,-18211 1179.86,-18211 1179.86,-18211"/>
<polygon fill="red" stroke="red" points="1179.86,-18214.5 1189.86,-18211 1179.86,-18207.5 1179.86,-18214.5"/>
</g>
<!-- ring_attn_0_1_stage_8&#45;&gt;ring_attn_0_1_stage_9 -->
<g id="edge109" class="edge">
<title>ring_attn_0_1_stage_8&#45;&gt;ring_attn_0_1_stage_9</title>
<path fill="none" stroke="black" d="M812,-17889.87C812,-17889.87 812,-17783.25 812,-17783.25"/>
<polygon fill="black" stroke="black" points="815.5,-17783.25 812,-17773.25 808.5,-17783.25 815.5,-17783.25"/>
</g>
<!-- ring_attn_0_2_stage_8 -->
<g id="node208" class="node">
<title>ring_attn_0_2_stage_8</title>
<polygon fill="yellow" stroke="black" points="1399,-18026 1190,-17958 1399,-17890 1608,-17958 1399,-18026"/>
<text text-anchor="middle" x="1399" y="-17976.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-17961.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="1399" y="-17946.8" font-family="Times,serif" font-size="14.00">Q[2]×K[10]×V[10]</text>
<text text-anchor="middle" x="1399" y="-17931.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_1_stage_8&#45;&gt;ring_attn_0_2_stage_8 -->
<g id="edge1625" class="edge">
<title>ring_attn_0_1_stage_8&#45;&gt;ring_attn_0_2_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-17958C1021.02,-17958 1179.86,-17958 1179.86,-17958"/>
<polygon fill="red" stroke="red" points="1179.86,-17961.5 1189.86,-17958 1179.86,-17954.5 1179.86,-17961.5"/>
</g>
<!-- ring_attn_0_1_stage_9&#45;&gt;ring_attn_0_1_stage_10 -->
<g id="edge110" class="edge">
<title>ring_attn_0_1_stage_9&#45;&gt;ring_attn_0_1_stage_10</title>
<path fill="none" stroke="black" d="M812,-17636.87C812,-17636.87 812,-17530.25 812,-17530.25"/>
<polygon fill="black" stroke="black" points="815.5,-17530.25 812,-17520.25 808.5,-17530.25 815.5,-17530.25"/>
</g>
<!-- ring_attn_0_2_stage_9 -->
<g id="node209" class="node">
<title>ring_attn_0_2_stage_9</title>
<polygon fill="yellow" stroke="black" points="1399,-17773 1190,-17705 1399,-17637 1608,-17705 1399,-17773"/>
<text text-anchor="middle" x="1399" y="-17723.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-17708.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="1399" y="-17693.8" font-family="Times,serif" font-size="14.00">Q[2]×K[9]×V[9]</text>
<text text-anchor="middle" x="1399" y="-17678.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_1_stage_9&#45;&gt;ring_attn_0_2_stage_9 -->
<g id="edge1626" class="edge">
<title>ring_attn_0_1_stage_9&#45;&gt;ring_attn_0_2_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-17705C1021.02,-17705 1179.86,-17705 1179.86,-17705"/>
<polygon fill="red" stroke="red" points="1179.86,-17708.5 1189.86,-17705 1179.86,-17701.5 1179.86,-17708.5"/>
</g>
<!-- ring_attn_0_1_stage_10&#45;&gt;ring_attn_0_1_stage_11 -->
<g id="edge111" class="edge">
<title>ring_attn_0_1_stage_10&#45;&gt;ring_attn_0_1_stage_11</title>
<path fill="none" stroke="black" d="M812,-17383.87C812,-17383.87 812,-17277.25 812,-17277.25"/>
<polygon fill="black" stroke="black" points="815.5,-17277.25 812,-17267.25 808.5,-17277.25 815.5,-17277.25"/>
</g>
<!-- ring_attn_0_2_stage_10 -->
<g id="node210" class="node">
<title>ring_attn_0_2_stage_10</title>
<polygon fill="yellow" stroke="black" points="1399,-17520 1190,-17452 1399,-17384 1608,-17452 1399,-17520"/>
<text text-anchor="middle" x="1399" y="-17470.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-17455.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="1399" y="-17440.8" font-family="Times,serif" font-size="14.00">Q[2]×K[8]×V[8]</text>
<text text-anchor="middle" x="1399" y="-17425.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_1_stage_10&#45;&gt;ring_attn_0_2_stage_10 -->
<g id="edge1627" class="edge">
<title>ring_attn_0_1_stage_10&#45;&gt;ring_attn_0_2_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-17452C1021.02,-17452 1179.86,-17452 1179.86,-17452"/>
<polygon fill="red" stroke="red" points="1179.86,-17455.5 1189.86,-17452 1179.86,-17448.5 1179.86,-17455.5"/>
</g>
<!-- ring_attn_0_1_stage_11&#45;&gt;ring_attn_0_1_stage_12 -->
<g id="edge112" class="edge">
<title>ring_attn_0_1_stage_11&#45;&gt;ring_attn_0_1_stage_12</title>
<path fill="none" stroke="black" d="M812,-17130.87C812,-17130.87 812,-17024.25 812,-17024.25"/>
<polygon fill="black" stroke="black" points="815.5,-17024.25 812,-17014.25 808.5,-17024.25 815.5,-17024.25"/>
</g>
<!-- ring_attn_0_2_stage_11 -->
<g id="node211" class="node">
<title>ring_attn_0_2_stage_11</title>
<polygon fill="yellow" stroke="black" points="1399,-17267 1190,-17199 1399,-17131 1608,-17199 1399,-17267"/>
<text text-anchor="middle" x="1399" y="-17217.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-17202.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="1399" y="-17187.8" font-family="Times,serif" font-size="14.00">Q[2]×K[7]×V[7]</text>
<text text-anchor="middle" x="1399" y="-17172.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_1_stage_11&#45;&gt;ring_attn_0_2_stage_11 -->
<g id="edge1628" class="edge">
<title>ring_attn_0_1_stage_11&#45;&gt;ring_attn_0_2_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-17199C1021.02,-17199 1179.86,-17199 1179.86,-17199"/>
<polygon fill="red" stroke="red" points="1179.86,-17202.5 1189.86,-17199 1179.86,-17195.5 1179.86,-17202.5"/>
</g>
<!-- ring_attn_0_1_stage_12&#45;&gt;ring_attn_0_1_stage_13 -->
<g id="edge113" class="edge">
<title>ring_attn_0_1_stage_12&#45;&gt;ring_attn_0_1_stage_13</title>
<path fill="none" stroke="black" d="M812,-16877.87C812,-16877.87 812,-16771.25 812,-16771.25"/>
<polygon fill="black" stroke="black" points="815.5,-16771.25 812,-16761.25 808.5,-16771.25 815.5,-16771.25"/>
</g>
<!-- ring_attn_0_2_stage_12 -->
<g id="node212" class="node">
<title>ring_attn_0_2_stage_12</title>
<polygon fill="yellow" stroke="black" points="1399,-17014 1190,-16946 1399,-16878 1608,-16946 1399,-17014"/>
<text text-anchor="middle" x="1399" y="-16964.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-16949.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="1399" y="-16934.8" font-family="Times,serif" font-size="14.00">Q[2]×K[6]×V[6]</text>
<text text-anchor="middle" x="1399" y="-16919.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_1_stage_12&#45;&gt;ring_attn_0_2_stage_12 -->
<g id="edge1629" class="edge">
<title>ring_attn_0_1_stage_12&#45;&gt;ring_attn_0_2_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-16946C1021.02,-16946 1179.86,-16946 1179.86,-16946"/>
<polygon fill="red" stroke="red" points="1179.86,-16949.5 1189.86,-16946 1179.86,-16942.5 1179.86,-16949.5"/>
</g>
<!-- ring_attn_0_1_stage_13&#45;&gt;ring_attn_0_1_stage_14 -->
<g id="edge114" class="edge">
<title>ring_attn_0_1_stage_13&#45;&gt;ring_attn_0_1_stage_14</title>
<path fill="none" stroke="black" d="M812,-16624.87C812,-16624.87 812,-16518.25 812,-16518.25"/>
<polygon fill="black" stroke="black" points="815.5,-16518.25 812,-16508.25 808.5,-16518.25 815.5,-16518.25"/>
</g>
<!-- ring_attn_0_2_stage_13 -->
<g id="node213" class="node">
<title>ring_attn_0_2_stage_13</title>
<polygon fill="yellow" stroke="black" points="1399,-16761 1190,-16693 1399,-16625 1608,-16693 1399,-16761"/>
<text text-anchor="middle" x="1399" y="-16711.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-16696.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="1399" y="-16681.8" font-family="Times,serif" font-size="14.00">Q[2]×K[5]×V[5]</text>
<text text-anchor="middle" x="1399" y="-16666.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_1_stage_13&#45;&gt;ring_attn_0_2_stage_13 -->
<g id="edge1630" class="edge">
<title>ring_attn_0_1_stage_13&#45;&gt;ring_attn_0_2_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-16693C1021.02,-16693 1179.86,-16693 1179.86,-16693"/>
<polygon fill="red" stroke="red" points="1179.86,-16696.5 1189.86,-16693 1179.86,-16689.5 1179.86,-16696.5"/>
</g>
<!-- ring_attn_0_1_stage_14&#45;&gt;ring_attn_0_1_stage_15 -->
<g id="edge115" class="edge">
<title>ring_attn_0_1_stage_14&#45;&gt;ring_attn_0_1_stage_15</title>
<path fill="none" stroke="black" d="M812,-16371.87C812,-16371.87 812,-16265.25 812,-16265.25"/>
<polygon fill="black" stroke="black" points="815.5,-16265.25 812,-16255.25 808.5,-16265.25 815.5,-16265.25"/>
</g>
<!-- ring_attn_0_2_stage_14 -->
<g id="node214" class="node">
<title>ring_attn_0_2_stage_14</title>
<polygon fill="yellow" stroke="black" points="1399,-16508 1190,-16440 1399,-16372 1608,-16440 1399,-16508"/>
<text text-anchor="middle" x="1399" y="-16458.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-16443.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="1399" y="-16428.8" font-family="Times,serif" font-size="14.00">Q[2]×K[4]×V[4]</text>
<text text-anchor="middle" x="1399" y="-16413.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_1_stage_14&#45;&gt;ring_attn_0_2_stage_14 -->
<g id="edge1631" class="edge">
<title>ring_attn_0_1_stage_14&#45;&gt;ring_attn_0_2_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-16440C1021.02,-16440 1179.86,-16440 1179.86,-16440"/>
<polygon fill="red" stroke="red" points="1179.86,-16443.5 1189.86,-16440 1179.86,-16436.5 1179.86,-16443.5"/>
</g>
<!-- attn_out_0_1 -->
<g id="node118" class="node">
<title>attn_out_0_1</title>
<polygon fill="none" stroke="black" points="881.5,-16046 742.5,-16046 742.5,-15993 881.5,-15993 881.5,-16046"/>
<text text-anchor="middle" x="812" y="-16030.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="812" y="-16015.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="812" y="-16000.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_0_1_stage_15&#45;&gt;attn_out_0_1 -->
<g id="edge116" class="edge">
<title>ring_attn_0_1_stage_15&#45;&gt;attn_out_0_1</title>
<path fill="none" stroke="black" d="M812,-16118.87C812,-16118.87 812,-16056.18 812,-16056.18"/>
<polygon fill="black" stroke="black" points="815.5,-16056.18 812,-16046.18 808.5,-16056.18 815.5,-16056.18"/>
</g>
<!-- ring_attn_0_2_stage_15 -->
<g id="node215" class="node">
<title>ring_attn_0_2_stage_15</title>
<polygon fill="yellow" stroke="black" points="1399,-16255 1190,-16187 1399,-16119 1608,-16187 1399,-16255"/>
<text text-anchor="middle" x="1399" y="-16205.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-16190.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="1399" y="-16175.8" font-family="Times,serif" font-size="14.00">Q[2]×K[3]×V[3]</text>
<text text-anchor="middle" x="1399" y="-16160.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_1_stage_15&#45;&gt;ring_attn_0_2_stage_15 -->
<g id="edge1632" class="edge">
<title>ring_attn_0_1_stage_15&#45;&gt;ring_attn_0_2_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-16187C1021.02,-16187 1179.86,-16187 1179.86,-16187"/>
<polygon fill="red" stroke="red" points="1179.86,-16190.5 1189.86,-16187 1179.86,-16183.5 1179.86,-16190.5"/>
</g>
<!-- attn_residual_0_1 -->
<g id="node119" class="node">
<title>attn_residual_0_1</title>
<ellipse fill="none" stroke="black" cx="812" cy="-15893" rx="105.5" ry="27"/>
<text text-anchor="middle" x="812" y="-15896.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="812" y="-15881.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_0_1&#45;&gt;attn_residual_0_1 -->
<g id="edge117" class="edge">
<title>attn_out_0_1&#45;&gt;attn_residual_0_1</title>
<path fill="none" stroke="black" d="M812,-15992.98C812,-15992.98 812,-15930.36 812,-15930.36"/>
<polygon fill="black" stroke="black" points="815.5,-15930.36 812,-15920.36 808.5,-15930.36 815.5,-15930.36"/>
</g>
<!-- ffn_up_0_1 -->
<g id="node120" class="node">
<title>ffn_up_0_1</title>
<polygon fill="none" stroke="black" points="891,-15793 733,-15793 733,-15740 891,-15740 891,-15793"/>
<text text-anchor="middle" x="812" y="-15777.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="812" y="-15762.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="812" y="-15747.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_0_1&#45;&gt;ffn_up_0_1 -->
<g id="edge118" class="edge">
<title>attn_residual_0_1&#45;&gt;ffn_up_0_1</title>
<path fill="none" stroke="black" d="M812,-15865.86C812,-15865.86 812,-15803.16 812,-15803.16"/>
<polygon fill="black" stroke="black" points="815.5,-15803.16 812,-15793.16 808.5,-15803.16 815.5,-15803.16"/>
</g>
<!-- ffn_gelu_0_1 -->
<g id="node121" class="node">
<title>ffn_gelu_0_1</title>
<ellipse fill="none" stroke="black" cx="812" cy="-15640" rx="105.5" ry="27"/>
<text text-anchor="middle" x="812" y="-15643.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="812" y="-15628.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_0_1&#45;&gt;ffn_gelu_0_1 -->
<g id="edge119" class="edge">
<title>ffn_up_0_1&#45;&gt;ffn_gelu_0_1</title>
<path fill="none" stroke="black" d="M812,-15739.98C812,-15739.98 812,-15677.36 812,-15677.36"/>
<polygon fill="black" stroke="black" points="815.5,-15677.36 812,-15667.36 808.5,-15677.36 815.5,-15677.36"/>
</g>
<!-- ffn_down_0_1 -->
<g id="node122" class="node">
<title>ffn_down_0_1</title>
<polygon fill="none" stroke="black" points="901,-15540 723,-15540 723,-15487 901,-15487 901,-15540"/>
<text text-anchor="middle" x="812" y="-15524.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="812" y="-15509.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="812" y="-15494.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_0_1&#45;&gt;ffn_down_0_1 -->
<g id="edge120" class="edge">
<title>ffn_gelu_0_1&#45;&gt;ffn_down_0_1</title>
<path fill="none" stroke="black" d="M812,-15612.86C812,-15612.86 812,-15550.16 812,-15550.16"/>
<polygon fill="black" stroke="black" points="815.5,-15550.16 812,-15540.16 808.5,-15550.16 815.5,-15550.16"/>
</g>
<!-- ffn_residual_0_1 -->
<g id="node123" class="node">
<title>ffn_residual_0_1</title>
<ellipse fill="none" stroke="black" cx="812" cy="-15387" rx="105.5" ry="27"/>
<text text-anchor="middle" x="812" y="-15390.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="812" y="-15375.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_0_1&#45;&gt;ffn_residual_0_1 -->
<g id="edge121" class="edge">
<title>ffn_down_0_1&#45;&gt;ffn_residual_0_1</title>
<path fill="none" stroke="black" d="M812,-15486.98C812,-15486.98 812,-15424.36 812,-15424.36"/>
<polygon fill="black" stroke="black" points="815.5,-15424.36 812,-15414.36 808.5,-15424.36 815.5,-15424.36"/>
</g>
<!-- qkv_proj_1_1 -->
<g id="node124" class="node">
<title>qkv_proj_1_1</title>
<polygon fill="none" stroke="black" points="894.5,-15287 729.5,-15287 729.5,-15234 894.5,-15234 894.5,-15287"/>
<text text-anchor="middle" x="812" y="-15271.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="812" y="-15256.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="812" y="-15241.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_0_1&#45;&gt;qkv_proj_1_1 -->
<g id="edge122" class="edge">
<title>ffn_residual_0_1&#45;&gt;qkv_proj_1_1</title>
<path fill="none" stroke="black" d="M812,-15359.86C812,-15359.86 812,-15297.16 812,-15297.16"/>
<polygon fill="black" stroke="black" points="815.5,-15297.16 812,-15287.16 808.5,-15297.16 815.5,-15297.16"/>
</g>
<!-- qkv_reshape_1_1 -->
<g id="node125" class="node">
<title>qkv_reshape_1_1</title>
<ellipse fill="none" stroke="black" cx="812" cy="-15134" rx="148" ry="27"/>
<text text-anchor="middle" x="812" y="-15137.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="812" y="-15122.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_1_1&#45;&gt;qkv_reshape_1_1 -->
<g id="edge123" class="edge">
<title>qkv_proj_1_1&#45;&gt;qkv_reshape_1_1</title>
<path fill="none" stroke="black" d="M812,-15233.98C812,-15233.98 812,-15171.36 812,-15171.36"/>
<polygon fill="black" stroke="black" points="815.5,-15171.36 812,-15161.36 808.5,-15171.36 815.5,-15171.36"/>
</g>
<!-- qkv_reshape_1_1&#45;&gt;ring_attn_1_1_stage_0 -->
<g id="edge124" class="edge">
<title>qkv_reshape_1_1&#45;&gt;ring_attn_1_1_stage_0</title>
<path fill="none" stroke="black" d="M812,-15106.72C812,-15106.72 812,-15000.16 812,-15000.16"/>
<polygon fill="black" stroke="black" points="815.5,-15000.16 812,-14990.16 808.5,-15000.16 815.5,-15000.16"/>
</g>
<!-- ring_attn_1_1_stage_0&#45;&gt;ring_attn_1_1_stage_1 -->
<g id="edge125" class="edge">
<title>ring_attn_1_1_stage_0&#45;&gt;ring_attn_1_1_stage_1</title>
<path fill="none" stroke="black" d="M812,-14853.87C812,-14853.87 812,-14747.25 812,-14747.25"/>
<polygon fill="black" stroke="black" points="815.5,-14747.25 812,-14737.25 808.5,-14747.25 815.5,-14747.25"/>
</g>
<!-- ring_attn_1_2_stage_0 -->
<g id="node224" class="node">
<title>ring_attn_1_2_stage_0</title>
<polygon fill="yellow" stroke="black" points="1399,-14990 1190,-14922 1399,-14854 1608,-14922 1399,-14990"/>
<text text-anchor="middle" x="1399" y="-14940.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-14925.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="1399" y="-14910.8" font-family="Times,serif" font-size="14.00">Q[2]×K[2]×V[2]</text>
<text text-anchor="middle" x="1399" y="-14895.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_1_stage_0&#45;&gt;ring_attn_1_2_stage_0 -->
<g id="edge1633" class="edge">
<title>ring_attn_1_1_stage_0&#45;&gt;ring_attn_1_2_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-14922C1021.02,-14922 1179.86,-14922 1179.86,-14922"/>
<polygon fill="red" stroke="red" points="1179.86,-14925.5 1189.86,-14922 1179.86,-14918.5 1179.86,-14925.5"/>
</g>
<!-- ring_attn_1_1_stage_1&#45;&gt;ring_attn_1_1_stage_2 -->
<g id="edge126" class="edge">
<title>ring_attn_1_1_stage_1&#45;&gt;ring_attn_1_1_stage_2</title>
<path fill="none" stroke="black" d="M812,-14600.87C812,-14600.87 812,-14494.25 812,-14494.25"/>
<polygon fill="black" stroke="black" points="815.5,-14494.25 812,-14484.25 808.5,-14494.25 815.5,-14494.25"/>
</g>
<!-- ring_attn_1_2_stage_1 -->
<g id="node225" class="node">
<title>ring_attn_1_2_stage_1</title>
<polygon fill="yellow" stroke="black" points="1399,-14737 1190,-14669 1399,-14601 1608,-14669 1399,-14737"/>
<text text-anchor="middle" x="1399" y="-14687.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-14672.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="1399" y="-14657.8" font-family="Times,serif" font-size="14.00">Q[2]×K[1]×V[1]</text>
<text text-anchor="middle" x="1399" y="-14642.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_1_stage_1&#45;&gt;ring_attn_1_2_stage_1 -->
<g id="edge1634" class="edge">
<title>ring_attn_1_1_stage_1&#45;&gt;ring_attn_1_2_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-14669C1021.02,-14669 1179.86,-14669 1179.86,-14669"/>
<polygon fill="red" stroke="red" points="1179.86,-14672.5 1189.86,-14669 1179.86,-14665.5 1179.86,-14672.5"/>
</g>
<!-- ring_attn_1_1_stage_2&#45;&gt;ring_attn_1_1_stage_3 -->
<g id="edge127" class="edge">
<title>ring_attn_1_1_stage_2&#45;&gt;ring_attn_1_1_stage_3</title>
<path fill="none" stroke="black" d="M812,-14347.87C812,-14347.87 812,-14241.25 812,-14241.25"/>
<polygon fill="black" stroke="black" points="815.5,-14241.25 812,-14231.25 808.5,-14241.25 815.5,-14241.25"/>
</g>
<!-- ring_attn_1_2_stage_2 -->
<g id="node226" class="node">
<title>ring_attn_1_2_stage_2</title>
<polygon fill="yellow" stroke="black" points="1399,-14484 1190,-14416 1399,-14348 1608,-14416 1399,-14484"/>
<text text-anchor="middle" x="1399" y="-14434.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-14419.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="1399" y="-14404.8" font-family="Times,serif" font-size="14.00">Q[2]×K[0]×V[0]</text>
<text text-anchor="middle" x="1399" y="-14389.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_1_stage_2&#45;&gt;ring_attn_1_2_stage_2 -->
<g id="edge1635" class="edge">
<title>ring_attn_1_1_stage_2&#45;&gt;ring_attn_1_2_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-14416C1021.02,-14416 1179.86,-14416 1179.86,-14416"/>
<polygon fill="red" stroke="red" points="1179.86,-14419.5 1189.86,-14416 1179.86,-14412.5 1179.86,-14419.5"/>
</g>
<!-- ring_attn_1_1_stage_3&#45;&gt;ring_attn_1_1_stage_4 -->
<g id="edge128" class="edge">
<title>ring_attn_1_1_stage_3&#45;&gt;ring_attn_1_1_stage_4</title>
<path fill="none" stroke="black" d="M812,-14094.87C812,-14094.87 812,-13988.25 812,-13988.25"/>
<polygon fill="black" stroke="black" points="815.5,-13988.25 812,-13978.25 808.5,-13988.25 815.5,-13988.25"/>
</g>
<!-- ring_attn_1_2_stage_3 -->
<g id="node227" class="node">
<title>ring_attn_1_2_stage_3</title>
<polygon fill="yellow" stroke="black" points="1399,-14231 1190,-14163 1399,-14095 1608,-14163 1399,-14231"/>
<text text-anchor="middle" x="1399" y="-14181.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-14166.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="1399" y="-14151.8" font-family="Times,serif" font-size="14.00">Q[2]×K[15]×V[15]</text>
<text text-anchor="middle" x="1399" y="-14136.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_1_stage_3&#45;&gt;ring_attn_1_2_stage_3 -->
<g id="edge1636" class="edge">
<title>ring_attn_1_1_stage_3&#45;&gt;ring_attn_1_2_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-14163C1021.02,-14163 1179.86,-14163 1179.86,-14163"/>
<polygon fill="red" stroke="red" points="1179.86,-14166.5 1189.86,-14163 1179.86,-14159.5 1179.86,-14166.5"/>
</g>
<!-- ring_attn_1_1_stage_4&#45;&gt;ring_attn_1_1_stage_5 -->
<g id="edge129" class="edge">
<title>ring_attn_1_1_stage_4&#45;&gt;ring_attn_1_1_stage_5</title>
<path fill="none" stroke="black" d="M812,-13841.87C812,-13841.87 812,-13735.25 812,-13735.25"/>
<polygon fill="black" stroke="black" points="815.5,-13735.25 812,-13725.25 808.5,-13735.25 815.5,-13735.25"/>
</g>
<!-- ring_attn_1_2_stage_4 -->
<g id="node228" class="node">
<title>ring_attn_1_2_stage_4</title>
<polygon fill="yellow" stroke="black" points="1399,-13978 1190,-13910 1399,-13842 1608,-13910 1399,-13978"/>
<text text-anchor="middle" x="1399" y="-13928.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-13913.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="1399" y="-13898.8" font-family="Times,serif" font-size="14.00">Q[2]×K[14]×V[14]</text>
<text text-anchor="middle" x="1399" y="-13883.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_1_stage_4&#45;&gt;ring_attn_1_2_stage_4 -->
<g id="edge1637" class="edge">
<title>ring_attn_1_1_stage_4&#45;&gt;ring_attn_1_2_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-13910C1021.02,-13910 1179.86,-13910 1179.86,-13910"/>
<polygon fill="red" stroke="red" points="1179.86,-13913.5 1189.86,-13910 1179.86,-13906.5 1179.86,-13913.5"/>
</g>
<!-- ring_attn_1_1_stage_5&#45;&gt;ring_attn_1_1_stage_6 -->
<g id="edge130" class="edge">
<title>ring_attn_1_1_stage_5&#45;&gt;ring_attn_1_1_stage_6</title>
<path fill="none" stroke="black" d="M812,-13588.87C812,-13588.87 812,-13482.25 812,-13482.25"/>
<polygon fill="black" stroke="black" points="815.5,-13482.25 812,-13472.25 808.5,-13482.25 815.5,-13482.25"/>
</g>
<!-- ring_attn_1_2_stage_5 -->
<g id="node229" class="node">
<title>ring_attn_1_2_stage_5</title>
<polygon fill="yellow" stroke="black" points="1399,-13725 1190,-13657 1399,-13589 1608,-13657 1399,-13725"/>
<text text-anchor="middle" x="1399" y="-13675.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-13660.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="1399" y="-13645.8" font-family="Times,serif" font-size="14.00">Q[2]×K[13]×V[13]</text>
<text text-anchor="middle" x="1399" y="-13630.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_1_stage_5&#45;&gt;ring_attn_1_2_stage_5 -->
<g id="edge1638" class="edge">
<title>ring_attn_1_1_stage_5&#45;&gt;ring_attn_1_2_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-13657C1021.02,-13657 1179.86,-13657 1179.86,-13657"/>
<polygon fill="red" stroke="red" points="1179.86,-13660.5 1189.86,-13657 1179.86,-13653.5 1179.86,-13660.5"/>
</g>
<!-- ring_attn_1_1_stage_6&#45;&gt;ring_attn_1_1_stage_7 -->
<g id="edge131" class="edge">
<title>ring_attn_1_1_stage_6&#45;&gt;ring_attn_1_1_stage_7</title>
<path fill="none" stroke="black" d="M812,-13335.87C812,-13335.87 812,-13229.25 812,-13229.25"/>
<polygon fill="black" stroke="black" points="815.5,-13229.25 812,-13219.25 808.5,-13229.25 815.5,-13229.25"/>
</g>
<!-- ring_attn_1_2_stage_6 -->
<g id="node230" class="node">
<title>ring_attn_1_2_stage_6</title>
<polygon fill="yellow" stroke="black" points="1399,-13472 1190,-13404 1399,-13336 1608,-13404 1399,-13472"/>
<text text-anchor="middle" x="1399" y="-13422.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-13407.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="1399" y="-13392.8" font-family="Times,serif" font-size="14.00">Q[2]×K[12]×V[12]</text>
<text text-anchor="middle" x="1399" y="-13377.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_1_stage_6&#45;&gt;ring_attn_1_2_stage_6 -->
<g id="edge1639" class="edge">
<title>ring_attn_1_1_stage_6&#45;&gt;ring_attn_1_2_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-13404C1021.02,-13404 1179.86,-13404 1179.86,-13404"/>
<polygon fill="red" stroke="red" points="1179.86,-13407.5 1189.86,-13404 1179.86,-13400.5 1179.86,-13407.5"/>
</g>
<!-- ring_attn_1_1_stage_7&#45;&gt;ring_attn_1_1_stage_8 -->
<g id="edge132" class="edge">
<title>ring_attn_1_1_stage_7&#45;&gt;ring_attn_1_1_stage_8</title>
<path fill="none" stroke="black" d="M812,-13082.87C812,-13082.87 812,-12976.25 812,-12976.25"/>
<polygon fill="black" stroke="black" points="815.5,-12976.25 812,-12966.25 808.5,-12976.25 815.5,-12976.25"/>
</g>
<!-- ring_attn_1_2_stage_7 -->
<g id="node231" class="node">
<title>ring_attn_1_2_stage_7</title>
<polygon fill="yellow" stroke="black" points="1399,-13219 1190,-13151 1399,-13083 1608,-13151 1399,-13219"/>
<text text-anchor="middle" x="1399" y="-13169.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-13154.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="1399" y="-13139.8" font-family="Times,serif" font-size="14.00">Q[2]×K[11]×V[11]</text>
<text text-anchor="middle" x="1399" y="-13124.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_1_stage_7&#45;&gt;ring_attn_1_2_stage_7 -->
<g id="edge1640" class="edge">
<title>ring_attn_1_1_stage_7&#45;&gt;ring_attn_1_2_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-13151C1021.02,-13151 1179.86,-13151 1179.86,-13151"/>
<polygon fill="red" stroke="red" points="1179.86,-13154.5 1189.86,-13151 1179.86,-13147.5 1179.86,-13154.5"/>
</g>
<!-- ring_attn_1_1_stage_8&#45;&gt;ring_attn_1_1_stage_9 -->
<g id="edge133" class="edge">
<title>ring_attn_1_1_stage_8&#45;&gt;ring_attn_1_1_stage_9</title>
<path fill="none" stroke="black" d="M812,-12829.87C812,-12829.87 812,-12723.25 812,-12723.25"/>
<polygon fill="black" stroke="black" points="815.5,-12723.25 812,-12713.25 808.5,-12723.25 815.5,-12723.25"/>
</g>
<!-- ring_attn_1_2_stage_8 -->
<g id="node232" class="node">
<title>ring_attn_1_2_stage_8</title>
<polygon fill="yellow" stroke="black" points="1399,-12966 1190,-12898 1399,-12830 1608,-12898 1399,-12966"/>
<text text-anchor="middle" x="1399" y="-12916.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-12901.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="1399" y="-12886.8" font-family="Times,serif" font-size="14.00">Q[2]×K[10]×V[10]</text>
<text text-anchor="middle" x="1399" y="-12871.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_1_stage_8&#45;&gt;ring_attn_1_2_stage_8 -->
<g id="edge1641" class="edge">
<title>ring_attn_1_1_stage_8&#45;&gt;ring_attn_1_2_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-12898C1021.02,-12898 1179.86,-12898 1179.86,-12898"/>
<polygon fill="red" stroke="red" points="1179.86,-12901.5 1189.86,-12898 1179.86,-12894.5 1179.86,-12901.5"/>
</g>
<!-- ring_attn_1_1_stage_9&#45;&gt;ring_attn_1_1_stage_10 -->
<g id="edge134" class="edge">
<title>ring_attn_1_1_stage_9&#45;&gt;ring_attn_1_1_stage_10</title>
<path fill="none" stroke="black" d="M812,-12576.87C812,-12576.87 812,-12470.25 812,-12470.25"/>
<polygon fill="black" stroke="black" points="815.5,-12470.25 812,-12460.25 808.5,-12470.25 815.5,-12470.25"/>
</g>
<!-- ring_attn_1_2_stage_9 -->
<g id="node233" class="node">
<title>ring_attn_1_2_stage_9</title>
<polygon fill="yellow" stroke="black" points="1399,-12713 1190,-12645 1399,-12577 1608,-12645 1399,-12713"/>
<text text-anchor="middle" x="1399" y="-12663.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-12648.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="1399" y="-12633.8" font-family="Times,serif" font-size="14.00">Q[2]×K[9]×V[9]</text>
<text text-anchor="middle" x="1399" y="-12618.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_1_stage_9&#45;&gt;ring_attn_1_2_stage_9 -->
<g id="edge1642" class="edge">
<title>ring_attn_1_1_stage_9&#45;&gt;ring_attn_1_2_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-12645C1021.02,-12645 1179.86,-12645 1179.86,-12645"/>
<polygon fill="red" stroke="red" points="1179.86,-12648.5 1189.86,-12645 1179.86,-12641.5 1179.86,-12648.5"/>
</g>
<!-- ring_attn_1_1_stage_10&#45;&gt;ring_attn_1_1_stage_11 -->
<g id="edge135" class="edge">
<title>ring_attn_1_1_stage_10&#45;&gt;ring_attn_1_1_stage_11</title>
<path fill="none" stroke="black" d="M812,-12323.87C812,-12323.87 812,-12217.25 812,-12217.25"/>
<polygon fill="black" stroke="black" points="815.5,-12217.25 812,-12207.25 808.5,-12217.25 815.5,-12217.25"/>
</g>
<!-- ring_attn_1_2_stage_10 -->
<g id="node234" class="node">
<title>ring_attn_1_2_stage_10</title>
<polygon fill="yellow" stroke="black" points="1399,-12460 1190,-12392 1399,-12324 1608,-12392 1399,-12460"/>
<text text-anchor="middle" x="1399" y="-12410.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-12395.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="1399" y="-12380.8" font-family="Times,serif" font-size="14.00">Q[2]×K[8]×V[8]</text>
<text text-anchor="middle" x="1399" y="-12365.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_1_stage_10&#45;&gt;ring_attn_1_2_stage_10 -->
<g id="edge1643" class="edge">
<title>ring_attn_1_1_stage_10&#45;&gt;ring_attn_1_2_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-12392C1021.02,-12392 1179.86,-12392 1179.86,-12392"/>
<polygon fill="red" stroke="red" points="1179.86,-12395.5 1189.86,-12392 1179.86,-12388.5 1179.86,-12395.5"/>
</g>
<!-- ring_attn_1_1_stage_11&#45;&gt;ring_attn_1_1_stage_12 -->
<g id="edge136" class="edge">
<title>ring_attn_1_1_stage_11&#45;&gt;ring_attn_1_1_stage_12</title>
<path fill="none" stroke="black" d="M812,-12070.87C812,-12070.87 812,-11964.25 812,-11964.25"/>
<polygon fill="black" stroke="black" points="815.5,-11964.25 812,-11954.25 808.5,-11964.25 815.5,-11964.25"/>
</g>
<!-- ring_attn_1_2_stage_11 -->
<g id="node235" class="node">
<title>ring_attn_1_2_stage_11</title>
<polygon fill="yellow" stroke="black" points="1399,-12207 1190,-12139 1399,-12071 1608,-12139 1399,-12207"/>
<text text-anchor="middle" x="1399" y="-12157.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-12142.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="1399" y="-12127.8" font-family="Times,serif" font-size="14.00">Q[2]×K[7]×V[7]</text>
<text text-anchor="middle" x="1399" y="-12112.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_1_stage_11&#45;&gt;ring_attn_1_2_stage_11 -->
<g id="edge1644" class="edge">
<title>ring_attn_1_1_stage_11&#45;&gt;ring_attn_1_2_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-12139C1021.02,-12139 1179.86,-12139 1179.86,-12139"/>
<polygon fill="red" stroke="red" points="1179.86,-12142.5 1189.86,-12139 1179.86,-12135.5 1179.86,-12142.5"/>
</g>
<!-- ring_attn_1_1_stage_12&#45;&gt;ring_attn_1_1_stage_13 -->
<g id="edge137" class="edge">
<title>ring_attn_1_1_stage_12&#45;&gt;ring_attn_1_1_stage_13</title>
<path fill="none" stroke="black" d="M812,-11817.87C812,-11817.87 812,-11711.25 812,-11711.25"/>
<polygon fill="black" stroke="black" points="815.5,-11711.25 812,-11701.25 808.5,-11711.25 815.5,-11711.25"/>
</g>
<!-- ring_attn_1_2_stage_12 -->
<g id="node236" class="node">
<title>ring_attn_1_2_stage_12</title>
<polygon fill="yellow" stroke="black" points="1399,-11954 1190,-11886 1399,-11818 1608,-11886 1399,-11954"/>
<text text-anchor="middle" x="1399" y="-11904.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-11889.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="1399" y="-11874.8" font-family="Times,serif" font-size="14.00">Q[2]×K[6]×V[6]</text>
<text text-anchor="middle" x="1399" y="-11859.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_1_stage_12&#45;&gt;ring_attn_1_2_stage_12 -->
<g id="edge1645" class="edge">
<title>ring_attn_1_1_stage_12&#45;&gt;ring_attn_1_2_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-11886C1021.02,-11886 1179.86,-11886 1179.86,-11886"/>
<polygon fill="red" stroke="red" points="1179.86,-11889.5 1189.86,-11886 1179.86,-11882.5 1179.86,-11889.5"/>
</g>
<!-- ring_attn_1_1_stage_13&#45;&gt;ring_attn_1_1_stage_14 -->
<g id="edge138" class="edge">
<title>ring_attn_1_1_stage_13&#45;&gt;ring_attn_1_1_stage_14</title>
<path fill="none" stroke="black" d="M812,-11564.87C812,-11564.87 812,-11458.25 812,-11458.25"/>
<polygon fill="black" stroke="black" points="815.5,-11458.25 812,-11448.25 808.5,-11458.25 815.5,-11458.25"/>
</g>
<!-- ring_attn_1_2_stage_13 -->
<g id="node237" class="node">
<title>ring_attn_1_2_stage_13</title>
<polygon fill="yellow" stroke="black" points="1399,-11701 1190,-11633 1399,-11565 1608,-11633 1399,-11701"/>
<text text-anchor="middle" x="1399" y="-11651.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-11636.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="1399" y="-11621.8" font-family="Times,serif" font-size="14.00">Q[2]×K[5]×V[5]</text>
<text text-anchor="middle" x="1399" y="-11606.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_1_stage_13&#45;&gt;ring_attn_1_2_stage_13 -->
<g id="edge1646" class="edge">
<title>ring_attn_1_1_stage_13&#45;&gt;ring_attn_1_2_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-11633C1021.02,-11633 1179.86,-11633 1179.86,-11633"/>
<polygon fill="red" stroke="red" points="1179.86,-11636.5 1189.86,-11633 1179.86,-11629.5 1179.86,-11636.5"/>
</g>
<!-- ring_attn_1_1_stage_14&#45;&gt;ring_attn_1_1_stage_15 -->
<g id="edge139" class="edge">
<title>ring_attn_1_1_stage_14&#45;&gt;ring_attn_1_1_stage_15</title>
<path fill="none" stroke="black" d="M812,-11311.87C812,-11311.87 812,-11205.25 812,-11205.25"/>
<polygon fill="black" stroke="black" points="815.5,-11205.25 812,-11195.25 808.5,-11205.25 815.5,-11205.25"/>
</g>
<!-- ring_attn_1_2_stage_14 -->
<g id="node238" class="node">
<title>ring_attn_1_2_stage_14</title>
<polygon fill="yellow" stroke="black" points="1399,-11448 1190,-11380 1399,-11312 1608,-11380 1399,-11448"/>
<text text-anchor="middle" x="1399" y="-11398.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-11383.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="1399" y="-11368.8" font-family="Times,serif" font-size="14.00">Q[2]×K[4]×V[4]</text>
<text text-anchor="middle" x="1399" y="-11353.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_1_stage_14&#45;&gt;ring_attn_1_2_stage_14 -->
<g id="edge1647" class="edge">
<title>ring_attn_1_1_stage_14&#45;&gt;ring_attn_1_2_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-11380C1021.02,-11380 1179.86,-11380 1179.86,-11380"/>
<polygon fill="red" stroke="red" points="1179.86,-11383.5 1189.86,-11380 1179.86,-11376.5 1179.86,-11383.5"/>
</g>
<!-- attn_out_1_1 -->
<g id="node142" class="node">
<title>attn_out_1_1</title>
<polygon fill="none" stroke="black" points="881.5,-10986 742.5,-10986 742.5,-10933 881.5,-10933 881.5,-10986"/>
<text text-anchor="middle" x="812" y="-10970.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="812" y="-10955.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="812" y="-10940.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_1_1_stage_15&#45;&gt;attn_out_1_1 -->
<g id="edge140" class="edge">
<title>ring_attn_1_1_stage_15&#45;&gt;attn_out_1_1</title>
<path fill="none" stroke="black" d="M812,-11058.87C812,-11058.87 812,-10996.18 812,-10996.18"/>
<polygon fill="black" stroke="black" points="815.5,-10996.18 812,-10986.18 808.5,-10996.18 815.5,-10996.18"/>
</g>
<!-- ring_attn_1_2_stage_15 -->
<g id="node239" class="node">
<title>ring_attn_1_2_stage_15</title>
<polygon fill="yellow" stroke="black" points="1399,-11195 1190,-11127 1399,-11059 1608,-11127 1399,-11195"/>
<text text-anchor="middle" x="1399" y="-11145.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-11130.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="1399" y="-11115.8" font-family="Times,serif" font-size="14.00">Q[2]×K[3]×V[3]</text>
<text text-anchor="middle" x="1399" y="-11100.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_1_stage_15&#45;&gt;ring_attn_1_2_stage_15 -->
<g id="edge1648" class="edge">
<title>ring_attn_1_1_stage_15&#45;&gt;ring_attn_1_2_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-11127C1021.02,-11127 1179.86,-11127 1179.86,-11127"/>
<polygon fill="red" stroke="red" points="1179.86,-11130.5 1189.86,-11127 1179.86,-11123.5 1179.86,-11130.5"/>
</g>
<!-- attn_residual_1_1 -->
<g id="node143" class="node">
<title>attn_residual_1_1</title>
<ellipse fill="none" stroke="black" cx="812" cy="-10833" rx="105.5" ry="27"/>
<text text-anchor="middle" x="812" y="-10836.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="812" y="-10821.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_1_1&#45;&gt;attn_residual_1_1 -->
<g id="edge141" class="edge">
<title>attn_out_1_1&#45;&gt;attn_residual_1_1</title>
<path fill="none" stroke="black" d="M812,-10932.98C812,-10932.98 812,-10870.36 812,-10870.36"/>
<polygon fill="black" stroke="black" points="815.5,-10870.36 812,-10860.36 808.5,-10870.36 815.5,-10870.36"/>
</g>
<!-- ffn_up_1_1 -->
<g id="node144" class="node">
<title>ffn_up_1_1</title>
<polygon fill="none" stroke="black" points="891,-10733 733,-10733 733,-10680 891,-10680 891,-10733"/>
<text text-anchor="middle" x="812" y="-10717.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="812" y="-10702.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="812" y="-10687.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_1_1&#45;&gt;ffn_up_1_1 -->
<g id="edge142" class="edge">
<title>attn_residual_1_1&#45;&gt;ffn_up_1_1</title>
<path fill="none" stroke="black" d="M812,-10805.86C812,-10805.86 812,-10743.16 812,-10743.16"/>
<polygon fill="black" stroke="black" points="815.5,-10743.16 812,-10733.16 808.5,-10743.16 815.5,-10743.16"/>
</g>
<!-- ffn_gelu_1_1 -->
<g id="node145" class="node">
<title>ffn_gelu_1_1</title>
<ellipse fill="none" stroke="black" cx="812" cy="-10580" rx="105.5" ry="27"/>
<text text-anchor="middle" x="812" y="-10583.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="812" y="-10568.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_1_1&#45;&gt;ffn_gelu_1_1 -->
<g id="edge143" class="edge">
<title>ffn_up_1_1&#45;&gt;ffn_gelu_1_1</title>
<path fill="none" stroke="black" d="M812,-10679.98C812,-10679.98 812,-10617.36 812,-10617.36"/>
<polygon fill="black" stroke="black" points="815.5,-10617.36 812,-10607.36 808.5,-10617.36 815.5,-10617.36"/>
</g>
<!-- ffn_down_1_1 -->
<g id="node146" class="node">
<title>ffn_down_1_1</title>
<polygon fill="none" stroke="black" points="901,-10480 723,-10480 723,-10427 901,-10427 901,-10480"/>
<text text-anchor="middle" x="812" y="-10464.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="812" y="-10449.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="812" y="-10434.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_1_1&#45;&gt;ffn_down_1_1 -->
<g id="edge144" class="edge">
<title>ffn_gelu_1_1&#45;&gt;ffn_down_1_1</title>
<path fill="none" stroke="black" d="M812,-10552.86C812,-10552.86 812,-10490.16 812,-10490.16"/>
<polygon fill="black" stroke="black" points="815.5,-10490.16 812,-10480.16 808.5,-10490.16 815.5,-10490.16"/>
</g>
<!-- ffn_residual_1_1 -->
<g id="node147" class="node">
<title>ffn_residual_1_1</title>
<ellipse fill="none" stroke="black" cx="812" cy="-10327" rx="105.5" ry="27"/>
<text text-anchor="middle" x="812" y="-10330.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="812" y="-10315.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_1_1&#45;&gt;ffn_residual_1_1 -->
<g id="edge145" class="edge">
<title>ffn_down_1_1&#45;&gt;ffn_residual_1_1</title>
<path fill="none" stroke="black" d="M812,-10426.98C812,-10426.98 812,-10364.36 812,-10364.36"/>
<polygon fill="black" stroke="black" points="815.5,-10364.36 812,-10354.36 808.5,-10364.36 815.5,-10364.36"/>
</g>
<!-- qkv_proj_2_1 -->
<g id="node148" class="node">
<title>qkv_proj_2_1</title>
<polygon fill="none" stroke="black" points="894.5,-10227 729.5,-10227 729.5,-10174 894.5,-10174 894.5,-10227"/>
<text text-anchor="middle" x="812" y="-10211.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="812" y="-10196.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="812" y="-10181.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_1_1&#45;&gt;qkv_proj_2_1 -->
<g id="edge146" class="edge">
<title>ffn_residual_1_1&#45;&gt;qkv_proj_2_1</title>
<path fill="none" stroke="black" d="M812,-10299.86C812,-10299.86 812,-10237.16 812,-10237.16"/>
<polygon fill="black" stroke="black" points="815.5,-10237.16 812,-10227.16 808.5,-10237.16 815.5,-10237.16"/>
</g>
<!-- qkv_reshape_2_1 -->
<g id="node149" class="node">
<title>qkv_reshape_2_1</title>
<ellipse fill="none" stroke="black" cx="812" cy="-10074" rx="148" ry="27"/>
<text text-anchor="middle" x="812" y="-10077.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="812" y="-10062.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_2_1&#45;&gt;qkv_reshape_2_1 -->
<g id="edge147" class="edge">
<title>qkv_proj_2_1&#45;&gt;qkv_reshape_2_1</title>
<path fill="none" stroke="black" d="M812,-10173.98C812,-10173.98 812,-10111.36 812,-10111.36"/>
<polygon fill="black" stroke="black" points="815.5,-10111.36 812,-10101.36 808.5,-10111.36 815.5,-10111.36"/>
</g>
<!-- qkv_reshape_2_1&#45;&gt;ring_attn_2_1_stage_0 -->
<g id="edge148" class="edge">
<title>qkv_reshape_2_1&#45;&gt;ring_attn_2_1_stage_0</title>
<path fill="none" stroke="black" d="M812,-10046.72C812,-10046.72 812,-9940.16 812,-9940.16"/>
<polygon fill="black" stroke="black" points="815.5,-9940.16 812,-9930.16 808.5,-9940.16 815.5,-9940.16"/>
</g>
<!-- ring_attn_2_1_stage_0&#45;&gt;ring_attn_2_1_stage_1 -->
<g id="edge149" class="edge">
<title>ring_attn_2_1_stage_0&#45;&gt;ring_attn_2_1_stage_1</title>
<path fill="none" stroke="black" d="M812,-9793.87C812,-9793.87 812,-9687.25 812,-9687.25"/>
<polygon fill="black" stroke="black" points="815.5,-9687.25 812,-9677.25 808.5,-9687.25 815.5,-9687.25"/>
</g>
<!-- ring_attn_2_2_stage_0 -->
<g id="node248" class="node">
<title>ring_attn_2_2_stage_0</title>
<polygon fill="yellow" stroke="black" points="1399,-9930 1190,-9862 1399,-9794 1608,-9862 1399,-9930"/>
<text text-anchor="middle" x="1399" y="-9880.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-9865.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="1399" y="-9850.8" font-family="Times,serif" font-size="14.00">Q[2]×K[2]×V[2]</text>
<text text-anchor="middle" x="1399" y="-9835.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_1_stage_0&#45;&gt;ring_attn_2_2_stage_0 -->
<g id="edge1649" class="edge">
<title>ring_attn_2_1_stage_0&#45;&gt;ring_attn_2_2_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-9862C1021.02,-9862 1179.86,-9862 1179.86,-9862"/>
<polygon fill="red" stroke="red" points="1179.86,-9865.5 1189.86,-9862 1179.86,-9858.5 1179.86,-9865.5"/>
</g>
<!-- ring_attn_2_1_stage_1&#45;&gt;ring_attn_2_1_stage_2 -->
<g id="edge150" class="edge">
<title>ring_attn_2_1_stage_1&#45;&gt;ring_attn_2_1_stage_2</title>
<path fill="none" stroke="black" d="M812,-9540.87C812,-9540.87 812,-9434.25 812,-9434.25"/>
<polygon fill="black" stroke="black" points="815.5,-9434.25 812,-9424.25 808.5,-9434.25 815.5,-9434.25"/>
</g>
<!-- ring_attn_2_2_stage_1 -->
<g id="node249" class="node">
<title>ring_attn_2_2_stage_1</title>
<polygon fill="yellow" stroke="black" points="1399,-9677 1190,-9609 1399,-9541 1608,-9609 1399,-9677"/>
<text text-anchor="middle" x="1399" y="-9627.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-9612.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="1399" y="-9597.8" font-family="Times,serif" font-size="14.00">Q[2]×K[1]×V[1]</text>
<text text-anchor="middle" x="1399" y="-9582.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_1_stage_1&#45;&gt;ring_attn_2_2_stage_1 -->
<g id="edge1650" class="edge">
<title>ring_attn_2_1_stage_1&#45;&gt;ring_attn_2_2_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-9609C1021.02,-9609 1179.86,-9609 1179.86,-9609"/>
<polygon fill="red" stroke="red" points="1179.86,-9612.5 1189.86,-9609 1179.86,-9605.5 1179.86,-9612.5"/>
</g>
<!-- ring_attn_2_1_stage_2&#45;&gt;ring_attn_2_1_stage_3 -->
<g id="edge151" class="edge">
<title>ring_attn_2_1_stage_2&#45;&gt;ring_attn_2_1_stage_3</title>
<path fill="none" stroke="black" d="M812,-9287.87C812,-9287.87 812,-9181.25 812,-9181.25"/>
<polygon fill="black" stroke="black" points="815.5,-9181.25 812,-9171.25 808.5,-9181.25 815.5,-9181.25"/>
</g>
<!-- ring_attn_2_2_stage_2 -->
<g id="node250" class="node">
<title>ring_attn_2_2_stage_2</title>
<polygon fill="yellow" stroke="black" points="1399,-9424 1190,-9356 1399,-9288 1608,-9356 1399,-9424"/>
<text text-anchor="middle" x="1399" y="-9374.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-9359.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="1399" y="-9344.8" font-family="Times,serif" font-size="14.00">Q[2]×K[0]×V[0]</text>
<text text-anchor="middle" x="1399" y="-9329.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_1_stage_2&#45;&gt;ring_attn_2_2_stage_2 -->
<g id="edge1651" class="edge">
<title>ring_attn_2_1_stage_2&#45;&gt;ring_attn_2_2_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-9356C1021.02,-9356 1179.86,-9356 1179.86,-9356"/>
<polygon fill="red" stroke="red" points="1179.86,-9359.5 1189.86,-9356 1179.86,-9352.5 1179.86,-9359.5"/>
</g>
<!-- ring_attn_2_1_stage_3&#45;&gt;ring_attn_2_1_stage_4 -->
<g id="edge152" class="edge">
<title>ring_attn_2_1_stage_3&#45;&gt;ring_attn_2_1_stage_4</title>
<path fill="none" stroke="black" d="M812,-9034.87C812,-9034.87 812,-8928.25 812,-8928.25"/>
<polygon fill="black" stroke="black" points="815.5,-8928.25 812,-8918.25 808.5,-8928.25 815.5,-8928.25"/>
</g>
<!-- ring_attn_2_2_stage_3 -->
<g id="node251" class="node">
<title>ring_attn_2_2_stage_3</title>
<polygon fill="yellow" stroke="black" points="1399,-9171 1190,-9103 1399,-9035 1608,-9103 1399,-9171"/>
<text text-anchor="middle" x="1399" y="-9121.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-9106.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="1399" y="-9091.8" font-family="Times,serif" font-size="14.00">Q[2]×K[15]×V[15]</text>
<text text-anchor="middle" x="1399" y="-9076.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_1_stage_3&#45;&gt;ring_attn_2_2_stage_3 -->
<g id="edge1652" class="edge">
<title>ring_attn_2_1_stage_3&#45;&gt;ring_attn_2_2_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-9103C1021.02,-9103 1179.86,-9103 1179.86,-9103"/>
<polygon fill="red" stroke="red" points="1179.86,-9106.5 1189.86,-9103 1179.86,-9099.5 1179.86,-9106.5"/>
</g>
<!-- ring_attn_2_1_stage_4&#45;&gt;ring_attn_2_1_stage_5 -->
<g id="edge153" class="edge">
<title>ring_attn_2_1_stage_4&#45;&gt;ring_attn_2_1_stage_5</title>
<path fill="none" stroke="black" d="M812,-8781.87C812,-8781.87 812,-8675.25 812,-8675.25"/>
<polygon fill="black" stroke="black" points="815.5,-8675.25 812,-8665.25 808.5,-8675.25 815.5,-8675.25"/>
</g>
<!-- ring_attn_2_2_stage_4 -->
<g id="node252" class="node">
<title>ring_attn_2_2_stage_4</title>
<polygon fill="yellow" stroke="black" points="1399,-8918 1190,-8850 1399,-8782 1608,-8850 1399,-8918"/>
<text text-anchor="middle" x="1399" y="-8868.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-8853.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="1399" y="-8838.8" font-family="Times,serif" font-size="14.00">Q[2]×K[14]×V[14]</text>
<text text-anchor="middle" x="1399" y="-8823.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_1_stage_4&#45;&gt;ring_attn_2_2_stage_4 -->
<g id="edge1653" class="edge">
<title>ring_attn_2_1_stage_4&#45;&gt;ring_attn_2_2_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-8850C1021.02,-8850 1179.86,-8850 1179.86,-8850"/>
<polygon fill="red" stroke="red" points="1179.86,-8853.5 1189.86,-8850 1179.86,-8846.5 1179.86,-8853.5"/>
</g>
<!-- ring_attn_2_1_stage_5&#45;&gt;ring_attn_2_1_stage_6 -->
<g id="edge154" class="edge">
<title>ring_attn_2_1_stage_5&#45;&gt;ring_attn_2_1_stage_6</title>
<path fill="none" stroke="black" d="M812,-8528.87C812,-8528.87 812,-8422.25 812,-8422.25"/>
<polygon fill="black" stroke="black" points="815.5,-8422.25 812,-8412.25 808.5,-8422.25 815.5,-8422.25"/>
</g>
<!-- ring_attn_2_2_stage_5 -->
<g id="node253" class="node">
<title>ring_attn_2_2_stage_5</title>
<polygon fill="yellow" stroke="black" points="1399,-8665 1190,-8597 1399,-8529 1608,-8597 1399,-8665"/>
<text text-anchor="middle" x="1399" y="-8615.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-8600.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="1399" y="-8585.8" font-family="Times,serif" font-size="14.00">Q[2]×K[13]×V[13]</text>
<text text-anchor="middle" x="1399" y="-8570.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_1_stage_5&#45;&gt;ring_attn_2_2_stage_5 -->
<g id="edge1654" class="edge">
<title>ring_attn_2_1_stage_5&#45;&gt;ring_attn_2_2_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-8597C1021.02,-8597 1179.86,-8597 1179.86,-8597"/>
<polygon fill="red" stroke="red" points="1179.86,-8600.5 1189.86,-8597 1179.86,-8593.5 1179.86,-8600.5"/>
</g>
<!-- ring_attn_2_1_stage_6&#45;&gt;ring_attn_2_1_stage_7 -->
<g id="edge155" class="edge">
<title>ring_attn_2_1_stage_6&#45;&gt;ring_attn_2_1_stage_7</title>
<path fill="none" stroke="black" d="M812,-8275.87C812,-8275.87 812,-8169.25 812,-8169.25"/>
<polygon fill="black" stroke="black" points="815.5,-8169.25 812,-8159.25 808.5,-8169.25 815.5,-8169.25"/>
</g>
<!-- ring_attn_2_2_stage_6 -->
<g id="node254" class="node">
<title>ring_attn_2_2_stage_6</title>
<polygon fill="yellow" stroke="black" points="1399,-8412 1190,-8344 1399,-8276 1608,-8344 1399,-8412"/>
<text text-anchor="middle" x="1399" y="-8362.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-8347.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="1399" y="-8332.8" font-family="Times,serif" font-size="14.00">Q[2]×K[12]×V[12]</text>
<text text-anchor="middle" x="1399" y="-8317.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_1_stage_6&#45;&gt;ring_attn_2_2_stage_6 -->
<g id="edge1655" class="edge">
<title>ring_attn_2_1_stage_6&#45;&gt;ring_attn_2_2_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-8344C1021.02,-8344 1179.86,-8344 1179.86,-8344"/>
<polygon fill="red" stroke="red" points="1179.86,-8347.5 1189.86,-8344 1179.86,-8340.5 1179.86,-8347.5"/>
</g>
<!-- ring_attn_2_1_stage_7&#45;&gt;ring_attn_2_1_stage_8 -->
<g id="edge156" class="edge">
<title>ring_attn_2_1_stage_7&#45;&gt;ring_attn_2_1_stage_8</title>
<path fill="none" stroke="black" d="M812,-8022.87C812,-8022.87 812,-7916.25 812,-7916.25"/>
<polygon fill="black" stroke="black" points="815.5,-7916.25 812,-7906.25 808.5,-7916.25 815.5,-7916.25"/>
</g>
<!-- ring_attn_2_2_stage_7 -->
<g id="node255" class="node">
<title>ring_attn_2_2_stage_7</title>
<polygon fill="yellow" stroke="black" points="1399,-8159 1190,-8091 1399,-8023 1608,-8091 1399,-8159"/>
<text text-anchor="middle" x="1399" y="-8109.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-8094.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="1399" y="-8079.8" font-family="Times,serif" font-size="14.00">Q[2]×K[11]×V[11]</text>
<text text-anchor="middle" x="1399" y="-8064.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_1_stage_7&#45;&gt;ring_attn_2_2_stage_7 -->
<g id="edge1656" class="edge">
<title>ring_attn_2_1_stage_7&#45;&gt;ring_attn_2_2_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-8091C1021.02,-8091 1179.86,-8091 1179.86,-8091"/>
<polygon fill="red" stroke="red" points="1179.86,-8094.5 1189.86,-8091 1179.86,-8087.5 1179.86,-8094.5"/>
</g>
<!-- ring_attn_2_1_stage_8&#45;&gt;ring_attn_2_1_stage_9 -->
<g id="edge157" class="edge">
<title>ring_attn_2_1_stage_8&#45;&gt;ring_attn_2_1_stage_9</title>
<path fill="none" stroke="black" d="M812,-7769.87C812,-7769.87 812,-7663.25 812,-7663.25"/>
<polygon fill="black" stroke="black" points="815.5,-7663.25 812,-7653.25 808.5,-7663.25 815.5,-7663.25"/>
</g>
<!-- ring_attn_2_2_stage_8 -->
<g id="node256" class="node">
<title>ring_attn_2_2_stage_8</title>
<polygon fill="yellow" stroke="black" points="1399,-7906 1190,-7838 1399,-7770 1608,-7838 1399,-7906"/>
<text text-anchor="middle" x="1399" y="-7856.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-7841.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="1399" y="-7826.8" font-family="Times,serif" font-size="14.00">Q[2]×K[10]×V[10]</text>
<text text-anchor="middle" x="1399" y="-7811.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_1_stage_8&#45;&gt;ring_attn_2_2_stage_8 -->
<g id="edge1657" class="edge">
<title>ring_attn_2_1_stage_8&#45;&gt;ring_attn_2_2_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-7838C1021.02,-7838 1179.86,-7838 1179.86,-7838"/>
<polygon fill="red" stroke="red" points="1179.86,-7841.5 1189.86,-7838 1179.86,-7834.5 1179.86,-7841.5"/>
</g>
<!-- ring_attn_2_1_stage_9&#45;&gt;ring_attn_2_1_stage_10 -->
<g id="edge158" class="edge">
<title>ring_attn_2_1_stage_9&#45;&gt;ring_attn_2_1_stage_10</title>
<path fill="none" stroke="black" d="M812,-7516.87C812,-7516.87 812,-7410.25 812,-7410.25"/>
<polygon fill="black" stroke="black" points="815.5,-7410.25 812,-7400.25 808.5,-7410.25 815.5,-7410.25"/>
</g>
<!-- ring_attn_2_2_stage_9 -->
<g id="node257" class="node">
<title>ring_attn_2_2_stage_9</title>
<polygon fill="yellow" stroke="black" points="1399,-7653 1190,-7585 1399,-7517 1608,-7585 1399,-7653"/>
<text text-anchor="middle" x="1399" y="-7603.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-7588.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="1399" y="-7573.8" font-family="Times,serif" font-size="14.00">Q[2]×K[9]×V[9]</text>
<text text-anchor="middle" x="1399" y="-7558.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_1_stage_9&#45;&gt;ring_attn_2_2_stage_9 -->
<g id="edge1658" class="edge">
<title>ring_attn_2_1_stage_9&#45;&gt;ring_attn_2_2_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-7585C1021.02,-7585 1179.86,-7585 1179.86,-7585"/>
<polygon fill="red" stroke="red" points="1179.86,-7588.5 1189.86,-7585 1179.86,-7581.5 1179.86,-7588.5"/>
</g>
<!-- ring_attn_2_1_stage_10&#45;&gt;ring_attn_2_1_stage_11 -->
<g id="edge159" class="edge">
<title>ring_attn_2_1_stage_10&#45;&gt;ring_attn_2_1_stage_11</title>
<path fill="none" stroke="black" d="M812,-7263.87C812,-7263.87 812,-7157.25 812,-7157.25"/>
<polygon fill="black" stroke="black" points="815.5,-7157.25 812,-7147.25 808.5,-7157.25 815.5,-7157.25"/>
</g>
<!-- ring_attn_2_2_stage_10 -->
<g id="node258" class="node">
<title>ring_attn_2_2_stage_10</title>
<polygon fill="yellow" stroke="black" points="1399,-7400 1190,-7332 1399,-7264 1608,-7332 1399,-7400"/>
<text text-anchor="middle" x="1399" y="-7350.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-7335.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="1399" y="-7320.8" font-family="Times,serif" font-size="14.00">Q[2]×K[8]×V[8]</text>
<text text-anchor="middle" x="1399" y="-7305.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_1_stage_10&#45;&gt;ring_attn_2_2_stage_10 -->
<g id="edge1659" class="edge">
<title>ring_attn_2_1_stage_10&#45;&gt;ring_attn_2_2_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-7332C1021.02,-7332 1179.86,-7332 1179.86,-7332"/>
<polygon fill="red" stroke="red" points="1179.86,-7335.5 1189.86,-7332 1179.86,-7328.5 1179.86,-7335.5"/>
</g>
<!-- ring_attn_2_1_stage_11&#45;&gt;ring_attn_2_1_stage_12 -->
<g id="edge160" class="edge">
<title>ring_attn_2_1_stage_11&#45;&gt;ring_attn_2_1_stage_12</title>
<path fill="none" stroke="black" d="M812,-7010.87C812,-7010.87 812,-6904.25 812,-6904.25"/>
<polygon fill="black" stroke="black" points="815.5,-6904.25 812,-6894.25 808.5,-6904.25 815.5,-6904.25"/>
</g>
<!-- ring_attn_2_2_stage_11 -->
<g id="node259" class="node">
<title>ring_attn_2_2_stage_11</title>
<polygon fill="yellow" stroke="black" points="1399,-7147 1190,-7079 1399,-7011 1608,-7079 1399,-7147"/>
<text text-anchor="middle" x="1399" y="-7097.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-7082.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="1399" y="-7067.8" font-family="Times,serif" font-size="14.00">Q[2]×K[7]×V[7]</text>
<text text-anchor="middle" x="1399" y="-7052.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_1_stage_11&#45;&gt;ring_attn_2_2_stage_11 -->
<g id="edge1660" class="edge">
<title>ring_attn_2_1_stage_11&#45;&gt;ring_attn_2_2_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-7079C1021.02,-7079 1179.86,-7079 1179.86,-7079"/>
<polygon fill="red" stroke="red" points="1179.86,-7082.5 1189.86,-7079 1179.86,-7075.5 1179.86,-7082.5"/>
</g>
<!-- ring_attn_2_1_stage_12&#45;&gt;ring_attn_2_1_stage_13 -->
<g id="edge161" class="edge">
<title>ring_attn_2_1_stage_12&#45;&gt;ring_attn_2_1_stage_13</title>
<path fill="none" stroke="black" d="M812,-6757.87C812,-6757.87 812,-6651.25 812,-6651.25"/>
<polygon fill="black" stroke="black" points="815.5,-6651.25 812,-6641.25 808.5,-6651.25 815.5,-6651.25"/>
</g>
<!-- ring_attn_2_2_stage_12 -->
<g id="node260" class="node">
<title>ring_attn_2_2_stage_12</title>
<polygon fill="yellow" stroke="black" points="1399,-6894 1190,-6826 1399,-6758 1608,-6826 1399,-6894"/>
<text text-anchor="middle" x="1399" y="-6844.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-6829.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="1399" y="-6814.8" font-family="Times,serif" font-size="14.00">Q[2]×K[6]×V[6]</text>
<text text-anchor="middle" x="1399" y="-6799.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_1_stage_12&#45;&gt;ring_attn_2_2_stage_12 -->
<g id="edge1661" class="edge">
<title>ring_attn_2_1_stage_12&#45;&gt;ring_attn_2_2_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-6826C1021.02,-6826 1179.86,-6826 1179.86,-6826"/>
<polygon fill="red" stroke="red" points="1179.86,-6829.5 1189.86,-6826 1179.86,-6822.5 1179.86,-6829.5"/>
</g>
<!-- ring_attn_2_1_stage_13&#45;&gt;ring_attn_2_1_stage_14 -->
<g id="edge162" class="edge">
<title>ring_attn_2_1_stage_13&#45;&gt;ring_attn_2_1_stage_14</title>
<path fill="none" stroke="black" d="M812,-6504.87C812,-6504.87 812,-6398.25 812,-6398.25"/>
<polygon fill="black" stroke="black" points="815.5,-6398.25 812,-6388.25 808.5,-6398.25 815.5,-6398.25"/>
</g>
<!-- ring_attn_2_2_stage_13 -->
<g id="node261" class="node">
<title>ring_attn_2_2_stage_13</title>
<polygon fill="yellow" stroke="black" points="1399,-6641 1190,-6573 1399,-6505 1608,-6573 1399,-6641"/>
<text text-anchor="middle" x="1399" y="-6591.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-6576.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="1399" y="-6561.8" font-family="Times,serif" font-size="14.00">Q[2]×K[5]×V[5]</text>
<text text-anchor="middle" x="1399" y="-6546.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_1_stage_13&#45;&gt;ring_attn_2_2_stage_13 -->
<g id="edge1662" class="edge">
<title>ring_attn_2_1_stage_13&#45;&gt;ring_attn_2_2_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-6573C1021.02,-6573 1179.86,-6573 1179.86,-6573"/>
<polygon fill="red" stroke="red" points="1179.86,-6576.5 1189.86,-6573 1179.86,-6569.5 1179.86,-6576.5"/>
</g>
<!-- ring_attn_2_1_stage_14&#45;&gt;ring_attn_2_1_stage_15 -->
<g id="edge163" class="edge">
<title>ring_attn_2_1_stage_14&#45;&gt;ring_attn_2_1_stage_15</title>
<path fill="none" stroke="black" d="M812,-6251.87C812,-6251.87 812,-6145.25 812,-6145.25"/>
<polygon fill="black" stroke="black" points="815.5,-6145.25 812,-6135.25 808.5,-6145.25 815.5,-6145.25"/>
</g>
<!-- ring_attn_2_2_stage_14 -->
<g id="node262" class="node">
<title>ring_attn_2_2_stage_14</title>
<polygon fill="yellow" stroke="black" points="1399,-6388 1190,-6320 1399,-6252 1608,-6320 1399,-6388"/>
<text text-anchor="middle" x="1399" y="-6338.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-6323.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="1399" y="-6308.8" font-family="Times,serif" font-size="14.00">Q[2]×K[4]×V[4]</text>
<text text-anchor="middle" x="1399" y="-6293.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_1_stage_14&#45;&gt;ring_attn_2_2_stage_14 -->
<g id="edge1663" class="edge">
<title>ring_attn_2_1_stage_14&#45;&gt;ring_attn_2_2_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-6320C1021.02,-6320 1179.86,-6320 1179.86,-6320"/>
<polygon fill="red" stroke="red" points="1179.86,-6323.5 1189.86,-6320 1179.86,-6316.5 1179.86,-6323.5"/>
</g>
<!-- attn_out_2_1 -->
<g id="node166" class="node">
<title>attn_out_2_1</title>
<polygon fill="none" stroke="black" points="881.5,-5926 742.5,-5926 742.5,-5873 881.5,-5873 881.5,-5926"/>
<text text-anchor="middle" x="812" y="-5910.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="812" y="-5895.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="812" y="-5880.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_2_1_stage_15&#45;&gt;attn_out_2_1 -->
<g id="edge164" class="edge">
<title>ring_attn_2_1_stage_15&#45;&gt;attn_out_2_1</title>
<path fill="none" stroke="black" d="M812,-5998.87C812,-5998.87 812,-5936.18 812,-5936.18"/>
<polygon fill="black" stroke="black" points="815.5,-5936.18 812,-5926.18 808.5,-5936.18 815.5,-5936.18"/>
</g>
<!-- ring_attn_2_2_stage_15 -->
<g id="node263" class="node">
<title>ring_attn_2_2_stage_15</title>
<polygon fill="yellow" stroke="black" points="1399,-6135 1190,-6067 1399,-5999 1608,-6067 1399,-6135"/>
<text text-anchor="middle" x="1399" y="-6085.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-6070.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="1399" y="-6055.8" font-family="Times,serif" font-size="14.00">Q[2]×K[3]×V[3]</text>
<text text-anchor="middle" x="1399" y="-6040.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_1_stage_15&#45;&gt;ring_attn_2_2_stage_15 -->
<g id="edge1664" class="edge">
<title>ring_attn_2_1_stage_15&#45;&gt;ring_attn_2_2_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-6067C1021.02,-6067 1179.86,-6067 1179.86,-6067"/>
<polygon fill="red" stroke="red" points="1179.86,-6070.5 1189.86,-6067 1179.86,-6063.5 1179.86,-6070.5"/>
</g>
<!-- attn_residual_2_1 -->
<g id="node167" class="node">
<title>attn_residual_2_1</title>
<ellipse fill="none" stroke="black" cx="812" cy="-5773" rx="105.5" ry="27"/>
<text text-anchor="middle" x="812" y="-5776.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="812" y="-5761.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_2_1&#45;&gt;attn_residual_2_1 -->
<g id="edge165" class="edge">
<title>attn_out_2_1&#45;&gt;attn_residual_2_1</title>
<path fill="none" stroke="black" d="M812,-5872.98C812,-5872.98 812,-5810.36 812,-5810.36"/>
<polygon fill="black" stroke="black" points="815.5,-5810.36 812,-5800.36 808.5,-5810.36 815.5,-5810.36"/>
</g>
<!-- ffn_up_2_1 -->
<g id="node168" class="node">
<title>ffn_up_2_1</title>
<polygon fill="none" stroke="black" points="891,-5673 733,-5673 733,-5620 891,-5620 891,-5673"/>
<text text-anchor="middle" x="812" y="-5657.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="812" y="-5642.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="812" y="-5627.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_2_1&#45;&gt;ffn_up_2_1 -->
<g id="edge166" class="edge">
<title>attn_residual_2_1&#45;&gt;ffn_up_2_1</title>
<path fill="none" stroke="black" d="M812,-5745.86C812,-5745.86 812,-5683.16 812,-5683.16"/>
<polygon fill="black" stroke="black" points="815.5,-5683.16 812,-5673.16 808.5,-5683.16 815.5,-5683.16"/>
</g>
<!-- ffn_gelu_2_1 -->
<g id="node169" class="node">
<title>ffn_gelu_2_1</title>
<ellipse fill="none" stroke="black" cx="812" cy="-5520" rx="105.5" ry="27"/>
<text text-anchor="middle" x="812" y="-5523.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="812" y="-5508.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_2_1&#45;&gt;ffn_gelu_2_1 -->
<g id="edge167" class="edge">
<title>ffn_up_2_1&#45;&gt;ffn_gelu_2_1</title>
<path fill="none" stroke="black" d="M812,-5619.98C812,-5619.98 812,-5557.36 812,-5557.36"/>
<polygon fill="black" stroke="black" points="815.5,-5557.36 812,-5547.36 808.5,-5557.36 815.5,-5557.36"/>
</g>
<!-- ffn_down_2_1 -->
<g id="node170" class="node">
<title>ffn_down_2_1</title>
<polygon fill="none" stroke="black" points="901,-5420 723,-5420 723,-5367 901,-5367 901,-5420"/>
<text text-anchor="middle" x="812" y="-5404.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="812" y="-5389.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="812" y="-5374.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_2_1&#45;&gt;ffn_down_2_1 -->
<g id="edge168" class="edge">
<title>ffn_gelu_2_1&#45;&gt;ffn_down_2_1</title>
<path fill="none" stroke="black" d="M812,-5492.86C812,-5492.86 812,-5430.16 812,-5430.16"/>
<polygon fill="black" stroke="black" points="815.5,-5430.16 812,-5420.16 808.5,-5430.16 815.5,-5430.16"/>
</g>
<!-- ffn_residual_2_1 -->
<g id="node171" class="node">
<title>ffn_residual_2_1</title>
<ellipse fill="none" stroke="black" cx="812" cy="-5267" rx="105.5" ry="27"/>
<text text-anchor="middle" x="812" y="-5270.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="812" y="-5255.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_2_1&#45;&gt;ffn_residual_2_1 -->
<g id="edge169" class="edge">
<title>ffn_down_2_1&#45;&gt;ffn_residual_2_1</title>
<path fill="none" stroke="black" d="M812,-5366.98C812,-5366.98 812,-5304.36 812,-5304.36"/>
<polygon fill="black" stroke="black" points="815.5,-5304.36 812,-5294.36 808.5,-5304.36 815.5,-5304.36"/>
</g>
<!-- qkv_proj_3_1 -->
<g id="node172" class="node">
<title>qkv_proj_3_1</title>
<polygon fill="none" stroke="black" points="894.5,-5167 729.5,-5167 729.5,-5114 894.5,-5114 894.5,-5167"/>
<text text-anchor="middle" x="812" y="-5151.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="812" y="-5136.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="812" y="-5121.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_2_1&#45;&gt;qkv_proj_3_1 -->
<g id="edge170" class="edge">
<title>ffn_residual_2_1&#45;&gt;qkv_proj_3_1</title>
<path fill="none" stroke="black" d="M812,-5239.86C812,-5239.86 812,-5177.16 812,-5177.16"/>
<polygon fill="black" stroke="black" points="815.5,-5177.16 812,-5167.16 808.5,-5177.16 815.5,-5177.16"/>
</g>
<!-- qkv_reshape_3_1 -->
<g id="node173" class="node">
<title>qkv_reshape_3_1</title>
<ellipse fill="none" stroke="black" cx="812" cy="-5014" rx="148" ry="27"/>
<text text-anchor="middle" x="812" y="-5017.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="812" y="-5002.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_3_1&#45;&gt;qkv_reshape_3_1 -->
<g id="edge171" class="edge">
<title>qkv_proj_3_1&#45;&gt;qkv_reshape_3_1</title>
<path fill="none" stroke="black" d="M812,-5113.98C812,-5113.98 812,-5051.36 812,-5051.36"/>
<polygon fill="black" stroke="black" points="815.5,-5051.36 812,-5041.36 808.5,-5051.36 815.5,-5051.36"/>
</g>
<!-- qkv_reshape_3_1&#45;&gt;ring_attn_3_1_stage_0 -->
<g id="edge172" class="edge">
<title>qkv_reshape_3_1&#45;&gt;ring_attn_3_1_stage_0</title>
<path fill="none" stroke="black" d="M812,-4986.72C812,-4986.72 812,-4880.16 812,-4880.16"/>
<polygon fill="black" stroke="black" points="815.5,-4880.16 812,-4870.16 808.5,-4880.16 815.5,-4880.16"/>
</g>
<!-- ring_attn_3_1_stage_0&#45;&gt;ring_attn_3_1_stage_1 -->
<g id="edge173" class="edge">
<title>ring_attn_3_1_stage_0&#45;&gt;ring_attn_3_1_stage_1</title>
<path fill="none" stroke="black" d="M812,-4733.87C812,-4733.87 812,-4627.25 812,-4627.25"/>
<polygon fill="black" stroke="black" points="815.5,-4627.25 812,-4617.25 808.5,-4627.25 815.5,-4627.25"/>
</g>
<!-- ring_attn_3_2_stage_0 -->
<g id="node272" class="node">
<title>ring_attn_3_2_stage_0</title>
<polygon fill="yellow" stroke="black" points="1399,-4870 1190,-4802 1399,-4734 1608,-4802 1399,-4870"/>
<text text-anchor="middle" x="1399" y="-4820.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-4805.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="1399" y="-4790.8" font-family="Times,serif" font-size="14.00">Q[2]×K[2]×V[2]</text>
<text text-anchor="middle" x="1399" y="-4775.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_1_stage_0&#45;&gt;ring_attn_3_2_stage_0 -->
<g id="edge1665" class="edge">
<title>ring_attn_3_1_stage_0&#45;&gt;ring_attn_3_2_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-4802C1021.02,-4802 1179.86,-4802 1179.86,-4802"/>
<polygon fill="red" stroke="red" points="1179.86,-4805.5 1189.86,-4802 1179.86,-4798.5 1179.86,-4805.5"/>
</g>
<!-- ring_attn_3_1_stage_1&#45;&gt;ring_attn_3_1_stage_2 -->
<g id="edge174" class="edge">
<title>ring_attn_3_1_stage_1&#45;&gt;ring_attn_3_1_stage_2</title>
<path fill="none" stroke="black" d="M812,-4480.87C812,-4480.87 812,-4374.25 812,-4374.25"/>
<polygon fill="black" stroke="black" points="815.5,-4374.25 812,-4364.25 808.5,-4374.25 815.5,-4374.25"/>
</g>
<!-- ring_attn_3_2_stage_1 -->
<g id="node273" class="node">
<title>ring_attn_3_2_stage_1</title>
<polygon fill="yellow" stroke="black" points="1399,-4617 1190,-4549 1399,-4481 1608,-4549 1399,-4617"/>
<text text-anchor="middle" x="1399" y="-4567.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-4552.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="1399" y="-4537.8" font-family="Times,serif" font-size="14.00">Q[2]×K[1]×V[1]</text>
<text text-anchor="middle" x="1399" y="-4522.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_1_stage_1&#45;&gt;ring_attn_3_2_stage_1 -->
<g id="edge1666" class="edge">
<title>ring_attn_3_1_stage_1&#45;&gt;ring_attn_3_2_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-4549C1021.02,-4549 1179.86,-4549 1179.86,-4549"/>
<polygon fill="red" stroke="red" points="1179.86,-4552.5 1189.86,-4549 1179.86,-4545.5 1179.86,-4552.5"/>
</g>
<!-- ring_attn_3_1_stage_2&#45;&gt;ring_attn_3_1_stage_3 -->
<g id="edge175" class="edge">
<title>ring_attn_3_1_stage_2&#45;&gt;ring_attn_3_1_stage_3</title>
<path fill="none" stroke="black" d="M812,-4227.87C812,-4227.87 812,-4121.25 812,-4121.25"/>
<polygon fill="black" stroke="black" points="815.5,-4121.25 812,-4111.25 808.5,-4121.25 815.5,-4121.25"/>
</g>
<!-- ring_attn_3_2_stage_2 -->
<g id="node274" class="node">
<title>ring_attn_3_2_stage_2</title>
<polygon fill="yellow" stroke="black" points="1399,-4364 1190,-4296 1399,-4228 1608,-4296 1399,-4364"/>
<text text-anchor="middle" x="1399" y="-4314.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-4299.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="1399" y="-4284.8" font-family="Times,serif" font-size="14.00">Q[2]×K[0]×V[0]</text>
<text text-anchor="middle" x="1399" y="-4269.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_1_stage_2&#45;&gt;ring_attn_3_2_stage_2 -->
<g id="edge1667" class="edge">
<title>ring_attn_3_1_stage_2&#45;&gt;ring_attn_3_2_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-4296C1021.02,-4296 1179.86,-4296 1179.86,-4296"/>
<polygon fill="red" stroke="red" points="1179.86,-4299.5 1189.86,-4296 1179.86,-4292.5 1179.86,-4299.5"/>
</g>
<!-- ring_attn_3_1_stage_3&#45;&gt;ring_attn_3_1_stage_4 -->
<g id="edge176" class="edge">
<title>ring_attn_3_1_stage_3&#45;&gt;ring_attn_3_1_stage_4</title>
<path fill="none" stroke="black" d="M812,-3974.87C812,-3974.87 812,-3868.25 812,-3868.25"/>
<polygon fill="black" stroke="black" points="815.5,-3868.25 812,-3858.25 808.5,-3868.25 815.5,-3868.25"/>
</g>
<!-- ring_attn_3_2_stage_3 -->
<g id="node275" class="node">
<title>ring_attn_3_2_stage_3</title>
<polygon fill="yellow" stroke="black" points="1399,-4111 1190,-4043 1399,-3975 1608,-4043 1399,-4111"/>
<text text-anchor="middle" x="1399" y="-4061.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-4046.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="1399" y="-4031.8" font-family="Times,serif" font-size="14.00">Q[2]×K[15]×V[15]</text>
<text text-anchor="middle" x="1399" y="-4016.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_1_stage_3&#45;&gt;ring_attn_3_2_stage_3 -->
<g id="edge1668" class="edge">
<title>ring_attn_3_1_stage_3&#45;&gt;ring_attn_3_2_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-4043C1021.02,-4043 1179.86,-4043 1179.86,-4043"/>
<polygon fill="red" stroke="red" points="1179.86,-4046.5 1189.86,-4043 1179.86,-4039.5 1179.86,-4046.5"/>
</g>
<!-- ring_attn_3_1_stage_4&#45;&gt;ring_attn_3_1_stage_5 -->
<g id="edge177" class="edge">
<title>ring_attn_3_1_stage_4&#45;&gt;ring_attn_3_1_stage_5</title>
<path fill="none" stroke="black" d="M812,-3721.87C812,-3721.87 812,-3615.25 812,-3615.25"/>
<polygon fill="black" stroke="black" points="815.5,-3615.25 812,-3605.25 808.5,-3615.25 815.5,-3615.25"/>
</g>
<!-- ring_attn_3_2_stage_4 -->
<g id="node276" class="node">
<title>ring_attn_3_2_stage_4</title>
<polygon fill="yellow" stroke="black" points="1399,-3858 1190,-3790 1399,-3722 1608,-3790 1399,-3858"/>
<text text-anchor="middle" x="1399" y="-3808.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-3793.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="1399" y="-3778.8" font-family="Times,serif" font-size="14.00">Q[2]×K[14]×V[14]</text>
<text text-anchor="middle" x="1399" y="-3763.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_1_stage_4&#45;&gt;ring_attn_3_2_stage_4 -->
<g id="edge1669" class="edge">
<title>ring_attn_3_1_stage_4&#45;&gt;ring_attn_3_2_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-3790C1021.02,-3790 1179.86,-3790 1179.86,-3790"/>
<polygon fill="red" stroke="red" points="1179.86,-3793.5 1189.86,-3790 1179.86,-3786.5 1179.86,-3793.5"/>
</g>
<!-- ring_attn_3_1_stage_5&#45;&gt;ring_attn_3_1_stage_6 -->
<g id="edge178" class="edge">
<title>ring_attn_3_1_stage_5&#45;&gt;ring_attn_3_1_stage_6</title>
<path fill="none" stroke="black" d="M812,-3468.87C812,-3468.87 812,-3362.25 812,-3362.25"/>
<polygon fill="black" stroke="black" points="815.5,-3362.25 812,-3352.25 808.5,-3362.25 815.5,-3362.25"/>
</g>
<!-- ring_attn_3_2_stage_5 -->
<g id="node277" class="node">
<title>ring_attn_3_2_stage_5</title>
<polygon fill="yellow" stroke="black" points="1399,-3605 1190,-3537 1399,-3469 1608,-3537 1399,-3605"/>
<text text-anchor="middle" x="1399" y="-3555.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-3540.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="1399" y="-3525.8" font-family="Times,serif" font-size="14.00">Q[2]×K[13]×V[13]</text>
<text text-anchor="middle" x="1399" y="-3510.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_1_stage_5&#45;&gt;ring_attn_3_2_stage_5 -->
<g id="edge1670" class="edge">
<title>ring_attn_3_1_stage_5&#45;&gt;ring_attn_3_2_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-3537C1021.02,-3537 1179.86,-3537 1179.86,-3537"/>
<polygon fill="red" stroke="red" points="1179.86,-3540.5 1189.86,-3537 1179.86,-3533.5 1179.86,-3540.5"/>
</g>
<!-- ring_attn_3_1_stage_6&#45;&gt;ring_attn_3_1_stage_7 -->
<g id="edge179" class="edge">
<title>ring_attn_3_1_stage_6&#45;&gt;ring_attn_3_1_stage_7</title>
<path fill="none" stroke="black" d="M812,-3215.87C812,-3215.87 812,-3109.25 812,-3109.25"/>
<polygon fill="black" stroke="black" points="815.5,-3109.25 812,-3099.25 808.5,-3109.25 815.5,-3109.25"/>
</g>
<!-- ring_attn_3_2_stage_6 -->
<g id="node278" class="node">
<title>ring_attn_3_2_stage_6</title>
<polygon fill="yellow" stroke="black" points="1399,-3352 1190,-3284 1399,-3216 1608,-3284 1399,-3352"/>
<text text-anchor="middle" x="1399" y="-3302.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-3287.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="1399" y="-3272.8" font-family="Times,serif" font-size="14.00">Q[2]×K[12]×V[12]</text>
<text text-anchor="middle" x="1399" y="-3257.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_1_stage_6&#45;&gt;ring_attn_3_2_stage_6 -->
<g id="edge1671" class="edge">
<title>ring_attn_3_1_stage_6&#45;&gt;ring_attn_3_2_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-3284C1021.02,-3284 1179.86,-3284 1179.86,-3284"/>
<polygon fill="red" stroke="red" points="1179.86,-3287.5 1189.86,-3284 1179.86,-3280.5 1179.86,-3287.5"/>
</g>
<!-- ring_attn_3_1_stage_7&#45;&gt;ring_attn_3_1_stage_8 -->
<g id="edge180" class="edge">
<title>ring_attn_3_1_stage_7&#45;&gt;ring_attn_3_1_stage_8</title>
<path fill="none" stroke="black" d="M812,-2962.87C812,-2962.87 812,-2856.25 812,-2856.25"/>
<polygon fill="black" stroke="black" points="815.5,-2856.25 812,-2846.25 808.5,-2856.25 815.5,-2856.25"/>
</g>
<!-- ring_attn_3_2_stage_7 -->
<g id="node279" class="node">
<title>ring_attn_3_2_stage_7</title>
<polygon fill="yellow" stroke="black" points="1399,-3099 1190,-3031 1399,-2963 1608,-3031 1399,-3099"/>
<text text-anchor="middle" x="1399" y="-3049.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-3034.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="1399" y="-3019.8" font-family="Times,serif" font-size="14.00">Q[2]×K[11]×V[11]</text>
<text text-anchor="middle" x="1399" y="-3004.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_1_stage_7&#45;&gt;ring_attn_3_2_stage_7 -->
<g id="edge1672" class="edge">
<title>ring_attn_3_1_stage_7&#45;&gt;ring_attn_3_2_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-3031C1021.02,-3031 1179.86,-3031 1179.86,-3031"/>
<polygon fill="red" stroke="red" points="1179.86,-3034.5 1189.86,-3031 1179.86,-3027.5 1179.86,-3034.5"/>
</g>
<!-- ring_attn_3_1_stage_8&#45;&gt;ring_attn_3_1_stage_9 -->
<g id="edge181" class="edge">
<title>ring_attn_3_1_stage_8&#45;&gt;ring_attn_3_1_stage_9</title>
<path fill="none" stroke="black" d="M812,-2709.87C812,-2709.87 812,-2603.25 812,-2603.25"/>
<polygon fill="black" stroke="black" points="815.5,-2603.25 812,-2593.25 808.5,-2603.25 815.5,-2603.25"/>
</g>
<!-- ring_attn_3_2_stage_8 -->
<g id="node280" class="node">
<title>ring_attn_3_2_stage_8</title>
<polygon fill="yellow" stroke="black" points="1399,-2846 1190,-2778 1399,-2710 1608,-2778 1399,-2846"/>
<text text-anchor="middle" x="1399" y="-2796.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-2781.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="1399" y="-2766.8" font-family="Times,serif" font-size="14.00">Q[2]×K[10]×V[10]</text>
<text text-anchor="middle" x="1399" y="-2751.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_1_stage_8&#45;&gt;ring_attn_3_2_stage_8 -->
<g id="edge1673" class="edge">
<title>ring_attn_3_1_stage_8&#45;&gt;ring_attn_3_2_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-2778C1021.02,-2778 1179.86,-2778 1179.86,-2778"/>
<polygon fill="red" stroke="red" points="1179.86,-2781.5 1189.86,-2778 1179.86,-2774.5 1179.86,-2781.5"/>
</g>
<!-- ring_attn_3_1_stage_9&#45;&gt;ring_attn_3_1_stage_10 -->
<g id="edge182" class="edge">
<title>ring_attn_3_1_stage_9&#45;&gt;ring_attn_3_1_stage_10</title>
<path fill="none" stroke="black" d="M812,-2456.87C812,-2456.87 812,-2350.25 812,-2350.25"/>
<polygon fill="black" stroke="black" points="815.5,-2350.25 812,-2340.25 808.5,-2350.25 815.5,-2350.25"/>
</g>
<!-- ring_attn_3_2_stage_9 -->
<g id="node281" class="node">
<title>ring_attn_3_2_stage_9</title>
<polygon fill="yellow" stroke="black" points="1399,-2593 1190,-2525 1399,-2457 1608,-2525 1399,-2593"/>
<text text-anchor="middle" x="1399" y="-2543.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-2528.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="1399" y="-2513.8" font-family="Times,serif" font-size="14.00">Q[2]×K[9]×V[9]</text>
<text text-anchor="middle" x="1399" y="-2498.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_1_stage_9&#45;&gt;ring_attn_3_2_stage_9 -->
<g id="edge1674" class="edge">
<title>ring_attn_3_1_stage_9&#45;&gt;ring_attn_3_2_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-2525C1021.02,-2525 1179.86,-2525 1179.86,-2525"/>
<polygon fill="red" stroke="red" points="1179.86,-2528.5 1189.86,-2525 1179.86,-2521.5 1179.86,-2528.5"/>
</g>
<!-- ring_attn_3_1_stage_10&#45;&gt;ring_attn_3_1_stage_11 -->
<g id="edge183" class="edge">
<title>ring_attn_3_1_stage_10&#45;&gt;ring_attn_3_1_stage_11</title>
<path fill="none" stroke="black" d="M812,-2203.87C812,-2203.87 812,-2097.25 812,-2097.25"/>
<polygon fill="black" stroke="black" points="815.5,-2097.25 812,-2087.25 808.5,-2097.25 815.5,-2097.25"/>
</g>
<!-- ring_attn_3_2_stage_10 -->
<g id="node282" class="node">
<title>ring_attn_3_2_stage_10</title>
<polygon fill="yellow" stroke="black" points="1399,-2340 1190,-2272 1399,-2204 1608,-2272 1399,-2340"/>
<text text-anchor="middle" x="1399" y="-2290.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-2275.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="1399" y="-2260.8" font-family="Times,serif" font-size="14.00">Q[2]×K[8]×V[8]</text>
<text text-anchor="middle" x="1399" y="-2245.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_1_stage_10&#45;&gt;ring_attn_3_2_stage_10 -->
<g id="edge1675" class="edge">
<title>ring_attn_3_1_stage_10&#45;&gt;ring_attn_3_2_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-2272C1021.02,-2272 1179.86,-2272 1179.86,-2272"/>
<polygon fill="red" stroke="red" points="1179.86,-2275.5 1189.86,-2272 1179.86,-2268.5 1179.86,-2275.5"/>
</g>
<!-- ring_attn_3_1_stage_11&#45;&gt;ring_attn_3_1_stage_12 -->
<g id="edge184" class="edge">
<title>ring_attn_3_1_stage_11&#45;&gt;ring_attn_3_1_stage_12</title>
<path fill="none" stroke="black" d="M812,-1950.87C812,-1950.87 812,-1844.25 812,-1844.25"/>
<polygon fill="black" stroke="black" points="815.5,-1844.25 812,-1834.25 808.5,-1844.25 815.5,-1844.25"/>
</g>
<!-- ring_attn_3_2_stage_11 -->
<g id="node283" class="node">
<title>ring_attn_3_2_stage_11</title>
<polygon fill="yellow" stroke="black" points="1399,-2087 1190,-2019 1399,-1951 1608,-2019 1399,-2087"/>
<text text-anchor="middle" x="1399" y="-2037.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-2022.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="1399" y="-2007.8" font-family="Times,serif" font-size="14.00">Q[2]×K[7]×V[7]</text>
<text text-anchor="middle" x="1399" y="-1992.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_1_stage_11&#45;&gt;ring_attn_3_2_stage_11 -->
<g id="edge1676" class="edge">
<title>ring_attn_3_1_stage_11&#45;&gt;ring_attn_3_2_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-2019C1021.02,-2019 1179.86,-2019 1179.86,-2019"/>
<polygon fill="red" stroke="red" points="1179.86,-2022.5 1189.86,-2019 1179.86,-2015.5 1179.86,-2022.5"/>
</g>
<!-- ring_attn_3_1_stage_12&#45;&gt;ring_attn_3_1_stage_13 -->
<g id="edge185" class="edge">
<title>ring_attn_3_1_stage_12&#45;&gt;ring_attn_3_1_stage_13</title>
<path fill="none" stroke="black" d="M812,-1697.87C812,-1697.87 812,-1591.25 812,-1591.25"/>
<polygon fill="black" stroke="black" points="815.5,-1591.25 812,-1581.25 808.5,-1591.25 815.5,-1591.25"/>
</g>
<!-- ring_attn_3_2_stage_12 -->
<g id="node284" class="node">
<title>ring_attn_3_2_stage_12</title>
<polygon fill="yellow" stroke="black" points="1399,-1834 1190,-1766 1399,-1698 1608,-1766 1399,-1834"/>
<text text-anchor="middle" x="1399" y="-1784.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-1769.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="1399" y="-1754.8" font-family="Times,serif" font-size="14.00">Q[2]×K[6]×V[6]</text>
<text text-anchor="middle" x="1399" y="-1739.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_1_stage_12&#45;&gt;ring_attn_3_2_stage_12 -->
<g id="edge1677" class="edge">
<title>ring_attn_3_1_stage_12&#45;&gt;ring_attn_3_2_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-1766C1021.02,-1766 1179.86,-1766 1179.86,-1766"/>
<polygon fill="red" stroke="red" points="1179.86,-1769.5 1189.86,-1766 1179.86,-1762.5 1179.86,-1769.5"/>
</g>
<!-- ring_attn_3_1_stage_13&#45;&gt;ring_attn_3_1_stage_14 -->
<g id="edge186" class="edge">
<title>ring_attn_3_1_stage_13&#45;&gt;ring_attn_3_1_stage_14</title>
<path fill="none" stroke="black" d="M812,-1444.87C812,-1444.87 812,-1338.25 812,-1338.25"/>
<polygon fill="black" stroke="black" points="815.5,-1338.25 812,-1328.25 808.5,-1338.25 815.5,-1338.25"/>
</g>
<!-- ring_attn_3_2_stage_13 -->
<g id="node285" class="node">
<title>ring_attn_3_2_stage_13</title>
<polygon fill="yellow" stroke="black" points="1399,-1581 1190,-1513 1399,-1445 1608,-1513 1399,-1581"/>
<text text-anchor="middle" x="1399" y="-1531.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-1516.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="1399" y="-1501.8" font-family="Times,serif" font-size="14.00">Q[2]×K[5]×V[5]</text>
<text text-anchor="middle" x="1399" y="-1486.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_1_stage_13&#45;&gt;ring_attn_3_2_stage_13 -->
<g id="edge1678" class="edge">
<title>ring_attn_3_1_stage_13&#45;&gt;ring_attn_3_2_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-1513C1021.02,-1513 1179.86,-1513 1179.86,-1513"/>
<polygon fill="red" stroke="red" points="1179.86,-1516.5 1189.86,-1513 1179.86,-1509.5 1179.86,-1516.5"/>
</g>
<!-- ring_attn_3_1_stage_14&#45;&gt;ring_attn_3_1_stage_15 -->
<g id="edge187" class="edge">
<title>ring_attn_3_1_stage_14&#45;&gt;ring_attn_3_1_stage_15</title>
<path fill="none" stroke="black" d="M812,-1191.87C812,-1191.87 812,-1085.25 812,-1085.25"/>
<polygon fill="black" stroke="black" points="815.5,-1085.25 812,-1075.25 808.5,-1085.25 815.5,-1085.25"/>
</g>
<!-- ring_attn_3_2_stage_14 -->
<g id="node286" class="node">
<title>ring_attn_3_2_stage_14</title>
<polygon fill="yellow" stroke="black" points="1399,-1328 1190,-1260 1399,-1192 1608,-1260 1399,-1328"/>
<text text-anchor="middle" x="1399" y="-1278.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-1263.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="1399" y="-1248.8" font-family="Times,serif" font-size="14.00">Q[2]×K[4]×V[4]</text>
<text text-anchor="middle" x="1399" y="-1233.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_1_stage_14&#45;&gt;ring_attn_3_2_stage_14 -->
<g id="edge1679" class="edge">
<title>ring_attn_3_1_stage_14&#45;&gt;ring_attn_3_2_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-1260C1021.02,-1260 1179.86,-1260 1179.86,-1260"/>
<polygon fill="red" stroke="red" points="1179.86,-1263.5 1189.86,-1260 1179.86,-1256.5 1179.86,-1263.5"/>
</g>
<!-- attn_out_3_1 -->
<g id="node190" class="node">
<title>attn_out_3_1</title>
<polygon fill="none" stroke="black" points="881.5,-866 742.5,-866 742.5,-813 881.5,-813 881.5,-866"/>
<text text-anchor="middle" x="812" y="-850.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="812" y="-835.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="812" y="-820.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_3_1_stage_15&#45;&gt;attn_out_3_1 -->
<g id="edge188" class="edge">
<title>ring_attn_3_1_stage_15&#45;&gt;attn_out_3_1</title>
<path fill="none" stroke="black" d="M812,-938.87C812,-938.87 812,-876.18 812,-876.18"/>
<polygon fill="black" stroke="black" points="815.5,-876.18 812,-866.18 808.5,-876.18 815.5,-876.18"/>
</g>
<!-- ring_attn_3_2_stage_15 -->
<g id="node287" class="node">
<title>ring_attn_3_2_stage_15</title>
<polygon fill="yellow" stroke="black" points="1399,-1075 1190,-1007 1399,-939 1608,-1007 1399,-1075"/>
<text text-anchor="middle" x="1399" y="-1025.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1399" y="-1010.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="1399" y="-995.8" font-family="Times,serif" font-size="14.00">Q[2]×K[3]×V[3]</text>
<text text-anchor="middle" x="1399" y="-980.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_1_stage_15&#45;&gt;ring_attn_3_2_stage_15 -->
<g id="edge1680" class="edge">
<title>ring_attn_3_1_stage_15&#45;&gt;ring_attn_3_2_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1021.02,-1007C1021.02,-1007 1179.86,-1007 1179.86,-1007"/>
<polygon fill="red" stroke="red" points="1179.86,-1010.5 1189.86,-1007 1179.86,-1003.5 1179.86,-1010.5"/>
</g>
<!-- attn_residual_3_1 -->
<g id="node191" class="node">
<title>attn_residual_3_1</title>
<ellipse fill="none" stroke="black" cx="812" cy="-713" rx="105.5" ry="27"/>
<text text-anchor="middle" x="812" y="-716.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="812" y="-701.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_3_1&#45;&gt;attn_residual_3_1 -->
<g id="edge189" class="edge">
<title>attn_out_3_1&#45;&gt;attn_residual_3_1</title>
<path fill="none" stroke="black" d="M812,-812.98C812,-812.98 812,-750.36 812,-750.36"/>
<polygon fill="black" stroke="black" points="815.5,-750.36 812,-740.36 808.5,-750.36 815.5,-750.36"/>
</g>
<!-- ffn_up_3_1 -->
<g id="node192" class="node">
<title>ffn_up_3_1</title>
<polygon fill="none" stroke="black" points="891,-613 733,-613 733,-560 891,-560 891,-613"/>
<text text-anchor="middle" x="812" y="-597.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="812" y="-582.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="812" y="-567.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_3_1&#45;&gt;ffn_up_3_1 -->
<g id="edge190" class="edge">
<title>attn_residual_3_1&#45;&gt;ffn_up_3_1</title>
<path fill="none" stroke="black" d="M812,-685.86C812,-685.86 812,-623.16 812,-623.16"/>
<polygon fill="black" stroke="black" points="815.5,-623.16 812,-613.16 808.5,-623.16 815.5,-623.16"/>
</g>
<!-- ffn_gelu_3_1 -->
<g id="node193" class="node">
<title>ffn_gelu_3_1</title>
<ellipse fill="none" stroke="black" cx="812" cy="-460" rx="105.5" ry="27"/>
<text text-anchor="middle" x="812" y="-463.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="812" y="-448.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_3_1&#45;&gt;ffn_gelu_3_1 -->
<g id="edge191" class="edge">
<title>ffn_up_3_1&#45;&gt;ffn_gelu_3_1</title>
<path fill="none" stroke="black" d="M812,-559.98C812,-559.98 812,-497.36 812,-497.36"/>
<polygon fill="black" stroke="black" points="815.5,-497.36 812,-487.36 808.5,-497.36 815.5,-497.36"/>
</g>
<!-- ffn_down_3_1 -->
<g id="node194" class="node">
<title>ffn_down_3_1</title>
<polygon fill="none" stroke="black" points="901,-360 723,-360 723,-307 901,-307 901,-360"/>
<text text-anchor="middle" x="812" y="-344.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="812" y="-329.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="812" y="-314.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_3_1&#45;&gt;ffn_down_3_1 -->
<g id="edge192" class="edge">
<title>ffn_gelu_3_1&#45;&gt;ffn_down_3_1</title>
<path fill="none" stroke="black" d="M812,-432.86C812,-432.86 812,-370.16 812,-370.16"/>
<polygon fill="black" stroke="black" points="815.5,-370.16 812,-360.16 808.5,-370.16 815.5,-370.16"/>
</g>
<!-- ffn_residual_3_1 -->
<g id="node195" class="node">
<title>ffn_residual_3_1</title>
<ellipse fill="none" stroke="black" cx="812" cy="-207" rx="105.5" ry="27"/>
<text text-anchor="middle" x="812" y="-210.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="812" y="-195.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_3_1&#45;&gt;ffn_residual_3_1 -->
<g id="edge193" class="edge">
<title>ffn_down_3_1&#45;&gt;ffn_residual_3_1</title>
<path fill="none" stroke="black" d="M812,-306.98C812,-306.98 812,-244.36 812,-244.36"/>
<polygon fill="black" stroke="black" points="815.5,-244.36 812,-234.36 808.5,-244.36 815.5,-244.36"/>
</g>
<!-- output_1 -->
<g id="node196" class="node">
<title>output_1</title>
<polygon fill="lightcoral" stroke="black" points="905,-107 719,-107 719,-69 905,-69 905,-107"/>
<text text-anchor="middle" x="812" y="-91.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="812" y="-76.8" font-family="Times,serif" font-size="14.00">Y[1]: 1024×1024×4096</text>
</g>
<!-- ffn_residual_3_1&#45;&gt;output_1 -->
<g id="edge194" class="edge">
<title>ffn_residual_3_1&#45;&gt;output_1</title>
<path fill="none" stroke="black" d="M812,-180C812,-180 812,-117.12 812,-117.12"/>
<polygon fill="black" stroke="black" points="815.5,-117.12 812,-107.12 808.5,-117.12 815.5,-117.12"/>
</g>
<!-- input_2 -->
<g id="node197" class="node">
<title>input_2</title>
<polygon fill="lightgreen" stroke="black" points="1492.5,-20458 1305.5,-20458 1305.5,-20420 1492.5,-20420 1492.5,-20458"/>
<text text-anchor="middle" x="1399" y="-20442.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1399" y="-20427.8" font-family="Times,serif" font-size="14.00">X[2]: 1024×1024×4096</text>
</g>
<!-- qkv_proj_0_2 -->
<g id="node198" class="node">
<title>qkv_proj_0_2</title>
<polygon fill="none" stroke="black" points="1481.5,-20347 1316.5,-20347 1316.5,-20294 1481.5,-20294 1481.5,-20347"/>
<text text-anchor="middle" x="1399" y="-20331.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1399" y="-20316.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="1399" y="-20301.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- input_2&#45;&gt;qkv_proj_0_2 -->
<g id="edge195" class="edge">
<title>input_2&#45;&gt;qkv_proj_0_2</title>
<path fill="none" stroke="black" d="M1399,-20419.96C1399,-20419.96 1399,-20357.44 1399,-20357.44"/>
<polygon fill="black" stroke="black" points="1402.5,-20357.44 1399,-20347.44 1395.5,-20357.44 1402.5,-20357.44"/>
</g>
<!-- qkv_reshape_0_2 -->
<g id="node199" class="node">
<title>qkv_reshape_0_2</title>
<ellipse fill="none" stroke="black" cx="1399" cy="-20194" rx="148" ry="27"/>
<text text-anchor="middle" x="1399" y="-20197.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1399" y="-20182.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_0_2&#45;&gt;qkv_reshape_0_2 -->
<g id="edge196" class="edge">
<title>qkv_proj_0_2&#45;&gt;qkv_reshape_0_2</title>
<path fill="none" stroke="black" d="M1399,-20293.98C1399,-20293.98 1399,-20231.36 1399,-20231.36"/>
<polygon fill="black" stroke="black" points="1402.5,-20231.36 1399,-20221.36 1395.5,-20231.36 1402.5,-20231.36"/>
</g>
<!-- qkv_reshape_0_2&#45;&gt;ring_attn_0_2_stage_0 -->
<g id="edge197" class="edge">
<title>qkv_reshape_0_2&#45;&gt;ring_attn_0_2_stage_0</title>
<path fill="none" stroke="black" d="M1399,-20166.72C1399,-20166.72 1399,-20060.16 1399,-20060.16"/>
<polygon fill="black" stroke="black" points="1402.5,-20060.16 1399,-20050.16 1395.5,-20060.16 1402.5,-20060.16"/>
</g>
<!-- ring_attn_0_2_stage_0&#45;&gt;ring_attn_0_2_stage_1 -->
<g id="edge198" class="edge">
<title>ring_attn_0_2_stage_0&#45;&gt;ring_attn_0_2_stage_1</title>
<path fill="none" stroke="black" d="M1399,-19913.87C1399,-19913.87 1399,-19807.25 1399,-19807.25"/>
<polygon fill="black" stroke="black" points="1402.5,-19807.25 1399,-19797.25 1395.5,-19807.25 1402.5,-19807.25"/>
</g>
<!-- ring_attn_0_3_stage_0 -->
<g id="node298" class="node">
<title>ring_attn_0_3_stage_0</title>
<polygon fill="yellow" stroke="black" points="1986,-20050 1777,-19982 1986,-19914 2195,-19982 1986,-20050"/>
<text text-anchor="middle" x="1986" y="-20000.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-19985.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="1986" y="-19970.8" font-family="Times,serif" font-size="14.00">Q[3]×K[3]×V[3]</text>
<text text-anchor="middle" x="1986" y="-19955.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_2_stage_0&#45;&gt;ring_attn_0_3_stage_0 -->
<g id="edge1681" class="edge">
<title>ring_attn_0_2_stage_0&#45;&gt;ring_attn_0_3_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-19982C1608.02,-19982 1766.86,-19982 1766.86,-19982"/>
<polygon fill="red" stroke="red" points="1766.86,-19985.5 1776.86,-19982 1766.86,-19978.5 1766.86,-19985.5"/>
</g>
<!-- ring_attn_0_2_stage_1&#45;&gt;ring_attn_0_2_stage_2 -->
<g id="edge199" class="edge">
<title>ring_attn_0_2_stage_1&#45;&gt;ring_attn_0_2_stage_2</title>
<path fill="none" stroke="black" d="M1399,-19660.87C1399,-19660.87 1399,-19554.25 1399,-19554.25"/>
<polygon fill="black" stroke="black" points="1402.5,-19554.25 1399,-19544.25 1395.5,-19554.25 1402.5,-19554.25"/>
</g>
<!-- ring_attn_0_3_stage_1 -->
<g id="node299" class="node">
<title>ring_attn_0_3_stage_1</title>
<polygon fill="yellow" stroke="black" points="1986,-19797 1777,-19729 1986,-19661 2195,-19729 1986,-19797"/>
<text text-anchor="middle" x="1986" y="-19747.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-19732.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="1986" y="-19717.8" font-family="Times,serif" font-size="14.00">Q[3]×K[2]×V[2]</text>
<text text-anchor="middle" x="1986" y="-19702.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_2_stage_1&#45;&gt;ring_attn_0_3_stage_1 -->
<g id="edge1682" class="edge">
<title>ring_attn_0_2_stage_1&#45;&gt;ring_attn_0_3_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-19729C1608.02,-19729 1766.86,-19729 1766.86,-19729"/>
<polygon fill="red" stroke="red" points="1766.86,-19732.5 1776.86,-19729 1766.86,-19725.5 1766.86,-19732.5"/>
</g>
<!-- ring_attn_0_2_stage_2&#45;&gt;ring_attn_0_2_stage_3 -->
<g id="edge200" class="edge">
<title>ring_attn_0_2_stage_2&#45;&gt;ring_attn_0_2_stage_3</title>
<path fill="none" stroke="black" d="M1399,-19407.87C1399,-19407.87 1399,-19301.25 1399,-19301.25"/>
<polygon fill="black" stroke="black" points="1402.5,-19301.25 1399,-19291.25 1395.5,-19301.25 1402.5,-19301.25"/>
</g>
<!-- ring_attn_0_3_stage_2 -->
<g id="node300" class="node">
<title>ring_attn_0_3_stage_2</title>
<polygon fill="yellow" stroke="black" points="1986,-19544 1777,-19476 1986,-19408 2195,-19476 1986,-19544"/>
<text text-anchor="middle" x="1986" y="-19494.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-19479.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="1986" y="-19464.8" font-family="Times,serif" font-size="14.00">Q[3]×K[1]×V[1]</text>
<text text-anchor="middle" x="1986" y="-19449.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_2_stage_2&#45;&gt;ring_attn_0_3_stage_2 -->
<g id="edge1683" class="edge">
<title>ring_attn_0_2_stage_2&#45;&gt;ring_attn_0_3_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-19476C1608.02,-19476 1766.86,-19476 1766.86,-19476"/>
<polygon fill="red" stroke="red" points="1766.86,-19479.5 1776.86,-19476 1766.86,-19472.5 1766.86,-19479.5"/>
</g>
<!-- ring_attn_0_2_stage_3&#45;&gt;ring_attn_0_2_stage_4 -->
<g id="edge201" class="edge">
<title>ring_attn_0_2_stage_3&#45;&gt;ring_attn_0_2_stage_4</title>
<path fill="none" stroke="black" d="M1399,-19154.87C1399,-19154.87 1399,-19048.25 1399,-19048.25"/>
<polygon fill="black" stroke="black" points="1402.5,-19048.25 1399,-19038.25 1395.5,-19048.25 1402.5,-19048.25"/>
</g>
<!-- ring_attn_0_3_stage_3 -->
<g id="node301" class="node">
<title>ring_attn_0_3_stage_3</title>
<polygon fill="yellow" stroke="black" points="1986,-19291 1777,-19223 1986,-19155 2195,-19223 1986,-19291"/>
<text text-anchor="middle" x="1986" y="-19241.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-19226.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="1986" y="-19211.8" font-family="Times,serif" font-size="14.00">Q[3]×K[0]×V[0]</text>
<text text-anchor="middle" x="1986" y="-19196.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_2_stage_3&#45;&gt;ring_attn_0_3_stage_3 -->
<g id="edge1684" class="edge">
<title>ring_attn_0_2_stage_3&#45;&gt;ring_attn_0_3_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-19223C1608.02,-19223 1766.86,-19223 1766.86,-19223"/>
<polygon fill="red" stroke="red" points="1766.86,-19226.5 1776.86,-19223 1766.86,-19219.5 1766.86,-19226.5"/>
</g>
<!-- ring_attn_0_2_stage_4&#45;&gt;ring_attn_0_2_stage_5 -->
<g id="edge202" class="edge">
<title>ring_attn_0_2_stage_4&#45;&gt;ring_attn_0_2_stage_5</title>
<path fill="none" stroke="black" d="M1399,-18901.87C1399,-18901.87 1399,-18795.25 1399,-18795.25"/>
<polygon fill="black" stroke="black" points="1402.5,-18795.25 1399,-18785.25 1395.5,-18795.25 1402.5,-18795.25"/>
</g>
<!-- ring_attn_0_3_stage_4 -->
<g id="node302" class="node">
<title>ring_attn_0_3_stage_4</title>
<polygon fill="yellow" stroke="black" points="1986,-19038 1777,-18970 1986,-18902 2195,-18970 1986,-19038"/>
<text text-anchor="middle" x="1986" y="-18988.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-18973.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="1986" y="-18958.8" font-family="Times,serif" font-size="14.00">Q[3]×K[15]×V[15]</text>
<text text-anchor="middle" x="1986" y="-18943.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_2_stage_4&#45;&gt;ring_attn_0_3_stage_4 -->
<g id="edge1685" class="edge">
<title>ring_attn_0_2_stage_4&#45;&gt;ring_attn_0_3_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-18970C1608.02,-18970 1766.86,-18970 1766.86,-18970"/>
<polygon fill="red" stroke="red" points="1766.86,-18973.5 1776.86,-18970 1766.86,-18966.5 1766.86,-18973.5"/>
</g>
<!-- ring_attn_0_2_stage_5&#45;&gt;ring_attn_0_2_stage_6 -->
<g id="edge203" class="edge">
<title>ring_attn_0_2_stage_5&#45;&gt;ring_attn_0_2_stage_6</title>
<path fill="none" stroke="black" d="M1399,-18648.87C1399,-18648.87 1399,-18542.25 1399,-18542.25"/>
<polygon fill="black" stroke="black" points="1402.5,-18542.25 1399,-18532.25 1395.5,-18542.25 1402.5,-18542.25"/>
</g>
<!-- ring_attn_0_3_stage_5 -->
<g id="node303" class="node">
<title>ring_attn_0_3_stage_5</title>
<polygon fill="yellow" stroke="black" points="1986,-18785 1777,-18717 1986,-18649 2195,-18717 1986,-18785"/>
<text text-anchor="middle" x="1986" y="-18735.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-18720.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="1986" y="-18705.8" font-family="Times,serif" font-size="14.00">Q[3]×K[14]×V[14]</text>
<text text-anchor="middle" x="1986" y="-18690.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_2_stage_5&#45;&gt;ring_attn_0_3_stage_5 -->
<g id="edge1686" class="edge">
<title>ring_attn_0_2_stage_5&#45;&gt;ring_attn_0_3_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-18717C1608.02,-18717 1766.86,-18717 1766.86,-18717"/>
<polygon fill="red" stroke="red" points="1766.86,-18720.5 1776.86,-18717 1766.86,-18713.5 1766.86,-18720.5"/>
</g>
<!-- ring_attn_0_2_stage_6&#45;&gt;ring_attn_0_2_stage_7 -->
<g id="edge204" class="edge">
<title>ring_attn_0_2_stage_6&#45;&gt;ring_attn_0_2_stage_7</title>
<path fill="none" stroke="black" d="M1399,-18395.87C1399,-18395.87 1399,-18289.25 1399,-18289.25"/>
<polygon fill="black" stroke="black" points="1402.5,-18289.25 1399,-18279.25 1395.5,-18289.25 1402.5,-18289.25"/>
</g>
<!-- ring_attn_0_3_stage_6 -->
<g id="node304" class="node">
<title>ring_attn_0_3_stage_6</title>
<polygon fill="yellow" stroke="black" points="1986,-18532 1777,-18464 1986,-18396 2195,-18464 1986,-18532"/>
<text text-anchor="middle" x="1986" y="-18482.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-18467.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="1986" y="-18452.8" font-family="Times,serif" font-size="14.00">Q[3]×K[13]×V[13]</text>
<text text-anchor="middle" x="1986" y="-18437.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_2_stage_6&#45;&gt;ring_attn_0_3_stage_6 -->
<g id="edge1687" class="edge">
<title>ring_attn_0_2_stage_6&#45;&gt;ring_attn_0_3_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-18464C1608.02,-18464 1766.86,-18464 1766.86,-18464"/>
<polygon fill="red" stroke="red" points="1766.86,-18467.5 1776.86,-18464 1766.86,-18460.5 1766.86,-18467.5"/>
</g>
<!-- ring_attn_0_2_stage_7&#45;&gt;ring_attn_0_2_stage_8 -->
<g id="edge205" class="edge">
<title>ring_attn_0_2_stage_7&#45;&gt;ring_attn_0_2_stage_8</title>
<path fill="none" stroke="black" d="M1399,-18142.87C1399,-18142.87 1399,-18036.25 1399,-18036.25"/>
<polygon fill="black" stroke="black" points="1402.5,-18036.25 1399,-18026.25 1395.5,-18036.25 1402.5,-18036.25"/>
</g>
<!-- ring_attn_0_3_stage_7 -->
<g id="node305" class="node">
<title>ring_attn_0_3_stage_7</title>
<polygon fill="yellow" stroke="black" points="1986,-18279 1777,-18211 1986,-18143 2195,-18211 1986,-18279"/>
<text text-anchor="middle" x="1986" y="-18229.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-18214.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="1986" y="-18199.8" font-family="Times,serif" font-size="14.00">Q[3]×K[12]×V[12]</text>
<text text-anchor="middle" x="1986" y="-18184.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_2_stage_7&#45;&gt;ring_attn_0_3_stage_7 -->
<g id="edge1688" class="edge">
<title>ring_attn_0_2_stage_7&#45;&gt;ring_attn_0_3_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-18211C1608.02,-18211 1766.86,-18211 1766.86,-18211"/>
<polygon fill="red" stroke="red" points="1766.86,-18214.5 1776.86,-18211 1766.86,-18207.5 1766.86,-18214.5"/>
</g>
<!-- ring_attn_0_2_stage_8&#45;&gt;ring_attn_0_2_stage_9 -->
<g id="edge206" class="edge">
<title>ring_attn_0_2_stage_8&#45;&gt;ring_attn_0_2_stage_9</title>
<path fill="none" stroke="black" d="M1399,-17889.87C1399,-17889.87 1399,-17783.25 1399,-17783.25"/>
<polygon fill="black" stroke="black" points="1402.5,-17783.25 1399,-17773.25 1395.5,-17783.25 1402.5,-17783.25"/>
</g>
<!-- ring_attn_0_3_stage_8 -->
<g id="node306" class="node">
<title>ring_attn_0_3_stage_8</title>
<polygon fill="yellow" stroke="black" points="1986,-18026 1777,-17958 1986,-17890 2195,-17958 1986,-18026"/>
<text text-anchor="middle" x="1986" y="-17976.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-17961.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="1986" y="-17946.8" font-family="Times,serif" font-size="14.00">Q[3]×K[11]×V[11]</text>
<text text-anchor="middle" x="1986" y="-17931.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_2_stage_8&#45;&gt;ring_attn_0_3_stage_8 -->
<g id="edge1689" class="edge">
<title>ring_attn_0_2_stage_8&#45;&gt;ring_attn_0_3_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-17958C1608.02,-17958 1766.86,-17958 1766.86,-17958"/>
<polygon fill="red" stroke="red" points="1766.86,-17961.5 1776.86,-17958 1766.86,-17954.5 1766.86,-17961.5"/>
</g>
<!-- ring_attn_0_2_stage_9&#45;&gt;ring_attn_0_2_stage_10 -->
<g id="edge207" class="edge">
<title>ring_attn_0_2_stage_9&#45;&gt;ring_attn_0_2_stage_10</title>
<path fill="none" stroke="black" d="M1399,-17636.87C1399,-17636.87 1399,-17530.25 1399,-17530.25"/>
<polygon fill="black" stroke="black" points="1402.5,-17530.25 1399,-17520.25 1395.5,-17530.25 1402.5,-17530.25"/>
</g>
<!-- ring_attn_0_3_stage_9 -->
<g id="node307" class="node">
<title>ring_attn_0_3_stage_9</title>
<polygon fill="yellow" stroke="black" points="1986,-17773 1777,-17705 1986,-17637 2195,-17705 1986,-17773"/>
<text text-anchor="middle" x="1986" y="-17723.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-17708.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="1986" y="-17693.8" font-family="Times,serif" font-size="14.00">Q[3]×K[10]×V[10]</text>
<text text-anchor="middle" x="1986" y="-17678.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_2_stage_9&#45;&gt;ring_attn_0_3_stage_9 -->
<g id="edge1690" class="edge">
<title>ring_attn_0_2_stage_9&#45;&gt;ring_attn_0_3_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-17705C1608.02,-17705 1766.86,-17705 1766.86,-17705"/>
<polygon fill="red" stroke="red" points="1766.86,-17708.5 1776.86,-17705 1766.86,-17701.5 1766.86,-17708.5"/>
</g>
<!-- ring_attn_0_2_stage_10&#45;&gt;ring_attn_0_2_stage_11 -->
<g id="edge208" class="edge">
<title>ring_attn_0_2_stage_10&#45;&gt;ring_attn_0_2_stage_11</title>
<path fill="none" stroke="black" d="M1399,-17383.87C1399,-17383.87 1399,-17277.25 1399,-17277.25"/>
<polygon fill="black" stroke="black" points="1402.5,-17277.25 1399,-17267.25 1395.5,-17277.25 1402.5,-17277.25"/>
</g>
<!-- ring_attn_0_3_stage_10 -->
<g id="node308" class="node">
<title>ring_attn_0_3_stage_10</title>
<polygon fill="yellow" stroke="black" points="1986,-17520 1777,-17452 1986,-17384 2195,-17452 1986,-17520"/>
<text text-anchor="middle" x="1986" y="-17470.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-17455.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="1986" y="-17440.8" font-family="Times,serif" font-size="14.00">Q[3]×K[9]×V[9]</text>
<text text-anchor="middle" x="1986" y="-17425.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_2_stage_10&#45;&gt;ring_attn_0_3_stage_10 -->
<g id="edge1691" class="edge">
<title>ring_attn_0_2_stage_10&#45;&gt;ring_attn_0_3_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-17452C1608.02,-17452 1766.86,-17452 1766.86,-17452"/>
<polygon fill="red" stroke="red" points="1766.86,-17455.5 1776.86,-17452 1766.86,-17448.5 1766.86,-17455.5"/>
</g>
<!-- ring_attn_0_2_stage_11&#45;&gt;ring_attn_0_2_stage_12 -->
<g id="edge209" class="edge">
<title>ring_attn_0_2_stage_11&#45;&gt;ring_attn_0_2_stage_12</title>
<path fill="none" stroke="black" d="M1399,-17130.87C1399,-17130.87 1399,-17024.25 1399,-17024.25"/>
<polygon fill="black" stroke="black" points="1402.5,-17024.25 1399,-17014.25 1395.5,-17024.25 1402.5,-17024.25"/>
</g>
<!-- ring_attn_0_3_stage_11 -->
<g id="node309" class="node">
<title>ring_attn_0_3_stage_11</title>
<polygon fill="yellow" stroke="black" points="1986,-17267 1777,-17199 1986,-17131 2195,-17199 1986,-17267"/>
<text text-anchor="middle" x="1986" y="-17217.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-17202.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="1986" y="-17187.8" font-family="Times,serif" font-size="14.00">Q[3]×K[8]×V[8]</text>
<text text-anchor="middle" x="1986" y="-17172.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_2_stage_11&#45;&gt;ring_attn_0_3_stage_11 -->
<g id="edge1692" class="edge">
<title>ring_attn_0_2_stage_11&#45;&gt;ring_attn_0_3_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-17199C1608.02,-17199 1766.86,-17199 1766.86,-17199"/>
<polygon fill="red" stroke="red" points="1766.86,-17202.5 1776.86,-17199 1766.86,-17195.5 1766.86,-17202.5"/>
</g>
<!-- ring_attn_0_2_stage_12&#45;&gt;ring_attn_0_2_stage_13 -->
<g id="edge210" class="edge">
<title>ring_attn_0_2_stage_12&#45;&gt;ring_attn_0_2_stage_13</title>
<path fill="none" stroke="black" d="M1399,-16877.87C1399,-16877.87 1399,-16771.25 1399,-16771.25"/>
<polygon fill="black" stroke="black" points="1402.5,-16771.25 1399,-16761.25 1395.5,-16771.25 1402.5,-16771.25"/>
</g>
<!-- ring_attn_0_3_stage_12 -->
<g id="node310" class="node">
<title>ring_attn_0_3_stage_12</title>
<polygon fill="yellow" stroke="black" points="1986,-17014 1777,-16946 1986,-16878 2195,-16946 1986,-17014"/>
<text text-anchor="middle" x="1986" y="-16964.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-16949.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="1986" y="-16934.8" font-family="Times,serif" font-size="14.00">Q[3]×K[7]×V[7]</text>
<text text-anchor="middle" x="1986" y="-16919.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_2_stage_12&#45;&gt;ring_attn_0_3_stage_12 -->
<g id="edge1693" class="edge">
<title>ring_attn_0_2_stage_12&#45;&gt;ring_attn_0_3_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-16946C1608.02,-16946 1766.86,-16946 1766.86,-16946"/>
<polygon fill="red" stroke="red" points="1766.86,-16949.5 1776.86,-16946 1766.86,-16942.5 1766.86,-16949.5"/>
</g>
<!-- ring_attn_0_2_stage_13&#45;&gt;ring_attn_0_2_stage_14 -->
<g id="edge211" class="edge">
<title>ring_attn_0_2_stage_13&#45;&gt;ring_attn_0_2_stage_14</title>
<path fill="none" stroke="black" d="M1399,-16624.87C1399,-16624.87 1399,-16518.25 1399,-16518.25"/>
<polygon fill="black" stroke="black" points="1402.5,-16518.25 1399,-16508.25 1395.5,-16518.25 1402.5,-16518.25"/>
</g>
<!-- ring_attn_0_3_stage_13 -->
<g id="node311" class="node">
<title>ring_attn_0_3_stage_13</title>
<polygon fill="yellow" stroke="black" points="1986,-16761 1777,-16693 1986,-16625 2195,-16693 1986,-16761"/>
<text text-anchor="middle" x="1986" y="-16711.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-16696.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="1986" y="-16681.8" font-family="Times,serif" font-size="14.00">Q[3]×K[6]×V[6]</text>
<text text-anchor="middle" x="1986" y="-16666.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_2_stage_13&#45;&gt;ring_attn_0_3_stage_13 -->
<g id="edge1694" class="edge">
<title>ring_attn_0_2_stage_13&#45;&gt;ring_attn_0_3_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-16693C1608.02,-16693 1766.86,-16693 1766.86,-16693"/>
<polygon fill="red" stroke="red" points="1766.86,-16696.5 1776.86,-16693 1766.86,-16689.5 1766.86,-16696.5"/>
</g>
<!-- ring_attn_0_2_stage_14&#45;&gt;ring_attn_0_2_stage_15 -->
<g id="edge212" class="edge">
<title>ring_attn_0_2_stage_14&#45;&gt;ring_attn_0_2_stage_15</title>
<path fill="none" stroke="black" d="M1399,-16371.87C1399,-16371.87 1399,-16265.25 1399,-16265.25"/>
<polygon fill="black" stroke="black" points="1402.5,-16265.25 1399,-16255.25 1395.5,-16265.25 1402.5,-16265.25"/>
</g>
<!-- ring_attn_0_3_stage_14 -->
<g id="node312" class="node">
<title>ring_attn_0_3_stage_14</title>
<polygon fill="yellow" stroke="black" points="1986,-16508 1777,-16440 1986,-16372 2195,-16440 1986,-16508"/>
<text text-anchor="middle" x="1986" y="-16458.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-16443.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="1986" y="-16428.8" font-family="Times,serif" font-size="14.00">Q[3]×K[5]×V[5]</text>
<text text-anchor="middle" x="1986" y="-16413.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_2_stage_14&#45;&gt;ring_attn_0_3_stage_14 -->
<g id="edge1695" class="edge">
<title>ring_attn_0_2_stage_14&#45;&gt;ring_attn_0_3_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-16440C1608.02,-16440 1766.86,-16440 1766.86,-16440"/>
<polygon fill="red" stroke="red" points="1766.86,-16443.5 1776.86,-16440 1766.86,-16436.5 1766.86,-16443.5"/>
</g>
<!-- attn_out_0_2 -->
<g id="node216" class="node">
<title>attn_out_0_2</title>
<polygon fill="none" stroke="black" points="1468.5,-16046 1329.5,-16046 1329.5,-15993 1468.5,-15993 1468.5,-16046"/>
<text text-anchor="middle" x="1399" y="-16030.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1399" y="-16015.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="1399" y="-16000.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_0_2_stage_15&#45;&gt;attn_out_0_2 -->
<g id="edge213" class="edge">
<title>ring_attn_0_2_stage_15&#45;&gt;attn_out_0_2</title>
<path fill="none" stroke="black" d="M1399,-16118.87C1399,-16118.87 1399,-16056.18 1399,-16056.18"/>
<polygon fill="black" stroke="black" points="1402.5,-16056.18 1399,-16046.18 1395.5,-16056.18 1402.5,-16056.18"/>
</g>
<!-- ring_attn_0_3_stage_15 -->
<g id="node313" class="node">
<title>ring_attn_0_3_stage_15</title>
<polygon fill="yellow" stroke="black" points="1986,-16255 1777,-16187 1986,-16119 2195,-16187 1986,-16255"/>
<text text-anchor="middle" x="1986" y="-16205.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-16190.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="1986" y="-16175.8" font-family="Times,serif" font-size="14.00">Q[3]×K[4]×V[4]</text>
<text text-anchor="middle" x="1986" y="-16160.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_2_stage_15&#45;&gt;ring_attn_0_3_stage_15 -->
<g id="edge1696" class="edge">
<title>ring_attn_0_2_stage_15&#45;&gt;ring_attn_0_3_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-16187C1608.02,-16187 1766.86,-16187 1766.86,-16187"/>
<polygon fill="red" stroke="red" points="1766.86,-16190.5 1776.86,-16187 1766.86,-16183.5 1766.86,-16190.5"/>
</g>
<!-- attn_residual_0_2 -->
<g id="node217" class="node">
<title>attn_residual_0_2</title>
<ellipse fill="none" stroke="black" cx="1399" cy="-15893" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1399" y="-15896.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1399" y="-15881.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_0_2&#45;&gt;attn_residual_0_2 -->
<g id="edge214" class="edge">
<title>attn_out_0_2&#45;&gt;attn_residual_0_2</title>
<path fill="none" stroke="black" d="M1399,-15992.98C1399,-15992.98 1399,-15930.36 1399,-15930.36"/>
<polygon fill="black" stroke="black" points="1402.5,-15930.36 1399,-15920.36 1395.5,-15930.36 1402.5,-15930.36"/>
</g>
<!-- ffn_up_0_2 -->
<g id="node218" class="node">
<title>ffn_up_0_2</title>
<polygon fill="none" stroke="black" points="1478,-15793 1320,-15793 1320,-15740 1478,-15740 1478,-15793"/>
<text text-anchor="middle" x="1399" y="-15777.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1399" y="-15762.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="1399" y="-15747.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_0_2&#45;&gt;ffn_up_0_2 -->
<g id="edge215" class="edge">
<title>attn_residual_0_2&#45;&gt;ffn_up_0_2</title>
<path fill="none" stroke="black" d="M1399,-15865.86C1399,-15865.86 1399,-15803.16 1399,-15803.16"/>
<polygon fill="black" stroke="black" points="1402.5,-15803.16 1399,-15793.16 1395.5,-15803.16 1402.5,-15803.16"/>
</g>
<!-- ffn_gelu_0_2 -->
<g id="node219" class="node">
<title>ffn_gelu_0_2</title>
<ellipse fill="none" stroke="black" cx="1399" cy="-15640" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1399" y="-15643.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1399" y="-15628.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_0_2&#45;&gt;ffn_gelu_0_2 -->
<g id="edge216" class="edge">
<title>ffn_up_0_2&#45;&gt;ffn_gelu_0_2</title>
<path fill="none" stroke="black" d="M1399,-15739.98C1399,-15739.98 1399,-15677.36 1399,-15677.36"/>
<polygon fill="black" stroke="black" points="1402.5,-15677.36 1399,-15667.36 1395.5,-15677.36 1402.5,-15677.36"/>
</g>
<!-- ffn_down_0_2 -->
<g id="node220" class="node">
<title>ffn_down_0_2</title>
<polygon fill="none" stroke="black" points="1488,-15540 1310,-15540 1310,-15487 1488,-15487 1488,-15540"/>
<text text-anchor="middle" x="1399" y="-15524.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1399" y="-15509.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="1399" y="-15494.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_0_2&#45;&gt;ffn_down_0_2 -->
<g id="edge217" class="edge">
<title>ffn_gelu_0_2&#45;&gt;ffn_down_0_2</title>
<path fill="none" stroke="black" d="M1399,-15612.86C1399,-15612.86 1399,-15550.16 1399,-15550.16"/>
<polygon fill="black" stroke="black" points="1402.5,-15550.16 1399,-15540.16 1395.5,-15550.16 1402.5,-15550.16"/>
</g>
<!-- ffn_residual_0_2 -->
<g id="node221" class="node">
<title>ffn_residual_0_2</title>
<ellipse fill="none" stroke="black" cx="1399" cy="-15387" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1399" y="-15390.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1399" y="-15375.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_0_2&#45;&gt;ffn_residual_0_2 -->
<g id="edge218" class="edge">
<title>ffn_down_0_2&#45;&gt;ffn_residual_0_2</title>
<path fill="none" stroke="black" d="M1399,-15486.98C1399,-15486.98 1399,-15424.36 1399,-15424.36"/>
<polygon fill="black" stroke="black" points="1402.5,-15424.36 1399,-15414.36 1395.5,-15424.36 1402.5,-15424.36"/>
</g>
<!-- qkv_proj_1_2 -->
<g id="node222" class="node">
<title>qkv_proj_1_2</title>
<polygon fill="none" stroke="black" points="1481.5,-15287 1316.5,-15287 1316.5,-15234 1481.5,-15234 1481.5,-15287"/>
<text text-anchor="middle" x="1399" y="-15271.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1399" y="-15256.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="1399" y="-15241.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_0_2&#45;&gt;qkv_proj_1_2 -->
<g id="edge219" class="edge">
<title>ffn_residual_0_2&#45;&gt;qkv_proj_1_2</title>
<path fill="none" stroke="black" d="M1399,-15359.86C1399,-15359.86 1399,-15297.16 1399,-15297.16"/>
<polygon fill="black" stroke="black" points="1402.5,-15297.16 1399,-15287.16 1395.5,-15297.16 1402.5,-15297.16"/>
</g>
<!-- qkv_reshape_1_2 -->
<g id="node223" class="node">
<title>qkv_reshape_1_2</title>
<ellipse fill="none" stroke="black" cx="1399" cy="-15134" rx="148" ry="27"/>
<text text-anchor="middle" x="1399" y="-15137.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1399" y="-15122.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_1_2&#45;&gt;qkv_reshape_1_2 -->
<g id="edge220" class="edge">
<title>qkv_proj_1_2&#45;&gt;qkv_reshape_1_2</title>
<path fill="none" stroke="black" d="M1399,-15233.98C1399,-15233.98 1399,-15171.36 1399,-15171.36"/>
<polygon fill="black" stroke="black" points="1402.5,-15171.36 1399,-15161.36 1395.5,-15171.36 1402.5,-15171.36"/>
</g>
<!-- qkv_reshape_1_2&#45;&gt;ring_attn_1_2_stage_0 -->
<g id="edge221" class="edge">
<title>qkv_reshape_1_2&#45;&gt;ring_attn_1_2_stage_0</title>
<path fill="none" stroke="black" d="M1399,-15106.72C1399,-15106.72 1399,-15000.16 1399,-15000.16"/>
<polygon fill="black" stroke="black" points="1402.5,-15000.16 1399,-14990.16 1395.5,-15000.16 1402.5,-15000.16"/>
</g>
<!-- ring_attn_1_2_stage_0&#45;&gt;ring_attn_1_2_stage_1 -->
<g id="edge222" class="edge">
<title>ring_attn_1_2_stage_0&#45;&gt;ring_attn_1_2_stage_1</title>
<path fill="none" stroke="black" d="M1399,-14853.87C1399,-14853.87 1399,-14747.25 1399,-14747.25"/>
<polygon fill="black" stroke="black" points="1402.5,-14747.25 1399,-14737.25 1395.5,-14747.25 1402.5,-14747.25"/>
</g>
<!-- ring_attn_1_3_stage_0 -->
<g id="node322" class="node">
<title>ring_attn_1_3_stage_0</title>
<polygon fill="yellow" stroke="black" points="1986,-14990 1777,-14922 1986,-14854 2195,-14922 1986,-14990"/>
<text text-anchor="middle" x="1986" y="-14940.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-14925.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="1986" y="-14910.8" font-family="Times,serif" font-size="14.00">Q[3]×K[3]×V[3]</text>
<text text-anchor="middle" x="1986" y="-14895.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_2_stage_0&#45;&gt;ring_attn_1_3_stage_0 -->
<g id="edge1697" class="edge">
<title>ring_attn_1_2_stage_0&#45;&gt;ring_attn_1_3_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-14922C1608.02,-14922 1766.86,-14922 1766.86,-14922"/>
<polygon fill="red" stroke="red" points="1766.86,-14925.5 1776.86,-14922 1766.86,-14918.5 1766.86,-14925.5"/>
</g>
<!-- ring_attn_1_2_stage_1&#45;&gt;ring_attn_1_2_stage_2 -->
<g id="edge223" class="edge">
<title>ring_attn_1_2_stage_1&#45;&gt;ring_attn_1_2_stage_2</title>
<path fill="none" stroke="black" d="M1399,-14600.87C1399,-14600.87 1399,-14494.25 1399,-14494.25"/>
<polygon fill="black" stroke="black" points="1402.5,-14494.25 1399,-14484.25 1395.5,-14494.25 1402.5,-14494.25"/>
</g>
<!-- ring_attn_1_3_stage_1 -->
<g id="node323" class="node">
<title>ring_attn_1_3_stage_1</title>
<polygon fill="yellow" stroke="black" points="1986,-14737 1777,-14669 1986,-14601 2195,-14669 1986,-14737"/>
<text text-anchor="middle" x="1986" y="-14687.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-14672.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="1986" y="-14657.8" font-family="Times,serif" font-size="14.00">Q[3]×K[2]×V[2]</text>
<text text-anchor="middle" x="1986" y="-14642.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_2_stage_1&#45;&gt;ring_attn_1_3_stage_1 -->
<g id="edge1698" class="edge">
<title>ring_attn_1_2_stage_1&#45;&gt;ring_attn_1_3_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-14669C1608.02,-14669 1766.86,-14669 1766.86,-14669"/>
<polygon fill="red" stroke="red" points="1766.86,-14672.5 1776.86,-14669 1766.86,-14665.5 1766.86,-14672.5"/>
</g>
<!-- ring_attn_1_2_stage_2&#45;&gt;ring_attn_1_2_stage_3 -->
<g id="edge224" class="edge">
<title>ring_attn_1_2_stage_2&#45;&gt;ring_attn_1_2_stage_3</title>
<path fill="none" stroke="black" d="M1399,-14347.87C1399,-14347.87 1399,-14241.25 1399,-14241.25"/>
<polygon fill="black" stroke="black" points="1402.5,-14241.25 1399,-14231.25 1395.5,-14241.25 1402.5,-14241.25"/>
</g>
<!-- ring_attn_1_3_stage_2 -->
<g id="node324" class="node">
<title>ring_attn_1_3_stage_2</title>
<polygon fill="yellow" stroke="black" points="1986,-14484 1777,-14416 1986,-14348 2195,-14416 1986,-14484"/>
<text text-anchor="middle" x="1986" y="-14434.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-14419.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="1986" y="-14404.8" font-family="Times,serif" font-size="14.00">Q[3]×K[1]×V[1]</text>
<text text-anchor="middle" x="1986" y="-14389.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_2_stage_2&#45;&gt;ring_attn_1_3_stage_2 -->
<g id="edge1699" class="edge">
<title>ring_attn_1_2_stage_2&#45;&gt;ring_attn_1_3_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-14416C1608.02,-14416 1766.86,-14416 1766.86,-14416"/>
<polygon fill="red" stroke="red" points="1766.86,-14419.5 1776.86,-14416 1766.86,-14412.5 1766.86,-14419.5"/>
</g>
<!-- ring_attn_1_2_stage_3&#45;&gt;ring_attn_1_2_stage_4 -->
<g id="edge225" class="edge">
<title>ring_attn_1_2_stage_3&#45;&gt;ring_attn_1_2_stage_4</title>
<path fill="none" stroke="black" d="M1399,-14094.87C1399,-14094.87 1399,-13988.25 1399,-13988.25"/>
<polygon fill="black" stroke="black" points="1402.5,-13988.25 1399,-13978.25 1395.5,-13988.25 1402.5,-13988.25"/>
</g>
<!-- ring_attn_1_3_stage_3 -->
<g id="node325" class="node">
<title>ring_attn_1_3_stage_3</title>
<polygon fill="yellow" stroke="black" points="1986,-14231 1777,-14163 1986,-14095 2195,-14163 1986,-14231"/>
<text text-anchor="middle" x="1986" y="-14181.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-14166.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="1986" y="-14151.8" font-family="Times,serif" font-size="14.00">Q[3]×K[0]×V[0]</text>
<text text-anchor="middle" x="1986" y="-14136.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_2_stage_3&#45;&gt;ring_attn_1_3_stage_3 -->
<g id="edge1700" class="edge">
<title>ring_attn_1_2_stage_3&#45;&gt;ring_attn_1_3_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-14163C1608.02,-14163 1766.86,-14163 1766.86,-14163"/>
<polygon fill="red" stroke="red" points="1766.86,-14166.5 1776.86,-14163 1766.86,-14159.5 1766.86,-14166.5"/>
</g>
<!-- ring_attn_1_2_stage_4&#45;&gt;ring_attn_1_2_stage_5 -->
<g id="edge226" class="edge">
<title>ring_attn_1_2_stage_4&#45;&gt;ring_attn_1_2_stage_5</title>
<path fill="none" stroke="black" d="M1399,-13841.87C1399,-13841.87 1399,-13735.25 1399,-13735.25"/>
<polygon fill="black" stroke="black" points="1402.5,-13735.25 1399,-13725.25 1395.5,-13735.25 1402.5,-13735.25"/>
</g>
<!-- ring_attn_1_3_stage_4 -->
<g id="node326" class="node">
<title>ring_attn_1_3_stage_4</title>
<polygon fill="yellow" stroke="black" points="1986,-13978 1777,-13910 1986,-13842 2195,-13910 1986,-13978"/>
<text text-anchor="middle" x="1986" y="-13928.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-13913.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="1986" y="-13898.8" font-family="Times,serif" font-size="14.00">Q[3]×K[15]×V[15]</text>
<text text-anchor="middle" x="1986" y="-13883.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_2_stage_4&#45;&gt;ring_attn_1_3_stage_4 -->
<g id="edge1701" class="edge">
<title>ring_attn_1_2_stage_4&#45;&gt;ring_attn_1_3_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-13910C1608.02,-13910 1766.86,-13910 1766.86,-13910"/>
<polygon fill="red" stroke="red" points="1766.86,-13913.5 1776.86,-13910 1766.86,-13906.5 1766.86,-13913.5"/>
</g>
<!-- ring_attn_1_2_stage_5&#45;&gt;ring_attn_1_2_stage_6 -->
<g id="edge227" class="edge">
<title>ring_attn_1_2_stage_5&#45;&gt;ring_attn_1_2_stage_6</title>
<path fill="none" stroke="black" d="M1399,-13588.87C1399,-13588.87 1399,-13482.25 1399,-13482.25"/>
<polygon fill="black" stroke="black" points="1402.5,-13482.25 1399,-13472.25 1395.5,-13482.25 1402.5,-13482.25"/>
</g>
<!-- ring_attn_1_3_stage_5 -->
<g id="node327" class="node">
<title>ring_attn_1_3_stage_5</title>
<polygon fill="yellow" stroke="black" points="1986,-13725 1777,-13657 1986,-13589 2195,-13657 1986,-13725"/>
<text text-anchor="middle" x="1986" y="-13675.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-13660.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="1986" y="-13645.8" font-family="Times,serif" font-size="14.00">Q[3]×K[14]×V[14]</text>
<text text-anchor="middle" x="1986" y="-13630.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_2_stage_5&#45;&gt;ring_attn_1_3_stage_5 -->
<g id="edge1702" class="edge">
<title>ring_attn_1_2_stage_5&#45;&gt;ring_attn_1_3_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-13657C1608.02,-13657 1766.86,-13657 1766.86,-13657"/>
<polygon fill="red" stroke="red" points="1766.86,-13660.5 1776.86,-13657 1766.86,-13653.5 1766.86,-13660.5"/>
</g>
<!-- ring_attn_1_2_stage_6&#45;&gt;ring_attn_1_2_stage_7 -->
<g id="edge228" class="edge">
<title>ring_attn_1_2_stage_6&#45;&gt;ring_attn_1_2_stage_7</title>
<path fill="none" stroke="black" d="M1399,-13335.87C1399,-13335.87 1399,-13229.25 1399,-13229.25"/>
<polygon fill="black" stroke="black" points="1402.5,-13229.25 1399,-13219.25 1395.5,-13229.25 1402.5,-13229.25"/>
</g>
<!-- ring_attn_1_3_stage_6 -->
<g id="node328" class="node">
<title>ring_attn_1_3_stage_6</title>
<polygon fill="yellow" stroke="black" points="1986,-13472 1777,-13404 1986,-13336 2195,-13404 1986,-13472"/>
<text text-anchor="middle" x="1986" y="-13422.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-13407.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="1986" y="-13392.8" font-family="Times,serif" font-size="14.00">Q[3]×K[13]×V[13]</text>
<text text-anchor="middle" x="1986" y="-13377.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_2_stage_6&#45;&gt;ring_attn_1_3_stage_6 -->
<g id="edge1703" class="edge">
<title>ring_attn_1_2_stage_6&#45;&gt;ring_attn_1_3_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-13404C1608.02,-13404 1766.86,-13404 1766.86,-13404"/>
<polygon fill="red" stroke="red" points="1766.86,-13407.5 1776.86,-13404 1766.86,-13400.5 1766.86,-13407.5"/>
</g>
<!-- ring_attn_1_2_stage_7&#45;&gt;ring_attn_1_2_stage_8 -->
<g id="edge229" class="edge">
<title>ring_attn_1_2_stage_7&#45;&gt;ring_attn_1_2_stage_8</title>
<path fill="none" stroke="black" d="M1399,-13082.87C1399,-13082.87 1399,-12976.25 1399,-12976.25"/>
<polygon fill="black" stroke="black" points="1402.5,-12976.25 1399,-12966.25 1395.5,-12976.25 1402.5,-12976.25"/>
</g>
<!-- ring_attn_1_3_stage_7 -->
<g id="node329" class="node">
<title>ring_attn_1_3_stage_7</title>
<polygon fill="yellow" stroke="black" points="1986,-13219 1777,-13151 1986,-13083 2195,-13151 1986,-13219"/>
<text text-anchor="middle" x="1986" y="-13169.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-13154.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="1986" y="-13139.8" font-family="Times,serif" font-size="14.00">Q[3]×K[12]×V[12]</text>
<text text-anchor="middle" x="1986" y="-13124.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_2_stage_7&#45;&gt;ring_attn_1_3_stage_7 -->
<g id="edge1704" class="edge">
<title>ring_attn_1_2_stage_7&#45;&gt;ring_attn_1_3_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-13151C1608.02,-13151 1766.86,-13151 1766.86,-13151"/>
<polygon fill="red" stroke="red" points="1766.86,-13154.5 1776.86,-13151 1766.86,-13147.5 1766.86,-13154.5"/>
</g>
<!-- ring_attn_1_2_stage_8&#45;&gt;ring_attn_1_2_stage_9 -->
<g id="edge230" class="edge">
<title>ring_attn_1_2_stage_8&#45;&gt;ring_attn_1_2_stage_9</title>
<path fill="none" stroke="black" d="M1399,-12829.87C1399,-12829.87 1399,-12723.25 1399,-12723.25"/>
<polygon fill="black" stroke="black" points="1402.5,-12723.25 1399,-12713.25 1395.5,-12723.25 1402.5,-12723.25"/>
</g>
<!-- ring_attn_1_3_stage_8 -->
<g id="node330" class="node">
<title>ring_attn_1_3_stage_8</title>
<polygon fill="yellow" stroke="black" points="1986,-12966 1777,-12898 1986,-12830 2195,-12898 1986,-12966"/>
<text text-anchor="middle" x="1986" y="-12916.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-12901.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="1986" y="-12886.8" font-family="Times,serif" font-size="14.00">Q[3]×K[11]×V[11]</text>
<text text-anchor="middle" x="1986" y="-12871.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_2_stage_8&#45;&gt;ring_attn_1_3_stage_8 -->
<g id="edge1705" class="edge">
<title>ring_attn_1_2_stage_8&#45;&gt;ring_attn_1_3_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-12898C1608.02,-12898 1766.86,-12898 1766.86,-12898"/>
<polygon fill="red" stroke="red" points="1766.86,-12901.5 1776.86,-12898 1766.86,-12894.5 1766.86,-12901.5"/>
</g>
<!-- ring_attn_1_2_stage_9&#45;&gt;ring_attn_1_2_stage_10 -->
<g id="edge231" class="edge">
<title>ring_attn_1_2_stage_9&#45;&gt;ring_attn_1_2_stage_10</title>
<path fill="none" stroke="black" d="M1399,-12576.87C1399,-12576.87 1399,-12470.25 1399,-12470.25"/>
<polygon fill="black" stroke="black" points="1402.5,-12470.25 1399,-12460.25 1395.5,-12470.25 1402.5,-12470.25"/>
</g>
<!-- ring_attn_1_3_stage_9 -->
<g id="node331" class="node">
<title>ring_attn_1_3_stage_9</title>
<polygon fill="yellow" stroke="black" points="1986,-12713 1777,-12645 1986,-12577 2195,-12645 1986,-12713"/>
<text text-anchor="middle" x="1986" y="-12663.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-12648.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="1986" y="-12633.8" font-family="Times,serif" font-size="14.00">Q[3]×K[10]×V[10]</text>
<text text-anchor="middle" x="1986" y="-12618.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_2_stage_9&#45;&gt;ring_attn_1_3_stage_9 -->
<g id="edge1706" class="edge">
<title>ring_attn_1_2_stage_9&#45;&gt;ring_attn_1_3_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-12645C1608.02,-12645 1766.86,-12645 1766.86,-12645"/>
<polygon fill="red" stroke="red" points="1766.86,-12648.5 1776.86,-12645 1766.86,-12641.5 1766.86,-12648.5"/>
</g>
<!-- ring_attn_1_2_stage_10&#45;&gt;ring_attn_1_2_stage_11 -->
<g id="edge232" class="edge">
<title>ring_attn_1_2_stage_10&#45;&gt;ring_attn_1_2_stage_11</title>
<path fill="none" stroke="black" d="M1399,-12323.87C1399,-12323.87 1399,-12217.25 1399,-12217.25"/>
<polygon fill="black" stroke="black" points="1402.5,-12217.25 1399,-12207.25 1395.5,-12217.25 1402.5,-12217.25"/>
</g>
<!-- ring_attn_1_3_stage_10 -->
<g id="node332" class="node">
<title>ring_attn_1_3_stage_10</title>
<polygon fill="yellow" stroke="black" points="1986,-12460 1777,-12392 1986,-12324 2195,-12392 1986,-12460"/>
<text text-anchor="middle" x="1986" y="-12410.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-12395.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="1986" y="-12380.8" font-family="Times,serif" font-size="14.00">Q[3]×K[9]×V[9]</text>
<text text-anchor="middle" x="1986" y="-12365.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_2_stage_10&#45;&gt;ring_attn_1_3_stage_10 -->
<g id="edge1707" class="edge">
<title>ring_attn_1_2_stage_10&#45;&gt;ring_attn_1_3_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-12392C1608.02,-12392 1766.86,-12392 1766.86,-12392"/>
<polygon fill="red" stroke="red" points="1766.86,-12395.5 1776.86,-12392 1766.86,-12388.5 1766.86,-12395.5"/>
</g>
<!-- ring_attn_1_2_stage_11&#45;&gt;ring_attn_1_2_stage_12 -->
<g id="edge233" class="edge">
<title>ring_attn_1_2_stage_11&#45;&gt;ring_attn_1_2_stage_12</title>
<path fill="none" stroke="black" d="M1399,-12070.87C1399,-12070.87 1399,-11964.25 1399,-11964.25"/>
<polygon fill="black" stroke="black" points="1402.5,-11964.25 1399,-11954.25 1395.5,-11964.25 1402.5,-11964.25"/>
</g>
<!-- ring_attn_1_3_stage_11 -->
<g id="node333" class="node">
<title>ring_attn_1_3_stage_11</title>
<polygon fill="yellow" stroke="black" points="1986,-12207 1777,-12139 1986,-12071 2195,-12139 1986,-12207"/>
<text text-anchor="middle" x="1986" y="-12157.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-12142.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="1986" y="-12127.8" font-family="Times,serif" font-size="14.00">Q[3]×K[8]×V[8]</text>
<text text-anchor="middle" x="1986" y="-12112.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_2_stage_11&#45;&gt;ring_attn_1_3_stage_11 -->
<g id="edge1708" class="edge">
<title>ring_attn_1_2_stage_11&#45;&gt;ring_attn_1_3_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-12139C1608.02,-12139 1766.86,-12139 1766.86,-12139"/>
<polygon fill="red" stroke="red" points="1766.86,-12142.5 1776.86,-12139 1766.86,-12135.5 1766.86,-12142.5"/>
</g>
<!-- ring_attn_1_2_stage_12&#45;&gt;ring_attn_1_2_stage_13 -->
<g id="edge234" class="edge">
<title>ring_attn_1_2_stage_12&#45;&gt;ring_attn_1_2_stage_13</title>
<path fill="none" stroke="black" d="M1399,-11817.87C1399,-11817.87 1399,-11711.25 1399,-11711.25"/>
<polygon fill="black" stroke="black" points="1402.5,-11711.25 1399,-11701.25 1395.5,-11711.25 1402.5,-11711.25"/>
</g>
<!-- ring_attn_1_3_stage_12 -->
<g id="node334" class="node">
<title>ring_attn_1_3_stage_12</title>
<polygon fill="yellow" stroke="black" points="1986,-11954 1777,-11886 1986,-11818 2195,-11886 1986,-11954"/>
<text text-anchor="middle" x="1986" y="-11904.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-11889.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="1986" y="-11874.8" font-family="Times,serif" font-size="14.00">Q[3]×K[7]×V[7]</text>
<text text-anchor="middle" x="1986" y="-11859.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_2_stage_12&#45;&gt;ring_attn_1_3_stage_12 -->
<g id="edge1709" class="edge">
<title>ring_attn_1_2_stage_12&#45;&gt;ring_attn_1_3_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-11886C1608.02,-11886 1766.86,-11886 1766.86,-11886"/>
<polygon fill="red" stroke="red" points="1766.86,-11889.5 1776.86,-11886 1766.86,-11882.5 1766.86,-11889.5"/>
</g>
<!-- ring_attn_1_2_stage_13&#45;&gt;ring_attn_1_2_stage_14 -->
<g id="edge235" class="edge">
<title>ring_attn_1_2_stage_13&#45;&gt;ring_attn_1_2_stage_14</title>
<path fill="none" stroke="black" d="M1399,-11564.87C1399,-11564.87 1399,-11458.25 1399,-11458.25"/>
<polygon fill="black" stroke="black" points="1402.5,-11458.25 1399,-11448.25 1395.5,-11458.25 1402.5,-11458.25"/>
</g>
<!-- ring_attn_1_3_stage_13 -->
<g id="node335" class="node">
<title>ring_attn_1_3_stage_13</title>
<polygon fill="yellow" stroke="black" points="1986,-11701 1777,-11633 1986,-11565 2195,-11633 1986,-11701"/>
<text text-anchor="middle" x="1986" y="-11651.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-11636.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="1986" y="-11621.8" font-family="Times,serif" font-size="14.00">Q[3]×K[6]×V[6]</text>
<text text-anchor="middle" x="1986" y="-11606.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_2_stage_13&#45;&gt;ring_attn_1_3_stage_13 -->
<g id="edge1710" class="edge">
<title>ring_attn_1_2_stage_13&#45;&gt;ring_attn_1_3_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-11633C1608.02,-11633 1766.86,-11633 1766.86,-11633"/>
<polygon fill="red" stroke="red" points="1766.86,-11636.5 1776.86,-11633 1766.86,-11629.5 1766.86,-11636.5"/>
</g>
<!-- ring_attn_1_2_stage_14&#45;&gt;ring_attn_1_2_stage_15 -->
<g id="edge236" class="edge">
<title>ring_attn_1_2_stage_14&#45;&gt;ring_attn_1_2_stage_15</title>
<path fill="none" stroke="black" d="M1399,-11311.87C1399,-11311.87 1399,-11205.25 1399,-11205.25"/>
<polygon fill="black" stroke="black" points="1402.5,-11205.25 1399,-11195.25 1395.5,-11205.25 1402.5,-11205.25"/>
</g>
<!-- ring_attn_1_3_stage_14 -->
<g id="node336" class="node">
<title>ring_attn_1_3_stage_14</title>
<polygon fill="yellow" stroke="black" points="1986,-11448 1777,-11380 1986,-11312 2195,-11380 1986,-11448"/>
<text text-anchor="middle" x="1986" y="-11398.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-11383.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="1986" y="-11368.8" font-family="Times,serif" font-size="14.00">Q[3]×K[5]×V[5]</text>
<text text-anchor="middle" x="1986" y="-11353.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_2_stage_14&#45;&gt;ring_attn_1_3_stage_14 -->
<g id="edge1711" class="edge">
<title>ring_attn_1_2_stage_14&#45;&gt;ring_attn_1_3_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-11380C1608.02,-11380 1766.86,-11380 1766.86,-11380"/>
<polygon fill="red" stroke="red" points="1766.86,-11383.5 1776.86,-11380 1766.86,-11376.5 1766.86,-11383.5"/>
</g>
<!-- attn_out_1_2 -->
<g id="node240" class="node">
<title>attn_out_1_2</title>
<polygon fill="none" stroke="black" points="1468.5,-10986 1329.5,-10986 1329.5,-10933 1468.5,-10933 1468.5,-10986"/>
<text text-anchor="middle" x="1399" y="-10970.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1399" y="-10955.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="1399" y="-10940.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_1_2_stage_15&#45;&gt;attn_out_1_2 -->
<g id="edge237" class="edge">
<title>ring_attn_1_2_stage_15&#45;&gt;attn_out_1_2</title>
<path fill="none" stroke="black" d="M1399,-11058.87C1399,-11058.87 1399,-10996.18 1399,-10996.18"/>
<polygon fill="black" stroke="black" points="1402.5,-10996.18 1399,-10986.18 1395.5,-10996.18 1402.5,-10996.18"/>
</g>
<!-- ring_attn_1_3_stage_15 -->
<g id="node337" class="node">
<title>ring_attn_1_3_stage_15</title>
<polygon fill="yellow" stroke="black" points="1986,-11195 1777,-11127 1986,-11059 2195,-11127 1986,-11195"/>
<text text-anchor="middle" x="1986" y="-11145.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-11130.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="1986" y="-11115.8" font-family="Times,serif" font-size="14.00">Q[3]×K[4]×V[4]</text>
<text text-anchor="middle" x="1986" y="-11100.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_2_stage_15&#45;&gt;ring_attn_1_3_stage_15 -->
<g id="edge1712" class="edge">
<title>ring_attn_1_2_stage_15&#45;&gt;ring_attn_1_3_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-11127C1608.02,-11127 1766.86,-11127 1766.86,-11127"/>
<polygon fill="red" stroke="red" points="1766.86,-11130.5 1776.86,-11127 1766.86,-11123.5 1766.86,-11130.5"/>
</g>
<!-- attn_residual_1_2 -->
<g id="node241" class="node">
<title>attn_residual_1_2</title>
<ellipse fill="none" stroke="black" cx="1399" cy="-10833" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1399" y="-10836.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1399" y="-10821.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_1_2&#45;&gt;attn_residual_1_2 -->
<g id="edge238" class="edge">
<title>attn_out_1_2&#45;&gt;attn_residual_1_2</title>
<path fill="none" stroke="black" d="M1399,-10932.98C1399,-10932.98 1399,-10870.36 1399,-10870.36"/>
<polygon fill="black" stroke="black" points="1402.5,-10870.36 1399,-10860.36 1395.5,-10870.36 1402.5,-10870.36"/>
</g>
<!-- ffn_up_1_2 -->
<g id="node242" class="node">
<title>ffn_up_1_2</title>
<polygon fill="none" stroke="black" points="1478,-10733 1320,-10733 1320,-10680 1478,-10680 1478,-10733"/>
<text text-anchor="middle" x="1399" y="-10717.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1399" y="-10702.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="1399" y="-10687.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_1_2&#45;&gt;ffn_up_1_2 -->
<g id="edge239" class="edge">
<title>attn_residual_1_2&#45;&gt;ffn_up_1_2</title>
<path fill="none" stroke="black" d="M1399,-10805.86C1399,-10805.86 1399,-10743.16 1399,-10743.16"/>
<polygon fill="black" stroke="black" points="1402.5,-10743.16 1399,-10733.16 1395.5,-10743.16 1402.5,-10743.16"/>
</g>
<!-- ffn_gelu_1_2 -->
<g id="node243" class="node">
<title>ffn_gelu_1_2</title>
<ellipse fill="none" stroke="black" cx="1399" cy="-10580" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1399" y="-10583.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1399" y="-10568.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_1_2&#45;&gt;ffn_gelu_1_2 -->
<g id="edge240" class="edge">
<title>ffn_up_1_2&#45;&gt;ffn_gelu_1_2</title>
<path fill="none" stroke="black" d="M1399,-10679.98C1399,-10679.98 1399,-10617.36 1399,-10617.36"/>
<polygon fill="black" stroke="black" points="1402.5,-10617.36 1399,-10607.36 1395.5,-10617.36 1402.5,-10617.36"/>
</g>
<!-- ffn_down_1_2 -->
<g id="node244" class="node">
<title>ffn_down_1_2</title>
<polygon fill="none" stroke="black" points="1488,-10480 1310,-10480 1310,-10427 1488,-10427 1488,-10480"/>
<text text-anchor="middle" x="1399" y="-10464.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1399" y="-10449.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="1399" y="-10434.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_1_2&#45;&gt;ffn_down_1_2 -->
<g id="edge241" class="edge">
<title>ffn_gelu_1_2&#45;&gt;ffn_down_1_2</title>
<path fill="none" stroke="black" d="M1399,-10552.86C1399,-10552.86 1399,-10490.16 1399,-10490.16"/>
<polygon fill="black" stroke="black" points="1402.5,-10490.16 1399,-10480.16 1395.5,-10490.16 1402.5,-10490.16"/>
</g>
<!-- ffn_residual_1_2 -->
<g id="node245" class="node">
<title>ffn_residual_1_2</title>
<ellipse fill="none" stroke="black" cx="1399" cy="-10327" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1399" y="-10330.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1399" y="-10315.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_1_2&#45;&gt;ffn_residual_1_2 -->
<g id="edge242" class="edge">
<title>ffn_down_1_2&#45;&gt;ffn_residual_1_2</title>
<path fill="none" stroke="black" d="M1399,-10426.98C1399,-10426.98 1399,-10364.36 1399,-10364.36"/>
<polygon fill="black" stroke="black" points="1402.5,-10364.36 1399,-10354.36 1395.5,-10364.36 1402.5,-10364.36"/>
</g>
<!-- qkv_proj_2_2 -->
<g id="node246" class="node">
<title>qkv_proj_2_2</title>
<polygon fill="none" stroke="black" points="1481.5,-10227 1316.5,-10227 1316.5,-10174 1481.5,-10174 1481.5,-10227"/>
<text text-anchor="middle" x="1399" y="-10211.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1399" y="-10196.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="1399" y="-10181.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_1_2&#45;&gt;qkv_proj_2_2 -->
<g id="edge243" class="edge">
<title>ffn_residual_1_2&#45;&gt;qkv_proj_2_2</title>
<path fill="none" stroke="black" d="M1399,-10299.86C1399,-10299.86 1399,-10237.16 1399,-10237.16"/>
<polygon fill="black" stroke="black" points="1402.5,-10237.16 1399,-10227.16 1395.5,-10237.16 1402.5,-10237.16"/>
</g>
<!-- qkv_reshape_2_2 -->
<g id="node247" class="node">
<title>qkv_reshape_2_2</title>
<ellipse fill="none" stroke="black" cx="1399" cy="-10074" rx="148" ry="27"/>
<text text-anchor="middle" x="1399" y="-10077.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1399" y="-10062.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_2_2&#45;&gt;qkv_reshape_2_2 -->
<g id="edge244" class="edge">
<title>qkv_proj_2_2&#45;&gt;qkv_reshape_2_2</title>
<path fill="none" stroke="black" d="M1399,-10173.98C1399,-10173.98 1399,-10111.36 1399,-10111.36"/>
<polygon fill="black" stroke="black" points="1402.5,-10111.36 1399,-10101.36 1395.5,-10111.36 1402.5,-10111.36"/>
</g>
<!-- qkv_reshape_2_2&#45;&gt;ring_attn_2_2_stage_0 -->
<g id="edge245" class="edge">
<title>qkv_reshape_2_2&#45;&gt;ring_attn_2_2_stage_0</title>
<path fill="none" stroke="black" d="M1399,-10046.72C1399,-10046.72 1399,-9940.16 1399,-9940.16"/>
<polygon fill="black" stroke="black" points="1402.5,-9940.16 1399,-9930.16 1395.5,-9940.16 1402.5,-9940.16"/>
</g>
<!-- ring_attn_2_2_stage_0&#45;&gt;ring_attn_2_2_stage_1 -->
<g id="edge246" class="edge">
<title>ring_attn_2_2_stage_0&#45;&gt;ring_attn_2_2_stage_1</title>
<path fill="none" stroke="black" d="M1399,-9793.87C1399,-9793.87 1399,-9687.25 1399,-9687.25"/>
<polygon fill="black" stroke="black" points="1402.5,-9687.25 1399,-9677.25 1395.5,-9687.25 1402.5,-9687.25"/>
</g>
<!-- ring_attn_2_3_stage_0 -->
<g id="node346" class="node">
<title>ring_attn_2_3_stage_0</title>
<polygon fill="yellow" stroke="black" points="1986,-9930 1777,-9862 1986,-9794 2195,-9862 1986,-9930"/>
<text text-anchor="middle" x="1986" y="-9880.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-9865.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="1986" y="-9850.8" font-family="Times,serif" font-size="14.00">Q[3]×K[3]×V[3]</text>
<text text-anchor="middle" x="1986" y="-9835.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_2_stage_0&#45;&gt;ring_attn_2_3_stage_0 -->
<g id="edge1713" class="edge">
<title>ring_attn_2_2_stage_0&#45;&gt;ring_attn_2_3_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-9862C1608.02,-9862 1766.86,-9862 1766.86,-9862"/>
<polygon fill="red" stroke="red" points="1766.86,-9865.5 1776.86,-9862 1766.86,-9858.5 1766.86,-9865.5"/>
</g>
<!-- ring_attn_2_2_stage_1&#45;&gt;ring_attn_2_2_stage_2 -->
<g id="edge247" class="edge">
<title>ring_attn_2_2_stage_1&#45;&gt;ring_attn_2_2_stage_2</title>
<path fill="none" stroke="black" d="M1399,-9540.87C1399,-9540.87 1399,-9434.25 1399,-9434.25"/>
<polygon fill="black" stroke="black" points="1402.5,-9434.25 1399,-9424.25 1395.5,-9434.25 1402.5,-9434.25"/>
</g>
<!-- ring_attn_2_3_stage_1 -->
<g id="node347" class="node">
<title>ring_attn_2_3_stage_1</title>
<polygon fill="yellow" stroke="black" points="1986,-9677 1777,-9609 1986,-9541 2195,-9609 1986,-9677"/>
<text text-anchor="middle" x="1986" y="-9627.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-9612.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="1986" y="-9597.8" font-family="Times,serif" font-size="14.00">Q[3]×K[2]×V[2]</text>
<text text-anchor="middle" x="1986" y="-9582.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_2_stage_1&#45;&gt;ring_attn_2_3_stage_1 -->
<g id="edge1714" class="edge">
<title>ring_attn_2_2_stage_1&#45;&gt;ring_attn_2_3_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-9609C1608.02,-9609 1766.86,-9609 1766.86,-9609"/>
<polygon fill="red" stroke="red" points="1766.86,-9612.5 1776.86,-9609 1766.86,-9605.5 1766.86,-9612.5"/>
</g>
<!-- ring_attn_2_2_stage_2&#45;&gt;ring_attn_2_2_stage_3 -->
<g id="edge248" class="edge">
<title>ring_attn_2_2_stage_2&#45;&gt;ring_attn_2_2_stage_3</title>
<path fill="none" stroke="black" d="M1399,-9287.87C1399,-9287.87 1399,-9181.25 1399,-9181.25"/>
<polygon fill="black" stroke="black" points="1402.5,-9181.25 1399,-9171.25 1395.5,-9181.25 1402.5,-9181.25"/>
</g>
<!-- ring_attn_2_3_stage_2 -->
<g id="node348" class="node">
<title>ring_attn_2_3_stage_2</title>
<polygon fill="yellow" stroke="black" points="1986,-9424 1777,-9356 1986,-9288 2195,-9356 1986,-9424"/>
<text text-anchor="middle" x="1986" y="-9374.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-9359.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="1986" y="-9344.8" font-family="Times,serif" font-size="14.00">Q[3]×K[1]×V[1]</text>
<text text-anchor="middle" x="1986" y="-9329.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_2_stage_2&#45;&gt;ring_attn_2_3_stage_2 -->
<g id="edge1715" class="edge">
<title>ring_attn_2_2_stage_2&#45;&gt;ring_attn_2_3_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-9356C1608.02,-9356 1766.86,-9356 1766.86,-9356"/>
<polygon fill="red" stroke="red" points="1766.86,-9359.5 1776.86,-9356 1766.86,-9352.5 1766.86,-9359.5"/>
</g>
<!-- ring_attn_2_2_stage_3&#45;&gt;ring_attn_2_2_stage_4 -->
<g id="edge249" class="edge">
<title>ring_attn_2_2_stage_3&#45;&gt;ring_attn_2_2_stage_4</title>
<path fill="none" stroke="black" d="M1399,-9034.87C1399,-9034.87 1399,-8928.25 1399,-8928.25"/>
<polygon fill="black" stroke="black" points="1402.5,-8928.25 1399,-8918.25 1395.5,-8928.25 1402.5,-8928.25"/>
</g>
<!-- ring_attn_2_3_stage_3 -->
<g id="node349" class="node">
<title>ring_attn_2_3_stage_3</title>
<polygon fill="yellow" stroke="black" points="1986,-9171 1777,-9103 1986,-9035 2195,-9103 1986,-9171"/>
<text text-anchor="middle" x="1986" y="-9121.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-9106.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="1986" y="-9091.8" font-family="Times,serif" font-size="14.00">Q[3]×K[0]×V[0]</text>
<text text-anchor="middle" x="1986" y="-9076.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_2_stage_3&#45;&gt;ring_attn_2_3_stage_3 -->
<g id="edge1716" class="edge">
<title>ring_attn_2_2_stage_3&#45;&gt;ring_attn_2_3_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-9103C1608.02,-9103 1766.86,-9103 1766.86,-9103"/>
<polygon fill="red" stroke="red" points="1766.86,-9106.5 1776.86,-9103 1766.86,-9099.5 1766.86,-9106.5"/>
</g>
<!-- ring_attn_2_2_stage_4&#45;&gt;ring_attn_2_2_stage_5 -->
<g id="edge250" class="edge">
<title>ring_attn_2_2_stage_4&#45;&gt;ring_attn_2_2_stage_5</title>
<path fill="none" stroke="black" d="M1399,-8781.87C1399,-8781.87 1399,-8675.25 1399,-8675.25"/>
<polygon fill="black" stroke="black" points="1402.5,-8675.25 1399,-8665.25 1395.5,-8675.25 1402.5,-8675.25"/>
</g>
<!-- ring_attn_2_3_stage_4 -->
<g id="node350" class="node">
<title>ring_attn_2_3_stage_4</title>
<polygon fill="yellow" stroke="black" points="1986,-8918 1777,-8850 1986,-8782 2195,-8850 1986,-8918"/>
<text text-anchor="middle" x="1986" y="-8868.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-8853.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="1986" y="-8838.8" font-family="Times,serif" font-size="14.00">Q[3]×K[15]×V[15]</text>
<text text-anchor="middle" x="1986" y="-8823.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_2_stage_4&#45;&gt;ring_attn_2_3_stage_4 -->
<g id="edge1717" class="edge">
<title>ring_attn_2_2_stage_4&#45;&gt;ring_attn_2_3_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-8850C1608.02,-8850 1766.86,-8850 1766.86,-8850"/>
<polygon fill="red" stroke="red" points="1766.86,-8853.5 1776.86,-8850 1766.86,-8846.5 1766.86,-8853.5"/>
</g>
<!-- ring_attn_2_2_stage_5&#45;&gt;ring_attn_2_2_stage_6 -->
<g id="edge251" class="edge">
<title>ring_attn_2_2_stage_5&#45;&gt;ring_attn_2_2_stage_6</title>
<path fill="none" stroke="black" d="M1399,-8528.87C1399,-8528.87 1399,-8422.25 1399,-8422.25"/>
<polygon fill="black" stroke="black" points="1402.5,-8422.25 1399,-8412.25 1395.5,-8422.25 1402.5,-8422.25"/>
</g>
<!-- ring_attn_2_3_stage_5 -->
<g id="node351" class="node">
<title>ring_attn_2_3_stage_5</title>
<polygon fill="yellow" stroke="black" points="1986,-8665 1777,-8597 1986,-8529 2195,-8597 1986,-8665"/>
<text text-anchor="middle" x="1986" y="-8615.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-8600.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="1986" y="-8585.8" font-family="Times,serif" font-size="14.00">Q[3]×K[14]×V[14]</text>
<text text-anchor="middle" x="1986" y="-8570.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_2_stage_5&#45;&gt;ring_attn_2_3_stage_5 -->
<g id="edge1718" class="edge">
<title>ring_attn_2_2_stage_5&#45;&gt;ring_attn_2_3_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-8597C1608.02,-8597 1766.86,-8597 1766.86,-8597"/>
<polygon fill="red" stroke="red" points="1766.86,-8600.5 1776.86,-8597 1766.86,-8593.5 1766.86,-8600.5"/>
</g>
<!-- ring_attn_2_2_stage_6&#45;&gt;ring_attn_2_2_stage_7 -->
<g id="edge252" class="edge">
<title>ring_attn_2_2_stage_6&#45;&gt;ring_attn_2_2_stage_7</title>
<path fill="none" stroke="black" d="M1399,-8275.87C1399,-8275.87 1399,-8169.25 1399,-8169.25"/>
<polygon fill="black" stroke="black" points="1402.5,-8169.25 1399,-8159.25 1395.5,-8169.25 1402.5,-8169.25"/>
</g>
<!-- ring_attn_2_3_stage_6 -->
<g id="node352" class="node">
<title>ring_attn_2_3_stage_6</title>
<polygon fill="yellow" stroke="black" points="1986,-8412 1777,-8344 1986,-8276 2195,-8344 1986,-8412"/>
<text text-anchor="middle" x="1986" y="-8362.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-8347.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="1986" y="-8332.8" font-family="Times,serif" font-size="14.00">Q[3]×K[13]×V[13]</text>
<text text-anchor="middle" x="1986" y="-8317.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_2_stage_6&#45;&gt;ring_attn_2_3_stage_6 -->
<g id="edge1719" class="edge">
<title>ring_attn_2_2_stage_6&#45;&gt;ring_attn_2_3_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-8344C1608.02,-8344 1766.86,-8344 1766.86,-8344"/>
<polygon fill="red" stroke="red" points="1766.86,-8347.5 1776.86,-8344 1766.86,-8340.5 1766.86,-8347.5"/>
</g>
<!-- ring_attn_2_2_stage_7&#45;&gt;ring_attn_2_2_stage_8 -->
<g id="edge253" class="edge">
<title>ring_attn_2_2_stage_7&#45;&gt;ring_attn_2_2_stage_8</title>
<path fill="none" stroke="black" d="M1399,-8022.87C1399,-8022.87 1399,-7916.25 1399,-7916.25"/>
<polygon fill="black" stroke="black" points="1402.5,-7916.25 1399,-7906.25 1395.5,-7916.25 1402.5,-7916.25"/>
</g>
<!-- ring_attn_2_3_stage_7 -->
<g id="node353" class="node">
<title>ring_attn_2_3_stage_7</title>
<polygon fill="yellow" stroke="black" points="1986,-8159 1777,-8091 1986,-8023 2195,-8091 1986,-8159"/>
<text text-anchor="middle" x="1986" y="-8109.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-8094.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="1986" y="-8079.8" font-family="Times,serif" font-size="14.00">Q[3]×K[12]×V[12]</text>
<text text-anchor="middle" x="1986" y="-8064.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_2_stage_7&#45;&gt;ring_attn_2_3_stage_7 -->
<g id="edge1720" class="edge">
<title>ring_attn_2_2_stage_7&#45;&gt;ring_attn_2_3_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-8091C1608.02,-8091 1766.86,-8091 1766.86,-8091"/>
<polygon fill="red" stroke="red" points="1766.86,-8094.5 1776.86,-8091 1766.86,-8087.5 1766.86,-8094.5"/>
</g>
<!-- ring_attn_2_2_stage_8&#45;&gt;ring_attn_2_2_stage_9 -->
<g id="edge254" class="edge">
<title>ring_attn_2_2_stage_8&#45;&gt;ring_attn_2_2_stage_9</title>
<path fill="none" stroke="black" d="M1399,-7769.87C1399,-7769.87 1399,-7663.25 1399,-7663.25"/>
<polygon fill="black" stroke="black" points="1402.5,-7663.25 1399,-7653.25 1395.5,-7663.25 1402.5,-7663.25"/>
</g>
<!-- ring_attn_2_3_stage_8 -->
<g id="node354" class="node">
<title>ring_attn_2_3_stage_8</title>
<polygon fill="yellow" stroke="black" points="1986,-7906 1777,-7838 1986,-7770 2195,-7838 1986,-7906"/>
<text text-anchor="middle" x="1986" y="-7856.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-7841.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="1986" y="-7826.8" font-family="Times,serif" font-size="14.00">Q[3]×K[11]×V[11]</text>
<text text-anchor="middle" x="1986" y="-7811.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_2_stage_8&#45;&gt;ring_attn_2_3_stage_8 -->
<g id="edge1721" class="edge">
<title>ring_attn_2_2_stage_8&#45;&gt;ring_attn_2_3_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-7838C1608.02,-7838 1766.86,-7838 1766.86,-7838"/>
<polygon fill="red" stroke="red" points="1766.86,-7841.5 1776.86,-7838 1766.86,-7834.5 1766.86,-7841.5"/>
</g>
<!-- ring_attn_2_2_stage_9&#45;&gt;ring_attn_2_2_stage_10 -->
<g id="edge255" class="edge">
<title>ring_attn_2_2_stage_9&#45;&gt;ring_attn_2_2_stage_10</title>
<path fill="none" stroke="black" d="M1399,-7516.87C1399,-7516.87 1399,-7410.25 1399,-7410.25"/>
<polygon fill="black" stroke="black" points="1402.5,-7410.25 1399,-7400.25 1395.5,-7410.25 1402.5,-7410.25"/>
</g>
<!-- ring_attn_2_3_stage_9 -->
<g id="node355" class="node">
<title>ring_attn_2_3_stage_9</title>
<polygon fill="yellow" stroke="black" points="1986,-7653 1777,-7585 1986,-7517 2195,-7585 1986,-7653"/>
<text text-anchor="middle" x="1986" y="-7603.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-7588.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="1986" y="-7573.8" font-family="Times,serif" font-size="14.00">Q[3]×K[10]×V[10]</text>
<text text-anchor="middle" x="1986" y="-7558.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_2_stage_9&#45;&gt;ring_attn_2_3_stage_9 -->
<g id="edge1722" class="edge">
<title>ring_attn_2_2_stage_9&#45;&gt;ring_attn_2_3_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-7585C1608.02,-7585 1766.86,-7585 1766.86,-7585"/>
<polygon fill="red" stroke="red" points="1766.86,-7588.5 1776.86,-7585 1766.86,-7581.5 1766.86,-7588.5"/>
</g>
<!-- ring_attn_2_2_stage_10&#45;&gt;ring_attn_2_2_stage_11 -->
<g id="edge256" class="edge">
<title>ring_attn_2_2_stage_10&#45;&gt;ring_attn_2_2_stage_11</title>
<path fill="none" stroke="black" d="M1399,-7263.87C1399,-7263.87 1399,-7157.25 1399,-7157.25"/>
<polygon fill="black" stroke="black" points="1402.5,-7157.25 1399,-7147.25 1395.5,-7157.25 1402.5,-7157.25"/>
</g>
<!-- ring_attn_2_3_stage_10 -->
<g id="node356" class="node">
<title>ring_attn_2_3_stage_10</title>
<polygon fill="yellow" stroke="black" points="1986,-7400 1777,-7332 1986,-7264 2195,-7332 1986,-7400"/>
<text text-anchor="middle" x="1986" y="-7350.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-7335.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="1986" y="-7320.8" font-family="Times,serif" font-size="14.00">Q[3]×K[9]×V[9]</text>
<text text-anchor="middle" x="1986" y="-7305.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_2_stage_10&#45;&gt;ring_attn_2_3_stage_10 -->
<g id="edge1723" class="edge">
<title>ring_attn_2_2_stage_10&#45;&gt;ring_attn_2_3_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-7332C1608.02,-7332 1766.86,-7332 1766.86,-7332"/>
<polygon fill="red" stroke="red" points="1766.86,-7335.5 1776.86,-7332 1766.86,-7328.5 1766.86,-7335.5"/>
</g>
<!-- ring_attn_2_2_stage_11&#45;&gt;ring_attn_2_2_stage_12 -->
<g id="edge257" class="edge">
<title>ring_attn_2_2_stage_11&#45;&gt;ring_attn_2_2_stage_12</title>
<path fill="none" stroke="black" d="M1399,-7010.87C1399,-7010.87 1399,-6904.25 1399,-6904.25"/>
<polygon fill="black" stroke="black" points="1402.5,-6904.25 1399,-6894.25 1395.5,-6904.25 1402.5,-6904.25"/>
</g>
<!-- ring_attn_2_3_stage_11 -->
<g id="node357" class="node">
<title>ring_attn_2_3_stage_11</title>
<polygon fill="yellow" stroke="black" points="1986,-7147 1777,-7079 1986,-7011 2195,-7079 1986,-7147"/>
<text text-anchor="middle" x="1986" y="-7097.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-7082.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="1986" y="-7067.8" font-family="Times,serif" font-size="14.00">Q[3]×K[8]×V[8]</text>
<text text-anchor="middle" x="1986" y="-7052.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_2_stage_11&#45;&gt;ring_attn_2_3_stage_11 -->
<g id="edge1724" class="edge">
<title>ring_attn_2_2_stage_11&#45;&gt;ring_attn_2_3_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-7079C1608.02,-7079 1766.86,-7079 1766.86,-7079"/>
<polygon fill="red" stroke="red" points="1766.86,-7082.5 1776.86,-7079 1766.86,-7075.5 1766.86,-7082.5"/>
</g>
<!-- ring_attn_2_2_stage_12&#45;&gt;ring_attn_2_2_stage_13 -->
<g id="edge258" class="edge">
<title>ring_attn_2_2_stage_12&#45;&gt;ring_attn_2_2_stage_13</title>
<path fill="none" stroke="black" d="M1399,-6757.87C1399,-6757.87 1399,-6651.25 1399,-6651.25"/>
<polygon fill="black" stroke="black" points="1402.5,-6651.25 1399,-6641.25 1395.5,-6651.25 1402.5,-6651.25"/>
</g>
<!-- ring_attn_2_3_stage_12 -->
<g id="node358" class="node">
<title>ring_attn_2_3_stage_12</title>
<polygon fill="yellow" stroke="black" points="1986,-6894 1777,-6826 1986,-6758 2195,-6826 1986,-6894"/>
<text text-anchor="middle" x="1986" y="-6844.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-6829.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="1986" y="-6814.8" font-family="Times,serif" font-size="14.00">Q[3]×K[7]×V[7]</text>
<text text-anchor="middle" x="1986" y="-6799.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_2_stage_12&#45;&gt;ring_attn_2_3_stage_12 -->
<g id="edge1725" class="edge">
<title>ring_attn_2_2_stage_12&#45;&gt;ring_attn_2_3_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-6826C1608.02,-6826 1766.86,-6826 1766.86,-6826"/>
<polygon fill="red" stroke="red" points="1766.86,-6829.5 1776.86,-6826 1766.86,-6822.5 1766.86,-6829.5"/>
</g>
<!-- ring_attn_2_2_stage_13&#45;&gt;ring_attn_2_2_stage_14 -->
<g id="edge259" class="edge">
<title>ring_attn_2_2_stage_13&#45;&gt;ring_attn_2_2_stage_14</title>
<path fill="none" stroke="black" d="M1399,-6504.87C1399,-6504.87 1399,-6398.25 1399,-6398.25"/>
<polygon fill="black" stroke="black" points="1402.5,-6398.25 1399,-6388.25 1395.5,-6398.25 1402.5,-6398.25"/>
</g>
<!-- ring_attn_2_3_stage_13 -->
<g id="node359" class="node">
<title>ring_attn_2_3_stage_13</title>
<polygon fill="yellow" stroke="black" points="1986,-6641 1777,-6573 1986,-6505 2195,-6573 1986,-6641"/>
<text text-anchor="middle" x="1986" y="-6591.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-6576.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="1986" y="-6561.8" font-family="Times,serif" font-size="14.00">Q[3]×K[6]×V[6]</text>
<text text-anchor="middle" x="1986" y="-6546.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_2_stage_13&#45;&gt;ring_attn_2_3_stage_13 -->
<g id="edge1726" class="edge">
<title>ring_attn_2_2_stage_13&#45;&gt;ring_attn_2_3_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-6573C1608.02,-6573 1766.86,-6573 1766.86,-6573"/>
<polygon fill="red" stroke="red" points="1766.86,-6576.5 1776.86,-6573 1766.86,-6569.5 1766.86,-6576.5"/>
</g>
<!-- ring_attn_2_2_stage_14&#45;&gt;ring_attn_2_2_stage_15 -->
<g id="edge260" class="edge">
<title>ring_attn_2_2_stage_14&#45;&gt;ring_attn_2_2_stage_15</title>
<path fill="none" stroke="black" d="M1399,-6251.87C1399,-6251.87 1399,-6145.25 1399,-6145.25"/>
<polygon fill="black" stroke="black" points="1402.5,-6145.25 1399,-6135.25 1395.5,-6145.25 1402.5,-6145.25"/>
</g>
<!-- ring_attn_2_3_stage_14 -->
<g id="node360" class="node">
<title>ring_attn_2_3_stage_14</title>
<polygon fill="yellow" stroke="black" points="1986,-6388 1777,-6320 1986,-6252 2195,-6320 1986,-6388"/>
<text text-anchor="middle" x="1986" y="-6338.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-6323.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="1986" y="-6308.8" font-family="Times,serif" font-size="14.00">Q[3]×K[5]×V[5]</text>
<text text-anchor="middle" x="1986" y="-6293.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_2_stage_14&#45;&gt;ring_attn_2_3_stage_14 -->
<g id="edge1727" class="edge">
<title>ring_attn_2_2_stage_14&#45;&gt;ring_attn_2_3_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-6320C1608.02,-6320 1766.86,-6320 1766.86,-6320"/>
<polygon fill="red" stroke="red" points="1766.86,-6323.5 1776.86,-6320 1766.86,-6316.5 1766.86,-6323.5"/>
</g>
<!-- attn_out_2_2 -->
<g id="node264" class="node">
<title>attn_out_2_2</title>
<polygon fill="none" stroke="black" points="1468.5,-5926 1329.5,-5926 1329.5,-5873 1468.5,-5873 1468.5,-5926"/>
<text text-anchor="middle" x="1399" y="-5910.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1399" y="-5895.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="1399" y="-5880.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_2_2_stage_15&#45;&gt;attn_out_2_2 -->
<g id="edge261" class="edge">
<title>ring_attn_2_2_stage_15&#45;&gt;attn_out_2_2</title>
<path fill="none" stroke="black" d="M1399,-5998.87C1399,-5998.87 1399,-5936.18 1399,-5936.18"/>
<polygon fill="black" stroke="black" points="1402.5,-5936.18 1399,-5926.18 1395.5,-5936.18 1402.5,-5936.18"/>
</g>
<!-- ring_attn_2_3_stage_15 -->
<g id="node361" class="node">
<title>ring_attn_2_3_stage_15</title>
<polygon fill="yellow" stroke="black" points="1986,-6135 1777,-6067 1986,-5999 2195,-6067 1986,-6135"/>
<text text-anchor="middle" x="1986" y="-6085.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-6070.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="1986" y="-6055.8" font-family="Times,serif" font-size="14.00">Q[3]×K[4]×V[4]</text>
<text text-anchor="middle" x="1986" y="-6040.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_2_stage_15&#45;&gt;ring_attn_2_3_stage_15 -->
<g id="edge1728" class="edge">
<title>ring_attn_2_2_stage_15&#45;&gt;ring_attn_2_3_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-6067C1608.02,-6067 1766.86,-6067 1766.86,-6067"/>
<polygon fill="red" stroke="red" points="1766.86,-6070.5 1776.86,-6067 1766.86,-6063.5 1766.86,-6070.5"/>
</g>
<!-- attn_residual_2_2 -->
<g id="node265" class="node">
<title>attn_residual_2_2</title>
<ellipse fill="none" stroke="black" cx="1399" cy="-5773" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1399" y="-5776.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1399" y="-5761.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_2_2&#45;&gt;attn_residual_2_2 -->
<g id="edge262" class="edge">
<title>attn_out_2_2&#45;&gt;attn_residual_2_2</title>
<path fill="none" stroke="black" d="M1399,-5872.98C1399,-5872.98 1399,-5810.36 1399,-5810.36"/>
<polygon fill="black" stroke="black" points="1402.5,-5810.36 1399,-5800.36 1395.5,-5810.36 1402.5,-5810.36"/>
</g>
<!-- ffn_up_2_2 -->
<g id="node266" class="node">
<title>ffn_up_2_2</title>
<polygon fill="none" stroke="black" points="1478,-5673 1320,-5673 1320,-5620 1478,-5620 1478,-5673"/>
<text text-anchor="middle" x="1399" y="-5657.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1399" y="-5642.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="1399" y="-5627.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_2_2&#45;&gt;ffn_up_2_2 -->
<g id="edge263" class="edge">
<title>attn_residual_2_2&#45;&gt;ffn_up_2_2</title>
<path fill="none" stroke="black" d="M1399,-5745.86C1399,-5745.86 1399,-5683.16 1399,-5683.16"/>
<polygon fill="black" stroke="black" points="1402.5,-5683.16 1399,-5673.16 1395.5,-5683.16 1402.5,-5683.16"/>
</g>
<!-- ffn_gelu_2_2 -->
<g id="node267" class="node">
<title>ffn_gelu_2_2</title>
<ellipse fill="none" stroke="black" cx="1399" cy="-5520" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1399" y="-5523.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1399" y="-5508.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_2_2&#45;&gt;ffn_gelu_2_2 -->
<g id="edge264" class="edge">
<title>ffn_up_2_2&#45;&gt;ffn_gelu_2_2</title>
<path fill="none" stroke="black" d="M1399,-5619.98C1399,-5619.98 1399,-5557.36 1399,-5557.36"/>
<polygon fill="black" stroke="black" points="1402.5,-5557.36 1399,-5547.36 1395.5,-5557.36 1402.5,-5557.36"/>
</g>
<!-- ffn_down_2_2 -->
<g id="node268" class="node">
<title>ffn_down_2_2</title>
<polygon fill="none" stroke="black" points="1488,-5420 1310,-5420 1310,-5367 1488,-5367 1488,-5420"/>
<text text-anchor="middle" x="1399" y="-5404.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1399" y="-5389.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="1399" y="-5374.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_2_2&#45;&gt;ffn_down_2_2 -->
<g id="edge265" class="edge">
<title>ffn_gelu_2_2&#45;&gt;ffn_down_2_2</title>
<path fill="none" stroke="black" d="M1399,-5492.86C1399,-5492.86 1399,-5430.16 1399,-5430.16"/>
<polygon fill="black" stroke="black" points="1402.5,-5430.16 1399,-5420.16 1395.5,-5430.16 1402.5,-5430.16"/>
</g>
<!-- ffn_residual_2_2 -->
<g id="node269" class="node">
<title>ffn_residual_2_2</title>
<ellipse fill="none" stroke="black" cx="1399" cy="-5267" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1399" y="-5270.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1399" y="-5255.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_2_2&#45;&gt;ffn_residual_2_2 -->
<g id="edge266" class="edge">
<title>ffn_down_2_2&#45;&gt;ffn_residual_2_2</title>
<path fill="none" stroke="black" d="M1399,-5366.98C1399,-5366.98 1399,-5304.36 1399,-5304.36"/>
<polygon fill="black" stroke="black" points="1402.5,-5304.36 1399,-5294.36 1395.5,-5304.36 1402.5,-5304.36"/>
</g>
<!-- qkv_proj_3_2 -->
<g id="node270" class="node">
<title>qkv_proj_3_2</title>
<polygon fill="none" stroke="black" points="1481.5,-5167 1316.5,-5167 1316.5,-5114 1481.5,-5114 1481.5,-5167"/>
<text text-anchor="middle" x="1399" y="-5151.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1399" y="-5136.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="1399" y="-5121.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_2_2&#45;&gt;qkv_proj_3_2 -->
<g id="edge267" class="edge">
<title>ffn_residual_2_2&#45;&gt;qkv_proj_3_2</title>
<path fill="none" stroke="black" d="M1399,-5239.86C1399,-5239.86 1399,-5177.16 1399,-5177.16"/>
<polygon fill="black" stroke="black" points="1402.5,-5177.16 1399,-5167.16 1395.5,-5177.16 1402.5,-5177.16"/>
</g>
<!-- qkv_reshape_3_2 -->
<g id="node271" class="node">
<title>qkv_reshape_3_2</title>
<ellipse fill="none" stroke="black" cx="1399" cy="-5014" rx="148" ry="27"/>
<text text-anchor="middle" x="1399" y="-5017.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1399" y="-5002.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_3_2&#45;&gt;qkv_reshape_3_2 -->
<g id="edge268" class="edge">
<title>qkv_proj_3_2&#45;&gt;qkv_reshape_3_2</title>
<path fill="none" stroke="black" d="M1399,-5113.98C1399,-5113.98 1399,-5051.36 1399,-5051.36"/>
<polygon fill="black" stroke="black" points="1402.5,-5051.36 1399,-5041.36 1395.5,-5051.36 1402.5,-5051.36"/>
</g>
<!-- qkv_reshape_3_2&#45;&gt;ring_attn_3_2_stage_0 -->
<g id="edge269" class="edge">
<title>qkv_reshape_3_2&#45;&gt;ring_attn_3_2_stage_0</title>
<path fill="none" stroke="black" d="M1399,-4986.72C1399,-4986.72 1399,-4880.16 1399,-4880.16"/>
<polygon fill="black" stroke="black" points="1402.5,-4880.16 1399,-4870.16 1395.5,-4880.16 1402.5,-4880.16"/>
</g>
<!-- ring_attn_3_2_stage_0&#45;&gt;ring_attn_3_2_stage_1 -->
<g id="edge270" class="edge">
<title>ring_attn_3_2_stage_0&#45;&gt;ring_attn_3_2_stage_1</title>
<path fill="none" stroke="black" d="M1399,-4733.87C1399,-4733.87 1399,-4627.25 1399,-4627.25"/>
<polygon fill="black" stroke="black" points="1402.5,-4627.25 1399,-4617.25 1395.5,-4627.25 1402.5,-4627.25"/>
</g>
<!-- ring_attn_3_3_stage_0 -->
<g id="node370" class="node">
<title>ring_attn_3_3_stage_0</title>
<polygon fill="yellow" stroke="black" points="1986,-4870 1777,-4802 1986,-4734 2195,-4802 1986,-4870"/>
<text text-anchor="middle" x="1986" y="-4820.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-4805.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="1986" y="-4790.8" font-family="Times,serif" font-size="14.00">Q[3]×K[3]×V[3]</text>
<text text-anchor="middle" x="1986" y="-4775.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_2_stage_0&#45;&gt;ring_attn_3_3_stage_0 -->
<g id="edge1729" class="edge">
<title>ring_attn_3_2_stage_0&#45;&gt;ring_attn_3_3_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-4802C1608.02,-4802 1766.86,-4802 1766.86,-4802"/>
<polygon fill="red" stroke="red" points="1766.86,-4805.5 1776.86,-4802 1766.86,-4798.5 1766.86,-4805.5"/>
</g>
<!-- ring_attn_3_2_stage_1&#45;&gt;ring_attn_3_2_stage_2 -->
<g id="edge271" class="edge">
<title>ring_attn_3_2_stage_1&#45;&gt;ring_attn_3_2_stage_2</title>
<path fill="none" stroke="black" d="M1399,-4480.87C1399,-4480.87 1399,-4374.25 1399,-4374.25"/>
<polygon fill="black" stroke="black" points="1402.5,-4374.25 1399,-4364.25 1395.5,-4374.25 1402.5,-4374.25"/>
</g>
<!-- ring_attn_3_3_stage_1 -->
<g id="node371" class="node">
<title>ring_attn_3_3_stage_1</title>
<polygon fill="yellow" stroke="black" points="1986,-4617 1777,-4549 1986,-4481 2195,-4549 1986,-4617"/>
<text text-anchor="middle" x="1986" y="-4567.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-4552.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="1986" y="-4537.8" font-family="Times,serif" font-size="14.00">Q[3]×K[2]×V[2]</text>
<text text-anchor="middle" x="1986" y="-4522.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_2_stage_1&#45;&gt;ring_attn_3_3_stage_1 -->
<g id="edge1730" class="edge">
<title>ring_attn_3_2_stage_1&#45;&gt;ring_attn_3_3_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-4549C1608.02,-4549 1766.86,-4549 1766.86,-4549"/>
<polygon fill="red" stroke="red" points="1766.86,-4552.5 1776.86,-4549 1766.86,-4545.5 1766.86,-4552.5"/>
</g>
<!-- ring_attn_3_2_stage_2&#45;&gt;ring_attn_3_2_stage_3 -->
<g id="edge272" class="edge">
<title>ring_attn_3_2_stage_2&#45;&gt;ring_attn_3_2_stage_3</title>
<path fill="none" stroke="black" d="M1399,-4227.87C1399,-4227.87 1399,-4121.25 1399,-4121.25"/>
<polygon fill="black" stroke="black" points="1402.5,-4121.25 1399,-4111.25 1395.5,-4121.25 1402.5,-4121.25"/>
</g>
<!-- ring_attn_3_3_stage_2 -->
<g id="node372" class="node">
<title>ring_attn_3_3_stage_2</title>
<polygon fill="yellow" stroke="black" points="1986,-4364 1777,-4296 1986,-4228 2195,-4296 1986,-4364"/>
<text text-anchor="middle" x="1986" y="-4314.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-4299.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="1986" y="-4284.8" font-family="Times,serif" font-size="14.00">Q[3]×K[1]×V[1]</text>
<text text-anchor="middle" x="1986" y="-4269.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_2_stage_2&#45;&gt;ring_attn_3_3_stage_2 -->
<g id="edge1731" class="edge">
<title>ring_attn_3_2_stage_2&#45;&gt;ring_attn_3_3_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-4296C1608.02,-4296 1766.86,-4296 1766.86,-4296"/>
<polygon fill="red" stroke="red" points="1766.86,-4299.5 1776.86,-4296 1766.86,-4292.5 1766.86,-4299.5"/>
</g>
<!-- ring_attn_3_2_stage_3&#45;&gt;ring_attn_3_2_stage_4 -->
<g id="edge273" class="edge">
<title>ring_attn_3_2_stage_3&#45;&gt;ring_attn_3_2_stage_4</title>
<path fill="none" stroke="black" d="M1399,-3974.87C1399,-3974.87 1399,-3868.25 1399,-3868.25"/>
<polygon fill="black" stroke="black" points="1402.5,-3868.25 1399,-3858.25 1395.5,-3868.25 1402.5,-3868.25"/>
</g>
<!-- ring_attn_3_3_stage_3 -->
<g id="node373" class="node">
<title>ring_attn_3_3_stage_3</title>
<polygon fill="yellow" stroke="black" points="1986,-4111 1777,-4043 1986,-3975 2195,-4043 1986,-4111"/>
<text text-anchor="middle" x="1986" y="-4061.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-4046.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="1986" y="-4031.8" font-family="Times,serif" font-size="14.00">Q[3]×K[0]×V[0]</text>
<text text-anchor="middle" x="1986" y="-4016.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_2_stage_3&#45;&gt;ring_attn_3_3_stage_3 -->
<g id="edge1732" class="edge">
<title>ring_attn_3_2_stage_3&#45;&gt;ring_attn_3_3_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-4043C1608.02,-4043 1766.86,-4043 1766.86,-4043"/>
<polygon fill="red" stroke="red" points="1766.86,-4046.5 1776.86,-4043 1766.86,-4039.5 1766.86,-4046.5"/>
</g>
<!-- ring_attn_3_2_stage_4&#45;&gt;ring_attn_3_2_stage_5 -->
<g id="edge274" class="edge">
<title>ring_attn_3_2_stage_4&#45;&gt;ring_attn_3_2_stage_5</title>
<path fill="none" stroke="black" d="M1399,-3721.87C1399,-3721.87 1399,-3615.25 1399,-3615.25"/>
<polygon fill="black" stroke="black" points="1402.5,-3615.25 1399,-3605.25 1395.5,-3615.25 1402.5,-3615.25"/>
</g>
<!-- ring_attn_3_3_stage_4 -->
<g id="node374" class="node">
<title>ring_attn_3_3_stage_4</title>
<polygon fill="yellow" stroke="black" points="1986,-3858 1777,-3790 1986,-3722 2195,-3790 1986,-3858"/>
<text text-anchor="middle" x="1986" y="-3808.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-3793.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="1986" y="-3778.8" font-family="Times,serif" font-size="14.00">Q[3]×K[15]×V[15]</text>
<text text-anchor="middle" x="1986" y="-3763.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_2_stage_4&#45;&gt;ring_attn_3_3_stage_4 -->
<g id="edge1733" class="edge">
<title>ring_attn_3_2_stage_4&#45;&gt;ring_attn_3_3_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-3790C1608.02,-3790 1766.86,-3790 1766.86,-3790"/>
<polygon fill="red" stroke="red" points="1766.86,-3793.5 1776.86,-3790 1766.86,-3786.5 1766.86,-3793.5"/>
</g>
<!-- ring_attn_3_2_stage_5&#45;&gt;ring_attn_3_2_stage_6 -->
<g id="edge275" class="edge">
<title>ring_attn_3_2_stage_5&#45;&gt;ring_attn_3_2_stage_6</title>
<path fill="none" stroke="black" d="M1399,-3468.87C1399,-3468.87 1399,-3362.25 1399,-3362.25"/>
<polygon fill="black" stroke="black" points="1402.5,-3362.25 1399,-3352.25 1395.5,-3362.25 1402.5,-3362.25"/>
</g>
<!-- ring_attn_3_3_stage_5 -->
<g id="node375" class="node">
<title>ring_attn_3_3_stage_5</title>
<polygon fill="yellow" stroke="black" points="1986,-3605 1777,-3537 1986,-3469 2195,-3537 1986,-3605"/>
<text text-anchor="middle" x="1986" y="-3555.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-3540.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="1986" y="-3525.8" font-family="Times,serif" font-size="14.00">Q[3]×K[14]×V[14]</text>
<text text-anchor="middle" x="1986" y="-3510.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_2_stage_5&#45;&gt;ring_attn_3_3_stage_5 -->
<g id="edge1734" class="edge">
<title>ring_attn_3_2_stage_5&#45;&gt;ring_attn_3_3_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-3537C1608.02,-3537 1766.86,-3537 1766.86,-3537"/>
<polygon fill="red" stroke="red" points="1766.86,-3540.5 1776.86,-3537 1766.86,-3533.5 1766.86,-3540.5"/>
</g>
<!-- ring_attn_3_2_stage_6&#45;&gt;ring_attn_3_2_stage_7 -->
<g id="edge276" class="edge">
<title>ring_attn_3_2_stage_6&#45;&gt;ring_attn_3_2_stage_7</title>
<path fill="none" stroke="black" d="M1399,-3215.87C1399,-3215.87 1399,-3109.25 1399,-3109.25"/>
<polygon fill="black" stroke="black" points="1402.5,-3109.25 1399,-3099.25 1395.5,-3109.25 1402.5,-3109.25"/>
</g>
<!-- ring_attn_3_3_stage_6 -->
<g id="node376" class="node">
<title>ring_attn_3_3_stage_6</title>
<polygon fill="yellow" stroke="black" points="1986,-3352 1777,-3284 1986,-3216 2195,-3284 1986,-3352"/>
<text text-anchor="middle" x="1986" y="-3302.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-3287.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="1986" y="-3272.8" font-family="Times,serif" font-size="14.00">Q[3]×K[13]×V[13]</text>
<text text-anchor="middle" x="1986" y="-3257.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_2_stage_6&#45;&gt;ring_attn_3_3_stage_6 -->
<g id="edge1735" class="edge">
<title>ring_attn_3_2_stage_6&#45;&gt;ring_attn_3_3_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-3284C1608.02,-3284 1766.86,-3284 1766.86,-3284"/>
<polygon fill="red" stroke="red" points="1766.86,-3287.5 1776.86,-3284 1766.86,-3280.5 1766.86,-3287.5"/>
</g>
<!-- ring_attn_3_2_stage_7&#45;&gt;ring_attn_3_2_stage_8 -->
<g id="edge277" class="edge">
<title>ring_attn_3_2_stage_7&#45;&gt;ring_attn_3_2_stage_8</title>
<path fill="none" stroke="black" d="M1399,-2962.87C1399,-2962.87 1399,-2856.25 1399,-2856.25"/>
<polygon fill="black" stroke="black" points="1402.5,-2856.25 1399,-2846.25 1395.5,-2856.25 1402.5,-2856.25"/>
</g>
<!-- ring_attn_3_3_stage_7 -->
<g id="node377" class="node">
<title>ring_attn_3_3_stage_7</title>
<polygon fill="yellow" stroke="black" points="1986,-3099 1777,-3031 1986,-2963 2195,-3031 1986,-3099"/>
<text text-anchor="middle" x="1986" y="-3049.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-3034.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="1986" y="-3019.8" font-family="Times,serif" font-size="14.00">Q[3]×K[12]×V[12]</text>
<text text-anchor="middle" x="1986" y="-3004.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_2_stage_7&#45;&gt;ring_attn_3_3_stage_7 -->
<g id="edge1736" class="edge">
<title>ring_attn_3_2_stage_7&#45;&gt;ring_attn_3_3_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-3031C1608.02,-3031 1766.86,-3031 1766.86,-3031"/>
<polygon fill="red" stroke="red" points="1766.86,-3034.5 1776.86,-3031 1766.86,-3027.5 1766.86,-3034.5"/>
</g>
<!-- ring_attn_3_2_stage_8&#45;&gt;ring_attn_3_2_stage_9 -->
<g id="edge278" class="edge">
<title>ring_attn_3_2_stage_8&#45;&gt;ring_attn_3_2_stage_9</title>
<path fill="none" stroke="black" d="M1399,-2709.87C1399,-2709.87 1399,-2603.25 1399,-2603.25"/>
<polygon fill="black" stroke="black" points="1402.5,-2603.25 1399,-2593.25 1395.5,-2603.25 1402.5,-2603.25"/>
</g>
<!-- ring_attn_3_3_stage_8 -->
<g id="node378" class="node">
<title>ring_attn_3_3_stage_8</title>
<polygon fill="yellow" stroke="black" points="1986,-2846 1777,-2778 1986,-2710 2195,-2778 1986,-2846"/>
<text text-anchor="middle" x="1986" y="-2796.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-2781.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="1986" y="-2766.8" font-family="Times,serif" font-size="14.00">Q[3]×K[11]×V[11]</text>
<text text-anchor="middle" x="1986" y="-2751.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_2_stage_8&#45;&gt;ring_attn_3_3_stage_8 -->
<g id="edge1737" class="edge">
<title>ring_attn_3_2_stage_8&#45;&gt;ring_attn_3_3_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-2778C1608.02,-2778 1766.86,-2778 1766.86,-2778"/>
<polygon fill="red" stroke="red" points="1766.86,-2781.5 1776.86,-2778 1766.86,-2774.5 1766.86,-2781.5"/>
</g>
<!-- ring_attn_3_2_stage_9&#45;&gt;ring_attn_3_2_stage_10 -->
<g id="edge279" class="edge">
<title>ring_attn_3_2_stage_9&#45;&gt;ring_attn_3_2_stage_10</title>
<path fill="none" stroke="black" d="M1399,-2456.87C1399,-2456.87 1399,-2350.25 1399,-2350.25"/>
<polygon fill="black" stroke="black" points="1402.5,-2350.25 1399,-2340.25 1395.5,-2350.25 1402.5,-2350.25"/>
</g>
<!-- ring_attn_3_3_stage_9 -->
<g id="node379" class="node">
<title>ring_attn_3_3_stage_9</title>
<polygon fill="yellow" stroke="black" points="1986,-2593 1777,-2525 1986,-2457 2195,-2525 1986,-2593"/>
<text text-anchor="middle" x="1986" y="-2543.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-2528.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="1986" y="-2513.8" font-family="Times,serif" font-size="14.00">Q[3]×K[10]×V[10]</text>
<text text-anchor="middle" x="1986" y="-2498.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_2_stage_9&#45;&gt;ring_attn_3_3_stage_9 -->
<g id="edge1738" class="edge">
<title>ring_attn_3_2_stage_9&#45;&gt;ring_attn_3_3_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-2525C1608.02,-2525 1766.86,-2525 1766.86,-2525"/>
<polygon fill="red" stroke="red" points="1766.86,-2528.5 1776.86,-2525 1766.86,-2521.5 1766.86,-2528.5"/>
</g>
<!-- ring_attn_3_2_stage_10&#45;&gt;ring_attn_3_2_stage_11 -->
<g id="edge280" class="edge">
<title>ring_attn_3_2_stage_10&#45;&gt;ring_attn_3_2_stage_11</title>
<path fill="none" stroke="black" d="M1399,-2203.87C1399,-2203.87 1399,-2097.25 1399,-2097.25"/>
<polygon fill="black" stroke="black" points="1402.5,-2097.25 1399,-2087.25 1395.5,-2097.25 1402.5,-2097.25"/>
</g>
<!-- ring_attn_3_3_stage_10 -->
<g id="node380" class="node">
<title>ring_attn_3_3_stage_10</title>
<polygon fill="yellow" stroke="black" points="1986,-2340 1777,-2272 1986,-2204 2195,-2272 1986,-2340"/>
<text text-anchor="middle" x="1986" y="-2290.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-2275.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="1986" y="-2260.8" font-family="Times,serif" font-size="14.00">Q[3]×K[9]×V[9]</text>
<text text-anchor="middle" x="1986" y="-2245.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_2_stage_10&#45;&gt;ring_attn_3_3_stage_10 -->
<g id="edge1739" class="edge">
<title>ring_attn_3_2_stage_10&#45;&gt;ring_attn_3_3_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-2272C1608.02,-2272 1766.86,-2272 1766.86,-2272"/>
<polygon fill="red" stroke="red" points="1766.86,-2275.5 1776.86,-2272 1766.86,-2268.5 1766.86,-2275.5"/>
</g>
<!-- ring_attn_3_2_stage_11&#45;&gt;ring_attn_3_2_stage_12 -->
<g id="edge281" class="edge">
<title>ring_attn_3_2_stage_11&#45;&gt;ring_attn_3_2_stage_12</title>
<path fill="none" stroke="black" d="M1399,-1950.87C1399,-1950.87 1399,-1844.25 1399,-1844.25"/>
<polygon fill="black" stroke="black" points="1402.5,-1844.25 1399,-1834.25 1395.5,-1844.25 1402.5,-1844.25"/>
</g>
<!-- ring_attn_3_3_stage_11 -->
<g id="node381" class="node">
<title>ring_attn_3_3_stage_11</title>
<polygon fill="yellow" stroke="black" points="1986,-2087 1777,-2019 1986,-1951 2195,-2019 1986,-2087"/>
<text text-anchor="middle" x="1986" y="-2037.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-2022.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="1986" y="-2007.8" font-family="Times,serif" font-size="14.00">Q[3]×K[8]×V[8]</text>
<text text-anchor="middle" x="1986" y="-1992.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_2_stage_11&#45;&gt;ring_attn_3_3_stage_11 -->
<g id="edge1740" class="edge">
<title>ring_attn_3_2_stage_11&#45;&gt;ring_attn_3_3_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-2019C1608.02,-2019 1766.86,-2019 1766.86,-2019"/>
<polygon fill="red" stroke="red" points="1766.86,-2022.5 1776.86,-2019 1766.86,-2015.5 1766.86,-2022.5"/>
</g>
<!-- ring_attn_3_2_stage_12&#45;&gt;ring_attn_3_2_stage_13 -->
<g id="edge282" class="edge">
<title>ring_attn_3_2_stage_12&#45;&gt;ring_attn_3_2_stage_13</title>
<path fill="none" stroke="black" d="M1399,-1697.87C1399,-1697.87 1399,-1591.25 1399,-1591.25"/>
<polygon fill="black" stroke="black" points="1402.5,-1591.25 1399,-1581.25 1395.5,-1591.25 1402.5,-1591.25"/>
</g>
<!-- ring_attn_3_3_stage_12 -->
<g id="node382" class="node">
<title>ring_attn_3_3_stage_12</title>
<polygon fill="yellow" stroke="black" points="1986,-1834 1777,-1766 1986,-1698 2195,-1766 1986,-1834"/>
<text text-anchor="middle" x="1986" y="-1784.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-1769.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="1986" y="-1754.8" font-family="Times,serif" font-size="14.00">Q[3]×K[7]×V[7]</text>
<text text-anchor="middle" x="1986" y="-1739.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_2_stage_12&#45;&gt;ring_attn_3_3_stage_12 -->
<g id="edge1741" class="edge">
<title>ring_attn_3_2_stage_12&#45;&gt;ring_attn_3_3_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-1766C1608.02,-1766 1766.86,-1766 1766.86,-1766"/>
<polygon fill="red" stroke="red" points="1766.86,-1769.5 1776.86,-1766 1766.86,-1762.5 1766.86,-1769.5"/>
</g>
<!-- ring_attn_3_2_stage_13&#45;&gt;ring_attn_3_2_stage_14 -->
<g id="edge283" class="edge">
<title>ring_attn_3_2_stage_13&#45;&gt;ring_attn_3_2_stage_14</title>
<path fill="none" stroke="black" d="M1399,-1444.87C1399,-1444.87 1399,-1338.25 1399,-1338.25"/>
<polygon fill="black" stroke="black" points="1402.5,-1338.25 1399,-1328.25 1395.5,-1338.25 1402.5,-1338.25"/>
</g>
<!-- ring_attn_3_3_stage_13 -->
<g id="node383" class="node">
<title>ring_attn_3_3_stage_13</title>
<polygon fill="yellow" stroke="black" points="1986,-1581 1777,-1513 1986,-1445 2195,-1513 1986,-1581"/>
<text text-anchor="middle" x="1986" y="-1531.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-1516.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="1986" y="-1501.8" font-family="Times,serif" font-size="14.00">Q[3]×K[6]×V[6]</text>
<text text-anchor="middle" x="1986" y="-1486.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_2_stage_13&#45;&gt;ring_attn_3_3_stage_13 -->
<g id="edge1742" class="edge">
<title>ring_attn_3_2_stage_13&#45;&gt;ring_attn_3_3_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-1513C1608.02,-1513 1766.86,-1513 1766.86,-1513"/>
<polygon fill="red" stroke="red" points="1766.86,-1516.5 1776.86,-1513 1766.86,-1509.5 1766.86,-1516.5"/>
</g>
<!-- ring_attn_3_2_stage_14&#45;&gt;ring_attn_3_2_stage_15 -->
<g id="edge284" class="edge">
<title>ring_attn_3_2_stage_14&#45;&gt;ring_attn_3_2_stage_15</title>
<path fill="none" stroke="black" d="M1399,-1191.87C1399,-1191.87 1399,-1085.25 1399,-1085.25"/>
<polygon fill="black" stroke="black" points="1402.5,-1085.25 1399,-1075.25 1395.5,-1085.25 1402.5,-1085.25"/>
</g>
<!-- ring_attn_3_3_stage_14 -->
<g id="node384" class="node">
<title>ring_attn_3_3_stage_14</title>
<polygon fill="yellow" stroke="black" points="1986,-1328 1777,-1260 1986,-1192 2195,-1260 1986,-1328"/>
<text text-anchor="middle" x="1986" y="-1278.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-1263.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="1986" y="-1248.8" font-family="Times,serif" font-size="14.00">Q[3]×K[5]×V[5]</text>
<text text-anchor="middle" x="1986" y="-1233.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_2_stage_14&#45;&gt;ring_attn_3_3_stage_14 -->
<g id="edge1743" class="edge">
<title>ring_attn_3_2_stage_14&#45;&gt;ring_attn_3_3_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-1260C1608.02,-1260 1766.86,-1260 1766.86,-1260"/>
<polygon fill="red" stroke="red" points="1766.86,-1263.5 1776.86,-1260 1766.86,-1256.5 1766.86,-1263.5"/>
</g>
<!-- attn_out_3_2 -->
<g id="node288" class="node">
<title>attn_out_3_2</title>
<polygon fill="none" stroke="black" points="1468.5,-866 1329.5,-866 1329.5,-813 1468.5,-813 1468.5,-866"/>
<text text-anchor="middle" x="1399" y="-850.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1399" y="-835.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="1399" y="-820.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_3_2_stage_15&#45;&gt;attn_out_3_2 -->
<g id="edge285" class="edge">
<title>ring_attn_3_2_stage_15&#45;&gt;attn_out_3_2</title>
<path fill="none" stroke="black" d="M1399,-938.87C1399,-938.87 1399,-876.18 1399,-876.18"/>
<polygon fill="black" stroke="black" points="1402.5,-876.18 1399,-866.18 1395.5,-876.18 1402.5,-876.18"/>
</g>
<!-- ring_attn_3_3_stage_15 -->
<g id="node385" class="node">
<title>ring_attn_3_3_stage_15</title>
<polygon fill="yellow" stroke="black" points="1986,-1075 1777,-1007 1986,-939 2195,-1007 1986,-1075"/>
<text text-anchor="middle" x="1986" y="-1025.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="1986" y="-1010.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="1986" y="-995.8" font-family="Times,serif" font-size="14.00">Q[3]×K[4]×V[4]</text>
<text text-anchor="middle" x="1986" y="-980.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_2_stage_15&#45;&gt;ring_attn_3_3_stage_15 -->
<g id="edge1744" class="edge">
<title>ring_attn_3_2_stage_15&#45;&gt;ring_attn_3_3_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1608.02,-1007C1608.02,-1007 1766.86,-1007 1766.86,-1007"/>
<polygon fill="red" stroke="red" points="1766.86,-1010.5 1776.86,-1007 1766.86,-1003.5 1766.86,-1010.5"/>
</g>
<!-- attn_residual_3_2 -->
<g id="node289" class="node">
<title>attn_residual_3_2</title>
<ellipse fill="none" stroke="black" cx="1399" cy="-713" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1399" y="-716.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1399" y="-701.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_3_2&#45;&gt;attn_residual_3_2 -->
<g id="edge286" class="edge">
<title>attn_out_3_2&#45;&gt;attn_residual_3_2</title>
<path fill="none" stroke="black" d="M1399,-812.98C1399,-812.98 1399,-750.36 1399,-750.36"/>
<polygon fill="black" stroke="black" points="1402.5,-750.36 1399,-740.36 1395.5,-750.36 1402.5,-750.36"/>
</g>
<!-- ffn_up_3_2 -->
<g id="node290" class="node">
<title>ffn_up_3_2</title>
<polygon fill="none" stroke="black" points="1478,-613 1320,-613 1320,-560 1478,-560 1478,-613"/>
<text text-anchor="middle" x="1399" y="-597.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1399" y="-582.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="1399" y="-567.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_3_2&#45;&gt;ffn_up_3_2 -->
<g id="edge287" class="edge">
<title>attn_residual_3_2&#45;&gt;ffn_up_3_2</title>
<path fill="none" stroke="black" d="M1399,-685.86C1399,-685.86 1399,-623.16 1399,-623.16"/>
<polygon fill="black" stroke="black" points="1402.5,-623.16 1399,-613.16 1395.5,-623.16 1402.5,-623.16"/>
</g>
<!-- ffn_gelu_3_2 -->
<g id="node291" class="node">
<title>ffn_gelu_3_2</title>
<ellipse fill="none" stroke="black" cx="1399" cy="-460" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1399" y="-463.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1399" y="-448.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_3_2&#45;&gt;ffn_gelu_3_2 -->
<g id="edge288" class="edge">
<title>ffn_up_3_2&#45;&gt;ffn_gelu_3_2</title>
<path fill="none" stroke="black" d="M1399,-559.98C1399,-559.98 1399,-497.36 1399,-497.36"/>
<polygon fill="black" stroke="black" points="1402.5,-497.36 1399,-487.36 1395.5,-497.36 1402.5,-497.36"/>
</g>
<!-- ffn_down_3_2 -->
<g id="node292" class="node">
<title>ffn_down_3_2</title>
<polygon fill="none" stroke="black" points="1488,-360 1310,-360 1310,-307 1488,-307 1488,-360"/>
<text text-anchor="middle" x="1399" y="-344.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1399" y="-329.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="1399" y="-314.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_3_2&#45;&gt;ffn_down_3_2 -->
<g id="edge289" class="edge">
<title>ffn_gelu_3_2&#45;&gt;ffn_down_3_2</title>
<path fill="none" stroke="black" d="M1399,-432.86C1399,-432.86 1399,-370.16 1399,-370.16"/>
<polygon fill="black" stroke="black" points="1402.5,-370.16 1399,-360.16 1395.5,-370.16 1402.5,-370.16"/>
</g>
<!-- ffn_residual_3_2 -->
<g id="node293" class="node">
<title>ffn_residual_3_2</title>
<ellipse fill="none" stroke="black" cx="1399" cy="-207" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1399" y="-210.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1399" y="-195.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_3_2&#45;&gt;ffn_residual_3_2 -->
<g id="edge290" class="edge">
<title>ffn_down_3_2&#45;&gt;ffn_residual_3_2</title>
<path fill="none" stroke="black" d="M1399,-306.98C1399,-306.98 1399,-244.36 1399,-244.36"/>
<polygon fill="black" stroke="black" points="1402.5,-244.36 1399,-234.36 1395.5,-244.36 1402.5,-244.36"/>
</g>
<!-- output_2 -->
<g id="node294" class="node">
<title>output_2</title>
<polygon fill="lightcoral" stroke="black" points="1492,-107 1306,-107 1306,-69 1492,-69 1492,-107"/>
<text text-anchor="middle" x="1399" y="-91.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="1399" y="-76.8" font-family="Times,serif" font-size="14.00">Y[2]: 1024×1024×4096</text>
</g>
<!-- ffn_residual_3_2&#45;&gt;output_2 -->
<g id="edge291" class="edge">
<title>ffn_residual_3_2&#45;&gt;output_2</title>
<path fill="none" stroke="black" d="M1399,-180C1399,-180 1399,-117.12 1399,-117.12"/>
<polygon fill="black" stroke="black" points="1402.5,-117.12 1399,-107.12 1395.5,-117.12 1402.5,-117.12"/>
</g>
<!-- input_3 -->
<g id="node295" class="node">
<title>input_3</title>
<polygon fill="lightgreen" stroke="black" points="2079.5,-20458 1892.5,-20458 1892.5,-20420 2079.5,-20420 2079.5,-20458"/>
<text text-anchor="middle" x="1986" y="-20442.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1986" y="-20427.8" font-family="Times,serif" font-size="14.00">X[3]: 1024×1024×4096</text>
</g>
<!-- qkv_proj_0_3 -->
<g id="node296" class="node">
<title>qkv_proj_0_3</title>
<polygon fill="none" stroke="black" points="2068.5,-20347 1903.5,-20347 1903.5,-20294 2068.5,-20294 2068.5,-20347"/>
<text text-anchor="middle" x="1986" y="-20331.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1986" y="-20316.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="1986" y="-20301.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- input_3&#45;&gt;qkv_proj_0_3 -->
<g id="edge292" class="edge">
<title>input_3&#45;&gt;qkv_proj_0_3</title>
<path fill="none" stroke="black" d="M1986,-20419.96C1986,-20419.96 1986,-20357.44 1986,-20357.44"/>
<polygon fill="black" stroke="black" points="1989.5,-20357.44 1986,-20347.44 1982.5,-20357.44 1989.5,-20357.44"/>
</g>
<!-- qkv_reshape_0_3 -->
<g id="node297" class="node">
<title>qkv_reshape_0_3</title>
<ellipse fill="none" stroke="black" cx="1986" cy="-20194" rx="148" ry="27"/>
<text text-anchor="middle" x="1986" y="-20197.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1986" y="-20182.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_0_3&#45;&gt;qkv_reshape_0_3 -->
<g id="edge293" class="edge">
<title>qkv_proj_0_3&#45;&gt;qkv_reshape_0_3</title>
<path fill="none" stroke="black" d="M1986,-20293.98C1986,-20293.98 1986,-20231.36 1986,-20231.36"/>
<polygon fill="black" stroke="black" points="1989.5,-20231.36 1986,-20221.36 1982.5,-20231.36 1989.5,-20231.36"/>
</g>
<!-- qkv_reshape_0_3&#45;&gt;ring_attn_0_3_stage_0 -->
<g id="edge294" class="edge">
<title>qkv_reshape_0_3&#45;&gt;ring_attn_0_3_stage_0</title>
<path fill="none" stroke="black" d="M1986,-20166.72C1986,-20166.72 1986,-20060.16 1986,-20060.16"/>
<polygon fill="black" stroke="black" points="1989.5,-20060.16 1986,-20050.16 1982.5,-20060.16 1989.5,-20060.16"/>
</g>
<!-- ring_attn_0_3_stage_0&#45;&gt;ring_attn_0_3_stage_1 -->
<g id="edge295" class="edge">
<title>ring_attn_0_3_stage_0&#45;&gt;ring_attn_0_3_stage_1</title>
<path fill="none" stroke="black" d="M1986,-19913.87C1986,-19913.87 1986,-19807.25 1986,-19807.25"/>
<polygon fill="black" stroke="black" points="1989.5,-19807.25 1986,-19797.25 1982.5,-19807.25 1989.5,-19807.25"/>
</g>
<!-- ring_attn_0_4_stage_0 -->
<g id="node396" class="node">
<title>ring_attn_0_4_stage_0</title>
<polygon fill="yellow" stroke="black" points="2573,-20050 2364,-19982 2573,-19914 2782,-19982 2573,-20050"/>
<text text-anchor="middle" x="2573" y="-20000.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-19985.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="2573" y="-19970.8" font-family="Times,serif" font-size="14.00">Q[4]×K[4]×V[4]</text>
<text text-anchor="middle" x="2573" y="-19955.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_3_stage_0&#45;&gt;ring_attn_0_4_stage_0 -->
<g id="edge1745" class="edge">
<title>ring_attn_0_3_stage_0&#45;&gt;ring_attn_0_4_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-19982C2195.02,-19982 2353.86,-19982 2353.86,-19982"/>
<polygon fill="red" stroke="red" points="2353.86,-19985.5 2363.86,-19982 2353.86,-19978.5 2353.86,-19985.5"/>
</g>
<!-- ring_attn_0_3_stage_1&#45;&gt;ring_attn_0_3_stage_2 -->
<g id="edge296" class="edge">
<title>ring_attn_0_3_stage_1&#45;&gt;ring_attn_0_3_stage_2</title>
<path fill="none" stroke="black" d="M1986,-19660.87C1986,-19660.87 1986,-19554.25 1986,-19554.25"/>
<polygon fill="black" stroke="black" points="1989.5,-19554.25 1986,-19544.25 1982.5,-19554.25 1989.5,-19554.25"/>
</g>
<!-- ring_attn_0_4_stage_1 -->
<g id="node397" class="node">
<title>ring_attn_0_4_stage_1</title>
<polygon fill="yellow" stroke="black" points="2573,-19797 2364,-19729 2573,-19661 2782,-19729 2573,-19797"/>
<text text-anchor="middle" x="2573" y="-19747.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-19732.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="2573" y="-19717.8" font-family="Times,serif" font-size="14.00">Q[4]×K[3]×V[3]</text>
<text text-anchor="middle" x="2573" y="-19702.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_3_stage_1&#45;&gt;ring_attn_0_4_stage_1 -->
<g id="edge1746" class="edge">
<title>ring_attn_0_3_stage_1&#45;&gt;ring_attn_0_4_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-19729C2195.02,-19729 2353.86,-19729 2353.86,-19729"/>
<polygon fill="red" stroke="red" points="2353.86,-19732.5 2363.86,-19729 2353.86,-19725.5 2353.86,-19732.5"/>
</g>
<!-- ring_attn_0_3_stage_2&#45;&gt;ring_attn_0_3_stage_3 -->
<g id="edge297" class="edge">
<title>ring_attn_0_3_stage_2&#45;&gt;ring_attn_0_3_stage_3</title>
<path fill="none" stroke="black" d="M1986,-19407.87C1986,-19407.87 1986,-19301.25 1986,-19301.25"/>
<polygon fill="black" stroke="black" points="1989.5,-19301.25 1986,-19291.25 1982.5,-19301.25 1989.5,-19301.25"/>
</g>
<!-- ring_attn_0_4_stage_2 -->
<g id="node398" class="node">
<title>ring_attn_0_4_stage_2</title>
<polygon fill="yellow" stroke="black" points="2573,-19544 2364,-19476 2573,-19408 2782,-19476 2573,-19544"/>
<text text-anchor="middle" x="2573" y="-19494.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-19479.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="2573" y="-19464.8" font-family="Times,serif" font-size="14.00">Q[4]×K[2]×V[2]</text>
<text text-anchor="middle" x="2573" y="-19449.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_3_stage_2&#45;&gt;ring_attn_0_4_stage_2 -->
<g id="edge1747" class="edge">
<title>ring_attn_0_3_stage_2&#45;&gt;ring_attn_0_4_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-19476C2195.02,-19476 2353.86,-19476 2353.86,-19476"/>
<polygon fill="red" stroke="red" points="2353.86,-19479.5 2363.86,-19476 2353.86,-19472.5 2353.86,-19479.5"/>
</g>
<!-- ring_attn_0_3_stage_3&#45;&gt;ring_attn_0_3_stage_4 -->
<g id="edge298" class="edge">
<title>ring_attn_0_3_stage_3&#45;&gt;ring_attn_0_3_stage_4</title>
<path fill="none" stroke="black" d="M1986,-19154.87C1986,-19154.87 1986,-19048.25 1986,-19048.25"/>
<polygon fill="black" stroke="black" points="1989.5,-19048.25 1986,-19038.25 1982.5,-19048.25 1989.5,-19048.25"/>
</g>
<!-- ring_attn_0_4_stage_3 -->
<g id="node399" class="node">
<title>ring_attn_0_4_stage_3</title>
<polygon fill="yellow" stroke="black" points="2573,-19291 2364,-19223 2573,-19155 2782,-19223 2573,-19291"/>
<text text-anchor="middle" x="2573" y="-19241.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-19226.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="2573" y="-19211.8" font-family="Times,serif" font-size="14.00">Q[4]×K[1]×V[1]</text>
<text text-anchor="middle" x="2573" y="-19196.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_3_stage_3&#45;&gt;ring_attn_0_4_stage_3 -->
<g id="edge1748" class="edge">
<title>ring_attn_0_3_stage_3&#45;&gt;ring_attn_0_4_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-19223C2195.02,-19223 2353.86,-19223 2353.86,-19223"/>
<polygon fill="red" stroke="red" points="2353.86,-19226.5 2363.86,-19223 2353.86,-19219.5 2353.86,-19226.5"/>
</g>
<!-- ring_attn_0_3_stage_4&#45;&gt;ring_attn_0_3_stage_5 -->
<g id="edge299" class="edge">
<title>ring_attn_0_3_stage_4&#45;&gt;ring_attn_0_3_stage_5</title>
<path fill="none" stroke="black" d="M1986,-18901.87C1986,-18901.87 1986,-18795.25 1986,-18795.25"/>
<polygon fill="black" stroke="black" points="1989.5,-18795.25 1986,-18785.25 1982.5,-18795.25 1989.5,-18795.25"/>
</g>
<!-- ring_attn_0_4_stage_4 -->
<g id="node400" class="node">
<title>ring_attn_0_4_stage_4</title>
<polygon fill="yellow" stroke="black" points="2573,-19038 2364,-18970 2573,-18902 2782,-18970 2573,-19038"/>
<text text-anchor="middle" x="2573" y="-18988.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-18973.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="2573" y="-18958.8" font-family="Times,serif" font-size="14.00">Q[4]×K[0]×V[0]</text>
<text text-anchor="middle" x="2573" y="-18943.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_3_stage_4&#45;&gt;ring_attn_0_4_stage_4 -->
<g id="edge1749" class="edge">
<title>ring_attn_0_3_stage_4&#45;&gt;ring_attn_0_4_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-18970C2195.02,-18970 2353.86,-18970 2353.86,-18970"/>
<polygon fill="red" stroke="red" points="2353.86,-18973.5 2363.86,-18970 2353.86,-18966.5 2353.86,-18973.5"/>
</g>
<!-- ring_attn_0_3_stage_5&#45;&gt;ring_attn_0_3_stage_6 -->
<g id="edge300" class="edge">
<title>ring_attn_0_3_stage_5&#45;&gt;ring_attn_0_3_stage_6</title>
<path fill="none" stroke="black" d="M1986,-18648.87C1986,-18648.87 1986,-18542.25 1986,-18542.25"/>
<polygon fill="black" stroke="black" points="1989.5,-18542.25 1986,-18532.25 1982.5,-18542.25 1989.5,-18542.25"/>
</g>
<!-- ring_attn_0_4_stage_5 -->
<g id="node401" class="node">
<title>ring_attn_0_4_stage_5</title>
<polygon fill="yellow" stroke="black" points="2573,-18785 2364,-18717 2573,-18649 2782,-18717 2573,-18785"/>
<text text-anchor="middle" x="2573" y="-18735.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-18720.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="2573" y="-18705.8" font-family="Times,serif" font-size="14.00">Q[4]×K[15]×V[15]</text>
<text text-anchor="middle" x="2573" y="-18690.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_3_stage_5&#45;&gt;ring_attn_0_4_stage_5 -->
<g id="edge1750" class="edge">
<title>ring_attn_0_3_stage_5&#45;&gt;ring_attn_0_4_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-18717C2195.02,-18717 2353.86,-18717 2353.86,-18717"/>
<polygon fill="red" stroke="red" points="2353.86,-18720.5 2363.86,-18717 2353.86,-18713.5 2353.86,-18720.5"/>
</g>
<!-- ring_attn_0_3_stage_6&#45;&gt;ring_attn_0_3_stage_7 -->
<g id="edge301" class="edge">
<title>ring_attn_0_3_stage_6&#45;&gt;ring_attn_0_3_stage_7</title>
<path fill="none" stroke="black" d="M1986,-18395.87C1986,-18395.87 1986,-18289.25 1986,-18289.25"/>
<polygon fill="black" stroke="black" points="1989.5,-18289.25 1986,-18279.25 1982.5,-18289.25 1989.5,-18289.25"/>
</g>
<!-- ring_attn_0_4_stage_6 -->
<g id="node402" class="node">
<title>ring_attn_0_4_stage_6</title>
<polygon fill="yellow" stroke="black" points="2573,-18532 2364,-18464 2573,-18396 2782,-18464 2573,-18532"/>
<text text-anchor="middle" x="2573" y="-18482.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-18467.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="2573" y="-18452.8" font-family="Times,serif" font-size="14.00">Q[4]×K[14]×V[14]</text>
<text text-anchor="middle" x="2573" y="-18437.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_3_stage_6&#45;&gt;ring_attn_0_4_stage_6 -->
<g id="edge1751" class="edge">
<title>ring_attn_0_3_stage_6&#45;&gt;ring_attn_0_4_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-18464C2195.02,-18464 2353.86,-18464 2353.86,-18464"/>
<polygon fill="red" stroke="red" points="2353.86,-18467.5 2363.86,-18464 2353.86,-18460.5 2353.86,-18467.5"/>
</g>
<!-- ring_attn_0_3_stage_7&#45;&gt;ring_attn_0_3_stage_8 -->
<g id="edge302" class="edge">
<title>ring_attn_0_3_stage_7&#45;&gt;ring_attn_0_3_stage_8</title>
<path fill="none" stroke="black" d="M1986,-18142.87C1986,-18142.87 1986,-18036.25 1986,-18036.25"/>
<polygon fill="black" stroke="black" points="1989.5,-18036.25 1986,-18026.25 1982.5,-18036.25 1989.5,-18036.25"/>
</g>
<!-- ring_attn_0_4_stage_7 -->
<g id="node403" class="node">
<title>ring_attn_0_4_stage_7</title>
<polygon fill="yellow" stroke="black" points="2573,-18279 2364,-18211 2573,-18143 2782,-18211 2573,-18279"/>
<text text-anchor="middle" x="2573" y="-18229.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-18214.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="2573" y="-18199.8" font-family="Times,serif" font-size="14.00">Q[4]×K[13]×V[13]</text>
<text text-anchor="middle" x="2573" y="-18184.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_3_stage_7&#45;&gt;ring_attn_0_4_stage_7 -->
<g id="edge1752" class="edge">
<title>ring_attn_0_3_stage_7&#45;&gt;ring_attn_0_4_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-18211C2195.02,-18211 2353.86,-18211 2353.86,-18211"/>
<polygon fill="red" stroke="red" points="2353.86,-18214.5 2363.86,-18211 2353.86,-18207.5 2353.86,-18214.5"/>
</g>
<!-- ring_attn_0_3_stage_8&#45;&gt;ring_attn_0_3_stage_9 -->
<g id="edge303" class="edge">
<title>ring_attn_0_3_stage_8&#45;&gt;ring_attn_0_3_stage_9</title>
<path fill="none" stroke="black" d="M1986,-17889.87C1986,-17889.87 1986,-17783.25 1986,-17783.25"/>
<polygon fill="black" stroke="black" points="1989.5,-17783.25 1986,-17773.25 1982.5,-17783.25 1989.5,-17783.25"/>
</g>
<!-- ring_attn_0_4_stage_8 -->
<g id="node404" class="node">
<title>ring_attn_0_4_stage_8</title>
<polygon fill="yellow" stroke="black" points="2573,-18026 2364,-17958 2573,-17890 2782,-17958 2573,-18026"/>
<text text-anchor="middle" x="2573" y="-17976.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-17961.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="2573" y="-17946.8" font-family="Times,serif" font-size="14.00">Q[4]×K[12]×V[12]</text>
<text text-anchor="middle" x="2573" y="-17931.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_3_stage_8&#45;&gt;ring_attn_0_4_stage_8 -->
<g id="edge1753" class="edge">
<title>ring_attn_0_3_stage_8&#45;&gt;ring_attn_0_4_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-17958C2195.02,-17958 2353.86,-17958 2353.86,-17958"/>
<polygon fill="red" stroke="red" points="2353.86,-17961.5 2363.86,-17958 2353.86,-17954.5 2353.86,-17961.5"/>
</g>
<!-- ring_attn_0_3_stage_9&#45;&gt;ring_attn_0_3_stage_10 -->
<g id="edge304" class="edge">
<title>ring_attn_0_3_stage_9&#45;&gt;ring_attn_0_3_stage_10</title>
<path fill="none" stroke="black" d="M1986,-17636.87C1986,-17636.87 1986,-17530.25 1986,-17530.25"/>
<polygon fill="black" stroke="black" points="1989.5,-17530.25 1986,-17520.25 1982.5,-17530.25 1989.5,-17530.25"/>
</g>
<!-- ring_attn_0_4_stage_9 -->
<g id="node405" class="node">
<title>ring_attn_0_4_stage_9</title>
<polygon fill="yellow" stroke="black" points="2573,-17773 2364,-17705 2573,-17637 2782,-17705 2573,-17773"/>
<text text-anchor="middle" x="2573" y="-17723.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-17708.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="2573" y="-17693.8" font-family="Times,serif" font-size="14.00">Q[4]×K[11]×V[11]</text>
<text text-anchor="middle" x="2573" y="-17678.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_3_stage_9&#45;&gt;ring_attn_0_4_stage_9 -->
<g id="edge1754" class="edge">
<title>ring_attn_0_3_stage_9&#45;&gt;ring_attn_0_4_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-17705C2195.02,-17705 2353.86,-17705 2353.86,-17705"/>
<polygon fill="red" stroke="red" points="2353.86,-17708.5 2363.86,-17705 2353.86,-17701.5 2353.86,-17708.5"/>
</g>
<!-- ring_attn_0_3_stage_10&#45;&gt;ring_attn_0_3_stage_11 -->
<g id="edge305" class="edge">
<title>ring_attn_0_3_stage_10&#45;&gt;ring_attn_0_3_stage_11</title>
<path fill="none" stroke="black" d="M1986,-17383.87C1986,-17383.87 1986,-17277.25 1986,-17277.25"/>
<polygon fill="black" stroke="black" points="1989.5,-17277.25 1986,-17267.25 1982.5,-17277.25 1989.5,-17277.25"/>
</g>
<!-- ring_attn_0_4_stage_10 -->
<g id="node406" class="node">
<title>ring_attn_0_4_stage_10</title>
<polygon fill="yellow" stroke="black" points="2573,-17520 2364,-17452 2573,-17384 2782,-17452 2573,-17520"/>
<text text-anchor="middle" x="2573" y="-17470.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-17455.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="2573" y="-17440.8" font-family="Times,serif" font-size="14.00">Q[4]×K[10]×V[10]</text>
<text text-anchor="middle" x="2573" y="-17425.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_3_stage_10&#45;&gt;ring_attn_0_4_stage_10 -->
<g id="edge1755" class="edge">
<title>ring_attn_0_3_stage_10&#45;&gt;ring_attn_0_4_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-17452C2195.02,-17452 2353.86,-17452 2353.86,-17452"/>
<polygon fill="red" stroke="red" points="2353.86,-17455.5 2363.86,-17452 2353.86,-17448.5 2353.86,-17455.5"/>
</g>
<!-- ring_attn_0_3_stage_11&#45;&gt;ring_attn_0_3_stage_12 -->
<g id="edge306" class="edge">
<title>ring_attn_0_3_stage_11&#45;&gt;ring_attn_0_3_stage_12</title>
<path fill="none" stroke="black" d="M1986,-17130.87C1986,-17130.87 1986,-17024.25 1986,-17024.25"/>
<polygon fill="black" stroke="black" points="1989.5,-17024.25 1986,-17014.25 1982.5,-17024.25 1989.5,-17024.25"/>
</g>
<!-- ring_attn_0_4_stage_11 -->
<g id="node407" class="node">
<title>ring_attn_0_4_stage_11</title>
<polygon fill="yellow" stroke="black" points="2573,-17267 2364,-17199 2573,-17131 2782,-17199 2573,-17267"/>
<text text-anchor="middle" x="2573" y="-17217.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-17202.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="2573" y="-17187.8" font-family="Times,serif" font-size="14.00">Q[4]×K[9]×V[9]</text>
<text text-anchor="middle" x="2573" y="-17172.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_3_stage_11&#45;&gt;ring_attn_0_4_stage_11 -->
<g id="edge1756" class="edge">
<title>ring_attn_0_3_stage_11&#45;&gt;ring_attn_0_4_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-17199C2195.02,-17199 2353.86,-17199 2353.86,-17199"/>
<polygon fill="red" stroke="red" points="2353.86,-17202.5 2363.86,-17199 2353.86,-17195.5 2353.86,-17202.5"/>
</g>
<!-- ring_attn_0_3_stage_12&#45;&gt;ring_attn_0_3_stage_13 -->
<g id="edge307" class="edge">
<title>ring_attn_0_3_stage_12&#45;&gt;ring_attn_0_3_stage_13</title>
<path fill="none" stroke="black" d="M1986,-16877.87C1986,-16877.87 1986,-16771.25 1986,-16771.25"/>
<polygon fill="black" stroke="black" points="1989.5,-16771.25 1986,-16761.25 1982.5,-16771.25 1989.5,-16771.25"/>
</g>
<!-- ring_attn_0_4_stage_12 -->
<g id="node408" class="node">
<title>ring_attn_0_4_stage_12</title>
<polygon fill="yellow" stroke="black" points="2573,-17014 2364,-16946 2573,-16878 2782,-16946 2573,-17014"/>
<text text-anchor="middle" x="2573" y="-16964.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-16949.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="2573" y="-16934.8" font-family="Times,serif" font-size="14.00">Q[4]×K[8]×V[8]</text>
<text text-anchor="middle" x="2573" y="-16919.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_3_stage_12&#45;&gt;ring_attn_0_4_stage_12 -->
<g id="edge1757" class="edge">
<title>ring_attn_0_3_stage_12&#45;&gt;ring_attn_0_4_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-16946C2195.02,-16946 2353.86,-16946 2353.86,-16946"/>
<polygon fill="red" stroke="red" points="2353.86,-16949.5 2363.86,-16946 2353.86,-16942.5 2353.86,-16949.5"/>
</g>
<!-- ring_attn_0_3_stage_13&#45;&gt;ring_attn_0_3_stage_14 -->
<g id="edge308" class="edge">
<title>ring_attn_0_3_stage_13&#45;&gt;ring_attn_0_3_stage_14</title>
<path fill="none" stroke="black" d="M1986,-16624.87C1986,-16624.87 1986,-16518.25 1986,-16518.25"/>
<polygon fill="black" stroke="black" points="1989.5,-16518.25 1986,-16508.25 1982.5,-16518.25 1989.5,-16518.25"/>
</g>
<!-- ring_attn_0_4_stage_13 -->
<g id="node409" class="node">
<title>ring_attn_0_4_stage_13</title>
<polygon fill="yellow" stroke="black" points="2573,-16761 2364,-16693 2573,-16625 2782,-16693 2573,-16761"/>
<text text-anchor="middle" x="2573" y="-16711.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-16696.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="2573" y="-16681.8" font-family="Times,serif" font-size="14.00">Q[4]×K[7]×V[7]</text>
<text text-anchor="middle" x="2573" y="-16666.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_3_stage_13&#45;&gt;ring_attn_0_4_stage_13 -->
<g id="edge1758" class="edge">
<title>ring_attn_0_3_stage_13&#45;&gt;ring_attn_0_4_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-16693C2195.02,-16693 2353.86,-16693 2353.86,-16693"/>
<polygon fill="red" stroke="red" points="2353.86,-16696.5 2363.86,-16693 2353.86,-16689.5 2353.86,-16696.5"/>
</g>
<!-- ring_attn_0_3_stage_14&#45;&gt;ring_attn_0_3_stage_15 -->
<g id="edge309" class="edge">
<title>ring_attn_0_3_stage_14&#45;&gt;ring_attn_0_3_stage_15</title>
<path fill="none" stroke="black" d="M1986,-16371.87C1986,-16371.87 1986,-16265.25 1986,-16265.25"/>
<polygon fill="black" stroke="black" points="1989.5,-16265.25 1986,-16255.25 1982.5,-16265.25 1989.5,-16265.25"/>
</g>
<!-- ring_attn_0_4_stage_14 -->
<g id="node410" class="node">
<title>ring_attn_0_4_stage_14</title>
<polygon fill="yellow" stroke="black" points="2573,-16508 2364,-16440 2573,-16372 2782,-16440 2573,-16508"/>
<text text-anchor="middle" x="2573" y="-16458.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-16443.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="2573" y="-16428.8" font-family="Times,serif" font-size="14.00">Q[4]×K[6]×V[6]</text>
<text text-anchor="middle" x="2573" y="-16413.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_3_stage_14&#45;&gt;ring_attn_0_4_stage_14 -->
<g id="edge1759" class="edge">
<title>ring_attn_0_3_stage_14&#45;&gt;ring_attn_0_4_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-16440C2195.02,-16440 2353.86,-16440 2353.86,-16440"/>
<polygon fill="red" stroke="red" points="2353.86,-16443.5 2363.86,-16440 2353.86,-16436.5 2353.86,-16443.5"/>
</g>
<!-- attn_out_0_3 -->
<g id="node314" class="node">
<title>attn_out_0_3</title>
<polygon fill="none" stroke="black" points="2055.5,-16046 1916.5,-16046 1916.5,-15993 2055.5,-15993 2055.5,-16046"/>
<text text-anchor="middle" x="1986" y="-16030.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1986" y="-16015.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="1986" y="-16000.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_0_3_stage_15&#45;&gt;attn_out_0_3 -->
<g id="edge310" class="edge">
<title>ring_attn_0_3_stage_15&#45;&gt;attn_out_0_3</title>
<path fill="none" stroke="black" d="M1986,-16118.87C1986,-16118.87 1986,-16056.18 1986,-16056.18"/>
<polygon fill="black" stroke="black" points="1989.5,-16056.18 1986,-16046.18 1982.5,-16056.18 1989.5,-16056.18"/>
</g>
<!-- ring_attn_0_4_stage_15 -->
<g id="node411" class="node">
<title>ring_attn_0_4_stage_15</title>
<polygon fill="yellow" stroke="black" points="2573,-16255 2364,-16187 2573,-16119 2782,-16187 2573,-16255"/>
<text text-anchor="middle" x="2573" y="-16205.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-16190.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="2573" y="-16175.8" font-family="Times,serif" font-size="14.00">Q[4]×K[5]×V[5]</text>
<text text-anchor="middle" x="2573" y="-16160.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_3_stage_15&#45;&gt;ring_attn_0_4_stage_15 -->
<g id="edge1760" class="edge">
<title>ring_attn_0_3_stage_15&#45;&gt;ring_attn_0_4_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-16187C2195.02,-16187 2353.86,-16187 2353.86,-16187"/>
<polygon fill="red" stroke="red" points="2353.86,-16190.5 2363.86,-16187 2353.86,-16183.5 2353.86,-16190.5"/>
</g>
<!-- attn_residual_0_3 -->
<g id="node315" class="node">
<title>attn_residual_0_3</title>
<ellipse fill="none" stroke="black" cx="1986" cy="-15893" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1986" y="-15896.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1986" y="-15881.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_0_3&#45;&gt;attn_residual_0_3 -->
<g id="edge311" class="edge">
<title>attn_out_0_3&#45;&gt;attn_residual_0_3</title>
<path fill="none" stroke="black" d="M1986,-15992.98C1986,-15992.98 1986,-15930.36 1986,-15930.36"/>
<polygon fill="black" stroke="black" points="1989.5,-15930.36 1986,-15920.36 1982.5,-15930.36 1989.5,-15930.36"/>
</g>
<!-- ffn_up_0_3 -->
<g id="node316" class="node">
<title>ffn_up_0_3</title>
<polygon fill="none" stroke="black" points="2065,-15793 1907,-15793 1907,-15740 2065,-15740 2065,-15793"/>
<text text-anchor="middle" x="1986" y="-15777.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1986" y="-15762.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="1986" y="-15747.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_0_3&#45;&gt;ffn_up_0_3 -->
<g id="edge312" class="edge">
<title>attn_residual_0_3&#45;&gt;ffn_up_0_3</title>
<path fill="none" stroke="black" d="M1986,-15865.86C1986,-15865.86 1986,-15803.16 1986,-15803.16"/>
<polygon fill="black" stroke="black" points="1989.5,-15803.16 1986,-15793.16 1982.5,-15803.16 1989.5,-15803.16"/>
</g>
<!-- ffn_gelu_0_3 -->
<g id="node317" class="node">
<title>ffn_gelu_0_3</title>
<ellipse fill="none" stroke="black" cx="1986" cy="-15640" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1986" y="-15643.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1986" y="-15628.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_0_3&#45;&gt;ffn_gelu_0_3 -->
<g id="edge313" class="edge">
<title>ffn_up_0_3&#45;&gt;ffn_gelu_0_3</title>
<path fill="none" stroke="black" d="M1986,-15739.98C1986,-15739.98 1986,-15677.36 1986,-15677.36"/>
<polygon fill="black" stroke="black" points="1989.5,-15677.36 1986,-15667.36 1982.5,-15677.36 1989.5,-15677.36"/>
</g>
<!-- ffn_down_0_3 -->
<g id="node318" class="node">
<title>ffn_down_0_3</title>
<polygon fill="none" stroke="black" points="2075,-15540 1897,-15540 1897,-15487 2075,-15487 2075,-15540"/>
<text text-anchor="middle" x="1986" y="-15524.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1986" y="-15509.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="1986" y="-15494.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_0_3&#45;&gt;ffn_down_0_3 -->
<g id="edge314" class="edge">
<title>ffn_gelu_0_3&#45;&gt;ffn_down_0_3</title>
<path fill="none" stroke="black" d="M1986,-15612.86C1986,-15612.86 1986,-15550.16 1986,-15550.16"/>
<polygon fill="black" stroke="black" points="1989.5,-15550.16 1986,-15540.16 1982.5,-15550.16 1989.5,-15550.16"/>
</g>
<!-- ffn_residual_0_3 -->
<g id="node319" class="node">
<title>ffn_residual_0_3</title>
<ellipse fill="none" stroke="black" cx="1986" cy="-15387" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1986" y="-15390.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1986" y="-15375.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_0_3&#45;&gt;ffn_residual_0_3 -->
<g id="edge315" class="edge">
<title>ffn_down_0_3&#45;&gt;ffn_residual_0_3</title>
<path fill="none" stroke="black" d="M1986,-15486.98C1986,-15486.98 1986,-15424.36 1986,-15424.36"/>
<polygon fill="black" stroke="black" points="1989.5,-15424.36 1986,-15414.36 1982.5,-15424.36 1989.5,-15424.36"/>
</g>
<!-- qkv_proj_1_3 -->
<g id="node320" class="node">
<title>qkv_proj_1_3</title>
<polygon fill="none" stroke="black" points="2068.5,-15287 1903.5,-15287 1903.5,-15234 2068.5,-15234 2068.5,-15287"/>
<text text-anchor="middle" x="1986" y="-15271.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1986" y="-15256.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="1986" y="-15241.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_0_3&#45;&gt;qkv_proj_1_3 -->
<g id="edge316" class="edge">
<title>ffn_residual_0_3&#45;&gt;qkv_proj_1_3</title>
<path fill="none" stroke="black" d="M1986,-15359.86C1986,-15359.86 1986,-15297.16 1986,-15297.16"/>
<polygon fill="black" stroke="black" points="1989.5,-15297.16 1986,-15287.16 1982.5,-15297.16 1989.5,-15297.16"/>
</g>
<!-- qkv_reshape_1_3 -->
<g id="node321" class="node">
<title>qkv_reshape_1_3</title>
<ellipse fill="none" stroke="black" cx="1986" cy="-15134" rx="148" ry="27"/>
<text text-anchor="middle" x="1986" y="-15137.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1986" y="-15122.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_1_3&#45;&gt;qkv_reshape_1_3 -->
<g id="edge317" class="edge">
<title>qkv_proj_1_3&#45;&gt;qkv_reshape_1_3</title>
<path fill="none" stroke="black" d="M1986,-15233.98C1986,-15233.98 1986,-15171.36 1986,-15171.36"/>
<polygon fill="black" stroke="black" points="1989.5,-15171.36 1986,-15161.36 1982.5,-15171.36 1989.5,-15171.36"/>
</g>
<!-- qkv_reshape_1_3&#45;&gt;ring_attn_1_3_stage_0 -->
<g id="edge318" class="edge">
<title>qkv_reshape_1_3&#45;&gt;ring_attn_1_3_stage_0</title>
<path fill="none" stroke="black" d="M1986,-15106.72C1986,-15106.72 1986,-15000.16 1986,-15000.16"/>
<polygon fill="black" stroke="black" points="1989.5,-15000.16 1986,-14990.16 1982.5,-15000.16 1989.5,-15000.16"/>
</g>
<!-- ring_attn_1_3_stage_0&#45;&gt;ring_attn_1_3_stage_1 -->
<g id="edge319" class="edge">
<title>ring_attn_1_3_stage_0&#45;&gt;ring_attn_1_3_stage_1</title>
<path fill="none" stroke="black" d="M1986,-14853.87C1986,-14853.87 1986,-14747.25 1986,-14747.25"/>
<polygon fill="black" stroke="black" points="1989.5,-14747.25 1986,-14737.25 1982.5,-14747.25 1989.5,-14747.25"/>
</g>
<!-- ring_attn_1_4_stage_0 -->
<g id="node420" class="node">
<title>ring_attn_1_4_stage_0</title>
<polygon fill="yellow" stroke="black" points="2573,-14990 2364,-14922 2573,-14854 2782,-14922 2573,-14990"/>
<text text-anchor="middle" x="2573" y="-14940.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-14925.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="2573" y="-14910.8" font-family="Times,serif" font-size="14.00">Q[4]×K[4]×V[4]</text>
<text text-anchor="middle" x="2573" y="-14895.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_3_stage_0&#45;&gt;ring_attn_1_4_stage_0 -->
<g id="edge1761" class="edge">
<title>ring_attn_1_3_stage_0&#45;&gt;ring_attn_1_4_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-14922C2195.02,-14922 2353.86,-14922 2353.86,-14922"/>
<polygon fill="red" stroke="red" points="2353.86,-14925.5 2363.86,-14922 2353.86,-14918.5 2353.86,-14925.5"/>
</g>
<!-- ring_attn_1_3_stage_1&#45;&gt;ring_attn_1_3_stage_2 -->
<g id="edge320" class="edge">
<title>ring_attn_1_3_stage_1&#45;&gt;ring_attn_1_3_stage_2</title>
<path fill="none" stroke="black" d="M1986,-14600.87C1986,-14600.87 1986,-14494.25 1986,-14494.25"/>
<polygon fill="black" stroke="black" points="1989.5,-14494.25 1986,-14484.25 1982.5,-14494.25 1989.5,-14494.25"/>
</g>
<!-- ring_attn_1_4_stage_1 -->
<g id="node421" class="node">
<title>ring_attn_1_4_stage_1</title>
<polygon fill="yellow" stroke="black" points="2573,-14737 2364,-14669 2573,-14601 2782,-14669 2573,-14737"/>
<text text-anchor="middle" x="2573" y="-14687.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-14672.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="2573" y="-14657.8" font-family="Times,serif" font-size="14.00">Q[4]×K[3]×V[3]</text>
<text text-anchor="middle" x="2573" y="-14642.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_3_stage_1&#45;&gt;ring_attn_1_4_stage_1 -->
<g id="edge1762" class="edge">
<title>ring_attn_1_3_stage_1&#45;&gt;ring_attn_1_4_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-14669C2195.02,-14669 2353.86,-14669 2353.86,-14669"/>
<polygon fill="red" stroke="red" points="2353.86,-14672.5 2363.86,-14669 2353.86,-14665.5 2353.86,-14672.5"/>
</g>
<!-- ring_attn_1_3_stage_2&#45;&gt;ring_attn_1_3_stage_3 -->
<g id="edge321" class="edge">
<title>ring_attn_1_3_stage_2&#45;&gt;ring_attn_1_3_stage_3</title>
<path fill="none" stroke="black" d="M1986,-14347.87C1986,-14347.87 1986,-14241.25 1986,-14241.25"/>
<polygon fill="black" stroke="black" points="1989.5,-14241.25 1986,-14231.25 1982.5,-14241.25 1989.5,-14241.25"/>
</g>
<!-- ring_attn_1_4_stage_2 -->
<g id="node422" class="node">
<title>ring_attn_1_4_stage_2</title>
<polygon fill="yellow" stroke="black" points="2573,-14484 2364,-14416 2573,-14348 2782,-14416 2573,-14484"/>
<text text-anchor="middle" x="2573" y="-14434.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-14419.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="2573" y="-14404.8" font-family="Times,serif" font-size="14.00">Q[4]×K[2]×V[2]</text>
<text text-anchor="middle" x="2573" y="-14389.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_3_stage_2&#45;&gt;ring_attn_1_4_stage_2 -->
<g id="edge1763" class="edge">
<title>ring_attn_1_3_stage_2&#45;&gt;ring_attn_1_4_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-14416C2195.02,-14416 2353.86,-14416 2353.86,-14416"/>
<polygon fill="red" stroke="red" points="2353.86,-14419.5 2363.86,-14416 2353.86,-14412.5 2353.86,-14419.5"/>
</g>
<!-- ring_attn_1_3_stage_3&#45;&gt;ring_attn_1_3_stage_4 -->
<g id="edge322" class="edge">
<title>ring_attn_1_3_stage_3&#45;&gt;ring_attn_1_3_stage_4</title>
<path fill="none" stroke="black" d="M1986,-14094.87C1986,-14094.87 1986,-13988.25 1986,-13988.25"/>
<polygon fill="black" stroke="black" points="1989.5,-13988.25 1986,-13978.25 1982.5,-13988.25 1989.5,-13988.25"/>
</g>
<!-- ring_attn_1_4_stage_3 -->
<g id="node423" class="node">
<title>ring_attn_1_4_stage_3</title>
<polygon fill="yellow" stroke="black" points="2573,-14231 2364,-14163 2573,-14095 2782,-14163 2573,-14231"/>
<text text-anchor="middle" x="2573" y="-14181.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-14166.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="2573" y="-14151.8" font-family="Times,serif" font-size="14.00">Q[4]×K[1]×V[1]</text>
<text text-anchor="middle" x="2573" y="-14136.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_3_stage_3&#45;&gt;ring_attn_1_4_stage_3 -->
<g id="edge1764" class="edge">
<title>ring_attn_1_3_stage_3&#45;&gt;ring_attn_1_4_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-14163C2195.02,-14163 2353.86,-14163 2353.86,-14163"/>
<polygon fill="red" stroke="red" points="2353.86,-14166.5 2363.86,-14163 2353.86,-14159.5 2353.86,-14166.5"/>
</g>
<!-- ring_attn_1_3_stage_4&#45;&gt;ring_attn_1_3_stage_5 -->
<g id="edge323" class="edge">
<title>ring_attn_1_3_stage_4&#45;&gt;ring_attn_1_3_stage_5</title>
<path fill="none" stroke="black" d="M1986,-13841.87C1986,-13841.87 1986,-13735.25 1986,-13735.25"/>
<polygon fill="black" stroke="black" points="1989.5,-13735.25 1986,-13725.25 1982.5,-13735.25 1989.5,-13735.25"/>
</g>
<!-- ring_attn_1_4_stage_4 -->
<g id="node424" class="node">
<title>ring_attn_1_4_stage_4</title>
<polygon fill="yellow" stroke="black" points="2573,-13978 2364,-13910 2573,-13842 2782,-13910 2573,-13978"/>
<text text-anchor="middle" x="2573" y="-13928.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-13913.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="2573" y="-13898.8" font-family="Times,serif" font-size="14.00">Q[4]×K[0]×V[0]</text>
<text text-anchor="middle" x="2573" y="-13883.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_3_stage_4&#45;&gt;ring_attn_1_4_stage_4 -->
<g id="edge1765" class="edge">
<title>ring_attn_1_3_stage_4&#45;&gt;ring_attn_1_4_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-13910C2195.02,-13910 2353.86,-13910 2353.86,-13910"/>
<polygon fill="red" stroke="red" points="2353.86,-13913.5 2363.86,-13910 2353.86,-13906.5 2353.86,-13913.5"/>
</g>
<!-- ring_attn_1_3_stage_5&#45;&gt;ring_attn_1_3_stage_6 -->
<g id="edge324" class="edge">
<title>ring_attn_1_3_stage_5&#45;&gt;ring_attn_1_3_stage_6</title>
<path fill="none" stroke="black" d="M1986,-13588.87C1986,-13588.87 1986,-13482.25 1986,-13482.25"/>
<polygon fill="black" stroke="black" points="1989.5,-13482.25 1986,-13472.25 1982.5,-13482.25 1989.5,-13482.25"/>
</g>
<!-- ring_attn_1_4_stage_5 -->
<g id="node425" class="node">
<title>ring_attn_1_4_stage_5</title>
<polygon fill="yellow" stroke="black" points="2573,-13725 2364,-13657 2573,-13589 2782,-13657 2573,-13725"/>
<text text-anchor="middle" x="2573" y="-13675.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-13660.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="2573" y="-13645.8" font-family="Times,serif" font-size="14.00">Q[4]×K[15]×V[15]</text>
<text text-anchor="middle" x="2573" y="-13630.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_3_stage_5&#45;&gt;ring_attn_1_4_stage_5 -->
<g id="edge1766" class="edge">
<title>ring_attn_1_3_stage_5&#45;&gt;ring_attn_1_4_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-13657C2195.02,-13657 2353.86,-13657 2353.86,-13657"/>
<polygon fill="red" stroke="red" points="2353.86,-13660.5 2363.86,-13657 2353.86,-13653.5 2353.86,-13660.5"/>
</g>
<!-- ring_attn_1_3_stage_6&#45;&gt;ring_attn_1_3_stage_7 -->
<g id="edge325" class="edge">
<title>ring_attn_1_3_stage_6&#45;&gt;ring_attn_1_3_stage_7</title>
<path fill="none" stroke="black" d="M1986,-13335.87C1986,-13335.87 1986,-13229.25 1986,-13229.25"/>
<polygon fill="black" stroke="black" points="1989.5,-13229.25 1986,-13219.25 1982.5,-13229.25 1989.5,-13229.25"/>
</g>
<!-- ring_attn_1_4_stage_6 -->
<g id="node426" class="node">
<title>ring_attn_1_4_stage_6</title>
<polygon fill="yellow" stroke="black" points="2573,-13472 2364,-13404 2573,-13336 2782,-13404 2573,-13472"/>
<text text-anchor="middle" x="2573" y="-13422.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-13407.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="2573" y="-13392.8" font-family="Times,serif" font-size="14.00">Q[4]×K[14]×V[14]</text>
<text text-anchor="middle" x="2573" y="-13377.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_3_stage_6&#45;&gt;ring_attn_1_4_stage_6 -->
<g id="edge1767" class="edge">
<title>ring_attn_1_3_stage_6&#45;&gt;ring_attn_1_4_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-13404C2195.02,-13404 2353.86,-13404 2353.86,-13404"/>
<polygon fill="red" stroke="red" points="2353.86,-13407.5 2363.86,-13404 2353.86,-13400.5 2353.86,-13407.5"/>
</g>
<!-- ring_attn_1_3_stage_7&#45;&gt;ring_attn_1_3_stage_8 -->
<g id="edge326" class="edge">
<title>ring_attn_1_3_stage_7&#45;&gt;ring_attn_1_3_stage_8</title>
<path fill="none" stroke="black" d="M1986,-13082.87C1986,-13082.87 1986,-12976.25 1986,-12976.25"/>
<polygon fill="black" stroke="black" points="1989.5,-12976.25 1986,-12966.25 1982.5,-12976.25 1989.5,-12976.25"/>
</g>
<!-- ring_attn_1_4_stage_7 -->
<g id="node427" class="node">
<title>ring_attn_1_4_stage_7</title>
<polygon fill="yellow" stroke="black" points="2573,-13219 2364,-13151 2573,-13083 2782,-13151 2573,-13219"/>
<text text-anchor="middle" x="2573" y="-13169.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-13154.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="2573" y="-13139.8" font-family="Times,serif" font-size="14.00">Q[4]×K[13]×V[13]</text>
<text text-anchor="middle" x="2573" y="-13124.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_3_stage_7&#45;&gt;ring_attn_1_4_stage_7 -->
<g id="edge1768" class="edge">
<title>ring_attn_1_3_stage_7&#45;&gt;ring_attn_1_4_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-13151C2195.02,-13151 2353.86,-13151 2353.86,-13151"/>
<polygon fill="red" stroke="red" points="2353.86,-13154.5 2363.86,-13151 2353.86,-13147.5 2353.86,-13154.5"/>
</g>
<!-- ring_attn_1_3_stage_8&#45;&gt;ring_attn_1_3_stage_9 -->
<g id="edge327" class="edge">
<title>ring_attn_1_3_stage_8&#45;&gt;ring_attn_1_3_stage_9</title>
<path fill="none" stroke="black" d="M1986,-12829.87C1986,-12829.87 1986,-12723.25 1986,-12723.25"/>
<polygon fill="black" stroke="black" points="1989.5,-12723.25 1986,-12713.25 1982.5,-12723.25 1989.5,-12723.25"/>
</g>
<!-- ring_attn_1_4_stage_8 -->
<g id="node428" class="node">
<title>ring_attn_1_4_stage_8</title>
<polygon fill="yellow" stroke="black" points="2573,-12966 2364,-12898 2573,-12830 2782,-12898 2573,-12966"/>
<text text-anchor="middle" x="2573" y="-12916.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-12901.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="2573" y="-12886.8" font-family="Times,serif" font-size="14.00">Q[4]×K[12]×V[12]</text>
<text text-anchor="middle" x="2573" y="-12871.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_3_stage_8&#45;&gt;ring_attn_1_4_stage_8 -->
<g id="edge1769" class="edge">
<title>ring_attn_1_3_stage_8&#45;&gt;ring_attn_1_4_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-12898C2195.02,-12898 2353.86,-12898 2353.86,-12898"/>
<polygon fill="red" stroke="red" points="2353.86,-12901.5 2363.86,-12898 2353.86,-12894.5 2353.86,-12901.5"/>
</g>
<!-- ring_attn_1_3_stage_9&#45;&gt;ring_attn_1_3_stage_10 -->
<g id="edge328" class="edge">
<title>ring_attn_1_3_stage_9&#45;&gt;ring_attn_1_3_stage_10</title>
<path fill="none" stroke="black" d="M1986,-12576.87C1986,-12576.87 1986,-12470.25 1986,-12470.25"/>
<polygon fill="black" stroke="black" points="1989.5,-12470.25 1986,-12460.25 1982.5,-12470.25 1989.5,-12470.25"/>
</g>
<!-- ring_attn_1_4_stage_9 -->
<g id="node429" class="node">
<title>ring_attn_1_4_stage_9</title>
<polygon fill="yellow" stroke="black" points="2573,-12713 2364,-12645 2573,-12577 2782,-12645 2573,-12713"/>
<text text-anchor="middle" x="2573" y="-12663.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-12648.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="2573" y="-12633.8" font-family="Times,serif" font-size="14.00">Q[4]×K[11]×V[11]</text>
<text text-anchor="middle" x="2573" y="-12618.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_3_stage_9&#45;&gt;ring_attn_1_4_stage_9 -->
<g id="edge1770" class="edge">
<title>ring_attn_1_3_stage_9&#45;&gt;ring_attn_1_4_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-12645C2195.02,-12645 2353.86,-12645 2353.86,-12645"/>
<polygon fill="red" stroke="red" points="2353.86,-12648.5 2363.86,-12645 2353.86,-12641.5 2353.86,-12648.5"/>
</g>
<!-- ring_attn_1_3_stage_10&#45;&gt;ring_attn_1_3_stage_11 -->
<g id="edge329" class="edge">
<title>ring_attn_1_3_stage_10&#45;&gt;ring_attn_1_3_stage_11</title>
<path fill="none" stroke="black" d="M1986,-12323.87C1986,-12323.87 1986,-12217.25 1986,-12217.25"/>
<polygon fill="black" stroke="black" points="1989.5,-12217.25 1986,-12207.25 1982.5,-12217.25 1989.5,-12217.25"/>
</g>
<!-- ring_attn_1_4_stage_10 -->
<g id="node430" class="node">
<title>ring_attn_1_4_stage_10</title>
<polygon fill="yellow" stroke="black" points="2573,-12460 2364,-12392 2573,-12324 2782,-12392 2573,-12460"/>
<text text-anchor="middle" x="2573" y="-12410.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-12395.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="2573" y="-12380.8" font-family="Times,serif" font-size="14.00">Q[4]×K[10]×V[10]</text>
<text text-anchor="middle" x="2573" y="-12365.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_3_stage_10&#45;&gt;ring_attn_1_4_stage_10 -->
<g id="edge1771" class="edge">
<title>ring_attn_1_3_stage_10&#45;&gt;ring_attn_1_4_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-12392C2195.02,-12392 2353.86,-12392 2353.86,-12392"/>
<polygon fill="red" stroke="red" points="2353.86,-12395.5 2363.86,-12392 2353.86,-12388.5 2353.86,-12395.5"/>
</g>
<!-- ring_attn_1_3_stage_11&#45;&gt;ring_attn_1_3_stage_12 -->
<g id="edge330" class="edge">
<title>ring_attn_1_3_stage_11&#45;&gt;ring_attn_1_3_stage_12</title>
<path fill="none" stroke="black" d="M1986,-12070.87C1986,-12070.87 1986,-11964.25 1986,-11964.25"/>
<polygon fill="black" stroke="black" points="1989.5,-11964.25 1986,-11954.25 1982.5,-11964.25 1989.5,-11964.25"/>
</g>
<!-- ring_attn_1_4_stage_11 -->
<g id="node431" class="node">
<title>ring_attn_1_4_stage_11</title>
<polygon fill="yellow" stroke="black" points="2573,-12207 2364,-12139 2573,-12071 2782,-12139 2573,-12207"/>
<text text-anchor="middle" x="2573" y="-12157.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-12142.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="2573" y="-12127.8" font-family="Times,serif" font-size="14.00">Q[4]×K[9]×V[9]</text>
<text text-anchor="middle" x="2573" y="-12112.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_3_stage_11&#45;&gt;ring_attn_1_4_stage_11 -->
<g id="edge1772" class="edge">
<title>ring_attn_1_3_stage_11&#45;&gt;ring_attn_1_4_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-12139C2195.02,-12139 2353.86,-12139 2353.86,-12139"/>
<polygon fill="red" stroke="red" points="2353.86,-12142.5 2363.86,-12139 2353.86,-12135.5 2353.86,-12142.5"/>
</g>
<!-- ring_attn_1_3_stage_12&#45;&gt;ring_attn_1_3_stage_13 -->
<g id="edge331" class="edge">
<title>ring_attn_1_3_stage_12&#45;&gt;ring_attn_1_3_stage_13</title>
<path fill="none" stroke="black" d="M1986,-11817.87C1986,-11817.87 1986,-11711.25 1986,-11711.25"/>
<polygon fill="black" stroke="black" points="1989.5,-11711.25 1986,-11701.25 1982.5,-11711.25 1989.5,-11711.25"/>
</g>
<!-- ring_attn_1_4_stage_12 -->
<g id="node432" class="node">
<title>ring_attn_1_4_stage_12</title>
<polygon fill="yellow" stroke="black" points="2573,-11954 2364,-11886 2573,-11818 2782,-11886 2573,-11954"/>
<text text-anchor="middle" x="2573" y="-11904.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-11889.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="2573" y="-11874.8" font-family="Times,serif" font-size="14.00">Q[4]×K[8]×V[8]</text>
<text text-anchor="middle" x="2573" y="-11859.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_3_stage_12&#45;&gt;ring_attn_1_4_stage_12 -->
<g id="edge1773" class="edge">
<title>ring_attn_1_3_stage_12&#45;&gt;ring_attn_1_4_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-11886C2195.02,-11886 2353.86,-11886 2353.86,-11886"/>
<polygon fill="red" stroke="red" points="2353.86,-11889.5 2363.86,-11886 2353.86,-11882.5 2353.86,-11889.5"/>
</g>
<!-- ring_attn_1_3_stage_13&#45;&gt;ring_attn_1_3_stage_14 -->
<g id="edge332" class="edge">
<title>ring_attn_1_3_stage_13&#45;&gt;ring_attn_1_3_stage_14</title>
<path fill="none" stroke="black" d="M1986,-11564.87C1986,-11564.87 1986,-11458.25 1986,-11458.25"/>
<polygon fill="black" stroke="black" points="1989.5,-11458.25 1986,-11448.25 1982.5,-11458.25 1989.5,-11458.25"/>
</g>
<!-- ring_attn_1_4_stage_13 -->
<g id="node433" class="node">
<title>ring_attn_1_4_stage_13</title>
<polygon fill="yellow" stroke="black" points="2573,-11701 2364,-11633 2573,-11565 2782,-11633 2573,-11701"/>
<text text-anchor="middle" x="2573" y="-11651.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-11636.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="2573" y="-11621.8" font-family="Times,serif" font-size="14.00">Q[4]×K[7]×V[7]</text>
<text text-anchor="middle" x="2573" y="-11606.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_3_stage_13&#45;&gt;ring_attn_1_4_stage_13 -->
<g id="edge1774" class="edge">
<title>ring_attn_1_3_stage_13&#45;&gt;ring_attn_1_4_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-11633C2195.02,-11633 2353.86,-11633 2353.86,-11633"/>
<polygon fill="red" stroke="red" points="2353.86,-11636.5 2363.86,-11633 2353.86,-11629.5 2353.86,-11636.5"/>
</g>
<!-- ring_attn_1_3_stage_14&#45;&gt;ring_attn_1_3_stage_15 -->
<g id="edge333" class="edge">
<title>ring_attn_1_3_stage_14&#45;&gt;ring_attn_1_3_stage_15</title>
<path fill="none" stroke="black" d="M1986,-11311.87C1986,-11311.87 1986,-11205.25 1986,-11205.25"/>
<polygon fill="black" stroke="black" points="1989.5,-11205.25 1986,-11195.25 1982.5,-11205.25 1989.5,-11205.25"/>
</g>
<!-- ring_attn_1_4_stage_14 -->
<g id="node434" class="node">
<title>ring_attn_1_4_stage_14</title>
<polygon fill="yellow" stroke="black" points="2573,-11448 2364,-11380 2573,-11312 2782,-11380 2573,-11448"/>
<text text-anchor="middle" x="2573" y="-11398.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-11383.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="2573" y="-11368.8" font-family="Times,serif" font-size="14.00">Q[4]×K[6]×V[6]</text>
<text text-anchor="middle" x="2573" y="-11353.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_3_stage_14&#45;&gt;ring_attn_1_4_stage_14 -->
<g id="edge1775" class="edge">
<title>ring_attn_1_3_stage_14&#45;&gt;ring_attn_1_4_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-11380C2195.02,-11380 2353.86,-11380 2353.86,-11380"/>
<polygon fill="red" stroke="red" points="2353.86,-11383.5 2363.86,-11380 2353.86,-11376.5 2353.86,-11383.5"/>
</g>
<!-- attn_out_1_3 -->
<g id="node338" class="node">
<title>attn_out_1_3</title>
<polygon fill="none" stroke="black" points="2055.5,-10986 1916.5,-10986 1916.5,-10933 2055.5,-10933 2055.5,-10986"/>
<text text-anchor="middle" x="1986" y="-10970.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1986" y="-10955.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="1986" y="-10940.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_1_3_stage_15&#45;&gt;attn_out_1_3 -->
<g id="edge334" class="edge">
<title>ring_attn_1_3_stage_15&#45;&gt;attn_out_1_3</title>
<path fill="none" stroke="black" d="M1986,-11058.87C1986,-11058.87 1986,-10996.18 1986,-10996.18"/>
<polygon fill="black" stroke="black" points="1989.5,-10996.18 1986,-10986.18 1982.5,-10996.18 1989.5,-10996.18"/>
</g>
<!-- ring_attn_1_4_stage_15 -->
<g id="node435" class="node">
<title>ring_attn_1_4_stage_15</title>
<polygon fill="yellow" stroke="black" points="2573,-11195 2364,-11127 2573,-11059 2782,-11127 2573,-11195"/>
<text text-anchor="middle" x="2573" y="-11145.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-11130.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="2573" y="-11115.8" font-family="Times,serif" font-size="14.00">Q[4]×K[5]×V[5]</text>
<text text-anchor="middle" x="2573" y="-11100.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_3_stage_15&#45;&gt;ring_attn_1_4_stage_15 -->
<g id="edge1776" class="edge">
<title>ring_attn_1_3_stage_15&#45;&gt;ring_attn_1_4_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-11127C2195.02,-11127 2353.86,-11127 2353.86,-11127"/>
<polygon fill="red" stroke="red" points="2353.86,-11130.5 2363.86,-11127 2353.86,-11123.5 2353.86,-11130.5"/>
</g>
<!-- attn_residual_1_3 -->
<g id="node339" class="node">
<title>attn_residual_1_3</title>
<ellipse fill="none" stroke="black" cx="1986" cy="-10833" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1986" y="-10836.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1986" y="-10821.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_1_3&#45;&gt;attn_residual_1_3 -->
<g id="edge335" class="edge">
<title>attn_out_1_3&#45;&gt;attn_residual_1_3</title>
<path fill="none" stroke="black" d="M1986,-10932.98C1986,-10932.98 1986,-10870.36 1986,-10870.36"/>
<polygon fill="black" stroke="black" points="1989.5,-10870.36 1986,-10860.36 1982.5,-10870.36 1989.5,-10870.36"/>
</g>
<!-- ffn_up_1_3 -->
<g id="node340" class="node">
<title>ffn_up_1_3</title>
<polygon fill="none" stroke="black" points="2065,-10733 1907,-10733 1907,-10680 2065,-10680 2065,-10733"/>
<text text-anchor="middle" x="1986" y="-10717.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1986" y="-10702.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="1986" y="-10687.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_1_3&#45;&gt;ffn_up_1_3 -->
<g id="edge336" class="edge">
<title>attn_residual_1_3&#45;&gt;ffn_up_1_3</title>
<path fill="none" stroke="black" d="M1986,-10805.86C1986,-10805.86 1986,-10743.16 1986,-10743.16"/>
<polygon fill="black" stroke="black" points="1989.5,-10743.16 1986,-10733.16 1982.5,-10743.16 1989.5,-10743.16"/>
</g>
<!-- ffn_gelu_1_3 -->
<g id="node341" class="node">
<title>ffn_gelu_1_3</title>
<ellipse fill="none" stroke="black" cx="1986" cy="-10580" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1986" y="-10583.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1986" y="-10568.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_1_3&#45;&gt;ffn_gelu_1_3 -->
<g id="edge337" class="edge">
<title>ffn_up_1_3&#45;&gt;ffn_gelu_1_3</title>
<path fill="none" stroke="black" d="M1986,-10679.98C1986,-10679.98 1986,-10617.36 1986,-10617.36"/>
<polygon fill="black" stroke="black" points="1989.5,-10617.36 1986,-10607.36 1982.5,-10617.36 1989.5,-10617.36"/>
</g>
<!-- ffn_down_1_3 -->
<g id="node342" class="node">
<title>ffn_down_1_3</title>
<polygon fill="none" stroke="black" points="2075,-10480 1897,-10480 1897,-10427 2075,-10427 2075,-10480"/>
<text text-anchor="middle" x="1986" y="-10464.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1986" y="-10449.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="1986" y="-10434.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_1_3&#45;&gt;ffn_down_1_3 -->
<g id="edge338" class="edge">
<title>ffn_gelu_1_3&#45;&gt;ffn_down_1_3</title>
<path fill="none" stroke="black" d="M1986,-10552.86C1986,-10552.86 1986,-10490.16 1986,-10490.16"/>
<polygon fill="black" stroke="black" points="1989.5,-10490.16 1986,-10480.16 1982.5,-10490.16 1989.5,-10490.16"/>
</g>
<!-- ffn_residual_1_3 -->
<g id="node343" class="node">
<title>ffn_residual_1_3</title>
<ellipse fill="none" stroke="black" cx="1986" cy="-10327" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1986" y="-10330.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1986" y="-10315.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_1_3&#45;&gt;ffn_residual_1_3 -->
<g id="edge339" class="edge">
<title>ffn_down_1_3&#45;&gt;ffn_residual_1_3</title>
<path fill="none" stroke="black" d="M1986,-10426.98C1986,-10426.98 1986,-10364.36 1986,-10364.36"/>
<polygon fill="black" stroke="black" points="1989.5,-10364.36 1986,-10354.36 1982.5,-10364.36 1989.5,-10364.36"/>
</g>
<!-- qkv_proj_2_3 -->
<g id="node344" class="node">
<title>qkv_proj_2_3</title>
<polygon fill="none" stroke="black" points="2068.5,-10227 1903.5,-10227 1903.5,-10174 2068.5,-10174 2068.5,-10227"/>
<text text-anchor="middle" x="1986" y="-10211.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1986" y="-10196.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="1986" y="-10181.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_1_3&#45;&gt;qkv_proj_2_3 -->
<g id="edge340" class="edge">
<title>ffn_residual_1_3&#45;&gt;qkv_proj_2_3</title>
<path fill="none" stroke="black" d="M1986,-10299.86C1986,-10299.86 1986,-10237.16 1986,-10237.16"/>
<polygon fill="black" stroke="black" points="1989.5,-10237.16 1986,-10227.16 1982.5,-10237.16 1989.5,-10237.16"/>
</g>
<!-- qkv_reshape_2_3 -->
<g id="node345" class="node">
<title>qkv_reshape_2_3</title>
<ellipse fill="none" stroke="black" cx="1986" cy="-10074" rx="148" ry="27"/>
<text text-anchor="middle" x="1986" y="-10077.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1986" y="-10062.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_2_3&#45;&gt;qkv_reshape_2_3 -->
<g id="edge341" class="edge">
<title>qkv_proj_2_3&#45;&gt;qkv_reshape_2_3</title>
<path fill="none" stroke="black" d="M1986,-10173.98C1986,-10173.98 1986,-10111.36 1986,-10111.36"/>
<polygon fill="black" stroke="black" points="1989.5,-10111.36 1986,-10101.36 1982.5,-10111.36 1989.5,-10111.36"/>
</g>
<!-- qkv_reshape_2_3&#45;&gt;ring_attn_2_3_stage_0 -->
<g id="edge342" class="edge">
<title>qkv_reshape_2_3&#45;&gt;ring_attn_2_3_stage_0</title>
<path fill="none" stroke="black" d="M1986,-10046.72C1986,-10046.72 1986,-9940.16 1986,-9940.16"/>
<polygon fill="black" stroke="black" points="1989.5,-9940.16 1986,-9930.16 1982.5,-9940.16 1989.5,-9940.16"/>
</g>
<!-- ring_attn_2_3_stage_0&#45;&gt;ring_attn_2_3_stage_1 -->
<g id="edge343" class="edge">
<title>ring_attn_2_3_stage_0&#45;&gt;ring_attn_2_3_stage_1</title>
<path fill="none" stroke="black" d="M1986,-9793.87C1986,-9793.87 1986,-9687.25 1986,-9687.25"/>
<polygon fill="black" stroke="black" points="1989.5,-9687.25 1986,-9677.25 1982.5,-9687.25 1989.5,-9687.25"/>
</g>
<!-- ring_attn_2_4_stage_0 -->
<g id="node444" class="node">
<title>ring_attn_2_4_stage_0</title>
<polygon fill="yellow" stroke="black" points="2573,-9930 2364,-9862 2573,-9794 2782,-9862 2573,-9930"/>
<text text-anchor="middle" x="2573" y="-9880.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-9865.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="2573" y="-9850.8" font-family="Times,serif" font-size="14.00">Q[4]×K[4]×V[4]</text>
<text text-anchor="middle" x="2573" y="-9835.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_3_stage_0&#45;&gt;ring_attn_2_4_stage_0 -->
<g id="edge1777" class="edge">
<title>ring_attn_2_3_stage_0&#45;&gt;ring_attn_2_4_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-9862C2195.02,-9862 2353.86,-9862 2353.86,-9862"/>
<polygon fill="red" stroke="red" points="2353.86,-9865.5 2363.86,-9862 2353.86,-9858.5 2353.86,-9865.5"/>
</g>
<!-- ring_attn_2_3_stage_1&#45;&gt;ring_attn_2_3_stage_2 -->
<g id="edge344" class="edge">
<title>ring_attn_2_3_stage_1&#45;&gt;ring_attn_2_3_stage_2</title>
<path fill="none" stroke="black" d="M1986,-9540.87C1986,-9540.87 1986,-9434.25 1986,-9434.25"/>
<polygon fill="black" stroke="black" points="1989.5,-9434.25 1986,-9424.25 1982.5,-9434.25 1989.5,-9434.25"/>
</g>
<!-- ring_attn_2_4_stage_1 -->
<g id="node445" class="node">
<title>ring_attn_2_4_stage_1</title>
<polygon fill="yellow" stroke="black" points="2573,-9677 2364,-9609 2573,-9541 2782,-9609 2573,-9677"/>
<text text-anchor="middle" x="2573" y="-9627.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-9612.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="2573" y="-9597.8" font-family="Times,serif" font-size="14.00">Q[4]×K[3]×V[3]</text>
<text text-anchor="middle" x="2573" y="-9582.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_3_stage_1&#45;&gt;ring_attn_2_4_stage_1 -->
<g id="edge1778" class="edge">
<title>ring_attn_2_3_stage_1&#45;&gt;ring_attn_2_4_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-9609C2195.02,-9609 2353.86,-9609 2353.86,-9609"/>
<polygon fill="red" stroke="red" points="2353.86,-9612.5 2363.86,-9609 2353.86,-9605.5 2353.86,-9612.5"/>
</g>
<!-- ring_attn_2_3_stage_2&#45;&gt;ring_attn_2_3_stage_3 -->
<g id="edge345" class="edge">
<title>ring_attn_2_3_stage_2&#45;&gt;ring_attn_2_3_stage_3</title>
<path fill="none" stroke="black" d="M1986,-9287.87C1986,-9287.87 1986,-9181.25 1986,-9181.25"/>
<polygon fill="black" stroke="black" points="1989.5,-9181.25 1986,-9171.25 1982.5,-9181.25 1989.5,-9181.25"/>
</g>
<!-- ring_attn_2_4_stage_2 -->
<g id="node446" class="node">
<title>ring_attn_2_4_stage_2</title>
<polygon fill="yellow" stroke="black" points="2573,-9424 2364,-9356 2573,-9288 2782,-9356 2573,-9424"/>
<text text-anchor="middle" x="2573" y="-9374.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-9359.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="2573" y="-9344.8" font-family="Times,serif" font-size="14.00">Q[4]×K[2]×V[2]</text>
<text text-anchor="middle" x="2573" y="-9329.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_3_stage_2&#45;&gt;ring_attn_2_4_stage_2 -->
<g id="edge1779" class="edge">
<title>ring_attn_2_3_stage_2&#45;&gt;ring_attn_2_4_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-9356C2195.02,-9356 2353.86,-9356 2353.86,-9356"/>
<polygon fill="red" stroke="red" points="2353.86,-9359.5 2363.86,-9356 2353.86,-9352.5 2353.86,-9359.5"/>
</g>
<!-- ring_attn_2_3_stage_3&#45;&gt;ring_attn_2_3_stage_4 -->
<g id="edge346" class="edge">
<title>ring_attn_2_3_stage_3&#45;&gt;ring_attn_2_3_stage_4</title>
<path fill="none" stroke="black" d="M1986,-9034.87C1986,-9034.87 1986,-8928.25 1986,-8928.25"/>
<polygon fill="black" stroke="black" points="1989.5,-8928.25 1986,-8918.25 1982.5,-8928.25 1989.5,-8928.25"/>
</g>
<!-- ring_attn_2_4_stage_3 -->
<g id="node447" class="node">
<title>ring_attn_2_4_stage_3</title>
<polygon fill="yellow" stroke="black" points="2573,-9171 2364,-9103 2573,-9035 2782,-9103 2573,-9171"/>
<text text-anchor="middle" x="2573" y="-9121.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-9106.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="2573" y="-9091.8" font-family="Times,serif" font-size="14.00">Q[4]×K[1]×V[1]</text>
<text text-anchor="middle" x="2573" y="-9076.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_3_stage_3&#45;&gt;ring_attn_2_4_stage_3 -->
<g id="edge1780" class="edge">
<title>ring_attn_2_3_stage_3&#45;&gt;ring_attn_2_4_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-9103C2195.02,-9103 2353.86,-9103 2353.86,-9103"/>
<polygon fill="red" stroke="red" points="2353.86,-9106.5 2363.86,-9103 2353.86,-9099.5 2353.86,-9106.5"/>
</g>
<!-- ring_attn_2_3_stage_4&#45;&gt;ring_attn_2_3_stage_5 -->
<g id="edge347" class="edge">
<title>ring_attn_2_3_stage_4&#45;&gt;ring_attn_2_3_stage_5</title>
<path fill="none" stroke="black" d="M1986,-8781.87C1986,-8781.87 1986,-8675.25 1986,-8675.25"/>
<polygon fill="black" stroke="black" points="1989.5,-8675.25 1986,-8665.25 1982.5,-8675.25 1989.5,-8675.25"/>
</g>
<!-- ring_attn_2_4_stage_4 -->
<g id="node448" class="node">
<title>ring_attn_2_4_stage_4</title>
<polygon fill="yellow" stroke="black" points="2573,-8918 2364,-8850 2573,-8782 2782,-8850 2573,-8918"/>
<text text-anchor="middle" x="2573" y="-8868.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-8853.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="2573" y="-8838.8" font-family="Times,serif" font-size="14.00">Q[4]×K[0]×V[0]</text>
<text text-anchor="middle" x="2573" y="-8823.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_3_stage_4&#45;&gt;ring_attn_2_4_stage_4 -->
<g id="edge1781" class="edge">
<title>ring_attn_2_3_stage_4&#45;&gt;ring_attn_2_4_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-8850C2195.02,-8850 2353.86,-8850 2353.86,-8850"/>
<polygon fill="red" stroke="red" points="2353.86,-8853.5 2363.86,-8850 2353.86,-8846.5 2353.86,-8853.5"/>
</g>
<!-- ring_attn_2_3_stage_5&#45;&gt;ring_attn_2_3_stage_6 -->
<g id="edge348" class="edge">
<title>ring_attn_2_3_stage_5&#45;&gt;ring_attn_2_3_stage_6</title>
<path fill="none" stroke="black" d="M1986,-8528.87C1986,-8528.87 1986,-8422.25 1986,-8422.25"/>
<polygon fill="black" stroke="black" points="1989.5,-8422.25 1986,-8412.25 1982.5,-8422.25 1989.5,-8422.25"/>
</g>
<!-- ring_attn_2_4_stage_5 -->
<g id="node449" class="node">
<title>ring_attn_2_4_stage_5</title>
<polygon fill="yellow" stroke="black" points="2573,-8665 2364,-8597 2573,-8529 2782,-8597 2573,-8665"/>
<text text-anchor="middle" x="2573" y="-8615.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-8600.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="2573" y="-8585.8" font-family="Times,serif" font-size="14.00">Q[4]×K[15]×V[15]</text>
<text text-anchor="middle" x="2573" y="-8570.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_3_stage_5&#45;&gt;ring_attn_2_4_stage_5 -->
<g id="edge1782" class="edge">
<title>ring_attn_2_3_stage_5&#45;&gt;ring_attn_2_4_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-8597C2195.02,-8597 2353.86,-8597 2353.86,-8597"/>
<polygon fill="red" stroke="red" points="2353.86,-8600.5 2363.86,-8597 2353.86,-8593.5 2353.86,-8600.5"/>
</g>
<!-- ring_attn_2_3_stage_6&#45;&gt;ring_attn_2_3_stage_7 -->
<g id="edge349" class="edge">
<title>ring_attn_2_3_stage_6&#45;&gt;ring_attn_2_3_stage_7</title>
<path fill="none" stroke="black" d="M1986,-8275.87C1986,-8275.87 1986,-8169.25 1986,-8169.25"/>
<polygon fill="black" stroke="black" points="1989.5,-8169.25 1986,-8159.25 1982.5,-8169.25 1989.5,-8169.25"/>
</g>
<!-- ring_attn_2_4_stage_6 -->
<g id="node450" class="node">
<title>ring_attn_2_4_stage_6</title>
<polygon fill="yellow" stroke="black" points="2573,-8412 2364,-8344 2573,-8276 2782,-8344 2573,-8412"/>
<text text-anchor="middle" x="2573" y="-8362.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-8347.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="2573" y="-8332.8" font-family="Times,serif" font-size="14.00">Q[4]×K[14]×V[14]</text>
<text text-anchor="middle" x="2573" y="-8317.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_3_stage_6&#45;&gt;ring_attn_2_4_stage_6 -->
<g id="edge1783" class="edge">
<title>ring_attn_2_3_stage_6&#45;&gt;ring_attn_2_4_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-8344C2195.02,-8344 2353.86,-8344 2353.86,-8344"/>
<polygon fill="red" stroke="red" points="2353.86,-8347.5 2363.86,-8344 2353.86,-8340.5 2353.86,-8347.5"/>
</g>
<!-- ring_attn_2_3_stage_7&#45;&gt;ring_attn_2_3_stage_8 -->
<g id="edge350" class="edge">
<title>ring_attn_2_3_stage_7&#45;&gt;ring_attn_2_3_stage_8</title>
<path fill="none" stroke="black" d="M1986,-8022.87C1986,-8022.87 1986,-7916.25 1986,-7916.25"/>
<polygon fill="black" stroke="black" points="1989.5,-7916.25 1986,-7906.25 1982.5,-7916.25 1989.5,-7916.25"/>
</g>
<!-- ring_attn_2_4_stage_7 -->
<g id="node451" class="node">
<title>ring_attn_2_4_stage_7</title>
<polygon fill="yellow" stroke="black" points="2573,-8159 2364,-8091 2573,-8023 2782,-8091 2573,-8159"/>
<text text-anchor="middle" x="2573" y="-8109.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-8094.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="2573" y="-8079.8" font-family="Times,serif" font-size="14.00">Q[4]×K[13]×V[13]</text>
<text text-anchor="middle" x="2573" y="-8064.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_3_stage_7&#45;&gt;ring_attn_2_4_stage_7 -->
<g id="edge1784" class="edge">
<title>ring_attn_2_3_stage_7&#45;&gt;ring_attn_2_4_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-8091C2195.02,-8091 2353.86,-8091 2353.86,-8091"/>
<polygon fill="red" stroke="red" points="2353.86,-8094.5 2363.86,-8091 2353.86,-8087.5 2353.86,-8094.5"/>
</g>
<!-- ring_attn_2_3_stage_8&#45;&gt;ring_attn_2_3_stage_9 -->
<g id="edge351" class="edge">
<title>ring_attn_2_3_stage_8&#45;&gt;ring_attn_2_3_stage_9</title>
<path fill="none" stroke="black" d="M1986,-7769.87C1986,-7769.87 1986,-7663.25 1986,-7663.25"/>
<polygon fill="black" stroke="black" points="1989.5,-7663.25 1986,-7653.25 1982.5,-7663.25 1989.5,-7663.25"/>
</g>
<!-- ring_attn_2_4_stage_8 -->
<g id="node452" class="node">
<title>ring_attn_2_4_stage_8</title>
<polygon fill="yellow" stroke="black" points="2573,-7906 2364,-7838 2573,-7770 2782,-7838 2573,-7906"/>
<text text-anchor="middle" x="2573" y="-7856.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-7841.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="2573" y="-7826.8" font-family="Times,serif" font-size="14.00">Q[4]×K[12]×V[12]</text>
<text text-anchor="middle" x="2573" y="-7811.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_3_stage_8&#45;&gt;ring_attn_2_4_stage_8 -->
<g id="edge1785" class="edge">
<title>ring_attn_2_3_stage_8&#45;&gt;ring_attn_2_4_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-7838C2195.02,-7838 2353.86,-7838 2353.86,-7838"/>
<polygon fill="red" stroke="red" points="2353.86,-7841.5 2363.86,-7838 2353.86,-7834.5 2353.86,-7841.5"/>
</g>
<!-- ring_attn_2_3_stage_9&#45;&gt;ring_attn_2_3_stage_10 -->
<g id="edge352" class="edge">
<title>ring_attn_2_3_stage_9&#45;&gt;ring_attn_2_3_stage_10</title>
<path fill="none" stroke="black" d="M1986,-7516.87C1986,-7516.87 1986,-7410.25 1986,-7410.25"/>
<polygon fill="black" stroke="black" points="1989.5,-7410.25 1986,-7400.25 1982.5,-7410.25 1989.5,-7410.25"/>
</g>
<!-- ring_attn_2_4_stage_9 -->
<g id="node453" class="node">
<title>ring_attn_2_4_stage_9</title>
<polygon fill="yellow" stroke="black" points="2573,-7653 2364,-7585 2573,-7517 2782,-7585 2573,-7653"/>
<text text-anchor="middle" x="2573" y="-7603.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-7588.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="2573" y="-7573.8" font-family="Times,serif" font-size="14.00">Q[4]×K[11]×V[11]</text>
<text text-anchor="middle" x="2573" y="-7558.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_3_stage_9&#45;&gt;ring_attn_2_4_stage_9 -->
<g id="edge1786" class="edge">
<title>ring_attn_2_3_stage_9&#45;&gt;ring_attn_2_4_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-7585C2195.02,-7585 2353.86,-7585 2353.86,-7585"/>
<polygon fill="red" stroke="red" points="2353.86,-7588.5 2363.86,-7585 2353.86,-7581.5 2353.86,-7588.5"/>
</g>
<!-- ring_attn_2_3_stage_10&#45;&gt;ring_attn_2_3_stage_11 -->
<g id="edge353" class="edge">
<title>ring_attn_2_3_stage_10&#45;&gt;ring_attn_2_3_stage_11</title>
<path fill="none" stroke="black" d="M1986,-7263.87C1986,-7263.87 1986,-7157.25 1986,-7157.25"/>
<polygon fill="black" stroke="black" points="1989.5,-7157.25 1986,-7147.25 1982.5,-7157.25 1989.5,-7157.25"/>
</g>
<!-- ring_attn_2_4_stage_10 -->
<g id="node454" class="node">
<title>ring_attn_2_4_stage_10</title>
<polygon fill="yellow" stroke="black" points="2573,-7400 2364,-7332 2573,-7264 2782,-7332 2573,-7400"/>
<text text-anchor="middle" x="2573" y="-7350.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-7335.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="2573" y="-7320.8" font-family="Times,serif" font-size="14.00">Q[4]×K[10]×V[10]</text>
<text text-anchor="middle" x="2573" y="-7305.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_3_stage_10&#45;&gt;ring_attn_2_4_stage_10 -->
<g id="edge1787" class="edge">
<title>ring_attn_2_3_stage_10&#45;&gt;ring_attn_2_4_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-7332C2195.02,-7332 2353.86,-7332 2353.86,-7332"/>
<polygon fill="red" stroke="red" points="2353.86,-7335.5 2363.86,-7332 2353.86,-7328.5 2353.86,-7335.5"/>
</g>
<!-- ring_attn_2_3_stage_11&#45;&gt;ring_attn_2_3_stage_12 -->
<g id="edge354" class="edge">
<title>ring_attn_2_3_stage_11&#45;&gt;ring_attn_2_3_stage_12</title>
<path fill="none" stroke="black" d="M1986,-7010.87C1986,-7010.87 1986,-6904.25 1986,-6904.25"/>
<polygon fill="black" stroke="black" points="1989.5,-6904.25 1986,-6894.25 1982.5,-6904.25 1989.5,-6904.25"/>
</g>
<!-- ring_attn_2_4_stage_11 -->
<g id="node455" class="node">
<title>ring_attn_2_4_stage_11</title>
<polygon fill="yellow" stroke="black" points="2573,-7147 2364,-7079 2573,-7011 2782,-7079 2573,-7147"/>
<text text-anchor="middle" x="2573" y="-7097.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-7082.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="2573" y="-7067.8" font-family="Times,serif" font-size="14.00">Q[4]×K[9]×V[9]</text>
<text text-anchor="middle" x="2573" y="-7052.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_3_stage_11&#45;&gt;ring_attn_2_4_stage_11 -->
<g id="edge1788" class="edge">
<title>ring_attn_2_3_stage_11&#45;&gt;ring_attn_2_4_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-7079C2195.02,-7079 2353.86,-7079 2353.86,-7079"/>
<polygon fill="red" stroke="red" points="2353.86,-7082.5 2363.86,-7079 2353.86,-7075.5 2353.86,-7082.5"/>
</g>
<!-- ring_attn_2_3_stage_12&#45;&gt;ring_attn_2_3_stage_13 -->
<g id="edge355" class="edge">
<title>ring_attn_2_3_stage_12&#45;&gt;ring_attn_2_3_stage_13</title>
<path fill="none" stroke="black" d="M1986,-6757.87C1986,-6757.87 1986,-6651.25 1986,-6651.25"/>
<polygon fill="black" stroke="black" points="1989.5,-6651.25 1986,-6641.25 1982.5,-6651.25 1989.5,-6651.25"/>
</g>
<!-- ring_attn_2_4_stage_12 -->
<g id="node456" class="node">
<title>ring_attn_2_4_stage_12</title>
<polygon fill="yellow" stroke="black" points="2573,-6894 2364,-6826 2573,-6758 2782,-6826 2573,-6894"/>
<text text-anchor="middle" x="2573" y="-6844.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-6829.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="2573" y="-6814.8" font-family="Times,serif" font-size="14.00">Q[4]×K[8]×V[8]</text>
<text text-anchor="middle" x="2573" y="-6799.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_3_stage_12&#45;&gt;ring_attn_2_4_stage_12 -->
<g id="edge1789" class="edge">
<title>ring_attn_2_3_stage_12&#45;&gt;ring_attn_2_4_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-6826C2195.02,-6826 2353.86,-6826 2353.86,-6826"/>
<polygon fill="red" stroke="red" points="2353.86,-6829.5 2363.86,-6826 2353.86,-6822.5 2353.86,-6829.5"/>
</g>
<!-- ring_attn_2_3_stage_13&#45;&gt;ring_attn_2_3_stage_14 -->
<g id="edge356" class="edge">
<title>ring_attn_2_3_stage_13&#45;&gt;ring_attn_2_3_stage_14</title>
<path fill="none" stroke="black" d="M1986,-6504.87C1986,-6504.87 1986,-6398.25 1986,-6398.25"/>
<polygon fill="black" stroke="black" points="1989.5,-6398.25 1986,-6388.25 1982.5,-6398.25 1989.5,-6398.25"/>
</g>
<!-- ring_attn_2_4_stage_13 -->
<g id="node457" class="node">
<title>ring_attn_2_4_stage_13</title>
<polygon fill="yellow" stroke="black" points="2573,-6641 2364,-6573 2573,-6505 2782,-6573 2573,-6641"/>
<text text-anchor="middle" x="2573" y="-6591.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-6576.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="2573" y="-6561.8" font-family="Times,serif" font-size="14.00">Q[4]×K[7]×V[7]</text>
<text text-anchor="middle" x="2573" y="-6546.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_3_stage_13&#45;&gt;ring_attn_2_4_stage_13 -->
<g id="edge1790" class="edge">
<title>ring_attn_2_3_stage_13&#45;&gt;ring_attn_2_4_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-6573C2195.02,-6573 2353.86,-6573 2353.86,-6573"/>
<polygon fill="red" stroke="red" points="2353.86,-6576.5 2363.86,-6573 2353.86,-6569.5 2353.86,-6576.5"/>
</g>
<!-- ring_attn_2_3_stage_14&#45;&gt;ring_attn_2_3_stage_15 -->
<g id="edge357" class="edge">
<title>ring_attn_2_3_stage_14&#45;&gt;ring_attn_2_3_stage_15</title>
<path fill="none" stroke="black" d="M1986,-6251.87C1986,-6251.87 1986,-6145.25 1986,-6145.25"/>
<polygon fill="black" stroke="black" points="1989.5,-6145.25 1986,-6135.25 1982.5,-6145.25 1989.5,-6145.25"/>
</g>
<!-- ring_attn_2_4_stage_14 -->
<g id="node458" class="node">
<title>ring_attn_2_4_stage_14</title>
<polygon fill="yellow" stroke="black" points="2573,-6388 2364,-6320 2573,-6252 2782,-6320 2573,-6388"/>
<text text-anchor="middle" x="2573" y="-6338.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-6323.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="2573" y="-6308.8" font-family="Times,serif" font-size="14.00">Q[4]×K[6]×V[6]</text>
<text text-anchor="middle" x="2573" y="-6293.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_3_stage_14&#45;&gt;ring_attn_2_4_stage_14 -->
<g id="edge1791" class="edge">
<title>ring_attn_2_3_stage_14&#45;&gt;ring_attn_2_4_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-6320C2195.02,-6320 2353.86,-6320 2353.86,-6320"/>
<polygon fill="red" stroke="red" points="2353.86,-6323.5 2363.86,-6320 2353.86,-6316.5 2353.86,-6323.5"/>
</g>
<!-- attn_out_2_3 -->
<g id="node362" class="node">
<title>attn_out_2_3</title>
<polygon fill="none" stroke="black" points="2055.5,-5926 1916.5,-5926 1916.5,-5873 2055.5,-5873 2055.5,-5926"/>
<text text-anchor="middle" x="1986" y="-5910.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1986" y="-5895.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="1986" y="-5880.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_2_3_stage_15&#45;&gt;attn_out_2_3 -->
<g id="edge358" class="edge">
<title>ring_attn_2_3_stage_15&#45;&gt;attn_out_2_3</title>
<path fill="none" stroke="black" d="M1986,-5998.87C1986,-5998.87 1986,-5936.18 1986,-5936.18"/>
<polygon fill="black" stroke="black" points="1989.5,-5936.18 1986,-5926.18 1982.5,-5936.18 1989.5,-5936.18"/>
</g>
<!-- ring_attn_2_4_stage_15 -->
<g id="node459" class="node">
<title>ring_attn_2_4_stage_15</title>
<polygon fill="yellow" stroke="black" points="2573,-6135 2364,-6067 2573,-5999 2782,-6067 2573,-6135"/>
<text text-anchor="middle" x="2573" y="-6085.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-6070.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="2573" y="-6055.8" font-family="Times,serif" font-size="14.00">Q[4]×K[5]×V[5]</text>
<text text-anchor="middle" x="2573" y="-6040.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_3_stage_15&#45;&gt;ring_attn_2_4_stage_15 -->
<g id="edge1792" class="edge">
<title>ring_attn_2_3_stage_15&#45;&gt;ring_attn_2_4_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-6067C2195.02,-6067 2353.86,-6067 2353.86,-6067"/>
<polygon fill="red" stroke="red" points="2353.86,-6070.5 2363.86,-6067 2353.86,-6063.5 2353.86,-6070.5"/>
</g>
<!-- attn_residual_2_3 -->
<g id="node363" class="node">
<title>attn_residual_2_3</title>
<ellipse fill="none" stroke="black" cx="1986" cy="-5773" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1986" y="-5776.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1986" y="-5761.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_2_3&#45;&gt;attn_residual_2_3 -->
<g id="edge359" class="edge">
<title>attn_out_2_3&#45;&gt;attn_residual_2_3</title>
<path fill="none" stroke="black" d="M1986,-5872.98C1986,-5872.98 1986,-5810.36 1986,-5810.36"/>
<polygon fill="black" stroke="black" points="1989.5,-5810.36 1986,-5800.36 1982.5,-5810.36 1989.5,-5810.36"/>
</g>
<!-- ffn_up_2_3 -->
<g id="node364" class="node">
<title>ffn_up_2_3</title>
<polygon fill="none" stroke="black" points="2065,-5673 1907,-5673 1907,-5620 2065,-5620 2065,-5673"/>
<text text-anchor="middle" x="1986" y="-5657.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1986" y="-5642.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="1986" y="-5627.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_2_3&#45;&gt;ffn_up_2_3 -->
<g id="edge360" class="edge">
<title>attn_residual_2_3&#45;&gt;ffn_up_2_3</title>
<path fill="none" stroke="black" d="M1986,-5745.86C1986,-5745.86 1986,-5683.16 1986,-5683.16"/>
<polygon fill="black" stroke="black" points="1989.5,-5683.16 1986,-5673.16 1982.5,-5683.16 1989.5,-5683.16"/>
</g>
<!-- ffn_gelu_2_3 -->
<g id="node365" class="node">
<title>ffn_gelu_2_3</title>
<ellipse fill="none" stroke="black" cx="1986" cy="-5520" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1986" y="-5523.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1986" y="-5508.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_2_3&#45;&gt;ffn_gelu_2_3 -->
<g id="edge361" class="edge">
<title>ffn_up_2_3&#45;&gt;ffn_gelu_2_3</title>
<path fill="none" stroke="black" d="M1986,-5619.98C1986,-5619.98 1986,-5557.36 1986,-5557.36"/>
<polygon fill="black" stroke="black" points="1989.5,-5557.36 1986,-5547.36 1982.5,-5557.36 1989.5,-5557.36"/>
</g>
<!-- ffn_down_2_3 -->
<g id="node366" class="node">
<title>ffn_down_2_3</title>
<polygon fill="none" stroke="black" points="2075,-5420 1897,-5420 1897,-5367 2075,-5367 2075,-5420"/>
<text text-anchor="middle" x="1986" y="-5404.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1986" y="-5389.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="1986" y="-5374.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_2_3&#45;&gt;ffn_down_2_3 -->
<g id="edge362" class="edge">
<title>ffn_gelu_2_3&#45;&gt;ffn_down_2_3</title>
<path fill="none" stroke="black" d="M1986,-5492.86C1986,-5492.86 1986,-5430.16 1986,-5430.16"/>
<polygon fill="black" stroke="black" points="1989.5,-5430.16 1986,-5420.16 1982.5,-5430.16 1989.5,-5430.16"/>
</g>
<!-- ffn_residual_2_3 -->
<g id="node367" class="node">
<title>ffn_residual_2_3</title>
<ellipse fill="none" stroke="black" cx="1986" cy="-5267" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1986" y="-5270.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1986" y="-5255.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_2_3&#45;&gt;ffn_residual_2_3 -->
<g id="edge363" class="edge">
<title>ffn_down_2_3&#45;&gt;ffn_residual_2_3</title>
<path fill="none" stroke="black" d="M1986,-5366.98C1986,-5366.98 1986,-5304.36 1986,-5304.36"/>
<polygon fill="black" stroke="black" points="1989.5,-5304.36 1986,-5294.36 1982.5,-5304.36 1989.5,-5304.36"/>
</g>
<!-- qkv_proj_3_3 -->
<g id="node368" class="node">
<title>qkv_proj_3_3</title>
<polygon fill="none" stroke="black" points="2068.5,-5167 1903.5,-5167 1903.5,-5114 2068.5,-5114 2068.5,-5167"/>
<text text-anchor="middle" x="1986" y="-5151.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1986" y="-5136.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="1986" y="-5121.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_2_3&#45;&gt;qkv_proj_3_3 -->
<g id="edge364" class="edge">
<title>ffn_residual_2_3&#45;&gt;qkv_proj_3_3</title>
<path fill="none" stroke="black" d="M1986,-5239.86C1986,-5239.86 1986,-5177.16 1986,-5177.16"/>
<polygon fill="black" stroke="black" points="1989.5,-5177.16 1986,-5167.16 1982.5,-5177.16 1989.5,-5177.16"/>
</g>
<!-- qkv_reshape_3_3 -->
<g id="node369" class="node">
<title>qkv_reshape_3_3</title>
<ellipse fill="none" stroke="black" cx="1986" cy="-5014" rx="148" ry="27"/>
<text text-anchor="middle" x="1986" y="-5017.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="1986" y="-5002.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_3_3&#45;&gt;qkv_reshape_3_3 -->
<g id="edge365" class="edge">
<title>qkv_proj_3_3&#45;&gt;qkv_reshape_3_3</title>
<path fill="none" stroke="black" d="M1986,-5113.98C1986,-5113.98 1986,-5051.36 1986,-5051.36"/>
<polygon fill="black" stroke="black" points="1989.5,-5051.36 1986,-5041.36 1982.5,-5051.36 1989.5,-5051.36"/>
</g>
<!-- qkv_reshape_3_3&#45;&gt;ring_attn_3_3_stage_0 -->
<g id="edge366" class="edge">
<title>qkv_reshape_3_3&#45;&gt;ring_attn_3_3_stage_0</title>
<path fill="none" stroke="black" d="M1986,-4986.72C1986,-4986.72 1986,-4880.16 1986,-4880.16"/>
<polygon fill="black" stroke="black" points="1989.5,-4880.16 1986,-4870.16 1982.5,-4880.16 1989.5,-4880.16"/>
</g>
<!-- ring_attn_3_3_stage_0&#45;&gt;ring_attn_3_3_stage_1 -->
<g id="edge367" class="edge">
<title>ring_attn_3_3_stage_0&#45;&gt;ring_attn_3_3_stage_1</title>
<path fill="none" stroke="black" d="M1986,-4733.87C1986,-4733.87 1986,-4627.25 1986,-4627.25"/>
<polygon fill="black" stroke="black" points="1989.5,-4627.25 1986,-4617.25 1982.5,-4627.25 1989.5,-4627.25"/>
</g>
<!-- ring_attn_3_4_stage_0 -->
<g id="node468" class="node">
<title>ring_attn_3_4_stage_0</title>
<polygon fill="yellow" stroke="black" points="2573,-4870 2364,-4802 2573,-4734 2782,-4802 2573,-4870"/>
<text text-anchor="middle" x="2573" y="-4820.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-4805.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="2573" y="-4790.8" font-family="Times,serif" font-size="14.00">Q[4]×K[4]×V[4]</text>
<text text-anchor="middle" x="2573" y="-4775.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_3_stage_0&#45;&gt;ring_attn_3_4_stage_0 -->
<g id="edge1793" class="edge">
<title>ring_attn_3_3_stage_0&#45;&gt;ring_attn_3_4_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-4802C2195.02,-4802 2353.86,-4802 2353.86,-4802"/>
<polygon fill="red" stroke="red" points="2353.86,-4805.5 2363.86,-4802 2353.86,-4798.5 2353.86,-4805.5"/>
</g>
<!-- ring_attn_3_3_stage_1&#45;&gt;ring_attn_3_3_stage_2 -->
<g id="edge368" class="edge">
<title>ring_attn_3_3_stage_1&#45;&gt;ring_attn_3_3_stage_2</title>
<path fill="none" stroke="black" d="M1986,-4480.87C1986,-4480.87 1986,-4374.25 1986,-4374.25"/>
<polygon fill="black" stroke="black" points="1989.5,-4374.25 1986,-4364.25 1982.5,-4374.25 1989.5,-4374.25"/>
</g>
<!-- ring_attn_3_4_stage_1 -->
<g id="node469" class="node">
<title>ring_attn_3_4_stage_1</title>
<polygon fill="yellow" stroke="black" points="2573,-4617 2364,-4549 2573,-4481 2782,-4549 2573,-4617"/>
<text text-anchor="middle" x="2573" y="-4567.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-4552.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="2573" y="-4537.8" font-family="Times,serif" font-size="14.00">Q[4]×K[3]×V[3]</text>
<text text-anchor="middle" x="2573" y="-4522.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_3_stage_1&#45;&gt;ring_attn_3_4_stage_1 -->
<g id="edge1794" class="edge">
<title>ring_attn_3_3_stage_1&#45;&gt;ring_attn_3_4_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-4549C2195.02,-4549 2353.86,-4549 2353.86,-4549"/>
<polygon fill="red" stroke="red" points="2353.86,-4552.5 2363.86,-4549 2353.86,-4545.5 2353.86,-4552.5"/>
</g>
<!-- ring_attn_3_3_stage_2&#45;&gt;ring_attn_3_3_stage_3 -->
<g id="edge369" class="edge">
<title>ring_attn_3_3_stage_2&#45;&gt;ring_attn_3_3_stage_3</title>
<path fill="none" stroke="black" d="M1986,-4227.87C1986,-4227.87 1986,-4121.25 1986,-4121.25"/>
<polygon fill="black" stroke="black" points="1989.5,-4121.25 1986,-4111.25 1982.5,-4121.25 1989.5,-4121.25"/>
</g>
<!-- ring_attn_3_4_stage_2 -->
<g id="node470" class="node">
<title>ring_attn_3_4_stage_2</title>
<polygon fill="yellow" stroke="black" points="2573,-4364 2364,-4296 2573,-4228 2782,-4296 2573,-4364"/>
<text text-anchor="middle" x="2573" y="-4314.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-4299.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="2573" y="-4284.8" font-family="Times,serif" font-size="14.00">Q[4]×K[2]×V[2]</text>
<text text-anchor="middle" x="2573" y="-4269.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_3_stage_2&#45;&gt;ring_attn_3_4_stage_2 -->
<g id="edge1795" class="edge">
<title>ring_attn_3_3_stage_2&#45;&gt;ring_attn_3_4_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-4296C2195.02,-4296 2353.86,-4296 2353.86,-4296"/>
<polygon fill="red" stroke="red" points="2353.86,-4299.5 2363.86,-4296 2353.86,-4292.5 2353.86,-4299.5"/>
</g>
<!-- ring_attn_3_3_stage_3&#45;&gt;ring_attn_3_3_stage_4 -->
<g id="edge370" class="edge">
<title>ring_attn_3_3_stage_3&#45;&gt;ring_attn_3_3_stage_4</title>
<path fill="none" stroke="black" d="M1986,-3974.87C1986,-3974.87 1986,-3868.25 1986,-3868.25"/>
<polygon fill="black" stroke="black" points="1989.5,-3868.25 1986,-3858.25 1982.5,-3868.25 1989.5,-3868.25"/>
</g>
<!-- ring_attn_3_4_stage_3 -->
<g id="node471" class="node">
<title>ring_attn_3_4_stage_3</title>
<polygon fill="yellow" stroke="black" points="2573,-4111 2364,-4043 2573,-3975 2782,-4043 2573,-4111"/>
<text text-anchor="middle" x="2573" y="-4061.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-4046.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="2573" y="-4031.8" font-family="Times,serif" font-size="14.00">Q[4]×K[1]×V[1]</text>
<text text-anchor="middle" x="2573" y="-4016.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_3_stage_3&#45;&gt;ring_attn_3_4_stage_3 -->
<g id="edge1796" class="edge">
<title>ring_attn_3_3_stage_3&#45;&gt;ring_attn_3_4_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-4043C2195.02,-4043 2353.86,-4043 2353.86,-4043"/>
<polygon fill="red" stroke="red" points="2353.86,-4046.5 2363.86,-4043 2353.86,-4039.5 2353.86,-4046.5"/>
</g>
<!-- ring_attn_3_3_stage_4&#45;&gt;ring_attn_3_3_stage_5 -->
<g id="edge371" class="edge">
<title>ring_attn_3_3_stage_4&#45;&gt;ring_attn_3_3_stage_5</title>
<path fill="none" stroke="black" d="M1986,-3721.87C1986,-3721.87 1986,-3615.25 1986,-3615.25"/>
<polygon fill="black" stroke="black" points="1989.5,-3615.25 1986,-3605.25 1982.5,-3615.25 1989.5,-3615.25"/>
</g>
<!-- ring_attn_3_4_stage_4 -->
<g id="node472" class="node">
<title>ring_attn_3_4_stage_4</title>
<polygon fill="yellow" stroke="black" points="2573,-3858 2364,-3790 2573,-3722 2782,-3790 2573,-3858"/>
<text text-anchor="middle" x="2573" y="-3808.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-3793.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="2573" y="-3778.8" font-family="Times,serif" font-size="14.00">Q[4]×K[0]×V[0]</text>
<text text-anchor="middle" x="2573" y="-3763.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_3_stage_4&#45;&gt;ring_attn_3_4_stage_4 -->
<g id="edge1797" class="edge">
<title>ring_attn_3_3_stage_4&#45;&gt;ring_attn_3_4_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-3790C2195.02,-3790 2353.86,-3790 2353.86,-3790"/>
<polygon fill="red" stroke="red" points="2353.86,-3793.5 2363.86,-3790 2353.86,-3786.5 2353.86,-3793.5"/>
</g>
<!-- ring_attn_3_3_stage_5&#45;&gt;ring_attn_3_3_stage_6 -->
<g id="edge372" class="edge">
<title>ring_attn_3_3_stage_5&#45;&gt;ring_attn_3_3_stage_6</title>
<path fill="none" stroke="black" d="M1986,-3468.87C1986,-3468.87 1986,-3362.25 1986,-3362.25"/>
<polygon fill="black" stroke="black" points="1989.5,-3362.25 1986,-3352.25 1982.5,-3362.25 1989.5,-3362.25"/>
</g>
<!-- ring_attn_3_4_stage_5 -->
<g id="node473" class="node">
<title>ring_attn_3_4_stage_5</title>
<polygon fill="yellow" stroke="black" points="2573,-3605 2364,-3537 2573,-3469 2782,-3537 2573,-3605"/>
<text text-anchor="middle" x="2573" y="-3555.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-3540.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="2573" y="-3525.8" font-family="Times,serif" font-size="14.00">Q[4]×K[15]×V[15]</text>
<text text-anchor="middle" x="2573" y="-3510.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_3_stage_5&#45;&gt;ring_attn_3_4_stage_5 -->
<g id="edge1798" class="edge">
<title>ring_attn_3_3_stage_5&#45;&gt;ring_attn_3_4_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-3537C2195.02,-3537 2353.86,-3537 2353.86,-3537"/>
<polygon fill="red" stroke="red" points="2353.86,-3540.5 2363.86,-3537 2353.86,-3533.5 2353.86,-3540.5"/>
</g>
<!-- ring_attn_3_3_stage_6&#45;&gt;ring_attn_3_3_stage_7 -->
<g id="edge373" class="edge">
<title>ring_attn_3_3_stage_6&#45;&gt;ring_attn_3_3_stage_7</title>
<path fill="none" stroke="black" d="M1986,-3215.87C1986,-3215.87 1986,-3109.25 1986,-3109.25"/>
<polygon fill="black" stroke="black" points="1989.5,-3109.25 1986,-3099.25 1982.5,-3109.25 1989.5,-3109.25"/>
</g>
<!-- ring_attn_3_4_stage_6 -->
<g id="node474" class="node">
<title>ring_attn_3_4_stage_6</title>
<polygon fill="yellow" stroke="black" points="2573,-3352 2364,-3284 2573,-3216 2782,-3284 2573,-3352"/>
<text text-anchor="middle" x="2573" y="-3302.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-3287.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="2573" y="-3272.8" font-family="Times,serif" font-size="14.00">Q[4]×K[14]×V[14]</text>
<text text-anchor="middle" x="2573" y="-3257.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_3_stage_6&#45;&gt;ring_attn_3_4_stage_6 -->
<g id="edge1799" class="edge">
<title>ring_attn_3_3_stage_6&#45;&gt;ring_attn_3_4_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-3284C2195.02,-3284 2353.86,-3284 2353.86,-3284"/>
<polygon fill="red" stroke="red" points="2353.86,-3287.5 2363.86,-3284 2353.86,-3280.5 2353.86,-3287.5"/>
</g>
<!-- ring_attn_3_3_stage_7&#45;&gt;ring_attn_3_3_stage_8 -->
<g id="edge374" class="edge">
<title>ring_attn_3_3_stage_7&#45;&gt;ring_attn_3_3_stage_8</title>
<path fill="none" stroke="black" d="M1986,-2962.87C1986,-2962.87 1986,-2856.25 1986,-2856.25"/>
<polygon fill="black" stroke="black" points="1989.5,-2856.25 1986,-2846.25 1982.5,-2856.25 1989.5,-2856.25"/>
</g>
<!-- ring_attn_3_4_stage_7 -->
<g id="node475" class="node">
<title>ring_attn_3_4_stage_7</title>
<polygon fill="yellow" stroke="black" points="2573,-3099 2364,-3031 2573,-2963 2782,-3031 2573,-3099"/>
<text text-anchor="middle" x="2573" y="-3049.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-3034.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="2573" y="-3019.8" font-family="Times,serif" font-size="14.00">Q[4]×K[13]×V[13]</text>
<text text-anchor="middle" x="2573" y="-3004.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_3_stage_7&#45;&gt;ring_attn_3_4_stage_7 -->
<g id="edge1800" class="edge">
<title>ring_attn_3_3_stage_7&#45;&gt;ring_attn_3_4_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-3031C2195.02,-3031 2353.86,-3031 2353.86,-3031"/>
<polygon fill="red" stroke="red" points="2353.86,-3034.5 2363.86,-3031 2353.86,-3027.5 2353.86,-3034.5"/>
</g>
<!-- ring_attn_3_3_stage_8&#45;&gt;ring_attn_3_3_stage_9 -->
<g id="edge375" class="edge">
<title>ring_attn_3_3_stage_8&#45;&gt;ring_attn_3_3_stage_9</title>
<path fill="none" stroke="black" d="M1986,-2709.87C1986,-2709.87 1986,-2603.25 1986,-2603.25"/>
<polygon fill="black" stroke="black" points="1989.5,-2603.25 1986,-2593.25 1982.5,-2603.25 1989.5,-2603.25"/>
</g>
<!-- ring_attn_3_4_stage_8 -->
<g id="node476" class="node">
<title>ring_attn_3_4_stage_8</title>
<polygon fill="yellow" stroke="black" points="2573,-2846 2364,-2778 2573,-2710 2782,-2778 2573,-2846"/>
<text text-anchor="middle" x="2573" y="-2796.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-2781.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="2573" y="-2766.8" font-family="Times,serif" font-size="14.00">Q[4]×K[12]×V[12]</text>
<text text-anchor="middle" x="2573" y="-2751.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_3_stage_8&#45;&gt;ring_attn_3_4_stage_8 -->
<g id="edge1801" class="edge">
<title>ring_attn_3_3_stage_8&#45;&gt;ring_attn_3_4_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-2778C2195.02,-2778 2353.86,-2778 2353.86,-2778"/>
<polygon fill="red" stroke="red" points="2353.86,-2781.5 2363.86,-2778 2353.86,-2774.5 2353.86,-2781.5"/>
</g>
<!-- ring_attn_3_3_stage_9&#45;&gt;ring_attn_3_3_stage_10 -->
<g id="edge376" class="edge">
<title>ring_attn_3_3_stage_9&#45;&gt;ring_attn_3_3_stage_10</title>
<path fill="none" stroke="black" d="M1986,-2456.87C1986,-2456.87 1986,-2350.25 1986,-2350.25"/>
<polygon fill="black" stroke="black" points="1989.5,-2350.25 1986,-2340.25 1982.5,-2350.25 1989.5,-2350.25"/>
</g>
<!-- ring_attn_3_4_stage_9 -->
<g id="node477" class="node">
<title>ring_attn_3_4_stage_9</title>
<polygon fill="yellow" stroke="black" points="2573,-2593 2364,-2525 2573,-2457 2782,-2525 2573,-2593"/>
<text text-anchor="middle" x="2573" y="-2543.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-2528.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="2573" y="-2513.8" font-family="Times,serif" font-size="14.00">Q[4]×K[11]×V[11]</text>
<text text-anchor="middle" x="2573" y="-2498.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_3_stage_9&#45;&gt;ring_attn_3_4_stage_9 -->
<g id="edge1802" class="edge">
<title>ring_attn_3_3_stage_9&#45;&gt;ring_attn_3_4_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-2525C2195.02,-2525 2353.86,-2525 2353.86,-2525"/>
<polygon fill="red" stroke="red" points="2353.86,-2528.5 2363.86,-2525 2353.86,-2521.5 2353.86,-2528.5"/>
</g>
<!-- ring_attn_3_3_stage_10&#45;&gt;ring_attn_3_3_stage_11 -->
<g id="edge377" class="edge">
<title>ring_attn_3_3_stage_10&#45;&gt;ring_attn_3_3_stage_11</title>
<path fill="none" stroke="black" d="M1986,-2203.87C1986,-2203.87 1986,-2097.25 1986,-2097.25"/>
<polygon fill="black" stroke="black" points="1989.5,-2097.25 1986,-2087.25 1982.5,-2097.25 1989.5,-2097.25"/>
</g>
<!-- ring_attn_3_4_stage_10 -->
<g id="node478" class="node">
<title>ring_attn_3_4_stage_10</title>
<polygon fill="yellow" stroke="black" points="2573,-2340 2364,-2272 2573,-2204 2782,-2272 2573,-2340"/>
<text text-anchor="middle" x="2573" y="-2290.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-2275.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="2573" y="-2260.8" font-family="Times,serif" font-size="14.00">Q[4]×K[10]×V[10]</text>
<text text-anchor="middle" x="2573" y="-2245.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_3_stage_10&#45;&gt;ring_attn_3_4_stage_10 -->
<g id="edge1803" class="edge">
<title>ring_attn_3_3_stage_10&#45;&gt;ring_attn_3_4_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-2272C2195.02,-2272 2353.86,-2272 2353.86,-2272"/>
<polygon fill="red" stroke="red" points="2353.86,-2275.5 2363.86,-2272 2353.86,-2268.5 2353.86,-2275.5"/>
</g>
<!-- ring_attn_3_3_stage_11&#45;&gt;ring_attn_3_3_stage_12 -->
<g id="edge378" class="edge">
<title>ring_attn_3_3_stage_11&#45;&gt;ring_attn_3_3_stage_12</title>
<path fill="none" stroke="black" d="M1986,-1950.87C1986,-1950.87 1986,-1844.25 1986,-1844.25"/>
<polygon fill="black" stroke="black" points="1989.5,-1844.25 1986,-1834.25 1982.5,-1844.25 1989.5,-1844.25"/>
</g>
<!-- ring_attn_3_4_stage_11 -->
<g id="node479" class="node">
<title>ring_attn_3_4_stage_11</title>
<polygon fill="yellow" stroke="black" points="2573,-2087 2364,-2019 2573,-1951 2782,-2019 2573,-2087"/>
<text text-anchor="middle" x="2573" y="-2037.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-2022.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="2573" y="-2007.8" font-family="Times,serif" font-size="14.00">Q[4]×K[9]×V[9]</text>
<text text-anchor="middle" x="2573" y="-1992.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_3_stage_11&#45;&gt;ring_attn_3_4_stage_11 -->
<g id="edge1804" class="edge">
<title>ring_attn_3_3_stage_11&#45;&gt;ring_attn_3_4_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-2019C2195.02,-2019 2353.86,-2019 2353.86,-2019"/>
<polygon fill="red" stroke="red" points="2353.86,-2022.5 2363.86,-2019 2353.86,-2015.5 2353.86,-2022.5"/>
</g>
<!-- ring_attn_3_3_stage_12&#45;&gt;ring_attn_3_3_stage_13 -->
<g id="edge379" class="edge">
<title>ring_attn_3_3_stage_12&#45;&gt;ring_attn_3_3_stage_13</title>
<path fill="none" stroke="black" d="M1986,-1697.87C1986,-1697.87 1986,-1591.25 1986,-1591.25"/>
<polygon fill="black" stroke="black" points="1989.5,-1591.25 1986,-1581.25 1982.5,-1591.25 1989.5,-1591.25"/>
</g>
<!-- ring_attn_3_4_stage_12 -->
<g id="node480" class="node">
<title>ring_attn_3_4_stage_12</title>
<polygon fill="yellow" stroke="black" points="2573,-1834 2364,-1766 2573,-1698 2782,-1766 2573,-1834"/>
<text text-anchor="middle" x="2573" y="-1784.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-1769.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="2573" y="-1754.8" font-family="Times,serif" font-size="14.00">Q[4]×K[8]×V[8]</text>
<text text-anchor="middle" x="2573" y="-1739.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_3_stage_12&#45;&gt;ring_attn_3_4_stage_12 -->
<g id="edge1805" class="edge">
<title>ring_attn_3_3_stage_12&#45;&gt;ring_attn_3_4_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-1766C2195.02,-1766 2353.86,-1766 2353.86,-1766"/>
<polygon fill="red" stroke="red" points="2353.86,-1769.5 2363.86,-1766 2353.86,-1762.5 2353.86,-1769.5"/>
</g>
<!-- ring_attn_3_3_stage_13&#45;&gt;ring_attn_3_3_stage_14 -->
<g id="edge380" class="edge">
<title>ring_attn_3_3_stage_13&#45;&gt;ring_attn_3_3_stage_14</title>
<path fill="none" stroke="black" d="M1986,-1444.87C1986,-1444.87 1986,-1338.25 1986,-1338.25"/>
<polygon fill="black" stroke="black" points="1989.5,-1338.25 1986,-1328.25 1982.5,-1338.25 1989.5,-1338.25"/>
</g>
<!-- ring_attn_3_4_stage_13 -->
<g id="node481" class="node">
<title>ring_attn_3_4_stage_13</title>
<polygon fill="yellow" stroke="black" points="2573,-1581 2364,-1513 2573,-1445 2782,-1513 2573,-1581"/>
<text text-anchor="middle" x="2573" y="-1531.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-1516.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="2573" y="-1501.8" font-family="Times,serif" font-size="14.00">Q[4]×K[7]×V[7]</text>
<text text-anchor="middle" x="2573" y="-1486.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_3_stage_13&#45;&gt;ring_attn_3_4_stage_13 -->
<g id="edge1806" class="edge">
<title>ring_attn_3_3_stage_13&#45;&gt;ring_attn_3_4_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-1513C2195.02,-1513 2353.86,-1513 2353.86,-1513"/>
<polygon fill="red" stroke="red" points="2353.86,-1516.5 2363.86,-1513 2353.86,-1509.5 2353.86,-1516.5"/>
</g>
<!-- ring_attn_3_3_stage_14&#45;&gt;ring_attn_3_3_stage_15 -->
<g id="edge381" class="edge">
<title>ring_attn_3_3_stage_14&#45;&gt;ring_attn_3_3_stage_15</title>
<path fill="none" stroke="black" d="M1986,-1191.87C1986,-1191.87 1986,-1085.25 1986,-1085.25"/>
<polygon fill="black" stroke="black" points="1989.5,-1085.25 1986,-1075.25 1982.5,-1085.25 1989.5,-1085.25"/>
</g>
<!-- ring_attn_3_4_stage_14 -->
<g id="node482" class="node">
<title>ring_attn_3_4_stage_14</title>
<polygon fill="yellow" stroke="black" points="2573,-1328 2364,-1260 2573,-1192 2782,-1260 2573,-1328"/>
<text text-anchor="middle" x="2573" y="-1278.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-1263.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="2573" y="-1248.8" font-family="Times,serif" font-size="14.00">Q[4]×K[6]×V[6]</text>
<text text-anchor="middle" x="2573" y="-1233.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_3_stage_14&#45;&gt;ring_attn_3_4_stage_14 -->
<g id="edge1807" class="edge">
<title>ring_attn_3_3_stage_14&#45;&gt;ring_attn_3_4_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-1260C2195.02,-1260 2353.86,-1260 2353.86,-1260"/>
<polygon fill="red" stroke="red" points="2353.86,-1263.5 2363.86,-1260 2353.86,-1256.5 2353.86,-1263.5"/>
</g>
<!-- attn_out_3_3 -->
<g id="node386" class="node">
<title>attn_out_3_3</title>
<polygon fill="none" stroke="black" points="2055.5,-866 1916.5,-866 1916.5,-813 2055.5,-813 2055.5,-866"/>
<text text-anchor="middle" x="1986" y="-850.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1986" y="-835.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="1986" y="-820.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_3_3_stage_15&#45;&gt;attn_out_3_3 -->
<g id="edge382" class="edge">
<title>ring_attn_3_3_stage_15&#45;&gt;attn_out_3_3</title>
<path fill="none" stroke="black" d="M1986,-938.87C1986,-938.87 1986,-876.18 1986,-876.18"/>
<polygon fill="black" stroke="black" points="1989.5,-876.18 1986,-866.18 1982.5,-876.18 1989.5,-876.18"/>
</g>
<!-- ring_attn_3_4_stage_15 -->
<g id="node483" class="node">
<title>ring_attn_3_4_stage_15</title>
<polygon fill="yellow" stroke="black" points="2573,-1075 2364,-1007 2573,-939 2782,-1007 2573,-1075"/>
<text text-anchor="middle" x="2573" y="-1025.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="2573" y="-1010.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="2573" y="-995.8" font-family="Times,serif" font-size="14.00">Q[4]×K[5]×V[5]</text>
<text text-anchor="middle" x="2573" y="-980.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_3_stage_15&#45;&gt;ring_attn_3_4_stage_15 -->
<g id="edge1808" class="edge">
<title>ring_attn_3_3_stage_15&#45;&gt;ring_attn_3_4_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2195.02,-1007C2195.02,-1007 2353.86,-1007 2353.86,-1007"/>
<polygon fill="red" stroke="red" points="2353.86,-1010.5 2363.86,-1007 2353.86,-1003.5 2353.86,-1010.5"/>
</g>
<!-- attn_residual_3_3 -->
<g id="node387" class="node">
<title>attn_residual_3_3</title>
<ellipse fill="none" stroke="black" cx="1986" cy="-713" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1986" y="-716.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1986" y="-701.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_3_3&#45;&gt;attn_residual_3_3 -->
<g id="edge383" class="edge">
<title>attn_out_3_3&#45;&gt;attn_residual_3_3</title>
<path fill="none" stroke="black" d="M1986,-812.98C1986,-812.98 1986,-750.36 1986,-750.36"/>
<polygon fill="black" stroke="black" points="1989.5,-750.36 1986,-740.36 1982.5,-750.36 1989.5,-750.36"/>
</g>
<!-- ffn_up_3_3 -->
<g id="node388" class="node">
<title>ffn_up_3_3</title>
<polygon fill="none" stroke="black" points="2065,-613 1907,-613 1907,-560 2065,-560 2065,-613"/>
<text text-anchor="middle" x="1986" y="-597.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1986" y="-582.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="1986" y="-567.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_3_3&#45;&gt;ffn_up_3_3 -->
<g id="edge384" class="edge">
<title>attn_residual_3_3&#45;&gt;ffn_up_3_3</title>
<path fill="none" stroke="black" d="M1986,-685.86C1986,-685.86 1986,-623.16 1986,-623.16"/>
<polygon fill="black" stroke="black" points="1989.5,-623.16 1986,-613.16 1982.5,-623.16 1989.5,-623.16"/>
</g>
<!-- ffn_gelu_3_3 -->
<g id="node389" class="node">
<title>ffn_gelu_3_3</title>
<ellipse fill="none" stroke="black" cx="1986" cy="-460" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1986" y="-463.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1986" y="-448.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_3_3&#45;&gt;ffn_gelu_3_3 -->
<g id="edge385" class="edge">
<title>ffn_up_3_3&#45;&gt;ffn_gelu_3_3</title>
<path fill="none" stroke="black" d="M1986,-559.98C1986,-559.98 1986,-497.36 1986,-497.36"/>
<polygon fill="black" stroke="black" points="1989.5,-497.36 1986,-487.36 1982.5,-497.36 1989.5,-497.36"/>
</g>
<!-- ffn_down_3_3 -->
<g id="node390" class="node">
<title>ffn_down_3_3</title>
<polygon fill="none" stroke="black" points="2075,-360 1897,-360 1897,-307 2075,-307 2075,-360"/>
<text text-anchor="middle" x="1986" y="-344.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1986" y="-329.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="1986" y="-314.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_3_3&#45;&gt;ffn_down_3_3 -->
<g id="edge386" class="edge">
<title>ffn_gelu_3_3&#45;&gt;ffn_down_3_3</title>
<path fill="none" stroke="black" d="M1986,-432.86C1986,-432.86 1986,-370.16 1986,-370.16"/>
<polygon fill="black" stroke="black" points="1989.5,-370.16 1986,-360.16 1982.5,-370.16 1989.5,-370.16"/>
</g>
<!-- ffn_residual_3_3 -->
<g id="node391" class="node">
<title>ffn_residual_3_3</title>
<ellipse fill="none" stroke="black" cx="1986" cy="-207" rx="105.5" ry="27"/>
<text text-anchor="middle" x="1986" y="-210.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="1986" y="-195.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_3_3&#45;&gt;ffn_residual_3_3 -->
<g id="edge387" class="edge">
<title>ffn_down_3_3&#45;&gt;ffn_residual_3_3</title>
<path fill="none" stroke="black" d="M1986,-306.98C1986,-306.98 1986,-244.36 1986,-244.36"/>
<polygon fill="black" stroke="black" points="1989.5,-244.36 1986,-234.36 1982.5,-244.36 1989.5,-244.36"/>
</g>
<!-- output_3 -->
<g id="node392" class="node">
<title>output_3</title>
<polygon fill="lightcoral" stroke="black" points="2079,-107 1893,-107 1893,-69 2079,-69 2079,-107"/>
<text text-anchor="middle" x="1986" y="-91.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="1986" y="-76.8" font-family="Times,serif" font-size="14.00">Y[3]: 1024×1024×4096</text>
</g>
<!-- ffn_residual_3_3&#45;&gt;output_3 -->
<g id="edge388" class="edge">
<title>ffn_residual_3_3&#45;&gt;output_3</title>
<path fill="none" stroke="black" d="M1986,-180C1986,-180 1986,-117.12 1986,-117.12"/>
<polygon fill="black" stroke="black" points="1989.5,-117.12 1986,-107.12 1982.5,-117.12 1989.5,-117.12"/>
</g>
<!-- input_4 -->
<g id="node393" class="node">
<title>input_4</title>
<polygon fill="lightgreen" stroke="black" points="2666.5,-20458 2479.5,-20458 2479.5,-20420 2666.5,-20420 2666.5,-20458"/>
<text text-anchor="middle" x="2573" y="-20442.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="2573" y="-20427.8" font-family="Times,serif" font-size="14.00">X[4]: 1024×1024×4096</text>
</g>
<!-- qkv_proj_0_4 -->
<g id="node394" class="node">
<title>qkv_proj_0_4</title>
<polygon fill="none" stroke="black" points="2655.5,-20347 2490.5,-20347 2490.5,-20294 2655.5,-20294 2655.5,-20347"/>
<text text-anchor="middle" x="2573" y="-20331.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2573" y="-20316.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="2573" y="-20301.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- input_4&#45;&gt;qkv_proj_0_4 -->
<g id="edge389" class="edge">
<title>input_4&#45;&gt;qkv_proj_0_4</title>
<path fill="none" stroke="black" d="M2573,-20419.96C2573,-20419.96 2573,-20357.44 2573,-20357.44"/>
<polygon fill="black" stroke="black" points="2576.5,-20357.44 2573,-20347.44 2569.5,-20357.44 2576.5,-20357.44"/>
</g>
<!-- qkv_reshape_0_4 -->
<g id="node395" class="node">
<title>qkv_reshape_0_4</title>
<ellipse fill="none" stroke="black" cx="2573" cy="-20194" rx="148" ry="27"/>
<text text-anchor="middle" x="2573" y="-20197.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="2573" y="-20182.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_0_4&#45;&gt;qkv_reshape_0_4 -->
<g id="edge390" class="edge">
<title>qkv_proj_0_4&#45;&gt;qkv_reshape_0_4</title>
<path fill="none" stroke="black" d="M2573,-20293.98C2573,-20293.98 2573,-20231.36 2573,-20231.36"/>
<polygon fill="black" stroke="black" points="2576.5,-20231.36 2573,-20221.36 2569.5,-20231.36 2576.5,-20231.36"/>
</g>
<!-- qkv_reshape_0_4&#45;&gt;ring_attn_0_4_stage_0 -->
<g id="edge391" class="edge">
<title>qkv_reshape_0_4&#45;&gt;ring_attn_0_4_stage_0</title>
<path fill="none" stroke="black" d="M2573,-20166.72C2573,-20166.72 2573,-20060.16 2573,-20060.16"/>
<polygon fill="black" stroke="black" points="2576.5,-20060.16 2573,-20050.16 2569.5,-20060.16 2576.5,-20060.16"/>
</g>
<!-- ring_attn_0_4_stage_0&#45;&gt;ring_attn_0_4_stage_1 -->
<g id="edge392" class="edge">
<title>ring_attn_0_4_stage_0&#45;&gt;ring_attn_0_4_stage_1</title>
<path fill="none" stroke="black" d="M2573,-19913.87C2573,-19913.87 2573,-19807.25 2573,-19807.25"/>
<polygon fill="black" stroke="black" points="2576.5,-19807.25 2573,-19797.25 2569.5,-19807.25 2576.5,-19807.25"/>
</g>
<!-- ring_attn_0_5_stage_0 -->
<g id="node494" class="node">
<title>ring_attn_0_5_stage_0</title>
<polygon fill="yellow" stroke="black" points="3160,-20050 2951,-19982 3160,-19914 3369,-19982 3160,-20050"/>
<text text-anchor="middle" x="3160" y="-20000.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-19985.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="3160" y="-19970.8" font-family="Times,serif" font-size="14.00">Q[5]×K[5]×V[5]</text>
<text text-anchor="middle" x="3160" y="-19955.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_4_stage_0&#45;&gt;ring_attn_0_5_stage_0 -->
<g id="edge1809" class="edge">
<title>ring_attn_0_4_stage_0&#45;&gt;ring_attn_0_5_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-19982C2782.02,-19982 2940.86,-19982 2940.86,-19982"/>
<polygon fill="red" stroke="red" points="2940.86,-19985.5 2950.86,-19982 2940.86,-19978.5 2940.86,-19985.5"/>
</g>
<!-- ring_attn_0_4_stage_1&#45;&gt;ring_attn_0_4_stage_2 -->
<g id="edge393" class="edge">
<title>ring_attn_0_4_stage_1&#45;&gt;ring_attn_0_4_stage_2</title>
<path fill="none" stroke="black" d="M2573,-19660.87C2573,-19660.87 2573,-19554.25 2573,-19554.25"/>
<polygon fill="black" stroke="black" points="2576.5,-19554.25 2573,-19544.25 2569.5,-19554.25 2576.5,-19554.25"/>
</g>
<!-- ring_attn_0_5_stage_1 -->
<g id="node495" class="node">
<title>ring_attn_0_5_stage_1</title>
<polygon fill="yellow" stroke="black" points="3160,-19797 2951,-19729 3160,-19661 3369,-19729 3160,-19797"/>
<text text-anchor="middle" x="3160" y="-19747.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-19732.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="3160" y="-19717.8" font-family="Times,serif" font-size="14.00">Q[5]×K[4]×V[4]</text>
<text text-anchor="middle" x="3160" y="-19702.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_4_stage_1&#45;&gt;ring_attn_0_5_stage_1 -->
<g id="edge1810" class="edge">
<title>ring_attn_0_4_stage_1&#45;&gt;ring_attn_0_5_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-19729C2782.02,-19729 2940.86,-19729 2940.86,-19729"/>
<polygon fill="red" stroke="red" points="2940.86,-19732.5 2950.86,-19729 2940.86,-19725.5 2940.86,-19732.5"/>
</g>
<!-- ring_attn_0_4_stage_2&#45;&gt;ring_attn_0_4_stage_3 -->
<g id="edge394" class="edge">
<title>ring_attn_0_4_stage_2&#45;&gt;ring_attn_0_4_stage_3</title>
<path fill="none" stroke="black" d="M2573,-19407.87C2573,-19407.87 2573,-19301.25 2573,-19301.25"/>
<polygon fill="black" stroke="black" points="2576.5,-19301.25 2573,-19291.25 2569.5,-19301.25 2576.5,-19301.25"/>
</g>
<!-- ring_attn_0_5_stage_2 -->
<g id="node496" class="node">
<title>ring_attn_0_5_stage_2</title>
<polygon fill="yellow" stroke="black" points="3160,-19544 2951,-19476 3160,-19408 3369,-19476 3160,-19544"/>
<text text-anchor="middle" x="3160" y="-19494.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-19479.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="3160" y="-19464.8" font-family="Times,serif" font-size="14.00">Q[5]×K[3]×V[3]</text>
<text text-anchor="middle" x="3160" y="-19449.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_4_stage_2&#45;&gt;ring_attn_0_5_stage_2 -->
<g id="edge1811" class="edge">
<title>ring_attn_0_4_stage_2&#45;&gt;ring_attn_0_5_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-19476C2782.02,-19476 2940.86,-19476 2940.86,-19476"/>
<polygon fill="red" stroke="red" points="2940.86,-19479.5 2950.86,-19476 2940.86,-19472.5 2940.86,-19479.5"/>
</g>
<!-- ring_attn_0_4_stage_3&#45;&gt;ring_attn_0_4_stage_4 -->
<g id="edge395" class="edge">
<title>ring_attn_0_4_stage_3&#45;&gt;ring_attn_0_4_stage_4</title>
<path fill="none" stroke="black" d="M2573,-19154.87C2573,-19154.87 2573,-19048.25 2573,-19048.25"/>
<polygon fill="black" stroke="black" points="2576.5,-19048.25 2573,-19038.25 2569.5,-19048.25 2576.5,-19048.25"/>
</g>
<!-- ring_attn_0_5_stage_3 -->
<g id="node497" class="node">
<title>ring_attn_0_5_stage_3</title>
<polygon fill="yellow" stroke="black" points="3160,-19291 2951,-19223 3160,-19155 3369,-19223 3160,-19291"/>
<text text-anchor="middle" x="3160" y="-19241.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-19226.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="3160" y="-19211.8" font-family="Times,serif" font-size="14.00">Q[5]×K[2]×V[2]</text>
<text text-anchor="middle" x="3160" y="-19196.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_4_stage_3&#45;&gt;ring_attn_0_5_stage_3 -->
<g id="edge1812" class="edge">
<title>ring_attn_0_4_stage_3&#45;&gt;ring_attn_0_5_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-19223C2782.02,-19223 2940.86,-19223 2940.86,-19223"/>
<polygon fill="red" stroke="red" points="2940.86,-19226.5 2950.86,-19223 2940.86,-19219.5 2940.86,-19226.5"/>
</g>
<!-- ring_attn_0_4_stage_4&#45;&gt;ring_attn_0_4_stage_5 -->
<g id="edge396" class="edge">
<title>ring_attn_0_4_stage_4&#45;&gt;ring_attn_0_4_stage_5</title>
<path fill="none" stroke="black" d="M2573,-18901.87C2573,-18901.87 2573,-18795.25 2573,-18795.25"/>
<polygon fill="black" stroke="black" points="2576.5,-18795.25 2573,-18785.25 2569.5,-18795.25 2576.5,-18795.25"/>
</g>
<!-- ring_attn_0_5_stage_4 -->
<g id="node498" class="node">
<title>ring_attn_0_5_stage_4</title>
<polygon fill="yellow" stroke="black" points="3160,-19038 2951,-18970 3160,-18902 3369,-18970 3160,-19038"/>
<text text-anchor="middle" x="3160" y="-18988.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-18973.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="3160" y="-18958.8" font-family="Times,serif" font-size="14.00">Q[5]×K[1]×V[1]</text>
<text text-anchor="middle" x="3160" y="-18943.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_4_stage_4&#45;&gt;ring_attn_0_5_stage_4 -->
<g id="edge1813" class="edge">
<title>ring_attn_0_4_stage_4&#45;&gt;ring_attn_0_5_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-18970C2782.02,-18970 2940.86,-18970 2940.86,-18970"/>
<polygon fill="red" stroke="red" points="2940.86,-18973.5 2950.86,-18970 2940.86,-18966.5 2940.86,-18973.5"/>
</g>
<!-- ring_attn_0_4_stage_5&#45;&gt;ring_attn_0_4_stage_6 -->
<g id="edge397" class="edge">
<title>ring_attn_0_4_stage_5&#45;&gt;ring_attn_0_4_stage_6</title>
<path fill="none" stroke="black" d="M2573,-18648.87C2573,-18648.87 2573,-18542.25 2573,-18542.25"/>
<polygon fill="black" stroke="black" points="2576.5,-18542.25 2573,-18532.25 2569.5,-18542.25 2576.5,-18542.25"/>
</g>
<!-- ring_attn_0_5_stage_5 -->
<g id="node499" class="node">
<title>ring_attn_0_5_stage_5</title>
<polygon fill="yellow" stroke="black" points="3160,-18785 2951,-18717 3160,-18649 3369,-18717 3160,-18785"/>
<text text-anchor="middle" x="3160" y="-18735.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-18720.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="3160" y="-18705.8" font-family="Times,serif" font-size="14.00">Q[5]×K[0]×V[0]</text>
<text text-anchor="middle" x="3160" y="-18690.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_4_stage_5&#45;&gt;ring_attn_0_5_stage_5 -->
<g id="edge1814" class="edge">
<title>ring_attn_0_4_stage_5&#45;&gt;ring_attn_0_5_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-18717C2782.02,-18717 2940.86,-18717 2940.86,-18717"/>
<polygon fill="red" stroke="red" points="2940.86,-18720.5 2950.86,-18717 2940.86,-18713.5 2940.86,-18720.5"/>
</g>
<!-- ring_attn_0_4_stage_6&#45;&gt;ring_attn_0_4_stage_7 -->
<g id="edge398" class="edge">
<title>ring_attn_0_4_stage_6&#45;&gt;ring_attn_0_4_stage_7</title>
<path fill="none" stroke="black" d="M2573,-18395.87C2573,-18395.87 2573,-18289.25 2573,-18289.25"/>
<polygon fill="black" stroke="black" points="2576.5,-18289.25 2573,-18279.25 2569.5,-18289.25 2576.5,-18289.25"/>
</g>
<!-- ring_attn_0_5_stage_6 -->
<g id="node500" class="node">
<title>ring_attn_0_5_stage_6</title>
<polygon fill="yellow" stroke="black" points="3160,-18532 2951,-18464 3160,-18396 3369,-18464 3160,-18532"/>
<text text-anchor="middle" x="3160" y="-18482.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-18467.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="3160" y="-18452.8" font-family="Times,serif" font-size="14.00">Q[5]×K[15]×V[15]</text>
<text text-anchor="middle" x="3160" y="-18437.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_4_stage_6&#45;&gt;ring_attn_0_5_stage_6 -->
<g id="edge1815" class="edge">
<title>ring_attn_0_4_stage_6&#45;&gt;ring_attn_0_5_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-18464C2782.02,-18464 2940.86,-18464 2940.86,-18464"/>
<polygon fill="red" stroke="red" points="2940.86,-18467.5 2950.86,-18464 2940.86,-18460.5 2940.86,-18467.5"/>
</g>
<!-- ring_attn_0_4_stage_7&#45;&gt;ring_attn_0_4_stage_8 -->
<g id="edge399" class="edge">
<title>ring_attn_0_4_stage_7&#45;&gt;ring_attn_0_4_stage_8</title>
<path fill="none" stroke="black" d="M2573,-18142.87C2573,-18142.87 2573,-18036.25 2573,-18036.25"/>
<polygon fill="black" stroke="black" points="2576.5,-18036.25 2573,-18026.25 2569.5,-18036.25 2576.5,-18036.25"/>
</g>
<!-- ring_attn_0_5_stage_7 -->
<g id="node501" class="node">
<title>ring_attn_0_5_stage_7</title>
<polygon fill="yellow" stroke="black" points="3160,-18279 2951,-18211 3160,-18143 3369,-18211 3160,-18279"/>
<text text-anchor="middle" x="3160" y="-18229.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-18214.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="3160" y="-18199.8" font-family="Times,serif" font-size="14.00">Q[5]×K[14]×V[14]</text>
<text text-anchor="middle" x="3160" y="-18184.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_4_stage_7&#45;&gt;ring_attn_0_5_stage_7 -->
<g id="edge1816" class="edge">
<title>ring_attn_0_4_stage_7&#45;&gt;ring_attn_0_5_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-18211C2782.02,-18211 2940.86,-18211 2940.86,-18211"/>
<polygon fill="red" stroke="red" points="2940.86,-18214.5 2950.86,-18211 2940.86,-18207.5 2940.86,-18214.5"/>
</g>
<!-- ring_attn_0_4_stage_8&#45;&gt;ring_attn_0_4_stage_9 -->
<g id="edge400" class="edge">
<title>ring_attn_0_4_stage_8&#45;&gt;ring_attn_0_4_stage_9</title>
<path fill="none" stroke="black" d="M2573,-17889.87C2573,-17889.87 2573,-17783.25 2573,-17783.25"/>
<polygon fill="black" stroke="black" points="2576.5,-17783.25 2573,-17773.25 2569.5,-17783.25 2576.5,-17783.25"/>
</g>
<!-- ring_attn_0_5_stage_8 -->
<g id="node502" class="node">
<title>ring_attn_0_5_stage_8</title>
<polygon fill="yellow" stroke="black" points="3160,-18026 2951,-17958 3160,-17890 3369,-17958 3160,-18026"/>
<text text-anchor="middle" x="3160" y="-17976.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-17961.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="3160" y="-17946.8" font-family="Times,serif" font-size="14.00">Q[5]×K[13]×V[13]</text>
<text text-anchor="middle" x="3160" y="-17931.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_4_stage_8&#45;&gt;ring_attn_0_5_stage_8 -->
<g id="edge1817" class="edge">
<title>ring_attn_0_4_stage_8&#45;&gt;ring_attn_0_5_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-17958C2782.02,-17958 2940.86,-17958 2940.86,-17958"/>
<polygon fill="red" stroke="red" points="2940.86,-17961.5 2950.86,-17958 2940.86,-17954.5 2940.86,-17961.5"/>
</g>
<!-- ring_attn_0_4_stage_9&#45;&gt;ring_attn_0_4_stage_10 -->
<g id="edge401" class="edge">
<title>ring_attn_0_4_stage_9&#45;&gt;ring_attn_0_4_stage_10</title>
<path fill="none" stroke="black" d="M2573,-17636.87C2573,-17636.87 2573,-17530.25 2573,-17530.25"/>
<polygon fill="black" stroke="black" points="2576.5,-17530.25 2573,-17520.25 2569.5,-17530.25 2576.5,-17530.25"/>
</g>
<!-- ring_attn_0_5_stage_9 -->
<g id="node503" class="node">
<title>ring_attn_0_5_stage_9</title>
<polygon fill="yellow" stroke="black" points="3160,-17773 2951,-17705 3160,-17637 3369,-17705 3160,-17773"/>
<text text-anchor="middle" x="3160" y="-17723.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-17708.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="3160" y="-17693.8" font-family="Times,serif" font-size="14.00">Q[5]×K[12]×V[12]</text>
<text text-anchor="middle" x="3160" y="-17678.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_4_stage_9&#45;&gt;ring_attn_0_5_stage_9 -->
<g id="edge1818" class="edge">
<title>ring_attn_0_4_stage_9&#45;&gt;ring_attn_0_5_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-17705C2782.02,-17705 2940.86,-17705 2940.86,-17705"/>
<polygon fill="red" stroke="red" points="2940.86,-17708.5 2950.86,-17705 2940.86,-17701.5 2940.86,-17708.5"/>
</g>
<!-- ring_attn_0_4_stage_10&#45;&gt;ring_attn_0_4_stage_11 -->
<g id="edge402" class="edge">
<title>ring_attn_0_4_stage_10&#45;&gt;ring_attn_0_4_stage_11</title>
<path fill="none" stroke="black" d="M2573,-17383.87C2573,-17383.87 2573,-17277.25 2573,-17277.25"/>
<polygon fill="black" stroke="black" points="2576.5,-17277.25 2573,-17267.25 2569.5,-17277.25 2576.5,-17277.25"/>
</g>
<!-- ring_attn_0_5_stage_10 -->
<g id="node504" class="node">
<title>ring_attn_0_5_stage_10</title>
<polygon fill="yellow" stroke="black" points="3160,-17520 2951,-17452 3160,-17384 3369,-17452 3160,-17520"/>
<text text-anchor="middle" x="3160" y="-17470.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-17455.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="3160" y="-17440.8" font-family="Times,serif" font-size="14.00">Q[5]×K[11]×V[11]</text>
<text text-anchor="middle" x="3160" y="-17425.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_4_stage_10&#45;&gt;ring_attn_0_5_stage_10 -->
<g id="edge1819" class="edge">
<title>ring_attn_0_4_stage_10&#45;&gt;ring_attn_0_5_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-17452C2782.02,-17452 2940.86,-17452 2940.86,-17452"/>
<polygon fill="red" stroke="red" points="2940.86,-17455.5 2950.86,-17452 2940.86,-17448.5 2940.86,-17455.5"/>
</g>
<!-- ring_attn_0_4_stage_11&#45;&gt;ring_attn_0_4_stage_12 -->
<g id="edge403" class="edge">
<title>ring_attn_0_4_stage_11&#45;&gt;ring_attn_0_4_stage_12</title>
<path fill="none" stroke="black" d="M2573,-17130.87C2573,-17130.87 2573,-17024.25 2573,-17024.25"/>
<polygon fill="black" stroke="black" points="2576.5,-17024.25 2573,-17014.25 2569.5,-17024.25 2576.5,-17024.25"/>
</g>
<!-- ring_attn_0_5_stage_11 -->
<g id="node505" class="node">
<title>ring_attn_0_5_stage_11</title>
<polygon fill="yellow" stroke="black" points="3160,-17267 2951,-17199 3160,-17131 3369,-17199 3160,-17267"/>
<text text-anchor="middle" x="3160" y="-17217.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-17202.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="3160" y="-17187.8" font-family="Times,serif" font-size="14.00">Q[5]×K[10]×V[10]</text>
<text text-anchor="middle" x="3160" y="-17172.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_4_stage_11&#45;&gt;ring_attn_0_5_stage_11 -->
<g id="edge1820" class="edge">
<title>ring_attn_0_4_stage_11&#45;&gt;ring_attn_0_5_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-17199C2782.02,-17199 2940.86,-17199 2940.86,-17199"/>
<polygon fill="red" stroke="red" points="2940.86,-17202.5 2950.86,-17199 2940.86,-17195.5 2940.86,-17202.5"/>
</g>
<!-- ring_attn_0_4_stage_12&#45;&gt;ring_attn_0_4_stage_13 -->
<g id="edge404" class="edge">
<title>ring_attn_0_4_stage_12&#45;&gt;ring_attn_0_4_stage_13</title>
<path fill="none" stroke="black" d="M2573,-16877.87C2573,-16877.87 2573,-16771.25 2573,-16771.25"/>
<polygon fill="black" stroke="black" points="2576.5,-16771.25 2573,-16761.25 2569.5,-16771.25 2576.5,-16771.25"/>
</g>
<!-- ring_attn_0_5_stage_12 -->
<g id="node506" class="node">
<title>ring_attn_0_5_stage_12</title>
<polygon fill="yellow" stroke="black" points="3160,-17014 2951,-16946 3160,-16878 3369,-16946 3160,-17014"/>
<text text-anchor="middle" x="3160" y="-16964.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-16949.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="3160" y="-16934.8" font-family="Times,serif" font-size="14.00">Q[5]×K[9]×V[9]</text>
<text text-anchor="middle" x="3160" y="-16919.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_4_stage_12&#45;&gt;ring_attn_0_5_stage_12 -->
<g id="edge1821" class="edge">
<title>ring_attn_0_4_stage_12&#45;&gt;ring_attn_0_5_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-16946C2782.02,-16946 2940.86,-16946 2940.86,-16946"/>
<polygon fill="red" stroke="red" points="2940.86,-16949.5 2950.86,-16946 2940.86,-16942.5 2940.86,-16949.5"/>
</g>
<!-- ring_attn_0_4_stage_13&#45;&gt;ring_attn_0_4_stage_14 -->
<g id="edge405" class="edge">
<title>ring_attn_0_4_stage_13&#45;&gt;ring_attn_0_4_stage_14</title>
<path fill="none" stroke="black" d="M2573,-16624.87C2573,-16624.87 2573,-16518.25 2573,-16518.25"/>
<polygon fill="black" stroke="black" points="2576.5,-16518.25 2573,-16508.25 2569.5,-16518.25 2576.5,-16518.25"/>
</g>
<!-- ring_attn_0_5_stage_13 -->
<g id="node507" class="node">
<title>ring_attn_0_5_stage_13</title>
<polygon fill="yellow" stroke="black" points="3160,-16761 2951,-16693 3160,-16625 3369,-16693 3160,-16761"/>
<text text-anchor="middle" x="3160" y="-16711.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-16696.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="3160" y="-16681.8" font-family="Times,serif" font-size="14.00">Q[5]×K[8]×V[8]</text>
<text text-anchor="middle" x="3160" y="-16666.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_4_stage_13&#45;&gt;ring_attn_0_5_stage_13 -->
<g id="edge1822" class="edge">
<title>ring_attn_0_4_stage_13&#45;&gt;ring_attn_0_5_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-16693C2782.02,-16693 2940.86,-16693 2940.86,-16693"/>
<polygon fill="red" stroke="red" points="2940.86,-16696.5 2950.86,-16693 2940.86,-16689.5 2940.86,-16696.5"/>
</g>
<!-- ring_attn_0_4_stage_14&#45;&gt;ring_attn_0_4_stage_15 -->
<g id="edge406" class="edge">
<title>ring_attn_0_4_stage_14&#45;&gt;ring_attn_0_4_stage_15</title>
<path fill="none" stroke="black" d="M2573,-16371.87C2573,-16371.87 2573,-16265.25 2573,-16265.25"/>
<polygon fill="black" stroke="black" points="2576.5,-16265.25 2573,-16255.25 2569.5,-16265.25 2576.5,-16265.25"/>
</g>
<!-- ring_attn_0_5_stage_14 -->
<g id="node508" class="node">
<title>ring_attn_0_5_stage_14</title>
<polygon fill="yellow" stroke="black" points="3160,-16508 2951,-16440 3160,-16372 3369,-16440 3160,-16508"/>
<text text-anchor="middle" x="3160" y="-16458.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-16443.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="3160" y="-16428.8" font-family="Times,serif" font-size="14.00">Q[5]×K[7]×V[7]</text>
<text text-anchor="middle" x="3160" y="-16413.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_4_stage_14&#45;&gt;ring_attn_0_5_stage_14 -->
<g id="edge1823" class="edge">
<title>ring_attn_0_4_stage_14&#45;&gt;ring_attn_0_5_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-16440C2782.02,-16440 2940.86,-16440 2940.86,-16440"/>
<polygon fill="red" stroke="red" points="2940.86,-16443.5 2950.86,-16440 2940.86,-16436.5 2940.86,-16443.5"/>
</g>
<!-- attn_out_0_4 -->
<g id="node412" class="node">
<title>attn_out_0_4</title>
<polygon fill="none" stroke="black" points="2642.5,-16046 2503.5,-16046 2503.5,-15993 2642.5,-15993 2642.5,-16046"/>
<text text-anchor="middle" x="2573" y="-16030.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2573" y="-16015.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="2573" y="-16000.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_0_4_stage_15&#45;&gt;attn_out_0_4 -->
<g id="edge407" class="edge">
<title>ring_attn_0_4_stage_15&#45;&gt;attn_out_0_4</title>
<path fill="none" stroke="black" d="M2573,-16118.87C2573,-16118.87 2573,-16056.18 2573,-16056.18"/>
<polygon fill="black" stroke="black" points="2576.5,-16056.18 2573,-16046.18 2569.5,-16056.18 2576.5,-16056.18"/>
</g>
<!-- ring_attn_0_5_stage_15 -->
<g id="node509" class="node">
<title>ring_attn_0_5_stage_15</title>
<polygon fill="yellow" stroke="black" points="3160,-16255 2951,-16187 3160,-16119 3369,-16187 3160,-16255"/>
<text text-anchor="middle" x="3160" y="-16205.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-16190.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="3160" y="-16175.8" font-family="Times,serif" font-size="14.00">Q[5]×K[6]×V[6]</text>
<text text-anchor="middle" x="3160" y="-16160.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_4_stage_15&#45;&gt;ring_attn_0_5_stage_15 -->
<g id="edge1824" class="edge">
<title>ring_attn_0_4_stage_15&#45;&gt;ring_attn_0_5_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-16187C2782.02,-16187 2940.86,-16187 2940.86,-16187"/>
<polygon fill="red" stroke="red" points="2940.86,-16190.5 2950.86,-16187 2940.86,-16183.5 2940.86,-16190.5"/>
</g>
<!-- attn_residual_0_4 -->
<g id="node413" class="node">
<title>attn_residual_0_4</title>
<ellipse fill="none" stroke="black" cx="2573" cy="-15893" rx="105.5" ry="27"/>
<text text-anchor="middle" x="2573" y="-15896.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="2573" y="-15881.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_0_4&#45;&gt;attn_residual_0_4 -->
<g id="edge408" class="edge">
<title>attn_out_0_4&#45;&gt;attn_residual_0_4</title>
<path fill="none" stroke="black" d="M2573,-15992.98C2573,-15992.98 2573,-15930.36 2573,-15930.36"/>
<polygon fill="black" stroke="black" points="2576.5,-15930.36 2573,-15920.36 2569.5,-15930.36 2576.5,-15930.36"/>
</g>
<!-- ffn_up_0_4 -->
<g id="node414" class="node">
<title>ffn_up_0_4</title>
<polygon fill="none" stroke="black" points="2652,-15793 2494,-15793 2494,-15740 2652,-15740 2652,-15793"/>
<text text-anchor="middle" x="2573" y="-15777.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2573" y="-15762.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="2573" y="-15747.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_0_4&#45;&gt;ffn_up_0_4 -->
<g id="edge409" class="edge">
<title>attn_residual_0_4&#45;&gt;ffn_up_0_4</title>
<path fill="none" stroke="black" d="M2573,-15865.86C2573,-15865.86 2573,-15803.16 2573,-15803.16"/>
<polygon fill="black" stroke="black" points="2576.5,-15803.16 2573,-15793.16 2569.5,-15803.16 2576.5,-15803.16"/>
</g>
<!-- ffn_gelu_0_4 -->
<g id="node415" class="node">
<title>ffn_gelu_0_4</title>
<ellipse fill="none" stroke="black" cx="2573" cy="-15640" rx="105.5" ry="27"/>
<text text-anchor="middle" x="2573" y="-15643.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2573" y="-15628.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_0_4&#45;&gt;ffn_gelu_0_4 -->
<g id="edge410" class="edge">
<title>ffn_up_0_4&#45;&gt;ffn_gelu_0_4</title>
<path fill="none" stroke="black" d="M2573,-15739.98C2573,-15739.98 2573,-15677.36 2573,-15677.36"/>
<polygon fill="black" stroke="black" points="2576.5,-15677.36 2573,-15667.36 2569.5,-15677.36 2576.5,-15677.36"/>
</g>
<!-- ffn_down_0_4 -->
<g id="node416" class="node">
<title>ffn_down_0_4</title>
<polygon fill="none" stroke="black" points="2662,-15540 2484,-15540 2484,-15487 2662,-15487 2662,-15540"/>
<text text-anchor="middle" x="2573" y="-15524.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2573" y="-15509.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="2573" y="-15494.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_0_4&#45;&gt;ffn_down_0_4 -->
<g id="edge411" class="edge">
<title>ffn_gelu_0_4&#45;&gt;ffn_down_0_4</title>
<path fill="none" stroke="black" d="M2573,-15612.86C2573,-15612.86 2573,-15550.16 2573,-15550.16"/>
<polygon fill="black" stroke="black" points="2576.5,-15550.16 2573,-15540.16 2569.5,-15550.16 2576.5,-15550.16"/>
</g>
<!-- ffn_residual_0_4 -->
<g id="node417" class="node">
<title>ffn_residual_0_4</title>
<ellipse fill="none" stroke="black" cx="2573" cy="-15387" rx="105.5" ry="27"/>
<text text-anchor="middle" x="2573" y="-15390.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="2573" y="-15375.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_0_4&#45;&gt;ffn_residual_0_4 -->
<g id="edge412" class="edge">
<title>ffn_down_0_4&#45;&gt;ffn_residual_0_4</title>
<path fill="none" stroke="black" d="M2573,-15486.98C2573,-15486.98 2573,-15424.36 2573,-15424.36"/>
<polygon fill="black" stroke="black" points="2576.5,-15424.36 2573,-15414.36 2569.5,-15424.36 2576.5,-15424.36"/>
</g>
<!-- qkv_proj_1_4 -->
<g id="node418" class="node">
<title>qkv_proj_1_4</title>
<polygon fill="none" stroke="black" points="2655.5,-15287 2490.5,-15287 2490.5,-15234 2655.5,-15234 2655.5,-15287"/>
<text text-anchor="middle" x="2573" y="-15271.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2573" y="-15256.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="2573" y="-15241.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_0_4&#45;&gt;qkv_proj_1_4 -->
<g id="edge413" class="edge">
<title>ffn_residual_0_4&#45;&gt;qkv_proj_1_4</title>
<path fill="none" stroke="black" d="M2573,-15359.86C2573,-15359.86 2573,-15297.16 2573,-15297.16"/>
<polygon fill="black" stroke="black" points="2576.5,-15297.16 2573,-15287.16 2569.5,-15297.16 2576.5,-15297.16"/>
</g>
<!-- qkv_reshape_1_4 -->
<g id="node419" class="node">
<title>qkv_reshape_1_4</title>
<ellipse fill="none" stroke="black" cx="2573" cy="-15134" rx="148" ry="27"/>
<text text-anchor="middle" x="2573" y="-15137.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="2573" y="-15122.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_1_4&#45;&gt;qkv_reshape_1_4 -->
<g id="edge414" class="edge">
<title>qkv_proj_1_4&#45;&gt;qkv_reshape_1_4</title>
<path fill="none" stroke="black" d="M2573,-15233.98C2573,-15233.98 2573,-15171.36 2573,-15171.36"/>
<polygon fill="black" stroke="black" points="2576.5,-15171.36 2573,-15161.36 2569.5,-15171.36 2576.5,-15171.36"/>
</g>
<!-- qkv_reshape_1_4&#45;&gt;ring_attn_1_4_stage_0 -->
<g id="edge415" class="edge">
<title>qkv_reshape_1_4&#45;&gt;ring_attn_1_4_stage_0</title>
<path fill="none" stroke="black" d="M2573,-15106.72C2573,-15106.72 2573,-15000.16 2573,-15000.16"/>
<polygon fill="black" stroke="black" points="2576.5,-15000.16 2573,-14990.16 2569.5,-15000.16 2576.5,-15000.16"/>
</g>
<!-- ring_attn_1_4_stage_0&#45;&gt;ring_attn_1_4_stage_1 -->
<g id="edge416" class="edge">
<title>ring_attn_1_4_stage_0&#45;&gt;ring_attn_1_4_stage_1</title>
<path fill="none" stroke="black" d="M2573,-14853.87C2573,-14853.87 2573,-14747.25 2573,-14747.25"/>
<polygon fill="black" stroke="black" points="2576.5,-14747.25 2573,-14737.25 2569.5,-14747.25 2576.5,-14747.25"/>
</g>
<!-- ring_attn_1_5_stage_0 -->
<g id="node518" class="node">
<title>ring_attn_1_5_stage_0</title>
<polygon fill="yellow" stroke="black" points="3160,-14990 2951,-14922 3160,-14854 3369,-14922 3160,-14990"/>
<text text-anchor="middle" x="3160" y="-14940.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-14925.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="3160" y="-14910.8" font-family="Times,serif" font-size="14.00">Q[5]×K[5]×V[5]</text>
<text text-anchor="middle" x="3160" y="-14895.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_4_stage_0&#45;&gt;ring_attn_1_5_stage_0 -->
<g id="edge1825" class="edge">
<title>ring_attn_1_4_stage_0&#45;&gt;ring_attn_1_5_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-14922C2782.02,-14922 2940.86,-14922 2940.86,-14922"/>
<polygon fill="red" stroke="red" points="2940.86,-14925.5 2950.86,-14922 2940.86,-14918.5 2940.86,-14925.5"/>
</g>
<!-- ring_attn_1_4_stage_1&#45;&gt;ring_attn_1_4_stage_2 -->
<g id="edge417" class="edge">
<title>ring_attn_1_4_stage_1&#45;&gt;ring_attn_1_4_stage_2</title>
<path fill="none" stroke="black" d="M2573,-14600.87C2573,-14600.87 2573,-14494.25 2573,-14494.25"/>
<polygon fill="black" stroke="black" points="2576.5,-14494.25 2573,-14484.25 2569.5,-14494.25 2576.5,-14494.25"/>
</g>
<!-- ring_attn_1_5_stage_1 -->
<g id="node519" class="node">
<title>ring_attn_1_5_stage_1</title>
<polygon fill="yellow" stroke="black" points="3160,-14737 2951,-14669 3160,-14601 3369,-14669 3160,-14737"/>
<text text-anchor="middle" x="3160" y="-14687.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-14672.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="3160" y="-14657.8" font-family="Times,serif" font-size="14.00">Q[5]×K[4]×V[4]</text>
<text text-anchor="middle" x="3160" y="-14642.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_4_stage_1&#45;&gt;ring_attn_1_5_stage_1 -->
<g id="edge1826" class="edge">
<title>ring_attn_1_4_stage_1&#45;&gt;ring_attn_1_5_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-14669C2782.02,-14669 2940.86,-14669 2940.86,-14669"/>
<polygon fill="red" stroke="red" points="2940.86,-14672.5 2950.86,-14669 2940.86,-14665.5 2940.86,-14672.5"/>
</g>
<!-- ring_attn_1_4_stage_2&#45;&gt;ring_attn_1_4_stage_3 -->
<g id="edge418" class="edge">
<title>ring_attn_1_4_stage_2&#45;&gt;ring_attn_1_4_stage_3</title>
<path fill="none" stroke="black" d="M2573,-14347.87C2573,-14347.87 2573,-14241.25 2573,-14241.25"/>
<polygon fill="black" stroke="black" points="2576.5,-14241.25 2573,-14231.25 2569.5,-14241.25 2576.5,-14241.25"/>
</g>
<!-- ring_attn_1_5_stage_2 -->
<g id="node520" class="node">
<title>ring_attn_1_5_stage_2</title>
<polygon fill="yellow" stroke="black" points="3160,-14484 2951,-14416 3160,-14348 3369,-14416 3160,-14484"/>
<text text-anchor="middle" x="3160" y="-14434.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-14419.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="3160" y="-14404.8" font-family="Times,serif" font-size="14.00">Q[5]×K[3]×V[3]</text>
<text text-anchor="middle" x="3160" y="-14389.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_4_stage_2&#45;&gt;ring_attn_1_5_stage_2 -->
<g id="edge1827" class="edge">
<title>ring_attn_1_4_stage_2&#45;&gt;ring_attn_1_5_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-14416C2782.02,-14416 2940.86,-14416 2940.86,-14416"/>
<polygon fill="red" stroke="red" points="2940.86,-14419.5 2950.86,-14416 2940.86,-14412.5 2940.86,-14419.5"/>
</g>
<!-- ring_attn_1_4_stage_3&#45;&gt;ring_attn_1_4_stage_4 -->
<g id="edge419" class="edge">
<title>ring_attn_1_4_stage_3&#45;&gt;ring_attn_1_4_stage_4</title>
<path fill="none" stroke="black" d="M2573,-14094.87C2573,-14094.87 2573,-13988.25 2573,-13988.25"/>
<polygon fill="black" stroke="black" points="2576.5,-13988.25 2573,-13978.25 2569.5,-13988.25 2576.5,-13988.25"/>
</g>
<!-- ring_attn_1_5_stage_3 -->
<g id="node521" class="node">
<title>ring_attn_1_5_stage_3</title>
<polygon fill="yellow" stroke="black" points="3160,-14231 2951,-14163 3160,-14095 3369,-14163 3160,-14231"/>
<text text-anchor="middle" x="3160" y="-14181.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-14166.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="3160" y="-14151.8" font-family="Times,serif" font-size="14.00">Q[5]×K[2]×V[2]</text>
<text text-anchor="middle" x="3160" y="-14136.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_4_stage_3&#45;&gt;ring_attn_1_5_stage_3 -->
<g id="edge1828" class="edge">
<title>ring_attn_1_4_stage_3&#45;&gt;ring_attn_1_5_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-14163C2782.02,-14163 2940.86,-14163 2940.86,-14163"/>
<polygon fill="red" stroke="red" points="2940.86,-14166.5 2950.86,-14163 2940.86,-14159.5 2940.86,-14166.5"/>
</g>
<!-- ring_attn_1_4_stage_4&#45;&gt;ring_attn_1_4_stage_5 -->
<g id="edge420" class="edge">
<title>ring_attn_1_4_stage_4&#45;&gt;ring_attn_1_4_stage_5</title>
<path fill="none" stroke="black" d="M2573,-13841.87C2573,-13841.87 2573,-13735.25 2573,-13735.25"/>
<polygon fill="black" stroke="black" points="2576.5,-13735.25 2573,-13725.25 2569.5,-13735.25 2576.5,-13735.25"/>
</g>
<!-- ring_attn_1_5_stage_4 -->
<g id="node522" class="node">
<title>ring_attn_1_5_stage_4</title>
<polygon fill="yellow" stroke="black" points="3160,-13978 2951,-13910 3160,-13842 3369,-13910 3160,-13978"/>
<text text-anchor="middle" x="3160" y="-13928.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-13913.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="3160" y="-13898.8" font-family="Times,serif" font-size="14.00">Q[5]×K[1]×V[1]</text>
<text text-anchor="middle" x="3160" y="-13883.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_4_stage_4&#45;&gt;ring_attn_1_5_stage_4 -->
<g id="edge1829" class="edge">
<title>ring_attn_1_4_stage_4&#45;&gt;ring_attn_1_5_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-13910C2782.02,-13910 2940.86,-13910 2940.86,-13910"/>
<polygon fill="red" stroke="red" points="2940.86,-13913.5 2950.86,-13910 2940.86,-13906.5 2940.86,-13913.5"/>
</g>
<!-- ring_attn_1_4_stage_5&#45;&gt;ring_attn_1_4_stage_6 -->
<g id="edge421" class="edge">
<title>ring_attn_1_4_stage_5&#45;&gt;ring_attn_1_4_stage_6</title>
<path fill="none" stroke="black" d="M2573,-13588.87C2573,-13588.87 2573,-13482.25 2573,-13482.25"/>
<polygon fill="black" stroke="black" points="2576.5,-13482.25 2573,-13472.25 2569.5,-13482.25 2576.5,-13482.25"/>
</g>
<!-- ring_attn_1_5_stage_5 -->
<g id="node523" class="node">
<title>ring_attn_1_5_stage_5</title>
<polygon fill="yellow" stroke="black" points="3160,-13725 2951,-13657 3160,-13589 3369,-13657 3160,-13725"/>
<text text-anchor="middle" x="3160" y="-13675.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-13660.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="3160" y="-13645.8" font-family="Times,serif" font-size="14.00">Q[5]×K[0]×V[0]</text>
<text text-anchor="middle" x="3160" y="-13630.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_4_stage_5&#45;&gt;ring_attn_1_5_stage_5 -->
<g id="edge1830" class="edge">
<title>ring_attn_1_4_stage_5&#45;&gt;ring_attn_1_5_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-13657C2782.02,-13657 2940.86,-13657 2940.86,-13657"/>
<polygon fill="red" stroke="red" points="2940.86,-13660.5 2950.86,-13657 2940.86,-13653.5 2940.86,-13660.5"/>
</g>
<!-- ring_attn_1_4_stage_6&#45;&gt;ring_attn_1_4_stage_7 -->
<g id="edge422" class="edge">
<title>ring_attn_1_4_stage_6&#45;&gt;ring_attn_1_4_stage_7</title>
<path fill="none" stroke="black" d="M2573,-13335.87C2573,-13335.87 2573,-13229.25 2573,-13229.25"/>
<polygon fill="black" stroke="black" points="2576.5,-13229.25 2573,-13219.25 2569.5,-13229.25 2576.5,-13229.25"/>
</g>
<!-- ring_attn_1_5_stage_6 -->
<g id="node524" class="node">
<title>ring_attn_1_5_stage_6</title>
<polygon fill="yellow" stroke="black" points="3160,-13472 2951,-13404 3160,-13336 3369,-13404 3160,-13472"/>
<text text-anchor="middle" x="3160" y="-13422.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-13407.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="3160" y="-13392.8" font-family="Times,serif" font-size="14.00">Q[5]×K[15]×V[15]</text>
<text text-anchor="middle" x="3160" y="-13377.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_4_stage_6&#45;&gt;ring_attn_1_5_stage_6 -->
<g id="edge1831" class="edge">
<title>ring_attn_1_4_stage_6&#45;&gt;ring_attn_1_5_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-13404C2782.02,-13404 2940.86,-13404 2940.86,-13404"/>
<polygon fill="red" stroke="red" points="2940.86,-13407.5 2950.86,-13404 2940.86,-13400.5 2940.86,-13407.5"/>
</g>
<!-- ring_attn_1_4_stage_7&#45;&gt;ring_attn_1_4_stage_8 -->
<g id="edge423" class="edge">
<title>ring_attn_1_4_stage_7&#45;&gt;ring_attn_1_4_stage_8</title>
<path fill="none" stroke="black" d="M2573,-13082.87C2573,-13082.87 2573,-12976.25 2573,-12976.25"/>
<polygon fill="black" stroke="black" points="2576.5,-12976.25 2573,-12966.25 2569.5,-12976.25 2576.5,-12976.25"/>
</g>
<!-- ring_attn_1_5_stage_7 -->
<g id="node525" class="node">
<title>ring_attn_1_5_stage_7</title>
<polygon fill="yellow" stroke="black" points="3160,-13219 2951,-13151 3160,-13083 3369,-13151 3160,-13219"/>
<text text-anchor="middle" x="3160" y="-13169.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-13154.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="3160" y="-13139.8" font-family="Times,serif" font-size="14.00">Q[5]×K[14]×V[14]</text>
<text text-anchor="middle" x="3160" y="-13124.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_4_stage_7&#45;&gt;ring_attn_1_5_stage_7 -->
<g id="edge1832" class="edge">
<title>ring_attn_1_4_stage_7&#45;&gt;ring_attn_1_5_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-13151C2782.02,-13151 2940.86,-13151 2940.86,-13151"/>
<polygon fill="red" stroke="red" points="2940.86,-13154.5 2950.86,-13151 2940.86,-13147.5 2940.86,-13154.5"/>
</g>
<!-- ring_attn_1_4_stage_8&#45;&gt;ring_attn_1_4_stage_9 -->
<g id="edge424" class="edge">
<title>ring_attn_1_4_stage_8&#45;&gt;ring_attn_1_4_stage_9</title>
<path fill="none" stroke="black" d="M2573,-12829.87C2573,-12829.87 2573,-12723.25 2573,-12723.25"/>
<polygon fill="black" stroke="black" points="2576.5,-12723.25 2573,-12713.25 2569.5,-12723.25 2576.5,-12723.25"/>
</g>
<!-- ring_attn_1_5_stage_8 -->
<g id="node526" class="node">
<title>ring_attn_1_5_stage_8</title>
<polygon fill="yellow" stroke="black" points="3160,-12966 2951,-12898 3160,-12830 3369,-12898 3160,-12966"/>
<text text-anchor="middle" x="3160" y="-12916.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-12901.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="3160" y="-12886.8" font-family="Times,serif" font-size="14.00">Q[5]×K[13]×V[13]</text>
<text text-anchor="middle" x="3160" y="-12871.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_4_stage_8&#45;&gt;ring_attn_1_5_stage_8 -->
<g id="edge1833" class="edge">
<title>ring_attn_1_4_stage_8&#45;&gt;ring_attn_1_5_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-12898C2782.02,-12898 2940.86,-12898 2940.86,-12898"/>
<polygon fill="red" stroke="red" points="2940.86,-12901.5 2950.86,-12898 2940.86,-12894.5 2940.86,-12901.5"/>
</g>
<!-- ring_attn_1_4_stage_9&#45;&gt;ring_attn_1_4_stage_10 -->
<g id="edge425" class="edge">
<title>ring_attn_1_4_stage_9&#45;&gt;ring_attn_1_4_stage_10</title>
<path fill="none" stroke="black" d="M2573,-12576.87C2573,-12576.87 2573,-12470.25 2573,-12470.25"/>
<polygon fill="black" stroke="black" points="2576.5,-12470.25 2573,-12460.25 2569.5,-12470.25 2576.5,-12470.25"/>
</g>
<!-- ring_attn_1_5_stage_9 -->
<g id="node527" class="node">
<title>ring_attn_1_5_stage_9</title>
<polygon fill="yellow" stroke="black" points="3160,-12713 2951,-12645 3160,-12577 3369,-12645 3160,-12713"/>
<text text-anchor="middle" x="3160" y="-12663.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-12648.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="3160" y="-12633.8" font-family="Times,serif" font-size="14.00">Q[5]×K[12]×V[12]</text>
<text text-anchor="middle" x="3160" y="-12618.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_4_stage_9&#45;&gt;ring_attn_1_5_stage_9 -->
<g id="edge1834" class="edge">
<title>ring_attn_1_4_stage_9&#45;&gt;ring_attn_1_5_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-12645C2782.02,-12645 2940.86,-12645 2940.86,-12645"/>
<polygon fill="red" stroke="red" points="2940.86,-12648.5 2950.86,-12645 2940.86,-12641.5 2940.86,-12648.5"/>
</g>
<!-- ring_attn_1_4_stage_10&#45;&gt;ring_attn_1_4_stage_11 -->
<g id="edge426" class="edge">
<title>ring_attn_1_4_stage_10&#45;&gt;ring_attn_1_4_stage_11</title>
<path fill="none" stroke="black" d="M2573,-12323.87C2573,-12323.87 2573,-12217.25 2573,-12217.25"/>
<polygon fill="black" stroke="black" points="2576.5,-12217.25 2573,-12207.25 2569.5,-12217.25 2576.5,-12217.25"/>
</g>
<!-- ring_attn_1_5_stage_10 -->
<g id="node528" class="node">
<title>ring_attn_1_5_stage_10</title>
<polygon fill="yellow" stroke="black" points="3160,-12460 2951,-12392 3160,-12324 3369,-12392 3160,-12460"/>
<text text-anchor="middle" x="3160" y="-12410.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-12395.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="3160" y="-12380.8" font-family="Times,serif" font-size="14.00">Q[5]×K[11]×V[11]</text>
<text text-anchor="middle" x="3160" y="-12365.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_4_stage_10&#45;&gt;ring_attn_1_5_stage_10 -->
<g id="edge1835" class="edge">
<title>ring_attn_1_4_stage_10&#45;&gt;ring_attn_1_5_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-12392C2782.02,-12392 2940.86,-12392 2940.86,-12392"/>
<polygon fill="red" stroke="red" points="2940.86,-12395.5 2950.86,-12392 2940.86,-12388.5 2940.86,-12395.5"/>
</g>
<!-- ring_attn_1_4_stage_11&#45;&gt;ring_attn_1_4_stage_12 -->
<g id="edge427" class="edge">
<title>ring_attn_1_4_stage_11&#45;&gt;ring_attn_1_4_stage_12</title>
<path fill="none" stroke="black" d="M2573,-12070.87C2573,-12070.87 2573,-11964.25 2573,-11964.25"/>
<polygon fill="black" stroke="black" points="2576.5,-11964.25 2573,-11954.25 2569.5,-11964.25 2576.5,-11964.25"/>
</g>
<!-- ring_attn_1_5_stage_11 -->
<g id="node529" class="node">
<title>ring_attn_1_5_stage_11</title>
<polygon fill="yellow" stroke="black" points="3160,-12207 2951,-12139 3160,-12071 3369,-12139 3160,-12207"/>
<text text-anchor="middle" x="3160" y="-12157.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-12142.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="3160" y="-12127.8" font-family="Times,serif" font-size="14.00">Q[5]×K[10]×V[10]</text>
<text text-anchor="middle" x="3160" y="-12112.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_4_stage_11&#45;&gt;ring_attn_1_5_stage_11 -->
<g id="edge1836" class="edge">
<title>ring_attn_1_4_stage_11&#45;&gt;ring_attn_1_5_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-12139C2782.02,-12139 2940.86,-12139 2940.86,-12139"/>
<polygon fill="red" stroke="red" points="2940.86,-12142.5 2950.86,-12139 2940.86,-12135.5 2940.86,-12142.5"/>
</g>
<!-- ring_attn_1_4_stage_12&#45;&gt;ring_attn_1_4_stage_13 -->
<g id="edge428" class="edge">
<title>ring_attn_1_4_stage_12&#45;&gt;ring_attn_1_4_stage_13</title>
<path fill="none" stroke="black" d="M2573,-11817.87C2573,-11817.87 2573,-11711.25 2573,-11711.25"/>
<polygon fill="black" stroke="black" points="2576.5,-11711.25 2573,-11701.25 2569.5,-11711.25 2576.5,-11711.25"/>
</g>
<!-- ring_attn_1_5_stage_12 -->
<g id="node530" class="node">
<title>ring_attn_1_5_stage_12</title>
<polygon fill="yellow" stroke="black" points="3160,-11954 2951,-11886 3160,-11818 3369,-11886 3160,-11954"/>
<text text-anchor="middle" x="3160" y="-11904.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-11889.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="3160" y="-11874.8" font-family="Times,serif" font-size="14.00">Q[5]×K[9]×V[9]</text>
<text text-anchor="middle" x="3160" y="-11859.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_4_stage_12&#45;&gt;ring_attn_1_5_stage_12 -->
<g id="edge1837" class="edge">
<title>ring_attn_1_4_stage_12&#45;&gt;ring_attn_1_5_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-11886C2782.02,-11886 2940.86,-11886 2940.86,-11886"/>
<polygon fill="red" stroke="red" points="2940.86,-11889.5 2950.86,-11886 2940.86,-11882.5 2940.86,-11889.5"/>
</g>
<!-- ring_attn_1_4_stage_13&#45;&gt;ring_attn_1_4_stage_14 -->
<g id="edge429" class="edge">
<title>ring_attn_1_4_stage_13&#45;&gt;ring_attn_1_4_stage_14</title>
<path fill="none" stroke="black" d="M2573,-11564.87C2573,-11564.87 2573,-11458.25 2573,-11458.25"/>
<polygon fill="black" stroke="black" points="2576.5,-11458.25 2573,-11448.25 2569.5,-11458.25 2576.5,-11458.25"/>
</g>
<!-- ring_attn_1_5_stage_13 -->
<g id="node531" class="node">
<title>ring_attn_1_5_stage_13</title>
<polygon fill="yellow" stroke="black" points="3160,-11701 2951,-11633 3160,-11565 3369,-11633 3160,-11701"/>
<text text-anchor="middle" x="3160" y="-11651.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-11636.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="3160" y="-11621.8" font-family="Times,serif" font-size="14.00">Q[5]×K[8]×V[8]</text>
<text text-anchor="middle" x="3160" y="-11606.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_4_stage_13&#45;&gt;ring_attn_1_5_stage_13 -->
<g id="edge1838" class="edge">
<title>ring_attn_1_4_stage_13&#45;&gt;ring_attn_1_5_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-11633C2782.02,-11633 2940.86,-11633 2940.86,-11633"/>
<polygon fill="red" stroke="red" points="2940.86,-11636.5 2950.86,-11633 2940.86,-11629.5 2940.86,-11636.5"/>
</g>
<!-- ring_attn_1_4_stage_14&#45;&gt;ring_attn_1_4_stage_15 -->
<g id="edge430" class="edge">
<title>ring_attn_1_4_stage_14&#45;&gt;ring_attn_1_4_stage_15</title>
<path fill="none" stroke="black" d="M2573,-11311.87C2573,-11311.87 2573,-11205.25 2573,-11205.25"/>
<polygon fill="black" stroke="black" points="2576.5,-11205.25 2573,-11195.25 2569.5,-11205.25 2576.5,-11205.25"/>
</g>
<!-- ring_attn_1_5_stage_14 -->
<g id="node532" class="node">
<title>ring_attn_1_5_stage_14</title>
<polygon fill="yellow" stroke="black" points="3160,-11448 2951,-11380 3160,-11312 3369,-11380 3160,-11448"/>
<text text-anchor="middle" x="3160" y="-11398.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-11383.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="3160" y="-11368.8" font-family="Times,serif" font-size="14.00">Q[5]×K[7]×V[7]</text>
<text text-anchor="middle" x="3160" y="-11353.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_4_stage_14&#45;&gt;ring_attn_1_5_stage_14 -->
<g id="edge1839" class="edge">
<title>ring_attn_1_4_stage_14&#45;&gt;ring_attn_1_5_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-11380C2782.02,-11380 2940.86,-11380 2940.86,-11380"/>
<polygon fill="red" stroke="red" points="2940.86,-11383.5 2950.86,-11380 2940.86,-11376.5 2940.86,-11383.5"/>
</g>
<!-- attn_out_1_4 -->
<g id="node436" class="node">
<title>attn_out_1_4</title>
<polygon fill="none" stroke="black" points="2642.5,-10986 2503.5,-10986 2503.5,-10933 2642.5,-10933 2642.5,-10986"/>
<text text-anchor="middle" x="2573" y="-10970.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2573" y="-10955.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="2573" y="-10940.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_1_4_stage_15&#45;&gt;attn_out_1_4 -->
<g id="edge431" class="edge">
<title>ring_attn_1_4_stage_15&#45;&gt;attn_out_1_4</title>
<path fill="none" stroke="black" d="M2573,-11058.87C2573,-11058.87 2573,-10996.18 2573,-10996.18"/>
<polygon fill="black" stroke="black" points="2576.5,-10996.18 2573,-10986.18 2569.5,-10996.18 2576.5,-10996.18"/>
</g>
<!-- ring_attn_1_5_stage_15 -->
<g id="node533" class="node">
<title>ring_attn_1_5_stage_15</title>
<polygon fill="yellow" stroke="black" points="3160,-11195 2951,-11127 3160,-11059 3369,-11127 3160,-11195"/>
<text text-anchor="middle" x="3160" y="-11145.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-11130.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="3160" y="-11115.8" font-family="Times,serif" font-size="14.00">Q[5]×K[6]×V[6]</text>
<text text-anchor="middle" x="3160" y="-11100.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_4_stage_15&#45;&gt;ring_attn_1_5_stage_15 -->
<g id="edge1840" class="edge">
<title>ring_attn_1_4_stage_15&#45;&gt;ring_attn_1_5_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-11127C2782.02,-11127 2940.86,-11127 2940.86,-11127"/>
<polygon fill="red" stroke="red" points="2940.86,-11130.5 2950.86,-11127 2940.86,-11123.5 2940.86,-11130.5"/>
</g>
<!-- attn_residual_1_4 -->
<g id="node437" class="node">
<title>attn_residual_1_4</title>
<ellipse fill="none" stroke="black" cx="2573" cy="-10833" rx="105.5" ry="27"/>
<text text-anchor="middle" x="2573" y="-10836.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="2573" y="-10821.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_1_4&#45;&gt;attn_residual_1_4 -->
<g id="edge432" class="edge">
<title>attn_out_1_4&#45;&gt;attn_residual_1_4</title>
<path fill="none" stroke="black" d="M2573,-10932.98C2573,-10932.98 2573,-10870.36 2573,-10870.36"/>
<polygon fill="black" stroke="black" points="2576.5,-10870.36 2573,-10860.36 2569.5,-10870.36 2576.5,-10870.36"/>
</g>
<!-- ffn_up_1_4 -->
<g id="node438" class="node">
<title>ffn_up_1_4</title>
<polygon fill="none" stroke="black" points="2652,-10733 2494,-10733 2494,-10680 2652,-10680 2652,-10733"/>
<text text-anchor="middle" x="2573" y="-10717.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2573" y="-10702.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="2573" y="-10687.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_1_4&#45;&gt;ffn_up_1_4 -->
<g id="edge433" class="edge">
<title>attn_residual_1_4&#45;&gt;ffn_up_1_4</title>
<path fill="none" stroke="black" d="M2573,-10805.86C2573,-10805.86 2573,-10743.16 2573,-10743.16"/>
<polygon fill="black" stroke="black" points="2576.5,-10743.16 2573,-10733.16 2569.5,-10743.16 2576.5,-10743.16"/>
</g>
<!-- ffn_gelu_1_4 -->
<g id="node439" class="node">
<title>ffn_gelu_1_4</title>
<ellipse fill="none" stroke="black" cx="2573" cy="-10580" rx="105.5" ry="27"/>
<text text-anchor="middle" x="2573" y="-10583.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2573" y="-10568.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_1_4&#45;&gt;ffn_gelu_1_4 -->
<g id="edge434" class="edge">
<title>ffn_up_1_4&#45;&gt;ffn_gelu_1_4</title>
<path fill="none" stroke="black" d="M2573,-10679.98C2573,-10679.98 2573,-10617.36 2573,-10617.36"/>
<polygon fill="black" stroke="black" points="2576.5,-10617.36 2573,-10607.36 2569.5,-10617.36 2576.5,-10617.36"/>
</g>
<!-- ffn_down_1_4 -->
<g id="node440" class="node">
<title>ffn_down_1_4</title>
<polygon fill="none" stroke="black" points="2662,-10480 2484,-10480 2484,-10427 2662,-10427 2662,-10480"/>
<text text-anchor="middle" x="2573" y="-10464.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2573" y="-10449.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="2573" y="-10434.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_1_4&#45;&gt;ffn_down_1_4 -->
<g id="edge435" class="edge">
<title>ffn_gelu_1_4&#45;&gt;ffn_down_1_4</title>
<path fill="none" stroke="black" d="M2573,-10552.86C2573,-10552.86 2573,-10490.16 2573,-10490.16"/>
<polygon fill="black" stroke="black" points="2576.5,-10490.16 2573,-10480.16 2569.5,-10490.16 2576.5,-10490.16"/>
</g>
<!-- ffn_residual_1_4 -->
<g id="node441" class="node">
<title>ffn_residual_1_4</title>
<ellipse fill="none" stroke="black" cx="2573" cy="-10327" rx="105.5" ry="27"/>
<text text-anchor="middle" x="2573" y="-10330.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="2573" y="-10315.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_1_4&#45;&gt;ffn_residual_1_4 -->
<g id="edge436" class="edge">
<title>ffn_down_1_4&#45;&gt;ffn_residual_1_4</title>
<path fill="none" stroke="black" d="M2573,-10426.98C2573,-10426.98 2573,-10364.36 2573,-10364.36"/>
<polygon fill="black" stroke="black" points="2576.5,-10364.36 2573,-10354.36 2569.5,-10364.36 2576.5,-10364.36"/>
</g>
<!-- qkv_proj_2_4 -->
<g id="node442" class="node">
<title>qkv_proj_2_4</title>
<polygon fill="none" stroke="black" points="2655.5,-10227 2490.5,-10227 2490.5,-10174 2655.5,-10174 2655.5,-10227"/>
<text text-anchor="middle" x="2573" y="-10211.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2573" y="-10196.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="2573" y="-10181.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_1_4&#45;&gt;qkv_proj_2_4 -->
<g id="edge437" class="edge">
<title>ffn_residual_1_4&#45;&gt;qkv_proj_2_4</title>
<path fill="none" stroke="black" d="M2573,-10299.86C2573,-10299.86 2573,-10237.16 2573,-10237.16"/>
<polygon fill="black" stroke="black" points="2576.5,-10237.16 2573,-10227.16 2569.5,-10237.16 2576.5,-10237.16"/>
</g>
<!-- qkv_reshape_2_4 -->
<g id="node443" class="node">
<title>qkv_reshape_2_4</title>
<ellipse fill="none" stroke="black" cx="2573" cy="-10074" rx="148" ry="27"/>
<text text-anchor="middle" x="2573" y="-10077.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="2573" y="-10062.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_2_4&#45;&gt;qkv_reshape_2_4 -->
<g id="edge438" class="edge">
<title>qkv_proj_2_4&#45;&gt;qkv_reshape_2_4</title>
<path fill="none" stroke="black" d="M2573,-10173.98C2573,-10173.98 2573,-10111.36 2573,-10111.36"/>
<polygon fill="black" stroke="black" points="2576.5,-10111.36 2573,-10101.36 2569.5,-10111.36 2576.5,-10111.36"/>
</g>
<!-- qkv_reshape_2_4&#45;&gt;ring_attn_2_4_stage_0 -->
<g id="edge439" class="edge">
<title>qkv_reshape_2_4&#45;&gt;ring_attn_2_4_stage_0</title>
<path fill="none" stroke="black" d="M2573,-10046.72C2573,-10046.72 2573,-9940.16 2573,-9940.16"/>
<polygon fill="black" stroke="black" points="2576.5,-9940.16 2573,-9930.16 2569.5,-9940.16 2576.5,-9940.16"/>
</g>
<!-- ring_attn_2_4_stage_0&#45;&gt;ring_attn_2_4_stage_1 -->
<g id="edge440" class="edge">
<title>ring_attn_2_4_stage_0&#45;&gt;ring_attn_2_4_stage_1</title>
<path fill="none" stroke="black" d="M2573,-9793.87C2573,-9793.87 2573,-9687.25 2573,-9687.25"/>
<polygon fill="black" stroke="black" points="2576.5,-9687.25 2573,-9677.25 2569.5,-9687.25 2576.5,-9687.25"/>
</g>
<!-- ring_attn_2_5_stage_0 -->
<g id="node542" class="node">
<title>ring_attn_2_5_stage_0</title>
<polygon fill="yellow" stroke="black" points="3160,-9930 2951,-9862 3160,-9794 3369,-9862 3160,-9930"/>
<text text-anchor="middle" x="3160" y="-9880.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-9865.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="3160" y="-9850.8" font-family="Times,serif" font-size="14.00">Q[5]×K[5]×V[5]</text>
<text text-anchor="middle" x="3160" y="-9835.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_4_stage_0&#45;&gt;ring_attn_2_5_stage_0 -->
<g id="edge1841" class="edge">
<title>ring_attn_2_4_stage_0&#45;&gt;ring_attn_2_5_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-9862C2782.02,-9862 2940.86,-9862 2940.86,-9862"/>
<polygon fill="red" stroke="red" points="2940.86,-9865.5 2950.86,-9862 2940.86,-9858.5 2940.86,-9865.5"/>
</g>
<!-- ring_attn_2_4_stage_1&#45;&gt;ring_attn_2_4_stage_2 -->
<g id="edge441" class="edge">
<title>ring_attn_2_4_stage_1&#45;&gt;ring_attn_2_4_stage_2</title>
<path fill="none" stroke="black" d="M2573,-9540.87C2573,-9540.87 2573,-9434.25 2573,-9434.25"/>
<polygon fill="black" stroke="black" points="2576.5,-9434.25 2573,-9424.25 2569.5,-9434.25 2576.5,-9434.25"/>
</g>
<!-- ring_attn_2_5_stage_1 -->
<g id="node543" class="node">
<title>ring_attn_2_5_stage_1</title>
<polygon fill="yellow" stroke="black" points="3160,-9677 2951,-9609 3160,-9541 3369,-9609 3160,-9677"/>
<text text-anchor="middle" x="3160" y="-9627.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-9612.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="3160" y="-9597.8" font-family="Times,serif" font-size="14.00">Q[5]×K[4]×V[4]</text>
<text text-anchor="middle" x="3160" y="-9582.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_4_stage_1&#45;&gt;ring_attn_2_5_stage_1 -->
<g id="edge1842" class="edge">
<title>ring_attn_2_4_stage_1&#45;&gt;ring_attn_2_5_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-9609C2782.02,-9609 2940.86,-9609 2940.86,-9609"/>
<polygon fill="red" stroke="red" points="2940.86,-9612.5 2950.86,-9609 2940.86,-9605.5 2940.86,-9612.5"/>
</g>
<!-- ring_attn_2_4_stage_2&#45;&gt;ring_attn_2_4_stage_3 -->
<g id="edge442" class="edge">
<title>ring_attn_2_4_stage_2&#45;&gt;ring_attn_2_4_stage_3</title>
<path fill="none" stroke="black" d="M2573,-9287.87C2573,-9287.87 2573,-9181.25 2573,-9181.25"/>
<polygon fill="black" stroke="black" points="2576.5,-9181.25 2573,-9171.25 2569.5,-9181.25 2576.5,-9181.25"/>
</g>
<!-- ring_attn_2_5_stage_2 -->
<g id="node544" class="node">
<title>ring_attn_2_5_stage_2</title>
<polygon fill="yellow" stroke="black" points="3160,-9424 2951,-9356 3160,-9288 3369,-9356 3160,-9424"/>
<text text-anchor="middle" x="3160" y="-9374.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-9359.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="3160" y="-9344.8" font-family="Times,serif" font-size="14.00">Q[5]×K[3]×V[3]</text>
<text text-anchor="middle" x="3160" y="-9329.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_4_stage_2&#45;&gt;ring_attn_2_5_stage_2 -->
<g id="edge1843" class="edge">
<title>ring_attn_2_4_stage_2&#45;&gt;ring_attn_2_5_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-9356C2782.02,-9356 2940.86,-9356 2940.86,-9356"/>
<polygon fill="red" stroke="red" points="2940.86,-9359.5 2950.86,-9356 2940.86,-9352.5 2940.86,-9359.5"/>
</g>
<!-- ring_attn_2_4_stage_3&#45;&gt;ring_attn_2_4_stage_4 -->
<g id="edge443" class="edge">
<title>ring_attn_2_4_stage_3&#45;&gt;ring_attn_2_4_stage_4</title>
<path fill="none" stroke="black" d="M2573,-9034.87C2573,-9034.87 2573,-8928.25 2573,-8928.25"/>
<polygon fill="black" stroke="black" points="2576.5,-8928.25 2573,-8918.25 2569.5,-8928.25 2576.5,-8928.25"/>
</g>
<!-- ring_attn_2_5_stage_3 -->
<g id="node545" class="node">
<title>ring_attn_2_5_stage_3</title>
<polygon fill="yellow" stroke="black" points="3160,-9171 2951,-9103 3160,-9035 3369,-9103 3160,-9171"/>
<text text-anchor="middle" x="3160" y="-9121.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-9106.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="3160" y="-9091.8" font-family="Times,serif" font-size="14.00">Q[5]×K[2]×V[2]</text>
<text text-anchor="middle" x="3160" y="-9076.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_4_stage_3&#45;&gt;ring_attn_2_5_stage_3 -->
<g id="edge1844" class="edge">
<title>ring_attn_2_4_stage_3&#45;&gt;ring_attn_2_5_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-9103C2782.02,-9103 2940.86,-9103 2940.86,-9103"/>
<polygon fill="red" stroke="red" points="2940.86,-9106.5 2950.86,-9103 2940.86,-9099.5 2940.86,-9106.5"/>
</g>
<!-- ring_attn_2_4_stage_4&#45;&gt;ring_attn_2_4_stage_5 -->
<g id="edge444" class="edge">
<title>ring_attn_2_4_stage_4&#45;&gt;ring_attn_2_4_stage_5</title>
<path fill="none" stroke="black" d="M2573,-8781.87C2573,-8781.87 2573,-8675.25 2573,-8675.25"/>
<polygon fill="black" stroke="black" points="2576.5,-8675.25 2573,-8665.25 2569.5,-8675.25 2576.5,-8675.25"/>
</g>
<!-- ring_attn_2_5_stage_4 -->
<g id="node546" class="node">
<title>ring_attn_2_5_stage_4</title>
<polygon fill="yellow" stroke="black" points="3160,-8918 2951,-8850 3160,-8782 3369,-8850 3160,-8918"/>
<text text-anchor="middle" x="3160" y="-8868.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-8853.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="3160" y="-8838.8" font-family="Times,serif" font-size="14.00">Q[5]×K[1]×V[1]</text>
<text text-anchor="middle" x="3160" y="-8823.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_4_stage_4&#45;&gt;ring_attn_2_5_stage_4 -->
<g id="edge1845" class="edge">
<title>ring_attn_2_4_stage_4&#45;&gt;ring_attn_2_5_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-8850C2782.02,-8850 2940.86,-8850 2940.86,-8850"/>
<polygon fill="red" stroke="red" points="2940.86,-8853.5 2950.86,-8850 2940.86,-8846.5 2940.86,-8853.5"/>
</g>
<!-- ring_attn_2_4_stage_5&#45;&gt;ring_attn_2_4_stage_6 -->
<g id="edge445" class="edge">
<title>ring_attn_2_4_stage_5&#45;&gt;ring_attn_2_4_stage_6</title>
<path fill="none" stroke="black" d="M2573,-8528.87C2573,-8528.87 2573,-8422.25 2573,-8422.25"/>
<polygon fill="black" stroke="black" points="2576.5,-8422.25 2573,-8412.25 2569.5,-8422.25 2576.5,-8422.25"/>
</g>
<!-- ring_attn_2_5_stage_5 -->
<g id="node547" class="node">
<title>ring_attn_2_5_stage_5</title>
<polygon fill="yellow" stroke="black" points="3160,-8665 2951,-8597 3160,-8529 3369,-8597 3160,-8665"/>
<text text-anchor="middle" x="3160" y="-8615.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-8600.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="3160" y="-8585.8" font-family="Times,serif" font-size="14.00">Q[5]×K[0]×V[0]</text>
<text text-anchor="middle" x="3160" y="-8570.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_4_stage_5&#45;&gt;ring_attn_2_5_stage_5 -->
<g id="edge1846" class="edge">
<title>ring_attn_2_4_stage_5&#45;&gt;ring_attn_2_5_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-8597C2782.02,-8597 2940.86,-8597 2940.86,-8597"/>
<polygon fill="red" stroke="red" points="2940.86,-8600.5 2950.86,-8597 2940.86,-8593.5 2940.86,-8600.5"/>
</g>
<!-- ring_attn_2_4_stage_6&#45;&gt;ring_attn_2_4_stage_7 -->
<g id="edge446" class="edge">
<title>ring_attn_2_4_stage_6&#45;&gt;ring_attn_2_4_stage_7</title>
<path fill="none" stroke="black" d="M2573,-8275.87C2573,-8275.87 2573,-8169.25 2573,-8169.25"/>
<polygon fill="black" stroke="black" points="2576.5,-8169.25 2573,-8159.25 2569.5,-8169.25 2576.5,-8169.25"/>
</g>
<!-- ring_attn_2_5_stage_6 -->
<g id="node548" class="node">
<title>ring_attn_2_5_stage_6</title>
<polygon fill="yellow" stroke="black" points="3160,-8412 2951,-8344 3160,-8276 3369,-8344 3160,-8412"/>
<text text-anchor="middle" x="3160" y="-8362.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-8347.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="3160" y="-8332.8" font-family="Times,serif" font-size="14.00">Q[5]×K[15]×V[15]</text>
<text text-anchor="middle" x="3160" y="-8317.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_4_stage_6&#45;&gt;ring_attn_2_5_stage_6 -->
<g id="edge1847" class="edge">
<title>ring_attn_2_4_stage_6&#45;&gt;ring_attn_2_5_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-8344C2782.02,-8344 2940.86,-8344 2940.86,-8344"/>
<polygon fill="red" stroke="red" points="2940.86,-8347.5 2950.86,-8344 2940.86,-8340.5 2940.86,-8347.5"/>
</g>
<!-- ring_attn_2_4_stage_7&#45;&gt;ring_attn_2_4_stage_8 -->
<g id="edge447" class="edge">
<title>ring_attn_2_4_stage_7&#45;&gt;ring_attn_2_4_stage_8</title>
<path fill="none" stroke="black" d="M2573,-8022.87C2573,-8022.87 2573,-7916.25 2573,-7916.25"/>
<polygon fill="black" stroke="black" points="2576.5,-7916.25 2573,-7906.25 2569.5,-7916.25 2576.5,-7916.25"/>
</g>
<!-- ring_attn_2_5_stage_7 -->
<g id="node549" class="node">
<title>ring_attn_2_5_stage_7</title>
<polygon fill="yellow" stroke="black" points="3160,-8159 2951,-8091 3160,-8023 3369,-8091 3160,-8159"/>
<text text-anchor="middle" x="3160" y="-8109.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-8094.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="3160" y="-8079.8" font-family="Times,serif" font-size="14.00">Q[5]×K[14]×V[14]</text>
<text text-anchor="middle" x="3160" y="-8064.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_4_stage_7&#45;&gt;ring_attn_2_5_stage_7 -->
<g id="edge1848" class="edge">
<title>ring_attn_2_4_stage_7&#45;&gt;ring_attn_2_5_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-8091C2782.02,-8091 2940.86,-8091 2940.86,-8091"/>
<polygon fill="red" stroke="red" points="2940.86,-8094.5 2950.86,-8091 2940.86,-8087.5 2940.86,-8094.5"/>
</g>
<!-- ring_attn_2_4_stage_8&#45;&gt;ring_attn_2_4_stage_9 -->
<g id="edge448" class="edge">
<title>ring_attn_2_4_stage_8&#45;&gt;ring_attn_2_4_stage_9</title>
<path fill="none" stroke="black" d="M2573,-7769.87C2573,-7769.87 2573,-7663.25 2573,-7663.25"/>
<polygon fill="black" stroke="black" points="2576.5,-7663.25 2573,-7653.25 2569.5,-7663.25 2576.5,-7663.25"/>
</g>
<!-- ring_attn_2_5_stage_8 -->
<g id="node550" class="node">
<title>ring_attn_2_5_stage_8</title>
<polygon fill="yellow" stroke="black" points="3160,-7906 2951,-7838 3160,-7770 3369,-7838 3160,-7906"/>
<text text-anchor="middle" x="3160" y="-7856.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-7841.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="3160" y="-7826.8" font-family="Times,serif" font-size="14.00">Q[5]×K[13]×V[13]</text>
<text text-anchor="middle" x="3160" y="-7811.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_4_stage_8&#45;&gt;ring_attn_2_5_stage_8 -->
<g id="edge1849" class="edge">
<title>ring_attn_2_4_stage_8&#45;&gt;ring_attn_2_5_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-7838C2782.02,-7838 2940.86,-7838 2940.86,-7838"/>
<polygon fill="red" stroke="red" points="2940.86,-7841.5 2950.86,-7838 2940.86,-7834.5 2940.86,-7841.5"/>
</g>
<!-- ring_attn_2_4_stage_9&#45;&gt;ring_attn_2_4_stage_10 -->
<g id="edge449" class="edge">
<title>ring_attn_2_4_stage_9&#45;&gt;ring_attn_2_4_stage_10</title>
<path fill="none" stroke="black" d="M2573,-7516.87C2573,-7516.87 2573,-7410.25 2573,-7410.25"/>
<polygon fill="black" stroke="black" points="2576.5,-7410.25 2573,-7400.25 2569.5,-7410.25 2576.5,-7410.25"/>
</g>
<!-- ring_attn_2_5_stage_9 -->
<g id="node551" class="node">
<title>ring_attn_2_5_stage_9</title>
<polygon fill="yellow" stroke="black" points="3160,-7653 2951,-7585 3160,-7517 3369,-7585 3160,-7653"/>
<text text-anchor="middle" x="3160" y="-7603.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-7588.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="3160" y="-7573.8" font-family="Times,serif" font-size="14.00">Q[5]×K[12]×V[12]</text>
<text text-anchor="middle" x="3160" y="-7558.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_4_stage_9&#45;&gt;ring_attn_2_5_stage_9 -->
<g id="edge1850" class="edge">
<title>ring_attn_2_4_stage_9&#45;&gt;ring_attn_2_5_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-7585C2782.02,-7585 2940.86,-7585 2940.86,-7585"/>
<polygon fill="red" stroke="red" points="2940.86,-7588.5 2950.86,-7585 2940.86,-7581.5 2940.86,-7588.5"/>
</g>
<!-- ring_attn_2_4_stage_10&#45;&gt;ring_attn_2_4_stage_11 -->
<g id="edge450" class="edge">
<title>ring_attn_2_4_stage_10&#45;&gt;ring_attn_2_4_stage_11</title>
<path fill="none" stroke="black" d="M2573,-7263.87C2573,-7263.87 2573,-7157.25 2573,-7157.25"/>
<polygon fill="black" stroke="black" points="2576.5,-7157.25 2573,-7147.25 2569.5,-7157.25 2576.5,-7157.25"/>
</g>
<!-- ring_attn_2_5_stage_10 -->
<g id="node552" class="node">
<title>ring_attn_2_5_stage_10</title>
<polygon fill="yellow" stroke="black" points="3160,-7400 2951,-7332 3160,-7264 3369,-7332 3160,-7400"/>
<text text-anchor="middle" x="3160" y="-7350.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-7335.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="3160" y="-7320.8" font-family="Times,serif" font-size="14.00">Q[5]×K[11]×V[11]</text>
<text text-anchor="middle" x="3160" y="-7305.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_4_stage_10&#45;&gt;ring_attn_2_5_stage_10 -->
<g id="edge1851" class="edge">
<title>ring_attn_2_4_stage_10&#45;&gt;ring_attn_2_5_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-7332C2782.02,-7332 2940.86,-7332 2940.86,-7332"/>
<polygon fill="red" stroke="red" points="2940.86,-7335.5 2950.86,-7332 2940.86,-7328.5 2940.86,-7335.5"/>
</g>
<!-- ring_attn_2_4_stage_11&#45;&gt;ring_attn_2_4_stage_12 -->
<g id="edge451" class="edge">
<title>ring_attn_2_4_stage_11&#45;&gt;ring_attn_2_4_stage_12</title>
<path fill="none" stroke="black" d="M2573,-7010.87C2573,-7010.87 2573,-6904.25 2573,-6904.25"/>
<polygon fill="black" stroke="black" points="2576.5,-6904.25 2573,-6894.25 2569.5,-6904.25 2576.5,-6904.25"/>
</g>
<!-- ring_attn_2_5_stage_11 -->
<g id="node553" class="node">
<title>ring_attn_2_5_stage_11</title>
<polygon fill="yellow" stroke="black" points="3160,-7147 2951,-7079 3160,-7011 3369,-7079 3160,-7147"/>
<text text-anchor="middle" x="3160" y="-7097.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-7082.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="3160" y="-7067.8" font-family="Times,serif" font-size="14.00">Q[5]×K[10]×V[10]</text>
<text text-anchor="middle" x="3160" y="-7052.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_4_stage_11&#45;&gt;ring_attn_2_5_stage_11 -->
<g id="edge1852" class="edge">
<title>ring_attn_2_4_stage_11&#45;&gt;ring_attn_2_5_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-7079C2782.02,-7079 2940.86,-7079 2940.86,-7079"/>
<polygon fill="red" stroke="red" points="2940.86,-7082.5 2950.86,-7079 2940.86,-7075.5 2940.86,-7082.5"/>
</g>
<!-- ring_attn_2_4_stage_12&#45;&gt;ring_attn_2_4_stage_13 -->
<g id="edge452" class="edge">
<title>ring_attn_2_4_stage_12&#45;&gt;ring_attn_2_4_stage_13</title>
<path fill="none" stroke="black" d="M2573,-6757.87C2573,-6757.87 2573,-6651.25 2573,-6651.25"/>
<polygon fill="black" stroke="black" points="2576.5,-6651.25 2573,-6641.25 2569.5,-6651.25 2576.5,-6651.25"/>
</g>
<!-- ring_attn_2_5_stage_12 -->
<g id="node554" class="node">
<title>ring_attn_2_5_stage_12</title>
<polygon fill="yellow" stroke="black" points="3160,-6894 2951,-6826 3160,-6758 3369,-6826 3160,-6894"/>
<text text-anchor="middle" x="3160" y="-6844.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-6829.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="3160" y="-6814.8" font-family="Times,serif" font-size="14.00">Q[5]×K[9]×V[9]</text>
<text text-anchor="middle" x="3160" y="-6799.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_4_stage_12&#45;&gt;ring_attn_2_5_stage_12 -->
<g id="edge1853" class="edge">
<title>ring_attn_2_4_stage_12&#45;&gt;ring_attn_2_5_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-6826C2782.02,-6826 2940.86,-6826 2940.86,-6826"/>
<polygon fill="red" stroke="red" points="2940.86,-6829.5 2950.86,-6826 2940.86,-6822.5 2940.86,-6829.5"/>
</g>
<!-- ring_attn_2_4_stage_13&#45;&gt;ring_attn_2_4_stage_14 -->
<g id="edge453" class="edge">
<title>ring_attn_2_4_stage_13&#45;&gt;ring_attn_2_4_stage_14</title>
<path fill="none" stroke="black" d="M2573,-6504.87C2573,-6504.87 2573,-6398.25 2573,-6398.25"/>
<polygon fill="black" stroke="black" points="2576.5,-6398.25 2573,-6388.25 2569.5,-6398.25 2576.5,-6398.25"/>
</g>
<!-- ring_attn_2_5_stage_13 -->
<g id="node555" class="node">
<title>ring_attn_2_5_stage_13</title>
<polygon fill="yellow" stroke="black" points="3160,-6641 2951,-6573 3160,-6505 3369,-6573 3160,-6641"/>
<text text-anchor="middle" x="3160" y="-6591.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-6576.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="3160" y="-6561.8" font-family="Times,serif" font-size="14.00">Q[5]×K[8]×V[8]</text>
<text text-anchor="middle" x="3160" y="-6546.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_4_stage_13&#45;&gt;ring_attn_2_5_stage_13 -->
<g id="edge1854" class="edge">
<title>ring_attn_2_4_stage_13&#45;&gt;ring_attn_2_5_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-6573C2782.02,-6573 2940.86,-6573 2940.86,-6573"/>
<polygon fill="red" stroke="red" points="2940.86,-6576.5 2950.86,-6573 2940.86,-6569.5 2940.86,-6576.5"/>
</g>
<!-- ring_attn_2_4_stage_14&#45;&gt;ring_attn_2_4_stage_15 -->
<g id="edge454" class="edge">
<title>ring_attn_2_4_stage_14&#45;&gt;ring_attn_2_4_stage_15</title>
<path fill="none" stroke="black" d="M2573,-6251.87C2573,-6251.87 2573,-6145.25 2573,-6145.25"/>
<polygon fill="black" stroke="black" points="2576.5,-6145.25 2573,-6135.25 2569.5,-6145.25 2576.5,-6145.25"/>
</g>
<!-- ring_attn_2_5_stage_14 -->
<g id="node556" class="node">
<title>ring_attn_2_5_stage_14</title>
<polygon fill="yellow" stroke="black" points="3160,-6388 2951,-6320 3160,-6252 3369,-6320 3160,-6388"/>
<text text-anchor="middle" x="3160" y="-6338.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-6323.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="3160" y="-6308.8" font-family="Times,serif" font-size="14.00">Q[5]×K[7]×V[7]</text>
<text text-anchor="middle" x="3160" y="-6293.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_4_stage_14&#45;&gt;ring_attn_2_5_stage_14 -->
<g id="edge1855" class="edge">
<title>ring_attn_2_4_stage_14&#45;&gt;ring_attn_2_5_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-6320C2782.02,-6320 2940.86,-6320 2940.86,-6320"/>
<polygon fill="red" stroke="red" points="2940.86,-6323.5 2950.86,-6320 2940.86,-6316.5 2940.86,-6323.5"/>
</g>
<!-- attn_out_2_4 -->
<g id="node460" class="node">
<title>attn_out_2_4</title>
<polygon fill="none" stroke="black" points="2642.5,-5926 2503.5,-5926 2503.5,-5873 2642.5,-5873 2642.5,-5926"/>
<text text-anchor="middle" x="2573" y="-5910.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2573" y="-5895.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="2573" y="-5880.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_2_4_stage_15&#45;&gt;attn_out_2_4 -->
<g id="edge455" class="edge">
<title>ring_attn_2_4_stage_15&#45;&gt;attn_out_2_4</title>
<path fill="none" stroke="black" d="M2573,-5998.87C2573,-5998.87 2573,-5936.18 2573,-5936.18"/>
<polygon fill="black" stroke="black" points="2576.5,-5936.18 2573,-5926.18 2569.5,-5936.18 2576.5,-5936.18"/>
</g>
<!-- ring_attn_2_5_stage_15 -->
<g id="node557" class="node">
<title>ring_attn_2_5_stage_15</title>
<polygon fill="yellow" stroke="black" points="3160,-6135 2951,-6067 3160,-5999 3369,-6067 3160,-6135"/>
<text text-anchor="middle" x="3160" y="-6085.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-6070.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="3160" y="-6055.8" font-family="Times,serif" font-size="14.00">Q[5]×K[6]×V[6]</text>
<text text-anchor="middle" x="3160" y="-6040.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_4_stage_15&#45;&gt;ring_attn_2_5_stage_15 -->
<g id="edge1856" class="edge">
<title>ring_attn_2_4_stage_15&#45;&gt;ring_attn_2_5_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-6067C2782.02,-6067 2940.86,-6067 2940.86,-6067"/>
<polygon fill="red" stroke="red" points="2940.86,-6070.5 2950.86,-6067 2940.86,-6063.5 2940.86,-6070.5"/>
</g>
<!-- attn_residual_2_4 -->
<g id="node461" class="node">
<title>attn_residual_2_4</title>
<ellipse fill="none" stroke="black" cx="2573" cy="-5773" rx="105.5" ry="27"/>
<text text-anchor="middle" x="2573" y="-5776.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="2573" y="-5761.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_2_4&#45;&gt;attn_residual_2_4 -->
<g id="edge456" class="edge">
<title>attn_out_2_4&#45;&gt;attn_residual_2_4</title>
<path fill="none" stroke="black" d="M2573,-5872.98C2573,-5872.98 2573,-5810.36 2573,-5810.36"/>
<polygon fill="black" stroke="black" points="2576.5,-5810.36 2573,-5800.36 2569.5,-5810.36 2576.5,-5810.36"/>
</g>
<!-- ffn_up_2_4 -->
<g id="node462" class="node">
<title>ffn_up_2_4</title>
<polygon fill="none" stroke="black" points="2652,-5673 2494,-5673 2494,-5620 2652,-5620 2652,-5673"/>
<text text-anchor="middle" x="2573" y="-5657.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2573" y="-5642.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="2573" y="-5627.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_2_4&#45;&gt;ffn_up_2_4 -->
<g id="edge457" class="edge">
<title>attn_residual_2_4&#45;&gt;ffn_up_2_4</title>
<path fill="none" stroke="black" d="M2573,-5745.86C2573,-5745.86 2573,-5683.16 2573,-5683.16"/>
<polygon fill="black" stroke="black" points="2576.5,-5683.16 2573,-5673.16 2569.5,-5683.16 2576.5,-5683.16"/>
</g>
<!-- ffn_gelu_2_4 -->
<g id="node463" class="node">
<title>ffn_gelu_2_4</title>
<ellipse fill="none" stroke="black" cx="2573" cy="-5520" rx="105.5" ry="27"/>
<text text-anchor="middle" x="2573" y="-5523.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2573" y="-5508.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_2_4&#45;&gt;ffn_gelu_2_4 -->
<g id="edge458" class="edge">
<title>ffn_up_2_4&#45;&gt;ffn_gelu_2_4</title>
<path fill="none" stroke="black" d="M2573,-5619.98C2573,-5619.98 2573,-5557.36 2573,-5557.36"/>
<polygon fill="black" stroke="black" points="2576.5,-5557.36 2573,-5547.36 2569.5,-5557.36 2576.5,-5557.36"/>
</g>
<!-- ffn_down_2_4 -->
<g id="node464" class="node">
<title>ffn_down_2_4</title>
<polygon fill="none" stroke="black" points="2662,-5420 2484,-5420 2484,-5367 2662,-5367 2662,-5420"/>
<text text-anchor="middle" x="2573" y="-5404.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2573" y="-5389.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="2573" y="-5374.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_2_4&#45;&gt;ffn_down_2_4 -->
<g id="edge459" class="edge">
<title>ffn_gelu_2_4&#45;&gt;ffn_down_2_4</title>
<path fill="none" stroke="black" d="M2573,-5492.86C2573,-5492.86 2573,-5430.16 2573,-5430.16"/>
<polygon fill="black" stroke="black" points="2576.5,-5430.16 2573,-5420.16 2569.5,-5430.16 2576.5,-5430.16"/>
</g>
<!-- ffn_residual_2_4 -->
<g id="node465" class="node">
<title>ffn_residual_2_4</title>
<ellipse fill="none" stroke="black" cx="2573" cy="-5267" rx="105.5" ry="27"/>
<text text-anchor="middle" x="2573" y="-5270.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="2573" y="-5255.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_2_4&#45;&gt;ffn_residual_2_4 -->
<g id="edge460" class="edge">
<title>ffn_down_2_4&#45;&gt;ffn_residual_2_4</title>
<path fill="none" stroke="black" d="M2573,-5366.98C2573,-5366.98 2573,-5304.36 2573,-5304.36"/>
<polygon fill="black" stroke="black" points="2576.5,-5304.36 2573,-5294.36 2569.5,-5304.36 2576.5,-5304.36"/>
</g>
<!-- qkv_proj_3_4 -->
<g id="node466" class="node">
<title>qkv_proj_3_4</title>
<polygon fill="none" stroke="black" points="2655.5,-5167 2490.5,-5167 2490.5,-5114 2655.5,-5114 2655.5,-5167"/>
<text text-anchor="middle" x="2573" y="-5151.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2573" y="-5136.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="2573" y="-5121.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_2_4&#45;&gt;qkv_proj_3_4 -->
<g id="edge461" class="edge">
<title>ffn_residual_2_4&#45;&gt;qkv_proj_3_4</title>
<path fill="none" stroke="black" d="M2573,-5239.86C2573,-5239.86 2573,-5177.16 2573,-5177.16"/>
<polygon fill="black" stroke="black" points="2576.5,-5177.16 2573,-5167.16 2569.5,-5177.16 2576.5,-5177.16"/>
</g>
<!-- qkv_reshape_3_4 -->
<g id="node467" class="node">
<title>qkv_reshape_3_4</title>
<ellipse fill="none" stroke="black" cx="2573" cy="-5014" rx="148" ry="27"/>
<text text-anchor="middle" x="2573" y="-5017.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="2573" y="-5002.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_3_4&#45;&gt;qkv_reshape_3_4 -->
<g id="edge462" class="edge">
<title>qkv_proj_3_4&#45;&gt;qkv_reshape_3_4</title>
<path fill="none" stroke="black" d="M2573,-5113.98C2573,-5113.98 2573,-5051.36 2573,-5051.36"/>
<polygon fill="black" stroke="black" points="2576.5,-5051.36 2573,-5041.36 2569.5,-5051.36 2576.5,-5051.36"/>
</g>
<!-- qkv_reshape_3_4&#45;&gt;ring_attn_3_4_stage_0 -->
<g id="edge463" class="edge">
<title>qkv_reshape_3_4&#45;&gt;ring_attn_3_4_stage_0</title>
<path fill="none" stroke="black" d="M2573,-4986.72C2573,-4986.72 2573,-4880.16 2573,-4880.16"/>
<polygon fill="black" stroke="black" points="2576.5,-4880.16 2573,-4870.16 2569.5,-4880.16 2576.5,-4880.16"/>
</g>
<!-- ring_attn_3_4_stage_0&#45;&gt;ring_attn_3_4_stage_1 -->
<g id="edge464" class="edge">
<title>ring_attn_3_4_stage_0&#45;&gt;ring_attn_3_4_stage_1</title>
<path fill="none" stroke="black" d="M2573,-4733.87C2573,-4733.87 2573,-4627.25 2573,-4627.25"/>
<polygon fill="black" stroke="black" points="2576.5,-4627.25 2573,-4617.25 2569.5,-4627.25 2576.5,-4627.25"/>
</g>
<!-- ring_attn_3_5_stage_0 -->
<g id="node566" class="node">
<title>ring_attn_3_5_stage_0</title>
<polygon fill="yellow" stroke="black" points="3160,-4870 2951,-4802 3160,-4734 3369,-4802 3160,-4870"/>
<text text-anchor="middle" x="3160" y="-4820.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-4805.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="3160" y="-4790.8" font-family="Times,serif" font-size="14.00">Q[5]×K[5]×V[5]</text>
<text text-anchor="middle" x="3160" y="-4775.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_4_stage_0&#45;&gt;ring_attn_3_5_stage_0 -->
<g id="edge1857" class="edge">
<title>ring_attn_3_4_stage_0&#45;&gt;ring_attn_3_5_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-4802C2782.02,-4802 2940.86,-4802 2940.86,-4802"/>
<polygon fill="red" stroke="red" points="2940.86,-4805.5 2950.86,-4802 2940.86,-4798.5 2940.86,-4805.5"/>
</g>
<!-- ring_attn_3_4_stage_1&#45;&gt;ring_attn_3_4_stage_2 -->
<g id="edge465" class="edge">
<title>ring_attn_3_4_stage_1&#45;&gt;ring_attn_3_4_stage_2</title>
<path fill="none" stroke="black" d="M2573,-4480.87C2573,-4480.87 2573,-4374.25 2573,-4374.25"/>
<polygon fill="black" stroke="black" points="2576.5,-4374.25 2573,-4364.25 2569.5,-4374.25 2576.5,-4374.25"/>
</g>
<!-- ring_attn_3_5_stage_1 -->
<g id="node567" class="node">
<title>ring_attn_3_5_stage_1</title>
<polygon fill="yellow" stroke="black" points="3160,-4617 2951,-4549 3160,-4481 3369,-4549 3160,-4617"/>
<text text-anchor="middle" x="3160" y="-4567.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-4552.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="3160" y="-4537.8" font-family="Times,serif" font-size="14.00">Q[5]×K[4]×V[4]</text>
<text text-anchor="middle" x="3160" y="-4522.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_4_stage_1&#45;&gt;ring_attn_3_5_stage_1 -->
<g id="edge1858" class="edge">
<title>ring_attn_3_4_stage_1&#45;&gt;ring_attn_3_5_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-4549C2782.02,-4549 2940.86,-4549 2940.86,-4549"/>
<polygon fill="red" stroke="red" points="2940.86,-4552.5 2950.86,-4549 2940.86,-4545.5 2940.86,-4552.5"/>
</g>
<!-- ring_attn_3_4_stage_2&#45;&gt;ring_attn_3_4_stage_3 -->
<g id="edge466" class="edge">
<title>ring_attn_3_4_stage_2&#45;&gt;ring_attn_3_4_stage_3</title>
<path fill="none" stroke="black" d="M2573,-4227.87C2573,-4227.87 2573,-4121.25 2573,-4121.25"/>
<polygon fill="black" stroke="black" points="2576.5,-4121.25 2573,-4111.25 2569.5,-4121.25 2576.5,-4121.25"/>
</g>
<!-- ring_attn_3_5_stage_2 -->
<g id="node568" class="node">
<title>ring_attn_3_5_stage_2</title>
<polygon fill="yellow" stroke="black" points="3160,-4364 2951,-4296 3160,-4228 3369,-4296 3160,-4364"/>
<text text-anchor="middle" x="3160" y="-4314.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-4299.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="3160" y="-4284.8" font-family="Times,serif" font-size="14.00">Q[5]×K[3]×V[3]</text>
<text text-anchor="middle" x="3160" y="-4269.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_4_stage_2&#45;&gt;ring_attn_3_5_stage_2 -->
<g id="edge1859" class="edge">
<title>ring_attn_3_4_stage_2&#45;&gt;ring_attn_3_5_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-4296C2782.02,-4296 2940.86,-4296 2940.86,-4296"/>
<polygon fill="red" stroke="red" points="2940.86,-4299.5 2950.86,-4296 2940.86,-4292.5 2940.86,-4299.5"/>
</g>
<!-- ring_attn_3_4_stage_3&#45;&gt;ring_attn_3_4_stage_4 -->
<g id="edge467" class="edge">
<title>ring_attn_3_4_stage_3&#45;&gt;ring_attn_3_4_stage_4</title>
<path fill="none" stroke="black" d="M2573,-3974.87C2573,-3974.87 2573,-3868.25 2573,-3868.25"/>
<polygon fill="black" stroke="black" points="2576.5,-3868.25 2573,-3858.25 2569.5,-3868.25 2576.5,-3868.25"/>
</g>
<!-- ring_attn_3_5_stage_3 -->
<g id="node569" class="node">
<title>ring_attn_3_5_stage_3</title>
<polygon fill="yellow" stroke="black" points="3160,-4111 2951,-4043 3160,-3975 3369,-4043 3160,-4111"/>
<text text-anchor="middle" x="3160" y="-4061.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-4046.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="3160" y="-4031.8" font-family="Times,serif" font-size="14.00">Q[5]×K[2]×V[2]</text>
<text text-anchor="middle" x="3160" y="-4016.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_4_stage_3&#45;&gt;ring_attn_3_5_stage_3 -->
<g id="edge1860" class="edge">
<title>ring_attn_3_4_stage_3&#45;&gt;ring_attn_3_5_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-4043C2782.02,-4043 2940.86,-4043 2940.86,-4043"/>
<polygon fill="red" stroke="red" points="2940.86,-4046.5 2950.86,-4043 2940.86,-4039.5 2940.86,-4046.5"/>
</g>
<!-- ring_attn_3_4_stage_4&#45;&gt;ring_attn_3_4_stage_5 -->
<g id="edge468" class="edge">
<title>ring_attn_3_4_stage_4&#45;&gt;ring_attn_3_4_stage_5</title>
<path fill="none" stroke="black" d="M2573,-3721.87C2573,-3721.87 2573,-3615.25 2573,-3615.25"/>
<polygon fill="black" stroke="black" points="2576.5,-3615.25 2573,-3605.25 2569.5,-3615.25 2576.5,-3615.25"/>
</g>
<!-- ring_attn_3_5_stage_4 -->
<g id="node570" class="node">
<title>ring_attn_3_5_stage_4</title>
<polygon fill="yellow" stroke="black" points="3160,-3858 2951,-3790 3160,-3722 3369,-3790 3160,-3858"/>
<text text-anchor="middle" x="3160" y="-3808.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-3793.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="3160" y="-3778.8" font-family="Times,serif" font-size="14.00">Q[5]×K[1]×V[1]</text>
<text text-anchor="middle" x="3160" y="-3763.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_4_stage_4&#45;&gt;ring_attn_3_5_stage_4 -->
<g id="edge1861" class="edge">
<title>ring_attn_3_4_stage_4&#45;&gt;ring_attn_3_5_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-3790C2782.02,-3790 2940.86,-3790 2940.86,-3790"/>
<polygon fill="red" stroke="red" points="2940.86,-3793.5 2950.86,-3790 2940.86,-3786.5 2940.86,-3793.5"/>
</g>
<!-- ring_attn_3_4_stage_5&#45;&gt;ring_attn_3_4_stage_6 -->
<g id="edge469" class="edge">
<title>ring_attn_3_4_stage_5&#45;&gt;ring_attn_3_4_stage_6</title>
<path fill="none" stroke="black" d="M2573,-3468.87C2573,-3468.87 2573,-3362.25 2573,-3362.25"/>
<polygon fill="black" stroke="black" points="2576.5,-3362.25 2573,-3352.25 2569.5,-3362.25 2576.5,-3362.25"/>
</g>
<!-- ring_attn_3_5_stage_5 -->
<g id="node571" class="node">
<title>ring_attn_3_5_stage_5</title>
<polygon fill="yellow" stroke="black" points="3160,-3605 2951,-3537 3160,-3469 3369,-3537 3160,-3605"/>
<text text-anchor="middle" x="3160" y="-3555.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-3540.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="3160" y="-3525.8" font-family="Times,serif" font-size="14.00">Q[5]×K[0]×V[0]</text>
<text text-anchor="middle" x="3160" y="-3510.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_4_stage_5&#45;&gt;ring_attn_3_5_stage_5 -->
<g id="edge1862" class="edge">
<title>ring_attn_3_4_stage_5&#45;&gt;ring_attn_3_5_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-3537C2782.02,-3537 2940.86,-3537 2940.86,-3537"/>
<polygon fill="red" stroke="red" points="2940.86,-3540.5 2950.86,-3537 2940.86,-3533.5 2940.86,-3540.5"/>
</g>
<!-- ring_attn_3_4_stage_6&#45;&gt;ring_attn_3_4_stage_7 -->
<g id="edge470" class="edge">
<title>ring_attn_3_4_stage_6&#45;&gt;ring_attn_3_4_stage_7</title>
<path fill="none" stroke="black" d="M2573,-3215.87C2573,-3215.87 2573,-3109.25 2573,-3109.25"/>
<polygon fill="black" stroke="black" points="2576.5,-3109.25 2573,-3099.25 2569.5,-3109.25 2576.5,-3109.25"/>
</g>
<!-- ring_attn_3_5_stage_6 -->
<g id="node572" class="node">
<title>ring_attn_3_5_stage_6</title>
<polygon fill="yellow" stroke="black" points="3160,-3352 2951,-3284 3160,-3216 3369,-3284 3160,-3352"/>
<text text-anchor="middle" x="3160" y="-3302.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-3287.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="3160" y="-3272.8" font-family="Times,serif" font-size="14.00">Q[5]×K[15]×V[15]</text>
<text text-anchor="middle" x="3160" y="-3257.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_4_stage_6&#45;&gt;ring_attn_3_5_stage_6 -->
<g id="edge1863" class="edge">
<title>ring_attn_3_4_stage_6&#45;&gt;ring_attn_3_5_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-3284C2782.02,-3284 2940.86,-3284 2940.86,-3284"/>
<polygon fill="red" stroke="red" points="2940.86,-3287.5 2950.86,-3284 2940.86,-3280.5 2940.86,-3287.5"/>
</g>
<!-- ring_attn_3_4_stage_7&#45;&gt;ring_attn_3_4_stage_8 -->
<g id="edge471" class="edge">
<title>ring_attn_3_4_stage_7&#45;&gt;ring_attn_3_4_stage_8</title>
<path fill="none" stroke="black" d="M2573,-2962.87C2573,-2962.87 2573,-2856.25 2573,-2856.25"/>
<polygon fill="black" stroke="black" points="2576.5,-2856.25 2573,-2846.25 2569.5,-2856.25 2576.5,-2856.25"/>
</g>
<!-- ring_attn_3_5_stage_7 -->
<g id="node573" class="node">
<title>ring_attn_3_5_stage_7</title>
<polygon fill="yellow" stroke="black" points="3160,-3099 2951,-3031 3160,-2963 3369,-3031 3160,-3099"/>
<text text-anchor="middle" x="3160" y="-3049.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-3034.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="3160" y="-3019.8" font-family="Times,serif" font-size="14.00">Q[5]×K[14]×V[14]</text>
<text text-anchor="middle" x="3160" y="-3004.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_4_stage_7&#45;&gt;ring_attn_3_5_stage_7 -->
<g id="edge1864" class="edge">
<title>ring_attn_3_4_stage_7&#45;&gt;ring_attn_3_5_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-3031C2782.02,-3031 2940.86,-3031 2940.86,-3031"/>
<polygon fill="red" stroke="red" points="2940.86,-3034.5 2950.86,-3031 2940.86,-3027.5 2940.86,-3034.5"/>
</g>
<!-- ring_attn_3_4_stage_8&#45;&gt;ring_attn_3_4_stage_9 -->
<g id="edge472" class="edge">
<title>ring_attn_3_4_stage_8&#45;&gt;ring_attn_3_4_stage_9</title>
<path fill="none" stroke="black" d="M2573,-2709.87C2573,-2709.87 2573,-2603.25 2573,-2603.25"/>
<polygon fill="black" stroke="black" points="2576.5,-2603.25 2573,-2593.25 2569.5,-2603.25 2576.5,-2603.25"/>
</g>
<!-- ring_attn_3_5_stage_8 -->
<g id="node574" class="node">
<title>ring_attn_3_5_stage_8</title>
<polygon fill="yellow" stroke="black" points="3160,-2846 2951,-2778 3160,-2710 3369,-2778 3160,-2846"/>
<text text-anchor="middle" x="3160" y="-2796.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-2781.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="3160" y="-2766.8" font-family="Times,serif" font-size="14.00">Q[5]×K[13]×V[13]</text>
<text text-anchor="middle" x="3160" y="-2751.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_4_stage_8&#45;&gt;ring_attn_3_5_stage_8 -->
<g id="edge1865" class="edge">
<title>ring_attn_3_4_stage_8&#45;&gt;ring_attn_3_5_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-2778C2782.02,-2778 2940.86,-2778 2940.86,-2778"/>
<polygon fill="red" stroke="red" points="2940.86,-2781.5 2950.86,-2778 2940.86,-2774.5 2940.86,-2781.5"/>
</g>
<!-- ring_attn_3_4_stage_9&#45;&gt;ring_attn_3_4_stage_10 -->
<g id="edge473" class="edge">
<title>ring_attn_3_4_stage_9&#45;&gt;ring_attn_3_4_stage_10</title>
<path fill="none" stroke="black" d="M2573,-2456.87C2573,-2456.87 2573,-2350.25 2573,-2350.25"/>
<polygon fill="black" stroke="black" points="2576.5,-2350.25 2573,-2340.25 2569.5,-2350.25 2576.5,-2350.25"/>
</g>
<!-- ring_attn_3_5_stage_9 -->
<g id="node575" class="node">
<title>ring_attn_3_5_stage_9</title>
<polygon fill="yellow" stroke="black" points="3160,-2593 2951,-2525 3160,-2457 3369,-2525 3160,-2593"/>
<text text-anchor="middle" x="3160" y="-2543.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-2528.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="3160" y="-2513.8" font-family="Times,serif" font-size="14.00">Q[5]×K[12]×V[12]</text>
<text text-anchor="middle" x="3160" y="-2498.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_4_stage_9&#45;&gt;ring_attn_3_5_stage_9 -->
<g id="edge1866" class="edge">
<title>ring_attn_3_4_stage_9&#45;&gt;ring_attn_3_5_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-2525C2782.02,-2525 2940.86,-2525 2940.86,-2525"/>
<polygon fill="red" stroke="red" points="2940.86,-2528.5 2950.86,-2525 2940.86,-2521.5 2940.86,-2528.5"/>
</g>
<!-- ring_attn_3_4_stage_10&#45;&gt;ring_attn_3_4_stage_11 -->
<g id="edge474" class="edge">
<title>ring_attn_3_4_stage_10&#45;&gt;ring_attn_3_4_stage_11</title>
<path fill="none" stroke="black" d="M2573,-2203.87C2573,-2203.87 2573,-2097.25 2573,-2097.25"/>
<polygon fill="black" stroke="black" points="2576.5,-2097.25 2573,-2087.25 2569.5,-2097.25 2576.5,-2097.25"/>
</g>
<!-- ring_attn_3_5_stage_10 -->
<g id="node576" class="node">
<title>ring_attn_3_5_stage_10</title>
<polygon fill="yellow" stroke="black" points="3160,-2340 2951,-2272 3160,-2204 3369,-2272 3160,-2340"/>
<text text-anchor="middle" x="3160" y="-2290.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-2275.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="3160" y="-2260.8" font-family="Times,serif" font-size="14.00">Q[5]×K[11]×V[11]</text>
<text text-anchor="middle" x="3160" y="-2245.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_4_stage_10&#45;&gt;ring_attn_3_5_stage_10 -->
<g id="edge1867" class="edge">
<title>ring_attn_3_4_stage_10&#45;&gt;ring_attn_3_5_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-2272C2782.02,-2272 2940.86,-2272 2940.86,-2272"/>
<polygon fill="red" stroke="red" points="2940.86,-2275.5 2950.86,-2272 2940.86,-2268.5 2940.86,-2275.5"/>
</g>
<!-- ring_attn_3_4_stage_11&#45;&gt;ring_attn_3_4_stage_12 -->
<g id="edge475" class="edge">
<title>ring_attn_3_4_stage_11&#45;&gt;ring_attn_3_4_stage_12</title>
<path fill="none" stroke="black" d="M2573,-1950.87C2573,-1950.87 2573,-1844.25 2573,-1844.25"/>
<polygon fill="black" stroke="black" points="2576.5,-1844.25 2573,-1834.25 2569.5,-1844.25 2576.5,-1844.25"/>
</g>
<!-- ring_attn_3_5_stage_11 -->
<g id="node577" class="node">
<title>ring_attn_3_5_stage_11</title>
<polygon fill="yellow" stroke="black" points="3160,-2087 2951,-2019 3160,-1951 3369,-2019 3160,-2087"/>
<text text-anchor="middle" x="3160" y="-2037.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-2022.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="3160" y="-2007.8" font-family="Times,serif" font-size="14.00">Q[5]×K[10]×V[10]</text>
<text text-anchor="middle" x="3160" y="-1992.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_4_stage_11&#45;&gt;ring_attn_3_5_stage_11 -->
<g id="edge1868" class="edge">
<title>ring_attn_3_4_stage_11&#45;&gt;ring_attn_3_5_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-2019C2782.02,-2019 2940.86,-2019 2940.86,-2019"/>
<polygon fill="red" stroke="red" points="2940.86,-2022.5 2950.86,-2019 2940.86,-2015.5 2940.86,-2022.5"/>
</g>
<!-- ring_attn_3_4_stage_12&#45;&gt;ring_attn_3_4_stage_13 -->
<g id="edge476" class="edge">
<title>ring_attn_3_4_stage_12&#45;&gt;ring_attn_3_4_stage_13</title>
<path fill="none" stroke="black" d="M2573,-1697.87C2573,-1697.87 2573,-1591.25 2573,-1591.25"/>
<polygon fill="black" stroke="black" points="2576.5,-1591.25 2573,-1581.25 2569.5,-1591.25 2576.5,-1591.25"/>
</g>
<!-- ring_attn_3_5_stage_12 -->
<g id="node578" class="node">
<title>ring_attn_3_5_stage_12</title>
<polygon fill="yellow" stroke="black" points="3160,-1834 2951,-1766 3160,-1698 3369,-1766 3160,-1834"/>
<text text-anchor="middle" x="3160" y="-1784.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-1769.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="3160" y="-1754.8" font-family="Times,serif" font-size="14.00">Q[5]×K[9]×V[9]</text>
<text text-anchor="middle" x="3160" y="-1739.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_4_stage_12&#45;&gt;ring_attn_3_5_stage_12 -->
<g id="edge1869" class="edge">
<title>ring_attn_3_4_stage_12&#45;&gt;ring_attn_3_5_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-1766C2782.02,-1766 2940.86,-1766 2940.86,-1766"/>
<polygon fill="red" stroke="red" points="2940.86,-1769.5 2950.86,-1766 2940.86,-1762.5 2940.86,-1769.5"/>
</g>
<!-- ring_attn_3_4_stage_13&#45;&gt;ring_attn_3_4_stage_14 -->
<g id="edge477" class="edge">
<title>ring_attn_3_4_stage_13&#45;&gt;ring_attn_3_4_stage_14</title>
<path fill="none" stroke="black" d="M2573,-1444.87C2573,-1444.87 2573,-1338.25 2573,-1338.25"/>
<polygon fill="black" stroke="black" points="2576.5,-1338.25 2573,-1328.25 2569.5,-1338.25 2576.5,-1338.25"/>
</g>
<!-- ring_attn_3_5_stage_13 -->
<g id="node579" class="node">
<title>ring_attn_3_5_stage_13</title>
<polygon fill="yellow" stroke="black" points="3160,-1581 2951,-1513 3160,-1445 3369,-1513 3160,-1581"/>
<text text-anchor="middle" x="3160" y="-1531.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-1516.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="3160" y="-1501.8" font-family="Times,serif" font-size="14.00">Q[5]×K[8]×V[8]</text>
<text text-anchor="middle" x="3160" y="-1486.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_4_stage_13&#45;&gt;ring_attn_3_5_stage_13 -->
<g id="edge1870" class="edge">
<title>ring_attn_3_4_stage_13&#45;&gt;ring_attn_3_5_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-1513C2782.02,-1513 2940.86,-1513 2940.86,-1513"/>
<polygon fill="red" stroke="red" points="2940.86,-1516.5 2950.86,-1513 2940.86,-1509.5 2940.86,-1516.5"/>
</g>
<!-- ring_attn_3_4_stage_14&#45;&gt;ring_attn_3_4_stage_15 -->
<g id="edge478" class="edge">
<title>ring_attn_3_4_stage_14&#45;&gt;ring_attn_3_4_stage_15</title>
<path fill="none" stroke="black" d="M2573,-1191.87C2573,-1191.87 2573,-1085.25 2573,-1085.25"/>
<polygon fill="black" stroke="black" points="2576.5,-1085.25 2573,-1075.25 2569.5,-1085.25 2576.5,-1085.25"/>
</g>
<!-- ring_attn_3_5_stage_14 -->
<g id="node580" class="node">
<title>ring_attn_3_5_stage_14</title>
<polygon fill="yellow" stroke="black" points="3160,-1328 2951,-1260 3160,-1192 3369,-1260 3160,-1328"/>
<text text-anchor="middle" x="3160" y="-1278.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-1263.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="3160" y="-1248.8" font-family="Times,serif" font-size="14.00">Q[5]×K[7]×V[7]</text>
<text text-anchor="middle" x="3160" y="-1233.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_4_stage_14&#45;&gt;ring_attn_3_5_stage_14 -->
<g id="edge1871" class="edge">
<title>ring_attn_3_4_stage_14&#45;&gt;ring_attn_3_5_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-1260C2782.02,-1260 2940.86,-1260 2940.86,-1260"/>
<polygon fill="red" stroke="red" points="2940.86,-1263.5 2950.86,-1260 2940.86,-1256.5 2940.86,-1263.5"/>
</g>
<!-- attn_out_3_4 -->
<g id="node484" class="node">
<title>attn_out_3_4</title>
<polygon fill="none" stroke="black" points="2642.5,-866 2503.5,-866 2503.5,-813 2642.5,-813 2642.5,-866"/>
<text text-anchor="middle" x="2573" y="-850.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2573" y="-835.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="2573" y="-820.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_3_4_stage_15&#45;&gt;attn_out_3_4 -->
<g id="edge479" class="edge">
<title>ring_attn_3_4_stage_15&#45;&gt;attn_out_3_4</title>
<path fill="none" stroke="black" d="M2573,-938.87C2573,-938.87 2573,-876.18 2573,-876.18"/>
<polygon fill="black" stroke="black" points="2576.5,-876.18 2573,-866.18 2569.5,-876.18 2576.5,-876.18"/>
</g>
<!-- ring_attn_3_5_stage_15 -->
<g id="node581" class="node">
<title>ring_attn_3_5_stage_15</title>
<polygon fill="yellow" stroke="black" points="3160,-1075 2951,-1007 3160,-939 3369,-1007 3160,-1075"/>
<text text-anchor="middle" x="3160" y="-1025.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3160" y="-1010.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="3160" y="-995.8" font-family="Times,serif" font-size="14.00">Q[5]×K[6]×V[6]</text>
<text text-anchor="middle" x="3160" y="-980.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_4_stage_15&#45;&gt;ring_attn_3_5_stage_15 -->
<g id="edge1872" class="edge">
<title>ring_attn_3_4_stage_15&#45;&gt;ring_attn_3_5_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2782.02,-1007C2782.02,-1007 2940.86,-1007 2940.86,-1007"/>
<polygon fill="red" stroke="red" points="2940.86,-1010.5 2950.86,-1007 2940.86,-1003.5 2940.86,-1010.5"/>
</g>
<!-- attn_residual_3_4 -->
<g id="node485" class="node">
<title>attn_residual_3_4</title>
<ellipse fill="none" stroke="black" cx="2573" cy="-713" rx="105.5" ry="27"/>
<text text-anchor="middle" x="2573" y="-716.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="2573" y="-701.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_3_4&#45;&gt;attn_residual_3_4 -->
<g id="edge480" class="edge">
<title>attn_out_3_4&#45;&gt;attn_residual_3_4</title>
<path fill="none" stroke="black" d="M2573,-812.98C2573,-812.98 2573,-750.36 2573,-750.36"/>
<polygon fill="black" stroke="black" points="2576.5,-750.36 2573,-740.36 2569.5,-750.36 2576.5,-750.36"/>
</g>
<!-- ffn_up_3_4 -->
<g id="node486" class="node">
<title>ffn_up_3_4</title>
<polygon fill="none" stroke="black" points="2652,-613 2494,-613 2494,-560 2652,-560 2652,-613"/>
<text text-anchor="middle" x="2573" y="-597.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2573" y="-582.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="2573" y="-567.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_3_4&#45;&gt;ffn_up_3_4 -->
<g id="edge481" class="edge">
<title>attn_residual_3_4&#45;&gt;ffn_up_3_4</title>
<path fill="none" stroke="black" d="M2573,-685.86C2573,-685.86 2573,-623.16 2573,-623.16"/>
<polygon fill="black" stroke="black" points="2576.5,-623.16 2573,-613.16 2569.5,-623.16 2576.5,-623.16"/>
</g>
<!-- ffn_gelu_3_4 -->
<g id="node487" class="node">
<title>ffn_gelu_3_4</title>
<ellipse fill="none" stroke="black" cx="2573" cy="-460" rx="105.5" ry="27"/>
<text text-anchor="middle" x="2573" y="-463.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2573" y="-448.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_3_4&#45;&gt;ffn_gelu_3_4 -->
<g id="edge482" class="edge">
<title>ffn_up_3_4&#45;&gt;ffn_gelu_3_4</title>
<path fill="none" stroke="black" d="M2573,-559.98C2573,-559.98 2573,-497.36 2573,-497.36"/>
<polygon fill="black" stroke="black" points="2576.5,-497.36 2573,-487.36 2569.5,-497.36 2576.5,-497.36"/>
</g>
<!-- ffn_down_3_4 -->
<g id="node488" class="node">
<title>ffn_down_3_4</title>
<polygon fill="none" stroke="black" points="2662,-360 2484,-360 2484,-307 2662,-307 2662,-360"/>
<text text-anchor="middle" x="2573" y="-344.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2573" y="-329.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="2573" y="-314.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_3_4&#45;&gt;ffn_down_3_4 -->
<g id="edge483" class="edge">
<title>ffn_gelu_3_4&#45;&gt;ffn_down_3_4</title>
<path fill="none" stroke="black" d="M2573,-432.86C2573,-432.86 2573,-370.16 2573,-370.16"/>
<polygon fill="black" stroke="black" points="2576.5,-370.16 2573,-360.16 2569.5,-370.16 2576.5,-370.16"/>
</g>
<!-- ffn_residual_3_4 -->
<g id="node489" class="node">
<title>ffn_residual_3_4</title>
<ellipse fill="none" stroke="black" cx="2573" cy="-207" rx="105.5" ry="27"/>
<text text-anchor="middle" x="2573" y="-210.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="2573" y="-195.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_3_4&#45;&gt;ffn_residual_3_4 -->
<g id="edge484" class="edge">
<title>ffn_down_3_4&#45;&gt;ffn_residual_3_4</title>
<path fill="none" stroke="black" d="M2573,-306.98C2573,-306.98 2573,-244.36 2573,-244.36"/>
<polygon fill="black" stroke="black" points="2576.5,-244.36 2573,-234.36 2569.5,-244.36 2576.5,-244.36"/>
</g>
<!-- output_4 -->
<g id="node490" class="node">
<title>output_4</title>
<polygon fill="lightcoral" stroke="black" points="2666,-107 2480,-107 2480,-69 2666,-69 2666,-107"/>
<text text-anchor="middle" x="2573" y="-91.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="2573" y="-76.8" font-family="Times,serif" font-size="14.00">Y[4]: 1024×1024×4096</text>
</g>
<!-- ffn_residual_3_4&#45;&gt;output_4 -->
<g id="edge485" class="edge">
<title>ffn_residual_3_4&#45;&gt;output_4</title>
<path fill="none" stroke="black" d="M2573,-180C2573,-180 2573,-117.12 2573,-117.12"/>
<polygon fill="black" stroke="black" points="2576.5,-117.12 2573,-107.12 2569.5,-117.12 2576.5,-117.12"/>
</g>
<!-- input_5 -->
<g id="node491" class="node">
<title>input_5</title>
<polygon fill="lightgreen" stroke="black" points="3253.5,-20458 3066.5,-20458 3066.5,-20420 3253.5,-20420 3253.5,-20458"/>
<text text-anchor="middle" x="3160" y="-20442.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="3160" y="-20427.8" font-family="Times,serif" font-size="14.00">X[5]: 1024×1024×4096</text>
</g>
<!-- qkv_proj_0_5 -->
<g id="node492" class="node">
<title>qkv_proj_0_5</title>
<polygon fill="none" stroke="black" points="3242.5,-20347 3077.5,-20347 3077.5,-20294 3242.5,-20294 3242.5,-20347"/>
<text text-anchor="middle" x="3160" y="-20331.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3160" y="-20316.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="3160" y="-20301.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- input_5&#45;&gt;qkv_proj_0_5 -->
<g id="edge486" class="edge">
<title>input_5&#45;&gt;qkv_proj_0_5</title>
<path fill="none" stroke="black" d="M3160,-20419.96C3160,-20419.96 3160,-20357.44 3160,-20357.44"/>
<polygon fill="black" stroke="black" points="3163.5,-20357.44 3160,-20347.44 3156.5,-20357.44 3163.5,-20357.44"/>
</g>
<!-- qkv_reshape_0_5 -->
<g id="node493" class="node">
<title>qkv_reshape_0_5</title>
<ellipse fill="none" stroke="black" cx="3160" cy="-20194" rx="148" ry="27"/>
<text text-anchor="middle" x="3160" y="-20197.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="3160" y="-20182.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_0_5&#45;&gt;qkv_reshape_0_5 -->
<g id="edge487" class="edge">
<title>qkv_proj_0_5&#45;&gt;qkv_reshape_0_5</title>
<path fill="none" stroke="black" d="M3160,-20293.98C3160,-20293.98 3160,-20231.36 3160,-20231.36"/>
<polygon fill="black" stroke="black" points="3163.5,-20231.36 3160,-20221.36 3156.5,-20231.36 3163.5,-20231.36"/>
</g>
<!-- qkv_reshape_0_5&#45;&gt;ring_attn_0_5_stage_0 -->
<g id="edge488" class="edge">
<title>qkv_reshape_0_5&#45;&gt;ring_attn_0_5_stage_0</title>
<path fill="none" stroke="black" d="M3160,-20166.72C3160,-20166.72 3160,-20060.16 3160,-20060.16"/>
<polygon fill="black" stroke="black" points="3163.5,-20060.16 3160,-20050.16 3156.5,-20060.16 3163.5,-20060.16"/>
</g>
<!-- ring_attn_0_5_stage_0&#45;&gt;ring_attn_0_5_stage_1 -->
<g id="edge489" class="edge">
<title>ring_attn_0_5_stage_0&#45;&gt;ring_attn_0_5_stage_1</title>
<path fill="none" stroke="black" d="M3160,-19913.87C3160,-19913.87 3160,-19807.25 3160,-19807.25"/>
<polygon fill="black" stroke="black" points="3163.5,-19807.25 3160,-19797.25 3156.5,-19807.25 3163.5,-19807.25"/>
</g>
<!-- ring_attn_0_6_stage_0 -->
<g id="node592" class="node">
<title>ring_attn_0_6_stage_0</title>
<polygon fill="yellow" stroke="black" points="3747,-20050 3538,-19982 3747,-19914 3956,-19982 3747,-20050"/>
<text text-anchor="middle" x="3747" y="-20000.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-19985.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="3747" y="-19970.8" font-family="Times,serif" font-size="14.00">Q[6]×K[6]×V[6]</text>
<text text-anchor="middle" x="3747" y="-19955.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_5_stage_0&#45;&gt;ring_attn_0_6_stage_0 -->
<g id="edge1873" class="edge">
<title>ring_attn_0_5_stage_0&#45;&gt;ring_attn_0_6_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-19982C3369.02,-19982 3527.86,-19982 3527.86,-19982"/>
<polygon fill="red" stroke="red" points="3527.86,-19985.5 3537.86,-19982 3527.86,-19978.5 3527.86,-19985.5"/>
</g>
<!-- ring_attn_0_5_stage_1&#45;&gt;ring_attn_0_5_stage_2 -->
<g id="edge490" class="edge">
<title>ring_attn_0_5_stage_1&#45;&gt;ring_attn_0_5_stage_2</title>
<path fill="none" stroke="black" d="M3160,-19660.87C3160,-19660.87 3160,-19554.25 3160,-19554.25"/>
<polygon fill="black" stroke="black" points="3163.5,-19554.25 3160,-19544.25 3156.5,-19554.25 3163.5,-19554.25"/>
</g>
<!-- ring_attn_0_6_stage_1 -->
<g id="node593" class="node">
<title>ring_attn_0_6_stage_1</title>
<polygon fill="yellow" stroke="black" points="3747,-19797 3538,-19729 3747,-19661 3956,-19729 3747,-19797"/>
<text text-anchor="middle" x="3747" y="-19747.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-19732.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="3747" y="-19717.8" font-family="Times,serif" font-size="14.00">Q[6]×K[5]×V[5]</text>
<text text-anchor="middle" x="3747" y="-19702.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_5_stage_1&#45;&gt;ring_attn_0_6_stage_1 -->
<g id="edge1874" class="edge">
<title>ring_attn_0_5_stage_1&#45;&gt;ring_attn_0_6_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-19729C3369.02,-19729 3527.86,-19729 3527.86,-19729"/>
<polygon fill="red" stroke="red" points="3527.86,-19732.5 3537.86,-19729 3527.86,-19725.5 3527.86,-19732.5"/>
</g>
<!-- ring_attn_0_5_stage_2&#45;&gt;ring_attn_0_5_stage_3 -->
<g id="edge491" class="edge">
<title>ring_attn_0_5_stage_2&#45;&gt;ring_attn_0_5_stage_3</title>
<path fill="none" stroke="black" d="M3160,-19407.87C3160,-19407.87 3160,-19301.25 3160,-19301.25"/>
<polygon fill="black" stroke="black" points="3163.5,-19301.25 3160,-19291.25 3156.5,-19301.25 3163.5,-19301.25"/>
</g>
<!-- ring_attn_0_6_stage_2 -->
<g id="node594" class="node">
<title>ring_attn_0_6_stage_2</title>
<polygon fill="yellow" stroke="black" points="3747,-19544 3538,-19476 3747,-19408 3956,-19476 3747,-19544"/>
<text text-anchor="middle" x="3747" y="-19494.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-19479.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="3747" y="-19464.8" font-family="Times,serif" font-size="14.00">Q[6]×K[4]×V[4]</text>
<text text-anchor="middle" x="3747" y="-19449.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_5_stage_2&#45;&gt;ring_attn_0_6_stage_2 -->
<g id="edge1875" class="edge">
<title>ring_attn_0_5_stage_2&#45;&gt;ring_attn_0_6_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-19476C3369.02,-19476 3527.86,-19476 3527.86,-19476"/>
<polygon fill="red" stroke="red" points="3527.86,-19479.5 3537.86,-19476 3527.86,-19472.5 3527.86,-19479.5"/>
</g>
<!-- ring_attn_0_5_stage_3&#45;&gt;ring_attn_0_5_stage_4 -->
<g id="edge492" class="edge">
<title>ring_attn_0_5_stage_3&#45;&gt;ring_attn_0_5_stage_4</title>
<path fill="none" stroke="black" d="M3160,-19154.87C3160,-19154.87 3160,-19048.25 3160,-19048.25"/>
<polygon fill="black" stroke="black" points="3163.5,-19048.25 3160,-19038.25 3156.5,-19048.25 3163.5,-19048.25"/>
</g>
<!-- ring_attn_0_6_stage_3 -->
<g id="node595" class="node">
<title>ring_attn_0_6_stage_3</title>
<polygon fill="yellow" stroke="black" points="3747,-19291 3538,-19223 3747,-19155 3956,-19223 3747,-19291"/>
<text text-anchor="middle" x="3747" y="-19241.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-19226.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="3747" y="-19211.8" font-family="Times,serif" font-size="14.00">Q[6]×K[3]×V[3]</text>
<text text-anchor="middle" x="3747" y="-19196.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_5_stage_3&#45;&gt;ring_attn_0_6_stage_3 -->
<g id="edge1876" class="edge">
<title>ring_attn_0_5_stage_3&#45;&gt;ring_attn_0_6_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-19223C3369.02,-19223 3527.86,-19223 3527.86,-19223"/>
<polygon fill="red" stroke="red" points="3527.86,-19226.5 3537.86,-19223 3527.86,-19219.5 3527.86,-19226.5"/>
</g>
<!-- ring_attn_0_5_stage_4&#45;&gt;ring_attn_0_5_stage_5 -->
<g id="edge493" class="edge">
<title>ring_attn_0_5_stage_4&#45;&gt;ring_attn_0_5_stage_5</title>
<path fill="none" stroke="black" d="M3160,-18901.87C3160,-18901.87 3160,-18795.25 3160,-18795.25"/>
<polygon fill="black" stroke="black" points="3163.5,-18795.25 3160,-18785.25 3156.5,-18795.25 3163.5,-18795.25"/>
</g>
<!-- ring_attn_0_6_stage_4 -->
<g id="node596" class="node">
<title>ring_attn_0_6_stage_4</title>
<polygon fill="yellow" stroke="black" points="3747,-19038 3538,-18970 3747,-18902 3956,-18970 3747,-19038"/>
<text text-anchor="middle" x="3747" y="-18988.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-18973.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="3747" y="-18958.8" font-family="Times,serif" font-size="14.00">Q[6]×K[2]×V[2]</text>
<text text-anchor="middle" x="3747" y="-18943.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_5_stage_4&#45;&gt;ring_attn_0_6_stage_4 -->
<g id="edge1877" class="edge">
<title>ring_attn_0_5_stage_4&#45;&gt;ring_attn_0_6_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-18970C3369.02,-18970 3527.86,-18970 3527.86,-18970"/>
<polygon fill="red" stroke="red" points="3527.86,-18973.5 3537.86,-18970 3527.86,-18966.5 3527.86,-18973.5"/>
</g>
<!-- ring_attn_0_5_stage_5&#45;&gt;ring_attn_0_5_stage_6 -->
<g id="edge494" class="edge">
<title>ring_attn_0_5_stage_5&#45;&gt;ring_attn_0_5_stage_6</title>
<path fill="none" stroke="black" d="M3160,-18648.87C3160,-18648.87 3160,-18542.25 3160,-18542.25"/>
<polygon fill="black" stroke="black" points="3163.5,-18542.25 3160,-18532.25 3156.5,-18542.25 3163.5,-18542.25"/>
</g>
<!-- ring_attn_0_6_stage_5 -->
<g id="node597" class="node">
<title>ring_attn_0_6_stage_5</title>
<polygon fill="yellow" stroke="black" points="3747,-18785 3538,-18717 3747,-18649 3956,-18717 3747,-18785"/>
<text text-anchor="middle" x="3747" y="-18735.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-18720.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="3747" y="-18705.8" font-family="Times,serif" font-size="14.00">Q[6]×K[1]×V[1]</text>
<text text-anchor="middle" x="3747" y="-18690.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_5_stage_5&#45;&gt;ring_attn_0_6_stage_5 -->
<g id="edge1878" class="edge">
<title>ring_attn_0_5_stage_5&#45;&gt;ring_attn_0_6_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-18717C3369.02,-18717 3527.86,-18717 3527.86,-18717"/>
<polygon fill="red" stroke="red" points="3527.86,-18720.5 3537.86,-18717 3527.86,-18713.5 3527.86,-18720.5"/>
</g>
<!-- ring_attn_0_5_stage_6&#45;&gt;ring_attn_0_5_stage_7 -->
<g id="edge495" class="edge">
<title>ring_attn_0_5_stage_6&#45;&gt;ring_attn_0_5_stage_7</title>
<path fill="none" stroke="black" d="M3160,-18395.87C3160,-18395.87 3160,-18289.25 3160,-18289.25"/>
<polygon fill="black" stroke="black" points="3163.5,-18289.25 3160,-18279.25 3156.5,-18289.25 3163.5,-18289.25"/>
</g>
<!-- ring_attn_0_6_stage_6 -->
<g id="node598" class="node">
<title>ring_attn_0_6_stage_6</title>
<polygon fill="yellow" stroke="black" points="3747,-18532 3538,-18464 3747,-18396 3956,-18464 3747,-18532"/>
<text text-anchor="middle" x="3747" y="-18482.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-18467.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="3747" y="-18452.8" font-family="Times,serif" font-size="14.00">Q[6]×K[0]×V[0]</text>
<text text-anchor="middle" x="3747" y="-18437.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_5_stage_6&#45;&gt;ring_attn_0_6_stage_6 -->
<g id="edge1879" class="edge">
<title>ring_attn_0_5_stage_6&#45;&gt;ring_attn_0_6_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-18464C3369.02,-18464 3527.86,-18464 3527.86,-18464"/>
<polygon fill="red" stroke="red" points="3527.86,-18467.5 3537.86,-18464 3527.86,-18460.5 3527.86,-18467.5"/>
</g>
<!-- ring_attn_0_5_stage_7&#45;&gt;ring_attn_0_5_stage_8 -->
<g id="edge496" class="edge">
<title>ring_attn_0_5_stage_7&#45;&gt;ring_attn_0_5_stage_8</title>
<path fill="none" stroke="black" d="M3160,-18142.87C3160,-18142.87 3160,-18036.25 3160,-18036.25"/>
<polygon fill="black" stroke="black" points="3163.5,-18036.25 3160,-18026.25 3156.5,-18036.25 3163.5,-18036.25"/>
</g>
<!-- ring_attn_0_6_stage_7 -->
<g id="node599" class="node">
<title>ring_attn_0_6_stage_7</title>
<polygon fill="yellow" stroke="black" points="3747,-18279 3538,-18211 3747,-18143 3956,-18211 3747,-18279"/>
<text text-anchor="middle" x="3747" y="-18229.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-18214.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="3747" y="-18199.8" font-family="Times,serif" font-size="14.00">Q[6]×K[15]×V[15]</text>
<text text-anchor="middle" x="3747" y="-18184.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_5_stage_7&#45;&gt;ring_attn_0_6_stage_7 -->
<g id="edge1880" class="edge">
<title>ring_attn_0_5_stage_7&#45;&gt;ring_attn_0_6_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-18211C3369.02,-18211 3527.86,-18211 3527.86,-18211"/>
<polygon fill="red" stroke="red" points="3527.86,-18214.5 3537.86,-18211 3527.86,-18207.5 3527.86,-18214.5"/>
</g>
<!-- ring_attn_0_5_stage_8&#45;&gt;ring_attn_0_5_stage_9 -->
<g id="edge497" class="edge">
<title>ring_attn_0_5_stage_8&#45;&gt;ring_attn_0_5_stage_9</title>
<path fill="none" stroke="black" d="M3160,-17889.87C3160,-17889.87 3160,-17783.25 3160,-17783.25"/>
<polygon fill="black" stroke="black" points="3163.5,-17783.25 3160,-17773.25 3156.5,-17783.25 3163.5,-17783.25"/>
</g>
<!-- ring_attn_0_6_stage_8 -->
<g id="node600" class="node">
<title>ring_attn_0_6_stage_8</title>
<polygon fill="yellow" stroke="black" points="3747,-18026 3538,-17958 3747,-17890 3956,-17958 3747,-18026"/>
<text text-anchor="middle" x="3747" y="-17976.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-17961.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="3747" y="-17946.8" font-family="Times,serif" font-size="14.00">Q[6]×K[14]×V[14]</text>
<text text-anchor="middle" x="3747" y="-17931.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_5_stage_8&#45;&gt;ring_attn_0_6_stage_8 -->
<g id="edge1881" class="edge">
<title>ring_attn_0_5_stage_8&#45;&gt;ring_attn_0_6_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-17958C3369.02,-17958 3527.86,-17958 3527.86,-17958"/>
<polygon fill="red" stroke="red" points="3527.86,-17961.5 3537.86,-17958 3527.86,-17954.5 3527.86,-17961.5"/>
</g>
<!-- ring_attn_0_5_stage_9&#45;&gt;ring_attn_0_5_stage_10 -->
<g id="edge498" class="edge">
<title>ring_attn_0_5_stage_9&#45;&gt;ring_attn_0_5_stage_10</title>
<path fill="none" stroke="black" d="M3160,-17636.87C3160,-17636.87 3160,-17530.25 3160,-17530.25"/>
<polygon fill="black" stroke="black" points="3163.5,-17530.25 3160,-17520.25 3156.5,-17530.25 3163.5,-17530.25"/>
</g>
<!-- ring_attn_0_6_stage_9 -->
<g id="node601" class="node">
<title>ring_attn_0_6_stage_9</title>
<polygon fill="yellow" stroke="black" points="3747,-17773 3538,-17705 3747,-17637 3956,-17705 3747,-17773"/>
<text text-anchor="middle" x="3747" y="-17723.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-17708.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="3747" y="-17693.8" font-family="Times,serif" font-size="14.00">Q[6]×K[13]×V[13]</text>
<text text-anchor="middle" x="3747" y="-17678.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_5_stage_9&#45;&gt;ring_attn_0_6_stage_9 -->
<g id="edge1882" class="edge">
<title>ring_attn_0_5_stage_9&#45;&gt;ring_attn_0_6_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-17705C3369.02,-17705 3527.86,-17705 3527.86,-17705"/>
<polygon fill="red" stroke="red" points="3527.86,-17708.5 3537.86,-17705 3527.86,-17701.5 3527.86,-17708.5"/>
</g>
<!-- ring_attn_0_5_stage_10&#45;&gt;ring_attn_0_5_stage_11 -->
<g id="edge499" class="edge">
<title>ring_attn_0_5_stage_10&#45;&gt;ring_attn_0_5_stage_11</title>
<path fill="none" stroke="black" d="M3160,-17383.87C3160,-17383.87 3160,-17277.25 3160,-17277.25"/>
<polygon fill="black" stroke="black" points="3163.5,-17277.25 3160,-17267.25 3156.5,-17277.25 3163.5,-17277.25"/>
</g>
<!-- ring_attn_0_6_stage_10 -->
<g id="node602" class="node">
<title>ring_attn_0_6_stage_10</title>
<polygon fill="yellow" stroke="black" points="3747,-17520 3538,-17452 3747,-17384 3956,-17452 3747,-17520"/>
<text text-anchor="middle" x="3747" y="-17470.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-17455.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="3747" y="-17440.8" font-family="Times,serif" font-size="14.00">Q[6]×K[12]×V[12]</text>
<text text-anchor="middle" x="3747" y="-17425.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_5_stage_10&#45;&gt;ring_attn_0_6_stage_10 -->
<g id="edge1883" class="edge">
<title>ring_attn_0_5_stage_10&#45;&gt;ring_attn_0_6_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-17452C3369.02,-17452 3527.86,-17452 3527.86,-17452"/>
<polygon fill="red" stroke="red" points="3527.86,-17455.5 3537.86,-17452 3527.86,-17448.5 3527.86,-17455.5"/>
</g>
<!-- ring_attn_0_5_stage_11&#45;&gt;ring_attn_0_5_stage_12 -->
<g id="edge500" class="edge">
<title>ring_attn_0_5_stage_11&#45;&gt;ring_attn_0_5_stage_12</title>
<path fill="none" stroke="black" d="M3160,-17130.87C3160,-17130.87 3160,-17024.25 3160,-17024.25"/>
<polygon fill="black" stroke="black" points="3163.5,-17024.25 3160,-17014.25 3156.5,-17024.25 3163.5,-17024.25"/>
</g>
<!-- ring_attn_0_6_stage_11 -->
<g id="node603" class="node">
<title>ring_attn_0_6_stage_11</title>
<polygon fill="yellow" stroke="black" points="3747,-17267 3538,-17199 3747,-17131 3956,-17199 3747,-17267"/>
<text text-anchor="middle" x="3747" y="-17217.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-17202.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="3747" y="-17187.8" font-family="Times,serif" font-size="14.00">Q[6]×K[11]×V[11]</text>
<text text-anchor="middle" x="3747" y="-17172.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_5_stage_11&#45;&gt;ring_attn_0_6_stage_11 -->
<g id="edge1884" class="edge">
<title>ring_attn_0_5_stage_11&#45;&gt;ring_attn_0_6_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-17199C3369.02,-17199 3527.86,-17199 3527.86,-17199"/>
<polygon fill="red" stroke="red" points="3527.86,-17202.5 3537.86,-17199 3527.86,-17195.5 3527.86,-17202.5"/>
</g>
<!-- ring_attn_0_5_stage_12&#45;&gt;ring_attn_0_5_stage_13 -->
<g id="edge501" class="edge">
<title>ring_attn_0_5_stage_12&#45;&gt;ring_attn_0_5_stage_13</title>
<path fill="none" stroke="black" d="M3160,-16877.87C3160,-16877.87 3160,-16771.25 3160,-16771.25"/>
<polygon fill="black" stroke="black" points="3163.5,-16771.25 3160,-16761.25 3156.5,-16771.25 3163.5,-16771.25"/>
</g>
<!-- ring_attn_0_6_stage_12 -->
<g id="node604" class="node">
<title>ring_attn_0_6_stage_12</title>
<polygon fill="yellow" stroke="black" points="3747,-17014 3538,-16946 3747,-16878 3956,-16946 3747,-17014"/>
<text text-anchor="middle" x="3747" y="-16964.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-16949.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="3747" y="-16934.8" font-family="Times,serif" font-size="14.00">Q[6]×K[10]×V[10]</text>
<text text-anchor="middle" x="3747" y="-16919.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_5_stage_12&#45;&gt;ring_attn_0_6_stage_12 -->
<g id="edge1885" class="edge">
<title>ring_attn_0_5_stage_12&#45;&gt;ring_attn_0_6_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-16946C3369.02,-16946 3527.86,-16946 3527.86,-16946"/>
<polygon fill="red" stroke="red" points="3527.86,-16949.5 3537.86,-16946 3527.86,-16942.5 3527.86,-16949.5"/>
</g>
<!-- ring_attn_0_5_stage_13&#45;&gt;ring_attn_0_5_stage_14 -->
<g id="edge502" class="edge">
<title>ring_attn_0_5_stage_13&#45;&gt;ring_attn_0_5_stage_14</title>
<path fill="none" stroke="black" d="M3160,-16624.87C3160,-16624.87 3160,-16518.25 3160,-16518.25"/>
<polygon fill="black" stroke="black" points="3163.5,-16518.25 3160,-16508.25 3156.5,-16518.25 3163.5,-16518.25"/>
</g>
<!-- ring_attn_0_6_stage_13 -->
<g id="node605" class="node">
<title>ring_attn_0_6_stage_13</title>
<polygon fill="yellow" stroke="black" points="3747,-16761 3538,-16693 3747,-16625 3956,-16693 3747,-16761"/>
<text text-anchor="middle" x="3747" y="-16711.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-16696.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="3747" y="-16681.8" font-family="Times,serif" font-size="14.00">Q[6]×K[9]×V[9]</text>
<text text-anchor="middle" x="3747" y="-16666.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_5_stage_13&#45;&gt;ring_attn_0_6_stage_13 -->
<g id="edge1886" class="edge">
<title>ring_attn_0_5_stage_13&#45;&gt;ring_attn_0_6_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-16693C3369.02,-16693 3527.86,-16693 3527.86,-16693"/>
<polygon fill="red" stroke="red" points="3527.86,-16696.5 3537.86,-16693 3527.86,-16689.5 3527.86,-16696.5"/>
</g>
<!-- ring_attn_0_5_stage_14&#45;&gt;ring_attn_0_5_stage_15 -->
<g id="edge503" class="edge">
<title>ring_attn_0_5_stage_14&#45;&gt;ring_attn_0_5_stage_15</title>
<path fill="none" stroke="black" d="M3160,-16371.87C3160,-16371.87 3160,-16265.25 3160,-16265.25"/>
<polygon fill="black" stroke="black" points="3163.5,-16265.25 3160,-16255.25 3156.5,-16265.25 3163.5,-16265.25"/>
</g>
<!-- ring_attn_0_6_stage_14 -->
<g id="node606" class="node">
<title>ring_attn_0_6_stage_14</title>
<polygon fill="yellow" stroke="black" points="3747,-16508 3538,-16440 3747,-16372 3956,-16440 3747,-16508"/>
<text text-anchor="middle" x="3747" y="-16458.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-16443.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="3747" y="-16428.8" font-family="Times,serif" font-size="14.00">Q[6]×K[8]×V[8]</text>
<text text-anchor="middle" x="3747" y="-16413.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_5_stage_14&#45;&gt;ring_attn_0_6_stage_14 -->
<g id="edge1887" class="edge">
<title>ring_attn_0_5_stage_14&#45;&gt;ring_attn_0_6_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-16440C3369.02,-16440 3527.86,-16440 3527.86,-16440"/>
<polygon fill="red" stroke="red" points="3527.86,-16443.5 3537.86,-16440 3527.86,-16436.5 3527.86,-16443.5"/>
</g>
<!-- attn_out_0_5 -->
<g id="node510" class="node">
<title>attn_out_0_5</title>
<polygon fill="none" stroke="black" points="3229.5,-16046 3090.5,-16046 3090.5,-15993 3229.5,-15993 3229.5,-16046"/>
<text text-anchor="middle" x="3160" y="-16030.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3160" y="-16015.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="3160" y="-16000.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_0_5_stage_15&#45;&gt;attn_out_0_5 -->
<g id="edge504" class="edge">
<title>ring_attn_0_5_stage_15&#45;&gt;attn_out_0_5</title>
<path fill="none" stroke="black" d="M3160,-16118.87C3160,-16118.87 3160,-16056.18 3160,-16056.18"/>
<polygon fill="black" stroke="black" points="3163.5,-16056.18 3160,-16046.18 3156.5,-16056.18 3163.5,-16056.18"/>
</g>
<!-- ring_attn_0_6_stage_15 -->
<g id="node607" class="node">
<title>ring_attn_0_6_stage_15</title>
<polygon fill="yellow" stroke="black" points="3747,-16255 3538,-16187 3747,-16119 3956,-16187 3747,-16255"/>
<text text-anchor="middle" x="3747" y="-16205.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-16190.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="3747" y="-16175.8" font-family="Times,serif" font-size="14.00">Q[6]×K[7]×V[7]</text>
<text text-anchor="middle" x="3747" y="-16160.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_5_stage_15&#45;&gt;ring_attn_0_6_stage_15 -->
<g id="edge1888" class="edge">
<title>ring_attn_0_5_stage_15&#45;&gt;ring_attn_0_6_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-16187C3369.02,-16187 3527.86,-16187 3527.86,-16187"/>
<polygon fill="red" stroke="red" points="3527.86,-16190.5 3537.86,-16187 3527.86,-16183.5 3527.86,-16190.5"/>
</g>
<!-- attn_residual_0_5 -->
<g id="node511" class="node">
<title>attn_residual_0_5</title>
<ellipse fill="none" stroke="black" cx="3160" cy="-15893" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3160" y="-15896.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3160" y="-15881.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_0_5&#45;&gt;attn_residual_0_5 -->
<g id="edge505" class="edge">
<title>attn_out_0_5&#45;&gt;attn_residual_0_5</title>
<path fill="none" stroke="black" d="M3160,-15992.98C3160,-15992.98 3160,-15930.36 3160,-15930.36"/>
<polygon fill="black" stroke="black" points="3163.5,-15930.36 3160,-15920.36 3156.5,-15930.36 3163.5,-15930.36"/>
</g>
<!-- ffn_up_0_5 -->
<g id="node512" class="node">
<title>ffn_up_0_5</title>
<polygon fill="none" stroke="black" points="3239,-15793 3081,-15793 3081,-15740 3239,-15740 3239,-15793"/>
<text text-anchor="middle" x="3160" y="-15777.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3160" y="-15762.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="3160" y="-15747.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_0_5&#45;&gt;ffn_up_0_5 -->
<g id="edge506" class="edge">
<title>attn_residual_0_5&#45;&gt;ffn_up_0_5</title>
<path fill="none" stroke="black" d="M3160,-15865.86C3160,-15865.86 3160,-15803.16 3160,-15803.16"/>
<polygon fill="black" stroke="black" points="3163.5,-15803.16 3160,-15793.16 3156.5,-15803.16 3163.5,-15803.16"/>
</g>
<!-- ffn_gelu_0_5 -->
<g id="node513" class="node">
<title>ffn_gelu_0_5</title>
<ellipse fill="none" stroke="black" cx="3160" cy="-15640" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3160" y="-15643.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3160" y="-15628.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_0_5&#45;&gt;ffn_gelu_0_5 -->
<g id="edge507" class="edge">
<title>ffn_up_0_5&#45;&gt;ffn_gelu_0_5</title>
<path fill="none" stroke="black" d="M3160,-15739.98C3160,-15739.98 3160,-15677.36 3160,-15677.36"/>
<polygon fill="black" stroke="black" points="3163.5,-15677.36 3160,-15667.36 3156.5,-15677.36 3163.5,-15677.36"/>
</g>
<!-- ffn_down_0_5 -->
<g id="node514" class="node">
<title>ffn_down_0_5</title>
<polygon fill="none" stroke="black" points="3249,-15540 3071,-15540 3071,-15487 3249,-15487 3249,-15540"/>
<text text-anchor="middle" x="3160" y="-15524.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3160" y="-15509.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="3160" y="-15494.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_0_5&#45;&gt;ffn_down_0_5 -->
<g id="edge508" class="edge">
<title>ffn_gelu_0_5&#45;&gt;ffn_down_0_5</title>
<path fill="none" stroke="black" d="M3160,-15612.86C3160,-15612.86 3160,-15550.16 3160,-15550.16"/>
<polygon fill="black" stroke="black" points="3163.5,-15550.16 3160,-15540.16 3156.5,-15550.16 3163.5,-15550.16"/>
</g>
<!-- ffn_residual_0_5 -->
<g id="node515" class="node">
<title>ffn_residual_0_5</title>
<ellipse fill="none" stroke="black" cx="3160" cy="-15387" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3160" y="-15390.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3160" y="-15375.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_0_5&#45;&gt;ffn_residual_0_5 -->
<g id="edge509" class="edge">
<title>ffn_down_0_5&#45;&gt;ffn_residual_0_5</title>
<path fill="none" stroke="black" d="M3160,-15486.98C3160,-15486.98 3160,-15424.36 3160,-15424.36"/>
<polygon fill="black" stroke="black" points="3163.5,-15424.36 3160,-15414.36 3156.5,-15424.36 3163.5,-15424.36"/>
</g>
<!-- qkv_proj_1_5 -->
<g id="node516" class="node">
<title>qkv_proj_1_5</title>
<polygon fill="none" stroke="black" points="3242.5,-15287 3077.5,-15287 3077.5,-15234 3242.5,-15234 3242.5,-15287"/>
<text text-anchor="middle" x="3160" y="-15271.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3160" y="-15256.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="3160" y="-15241.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_0_5&#45;&gt;qkv_proj_1_5 -->
<g id="edge510" class="edge">
<title>ffn_residual_0_5&#45;&gt;qkv_proj_1_5</title>
<path fill="none" stroke="black" d="M3160,-15359.86C3160,-15359.86 3160,-15297.16 3160,-15297.16"/>
<polygon fill="black" stroke="black" points="3163.5,-15297.16 3160,-15287.16 3156.5,-15297.16 3163.5,-15297.16"/>
</g>
<!-- qkv_reshape_1_5 -->
<g id="node517" class="node">
<title>qkv_reshape_1_5</title>
<ellipse fill="none" stroke="black" cx="3160" cy="-15134" rx="148" ry="27"/>
<text text-anchor="middle" x="3160" y="-15137.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="3160" y="-15122.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_1_5&#45;&gt;qkv_reshape_1_5 -->
<g id="edge511" class="edge">
<title>qkv_proj_1_5&#45;&gt;qkv_reshape_1_5</title>
<path fill="none" stroke="black" d="M3160,-15233.98C3160,-15233.98 3160,-15171.36 3160,-15171.36"/>
<polygon fill="black" stroke="black" points="3163.5,-15171.36 3160,-15161.36 3156.5,-15171.36 3163.5,-15171.36"/>
</g>
<!-- qkv_reshape_1_5&#45;&gt;ring_attn_1_5_stage_0 -->
<g id="edge512" class="edge">
<title>qkv_reshape_1_5&#45;&gt;ring_attn_1_5_stage_0</title>
<path fill="none" stroke="black" d="M3160,-15106.72C3160,-15106.72 3160,-15000.16 3160,-15000.16"/>
<polygon fill="black" stroke="black" points="3163.5,-15000.16 3160,-14990.16 3156.5,-15000.16 3163.5,-15000.16"/>
</g>
<!-- ring_attn_1_5_stage_0&#45;&gt;ring_attn_1_5_stage_1 -->
<g id="edge513" class="edge">
<title>ring_attn_1_5_stage_0&#45;&gt;ring_attn_1_5_stage_1</title>
<path fill="none" stroke="black" d="M3160,-14853.87C3160,-14853.87 3160,-14747.25 3160,-14747.25"/>
<polygon fill="black" stroke="black" points="3163.5,-14747.25 3160,-14737.25 3156.5,-14747.25 3163.5,-14747.25"/>
</g>
<!-- ring_attn_1_6_stage_0 -->
<g id="node616" class="node">
<title>ring_attn_1_6_stage_0</title>
<polygon fill="yellow" stroke="black" points="3747,-14990 3538,-14922 3747,-14854 3956,-14922 3747,-14990"/>
<text text-anchor="middle" x="3747" y="-14940.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-14925.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="3747" y="-14910.8" font-family="Times,serif" font-size="14.00">Q[6]×K[6]×V[6]</text>
<text text-anchor="middle" x="3747" y="-14895.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_5_stage_0&#45;&gt;ring_attn_1_6_stage_0 -->
<g id="edge1889" class="edge">
<title>ring_attn_1_5_stage_0&#45;&gt;ring_attn_1_6_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-14922C3369.02,-14922 3527.86,-14922 3527.86,-14922"/>
<polygon fill="red" stroke="red" points="3527.86,-14925.5 3537.86,-14922 3527.86,-14918.5 3527.86,-14925.5"/>
</g>
<!-- ring_attn_1_5_stage_1&#45;&gt;ring_attn_1_5_stage_2 -->
<g id="edge514" class="edge">
<title>ring_attn_1_5_stage_1&#45;&gt;ring_attn_1_5_stage_2</title>
<path fill="none" stroke="black" d="M3160,-14600.87C3160,-14600.87 3160,-14494.25 3160,-14494.25"/>
<polygon fill="black" stroke="black" points="3163.5,-14494.25 3160,-14484.25 3156.5,-14494.25 3163.5,-14494.25"/>
</g>
<!-- ring_attn_1_6_stage_1 -->
<g id="node617" class="node">
<title>ring_attn_1_6_stage_1</title>
<polygon fill="yellow" stroke="black" points="3747,-14737 3538,-14669 3747,-14601 3956,-14669 3747,-14737"/>
<text text-anchor="middle" x="3747" y="-14687.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-14672.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="3747" y="-14657.8" font-family="Times,serif" font-size="14.00">Q[6]×K[5]×V[5]</text>
<text text-anchor="middle" x="3747" y="-14642.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_5_stage_1&#45;&gt;ring_attn_1_6_stage_1 -->
<g id="edge1890" class="edge">
<title>ring_attn_1_5_stage_1&#45;&gt;ring_attn_1_6_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-14669C3369.02,-14669 3527.86,-14669 3527.86,-14669"/>
<polygon fill="red" stroke="red" points="3527.86,-14672.5 3537.86,-14669 3527.86,-14665.5 3527.86,-14672.5"/>
</g>
<!-- ring_attn_1_5_stage_2&#45;&gt;ring_attn_1_5_stage_3 -->
<g id="edge515" class="edge">
<title>ring_attn_1_5_stage_2&#45;&gt;ring_attn_1_5_stage_3</title>
<path fill="none" stroke="black" d="M3160,-14347.87C3160,-14347.87 3160,-14241.25 3160,-14241.25"/>
<polygon fill="black" stroke="black" points="3163.5,-14241.25 3160,-14231.25 3156.5,-14241.25 3163.5,-14241.25"/>
</g>
<!-- ring_attn_1_6_stage_2 -->
<g id="node618" class="node">
<title>ring_attn_1_6_stage_2</title>
<polygon fill="yellow" stroke="black" points="3747,-14484 3538,-14416 3747,-14348 3956,-14416 3747,-14484"/>
<text text-anchor="middle" x="3747" y="-14434.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-14419.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="3747" y="-14404.8" font-family="Times,serif" font-size="14.00">Q[6]×K[4]×V[4]</text>
<text text-anchor="middle" x="3747" y="-14389.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_5_stage_2&#45;&gt;ring_attn_1_6_stage_2 -->
<g id="edge1891" class="edge">
<title>ring_attn_1_5_stage_2&#45;&gt;ring_attn_1_6_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-14416C3369.02,-14416 3527.86,-14416 3527.86,-14416"/>
<polygon fill="red" stroke="red" points="3527.86,-14419.5 3537.86,-14416 3527.86,-14412.5 3527.86,-14419.5"/>
</g>
<!-- ring_attn_1_5_stage_3&#45;&gt;ring_attn_1_5_stage_4 -->
<g id="edge516" class="edge">
<title>ring_attn_1_5_stage_3&#45;&gt;ring_attn_1_5_stage_4</title>
<path fill="none" stroke="black" d="M3160,-14094.87C3160,-14094.87 3160,-13988.25 3160,-13988.25"/>
<polygon fill="black" stroke="black" points="3163.5,-13988.25 3160,-13978.25 3156.5,-13988.25 3163.5,-13988.25"/>
</g>
<!-- ring_attn_1_6_stage_3 -->
<g id="node619" class="node">
<title>ring_attn_1_6_stage_3</title>
<polygon fill="yellow" stroke="black" points="3747,-14231 3538,-14163 3747,-14095 3956,-14163 3747,-14231"/>
<text text-anchor="middle" x="3747" y="-14181.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-14166.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="3747" y="-14151.8" font-family="Times,serif" font-size="14.00">Q[6]×K[3]×V[3]</text>
<text text-anchor="middle" x="3747" y="-14136.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_5_stage_3&#45;&gt;ring_attn_1_6_stage_3 -->
<g id="edge1892" class="edge">
<title>ring_attn_1_5_stage_3&#45;&gt;ring_attn_1_6_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-14163C3369.02,-14163 3527.86,-14163 3527.86,-14163"/>
<polygon fill="red" stroke="red" points="3527.86,-14166.5 3537.86,-14163 3527.86,-14159.5 3527.86,-14166.5"/>
</g>
<!-- ring_attn_1_5_stage_4&#45;&gt;ring_attn_1_5_stage_5 -->
<g id="edge517" class="edge">
<title>ring_attn_1_5_stage_4&#45;&gt;ring_attn_1_5_stage_5</title>
<path fill="none" stroke="black" d="M3160,-13841.87C3160,-13841.87 3160,-13735.25 3160,-13735.25"/>
<polygon fill="black" stroke="black" points="3163.5,-13735.25 3160,-13725.25 3156.5,-13735.25 3163.5,-13735.25"/>
</g>
<!-- ring_attn_1_6_stage_4 -->
<g id="node620" class="node">
<title>ring_attn_1_6_stage_4</title>
<polygon fill="yellow" stroke="black" points="3747,-13978 3538,-13910 3747,-13842 3956,-13910 3747,-13978"/>
<text text-anchor="middle" x="3747" y="-13928.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-13913.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="3747" y="-13898.8" font-family="Times,serif" font-size="14.00">Q[6]×K[2]×V[2]</text>
<text text-anchor="middle" x="3747" y="-13883.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_5_stage_4&#45;&gt;ring_attn_1_6_stage_4 -->
<g id="edge1893" class="edge">
<title>ring_attn_1_5_stage_4&#45;&gt;ring_attn_1_6_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-13910C3369.02,-13910 3527.86,-13910 3527.86,-13910"/>
<polygon fill="red" stroke="red" points="3527.86,-13913.5 3537.86,-13910 3527.86,-13906.5 3527.86,-13913.5"/>
</g>
<!-- ring_attn_1_5_stage_5&#45;&gt;ring_attn_1_5_stage_6 -->
<g id="edge518" class="edge">
<title>ring_attn_1_5_stage_5&#45;&gt;ring_attn_1_5_stage_6</title>
<path fill="none" stroke="black" d="M3160,-13588.87C3160,-13588.87 3160,-13482.25 3160,-13482.25"/>
<polygon fill="black" stroke="black" points="3163.5,-13482.25 3160,-13472.25 3156.5,-13482.25 3163.5,-13482.25"/>
</g>
<!-- ring_attn_1_6_stage_5 -->
<g id="node621" class="node">
<title>ring_attn_1_6_stage_5</title>
<polygon fill="yellow" stroke="black" points="3747,-13725 3538,-13657 3747,-13589 3956,-13657 3747,-13725"/>
<text text-anchor="middle" x="3747" y="-13675.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-13660.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="3747" y="-13645.8" font-family="Times,serif" font-size="14.00">Q[6]×K[1]×V[1]</text>
<text text-anchor="middle" x="3747" y="-13630.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_5_stage_5&#45;&gt;ring_attn_1_6_stage_5 -->
<g id="edge1894" class="edge">
<title>ring_attn_1_5_stage_5&#45;&gt;ring_attn_1_6_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-13657C3369.02,-13657 3527.86,-13657 3527.86,-13657"/>
<polygon fill="red" stroke="red" points="3527.86,-13660.5 3537.86,-13657 3527.86,-13653.5 3527.86,-13660.5"/>
</g>
<!-- ring_attn_1_5_stage_6&#45;&gt;ring_attn_1_5_stage_7 -->
<g id="edge519" class="edge">
<title>ring_attn_1_5_stage_6&#45;&gt;ring_attn_1_5_stage_7</title>
<path fill="none" stroke="black" d="M3160,-13335.87C3160,-13335.87 3160,-13229.25 3160,-13229.25"/>
<polygon fill="black" stroke="black" points="3163.5,-13229.25 3160,-13219.25 3156.5,-13229.25 3163.5,-13229.25"/>
</g>
<!-- ring_attn_1_6_stage_6 -->
<g id="node622" class="node">
<title>ring_attn_1_6_stage_6</title>
<polygon fill="yellow" stroke="black" points="3747,-13472 3538,-13404 3747,-13336 3956,-13404 3747,-13472"/>
<text text-anchor="middle" x="3747" y="-13422.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-13407.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="3747" y="-13392.8" font-family="Times,serif" font-size="14.00">Q[6]×K[0]×V[0]</text>
<text text-anchor="middle" x="3747" y="-13377.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_5_stage_6&#45;&gt;ring_attn_1_6_stage_6 -->
<g id="edge1895" class="edge">
<title>ring_attn_1_5_stage_6&#45;&gt;ring_attn_1_6_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-13404C3369.02,-13404 3527.86,-13404 3527.86,-13404"/>
<polygon fill="red" stroke="red" points="3527.86,-13407.5 3537.86,-13404 3527.86,-13400.5 3527.86,-13407.5"/>
</g>
<!-- ring_attn_1_5_stage_7&#45;&gt;ring_attn_1_5_stage_8 -->
<g id="edge520" class="edge">
<title>ring_attn_1_5_stage_7&#45;&gt;ring_attn_1_5_stage_8</title>
<path fill="none" stroke="black" d="M3160,-13082.87C3160,-13082.87 3160,-12976.25 3160,-12976.25"/>
<polygon fill="black" stroke="black" points="3163.5,-12976.25 3160,-12966.25 3156.5,-12976.25 3163.5,-12976.25"/>
</g>
<!-- ring_attn_1_6_stage_7 -->
<g id="node623" class="node">
<title>ring_attn_1_6_stage_7</title>
<polygon fill="yellow" stroke="black" points="3747,-13219 3538,-13151 3747,-13083 3956,-13151 3747,-13219"/>
<text text-anchor="middle" x="3747" y="-13169.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-13154.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="3747" y="-13139.8" font-family="Times,serif" font-size="14.00">Q[6]×K[15]×V[15]</text>
<text text-anchor="middle" x="3747" y="-13124.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_5_stage_7&#45;&gt;ring_attn_1_6_stage_7 -->
<g id="edge1896" class="edge">
<title>ring_attn_1_5_stage_7&#45;&gt;ring_attn_1_6_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-13151C3369.02,-13151 3527.86,-13151 3527.86,-13151"/>
<polygon fill="red" stroke="red" points="3527.86,-13154.5 3537.86,-13151 3527.86,-13147.5 3527.86,-13154.5"/>
</g>
<!-- ring_attn_1_5_stage_8&#45;&gt;ring_attn_1_5_stage_9 -->
<g id="edge521" class="edge">
<title>ring_attn_1_5_stage_8&#45;&gt;ring_attn_1_5_stage_9</title>
<path fill="none" stroke="black" d="M3160,-12829.87C3160,-12829.87 3160,-12723.25 3160,-12723.25"/>
<polygon fill="black" stroke="black" points="3163.5,-12723.25 3160,-12713.25 3156.5,-12723.25 3163.5,-12723.25"/>
</g>
<!-- ring_attn_1_6_stage_8 -->
<g id="node624" class="node">
<title>ring_attn_1_6_stage_8</title>
<polygon fill="yellow" stroke="black" points="3747,-12966 3538,-12898 3747,-12830 3956,-12898 3747,-12966"/>
<text text-anchor="middle" x="3747" y="-12916.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-12901.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="3747" y="-12886.8" font-family="Times,serif" font-size="14.00">Q[6]×K[14]×V[14]</text>
<text text-anchor="middle" x="3747" y="-12871.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_5_stage_8&#45;&gt;ring_attn_1_6_stage_8 -->
<g id="edge1897" class="edge">
<title>ring_attn_1_5_stage_8&#45;&gt;ring_attn_1_6_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-12898C3369.02,-12898 3527.86,-12898 3527.86,-12898"/>
<polygon fill="red" stroke="red" points="3527.86,-12901.5 3537.86,-12898 3527.86,-12894.5 3527.86,-12901.5"/>
</g>
<!-- ring_attn_1_5_stage_9&#45;&gt;ring_attn_1_5_stage_10 -->
<g id="edge522" class="edge">
<title>ring_attn_1_5_stage_9&#45;&gt;ring_attn_1_5_stage_10</title>
<path fill="none" stroke="black" d="M3160,-12576.87C3160,-12576.87 3160,-12470.25 3160,-12470.25"/>
<polygon fill="black" stroke="black" points="3163.5,-12470.25 3160,-12460.25 3156.5,-12470.25 3163.5,-12470.25"/>
</g>
<!-- ring_attn_1_6_stage_9 -->
<g id="node625" class="node">
<title>ring_attn_1_6_stage_9</title>
<polygon fill="yellow" stroke="black" points="3747,-12713 3538,-12645 3747,-12577 3956,-12645 3747,-12713"/>
<text text-anchor="middle" x="3747" y="-12663.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-12648.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="3747" y="-12633.8" font-family="Times,serif" font-size="14.00">Q[6]×K[13]×V[13]</text>
<text text-anchor="middle" x="3747" y="-12618.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_5_stage_9&#45;&gt;ring_attn_1_6_stage_9 -->
<g id="edge1898" class="edge">
<title>ring_attn_1_5_stage_9&#45;&gt;ring_attn_1_6_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-12645C3369.02,-12645 3527.86,-12645 3527.86,-12645"/>
<polygon fill="red" stroke="red" points="3527.86,-12648.5 3537.86,-12645 3527.86,-12641.5 3527.86,-12648.5"/>
</g>
<!-- ring_attn_1_5_stage_10&#45;&gt;ring_attn_1_5_stage_11 -->
<g id="edge523" class="edge">
<title>ring_attn_1_5_stage_10&#45;&gt;ring_attn_1_5_stage_11</title>
<path fill="none" stroke="black" d="M3160,-12323.87C3160,-12323.87 3160,-12217.25 3160,-12217.25"/>
<polygon fill="black" stroke="black" points="3163.5,-12217.25 3160,-12207.25 3156.5,-12217.25 3163.5,-12217.25"/>
</g>
<!-- ring_attn_1_6_stage_10 -->
<g id="node626" class="node">
<title>ring_attn_1_6_stage_10</title>
<polygon fill="yellow" stroke="black" points="3747,-12460 3538,-12392 3747,-12324 3956,-12392 3747,-12460"/>
<text text-anchor="middle" x="3747" y="-12410.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-12395.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="3747" y="-12380.8" font-family="Times,serif" font-size="14.00">Q[6]×K[12]×V[12]</text>
<text text-anchor="middle" x="3747" y="-12365.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_5_stage_10&#45;&gt;ring_attn_1_6_stage_10 -->
<g id="edge1899" class="edge">
<title>ring_attn_1_5_stage_10&#45;&gt;ring_attn_1_6_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-12392C3369.02,-12392 3527.86,-12392 3527.86,-12392"/>
<polygon fill="red" stroke="red" points="3527.86,-12395.5 3537.86,-12392 3527.86,-12388.5 3527.86,-12395.5"/>
</g>
<!-- ring_attn_1_5_stage_11&#45;&gt;ring_attn_1_5_stage_12 -->
<g id="edge524" class="edge">
<title>ring_attn_1_5_stage_11&#45;&gt;ring_attn_1_5_stage_12</title>
<path fill="none" stroke="black" d="M3160,-12070.87C3160,-12070.87 3160,-11964.25 3160,-11964.25"/>
<polygon fill="black" stroke="black" points="3163.5,-11964.25 3160,-11954.25 3156.5,-11964.25 3163.5,-11964.25"/>
</g>
<!-- ring_attn_1_6_stage_11 -->
<g id="node627" class="node">
<title>ring_attn_1_6_stage_11</title>
<polygon fill="yellow" stroke="black" points="3747,-12207 3538,-12139 3747,-12071 3956,-12139 3747,-12207"/>
<text text-anchor="middle" x="3747" y="-12157.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-12142.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="3747" y="-12127.8" font-family="Times,serif" font-size="14.00">Q[6]×K[11]×V[11]</text>
<text text-anchor="middle" x="3747" y="-12112.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_5_stage_11&#45;&gt;ring_attn_1_6_stage_11 -->
<g id="edge1900" class="edge">
<title>ring_attn_1_5_stage_11&#45;&gt;ring_attn_1_6_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-12139C3369.02,-12139 3527.86,-12139 3527.86,-12139"/>
<polygon fill="red" stroke="red" points="3527.86,-12142.5 3537.86,-12139 3527.86,-12135.5 3527.86,-12142.5"/>
</g>
<!-- ring_attn_1_5_stage_12&#45;&gt;ring_attn_1_5_stage_13 -->
<g id="edge525" class="edge">
<title>ring_attn_1_5_stage_12&#45;&gt;ring_attn_1_5_stage_13</title>
<path fill="none" stroke="black" d="M3160,-11817.87C3160,-11817.87 3160,-11711.25 3160,-11711.25"/>
<polygon fill="black" stroke="black" points="3163.5,-11711.25 3160,-11701.25 3156.5,-11711.25 3163.5,-11711.25"/>
</g>
<!-- ring_attn_1_6_stage_12 -->
<g id="node628" class="node">
<title>ring_attn_1_6_stage_12</title>
<polygon fill="yellow" stroke="black" points="3747,-11954 3538,-11886 3747,-11818 3956,-11886 3747,-11954"/>
<text text-anchor="middle" x="3747" y="-11904.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-11889.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="3747" y="-11874.8" font-family="Times,serif" font-size="14.00">Q[6]×K[10]×V[10]</text>
<text text-anchor="middle" x="3747" y="-11859.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_5_stage_12&#45;&gt;ring_attn_1_6_stage_12 -->
<g id="edge1901" class="edge">
<title>ring_attn_1_5_stage_12&#45;&gt;ring_attn_1_6_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-11886C3369.02,-11886 3527.86,-11886 3527.86,-11886"/>
<polygon fill="red" stroke="red" points="3527.86,-11889.5 3537.86,-11886 3527.86,-11882.5 3527.86,-11889.5"/>
</g>
<!-- ring_attn_1_5_stage_13&#45;&gt;ring_attn_1_5_stage_14 -->
<g id="edge526" class="edge">
<title>ring_attn_1_5_stage_13&#45;&gt;ring_attn_1_5_stage_14</title>
<path fill="none" stroke="black" d="M3160,-11564.87C3160,-11564.87 3160,-11458.25 3160,-11458.25"/>
<polygon fill="black" stroke="black" points="3163.5,-11458.25 3160,-11448.25 3156.5,-11458.25 3163.5,-11458.25"/>
</g>
<!-- ring_attn_1_6_stage_13 -->
<g id="node629" class="node">
<title>ring_attn_1_6_stage_13</title>
<polygon fill="yellow" stroke="black" points="3747,-11701 3538,-11633 3747,-11565 3956,-11633 3747,-11701"/>
<text text-anchor="middle" x="3747" y="-11651.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-11636.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="3747" y="-11621.8" font-family="Times,serif" font-size="14.00">Q[6]×K[9]×V[9]</text>
<text text-anchor="middle" x="3747" y="-11606.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_5_stage_13&#45;&gt;ring_attn_1_6_stage_13 -->
<g id="edge1902" class="edge">
<title>ring_attn_1_5_stage_13&#45;&gt;ring_attn_1_6_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-11633C3369.02,-11633 3527.86,-11633 3527.86,-11633"/>
<polygon fill="red" stroke="red" points="3527.86,-11636.5 3537.86,-11633 3527.86,-11629.5 3527.86,-11636.5"/>
</g>
<!-- ring_attn_1_5_stage_14&#45;&gt;ring_attn_1_5_stage_15 -->
<g id="edge527" class="edge">
<title>ring_attn_1_5_stage_14&#45;&gt;ring_attn_1_5_stage_15</title>
<path fill="none" stroke="black" d="M3160,-11311.87C3160,-11311.87 3160,-11205.25 3160,-11205.25"/>
<polygon fill="black" stroke="black" points="3163.5,-11205.25 3160,-11195.25 3156.5,-11205.25 3163.5,-11205.25"/>
</g>
<!-- ring_attn_1_6_stage_14 -->
<g id="node630" class="node">
<title>ring_attn_1_6_stage_14</title>
<polygon fill="yellow" stroke="black" points="3747,-11448 3538,-11380 3747,-11312 3956,-11380 3747,-11448"/>
<text text-anchor="middle" x="3747" y="-11398.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-11383.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="3747" y="-11368.8" font-family="Times,serif" font-size="14.00">Q[6]×K[8]×V[8]</text>
<text text-anchor="middle" x="3747" y="-11353.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_5_stage_14&#45;&gt;ring_attn_1_6_stage_14 -->
<g id="edge1903" class="edge">
<title>ring_attn_1_5_stage_14&#45;&gt;ring_attn_1_6_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-11380C3369.02,-11380 3527.86,-11380 3527.86,-11380"/>
<polygon fill="red" stroke="red" points="3527.86,-11383.5 3537.86,-11380 3527.86,-11376.5 3527.86,-11383.5"/>
</g>
<!-- attn_out_1_5 -->
<g id="node534" class="node">
<title>attn_out_1_5</title>
<polygon fill="none" stroke="black" points="3229.5,-10986 3090.5,-10986 3090.5,-10933 3229.5,-10933 3229.5,-10986"/>
<text text-anchor="middle" x="3160" y="-10970.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3160" y="-10955.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="3160" y="-10940.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_1_5_stage_15&#45;&gt;attn_out_1_5 -->
<g id="edge528" class="edge">
<title>ring_attn_1_5_stage_15&#45;&gt;attn_out_1_5</title>
<path fill="none" stroke="black" d="M3160,-11058.87C3160,-11058.87 3160,-10996.18 3160,-10996.18"/>
<polygon fill="black" stroke="black" points="3163.5,-10996.18 3160,-10986.18 3156.5,-10996.18 3163.5,-10996.18"/>
</g>
<!-- ring_attn_1_6_stage_15 -->
<g id="node631" class="node">
<title>ring_attn_1_6_stage_15</title>
<polygon fill="yellow" stroke="black" points="3747,-11195 3538,-11127 3747,-11059 3956,-11127 3747,-11195"/>
<text text-anchor="middle" x="3747" y="-11145.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-11130.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="3747" y="-11115.8" font-family="Times,serif" font-size="14.00">Q[6]×K[7]×V[7]</text>
<text text-anchor="middle" x="3747" y="-11100.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_5_stage_15&#45;&gt;ring_attn_1_6_stage_15 -->
<g id="edge1904" class="edge">
<title>ring_attn_1_5_stage_15&#45;&gt;ring_attn_1_6_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-11127C3369.02,-11127 3527.86,-11127 3527.86,-11127"/>
<polygon fill="red" stroke="red" points="3527.86,-11130.5 3537.86,-11127 3527.86,-11123.5 3527.86,-11130.5"/>
</g>
<!-- attn_residual_1_5 -->
<g id="node535" class="node">
<title>attn_residual_1_5</title>
<ellipse fill="none" stroke="black" cx="3160" cy="-10833" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3160" y="-10836.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3160" y="-10821.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_1_5&#45;&gt;attn_residual_1_5 -->
<g id="edge529" class="edge">
<title>attn_out_1_5&#45;&gt;attn_residual_1_5</title>
<path fill="none" stroke="black" d="M3160,-10932.98C3160,-10932.98 3160,-10870.36 3160,-10870.36"/>
<polygon fill="black" stroke="black" points="3163.5,-10870.36 3160,-10860.36 3156.5,-10870.36 3163.5,-10870.36"/>
</g>
<!-- ffn_up_1_5 -->
<g id="node536" class="node">
<title>ffn_up_1_5</title>
<polygon fill="none" stroke="black" points="3239,-10733 3081,-10733 3081,-10680 3239,-10680 3239,-10733"/>
<text text-anchor="middle" x="3160" y="-10717.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3160" y="-10702.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="3160" y="-10687.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_1_5&#45;&gt;ffn_up_1_5 -->
<g id="edge530" class="edge">
<title>attn_residual_1_5&#45;&gt;ffn_up_1_5</title>
<path fill="none" stroke="black" d="M3160,-10805.86C3160,-10805.86 3160,-10743.16 3160,-10743.16"/>
<polygon fill="black" stroke="black" points="3163.5,-10743.16 3160,-10733.16 3156.5,-10743.16 3163.5,-10743.16"/>
</g>
<!-- ffn_gelu_1_5 -->
<g id="node537" class="node">
<title>ffn_gelu_1_5</title>
<ellipse fill="none" stroke="black" cx="3160" cy="-10580" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3160" y="-10583.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3160" y="-10568.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_1_5&#45;&gt;ffn_gelu_1_5 -->
<g id="edge531" class="edge">
<title>ffn_up_1_5&#45;&gt;ffn_gelu_1_5</title>
<path fill="none" stroke="black" d="M3160,-10679.98C3160,-10679.98 3160,-10617.36 3160,-10617.36"/>
<polygon fill="black" stroke="black" points="3163.5,-10617.36 3160,-10607.36 3156.5,-10617.36 3163.5,-10617.36"/>
</g>
<!-- ffn_down_1_5 -->
<g id="node538" class="node">
<title>ffn_down_1_5</title>
<polygon fill="none" stroke="black" points="3249,-10480 3071,-10480 3071,-10427 3249,-10427 3249,-10480"/>
<text text-anchor="middle" x="3160" y="-10464.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3160" y="-10449.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="3160" y="-10434.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_1_5&#45;&gt;ffn_down_1_5 -->
<g id="edge532" class="edge">
<title>ffn_gelu_1_5&#45;&gt;ffn_down_1_5</title>
<path fill="none" stroke="black" d="M3160,-10552.86C3160,-10552.86 3160,-10490.16 3160,-10490.16"/>
<polygon fill="black" stroke="black" points="3163.5,-10490.16 3160,-10480.16 3156.5,-10490.16 3163.5,-10490.16"/>
</g>
<!-- ffn_residual_1_5 -->
<g id="node539" class="node">
<title>ffn_residual_1_5</title>
<ellipse fill="none" stroke="black" cx="3160" cy="-10327" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3160" y="-10330.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3160" y="-10315.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_1_5&#45;&gt;ffn_residual_1_5 -->
<g id="edge533" class="edge">
<title>ffn_down_1_5&#45;&gt;ffn_residual_1_5</title>
<path fill="none" stroke="black" d="M3160,-10426.98C3160,-10426.98 3160,-10364.36 3160,-10364.36"/>
<polygon fill="black" stroke="black" points="3163.5,-10364.36 3160,-10354.36 3156.5,-10364.36 3163.5,-10364.36"/>
</g>
<!-- qkv_proj_2_5 -->
<g id="node540" class="node">
<title>qkv_proj_2_5</title>
<polygon fill="none" stroke="black" points="3242.5,-10227 3077.5,-10227 3077.5,-10174 3242.5,-10174 3242.5,-10227"/>
<text text-anchor="middle" x="3160" y="-10211.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3160" y="-10196.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="3160" y="-10181.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_1_5&#45;&gt;qkv_proj_2_5 -->
<g id="edge534" class="edge">
<title>ffn_residual_1_5&#45;&gt;qkv_proj_2_5</title>
<path fill="none" stroke="black" d="M3160,-10299.86C3160,-10299.86 3160,-10237.16 3160,-10237.16"/>
<polygon fill="black" stroke="black" points="3163.5,-10237.16 3160,-10227.16 3156.5,-10237.16 3163.5,-10237.16"/>
</g>
<!-- qkv_reshape_2_5 -->
<g id="node541" class="node">
<title>qkv_reshape_2_5</title>
<ellipse fill="none" stroke="black" cx="3160" cy="-10074" rx="148" ry="27"/>
<text text-anchor="middle" x="3160" y="-10077.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="3160" y="-10062.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_2_5&#45;&gt;qkv_reshape_2_5 -->
<g id="edge535" class="edge">
<title>qkv_proj_2_5&#45;&gt;qkv_reshape_2_5</title>
<path fill="none" stroke="black" d="M3160,-10173.98C3160,-10173.98 3160,-10111.36 3160,-10111.36"/>
<polygon fill="black" stroke="black" points="3163.5,-10111.36 3160,-10101.36 3156.5,-10111.36 3163.5,-10111.36"/>
</g>
<!-- qkv_reshape_2_5&#45;&gt;ring_attn_2_5_stage_0 -->
<g id="edge536" class="edge">
<title>qkv_reshape_2_5&#45;&gt;ring_attn_2_5_stage_0</title>
<path fill="none" stroke="black" d="M3160,-10046.72C3160,-10046.72 3160,-9940.16 3160,-9940.16"/>
<polygon fill="black" stroke="black" points="3163.5,-9940.16 3160,-9930.16 3156.5,-9940.16 3163.5,-9940.16"/>
</g>
<!-- ring_attn_2_5_stage_0&#45;&gt;ring_attn_2_5_stage_1 -->
<g id="edge537" class="edge">
<title>ring_attn_2_5_stage_0&#45;&gt;ring_attn_2_5_stage_1</title>
<path fill="none" stroke="black" d="M3160,-9793.87C3160,-9793.87 3160,-9687.25 3160,-9687.25"/>
<polygon fill="black" stroke="black" points="3163.5,-9687.25 3160,-9677.25 3156.5,-9687.25 3163.5,-9687.25"/>
</g>
<!-- ring_attn_2_6_stage_0 -->
<g id="node640" class="node">
<title>ring_attn_2_6_stage_0</title>
<polygon fill="yellow" stroke="black" points="3747,-9930 3538,-9862 3747,-9794 3956,-9862 3747,-9930"/>
<text text-anchor="middle" x="3747" y="-9880.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-9865.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="3747" y="-9850.8" font-family="Times,serif" font-size="14.00">Q[6]×K[6]×V[6]</text>
<text text-anchor="middle" x="3747" y="-9835.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_5_stage_0&#45;&gt;ring_attn_2_6_stage_0 -->
<g id="edge1905" class="edge">
<title>ring_attn_2_5_stage_0&#45;&gt;ring_attn_2_6_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-9862C3369.02,-9862 3527.86,-9862 3527.86,-9862"/>
<polygon fill="red" stroke="red" points="3527.86,-9865.5 3537.86,-9862 3527.86,-9858.5 3527.86,-9865.5"/>
</g>
<!-- ring_attn_2_5_stage_1&#45;&gt;ring_attn_2_5_stage_2 -->
<g id="edge538" class="edge">
<title>ring_attn_2_5_stage_1&#45;&gt;ring_attn_2_5_stage_2</title>
<path fill="none" stroke="black" d="M3160,-9540.87C3160,-9540.87 3160,-9434.25 3160,-9434.25"/>
<polygon fill="black" stroke="black" points="3163.5,-9434.25 3160,-9424.25 3156.5,-9434.25 3163.5,-9434.25"/>
</g>
<!-- ring_attn_2_6_stage_1 -->
<g id="node641" class="node">
<title>ring_attn_2_6_stage_1</title>
<polygon fill="yellow" stroke="black" points="3747,-9677 3538,-9609 3747,-9541 3956,-9609 3747,-9677"/>
<text text-anchor="middle" x="3747" y="-9627.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-9612.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="3747" y="-9597.8" font-family="Times,serif" font-size="14.00">Q[6]×K[5]×V[5]</text>
<text text-anchor="middle" x="3747" y="-9582.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_5_stage_1&#45;&gt;ring_attn_2_6_stage_1 -->
<g id="edge1906" class="edge">
<title>ring_attn_2_5_stage_1&#45;&gt;ring_attn_2_6_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-9609C3369.02,-9609 3527.86,-9609 3527.86,-9609"/>
<polygon fill="red" stroke="red" points="3527.86,-9612.5 3537.86,-9609 3527.86,-9605.5 3527.86,-9612.5"/>
</g>
<!-- ring_attn_2_5_stage_2&#45;&gt;ring_attn_2_5_stage_3 -->
<g id="edge539" class="edge">
<title>ring_attn_2_5_stage_2&#45;&gt;ring_attn_2_5_stage_3</title>
<path fill="none" stroke="black" d="M3160,-9287.87C3160,-9287.87 3160,-9181.25 3160,-9181.25"/>
<polygon fill="black" stroke="black" points="3163.5,-9181.25 3160,-9171.25 3156.5,-9181.25 3163.5,-9181.25"/>
</g>
<!-- ring_attn_2_6_stage_2 -->
<g id="node642" class="node">
<title>ring_attn_2_6_stage_2</title>
<polygon fill="yellow" stroke="black" points="3747,-9424 3538,-9356 3747,-9288 3956,-9356 3747,-9424"/>
<text text-anchor="middle" x="3747" y="-9374.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-9359.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="3747" y="-9344.8" font-family="Times,serif" font-size="14.00">Q[6]×K[4]×V[4]</text>
<text text-anchor="middle" x="3747" y="-9329.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_5_stage_2&#45;&gt;ring_attn_2_6_stage_2 -->
<g id="edge1907" class="edge">
<title>ring_attn_2_5_stage_2&#45;&gt;ring_attn_2_6_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-9356C3369.02,-9356 3527.86,-9356 3527.86,-9356"/>
<polygon fill="red" stroke="red" points="3527.86,-9359.5 3537.86,-9356 3527.86,-9352.5 3527.86,-9359.5"/>
</g>
<!-- ring_attn_2_5_stage_3&#45;&gt;ring_attn_2_5_stage_4 -->
<g id="edge540" class="edge">
<title>ring_attn_2_5_stage_3&#45;&gt;ring_attn_2_5_stage_4</title>
<path fill="none" stroke="black" d="M3160,-9034.87C3160,-9034.87 3160,-8928.25 3160,-8928.25"/>
<polygon fill="black" stroke="black" points="3163.5,-8928.25 3160,-8918.25 3156.5,-8928.25 3163.5,-8928.25"/>
</g>
<!-- ring_attn_2_6_stage_3 -->
<g id="node643" class="node">
<title>ring_attn_2_6_stage_3</title>
<polygon fill="yellow" stroke="black" points="3747,-9171 3538,-9103 3747,-9035 3956,-9103 3747,-9171"/>
<text text-anchor="middle" x="3747" y="-9121.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-9106.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="3747" y="-9091.8" font-family="Times,serif" font-size="14.00">Q[6]×K[3]×V[3]</text>
<text text-anchor="middle" x="3747" y="-9076.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_5_stage_3&#45;&gt;ring_attn_2_6_stage_3 -->
<g id="edge1908" class="edge">
<title>ring_attn_2_5_stage_3&#45;&gt;ring_attn_2_6_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-9103C3369.02,-9103 3527.86,-9103 3527.86,-9103"/>
<polygon fill="red" stroke="red" points="3527.86,-9106.5 3537.86,-9103 3527.86,-9099.5 3527.86,-9106.5"/>
</g>
<!-- ring_attn_2_5_stage_4&#45;&gt;ring_attn_2_5_stage_5 -->
<g id="edge541" class="edge">
<title>ring_attn_2_5_stage_4&#45;&gt;ring_attn_2_5_stage_5</title>
<path fill="none" stroke="black" d="M3160,-8781.87C3160,-8781.87 3160,-8675.25 3160,-8675.25"/>
<polygon fill="black" stroke="black" points="3163.5,-8675.25 3160,-8665.25 3156.5,-8675.25 3163.5,-8675.25"/>
</g>
<!-- ring_attn_2_6_stage_4 -->
<g id="node644" class="node">
<title>ring_attn_2_6_stage_4</title>
<polygon fill="yellow" stroke="black" points="3747,-8918 3538,-8850 3747,-8782 3956,-8850 3747,-8918"/>
<text text-anchor="middle" x="3747" y="-8868.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-8853.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="3747" y="-8838.8" font-family="Times,serif" font-size="14.00">Q[6]×K[2]×V[2]</text>
<text text-anchor="middle" x="3747" y="-8823.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_5_stage_4&#45;&gt;ring_attn_2_6_stage_4 -->
<g id="edge1909" class="edge">
<title>ring_attn_2_5_stage_4&#45;&gt;ring_attn_2_6_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-8850C3369.02,-8850 3527.86,-8850 3527.86,-8850"/>
<polygon fill="red" stroke="red" points="3527.86,-8853.5 3537.86,-8850 3527.86,-8846.5 3527.86,-8853.5"/>
</g>
<!-- ring_attn_2_5_stage_5&#45;&gt;ring_attn_2_5_stage_6 -->
<g id="edge542" class="edge">
<title>ring_attn_2_5_stage_5&#45;&gt;ring_attn_2_5_stage_6</title>
<path fill="none" stroke="black" d="M3160,-8528.87C3160,-8528.87 3160,-8422.25 3160,-8422.25"/>
<polygon fill="black" stroke="black" points="3163.5,-8422.25 3160,-8412.25 3156.5,-8422.25 3163.5,-8422.25"/>
</g>
<!-- ring_attn_2_6_stage_5 -->
<g id="node645" class="node">
<title>ring_attn_2_6_stage_5</title>
<polygon fill="yellow" stroke="black" points="3747,-8665 3538,-8597 3747,-8529 3956,-8597 3747,-8665"/>
<text text-anchor="middle" x="3747" y="-8615.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-8600.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="3747" y="-8585.8" font-family="Times,serif" font-size="14.00">Q[6]×K[1]×V[1]</text>
<text text-anchor="middle" x="3747" y="-8570.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_5_stage_5&#45;&gt;ring_attn_2_6_stage_5 -->
<g id="edge1910" class="edge">
<title>ring_attn_2_5_stage_5&#45;&gt;ring_attn_2_6_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-8597C3369.02,-8597 3527.86,-8597 3527.86,-8597"/>
<polygon fill="red" stroke="red" points="3527.86,-8600.5 3537.86,-8597 3527.86,-8593.5 3527.86,-8600.5"/>
</g>
<!-- ring_attn_2_5_stage_6&#45;&gt;ring_attn_2_5_stage_7 -->
<g id="edge543" class="edge">
<title>ring_attn_2_5_stage_6&#45;&gt;ring_attn_2_5_stage_7</title>
<path fill="none" stroke="black" d="M3160,-8275.87C3160,-8275.87 3160,-8169.25 3160,-8169.25"/>
<polygon fill="black" stroke="black" points="3163.5,-8169.25 3160,-8159.25 3156.5,-8169.25 3163.5,-8169.25"/>
</g>
<!-- ring_attn_2_6_stage_6 -->
<g id="node646" class="node">
<title>ring_attn_2_6_stage_6</title>
<polygon fill="yellow" stroke="black" points="3747,-8412 3538,-8344 3747,-8276 3956,-8344 3747,-8412"/>
<text text-anchor="middle" x="3747" y="-8362.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-8347.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="3747" y="-8332.8" font-family="Times,serif" font-size="14.00">Q[6]×K[0]×V[0]</text>
<text text-anchor="middle" x="3747" y="-8317.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_5_stage_6&#45;&gt;ring_attn_2_6_stage_6 -->
<g id="edge1911" class="edge">
<title>ring_attn_2_5_stage_6&#45;&gt;ring_attn_2_6_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-8344C3369.02,-8344 3527.86,-8344 3527.86,-8344"/>
<polygon fill="red" stroke="red" points="3527.86,-8347.5 3537.86,-8344 3527.86,-8340.5 3527.86,-8347.5"/>
</g>
<!-- ring_attn_2_5_stage_7&#45;&gt;ring_attn_2_5_stage_8 -->
<g id="edge544" class="edge">
<title>ring_attn_2_5_stage_7&#45;&gt;ring_attn_2_5_stage_8</title>
<path fill="none" stroke="black" d="M3160,-8022.87C3160,-8022.87 3160,-7916.25 3160,-7916.25"/>
<polygon fill="black" stroke="black" points="3163.5,-7916.25 3160,-7906.25 3156.5,-7916.25 3163.5,-7916.25"/>
</g>
<!-- ring_attn_2_6_stage_7 -->
<g id="node647" class="node">
<title>ring_attn_2_6_stage_7</title>
<polygon fill="yellow" stroke="black" points="3747,-8159 3538,-8091 3747,-8023 3956,-8091 3747,-8159"/>
<text text-anchor="middle" x="3747" y="-8109.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-8094.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="3747" y="-8079.8" font-family="Times,serif" font-size="14.00">Q[6]×K[15]×V[15]</text>
<text text-anchor="middle" x="3747" y="-8064.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_5_stage_7&#45;&gt;ring_attn_2_6_stage_7 -->
<g id="edge1912" class="edge">
<title>ring_attn_2_5_stage_7&#45;&gt;ring_attn_2_6_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-8091C3369.02,-8091 3527.86,-8091 3527.86,-8091"/>
<polygon fill="red" stroke="red" points="3527.86,-8094.5 3537.86,-8091 3527.86,-8087.5 3527.86,-8094.5"/>
</g>
<!-- ring_attn_2_5_stage_8&#45;&gt;ring_attn_2_5_stage_9 -->
<g id="edge545" class="edge">
<title>ring_attn_2_5_stage_8&#45;&gt;ring_attn_2_5_stage_9</title>
<path fill="none" stroke="black" d="M3160,-7769.87C3160,-7769.87 3160,-7663.25 3160,-7663.25"/>
<polygon fill="black" stroke="black" points="3163.5,-7663.25 3160,-7653.25 3156.5,-7663.25 3163.5,-7663.25"/>
</g>
<!-- ring_attn_2_6_stage_8 -->
<g id="node648" class="node">
<title>ring_attn_2_6_stage_8</title>
<polygon fill="yellow" stroke="black" points="3747,-7906 3538,-7838 3747,-7770 3956,-7838 3747,-7906"/>
<text text-anchor="middle" x="3747" y="-7856.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-7841.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="3747" y="-7826.8" font-family="Times,serif" font-size="14.00">Q[6]×K[14]×V[14]</text>
<text text-anchor="middle" x="3747" y="-7811.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_5_stage_8&#45;&gt;ring_attn_2_6_stage_8 -->
<g id="edge1913" class="edge">
<title>ring_attn_2_5_stage_8&#45;&gt;ring_attn_2_6_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-7838C3369.02,-7838 3527.86,-7838 3527.86,-7838"/>
<polygon fill="red" stroke="red" points="3527.86,-7841.5 3537.86,-7838 3527.86,-7834.5 3527.86,-7841.5"/>
</g>
<!-- ring_attn_2_5_stage_9&#45;&gt;ring_attn_2_5_stage_10 -->
<g id="edge546" class="edge">
<title>ring_attn_2_5_stage_9&#45;&gt;ring_attn_2_5_stage_10</title>
<path fill="none" stroke="black" d="M3160,-7516.87C3160,-7516.87 3160,-7410.25 3160,-7410.25"/>
<polygon fill="black" stroke="black" points="3163.5,-7410.25 3160,-7400.25 3156.5,-7410.25 3163.5,-7410.25"/>
</g>
<!-- ring_attn_2_6_stage_9 -->
<g id="node649" class="node">
<title>ring_attn_2_6_stage_9</title>
<polygon fill="yellow" stroke="black" points="3747,-7653 3538,-7585 3747,-7517 3956,-7585 3747,-7653"/>
<text text-anchor="middle" x="3747" y="-7603.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-7588.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="3747" y="-7573.8" font-family="Times,serif" font-size="14.00">Q[6]×K[13]×V[13]</text>
<text text-anchor="middle" x="3747" y="-7558.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_5_stage_9&#45;&gt;ring_attn_2_6_stage_9 -->
<g id="edge1914" class="edge">
<title>ring_attn_2_5_stage_9&#45;&gt;ring_attn_2_6_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-7585C3369.02,-7585 3527.86,-7585 3527.86,-7585"/>
<polygon fill="red" stroke="red" points="3527.86,-7588.5 3537.86,-7585 3527.86,-7581.5 3527.86,-7588.5"/>
</g>
<!-- ring_attn_2_5_stage_10&#45;&gt;ring_attn_2_5_stage_11 -->
<g id="edge547" class="edge">
<title>ring_attn_2_5_stage_10&#45;&gt;ring_attn_2_5_stage_11</title>
<path fill="none" stroke="black" d="M3160,-7263.87C3160,-7263.87 3160,-7157.25 3160,-7157.25"/>
<polygon fill="black" stroke="black" points="3163.5,-7157.25 3160,-7147.25 3156.5,-7157.25 3163.5,-7157.25"/>
</g>
<!-- ring_attn_2_6_stage_10 -->
<g id="node650" class="node">
<title>ring_attn_2_6_stage_10</title>
<polygon fill="yellow" stroke="black" points="3747,-7400 3538,-7332 3747,-7264 3956,-7332 3747,-7400"/>
<text text-anchor="middle" x="3747" y="-7350.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-7335.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="3747" y="-7320.8" font-family="Times,serif" font-size="14.00">Q[6]×K[12]×V[12]</text>
<text text-anchor="middle" x="3747" y="-7305.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_5_stage_10&#45;&gt;ring_attn_2_6_stage_10 -->
<g id="edge1915" class="edge">
<title>ring_attn_2_5_stage_10&#45;&gt;ring_attn_2_6_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-7332C3369.02,-7332 3527.86,-7332 3527.86,-7332"/>
<polygon fill="red" stroke="red" points="3527.86,-7335.5 3537.86,-7332 3527.86,-7328.5 3527.86,-7335.5"/>
</g>
<!-- ring_attn_2_5_stage_11&#45;&gt;ring_attn_2_5_stage_12 -->
<g id="edge548" class="edge">
<title>ring_attn_2_5_stage_11&#45;&gt;ring_attn_2_5_stage_12</title>
<path fill="none" stroke="black" d="M3160,-7010.87C3160,-7010.87 3160,-6904.25 3160,-6904.25"/>
<polygon fill="black" stroke="black" points="3163.5,-6904.25 3160,-6894.25 3156.5,-6904.25 3163.5,-6904.25"/>
</g>
<!-- ring_attn_2_6_stage_11 -->
<g id="node651" class="node">
<title>ring_attn_2_6_stage_11</title>
<polygon fill="yellow" stroke="black" points="3747,-7147 3538,-7079 3747,-7011 3956,-7079 3747,-7147"/>
<text text-anchor="middle" x="3747" y="-7097.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-7082.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="3747" y="-7067.8" font-family="Times,serif" font-size="14.00">Q[6]×K[11]×V[11]</text>
<text text-anchor="middle" x="3747" y="-7052.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_5_stage_11&#45;&gt;ring_attn_2_6_stage_11 -->
<g id="edge1916" class="edge">
<title>ring_attn_2_5_stage_11&#45;&gt;ring_attn_2_6_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-7079C3369.02,-7079 3527.86,-7079 3527.86,-7079"/>
<polygon fill="red" stroke="red" points="3527.86,-7082.5 3537.86,-7079 3527.86,-7075.5 3527.86,-7082.5"/>
</g>
<!-- ring_attn_2_5_stage_12&#45;&gt;ring_attn_2_5_stage_13 -->
<g id="edge549" class="edge">
<title>ring_attn_2_5_stage_12&#45;&gt;ring_attn_2_5_stage_13</title>
<path fill="none" stroke="black" d="M3160,-6757.87C3160,-6757.87 3160,-6651.25 3160,-6651.25"/>
<polygon fill="black" stroke="black" points="3163.5,-6651.25 3160,-6641.25 3156.5,-6651.25 3163.5,-6651.25"/>
</g>
<!-- ring_attn_2_6_stage_12 -->
<g id="node652" class="node">
<title>ring_attn_2_6_stage_12</title>
<polygon fill="yellow" stroke="black" points="3747,-6894 3538,-6826 3747,-6758 3956,-6826 3747,-6894"/>
<text text-anchor="middle" x="3747" y="-6844.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-6829.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="3747" y="-6814.8" font-family="Times,serif" font-size="14.00">Q[6]×K[10]×V[10]</text>
<text text-anchor="middle" x="3747" y="-6799.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_5_stage_12&#45;&gt;ring_attn_2_6_stage_12 -->
<g id="edge1917" class="edge">
<title>ring_attn_2_5_stage_12&#45;&gt;ring_attn_2_6_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-6826C3369.02,-6826 3527.86,-6826 3527.86,-6826"/>
<polygon fill="red" stroke="red" points="3527.86,-6829.5 3537.86,-6826 3527.86,-6822.5 3527.86,-6829.5"/>
</g>
<!-- ring_attn_2_5_stage_13&#45;&gt;ring_attn_2_5_stage_14 -->
<g id="edge550" class="edge">
<title>ring_attn_2_5_stage_13&#45;&gt;ring_attn_2_5_stage_14</title>
<path fill="none" stroke="black" d="M3160,-6504.87C3160,-6504.87 3160,-6398.25 3160,-6398.25"/>
<polygon fill="black" stroke="black" points="3163.5,-6398.25 3160,-6388.25 3156.5,-6398.25 3163.5,-6398.25"/>
</g>
<!-- ring_attn_2_6_stage_13 -->
<g id="node653" class="node">
<title>ring_attn_2_6_stage_13</title>
<polygon fill="yellow" stroke="black" points="3747,-6641 3538,-6573 3747,-6505 3956,-6573 3747,-6641"/>
<text text-anchor="middle" x="3747" y="-6591.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-6576.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="3747" y="-6561.8" font-family="Times,serif" font-size="14.00">Q[6]×K[9]×V[9]</text>
<text text-anchor="middle" x="3747" y="-6546.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_5_stage_13&#45;&gt;ring_attn_2_6_stage_13 -->
<g id="edge1918" class="edge">
<title>ring_attn_2_5_stage_13&#45;&gt;ring_attn_2_6_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-6573C3369.02,-6573 3527.86,-6573 3527.86,-6573"/>
<polygon fill="red" stroke="red" points="3527.86,-6576.5 3537.86,-6573 3527.86,-6569.5 3527.86,-6576.5"/>
</g>
<!-- ring_attn_2_5_stage_14&#45;&gt;ring_attn_2_5_stage_15 -->
<g id="edge551" class="edge">
<title>ring_attn_2_5_stage_14&#45;&gt;ring_attn_2_5_stage_15</title>
<path fill="none" stroke="black" d="M3160,-6251.87C3160,-6251.87 3160,-6145.25 3160,-6145.25"/>
<polygon fill="black" stroke="black" points="3163.5,-6145.25 3160,-6135.25 3156.5,-6145.25 3163.5,-6145.25"/>
</g>
<!-- ring_attn_2_6_stage_14 -->
<g id="node654" class="node">
<title>ring_attn_2_6_stage_14</title>
<polygon fill="yellow" stroke="black" points="3747,-6388 3538,-6320 3747,-6252 3956,-6320 3747,-6388"/>
<text text-anchor="middle" x="3747" y="-6338.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-6323.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="3747" y="-6308.8" font-family="Times,serif" font-size="14.00">Q[6]×K[8]×V[8]</text>
<text text-anchor="middle" x="3747" y="-6293.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_5_stage_14&#45;&gt;ring_attn_2_6_stage_14 -->
<g id="edge1919" class="edge">
<title>ring_attn_2_5_stage_14&#45;&gt;ring_attn_2_6_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-6320C3369.02,-6320 3527.86,-6320 3527.86,-6320"/>
<polygon fill="red" stroke="red" points="3527.86,-6323.5 3537.86,-6320 3527.86,-6316.5 3527.86,-6323.5"/>
</g>
<!-- attn_out_2_5 -->
<g id="node558" class="node">
<title>attn_out_2_5</title>
<polygon fill="none" stroke="black" points="3229.5,-5926 3090.5,-5926 3090.5,-5873 3229.5,-5873 3229.5,-5926"/>
<text text-anchor="middle" x="3160" y="-5910.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3160" y="-5895.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="3160" y="-5880.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_2_5_stage_15&#45;&gt;attn_out_2_5 -->
<g id="edge552" class="edge">
<title>ring_attn_2_5_stage_15&#45;&gt;attn_out_2_5</title>
<path fill="none" stroke="black" d="M3160,-5998.87C3160,-5998.87 3160,-5936.18 3160,-5936.18"/>
<polygon fill="black" stroke="black" points="3163.5,-5936.18 3160,-5926.18 3156.5,-5936.18 3163.5,-5936.18"/>
</g>
<!-- ring_attn_2_6_stage_15 -->
<g id="node655" class="node">
<title>ring_attn_2_6_stage_15</title>
<polygon fill="yellow" stroke="black" points="3747,-6135 3538,-6067 3747,-5999 3956,-6067 3747,-6135"/>
<text text-anchor="middle" x="3747" y="-6085.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-6070.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="3747" y="-6055.8" font-family="Times,serif" font-size="14.00">Q[6]×K[7]×V[7]</text>
<text text-anchor="middle" x="3747" y="-6040.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_5_stage_15&#45;&gt;ring_attn_2_6_stage_15 -->
<g id="edge1920" class="edge">
<title>ring_attn_2_5_stage_15&#45;&gt;ring_attn_2_6_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-6067C3369.02,-6067 3527.86,-6067 3527.86,-6067"/>
<polygon fill="red" stroke="red" points="3527.86,-6070.5 3537.86,-6067 3527.86,-6063.5 3527.86,-6070.5"/>
</g>
<!-- attn_residual_2_5 -->
<g id="node559" class="node">
<title>attn_residual_2_5</title>
<ellipse fill="none" stroke="black" cx="3160" cy="-5773" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3160" y="-5776.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3160" y="-5761.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_2_5&#45;&gt;attn_residual_2_5 -->
<g id="edge553" class="edge">
<title>attn_out_2_5&#45;&gt;attn_residual_2_5</title>
<path fill="none" stroke="black" d="M3160,-5872.98C3160,-5872.98 3160,-5810.36 3160,-5810.36"/>
<polygon fill="black" stroke="black" points="3163.5,-5810.36 3160,-5800.36 3156.5,-5810.36 3163.5,-5810.36"/>
</g>
<!-- ffn_up_2_5 -->
<g id="node560" class="node">
<title>ffn_up_2_5</title>
<polygon fill="none" stroke="black" points="3239,-5673 3081,-5673 3081,-5620 3239,-5620 3239,-5673"/>
<text text-anchor="middle" x="3160" y="-5657.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3160" y="-5642.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="3160" y="-5627.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_2_5&#45;&gt;ffn_up_2_5 -->
<g id="edge554" class="edge">
<title>attn_residual_2_5&#45;&gt;ffn_up_2_5</title>
<path fill="none" stroke="black" d="M3160,-5745.86C3160,-5745.86 3160,-5683.16 3160,-5683.16"/>
<polygon fill="black" stroke="black" points="3163.5,-5683.16 3160,-5673.16 3156.5,-5683.16 3163.5,-5683.16"/>
</g>
<!-- ffn_gelu_2_5 -->
<g id="node561" class="node">
<title>ffn_gelu_2_5</title>
<ellipse fill="none" stroke="black" cx="3160" cy="-5520" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3160" y="-5523.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3160" y="-5508.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_2_5&#45;&gt;ffn_gelu_2_5 -->
<g id="edge555" class="edge">
<title>ffn_up_2_5&#45;&gt;ffn_gelu_2_5</title>
<path fill="none" stroke="black" d="M3160,-5619.98C3160,-5619.98 3160,-5557.36 3160,-5557.36"/>
<polygon fill="black" stroke="black" points="3163.5,-5557.36 3160,-5547.36 3156.5,-5557.36 3163.5,-5557.36"/>
</g>
<!-- ffn_down_2_5 -->
<g id="node562" class="node">
<title>ffn_down_2_5</title>
<polygon fill="none" stroke="black" points="3249,-5420 3071,-5420 3071,-5367 3249,-5367 3249,-5420"/>
<text text-anchor="middle" x="3160" y="-5404.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3160" y="-5389.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="3160" y="-5374.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_2_5&#45;&gt;ffn_down_2_5 -->
<g id="edge556" class="edge">
<title>ffn_gelu_2_5&#45;&gt;ffn_down_2_5</title>
<path fill="none" stroke="black" d="M3160,-5492.86C3160,-5492.86 3160,-5430.16 3160,-5430.16"/>
<polygon fill="black" stroke="black" points="3163.5,-5430.16 3160,-5420.16 3156.5,-5430.16 3163.5,-5430.16"/>
</g>
<!-- ffn_residual_2_5 -->
<g id="node563" class="node">
<title>ffn_residual_2_5</title>
<ellipse fill="none" stroke="black" cx="3160" cy="-5267" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3160" y="-5270.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3160" y="-5255.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_2_5&#45;&gt;ffn_residual_2_5 -->
<g id="edge557" class="edge">
<title>ffn_down_2_5&#45;&gt;ffn_residual_2_5</title>
<path fill="none" stroke="black" d="M3160,-5366.98C3160,-5366.98 3160,-5304.36 3160,-5304.36"/>
<polygon fill="black" stroke="black" points="3163.5,-5304.36 3160,-5294.36 3156.5,-5304.36 3163.5,-5304.36"/>
</g>
<!-- qkv_proj_3_5 -->
<g id="node564" class="node">
<title>qkv_proj_3_5</title>
<polygon fill="none" stroke="black" points="3242.5,-5167 3077.5,-5167 3077.5,-5114 3242.5,-5114 3242.5,-5167"/>
<text text-anchor="middle" x="3160" y="-5151.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3160" y="-5136.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="3160" y="-5121.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_2_5&#45;&gt;qkv_proj_3_5 -->
<g id="edge558" class="edge">
<title>ffn_residual_2_5&#45;&gt;qkv_proj_3_5</title>
<path fill="none" stroke="black" d="M3160,-5239.86C3160,-5239.86 3160,-5177.16 3160,-5177.16"/>
<polygon fill="black" stroke="black" points="3163.5,-5177.16 3160,-5167.16 3156.5,-5177.16 3163.5,-5177.16"/>
</g>
<!-- qkv_reshape_3_5 -->
<g id="node565" class="node">
<title>qkv_reshape_3_5</title>
<ellipse fill="none" stroke="black" cx="3160" cy="-5014" rx="148" ry="27"/>
<text text-anchor="middle" x="3160" y="-5017.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="3160" y="-5002.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_3_5&#45;&gt;qkv_reshape_3_5 -->
<g id="edge559" class="edge">
<title>qkv_proj_3_5&#45;&gt;qkv_reshape_3_5</title>
<path fill="none" stroke="black" d="M3160,-5113.98C3160,-5113.98 3160,-5051.36 3160,-5051.36"/>
<polygon fill="black" stroke="black" points="3163.5,-5051.36 3160,-5041.36 3156.5,-5051.36 3163.5,-5051.36"/>
</g>
<!-- qkv_reshape_3_5&#45;&gt;ring_attn_3_5_stage_0 -->
<g id="edge560" class="edge">
<title>qkv_reshape_3_5&#45;&gt;ring_attn_3_5_stage_0</title>
<path fill="none" stroke="black" d="M3160,-4986.72C3160,-4986.72 3160,-4880.16 3160,-4880.16"/>
<polygon fill="black" stroke="black" points="3163.5,-4880.16 3160,-4870.16 3156.5,-4880.16 3163.5,-4880.16"/>
</g>
<!-- ring_attn_3_5_stage_0&#45;&gt;ring_attn_3_5_stage_1 -->
<g id="edge561" class="edge">
<title>ring_attn_3_5_stage_0&#45;&gt;ring_attn_3_5_stage_1</title>
<path fill="none" stroke="black" d="M3160,-4733.87C3160,-4733.87 3160,-4627.25 3160,-4627.25"/>
<polygon fill="black" stroke="black" points="3163.5,-4627.25 3160,-4617.25 3156.5,-4627.25 3163.5,-4627.25"/>
</g>
<!-- ring_attn_3_6_stage_0 -->
<g id="node664" class="node">
<title>ring_attn_3_6_stage_0</title>
<polygon fill="yellow" stroke="black" points="3747,-4870 3538,-4802 3747,-4734 3956,-4802 3747,-4870"/>
<text text-anchor="middle" x="3747" y="-4820.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-4805.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="3747" y="-4790.8" font-family="Times,serif" font-size="14.00">Q[6]×K[6]×V[6]</text>
<text text-anchor="middle" x="3747" y="-4775.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_5_stage_0&#45;&gt;ring_attn_3_6_stage_0 -->
<g id="edge1921" class="edge">
<title>ring_attn_3_5_stage_0&#45;&gt;ring_attn_3_6_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-4802C3369.02,-4802 3527.86,-4802 3527.86,-4802"/>
<polygon fill="red" stroke="red" points="3527.86,-4805.5 3537.86,-4802 3527.86,-4798.5 3527.86,-4805.5"/>
</g>
<!-- ring_attn_3_5_stage_1&#45;&gt;ring_attn_3_5_stage_2 -->
<g id="edge562" class="edge">
<title>ring_attn_3_5_stage_1&#45;&gt;ring_attn_3_5_stage_2</title>
<path fill="none" stroke="black" d="M3160,-4480.87C3160,-4480.87 3160,-4374.25 3160,-4374.25"/>
<polygon fill="black" stroke="black" points="3163.5,-4374.25 3160,-4364.25 3156.5,-4374.25 3163.5,-4374.25"/>
</g>
<!-- ring_attn_3_6_stage_1 -->
<g id="node665" class="node">
<title>ring_attn_3_6_stage_1</title>
<polygon fill="yellow" stroke="black" points="3747,-4617 3538,-4549 3747,-4481 3956,-4549 3747,-4617"/>
<text text-anchor="middle" x="3747" y="-4567.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-4552.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="3747" y="-4537.8" font-family="Times,serif" font-size="14.00">Q[6]×K[5]×V[5]</text>
<text text-anchor="middle" x="3747" y="-4522.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_5_stage_1&#45;&gt;ring_attn_3_6_stage_1 -->
<g id="edge1922" class="edge">
<title>ring_attn_3_5_stage_1&#45;&gt;ring_attn_3_6_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-4549C3369.02,-4549 3527.86,-4549 3527.86,-4549"/>
<polygon fill="red" stroke="red" points="3527.86,-4552.5 3537.86,-4549 3527.86,-4545.5 3527.86,-4552.5"/>
</g>
<!-- ring_attn_3_5_stage_2&#45;&gt;ring_attn_3_5_stage_3 -->
<g id="edge563" class="edge">
<title>ring_attn_3_5_stage_2&#45;&gt;ring_attn_3_5_stage_3</title>
<path fill="none" stroke="black" d="M3160,-4227.87C3160,-4227.87 3160,-4121.25 3160,-4121.25"/>
<polygon fill="black" stroke="black" points="3163.5,-4121.25 3160,-4111.25 3156.5,-4121.25 3163.5,-4121.25"/>
</g>
<!-- ring_attn_3_6_stage_2 -->
<g id="node666" class="node">
<title>ring_attn_3_6_stage_2</title>
<polygon fill="yellow" stroke="black" points="3747,-4364 3538,-4296 3747,-4228 3956,-4296 3747,-4364"/>
<text text-anchor="middle" x="3747" y="-4314.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-4299.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="3747" y="-4284.8" font-family="Times,serif" font-size="14.00">Q[6]×K[4]×V[4]</text>
<text text-anchor="middle" x="3747" y="-4269.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_5_stage_2&#45;&gt;ring_attn_3_6_stage_2 -->
<g id="edge1923" class="edge">
<title>ring_attn_3_5_stage_2&#45;&gt;ring_attn_3_6_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-4296C3369.02,-4296 3527.86,-4296 3527.86,-4296"/>
<polygon fill="red" stroke="red" points="3527.86,-4299.5 3537.86,-4296 3527.86,-4292.5 3527.86,-4299.5"/>
</g>
<!-- ring_attn_3_5_stage_3&#45;&gt;ring_attn_3_5_stage_4 -->
<g id="edge564" class="edge">
<title>ring_attn_3_5_stage_3&#45;&gt;ring_attn_3_5_stage_4</title>
<path fill="none" stroke="black" d="M3160,-3974.87C3160,-3974.87 3160,-3868.25 3160,-3868.25"/>
<polygon fill="black" stroke="black" points="3163.5,-3868.25 3160,-3858.25 3156.5,-3868.25 3163.5,-3868.25"/>
</g>
<!-- ring_attn_3_6_stage_3 -->
<g id="node667" class="node">
<title>ring_attn_3_6_stage_3</title>
<polygon fill="yellow" stroke="black" points="3747,-4111 3538,-4043 3747,-3975 3956,-4043 3747,-4111"/>
<text text-anchor="middle" x="3747" y="-4061.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-4046.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="3747" y="-4031.8" font-family="Times,serif" font-size="14.00">Q[6]×K[3]×V[3]</text>
<text text-anchor="middle" x="3747" y="-4016.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_5_stage_3&#45;&gt;ring_attn_3_6_stage_3 -->
<g id="edge1924" class="edge">
<title>ring_attn_3_5_stage_3&#45;&gt;ring_attn_3_6_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-4043C3369.02,-4043 3527.86,-4043 3527.86,-4043"/>
<polygon fill="red" stroke="red" points="3527.86,-4046.5 3537.86,-4043 3527.86,-4039.5 3527.86,-4046.5"/>
</g>
<!-- ring_attn_3_5_stage_4&#45;&gt;ring_attn_3_5_stage_5 -->
<g id="edge565" class="edge">
<title>ring_attn_3_5_stage_4&#45;&gt;ring_attn_3_5_stage_5</title>
<path fill="none" stroke="black" d="M3160,-3721.87C3160,-3721.87 3160,-3615.25 3160,-3615.25"/>
<polygon fill="black" stroke="black" points="3163.5,-3615.25 3160,-3605.25 3156.5,-3615.25 3163.5,-3615.25"/>
</g>
<!-- ring_attn_3_6_stage_4 -->
<g id="node668" class="node">
<title>ring_attn_3_6_stage_4</title>
<polygon fill="yellow" stroke="black" points="3747,-3858 3538,-3790 3747,-3722 3956,-3790 3747,-3858"/>
<text text-anchor="middle" x="3747" y="-3808.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-3793.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="3747" y="-3778.8" font-family="Times,serif" font-size="14.00">Q[6]×K[2]×V[2]</text>
<text text-anchor="middle" x="3747" y="-3763.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_5_stage_4&#45;&gt;ring_attn_3_6_stage_4 -->
<g id="edge1925" class="edge">
<title>ring_attn_3_5_stage_4&#45;&gt;ring_attn_3_6_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-3790C3369.02,-3790 3527.86,-3790 3527.86,-3790"/>
<polygon fill="red" stroke="red" points="3527.86,-3793.5 3537.86,-3790 3527.86,-3786.5 3527.86,-3793.5"/>
</g>
<!-- ring_attn_3_5_stage_5&#45;&gt;ring_attn_3_5_stage_6 -->
<g id="edge566" class="edge">
<title>ring_attn_3_5_stage_5&#45;&gt;ring_attn_3_5_stage_6</title>
<path fill="none" stroke="black" d="M3160,-3468.87C3160,-3468.87 3160,-3362.25 3160,-3362.25"/>
<polygon fill="black" stroke="black" points="3163.5,-3362.25 3160,-3352.25 3156.5,-3362.25 3163.5,-3362.25"/>
</g>
<!-- ring_attn_3_6_stage_5 -->
<g id="node669" class="node">
<title>ring_attn_3_6_stage_5</title>
<polygon fill="yellow" stroke="black" points="3747,-3605 3538,-3537 3747,-3469 3956,-3537 3747,-3605"/>
<text text-anchor="middle" x="3747" y="-3555.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-3540.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="3747" y="-3525.8" font-family="Times,serif" font-size="14.00">Q[6]×K[1]×V[1]</text>
<text text-anchor="middle" x="3747" y="-3510.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_5_stage_5&#45;&gt;ring_attn_3_6_stage_5 -->
<g id="edge1926" class="edge">
<title>ring_attn_3_5_stage_5&#45;&gt;ring_attn_3_6_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-3537C3369.02,-3537 3527.86,-3537 3527.86,-3537"/>
<polygon fill="red" stroke="red" points="3527.86,-3540.5 3537.86,-3537 3527.86,-3533.5 3527.86,-3540.5"/>
</g>
<!-- ring_attn_3_5_stage_6&#45;&gt;ring_attn_3_5_stage_7 -->
<g id="edge567" class="edge">
<title>ring_attn_3_5_stage_6&#45;&gt;ring_attn_3_5_stage_7</title>
<path fill="none" stroke="black" d="M3160,-3215.87C3160,-3215.87 3160,-3109.25 3160,-3109.25"/>
<polygon fill="black" stroke="black" points="3163.5,-3109.25 3160,-3099.25 3156.5,-3109.25 3163.5,-3109.25"/>
</g>
<!-- ring_attn_3_6_stage_6 -->
<g id="node670" class="node">
<title>ring_attn_3_6_stage_6</title>
<polygon fill="yellow" stroke="black" points="3747,-3352 3538,-3284 3747,-3216 3956,-3284 3747,-3352"/>
<text text-anchor="middle" x="3747" y="-3302.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-3287.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="3747" y="-3272.8" font-family="Times,serif" font-size="14.00">Q[6]×K[0]×V[0]</text>
<text text-anchor="middle" x="3747" y="-3257.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_5_stage_6&#45;&gt;ring_attn_3_6_stage_6 -->
<g id="edge1927" class="edge">
<title>ring_attn_3_5_stage_6&#45;&gt;ring_attn_3_6_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-3284C3369.02,-3284 3527.86,-3284 3527.86,-3284"/>
<polygon fill="red" stroke="red" points="3527.86,-3287.5 3537.86,-3284 3527.86,-3280.5 3527.86,-3287.5"/>
</g>
<!-- ring_attn_3_5_stage_7&#45;&gt;ring_attn_3_5_stage_8 -->
<g id="edge568" class="edge">
<title>ring_attn_3_5_stage_7&#45;&gt;ring_attn_3_5_stage_8</title>
<path fill="none" stroke="black" d="M3160,-2962.87C3160,-2962.87 3160,-2856.25 3160,-2856.25"/>
<polygon fill="black" stroke="black" points="3163.5,-2856.25 3160,-2846.25 3156.5,-2856.25 3163.5,-2856.25"/>
</g>
<!-- ring_attn_3_6_stage_7 -->
<g id="node671" class="node">
<title>ring_attn_3_6_stage_7</title>
<polygon fill="yellow" stroke="black" points="3747,-3099 3538,-3031 3747,-2963 3956,-3031 3747,-3099"/>
<text text-anchor="middle" x="3747" y="-3049.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-3034.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="3747" y="-3019.8" font-family="Times,serif" font-size="14.00">Q[6]×K[15]×V[15]</text>
<text text-anchor="middle" x="3747" y="-3004.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_5_stage_7&#45;&gt;ring_attn_3_6_stage_7 -->
<g id="edge1928" class="edge">
<title>ring_attn_3_5_stage_7&#45;&gt;ring_attn_3_6_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-3031C3369.02,-3031 3527.86,-3031 3527.86,-3031"/>
<polygon fill="red" stroke="red" points="3527.86,-3034.5 3537.86,-3031 3527.86,-3027.5 3527.86,-3034.5"/>
</g>
<!-- ring_attn_3_5_stage_8&#45;&gt;ring_attn_3_5_stage_9 -->
<g id="edge569" class="edge">
<title>ring_attn_3_5_stage_8&#45;&gt;ring_attn_3_5_stage_9</title>
<path fill="none" stroke="black" d="M3160,-2709.87C3160,-2709.87 3160,-2603.25 3160,-2603.25"/>
<polygon fill="black" stroke="black" points="3163.5,-2603.25 3160,-2593.25 3156.5,-2603.25 3163.5,-2603.25"/>
</g>
<!-- ring_attn_3_6_stage_8 -->
<g id="node672" class="node">
<title>ring_attn_3_6_stage_8</title>
<polygon fill="yellow" stroke="black" points="3747,-2846 3538,-2778 3747,-2710 3956,-2778 3747,-2846"/>
<text text-anchor="middle" x="3747" y="-2796.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-2781.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="3747" y="-2766.8" font-family="Times,serif" font-size="14.00">Q[6]×K[14]×V[14]</text>
<text text-anchor="middle" x="3747" y="-2751.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_5_stage_8&#45;&gt;ring_attn_3_6_stage_8 -->
<g id="edge1929" class="edge">
<title>ring_attn_3_5_stage_8&#45;&gt;ring_attn_3_6_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-2778C3369.02,-2778 3527.86,-2778 3527.86,-2778"/>
<polygon fill="red" stroke="red" points="3527.86,-2781.5 3537.86,-2778 3527.86,-2774.5 3527.86,-2781.5"/>
</g>
<!-- ring_attn_3_5_stage_9&#45;&gt;ring_attn_3_5_stage_10 -->
<g id="edge570" class="edge">
<title>ring_attn_3_5_stage_9&#45;&gt;ring_attn_3_5_stage_10</title>
<path fill="none" stroke="black" d="M3160,-2456.87C3160,-2456.87 3160,-2350.25 3160,-2350.25"/>
<polygon fill="black" stroke="black" points="3163.5,-2350.25 3160,-2340.25 3156.5,-2350.25 3163.5,-2350.25"/>
</g>
<!-- ring_attn_3_6_stage_9 -->
<g id="node673" class="node">
<title>ring_attn_3_6_stage_9</title>
<polygon fill="yellow" stroke="black" points="3747,-2593 3538,-2525 3747,-2457 3956,-2525 3747,-2593"/>
<text text-anchor="middle" x="3747" y="-2543.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-2528.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="3747" y="-2513.8" font-family="Times,serif" font-size="14.00">Q[6]×K[13]×V[13]</text>
<text text-anchor="middle" x="3747" y="-2498.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_5_stage_9&#45;&gt;ring_attn_3_6_stage_9 -->
<g id="edge1930" class="edge">
<title>ring_attn_3_5_stage_9&#45;&gt;ring_attn_3_6_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-2525C3369.02,-2525 3527.86,-2525 3527.86,-2525"/>
<polygon fill="red" stroke="red" points="3527.86,-2528.5 3537.86,-2525 3527.86,-2521.5 3527.86,-2528.5"/>
</g>
<!-- ring_attn_3_5_stage_10&#45;&gt;ring_attn_3_5_stage_11 -->
<g id="edge571" class="edge">
<title>ring_attn_3_5_stage_10&#45;&gt;ring_attn_3_5_stage_11</title>
<path fill="none" stroke="black" d="M3160,-2203.87C3160,-2203.87 3160,-2097.25 3160,-2097.25"/>
<polygon fill="black" stroke="black" points="3163.5,-2097.25 3160,-2087.25 3156.5,-2097.25 3163.5,-2097.25"/>
</g>
<!-- ring_attn_3_6_stage_10 -->
<g id="node674" class="node">
<title>ring_attn_3_6_stage_10</title>
<polygon fill="yellow" stroke="black" points="3747,-2340 3538,-2272 3747,-2204 3956,-2272 3747,-2340"/>
<text text-anchor="middle" x="3747" y="-2290.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-2275.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="3747" y="-2260.8" font-family="Times,serif" font-size="14.00">Q[6]×K[12]×V[12]</text>
<text text-anchor="middle" x="3747" y="-2245.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_5_stage_10&#45;&gt;ring_attn_3_6_stage_10 -->
<g id="edge1931" class="edge">
<title>ring_attn_3_5_stage_10&#45;&gt;ring_attn_3_6_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-2272C3369.02,-2272 3527.86,-2272 3527.86,-2272"/>
<polygon fill="red" stroke="red" points="3527.86,-2275.5 3537.86,-2272 3527.86,-2268.5 3527.86,-2275.5"/>
</g>
<!-- ring_attn_3_5_stage_11&#45;&gt;ring_attn_3_5_stage_12 -->
<g id="edge572" class="edge">
<title>ring_attn_3_5_stage_11&#45;&gt;ring_attn_3_5_stage_12</title>
<path fill="none" stroke="black" d="M3160,-1950.87C3160,-1950.87 3160,-1844.25 3160,-1844.25"/>
<polygon fill="black" stroke="black" points="3163.5,-1844.25 3160,-1834.25 3156.5,-1844.25 3163.5,-1844.25"/>
</g>
<!-- ring_attn_3_6_stage_11 -->
<g id="node675" class="node">
<title>ring_attn_3_6_stage_11</title>
<polygon fill="yellow" stroke="black" points="3747,-2087 3538,-2019 3747,-1951 3956,-2019 3747,-2087"/>
<text text-anchor="middle" x="3747" y="-2037.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-2022.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="3747" y="-2007.8" font-family="Times,serif" font-size="14.00">Q[6]×K[11]×V[11]</text>
<text text-anchor="middle" x="3747" y="-1992.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_5_stage_11&#45;&gt;ring_attn_3_6_stage_11 -->
<g id="edge1932" class="edge">
<title>ring_attn_3_5_stage_11&#45;&gt;ring_attn_3_6_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-2019C3369.02,-2019 3527.86,-2019 3527.86,-2019"/>
<polygon fill="red" stroke="red" points="3527.86,-2022.5 3537.86,-2019 3527.86,-2015.5 3527.86,-2022.5"/>
</g>
<!-- ring_attn_3_5_stage_12&#45;&gt;ring_attn_3_5_stage_13 -->
<g id="edge573" class="edge">
<title>ring_attn_3_5_stage_12&#45;&gt;ring_attn_3_5_stage_13</title>
<path fill="none" stroke="black" d="M3160,-1697.87C3160,-1697.87 3160,-1591.25 3160,-1591.25"/>
<polygon fill="black" stroke="black" points="3163.5,-1591.25 3160,-1581.25 3156.5,-1591.25 3163.5,-1591.25"/>
</g>
<!-- ring_attn_3_6_stage_12 -->
<g id="node676" class="node">
<title>ring_attn_3_6_stage_12</title>
<polygon fill="yellow" stroke="black" points="3747,-1834 3538,-1766 3747,-1698 3956,-1766 3747,-1834"/>
<text text-anchor="middle" x="3747" y="-1784.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-1769.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="3747" y="-1754.8" font-family="Times,serif" font-size="14.00">Q[6]×K[10]×V[10]</text>
<text text-anchor="middle" x="3747" y="-1739.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_5_stage_12&#45;&gt;ring_attn_3_6_stage_12 -->
<g id="edge1933" class="edge">
<title>ring_attn_3_5_stage_12&#45;&gt;ring_attn_3_6_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-1766C3369.02,-1766 3527.86,-1766 3527.86,-1766"/>
<polygon fill="red" stroke="red" points="3527.86,-1769.5 3537.86,-1766 3527.86,-1762.5 3527.86,-1769.5"/>
</g>
<!-- ring_attn_3_5_stage_13&#45;&gt;ring_attn_3_5_stage_14 -->
<g id="edge574" class="edge">
<title>ring_attn_3_5_stage_13&#45;&gt;ring_attn_3_5_stage_14</title>
<path fill="none" stroke="black" d="M3160,-1444.87C3160,-1444.87 3160,-1338.25 3160,-1338.25"/>
<polygon fill="black" stroke="black" points="3163.5,-1338.25 3160,-1328.25 3156.5,-1338.25 3163.5,-1338.25"/>
</g>
<!-- ring_attn_3_6_stage_13 -->
<g id="node677" class="node">
<title>ring_attn_3_6_stage_13</title>
<polygon fill="yellow" stroke="black" points="3747,-1581 3538,-1513 3747,-1445 3956,-1513 3747,-1581"/>
<text text-anchor="middle" x="3747" y="-1531.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-1516.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="3747" y="-1501.8" font-family="Times,serif" font-size="14.00">Q[6]×K[9]×V[9]</text>
<text text-anchor="middle" x="3747" y="-1486.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_5_stage_13&#45;&gt;ring_attn_3_6_stage_13 -->
<g id="edge1934" class="edge">
<title>ring_attn_3_5_stage_13&#45;&gt;ring_attn_3_6_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-1513C3369.02,-1513 3527.86,-1513 3527.86,-1513"/>
<polygon fill="red" stroke="red" points="3527.86,-1516.5 3537.86,-1513 3527.86,-1509.5 3527.86,-1516.5"/>
</g>
<!-- ring_attn_3_5_stage_14&#45;&gt;ring_attn_3_5_stage_15 -->
<g id="edge575" class="edge">
<title>ring_attn_3_5_stage_14&#45;&gt;ring_attn_3_5_stage_15</title>
<path fill="none" stroke="black" d="M3160,-1191.87C3160,-1191.87 3160,-1085.25 3160,-1085.25"/>
<polygon fill="black" stroke="black" points="3163.5,-1085.25 3160,-1075.25 3156.5,-1085.25 3163.5,-1085.25"/>
</g>
<!-- ring_attn_3_6_stage_14 -->
<g id="node678" class="node">
<title>ring_attn_3_6_stage_14</title>
<polygon fill="yellow" stroke="black" points="3747,-1328 3538,-1260 3747,-1192 3956,-1260 3747,-1328"/>
<text text-anchor="middle" x="3747" y="-1278.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-1263.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="3747" y="-1248.8" font-family="Times,serif" font-size="14.00">Q[6]×K[8]×V[8]</text>
<text text-anchor="middle" x="3747" y="-1233.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_5_stage_14&#45;&gt;ring_attn_3_6_stage_14 -->
<g id="edge1935" class="edge">
<title>ring_attn_3_5_stage_14&#45;&gt;ring_attn_3_6_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-1260C3369.02,-1260 3527.86,-1260 3527.86,-1260"/>
<polygon fill="red" stroke="red" points="3527.86,-1263.5 3537.86,-1260 3527.86,-1256.5 3527.86,-1263.5"/>
</g>
<!-- attn_out_3_5 -->
<g id="node582" class="node">
<title>attn_out_3_5</title>
<polygon fill="none" stroke="black" points="3229.5,-866 3090.5,-866 3090.5,-813 3229.5,-813 3229.5,-866"/>
<text text-anchor="middle" x="3160" y="-850.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3160" y="-835.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="3160" y="-820.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_3_5_stage_15&#45;&gt;attn_out_3_5 -->
<g id="edge576" class="edge">
<title>ring_attn_3_5_stage_15&#45;&gt;attn_out_3_5</title>
<path fill="none" stroke="black" d="M3160,-938.87C3160,-938.87 3160,-876.18 3160,-876.18"/>
<polygon fill="black" stroke="black" points="3163.5,-876.18 3160,-866.18 3156.5,-876.18 3163.5,-876.18"/>
</g>
<!-- ring_attn_3_6_stage_15 -->
<g id="node679" class="node">
<title>ring_attn_3_6_stage_15</title>
<polygon fill="yellow" stroke="black" points="3747,-1075 3538,-1007 3747,-939 3956,-1007 3747,-1075"/>
<text text-anchor="middle" x="3747" y="-1025.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="3747" y="-1010.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="3747" y="-995.8" font-family="Times,serif" font-size="14.00">Q[6]×K[7]×V[7]</text>
<text text-anchor="middle" x="3747" y="-980.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_5_stage_15&#45;&gt;ring_attn_3_6_stage_15 -->
<g id="edge1936" class="edge">
<title>ring_attn_3_5_stage_15&#45;&gt;ring_attn_3_6_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3369.02,-1007C3369.02,-1007 3527.86,-1007 3527.86,-1007"/>
<polygon fill="red" stroke="red" points="3527.86,-1010.5 3537.86,-1007 3527.86,-1003.5 3527.86,-1010.5"/>
</g>
<!-- attn_residual_3_5 -->
<g id="node583" class="node">
<title>attn_residual_3_5</title>
<ellipse fill="none" stroke="black" cx="3160" cy="-713" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3160" y="-716.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3160" y="-701.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_3_5&#45;&gt;attn_residual_3_5 -->
<g id="edge577" class="edge">
<title>attn_out_3_5&#45;&gt;attn_residual_3_5</title>
<path fill="none" stroke="black" d="M3160,-812.98C3160,-812.98 3160,-750.36 3160,-750.36"/>
<polygon fill="black" stroke="black" points="3163.5,-750.36 3160,-740.36 3156.5,-750.36 3163.5,-750.36"/>
</g>
<!-- ffn_up_3_5 -->
<g id="node584" class="node">
<title>ffn_up_3_5</title>
<polygon fill="none" stroke="black" points="3239,-613 3081,-613 3081,-560 3239,-560 3239,-613"/>
<text text-anchor="middle" x="3160" y="-597.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3160" y="-582.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="3160" y="-567.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_3_5&#45;&gt;ffn_up_3_5 -->
<g id="edge578" class="edge">
<title>attn_residual_3_5&#45;&gt;ffn_up_3_5</title>
<path fill="none" stroke="black" d="M3160,-685.86C3160,-685.86 3160,-623.16 3160,-623.16"/>
<polygon fill="black" stroke="black" points="3163.5,-623.16 3160,-613.16 3156.5,-623.16 3163.5,-623.16"/>
</g>
<!-- ffn_gelu_3_5 -->
<g id="node585" class="node">
<title>ffn_gelu_3_5</title>
<ellipse fill="none" stroke="black" cx="3160" cy="-460" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3160" y="-463.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3160" y="-448.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_3_5&#45;&gt;ffn_gelu_3_5 -->
<g id="edge579" class="edge">
<title>ffn_up_3_5&#45;&gt;ffn_gelu_3_5</title>
<path fill="none" stroke="black" d="M3160,-559.98C3160,-559.98 3160,-497.36 3160,-497.36"/>
<polygon fill="black" stroke="black" points="3163.5,-497.36 3160,-487.36 3156.5,-497.36 3163.5,-497.36"/>
</g>
<!-- ffn_down_3_5 -->
<g id="node586" class="node">
<title>ffn_down_3_5</title>
<polygon fill="none" stroke="black" points="3249,-360 3071,-360 3071,-307 3249,-307 3249,-360"/>
<text text-anchor="middle" x="3160" y="-344.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3160" y="-329.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="3160" y="-314.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_3_5&#45;&gt;ffn_down_3_5 -->
<g id="edge580" class="edge">
<title>ffn_gelu_3_5&#45;&gt;ffn_down_3_5</title>
<path fill="none" stroke="black" d="M3160,-432.86C3160,-432.86 3160,-370.16 3160,-370.16"/>
<polygon fill="black" stroke="black" points="3163.5,-370.16 3160,-360.16 3156.5,-370.16 3163.5,-370.16"/>
</g>
<!-- ffn_residual_3_5 -->
<g id="node587" class="node">
<title>ffn_residual_3_5</title>
<ellipse fill="none" stroke="black" cx="3160" cy="-207" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3160" y="-210.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3160" y="-195.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_3_5&#45;&gt;ffn_residual_3_5 -->
<g id="edge581" class="edge">
<title>ffn_down_3_5&#45;&gt;ffn_residual_3_5</title>
<path fill="none" stroke="black" d="M3160,-306.98C3160,-306.98 3160,-244.36 3160,-244.36"/>
<polygon fill="black" stroke="black" points="3163.5,-244.36 3160,-234.36 3156.5,-244.36 3163.5,-244.36"/>
</g>
<!-- output_5 -->
<g id="node588" class="node">
<title>output_5</title>
<polygon fill="lightcoral" stroke="black" points="3253,-107 3067,-107 3067,-69 3253,-69 3253,-107"/>
<text text-anchor="middle" x="3160" y="-91.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="3160" y="-76.8" font-family="Times,serif" font-size="14.00">Y[5]: 1024×1024×4096</text>
</g>
<!-- ffn_residual_3_5&#45;&gt;output_5 -->
<g id="edge582" class="edge">
<title>ffn_residual_3_5&#45;&gt;output_5</title>
<path fill="none" stroke="black" d="M3160,-180C3160,-180 3160,-117.12 3160,-117.12"/>
<polygon fill="black" stroke="black" points="3163.5,-117.12 3160,-107.12 3156.5,-117.12 3163.5,-117.12"/>
</g>
<!-- input_6 -->
<g id="node589" class="node">
<title>input_6</title>
<polygon fill="lightgreen" stroke="black" points="3840.5,-20458 3653.5,-20458 3653.5,-20420 3840.5,-20420 3840.5,-20458"/>
<text text-anchor="middle" x="3747" y="-20442.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="3747" y="-20427.8" font-family="Times,serif" font-size="14.00">X[6]: 1024×1024×4096</text>
</g>
<!-- qkv_proj_0_6 -->
<g id="node590" class="node">
<title>qkv_proj_0_6</title>
<polygon fill="none" stroke="black" points="3829.5,-20347 3664.5,-20347 3664.5,-20294 3829.5,-20294 3829.5,-20347"/>
<text text-anchor="middle" x="3747" y="-20331.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3747" y="-20316.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="3747" y="-20301.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- input_6&#45;&gt;qkv_proj_0_6 -->
<g id="edge583" class="edge">
<title>input_6&#45;&gt;qkv_proj_0_6</title>
<path fill="none" stroke="black" d="M3747,-20419.96C3747,-20419.96 3747,-20357.44 3747,-20357.44"/>
<polygon fill="black" stroke="black" points="3750.5,-20357.44 3747,-20347.44 3743.5,-20357.44 3750.5,-20357.44"/>
</g>
<!-- qkv_reshape_0_6 -->
<g id="node591" class="node">
<title>qkv_reshape_0_6</title>
<ellipse fill="none" stroke="black" cx="3747" cy="-20194" rx="148" ry="27"/>
<text text-anchor="middle" x="3747" y="-20197.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="3747" y="-20182.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_0_6&#45;&gt;qkv_reshape_0_6 -->
<g id="edge584" class="edge">
<title>qkv_proj_0_6&#45;&gt;qkv_reshape_0_6</title>
<path fill="none" stroke="black" d="M3747,-20293.98C3747,-20293.98 3747,-20231.36 3747,-20231.36"/>
<polygon fill="black" stroke="black" points="3750.5,-20231.36 3747,-20221.36 3743.5,-20231.36 3750.5,-20231.36"/>
</g>
<!-- qkv_reshape_0_6&#45;&gt;ring_attn_0_6_stage_0 -->
<g id="edge585" class="edge">
<title>qkv_reshape_0_6&#45;&gt;ring_attn_0_6_stage_0</title>
<path fill="none" stroke="black" d="M3747,-20166.72C3747,-20166.72 3747,-20060.16 3747,-20060.16"/>
<polygon fill="black" stroke="black" points="3750.5,-20060.16 3747,-20050.16 3743.5,-20060.16 3750.5,-20060.16"/>
</g>
<!-- ring_attn_0_6_stage_0&#45;&gt;ring_attn_0_6_stage_1 -->
<g id="edge586" class="edge">
<title>ring_attn_0_6_stage_0&#45;&gt;ring_attn_0_6_stage_1</title>
<path fill="none" stroke="black" d="M3747,-19913.87C3747,-19913.87 3747,-19807.25 3747,-19807.25"/>
<polygon fill="black" stroke="black" points="3750.5,-19807.25 3747,-19797.25 3743.5,-19807.25 3750.5,-19807.25"/>
</g>
<!-- ring_attn_0_7_stage_0 -->
<g id="node690" class="node">
<title>ring_attn_0_7_stage_0</title>
<polygon fill="yellow" stroke="black" points="4334,-20050 4125,-19982 4334,-19914 4543,-19982 4334,-20050"/>
<text text-anchor="middle" x="4334" y="-20000.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-19985.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="4334" y="-19970.8" font-family="Times,serif" font-size="14.00">Q[7]×K[7]×V[7]</text>
<text text-anchor="middle" x="4334" y="-19955.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_6_stage_0&#45;&gt;ring_attn_0_7_stage_0 -->
<g id="edge1937" class="edge">
<title>ring_attn_0_6_stage_0&#45;&gt;ring_attn_0_7_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-19982C3956.02,-19982 4114.86,-19982 4114.86,-19982"/>
<polygon fill="red" stroke="red" points="4114.86,-19985.5 4124.86,-19982 4114.86,-19978.5 4114.86,-19985.5"/>
</g>
<!-- ring_attn_0_6_stage_1&#45;&gt;ring_attn_0_6_stage_2 -->
<g id="edge587" class="edge">
<title>ring_attn_0_6_stage_1&#45;&gt;ring_attn_0_6_stage_2</title>
<path fill="none" stroke="black" d="M3747,-19660.87C3747,-19660.87 3747,-19554.25 3747,-19554.25"/>
<polygon fill="black" stroke="black" points="3750.5,-19554.25 3747,-19544.25 3743.5,-19554.25 3750.5,-19554.25"/>
</g>
<!-- ring_attn_0_7_stage_1 -->
<g id="node691" class="node">
<title>ring_attn_0_7_stage_1</title>
<polygon fill="yellow" stroke="black" points="4334,-19797 4125,-19729 4334,-19661 4543,-19729 4334,-19797"/>
<text text-anchor="middle" x="4334" y="-19747.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-19732.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="4334" y="-19717.8" font-family="Times,serif" font-size="14.00">Q[7]×K[6]×V[6]</text>
<text text-anchor="middle" x="4334" y="-19702.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_6_stage_1&#45;&gt;ring_attn_0_7_stage_1 -->
<g id="edge1938" class="edge">
<title>ring_attn_0_6_stage_1&#45;&gt;ring_attn_0_7_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-19729C3956.02,-19729 4114.86,-19729 4114.86,-19729"/>
<polygon fill="red" stroke="red" points="4114.86,-19732.5 4124.86,-19729 4114.86,-19725.5 4114.86,-19732.5"/>
</g>
<!-- ring_attn_0_6_stage_2&#45;&gt;ring_attn_0_6_stage_3 -->
<g id="edge588" class="edge">
<title>ring_attn_0_6_stage_2&#45;&gt;ring_attn_0_6_stage_3</title>
<path fill="none" stroke="black" d="M3747,-19407.87C3747,-19407.87 3747,-19301.25 3747,-19301.25"/>
<polygon fill="black" stroke="black" points="3750.5,-19301.25 3747,-19291.25 3743.5,-19301.25 3750.5,-19301.25"/>
</g>
<!-- ring_attn_0_7_stage_2 -->
<g id="node692" class="node">
<title>ring_attn_0_7_stage_2</title>
<polygon fill="yellow" stroke="black" points="4334,-19544 4125,-19476 4334,-19408 4543,-19476 4334,-19544"/>
<text text-anchor="middle" x="4334" y="-19494.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-19479.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="4334" y="-19464.8" font-family="Times,serif" font-size="14.00">Q[7]×K[5]×V[5]</text>
<text text-anchor="middle" x="4334" y="-19449.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_6_stage_2&#45;&gt;ring_attn_0_7_stage_2 -->
<g id="edge1939" class="edge">
<title>ring_attn_0_6_stage_2&#45;&gt;ring_attn_0_7_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-19476C3956.02,-19476 4114.86,-19476 4114.86,-19476"/>
<polygon fill="red" stroke="red" points="4114.86,-19479.5 4124.86,-19476 4114.86,-19472.5 4114.86,-19479.5"/>
</g>
<!-- ring_attn_0_6_stage_3&#45;&gt;ring_attn_0_6_stage_4 -->
<g id="edge589" class="edge">
<title>ring_attn_0_6_stage_3&#45;&gt;ring_attn_0_6_stage_4</title>
<path fill="none" stroke="black" d="M3747,-19154.87C3747,-19154.87 3747,-19048.25 3747,-19048.25"/>
<polygon fill="black" stroke="black" points="3750.5,-19048.25 3747,-19038.25 3743.5,-19048.25 3750.5,-19048.25"/>
</g>
<!-- ring_attn_0_7_stage_3 -->
<g id="node693" class="node">
<title>ring_attn_0_7_stage_3</title>
<polygon fill="yellow" stroke="black" points="4334,-19291 4125,-19223 4334,-19155 4543,-19223 4334,-19291"/>
<text text-anchor="middle" x="4334" y="-19241.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-19226.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="4334" y="-19211.8" font-family="Times,serif" font-size="14.00">Q[7]×K[4]×V[4]</text>
<text text-anchor="middle" x="4334" y="-19196.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_6_stage_3&#45;&gt;ring_attn_0_7_stage_3 -->
<g id="edge1940" class="edge">
<title>ring_attn_0_6_stage_3&#45;&gt;ring_attn_0_7_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-19223C3956.02,-19223 4114.86,-19223 4114.86,-19223"/>
<polygon fill="red" stroke="red" points="4114.86,-19226.5 4124.86,-19223 4114.86,-19219.5 4114.86,-19226.5"/>
</g>
<!-- ring_attn_0_6_stage_4&#45;&gt;ring_attn_0_6_stage_5 -->
<g id="edge590" class="edge">
<title>ring_attn_0_6_stage_4&#45;&gt;ring_attn_0_6_stage_5</title>
<path fill="none" stroke="black" d="M3747,-18901.87C3747,-18901.87 3747,-18795.25 3747,-18795.25"/>
<polygon fill="black" stroke="black" points="3750.5,-18795.25 3747,-18785.25 3743.5,-18795.25 3750.5,-18795.25"/>
</g>
<!-- ring_attn_0_7_stage_4 -->
<g id="node694" class="node">
<title>ring_attn_0_7_stage_4</title>
<polygon fill="yellow" stroke="black" points="4334,-19038 4125,-18970 4334,-18902 4543,-18970 4334,-19038"/>
<text text-anchor="middle" x="4334" y="-18988.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-18973.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="4334" y="-18958.8" font-family="Times,serif" font-size="14.00">Q[7]×K[3]×V[3]</text>
<text text-anchor="middle" x="4334" y="-18943.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_6_stage_4&#45;&gt;ring_attn_0_7_stage_4 -->
<g id="edge1941" class="edge">
<title>ring_attn_0_6_stage_4&#45;&gt;ring_attn_0_7_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-18970C3956.02,-18970 4114.86,-18970 4114.86,-18970"/>
<polygon fill="red" stroke="red" points="4114.86,-18973.5 4124.86,-18970 4114.86,-18966.5 4114.86,-18973.5"/>
</g>
<!-- ring_attn_0_6_stage_5&#45;&gt;ring_attn_0_6_stage_6 -->
<g id="edge591" class="edge">
<title>ring_attn_0_6_stage_5&#45;&gt;ring_attn_0_6_stage_6</title>
<path fill="none" stroke="black" d="M3747,-18648.87C3747,-18648.87 3747,-18542.25 3747,-18542.25"/>
<polygon fill="black" stroke="black" points="3750.5,-18542.25 3747,-18532.25 3743.5,-18542.25 3750.5,-18542.25"/>
</g>
<!-- ring_attn_0_7_stage_5 -->
<g id="node695" class="node">
<title>ring_attn_0_7_stage_5</title>
<polygon fill="yellow" stroke="black" points="4334,-18785 4125,-18717 4334,-18649 4543,-18717 4334,-18785"/>
<text text-anchor="middle" x="4334" y="-18735.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-18720.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="4334" y="-18705.8" font-family="Times,serif" font-size="14.00">Q[7]×K[2]×V[2]</text>
<text text-anchor="middle" x="4334" y="-18690.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_6_stage_5&#45;&gt;ring_attn_0_7_stage_5 -->
<g id="edge1942" class="edge">
<title>ring_attn_0_6_stage_5&#45;&gt;ring_attn_0_7_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-18717C3956.02,-18717 4114.86,-18717 4114.86,-18717"/>
<polygon fill="red" stroke="red" points="4114.86,-18720.5 4124.86,-18717 4114.86,-18713.5 4114.86,-18720.5"/>
</g>
<!-- ring_attn_0_6_stage_6&#45;&gt;ring_attn_0_6_stage_7 -->
<g id="edge592" class="edge">
<title>ring_attn_0_6_stage_6&#45;&gt;ring_attn_0_6_stage_7</title>
<path fill="none" stroke="black" d="M3747,-18395.87C3747,-18395.87 3747,-18289.25 3747,-18289.25"/>
<polygon fill="black" stroke="black" points="3750.5,-18289.25 3747,-18279.25 3743.5,-18289.25 3750.5,-18289.25"/>
</g>
<!-- ring_attn_0_7_stage_6 -->
<g id="node696" class="node">
<title>ring_attn_0_7_stage_6</title>
<polygon fill="yellow" stroke="black" points="4334,-18532 4125,-18464 4334,-18396 4543,-18464 4334,-18532"/>
<text text-anchor="middle" x="4334" y="-18482.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-18467.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="4334" y="-18452.8" font-family="Times,serif" font-size="14.00">Q[7]×K[1]×V[1]</text>
<text text-anchor="middle" x="4334" y="-18437.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_6_stage_6&#45;&gt;ring_attn_0_7_stage_6 -->
<g id="edge1943" class="edge">
<title>ring_attn_0_6_stage_6&#45;&gt;ring_attn_0_7_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-18464C3956.02,-18464 4114.86,-18464 4114.86,-18464"/>
<polygon fill="red" stroke="red" points="4114.86,-18467.5 4124.86,-18464 4114.86,-18460.5 4114.86,-18467.5"/>
</g>
<!-- ring_attn_0_6_stage_7&#45;&gt;ring_attn_0_6_stage_8 -->
<g id="edge593" class="edge">
<title>ring_attn_0_6_stage_7&#45;&gt;ring_attn_0_6_stage_8</title>
<path fill="none" stroke="black" d="M3747,-18142.87C3747,-18142.87 3747,-18036.25 3747,-18036.25"/>
<polygon fill="black" stroke="black" points="3750.5,-18036.25 3747,-18026.25 3743.5,-18036.25 3750.5,-18036.25"/>
</g>
<!-- ring_attn_0_7_stage_7 -->
<g id="node697" class="node">
<title>ring_attn_0_7_stage_7</title>
<polygon fill="yellow" stroke="black" points="4334,-18279 4125,-18211 4334,-18143 4543,-18211 4334,-18279"/>
<text text-anchor="middle" x="4334" y="-18229.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-18214.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="4334" y="-18199.8" font-family="Times,serif" font-size="14.00">Q[7]×K[0]×V[0]</text>
<text text-anchor="middle" x="4334" y="-18184.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_6_stage_7&#45;&gt;ring_attn_0_7_stage_7 -->
<g id="edge1944" class="edge">
<title>ring_attn_0_6_stage_7&#45;&gt;ring_attn_0_7_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-18211C3956.02,-18211 4114.86,-18211 4114.86,-18211"/>
<polygon fill="red" stroke="red" points="4114.86,-18214.5 4124.86,-18211 4114.86,-18207.5 4114.86,-18214.5"/>
</g>
<!-- ring_attn_0_6_stage_8&#45;&gt;ring_attn_0_6_stage_9 -->
<g id="edge594" class="edge">
<title>ring_attn_0_6_stage_8&#45;&gt;ring_attn_0_6_stage_9</title>
<path fill="none" stroke="black" d="M3747,-17889.87C3747,-17889.87 3747,-17783.25 3747,-17783.25"/>
<polygon fill="black" stroke="black" points="3750.5,-17783.25 3747,-17773.25 3743.5,-17783.25 3750.5,-17783.25"/>
</g>
<!-- ring_attn_0_7_stage_8 -->
<g id="node698" class="node">
<title>ring_attn_0_7_stage_8</title>
<polygon fill="yellow" stroke="black" points="4334,-18026 4125,-17958 4334,-17890 4543,-17958 4334,-18026"/>
<text text-anchor="middle" x="4334" y="-17976.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-17961.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="4334" y="-17946.8" font-family="Times,serif" font-size="14.00">Q[7]×K[15]×V[15]</text>
<text text-anchor="middle" x="4334" y="-17931.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_6_stage_8&#45;&gt;ring_attn_0_7_stage_8 -->
<g id="edge1945" class="edge">
<title>ring_attn_0_6_stage_8&#45;&gt;ring_attn_0_7_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-17958C3956.02,-17958 4114.86,-17958 4114.86,-17958"/>
<polygon fill="red" stroke="red" points="4114.86,-17961.5 4124.86,-17958 4114.86,-17954.5 4114.86,-17961.5"/>
</g>
<!-- ring_attn_0_6_stage_9&#45;&gt;ring_attn_0_6_stage_10 -->
<g id="edge595" class="edge">
<title>ring_attn_0_6_stage_9&#45;&gt;ring_attn_0_6_stage_10</title>
<path fill="none" stroke="black" d="M3747,-17636.87C3747,-17636.87 3747,-17530.25 3747,-17530.25"/>
<polygon fill="black" stroke="black" points="3750.5,-17530.25 3747,-17520.25 3743.5,-17530.25 3750.5,-17530.25"/>
</g>
<!-- ring_attn_0_7_stage_9 -->
<g id="node699" class="node">
<title>ring_attn_0_7_stage_9</title>
<polygon fill="yellow" stroke="black" points="4334,-17773 4125,-17705 4334,-17637 4543,-17705 4334,-17773"/>
<text text-anchor="middle" x="4334" y="-17723.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-17708.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="4334" y="-17693.8" font-family="Times,serif" font-size="14.00">Q[7]×K[14]×V[14]</text>
<text text-anchor="middle" x="4334" y="-17678.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_6_stage_9&#45;&gt;ring_attn_0_7_stage_9 -->
<g id="edge1946" class="edge">
<title>ring_attn_0_6_stage_9&#45;&gt;ring_attn_0_7_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-17705C3956.02,-17705 4114.86,-17705 4114.86,-17705"/>
<polygon fill="red" stroke="red" points="4114.86,-17708.5 4124.86,-17705 4114.86,-17701.5 4114.86,-17708.5"/>
</g>
<!-- ring_attn_0_6_stage_10&#45;&gt;ring_attn_0_6_stage_11 -->
<g id="edge596" class="edge">
<title>ring_attn_0_6_stage_10&#45;&gt;ring_attn_0_6_stage_11</title>
<path fill="none" stroke="black" d="M3747,-17383.87C3747,-17383.87 3747,-17277.25 3747,-17277.25"/>
<polygon fill="black" stroke="black" points="3750.5,-17277.25 3747,-17267.25 3743.5,-17277.25 3750.5,-17277.25"/>
</g>
<!-- ring_attn_0_7_stage_10 -->
<g id="node700" class="node">
<title>ring_attn_0_7_stage_10</title>
<polygon fill="yellow" stroke="black" points="4334,-17520 4125,-17452 4334,-17384 4543,-17452 4334,-17520"/>
<text text-anchor="middle" x="4334" y="-17470.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-17455.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="4334" y="-17440.8" font-family="Times,serif" font-size="14.00">Q[7]×K[13]×V[13]</text>
<text text-anchor="middle" x="4334" y="-17425.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_6_stage_10&#45;&gt;ring_attn_0_7_stage_10 -->
<g id="edge1947" class="edge">
<title>ring_attn_0_6_stage_10&#45;&gt;ring_attn_0_7_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-17452C3956.02,-17452 4114.86,-17452 4114.86,-17452"/>
<polygon fill="red" stroke="red" points="4114.86,-17455.5 4124.86,-17452 4114.86,-17448.5 4114.86,-17455.5"/>
</g>
<!-- ring_attn_0_6_stage_11&#45;&gt;ring_attn_0_6_stage_12 -->
<g id="edge597" class="edge">
<title>ring_attn_0_6_stage_11&#45;&gt;ring_attn_0_6_stage_12</title>
<path fill="none" stroke="black" d="M3747,-17130.87C3747,-17130.87 3747,-17024.25 3747,-17024.25"/>
<polygon fill="black" stroke="black" points="3750.5,-17024.25 3747,-17014.25 3743.5,-17024.25 3750.5,-17024.25"/>
</g>
<!-- ring_attn_0_7_stage_11 -->
<g id="node701" class="node">
<title>ring_attn_0_7_stage_11</title>
<polygon fill="yellow" stroke="black" points="4334,-17267 4125,-17199 4334,-17131 4543,-17199 4334,-17267"/>
<text text-anchor="middle" x="4334" y="-17217.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-17202.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="4334" y="-17187.8" font-family="Times,serif" font-size="14.00">Q[7]×K[12]×V[12]</text>
<text text-anchor="middle" x="4334" y="-17172.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_6_stage_11&#45;&gt;ring_attn_0_7_stage_11 -->
<g id="edge1948" class="edge">
<title>ring_attn_0_6_stage_11&#45;&gt;ring_attn_0_7_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-17199C3956.02,-17199 4114.86,-17199 4114.86,-17199"/>
<polygon fill="red" stroke="red" points="4114.86,-17202.5 4124.86,-17199 4114.86,-17195.5 4114.86,-17202.5"/>
</g>
<!-- ring_attn_0_6_stage_12&#45;&gt;ring_attn_0_6_stage_13 -->
<g id="edge598" class="edge">
<title>ring_attn_0_6_stage_12&#45;&gt;ring_attn_0_6_stage_13</title>
<path fill="none" stroke="black" d="M3747,-16877.87C3747,-16877.87 3747,-16771.25 3747,-16771.25"/>
<polygon fill="black" stroke="black" points="3750.5,-16771.25 3747,-16761.25 3743.5,-16771.25 3750.5,-16771.25"/>
</g>
<!-- ring_attn_0_7_stage_12 -->
<g id="node702" class="node">
<title>ring_attn_0_7_stage_12</title>
<polygon fill="yellow" stroke="black" points="4334,-17014 4125,-16946 4334,-16878 4543,-16946 4334,-17014"/>
<text text-anchor="middle" x="4334" y="-16964.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-16949.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="4334" y="-16934.8" font-family="Times,serif" font-size="14.00">Q[7]×K[11]×V[11]</text>
<text text-anchor="middle" x="4334" y="-16919.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_6_stage_12&#45;&gt;ring_attn_0_7_stage_12 -->
<g id="edge1949" class="edge">
<title>ring_attn_0_6_stage_12&#45;&gt;ring_attn_0_7_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-16946C3956.02,-16946 4114.86,-16946 4114.86,-16946"/>
<polygon fill="red" stroke="red" points="4114.86,-16949.5 4124.86,-16946 4114.86,-16942.5 4114.86,-16949.5"/>
</g>
<!-- ring_attn_0_6_stage_13&#45;&gt;ring_attn_0_6_stage_14 -->
<g id="edge599" class="edge">
<title>ring_attn_0_6_stage_13&#45;&gt;ring_attn_0_6_stage_14</title>
<path fill="none" stroke="black" d="M3747,-16624.87C3747,-16624.87 3747,-16518.25 3747,-16518.25"/>
<polygon fill="black" stroke="black" points="3750.5,-16518.25 3747,-16508.25 3743.5,-16518.25 3750.5,-16518.25"/>
</g>
<!-- ring_attn_0_7_stage_13 -->
<g id="node703" class="node">
<title>ring_attn_0_7_stage_13</title>
<polygon fill="yellow" stroke="black" points="4334,-16761 4125,-16693 4334,-16625 4543,-16693 4334,-16761"/>
<text text-anchor="middle" x="4334" y="-16711.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-16696.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="4334" y="-16681.8" font-family="Times,serif" font-size="14.00">Q[7]×K[10]×V[10]</text>
<text text-anchor="middle" x="4334" y="-16666.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_6_stage_13&#45;&gt;ring_attn_0_7_stage_13 -->
<g id="edge1950" class="edge">
<title>ring_attn_0_6_stage_13&#45;&gt;ring_attn_0_7_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-16693C3956.02,-16693 4114.86,-16693 4114.86,-16693"/>
<polygon fill="red" stroke="red" points="4114.86,-16696.5 4124.86,-16693 4114.86,-16689.5 4114.86,-16696.5"/>
</g>
<!-- ring_attn_0_6_stage_14&#45;&gt;ring_attn_0_6_stage_15 -->
<g id="edge600" class="edge">
<title>ring_attn_0_6_stage_14&#45;&gt;ring_attn_0_6_stage_15</title>
<path fill="none" stroke="black" d="M3747,-16371.87C3747,-16371.87 3747,-16265.25 3747,-16265.25"/>
<polygon fill="black" stroke="black" points="3750.5,-16265.25 3747,-16255.25 3743.5,-16265.25 3750.5,-16265.25"/>
</g>
<!-- ring_attn_0_7_stage_14 -->
<g id="node704" class="node">
<title>ring_attn_0_7_stage_14</title>
<polygon fill="yellow" stroke="black" points="4334,-16508 4125,-16440 4334,-16372 4543,-16440 4334,-16508"/>
<text text-anchor="middle" x="4334" y="-16458.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-16443.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="4334" y="-16428.8" font-family="Times,serif" font-size="14.00">Q[7]×K[9]×V[9]</text>
<text text-anchor="middle" x="4334" y="-16413.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_6_stage_14&#45;&gt;ring_attn_0_7_stage_14 -->
<g id="edge1951" class="edge">
<title>ring_attn_0_6_stage_14&#45;&gt;ring_attn_0_7_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-16440C3956.02,-16440 4114.86,-16440 4114.86,-16440"/>
<polygon fill="red" stroke="red" points="4114.86,-16443.5 4124.86,-16440 4114.86,-16436.5 4114.86,-16443.5"/>
</g>
<!-- attn_out_0_6 -->
<g id="node608" class="node">
<title>attn_out_0_6</title>
<polygon fill="none" stroke="black" points="3816.5,-16046 3677.5,-16046 3677.5,-15993 3816.5,-15993 3816.5,-16046"/>
<text text-anchor="middle" x="3747" y="-16030.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3747" y="-16015.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="3747" y="-16000.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_0_6_stage_15&#45;&gt;attn_out_0_6 -->
<g id="edge601" class="edge">
<title>ring_attn_0_6_stage_15&#45;&gt;attn_out_0_6</title>
<path fill="none" stroke="black" d="M3747,-16118.87C3747,-16118.87 3747,-16056.18 3747,-16056.18"/>
<polygon fill="black" stroke="black" points="3750.5,-16056.18 3747,-16046.18 3743.5,-16056.18 3750.5,-16056.18"/>
</g>
<!-- ring_attn_0_7_stage_15 -->
<g id="node705" class="node">
<title>ring_attn_0_7_stage_15</title>
<polygon fill="yellow" stroke="black" points="4334,-16255 4125,-16187 4334,-16119 4543,-16187 4334,-16255"/>
<text text-anchor="middle" x="4334" y="-16205.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-16190.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="4334" y="-16175.8" font-family="Times,serif" font-size="14.00">Q[7]×K[8]×V[8]</text>
<text text-anchor="middle" x="4334" y="-16160.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_6_stage_15&#45;&gt;ring_attn_0_7_stage_15 -->
<g id="edge1952" class="edge">
<title>ring_attn_0_6_stage_15&#45;&gt;ring_attn_0_7_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-16187C3956.02,-16187 4114.86,-16187 4114.86,-16187"/>
<polygon fill="red" stroke="red" points="4114.86,-16190.5 4124.86,-16187 4114.86,-16183.5 4114.86,-16190.5"/>
</g>
<!-- attn_residual_0_6 -->
<g id="node609" class="node">
<title>attn_residual_0_6</title>
<ellipse fill="none" stroke="black" cx="3747" cy="-15893" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3747" y="-15896.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3747" y="-15881.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_0_6&#45;&gt;attn_residual_0_6 -->
<g id="edge602" class="edge">
<title>attn_out_0_6&#45;&gt;attn_residual_0_6</title>
<path fill="none" stroke="black" d="M3747,-15992.98C3747,-15992.98 3747,-15930.36 3747,-15930.36"/>
<polygon fill="black" stroke="black" points="3750.5,-15930.36 3747,-15920.36 3743.5,-15930.36 3750.5,-15930.36"/>
</g>
<!-- ffn_up_0_6 -->
<g id="node610" class="node">
<title>ffn_up_0_6</title>
<polygon fill="none" stroke="black" points="3826,-15793 3668,-15793 3668,-15740 3826,-15740 3826,-15793"/>
<text text-anchor="middle" x="3747" y="-15777.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3747" y="-15762.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="3747" y="-15747.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_0_6&#45;&gt;ffn_up_0_6 -->
<g id="edge603" class="edge">
<title>attn_residual_0_6&#45;&gt;ffn_up_0_6</title>
<path fill="none" stroke="black" d="M3747,-15865.86C3747,-15865.86 3747,-15803.16 3747,-15803.16"/>
<polygon fill="black" stroke="black" points="3750.5,-15803.16 3747,-15793.16 3743.5,-15803.16 3750.5,-15803.16"/>
</g>
<!-- ffn_gelu_0_6 -->
<g id="node611" class="node">
<title>ffn_gelu_0_6</title>
<ellipse fill="none" stroke="black" cx="3747" cy="-15640" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3747" y="-15643.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3747" y="-15628.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_0_6&#45;&gt;ffn_gelu_0_6 -->
<g id="edge604" class="edge">
<title>ffn_up_0_6&#45;&gt;ffn_gelu_0_6</title>
<path fill="none" stroke="black" d="M3747,-15739.98C3747,-15739.98 3747,-15677.36 3747,-15677.36"/>
<polygon fill="black" stroke="black" points="3750.5,-15677.36 3747,-15667.36 3743.5,-15677.36 3750.5,-15677.36"/>
</g>
<!-- ffn_down_0_6 -->
<g id="node612" class="node">
<title>ffn_down_0_6</title>
<polygon fill="none" stroke="black" points="3836,-15540 3658,-15540 3658,-15487 3836,-15487 3836,-15540"/>
<text text-anchor="middle" x="3747" y="-15524.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3747" y="-15509.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="3747" y="-15494.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_0_6&#45;&gt;ffn_down_0_6 -->
<g id="edge605" class="edge">
<title>ffn_gelu_0_6&#45;&gt;ffn_down_0_6</title>
<path fill="none" stroke="black" d="M3747,-15612.86C3747,-15612.86 3747,-15550.16 3747,-15550.16"/>
<polygon fill="black" stroke="black" points="3750.5,-15550.16 3747,-15540.16 3743.5,-15550.16 3750.5,-15550.16"/>
</g>
<!-- ffn_residual_0_6 -->
<g id="node613" class="node">
<title>ffn_residual_0_6</title>
<ellipse fill="none" stroke="black" cx="3747" cy="-15387" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3747" y="-15390.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3747" y="-15375.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_0_6&#45;&gt;ffn_residual_0_6 -->
<g id="edge606" class="edge">
<title>ffn_down_0_6&#45;&gt;ffn_residual_0_6</title>
<path fill="none" stroke="black" d="M3747,-15486.98C3747,-15486.98 3747,-15424.36 3747,-15424.36"/>
<polygon fill="black" stroke="black" points="3750.5,-15424.36 3747,-15414.36 3743.5,-15424.36 3750.5,-15424.36"/>
</g>
<!-- qkv_proj_1_6 -->
<g id="node614" class="node">
<title>qkv_proj_1_6</title>
<polygon fill="none" stroke="black" points="3829.5,-15287 3664.5,-15287 3664.5,-15234 3829.5,-15234 3829.5,-15287"/>
<text text-anchor="middle" x="3747" y="-15271.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3747" y="-15256.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="3747" y="-15241.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_0_6&#45;&gt;qkv_proj_1_6 -->
<g id="edge607" class="edge">
<title>ffn_residual_0_6&#45;&gt;qkv_proj_1_6</title>
<path fill="none" stroke="black" d="M3747,-15359.86C3747,-15359.86 3747,-15297.16 3747,-15297.16"/>
<polygon fill="black" stroke="black" points="3750.5,-15297.16 3747,-15287.16 3743.5,-15297.16 3750.5,-15297.16"/>
</g>
<!-- qkv_reshape_1_6 -->
<g id="node615" class="node">
<title>qkv_reshape_1_6</title>
<ellipse fill="none" stroke="black" cx="3747" cy="-15134" rx="148" ry="27"/>
<text text-anchor="middle" x="3747" y="-15137.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="3747" y="-15122.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_1_6&#45;&gt;qkv_reshape_1_6 -->
<g id="edge608" class="edge">
<title>qkv_proj_1_6&#45;&gt;qkv_reshape_1_6</title>
<path fill="none" stroke="black" d="M3747,-15233.98C3747,-15233.98 3747,-15171.36 3747,-15171.36"/>
<polygon fill="black" stroke="black" points="3750.5,-15171.36 3747,-15161.36 3743.5,-15171.36 3750.5,-15171.36"/>
</g>
<!-- qkv_reshape_1_6&#45;&gt;ring_attn_1_6_stage_0 -->
<g id="edge609" class="edge">
<title>qkv_reshape_1_6&#45;&gt;ring_attn_1_6_stage_0</title>
<path fill="none" stroke="black" d="M3747,-15106.72C3747,-15106.72 3747,-15000.16 3747,-15000.16"/>
<polygon fill="black" stroke="black" points="3750.5,-15000.16 3747,-14990.16 3743.5,-15000.16 3750.5,-15000.16"/>
</g>
<!-- ring_attn_1_6_stage_0&#45;&gt;ring_attn_1_6_stage_1 -->
<g id="edge610" class="edge">
<title>ring_attn_1_6_stage_0&#45;&gt;ring_attn_1_6_stage_1</title>
<path fill="none" stroke="black" d="M3747,-14853.87C3747,-14853.87 3747,-14747.25 3747,-14747.25"/>
<polygon fill="black" stroke="black" points="3750.5,-14747.25 3747,-14737.25 3743.5,-14747.25 3750.5,-14747.25"/>
</g>
<!-- ring_attn_1_7_stage_0 -->
<g id="node714" class="node">
<title>ring_attn_1_7_stage_0</title>
<polygon fill="yellow" stroke="black" points="4334,-14990 4125,-14922 4334,-14854 4543,-14922 4334,-14990"/>
<text text-anchor="middle" x="4334" y="-14940.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-14925.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="4334" y="-14910.8" font-family="Times,serif" font-size="14.00">Q[7]×K[7]×V[7]</text>
<text text-anchor="middle" x="4334" y="-14895.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_6_stage_0&#45;&gt;ring_attn_1_7_stage_0 -->
<g id="edge1953" class="edge">
<title>ring_attn_1_6_stage_0&#45;&gt;ring_attn_1_7_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-14922C3956.02,-14922 4114.86,-14922 4114.86,-14922"/>
<polygon fill="red" stroke="red" points="4114.86,-14925.5 4124.86,-14922 4114.86,-14918.5 4114.86,-14925.5"/>
</g>
<!-- ring_attn_1_6_stage_1&#45;&gt;ring_attn_1_6_stage_2 -->
<g id="edge611" class="edge">
<title>ring_attn_1_6_stage_1&#45;&gt;ring_attn_1_6_stage_2</title>
<path fill="none" stroke="black" d="M3747,-14600.87C3747,-14600.87 3747,-14494.25 3747,-14494.25"/>
<polygon fill="black" stroke="black" points="3750.5,-14494.25 3747,-14484.25 3743.5,-14494.25 3750.5,-14494.25"/>
</g>
<!-- ring_attn_1_7_stage_1 -->
<g id="node715" class="node">
<title>ring_attn_1_7_stage_1</title>
<polygon fill="yellow" stroke="black" points="4334,-14737 4125,-14669 4334,-14601 4543,-14669 4334,-14737"/>
<text text-anchor="middle" x="4334" y="-14687.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-14672.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="4334" y="-14657.8" font-family="Times,serif" font-size="14.00">Q[7]×K[6]×V[6]</text>
<text text-anchor="middle" x="4334" y="-14642.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_6_stage_1&#45;&gt;ring_attn_1_7_stage_1 -->
<g id="edge1954" class="edge">
<title>ring_attn_1_6_stage_1&#45;&gt;ring_attn_1_7_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-14669C3956.02,-14669 4114.86,-14669 4114.86,-14669"/>
<polygon fill="red" stroke="red" points="4114.86,-14672.5 4124.86,-14669 4114.86,-14665.5 4114.86,-14672.5"/>
</g>
<!-- ring_attn_1_6_stage_2&#45;&gt;ring_attn_1_6_stage_3 -->
<g id="edge612" class="edge">
<title>ring_attn_1_6_stage_2&#45;&gt;ring_attn_1_6_stage_3</title>
<path fill="none" stroke="black" d="M3747,-14347.87C3747,-14347.87 3747,-14241.25 3747,-14241.25"/>
<polygon fill="black" stroke="black" points="3750.5,-14241.25 3747,-14231.25 3743.5,-14241.25 3750.5,-14241.25"/>
</g>
<!-- ring_attn_1_7_stage_2 -->
<g id="node716" class="node">
<title>ring_attn_1_7_stage_2</title>
<polygon fill="yellow" stroke="black" points="4334,-14484 4125,-14416 4334,-14348 4543,-14416 4334,-14484"/>
<text text-anchor="middle" x="4334" y="-14434.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-14419.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="4334" y="-14404.8" font-family="Times,serif" font-size="14.00">Q[7]×K[5]×V[5]</text>
<text text-anchor="middle" x="4334" y="-14389.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_6_stage_2&#45;&gt;ring_attn_1_7_stage_2 -->
<g id="edge1955" class="edge">
<title>ring_attn_1_6_stage_2&#45;&gt;ring_attn_1_7_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-14416C3956.02,-14416 4114.86,-14416 4114.86,-14416"/>
<polygon fill="red" stroke="red" points="4114.86,-14419.5 4124.86,-14416 4114.86,-14412.5 4114.86,-14419.5"/>
</g>
<!-- ring_attn_1_6_stage_3&#45;&gt;ring_attn_1_6_stage_4 -->
<g id="edge613" class="edge">
<title>ring_attn_1_6_stage_3&#45;&gt;ring_attn_1_6_stage_4</title>
<path fill="none" stroke="black" d="M3747,-14094.87C3747,-14094.87 3747,-13988.25 3747,-13988.25"/>
<polygon fill="black" stroke="black" points="3750.5,-13988.25 3747,-13978.25 3743.5,-13988.25 3750.5,-13988.25"/>
</g>
<!-- ring_attn_1_7_stage_3 -->
<g id="node717" class="node">
<title>ring_attn_1_7_stage_3</title>
<polygon fill="yellow" stroke="black" points="4334,-14231 4125,-14163 4334,-14095 4543,-14163 4334,-14231"/>
<text text-anchor="middle" x="4334" y="-14181.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-14166.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="4334" y="-14151.8" font-family="Times,serif" font-size="14.00">Q[7]×K[4]×V[4]</text>
<text text-anchor="middle" x="4334" y="-14136.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_6_stage_3&#45;&gt;ring_attn_1_7_stage_3 -->
<g id="edge1956" class="edge">
<title>ring_attn_1_6_stage_3&#45;&gt;ring_attn_1_7_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-14163C3956.02,-14163 4114.86,-14163 4114.86,-14163"/>
<polygon fill="red" stroke="red" points="4114.86,-14166.5 4124.86,-14163 4114.86,-14159.5 4114.86,-14166.5"/>
</g>
<!-- ring_attn_1_6_stage_4&#45;&gt;ring_attn_1_6_stage_5 -->
<g id="edge614" class="edge">
<title>ring_attn_1_6_stage_4&#45;&gt;ring_attn_1_6_stage_5</title>
<path fill="none" stroke="black" d="M3747,-13841.87C3747,-13841.87 3747,-13735.25 3747,-13735.25"/>
<polygon fill="black" stroke="black" points="3750.5,-13735.25 3747,-13725.25 3743.5,-13735.25 3750.5,-13735.25"/>
</g>
<!-- ring_attn_1_7_stage_4 -->
<g id="node718" class="node">
<title>ring_attn_1_7_stage_4</title>
<polygon fill="yellow" stroke="black" points="4334,-13978 4125,-13910 4334,-13842 4543,-13910 4334,-13978"/>
<text text-anchor="middle" x="4334" y="-13928.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-13913.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="4334" y="-13898.8" font-family="Times,serif" font-size="14.00">Q[7]×K[3]×V[3]</text>
<text text-anchor="middle" x="4334" y="-13883.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_6_stage_4&#45;&gt;ring_attn_1_7_stage_4 -->
<g id="edge1957" class="edge">
<title>ring_attn_1_6_stage_4&#45;&gt;ring_attn_1_7_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-13910C3956.02,-13910 4114.86,-13910 4114.86,-13910"/>
<polygon fill="red" stroke="red" points="4114.86,-13913.5 4124.86,-13910 4114.86,-13906.5 4114.86,-13913.5"/>
</g>
<!-- ring_attn_1_6_stage_5&#45;&gt;ring_attn_1_6_stage_6 -->
<g id="edge615" class="edge">
<title>ring_attn_1_6_stage_5&#45;&gt;ring_attn_1_6_stage_6</title>
<path fill="none" stroke="black" d="M3747,-13588.87C3747,-13588.87 3747,-13482.25 3747,-13482.25"/>
<polygon fill="black" stroke="black" points="3750.5,-13482.25 3747,-13472.25 3743.5,-13482.25 3750.5,-13482.25"/>
</g>
<!-- ring_attn_1_7_stage_5 -->
<g id="node719" class="node">
<title>ring_attn_1_7_stage_5</title>
<polygon fill="yellow" stroke="black" points="4334,-13725 4125,-13657 4334,-13589 4543,-13657 4334,-13725"/>
<text text-anchor="middle" x="4334" y="-13675.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-13660.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="4334" y="-13645.8" font-family="Times,serif" font-size="14.00">Q[7]×K[2]×V[2]</text>
<text text-anchor="middle" x="4334" y="-13630.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_6_stage_5&#45;&gt;ring_attn_1_7_stage_5 -->
<g id="edge1958" class="edge">
<title>ring_attn_1_6_stage_5&#45;&gt;ring_attn_1_7_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-13657C3956.02,-13657 4114.86,-13657 4114.86,-13657"/>
<polygon fill="red" stroke="red" points="4114.86,-13660.5 4124.86,-13657 4114.86,-13653.5 4114.86,-13660.5"/>
</g>
<!-- ring_attn_1_6_stage_6&#45;&gt;ring_attn_1_6_stage_7 -->
<g id="edge616" class="edge">
<title>ring_attn_1_6_stage_6&#45;&gt;ring_attn_1_6_stage_7</title>
<path fill="none" stroke="black" d="M3747,-13335.87C3747,-13335.87 3747,-13229.25 3747,-13229.25"/>
<polygon fill="black" stroke="black" points="3750.5,-13229.25 3747,-13219.25 3743.5,-13229.25 3750.5,-13229.25"/>
</g>
<!-- ring_attn_1_7_stage_6 -->
<g id="node720" class="node">
<title>ring_attn_1_7_stage_6</title>
<polygon fill="yellow" stroke="black" points="4334,-13472 4125,-13404 4334,-13336 4543,-13404 4334,-13472"/>
<text text-anchor="middle" x="4334" y="-13422.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-13407.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="4334" y="-13392.8" font-family="Times,serif" font-size="14.00">Q[7]×K[1]×V[1]</text>
<text text-anchor="middle" x="4334" y="-13377.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_6_stage_6&#45;&gt;ring_attn_1_7_stage_6 -->
<g id="edge1959" class="edge">
<title>ring_attn_1_6_stage_6&#45;&gt;ring_attn_1_7_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-13404C3956.02,-13404 4114.86,-13404 4114.86,-13404"/>
<polygon fill="red" stroke="red" points="4114.86,-13407.5 4124.86,-13404 4114.86,-13400.5 4114.86,-13407.5"/>
</g>
<!-- ring_attn_1_6_stage_7&#45;&gt;ring_attn_1_6_stage_8 -->
<g id="edge617" class="edge">
<title>ring_attn_1_6_stage_7&#45;&gt;ring_attn_1_6_stage_8</title>
<path fill="none" stroke="black" d="M3747,-13082.87C3747,-13082.87 3747,-12976.25 3747,-12976.25"/>
<polygon fill="black" stroke="black" points="3750.5,-12976.25 3747,-12966.25 3743.5,-12976.25 3750.5,-12976.25"/>
</g>
<!-- ring_attn_1_7_stage_7 -->
<g id="node721" class="node">
<title>ring_attn_1_7_stage_7</title>
<polygon fill="yellow" stroke="black" points="4334,-13219 4125,-13151 4334,-13083 4543,-13151 4334,-13219"/>
<text text-anchor="middle" x="4334" y="-13169.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-13154.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="4334" y="-13139.8" font-family="Times,serif" font-size="14.00">Q[7]×K[0]×V[0]</text>
<text text-anchor="middle" x="4334" y="-13124.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_6_stage_7&#45;&gt;ring_attn_1_7_stage_7 -->
<g id="edge1960" class="edge">
<title>ring_attn_1_6_stage_7&#45;&gt;ring_attn_1_7_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-13151C3956.02,-13151 4114.86,-13151 4114.86,-13151"/>
<polygon fill="red" stroke="red" points="4114.86,-13154.5 4124.86,-13151 4114.86,-13147.5 4114.86,-13154.5"/>
</g>
<!-- ring_attn_1_6_stage_8&#45;&gt;ring_attn_1_6_stage_9 -->
<g id="edge618" class="edge">
<title>ring_attn_1_6_stage_8&#45;&gt;ring_attn_1_6_stage_9</title>
<path fill="none" stroke="black" d="M3747,-12829.87C3747,-12829.87 3747,-12723.25 3747,-12723.25"/>
<polygon fill="black" stroke="black" points="3750.5,-12723.25 3747,-12713.25 3743.5,-12723.25 3750.5,-12723.25"/>
</g>
<!-- ring_attn_1_7_stage_8 -->
<g id="node722" class="node">
<title>ring_attn_1_7_stage_8</title>
<polygon fill="yellow" stroke="black" points="4334,-12966 4125,-12898 4334,-12830 4543,-12898 4334,-12966"/>
<text text-anchor="middle" x="4334" y="-12916.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-12901.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="4334" y="-12886.8" font-family="Times,serif" font-size="14.00">Q[7]×K[15]×V[15]</text>
<text text-anchor="middle" x="4334" y="-12871.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_6_stage_8&#45;&gt;ring_attn_1_7_stage_8 -->
<g id="edge1961" class="edge">
<title>ring_attn_1_6_stage_8&#45;&gt;ring_attn_1_7_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-12898C3956.02,-12898 4114.86,-12898 4114.86,-12898"/>
<polygon fill="red" stroke="red" points="4114.86,-12901.5 4124.86,-12898 4114.86,-12894.5 4114.86,-12901.5"/>
</g>
<!-- ring_attn_1_6_stage_9&#45;&gt;ring_attn_1_6_stage_10 -->
<g id="edge619" class="edge">
<title>ring_attn_1_6_stage_9&#45;&gt;ring_attn_1_6_stage_10</title>
<path fill="none" stroke="black" d="M3747,-12576.87C3747,-12576.87 3747,-12470.25 3747,-12470.25"/>
<polygon fill="black" stroke="black" points="3750.5,-12470.25 3747,-12460.25 3743.5,-12470.25 3750.5,-12470.25"/>
</g>
<!-- ring_attn_1_7_stage_9 -->
<g id="node723" class="node">
<title>ring_attn_1_7_stage_9</title>
<polygon fill="yellow" stroke="black" points="4334,-12713 4125,-12645 4334,-12577 4543,-12645 4334,-12713"/>
<text text-anchor="middle" x="4334" y="-12663.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-12648.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="4334" y="-12633.8" font-family="Times,serif" font-size="14.00">Q[7]×K[14]×V[14]</text>
<text text-anchor="middle" x="4334" y="-12618.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_6_stage_9&#45;&gt;ring_attn_1_7_stage_9 -->
<g id="edge1962" class="edge">
<title>ring_attn_1_6_stage_9&#45;&gt;ring_attn_1_7_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-12645C3956.02,-12645 4114.86,-12645 4114.86,-12645"/>
<polygon fill="red" stroke="red" points="4114.86,-12648.5 4124.86,-12645 4114.86,-12641.5 4114.86,-12648.5"/>
</g>
<!-- ring_attn_1_6_stage_10&#45;&gt;ring_attn_1_6_stage_11 -->
<g id="edge620" class="edge">
<title>ring_attn_1_6_stage_10&#45;&gt;ring_attn_1_6_stage_11</title>
<path fill="none" stroke="black" d="M3747,-12323.87C3747,-12323.87 3747,-12217.25 3747,-12217.25"/>
<polygon fill="black" stroke="black" points="3750.5,-12217.25 3747,-12207.25 3743.5,-12217.25 3750.5,-12217.25"/>
</g>
<!-- ring_attn_1_7_stage_10 -->
<g id="node724" class="node">
<title>ring_attn_1_7_stage_10</title>
<polygon fill="yellow" stroke="black" points="4334,-12460 4125,-12392 4334,-12324 4543,-12392 4334,-12460"/>
<text text-anchor="middle" x="4334" y="-12410.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-12395.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="4334" y="-12380.8" font-family="Times,serif" font-size="14.00">Q[7]×K[13]×V[13]</text>
<text text-anchor="middle" x="4334" y="-12365.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_6_stage_10&#45;&gt;ring_attn_1_7_stage_10 -->
<g id="edge1963" class="edge">
<title>ring_attn_1_6_stage_10&#45;&gt;ring_attn_1_7_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-12392C3956.02,-12392 4114.86,-12392 4114.86,-12392"/>
<polygon fill="red" stroke="red" points="4114.86,-12395.5 4124.86,-12392 4114.86,-12388.5 4114.86,-12395.5"/>
</g>
<!-- ring_attn_1_6_stage_11&#45;&gt;ring_attn_1_6_stage_12 -->
<g id="edge621" class="edge">
<title>ring_attn_1_6_stage_11&#45;&gt;ring_attn_1_6_stage_12</title>
<path fill="none" stroke="black" d="M3747,-12070.87C3747,-12070.87 3747,-11964.25 3747,-11964.25"/>
<polygon fill="black" stroke="black" points="3750.5,-11964.25 3747,-11954.25 3743.5,-11964.25 3750.5,-11964.25"/>
</g>
<!-- ring_attn_1_7_stage_11 -->
<g id="node725" class="node">
<title>ring_attn_1_7_stage_11</title>
<polygon fill="yellow" stroke="black" points="4334,-12207 4125,-12139 4334,-12071 4543,-12139 4334,-12207"/>
<text text-anchor="middle" x="4334" y="-12157.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-12142.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="4334" y="-12127.8" font-family="Times,serif" font-size="14.00">Q[7]×K[12]×V[12]</text>
<text text-anchor="middle" x="4334" y="-12112.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_6_stage_11&#45;&gt;ring_attn_1_7_stage_11 -->
<g id="edge1964" class="edge">
<title>ring_attn_1_6_stage_11&#45;&gt;ring_attn_1_7_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-12139C3956.02,-12139 4114.86,-12139 4114.86,-12139"/>
<polygon fill="red" stroke="red" points="4114.86,-12142.5 4124.86,-12139 4114.86,-12135.5 4114.86,-12142.5"/>
</g>
<!-- ring_attn_1_6_stage_12&#45;&gt;ring_attn_1_6_stage_13 -->
<g id="edge622" class="edge">
<title>ring_attn_1_6_stage_12&#45;&gt;ring_attn_1_6_stage_13</title>
<path fill="none" stroke="black" d="M3747,-11817.87C3747,-11817.87 3747,-11711.25 3747,-11711.25"/>
<polygon fill="black" stroke="black" points="3750.5,-11711.25 3747,-11701.25 3743.5,-11711.25 3750.5,-11711.25"/>
</g>
<!-- ring_attn_1_7_stage_12 -->
<g id="node726" class="node">
<title>ring_attn_1_7_stage_12</title>
<polygon fill="yellow" stroke="black" points="4334,-11954 4125,-11886 4334,-11818 4543,-11886 4334,-11954"/>
<text text-anchor="middle" x="4334" y="-11904.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-11889.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="4334" y="-11874.8" font-family="Times,serif" font-size="14.00">Q[7]×K[11]×V[11]</text>
<text text-anchor="middle" x="4334" y="-11859.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_6_stage_12&#45;&gt;ring_attn_1_7_stage_12 -->
<g id="edge1965" class="edge">
<title>ring_attn_1_6_stage_12&#45;&gt;ring_attn_1_7_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-11886C3956.02,-11886 4114.86,-11886 4114.86,-11886"/>
<polygon fill="red" stroke="red" points="4114.86,-11889.5 4124.86,-11886 4114.86,-11882.5 4114.86,-11889.5"/>
</g>
<!-- ring_attn_1_6_stage_13&#45;&gt;ring_attn_1_6_stage_14 -->
<g id="edge623" class="edge">
<title>ring_attn_1_6_stage_13&#45;&gt;ring_attn_1_6_stage_14</title>
<path fill="none" stroke="black" d="M3747,-11564.87C3747,-11564.87 3747,-11458.25 3747,-11458.25"/>
<polygon fill="black" stroke="black" points="3750.5,-11458.25 3747,-11448.25 3743.5,-11458.25 3750.5,-11458.25"/>
</g>
<!-- ring_attn_1_7_stage_13 -->
<g id="node727" class="node">
<title>ring_attn_1_7_stage_13</title>
<polygon fill="yellow" stroke="black" points="4334,-11701 4125,-11633 4334,-11565 4543,-11633 4334,-11701"/>
<text text-anchor="middle" x="4334" y="-11651.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-11636.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="4334" y="-11621.8" font-family="Times,serif" font-size="14.00">Q[7]×K[10]×V[10]</text>
<text text-anchor="middle" x="4334" y="-11606.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_6_stage_13&#45;&gt;ring_attn_1_7_stage_13 -->
<g id="edge1966" class="edge">
<title>ring_attn_1_6_stage_13&#45;&gt;ring_attn_1_7_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-11633C3956.02,-11633 4114.86,-11633 4114.86,-11633"/>
<polygon fill="red" stroke="red" points="4114.86,-11636.5 4124.86,-11633 4114.86,-11629.5 4114.86,-11636.5"/>
</g>
<!-- ring_attn_1_6_stage_14&#45;&gt;ring_attn_1_6_stage_15 -->
<g id="edge624" class="edge">
<title>ring_attn_1_6_stage_14&#45;&gt;ring_attn_1_6_stage_15</title>
<path fill="none" stroke="black" d="M3747,-11311.87C3747,-11311.87 3747,-11205.25 3747,-11205.25"/>
<polygon fill="black" stroke="black" points="3750.5,-11205.25 3747,-11195.25 3743.5,-11205.25 3750.5,-11205.25"/>
</g>
<!-- ring_attn_1_7_stage_14 -->
<g id="node728" class="node">
<title>ring_attn_1_7_stage_14</title>
<polygon fill="yellow" stroke="black" points="4334,-11448 4125,-11380 4334,-11312 4543,-11380 4334,-11448"/>
<text text-anchor="middle" x="4334" y="-11398.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-11383.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="4334" y="-11368.8" font-family="Times,serif" font-size="14.00">Q[7]×K[9]×V[9]</text>
<text text-anchor="middle" x="4334" y="-11353.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_6_stage_14&#45;&gt;ring_attn_1_7_stage_14 -->
<g id="edge1967" class="edge">
<title>ring_attn_1_6_stage_14&#45;&gt;ring_attn_1_7_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-11380C3956.02,-11380 4114.86,-11380 4114.86,-11380"/>
<polygon fill="red" stroke="red" points="4114.86,-11383.5 4124.86,-11380 4114.86,-11376.5 4114.86,-11383.5"/>
</g>
<!-- attn_out_1_6 -->
<g id="node632" class="node">
<title>attn_out_1_6</title>
<polygon fill="none" stroke="black" points="3816.5,-10986 3677.5,-10986 3677.5,-10933 3816.5,-10933 3816.5,-10986"/>
<text text-anchor="middle" x="3747" y="-10970.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3747" y="-10955.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="3747" y="-10940.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_1_6_stage_15&#45;&gt;attn_out_1_6 -->
<g id="edge625" class="edge">
<title>ring_attn_1_6_stage_15&#45;&gt;attn_out_1_6</title>
<path fill="none" stroke="black" d="M3747,-11058.87C3747,-11058.87 3747,-10996.18 3747,-10996.18"/>
<polygon fill="black" stroke="black" points="3750.5,-10996.18 3747,-10986.18 3743.5,-10996.18 3750.5,-10996.18"/>
</g>
<!-- ring_attn_1_7_stage_15 -->
<g id="node729" class="node">
<title>ring_attn_1_7_stage_15</title>
<polygon fill="yellow" stroke="black" points="4334,-11195 4125,-11127 4334,-11059 4543,-11127 4334,-11195"/>
<text text-anchor="middle" x="4334" y="-11145.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-11130.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="4334" y="-11115.8" font-family="Times,serif" font-size="14.00">Q[7]×K[8]×V[8]</text>
<text text-anchor="middle" x="4334" y="-11100.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_6_stage_15&#45;&gt;ring_attn_1_7_stage_15 -->
<g id="edge1968" class="edge">
<title>ring_attn_1_6_stage_15&#45;&gt;ring_attn_1_7_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-11127C3956.02,-11127 4114.86,-11127 4114.86,-11127"/>
<polygon fill="red" stroke="red" points="4114.86,-11130.5 4124.86,-11127 4114.86,-11123.5 4114.86,-11130.5"/>
</g>
<!-- attn_residual_1_6 -->
<g id="node633" class="node">
<title>attn_residual_1_6</title>
<ellipse fill="none" stroke="black" cx="3747" cy="-10833" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3747" y="-10836.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3747" y="-10821.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_1_6&#45;&gt;attn_residual_1_6 -->
<g id="edge626" class="edge">
<title>attn_out_1_6&#45;&gt;attn_residual_1_6</title>
<path fill="none" stroke="black" d="M3747,-10932.98C3747,-10932.98 3747,-10870.36 3747,-10870.36"/>
<polygon fill="black" stroke="black" points="3750.5,-10870.36 3747,-10860.36 3743.5,-10870.36 3750.5,-10870.36"/>
</g>
<!-- ffn_up_1_6 -->
<g id="node634" class="node">
<title>ffn_up_1_6</title>
<polygon fill="none" stroke="black" points="3826,-10733 3668,-10733 3668,-10680 3826,-10680 3826,-10733"/>
<text text-anchor="middle" x="3747" y="-10717.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3747" y="-10702.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="3747" y="-10687.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_1_6&#45;&gt;ffn_up_1_6 -->
<g id="edge627" class="edge">
<title>attn_residual_1_6&#45;&gt;ffn_up_1_6</title>
<path fill="none" stroke="black" d="M3747,-10805.86C3747,-10805.86 3747,-10743.16 3747,-10743.16"/>
<polygon fill="black" stroke="black" points="3750.5,-10743.16 3747,-10733.16 3743.5,-10743.16 3750.5,-10743.16"/>
</g>
<!-- ffn_gelu_1_6 -->
<g id="node635" class="node">
<title>ffn_gelu_1_6</title>
<ellipse fill="none" stroke="black" cx="3747" cy="-10580" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3747" y="-10583.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3747" y="-10568.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_1_6&#45;&gt;ffn_gelu_1_6 -->
<g id="edge628" class="edge">
<title>ffn_up_1_6&#45;&gt;ffn_gelu_1_6</title>
<path fill="none" stroke="black" d="M3747,-10679.98C3747,-10679.98 3747,-10617.36 3747,-10617.36"/>
<polygon fill="black" stroke="black" points="3750.5,-10617.36 3747,-10607.36 3743.5,-10617.36 3750.5,-10617.36"/>
</g>
<!-- ffn_down_1_6 -->
<g id="node636" class="node">
<title>ffn_down_1_6</title>
<polygon fill="none" stroke="black" points="3836,-10480 3658,-10480 3658,-10427 3836,-10427 3836,-10480"/>
<text text-anchor="middle" x="3747" y="-10464.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3747" y="-10449.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="3747" y="-10434.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_1_6&#45;&gt;ffn_down_1_6 -->
<g id="edge629" class="edge">
<title>ffn_gelu_1_6&#45;&gt;ffn_down_1_6</title>
<path fill="none" stroke="black" d="M3747,-10552.86C3747,-10552.86 3747,-10490.16 3747,-10490.16"/>
<polygon fill="black" stroke="black" points="3750.5,-10490.16 3747,-10480.16 3743.5,-10490.16 3750.5,-10490.16"/>
</g>
<!-- ffn_residual_1_6 -->
<g id="node637" class="node">
<title>ffn_residual_1_6</title>
<ellipse fill="none" stroke="black" cx="3747" cy="-10327" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3747" y="-10330.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3747" y="-10315.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_1_6&#45;&gt;ffn_residual_1_6 -->
<g id="edge630" class="edge">
<title>ffn_down_1_6&#45;&gt;ffn_residual_1_6</title>
<path fill="none" stroke="black" d="M3747,-10426.98C3747,-10426.98 3747,-10364.36 3747,-10364.36"/>
<polygon fill="black" stroke="black" points="3750.5,-10364.36 3747,-10354.36 3743.5,-10364.36 3750.5,-10364.36"/>
</g>
<!-- qkv_proj_2_6 -->
<g id="node638" class="node">
<title>qkv_proj_2_6</title>
<polygon fill="none" stroke="black" points="3829.5,-10227 3664.5,-10227 3664.5,-10174 3829.5,-10174 3829.5,-10227"/>
<text text-anchor="middle" x="3747" y="-10211.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3747" y="-10196.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="3747" y="-10181.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_1_6&#45;&gt;qkv_proj_2_6 -->
<g id="edge631" class="edge">
<title>ffn_residual_1_6&#45;&gt;qkv_proj_2_6</title>
<path fill="none" stroke="black" d="M3747,-10299.86C3747,-10299.86 3747,-10237.16 3747,-10237.16"/>
<polygon fill="black" stroke="black" points="3750.5,-10237.16 3747,-10227.16 3743.5,-10237.16 3750.5,-10237.16"/>
</g>
<!-- qkv_reshape_2_6 -->
<g id="node639" class="node">
<title>qkv_reshape_2_6</title>
<ellipse fill="none" stroke="black" cx="3747" cy="-10074" rx="148" ry="27"/>
<text text-anchor="middle" x="3747" y="-10077.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="3747" y="-10062.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_2_6&#45;&gt;qkv_reshape_2_6 -->
<g id="edge632" class="edge">
<title>qkv_proj_2_6&#45;&gt;qkv_reshape_2_6</title>
<path fill="none" stroke="black" d="M3747,-10173.98C3747,-10173.98 3747,-10111.36 3747,-10111.36"/>
<polygon fill="black" stroke="black" points="3750.5,-10111.36 3747,-10101.36 3743.5,-10111.36 3750.5,-10111.36"/>
</g>
<!-- qkv_reshape_2_6&#45;&gt;ring_attn_2_6_stage_0 -->
<g id="edge633" class="edge">
<title>qkv_reshape_2_6&#45;&gt;ring_attn_2_6_stage_0</title>
<path fill="none" stroke="black" d="M3747,-10046.72C3747,-10046.72 3747,-9940.16 3747,-9940.16"/>
<polygon fill="black" stroke="black" points="3750.5,-9940.16 3747,-9930.16 3743.5,-9940.16 3750.5,-9940.16"/>
</g>
<!-- ring_attn_2_6_stage_0&#45;&gt;ring_attn_2_6_stage_1 -->
<g id="edge634" class="edge">
<title>ring_attn_2_6_stage_0&#45;&gt;ring_attn_2_6_stage_1</title>
<path fill="none" stroke="black" d="M3747,-9793.87C3747,-9793.87 3747,-9687.25 3747,-9687.25"/>
<polygon fill="black" stroke="black" points="3750.5,-9687.25 3747,-9677.25 3743.5,-9687.25 3750.5,-9687.25"/>
</g>
<!-- ring_attn_2_7_stage_0 -->
<g id="node738" class="node">
<title>ring_attn_2_7_stage_0</title>
<polygon fill="yellow" stroke="black" points="4334,-9930 4125,-9862 4334,-9794 4543,-9862 4334,-9930"/>
<text text-anchor="middle" x="4334" y="-9880.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-9865.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="4334" y="-9850.8" font-family="Times,serif" font-size="14.00">Q[7]×K[7]×V[7]</text>
<text text-anchor="middle" x="4334" y="-9835.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_6_stage_0&#45;&gt;ring_attn_2_7_stage_0 -->
<g id="edge1969" class="edge">
<title>ring_attn_2_6_stage_0&#45;&gt;ring_attn_2_7_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-9862C3956.02,-9862 4114.86,-9862 4114.86,-9862"/>
<polygon fill="red" stroke="red" points="4114.86,-9865.5 4124.86,-9862 4114.86,-9858.5 4114.86,-9865.5"/>
</g>
<!-- ring_attn_2_6_stage_1&#45;&gt;ring_attn_2_6_stage_2 -->
<g id="edge635" class="edge">
<title>ring_attn_2_6_stage_1&#45;&gt;ring_attn_2_6_stage_2</title>
<path fill="none" stroke="black" d="M3747,-9540.87C3747,-9540.87 3747,-9434.25 3747,-9434.25"/>
<polygon fill="black" stroke="black" points="3750.5,-9434.25 3747,-9424.25 3743.5,-9434.25 3750.5,-9434.25"/>
</g>
<!-- ring_attn_2_7_stage_1 -->
<g id="node739" class="node">
<title>ring_attn_2_7_stage_1</title>
<polygon fill="yellow" stroke="black" points="4334,-9677 4125,-9609 4334,-9541 4543,-9609 4334,-9677"/>
<text text-anchor="middle" x="4334" y="-9627.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-9612.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="4334" y="-9597.8" font-family="Times,serif" font-size="14.00">Q[7]×K[6]×V[6]</text>
<text text-anchor="middle" x="4334" y="-9582.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_6_stage_1&#45;&gt;ring_attn_2_7_stage_1 -->
<g id="edge1970" class="edge">
<title>ring_attn_2_6_stage_1&#45;&gt;ring_attn_2_7_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-9609C3956.02,-9609 4114.86,-9609 4114.86,-9609"/>
<polygon fill="red" stroke="red" points="4114.86,-9612.5 4124.86,-9609 4114.86,-9605.5 4114.86,-9612.5"/>
</g>
<!-- ring_attn_2_6_stage_2&#45;&gt;ring_attn_2_6_stage_3 -->
<g id="edge636" class="edge">
<title>ring_attn_2_6_stage_2&#45;&gt;ring_attn_2_6_stage_3</title>
<path fill="none" stroke="black" d="M3747,-9287.87C3747,-9287.87 3747,-9181.25 3747,-9181.25"/>
<polygon fill="black" stroke="black" points="3750.5,-9181.25 3747,-9171.25 3743.5,-9181.25 3750.5,-9181.25"/>
</g>
<!-- ring_attn_2_7_stage_2 -->
<g id="node740" class="node">
<title>ring_attn_2_7_stage_2</title>
<polygon fill="yellow" stroke="black" points="4334,-9424 4125,-9356 4334,-9288 4543,-9356 4334,-9424"/>
<text text-anchor="middle" x="4334" y="-9374.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-9359.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="4334" y="-9344.8" font-family="Times,serif" font-size="14.00">Q[7]×K[5]×V[5]</text>
<text text-anchor="middle" x="4334" y="-9329.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_6_stage_2&#45;&gt;ring_attn_2_7_stage_2 -->
<g id="edge1971" class="edge">
<title>ring_attn_2_6_stage_2&#45;&gt;ring_attn_2_7_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-9356C3956.02,-9356 4114.86,-9356 4114.86,-9356"/>
<polygon fill="red" stroke="red" points="4114.86,-9359.5 4124.86,-9356 4114.86,-9352.5 4114.86,-9359.5"/>
</g>
<!-- ring_attn_2_6_stage_3&#45;&gt;ring_attn_2_6_stage_4 -->
<g id="edge637" class="edge">
<title>ring_attn_2_6_stage_3&#45;&gt;ring_attn_2_6_stage_4</title>
<path fill="none" stroke="black" d="M3747,-9034.87C3747,-9034.87 3747,-8928.25 3747,-8928.25"/>
<polygon fill="black" stroke="black" points="3750.5,-8928.25 3747,-8918.25 3743.5,-8928.25 3750.5,-8928.25"/>
</g>
<!-- ring_attn_2_7_stage_3 -->
<g id="node741" class="node">
<title>ring_attn_2_7_stage_3</title>
<polygon fill="yellow" stroke="black" points="4334,-9171 4125,-9103 4334,-9035 4543,-9103 4334,-9171"/>
<text text-anchor="middle" x="4334" y="-9121.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-9106.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="4334" y="-9091.8" font-family="Times,serif" font-size="14.00">Q[7]×K[4]×V[4]</text>
<text text-anchor="middle" x="4334" y="-9076.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_6_stage_3&#45;&gt;ring_attn_2_7_stage_3 -->
<g id="edge1972" class="edge">
<title>ring_attn_2_6_stage_3&#45;&gt;ring_attn_2_7_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-9103C3956.02,-9103 4114.86,-9103 4114.86,-9103"/>
<polygon fill="red" stroke="red" points="4114.86,-9106.5 4124.86,-9103 4114.86,-9099.5 4114.86,-9106.5"/>
</g>
<!-- ring_attn_2_6_stage_4&#45;&gt;ring_attn_2_6_stage_5 -->
<g id="edge638" class="edge">
<title>ring_attn_2_6_stage_4&#45;&gt;ring_attn_2_6_stage_5</title>
<path fill="none" stroke="black" d="M3747,-8781.87C3747,-8781.87 3747,-8675.25 3747,-8675.25"/>
<polygon fill="black" stroke="black" points="3750.5,-8675.25 3747,-8665.25 3743.5,-8675.25 3750.5,-8675.25"/>
</g>
<!-- ring_attn_2_7_stage_4 -->
<g id="node742" class="node">
<title>ring_attn_2_7_stage_4</title>
<polygon fill="yellow" stroke="black" points="4334,-8918 4125,-8850 4334,-8782 4543,-8850 4334,-8918"/>
<text text-anchor="middle" x="4334" y="-8868.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-8853.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="4334" y="-8838.8" font-family="Times,serif" font-size="14.00">Q[7]×K[3]×V[3]</text>
<text text-anchor="middle" x="4334" y="-8823.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_6_stage_4&#45;&gt;ring_attn_2_7_stage_4 -->
<g id="edge1973" class="edge">
<title>ring_attn_2_6_stage_4&#45;&gt;ring_attn_2_7_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-8850C3956.02,-8850 4114.86,-8850 4114.86,-8850"/>
<polygon fill="red" stroke="red" points="4114.86,-8853.5 4124.86,-8850 4114.86,-8846.5 4114.86,-8853.5"/>
</g>
<!-- ring_attn_2_6_stage_5&#45;&gt;ring_attn_2_6_stage_6 -->
<g id="edge639" class="edge">
<title>ring_attn_2_6_stage_5&#45;&gt;ring_attn_2_6_stage_6</title>
<path fill="none" stroke="black" d="M3747,-8528.87C3747,-8528.87 3747,-8422.25 3747,-8422.25"/>
<polygon fill="black" stroke="black" points="3750.5,-8422.25 3747,-8412.25 3743.5,-8422.25 3750.5,-8422.25"/>
</g>
<!-- ring_attn_2_7_stage_5 -->
<g id="node743" class="node">
<title>ring_attn_2_7_stage_5</title>
<polygon fill="yellow" stroke="black" points="4334,-8665 4125,-8597 4334,-8529 4543,-8597 4334,-8665"/>
<text text-anchor="middle" x="4334" y="-8615.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-8600.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="4334" y="-8585.8" font-family="Times,serif" font-size="14.00">Q[7]×K[2]×V[2]</text>
<text text-anchor="middle" x="4334" y="-8570.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_6_stage_5&#45;&gt;ring_attn_2_7_stage_5 -->
<g id="edge1974" class="edge">
<title>ring_attn_2_6_stage_5&#45;&gt;ring_attn_2_7_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-8597C3956.02,-8597 4114.86,-8597 4114.86,-8597"/>
<polygon fill="red" stroke="red" points="4114.86,-8600.5 4124.86,-8597 4114.86,-8593.5 4114.86,-8600.5"/>
</g>
<!-- ring_attn_2_6_stage_6&#45;&gt;ring_attn_2_6_stage_7 -->
<g id="edge640" class="edge">
<title>ring_attn_2_6_stage_6&#45;&gt;ring_attn_2_6_stage_7</title>
<path fill="none" stroke="black" d="M3747,-8275.87C3747,-8275.87 3747,-8169.25 3747,-8169.25"/>
<polygon fill="black" stroke="black" points="3750.5,-8169.25 3747,-8159.25 3743.5,-8169.25 3750.5,-8169.25"/>
</g>
<!-- ring_attn_2_7_stage_6 -->
<g id="node744" class="node">
<title>ring_attn_2_7_stage_6</title>
<polygon fill="yellow" stroke="black" points="4334,-8412 4125,-8344 4334,-8276 4543,-8344 4334,-8412"/>
<text text-anchor="middle" x="4334" y="-8362.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-8347.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="4334" y="-8332.8" font-family="Times,serif" font-size="14.00">Q[7]×K[1]×V[1]</text>
<text text-anchor="middle" x="4334" y="-8317.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_6_stage_6&#45;&gt;ring_attn_2_7_stage_6 -->
<g id="edge1975" class="edge">
<title>ring_attn_2_6_stage_6&#45;&gt;ring_attn_2_7_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-8344C3956.02,-8344 4114.86,-8344 4114.86,-8344"/>
<polygon fill="red" stroke="red" points="4114.86,-8347.5 4124.86,-8344 4114.86,-8340.5 4114.86,-8347.5"/>
</g>
<!-- ring_attn_2_6_stage_7&#45;&gt;ring_attn_2_6_stage_8 -->
<g id="edge641" class="edge">
<title>ring_attn_2_6_stage_7&#45;&gt;ring_attn_2_6_stage_8</title>
<path fill="none" stroke="black" d="M3747,-8022.87C3747,-8022.87 3747,-7916.25 3747,-7916.25"/>
<polygon fill="black" stroke="black" points="3750.5,-7916.25 3747,-7906.25 3743.5,-7916.25 3750.5,-7916.25"/>
</g>
<!-- ring_attn_2_7_stage_7 -->
<g id="node745" class="node">
<title>ring_attn_2_7_stage_7</title>
<polygon fill="yellow" stroke="black" points="4334,-8159 4125,-8091 4334,-8023 4543,-8091 4334,-8159"/>
<text text-anchor="middle" x="4334" y="-8109.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-8094.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="4334" y="-8079.8" font-family="Times,serif" font-size="14.00">Q[7]×K[0]×V[0]</text>
<text text-anchor="middle" x="4334" y="-8064.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_6_stage_7&#45;&gt;ring_attn_2_7_stage_7 -->
<g id="edge1976" class="edge">
<title>ring_attn_2_6_stage_7&#45;&gt;ring_attn_2_7_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-8091C3956.02,-8091 4114.86,-8091 4114.86,-8091"/>
<polygon fill="red" stroke="red" points="4114.86,-8094.5 4124.86,-8091 4114.86,-8087.5 4114.86,-8094.5"/>
</g>
<!-- ring_attn_2_6_stage_8&#45;&gt;ring_attn_2_6_stage_9 -->
<g id="edge642" class="edge">
<title>ring_attn_2_6_stage_8&#45;&gt;ring_attn_2_6_stage_9</title>
<path fill="none" stroke="black" d="M3747,-7769.87C3747,-7769.87 3747,-7663.25 3747,-7663.25"/>
<polygon fill="black" stroke="black" points="3750.5,-7663.25 3747,-7653.25 3743.5,-7663.25 3750.5,-7663.25"/>
</g>
<!-- ring_attn_2_7_stage_8 -->
<g id="node746" class="node">
<title>ring_attn_2_7_stage_8</title>
<polygon fill="yellow" stroke="black" points="4334,-7906 4125,-7838 4334,-7770 4543,-7838 4334,-7906"/>
<text text-anchor="middle" x="4334" y="-7856.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-7841.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="4334" y="-7826.8" font-family="Times,serif" font-size="14.00">Q[7]×K[15]×V[15]</text>
<text text-anchor="middle" x="4334" y="-7811.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_6_stage_8&#45;&gt;ring_attn_2_7_stage_8 -->
<g id="edge1977" class="edge">
<title>ring_attn_2_6_stage_8&#45;&gt;ring_attn_2_7_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-7838C3956.02,-7838 4114.86,-7838 4114.86,-7838"/>
<polygon fill="red" stroke="red" points="4114.86,-7841.5 4124.86,-7838 4114.86,-7834.5 4114.86,-7841.5"/>
</g>
<!-- ring_attn_2_6_stage_9&#45;&gt;ring_attn_2_6_stage_10 -->
<g id="edge643" class="edge">
<title>ring_attn_2_6_stage_9&#45;&gt;ring_attn_2_6_stage_10</title>
<path fill="none" stroke="black" d="M3747,-7516.87C3747,-7516.87 3747,-7410.25 3747,-7410.25"/>
<polygon fill="black" stroke="black" points="3750.5,-7410.25 3747,-7400.25 3743.5,-7410.25 3750.5,-7410.25"/>
</g>
<!-- ring_attn_2_7_stage_9 -->
<g id="node747" class="node">
<title>ring_attn_2_7_stage_9</title>
<polygon fill="yellow" stroke="black" points="4334,-7653 4125,-7585 4334,-7517 4543,-7585 4334,-7653"/>
<text text-anchor="middle" x="4334" y="-7603.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-7588.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="4334" y="-7573.8" font-family="Times,serif" font-size="14.00">Q[7]×K[14]×V[14]</text>
<text text-anchor="middle" x="4334" y="-7558.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_6_stage_9&#45;&gt;ring_attn_2_7_stage_9 -->
<g id="edge1978" class="edge">
<title>ring_attn_2_6_stage_9&#45;&gt;ring_attn_2_7_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-7585C3956.02,-7585 4114.86,-7585 4114.86,-7585"/>
<polygon fill="red" stroke="red" points="4114.86,-7588.5 4124.86,-7585 4114.86,-7581.5 4114.86,-7588.5"/>
</g>
<!-- ring_attn_2_6_stage_10&#45;&gt;ring_attn_2_6_stage_11 -->
<g id="edge644" class="edge">
<title>ring_attn_2_6_stage_10&#45;&gt;ring_attn_2_6_stage_11</title>
<path fill="none" stroke="black" d="M3747,-7263.87C3747,-7263.87 3747,-7157.25 3747,-7157.25"/>
<polygon fill="black" stroke="black" points="3750.5,-7157.25 3747,-7147.25 3743.5,-7157.25 3750.5,-7157.25"/>
</g>
<!-- ring_attn_2_7_stage_10 -->
<g id="node748" class="node">
<title>ring_attn_2_7_stage_10</title>
<polygon fill="yellow" stroke="black" points="4334,-7400 4125,-7332 4334,-7264 4543,-7332 4334,-7400"/>
<text text-anchor="middle" x="4334" y="-7350.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-7335.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="4334" y="-7320.8" font-family="Times,serif" font-size="14.00">Q[7]×K[13]×V[13]</text>
<text text-anchor="middle" x="4334" y="-7305.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_6_stage_10&#45;&gt;ring_attn_2_7_stage_10 -->
<g id="edge1979" class="edge">
<title>ring_attn_2_6_stage_10&#45;&gt;ring_attn_2_7_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-7332C3956.02,-7332 4114.86,-7332 4114.86,-7332"/>
<polygon fill="red" stroke="red" points="4114.86,-7335.5 4124.86,-7332 4114.86,-7328.5 4114.86,-7335.5"/>
</g>
<!-- ring_attn_2_6_stage_11&#45;&gt;ring_attn_2_6_stage_12 -->
<g id="edge645" class="edge">
<title>ring_attn_2_6_stage_11&#45;&gt;ring_attn_2_6_stage_12</title>
<path fill="none" stroke="black" d="M3747,-7010.87C3747,-7010.87 3747,-6904.25 3747,-6904.25"/>
<polygon fill="black" stroke="black" points="3750.5,-6904.25 3747,-6894.25 3743.5,-6904.25 3750.5,-6904.25"/>
</g>
<!-- ring_attn_2_7_stage_11 -->
<g id="node749" class="node">
<title>ring_attn_2_7_stage_11</title>
<polygon fill="yellow" stroke="black" points="4334,-7147 4125,-7079 4334,-7011 4543,-7079 4334,-7147"/>
<text text-anchor="middle" x="4334" y="-7097.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-7082.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="4334" y="-7067.8" font-family="Times,serif" font-size="14.00">Q[7]×K[12]×V[12]</text>
<text text-anchor="middle" x="4334" y="-7052.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_6_stage_11&#45;&gt;ring_attn_2_7_stage_11 -->
<g id="edge1980" class="edge">
<title>ring_attn_2_6_stage_11&#45;&gt;ring_attn_2_7_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-7079C3956.02,-7079 4114.86,-7079 4114.86,-7079"/>
<polygon fill="red" stroke="red" points="4114.86,-7082.5 4124.86,-7079 4114.86,-7075.5 4114.86,-7082.5"/>
</g>
<!-- ring_attn_2_6_stage_12&#45;&gt;ring_attn_2_6_stage_13 -->
<g id="edge646" class="edge">
<title>ring_attn_2_6_stage_12&#45;&gt;ring_attn_2_6_stage_13</title>
<path fill="none" stroke="black" d="M3747,-6757.87C3747,-6757.87 3747,-6651.25 3747,-6651.25"/>
<polygon fill="black" stroke="black" points="3750.5,-6651.25 3747,-6641.25 3743.5,-6651.25 3750.5,-6651.25"/>
</g>
<!-- ring_attn_2_7_stage_12 -->
<g id="node750" class="node">
<title>ring_attn_2_7_stage_12</title>
<polygon fill="yellow" stroke="black" points="4334,-6894 4125,-6826 4334,-6758 4543,-6826 4334,-6894"/>
<text text-anchor="middle" x="4334" y="-6844.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-6829.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="4334" y="-6814.8" font-family="Times,serif" font-size="14.00">Q[7]×K[11]×V[11]</text>
<text text-anchor="middle" x="4334" y="-6799.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_6_stage_12&#45;&gt;ring_attn_2_7_stage_12 -->
<g id="edge1981" class="edge">
<title>ring_attn_2_6_stage_12&#45;&gt;ring_attn_2_7_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-6826C3956.02,-6826 4114.86,-6826 4114.86,-6826"/>
<polygon fill="red" stroke="red" points="4114.86,-6829.5 4124.86,-6826 4114.86,-6822.5 4114.86,-6829.5"/>
</g>
<!-- ring_attn_2_6_stage_13&#45;&gt;ring_attn_2_6_stage_14 -->
<g id="edge647" class="edge">
<title>ring_attn_2_6_stage_13&#45;&gt;ring_attn_2_6_stage_14</title>
<path fill="none" stroke="black" d="M3747,-6504.87C3747,-6504.87 3747,-6398.25 3747,-6398.25"/>
<polygon fill="black" stroke="black" points="3750.5,-6398.25 3747,-6388.25 3743.5,-6398.25 3750.5,-6398.25"/>
</g>
<!-- ring_attn_2_7_stage_13 -->
<g id="node751" class="node">
<title>ring_attn_2_7_stage_13</title>
<polygon fill="yellow" stroke="black" points="4334,-6641 4125,-6573 4334,-6505 4543,-6573 4334,-6641"/>
<text text-anchor="middle" x="4334" y="-6591.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-6576.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="4334" y="-6561.8" font-family="Times,serif" font-size="14.00">Q[7]×K[10]×V[10]</text>
<text text-anchor="middle" x="4334" y="-6546.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_6_stage_13&#45;&gt;ring_attn_2_7_stage_13 -->
<g id="edge1982" class="edge">
<title>ring_attn_2_6_stage_13&#45;&gt;ring_attn_2_7_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-6573C3956.02,-6573 4114.86,-6573 4114.86,-6573"/>
<polygon fill="red" stroke="red" points="4114.86,-6576.5 4124.86,-6573 4114.86,-6569.5 4114.86,-6576.5"/>
</g>
<!-- ring_attn_2_6_stage_14&#45;&gt;ring_attn_2_6_stage_15 -->
<g id="edge648" class="edge">
<title>ring_attn_2_6_stage_14&#45;&gt;ring_attn_2_6_stage_15</title>
<path fill="none" stroke="black" d="M3747,-6251.87C3747,-6251.87 3747,-6145.25 3747,-6145.25"/>
<polygon fill="black" stroke="black" points="3750.5,-6145.25 3747,-6135.25 3743.5,-6145.25 3750.5,-6145.25"/>
</g>
<!-- ring_attn_2_7_stage_14 -->
<g id="node752" class="node">
<title>ring_attn_2_7_stage_14</title>
<polygon fill="yellow" stroke="black" points="4334,-6388 4125,-6320 4334,-6252 4543,-6320 4334,-6388"/>
<text text-anchor="middle" x="4334" y="-6338.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-6323.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="4334" y="-6308.8" font-family="Times,serif" font-size="14.00">Q[7]×K[9]×V[9]</text>
<text text-anchor="middle" x="4334" y="-6293.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_6_stage_14&#45;&gt;ring_attn_2_7_stage_14 -->
<g id="edge1983" class="edge">
<title>ring_attn_2_6_stage_14&#45;&gt;ring_attn_2_7_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-6320C3956.02,-6320 4114.86,-6320 4114.86,-6320"/>
<polygon fill="red" stroke="red" points="4114.86,-6323.5 4124.86,-6320 4114.86,-6316.5 4114.86,-6323.5"/>
</g>
<!-- attn_out_2_6 -->
<g id="node656" class="node">
<title>attn_out_2_6</title>
<polygon fill="none" stroke="black" points="3816.5,-5926 3677.5,-5926 3677.5,-5873 3816.5,-5873 3816.5,-5926"/>
<text text-anchor="middle" x="3747" y="-5910.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3747" y="-5895.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="3747" y="-5880.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_2_6_stage_15&#45;&gt;attn_out_2_6 -->
<g id="edge649" class="edge">
<title>ring_attn_2_6_stage_15&#45;&gt;attn_out_2_6</title>
<path fill="none" stroke="black" d="M3747,-5998.87C3747,-5998.87 3747,-5936.18 3747,-5936.18"/>
<polygon fill="black" stroke="black" points="3750.5,-5936.18 3747,-5926.18 3743.5,-5936.18 3750.5,-5936.18"/>
</g>
<!-- ring_attn_2_7_stage_15 -->
<g id="node753" class="node">
<title>ring_attn_2_7_stage_15</title>
<polygon fill="yellow" stroke="black" points="4334,-6135 4125,-6067 4334,-5999 4543,-6067 4334,-6135"/>
<text text-anchor="middle" x="4334" y="-6085.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-6070.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="4334" y="-6055.8" font-family="Times,serif" font-size="14.00">Q[7]×K[8]×V[8]</text>
<text text-anchor="middle" x="4334" y="-6040.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_6_stage_15&#45;&gt;ring_attn_2_7_stage_15 -->
<g id="edge1984" class="edge">
<title>ring_attn_2_6_stage_15&#45;&gt;ring_attn_2_7_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-6067C3956.02,-6067 4114.86,-6067 4114.86,-6067"/>
<polygon fill="red" stroke="red" points="4114.86,-6070.5 4124.86,-6067 4114.86,-6063.5 4114.86,-6070.5"/>
</g>
<!-- attn_residual_2_6 -->
<g id="node657" class="node">
<title>attn_residual_2_6</title>
<ellipse fill="none" stroke="black" cx="3747" cy="-5773" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3747" y="-5776.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3747" y="-5761.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_2_6&#45;&gt;attn_residual_2_6 -->
<g id="edge650" class="edge">
<title>attn_out_2_6&#45;&gt;attn_residual_2_6</title>
<path fill="none" stroke="black" d="M3747,-5872.98C3747,-5872.98 3747,-5810.36 3747,-5810.36"/>
<polygon fill="black" stroke="black" points="3750.5,-5810.36 3747,-5800.36 3743.5,-5810.36 3750.5,-5810.36"/>
</g>
<!-- ffn_up_2_6 -->
<g id="node658" class="node">
<title>ffn_up_2_6</title>
<polygon fill="none" stroke="black" points="3826,-5673 3668,-5673 3668,-5620 3826,-5620 3826,-5673"/>
<text text-anchor="middle" x="3747" y="-5657.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3747" y="-5642.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="3747" y="-5627.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_2_6&#45;&gt;ffn_up_2_6 -->
<g id="edge651" class="edge">
<title>attn_residual_2_6&#45;&gt;ffn_up_2_6</title>
<path fill="none" stroke="black" d="M3747,-5745.86C3747,-5745.86 3747,-5683.16 3747,-5683.16"/>
<polygon fill="black" stroke="black" points="3750.5,-5683.16 3747,-5673.16 3743.5,-5683.16 3750.5,-5683.16"/>
</g>
<!-- ffn_gelu_2_6 -->
<g id="node659" class="node">
<title>ffn_gelu_2_6</title>
<ellipse fill="none" stroke="black" cx="3747" cy="-5520" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3747" y="-5523.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3747" y="-5508.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_2_6&#45;&gt;ffn_gelu_2_6 -->
<g id="edge652" class="edge">
<title>ffn_up_2_6&#45;&gt;ffn_gelu_2_6</title>
<path fill="none" stroke="black" d="M3747,-5619.98C3747,-5619.98 3747,-5557.36 3747,-5557.36"/>
<polygon fill="black" stroke="black" points="3750.5,-5557.36 3747,-5547.36 3743.5,-5557.36 3750.5,-5557.36"/>
</g>
<!-- ffn_down_2_6 -->
<g id="node660" class="node">
<title>ffn_down_2_6</title>
<polygon fill="none" stroke="black" points="3836,-5420 3658,-5420 3658,-5367 3836,-5367 3836,-5420"/>
<text text-anchor="middle" x="3747" y="-5404.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3747" y="-5389.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="3747" y="-5374.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_2_6&#45;&gt;ffn_down_2_6 -->
<g id="edge653" class="edge">
<title>ffn_gelu_2_6&#45;&gt;ffn_down_2_6</title>
<path fill="none" stroke="black" d="M3747,-5492.86C3747,-5492.86 3747,-5430.16 3747,-5430.16"/>
<polygon fill="black" stroke="black" points="3750.5,-5430.16 3747,-5420.16 3743.5,-5430.16 3750.5,-5430.16"/>
</g>
<!-- ffn_residual_2_6 -->
<g id="node661" class="node">
<title>ffn_residual_2_6</title>
<ellipse fill="none" stroke="black" cx="3747" cy="-5267" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3747" y="-5270.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3747" y="-5255.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_2_6&#45;&gt;ffn_residual_2_6 -->
<g id="edge654" class="edge">
<title>ffn_down_2_6&#45;&gt;ffn_residual_2_6</title>
<path fill="none" stroke="black" d="M3747,-5366.98C3747,-5366.98 3747,-5304.36 3747,-5304.36"/>
<polygon fill="black" stroke="black" points="3750.5,-5304.36 3747,-5294.36 3743.5,-5304.36 3750.5,-5304.36"/>
</g>
<!-- qkv_proj_3_6 -->
<g id="node662" class="node">
<title>qkv_proj_3_6</title>
<polygon fill="none" stroke="black" points="3829.5,-5167 3664.5,-5167 3664.5,-5114 3829.5,-5114 3829.5,-5167"/>
<text text-anchor="middle" x="3747" y="-5151.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3747" y="-5136.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="3747" y="-5121.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_2_6&#45;&gt;qkv_proj_3_6 -->
<g id="edge655" class="edge">
<title>ffn_residual_2_6&#45;&gt;qkv_proj_3_6</title>
<path fill="none" stroke="black" d="M3747,-5239.86C3747,-5239.86 3747,-5177.16 3747,-5177.16"/>
<polygon fill="black" stroke="black" points="3750.5,-5177.16 3747,-5167.16 3743.5,-5177.16 3750.5,-5177.16"/>
</g>
<!-- qkv_reshape_3_6 -->
<g id="node663" class="node">
<title>qkv_reshape_3_6</title>
<ellipse fill="none" stroke="black" cx="3747" cy="-5014" rx="148" ry="27"/>
<text text-anchor="middle" x="3747" y="-5017.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="3747" y="-5002.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_3_6&#45;&gt;qkv_reshape_3_6 -->
<g id="edge656" class="edge">
<title>qkv_proj_3_6&#45;&gt;qkv_reshape_3_6</title>
<path fill="none" stroke="black" d="M3747,-5113.98C3747,-5113.98 3747,-5051.36 3747,-5051.36"/>
<polygon fill="black" stroke="black" points="3750.5,-5051.36 3747,-5041.36 3743.5,-5051.36 3750.5,-5051.36"/>
</g>
<!-- qkv_reshape_3_6&#45;&gt;ring_attn_3_6_stage_0 -->
<g id="edge657" class="edge">
<title>qkv_reshape_3_6&#45;&gt;ring_attn_3_6_stage_0</title>
<path fill="none" stroke="black" d="M3747,-4986.72C3747,-4986.72 3747,-4880.16 3747,-4880.16"/>
<polygon fill="black" stroke="black" points="3750.5,-4880.16 3747,-4870.16 3743.5,-4880.16 3750.5,-4880.16"/>
</g>
<!-- ring_attn_3_6_stage_0&#45;&gt;ring_attn_3_6_stage_1 -->
<g id="edge658" class="edge">
<title>ring_attn_3_6_stage_0&#45;&gt;ring_attn_3_6_stage_1</title>
<path fill="none" stroke="black" d="M3747,-4733.87C3747,-4733.87 3747,-4627.25 3747,-4627.25"/>
<polygon fill="black" stroke="black" points="3750.5,-4627.25 3747,-4617.25 3743.5,-4627.25 3750.5,-4627.25"/>
</g>
<!-- ring_attn_3_7_stage_0 -->
<g id="node762" class="node">
<title>ring_attn_3_7_stage_0</title>
<polygon fill="yellow" stroke="black" points="4334,-4870 4125,-4802 4334,-4734 4543,-4802 4334,-4870"/>
<text text-anchor="middle" x="4334" y="-4820.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-4805.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="4334" y="-4790.8" font-family="Times,serif" font-size="14.00">Q[7]×K[7]×V[7]</text>
<text text-anchor="middle" x="4334" y="-4775.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_6_stage_0&#45;&gt;ring_attn_3_7_stage_0 -->
<g id="edge1985" class="edge">
<title>ring_attn_3_6_stage_0&#45;&gt;ring_attn_3_7_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-4802C3956.02,-4802 4114.86,-4802 4114.86,-4802"/>
<polygon fill="red" stroke="red" points="4114.86,-4805.5 4124.86,-4802 4114.86,-4798.5 4114.86,-4805.5"/>
</g>
<!-- ring_attn_3_6_stage_1&#45;&gt;ring_attn_3_6_stage_2 -->
<g id="edge659" class="edge">
<title>ring_attn_3_6_stage_1&#45;&gt;ring_attn_3_6_stage_2</title>
<path fill="none" stroke="black" d="M3747,-4480.87C3747,-4480.87 3747,-4374.25 3747,-4374.25"/>
<polygon fill="black" stroke="black" points="3750.5,-4374.25 3747,-4364.25 3743.5,-4374.25 3750.5,-4374.25"/>
</g>
<!-- ring_attn_3_7_stage_1 -->
<g id="node763" class="node">
<title>ring_attn_3_7_stage_1</title>
<polygon fill="yellow" stroke="black" points="4334,-4617 4125,-4549 4334,-4481 4543,-4549 4334,-4617"/>
<text text-anchor="middle" x="4334" y="-4567.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-4552.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="4334" y="-4537.8" font-family="Times,serif" font-size="14.00">Q[7]×K[6]×V[6]</text>
<text text-anchor="middle" x="4334" y="-4522.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_6_stage_1&#45;&gt;ring_attn_3_7_stage_1 -->
<g id="edge1986" class="edge">
<title>ring_attn_3_6_stage_1&#45;&gt;ring_attn_3_7_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-4549C3956.02,-4549 4114.86,-4549 4114.86,-4549"/>
<polygon fill="red" stroke="red" points="4114.86,-4552.5 4124.86,-4549 4114.86,-4545.5 4114.86,-4552.5"/>
</g>
<!-- ring_attn_3_6_stage_2&#45;&gt;ring_attn_3_6_stage_3 -->
<g id="edge660" class="edge">
<title>ring_attn_3_6_stage_2&#45;&gt;ring_attn_3_6_stage_3</title>
<path fill="none" stroke="black" d="M3747,-4227.87C3747,-4227.87 3747,-4121.25 3747,-4121.25"/>
<polygon fill="black" stroke="black" points="3750.5,-4121.25 3747,-4111.25 3743.5,-4121.25 3750.5,-4121.25"/>
</g>
<!-- ring_attn_3_7_stage_2 -->
<g id="node764" class="node">
<title>ring_attn_3_7_stage_2</title>
<polygon fill="yellow" stroke="black" points="4334,-4364 4125,-4296 4334,-4228 4543,-4296 4334,-4364"/>
<text text-anchor="middle" x="4334" y="-4314.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-4299.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="4334" y="-4284.8" font-family="Times,serif" font-size="14.00">Q[7]×K[5]×V[5]</text>
<text text-anchor="middle" x="4334" y="-4269.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_6_stage_2&#45;&gt;ring_attn_3_7_stage_2 -->
<g id="edge1987" class="edge">
<title>ring_attn_3_6_stage_2&#45;&gt;ring_attn_3_7_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-4296C3956.02,-4296 4114.86,-4296 4114.86,-4296"/>
<polygon fill="red" stroke="red" points="4114.86,-4299.5 4124.86,-4296 4114.86,-4292.5 4114.86,-4299.5"/>
</g>
<!-- ring_attn_3_6_stage_3&#45;&gt;ring_attn_3_6_stage_4 -->
<g id="edge661" class="edge">
<title>ring_attn_3_6_stage_3&#45;&gt;ring_attn_3_6_stage_4</title>
<path fill="none" stroke="black" d="M3747,-3974.87C3747,-3974.87 3747,-3868.25 3747,-3868.25"/>
<polygon fill="black" stroke="black" points="3750.5,-3868.25 3747,-3858.25 3743.5,-3868.25 3750.5,-3868.25"/>
</g>
<!-- ring_attn_3_7_stage_3 -->
<g id="node765" class="node">
<title>ring_attn_3_7_stage_3</title>
<polygon fill="yellow" stroke="black" points="4334,-4111 4125,-4043 4334,-3975 4543,-4043 4334,-4111"/>
<text text-anchor="middle" x="4334" y="-4061.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-4046.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="4334" y="-4031.8" font-family="Times,serif" font-size="14.00">Q[7]×K[4]×V[4]</text>
<text text-anchor="middle" x="4334" y="-4016.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_6_stage_3&#45;&gt;ring_attn_3_7_stage_3 -->
<g id="edge1988" class="edge">
<title>ring_attn_3_6_stage_3&#45;&gt;ring_attn_3_7_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-4043C3956.02,-4043 4114.86,-4043 4114.86,-4043"/>
<polygon fill="red" stroke="red" points="4114.86,-4046.5 4124.86,-4043 4114.86,-4039.5 4114.86,-4046.5"/>
</g>
<!-- ring_attn_3_6_stage_4&#45;&gt;ring_attn_3_6_stage_5 -->
<g id="edge662" class="edge">
<title>ring_attn_3_6_stage_4&#45;&gt;ring_attn_3_6_stage_5</title>
<path fill="none" stroke="black" d="M3747,-3721.87C3747,-3721.87 3747,-3615.25 3747,-3615.25"/>
<polygon fill="black" stroke="black" points="3750.5,-3615.25 3747,-3605.25 3743.5,-3615.25 3750.5,-3615.25"/>
</g>
<!-- ring_attn_3_7_stage_4 -->
<g id="node766" class="node">
<title>ring_attn_3_7_stage_4</title>
<polygon fill="yellow" stroke="black" points="4334,-3858 4125,-3790 4334,-3722 4543,-3790 4334,-3858"/>
<text text-anchor="middle" x="4334" y="-3808.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-3793.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="4334" y="-3778.8" font-family="Times,serif" font-size="14.00">Q[7]×K[3]×V[3]</text>
<text text-anchor="middle" x="4334" y="-3763.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_6_stage_4&#45;&gt;ring_attn_3_7_stage_4 -->
<g id="edge1989" class="edge">
<title>ring_attn_3_6_stage_4&#45;&gt;ring_attn_3_7_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-3790C3956.02,-3790 4114.86,-3790 4114.86,-3790"/>
<polygon fill="red" stroke="red" points="4114.86,-3793.5 4124.86,-3790 4114.86,-3786.5 4114.86,-3793.5"/>
</g>
<!-- ring_attn_3_6_stage_5&#45;&gt;ring_attn_3_6_stage_6 -->
<g id="edge663" class="edge">
<title>ring_attn_3_6_stage_5&#45;&gt;ring_attn_3_6_stage_6</title>
<path fill="none" stroke="black" d="M3747,-3468.87C3747,-3468.87 3747,-3362.25 3747,-3362.25"/>
<polygon fill="black" stroke="black" points="3750.5,-3362.25 3747,-3352.25 3743.5,-3362.25 3750.5,-3362.25"/>
</g>
<!-- ring_attn_3_7_stage_5 -->
<g id="node767" class="node">
<title>ring_attn_3_7_stage_5</title>
<polygon fill="yellow" stroke="black" points="4334,-3605 4125,-3537 4334,-3469 4543,-3537 4334,-3605"/>
<text text-anchor="middle" x="4334" y="-3555.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-3540.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="4334" y="-3525.8" font-family="Times,serif" font-size="14.00">Q[7]×K[2]×V[2]</text>
<text text-anchor="middle" x="4334" y="-3510.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_6_stage_5&#45;&gt;ring_attn_3_7_stage_5 -->
<g id="edge1990" class="edge">
<title>ring_attn_3_6_stage_5&#45;&gt;ring_attn_3_7_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-3537C3956.02,-3537 4114.86,-3537 4114.86,-3537"/>
<polygon fill="red" stroke="red" points="4114.86,-3540.5 4124.86,-3537 4114.86,-3533.5 4114.86,-3540.5"/>
</g>
<!-- ring_attn_3_6_stage_6&#45;&gt;ring_attn_3_6_stage_7 -->
<g id="edge664" class="edge">
<title>ring_attn_3_6_stage_6&#45;&gt;ring_attn_3_6_stage_7</title>
<path fill="none" stroke="black" d="M3747,-3215.87C3747,-3215.87 3747,-3109.25 3747,-3109.25"/>
<polygon fill="black" stroke="black" points="3750.5,-3109.25 3747,-3099.25 3743.5,-3109.25 3750.5,-3109.25"/>
</g>
<!-- ring_attn_3_7_stage_6 -->
<g id="node768" class="node">
<title>ring_attn_3_7_stage_6</title>
<polygon fill="yellow" stroke="black" points="4334,-3352 4125,-3284 4334,-3216 4543,-3284 4334,-3352"/>
<text text-anchor="middle" x="4334" y="-3302.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-3287.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="4334" y="-3272.8" font-family="Times,serif" font-size="14.00">Q[7]×K[1]×V[1]</text>
<text text-anchor="middle" x="4334" y="-3257.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_6_stage_6&#45;&gt;ring_attn_3_7_stage_6 -->
<g id="edge1991" class="edge">
<title>ring_attn_3_6_stage_6&#45;&gt;ring_attn_3_7_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-3284C3956.02,-3284 4114.86,-3284 4114.86,-3284"/>
<polygon fill="red" stroke="red" points="4114.86,-3287.5 4124.86,-3284 4114.86,-3280.5 4114.86,-3287.5"/>
</g>
<!-- ring_attn_3_6_stage_7&#45;&gt;ring_attn_3_6_stage_8 -->
<g id="edge665" class="edge">
<title>ring_attn_3_6_stage_7&#45;&gt;ring_attn_3_6_stage_8</title>
<path fill="none" stroke="black" d="M3747,-2962.87C3747,-2962.87 3747,-2856.25 3747,-2856.25"/>
<polygon fill="black" stroke="black" points="3750.5,-2856.25 3747,-2846.25 3743.5,-2856.25 3750.5,-2856.25"/>
</g>
<!-- ring_attn_3_7_stage_7 -->
<g id="node769" class="node">
<title>ring_attn_3_7_stage_7</title>
<polygon fill="yellow" stroke="black" points="4334,-3099 4125,-3031 4334,-2963 4543,-3031 4334,-3099"/>
<text text-anchor="middle" x="4334" y="-3049.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-3034.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="4334" y="-3019.8" font-family="Times,serif" font-size="14.00">Q[7]×K[0]×V[0]</text>
<text text-anchor="middle" x="4334" y="-3004.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_6_stage_7&#45;&gt;ring_attn_3_7_stage_7 -->
<g id="edge1992" class="edge">
<title>ring_attn_3_6_stage_7&#45;&gt;ring_attn_3_7_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-3031C3956.02,-3031 4114.86,-3031 4114.86,-3031"/>
<polygon fill="red" stroke="red" points="4114.86,-3034.5 4124.86,-3031 4114.86,-3027.5 4114.86,-3034.5"/>
</g>
<!-- ring_attn_3_6_stage_8&#45;&gt;ring_attn_3_6_stage_9 -->
<g id="edge666" class="edge">
<title>ring_attn_3_6_stage_8&#45;&gt;ring_attn_3_6_stage_9</title>
<path fill="none" stroke="black" d="M3747,-2709.87C3747,-2709.87 3747,-2603.25 3747,-2603.25"/>
<polygon fill="black" stroke="black" points="3750.5,-2603.25 3747,-2593.25 3743.5,-2603.25 3750.5,-2603.25"/>
</g>
<!-- ring_attn_3_7_stage_8 -->
<g id="node770" class="node">
<title>ring_attn_3_7_stage_8</title>
<polygon fill="yellow" stroke="black" points="4334,-2846 4125,-2778 4334,-2710 4543,-2778 4334,-2846"/>
<text text-anchor="middle" x="4334" y="-2796.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-2781.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="4334" y="-2766.8" font-family="Times,serif" font-size="14.00">Q[7]×K[15]×V[15]</text>
<text text-anchor="middle" x="4334" y="-2751.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_6_stage_8&#45;&gt;ring_attn_3_7_stage_8 -->
<g id="edge1993" class="edge">
<title>ring_attn_3_6_stage_8&#45;&gt;ring_attn_3_7_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-2778C3956.02,-2778 4114.86,-2778 4114.86,-2778"/>
<polygon fill="red" stroke="red" points="4114.86,-2781.5 4124.86,-2778 4114.86,-2774.5 4114.86,-2781.5"/>
</g>
<!-- ring_attn_3_6_stage_9&#45;&gt;ring_attn_3_6_stage_10 -->
<g id="edge667" class="edge">
<title>ring_attn_3_6_stage_9&#45;&gt;ring_attn_3_6_stage_10</title>
<path fill="none" stroke="black" d="M3747,-2456.87C3747,-2456.87 3747,-2350.25 3747,-2350.25"/>
<polygon fill="black" stroke="black" points="3750.5,-2350.25 3747,-2340.25 3743.5,-2350.25 3750.5,-2350.25"/>
</g>
<!-- ring_attn_3_7_stage_9 -->
<g id="node771" class="node">
<title>ring_attn_3_7_stage_9</title>
<polygon fill="yellow" stroke="black" points="4334,-2593 4125,-2525 4334,-2457 4543,-2525 4334,-2593"/>
<text text-anchor="middle" x="4334" y="-2543.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-2528.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="4334" y="-2513.8" font-family="Times,serif" font-size="14.00">Q[7]×K[14]×V[14]</text>
<text text-anchor="middle" x="4334" y="-2498.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_6_stage_9&#45;&gt;ring_attn_3_7_stage_9 -->
<g id="edge1994" class="edge">
<title>ring_attn_3_6_stage_9&#45;&gt;ring_attn_3_7_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-2525C3956.02,-2525 4114.86,-2525 4114.86,-2525"/>
<polygon fill="red" stroke="red" points="4114.86,-2528.5 4124.86,-2525 4114.86,-2521.5 4114.86,-2528.5"/>
</g>
<!-- ring_attn_3_6_stage_10&#45;&gt;ring_attn_3_6_stage_11 -->
<g id="edge668" class="edge">
<title>ring_attn_3_6_stage_10&#45;&gt;ring_attn_3_6_stage_11</title>
<path fill="none" stroke="black" d="M3747,-2203.87C3747,-2203.87 3747,-2097.25 3747,-2097.25"/>
<polygon fill="black" stroke="black" points="3750.5,-2097.25 3747,-2087.25 3743.5,-2097.25 3750.5,-2097.25"/>
</g>
<!-- ring_attn_3_7_stage_10 -->
<g id="node772" class="node">
<title>ring_attn_3_7_stage_10</title>
<polygon fill="yellow" stroke="black" points="4334,-2340 4125,-2272 4334,-2204 4543,-2272 4334,-2340"/>
<text text-anchor="middle" x="4334" y="-2290.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-2275.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="4334" y="-2260.8" font-family="Times,serif" font-size="14.00">Q[7]×K[13]×V[13]</text>
<text text-anchor="middle" x="4334" y="-2245.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_6_stage_10&#45;&gt;ring_attn_3_7_stage_10 -->
<g id="edge1995" class="edge">
<title>ring_attn_3_6_stage_10&#45;&gt;ring_attn_3_7_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-2272C3956.02,-2272 4114.86,-2272 4114.86,-2272"/>
<polygon fill="red" stroke="red" points="4114.86,-2275.5 4124.86,-2272 4114.86,-2268.5 4114.86,-2275.5"/>
</g>
<!-- ring_attn_3_6_stage_11&#45;&gt;ring_attn_3_6_stage_12 -->
<g id="edge669" class="edge">
<title>ring_attn_3_6_stage_11&#45;&gt;ring_attn_3_6_stage_12</title>
<path fill="none" stroke="black" d="M3747,-1950.87C3747,-1950.87 3747,-1844.25 3747,-1844.25"/>
<polygon fill="black" stroke="black" points="3750.5,-1844.25 3747,-1834.25 3743.5,-1844.25 3750.5,-1844.25"/>
</g>
<!-- ring_attn_3_7_stage_11 -->
<g id="node773" class="node">
<title>ring_attn_3_7_stage_11</title>
<polygon fill="yellow" stroke="black" points="4334,-2087 4125,-2019 4334,-1951 4543,-2019 4334,-2087"/>
<text text-anchor="middle" x="4334" y="-2037.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-2022.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="4334" y="-2007.8" font-family="Times,serif" font-size="14.00">Q[7]×K[12]×V[12]</text>
<text text-anchor="middle" x="4334" y="-1992.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_6_stage_11&#45;&gt;ring_attn_3_7_stage_11 -->
<g id="edge1996" class="edge">
<title>ring_attn_3_6_stage_11&#45;&gt;ring_attn_3_7_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-2019C3956.02,-2019 4114.86,-2019 4114.86,-2019"/>
<polygon fill="red" stroke="red" points="4114.86,-2022.5 4124.86,-2019 4114.86,-2015.5 4114.86,-2022.5"/>
</g>
<!-- ring_attn_3_6_stage_12&#45;&gt;ring_attn_3_6_stage_13 -->
<g id="edge670" class="edge">
<title>ring_attn_3_6_stage_12&#45;&gt;ring_attn_3_6_stage_13</title>
<path fill="none" stroke="black" d="M3747,-1697.87C3747,-1697.87 3747,-1591.25 3747,-1591.25"/>
<polygon fill="black" stroke="black" points="3750.5,-1591.25 3747,-1581.25 3743.5,-1591.25 3750.5,-1591.25"/>
</g>
<!-- ring_attn_3_7_stage_12 -->
<g id="node774" class="node">
<title>ring_attn_3_7_stage_12</title>
<polygon fill="yellow" stroke="black" points="4334,-1834 4125,-1766 4334,-1698 4543,-1766 4334,-1834"/>
<text text-anchor="middle" x="4334" y="-1784.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-1769.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="4334" y="-1754.8" font-family="Times,serif" font-size="14.00">Q[7]×K[11]×V[11]</text>
<text text-anchor="middle" x="4334" y="-1739.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_6_stage_12&#45;&gt;ring_attn_3_7_stage_12 -->
<g id="edge1997" class="edge">
<title>ring_attn_3_6_stage_12&#45;&gt;ring_attn_3_7_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-1766C3956.02,-1766 4114.86,-1766 4114.86,-1766"/>
<polygon fill="red" stroke="red" points="4114.86,-1769.5 4124.86,-1766 4114.86,-1762.5 4114.86,-1769.5"/>
</g>
<!-- ring_attn_3_6_stage_13&#45;&gt;ring_attn_3_6_stage_14 -->
<g id="edge671" class="edge">
<title>ring_attn_3_6_stage_13&#45;&gt;ring_attn_3_6_stage_14</title>
<path fill="none" stroke="black" d="M3747,-1444.87C3747,-1444.87 3747,-1338.25 3747,-1338.25"/>
<polygon fill="black" stroke="black" points="3750.5,-1338.25 3747,-1328.25 3743.5,-1338.25 3750.5,-1338.25"/>
</g>
<!-- ring_attn_3_7_stage_13 -->
<g id="node775" class="node">
<title>ring_attn_3_7_stage_13</title>
<polygon fill="yellow" stroke="black" points="4334,-1581 4125,-1513 4334,-1445 4543,-1513 4334,-1581"/>
<text text-anchor="middle" x="4334" y="-1531.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-1516.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="4334" y="-1501.8" font-family="Times,serif" font-size="14.00">Q[7]×K[10]×V[10]</text>
<text text-anchor="middle" x="4334" y="-1486.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_6_stage_13&#45;&gt;ring_attn_3_7_stage_13 -->
<g id="edge1998" class="edge">
<title>ring_attn_3_6_stage_13&#45;&gt;ring_attn_3_7_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-1513C3956.02,-1513 4114.86,-1513 4114.86,-1513"/>
<polygon fill="red" stroke="red" points="4114.86,-1516.5 4124.86,-1513 4114.86,-1509.5 4114.86,-1516.5"/>
</g>
<!-- ring_attn_3_6_stage_14&#45;&gt;ring_attn_3_6_stage_15 -->
<g id="edge672" class="edge">
<title>ring_attn_3_6_stage_14&#45;&gt;ring_attn_3_6_stage_15</title>
<path fill="none" stroke="black" d="M3747,-1191.87C3747,-1191.87 3747,-1085.25 3747,-1085.25"/>
<polygon fill="black" stroke="black" points="3750.5,-1085.25 3747,-1075.25 3743.5,-1085.25 3750.5,-1085.25"/>
</g>
<!-- ring_attn_3_7_stage_14 -->
<g id="node776" class="node">
<title>ring_attn_3_7_stage_14</title>
<polygon fill="yellow" stroke="black" points="4334,-1328 4125,-1260 4334,-1192 4543,-1260 4334,-1328"/>
<text text-anchor="middle" x="4334" y="-1278.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-1263.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="4334" y="-1248.8" font-family="Times,serif" font-size="14.00">Q[7]×K[9]×V[9]</text>
<text text-anchor="middle" x="4334" y="-1233.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_6_stage_14&#45;&gt;ring_attn_3_7_stage_14 -->
<g id="edge1999" class="edge">
<title>ring_attn_3_6_stage_14&#45;&gt;ring_attn_3_7_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-1260C3956.02,-1260 4114.86,-1260 4114.86,-1260"/>
<polygon fill="red" stroke="red" points="4114.86,-1263.5 4124.86,-1260 4114.86,-1256.5 4114.86,-1263.5"/>
</g>
<!-- attn_out_3_6 -->
<g id="node680" class="node">
<title>attn_out_3_6</title>
<polygon fill="none" stroke="black" points="3816.5,-866 3677.5,-866 3677.5,-813 3816.5,-813 3816.5,-866"/>
<text text-anchor="middle" x="3747" y="-850.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3747" y="-835.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="3747" y="-820.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_3_6_stage_15&#45;&gt;attn_out_3_6 -->
<g id="edge673" class="edge">
<title>ring_attn_3_6_stage_15&#45;&gt;attn_out_3_6</title>
<path fill="none" stroke="black" d="M3747,-938.87C3747,-938.87 3747,-876.18 3747,-876.18"/>
<polygon fill="black" stroke="black" points="3750.5,-876.18 3747,-866.18 3743.5,-876.18 3750.5,-876.18"/>
</g>
<!-- ring_attn_3_7_stage_15 -->
<g id="node777" class="node">
<title>ring_attn_3_7_stage_15</title>
<polygon fill="yellow" stroke="black" points="4334,-1075 4125,-1007 4334,-939 4543,-1007 4334,-1075"/>
<text text-anchor="middle" x="4334" y="-1025.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4334" y="-1010.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="4334" y="-995.8" font-family="Times,serif" font-size="14.00">Q[7]×K[8]×V[8]</text>
<text text-anchor="middle" x="4334" y="-980.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_6_stage_15&#45;&gt;ring_attn_3_7_stage_15 -->
<g id="edge2000" class="edge">
<title>ring_attn_3_6_stage_15&#45;&gt;ring_attn_3_7_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3956.02,-1007C3956.02,-1007 4114.86,-1007 4114.86,-1007"/>
<polygon fill="red" stroke="red" points="4114.86,-1010.5 4124.86,-1007 4114.86,-1003.5 4114.86,-1010.5"/>
</g>
<!-- attn_residual_3_6 -->
<g id="node681" class="node">
<title>attn_residual_3_6</title>
<ellipse fill="none" stroke="black" cx="3747" cy="-713" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3747" y="-716.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3747" y="-701.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_3_6&#45;&gt;attn_residual_3_6 -->
<g id="edge674" class="edge">
<title>attn_out_3_6&#45;&gt;attn_residual_3_6</title>
<path fill="none" stroke="black" d="M3747,-812.98C3747,-812.98 3747,-750.36 3747,-750.36"/>
<polygon fill="black" stroke="black" points="3750.5,-750.36 3747,-740.36 3743.5,-750.36 3750.5,-750.36"/>
</g>
<!-- ffn_up_3_6 -->
<g id="node682" class="node">
<title>ffn_up_3_6</title>
<polygon fill="none" stroke="black" points="3826,-613 3668,-613 3668,-560 3826,-560 3826,-613"/>
<text text-anchor="middle" x="3747" y="-597.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3747" y="-582.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="3747" y="-567.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_3_6&#45;&gt;ffn_up_3_6 -->
<g id="edge675" class="edge">
<title>attn_residual_3_6&#45;&gt;ffn_up_3_6</title>
<path fill="none" stroke="black" d="M3747,-685.86C3747,-685.86 3747,-623.16 3747,-623.16"/>
<polygon fill="black" stroke="black" points="3750.5,-623.16 3747,-613.16 3743.5,-623.16 3750.5,-623.16"/>
</g>
<!-- ffn_gelu_3_6 -->
<g id="node683" class="node">
<title>ffn_gelu_3_6</title>
<ellipse fill="none" stroke="black" cx="3747" cy="-460" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3747" y="-463.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="3747" y="-448.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_3_6&#45;&gt;ffn_gelu_3_6 -->
<g id="edge676" class="edge">
<title>ffn_up_3_6&#45;&gt;ffn_gelu_3_6</title>
<path fill="none" stroke="black" d="M3747,-559.98C3747,-559.98 3747,-497.36 3747,-497.36"/>
<polygon fill="black" stroke="black" points="3750.5,-497.36 3747,-487.36 3743.5,-497.36 3750.5,-497.36"/>
</g>
<!-- ffn_down_3_6 -->
<g id="node684" class="node">
<title>ffn_down_3_6</title>
<polygon fill="none" stroke="black" points="3836,-360 3658,-360 3658,-307 3836,-307 3836,-360"/>
<text text-anchor="middle" x="3747" y="-344.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3747" y="-329.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="3747" y="-314.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_3_6&#45;&gt;ffn_down_3_6 -->
<g id="edge677" class="edge">
<title>ffn_gelu_3_6&#45;&gt;ffn_down_3_6</title>
<path fill="none" stroke="black" d="M3747,-432.86C3747,-432.86 3747,-370.16 3747,-370.16"/>
<polygon fill="black" stroke="black" points="3750.5,-370.16 3747,-360.16 3743.5,-370.16 3750.5,-370.16"/>
</g>
<!-- ffn_residual_3_6 -->
<g id="node685" class="node">
<title>ffn_residual_3_6</title>
<ellipse fill="none" stroke="black" cx="3747" cy="-207" rx="105.5" ry="27"/>
<text text-anchor="middle" x="3747" y="-210.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="3747" y="-195.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_3_6&#45;&gt;ffn_residual_3_6 -->
<g id="edge678" class="edge">
<title>ffn_down_3_6&#45;&gt;ffn_residual_3_6</title>
<path fill="none" stroke="black" d="M3747,-306.98C3747,-306.98 3747,-244.36 3747,-244.36"/>
<polygon fill="black" stroke="black" points="3750.5,-244.36 3747,-234.36 3743.5,-244.36 3750.5,-244.36"/>
</g>
<!-- output_6 -->
<g id="node686" class="node">
<title>output_6</title>
<polygon fill="lightcoral" stroke="black" points="3840,-107 3654,-107 3654,-69 3840,-69 3840,-107"/>
<text text-anchor="middle" x="3747" y="-91.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="3747" y="-76.8" font-family="Times,serif" font-size="14.00">Y[6]: 1024×1024×4096</text>
</g>
<!-- ffn_residual_3_6&#45;&gt;output_6 -->
<g id="edge679" class="edge">
<title>ffn_residual_3_6&#45;&gt;output_6</title>
<path fill="none" stroke="black" d="M3747,-180C3747,-180 3747,-117.12 3747,-117.12"/>
<polygon fill="black" stroke="black" points="3750.5,-117.12 3747,-107.12 3743.5,-117.12 3750.5,-117.12"/>
</g>
<!-- input_7 -->
<g id="node687" class="node">
<title>input_7</title>
<polygon fill="lightgreen" stroke="black" points="4427.5,-20458 4240.5,-20458 4240.5,-20420 4427.5,-20420 4427.5,-20458"/>
<text text-anchor="middle" x="4334" y="-20442.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="4334" y="-20427.8" font-family="Times,serif" font-size="14.00">X[7]: 1024×1024×4096</text>
</g>
<!-- qkv_proj_0_7 -->
<g id="node688" class="node">
<title>qkv_proj_0_7</title>
<polygon fill="none" stroke="black" points="4416.5,-20347 4251.5,-20347 4251.5,-20294 4416.5,-20294 4416.5,-20347"/>
<text text-anchor="middle" x="4334" y="-20331.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4334" y="-20316.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="4334" y="-20301.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- input_7&#45;&gt;qkv_proj_0_7 -->
<g id="edge680" class="edge">
<title>input_7&#45;&gt;qkv_proj_0_7</title>
<path fill="none" stroke="black" d="M4334,-20419.96C4334,-20419.96 4334,-20357.44 4334,-20357.44"/>
<polygon fill="black" stroke="black" points="4337.5,-20357.44 4334,-20347.44 4330.5,-20357.44 4337.5,-20357.44"/>
</g>
<!-- qkv_reshape_0_7 -->
<g id="node689" class="node">
<title>qkv_reshape_0_7</title>
<ellipse fill="none" stroke="black" cx="4334" cy="-20194" rx="148" ry="27"/>
<text text-anchor="middle" x="4334" y="-20197.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="4334" y="-20182.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_0_7&#45;&gt;qkv_reshape_0_7 -->
<g id="edge681" class="edge">
<title>qkv_proj_0_7&#45;&gt;qkv_reshape_0_7</title>
<path fill="none" stroke="black" d="M4334,-20293.98C4334,-20293.98 4334,-20231.36 4334,-20231.36"/>
<polygon fill="black" stroke="black" points="4337.5,-20231.36 4334,-20221.36 4330.5,-20231.36 4337.5,-20231.36"/>
</g>
<!-- qkv_reshape_0_7&#45;&gt;ring_attn_0_7_stage_0 -->
<g id="edge682" class="edge">
<title>qkv_reshape_0_7&#45;&gt;ring_attn_0_7_stage_0</title>
<path fill="none" stroke="black" d="M4334,-20166.72C4334,-20166.72 4334,-20060.16 4334,-20060.16"/>
<polygon fill="black" stroke="black" points="4337.5,-20060.16 4334,-20050.16 4330.5,-20060.16 4337.5,-20060.16"/>
</g>
<!-- ring_attn_0_7_stage_0&#45;&gt;ring_attn_0_7_stage_1 -->
<g id="edge683" class="edge">
<title>ring_attn_0_7_stage_0&#45;&gt;ring_attn_0_7_stage_1</title>
<path fill="none" stroke="black" d="M4334,-19913.87C4334,-19913.87 4334,-19807.25 4334,-19807.25"/>
<polygon fill="black" stroke="black" points="4337.5,-19807.25 4334,-19797.25 4330.5,-19807.25 4337.5,-19807.25"/>
</g>
<!-- ring_attn_0_8_stage_0 -->
<g id="node788" class="node">
<title>ring_attn_0_8_stage_0</title>
<polygon fill="yellow" stroke="black" points="4921,-20050 4712,-19982 4921,-19914 5130,-19982 4921,-20050"/>
<text text-anchor="middle" x="4921" y="-20000.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-19985.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="4921" y="-19970.8" font-family="Times,serif" font-size="14.00">Q[8]×K[8]×V[8]</text>
<text text-anchor="middle" x="4921" y="-19955.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_7_stage_0&#45;&gt;ring_attn_0_8_stage_0 -->
<g id="edge2001" class="edge">
<title>ring_attn_0_7_stage_0&#45;&gt;ring_attn_0_8_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-19982C4543.02,-19982 4701.86,-19982 4701.86,-19982"/>
<polygon fill="red" stroke="red" points="4701.86,-19985.5 4711.86,-19982 4701.86,-19978.5 4701.86,-19985.5"/>
</g>
<!-- ring_attn_0_7_stage_1&#45;&gt;ring_attn_0_7_stage_2 -->
<g id="edge684" class="edge">
<title>ring_attn_0_7_stage_1&#45;&gt;ring_attn_0_7_stage_2</title>
<path fill="none" stroke="black" d="M4334,-19660.87C4334,-19660.87 4334,-19554.25 4334,-19554.25"/>
<polygon fill="black" stroke="black" points="4337.5,-19554.25 4334,-19544.25 4330.5,-19554.25 4337.5,-19554.25"/>
</g>
<!-- ring_attn_0_8_stage_1 -->
<g id="node789" class="node">
<title>ring_attn_0_8_stage_1</title>
<polygon fill="yellow" stroke="black" points="4921,-19797 4712,-19729 4921,-19661 5130,-19729 4921,-19797"/>
<text text-anchor="middle" x="4921" y="-19747.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-19732.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="4921" y="-19717.8" font-family="Times,serif" font-size="14.00">Q[8]×K[7]×V[7]</text>
<text text-anchor="middle" x="4921" y="-19702.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_7_stage_1&#45;&gt;ring_attn_0_8_stage_1 -->
<g id="edge2002" class="edge">
<title>ring_attn_0_7_stage_1&#45;&gt;ring_attn_0_8_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-19729C4543.02,-19729 4701.86,-19729 4701.86,-19729"/>
<polygon fill="red" stroke="red" points="4701.86,-19732.5 4711.86,-19729 4701.86,-19725.5 4701.86,-19732.5"/>
</g>
<!-- ring_attn_0_7_stage_2&#45;&gt;ring_attn_0_7_stage_3 -->
<g id="edge685" class="edge">
<title>ring_attn_0_7_stage_2&#45;&gt;ring_attn_0_7_stage_3</title>
<path fill="none" stroke="black" d="M4334,-19407.87C4334,-19407.87 4334,-19301.25 4334,-19301.25"/>
<polygon fill="black" stroke="black" points="4337.5,-19301.25 4334,-19291.25 4330.5,-19301.25 4337.5,-19301.25"/>
</g>
<!-- ring_attn_0_8_stage_2 -->
<g id="node790" class="node">
<title>ring_attn_0_8_stage_2</title>
<polygon fill="yellow" stroke="black" points="4921,-19544 4712,-19476 4921,-19408 5130,-19476 4921,-19544"/>
<text text-anchor="middle" x="4921" y="-19494.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-19479.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="4921" y="-19464.8" font-family="Times,serif" font-size="14.00">Q[8]×K[6]×V[6]</text>
<text text-anchor="middle" x="4921" y="-19449.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_7_stage_2&#45;&gt;ring_attn_0_8_stage_2 -->
<g id="edge2003" class="edge">
<title>ring_attn_0_7_stage_2&#45;&gt;ring_attn_0_8_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-19476C4543.02,-19476 4701.86,-19476 4701.86,-19476"/>
<polygon fill="red" stroke="red" points="4701.86,-19479.5 4711.86,-19476 4701.86,-19472.5 4701.86,-19479.5"/>
</g>
<!-- ring_attn_0_7_stage_3&#45;&gt;ring_attn_0_7_stage_4 -->
<g id="edge686" class="edge">
<title>ring_attn_0_7_stage_3&#45;&gt;ring_attn_0_7_stage_4</title>
<path fill="none" stroke="black" d="M4334,-19154.87C4334,-19154.87 4334,-19048.25 4334,-19048.25"/>
<polygon fill="black" stroke="black" points="4337.5,-19048.25 4334,-19038.25 4330.5,-19048.25 4337.5,-19048.25"/>
</g>
<!-- ring_attn_0_8_stage_3 -->
<g id="node791" class="node">
<title>ring_attn_0_8_stage_3</title>
<polygon fill="yellow" stroke="black" points="4921,-19291 4712,-19223 4921,-19155 5130,-19223 4921,-19291"/>
<text text-anchor="middle" x="4921" y="-19241.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-19226.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="4921" y="-19211.8" font-family="Times,serif" font-size="14.00">Q[8]×K[5]×V[5]</text>
<text text-anchor="middle" x="4921" y="-19196.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_7_stage_3&#45;&gt;ring_attn_0_8_stage_3 -->
<g id="edge2004" class="edge">
<title>ring_attn_0_7_stage_3&#45;&gt;ring_attn_0_8_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-19223C4543.02,-19223 4701.86,-19223 4701.86,-19223"/>
<polygon fill="red" stroke="red" points="4701.86,-19226.5 4711.86,-19223 4701.86,-19219.5 4701.86,-19226.5"/>
</g>
<!-- ring_attn_0_7_stage_4&#45;&gt;ring_attn_0_7_stage_5 -->
<g id="edge687" class="edge">
<title>ring_attn_0_7_stage_4&#45;&gt;ring_attn_0_7_stage_5</title>
<path fill="none" stroke="black" d="M4334,-18901.87C4334,-18901.87 4334,-18795.25 4334,-18795.25"/>
<polygon fill="black" stroke="black" points="4337.5,-18795.25 4334,-18785.25 4330.5,-18795.25 4337.5,-18795.25"/>
</g>
<!-- ring_attn_0_8_stage_4 -->
<g id="node792" class="node">
<title>ring_attn_0_8_stage_4</title>
<polygon fill="yellow" stroke="black" points="4921,-19038 4712,-18970 4921,-18902 5130,-18970 4921,-19038"/>
<text text-anchor="middle" x="4921" y="-18988.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-18973.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="4921" y="-18958.8" font-family="Times,serif" font-size="14.00">Q[8]×K[4]×V[4]</text>
<text text-anchor="middle" x="4921" y="-18943.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_7_stage_4&#45;&gt;ring_attn_0_8_stage_4 -->
<g id="edge2005" class="edge">
<title>ring_attn_0_7_stage_4&#45;&gt;ring_attn_0_8_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-18970C4543.02,-18970 4701.86,-18970 4701.86,-18970"/>
<polygon fill="red" stroke="red" points="4701.86,-18973.5 4711.86,-18970 4701.86,-18966.5 4701.86,-18973.5"/>
</g>
<!-- ring_attn_0_7_stage_5&#45;&gt;ring_attn_0_7_stage_6 -->
<g id="edge688" class="edge">
<title>ring_attn_0_7_stage_5&#45;&gt;ring_attn_0_7_stage_6</title>
<path fill="none" stroke="black" d="M4334,-18648.87C4334,-18648.87 4334,-18542.25 4334,-18542.25"/>
<polygon fill="black" stroke="black" points="4337.5,-18542.25 4334,-18532.25 4330.5,-18542.25 4337.5,-18542.25"/>
</g>
<!-- ring_attn_0_8_stage_5 -->
<g id="node793" class="node">
<title>ring_attn_0_8_stage_5</title>
<polygon fill="yellow" stroke="black" points="4921,-18785 4712,-18717 4921,-18649 5130,-18717 4921,-18785"/>
<text text-anchor="middle" x="4921" y="-18735.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-18720.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="4921" y="-18705.8" font-family="Times,serif" font-size="14.00">Q[8]×K[3]×V[3]</text>
<text text-anchor="middle" x="4921" y="-18690.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_7_stage_5&#45;&gt;ring_attn_0_8_stage_5 -->
<g id="edge2006" class="edge">
<title>ring_attn_0_7_stage_5&#45;&gt;ring_attn_0_8_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-18717C4543.02,-18717 4701.86,-18717 4701.86,-18717"/>
<polygon fill="red" stroke="red" points="4701.86,-18720.5 4711.86,-18717 4701.86,-18713.5 4701.86,-18720.5"/>
</g>
<!-- ring_attn_0_7_stage_6&#45;&gt;ring_attn_0_7_stage_7 -->
<g id="edge689" class="edge">
<title>ring_attn_0_7_stage_6&#45;&gt;ring_attn_0_7_stage_7</title>
<path fill="none" stroke="black" d="M4334,-18395.87C4334,-18395.87 4334,-18289.25 4334,-18289.25"/>
<polygon fill="black" stroke="black" points="4337.5,-18289.25 4334,-18279.25 4330.5,-18289.25 4337.5,-18289.25"/>
</g>
<!-- ring_attn_0_8_stage_6 -->
<g id="node794" class="node">
<title>ring_attn_0_8_stage_6</title>
<polygon fill="yellow" stroke="black" points="4921,-18532 4712,-18464 4921,-18396 5130,-18464 4921,-18532"/>
<text text-anchor="middle" x="4921" y="-18482.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-18467.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="4921" y="-18452.8" font-family="Times,serif" font-size="14.00">Q[8]×K[2]×V[2]</text>
<text text-anchor="middle" x="4921" y="-18437.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_7_stage_6&#45;&gt;ring_attn_0_8_stage_6 -->
<g id="edge2007" class="edge">
<title>ring_attn_0_7_stage_6&#45;&gt;ring_attn_0_8_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-18464C4543.02,-18464 4701.86,-18464 4701.86,-18464"/>
<polygon fill="red" stroke="red" points="4701.86,-18467.5 4711.86,-18464 4701.86,-18460.5 4701.86,-18467.5"/>
</g>
<!-- ring_attn_0_7_stage_7&#45;&gt;ring_attn_0_7_stage_8 -->
<g id="edge690" class="edge">
<title>ring_attn_0_7_stage_7&#45;&gt;ring_attn_0_7_stage_8</title>
<path fill="none" stroke="black" d="M4334,-18142.87C4334,-18142.87 4334,-18036.25 4334,-18036.25"/>
<polygon fill="black" stroke="black" points="4337.5,-18036.25 4334,-18026.25 4330.5,-18036.25 4337.5,-18036.25"/>
</g>
<!-- ring_attn_0_8_stage_7 -->
<g id="node795" class="node">
<title>ring_attn_0_8_stage_7</title>
<polygon fill="yellow" stroke="black" points="4921,-18279 4712,-18211 4921,-18143 5130,-18211 4921,-18279"/>
<text text-anchor="middle" x="4921" y="-18229.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-18214.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="4921" y="-18199.8" font-family="Times,serif" font-size="14.00">Q[8]×K[1]×V[1]</text>
<text text-anchor="middle" x="4921" y="-18184.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_7_stage_7&#45;&gt;ring_attn_0_8_stage_7 -->
<g id="edge2008" class="edge">
<title>ring_attn_0_7_stage_7&#45;&gt;ring_attn_0_8_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-18211C4543.02,-18211 4701.86,-18211 4701.86,-18211"/>
<polygon fill="red" stroke="red" points="4701.86,-18214.5 4711.86,-18211 4701.86,-18207.5 4701.86,-18214.5"/>
</g>
<!-- ring_attn_0_7_stage_8&#45;&gt;ring_attn_0_7_stage_9 -->
<g id="edge691" class="edge">
<title>ring_attn_0_7_stage_8&#45;&gt;ring_attn_0_7_stage_9</title>
<path fill="none" stroke="black" d="M4334,-17889.87C4334,-17889.87 4334,-17783.25 4334,-17783.25"/>
<polygon fill="black" stroke="black" points="4337.5,-17783.25 4334,-17773.25 4330.5,-17783.25 4337.5,-17783.25"/>
</g>
<!-- ring_attn_0_8_stage_8 -->
<g id="node796" class="node">
<title>ring_attn_0_8_stage_8</title>
<polygon fill="yellow" stroke="black" points="4921,-18026 4712,-17958 4921,-17890 5130,-17958 4921,-18026"/>
<text text-anchor="middle" x="4921" y="-17976.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-17961.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="4921" y="-17946.8" font-family="Times,serif" font-size="14.00">Q[8]×K[0]×V[0]</text>
<text text-anchor="middle" x="4921" y="-17931.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_7_stage_8&#45;&gt;ring_attn_0_8_stage_8 -->
<g id="edge2009" class="edge">
<title>ring_attn_0_7_stage_8&#45;&gt;ring_attn_0_8_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-17958C4543.02,-17958 4701.86,-17958 4701.86,-17958"/>
<polygon fill="red" stroke="red" points="4701.86,-17961.5 4711.86,-17958 4701.86,-17954.5 4701.86,-17961.5"/>
</g>
<!-- ring_attn_0_7_stage_9&#45;&gt;ring_attn_0_7_stage_10 -->
<g id="edge692" class="edge">
<title>ring_attn_0_7_stage_9&#45;&gt;ring_attn_0_7_stage_10</title>
<path fill="none" stroke="black" d="M4334,-17636.87C4334,-17636.87 4334,-17530.25 4334,-17530.25"/>
<polygon fill="black" stroke="black" points="4337.5,-17530.25 4334,-17520.25 4330.5,-17530.25 4337.5,-17530.25"/>
</g>
<!-- ring_attn_0_8_stage_9 -->
<g id="node797" class="node">
<title>ring_attn_0_8_stage_9</title>
<polygon fill="yellow" stroke="black" points="4921,-17773 4712,-17705 4921,-17637 5130,-17705 4921,-17773"/>
<text text-anchor="middle" x="4921" y="-17723.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-17708.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="4921" y="-17693.8" font-family="Times,serif" font-size="14.00">Q[8]×K[15]×V[15]</text>
<text text-anchor="middle" x="4921" y="-17678.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_7_stage_9&#45;&gt;ring_attn_0_8_stage_9 -->
<g id="edge2010" class="edge">
<title>ring_attn_0_7_stage_9&#45;&gt;ring_attn_0_8_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-17705C4543.02,-17705 4701.86,-17705 4701.86,-17705"/>
<polygon fill="red" stroke="red" points="4701.86,-17708.5 4711.86,-17705 4701.86,-17701.5 4701.86,-17708.5"/>
</g>
<!-- ring_attn_0_7_stage_10&#45;&gt;ring_attn_0_7_stage_11 -->
<g id="edge693" class="edge">
<title>ring_attn_0_7_stage_10&#45;&gt;ring_attn_0_7_stage_11</title>
<path fill="none" stroke="black" d="M4334,-17383.87C4334,-17383.87 4334,-17277.25 4334,-17277.25"/>
<polygon fill="black" stroke="black" points="4337.5,-17277.25 4334,-17267.25 4330.5,-17277.25 4337.5,-17277.25"/>
</g>
<!-- ring_attn_0_8_stage_10 -->
<g id="node798" class="node">
<title>ring_attn_0_8_stage_10</title>
<polygon fill="yellow" stroke="black" points="4921,-17520 4712,-17452 4921,-17384 5130,-17452 4921,-17520"/>
<text text-anchor="middle" x="4921" y="-17470.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-17455.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="4921" y="-17440.8" font-family="Times,serif" font-size="14.00">Q[8]×K[14]×V[14]</text>
<text text-anchor="middle" x="4921" y="-17425.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_7_stage_10&#45;&gt;ring_attn_0_8_stage_10 -->
<g id="edge2011" class="edge">
<title>ring_attn_0_7_stage_10&#45;&gt;ring_attn_0_8_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-17452C4543.02,-17452 4701.86,-17452 4701.86,-17452"/>
<polygon fill="red" stroke="red" points="4701.86,-17455.5 4711.86,-17452 4701.86,-17448.5 4701.86,-17455.5"/>
</g>
<!-- ring_attn_0_7_stage_11&#45;&gt;ring_attn_0_7_stage_12 -->
<g id="edge694" class="edge">
<title>ring_attn_0_7_stage_11&#45;&gt;ring_attn_0_7_stage_12</title>
<path fill="none" stroke="black" d="M4334,-17130.87C4334,-17130.87 4334,-17024.25 4334,-17024.25"/>
<polygon fill="black" stroke="black" points="4337.5,-17024.25 4334,-17014.25 4330.5,-17024.25 4337.5,-17024.25"/>
</g>
<!-- ring_attn_0_8_stage_11 -->
<g id="node799" class="node">
<title>ring_attn_0_8_stage_11</title>
<polygon fill="yellow" stroke="black" points="4921,-17267 4712,-17199 4921,-17131 5130,-17199 4921,-17267"/>
<text text-anchor="middle" x="4921" y="-17217.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-17202.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="4921" y="-17187.8" font-family="Times,serif" font-size="14.00">Q[8]×K[13]×V[13]</text>
<text text-anchor="middle" x="4921" y="-17172.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_7_stage_11&#45;&gt;ring_attn_0_8_stage_11 -->
<g id="edge2012" class="edge">
<title>ring_attn_0_7_stage_11&#45;&gt;ring_attn_0_8_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-17199C4543.02,-17199 4701.86,-17199 4701.86,-17199"/>
<polygon fill="red" stroke="red" points="4701.86,-17202.5 4711.86,-17199 4701.86,-17195.5 4701.86,-17202.5"/>
</g>
<!-- ring_attn_0_7_stage_12&#45;&gt;ring_attn_0_7_stage_13 -->
<g id="edge695" class="edge">
<title>ring_attn_0_7_stage_12&#45;&gt;ring_attn_0_7_stage_13</title>
<path fill="none" stroke="black" d="M4334,-16877.87C4334,-16877.87 4334,-16771.25 4334,-16771.25"/>
<polygon fill="black" stroke="black" points="4337.5,-16771.25 4334,-16761.25 4330.5,-16771.25 4337.5,-16771.25"/>
</g>
<!-- ring_attn_0_8_stage_12 -->
<g id="node800" class="node">
<title>ring_attn_0_8_stage_12</title>
<polygon fill="yellow" stroke="black" points="4921,-17014 4712,-16946 4921,-16878 5130,-16946 4921,-17014"/>
<text text-anchor="middle" x="4921" y="-16964.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-16949.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="4921" y="-16934.8" font-family="Times,serif" font-size="14.00">Q[8]×K[12]×V[12]</text>
<text text-anchor="middle" x="4921" y="-16919.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_7_stage_12&#45;&gt;ring_attn_0_8_stage_12 -->
<g id="edge2013" class="edge">
<title>ring_attn_0_7_stage_12&#45;&gt;ring_attn_0_8_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-16946C4543.02,-16946 4701.86,-16946 4701.86,-16946"/>
<polygon fill="red" stroke="red" points="4701.86,-16949.5 4711.86,-16946 4701.86,-16942.5 4701.86,-16949.5"/>
</g>
<!-- ring_attn_0_7_stage_13&#45;&gt;ring_attn_0_7_stage_14 -->
<g id="edge696" class="edge">
<title>ring_attn_0_7_stage_13&#45;&gt;ring_attn_0_7_stage_14</title>
<path fill="none" stroke="black" d="M4334,-16624.87C4334,-16624.87 4334,-16518.25 4334,-16518.25"/>
<polygon fill="black" stroke="black" points="4337.5,-16518.25 4334,-16508.25 4330.5,-16518.25 4337.5,-16518.25"/>
</g>
<!-- ring_attn_0_8_stage_13 -->
<g id="node801" class="node">
<title>ring_attn_0_8_stage_13</title>
<polygon fill="yellow" stroke="black" points="4921,-16761 4712,-16693 4921,-16625 5130,-16693 4921,-16761"/>
<text text-anchor="middle" x="4921" y="-16711.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-16696.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="4921" y="-16681.8" font-family="Times,serif" font-size="14.00">Q[8]×K[11]×V[11]</text>
<text text-anchor="middle" x="4921" y="-16666.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_7_stage_13&#45;&gt;ring_attn_0_8_stage_13 -->
<g id="edge2014" class="edge">
<title>ring_attn_0_7_stage_13&#45;&gt;ring_attn_0_8_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-16693C4543.02,-16693 4701.86,-16693 4701.86,-16693"/>
<polygon fill="red" stroke="red" points="4701.86,-16696.5 4711.86,-16693 4701.86,-16689.5 4701.86,-16696.5"/>
</g>
<!-- ring_attn_0_7_stage_14&#45;&gt;ring_attn_0_7_stage_15 -->
<g id="edge697" class="edge">
<title>ring_attn_0_7_stage_14&#45;&gt;ring_attn_0_7_stage_15</title>
<path fill="none" stroke="black" d="M4334,-16371.87C4334,-16371.87 4334,-16265.25 4334,-16265.25"/>
<polygon fill="black" stroke="black" points="4337.5,-16265.25 4334,-16255.25 4330.5,-16265.25 4337.5,-16265.25"/>
</g>
<!-- ring_attn_0_8_stage_14 -->
<g id="node802" class="node">
<title>ring_attn_0_8_stage_14</title>
<polygon fill="yellow" stroke="black" points="4921,-16508 4712,-16440 4921,-16372 5130,-16440 4921,-16508"/>
<text text-anchor="middle" x="4921" y="-16458.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-16443.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="4921" y="-16428.8" font-family="Times,serif" font-size="14.00">Q[8]×K[10]×V[10]</text>
<text text-anchor="middle" x="4921" y="-16413.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_7_stage_14&#45;&gt;ring_attn_0_8_stage_14 -->
<g id="edge2015" class="edge">
<title>ring_attn_0_7_stage_14&#45;&gt;ring_attn_0_8_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-16440C4543.02,-16440 4701.86,-16440 4701.86,-16440"/>
<polygon fill="red" stroke="red" points="4701.86,-16443.5 4711.86,-16440 4701.86,-16436.5 4701.86,-16443.5"/>
</g>
<!-- attn_out_0_7 -->
<g id="node706" class="node">
<title>attn_out_0_7</title>
<polygon fill="none" stroke="black" points="4403.5,-16046 4264.5,-16046 4264.5,-15993 4403.5,-15993 4403.5,-16046"/>
<text text-anchor="middle" x="4334" y="-16030.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="4334" y="-16015.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="4334" y="-16000.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_0_7_stage_15&#45;&gt;attn_out_0_7 -->
<g id="edge698" class="edge">
<title>ring_attn_0_7_stage_15&#45;&gt;attn_out_0_7</title>
<path fill="none" stroke="black" d="M4334,-16118.87C4334,-16118.87 4334,-16056.18 4334,-16056.18"/>
<polygon fill="black" stroke="black" points="4337.5,-16056.18 4334,-16046.18 4330.5,-16056.18 4337.5,-16056.18"/>
</g>
<!-- ring_attn_0_8_stage_15 -->
<g id="node803" class="node">
<title>ring_attn_0_8_stage_15</title>
<polygon fill="yellow" stroke="black" points="4921,-16255 4712,-16187 4921,-16119 5130,-16187 4921,-16255"/>
<text text-anchor="middle" x="4921" y="-16205.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-16190.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="4921" y="-16175.8" font-family="Times,serif" font-size="14.00">Q[8]×K[9]×V[9]</text>
<text text-anchor="middle" x="4921" y="-16160.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_7_stage_15&#45;&gt;ring_attn_0_8_stage_15 -->
<g id="edge2016" class="edge">
<title>ring_attn_0_7_stage_15&#45;&gt;ring_attn_0_8_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-16187C4543.02,-16187 4701.86,-16187 4701.86,-16187"/>
<polygon fill="red" stroke="red" points="4701.86,-16190.5 4711.86,-16187 4701.86,-16183.5 4701.86,-16190.5"/>
</g>
<!-- attn_residual_0_7 -->
<g id="node707" class="node">
<title>attn_residual_0_7</title>
<ellipse fill="none" stroke="black" cx="4334" cy="-15893" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4334" y="-15896.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4334" y="-15881.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_0_7&#45;&gt;attn_residual_0_7 -->
<g id="edge699" class="edge">
<title>attn_out_0_7&#45;&gt;attn_residual_0_7</title>
<path fill="none" stroke="black" d="M4334,-15992.98C4334,-15992.98 4334,-15930.36 4334,-15930.36"/>
<polygon fill="black" stroke="black" points="4337.5,-15930.36 4334,-15920.36 4330.5,-15930.36 4337.5,-15930.36"/>
</g>
<!-- ffn_up_0_7 -->
<g id="node708" class="node">
<title>ffn_up_0_7</title>
<polygon fill="none" stroke="black" points="4413,-15793 4255,-15793 4255,-15740 4413,-15740 4413,-15793"/>
<text text-anchor="middle" x="4334" y="-15777.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4334" y="-15762.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="4334" y="-15747.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_0_7&#45;&gt;ffn_up_0_7 -->
<g id="edge700" class="edge">
<title>attn_residual_0_7&#45;&gt;ffn_up_0_7</title>
<path fill="none" stroke="black" d="M4334,-15865.86C4334,-15865.86 4334,-15803.16 4334,-15803.16"/>
<polygon fill="black" stroke="black" points="4337.5,-15803.16 4334,-15793.16 4330.5,-15803.16 4337.5,-15803.16"/>
</g>
<!-- ffn_gelu_0_7 -->
<g id="node709" class="node">
<title>ffn_gelu_0_7</title>
<ellipse fill="none" stroke="black" cx="4334" cy="-15640" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4334" y="-15643.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4334" y="-15628.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_0_7&#45;&gt;ffn_gelu_0_7 -->
<g id="edge701" class="edge">
<title>ffn_up_0_7&#45;&gt;ffn_gelu_0_7</title>
<path fill="none" stroke="black" d="M4334,-15739.98C4334,-15739.98 4334,-15677.36 4334,-15677.36"/>
<polygon fill="black" stroke="black" points="4337.5,-15677.36 4334,-15667.36 4330.5,-15677.36 4337.5,-15677.36"/>
</g>
<!-- ffn_down_0_7 -->
<g id="node710" class="node">
<title>ffn_down_0_7</title>
<polygon fill="none" stroke="black" points="4423,-15540 4245,-15540 4245,-15487 4423,-15487 4423,-15540"/>
<text text-anchor="middle" x="4334" y="-15524.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4334" y="-15509.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="4334" y="-15494.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_0_7&#45;&gt;ffn_down_0_7 -->
<g id="edge702" class="edge">
<title>ffn_gelu_0_7&#45;&gt;ffn_down_0_7</title>
<path fill="none" stroke="black" d="M4334,-15612.86C4334,-15612.86 4334,-15550.16 4334,-15550.16"/>
<polygon fill="black" stroke="black" points="4337.5,-15550.16 4334,-15540.16 4330.5,-15550.16 4337.5,-15550.16"/>
</g>
<!-- ffn_residual_0_7 -->
<g id="node711" class="node">
<title>ffn_residual_0_7</title>
<ellipse fill="none" stroke="black" cx="4334" cy="-15387" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4334" y="-15390.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4334" y="-15375.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_0_7&#45;&gt;ffn_residual_0_7 -->
<g id="edge703" class="edge">
<title>ffn_down_0_7&#45;&gt;ffn_residual_0_7</title>
<path fill="none" stroke="black" d="M4334,-15486.98C4334,-15486.98 4334,-15424.36 4334,-15424.36"/>
<polygon fill="black" stroke="black" points="4337.5,-15424.36 4334,-15414.36 4330.5,-15424.36 4337.5,-15424.36"/>
</g>
<!-- qkv_proj_1_7 -->
<g id="node712" class="node">
<title>qkv_proj_1_7</title>
<polygon fill="none" stroke="black" points="4416.5,-15287 4251.5,-15287 4251.5,-15234 4416.5,-15234 4416.5,-15287"/>
<text text-anchor="middle" x="4334" y="-15271.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4334" y="-15256.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="4334" y="-15241.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_0_7&#45;&gt;qkv_proj_1_7 -->
<g id="edge704" class="edge">
<title>ffn_residual_0_7&#45;&gt;qkv_proj_1_7</title>
<path fill="none" stroke="black" d="M4334,-15359.86C4334,-15359.86 4334,-15297.16 4334,-15297.16"/>
<polygon fill="black" stroke="black" points="4337.5,-15297.16 4334,-15287.16 4330.5,-15297.16 4337.5,-15297.16"/>
</g>
<!-- qkv_reshape_1_7 -->
<g id="node713" class="node">
<title>qkv_reshape_1_7</title>
<ellipse fill="none" stroke="black" cx="4334" cy="-15134" rx="148" ry="27"/>
<text text-anchor="middle" x="4334" y="-15137.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="4334" y="-15122.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_1_7&#45;&gt;qkv_reshape_1_7 -->
<g id="edge705" class="edge">
<title>qkv_proj_1_7&#45;&gt;qkv_reshape_1_7</title>
<path fill="none" stroke="black" d="M4334,-15233.98C4334,-15233.98 4334,-15171.36 4334,-15171.36"/>
<polygon fill="black" stroke="black" points="4337.5,-15171.36 4334,-15161.36 4330.5,-15171.36 4337.5,-15171.36"/>
</g>
<!-- qkv_reshape_1_7&#45;&gt;ring_attn_1_7_stage_0 -->
<g id="edge706" class="edge">
<title>qkv_reshape_1_7&#45;&gt;ring_attn_1_7_stage_0</title>
<path fill="none" stroke="black" d="M4334,-15106.72C4334,-15106.72 4334,-15000.16 4334,-15000.16"/>
<polygon fill="black" stroke="black" points="4337.5,-15000.16 4334,-14990.16 4330.5,-15000.16 4337.5,-15000.16"/>
</g>
<!-- ring_attn_1_7_stage_0&#45;&gt;ring_attn_1_7_stage_1 -->
<g id="edge707" class="edge">
<title>ring_attn_1_7_stage_0&#45;&gt;ring_attn_1_7_stage_1</title>
<path fill="none" stroke="black" d="M4334,-14853.87C4334,-14853.87 4334,-14747.25 4334,-14747.25"/>
<polygon fill="black" stroke="black" points="4337.5,-14747.25 4334,-14737.25 4330.5,-14747.25 4337.5,-14747.25"/>
</g>
<!-- ring_attn_1_8_stage_0 -->
<g id="node812" class="node">
<title>ring_attn_1_8_stage_0</title>
<polygon fill="yellow" stroke="black" points="4921,-14990 4712,-14922 4921,-14854 5130,-14922 4921,-14990"/>
<text text-anchor="middle" x="4921" y="-14940.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-14925.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="4921" y="-14910.8" font-family="Times,serif" font-size="14.00">Q[8]×K[8]×V[8]</text>
<text text-anchor="middle" x="4921" y="-14895.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_7_stage_0&#45;&gt;ring_attn_1_8_stage_0 -->
<g id="edge2017" class="edge">
<title>ring_attn_1_7_stage_0&#45;&gt;ring_attn_1_8_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-14922C4543.02,-14922 4701.86,-14922 4701.86,-14922"/>
<polygon fill="red" stroke="red" points="4701.86,-14925.5 4711.86,-14922 4701.86,-14918.5 4701.86,-14925.5"/>
</g>
<!-- ring_attn_1_7_stage_1&#45;&gt;ring_attn_1_7_stage_2 -->
<g id="edge708" class="edge">
<title>ring_attn_1_7_stage_1&#45;&gt;ring_attn_1_7_stage_2</title>
<path fill="none" stroke="black" d="M4334,-14600.87C4334,-14600.87 4334,-14494.25 4334,-14494.25"/>
<polygon fill="black" stroke="black" points="4337.5,-14494.25 4334,-14484.25 4330.5,-14494.25 4337.5,-14494.25"/>
</g>
<!-- ring_attn_1_8_stage_1 -->
<g id="node813" class="node">
<title>ring_attn_1_8_stage_1</title>
<polygon fill="yellow" stroke="black" points="4921,-14737 4712,-14669 4921,-14601 5130,-14669 4921,-14737"/>
<text text-anchor="middle" x="4921" y="-14687.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-14672.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="4921" y="-14657.8" font-family="Times,serif" font-size="14.00">Q[8]×K[7]×V[7]</text>
<text text-anchor="middle" x="4921" y="-14642.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_7_stage_1&#45;&gt;ring_attn_1_8_stage_1 -->
<g id="edge2018" class="edge">
<title>ring_attn_1_7_stage_1&#45;&gt;ring_attn_1_8_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-14669C4543.02,-14669 4701.86,-14669 4701.86,-14669"/>
<polygon fill="red" stroke="red" points="4701.86,-14672.5 4711.86,-14669 4701.86,-14665.5 4701.86,-14672.5"/>
</g>
<!-- ring_attn_1_7_stage_2&#45;&gt;ring_attn_1_7_stage_3 -->
<g id="edge709" class="edge">
<title>ring_attn_1_7_stage_2&#45;&gt;ring_attn_1_7_stage_3</title>
<path fill="none" stroke="black" d="M4334,-14347.87C4334,-14347.87 4334,-14241.25 4334,-14241.25"/>
<polygon fill="black" stroke="black" points="4337.5,-14241.25 4334,-14231.25 4330.5,-14241.25 4337.5,-14241.25"/>
</g>
<!-- ring_attn_1_8_stage_2 -->
<g id="node814" class="node">
<title>ring_attn_1_8_stage_2</title>
<polygon fill="yellow" stroke="black" points="4921,-14484 4712,-14416 4921,-14348 5130,-14416 4921,-14484"/>
<text text-anchor="middle" x="4921" y="-14434.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-14419.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="4921" y="-14404.8" font-family="Times,serif" font-size="14.00">Q[8]×K[6]×V[6]</text>
<text text-anchor="middle" x="4921" y="-14389.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_7_stage_2&#45;&gt;ring_attn_1_8_stage_2 -->
<g id="edge2019" class="edge">
<title>ring_attn_1_7_stage_2&#45;&gt;ring_attn_1_8_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-14416C4543.02,-14416 4701.86,-14416 4701.86,-14416"/>
<polygon fill="red" stroke="red" points="4701.86,-14419.5 4711.86,-14416 4701.86,-14412.5 4701.86,-14419.5"/>
</g>
<!-- ring_attn_1_7_stage_3&#45;&gt;ring_attn_1_7_stage_4 -->
<g id="edge710" class="edge">
<title>ring_attn_1_7_stage_3&#45;&gt;ring_attn_1_7_stage_4</title>
<path fill="none" stroke="black" d="M4334,-14094.87C4334,-14094.87 4334,-13988.25 4334,-13988.25"/>
<polygon fill="black" stroke="black" points="4337.5,-13988.25 4334,-13978.25 4330.5,-13988.25 4337.5,-13988.25"/>
</g>
<!-- ring_attn_1_8_stage_3 -->
<g id="node815" class="node">
<title>ring_attn_1_8_stage_3</title>
<polygon fill="yellow" stroke="black" points="4921,-14231 4712,-14163 4921,-14095 5130,-14163 4921,-14231"/>
<text text-anchor="middle" x="4921" y="-14181.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-14166.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="4921" y="-14151.8" font-family="Times,serif" font-size="14.00">Q[8]×K[5]×V[5]</text>
<text text-anchor="middle" x="4921" y="-14136.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_7_stage_3&#45;&gt;ring_attn_1_8_stage_3 -->
<g id="edge2020" class="edge">
<title>ring_attn_1_7_stage_3&#45;&gt;ring_attn_1_8_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-14163C4543.02,-14163 4701.86,-14163 4701.86,-14163"/>
<polygon fill="red" stroke="red" points="4701.86,-14166.5 4711.86,-14163 4701.86,-14159.5 4701.86,-14166.5"/>
</g>
<!-- ring_attn_1_7_stage_4&#45;&gt;ring_attn_1_7_stage_5 -->
<g id="edge711" class="edge">
<title>ring_attn_1_7_stage_4&#45;&gt;ring_attn_1_7_stage_5</title>
<path fill="none" stroke="black" d="M4334,-13841.87C4334,-13841.87 4334,-13735.25 4334,-13735.25"/>
<polygon fill="black" stroke="black" points="4337.5,-13735.25 4334,-13725.25 4330.5,-13735.25 4337.5,-13735.25"/>
</g>
<!-- ring_attn_1_8_stage_4 -->
<g id="node816" class="node">
<title>ring_attn_1_8_stage_4</title>
<polygon fill="yellow" stroke="black" points="4921,-13978 4712,-13910 4921,-13842 5130,-13910 4921,-13978"/>
<text text-anchor="middle" x="4921" y="-13928.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-13913.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="4921" y="-13898.8" font-family="Times,serif" font-size="14.00">Q[8]×K[4]×V[4]</text>
<text text-anchor="middle" x="4921" y="-13883.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_7_stage_4&#45;&gt;ring_attn_1_8_stage_4 -->
<g id="edge2021" class="edge">
<title>ring_attn_1_7_stage_4&#45;&gt;ring_attn_1_8_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-13910C4543.02,-13910 4701.86,-13910 4701.86,-13910"/>
<polygon fill="red" stroke="red" points="4701.86,-13913.5 4711.86,-13910 4701.86,-13906.5 4701.86,-13913.5"/>
</g>
<!-- ring_attn_1_7_stage_5&#45;&gt;ring_attn_1_7_stage_6 -->
<g id="edge712" class="edge">
<title>ring_attn_1_7_stage_5&#45;&gt;ring_attn_1_7_stage_6</title>
<path fill="none" stroke="black" d="M4334,-13588.87C4334,-13588.87 4334,-13482.25 4334,-13482.25"/>
<polygon fill="black" stroke="black" points="4337.5,-13482.25 4334,-13472.25 4330.5,-13482.25 4337.5,-13482.25"/>
</g>
<!-- ring_attn_1_8_stage_5 -->
<g id="node817" class="node">
<title>ring_attn_1_8_stage_5</title>
<polygon fill="yellow" stroke="black" points="4921,-13725 4712,-13657 4921,-13589 5130,-13657 4921,-13725"/>
<text text-anchor="middle" x="4921" y="-13675.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-13660.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="4921" y="-13645.8" font-family="Times,serif" font-size="14.00">Q[8]×K[3]×V[3]</text>
<text text-anchor="middle" x="4921" y="-13630.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_7_stage_5&#45;&gt;ring_attn_1_8_stage_5 -->
<g id="edge2022" class="edge">
<title>ring_attn_1_7_stage_5&#45;&gt;ring_attn_1_8_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-13657C4543.02,-13657 4701.86,-13657 4701.86,-13657"/>
<polygon fill="red" stroke="red" points="4701.86,-13660.5 4711.86,-13657 4701.86,-13653.5 4701.86,-13660.5"/>
</g>
<!-- ring_attn_1_7_stage_6&#45;&gt;ring_attn_1_7_stage_7 -->
<g id="edge713" class="edge">
<title>ring_attn_1_7_stage_6&#45;&gt;ring_attn_1_7_stage_7</title>
<path fill="none" stroke="black" d="M4334,-13335.87C4334,-13335.87 4334,-13229.25 4334,-13229.25"/>
<polygon fill="black" stroke="black" points="4337.5,-13229.25 4334,-13219.25 4330.5,-13229.25 4337.5,-13229.25"/>
</g>
<!-- ring_attn_1_8_stage_6 -->
<g id="node818" class="node">
<title>ring_attn_1_8_stage_6</title>
<polygon fill="yellow" stroke="black" points="4921,-13472 4712,-13404 4921,-13336 5130,-13404 4921,-13472"/>
<text text-anchor="middle" x="4921" y="-13422.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-13407.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="4921" y="-13392.8" font-family="Times,serif" font-size="14.00">Q[8]×K[2]×V[2]</text>
<text text-anchor="middle" x="4921" y="-13377.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_7_stage_6&#45;&gt;ring_attn_1_8_stage_6 -->
<g id="edge2023" class="edge">
<title>ring_attn_1_7_stage_6&#45;&gt;ring_attn_1_8_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-13404C4543.02,-13404 4701.86,-13404 4701.86,-13404"/>
<polygon fill="red" stroke="red" points="4701.86,-13407.5 4711.86,-13404 4701.86,-13400.5 4701.86,-13407.5"/>
</g>
<!-- ring_attn_1_7_stage_7&#45;&gt;ring_attn_1_7_stage_8 -->
<g id="edge714" class="edge">
<title>ring_attn_1_7_stage_7&#45;&gt;ring_attn_1_7_stage_8</title>
<path fill="none" stroke="black" d="M4334,-13082.87C4334,-13082.87 4334,-12976.25 4334,-12976.25"/>
<polygon fill="black" stroke="black" points="4337.5,-12976.25 4334,-12966.25 4330.5,-12976.25 4337.5,-12976.25"/>
</g>
<!-- ring_attn_1_8_stage_7 -->
<g id="node819" class="node">
<title>ring_attn_1_8_stage_7</title>
<polygon fill="yellow" stroke="black" points="4921,-13219 4712,-13151 4921,-13083 5130,-13151 4921,-13219"/>
<text text-anchor="middle" x="4921" y="-13169.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-13154.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="4921" y="-13139.8" font-family="Times,serif" font-size="14.00">Q[8]×K[1]×V[1]</text>
<text text-anchor="middle" x="4921" y="-13124.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_7_stage_7&#45;&gt;ring_attn_1_8_stage_7 -->
<g id="edge2024" class="edge">
<title>ring_attn_1_7_stage_7&#45;&gt;ring_attn_1_8_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-13151C4543.02,-13151 4701.86,-13151 4701.86,-13151"/>
<polygon fill="red" stroke="red" points="4701.86,-13154.5 4711.86,-13151 4701.86,-13147.5 4701.86,-13154.5"/>
</g>
<!-- ring_attn_1_7_stage_8&#45;&gt;ring_attn_1_7_stage_9 -->
<g id="edge715" class="edge">
<title>ring_attn_1_7_stage_8&#45;&gt;ring_attn_1_7_stage_9</title>
<path fill="none" stroke="black" d="M4334,-12829.87C4334,-12829.87 4334,-12723.25 4334,-12723.25"/>
<polygon fill="black" stroke="black" points="4337.5,-12723.25 4334,-12713.25 4330.5,-12723.25 4337.5,-12723.25"/>
</g>
<!-- ring_attn_1_8_stage_8 -->
<g id="node820" class="node">
<title>ring_attn_1_8_stage_8</title>
<polygon fill="yellow" stroke="black" points="4921,-12966 4712,-12898 4921,-12830 5130,-12898 4921,-12966"/>
<text text-anchor="middle" x="4921" y="-12916.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-12901.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="4921" y="-12886.8" font-family="Times,serif" font-size="14.00">Q[8]×K[0]×V[0]</text>
<text text-anchor="middle" x="4921" y="-12871.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_7_stage_8&#45;&gt;ring_attn_1_8_stage_8 -->
<g id="edge2025" class="edge">
<title>ring_attn_1_7_stage_8&#45;&gt;ring_attn_1_8_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-12898C4543.02,-12898 4701.86,-12898 4701.86,-12898"/>
<polygon fill="red" stroke="red" points="4701.86,-12901.5 4711.86,-12898 4701.86,-12894.5 4701.86,-12901.5"/>
</g>
<!-- ring_attn_1_7_stage_9&#45;&gt;ring_attn_1_7_stage_10 -->
<g id="edge716" class="edge">
<title>ring_attn_1_7_stage_9&#45;&gt;ring_attn_1_7_stage_10</title>
<path fill="none" stroke="black" d="M4334,-12576.87C4334,-12576.87 4334,-12470.25 4334,-12470.25"/>
<polygon fill="black" stroke="black" points="4337.5,-12470.25 4334,-12460.25 4330.5,-12470.25 4337.5,-12470.25"/>
</g>
<!-- ring_attn_1_8_stage_9 -->
<g id="node821" class="node">
<title>ring_attn_1_8_stage_9</title>
<polygon fill="yellow" stroke="black" points="4921,-12713 4712,-12645 4921,-12577 5130,-12645 4921,-12713"/>
<text text-anchor="middle" x="4921" y="-12663.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-12648.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="4921" y="-12633.8" font-family="Times,serif" font-size="14.00">Q[8]×K[15]×V[15]</text>
<text text-anchor="middle" x="4921" y="-12618.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_7_stage_9&#45;&gt;ring_attn_1_8_stage_9 -->
<g id="edge2026" class="edge">
<title>ring_attn_1_7_stage_9&#45;&gt;ring_attn_1_8_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-12645C4543.02,-12645 4701.86,-12645 4701.86,-12645"/>
<polygon fill="red" stroke="red" points="4701.86,-12648.5 4711.86,-12645 4701.86,-12641.5 4701.86,-12648.5"/>
</g>
<!-- ring_attn_1_7_stage_10&#45;&gt;ring_attn_1_7_stage_11 -->
<g id="edge717" class="edge">
<title>ring_attn_1_7_stage_10&#45;&gt;ring_attn_1_7_stage_11</title>
<path fill="none" stroke="black" d="M4334,-12323.87C4334,-12323.87 4334,-12217.25 4334,-12217.25"/>
<polygon fill="black" stroke="black" points="4337.5,-12217.25 4334,-12207.25 4330.5,-12217.25 4337.5,-12217.25"/>
</g>
<!-- ring_attn_1_8_stage_10 -->
<g id="node822" class="node">
<title>ring_attn_1_8_stage_10</title>
<polygon fill="yellow" stroke="black" points="4921,-12460 4712,-12392 4921,-12324 5130,-12392 4921,-12460"/>
<text text-anchor="middle" x="4921" y="-12410.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-12395.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="4921" y="-12380.8" font-family="Times,serif" font-size="14.00">Q[8]×K[14]×V[14]</text>
<text text-anchor="middle" x="4921" y="-12365.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_7_stage_10&#45;&gt;ring_attn_1_8_stage_10 -->
<g id="edge2027" class="edge">
<title>ring_attn_1_7_stage_10&#45;&gt;ring_attn_1_8_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-12392C4543.02,-12392 4701.86,-12392 4701.86,-12392"/>
<polygon fill="red" stroke="red" points="4701.86,-12395.5 4711.86,-12392 4701.86,-12388.5 4701.86,-12395.5"/>
</g>
<!-- ring_attn_1_7_stage_11&#45;&gt;ring_attn_1_7_stage_12 -->
<g id="edge718" class="edge">
<title>ring_attn_1_7_stage_11&#45;&gt;ring_attn_1_7_stage_12</title>
<path fill="none" stroke="black" d="M4334,-12070.87C4334,-12070.87 4334,-11964.25 4334,-11964.25"/>
<polygon fill="black" stroke="black" points="4337.5,-11964.25 4334,-11954.25 4330.5,-11964.25 4337.5,-11964.25"/>
</g>
<!-- ring_attn_1_8_stage_11 -->
<g id="node823" class="node">
<title>ring_attn_1_8_stage_11</title>
<polygon fill="yellow" stroke="black" points="4921,-12207 4712,-12139 4921,-12071 5130,-12139 4921,-12207"/>
<text text-anchor="middle" x="4921" y="-12157.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-12142.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="4921" y="-12127.8" font-family="Times,serif" font-size="14.00">Q[8]×K[13]×V[13]</text>
<text text-anchor="middle" x="4921" y="-12112.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_7_stage_11&#45;&gt;ring_attn_1_8_stage_11 -->
<g id="edge2028" class="edge">
<title>ring_attn_1_7_stage_11&#45;&gt;ring_attn_1_8_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-12139C4543.02,-12139 4701.86,-12139 4701.86,-12139"/>
<polygon fill="red" stroke="red" points="4701.86,-12142.5 4711.86,-12139 4701.86,-12135.5 4701.86,-12142.5"/>
</g>
<!-- ring_attn_1_7_stage_12&#45;&gt;ring_attn_1_7_stage_13 -->
<g id="edge719" class="edge">
<title>ring_attn_1_7_stage_12&#45;&gt;ring_attn_1_7_stage_13</title>
<path fill="none" stroke="black" d="M4334,-11817.87C4334,-11817.87 4334,-11711.25 4334,-11711.25"/>
<polygon fill="black" stroke="black" points="4337.5,-11711.25 4334,-11701.25 4330.5,-11711.25 4337.5,-11711.25"/>
</g>
<!-- ring_attn_1_8_stage_12 -->
<g id="node824" class="node">
<title>ring_attn_1_8_stage_12</title>
<polygon fill="yellow" stroke="black" points="4921,-11954 4712,-11886 4921,-11818 5130,-11886 4921,-11954"/>
<text text-anchor="middle" x="4921" y="-11904.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-11889.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="4921" y="-11874.8" font-family="Times,serif" font-size="14.00">Q[8]×K[12]×V[12]</text>
<text text-anchor="middle" x="4921" y="-11859.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_7_stage_12&#45;&gt;ring_attn_1_8_stage_12 -->
<g id="edge2029" class="edge">
<title>ring_attn_1_7_stage_12&#45;&gt;ring_attn_1_8_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-11886C4543.02,-11886 4701.86,-11886 4701.86,-11886"/>
<polygon fill="red" stroke="red" points="4701.86,-11889.5 4711.86,-11886 4701.86,-11882.5 4701.86,-11889.5"/>
</g>
<!-- ring_attn_1_7_stage_13&#45;&gt;ring_attn_1_7_stage_14 -->
<g id="edge720" class="edge">
<title>ring_attn_1_7_stage_13&#45;&gt;ring_attn_1_7_stage_14</title>
<path fill="none" stroke="black" d="M4334,-11564.87C4334,-11564.87 4334,-11458.25 4334,-11458.25"/>
<polygon fill="black" stroke="black" points="4337.5,-11458.25 4334,-11448.25 4330.5,-11458.25 4337.5,-11458.25"/>
</g>
<!-- ring_attn_1_8_stage_13 -->
<g id="node825" class="node">
<title>ring_attn_1_8_stage_13</title>
<polygon fill="yellow" stroke="black" points="4921,-11701 4712,-11633 4921,-11565 5130,-11633 4921,-11701"/>
<text text-anchor="middle" x="4921" y="-11651.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-11636.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="4921" y="-11621.8" font-family="Times,serif" font-size="14.00">Q[8]×K[11]×V[11]</text>
<text text-anchor="middle" x="4921" y="-11606.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_7_stage_13&#45;&gt;ring_attn_1_8_stage_13 -->
<g id="edge2030" class="edge">
<title>ring_attn_1_7_stage_13&#45;&gt;ring_attn_1_8_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-11633C4543.02,-11633 4701.86,-11633 4701.86,-11633"/>
<polygon fill="red" stroke="red" points="4701.86,-11636.5 4711.86,-11633 4701.86,-11629.5 4701.86,-11636.5"/>
</g>
<!-- ring_attn_1_7_stage_14&#45;&gt;ring_attn_1_7_stage_15 -->
<g id="edge721" class="edge">
<title>ring_attn_1_7_stage_14&#45;&gt;ring_attn_1_7_stage_15</title>
<path fill="none" stroke="black" d="M4334,-11311.87C4334,-11311.87 4334,-11205.25 4334,-11205.25"/>
<polygon fill="black" stroke="black" points="4337.5,-11205.25 4334,-11195.25 4330.5,-11205.25 4337.5,-11205.25"/>
</g>
<!-- ring_attn_1_8_stage_14 -->
<g id="node826" class="node">
<title>ring_attn_1_8_stage_14</title>
<polygon fill="yellow" stroke="black" points="4921,-11448 4712,-11380 4921,-11312 5130,-11380 4921,-11448"/>
<text text-anchor="middle" x="4921" y="-11398.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-11383.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="4921" y="-11368.8" font-family="Times,serif" font-size="14.00">Q[8]×K[10]×V[10]</text>
<text text-anchor="middle" x="4921" y="-11353.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_7_stage_14&#45;&gt;ring_attn_1_8_stage_14 -->
<g id="edge2031" class="edge">
<title>ring_attn_1_7_stage_14&#45;&gt;ring_attn_1_8_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-11380C4543.02,-11380 4701.86,-11380 4701.86,-11380"/>
<polygon fill="red" stroke="red" points="4701.86,-11383.5 4711.86,-11380 4701.86,-11376.5 4701.86,-11383.5"/>
</g>
<!-- attn_out_1_7 -->
<g id="node730" class="node">
<title>attn_out_1_7</title>
<polygon fill="none" stroke="black" points="4403.5,-10986 4264.5,-10986 4264.5,-10933 4403.5,-10933 4403.5,-10986"/>
<text text-anchor="middle" x="4334" y="-10970.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="4334" y="-10955.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="4334" y="-10940.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_1_7_stage_15&#45;&gt;attn_out_1_7 -->
<g id="edge722" class="edge">
<title>ring_attn_1_7_stage_15&#45;&gt;attn_out_1_7</title>
<path fill="none" stroke="black" d="M4334,-11058.87C4334,-11058.87 4334,-10996.18 4334,-10996.18"/>
<polygon fill="black" stroke="black" points="4337.5,-10996.18 4334,-10986.18 4330.5,-10996.18 4337.5,-10996.18"/>
</g>
<!-- ring_attn_1_8_stage_15 -->
<g id="node827" class="node">
<title>ring_attn_1_8_stage_15</title>
<polygon fill="yellow" stroke="black" points="4921,-11195 4712,-11127 4921,-11059 5130,-11127 4921,-11195"/>
<text text-anchor="middle" x="4921" y="-11145.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-11130.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="4921" y="-11115.8" font-family="Times,serif" font-size="14.00">Q[8]×K[9]×V[9]</text>
<text text-anchor="middle" x="4921" y="-11100.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_7_stage_15&#45;&gt;ring_attn_1_8_stage_15 -->
<g id="edge2032" class="edge">
<title>ring_attn_1_7_stage_15&#45;&gt;ring_attn_1_8_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-11127C4543.02,-11127 4701.86,-11127 4701.86,-11127"/>
<polygon fill="red" stroke="red" points="4701.86,-11130.5 4711.86,-11127 4701.86,-11123.5 4701.86,-11130.5"/>
</g>
<!-- attn_residual_1_7 -->
<g id="node731" class="node">
<title>attn_residual_1_7</title>
<ellipse fill="none" stroke="black" cx="4334" cy="-10833" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4334" y="-10836.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4334" y="-10821.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_1_7&#45;&gt;attn_residual_1_7 -->
<g id="edge723" class="edge">
<title>attn_out_1_7&#45;&gt;attn_residual_1_7</title>
<path fill="none" stroke="black" d="M4334,-10932.98C4334,-10932.98 4334,-10870.36 4334,-10870.36"/>
<polygon fill="black" stroke="black" points="4337.5,-10870.36 4334,-10860.36 4330.5,-10870.36 4337.5,-10870.36"/>
</g>
<!-- ffn_up_1_7 -->
<g id="node732" class="node">
<title>ffn_up_1_7</title>
<polygon fill="none" stroke="black" points="4413,-10733 4255,-10733 4255,-10680 4413,-10680 4413,-10733"/>
<text text-anchor="middle" x="4334" y="-10717.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4334" y="-10702.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="4334" y="-10687.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_1_7&#45;&gt;ffn_up_1_7 -->
<g id="edge724" class="edge">
<title>attn_residual_1_7&#45;&gt;ffn_up_1_7</title>
<path fill="none" stroke="black" d="M4334,-10805.86C4334,-10805.86 4334,-10743.16 4334,-10743.16"/>
<polygon fill="black" stroke="black" points="4337.5,-10743.16 4334,-10733.16 4330.5,-10743.16 4337.5,-10743.16"/>
</g>
<!-- ffn_gelu_1_7 -->
<g id="node733" class="node">
<title>ffn_gelu_1_7</title>
<ellipse fill="none" stroke="black" cx="4334" cy="-10580" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4334" y="-10583.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4334" y="-10568.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_1_7&#45;&gt;ffn_gelu_1_7 -->
<g id="edge725" class="edge">
<title>ffn_up_1_7&#45;&gt;ffn_gelu_1_7</title>
<path fill="none" stroke="black" d="M4334,-10679.98C4334,-10679.98 4334,-10617.36 4334,-10617.36"/>
<polygon fill="black" stroke="black" points="4337.5,-10617.36 4334,-10607.36 4330.5,-10617.36 4337.5,-10617.36"/>
</g>
<!-- ffn_down_1_7 -->
<g id="node734" class="node">
<title>ffn_down_1_7</title>
<polygon fill="none" stroke="black" points="4423,-10480 4245,-10480 4245,-10427 4423,-10427 4423,-10480"/>
<text text-anchor="middle" x="4334" y="-10464.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4334" y="-10449.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="4334" y="-10434.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_1_7&#45;&gt;ffn_down_1_7 -->
<g id="edge726" class="edge">
<title>ffn_gelu_1_7&#45;&gt;ffn_down_1_7</title>
<path fill="none" stroke="black" d="M4334,-10552.86C4334,-10552.86 4334,-10490.16 4334,-10490.16"/>
<polygon fill="black" stroke="black" points="4337.5,-10490.16 4334,-10480.16 4330.5,-10490.16 4337.5,-10490.16"/>
</g>
<!-- ffn_residual_1_7 -->
<g id="node735" class="node">
<title>ffn_residual_1_7</title>
<ellipse fill="none" stroke="black" cx="4334" cy="-10327" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4334" y="-10330.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4334" y="-10315.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_1_7&#45;&gt;ffn_residual_1_7 -->
<g id="edge727" class="edge">
<title>ffn_down_1_7&#45;&gt;ffn_residual_1_7</title>
<path fill="none" stroke="black" d="M4334,-10426.98C4334,-10426.98 4334,-10364.36 4334,-10364.36"/>
<polygon fill="black" stroke="black" points="4337.5,-10364.36 4334,-10354.36 4330.5,-10364.36 4337.5,-10364.36"/>
</g>
<!-- qkv_proj_2_7 -->
<g id="node736" class="node">
<title>qkv_proj_2_7</title>
<polygon fill="none" stroke="black" points="4416.5,-10227 4251.5,-10227 4251.5,-10174 4416.5,-10174 4416.5,-10227"/>
<text text-anchor="middle" x="4334" y="-10211.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4334" y="-10196.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="4334" y="-10181.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_1_7&#45;&gt;qkv_proj_2_7 -->
<g id="edge728" class="edge">
<title>ffn_residual_1_7&#45;&gt;qkv_proj_2_7</title>
<path fill="none" stroke="black" d="M4334,-10299.86C4334,-10299.86 4334,-10237.16 4334,-10237.16"/>
<polygon fill="black" stroke="black" points="4337.5,-10237.16 4334,-10227.16 4330.5,-10237.16 4337.5,-10237.16"/>
</g>
<!-- qkv_reshape_2_7 -->
<g id="node737" class="node">
<title>qkv_reshape_2_7</title>
<ellipse fill="none" stroke="black" cx="4334" cy="-10074" rx="148" ry="27"/>
<text text-anchor="middle" x="4334" y="-10077.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="4334" y="-10062.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_2_7&#45;&gt;qkv_reshape_2_7 -->
<g id="edge729" class="edge">
<title>qkv_proj_2_7&#45;&gt;qkv_reshape_2_7</title>
<path fill="none" stroke="black" d="M4334,-10173.98C4334,-10173.98 4334,-10111.36 4334,-10111.36"/>
<polygon fill="black" stroke="black" points="4337.5,-10111.36 4334,-10101.36 4330.5,-10111.36 4337.5,-10111.36"/>
</g>
<!-- qkv_reshape_2_7&#45;&gt;ring_attn_2_7_stage_0 -->
<g id="edge730" class="edge">
<title>qkv_reshape_2_7&#45;&gt;ring_attn_2_7_stage_0</title>
<path fill="none" stroke="black" d="M4334,-10046.72C4334,-10046.72 4334,-9940.16 4334,-9940.16"/>
<polygon fill="black" stroke="black" points="4337.5,-9940.16 4334,-9930.16 4330.5,-9940.16 4337.5,-9940.16"/>
</g>
<!-- ring_attn_2_7_stage_0&#45;&gt;ring_attn_2_7_stage_1 -->
<g id="edge731" class="edge">
<title>ring_attn_2_7_stage_0&#45;&gt;ring_attn_2_7_stage_1</title>
<path fill="none" stroke="black" d="M4334,-9793.87C4334,-9793.87 4334,-9687.25 4334,-9687.25"/>
<polygon fill="black" stroke="black" points="4337.5,-9687.25 4334,-9677.25 4330.5,-9687.25 4337.5,-9687.25"/>
</g>
<!-- ring_attn_2_8_stage_0 -->
<g id="node836" class="node">
<title>ring_attn_2_8_stage_0</title>
<polygon fill="yellow" stroke="black" points="4921,-9930 4712,-9862 4921,-9794 5130,-9862 4921,-9930"/>
<text text-anchor="middle" x="4921" y="-9880.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-9865.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="4921" y="-9850.8" font-family="Times,serif" font-size="14.00">Q[8]×K[8]×V[8]</text>
<text text-anchor="middle" x="4921" y="-9835.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_7_stage_0&#45;&gt;ring_attn_2_8_stage_0 -->
<g id="edge2033" class="edge">
<title>ring_attn_2_7_stage_0&#45;&gt;ring_attn_2_8_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-9862C4543.02,-9862 4701.86,-9862 4701.86,-9862"/>
<polygon fill="red" stroke="red" points="4701.86,-9865.5 4711.86,-9862 4701.86,-9858.5 4701.86,-9865.5"/>
</g>
<!-- ring_attn_2_7_stage_1&#45;&gt;ring_attn_2_7_stage_2 -->
<g id="edge732" class="edge">
<title>ring_attn_2_7_stage_1&#45;&gt;ring_attn_2_7_stage_2</title>
<path fill="none" stroke="black" d="M4334,-9540.87C4334,-9540.87 4334,-9434.25 4334,-9434.25"/>
<polygon fill="black" stroke="black" points="4337.5,-9434.25 4334,-9424.25 4330.5,-9434.25 4337.5,-9434.25"/>
</g>
<!-- ring_attn_2_8_stage_1 -->
<g id="node837" class="node">
<title>ring_attn_2_8_stage_1</title>
<polygon fill="yellow" stroke="black" points="4921,-9677 4712,-9609 4921,-9541 5130,-9609 4921,-9677"/>
<text text-anchor="middle" x="4921" y="-9627.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-9612.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="4921" y="-9597.8" font-family="Times,serif" font-size="14.00">Q[8]×K[7]×V[7]</text>
<text text-anchor="middle" x="4921" y="-9582.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_7_stage_1&#45;&gt;ring_attn_2_8_stage_1 -->
<g id="edge2034" class="edge">
<title>ring_attn_2_7_stage_1&#45;&gt;ring_attn_2_8_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-9609C4543.02,-9609 4701.86,-9609 4701.86,-9609"/>
<polygon fill="red" stroke="red" points="4701.86,-9612.5 4711.86,-9609 4701.86,-9605.5 4701.86,-9612.5"/>
</g>
<!-- ring_attn_2_7_stage_2&#45;&gt;ring_attn_2_7_stage_3 -->
<g id="edge733" class="edge">
<title>ring_attn_2_7_stage_2&#45;&gt;ring_attn_2_7_stage_3</title>
<path fill="none" stroke="black" d="M4334,-9287.87C4334,-9287.87 4334,-9181.25 4334,-9181.25"/>
<polygon fill="black" stroke="black" points="4337.5,-9181.25 4334,-9171.25 4330.5,-9181.25 4337.5,-9181.25"/>
</g>
<!-- ring_attn_2_8_stage_2 -->
<g id="node838" class="node">
<title>ring_attn_2_8_stage_2</title>
<polygon fill="yellow" stroke="black" points="4921,-9424 4712,-9356 4921,-9288 5130,-9356 4921,-9424"/>
<text text-anchor="middle" x="4921" y="-9374.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-9359.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="4921" y="-9344.8" font-family="Times,serif" font-size="14.00">Q[8]×K[6]×V[6]</text>
<text text-anchor="middle" x="4921" y="-9329.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_7_stage_2&#45;&gt;ring_attn_2_8_stage_2 -->
<g id="edge2035" class="edge">
<title>ring_attn_2_7_stage_2&#45;&gt;ring_attn_2_8_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-9356C4543.02,-9356 4701.86,-9356 4701.86,-9356"/>
<polygon fill="red" stroke="red" points="4701.86,-9359.5 4711.86,-9356 4701.86,-9352.5 4701.86,-9359.5"/>
</g>
<!-- ring_attn_2_7_stage_3&#45;&gt;ring_attn_2_7_stage_4 -->
<g id="edge734" class="edge">
<title>ring_attn_2_7_stage_3&#45;&gt;ring_attn_2_7_stage_4</title>
<path fill="none" stroke="black" d="M4334,-9034.87C4334,-9034.87 4334,-8928.25 4334,-8928.25"/>
<polygon fill="black" stroke="black" points="4337.5,-8928.25 4334,-8918.25 4330.5,-8928.25 4337.5,-8928.25"/>
</g>
<!-- ring_attn_2_8_stage_3 -->
<g id="node839" class="node">
<title>ring_attn_2_8_stage_3</title>
<polygon fill="yellow" stroke="black" points="4921,-9171 4712,-9103 4921,-9035 5130,-9103 4921,-9171"/>
<text text-anchor="middle" x="4921" y="-9121.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-9106.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="4921" y="-9091.8" font-family="Times,serif" font-size="14.00">Q[8]×K[5]×V[5]</text>
<text text-anchor="middle" x="4921" y="-9076.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_7_stage_3&#45;&gt;ring_attn_2_8_stage_3 -->
<g id="edge2036" class="edge">
<title>ring_attn_2_7_stage_3&#45;&gt;ring_attn_2_8_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-9103C4543.02,-9103 4701.86,-9103 4701.86,-9103"/>
<polygon fill="red" stroke="red" points="4701.86,-9106.5 4711.86,-9103 4701.86,-9099.5 4701.86,-9106.5"/>
</g>
<!-- ring_attn_2_7_stage_4&#45;&gt;ring_attn_2_7_stage_5 -->
<g id="edge735" class="edge">
<title>ring_attn_2_7_stage_4&#45;&gt;ring_attn_2_7_stage_5</title>
<path fill="none" stroke="black" d="M4334,-8781.87C4334,-8781.87 4334,-8675.25 4334,-8675.25"/>
<polygon fill="black" stroke="black" points="4337.5,-8675.25 4334,-8665.25 4330.5,-8675.25 4337.5,-8675.25"/>
</g>
<!-- ring_attn_2_8_stage_4 -->
<g id="node840" class="node">
<title>ring_attn_2_8_stage_4</title>
<polygon fill="yellow" stroke="black" points="4921,-8918 4712,-8850 4921,-8782 5130,-8850 4921,-8918"/>
<text text-anchor="middle" x="4921" y="-8868.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-8853.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="4921" y="-8838.8" font-family="Times,serif" font-size="14.00">Q[8]×K[4]×V[4]</text>
<text text-anchor="middle" x="4921" y="-8823.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_7_stage_4&#45;&gt;ring_attn_2_8_stage_4 -->
<g id="edge2037" class="edge">
<title>ring_attn_2_7_stage_4&#45;&gt;ring_attn_2_8_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-8850C4543.02,-8850 4701.86,-8850 4701.86,-8850"/>
<polygon fill="red" stroke="red" points="4701.86,-8853.5 4711.86,-8850 4701.86,-8846.5 4701.86,-8853.5"/>
</g>
<!-- ring_attn_2_7_stage_5&#45;&gt;ring_attn_2_7_stage_6 -->
<g id="edge736" class="edge">
<title>ring_attn_2_7_stage_5&#45;&gt;ring_attn_2_7_stage_6</title>
<path fill="none" stroke="black" d="M4334,-8528.87C4334,-8528.87 4334,-8422.25 4334,-8422.25"/>
<polygon fill="black" stroke="black" points="4337.5,-8422.25 4334,-8412.25 4330.5,-8422.25 4337.5,-8422.25"/>
</g>
<!-- ring_attn_2_8_stage_5 -->
<g id="node841" class="node">
<title>ring_attn_2_8_stage_5</title>
<polygon fill="yellow" stroke="black" points="4921,-8665 4712,-8597 4921,-8529 5130,-8597 4921,-8665"/>
<text text-anchor="middle" x="4921" y="-8615.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-8600.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="4921" y="-8585.8" font-family="Times,serif" font-size="14.00">Q[8]×K[3]×V[3]</text>
<text text-anchor="middle" x="4921" y="-8570.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_7_stage_5&#45;&gt;ring_attn_2_8_stage_5 -->
<g id="edge2038" class="edge">
<title>ring_attn_2_7_stage_5&#45;&gt;ring_attn_2_8_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-8597C4543.02,-8597 4701.86,-8597 4701.86,-8597"/>
<polygon fill="red" stroke="red" points="4701.86,-8600.5 4711.86,-8597 4701.86,-8593.5 4701.86,-8600.5"/>
</g>
<!-- ring_attn_2_7_stage_6&#45;&gt;ring_attn_2_7_stage_7 -->
<g id="edge737" class="edge">
<title>ring_attn_2_7_stage_6&#45;&gt;ring_attn_2_7_stage_7</title>
<path fill="none" stroke="black" d="M4334,-8275.87C4334,-8275.87 4334,-8169.25 4334,-8169.25"/>
<polygon fill="black" stroke="black" points="4337.5,-8169.25 4334,-8159.25 4330.5,-8169.25 4337.5,-8169.25"/>
</g>
<!-- ring_attn_2_8_stage_6 -->
<g id="node842" class="node">
<title>ring_attn_2_8_stage_6</title>
<polygon fill="yellow" stroke="black" points="4921,-8412 4712,-8344 4921,-8276 5130,-8344 4921,-8412"/>
<text text-anchor="middle" x="4921" y="-8362.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-8347.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="4921" y="-8332.8" font-family="Times,serif" font-size="14.00">Q[8]×K[2]×V[2]</text>
<text text-anchor="middle" x="4921" y="-8317.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_7_stage_6&#45;&gt;ring_attn_2_8_stage_6 -->
<g id="edge2039" class="edge">
<title>ring_attn_2_7_stage_6&#45;&gt;ring_attn_2_8_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-8344C4543.02,-8344 4701.86,-8344 4701.86,-8344"/>
<polygon fill="red" stroke="red" points="4701.86,-8347.5 4711.86,-8344 4701.86,-8340.5 4701.86,-8347.5"/>
</g>
<!-- ring_attn_2_7_stage_7&#45;&gt;ring_attn_2_7_stage_8 -->
<g id="edge738" class="edge">
<title>ring_attn_2_7_stage_7&#45;&gt;ring_attn_2_7_stage_8</title>
<path fill="none" stroke="black" d="M4334,-8022.87C4334,-8022.87 4334,-7916.25 4334,-7916.25"/>
<polygon fill="black" stroke="black" points="4337.5,-7916.25 4334,-7906.25 4330.5,-7916.25 4337.5,-7916.25"/>
</g>
<!-- ring_attn_2_8_stage_7 -->
<g id="node843" class="node">
<title>ring_attn_2_8_stage_7</title>
<polygon fill="yellow" stroke="black" points="4921,-8159 4712,-8091 4921,-8023 5130,-8091 4921,-8159"/>
<text text-anchor="middle" x="4921" y="-8109.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-8094.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="4921" y="-8079.8" font-family="Times,serif" font-size="14.00">Q[8]×K[1]×V[1]</text>
<text text-anchor="middle" x="4921" y="-8064.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_7_stage_7&#45;&gt;ring_attn_2_8_stage_7 -->
<g id="edge2040" class="edge">
<title>ring_attn_2_7_stage_7&#45;&gt;ring_attn_2_8_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-8091C4543.02,-8091 4701.86,-8091 4701.86,-8091"/>
<polygon fill="red" stroke="red" points="4701.86,-8094.5 4711.86,-8091 4701.86,-8087.5 4701.86,-8094.5"/>
</g>
<!-- ring_attn_2_7_stage_8&#45;&gt;ring_attn_2_7_stage_9 -->
<g id="edge739" class="edge">
<title>ring_attn_2_7_stage_8&#45;&gt;ring_attn_2_7_stage_9</title>
<path fill="none" stroke="black" d="M4334,-7769.87C4334,-7769.87 4334,-7663.25 4334,-7663.25"/>
<polygon fill="black" stroke="black" points="4337.5,-7663.25 4334,-7653.25 4330.5,-7663.25 4337.5,-7663.25"/>
</g>
<!-- ring_attn_2_8_stage_8 -->
<g id="node844" class="node">
<title>ring_attn_2_8_stage_8</title>
<polygon fill="yellow" stroke="black" points="4921,-7906 4712,-7838 4921,-7770 5130,-7838 4921,-7906"/>
<text text-anchor="middle" x="4921" y="-7856.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-7841.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="4921" y="-7826.8" font-family="Times,serif" font-size="14.00">Q[8]×K[0]×V[0]</text>
<text text-anchor="middle" x="4921" y="-7811.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_7_stage_8&#45;&gt;ring_attn_2_8_stage_8 -->
<g id="edge2041" class="edge">
<title>ring_attn_2_7_stage_8&#45;&gt;ring_attn_2_8_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-7838C4543.02,-7838 4701.86,-7838 4701.86,-7838"/>
<polygon fill="red" stroke="red" points="4701.86,-7841.5 4711.86,-7838 4701.86,-7834.5 4701.86,-7841.5"/>
</g>
<!-- ring_attn_2_7_stage_9&#45;&gt;ring_attn_2_7_stage_10 -->
<g id="edge740" class="edge">
<title>ring_attn_2_7_stage_9&#45;&gt;ring_attn_2_7_stage_10</title>
<path fill="none" stroke="black" d="M4334,-7516.87C4334,-7516.87 4334,-7410.25 4334,-7410.25"/>
<polygon fill="black" stroke="black" points="4337.5,-7410.25 4334,-7400.25 4330.5,-7410.25 4337.5,-7410.25"/>
</g>
<!-- ring_attn_2_8_stage_9 -->
<g id="node845" class="node">
<title>ring_attn_2_8_stage_9</title>
<polygon fill="yellow" stroke="black" points="4921,-7653 4712,-7585 4921,-7517 5130,-7585 4921,-7653"/>
<text text-anchor="middle" x="4921" y="-7603.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-7588.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="4921" y="-7573.8" font-family="Times,serif" font-size="14.00">Q[8]×K[15]×V[15]</text>
<text text-anchor="middle" x="4921" y="-7558.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_7_stage_9&#45;&gt;ring_attn_2_8_stage_9 -->
<g id="edge2042" class="edge">
<title>ring_attn_2_7_stage_9&#45;&gt;ring_attn_2_8_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-7585C4543.02,-7585 4701.86,-7585 4701.86,-7585"/>
<polygon fill="red" stroke="red" points="4701.86,-7588.5 4711.86,-7585 4701.86,-7581.5 4701.86,-7588.5"/>
</g>
<!-- ring_attn_2_7_stage_10&#45;&gt;ring_attn_2_7_stage_11 -->
<g id="edge741" class="edge">
<title>ring_attn_2_7_stage_10&#45;&gt;ring_attn_2_7_stage_11</title>
<path fill="none" stroke="black" d="M4334,-7263.87C4334,-7263.87 4334,-7157.25 4334,-7157.25"/>
<polygon fill="black" stroke="black" points="4337.5,-7157.25 4334,-7147.25 4330.5,-7157.25 4337.5,-7157.25"/>
</g>
<!-- ring_attn_2_8_stage_10 -->
<g id="node846" class="node">
<title>ring_attn_2_8_stage_10</title>
<polygon fill="yellow" stroke="black" points="4921,-7400 4712,-7332 4921,-7264 5130,-7332 4921,-7400"/>
<text text-anchor="middle" x="4921" y="-7350.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-7335.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="4921" y="-7320.8" font-family="Times,serif" font-size="14.00">Q[8]×K[14]×V[14]</text>
<text text-anchor="middle" x="4921" y="-7305.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_7_stage_10&#45;&gt;ring_attn_2_8_stage_10 -->
<g id="edge2043" class="edge">
<title>ring_attn_2_7_stage_10&#45;&gt;ring_attn_2_8_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-7332C4543.02,-7332 4701.86,-7332 4701.86,-7332"/>
<polygon fill="red" stroke="red" points="4701.86,-7335.5 4711.86,-7332 4701.86,-7328.5 4701.86,-7335.5"/>
</g>
<!-- ring_attn_2_7_stage_11&#45;&gt;ring_attn_2_7_stage_12 -->
<g id="edge742" class="edge">
<title>ring_attn_2_7_stage_11&#45;&gt;ring_attn_2_7_stage_12</title>
<path fill="none" stroke="black" d="M4334,-7010.87C4334,-7010.87 4334,-6904.25 4334,-6904.25"/>
<polygon fill="black" stroke="black" points="4337.5,-6904.25 4334,-6894.25 4330.5,-6904.25 4337.5,-6904.25"/>
</g>
<!-- ring_attn_2_8_stage_11 -->
<g id="node847" class="node">
<title>ring_attn_2_8_stage_11</title>
<polygon fill="yellow" stroke="black" points="4921,-7147 4712,-7079 4921,-7011 5130,-7079 4921,-7147"/>
<text text-anchor="middle" x="4921" y="-7097.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-7082.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="4921" y="-7067.8" font-family="Times,serif" font-size="14.00">Q[8]×K[13]×V[13]</text>
<text text-anchor="middle" x="4921" y="-7052.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_7_stage_11&#45;&gt;ring_attn_2_8_stage_11 -->
<g id="edge2044" class="edge">
<title>ring_attn_2_7_stage_11&#45;&gt;ring_attn_2_8_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-7079C4543.02,-7079 4701.86,-7079 4701.86,-7079"/>
<polygon fill="red" stroke="red" points="4701.86,-7082.5 4711.86,-7079 4701.86,-7075.5 4701.86,-7082.5"/>
</g>
<!-- ring_attn_2_7_stage_12&#45;&gt;ring_attn_2_7_stage_13 -->
<g id="edge743" class="edge">
<title>ring_attn_2_7_stage_12&#45;&gt;ring_attn_2_7_stage_13</title>
<path fill="none" stroke="black" d="M4334,-6757.87C4334,-6757.87 4334,-6651.25 4334,-6651.25"/>
<polygon fill="black" stroke="black" points="4337.5,-6651.25 4334,-6641.25 4330.5,-6651.25 4337.5,-6651.25"/>
</g>
<!-- ring_attn_2_8_stage_12 -->
<g id="node848" class="node">
<title>ring_attn_2_8_stage_12</title>
<polygon fill="yellow" stroke="black" points="4921,-6894 4712,-6826 4921,-6758 5130,-6826 4921,-6894"/>
<text text-anchor="middle" x="4921" y="-6844.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-6829.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="4921" y="-6814.8" font-family="Times,serif" font-size="14.00">Q[8]×K[12]×V[12]</text>
<text text-anchor="middle" x="4921" y="-6799.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_7_stage_12&#45;&gt;ring_attn_2_8_stage_12 -->
<g id="edge2045" class="edge">
<title>ring_attn_2_7_stage_12&#45;&gt;ring_attn_2_8_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-6826C4543.02,-6826 4701.86,-6826 4701.86,-6826"/>
<polygon fill="red" stroke="red" points="4701.86,-6829.5 4711.86,-6826 4701.86,-6822.5 4701.86,-6829.5"/>
</g>
<!-- ring_attn_2_7_stage_13&#45;&gt;ring_attn_2_7_stage_14 -->
<g id="edge744" class="edge">
<title>ring_attn_2_7_stage_13&#45;&gt;ring_attn_2_7_stage_14</title>
<path fill="none" stroke="black" d="M4334,-6504.87C4334,-6504.87 4334,-6398.25 4334,-6398.25"/>
<polygon fill="black" stroke="black" points="4337.5,-6398.25 4334,-6388.25 4330.5,-6398.25 4337.5,-6398.25"/>
</g>
<!-- ring_attn_2_8_stage_13 -->
<g id="node849" class="node">
<title>ring_attn_2_8_stage_13</title>
<polygon fill="yellow" stroke="black" points="4921,-6641 4712,-6573 4921,-6505 5130,-6573 4921,-6641"/>
<text text-anchor="middle" x="4921" y="-6591.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-6576.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="4921" y="-6561.8" font-family="Times,serif" font-size="14.00">Q[8]×K[11]×V[11]</text>
<text text-anchor="middle" x="4921" y="-6546.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_7_stage_13&#45;&gt;ring_attn_2_8_stage_13 -->
<g id="edge2046" class="edge">
<title>ring_attn_2_7_stage_13&#45;&gt;ring_attn_2_8_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-6573C4543.02,-6573 4701.86,-6573 4701.86,-6573"/>
<polygon fill="red" stroke="red" points="4701.86,-6576.5 4711.86,-6573 4701.86,-6569.5 4701.86,-6576.5"/>
</g>
<!-- ring_attn_2_7_stage_14&#45;&gt;ring_attn_2_7_stage_15 -->
<g id="edge745" class="edge">
<title>ring_attn_2_7_stage_14&#45;&gt;ring_attn_2_7_stage_15</title>
<path fill="none" stroke="black" d="M4334,-6251.87C4334,-6251.87 4334,-6145.25 4334,-6145.25"/>
<polygon fill="black" stroke="black" points="4337.5,-6145.25 4334,-6135.25 4330.5,-6145.25 4337.5,-6145.25"/>
</g>
<!-- ring_attn_2_8_stage_14 -->
<g id="node850" class="node">
<title>ring_attn_2_8_stage_14</title>
<polygon fill="yellow" stroke="black" points="4921,-6388 4712,-6320 4921,-6252 5130,-6320 4921,-6388"/>
<text text-anchor="middle" x="4921" y="-6338.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-6323.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="4921" y="-6308.8" font-family="Times,serif" font-size="14.00">Q[8]×K[10]×V[10]</text>
<text text-anchor="middle" x="4921" y="-6293.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_7_stage_14&#45;&gt;ring_attn_2_8_stage_14 -->
<g id="edge2047" class="edge">
<title>ring_attn_2_7_stage_14&#45;&gt;ring_attn_2_8_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-6320C4543.02,-6320 4701.86,-6320 4701.86,-6320"/>
<polygon fill="red" stroke="red" points="4701.86,-6323.5 4711.86,-6320 4701.86,-6316.5 4701.86,-6323.5"/>
</g>
<!-- attn_out_2_7 -->
<g id="node754" class="node">
<title>attn_out_2_7</title>
<polygon fill="none" stroke="black" points="4403.5,-5926 4264.5,-5926 4264.5,-5873 4403.5,-5873 4403.5,-5926"/>
<text text-anchor="middle" x="4334" y="-5910.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="4334" y="-5895.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="4334" y="-5880.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_2_7_stage_15&#45;&gt;attn_out_2_7 -->
<g id="edge746" class="edge">
<title>ring_attn_2_7_stage_15&#45;&gt;attn_out_2_7</title>
<path fill="none" stroke="black" d="M4334,-5998.87C4334,-5998.87 4334,-5936.18 4334,-5936.18"/>
<polygon fill="black" stroke="black" points="4337.5,-5936.18 4334,-5926.18 4330.5,-5936.18 4337.5,-5936.18"/>
</g>
<!-- ring_attn_2_8_stage_15 -->
<g id="node851" class="node">
<title>ring_attn_2_8_stage_15</title>
<polygon fill="yellow" stroke="black" points="4921,-6135 4712,-6067 4921,-5999 5130,-6067 4921,-6135"/>
<text text-anchor="middle" x="4921" y="-6085.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-6070.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="4921" y="-6055.8" font-family="Times,serif" font-size="14.00">Q[8]×K[9]×V[9]</text>
<text text-anchor="middle" x="4921" y="-6040.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_7_stage_15&#45;&gt;ring_attn_2_8_stage_15 -->
<g id="edge2048" class="edge">
<title>ring_attn_2_7_stage_15&#45;&gt;ring_attn_2_8_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-6067C4543.02,-6067 4701.86,-6067 4701.86,-6067"/>
<polygon fill="red" stroke="red" points="4701.86,-6070.5 4711.86,-6067 4701.86,-6063.5 4701.86,-6070.5"/>
</g>
<!-- attn_residual_2_7 -->
<g id="node755" class="node">
<title>attn_residual_2_7</title>
<ellipse fill="none" stroke="black" cx="4334" cy="-5773" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4334" y="-5776.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4334" y="-5761.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_2_7&#45;&gt;attn_residual_2_7 -->
<g id="edge747" class="edge">
<title>attn_out_2_7&#45;&gt;attn_residual_2_7</title>
<path fill="none" stroke="black" d="M4334,-5872.98C4334,-5872.98 4334,-5810.36 4334,-5810.36"/>
<polygon fill="black" stroke="black" points="4337.5,-5810.36 4334,-5800.36 4330.5,-5810.36 4337.5,-5810.36"/>
</g>
<!-- ffn_up_2_7 -->
<g id="node756" class="node">
<title>ffn_up_2_7</title>
<polygon fill="none" stroke="black" points="4413,-5673 4255,-5673 4255,-5620 4413,-5620 4413,-5673"/>
<text text-anchor="middle" x="4334" y="-5657.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4334" y="-5642.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="4334" y="-5627.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_2_7&#45;&gt;ffn_up_2_7 -->
<g id="edge748" class="edge">
<title>attn_residual_2_7&#45;&gt;ffn_up_2_7</title>
<path fill="none" stroke="black" d="M4334,-5745.86C4334,-5745.86 4334,-5683.16 4334,-5683.16"/>
<polygon fill="black" stroke="black" points="4337.5,-5683.16 4334,-5673.16 4330.5,-5683.16 4337.5,-5683.16"/>
</g>
<!-- ffn_gelu_2_7 -->
<g id="node757" class="node">
<title>ffn_gelu_2_7</title>
<ellipse fill="none" stroke="black" cx="4334" cy="-5520" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4334" y="-5523.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4334" y="-5508.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_2_7&#45;&gt;ffn_gelu_2_7 -->
<g id="edge749" class="edge">
<title>ffn_up_2_7&#45;&gt;ffn_gelu_2_7</title>
<path fill="none" stroke="black" d="M4334,-5619.98C4334,-5619.98 4334,-5557.36 4334,-5557.36"/>
<polygon fill="black" stroke="black" points="4337.5,-5557.36 4334,-5547.36 4330.5,-5557.36 4337.5,-5557.36"/>
</g>
<!-- ffn_down_2_7 -->
<g id="node758" class="node">
<title>ffn_down_2_7</title>
<polygon fill="none" stroke="black" points="4423,-5420 4245,-5420 4245,-5367 4423,-5367 4423,-5420"/>
<text text-anchor="middle" x="4334" y="-5404.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4334" y="-5389.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="4334" y="-5374.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_2_7&#45;&gt;ffn_down_2_7 -->
<g id="edge750" class="edge">
<title>ffn_gelu_2_7&#45;&gt;ffn_down_2_7</title>
<path fill="none" stroke="black" d="M4334,-5492.86C4334,-5492.86 4334,-5430.16 4334,-5430.16"/>
<polygon fill="black" stroke="black" points="4337.5,-5430.16 4334,-5420.16 4330.5,-5430.16 4337.5,-5430.16"/>
</g>
<!-- ffn_residual_2_7 -->
<g id="node759" class="node">
<title>ffn_residual_2_7</title>
<ellipse fill="none" stroke="black" cx="4334" cy="-5267" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4334" y="-5270.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4334" y="-5255.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_2_7&#45;&gt;ffn_residual_2_7 -->
<g id="edge751" class="edge">
<title>ffn_down_2_7&#45;&gt;ffn_residual_2_7</title>
<path fill="none" stroke="black" d="M4334,-5366.98C4334,-5366.98 4334,-5304.36 4334,-5304.36"/>
<polygon fill="black" stroke="black" points="4337.5,-5304.36 4334,-5294.36 4330.5,-5304.36 4337.5,-5304.36"/>
</g>
<!-- qkv_proj_3_7 -->
<g id="node760" class="node">
<title>qkv_proj_3_7</title>
<polygon fill="none" stroke="black" points="4416.5,-5167 4251.5,-5167 4251.5,-5114 4416.5,-5114 4416.5,-5167"/>
<text text-anchor="middle" x="4334" y="-5151.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4334" y="-5136.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="4334" y="-5121.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_2_7&#45;&gt;qkv_proj_3_7 -->
<g id="edge752" class="edge">
<title>ffn_residual_2_7&#45;&gt;qkv_proj_3_7</title>
<path fill="none" stroke="black" d="M4334,-5239.86C4334,-5239.86 4334,-5177.16 4334,-5177.16"/>
<polygon fill="black" stroke="black" points="4337.5,-5177.16 4334,-5167.16 4330.5,-5177.16 4337.5,-5177.16"/>
</g>
<!-- qkv_reshape_3_7 -->
<g id="node761" class="node">
<title>qkv_reshape_3_7</title>
<ellipse fill="none" stroke="black" cx="4334" cy="-5014" rx="148" ry="27"/>
<text text-anchor="middle" x="4334" y="-5017.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="4334" y="-5002.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_3_7&#45;&gt;qkv_reshape_3_7 -->
<g id="edge753" class="edge">
<title>qkv_proj_3_7&#45;&gt;qkv_reshape_3_7</title>
<path fill="none" stroke="black" d="M4334,-5113.98C4334,-5113.98 4334,-5051.36 4334,-5051.36"/>
<polygon fill="black" stroke="black" points="4337.5,-5051.36 4334,-5041.36 4330.5,-5051.36 4337.5,-5051.36"/>
</g>
<!-- qkv_reshape_3_7&#45;&gt;ring_attn_3_7_stage_0 -->
<g id="edge754" class="edge">
<title>qkv_reshape_3_7&#45;&gt;ring_attn_3_7_stage_0</title>
<path fill="none" stroke="black" d="M4334,-4986.72C4334,-4986.72 4334,-4880.16 4334,-4880.16"/>
<polygon fill="black" stroke="black" points="4337.5,-4880.16 4334,-4870.16 4330.5,-4880.16 4337.5,-4880.16"/>
</g>
<!-- ring_attn_3_7_stage_0&#45;&gt;ring_attn_3_7_stage_1 -->
<g id="edge755" class="edge">
<title>ring_attn_3_7_stage_0&#45;&gt;ring_attn_3_7_stage_1</title>
<path fill="none" stroke="black" d="M4334,-4733.87C4334,-4733.87 4334,-4627.25 4334,-4627.25"/>
<polygon fill="black" stroke="black" points="4337.5,-4627.25 4334,-4617.25 4330.5,-4627.25 4337.5,-4627.25"/>
</g>
<!-- ring_attn_3_8_stage_0 -->
<g id="node860" class="node">
<title>ring_attn_3_8_stage_0</title>
<polygon fill="yellow" stroke="black" points="4921,-4870 4712,-4802 4921,-4734 5130,-4802 4921,-4870"/>
<text text-anchor="middle" x="4921" y="-4820.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-4805.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="4921" y="-4790.8" font-family="Times,serif" font-size="14.00">Q[8]×K[8]×V[8]</text>
<text text-anchor="middle" x="4921" y="-4775.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_7_stage_0&#45;&gt;ring_attn_3_8_stage_0 -->
<g id="edge2049" class="edge">
<title>ring_attn_3_7_stage_0&#45;&gt;ring_attn_3_8_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-4802C4543.02,-4802 4701.86,-4802 4701.86,-4802"/>
<polygon fill="red" stroke="red" points="4701.86,-4805.5 4711.86,-4802 4701.86,-4798.5 4701.86,-4805.5"/>
</g>
<!-- ring_attn_3_7_stage_1&#45;&gt;ring_attn_3_7_stage_2 -->
<g id="edge756" class="edge">
<title>ring_attn_3_7_stage_1&#45;&gt;ring_attn_3_7_stage_2</title>
<path fill="none" stroke="black" d="M4334,-4480.87C4334,-4480.87 4334,-4374.25 4334,-4374.25"/>
<polygon fill="black" stroke="black" points="4337.5,-4374.25 4334,-4364.25 4330.5,-4374.25 4337.5,-4374.25"/>
</g>
<!-- ring_attn_3_8_stage_1 -->
<g id="node861" class="node">
<title>ring_attn_3_8_stage_1</title>
<polygon fill="yellow" stroke="black" points="4921,-4617 4712,-4549 4921,-4481 5130,-4549 4921,-4617"/>
<text text-anchor="middle" x="4921" y="-4567.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-4552.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="4921" y="-4537.8" font-family="Times,serif" font-size="14.00">Q[8]×K[7]×V[7]</text>
<text text-anchor="middle" x="4921" y="-4522.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_7_stage_1&#45;&gt;ring_attn_3_8_stage_1 -->
<g id="edge2050" class="edge">
<title>ring_attn_3_7_stage_1&#45;&gt;ring_attn_3_8_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-4549C4543.02,-4549 4701.86,-4549 4701.86,-4549"/>
<polygon fill="red" stroke="red" points="4701.86,-4552.5 4711.86,-4549 4701.86,-4545.5 4701.86,-4552.5"/>
</g>
<!-- ring_attn_3_7_stage_2&#45;&gt;ring_attn_3_7_stage_3 -->
<g id="edge757" class="edge">
<title>ring_attn_3_7_stage_2&#45;&gt;ring_attn_3_7_stage_3</title>
<path fill="none" stroke="black" d="M4334,-4227.87C4334,-4227.87 4334,-4121.25 4334,-4121.25"/>
<polygon fill="black" stroke="black" points="4337.5,-4121.25 4334,-4111.25 4330.5,-4121.25 4337.5,-4121.25"/>
</g>
<!-- ring_attn_3_8_stage_2 -->
<g id="node862" class="node">
<title>ring_attn_3_8_stage_2</title>
<polygon fill="yellow" stroke="black" points="4921,-4364 4712,-4296 4921,-4228 5130,-4296 4921,-4364"/>
<text text-anchor="middle" x="4921" y="-4314.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-4299.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="4921" y="-4284.8" font-family="Times,serif" font-size="14.00">Q[8]×K[6]×V[6]</text>
<text text-anchor="middle" x="4921" y="-4269.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_7_stage_2&#45;&gt;ring_attn_3_8_stage_2 -->
<g id="edge2051" class="edge">
<title>ring_attn_3_7_stage_2&#45;&gt;ring_attn_3_8_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-4296C4543.02,-4296 4701.86,-4296 4701.86,-4296"/>
<polygon fill="red" stroke="red" points="4701.86,-4299.5 4711.86,-4296 4701.86,-4292.5 4701.86,-4299.5"/>
</g>
<!-- ring_attn_3_7_stage_3&#45;&gt;ring_attn_3_7_stage_4 -->
<g id="edge758" class="edge">
<title>ring_attn_3_7_stage_3&#45;&gt;ring_attn_3_7_stage_4</title>
<path fill="none" stroke="black" d="M4334,-3974.87C4334,-3974.87 4334,-3868.25 4334,-3868.25"/>
<polygon fill="black" stroke="black" points="4337.5,-3868.25 4334,-3858.25 4330.5,-3868.25 4337.5,-3868.25"/>
</g>
<!-- ring_attn_3_8_stage_3 -->
<g id="node863" class="node">
<title>ring_attn_3_8_stage_3</title>
<polygon fill="yellow" stroke="black" points="4921,-4111 4712,-4043 4921,-3975 5130,-4043 4921,-4111"/>
<text text-anchor="middle" x="4921" y="-4061.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-4046.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="4921" y="-4031.8" font-family="Times,serif" font-size="14.00">Q[8]×K[5]×V[5]</text>
<text text-anchor="middle" x="4921" y="-4016.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_7_stage_3&#45;&gt;ring_attn_3_8_stage_3 -->
<g id="edge2052" class="edge">
<title>ring_attn_3_7_stage_3&#45;&gt;ring_attn_3_8_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-4043C4543.02,-4043 4701.86,-4043 4701.86,-4043"/>
<polygon fill="red" stroke="red" points="4701.86,-4046.5 4711.86,-4043 4701.86,-4039.5 4701.86,-4046.5"/>
</g>
<!-- ring_attn_3_7_stage_4&#45;&gt;ring_attn_3_7_stage_5 -->
<g id="edge759" class="edge">
<title>ring_attn_3_7_stage_4&#45;&gt;ring_attn_3_7_stage_5</title>
<path fill="none" stroke="black" d="M4334,-3721.87C4334,-3721.87 4334,-3615.25 4334,-3615.25"/>
<polygon fill="black" stroke="black" points="4337.5,-3615.25 4334,-3605.25 4330.5,-3615.25 4337.5,-3615.25"/>
</g>
<!-- ring_attn_3_8_stage_4 -->
<g id="node864" class="node">
<title>ring_attn_3_8_stage_4</title>
<polygon fill="yellow" stroke="black" points="4921,-3858 4712,-3790 4921,-3722 5130,-3790 4921,-3858"/>
<text text-anchor="middle" x="4921" y="-3808.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-3793.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="4921" y="-3778.8" font-family="Times,serif" font-size="14.00">Q[8]×K[4]×V[4]</text>
<text text-anchor="middle" x="4921" y="-3763.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_7_stage_4&#45;&gt;ring_attn_3_8_stage_4 -->
<g id="edge2053" class="edge">
<title>ring_attn_3_7_stage_4&#45;&gt;ring_attn_3_8_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-3790C4543.02,-3790 4701.86,-3790 4701.86,-3790"/>
<polygon fill="red" stroke="red" points="4701.86,-3793.5 4711.86,-3790 4701.86,-3786.5 4701.86,-3793.5"/>
</g>
<!-- ring_attn_3_7_stage_5&#45;&gt;ring_attn_3_7_stage_6 -->
<g id="edge760" class="edge">
<title>ring_attn_3_7_stage_5&#45;&gt;ring_attn_3_7_stage_6</title>
<path fill="none" stroke="black" d="M4334,-3468.87C4334,-3468.87 4334,-3362.25 4334,-3362.25"/>
<polygon fill="black" stroke="black" points="4337.5,-3362.25 4334,-3352.25 4330.5,-3362.25 4337.5,-3362.25"/>
</g>
<!-- ring_attn_3_8_stage_5 -->
<g id="node865" class="node">
<title>ring_attn_3_8_stage_5</title>
<polygon fill="yellow" stroke="black" points="4921,-3605 4712,-3537 4921,-3469 5130,-3537 4921,-3605"/>
<text text-anchor="middle" x="4921" y="-3555.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-3540.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="4921" y="-3525.8" font-family="Times,serif" font-size="14.00">Q[8]×K[3]×V[3]</text>
<text text-anchor="middle" x="4921" y="-3510.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_7_stage_5&#45;&gt;ring_attn_3_8_stage_5 -->
<g id="edge2054" class="edge">
<title>ring_attn_3_7_stage_5&#45;&gt;ring_attn_3_8_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-3537C4543.02,-3537 4701.86,-3537 4701.86,-3537"/>
<polygon fill="red" stroke="red" points="4701.86,-3540.5 4711.86,-3537 4701.86,-3533.5 4701.86,-3540.5"/>
</g>
<!-- ring_attn_3_7_stage_6&#45;&gt;ring_attn_3_7_stage_7 -->
<g id="edge761" class="edge">
<title>ring_attn_3_7_stage_6&#45;&gt;ring_attn_3_7_stage_7</title>
<path fill="none" stroke="black" d="M4334,-3215.87C4334,-3215.87 4334,-3109.25 4334,-3109.25"/>
<polygon fill="black" stroke="black" points="4337.5,-3109.25 4334,-3099.25 4330.5,-3109.25 4337.5,-3109.25"/>
</g>
<!-- ring_attn_3_8_stage_6 -->
<g id="node866" class="node">
<title>ring_attn_3_8_stage_6</title>
<polygon fill="yellow" stroke="black" points="4921,-3352 4712,-3284 4921,-3216 5130,-3284 4921,-3352"/>
<text text-anchor="middle" x="4921" y="-3302.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-3287.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="4921" y="-3272.8" font-family="Times,serif" font-size="14.00">Q[8]×K[2]×V[2]</text>
<text text-anchor="middle" x="4921" y="-3257.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_7_stage_6&#45;&gt;ring_attn_3_8_stage_6 -->
<g id="edge2055" class="edge">
<title>ring_attn_3_7_stage_6&#45;&gt;ring_attn_3_8_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-3284C4543.02,-3284 4701.86,-3284 4701.86,-3284"/>
<polygon fill="red" stroke="red" points="4701.86,-3287.5 4711.86,-3284 4701.86,-3280.5 4701.86,-3287.5"/>
</g>
<!-- ring_attn_3_7_stage_7&#45;&gt;ring_attn_3_7_stage_8 -->
<g id="edge762" class="edge">
<title>ring_attn_3_7_stage_7&#45;&gt;ring_attn_3_7_stage_8</title>
<path fill="none" stroke="black" d="M4334,-2962.87C4334,-2962.87 4334,-2856.25 4334,-2856.25"/>
<polygon fill="black" stroke="black" points="4337.5,-2856.25 4334,-2846.25 4330.5,-2856.25 4337.5,-2856.25"/>
</g>
<!-- ring_attn_3_8_stage_7 -->
<g id="node867" class="node">
<title>ring_attn_3_8_stage_7</title>
<polygon fill="yellow" stroke="black" points="4921,-3099 4712,-3031 4921,-2963 5130,-3031 4921,-3099"/>
<text text-anchor="middle" x="4921" y="-3049.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-3034.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="4921" y="-3019.8" font-family="Times,serif" font-size="14.00">Q[8]×K[1]×V[1]</text>
<text text-anchor="middle" x="4921" y="-3004.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_7_stage_7&#45;&gt;ring_attn_3_8_stage_7 -->
<g id="edge2056" class="edge">
<title>ring_attn_3_7_stage_7&#45;&gt;ring_attn_3_8_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-3031C4543.02,-3031 4701.86,-3031 4701.86,-3031"/>
<polygon fill="red" stroke="red" points="4701.86,-3034.5 4711.86,-3031 4701.86,-3027.5 4701.86,-3034.5"/>
</g>
<!-- ring_attn_3_7_stage_8&#45;&gt;ring_attn_3_7_stage_9 -->
<g id="edge763" class="edge">
<title>ring_attn_3_7_stage_8&#45;&gt;ring_attn_3_7_stage_9</title>
<path fill="none" stroke="black" d="M4334,-2709.87C4334,-2709.87 4334,-2603.25 4334,-2603.25"/>
<polygon fill="black" stroke="black" points="4337.5,-2603.25 4334,-2593.25 4330.5,-2603.25 4337.5,-2603.25"/>
</g>
<!-- ring_attn_3_8_stage_8 -->
<g id="node868" class="node">
<title>ring_attn_3_8_stage_8</title>
<polygon fill="yellow" stroke="black" points="4921,-2846 4712,-2778 4921,-2710 5130,-2778 4921,-2846"/>
<text text-anchor="middle" x="4921" y="-2796.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-2781.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="4921" y="-2766.8" font-family="Times,serif" font-size="14.00">Q[8]×K[0]×V[0]</text>
<text text-anchor="middle" x="4921" y="-2751.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_7_stage_8&#45;&gt;ring_attn_3_8_stage_8 -->
<g id="edge2057" class="edge">
<title>ring_attn_3_7_stage_8&#45;&gt;ring_attn_3_8_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-2778C4543.02,-2778 4701.86,-2778 4701.86,-2778"/>
<polygon fill="red" stroke="red" points="4701.86,-2781.5 4711.86,-2778 4701.86,-2774.5 4701.86,-2781.5"/>
</g>
<!-- ring_attn_3_7_stage_9&#45;&gt;ring_attn_3_7_stage_10 -->
<g id="edge764" class="edge">
<title>ring_attn_3_7_stage_9&#45;&gt;ring_attn_3_7_stage_10</title>
<path fill="none" stroke="black" d="M4334,-2456.87C4334,-2456.87 4334,-2350.25 4334,-2350.25"/>
<polygon fill="black" stroke="black" points="4337.5,-2350.25 4334,-2340.25 4330.5,-2350.25 4337.5,-2350.25"/>
</g>
<!-- ring_attn_3_8_stage_9 -->
<g id="node869" class="node">
<title>ring_attn_3_8_stage_9</title>
<polygon fill="yellow" stroke="black" points="4921,-2593 4712,-2525 4921,-2457 5130,-2525 4921,-2593"/>
<text text-anchor="middle" x="4921" y="-2543.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-2528.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="4921" y="-2513.8" font-family="Times,serif" font-size="14.00">Q[8]×K[15]×V[15]</text>
<text text-anchor="middle" x="4921" y="-2498.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_7_stage_9&#45;&gt;ring_attn_3_8_stage_9 -->
<g id="edge2058" class="edge">
<title>ring_attn_3_7_stage_9&#45;&gt;ring_attn_3_8_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-2525C4543.02,-2525 4701.86,-2525 4701.86,-2525"/>
<polygon fill="red" stroke="red" points="4701.86,-2528.5 4711.86,-2525 4701.86,-2521.5 4701.86,-2528.5"/>
</g>
<!-- ring_attn_3_7_stage_10&#45;&gt;ring_attn_3_7_stage_11 -->
<g id="edge765" class="edge">
<title>ring_attn_3_7_stage_10&#45;&gt;ring_attn_3_7_stage_11</title>
<path fill="none" stroke="black" d="M4334,-2203.87C4334,-2203.87 4334,-2097.25 4334,-2097.25"/>
<polygon fill="black" stroke="black" points="4337.5,-2097.25 4334,-2087.25 4330.5,-2097.25 4337.5,-2097.25"/>
</g>
<!-- ring_attn_3_8_stage_10 -->
<g id="node870" class="node">
<title>ring_attn_3_8_stage_10</title>
<polygon fill="yellow" stroke="black" points="4921,-2340 4712,-2272 4921,-2204 5130,-2272 4921,-2340"/>
<text text-anchor="middle" x="4921" y="-2290.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-2275.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="4921" y="-2260.8" font-family="Times,serif" font-size="14.00">Q[8]×K[14]×V[14]</text>
<text text-anchor="middle" x="4921" y="-2245.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_7_stage_10&#45;&gt;ring_attn_3_8_stage_10 -->
<g id="edge2059" class="edge">
<title>ring_attn_3_7_stage_10&#45;&gt;ring_attn_3_8_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-2272C4543.02,-2272 4701.86,-2272 4701.86,-2272"/>
<polygon fill="red" stroke="red" points="4701.86,-2275.5 4711.86,-2272 4701.86,-2268.5 4701.86,-2275.5"/>
</g>
<!-- ring_attn_3_7_stage_11&#45;&gt;ring_attn_3_7_stage_12 -->
<g id="edge766" class="edge">
<title>ring_attn_3_7_stage_11&#45;&gt;ring_attn_3_7_stage_12</title>
<path fill="none" stroke="black" d="M4334,-1950.87C4334,-1950.87 4334,-1844.25 4334,-1844.25"/>
<polygon fill="black" stroke="black" points="4337.5,-1844.25 4334,-1834.25 4330.5,-1844.25 4337.5,-1844.25"/>
</g>
<!-- ring_attn_3_8_stage_11 -->
<g id="node871" class="node">
<title>ring_attn_3_8_stage_11</title>
<polygon fill="yellow" stroke="black" points="4921,-2087 4712,-2019 4921,-1951 5130,-2019 4921,-2087"/>
<text text-anchor="middle" x="4921" y="-2037.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-2022.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="4921" y="-2007.8" font-family="Times,serif" font-size="14.00">Q[8]×K[13]×V[13]</text>
<text text-anchor="middle" x="4921" y="-1992.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_7_stage_11&#45;&gt;ring_attn_3_8_stage_11 -->
<g id="edge2060" class="edge">
<title>ring_attn_3_7_stage_11&#45;&gt;ring_attn_3_8_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-2019C4543.02,-2019 4701.86,-2019 4701.86,-2019"/>
<polygon fill="red" stroke="red" points="4701.86,-2022.5 4711.86,-2019 4701.86,-2015.5 4701.86,-2022.5"/>
</g>
<!-- ring_attn_3_7_stage_12&#45;&gt;ring_attn_3_7_stage_13 -->
<g id="edge767" class="edge">
<title>ring_attn_3_7_stage_12&#45;&gt;ring_attn_3_7_stage_13</title>
<path fill="none" stroke="black" d="M4334,-1697.87C4334,-1697.87 4334,-1591.25 4334,-1591.25"/>
<polygon fill="black" stroke="black" points="4337.5,-1591.25 4334,-1581.25 4330.5,-1591.25 4337.5,-1591.25"/>
</g>
<!-- ring_attn_3_8_stage_12 -->
<g id="node872" class="node">
<title>ring_attn_3_8_stage_12</title>
<polygon fill="yellow" stroke="black" points="4921,-1834 4712,-1766 4921,-1698 5130,-1766 4921,-1834"/>
<text text-anchor="middle" x="4921" y="-1784.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-1769.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="4921" y="-1754.8" font-family="Times,serif" font-size="14.00">Q[8]×K[12]×V[12]</text>
<text text-anchor="middle" x="4921" y="-1739.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_7_stage_12&#45;&gt;ring_attn_3_8_stage_12 -->
<g id="edge2061" class="edge">
<title>ring_attn_3_7_stage_12&#45;&gt;ring_attn_3_8_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-1766C4543.02,-1766 4701.86,-1766 4701.86,-1766"/>
<polygon fill="red" stroke="red" points="4701.86,-1769.5 4711.86,-1766 4701.86,-1762.5 4701.86,-1769.5"/>
</g>
<!-- ring_attn_3_7_stage_13&#45;&gt;ring_attn_3_7_stage_14 -->
<g id="edge768" class="edge">
<title>ring_attn_3_7_stage_13&#45;&gt;ring_attn_3_7_stage_14</title>
<path fill="none" stroke="black" d="M4334,-1444.87C4334,-1444.87 4334,-1338.25 4334,-1338.25"/>
<polygon fill="black" stroke="black" points="4337.5,-1338.25 4334,-1328.25 4330.5,-1338.25 4337.5,-1338.25"/>
</g>
<!-- ring_attn_3_8_stage_13 -->
<g id="node873" class="node">
<title>ring_attn_3_8_stage_13</title>
<polygon fill="yellow" stroke="black" points="4921,-1581 4712,-1513 4921,-1445 5130,-1513 4921,-1581"/>
<text text-anchor="middle" x="4921" y="-1531.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-1516.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="4921" y="-1501.8" font-family="Times,serif" font-size="14.00">Q[8]×K[11]×V[11]</text>
<text text-anchor="middle" x="4921" y="-1486.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_7_stage_13&#45;&gt;ring_attn_3_8_stage_13 -->
<g id="edge2062" class="edge">
<title>ring_attn_3_7_stage_13&#45;&gt;ring_attn_3_8_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-1513C4543.02,-1513 4701.86,-1513 4701.86,-1513"/>
<polygon fill="red" stroke="red" points="4701.86,-1516.5 4711.86,-1513 4701.86,-1509.5 4701.86,-1516.5"/>
</g>
<!-- ring_attn_3_7_stage_14&#45;&gt;ring_attn_3_7_stage_15 -->
<g id="edge769" class="edge">
<title>ring_attn_3_7_stage_14&#45;&gt;ring_attn_3_7_stage_15</title>
<path fill="none" stroke="black" d="M4334,-1191.87C4334,-1191.87 4334,-1085.25 4334,-1085.25"/>
<polygon fill="black" stroke="black" points="4337.5,-1085.25 4334,-1075.25 4330.5,-1085.25 4337.5,-1085.25"/>
</g>
<!-- ring_attn_3_8_stage_14 -->
<g id="node874" class="node">
<title>ring_attn_3_8_stage_14</title>
<polygon fill="yellow" stroke="black" points="4921,-1328 4712,-1260 4921,-1192 5130,-1260 4921,-1328"/>
<text text-anchor="middle" x="4921" y="-1278.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-1263.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="4921" y="-1248.8" font-family="Times,serif" font-size="14.00">Q[8]×K[10]×V[10]</text>
<text text-anchor="middle" x="4921" y="-1233.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_7_stage_14&#45;&gt;ring_attn_3_8_stage_14 -->
<g id="edge2063" class="edge">
<title>ring_attn_3_7_stage_14&#45;&gt;ring_attn_3_8_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-1260C4543.02,-1260 4701.86,-1260 4701.86,-1260"/>
<polygon fill="red" stroke="red" points="4701.86,-1263.5 4711.86,-1260 4701.86,-1256.5 4701.86,-1263.5"/>
</g>
<!-- attn_out_3_7 -->
<g id="node778" class="node">
<title>attn_out_3_7</title>
<polygon fill="none" stroke="black" points="4403.5,-866 4264.5,-866 4264.5,-813 4403.5,-813 4403.5,-866"/>
<text text-anchor="middle" x="4334" y="-850.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="4334" y="-835.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="4334" y="-820.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_3_7_stage_15&#45;&gt;attn_out_3_7 -->
<g id="edge770" class="edge">
<title>ring_attn_3_7_stage_15&#45;&gt;attn_out_3_7</title>
<path fill="none" stroke="black" d="M4334,-938.87C4334,-938.87 4334,-876.18 4334,-876.18"/>
<polygon fill="black" stroke="black" points="4337.5,-876.18 4334,-866.18 4330.5,-876.18 4337.5,-876.18"/>
</g>
<!-- ring_attn_3_8_stage_15 -->
<g id="node875" class="node">
<title>ring_attn_3_8_stage_15</title>
<polygon fill="yellow" stroke="black" points="4921,-1075 4712,-1007 4921,-939 5130,-1007 4921,-1075"/>
<text text-anchor="middle" x="4921" y="-1025.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="4921" y="-1010.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="4921" y="-995.8" font-family="Times,serif" font-size="14.00">Q[8]×K[9]×V[9]</text>
<text text-anchor="middle" x="4921" y="-980.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_7_stage_15&#45;&gt;ring_attn_3_8_stage_15 -->
<g id="edge2064" class="edge">
<title>ring_attn_3_7_stage_15&#45;&gt;ring_attn_3_8_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4543.02,-1007C4543.02,-1007 4701.86,-1007 4701.86,-1007"/>
<polygon fill="red" stroke="red" points="4701.86,-1010.5 4711.86,-1007 4701.86,-1003.5 4701.86,-1010.5"/>
</g>
<!-- attn_residual_3_7 -->
<g id="node779" class="node">
<title>attn_residual_3_7</title>
<ellipse fill="none" stroke="black" cx="4334" cy="-713" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4334" y="-716.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4334" y="-701.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_3_7&#45;&gt;attn_residual_3_7 -->
<g id="edge771" class="edge">
<title>attn_out_3_7&#45;&gt;attn_residual_3_7</title>
<path fill="none" stroke="black" d="M4334,-812.98C4334,-812.98 4334,-750.36 4334,-750.36"/>
<polygon fill="black" stroke="black" points="4337.5,-750.36 4334,-740.36 4330.5,-750.36 4337.5,-750.36"/>
</g>
<!-- ffn_up_3_7 -->
<g id="node780" class="node">
<title>ffn_up_3_7</title>
<polygon fill="none" stroke="black" points="4413,-613 4255,-613 4255,-560 4413,-560 4413,-613"/>
<text text-anchor="middle" x="4334" y="-597.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4334" y="-582.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="4334" y="-567.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_3_7&#45;&gt;ffn_up_3_7 -->
<g id="edge772" class="edge">
<title>attn_residual_3_7&#45;&gt;ffn_up_3_7</title>
<path fill="none" stroke="black" d="M4334,-685.86C4334,-685.86 4334,-623.16 4334,-623.16"/>
<polygon fill="black" stroke="black" points="4337.5,-623.16 4334,-613.16 4330.5,-623.16 4337.5,-623.16"/>
</g>
<!-- ffn_gelu_3_7 -->
<g id="node781" class="node">
<title>ffn_gelu_3_7</title>
<ellipse fill="none" stroke="black" cx="4334" cy="-460" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4334" y="-463.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4334" y="-448.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_3_7&#45;&gt;ffn_gelu_3_7 -->
<g id="edge773" class="edge">
<title>ffn_up_3_7&#45;&gt;ffn_gelu_3_7</title>
<path fill="none" stroke="black" d="M4334,-559.98C4334,-559.98 4334,-497.36 4334,-497.36"/>
<polygon fill="black" stroke="black" points="4337.5,-497.36 4334,-487.36 4330.5,-497.36 4337.5,-497.36"/>
</g>
<!-- ffn_down_3_7 -->
<g id="node782" class="node">
<title>ffn_down_3_7</title>
<polygon fill="none" stroke="black" points="4423,-360 4245,-360 4245,-307 4423,-307 4423,-360"/>
<text text-anchor="middle" x="4334" y="-344.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4334" y="-329.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="4334" y="-314.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_3_7&#45;&gt;ffn_down_3_7 -->
<g id="edge774" class="edge">
<title>ffn_gelu_3_7&#45;&gt;ffn_down_3_7</title>
<path fill="none" stroke="black" d="M4334,-432.86C4334,-432.86 4334,-370.16 4334,-370.16"/>
<polygon fill="black" stroke="black" points="4337.5,-370.16 4334,-360.16 4330.5,-370.16 4337.5,-370.16"/>
</g>
<!-- ffn_residual_3_7 -->
<g id="node783" class="node">
<title>ffn_residual_3_7</title>
<ellipse fill="none" stroke="black" cx="4334" cy="-207" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4334" y="-210.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4334" y="-195.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_3_7&#45;&gt;ffn_residual_3_7 -->
<g id="edge775" class="edge">
<title>ffn_down_3_7&#45;&gt;ffn_residual_3_7</title>
<path fill="none" stroke="black" d="M4334,-306.98C4334,-306.98 4334,-244.36 4334,-244.36"/>
<polygon fill="black" stroke="black" points="4337.5,-244.36 4334,-234.36 4330.5,-244.36 4337.5,-244.36"/>
</g>
<!-- output_7 -->
<g id="node784" class="node">
<title>output_7</title>
<polygon fill="lightcoral" stroke="black" points="4427,-107 4241,-107 4241,-69 4427,-69 4427,-107"/>
<text text-anchor="middle" x="4334" y="-91.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="4334" y="-76.8" font-family="Times,serif" font-size="14.00">Y[7]: 1024×1024×4096</text>
</g>
<!-- ffn_residual_3_7&#45;&gt;output_7 -->
<g id="edge776" class="edge">
<title>ffn_residual_3_7&#45;&gt;output_7</title>
<path fill="none" stroke="black" d="M4334,-180C4334,-180 4334,-117.12 4334,-117.12"/>
<polygon fill="black" stroke="black" points="4337.5,-117.12 4334,-107.12 4330.5,-117.12 4337.5,-117.12"/>
</g>
<!-- input_8 -->
<g id="node785" class="node">
<title>input_8</title>
<polygon fill="lightgreen" stroke="black" points="5014.5,-20458 4827.5,-20458 4827.5,-20420 5014.5,-20420 5014.5,-20458"/>
<text text-anchor="middle" x="4921" y="-20442.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="4921" y="-20427.8" font-family="Times,serif" font-size="14.00">X[8]: 1024×1024×4096</text>
</g>
<!-- qkv_proj_0_8 -->
<g id="node786" class="node">
<title>qkv_proj_0_8</title>
<polygon fill="none" stroke="black" points="5003.5,-20347 4838.5,-20347 4838.5,-20294 5003.5,-20294 5003.5,-20347"/>
<text text-anchor="middle" x="4921" y="-20331.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4921" y="-20316.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="4921" y="-20301.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- input_8&#45;&gt;qkv_proj_0_8 -->
<g id="edge777" class="edge">
<title>input_8&#45;&gt;qkv_proj_0_8</title>
<path fill="none" stroke="black" d="M4921,-20419.96C4921,-20419.96 4921,-20357.44 4921,-20357.44"/>
<polygon fill="black" stroke="black" points="4924.5,-20357.44 4921,-20347.44 4917.5,-20357.44 4924.5,-20357.44"/>
</g>
<!-- qkv_reshape_0_8 -->
<g id="node787" class="node">
<title>qkv_reshape_0_8</title>
<ellipse fill="none" stroke="black" cx="4921" cy="-20194" rx="148" ry="27"/>
<text text-anchor="middle" x="4921" y="-20197.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="4921" y="-20182.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_0_8&#45;&gt;qkv_reshape_0_8 -->
<g id="edge778" class="edge">
<title>qkv_proj_0_8&#45;&gt;qkv_reshape_0_8</title>
<path fill="none" stroke="black" d="M4921,-20293.98C4921,-20293.98 4921,-20231.36 4921,-20231.36"/>
<polygon fill="black" stroke="black" points="4924.5,-20231.36 4921,-20221.36 4917.5,-20231.36 4924.5,-20231.36"/>
</g>
<!-- qkv_reshape_0_8&#45;&gt;ring_attn_0_8_stage_0 -->
<g id="edge779" class="edge">
<title>qkv_reshape_0_8&#45;&gt;ring_attn_0_8_stage_0</title>
<path fill="none" stroke="black" d="M4921,-20166.72C4921,-20166.72 4921,-20060.16 4921,-20060.16"/>
<polygon fill="black" stroke="black" points="4924.5,-20060.16 4921,-20050.16 4917.5,-20060.16 4924.5,-20060.16"/>
</g>
<!-- ring_attn_0_8_stage_0&#45;&gt;ring_attn_0_8_stage_1 -->
<g id="edge780" class="edge">
<title>ring_attn_0_8_stage_0&#45;&gt;ring_attn_0_8_stage_1</title>
<path fill="none" stroke="black" d="M4921,-19913.87C4921,-19913.87 4921,-19807.25 4921,-19807.25"/>
<polygon fill="black" stroke="black" points="4924.5,-19807.25 4921,-19797.25 4917.5,-19807.25 4924.5,-19807.25"/>
</g>
<!-- ring_attn_0_9_stage_0 -->
<g id="node886" class="node">
<title>ring_attn_0_9_stage_0</title>
<polygon fill="yellow" stroke="black" points="5508,-20050 5299,-19982 5508,-19914 5717,-19982 5508,-20050"/>
<text text-anchor="middle" x="5508" y="-20000.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-19985.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="5508" y="-19970.8" font-family="Times,serif" font-size="14.00">Q[9]×K[9]×V[9]</text>
<text text-anchor="middle" x="5508" y="-19955.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_8_stage_0&#45;&gt;ring_attn_0_9_stage_0 -->
<g id="edge2065" class="edge">
<title>ring_attn_0_8_stage_0&#45;&gt;ring_attn_0_9_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-19982C5130.02,-19982 5288.86,-19982 5288.86,-19982"/>
<polygon fill="red" stroke="red" points="5288.86,-19985.5 5298.86,-19982 5288.86,-19978.5 5288.86,-19985.5"/>
</g>
<!-- ring_attn_0_8_stage_1&#45;&gt;ring_attn_0_8_stage_2 -->
<g id="edge781" class="edge">
<title>ring_attn_0_8_stage_1&#45;&gt;ring_attn_0_8_stage_2</title>
<path fill="none" stroke="black" d="M4921,-19660.87C4921,-19660.87 4921,-19554.25 4921,-19554.25"/>
<polygon fill="black" stroke="black" points="4924.5,-19554.25 4921,-19544.25 4917.5,-19554.25 4924.5,-19554.25"/>
</g>
<!-- ring_attn_0_9_stage_1 -->
<g id="node887" class="node">
<title>ring_attn_0_9_stage_1</title>
<polygon fill="yellow" stroke="black" points="5508,-19797 5299,-19729 5508,-19661 5717,-19729 5508,-19797"/>
<text text-anchor="middle" x="5508" y="-19747.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-19732.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="5508" y="-19717.8" font-family="Times,serif" font-size="14.00">Q[9]×K[8]×V[8]</text>
<text text-anchor="middle" x="5508" y="-19702.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_8_stage_1&#45;&gt;ring_attn_0_9_stage_1 -->
<g id="edge2066" class="edge">
<title>ring_attn_0_8_stage_1&#45;&gt;ring_attn_0_9_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-19729C5130.02,-19729 5288.86,-19729 5288.86,-19729"/>
<polygon fill="red" stroke="red" points="5288.86,-19732.5 5298.86,-19729 5288.86,-19725.5 5288.86,-19732.5"/>
</g>
<!-- ring_attn_0_8_stage_2&#45;&gt;ring_attn_0_8_stage_3 -->
<g id="edge782" class="edge">
<title>ring_attn_0_8_stage_2&#45;&gt;ring_attn_0_8_stage_3</title>
<path fill="none" stroke="black" d="M4921,-19407.87C4921,-19407.87 4921,-19301.25 4921,-19301.25"/>
<polygon fill="black" stroke="black" points="4924.5,-19301.25 4921,-19291.25 4917.5,-19301.25 4924.5,-19301.25"/>
</g>
<!-- ring_attn_0_9_stage_2 -->
<g id="node888" class="node">
<title>ring_attn_0_9_stage_2</title>
<polygon fill="yellow" stroke="black" points="5508,-19544 5299,-19476 5508,-19408 5717,-19476 5508,-19544"/>
<text text-anchor="middle" x="5508" y="-19494.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-19479.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="5508" y="-19464.8" font-family="Times,serif" font-size="14.00">Q[9]×K[7]×V[7]</text>
<text text-anchor="middle" x="5508" y="-19449.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_8_stage_2&#45;&gt;ring_attn_0_9_stage_2 -->
<g id="edge2067" class="edge">
<title>ring_attn_0_8_stage_2&#45;&gt;ring_attn_0_9_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-19476C5130.02,-19476 5288.86,-19476 5288.86,-19476"/>
<polygon fill="red" stroke="red" points="5288.86,-19479.5 5298.86,-19476 5288.86,-19472.5 5288.86,-19479.5"/>
</g>
<!-- ring_attn_0_8_stage_3&#45;&gt;ring_attn_0_8_stage_4 -->
<g id="edge783" class="edge">
<title>ring_attn_0_8_stage_3&#45;&gt;ring_attn_0_8_stage_4</title>
<path fill="none" stroke="black" d="M4921,-19154.87C4921,-19154.87 4921,-19048.25 4921,-19048.25"/>
<polygon fill="black" stroke="black" points="4924.5,-19048.25 4921,-19038.25 4917.5,-19048.25 4924.5,-19048.25"/>
</g>
<!-- ring_attn_0_9_stage_3 -->
<g id="node889" class="node">
<title>ring_attn_0_9_stage_3</title>
<polygon fill="yellow" stroke="black" points="5508,-19291 5299,-19223 5508,-19155 5717,-19223 5508,-19291"/>
<text text-anchor="middle" x="5508" y="-19241.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-19226.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="5508" y="-19211.8" font-family="Times,serif" font-size="14.00">Q[9]×K[6]×V[6]</text>
<text text-anchor="middle" x="5508" y="-19196.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_8_stage_3&#45;&gt;ring_attn_0_9_stage_3 -->
<g id="edge2068" class="edge">
<title>ring_attn_0_8_stage_3&#45;&gt;ring_attn_0_9_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-19223C5130.02,-19223 5288.86,-19223 5288.86,-19223"/>
<polygon fill="red" stroke="red" points="5288.86,-19226.5 5298.86,-19223 5288.86,-19219.5 5288.86,-19226.5"/>
</g>
<!-- ring_attn_0_8_stage_4&#45;&gt;ring_attn_0_8_stage_5 -->
<g id="edge784" class="edge">
<title>ring_attn_0_8_stage_4&#45;&gt;ring_attn_0_8_stage_5</title>
<path fill="none" stroke="black" d="M4921,-18901.87C4921,-18901.87 4921,-18795.25 4921,-18795.25"/>
<polygon fill="black" stroke="black" points="4924.5,-18795.25 4921,-18785.25 4917.5,-18795.25 4924.5,-18795.25"/>
</g>
<!-- ring_attn_0_9_stage_4 -->
<g id="node890" class="node">
<title>ring_attn_0_9_stage_4</title>
<polygon fill="yellow" stroke="black" points="5508,-19038 5299,-18970 5508,-18902 5717,-18970 5508,-19038"/>
<text text-anchor="middle" x="5508" y="-18988.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-18973.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="5508" y="-18958.8" font-family="Times,serif" font-size="14.00">Q[9]×K[5]×V[5]</text>
<text text-anchor="middle" x="5508" y="-18943.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_8_stage_4&#45;&gt;ring_attn_0_9_stage_4 -->
<g id="edge2069" class="edge">
<title>ring_attn_0_8_stage_4&#45;&gt;ring_attn_0_9_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-18970C5130.02,-18970 5288.86,-18970 5288.86,-18970"/>
<polygon fill="red" stroke="red" points="5288.86,-18973.5 5298.86,-18970 5288.86,-18966.5 5288.86,-18973.5"/>
</g>
<!-- ring_attn_0_8_stage_5&#45;&gt;ring_attn_0_8_stage_6 -->
<g id="edge785" class="edge">
<title>ring_attn_0_8_stage_5&#45;&gt;ring_attn_0_8_stage_6</title>
<path fill="none" stroke="black" d="M4921,-18648.87C4921,-18648.87 4921,-18542.25 4921,-18542.25"/>
<polygon fill="black" stroke="black" points="4924.5,-18542.25 4921,-18532.25 4917.5,-18542.25 4924.5,-18542.25"/>
</g>
<!-- ring_attn_0_9_stage_5 -->
<g id="node891" class="node">
<title>ring_attn_0_9_stage_5</title>
<polygon fill="yellow" stroke="black" points="5508,-18785 5299,-18717 5508,-18649 5717,-18717 5508,-18785"/>
<text text-anchor="middle" x="5508" y="-18735.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-18720.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="5508" y="-18705.8" font-family="Times,serif" font-size="14.00">Q[9]×K[4]×V[4]</text>
<text text-anchor="middle" x="5508" y="-18690.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_8_stage_5&#45;&gt;ring_attn_0_9_stage_5 -->
<g id="edge2070" class="edge">
<title>ring_attn_0_8_stage_5&#45;&gt;ring_attn_0_9_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-18717C5130.02,-18717 5288.86,-18717 5288.86,-18717"/>
<polygon fill="red" stroke="red" points="5288.86,-18720.5 5298.86,-18717 5288.86,-18713.5 5288.86,-18720.5"/>
</g>
<!-- ring_attn_0_8_stage_6&#45;&gt;ring_attn_0_8_stage_7 -->
<g id="edge786" class="edge">
<title>ring_attn_0_8_stage_6&#45;&gt;ring_attn_0_8_stage_7</title>
<path fill="none" stroke="black" d="M4921,-18395.87C4921,-18395.87 4921,-18289.25 4921,-18289.25"/>
<polygon fill="black" stroke="black" points="4924.5,-18289.25 4921,-18279.25 4917.5,-18289.25 4924.5,-18289.25"/>
</g>
<!-- ring_attn_0_9_stage_6 -->
<g id="node892" class="node">
<title>ring_attn_0_9_stage_6</title>
<polygon fill="yellow" stroke="black" points="5508,-18532 5299,-18464 5508,-18396 5717,-18464 5508,-18532"/>
<text text-anchor="middle" x="5508" y="-18482.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-18467.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="5508" y="-18452.8" font-family="Times,serif" font-size="14.00">Q[9]×K[3]×V[3]</text>
<text text-anchor="middle" x="5508" y="-18437.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_8_stage_6&#45;&gt;ring_attn_0_9_stage_6 -->
<g id="edge2071" class="edge">
<title>ring_attn_0_8_stage_6&#45;&gt;ring_attn_0_9_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-18464C5130.02,-18464 5288.86,-18464 5288.86,-18464"/>
<polygon fill="red" stroke="red" points="5288.86,-18467.5 5298.86,-18464 5288.86,-18460.5 5288.86,-18467.5"/>
</g>
<!-- ring_attn_0_8_stage_7&#45;&gt;ring_attn_0_8_stage_8 -->
<g id="edge787" class="edge">
<title>ring_attn_0_8_stage_7&#45;&gt;ring_attn_0_8_stage_8</title>
<path fill="none" stroke="black" d="M4921,-18142.87C4921,-18142.87 4921,-18036.25 4921,-18036.25"/>
<polygon fill="black" stroke="black" points="4924.5,-18036.25 4921,-18026.25 4917.5,-18036.25 4924.5,-18036.25"/>
</g>
<!-- ring_attn_0_9_stage_7 -->
<g id="node893" class="node">
<title>ring_attn_0_9_stage_7</title>
<polygon fill="yellow" stroke="black" points="5508,-18279 5299,-18211 5508,-18143 5717,-18211 5508,-18279"/>
<text text-anchor="middle" x="5508" y="-18229.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-18214.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="5508" y="-18199.8" font-family="Times,serif" font-size="14.00">Q[9]×K[2]×V[2]</text>
<text text-anchor="middle" x="5508" y="-18184.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_8_stage_7&#45;&gt;ring_attn_0_9_stage_7 -->
<g id="edge2072" class="edge">
<title>ring_attn_0_8_stage_7&#45;&gt;ring_attn_0_9_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-18211C5130.02,-18211 5288.86,-18211 5288.86,-18211"/>
<polygon fill="red" stroke="red" points="5288.86,-18214.5 5298.86,-18211 5288.86,-18207.5 5288.86,-18214.5"/>
</g>
<!-- ring_attn_0_8_stage_8&#45;&gt;ring_attn_0_8_stage_9 -->
<g id="edge788" class="edge">
<title>ring_attn_0_8_stage_8&#45;&gt;ring_attn_0_8_stage_9</title>
<path fill="none" stroke="black" d="M4921,-17889.87C4921,-17889.87 4921,-17783.25 4921,-17783.25"/>
<polygon fill="black" stroke="black" points="4924.5,-17783.25 4921,-17773.25 4917.5,-17783.25 4924.5,-17783.25"/>
</g>
<!-- ring_attn_0_9_stage_8 -->
<g id="node894" class="node">
<title>ring_attn_0_9_stage_8</title>
<polygon fill="yellow" stroke="black" points="5508,-18026 5299,-17958 5508,-17890 5717,-17958 5508,-18026"/>
<text text-anchor="middle" x="5508" y="-17976.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-17961.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="5508" y="-17946.8" font-family="Times,serif" font-size="14.00">Q[9]×K[1]×V[1]</text>
<text text-anchor="middle" x="5508" y="-17931.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_8_stage_8&#45;&gt;ring_attn_0_9_stage_8 -->
<g id="edge2073" class="edge">
<title>ring_attn_0_8_stage_8&#45;&gt;ring_attn_0_9_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-17958C5130.02,-17958 5288.86,-17958 5288.86,-17958"/>
<polygon fill="red" stroke="red" points="5288.86,-17961.5 5298.86,-17958 5288.86,-17954.5 5288.86,-17961.5"/>
</g>
<!-- ring_attn_0_8_stage_9&#45;&gt;ring_attn_0_8_stage_10 -->
<g id="edge789" class="edge">
<title>ring_attn_0_8_stage_9&#45;&gt;ring_attn_0_8_stage_10</title>
<path fill="none" stroke="black" d="M4921,-17636.87C4921,-17636.87 4921,-17530.25 4921,-17530.25"/>
<polygon fill="black" stroke="black" points="4924.5,-17530.25 4921,-17520.25 4917.5,-17530.25 4924.5,-17530.25"/>
</g>
<!-- ring_attn_0_9_stage_9 -->
<g id="node895" class="node">
<title>ring_attn_0_9_stage_9</title>
<polygon fill="yellow" stroke="black" points="5508,-17773 5299,-17705 5508,-17637 5717,-17705 5508,-17773"/>
<text text-anchor="middle" x="5508" y="-17723.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-17708.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="5508" y="-17693.8" font-family="Times,serif" font-size="14.00">Q[9]×K[0]×V[0]</text>
<text text-anchor="middle" x="5508" y="-17678.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_8_stage_9&#45;&gt;ring_attn_0_9_stage_9 -->
<g id="edge2074" class="edge">
<title>ring_attn_0_8_stage_9&#45;&gt;ring_attn_0_9_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-17705C5130.02,-17705 5288.86,-17705 5288.86,-17705"/>
<polygon fill="red" stroke="red" points="5288.86,-17708.5 5298.86,-17705 5288.86,-17701.5 5288.86,-17708.5"/>
</g>
<!-- ring_attn_0_8_stage_10&#45;&gt;ring_attn_0_8_stage_11 -->
<g id="edge790" class="edge">
<title>ring_attn_0_8_stage_10&#45;&gt;ring_attn_0_8_stage_11</title>
<path fill="none" stroke="black" d="M4921,-17383.87C4921,-17383.87 4921,-17277.25 4921,-17277.25"/>
<polygon fill="black" stroke="black" points="4924.5,-17277.25 4921,-17267.25 4917.5,-17277.25 4924.5,-17277.25"/>
</g>
<!-- ring_attn_0_9_stage_10 -->
<g id="node896" class="node">
<title>ring_attn_0_9_stage_10</title>
<polygon fill="yellow" stroke="black" points="5508,-17520 5299,-17452 5508,-17384 5717,-17452 5508,-17520"/>
<text text-anchor="middle" x="5508" y="-17470.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-17455.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="5508" y="-17440.8" font-family="Times,serif" font-size="14.00">Q[9]×K[15]×V[15]</text>
<text text-anchor="middle" x="5508" y="-17425.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_8_stage_10&#45;&gt;ring_attn_0_9_stage_10 -->
<g id="edge2075" class="edge">
<title>ring_attn_0_8_stage_10&#45;&gt;ring_attn_0_9_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-17452C5130.02,-17452 5288.86,-17452 5288.86,-17452"/>
<polygon fill="red" stroke="red" points="5288.86,-17455.5 5298.86,-17452 5288.86,-17448.5 5288.86,-17455.5"/>
</g>
<!-- ring_attn_0_8_stage_11&#45;&gt;ring_attn_0_8_stage_12 -->
<g id="edge791" class="edge">
<title>ring_attn_0_8_stage_11&#45;&gt;ring_attn_0_8_stage_12</title>
<path fill="none" stroke="black" d="M4921,-17130.87C4921,-17130.87 4921,-17024.25 4921,-17024.25"/>
<polygon fill="black" stroke="black" points="4924.5,-17024.25 4921,-17014.25 4917.5,-17024.25 4924.5,-17024.25"/>
</g>
<!-- ring_attn_0_9_stage_11 -->
<g id="node897" class="node">
<title>ring_attn_0_9_stage_11</title>
<polygon fill="yellow" stroke="black" points="5508,-17267 5299,-17199 5508,-17131 5717,-17199 5508,-17267"/>
<text text-anchor="middle" x="5508" y="-17217.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-17202.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="5508" y="-17187.8" font-family="Times,serif" font-size="14.00">Q[9]×K[14]×V[14]</text>
<text text-anchor="middle" x="5508" y="-17172.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_8_stage_11&#45;&gt;ring_attn_0_9_stage_11 -->
<g id="edge2076" class="edge">
<title>ring_attn_0_8_stage_11&#45;&gt;ring_attn_0_9_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-17199C5130.02,-17199 5288.86,-17199 5288.86,-17199"/>
<polygon fill="red" stroke="red" points="5288.86,-17202.5 5298.86,-17199 5288.86,-17195.5 5288.86,-17202.5"/>
</g>
<!-- ring_attn_0_8_stage_12&#45;&gt;ring_attn_0_8_stage_13 -->
<g id="edge792" class="edge">
<title>ring_attn_0_8_stage_12&#45;&gt;ring_attn_0_8_stage_13</title>
<path fill="none" stroke="black" d="M4921,-16877.87C4921,-16877.87 4921,-16771.25 4921,-16771.25"/>
<polygon fill="black" stroke="black" points="4924.5,-16771.25 4921,-16761.25 4917.5,-16771.25 4924.5,-16771.25"/>
</g>
<!-- ring_attn_0_9_stage_12 -->
<g id="node898" class="node">
<title>ring_attn_0_9_stage_12</title>
<polygon fill="yellow" stroke="black" points="5508,-17014 5299,-16946 5508,-16878 5717,-16946 5508,-17014"/>
<text text-anchor="middle" x="5508" y="-16964.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-16949.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="5508" y="-16934.8" font-family="Times,serif" font-size="14.00">Q[9]×K[13]×V[13]</text>
<text text-anchor="middle" x="5508" y="-16919.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_8_stage_12&#45;&gt;ring_attn_0_9_stage_12 -->
<g id="edge2077" class="edge">
<title>ring_attn_0_8_stage_12&#45;&gt;ring_attn_0_9_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-16946C5130.02,-16946 5288.86,-16946 5288.86,-16946"/>
<polygon fill="red" stroke="red" points="5288.86,-16949.5 5298.86,-16946 5288.86,-16942.5 5288.86,-16949.5"/>
</g>
<!-- ring_attn_0_8_stage_13&#45;&gt;ring_attn_0_8_stage_14 -->
<g id="edge793" class="edge">
<title>ring_attn_0_8_stage_13&#45;&gt;ring_attn_0_8_stage_14</title>
<path fill="none" stroke="black" d="M4921,-16624.87C4921,-16624.87 4921,-16518.25 4921,-16518.25"/>
<polygon fill="black" stroke="black" points="4924.5,-16518.25 4921,-16508.25 4917.5,-16518.25 4924.5,-16518.25"/>
</g>
<!-- ring_attn_0_9_stage_13 -->
<g id="node899" class="node">
<title>ring_attn_0_9_stage_13</title>
<polygon fill="yellow" stroke="black" points="5508,-16761 5299,-16693 5508,-16625 5717,-16693 5508,-16761"/>
<text text-anchor="middle" x="5508" y="-16711.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-16696.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="5508" y="-16681.8" font-family="Times,serif" font-size="14.00">Q[9]×K[12]×V[12]</text>
<text text-anchor="middle" x="5508" y="-16666.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_8_stage_13&#45;&gt;ring_attn_0_9_stage_13 -->
<g id="edge2078" class="edge">
<title>ring_attn_0_8_stage_13&#45;&gt;ring_attn_0_9_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-16693C5130.02,-16693 5288.86,-16693 5288.86,-16693"/>
<polygon fill="red" stroke="red" points="5288.86,-16696.5 5298.86,-16693 5288.86,-16689.5 5288.86,-16696.5"/>
</g>
<!-- ring_attn_0_8_stage_14&#45;&gt;ring_attn_0_8_stage_15 -->
<g id="edge794" class="edge">
<title>ring_attn_0_8_stage_14&#45;&gt;ring_attn_0_8_stage_15</title>
<path fill="none" stroke="black" d="M4921,-16371.87C4921,-16371.87 4921,-16265.25 4921,-16265.25"/>
<polygon fill="black" stroke="black" points="4924.5,-16265.25 4921,-16255.25 4917.5,-16265.25 4924.5,-16265.25"/>
</g>
<!-- ring_attn_0_9_stage_14 -->
<g id="node900" class="node">
<title>ring_attn_0_9_stage_14</title>
<polygon fill="yellow" stroke="black" points="5508,-16508 5299,-16440 5508,-16372 5717,-16440 5508,-16508"/>
<text text-anchor="middle" x="5508" y="-16458.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-16443.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="5508" y="-16428.8" font-family="Times,serif" font-size="14.00">Q[9]×K[11]×V[11]</text>
<text text-anchor="middle" x="5508" y="-16413.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_8_stage_14&#45;&gt;ring_attn_0_9_stage_14 -->
<g id="edge2079" class="edge">
<title>ring_attn_0_8_stage_14&#45;&gt;ring_attn_0_9_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-16440C5130.02,-16440 5288.86,-16440 5288.86,-16440"/>
<polygon fill="red" stroke="red" points="5288.86,-16443.5 5298.86,-16440 5288.86,-16436.5 5288.86,-16443.5"/>
</g>
<!-- attn_out_0_8 -->
<g id="node804" class="node">
<title>attn_out_0_8</title>
<polygon fill="none" stroke="black" points="4990.5,-16046 4851.5,-16046 4851.5,-15993 4990.5,-15993 4990.5,-16046"/>
<text text-anchor="middle" x="4921" y="-16030.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="4921" y="-16015.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="4921" y="-16000.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_0_8_stage_15&#45;&gt;attn_out_0_8 -->
<g id="edge795" class="edge">
<title>ring_attn_0_8_stage_15&#45;&gt;attn_out_0_8</title>
<path fill="none" stroke="black" d="M4921,-16118.87C4921,-16118.87 4921,-16056.18 4921,-16056.18"/>
<polygon fill="black" stroke="black" points="4924.5,-16056.18 4921,-16046.18 4917.5,-16056.18 4924.5,-16056.18"/>
</g>
<!-- ring_attn_0_9_stage_15 -->
<g id="node901" class="node">
<title>ring_attn_0_9_stage_15</title>
<polygon fill="yellow" stroke="black" points="5508,-16255 5299,-16187 5508,-16119 5717,-16187 5508,-16255"/>
<text text-anchor="middle" x="5508" y="-16205.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-16190.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="5508" y="-16175.8" font-family="Times,serif" font-size="14.00">Q[9]×K[10]×V[10]</text>
<text text-anchor="middle" x="5508" y="-16160.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_8_stage_15&#45;&gt;ring_attn_0_9_stage_15 -->
<g id="edge2080" class="edge">
<title>ring_attn_0_8_stage_15&#45;&gt;ring_attn_0_9_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-16187C5130.02,-16187 5288.86,-16187 5288.86,-16187"/>
<polygon fill="red" stroke="red" points="5288.86,-16190.5 5298.86,-16187 5288.86,-16183.5 5288.86,-16190.5"/>
</g>
<!-- attn_residual_0_8 -->
<g id="node805" class="node">
<title>attn_residual_0_8</title>
<ellipse fill="none" stroke="black" cx="4921" cy="-15893" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4921" y="-15896.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4921" y="-15881.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_0_8&#45;&gt;attn_residual_0_8 -->
<g id="edge796" class="edge">
<title>attn_out_0_8&#45;&gt;attn_residual_0_8</title>
<path fill="none" stroke="black" d="M4921,-15992.98C4921,-15992.98 4921,-15930.36 4921,-15930.36"/>
<polygon fill="black" stroke="black" points="4924.5,-15930.36 4921,-15920.36 4917.5,-15930.36 4924.5,-15930.36"/>
</g>
<!-- ffn_up_0_8 -->
<g id="node806" class="node">
<title>ffn_up_0_8</title>
<polygon fill="none" stroke="black" points="5000,-15793 4842,-15793 4842,-15740 5000,-15740 5000,-15793"/>
<text text-anchor="middle" x="4921" y="-15777.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4921" y="-15762.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="4921" y="-15747.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_0_8&#45;&gt;ffn_up_0_8 -->
<g id="edge797" class="edge">
<title>attn_residual_0_8&#45;&gt;ffn_up_0_8</title>
<path fill="none" stroke="black" d="M4921,-15865.86C4921,-15865.86 4921,-15803.16 4921,-15803.16"/>
<polygon fill="black" stroke="black" points="4924.5,-15803.16 4921,-15793.16 4917.5,-15803.16 4924.5,-15803.16"/>
</g>
<!-- ffn_gelu_0_8 -->
<g id="node807" class="node">
<title>ffn_gelu_0_8</title>
<ellipse fill="none" stroke="black" cx="4921" cy="-15640" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4921" y="-15643.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4921" y="-15628.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_0_8&#45;&gt;ffn_gelu_0_8 -->
<g id="edge798" class="edge">
<title>ffn_up_0_8&#45;&gt;ffn_gelu_0_8</title>
<path fill="none" stroke="black" d="M4921,-15739.98C4921,-15739.98 4921,-15677.36 4921,-15677.36"/>
<polygon fill="black" stroke="black" points="4924.5,-15677.36 4921,-15667.36 4917.5,-15677.36 4924.5,-15677.36"/>
</g>
<!-- ffn_down_0_8 -->
<g id="node808" class="node">
<title>ffn_down_0_8</title>
<polygon fill="none" stroke="black" points="5010,-15540 4832,-15540 4832,-15487 5010,-15487 5010,-15540"/>
<text text-anchor="middle" x="4921" y="-15524.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4921" y="-15509.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="4921" y="-15494.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_0_8&#45;&gt;ffn_down_0_8 -->
<g id="edge799" class="edge">
<title>ffn_gelu_0_8&#45;&gt;ffn_down_0_8</title>
<path fill="none" stroke="black" d="M4921,-15612.86C4921,-15612.86 4921,-15550.16 4921,-15550.16"/>
<polygon fill="black" stroke="black" points="4924.5,-15550.16 4921,-15540.16 4917.5,-15550.16 4924.5,-15550.16"/>
</g>
<!-- ffn_residual_0_8 -->
<g id="node809" class="node">
<title>ffn_residual_0_8</title>
<ellipse fill="none" stroke="black" cx="4921" cy="-15387" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4921" y="-15390.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4921" y="-15375.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_0_8&#45;&gt;ffn_residual_0_8 -->
<g id="edge800" class="edge">
<title>ffn_down_0_8&#45;&gt;ffn_residual_0_8</title>
<path fill="none" stroke="black" d="M4921,-15486.98C4921,-15486.98 4921,-15424.36 4921,-15424.36"/>
<polygon fill="black" stroke="black" points="4924.5,-15424.36 4921,-15414.36 4917.5,-15424.36 4924.5,-15424.36"/>
</g>
<!-- qkv_proj_1_8 -->
<g id="node810" class="node">
<title>qkv_proj_1_8</title>
<polygon fill="none" stroke="black" points="5003.5,-15287 4838.5,-15287 4838.5,-15234 5003.5,-15234 5003.5,-15287"/>
<text text-anchor="middle" x="4921" y="-15271.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4921" y="-15256.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="4921" y="-15241.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_0_8&#45;&gt;qkv_proj_1_8 -->
<g id="edge801" class="edge">
<title>ffn_residual_0_8&#45;&gt;qkv_proj_1_8</title>
<path fill="none" stroke="black" d="M4921,-15359.86C4921,-15359.86 4921,-15297.16 4921,-15297.16"/>
<polygon fill="black" stroke="black" points="4924.5,-15297.16 4921,-15287.16 4917.5,-15297.16 4924.5,-15297.16"/>
</g>
<!-- qkv_reshape_1_8 -->
<g id="node811" class="node">
<title>qkv_reshape_1_8</title>
<ellipse fill="none" stroke="black" cx="4921" cy="-15134" rx="148" ry="27"/>
<text text-anchor="middle" x="4921" y="-15137.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="4921" y="-15122.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_1_8&#45;&gt;qkv_reshape_1_8 -->
<g id="edge802" class="edge">
<title>qkv_proj_1_8&#45;&gt;qkv_reshape_1_8</title>
<path fill="none" stroke="black" d="M4921,-15233.98C4921,-15233.98 4921,-15171.36 4921,-15171.36"/>
<polygon fill="black" stroke="black" points="4924.5,-15171.36 4921,-15161.36 4917.5,-15171.36 4924.5,-15171.36"/>
</g>
<!-- qkv_reshape_1_8&#45;&gt;ring_attn_1_8_stage_0 -->
<g id="edge803" class="edge">
<title>qkv_reshape_1_8&#45;&gt;ring_attn_1_8_stage_0</title>
<path fill="none" stroke="black" d="M4921,-15106.72C4921,-15106.72 4921,-15000.16 4921,-15000.16"/>
<polygon fill="black" stroke="black" points="4924.5,-15000.16 4921,-14990.16 4917.5,-15000.16 4924.5,-15000.16"/>
</g>
<!-- ring_attn_1_8_stage_0&#45;&gt;ring_attn_1_8_stage_1 -->
<g id="edge804" class="edge">
<title>ring_attn_1_8_stage_0&#45;&gt;ring_attn_1_8_stage_1</title>
<path fill="none" stroke="black" d="M4921,-14853.87C4921,-14853.87 4921,-14747.25 4921,-14747.25"/>
<polygon fill="black" stroke="black" points="4924.5,-14747.25 4921,-14737.25 4917.5,-14747.25 4924.5,-14747.25"/>
</g>
<!-- ring_attn_1_9_stage_0 -->
<g id="node910" class="node">
<title>ring_attn_1_9_stage_0</title>
<polygon fill="yellow" stroke="black" points="5508,-14990 5299,-14922 5508,-14854 5717,-14922 5508,-14990"/>
<text text-anchor="middle" x="5508" y="-14940.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-14925.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="5508" y="-14910.8" font-family="Times,serif" font-size="14.00">Q[9]×K[9]×V[9]</text>
<text text-anchor="middle" x="5508" y="-14895.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_8_stage_0&#45;&gt;ring_attn_1_9_stage_0 -->
<g id="edge2081" class="edge">
<title>ring_attn_1_8_stage_0&#45;&gt;ring_attn_1_9_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-14922C5130.02,-14922 5288.86,-14922 5288.86,-14922"/>
<polygon fill="red" stroke="red" points="5288.86,-14925.5 5298.86,-14922 5288.86,-14918.5 5288.86,-14925.5"/>
</g>
<!-- ring_attn_1_8_stage_1&#45;&gt;ring_attn_1_8_stage_2 -->
<g id="edge805" class="edge">
<title>ring_attn_1_8_stage_1&#45;&gt;ring_attn_1_8_stage_2</title>
<path fill="none" stroke="black" d="M4921,-14600.87C4921,-14600.87 4921,-14494.25 4921,-14494.25"/>
<polygon fill="black" stroke="black" points="4924.5,-14494.25 4921,-14484.25 4917.5,-14494.25 4924.5,-14494.25"/>
</g>
<!-- ring_attn_1_9_stage_1 -->
<g id="node911" class="node">
<title>ring_attn_1_9_stage_1</title>
<polygon fill="yellow" stroke="black" points="5508,-14737 5299,-14669 5508,-14601 5717,-14669 5508,-14737"/>
<text text-anchor="middle" x="5508" y="-14687.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-14672.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="5508" y="-14657.8" font-family="Times,serif" font-size="14.00">Q[9]×K[8]×V[8]</text>
<text text-anchor="middle" x="5508" y="-14642.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_8_stage_1&#45;&gt;ring_attn_1_9_stage_1 -->
<g id="edge2082" class="edge">
<title>ring_attn_1_8_stage_1&#45;&gt;ring_attn_1_9_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-14669C5130.02,-14669 5288.86,-14669 5288.86,-14669"/>
<polygon fill="red" stroke="red" points="5288.86,-14672.5 5298.86,-14669 5288.86,-14665.5 5288.86,-14672.5"/>
</g>
<!-- ring_attn_1_8_stage_2&#45;&gt;ring_attn_1_8_stage_3 -->
<g id="edge806" class="edge">
<title>ring_attn_1_8_stage_2&#45;&gt;ring_attn_1_8_stage_3</title>
<path fill="none" stroke="black" d="M4921,-14347.87C4921,-14347.87 4921,-14241.25 4921,-14241.25"/>
<polygon fill="black" stroke="black" points="4924.5,-14241.25 4921,-14231.25 4917.5,-14241.25 4924.5,-14241.25"/>
</g>
<!-- ring_attn_1_9_stage_2 -->
<g id="node912" class="node">
<title>ring_attn_1_9_stage_2</title>
<polygon fill="yellow" stroke="black" points="5508,-14484 5299,-14416 5508,-14348 5717,-14416 5508,-14484"/>
<text text-anchor="middle" x="5508" y="-14434.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-14419.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="5508" y="-14404.8" font-family="Times,serif" font-size="14.00">Q[9]×K[7]×V[7]</text>
<text text-anchor="middle" x="5508" y="-14389.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_8_stage_2&#45;&gt;ring_attn_1_9_stage_2 -->
<g id="edge2083" class="edge">
<title>ring_attn_1_8_stage_2&#45;&gt;ring_attn_1_9_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-14416C5130.02,-14416 5288.86,-14416 5288.86,-14416"/>
<polygon fill="red" stroke="red" points="5288.86,-14419.5 5298.86,-14416 5288.86,-14412.5 5288.86,-14419.5"/>
</g>
<!-- ring_attn_1_8_stage_3&#45;&gt;ring_attn_1_8_stage_4 -->
<g id="edge807" class="edge">
<title>ring_attn_1_8_stage_3&#45;&gt;ring_attn_1_8_stage_4</title>
<path fill="none" stroke="black" d="M4921,-14094.87C4921,-14094.87 4921,-13988.25 4921,-13988.25"/>
<polygon fill="black" stroke="black" points="4924.5,-13988.25 4921,-13978.25 4917.5,-13988.25 4924.5,-13988.25"/>
</g>
<!-- ring_attn_1_9_stage_3 -->
<g id="node913" class="node">
<title>ring_attn_1_9_stage_3</title>
<polygon fill="yellow" stroke="black" points="5508,-14231 5299,-14163 5508,-14095 5717,-14163 5508,-14231"/>
<text text-anchor="middle" x="5508" y="-14181.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-14166.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="5508" y="-14151.8" font-family="Times,serif" font-size="14.00">Q[9]×K[6]×V[6]</text>
<text text-anchor="middle" x="5508" y="-14136.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_8_stage_3&#45;&gt;ring_attn_1_9_stage_3 -->
<g id="edge2084" class="edge">
<title>ring_attn_1_8_stage_3&#45;&gt;ring_attn_1_9_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-14163C5130.02,-14163 5288.86,-14163 5288.86,-14163"/>
<polygon fill="red" stroke="red" points="5288.86,-14166.5 5298.86,-14163 5288.86,-14159.5 5288.86,-14166.5"/>
</g>
<!-- ring_attn_1_8_stage_4&#45;&gt;ring_attn_1_8_stage_5 -->
<g id="edge808" class="edge">
<title>ring_attn_1_8_stage_4&#45;&gt;ring_attn_1_8_stage_5</title>
<path fill="none" stroke="black" d="M4921,-13841.87C4921,-13841.87 4921,-13735.25 4921,-13735.25"/>
<polygon fill="black" stroke="black" points="4924.5,-13735.25 4921,-13725.25 4917.5,-13735.25 4924.5,-13735.25"/>
</g>
<!-- ring_attn_1_9_stage_4 -->
<g id="node914" class="node">
<title>ring_attn_1_9_stage_4</title>
<polygon fill="yellow" stroke="black" points="5508,-13978 5299,-13910 5508,-13842 5717,-13910 5508,-13978"/>
<text text-anchor="middle" x="5508" y="-13928.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-13913.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="5508" y="-13898.8" font-family="Times,serif" font-size="14.00">Q[9]×K[5]×V[5]</text>
<text text-anchor="middle" x="5508" y="-13883.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_8_stage_4&#45;&gt;ring_attn_1_9_stage_4 -->
<g id="edge2085" class="edge">
<title>ring_attn_1_8_stage_4&#45;&gt;ring_attn_1_9_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-13910C5130.02,-13910 5288.86,-13910 5288.86,-13910"/>
<polygon fill="red" stroke="red" points="5288.86,-13913.5 5298.86,-13910 5288.86,-13906.5 5288.86,-13913.5"/>
</g>
<!-- ring_attn_1_8_stage_5&#45;&gt;ring_attn_1_8_stage_6 -->
<g id="edge809" class="edge">
<title>ring_attn_1_8_stage_5&#45;&gt;ring_attn_1_8_stage_6</title>
<path fill="none" stroke="black" d="M4921,-13588.87C4921,-13588.87 4921,-13482.25 4921,-13482.25"/>
<polygon fill="black" stroke="black" points="4924.5,-13482.25 4921,-13472.25 4917.5,-13482.25 4924.5,-13482.25"/>
</g>
<!-- ring_attn_1_9_stage_5 -->
<g id="node915" class="node">
<title>ring_attn_1_9_stage_5</title>
<polygon fill="yellow" stroke="black" points="5508,-13725 5299,-13657 5508,-13589 5717,-13657 5508,-13725"/>
<text text-anchor="middle" x="5508" y="-13675.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-13660.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="5508" y="-13645.8" font-family="Times,serif" font-size="14.00">Q[9]×K[4]×V[4]</text>
<text text-anchor="middle" x="5508" y="-13630.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_8_stage_5&#45;&gt;ring_attn_1_9_stage_5 -->
<g id="edge2086" class="edge">
<title>ring_attn_1_8_stage_5&#45;&gt;ring_attn_1_9_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-13657C5130.02,-13657 5288.86,-13657 5288.86,-13657"/>
<polygon fill="red" stroke="red" points="5288.86,-13660.5 5298.86,-13657 5288.86,-13653.5 5288.86,-13660.5"/>
</g>
<!-- ring_attn_1_8_stage_6&#45;&gt;ring_attn_1_8_stage_7 -->
<g id="edge810" class="edge">
<title>ring_attn_1_8_stage_6&#45;&gt;ring_attn_1_8_stage_7</title>
<path fill="none" stroke="black" d="M4921,-13335.87C4921,-13335.87 4921,-13229.25 4921,-13229.25"/>
<polygon fill="black" stroke="black" points="4924.5,-13229.25 4921,-13219.25 4917.5,-13229.25 4924.5,-13229.25"/>
</g>
<!-- ring_attn_1_9_stage_6 -->
<g id="node916" class="node">
<title>ring_attn_1_9_stage_6</title>
<polygon fill="yellow" stroke="black" points="5508,-13472 5299,-13404 5508,-13336 5717,-13404 5508,-13472"/>
<text text-anchor="middle" x="5508" y="-13422.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-13407.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="5508" y="-13392.8" font-family="Times,serif" font-size="14.00">Q[9]×K[3]×V[3]</text>
<text text-anchor="middle" x="5508" y="-13377.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_8_stage_6&#45;&gt;ring_attn_1_9_stage_6 -->
<g id="edge2087" class="edge">
<title>ring_attn_1_8_stage_6&#45;&gt;ring_attn_1_9_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-13404C5130.02,-13404 5288.86,-13404 5288.86,-13404"/>
<polygon fill="red" stroke="red" points="5288.86,-13407.5 5298.86,-13404 5288.86,-13400.5 5288.86,-13407.5"/>
</g>
<!-- ring_attn_1_8_stage_7&#45;&gt;ring_attn_1_8_stage_8 -->
<g id="edge811" class="edge">
<title>ring_attn_1_8_stage_7&#45;&gt;ring_attn_1_8_stage_8</title>
<path fill="none" stroke="black" d="M4921,-13082.87C4921,-13082.87 4921,-12976.25 4921,-12976.25"/>
<polygon fill="black" stroke="black" points="4924.5,-12976.25 4921,-12966.25 4917.5,-12976.25 4924.5,-12976.25"/>
</g>
<!-- ring_attn_1_9_stage_7 -->
<g id="node917" class="node">
<title>ring_attn_1_9_stage_7</title>
<polygon fill="yellow" stroke="black" points="5508,-13219 5299,-13151 5508,-13083 5717,-13151 5508,-13219"/>
<text text-anchor="middle" x="5508" y="-13169.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-13154.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="5508" y="-13139.8" font-family="Times,serif" font-size="14.00">Q[9]×K[2]×V[2]</text>
<text text-anchor="middle" x="5508" y="-13124.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_8_stage_7&#45;&gt;ring_attn_1_9_stage_7 -->
<g id="edge2088" class="edge">
<title>ring_attn_1_8_stage_7&#45;&gt;ring_attn_1_9_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-13151C5130.02,-13151 5288.86,-13151 5288.86,-13151"/>
<polygon fill="red" stroke="red" points="5288.86,-13154.5 5298.86,-13151 5288.86,-13147.5 5288.86,-13154.5"/>
</g>
<!-- ring_attn_1_8_stage_8&#45;&gt;ring_attn_1_8_stage_9 -->
<g id="edge812" class="edge">
<title>ring_attn_1_8_stage_8&#45;&gt;ring_attn_1_8_stage_9</title>
<path fill="none" stroke="black" d="M4921,-12829.87C4921,-12829.87 4921,-12723.25 4921,-12723.25"/>
<polygon fill="black" stroke="black" points="4924.5,-12723.25 4921,-12713.25 4917.5,-12723.25 4924.5,-12723.25"/>
</g>
<!-- ring_attn_1_9_stage_8 -->
<g id="node918" class="node">
<title>ring_attn_1_9_stage_8</title>
<polygon fill="yellow" stroke="black" points="5508,-12966 5299,-12898 5508,-12830 5717,-12898 5508,-12966"/>
<text text-anchor="middle" x="5508" y="-12916.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-12901.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="5508" y="-12886.8" font-family="Times,serif" font-size="14.00">Q[9]×K[1]×V[1]</text>
<text text-anchor="middle" x="5508" y="-12871.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_8_stage_8&#45;&gt;ring_attn_1_9_stage_8 -->
<g id="edge2089" class="edge">
<title>ring_attn_1_8_stage_8&#45;&gt;ring_attn_1_9_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-12898C5130.02,-12898 5288.86,-12898 5288.86,-12898"/>
<polygon fill="red" stroke="red" points="5288.86,-12901.5 5298.86,-12898 5288.86,-12894.5 5288.86,-12901.5"/>
</g>
<!-- ring_attn_1_8_stage_9&#45;&gt;ring_attn_1_8_stage_10 -->
<g id="edge813" class="edge">
<title>ring_attn_1_8_stage_9&#45;&gt;ring_attn_1_8_stage_10</title>
<path fill="none" stroke="black" d="M4921,-12576.87C4921,-12576.87 4921,-12470.25 4921,-12470.25"/>
<polygon fill="black" stroke="black" points="4924.5,-12470.25 4921,-12460.25 4917.5,-12470.25 4924.5,-12470.25"/>
</g>
<!-- ring_attn_1_9_stage_9 -->
<g id="node919" class="node">
<title>ring_attn_1_9_stage_9</title>
<polygon fill="yellow" stroke="black" points="5508,-12713 5299,-12645 5508,-12577 5717,-12645 5508,-12713"/>
<text text-anchor="middle" x="5508" y="-12663.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-12648.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="5508" y="-12633.8" font-family="Times,serif" font-size="14.00">Q[9]×K[0]×V[0]</text>
<text text-anchor="middle" x="5508" y="-12618.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_8_stage_9&#45;&gt;ring_attn_1_9_stage_9 -->
<g id="edge2090" class="edge">
<title>ring_attn_1_8_stage_9&#45;&gt;ring_attn_1_9_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-12645C5130.02,-12645 5288.86,-12645 5288.86,-12645"/>
<polygon fill="red" stroke="red" points="5288.86,-12648.5 5298.86,-12645 5288.86,-12641.5 5288.86,-12648.5"/>
</g>
<!-- ring_attn_1_8_stage_10&#45;&gt;ring_attn_1_8_stage_11 -->
<g id="edge814" class="edge">
<title>ring_attn_1_8_stage_10&#45;&gt;ring_attn_1_8_stage_11</title>
<path fill="none" stroke="black" d="M4921,-12323.87C4921,-12323.87 4921,-12217.25 4921,-12217.25"/>
<polygon fill="black" stroke="black" points="4924.5,-12217.25 4921,-12207.25 4917.5,-12217.25 4924.5,-12217.25"/>
</g>
<!-- ring_attn_1_9_stage_10 -->
<g id="node920" class="node">
<title>ring_attn_1_9_stage_10</title>
<polygon fill="yellow" stroke="black" points="5508,-12460 5299,-12392 5508,-12324 5717,-12392 5508,-12460"/>
<text text-anchor="middle" x="5508" y="-12410.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-12395.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="5508" y="-12380.8" font-family="Times,serif" font-size="14.00">Q[9]×K[15]×V[15]</text>
<text text-anchor="middle" x="5508" y="-12365.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_8_stage_10&#45;&gt;ring_attn_1_9_stage_10 -->
<g id="edge2091" class="edge">
<title>ring_attn_1_8_stage_10&#45;&gt;ring_attn_1_9_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-12392C5130.02,-12392 5288.86,-12392 5288.86,-12392"/>
<polygon fill="red" stroke="red" points="5288.86,-12395.5 5298.86,-12392 5288.86,-12388.5 5288.86,-12395.5"/>
</g>
<!-- ring_attn_1_8_stage_11&#45;&gt;ring_attn_1_8_stage_12 -->
<g id="edge815" class="edge">
<title>ring_attn_1_8_stage_11&#45;&gt;ring_attn_1_8_stage_12</title>
<path fill="none" stroke="black" d="M4921,-12070.87C4921,-12070.87 4921,-11964.25 4921,-11964.25"/>
<polygon fill="black" stroke="black" points="4924.5,-11964.25 4921,-11954.25 4917.5,-11964.25 4924.5,-11964.25"/>
</g>
<!-- ring_attn_1_9_stage_11 -->
<g id="node921" class="node">
<title>ring_attn_1_9_stage_11</title>
<polygon fill="yellow" stroke="black" points="5508,-12207 5299,-12139 5508,-12071 5717,-12139 5508,-12207"/>
<text text-anchor="middle" x="5508" y="-12157.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-12142.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="5508" y="-12127.8" font-family="Times,serif" font-size="14.00">Q[9]×K[14]×V[14]</text>
<text text-anchor="middle" x="5508" y="-12112.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_8_stage_11&#45;&gt;ring_attn_1_9_stage_11 -->
<g id="edge2092" class="edge">
<title>ring_attn_1_8_stage_11&#45;&gt;ring_attn_1_9_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-12139C5130.02,-12139 5288.86,-12139 5288.86,-12139"/>
<polygon fill="red" stroke="red" points="5288.86,-12142.5 5298.86,-12139 5288.86,-12135.5 5288.86,-12142.5"/>
</g>
<!-- ring_attn_1_8_stage_12&#45;&gt;ring_attn_1_8_stage_13 -->
<g id="edge816" class="edge">
<title>ring_attn_1_8_stage_12&#45;&gt;ring_attn_1_8_stage_13</title>
<path fill="none" stroke="black" d="M4921,-11817.87C4921,-11817.87 4921,-11711.25 4921,-11711.25"/>
<polygon fill="black" stroke="black" points="4924.5,-11711.25 4921,-11701.25 4917.5,-11711.25 4924.5,-11711.25"/>
</g>
<!-- ring_attn_1_9_stage_12 -->
<g id="node922" class="node">
<title>ring_attn_1_9_stage_12</title>
<polygon fill="yellow" stroke="black" points="5508,-11954 5299,-11886 5508,-11818 5717,-11886 5508,-11954"/>
<text text-anchor="middle" x="5508" y="-11904.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-11889.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="5508" y="-11874.8" font-family="Times,serif" font-size="14.00">Q[9]×K[13]×V[13]</text>
<text text-anchor="middle" x="5508" y="-11859.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_8_stage_12&#45;&gt;ring_attn_1_9_stage_12 -->
<g id="edge2093" class="edge">
<title>ring_attn_1_8_stage_12&#45;&gt;ring_attn_1_9_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-11886C5130.02,-11886 5288.86,-11886 5288.86,-11886"/>
<polygon fill="red" stroke="red" points="5288.86,-11889.5 5298.86,-11886 5288.86,-11882.5 5288.86,-11889.5"/>
</g>
<!-- ring_attn_1_8_stage_13&#45;&gt;ring_attn_1_8_stage_14 -->
<g id="edge817" class="edge">
<title>ring_attn_1_8_stage_13&#45;&gt;ring_attn_1_8_stage_14</title>
<path fill="none" stroke="black" d="M4921,-11564.87C4921,-11564.87 4921,-11458.25 4921,-11458.25"/>
<polygon fill="black" stroke="black" points="4924.5,-11458.25 4921,-11448.25 4917.5,-11458.25 4924.5,-11458.25"/>
</g>
<!-- ring_attn_1_9_stage_13 -->
<g id="node923" class="node">
<title>ring_attn_1_9_stage_13</title>
<polygon fill="yellow" stroke="black" points="5508,-11701 5299,-11633 5508,-11565 5717,-11633 5508,-11701"/>
<text text-anchor="middle" x="5508" y="-11651.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-11636.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="5508" y="-11621.8" font-family="Times,serif" font-size="14.00">Q[9]×K[12]×V[12]</text>
<text text-anchor="middle" x="5508" y="-11606.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_8_stage_13&#45;&gt;ring_attn_1_9_stage_13 -->
<g id="edge2094" class="edge">
<title>ring_attn_1_8_stage_13&#45;&gt;ring_attn_1_9_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-11633C5130.02,-11633 5288.86,-11633 5288.86,-11633"/>
<polygon fill="red" stroke="red" points="5288.86,-11636.5 5298.86,-11633 5288.86,-11629.5 5288.86,-11636.5"/>
</g>
<!-- ring_attn_1_8_stage_14&#45;&gt;ring_attn_1_8_stage_15 -->
<g id="edge818" class="edge">
<title>ring_attn_1_8_stage_14&#45;&gt;ring_attn_1_8_stage_15</title>
<path fill="none" stroke="black" d="M4921,-11311.87C4921,-11311.87 4921,-11205.25 4921,-11205.25"/>
<polygon fill="black" stroke="black" points="4924.5,-11205.25 4921,-11195.25 4917.5,-11205.25 4924.5,-11205.25"/>
</g>
<!-- ring_attn_1_9_stage_14 -->
<g id="node924" class="node">
<title>ring_attn_1_9_stage_14</title>
<polygon fill="yellow" stroke="black" points="5508,-11448 5299,-11380 5508,-11312 5717,-11380 5508,-11448"/>
<text text-anchor="middle" x="5508" y="-11398.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-11383.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="5508" y="-11368.8" font-family="Times,serif" font-size="14.00">Q[9]×K[11]×V[11]</text>
<text text-anchor="middle" x="5508" y="-11353.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_8_stage_14&#45;&gt;ring_attn_1_9_stage_14 -->
<g id="edge2095" class="edge">
<title>ring_attn_1_8_stage_14&#45;&gt;ring_attn_1_9_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-11380C5130.02,-11380 5288.86,-11380 5288.86,-11380"/>
<polygon fill="red" stroke="red" points="5288.86,-11383.5 5298.86,-11380 5288.86,-11376.5 5288.86,-11383.5"/>
</g>
<!-- attn_out_1_8 -->
<g id="node828" class="node">
<title>attn_out_1_8</title>
<polygon fill="none" stroke="black" points="4990.5,-10986 4851.5,-10986 4851.5,-10933 4990.5,-10933 4990.5,-10986"/>
<text text-anchor="middle" x="4921" y="-10970.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="4921" y="-10955.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="4921" y="-10940.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_1_8_stage_15&#45;&gt;attn_out_1_8 -->
<g id="edge819" class="edge">
<title>ring_attn_1_8_stage_15&#45;&gt;attn_out_1_8</title>
<path fill="none" stroke="black" d="M4921,-11058.87C4921,-11058.87 4921,-10996.18 4921,-10996.18"/>
<polygon fill="black" stroke="black" points="4924.5,-10996.18 4921,-10986.18 4917.5,-10996.18 4924.5,-10996.18"/>
</g>
<!-- ring_attn_1_9_stage_15 -->
<g id="node925" class="node">
<title>ring_attn_1_9_stage_15</title>
<polygon fill="yellow" stroke="black" points="5508,-11195 5299,-11127 5508,-11059 5717,-11127 5508,-11195"/>
<text text-anchor="middle" x="5508" y="-11145.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-11130.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="5508" y="-11115.8" font-family="Times,serif" font-size="14.00">Q[9]×K[10]×V[10]</text>
<text text-anchor="middle" x="5508" y="-11100.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_8_stage_15&#45;&gt;ring_attn_1_9_stage_15 -->
<g id="edge2096" class="edge">
<title>ring_attn_1_8_stage_15&#45;&gt;ring_attn_1_9_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-11127C5130.02,-11127 5288.86,-11127 5288.86,-11127"/>
<polygon fill="red" stroke="red" points="5288.86,-11130.5 5298.86,-11127 5288.86,-11123.5 5288.86,-11130.5"/>
</g>
<!-- attn_residual_1_8 -->
<g id="node829" class="node">
<title>attn_residual_1_8</title>
<ellipse fill="none" stroke="black" cx="4921" cy="-10833" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4921" y="-10836.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4921" y="-10821.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_1_8&#45;&gt;attn_residual_1_8 -->
<g id="edge820" class="edge">
<title>attn_out_1_8&#45;&gt;attn_residual_1_8</title>
<path fill="none" stroke="black" d="M4921,-10932.98C4921,-10932.98 4921,-10870.36 4921,-10870.36"/>
<polygon fill="black" stroke="black" points="4924.5,-10870.36 4921,-10860.36 4917.5,-10870.36 4924.5,-10870.36"/>
</g>
<!-- ffn_up_1_8 -->
<g id="node830" class="node">
<title>ffn_up_1_8</title>
<polygon fill="none" stroke="black" points="5000,-10733 4842,-10733 4842,-10680 5000,-10680 5000,-10733"/>
<text text-anchor="middle" x="4921" y="-10717.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4921" y="-10702.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="4921" y="-10687.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_1_8&#45;&gt;ffn_up_1_8 -->
<g id="edge821" class="edge">
<title>attn_residual_1_8&#45;&gt;ffn_up_1_8</title>
<path fill="none" stroke="black" d="M4921,-10805.86C4921,-10805.86 4921,-10743.16 4921,-10743.16"/>
<polygon fill="black" stroke="black" points="4924.5,-10743.16 4921,-10733.16 4917.5,-10743.16 4924.5,-10743.16"/>
</g>
<!-- ffn_gelu_1_8 -->
<g id="node831" class="node">
<title>ffn_gelu_1_8</title>
<ellipse fill="none" stroke="black" cx="4921" cy="-10580" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4921" y="-10583.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4921" y="-10568.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_1_8&#45;&gt;ffn_gelu_1_8 -->
<g id="edge822" class="edge">
<title>ffn_up_1_8&#45;&gt;ffn_gelu_1_8</title>
<path fill="none" stroke="black" d="M4921,-10679.98C4921,-10679.98 4921,-10617.36 4921,-10617.36"/>
<polygon fill="black" stroke="black" points="4924.5,-10617.36 4921,-10607.36 4917.5,-10617.36 4924.5,-10617.36"/>
</g>
<!-- ffn_down_1_8 -->
<g id="node832" class="node">
<title>ffn_down_1_8</title>
<polygon fill="none" stroke="black" points="5010,-10480 4832,-10480 4832,-10427 5010,-10427 5010,-10480"/>
<text text-anchor="middle" x="4921" y="-10464.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4921" y="-10449.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="4921" y="-10434.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_1_8&#45;&gt;ffn_down_1_8 -->
<g id="edge823" class="edge">
<title>ffn_gelu_1_8&#45;&gt;ffn_down_1_8</title>
<path fill="none" stroke="black" d="M4921,-10552.86C4921,-10552.86 4921,-10490.16 4921,-10490.16"/>
<polygon fill="black" stroke="black" points="4924.5,-10490.16 4921,-10480.16 4917.5,-10490.16 4924.5,-10490.16"/>
</g>
<!-- ffn_residual_1_8 -->
<g id="node833" class="node">
<title>ffn_residual_1_8</title>
<ellipse fill="none" stroke="black" cx="4921" cy="-10327" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4921" y="-10330.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4921" y="-10315.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_1_8&#45;&gt;ffn_residual_1_8 -->
<g id="edge824" class="edge">
<title>ffn_down_1_8&#45;&gt;ffn_residual_1_8</title>
<path fill="none" stroke="black" d="M4921,-10426.98C4921,-10426.98 4921,-10364.36 4921,-10364.36"/>
<polygon fill="black" stroke="black" points="4924.5,-10364.36 4921,-10354.36 4917.5,-10364.36 4924.5,-10364.36"/>
</g>
<!-- qkv_proj_2_8 -->
<g id="node834" class="node">
<title>qkv_proj_2_8</title>
<polygon fill="none" stroke="black" points="5003.5,-10227 4838.5,-10227 4838.5,-10174 5003.5,-10174 5003.5,-10227"/>
<text text-anchor="middle" x="4921" y="-10211.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4921" y="-10196.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="4921" y="-10181.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_1_8&#45;&gt;qkv_proj_2_8 -->
<g id="edge825" class="edge">
<title>ffn_residual_1_8&#45;&gt;qkv_proj_2_8</title>
<path fill="none" stroke="black" d="M4921,-10299.86C4921,-10299.86 4921,-10237.16 4921,-10237.16"/>
<polygon fill="black" stroke="black" points="4924.5,-10237.16 4921,-10227.16 4917.5,-10237.16 4924.5,-10237.16"/>
</g>
<!-- qkv_reshape_2_8 -->
<g id="node835" class="node">
<title>qkv_reshape_2_8</title>
<ellipse fill="none" stroke="black" cx="4921" cy="-10074" rx="148" ry="27"/>
<text text-anchor="middle" x="4921" y="-10077.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="4921" y="-10062.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_2_8&#45;&gt;qkv_reshape_2_8 -->
<g id="edge826" class="edge">
<title>qkv_proj_2_8&#45;&gt;qkv_reshape_2_8</title>
<path fill="none" stroke="black" d="M4921,-10173.98C4921,-10173.98 4921,-10111.36 4921,-10111.36"/>
<polygon fill="black" stroke="black" points="4924.5,-10111.36 4921,-10101.36 4917.5,-10111.36 4924.5,-10111.36"/>
</g>
<!-- qkv_reshape_2_8&#45;&gt;ring_attn_2_8_stage_0 -->
<g id="edge827" class="edge">
<title>qkv_reshape_2_8&#45;&gt;ring_attn_2_8_stage_0</title>
<path fill="none" stroke="black" d="M4921,-10046.72C4921,-10046.72 4921,-9940.16 4921,-9940.16"/>
<polygon fill="black" stroke="black" points="4924.5,-9940.16 4921,-9930.16 4917.5,-9940.16 4924.5,-9940.16"/>
</g>
<!-- ring_attn_2_8_stage_0&#45;&gt;ring_attn_2_8_stage_1 -->
<g id="edge828" class="edge">
<title>ring_attn_2_8_stage_0&#45;&gt;ring_attn_2_8_stage_1</title>
<path fill="none" stroke="black" d="M4921,-9793.87C4921,-9793.87 4921,-9687.25 4921,-9687.25"/>
<polygon fill="black" stroke="black" points="4924.5,-9687.25 4921,-9677.25 4917.5,-9687.25 4924.5,-9687.25"/>
</g>
<!-- ring_attn_2_9_stage_0 -->
<g id="node934" class="node">
<title>ring_attn_2_9_stage_0</title>
<polygon fill="yellow" stroke="black" points="5508,-9930 5299,-9862 5508,-9794 5717,-9862 5508,-9930"/>
<text text-anchor="middle" x="5508" y="-9880.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-9865.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="5508" y="-9850.8" font-family="Times,serif" font-size="14.00">Q[9]×K[9]×V[9]</text>
<text text-anchor="middle" x="5508" y="-9835.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_8_stage_0&#45;&gt;ring_attn_2_9_stage_0 -->
<g id="edge2097" class="edge">
<title>ring_attn_2_8_stage_0&#45;&gt;ring_attn_2_9_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-9862C5130.02,-9862 5288.86,-9862 5288.86,-9862"/>
<polygon fill="red" stroke="red" points="5288.86,-9865.5 5298.86,-9862 5288.86,-9858.5 5288.86,-9865.5"/>
</g>
<!-- ring_attn_2_8_stage_1&#45;&gt;ring_attn_2_8_stage_2 -->
<g id="edge829" class="edge">
<title>ring_attn_2_8_stage_1&#45;&gt;ring_attn_2_8_stage_2</title>
<path fill="none" stroke="black" d="M4921,-9540.87C4921,-9540.87 4921,-9434.25 4921,-9434.25"/>
<polygon fill="black" stroke="black" points="4924.5,-9434.25 4921,-9424.25 4917.5,-9434.25 4924.5,-9434.25"/>
</g>
<!-- ring_attn_2_9_stage_1 -->
<g id="node935" class="node">
<title>ring_attn_2_9_stage_1</title>
<polygon fill="yellow" stroke="black" points="5508,-9677 5299,-9609 5508,-9541 5717,-9609 5508,-9677"/>
<text text-anchor="middle" x="5508" y="-9627.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-9612.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="5508" y="-9597.8" font-family="Times,serif" font-size="14.00">Q[9]×K[8]×V[8]</text>
<text text-anchor="middle" x="5508" y="-9582.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_8_stage_1&#45;&gt;ring_attn_2_9_stage_1 -->
<g id="edge2098" class="edge">
<title>ring_attn_2_8_stage_1&#45;&gt;ring_attn_2_9_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-9609C5130.02,-9609 5288.86,-9609 5288.86,-9609"/>
<polygon fill="red" stroke="red" points="5288.86,-9612.5 5298.86,-9609 5288.86,-9605.5 5288.86,-9612.5"/>
</g>
<!-- ring_attn_2_8_stage_2&#45;&gt;ring_attn_2_8_stage_3 -->
<g id="edge830" class="edge">
<title>ring_attn_2_8_stage_2&#45;&gt;ring_attn_2_8_stage_3</title>
<path fill="none" stroke="black" d="M4921,-9287.87C4921,-9287.87 4921,-9181.25 4921,-9181.25"/>
<polygon fill="black" stroke="black" points="4924.5,-9181.25 4921,-9171.25 4917.5,-9181.25 4924.5,-9181.25"/>
</g>
<!-- ring_attn_2_9_stage_2 -->
<g id="node936" class="node">
<title>ring_attn_2_9_stage_2</title>
<polygon fill="yellow" stroke="black" points="5508,-9424 5299,-9356 5508,-9288 5717,-9356 5508,-9424"/>
<text text-anchor="middle" x="5508" y="-9374.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-9359.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="5508" y="-9344.8" font-family="Times,serif" font-size="14.00">Q[9]×K[7]×V[7]</text>
<text text-anchor="middle" x="5508" y="-9329.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_8_stage_2&#45;&gt;ring_attn_2_9_stage_2 -->
<g id="edge2099" class="edge">
<title>ring_attn_2_8_stage_2&#45;&gt;ring_attn_2_9_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-9356C5130.02,-9356 5288.86,-9356 5288.86,-9356"/>
<polygon fill="red" stroke="red" points="5288.86,-9359.5 5298.86,-9356 5288.86,-9352.5 5288.86,-9359.5"/>
</g>
<!-- ring_attn_2_8_stage_3&#45;&gt;ring_attn_2_8_stage_4 -->
<g id="edge831" class="edge">
<title>ring_attn_2_8_stage_3&#45;&gt;ring_attn_2_8_stage_4</title>
<path fill="none" stroke="black" d="M4921,-9034.87C4921,-9034.87 4921,-8928.25 4921,-8928.25"/>
<polygon fill="black" stroke="black" points="4924.5,-8928.25 4921,-8918.25 4917.5,-8928.25 4924.5,-8928.25"/>
</g>
<!-- ring_attn_2_9_stage_3 -->
<g id="node937" class="node">
<title>ring_attn_2_9_stage_3</title>
<polygon fill="yellow" stroke="black" points="5508,-9171 5299,-9103 5508,-9035 5717,-9103 5508,-9171"/>
<text text-anchor="middle" x="5508" y="-9121.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-9106.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="5508" y="-9091.8" font-family="Times,serif" font-size="14.00">Q[9]×K[6]×V[6]</text>
<text text-anchor="middle" x="5508" y="-9076.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_8_stage_3&#45;&gt;ring_attn_2_9_stage_3 -->
<g id="edge2100" class="edge">
<title>ring_attn_2_8_stage_3&#45;&gt;ring_attn_2_9_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-9103C5130.02,-9103 5288.86,-9103 5288.86,-9103"/>
<polygon fill="red" stroke="red" points="5288.86,-9106.5 5298.86,-9103 5288.86,-9099.5 5288.86,-9106.5"/>
</g>
<!-- ring_attn_2_8_stage_4&#45;&gt;ring_attn_2_8_stage_5 -->
<g id="edge832" class="edge">
<title>ring_attn_2_8_stage_4&#45;&gt;ring_attn_2_8_stage_5</title>
<path fill="none" stroke="black" d="M4921,-8781.87C4921,-8781.87 4921,-8675.25 4921,-8675.25"/>
<polygon fill="black" stroke="black" points="4924.5,-8675.25 4921,-8665.25 4917.5,-8675.25 4924.5,-8675.25"/>
</g>
<!-- ring_attn_2_9_stage_4 -->
<g id="node938" class="node">
<title>ring_attn_2_9_stage_4</title>
<polygon fill="yellow" stroke="black" points="5508,-8918 5299,-8850 5508,-8782 5717,-8850 5508,-8918"/>
<text text-anchor="middle" x="5508" y="-8868.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-8853.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="5508" y="-8838.8" font-family="Times,serif" font-size="14.00">Q[9]×K[5]×V[5]</text>
<text text-anchor="middle" x="5508" y="-8823.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_8_stage_4&#45;&gt;ring_attn_2_9_stage_4 -->
<g id="edge2101" class="edge">
<title>ring_attn_2_8_stage_4&#45;&gt;ring_attn_2_9_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-8850C5130.02,-8850 5288.86,-8850 5288.86,-8850"/>
<polygon fill="red" stroke="red" points="5288.86,-8853.5 5298.86,-8850 5288.86,-8846.5 5288.86,-8853.5"/>
</g>
<!-- ring_attn_2_8_stage_5&#45;&gt;ring_attn_2_8_stage_6 -->
<g id="edge833" class="edge">
<title>ring_attn_2_8_stage_5&#45;&gt;ring_attn_2_8_stage_6</title>
<path fill="none" stroke="black" d="M4921,-8528.87C4921,-8528.87 4921,-8422.25 4921,-8422.25"/>
<polygon fill="black" stroke="black" points="4924.5,-8422.25 4921,-8412.25 4917.5,-8422.25 4924.5,-8422.25"/>
</g>
<!-- ring_attn_2_9_stage_5 -->
<g id="node939" class="node">
<title>ring_attn_2_9_stage_5</title>
<polygon fill="yellow" stroke="black" points="5508,-8665 5299,-8597 5508,-8529 5717,-8597 5508,-8665"/>
<text text-anchor="middle" x="5508" y="-8615.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-8600.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="5508" y="-8585.8" font-family="Times,serif" font-size="14.00">Q[9]×K[4]×V[4]</text>
<text text-anchor="middle" x="5508" y="-8570.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_8_stage_5&#45;&gt;ring_attn_2_9_stage_5 -->
<g id="edge2102" class="edge">
<title>ring_attn_2_8_stage_5&#45;&gt;ring_attn_2_9_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-8597C5130.02,-8597 5288.86,-8597 5288.86,-8597"/>
<polygon fill="red" stroke="red" points="5288.86,-8600.5 5298.86,-8597 5288.86,-8593.5 5288.86,-8600.5"/>
</g>
<!-- ring_attn_2_8_stage_6&#45;&gt;ring_attn_2_8_stage_7 -->
<g id="edge834" class="edge">
<title>ring_attn_2_8_stage_6&#45;&gt;ring_attn_2_8_stage_7</title>
<path fill="none" stroke="black" d="M4921,-8275.87C4921,-8275.87 4921,-8169.25 4921,-8169.25"/>
<polygon fill="black" stroke="black" points="4924.5,-8169.25 4921,-8159.25 4917.5,-8169.25 4924.5,-8169.25"/>
</g>
<!-- ring_attn_2_9_stage_6 -->
<g id="node940" class="node">
<title>ring_attn_2_9_stage_6</title>
<polygon fill="yellow" stroke="black" points="5508,-8412 5299,-8344 5508,-8276 5717,-8344 5508,-8412"/>
<text text-anchor="middle" x="5508" y="-8362.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-8347.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="5508" y="-8332.8" font-family="Times,serif" font-size="14.00">Q[9]×K[3]×V[3]</text>
<text text-anchor="middle" x="5508" y="-8317.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_8_stage_6&#45;&gt;ring_attn_2_9_stage_6 -->
<g id="edge2103" class="edge">
<title>ring_attn_2_8_stage_6&#45;&gt;ring_attn_2_9_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-8344C5130.02,-8344 5288.86,-8344 5288.86,-8344"/>
<polygon fill="red" stroke="red" points="5288.86,-8347.5 5298.86,-8344 5288.86,-8340.5 5288.86,-8347.5"/>
</g>
<!-- ring_attn_2_8_stage_7&#45;&gt;ring_attn_2_8_stage_8 -->
<g id="edge835" class="edge">
<title>ring_attn_2_8_stage_7&#45;&gt;ring_attn_2_8_stage_8</title>
<path fill="none" stroke="black" d="M4921,-8022.87C4921,-8022.87 4921,-7916.25 4921,-7916.25"/>
<polygon fill="black" stroke="black" points="4924.5,-7916.25 4921,-7906.25 4917.5,-7916.25 4924.5,-7916.25"/>
</g>
<!-- ring_attn_2_9_stage_7 -->
<g id="node941" class="node">
<title>ring_attn_2_9_stage_7</title>
<polygon fill="yellow" stroke="black" points="5508,-8159 5299,-8091 5508,-8023 5717,-8091 5508,-8159"/>
<text text-anchor="middle" x="5508" y="-8109.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-8094.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="5508" y="-8079.8" font-family="Times,serif" font-size="14.00">Q[9]×K[2]×V[2]</text>
<text text-anchor="middle" x="5508" y="-8064.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_8_stage_7&#45;&gt;ring_attn_2_9_stage_7 -->
<g id="edge2104" class="edge">
<title>ring_attn_2_8_stage_7&#45;&gt;ring_attn_2_9_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-8091C5130.02,-8091 5288.86,-8091 5288.86,-8091"/>
<polygon fill="red" stroke="red" points="5288.86,-8094.5 5298.86,-8091 5288.86,-8087.5 5288.86,-8094.5"/>
</g>
<!-- ring_attn_2_8_stage_8&#45;&gt;ring_attn_2_8_stage_9 -->
<g id="edge836" class="edge">
<title>ring_attn_2_8_stage_8&#45;&gt;ring_attn_2_8_stage_9</title>
<path fill="none" stroke="black" d="M4921,-7769.87C4921,-7769.87 4921,-7663.25 4921,-7663.25"/>
<polygon fill="black" stroke="black" points="4924.5,-7663.25 4921,-7653.25 4917.5,-7663.25 4924.5,-7663.25"/>
</g>
<!-- ring_attn_2_9_stage_8 -->
<g id="node942" class="node">
<title>ring_attn_2_9_stage_8</title>
<polygon fill="yellow" stroke="black" points="5508,-7906 5299,-7838 5508,-7770 5717,-7838 5508,-7906"/>
<text text-anchor="middle" x="5508" y="-7856.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-7841.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="5508" y="-7826.8" font-family="Times,serif" font-size="14.00">Q[9]×K[1]×V[1]</text>
<text text-anchor="middle" x="5508" y="-7811.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_8_stage_8&#45;&gt;ring_attn_2_9_stage_8 -->
<g id="edge2105" class="edge">
<title>ring_attn_2_8_stage_8&#45;&gt;ring_attn_2_9_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-7838C5130.02,-7838 5288.86,-7838 5288.86,-7838"/>
<polygon fill="red" stroke="red" points="5288.86,-7841.5 5298.86,-7838 5288.86,-7834.5 5288.86,-7841.5"/>
</g>
<!-- ring_attn_2_8_stage_9&#45;&gt;ring_attn_2_8_stage_10 -->
<g id="edge837" class="edge">
<title>ring_attn_2_8_stage_9&#45;&gt;ring_attn_2_8_stage_10</title>
<path fill="none" stroke="black" d="M4921,-7516.87C4921,-7516.87 4921,-7410.25 4921,-7410.25"/>
<polygon fill="black" stroke="black" points="4924.5,-7410.25 4921,-7400.25 4917.5,-7410.25 4924.5,-7410.25"/>
</g>
<!-- ring_attn_2_9_stage_9 -->
<g id="node943" class="node">
<title>ring_attn_2_9_stage_9</title>
<polygon fill="yellow" stroke="black" points="5508,-7653 5299,-7585 5508,-7517 5717,-7585 5508,-7653"/>
<text text-anchor="middle" x="5508" y="-7603.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-7588.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="5508" y="-7573.8" font-family="Times,serif" font-size="14.00">Q[9]×K[0]×V[0]</text>
<text text-anchor="middle" x="5508" y="-7558.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_8_stage_9&#45;&gt;ring_attn_2_9_stage_9 -->
<g id="edge2106" class="edge">
<title>ring_attn_2_8_stage_9&#45;&gt;ring_attn_2_9_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-7585C5130.02,-7585 5288.86,-7585 5288.86,-7585"/>
<polygon fill="red" stroke="red" points="5288.86,-7588.5 5298.86,-7585 5288.86,-7581.5 5288.86,-7588.5"/>
</g>
<!-- ring_attn_2_8_stage_10&#45;&gt;ring_attn_2_8_stage_11 -->
<g id="edge838" class="edge">
<title>ring_attn_2_8_stage_10&#45;&gt;ring_attn_2_8_stage_11</title>
<path fill="none" stroke="black" d="M4921,-7263.87C4921,-7263.87 4921,-7157.25 4921,-7157.25"/>
<polygon fill="black" stroke="black" points="4924.5,-7157.25 4921,-7147.25 4917.5,-7157.25 4924.5,-7157.25"/>
</g>
<!-- ring_attn_2_9_stage_10 -->
<g id="node944" class="node">
<title>ring_attn_2_9_stage_10</title>
<polygon fill="yellow" stroke="black" points="5508,-7400 5299,-7332 5508,-7264 5717,-7332 5508,-7400"/>
<text text-anchor="middle" x="5508" y="-7350.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-7335.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="5508" y="-7320.8" font-family="Times,serif" font-size="14.00">Q[9]×K[15]×V[15]</text>
<text text-anchor="middle" x="5508" y="-7305.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_8_stage_10&#45;&gt;ring_attn_2_9_stage_10 -->
<g id="edge2107" class="edge">
<title>ring_attn_2_8_stage_10&#45;&gt;ring_attn_2_9_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-7332C5130.02,-7332 5288.86,-7332 5288.86,-7332"/>
<polygon fill="red" stroke="red" points="5288.86,-7335.5 5298.86,-7332 5288.86,-7328.5 5288.86,-7335.5"/>
</g>
<!-- ring_attn_2_8_stage_11&#45;&gt;ring_attn_2_8_stage_12 -->
<g id="edge839" class="edge">
<title>ring_attn_2_8_stage_11&#45;&gt;ring_attn_2_8_stage_12</title>
<path fill="none" stroke="black" d="M4921,-7010.87C4921,-7010.87 4921,-6904.25 4921,-6904.25"/>
<polygon fill="black" stroke="black" points="4924.5,-6904.25 4921,-6894.25 4917.5,-6904.25 4924.5,-6904.25"/>
</g>
<!-- ring_attn_2_9_stage_11 -->
<g id="node945" class="node">
<title>ring_attn_2_9_stage_11</title>
<polygon fill="yellow" stroke="black" points="5508,-7147 5299,-7079 5508,-7011 5717,-7079 5508,-7147"/>
<text text-anchor="middle" x="5508" y="-7097.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-7082.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="5508" y="-7067.8" font-family="Times,serif" font-size="14.00">Q[9]×K[14]×V[14]</text>
<text text-anchor="middle" x="5508" y="-7052.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_8_stage_11&#45;&gt;ring_attn_2_9_stage_11 -->
<g id="edge2108" class="edge">
<title>ring_attn_2_8_stage_11&#45;&gt;ring_attn_2_9_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-7079C5130.02,-7079 5288.86,-7079 5288.86,-7079"/>
<polygon fill="red" stroke="red" points="5288.86,-7082.5 5298.86,-7079 5288.86,-7075.5 5288.86,-7082.5"/>
</g>
<!-- ring_attn_2_8_stage_12&#45;&gt;ring_attn_2_8_stage_13 -->
<g id="edge840" class="edge">
<title>ring_attn_2_8_stage_12&#45;&gt;ring_attn_2_8_stage_13</title>
<path fill="none" stroke="black" d="M4921,-6757.87C4921,-6757.87 4921,-6651.25 4921,-6651.25"/>
<polygon fill="black" stroke="black" points="4924.5,-6651.25 4921,-6641.25 4917.5,-6651.25 4924.5,-6651.25"/>
</g>
<!-- ring_attn_2_9_stage_12 -->
<g id="node946" class="node">
<title>ring_attn_2_9_stage_12</title>
<polygon fill="yellow" stroke="black" points="5508,-6894 5299,-6826 5508,-6758 5717,-6826 5508,-6894"/>
<text text-anchor="middle" x="5508" y="-6844.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-6829.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="5508" y="-6814.8" font-family="Times,serif" font-size="14.00">Q[9]×K[13]×V[13]</text>
<text text-anchor="middle" x="5508" y="-6799.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_8_stage_12&#45;&gt;ring_attn_2_9_stage_12 -->
<g id="edge2109" class="edge">
<title>ring_attn_2_8_stage_12&#45;&gt;ring_attn_2_9_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-6826C5130.02,-6826 5288.86,-6826 5288.86,-6826"/>
<polygon fill="red" stroke="red" points="5288.86,-6829.5 5298.86,-6826 5288.86,-6822.5 5288.86,-6829.5"/>
</g>
<!-- ring_attn_2_8_stage_13&#45;&gt;ring_attn_2_8_stage_14 -->
<g id="edge841" class="edge">
<title>ring_attn_2_8_stage_13&#45;&gt;ring_attn_2_8_stage_14</title>
<path fill="none" stroke="black" d="M4921,-6504.87C4921,-6504.87 4921,-6398.25 4921,-6398.25"/>
<polygon fill="black" stroke="black" points="4924.5,-6398.25 4921,-6388.25 4917.5,-6398.25 4924.5,-6398.25"/>
</g>
<!-- ring_attn_2_9_stage_13 -->
<g id="node947" class="node">
<title>ring_attn_2_9_stage_13</title>
<polygon fill="yellow" stroke="black" points="5508,-6641 5299,-6573 5508,-6505 5717,-6573 5508,-6641"/>
<text text-anchor="middle" x="5508" y="-6591.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-6576.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="5508" y="-6561.8" font-family="Times,serif" font-size="14.00">Q[9]×K[12]×V[12]</text>
<text text-anchor="middle" x="5508" y="-6546.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_8_stage_13&#45;&gt;ring_attn_2_9_stage_13 -->
<g id="edge2110" class="edge">
<title>ring_attn_2_8_stage_13&#45;&gt;ring_attn_2_9_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-6573C5130.02,-6573 5288.86,-6573 5288.86,-6573"/>
<polygon fill="red" stroke="red" points="5288.86,-6576.5 5298.86,-6573 5288.86,-6569.5 5288.86,-6576.5"/>
</g>
<!-- ring_attn_2_8_stage_14&#45;&gt;ring_attn_2_8_stage_15 -->
<g id="edge842" class="edge">
<title>ring_attn_2_8_stage_14&#45;&gt;ring_attn_2_8_stage_15</title>
<path fill="none" stroke="black" d="M4921,-6251.87C4921,-6251.87 4921,-6145.25 4921,-6145.25"/>
<polygon fill="black" stroke="black" points="4924.5,-6145.25 4921,-6135.25 4917.5,-6145.25 4924.5,-6145.25"/>
</g>
<!-- ring_attn_2_9_stage_14 -->
<g id="node948" class="node">
<title>ring_attn_2_9_stage_14</title>
<polygon fill="yellow" stroke="black" points="5508,-6388 5299,-6320 5508,-6252 5717,-6320 5508,-6388"/>
<text text-anchor="middle" x="5508" y="-6338.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-6323.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="5508" y="-6308.8" font-family="Times,serif" font-size="14.00">Q[9]×K[11]×V[11]</text>
<text text-anchor="middle" x="5508" y="-6293.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_8_stage_14&#45;&gt;ring_attn_2_9_stage_14 -->
<g id="edge2111" class="edge">
<title>ring_attn_2_8_stage_14&#45;&gt;ring_attn_2_9_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-6320C5130.02,-6320 5288.86,-6320 5288.86,-6320"/>
<polygon fill="red" stroke="red" points="5288.86,-6323.5 5298.86,-6320 5288.86,-6316.5 5288.86,-6323.5"/>
</g>
<!-- attn_out_2_8 -->
<g id="node852" class="node">
<title>attn_out_2_8</title>
<polygon fill="none" stroke="black" points="4990.5,-5926 4851.5,-5926 4851.5,-5873 4990.5,-5873 4990.5,-5926"/>
<text text-anchor="middle" x="4921" y="-5910.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="4921" y="-5895.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="4921" y="-5880.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_2_8_stage_15&#45;&gt;attn_out_2_8 -->
<g id="edge843" class="edge">
<title>ring_attn_2_8_stage_15&#45;&gt;attn_out_2_8</title>
<path fill="none" stroke="black" d="M4921,-5998.87C4921,-5998.87 4921,-5936.18 4921,-5936.18"/>
<polygon fill="black" stroke="black" points="4924.5,-5936.18 4921,-5926.18 4917.5,-5936.18 4924.5,-5936.18"/>
</g>
<!-- ring_attn_2_9_stage_15 -->
<g id="node949" class="node">
<title>ring_attn_2_9_stage_15</title>
<polygon fill="yellow" stroke="black" points="5508,-6135 5299,-6067 5508,-5999 5717,-6067 5508,-6135"/>
<text text-anchor="middle" x="5508" y="-6085.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-6070.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="5508" y="-6055.8" font-family="Times,serif" font-size="14.00">Q[9]×K[10]×V[10]</text>
<text text-anchor="middle" x="5508" y="-6040.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_8_stage_15&#45;&gt;ring_attn_2_9_stage_15 -->
<g id="edge2112" class="edge">
<title>ring_attn_2_8_stage_15&#45;&gt;ring_attn_2_9_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-6067C5130.02,-6067 5288.86,-6067 5288.86,-6067"/>
<polygon fill="red" stroke="red" points="5288.86,-6070.5 5298.86,-6067 5288.86,-6063.5 5288.86,-6070.5"/>
</g>
<!-- attn_residual_2_8 -->
<g id="node853" class="node">
<title>attn_residual_2_8</title>
<ellipse fill="none" stroke="black" cx="4921" cy="-5773" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4921" y="-5776.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4921" y="-5761.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_2_8&#45;&gt;attn_residual_2_8 -->
<g id="edge844" class="edge">
<title>attn_out_2_8&#45;&gt;attn_residual_2_8</title>
<path fill="none" stroke="black" d="M4921,-5872.98C4921,-5872.98 4921,-5810.36 4921,-5810.36"/>
<polygon fill="black" stroke="black" points="4924.5,-5810.36 4921,-5800.36 4917.5,-5810.36 4924.5,-5810.36"/>
</g>
<!-- ffn_up_2_8 -->
<g id="node854" class="node">
<title>ffn_up_2_8</title>
<polygon fill="none" stroke="black" points="5000,-5673 4842,-5673 4842,-5620 5000,-5620 5000,-5673"/>
<text text-anchor="middle" x="4921" y="-5657.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4921" y="-5642.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="4921" y="-5627.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_2_8&#45;&gt;ffn_up_2_8 -->
<g id="edge845" class="edge">
<title>attn_residual_2_8&#45;&gt;ffn_up_2_8</title>
<path fill="none" stroke="black" d="M4921,-5745.86C4921,-5745.86 4921,-5683.16 4921,-5683.16"/>
<polygon fill="black" stroke="black" points="4924.5,-5683.16 4921,-5673.16 4917.5,-5683.16 4924.5,-5683.16"/>
</g>
<!-- ffn_gelu_2_8 -->
<g id="node855" class="node">
<title>ffn_gelu_2_8</title>
<ellipse fill="none" stroke="black" cx="4921" cy="-5520" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4921" y="-5523.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4921" y="-5508.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_2_8&#45;&gt;ffn_gelu_2_8 -->
<g id="edge846" class="edge">
<title>ffn_up_2_8&#45;&gt;ffn_gelu_2_8</title>
<path fill="none" stroke="black" d="M4921,-5619.98C4921,-5619.98 4921,-5557.36 4921,-5557.36"/>
<polygon fill="black" stroke="black" points="4924.5,-5557.36 4921,-5547.36 4917.5,-5557.36 4924.5,-5557.36"/>
</g>
<!-- ffn_down_2_8 -->
<g id="node856" class="node">
<title>ffn_down_2_8</title>
<polygon fill="none" stroke="black" points="5010,-5420 4832,-5420 4832,-5367 5010,-5367 5010,-5420"/>
<text text-anchor="middle" x="4921" y="-5404.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4921" y="-5389.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="4921" y="-5374.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_2_8&#45;&gt;ffn_down_2_8 -->
<g id="edge847" class="edge">
<title>ffn_gelu_2_8&#45;&gt;ffn_down_2_8</title>
<path fill="none" stroke="black" d="M4921,-5492.86C4921,-5492.86 4921,-5430.16 4921,-5430.16"/>
<polygon fill="black" stroke="black" points="4924.5,-5430.16 4921,-5420.16 4917.5,-5430.16 4924.5,-5430.16"/>
</g>
<!-- ffn_residual_2_8 -->
<g id="node857" class="node">
<title>ffn_residual_2_8</title>
<ellipse fill="none" stroke="black" cx="4921" cy="-5267" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4921" y="-5270.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4921" y="-5255.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_2_8&#45;&gt;ffn_residual_2_8 -->
<g id="edge848" class="edge">
<title>ffn_down_2_8&#45;&gt;ffn_residual_2_8</title>
<path fill="none" stroke="black" d="M4921,-5366.98C4921,-5366.98 4921,-5304.36 4921,-5304.36"/>
<polygon fill="black" stroke="black" points="4924.5,-5304.36 4921,-5294.36 4917.5,-5304.36 4924.5,-5304.36"/>
</g>
<!-- qkv_proj_3_8 -->
<g id="node858" class="node">
<title>qkv_proj_3_8</title>
<polygon fill="none" stroke="black" points="5003.5,-5167 4838.5,-5167 4838.5,-5114 5003.5,-5114 5003.5,-5167"/>
<text text-anchor="middle" x="4921" y="-5151.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4921" y="-5136.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="4921" y="-5121.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_2_8&#45;&gt;qkv_proj_3_8 -->
<g id="edge849" class="edge">
<title>ffn_residual_2_8&#45;&gt;qkv_proj_3_8</title>
<path fill="none" stroke="black" d="M4921,-5239.86C4921,-5239.86 4921,-5177.16 4921,-5177.16"/>
<polygon fill="black" stroke="black" points="4924.5,-5177.16 4921,-5167.16 4917.5,-5177.16 4924.5,-5177.16"/>
</g>
<!-- qkv_reshape_3_8 -->
<g id="node859" class="node">
<title>qkv_reshape_3_8</title>
<ellipse fill="none" stroke="black" cx="4921" cy="-5014" rx="148" ry="27"/>
<text text-anchor="middle" x="4921" y="-5017.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="4921" y="-5002.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_3_8&#45;&gt;qkv_reshape_3_8 -->
<g id="edge850" class="edge">
<title>qkv_proj_3_8&#45;&gt;qkv_reshape_3_8</title>
<path fill="none" stroke="black" d="M4921,-5113.98C4921,-5113.98 4921,-5051.36 4921,-5051.36"/>
<polygon fill="black" stroke="black" points="4924.5,-5051.36 4921,-5041.36 4917.5,-5051.36 4924.5,-5051.36"/>
</g>
<!-- qkv_reshape_3_8&#45;&gt;ring_attn_3_8_stage_0 -->
<g id="edge851" class="edge">
<title>qkv_reshape_3_8&#45;&gt;ring_attn_3_8_stage_0</title>
<path fill="none" stroke="black" d="M4921,-4986.72C4921,-4986.72 4921,-4880.16 4921,-4880.16"/>
<polygon fill="black" stroke="black" points="4924.5,-4880.16 4921,-4870.16 4917.5,-4880.16 4924.5,-4880.16"/>
</g>
<!-- ring_attn_3_8_stage_0&#45;&gt;ring_attn_3_8_stage_1 -->
<g id="edge852" class="edge">
<title>ring_attn_3_8_stage_0&#45;&gt;ring_attn_3_8_stage_1</title>
<path fill="none" stroke="black" d="M4921,-4733.87C4921,-4733.87 4921,-4627.25 4921,-4627.25"/>
<polygon fill="black" stroke="black" points="4924.5,-4627.25 4921,-4617.25 4917.5,-4627.25 4924.5,-4627.25"/>
</g>
<!-- ring_attn_3_9_stage_0 -->
<g id="node958" class="node">
<title>ring_attn_3_9_stage_0</title>
<polygon fill="yellow" stroke="black" points="5508,-4870 5299,-4802 5508,-4734 5717,-4802 5508,-4870"/>
<text text-anchor="middle" x="5508" y="-4820.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-4805.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="5508" y="-4790.8" font-family="Times,serif" font-size="14.00">Q[9]×K[9]×V[9]</text>
<text text-anchor="middle" x="5508" y="-4775.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_8_stage_0&#45;&gt;ring_attn_3_9_stage_0 -->
<g id="edge2113" class="edge">
<title>ring_attn_3_8_stage_0&#45;&gt;ring_attn_3_9_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-4802C5130.02,-4802 5288.86,-4802 5288.86,-4802"/>
<polygon fill="red" stroke="red" points="5288.86,-4805.5 5298.86,-4802 5288.86,-4798.5 5288.86,-4805.5"/>
</g>
<!-- ring_attn_3_8_stage_1&#45;&gt;ring_attn_3_8_stage_2 -->
<g id="edge853" class="edge">
<title>ring_attn_3_8_stage_1&#45;&gt;ring_attn_3_8_stage_2</title>
<path fill="none" stroke="black" d="M4921,-4480.87C4921,-4480.87 4921,-4374.25 4921,-4374.25"/>
<polygon fill="black" stroke="black" points="4924.5,-4374.25 4921,-4364.25 4917.5,-4374.25 4924.5,-4374.25"/>
</g>
<!-- ring_attn_3_9_stage_1 -->
<g id="node959" class="node">
<title>ring_attn_3_9_stage_1</title>
<polygon fill="yellow" stroke="black" points="5508,-4617 5299,-4549 5508,-4481 5717,-4549 5508,-4617"/>
<text text-anchor="middle" x="5508" y="-4567.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-4552.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="5508" y="-4537.8" font-family="Times,serif" font-size="14.00">Q[9]×K[8]×V[8]</text>
<text text-anchor="middle" x="5508" y="-4522.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_8_stage_1&#45;&gt;ring_attn_3_9_stage_1 -->
<g id="edge2114" class="edge">
<title>ring_attn_3_8_stage_1&#45;&gt;ring_attn_3_9_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-4549C5130.02,-4549 5288.86,-4549 5288.86,-4549"/>
<polygon fill="red" stroke="red" points="5288.86,-4552.5 5298.86,-4549 5288.86,-4545.5 5288.86,-4552.5"/>
</g>
<!-- ring_attn_3_8_stage_2&#45;&gt;ring_attn_3_8_stage_3 -->
<g id="edge854" class="edge">
<title>ring_attn_3_8_stage_2&#45;&gt;ring_attn_3_8_stage_3</title>
<path fill="none" stroke="black" d="M4921,-4227.87C4921,-4227.87 4921,-4121.25 4921,-4121.25"/>
<polygon fill="black" stroke="black" points="4924.5,-4121.25 4921,-4111.25 4917.5,-4121.25 4924.5,-4121.25"/>
</g>
<!-- ring_attn_3_9_stage_2 -->
<g id="node960" class="node">
<title>ring_attn_3_9_stage_2</title>
<polygon fill="yellow" stroke="black" points="5508,-4364 5299,-4296 5508,-4228 5717,-4296 5508,-4364"/>
<text text-anchor="middle" x="5508" y="-4314.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-4299.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="5508" y="-4284.8" font-family="Times,serif" font-size="14.00">Q[9]×K[7]×V[7]</text>
<text text-anchor="middle" x="5508" y="-4269.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_8_stage_2&#45;&gt;ring_attn_3_9_stage_2 -->
<g id="edge2115" class="edge">
<title>ring_attn_3_8_stage_2&#45;&gt;ring_attn_3_9_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-4296C5130.02,-4296 5288.86,-4296 5288.86,-4296"/>
<polygon fill="red" stroke="red" points="5288.86,-4299.5 5298.86,-4296 5288.86,-4292.5 5288.86,-4299.5"/>
</g>
<!-- ring_attn_3_8_stage_3&#45;&gt;ring_attn_3_8_stage_4 -->
<g id="edge855" class="edge">
<title>ring_attn_3_8_stage_3&#45;&gt;ring_attn_3_8_stage_4</title>
<path fill="none" stroke="black" d="M4921,-3974.87C4921,-3974.87 4921,-3868.25 4921,-3868.25"/>
<polygon fill="black" stroke="black" points="4924.5,-3868.25 4921,-3858.25 4917.5,-3868.25 4924.5,-3868.25"/>
</g>
<!-- ring_attn_3_9_stage_3 -->
<g id="node961" class="node">
<title>ring_attn_3_9_stage_3</title>
<polygon fill="yellow" stroke="black" points="5508,-4111 5299,-4043 5508,-3975 5717,-4043 5508,-4111"/>
<text text-anchor="middle" x="5508" y="-4061.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-4046.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="5508" y="-4031.8" font-family="Times,serif" font-size="14.00">Q[9]×K[6]×V[6]</text>
<text text-anchor="middle" x="5508" y="-4016.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_8_stage_3&#45;&gt;ring_attn_3_9_stage_3 -->
<g id="edge2116" class="edge">
<title>ring_attn_3_8_stage_3&#45;&gt;ring_attn_3_9_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-4043C5130.02,-4043 5288.86,-4043 5288.86,-4043"/>
<polygon fill="red" stroke="red" points="5288.86,-4046.5 5298.86,-4043 5288.86,-4039.5 5288.86,-4046.5"/>
</g>
<!-- ring_attn_3_8_stage_4&#45;&gt;ring_attn_3_8_stage_5 -->
<g id="edge856" class="edge">
<title>ring_attn_3_8_stage_4&#45;&gt;ring_attn_3_8_stage_5</title>
<path fill="none" stroke="black" d="M4921,-3721.87C4921,-3721.87 4921,-3615.25 4921,-3615.25"/>
<polygon fill="black" stroke="black" points="4924.5,-3615.25 4921,-3605.25 4917.5,-3615.25 4924.5,-3615.25"/>
</g>
<!-- ring_attn_3_9_stage_4 -->
<g id="node962" class="node">
<title>ring_attn_3_9_stage_4</title>
<polygon fill="yellow" stroke="black" points="5508,-3858 5299,-3790 5508,-3722 5717,-3790 5508,-3858"/>
<text text-anchor="middle" x="5508" y="-3808.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-3793.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="5508" y="-3778.8" font-family="Times,serif" font-size="14.00">Q[9]×K[5]×V[5]</text>
<text text-anchor="middle" x="5508" y="-3763.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_8_stage_4&#45;&gt;ring_attn_3_9_stage_4 -->
<g id="edge2117" class="edge">
<title>ring_attn_3_8_stage_4&#45;&gt;ring_attn_3_9_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-3790C5130.02,-3790 5288.86,-3790 5288.86,-3790"/>
<polygon fill="red" stroke="red" points="5288.86,-3793.5 5298.86,-3790 5288.86,-3786.5 5288.86,-3793.5"/>
</g>
<!-- ring_attn_3_8_stage_5&#45;&gt;ring_attn_3_8_stage_6 -->
<g id="edge857" class="edge">
<title>ring_attn_3_8_stage_5&#45;&gt;ring_attn_3_8_stage_6</title>
<path fill="none" stroke="black" d="M4921,-3468.87C4921,-3468.87 4921,-3362.25 4921,-3362.25"/>
<polygon fill="black" stroke="black" points="4924.5,-3362.25 4921,-3352.25 4917.5,-3362.25 4924.5,-3362.25"/>
</g>
<!-- ring_attn_3_9_stage_5 -->
<g id="node963" class="node">
<title>ring_attn_3_9_stage_5</title>
<polygon fill="yellow" stroke="black" points="5508,-3605 5299,-3537 5508,-3469 5717,-3537 5508,-3605"/>
<text text-anchor="middle" x="5508" y="-3555.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-3540.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="5508" y="-3525.8" font-family="Times,serif" font-size="14.00">Q[9]×K[4]×V[4]</text>
<text text-anchor="middle" x="5508" y="-3510.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_8_stage_5&#45;&gt;ring_attn_3_9_stage_5 -->
<g id="edge2118" class="edge">
<title>ring_attn_3_8_stage_5&#45;&gt;ring_attn_3_9_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-3537C5130.02,-3537 5288.86,-3537 5288.86,-3537"/>
<polygon fill="red" stroke="red" points="5288.86,-3540.5 5298.86,-3537 5288.86,-3533.5 5288.86,-3540.5"/>
</g>
<!-- ring_attn_3_8_stage_6&#45;&gt;ring_attn_3_8_stage_7 -->
<g id="edge858" class="edge">
<title>ring_attn_3_8_stage_6&#45;&gt;ring_attn_3_8_stage_7</title>
<path fill="none" stroke="black" d="M4921,-3215.87C4921,-3215.87 4921,-3109.25 4921,-3109.25"/>
<polygon fill="black" stroke="black" points="4924.5,-3109.25 4921,-3099.25 4917.5,-3109.25 4924.5,-3109.25"/>
</g>
<!-- ring_attn_3_9_stage_6 -->
<g id="node964" class="node">
<title>ring_attn_3_9_stage_6</title>
<polygon fill="yellow" stroke="black" points="5508,-3352 5299,-3284 5508,-3216 5717,-3284 5508,-3352"/>
<text text-anchor="middle" x="5508" y="-3302.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-3287.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="5508" y="-3272.8" font-family="Times,serif" font-size="14.00">Q[9]×K[3]×V[3]</text>
<text text-anchor="middle" x="5508" y="-3257.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_8_stage_6&#45;&gt;ring_attn_3_9_stage_6 -->
<g id="edge2119" class="edge">
<title>ring_attn_3_8_stage_6&#45;&gt;ring_attn_3_9_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-3284C5130.02,-3284 5288.86,-3284 5288.86,-3284"/>
<polygon fill="red" stroke="red" points="5288.86,-3287.5 5298.86,-3284 5288.86,-3280.5 5288.86,-3287.5"/>
</g>
<!-- ring_attn_3_8_stage_7&#45;&gt;ring_attn_3_8_stage_8 -->
<g id="edge859" class="edge">
<title>ring_attn_3_8_stage_7&#45;&gt;ring_attn_3_8_stage_8</title>
<path fill="none" stroke="black" d="M4921,-2962.87C4921,-2962.87 4921,-2856.25 4921,-2856.25"/>
<polygon fill="black" stroke="black" points="4924.5,-2856.25 4921,-2846.25 4917.5,-2856.25 4924.5,-2856.25"/>
</g>
<!-- ring_attn_3_9_stage_7 -->
<g id="node965" class="node">
<title>ring_attn_3_9_stage_7</title>
<polygon fill="yellow" stroke="black" points="5508,-3099 5299,-3031 5508,-2963 5717,-3031 5508,-3099"/>
<text text-anchor="middle" x="5508" y="-3049.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-3034.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="5508" y="-3019.8" font-family="Times,serif" font-size="14.00">Q[9]×K[2]×V[2]</text>
<text text-anchor="middle" x="5508" y="-3004.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_8_stage_7&#45;&gt;ring_attn_3_9_stage_7 -->
<g id="edge2120" class="edge">
<title>ring_attn_3_8_stage_7&#45;&gt;ring_attn_3_9_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-3031C5130.02,-3031 5288.86,-3031 5288.86,-3031"/>
<polygon fill="red" stroke="red" points="5288.86,-3034.5 5298.86,-3031 5288.86,-3027.5 5288.86,-3034.5"/>
</g>
<!-- ring_attn_3_8_stage_8&#45;&gt;ring_attn_3_8_stage_9 -->
<g id="edge860" class="edge">
<title>ring_attn_3_8_stage_8&#45;&gt;ring_attn_3_8_stage_9</title>
<path fill="none" stroke="black" d="M4921,-2709.87C4921,-2709.87 4921,-2603.25 4921,-2603.25"/>
<polygon fill="black" stroke="black" points="4924.5,-2603.25 4921,-2593.25 4917.5,-2603.25 4924.5,-2603.25"/>
</g>
<!-- ring_attn_3_9_stage_8 -->
<g id="node966" class="node">
<title>ring_attn_3_9_stage_8</title>
<polygon fill="yellow" stroke="black" points="5508,-2846 5299,-2778 5508,-2710 5717,-2778 5508,-2846"/>
<text text-anchor="middle" x="5508" y="-2796.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-2781.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="5508" y="-2766.8" font-family="Times,serif" font-size="14.00">Q[9]×K[1]×V[1]</text>
<text text-anchor="middle" x="5508" y="-2751.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_8_stage_8&#45;&gt;ring_attn_3_9_stage_8 -->
<g id="edge2121" class="edge">
<title>ring_attn_3_8_stage_8&#45;&gt;ring_attn_3_9_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-2778C5130.02,-2778 5288.86,-2778 5288.86,-2778"/>
<polygon fill="red" stroke="red" points="5288.86,-2781.5 5298.86,-2778 5288.86,-2774.5 5288.86,-2781.5"/>
</g>
<!-- ring_attn_3_8_stage_9&#45;&gt;ring_attn_3_8_stage_10 -->
<g id="edge861" class="edge">
<title>ring_attn_3_8_stage_9&#45;&gt;ring_attn_3_8_stage_10</title>
<path fill="none" stroke="black" d="M4921,-2456.87C4921,-2456.87 4921,-2350.25 4921,-2350.25"/>
<polygon fill="black" stroke="black" points="4924.5,-2350.25 4921,-2340.25 4917.5,-2350.25 4924.5,-2350.25"/>
</g>
<!-- ring_attn_3_9_stage_9 -->
<g id="node967" class="node">
<title>ring_attn_3_9_stage_9</title>
<polygon fill="yellow" stroke="black" points="5508,-2593 5299,-2525 5508,-2457 5717,-2525 5508,-2593"/>
<text text-anchor="middle" x="5508" y="-2543.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-2528.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="5508" y="-2513.8" font-family="Times,serif" font-size="14.00">Q[9]×K[0]×V[0]</text>
<text text-anchor="middle" x="5508" y="-2498.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_8_stage_9&#45;&gt;ring_attn_3_9_stage_9 -->
<g id="edge2122" class="edge">
<title>ring_attn_3_8_stage_9&#45;&gt;ring_attn_3_9_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-2525C5130.02,-2525 5288.86,-2525 5288.86,-2525"/>
<polygon fill="red" stroke="red" points="5288.86,-2528.5 5298.86,-2525 5288.86,-2521.5 5288.86,-2528.5"/>
</g>
<!-- ring_attn_3_8_stage_10&#45;&gt;ring_attn_3_8_stage_11 -->
<g id="edge862" class="edge">
<title>ring_attn_3_8_stage_10&#45;&gt;ring_attn_3_8_stage_11</title>
<path fill="none" stroke="black" d="M4921,-2203.87C4921,-2203.87 4921,-2097.25 4921,-2097.25"/>
<polygon fill="black" stroke="black" points="4924.5,-2097.25 4921,-2087.25 4917.5,-2097.25 4924.5,-2097.25"/>
</g>
<!-- ring_attn_3_9_stage_10 -->
<g id="node968" class="node">
<title>ring_attn_3_9_stage_10</title>
<polygon fill="yellow" stroke="black" points="5508,-2340 5299,-2272 5508,-2204 5717,-2272 5508,-2340"/>
<text text-anchor="middle" x="5508" y="-2290.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-2275.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="5508" y="-2260.8" font-family="Times,serif" font-size="14.00">Q[9]×K[15]×V[15]</text>
<text text-anchor="middle" x="5508" y="-2245.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_8_stage_10&#45;&gt;ring_attn_3_9_stage_10 -->
<g id="edge2123" class="edge">
<title>ring_attn_3_8_stage_10&#45;&gt;ring_attn_3_9_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-2272C5130.02,-2272 5288.86,-2272 5288.86,-2272"/>
<polygon fill="red" stroke="red" points="5288.86,-2275.5 5298.86,-2272 5288.86,-2268.5 5288.86,-2275.5"/>
</g>
<!-- ring_attn_3_8_stage_11&#45;&gt;ring_attn_3_8_stage_12 -->
<g id="edge863" class="edge">
<title>ring_attn_3_8_stage_11&#45;&gt;ring_attn_3_8_stage_12</title>
<path fill="none" stroke="black" d="M4921,-1950.87C4921,-1950.87 4921,-1844.25 4921,-1844.25"/>
<polygon fill="black" stroke="black" points="4924.5,-1844.25 4921,-1834.25 4917.5,-1844.25 4924.5,-1844.25"/>
</g>
<!-- ring_attn_3_9_stage_11 -->
<g id="node969" class="node">
<title>ring_attn_3_9_stage_11</title>
<polygon fill="yellow" stroke="black" points="5508,-2087 5299,-2019 5508,-1951 5717,-2019 5508,-2087"/>
<text text-anchor="middle" x="5508" y="-2037.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-2022.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="5508" y="-2007.8" font-family="Times,serif" font-size="14.00">Q[9]×K[14]×V[14]</text>
<text text-anchor="middle" x="5508" y="-1992.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_8_stage_11&#45;&gt;ring_attn_3_9_stage_11 -->
<g id="edge2124" class="edge">
<title>ring_attn_3_8_stage_11&#45;&gt;ring_attn_3_9_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-2019C5130.02,-2019 5288.86,-2019 5288.86,-2019"/>
<polygon fill="red" stroke="red" points="5288.86,-2022.5 5298.86,-2019 5288.86,-2015.5 5288.86,-2022.5"/>
</g>
<!-- ring_attn_3_8_stage_12&#45;&gt;ring_attn_3_8_stage_13 -->
<g id="edge864" class="edge">
<title>ring_attn_3_8_stage_12&#45;&gt;ring_attn_3_8_stage_13</title>
<path fill="none" stroke="black" d="M4921,-1697.87C4921,-1697.87 4921,-1591.25 4921,-1591.25"/>
<polygon fill="black" stroke="black" points="4924.5,-1591.25 4921,-1581.25 4917.5,-1591.25 4924.5,-1591.25"/>
</g>
<!-- ring_attn_3_9_stage_12 -->
<g id="node970" class="node">
<title>ring_attn_3_9_stage_12</title>
<polygon fill="yellow" stroke="black" points="5508,-1834 5299,-1766 5508,-1698 5717,-1766 5508,-1834"/>
<text text-anchor="middle" x="5508" y="-1784.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-1769.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="5508" y="-1754.8" font-family="Times,serif" font-size="14.00">Q[9]×K[13]×V[13]</text>
<text text-anchor="middle" x="5508" y="-1739.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_8_stage_12&#45;&gt;ring_attn_3_9_stage_12 -->
<g id="edge2125" class="edge">
<title>ring_attn_3_8_stage_12&#45;&gt;ring_attn_3_9_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-1766C5130.02,-1766 5288.86,-1766 5288.86,-1766"/>
<polygon fill="red" stroke="red" points="5288.86,-1769.5 5298.86,-1766 5288.86,-1762.5 5288.86,-1769.5"/>
</g>
<!-- ring_attn_3_8_stage_13&#45;&gt;ring_attn_3_8_stage_14 -->
<g id="edge865" class="edge">
<title>ring_attn_3_8_stage_13&#45;&gt;ring_attn_3_8_stage_14</title>
<path fill="none" stroke="black" d="M4921,-1444.87C4921,-1444.87 4921,-1338.25 4921,-1338.25"/>
<polygon fill="black" stroke="black" points="4924.5,-1338.25 4921,-1328.25 4917.5,-1338.25 4924.5,-1338.25"/>
</g>
<!-- ring_attn_3_9_stage_13 -->
<g id="node971" class="node">
<title>ring_attn_3_9_stage_13</title>
<polygon fill="yellow" stroke="black" points="5508,-1581 5299,-1513 5508,-1445 5717,-1513 5508,-1581"/>
<text text-anchor="middle" x="5508" y="-1531.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-1516.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="5508" y="-1501.8" font-family="Times,serif" font-size="14.00">Q[9]×K[12]×V[12]</text>
<text text-anchor="middle" x="5508" y="-1486.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_8_stage_13&#45;&gt;ring_attn_3_9_stage_13 -->
<g id="edge2126" class="edge">
<title>ring_attn_3_8_stage_13&#45;&gt;ring_attn_3_9_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-1513C5130.02,-1513 5288.86,-1513 5288.86,-1513"/>
<polygon fill="red" stroke="red" points="5288.86,-1516.5 5298.86,-1513 5288.86,-1509.5 5288.86,-1516.5"/>
</g>
<!-- ring_attn_3_8_stage_14&#45;&gt;ring_attn_3_8_stage_15 -->
<g id="edge866" class="edge">
<title>ring_attn_3_8_stage_14&#45;&gt;ring_attn_3_8_stage_15</title>
<path fill="none" stroke="black" d="M4921,-1191.87C4921,-1191.87 4921,-1085.25 4921,-1085.25"/>
<polygon fill="black" stroke="black" points="4924.5,-1085.25 4921,-1075.25 4917.5,-1085.25 4924.5,-1085.25"/>
</g>
<!-- ring_attn_3_9_stage_14 -->
<g id="node972" class="node">
<title>ring_attn_3_9_stage_14</title>
<polygon fill="yellow" stroke="black" points="5508,-1328 5299,-1260 5508,-1192 5717,-1260 5508,-1328"/>
<text text-anchor="middle" x="5508" y="-1278.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-1263.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="5508" y="-1248.8" font-family="Times,serif" font-size="14.00">Q[9]×K[11]×V[11]</text>
<text text-anchor="middle" x="5508" y="-1233.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_8_stage_14&#45;&gt;ring_attn_3_9_stage_14 -->
<g id="edge2127" class="edge">
<title>ring_attn_3_8_stage_14&#45;&gt;ring_attn_3_9_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-1260C5130.02,-1260 5288.86,-1260 5288.86,-1260"/>
<polygon fill="red" stroke="red" points="5288.86,-1263.5 5298.86,-1260 5288.86,-1256.5 5288.86,-1263.5"/>
</g>
<!-- attn_out_3_8 -->
<g id="node876" class="node">
<title>attn_out_3_8</title>
<polygon fill="none" stroke="black" points="4990.5,-866 4851.5,-866 4851.5,-813 4990.5,-813 4990.5,-866"/>
<text text-anchor="middle" x="4921" y="-850.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="4921" y="-835.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="4921" y="-820.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_3_8_stage_15&#45;&gt;attn_out_3_8 -->
<g id="edge867" class="edge">
<title>ring_attn_3_8_stage_15&#45;&gt;attn_out_3_8</title>
<path fill="none" stroke="black" d="M4921,-938.87C4921,-938.87 4921,-876.18 4921,-876.18"/>
<polygon fill="black" stroke="black" points="4924.5,-876.18 4921,-866.18 4917.5,-876.18 4924.5,-876.18"/>
</g>
<!-- ring_attn_3_9_stage_15 -->
<g id="node973" class="node">
<title>ring_attn_3_9_stage_15</title>
<polygon fill="yellow" stroke="black" points="5508,-1075 5299,-1007 5508,-939 5717,-1007 5508,-1075"/>
<text text-anchor="middle" x="5508" y="-1025.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="5508" y="-1010.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="5508" y="-995.8" font-family="Times,serif" font-size="14.00">Q[9]×K[10]×V[10]</text>
<text text-anchor="middle" x="5508" y="-980.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_8_stage_15&#45;&gt;ring_attn_3_9_stage_15 -->
<g id="edge2128" class="edge">
<title>ring_attn_3_8_stage_15&#45;&gt;ring_attn_3_9_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5130.02,-1007C5130.02,-1007 5288.86,-1007 5288.86,-1007"/>
<polygon fill="red" stroke="red" points="5288.86,-1010.5 5298.86,-1007 5288.86,-1003.5 5288.86,-1010.5"/>
</g>
<!-- attn_residual_3_8 -->
<g id="node877" class="node">
<title>attn_residual_3_8</title>
<ellipse fill="none" stroke="black" cx="4921" cy="-713" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4921" y="-716.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4921" y="-701.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_3_8&#45;&gt;attn_residual_3_8 -->
<g id="edge868" class="edge">
<title>attn_out_3_8&#45;&gt;attn_residual_3_8</title>
<path fill="none" stroke="black" d="M4921,-812.98C4921,-812.98 4921,-750.36 4921,-750.36"/>
<polygon fill="black" stroke="black" points="4924.5,-750.36 4921,-740.36 4917.5,-750.36 4924.5,-750.36"/>
</g>
<!-- ffn_up_3_8 -->
<g id="node878" class="node">
<title>ffn_up_3_8</title>
<polygon fill="none" stroke="black" points="5000,-613 4842,-613 4842,-560 5000,-560 5000,-613"/>
<text text-anchor="middle" x="4921" y="-597.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="4921" y="-582.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="4921" y="-567.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_3_8&#45;&gt;ffn_up_3_8 -->
<g id="edge869" class="edge">
<title>attn_residual_3_8&#45;&gt;ffn_up_3_8</title>
<path fill="none" stroke="black" d="M4921,-685.86C4921,-685.86 4921,-623.16 4921,-623.16"/>
<polygon fill="black" stroke="black" points="4924.5,-623.16 4921,-613.16 4917.5,-623.16 4924.5,-623.16"/>
</g>
<!-- ffn_gelu_3_8 -->
<g id="node879" class="node">
<title>ffn_gelu_3_8</title>
<ellipse fill="none" stroke="black" cx="4921" cy="-460" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4921" y="-463.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4921" y="-448.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_3_8&#45;&gt;ffn_gelu_3_8 -->
<g id="edge870" class="edge">
<title>ffn_up_3_8&#45;&gt;ffn_gelu_3_8</title>
<path fill="none" stroke="black" d="M4921,-559.98C4921,-559.98 4921,-497.36 4921,-497.36"/>
<polygon fill="black" stroke="black" points="4924.5,-497.36 4921,-487.36 4917.5,-497.36 4924.5,-497.36"/>
</g>
<!-- ffn_down_3_8 -->
<g id="node880" class="node">
<title>ffn_down_3_8</title>
<polygon fill="none" stroke="black" points="5010,-360 4832,-360 4832,-307 5010,-307 5010,-360"/>
<text text-anchor="middle" x="4921" y="-344.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="4921" y="-329.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="4921" y="-314.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_3_8&#45;&gt;ffn_down_3_8 -->
<g id="edge871" class="edge">
<title>ffn_gelu_3_8&#45;&gt;ffn_down_3_8</title>
<path fill="none" stroke="black" d="M4921,-432.86C4921,-432.86 4921,-370.16 4921,-370.16"/>
<polygon fill="black" stroke="black" points="4924.5,-370.16 4921,-360.16 4917.5,-370.16 4924.5,-370.16"/>
</g>
<!-- ffn_residual_3_8 -->
<g id="node881" class="node">
<title>ffn_residual_3_8</title>
<ellipse fill="none" stroke="black" cx="4921" cy="-207" rx="105.5" ry="27"/>
<text text-anchor="middle" x="4921" y="-210.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="4921" y="-195.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_3_8&#45;&gt;ffn_residual_3_8 -->
<g id="edge872" class="edge">
<title>ffn_down_3_8&#45;&gt;ffn_residual_3_8</title>
<path fill="none" stroke="black" d="M4921,-306.98C4921,-306.98 4921,-244.36 4921,-244.36"/>
<polygon fill="black" stroke="black" points="4924.5,-244.36 4921,-234.36 4917.5,-244.36 4924.5,-244.36"/>
</g>
<!-- output_8 -->
<g id="node882" class="node">
<title>output_8</title>
<polygon fill="lightcoral" stroke="black" points="5014,-107 4828,-107 4828,-69 5014,-69 5014,-107"/>
<text text-anchor="middle" x="4921" y="-91.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="4921" y="-76.8" font-family="Times,serif" font-size="14.00">Y[8]: 1024×1024×4096</text>
</g>
<!-- ffn_residual_3_8&#45;&gt;output_8 -->
<g id="edge873" class="edge">
<title>ffn_residual_3_8&#45;&gt;output_8</title>
<path fill="none" stroke="black" d="M4921,-180C4921,-180 4921,-117.12 4921,-117.12"/>
<polygon fill="black" stroke="black" points="4924.5,-117.12 4921,-107.12 4917.5,-117.12 4924.5,-117.12"/>
</g>
<!-- input_9 -->
<g id="node883" class="node">
<title>input_9</title>
<polygon fill="lightgreen" stroke="black" points="5601.5,-20458 5414.5,-20458 5414.5,-20420 5601.5,-20420 5601.5,-20458"/>
<text text-anchor="middle" x="5508" y="-20442.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="5508" y="-20427.8" font-family="Times,serif" font-size="14.00">X[9]: 1024×1024×4096</text>
</g>
<!-- qkv_proj_0_9 -->
<g id="node884" class="node">
<title>qkv_proj_0_9</title>
<polygon fill="none" stroke="black" points="5590.5,-20347 5425.5,-20347 5425.5,-20294 5590.5,-20294 5590.5,-20347"/>
<text text-anchor="middle" x="5508" y="-20331.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5508" y="-20316.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="5508" y="-20301.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- input_9&#45;&gt;qkv_proj_0_9 -->
<g id="edge874" class="edge">
<title>input_9&#45;&gt;qkv_proj_0_9</title>
<path fill="none" stroke="black" d="M5508,-20419.96C5508,-20419.96 5508,-20357.44 5508,-20357.44"/>
<polygon fill="black" stroke="black" points="5511.5,-20357.44 5508,-20347.44 5504.5,-20357.44 5511.5,-20357.44"/>
</g>
<!-- qkv_reshape_0_9 -->
<g id="node885" class="node">
<title>qkv_reshape_0_9</title>
<ellipse fill="none" stroke="black" cx="5508" cy="-20194" rx="148" ry="27"/>
<text text-anchor="middle" x="5508" y="-20197.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="5508" y="-20182.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_0_9&#45;&gt;qkv_reshape_0_9 -->
<g id="edge875" class="edge">
<title>qkv_proj_0_9&#45;&gt;qkv_reshape_0_9</title>
<path fill="none" stroke="black" d="M5508,-20293.98C5508,-20293.98 5508,-20231.36 5508,-20231.36"/>
<polygon fill="black" stroke="black" points="5511.5,-20231.36 5508,-20221.36 5504.5,-20231.36 5511.5,-20231.36"/>
</g>
<!-- qkv_reshape_0_9&#45;&gt;ring_attn_0_9_stage_0 -->
<g id="edge876" class="edge">
<title>qkv_reshape_0_9&#45;&gt;ring_attn_0_9_stage_0</title>
<path fill="none" stroke="black" d="M5508,-20166.72C5508,-20166.72 5508,-20060.16 5508,-20060.16"/>
<polygon fill="black" stroke="black" points="5511.5,-20060.16 5508,-20050.16 5504.5,-20060.16 5511.5,-20060.16"/>
</g>
<!-- ring_attn_0_9_stage_0&#45;&gt;ring_attn_0_9_stage_1 -->
<g id="edge877" class="edge">
<title>ring_attn_0_9_stage_0&#45;&gt;ring_attn_0_9_stage_1</title>
<path fill="none" stroke="black" d="M5508,-19913.87C5508,-19913.87 5508,-19807.25 5508,-19807.25"/>
<polygon fill="black" stroke="black" points="5511.5,-19807.25 5508,-19797.25 5504.5,-19807.25 5511.5,-19807.25"/>
</g>
<!-- ring_attn_0_10_stage_0 -->
<g id="node984" class="node">
<title>ring_attn_0_10_stage_0</title>
<polygon fill="yellow" stroke="black" points="6095,-20050 5886,-19982 6095,-19914 6304,-19982 6095,-20050"/>
<text text-anchor="middle" x="6095" y="-20000.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-19985.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="6095" y="-19970.8" font-family="Times,serif" font-size="14.00">Q[10]×K[10]×V[10]</text>
<text text-anchor="middle" x="6095" y="-19955.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_9_stage_0&#45;&gt;ring_attn_0_10_stage_0 -->
<g id="edge2129" class="edge">
<title>ring_attn_0_9_stage_0&#45;&gt;ring_attn_0_10_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-19982C5717.02,-19982 5875.86,-19982 5875.86,-19982"/>
<polygon fill="red" stroke="red" points="5875.86,-19985.5 5885.86,-19982 5875.86,-19978.5 5875.86,-19985.5"/>
</g>
<!-- ring_attn_0_9_stage_1&#45;&gt;ring_attn_0_9_stage_2 -->
<g id="edge878" class="edge">
<title>ring_attn_0_9_stage_1&#45;&gt;ring_attn_0_9_stage_2</title>
<path fill="none" stroke="black" d="M5508,-19660.87C5508,-19660.87 5508,-19554.25 5508,-19554.25"/>
<polygon fill="black" stroke="black" points="5511.5,-19554.25 5508,-19544.25 5504.5,-19554.25 5511.5,-19554.25"/>
</g>
<!-- ring_attn_0_10_stage_1 -->
<g id="node985" class="node">
<title>ring_attn_0_10_stage_1</title>
<polygon fill="yellow" stroke="black" points="6095,-19797 5886,-19729 6095,-19661 6304,-19729 6095,-19797"/>
<text text-anchor="middle" x="6095" y="-19747.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-19732.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="6095" y="-19717.8" font-family="Times,serif" font-size="14.00">Q[10]×K[9]×V[9]</text>
<text text-anchor="middle" x="6095" y="-19702.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_9_stage_1&#45;&gt;ring_attn_0_10_stage_1 -->
<g id="edge2130" class="edge">
<title>ring_attn_0_9_stage_1&#45;&gt;ring_attn_0_10_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-19729C5717.02,-19729 5875.86,-19729 5875.86,-19729"/>
<polygon fill="red" stroke="red" points="5875.86,-19732.5 5885.86,-19729 5875.86,-19725.5 5875.86,-19732.5"/>
</g>
<!-- ring_attn_0_9_stage_2&#45;&gt;ring_attn_0_9_stage_3 -->
<g id="edge879" class="edge">
<title>ring_attn_0_9_stage_2&#45;&gt;ring_attn_0_9_stage_3</title>
<path fill="none" stroke="black" d="M5508,-19407.87C5508,-19407.87 5508,-19301.25 5508,-19301.25"/>
<polygon fill="black" stroke="black" points="5511.5,-19301.25 5508,-19291.25 5504.5,-19301.25 5511.5,-19301.25"/>
</g>
<!-- ring_attn_0_10_stage_2 -->
<g id="node986" class="node">
<title>ring_attn_0_10_stage_2</title>
<polygon fill="yellow" stroke="black" points="6095,-19544 5886,-19476 6095,-19408 6304,-19476 6095,-19544"/>
<text text-anchor="middle" x="6095" y="-19494.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-19479.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="6095" y="-19464.8" font-family="Times,serif" font-size="14.00">Q[10]×K[8]×V[8]</text>
<text text-anchor="middle" x="6095" y="-19449.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_9_stage_2&#45;&gt;ring_attn_0_10_stage_2 -->
<g id="edge2131" class="edge">
<title>ring_attn_0_9_stage_2&#45;&gt;ring_attn_0_10_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-19476C5717.02,-19476 5875.86,-19476 5875.86,-19476"/>
<polygon fill="red" stroke="red" points="5875.86,-19479.5 5885.86,-19476 5875.86,-19472.5 5875.86,-19479.5"/>
</g>
<!-- ring_attn_0_9_stage_3&#45;&gt;ring_attn_0_9_stage_4 -->
<g id="edge880" class="edge">
<title>ring_attn_0_9_stage_3&#45;&gt;ring_attn_0_9_stage_4</title>
<path fill="none" stroke="black" d="M5508,-19154.87C5508,-19154.87 5508,-19048.25 5508,-19048.25"/>
<polygon fill="black" stroke="black" points="5511.5,-19048.25 5508,-19038.25 5504.5,-19048.25 5511.5,-19048.25"/>
</g>
<!-- ring_attn_0_10_stage_3 -->
<g id="node987" class="node">
<title>ring_attn_0_10_stage_3</title>
<polygon fill="yellow" stroke="black" points="6095,-19291 5886,-19223 6095,-19155 6304,-19223 6095,-19291"/>
<text text-anchor="middle" x="6095" y="-19241.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-19226.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="6095" y="-19211.8" font-family="Times,serif" font-size="14.00">Q[10]×K[7]×V[7]</text>
<text text-anchor="middle" x="6095" y="-19196.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_9_stage_3&#45;&gt;ring_attn_0_10_stage_3 -->
<g id="edge2132" class="edge">
<title>ring_attn_0_9_stage_3&#45;&gt;ring_attn_0_10_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-19223C5717.02,-19223 5875.86,-19223 5875.86,-19223"/>
<polygon fill="red" stroke="red" points="5875.86,-19226.5 5885.86,-19223 5875.86,-19219.5 5875.86,-19226.5"/>
</g>
<!-- ring_attn_0_9_stage_4&#45;&gt;ring_attn_0_9_stage_5 -->
<g id="edge881" class="edge">
<title>ring_attn_0_9_stage_4&#45;&gt;ring_attn_0_9_stage_5</title>
<path fill="none" stroke="black" d="M5508,-18901.87C5508,-18901.87 5508,-18795.25 5508,-18795.25"/>
<polygon fill="black" stroke="black" points="5511.5,-18795.25 5508,-18785.25 5504.5,-18795.25 5511.5,-18795.25"/>
</g>
<!-- ring_attn_0_10_stage_4 -->
<g id="node988" class="node">
<title>ring_attn_0_10_stage_4</title>
<polygon fill="yellow" stroke="black" points="6095,-19038 5886,-18970 6095,-18902 6304,-18970 6095,-19038"/>
<text text-anchor="middle" x="6095" y="-18988.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-18973.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="6095" y="-18958.8" font-family="Times,serif" font-size="14.00">Q[10]×K[6]×V[6]</text>
<text text-anchor="middle" x="6095" y="-18943.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_9_stage_4&#45;&gt;ring_attn_0_10_stage_4 -->
<g id="edge2133" class="edge">
<title>ring_attn_0_9_stage_4&#45;&gt;ring_attn_0_10_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-18970C5717.02,-18970 5875.86,-18970 5875.86,-18970"/>
<polygon fill="red" stroke="red" points="5875.86,-18973.5 5885.86,-18970 5875.86,-18966.5 5875.86,-18973.5"/>
</g>
<!-- ring_attn_0_9_stage_5&#45;&gt;ring_attn_0_9_stage_6 -->
<g id="edge882" class="edge">
<title>ring_attn_0_9_stage_5&#45;&gt;ring_attn_0_9_stage_6</title>
<path fill="none" stroke="black" d="M5508,-18648.87C5508,-18648.87 5508,-18542.25 5508,-18542.25"/>
<polygon fill="black" stroke="black" points="5511.5,-18542.25 5508,-18532.25 5504.5,-18542.25 5511.5,-18542.25"/>
</g>
<!-- ring_attn_0_10_stage_5 -->
<g id="node989" class="node">
<title>ring_attn_0_10_stage_5</title>
<polygon fill="yellow" stroke="black" points="6095,-18785 5886,-18717 6095,-18649 6304,-18717 6095,-18785"/>
<text text-anchor="middle" x="6095" y="-18735.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-18720.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="6095" y="-18705.8" font-family="Times,serif" font-size="14.00">Q[10]×K[5]×V[5]</text>
<text text-anchor="middle" x="6095" y="-18690.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_9_stage_5&#45;&gt;ring_attn_0_10_stage_5 -->
<g id="edge2134" class="edge">
<title>ring_attn_0_9_stage_5&#45;&gt;ring_attn_0_10_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-18717C5717.02,-18717 5875.86,-18717 5875.86,-18717"/>
<polygon fill="red" stroke="red" points="5875.86,-18720.5 5885.86,-18717 5875.86,-18713.5 5875.86,-18720.5"/>
</g>
<!-- ring_attn_0_9_stage_6&#45;&gt;ring_attn_0_9_stage_7 -->
<g id="edge883" class="edge">
<title>ring_attn_0_9_stage_6&#45;&gt;ring_attn_0_9_stage_7</title>
<path fill="none" stroke="black" d="M5508,-18395.87C5508,-18395.87 5508,-18289.25 5508,-18289.25"/>
<polygon fill="black" stroke="black" points="5511.5,-18289.25 5508,-18279.25 5504.5,-18289.25 5511.5,-18289.25"/>
</g>
<!-- ring_attn_0_10_stage_6 -->
<g id="node990" class="node">
<title>ring_attn_0_10_stage_6</title>
<polygon fill="yellow" stroke="black" points="6095,-18532 5886,-18464 6095,-18396 6304,-18464 6095,-18532"/>
<text text-anchor="middle" x="6095" y="-18482.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-18467.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="6095" y="-18452.8" font-family="Times,serif" font-size="14.00">Q[10]×K[4]×V[4]</text>
<text text-anchor="middle" x="6095" y="-18437.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_9_stage_6&#45;&gt;ring_attn_0_10_stage_6 -->
<g id="edge2135" class="edge">
<title>ring_attn_0_9_stage_6&#45;&gt;ring_attn_0_10_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-18464C5717.02,-18464 5875.86,-18464 5875.86,-18464"/>
<polygon fill="red" stroke="red" points="5875.86,-18467.5 5885.86,-18464 5875.86,-18460.5 5875.86,-18467.5"/>
</g>
<!-- ring_attn_0_9_stage_7&#45;&gt;ring_attn_0_9_stage_8 -->
<g id="edge884" class="edge">
<title>ring_attn_0_9_stage_7&#45;&gt;ring_attn_0_9_stage_8</title>
<path fill="none" stroke="black" d="M5508,-18142.87C5508,-18142.87 5508,-18036.25 5508,-18036.25"/>
<polygon fill="black" stroke="black" points="5511.5,-18036.25 5508,-18026.25 5504.5,-18036.25 5511.5,-18036.25"/>
</g>
<!-- ring_attn_0_10_stage_7 -->
<g id="node991" class="node">
<title>ring_attn_0_10_stage_7</title>
<polygon fill="yellow" stroke="black" points="6095,-18279 5886,-18211 6095,-18143 6304,-18211 6095,-18279"/>
<text text-anchor="middle" x="6095" y="-18229.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-18214.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="6095" y="-18199.8" font-family="Times,serif" font-size="14.00">Q[10]×K[3]×V[3]</text>
<text text-anchor="middle" x="6095" y="-18184.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_9_stage_7&#45;&gt;ring_attn_0_10_stage_7 -->
<g id="edge2136" class="edge">
<title>ring_attn_0_9_stage_7&#45;&gt;ring_attn_0_10_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-18211C5717.02,-18211 5875.86,-18211 5875.86,-18211"/>
<polygon fill="red" stroke="red" points="5875.86,-18214.5 5885.86,-18211 5875.86,-18207.5 5875.86,-18214.5"/>
</g>
<!-- ring_attn_0_9_stage_8&#45;&gt;ring_attn_0_9_stage_9 -->
<g id="edge885" class="edge">
<title>ring_attn_0_9_stage_8&#45;&gt;ring_attn_0_9_stage_9</title>
<path fill="none" stroke="black" d="M5508,-17889.87C5508,-17889.87 5508,-17783.25 5508,-17783.25"/>
<polygon fill="black" stroke="black" points="5511.5,-17783.25 5508,-17773.25 5504.5,-17783.25 5511.5,-17783.25"/>
</g>
<!-- ring_attn_0_10_stage_8 -->
<g id="node992" class="node">
<title>ring_attn_0_10_stage_8</title>
<polygon fill="yellow" stroke="black" points="6095,-18026 5886,-17958 6095,-17890 6304,-17958 6095,-18026"/>
<text text-anchor="middle" x="6095" y="-17976.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-17961.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="6095" y="-17946.8" font-family="Times,serif" font-size="14.00">Q[10]×K[2]×V[2]</text>
<text text-anchor="middle" x="6095" y="-17931.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_9_stage_8&#45;&gt;ring_attn_0_10_stage_8 -->
<g id="edge2137" class="edge">
<title>ring_attn_0_9_stage_8&#45;&gt;ring_attn_0_10_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-17958C5717.02,-17958 5875.86,-17958 5875.86,-17958"/>
<polygon fill="red" stroke="red" points="5875.86,-17961.5 5885.86,-17958 5875.86,-17954.5 5875.86,-17961.5"/>
</g>
<!-- ring_attn_0_9_stage_9&#45;&gt;ring_attn_0_9_stage_10 -->
<g id="edge886" class="edge">
<title>ring_attn_0_9_stage_9&#45;&gt;ring_attn_0_9_stage_10</title>
<path fill="none" stroke="black" d="M5508,-17636.87C5508,-17636.87 5508,-17530.25 5508,-17530.25"/>
<polygon fill="black" stroke="black" points="5511.5,-17530.25 5508,-17520.25 5504.5,-17530.25 5511.5,-17530.25"/>
</g>
<!-- ring_attn_0_10_stage_9 -->
<g id="node993" class="node">
<title>ring_attn_0_10_stage_9</title>
<polygon fill="yellow" stroke="black" points="6095,-17773 5886,-17705 6095,-17637 6304,-17705 6095,-17773"/>
<text text-anchor="middle" x="6095" y="-17723.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-17708.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="6095" y="-17693.8" font-family="Times,serif" font-size="14.00">Q[10]×K[1]×V[1]</text>
<text text-anchor="middle" x="6095" y="-17678.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_9_stage_9&#45;&gt;ring_attn_0_10_stage_9 -->
<g id="edge2138" class="edge">
<title>ring_attn_0_9_stage_9&#45;&gt;ring_attn_0_10_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-17705C5717.02,-17705 5875.86,-17705 5875.86,-17705"/>
<polygon fill="red" stroke="red" points="5875.86,-17708.5 5885.86,-17705 5875.86,-17701.5 5875.86,-17708.5"/>
</g>
<!-- ring_attn_0_9_stage_10&#45;&gt;ring_attn_0_9_stage_11 -->
<g id="edge887" class="edge">
<title>ring_attn_0_9_stage_10&#45;&gt;ring_attn_0_9_stage_11</title>
<path fill="none" stroke="black" d="M5508,-17383.87C5508,-17383.87 5508,-17277.25 5508,-17277.25"/>
<polygon fill="black" stroke="black" points="5511.5,-17277.25 5508,-17267.25 5504.5,-17277.25 5511.5,-17277.25"/>
</g>
<!-- ring_attn_0_10_stage_10 -->
<g id="node994" class="node">
<title>ring_attn_0_10_stage_10</title>
<polygon fill="yellow" stroke="black" points="6095,-17520 5886,-17452 6095,-17384 6304,-17452 6095,-17520"/>
<text text-anchor="middle" x="6095" y="-17470.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-17455.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="6095" y="-17440.8" font-family="Times,serif" font-size="14.00">Q[10]×K[0]×V[0]</text>
<text text-anchor="middle" x="6095" y="-17425.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_9_stage_10&#45;&gt;ring_attn_0_10_stage_10 -->
<g id="edge2139" class="edge">
<title>ring_attn_0_9_stage_10&#45;&gt;ring_attn_0_10_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-17452C5717.02,-17452 5875.86,-17452 5875.86,-17452"/>
<polygon fill="red" stroke="red" points="5875.86,-17455.5 5885.86,-17452 5875.86,-17448.5 5875.86,-17455.5"/>
</g>
<!-- ring_attn_0_9_stage_11&#45;&gt;ring_attn_0_9_stage_12 -->
<g id="edge888" class="edge">
<title>ring_attn_0_9_stage_11&#45;&gt;ring_attn_0_9_stage_12</title>
<path fill="none" stroke="black" d="M5508,-17130.87C5508,-17130.87 5508,-17024.25 5508,-17024.25"/>
<polygon fill="black" stroke="black" points="5511.5,-17024.25 5508,-17014.25 5504.5,-17024.25 5511.5,-17024.25"/>
</g>
<!-- ring_attn_0_10_stage_11 -->
<g id="node995" class="node">
<title>ring_attn_0_10_stage_11</title>
<polygon fill="yellow" stroke="black" points="6095,-17267 5886,-17199 6095,-17131 6304,-17199 6095,-17267"/>
<text text-anchor="middle" x="6095" y="-17217.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-17202.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="6095" y="-17187.8" font-family="Times,serif" font-size="14.00">Q[10]×K[15]×V[15]</text>
<text text-anchor="middle" x="6095" y="-17172.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_9_stage_11&#45;&gt;ring_attn_0_10_stage_11 -->
<g id="edge2140" class="edge">
<title>ring_attn_0_9_stage_11&#45;&gt;ring_attn_0_10_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-17199C5717.02,-17199 5875.86,-17199 5875.86,-17199"/>
<polygon fill="red" stroke="red" points="5875.86,-17202.5 5885.86,-17199 5875.86,-17195.5 5875.86,-17202.5"/>
</g>
<!-- ring_attn_0_9_stage_12&#45;&gt;ring_attn_0_9_stage_13 -->
<g id="edge889" class="edge">
<title>ring_attn_0_9_stage_12&#45;&gt;ring_attn_0_9_stage_13</title>
<path fill="none" stroke="black" d="M5508,-16877.87C5508,-16877.87 5508,-16771.25 5508,-16771.25"/>
<polygon fill="black" stroke="black" points="5511.5,-16771.25 5508,-16761.25 5504.5,-16771.25 5511.5,-16771.25"/>
</g>
<!-- ring_attn_0_10_stage_12 -->
<g id="node996" class="node">
<title>ring_attn_0_10_stage_12</title>
<polygon fill="yellow" stroke="black" points="6095,-17014 5886,-16946 6095,-16878 6304,-16946 6095,-17014"/>
<text text-anchor="middle" x="6095" y="-16964.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-16949.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="6095" y="-16934.8" font-family="Times,serif" font-size="14.00">Q[10]×K[14]×V[14]</text>
<text text-anchor="middle" x="6095" y="-16919.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_9_stage_12&#45;&gt;ring_attn_0_10_stage_12 -->
<g id="edge2141" class="edge">
<title>ring_attn_0_9_stage_12&#45;&gt;ring_attn_0_10_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-16946C5717.02,-16946 5875.86,-16946 5875.86,-16946"/>
<polygon fill="red" stroke="red" points="5875.86,-16949.5 5885.86,-16946 5875.86,-16942.5 5875.86,-16949.5"/>
</g>
<!-- ring_attn_0_9_stage_13&#45;&gt;ring_attn_0_9_stage_14 -->
<g id="edge890" class="edge">
<title>ring_attn_0_9_stage_13&#45;&gt;ring_attn_0_9_stage_14</title>
<path fill="none" stroke="black" d="M5508,-16624.87C5508,-16624.87 5508,-16518.25 5508,-16518.25"/>
<polygon fill="black" stroke="black" points="5511.5,-16518.25 5508,-16508.25 5504.5,-16518.25 5511.5,-16518.25"/>
</g>
<!-- ring_attn_0_10_stage_13 -->
<g id="node997" class="node">
<title>ring_attn_0_10_stage_13</title>
<polygon fill="yellow" stroke="black" points="6095,-16761 5886,-16693 6095,-16625 6304,-16693 6095,-16761"/>
<text text-anchor="middle" x="6095" y="-16711.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-16696.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="6095" y="-16681.8" font-family="Times,serif" font-size="14.00">Q[10]×K[13]×V[13]</text>
<text text-anchor="middle" x="6095" y="-16666.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_9_stage_13&#45;&gt;ring_attn_0_10_stage_13 -->
<g id="edge2142" class="edge">
<title>ring_attn_0_9_stage_13&#45;&gt;ring_attn_0_10_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-16693C5717.02,-16693 5875.86,-16693 5875.86,-16693"/>
<polygon fill="red" stroke="red" points="5875.86,-16696.5 5885.86,-16693 5875.86,-16689.5 5875.86,-16696.5"/>
</g>
<!-- ring_attn_0_9_stage_14&#45;&gt;ring_attn_0_9_stage_15 -->
<g id="edge891" class="edge">
<title>ring_attn_0_9_stage_14&#45;&gt;ring_attn_0_9_stage_15</title>
<path fill="none" stroke="black" d="M5508,-16371.87C5508,-16371.87 5508,-16265.25 5508,-16265.25"/>
<polygon fill="black" stroke="black" points="5511.5,-16265.25 5508,-16255.25 5504.5,-16265.25 5511.5,-16265.25"/>
</g>
<!-- ring_attn_0_10_stage_14 -->
<g id="node998" class="node">
<title>ring_attn_0_10_stage_14</title>
<polygon fill="yellow" stroke="black" points="6095,-16508 5886,-16440 6095,-16372 6304,-16440 6095,-16508"/>
<text text-anchor="middle" x="6095" y="-16458.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-16443.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="6095" y="-16428.8" font-family="Times,serif" font-size="14.00">Q[10]×K[12]×V[12]</text>
<text text-anchor="middle" x="6095" y="-16413.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_9_stage_14&#45;&gt;ring_attn_0_10_stage_14 -->
<g id="edge2143" class="edge">
<title>ring_attn_0_9_stage_14&#45;&gt;ring_attn_0_10_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-16440C5717.02,-16440 5875.86,-16440 5875.86,-16440"/>
<polygon fill="red" stroke="red" points="5875.86,-16443.5 5885.86,-16440 5875.86,-16436.5 5875.86,-16443.5"/>
</g>
<!-- attn_out_0_9 -->
<g id="node902" class="node">
<title>attn_out_0_9</title>
<polygon fill="none" stroke="black" points="5577.5,-16046 5438.5,-16046 5438.5,-15993 5577.5,-15993 5577.5,-16046"/>
<text text-anchor="middle" x="5508" y="-16030.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5508" y="-16015.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="5508" y="-16000.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_0_9_stage_15&#45;&gt;attn_out_0_9 -->
<g id="edge892" class="edge">
<title>ring_attn_0_9_stage_15&#45;&gt;attn_out_0_9</title>
<path fill="none" stroke="black" d="M5508,-16118.87C5508,-16118.87 5508,-16056.18 5508,-16056.18"/>
<polygon fill="black" stroke="black" points="5511.5,-16056.18 5508,-16046.18 5504.5,-16056.18 5511.5,-16056.18"/>
</g>
<!-- ring_attn_0_10_stage_15 -->
<g id="node999" class="node">
<title>ring_attn_0_10_stage_15</title>
<polygon fill="yellow" stroke="black" points="6095,-16255 5886,-16187 6095,-16119 6304,-16187 6095,-16255"/>
<text text-anchor="middle" x="6095" y="-16205.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-16190.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="6095" y="-16175.8" font-family="Times,serif" font-size="14.00">Q[10]×K[11]×V[11]</text>
<text text-anchor="middle" x="6095" y="-16160.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_9_stage_15&#45;&gt;ring_attn_0_10_stage_15 -->
<g id="edge2144" class="edge">
<title>ring_attn_0_9_stage_15&#45;&gt;ring_attn_0_10_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-16187C5717.02,-16187 5875.86,-16187 5875.86,-16187"/>
<polygon fill="red" stroke="red" points="5875.86,-16190.5 5885.86,-16187 5875.86,-16183.5 5875.86,-16190.5"/>
</g>
<!-- attn_residual_0_9 -->
<g id="node903" class="node">
<title>attn_residual_0_9</title>
<ellipse fill="none" stroke="black" cx="5508" cy="-15893" rx="105.5" ry="27"/>
<text text-anchor="middle" x="5508" y="-15896.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="5508" y="-15881.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_0_9&#45;&gt;attn_residual_0_9 -->
<g id="edge893" class="edge">
<title>attn_out_0_9&#45;&gt;attn_residual_0_9</title>
<path fill="none" stroke="black" d="M5508,-15992.98C5508,-15992.98 5508,-15930.36 5508,-15930.36"/>
<polygon fill="black" stroke="black" points="5511.5,-15930.36 5508,-15920.36 5504.5,-15930.36 5511.5,-15930.36"/>
</g>
<!-- ffn_up_0_9 -->
<g id="node904" class="node">
<title>ffn_up_0_9</title>
<polygon fill="none" stroke="black" points="5587,-15793 5429,-15793 5429,-15740 5587,-15740 5587,-15793"/>
<text text-anchor="middle" x="5508" y="-15777.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="5508" y="-15762.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="5508" y="-15747.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_0_9&#45;&gt;ffn_up_0_9 -->
<g id="edge894" class="edge">
<title>attn_residual_0_9&#45;&gt;ffn_up_0_9</title>
<path fill="none" stroke="black" d="M5508,-15865.86C5508,-15865.86 5508,-15803.16 5508,-15803.16"/>
<polygon fill="black" stroke="black" points="5511.5,-15803.16 5508,-15793.16 5504.5,-15803.16 5511.5,-15803.16"/>
</g>
<!-- ffn_gelu_0_9 -->
<g id="node905" class="node">
<title>ffn_gelu_0_9</title>
<ellipse fill="none" stroke="black" cx="5508" cy="-15640" rx="105.5" ry="27"/>
<text text-anchor="middle" x="5508" y="-15643.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="5508" y="-15628.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_0_9&#45;&gt;ffn_gelu_0_9 -->
<g id="edge895" class="edge">
<title>ffn_up_0_9&#45;&gt;ffn_gelu_0_9</title>
<path fill="none" stroke="black" d="M5508,-15739.98C5508,-15739.98 5508,-15677.36 5508,-15677.36"/>
<polygon fill="black" stroke="black" points="5511.5,-15677.36 5508,-15667.36 5504.5,-15677.36 5511.5,-15677.36"/>
</g>
<!-- ffn_down_0_9 -->
<g id="node906" class="node">
<title>ffn_down_0_9</title>
<polygon fill="none" stroke="black" points="5597,-15540 5419,-15540 5419,-15487 5597,-15487 5597,-15540"/>
<text text-anchor="middle" x="5508" y="-15524.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="5508" y="-15509.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="5508" y="-15494.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_0_9&#45;&gt;ffn_down_0_9 -->
<g id="edge896" class="edge">
<title>ffn_gelu_0_9&#45;&gt;ffn_down_0_9</title>
<path fill="none" stroke="black" d="M5508,-15612.86C5508,-15612.86 5508,-15550.16 5508,-15550.16"/>
<polygon fill="black" stroke="black" points="5511.5,-15550.16 5508,-15540.16 5504.5,-15550.16 5511.5,-15550.16"/>
</g>
<!-- ffn_residual_0_9 -->
<g id="node907" class="node">
<title>ffn_residual_0_9</title>
<ellipse fill="none" stroke="black" cx="5508" cy="-15387" rx="105.5" ry="27"/>
<text text-anchor="middle" x="5508" y="-15390.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="5508" y="-15375.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_0_9&#45;&gt;ffn_residual_0_9 -->
<g id="edge897" class="edge">
<title>ffn_down_0_9&#45;&gt;ffn_residual_0_9</title>
<path fill="none" stroke="black" d="M5508,-15486.98C5508,-15486.98 5508,-15424.36 5508,-15424.36"/>
<polygon fill="black" stroke="black" points="5511.5,-15424.36 5508,-15414.36 5504.5,-15424.36 5511.5,-15424.36"/>
</g>
<!-- qkv_proj_1_9 -->
<g id="node908" class="node">
<title>qkv_proj_1_9</title>
<polygon fill="none" stroke="black" points="5590.5,-15287 5425.5,-15287 5425.5,-15234 5590.5,-15234 5590.5,-15287"/>
<text text-anchor="middle" x="5508" y="-15271.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5508" y="-15256.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="5508" y="-15241.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_0_9&#45;&gt;qkv_proj_1_9 -->
<g id="edge898" class="edge">
<title>ffn_residual_0_9&#45;&gt;qkv_proj_1_9</title>
<path fill="none" stroke="black" d="M5508,-15359.86C5508,-15359.86 5508,-15297.16 5508,-15297.16"/>
<polygon fill="black" stroke="black" points="5511.5,-15297.16 5508,-15287.16 5504.5,-15297.16 5511.5,-15297.16"/>
</g>
<!-- qkv_reshape_1_9 -->
<g id="node909" class="node">
<title>qkv_reshape_1_9</title>
<ellipse fill="none" stroke="black" cx="5508" cy="-15134" rx="148" ry="27"/>
<text text-anchor="middle" x="5508" y="-15137.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="5508" y="-15122.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_1_9&#45;&gt;qkv_reshape_1_9 -->
<g id="edge899" class="edge">
<title>qkv_proj_1_9&#45;&gt;qkv_reshape_1_9</title>
<path fill="none" stroke="black" d="M5508,-15233.98C5508,-15233.98 5508,-15171.36 5508,-15171.36"/>
<polygon fill="black" stroke="black" points="5511.5,-15171.36 5508,-15161.36 5504.5,-15171.36 5511.5,-15171.36"/>
</g>
<!-- qkv_reshape_1_9&#45;&gt;ring_attn_1_9_stage_0 -->
<g id="edge900" class="edge">
<title>qkv_reshape_1_9&#45;&gt;ring_attn_1_9_stage_0</title>
<path fill="none" stroke="black" d="M5508,-15106.72C5508,-15106.72 5508,-15000.16 5508,-15000.16"/>
<polygon fill="black" stroke="black" points="5511.5,-15000.16 5508,-14990.16 5504.5,-15000.16 5511.5,-15000.16"/>
</g>
<!-- ring_attn_1_9_stage_0&#45;&gt;ring_attn_1_9_stage_1 -->
<g id="edge901" class="edge">
<title>ring_attn_1_9_stage_0&#45;&gt;ring_attn_1_9_stage_1</title>
<path fill="none" stroke="black" d="M5508,-14853.87C5508,-14853.87 5508,-14747.25 5508,-14747.25"/>
<polygon fill="black" stroke="black" points="5511.5,-14747.25 5508,-14737.25 5504.5,-14747.25 5511.5,-14747.25"/>
</g>
<!-- ring_attn_1_10_stage_0 -->
<g id="node1008" class="node">
<title>ring_attn_1_10_stage_0</title>
<polygon fill="yellow" stroke="black" points="6095,-14990 5886,-14922 6095,-14854 6304,-14922 6095,-14990"/>
<text text-anchor="middle" x="6095" y="-14940.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-14925.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="6095" y="-14910.8" font-family="Times,serif" font-size="14.00">Q[10]×K[10]×V[10]</text>
<text text-anchor="middle" x="6095" y="-14895.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_9_stage_0&#45;&gt;ring_attn_1_10_stage_0 -->
<g id="edge2145" class="edge">
<title>ring_attn_1_9_stage_0&#45;&gt;ring_attn_1_10_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-14922C5717.02,-14922 5875.86,-14922 5875.86,-14922"/>
<polygon fill="red" stroke="red" points="5875.86,-14925.5 5885.86,-14922 5875.86,-14918.5 5875.86,-14925.5"/>
</g>
<!-- ring_attn_1_9_stage_1&#45;&gt;ring_attn_1_9_stage_2 -->
<g id="edge902" class="edge">
<title>ring_attn_1_9_stage_1&#45;&gt;ring_attn_1_9_stage_2</title>
<path fill="none" stroke="black" d="M5508,-14600.87C5508,-14600.87 5508,-14494.25 5508,-14494.25"/>
<polygon fill="black" stroke="black" points="5511.5,-14494.25 5508,-14484.25 5504.5,-14494.25 5511.5,-14494.25"/>
</g>
<!-- ring_attn_1_10_stage_1 -->
<g id="node1009" class="node">
<title>ring_attn_1_10_stage_1</title>
<polygon fill="yellow" stroke="black" points="6095,-14737 5886,-14669 6095,-14601 6304,-14669 6095,-14737"/>
<text text-anchor="middle" x="6095" y="-14687.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-14672.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="6095" y="-14657.8" font-family="Times,serif" font-size="14.00">Q[10]×K[9]×V[9]</text>
<text text-anchor="middle" x="6095" y="-14642.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_9_stage_1&#45;&gt;ring_attn_1_10_stage_1 -->
<g id="edge2146" class="edge">
<title>ring_attn_1_9_stage_1&#45;&gt;ring_attn_1_10_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-14669C5717.02,-14669 5875.86,-14669 5875.86,-14669"/>
<polygon fill="red" stroke="red" points="5875.86,-14672.5 5885.86,-14669 5875.86,-14665.5 5875.86,-14672.5"/>
</g>
<!-- ring_attn_1_9_stage_2&#45;&gt;ring_attn_1_9_stage_3 -->
<g id="edge903" class="edge">
<title>ring_attn_1_9_stage_2&#45;&gt;ring_attn_1_9_stage_3</title>
<path fill="none" stroke="black" d="M5508,-14347.87C5508,-14347.87 5508,-14241.25 5508,-14241.25"/>
<polygon fill="black" stroke="black" points="5511.5,-14241.25 5508,-14231.25 5504.5,-14241.25 5511.5,-14241.25"/>
</g>
<!-- ring_attn_1_10_stage_2 -->
<g id="node1010" class="node">
<title>ring_attn_1_10_stage_2</title>
<polygon fill="yellow" stroke="black" points="6095,-14484 5886,-14416 6095,-14348 6304,-14416 6095,-14484"/>
<text text-anchor="middle" x="6095" y="-14434.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-14419.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="6095" y="-14404.8" font-family="Times,serif" font-size="14.00">Q[10]×K[8]×V[8]</text>
<text text-anchor="middle" x="6095" y="-14389.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_9_stage_2&#45;&gt;ring_attn_1_10_stage_2 -->
<g id="edge2147" class="edge">
<title>ring_attn_1_9_stage_2&#45;&gt;ring_attn_1_10_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-14416C5717.02,-14416 5875.86,-14416 5875.86,-14416"/>
<polygon fill="red" stroke="red" points="5875.86,-14419.5 5885.86,-14416 5875.86,-14412.5 5875.86,-14419.5"/>
</g>
<!-- ring_attn_1_9_stage_3&#45;&gt;ring_attn_1_9_stage_4 -->
<g id="edge904" class="edge">
<title>ring_attn_1_9_stage_3&#45;&gt;ring_attn_1_9_stage_4</title>
<path fill="none" stroke="black" d="M5508,-14094.87C5508,-14094.87 5508,-13988.25 5508,-13988.25"/>
<polygon fill="black" stroke="black" points="5511.5,-13988.25 5508,-13978.25 5504.5,-13988.25 5511.5,-13988.25"/>
</g>
<!-- ring_attn_1_10_stage_3 -->
<g id="node1011" class="node">
<title>ring_attn_1_10_stage_3</title>
<polygon fill="yellow" stroke="black" points="6095,-14231 5886,-14163 6095,-14095 6304,-14163 6095,-14231"/>
<text text-anchor="middle" x="6095" y="-14181.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-14166.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="6095" y="-14151.8" font-family="Times,serif" font-size="14.00">Q[10]×K[7]×V[7]</text>
<text text-anchor="middle" x="6095" y="-14136.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_9_stage_3&#45;&gt;ring_attn_1_10_stage_3 -->
<g id="edge2148" class="edge">
<title>ring_attn_1_9_stage_3&#45;&gt;ring_attn_1_10_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-14163C5717.02,-14163 5875.86,-14163 5875.86,-14163"/>
<polygon fill="red" stroke="red" points="5875.86,-14166.5 5885.86,-14163 5875.86,-14159.5 5875.86,-14166.5"/>
</g>
<!-- ring_attn_1_9_stage_4&#45;&gt;ring_attn_1_9_stage_5 -->
<g id="edge905" class="edge">
<title>ring_attn_1_9_stage_4&#45;&gt;ring_attn_1_9_stage_5</title>
<path fill="none" stroke="black" d="M5508,-13841.87C5508,-13841.87 5508,-13735.25 5508,-13735.25"/>
<polygon fill="black" stroke="black" points="5511.5,-13735.25 5508,-13725.25 5504.5,-13735.25 5511.5,-13735.25"/>
</g>
<!-- ring_attn_1_10_stage_4 -->
<g id="node1012" class="node">
<title>ring_attn_1_10_stage_4</title>
<polygon fill="yellow" stroke="black" points="6095,-13978 5886,-13910 6095,-13842 6304,-13910 6095,-13978"/>
<text text-anchor="middle" x="6095" y="-13928.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-13913.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="6095" y="-13898.8" font-family="Times,serif" font-size="14.00">Q[10]×K[6]×V[6]</text>
<text text-anchor="middle" x="6095" y="-13883.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_9_stage_4&#45;&gt;ring_attn_1_10_stage_4 -->
<g id="edge2149" class="edge">
<title>ring_attn_1_9_stage_4&#45;&gt;ring_attn_1_10_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-13910C5717.02,-13910 5875.86,-13910 5875.86,-13910"/>
<polygon fill="red" stroke="red" points="5875.86,-13913.5 5885.86,-13910 5875.86,-13906.5 5875.86,-13913.5"/>
</g>
<!-- ring_attn_1_9_stage_5&#45;&gt;ring_attn_1_9_stage_6 -->
<g id="edge906" class="edge">
<title>ring_attn_1_9_stage_5&#45;&gt;ring_attn_1_9_stage_6</title>
<path fill="none" stroke="black" d="M5508,-13588.87C5508,-13588.87 5508,-13482.25 5508,-13482.25"/>
<polygon fill="black" stroke="black" points="5511.5,-13482.25 5508,-13472.25 5504.5,-13482.25 5511.5,-13482.25"/>
</g>
<!-- ring_attn_1_10_stage_5 -->
<g id="node1013" class="node">
<title>ring_attn_1_10_stage_5</title>
<polygon fill="yellow" stroke="black" points="6095,-13725 5886,-13657 6095,-13589 6304,-13657 6095,-13725"/>
<text text-anchor="middle" x="6095" y="-13675.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-13660.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="6095" y="-13645.8" font-family="Times,serif" font-size="14.00">Q[10]×K[5]×V[5]</text>
<text text-anchor="middle" x="6095" y="-13630.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_9_stage_5&#45;&gt;ring_attn_1_10_stage_5 -->
<g id="edge2150" class="edge">
<title>ring_attn_1_9_stage_5&#45;&gt;ring_attn_1_10_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-13657C5717.02,-13657 5875.86,-13657 5875.86,-13657"/>
<polygon fill="red" stroke="red" points="5875.86,-13660.5 5885.86,-13657 5875.86,-13653.5 5875.86,-13660.5"/>
</g>
<!-- ring_attn_1_9_stage_6&#45;&gt;ring_attn_1_9_stage_7 -->
<g id="edge907" class="edge">
<title>ring_attn_1_9_stage_6&#45;&gt;ring_attn_1_9_stage_7</title>
<path fill="none" stroke="black" d="M5508,-13335.87C5508,-13335.87 5508,-13229.25 5508,-13229.25"/>
<polygon fill="black" stroke="black" points="5511.5,-13229.25 5508,-13219.25 5504.5,-13229.25 5511.5,-13229.25"/>
</g>
<!-- ring_attn_1_10_stage_6 -->
<g id="node1014" class="node">
<title>ring_attn_1_10_stage_6</title>
<polygon fill="yellow" stroke="black" points="6095,-13472 5886,-13404 6095,-13336 6304,-13404 6095,-13472"/>
<text text-anchor="middle" x="6095" y="-13422.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-13407.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="6095" y="-13392.8" font-family="Times,serif" font-size="14.00">Q[10]×K[4]×V[4]</text>
<text text-anchor="middle" x="6095" y="-13377.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_9_stage_6&#45;&gt;ring_attn_1_10_stage_6 -->
<g id="edge2151" class="edge">
<title>ring_attn_1_9_stage_6&#45;&gt;ring_attn_1_10_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-13404C5717.02,-13404 5875.86,-13404 5875.86,-13404"/>
<polygon fill="red" stroke="red" points="5875.86,-13407.5 5885.86,-13404 5875.86,-13400.5 5875.86,-13407.5"/>
</g>
<!-- ring_attn_1_9_stage_7&#45;&gt;ring_attn_1_9_stage_8 -->
<g id="edge908" class="edge">
<title>ring_attn_1_9_stage_7&#45;&gt;ring_attn_1_9_stage_8</title>
<path fill="none" stroke="black" d="M5508,-13082.87C5508,-13082.87 5508,-12976.25 5508,-12976.25"/>
<polygon fill="black" stroke="black" points="5511.5,-12976.25 5508,-12966.25 5504.5,-12976.25 5511.5,-12976.25"/>
</g>
<!-- ring_attn_1_10_stage_7 -->
<g id="node1015" class="node">
<title>ring_attn_1_10_stage_7</title>
<polygon fill="yellow" stroke="black" points="6095,-13219 5886,-13151 6095,-13083 6304,-13151 6095,-13219"/>
<text text-anchor="middle" x="6095" y="-13169.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-13154.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="6095" y="-13139.8" font-family="Times,serif" font-size="14.00">Q[10]×K[3]×V[3]</text>
<text text-anchor="middle" x="6095" y="-13124.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_9_stage_7&#45;&gt;ring_attn_1_10_stage_7 -->
<g id="edge2152" class="edge">
<title>ring_attn_1_9_stage_7&#45;&gt;ring_attn_1_10_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-13151C5717.02,-13151 5875.86,-13151 5875.86,-13151"/>
<polygon fill="red" stroke="red" points="5875.86,-13154.5 5885.86,-13151 5875.86,-13147.5 5875.86,-13154.5"/>
</g>
<!-- ring_attn_1_9_stage_8&#45;&gt;ring_attn_1_9_stage_9 -->
<g id="edge909" class="edge">
<title>ring_attn_1_9_stage_8&#45;&gt;ring_attn_1_9_stage_9</title>
<path fill="none" stroke="black" d="M5508,-12829.87C5508,-12829.87 5508,-12723.25 5508,-12723.25"/>
<polygon fill="black" stroke="black" points="5511.5,-12723.25 5508,-12713.25 5504.5,-12723.25 5511.5,-12723.25"/>
</g>
<!-- ring_attn_1_10_stage_8 -->
<g id="node1016" class="node">
<title>ring_attn_1_10_stage_8</title>
<polygon fill="yellow" stroke="black" points="6095,-12966 5886,-12898 6095,-12830 6304,-12898 6095,-12966"/>
<text text-anchor="middle" x="6095" y="-12916.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-12901.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="6095" y="-12886.8" font-family="Times,serif" font-size="14.00">Q[10]×K[2]×V[2]</text>
<text text-anchor="middle" x="6095" y="-12871.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_9_stage_8&#45;&gt;ring_attn_1_10_stage_8 -->
<g id="edge2153" class="edge">
<title>ring_attn_1_9_stage_8&#45;&gt;ring_attn_1_10_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-12898C5717.02,-12898 5875.86,-12898 5875.86,-12898"/>
<polygon fill="red" stroke="red" points="5875.86,-12901.5 5885.86,-12898 5875.86,-12894.5 5875.86,-12901.5"/>
</g>
<!-- ring_attn_1_9_stage_9&#45;&gt;ring_attn_1_9_stage_10 -->
<g id="edge910" class="edge">
<title>ring_attn_1_9_stage_9&#45;&gt;ring_attn_1_9_stage_10</title>
<path fill="none" stroke="black" d="M5508,-12576.87C5508,-12576.87 5508,-12470.25 5508,-12470.25"/>
<polygon fill="black" stroke="black" points="5511.5,-12470.25 5508,-12460.25 5504.5,-12470.25 5511.5,-12470.25"/>
</g>
<!-- ring_attn_1_10_stage_9 -->
<g id="node1017" class="node">
<title>ring_attn_1_10_stage_9</title>
<polygon fill="yellow" stroke="black" points="6095,-12713 5886,-12645 6095,-12577 6304,-12645 6095,-12713"/>
<text text-anchor="middle" x="6095" y="-12663.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-12648.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="6095" y="-12633.8" font-family="Times,serif" font-size="14.00">Q[10]×K[1]×V[1]</text>
<text text-anchor="middle" x="6095" y="-12618.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_9_stage_9&#45;&gt;ring_attn_1_10_stage_9 -->
<g id="edge2154" class="edge">
<title>ring_attn_1_9_stage_9&#45;&gt;ring_attn_1_10_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-12645C5717.02,-12645 5875.86,-12645 5875.86,-12645"/>
<polygon fill="red" stroke="red" points="5875.86,-12648.5 5885.86,-12645 5875.86,-12641.5 5875.86,-12648.5"/>
</g>
<!-- ring_attn_1_9_stage_10&#45;&gt;ring_attn_1_9_stage_11 -->
<g id="edge911" class="edge">
<title>ring_attn_1_9_stage_10&#45;&gt;ring_attn_1_9_stage_11</title>
<path fill="none" stroke="black" d="M5508,-12323.87C5508,-12323.87 5508,-12217.25 5508,-12217.25"/>
<polygon fill="black" stroke="black" points="5511.5,-12217.25 5508,-12207.25 5504.5,-12217.25 5511.5,-12217.25"/>
</g>
<!-- ring_attn_1_10_stage_10 -->
<g id="node1018" class="node">
<title>ring_attn_1_10_stage_10</title>
<polygon fill="yellow" stroke="black" points="6095,-12460 5886,-12392 6095,-12324 6304,-12392 6095,-12460"/>
<text text-anchor="middle" x="6095" y="-12410.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-12395.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="6095" y="-12380.8" font-family="Times,serif" font-size="14.00">Q[10]×K[0]×V[0]</text>
<text text-anchor="middle" x="6095" y="-12365.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_9_stage_10&#45;&gt;ring_attn_1_10_stage_10 -->
<g id="edge2155" class="edge">
<title>ring_attn_1_9_stage_10&#45;&gt;ring_attn_1_10_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-12392C5717.02,-12392 5875.86,-12392 5875.86,-12392"/>
<polygon fill="red" stroke="red" points="5875.86,-12395.5 5885.86,-12392 5875.86,-12388.5 5875.86,-12395.5"/>
</g>
<!-- ring_attn_1_9_stage_11&#45;&gt;ring_attn_1_9_stage_12 -->
<g id="edge912" class="edge">
<title>ring_attn_1_9_stage_11&#45;&gt;ring_attn_1_9_stage_12</title>
<path fill="none" stroke="black" d="M5508,-12070.87C5508,-12070.87 5508,-11964.25 5508,-11964.25"/>
<polygon fill="black" stroke="black" points="5511.5,-11964.25 5508,-11954.25 5504.5,-11964.25 5511.5,-11964.25"/>
</g>
<!-- ring_attn_1_10_stage_11 -->
<g id="node1019" class="node">
<title>ring_attn_1_10_stage_11</title>
<polygon fill="yellow" stroke="black" points="6095,-12207 5886,-12139 6095,-12071 6304,-12139 6095,-12207"/>
<text text-anchor="middle" x="6095" y="-12157.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-12142.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="6095" y="-12127.8" font-family="Times,serif" font-size="14.00">Q[10]×K[15]×V[15]</text>
<text text-anchor="middle" x="6095" y="-12112.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_9_stage_11&#45;&gt;ring_attn_1_10_stage_11 -->
<g id="edge2156" class="edge">
<title>ring_attn_1_9_stage_11&#45;&gt;ring_attn_1_10_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-12139C5717.02,-12139 5875.86,-12139 5875.86,-12139"/>
<polygon fill="red" stroke="red" points="5875.86,-12142.5 5885.86,-12139 5875.86,-12135.5 5875.86,-12142.5"/>
</g>
<!-- ring_attn_1_9_stage_12&#45;&gt;ring_attn_1_9_stage_13 -->
<g id="edge913" class="edge">
<title>ring_attn_1_9_stage_12&#45;&gt;ring_attn_1_9_stage_13</title>
<path fill="none" stroke="black" d="M5508,-11817.87C5508,-11817.87 5508,-11711.25 5508,-11711.25"/>
<polygon fill="black" stroke="black" points="5511.5,-11711.25 5508,-11701.25 5504.5,-11711.25 5511.5,-11711.25"/>
</g>
<!-- ring_attn_1_10_stage_12 -->
<g id="node1020" class="node">
<title>ring_attn_1_10_stage_12</title>
<polygon fill="yellow" stroke="black" points="6095,-11954 5886,-11886 6095,-11818 6304,-11886 6095,-11954"/>
<text text-anchor="middle" x="6095" y="-11904.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-11889.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="6095" y="-11874.8" font-family="Times,serif" font-size="14.00">Q[10]×K[14]×V[14]</text>
<text text-anchor="middle" x="6095" y="-11859.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_9_stage_12&#45;&gt;ring_attn_1_10_stage_12 -->
<g id="edge2157" class="edge">
<title>ring_attn_1_9_stage_12&#45;&gt;ring_attn_1_10_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-11886C5717.02,-11886 5875.86,-11886 5875.86,-11886"/>
<polygon fill="red" stroke="red" points="5875.86,-11889.5 5885.86,-11886 5875.86,-11882.5 5875.86,-11889.5"/>
</g>
<!-- ring_attn_1_9_stage_13&#45;&gt;ring_attn_1_9_stage_14 -->
<g id="edge914" class="edge">
<title>ring_attn_1_9_stage_13&#45;&gt;ring_attn_1_9_stage_14</title>
<path fill="none" stroke="black" d="M5508,-11564.87C5508,-11564.87 5508,-11458.25 5508,-11458.25"/>
<polygon fill="black" stroke="black" points="5511.5,-11458.25 5508,-11448.25 5504.5,-11458.25 5511.5,-11458.25"/>
</g>
<!-- ring_attn_1_10_stage_13 -->
<g id="node1021" class="node">
<title>ring_attn_1_10_stage_13</title>
<polygon fill="yellow" stroke="black" points="6095,-11701 5886,-11633 6095,-11565 6304,-11633 6095,-11701"/>
<text text-anchor="middle" x="6095" y="-11651.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-11636.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="6095" y="-11621.8" font-family="Times,serif" font-size="14.00">Q[10]×K[13]×V[13]</text>
<text text-anchor="middle" x="6095" y="-11606.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_9_stage_13&#45;&gt;ring_attn_1_10_stage_13 -->
<g id="edge2158" class="edge">
<title>ring_attn_1_9_stage_13&#45;&gt;ring_attn_1_10_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-11633C5717.02,-11633 5875.86,-11633 5875.86,-11633"/>
<polygon fill="red" stroke="red" points="5875.86,-11636.5 5885.86,-11633 5875.86,-11629.5 5875.86,-11636.5"/>
</g>
<!-- ring_attn_1_9_stage_14&#45;&gt;ring_attn_1_9_stage_15 -->
<g id="edge915" class="edge">
<title>ring_attn_1_9_stage_14&#45;&gt;ring_attn_1_9_stage_15</title>
<path fill="none" stroke="black" d="M5508,-11311.87C5508,-11311.87 5508,-11205.25 5508,-11205.25"/>
<polygon fill="black" stroke="black" points="5511.5,-11205.25 5508,-11195.25 5504.5,-11205.25 5511.5,-11205.25"/>
</g>
<!-- ring_attn_1_10_stage_14 -->
<g id="node1022" class="node">
<title>ring_attn_1_10_stage_14</title>
<polygon fill="yellow" stroke="black" points="6095,-11448 5886,-11380 6095,-11312 6304,-11380 6095,-11448"/>
<text text-anchor="middle" x="6095" y="-11398.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-11383.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="6095" y="-11368.8" font-family="Times,serif" font-size="14.00">Q[10]×K[12]×V[12]</text>
<text text-anchor="middle" x="6095" y="-11353.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_9_stage_14&#45;&gt;ring_attn_1_10_stage_14 -->
<g id="edge2159" class="edge">
<title>ring_attn_1_9_stage_14&#45;&gt;ring_attn_1_10_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-11380C5717.02,-11380 5875.86,-11380 5875.86,-11380"/>
<polygon fill="red" stroke="red" points="5875.86,-11383.5 5885.86,-11380 5875.86,-11376.5 5875.86,-11383.5"/>
</g>
<!-- attn_out_1_9 -->
<g id="node926" class="node">
<title>attn_out_1_9</title>
<polygon fill="none" stroke="black" points="5577.5,-10986 5438.5,-10986 5438.5,-10933 5577.5,-10933 5577.5,-10986"/>
<text text-anchor="middle" x="5508" y="-10970.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5508" y="-10955.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="5508" y="-10940.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_1_9_stage_15&#45;&gt;attn_out_1_9 -->
<g id="edge916" class="edge">
<title>ring_attn_1_9_stage_15&#45;&gt;attn_out_1_9</title>
<path fill="none" stroke="black" d="M5508,-11058.87C5508,-11058.87 5508,-10996.18 5508,-10996.18"/>
<polygon fill="black" stroke="black" points="5511.5,-10996.18 5508,-10986.18 5504.5,-10996.18 5511.5,-10996.18"/>
</g>
<!-- ring_attn_1_10_stage_15 -->
<g id="node1023" class="node">
<title>ring_attn_1_10_stage_15</title>
<polygon fill="yellow" stroke="black" points="6095,-11195 5886,-11127 6095,-11059 6304,-11127 6095,-11195"/>
<text text-anchor="middle" x="6095" y="-11145.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-11130.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="6095" y="-11115.8" font-family="Times,serif" font-size="14.00">Q[10]×K[11]×V[11]</text>
<text text-anchor="middle" x="6095" y="-11100.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_9_stage_15&#45;&gt;ring_attn_1_10_stage_15 -->
<g id="edge2160" class="edge">
<title>ring_attn_1_9_stage_15&#45;&gt;ring_attn_1_10_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-11127C5717.02,-11127 5875.86,-11127 5875.86,-11127"/>
<polygon fill="red" stroke="red" points="5875.86,-11130.5 5885.86,-11127 5875.86,-11123.5 5875.86,-11130.5"/>
</g>
<!-- attn_residual_1_9 -->
<g id="node927" class="node">
<title>attn_residual_1_9</title>
<ellipse fill="none" stroke="black" cx="5508" cy="-10833" rx="105.5" ry="27"/>
<text text-anchor="middle" x="5508" y="-10836.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="5508" y="-10821.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_1_9&#45;&gt;attn_residual_1_9 -->
<g id="edge917" class="edge">
<title>attn_out_1_9&#45;&gt;attn_residual_1_9</title>
<path fill="none" stroke="black" d="M5508,-10932.98C5508,-10932.98 5508,-10870.36 5508,-10870.36"/>
<polygon fill="black" stroke="black" points="5511.5,-10870.36 5508,-10860.36 5504.5,-10870.36 5511.5,-10870.36"/>
</g>
<!-- ffn_up_1_9 -->
<g id="node928" class="node">
<title>ffn_up_1_9</title>
<polygon fill="none" stroke="black" points="5587,-10733 5429,-10733 5429,-10680 5587,-10680 5587,-10733"/>
<text text-anchor="middle" x="5508" y="-10717.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="5508" y="-10702.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="5508" y="-10687.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_1_9&#45;&gt;ffn_up_1_9 -->
<g id="edge918" class="edge">
<title>attn_residual_1_9&#45;&gt;ffn_up_1_9</title>
<path fill="none" stroke="black" d="M5508,-10805.86C5508,-10805.86 5508,-10743.16 5508,-10743.16"/>
<polygon fill="black" stroke="black" points="5511.5,-10743.16 5508,-10733.16 5504.5,-10743.16 5511.5,-10743.16"/>
</g>
<!-- ffn_gelu_1_9 -->
<g id="node929" class="node">
<title>ffn_gelu_1_9</title>
<ellipse fill="none" stroke="black" cx="5508" cy="-10580" rx="105.5" ry="27"/>
<text text-anchor="middle" x="5508" y="-10583.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="5508" y="-10568.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_1_9&#45;&gt;ffn_gelu_1_9 -->
<g id="edge919" class="edge">
<title>ffn_up_1_9&#45;&gt;ffn_gelu_1_9</title>
<path fill="none" stroke="black" d="M5508,-10679.98C5508,-10679.98 5508,-10617.36 5508,-10617.36"/>
<polygon fill="black" stroke="black" points="5511.5,-10617.36 5508,-10607.36 5504.5,-10617.36 5511.5,-10617.36"/>
</g>
<!-- ffn_down_1_9 -->
<g id="node930" class="node">
<title>ffn_down_1_9</title>
<polygon fill="none" stroke="black" points="5597,-10480 5419,-10480 5419,-10427 5597,-10427 5597,-10480"/>
<text text-anchor="middle" x="5508" y="-10464.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="5508" y="-10449.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="5508" y="-10434.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_1_9&#45;&gt;ffn_down_1_9 -->
<g id="edge920" class="edge">
<title>ffn_gelu_1_9&#45;&gt;ffn_down_1_9</title>
<path fill="none" stroke="black" d="M5508,-10552.86C5508,-10552.86 5508,-10490.16 5508,-10490.16"/>
<polygon fill="black" stroke="black" points="5511.5,-10490.16 5508,-10480.16 5504.5,-10490.16 5511.5,-10490.16"/>
</g>
<!-- ffn_residual_1_9 -->
<g id="node931" class="node">
<title>ffn_residual_1_9</title>
<ellipse fill="none" stroke="black" cx="5508" cy="-10327" rx="105.5" ry="27"/>
<text text-anchor="middle" x="5508" y="-10330.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="5508" y="-10315.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_1_9&#45;&gt;ffn_residual_1_9 -->
<g id="edge921" class="edge">
<title>ffn_down_1_9&#45;&gt;ffn_residual_1_9</title>
<path fill="none" stroke="black" d="M5508,-10426.98C5508,-10426.98 5508,-10364.36 5508,-10364.36"/>
<polygon fill="black" stroke="black" points="5511.5,-10364.36 5508,-10354.36 5504.5,-10364.36 5511.5,-10364.36"/>
</g>
<!-- qkv_proj_2_9 -->
<g id="node932" class="node">
<title>qkv_proj_2_9</title>
<polygon fill="none" stroke="black" points="5590.5,-10227 5425.5,-10227 5425.5,-10174 5590.5,-10174 5590.5,-10227"/>
<text text-anchor="middle" x="5508" y="-10211.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5508" y="-10196.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="5508" y="-10181.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_1_9&#45;&gt;qkv_proj_2_9 -->
<g id="edge922" class="edge">
<title>ffn_residual_1_9&#45;&gt;qkv_proj_2_9</title>
<path fill="none" stroke="black" d="M5508,-10299.86C5508,-10299.86 5508,-10237.16 5508,-10237.16"/>
<polygon fill="black" stroke="black" points="5511.5,-10237.16 5508,-10227.16 5504.5,-10237.16 5511.5,-10237.16"/>
</g>
<!-- qkv_reshape_2_9 -->
<g id="node933" class="node">
<title>qkv_reshape_2_9</title>
<ellipse fill="none" stroke="black" cx="5508" cy="-10074" rx="148" ry="27"/>
<text text-anchor="middle" x="5508" y="-10077.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="5508" y="-10062.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_2_9&#45;&gt;qkv_reshape_2_9 -->
<g id="edge923" class="edge">
<title>qkv_proj_2_9&#45;&gt;qkv_reshape_2_9</title>
<path fill="none" stroke="black" d="M5508,-10173.98C5508,-10173.98 5508,-10111.36 5508,-10111.36"/>
<polygon fill="black" stroke="black" points="5511.5,-10111.36 5508,-10101.36 5504.5,-10111.36 5511.5,-10111.36"/>
</g>
<!-- qkv_reshape_2_9&#45;&gt;ring_attn_2_9_stage_0 -->
<g id="edge924" class="edge">
<title>qkv_reshape_2_9&#45;&gt;ring_attn_2_9_stage_0</title>
<path fill="none" stroke="black" d="M5508,-10046.72C5508,-10046.72 5508,-9940.16 5508,-9940.16"/>
<polygon fill="black" stroke="black" points="5511.5,-9940.16 5508,-9930.16 5504.5,-9940.16 5511.5,-9940.16"/>
</g>
<!-- ring_attn_2_9_stage_0&#45;&gt;ring_attn_2_9_stage_1 -->
<g id="edge925" class="edge">
<title>ring_attn_2_9_stage_0&#45;&gt;ring_attn_2_9_stage_1</title>
<path fill="none" stroke="black" d="M5508,-9793.87C5508,-9793.87 5508,-9687.25 5508,-9687.25"/>
<polygon fill="black" stroke="black" points="5511.5,-9687.25 5508,-9677.25 5504.5,-9687.25 5511.5,-9687.25"/>
</g>
<!-- ring_attn_2_10_stage_0 -->
<g id="node1032" class="node">
<title>ring_attn_2_10_stage_0</title>
<polygon fill="yellow" stroke="black" points="6095,-9930 5886,-9862 6095,-9794 6304,-9862 6095,-9930"/>
<text text-anchor="middle" x="6095" y="-9880.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-9865.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="6095" y="-9850.8" font-family="Times,serif" font-size="14.00">Q[10]×K[10]×V[10]</text>
<text text-anchor="middle" x="6095" y="-9835.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_9_stage_0&#45;&gt;ring_attn_2_10_stage_0 -->
<g id="edge2161" class="edge">
<title>ring_attn_2_9_stage_0&#45;&gt;ring_attn_2_10_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-9862C5717.02,-9862 5875.86,-9862 5875.86,-9862"/>
<polygon fill="red" stroke="red" points="5875.86,-9865.5 5885.86,-9862 5875.86,-9858.5 5875.86,-9865.5"/>
</g>
<!-- ring_attn_2_9_stage_1&#45;&gt;ring_attn_2_9_stage_2 -->
<g id="edge926" class="edge">
<title>ring_attn_2_9_stage_1&#45;&gt;ring_attn_2_9_stage_2</title>
<path fill="none" stroke="black" d="M5508,-9540.87C5508,-9540.87 5508,-9434.25 5508,-9434.25"/>
<polygon fill="black" stroke="black" points="5511.5,-9434.25 5508,-9424.25 5504.5,-9434.25 5511.5,-9434.25"/>
</g>
<!-- ring_attn_2_10_stage_1 -->
<g id="node1033" class="node">
<title>ring_attn_2_10_stage_1</title>
<polygon fill="yellow" stroke="black" points="6095,-9677 5886,-9609 6095,-9541 6304,-9609 6095,-9677"/>
<text text-anchor="middle" x="6095" y="-9627.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-9612.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="6095" y="-9597.8" font-family="Times,serif" font-size="14.00">Q[10]×K[9]×V[9]</text>
<text text-anchor="middle" x="6095" y="-9582.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_9_stage_1&#45;&gt;ring_attn_2_10_stage_1 -->
<g id="edge2162" class="edge">
<title>ring_attn_2_9_stage_1&#45;&gt;ring_attn_2_10_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-9609C5717.02,-9609 5875.86,-9609 5875.86,-9609"/>
<polygon fill="red" stroke="red" points="5875.86,-9612.5 5885.86,-9609 5875.86,-9605.5 5875.86,-9612.5"/>
</g>
<!-- ring_attn_2_9_stage_2&#45;&gt;ring_attn_2_9_stage_3 -->
<g id="edge927" class="edge">
<title>ring_attn_2_9_stage_2&#45;&gt;ring_attn_2_9_stage_3</title>
<path fill="none" stroke="black" d="M5508,-9287.87C5508,-9287.87 5508,-9181.25 5508,-9181.25"/>
<polygon fill="black" stroke="black" points="5511.5,-9181.25 5508,-9171.25 5504.5,-9181.25 5511.5,-9181.25"/>
</g>
<!-- ring_attn_2_10_stage_2 -->
<g id="node1034" class="node">
<title>ring_attn_2_10_stage_2</title>
<polygon fill="yellow" stroke="black" points="6095,-9424 5886,-9356 6095,-9288 6304,-9356 6095,-9424"/>
<text text-anchor="middle" x="6095" y="-9374.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-9359.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="6095" y="-9344.8" font-family="Times,serif" font-size="14.00">Q[10]×K[8]×V[8]</text>
<text text-anchor="middle" x="6095" y="-9329.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_9_stage_2&#45;&gt;ring_attn_2_10_stage_2 -->
<g id="edge2163" class="edge">
<title>ring_attn_2_9_stage_2&#45;&gt;ring_attn_2_10_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-9356C5717.02,-9356 5875.86,-9356 5875.86,-9356"/>
<polygon fill="red" stroke="red" points="5875.86,-9359.5 5885.86,-9356 5875.86,-9352.5 5875.86,-9359.5"/>
</g>
<!-- ring_attn_2_9_stage_3&#45;&gt;ring_attn_2_9_stage_4 -->
<g id="edge928" class="edge">
<title>ring_attn_2_9_stage_3&#45;&gt;ring_attn_2_9_stage_4</title>
<path fill="none" stroke="black" d="M5508,-9034.87C5508,-9034.87 5508,-8928.25 5508,-8928.25"/>
<polygon fill="black" stroke="black" points="5511.5,-8928.25 5508,-8918.25 5504.5,-8928.25 5511.5,-8928.25"/>
</g>
<!-- ring_attn_2_10_stage_3 -->
<g id="node1035" class="node">
<title>ring_attn_2_10_stage_3</title>
<polygon fill="yellow" stroke="black" points="6095,-9171 5886,-9103 6095,-9035 6304,-9103 6095,-9171"/>
<text text-anchor="middle" x="6095" y="-9121.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-9106.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="6095" y="-9091.8" font-family="Times,serif" font-size="14.00">Q[10]×K[7]×V[7]</text>
<text text-anchor="middle" x="6095" y="-9076.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_9_stage_3&#45;&gt;ring_attn_2_10_stage_3 -->
<g id="edge2164" class="edge">
<title>ring_attn_2_9_stage_3&#45;&gt;ring_attn_2_10_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-9103C5717.02,-9103 5875.86,-9103 5875.86,-9103"/>
<polygon fill="red" stroke="red" points="5875.86,-9106.5 5885.86,-9103 5875.86,-9099.5 5875.86,-9106.5"/>
</g>
<!-- ring_attn_2_9_stage_4&#45;&gt;ring_attn_2_9_stage_5 -->
<g id="edge929" class="edge">
<title>ring_attn_2_9_stage_4&#45;&gt;ring_attn_2_9_stage_5</title>
<path fill="none" stroke="black" d="M5508,-8781.87C5508,-8781.87 5508,-8675.25 5508,-8675.25"/>
<polygon fill="black" stroke="black" points="5511.5,-8675.25 5508,-8665.25 5504.5,-8675.25 5511.5,-8675.25"/>
</g>
<!-- ring_attn_2_10_stage_4 -->
<g id="node1036" class="node">
<title>ring_attn_2_10_stage_4</title>
<polygon fill="yellow" stroke="black" points="6095,-8918 5886,-8850 6095,-8782 6304,-8850 6095,-8918"/>
<text text-anchor="middle" x="6095" y="-8868.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-8853.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="6095" y="-8838.8" font-family="Times,serif" font-size="14.00">Q[10]×K[6]×V[6]</text>
<text text-anchor="middle" x="6095" y="-8823.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_9_stage_4&#45;&gt;ring_attn_2_10_stage_4 -->
<g id="edge2165" class="edge">
<title>ring_attn_2_9_stage_4&#45;&gt;ring_attn_2_10_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-8850C5717.02,-8850 5875.86,-8850 5875.86,-8850"/>
<polygon fill="red" stroke="red" points="5875.86,-8853.5 5885.86,-8850 5875.86,-8846.5 5875.86,-8853.5"/>
</g>
<!-- ring_attn_2_9_stage_5&#45;&gt;ring_attn_2_9_stage_6 -->
<g id="edge930" class="edge">
<title>ring_attn_2_9_stage_5&#45;&gt;ring_attn_2_9_stage_6</title>
<path fill="none" stroke="black" d="M5508,-8528.87C5508,-8528.87 5508,-8422.25 5508,-8422.25"/>
<polygon fill="black" stroke="black" points="5511.5,-8422.25 5508,-8412.25 5504.5,-8422.25 5511.5,-8422.25"/>
</g>
<!-- ring_attn_2_10_stage_5 -->
<g id="node1037" class="node">
<title>ring_attn_2_10_stage_5</title>
<polygon fill="yellow" stroke="black" points="6095,-8665 5886,-8597 6095,-8529 6304,-8597 6095,-8665"/>
<text text-anchor="middle" x="6095" y="-8615.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-8600.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="6095" y="-8585.8" font-family="Times,serif" font-size="14.00">Q[10]×K[5]×V[5]</text>
<text text-anchor="middle" x="6095" y="-8570.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_9_stage_5&#45;&gt;ring_attn_2_10_stage_5 -->
<g id="edge2166" class="edge">
<title>ring_attn_2_9_stage_5&#45;&gt;ring_attn_2_10_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-8597C5717.02,-8597 5875.86,-8597 5875.86,-8597"/>
<polygon fill="red" stroke="red" points="5875.86,-8600.5 5885.86,-8597 5875.86,-8593.5 5875.86,-8600.5"/>
</g>
<!-- ring_attn_2_9_stage_6&#45;&gt;ring_attn_2_9_stage_7 -->
<g id="edge931" class="edge">
<title>ring_attn_2_9_stage_6&#45;&gt;ring_attn_2_9_stage_7</title>
<path fill="none" stroke="black" d="M5508,-8275.87C5508,-8275.87 5508,-8169.25 5508,-8169.25"/>
<polygon fill="black" stroke="black" points="5511.5,-8169.25 5508,-8159.25 5504.5,-8169.25 5511.5,-8169.25"/>
</g>
<!-- ring_attn_2_10_stage_6 -->
<g id="node1038" class="node">
<title>ring_attn_2_10_stage_6</title>
<polygon fill="yellow" stroke="black" points="6095,-8412 5886,-8344 6095,-8276 6304,-8344 6095,-8412"/>
<text text-anchor="middle" x="6095" y="-8362.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-8347.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="6095" y="-8332.8" font-family="Times,serif" font-size="14.00">Q[10]×K[4]×V[4]</text>
<text text-anchor="middle" x="6095" y="-8317.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_9_stage_6&#45;&gt;ring_attn_2_10_stage_6 -->
<g id="edge2167" class="edge">
<title>ring_attn_2_9_stage_6&#45;&gt;ring_attn_2_10_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-8344C5717.02,-8344 5875.86,-8344 5875.86,-8344"/>
<polygon fill="red" stroke="red" points="5875.86,-8347.5 5885.86,-8344 5875.86,-8340.5 5875.86,-8347.5"/>
</g>
<!-- ring_attn_2_9_stage_7&#45;&gt;ring_attn_2_9_stage_8 -->
<g id="edge932" class="edge">
<title>ring_attn_2_9_stage_7&#45;&gt;ring_attn_2_9_stage_8</title>
<path fill="none" stroke="black" d="M5508,-8022.87C5508,-8022.87 5508,-7916.25 5508,-7916.25"/>
<polygon fill="black" stroke="black" points="5511.5,-7916.25 5508,-7906.25 5504.5,-7916.25 5511.5,-7916.25"/>
</g>
<!-- ring_attn_2_10_stage_7 -->
<g id="node1039" class="node">
<title>ring_attn_2_10_stage_7</title>
<polygon fill="yellow" stroke="black" points="6095,-8159 5886,-8091 6095,-8023 6304,-8091 6095,-8159"/>
<text text-anchor="middle" x="6095" y="-8109.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-8094.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="6095" y="-8079.8" font-family="Times,serif" font-size="14.00">Q[10]×K[3]×V[3]</text>
<text text-anchor="middle" x="6095" y="-8064.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_9_stage_7&#45;&gt;ring_attn_2_10_stage_7 -->
<g id="edge2168" class="edge">
<title>ring_attn_2_9_stage_7&#45;&gt;ring_attn_2_10_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-8091C5717.02,-8091 5875.86,-8091 5875.86,-8091"/>
<polygon fill="red" stroke="red" points="5875.86,-8094.5 5885.86,-8091 5875.86,-8087.5 5875.86,-8094.5"/>
</g>
<!-- ring_attn_2_9_stage_8&#45;&gt;ring_attn_2_9_stage_9 -->
<g id="edge933" class="edge">
<title>ring_attn_2_9_stage_8&#45;&gt;ring_attn_2_9_stage_9</title>
<path fill="none" stroke="black" d="M5508,-7769.87C5508,-7769.87 5508,-7663.25 5508,-7663.25"/>
<polygon fill="black" stroke="black" points="5511.5,-7663.25 5508,-7653.25 5504.5,-7663.25 5511.5,-7663.25"/>
</g>
<!-- ring_attn_2_10_stage_8 -->
<g id="node1040" class="node">
<title>ring_attn_2_10_stage_8</title>
<polygon fill="yellow" stroke="black" points="6095,-7906 5886,-7838 6095,-7770 6304,-7838 6095,-7906"/>
<text text-anchor="middle" x="6095" y="-7856.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-7841.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="6095" y="-7826.8" font-family="Times,serif" font-size="14.00">Q[10]×K[2]×V[2]</text>
<text text-anchor="middle" x="6095" y="-7811.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_9_stage_8&#45;&gt;ring_attn_2_10_stage_8 -->
<g id="edge2169" class="edge">
<title>ring_attn_2_9_stage_8&#45;&gt;ring_attn_2_10_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-7838C5717.02,-7838 5875.86,-7838 5875.86,-7838"/>
<polygon fill="red" stroke="red" points="5875.86,-7841.5 5885.86,-7838 5875.86,-7834.5 5875.86,-7841.5"/>
</g>
<!-- ring_attn_2_9_stage_9&#45;&gt;ring_attn_2_9_stage_10 -->
<g id="edge934" class="edge">
<title>ring_attn_2_9_stage_9&#45;&gt;ring_attn_2_9_stage_10</title>
<path fill="none" stroke="black" d="M5508,-7516.87C5508,-7516.87 5508,-7410.25 5508,-7410.25"/>
<polygon fill="black" stroke="black" points="5511.5,-7410.25 5508,-7400.25 5504.5,-7410.25 5511.5,-7410.25"/>
</g>
<!-- ring_attn_2_10_stage_9 -->
<g id="node1041" class="node">
<title>ring_attn_2_10_stage_9</title>
<polygon fill="yellow" stroke="black" points="6095,-7653 5886,-7585 6095,-7517 6304,-7585 6095,-7653"/>
<text text-anchor="middle" x="6095" y="-7603.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-7588.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="6095" y="-7573.8" font-family="Times,serif" font-size="14.00">Q[10]×K[1]×V[1]</text>
<text text-anchor="middle" x="6095" y="-7558.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_9_stage_9&#45;&gt;ring_attn_2_10_stage_9 -->
<g id="edge2170" class="edge">
<title>ring_attn_2_9_stage_9&#45;&gt;ring_attn_2_10_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-7585C5717.02,-7585 5875.86,-7585 5875.86,-7585"/>
<polygon fill="red" stroke="red" points="5875.86,-7588.5 5885.86,-7585 5875.86,-7581.5 5875.86,-7588.5"/>
</g>
<!-- ring_attn_2_9_stage_10&#45;&gt;ring_attn_2_9_stage_11 -->
<g id="edge935" class="edge">
<title>ring_attn_2_9_stage_10&#45;&gt;ring_attn_2_9_stage_11</title>
<path fill="none" stroke="black" d="M5508,-7263.87C5508,-7263.87 5508,-7157.25 5508,-7157.25"/>
<polygon fill="black" stroke="black" points="5511.5,-7157.25 5508,-7147.25 5504.5,-7157.25 5511.5,-7157.25"/>
</g>
<!-- ring_attn_2_10_stage_10 -->
<g id="node1042" class="node">
<title>ring_attn_2_10_stage_10</title>
<polygon fill="yellow" stroke="black" points="6095,-7400 5886,-7332 6095,-7264 6304,-7332 6095,-7400"/>
<text text-anchor="middle" x="6095" y="-7350.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-7335.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="6095" y="-7320.8" font-family="Times,serif" font-size="14.00">Q[10]×K[0]×V[0]</text>
<text text-anchor="middle" x="6095" y="-7305.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_9_stage_10&#45;&gt;ring_attn_2_10_stage_10 -->
<g id="edge2171" class="edge">
<title>ring_attn_2_9_stage_10&#45;&gt;ring_attn_2_10_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-7332C5717.02,-7332 5875.86,-7332 5875.86,-7332"/>
<polygon fill="red" stroke="red" points="5875.86,-7335.5 5885.86,-7332 5875.86,-7328.5 5875.86,-7335.5"/>
</g>
<!-- ring_attn_2_9_stage_11&#45;&gt;ring_attn_2_9_stage_12 -->
<g id="edge936" class="edge">
<title>ring_attn_2_9_stage_11&#45;&gt;ring_attn_2_9_stage_12</title>
<path fill="none" stroke="black" d="M5508,-7010.87C5508,-7010.87 5508,-6904.25 5508,-6904.25"/>
<polygon fill="black" stroke="black" points="5511.5,-6904.25 5508,-6894.25 5504.5,-6904.25 5511.5,-6904.25"/>
</g>
<!-- ring_attn_2_10_stage_11 -->
<g id="node1043" class="node">
<title>ring_attn_2_10_stage_11</title>
<polygon fill="yellow" stroke="black" points="6095,-7147 5886,-7079 6095,-7011 6304,-7079 6095,-7147"/>
<text text-anchor="middle" x="6095" y="-7097.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-7082.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="6095" y="-7067.8" font-family="Times,serif" font-size="14.00">Q[10]×K[15]×V[15]</text>
<text text-anchor="middle" x="6095" y="-7052.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_9_stage_11&#45;&gt;ring_attn_2_10_stage_11 -->
<g id="edge2172" class="edge">
<title>ring_attn_2_9_stage_11&#45;&gt;ring_attn_2_10_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-7079C5717.02,-7079 5875.86,-7079 5875.86,-7079"/>
<polygon fill="red" stroke="red" points="5875.86,-7082.5 5885.86,-7079 5875.86,-7075.5 5875.86,-7082.5"/>
</g>
<!-- ring_attn_2_9_stage_12&#45;&gt;ring_attn_2_9_stage_13 -->
<g id="edge937" class="edge">
<title>ring_attn_2_9_stage_12&#45;&gt;ring_attn_2_9_stage_13</title>
<path fill="none" stroke="black" d="M5508,-6757.87C5508,-6757.87 5508,-6651.25 5508,-6651.25"/>
<polygon fill="black" stroke="black" points="5511.5,-6651.25 5508,-6641.25 5504.5,-6651.25 5511.5,-6651.25"/>
</g>
<!-- ring_attn_2_10_stage_12 -->
<g id="node1044" class="node">
<title>ring_attn_2_10_stage_12</title>
<polygon fill="yellow" stroke="black" points="6095,-6894 5886,-6826 6095,-6758 6304,-6826 6095,-6894"/>
<text text-anchor="middle" x="6095" y="-6844.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-6829.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="6095" y="-6814.8" font-family="Times,serif" font-size="14.00">Q[10]×K[14]×V[14]</text>
<text text-anchor="middle" x="6095" y="-6799.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_9_stage_12&#45;&gt;ring_attn_2_10_stage_12 -->
<g id="edge2173" class="edge">
<title>ring_attn_2_9_stage_12&#45;&gt;ring_attn_2_10_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-6826C5717.02,-6826 5875.86,-6826 5875.86,-6826"/>
<polygon fill="red" stroke="red" points="5875.86,-6829.5 5885.86,-6826 5875.86,-6822.5 5875.86,-6829.5"/>
</g>
<!-- ring_attn_2_9_stage_13&#45;&gt;ring_attn_2_9_stage_14 -->
<g id="edge938" class="edge">
<title>ring_attn_2_9_stage_13&#45;&gt;ring_attn_2_9_stage_14</title>
<path fill="none" stroke="black" d="M5508,-6504.87C5508,-6504.87 5508,-6398.25 5508,-6398.25"/>
<polygon fill="black" stroke="black" points="5511.5,-6398.25 5508,-6388.25 5504.5,-6398.25 5511.5,-6398.25"/>
</g>
<!-- ring_attn_2_10_stage_13 -->
<g id="node1045" class="node">
<title>ring_attn_2_10_stage_13</title>
<polygon fill="yellow" stroke="black" points="6095,-6641 5886,-6573 6095,-6505 6304,-6573 6095,-6641"/>
<text text-anchor="middle" x="6095" y="-6591.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-6576.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="6095" y="-6561.8" font-family="Times,serif" font-size="14.00">Q[10]×K[13]×V[13]</text>
<text text-anchor="middle" x="6095" y="-6546.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_9_stage_13&#45;&gt;ring_attn_2_10_stage_13 -->
<g id="edge2174" class="edge">
<title>ring_attn_2_9_stage_13&#45;&gt;ring_attn_2_10_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-6573C5717.02,-6573 5875.86,-6573 5875.86,-6573"/>
<polygon fill="red" stroke="red" points="5875.86,-6576.5 5885.86,-6573 5875.86,-6569.5 5875.86,-6576.5"/>
</g>
<!-- ring_attn_2_9_stage_14&#45;&gt;ring_attn_2_9_stage_15 -->
<g id="edge939" class="edge">
<title>ring_attn_2_9_stage_14&#45;&gt;ring_attn_2_9_stage_15</title>
<path fill="none" stroke="black" d="M5508,-6251.87C5508,-6251.87 5508,-6145.25 5508,-6145.25"/>
<polygon fill="black" stroke="black" points="5511.5,-6145.25 5508,-6135.25 5504.5,-6145.25 5511.5,-6145.25"/>
</g>
<!-- ring_attn_2_10_stage_14 -->
<g id="node1046" class="node">
<title>ring_attn_2_10_stage_14</title>
<polygon fill="yellow" stroke="black" points="6095,-6388 5886,-6320 6095,-6252 6304,-6320 6095,-6388"/>
<text text-anchor="middle" x="6095" y="-6338.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-6323.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="6095" y="-6308.8" font-family="Times,serif" font-size="14.00">Q[10]×K[12]×V[12]</text>
<text text-anchor="middle" x="6095" y="-6293.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_9_stage_14&#45;&gt;ring_attn_2_10_stage_14 -->
<g id="edge2175" class="edge">
<title>ring_attn_2_9_stage_14&#45;&gt;ring_attn_2_10_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-6320C5717.02,-6320 5875.86,-6320 5875.86,-6320"/>
<polygon fill="red" stroke="red" points="5875.86,-6323.5 5885.86,-6320 5875.86,-6316.5 5875.86,-6323.5"/>
</g>
<!-- attn_out_2_9 -->
<g id="node950" class="node">
<title>attn_out_2_9</title>
<polygon fill="none" stroke="black" points="5577.5,-5926 5438.5,-5926 5438.5,-5873 5577.5,-5873 5577.5,-5926"/>
<text text-anchor="middle" x="5508" y="-5910.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5508" y="-5895.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="5508" y="-5880.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_2_9_stage_15&#45;&gt;attn_out_2_9 -->
<g id="edge940" class="edge">
<title>ring_attn_2_9_stage_15&#45;&gt;attn_out_2_9</title>
<path fill="none" stroke="black" d="M5508,-5998.87C5508,-5998.87 5508,-5936.18 5508,-5936.18"/>
<polygon fill="black" stroke="black" points="5511.5,-5936.18 5508,-5926.18 5504.5,-5936.18 5511.5,-5936.18"/>
</g>
<!-- ring_attn_2_10_stage_15 -->
<g id="node1047" class="node">
<title>ring_attn_2_10_stage_15</title>
<polygon fill="yellow" stroke="black" points="6095,-6135 5886,-6067 6095,-5999 6304,-6067 6095,-6135"/>
<text text-anchor="middle" x="6095" y="-6085.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-6070.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="6095" y="-6055.8" font-family="Times,serif" font-size="14.00">Q[10]×K[11]×V[11]</text>
<text text-anchor="middle" x="6095" y="-6040.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_9_stage_15&#45;&gt;ring_attn_2_10_stage_15 -->
<g id="edge2176" class="edge">
<title>ring_attn_2_9_stage_15&#45;&gt;ring_attn_2_10_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-6067C5717.02,-6067 5875.86,-6067 5875.86,-6067"/>
<polygon fill="red" stroke="red" points="5875.86,-6070.5 5885.86,-6067 5875.86,-6063.5 5875.86,-6070.5"/>
</g>
<!-- attn_residual_2_9 -->
<g id="node951" class="node">
<title>attn_residual_2_9</title>
<ellipse fill="none" stroke="black" cx="5508" cy="-5773" rx="105.5" ry="27"/>
<text text-anchor="middle" x="5508" y="-5776.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="5508" y="-5761.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_2_9&#45;&gt;attn_residual_2_9 -->
<g id="edge941" class="edge">
<title>attn_out_2_9&#45;&gt;attn_residual_2_9</title>
<path fill="none" stroke="black" d="M5508,-5872.98C5508,-5872.98 5508,-5810.36 5508,-5810.36"/>
<polygon fill="black" stroke="black" points="5511.5,-5810.36 5508,-5800.36 5504.5,-5810.36 5511.5,-5810.36"/>
</g>
<!-- ffn_up_2_9 -->
<g id="node952" class="node">
<title>ffn_up_2_9</title>
<polygon fill="none" stroke="black" points="5587,-5673 5429,-5673 5429,-5620 5587,-5620 5587,-5673"/>
<text text-anchor="middle" x="5508" y="-5657.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="5508" y="-5642.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="5508" y="-5627.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_2_9&#45;&gt;ffn_up_2_9 -->
<g id="edge942" class="edge">
<title>attn_residual_2_9&#45;&gt;ffn_up_2_9</title>
<path fill="none" stroke="black" d="M5508,-5745.86C5508,-5745.86 5508,-5683.16 5508,-5683.16"/>
<polygon fill="black" stroke="black" points="5511.5,-5683.16 5508,-5673.16 5504.5,-5683.16 5511.5,-5683.16"/>
</g>
<!-- ffn_gelu_2_9 -->
<g id="node953" class="node">
<title>ffn_gelu_2_9</title>
<ellipse fill="none" stroke="black" cx="5508" cy="-5520" rx="105.5" ry="27"/>
<text text-anchor="middle" x="5508" y="-5523.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="5508" y="-5508.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_2_9&#45;&gt;ffn_gelu_2_9 -->
<g id="edge943" class="edge">
<title>ffn_up_2_9&#45;&gt;ffn_gelu_2_9</title>
<path fill="none" stroke="black" d="M5508,-5619.98C5508,-5619.98 5508,-5557.36 5508,-5557.36"/>
<polygon fill="black" stroke="black" points="5511.5,-5557.36 5508,-5547.36 5504.5,-5557.36 5511.5,-5557.36"/>
</g>
<!-- ffn_down_2_9 -->
<g id="node954" class="node">
<title>ffn_down_2_9</title>
<polygon fill="none" stroke="black" points="5597,-5420 5419,-5420 5419,-5367 5597,-5367 5597,-5420"/>
<text text-anchor="middle" x="5508" y="-5404.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="5508" y="-5389.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="5508" y="-5374.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_2_9&#45;&gt;ffn_down_2_9 -->
<g id="edge944" class="edge">
<title>ffn_gelu_2_9&#45;&gt;ffn_down_2_9</title>
<path fill="none" stroke="black" d="M5508,-5492.86C5508,-5492.86 5508,-5430.16 5508,-5430.16"/>
<polygon fill="black" stroke="black" points="5511.5,-5430.16 5508,-5420.16 5504.5,-5430.16 5511.5,-5430.16"/>
</g>
<!-- ffn_residual_2_9 -->
<g id="node955" class="node">
<title>ffn_residual_2_9</title>
<ellipse fill="none" stroke="black" cx="5508" cy="-5267" rx="105.5" ry="27"/>
<text text-anchor="middle" x="5508" y="-5270.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="5508" y="-5255.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_2_9&#45;&gt;ffn_residual_2_9 -->
<g id="edge945" class="edge">
<title>ffn_down_2_9&#45;&gt;ffn_residual_2_9</title>
<path fill="none" stroke="black" d="M5508,-5366.98C5508,-5366.98 5508,-5304.36 5508,-5304.36"/>
<polygon fill="black" stroke="black" points="5511.5,-5304.36 5508,-5294.36 5504.5,-5304.36 5511.5,-5304.36"/>
</g>
<!-- qkv_proj_3_9 -->
<g id="node956" class="node">
<title>qkv_proj_3_9</title>
<polygon fill="none" stroke="black" points="5590.5,-5167 5425.5,-5167 5425.5,-5114 5590.5,-5114 5590.5,-5167"/>
<text text-anchor="middle" x="5508" y="-5151.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5508" y="-5136.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="5508" y="-5121.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_2_9&#45;&gt;qkv_proj_3_9 -->
<g id="edge946" class="edge">
<title>ffn_residual_2_9&#45;&gt;qkv_proj_3_9</title>
<path fill="none" stroke="black" d="M5508,-5239.86C5508,-5239.86 5508,-5177.16 5508,-5177.16"/>
<polygon fill="black" stroke="black" points="5511.5,-5177.16 5508,-5167.16 5504.5,-5177.16 5511.5,-5177.16"/>
</g>
<!-- qkv_reshape_3_9 -->
<g id="node957" class="node">
<title>qkv_reshape_3_9</title>
<ellipse fill="none" stroke="black" cx="5508" cy="-5014" rx="148" ry="27"/>
<text text-anchor="middle" x="5508" y="-5017.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="5508" y="-5002.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_3_9&#45;&gt;qkv_reshape_3_9 -->
<g id="edge947" class="edge">
<title>qkv_proj_3_9&#45;&gt;qkv_reshape_3_9</title>
<path fill="none" stroke="black" d="M5508,-5113.98C5508,-5113.98 5508,-5051.36 5508,-5051.36"/>
<polygon fill="black" stroke="black" points="5511.5,-5051.36 5508,-5041.36 5504.5,-5051.36 5511.5,-5051.36"/>
</g>
<!-- qkv_reshape_3_9&#45;&gt;ring_attn_3_9_stage_0 -->
<g id="edge948" class="edge">
<title>qkv_reshape_3_9&#45;&gt;ring_attn_3_9_stage_0</title>
<path fill="none" stroke="black" d="M5508,-4986.72C5508,-4986.72 5508,-4880.16 5508,-4880.16"/>
<polygon fill="black" stroke="black" points="5511.5,-4880.16 5508,-4870.16 5504.5,-4880.16 5511.5,-4880.16"/>
</g>
<!-- ring_attn_3_9_stage_0&#45;&gt;ring_attn_3_9_stage_1 -->
<g id="edge949" class="edge">
<title>ring_attn_3_9_stage_0&#45;&gt;ring_attn_3_9_stage_1</title>
<path fill="none" stroke="black" d="M5508,-4733.87C5508,-4733.87 5508,-4627.25 5508,-4627.25"/>
<polygon fill="black" stroke="black" points="5511.5,-4627.25 5508,-4617.25 5504.5,-4627.25 5511.5,-4627.25"/>
</g>
<!-- ring_attn_3_10_stage_0 -->
<g id="node1056" class="node">
<title>ring_attn_3_10_stage_0</title>
<polygon fill="yellow" stroke="black" points="6095,-4870 5886,-4802 6095,-4734 6304,-4802 6095,-4870"/>
<text text-anchor="middle" x="6095" y="-4820.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-4805.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="6095" y="-4790.8" font-family="Times,serif" font-size="14.00">Q[10]×K[10]×V[10]</text>
<text text-anchor="middle" x="6095" y="-4775.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_9_stage_0&#45;&gt;ring_attn_3_10_stage_0 -->
<g id="edge2177" class="edge">
<title>ring_attn_3_9_stage_0&#45;&gt;ring_attn_3_10_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-4802C5717.02,-4802 5875.86,-4802 5875.86,-4802"/>
<polygon fill="red" stroke="red" points="5875.86,-4805.5 5885.86,-4802 5875.86,-4798.5 5875.86,-4805.5"/>
</g>
<!-- ring_attn_3_9_stage_1&#45;&gt;ring_attn_3_9_stage_2 -->
<g id="edge950" class="edge">
<title>ring_attn_3_9_stage_1&#45;&gt;ring_attn_3_9_stage_2</title>
<path fill="none" stroke="black" d="M5508,-4480.87C5508,-4480.87 5508,-4374.25 5508,-4374.25"/>
<polygon fill="black" stroke="black" points="5511.5,-4374.25 5508,-4364.25 5504.5,-4374.25 5511.5,-4374.25"/>
</g>
<!-- ring_attn_3_10_stage_1 -->
<g id="node1057" class="node">
<title>ring_attn_3_10_stage_1</title>
<polygon fill="yellow" stroke="black" points="6095,-4617 5886,-4549 6095,-4481 6304,-4549 6095,-4617"/>
<text text-anchor="middle" x="6095" y="-4567.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-4552.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="6095" y="-4537.8" font-family="Times,serif" font-size="14.00">Q[10]×K[9]×V[9]</text>
<text text-anchor="middle" x="6095" y="-4522.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_9_stage_1&#45;&gt;ring_attn_3_10_stage_1 -->
<g id="edge2178" class="edge">
<title>ring_attn_3_9_stage_1&#45;&gt;ring_attn_3_10_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-4549C5717.02,-4549 5875.86,-4549 5875.86,-4549"/>
<polygon fill="red" stroke="red" points="5875.86,-4552.5 5885.86,-4549 5875.86,-4545.5 5875.86,-4552.5"/>
</g>
<!-- ring_attn_3_9_stage_2&#45;&gt;ring_attn_3_9_stage_3 -->
<g id="edge951" class="edge">
<title>ring_attn_3_9_stage_2&#45;&gt;ring_attn_3_9_stage_3</title>
<path fill="none" stroke="black" d="M5508,-4227.87C5508,-4227.87 5508,-4121.25 5508,-4121.25"/>
<polygon fill="black" stroke="black" points="5511.5,-4121.25 5508,-4111.25 5504.5,-4121.25 5511.5,-4121.25"/>
</g>
<!-- ring_attn_3_10_stage_2 -->
<g id="node1058" class="node">
<title>ring_attn_3_10_stage_2</title>
<polygon fill="yellow" stroke="black" points="6095,-4364 5886,-4296 6095,-4228 6304,-4296 6095,-4364"/>
<text text-anchor="middle" x="6095" y="-4314.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-4299.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="6095" y="-4284.8" font-family="Times,serif" font-size="14.00">Q[10]×K[8]×V[8]</text>
<text text-anchor="middle" x="6095" y="-4269.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_9_stage_2&#45;&gt;ring_attn_3_10_stage_2 -->
<g id="edge2179" class="edge">
<title>ring_attn_3_9_stage_2&#45;&gt;ring_attn_3_10_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-4296C5717.02,-4296 5875.86,-4296 5875.86,-4296"/>
<polygon fill="red" stroke="red" points="5875.86,-4299.5 5885.86,-4296 5875.86,-4292.5 5875.86,-4299.5"/>
</g>
<!-- ring_attn_3_9_stage_3&#45;&gt;ring_attn_3_9_stage_4 -->
<g id="edge952" class="edge">
<title>ring_attn_3_9_stage_3&#45;&gt;ring_attn_3_9_stage_4</title>
<path fill="none" stroke="black" d="M5508,-3974.87C5508,-3974.87 5508,-3868.25 5508,-3868.25"/>
<polygon fill="black" stroke="black" points="5511.5,-3868.25 5508,-3858.25 5504.5,-3868.25 5511.5,-3868.25"/>
</g>
<!-- ring_attn_3_10_stage_3 -->
<g id="node1059" class="node">
<title>ring_attn_3_10_stage_3</title>
<polygon fill="yellow" stroke="black" points="6095,-4111 5886,-4043 6095,-3975 6304,-4043 6095,-4111"/>
<text text-anchor="middle" x="6095" y="-4061.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-4046.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="6095" y="-4031.8" font-family="Times,serif" font-size="14.00">Q[10]×K[7]×V[7]</text>
<text text-anchor="middle" x="6095" y="-4016.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_9_stage_3&#45;&gt;ring_attn_3_10_stage_3 -->
<g id="edge2180" class="edge">
<title>ring_attn_3_9_stage_3&#45;&gt;ring_attn_3_10_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-4043C5717.02,-4043 5875.86,-4043 5875.86,-4043"/>
<polygon fill="red" stroke="red" points="5875.86,-4046.5 5885.86,-4043 5875.86,-4039.5 5875.86,-4046.5"/>
</g>
<!-- ring_attn_3_9_stage_4&#45;&gt;ring_attn_3_9_stage_5 -->
<g id="edge953" class="edge">
<title>ring_attn_3_9_stage_4&#45;&gt;ring_attn_3_9_stage_5</title>
<path fill="none" stroke="black" d="M5508,-3721.87C5508,-3721.87 5508,-3615.25 5508,-3615.25"/>
<polygon fill="black" stroke="black" points="5511.5,-3615.25 5508,-3605.25 5504.5,-3615.25 5511.5,-3615.25"/>
</g>
<!-- ring_attn_3_10_stage_4 -->
<g id="node1060" class="node">
<title>ring_attn_3_10_stage_4</title>
<polygon fill="yellow" stroke="black" points="6095,-3858 5886,-3790 6095,-3722 6304,-3790 6095,-3858"/>
<text text-anchor="middle" x="6095" y="-3808.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-3793.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="6095" y="-3778.8" font-family="Times,serif" font-size="14.00">Q[10]×K[6]×V[6]</text>
<text text-anchor="middle" x="6095" y="-3763.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_9_stage_4&#45;&gt;ring_attn_3_10_stage_4 -->
<g id="edge2181" class="edge">
<title>ring_attn_3_9_stage_4&#45;&gt;ring_attn_3_10_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-3790C5717.02,-3790 5875.86,-3790 5875.86,-3790"/>
<polygon fill="red" stroke="red" points="5875.86,-3793.5 5885.86,-3790 5875.86,-3786.5 5875.86,-3793.5"/>
</g>
<!-- ring_attn_3_9_stage_5&#45;&gt;ring_attn_3_9_stage_6 -->
<g id="edge954" class="edge">
<title>ring_attn_3_9_stage_5&#45;&gt;ring_attn_3_9_stage_6</title>
<path fill="none" stroke="black" d="M5508,-3468.87C5508,-3468.87 5508,-3362.25 5508,-3362.25"/>
<polygon fill="black" stroke="black" points="5511.5,-3362.25 5508,-3352.25 5504.5,-3362.25 5511.5,-3362.25"/>
</g>
<!-- ring_attn_3_10_stage_5 -->
<g id="node1061" class="node">
<title>ring_attn_3_10_stage_5</title>
<polygon fill="yellow" stroke="black" points="6095,-3605 5886,-3537 6095,-3469 6304,-3537 6095,-3605"/>
<text text-anchor="middle" x="6095" y="-3555.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-3540.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="6095" y="-3525.8" font-family="Times,serif" font-size="14.00">Q[10]×K[5]×V[5]</text>
<text text-anchor="middle" x="6095" y="-3510.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_9_stage_5&#45;&gt;ring_attn_3_10_stage_5 -->
<g id="edge2182" class="edge">
<title>ring_attn_3_9_stage_5&#45;&gt;ring_attn_3_10_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-3537C5717.02,-3537 5875.86,-3537 5875.86,-3537"/>
<polygon fill="red" stroke="red" points="5875.86,-3540.5 5885.86,-3537 5875.86,-3533.5 5875.86,-3540.5"/>
</g>
<!-- ring_attn_3_9_stage_6&#45;&gt;ring_attn_3_9_stage_7 -->
<g id="edge955" class="edge">
<title>ring_attn_3_9_stage_6&#45;&gt;ring_attn_3_9_stage_7</title>
<path fill="none" stroke="black" d="M5508,-3215.87C5508,-3215.87 5508,-3109.25 5508,-3109.25"/>
<polygon fill="black" stroke="black" points="5511.5,-3109.25 5508,-3099.25 5504.5,-3109.25 5511.5,-3109.25"/>
</g>
<!-- ring_attn_3_10_stage_6 -->
<g id="node1062" class="node">
<title>ring_attn_3_10_stage_6</title>
<polygon fill="yellow" stroke="black" points="6095,-3352 5886,-3284 6095,-3216 6304,-3284 6095,-3352"/>
<text text-anchor="middle" x="6095" y="-3302.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-3287.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="6095" y="-3272.8" font-family="Times,serif" font-size="14.00">Q[10]×K[4]×V[4]</text>
<text text-anchor="middle" x="6095" y="-3257.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_9_stage_6&#45;&gt;ring_attn_3_10_stage_6 -->
<g id="edge2183" class="edge">
<title>ring_attn_3_9_stage_6&#45;&gt;ring_attn_3_10_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-3284C5717.02,-3284 5875.86,-3284 5875.86,-3284"/>
<polygon fill="red" stroke="red" points="5875.86,-3287.5 5885.86,-3284 5875.86,-3280.5 5875.86,-3287.5"/>
</g>
<!-- ring_attn_3_9_stage_7&#45;&gt;ring_attn_3_9_stage_8 -->
<g id="edge956" class="edge">
<title>ring_attn_3_9_stage_7&#45;&gt;ring_attn_3_9_stage_8</title>
<path fill="none" stroke="black" d="M5508,-2962.87C5508,-2962.87 5508,-2856.25 5508,-2856.25"/>
<polygon fill="black" stroke="black" points="5511.5,-2856.25 5508,-2846.25 5504.5,-2856.25 5511.5,-2856.25"/>
</g>
<!-- ring_attn_3_10_stage_7 -->
<g id="node1063" class="node">
<title>ring_attn_3_10_stage_7</title>
<polygon fill="yellow" stroke="black" points="6095,-3099 5886,-3031 6095,-2963 6304,-3031 6095,-3099"/>
<text text-anchor="middle" x="6095" y="-3049.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-3034.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="6095" y="-3019.8" font-family="Times,serif" font-size="14.00">Q[10]×K[3]×V[3]</text>
<text text-anchor="middle" x="6095" y="-3004.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_9_stage_7&#45;&gt;ring_attn_3_10_stage_7 -->
<g id="edge2184" class="edge">
<title>ring_attn_3_9_stage_7&#45;&gt;ring_attn_3_10_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-3031C5717.02,-3031 5875.86,-3031 5875.86,-3031"/>
<polygon fill="red" stroke="red" points="5875.86,-3034.5 5885.86,-3031 5875.86,-3027.5 5875.86,-3034.5"/>
</g>
<!-- ring_attn_3_9_stage_8&#45;&gt;ring_attn_3_9_stage_9 -->
<g id="edge957" class="edge">
<title>ring_attn_3_9_stage_8&#45;&gt;ring_attn_3_9_stage_9</title>
<path fill="none" stroke="black" d="M5508,-2709.87C5508,-2709.87 5508,-2603.25 5508,-2603.25"/>
<polygon fill="black" stroke="black" points="5511.5,-2603.25 5508,-2593.25 5504.5,-2603.25 5511.5,-2603.25"/>
</g>
<!-- ring_attn_3_10_stage_8 -->
<g id="node1064" class="node">
<title>ring_attn_3_10_stage_8</title>
<polygon fill="yellow" stroke="black" points="6095,-2846 5886,-2778 6095,-2710 6304,-2778 6095,-2846"/>
<text text-anchor="middle" x="6095" y="-2796.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-2781.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="6095" y="-2766.8" font-family="Times,serif" font-size="14.00">Q[10]×K[2]×V[2]</text>
<text text-anchor="middle" x="6095" y="-2751.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_9_stage_8&#45;&gt;ring_attn_3_10_stage_8 -->
<g id="edge2185" class="edge">
<title>ring_attn_3_9_stage_8&#45;&gt;ring_attn_3_10_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-2778C5717.02,-2778 5875.86,-2778 5875.86,-2778"/>
<polygon fill="red" stroke="red" points="5875.86,-2781.5 5885.86,-2778 5875.86,-2774.5 5875.86,-2781.5"/>
</g>
<!-- ring_attn_3_9_stage_9&#45;&gt;ring_attn_3_9_stage_10 -->
<g id="edge958" class="edge">
<title>ring_attn_3_9_stage_9&#45;&gt;ring_attn_3_9_stage_10</title>
<path fill="none" stroke="black" d="M5508,-2456.87C5508,-2456.87 5508,-2350.25 5508,-2350.25"/>
<polygon fill="black" stroke="black" points="5511.5,-2350.25 5508,-2340.25 5504.5,-2350.25 5511.5,-2350.25"/>
</g>
<!-- ring_attn_3_10_stage_9 -->
<g id="node1065" class="node">
<title>ring_attn_3_10_stage_9</title>
<polygon fill="yellow" stroke="black" points="6095,-2593 5886,-2525 6095,-2457 6304,-2525 6095,-2593"/>
<text text-anchor="middle" x="6095" y="-2543.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-2528.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="6095" y="-2513.8" font-family="Times,serif" font-size="14.00">Q[10]×K[1]×V[1]</text>
<text text-anchor="middle" x="6095" y="-2498.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_9_stage_9&#45;&gt;ring_attn_3_10_stage_9 -->
<g id="edge2186" class="edge">
<title>ring_attn_3_9_stage_9&#45;&gt;ring_attn_3_10_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-2525C5717.02,-2525 5875.86,-2525 5875.86,-2525"/>
<polygon fill="red" stroke="red" points="5875.86,-2528.5 5885.86,-2525 5875.86,-2521.5 5875.86,-2528.5"/>
</g>
<!-- ring_attn_3_9_stage_10&#45;&gt;ring_attn_3_9_stage_11 -->
<g id="edge959" class="edge">
<title>ring_attn_3_9_stage_10&#45;&gt;ring_attn_3_9_stage_11</title>
<path fill="none" stroke="black" d="M5508,-2203.87C5508,-2203.87 5508,-2097.25 5508,-2097.25"/>
<polygon fill="black" stroke="black" points="5511.5,-2097.25 5508,-2087.25 5504.5,-2097.25 5511.5,-2097.25"/>
</g>
<!-- ring_attn_3_10_stage_10 -->
<g id="node1066" class="node">
<title>ring_attn_3_10_stage_10</title>
<polygon fill="yellow" stroke="black" points="6095,-2340 5886,-2272 6095,-2204 6304,-2272 6095,-2340"/>
<text text-anchor="middle" x="6095" y="-2290.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-2275.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="6095" y="-2260.8" font-family="Times,serif" font-size="14.00">Q[10]×K[0]×V[0]</text>
<text text-anchor="middle" x="6095" y="-2245.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_9_stage_10&#45;&gt;ring_attn_3_10_stage_10 -->
<g id="edge2187" class="edge">
<title>ring_attn_3_9_stage_10&#45;&gt;ring_attn_3_10_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-2272C5717.02,-2272 5875.86,-2272 5875.86,-2272"/>
<polygon fill="red" stroke="red" points="5875.86,-2275.5 5885.86,-2272 5875.86,-2268.5 5875.86,-2275.5"/>
</g>
<!-- ring_attn_3_9_stage_11&#45;&gt;ring_attn_3_9_stage_12 -->
<g id="edge960" class="edge">
<title>ring_attn_3_9_stage_11&#45;&gt;ring_attn_3_9_stage_12</title>
<path fill="none" stroke="black" d="M5508,-1950.87C5508,-1950.87 5508,-1844.25 5508,-1844.25"/>
<polygon fill="black" stroke="black" points="5511.5,-1844.25 5508,-1834.25 5504.5,-1844.25 5511.5,-1844.25"/>
</g>
<!-- ring_attn_3_10_stage_11 -->
<g id="node1067" class="node">
<title>ring_attn_3_10_stage_11</title>
<polygon fill="yellow" stroke="black" points="6095,-2087 5886,-2019 6095,-1951 6304,-2019 6095,-2087"/>
<text text-anchor="middle" x="6095" y="-2037.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-2022.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="6095" y="-2007.8" font-family="Times,serif" font-size="14.00">Q[10]×K[15]×V[15]</text>
<text text-anchor="middle" x="6095" y="-1992.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_9_stage_11&#45;&gt;ring_attn_3_10_stage_11 -->
<g id="edge2188" class="edge">
<title>ring_attn_3_9_stage_11&#45;&gt;ring_attn_3_10_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-2019C5717.02,-2019 5875.86,-2019 5875.86,-2019"/>
<polygon fill="red" stroke="red" points="5875.86,-2022.5 5885.86,-2019 5875.86,-2015.5 5875.86,-2022.5"/>
</g>
<!-- ring_attn_3_9_stage_12&#45;&gt;ring_attn_3_9_stage_13 -->
<g id="edge961" class="edge">
<title>ring_attn_3_9_stage_12&#45;&gt;ring_attn_3_9_stage_13</title>
<path fill="none" stroke="black" d="M5508,-1697.87C5508,-1697.87 5508,-1591.25 5508,-1591.25"/>
<polygon fill="black" stroke="black" points="5511.5,-1591.25 5508,-1581.25 5504.5,-1591.25 5511.5,-1591.25"/>
</g>
<!-- ring_attn_3_10_stage_12 -->
<g id="node1068" class="node">
<title>ring_attn_3_10_stage_12</title>
<polygon fill="yellow" stroke="black" points="6095,-1834 5886,-1766 6095,-1698 6304,-1766 6095,-1834"/>
<text text-anchor="middle" x="6095" y="-1784.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-1769.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="6095" y="-1754.8" font-family="Times,serif" font-size="14.00">Q[10]×K[14]×V[14]</text>
<text text-anchor="middle" x="6095" y="-1739.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_9_stage_12&#45;&gt;ring_attn_3_10_stage_12 -->
<g id="edge2189" class="edge">
<title>ring_attn_3_9_stage_12&#45;&gt;ring_attn_3_10_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-1766C5717.02,-1766 5875.86,-1766 5875.86,-1766"/>
<polygon fill="red" stroke="red" points="5875.86,-1769.5 5885.86,-1766 5875.86,-1762.5 5875.86,-1769.5"/>
</g>
<!-- ring_attn_3_9_stage_13&#45;&gt;ring_attn_3_9_stage_14 -->
<g id="edge962" class="edge">
<title>ring_attn_3_9_stage_13&#45;&gt;ring_attn_3_9_stage_14</title>
<path fill="none" stroke="black" d="M5508,-1444.87C5508,-1444.87 5508,-1338.25 5508,-1338.25"/>
<polygon fill="black" stroke="black" points="5511.5,-1338.25 5508,-1328.25 5504.5,-1338.25 5511.5,-1338.25"/>
</g>
<!-- ring_attn_3_10_stage_13 -->
<g id="node1069" class="node">
<title>ring_attn_3_10_stage_13</title>
<polygon fill="yellow" stroke="black" points="6095,-1581 5886,-1513 6095,-1445 6304,-1513 6095,-1581"/>
<text text-anchor="middle" x="6095" y="-1531.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-1516.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="6095" y="-1501.8" font-family="Times,serif" font-size="14.00">Q[10]×K[13]×V[13]</text>
<text text-anchor="middle" x="6095" y="-1486.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_9_stage_13&#45;&gt;ring_attn_3_10_stage_13 -->
<g id="edge2190" class="edge">
<title>ring_attn_3_9_stage_13&#45;&gt;ring_attn_3_10_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-1513C5717.02,-1513 5875.86,-1513 5875.86,-1513"/>
<polygon fill="red" stroke="red" points="5875.86,-1516.5 5885.86,-1513 5875.86,-1509.5 5875.86,-1516.5"/>
</g>
<!-- ring_attn_3_9_stage_14&#45;&gt;ring_attn_3_9_stage_15 -->
<g id="edge963" class="edge">
<title>ring_attn_3_9_stage_14&#45;&gt;ring_attn_3_9_stage_15</title>
<path fill="none" stroke="black" d="M5508,-1191.87C5508,-1191.87 5508,-1085.25 5508,-1085.25"/>
<polygon fill="black" stroke="black" points="5511.5,-1085.25 5508,-1075.25 5504.5,-1085.25 5511.5,-1085.25"/>
</g>
<!-- ring_attn_3_10_stage_14 -->
<g id="node1070" class="node">
<title>ring_attn_3_10_stage_14</title>
<polygon fill="yellow" stroke="black" points="6095,-1328 5886,-1260 6095,-1192 6304,-1260 6095,-1328"/>
<text text-anchor="middle" x="6095" y="-1278.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-1263.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="6095" y="-1248.8" font-family="Times,serif" font-size="14.00">Q[10]×K[12]×V[12]</text>
<text text-anchor="middle" x="6095" y="-1233.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_9_stage_14&#45;&gt;ring_attn_3_10_stage_14 -->
<g id="edge2191" class="edge">
<title>ring_attn_3_9_stage_14&#45;&gt;ring_attn_3_10_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-1260C5717.02,-1260 5875.86,-1260 5875.86,-1260"/>
<polygon fill="red" stroke="red" points="5875.86,-1263.5 5885.86,-1260 5875.86,-1256.5 5875.86,-1263.5"/>
</g>
<!-- attn_out_3_9 -->
<g id="node974" class="node">
<title>attn_out_3_9</title>
<polygon fill="none" stroke="black" points="5577.5,-866 5438.5,-866 5438.5,-813 5577.5,-813 5577.5,-866"/>
<text text-anchor="middle" x="5508" y="-850.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5508" y="-835.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="5508" y="-820.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_3_9_stage_15&#45;&gt;attn_out_3_9 -->
<g id="edge964" class="edge">
<title>ring_attn_3_9_stage_15&#45;&gt;attn_out_3_9</title>
<path fill="none" stroke="black" d="M5508,-938.87C5508,-938.87 5508,-876.18 5508,-876.18"/>
<polygon fill="black" stroke="black" points="5511.5,-876.18 5508,-866.18 5504.5,-876.18 5511.5,-876.18"/>
</g>
<!-- ring_attn_3_10_stage_15 -->
<g id="node1071" class="node">
<title>ring_attn_3_10_stage_15</title>
<polygon fill="yellow" stroke="black" points="6095,-1075 5886,-1007 6095,-939 6304,-1007 6095,-1075"/>
<text text-anchor="middle" x="6095" y="-1025.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6095" y="-1010.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="6095" y="-995.8" font-family="Times,serif" font-size="14.00">Q[10]×K[11]×V[11]</text>
<text text-anchor="middle" x="6095" y="-980.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_9_stage_15&#45;&gt;ring_attn_3_10_stage_15 -->
<g id="edge2192" class="edge">
<title>ring_attn_3_9_stage_15&#45;&gt;ring_attn_3_10_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5717.02,-1007C5717.02,-1007 5875.86,-1007 5875.86,-1007"/>
<polygon fill="red" stroke="red" points="5875.86,-1010.5 5885.86,-1007 5875.86,-1003.5 5875.86,-1010.5"/>
</g>
<!-- attn_residual_3_9 -->
<g id="node975" class="node">
<title>attn_residual_3_9</title>
<ellipse fill="none" stroke="black" cx="5508" cy="-713" rx="105.5" ry="27"/>
<text text-anchor="middle" x="5508" y="-716.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="5508" y="-701.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_3_9&#45;&gt;attn_residual_3_9 -->
<g id="edge965" class="edge">
<title>attn_out_3_9&#45;&gt;attn_residual_3_9</title>
<path fill="none" stroke="black" d="M5508,-812.98C5508,-812.98 5508,-750.36 5508,-750.36"/>
<polygon fill="black" stroke="black" points="5511.5,-750.36 5508,-740.36 5504.5,-750.36 5511.5,-750.36"/>
</g>
<!-- ffn_up_3_9 -->
<g id="node976" class="node">
<title>ffn_up_3_9</title>
<polygon fill="none" stroke="black" points="5587,-613 5429,-613 5429,-560 5587,-560 5587,-613"/>
<text text-anchor="middle" x="5508" y="-597.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="5508" y="-582.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="5508" y="-567.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_3_9&#45;&gt;ffn_up_3_9 -->
<g id="edge966" class="edge">
<title>attn_residual_3_9&#45;&gt;ffn_up_3_9</title>
<path fill="none" stroke="black" d="M5508,-685.86C5508,-685.86 5508,-623.16 5508,-623.16"/>
<polygon fill="black" stroke="black" points="5511.5,-623.16 5508,-613.16 5504.5,-623.16 5511.5,-623.16"/>
</g>
<!-- ffn_gelu_3_9 -->
<g id="node977" class="node">
<title>ffn_gelu_3_9</title>
<ellipse fill="none" stroke="black" cx="5508" cy="-460" rx="105.5" ry="27"/>
<text text-anchor="middle" x="5508" y="-463.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="5508" y="-448.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_3_9&#45;&gt;ffn_gelu_3_9 -->
<g id="edge967" class="edge">
<title>ffn_up_3_9&#45;&gt;ffn_gelu_3_9</title>
<path fill="none" stroke="black" d="M5508,-559.98C5508,-559.98 5508,-497.36 5508,-497.36"/>
<polygon fill="black" stroke="black" points="5511.5,-497.36 5508,-487.36 5504.5,-497.36 5511.5,-497.36"/>
</g>
<!-- ffn_down_3_9 -->
<g id="node978" class="node">
<title>ffn_down_3_9</title>
<polygon fill="none" stroke="black" points="5597,-360 5419,-360 5419,-307 5597,-307 5597,-360"/>
<text text-anchor="middle" x="5508" y="-344.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="5508" y="-329.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="5508" y="-314.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_3_9&#45;&gt;ffn_down_3_9 -->
<g id="edge968" class="edge">
<title>ffn_gelu_3_9&#45;&gt;ffn_down_3_9</title>
<path fill="none" stroke="black" d="M5508,-432.86C5508,-432.86 5508,-370.16 5508,-370.16"/>
<polygon fill="black" stroke="black" points="5511.5,-370.16 5508,-360.16 5504.5,-370.16 5511.5,-370.16"/>
</g>
<!-- ffn_residual_3_9 -->
<g id="node979" class="node">
<title>ffn_residual_3_9</title>
<ellipse fill="none" stroke="black" cx="5508" cy="-207" rx="105.5" ry="27"/>
<text text-anchor="middle" x="5508" y="-210.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="5508" y="-195.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_3_9&#45;&gt;ffn_residual_3_9 -->
<g id="edge969" class="edge">
<title>ffn_down_3_9&#45;&gt;ffn_residual_3_9</title>
<path fill="none" stroke="black" d="M5508,-306.98C5508,-306.98 5508,-244.36 5508,-244.36"/>
<polygon fill="black" stroke="black" points="5511.5,-244.36 5508,-234.36 5504.5,-244.36 5511.5,-244.36"/>
</g>
<!-- output_9 -->
<g id="node980" class="node">
<title>output_9</title>
<polygon fill="lightcoral" stroke="black" points="5601,-107 5415,-107 5415,-69 5601,-69 5601,-107"/>
<text text-anchor="middle" x="5508" y="-91.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="5508" y="-76.8" font-family="Times,serif" font-size="14.00">Y[9]: 1024×1024×4096</text>
</g>
<!-- ffn_residual_3_9&#45;&gt;output_9 -->
<g id="edge970" class="edge">
<title>ffn_residual_3_9&#45;&gt;output_9</title>
<path fill="none" stroke="black" d="M5508,-180C5508,-180 5508,-117.12 5508,-117.12"/>
<polygon fill="black" stroke="black" points="5511.5,-117.12 5508,-107.12 5504.5,-117.12 5511.5,-117.12"/>
</g>
<!-- input_10 -->
<g id="node981" class="node">
<title>input_10</title>
<polygon fill="lightgreen" stroke="black" points="6193,-20458 5997,-20458 5997,-20420 6193,-20420 6193,-20458"/>
<text text-anchor="middle" x="6095" y="-20442.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="6095" y="-20427.8" font-family="Times,serif" font-size="14.00">X[10]: 1024×1024×4096</text>
</g>
<!-- qkv_proj_0_10 -->
<g id="node982" class="node">
<title>qkv_proj_0_10</title>
<polygon fill="none" stroke="black" points="6177.5,-20347 6012.5,-20347 6012.5,-20294 6177.5,-20294 6177.5,-20347"/>
<text text-anchor="middle" x="6095" y="-20331.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6095" y="-20316.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="6095" y="-20301.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- input_10&#45;&gt;qkv_proj_0_10 -->
<g id="edge971" class="edge">
<title>input_10&#45;&gt;qkv_proj_0_10</title>
<path fill="none" stroke="black" d="M6095,-20419.96C6095,-20419.96 6095,-20357.44 6095,-20357.44"/>
<polygon fill="black" stroke="black" points="6098.5,-20357.44 6095,-20347.44 6091.5,-20357.44 6098.5,-20357.44"/>
</g>
<!-- qkv_reshape_0_10 -->
<g id="node983" class="node">
<title>qkv_reshape_0_10</title>
<ellipse fill="none" stroke="black" cx="6095" cy="-20194" rx="148" ry="27"/>
<text text-anchor="middle" x="6095" y="-20197.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="6095" y="-20182.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_0_10&#45;&gt;qkv_reshape_0_10 -->
<g id="edge972" class="edge">
<title>qkv_proj_0_10&#45;&gt;qkv_reshape_0_10</title>
<path fill="none" stroke="black" d="M6095,-20293.98C6095,-20293.98 6095,-20231.36 6095,-20231.36"/>
<polygon fill="black" stroke="black" points="6098.5,-20231.36 6095,-20221.36 6091.5,-20231.36 6098.5,-20231.36"/>
</g>
<!-- qkv_reshape_0_10&#45;&gt;ring_attn_0_10_stage_0 -->
<g id="edge973" class="edge">
<title>qkv_reshape_0_10&#45;&gt;ring_attn_0_10_stage_0</title>
<path fill="none" stroke="black" d="M6095,-20166.72C6095,-20166.72 6095,-20060.16 6095,-20060.16"/>
<polygon fill="black" stroke="black" points="6098.5,-20060.16 6095,-20050.16 6091.5,-20060.16 6098.5,-20060.16"/>
</g>
<!-- ring_attn_0_10_stage_0&#45;&gt;ring_attn_0_10_stage_1 -->
<g id="edge974" class="edge">
<title>ring_attn_0_10_stage_0&#45;&gt;ring_attn_0_10_stage_1</title>
<path fill="none" stroke="black" d="M6095,-19913.87C6095,-19913.87 6095,-19807.25 6095,-19807.25"/>
<polygon fill="black" stroke="black" points="6098.5,-19807.25 6095,-19797.25 6091.5,-19807.25 6098.5,-19807.25"/>
</g>
<!-- ring_attn_0_11_stage_0 -->
<g id="node1082" class="node">
<title>ring_attn_0_11_stage_0</title>
<polygon fill="yellow" stroke="black" points="6682,-20050 6473,-19982 6682,-19914 6891,-19982 6682,-20050"/>
<text text-anchor="middle" x="6682" y="-20000.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-19985.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="6682" y="-19970.8" font-family="Times,serif" font-size="14.00">Q[11]×K[11]×V[11]</text>
<text text-anchor="middle" x="6682" y="-19955.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_10_stage_0&#45;&gt;ring_attn_0_11_stage_0 -->
<g id="edge2193" class="edge">
<title>ring_attn_0_10_stage_0&#45;&gt;ring_attn_0_11_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-19982C6304.02,-19982 6462.86,-19982 6462.86,-19982"/>
<polygon fill="red" stroke="red" points="6462.86,-19985.5 6472.86,-19982 6462.86,-19978.5 6462.86,-19985.5"/>
</g>
<!-- ring_attn_0_10_stage_1&#45;&gt;ring_attn_0_10_stage_2 -->
<g id="edge975" class="edge">
<title>ring_attn_0_10_stage_1&#45;&gt;ring_attn_0_10_stage_2</title>
<path fill="none" stroke="black" d="M6095,-19660.87C6095,-19660.87 6095,-19554.25 6095,-19554.25"/>
<polygon fill="black" stroke="black" points="6098.5,-19554.25 6095,-19544.25 6091.5,-19554.25 6098.5,-19554.25"/>
</g>
<!-- ring_attn_0_11_stage_1 -->
<g id="node1083" class="node">
<title>ring_attn_0_11_stage_1</title>
<polygon fill="yellow" stroke="black" points="6682,-19797 6473,-19729 6682,-19661 6891,-19729 6682,-19797"/>
<text text-anchor="middle" x="6682" y="-19747.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-19732.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="6682" y="-19717.8" font-family="Times,serif" font-size="14.00">Q[11]×K[10]×V[10]</text>
<text text-anchor="middle" x="6682" y="-19702.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_10_stage_1&#45;&gt;ring_attn_0_11_stage_1 -->
<g id="edge2194" class="edge">
<title>ring_attn_0_10_stage_1&#45;&gt;ring_attn_0_11_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-19729C6304.02,-19729 6462.86,-19729 6462.86,-19729"/>
<polygon fill="red" stroke="red" points="6462.86,-19732.5 6472.86,-19729 6462.86,-19725.5 6462.86,-19732.5"/>
</g>
<!-- ring_attn_0_10_stage_2&#45;&gt;ring_attn_0_10_stage_3 -->
<g id="edge976" class="edge">
<title>ring_attn_0_10_stage_2&#45;&gt;ring_attn_0_10_stage_3</title>
<path fill="none" stroke="black" d="M6095,-19407.87C6095,-19407.87 6095,-19301.25 6095,-19301.25"/>
<polygon fill="black" stroke="black" points="6098.5,-19301.25 6095,-19291.25 6091.5,-19301.25 6098.5,-19301.25"/>
</g>
<!-- ring_attn_0_11_stage_2 -->
<g id="node1084" class="node">
<title>ring_attn_0_11_stage_2</title>
<polygon fill="yellow" stroke="black" points="6682,-19544 6473,-19476 6682,-19408 6891,-19476 6682,-19544"/>
<text text-anchor="middle" x="6682" y="-19494.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-19479.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="6682" y="-19464.8" font-family="Times,serif" font-size="14.00">Q[11]×K[9]×V[9]</text>
<text text-anchor="middle" x="6682" y="-19449.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_10_stage_2&#45;&gt;ring_attn_0_11_stage_2 -->
<g id="edge2195" class="edge">
<title>ring_attn_0_10_stage_2&#45;&gt;ring_attn_0_11_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-19476C6304.02,-19476 6462.86,-19476 6462.86,-19476"/>
<polygon fill="red" stroke="red" points="6462.86,-19479.5 6472.86,-19476 6462.86,-19472.5 6462.86,-19479.5"/>
</g>
<!-- ring_attn_0_10_stage_3&#45;&gt;ring_attn_0_10_stage_4 -->
<g id="edge977" class="edge">
<title>ring_attn_0_10_stage_3&#45;&gt;ring_attn_0_10_stage_4</title>
<path fill="none" stroke="black" d="M6095,-19154.87C6095,-19154.87 6095,-19048.25 6095,-19048.25"/>
<polygon fill="black" stroke="black" points="6098.5,-19048.25 6095,-19038.25 6091.5,-19048.25 6098.5,-19048.25"/>
</g>
<!-- ring_attn_0_11_stage_3 -->
<g id="node1085" class="node">
<title>ring_attn_0_11_stage_3</title>
<polygon fill="yellow" stroke="black" points="6682,-19291 6473,-19223 6682,-19155 6891,-19223 6682,-19291"/>
<text text-anchor="middle" x="6682" y="-19241.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-19226.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="6682" y="-19211.8" font-family="Times,serif" font-size="14.00">Q[11]×K[8]×V[8]</text>
<text text-anchor="middle" x="6682" y="-19196.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_10_stage_3&#45;&gt;ring_attn_0_11_stage_3 -->
<g id="edge2196" class="edge">
<title>ring_attn_0_10_stage_3&#45;&gt;ring_attn_0_11_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-19223C6304.02,-19223 6462.86,-19223 6462.86,-19223"/>
<polygon fill="red" stroke="red" points="6462.86,-19226.5 6472.86,-19223 6462.86,-19219.5 6462.86,-19226.5"/>
</g>
<!-- ring_attn_0_10_stage_4&#45;&gt;ring_attn_0_10_stage_5 -->
<g id="edge978" class="edge">
<title>ring_attn_0_10_stage_4&#45;&gt;ring_attn_0_10_stage_5</title>
<path fill="none" stroke="black" d="M6095,-18901.87C6095,-18901.87 6095,-18795.25 6095,-18795.25"/>
<polygon fill="black" stroke="black" points="6098.5,-18795.25 6095,-18785.25 6091.5,-18795.25 6098.5,-18795.25"/>
</g>
<!-- ring_attn_0_11_stage_4 -->
<g id="node1086" class="node">
<title>ring_attn_0_11_stage_4</title>
<polygon fill="yellow" stroke="black" points="6682,-19038 6473,-18970 6682,-18902 6891,-18970 6682,-19038"/>
<text text-anchor="middle" x="6682" y="-18988.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-18973.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="6682" y="-18958.8" font-family="Times,serif" font-size="14.00">Q[11]×K[7]×V[7]</text>
<text text-anchor="middle" x="6682" y="-18943.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_10_stage_4&#45;&gt;ring_attn_0_11_stage_4 -->
<g id="edge2197" class="edge">
<title>ring_attn_0_10_stage_4&#45;&gt;ring_attn_0_11_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-18970C6304.02,-18970 6462.86,-18970 6462.86,-18970"/>
<polygon fill="red" stroke="red" points="6462.86,-18973.5 6472.86,-18970 6462.86,-18966.5 6462.86,-18973.5"/>
</g>
<!-- ring_attn_0_10_stage_5&#45;&gt;ring_attn_0_10_stage_6 -->
<g id="edge979" class="edge">
<title>ring_attn_0_10_stage_5&#45;&gt;ring_attn_0_10_stage_6</title>
<path fill="none" stroke="black" d="M6095,-18648.87C6095,-18648.87 6095,-18542.25 6095,-18542.25"/>
<polygon fill="black" stroke="black" points="6098.5,-18542.25 6095,-18532.25 6091.5,-18542.25 6098.5,-18542.25"/>
</g>
<!-- ring_attn_0_11_stage_5 -->
<g id="node1087" class="node">
<title>ring_attn_0_11_stage_5</title>
<polygon fill="yellow" stroke="black" points="6682,-18785 6473,-18717 6682,-18649 6891,-18717 6682,-18785"/>
<text text-anchor="middle" x="6682" y="-18735.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-18720.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="6682" y="-18705.8" font-family="Times,serif" font-size="14.00">Q[11]×K[6]×V[6]</text>
<text text-anchor="middle" x="6682" y="-18690.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_10_stage_5&#45;&gt;ring_attn_0_11_stage_5 -->
<g id="edge2198" class="edge">
<title>ring_attn_0_10_stage_5&#45;&gt;ring_attn_0_11_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-18717C6304.02,-18717 6462.86,-18717 6462.86,-18717"/>
<polygon fill="red" stroke="red" points="6462.86,-18720.5 6472.86,-18717 6462.86,-18713.5 6462.86,-18720.5"/>
</g>
<!-- ring_attn_0_10_stage_6&#45;&gt;ring_attn_0_10_stage_7 -->
<g id="edge980" class="edge">
<title>ring_attn_0_10_stage_6&#45;&gt;ring_attn_0_10_stage_7</title>
<path fill="none" stroke="black" d="M6095,-18395.87C6095,-18395.87 6095,-18289.25 6095,-18289.25"/>
<polygon fill="black" stroke="black" points="6098.5,-18289.25 6095,-18279.25 6091.5,-18289.25 6098.5,-18289.25"/>
</g>
<!-- ring_attn_0_11_stage_6 -->
<g id="node1088" class="node">
<title>ring_attn_0_11_stage_6</title>
<polygon fill="yellow" stroke="black" points="6682,-18532 6473,-18464 6682,-18396 6891,-18464 6682,-18532"/>
<text text-anchor="middle" x="6682" y="-18482.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-18467.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="6682" y="-18452.8" font-family="Times,serif" font-size="14.00">Q[11]×K[5]×V[5]</text>
<text text-anchor="middle" x="6682" y="-18437.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_10_stage_6&#45;&gt;ring_attn_0_11_stage_6 -->
<g id="edge2199" class="edge">
<title>ring_attn_0_10_stage_6&#45;&gt;ring_attn_0_11_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-18464C6304.02,-18464 6462.86,-18464 6462.86,-18464"/>
<polygon fill="red" stroke="red" points="6462.86,-18467.5 6472.86,-18464 6462.86,-18460.5 6462.86,-18467.5"/>
</g>
<!-- ring_attn_0_10_stage_7&#45;&gt;ring_attn_0_10_stage_8 -->
<g id="edge981" class="edge">
<title>ring_attn_0_10_stage_7&#45;&gt;ring_attn_0_10_stage_8</title>
<path fill="none" stroke="black" d="M6095,-18142.87C6095,-18142.87 6095,-18036.25 6095,-18036.25"/>
<polygon fill="black" stroke="black" points="6098.5,-18036.25 6095,-18026.25 6091.5,-18036.25 6098.5,-18036.25"/>
</g>
<!-- ring_attn_0_11_stage_7 -->
<g id="node1089" class="node">
<title>ring_attn_0_11_stage_7</title>
<polygon fill="yellow" stroke="black" points="6682,-18279 6473,-18211 6682,-18143 6891,-18211 6682,-18279"/>
<text text-anchor="middle" x="6682" y="-18229.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-18214.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="6682" y="-18199.8" font-family="Times,serif" font-size="14.00">Q[11]×K[4]×V[4]</text>
<text text-anchor="middle" x="6682" y="-18184.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_10_stage_7&#45;&gt;ring_attn_0_11_stage_7 -->
<g id="edge2200" class="edge">
<title>ring_attn_0_10_stage_7&#45;&gt;ring_attn_0_11_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-18211C6304.02,-18211 6462.86,-18211 6462.86,-18211"/>
<polygon fill="red" stroke="red" points="6462.86,-18214.5 6472.86,-18211 6462.86,-18207.5 6462.86,-18214.5"/>
</g>
<!-- ring_attn_0_10_stage_8&#45;&gt;ring_attn_0_10_stage_9 -->
<g id="edge982" class="edge">
<title>ring_attn_0_10_stage_8&#45;&gt;ring_attn_0_10_stage_9</title>
<path fill="none" stroke="black" d="M6095,-17889.87C6095,-17889.87 6095,-17783.25 6095,-17783.25"/>
<polygon fill="black" stroke="black" points="6098.5,-17783.25 6095,-17773.25 6091.5,-17783.25 6098.5,-17783.25"/>
</g>
<!-- ring_attn_0_11_stage_8 -->
<g id="node1090" class="node">
<title>ring_attn_0_11_stage_8</title>
<polygon fill="yellow" stroke="black" points="6682,-18026 6473,-17958 6682,-17890 6891,-17958 6682,-18026"/>
<text text-anchor="middle" x="6682" y="-17976.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-17961.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="6682" y="-17946.8" font-family="Times,serif" font-size="14.00">Q[11]×K[3]×V[3]</text>
<text text-anchor="middle" x="6682" y="-17931.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_10_stage_8&#45;&gt;ring_attn_0_11_stage_8 -->
<g id="edge2201" class="edge">
<title>ring_attn_0_10_stage_8&#45;&gt;ring_attn_0_11_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-17958C6304.02,-17958 6462.86,-17958 6462.86,-17958"/>
<polygon fill="red" stroke="red" points="6462.86,-17961.5 6472.86,-17958 6462.86,-17954.5 6462.86,-17961.5"/>
</g>
<!-- ring_attn_0_10_stage_9&#45;&gt;ring_attn_0_10_stage_10 -->
<g id="edge983" class="edge">
<title>ring_attn_0_10_stage_9&#45;&gt;ring_attn_0_10_stage_10</title>
<path fill="none" stroke="black" d="M6095,-17636.87C6095,-17636.87 6095,-17530.25 6095,-17530.25"/>
<polygon fill="black" stroke="black" points="6098.5,-17530.25 6095,-17520.25 6091.5,-17530.25 6098.5,-17530.25"/>
</g>
<!-- ring_attn_0_11_stage_9 -->
<g id="node1091" class="node">
<title>ring_attn_0_11_stage_9</title>
<polygon fill="yellow" stroke="black" points="6682,-17773 6473,-17705 6682,-17637 6891,-17705 6682,-17773"/>
<text text-anchor="middle" x="6682" y="-17723.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-17708.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="6682" y="-17693.8" font-family="Times,serif" font-size="14.00">Q[11]×K[2]×V[2]</text>
<text text-anchor="middle" x="6682" y="-17678.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_10_stage_9&#45;&gt;ring_attn_0_11_stage_9 -->
<g id="edge2202" class="edge">
<title>ring_attn_0_10_stage_9&#45;&gt;ring_attn_0_11_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-17705C6304.02,-17705 6462.86,-17705 6462.86,-17705"/>
<polygon fill="red" stroke="red" points="6462.86,-17708.5 6472.86,-17705 6462.86,-17701.5 6462.86,-17708.5"/>
</g>
<!-- ring_attn_0_10_stage_10&#45;&gt;ring_attn_0_10_stage_11 -->
<g id="edge984" class="edge">
<title>ring_attn_0_10_stage_10&#45;&gt;ring_attn_0_10_stage_11</title>
<path fill="none" stroke="black" d="M6095,-17383.87C6095,-17383.87 6095,-17277.25 6095,-17277.25"/>
<polygon fill="black" stroke="black" points="6098.5,-17277.25 6095,-17267.25 6091.5,-17277.25 6098.5,-17277.25"/>
</g>
<!-- ring_attn_0_11_stage_10 -->
<g id="node1092" class="node">
<title>ring_attn_0_11_stage_10</title>
<polygon fill="yellow" stroke="black" points="6682,-17520 6473,-17452 6682,-17384 6891,-17452 6682,-17520"/>
<text text-anchor="middle" x="6682" y="-17470.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-17455.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="6682" y="-17440.8" font-family="Times,serif" font-size="14.00">Q[11]×K[1]×V[1]</text>
<text text-anchor="middle" x="6682" y="-17425.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_10_stage_10&#45;&gt;ring_attn_0_11_stage_10 -->
<g id="edge2203" class="edge">
<title>ring_attn_0_10_stage_10&#45;&gt;ring_attn_0_11_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-17452C6304.02,-17452 6462.86,-17452 6462.86,-17452"/>
<polygon fill="red" stroke="red" points="6462.86,-17455.5 6472.86,-17452 6462.86,-17448.5 6462.86,-17455.5"/>
</g>
<!-- ring_attn_0_10_stage_11&#45;&gt;ring_attn_0_10_stage_12 -->
<g id="edge985" class="edge">
<title>ring_attn_0_10_stage_11&#45;&gt;ring_attn_0_10_stage_12</title>
<path fill="none" stroke="black" d="M6095,-17130.87C6095,-17130.87 6095,-17024.25 6095,-17024.25"/>
<polygon fill="black" stroke="black" points="6098.5,-17024.25 6095,-17014.25 6091.5,-17024.25 6098.5,-17024.25"/>
</g>
<!-- ring_attn_0_11_stage_11 -->
<g id="node1093" class="node">
<title>ring_attn_0_11_stage_11</title>
<polygon fill="yellow" stroke="black" points="6682,-17267 6473,-17199 6682,-17131 6891,-17199 6682,-17267"/>
<text text-anchor="middle" x="6682" y="-17217.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-17202.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="6682" y="-17187.8" font-family="Times,serif" font-size="14.00">Q[11]×K[0]×V[0]</text>
<text text-anchor="middle" x="6682" y="-17172.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_10_stage_11&#45;&gt;ring_attn_0_11_stage_11 -->
<g id="edge2204" class="edge">
<title>ring_attn_0_10_stage_11&#45;&gt;ring_attn_0_11_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-17199C6304.02,-17199 6462.86,-17199 6462.86,-17199"/>
<polygon fill="red" stroke="red" points="6462.86,-17202.5 6472.86,-17199 6462.86,-17195.5 6462.86,-17202.5"/>
</g>
<!-- ring_attn_0_10_stage_12&#45;&gt;ring_attn_0_10_stage_13 -->
<g id="edge986" class="edge">
<title>ring_attn_0_10_stage_12&#45;&gt;ring_attn_0_10_stage_13</title>
<path fill="none" stroke="black" d="M6095,-16877.87C6095,-16877.87 6095,-16771.25 6095,-16771.25"/>
<polygon fill="black" stroke="black" points="6098.5,-16771.25 6095,-16761.25 6091.5,-16771.25 6098.5,-16771.25"/>
</g>
<!-- ring_attn_0_11_stage_12 -->
<g id="node1094" class="node">
<title>ring_attn_0_11_stage_12</title>
<polygon fill="yellow" stroke="black" points="6682,-17014 6473,-16946 6682,-16878 6891,-16946 6682,-17014"/>
<text text-anchor="middle" x="6682" y="-16964.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-16949.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="6682" y="-16934.8" font-family="Times,serif" font-size="14.00">Q[11]×K[15]×V[15]</text>
<text text-anchor="middle" x="6682" y="-16919.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_10_stage_12&#45;&gt;ring_attn_0_11_stage_12 -->
<g id="edge2205" class="edge">
<title>ring_attn_0_10_stage_12&#45;&gt;ring_attn_0_11_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-16946C6304.02,-16946 6462.86,-16946 6462.86,-16946"/>
<polygon fill="red" stroke="red" points="6462.86,-16949.5 6472.86,-16946 6462.86,-16942.5 6462.86,-16949.5"/>
</g>
<!-- ring_attn_0_10_stage_13&#45;&gt;ring_attn_0_10_stage_14 -->
<g id="edge987" class="edge">
<title>ring_attn_0_10_stage_13&#45;&gt;ring_attn_0_10_stage_14</title>
<path fill="none" stroke="black" d="M6095,-16624.87C6095,-16624.87 6095,-16518.25 6095,-16518.25"/>
<polygon fill="black" stroke="black" points="6098.5,-16518.25 6095,-16508.25 6091.5,-16518.25 6098.5,-16518.25"/>
</g>
<!-- ring_attn_0_11_stage_13 -->
<g id="node1095" class="node">
<title>ring_attn_0_11_stage_13</title>
<polygon fill="yellow" stroke="black" points="6682,-16761 6473,-16693 6682,-16625 6891,-16693 6682,-16761"/>
<text text-anchor="middle" x="6682" y="-16711.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-16696.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="6682" y="-16681.8" font-family="Times,serif" font-size="14.00">Q[11]×K[14]×V[14]</text>
<text text-anchor="middle" x="6682" y="-16666.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_10_stage_13&#45;&gt;ring_attn_0_11_stage_13 -->
<g id="edge2206" class="edge">
<title>ring_attn_0_10_stage_13&#45;&gt;ring_attn_0_11_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-16693C6304.02,-16693 6462.86,-16693 6462.86,-16693"/>
<polygon fill="red" stroke="red" points="6462.86,-16696.5 6472.86,-16693 6462.86,-16689.5 6462.86,-16696.5"/>
</g>
<!-- ring_attn_0_10_stage_14&#45;&gt;ring_attn_0_10_stage_15 -->
<g id="edge988" class="edge">
<title>ring_attn_0_10_stage_14&#45;&gt;ring_attn_0_10_stage_15</title>
<path fill="none" stroke="black" d="M6095,-16371.87C6095,-16371.87 6095,-16265.25 6095,-16265.25"/>
<polygon fill="black" stroke="black" points="6098.5,-16265.25 6095,-16255.25 6091.5,-16265.25 6098.5,-16265.25"/>
</g>
<!-- ring_attn_0_11_stage_14 -->
<g id="node1096" class="node">
<title>ring_attn_0_11_stage_14</title>
<polygon fill="yellow" stroke="black" points="6682,-16508 6473,-16440 6682,-16372 6891,-16440 6682,-16508"/>
<text text-anchor="middle" x="6682" y="-16458.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-16443.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="6682" y="-16428.8" font-family="Times,serif" font-size="14.00">Q[11]×K[13]×V[13]</text>
<text text-anchor="middle" x="6682" y="-16413.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_10_stage_14&#45;&gt;ring_attn_0_11_stage_14 -->
<g id="edge2207" class="edge">
<title>ring_attn_0_10_stage_14&#45;&gt;ring_attn_0_11_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-16440C6304.02,-16440 6462.86,-16440 6462.86,-16440"/>
<polygon fill="red" stroke="red" points="6462.86,-16443.5 6472.86,-16440 6462.86,-16436.5 6462.86,-16443.5"/>
</g>
<!-- attn_out_0_10 -->
<g id="node1000" class="node">
<title>attn_out_0_10</title>
<polygon fill="none" stroke="black" points="6164.5,-16046 6025.5,-16046 6025.5,-15993 6164.5,-15993 6164.5,-16046"/>
<text text-anchor="middle" x="6095" y="-16030.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6095" y="-16015.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="6095" y="-16000.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_0_10_stage_15&#45;&gt;attn_out_0_10 -->
<g id="edge989" class="edge">
<title>ring_attn_0_10_stage_15&#45;&gt;attn_out_0_10</title>
<path fill="none" stroke="black" d="M6095,-16118.87C6095,-16118.87 6095,-16056.18 6095,-16056.18"/>
<polygon fill="black" stroke="black" points="6098.5,-16056.18 6095,-16046.18 6091.5,-16056.18 6098.5,-16056.18"/>
</g>
<!-- ring_attn_0_11_stage_15 -->
<g id="node1097" class="node">
<title>ring_attn_0_11_stage_15</title>
<polygon fill="yellow" stroke="black" points="6682,-16255 6473,-16187 6682,-16119 6891,-16187 6682,-16255"/>
<text text-anchor="middle" x="6682" y="-16205.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-16190.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="6682" y="-16175.8" font-family="Times,serif" font-size="14.00">Q[11]×K[12]×V[12]</text>
<text text-anchor="middle" x="6682" y="-16160.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_10_stage_15&#45;&gt;ring_attn_0_11_stage_15 -->
<g id="edge2208" class="edge">
<title>ring_attn_0_10_stage_15&#45;&gt;ring_attn_0_11_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-16187C6304.02,-16187 6462.86,-16187 6462.86,-16187"/>
<polygon fill="red" stroke="red" points="6462.86,-16190.5 6472.86,-16187 6462.86,-16183.5 6462.86,-16190.5"/>
</g>
<!-- attn_residual_0_10 -->
<g id="node1001" class="node">
<title>attn_residual_0_10</title>
<ellipse fill="none" stroke="black" cx="6095" cy="-15893" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6095" y="-15896.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="6095" y="-15881.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_0_10&#45;&gt;attn_residual_0_10 -->
<g id="edge990" class="edge">
<title>attn_out_0_10&#45;&gt;attn_residual_0_10</title>
<path fill="none" stroke="black" d="M6095,-15992.98C6095,-15992.98 6095,-15930.36 6095,-15930.36"/>
<polygon fill="black" stroke="black" points="6098.5,-15930.36 6095,-15920.36 6091.5,-15930.36 6098.5,-15930.36"/>
</g>
<!-- ffn_up_0_10 -->
<g id="node1002" class="node">
<title>ffn_up_0_10</title>
<polygon fill="none" stroke="black" points="6174,-15793 6016,-15793 6016,-15740 6174,-15740 6174,-15793"/>
<text text-anchor="middle" x="6095" y="-15777.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="6095" y="-15762.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="6095" y="-15747.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_0_10&#45;&gt;ffn_up_0_10 -->
<g id="edge991" class="edge">
<title>attn_residual_0_10&#45;&gt;ffn_up_0_10</title>
<path fill="none" stroke="black" d="M6095,-15865.86C6095,-15865.86 6095,-15803.16 6095,-15803.16"/>
<polygon fill="black" stroke="black" points="6098.5,-15803.16 6095,-15793.16 6091.5,-15803.16 6098.5,-15803.16"/>
</g>
<!-- ffn_gelu_0_10 -->
<g id="node1003" class="node">
<title>ffn_gelu_0_10</title>
<ellipse fill="none" stroke="black" cx="6095" cy="-15640" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6095" y="-15643.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="6095" y="-15628.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_0_10&#45;&gt;ffn_gelu_0_10 -->
<g id="edge992" class="edge">
<title>ffn_up_0_10&#45;&gt;ffn_gelu_0_10</title>
<path fill="none" stroke="black" d="M6095,-15739.98C6095,-15739.98 6095,-15677.36 6095,-15677.36"/>
<polygon fill="black" stroke="black" points="6098.5,-15677.36 6095,-15667.36 6091.5,-15677.36 6098.5,-15677.36"/>
</g>
<!-- ffn_down_0_10 -->
<g id="node1004" class="node">
<title>ffn_down_0_10</title>
<polygon fill="none" stroke="black" points="6184,-15540 6006,-15540 6006,-15487 6184,-15487 6184,-15540"/>
<text text-anchor="middle" x="6095" y="-15524.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6095" y="-15509.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="6095" y="-15494.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_0_10&#45;&gt;ffn_down_0_10 -->
<g id="edge993" class="edge">
<title>ffn_gelu_0_10&#45;&gt;ffn_down_0_10</title>
<path fill="none" stroke="black" d="M6095,-15612.86C6095,-15612.86 6095,-15550.16 6095,-15550.16"/>
<polygon fill="black" stroke="black" points="6098.5,-15550.16 6095,-15540.16 6091.5,-15550.16 6098.5,-15550.16"/>
</g>
<!-- ffn_residual_0_10 -->
<g id="node1005" class="node">
<title>ffn_residual_0_10</title>
<ellipse fill="none" stroke="black" cx="6095" cy="-15387" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6095" y="-15390.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="6095" y="-15375.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_0_10&#45;&gt;ffn_residual_0_10 -->
<g id="edge994" class="edge">
<title>ffn_down_0_10&#45;&gt;ffn_residual_0_10</title>
<path fill="none" stroke="black" d="M6095,-15486.98C6095,-15486.98 6095,-15424.36 6095,-15424.36"/>
<polygon fill="black" stroke="black" points="6098.5,-15424.36 6095,-15414.36 6091.5,-15424.36 6098.5,-15424.36"/>
</g>
<!-- qkv_proj_1_10 -->
<g id="node1006" class="node">
<title>qkv_proj_1_10</title>
<polygon fill="none" stroke="black" points="6177.5,-15287 6012.5,-15287 6012.5,-15234 6177.5,-15234 6177.5,-15287"/>
<text text-anchor="middle" x="6095" y="-15271.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6095" y="-15256.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="6095" y="-15241.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_0_10&#45;&gt;qkv_proj_1_10 -->
<g id="edge995" class="edge">
<title>ffn_residual_0_10&#45;&gt;qkv_proj_1_10</title>
<path fill="none" stroke="black" d="M6095,-15359.86C6095,-15359.86 6095,-15297.16 6095,-15297.16"/>
<polygon fill="black" stroke="black" points="6098.5,-15297.16 6095,-15287.16 6091.5,-15297.16 6098.5,-15297.16"/>
</g>
<!-- qkv_reshape_1_10 -->
<g id="node1007" class="node">
<title>qkv_reshape_1_10</title>
<ellipse fill="none" stroke="black" cx="6095" cy="-15134" rx="148" ry="27"/>
<text text-anchor="middle" x="6095" y="-15137.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="6095" y="-15122.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_1_10&#45;&gt;qkv_reshape_1_10 -->
<g id="edge996" class="edge">
<title>qkv_proj_1_10&#45;&gt;qkv_reshape_1_10</title>
<path fill="none" stroke="black" d="M6095,-15233.98C6095,-15233.98 6095,-15171.36 6095,-15171.36"/>
<polygon fill="black" stroke="black" points="6098.5,-15171.36 6095,-15161.36 6091.5,-15171.36 6098.5,-15171.36"/>
</g>
<!-- qkv_reshape_1_10&#45;&gt;ring_attn_1_10_stage_0 -->
<g id="edge997" class="edge">
<title>qkv_reshape_1_10&#45;&gt;ring_attn_1_10_stage_0</title>
<path fill="none" stroke="black" d="M6095,-15106.72C6095,-15106.72 6095,-15000.16 6095,-15000.16"/>
<polygon fill="black" stroke="black" points="6098.5,-15000.16 6095,-14990.16 6091.5,-15000.16 6098.5,-15000.16"/>
</g>
<!-- ring_attn_1_10_stage_0&#45;&gt;ring_attn_1_10_stage_1 -->
<g id="edge998" class="edge">
<title>ring_attn_1_10_stage_0&#45;&gt;ring_attn_1_10_stage_1</title>
<path fill="none" stroke="black" d="M6095,-14853.87C6095,-14853.87 6095,-14747.25 6095,-14747.25"/>
<polygon fill="black" stroke="black" points="6098.5,-14747.25 6095,-14737.25 6091.5,-14747.25 6098.5,-14747.25"/>
</g>
<!-- ring_attn_1_11_stage_0 -->
<g id="node1106" class="node">
<title>ring_attn_1_11_stage_0</title>
<polygon fill="yellow" stroke="black" points="6682,-14990 6473,-14922 6682,-14854 6891,-14922 6682,-14990"/>
<text text-anchor="middle" x="6682" y="-14940.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-14925.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="6682" y="-14910.8" font-family="Times,serif" font-size="14.00">Q[11]×K[11]×V[11]</text>
<text text-anchor="middle" x="6682" y="-14895.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_10_stage_0&#45;&gt;ring_attn_1_11_stage_0 -->
<g id="edge2209" class="edge">
<title>ring_attn_1_10_stage_0&#45;&gt;ring_attn_1_11_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-14922C6304.02,-14922 6462.86,-14922 6462.86,-14922"/>
<polygon fill="red" stroke="red" points="6462.86,-14925.5 6472.86,-14922 6462.86,-14918.5 6462.86,-14925.5"/>
</g>
<!-- ring_attn_1_10_stage_1&#45;&gt;ring_attn_1_10_stage_2 -->
<g id="edge999" class="edge">
<title>ring_attn_1_10_stage_1&#45;&gt;ring_attn_1_10_stage_2</title>
<path fill="none" stroke="black" d="M6095,-14600.87C6095,-14600.87 6095,-14494.25 6095,-14494.25"/>
<polygon fill="black" stroke="black" points="6098.5,-14494.25 6095,-14484.25 6091.5,-14494.25 6098.5,-14494.25"/>
</g>
<!-- ring_attn_1_11_stage_1 -->
<g id="node1107" class="node">
<title>ring_attn_1_11_stage_1</title>
<polygon fill="yellow" stroke="black" points="6682,-14737 6473,-14669 6682,-14601 6891,-14669 6682,-14737"/>
<text text-anchor="middle" x="6682" y="-14687.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-14672.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="6682" y="-14657.8" font-family="Times,serif" font-size="14.00">Q[11]×K[10]×V[10]</text>
<text text-anchor="middle" x="6682" y="-14642.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_10_stage_1&#45;&gt;ring_attn_1_11_stage_1 -->
<g id="edge2210" class="edge">
<title>ring_attn_1_10_stage_1&#45;&gt;ring_attn_1_11_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-14669C6304.02,-14669 6462.86,-14669 6462.86,-14669"/>
<polygon fill="red" stroke="red" points="6462.86,-14672.5 6472.86,-14669 6462.86,-14665.5 6462.86,-14672.5"/>
</g>
<!-- ring_attn_1_10_stage_2&#45;&gt;ring_attn_1_10_stage_3 -->
<g id="edge1000" class="edge">
<title>ring_attn_1_10_stage_2&#45;&gt;ring_attn_1_10_stage_3</title>
<path fill="none" stroke="black" d="M6095,-14347.87C6095,-14347.87 6095,-14241.25 6095,-14241.25"/>
<polygon fill="black" stroke="black" points="6098.5,-14241.25 6095,-14231.25 6091.5,-14241.25 6098.5,-14241.25"/>
</g>
<!-- ring_attn_1_11_stage_2 -->
<g id="node1108" class="node">
<title>ring_attn_1_11_stage_2</title>
<polygon fill="yellow" stroke="black" points="6682,-14484 6473,-14416 6682,-14348 6891,-14416 6682,-14484"/>
<text text-anchor="middle" x="6682" y="-14434.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-14419.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="6682" y="-14404.8" font-family="Times,serif" font-size="14.00">Q[11]×K[9]×V[9]</text>
<text text-anchor="middle" x="6682" y="-14389.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_10_stage_2&#45;&gt;ring_attn_1_11_stage_2 -->
<g id="edge2211" class="edge">
<title>ring_attn_1_10_stage_2&#45;&gt;ring_attn_1_11_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-14416C6304.02,-14416 6462.86,-14416 6462.86,-14416"/>
<polygon fill="red" stroke="red" points="6462.86,-14419.5 6472.86,-14416 6462.86,-14412.5 6462.86,-14419.5"/>
</g>
<!-- ring_attn_1_10_stage_3&#45;&gt;ring_attn_1_10_stage_4 -->
<g id="edge1001" class="edge">
<title>ring_attn_1_10_stage_3&#45;&gt;ring_attn_1_10_stage_4</title>
<path fill="none" stroke="black" d="M6095,-14094.87C6095,-14094.87 6095,-13988.25 6095,-13988.25"/>
<polygon fill="black" stroke="black" points="6098.5,-13988.25 6095,-13978.25 6091.5,-13988.25 6098.5,-13988.25"/>
</g>
<!-- ring_attn_1_11_stage_3 -->
<g id="node1109" class="node">
<title>ring_attn_1_11_stage_3</title>
<polygon fill="yellow" stroke="black" points="6682,-14231 6473,-14163 6682,-14095 6891,-14163 6682,-14231"/>
<text text-anchor="middle" x="6682" y="-14181.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-14166.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="6682" y="-14151.8" font-family="Times,serif" font-size="14.00">Q[11]×K[8]×V[8]</text>
<text text-anchor="middle" x="6682" y="-14136.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_10_stage_3&#45;&gt;ring_attn_1_11_stage_3 -->
<g id="edge2212" class="edge">
<title>ring_attn_1_10_stage_3&#45;&gt;ring_attn_1_11_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-14163C6304.02,-14163 6462.86,-14163 6462.86,-14163"/>
<polygon fill="red" stroke="red" points="6462.86,-14166.5 6472.86,-14163 6462.86,-14159.5 6462.86,-14166.5"/>
</g>
<!-- ring_attn_1_10_stage_4&#45;&gt;ring_attn_1_10_stage_5 -->
<g id="edge1002" class="edge">
<title>ring_attn_1_10_stage_4&#45;&gt;ring_attn_1_10_stage_5</title>
<path fill="none" stroke="black" d="M6095,-13841.87C6095,-13841.87 6095,-13735.25 6095,-13735.25"/>
<polygon fill="black" stroke="black" points="6098.5,-13735.25 6095,-13725.25 6091.5,-13735.25 6098.5,-13735.25"/>
</g>
<!-- ring_attn_1_11_stage_4 -->
<g id="node1110" class="node">
<title>ring_attn_1_11_stage_4</title>
<polygon fill="yellow" stroke="black" points="6682,-13978 6473,-13910 6682,-13842 6891,-13910 6682,-13978"/>
<text text-anchor="middle" x="6682" y="-13928.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-13913.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="6682" y="-13898.8" font-family="Times,serif" font-size="14.00">Q[11]×K[7]×V[7]</text>
<text text-anchor="middle" x="6682" y="-13883.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_10_stage_4&#45;&gt;ring_attn_1_11_stage_4 -->
<g id="edge2213" class="edge">
<title>ring_attn_1_10_stage_4&#45;&gt;ring_attn_1_11_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-13910C6304.02,-13910 6462.86,-13910 6462.86,-13910"/>
<polygon fill="red" stroke="red" points="6462.86,-13913.5 6472.86,-13910 6462.86,-13906.5 6462.86,-13913.5"/>
</g>
<!-- ring_attn_1_10_stage_5&#45;&gt;ring_attn_1_10_stage_6 -->
<g id="edge1003" class="edge">
<title>ring_attn_1_10_stage_5&#45;&gt;ring_attn_1_10_stage_6</title>
<path fill="none" stroke="black" d="M6095,-13588.87C6095,-13588.87 6095,-13482.25 6095,-13482.25"/>
<polygon fill="black" stroke="black" points="6098.5,-13482.25 6095,-13472.25 6091.5,-13482.25 6098.5,-13482.25"/>
</g>
<!-- ring_attn_1_11_stage_5 -->
<g id="node1111" class="node">
<title>ring_attn_1_11_stage_5</title>
<polygon fill="yellow" stroke="black" points="6682,-13725 6473,-13657 6682,-13589 6891,-13657 6682,-13725"/>
<text text-anchor="middle" x="6682" y="-13675.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-13660.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="6682" y="-13645.8" font-family="Times,serif" font-size="14.00">Q[11]×K[6]×V[6]</text>
<text text-anchor="middle" x="6682" y="-13630.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_10_stage_5&#45;&gt;ring_attn_1_11_stage_5 -->
<g id="edge2214" class="edge">
<title>ring_attn_1_10_stage_5&#45;&gt;ring_attn_1_11_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-13657C6304.02,-13657 6462.86,-13657 6462.86,-13657"/>
<polygon fill="red" stroke="red" points="6462.86,-13660.5 6472.86,-13657 6462.86,-13653.5 6462.86,-13660.5"/>
</g>
<!-- ring_attn_1_10_stage_6&#45;&gt;ring_attn_1_10_stage_7 -->
<g id="edge1004" class="edge">
<title>ring_attn_1_10_stage_6&#45;&gt;ring_attn_1_10_stage_7</title>
<path fill="none" stroke="black" d="M6095,-13335.87C6095,-13335.87 6095,-13229.25 6095,-13229.25"/>
<polygon fill="black" stroke="black" points="6098.5,-13229.25 6095,-13219.25 6091.5,-13229.25 6098.5,-13229.25"/>
</g>
<!-- ring_attn_1_11_stage_6 -->
<g id="node1112" class="node">
<title>ring_attn_1_11_stage_6</title>
<polygon fill="yellow" stroke="black" points="6682,-13472 6473,-13404 6682,-13336 6891,-13404 6682,-13472"/>
<text text-anchor="middle" x="6682" y="-13422.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-13407.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="6682" y="-13392.8" font-family="Times,serif" font-size="14.00">Q[11]×K[5]×V[5]</text>
<text text-anchor="middle" x="6682" y="-13377.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_10_stage_6&#45;&gt;ring_attn_1_11_stage_6 -->
<g id="edge2215" class="edge">
<title>ring_attn_1_10_stage_6&#45;&gt;ring_attn_1_11_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-13404C6304.02,-13404 6462.86,-13404 6462.86,-13404"/>
<polygon fill="red" stroke="red" points="6462.86,-13407.5 6472.86,-13404 6462.86,-13400.5 6462.86,-13407.5"/>
</g>
<!-- ring_attn_1_10_stage_7&#45;&gt;ring_attn_1_10_stage_8 -->
<g id="edge1005" class="edge">
<title>ring_attn_1_10_stage_7&#45;&gt;ring_attn_1_10_stage_8</title>
<path fill="none" stroke="black" d="M6095,-13082.87C6095,-13082.87 6095,-12976.25 6095,-12976.25"/>
<polygon fill="black" stroke="black" points="6098.5,-12976.25 6095,-12966.25 6091.5,-12976.25 6098.5,-12976.25"/>
</g>
<!-- ring_attn_1_11_stage_7 -->
<g id="node1113" class="node">
<title>ring_attn_1_11_stage_7</title>
<polygon fill="yellow" stroke="black" points="6682,-13219 6473,-13151 6682,-13083 6891,-13151 6682,-13219"/>
<text text-anchor="middle" x="6682" y="-13169.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-13154.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="6682" y="-13139.8" font-family="Times,serif" font-size="14.00">Q[11]×K[4]×V[4]</text>
<text text-anchor="middle" x="6682" y="-13124.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_10_stage_7&#45;&gt;ring_attn_1_11_stage_7 -->
<g id="edge2216" class="edge">
<title>ring_attn_1_10_stage_7&#45;&gt;ring_attn_1_11_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-13151C6304.02,-13151 6462.86,-13151 6462.86,-13151"/>
<polygon fill="red" stroke="red" points="6462.86,-13154.5 6472.86,-13151 6462.86,-13147.5 6462.86,-13154.5"/>
</g>
<!-- ring_attn_1_10_stage_8&#45;&gt;ring_attn_1_10_stage_9 -->
<g id="edge1006" class="edge">
<title>ring_attn_1_10_stage_8&#45;&gt;ring_attn_1_10_stage_9</title>
<path fill="none" stroke="black" d="M6095,-12829.87C6095,-12829.87 6095,-12723.25 6095,-12723.25"/>
<polygon fill="black" stroke="black" points="6098.5,-12723.25 6095,-12713.25 6091.5,-12723.25 6098.5,-12723.25"/>
</g>
<!-- ring_attn_1_11_stage_8 -->
<g id="node1114" class="node">
<title>ring_attn_1_11_stage_8</title>
<polygon fill="yellow" stroke="black" points="6682,-12966 6473,-12898 6682,-12830 6891,-12898 6682,-12966"/>
<text text-anchor="middle" x="6682" y="-12916.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-12901.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="6682" y="-12886.8" font-family="Times,serif" font-size="14.00">Q[11]×K[3]×V[3]</text>
<text text-anchor="middle" x="6682" y="-12871.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_10_stage_8&#45;&gt;ring_attn_1_11_stage_8 -->
<g id="edge2217" class="edge">
<title>ring_attn_1_10_stage_8&#45;&gt;ring_attn_1_11_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-12898C6304.02,-12898 6462.86,-12898 6462.86,-12898"/>
<polygon fill="red" stroke="red" points="6462.86,-12901.5 6472.86,-12898 6462.86,-12894.5 6462.86,-12901.5"/>
</g>
<!-- ring_attn_1_10_stage_9&#45;&gt;ring_attn_1_10_stage_10 -->
<g id="edge1007" class="edge">
<title>ring_attn_1_10_stage_9&#45;&gt;ring_attn_1_10_stage_10</title>
<path fill="none" stroke="black" d="M6095,-12576.87C6095,-12576.87 6095,-12470.25 6095,-12470.25"/>
<polygon fill="black" stroke="black" points="6098.5,-12470.25 6095,-12460.25 6091.5,-12470.25 6098.5,-12470.25"/>
</g>
<!-- ring_attn_1_11_stage_9 -->
<g id="node1115" class="node">
<title>ring_attn_1_11_stage_9</title>
<polygon fill="yellow" stroke="black" points="6682,-12713 6473,-12645 6682,-12577 6891,-12645 6682,-12713"/>
<text text-anchor="middle" x="6682" y="-12663.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-12648.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="6682" y="-12633.8" font-family="Times,serif" font-size="14.00">Q[11]×K[2]×V[2]</text>
<text text-anchor="middle" x="6682" y="-12618.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_10_stage_9&#45;&gt;ring_attn_1_11_stage_9 -->
<g id="edge2218" class="edge">
<title>ring_attn_1_10_stage_9&#45;&gt;ring_attn_1_11_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-12645C6304.02,-12645 6462.86,-12645 6462.86,-12645"/>
<polygon fill="red" stroke="red" points="6462.86,-12648.5 6472.86,-12645 6462.86,-12641.5 6462.86,-12648.5"/>
</g>
<!-- ring_attn_1_10_stage_10&#45;&gt;ring_attn_1_10_stage_11 -->
<g id="edge1008" class="edge">
<title>ring_attn_1_10_stage_10&#45;&gt;ring_attn_1_10_stage_11</title>
<path fill="none" stroke="black" d="M6095,-12323.87C6095,-12323.87 6095,-12217.25 6095,-12217.25"/>
<polygon fill="black" stroke="black" points="6098.5,-12217.25 6095,-12207.25 6091.5,-12217.25 6098.5,-12217.25"/>
</g>
<!-- ring_attn_1_11_stage_10 -->
<g id="node1116" class="node">
<title>ring_attn_1_11_stage_10</title>
<polygon fill="yellow" stroke="black" points="6682,-12460 6473,-12392 6682,-12324 6891,-12392 6682,-12460"/>
<text text-anchor="middle" x="6682" y="-12410.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-12395.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="6682" y="-12380.8" font-family="Times,serif" font-size="14.00">Q[11]×K[1]×V[1]</text>
<text text-anchor="middle" x="6682" y="-12365.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_10_stage_10&#45;&gt;ring_attn_1_11_stage_10 -->
<g id="edge2219" class="edge">
<title>ring_attn_1_10_stage_10&#45;&gt;ring_attn_1_11_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-12392C6304.02,-12392 6462.86,-12392 6462.86,-12392"/>
<polygon fill="red" stroke="red" points="6462.86,-12395.5 6472.86,-12392 6462.86,-12388.5 6462.86,-12395.5"/>
</g>
<!-- ring_attn_1_10_stage_11&#45;&gt;ring_attn_1_10_stage_12 -->
<g id="edge1009" class="edge">
<title>ring_attn_1_10_stage_11&#45;&gt;ring_attn_1_10_stage_12</title>
<path fill="none" stroke="black" d="M6095,-12070.87C6095,-12070.87 6095,-11964.25 6095,-11964.25"/>
<polygon fill="black" stroke="black" points="6098.5,-11964.25 6095,-11954.25 6091.5,-11964.25 6098.5,-11964.25"/>
</g>
<!-- ring_attn_1_11_stage_11 -->
<g id="node1117" class="node">
<title>ring_attn_1_11_stage_11</title>
<polygon fill="yellow" stroke="black" points="6682,-12207 6473,-12139 6682,-12071 6891,-12139 6682,-12207"/>
<text text-anchor="middle" x="6682" y="-12157.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-12142.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="6682" y="-12127.8" font-family="Times,serif" font-size="14.00">Q[11]×K[0]×V[0]</text>
<text text-anchor="middle" x="6682" y="-12112.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_10_stage_11&#45;&gt;ring_attn_1_11_stage_11 -->
<g id="edge2220" class="edge">
<title>ring_attn_1_10_stage_11&#45;&gt;ring_attn_1_11_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-12139C6304.02,-12139 6462.86,-12139 6462.86,-12139"/>
<polygon fill="red" stroke="red" points="6462.86,-12142.5 6472.86,-12139 6462.86,-12135.5 6462.86,-12142.5"/>
</g>
<!-- ring_attn_1_10_stage_12&#45;&gt;ring_attn_1_10_stage_13 -->
<g id="edge1010" class="edge">
<title>ring_attn_1_10_stage_12&#45;&gt;ring_attn_1_10_stage_13</title>
<path fill="none" stroke="black" d="M6095,-11817.87C6095,-11817.87 6095,-11711.25 6095,-11711.25"/>
<polygon fill="black" stroke="black" points="6098.5,-11711.25 6095,-11701.25 6091.5,-11711.25 6098.5,-11711.25"/>
</g>
<!-- ring_attn_1_11_stage_12 -->
<g id="node1118" class="node">
<title>ring_attn_1_11_stage_12</title>
<polygon fill="yellow" stroke="black" points="6682,-11954 6473,-11886 6682,-11818 6891,-11886 6682,-11954"/>
<text text-anchor="middle" x="6682" y="-11904.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-11889.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="6682" y="-11874.8" font-family="Times,serif" font-size="14.00">Q[11]×K[15]×V[15]</text>
<text text-anchor="middle" x="6682" y="-11859.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_10_stage_12&#45;&gt;ring_attn_1_11_stage_12 -->
<g id="edge2221" class="edge">
<title>ring_attn_1_10_stage_12&#45;&gt;ring_attn_1_11_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-11886C6304.02,-11886 6462.86,-11886 6462.86,-11886"/>
<polygon fill="red" stroke="red" points="6462.86,-11889.5 6472.86,-11886 6462.86,-11882.5 6462.86,-11889.5"/>
</g>
<!-- ring_attn_1_10_stage_13&#45;&gt;ring_attn_1_10_stage_14 -->
<g id="edge1011" class="edge">
<title>ring_attn_1_10_stage_13&#45;&gt;ring_attn_1_10_stage_14</title>
<path fill="none" stroke="black" d="M6095,-11564.87C6095,-11564.87 6095,-11458.25 6095,-11458.25"/>
<polygon fill="black" stroke="black" points="6098.5,-11458.25 6095,-11448.25 6091.5,-11458.25 6098.5,-11458.25"/>
</g>
<!-- ring_attn_1_11_stage_13 -->
<g id="node1119" class="node">
<title>ring_attn_1_11_stage_13</title>
<polygon fill="yellow" stroke="black" points="6682,-11701 6473,-11633 6682,-11565 6891,-11633 6682,-11701"/>
<text text-anchor="middle" x="6682" y="-11651.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-11636.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="6682" y="-11621.8" font-family="Times,serif" font-size="14.00">Q[11]×K[14]×V[14]</text>
<text text-anchor="middle" x="6682" y="-11606.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_10_stage_13&#45;&gt;ring_attn_1_11_stage_13 -->
<g id="edge2222" class="edge">
<title>ring_attn_1_10_stage_13&#45;&gt;ring_attn_1_11_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-11633C6304.02,-11633 6462.86,-11633 6462.86,-11633"/>
<polygon fill="red" stroke="red" points="6462.86,-11636.5 6472.86,-11633 6462.86,-11629.5 6462.86,-11636.5"/>
</g>
<!-- ring_attn_1_10_stage_14&#45;&gt;ring_attn_1_10_stage_15 -->
<g id="edge1012" class="edge">
<title>ring_attn_1_10_stage_14&#45;&gt;ring_attn_1_10_stage_15</title>
<path fill="none" stroke="black" d="M6095,-11311.87C6095,-11311.87 6095,-11205.25 6095,-11205.25"/>
<polygon fill="black" stroke="black" points="6098.5,-11205.25 6095,-11195.25 6091.5,-11205.25 6098.5,-11205.25"/>
</g>
<!-- ring_attn_1_11_stage_14 -->
<g id="node1120" class="node">
<title>ring_attn_1_11_stage_14</title>
<polygon fill="yellow" stroke="black" points="6682,-11448 6473,-11380 6682,-11312 6891,-11380 6682,-11448"/>
<text text-anchor="middle" x="6682" y="-11398.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-11383.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="6682" y="-11368.8" font-family="Times,serif" font-size="14.00">Q[11]×K[13]×V[13]</text>
<text text-anchor="middle" x="6682" y="-11353.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_10_stage_14&#45;&gt;ring_attn_1_11_stage_14 -->
<g id="edge2223" class="edge">
<title>ring_attn_1_10_stage_14&#45;&gt;ring_attn_1_11_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-11380C6304.02,-11380 6462.86,-11380 6462.86,-11380"/>
<polygon fill="red" stroke="red" points="6462.86,-11383.5 6472.86,-11380 6462.86,-11376.5 6462.86,-11383.5"/>
</g>
<!-- attn_out_1_10 -->
<g id="node1024" class="node">
<title>attn_out_1_10</title>
<polygon fill="none" stroke="black" points="6164.5,-10986 6025.5,-10986 6025.5,-10933 6164.5,-10933 6164.5,-10986"/>
<text text-anchor="middle" x="6095" y="-10970.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6095" y="-10955.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="6095" y="-10940.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_1_10_stage_15&#45;&gt;attn_out_1_10 -->
<g id="edge1013" class="edge">
<title>ring_attn_1_10_stage_15&#45;&gt;attn_out_1_10</title>
<path fill="none" stroke="black" d="M6095,-11058.87C6095,-11058.87 6095,-10996.18 6095,-10996.18"/>
<polygon fill="black" stroke="black" points="6098.5,-10996.18 6095,-10986.18 6091.5,-10996.18 6098.5,-10996.18"/>
</g>
<!-- ring_attn_1_11_stage_15 -->
<g id="node1121" class="node">
<title>ring_attn_1_11_stage_15</title>
<polygon fill="yellow" stroke="black" points="6682,-11195 6473,-11127 6682,-11059 6891,-11127 6682,-11195"/>
<text text-anchor="middle" x="6682" y="-11145.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-11130.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="6682" y="-11115.8" font-family="Times,serif" font-size="14.00">Q[11]×K[12]×V[12]</text>
<text text-anchor="middle" x="6682" y="-11100.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_10_stage_15&#45;&gt;ring_attn_1_11_stage_15 -->
<g id="edge2224" class="edge">
<title>ring_attn_1_10_stage_15&#45;&gt;ring_attn_1_11_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-11127C6304.02,-11127 6462.86,-11127 6462.86,-11127"/>
<polygon fill="red" stroke="red" points="6462.86,-11130.5 6472.86,-11127 6462.86,-11123.5 6462.86,-11130.5"/>
</g>
<!-- attn_residual_1_10 -->
<g id="node1025" class="node">
<title>attn_residual_1_10</title>
<ellipse fill="none" stroke="black" cx="6095" cy="-10833" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6095" y="-10836.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="6095" y="-10821.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_1_10&#45;&gt;attn_residual_1_10 -->
<g id="edge1014" class="edge">
<title>attn_out_1_10&#45;&gt;attn_residual_1_10</title>
<path fill="none" stroke="black" d="M6095,-10932.98C6095,-10932.98 6095,-10870.36 6095,-10870.36"/>
<polygon fill="black" stroke="black" points="6098.5,-10870.36 6095,-10860.36 6091.5,-10870.36 6098.5,-10870.36"/>
</g>
<!-- ffn_up_1_10 -->
<g id="node1026" class="node">
<title>ffn_up_1_10</title>
<polygon fill="none" stroke="black" points="6174,-10733 6016,-10733 6016,-10680 6174,-10680 6174,-10733"/>
<text text-anchor="middle" x="6095" y="-10717.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="6095" y="-10702.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="6095" y="-10687.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_1_10&#45;&gt;ffn_up_1_10 -->
<g id="edge1015" class="edge">
<title>attn_residual_1_10&#45;&gt;ffn_up_1_10</title>
<path fill="none" stroke="black" d="M6095,-10805.86C6095,-10805.86 6095,-10743.16 6095,-10743.16"/>
<polygon fill="black" stroke="black" points="6098.5,-10743.16 6095,-10733.16 6091.5,-10743.16 6098.5,-10743.16"/>
</g>
<!-- ffn_gelu_1_10 -->
<g id="node1027" class="node">
<title>ffn_gelu_1_10</title>
<ellipse fill="none" stroke="black" cx="6095" cy="-10580" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6095" y="-10583.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="6095" y="-10568.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_1_10&#45;&gt;ffn_gelu_1_10 -->
<g id="edge1016" class="edge">
<title>ffn_up_1_10&#45;&gt;ffn_gelu_1_10</title>
<path fill="none" stroke="black" d="M6095,-10679.98C6095,-10679.98 6095,-10617.36 6095,-10617.36"/>
<polygon fill="black" stroke="black" points="6098.5,-10617.36 6095,-10607.36 6091.5,-10617.36 6098.5,-10617.36"/>
</g>
<!-- ffn_down_1_10 -->
<g id="node1028" class="node">
<title>ffn_down_1_10</title>
<polygon fill="none" stroke="black" points="6184,-10480 6006,-10480 6006,-10427 6184,-10427 6184,-10480"/>
<text text-anchor="middle" x="6095" y="-10464.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6095" y="-10449.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="6095" y="-10434.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_1_10&#45;&gt;ffn_down_1_10 -->
<g id="edge1017" class="edge">
<title>ffn_gelu_1_10&#45;&gt;ffn_down_1_10</title>
<path fill="none" stroke="black" d="M6095,-10552.86C6095,-10552.86 6095,-10490.16 6095,-10490.16"/>
<polygon fill="black" stroke="black" points="6098.5,-10490.16 6095,-10480.16 6091.5,-10490.16 6098.5,-10490.16"/>
</g>
<!-- ffn_residual_1_10 -->
<g id="node1029" class="node">
<title>ffn_residual_1_10</title>
<ellipse fill="none" stroke="black" cx="6095" cy="-10327" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6095" y="-10330.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="6095" y="-10315.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_1_10&#45;&gt;ffn_residual_1_10 -->
<g id="edge1018" class="edge">
<title>ffn_down_1_10&#45;&gt;ffn_residual_1_10</title>
<path fill="none" stroke="black" d="M6095,-10426.98C6095,-10426.98 6095,-10364.36 6095,-10364.36"/>
<polygon fill="black" stroke="black" points="6098.5,-10364.36 6095,-10354.36 6091.5,-10364.36 6098.5,-10364.36"/>
</g>
<!-- qkv_proj_2_10 -->
<g id="node1030" class="node">
<title>qkv_proj_2_10</title>
<polygon fill="none" stroke="black" points="6177.5,-10227 6012.5,-10227 6012.5,-10174 6177.5,-10174 6177.5,-10227"/>
<text text-anchor="middle" x="6095" y="-10211.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6095" y="-10196.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="6095" y="-10181.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_1_10&#45;&gt;qkv_proj_2_10 -->
<g id="edge1019" class="edge">
<title>ffn_residual_1_10&#45;&gt;qkv_proj_2_10</title>
<path fill="none" stroke="black" d="M6095,-10299.86C6095,-10299.86 6095,-10237.16 6095,-10237.16"/>
<polygon fill="black" stroke="black" points="6098.5,-10237.16 6095,-10227.16 6091.5,-10237.16 6098.5,-10237.16"/>
</g>
<!-- qkv_reshape_2_10 -->
<g id="node1031" class="node">
<title>qkv_reshape_2_10</title>
<ellipse fill="none" stroke="black" cx="6095" cy="-10074" rx="148" ry="27"/>
<text text-anchor="middle" x="6095" y="-10077.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="6095" y="-10062.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_2_10&#45;&gt;qkv_reshape_2_10 -->
<g id="edge1020" class="edge">
<title>qkv_proj_2_10&#45;&gt;qkv_reshape_2_10</title>
<path fill="none" stroke="black" d="M6095,-10173.98C6095,-10173.98 6095,-10111.36 6095,-10111.36"/>
<polygon fill="black" stroke="black" points="6098.5,-10111.36 6095,-10101.36 6091.5,-10111.36 6098.5,-10111.36"/>
</g>
<!-- qkv_reshape_2_10&#45;&gt;ring_attn_2_10_stage_0 -->
<g id="edge1021" class="edge">
<title>qkv_reshape_2_10&#45;&gt;ring_attn_2_10_stage_0</title>
<path fill="none" stroke="black" d="M6095,-10046.72C6095,-10046.72 6095,-9940.16 6095,-9940.16"/>
<polygon fill="black" stroke="black" points="6098.5,-9940.16 6095,-9930.16 6091.5,-9940.16 6098.5,-9940.16"/>
</g>
<!-- ring_attn_2_10_stage_0&#45;&gt;ring_attn_2_10_stage_1 -->
<g id="edge1022" class="edge">
<title>ring_attn_2_10_stage_0&#45;&gt;ring_attn_2_10_stage_1</title>
<path fill="none" stroke="black" d="M6095,-9793.87C6095,-9793.87 6095,-9687.25 6095,-9687.25"/>
<polygon fill="black" stroke="black" points="6098.5,-9687.25 6095,-9677.25 6091.5,-9687.25 6098.5,-9687.25"/>
</g>
<!-- ring_attn_2_11_stage_0 -->
<g id="node1130" class="node">
<title>ring_attn_2_11_stage_0</title>
<polygon fill="yellow" stroke="black" points="6682,-9930 6473,-9862 6682,-9794 6891,-9862 6682,-9930"/>
<text text-anchor="middle" x="6682" y="-9880.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-9865.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="6682" y="-9850.8" font-family="Times,serif" font-size="14.00">Q[11]×K[11]×V[11]</text>
<text text-anchor="middle" x="6682" y="-9835.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_10_stage_0&#45;&gt;ring_attn_2_11_stage_0 -->
<g id="edge2225" class="edge">
<title>ring_attn_2_10_stage_0&#45;&gt;ring_attn_2_11_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-9862C6304.02,-9862 6462.86,-9862 6462.86,-9862"/>
<polygon fill="red" stroke="red" points="6462.86,-9865.5 6472.86,-9862 6462.86,-9858.5 6462.86,-9865.5"/>
</g>
<!-- ring_attn_2_10_stage_1&#45;&gt;ring_attn_2_10_stage_2 -->
<g id="edge1023" class="edge">
<title>ring_attn_2_10_stage_1&#45;&gt;ring_attn_2_10_stage_2</title>
<path fill="none" stroke="black" d="M6095,-9540.87C6095,-9540.87 6095,-9434.25 6095,-9434.25"/>
<polygon fill="black" stroke="black" points="6098.5,-9434.25 6095,-9424.25 6091.5,-9434.25 6098.5,-9434.25"/>
</g>
<!-- ring_attn_2_11_stage_1 -->
<g id="node1131" class="node">
<title>ring_attn_2_11_stage_1</title>
<polygon fill="yellow" stroke="black" points="6682,-9677 6473,-9609 6682,-9541 6891,-9609 6682,-9677"/>
<text text-anchor="middle" x="6682" y="-9627.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-9612.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="6682" y="-9597.8" font-family="Times,serif" font-size="14.00">Q[11]×K[10]×V[10]</text>
<text text-anchor="middle" x="6682" y="-9582.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_10_stage_1&#45;&gt;ring_attn_2_11_stage_1 -->
<g id="edge2226" class="edge">
<title>ring_attn_2_10_stage_1&#45;&gt;ring_attn_2_11_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-9609C6304.02,-9609 6462.86,-9609 6462.86,-9609"/>
<polygon fill="red" stroke="red" points="6462.86,-9612.5 6472.86,-9609 6462.86,-9605.5 6462.86,-9612.5"/>
</g>
<!-- ring_attn_2_10_stage_2&#45;&gt;ring_attn_2_10_stage_3 -->
<g id="edge1024" class="edge">
<title>ring_attn_2_10_stage_2&#45;&gt;ring_attn_2_10_stage_3</title>
<path fill="none" stroke="black" d="M6095,-9287.87C6095,-9287.87 6095,-9181.25 6095,-9181.25"/>
<polygon fill="black" stroke="black" points="6098.5,-9181.25 6095,-9171.25 6091.5,-9181.25 6098.5,-9181.25"/>
</g>
<!-- ring_attn_2_11_stage_2 -->
<g id="node1132" class="node">
<title>ring_attn_2_11_stage_2</title>
<polygon fill="yellow" stroke="black" points="6682,-9424 6473,-9356 6682,-9288 6891,-9356 6682,-9424"/>
<text text-anchor="middle" x="6682" y="-9374.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-9359.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="6682" y="-9344.8" font-family="Times,serif" font-size="14.00">Q[11]×K[9]×V[9]</text>
<text text-anchor="middle" x="6682" y="-9329.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_10_stage_2&#45;&gt;ring_attn_2_11_stage_2 -->
<g id="edge2227" class="edge">
<title>ring_attn_2_10_stage_2&#45;&gt;ring_attn_2_11_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-9356C6304.02,-9356 6462.86,-9356 6462.86,-9356"/>
<polygon fill="red" stroke="red" points="6462.86,-9359.5 6472.86,-9356 6462.86,-9352.5 6462.86,-9359.5"/>
</g>
<!-- ring_attn_2_10_stage_3&#45;&gt;ring_attn_2_10_stage_4 -->
<g id="edge1025" class="edge">
<title>ring_attn_2_10_stage_3&#45;&gt;ring_attn_2_10_stage_4</title>
<path fill="none" stroke="black" d="M6095,-9034.87C6095,-9034.87 6095,-8928.25 6095,-8928.25"/>
<polygon fill="black" stroke="black" points="6098.5,-8928.25 6095,-8918.25 6091.5,-8928.25 6098.5,-8928.25"/>
</g>
<!-- ring_attn_2_11_stage_3 -->
<g id="node1133" class="node">
<title>ring_attn_2_11_stage_3</title>
<polygon fill="yellow" stroke="black" points="6682,-9171 6473,-9103 6682,-9035 6891,-9103 6682,-9171"/>
<text text-anchor="middle" x="6682" y="-9121.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-9106.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="6682" y="-9091.8" font-family="Times,serif" font-size="14.00">Q[11]×K[8]×V[8]</text>
<text text-anchor="middle" x="6682" y="-9076.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_10_stage_3&#45;&gt;ring_attn_2_11_stage_3 -->
<g id="edge2228" class="edge">
<title>ring_attn_2_10_stage_3&#45;&gt;ring_attn_2_11_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-9103C6304.02,-9103 6462.86,-9103 6462.86,-9103"/>
<polygon fill="red" stroke="red" points="6462.86,-9106.5 6472.86,-9103 6462.86,-9099.5 6462.86,-9106.5"/>
</g>
<!-- ring_attn_2_10_stage_4&#45;&gt;ring_attn_2_10_stage_5 -->
<g id="edge1026" class="edge">
<title>ring_attn_2_10_stage_4&#45;&gt;ring_attn_2_10_stage_5</title>
<path fill="none" stroke="black" d="M6095,-8781.87C6095,-8781.87 6095,-8675.25 6095,-8675.25"/>
<polygon fill="black" stroke="black" points="6098.5,-8675.25 6095,-8665.25 6091.5,-8675.25 6098.5,-8675.25"/>
</g>
<!-- ring_attn_2_11_stage_4 -->
<g id="node1134" class="node">
<title>ring_attn_2_11_stage_4</title>
<polygon fill="yellow" stroke="black" points="6682,-8918 6473,-8850 6682,-8782 6891,-8850 6682,-8918"/>
<text text-anchor="middle" x="6682" y="-8868.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-8853.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="6682" y="-8838.8" font-family="Times,serif" font-size="14.00">Q[11]×K[7]×V[7]</text>
<text text-anchor="middle" x="6682" y="-8823.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_10_stage_4&#45;&gt;ring_attn_2_11_stage_4 -->
<g id="edge2229" class="edge">
<title>ring_attn_2_10_stage_4&#45;&gt;ring_attn_2_11_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-8850C6304.02,-8850 6462.86,-8850 6462.86,-8850"/>
<polygon fill="red" stroke="red" points="6462.86,-8853.5 6472.86,-8850 6462.86,-8846.5 6462.86,-8853.5"/>
</g>
<!-- ring_attn_2_10_stage_5&#45;&gt;ring_attn_2_10_stage_6 -->
<g id="edge1027" class="edge">
<title>ring_attn_2_10_stage_5&#45;&gt;ring_attn_2_10_stage_6</title>
<path fill="none" stroke="black" d="M6095,-8528.87C6095,-8528.87 6095,-8422.25 6095,-8422.25"/>
<polygon fill="black" stroke="black" points="6098.5,-8422.25 6095,-8412.25 6091.5,-8422.25 6098.5,-8422.25"/>
</g>
<!-- ring_attn_2_11_stage_5 -->
<g id="node1135" class="node">
<title>ring_attn_2_11_stage_5</title>
<polygon fill="yellow" stroke="black" points="6682,-8665 6473,-8597 6682,-8529 6891,-8597 6682,-8665"/>
<text text-anchor="middle" x="6682" y="-8615.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-8600.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="6682" y="-8585.8" font-family="Times,serif" font-size="14.00">Q[11]×K[6]×V[6]</text>
<text text-anchor="middle" x="6682" y="-8570.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_10_stage_5&#45;&gt;ring_attn_2_11_stage_5 -->
<g id="edge2230" class="edge">
<title>ring_attn_2_10_stage_5&#45;&gt;ring_attn_2_11_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-8597C6304.02,-8597 6462.86,-8597 6462.86,-8597"/>
<polygon fill="red" stroke="red" points="6462.86,-8600.5 6472.86,-8597 6462.86,-8593.5 6462.86,-8600.5"/>
</g>
<!-- ring_attn_2_10_stage_6&#45;&gt;ring_attn_2_10_stage_7 -->
<g id="edge1028" class="edge">
<title>ring_attn_2_10_stage_6&#45;&gt;ring_attn_2_10_stage_7</title>
<path fill="none" stroke="black" d="M6095,-8275.87C6095,-8275.87 6095,-8169.25 6095,-8169.25"/>
<polygon fill="black" stroke="black" points="6098.5,-8169.25 6095,-8159.25 6091.5,-8169.25 6098.5,-8169.25"/>
</g>
<!-- ring_attn_2_11_stage_6 -->
<g id="node1136" class="node">
<title>ring_attn_2_11_stage_6</title>
<polygon fill="yellow" stroke="black" points="6682,-8412 6473,-8344 6682,-8276 6891,-8344 6682,-8412"/>
<text text-anchor="middle" x="6682" y="-8362.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-8347.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="6682" y="-8332.8" font-family="Times,serif" font-size="14.00">Q[11]×K[5]×V[5]</text>
<text text-anchor="middle" x="6682" y="-8317.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_10_stage_6&#45;&gt;ring_attn_2_11_stage_6 -->
<g id="edge2231" class="edge">
<title>ring_attn_2_10_stage_6&#45;&gt;ring_attn_2_11_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-8344C6304.02,-8344 6462.86,-8344 6462.86,-8344"/>
<polygon fill="red" stroke="red" points="6462.86,-8347.5 6472.86,-8344 6462.86,-8340.5 6462.86,-8347.5"/>
</g>
<!-- ring_attn_2_10_stage_7&#45;&gt;ring_attn_2_10_stage_8 -->
<g id="edge1029" class="edge">
<title>ring_attn_2_10_stage_7&#45;&gt;ring_attn_2_10_stage_8</title>
<path fill="none" stroke="black" d="M6095,-8022.87C6095,-8022.87 6095,-7916.25 6095,-7916.25"/>
<polygon fill="black" stroke="black" points="6098.5,-7916.25 6095,-7906.25 6091.5,-7916.25 6098.5,-7916.25"/>
</g>
<!-- ring_attn_2_11_stage_7 -->
<g id="node1137" class="node">
<title>ring_attn_2_11_stage_7</title>
<polygon fill="yellow" stroke="black" points="6682,-8159 6473,-8091 6682,-8023 6891,-8091 6682,-8159"/>
<text text-anchor="middle" x="6682" y="-8109.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-8094.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="6682" y="-8079.8" font-family="Times,serif" font-size="14.00">Q[11]×K[4]×V[4]</text>
<text text-anchor="middle" x="6682" y="-8064.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_10_stage_7&#45;&gt;ring_attn_2_11_stage_7 -->
<g id="edge2232" class="edge">
<title>ring_attn_2_10_stage_7&#45;&gt;ring_attn_2_11_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-8091C6304.02,-8091 6462.86,-8091 6462.86,-8091"/>
<polygon fill="red" stroke="red" points="6462.86,-8094.5 6472.86,-8091 6462.86,-8087.5 6462.86,-8094.5"/>
</g>
<!-- ring_attn_2_10_stage_8&#45;&gt;ring_attn_2_10_stage_9 -->
<g id="edge1030" class="edge">
<title>ring_attn_2_10_stage_8&#45;&gt;ring_attn_2_10_stage_9</title>
<path fill="none" stroke="black" d="M6095,-7769.87C6095,-7769.87 6095,-7663.25 6095,-7663.25"/>
<polygon fill="black" stroke="black" points="6098.5,-7663.25 6095,-7653.25 6091.5,-7663.25 6098.5,-7663.25"/>
</g>
<!-- ring_attn_2_11_stage_8 -->
<g id="node1138" class="node">
<title>ring_attn_2_11_stage_8</title>
<polygon fill="yellow" stroke="black" points="6682,-7906 6473,-7838 6682,-7770 6891,-7838 6682,-7906"/>
<text text-anchor="middle" x="6682" y="-7856.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-7841.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="6682" y="-7826.8" font-family="Times,serif" font-size="14.00">Q[11]×K[3]×V[3]</text>
<text text-anchor="middle" x="6682" y="-7811.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_10_stage_8&#45;&gt;ring_attn_2_11_stage_8 -->
<g id="edge2233" class="edge">
<title>ring_attn_2_10_stage_8&#45;&gt;ring_attn_2_11_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-7838C6304.02,-7838 6462.86,-7838 6462.86,-7838"/>
<polygon fill="red" stroke="red" points="6462.86,-7841.5 6472.86,-7838 6462.86,-7834.5 6462.86,-7841.5"/>
</g>
<!-- ring_attn_2_10_stage_9&#45;&gt;ring_attn_2_10_stage_10 -->
<g id="edge1031" class="edge">
<title>ring_attn_2_10_stage_9&#45;&gt;ring_attn_2_10_stage_10</title>
<path fill="none" stroke="black" d="M6095,-7516.87C6095,-7516.87 6095,-7410.25 6095,-7410.25"/>
<polygon fill="black" stroke="black" points="6098.5,-7410.25 6095,-7400.25 6091.5,-7410.25 6098.5,-7410.25"/>
</g>
<!-- ring_attn_2_11_stage_9 -->
<g id="node1139" class="node">
<title>ring_attn_2_11_stage_9</title>
<polygon fill="yellow" stroke="black" points="6682,-7653 6473,-7585 6682,-7517 6891,-7585 6682,-7653"/>
<text text-anchor="middle" x="6682" y="-7603.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-7588.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="6682" y="-7573.8" font-family="Times,serif" font-size="14.00">Q[11]×K[2]×V[2]</text>
<text text-anchor="middle" x="6682" y="-7558.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_10_stage_9&#45;&gt;ring_attn_2_11_stage_9 -->
<g id="edge2234" class="edge">
<title>ring_attn_2_10_stage_9&#45;&gt;ring_attn_2_11_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-7585C6304.02,-7585 6462.86,-7585 6462.86,-7585"/>
<polygon fill="red" stroke="red" points="6462.86,-7588.5 6472.86,-7585 6462.86,-7581.5 6462.86,-7588.5"/>
</g>
<!-- ring_attn_2_10_stage_10&#45;&gt;ring_attn_2_10_stage_11 -->
<g id="edge1032" class="edge">
<title>ring_attn_2_10_stage_10&#45;&gt;ring_attn_2_10_stage_11</title>
<path fill="none" stroke="black" d="M6095,-7263.87C6095,-7263.87 6095,-7157.25 6095,-7157.25"/>
<polygon fill="black" stroke="black" points="6098.5,-7157.25 6095,-7147.25 6091.5,-7157.25 6098.5,-7157.25"/>
</g>
<!-- ring_attn_2_11_stage_10 -->
<g id="node1140" class="node">
<title>ring_attn_2_11_stage_10</title>
<polygon fill="yellow" stroke="black" points="6682,-7400 6473,-7332 6682,-7264 6891,-7332 6682,-7400"/>
<text text-anchor="middle" x="6682" y="-7350.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-7335.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="6682" y="-7320.8" font-family="Times,serif" font-size="14.00">Q[11]×K[1]×V[1]</text>
<text text-anchor="middle" x="6682" y="-7305.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_10_stage_10&#45;&gt;ring_attn_2_11_stage_10 -->
<g id="edge2235" class="edge">
<title>ring_attn_2_10_stage_10&#45;&gt;ring_attn_2_11_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-7332C6304.02,-7332 6462.86,-7332 6462.86,-7332"/>
<polygon fill="red" stroke="red" points="6462.86,-7335.5 6472.86,-7332 6462.86,-7328.5 6462.86,-7335.5"/>
</g>
<!-- ring_attn_2_10_stage_11&#45;&gt;ring_attn_2_10_stage_12 -->
<g id="edge1033" class="edge">
<title>ring_attn_2_10_stage_11&#45;&gt;ring_attn_2_10_stage_12</title>
<path fill="none" stroke="black" d="M6095,-7010.87C6095,-7010.87 6095,-6904.25 6095,-6904.25"/>
<polygon fill="black" stroke="black" points="6098.5,-6904.25 6095,-6894.25 6091.5,-6904.25 6098.5,-6904.25"/>
</g>
<!-- ring_attn_2_11_stage_11 -->
<g id="node1141" class="node">
<title>ring_attn_2_11_stage_11</title>
<polygon fill="yellow" stroke="black" points="6682,-7147 6473,-7079 6682,-7011 6891,-7079 6682,-7147"/>
<text text-anchor="middle" x="6682" y="-7097.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-7082.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="6682" y="-7067.8" font-family="Times,serif" font-size="14.00">Q[11]×K[0]×V[0]</text>
<text text-anchor="middle" x="6682" y="-7052.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_10_stage_11&#45;&gt;ring_attn_2_11_stage_11 -->
<g id="edge2236" class="edge">
<title>ring_attn_2_10_stage_11&#45;&gt;ring_attn_2_11_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-7079C6304.02,-7079 6462.86,-7079 6462.86,-7079"/>
<polygon fill="red" stroke="red" points="6462.86,-7082.5 6472.86,-7079 6462.86,-7075.5 6462.86,-7082.5"/>
</g>
<!-- ring_attn_2_10_stage_12&#45;&gt;ring_attn_2_10_stage_13 -->
<g id="edge1034" class="edge">
<title>ring_attn_2_10_stage_12&#45;&gt;ring_attn_2_10_stage_13</title>
<path fill="none" stroke="black" d="M6095,-6757.87C6095,-6757.87 6095,-6651.25 6095,-6651.25"/>
<polygon fill="black" stroke="black" points="6098.5,-6651.25 6095,-6641.25 6091.5,-6651.25 6098.5,-6651.25"/>
</g>
<!-- ring_attn_2_11_stage_12 -->
<g id="node1142" class="node">
<title>ring_attn_2_11_stage_12</title>
<polygon fill="yellow" stroke="black" points="6682,-6894 6473,-6826 6682,-6758 6891,-6826 6682,-6894"/>
<text text-anchor="middle" x="6682" y="-6844.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-6829.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="6682" y="-6814.8" font-family="Times,serif" font-size="14.00">Q[11]×K[15]×V[15]</text>
<text text-anchor="middle" x="6682" y="-6799.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_10_stage_12&#45;&gt;ring_attn_2_11_stage_12 -->
<g id="edge2237" class="edge">
<title>ring_attn_2_10_stage_12&#45;&gt;ring_attn_2_11_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-6826C6304.02,-6826 6462.86,-6826 6462.86,-6826"/>
<polygon fill="red" stroke="red" points="6462.86,-6829.5 6472.86,-6826 6462.86,-6822.5 6462.86,-6829.5"/>
</g>
<!-- ring_attn_2_10_stage_13&#45;&gt;ring_attn_2_10_stage_14 -->
<g id="edge1035" class="edge">
<title>ring_attn_2_10_stage_13&#45;&gt;ring_attn_2_10_stage_14</title>
<path fill="none" stroke="black" d="M6095,-6504.87C6095,-6504.87 6095,-6398.25 6095,-6398.25"/>
<polygon fill="black" stroke="black" points="6098.5,-6398.25 6095,-6388.25 6091.5,-6398.25 6098.5,-6398.25"/>
</g>
<!-- ring_attn_2_11_stage_13 -->
<g id="node1143" class="node">
<title>ring_attn_2_11_stage_13</title>
<polygon fill="yellow" stroke="black" points="6682,-6641 6473,-6573 6682,-6505 6891,-6573 6682,-6641"/>
<text text-anchor="middle" x="6682" y="-6591.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-6576.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="6682" y="-6561.8" font-family="Times,serif" font-size="14.00">Q[11]×K[14]×V[14]</text>
<text text-anchor="middle" x="6682" y="-6546.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_10_stage_13&#45;&gt;ring_attn_2_11_stage_13 -->
<g id="edge2238" class="edge">
<title>ring_attn_2_10_stage_13&#45;&gt;ring_attn_2_11_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-6573C6304.02,-6573 6462.86,-6573 6462.86,-6573"/>
<polygon fill="red" stroke="red" points="6462.86,-6576.5 6472.86,-6573 6462.86,-6569.5 6462.86,-6576.5"/>
</g>
<!-- ring_attn_2_10_stage_14&#45;&gt;ring_attn_2_10_stage_15 -->
<g id="edge1036" class="edge">
<title>ring_attn_2_10_stage_14&#45;&gt;ring_attn_2_10_stage_15</title>
<path fill="none" stroke="black" d="M6095,-6251.87C6095,-6251.87 6095,-6145.25 6095,-6145.25"/>
<polygon fill="black" stroke="black" points="6098.5,-6145.25 6095,-6135.25 6091.5,-6145.25 6098.5,-6145.25"/>
</g>
<!-- ring_attn_2_11_stage_14 -->
<g id="node1144" class="node">
<title>ring_attn_2_11_stage_14</title>
<polygon fill="yellow" stroke="black" points="6682,-6388 6473,-6320 6682,-6252 6891,-6320 6682,-6388"/>
<text text-anchor="middle" x="6682" y="-6338.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-6323.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="6682" y="-6308.8" font-family="Times,serif" font-size="14.00">Q[11]×K[13]×V[13]</text>
<text text-anchor="middle" x="6682" y="-6293.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_10_stage_14&#45;&gt;ring_attn_2_11_stage_14 -->
<g id="edge2239" class="edge">
<title>ring_attn_2_10_stage_14&#45;&gt;ring_attn_2_11_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-6320C6304.02,-6320 6462.86,-6320 6462.86,-6320"/>
<polygon fill="red" stroke="red" points="6462.86,-6323.5 6472.86,-6320 6462.86,-6316.5 6462.86,-6323.5"/>
</g>
<!-- attn_out_2_10 -->
<g id="node1048" class="node">
<title>attn_out_2_10</title>
<polygon fill="none" stroke="black" points="6164.5,-5926 6025.5,-5926 6025.5,-5873 6164.5,-5873 6164.5,-5926"/>
<text text-anchor="middle" x="6095" y="-5910.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6095" y="-5895.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="6095" y="-5880.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_2_10_stage_15&#45;&gt;attn_out_2_10 -->
<g id="edge1037" class="edge">
<title>ring_attn_2_10_stage_15&#45;&gt;attn_out_2_10</title>
<path fill="none" stroke="black" d="M6095,-5998.87C6095,-5998.87 6095,-5936.18 6095,-5936.18"/>
<polygon fill="black" stroke="black" points="6098.5,-5936.18 6095,-5926.18 6091.5,-5936.18 6098.5,-5936.18"/>
</g>
<!-- ring_attn_2_11_stage_15 -->
<g id="node1145" class="node">
<title>ring_attn_2_11_stage_15</title>
<polygon fill="yellow" stroke="black" points="6682,-6135 6473,-6067 6682,-5999 6891,-6067 6682,-6135"/>
<text text-anchor="middle" x="6682" y="-6085.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-6070.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="6682" y="-6055.8" font-family="Times,serif" font-size="14.00">Q[11]×K[12]×V[12]</text>
<text text-anchor="middle" x="6682" y="-6040.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_10_stage_15&#45;&gt;ring_attn_2_11_stage_15 -->
<g id="edge2240" class="edge">
<title>ring_attn_2_10_stage_15&#45;&gt;ring_attn_2_11_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-6067C6304.02,-6067 6462.86,-6067 6462.86,-6067"/>
<polygon fill="red" stroke="red" points="6462.86,-6070.5 6472.86,-6067 6462.86,-6063.5 6462.86,-6070.5"/>
</g>
<!-- attn_residual_2_10 -->
<g id="node1049" class="node">
<title>attn_residual_2_10</title>
<ellipse fill="none" stroke="black" cx="6095" cy="-5773" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6095" y="-5776.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="6095" y="-5761.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_2_10&#45;&gt;attn_residual_2_10 -->
<g id="edge1038" class="edge">
<title>attn_out_2_10&#45;&gt;attn_residual_2_10</title>
<path fill="none" stroke="black" d="M6095,-5872.98C6095,-5872.98 6095,-5810.36 6095,-5810.36"/>
<polygon fill="black" stroke="black" points="6098.5,-5810.36 6095,-5800.36 6091.5,-5810.36 6098.5,-5810.36"/>
</g>
<!-- ffn_up_2_10 -->
<g id="node1050" class="node">
<title>ffn_up_2_10</title>
<polygon fill="none" stroke="black" points="6174,-5673 6016,-5673 6016,-5620 6174,-5620 6174,-5673"/>
<text text-anchor="middle" x="6095" y="-5657.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="6095" y="-5642.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="6095" y="-5627.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_2_10&#45;&gt;ffn_up_2_10 -->
<g id="edge1039" class="edge">
<title>attn_residual_2_10&#45;&gt;ffn_up_2_10</title>
<path fill="none" stroke="black" d="M6095,-5745.86C6095,-5745.86 6095,-5683.16 6095,-5683.16"/>
<polygon fill="black" stroke="black" points="6098.5,-5683.16 6095,-5673.16 6091.5,-5683.16 6098.5,-5683.16"/>
</g>
<!-- ffn_gelu_2_10 -->
<g id="node1051" class="node">
<title>ffn_gelu_2_10</title>
<ellipse fill="none" stroke="black" cx="6095" cy="-5520" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6095" y="-5523.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="6095" y="-5508.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_2_10&#45;&gt;ffn_gelu_2_10 -->
<g id="edge1040" class="edge">
<title>ffn_up_2_10&#45;&gt;ffn_gelu_2_10</title>
<path fill="none" stroke="black" d="M6095,-5619.98C6095,-5619.98 6095,-5557.36 6095,-5557.36"/>
<polygon fill="black" stroke="black" points="6098.5,-5557.36 6095,-5547.36 6091.5,-5557.36 6098.5,-5557.36"/>
</g>
<!-- ffn_down_2_10 -->
<g id="node1052" class="node">
<title>ffn_down_2_10</title>
<polygon fill="none" stroke="black" points="6184,-5420 6006,-5420 6006,-5367 6184,-5367 6184,-5420"/>
<text text-anchor="middle" x="6095" y="-5404.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6095" y="-5389.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="6095" y="-5374.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_2_10&#45;&gt;ffn_down_2_10 -->
<g id="edge1041" class="edge">
<title>ffn_gelu_2_10&#45;&gt;ffn_down_2_10</title>
<path fill="none" stroke="black" d="M6095,-5492.86C6095,-5492.86 6095,-5430.16 6095,-5430.16"/>
<polygon fill="black" stroke="black" points="6098.5,-5430.16 6095,-5420.16 6091.5,-5430.16 6098.5,-5430.16"/>
</g>
<!-- ffn_residual_2_10 -->
<g id="node1053" class="node">
<title>ffn_residual_2_10</title>
<ellipse fill="none" stroke="black" cx="6095" cy="-5267" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6095" y="-5270.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="6095" y="-5255.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_2_10&#45;&gt;ffn_residual_2_10 -->
<g id="edge1042" class="edge">
<title>ffn_down_2_10&#45;&gt;ffn_residual_2_10</title>
<path fill="none" stroke="black" d="M6095,-5366.98C6095,-5366.98 6095,-5304.36 6095,-5304.36"/>
<polygon fill="black" stroke="black" points="6098.5,-5304.36 6095,-5294.36 6091.5,-5304.36 6098.5,-5304.36"/>
</g>
<!-- qkv_proj_3_10 -->
<g id="node1054" class="node">
<title>qkv_proj_3_10</title>
<polygon fill="none" stroke="black" points="6177.5,-5167 6012.5,-5167 6012.5,-5114 6177.5,-5114 6177.5,-5167"/>
<text text-anchor="middle" x="6095" y="-5151.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6095" y="-5136.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="6095" y="-5121.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_2_10&#45;&gt;qkv_proj_3_10 -->
<g id="edge1043" class="edge">
<title>ffn_residual_2_10&#45;&gt;qkv_proj_3_10</title>
<path fill="none" stroke="black" d="M6095,-5239.86C6095,-5239.86 6095,-5177.16 6095,-5177.16"/>
<polygon fill="black" stroke="black" points="6098.5,-5177.16 6095,-5167.16 6091.5,-5177.16 6098.5,-5177.16"/>
</g>
<!-- qkv_reshape_3_10 -->
<g id="node1055" class="node">
<title>qkv_reshape_3_10</title>
<ellipse fill="none" stroke="black" cx="6095" cy="-5014" rx="148" ry="27"/>
<text text-anchor="middle" x="6095" y="-5017.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="6095" y="-5002.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_3_10&#45;&gt;qkv_reshape_3_10 -->
<g id="edge1044" class="edge">
<title>qkv_proj_3_10&#45;&gt;qkv_reshape_3_10</title>
<path fill="none" stroke="black" d="M6095,-5113.98C6095,-5113.98 6095,-5051.36 6095,-5051.36"/>
<polygon fill="black" stroke="black" points="6098.5,-5051.36 6095,-5041.36 6091.5,-5051.36 6098.5,-5051.36"/>
</g>
<!-- qkv_reshape_3_10&#45;&gt;ring_attn_3_10_stage_0 -->
<g id="edge1045" class="edge">
<title>qkv_reshape_3_10&#45;&gt;ring_attn_3_10_stage_0</title>
<path fill="none" stroke="black" d="M6095,-4986.72C6095,-4986.72 6095,-4880.16 6095,-4880.16"/>
<polygon fill="black" stroke="black" points="6098.5,-4880.16 6095,-4870.16 6091.5,-4880.16 6098.5,-4880.16"/>
</g>
<!-- ring_attn_3_10_stage_0&#45;&gt;ring_attn_3_10_stage_1 -->
<g id="edge1046" class="edge">
<title>ring_attn_3_10_stage_0&#45;&gt;ring_attn_3_10_stage_1</title>
<path fill="none" stroke="black" d="M6095,-4733.87C6095,-4733.87 6095,-4627.25 6095,-4627.25"/>
<polygon fill="black" stroke="black" points="6098.5,-4627.25 6095,-4617.25 6091.5,-4627.25 6098.5,-4627.25"/>
</g>
<!-- ring_attn_3_11_stage_0 -->
<g id="node1154" class="node">
<title>ring_attn_3_11_stage_0</title>
<polygon fill="yellow" stroke="black" points="6682,-4870 6473,-4802 6682,-4734 6891,-4802 6682,-4870"/>
<text text-anchor="middle" x="6682" y="-4820.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-4805.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="6682" y="-4790.8" font-family="Times,serif" font-size="14.00">Q[11]×K[11]×V[11]</text>
<text text-anchor="middle" x="6682" y="-4775.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_10_stage_0&#45;&gt;ring_attn_3_11_stage_0 -->
<g id="edge2241" class="edge">
<title>ring_attn_3_10_stage_0&#45;&gt;ring_attn_3_11_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-4802C6304.02,-4802 6462.86,-4802 6462.86,-4802"/>
<polygon fill="red" stroke="red" points="6462.86,-4805.5 6472.86,-4802 6462.86,-4798.5 6462.86,-4805.5"/>
</g>
<!-- ring_attn_3_10_stage_1&#45;&gt;ring_attn_3_10_stage_2 -->
<g id="edge1047" class="edge">
<title>ring_attn_3_10_stage_1&#45;&gt;ring_attn_3_10_stage_2</title>
<path fill="none" stroke="black" d="M6095,-4480.87C6095,-4480.87 6095,-4374.25 6095,-4374.25"/>
<polygon fill="black" stroke="black" points="6098.5,-4374.25 6095,-4364.25 6091.5,-4374.25 6098.5,-4374.25"/>
</g>
<!-- ring_attn_3_11_stage_1 -->
<g id="node1155" class="node">
<title>ring_attn_3_11_stage_1</title>
<polygon fill="yellow" stroke="black" points="6682,-4617 6473,-4549 6682,-4481 6891,-4549 6682,-4617"/>
<text text-anchor="middle" x="6682" y="-4567.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-4552.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="6682" y="-4537.8" font-family="Times,serif" font-size="14.00">Q[11]×K[10]×V[10]</text>
<text text-anchor="middle" x="6682" y="-4522.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_10_stage_1&#45;&gt;ring_attn_3_11_stage_1 -->
<g id="edge2242" class="edge">
<title>ring_attn_3_10_stage_1&#45;&gt;ring_attn_3_11_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-4549C6304.02,-4549 6462.86,-4549 6462.86,-4549"/>
<polygon fill="red" stroke="red" points="6462.86,-4552.5 6472.86,-4549 6462.86,-4545.5 6462.86,-4552.5"/>
</g>
<!-- ring_attn_3_10_stage_2&#45;&gt;ring_attn_3_10_stage_3 -->
<g id="edge1048" class="edge">
<title>ring_attn_3_10_stage_2&#45;&gt;ring_attn_3_10_stage_3</title>
<path fill="none" stroke="black" d="M6095,-4227.87C6095,-4227.87 6095,-4121.25 6095,-4121.25"/>
<polygon fill="black" stroke="black" points="6098.5,-4121.25 6095,-4111.25 6091.5,-4121.25 6098.5,-4121.25"/>
</g>
<!-- ring_attn_3_11_stage_2 -->
<g id="node1156" class="node">
<title>ring_attn_3_11_stage_2</title>
<polygon fill="yellow" stroke="black" points="6682,-4364 6473,-4296 6682,-4228 6891,-4296 6682,-4364"/>
<text text-anchor="middle" x="6682" y="-4314.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-4299.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="6682" y="-4284.8" font-family="Times,serif" font-size="14.00">Q[11]×K[9]×V[9]</text>
<text text-anchor="middle" x="6682" y="-4269.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_10_stage_2&#45;&gt;ring_attn_3_11_stage_2 -->
<g id="edge2243" class="edge">
<title>ring_attn_3_10_stage_2&#45;&gt;ring_attn_3_11_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-4296C6304.02,-4296 6462.86,-4296 6462.86,-4296"/>
<polygon fill="red" stroke="red" points="6462.86,-4299.5 6472.86,-4296 6462.86,-4292.5 6462.86,-4299.5"/>
</g>
<!-- ring_attn_3_10_stage_3&#45;&gt;ring_attn_3_10_stage_4 -->
<g id="edge1049" class="edge">
<title>ring_attn_3_10_stage_3&#45;&gt;ring_attn_3_10_stage_4</title>
<path fill="none" stroke="black" d="M6095,-3974.87C6095,-3974.87 6095,-3868.25 6095,-3868.25"/>
<polygon fill="black" stroke="black" points="6098.5,-3868.25 6095,-3858.25 6091.5,-3868.25 6098.5,-3868.25"/>
</g>
<!-- ring_attn_3_11_stage_3 -->
<g id="node1157" class="node">
<title>ring_attn_3_11_stage_3</title>
<polygon fill="yellow" stroke="black" points="6682,-4111 6473,-4043 6682,-3975 6891,-4043 6682,-4111"/>
<text text-anchor="middle" x="6682" y="-4061.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-4046.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="6682" y="-4031.8" font-family="Times,serif" font-size="14.00">Q[11]×K[8]×V[8]</text>
<text text-anchor="middle" x="6682" y="-4016.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_10_stage_3&#45;&gt;ring_attn_3_11_stage_3 -->
<g id="edge2244" class="edge">
<title>ring_attn_3_10_stage_3&#45;&gt;ring_attn_3_11_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-4043C6304.02,-4043 6462.86,-4043 6462.86,-4043"/>
<polygon fill="red" stroke="red" points="6462.86,-4046.5 6472.86,-4043 6462.86,-4039.5 6462.86,-4046.5"/>
</g>
<!-- ring_attn_3_10_stage_4&#45;&gt;ring_attn_3_10_stage_5 -->
<g id="edge1050" class="edge">
<title>ring_attn_3_10_stage_4&#45;&gt;ring_attn_3_10_stage_5</title>
<path fill="none" stroke="black" d="M6095,-3721.87C6095,-3721.87 6095,-3615.25 6095,-3615.25"/>
<polygon fill="black" stroke="black" points="6098.5,-3615.25 6095,-3605.25 6091.5,-3615.25 6098.5,-3615.25"/>
</g>
<!-- ring_attn_3_11_stage_4 -->
<g id="node1158" class="node">
<title>ring_attn_3_11_stage_4</title>
<polygon fill="yellow" stroke="black" points="6682,-3858 6473,-3790 6682,-3722 6891,-3790 6682,-3858"/>
<text text-anchor="middle" x="6682" y="-3808.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-3793.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="6682" y="-3778.8" font-family="Times,serif" font-size="14.00">Q[11]×K[7]×V[7]</text>
<text text-anchor="middle" x="6682" y="-3763.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_10_stage_4&#45;&gt;ring_attn_3_11_stage_4 -->
<g id="edge2245" class="edge">
<title>ring_attn_3_10_stage_4&#45;&gt;ring_attn_3_11_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-3790C6304.02,-3790 6462.86,-3790 6462.86,-3790"/>
<polygon fill="red" stroke="red" points="6462.86,-3793.5 6472.86,-3790 6462.86,-3786.5 6462.86,-3793.5"/>
</g>
<!-- ring_attn_3_10_stage_5&#45;&gt;ring_attn_3_10_stage_6 -->
<g id="edge1051" class="edge">
<title>ring_attn_3_10_stage_5&#45;&gt;ring_attn_3_10_stage_6</title>
<path fill="none" stroke="black" d="M6095,-3468.87C6095,-3468.87 6095,-3362.25 6095,-3362.25"/>
<polygon fill="black" stroke="black" points="6098.5,-3362.25 6095,-3352.25 6091.5,-3362.25 6098.5,-3362.25"/>
</g>
<!-- ring_attn_3_11_stage_5 -->
<g id="node1159" class="node">
<title>ring_attn_3_11_stage_5</title>
<polygon fill="yellow" stroke="black" points="6682,-3605 6473,-3537 6682,-3469 6891,-3537 6682,-3605"/>
<text text-anchor="middle" x="6682" y="-3555.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-3540.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="6682" y="-3525.8" font-family="Times,serif" font-size="14.00">Q[11]×K[6]×V[6]</text>
<text text-anchor="middle" x="6682" y="-3510.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_10_stage_5&#45;&gt;ring_attn_3_11_stage_5 -->
<g id="edge2246" class="edge">
<title>ring_attn_3_10_stage_5&#45;&gt;ring_attn_3_11_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-3537C6304.02,-3537 6462.86,-3537 6462.86,-3537"/>
<polygon fill="red" stroke="red" points="6462.86,-3540.5 6472.86,-3537 6462.86,-3533.5 6462.86,-3540.5"/>
</g>
<!-- ring_attn_3_10_stage_6&#45;&gt;ring_attn_3_10_stage_7 -->
<g id="edge1052" class="edge">
<title>ring_attn_3_10_stage_6&#45;&gt;ring_attn_3_10_stage_7</title>
<path fill="none" stroke="black" d="M6095,-3215.87C6095,-3215.87 6095,-3109.25 6095,-3109.25"/>
<polygon fill="black" stroke="black" points="6098.5,-3109.25 6095,-3099.25 6091.5,-3109.25 6098.5,-3109.25"/>
</g>
<!-- ring_attn_3_11_stage_6 -->
<g id="node1160" class="node">
<title>ring_attn_3_11_stage_6</title>
<polygon fill="yellow" stroke="black" points="6682,-3352 6473,-3284 6682,-3216 6891,-3284 6682,-3352"/>
<text text-anchor="middle" x="6682" y="-3302.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-3287.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="6682" y="-3272.8" font-family="Times,serif" font-size="14.00">Q[11]×K[5]×V[5]</text>
<text text-anchor="middle" x="6682" y="-3257.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_10_stage_6&#45;&gt;ring_attn_3_11_stage_6 -->
<g id="edge2247" class="edge">
<title>ring_attn_3_10_stage_6&#45;&gt;ring_attn_3_11_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-3284C6304.02,-3284 6462.86,-3284 6462.86,-3284"/>
<polygon fill="red" stroke="red" points="6462.86,-3287.5 6472.86,-3284 6462.86,-3280.5 6462.86,-3287.5"/>
</g>
<!-- ring_attn_3_10_stage_7&#45;&gt;ring_attn_3_10_stage_8 -->
<g id="edge1053" class="edge">
<title>ring_attn_3_10_stage_7&#45;&gt;ring_attn_3_10_stage_8</title>
<path fill="none" stroke="black" d="M6095,-2962.87C6095,-2962.87 6095,-2856.25 6095,-2856.25"/>
<polygon fill="black" stroke="black" points="6098.5,-2856.25 6095,-2846.25 6091.5,-2856.25 6098.5,-2856.25"/>
</g>
<!-- ring_attn_3_11_stage_7 -->
<g id="node1161" class="node">
<title>ring_attn_3_11_stage_7</title>
<polygon fill="yellow" stroke="black" points="6682,-3099 6473,-3031 6682,-2963 6891,-3031 6682,-3099"/>
<text text-anchor="middle" x="6682" y="-3049.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-3034.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="6682" y="-3019.8" font-family="Times,serif" font-size="14.00">Q[11]×K[4]×V[4]</text>
<text text-anchor="middle" x="6682" y="-3004.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_10_stage_7&#45;&gt;ring_attn_3_11_stage_7 -->
<g id="edge2248" class="edge">
<title>ring_attn_3_10_stage_7&#45;&gt;ring_attn_3_11_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-3031C6304.02,-3031 6462.86,-3031 6462.86,-3031"/>
<polygon fill="red" stroke="red" points="6462.86,-3034.5 6472.86,-3031 6462.86,-3027.5 6462.86,-3034.5"/>
</g>
<!-- ring_attn_3_10_stage_8&#45;&gt;ring_attn_3_10_stage_9 -->
<g id="edge1054" class="edge">
<title>ring_attn_3_10_stage_8&#45;&gt;ring_attn_3_10_stage_9</title>
<path fill="none" stroke="black" d="M6095,-2709.87C6095,-2709.87 6095,-2603.25 6095,-2603.25"/>
<polygon fill="black" stroke="black" points="6098.5,-2603.25 6095,-2593.25 6091.5,-2603.25 6098.5,-2603.25"/>
</g>
<!-- ring_attn_3_11_stage_8 -->
<g id="node1162" class="node">
<title>ring_attn_3_11_stage_8</title>
<polygon fill="yellow" stroke="black" points="6682,-2846 6473,-2778 6682,-2710 6891,-2778 6682,-2846"/>
<text text-anchor="middle" x="6682" y="-2796.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-2781.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="6682" y="-2766.8" font-family="Times,serif" font-size="14.00">Q[11]×K[3]×V[3]</text>
<text text-anchor="middle" x="6682" y="-2751.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_10_stage_8&#45;&gt;ring_attn_3_11_stage_8 -->
<g id="edge2249" class="edge">
<title>ring_attn_3_10_stage_8&#45;&gt;ring_attn_3_11_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-2778C6304.02,-2778 6462.86,-2778 6462.86,-2778"/>
<polygon fill="red" stroke="red" points="6462.86,-2781.5 6472.86,-2778 6462.86,-2774.5 6462.86,-2781.5"/>
</g>
<!-- ring_attn_3_10_stage_9&#45;&gt;ring_attn_3_10_stage_10 -->
<g id="edge1055" class="edge">
<title>ring_attn_3_10_stage_9&#45;&gt;ring_attn_3_10_stage_10</title>
<path fill="none" stroke="black" d="M6095,-2456.87C6095,-2456.87 6095,-2350.25 6095,-2350.25"/>
<polygon fill="black" stroke="black" points="6098.5,-2350.25 6095,-2340.25 6091.5,-2350.25 6098.5,-2350.25"/>
</g>
<!-- ring_attn_3_11_stage_9 -->
<g id="node1163" class="node">
<title>ring_attn_3_11_stage_9</title>
<polygon fill="yellow" stroke="black" points="6682,-2593 6473,-2525 6682,-2457 6891,-2525 6682,-2593"/>
<text text-anchor="middle" x="6682" y="-2543.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-2528.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="6682" y="-2513.8" font-family="Times,serif" font-size="14.00">Q[11]×K[2]×V[2]</text>
<text text-anchor="middle" x="6682" y="-2498.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_10_stage_9&#45;&gt;ring_attn_3_11_stage_9 -->
<g id="edge2250" class="edge">
<title>ring_attn_3_10_stage_9&#45;&gt;ring_attn_3_11_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-2525C6304.02,-2525 6462.86,-2525 6462.86,-2525"/>
<polygon fill="red" stroke="red" points="6462.86,-2528.5 6472.86,-2525 6462.86,-2521.5 6462.86,-2528.5"/>
</g>
<!-- ring_attn_3_10_stage_10&#45;&gt;ring_attn_3_10_stage_11 -->
<g id="edge1056" class="edge">
<title>ring_attn_3_10_stage_10&#45;&gt;ring_attn_3_10_stage_11</title>
<path fill="none" stroke="black" d="M6095,-2203.87C6095,-2203.87 6095,-2097.25 6095,-2097.25"/>
<polygon fill="black" stroke="black" points="6098.5,-2097.25 6095,-2087.25 6091.5,-2097.25 6098.5,-2097.25"/>
</g>
<!-- ring_attn_3_11_stage_10 -->
<g id="node1164" class="node">
<title>ring_attn_3_11_stage_10</title>
<polygon fill="yellow" stroke="black" points="6682,-2340 6473,-2272 6682,-2204 6891,-2272 6682,-2340"/>
<text text-anchor="middle" x="6682" y="-2290.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-2275.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="6682" y="-2260.8" font-family="Times,serif" font-size="14.00">Q[11]×K[1]×V[1]</text>
<text text-anchor="middle" x="6682" y="-2245.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_10_stage_10&#45;&gt;ring_attn_3_11_stage_10 -->
<g id="edge2251" class="edge">
<title>ring_attn_3_10_stage_10&#45;&gt;ring_attn_3_11_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-2272C6304.02,-2272 6462.86,-2272 6462.86,-2272"/>
<polygon fill="red" stroke="red" points="6462.86,-2275.5 6472.86,-2272 6462.86,-2268.5 6462.86,-2275.5"/>
</g>
<!-- ring_attn_3_10_stage_11&#45;&gt;ring_attn_3_10_stage_12 -->
<g id="edge1057" class="edge">
<title>ring_attn_3_10_stage_11&#45;&gt;ring_attn_3_10_stage_12</title>
<path fill="none" stroke="black" d="M6095,-1950.87C6095,-1950.87 6095,-1844.25 6095,-1844.25"/>
<polygon fill="black" stroke="black" points="6098.5,-1844.25 6095,-1834.25 6091.5,-1844.25 6098.5,-1844.25"/>
</g>
<!-- ring_attn_3_11_stage_11 -->
<g id="node1165" class="node">
<title>ring_attn_3_11_stage_11</title>
<polygon fill="yellow" stroke="black" points="6682,-2087 6473,-2019 6682,-1951 6891,-2019 6682,-2087"/>
<text text-anchor="middle" x="6682" y="-2037.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-2022.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="6682" y="-2007.8" font-family="Times,serif" font-size="14.00">Q[11]×K[0]×V[0]</text>
<text text-anchor="middle" x="6682" y="-1992.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_10_stage_11&#45;&gt;ring_attn_3_11_stage_11 -->
<g id="edge2252" class="edge">
<title>ring_attn_3_10_stage_11&#45;&gt;ring_attn_3_11_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-2019C6304.02,-2019 6462.86,-2019 6462.86,-2019"/>
<polygon fill="red" stroke="red" points="6462.86,-2022.5 6472.86,-2019 6462.86,-2015.5 6462.86,-2022.5"/>
</g>
<!-- ring_attn_3_10_stage_12&#45;&gt;ring_attn_3_10_stage_13 -->
<g id="edge1058" class="edge">
<title>ring_attn_3_10_stage_12&#45;&gt;ring_attn_3_10_stage_13</title>
<path fill="none" stroke="black" d="M6095,-1697.87C6095,-1697.87 6095,-1591.25 6095,-1591.25"/>
<polygon fill="black" stroke="black" points="6098.5,-1591.25 6095,-1581.25 6091.5,-1591.25 6098.5,-1591.25"/>
</g>
<!-- ring_attn_3_11_stage_12 -->
<g id="node1166" class="node">
<title>ring_attn_3_11_stage_12</title>
<polygon fill="yellow" stroke="black" points="6682,-1834 6473,-1766 6682,-1698 6891,-1766 6682,-1834"/>
<text text-anchor="middle" x="6682" y="-1784.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-1769.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="6682" y="-1754.8" font-family="Times,serif" font-size="14.00">Q[11]×K[15]×V[15]</text>
<text text-anchor="middle" x="6682" y="-1739.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_10_stage_12&#45;&gt;ring_attn_3_11_stage_12 -->
<g id="edge2253" class="edge">
<title>ring_attn_3_10_stage_12&#45;&gt;ring_attn_3_11_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-1766C6304.02,-1766 6462.86,-1766 6462.86,-1766"/>
<polygon fill="red" stroke="red" points="6462.86,-1769.5 6472.86,-1766 6462.86,-1762.5 6462.86,-1769.5"/>
</g>
<!-- ring_attn_3_10_stage_13&#45;&gt;ring_attn_3_10_stage_14 -->
<g id="edge1059" class="edge">
<title>ring_attn_3_10_stage_13&#45;&gt;ring_attn_3_10_stage_14</title>
<path fill="none" stroke="black" d="M6095,-1444.87C6095,-1444.87 6095,-1338.25 6095,-1338.25"/>
<polygon fill="black" stroke="black" points="6098.5,-1338.25 6095,-1328.25 6091.5,-1338.25 6098.5,-1338.25"/>
</g>
<!-- ring_attn_3_11_stage_13 -->
<g id="node1167" class="node">
<title>ring_attn_3_11_stage_13</title>
<polygon fill="yellow" stroke="black" points="6682,-1581 6473,-1513 6682,-1445 6891,-1513 6682,-1581"/>
<text text-anchor="middle" x="6682" y="-1531.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-1516.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="6682" y="-1501.8" font-family="Times,serif" font-size="14.00">Q[11]×K[14]×V[14]</text>
<text text-anchor="middle" x="6682" y="-1486.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_10_stage_13&#45;&gt;ring_attn_3_11_stage_13 -->
<g id="edge2254" class="edge">
<title>ring_attn_3_10_stage_13&#45;&gt;ring_attn_3_11_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-1513C6304.02,-1513 6462.86,-1513 6462.86,-1513"/>
<polygon fill="red" stroke="red" points="6462.86,-1516.5 6472.86,-1513 6462.86,-1509.5 6462.86,-1516.5"/>
</g>
<!-- ring_attn_3_10_stage_14&#45;&gt;ring_attn_3_10_stage_15 -->
<g id="edge1060" class="edge">
<title>ring_attn_3_10_stage_14&#45;&gt;ring_attn_3_10_stage_15</title>
<path fill="none" stroke="black" d="M6095,-1191.87C6095,-1191.87 6095,-1085.25 6095,-1085.25"/>
<polygon fill="black" stroke="black" points="6098.5,-1085.25 6095,-1075.25 6091.5,-1085.25 6098.5,-1085.25"/>
</g>
<!-- ring_attn_3_11_stage_14 -->
<g id="node1168" class="node">
<title>ring_attn_3_11_stage_14</title>
<polygon fill="yellow" stroke="black" points="6682,-1328 6473,-1260 6682,-1192 6891,-1260 6682,-1328"/>
<text text-anchor="middle" x="6682" y="-1278.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-1263.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="6682" y="-1248.8" font-family="Times,serif" font-size="14.00">Q[11]×K[13]×V[13]</text>
<text text-anchor="middle" x="6682" y="-1233.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_10_stage_14&#45;&gt;ring_attn_3_11_stage_14 -->
<g id="edge2255" class="edge">
<title>ring_attn_3_10_stage_14&#45;&gt;ring_attn_3_11_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-1260C6304.02,-1260 6462.86,-1260 6462.86,-1260"/>
<polygon fill="red" stroke="red" points="6462.86,-1263.5 6472.86,-1260 6462.86,-1256.5 6462.86,-1263.5"/>
</g>
<!-- attn_out_3_10 -->
<g id="node1072" class="node">
<title>attn_out_3_10</title>
<polygon fill="none" stroke="black" points="6164.5,-866 6025.5,-866 6025.5,-813 6164.5,-813 6164.5,-866"/>
<text text-anchor="middle" x="6095" y="-850.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6095" y="-835.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="6095" y="-820.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_3_10_stage_15&#45;&gt;attn_out_3_10 -->
<g id="edge1061" class="edge">
<title>ring_attn_3_10_stage_15&#45;&gt;attn_out_3_10</title>
<path fill="none" stroke="black" d="M6095,-938.87C6095,-938.87 6095,-876.18 6095,-876.18"/>
<polygon fill="black" stroke="black" points="6098.5,-876.18 6095,-866.18 6091.5,-876.18 6098.5,-876.18"/>
</g>
<!-- ring_attn_3_11_stage_15 -->
<g id="node1169" class="node">
<title>ring_attn_3_11_stage_15</title>
<polygon fill="yellow" stroke="black" points="6682,-1075 6473,-1007 6682,-939 6891,-1007 6682,-1075"/>
<text text-anchor="middle" x="6682" y="-1025.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="6682" y="-1010.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="6682" y="-995.8" font-family="Times,serif" font-size="14.00">Q[11]×K[12]×V[12]</text>
<text text-anchor="middle" x="6682" y="-980.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_10_stage_15&#45;&gt;ring_attn_3_11_stage_15 -->
<g id="edge2256" class="edge">
<title>ring_attn_3_10_stage_15&#45;&gt;ring_attn_3_11_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6304.02,-1007C6304.02,-1007 6462.86,-1007 6462.86,-1007"/>
<polygon fill="red" stroke="red" points="6462.86,-1010.5 6472.86,-1007 6462.86,-1003.5 6462.86,-1010.5"/>
</g>
<!-- attn_residual_3_10 -->
<g id="node1073" class="node">
<title>attn_residual_3_10</title>
<ellipse fill="none" stroke="black" cx="6095" cy="-713" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6095" y="-716.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="6095" y="-701.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_3_10&#45;&gt;attn_residual_3_10 -->
<g id="edge1062" class="edge">
<title>attn_out_3_10&#45;&gt;attn_residual_3_10</title>
<path fill="none" stroke="black" d="M6095,-812.98C6095,-812.98 6095,-750.36 6095,-750.36"/>
<polygon fill="black" stroke="black" points="6098.5,-750.36 6095,-740.36 6091.5,-750.36 6098.5,-750.36"/>
</g>
<!-- ffn_up_3_10 -->
<g id="node1074" class="node">
<title>ffn_up_3_10</title>
<polygon fill="none" stroke="black" points="6174,-613 6016,-613 6016,-560 6174,-560 6174,-613"/>
<text text-anchor="middle" x="6095" y="-597.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="6095" y="-582.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="6095" y="-567.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_3_10&#45;&gt;ffn_up_3_10 -->
<g id="edge1063" class="edge">
<title>attn_residual_3_10&#45;&gt;ffn_up_3_10</title>
<path fill="none" stroke="black" d="M6095,-685.86C6095,-685.86 6095,-623.16 6095,-623.16"/>
<polygon fill="black" stroke="black" points="6098.5,-623.16 6095,-613.16 6091.5,-623.16 6098.5,-623.16"/>
</g>
<!-- ffn_gelu_3_10 -->
<g id="node1075" class="node">
<title>ffn_gelu_3_10</title>
<ellipse fill="none" stroke="black" cx="6095" cy="-460" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6095" y="-463.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="6095" y="-448.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_3_10&#45;&gt;ffn_gelu_3_10 -->
<g id="edge1064" class="edge">
<title>ffn_up_3_10&#45;&gt;ffn_gelu_3_10</title>
<path fill="none" stroke="black" d="M6095,-559.98C6095,-559.98 6095,-497.36 6095,-497.36"/>
<polygon fill="black" stroke="black" points="6098.5,-497.36 6095,-487.36 6091.5,-497.36 6098.5,-497.36"/>
</g>
<!-- ffn_down_3_10 -->
<g id="node1076" class="node">
<title>ffn_down_3_10</title>
<polygon fill="none" stroke="black" points="6184,-360 6006,-360 6006,-307 6184,-307 6184,-360"/>
<text text-anchor="middle" x="6095" y="-344.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6095" y="-329.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="6095" y="-314.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_3_10&#45;&gt;ffn_down_3_10 -->
<g id="edge1065" class="edge">
<title>ffn_gelu_3_10&#45;&gt;ffn_down_3_10</title>
<path fill="none" stroke="black" d="M6095,-432.86C6095,-432.86 6095,-370.16 6095,-370.16"/>
<polygon fill="black" stroke="black" points="6098.5,-370.16 6095,-360.16 6091.5,-370.16 6098.5,-370.16"/>
</g>
<!-- ffn_residual_3_10 -->
<g id="node1077" class="node">
<title>ffn_residual_3_10</title>
<ellipse fill="none" stroke="black" cx="6095" cy="-207" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6095" y="-210.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="6095" y="-195.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_3_10&#45;&gt;ffn_residual_3_10 -->
<g id="edge1066" class="edge">
<title>ffn_down_3_10&#45;&gt;ffn_residual_3_10</title>
<path fill="none" stroke="black" d="M6095,-306.98C6095,-306.98 6095,-244.36 6095,-244.36"/>
<polygon fill="black" stroke="black" points="6098.5,-244.36 6095,-234.36 6091.5,-244.36 6098.5,-244.36"/>
</g>
<!-- output_10 -->
<g id="node1078" class="node">
<title>output_10</title>
<polygon fill="lightcoral" stroke="black" points="6192.5,-107 5997.5,-107 5997.5,-69 6192.5,-69 6192.5,-107"/>
<text text-anchor="middle" x="6095" y="-91.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="6095" y="-76.8" font-family="Times,serif" font-size="14.00">Y[10]: 1024×1024×4096</text>
</g>
<!-- ffn_residual_3_10&#45;&gt;output_10 -->
<g id="edge1067" class="edge">
<title>ffn_residual_3_10&#45;&gt;output_10</title>
<path fill="none" stroke="black" d="M6095,-180C6095,-180 6095,-117.12 6095,-117.12"/>
<polygon fill="black" stroke="black" points="6098.5,-117.12 6095,-107.12 6091.5,-117.12 6098.5,-117.12"/>
</g>
<!-- input_11 -->
<g id="node1079" class="node">
<title>input_11</title>
<polygon fill="lightgreen" stroke="black" points="6780,-20458 6584,-20458 6584,-20420 6780,-20420 6780,-20458"/>
<text text-anchor="middle" x="6682" y="-20442.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="6682" y="-20427.8" font-family="Times,serif" font-size="14.00">X[11]: 1024×1024×4096</text>
</g>
<!-- qkv_proj_0_11 -->
<g id="node1080" class="node">
<title>qkv_proj_0_11</title>
<polygon fill="none" stroke="black" points="6764.5,-20347 6599.5,-20347 6599.5,-20294 6764.5,-20294 6764.5,-20347"/>
<text text-anchor="middle" x="6682" y="-20331.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6682" y="-20316.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="6682" y="-20301.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- input_11&#45;&gt;qkv_proj_0_11 -->
<g id="edge1068" class="edge">
<title>input_11&#45;&gt;qkv_proj_0_11</title>
<path fill="none" stroke="black" d="M6682,-20419.96C6682,-20419.96 6682,-20357.44 6682,-20357.44"/>
<polygon fill="black" stroke="black" points="6685.5,-20357.44 6682,-20347.44 6678.5,-20357.44 6685.5,-20357.44"/>
</g>
<!-- qkv_reshape_0_11 -->
<g id="node1081" class="node">
<title>qkv_reshape_0_11</title>
<ellipse fill="none" stroke="black" cx="6682" cy="-20194" rx="148" ry="27"/>
<text text-anchor="middle" x="6682" y="-20197.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="6682" y="-20182.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_0_11&#45;&gt;qkv_reshape_0_11 -->
<g id="edge1069" class="edge">
<title>qkv_proj_0_11&#45;&gt;qkv_reshape_0_11</title>
<path fill="none" stroke="black" d="M6682,-20293.98C6682,-20293.98 6682,-20231.36 6682,-20231.36"/>
<polygon fill="black" stroke="black" points="6685.5,-20231.36 6682,-20221.36 6678.5,-20231.36 6685.5,-20231.36"/>
</g>
<!-- qkv_reshape_0_11&#45;&gt;ring_attn_0_11_stage_0 -->
<g id="edge1070" class="edge">
<title>qkv_reshape_0_11&#45;&gt;ring_attn_0_11_stage_0</title>
<path fill="none" stroke="black" d="M6682,-20166.72C6682,-20166.72 6682,-20060.16 6682,-20060.16"/>
<polygon fill="black" stroke="black" points="6685.5,-20060.16 6682,-20050.16 6678.5,-20060.16 6685.5,-20060.16"/>
</g>
<!-- ring_attn_0_11_stage_0&#45;&gt;ring_attn_0_11_stage_1 -->
<g id="edge1071" class="edge">
<title>ring_attn_0_11_stage_0&#45;&gt;ring_attn_0_11_stage_1</title>
<path fill="none" stroke="black" d="M6682,-19913.87C6682,-19913.87 6682,-19807.25 6682,-19807.25"/>
<polygon fill="black" stroke="black" points="6685.5,-19807.25 6682,-19797.25 6678.5,-19807.25 6685.5,-19807.25"/>
</g>
<!-- ring_attn_0_12_stage_0 -->
<g id="node1180" class="node">
<title>ring_attn_0_12_stage_0</title>
<polygon fill="yellow" stroke="black" points="7269,-20050 7060,-19982 7269,-19914 7478,-19982 7269,-20050"/>
<text text-anchor="middle" x="7269" y="-20000.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-19985.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="7269" y="-19970.8" font-family="Times,serif" font-size="14.00">Q[12]×K[12]×V[12]</text>
<text text-anchor="middle" x="7269" y="-19955.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_11_stage_0&#45;&gt;ring_attn_0_12_stage_0 -->
<g id="edge2257" class="edge">
<title>ring_attn_0_11_stage_0&#45;&gt;ring_attn_0_12_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-19982C6891.02,-19982 7049.86,-19982 7049.86,-19982"/>
<polygon fill="red" stroke="red" points="7049.86,-19985.5 7059.86,-19982 7049.86,-19978.5 7049.86,-19985.5"/>
</g>
<!-- ring_attn_0_11_stage_1&#45;&gt;ring_attn_0_11_stage_2 -->
<g id="edge1072" class="edge">
<title>ring_attn_0_11_stage_1&#45;&gt;ring_attn_0_11_stage_2</title>
<path fill="none" stroke="black" d="M6682,-19660.87C6682,-19660.87 6682,-19554.25 6682,-19554.25"/>
<polygon fill="black" stroke="black" points="6685.5,-19554.25 6682,-19544.25 6678.5,-19554.25 6685.5,-19554.25"/>
</g>
<!-- ring_attn_0_12_stage_1 -->
<g id="node1181" class="node">
<title>ring_attn_0_12_stage_1</title>
<polygon fill="yellow" stroke="black" points="7269,-19797 7060,-19729 7269,-19661 7478,-19729 7269,-19797"/>
<text text-anchor="middle" x="7269" y="-19747.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-19732.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="7269" y="-19717.8" font-family="Times,serif" font-size="14.00">Q[12]×K[11]×V[11]</text>
<text text-anchor="middle" x="7269" y="-19702.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_11_stage_1&#45;&gt;ring_attn_0_12_stage_1 -->
<g id="edge2258" class="edge">
<title>ring_attn_0_11_stage_1&#45;&gt;ring_attn_0_12_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-19729C6891.02,-19729 7049.86,-19729 7049.86,-19729"/>
<polygon fill="red" stroke="red" points="7049.86,-19732.5 7059.86,-19729 7049.86,-19725.5 7049.86,-19732.5"/>
</g>
<!-- ring_attn_0_11_stage_2&#45;&gt;ring_attn_0_11_stage_3 -->
<g id="edge1073" class="edge">
<title>ring_attn_0_11_stage_2&#45;&gt;ring_attn_0_11_stage_3</title>
<path fill="none" stroke="black" d="M6682,-19407.87C6682,-19407.87 6682,-19301.25 6682,-19301.25"/>
<polygon fill="black" stroke="black" points="6685.5,-19301.25 6682,-19291.25 6678.5,-19301.25 6685.5,-19301.25"/>
</g>
<!-- ring_attn_0_12_stage_2 -->
<g id="node1182" class="node">
<title>ring_attn_0_12_stage_2</title>
<polygon fill="yellow" stroke="black" points="7269,-19544 7060,-19476 7269,-19408 7478,-19476 7269,-19544"/>
<text text-anchor="middle" x="7269" y="-19494.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-19479.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="7269" y="-19464.8" font-family="Times,serif" font-size="14.00">Q[12]×K[10]×V[10]</text>
<text text-anchor="middle" x="7269" y="-19449.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_11_stage_2&#45;&gt;ring_attn_0_12_stage_2 -->
<g id="edge2259" class="edge">
<title>ring_attn_0_11_stage_2&#45;&gt;ring_attn_0_12_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-19476C6891.02,-19476 7049.86,-19476 7049.86,-19476"/>
<polygon fill="red" stroke="red" points="7049.86,-19479.5 7059.86,-19476 7049.86,-19472.5 7049.86,-19479.5"/>
</g>
<!-- ring_attn_0_11_stage_3&#45;&gt;ring_attn_0_11_stage_4 -->
<g id="edge1074" class="edge">
<title>ring_attn_0_11_stage_3&#45;&gt;ring_attn_0_11_stage_4</title>
<path fill="none" stroke="black" d="M6682,-19154.87C6682,-19154.87 6682,-19048.25 6682,-19048.25"/>
<polygon fill="black" stroke="black" points="6685.5,-19048.25 6682,-19038.25 6678.5,-19048.25 6685.5,-19048.25"/>
</g>
<!-- ring_attn_0_12_stage_3 -->
<g id="node1183" class="node">
<title>ring_attn_0_12_stage_3</title>
<polygon fill="yellow" stroke="black" points="7269,-19291 7060,-19223 7269,-19155 7478,-19223 7269,-19291"/>
<text text-anchor="middle" x="7269" y="-19241.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-19226.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="7269" y="-19211.8" font-family="Times,serif" font-size="14.00">Q[12]×K[9]×V[9]</text>
<text text-anchor="middle" x="7269" y="-19196.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_11_stage_3&#45;&gt;ring_attn_0_12_stage_3 -->
<g id="edge2260" class="edge">
<title>ring_attn_0_11_stage_3&#45;&gt;ring_attn_0_12_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-19223C6891.02,-19223 7049.86,-19223 7049.86,-19223"/>
<polygon fill="red" stroke="red" points="7049.86,-19226.5 7059.86,-19223 7049.86,-19219.5 7049.86,-19226.5"/>
</g>
<!-- ring_attn_0_11_stage_4&#45;&gt;ring_attn_0_11_stage_5 -->
<g id="edge1075" class="edge">
<title>ring_attn_0_11_stage_4&#45;&gt;ring_attn_0_11_stage_5</title>
<path fill="none" stroke="black" d="M6682,-18901.87C6682,-18901.87 6682,-18795.25 6682,-18795.25"/>
<polygon fill="black" stroke="black" points="6685.5,-18795.25 6682,-18785.25 6678.5,-18795.25 6685.5,-18795.25"/>
</g>
<!-- ring_attn_0_12_stage_4 -->
<g id="node1184" class="node">
<title>ring_attn_0_12_stage_4</title>
<polygon fill="yellow" stroke="black" points="7269,-19038 7060,-18970 7269,-18902 7478,-18970 7269,-19038"/>
<text text-anchor="middle" x="7269" y="-18988.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-18973.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="7269" y="-18958.8" font-family="Times,serif" font-size="14.00">Q[12]×K[8]×V[8]</text>
<text text-anchor="middle" x="7269" y="-18943.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_11_stage_4&#45;&gt;ring_attn_0_12_stage_4 -->
<g id="edge2261" class="edge">
<title>ring_attn_0_11_stage_4&#45;&gt;ring_attn_0_12_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-18970C6891.02,-18970 7049.86,-18970 7049.86,-18970"/>
<polygon fill="red" stroke="red" points="7049.86,-18973.5 7059.86,-18970 7049.86,-18966.5 7049.86,-18973.5"/>
</g>
<!-- ring_attn_0_11_stage_5&#45;&gt;ring_attn_0_11_stage_6 -->
<g id="edge1076" class="edge">
<title>ring_attn_0_11_stage_5&#45;&gt;ring_attn_0_11_stage_6</title>
<path fill="none" stroke="black" d="M6682,-18648.87C6682,-18648.87 6682,-18542.25 6682,-18542.25"/>
<polygon fill="black" stroke="black" points="6685.5,-18542.25 6682,-18532.25 6678.5,-18542.25 6685.5,-18542.25"/>
</g>
<!-- ring_attn_0_12_stage_5 -->
<g id="node1185" class="node">
<title>ring_attn_0_12_stage_5</title>
<polygon fill="yellow" stroke="black" points="7269,-18785 7060,-18717 7269,-18649 7478,-18717 7269,-18785"/>
<text text-anchor="middle" x="7269" y="-18735.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-18720.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="7269" y="-18705.8" font-family="Times,serif" font-size="14.00">Q[12]×K[7]×V[7]</text>
<text text-anchor="middle" x="7269" y="-18690.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_11_stage_5&#45;&gt;ring_attn_0_12_stage_5 -->
<g id="edge2262" class="edge">
<title>ring_attn_0_11_stage_5&#45;&gt;ring_attn_0_12_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-18717C6891.02,-18717 7049.86,-18717 7049.86,-18717"/>
<polygon fill="red" stroke="red" points="7049.86,-18720.5 7059.86,-18717 7049.86,-18713.5 7049.86,-18720.5"/>
</g>
<!-- ring_attn_0_11_stage_6&#45;&gt;ring_attn_0_11_stage_7 -->
<g id="edge1077" class="edge">
<title>ring_attn_0_11_stage_6&#45;&gt;ring_attn_0_11_stage_7</title>
<path fill="none" stroke="black" d="M6682,-18395.87C6682,-18395.87 6682,-18289.25 6682,-18289.25"/>
<polygon fill="black" stroke="black" points="6685.5,-18289.25 6682,-18279.25 6678.5,-18289.25 6685.5,-18289.25"/>
</g>
<!-- ring_attn_0_12_stage_6 -->
<g id="node1186" class="node">
<title>ring_attn_0_12_stage_6</title>
<polygon fill="yellow" stroke="black" points="7269,-18532 7060,-18464 7269,-18396 7478,-18464 7269,-18532"/>
<text text-anchor="middle" x="7269" y="-18482.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-18467.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="7269" y="-18452.8" font-family="Times,serif" font-size="14.00">Q[12]×K[6]×V[6]</text>
<text text-anchor="middle" x="7269" y="-18437.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_11_stage_6&#45;&gt;ring_attn_0_12_stage_6 -->
<g id="edge2263" class="edge">
<title>ring_attn_0_11_stage_6&#45;&gt;ring_attn_0_12_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-18464C6891.02,-18464 7049.86,-18464 7049.86,-18464"/>
<polygon fill="red" stroke="red" points="7049.86,-18467.5 7059.86,-18464 7049.86,-18460.5 7049.86,-18467.5"/>
</g>
<!-- ring_attn_0_11_stage_7&#45;&gt;ring_attn_0_11_stage_8 -->
<g id="edge1078" class="edge">
<title>ring_attn_0_11_stage_7&#45;&gt;ring_attn_0_11_stage_8</title>
<path fill="none" stroke="black" d="M6682,-18142.87C6682,-18142.87 6682,-18036.25 6682,-18036.25"/>
<polygon fill="black" stroke="black" points="6685.5,-18036.25 6682,-18026.25 6678.5,-18036.25 6685.5,-18036.25"/>
</g>
<!-- ring_attn_0_12_stage_7 -->
<g id="node1187" class="node">
<title>ring_attn_0_12_stage_7</title>
<polygon fill="yellow" stroke="black" points="7269,-18279 7060,-18211 7269,-18143 7478,-18211 7269,-18279"/>
<text text-anchor="middle" x="7269" y="-18229.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-18214.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="7269" y="-18199.8" font-family="Times,serif" font-size="14.00">Q[12]×K[5]×V[5]</text>
<text text-anchor="middle" x="7269" y="-18184.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_11_stage_7&#45;&gt;ring_attn_0_12_stage_7 -->
<g id="edge2264" class="edge">
<title>ring_attn_0_11_stage_7&#45;&gt;ring_attn_0_12_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-18211C6891.02,-18211 7049.86,-18211 7049.86,-18211"/>
<polygon fill="red" stroke="red" points="7049.86,-18214.5 7059.86,-18211 7049.86,-18207.5 7049.86,-18214.5"/>
</g>
<!-- ring_attn_0_11_stage_8&#45;&gt;ring_attn_0_11_stage_9 -->
<g id="edge1079" class="edge">
<title>ring_attn_0_11_stage_8&#45;&gt;ring_attn_0_11_stage_9</title>
<path fill="none" stroke="black" d="M6682,-17889.87C6682,-17889.87 6682,-17783.25 6682,-17783.25"/>
<polygon fill="black" stroke="black" points="6685.5,-17783.25 6682,-17773.25 6678.5,-17783.25 6685.5,-17783.25"/>
</g>
<!-- ring_attn_0_12_stage_8 -->
<g id="node1188" class="node">
<title>ring_attn_0_12_stage_8</title>
<polygon fill="yellow" stroke="black" points="7269,-18026 7060,-17958 7269,-17890 7478,-17958 7269,-18026"/>
<text text-anchor="middle" x="7269" y="-17976.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-17961.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="7269" y="-17946.8" font-family="Times,serif" font-size="14.00">Q[12]×K[4]×V[4]</text>
<text text-anchor="middle" x="7269" y="-17931.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_11_stage_8&#45;&gt;ring_attn_0_12_stage_8 -->
<g id="edge2265" class="edge">
<title>ring_attn_0_11_stage_8&#45;&gt;ring_attn_0_12_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-17958C6891.02,-17958 7049.86,-17958 7049.86,-17958"/>
<polygon fill="red" stroke="red" points="7049.86,-17961.5 7059.86,-17958 7049.86,-17954.5 7049.86,-17961.5"/>
</g>
<!-- ring_attn_0_11_stage_9&#45;&gt;ring_attn_0_11_stage_10 -->
<g id="edge1080" class="edge">
<title>ring_attn_0_11_stage_9&#45;&gt;ring_attn_0_11_stage_10</title>
<path fill="none" stroke="black" d="M6682,-17636.87C6682,-17636.87 6682,-17530.25 6682,-17530.25"/>
<polygon fill="black" stroke="black" points="6685.5,-17530.25 6682,-17520.25 6678.5,-17530.25 6685.5,-17530.25"/>
</g>
<!-- ring_attn_0_12_stage_9 -->
<g id="node1189" class="node">
<title>ring_attn_0_12_stage_9</title>
<polygon fill="yellow" stroke="black" points="7269,-17773 7060,-17705 7269,-17637 7478,-17705 7269,-17773"/>
<text text-anchor="middle" x="7269" y="-17723.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-17708.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="7269" y="-17693.8" font-family="Times,serif" font-size="14.00">Q[12]×K[3]×V[3]</text>
<text text-anchor="middle" x="7269" y="-17678.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_11_stage_9&#45;&gt;ring_attn_0_12_stage_9 -->
<g id="edge2266" class="edge">
<title>ring_attn_0_11_stage_9&#45;&gt;ring_attn_0_12_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-17705C6891.02,-17705 7049.86,-17705 7049.86,-17705"/>
<polygon fill="red" stroke="red" points="7049.86,-17708.5 7059.86,-17705 7049.86,-17701.5 7049.86,-17708.5"/>
</g>
<!-- ring_attn_0_11_stage_10&#45;&gt;ring_attn_0_11_stage_11 -->
<g id="edge1081" class="edge">
<title>ring_attn_0_11_stage_10&#45;&gt;ring_attn_0_11_stage_11</title>
<path fill="none" stroke="black" d="M6682,-17383.87C6682,-17383.87 6682,-17277.25 6682,-17277.25"/>
<polygon fill="black" stroke="black" points="6685.5,-17277.25 6682,-17267.25 6678.5,-17277.25 6685.5,-17277.25"/>
</g>
<!-- ring_attn_0_12_stage_10 -->
<g id="node1190" class="node">
<title>ring_attn_0_12_stage_10</title>
<polygon fill="yellow" stroke="black" points="7269,-17520 7060,-17452 7269,-17384 7478,-17452 7269,-17520"/>
<text text-anchor="middle" x="7269" y="-17470.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-17455.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="7269" y="-17440.8" font-family="Times,serif" font-size="14.00">Q[12]×K[2]×V[2]</text>
<text text-anchor="middle" x="7269" y="-17425.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_11_stage_10&#45;&gt;ring_attn_0_12_stage_10 -->
<g id="edge2267" class="edge">
<title>ring_attn_0_11_stage_10&#45;&gt;ring_attn_0_12_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-17452C6891.02,-17452 7049.86,-17452 7049.86,-17452"/>
<polygon fill="red" stroke="red" points="7049.86,-17455.5 7059.86,-17452 7049.86,-17448.5 7049.86,-17455.5"/>
</g>
<!-- ring_attn_0_11_stage_11&#45;&gt;ring_attn_0_11_stage_12 -->
<g id="edge1082" class="edge">
<title>ring_attn_0_11_stage_11&#45;&gt;ring_attn_0_11_stage_12</title>
<path fill="none" stroke="black" d="M6682,-17130.87C6682,-17130.87 6682,-17024.25 6682,-17024.25"/>
<polygon fill="black" stroke="black" points="6685.5,-17024.25 6682,-17014.25 6678.5,-17024.25 6685.5,-17024.25"/>
</g>
<!-- ring_attn_0_12_stage_11 -->
<g id="node1191" class="node">
<title>ring_attn_0_12_stage_11</title>
<polygon fill="yellow" stroke="black" points="7269,-17267 7060,-17199 7269,-17131 7478,-17199 7269,-17267"/>
<text text-anchor="middle" x="7269" y="-17217.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-17202.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="7269" y="-17187.8" font-family="Times,serif" font-size="14.00">Q[12]×K[1]×V[1]</text>
<text text-anchor="middle" x="7269" y="-17172.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_11_stage_11&#45;&gt;ring_attn_0_12_stage_11 -->
<g id="edge2268" class="edge">
<title>ring_attn_0_11_stage_11&#45;&gt;ring_attn_0_12_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-17199C6891.02,-17199 7049.86,-17199 7049.86,-17199"/>
<polygon fill="red" stroke="red" points="7049.86,-17202.5 7059.86,-17199 7049.86,-17195.5 7049.86,-17202.5"/>
</g>
<!-- ring_attn_0_11_stage_12&#45;&gt;ring_attn_0_11_stage_13 -->
<g id="edge1083" class="edge">
<title>ring_attn_0_11_stage_12&#45;&gt;ring_attn_0_11_stage_13</title>
<path fill="none" stroke="black" d="M6682,-16877.87C6682,-16877.87 6682,-16771.25 6682,-16771.25"/>
<polygon fill="black" stroke="black" points="6685.5,-16771.25 6682,-16761.25 6678.5,-16771.25 6685.5,-16771.25"/>
</g>
<!-- ring_attn_0_12_stage_12 -->
<g id="node1192" class="node">
<title>ring_attn_0_12_stage_12</title>
<polygon fill="yellow" stroke="black" points="7269,-17014 7060,-16946 7269,-16878 7478,-16946 7269,-17014"/>
<text text-anchor="middle" x="7269" y="-16964.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-16949.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="7269" y="-16934.8" font-family="Times,serif" font-size="14.00">Q[12]×K[0]×V[0]</text>
<text text-anchor="middle" x="7269" y="-16919.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_11_stage_12&#45;&gt;ring_attn_0_12_stage_12 -->
<g id="edge2269" class="edge">
<title>ring_attn_0_11_stage_12&#45;&gt;ring_attn_0_12_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-16946C6891.02,-16946 7049.86,-16946 7049.86,-16946"/>
<polygon fill="red" stroke="red" points="7049.86,-16949.5 7059.86,-16946 7049.86,-16942.5 7049.86,-16949.5"/>
</g>
<!-- ring_attn_0_11_stage_13&#45;&gt;ring_attn_0_11_stage_14 -->
<g id="edge1084" class="edge">
<title>ring_attn_0_11_stage_13&#45;&gt;ring_attn_0_11_stage_14</title>
<path fill="none" stroke="black" d="M6682,-16624.87C6682,-16624.87 6682,-16518.25 6682,-16518.25"/>
<polygon fill="black" stroke="black" points="6685.5,-16518.25 6682,-16508.25 6678.5,-16518.25 6685.5,-16518.25"/>
</g>
<!-- ring_attn_0_12_stage_13 -->
<g id="node1193" class="node">
<title>ring_attn_0_12_stage_13</title>
<polygon fill="yellow" stroke="black" points="7269,-16761 7060,-16693 7269,-16625 7478,-16693 7269,-16761"/>
<text text-anchor="middle" x="7269" y="-16711.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-16696.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="7269" y="-16681.8" font-family="Times,serif" font-size="14.00">Q[12]×K[15]×V[15]</text>
<text text-anchor="middle" x="7269" y="-16666.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_11_stage_13&#45;&gt;ring_attn_0_12_stage_13 -->
<g id="edge2270" class="edge">
<title>ring_attn_0_11_stage_13&#45;&gt;ring_attn_0_12_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-16693C6891.02,-16693 7049.86,-16693 7049.86,-16693"/>
<polygon fill="red" stroke="red" points="7049.86,-16696.5 7059.86,-16693 7049.86,-16689.5 7049.86,-16696.5"/>
</g>
<!-- ring_attn_0_11_stage_14&#45;&gt;ring_attn_0_11_stage_15 -->
<g id="edge1085" class="edge">
<title>ring_attn_0_11_stage_14&#45;&gt;ring_attn_0_11_stage_15</title>
<path fill="none" stroke="black" d="M6682,-16371.87C6682,-16371.87 6682,-16265.25 6682,-16265.25"/>
<polygon fill="black" stroke="black" points="6685.5,-16265.25 6682,-16255.25 6678.5,-16265.25 6685.5,-16265.25"/>
</g>
<!-- ring_attn_0_12_stage_14 -->
<g id="node1194" class="node">
<title>ring_attn_0_12_stage_14</title>
<polygon fill="yellow" stroke="black" points="7269,-16508 7060,-16440 7269,-16372 7478,-16440 7269,-16508"/>
<text text-anchor="middle" x="7269" y="-16458.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-16443.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="7269" y="-16428.8" font-family="Times,serif" font-size="14.00">Q[12]×K[14]×V[14]</text>
<text text-anchor="middle" x="7269" y="-16413.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_11_stage_14&#45;&gt;ring_attn_0_12_stage_14 -->
<g id="edge2271" class="edge">
<title>ring_attn_0_11_stage_14&#45;&gt;ring_attn_0_12_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-16440C6891.02,-16440 7049.86,-16440 7049.86,-16440"/>
<polygon fill="red" stroke="red" points="7049.86,-16443.5 7059.86,-16440 7049.86,-16436.5 7049.86,-16443.5"/>
</g>
<!-- attn_out_0_11 -->
<g id="node1098" class="node">
<title>attn_out_0_11</title>
<polygon fill="none" stroke="black" points="6751.5,-16046 6612.5,-16046 6612.5,-15993 6751.5,-15993 6751.5,-16046"/>
<text text-anchor="middle" x="6682" y="-16030.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6682" y="-16015.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="6682" y="-16000.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_0_11_stage_15&#45;&gt;attn_out_0_11 -->
<g id="edge1086" class="edge">
<title>ring_attn_0_11_stage_15&#45;&gt;attn_out_0_11</title>
<path fill="none" stroke="black" d="M6682,-16118.87C6682,-16118.87 6682,-16056.18 6682,-16056.18"/>
<polygon fill="black" stroke="black" points="6685.5,-16056.18 6682,-16046.18 6678.5,-16056.18 6685.5,-16056.18"/>
</g>
<!-- ring_attn_0_12_stage_15 -->
<g id="node1195" class="node">
<title>ring_attn_0_12_stage_15</title>
<polygon fill="yellow" stroke="black" points="7269,-16255 7060,-16187 7269,-16119 7478,-16187 7269,-16255"/>
<text text-anchor="middle" x="7269" y="-16205.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-16190.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="7269" y="-16175.8" font-family="Times,serif" font-size="14.00">Q[12]×K[13]×V[13]</text>
<text text-anchor="middle" x="7269" y="-16160.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_11_stage_15&#45;&gt;ring_attn_0_12_stage_15 -->
<g id="edge2272" class="edge">
<title>ring_attn_0_11_stage_15&#45;&gt;ring_attn_0_12_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-16187C6891.02,-16187 7049.86,-16187 7049.86,-16187"/>
<polygon fill="red" stroke="red" points="7049.86,-16190.5 7059.86,-16187 7049.86,-16183.5 7049.86,-16190.5"/>
</g>
<!-- attn_residual_0_11 -->
<g id="node1099" class="node">
<title>attn_residual_0_11</title>
<ellipse fill="none" stroke="black" cx="6682" cy="-15893" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6682" y="-15896.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="6682" y="-15881.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_0_11&#45;&gt;attn_residual_0_11 -->
<g id="edge1087" class="edge">
<title>attn_out_0_11&#45;&gt;attn_residual_0_11</title>
<path fill="none" stroke="black" d="M6682,-15992.98C6682,-15992.98 6682,-15930.36 6682,-15930.36"/>
<polygon fill="black" stroke="black" points="6685.5,-15930.36 6682,-15920.36 6678.5,-15930.36 6685.5,-15930.36"/>
</g>
<!-- ffn_up_0_11 -->
<g id="node1100" class="node">
<title>ffn_up_0_11</title>
<polygon fill="none" stroke="black" points="6761,-15793 6603,-15793 6603,-15740 6761,-15740 6761,-15793"/>
<text text-anchor="middle" x="6682" y="-15777.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="6682" y="-15762.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="6682" y="-15747.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_0_11&#45;&gt;ffn_up_0_11 -->
<g id="edge1088" class="edge">
<title>attn_residual_0_11&#45;&gt;ffn_up_0_11</title>
<path fill="none" stroke="black" d="M6682,-15865.86C6682,-15865.86 6682,-15803.16 6682,-15803.16"/>
<polygon fill="black" stroke="black" points="6685.5,-15803.16 6682,-15793.16 6678.5,-15803.16 6685.5,-15803.16"/>
</g>
<!-- ffn_gelu_0_11 -->
<g id="node1101" class="node">
<title>ffn_gelu_0_11</title>
<ellipse fill="none" stroke="black" cx="6682" cy="-15640" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6682" y="-15643.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="6682" y="-15628.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_0_11&#45;&gt;ffn_gelu_0_11 -->
<g id="edge1089" class="edge">
<title>ffn_up_0_11&#45;&gt;ffn_gelu_0_11</title>
<path fill="none" stroke="black" d="M6682,-15739.98C6682,-15739.98 6682,-15677.36 6682,-15677.36"/>
<polygon fill="black" stroke="black" points="6685.5,-15677.36 6682,-15667.36 6678.5,-15677.36 6685.5,-15677.36"/>
</g>
<!-- ffn_down_0_11 -->
<g id="node1102" class="node">
<title>ffn_down_0_11</title>
<polygon fill="none" stroke="black" points="6771,-15540 6593,-15540 6593,-15487 6771,-15487 6771,-15540"/>
<text text-anchor="middle" x="6682" y="-15524.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6682" y="-15509.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="6682" y="-15494.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_0_11&#45;&gt;ffn_down_0_11 -->
<g id="edge1090" class="edge">
<title>ffn_gelu_0_11&#45;&gt;ffn_down_0_11</title>
<path fill="none" stroke="black" d="M6682,-15612.86C6682,-15612.86 6682,-15550.16 6682,-15550.16"/>
<polygon fill="black" stroke="black" points="6685.5,-15550.16 6682,-15540.16 6678.5,-15550.16 6685.5,-15550.16"/>
</g>
<!-- ffn_residual_0_11 -->
<g id="node1103" class="node">
<title>ffn_residual_0_11</title>
<ellipse fill="none" stroke="black" cx="6682" cy="-15387" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6682" y="-15390.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="6682" y="-15375.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_0_11&#45;&gt;ffn_residual_0_11 -->
<g id="edge1091" class="edge">
<title>ffn_down_0_11&#45;&gt;ffn_residual_0_11</title>
<path fill="none" stroke="black" d="M6682,-15486.98C6682,-15486.98 6682,-15424.36 6682,-15424.36"/>
<polygon fill="black" stroke="black" points="6685.5,-15424.36 6682,-15414.36 6678.5,-15424.36 6685.5,-15424.36"/>
</g>
<!-- qkv_proj_1_11 -->
<g id="node1104" class="node">
<title>qkv_proj_1_11</title>
<polygon fill="none" stroke="black" points="6764.5,-15287 6599.5,-15287 6599.5,-15234 6764.5,-15234 6764.5,-15287"/>
<text text-anchor="middle" x="6682" y="-15271.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6682" y="-15256.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="6682" y="-15241.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_0_11&#45;&gt;qkv_proj_1_11 -->
<g id="edge1092" class="edge">
<title>ffn_residual_0_11&#45;&gt;qkv_proj_1_11</title>
<path fill="none" stroke="black" d="M6682,-15359.86C6682,-15359.86 6682,-15297.16 6682,-15297.16"/>
<polygon fill="black" stroke="black" points="6685.5,-15297.16 6682,-15287.16 6678.5,-15297.16 6685.5,-15297.16"/>
</g>
<!-- qkv_reshape_1_11 -->
<g id="node1105" class="node">
<title>qkv_reshape_1_11</title>
<ellipse fill="none" stroke="black" cx="6682" cy="-15134" rx="148" ry="27"/>
<text text-anchor="middle" x="6682" y="-15137.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="6682" y="-15122.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_1_11&#45;&gt;qkv_reshape_1_11 -->
<g id="edge1093" class="edge">
<title>qkv_proj_1_11&#45;&gt;qkv_reshape_1_11</title>
<path fill="none" stroke="black" d="M6682,-15233.98C6682,-15233.98 6682,-15171.36 6682,-15171.36"/>
<polygon fill="black" stroke="black" points="6685.5,-15171.36 6682,-15161.36 6678.5,-15171.36 6685.5,-15171.36"/>
</g>
<!-- qkv_reshape_1_11&#45;&gt;ring_attn_1_11_stage_0 -->
<g id="edge1094" class="edge">
<title>qkv_reshape_1_11&#45;&gt;ring_attn_1_11_stage_0</title>
<path fill="none" stroke="black" d="M6682,-15106.72C6682,-15106.72 6682,-15000.16 6682,-15000.16"/>
<polygon fill="black" stroke="black" points="6685.5,-15000.16 6682,-14990.16 6678.5,-15000.16 6685.5,-15000.16"/>
</g>
<!-- ring_attn_1_11_stage_0&#45;&gt;ring_attn_1_11_stage_1 -->
<g id="edge1095" class="edge">
<title>ring_attn_1_11_stage_0&#45;&gt;ring_attn_1_11_stage_1</title>
<path fill="none" stroke="black" d="M6682,-14853.87C6682,-14853.87 6682,-14747.25 6682,-14747.25"/>
<polygon fill="black" stroke="black" points="6685.5,-14747.25 6682,-14737.25 6678.5,-14747.25 6685.5,-14747.25"/>
</g>
<!-- ring_attn_1_12_stage_0 -->
<g id="node1204" class="node">
<title>ring_attn_1_12_stage_0</title>
<polygon fill="yellow" stroke="black" points="7269,-14990 7060,-14922 7269,-14854 7478,-14922 7269,-14990"/>
<text text-anchor="middle" x="7269" y="-14940.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-14925.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="7269" y="-14910.8" font-family="Times,serif" font-size="14.00">Q[12]×K[12]×V[12]</text>
<text text-anchor="middle" x="7269" y="-14895.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_11_stage_0&#45;&gt;ring_attn_1_12_stage_0 -->
<g id="edge2273" class="edge">
<title>ring_attn_1_11_stage_0&#45;&gt;ring_attn_1_12_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-14922C6891.02,-14922 7049.86,-14922 7049.86,-14922"/>
<polygon fill="red" stroke="red" points="7049.86,-14925.5 7059.86,-14922 7049.86,-14918.5 7049.86,-14925.5"/>
</g>
<!-- ring_attn_1_11_stage_1&#45;&gt;ring_attn_1_11_stage_2 -->
<g id="edge1096" class="edge">
<title>ring_attn_1_11_stage_1&#45;&gt;ring_attn_1_11_stage_2</title>
<path fill="none" stroke="black" d="M6682,-14600.87C6682,-14600.87 6682,-14494.25 6682,-14494.25"/>
<polygon fill="black" stroke="black" points="6685.5,-14494.25 6682,-14484.25 6678.5,-14494.25 6685.5,-14494.25"/>
</g>
<!-- ring_attn_1_12_stage_1 -->
<g id="node1205" class="node">
<title>ring_attn_1_12_stage_1</title>
<polygon fill="yellow" stroke="black" points="7269,-14737 7060,-14669 7269,-14601 7478,-14669 7269,-14737"/>
<text text-anchor="middle" x="7269" y="-14687.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-14672.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="7269" y="-14657.8" font-family="Times,serif" font-size="14.00">Q[12]×K[11]×V[11]</text>
<text text-anchor="middle" x="7269" y="-14642.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_11_stage_1&#45;&gt;ring_attn_1_12_stage_1 -->
<g id="edge2274" class="edge">
<title>ring_attn_1_11_stage_1&#45;&gt;ring_attn_1_12_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-14669C6891.02,-14669 7049.86,-14669 7049.86,-14669"/>
<polygon fill="red" stroke="red" points="7049.86,-14672.5 7059.86,-14669 7049.86,-14665.5 7049.86,-14672.5"/>
</g>
<!-- ring_attn_1_11_stage_2&#45;&gt;ring_attn_1_11_stage_3 -->
<g id="edge1097" class="edge">
<title>ring_attn_1_11_stage_2&#45;&gt;ring_attn_1_11_stage_3</title>
<path fill="none" stroke="black" d="M6682,-14347.87C6682,-14347.87 6682,-14241.25 6682,-14241.25"/>
<polygon fill="black" stroke="black" points="6685.5,-14241.25 6682,-14231.25 6678.5,-14241.25 6685.5,-14241.25"/>
</g>
<!-- ring_attn_1_12_stage_2 -->
<g id="node1206" class="node">
<title>ring_attn_1_12_stage_2</title>
<polygon fill="yellow" stroke="black" points="7269,-14484 7060,-14416 7269,-14348 7478,-14416 7269,-14484"/>
<text text-anchor="middle" x="7269" y="-14434.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-14419.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="7269" y="-14404.8" font-family="Times,serif" font-size="14.00">Q[12]×K[10]×V[10]</text>
<text text-anchor="middle" x="7269" y="-14389.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_11_stage_2&#45;&gt;ring_attn_1_12_stage_2 -->
<g id="edge2275" class="edge">
<title>ring_attn_1_11_stage_2&#45;&gt;ring_attn_1_12_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-14416C6891.02,-14416 7049.86,-14416 7049.86,-14416"/>
<polygon fill="red" stroke="red" points="7049.86,-14419.5 7059.86,-14416 7049.86,-14412.5 7049.86,-14419.5"/>
</g>
<!-- ring_attn_1_11_stage_3&#45;&gt;ring_attn_1_11_stage_4 -->
<g id="edge1098" class="edge">
<title>ring_attn_1_11_stage_3&#45;&gt;ring_attn_1_11_stage_4</title>
<path fill="none" stroke="black" d="M6682,-14094.87C6682,-14094.87 6682,-13988.25 6682,-13988.25"/>
<polygon fill="black" stroke="black" points="6685.5,-13988.25 6682,-13978.25 6678.5,-13988.25 6685.5,-13988.25"/>
</g>
<!-- ring_attn_1_12_stage_3 -->
<g id="node1207" class="node">
<title>ring_attn_1_12_stage_3</title>
<polygon fill="yellow" stroke="black" points="7269,-14231 7060,-14163 7269,-14095 7478,-14163 7269,-14231"/>
<text text-anchor="middle" x="7269" y="-14181.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-14166.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="7269" y="-14151.8" font-family="Times,serif" font-size="14.00">Q[12]×K[9]×V[9]</text>
<text text-anchor="middle" x="7269" y="-14136.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_11_stage_3&#45;&gt;ring_attn_1_12_stage_3 -->
<g id="edge2276" class="edge">
<title>ring_attn_1_11_stage_3&#45;&gt;ring_attn_1_12_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-14163C6891.02,-14163 7049.86,-14163 7049.86,-14163"/>
<polygon fill="red" stroke="red" points="7049.86,-14166.5 7059.86,-14163 7049.86,-14159.5 7049.86,-14166.5"/>
</g>
<!-- ring_attn_1_11_stage_4&#45;&gt;ring_attn_1_11_stage_5 -->
<g id="edge1099" class="edge">
<title>ring_attn_1_11_stage_4&#45;&gt;ring_attn_1_11_stage_5</title>
<path fill="none" stroke="black" d="M6682,-13841.87C6682,-13841.87 6682,-13735.25 6682,-13735.25"/>
<polygon fill="black" stroke="black" points="6685.5,-13735.25 6682,-13725.25 6678.5,-13735.25 6685.5,-13735.25"/>
</g>
<!-- ring_attn_1_12_stage_4 -->
<g id="node1208" class="node">
<title>ring_attn_1_12_stage_4</title>
<polygon fill="yellow" stroke="black" points="7269,-13978 7060,-13910 7269,-13842 7478,-13910 7269,-13978"/>
<text text-anchor="middle" x="7269" y="-13928.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-13913.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="7269" y="-13898.8" font-family="Times,serif" font-size="14.00">Q[12]×K[8]×V[8]</text>
<text text-anchor="middle" x="7269" y="-13883.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_11_stage_4&#45;&gt;ring_attn_1_12_stage_4 -->
<g id="edge2277" class="edge">
<title>ring_attn_1_11_stage_4&#45;&gt;ring_attn_1_12_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-13910C6891.02,-13910 7049.86,-13910 7049.86,-13910"/>
<polygon fill="red" stroke="red" points="7049.86,-13913.5 7059.86,-13910 7049.86,-13906.5 7049.86,-13913.5"/>
</g>
<!-- ring_attn_1_11_stage_5&#45;&gt;ring_attn_1_11_stage_6 -->
<g id="edge1100" class="edge">
<title>ring_attn_1_11_stage_5&#45;&gt;ring_attn_1_11_stage_6</title>
<path fill="none" stroke="black" d="M6682,-13588.87C6682,-13588.87 6682,-13482.25 6682,-13482.25"/>
<polygon fill="black" stroke="black" points="6685.5,-13482.25 6682,-13472.25 6678.5,-13482.25 6685.5,-13482.25"/>
</g>
<!-- ring_attn_1_12_stage_5 -->
<g id="node1209" class="node">
<title>ring_attn_1_12_stage_5</title>
<polygon fill="yellow" stroke="black" points="7269,-13725 7060,-13657 7269,-13589 7478,-13657 7269,-13725"/>
<text text-anchor="middle" x="7269" y="-13675.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-13660.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="7269" y="-13645.8" font-family="Times,serif" font-size="14.00">Q[12]×K[7]×V[7]</text>
<text text-anchor="middle" x="7269" y="-13630.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_11_stage_5&#45;&gt;ring_attn_1_12_stage_5 -->
<g id="edge2278" class="edge">
<title>ring_attn_1_11_stage_5&#45;&gt;ring_attn_1_12_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-13657C6891.02,-13657 7049.86,-13657 7049.86,-13657"/>
<polygon fill="red" stroke="red" points="7049.86,-13660.5 7059.86,-13657 7049.86,-13653.5 7049.86,-13660.5"/>
</g>
<!-- ring_attn_1_11_stage_6&#45;&gt;ring_attn_1_11_stage_7 -->
<g id="edge1101" class="edge">
<title>ring_attn_1_11_stage_6&#45;&gt;ring_attn_1_11_stage_7</title>
<path fill="none" stroke="black" d="M6682,-13335.87C6682,-13335.87 6682,-13229.25 6682,-13229.25"/>
<polygon fill="black" stroke="black" points="6685.5,-13229.25 6682,-13219.25 6678.5,-13229.25 6685.5,-13229.25"/>
</g>
<!-- ring_attn_1_12_stage_6 -->
<g id="node1210" class="node">
<title>ring_attn_1_12_stage_6</title>
<polygon fill="yellow" stroke="black" points="7269,-13472 7060,-13404 7269,-13336 7478,-13404 7269,-13472"/>
<text text-anchor="middle" x="7269" y="-13422.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-13407.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="7269" y="-13392.8" font-family="Times,serif" font-size="14.00">Q[12]×K[6]×V[6]</text>
<text text-anchor="middle" x="7269" y="-13377.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_11_stage_6&#45;&gt;ring_attn_1_12_stage_6 -->
<g id="edge2279" class="edge">
<title>ring_attn_1_11_stage_6&#45;&gt;ring_attn_1_12_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-13404C6891.02,-13404 7049.86,-13404 7049.86,-13404"/>
<polygon fill="red" stroke="red" points="7049.86,-13407.5 7059.86,-13404 7049.86,-13400.5 7049.86,-13407.5"/>
</g>
<!-- ring_attn_1_11_stage_7&#45;&gt;ring_attn_1_11_stage_8 -->
<g id="edge1102" class="edge">
<title>ring_attn_1_11_stage_7&#45;&gt;ring_attn_1_11_stage_8</title>
<path fill="none" stroke="black" d="M6682,-13082.87C6682,-13082.87 6682,-12976.25 6682,-12976.25"/>
<polygon fill="black" stroke="black" points="6685.5,-12976.25 6682,-12966.25 6678.5,-12976.25 6685.5,-12976.25"/>
</g>
<!-- ring_attn_1_12_stage_7 -->
<g id="node1211" class="node">
<title>ring_attn_1_12_stage_7</title>
<polygon fill="yellow" stroke="black" points="7269,-13219 7060,-13151 7269,-13083 7478,-13151 7269,-13219"/>
<text text-anchor="middle" x="7269" y="-13169.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-13154.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="7269" y="-13139.8" font-family="Times,serif" font-size="14.00">Q[12]×K[5]×V[5]</text>
<text text-anchor="middle" x="7269" y="-13124.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_11_stage_7&#45;&gt;ring_attn_1_12_stage_7 -->
<g id="edge2280" class="edge">
<title>ring_attn_1_11_stage_7&#45;&gt;ring_attn_1_12_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-13151C6891.02,-13151 7049.86,-13151 7049.86,-13151"/>
<polygon fill="red" stroke="red" points="7049.86,-13154.5 7059.86,-13151 7049.86,-13147.5 7049.86,-13154.5"/>
</g>
<!-- ring_attn_1_11_stage_8&#45;&gt;ring_attn_1_11_stage_9 -->
<g id="edge1103" class="edge">
<title>ring_attn_1_11_stage_8&#45;&gt;ring_attn_1_11_stage_9</title>
<path fill="none" stroke="black" d="M6682,-12829.87C6682,-12829.87 6682,-12723.25 6682,-12723.25"/>
<polygon fill="black" stroke="black" points="6685.5,-12723.25 6682,-12713.25 6678.5,-12723.25 6685.5,-12723.25"/>
</g>
<!-- ring_attn_1_12_stage_8 -->
<g id="node1212" class="node">
<title>ring_attn_1_12_stage_8</title>
<polygon fill="yellow" stroke="black" points="7269,-12966 7060,-12898 7269,-12830 7478,-12898 7269,-12966"/>
<text text-anchor="middle" x="7269" y="-12916.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-12901.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="7269" y="-12886.8" font-family="Times,serif" font-size="14.00">Q[12]×K[4]×V[4]</text>
<text text-anchor="middle" x="7269" y="-12871.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_11_stage_8&#45;&gt;ring_attn_1_12_stage_8 -->
<g id="edge2281" class="edge">
<title>ring_attn_1_11_stage_8&#45;&gt;ring_attn_1_12_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-12898C6891.02,-12898 7049.86,-12898 7049.86,-12898"/>
<polygon fill="red" stroke="red" points="7049.86,-12901.5 7059.86,-12898 7049.86,-12894.5 7049.86,-12901.5"/>
</g>
<!-- ring_attn_1_11_stage_9&#45;&gt;ring_attn_1_11_stage_10 -->
<g id="edge1104" class="edge">
<title>ring_attn_1_11_stage_9&#45;&gt;ring_attn_1_11_stage_10</title>
<path fill="none" stroke="black" d="M6682,-12576.87C6682,-12576.87 6682,-12470.25 6682,-12470.25"/>
<polygon fill="black" stroke="black" points="6685.5,-12470.25 6682,-12460.25 6678.5,-12470.25 6685.5,-12470.25"/>
</g>
<!-- ring_attn_1_12_stage_9 -->
<g id="node1213" class="node">
<title>ring_attn_1_12_stage_9</title>
<polygon fill="yellow" stroke="black" points="7269,-12713 7060,-12645 7269,-12577 7478,-12645 7269,-12713"/>
<text text-anchor="middle" x="7269" y="-12663.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-12648.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="7269" y="-12633.8" font-family="Times,serif" font-size="14.00">Q[12]×K[3]×V[3]</text>
<text text-anchor="middle" x="7269" y="-12618.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_11_stage_9&#45;&gt;ring_attn_1_12_stage_9 -->
<g id="edge2282" class="edge">
<title>ring_attn_1_11_stage_9&#45;&gt;ring_attn_1_12_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-12645C6891.02,-12645 7049.86,-12645 7049.86,-12645"/>
<polygon fill="red" stroke="red" points="7049.86,-12648.5 7059.86,-12645 7049.86,-12641.5 7049.86,-12648.5"/>
</g>
<!-- ring_attn_1_11_stage_10&#45;&gt;ring_attn_1_11_stage_11 -->
<g id="edge1105" class="edge">
<title>ring_attn_1_11_stage_10&#45;&gt;ring_attn_1_11_stage_11</title>
<path fill="none" stroke="black" d="M6682,-12323.87C6682,-12323.87 6682,-12217.25 6682,-12217.25"/>
<polygon fill="black" stroke="black" points="6685.5,-12217.25 6682,-12207.25 6678.5,-12217.25 6685.5,-12217.25"/>
</g>
<!-- ring_attn_1_12_stage_10 -->
<g id="node1214" class="node">
<title>ring_attn_1_12_stage_10</title>
<polygon fill="yellow" stroke="black" points="7269,-12460 7060,-12392 7269,-12324 7478,-12392 7269,-12460"/>
<text text-anchor="middle" x="7269" y="-12410.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-12395.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="7269" y="-12380.8" font-family="Times,serif" font-size="14.00">Q[12]×K[2]×V[2]</text>
<text text-anchor="middle" x="7269" y="-12365.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_11_stage_10&#45;&gt;ring_attn_1_12_stage_10 -->
<g id="edge2283" class="edge">
<title>ring_attn_1_11_stage_10&#45;&gt;ring_attn_1_12_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-12392C6891.02,-12392 7049.86,-12392 7049.86,-12392"/>
<polygon fill="red" stroke="red" points="7049.86,-12395.5 7059.86,-12392 7049.86,-12388.5 7049.86,-12395.5"/>
</g>
<!-- ring_attn_1_11_stage_11&#45;&gt;ring_attn_1_11_stage_12 -->
<g id="edge1106" class="edge">
<title>ring_attn_1_11_stage_11&#45;&gt;ring_attn_1_11_stage_12</title>
<path fill="none" stroke="black" d="M6682,-12070.87C6682,-12070.87 6682,-11964.25 6682,-11964.25"/>
<polygon fill="black" stroke="black" points="6685.5,-11964.25 6682,-11954.25 6678.5,-11964.25 6685.5,-11964.25"/>
</g>
<!-- ring_attn_1_12_stage_11 -->
<g id="node1215" class="node">
<title>ring_attn_1_12_stage_11</title>
<polygon fill="yellow" stroke="black" points="7269,-12207 7060,-12139 7269,-12071 7478,-12139 7269,-12207"/>
<text text-anchor="middle" x="7269" y="-12157.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-12142.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="7269" y="-12127.8" font-family="Times,serif" font-size="14.00">Q[12]×K[1]×V[1]</text>
<text text-anchor="middle" x="7269" y="-12112.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_11_stage_11&#45;&gt;ring_attn_1_12_stage_11 -->
<g id="edge2284" class="edge">
<title>ring_attn_1_11_stage_11&#45;&gt;ring_attn_1_12_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-12139C6891.02,-12139 7049.86,-12139 7049.86,-12139"/>
<polygon fill="red" stroke="red" points="7049.86,-12142.5 7059.86,-12139 7049.86,-12135.5 7049.86,-12142.5"/>
</g>
<!-- ring_attn_1_11_stage_12&#45;&gt;ring_attn_1_11_stage_13 -->
<g id="edge1107" class="edge">
<title>ring_attn_1_11_stage_12&#45;&gt;ring_attn_1_11_stage_13</title>
<path fill="none" stroke="black" d="M6682,-11817.87C6682,-11817.87 6682,-11711.25 6682,-11711.25"/>
<polygon fill="black" stroke="black" points="6685.5,-11711.25 6682,-11701.25 6678.5,-11711.25 6685.5,-11711.25"/>
</g>
<!-- ring_attn_1_12_stage_12 -->
<g id="node1216" class="node">
<title>ring_attn_1_12_stage_12</title>
<polygon fill="yellow" stroke="black" points="7269,-11954 7060,-11886 7269,-11818 7478,-11886 7269,-11954"/>
<text text-anchor="middle" x="7269" y="-11904.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-11889.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="7269" y="-11874.8" font-family="Times,serif" font-size="14.00">Q[12]×K[0]×V[0]</text>
<text text-anchor="middle" x="7269" y="-11859.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_11_stage_12&#45;&gt;ring_attn_1_12_stage_12 -->
<g id="edge2285" class="edge">
<title>ring_attn_1_11_stage_12&#45;&gt;ring_attn_1_12_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-11886C6891.02,-11886 7049.86,-11886 7049.86,-11886"/>
<polygon fill="red" stroke="red" points="7049.86,-11889.5 7059.86,-11886 7049.86,-11882.5 7049.86,-11889.5"/>
</g>
<!-- ring_attn_1_11_stage_13&#45;&gt;ring_attn_1_11_stage_14 -->
<g id="edge1108" class="edge">
<title>ring_attn_1_11_stage_13&#45;&gt;ring_attn_1_11_stage_14</title>
<path fill="none" stroke="black" d="M6682,-11564.87C6682,-11564.87 6682,-11458.25 6682,-11458.25"/>
<polygon fill="black" stroke="black" points="6685.5,-11458.25 6682,-11448.25 6678.5,-11458.25 6685.5,-11458.25"/>
</g>
<!-- ring_attn_1_12_stage_13 -->
<g id="node1217" class="node">
<title>ring_attn_1_12_stage_13</title>
<polygon fill="yellow" stroke="black" points="7269,-11701 7060,-11633 7269,-11565 7478,-11633 7269,-11701"/>
<text text-anchor="middle" x="7269" y="-11651.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-11636.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="7269" y="-11621.8" font-family="Times,serif" font-size="14.00">Q[12]×K[15]×V[15]</text>
<text text-anchor="middle" x="7269" y="-11606.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_11_stage_13&#45;&gt;ring_attn_1_12_stage_13 -->
<g id="edge2286" class="edge">
<title>ring_attn_1_11_stage_13&#45;&gt;ring_attn_1_12_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-11633C6891.02,-11633 7049.86,-11633 7049.86,-11633"/>
<polygon fill="red" stroke="red" points="7049.86,-11636.5 7059.86,-11633 7049.86,-11629.5 7049.86,-11636.5"/>
</g>
<!-- ring_attn_1_11_stage_14&#45;&gt;ring_attn_1_11_stage_15 -->
<g id="edge1109" class="edge">
<title>ring_attn_1_11_stage_14&#45;&gt;ring_attn_1_11_stage_15</title>
<path fill="none" stroke="black" d="M6682,-11311.87C6682,-11311.87 6682,-11205.25 6682,-11205.25"/>
<polygon fill="black" stroke="black" points="6685.5,-11205.25 6682,-11195.25 6678.5,-11205.25 6685.5,-11205.25"/>
</g>
<!-- ring_attn_1_12_stage_14 -->
<g id="node1218" class="node">
<title>ring_attn_1_12_stage_14</title>
<polygon fill="yellow" stroke="black" points="7269,-11448 7060,-11380 7269,-11312 7478,-11380 7269,-11448"/>
<text text-anchor="middle" x="7269" y="-11398.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-11383.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="7269" y="-11368.8" font-family="Times,serif" font-size="14.00">Q[12]×K[14]×V[14]</text>
<text text-anchor="middle" x="7269" y="-11353.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_11_stage_14&#45;&gt;ring_attn_1_12_stage_14 -->
<g id="edge2287" class="edge">
<title>ring_attn_1_11_stage_14&#45;&gt;ring_attn_1_12_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-11380C6891.02,-11380 7049.86,-11380 7049.86,-11380"/>
<polygon fill="red" stroke="red" points="7049.86,-11383.5 7059.86,-11380 7049.86,-11376.5 7049.86,-11383.5"/>
</g>
<!-- attn_out_1_11 -->
<g id="node1122" class="node">
<title>attn_out_1_11</title>
<polygon fill="none" stroke="black" points="6751.5,-10986 6612.5,-10986 6612.5,-10933 6751.5,-10933 6751.5,-10986"/>
<text text-anchor="middle" x="6682" y="-10970.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6682" y="-10955.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="6682" y="-10940.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_1_11_stage_15&#45;&gt;attn_out_1_11 -->
<g id="edge1110" class="edge">
<title>ring_attn_1_11_stage_15&#45;&gt;attn_out_1_11</title>
<path fill="none" stroke="black" d="M6682,-11058.87C6682,-11058.87 6682,-10996.18 6682,-10996.18"/>
<polygon fill="black" stroke="black" points="6685.5,-10996.18 6682,-10986.18 6678.5,-10996.18 6685.5,-10996.18"/>
</g>
<!-- ring_attn_1_12_stage_15 -->
<g id="node1219" class="node">
<title>ring_attn_1_12_stage_15</title>
<polygon fill="yellow" stroke="black" points="7269,-11195 7060,-11127 7269,-11059 7478,-11127 7269,-11195"/>
<text text-anchor="middle" x="7269" y="-11145.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-11130.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="7269" y="-11115.8" font-family="Times,serif" font-size="14.00">Q[12]×K[13]×V[13]</text>
<text text-anchor="middle" x="7269" y="-11100.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_11_stage_15&#45;&gt;ring_attn_1_12_stage_15 -->
<g id="edge2288" class="edge">
<title>ring_attn_1_11_stage_15&#45;&gt;ring_attn_1_12_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-11127C6891.02,-11127 7049.86,-11127 7049.86,-11127"/>
<polygon fill="red" stroke="red" points="7049.86,-11130.5 7059.86,-11127 7049.86,-11123.5 7049.86,-11130.5"/>
</g>
<!-- attn_residual_1_11 -->
<g id="node1123" class="node">
<title>attn_residual_1_11</title>
<ellipse fill="none" stroke="black" cx="6682" cy="-10833" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6682" y="-10836.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="6682" y="-10821.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_1_11&#45;&gt;attn_residual_1_11 -->
<g id="edge1111" class="edge">
<title>attn_out_1_11&#45;&gt;attn_residual_1_11</title>
<path fill="none" stroke="black" d="M6682,-10932.98C6682,-10932.98 6682,-10870.36 6682,-10870.36"/>
<polygon fill="black" stroke="black" points="6685.5,-10870.36 6682,-10860.36 6678.5,-10870.36 6685.5,-10870.36"/>
</g>
<!-- ffn_up_1_11 -->
<g id="node1124" class="node">
<title>ffn_up_1_11</title>
<polygon fill="none" stroke="black" points="6761,-10733 6603,-10733 6603,-10680 6761,-10680 6761,-10733"/>
<text text-anchor="middle" x="6682" y="-10717.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="6682" y="-10702.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="6682" y="-10687.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_1_11&#45;&gt;ffn_up_1_11 -->
<g id="edge1112" class="edge">
<title>attn_residual_1_11&#45;&gt;ffn_up_1_11</title>
<path fill="none" stroke="black" d="M6682,-10805.86C6682,-10805.86 6682,-10743.16 6682,-10743.16"/>
<polygon fill="black" stroke="black" points="6685.5,-10743.16 6682,-10733.16 6678.5,-10743.16 6685.5,-10743.16"/>
</g>
<!-- ffn_gelu_1_11 -->
<g id="node1125" class="node">
<title>ffn_gelu_1_11</title>
<ellipse fill="none" stroke="black" cx="6682" cy="-10580" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6682" y="-10583.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="6682" y="-10568.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_1_11&#45;&gt;ffn_gelu_1_11 -->
<g id="edge1113" class="edge">
<title>ffn_up_1_11&#45;&gt;ffn_gelu_1_11</title>
<path fill="none" stroke="black" d="M6682,-10679.98C6682,-10679.98 6682,-10617.36 6682,-10617.36"/>
<polygon fill="black" stroke="black" points="6685.5,-10617.36 6682,-10607.36 6678.5,-10617.36 6685.5,-10617.36"/>
</g>
<!-- ffn_down_1_11 -->
<g id="node1126" class="node">
<title>ffn_down_1_11</title>
<polygon fill="none" stroke="black" points="6771,-10480 6593,-10480 6593,-10427 6771,-10427 6771,-10480"/>
<text text-anchor="middle" x="6682" y="-10464.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6682" y="-10449.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="6682" y="-10434.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_1_11&#45;&gt;ffn_down_1_11 -->
<g id="edge1114" class="edge">
<title>ffn_gelu_1_11&#45;&gt;ffn_down_1_11</title>
<path fill="none" stroke="black" d="M6682,-10552.86C6682,-10552.86 6682,-10490.16 6682,-10490.16"/>
<polygon fill="black" stroke="black" points="6685.5,-10490.16 6682,-10480.16 6678.5,-10490.16 6685.5,-10490.16"/>
</g>
<!-- ffn_residual_1_11 -->
<g id="node1127" class="node">
<title>ffn_residual_1_11</title>
<ellipse fill="none" stroke="black" cx="6682" cy="-10327" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6682" y="-10330.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="6682" y="-10315.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_1_11&#45;&gt;ffn_residual_1_11 -->
<g id="edge1115" class="edge">
<title>ffn_down_1_11&#45;&gt;ffn_residual_1_11</title>
<path fill="none" stroke="black" d="M6682,-10426.98C6682,-10426.98 6682,-10364.36 6682,-10364.36"/>
<polygon fill="black" stroke="black" points="6685.5,-10364.36 6682,-10354.36 6678.5,-10364.36 6685.5,-10364.36"/>
</g>
<!-- qkv_proj_2_11 -->
<g id="node1128" class="node">
<title>qkv_proj_2_11</title>
<polygon fill="none" stroke="black" points="6764.5,-10227 6599.5,-10227 6599.5,-10174 6764.5,-10174 6764.5,-10227"/>
<text text-anchor="middle" x="6682" y="-10211.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6682" y="-10196.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="6682" y="-10181.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_1_11&#45;&gt;qkv_proj_2_11 -->
<g id="edge1116" class="edge">
<title>ffn_residual_1_11&#45;&gt;qkv_proj_2_11</title>
<path fill="none" stroke="black" d="M6682,-10299.86C6682,-10299.86 6682,-10237.16 6682,-10237.16"/>
<polygon fill="black" stroke="black" points="6685.5,-10237.16 6682,-10227.16 6678.5,-10237.16 6685.5,-10237.16"/>
</g>
<!-- qkv_reshape_2_11 -->
<g id="node1129" class="node">
<title>qkv_reshape_2_11</title>
<ellipse fill="none" stroke="black" cx="6682" cy="-10074" rx="148" ry="27"/>
<text text-anchor="middle" x="6682" y="-10077.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="6682" y="-10062.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_2_11&#45;&gt;qkv_reshape_2_11 -->
<g id="edge1117" class="edge">
<title>qkv_proj_2_11&#45;&gt;qkv_reshape_2_11</title>
<path fill="none" stroke="black" d="M6682,-10173.98C6682,-10173.98 6682,-10111.36 6682,-10111.36"/>
<polygon fill="black" stroke="black" points="6685.5,-10111.36 6682,-10101.36 6678.5,-10111.36 6685.5,-10111.36"/>
</g>
<!-- qkv_reshape_2_11&#45;&gt;ring_attn_2_11_stage_0 -->
<g id="edge1118" class="edge">
<title>qkv_reshape_2_11&#45;&gt;ring_attn_2_11_stage_0</title>
<path fill="none" stroke="black" d="M6682,-10046.72C6682,-10046.72 6682,-9940.16 6682,-9940.16"/>
<polygon fill="black" stroke="black" points="6685.5,-9940.16 6682,-9930.16 6678.5,-9940.16 6685.5,-9940.16"/>
</g>
<!-- ring_attn_2_11_stage_0&#45;&gt;ring_attn_2_11_stage_1 -->
<g id="edge1119" class="edge">
<title>ring_attn_2_11_stage_0&#45;&gt;ring_attn_2_11_stage_1</title>
<path fill="none" stroke="black" d="M6682,-9793.87C6682,-9793.87 6682,-9687.25 6682,-9687.25"/>
<polygon fill="black" stroke="black" points="6685.5,-9687.25 6682,-9677.25 6678.5,-9687.25 6685.5,-9687.25"/>
</g>
<!-- ring_attn_2_12_stage_0 -->
<g id="node1228" class="node">
<title>ring_attn_2_12_stage_0</title>
<polygon fill="yellow" stroke="black" points="7269,-9930 7060,-9862 7269,-9794 7478,-9862 7269,-9930"/>
<text text-anchor="middle" x="7269" y="-9880.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-9865.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="7269" y="-9850.8" font-family="Times,serif" font-size="14.00">Q[12]×K[12]×V[12]</text>
<text text-anchor="middle" x="7269" y="-9835.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_11_stage_0&#45;&gt;ring_attn_2_12_stage_0 -->
<g id="edge2289" class="edge">
<title>ring_attn_2_11_stage_0&#45;&gt;ring_attn_2_12_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-9862C6891.02,-9862 7049.86,-9862 7049.86,-9862"/>
<polygon fill="red" stroke="red" points="7049.86,-9865.5 7059.86,-9862 7049.86,-9858.5 7049.86,-9865.5"/>
</g>
<!-- ring_attn_2_11_stage_1&#45;&gt;ring_attn_2_11_stage_2 -->
<g id="edge1120" class="edge">
<title>ring_attn_2_11_stage_1&#45;&gt;ring_attn_2_11_stage_2</title>
<path fill="none" stroke="black" d="M6682,-9540.87C6682,-9540.87 6682,-9434.25 6682,-9434.25"/>
<polygon fill="black" stroke="black" points="6685.5,-9434.25 6682,-9424.25 6678.5,-9434.25 6685.5,-9434.25"/>
</g>
<!-- ring_attn_2_12_stage_1 -->
<g id="node1229" class="node">
<title>ring_attn_2_12_stage_1</title>
<polygon fill="yellow" stroke="black" points="7269,-9677 7060,-9609 7269,-9541 7478,-9609 7269,-9677"/>
<text text-anchor="middle" x="7269" y="-9627.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-9612.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="7269" y="-9597.8" font-family="Times,serif" font-size="14.00">Q[12]×K[11]×V[11]</text>
<text text-anchor="middle" x="7269" y="-9582.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_11_stage_1&#45;&gt;ring_attn_2_12_stage_1 -->
<g id="edge2290" class="edge">
<title>ring_attn_2_11_stage_1&#45;&gt;ring_attn_2_12_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-9609C6891.02,-9609 7049.86,-9609 7049.86,-9609"/>
<polygon fill="red" stroke="red" points="7049.86,-9612.5 7059.86,-9609 7049.86,-9605.5 7049.86,-9612.5"/>
</g>
<!-- ring_attn_2_11_stage_2&#45;&gt;ring_attn_2_11_stage_3 -->
<g id="edge1121" class="edge">
<title>ring_attn_2_11_stage_2&#45;&gt;ring_attn_2_11_stage_3</title>
<path fill="none" stroke="black" d="M6682,-9287.87C6682,-9287.87 6682,-9181.25 6682,-9181.25"/>
<polygon fill="black" stroke="black" points="6685.5,-9181.25 6682,-9171.25 6678.5,-9181.25 6685.5,-9181.25"/>
</g>
<!-- ring_attn_2_12_stage_2 -->
<g id="node1230" class="node">
<title>ring_attn_2_12_stage_2</title>
<polygon fill="yellow" stroke="black" points="7269,-9424 7060,-9356 7269,-9288 7478,-9356 7269,-9424"/>
<text text-anchor="middle" x="7269" y="-9374.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-9359.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="7269" y="-9344.8" font-family="Times,serif" font-size="14.00">Q[12]×K[10]×V[10]</text>
<text text-anchor="middle" x="7269" y="-9329.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_11_stage_2&#45;&gt;ring_attn_2_12_stage_2 -->
<g id="edge2291" class="edge">
<title>ring_attn_2_11_stage_2&#45;&gt;ring_attn_2_12_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-9356C6891.02,-9356 7049.86,-9356 7049.86,-9356"/>
<polygon fill="red" stroke="red" points="7049.86,-9359.5 7059.86,-9356 7049.86,-9352.5 7049.86,-9359.5"/>
</g>
<!-- ring_attn_2_11_stage_3&#45;&gt;ring_attn_2_11_stage_4 -->
<g id="edge1122" class="edge">
<title>ring_attn_2_11_stage_3&#45;&gt;ring_attn_2_11_stage_4</title>
<path fill="none" stroke="black" d="M6682,-9034.87C6682,-9034.87 6682,-8928.25 6682,-8928.25"/>
<polygon fill="black" stroke="black" points="6685.5,-8928.25 6682,-8918.25 6678.5,-8928.25 6685.5,-8928.25"/>
</g>
<!-- ring_attn_2_12_stage_3 -->
<g id="node1231" class="node">
<title>ring_attn_2_12_stage_3</title>
<polygon fill="yellow" stroke="black" points="7269,-9171 7060,-9103 7269,-9035 7478,-9103 7269,-9171"/>
<text text-anchor="middle" x="7269" y="-9121.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-9106.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="7269" y="-9091.8" font-family="Times,serif" font-size="14.00">Q[12]×K[9]×V[9]</text>
<text text-anchor="middle" x="7269" y="-9076.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_11_stage_3&#45;&gt;ring_attn_2_12_stage_3 -->
<g id="edge2292" class="edge">
<title>ring_attn_2_11_stage_3&#45;&gt;ring_attn_2_12_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-9103C6891.02,-9103 7049.86,-9103 7049.86,-9103"/>
<polygon fill="red" stroke="red" points="7049.86,-9106.5 7059.86,-9103 7049.86,-9099.5 7049.86,-9106.5"/>
</g>
<!-- ring_attn_2_11_stage_4&#45;&gt;ring_attn_2_11_stage_5 -->
<g id="edge1123" class="edge">
<title>ring_attn_2_11_stage_4&#45;&gt;ring_attn_2_11_stage_5</title>
<path fill="none" stroke="black" d="M6682,-8781.87C6682,-8781.87 6682,-8675.25 6682,-8675.25"/>
<polygon fill="black" stroke="black" points="6685.5,-8675.25 6682,-8665.25 6678.5,-8675.25 6685.5,-8675.25"/>
</g>
<!-- ring_attn_2_12_stage_4 -->
<g id="node1232" class="node">
<title>ring_attn_2_12_stage_4</title>
<polygon fill="yellow" stroke="black" points="7269,-8918 7060,-8850 7269,-8782 7478,-8850 7269,-8918"/>
<text text-anchor="middle" x="7269" y="-8868.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-8853.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="7269" y="-8838.8" font-family="Times,serif" font-size="14.00">Q[12]×K[8]×V[8]</text>
<text text-anchor="middle" x="7269" y="-8823.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_11_stage_4&#45;&gt;ring_attn_2_12_stage_4 -->
<g id="edge2293" class="edge">
<title>ring_attn_2_11_stage_4&#45;&gt;ring_attn_2_12_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-8850C6891.02,-8850 7049.86,-8850 7049.86,-8850"/>
<polygon fill="red" stroke="red" points="7049.86,-8853.5 7059.86,-8850 7049.86,-8846.5 7049.86,-8853.5"/>
</g>
<!-- ring_attn_2_11_stage_5&#45;&gt;ring_attn_2_11_stage_6 -->
<g id="edge1124" class="edge">
<title>ring_attn_2_11_stage_5&#45;&gt;ring_attn_2_11_stage_6</title>
<path fill="none" stroke="black" d="M6682,-8528.87C6682,-8528.87 6682,-8422.25 6682,-8422.25"/>
<polygon fill="black" stroke="black" points="6685.5,-8422.25 6682,-8412.25 6678.5,-8422.25 6685.5,-8422.25"/>
</g>
<!-- ring_attn_2_12_stage_5 -->
<g id="node1233" class="node">
<title>ring_attn_2_12_stage_5</title>
<polygon fill="yellow" stroke="black" points="7269,-8665 7060,-8597 7269,-8529 7478,-8597 7269,-8665"/>
<text text-anchor="middle" x="7269" y="-8615.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-8600.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="7269" y="-8585.8" font-family="Times,serif" font-size="14.00">Q[12]×K[7]×V[7]</text>
<text text-anchor="middle" x="7269" y="-8570.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_11_stage_5&#45;&gt;ring_attn_2_12_stage_5 -->
<g id="edge2294" class="edge">
<title>ring_attn_2_11_stage_5&#45;&gt;ring_attn_2_12_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-8597C6891.02,-8597 7049.86,-8597 7049.86,-8597"/>
<polygon fill="red" stroke="red" points="7049.86,-8600.5 7059.86,-8597 7049.86,-8593.5 7049.86,-8600.5"/>
</g>
<!-- ring_attn_2_11_stage_6&#45;&gt;ring_attn_2_11_stage_7 -->
<g id="edge1125" class="edge">
<title>ring_attn_2_11_stage_6&#45;&gt;ring_attn_2_11_stage_7</title>
<path fill="none" stroke="black" d="M6682,-8275.87C6682,-8275.87 6682,-8169.25 6682,-8169.25"/>
<polygon fill="black" stroke="black" points="6685.5,-8169.25 6682,-8159.25 6678.5,-8169.25 6685.5,-8169.25"/>
</g>
<!-- ring_attn_2_12_stage_6 -->
<g id="node1234" class="node">
<title>ring_attn_2_12_stage_6</title>
<polygon fill="yellow" stroke="black" points="7269,-8412 7060,-8344 7269,-8276 7478,-8344 7269,-8412"/>
<text text-anchor="middle" x="7269" y="-8362.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-8347.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="7269" y="-8332.8" font-family="Times,serif" font-size="14.00">Q[12]×K[6]×V[6]</text>
<text text-anchor="middle" x="7269" y="-8317.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_11_stage_6&#45;&gt;ring_attn_2_12_stage_6 -->
<g id="edge2295" class="edge">
<title>ring_attn_2_11_stage_6&#45;&gt;ring_attn_2_12_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-8344C6891.02,-8344 7049.86,-8344 7049.86,-8344"/>
<polygon fill="red" stroke="red" points="7049.86,-8347.5 7059.86,-8344 7049.86,-8340.5 7049.86,-8347.5"/>
</g>
<!-- ring_attn_2_11_stage_7&#45;&gt;ring_attn_2_11_stage_8 -->
<g id="edge1126" class="edge">
<title>ring_attn_2_11_stage_7&#45;&gt;ring_attn_2_11_stage_8</title>
<path fill="none" stroke="black" d="M6682,-8022.87C6682,-8022.87 6682,-7916.25 6682,-7916.25"/>
<polygon fill="black" stroke="black" points="6685.5,-7916.25 6682,-7906.25 6678.5,-7916.25 6685.5,-7916.25"/>
</g>
<!-- ring_attn_2_12_stage_7 -->
<g id="node1235" class="node">
<title>ring_attn_2_12_stage_7</title>
<polygon fill="yellow" stroke="black" points="7269,-8159 7060,-8091 7269,-8023 7478,-8091 7269,-8159"/>
<text text-anchor="middle" x="7269" y="-8109.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-8094.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="7269" y="-8079.8" font-family="Times,serif" font-size="14.00">Q[12]×K[5]×V[5]</text>
<text text-anchor="middle" x="7269" y="-8064.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_11_stage_7&#45;&gt;ring_attn_2_12_stage_7 -->
<g id="edge2296" class="edge">
<title>ring_attn_2_11_stage_7&#45;&gt;ring_attn_2_12_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-8091C6891.02,-8091 7049.86,-8091 7049.86,-8091"/>
<polygon fill="red" stroke="red" points="7049.86,-8094.5 7059.86,-8091 7049.86,-8087.5 7049.86,-8094.5"/>
</g>
<!-- ring_attn_2_11_stage_8&#45;&gt;ring_attn_2_11_stage_9 -->
<g id="edge1127" class="edge">
<title>ring_attn_2_11_stage_8&#45;&gt;ring_attn_2_11_stage_9</title>
<path fill="none" stroke="black" d="M6682,-7769.87C6682,-7769.87 6682,-7663.25 6682,-7663.25"/>
<polygon fill="black" stroke="black" points="6685.5,-7663.25 6682,-7653.25 6678.5,-7663.25 6685.5,-7663.25"/>
</g>
<!-- ring_attn_2_12_stage_8 -->
<g id="node1236" class="node">
<title>ring_attn_2_12_stage_8</title>
<polygon fill="yellow" stroke="black" points="7269,-7906 7060,-7838 7269,-7770 7478,-7838 7269,-7906"/>
<text text-anchor="middle" x="7269" y="-7856.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-7841.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="7269" y="-7826.8" font-family="Times,serif" font-size="14.00">Q[12]×K[4]×V[4]</text>
<text text-anchor="middle" x="7269" y="-7811.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_11_stage_8&#45;&gt;ring_attn_2_12_stage_8 -->
<g id="edge2297" class="edge">
<title>ring_attn_2_11_stage_8&#45;&gt;ring_attn_2_12_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-7838C6891.02,-7838 7049.86,-7838 7049.86,-7838"/>
<polygon fill="red" stroke="red" points="7049.86,-7841.5 7059.86,-7838 7049.86,-7834.5 7049.86,-7841.5"/>
</g>
<!-- ring_attn_2_11_stage_9&#45;&gt;ring_attn_2_11_stage_10 -->
<g id="edge1128" class="edge">
<title>ring_attn_2_11_stage_9&#45;&gt;ring_attn_2_11_stage_10</title>
<path fill="none" stroke="black" d="M6682,-7516.87C6682,-7516.87 6682,-7410.25 6682,-7410.25"/>
<polygon fill="black" stroke="black" points="6685.5,-7410.25 6682,-7400.25 6678.5,-7410.25 6685.5,-7410.25"/>
</g>
<!-- ring_attn_2_12_stage_9 -->
<g id="node1237" class="node">
<title>ring_attn_2_12_stage_9</title>
<polygon fill="yellow" stroke="black" points="7269,-7653 7060,-7585 7269,-7517 7478,-7585 7269,-7653"/>
<text text-anchor="middle" x="7269" y="-7603.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-7588.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="7269" y="-7573.8" font-family="Times,serif" font-size="14.00">Q[12]×K[3]×V[3]</text>
<text text-anchor="middle" x="7269" y="-7558.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_11_stage_9&#45;&gt;ring_attn_2_12_stage_9 -->
<g id="edge2298" class="edge">
<title>ring_attn_2_11_stage_9&#45;&gt;ring_attn_2_12_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-7585C6891.02,-7585 7049.86,-7585 7049.86,-7585"/>
<polygon fill="red" stroke="red" points="7049.86,-7588.5 7059.86,-7585 7049.86,-7581.5 7049.86,-7588.5"/>
</g>
<!-- ring_attn_2_11_stage_10&#45;&gt;ring_attn_2_11_stage_11 -->
<g id="edge1129" class="edge">
<title>ring_attn_2_11_stage_10&#45;&gt;ring_attn_2_11_stage_11</title>
<path fill="none" stroke="black" d="M6682,-7263.87C6682,-7263.87 6682,-7157.25 6682,-7157.25"/>
<polygon fill="black" stroke="black" points="6685.5,-7157.25 6682,-7147.25 6678.5,-7157.25 6685.5,-7157.25"/>
</g>
<!-- ring_attn_2_12_stage_10 -->
<g id="node1238" class="node">
<title>ring_attn_2_12_stage_10</title>
<polygon fill="yellow" stroke="black" points="7269,-7400 7060,-7332 7269,-7264 7478,-7332 7269,-7400"/>
<text text-anchor="middle" x="7269" y="-7350.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-7335.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="7269" y="-7320.8" font-family="Times,serif" font-size="14.00">Q[12]×K[2]×V[2]</text>
<text text-anchor="middle" x="7269" y="-7305.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_11_stage_10&#45;&gt;ring_attn_2_12_stage_10 -->
<g id="edge2299" class="edge">
<title>ring_attn_2_11_stage_10&#45;&gt;ring_attn_2_12_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-7332C6891.02,-7332 7049.86,-7332 7049.86,-7332"/>
<polygon fill="red" stroke="red" points="7049.86,-7335.5 7059.86,-7332 7049.86,-7328.5 7049.86,-7335.5"/>
</g>
<!-- ring_attn_2_11_stage_11&#45;&gt;ring_attn_2_11_stage_12 -->
<g id="edge1130" class="edge">
<title>ring_attn_2_11_stage_11&#45;&gt;ring_attn_2_11_stage_12</title>
<path fill="none" stroke="black" d="M6682,-7010.87C6682,-7010.87 6682,-6904.25 6682,-6904.25"/>
<polygon fill="black" stroke="black" points="6685.5,-6904.25 6682,-6894.25 6678.5,-6904.25 6685.5,-6904.25"/>
</g>
<!-- ring_attn_2_12_stage_11 -->
<g id="node1239" class="node">
<title>ring_attn_2_12_stage_11</title>
<polygon fill="yellow" stroke="black" points="7269,-7147 7060,-7079 7269,-7011 7478,-7079 7269,-7147"/>
<text text-anchor="middle" x="7269" y="-7097.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-7082.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="7269" y="-7067.8" font-family="Times,serif" font-size="14.00">Q[12]×K[1]×V[1]</text>
<text text-anchor="middle" x="7269" y="-7052.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_11_stage_11&#45;&gt;ring_attn_2_12_stage_11 -->
<g id="edge2300" class="edge">
<title>ring_attn_2_11_stage_11&#45;&gt;ring_attn_2_12_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-7079C6891.02,-7079 7049.86,-7079 7049.86,-7079"/>
<polygon fill="red" stroke="red" points="7049.86,-7082.5 7059.86,-7079 7049.86,-7075.5 7049.86,-7082.5"/>
</g>
<!-- ring_attn_2_11_stage_12&#45;&gt;ring_attn_2_11_stage_13 -->
<g id="edge1131" class="edge">
<title>ring_attn_2_11_stage_12&#45;&gt;ring_attn_2_11_stage_13</title>
<path fill="none" stroke="black" d="M6682,-6757.87C6682,-6757.87 6682,-6651.25 6682,-6651.25"/>
<polygon fill="black" stroke="black" points="6685.5,-6651.25 6682,-6641.25 6678.5,-6651.25 6685.5,-6651.25"/>
</g>
<!-- ring_attn_2_12_stage_12 -->
<g id="node1240" class="node">
<title>ring_attn_2_12_stage_12</title>
<polygon fill="yellow" stroke="black" points="7269,-6894 7060,-6826 7269,-6758 7478,-6826 7269,-6894"/>
<text text-anchor="middle" x="7269" y="-6844.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-6829.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="7269" y="-6814.8" font-family="Times,serif" font-size="14.00">Q[12]×K[0]×V[0]</text>
<text text-anchor="middle" x="7269" y="-6799.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_11_stage_12&#45;&gt;ring_attn_2_12_stage_12 -->
<g id="edge2301" class="edge">
<title>ring_attn_2_11_stage_12&#45;&gt;ring_attn_2_12_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-6826C6891.02,-6826 7049.86,-6826 7049.86,-6826"/>
<polygon fill="red" stroke="red" points="7049.86,-6829.5 7059.86,-6826 7049.86,-6822.5 7049.86,-6829.5"/>
</g>
<!-- ring_attn_2_11_stage_13&#45;&gt;ring_attn_2_11_stage_14 -->
<g id="edge1132" class="edge">
<title>ring_attn_2_11_stage_13&#45;&gt;ring_attn_2_11_stage_14</title>
<path fill="none" stroke="black" d="M6682,-6504.87C6682,-6504.87 6682,-6398.25 6682,-6398.25"/>
<polygon fill="black" stroke="black" points="6685.5,-6398.25 6682,-6388.25 6678.5,-6398.25 6685.5,-6398.25"/>
</g>
<!-- ring_attn_2_12_stage_13 -->
<g id="node1241" class="node">
<title>ring_attn_2_12_stage_13</title>
<polygon fill="yellow" stroke="black" points="7269,-6641 7060,-6573 7269,-6505 7478,-6573 7269,-6641"/>
<text text-anchor="middle" x="7269" y="-6591.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-6576.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="7269" y="-6561.8" font-family="Times,serif" font-size="14.00">Q[12]×K[15]×V[15]</text>
<text text-anchor="middle" x="7269" y="-6546.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_11_stage_13&#45;&gt;ring_attn_2_12_stage_13 -->
<g id="edge2302" class="edge">
<title>ring_attn_2_11_stage_13&#45;&gt;ring_attn_2_12_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-6573C6891.02,-6573 7049.86,-6573 7049.86,-6573"/>
<polygon fill="red" stroke="red" points="7049.86,-6576.5 7059.86,-6573 7049.86,-6569.5 7049.86,-6576.5"/>
</g>
<!-- ring_attn_2_11_stage_14&#45;&gt;ring_attn_2_11_stage_15 -->
<g id="edge1133" class="edge">
<title>ring_attn_2_11_stage_14&#45;&gt;ring_attn_2_11_stage_15</title>
<path fill="none" stroke="black" d="M6682,-6251.87C6682,-6251.87 6682,-6145.25 6682,-6145.25"/>
<polygon fill="black" stroke="black" points="6685.5,-6145.25 6682,-6135.25 6678.5,-6145.25 6685.5,-6145.25"/>
</g>
<!-- ring_attn_2_12_stage_14 -->
<g id="node1242" class="node">
<title>ring_attn_2_12_stage_14</title>
<polygon fill="yellow" stroke="black" points="7269,-6388 7060,-6320 7269,-6252 7478,-6320 7269,-6388"/>
<text text-anchor="middle" x="7269" y="-6338.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-6323.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="7269" y="-6308.8" font-family="Times,serif" font-size="14.00">Q[12]×K[14]×V[14]</text>
<text text-anchor="middle" x="7269" y="-6293.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_11_stage_14&#45;&gt;ring_attn_2_12_stage_14 -->
<g id="edge2303" class="edge">
<title>ring_attn_2_11_stage_14&#45;&gt;ring_attn_2_12_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-6320C6891.02,-6320 7049.86,-6320 7049.86,-6320"/>
<polygon fill="red" stroke="red" points="7049.86,-6323.5 7059.86,-6320 7049.86,-6316.5 7049.86,-6323.5"/>
</g>
<!-- attn_out_2_11 -->
<g id="node1146" class="node">
<title>attn_out_2_11</title>
<polygon fill="none" stroke="black" points="6751.5,-5926 6612.5,-5926 6612.5,-5873 6751.5,-5873 6751.5,-5926"/>
<text text-anchor="middle" x="6682" y="-5910.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6682" y="-5895.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="6682" y="-5880.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_2_11_stage_15&#45;&gt;attn_out_2_11 -->
<g id="edge1134" class="edge">
<title>ring_attn_2_11_stage_15&#45;&gt;attn_out_2_11</title>
<path fill="none" stroke="black" d="M6682,-5998.87C6682,-5998.87 6682,-5936.18 6682,-5936.18"/>
<polygon fill="black" stroke="black" points="6685.5,-5936.18 6682,-5926.18 6678.5,-5936.18 6685.5,-5936.18"/>
</g>
<!-- ring_attn_2_12_stage_15 -->
<g id="node1243" class="node">
<title>ring_attn_2_12_stage_15</title>
<polygon fill="yellow" stroke="black" points="7269,-6135 7060,-6067 7269,-5999 7478,-6067 7269,-6135"/>
<text text-anchor="middle" x="7269" y="-6085.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-6070.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="7269" y="-6055.8" font-family="Times,serif" font-size="14.00">Q[12]×K[13]×V[13]</text>
<text text-anchor="middle" x="7269" y="-6040.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_11_stage_15&#45;&gt;ring_attn_2_12_stage_15 -->
<g id="edge2304" class="edge">
<title>ring_attn_2_11_stage_15&#45;&gt;ring_attn_2_12_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-6067C6891.02,-6067 7049.86,-6067 7049.86,-6067"/>
<polygon fill="red" stroke="red" points="7049.86,-6070.5 7059.86,-6067 7049.86,-6063.5 7049.86,-6070.5"/>
</g>
<!-- attn_residual_2_11 -->
<g id="node1147" class="node">
<title>attn_residual_2_11</title>
<ellipse fill="none" stroke="black" cx="6682" cy="-5773" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6682" y="-5776.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="6682" y="-5761.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_2_11&#45;&gt;attn_residual_2_11 -->
<g id="edge1135" class="edge">
<title>attn_out_2_11&#45;&gt;attn_residual_2_11</title>
<path fill="none" stroke="black" d="M6682,-5872.98C6682,-5872.98 6682,-5810.36 6682,-5810.36"/>
<polygon fill="black" stroke="black" points="6685.5,-5810.36 6682,-5800.36 6678.5,-5810.36 6685.5,-5810.36"/>
</g>
<!-- ffn_up_2_11 -->
<g id="node1148" class="node">
<title>ffn_up_2_11</title>
<polygon fill="none" stroke="black" points="6761,-5673 6603,-5673 6603,-5620 6761,-5620 6761,-5673"/>
<text text-anchor="middle" x="6682" y="-5657.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="6682" y="-5642.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="6682" y="-5627.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_2_11&#45;&gt;ffn_up_2_11 -->
<g id="edge1136" class="edge">
<title>attn_residual_2_11&#45;&gt;ffn_up_2_11</title>
<path fill="none" stroke="black" d="M6682,-5745.86C6682,-5745.86 6682,-5683.16 6682,-5683.16"/>
<polygon fill="black" stroke="black" points="6685.5,-5683.16 6682,-5673.16 6678.5,-5683.16 6685.5,-5683.16"/>
</g>
<!-- ffn_gelu_2_11 -->
<g id="node1149" class="node">
<title>ffn_gelu_2_11</title>
<ellipse fill="none" stroke="black" cx="6682" cy="-5520" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6682" y="-5523.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="6682" y="-5508.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_2_11&#45;&gt;ffn_gelu_2_11 -->
<g id="edge1137" class="edge">
<title>ffn_up_2_11&#45;&gt;ffn_gelu_2_11</title>
<path fill="none" stroke="black" d="M6682,-5619.98C6682,-5619.98 6682,-5557.36 6682,-5557.36"/>
<polygon fill="black" stroke="black" points="6685.5,-5557.36 6682,-5547.36 6678.5,-5557.36 6685.5,-5557.36"/>
</g>
<!-- ffn_down_2_11 -->
<g id="node1150" class="node">
<title>ffn_down_2_11</title>
<polygon fill="none" stroke="black" points="6771,-5420 6593,-5420 6593,-5367 6771,-5367 6771,-5420"/>
<text text-anchor="middle" x="6682" y="-5404.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6682" y="-5389.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="6682" y="-5374.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_2_11&#45;&gt;ffn_down_2_11 -->
<g id="edge1138" class="edge">
<title>ffn_gelu_2_11&#45;&gt;ffn_down_2_11</title>
<path fill="none" stroke="black" d="M6682,-5492.86C6682,-5492.86 6682,-5430.16 6682,-5430.16"/>
<polygon fill="black" stroke="black" points="6685.5,-5430.16 6682,-5420.16 6678.5,-5430.16 6685.5,-5430.16"/>
</g>
<!-- ffn_residual_2_11 -->
<g id="node1151" class="node">
<title>ffn_residual_2_11</title>
<ellipse fill="none" stroke="black" cx="6682" cy="-5267" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6682" y="-5270.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="6682" y="-5255.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_2_11&#45;&gt;ffn_residual_2_11 -->
<g id="edge1139" class="edge">
<title>ffn_down_2_11&#45;&gt;ffn_residual_2_11</title>
<path fill="none" stroke="black" d="M6682,-5366.98C6682,-5366.98 6682,-5304.36 6682,-5304.36"/>
<polygon fill="black" stroke="black" points="6685.5,-5304.36 6682,-5294.36 6678.5,-5304.36 6685.5,-5304.36"/>
</g>
<!-- qkv_proj_3_11 -->
<g id="node1152" class="node">
<title>qkv_proj_3_11</title>
<polygon fill="none" stroke="black" points="6764.5,-5167 6599.5,-5167 6599.5,-5114 6764.5,-5114 6764.5,-5167"/>
<text text-anchor="middle" x="6682" y="-5151.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6682" y="-5136.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="6682" y="-5121.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_2_11&#45;&gt;qkv_proj_3_11 -->
<g id="edge1140" class="edge">
<title>ffn_residual_2_11&#45;&gt;qkv_proj_3_11</title>
<path fill="none" stroke="black" d="M6682,-5239.86C6682,-5239.86 6682,-5177.16 6682,-5177.16"/>
<polygon fill="black" stroke="black" points="6685.5,-5177.16 6682,-5167.16 6678.5,-5177.16 6685.5,-5177.16"/>
</g>
<!-- qkv_reshape_3_11 -->
<g id="node1153" class="node">
<title>qkv_reshape_3_11</title>
<ellipse fill="none" stroke="black" cx="6682" cy="-5014" rx="148" ry="27"/>
<text text-anchor="middle" x="6682" y="-5017.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="6682" y="-5002.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_3_11&#45;&gt;qkv_reshape_3_11 -->
<g id="edge1141" class="edge">
<title>qkv_proj_3_11&#45;&gt;qkv_reshape_3_11</title>
<path fill="none" stroke="black" d="M6682,-5113.98C6682,-5113.98 6682,-5051.36 6682,-5051.36"/>
<polygon fill="black" stroke="black" points="6685.5,-5051.36 6682,-5041.36 6678.5,-5051.36 6685.5,-5051.36"/>
</g>
<!-- qkv_reshape_3_11&#45;&gt;ring_attn_3_11_stage_0 -->
<g id="edge1142" class="edge">
<title>qkv_reshape_3_11&#45;&gt;ring_attn_3_11_stage_0</title>
<path fill="none" stroke="black" d="M6682,-4986.72C6682,-4986.72 6682,-4880.16 6682,-4880.16"/>
<polygon fill="black" stroke="black" points="6685.5,-4880.16 6682,-4870.16 6678.5,-4880.16 6685.5,-4880.16"/>
</g>
<!-- ring_attn_3_11_stage_0&#45;&gt;ring_attn_3_11_stage_1 -->
<g id="edge1143" class="edge">
<title>ring_attn_3_11_stage_0&#45;&gt;ring_attn_3_11_stage_1</title>
<path fill="none" stroke="black" d="M6682,-4733.87C6682,-4733.87 6682,-4627.25 6682,-4627.25"/>
<polygon fill="black" stroke="black" points="6685.5,-4627.25 6682,-4617.25 6678.5,-4627.25 6685.5,-4627.25"/>
</g>
<!-- ring_attn_3_12_stage_0 -->
<g id="node1252" class="node">
<title>ring_attn_3_12_stage_0</title>
<polygon fill="yellow" stroke="black" points="7269,-4870 7060,-4802 7269,-4734 7478,-4802 7269,-4870"/>
<text text-anchor="middle" x="7269" y="-4820.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-4805.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="7269" y="-4790.8" font-family="Times,serif" font-size="14.00">Q[12]×K[12]×V[12]</text>
<text text-anchor="middle" x="7269" y="-4775.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_11_stage_0&#45;&gt;ring_attn_3_12_stage_0 -->
<g id="edge2305" class="edge">
<title>ring_attn_3_11_stage_0&#45;&gt;ring_attn_3_12_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-4802C6891.02,-4802 7049.86,-4802 7049.86,-4802"/>
<polygon fill="red" stroke="red" points="7049.86,-4805.5 7059.86,-4802 7049.86,-4798.5 7049.86,-4805.5"/>
</g>
<!-- ring_attn_3_11_stage_1&#45;&gt;ring_attn_3_11_stage_2 -->
<g id="edge1144" class="edge">
<title>ring_attn_3_11_stage_1&#45;&gt;ring_attn_3_11_stage_2</title>
<path fill="none" stroke="black" d="M6682,-4480.87C6682,-4480.87 6682,-4374.25 6682,-4374.25"/>
<polygon fill="black" stroke="black" points="6685.5,-4374.25 6682,-4364.25 6678.5,-4374.25 6685.5,-4374.25"/>
</g>
<!-- ring_attn_3_12_stage_1 -->
<g id="node1253" class="node">
<title>ring_attn_3_12_stage_1</title>
<polygon fill="yellow" stroke="black" points="7269,-4617 7060,-4549 7269,-4481 7478,-4549 7269,-4617"/>
<text text-anchor="middle" x="7269" y="-4567.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-4552.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="7269" y="-4537.8" font-family="Times,serif" font-size="14.00">Q[12]×K[11]×V[11]</text>
<text text-anchor="middle" x="7269" y="-4522.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_11_stage_1&#45;&gt;ring_attn_3_12_stage_1 -->
<g id="edge2306" class="edge">
<title>ring_attn_3_11_stage_1&#45;&gt;ring_attn_3_12_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-4549C6891.02,-4549 7049.86,-4549 7049.86,-4549"/>
<polygon fill="red" stroke="red" points="7049.86,-4552.5 7059.86,-4549 7049.86,-4545.5 7049.86,-4552.5"/>
</g>
<!-- ring_attn_3_11_stage_2&#45;&gt;ring_attn_3_11_stage_3 -->
<g id="edge1145" class="edge">
<title>ring_attn_3_11_stage_2&#45;&gt;ring_attn_3_11_stage_3</title>
<path fill="none" stroke="black" d="M6682,-4227.87C6682,-4227.87 6682,-4121.25 6682,-4121.25"/>
<polygon fill="black" stroke="black" points="6685.5,-4121.25 6682,-4111.25 6678.5,-4121.25 6685.5,-4121.25"/>
</g>
<!-- ring_attn_3_12_stage_2 -->
<g id="node1254" class="node">
<title>ring_attn_3_12_stage_2</title>
<polygon fill="yellow" stroke="black" points="7269,-4364 7060,-4296 7269,-4228 7478,-4296 7269,-4364"/>
<text text-anchor="middle" x="7269" y="-4314.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-4299.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="7269" y="-4284.8" font-family="Times,serif" font-size="14.00">Q[12]×K[10]×V[10]</text>
<text text-anchor="middle" x="7269" y="-4269.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_11_stage_2&#45;&gt;ring_attn_3_12_stage_2 -->
<g id="edge2307" class="edge">
<title>ring_attn_3_11_stage_2&#45;&gt;ring_attn_3_12_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-4296C6891.02,-4296 7049.86,-4296 7049.86,-4296"/>
<polygon fill="red" stroke="red" points="7049.86,-4299.5 7059.86,-4296 7049.86,-4292.5 7049.86,-4299.5"/>
</g>
<!-- ring_attn_3_11_stage_3&#45;&gt;ring_attn_3_11_stage_4 -->
<g id="edge1146" class="edge">
<title>ring_attn_3_11_stage_3&#45;&gt;ring_attn_3_11_stage_4</title>
<path fill="none" stroke="black" d="M6682,-3974.87C6682,-3974.87 6682,-3868.25 6682,-3868.25"/>
<polygon fill="black" stroke="black" points="6685.5,-3868.25 6682,-3858.25 6678.5,-3868.25 6685.5,-3868.25"/>
</g>
<!-- ring_attn_3_12_stage_3 -->
<g id="node1255" class="node">
<title>ring_attn_3_12_stage_3</title>
<polygon fill="yellow" stroke="black" points="7269,-4111 7060,-4043 7269,-3975 7478,-4043 7269,-4111"/>
<text text-anchor="middle" x="7269" y="-4061.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-4046.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="7269" y="-4031.8" font-family="Times,serif" font-size="14.00">Q[12]×K[9]×V[9]</text>
<text text-anchor="middle" x="7269" y="-4016.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_11_stage_3&#45;&gt;ring_attn_3_12_stage_3 -->
<g id="edge2308" class="edge">
<title>ring_attn_3_11_stage_3&#45;&gt;ring_attn_3_12_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-4043C6891.02,-4043 7049.86,-4043 7049.86,-4043"/>
<polygon fill="red" stroke="red" points="7049.86,-4046.5 7059.86,-4043 7049.86,-4039.5 7049.86,-4046.5"/>
</g>
<!-- ring_attn_3_11_stage_4&#45;&gt;ring_attn_3_11_stage_5 -->
<g id="edge1147" class="edge">
<title>ring_attn_3_11_stage_4&#45;&gt;ring_attn_3_11_stage_5</title>
<path fill="none" stroke="black" d="M6682,-3721.87C6682,-3721.87 6682,-3615.25 6682,-3615.25"/>
<polygon fill="black" stroke="black" points="6685.5,-3615.25 6682,-3605.25 6678.5,-3615.25 6685.5,-3615.25"/>
</g>
<!-- ring_attn_3_12_stage_4 -->
<g id="node1256" class="node">
<title>ring_attn_3_12_stage_4</title>
<polygon fill="yellow" stroke="black" points="7269,-3858 7060,-3790 7269,-3722 7478,-3790 7269,-3858"/>
<text text-anchor="middle" x="7269" y="-3808.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-3793.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="7269" y="-3778.8" font-family="Times,serif" font-size="14.00">Q[12]×K[8]×V[8]</text>
<text text-anchor="middle" x="7269" y="-3763.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_11_stage_4&#45;&gt;ring_attn_3_12_stage_4 -->
<g id="edge2309" class="edge">
<title>ring_attn_3_11_stage_4&#45;&gt;ring_attn_3_12_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-3790C6891.02,-3790 7049.86,-3790 7049.86,-3790"/>
<polygon fill="red" stroke="red" points="7049.86,-3793.5 7059.86,-3790 7049.86,-3786.5 7049.86,-3793.5"/>
</g>
<!-- ring_attn_3_11_stage_5&#45;&gt;ring_attn_3_11_stage_6 -->
<g id="edge1148" class="edge">
<title>ring_attn_3_11_stage_5&#45;&gt;ring_attn_3_11_stage_6</title>
<path fill="none" stroke="black" d="M6682,-3468.87C6682,-3468.87 6682,-3362.25 6682,-3362.25"/>
<polygon fill="black" stroke="black" points="6685.5,-3362.25 6682,-3352.25 6678.5,-3362.25 6685.5,-3362.25"/>
</g>
<!-- ring_attn_3_12_stage_5 -->
<g id="node1257" class="node">
<title>ring_attn_3_12_stage_5</title>
<polygon fill="yellow" stroke="black" points="7269,-3605 7060,-3537 7269,-3469 7478,-3537 7269,-3605"/>
<text text-anchor="middle" x="7269" y="-3555.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-3540.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="7269" y="-3525.8" font-family="Times,serif" font-size="14.00">Q[12]×K[7]×V[7]</text>
<text text-anchor="middle" x="7269" y="-3510.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_11_stage_5&#45;&gt;ring_attn_3_12_stage_5 -->
<g id="edge2310" class="edge">
<title>ring_attn_3_11_stage_5&#45;&gt;ring_attn_3_12_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-3537C6891.02,-3537 7049.86,-3537 7049.86,-3537"/>
<polygon fill="red" stroke="red" points="7049.86,-3540.5 7059.86,-3537 7049.86,-3533.5 7049.86,-3540.5"/>
</g>
<!-- ring_attn_3_11_stage_6&#45;&gt;ring_attn_3_11_stage_7 -->
<g id="edge1149" class="edge">
<title>ring_attn_3_11_stage_6&#45;&gt;ring_attn_3_11_stage_7</title>
<path fill="none" stroke="black" d="M6682,-3215.87C6682,-3215.87 6682,-3109.25 6682,-3109.25"/>
<polygon fill="black" stroke="black" points="6685.5,-3109.25 6682,-3099.25 6678.5,-3109.25 6685.5,-3109.25"/>
</g>
<!-- ring_attn_3_12_stage_6 -->
<g id="node1258" class="node">
<title>ring_attn_3_12_stage_6</title>
<polygon fill="yellow" stroke="black" points="7269,-3352 7060,-3284 7269,-3216 7478,-3284 7269,-3352"/>
<text text-anchor="middle" x="7269" y="-3302.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-3287.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="7269" y="-3272.8" font-family="Times,serif" font-size="14.00">Q[12]×K[6]×V[6]</text>
<text text-anchor="middle" x="7269" y="-3257.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_11_stage_6&#45;&gt;ring_attn_3_12_stage_6 -->
<g id="edge2311" class="edge">
<title>ring_attn_3_11_stage_6&#45;&gt;ring_attn_3_12_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-3284C6891.02,-3284 7049.86,-3284 7049.86,-3284"/>
<polygon fill="red" stroke="red" points="7049.86,-3287.5 7059.86,-3284 7049.86,-3280.5 7049.86,-3287.5"/>
</g>
<!-- ring_attn_3_11_stage_7&#45;&gt;ring_attn_3_11_stage_8 -->
<g id="edge1150" class="edge">
<title>ring_attn_3_11_stage_7&#45;&gt;ring_attn_3_11_stage_8</title>
<path fill="none" stroke="black" d="M6682,-2962.87C6682,-2962.87 6682,-2856.25 6682,-2856.25"/>
<polygon fill="black" stroke="black" points="6685.5,-2856.25 6682,-2846.25 6678.5,-2856.25 6685.5,-2856.25"/>
</g>
<!-- ring_attn_3_12_stage_7 -->
<g id="node1259" class="node">
<title>ring_attn_3_12_stage_7</title>
<polygon fill="yellow" stroke="black" points="7269,-3099 7060,-3031 7269,-2963 7478,-3031 7269,-3099"/>
<text text-anchor="middle" x="7269" y="-3049.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-3034.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="7269" y="-3019.8" font-family="Times,serif" font-size="14.00">Q[12]×K[5]×V[5]</text>
<text text-anchor="middle" x="7269" y="-3004.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_11_stage_7&#45;&gt;ring_attn_3_12_stage_7 -->
<g id="edge2312" class="edge">
<title>ring_attn_3_11_stage_7&#45;&gt;ring_attn_3_12_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-3031C6891.02,-3031 7049.86,-3031 7049.86,-3031"/>
<polygon fill="red" stroke="red" points="7049.86,-3034.5 7059.86,-3031 7049.86,-3027.5 7049.86,-3034.5"/>
</g>
<!-- ring_attn_3_11_stage_8&#45;&gt;ring_attn_3_11_stage_9 -->
<g id="edge1151" class="edge">
<title>ring_attn_3_11_stage_8&#45;&gt;ring_attn_3_11_stage_9</title>
<path fill="none" stroke="black" d="M6682,-2709.87C6682,-2709.87 6682,-2603.25 6682,-2603.25"/>
<polygon fill="black" stroke="black" points="6685.5,-2603.25 6682,-2593.25 6678.5,-2603.25 6685.5,-2603.25"/>
</g>
<!-- ring_attn_3_12_stage_8 -->
<g id="node1260" class="node">
<title>ring_attn_3_12_stage_8</title>
<polygon fill="yellow" stroke="black" points="7269,-2846 7060,-2778 7269,-2710 7478,-2778 7269,-2846"/>
<text text-anchor="middle" x="7269" y="-2796.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-2781.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="7269" y="-2766.8" font-family="Times,serif" font-size="14.00">Q[12]×K[4]×V[4]</text>
<text text-anchor="middle" x="7269" y="-2751.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_11_stage_8&#45;&gt;ring_attn_3_12_stage_8 -->
<g id="edge2313" class="edge">
<title>ring_attn_3_11_stage_8&#45;&gt;ring_attn_3_12_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-2778C6891.02,-2778 7049.86,-2778 7049.86,-2778"/>
<polygon fill="red" stroke="red" points="7049.86,-2781.5 7059.86,-2778 7049.86,-2774.5 7049.86,-2781.5"/>
</g>
<!-- ring_attn_3_11_stage_9&#45;&gt;ring_attn_3_11_stage_10 -->
<g id="edge1152" class="edge">
<title>ring_attn_3_11_stage_9&#45;&gt;ring_attn_3_11_stage_10</title>
<path fill="none" stroke="black" d="M6682,-2456.87C6682,-2456.87 6682,-2350.25 6682,-2350.25"/>
<polygon fill="black" stroke="black" points="6685.5,-2350.25 6682,-2340.25 6678.5,-2350.25 6685.5,-2350.25"/>
</g>
<!-- ring_attn_3_12_stage_9 -->
<g id="node1261" class="node">
<title>ring_attn_3_12_stage_9</title>
<polygon fill="yellow" stroke="black" points="7269,-2593 7060,-2525 7269,-2457 7478,-2525 7269,-2593"/>
<text text-anchor="middle" x="7269" y="-2543.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-2528.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="7269" y="-2513.8" font-family="Times,serif" font-size="14.00">Q[12]×K[3]×V[3]</text>
<text text-anchor="middle" x="7269" y="-2498.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_11_stage_9&#45;&gt;ring_attn_3_12_stage_9 -->
<g id="edge2314" class="edge">
<title>ring_attn_3_11_stage_9&#45;&gt;ring_attn_3_12_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-2525C6891.02,-2525 7049.86,-2525 7049.86,-2525"/>
<polygon fill="red" stroke="red" points="7049.86,-2528.5 7059.86,-2525 7049.86,-2521.5 7049.86,-2528.5"/>
</g>
<!-- ring_attn_3_11_stage_10&#45;&gt;ring_attn_3_11_stage_11 -->
<g id="edge1153" class="edge">
<title>ring_attn_3_11_stage_10&#45;&gt;ring_attn_3_11_stage_11</title>
<path fill="none" stroke="black" d="M6682,-2203.87C6682,-2203.87 6682,-2097.25 6682,-2097.25"/>
<polygon fill="black" stroke="black" points="6685.5,-2097.25 6682,-2087.25 6678.5,-2097.25 6685.5,-2097.25"/>
</g>
<!-- ring_attn_3_12_stage_10 -->
<g id="node1262" class="node">
<title>ring_attn_3_12_stage_10</title>
<polygon fill="yellow" stroke="black" points="7269,-2340 7060,-2272 7269,-2204 7478,-2272 7269,-2340"/>
<text text-anchor="middle" x="7269" y="-2290.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-2275.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="7269" y="-2260.8" font-family="Times,serif" font-size="14.00">Q[12]×K[2]×V[2]</text>
<text text-anchor="middle" x="7269" y="-2245.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_11_stage_10&#45;&gt;ring_attn_3_12_stage_10 -->
<g id="edge2315" class="edge">
<title>ring_attn_3_11_stage_10&#45;&gt;ring_attn_3_12_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-2272C6891.02,-2272 7049.86,-2272 7049.86,-2272"/>
<polygon fill="red" stroke="red" points="7049.86,-2275.5 7059.86,-2272 7049.86,-2268.5 7049.86,-2275.5"/>
</g>
<!-- ring_attn_3_11_stage_11&#45;&gt;ring_attn_3_11_stage_12 -->
<g id="edge1154" class="edge">
<title>ring_attn_3_11_stage_11&#45;&gt;ring_attn_3_11_stage_12</title>
<path fill="none" stroke="black" d="M6682,-1950.87C6682,-1950.87 6682,-1844.25 6682,-1844.25"/>
<polygon fill="black" stroke="black" points="6685.5,-1844.25 6682,-1834.25 6678.5,-1844.25 6685.5,-1844.25"/>
</g>
<!-- ring_attn_3_12_stage_11 -->
<g id="node1263" class="node">
<title>ring_attn_3_12_stage_11</title>
<polygon fill="yellow" stroke="black" points="7269,-2087 7060,-2019 7269,-1951 7478,-2019 7269,-2087"/>
<text text-anchor="middle" x="7269" y="-2037.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-2022.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="7269" y="-2007.8" font-family="Times,serif" font-size="14.00">Q[12]×K[1]×V[1]</text>
<text text-anchor="middle" x="7269" y="-1992.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_11_stage_11&#45;&gt;ring_attn_3_12_stage_11 -->
<g id="edge2316" class="edge">
<title>ring_attn_3_11_stage_11&#45;&gt;ring_attn_3_12_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-2019C6891.02,-2019 7049.86,-2019 7049.86,-2019"/>
<polygon fill="red" stroke="red" points="7049.86,-2022.5 7059.86,-2019 7049.86,-2015.5 7049.86,-2022.5"/>
</g>
<!-- ring_attn_3_11_stage_12&#45;&gt;ring_attn_3_11_stage_13 -->
<g id="edge1155" class="edge">
<title>ring_attn_3_11_stage_12&#45;&gt;ring_attn_3_11_stage_13</title>
<path fill="none" stroke="black" d="M6682,-1697.87C6682,-1697.87 6682,-1591.25 6682,-1591.25"/>
<polygon fill="black" stroke="black" points="6685.5,-1591.25 6682,-1581.25 6678.5,-1591.25 6685.5,-1591.25"/>
</g>
<!-- ring_attn_3_12_stage_12 -->
<g id="node1264" class="node">
<title>ring_attn_3_12_stage_12</title>
<polygon fill="yellow" stroke="black" points="7269,-1834 7060,-1766 7269,-1698 7478,-1766 7269,-1834"/>
<text text-anchor="middle" x="7269" y="-1784.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-1769.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="7269" y="-1754.8" font-family="Times,serif" font-size="14.00">Q[12]×K[0]×V[0]</text>
<text text-anchor="middle" x="7269" y="-1739.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_11_stage_12&#45;&gt;ring_attn_3_12_stage_12 -->
<g id="edge2317" class="edge">
<title>ring_attn_3_11_stage_12&#45;&gt;ring_attn_3_12_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-1766C6891.02,-1766 7049.86,-1766 7049.86,-1766"/>
<polygon fill="red" stroke="red" points="7049.86,-1769.5 7059.86,-1766 7049.86,-1762.5 7049.86,-1769.5"/>
</g>
<!-- ring_attn_3_11_stage_13&#45;&gt;ring_attn_3_11_stage_14 -->
<g id="edge1156" class="edge">
<title>ring_attn_3_11_stage_13&#45;&gt;ring_attn_3_11_stage_14</title>
<path fill="none" stroke="black" d="M6682,-1444.87C6682,-1444.87 6682,-1338.25 6682,-1338.25"/>
<polygon fill="black" stroke="black" points="6685.5,-1338.25 6682,-1328.25 6678.5,-1338.25 6685.5,-1338.25"/>
</g>
<!-- ring_attn_3_12_stage_13 -->
<g id="node1265" class="node">
<title>ring_attn_3_12_stage_13</title>
<polygon fill="yellow" stroke="black" points="7269,-1581 7060,-1513 7269,-1445 7478,-1513 7269,-1581"/>
<text text-anchor="middle" x="7269" y="-1531.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-1516.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="7269" y="-1501.8" font-family="Times,serif" font-size="14.00">Q[12]×K[15]×V[15]</text>
<text text-anchor="middle" x="7269" y="-1486.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_11_stage_13&#45;&gt;ring_attn_3_12_stage_13 -->
<g id="edge2318" class="edge">
<title>ring_attn_3_11_stage_13&#45;&gt;ring_attn_3_12_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-1513C6891.02,-1513 7049.86,-1513 7049.86,-1513"/>
<polygon fill="red" stroke="red" points="7049.86,-1516.5 7059.86,-1513 7049.86,-1509.5 7049.86,-1516.5"/>
</g>
<!-- ring_attn_3_11_stage_14&#45;&gt;ring_attn_3_11_stage_15 -->
<g id="edge1157" class="edge">
<title>ring_attn_3_11_stage_14&#45;&gt;ring_attn_3_11_stage_15</title>
<path fill="none" stroke="black" d="M6682,-1191.87C6682,-1191.87 6682,-1085.25 6682,-1085.25"/>
<polygon fill="black" stroke="black" points="6685.5,-1085.25 6682,-1075.25 6678.5,-1085.25 6685.5,-1085.25"/>
</g>
<!-- ring_attn_3_12_stage_14 -->
<g id="node1266" class="node">
<title>ring_attn_3_12_stage_14</title>
<polygon fill="yellow" stroke="black" points="7269,-1328 7060,-1260 7269,-1192 7478,-1260 7269,-1328"/>
<text text-anchor="middle" x="7269" y="-1278.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-1263.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="7269" y="-1248.8" font-family="Times,serif" font-size="14.00">Q[12]×K[14]×V[14]</text>
<text text-anchor="middle" x="7269" y="-1233.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_11_stage_14&#45;&gt;ring_attn_3_12_stage_14 -->
<g id="edge2319" class="edge">
<title>ring_attn_3_11_stage_14&#45;&gt;ring_attn_3_12_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-1260C6891.02,-1260 7049.86,-1260 7049.86,-1260"/>
<polygon fill="red" stroke="red" points="7049.86,-1263.5 7059.86,-1260 7049.86,-1256.5 7049.86,-1263.5"/>
</g>
<!-- attn_out_3_11 -->
<g id="node1170" class="node">
<title>attn_out_3_11</title>
<polygon fill="none" stroke="black" points="6751.5,-866 6612.5,-866 6612.5,-813 6751.5,-813 6751.5,-866"/>
<text text-anchor="middle" x="6682" y="-850.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6682" y="-835.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="6682" y="-820.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_3_11_stage_15&#45;&gt;attn_out_3_11 -->
<g id="edge1158" class="edge">
<title>ring_attn_3_11_stage_15&#45;&gt;attn_out_3_11</title>
<path fill="none" stroke="black" d="M6682,-938.87C6682,-938.87 6682,-876.18 6682,-876.18"/>
<polygon fill="black" stroke="black" points="6685.5,-876.18 6682,-866.18 6678.5,-876.18 6685.5,-876.18"/>
</g>
<!-- ring_attn_3_12_stage_15 -->
<g id="node1267" class="node">
<title>ring_attn_3_12_stage_15</title>
<polygon fill="yellow" stroke="black" points="7269,-1075 7060,-1007 7269,-939 7478,-1007 7269,-1075"/>
<text text-anchor="middle" x="7269" y="-1025.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7269" y="-1010.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="7269" y="-995.8" font-family="Times,serif" font-size="14.00">Q[12]×K[13]×V[13]</text>
<text text-anchor="middle" x="7269" y="-980.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_11_stage_15&#45;&gt;ring_attn_3_12_stage_15 -->
<g id="edge2320" class="edge">
<title>ring_attn_3_11_stage_15&#45;&gt;ring_attn_3_12_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M6891.02,-1007C6891.02,-1007 7049.86,-1007 7049.86,-1007"/>
<polygon fill="red" stroke="red" points="7049.86,-1010.5 7059.86,-1007 7049.86,-1003.5 7049.86,-1010.5"/>
</g>
<!-- attn_residual_3_11 -->
<g id="node1171" class="node">
<title>attn_residual_3_11</title>
<ellipse fill="none" stroke="black" cx="6682" cy="-713" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6682" y="-716.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="6682" y="-701.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_3_11&#45;&gt;attn_residual_3_11 -->
<g id="edge1159" class="edge">
<title>attn_out_3_11&#45;&gt;attn_residual_3_11</title>
<path fill="none" stroke="black" d="M6682,-812.98C6682,-812.98 6682,-750.36 6682,-750.36"/>
<polygon fill="black" stroke="black" points="6685.5,-750.36 6682,-740.36 6678.5,-750.36 6685.5,-750.36"/>
</g>
<!-- ffn_up_3_11 -->
<g id="node1172" class="node">
<title>ffn_up_3_11</title>
<polygon fill="none" stroke="black" points="6761,-613 6603,-613 6603,-560 6761,-560 6761,-613"/>
<text text-anchor="middle" x="6682" y="-597.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="6682" y="-582.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="6682" y="-567.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_3_11&#45;&gt;ffn_up_3_11 -->
<g id="edge1160" class="edge">
<title>attn_residual_3_11&#45;&gt;ffn_up_3_11</title>
<path fill="none" stroke="black" d="M6682,-685.86C6682,-685.86 6682,-623.16 6682,-623.16"/>
<polygon fill="black" stroke="black" points="6685.5,-623.16 6682,-613.16 6678.5,-623.16 6685.5,-623.16"/>
</g>
<!-- ffn_gelu_3_11 -->
<g id="node1173" class="node">
<title>ffn_gelu_3_11</title>
<ellipse fill="none" stroke="black" cx="6682" cy="-460" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6682" y="-463.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="6682" y="-448.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_3_11&#45;&gt;ffn_gelu_3_11 -->
<g id="edge1161" class="edge">
<title>ffn_up_3_11&#45;&gt;ffn_gelu_3_11</title>
<path fill="none" stroke="black" d="M6682,-559.98C6682,-559.98 6682,-497.36 6682,-497.36"/>
<polygon fill="black" stroke="black" points="6685.5,-497.36 6682,-487.36 6678.5,-497.36 6685.5,-497.36"/>
</g>
<!-- ffn_down_3_11 -->
<g id="node1174" class="node">
<title>ffn_down_3_11</title>
<polygon fill="none" stroke="black" points="6771,-360 6593,-360 6593,-307 6771,-307 6771,-360"/>
<text text-anchor="middle" x="6682" y="-344.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="6682" y="-329.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="6682" y="-314.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_3_11&#45;&gt;ffn_down_3_11 -->
<g id="edge1162" class="edge">
<title>ffn_gelu_3_11&#45;&gt;ffn_down_3_11</title>
<path fill="none" stroke="black" d="M6682,-432.86C6682,-432.86 6682,-370.16 6682,-370.16"/>
<polygon fill="black" stroke="black" points="6685.5,-370.16 6682,-360.16 6678.5,-370.16 6685.5,-370.16"/>
</g>
<!-- ffn_residual_3_11 -->
<g id="node1175" class="node">
<title>ffn_residual_3_11</title>
<ellipse fill="none" stroke="black" cx="6682" cy="-207" rx="105.5" ry="27"/>
<text text-anchor="middle" x="6682" y="-210.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="6682" y="-195.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_3_11&#45;&gt;ffn_residual_3_11 -->
<g id="edge1163" class="edge">
<title>ffn_down_3_11&#45;&gt;ffn_residual_3_11</title>
<path fill="none" stroke="black" d="M6682,-306.98C6682,-306.98 6682,-244.36 6682,-244.36"/>
<polygon fill="black" stroke="black" points="6685.5,-244.36 6682,-234.36 6678.5,-244.36 6685.5,-244.36"/>
</g>
<!-- output_11 -->
<g id="node1176" class="node">
<title>output_11</title>
<polygon fill="lightcoral" stroke="black" points="6779.5,-107 6584.5,-107 6584.5,-69 6779.5,-69 6779.5,-107"/>
<text text-anchor="middle" x="6682" y="-91.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="6682" y="-76.8" font-family="Times,serif" font-size="14.00">Y[11]: 1024×1024×4096</text>
</g>
<!-- ffn_residual_3_11&#45;&gt;output_11 -->
<g id="edge1164" class="edge">
<title>ffn_residual_3_11&#45;&gt;output_11</title>
<path fill="none" stroke="black" d="M6682,-180C6682,-180 6682,-117.12 6682,-117.12"/>
<polygon fill="black" stroke="black" points="6685.5,-117.12 6682,-107.12 6678.5,-117.12 6685.5,-117.12"/>
</g>
<!-- input_12 -->
<g id="node1177" class="node">
<title>input_12</title>
<polygon fill="lightgreen" stroke="black" points="7367,-20458 7171,-20458 7171,-20420 7367,-20420 7367,-20458"/>
<text text-anchor="middle" x="7269" y="-20442.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="7269" y="-20427.8" font-family="Times,serif" font-size="14.00">X[12]: 1024×1024×4096</text>
</g>
<!-- qkv_proj_0_12 -->
<g id="node1178" class="node">
<title>qkv_proj_0_12</title>
<polygon fill="none" stroke="black" points="7351.5,-20347 7186.5,-20347 7186.5,-20294 7351.5,-20294 7351.5,-20347"/>
<text text-anchor="middle" x="7269" y="-20331.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7269" y="-20316.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="7269" y="-20301.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- input_12&#45;&gt;qkv_proj_0_12 -->
<g id="edge1165" class="edge">
<title>input_12&#45;&gt;qkv_proj_0_12</title>
<path fill="none" stroke="black" d="M7269,-20419.96C7269,-20419.96 7269,-20357.44 7269,-20357.44"/>
<polygon fill="black" stroke="black" points="7272.5,-20357.44 7269,-20347.44 7265.5,-20357.44 7272.5,-20357.44"/>
</g>
<!-- qkv_reshape_0_12 -->
<g id="node1179" class="node">
<title>qkv_reshape_0_12</title>
<ellipse fill="none" stroke="black" cx="7269" cy="-20194" rx="148" ry="27"/>
<text text-anchor="middle" x="7269" y="-20197.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="7269" y="-20182.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_0_12&#45;&gt;qkv_reshape_0_12 -->
<g id="edge1166" class="edge">
<title>qkv_proj_0_12&#45;&gt;qkv_reshape_0_12</title>
<path fill="none" stroke="black" d="M7269,-20293.98C7269,-20293.98 7269,-20231.36 7269,-20231.36"/>
<polygon fill="black" stroke="black" points="7272.5,-20231.36 7269,-20221.36 7265.5,-20231.36 7272.5,-20231.36"/>
</g>
<!-- qkv_reshape_0_12&#45;&gt;ring_attn_0_12_stage_0 -->
<g id="edge1167" class="edge">
<title>qkv_reshape_0_12&#45;&gt;ring_attn_0_12_stage_0</title>
<path fill="none" stroke="black" d="M7269,-20166.72C7269,-20166.72 7269,-20060.16 7269,-20060.16"/>
<polygon fill="black" stroke="black" points="7272.5,-20060.16 7269,-20050.16 7265.5,-20060.16 7272.5,-20060.16"/>
</g>
<!-- ring_attn_0_12_stage_0&#45;&gt;ring_attn_0_12_stage_1 -->
<g id="edge1168" class="edge">
<title>ring_attn_0_12_stage_0&#45;&gt;ring_attn_0_12_stage_1</title>
<path fill="none" stroke="black" d="M7269,-19913.87C7269,-19913.87 7269,-19807.25 7269,-19807.25"/>
<polygon fill="black" stroke="black" points="7272.5,-19807.25 7269,-19797.25 7265.5,-19807.25 7272.5,-19807.25"/>
</g>
<!-- ring_attn_0_13_stage_0 -->
<g id="node1278" class="node">
<title>ring_attn_0_13_stage_0</title>
<polygon fill="yellow" stroke="black" points="7856,-20050 7647,-19982 7856,-19914 8065,-19982 7856,-20050"/>
<text text-anchor="middle" x="7856" y="-20000.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-19985.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="7856" y="-19970.8" font-family="Times,serif" font-size="14.00">Q[13]×K[13]×V[13]</text>
<text text-anchor="middle" x="7856" y="-19955.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_12_stage_0&#45;&gt;ring_attn_0_13_stage_0 -->
<g id="edge2321" class="edge">
<title>ring_attn_0_12_stage_0&#45;&gt;ring_attn_0_13_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-19982C7478.02,-19982 7636.86,-19982 7636.86,-19982"/>
<polygon fill="red" stroke="red" points="7636.86,-19985.5 7646.86,-19982 7636.86,-19978.5 7636.86,-19985.5"/>
</g>
<!-- ring_attn_0_12_stage_1&#45;&gt;ring_attn_0_12_stage_2 -->
<g id="edge1169" class="edge">
<title>ring_attn_0_12_stage_1&#45;&gt;ring_attn_0_12_stage_2</title>
<path fill="none" stroke="black" d="M7269,-19660.87C7269,-19660.87 7269,-19554.25 7269,-19554.25"/>
<polygon fill="black" stroke="black" points="7272.5,-19554.25 7269,-19544.25 7265.5,-19554.25 7272.5,-19554.25"/>
</g>
<!-- ring_attn_0_13_stage_1 -->
<g id="node1279" class="node">
<title>ring_attn_0_13_stage_1</title>
<polygon fill="yellow" stroke="black" points="7856,-19797 7647,-19729 7856,-19661 8065,-19729 7856,-19797"/>
<text text-anchor="middle" x="7856" y="-19747.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-19732.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="7856" y="-19717.8" font-family="Times,serif" font-size="14.00">Q[13]×K[12]×V[12]</text>
<text text-anchor="middle" x="7856" y="-19702.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_12_stage_1&#45;&gt;ring_attn_0_13_stage_1 -->
<g id="edge2322" class="edge">
<title>ring_attn_0_12_stage_1&#45;&gt;ring_attn_0_13_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-19729C7478.02,-19729 7636.86,-19729 7636.86,-19729"/>
<polygon fill="red" stroke="red" points="7636.86,-19732.5 7646.86,-19729 7636.86,-19725.5 7636.86,-19732.5"/>
</g>
<!-- ring_attn_0_12_stage_2&#45;&gt;ring_attn_0_12_stage_3 -->
<g id="edge1170" class="edge">
<title>ring_attn_0_12_stage_2&#45;&gt;ring_attn_0_12_stage_3</title>
<path fill="none" stroke="black" d="M7269,-19407.87C7269,-19407.87 7269,-19301.25 7269,-19301.25"/>
<polygon fill="black" stroke="black" points="7272.5,-19301.25 7269,-19291.25 7265.5,-19301.25 7272.5,-19301.25"/>
</g>
<!-- ring_attn_0_13_stage_2 -->
<g id="node1280" class="node">
<title>ring_attn_0_13_stage_2</title>
<polygon fill="yellow" stroke="black" points="7856,-19544 7647,-19476 7856,-19408 8065,-19476 7856,-19544"/>
<text text-anchor="middle" x="7856" y="-19494.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-19479.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="7856" y="-19464.8" font-family="Times,serif" font-size="14.00">Q[13]×K[11]×V[11]</text>
<text text-anchor="middle" x="7856" y="-19449.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_12_stage_2&#45;&gt;ring_attn_0_13_stage_2 -->
<g id="edge2323" class="edge">
<title>ring_attn_0_12_stage_2&#45;&gt;ring_attn_0_13_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-19476C7478.02,-19476 7636.86,-19476 7636.86,-19476"/>
<polygon fill="red" stroke="red" points="7636.86,-19479.5 7646.86,-19476 7636.86,-19472.5 7636.86,-19479.5"/>
</g>
<!-- ring_attn_0_12_stage_3&#45;&gt;ring_attn_0_12_stage_4 -->
<g id="edge1171" class="edge">
<title>ring_attn_0_12_stage_3&#45;&gt;ring_attn_0_12_stage_4</title>
<path fill="none" stroke="black" d="M7269,-19154.87C7269,-19154.87 7269,-19048.25 7269,-19048.25"/>
<polygon fill="black" stroke="black" points="7272.5,-19048.25 7269,-19038.25 7265.5,-19048.25 7272.5,-19048.25"/>
</g>
<!-- ring_attn_0_13_stage_3 -->
<g id="node1281" class="node">
<title>ring_attn_0_13_stage_3</title>
<polygon fill="yellow" stroke="black" points="7856,-19291 7647,-19223 7856,-19155 8065,-19223 7856,-19291"/>
<text text-anchor="middle" x="7856" y="-19241.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-19226.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="7856" y="-19211.8" font-family="Times,serif" font-size="14.00">Q[13]×K[10]×V[10]</text>
<text text-anchor="middle" x="7856" y="-19196.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_12_stage_3&#45;&gt;ring_attn_0_13_stage_3 -->
<g id="edge2324" class="edge">
<title>ring_attn_0_12_stage_3&#45;&gt;ring_attn_0_13_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-19223C7478.02,-19223 7636.86,-19223 7636.86,-19223"/>
<polygon fill="red" stroke="red" points="7636.86,-19226.5 7646.86,-19223 7636.86,-19219.5 7636.86,-19226.5"/>
</g>
<!-- ring_attn_0_12_stage_4&#45;&gt;ring_attn_0_12_stage_5 -->
<g id="edge1172" class="edge">
<title>ring_attn_0_12_stage_4&#45;&gt;ring_attn_0_12_stage_5</title>
<path fill="none" stroke="black" d="M7269,-18901.87C7269,-18901.87 7269,-18795.25 7269,-18795.25"/>
<polygon fill="black" stroke="black" points="7272.5,-18795.25 7269,-18785.25 7265.5,-18795.25 7272.5,-18795.25"/>
</g>
<!-- ring_attn_0_13_stage_4 -->
<g id="node1282" class="node">
<title>ring_attn_0_13_stage_4</title>
<polygon fill="yellow" stroke="black" points="7856,-19038 7647,-18970 7856,-18902 8065,-18970 7856,-19038"/>
<text text-anchor="middle" x="7856" y="-18988.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-18973.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="7856" y="-18958.8" font-family="Times,serif" font-size="14.00">Q[13]×K[9]×V[9]</text>
<text text-anchor="middle" x="7856" y="-18943.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_12_stage_4&#45;&gt;ring_attn_0_13_stage_4 -->
<g id="edge2325" class="edge">
<title>ring_attn_0_12_stage_4&#45;&gt;ring_attn_0_13_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-18970C7478.02,-18970 7636.86,-18970 7636.86,-18970"/>
<polygon fill="red" stroke="red" points="7636.86,-18973.5 7646.86,-18970 7636.86,-18966.5 7636.86,-18973.5"/>
</g>
<!-- ring_attn_0_12_stage_5&#45;&gt;ring_attn_0_12_stage_6 -->
<g id="edge1173" class="edge">
<title>ring_attn_0_12_stage_5&#45;&gt;ring_attn_0_12_stage_6</title>
<path fill="none" stroke="black" d="M7269,-18648.87C7269,-18648.87 7269,-18542.25 7269,-18542.25"/>
<polygon fill="black" stroke="black" points="7272.5,-18542.25 7269,-18532.25 7265.5,-18542.25 7272.5,-18542.25"/>
</g>
<!-- ring_attn_0_13_stage_5 -->
<g id="node1283" class="node">
<title>ring_attn_0_13_stage_5</title>
<polygon fill="yellow" stroke="black" points="7856,-18785 7647,-18717 7856,-18649 8065,-18717 7856,-18785"/>
<text text-anchor="middle" x="7856" y="-18735.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-18720.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="7856" y="-18705.8" font-family="Times,serif" font-size="14.00">Q[13]×K[8]×V[8]</text>
<text text-anchor="middle" x="7856" y="-18690.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_12_stage_5&#45;&gt;ring_attn_0_13_stage_5 -->
<g id="edge2326" class="edge">
<title>ring_attn_0_12_stage_5&#45;&gt;ring_attn_0_13_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-18717C7478.02,-18717 7636.86,-18717 7636.86,-18717"/>
<polygon fill="red" stroke="red" points="7636.86,-18720.5 7646.86,-18717 7636.86,-18713.5 7636.86,-18720.5"/>
</g>
<!-- ring_attn_0_12_stage_6&#45;&gt;ring_attn_0_12_stage_7 -->
<g id="edge1174" class="edge">
<title>ring_attn_0_12_stage_6&#45;&gt;ring_attn_0_12_stage_7</title>
<path fill="none" stroke="black" d="M7269,-18395.87C7269,-18395.87 7269,-18289.25 7269,-18289.25"/>
<polygon fill="black" stroke="black" points="7272.5,-18289.25 7269,-18279.25 7265.5,-18289.25 7272.5,-18289.25"/>
</g>
<!-- ring_attn_0_13_stage_6 -->
<g id="node1284" class="node">
<title>ring_attn_0_13_stage_6</title>
<polygon fill="yellow" stroke="black" points="7856,-18532 7647,-18464 7856,-18396 8065,-18464 7856,-18532"/>
<text text-anchor="middle" x="7856" y="-18482.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-18467.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="7856" y="-18452.8" font-family="Times,serif" font-size="14.00">Q[13]×K[7]×V[7]</text>
<text text-anchor="middle" x="7856" y="-18437.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_12_stage_6&#45;&gt;ring_attn_0_13_stage_6 -->
<g id="edge2327" class="edge">
<title>ring_attn_0_12_stage_6&#45;&gt;ring_attn_0_13_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-18464C7478.02,-18464 7636.86,-18464 7636.86,-18464"/>
<polygon fill="red" stroke="red" points="7636.86,-18467.5 7646.86,-18464 7636.86,-18460.5 7636.86,-18467.5"/>
</g>
<!-- ring_attn_0_12_stage_7&#45;&gt;ring_attn_0_12_stage_8 -->
<g id="edge1175" class="edge">
<title>ring_attn_0_12_stage_7&#45;&gt;ring_attn_0_12_stage_8</title>
<path fill="none" stroke="black" d="M7269,-18142.87C7269,-18142.87 7269,-18036.25 7269,-18036.25"/>
<polygon fill="black" stroke="black" points="7272.5,-18036.25 7269,-18026.25 7265.5,-18036.25 7272.5,-18036.25"/>
</g>
<!-- ring_attn_0_13_stage_7 -->
<g id="node1285" class="node">
<title>ring_attn_0_13_stage_7</title>
<polygon fill="yellow" stroke="black" points="7856,-18279 7647,-18211 7856,-18143 8065,-18211 7856,-18279"/>
<text text-anchor="middle" x="7856" y="-18229.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-18214.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="7856" y="-18199.8" font-family="Times,serif" font-size="14.00">Q[13]×K[6]×V[6]</text>
<text text-anchor="middle" x="7856" y="-18184.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_12_stage_7&#45;&gt;ring_attn_0_13_stage_7 -->
<g id="edge2328" class="edge">
<title>ring_attn_0_12_stage_7&#45;&gt;ring_attn_0_13_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-18211C7478.02,-18211 7636.86,-18211 7636.86,-18211"/>
<polygon fill="red" stroke="red" points="7636.86,-18214.5 7646.86,-18211 7636.86,-18207.5 7636.86,-18214.5"/>
</g>
<!-- ring_attn_0_12_stage_8&#45;&gt;ring_attn_0_12_stage_9 -->
<g id="edge1176" class="edge">
<title>ring_attn_0_12_stage_8&#45;&gt;ring_attn_0_12_stage_9</title>
<path fill="none" stroke="black" d="M7269,-17889.87C7269,-17889.87 7269,-17783.25 7269,-17783.25"/>
<polygon fill="black" stroke="black" points="7272.5,-17783.25 7269,-17773.25 7265.5,-17783.25 7272.5,-17783.25"/>
</g>
<!-- ring_attn_0_13_stage_8 -->
<g id="node1286" class="node">
<title>ring_attn_0_13_stage_8</title>
<polygon fill="yellow" stroke="black" points="7856,-18026 7647,-17958 7856,-17890 8065,-17958 7856,-18026"/>
<text text-anchor="middle" x="7856" y="-17976.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-17961.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="7856" y="-17946.8" font-family="Times,serif" font-size="14.00">Q[13]×K[5]×V[5]</text>
<text text-anchor="middle" x="7856" y="-17931.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_12_stage_8&#45;&gt;ring_attn_0_13_stage_8 -->
<g id="edge2329" class="edge">
<title>ring_attn_0_12_stage_8&#45;&gt;ring_attn_0_13_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-17958C7478.02,-17958 7636.86,-17958 7636.86,-17958"/>
<polygon fill="red" stroke="red" points="7636.86,-17961.5 7646.86,-17958 7636.86,-17954.5 7636.86,-17961.5"/>
</g>
<!-- ring_attn_0_12_stage_9&#45;&gt;ring_attn_0_12_stage_10 -->
<g id="edge1177" class="edge">
<title>ring_attn_0_12_stage_9&#45;&gt;ring_attn_0_12_stage_10</title>
<path fill="none" stroke="black" d="M7269,-17636.87C7269,-17636.87 7269,-17530.25 7269,-17530.25"/>
<polygon fill="black" stroke="black" points="7272.5,-17530.25 7269,-17520.25 7265.5,-17530.25 7272.5,-17530.25"/>
</g>
<!-- ring_attn_0_13_stage_9 -->
<g id="node1287" class="node">
<title>ring_attn_0_13_stage_9</title>
<polygon fill="yellow" stroke="black" points="7856,-17773 7647,-17705 7856,-17637 8065,-17705 7856,-17773"/>
<text text-anchor="middle" x="7856" y="-17723.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-17708.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="7856" y="-17693.8" font-family="Times,serif" font-size="14.00">Q[13]×K[4]×V[4]</text>
<text text-anchor="middle" x="7856" y="-17678.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_12_stage_9&#45;&gt;ring_attn_0_13_stage_9 -->
<g id="edge2330" class="edge">
<title>ring_attn_0_12_stage_9&#45;&gt;ring_attn_0_13_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-17705C7478.02,-17705 7636.86,-17705 7636.86,-17705"/>
<polygon fill="red" stroke="red" points="7636.86,-17708.5 7646.86,-17705 7636.86,-17701.5 7636.86,-17708.5"/>
</g>
<!-- ring_attn_0_12_stage_10&#45;&gt;ring_attn_0_12_stage_11 -->
<g id="edge1178" class="edge">
<title>ring_attn_0_12_stage_10&#45;&gt;ring_attn_0_12_stage_11</title>
<path fill="none" stroke="black" d="M7269,-17383.87C7269,-17383.87 7269,-17277.25 7269,-17277.25"/>
<polygon fill="black" stroke="black" points="7272.5,-17277.25 7269,-17267.25 7265.5,-17277.25 7272.5,-17277.25"/>
</g>
<!-- ring_attn_0_13_stage_10 -->
<g id="node1288" class="node">
<title>ring_attn_0_13_stage_10</title>
<polygon fill="yellow" stroke="black" points="7856,-17520 7647,-17452 7856,-17384 8065,-17452 7856,-17520"/>
<text text-anchor="middle" x="7856" y="-17470.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-17455.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="7856" y="-17440.8" font-family="Times,serif" font-size="14.00">Q[13]×K[3]×V[3]</text>
<text text-anchor="middle" x="7856" y="-17425.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_12_stage_10&#45;&gt;ring_attn_0_13_stage_10 -->
<g id="edge2331" class="edge">
<title>ring_attn_0_12_stage_10&#45;&gt;ring_attn_0_13_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-17452C7478.02,-17452 7636.86,-17452 7636.86,-17452"/>
<polygon fill="red" stroke="red" points="7636.86,-17455.5 7646.86,-17452 7636.86,-17448.5 7636.86,-17455.5"/>
</g>
<!-- ring_attn_0_12_stage_11&#45;&gt;ring_attn_0_12_stage_12 -->
<g id="edge1179" class="edge">
<title>ring_attn_0_12_stage_11&#45;&gt;ring_attn_0_12_stage_12</title>
<path fill="none" stroke="black" d="M7269,-17130.87C7269,-17130.87 7269,-17024.25 7269,-17024.25"/>
<polygon fill="black" stroke="black" points="7272.5,-17024.25 7269,-17014.25 7265.5,-17024.25 7272.5,-17024.25"/>
</g>
<!-- ring_attn_0_13_stage_11 -->
<g id="node1289" class="node">
<title>ring_attn_0_13_stage_11</title>
<polygon fill="yellow" stroke="black" points="7856,-17267 7647,-17199 7856,-17131 8065,-17199 7856,-17267"/>
<text text-anchor="middle" x="7856" y="-17217.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-17202.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="7856" y="-17187.8" font-family="Times,serif" font-size="14.00">Q[13]×K[2]×V[2]</text>
<text text-anchor="middle" x="7856" y="-17172.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_12_stage_11&#45;&gt;ring_attn_0_13_stage_11 -->
<g id="edge2332" class="edge">
<title>ring_attn_0_12_stage_11&#45;&gt;ring_attn_0_13_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-17199C7478.02,-17199 7636.86,-17199 7636.86,-17199"/>
<polygon fill="red" stroke="red" points="7636.86,-17202.5 7646.86,-17199 7636.86,-17195.5 7636.86,-17202.5"/>
</g>
<!-- ring_attn_0_12_stage_12&#45;&gt;ring_attn_0_12_stage_13 -->
<g id="edge1180" class="edge">
<title>ring_attn_0_12_stage_12&#45;&gt;ring_attn_0_12_stage_13</title>
<path fill="none" stroke="black" d="M7269,-16877.87C7269,-16877.87 7269,-16771.25 7269,-16771.25"/>
<polygon fill="black" stroke="black" points="7272.5,-16771.25 7269,-16761.25 7265.5,-16771.25 7272.5,-16771.25"/>
</g>
<!-- ring_attn_0_13_stage_12 -->
<g id="node1290" class="node">
<title>ring_attn_0_13_stage_12</title>
<polygon fill="yellow" stroke="black" points="7856,-17014 7647,-16946 7856,-16878 8065,-16946 7856,-17014"/>
<text text-anchor="middle" x="7856" y="-16964.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-16949.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="7856" y="-16934.8" font-family="Times,serif" font-size="14.00">Q[13]×K[1]×V[1]</text>
<text text-anchor="middle" x="7856" y="-16919.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_12_stage_12&#45;&gt;ring_attn_0_13_stage_12 -->
<g id="edge2333" class="edge">
<title>ring_attn_0_12_stage_12&#45;&gt;ring_attn_0_13_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-16946C7478.02,-16946 7636.86,-16946 7636.86,-16946"/>
<polygon fill="red" stroke="red" points="7636.86,-16949.5 7646.86,-16946 7636.86,-16942.5 7636.86,-16949.5"/>
</g>
<!-- ring_attn_0_12_stage_13&#45;&gt;ring_attn_0_12_stage_14 -->
<g id="edge1181" class="edge">
<title>ring_attn_0_12_stage_13&#45;&gt;ring_attn_0_12_stage_14</title>
<path fill="none" stroke="black" d="M7269,-16624.87C7269,-16624.87 7269,-16518.25 7269,-16518.25"/>
<polygon fill="black" stroke="black" points="7272.5,-16518.25 7269,-16508.25 7265.5,-16518.25 7272.5,-16518.25"/>
</g>
<!-- ring_attn_0_13_stage_13 -->
<g id="node1291" class="node">
<title>ring_attn_0_13_stage_13</title>
<polygon fill="yellow" stroke="black" points="7856,-16761 7647,-16693 7856,-16625 8065,-16693 7856,-16761"/>
<text text-anchor="middle" x="7856" y="-16711.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-16696.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="7856" y="-16681.8" font-family="Times,serif" font-size="14.00">Q[13]×K[0]×V[0]</text>
<text text-anchor="middle" x="7856" y="-16666.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_12_stage_13&#45;&gt;ring_attn_0_13_stage_13 -->
<g id="edge2334" class="edge">
<title>ring_attn_0_12_stage_13&#45;&gt;ring_attn_0_13_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-16693C7478.02,-16693 7636.86,-16693 7636.86,-16693"/>
<polygon fill="red" stroke="red" points="7636.86,-16696.5 7646.86,-16693 7636.86,-16689.5 7636.86,-16696.5"/>
</g>
<!-- ring_attn_0_12_stage_14&#45;&gt;ring_attn_0_12_stage_15 -->
<g id="edge1182" class="edge">
<title>ring_attn_0_12_stage_14&#45;&gt;ring_attn_0_12_stage_15</title>
<path fill="none" stroke="black" d="M7269,-16371.87C7269,-16371.87 7269,-16265.25 7269,-16265.25"/>
<polygon fill="black" stroke="black" points="7272.5,-16265.25 7269,-16255.25 7265.5,-16265.25 7272.5,-16265.25"/>
</g>
<!-- ring_attn_0_13_stage_14 -->
<g id="node1292" class="node">
<title>ring_attn_0_13_stage_14</title>
<polygon fill="yellow" stroke="black" points="7856,-16508 7647,-16440 7856,-16372 8065,-16440 7856,-16508"/>
<text text-anchor="middle" x="7856" y="-16458.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-16443.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="7856" y="-16428.8" font-family="Times,serif" font-size="14.00">Q[13]×K[15]×V[15]</text>
<text text-anchor="middle" x="7856" y="-16413.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_12_stage_14&#45;&gt;ring_attn_0_13_stage_14 -->
<g id="edge2335" class="edge">
<title>ring_attn_0_12_stage_14&#45;&gt;ring_attn_0_13_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-16440C7478.02,-16440 7636.86,-16440 7636.86,-16440"/>
<polygon fill="red" stroke="red" points="7636.86,-16443.5 7646.86,-16440 7636.86,-16436.5 7636.86,-16443.5"/>
</g>
<!-- attn_out_0_12 -->
<g id="node1196" class="node">
<title>attn_out_0_12</title>
<polygon fill="none" stroke="black" points="7338.5,-16046 7199.5,-16046 7199.5,-15993 7338.5,-15993 7338.5,-16046"/>
<text text-anchor="middle" x="7269" y="-16030.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="7269" y="-16015.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="7269" y="-16000.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_0_12_stage_15&#45;&gt;attn_out_0_12 -->
<g id="edge1183" class="edge">
<title>ring_attn_0_12_stage_15&#45;&gt;attn_out_0_12</title>
<path fill="none" stroke="black" d="M7269,-16118.87C7269,-16118.87 7269,-16056.18 7269,-16056.18"/>
<polygon fill="black" stroke="black" points="7272.5,-16056.18 7269,-16046.18 7265.5,-16056.18 7272.5,-16056.18"/>
</g>
<!-- ring_attn_0_13_stage_15 -->
<g id="node1293" class="node">
<title>ring_attn_0_13_stage_15</title>
<polygon fill="yellow" stroke="black" points="7856,-16255 7647,-16187 7856,-16119 8065,-16187 7856,-16255"/>
<text text-anchor="middle" x="7856" y="-16205.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-16190.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="7856" y="-16175.8" font-family="Times,serif" font-size="14.00">Q[13]×K[14]×V[14]</text>
<text text-anchor="middle" x="7856" y="-16160.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_12_stage_15&#45;&gt;ring_attn_0_13_stage_15 -->
<g id="edge2336" class="edge">
<title>ring_attn_0_12_stage_15&#45;&gt;ring_attn_0_13_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-16187C7478.02,-16187 7636.86,-16187 7636.86,-16187"/>
<polygon fill="red" stroke="red" points="7636.86,-16190.5 7646.86,-16187 7636.86,-16183.5 7636.86,-16190.5"/>
</g>
<!-- attn_residual_0_12 -->
<g id="node1197" class="node">
<title>attn_residual_0_12</title>
<ellipse fill="none" stroke="black" cx="7269" cy="-15893" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7269" y="-15896.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="7269" y="-15881.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_0_12&#45;&gt;attn_residual_0_12 -->
<g id="edge1184" class="edge">
<title>attn_out_0_12&#45;&gt;attn_residual_0_12</title>
<path fill="none" stroke="black" d="M7269,-15992.98C7269,-15992.98 7269,-15930.36 7269,-15930.36"/>
<polygon fill="black" stroke="black" points="7272.5,-15930.36 7269,-15920.36 7265.5,-15930.36 7272.5,-15930.36"/>
</g>
<!-- ffn_up_0_12 -->
<g id="node1198" class="node">
<title>ffn_up_0_12</title>
<polygon fill="none" stroke="black" points="7348,-15793 7190,-15793 7190,-15740 7348,-15740 7348,-15793"/>
<text text-anchor="middle" x="7269" y="-15777.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7269" y="-15762.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="7269" y="-15747.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_0_12&#45;&gt;ffn_up_0_12 -->
<g id="edge1185" class="edge">
<title>attn_residual_0_12&#45;&gt;ffn_up_0_12</title>
<path fill="none" stroke="black" d="M7269,-15865.86C7269,-15865.86 7269,-15803.16 7269,-15803.16"/>
<polygon fill="black" stroke="black" points="7272.5,-15803.16 7269,-15793.16 7265.5,-15803.16 7272.5,-15803.16"/>
</g>
<!-- ffn_gelu_0_12 -->
<g id="node1199" class="node">
<title>ffn_gelu_0_12</title>
<ellipse fill="none" stroke="black" cx="7269" cy="-15640" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7269" y="-15643.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7269" y="-15628.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_0_12&#45;&gt;ffn_gelu_0_12 -->
<g id="edge1186" class="edge">
<title>ffn_up_0_12&#45;&gt;ffn_gelu_0_12</title>
<path fill="none" stroke="black" d="M7269,-15739.98C7269,-15739.98 7269,-15677.36 7269,-15677.36"/>
<polygon fill="black" stroke="black" points="7272.5,-15677.36 7269,-15667.36 7265.5,-15677.36 7272.5,-15677.36"/>
</g>
<!-- ffn_down_0_12 -->
<g id="node1200" class="node">
<title>ffn_down_0_12</title>
<polygon fill="none" stroke="black" points="7358,-15540 7180,-15540 7180,-15487 7358,-15487 7358,-15540"/>
<text text-anchor="middle" x="7269" y="-15524.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7269" y="-15509.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="7269" y="-15494.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_0_12&#45;&gt;ffn_down_0_12 -->
<g id="edge1187" class="edge">
<title>ffn_gelu_0_12&#45;&gt;ffn_down_0_12</title>
<path fill="none" stroke="black" d="M7269,-15612.86C7269,-15612.86 7269,-15550.16 7269,-15550.16"/>
<polygon fill="black" stroke="black" points="7272.5,-15550.16 7269,-15540.16 7265.5,-15550.16 7272.5,-15550.16"/>
</g>
<!-- ffn_residual_0_12 -->
<g id="node1201" class="node">
<title>ffn_residual_0_12</title>
<ellipse fill="none" stroke="black" cx="7269" cy="-15387" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7269" y="-15390.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="7269" y="-15375.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_0_12&#45;&gt;ffn_residual_0_12 -->
<g id="edge1188" class="edge">
<title>ffn_down_0_12&#45;&gt;ffn_residual_0_12</title>
<path fill="none" stroke="black" d="M7269,-15486.98C7269,-15486.98 7269,-15424.36 7269,-15424.36"/>
<polygon fill="black" stroke="black" points="7272.5,-15424.36 7269,-15414.36 7265.5,-15424.36 7272.5,-15424.36"/>
</g>
<!-- qkv_proj_1_12 -->
<g id="node1202" class="node">
<title>qkv_proj_1_12</title>
<polygon fill="none" stroke="black" points="7351.5,-15287 7186.5,-15287 7186.5,-15234 7351.5,-15234 7351.5,-15287"/>
<text text-anchor="middle" x="7269" y="-15271.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7269" y="-15256.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="7269" y="-15241.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_0_12&#45;&gt;qkv_proj_1_12 -->
<g id="edge1189" class="edge">
<title>ffn_residual_0_12&#45;&gt;qkv_proj_1_12</title>
<path fill="none" stroke="black" d="M7269,-15359.86C7269,-15359.86 7269,-15297.16 7269,-15297.16"/>
<polygon fill="black" stroke="black" points="7272.5,-15297.16 7269,-15287.16 7265.5,-15297.16 7272.5,-15297.16"/>
</g>
<!-- qkv_reshape_1_12 -->
<g id="node1203" class="node">
<title>qkv_reshape_1_12</title>
<ellipse fill="none" stroke="black" cx="7269" cy="-15134" rx="148" ry="27"/>
<text text-anchor="middle" x="7269" y="-15137.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="7269" y="-15122.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_1_12&#45;&gt;qkv_reshape_1_12 -->
<g id="edge1190" class="edge">
<title>qkv_proj_1_12&#45;&gt;qkv_reshape_1_12</title>
<path fill="none" stroke="black" d="M7269,-15233.98C7269,-15233.98 7269,-15171.36 7269,-15171.36"/>
<polygon fill="black" stroke="black" points="7272.5,-15171.36 7269,-15161.36 7265.5,-15171.36 7272.5,-15171.36"/>
</g>
<!-- qkv_reshape_1_12&#45;&gt;ring_attn_1_12_stage_0 -->
<g id="edge1191" class="edge">
<title>qkv_reshape_1_12&#45;&gt;ring_attn_1_12_stage_0</title>
<path fill="none" stroke="black" d="M7269,-15106.72C7269,-15106.72 7269,-15000.16 7269,-15000.16"/>
<polygon fill="black" stroke="black" points="7272.5,-15000.16 7269,-14990.16 7265.5,-15000.16 7272.5,-15000.16"/>
</g>
<!-- ring_attn_1_12_stage_0&#45;&gt;ring_attn_1_12_stage_1 -->
<g id="edge1192" class="edge">
<title>ring_attn_1_12_stage_0&#45;&gt;ring_attn_1_12_stage_1</title>
<path fill="none" stroke="black" d="M7269,-14853.87C7269,-14853.87 7269,-14747.25 7269,-14747.25"/>
<polygon fill="black" stroke="black" points="7272.5,-14747.25 7269,-14737.25 7265.5,-14747.25 7272.5,-14747.25"/>
</g>
<!-- ring_attn_1_13_stage_0 -->
<g id="node1302" class="node">
<title>ring_attn_1_13_stage_0</title>
<polygon fill="yellow" stroke="black" points="7856,-14990 7647,-14922 7856,-14854 8065,-14922 7856,-14990"/>
<text text-anchor="middle" x="7856" y="-14940.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-14925.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="7856" y="-14910.8" font-family="Times,serif" font-size="14.00">Q[13]×K[13]×V[13]</text>
<text text-anchor="middle" x="7856" y="-14895.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_12_stage_0&#45;&gt;ring_attn_1_13_stage_0 -->
<g id="edge2337" class="edge">
<title>ring_attn_1_12_stage_0&#45;&gt;ring_attn_1_13_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-14922C7478.02,-14922 7636.86,-14922 7636.86,-14922"/>
<polygon fill="red" stroke="red" points="7636.86,-14925.5 7646.86,-14922 7636.86,-14918.5 7636.86,-14925.5"/>
</g>
<!-- ring_attn_1_12_stage_1&#45;&gt;ring_attn_1_12_stage_2 -->
<g id="edge1193" class="edge">
<title>ring_attn_1_12_stage_1&#45;&gt;ring_attn_1_12_stage_2</title>
<path fill="none" stroke="black" d="M7269,-14600.87C7269,-14600.87 7269,-14494.25 7269,-14494.25"/>
<polygon fill="black" stroke="black" points="7272.5,-14494.25 7269,-14484.25 7265.5,-14494.25 7272.5,-14494.25"/>
</g>
<!-- ring_attn_1_13_stage_1 -->
<g id="node1303" class="node">
<title>ring_attn_1_13_stage_1</title>
<polygon fill="yellow" stroke="black" points="7856,-14737 7647,-14669 7856,-14601 8065,-14669 7856,-14737"/>
<text text-anchor="middle" x="7856" y="-14687.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-14672.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="7856" y="-14657.8" font-family="Times,serif" font-size="14.00">Q[13]×K[12]×V[12]</text>
<text text-anchor="middle" x="7856" y="-14642.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_12_stage_1&#45;&gt;ring_attn_1_13_stage_1 -->
<g id="edge2338" class="edge">
<title>ring_attn_1_12_stage_1&#45;&gt;ring_attn_1_13_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-14669C7478.02,-14669 7636.86,-14669 7636.86,-14669"/>
<polygon fill="red" stroke="red" points="7636.86,-14672.5 7646.86,-14669 7636.86,-14665.5 7636.86,-14672.5"/>
</g>
<!-- ring_attn_1_12_stage_2&#45;&gt;ring_attn_1_12_stage_3 -->
<g id="edge1194" class="edge">
<title>ring_attn_1_12_stage_2&#45;&gt;ring_attn_1_12_stage_3</title>
<path fill="none" stroke="black" d="M7269,-14347.87C7269,-14347.87 7269,-14241.25 7269,-14241.25"/>
<polygon fill="black" stroke="black" points="7272.5,-14241.25 7269,-14231.25 7265.5,-14241.25 7272.5,-14241.25"/>
</g>
<!-- ring_attn_1_13_stage_2 -->
<g id="node1304" class="node">
<title>ring_attn_1_13_stage_2</title>
<polygon fill="yellow" stroke="black" points="7856,-14484 7647,-14416 7856,-14348 8065,-14416 7856,-14484"/>
<text text-anchor="middle" x="7856" y="-14434.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-14419.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="7856" y="-14404.8" font-family="Times,serif" font-size="14.00">Q[13]×K[11]×V[11]</text>
<text text-anchor="middle" x="7856" y="-14389.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_12_stage_2&#45;&gt;ring_attn_1_13_stage_2 -->
<g id="edge2339" class="edge">
<title>ring_attn_1_12_stage_2&#45;&gt;ring_attn_1_13_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-14416C7478.02,-14416 7636.86,-14416 7636.86,-14416"/>
<polygon fill="red" stroke="red" points="7636.86,-14419.5 7646.86,-14416 7636.86,-14412.5 7636.86,-14419.5"/>
</g>
<!-- ring_attn_1_12_stage_3&#45;&gt;ring_attn_1_12_stage_4 -->
<g id="edge1195" class="edge">
<title>ring_attn_1_12_stage_3&#45;&gt;ring_attn_1_12_stage_4</title>
<path fill="none" stroke="black" d="M7269,-14094.87C7269,-14094.87 7269,-13988.25 7269,-13988.25"/>
<polygon fill="black" stroke="black" points="7272.5,-13988.25 7269,-13978.25 7265.5,-13988.25 7272.5,-13988.25"/>
</g>
<!-- ring_attn_1_13_stage_3 -->
<g id="node1305" class="node">
<title>ring_attn_1_13_stage_3</title>
<polygon fill="yellow" stroke="black" points="7856,-14231 7647,-14163 7856,-14095 8065,-14163 7856,-14231"/>
<text text-anchor="middle" x="7856" y="-14181.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-14166.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="7856" y="-14151.8" font-family="Times,serif" font-size="14.00">Q[13]×K[10]×V[10]</text>
<text text-anchor="middle" x="7856" y="-14136.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_12_stage_3&#45;&gt;ring_attn_1_13_stage_3 -->
<g id="edge2340" class="edge">
<title>ring_attn_1_12_stage_3&#45;&gt;ring_attn_1_13_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-14163C7478.02,-14163 7636.86,-14163 7636.86,-14163"/>
<polygon fill="red" stroke="red" points="7636.86,-14166.5 7646.86,-14163 7636.86,-14159.5 7636.86,-14166.5"/>
</g>
<!-- ring_attn_1_12_stage_4&#45;&gt;ring_attn_1_12_stage_5 -->
<g id="edge1196" class="edge">
<title>ring_attn_1_12_stage_4&#45;&gt;ring_attn_1_12_stage_5</title>
<path fill="none" stroke="black" d="M7269,-13841.87C7269,-13841.87 7269,-13735.25 7269,-13735.25"/>
<polygon fill="black" stroke="black" points="7272.5,-13735.25 7269,-13725.25 7265.5,-13735.25 7272.5,-13735.25"/>
</g>
<!-- ring_attn_1_13_stage_4 -->
<g id="node1306" class="node">
<title>ring_attn_1_13_stage_4</title>
<polygon fill="yellow" stroke="black" points="7856,-13978 7647,-13910 7856,-13842 8065,-13910 7856,-13978"/>
<text text-anchor="middle" x="7856" y="-13928.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-13913.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="7856" y="-13898.8" font-family="Times,serif" font-size="14.00">Q[13]×K[9]×V[9]</text>
<text text-anchor="middle" x="7856" y="-13883.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_12_stage_4&#45;&gt;ring_attn_1_13_stage_4 -->
<g id="edge2341" class="edge">
<title>ring_attn_1_12_stage_4&#45;&gt;ring_attn_1_13_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-13910C7478.02,-13910 7636.86,-13910 7636.86,-13910"/>
<polygon fill="red" stroke="red" points="7636.86,-13913.5 7646.86,-13910 7636.86,-13906.5 7636.86,-13913.5"/>
</g>
<!-- ring_attn_1_12_stage_5&#45;&gt;ring_attn_1_12_stage_6 -->
<g id="edge1197" class="edge">
<title>ring_attn_1_12_stage_5&#45;&gt;ring_attn_1_12_stage_6</title>
<path fill="none" stroke="black" d="M7269,-13588.87C7269,-13588.87 7269,-13482.25 7269,-13482.25"/>
<polygon fill="black" stroke="black" points="7272.5,-13482.25 7269,-13472.25 7265.5,-13482.25 7272.5,-13482.25"/>
</g>
<!-- ring_attn_1_13_stage_5 -->
<g id="node1307" class="node">
<title>ring_attn_1_13_stage_5</title>
<polygon fill="yellow" stroke="black" points="7856,-13725 7647,-13657 7856,-13589 8065,-13657 7856,-13725"/>
<text text-anchor="middle" x="7856" y="-13675.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-13660.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="7856" y="-13645.8" font-family="Times,serif" font-size="14.00">Q[13]×K[8]×V[8]</text>
<text text-anchor="middle" x="7856" y="-13630.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_12_stage_5&#45;&gt;ring_attn_1_13_stage_5 -->
<g id="edge2342" class="edge">
<title>ring_attn_1_12_stage_5&#45;&gt;ring_attn_1_13_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-13657C7478.02,-13657 7636.86,-13657 7636.86,-13657"/>
<polygon fill="red" stroke="red" points="7636.86,-13660.5 7646.86,-13657 7636.86,-13653.5 7636.86,-13660.5"/>
</g>
<!-- ring_attn_1_12_stage_6&#45;&gt;ring_attn_1_12_stage_7 -->
<g id="edge1198" class="edge">
<title>ring_attn_1_12_stage_6&#45;&gt;ring_attn_1_12_stage_7</title>
<path fill="none" stroke="black" d="M7269,-13335.87C7269,-13335.87 7269,-13229.25 7269,-13229.25"/>
<polygon fill="black" stroke="black" points="7272.5,-13229.25 7269,-13219.25 7265.5,-13229.25 7272.5,-13229.25"/>
</g>
<!-- ring_attn_1_13_stage_6 -->
<g id="node1308" class="node">
<title>ring_attn_1_13_stage_6</title>
<polygon fill="yellow" stroke="black" points="7856,-13472 7647,-13404 7856,-13336 8065,-13404 7856,-13472"/>
<text text-anchor="middle" x="7856" y="-13422.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-13407.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="7856" y="-13392.8" font-family="Times,serif" font-size="14.00">Q[13]×K[7]×V[7]</text>
<text text-anchor="middle" x="7856" y="-13377.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_12_stage_6&#45;&gt;ring_attn_1_13_stage_6 -->
<g id="edge2343" class="edge">
<title>ring_attn_1_12_stage_6&#45;&gt;ring_attn_1_13_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-13404C7478.02,-13404 7636.86,-13404 7636.86,-13404"/>
<polygon fill="red" stroke="red" points="7636.86,-13407.5 7646.86,-13404 7636.86,-13400.5 7636.86,-13407.5"/>
</g>
<!-- ring_attn_1_12_stage_7&#45;&gt;ring_attn_1_12_stage_8 -->
<g id="edge1199" class="edge">
<title>ring_attn_1_12_stage_7&#45;&gt;ring_attn_1_12_stage_8</title>
<path fill="none" stroke="black" d="M7269,-13082.87C7269,-13082.87 7269,-12976.25 7269,-12976.25"/>
<polygon fill="black" stroke="black" points="7272.5,-12976.25 7269,-12966.25 7265.5,-12976.25 7272.5,-12976.25"/>
</g>
<!-- ring_attn_1_13_stage_7 -->
<g id="node1309" class="node">
<title>ring_attn_1_13_stage_7</title>
<polygon fill="yellow" stroke="black" points="7856,-13219 7647,-13151 7856,-13083 8065,-13151 7856,-13219"/>
<text text-anchor="middle" x="7856" y="-13169.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-13154.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="7856" y="-13139.8" font-family="Times,serif" font-size="14.00">Q[13]×K[6]×V[6]</text>
<text text-anchor="middle" x="7856" y="-13124.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_12_stage_7&#45;&gt;ring_attn_1_13_stage_7 -->
<g id="edge2344" class="edge">
<title>ring_attn_1_12_stage_7&#45;&gt;ring_attn_1_13_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-13151C7478.02,-13151 7636.86,-13151 7636.86,-13151"/>
<polygon fill="red" stroke="red" points="7636.86,-13154.5 7646.86,-13151 7636.86,-13147.5 7636.86,-13154.5"/>
</g>
<!-- ring_attn_1_12_stage_8&#45;&gt;ring_attn_1_12_stage_9 -->
<g id="edge1200" class="edge">
<title>ring_attn_1_12_stage_8&#45;&gt;ring_attn_1_12_stage_9</title>
<path fill="none" stroke="black" d="M7269,-12829.87C7269,-12829.87 7269,-12723.25 7269,-12723.25"/>
<polygon fill="black" stroke="black" points="7272.5,-12723.25 7269,-12713.25 7265.5,-12723.25 7272.5,-12723.25"/>
</g>
<!-- ring_attn_1_13_stage_8 -->
<g id="node1310" class="node">
<title>ring_attn_1_13_stage_8</title>
<polygon fill="yellow" stroke="black" points="7856,-12966 7647,-12898 7856,-12830 8065,-12898 7856,-12966"/>
<text text-anchor="middle" x="7856" y="-12916.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-12901.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="7856" y="-12886.8" font-family="Times,serif" font-size="14.00">Q[13]×K[5]×V[5]</text>
<text text-anchor="middle" x="7856" y="-12871.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_12_stage_8&#45;&gt;ring_attn_1_13_stage_8 -->
<g id="edge2345" class="edge">
<title>ring_attn_1_12_stage_8&#45;&gt;ring_attn_1_13_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-12898C7478.02,-12898 7636.86,-12898 7636.86,-12898"/>
<polygon fill="red" stroke="red" points="7636.86,-12901.5 7646.86,-12898 7636.86,-12894.5 7636.86,-12901.5"/>
</g>
<!-- ring_attn_1_12_stage_9&#45;&gt;ring_attn_1_12_stage_10 -->
<g id="edge1201" class="edge">
<title>ring_attn_1_12_stage_9&#45;&gt;ring_attn_1_12_stage_10</title>
<path fill="none" stroke="black" d="M7269,-12576.87C7269,-12576.87 7269,-12470.25 7269,-12470.25"/>
<polygon fill="black" stroke="black" points="7272.5,-12470.25 7269,-12460.25 7265.5,-12470.25 7272.5,-12470.25"/>
</g>
<!-- ring_attn_1_13_stage_9 -->
<g id="node1311" class="node">
<title>ring_attn_1_13_stage_9</title>
<polygon fill="yellow" stroke="black" points="7856,-12713 7647,-12645 7856,-12577 8065,-12645 7856,-12713"/>
<text text-anchor="middle" x="7856" y="-12663.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-12648.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="7856" y="-12633.8" font-family="Times,serif" font-size="14.00">Q[13]×K[4]×V[4]</text>
<text text-anchor="middle" x="7856" y="-12618.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_12_stage_9&#45;&gt;ring_attn_1_13_stage_9 -->
<g id="edge2346" class="edge">
<title>ring_attn_1_12_stage_9&#45;&gt;ring_attn_1_13_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-12645C7478.02,-12645 7636.86,-12645 7636.86,-12645"/>
<polygon fill="red" stroke="red" points="7636.86,-12648.5 7646.86,-12645 7636.86,-12641.5 7636.86,-12648.5"/>
</g>
<!-- ring_attn_1_12_stage_10&#45;&gt;ring_attn_1_12_stage_11 -->
<g id="edge1202" class="edge">
<title>ring_attn_1_12_stage_10&#45;&gt;ring_attn_1_12_stage_11</title>
<path fill="none" stroke="black" d="M7269,-12323.87C7269,-12323.87 7269,-12217.25 7269,-12217.25"/>
<polygon fill="black" stroke="black" points="7272.5,-12217.25 7269,-12207.25 7265.5,-12217.25 7272.5,-12217.25"/>
</g>
<!-- ring_attn_1_13_stage_10 -->
<g id="node1312" class="node">
<title>ring_attn_1_13_stage_10</title>
<polygon fill="yellow" stroke="black" points="7856,-12460 7647,-12392 7856,-12324 8065,-12392 7856,-12460"/>
<text text-anchor="middle" x="7856" y="-12410.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-12395.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="7856" y="-12380.8" font-family="Times,serif" font-size="14.00">Q[13]×K[3]×V[3]</text>
<text text-anchor="middle" x="7856" y="-12365.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_12_stage_10&#45;&gt;ring_attn_1_13_stage_10 -->
<g id="edge2347" class="edge">
<title>ring_attn_1_12_stage_10&#45;&gt;ring_attn_1_13_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-12392C7478.02,-12392 7636.86,-12392 7636.86,-12392"/>
<polygon fill="red" stroke="red" points="7636.86,-12395.5 7646.86,-12392 7636.86,-12388.5 7636.86,-12395.5"/>
</g>
<!-- ring_attn_1_12_stage_11&#45;&gt;ring_attn_1_12_stage_12 -->
<g id="edge1203" class="edge">
<title>ring_attn_1_12_stage_11&#45;&gt;ring_attn_1_12_stage_12</title>
<path fill="none" stroke="black" d="M7269,-12070.87C7269,-12070.87 7269,-11964.25 7269,-11964.25"/>
<polygon fill="black" stroke="black" points="7272.5,-11964.25 7269,-11954.25 7265.5,-11964.25 7272.5,-11964.25"/>
</g>
<!-- ring_attn_1_13_stage_11 -->
<g id="node1313" class="node">
<title>ring_attn_1_13_stage_11</title>
<polygon fill="yellow" stroke="black" points="7856,-12207 7647,-12139 7856,-12071 8065,-12139 7856,-12207"/>
<text text-anchor="middle" x="7856" y="-12157.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-12142.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="7856" y="-12127.8" font-family="Times,serif" font-size="14.00">Q[13]×K[2]×V[2]</text>
<text text-anchor="middle" x="7856" y="-12112.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_12_stage_11&#45;&gt;ring_attn_1_13_stage_11 -->
<g id="edge2348" class="edge">
<title>ring_attn_1_12_stage_11&#45;&gt;ring_attn_1_13_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-12139C7478.02,-12139 7636.86,-12139 7636.86,-12139"/>
<polygon fill="red" stroke="red" points="7636.86,-12142.5 7646.86,-12139 7636.86,-12135.5 7636.86,-12142.5"/>
</g>
<!-- ring_attn_1_12_stage_12&#45;&gt;ring_attn_1_12_stage_13 -->
<g id="edge1204" class="edge">
<title>ring_attn_1_12_stage_12&#45;&gt;ring_attn_1_12_stage_13</title>
<path fill="none" stroke="black" d="M7269,-11817.87C7269,-11817.87 7269,-11711.25 7269,-11711.25"/>
<polygon fill="black" stroke="black" points="7272.5,-11711.25 7269,-11701.25 7265.5,-11711.25 7272.5,-11711.25"/>
</g>
<!-- ring_attn_1_13_stage_12 -->
<g id="node1314" class="node">
<title>ring_attn_1_13_stage_12</title>
<polygon fill="yellow" stroke="black" points="7856,-11954 7647,-11886 7856,-11818 8065,-11886 7856,-11954"/>
<text text-anchor="middle" x="7856" y="-11904.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-11889.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="7856" y="-11874.8" font-family="Times,serif" font-size="14.00">Q[13]×K[1]×V[1]</text>
<text text-anchor="middle" x="7856" y="-11859.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_12_stage_12&#45;&gt;ring_attn_1_13_stage_12 -->
<g id="edge2349" class="edge">
<title>ring_attn_1_12_stage_12&#45;&gt;ring_attn_1_13_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-11886C7478.02,-11886 7636.86,-11886 7636.86,-11886"/>
<polygon fill="red" stroke="red" points="7636.86,-11889.5 7646.86,-11886 7636.86,-11882.5 7636.86,-11889.5"/>
</g>
<!-- ring_attn_1_12_stage_13&#45;&gt;ring_attn_1_12_stage_14 -->
<g id="edge1205" class="edge">
<title>ring_attn_1_12_stage_13&#45;&gt;ring_attn_1_12_stage_14</title>
<path fill="none" stroke="black" d="M7269,-11564.87C7269,-11564.87 7269,-11458.25 7269,-11458.25"/>
<polygon fill="black" stroke="black" points="7272.5,-11458.25 7269,-11448.25 7265.5,-11458.25 7272.5,-11458.25"/>
</g>
<!-- ring_attn_1_13_stage_13 -->
<g id="node1315" class="node">
<title>ring_attn_1_13_stage_13</title>
<polygon fill="yellow" stroke="black" points="7856,-11701 7647,-11633 7856,-11565 8065,-11633 7856,-11701"/>
<text text-anchor="middle" x="7856" y="-11651.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-11636.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="7856" y="-11621.8" font-family="Times,serif" font-size="14.00">Q[13]×K[0]×V[0]</text>
<text text-anchor="middle" x="7856" y="-11606.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_12_stage_13&#45;&gt;ring_attn_1_13_stage_13 -->
<g id="edge2350" class="edge">
<title>ring_attn_1_12_stage_13&#45;&gt;ring_attn_1_13_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-11633C7478.02,-11633 7636.86,-11633 7636.86,-11633"/>
<polygon fill="red" stroke="red" points="7636.86,-11636.5 7646.86,-11633 7636.86,-11629.5 7636.86,-11636.5"/>
</g>
<!-- ring_attn_1_12_stage_14&#45;&gt;ring_attn_1_12_stage_15 -->
<g id="edge1206" class="edge">
<title>ring_attn_1_12_stage_14&#45;&gt;ring_attn_1_12_stage_15</title>
<path fill="none" stroke="black" d="M7269,-11311.87C7269,-11311.87 7269,-11205.25 7269,-11205.25"/>
<polygon fill="black" stroke="black" points="7272.5,-11205.25 7269,-11195.25 7265.5,-11205.25 7272.5,-11205.25"/>
</g>
<!-- ring_attn_1_13_stage_14 -->
<g id="node1316" class="node">
<title>ring_attn_1_13_stage_14</title>
<polygon fill="yellow" stroke="black" points="7856,-11448 7647,-11380 7856,-11312 8065,-11380 7856,-11448"/>
<text text-anchor="middle" x="7856" y="-11398.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-11383.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="7856" y="-11368.8" font-family="Times,serif" font-size="14.00">Q[13]×K[15]×V[15]</text>
<text text-anchor="middle" x="7856" y="-11353.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_12_stage_14&#45;&gt;ring_attn_1_13_stage_14 -->
<g id="edge2351" class="edge">
<title>ring_attn_1_12_stage_14&#45;&gt;ring_attn_1_13_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-11380C7478.02,-11380 7636.86,-11380 7636.86,-11380"/>
<polygon fill="red" stroke="red" points="7636.86,-11383.5 7646.86,-11380 7636.86,-11376.5 7636.86,-11383.5"/>
</g>
<!-- attn_out_1_12 -->
<g id="node1220" class="node">
<title>attn_out_1_12</title>
<polygon fill="none" stroke="black" points="7338.5,-10986 7199.5,-10986 7199.5,-10933 7338.5,-10933 7338.5,-10986"/>
<text text-anchor="middle" x="7269" y="-10970.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="7269" y="-10955.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="7269" y="-10940.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_1_12_stage_15&#45;&gt;attn_out_1_12 -->
<g id="edge1207" class="edge">
<title>ring_attn_1_12_stage_15&#45;&gt;attn_out_1_12</title>
<path fill="none" stroke="black" d="M7269,-11058.87C7269,-11058.87 7269,-10996.18 7269,-10996.18"/>
<polygon fill="black" stroke="black" points="7272.5,-10996.18 7269,-10986.18 7265.5,-10996.18 7272.5,-10996.18"/>
</g>
<!-- ring_attn_1_13_stage_15 -->
<g id="node1317" class="node">
<title>ring_attn_1_13_stage_15</title>
<polygon fill="yellow" stroke="black" points="7856,-11195 7647,-11127 7856,-11059 8065,-11127 7856,-11195"/>
<text text-anchor="middle" x="7856" y="-11145.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-11130.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="7856" y="-11115.8" font-family="Times,serif" font-size="14.00">Q[13]×K[14]×V[14]</text>
<text text-anchor="middle" x="7856" y="-11100.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_12_stage_15&#45;&gt;ring_attn_1_13_stage_15 -->
<g id="edge2352" class="edge">
<title>ring_attn_1_12_stage_15&#45;&gt;ring_attn_1_13_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-11127C7478.02,-11127 7636.86,-11127 7636.86,-11127"/>
<polygon fill="red" stroke="red" points="7636.86,-11130.5 7646.86,-11127 7636.86,-11123.5 7636.86,-11130.5"/>
</g>
<!-- attn_residual_1_12 -->
<g id="node1221" class="node">
<title>attn_residual_1_12</title>
<ellipse fill="none" stroke="black" cx="7269" cy="-10833" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7269" y="-10836.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="7269" y="-10821.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_1_12&#45;&gt;attn_residual_1_12 -->
<g id="edge1208" class="edge">
<title>attn_out_1_12&#45;&gt;attn_residual_1_12</title>
<path fill="none" stroke="black" d="M7269,-10932.98C7269,-10932.98 7269,-10870.36 7269,-10870.36"/>
<polygon fill="black" stroke="black" points="7272.5,-10870.36 7269,-10860.36 7265.5,-10870.36 7272.5,-10870.36"/>
</g>
<!-- ffn_up_1_12 -->
<g id="node1222" class="node">
<title>ffn_up_1_12</title>
<polygon fill="none" stroke="black" points="7348,-10733 7190,-10733 7190,-10680 7348,-10680 7348,-10733"/>
<text text-anchor="middle" x="7269" y="-10717.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7269" y="-10702.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="7269" y="-10687.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_1_12&#45;&gt;ffn_up_1_12 -->
<g id="edge1209" class="edge">
<title>attn_residual_1_12&#45;&gt;ffn_up_1_12</title>
<path fill="none" stroke="black" d="M7269,-10805.86C7269,-10805.86 7269,-10743.16 7269,-10743.16"/>
<polygon fill="black" stroke="black" points="7272.5,-10743.16 7269,-10733.16 7265.5,-10743.16 7272.5,-10743.16"/>
</g>
<!-- ffn_gelu_1_12 -->
<g id="node1223" class="node">
<title>ffn_gelu_1_12</title>
<ellipse fill="none" stroke="black" cx="7269" cy="-10580" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7269" y="-10583.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7269" y="-10568.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_1_12&#45;&gt;ffn_gelu_1_12 -->
<g id="edge1210" class="edge">
<title>ffn_up_1_12&#45;&gt;ffn_gelu_1_12</title>
<path fill="none" stroke="black" d="M7269,-10679.98C7269,-10679.98 7269,-10617.36 7269,-10617.36"/>
<polygon fill="black" stroke="black" points="7272.5,-10617.36 7269,-10607.36 7265.5,-10617.36 7272.5,-10617.36"/>
</g>
<!-- ffn_down_1_12 -->
<g id="node1224" class="node">
<title>ffn_down_1_12</title>
<polygon fill="none" stroke="black" points="7358,-10480 7180,-10480 7180,-10427 7358,-10427 7358,-10480"/>
<text text-anchor="middle" x="7269" y="-10464.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7269" y="-10449.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="7269" y="-10434.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_1_12&#45;&gt;ffn_down_1_12 -->
<g id="edge1211" class="edge">
<title>ffn_gelu_1_12&#45;&gt;ffn_down_1_12</title>
<path fill="none" stroke="black" d="M7269,-10552.86C7269,-10552.86 7269,-10490.16 7269,-10490.16"/>
<polygon fill="black" stroke="black" points="7272.5,-10490.16 7269,-10480.16 7265.5,-10490.16 7272.5,-10490.16"/>
</g>
<!-- ffn_residual_1_12 -->
<g id="node1225" class="node">
<title>ffn_residual_1_12</title>
<ellipse fill="none" stroke="black" cx="7269" cy="-10327" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7269" y="-10330.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="7269" y="-10315.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_1_12&#45;&gt;ffn_residual_1_12 -->
<g id="edge1212" class="edge">
<title>ffn_down_1_12&#45;&gt;ffn_residual_1_12</title>
<path fill="none" stroke="black" d="M7269,-10426.98C7269,-10426.98 7269,-10364.36 7269,-10364.36"/>
<polygon fill="black" stroke="black" points="7272.5,-10364.36 7269,-10354.36 7265.5,-10364.36 7272.5,-10364.36"/>
</g>
<!-- qkv_proj_2_12 -->
<g id="node1226" class="node">
<title>qkv_proj_2_12</title>
<polygon fill="none" stroke="black" points="7351.5,-10227 7186.5,-10227 7186.5,-10174 7351.5,-10174 7351.5,-10227"/>
<text text-anchor="middle" x="7269" y="-10211.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7269" y="-10196.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="7269" y="-10181.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_1_12&#45;&gt;qkv_proj_2_12 -->
<g id="edge1213" class="edge">
<title>ffn_residual_1_12&#45;&gt;qkv_proj_2_12</title>
<path fill="none" stroke="black" d="M7269,-10299.86C7269,-10299.86 7269,-10237.16 7269,-10237.16"/>
<polygon fill="black" stroke="black" points="7272.5,-10237.16 7269,-10227.16 7265.5,-10237.16 7272.5,-10237.16"/>
</g>
<!-- qkv_reshape_2_12 -->
<g id="node1227" class="node">
<title>qkv_reshape_2_12</title>
<ellipse fill="none" stroke="black" cx="7269" cy="-10074" rx="148" ry="27"/>
<text text-anchor="middle" x="7269" y="-10077.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="7269" y="-10062.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_2_12&#45;&gt;qkv_reshape_2_12 -->
<g id="edge1214" class="edge">
<title>qkv_proj_2_12&#45;&gt;qkv_reshape_2_12</title>
<path fill="none" stroke="black" d="M7269,-10173.98C7269,-10173.98 7269,-10111.36 7269,-10111.36"/>
<polygon fill="black" stroke="black" points="7272.5,-10111.36 7269,-10101.36 7265.5,-10111.36 7272.5,-10111.36"/>
</g>
<!-- qkv_reshape_2_12&#45;&gt;ring_attn_2_12_stage_0 -->
<g id="edge1215" class="edge">
<title>qkv_reshape_2_12&#45;&gt;ring_attn_2_12_stage_0</title>
<path fill="none" stroke="black" d="M7269,-10046.72C7269,-10046.72 7269,-9940.16 7269,-9940.16"/>
<polygon fill="black" stroke="black" points="7272.5,-9940.16 7269,-9930.16 7265.5,-9940.16 7272.5,-9940.16"/>
</g>
<!-- ring_attn_2_12_stage_0&#45;&gt;ring_attn_2_12_stage_1 -->
<g id="edge1216" class="edge">
<title>ring_attn_2_12_stage_0&#45;&gt;ring_attn_2_12_stage_1</title>
<path fill="none" stroke="black" d="M7269,-9793.87C7269,-9793.87 7269,-9687.25 7269,-9687.25"/>
<polygon fill="black" stroke="black" points="7272.5,-9687.25 7269,-9677.25 7265.5,-9687.25 7272.5,-9687.25"/>
</g>
<!-- ring_attn_2_13_stage_0 -->
<g id="node1326" class="node">
<title>ring_attn_2_13_stage_0</title>
<polygon fill="yellow" stroke="black" points="7856,-9930 7647,-9862 7856,-9794 8065,-9862 7856,-9930"/>
<text text-anchor="middle" x="7856" y="-9880.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-9865.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="7856" y="-9850.8" font-family="Times,serif" font-size="14.00">Q[13]×K[13]×V[13]</text>
<text text-anchor="middle" x="7856" y="-9835.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_12_stage_0&#45;&gt;ring_attn_2_13_stage_0 -->
<g id="edge2353" class="edge">
<title>ring_attn_2_12_stage_0&#45;&gt;ring_attn_2_13_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-9862C7478.02,-9862 7636.86,-9862 7636.86,-9862"/>
<polygon fill="red" stroke="red" points="7636.86,-9865.5 7646.86,-9862 7636.86,-9858.5 7636.86,-9865.5"/>
</g>
<!-- ring_attn_2_12_stage_1&#45;&gt;ring_attn_2_12_stage_2 -->
<g id="edge1217" class="edge">
<title>ring_attn_2_12_stage_1&#45;&gt;ring_attn_2_12_stage_2</title>
<path fill="none" stroke="black" d="M7269,-9540.87C7269,-9540.87 7269,-9434.25 7269,-9434.25"/>
<polygon fill="black" stroke="black" points="7272.5,-9434.25 7269,-9424.25 7265.5,-9434.25 7272.5,-9434.25"/>
</g>
<!-- ring_attn_2_13_stage_1 -->
<g id="node1327" class="node">
<title>ring_attn_2_13_stage_1</title>
<polygon fill="yellow" stroke="black" points="7856,-9677 7647,-9609 7856,-9541 8065,-9609 7856,-9677"/>
<text text-anchor="middle" x="7856" y="-9627.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-9612.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="7856" y="-9597.8" font-family="Times,serif" font-size="14.00">Q[13]×K[12]×V[12]</text>
<text text-anchor="middle" x="7856" y="-9582.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_12_stage_1&#45;&gt;ring_attn_2_13_stage_1 -->
<g id="edge2354" class="edge">
<title>ring_attn_2_12_stage_1&#45;&gt;ring_attn_2_13_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-9609C7478.02,-9609 7636.86,-9609 7636.86,-9609"/>
<polygon fill="red" stroke="red" points="7636.86,-9612.5 7646.86,-9609 7636.86,-9605.5 7636.86,-9612.5"/>
</g>
<!-- ring_attn_2_12_stage_2&#45;&gt;ring_attn_2_12_stage_3 -->
<g id="edge1218" class="edge">
<title>ring_attn_2_12_stage_2&#45;&gt;ring_attn_2_12_stage_3</title>
<path fill="none" stroke="black" d="M7269,-9287.87C7269,-9287.87 7269,-9181.25 7269,-9181.25"/>
<polygon fill="black" stroke="black" points="7272.5,-9181.25 7269,-9171.25 7265.5,-9181.25 7272.5,-9181.25"/>
</g>
<!-- ring_attn_2_13_stage_2 -->
<g id="node1328" class="node">
<title>ring_attn_2_13_stage_2</title>
<polygon fill="yellow" stroke="black" points="7856,-9424 7647,-9356 7856,-9288 8065,-9356 7856,-9424"/>
<text text-anchor="middle" x="7856" y="-9374.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-9359.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="7856" y="-9344.8" font-family="Times,serif" font-size="14.00">Q[13]×K[11]×V[11]</text>
<text text-anchor="middle" x="7856" y="-9329.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_12_stage_2&#45;&gt;ring_attn_2_13_stage_2 -->
<g id="edge2355" class="edge">
<title>ring_attn_2_12_stage_2&#45;&gt;ring_attn_2_13_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-9356C7478.02,-9356 7636.86,-9356 7636.86,-9356"/>
<polygon fill="red" stroke="red" points="7636.86,-9359.5 7646.86,-9356 7636.86,-9352.5 7636.86,-9359.5"/>
</g>
<!-- ring_attn_2_12_stage_3&#45;&gt;ring_attn_2_12_stage_4 -->
<g id="edge1219" class="edge">
<title>ring_attn_2_12_stage_3&#45;&gt;ring_attn_2_12_stage_4</title>
<path fill="none" stroke="black" d="M7269,-9034.87C7269,-9034.87 7269,-8928.25 7269,-8928.25"/>
<polygon fill="black" stroke="black" points="7272.5,-8928.25 7269,-8918.25 7265.5,-8928.25 7272.5,-8928.25"/>
</g>
<!-- ring_attn_2_13_stage_3 -->
<g id="node1329" class="node">
<title>ring_attn_2_13_stage_3</title>
<polygon fill="yellow" stroke="black" points="7856,-9171 7647,-9103 7856,-9035 8065,-9103 7856,-9171"/>
<text text-anchor="middle" x="7856" y="-9121.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-9106.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="7856" y="-9091.8" font-family="Times,serif" font-size="14.00">Q[13]×K[10]×V[10]</text>
<text text-anchor="middle" x="7856" y="-9076.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_12_stage_3&#45;&gt;ring_attn_2_13_stage_3 -->
<g id="edge2356" class="edge">
<title>ring_attn_2_12_stage_3&#45;&gt;ring_attn_2_13_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-9103C7478.02,-9103 7636.86,-9103 7636.86,-9103"/>
<polygon fill="red" stroke="red" points="7636.86,-9106.5 7646.86,-9103 7636.86,-9099.5 7636.86,-9106.5"/>
</g>
<!-- ring_attn_2_12_stage_4&#45;&gt;ring_attn_2_12_stage_5 -->
<g id="edge1220" class="edge">
<title>ring_attn_2_12_stage_4&#45;&gt;ring_attn_2_12_stage_5</title>
<path fill="none" stroke="black" d="M7269,-8781.87C7269,-8781.87 7269,-8675.25 7269,-8675.25"/>
<polygon fill="black" stroke="black" points="7272.5,-8675.25 7269,-8665.25 7265.5,-8675.25 7272.5,-8675.25"/>
</g>
<!-- ring_attn_2_13_stage_4 -->
<g id="node1330" class="node">
<title>ring_attn_2_13_stage_4</title>
<polygon fill="yellow" stroke="black" points="7856,-8918 7647,-8850 7856,-8782 8065,-8850 7856,-8918"/>
<text text-anchor="middle" x="7856" y="-8868.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-8853.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="7856" y="-8838.8" font-family="Times,serif" font-size="14.00">Q[13]×K[9]×V[9]</text>
<text text-anchor="middle" x="7856" y="-8823.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_12_stage_4&#45;&gt;ring_attn_2_13_stage_4 -->
<g id="edge2357" class="edge">
<title>ring_attn_2_12_stage_4&#45;&gt;ring_attn_2_13_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-8850C7478.02,-8850 7636.86,-8850 7636.86,-8850"/>
<polygon fill="red" stroke="red" points="7636.86,-8853.5 7646.86,-8850 7636.86,-8846.5 7636.86,-8853.5"/>
</g>
<!-- ring_attn_2_12_stage_5&#45;&gt;ring_attn_2_12_stage_6 -->
<g id="edge1221" class="edge">
<title>ring_attn_2_12_stage_5&#45;&gt;ring_attn_2_12_stage_6</title>
<path fill="none" stroke="black" d="M7269,-8528.87C7269,-8528.87 7269,-8422.25 7269,-8422.25"/>
<polygon fill="black" stroke="black" points="7272.5,-8422.25 7269,-8412.25 7265.5,-8422.25 7272.5,-8422.25"/>
</g>
<!-- ring_attn_2_13_stage_5 -->
<g id="node1331" class="node">
<title>ring_attn_2_13_stage_5</title>
<polygon fill="yellow" stroke="black" points="7856,-8665 7647,-8597 7856,-8529 8065,-8597 7856,-8665"/>
<text text-anchor="middle" x="7856" y="-8615.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-8600.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="7856" y="-8585.8" font-family="Times,serif" font-size="14.00">Q[13]×K[8]×V[8]</text>
<text text-anchor="middle" x="7856" y="-8570.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_12_stage_5&#45;&gt;ring_attn_2_13_stage_5 -->
<g id="edge2358" class="edge">
<title>ring_attn_2_12_stage_5&#45;&gt;ring_attn_2_13_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-8597C7478.02,-8597 7636.86,-8597 7636.86,-8597"/>
<polygon fill="red" stroke="red" points="7636.86,-8600.5 7646.86,-8597 7636.86,-8593.5 7636.86,-8600.5"/>
</g>
<!-- ring_attn_2_12_stage_6&#45;&gt;ring_attn_2_12_stage_7 -->
<g id="edge1222" class="edge">
<title>ring_attn_2_12_stage_6&#45;&gt;ring_attn_2_12_stage_7</title>
<path fill="none" stroke="black" d="M7269,-8275.87C7269,-8275.87 7269,-8169.25 7269,-8169.25"/>
<polygon fill="black" stroke="black" points="7272.5,-8169.25 7269,-8159.25 7265.5,-8169.25 7272.5,-8169.25"/>
</g>
<!-- ring_attn_2_13_stage_6 -->
<g id="node1332" class="node">
<title>ring_attn_2_13_stage_6</title>
<polygon fill="yellow" stroke="black" points="7856,-8412 7647,-8344 7856,-8276 8065,-8344 7856,-8412"/>
<text text-anchor="middle" x="7856" y="-8362.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-8347.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="7856" y="-8332.8" font-family="Times,serif" font-size="14.00">Q[13]×K[7]×V[7]</text>
<text text-anchor="middle" x="7856" y="-8317.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_12_stage_6&#45;&gt;ring_attn_2_13_stage_6 -->
<g id="edge2359" class="edge">
<title>ring_attn_2_12_stage_6&#45;&gt;ring_attn_2_13_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-8344C7478.02,-8344 7636.86,-8344 7636.86,-8344"/>
<polygon fill="red" stroke="red" points="7636.86,-8347.5 7646.86,-8344 7636.86,-8340.5 7636.86,-8347.5"/>
</g>
<!-- ring_attn_2_12_stage_7&#45;&gt;ring_attn_2_12_stage_8 -->
<g id="edge1223" class="edge">
<title>ring_attn_2_12_stage_7&#45;&gt;ring_attn_2_12_stage_8</title>
<path fill="none" stroke="black" d="M7269,-8022.87C7269,-8022.87 7269,-7916.25 7269,-7916.25"/>
<polygon fill="black" stroke="black" points="7272.5,-7916.25 7269,-7906.25 7265.5,-7916.25 7272.5,-7916.25"/>
</g>
<!-- ring_attn_2_13_stage_7 -->
<g id="node1333" class="node">
<title>ring_attn_2_13_stage_7</title>
<polygon fill="yellow" stroke="black" points="7856,-8159 7647,-8091 7856,-8023 8065,-8091 7856,-8159"/>
<text text-anchor="middle" x="7856" y="-8109.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-8094.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="7856" y="-8079.8" font-family="Times,serif" font-size="14.00">Q[13]×K[6]×V[6]</text>
<text text-anchor="middle" x="7856" y="-8064.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_12_stage_7&#45;&gt;ring_attn_2_13_stage_7 -->
<g id="edge2360" class="edge">
<title>ring_attn_2_12_stage_7&#45;&gt;ring_attn_2_13_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-8091C7478.02,-8091 7636.86,-8091 7636.86,-8091"/>
<polygon fill="red" stroke="red" points="7636.86,-8094.5 7646.86,-8091 7636.86,-8087.5 7636.86,-8094.5"/>
</g>
<!-- ring_attn_2_12_stage_8&#45;&gt;ring_attn_2_12_stage_9 -->
<g id="edge1224" class="edge">
<title>ring_attn_2_12_stage_8&#45;&gt;ring_attn_2_12_stage_9</title>
<path fill="none" stroke="black" d="M7269,-7769.87C7269,-7769.87 7269,-7663.25 7269,-7663.25"/>
<polygon fill="black" stroke="black" points="7272.5,-7663.25 7269,-7653.25 7265.5,-7663.25 7272.5,-7663.25"/>
</g>
<!-- ring_attn_2_13_stage_8 -->
<g id="node1334" class="node">
<title>ring_attn_2_13_stage_8</title>
<polygon fill="yellow" stroke="black" points="7856,-7906 7647,-7838 7856,-7770 8065,-7838 7856,-7906"/>
<text text-anchor="middle" x="7856" y="-7856.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-7841.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="7856" y="-7826.8" font-family="Times,serif" font-size="14.00">Q[13]×K[5]×V[5]</text>
<text text-anchor="middle" x="7856" y="-7811.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_12_stage_8&#45;&gt;ring_attn_2_13_stage_8 -->
<g id="edge2361" class="edge">
<title>ring_attn_2_12_stage_8&#45;&gt;ring_attn_2_13_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-7838C7478.02,-7838 7636.86,-7838 7636.86,-7838"/>
<polygon fill="red" stroke="red" points="7636.86,-7841.5 7646.86,-7838 7636.86,-7834.5 7636.86,-7841.5"/>
</g>
<!-- ring_attn_2_12_stage_9&#45;&gt;ring_attn_2_12_stage_10 -->
<g id="edge1225" class="edge">
<title>ring_attn_2_12_stage_9&#45;&gt;ring_attn_2_12_stage_10</title>
<path fill="none" stroke="black" d="M7269,-7516.87C7269,-7516.87 7269,-7410.25 7269,-7410.25"/>
<polygon fill="black" stroke="black" points="7272.5,-7410.25 7269,-7400.25 7265.5,-7410.25 7272.5,-7410.25"/>
</g>
<!-- ring_attn_2_13_stage_9 -->
<g id="node1335" class="node">
<title>ring_attn_2_13_stage_9</title>
<polygon fill="yellow" stroke="black" points="7856,-7653 7647,-7585 7856,-7517 8065,-7585 7856,-7653"/>
<text text-anchor="middle" x="7856" y="-7603.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-7588.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="7856" y="-7573.8" font-family="Times,serif" font-size="14.00">Q[13]×K[4]×V[4]</text>
<text text-anchor="middle" x="7856" y="-7558.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_12_stage_9&#45;&gt;ring_attn_2_13_stage_9 -->
<g id="edge2362" class="edge">
<title>ring_attn_2_12_stage_9&#45;&gt;ring_attn_2_13_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-7585C7478.02,-7585 7636.86,-7585 7636.86,-7585"/>
<polygon fill="red" stroke="red" points="7636.86,-7588.5 7646.86,-7585 7636.86,-7581.5 7636.86,-7588.5"/>
</g>
<!-- ring_attn_2_12_stage_10&#45;&gt;ring_attn_2_12_stage_11 -->
<g id="edge1226" class="edge">
<title>ring_attn_2_12_stage_10&#45;&gt;ring_attn_2_12_stage_11</title>
<path fill="none" stroke="black" d="M7269,-7263.87C7269,-7263.87 7269,-7157.25 7269,-7157.25"/>
<polygon fill="black" stroke="black" points="7272.5,-7157.25 7269,-7147.25 7265.5,-7157.25 7272.5,-7157.25"/>
</g>
<!-- ring_attn_2_13_stage_10 -->
<g id="node1336" class="node">
<title>ring_attn_2_13_stage_10</title>
<polygon fill="yellow" stroke="black" points="7856,-7400 7647,-7332 7856,-7264 8065,-7332 7856,-7400"/>
<text text-anchor="middle" x="7856" y="-7350.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-7335.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="7856" y="-7320.8" font-family="Times,serif" font-size="14.00">Q[13]×K[3]×V[3]</text>
<text text-anchor="middle" x="7856" y="-7305.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_12_stage_10&#45;&gt;ring_attn_2_13_stage_10 -->
<g id="edge2363" class="edge">
<title>ring_attn_2_12_stage_10&#45;&gt;ring_attn_2_13_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-7332C7478.02,-7332 7636.86,-7332 7636.86,-7332"/>
<polygon fill="red" stroke="red" points="7636.86,-7335.5 7646.86,-7332 7636.86,-7328.5 7636.86,-7335.5"/>
</g>
<!-- ring_attn_2_12_stage_11&#45;&gt;ring_attn_2_12_stage_12 -->
<g id="edge1227" class="edge">
<title>ring_attn_2_12_stage_11&#45;&gt;ring_attn_2_12_stage_12</title>
<path fill="none" stroke="black" d="M7269,-7010.87C7269,-7010.87 7269,-6904.25 7269,-6904.25"/>
<polygon fill="black" stroke="black" points="7272.5,-6904.25 7269,-6894.25 7265.5,-6904.25 7272.5,-6904.25"/>
</g>
<!-- ring_attn_2_13_stage_11 -->
<g id="node1337" class="node">
<title>ring_attn_2_13_stage_11</title>
<polygon fill="yellow" stroke="black" points="7856,-7147 7647,-7079 7856,-7011 8065,-7079 7856,-7147"/>
<text text-anchor="middle" x="7856" y="-7097.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-7082.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="7856" y="-7067.8" font-family="Times,serif" font-size="14.00">Q[13]×K[2]×V[2]</text>
<text text-anchor="middle" x="7856" y="-7052.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_12_stage_11&#45;&gt;ring_attn_2_13_stage_11 -->
<g id="edge2364" class="edge">
<title>ring_attn_2_12_stage_11&#45;&gt;ring_attn_2_13_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-7079C7478.02,-7079 7636.86,-7079 7636.86,-7079"/>
<polygon fill="red" stroke="red" points="7636.86,-7082.5 7646.86,-7079 7636.86,-7075.5 7636.86,-7082.5"/>
</g>
<!-- ring_attn_2_12_stage_12&#45;&gt;ring_attn_2_12_stage_13 -->
<g id="edge1228" class="edge">
<title>ring_attn_2_12_stage_12&#45;&gt;ring_attn_2_12_stage_13</title>
<path fill="none" stroke="black" d="M7269,-6757.87C7269,-6757.87 7269,-6651.25 7269,-6651.25"/>
<polygon fill="black" stroke="black" points="7272.5,-6651.25 7269,-6641.25 7265.5,-6651.25 7272.5,-6651.25"/>
</g>
<!-- ring_attn_2_13_stage_12 -->
<g id="node1338" class="node">
<title>ring_attn_2_13_stage_12</title>
<polygon fill="yellow" stroke="black" points="7856,-6894 7647,-6826 7856,-6758 8065,-6826 7856,-6894"/>
<text text-anchor="middle" x="7856" y="-6844.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-6829.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="7856" y="-6814.8" font-family="Times,serif" font-size="14.00">Q[13]×K[1]×V[1]</text>
<text text-anchor="middle" x="7856" y="-6799.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_12_stage_12&#45;&gt;ring_attn_2_13_stage_12 -->
<g id="edge2365" class="edge">
<title>ring_attn_2_12_stage_12&#45;&gt;ring_attn_2_13_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-6826C7478.02,-6826 7636.86,-6826 7636.86,-6826"/>
<polygon fill="red" stroke="red" points="7636.86,-6829.5 7646.86,-6826 7636.86,-6822.5 7636.86,-6829.5"/>
</g>
<!-- ring_attn_2_12_stage_13&#45;&gt;ring_attn_2_12_stage_14 -->
<g id="edge1229" class="edge">
<title>ring_attn_2_12_stage_13&#45;&gt;ring_attn_2_12_stage_14</title>
<path fill="none" stroke="black" d="M7269,-6504.87C7269,-6504.87 7269,-6398.25 7269,-6398.25"/>
<polygon fill="black" stroke="black" points="7272.5,-6398.25 7269,-6388.25 7265.5,-6398.25 7272.5,-6398.25"/>
</g>
<!-- ring_attn_2_13_stage_13 -->
<g id="node1339" class="node">
<title>ring_attn_2_13_stage_13</title>
<polygon fill="yellow" stroke="black" points="7856,-6641 7647,-6573 7856,-6505 8065,-6573 7856,-6641"/>
<text text-anchor="middle" x="7856" y="-6591.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-6576.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="7856" y="-6561.8" font-family="Times,serif" font-size="14.00">Q[13]×K[0]×V[0]</text>
<text text-anchor="middle" x="7856" y="-6546.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_12_stage_13&#45;&gt;ring_attn_2_13_stage_13 -->
<g id="edge2366" class="edge">
<title>ring_attn_2_12_stage_13&#45;&gt;ring_attn_2_13_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-6573C7478.02,-6573 7636.86,-6573 7636.86,-6573"/>
<polygon fill="red" stroke="red" points="7636.86,-6576.5 7646.86,-6573 7636.86,-6569.5 7636.86,-6576.5"/>
</g>
<!-- ring_attn_2_12_stage_14&#45;&gt;ring_attn_2_12_stage_15 -->
<g id="edge1230" class="edge">
<title>ring_attn_2_12_stage_14&#45;&gt;ring_attn_2_12_stage_15</title>
<path fill="none" stroke="black" d="M7269,-6251.87C7269,-6251.87 7269,-6145.25 7269,-6145.25"/>
<polygon fill="black" stroke="black" points="7272.5,-6145.25 7269,-6135.25 7265.5,-6145.25 7272.5,-6145.25"/>
</g>
<!-- ring_attn_2_13_stage_14 -->
<g id="node1340" class="node">
<title>ring_attn_2_13_stage_14</title>
<polygon fill="yellow" stroke="black" points="7856,-6388 7647,-6320 7856,-6252 8065,-6320 7856,-6388"/>
<text text-anchor="middle" x="7856" y="-6338.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-6323.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="7856" y="-6308.8" font-family="Times,serif" font-size="14.00">Q[13]×K[15]×V[15]</text>
<text text-anchor="middle" x="7856" y="-6293.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_12_stage_14&#45;&gt;ring_attn_2_13_stage_14 -->
<g id="edge2367" class="edge">
<title>ring_attn_2_12_stage_14&#45;&gt;ring_attn_2_13_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-6320C7478.02,-6320 7636.86,-6320 7636.86,-6320"/>
<polygon fill="red" stroke="red" points="7636.86,-6323.5 7646.86,-6320 7636.86,-6316.5 7636.86,-6323.5"/>
</g>
<!-- attn_out_2_12 -->
<g id="node1244" class="node">
<title>attn_out_2_12</title>
<polygon fill="none" stroke="black" points="7338.5,-5926 7199.5,-5926 7199.5,-5873 7338.5,-5873 7338.5,-5926"/>
<text text-anchor="middle" x="7269" y="-5910.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="7269" y="-5895.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="7269" y="-5880.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_2_12_stage_15&#45;&gt;attn_out_2_12 -->
<g id="edge1231" class="edge">
<title>ring_attn_2_12_stage_15&#45;&gt;attn_out_2_12</title>
<path fill="none" stroke="black" d="M7269,-5998.87C7269,-5998.87 7269,-5936.18 7269,-5936.18"/>
<polygon fill="black" stroke="black" points="7272.5,-5936.18 7269,-5926.18 7265.5,-5936.18 7272.5,-5936.18"/>
</g>
<!-- ring_attn_2_13_stage_15 -->
<g id="node1341" class="node">
<title>ring_attn_2_13_stage_15</title>
<polygon fill="yellow" stroke="black" points="7856,-6135 7647,-6067 7856,-5999 8065,-6067 7856,-6135"/>
<text text-anchor="middle" x="7856" y="-6085.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-6070.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="7856" y="-6055.8" font-family="Times,serif" font-size="14.00">Q[13]×K[14]×V[14]</text>
<text text-anchor="middle" x="7856" y="-6040.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_12_stage_15&#45;&gt;ring_attn_2_13_stage_15 -->
<g id="edge2368" class="edge">
<title>ring_attn_2_12_stage_15&#45;&gt;ring_attn_2_13_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-6067C7478.02,-6067 7636.86,-6067 7636.86,-6067"/>
<polygon fill="red" stroke="red" points="7636.86,-6070.5 7646.86,-6067 7636.86,-6063.5 7636.86,-6070.5"/>
</g>
<!-- attn_residual_2_12 -->
<g id="node1245" class="node">
<title>attn_residual_2_12</title>
<ellipse fill="none" stroke="black" cx="7269" cy="-5773" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7269" y="-5776.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="7269" y="-5761.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_2_12&#45;&gt;attn_residual_2_12 -->
<g id="edge1232" class="edge">
<title>attn_out_2_12&#45;&gt;attn_residual_2_12</title>
<path fill="none" stroke="black" d="M7269,-5872.98C7269,-5872.98 7269,-5810.36 7269,-5810.36"/>
<polygon fill="black" stroke="black" points="7272.5,-5810.36 7269,-5800.36 7265.5,-5810.36 7272.5,-5810.36"/>
</g>
<!-- ffn_up_2_12 -->
<g id="node1246" class="node">
<title>ffn_up_2_12</title>
<polygon fill="none" stroke="black" points="7348,-5673 7190,-5673 7190,-5620 7348,-5620 7348,-5673"/>
<text text-anchor="middle" x="7269" y="-5657.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7269" y="-5642.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="7269" y="-5627.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_2_12&#45;&gt;ffn_up_2_12 -->
<g id="edge1233" class="edge">
<title>attn_residual_2_12&#45;&gt;ffn_up_2_12</title>
<path fill="none" stroke="black" d="M7269,-5745.86C7269,-5745.86 7269,-5683.16 7269,-5683.16"/>
<polygon fill="black" stroke="black" points="7272.5,-5683.16 7269,-5673.16 7265.5,-5683.16 7272.5,-5683.16"/>
</g>
<!-- ffn_gelu_2_12 -->
<g id="node1247" class="node">
<title>ffn_gelu_2_12</title>
<ellipse fill="none" stroke="black" cx="7269" cy="-5520" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7269" y="-5523.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7269" y="-5508.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_2_12&#45;&gt;ffn_gelu_2_12 -->
<g id="edge1234" class="edge">
<title>ffn_up_2_12&#45;&gt;ffn_gelu_2_12</title>
<path fill="none" stroke="black" d="M7269,-5619.98C7269,-5619.98 7269,-5557.36 7269,-5557.36"/>
<polygon fill="black" stroke="black" points="7272.5,-5557.36 7269,-5547.36 7265.5,-5557.36 7272.5,-5557.36"/>
</g>
<!-- ffn_down_2_12 -->
<g id="node1248" class="node">
<title>ffn_down_2_12</title>
<polygon fill="none" stroke="black" points="7358,-5420 7180,-5420 7180,-5367 7358,-5367 7358,-5420"/>
<text text-anchor="middle" x="7269" y="-5404.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7269" y="-5389.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="7269" y="-5374.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_2_12&#45;&gt;ffn_down_2_12 -->
<g id="edge1235" class="edge">
<title>ffn_gelu_2_12&#45;&gt;ffn_down_2_12</title>
<path fill="none" stroke="black" d="M7269,-5492.86C7269,-5492.86 7269,-5430.16 7269,-5430.16"/>
<polygon fill="black" stroke="black" points="7272.5,-5430.16 7269,-5420.16 7265.5,-5430.16 7272.5,-5430.16"/>
</g>
<!-- ffn_residual_2_12 -->
<g id="node1249" class="node">
<title>ffn_residual_2_12</title>
<ellipse fill="none" stroke="black" cx="7269" cy="-5267" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7269" y="-5270.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="7269" y="-5255.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_2_12&#45;&gt;ffn_residual_2_12 -->
<g id="edge1236" class="edge">
<title>ffn_down_2_12&#45;&gt;ffn_residual_2_12</title>
<path fill="none" stroke="black" d="M7269,-5366.98C7269,-5366.98 7269,-5304.36 7269,-5304.36"/>
<polygon fill="black" stroke="black" points="7272.5,-5304.36 7269,-5294.36 7265.5,-5304.36 7272.5,-5304.36"/>
</g>
<!-- qkv_proj_3_12 -->
<g id="node1250" class="node">
<title>qkv_proj_3_12</title>
<polygon fill="none" stroke="black" points="7351.5,-5167 7186.5,-5167 7186.5,-5114 7351.5,-5114 7351.5,-5167"/>
<text text-anchor="middle" x="7269" y="-5151.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7269" y="-5136.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="7269" y="-5121.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_2_12&#45;&gt;qkv_proj_3_12 -->
<g id="edge1237" class="edge">
<title>ffn_residual_2_12&#45;&gt;qkv_proj_3_12</title>
<path fill="none" stroke="black" d="M7269,-5239.86C7269,-5239.86 7269,-5177.16 7269,-5177.16"/>
<polygon fill="black" stroke="black" points="7272.5,-5177.16 7269,-5167.16 7265.5,-5177.16 7272.5,-5177.16"/>
</g>
<!-- qkv_reshape_3_12 -->
<g id="node1251" class="node">
<title>qkv_reshape_3_12</title>
<ellipse fill="none" stroke="black" cx="7269" cy="-5014" rx="148" ry="27"/>
<text text-anchor="middle" x="7269" y="-5017.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="7269" y="-5002.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_3_12&#45;&gt;qkv_reshape_3_12 -->
<g id="edge1238" class="edge">
<title>qkv_proj_3_12&#45;&gt;qkv_reshape_3_12</title>
<path fill="none" stroke="black" d="M7269,-5113.98C7269,-5113.98 7269,-5051.36 7269,-5051.36"/>
<polygon fill="black" stroke="black" points="7272.5,-5051.36 7269,-5041.36 7265.5,-5051.36 7272.5,-5051.36"/>
</g>
<!-- qkv_reshape_3_12&#45;&gt;ring_attn_3_12_stage_0 -->
<g id="edge1239" class="edge">
<title>qkv_reshape_3_12&#45;&gt;ring_attn_3_12_stage_0</title>
<path fill="none" stroke="black" d="M7269,-4986.72C7269,-4986.72 7269,-4880.16 7269,-4880.16"/>
<polygon fill="black" stroke="black" points="7272.5,-4880.16 7269,-4870.16 7265.5,-4880.16 7272.5,-4880.16"/>
</g>
<!-- ring_attn_3_12_stage_0&#45;&gt;ring_attn_3_12_stage_1 -->
<g id="edge1240" class="edge">
<title>ring_attn_3_12_stage_0&#45;&gt;ring_attn_3_12_stage_1</title>
<path fill="none" stroke="black" d="M7269,-4733.87C7269,-4733.87 7269,-4627.25 7269,-4627.25"/>
<polygon fill="black" stroke="black" points="7272.5,-4627.25 7269,-4617.25 7265.5,-4627.25 7272.5,-4627.25"/>
</g>
<!-- ring_attn_3_13_stage_0 -->
<g id="node1350" class="node">
<title>ring_attn_3_13_stage_0</title>
<polygon fill="yellow" stroke="black" points="7856,-4870 7647,-4802 7856,-4734 8065,-4802 7856,-4870"/>
<text text-anchor="middle" x="7856" y="-4820.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-4805.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="7856" y="-4790.8" font-family="Times,serif" font-size="14.00">Q[13]×K[13]×V[13]</text>
<text text-anchor="middle" x="7856" y="-4775.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_12_stage_0&#45;&gt;ring_attn_3_13_stage_0 -->
<g id="edge2369" class="edge">
<title>ring_attn_3_12_stage_0&#45;&gt;ring_attn_3_13_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-4802C7478.02,-4802 7636.86,-4802 7636.86,-4802"/>
<polygon fill="red" stroke="red" points="7636.86,-4805.5 7646.86,-4802 7636.86,-4798.5 7636.86,-4805.5"/>
</g>
<!-- ring_attn_3_12_stage_1&#45;&gt;ring_attn_3_12_stage_2 -->
<g id="edge1241" class="edge">
<title>ring_attn_3_12_stage_1&#45;&gt;ring_attn_3_12_stage_2</title>
<path fill="none" stroke="black" d="M7269,-4480.87C7269,-4480.87 7269,-4374.25 7269,-4374.25"/>
<polygon fill="black" stroke="black" points="7272.5,-4374.25 7269,-4364.25 7265.5,-4374.25 7272.5,-4374.25"/>
</g>
<!-- ring_attn_3_13_stage_1 -->
<g id="node1351" class="node">
<title>ring_attn_3_13_stage_1</title>
<polygon fill="yellow" stroke="black" points="7856,-4617 7647,-4549 7856,-4481 8065,-4549 7856,-4617"/>
<text text-anchor="middle" x="7856" y="-4567.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-4552.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="7856" y="-4537.8" font-family="Times,serif" font-size="14.00">Q[13]×K[12]×V[12]</text>
<text text-anchor="middle" x="7856" y="-4522.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_12_stage_1&#45;&gt;ring_attn_3_13_stage_1 -->
<g id="edge2370" class="edge">
<title>ring_attn_3_12_stage_1&#45;&gt;ring_attn_3_13_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-4549C7478.02,-4549 7636.86,-4549 7636.86,-4549"/>
<polygon fill="red" stroke="red" points="7636.86,-4552.5 7646.86,-4549 7636.86,-4545.5 7636.86,-4552.5"/>
</g>
<!-- ring_attn_3_12_stage_2&#45;&gt;ring_attn_3_12_stage_3 -->
<g id="edge1242" class="edge">
<title>ring_attn_3_12_stage_2&#45;&gt;ring_attn_3_12_stage_3</title>
<path fill="none" stroke="black" d="M7269,-4227.87C7269,-4227.87 7269,-4121.25 7269,-4121.25"/>
<polygon fill="black" stroke="black" points="7272.5,-4121.25 7269,-4111.25 7265.5,-4121.25 7272.5,-4121.25"/>
</g>
<!-- ring_attn_3_13_stage_2 -->
<g id="node1352" class="node">
<title>ring_attn_3_13_stage_2</title>
<polygon fill="yellow" stroke="black" points="7856,-4364 7647,-4296 7856,-4228 8065,-4296 7856,-4364"/>
<text text-anchor="middle" x="7856" y="-4314.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-4299.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="7856" y="-4284.8" font-family="Times,serif" font-size="14.00">Q[13]×K[11]×V[11]</text>
<text text-anchor="middle" x="7856" y="-4269.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_12_stage_2&#45;&gt;ring_attn_3_13_stage_2 -->
<g id="edge2371" class="edge">
<title>ring_attn_3_12_stage_2&#45;&gt;ring_attn_3_13_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-4296C7478.02,-4296 7636.86,-4296 7636.86,-4296"/>
<polygon fill="red" stroke="red" points="7636.86,-4299.5 7646.86,-4296 7636.86,-4292.5 7636.86,-4299.5"/>
</g>
<!-- ring_attn_3_12_stage_3&#45;&gt;ring_attn_3_12_stage_4 -->
<g id="edge1243" class="edge">
<title>ring_attn_3_12_stage_3&#45;&gt;ring_attn_3_12_stage_4</title>
<path fill="none" stroke="black" d="M7269,-3974.87C7269,-3974.87 7269,-3868.25 7269,-3868.25"/>
<polygon fill="black" stroke="black" points="7272.5,-3868.25 7269,-3858.25 7265.5,-3868.25 7272.5,-3868.25"/>
</g>
<!-- ring_attn_3_13_stage_3 -->
<g id="node1353" class="node">
<title>ring_attn_3_13_stage_3</title>
<polygon fill="yellow" stroke="black" points="7856,-4111 7647,-4043 7856,-3975 8065,-4043 7856,-4111"/>
<text text-anchor="middle" x="7856" y="-4061.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-4046.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="7856" y="-4031.8" font-family="Times,serif" font-size="14.00">Q[13]×K[10]×V[10]</text>
<text text-anchor="middle" x="7856" y="-4016.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_12_stage_3&#45;&gt;ring_attn_3_13_stage_3 -->
<g id="edge2372" class="edge">
<title>ring_attn_3_12_stage_3&#45;&gt;ring_attn_3_13_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-4043C7478.02,-4043 7636.86,-4043 7636.86,-4043"/>
<polygon fill="red" stroke="red" points="7636.86,-4046.5 7646.86,-4043 7636.86,-4039.5 7636.86,-4046.5"/>
</g>
<!-- ring_attn_3_12_stage_4&#45;&gt;ring_attn_3_12_stage_5 -->
<g id="edge1244" class="edge">
<title>ring_attn_3_12_stage_4&#45;&gt;ring_attn_3_12_stage_5</title>
<path fill="none" stroke="black" d="M7269,-3721.87C7269,-3721.87 7269,-3615.25 7269,-3615.25"/>
<polygon fill="black" stroke="black" points="7272.5,-3615.25 7269,-3605.25 7265.5,-3615.25 7272.5,-3615.25"/>
</g>
<!-- ring_attn_3_13_stage_4 -->
<g id="node1354" class="node">
<title>ring_attn_3_13_stage_4</title>
<polygon fill="yellow" stroke="black" points="7856,-3858 7647,-3790 7856,-3722 8065,-3790 7856,-3858"/>
<text text-anchor="middle" x="7856" y="-3808.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-3793.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="7856" y="-3778.8" font-family="Times,serif" font-size="14.00">Q[13]×K[9]×V[9]</text>
<text text-anchor="middle" x="7856" y="-3763.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_12_stage_4&#45;&gt;ring_attn_3_13_stage_4 -->
<g id="edge2373" class="edge">
<title>ring_attn_3_12_stage_4&#45;&gt;ring_attn_3_13_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-3790C7478.02,-3790 7636.86,-3790 7636.86,-3790"/>
<polygon fill="red" stroke="red" points="7636.86,-3793.5 7646.86,-3790 7636.86,-3786.5 7636.86,-3793.5"/>
</g>
<!-- ring_attn_3_12_stage_5&#45;&gt;ring_attn_3_12_stage_6 -->
<g id="edge1245" class="edge">
<title>ring_attn_3_12_stage_5&#45;&gt;ring_attn_3_12_stage_6</title>
<path fill="none" stroke="black" d="M7269,-3468.87C7269,-3468.87 7269,-3362.25 7269,-3362.25"/>
<polygon fill="black" stroke="black" points="7272.5,-3362.25 7269,-3352.25 7265.5,-3362.25 7272.5,-3362.25"/>
</g>
<!-- ring_attn_3_13_stage_5 -->
<g id="node1355" class="node">
<title>ring_attn_3_13_stage_5</title>
<polygon fill="yellow" stroke="black" points="7856,-3605 7647,-3537 7856,-3469 8065,-3537 7856,-3605"/>
<text text-anchor="middle" x="7856" y="-3555.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-3540.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="7856" y="-3525.8" font-family="Times,serif" font-size="14.00">Q[13]×K[8]×V[8]</text>
<text text-anchor="middle" x="7856" y="-3510.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_12_stage_5&#45;&gt;ring_attn_3_13_stage_5 -->
<g id="edge2374" class="edge">
<title>ring_attn_3_12_stage_5&#45;&gt;ring_attn_3_13_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-3537C7478.02,-3537 7636.86,-3537 7636.86,-3537"/>
<polygon fill="red" stroke="red" points="7636.86,-3540.5 7646.86,-3537 7636.86,-3533.5 7636.86,-3540.5"/>
</g>
<!-- ring_attn_3_12_stage_6&#45;&gt;ring_attn_3_12_stage_7 -->
<g id="edge1246" class="edge">
<title>ring_attn_3_12_stage_6&#45;&gt;ring_attn_3_12_stage_7</title>
<path fill="none" stroke="black" d="M7269,-3215.87C7269,-3215.87 7269,-3109.25 7269,-3109.25"/>
<polygon fill="black" stroke="black" points="7272.5,-3109.25 7269,-3099.25 7265.5,-3109.25 7272.5,-3109.25"/>
</g>
<!-- ring_attn_3_13_stage_6 -->
<g id="node1356" class="node">
<title>ring_attn_3_13_stage_6</title>
<polygon fill="yellow" stroke="black" points="7856,-3352 7647,-3284 7856,-3216 8065,-3284 7856,-3352"/>
<text text-anchor="middle" x="7856" y="-3302.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-3287.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="7856" y="-3272.8" font-family="Times,serif" font-size="14.00">Q[13]×K[7]×V[7]</text>
<text text-anchor="middle" x="7856" y="-3257.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_12_stage_6&#45;&gt;ring_attn_3_13_stage_6 -->
<g id="edge2375" class="edge">
<title>ring_attn_3_12_stage_6&#45;&gt;ring_attn_3_13_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-3284C7478.02,-3284 7636.86,-3284 7636.86,-3284"/>
<polygon fill="red" stroke="red" points="7636.86,-3287.5 7646.86,-3284 7636.86,-3280.5 7636.86,-3287.5"/>
</g>
<!-- ring_attn_3_12_stage_7&#45;&gt;ring_attn_3_12_stage_8 -->
<g id="edge1247" class="edge">
<title>ring_attn_3_12_stage_7&#45;&gt;ring_attn_3_12_stage_8</title>
<path fill="none" stroke="black" d="M7269,-2962.87C7269,-2962.87 7269,-2856.25 7269,-2856.25"/>
<polygon fill="black" stroke="black" points="7272.5,-2856.25 7269,-2846.25 7265.5,-2856.25 7272.5,-2856.25"/>
</g>
<!-- ring_attn_3_13_stage_7 -->
<g id="node1357" class="node">
<title>ring_attn_3_13_stage_7</title>
<polygon fill="yellow" stroke="black" points="7856,-3099 7647,-3031 7856,-2963 8065,-3031 7856,-3099"/>
<text text-anchor="middle" x="7856" y="-3049.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-3034.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="7856" y="-3019.8" font-family="Times,serif" font-size="14.00">Q[13]×K[6]×V[6]</text>
<text text-anchor="middle" x="7856" y="-3004.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_12_stage_7&#45;&gt;ring_attn_3_13_stage_7 -->
<g id="edge2376" class="edge">
<title>ring_attn_3_12_stage_7&#45;&gt;ring_attn_3_13_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-3031C7478.02,-3031 7636.86,-3031 7636.86,-3031"/>
<polygon fill="red" stroke="red" points="7636.86,-3034.5 7646.86,-3031 7636.86,-3027.5 7636.86,-3034.5"/>
</g>
<!-- ring_attn_3_12_stage_8&#45;&gt;ring_attn_3_12_stage_9 -->
<g id="edge1248" class="edge">
<title>ring_attn_3_12_stage_8&#45;&gt;ring_attn_3_12_stage_9</title>
<path fill="none" stroke="black" d="M7269,-2709.87C7269,-2709.87 7269,-2603.25 7269,-2603.25"/>
<polygon fill="black" stroke="black" points="7272.5,-2603.25 7269,-2593.25 7265.5,-2603.25 7272.5,-2603.25"/>
</g>
<!-- ring_attn_3_13_stage_8 -->
<g id="node1358" class="node">
<title>ring_attn_3_13_stage_8</title>
<polygon fill="yellow" stroke="black" points="7856,-2846 7647,-2778 7856,-2710 8065,-2778 7856,-2846"/>
<text text-anchor="middle" x="7856" y="-2796.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-2781.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="7856" y="-2766.8" font-family="Times,serif" font-size="14.00">Q[13]×K[5]×V[5]</text>
<text text-anchor="middle" x="7856" y="-2751.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_12_stage_8&#45;&gt;ring_attn_3_13_stage_8 -->
<g id="edge2377" class="edge">
<title>ring_attn_3_12_stage_8&#45;&gt;ring_attn_3_13_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-2778C7478.02,-2778 7636.86,-2778 7636.86,-2778"/>
<polygon fill="red" stroke="red" points="7636.86,-2781.5 7646.86,-2778 7636.86,-2774.5 7636.86,-2781.5"/>
</g>
<!-- ring_attn_3_12_stage_9&#45;&gt;ring_attn_3_12_stage_10 -->
<g id="edge1249" class="edge">
<title>ring_attn_3_12_stage_9&#45;&gt;ring_attn_3_12_stage_10</title>
<path fill="none" stroke="black" d="M7269,-2456.87C7269,-2456.87 7269,-2350.25 7269,-2350.25"/>
<polygon fill="black" stroke="black" points="7272.5,-2350.25 7269,-2340.25 7265.5,-2350.25 7272.5,-2350.25"/>
</g>
<!-- ring_attn_3_13_stage_9 -->
<g id="node1359" class="node">
<title>ring_attn_3_13_stage_9</title>
<polygon fill="yellow" stroke="black" points="7856,-2593 7647,-2525 7856,-2457 8065,-2525 7856,-2593"/>
<text text-anchor="middle" x="7856" y="-2543.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-2528.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="7856" y="-2513.8" font-family="Times,serif" font-size="14.00">Q[13]×K[4]×V[4]</text>
<text text-anchor="middle" x="7856" y="-2498.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_12_stage_9&#45;&gt;ring_attn_3_13_stage_9 -->
<g id="edge2378" class="edge">
<title>ring_attn_3_12_stage_9&#45;&gt;ring_attn_3_13_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-2525C7478.02,-2525 7636.86,-2525 7636.86,-2525"/>
<polygon fill="red" stroke="red" points="7636.86,-2528.5 7646.86,-2525 7636.86,-2521.5 7636.86,-2528.5"/>
</g>
<!-- ring_attn_3_12_stage_10&#45;&gt;ring_attn_3_12_stage_11 -->
<g id="edge1250" class="edge">
<title>ring_attn_3_12_stage_10&#45;&gt;ring_attn_3_12_stage_11</title>
<path fill="none" stroke="black" d="M7269,-2203.87C7269,-2203.87 7269,-2097.25 7269,-2097.25"/>
<polygon fill="black" stroke="black" points="7272.5,-2097.25 7269,-2087.25 7265.5,-2097.25 7272.5,-2097.25"/>
</g>
<!-- ring_attn_3_13_stage_10 -->
<g id="node1360" class="node">
<title>ring_attn_3_13_stage_10</title>
<polygon fill="yellow" stroke="black" points="7856,-2340 7647,-2272 7856,-2204 8065,-2272 7856,-2340"/>
<text text-anchor="middle" x="7856" y="-2290.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-2275.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="7856" y="-2260.8" font-family="Times,serif" font-size="14.00">Q[13]×K[3]×V[3]</text>
<text text-anchor="middle" x="7856" y="-2245.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_12_stage_10&#45;&gt;ring_attn_3_13_stage_10 -->
<g id="edge2379" class="edge">
<title>ring_attn_3_12_stage_10&#45;&gt;ring_attn_3_13_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-2272C7478.02,-2272 7636.86,-2272 7636.86,-2272"/>
<polygon fill="red" stroke="red" points="7636.86,-2275.5 7646.86,-2272 7636.86,-2268.5 7636.86,-2275.5"/>
</g>
<!-- ring_attn_3_12_stage_11&#45;&gt;ring_attn_3_12_stage_12 -->
<g id="edge1251" class="edge">
<title>ring_attn_3_12_stage_11&#45;&gt;ring_attn_3_12_stage_12</title>
<path fill="none" stroke="black" d="M7269,-1950.87C7269,-1950.87 7269,-1844.25 7269,-1844.25"/>
<polygon fill="black" stroke="black" points="7272.5,-1844.25 7269,-1834.25 7265.5,-1844.25 7272.5,-1844.25"/>
</g>
<!-- ring_attn_3_13_stage_11 -->
<g id="node1361" class="node">
<title>ring_attn_3_13_stage_11</title>
<polygon fill="yellow" stroke="black" points="7856,-2087 7647,-2019 7856,-1951 8065,-2019 7856,-2087"/>
<text text-anchor="middle" x="7856" y="-2037.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-2022.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="7856" y="-2007.8" font-family="Times,serif" font-size="14.00">Q[13]×K[2]×V[2]</text>
<text text-anchor="middle" x="7856" y="-1992.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_12_stage_11&#45;&gt;ring_attn_3_13_stage_11 -->
<g id="edge2380" class="edge">
<title>ring_attn_3_12_stage_11&#45;&gt;ring_attn_3_13_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-2019C7478.02,-2019 7636.86,-2019 7636.86,-2019"/>
<polygon fill="red" stroke="red" points="7636.86,-2022.5 7646.86,-2019 7636.86,-2015.5 7636.86,-2022.5"/>
</g>
<!-- ring_attn_3_12_stage_12&#45;&gt;ring_attn_3_12_stage_13 -->
<g id="edge1252" class="edge">
<title>ring_attn_3_12_stage_12&#45;&gt;ring_attn_3_12_stage_13</title>
<path fill="none" stroke="black" d="M7269,-1697.87C7269,-1697.87 7269,-1591.25 7269,-1591.25"/>
<polygon fill="black" stroke="black" points="7272.5,-1591.25 7269,-1581.25 7265.5,-1591.25 7272.5,-1591.25"/>
</g>
<!-- ring_attn_3_13_stage_12 -->
<g id="node1362" class="node">
<title>ring_attn_3_13_stage_12</title>
<polygon fill="yellow" stroke="black" points="7856,-1834 7647,-1766 7856,-1698 8065,-1766 7856,-1834"/>
<text text-anchor="middle" x="7856" y="-1784.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-1769.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="7856" y="-1754.8" font-family="Times,serif" font-size="14.00">Q[13]×K[1]×V[1]</text>
<text text-anchor="middle" x="7856" y="-1739.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_12_stage_12&#45;&gt;ring_attn_3_13_stage_12 -->
<g id="edge2381" class="edge">
<title>ring_attn_3_12_stage_12&#45;&gt;ring_attn_3_13_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-1766C7478.02,-1766 7636.86,-1766 7636.86,-1766"/>
<polygon fill="red" stroke="red" points="7636.86,-1769.5 7646.86,-1766 7636.86,-1762.5 7636.86,-1769.5"/>
</g>
<!-- ring_attn_3_12_stage_13&#45;&gt;ring_attn_3_12_stage_14 -->
<g id="edge1253" class="edge">
<title>ring_attn_3_12_stage_13&#45;&gt;ring_attn_3_12_stage_14</title>
<path fill="none" stroke="black" d="M7269,-1444.87C7269,-1444.87 7269,-1338.25 7269,-1338.25"/>
<polygon fill="black" stroke="black" points="7272.5,-1338.25 7269,-1328.25 7265.5,-1338.25 7272.5,-1338.25"/>
</g>
<!-- ring_attn_3_13_stage_13 -->
<g id="node1363" class="node">
<title>ring_attn_3_13_stage_13</title>
<polygon fill="yellow" stroke="black" points="7856,-1581 7647,-1513 7856,-1445 8065,-1513 7856,-1581"/>
<text text-anchor="middle" x="7856" y="-1531.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-1516.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="7856" y="-1501.8" font-family="Times,serif" font-size="14.00">Q[13]×K[0]×V[0]</text>
<text text-anchor="middle" x="7856" y="-1486.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_12_stage_13&#45;&gt;ring_attn_3_13_stage_13 -->
<g id="edge2382" class="edge">
<title>ring_attn_3_12_stage_13&#45;&gt;ring_attn_3_13_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-1513C7478.02,-1513 7636.86,-1513 7636.86,-1513"/>
<polygon fill="red" stroke="red" points="7636.86,-1516.5 7646.86,-1513 7636.86,-1509.5 7636.86,-1516.5"/>
</g>
<!-- ring_attn_3_12_stage_14&#45;&gt;ring_attn_3_12_stage_15 -->
<g id="edge1254" class="edge">
<title>ring_attn_3_12_stage_14&#45;&gt;ring_attn_3_12_stage_15</title>
<path fill="none" stroke="black" d="M7269,-1191.87C7269,-1191.87 7269,-1085.25 7269,-1085.25"/>
<polygon fill="black" stroke="black" points="7272.5,-1085.25 7269,-1075.25 7265.5,-1085.25 7272.5,-1085.25"/>
</g>
<!-- ring_attn_3_13_stage_14 -->
<g id="node1364" class="node">
<title>ring_attn_3_13_stage_14</title>
<polygon fill="yellow" stroke="black" points="7856,-1328 7647,-1260 7856,-1192 8065,-1260 7856,-1328"/>
<text text-anchor="middle" x="7856" y="-1278.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-1263.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="7856" y="-1248.8" font-family="Times,serif" font-size="14.00">Q[13]×K[15]×V[15]</text>
<text text-anchor="middle" x="7856" y="-1233.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_12_stage_14&#45;&gt;ring_attn_3_13_stage_14 -->
<g id="edge2383" class="edge">
<title>ring_attn_3_12_stage_14&#45;&gt;ring_attn_3_13_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-1260C7478.02,-1260 7636.86,-1260 7636.86,-1260"/>
<polygon fill="red" stroke="red" points="7636.86,-1263.5 7646.86,-1260 7636.86,-1256.5 7636.86,-1263.5"/>
</g>
<!-- attn_out_3_12 -->
<g id="node1268" class="node">
<title>attn_out_3_12</title>
<polygon fill="none" stroke="black" points="7338.5,-866 7199.5,-866 7199.5,-813 7338.5,-813 7338.5,-866"/>
<text text-anchor="middle" x="7269" y="-850.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="7269" y="-835.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="7269" y="-820.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_3_12_stage_15&#45;&gt;attn_out_3_12 -->
<g id="edge1255" class="edge">
<title>ring_attn_3_12_stage_15&#45;&gt;attn_out_3_12</title>
<path fill="none" stroke="black" d="M7269,-938.87C7269,-938.87 7269,-876.18 7269,-876.18"/>
<polygon fill="black" stroke="black" points="7272.5,-876.18 7269,-866.18 7265.5,-876.18 7272.5,-876.18"/>
</g>
<!-- ring_attn_3_13_stage_15 -->
<g id="node1365" class="node">
<title>ring_attn_3_13_stage_15</title>
<polygon fill="yellow" stroke="black" points="7856,-1075 7647,-1007 7856,-939 8065,-1007 7856,-1075"/>
<text text-anchor="middle" x="7856" y="-1025.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="7856" y="-1010.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="7856" y="-995.8" font-family="Times,serif" font-size="14.00">Q[13]×K[14]×V[14]</text>
<text text-anchor="middle" x="7856" y="-980.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_12_stage_15&#45;&gt;ring_attn_3_13_stage_15 -->
<g id="edge2384" class="edge">
<title>ring_attn_3_12_stage_15&#45;&gt;ring_attn_3_13_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M7478.02,-1007C7478.02,-1007 7636.86,-1007 7636.86,-1007"/>
<polygon fill="red" stroke="red" points="7636.86,-1010.5 7646.86,-1007 7636.86,-1003.5 7636.86,-1010.5"/>
</g>
<!-- attn_residual_3_12 -->
<g id="node1269" class="node">
<title>attn_residual_3_12</title>
<ellipse fill="none" stroke="black" cx="7269" cy="-713" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7269" y="-716.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="7269" y="-701.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_3_12&#45;&gt;attn_residual_3_12 -->
<g id="edge1256" class="edge">
<title>attn_out_3_12&#45;&gt;attn_residual_3_12</title>
<path fill="none" stroke="black" d="M7269,-812.98C7269,-812.98 7269,-750.36 7269,-750.36"/>
<polygon fill="black" stroke="black" points="7272.5,-750.36 7269,-740.36 7265.5,-750.36 7272.5,-750.36"/>
</g>
<!-- ffn_up_3_12 -->
<g id="node1270" class="node">
<title>ffn_up_3_12</title>
<polygon fill="none" stroke="black" points="7348,-613 7190,-613 7190,-560 7348,-560 7348,-613"/>
<text text-anchor="middle" x="7269" y="-597.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7269" y="-582.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="7269" y="-567.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_3_12&#45;&gt;ffn_up_3_12 -->
<g id="edge1257" class="edge">
<title>attn_residual_3_12&#45;&gt;ffn_up_3_12</title>
<path fill="none" stroke="black" d="M7269,-685.86C7269,-685.86 7269,-623.16 7269,-623.16"/>
<polygon fill="black" stroke="black" points="7272.5,-623.16 7269,-613.16 7265.5,-623.16 7272.5,-623.16"/>
</g>
<!-- ffn_gelu_3_12 -->
<g id="node1271" class="node">
<title>ffn_gelu_3_12</title>
<ellipse fill="none" stroke="black" cx="7269" cy="-460" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7269" y="-463.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7269" y="-448.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_3_12&#45;&gt;ffn_gelu_3_12 -->
<g id="edge1258" class="edge">
<title>ffn_up_3_12&#45;&gt;ffn_gelu_3_12</title>
<path fill="none" stroke="black" d="M7269,-559.98C7269,-559.98 7269,-497.36 7269,-497.36"/>
<polygon fill="black" stroke="black" points="7272.5,-497.36 7269,-487.36 7265.5,-497.36 7272.5,-497.36"/>
</g>
<!-- ffn_down_3_12 -->
<g id="node1272" class="node">
<title>ffn_down_3_12</title>
<polygon fill="none" stroke="black" points="7358,-360 7180,-360 7180,-307 7358,-307 7358,-360"/>
<text text-anchor="middle" x="7269" y="-344.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7269" y="-329.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="7269" y="-314.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_3_12&#45;&gt;ffn_down_3_12 -->
<g id="edge1259" class="edge">
<title>ffn_gelu_3_12&#45;&gt;ffn_down_3_12</title>
<path fill="none" stroke="black" d="M7269,-432.86C7269,-432.86 7269,-370.16 7269,-370.16"/>
<polygon fill="black" stroke="black" points="7272.5,-370.16 7269,-360.16 7265.5,-370.16 7272.5,-370.16"/>
</g>
<!-- ffn_residual_3_12 -->
<g id="node1273" class="node">
<title>ffn_residual_3_12</title>
<ellipse fill="none" stroke="black" cx="7269" cy="-207" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7269" y="-210.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="7269" y="-195.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_3_12&#45;&gt;ffn_residual_3_12 -->
<g id="edge1260" class="edge">
<title>ffn_down_3_12&#45;&gt;ffn_residual_3_12</title>
<path fill="none" stroke="black" d="M7269,-306.98C7269,-306.98 7269,-244.36 7269,-244.36"/>
<polygon fill="black" stroke="black" points="7272.5,-244.36 7269,-234.36 7265.5,-244.36 7272.5,-244.36"/>
</g>
<!-- output_12 -->
<g id="node1274" class="node">
<title>output_12</title>
<polygon fill="lightcoral" stroke="black" points="7366.5,-107 7171.5,-107 7171.5,-69 7366.5,-69 7366.5,-107"/>
<text text-anchor="middle" x="7269" y="-91.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="7269" y="-76.8" font-family="Times,serif" font-size="14.00">Y[12]: 1024×1024×4096</text>
</g>
<!-- ffn_residual_3_12&#45;&gt;output_12 -->
<g id="edge1261" class="edge">
<title>ffn_residual_3_12&#45;&gt;output_12</title>
<path fill="none" stroke="black" d="M7269,-180C7269,-180 7269,-117.12 7269,-117.12"/>
<polygon fill="black" stroke="black" points="7272.5,-117.12 7269,-107.12 7265.5,-117.12 7272.5,-117.12"/>
</g>
<!-- input_13 -->
<g id="node1275" class="node">
<title>input_13</title>
<polygon fill="lightgreen" stroke="black" points="7954,-20458 7758,-20458 7758,-20420 7954,-20420 7954,-20458"/>
<text text-anchor="middle" x="7856" y="-20442.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="7856" y="-20427.8" font-family="Times,serif" font-size="14.00">X[13]: 1024×1024×4096</text>
</g>
<!-- qkv_proj_0_13 -->
<g id="node1276" class="node">
<title>qkv_proj_0_13</title>
<polygon fill="none" stroke="black" points="7938.5,-20347 7773.5,-20347 7773.5,-20294 7938.5,-20294 7938.5,-20347"/>
<text text-anchor="middle" x="7856" y="-20331.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7856" y="-20316.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="7856" y="-20301.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- input_13&#45;&gt;qkv_proj_0_13 -->
<g id="edge1262" class="edge">
<title>input_13&#45;&gt;qkv_proj_0_13</title>
<path fill="none" stroke="black" d="M7856,-20419.96C7856,-20419.96 7856,-20357.44 7856,-20357.44"/>
<polygon fill="black" stroke="black" points="7859.5,-20357.44 7856,-20347.44 7852.5,-20357.44 7859.5,-20357.44"/>
</g>
<!-- qkv_reshape_0_13 -->
<g id="node1277" class="node">
<title>qkv_reshape_0_13</title>
<ellipse fill="none" stroke="black" cx="7856" cy="-20194" rx="148" ry="27"/>
<text text-anchor="middle" x="7856" y="-20197.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="7856" y="-20182.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_0_13&#45;&gt;qkv_reshape_0_13 -->
<g id="edge1263" class="edge">
<title>qkv_proj_0_13&#45;&gt;qkv_reshape_0_13</title>
<path fill="none" stroke="black" d="M7856,-20293.98C7856,-20293.98 7856,-20231.36 7856,-20231.36"/>
<polygon fill="black" stroke="black" points="7859.5,-20231.36 7856,-20221.36 7852.5,-20231.36 7859.5,-20231.36"/>
</g>
<!-- qkv_reshape_0_13&#45;&gt;ring_attn_0_13_stage_0 -->
<g id="edge1264" class="edge">
<title>qkv_reshape_0_13&#45;&gt;ring_attn_0_13_stage_0</title>
<path fill="none" stroke="black" d="M7856,-20166.72C7856,-20166.72 7856,-20060.16 7856,-20060.16"/>
<polygon fill="black" stroke="black" points="7859.5,-20060.16 7856,-20050.16 7852.5,-20060.16 7859.5,-20060.16"/>
</g>
<!-- ring_attn_0_13_stage_0&#45;&gt;ring_attn_0_13_stage_1 -->
<g id="edge1265" class="edge">
<title>ring_attn_0_13_stage_0&#45;&gt;ring_attn_0_13_stage_1</title>
<path fill="none" stroke="black" d="M7856,-19913.87C7856,-19913.87 7856,-19807.25 7856,-19807.25"/>
<polygon fill="black" stroke="black" points="7859.5,-19807.25 7856,-19797.25 7852.5,-19807.25 7859.5,-19807.25"/>
</g>
<!-- ring_attn_0_14_stage_0 -->
<g id="node1376" class="node">
<title>ring_attn_0_14_stage_0</title>
<polygon fill="yellow" stroke="black" points="8443,-20050 8234,-19982 8443,-19914 8652,-19982 8443,-20050"/>
<text text-anchor="middle" x="8443" y="-20000.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-19985.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="8443" y="-19970.8" font-family="Times,serif" font-size="14.00">Q[14]×K[14]×V[14]</text>
<text text-anchor="middle" x="8443" y="-19955.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_13_stage_0&#45;&gt;ring_attn_0_14_stage_0 -->
<g id="edge2385" class="edge">
<title>ring_attn_0_13_stage_0&#45;&gt;ring_attn_0_14_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-19982C8065.02,-19982 8223.86,-19982 8223.86,-19982"/>
<polygon fill="red" stroke="red" points="8223.86,-19985.5 8233.86,-19982 8223.86,-19978.5 8223.86,-19985.5"/>
</g>
<!-- ring_attn_0_13_stage_1&#45;&gt;ring_attn_0_13_stage_2 -->
<g id="edge1266" class="edge">
<title>ring_attn_0_13_stage_1&#45;&gt;ring_attn_0_13_stage_2</title>
<path fill="none" stroke="black" d="M7856,-19660.87C7856,-19660.87 7856,-19554.25 7856,-19554.25"/>
<polygon fill="black" stroke="black" points="7859.5,-19554.25 7856,-19544.25 7852.5,-19554.25 7859.5,-19554.25"/>
</g>
<!-- ring_attn_0_14_stage_1 -->
<g id="node1377" class="node">
<title>ring_attn_0_14_stage_1</title>
<polygon fill="yellow" stroke="black" points="8443,-19797 8234,-19729 8443,-19661 8652,-19729 8443,-19797"/>
<text text-anchor="middle" x="8443" y="-19747.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-19732.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="8443" y="-19717.8" font-family="Times,serif" font-size="14.00">Q[14]×K[13]×V[13]</text>
<text text-anchor="middle" x="8443" y="-19702.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_13_stage_1&#45;&gt;ring_attn_0_14_stage_1 -->
<g id="edge2386" class="edge">
<title>ring_attn_0_13_stage_1&#45;&gt;ring_attn_0_14_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-19729C8065.02,-19729 8223.86,-19729 8223.86,-19729"/>
<polygon fill="red" stroke="red" points="8223.86,-19732.5 8233.86,-19729 8223.86,-19725.5 8223.86,-19732.5"/>
</g>
<!-- ring_attn_0_13_stage_2&#45;&gt;ring_attn_0_13_stage_3 -->
<g id="edge1267" class="edge">
<title>ring_attn_0_13_stage_2&#45;&gt;ring_attn_0_13_stage_3</title>
<path fill="none" stroke="black" d="M7856,-19407.87C7856,-19407.87 7856,-19301.25 7856,-19301.25"/>
<polygon fill="black" stroke="black" points="7859.5,-19301.25 7856,-19291.25 7852.5,-19301.25 7859.5,-19301.25"/>
</g>
<!-- ring_attn_0_14_stage_2 -->
<g id="node1378" class="node">
<title>ring_attn_0_14_stage_2</title>
<polygon fill="yellow" stroke="black" points="8443,-19544 8234,-19476 8443,-19408 8652,-19476 8443,-19544"/>
<text text-anchor="middle" x="8443" y="-19494.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-19479.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="8443" y="-19464.8" font-family="Times,serif" font-size="14.00">Q[14]×K[12]×V[12]</text>
<text text-anchor="middle" x="8443" y="-19449.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_13_stage_2&#45;&gt;ring_attn_0_14_stage_2 -->
<g id="edge2387" class="edge">
<title>ring_attn_0_13_stage_2&#45;&gt;ring_attn_0_14_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-19476C8065.02,-19476 8223.86,-19476 8223.86,-19476"/>
<polygon fill="red" stroke="red" points="8223.86,-19479.5 8233.86,-19476 8223.86,-19472.5 8223.86,-19479.5"/>
</g>
<!-- ring_attn_0_13_stage_3&#45;&gt;ring_attn_0_13_stage_4 -->
<g id="edge1268" class="edge">
<title>ring_attn_0_13_stage_3&#45;&gt;ring_attn_0_13_stage_4</title>
<path fill="none" stroke="black" d="M7856,-19154.87C7856,-19154.87 7856,-19048.25 7856,-19048.25"/>
<polygon fill="black" stroke="black" points="7859.5,-19048.25 7856,-19038.25 7852.5,-19048.25 7859.5,-19048.25"/>
</g>
<!-- ring_attn_0_14_stage_3 -->
<g id="node1379" class="node">
<title>ring_attn_0_14_stage_3</title>
<polygon fill="yellow" stroke="black" points="8443,-19291 8234,-19223 8443,-19155 8652,-19223 8443,-19291"/>
<text text-anchor="middle" x="8443" y="-19241.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-19226.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="8443" y="-19211.8" font-family="Times,serif" font-size="14.00">Q[14]×K[11]×V[11]</text>
<text text-anchor="middle" x="8443" y="-19196.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_13_stage_3&#45;&gt;ring_attn_0_14_stage_3 -->
<g id="edge2388" class="edge">
<title>ring_attn_0_13_stage_3&#45;&gt;ring_attn_0_14_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-19223C8065.02,-19223 8223.86,-19223 8223.86,-19223"/>
<polygon fill="red" stroke="red" points="8223.86,-19226.5 8233.86,-19223 8223.86,-19219.5 8223.86,-19226.5"/>
</g>
<!-- ring_attn_0_13_stage_4&#45;&gt;ring_attn_0_13_stage_5 -->
<g id="edge1269" class="edge">
<title>ring_attn_0_13_stage_4&#45;&gt;ring_attn_0_13_stage_5</title>
<path fill="none" stroke="black" d="M7856,-18901.87C7856,-18901.87 7856,-18795.25 7856,-18795.25"/>
<polygon fill="black" stroke="black" points="7859.5,-18795.25 7856,-18785.25 7852.5,-18795.25 7859.5,-18795.25"/>
</g>
<!-- ring_attn_0_14_stage_4 -->
<g id="node1380" class="node">
<title>ring_attn_0_14_stage_4</title>
<polygon fill="yellow" stroke="black" points="8443,-19038 8234,-18970 8443,-18902 8652,-18970 8443,-19038"/>
<text text-anchor="middle" x="8443" y="-18988.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-18973.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="8443" y="-18958.8" font-family="Times,serif" font-size="14.00">Q[14]×K[10]×V[10]</text>
<text text-anchor="middle" x="8443" y="-18943.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_13_stage_4&#45;&gt;ring_attn_0_14_stage_4 -->
<g id="edge2389" class="edge">
<title>ring_attn_0_13_stage_4&#45;&gt;ring_attn_0_14_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-18970C8065.02,-18970 8223.86,-18970 8223.86,-18970"/>
<polygon fill="red" stroke="red" points="8223.86,-18973.5 8233.86,-18970 8223.86,-18966.5 8223.86,-18973.5"/>
</g>
<!-- ring_attn_0_13_stage_5&#45;&gt;ring_attn_0_13_stage_6 -->
<g id="edge1270" class="edge">
<title>ring_attn_0_13_stage_5&#45;&gt;ring_attn_0_13_stage_6</title>
<path fill="none" stroke="black" d="M7856,-18648.87C7856,-18648.87 7856,-18542.25 7856,-18542.25"/>
<polygon fill="black" stroke="black" points="7859.5,-18542.25 7856,-18532.25 7852.5,-18542.25 7859.5,-18542.25"/>
</g>
<!-- ring_attn_0_14_stage_5 -->
<g id="node1381" class="node">
<title>ring_attn_0_14_stage_5</title>
<polygon fill="yellow" stroke="black" points="8443,-18785 8234,-18717 8443,-18649 8652,-18717 8443,-18785"/>
<text text-anchor="middle" x="8443" y="-18735.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-18720.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="8443" y="-18705.8" font-family="Times,serif" font-size="14.00">Q[14]×K[9]×V[9]</text>
<text text-anchor="middle" x="8443" y="-18690.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_13_stage_5&#45;&gt;ring_attn_0_14_stage_5 -->
<g id="edge2390" class="edge">
<title>ring_attn_0_13_stage_5&#45;&gt;ring_attn_0_14_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-18717C8065.02,-18717 8223.86,-18717 8223.86,-18717"/>
<polygon fill="red" stroke="red" points="8223.86,-18720.5 8233.86,-18717 8223.86,-18713.5 8223.86,-18720.5"/>
</g>
<!-- ring_attn_0_13_stage_6&#45;&gt;ring_attn_0_13_stage_7 -->
<g id="edge1271" class="edge">
<title>ring_attn_0_13_stage_6&#45;&gt;ring_attn_0_13_stage_7</title>
<path fill="none" stroke="black" d="M7856,-18395.87C7856,-18395.87 7856,-18289.25 7856,-18289.25"/>
<polygon fill="black" stroke="black" points="7859.5,-18289.25 7856,-18279.25 7852.5,-18289.25 7859.5,-18289.25"/>
</g>
<!-- ring_attn_0_14_stage_6 -->
<g id="node1382" class="node">
<title>ring_attn_0_14_stage_6</title>
<polygon fill="yellow" stroke="black" points="8443,-18532 8234,-18464 8443,-18396 8652,-18464 8443,-18532"/>
<text text-anchor="middle" x="8443" y="-18482.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-18467.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="8443" y="-18452.8" font-family="Times,serif" font-size="14.00">Q[14]×K[8]×V[8]</text>
<text text-anchor="middle" x="8443" y="-18437.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_13_stage_6&#45;&gt;ring_attn_0_14_stage_6 -->
<g id="edge2391" class="edge">
<title>ring_attn_0_13_stage_6&#45;&gt;ring_attn_0_14_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-18464C8065.02,-18464 8223.86,-18464 8223.86,-18464"/>
<polygon fill="red" stroke="red" points="8223.86,-18467.5 8233.86,-18464 8223.86,-18460.5 8223.86,-18467.5"/>
</g>
<!-- ring_attn_0_13_stage_7&#45;&gt;ring_attn_0_13_stage_8 -->
<g id="edge1272" class="edge">
<title>ring_attn_0_13_stage_7&#45;&gt;ring_attn_0_13_stage_8</title>
<path fill="none" stroke="black" d="M7856,-18142.87C7856,-18142.87 7856,-18036.25 7856,-18036.25"/>
<polygon fill="black" stroke="black" points="7859.5,-18036.25 7856,-18026.25 7852.5,-18036.25 7859.5,-18036.25"/>
</g>
<!-- ring_attn_0_14_stage_7 -->
<g id="node1383" class="node">
<title>ring_attn_0_14_stage_7</title>
<polygon fill="yellow" stroke="black" points="8443,-18279 8234,-18211 8443,-18143 8652,-18211 8443,-18279"/>
<text text-anchor="middle" x="8443" y="-18229.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-18214.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="8443" y="-18199.8" font-family="Times,serif" font-size="14.00">Q[14]×K[7]×V[7]</text>
<text text-anchor="middle" x="8443" y="-18184.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_13_stage_7&#45;&gt;ring_attn_0_14_stage_7 -->
<g id="edge2392" class="edge">
<title>ring_attn_0_13_stage_7&#45;&gt;ring_attn_0_14_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-18211C8065.02,-18211 8223.86,-18211 8223.86,-18211"/>
<polygon fill="red" stroke="red" points="8223.86,-18214.5 8233.86,-18211 8223.86,-18207.5 8223.86,-18214.5"/>
</g>
<!-- ring_attn_0_13_stage_8&#45;&gt;ring_attn_0_13_stage_9 -->
<g id="edge1273" class="edge">
<title>ring_attn_0_13_stage_8&#45;&gt;ring_attn_0_13_stage_9</title>
<path fill="none" stroke="black" d="M7856,-17889.87C7856,-17889.87 7856,-17783.25 7856,-17783.25"/>
<polygon fill="black" stroke="black" points="7859.5,-17783.25 7856,-17773.25 7852.5,-17783.25 7859.5,-17783.25"/>
</g>
<!-- ring_attn_0_14_stage_8 -->
<g id="node1384" class="node">
<title>ring_attn_0_14_stage_8</title>
<polygon fill="yellow" stroke="black" points="8443,-18026 8234,-17958 8443,-17890 8652,-17958 8443,-18026"/>
<text text-anchor="middle" x="8443" y="-17976.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-17961.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="8443" y="-17946.8" font-family="Times,serif" font-size="14.00">Q[14]×K[6]×V[6]</text>
<text text-anchor="middle" x="8443" y="-17931.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_13_stage_8&#45;&gt;ring_attn_0_14_stage_8 -->
<g id="edge2393" class="edge">
<title>ring_attn_0_13_stage_8&#45;&gt;ring_attn_0_14_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-17958C8065.02,-17958 8223.86,-17958 8223.86,-17958"/>
<polygon fill="red" stroke="red" points="8223.86,-17961.5 8233.86,-17958 8223.86,-17954.5 8223.86,-17961.5"/>
</g>
<!-- ring_attn_0_13_stage_9&#45;&gt;ring_attn_0_13_stage_10 -->
<g id="edge1274" class="edge">
<title>ring_attn_0_13_stage_9&#45;&gt;ring_attn_0_13_stage_10</title>
<path fill="none" stroke="black" d="M7856,-17636.87C7856,-17636.87 7856,-17530.25 7856,-17530.25"/>
<polygon fill="black" stroke="black" points="7859.5,-17530.25 7856,-17520.25 7852.5,-17530.25 7859.5,-17530.25"/>
</g>
<!-- ring_attn_0_14_stage_9 -->
<g id="node1385" class="node">
<title>ring_attn_0_14_stage_9</title>
<polygon fill="yellow" stroke="black" points="8443,-17773 8234,-17705 8443,-17637 8652,-17705 8443,-17773"/>
<text text-anchor="middle" x="8443" y="-17723.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-17708.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="8443" y="-17693.8" font-family="Times,serif" font-size="14.00">Q[14]×K[5]×V[5]</text>
<text text-anchor="middle" x="8443" y="-17678.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_13_stage_9&#45;&gt;ring_attn_0_14_stage_9 -->
<g id="edge2394" class="edge">
<title>ring_attn_0_13_stage_9&#45;&gt;ring_attn_0_14_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-17705C8065.02,-17705 8223.86,-17705 8223.86,-17705"/>
<polygon fill="red" stroke="red" points="8223.86,-17708.5 8233.86,-17705 8223.86,-17701.5 8223.86,-17708.5"/>
</g>
<!-- ring_attn_0_13_stage_10&#45;&gt;ring_attn_0_13_stage_11 -->
<g id="edge1275" class="edge">
<title>ring_attn_0_13_stage_10&#45;&gt;ring_attn_0_13_stage_11</title>
<path fill="none" stroke="black" d="M7856,-17383.87C7856,-17383.87 7856,-17277.25 7856,-17277.25"/>
<polygon fill="black" stroke="black" points="7859.5,-17277.25 7856,-17267.25 7852.5,-17277.25 7859.5,-17277.25"/>
</g>
<!-- ring_attn_0_14_stage_10 -->
<g id="node1386" class="node">
<title>ring_attn_0_14_stage_10</title>
<polygon fill="yellow" stroke="black" points="8443,-17520 8234,-17452 8443,-17384 8652,-17452 8443,-17520"/>
<text text-anchor="middle" x="8443" y="-17470.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-17455.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="8443" y="-17440.8" font-family="Times,serif" font-size="14.00">Q[14]×K[4]×V[4]</text>
<text text-anchor="middle" x="8443" y="-17425.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_13_stage_10&#45;&gt;ring_attn_0_14_stage_10 -->
<g id="edge2395" class="edge">
<title>ring_attn_0_13_stage_10&#45;&gt;ring_attn_0_14_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-17452C8065.02,-17452 8223.86,-17452 8223.86,-17452"/>
<polygon fill="red" stroke="red" points="8223.86,-17455.5 8233.86,-17452 8223.86,-17448.5 8223.86,-17455.5"/>
</g>
<!-- ring_attn_0_13_stage_11&#45;&gt;ring_attn_0_13_stage_12 -->
<g id="edge1276" class="edge">
<title>ring_attn_0_13_stage_11&#45;&gt;ring_attn_0_13_stage_12</title>
<path fill="none" stroke="black" d="M7856,-17130.87C7856,-17130.87 7856,-17024.25 7856,-17024.25"/>
<polygon fill="black" stroke="black" points="7859.5,-17024.25 7856,-17014.25 7852.5,-17024.25 7859.5,-17024.25"/>
</g>
<!-- ring_attn_0_14_stage_11 -->
<g id="node1387" class="node">
<title>ring_attn_0_14_stage_11</title>
<polygon fill="yellow" stroke="black" points="8443,-17267 8234,-17199 8443,-17131 8652,-17199 8443,-17267"/>
<text text-anchor="middle" x="8443" y="-17217.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-17202.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="8443" y="-17187.8" font-family="Times,serif" font-size="14.00">Q[14]×K[3]×V[3]</text>
<text text-anchor="middle" x="8443" y="-17172.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_13_stage_11&#45;&gt;ring_attn_0_14_stage_11 -->
<g id="edge2396" class="edge">
<title>ring_attn_0_13_stage_11&#45;&gt;ring_attn_0_14_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-17199C8065.02,-17199 8223.86,-17199 8223.86,-17199"/>
<polygon fill="red" stroke="red" points="8223.86,-17202.5 8233.86,-17199 8223.86,-17195.5 8223.86,-17202.5"/>
</g>
<!-- ring_attn_0_13_stage_12&#45;&gt;ring_attn_0_13_stage_13 -->
<g id="edge1277" class="edge">
<title>ring_attn_0_13_stage_12&#45;&gt;ring_attn_0_13_stage_13</title>
<path fill="none" stroke="black" d="M7856,-16877.87C7856,-16877.87 7856,-16771.25 7856,-16771.25"/>
<polygon fill="black" stroke="black" points="7859.5,-16771.25 7856,-16761.25 7852.5,-16771.25 7859.5,-16771.25"/>
</g>
<!-- ring_attn_0_14_stage_12 -->
<g id="node1388" class="node">
<title>ring_attn_0_14_stage_12</title>
<polygon fill="yellow" stroke="black" points="8443,-17014 8234,-16946 8443,-16878 8652,-16946 8443,-17014"/>
<text text-anchor="middle" x="8443" y="-16964.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-16949.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="8443" y="-16934.8" font-family="Times,serif" font-size="14.00">Q[14]×K[2]×V[2]</text>
<text text-anchor="middle" x="8443" y="-16919.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_13_stage_12&#45;&gt;ring_attn_0_14_stage_12 -->
<g id="edge2397" class="edge">
<title>ring_attn_0_13_stage_12&#45;&gt;ring_attn_0_14_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-16946C8065.02,-16946 8223.86,-16946 8223.86,-16946"/>
<polygon fill="red" stroke="red" points="8223.86,-16949.5 8233.86,-16946 8223.86,-16942.5 8223.86,-16949.5"/>
</g>
<!-- ring_attn_0_13_stage_13&#45;&gt;ring_attn_0_13_stage_14 -->
<g id="edge1278" class="edge">
<title>ring_attn_0_13_stage_13&#45;&gt;ring_attn_0_13_stage_14</title>
<path fill="none" stroke="black" d="M7856,-16624.87C7856,-16624.87 7856,-16518.25 7856,-16518.25"/>
<polygon fill="black" stroke="black" points="7859.5,-16518.25 7856,-16508.25 7852.5,-16518.25 7859.5,-16518.25"/>
</g>
<!-- ring_attn_0_14_stage_13 -->
<g id="node1389" class="node">
<title>ring_attn_0_14_stage_13</title>
<polygon fill="yellow" stroke="black" points="8443,-16761 8234,-16693 8443,-16625 8652,-16693 8443,-16761"/>
<text text-anchor="middle" x="8443" y="-16711.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-16696.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="8443" y="-16681.8" font-family="Times,serif" font-size="14.00">Q[14]×K[1]×V[1]</text>
<text text-anchor="middle" x="8443" y="-16666.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_13_stage_13&#45;&gt;ring_attn_0_14_stage_13 -->
<g id="edge2398" class="edge">
<title>ring_attn_0_13_stage_13&#45;&gt;ring_attn_0_14_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-16693C8065.02,-16693 8223.86,-16693 8223.86,-16693"/>
<polygon fill="red" stroke="red" points="8223.86,-16696.5 8233.86,-16693 8223.86,-16689.5 8223.86,-16696.5"/>
</g>
<!-- ring_attn_0_13_stage_14&#45;&gt;ring_attn_0_13_stage_15 -->
<g id="edge1279" class="edge">
<title>ring_attn_0_13_stage_14&#45;&gt;ring_attn_0_13_stage_15</title>
<path fill="none" stroke="black" d="M7856,-16371.87C7856,-16371.87 7856,-16265.25 7856,-16265.25"/>
<polygon fill="black" stroke="black" points="7859.5,-16265.25 7856,-16255.25 7852.5,-16265.25 7859.5,-16265.25"/>
</g>
<!-- ring_attn_0_14_stage_14 -->
<g id="node1390" class="node">
<title>ring_attn_0_14_stage_14</title>
<polygon fill="yellow" stroke="black" points="8443,-16508 8234,-16440 8443,-16372 8652,-16440 8443,-16508"/>
<text text-anchor="middle" x="8443" y="-16458.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-16443.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="8443" y="-16428.8" font-family="Times,serif" font-size="14.00">Q[14]×K[0]×V[0]</text>
<text text-anchor="middle" x="8443" y="-16413.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_13_stage_14&#45;&gt;ring_attn_0_14_stage_14 -->
<g id="edge2399" class="edge">
<title>ring_attn_0_13_stage_14&#45;&gt;ring_attn_0_14_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-16440C8065.02,-16440 8223.86,-16440 8223.86,-16440"/>
<polygon fill="red" stroke="red" points="8223.86,-16443.5 8233.86,-16440 8223.86,-16436.5 8223.86,-16443.5"/>
</g>
<!-- attn_out_0_13 -->
<g id="node1294" class="node">
<title>attn_out_0_13</title>
<polygon fill="none" stroke="black" points="7925.5,-16046 7786.5,-16046 7786.5,-15993 7925.5,-15993 7925.5,-16046"/>
<text text-anchor="middle" x="7856" y="-16030.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="7856" y="-16015.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="7856" y="-16000.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_0_13_stage_15&#45;&gt;attn_out_0_13 -->
<g id="edge1280" class="edge">
<title>ring_attn_0_13_stage_15&#45;&gt;attn_out_0_13</title>
<path fill="none" stroke="black" d="M7856,-16118.87C7856,-16118.87 7856,-16056.18 7856,-16056.18"/>
<polygon fill="black" stroke="black" points="7859.5,-16056.18 7856,-16046.18 7852.5,-16056.18 7859.5,-16056.18"/>
</g>
<!-- ring_attn_0_14_stage_15 -->
<g id="node1391" class="node">
<title>ring_attn_0_14_stage_15</title>
<polygon fill="yellow" stroke="black" points="8443,-16255 8234,-16187 8443,-16119 8652,-16187 8443,-16255"/>
<text text-anchor="middle" x="8443" y="-16205.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-16190.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="8443" y="-16175.8" font-family="Times,serif" font-size="14.00">Q[14]×K[15]×V[15]</text>
<text text-anchor="middle" x="8443" y="-16160.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_13_stage_15&#45;&gt;ring_attn_0_14_stage_15 -->
<g id="edge2400" class="edge">
<title>ring_attn_0_13_stage_15&#45;&gt;ring_attn_0_14_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-16187C8065.02,-16187 8223.86,-16187 8223.86,-16187"/>
<polygon fill="red" stroke="red" points="8223.86,-16190.5 8233.86,-16187 8223.86,-16183.5 8223.86,-16190.5"/>
</g>
<!-- attn_residual_0_13 -->
<g id="node1295" class="node">
<title>attn_residual_0_13</title>
<ellipse fill="none" stroke="black" cx="7856" cy="-15893" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7856" y="-15896.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="7856" y="-15881.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_0_13&#45;&gt;attn_residual_0_13 -->
<g id="edge1281" class="edge">
<title>attn_out_0_13&#45;&gt;attn_residual_0_13</title>
<path fill="none" stroke="black" d="M7856,-15992.98C7856,-15992.98 7856,-15930.36 7856,-15930.36"/>
<polygon fill="black" stroke="black" points="7859.5,-15930.36 7856,-15920.36 7852.5,-15930.36 7859.5,-15930.36"/>
</g>
<!-- ffn_up_0_13 -->
<g id="node1296" class="node">
<title>ffn_up_0_13</title>
<polygon fill="none" stroke="black" points="7935,-15793 7777,-15793 7777,-15740 7935,-15740 7935,-15793"/>
<text text-anchor="middle" x="7856" y="-15777.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7856" y="-15762.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="7856" y="-15747.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_0_13&#45;&gt;ffn_up_0_13 -->
<g id="edge1282" class="edge">
<title>attn_residual_0_13&#45;&gt;ffn_up_0_13</title>
<path fill="none" stroke="black" d="M7856,-15865.86C7856,-15865.86 7856,-15803.16 7856,-15803.16"/>
<polygon fill="black" stroke="black" points="7859.5,-15803.16 7856,-15793.16 7852.5,-15803.16 7859.5,-15803.16"/>
</g>
<!-- ffn_gelu_0_13 -->
<g id="node1297" class="node">
<title>ffn_gelu_0_13</title>
<ellipse fill="none" stroke="black" cx="7856" cy="-15640" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7856" y="-15643.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7856" y="-15628.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_0_13&#45;&gt;ffn_gelu_0_13 -->
<g id="edge1283" class="edge">
<title>ffn_up_0_13&#45;&gt;ffn_gelu_0_13</title>
<path fill="none" stroke="black" d="M7856,-15739.98C7856,-15739.98 7856,-15677.36 7856,-15677.36"/>
<polygon fill="black" stroke="black" points="7859.5,-15677.36 7856,-15667.36 7852.5,-15677.36 7859.5,-15677.36"/>
</g>
<!-- ffn_down_0_13 -->
<g id="node1298" class="node">
<title>ffn_down_0_13</title>
<polygon fill="none" stroke="black" points="7945,-15540 7767,-15540 7767,-15487 7945,-15487 7945,-15540"/>
<text text-anchor="middle" x="7856" y="-15524.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7856" y="-15509.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="7856" y="-15494.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_0_13&#45;&gt;ffn_down_0_13 -->
<g id="edge1284" class="edge">
<title>ffn_gelu_0_13&#45;&gt;ffn_down_0_13</title>
<path fill="none" stroke="black" d="M7856,-15612.86C7856,-15612.86 7856,-15550.16 7856,-15550.16"/>
<polygon fill="black" stroke="black" points="7859.5,-15550.16 7856,-15540.16 7852.5,-15550.16 7859.5,-15550.16"/>
</g>
<!-- ffn_residual_0_13 -->
<g id="node1299" class="node">
<title>ffn_residual_0_13</title>
<ellipse fill="none" stroke="black" cx="7856" cy="-15387" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7856" y="-15390.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="7856" y="-15375.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_0_13&#45;&gt;ffn_residual_0_13 -->
<g id="edge1285" class="edge">
<title>ffn_down_0_13&#45;&gt;ffn_residual_0_13</title>
<path fill="none" stroke="black" d="M7856,-15486.98C7856,-15486.98 7856,-15424.36 7856,-15424.36"/>
<polygon fill="black" stroke="black" points="7859.5,-15424.36 7856,-15414.36 7852.5,-15424.36 7859.5,-15424.36"/>
</g>
<!-- qkv_proj_1_13 -->
<g id="node1300" class="node">
<title>qkv_proj_1_13</title>
<polygon fill="none" stroke="black" points="7938.5,-15287 7773.5,-15287 7773.5,-15234 7938.5,-15234 7938.5,-15287"/>
<text text-anchor="middle" x="7856" y="-15271.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7856" y="-15256.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="7856" y="-15241.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_0_13&#45;&gt;qkv_proj_1_13 -->
<g id="edge1286" class="edge">
<title>ffn_residual_0_13&#45;&gt;qkv_proj_1_13</title>
<path fill="none" stroke="black" d="M7856,-15359.86C7856,-15359.86 7856,-15297.16 7856,-15297.16"/>
<polygon fill="black" stroke="black" points="7859.5,-15297.16 7856,-15287.16 7852.5,-15297.16 7859.5,-15297.16"/>
</g>
<!-- qkv_reshape_1_13 -->
<g id="node1301" class="node">
<title>qkv_reshape_1_13</title>
<ellipse fill="none" stroke="black" cx="7856" cy="-15134" rx="148" ry="27"/>
<text text-anchor="middle" x="7856" y="-15137.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="7856" y="-15122.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_1_13&#45;&gt;qkv_reshape_1_13 -->
<g id="edge1287" class="edge">
<title>qkv_proj_1_13&#45;&gt;qkv_reshape_1_13</title>
<path fill="none" stroke="black" d="M7856,-15233.98C7856,-15233.98 7856,-15171.36 7856,-15171.36"/>
<polygon fill="black" stroke="black" points="7859.5,-15171.36 7856,-15161.36 7852.5,-15171.36 7859.5,-15171.36"/>
</g>
<!-- qkv_reshape_1_13&#45;&gt;ring_attn_1_13_stage_0 -->
<g id="edge1288" class="edge">
<title>qkv_reshape_1_13&#45;&gt;ring_attn_1_13_stage_0</title>
<path fill="none" stroke="black" d="M7856,-15106.72C7856,-15106.72 7856,-15000.16 7856,-15000.16"/>
<polygon fill="black" stroke="black" points="7859.5,-15000.16 7856,-14990.16 7852.5,-15000.16 7859.5,-15000.16"/>
</g>
<!-- ring_attn_1_13_stage_0&#45;&gt;ring_attn_1_13_stage_1 -->
<g id="edge1289" class="edge">
<title>ring_attn_1_13_stage_0&#45;&gt;ring_attn_1_13_stage_1</title>
<path fill="none" stroke="black" d="M7856,-14853.87C7856,-14853.87 7856,-14747.25 7856,-14747.25"/>
<polygon fill="black" stroke="black" points="7859.5,-14747.25 7856,-14737.25 7852.5,-14747.25 7859.5,-14747.25"/>
</g>
<!-- ring_attn_1_14_stage_0 -->
<g id="node1400" class="node">
<title>ring_attn_1_14_stage_0</title>
<polygon fill="yellow" stroke="black" points="8443,-14990 8234,-14922 8443,-14854 8652,-14922 8443,-14990"/>
<text text-anchor="middle" x="8443" y="-14940.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-14925.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="8443" y="-14910.8" font-family="Times,serif" font-size="14.00">Q[14]×K[14]×V[14]</text>
<text text-anchor="middle" x="8443" y="-14895.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_13_stage_0&#45;&gt;ring_attn_1_14_stage_0 -->
<g id="edge2401" class="edge">
<title>ring_attn_1_13_stage_0&#45;&gt;ring_attn_1_14_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-14922C8065.02,-14922 8223.86,-14922 8223.86,-14922"/>
<polygon fill="red" stroke="red" points="8223.86,-14925.5 8233.86,-14922 8223.86,-14918.5 8223.86,-14925.5"/>
</g>
<!-- ring_attn_1_13_stage_1&#45;&gt;ring_attn_1_13_stage_2 -->
<g id="edge1290" class="edge">
<title>ring_attn_1_13_stage_1&#45;&gt;ring_attn_1_13_stage_2</title>
<path fill="none" stroke="black" d="M7856,-14600.87C7856,-14600.87 7856,-14494.25 7856,-14494.25"/>
<polygon fill="black" stroke="black" points="7859.5,-14494.25 7856,-14484.25 7852.5,-14494.25 7859.5,-14494.25"/>
</g>
<!-- ring_attn_1_14_stage_1 -->
<g id="node1401" class="node">
<title>ring_attn_1_14_stage_1</title>
<polygon fill="yellow" stroke="black" points="8443,-14737 8234,-14669 8443,-14601 8652,-14669 8443,-14737"/>
<text text-anchor="middle" x="8443" y="-14687.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-14672.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="8443" y="-14657.8" font-family="Times,serif" font-size="14.00">Q[14]×K[13]×V[13]</text>
<text text-anchor="middle" x="8443" y="-14642.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_13_stage_1&#45;&gt;ring_attn_1_14_stage_1 -->
<g id="edge2402" class="edge">
<title>ring_attn_1_13_stage_1&#45;&gt;ring_attn_1_14_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-14669C8065.02,-14669 8223.86,-14669 8223.86,-14669"/>
<polygon fill="red" stroke="red" points="8223.86,-14672.5 8233.86,-14669 8223.86,-14665.5 8223.86,-14672.5"/>
</g>
<!-- ring_attn_1_13_stage_2&#45;&gt;ring_attn_1_13_stage_3 -->
<g id="edge1291" class="edge">
<title>ring_attn_1_13_stage_2&#45;&gt;ring_attn_1_13_stage_3</title>
<path fill="none" stroke="black" d="M7856,-14347.87C7856,-14347.87 7856,-14241.25 7856,-14241.25"/>
<polygon fill="black" stroke="black" points="7859.5,-14241.25 7856,-14231.25 7852.5,-14241.25 7859.5,-14241.25"/>
</g>
<!-- ring_attn_1_14_stage_2 -->
<g id="node1402" class="node">
<title>ring_attn_1_14_stage_2</title>
<polygon fill="yellow" stroke="black" points="8443,-14484 8234,-14416 8443,-14348 8652,-14416 8443,-14484"/>
<text text-anchor="middle" x="8443" y="-14434.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-14419.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="8443" y="-14404.8" font-family="Times,serif" font-size="14.00">Q[14]×K[12]×V[12]</text>
<text text-anchor="middle" x="8443" y="-14389.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_13_stage_2&#45;&gt;ring_attn_1_14_stage_2 -->
<g id="edge2403" class="edge">
<title>ring_attn_1_13_stage_2&#45;&gt;ring_attn_1_14_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-14416C8065.02,-14416 8223.86,-14416 8223.86,-14416"/>
<polygon fill="red" stroke="red" points="8223.86,-14419.5 8233.86,-14416 8223.86,-14412.5 8223.86,-14419.5"/>
</g>
<!-- ring_attn_1_13_stage_3&#45;&gt;ring_attn_1_13_stage_4 -->
<g id="edge1292" class="edge">
<title>ring_attn_1_13_stage_3&#45;&gt;ring_attn_1_13_stage_4</title>
<path fill="none" stroke="black" d="M7856,-14094.87C7856,-14094.87 7856,-13988.25 7856,-13988.25"/>
<polygon fill="black" stroke="black" points="7859.5,-13988.25 7856,-13978.25 7852.5,-13988.25 7859.5,-13988.25"/>
</g>
<!-- ring_attn_1_14_stage_3 -->
<g id="node1403" class="node">
<title>ring_attn_1_14_stage_3</title>
<polygon fill="yellow" stroke="black" points="8443,-14231 8234,-14163 8443,-14095 8652,-14163 8443,-14231"/>
<text text-anchor="middle" x="8443" y="-14181.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-14166.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="8443" y="-14151.8" font-family="Times,serif" font-size="14.00">Q[14]×K[11]×V[11]</text>
<text text-anchor="middle" x="8443" y="-14136.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_13_stage_3&#45;&gt;ring_attn_1_14_stage_3 -->
<g id="edge2404" class="edge">
<title>ring_attn_1_13_stage_3&#45;&gt;ring_attn_1_14_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-14163C8065.02,-14163 8223.86,-14163 8223.86,-14163"/>
<polygon fill="red" stroke="red" points="8223.86,-14166.5 8233.86,-14163 8223.86,-14159.5 8223.86,-14166.5"/>
</g>
<!-- ring_attn_1_13_stage_4&#45;&gt;ring_attn_1_13_stage_5 -->
<g id="edge1293" class="edge">
<title>ring_attn_1_13_stage_4&#45;&gt;ring_attn_1_13_stage_5</title>
<path fill="none" stroke="black" d="M7856,-13841.87C7856,-13841.87 7856,-13735.25 7856,-13735.25"/>
<polygon fill="black" stroke="black" points="7859.5,-13735.25 7856,-13725.25 7852.5,-13735.25 7859.5,-13735.25"/>
</g>
<!-- ring_attn_1_14_stage_4 -->
<g id="node1404" class="node">
<title>ring_attn_1_14_stage_4</title>
<polygon fill="yellow" stroke="black" points="8443,-13978 8234,-13910 8443,-13842 8652,-13910 8443,-13978"/>
<text text-anchor="middle" x="8443" y="-13928.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-13913.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="8443" y="-13898.8" font-family="Times,serif" font-size="14.00">Q[14]×K[10]×V[10]</text>
<text text-anchor="middle" x="8443" y="-13883.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_13_stage_4&#45;&gt;ring_attn_1_14_stage_4 -->
<g id="edge2405" class="edge">
<title>ring_attn_1_13_stage_4&#45;&gt;ring_attn_1_14_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-13910C8065.02,-13910 8223.86,-13910 8223.86,-13910"/>
<polygon fill="red" stroke="red" points="8223.86,-13913.5 8233.86,-13910 8223.86,-13906.5 8223.86,-13913.5"/>
</g>
<!-- ring_attn_1_13_stage_5&#45;&gt;ring_attn_1_13_stage_6 -->
<g id="edge1294" class="edge">
<title>ring_attn_1_13_stage_5&#45;&gt;ring_attn_1_13_stage_6</title>
<path fill="none" stroke="black" d="M7856,-13588.87C7856,-13588.87 7856,-13482.25 7856,-13482.25"/>
<polygon fill="black" stroke="black" points="7859.5,-13482.25 7856,-13472.25 7852.5,-13482.25 7859.5,-13482.25"/>
</g>
<!-- ring_attn_1_14_stage_5 -->
<g id="node1405" class="node">
<title>ring_attn_1_14_stage_5</title>
<polygon fill="yellow" stroke="black" points="8443,-13725 8234,-13657 8443,-13589 8652,-13657 8443,-13725"/>
<text text-anchor="middle" x="8443" y="-13675.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-13660.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="8443" y="-13645.8" font-family="Times,serif" font-size="14.00">Q[14]×K[9]×V[9]</text>
<text text-anchor="middle" x="8443" y="-13630.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_13_stage_5&#45;&gt;ring_attn_1_14_stage_5 -->
<g id="edge2406" class="edge">
<title>ring_attn_1_13_stage_5&#45;&gt;ring_attn_1_14_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-13657C8065.02,-13657 8223.86,-13657 8223.86,-13657"/>
<polygon fill="red" stroke="red" points="8223.86,-13660.5 8233.86,-13657 8223.86,-13653.5 8223.86,-13660.5"/>
</g>
<!-- ring_attn_1_13_stage_6&#45;&gt;ring_attn_1_13_stage_7 -->
<g id="edge1295" class="edge">
<title>ring_attn_1_13_stage_6&#45;&gt;ring_attn_1_13_stage_7</title>
<path fill="none" stroke="black" d="M7856,-13335.87C7856,-13335.87 7856,-13229.25 7856,-13229.25"/>
<polygon fill="black" stroke="black" points="7859.5,-13229.25 7856,-13219.25 7852.5,-13229.25 7859.5,-13229.25"/>
</g>
<!-- ring_attn_1_14_stage_6 -->
<g id="node1406" class="node">
<title>ring_attn_1_14_stage_6</title>
<polygon fill="yellow" stroke="black" points="8443,-13472 8234,-13404 8443,-13336 8652,-13404 8443,-13472"/>
<text text-anchor="middle" x="8443" y="-13422.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-13407.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="8443" y="-13392.8" font-family="Times,serif" font-size="14.00">Q[14]×K[8]×V[8]</text>
<text text-anchor="middle" x="8443" y="-13377.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_13_stage_6&#45;&gt;ring_attn_1_14_stage_6 -->
<g id="edge2407" class="edge">
<title>ring_attn_1_13_stage_6&#45;&gt;ring_attn_1_14_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-13404C8065.02,-13404 8223.86,-13404 8223.86,-13404"/>
<polygon fill="red" stroke="red" points="8223.86,-13407.5 8233.86,-13404 8223.86,-13400.5 8223.86,-13407.5"/>
</g>
<!-- ring_attn_1_13_stage_7&#45;&gt;ring_attn_1_13_stage_8 -->
<g id="edge1296" class="edge">
<title>ring_attn_1_13_stage_7&#45;&gt;ring_attn_1_13_stage_8</title>
<path fill="none" stroke="black" d="M7856,-13082.87C7856,-13082.87 7856,-12976.25 7856,-12976.25"/>
<polygon fill="black" stroke="black" points="7859.5,-12976.25 7856,-12966.25 7852.5,-12976.25 7859.5,-12976.25"/>
</g>
<!-- ring_attn_1_14_stage_7 -->
<g id="node1407" class="node">
<title>ring_attn_1_14_stage_7</title>
<polygon fill="yellow" stroke="black" points="8443,-13219 8234,-13151 8443,-13083 8652,-13151 8443,-13219"/>
<text text-anchor="middle" x="8443" y="-13169.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-13154.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="8443" y="-13139.8" font-family="Times,serif" font-size="14.00">Q[14]×K[7]×V[7]</text>
<text text-anchor="middle" x="8443" y="-13124.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_13_stage_7&#45;&gt;ring_attn_1_14_stage_7 -->
<g id="edge2408" class="edge">
<title>ring_attn_1_13_stage_7&#45;&gt;ring_attn_1_14_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-13151C8065.02,-13151 8223.86,-13151 8223.86,-13151"/>
<polygon fill="red" stroke="red" points="8223.86,-13154.5 8233.86,-13151 8223.86,-13147.5 8223.86,-13154.5"/>
</g>
<!-- ring_attn_1_13_stage_8&#45;&gt;ring_attn_1_13_stage_9 -->
<g id="edge1297" class="edge">
<title>ring_attn_1_13_stage_8&#45;&gt;ring_attn_1_13_stage_9</title>
<path fill="none" stroke="black" d="M7856,-12829.87C7856,-12829.87 7856,-12723.25 7856,-12723.25"/>
<polygon fill="black" stroke="black" points="7859.5,-12723.25 7856,-12713.25 7852.5,-12723.25 7859.5,-12723.25"/>
</g>
<!-- ring_attn_1_14_stage_8 -->
<g id="node1408" class="node">
<title>ring_attn_1_14_stage_8</title>
<polygon fill="yellow" stroke="black" points="8443,-12966 8234,-12898 8443,-12830 8652,-12898 8443,-12966"/>
<text text-anchor="middle" x="8443" y="-12916.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-12901.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="8443" y="-12886.8" font-family="Times,serif" font-size="14.00">Q[14]×K[6]×V[6]</text>
<text text-anchor="middle" x="8443" y="-12871.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_13_stage_8&#45;&gt;ring_attn_1_14_stage_8 -->
<g id="edge2409" class="edge">
<title>ring_attn_1_13_stage_8&#45;&gt;ring_attn_1_14_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-12898C8065.02,-12898 8223.86,-12898 8223.86,-12898"/>
<polygon fill="red" stroke="red" points="8223.86,-12901.5 8233.86,-12898 8223.86,-12894.5 8223.86,-12901.5"/>
</g>
<!-- ring_attn_1_13_stage_9&#45;&gt;ring_attn_1_13_stage_10 -->
<g id="edge1298" class="edge">
<title>ring_attn_1_13_stage_9&#45;&gt;ring_attn_1_13_stage_10</title>
<path fill="none" stroke="black" d="M7856,-12576.87C7856,-12576.87 7856,-12470.25 7856,-12470.25"/>
<polygon fill="black" stroke="black" points="7859.5,-12470.25 7856,-12460.25 7852.5,-12470.25 7859.5,-12470.25"/>
</g>
<!-- ring_attn_1_14_stage_9 -->
<g id="node1409" class="node">
<title>ring_attn_1_14_stage_9</title>
<polygon fill="yellow" stroke="black" points="8443,-12713 8234,-12645 8443,-12577 8652,-12645 8443,-12713"/>
<text text-anchor="middle" x="8443" y="-12663.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-12648.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="8443" y="-12633.8" font-family="Times,serif" font-size="14.00">Q[14]×K[5]×V[5]</text>
<text text-anchor="middle" x="8443" y="-12618.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_13_stage_9&#45;&gt;ring_attn_1_14_stage_9 -->
<g id="edge2410" class="edge">
<title>ring_attn_1_13_stage_9&#45;&gt;ring_attn_1_14_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-12645C8065.02,-12645 8223.86,-12645 8223.86,-12645"/>
<polygon fill="red" stroke="red" points="8223.86,-12648.5 8233.86,-12645 8223.86,-12641.5 8223.86,-12648.5"/>
</g>
<!-- ring_attn_1_13_stage_10&#45;&gt;ring_attn_1_13_stage_11 -->
<g id="edge1299" class="edge">
<title>ring_attn_1_13_stage_10&#45;&gt;ring_attn_1_13_stage_11</title>
<path fill="none" stroke="black" d="M7856,-12323.87C7856,-12323.87 7856,-12217.25 7856,-12217.25"/>
<polygon fill="black" stroke="black" points="7859.5,-12217.25 7856,-12207.25 7852.5,-12217.25 7859.5,-12217.25"/>
</g>
<!-- ring_attn_1_14_stage_10 -->
<g id="node1410" class="node">
<title>ring_attn_1_14_stage_10</title>
<polygon fill="yellow" stroke="black" points="8443,-12460 8234,-12392 8443,-12324 8652,-12392 8443,-12460"/>
<text text-anchor="middle" x="8443" y="-12410.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-12395.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="8443" y="-12380.8" font-family="Times,serif" font-size="14.00">Q[14]×K[4]×V[4]</text>
<text text-anchor="middle" x="8443" y="-12365.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_13_stage_10&#45;&gt;ring_attn_1_14_stage_10 -->
<g id="edge2411" class="edge">
<title>ring_attn_1_13_stage_10&#45;&gt;ring_attn_1_14_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-12392C8065.02,-12392 8223.86,-12392 8223.86,-12392"/>
<polygon fill="red" stroke="red" points="8223.86,-12395.5 8233.86,-12392 8223.86,-12388.5 8223.86,-12395.5"/>
</g>
<!-- ring_attn_1_13_stage_11&#45;&gt;ring_attn_1_13_stage_12 -->
<g id="edge1300" class="edge">
<title>ring_attn_1_13_stage_11&#45;&gt;ring_attn_1_13_stage_12</title>
<path fill="none" stroke="black" d="M7856,-12070.87C7856,-12070.87 7856,-11964.25 7856,-11964.25"/>
<polygon fill="black" stroke="black" points="7859.5,-11964.25 7856,-11954.25 7852.5,-11964.25 7859.5,-11964.25"/>
</g>
<!-- ring_attn_1_14_stage_11 -->
<g id="node1411" class="node">
<title>ring_attn_1_14_stage_11</title>
<polygon fill="yellow" stroke="black" points="8443,-12207 8234,-12139 8443,-12071 8652,-12139 8443,-12207"/>
<text text-anchor="middle" x="8443" y="-12157.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-12142.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="8443" y="-12127.8" font-family="Times,serif" font-size="14.00">Q[14]×K[3]×V[3]</text>
<text text-anchor="middle" x="8443" y="-12112.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_13_stage_11&#45;&gt;ring_attn_1_14_stage_11 -->
<g id="edge2412" class="edge">
<title>ring_attn_1_13_stage_11&#45;&gt;ring_attn_1_14_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-12139C8065.02,-12139 8223.86,-12139 8223.86,-12139"/>
<polygon fill="red" stroke="red" points="8223.86,-12142.5 8233.86,-12139 8223.86,-12135.5 8223.86,-12142.5"/>
</g>
<!-- ring_attn_1_13_stage_12&#45;&gt;ring_attn_1_13_stage_13 -->
<g id="edge1301" class="edge">
<title>ring_attn_1_13_stage_12&#45;&gt;ring_attn_1_13_stage_13</title>
<path fill="none" stroke="black" d="M7856,-11817.87C7856,-11817.87 7856,-11711.25 7856,-11711.25"/>
<polygon fill="black" stroke="black" points="7859.5,-11711.25 7856,-11701.25 7852.5,-11711.25 7859.5,-11711.25"/>
</g>
<!-- ring_attn_1_14_stage_12 -->
<g id="node1412" class="node">
<title>ring_attn_1_14_stage_12</title>
<polygon fill="yellow" stroke="black" points="8443,-11954 8234,-11886 8443,-11818 8652,-11886 8443,-11954"/>
<text text-anchor="middle" x="8443" y="-11904.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-11889.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="8443" y="-11874.8" font-family="Times,serif" font-size="14.00">Q[14]×K[2]×V[2]</text>
<text text-anchor="middle" x="8443" y="-11859.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_13_stage_12&#45;&gt;ring_attn_1_14_stage_12 -->
<g id="edge2413" class="edge">
<title>ring_attn_1_13_stage_12&#45;&gt;ring_attn_1_14_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-11886C8065.02,-11886 8223.86,-11886 8223.86,-11886"/>
<polygon fill="red" stroke="red" points="8223.86,-11889.5 8233.86,-11886 8223.86,-11882.5 8223.86,-11889.5"/>
</g>
<!-- ring_attn_1_13_stage_13&#45;&gt;ring_attn_1_13_stage_14 -->
<g id="edge1302" class="edge">
<title>ring_attn_1_13_stage_13&#45;&gt;ring_attn_1_13_stage_14</title>
<path fill="none" stroke="black" d="M7856,-11564.87C7856,-11564.87 7856,-11458.25 7856,-11458.25"/>
<polygon fill="black" stroke="black" points="7859.5,-11458.25 7856,-11448.25 7852.5,-11458.25 7859.5,-11458.25"/>
</g>
<!-- ring_attn_1_14_stage_13 -->
<g id="node1413" class="node">
<title>ring_attn_1_14_stage_13</title>
<polygon fill="yellow" stroke="black" points="8443,-11701 8234,-11633 8443,-11565 8652,-11633 8443,-11701"/>
<text text-anchor="middle" x="8443" y="-11651.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-11636.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="8443" y="-11621.8" font-family="Times,serif" font-size="14.00">Q[14]×K[1]×V[1]</text>
<text text-anchor="middle" x="8443" y="-11606.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_13_stage_13&#45;&gt;ring_attn_1_14_stage_13 -->
<g id="edge2414" class="edge">
<title>ring_attn_1_13_stage_13&#45;&gt;ring_attn_1_14_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-11633C8065.02,-11633 8223.86,-11633 8223.86,-11633"/>
<polygon fill="red" stroke="red" points="8223.86,-11636.5 8233.86,-11633 8223.86,-11629.5 8223.86,-11636.5"/>
</g>
<!-- ring_attn_1_13_stage_14&#45;&gt;ring_attn_1_13_stage_15 -->
<g id="edge1303" class="edge">
<title>ring_attn_1_13_stage_14&#45;&gt;ring_attn_1_13_stage_15</title>
<path fill="none" stroke="black" d="M7856,-11311.87C7856,-11311.87 7856,-11205.25 7856,-11205.25"/>
<polygon fill="black" stroke="black" points="7859.5,-11205.25 7856,-11195.25 7852.5,-11205.25 7859.5,-11205.25"/>
</g>
<!-- ring_attn_1_14_stage_14 -->
<g id="node1414" class="node">
<title>ring_attn_1_14_stage_14</title>
<polygon fill="yellow" stroke="black" points="8443,-11448 8234,-11380 8443,-11312 8652,-11380 8443,-11448"/>
<text text-anchor="middle" x="8443" y="-11398.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-11383.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="8443" y="-11368.8" font-family="Times,serif" font-size="14.00">Q[14]×K[0]×V[0]</text>
<text text-anchor="middle" x="8443" y="-11353.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_13_stage_14&#45;&gt;ring_attn_1_14_stage_14 -->
<g id="edge2415" class="edge">
<title>ring_attn_1_13_stage_14&#45;&gt;ring_attn_1_14_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-11380C8065.02,-11380 8223.86,-11380 8223.86,-11380"/>
<polygon fill="red" stroke="red" points="8223.86,-11383.5 8233.86,-11380 8223.86,-11376.5 8223.86,-11383.5"/>
</g>
<!-- attn_out_1_13 -->
<g id="node1318" class="node">
<title>attn_out_1_13</title>
<polygon fill="none" stroke="black" points="7925.5,-10986 7786.5,-10986 7786.5,-10933 7925.5,-10933 7925.5,-10986"/>
<text text-anchor="middle" x="7856" y="-10970.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="7856" y="-10955.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="7856" y="-10940.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_1_13_stage_15&#45;&gt;attn_out_1_13 -->
<g id="edge1304" class="edge">
<title>ring_attn_1_13_stage_15&#45;&gt;attn_out_1_13</title>
<path fill="none" stroke="black" d="M7856,-11058.87C7856,-11058.87 7856,-10996.18 7856,-10996.18"/>
<polygon fill="black" stroke="black" points="7859.5,-10996.18 7856,-10986.18 7852.5,-10996.18 7859.5,-10996.18"/>
</g>
<!-- ring_attn_1_14_stage_15 -->
<g id="node1415" class="node">
<title>ring_attn_1_14_stage_15</title>
<polygon fill="yellow" stroke="black" points="8443,-11195 8234,-11127 8443,-11059 8652,-11127 8443,-11195"/>
<text text-anchor="middle" x="8443" y="-11145.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-11130.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="8443" y="-11115.8" font-family="Times,serif" font-size="14.00">Q[14]×K[15]×V[15]</text>
<text text-anchor="middle" x="8443" y="-11100.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_13_stage_15&#45;&gt;ring_attn_1_14_stage_15 -->
<g id="edge2416" class="edge">
<title>ring_attn_1_13_stage_15&#45;&gt;ring_attn_1_14_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-11127C8065.02,-11127 8223.86,-11127 8223.86,-11127"/>
<polygon fill="red" stroke="red" points="8223.86,-11130.5 8233.86,-11127 8223.86,-11123.5 8223.86,-11130.5"/>
</g>
<!-- attn_residual_1_13 -->
<g id="node1319" class="node">
<title>attn_residual_1_13</title>
<ellipse fill="none" stroke="black" cx="7856" cy="-10833" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7856" y="-10836.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="7856" y="-10821.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_1_13&#45;&gt;attn_residual_1_13 -->
<g id="edge1305" class="edge">
<title>attn_out_1_13&#45;&gt;attn_residual_1_13</title>
<path fill="none" stroke="black" d="M7856,-10932.98C7856,-10932.98 7856,-10870.36 7856,-10870.36"/>
<polygon fill="black" stroke="black" points="7859.5,-10870.36 7856,-10860.36 7852.5,-10870.36 7859.5,-10870.36"/>
</g>
<!-- ffn_up_1_13 -->
<g id="node1320" class="node">
<title>ffn_up_1_13</title>
<polygon fill="none" stroke="black" points="7935,-10733 7777,-10733 7777,-10680 7935,-10680 7935,-10733"/>
<text text-anchor="middle" x="7856" y="-10717.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7856" y="-10702.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="7856" y="-10687.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_1_13&#45;&gt;ffn_up_1_13 -->
<g id="edge1306" class="edge">
<title>attn_residual_1_13&#45;&gt;ffn_up_1_13</title>
<path fill="none" stroke="black" d="M7856,-10805.86C7856,-10805.86 7856,-10743.16 7856,-10743.16"/>
<polygon fill="black" stroke="black" points="7859.5,-10743.16 7856,-10733.16 7852.5,-10743.16 7859.5,-10743.16"/>
</g>
<!-- ffn_gelu_1_13 -->
<g id="node1321" class="node">
<title>ffn_gelu_1_13</title>
<ellipse fill="none" stroke="black" cx="7856" cy="-10580" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7856" y="-10583.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7856" y="-10568.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_1_13&#45;&gt;ffn_gelu_1_13 -->
<g id="edge1307" class="edge">
<title>ffn_up_1_13&#45;&gt;ffn_gelu_1_13</title>
<path fill="none" stroke="black" d="M7856,-10679.98C7856,-10679.98 7856,-10617.36 7856,-10617.36"/>
<polygon fill="black" stroke="black" points="7859.5,-10617.36 7856,-10607.36 7852.5,-10617.36 7859.5,-10617.36"/>
</g>
<!-- ffn_down_1_13 -->
<g id="node1322" class="node">
<title>ffn_down_1_13</title>
<polygon fill="none" stroke="black" points="7945,-10480 7767,-10480 7767,-10427 7945,-10427 7945,-10480"/>
<text text-anchor="middle" x="7856" y="-10464.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7856" y="-10449.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="7856" y="-10434.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_1_13&#45;&gt;ffn_down_1_13 -->
<g id="edge1308" class="edge">
<title>ffn_gelu_1_13&#45;&gt;ffn_down_1_13</title>
<path fill="none" stroke="black" d="M7856,-10552.86C7856,-10552.86 7856,-10490.16 7856,-10490.16"/>
<polygon fill="black" stroke="black" points="7859.5,-10490.16 7856,-10480.16 7852.5,-10490.16 7859.5,-10490.16"/>
</g>
<!-- ffn_residual_1_13 -->
<g id="node1323" class="node">
<title>ffn_residual_1_13</title>
<ellipse fill="none" stroke="black" cx="7856" cy="-10327" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7856" y="-10330.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="7856" y="-10315.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_1_13&#45;&gt;ffn_residual_1_13 -->
<g id="edge1309" class="edge">
<title>ffn_down_1_13&#45;&gt;ffn_residual_1_13</title>
<path fill="none" stroke="black" d="M7856,-10426.98C7856,-10426.98 7856,-10364.36 7856,-10364.36"/>
<polygon fill="black" stroke="black" points="7859.5,-10364.36 7856,-10354.36 7852.5,-10364.36 7859.5,-10364.36"/>
</g>
<!-- qkv_proj_2_13 -->
<g id="node1324" class="node">
<title>qkv_proj_2_13</title>
<polygon fill="none" stroke="black" points="7938.5,-10227 7773.5,-10227 7773.5,-10174 7938.5,-10174 7938.5,-10227"/>
<text text-anchor="middle" x="7856" y="-10211.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7856" y="-10196.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="7856" y="-10181.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_1_13&#45;&gt;qkv_proj_2_13 -->
<g id="edge1310" class="edge">
<title>ffn_residual_1_13&#45;&gt;qkv_proj_2_13</title>
<path fill="none" stroke="black" d="M7856,-10299.86C7856,-10299.86 7856,-10237.16 7856,-10237.16"/>
<polygon fill="black" stroke="black" points="7859.5,-10237.16 7856,-10227.16 7852.5,-10237.16 7859.5,-10237.16"/>
</g>
<!-- qkv_reshape_2_13 -->
<g id="node1325" class="node">
<title>qkv_reshape_2_13</title>
<ellipse fill="none" stroke="black" cx="7856" cy="-10074" rx="148" ry="27"/>
<text text-anchor="middle" x="7856" y="-10077.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="7856" y="-10062.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_2_13&#45;&gt;qkv_reshape_2_13 -->
<g id="edge1311" class="edge">
<title>qkv_proj_2_13&#45;&gt;qkv_reshape_2_13</title>
<path fill="none" stroke="black" d="M7856,-10173.98C7856,-10173.98 7856,-10111.36 7856,-10111.36"/>
<polygon fill="black" stroke="black" points="7859.5,-10111.36 7856,-10101.36 7852.5,-10111.36 7859.5,-10111.36"/>
</g>
<!-- qkv_reshape_2_13&#45;&gt;ring_attn_2_13_stage_0 -->
<g id="edge1312" class="edge">
<title>qkv_reshape_2_13&#45;&gt;ring_attn_2_13_stage_0</title>
<path fill="none" stroke="black" d="M7856,-10046.72C7856,-10046.72 7856,-9940.16 7856,-9940.16"/>
<polygon fill="black" stroke="black" points="7859.5,-9940.16 7856,-9930.16 7852.5,-9940.16 7859.5,-9940.16"/>
</g>
<!-- ring_attn_2_13_stage_0&#45;&gt;ring_attn_2_13_stage_1 -->
<g id="edge1313" class="edge">
<title>ring_attn_2_13_stage_0&#45;&gt;ring_attn_2_13_stage_1</title>
<path fill="none" stroke="black" d="M7856,-9793.87C7856,-9793.87 7856,-9687.25 7856,-9687.25"/>
<polygon fill="black" stroke="black" points="7859.5,-9687.25 7856,-9677.25 7852.5,-9687.25 7859.5,-9687.25"/>
</g>
<!-- ring_attn_2_14_stage_0 -->
<g id="node1424" class="node">
<title>ring_attn_2_14_stage_0</title>
<polygon fill="yellow" stroke="black" points="8443,-9930 8234,-9862 8443,-9794 8652,-9862 8443,-9930"/>
<text text-anchor="middle" x="8443" y="-9880.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-9865.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="8443" y="-9850.8" font-family="Times,serif" font-size="14.00">Q[14]×K[14]×V[14]</text>
<text text-anchor="middle" x="8443" y="-9835.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_13_stage_0&#45;&gt;ring_attn_2_14_stage_0 -->
<g id="edge2417" class="edge">
<title>ring_attn_2_13_stage_0&#45;&gt;ring_attn_2_14_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-9862C8065.02,-9862 8223.86,-9862 8223.86,-9862"/>
<polygon fill="red" stroke="red" points="8223.86,-9865.5 8233.86,-9862 8223.86,-9858.5 8223.86,-9865.5"/>
</g>
<!-- ring_attn_2_13_stage_1&#45;&gt;ring_attn_2_13_stage_2 -->
<g id="edge1314" class="edge">
<title>ring_attn_2_13_stage_1&#45;&gt;ring_attn_2_13_stage_2</title>
<path fill="none" stroke="black" d="M7856,-9540.87C7856,-9540.87 7856,-9434.25 7856,-9434.25"/>
<polygon fill="black" stroke="black" points="7859.5,-9434.25 7856,-9424.25 7852.5,-9434.25 7859.5,-9434.25"/>
</g>
<!-- ring_attn_2_14_stage_1 -->
<g id="node1425" class="node">
<title>ring_attn_2_14_stage_1</title>
<polygon fill="yellow" stroke="black" points="8443,-9677 8234,-9609 8443,-9541 8652,-9609 8443,-9677"/>
<text text-anchor="middle" x="8443" y="-9627.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-9612.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="8443" y="-9597.8" font-family="Times,serif" font-size="14.00">Q[14]×K[13]×V[13]</text>
<text text-anchor="middle" x="8443" y="-9582.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_13_stage_1&#45;&gt;ring_attn_2_14_stage_1 -->
<g id="edge2418" class="edge">
<title>ring_attn_2_13_stage_1&#45;&gt;ring_attn_2_14_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-9609C8065.02,-9609 8223.86,-9609 8223.86,-9609"/>
<polygon fill="red" stroke="red" points="8223.86,-9612.5 8233.86,-9609 8223.86,-9605.5 8223.86,-9612.5"/>
</g>
<!-- ring_attn_2_13_stage_2&#45;&gt;ring_attn_2_13_stage_3 -->
<g id="edge1315" class="edge">
<title>ring_attn_2_13_stage_2&#45;&gt;ring_attn_2_13_stage_3</title>
<path fill="none" stroke="black" d="M7856,-9287.87C7856,-9287.87 7856,-9181.25 7856,-9181.25"/>
<polygon fill="black" stroke="black" points="7859.5,-9181.25 7856,-9171.25 7852.5,-9181.25 7859.5,-9181.25"/>
</g>
<!-- ring_attn_2_14_stage_2 -->
<g id="node1426" class="node">
<title>ring_attn_2_14_stage_2</title>
<polygon fill="yellow" stroke="black" points="8443,-9424 8234,-9356 8443,-9288 8652,-9356 8443,-9424"/>
<text text-anchor="middle" x="8443" y="-9374.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-9359.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="8443" y="-9344.8" font-family="Times,serif" font-size="14.00">Q[14]×K[12]×V[12]</text>
<text text-anchor="middle" x="8443" y="-9329.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_13_stage_2&#45;&gt;ring_attn_2_14_stage_2 -->
<g id="edge2419" class="edge">
<title>ring_attn_2_13_stage_2&#45;&gt;ring_attn_2_14_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-9356C8065.02,-9356 8223.86,-9356 8223.86,-9356"/>
<polygon fill="red" stroke="red" points="8223.86,-9359.5 8233.86,-9356 8223.86,-9352.5 8223.86,-9359.5"/>
</g>
<!-- ring_attn_2_13_stage_3&#45;&gt;ring_attn_2_13_stage_4 -->
<g id="edge1316" class="edge">
<title>ring_attn_2_13_stage_3&#45;&gt;ring_attn_2_13_stage_4</title>
<path fill="none" stroke="black" d="M7856,-9034.87C7856,-9034.87 7856,-8928.25 7856,-8928.25"/>
<polygon fill="black" stroke="black" points="7859.5,-8928.25 7856,-8918.25 7852.5,-8928.25 7859.5,-8928.25"/>
</g>
<!-- ring_attn_2_14_stage_3 -->
<g id="node1427" class="node">
<title>ring_attn_2_14_stage_3</title>
<polygon fill="yellow" stroke="black" points="8443,-9171 8234,-9103 8443,-9035 8652,-9103 8443,-9171"/>
<text text-anchor="middle" x="8443" y="-9121.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-9106.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="8443" y="-9091.8" font-family="Times,serif" font-size="14.00">Q[14]×K[11]×V[11]</text>
<text text-anchor="middle" x="8443" y="-9076.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_13_stage_3&#45;&gt;ring_attn_2_14_stage_3 -->
<g id="edge2420" class="edge">
<title>ring_attn_2_13_stage_3&#45;&gt;ring_attn_2_14_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-9103C8065.02,-9103 8223.86,-9103 8223.86,-9103"/>
<polygon fill="red" stroke="red" points="8223.86,-9106.5 8233.86,-9103 8223.86,-9099.5 8223.86,-9106.5"/>
</g>
<!-- ring_attn_2_13_stage_4&#45;&gt;ring_attn_2_13_stage_5 -->
<g id="edge1317" class="edge">
<title>ring_attn_2_13_stage_4&#45;&gt;ring_attn_2_13_stage_5</title>
<path fill="none" stroke="black" d="M7856,-8781.87C7856,-8781.87 7856,-8675.25 7856,-8675.25"/>
<polygon fill="black" stroke="black" points="7859.5,-8675.25 7856,-8665.25 7852.5,-8675.25 7859.5,-8675.25"/>
</g>
<!-- ring_attn_2_14_stage_4 -->
<g id="node1428" class="node">
<title>ring_attn_2_14_stage_4</title>
<polygon fill="yellow" stroke="black" points="8443,-8918 8234,-8850 8443,-8782 8652,-8850 8443,-8918"/>
<text text-anchor="middle" x="8443" y="-8868.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-8853.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="8443" y="-8838.8" font-family="Times,serif" font-size="14.00">Q[14]×K[10]×V[10]</text>
<text text-anchor="middle" x="8443" y="-8823.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_13_stage_4&#45;&gt;ring_attn_2_14_stage_4 -->
<g id="edge2421" class="edge">
<title>ring_attn_2_13_stage_4&#45;&gt;ring_attn_2_14_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-8850C8065.02,-8850 8223.86,-8850 8223.86,-8850"/>
<polygon fill="red" stroke="red" points="8223.86,-8853.5 8233.86,-8850 8223.86,-8846.5 8223.86,-8853.5"/>
</g>
<!-- ring_attn_2_13_stage_5&#45;&gt;ring_attn_2_13_stage_6 -->
<g id="edge1318" class="edge">
<title>ring_attn_2_13_stage_5&#45;&gt;ring_attn_2_13_stage_6</title>
<path fill="none" stroke="black" d="M7856,-8528.87C7856,-8528.87 7856,-8422.25 7856,-8422.25"/>
<polygon fill="black" stroke="black" points="7859.5,-8422.25 7856,-8412.25 7852.5,-8422.25 7859.5,-8422.25"/>
</g>
<!-- ring_attn_2_14_stage_5 -->
<g id="node1429" class="node">
<title>ring_attn_2_14_stage_5</title>
<polygon fill="yellow" stroke="black" points="8443,-8665 8234,-8597 8443,-8529 8652,-8597 8443,-8665"/>
<text text-anchor="middle" x="8443" y="-8615.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-8600.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="8443" y="-8585.8" font-family="Times,serif" font-size="14.00">Q[14]×K[9]×V[9]</text>
<text text-anchor="middle" x="8443" y="-8570.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_13_stage_5&#45;&gt;ring_attn_2_14_stage_5 -->
<g id="edge2422" class="edge">
<title>ring_attn_2_13_stage_5&#45;&gt;ring_attn_2_14_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-8597C8065.02,-8597 8223.86,-8597 8223.86,-8597"/>
<polygon fill="red" stroke="red" points="8223.86,-8600.5 8233.86,-8597 8223.86,-8593.5 8223.86,-8600.5"/>
</g>
<!-- ring_attn_2_13_stage_6&#45;&gt;ring_attn_2_13_stage_7 -->
<g id="edge1319" class="edge">
<title>ring_attn_2_13_stage_6&#45;&gt;ring_attn_2_13_stage_7</title>
<path fill="none" stroke="black" d="M7856,-8275.87C7856,-8275.87 7856,-8169.25 7856,-8169.25"/>
<polygon fill="black" stroke="black" points="7859.5,-8169.25 7856,-8159.25 7852.5,-8169.25 7859.5,-8169.25"/>
</g>
<!-- ring_attn_2_14_stage_6 -->
<g id="node1430" class="node">
<title>ring_attn_2_14_stage_6</title>
<polygon fill="yellow" stroke="black" points="8443,-8412 8234,-8344 8443,-8276 8652,-8344 8443,-8412"/>
<text text-anchor="middle" x="8443" y="-8362.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-8347.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="8443" y="-8332.8" font-family="Times,serif" font-size="14.00">Q[14]×K[8]×V[8]</text>
<text text-anchor="middle" x="8443" y="-8317.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_13_stage_6&#45;&gt;ring_attn_2_14_stage_6 -->
<g id="edge2423" class="edge">
<title>ring_attn_2_13_stage_6&#45;&gt;ring_attn_2_14_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-8344C8065.02,-8344 8223.86,-8344 8223.86,-8344"/>
<polygon fill="red" stroke="red" points="8223.86,-8347.5 8233.86,-8344 8223.86,-8340.5 8223.86,-8347.5"/>
</g>
<!-- ring_attn_2_13_stage_7&#45;&gt;ring_attn_2_13_stage_8 -->
<g id="edge1320" class="edge">
<title>ring_attn_2_13_stage_7&#45;&gt;ring_attn_2_13_stage_8</title>
<path fill="none" stroke="black" d="M7856,-8022.87C7856,-8022.87 7856,-7916.25 7856,-7916.25"/>
<polygon fill="black" stroke="black" points="7859.5,-7916.25 7856,-7906.25 7852.5,-7916.25 7859.5,-7916.25"/>
</g>
<!-- ring_attn_2_14_stage_7 -->
<g id="node1431" class="node">
<title>ring_attn_2_14_stage_7</title>
<polygon fill="yellow" stroke="black" points="8443,-8159 8234,-8091 8443,-8023 8652,-8091 8443,-8159"/>
<text text-anchor="middle" x="8443" y="-8109.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-8094.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="8443" y="-8079.8" font-family="Times,serif" font-size="14.00">Q[14]×K[7]×V[7]</text>
<text text-anchor="middle" x="8443" y="-8064.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_13_stage_7&#45;&gt;ring_attn_2_14_stage_7 -->
<g id="edge2424" class="edge">
<title>ring_attn_2_13_stage_7&#45;&gt;ring_attn_2_14_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-8091C8065.02,-8091 8223.86,-8091 8223.86,-8091"/>
<polygon fill="red" stroke="red" points="8223.86,-8094.5 8233.86,-8091 8223.86,-8087.5 8223.86,-8094.5"/>
</g>
<!-- ring_attn_2_13_stage_8&#45;&gt;ring_attn_2_13_stage_9 -->
<g id="edge1321" class="edge">
<title>ring_attn_2_13_stage_8&#45;&gt;ring_attn_2_13_stage_9</title>
<path fill="none" stroke="black" d="M7856,-7769.87C7856,-7769.87 7856,-7663.25 7856,-7663.25"/>
<polygon fill="black" stroke="black" points="7859.5,-7663.25 7856,-7653.25 7852.5,-7663.25 7859.5,-7663.25"/>
</g>
<!-- ring_attn_2_14_stage_8 -->
<g id="node1432" class="node">
<title>ring_attn_2_14_stage_8</title>
<polygon fill="yellow" stroke="black" points="8443,-7906 8234,-7838 8443,-7770 8652,-7838 8443,-7906"/>
<text text-anchor="middle" x="8443" y="-7856.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-7841.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="8443" y="-7826.8" font-family="Times,serif" font-size="14.00">Q[14]×K[6]×V[6]</text>
<text text-anchor="middle" x="8443" y="-7811.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_13_stage_8&#45;&gt;ring_attn_2_14_stage_8 -->
<g id="edge2425" class="edge">
<title>ring_attn_2_13_stage_8&#45;&gt;ring_attn_2_14_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-7838C8065.02,-7838 8223.86,-7838 8223.86,-7838"/>
<polygon fill="red" stroke="red" points="8223.86,-7841.5 8233.86,-7838 8223.86,-7834.5 8223.86,-7841.5"/>
</g>
<!-- ring_attn_2_13_stage_9&#45;&gt;ring_attn_2_13_stage_10 -->
<g id="edge1322" class="edge">
<title>ring_attn_2_13_stage_9&#45;&gt;ring_attn_2_13_stage_10</title>
<path fill="none" stroke="black" d="M7856,-7516.87C7856,-7516.87 7856,-7410.25 7856,-7410.25"/>
<polygon fill="black" stroke="black" points="7859.5,-7410.25 7856,-7400.25 7852.5,-7410.25 7859.5,-7410.25"/>
</g>
<!-- ring_attn_2_14_stage_9 -->
<g id="node1433" class="node">
<title>ring_attn_2_14_stage_9</title>
<polygon fill="yellow" stroke="black" points="8443,-7653 8234,-7585 8443,-7517 8652,-7585 8443,-7653"/>
<text text-anchor="middle" x="8443" y="-7603.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-7588.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="8443" y="-7573.8" font-family="Times,serif" font-size="14.00">Q[14]×K[5]×V[5]</text>
<text text-anchor="middle" x="8443" y="-7558.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_13_stage_9&#45;&gt;ring_attn_2_14_stage_9 -->
<g id="edge2426" class="edge">
<title>ring_attn_2_13_stage_9&#45;&gt;ring_attn_2_14_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-7585C8065.02,-7585 8223.86,-7585 8223.86,-7585"/>
<polygon fill="red" stroke="red" points="8223.86,-7588.5 8233.86,-7585 8223.86,-7581.5 8223.86,-7588.5"/>
</g>
<!-- ring_attn_2_13_stage_10&#45;&gt;ring_attn_2_13_stage_11 -->
<g id="edge1323" class="edge">
<title>ring_attn_2_13_stage_10&#45;&gt;ring_attn_2_13_stage_11</title>
<path fill="none" stroke="black" d="M7856,-7263.87C7856,-7263.87 7856,-7157.25 7856,-7157.25"/>
<polygon fill="black" stroke="black" points="7859.5,-7157.25 7856,-7147.25 7852.5,-7157.25 7859.5,-7157.25"/>
</g>
<!-- ring_attn_2_14_stage_10 -->
<g id="node1434" class="node">
<title>ring_attn_2_14_stage_10</title>
<polygon fill="yellow" stroke="black" points="8443,-7400 8234,-7332 8443,-7264 8652,-7332 8443,-7400"/>
<text text-anchor="middle" x="8443" y="-7350.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-7335.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="8443" y="-7320.8" font-family="Times,serif" font-size="14.00">Q[14]×K[4]×V[4]</text>
<text text-anchor="middle" x="8443" y="-7305.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_13_stage_10&#45;&gt;ring_attn_2_14_stage_10 -->
<g id="edge2427" class="edge">
<title>ring_attn_2_13_stage_10&#45;&gt;ring_attn_2_14_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-7332C8065.02,-7332 8223.86,-7332 8223.86,-7332"/>
<polygon fill="red" stroke="red" points="8223.86,-7335.5 8233.86,-7332 8223.86,-7328.5 8223.86,-7335.5"/>
</g>
<!-- ring_attn_2_13_stage_11&#45;&gt;ring_attn_2_13_stage_12 -->
<g id="edge1324" class="edge">
<title>ring_attn_2_13_stage_11&#45;&gt;ring_attn_2_13_stage_12</title>
<path fill="none" stroke="black" d="M7856,-7010.87C7856,-7010.87 7856,-6904.25 7856,-6904.25"/>
<polygon fill="black" stroke="black" points="7859.5,-6904.25 7856,-6894.25 7852.5,-6904.25 7859.5,-6904.25"/>
</g>
<!-- ring_attn_2_14_stage_11 -->
<g id="node1435" class="node">
<title>ring_attn_2_14_stage_11</title>
<polygon fill="yellow" stroke="black" points="8443,-7147 8234,-7079 8443,-7011 8652,-7079 8443,-7147"/>
<text text-anchor="middle" x="8443" y="-7097.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-7082.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="8443" y="-7067.8" font-family="Times,serif" font-size="14.00">Q[14]×K[3]×V[3]</text>
<text text-anchor="middle" x="8443" y="-7052.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_13_stage_11&#45;&gt;ring_attn_2_14_stage_11 -->
<g id="edge2428" class="edge">
<title>ring_attn_2_13_stage_11&#45;&gt;ring_attn_2_14_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-7079C8065.02,-7079 8223.86,-7079 8223.86,-7079"/>
<polygon fill="red" stroke="red" points="8223.86,-7082.5 8233.86,-7079 8223.86,-7075.5 8223.86,-7082.5"/>
</g>
<!-- ring_attn_2_13_stage_12&#45;&gt;ring_attn_2_13_stage_13 -->
<g id="edge1325" class="edge">
<title>ring_attn_2_13_stage_12&#45;&gt;ring_attn_2_13_stage_13</title>
<path fill="none" stroke="black" d="M7856,-6757.87C7856,-6757.87 7856,-6651.25 7856,-6651.25"/>
<polygon fill="black" stroke="black" points="7859.5,-6651.25 7856,-6641.25 7852.5,-6651.25 7859.5,-6651.25"/>
</g>
<!-- ring_attn_2_14_stage_12 -->
<g id="node1436" class="node">
<title>ring_attn_2_14_stage_12</title>
<polygon fill="yellow" stroke="black" points="8443,-6894 8234,-6826 8443,-6758 8652,-6826 8443,-6894"/>
<text text-anchor="middle" x="8443" y="-6844.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-6829.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="8443" y="-6814.8" font-family="Times,serif" font-size="14.00">Q[14]×K[2]×V[2]</text>
<text text-anchor="middle" x="8443" y="-6799.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_13_stage_12&#45;&gt;ring_attn_2_14_stage_12 -->
<g id="edge2429" class="edge">
<title>ring_attn_2_13_stage_12&#45;&gt;ring_attn_2_14_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-6826C8065.02,-6826 8223.86,-6826 8223.86,-6826"/>
<polygon fill="red" stroke="red" points="8223.86,-6829.5 8233.86,-6826 8223.86,-6822.5 8223.86,-6829.5"/>
</g>
<!-- ring_attn_2_13_stage_13&#45;&gt;ring_attn_2_13_stage_14 -->
<g id="edge1326" class="edge">
<title>ring_attn_2_13_stage_13&#45;&gt;ring_attn_2_13_stage_14</title>
<path fill="none" stroke="black" d="M7856,-6504.87C7856,-6504.87 7856,-6398.25 7856,-6398.25"/>
<polygon fill="black" stroke="black" points="7859.5,-6398.25 7856,-6388.25 7852.5,-6398.25 7859.5,-6398.25"/>
</g>
<!-- ring_attn_2_14_stage_13 -->
<g id="node1437" class="node">
<title>ring_attn_2_14_stage_13</title>
<polygon fill="yellow" stroke="black" points="8443,-6641 8234,-6573 8443,-6505 8652,-6573 8443,-6641"/>
<text text-anchor="middle" x="8443" y="-6591.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-6576.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="8443" y="-6561.8" font-family="Times,serif" font-size="14.00">Q[14]×K[1]×V[1]</text>
<text text-anchor="middle" x="8443" y="-6546.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_13_stage_13&#45;&gt;ring_attn_2_14_stage_13 -->
<g id="edge2430" class="edge">
<title>ring_attn_2_13_stage_13&#45;&gt;ring_attn_2_14_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-6573C8065.02,-6573 8223.86,-6573 8223.86,-6573"/>
<polygon fill="red" stroke="red" points="8223.86,-6576.5 8233.86,-6573 8223.86,-6569.5 8223.86,-6576.5"/>
</g>
<!-- ring_attn_2_13_stage_14&#45;&gt;ring_attn_2_13_stage_15 -->
<g id="edge1327" class="edge">
<title>ring_attn_2_13_stage_14&#45;&gt;ring_attn_2_13_stage_15</title>
<path fill="none" stroke="black" d="M7856,-6251.87C7856,-6251.87 7856,-6145.25 7856,-6145.25"/>
<polygon fill="black" stroke="black" points="7859.5,-6145.25 7856,-6135.25 7852.5,-6145.25 7859.5,-6145.25"/>
</g>
<!-- ring_attn_2_14_stage_14 -->
<g id="node1438" class="node">
<title>ring_attn_2_14_stage_14</title>
<polygon fill="yellow" stroke="black" points="8443,-6388 8234,-6320 8443,-6252 8652,-6320 8443,-6388"/>
<text text-anchor="middle" x="8443" y="-6338.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-6323.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="8443" y="-6308.8" font-family="Times,serif" font-size="14.00">Q[14]×K[0]×V[0]</text>
<text text-anchor="middle" x="8443" y="-6293.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_13_stage_14&#45;&gt;ring_attn_2_14_stage_14 -->
<g id="edge2431" class="edge">
<title>ring_attn_2_13_stage_14&#45;&gt;ring_attn_2_14_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-6320C8065.02,-6320 8223.86,-6320 8223.86,-6320"/>
<polygon fill="red" stroke="red" points="8223.86,-6323.5 8233.86,-6320 8223.86,-6316.5 8223.86,-6323.5"/>
</g>
<!-- attn_out_2_13 -->
<g id="node1342" class="node">
<title>attn_out_2_13</title>
<polygon fill="none" stroke="black" points="7925.5,-5926 7786.5,-5926 7786.5,-5873 7925.5,-5873 7925.5,-5926"/>
<text text-anchor="middle" x="7856" y="-5910.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="7856" y="-5895.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="7856" y="-5880.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_2_13_stage_15&#45;&gt;attn_out_2_13 -->
<g id="edge1328" class="edge">
<title>ring_attn_2_13_stage_15&#45;&gt;attn_out_2_13</title>
<path fill="none" stroke="black" d="M7856,-5998.87C7856,-5998.87 7856,-5936.18 7856,-5936.18"/>
<polygon fill="black" stroke="black" points="7859.5,-5936.18 7856,-5926.18 7852.5,-5936.18 7859.5,-5936.18"/>
</g>
<!-- ring_attn_2_14_stage_15 -->
<g id="node1439" class="node">
<title>ring_attn_2_14_stage_15</title>
<polygon fill="yellow" stroke="black" points="8443,-6135 8234,-6067 8443,-5999 8652,-6067 8443,-6135"/>
<text text-anchor="middle" x="8443" y="-6085.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-6070.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="8443" y="-6055.8" font-family="Times,serif" font-size="14.00">Q[14]×K[15]×V[15]</text>
<text text-anchor="middle" x="8443" y="-6040.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_13_stage_15&#45;&gt;ring_attn_2_14_stage_15 -->
<g id="edge2432" class="edge">
<title>ring_attn_2_13_stage_15&#45;&gt;ring_attn_2_14_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-6067C8065.02,-6067 8223.86,-6067 8223.86,-6067"/>
<polygon fill="red" stroke="red" points="8223.86,-6070.5 8233.86,-6067 8223.86,-6063.5 8223.86,-6070.5"/>
</g>
<!-- attn_residual_2_13 -->
<g id="node1343" class="node">
<title>attn_residual_2_13</title>
<ellipse fill="none" stroke="black" cx="7856" cy="-5773" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7856" y="-5776.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="7856" y="-5761.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_2_13&#45;&gt;attn_residual_2_13 -->
<g id="edge1329" class="edge">
<title>attn_out_2_13&#45;&gt;attn_residual_2_13</title>
<path fill="none" stroke="black" d="M7856,-5872.98C7856,-5872.98 7856,-5810.36 7856,-5810.36"/>
<polygon fill="black" stroke="black" points="7859.5,-5810.36 7856,-5800.36 7852.5,-5810.36 7859.5,-5810.36"/>
</g>
<!-- ffn_up_2_13 -->
<g id="node1344" class="node">
<title>ffn_up_2_13</title>
<polygon fill="none" stroke="black" points="7935,-5673 7777,-5673 7777,-5620 7935,-5620 7935,-5673"/>
<text text-anchor="middle" x="7856" y="-5657.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7856" y="-5642.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="7856" y="-5627.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_2_13&#45;&gt;ffn_up_2_13 -->
<g id="edge1330" class="edge">
<title>attn_residual_2_13&#45;&gt;ffn_up_2_13</title>
<path fill="none" stroke="black" d="M7856,-5745.86C7856,-5745.86 7856,-5683.16 7856,-5683.16"/>
<polygon fill="black" stroke="black" points="7859.5,-5683.16 7856,-5673.16 7852.5,-5683.16 7859.5,-5683.16"/>
</g>
<!-- ffn_gelu_2_13 -->
<g id="node1345" class="node">
<title>ffn_gelu_2_13</title>
<ellipse fill="none" stroke="black" cx="7856" cy="-5520" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7856" y="-5523.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7856" y="-5508.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_2_13&#45;&gt;ffn_gelu_2_13 -->
<g id="edge1331" class="edge">
<title>ffn_up_2_13&#45;&gt;ffn_gelu_2_13</title>
<path fill="none" stroke="black" d="M7856,-5619.98C7856,-5619.98 7856,-5557.36 7856,-5557.36"/>
<polygon fill="black" stroke="black" points="7859.5,-5557.36 7856,-5547.36 7852.5,-5557.36 7859.5,-5557.36"/>
</g>
<!-- ffn_down_2_13 -->
<g id="node1346" class="node">
<title>ffn_down_2_13</title>
<polygon fill="none" stroke="black" points="7945,-5420 7767,-5420 7767,-5367 7945,-5367 7945,-5420"/>
<text text-anchor="middle" x="7856" y="-5404.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7856" y="-5389.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="7856" y="-5374.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_2_13&#45;&gt;ffn_down_2_13 -->
<g id="edge1332" class="edge">
<title>ffn_gelu_2_13&#45;&gt;ffn_down_2_13</title>
<path fill="none" stroke="black" d="M7856,-5492.86C7856,-5492.86 7856,-5430.16 7856,-5430.16"/>
<polygon fill="black" stroke="black" points="7859.5,-5430.16 7856,-5420.16 7852.5,-5430.16 7859.5,-5430.16"/>
</g>
<!-- ffn_residual_2_13 -->
<g id="node1347" class="node">
<title>ffn_residual_2_13</title>
<ellipse fill="none" stroke="black" cx="7856" cy="-5267" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7856" y="-5270.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="7856" y="-5255.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_2_13&#45;&gt;ffn_residual_2_13 -->
<g id="edge1333" class="edge">
<title>ffn_down_2_13&#45;&gt;ffn_residual_2_13</title>
<path fill="none" stroke="black" d="M7856,-5366.98C7856,-5366.98 7856,-5304.36 7856,-5304.36"/>
<polygon fill="black" stroke="black" points="7859.5,-5304.36 7856,-5294.36 7852.5,-5304.36 7859.5,-5304.36"/>
</g>
<!-- qkv_proj_3_13 -->
<g id="node1348" class="node">
<title>qkv_proj_3_13</title>
<polygon fill="none" stroke="black" points="7938.5,-5167 7773.5,-5167 7773.5,-5114 7938.5,-5114 7938.5,-5167"/>
<text text-anchor="middle" x="7856" y="-5151.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7856" y="-5136.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="7856" y="-5121.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_2_13&#45;&gt;qkv_proj_3_13 -->
<g id="edge1334" class="edge">
<title>ffn_residual_2_13&#45;&gt;qkv_proj_3_13</title>
<path fill="none" stroke="black" d="M7856,-5239.86C7856,-5239.86 7856,-5177.16 7856,-5177.16"/>
<polygon fill="black" stroke="black" points="7859.5,-5177.16 7856,-5167.16 7852.5,-5177.16 7859.5,-5177.16"/>
</g>
<!-- qkv_reshape_3_13 -->
<g id="node1349" class="node">
<title>qkv_reshape_3_13</title>
<ellipse fill="none" stroke="black" cx="7856" cy="-5014" rx="148" ry="27"/>
<text text-anchor="middle" x="7856" y="-5017.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="7856" y="-5002.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_3_13&#45;&gt;qkv_reshape_3_13 -->
<g id="edge1335" class="edge">
<title>qkv_proj_3_13&#45;&gt;qkv_reshape_3_13</title>
<path fill="none" stroke="black" d="M7856,-5113.98C7856,-5113.98 7856,-5051.36 7856,-5051.36"/>
<polygon fill="black" stroke="black" points="7859.5,-5051.36 7856,-5041.36 7852.5,-5051.36 7859.5,-5051.36"/>
</g>
<!-- qkv_reshape_3_13&#45;&gt;ring_attn_3_13_stage_0 -->
<g id="edge1336" class="edge">
<title>qkv_reshape_3_13&#45;&gt;ring_attn_3_13_stage_0</title>
<path fill="none" stroke="black" d="M7856,-4986.72C7856,-4986.72 7856,-4880.16 7856,-4880.16"/>
<polygon fill="black" stroke="black" points="7859.5,-4880.16 7856,-4870.16 7852.5,-4880.16 7859.5,-4880.16"/>
</g>
<!-- ring_attn_3_13_stage_0&#45;&gt;ring_attn_3_13_stage_1 -->
<g id="edge1337" class="edge">
<title>ring_attn_3_13_stage_0&#45;&gt;ring_attn_3_13_stage_1</title>
<path fill="none" stroke="black" d="M7856,-4733.87C7856,-4733.87 7856,-4627.25 7856,-4627.25"/>
<polygon fill="black" stroke="black" points="7859.5,-4627.25 7856,-4617.25 7852.5,-4627.25 7859.5,-4627.25"/>
</g>
<!-- ring_attn_3_14_stage_0 -->
<g id="node1448" class="node">
<title>ring_attn_3_14_stage_0</title>
<polygon fill="yellow" stroke="black" points="8443,-4870 8234,-4802 8443,-4734 8652,-4802 8443,-4870"/>
<text text-anchor="middle" x="8443" y="-4820.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-4805.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="8443" y="-4790.8" font-family="Times,serif" font-size="14.00">Q[14]×K[14]×V[14]</text>
<text text-anchor="middle" x="8443" y="-4775.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_13_stage_0&#45;&gt;ring_attn_3_14_stage_0 -->
<g id="edge2433" class="edge">
<title>ring_attn_3_13_stage_0&#45;&gt;ring_attn_3_14_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-4802C8065.02,-4802 8223.86,-4802 8223.86,-4802"/>
<polygon fill="red" stroke="red" points="8223.86,-4805.5 8233.86,-4802 8223.86,-4798.5 8223.86,-4805.5"/>
</g>
<!-- ring_attn_3_13_stage_1&#45;&gt;ring_attn_3_13_stage_2 -->
<g id="edge1338" class="edge">
<title>ring_attn_3_13_stage_1&#45;&gt;ring_attn_3_13_stage_2</title>
<path fill="none" stroke="black" d="M7856,-4480.87C7856,-4480.87 7856,-4374.25 7856,-4374.25"/>
<polygon fill="black" stroke="black" points="7859.5,-4374.25 7856,-4364.25 7852.5,-4374.25 7859.5,-4374.25"/>
</g>
<!-- ring_attn_3_14_stage_1 -->
<g id="node1449" class="node">
<title>ring_attn_3_14_stage_1</title>
<polygon fill="yellow" stroke="black" points="8443,-4617 8234,-4549 8443,-4481 8652,-4549 8443,-4617"/>
<text text-anchor="middle" x="8443" y="-4567.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-4552.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="8443" y="-4537.8" font-family="Times,serif" font-size="14.00">Q[14]×K[13]×V[13]</text>
<text text-anchor="middle" x="8443" y="-4522.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_13_stage_1&#45;&gt;ring_attn_3_14_stage_1 -->
<g id="edge2434" class="edge">
<title>ring_attn_3_13_stage_1&#45;&gt;ring_attn_3_14_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-4549C8065.02,-4549 8223.86,-4549 8223.86,-4549"/>
<polygon fill="red" stroke="red" points="8223.86,-4552.5 8233.86,-4549 8223.86,-4545.5 8223.86,-4552.5"/>
</g>
<!-- ring_attn_3_13_stage_2&#45;&gt;ring_attn_3_13_stage_3 -->
<g id="edge1339" class="edge">
<title>ring_attn_3_13_stage_2&#45;&gt;ring_attn_3_13_stage_3</title>
<path fill="none" stroke="black" d="M7856,-4227.87C7856,-4227.87 7856,-4121.25 7856,-4121.25"/>
<polygon fill="black" stroke="black" points="7859.5,-4121.25 7856,-4111.25 7852.5,-4121.25 7859.5,-4121.25"/>
</g>
<!-- ring_attn_3_14_stage_2 -->
<g id="node1450" class="node">
<title>ring_attn_3_14_stage_2</title>
<polygon fill="yellow" stroke="black" points="8443,-4364 8234,-4296 8443,-4228 8652,-4296 8443,-4364"/>
<text text-anchor="middle" x="8443" y="-4314.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-4299.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="8443" y="-4284.8" font-family="Times,serif" font-size="14.00">Q[14]×K[12]×V[12]</text>
<text text-anchor="middle" x="8443" y="-4269.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_13_stage_2&#45;&gt;ring_attn_3_14_stage_2 -->
<g id="edge2435" class="edge">
<title>ring_attn_3_13_stage_2&#45;&gt;ring_attn_3_14_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-4296C8065.02,-4296 8223.86,-4296 8223.86,-4296"/>
<polygon fill="red" stroke="red" points="8223.86,-4299.5 8233.86,-4296 8223.86,-4292.5 8223.86,-4299.5"/>
</g>
<!-- ring_attn_3_13_stage_3&#45;&gt;ring_attn_3_13_stage_4 -->
<g id="edge1340" class="edge">
<title>ring_attn_3_13_stage_3&#45;&gt;ring_attn_3_13_stage_4</title>
<path fill="none" stroke="black" d="M7856,-3974.87C7856,-3974.87 7856,-3868.25 7856,-3868.25"/>
<polygon fill="black" stroke="black" points="7859.5,-3868.25 7856,-3858.25 7852.5,-3868.25 7859.5,-3868.25"/>
</g>
<!-- ring_attn_3_14_stage_3 -->
<g id="node1451" class="node">
<title>ring_attn_3_14_stage_3</title>
<polygon fill="yellow" stroke="black" points="8443,-4111 8234,-4043 8443,-3975 8652,-4043 8443,-4111"/>
<text text-anchor="middle" x="8443" y="-4061.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-4046.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="8443" y="-4031.8" font-family="Times,serif" font-size="14.00">Q[14]×K[11]×V[11]</text>
<text text-anchor="middle" x="8443" y="-4016.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_13_stage_3&#45;&gt;ring_attn_3_14_stage_3 -->
<g id="edge2436" class="edge">
<title>ring_attn_3_13_stage_3&#45;&gt;ring_attn_3_14_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-4043C8065.02,-4043 8223.86,-4043 8223.86,-4043"/>
<polygon fill="red" stroke="red" points="8223.86,-4046.5 8233.86,-4043 8223.86,-4039.5 8223.86,-4046.5"/>
</g>
<!-- ring_attn_3_13_stage_4&#45;&gt;ring_attn_3_13_stage_5 -->
<g id="edge1341" class="edge">
<title>ring_attn_3_13_stage_4&#45;&gt;ring_attn_3_13_stage_5</title>
<path fill="none" stroke="black" d="M7856,-3721.87C7856,-3721.87 7856,-3615.25 7856,-3615.25"/>
<polygon fill="black" stroke="black" points="7859.5,-3615.25 7856,-3605.25 7852.5,-3615.25 7859.5,-3615.25"/>
</g>
<!-- ring_attn_3_14_stage_4 -->
<g id="node1452" class="node">
<title>ring_attn_3_14_stage_4</title>
<polygon fill="yellow" stroke="black" points="8443,-3858 8234,-3790 8443,-3722 8652,-3790 8443,-3858"/>
<text text-anchor="middle" x="8443" y="-3808.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-3793.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="8443" y="-3778.8" font-family="Times,serif" font-size="14.00">Q[14]×K[10]×V[10]</text>
<text text-anchor="middle" x="8443" y="-3763.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_13_stage_4&#45;&gt;ring_attn_3_14_stage_4 -->
<g id="edge2437" class="edge">
<title>ring_attn_3_13_stage_4&#45;&gt;ring_attn_3_14_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-3790C8065.02,-3790 8223.86,-3790 8223.86,-3790"/>
<polygon fill="red" stroke="red" points="8223.86,-3793.5 8233.86,-3790 8223.86,-3786.5 8223.86,-3793.5"/>
</g>
<!-- ring_attn_3_13_stage_5&#45;&gt;ring_attn_3_13_stage_6 -->
<g id="edge1342" class="edge">
<title>ring_attn_3_13_stage_5&#45;&gt;ring_attn_3_13_stage_6</title>
<path fill="none" stroke="black" d="M7856,-3468.87C7856,-3468.87 7856,-3362.25 7856,-3362.25"/>
<polygon fill="black" stroke="black" points="7859.5,-3362.25 7856,-3352.25 7852.5,-3362.25 7859.5,-3362.25"/>
</g>
<!-- ring_attn_3_14_stage_5 -->
<g id="node1453" class="node">
<title>ring_attn_3_14_stage_5</title>
<polygon fill="yellow" stroke="black" points="8443,-3605 8234,-3537 8443,-3469 8652,-3537 8443,-3605"/>
<text text-anchor="middle" x="8443" y="-3555.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-3540.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="8443" y="-3525.8" font-family="Times,serif" font-size="14.00">Q[14]×K[9]×V[9]</text>
<text text-anchor="middle" x="8443" y="-3510.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_13_stage_5&#45;&gt;ring_attn_3_14_stage_5 -->
<g id="edge2438" class="edge">
<title>ring_attn_3_13_stage_5&#45;&gt;ring_attn_3_14_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-3537C8065.02,-3537 8223.86,-3537 8223.86,-3537"/>
<polygon fill="red" stroke="red" points="8223.86,-3540.5 8233.86,-3537 8223.86,-3533.5 8223.86,-3540.5"/>
</g>
<!-- ring_attn_3_13_stage_6&#45;&gt;ring_attn_3_13_stage_7 -->
<g id="edge1343" class="edge">
<title>ring_attn_3_13_stage_6&#45;&gt;ring_attn_3_13_stage_7</title>
<path fill="none" stroke="black" d="M7856,-3215.87C7856,-3215.87 7856,-3109.25 7856,-3109.25"/>
<polygon fill="black" stroke="black" points="7859.5,-3109.25 7856,-3099.25 7852.5,-3109.25 7859.5,-3109.25"/>
</g>
<!-- ring_attn_3_14_stage_6 -->
<g id="node1454" class="node">
<title>ring_attn_3_14_stage_6</title>
<polygon fill="yellow" stroke="black" points="8443,-3352 8234,-3284 8443,-3216 8652,-3284 8443,-3352"/>
<text text-anchor="middle" x="8443" y="-3302.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-3287.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="8443" y="-3272.8" font-family="Times,serif" font-size="14.00">Q[14]×K[8]×V[8]</text>
<text text-anchor="middle" x="8443" y="-3257.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_13_stage_6&#45;&gt;ring_attn_3_14_stage_6 -->
<g id="edge2439" class="edge">
<title>ring_attn_3_13_stage_6&#45;&gt;ring_attn_3_14_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-3284C8065.02,-3284 8223.86,-3284 8223.86,-3284"/>
<polygon fill="red" stroke="red" points="8223.86,-3287.5 8233.86,-3284 8223.86,-3280.5 8223.86,-3287.5"/>
</g>
<!-- ring_attn_3_13_stage_7&#45;&gt;ring_attn_3_13_stage_8 -->
<g id="edge1344" class="edge">
<title>ring_attn_3_13_stage_7&#45;&gt;ring_attn_3_13_stage_8</title>
<path fill="none" stroke="black" d="M7856,-2962.87C7856,-2962.87 7856,-2856.25 7856,-2856.25"/>
<polygon fill="black" stroke="black" points="7859.5,-2856.25 7856,-2846.25 7852.5,-2856.25 7859.5,-2856.25"/>
</g>
<!-- ring_attn_3_14_stage_7 -->
<g id="node1455" class="node">
<title>ring_attn_3_14_stage_7</title>
<polygon fill="yellow" stroke="black" points="8443,-3099 8234,-3031 8443,-2963 8652,-3031 8443,-3099"/>
<text text-anchor="middle" x="8443" y="-3049.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-3034.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="8443" y="-3019.8" font-family="Times,serif" font-size="14.00">Q[14]×K[7]×V[7]</text>
<text text-anchor="middle" x="8443" y="-3004.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_13_stage_7&#45;&gt;ring_attn_3_14_stage_7 -->
<g id="edge2440" class="edge">
<title>ring_attn_3_13_stage_7&#45;&gt;ring_attn_3_14_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-3031C8065.02,-3031 8223.86,-3031 8223.86,-3031"/>
<polygon fill="red" stroke="red" points="8223.86,-3034.5 8233.86,-3031 8223.86,-3027.5 8223.86,-3034.5"/>
</g>
<!-- ring_attn_3_13_stage_8&#45;&gt;ring_attn_3_13_stage_9 -->
<g id="edge1345" class="edge">
<title>ring_attn_3_13_stage_8&#45;&gt;ring_attn_3_13_stage_9</title>
<path fill="none" stroke="black" d="M7856,-2709.87C7856,-2709.87 7856,-2603.25 7856,-2603.25"/>
<polygon fill="black" stroke="black" points="7859.5,-2603.25 7856,-2593.25 7852.5,-2603.25 7859.5,-2603.25"/>
</g>
<!-- ring_attn_3_14_stage_8 -->
<g id="node1456" class="node">
<title>ring_attn_3_14_stage_8</title>
<polygon fill="yellow" stroke="black" points="8443,-2846 8234,-2778 8443,-2710 8652,-2778 8443,-2846"/>
<text text-anchor="middle" x="8443" y="-2796.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-2781.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="8443" y="-2766.8" font-family="Times,serif" font-size="14.00">Q[14]×K[6]×V[6]</text>
<text text-anchor="middle" x="8443" y="-2751.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_13_stage_8&#45;&gt;ring_attn_3_14_stage_8 -->
<g id="edge2441" class="edge">
<title>ring_attn_3_13_stage_8&#45;&gt;ring_attn_3_14_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-2778C8065.02,-2778 8223.86,-2778 8223.86,-2778"/>
<polygon fill="red" stroke="red" points="8223.86,-2781.5 8233.86,-2778 8223.86,-2774.5 8223.86,-2781.5"/>
</g>
<!-- ring_attn_3_13_stage_9&#45;&gt;ring_attn_3_13_stage_10 -->
<g id="edge1346" class="edge">
<title>ring_attn_3_13_stage_9&#45;&gt;ring_attn_3_13_stage_10</title>
<path fill="none" stroke="black" d="M7856,-2456.87C7856,-2456.87 7856,-2350.25 7856,-2350.25"/>
<polygon fill="black" stroke="black" points="7859.5,-2350.25 7856,-2340.25 7852.5,-2350.25 7859.5,-2350.25"/>
</g>
<!-- ring_attn_3_14_stage_9 -->
<g id="node1457" class="node">
<title>ring_attn_3_14_stage_9</title>
<polygon fill="yellow" stroke="black" points="8443,-2593 8234,-2525 8443,-2457 8652,-2525 8443,-2593"/>
<text text-anchor="middle" x="8443" y="-2543.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-2528.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="8443" y="-2513.8" font-family="Times,serif" font-size="14.00">Q[14]×K[5]×V[5]</text>
<text text-anchor="middle" x="8443" y="-2498.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_13_stage_9&#45;&gt;ring_attn_3_14_stage_9 -->
<g id="edge2442" class="edge">
<title>ring_attn_3_13_stage_9&#45;&gt;ring_attn_3_14_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-2525C8065.02,-2525 8223.86,-2525 8223.86,-2525"/>
<polygon fill="red" stroke="red" points="8223.86,-2528.5 8233.86,-2525 8223.86,-2521.5 8223.86,-2528.5"/>
</g>
<!-- ring_attn_3_13_stage_10&#45;&gt;ring_attn_3_13_stage_11 -->
<g id="edge1347" class="edge">
<title>ring_attn_3_13_stage_10&#45;&gt;ring_attn_3_13_stage_11</title>
<path fill="none" stroke="black" d="M7856,-2203.87C7856,-2203.87 7856,-2097.25 7856,-2097.25"/>
<polygon fill="black" stroke="black" points="7859.5,-2097.25 7856,-2087.25 7852.5,-2097.25 7859.5,-2097.25"/>
</g>
<!-- ring_attn_3_14_stage_10 -->
<g id="node1458" class="node">
<title>ring_attn_3_14_stage_10</title>
<polygon fill="yellow" stroke="black" points="8443,-2340 8234,-2272 8443,-2204 8652,-2272 8443,-2340"/>
<text text-anchor="middle" x="8443" y="-2290.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-2275.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="8443" y="-2260.8" font-family="Times,serif" font-size="14.00">Q[14]×K[4]×V[4]</text>
<text text-anchor="middle" x="8443" y="-2245.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_13_stage_10&#45;&gt;ring_attn_3_14_stage_10 -->
<g id="edge2443" class="edge">
<title>ring_attn_3_13_stage_10&#45;&gt;ring_attn_3_14_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-2272C8065.02,-2272 8223.86,-2272 8223.86,-2272"/>
<polygon fill="red" stroke="red" points="8223.86,-2275.5 8233.86,-2272 8223.86,-2268.5 8223.86,-2275.5"/>
</g>
<!-- ring_attn_3_13_stage_11&#45;&gt;ring_attn_3_13_stage_12 -->
<g id="edge1348" class="edge">
<title>ring_attn_3_13_stage_11&#45;&gt;ring_attn_3_13_stage_12</title>
<path fill="none" stroke="black" d="M7856,-1950.87C7856,-1950.87 7856,-1844.25 7856,-1844.25"/>
<polygon fill="black" stroke="black" points="7859.5,-1844.25 7856,-1834.25 7852.5,-1844.25 7859.5,-1844.25"/>
</g>
<!-- ring_attn_3_14_stage_11 -->
<g id="node1459" class="node">
<title>ring_attn_3_14_stage_11</title>
<polygon fill="yellow" stroke="black" points="8443,-2087 8234,-2019 8443,-1951 8652,-2019 8443,-2087"/>
<text text-anchor="middle" x="8443" y="-2037.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-2022.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="8443" y="-2007.8" font-family="Times,serif" font-size="14.00">Q[14]×K[3]×V[3]</text>
<text text-anchor="middle" x="8443" y="-1992.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_13_stage_11&#45;&gt;ring_attn_3_14_stage_11 -->
<g id="edge2444" class="edge">
<title>ring_attn_3_13_stage_11&#45;&gt;ring_attn_3_14_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-2019C8065.02,-2019 8223.86,-2019 8223.86,-2019"/>
<polygon fill="red" stroke="red" points="8223.86,-2022.5 8233.86,-2019 8223.86,-2015.5 8223.86,-2022.5"/>
</g>
<!-- ring_attn_3_13_stage_12&#45;&gt;ring_attn_3_13_stage_13 -->
<g id="edge1349" class="edge">
<title>ring_attn_3_13_stage_12&#45;&gt;ring_attn_3_13_stage_13</title>
<path fill="none" stroke="black" d="M7856,-1697.87C7856,-1697.87 7856,-1591.25 7856,-1591.25"/>
<polygon fill="black" stroke="black" points="7859.5,-1591.25 7856,-1581.25 7852.5,-1591.25 7859.5,-1591.25"/>
</g>
<!-- ring_attn_3_14_stage_12 -->
<g id="node1460" class="node">
<title>ring_attn_3_14_stage_12</title>
<polygon fill="yellow" stroke="black" points="8443,-1834 8234,-1766 8443,-1698 8652,-1766 8443,-1834"/>
<text text-anchor="middle" x="8443" y="-1784.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-1769.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="8443" y="-1754.8" font-family="Times,serif" font-size="14.00">Q[14]×K[2]×V[2]</text>
<text text-anchor="middle" x="8443" y="-1739.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_13_stage_12&#45;&gt;ring_attn_3_14_stage_12 -->
<g id="edge2445" class="edge">
<title>ring_attn_3_13_stage_12&#45;&gt;ring_attn_3_14_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-1766C8065.02,-1766 8223.86,-1766 8223.86,-1766"/>
<polygon fill="red" stroke="red" points="8223.86,-1769.5 8233.86,-1766 8223.86,-1762.5 8223.86,-1769.5"/>
</g>
<!-- ring_attn_3_13_stage_13&#45;&gt;ring_attn_3_13_stage_14 -->
<g id="edge1350" class="edge">
<title>ring_attn_3_13_stage_13&#45;&gt;ring_attn_3_13_stage_14</title>
<path fill="none" stroke="black" d="M7856,-1444.87C7856,-1444.87 7856,-1338.25 7856,-1338.25"/>
<polygon fill="black" stroke="black" points="7859.5,-1338.25 7856,-1328.25 7852.5,-1338.25 7859.5,-1338.25"/>
</g>
<!-- ring_attn_3_14_stage_13 -->
<g id="node1461" class="node">
<title>ring_attn_3_14_stage_13</title>
<polygon fill="yellow" stroke="black" points="8443,-1581 8234,-1513 8443,-1445 8652,-1513 8443,-1581"/>
<text text-anchor="middle" x="8443" y="-1531.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-1516.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="8443" y="-1501.8" font-family="Times,serif" font-size="14.00">Q[14]×K[1]×V[1]</text>
<text text-anchor="middle" x="8443" y="-1486.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_13_stage_13&#45;&gt;ring_attn_3_14_stage_13 -->
<g id="edge2446" class="edge">
<title>ring_attn_3_13_stage_13&#45;&gt;ring_attn_3_14_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-1513C8065.02,-1513 8223.86,-1513 8223.86,-1513"/>
<polygon fill="red" stroke="red" points="8223.86,-1516.5 8233.86,-1513 8223.86,-1509.5 8223.86,-1516.5"/>
</g>
<!-- ring_attn_3_13_stage_14&#45;&gt;ring_attn_3_13_stage_15 -->
<g id="edge1351" class="edge">
<title>ring_attn_3_13_stage_14&#45;&gt;ring_attn_3_13_stage_15</title>
<path fill="none" stroke="black" d="M7856,-1191.87C7856,-1191.87 7856,-1085.25 7856,-1085.25"/>
<polygon fill="black" stroke="black" points="7859.5,-1085.25 7856,-1075.25 7852.5,-1085.25 7859.5,-1085.25"/>
</g>
<!-- ring_attn_3_14_stage_14 -->
<g id="node1462" class="node">
<title>ring_attn_3_14_stage_14</title>
<polygon fill="yellow" stroke="black" points="8443,-1328 8234,-1260 8443,-1192 8652,-1260 8443,-1328"/>
<text text-anchor="middle" x="8443" y="-1278.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-1263.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="8443" y="-1248.8" font-family="Times,serif" font-size="14.00">Q[14]×K[0]×V[0]</text>
<text text-anchor="middle" x="8443" y="-1233.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_13_stage_14&#45;&gt;ring_attn_3_14_stage_14 -->
<g id="edge2447" class="edge">
<title>ring_attn_3_13_stage_14&#45;&gt;ring_attn_3_14_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-1260C8065.02,-1260 8223.86,-1260 8223.86,-1260"/>
<polygon fill="red" stroke="red" points="8223.86,-1263.5 8233.86,-1260 8223.86,-1256.5 8223.86,-1263.5"/>
</g>
<!-- attn_out_3_13 -->
<g id="node1366" class="node">
<title>attn_out_3_13</title>
<polygon fill="none" stroke="black" points="7925.5,-866 7786.5,-866 7786.5,-813 7925.5,-813 7925.5,-866"/>
<text text-anchor="middle" x="7856" y="-850.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="7856" y="-835.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="7856" y="-820.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_3_13_stage_15&#45;&gt;attn_out_3_13 -->
<g id="edge1352" class="edge">
<title>ring_attn_3_13_stage_15&#45;&gt;attn_out_3_13</title>
<path fill="none" stroke="black" d="M7856,-938.87C7856,-938.87 7856,-876.18 7856,-876.18"/>
<polygon fill="black" stroke="black" points="7859.5,-876.18 7856,-866.18 7852.5,-876.18 7859.5,-876.18"/>
</g>
<!-- ring_attn_3_14_stage_15 -->
<g id="node1463" class="node">
<title>ring_attn_3_14_stage_15</title>
<polygon fill="yellow" stroke="black" points="8443,-1075 8234,-1007 8443,-939 8652,-1007 8443,-1075"/>
<text text-anchor="middle" x="8443" y="-1025.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="8443" y="-1010.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="8443" y="-995.8" font-family="Times,serif" font-size="14.00">Q[14]×K[15]×V[15]</text>
<text text-anchor="middle" x="8443" y="-980.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_13_stage_15&#45;&gt;ring_attn_3_14_stage_15 -->
<g id="edge2448" class="edge">
<title>ring_attn_3_13_stage_15&#45;&gt;ring_attn_3_14_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8065.02,-1007C8065.02,-1007 8223.86,-1007 8223.86,-1007"/>
<polygon fill="red" stroke="red" points="8223.86,-1010.5 8233.86,-1007 8223.86,-1003.5 8223.86,-1010.5"/>
</g>
<!-- attn_residual_3_13 -->
<g id="node1367" class="node">
<title>attn_residual_3_13</title>
<ellipse fill="none" stroke="black" cx="7856" cy="-713" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7856" y="-716.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="7856" y="-701.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_3_13&#45;&gt;attn_residual_3_13 -->
<g id="edge1353" class="edge">
<title>attn_out_3_13&#45;&gt;attn_residual_3_13</title>
<path fill="none" stroke="black" d="M7856,-812.98C7856,-812.98 7856,-750.36 7856,-750.36"/>
<polygon fill="black" stroke="black" points="7859.5,-750.36 7856,-740.36 7852.5,-750.36 7859.5,-750.36"/>
</g>
<!-- ffn_up_3_13 -->
<g id="node1368" class="node">
<title>ffn_up_3_13</title>
<polygon fill="none" stroke="black" points="7935,-613 7777,-613 7777,-560 7935,-560 7935,-613"/>
<text text-anchor="middle" x="7856" y="-597.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="7856" y="-582.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="7856" y="-567.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_3_13&#45;&gt;ffn_up_3_13 -->
<g id="edge1354" class="edge">
<title>attn_residual_3_13&#45;&gt;ffn_up_3_13</title>
<path fill="none" stroke="black" d="M7856,-685.86C7856,-685.86 7856,-623.16 7856,-623.16"/>
<polygon fill="black" stroke="black" points="7859.5,-623.16 7856,-613.16 7852.5,-623.16 7859.5,-623.16"/>
</g>
<!-- ffn_gelu_3_13 -->
<g id="node1369" class="node">
<title>ffn_gelu_3_13</title>
<ellipse fill="none" stroke="black" cx="7856" cy="-460" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7856" y="-463.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7856" y="-448.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_3_13&#45;&gt;ffn_gelu_3_13 -->
<g id="edge1355" class="edge">
<title>ffn_up_3_13&#45;&gt;ffn_gelu_3_13</title>
<path fill="none" stroke="black" d="M7856,-559.98C7856,-559.98 7856,-497.36 7856,-497.36"/>
<polygon fill="black" stroke="black" points="7859.5,-497.36 7856,-487.36 7852.5,-497.36 7859.5,-497.36"/>
</g>
<!-- ffn_down_3_13 -->
<g id="node1370" class="node">
<title>ffn_down_3_13</title>
<polygon fill="none" stroke="black" points="7945,-360 7767,-360 7767,-307 7945,-307 7945,-360"/>
<text text-anchor="middle" x="7856" y="-344.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="7856" y="-329.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="7856" y="-314.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_3_13&#45;&gt;ffn_down_3_13 -->
<g id="edge1356" class="edge">
<title>ffn_gelu_3_13&#45;&gt;ffn_down_3_13</title>
<path fill="none" stroke="black" d="M7856,-432.86C7856,-432.86 7856,-370.16 7856,-370.16"/>
<polygon fill="black" stroke="black" points="7859.5,-370.16 7856,-360.16 7852.5,-370.16 7859.5,-370.16"/>
</g>
<!-- ffn_residual_3_13 -->
<g id="node1371" class="node">
<title>ffn_residual_3_13</title>
<ellipse fill="none" stroke="black" cx="7856" cy="-207" rx="105.5" ry="27"/>
<text text-anchor="middle" x="7856" y="-210.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="7856" y="-195.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_3_13&#45;&gt;ffn_residual_3_13 -->
<g id="edge1357" class="edge">
<title>ffn_down_3_13&#45;&gt;ffn_residual_3_13</title>
<path fill="none" stroke="black" d="M7856,-306.98C7856,-306.98 7856,-244.36 7856,-244.36"/>
<polygon fill="black" stroke="black" points="7859.5,-244.36 7856,-234.36 7852.5,-244.36 7859.5,-244.36"/>
</g>
<!-- output_13 -->
<g id="node1372" class="node">
<title>output_13</title>
<polygon fill="lightcoral" stroke="black" points="7953.5,-107 7758.5,-107 7758.5,-69 7953.5,-69 7953.5,-107"/>
<text text-anchor="middle" x="7856" y="-91.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="7856" y="-76.8" font-family="Times,serif" font-size="14.00">Y[13]: 1024×1024×4096</text>
</g>
<!-- ffn_residual_3_13&#45;&gt;output_13 -->
<g id="edge1358" class="edge">
<title>ffn_residual_3_13&#45;&gt;output_13</title>
<path fill="none" stroke="black" d="M7856,-180C7856,-180 7856,-117.12 7856,-117.12"/>
<polygon fill="black" stroke="black" points="7859.5,-117.12 7856,-107.12 7852.5,-117.12 7859.5,-117.12"/>
</g>
<!-- input_14 -->
<g id="node1373" class="node">
<title>input_14</title>
<polygon fill="lightgreen" stroke="black" points="8541,-20458 8345,-20458 8345,-20420 8541,-20420 8541,-20458"/>
<text text-anchor="middle" x="8443" y="-20442.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="8443" y="-20427.8" font-family="Times,serif" font-size="14.00">X[14]: 1024×1024×4096</text>
</g>
<!-- qkv_proj_0_14 -->
<g id="node1374" class="node">
<title>qkv_proj_0_14</title>
<polygon fill="none" stroke="black" points="8525.5,-20347 8360.5,-20347 8360.5,-20294 8525.5,-20294 8525.5,-20347"/>
<text text-anchor="middle" x="8443" y="-20331.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8443" y="-20316.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="8443" y="-20301.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- input_14&#45;&gt;qkv_proj_0_14 -->
<g id="edge1359" class="edge">
<title>input_14&#45;&gt;qkv_proj_0_14</title>
<path fill="none" stroke="black" d="M8443,-20419.96C8443,-20419.96 8443,-20357.44 8443,-20357.44"/>
<polygon fill="black" stroke="black" points="8446.5,-20357.44 8443,-20347.44 8439.5,-20357.44 8446.5,-20357.44"/>
</g>
<!-- qkv_reshape_0_14 -->
<g id="node1375" class="node">
<title>qkv_reshape_0_14</title>
<ellipse fill="none" stroke="black" cx="8443" cy="-20194" rx="148" ry="27"/>
<text text-anchor="middle" x="8443" y="-20197.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="8443" y="-20182.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_0_14&#45;&gt;qkv_reshape_0_14 -->
<g id="edge1360" class="edge">
<title>qkv_proj_0_14&#45;&gt;qkv_reshape_0_14</title>
<path fill="none" stroke="black" d="M8443,-20293.98C8443,-20293.98 8443,-20231.36 8443,-20231.36"/>
<polygon fill="black" stroke="black" points="8446.5,-20231.36 8443,-20221.36 8439.5,-20231.36 8446.5,-20231.36"/>
</g>
<!-- qkv_reshape_0_14&#45;&gt;ring_attn_0_14_stage_0 -->
<g id="edge1361" class="edge">
<title>qkv_reshape_0_14&#45;&gt;ring_attn_0_14_stage_0</title>
<path fill="none" stroke="black" d="M8443,-20166.72C8443,-20166.72 8443,-20060.16 8443,-20060.16"/>
<polygon fill="black" stroke="black" points="8446.5,-20060.16 8443,-20050.16 8439.5,-20060.16 8446.5,-20060.16"/>
</g>
<!-- ring_attn_0_14_stage_0&#45;&gt;ring_attn_0_14_stage_1 -->
<g id="edge1362" class="edge">
<title>ring_attn_0_14_stage_0&#45;&gt;ring_attn_0_14_stage_1</title>
<path fill="none" stroke="black" d="M8443,-19913.87C8443,-19913.87 8443,-19807.25 8443,-19807.25"/>
<polygon fill="black" stroke="black" points="8446.5,-19807.25 8443,-19797.25 8439.5,-19807.25 8446.5,-19807.25"/>
</g>
<!-- ring_attn_0_15_stage_0 -->
<g id="node1474" class="node">
<title>ring_attn_0_15_stage_0</title>
<polygon fill="yellow" stroke="black" points="9030,-20050 8821,-19982 9030,-19914 9239,-19982 9030,-20050"/>
<text text-anchor="middle" x="9030" y="-20000.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-19985.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="9030" y="-19970.8" font-family="Times,serif" font-size="14.00">Q[15]×K[15]×V[15]</text>
<text text-anchor="middle" x="9030" y="-19955.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_14_stage_0&#45;&gt;ring_attn_0_15_stage_0 -->
<g id="edge2449" class="edge">
<title>ring_attn_0_14_stage_0&#45;&gt;ring_attn_0_15_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-19982C8652.02,-19982 8810.86,-19982 8810.86,-19982"/>
<polygon fill="red" stroke="red" points="8810.86,-19985.5 8820.86,-19982 8810.86,-19978.5 8810.86,-19985.5"/>
</g>
<!-- ring_attn_0_14_stage_1&#45;&gt;ring_attn_0_14_stage_2 -->
<g id="edge1363" class="edge">
<title>ring_attn_0_14_stage_1&#45;&gt;ring_attn_0_14_stage_2</title>
<path fill="none" stroke="black" d="M8443,-19660.87C8443,-19660.87 8443,-19554.25 8443,-19554.25"/>
<polygon fill="black" stroke="black" points="8446.5,-19554.25 8443,-19544.25 8439.5,-19554.25 8446.5,-19554.25"/>
</g>
<!-- ring_attn_0_15_stage_1 -->
<g id="node1475" class="node">
<title>ring_attn_0_15_stage_1</title>
<polygon fill="yellow" stroke="black" points="9030,-19797 8821,-19729 9030,-19661 9239,-19729 9030,-19797"/>
<text text-anchor="middle" x="9030" y="-19747.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-19732.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="9030" y="-19717.8" font-family="Times,serif" font-size="14.00">Q[15]×K[14]×V[14]</text>
<text text-anchor="middle" x="9030" y="-19702.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_14_stage_1&#45;&gt;ring_attn_0_15_stage_1 -->
<g id="edge2450" class="edge">
<title>ring_attn_0_14_stage_1&#45;&gt;ring_attn_0_15_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-19729C8652.02,-19729 8810.86,-19729 8810.86,-19729"/>
<polygon fill="red" stroke="red" points="8810.86,-19732.5 8820.86,-19729 8810.86,-19725.5 8810.86,-19732.5"/>
</g>
<!-- ring_attn_0_14_stage_2&#45;&gt;ring_attn_0_14_stage_3 -->
<g id="edge1364" class="edge">
<title>ring_attn_0_14_stage_2&#45;&gt;ring_attn_0_14_stage_3</title>
<path fill="none" stroke="black" d="M8443,-19407.87C8443,-19407.87 8443,-19301.25 8443,-19301.25"/>
<polygon fill="black" stroke="black" points="8446.5,-19301.25 8443,-19291.25 8439.5,-19301.25 8446.5,-19301.25"/>
</g>
<!-- ring_attn_0_15_stage_2 -->
<g id="node1476" class="node">
<title>ring_attn_0_15_stage_2</title>
<polygon fill="yellow" stroke="black" points="9030,-19544 8821,-19476 9030,-19408 9239,-19476 9030,-19544"/>
<text text-anchor="middle" x="9030" y="-19494.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-19479.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="9030" y="-19464.8" font-family="Times,serif" font-size="14.00">Q[15]×K[13]×V[13]</text>
<text text-anchor="middle" x="9030" y="-19449.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_14_stage_2&#45;&gt;ring_attn_0_15_stage_2 -->
<g id="edge2451" class="edge">
<title>ring_attn_0_14_stage_2&#45;&gt;ring_attn_0_15_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-19476C8652.02,-19476 8810.86,-19476 8810.86,-19476"/>
<polygon fill="red" stroke="red" points="8810.86,-19479.5 8820.86,-19476 8810.86,-19472.5 8810.86,-19479.5"/>
</g>
<!-- ring_attn_0_14_stage_3&#45;&gt;ring_attn_0_14_stage_4 -->
<g id="edge1365" class="edge">
<title>ring_attn_0_14_stage_3&#45;&gt;ring_attn_0_14_stage_4</title>
<path fill="none" stroke="black" d="M8443,-19154.87C8443,-19154.87 8443,-19048.25 8443,-19048.25"/>
<polygon fill="black" stroke="black" points="8446.5,-19048.25 8443,-19038.25 8439.5,-19048.25 8446.5,-19048.25"/>
</g>
<!-- ring_attn_0_15_stage_3 -->
<g id="node1477" class="node">
<title>ring_attn_0_15_stage_3</title>
<polygon fill="yellow" stroke="black" points="9030,-19291 8821,-19223 9030,-19155 9239,-19223 9030,-19291"/>
<text text-anchor="middle" x="9030" y="-19241.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-19226.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="9030" y="-19211.8" font-family="Times,serif" font-size="14.00">Q[15]×K[12]×V[12]</text>
<text text-anchor="middle" x="9030" y="-19196.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_14_stage_3&#45;&gt;ring_attn_0_15_stage_3 -->
<g id="edge2452" class="edge">
<title>ring_attn_0_14_stage_3&#45;&gt;ring_attn_0_15_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-19223C8652.02,-19223 8810.86,-19223 8810.86,-19223"/>
<polygon fill="red" stroke="red" points="8810.86,-19226.5 8820.86,-19223 8810.86,-19219.5 8810.86,-19226.5"/>
</g>
<!-- ring_attn_0_14_stage_4&#45;&gt;ring_attn_0_14_stage_5 -->
<g id="edge1366" class="edge">
<title>ring_attn_0_14_stage_4&#45;&gt;ring_attn_0_14_stage_5</title>
<path fill="none" stroke="black" d="M8443,-18901.87C8443,-18901.87 8443,-18795.25 8443,-18795.25"/>
<polygon fill="black" stroke="black" points="8446.5,-18795.25 8443,-18785.25 8439.5,-18795.25 8446.5,-18795.25"/>
</g>
<!-- ring_attn_0_15_stage_4 -->
<g id="node1478" class="node">
<title>ring_attn_0_15_stage_4</title>
<polygon fill="yellow" stroke="black" points="9030,-19038 8821,-18970 9030,-18902 9239,-18970 9030,-19038"/>
<text text-anchor="middle" x="9030" y="-18988.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-18973.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="9030" y="-18958.8" font-family="Times,serif" font-size="14.00">Q[15]×K[11]×V[11]</text>
<text text-anchor="middle" x="9030" y="-18943.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_14_stage_4&#45;&gt;ring_attn_0_15_stage_4 -->
<g id="edge2453" class="edge">
<title>ring_attn_0_14_stage_4&#45;&gt;ring_attn_0_15_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-18970C8652.02,-18970 8810.86,-18970 8810.86,-18970"/>
<polygon fill="red" stroke="red" points="8810.86,-18973.5 8820.86,-18970 8810.86,-18966.5 8810.86,-18973.5"/>
</g>
<!-- ring_attn_0_14_stage_5&#45;&gt;ring_attn_0_14_stage_6 -->
<g id="edge1367" class="edge">
<title>ring_attn_0_14_stage_5&#45;&gt;ring_attn_0_14_stage_6</title>
<path fill="none" stroke="black" d="M8443,-18648.87C8443,-18648.87 8443,-18542.25 8443,-18542.25"/>
<polygon fill="black" stroke="black" points="8446.5,-18542.25 8443,-18532.25 8439.5,-18542.25 8446.5,-18542.25"/>
</g>
<!-- ring_attn_0_15_stage_5 -->
<g id="node1479" class="node">
<title>ring_attn_0_15_stage_5</title>
<polygon fill="yellow" stroke="black" points="9030,-18785 8821,-18717 9030,-18649 9239,-18717 9030,-18785"/>
<text text-anchor="middle" x="9030" y="-18735.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-18720.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="9030" y="-18705.8" font-family="Times,serif" font-size="14.00">Q[15]×K[10]×V[10]</text>
<text text-anchor="middle" x="9030" y="-18690.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_14_stage_5&#45;&gt;ring_attn_0_15_stage_5 -->
<g id="edge2454" class="edge">
<title>ring_attn_0_14_stage_5&#45;&gt;ring_attn_0_15_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-18717C8652.02,-18717 8810.86,-18717 8810.86,-18717"/>
<polygon fill="red" stroke="red" points="8810.86,-18720.5 8820.86,-18717 8810.86,-18713.5 8810.86,-18720.5"/>
</g>
<!-- ring_attn_0_14_stage_6&#45;&gt;ring_attn_0_14_stage_7 -->
<g id="edge1368" class="edge">
<title>ring_attn_0_14_stage_6&#45;&gt;ring_attn_0_14_stage_7</title>
<path fill="none" stroke="black" d="M8443,-18395.87C8443,-18395.87 8443,-18289.25 8443,-18289.25"/>
<polygon fill="black" stroke="black" points="8446.5,-18289.25 8443,-18279.25 8439.5,-18289.25 8446.5,-18289.25"/>
</g>
<!-- ring_attn_0_15_stage_6 -->
<g id="node1480" class="node">
<title>ring_attn_0_15_stage_6</title>
<polygon fill="yellow" stroke="black" points="9030,-18532 8821,-18464 9030,-18396 9239,-18464 9030,-18532"/>
<text text-anchor="middle" x="9030" y="-18482.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-18467.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="9030" y="-18452.8" font-family="Times,serif" font-size="14.00">Q[15]×K[9]×V[9]</text>
<text text-anchor="middle" x="9030" y="-18437.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_14_stage_6&#45;&gt;ring_attn_0_15_stage_6 -->
<g id="edge2455" class="edge">
<title>ring_attn_0_14_stage_6&#45;&gt;ring_attn_0_15_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-18464C8652.02,-18464 8810.86,-18464 8810.86,-18464"/>
<polygon fill="red" stroke="red" points="8810.86,-18467.5 8820.86,-18464 8810.86,-18460.5 8810.86,-18467.5"/>
</g>
<!-- ring_attn_0_14_stage_7&#45;&gt;ring_attn_0_14_stage_8 -->
<g id="edge1369" class="edge">
<title>ring_attn_0_14_stage_7&#45;&gt;ring_attn_0_14_stage_8</title>
<path fill="none" stroke="black" d="M8443,-18142.87C8443,-18142.87 8443,-18036.25 8443,-18036.25"/>
<polygon fill="black" stroke="black" points="8446.5,-18036.25 8443,-18026.25 8439.5,-18036.25 8446.5,-18036.25"/>
</g>
<!-- ring_attn_0_15_stage_7 -->
<g id="node1481" class="node">
<title>ring_attn_0_15_stage_7</title>
<polygon fill="yellow" stroke="black" points="9030,-18279 8821,-18211 9030,-18143 9239,-18211 9030,-18279"/>
<text text-anchor="middle" x="9030" y="-18229.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-18214.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="9030" y="-18199.8" font-family="Times,serif" font-size="14.00">Q[15]×K[8]×V[8]</text>
<text text-anchor="middle" x="9030" y="-18184.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_14_stage_7&#45;&gt;ring_attn_0_15_stage_7 -->
<g id="edge2456" class="edge">
<title>ring_attn_0_14_stage_7&#45;&gt;ring_attn_0_15_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-18211C8652.02,-18211 8810.86,-18211 8810.86,-18211"/>
<polygon fill="red" stroke="red" points="8810.86,-18214.5 8820.86,-18211 8810.86,-18207.5 8810.86,-18214.5"/>
</g>
<!-- ring_attn_0_14_stage_8&#45;&gt;ring_attn_0_14_stage_9 -->
<g id="edge1370" class="edge">
<title>ring_attn_0_14_stage_8&#45;&gt;ring_attn_0_14_stage_9</title>
<path fill="none" stroke="black" d="M8443,-17889.87C8443,-17889.87 8443,-17783.25 8443,-17783.25"/>
<polygon fill="black" stroke="black" points="8446.5,-17783.25 8443,-17773.25 8439.5,-17783.25 8446.5,-17783.25"/>
</g>
<!-- ring_attn_0_15_stage_8 -->
<g id="node1482" class="node">
<title>ring_attn_0_15_stage_8</title>
<polygon fill="yellow" stroke="black" points="9030,-18026 8821,-17958 9030,-17890 9239,-17958 9030,-18026"/>
<text text-anchor="middle" x="9030" y="-17976.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-17961.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="9030" y="-17946.8" font-family="Times,serif" font-size="14.00">Q[15]×K[7]×V[7]</text>
<text text-anchor="middle" x="9030" y="-17931.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_14_stage_8&#45;&gt;ring_attn_0_15_stage_8 -->
<g id="edge2457" class="edge">
<title>ring_attn_0_14_stage_8&#45;&gt;ring_attn_0_15_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-17958C8652.02,-17958 8810.86,-17958 8810.86,-17958"/>
<polygon fill="red" stroke="red" points="8810.86,-17961.5 8820.86,-17958 8810.86,-17954.5 8810.86,-17961.5"/>
</g>
<!-- ring_attn_0_14_stage_9&#45;&gt;ring_attn_0_14_stage_10 -->
<g id="edge1371" class="edge">
<title>ring_attn_0_14_stage_9&#45;&gt;ring_attn_0_14_stage_10</title>
<path fill="none" stroke="black" d="M8443,-17636.87C8443,-17636.87 8443,-17530.25 8443,-17530.25"/>
<polygon fill="black" stroke="black" points="8446.5,-17530.25 8443,-17520.25 8439.5,-17530.25 8446.5,-17530.25"/>
</g>
<!-- ring_attn_0_15_stage_9 -->
<g id="node1483" class="node">
<title>ring_attn_0_15_stage_9</title>
<polygon fill="yellow" stroke="black" points="9030,-17773 8821,-17705 9030,-17637 9239,-17705 9030,-17773"/>
<text text-anchor="middle" x="9030" y="-17723.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-17708.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="9030" y="-17693.8" font-family="Times,serif" font-size="14.00">Q[15]×K[6]×V[6]</text>
<text text-anchor="middle" x="9030" y="-17678.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_14_stage_9&#45;&gt;ring_attn_0_15_stage_9 -->
<g id="edge2458" class="edge">
<title>ring_attn_0_14_stage_9&#45;&gt;ring_attn_0_15_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-17705C8652.02,-17705 8810.86,-17705 8810.86,-17705"/>
<polygon fill="red" stroke="red" points="8810.86,-17708.5 8820.86,-17705 8810.86,-17701.5 8810.86,-17708.5"/>
</g>
<!-- ring_attn_0_14_stage_10&#45;&gt;ring_attn_0_14_stage_11 -->
<g id="edge1372" class="edge">
<title>ring_attn_0_14_stage_10&#45;&gt;ring_attn_0_14_stage_11</title>
<path fill="none" stroke="black" d="M8443,-17383.87C8443,-17383.87 8443,-17277.25 8443,-17277.25"/>
<polygon fill="black" stroke="black" points="8446.5,-17277.25 8443,-17267.25 8439.5,-17277.25 8446.5,-17277.25"/>
</g>
<!-- ring_attn_0_15_stage_10 -->
<g id="node1484" class="node">
<title>ring_attn_0_15_stage_10</title>
<polygon fill="yellow" stroke="black" points="9030,-17520 8821,-17452 9030,-17384 9239,-17452 9030,-17520"/>
<text text-anchor="middle" x="9030" y="-17470.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-17455.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="9030" y="-17440.8" font-family="Times,serif" font-size="14.00">Q[15]×K[5]×V[5]</text>
<text text-anchor="middle" x="9030" y="-17425.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_14_stage_10&#45;&gt;ring_attn_0_15_stage_10 -->
<g id="edge2459" class="edge">
<title>ring_attn_0_14_stage_10&#45;&gt;ring_attn_0_15_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-17452C8652.02,-17452 8810.86,-17452 8810.86,-17452"/>
<polygon fill="red" stroke="red" points="8810.86,-17455.5 8820.86,-17452 8810.86,-17448.5 8810.86,-17455.5"/>
</g>
<!-- ring_attn_0_14_stage_11&#45;&gt;ring_attn_0_14_stage_12 -->
<g id="edge1373" class="edge">
<title>ring_attn_0_14_stage_11&#45;&gt;ring_attn_0_14_stage_12</title>
<path fill="none" stroke="black" d="M8443,-17130.87C8443,-17130.87 8443,-17024.25 8443,-17024.25"/>
<polygon fill="black" stroke="black" points="8446.5,-17024.25 8443,-17014.25 8439.5,-17024.25 8446.5,-17024.25"/>
</g>
<!-- ring_attn_0_15_stage_11 -->
<g id="node1485" class="node">
<title>ring_attn_0_15_stage_11</title>
<polygon fill="yellow" stroke="black" points="9030,-17267 8821,-17199 9030,-17131 9239,-17199 9030,-17267"/>
<text text-anchor="middle" x="9030" y="-17217.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-17202.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="9030" y="-17187.8" font-family="Times,serif" font-size="14.00">Q[15]×K[4]×V[4]</text>
<text text-anchor="middle" x="9030" y="-17172.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_14_stage_11&#45;&gt;ring_attn_0_15_stage_11 -->
<g id="edge2460" class="edge">
<title>ring_attn_0_14_stage_11&#45;&gt;ring_attn_0_15_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-17199C8652.02,-17199 8810.86,-17199 8810.86,-17199"/>
<polygon fill="red" stroke="red" points="8810.86,-17202.5 8820.86,-17199 8810.86,-17195.5 8810.86,-17202.5"/>
</g>
<!-- ring_attn_0_14_stage_12&#45;&gt;ring_attn_0_14_stage_13 -->
<g id="edge1374" class="edge">
<title>ring_attn_0_14_stage_12&#45;&gt;ring_attn_0_14_stage_13</title>
<path fill="none" stroke="black" d="M8443,-16877.87C8443,-16877.87 8443,-16771.25 8443,-16771.25"/>
<polygon fill="black" stroke="black" points="8446.5,-16771.25 8443,-16761.25 8439.5,-16771.25 8446.5,-16771.25"/>
</g>
<!-- ring_attn_0_15_stage_12 -->
<g id="node1486" class="node">
<title>ring_attn_0_15_stage_12</title>
<polygon fill="yellow" stroke="black" points="9030,-17014 8821,-16946 9030,-16878 9239,-16946 9030,-17014"/>
<text text-anchor="middle" x="9030" y="-16964.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-16949.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="9030" y="-16934.8" font-family="Times,serif" font-size="14.00">Q[15]×K[3]×V[3]</text>
<text text-anchor="middle" x="9030" y="-16919.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_14_stage_12&#45;&gt;ring_attn_0_15_stage_12 -->
<g id="edge2461" class="edge">
<title>ring_attn_0_14_stage_12&#45;&gt;ring_attn_0_15_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-16946C8652.02,-16946 8810.86,-16946 8810.86,-16946"/>
<polygon fill="red" stroke="red" points="8810.86,-16949.5 8820.86,-16946 8810.86,-16942.5 8810.86,-16949.5"/>
</g>
<!-- ring_attn_0_14_stage_13&#45;&gt;ring_attn_0_14_stage_14 -->
<g id="edge1375" class="edge">
<title>ring_attn_0_14_stage_13&#45;&gt;ring_attn_0_14_stage_14</title>
<path fill="none" stroke="black" d="M8443,-16624.87C8443,-16624.87 8443,-16518.25 8443,-16518.25"/>
<polygon fill="black" stroke="black" points="8446.5,-16518.25 8443,-16508.25 8439.5,-16518.25 8446.5,-16518.25"/>
</g>
<!-- ring_attn_0_15_stage_13 -->
<g id="node1487" class="node">
<title>ring_attn_0_15_stage_13</title>
<polygon fill="yellow" stroke="black" points="9030,-16761 8821,-16693 9030,-16625 9239,-16693 9030,-16761"/>
<text text-anchor="middle" x="9030" y="-16711.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-16696.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="9030" y="-16681.8" font-family="Times,serif" font-size="14.00">Q[15]×K[2]×V[2]</text>
<text text-anchor="middle" x="9030" y="-16666.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_14_stage_13&#45;&gt;ring_attn_0_15_stage_13 -->
<g id="edge2462" class="edge">
<title>ring_attn_0_14_stage_13&#45;&gt;ring_attn_0_15_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-16693C8652.02,-16693 8810.86,-16693 8810.86,-16693"/>
<polygon fill="red" stroke="red" points="8810.86,-16696.5 8820.86,-16693 8810.86,-16689.5 8810.86,-16696.5"/>
</g>
<!-- ring_attn_0_14_stage_14&#45;&gt;ring_attn_0_14_stage_15 -->
<g id="edge1376" class="edge">
<title>ring_attn_0_14_stage_14&#45;&gt;ring_attn_0_14_stage_15</title>
<path fill="none" stroke="black" d="M8443,-16371.87C8443,-16371.87 8443,-16265.25 8443,-16265.25"/>
<polygon fill="black" stroke="black" points="8446.5,-16265.25 8443,-16255.25 8439.5,-16265.25 8446.5,-16265.25"/>
</g>
<!-- ring_attn_0_15_stage_14 -->
<g id="node1488" class="node">
<title>ring_attn_0_15_stage_14</title>
<polygon fill="yellow" stroke="black" points="9030,-16508 8821,-16440 9030,-16372 9239,-16440 9030,-16508"/>
<text text-anchor="middle" x="9030" y="-16458.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-16443.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="9030" y="-16428.8" font-family="Times,serif" font-size="14.00">Q[15]×K[1]×V[1]</text>
<text text-anchor="middle" x="9030" y="-16413.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_14_stage_14&#45;&gt;ring_attn_0_15_stage_14 -->
<g id="edge2463" class="edge">
<title>ring_attn_0_14_stage_14&#45;&gt;ring_attn_0_15_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-16440C8652.02,-16440 8810.86,-16440 8810.86,-16440"/>
<polygon fill="red" stroke="red" points="8810.86,-16443.5 8820.86,-16440 8810.86,-16436.5 8810.86,-16443.5"/>
</g>
<!-- attn_out_0_14 -->
<g id="node1392" class="node">
<title>attn_out_0_14</title>
<polygon fill="none" stroke="black" points="8512.5,-16046 8373.5,-16046 8373.5,-15993 8512.5,-15993 8512.5,-16046"/>
<text text-anchor="middle" x="8443" y="-16030.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="8443" y="-16015.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="8443" y="-16000.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_0_14_stage_15&#45;&gt;attn_out_0_14 -->
<g id="edge1377" class="edge">
<title>ring_attn_0_14_stage_15&#45;&gt;attn_out_0_14</title>
<path fill="none" stroke="black" d="M8443,-16118.87C8443,-16118.87 8443,-16056.18 8443,-16056.18"/>
<polygon fill="black" stroke="black" points="8446.5,-16056.18 8443,-16046.18 8439.5,-16056.18 8446.5,-16056.18"/>
</g>
<!-- ring_attn_0_15_stage_15 -->
<g id="node1489" class="node">
<title>ring_attn_0_15_stage_15</title>
<polygon fill="yellow" stroke="black" points="9030,-16255 8821,-16187 9030,-16119 9239,-16187 9030,-16255"/>
<text text-anchor="middle" x="9030" y="-16205.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-16190.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="9030" y="-16175.8" font-family="Times,serif" font-size="14.00">Q[15]×K[0]×V[0]</text>
<text text-anchor="middle" x="9030" y="-16160.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_0_14_stage_15&#45;&gt;ring_attn_0_15_stage_15 -->
<g id="edge2464" class="edge">
<title>ring_attn_0_14_stage_15&#45;&gt;ring_attn_0_15_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-16187C8652.02,-16187 8810.86,-16187 8810.86,-16187"/>
<polygon fill="red" stroke="red" points="8810.86,-16190.5 8820.86,-16187 8810.86,-16183.5 8810.86,-16190.5"/>
</g>
<!-- attn_residual_0_14 -->
<g id="node1393" class="node">
<title>attn_residual_0_14</title>
<ellipse fill="none" stroke="black" cx="8443" cy="-15893" rx="105.5" ry="27"/>
<text text-anchor="middle" x="8443" y="-15896.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="8443" y="-15881.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_0_14&#45;&gt;attn_residual_0_14 -->
<g id="edge1378" class="edge">
<title>attn_out_0_14&#45;&gt;attn_residual_0_14</title>
<path fill="none" stroke="black" d="M8443,-15992.98C8443,-15992.98 8443,-15930.36 8443,-15930.36"/>
<polygon fill="black" stroke="black" points="8446.5,-15930.36 8443,-15920.36 8439.5,-15930.36 8446.5,-15930.36"/>
</g>
<!-- ffn_up_0_14 -->
<g id="node1394" class="node">
<title>ffn_up_0_14</title>
<polygon fill="none" stroke="black" points="8522,-15793 8364,-15793 8364,-15740 8522,-15740 8522,-15793"/>
<text text-anchor="middle" x="8443" y="-15777.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="8443" y="-15762.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="8443" y="-15747.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_0_14&#45;&gt;ffn_up_0_14 -->
<g id="edge1379" class="edge">
<title>attn_residual_0_14&#45;&gt;ffn_up_0_14</title>
<path fill="none" stroke="black" d="M8443,-15865.86C8443,-15865.86 8443,-15803.16 8443,-15803.16"/>
<polygon fill="black" stroke="black" points="8446.5,-15803.16 8443,-15793.16 8439.5,-15803.16 8446.5,-15803.16"/>
</g>
<!-- ffn_gelu_0_14 -->
<g id="node1395" class="node">
<title>ffn_gelu_0_14</title>
<ellipse fill="none" stroke="black" cx="8443" cy="-15640" rx="105.5" ry="27"/>
<text text-anchor="middle" x="8443" y="-15643.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="8443" y="-15628.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_0_14&#45;&gt;ffn_gelu_0_14 -->
<g id="edge1380" class="edge">
<title>ffn_up_0_14&#45;&gt;ffn_gelu_0_14</title>
<path fill="none" stroke="black" d="M8443,-15739.98C8443,-15739.98 8443,-15677.36 8443,-15677.36"/>
<polygon fill="black" stroke="black" points="8446.5,-15677.36 8443,-15667.36 8439.5,-15677.36 8446.5,-15677.36"/>
</g>
<!-- ffn_down_0_14 -->
<g id="node1396" class="node">
<title>ffn_down_0_14</title>
<polygon fill="none" stroke="black" points="8532,-15540 8354,-15540 8354,-15487 8532,-15487 8532,-15540"/>
<text text-anchor="middle" x="8443" y="-15524.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="8443" y="-15509.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="8443" y="-15494.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_0_14&#45;&gt;ffn_down_0_14 -->
<g id="edge1381" class="edge">
<title>ffn_gelu_0_14&#45;&gt;ffn_down_0_14</title>
<path fill="none" stroke="black" d="M8443,-15612.86C8443,-15612.86 8443,-15550.16 8443,-15550.16"/>
<polygon fill="black" stroke="black" points="8446.5,-15550.16 8443,-15540.16 8439.5,-15550.16 8446.5,-15550.16"/>
</g>
<!-- ffn_residual_0_14 -->
<g id="node1397" class="node">
<title>ffn_residual_0_14</title>
<ellipse fill="none" stroke="black" cx="8443" cy="-15387" rx="105.5" ry="27"/>
<text text-anchor="middle" x="8443" y="-15390.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="8443" y="-15375.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_0_14&#45;&gt;ffn_residual_0_14 -->
<g id="edge1382" class="edge">
<title>ffn_down_0_14&#45;&gt;ffn_residual_0_14</title>
<path fill="none" stroke="black" d="M8443,-15486.98C8443,-15486.98 8443,-15424.36 8443,-15424.36"/>
<polygon fill="black" stroke="black" points="8446.5,-15424.36 8443,-15414.36 8439.5,-15424.36 8446.5,-15424.36"/>
</g>
<!-- qkv_proj_1_14 -->
<g id="node1398" class="node">
<title>qkv_proj_1_14</title>
<polygon fill="none" stroke="black" points="8525.5,-15287 8360.5,-15287 8360.5,-15234 8525.5,-15234 8525.5,-15287"/>
<text text-anchor="middle" x="8443" y="-15271.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8443" y="-15256.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="8443" y="-15241.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_0_14&#45;&gt;qkv_proj_1_14 -->
<g id="edge1383" class="edge">
<title>ffn_residual_0_14&#45;&gt;qkv_proj_1_14</title>
<path fill="none" stroke="black" d="M8443,-15359.86C8443,-15359.86 8443,-15297.16 8443,-15297.16"/>
<polygon fill="black" stroke="black" points="8446.5,-15297.16 8443,-15287.16 8439.5,-15297.16 8446.5,-15297.16"/>
</g>
<!-- qkv_reshape_1_14 -->
<g id="node1399" class="node">
<title>qkv_reshape_1_14</title>
<ellipse fill="none" stroke="black" cx="8443" cy="-15134" rx="148" ry="27"/>
<text text-anchor="middle" x="8443" y="-15137.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="8443" y="-15122.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_1_14&#45;&gt;qkv_reshape_1_14 -->
<g id="edge1384" class="edge">
<title>qkv_proj_1_14&#45;&gt;qkv_reshape_1_14</title>
<path fill="none" stroke="black" d="M8443,-15233.98C8443,-15233.98 8443,-15171.36 8443,-15171.36"/>
<polygon fill="black" stroke="black" points="8446.5,-15171.36 8443,-15161.36 8439.5,-15171.36 8446.5,-15171.36"/>
</g>
<!-- qkv_reshape_1_14&#45;&gt;ring_attn_1_14_stage_0 -->
<g id="edge1385" class="edge">
<title>qkv_reshape_1_14&#45;&gt;ring_attn_1_14_stage_0</title>
<path fill="none" stroke="black" d="M8443,-15106.72C8443,-15106.72 8443,-15000.16 8443,-15000.16"/>
<polygon fill="black" stroke="black" points="8446.5,-15000.16 8443,-14990.16 8439.5,-15000.16 8446.5,-15000.16"/>
</g>
<!-- ring_attn_1_14_stage_0&#45;&gt;ring_attn_1_14_stage_1 -->
<g id="edge1386" class="edge">
<title>ring_attn_1_14_stage_0&#45;&gt;ring_attn_1_14_stage_1</title>
<path fill="none" stroke="black" d="M8443,-14853.87C8443,-14853.87 8443,-14747.25 8443,-14747.25"/>
<polygon fill="black" stroke="black" points="8446.5,-14747.25 8443,-14737.25 8439.5,-14747.25 8446.5,-14747.25"/>
</g>
<!-- ring_attn_1_15_stage_0 -->
<g id="node1498" class="node">
<title>ring_attn_1_15_stage_0</title>
<polygon fill="yellow" stroke="black" points="9030,-14990 8821,-14922 9030,-14854 9239,-14922 9030,-14990"/>
<text text-anchor="middle" x="9030" y="-14940.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-14925.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="9030" y="-14910.8" font-family="Times,serif" font-size="14.00">Q[15]×K[15]×V[15]</text>
<text text-anchor="middle" x="9030" y="-14895.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_14_stage_0&#45;&gt;ring_attn_1_15_stage_0 -->
<g id="edge2465" class="edge">
<title>ring_attn_1_14_stage_0&#45;&gt;ring_attn_1_15_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-14922C8652.02,-14922 8810.86,-14922 8810.86,-14922"/>
<polygon fill="red" stroke="red" points="8810.86,-14925.5 8820.86,-14922 8810.86,-14918.5 8810.86,-14925.5"/>
</g>
<!-- ring_attn_1_14_stage_1&#45;&gt;ring_attn_1_14_stage_2 -->
<g id="edge1387" class="edge">
<title>ring_attn_1_14_stage_1&#45;&gt;ring_attn_1_14_stage_2</title>
<path fill="none" stroke="black" d="M8443,-14600.87C8443,-14600.87 8443,-14494.25 8443,-14494.25"/>
<polygon fill="black" stroke="black" points="8446.5,-14494.25 8443,-14484.25 8439.5,-14494.25 8446.5,-14494.25"/>
</g>
<!-- ring_attn_1_15_stage_1 -->
<g id="node1499" class="node">
<title>ring_attn_1_15_stage_1</title>
<polygon fill="yellow" stroke="black" points="9030,-14737 8821,-14669 9030,-14601 9239,-14669 9030,-14737"/>
<text text-anchor="middle" x="9030" y="-14687.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-14672.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="9030" y="-14657.8" font-family="Times,serif" font-size="14.00">Q[15]×K[14]×V[14]</text>
<text text-anchor="middle" x="9030" y="-14642.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_14_stage_1&#45;&gt;ring_attn_1_15_stage_1 -->
<g id="edge2466" class="edge">
<title>ring_attn_1_14_stage_1&#45;&gt;ring_attn_1_15_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-14669C8652.02,-14669 8810.86,-14669 8810.86,-14669"/>
<polygon fill="red" stroke="red" points="8810.86,-14672.5 8820.86,-14669 8810.86,-14665.5 8810.86,-14672.5"/>
</g>
<!-- ring_attn_1_14_stage_2&#45;&gt;ring_attn_1_14_stage_3 -->
<g id="edge1388" class="edge">
<title>ring_attn_1_14_stage_2&#45;&gt;ring_attn_1_14_stage_3</title>
<path fill="none" stroke="black" d="M8443,-14347.87C8443,-14347.87 8443,-14241.25 8443,-14241.25"/>
<polygon fill="black" stroke="black" points="8446.5,-14241.25 8443,-14231.25 8439.5,-14241.25 8446.5,-14241.25"/>
</g>
<!-- ring_attn_1_15_stage_2 -->
<g id="node1500" class="node">
<title>ring_attn_1_15_stage_2</title>
<polygon fill="yellow" stroke="black" points="9030,-14484 8821,-14416 9030,-14348 9239,-14416 9030,-14484"/>
<text text-anchor="middle" x="9030" y="-14434.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-14419.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="9030" y="-14404.8" font-family="Times,serif" font-size="14.00">Q[15]×K[13]×V[13]</text>
<text text-anchor="middle" x="9030" y="-14389.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_14_stage_2&#45;&gt;ring_attn_1_15_stage_2 -->
<g id="edge2467" class="edge">
<title>ring_attn_1_14_stage_2&#45;&gt;ring_attn_1_15_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-14416C8652.02,-14416 8810.86,-14416 8810.86,-14416"/>
<polygon fill="red" stroke="red" points="8810.86,-14419.5 8820.86,-14416 8810.86,-14412.5 8810.86,-14419.5"/>
</g>
<!-- ring_attn_1_14_stage_3&#45;&gt;ring_attn_1_14_stage_4 -->
<g id="edge1389" class="edge">
<title>ring_attn_1_14_stage_3&#45;&gt;ring_attn_1_14_stage_4</title>
<path fill="none" stroke="black" d="M8443,-14094.87C8443,-14094.87 8443,-13988.25 8443,-13988.25"/>
<polygon fill="black" stroke="black" points="8446.5,-13988.25 8443,-13978.25 8439.5,-13988.25 8446.5,-13988.25"/>
</g>
<!-- ring_attn_1_15_stage_3 -->
<g id="node1501" class="node">
<title>ring_attn_1_15_stage_3</title>
<polygon fill="yellow" stroke="black" points="9030,-14231 8821,-14163 9030,-14095 9239,-14163 9030,-14231"/>
<text text-anchor="middle" x="9030" y="-14181.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-14166.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="9030" y="-14151.8" font-family="Times,serif" font-size="14.00">Q[15]×K[12]×V[12]</text>
<text text-anchor="middle" x="9030" y="-14136.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_14_stage_3&#45;&gt;ring_attn_1_15_stage_3 -->
<g id="edge2468" class="edge">
<title>ring_attn_1_14_stage_3&#45;&gt;ring_attn_1_15_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-14163C8652.02,-14163 8810.86,-14163 8810.86,-14163"/>
<polygon fill="red" stroke="red" points="8810.86,-14166.5 8820.86,-14163 8810.86,-14159.5 8810.86,-14166.5"/>
</g>
<!-- ring_attn_1_14_stage_4&#45;&gt;ring_attn_1_14_stage_5 -->
<g id="edge1390" class="edge">
<title>ring_attn_1_14_stage_4&#45;&gt;ring_attn_1_14_stage_5</title>
<path fill="none" stroke="black" d="M8443,-13841.87C8443,-13841.87 8443,-13735.25 8443,-13735.25"/>
<polygon fill="black" stroke="black" points="8446.5,-13735.25 8443,-13725.25 8439.5,-13735.25 8446.5,-13735.25"/>
</g>
<!-- ring_attn_1_15_stage_4 -->
<g id="node1502" class="node">
<title>ring_attn_1_15_stage_4</title>
<polygon fill="yellow" stroke="black" points="9030,-13978 8821,-13910 9030,-13842 9239,-13910 9030,-13978"/>
<text text-anchor="middle" x="9030" y="-13928.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-13913.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="9030" y="-13898.8" font-family="Times,serif" font-size="14.00">Q[15]×K[11]×V[11]</text>
<text text-anchor="middle" x="9030" y="-13883.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_14_stage_4&#45;&gt;ring_attn_1_15_stage_4 -->
<g id="edge2469" class="edge">
<title>ring_attn_1_14_stage_4&#45;&gt;ring_attn_1_15_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-13910C8652.02,-13910 8810.86,-13910 8810.86,-13910"/>
<polygon fill="red" stroke="red" points="8810.86,-13913.5 8820.86,-13910 8810.86,-13906.5 8810.86,-13913.5"/>
</g>
<!-- ring_attn_1_14_stage_5&#45;&gt;ring_attn_1_14_stage_6 -->
<g id="edge1391" class="edge">
<title>ring_attn_1_14_stage_5&#45;&gt;ring_attn_1_14_stage_6</title>
<path fill="none" stroke="black" d="M8443,-13588.87C8443,-13588.87 8443,-13482.25 8443,-13482.25"/>
<polygon fill="black" stroke="black" points="8446.5,-13482.25 8443,-13472.25 8439.5,-13482.25 8446.5,-13482.25"/>
</g>
<!-- ring_attn_1_15_stage_5 -->
<g id="node1503" class="node">
<title>ring_attn_1_15_stage_5</title>
<polygon fill="yellow" stroke="black" points="9030,-13725 8821,-13657 9030,-13589 9239,-13657 9030,-13725"/>
<text text-anchor="middle" x="9030" y="-13675.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-13660.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="9030" y="-13645.8" font-family="Times,serif" font-size="14.00">Q[15]×K[10]×V[10]</text>
<text text-anchor="middle" x="9030" y="-13630.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_14_stage_5&#45;&gt;ring_attn_1_15_stage_5 -->
<g id="edge2470" class="edge">
<title>ring_attn_1_14_stage_5&#45;&gt;ring_attn_1_15_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-13657C8652.02,-13657 8810.86,-13657 8810.86,-13657"/>
<polygon fill="red" stroke="red" points="8810.86,-13660.5 8820.86,-13657 8810.86,-13653.5 8810.86,-13660.5"/>
</g>
<!-- ring_attn_1_14_stage_6&#45;&gt;ring_attn_1_14_stage_7 -->
<g id="edge1392" class="edge">
<title>ring_attn_1_14_stage_6&#45;&gt;ring_attn_1_14_stage_7</title>
<path fill="none" stroke="black" d="M8443,-13335.87C8443,-13335.87 8443,-13229.25 8443,-13229.25"/>
<polygon fill="black" stroke="black" points="8446.5,-13229.25 8443,-13219.25 8439.5,-13229.25 8446.5,-13229.25"/>
</g>
<!-- ring_attn_1_15_stage_6 -->
<g id="node1504" class="node">
<title>ring_attn_1_15_stage_6</title>
<polygon fill="yellow" stroke="black" points="9030,-13472 8821,-13404 9030,-13336 9239,-13404 9030,-13472"/>
<text text-anchor="middle" x="9030" y="-13422.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-13407.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="9030" y="-13392.8" font-family="Times,serif" font-size="14.00">Q[15]×K[9]×V[9]</text>
<text text-anchor="middle" x="9030" y="-13377.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_14_stage_6&#45;&gt;ring_attn_1_15_stage_6 -->
<g id="edge2471" class="edge">
<title>ring_attn_1_14_stage_6&#45;&gt;ring_attn_1_15_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-13404C8652.02,-13404 8810.86,-13404 8810.86,-13404"/>
<polygon fill="red" stroke="red" points="8810.86,-13407.5 8820.86,-13404 8810.86,-13400.5 8810.86,-13407.5"/>
</g>
<!-- ring_attn_1_14_stage_7&#45;&gt;ring_attn_1_14_stage_8 -->
<g id="edge1393" class="edge">
<title>ring_attn_1_14_stage_7&#45;&gt;ring_attn_1_14_stage_8</title>
<path fill="none" stroke="black" d="M8443,-13082.87C8443,-13082.87 8443,-12976.25 8443,-12976.25"/>
<polygon fill="black" stroke="black" points="8446.5,-12976.25 8443,-12966.25 8439.5,-12976.25 8446.5,-12976.25"/>
</g>
<!-- ring_attn_1_15_stage_7 -->
<g id="node1505" class="node">
<title>ring_attn_1_15_stage_7</title>
<polygon fill="yellow" stroke="black" points="9030,-13219 8821,-13151 9030,-13083 9239,-13151 9030,-13219"/>
<text text-anchor="middle" x="9030" y="-13169.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-13154.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="9030" y="-13139.8" font-family="Times,serif" font-size="14.00">Q[15]×K[8]×V[8]</text>
<text text-anchor="middle" x="9030" y="-13124.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_14_stage_7&#45;&gt;ring_attn_1_15_stage_7 -->
<g id="edge2472" class="edge">
<title>ring_attn_1_14_stage_7&#45;&gt;ring_attn_1_15_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-13151C8652.02,-13151 8810.86,-13151 8810.86,-13151"/>
<polygon fill="red" stroke="red" points="8810.86,-13154.5 8820.86,-13151 8810.86,-13147.5 8810.86,-13154.5"/>
</g>
<!-- ring_attn_1_14_stage_8&#45;&gt;ring_attn_1_14_stage_9 -->
<g id="edge1394" class="edge">
<title>ring_attn_1_14_stage_8&#45;&gt;ring_attn_1_14_stage_9</title>
<path fill="none" stroke="black" d="M8443,-12829.87C8443,-12829.87 8443,-12723.25 8443,-12723.25"/>
<polygon fill="black" stroke="black" points="8446.5,-12723.25 8443,-12713.25 8439.5,-12723.25 8446.5,-12723.25"/>
</g>
<!-- ring_attn_1_15_stage_8 -->
<g id="node1506" class="node">
<title>ring_attn_1_15_stage_8</title>
<polygon fill="yellow" stroke="black" points="9030,-12966 8821,-12898 9030,-12830 9239,-12898 9030,-12966"/>
<text text-anchor="middle" x="9030" y="-12916.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-12901.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="9030" y="-12886.8" font-family="Times,serif" font-size="14.00">Q[15]×K[7]×V[7]</text>
<text text-anchor="middle" x="9030" y="-12871.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_14_stage_8&#45;&gt;ring_attn_1_15_stage_8 -->
<g id="edge2473" class="edge">
<title>ring_attn_1_14_stage_8&#45;&gt;ring_attn_1_15_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-12898C8652.02,-12898 8810.86,-12898 8810.86,-12898"/>
<polygon fill="red" stroke="red" points="8810.86,-12901.5 8820.86,-12898 8810.86,-12894.5 8810.86,-12901.5"/>
</g>
<!-- ring_attn_1_14_stage_9&#45;&gt;ring_attn_1_14_stage_10 -->
<g id="edge1395" class="edge">
<title>ring_attn_1_14_stage_9&#45;&gt;ring_attn_1_14_stage_10</title>
<path fill="none" stroke="black" d="M8443,-12576.87C8443,-12576.87 8443,-12470.25 8443,-12470.25"/>
<polygon fill="black" stroke="black" points="8446.5,-12470.25 8443,-12460.25 8439.5,-12470.25 8446.5,-12470.25"/>
</g>
<!-- ring_attn_1_15_stage_9 -->
<g id="node1507" class="node">
<title>ring_attn_1_15_stage_9</title>
<polygon fill="yellow" stroke="black" points="9030,-12713 8821,-12645 9030,-12577 9239,-12645 9030,-12713"/>
<text text-anchor="middle" x="9030" y="-12663.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-12648.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="9030" y="-12633.8" font-family="Times,serif" font-size="14.00">Q[15]×K[6]×V[6]</text>
<text text-anchor="middle" x="9030" y="-12618.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_14_stage_9&#45;&gt;ring_attn_1_15_stage_9 -->
<g id="edge2474" class="edge">
<title>ring_attn_1_14_stage_9&#45;&gt;ring_attn_1_15_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-12645C8652.02,-12645 8810.86,-12645 8810.86,-12645"/>
<polygon fill="red" stroke="red" points="8810.86,-12648.5 8820.86,-12645 8810.86,-12641.5 8810.86,-12648.5"/>
</g>
<!-- ring_attn_1_14_stage_10&#45;&gt;ring_attn_1_14_stage_11 -->
<g id="edge1396" class="edge">
<title>ring_attn_1_14_stage_10&#45;&gt;ring_attn_1_14_stage_11</title>
<path fill="none" stroke="black" d="M8443,-12323.87C8443,-12323.87 8443,-12217.25 8443,-12217.25"/>
<polygon fill="black" stroke="black" points="8446.5,-12217.25 8443,-12207.25 8439.5,-12217.25 8446.5,-12217.25"/>
</g>
<!-- ring_attn_1_15_stage_10 -->
<g id="node1508" class="node">
<title>ring_attn_1_15_stage_10</title>
<polygon fill="yellow" stroke="black" points="9030,-12460 8821,-12392 9030,-12324 9239,-12392 9030,-12460"/>
<text text-anchor="middle" x="9030" y="-12410.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-12395.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="9030" y="-12380.8" font-family="Times,serif" font-size="14.00">Q[15]×K[5]×V[5]</text>
<text text-anchor="middle" x="9030" y="-12365.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_14_stage_10&#45;&gt;ring_attn_1_15_stage_10 -->
<g id="edge2475" class="edge">
<title>ring_attn_1_14_stage_10&#45;&gt;ring_attn_1_15_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-12392C8652.02,-12392 8810.86,-12392 8810.86,-12392"/>
<polygon fill="red" stroke="red" points="8810.86,-12395.5 8820.86,-12392 8810.86,-12388.5 8810.86,-12395.5"/>
</g>
<!-- ring_attn_1_14_stage_11&#45;&gt;ring_attn_1_14_stage_12 -->
<g id="edge1397" class="edge">
<title>ring_attn_1_14_stage_11&#45;&gt;ring_attn_1_14_stage_12</title>
<path fill="none" stroke="black" d="M8443,-12070.87C8443,-12070.87 8443,-11964.25 8443,-11964.25"/>
<polygon fill="black" stroke="black" points="8446.5,-11964.25 8443,-11954.25 8439.5,-11964.25 8446.5,-11964.25"/>
</g>
<!-- ring_attn_1_15_stage_11 -->
<g id="node1509" class="node">
<title>ring_attn_1_15_stage_11</title>
<polygon fill="yellow" stroke="black" points="9030,-12207 8821,-12139 9030,-12071 9239,-12139 9030,-12207"/>
<text text-anchor="middle" x="9030" y="-12157.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-12142.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="9030" y="-12127.8" font-family="Times,serif" font-size="14.00">Q[15]×K[4]×V[4]</text>
<text text-anchor="middle" x="9030" y="-12112.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_14_stage_11&#45;&gt;ring_attn_1_15_stage_11 -->
<g id="edge2476" class="edge">
<title>ring_attn_1_14_stage_11&#45;&gt;ring_attn_1_15_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-12139C8652.02,-12139 8810.86,-12139 8810.86,-12139"/>
<polygon fill="red" stroke="red" points="8810.86,-12142.5 8820.86,-12139 8810.86,-12135.5 8810.86,-12142.5"/>
</g>
<!-- ring_attn_1_14_stage_12&#45;&gt;ring_attn_1_14_stage_13 -->
<g id="edge1398" class="edge">
<title>ring_attn_1_14_stage_12&#45;&gt;ring_attn_1_14_stage_13</title>
<path fill="none" stroke="black" d="M8443,-11817.87C8443,-11817.87 8443,-11711.25 8443,-11711.25"/>
<polygon fill="black" stroke="black" points="8446.5,-11711.25 8443,-11701.25 8439.5,-11711.25 8446.5,-11711.25"/>
</g>
<!-- ring_attn_1_15_stage_12 -->
<g id="node1510" class="node">
<title>ring_attn_1_15_stage_12</title>
<polygon fill="yellow" stroke="black" points="9030,-11954 8821,-11886 9030,-11818 9239,-11886 9030,-11954"/>
<text text-anchor="middle" x="9030" y="-11904.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-11889.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="9030" y="-11874.8" font-family="Times,serif" font-size="14.00">Q[15]×K[3]×V[3]</text>
<text text-anchor="middle" x="9030" y="-11859.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_14_stage_12&#45;&gt;ring_attn_1_15_stage_12 -->
<g id="edge2477" class="edge">
<title>ring_attn_1_14_stage_12&#45;&gt;ring_attn_1_15_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-11886C8652.02,-11886 8810.86,-11886 8810.86,-11886"/>
<polygon fill="red" stroke="red" points="8810.86,-11889.5 8820.86,-11886 8810.86,-11882.5 8810.86,-11889.5"/>
</g>
<!-- ring_attn_1_14_stage_13&#45;&gt;ring_attn_1_14_stage_14 -->
<g id="edge1399" class="edge">
<title>ring_attn_1_14_stage_13&#45;&gt;ring_attn_1_14_stage_14</title>
<path fill="none" stroke="black" d="M8443,-11564.87C8443,-11564.87 8443,-11458.25 8443,-11458.25"/>
<polygon fill="black" stroke="black" points="8446.5,-11458.25 8443,-11448.25 8439.5,-11458.25 8446.5,-11458.25"/>
</g>
<!-- ring_attn_1_15_stage_13 -->
<g id="node1511" class="node">
<title>ring_attn_1_15_stage_13</title>
<polygon fill="yellow" stroke="black" points="9030,-11701 8821,-11633 9030,-11565 9239,-11633 9030,-11701"/>
<text text-anchor="middle" x="9030" y="-11651.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-11636.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="9030" y="-11621.8" font-family="Times,serif" font-size="14.00">Q[15]×K[2]×V[2]</text>
<text text-anchor="middle" x="9030" y="-11606.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_14_stage_13&#45;&gt;ring_attn_1_15_stage_13 -->
<g id="edge2478" class="edge">
<title>ring_attn_1_14_stage_13&#45;&gt;ring_attn_1_15_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-11633C8652.02,-11633 8810.86,-11633 8810.86,-11633"/>
<polygon fill="red" stroke="red" points="8810.86,-11636.5 8820.86,-11633 8810.86,-11629.5 8810.86,-11636.5"/>
</g>
<!-- ring_attn_1_14_stage_14&#45;&gt;ring_attn_1_14_stage_15 -->
<g id="edge1400" class="edge">
<title>ring_attn_1_14_stage_14&#45;&gt;ring_attn_1_14_stage_15</title>
<path fill="none" stroke="black" d="M8443,-11311.87C8443,-11311.87 8443,-11205.25 8443,-11205.25"/>
<polygon fill="black" stroke="black" points="8446.5,-11205.25 8443,-11195.25 8439.5,-11205.25 8446.5,-11205.25"/>
</g>
<!-- ring_attn_1_15_stage_14 -->
<g id="node1512" class="node">
<title>ring_attn_1_15_stage_14</title>
<polygon fill="yellow" stroke="black" points="9030,-11448 8821,-11380 9030,-11312 9239,-11380 9030,-11448"/>
<text text-anchor="middle" x="9030" y="-11398.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-11383.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="9030" y="-11368.8" font-family="Times,serif" font-size="14.00">Q[15]×K[1]×V[1]</text>
<text text-anchor="middle" x="9030" y="-11353.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_14_stage_14&#45;&gt;ring_attn_1_15_stage_14 -->
<g id="edge2479" class="edge">
<title>ring_attn_1_14_stage_14&#45;&gt;ring_attn_1_15_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-11380C8652.02,-11380 8810.86,-11380 8810.86,-11380"/>
<polygon fill="red" stroke="red" points="8810.86,-11383.5 8820.86,-11380 8810.86,-11376.5 8810.86,-11383.5"/>
</g>
<!-- attn_out_1_14 -->
<g id="node1416" class="node">
<title>attn_out_1_14</title>
<polygon fill="none" stroke="black" points="8512.5,-10986 8373.5,-10986 8373.5,-10933 8512.5,-10933 8512.5,-10986"/>
<text text-anchor="middle" x="8443" y="-10970.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="8443" y="-10955.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="8443" y="-10940.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_1_14_stage_15&#45;&gt;attn_out_1_14 -->
<g id="edge1401" class="edge">
<title>ring_attn_1_14_stage_15&#45;&gt;attn_out_1_14</title>
<path fill="none" stroke="black" d="M8443,-11058.87C8443,-11058.87 8443,-10996.18 8443,-10996.18"/>
<polygon fill="black" stroke="black" points="8446.5,-10996.18 8443,-10986.18 8439.5,-10996.18 8446.5,-10996.18"/>
</g>
<!-- ring_attn_1_15_stage_15 -->
<g id="node1513" class="node">
<title>ring_attn_1_15_stage_15</title>
<polygon fill="yellow" stroke="black" points="9030,-11195 8821,-11127 9030,-11059 9239,-11127 9030,-11195"/>
<text text-anchor="middle" x="9030" y="-11145.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-11130.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="9030" y="-11115.8" font-family="Times,serif" font-size="14.00">Q[15]×K[0]×V[0]</text>
<text text-anchor="middle" x="9030" y="-11100.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_1_14_stage_15&#45;&gt;ring_attn_1_15_stage_15 -->
<g id="edge2480" class="edge">
<title>ring_attn_1_14_stage_15&#45;&gt;ring_attn_1_15_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-11127C8652.02,-11127 8810.86,-11127 8810.86,-11127"/>
<polygon fill="red" stroke="red" points="8810.86,-11130.5 8820.86,-11127 8810.86,-11123.5 8810.86,-11130.5"/>
</g>
<!-- attn_residual_1_14 -->
<g id="node1417" class="node">
<title>attn_residual_1_14</title>
<ellipse fill="none" stroke="black" cx="8443" cy="-10833" rx="105.5" ry="27"/>
<text text-anchor="middle" x="8443" y="-10836.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="8443" y="-10821.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_1_14&#45;&gt;attn_residual_1_14 -->
<g id="edge1402" class="edge">
<title>attn_out_1_14&#45;&gt;attn_residual_1_14</title>
<path fill="none" stroke="black" d="M8443,-10932.98C8443,-10932.98 8443,-10870.36 8443,-10870.36"/>
<polygon fill="black" stroke="black" points="8446.5,-10870.36 8443,-10860.36 8439.5,-10870.36 8446.5,-10870.36"/>
</g>
<!-- ffn_up_1_14 -->
<g id="node1418" class="node">
<title>ffn_up_1_14</title>
<polygon fill="none" stroke="black" points="8522,-10733 8364,-10733 8364,-10680 8522,-10680 8522,-10733"/>
<text text-anchor="middle" x="8443" y="-10717.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="8443" y="-10702.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="8443" y="-10687.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_1_14&#45;&gt;ffn_up_1_14 -->
<g id="edge1403" class="edge">
<title>attn_residual_1_14&#45;&gt;ffn_up_1_14</title>
<path fill="none" stroke="black" d="M8443,-10805.86C8443,-10805.86 8443,-10743.16 8443,-10743.16"/>
<polygon fill="black" stroke="black" points="8446.5,-10743.16 8443,-10733.16 8439.5,-10743.16 8446.5,-10743.16"/>
</g>
<!-- ffn_gelu_1_14 -->
<g id="node1419" class="node">
<title>ffn_gelu_1_14</title>
<ellipse fill="none" stroke="black" cx="8443" cy="-10580" rx="105.5" ry="27"/>
<text text-anchor="middle" x="8443" y="-10583.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="8443" y="-10568.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_1_14&#45;&gt;ffn_gelu_1_14 -->
<g id="edge1404" class="edge">
<title>ffn_up_1_14&#45;&gt;ffn_gelu_1_14</title>
<path fill="none" stroke="black" d="M8443,-10679.98C8443,-10679.98 8443,-10617.36 8443,-10617.36"/>
<polygon fill="black" stroke="black" points="8446.5,-10617.36 8443,-10607.36 8439.5,-10617.36 8446.5,-10617.36"/>
</g>
<!-- ffn_down_1_14 -->
<g id="node1420" class="node">
<title>ffn_down_1_14</title>
<polygon fill="none" stroke="black" points="8532,-10480 8354,-10480 8354,-10427 8532,-10427 8532,-10480"/>
<text text-anchor="middle" x="8443" y="-10464.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="8443" y="-10449.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="8443" y="-10434.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_1_14&#45;&gt;ffn_down_1_14 -->
<g id="edge1405" class="edge">
<title>ffn_gelu_1_14&#45;&gt;ffn_down_1_14</title>
<path fill="none" stroke="black" d="M8443,-10552.86C8443,-10552.86 8443,-10490.16 8443,-10490.16"/>
<polygon fill="black" stroke="black" points="8446.5,-10490.16 8443,-10480.16 8439.5,-10490.16 8446.5,-10490.16"/>
</g>
<!-- ffn_residual_1_14 -->
<g id="node1421" class="node">
<title>ffn_residual_1_14</title>
<ellipse fill="none" stroke="black" cx="8443" cy="-10327" rx="105.5" ry="27"/>
<text text-anchor="middle" x="8443" y="-10330.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="8443" y="-10315.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_1_14&#45;&gt;ffn_residual_1_14 -->
<g id="edge1406" class="edge">
<title>ffn_down_1_14&#45;&gt;ffn_residual_1_14</title>
<path fill="none" stroke="black" d="M8443,-10426.98C8443,-10426.98 8443,-10364.36 8443,-10364.36"/>
<polygon fill="black" stroke="black" points="8446.5,-10364.36 8443,-10354.36 8439.5,-10364.36 8446.5,-10364.36"/>
</g>
<!-- qkv_proj_2_14 -->
<g id="node1422" class="node">
<title>qkv_proj_2_14</title>
<polygon fill="none" stroke="black" points="8525.5,-10227 8360.5,-10227 8360.5,-10174 8525.5,-10174 8525.5,-10227"/>
<text text-anchor="middle" x="8443" y="-10211.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8443" y="-10196.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="8443" y="-10181.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_1_14&#45;&gt;qkv_proj_2_14 -->
<g id="edge1407" class="edge">
<title>ffn_residual_1_14&#45;&gt;qkv_proj_2_14</title>
<path fill="none" stroke="black" d="M8443,-10299.86C8443,-10299.86 8443,-10237.16 8443,-10237.16"/>
<polygon fill="black" stroke="black" points="8446.5,-10237.16 8443,-10227.16 8439.5,-10237.16 8446.5,-10237.16"/>
</g>
<!-- qkv_reshape_2_14 -->
<g id="node1423" class="node">
<title>qkv_reshape_2_14</title>
<ellipse fill="none" stroke="black" cx="8443" cy="-10074" rx="148" ry="27"/>
<text text-anchor="middle" x="8443" y="-10077.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="8443" y="-10062.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_2_14&#45;&gt;qkv_reshape_2_14 -->
<g id="edge1408" class="edge">
<title>qkv_proj_2_14&#45;&gt;qkv_reshape_2_14</title>
<path fill="none" stroke="black" d="M8443,-10173.98C8443,-10173.98 8443,-10111.36 8443,-10111.36"/>
<polygon fill="black" stroke="black" points="8446.5,-10111.36 8443,-10101.36 8439.5,-10111.36 8446.5,-10111.36"/>
</g>
<!-- qkv_reshape_2_14&#45;&gt;ring_attn_2_14_stage_0 -->
<g id="edge1409" class="edge">
<title>qkv_reshape_2_14&#45;&gt;ring_attn_2_14_stage_0</title>
<path fill="none" stroke="black" d="M8443,-10046.72C8443,-10046.72 8443,-9940.16 8443,-9940.16"/>
<polygon fill="black" stroke="black" points="8446.5,-9940.16 8443,-9930.16 8439.5,-9940.16 8446.5,-9940.16"/>
</g>
<!-- ring_attn_2_14_stage_0&#45;&gt;ring_attn_2_14_stage_1 -->
<g id="edge1410" class="edge">
<title>ring_attn_2_14_stage_0&#45;&gt;ring_attn_2_14_stage_1</title>
<path fill="none" stroke="black" d="M8443,-9793.87C8443,-9793.87 8443,-9687.25 8443,-9687.25"/>
<polygon fill="black" stroke="black" points="8446.5,-9687.25 8443,-9677.25 8439.5,-9687.25 8446.5,-9687.25"/>
</g>
<!-- ring_attn_2_15_stage_0 -->
<g id="node1522" class="node">
<title>ring_attn_2_15_stage_0</title>
<polygon fill="yellow" stroke="black" points="9030,-9930 8821,-9862 9030,-9794 9239,-9862 9030,-9930"/>
<text text-anchor="middle" x="9030" y="-9880.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-9865.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="9030" y="-9850.8" font-family="Times,serif" font-size="14.00">Q[15]×K[15]×V[15]</text>
<text text-anchor="middle" x="9030" y="-9835.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_14_stage_0&#45;&gt;ring_attn_2_15_stage_0 -->
<g id="edge2481" class="edge">
<title>ring_attn_2_14_stage_0&#45;&gt;ring_attn_2_15_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-9862C8652.02,-9862 8810.86,-9862 8810.86,-9862"/>
<polygon fill="red" stroke="red" points="8810.86,-9865.5 8820.86,-9862 8810.86,-9858.5 8810.86,-9865.5"/>
</g>
<!-- ring_attn_2_14_stage_1&#45;&gt;ring_attn_2_14_stage_2 -->
<g id="edge1411" class="edge">
<title>ring_attn_2_14_stage_1&#45;&gt;ring_attn_2_14_stage_2</title>
<path fill="none" stroke="black" d="M8443,-9540.87C8443,-9540.87 8443,-9434.25 8443,-9434.25"/>
<polygon fill="black" stroke="black" points="8446.5,-9434.25 8443,-9424.25 8439.5,-9434.25 8446.5,-9434.25"/>
</g>
<!-- ring_attn_2_15_stage_1 -->
<g id="node1523" class="node">
<title>ring_attn_2_15_stage_1</title>
<polygon fill="yellow" stroke="black" points="9030,-9677 8821,-9609 9030,-9541 9239,-9609 9030,-9677"/>
<text text-anchor="middle" x="9030" y="-9627.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-9612.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="9030" y="-9597.8" font-family="Times,serif" font-size="14.00">Q[15]×K[14]×V[14]</text>
<text text-anchor="middle" x="9030" y="-9582.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_14_stage_1&#45;&gt;ring_attn_2_15_stage_1 -->
<g id="edge2482" class="edge">
<title>ring_attn_2_14_stage_1&#45;&gt;ring_attn_2_15_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-9609C8652.02,-9609 8810.86,-9609 8810.86,-9609"/>
<polygon fill="red" stroke="red" points="8810.86,-9612.5 8820.86,-9609 8810.86,-9605.5 8810.86,-9612.5"/>
</g>
<!-- ring_attn_2_14_stage_2&#45;&gt;ring_attn_2_14_stage_3 -->
<g id="edge1412" class="edge">
<title>ring_attn_2_14_stage_2&#45;&gt;ring_attn_2_14_stage_3</title>
<path fill="none" stroke="black" d="M8443,-9287.87C8443,-9287.87 8443,-9181.25 8443,-9181.25"/>
<polygon fill="black" stroke="black" points="8446.5,-9181.25 8443,-9171.25 8439.5,-9181.25 8446.5,-9181.25"/>
</g>
<!-- ring_attn_2_15_stage_2 -->
<g id="node1524" class="node">
<title>ring_attn_2_15_stage_2</title>
<polygon fill="yellow" stroke="black" points="9030,-9424 8821,-9356 9030,-9288 9239,-9356 9030,-9424"/>
<text text-anchor="middle" x="9030" y="-9374.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-9359.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="9030" y="-9344.8" font-family="Times,serif" font-size="14.00">Q[15]×K[13]×V[13]</text>
<text text-anchor="middle" x="9030" y="-9329.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_14_stage_2&#45;&gt;ring_attn_2_15_stage_2 -->
<g id="edge2483" class="edge">
<title>ring_attn_2_14_stage_2&#45;&gt;ring_attn_2_15_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-9356C8652.02,-9356 8810.86,-9356 8810.86,-9356"/>
<polygon fill="red" stroke="red" points="8810.86,-9359.5 8820.86,-9356 8810.86,-9352.5 8810.86,-9359.5"/>
</g>
<!-- ring_attn_2_14_stage_3&#45;&gt;ring_attn_2_14_stage_4 -->
<g id="edge1413" class="edge">
<title>ring_attn_2_14_stage_3&#45;&gt;ring_attn_2_14_stage_4</title>
<path fill="none" stroke="black" d="M8443,-9034.87C8443,-9034.87 8443,-8928.25 8443,-8928.25"/>
<polygon fill="black" stroke="black" points="8446.5,-8928.25 8443,-8918.25 8439.5,-8928.25 8446.5,-8928.25"/>
</g>
<!-- ring_attn_2_15_stage_3 -->
<g id="node1525" class="node">
<title>ring_attn_2_15_stage_3</title>
<polygon fill="yellow" stroke="black" points="9030,-9171 8821,-9103 9030,-9035 9239,-9103 9030,-9171"/>
<text text-anchor="middle" x="9030" y="-9121.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-9106.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="9030" y="-9091.8" font-family="Times,serif" font-size="14.00">Q[15]×K[12]×V[12]</text>
<text text-anchor="middle" x="9030" y="-9076.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_14_stage_3&#45;&gt;ring_attn_2_15_stage_3 -->
<g id="edge2484" class="edge">
<title>ring_attn_2_14_stage_3&#45;&gt;ring_attn_2_15_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-9103C8652.02,-9103 8810.86,-9103 8810.86,-9103"/>
<polygon fill="red" stroke="red" points="8810.86,-9106.5 8820.86,-9103 8810.86,-9099.5 8810.86,-9106.5"/>
</g>
<!-- ring_attn_2_14_stage_4&#45;&gt;ring_attn_2_14_stage_5 -->
<g id="edge1414" class="edge">
<title>ring_attn_2_14_stage_4&#45;&gt;ring_attn_2_14_stage_5</title>
<path fill="none" stroke="black" d="M8443,-8781.87C8443,-8781.87 8443,-8675.25 8443,-8675.25"/>
<polygon fill="black" stroke="black" points="8446.5,-8675.25 8443,-8665.25 8439.5,-8675.25 8446.5,-8675.25"/>
</g>
<!-- ring_attn_2_15_stage_4 -->
<g id="node1526" class="node">
<title>ring_attn_2_15_stage_4</title>
<polygon fill="yellow" stroke="black" points="9030,-8918 8821,-8850 9030,-8782 9239,-8850 9030,-8918"/>
<text text-anchor="middle" x="9030" y="-8868.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-8853.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="9030" y="-8838.8" font-family="Times,serif" font-size="14.00">Q[15]×K[11]×V[11]</text>
<text text-anchor="middle" x="9030" y="-8823.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_14_stage_4&#45;&gt;ring_attn_2_15_stage_4 -->
<g id="edge2485" class="edge">
<title>ring_attn_2_14_stage_4&#45;&gt;ring_attn_2_15_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-8850C8652.02,-8850 8810.86,-8850 8810.86,-8850"/>
<polygon fill="red" stroke="red" points="8810.86,-8853.5 8820.86,-8850 8810.86,-8846.5 8810.86,-8853.5"/>
</g>
<!-- ring_attn_2_14_stage_5&#45;&gt;ring_attn_2_14_stage_6 -->
<g id="edge1415" class="edge">
<title>ring_attn_2_14_stage_5&#45;&gt;ring_attn_2_14_stage_6</title>
<path fill="none" stroke="black" d="M8443,-8528.87C8443,-8528.87 8443,-8422.25 8443,-8422.25"/>
<polygon fill="black" stroke="black" points="8446.5,-8422.25 8443,-8412.25 8439.5,-8422.25 8446.5,-8422.25"/>
</g>
<!-- ring_attn_2_15_stage_5 -->
<g id="node1527" class="node">
<title>ring_attn_2_15_stage_5</title>
<polygon fill="yellow" stroke="black" points="9030,-8665 8821,-8597 9030,-8529 9239,-8597 9030,-8665"/>
<text text-anchor="middle" x="9030" y="-8615.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-8600.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="9030" y="-8585.8" font-family="Times,serif" font-size="14.00">Q[15]×K[10]×V[10]</text>
<text text-anchor="middle" x="9030" y="-8570.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_14_stage_5&#45;&gt;ring_attn_2_15_stage_5 -->
<g id="edge2486" class="edge">
<title>ring_attn_2_14_stage_5&#45;&gt;ring_attn_2_15_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-8597C8652.02,-8597 8810.86,-8597 8810.86,-8597"/>
<polygon fill="red" stroke="red" points="8810.86,-8600.5 8820.86,-8597 8810.86,-8593.5 8810.86,-8600.5"/>
</g>
<!-- ring_attn_2_14_stage_6&#45;&gt;ring_attn_2_14_stage_7 -->
<g id="edge1416" class="edge">
<title>ring_attn_2_14_stage_6&#45;&gt;ring_attn_2_14_stage_7</title>
<path fill="none" stroke="black" d="M8443,-8275.87C8443,-8275.87 8443,-8169.25 8443,-8169.25"/>
<polygon fill="black" stroke="black" points="8446.5,-8169.25 8443,-8159.25 8439.5,-8169.25 8446.5,-8169.25"/>
</g>
<!-- ring_attn_2_15_stage_6 -->
<g id="node1528" class="node">
<title>ring_attn_2_15_stage_6</title>
<polygon fill="yellow" stroke="black" points="9030,-8412 8821,-8344 9030,-8276 9239,-8344 9030,-8412"/>
<text text-anchor="middle" x="9030" y="-8362.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-8347.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="9030" y="-8332.8" font-family="Times,serif" font-size="14.00">Q[15]×K[9]×V[9]</text>
<text text-anchor="middle" x="9030" y="-8317.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_14_stage_6&#45;&gt;ring_attn_2_15_stage_6 -->
<g id="edge2487" class="edge">
<title>ring_attn_2_14_stage_6&#45;&gt;ring_attn_2_15_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-8344C8652.02,-8344 8810.86,-8344 8810.86,-8344"/>
<polygon fill="red" stroke="red" points="8810.86,-8347.5 8820.86,-8344 8810.86,-8340.5 8810.86,-8347.5"/>
</g>
<!-- ring_attn_2_14_stage_7&#45;&gt;ring_attn_2_14_stage_8 -->
<g id="edge1417" class="edge">
<title>ring_attn_2_14_stage_7&#45;&gt;ring_attn_2_14_stage_8</title>
<path fill="none" stroke="black" d="M8443,-8022.87C8443,-8022.87 8443,-7916.25 8443,-7916.25"/>
<polygon fill="black" stroke="black" points="8446.5,-7916.25 8443,-7906.25 8439.5,-7916.25 8446.5,-7916.25"/>
</g>
<!-- ring_attn_2_15_stage_7 -->
<g id="node1529" class="node">
<title>ring_attn_2_15_stage_7</title>
<polygon fill="yellow" stroke="black" points="9030,-8159 8821,-8091 9030,-8023 9239,-8091 9030,-8159"/>
<text text-anchor="middle" x="9030" y="-8109.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-8094.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="9030" y="-8079.8" font-family="Times,serif" font-size="14.00">Q[15]×K[8]×V[8]</text>
<text text-anchor="middle" x="9030" y="-8064.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_14_stage_7&#45;&gt;ring_attn_2_15_stage_7 -->
<g id="edge2488" class="edge">
<title>ring_attn_2_14_stage_7&#45;&gt;ring_attn_2_15_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-8091C8652.02,-8091 8810.86,-8091 8810.86,-8091"/>
<polygon fill="red" stroke="red" points="8810.86,-8094.5 8820.86,-8091 8810.86,-8087.5 8810.86,-8094.5"/>
</g>
<!-- ring_attn_2_14_stage_8&#45;&gt;ring_attn_2_14_stage_9 -->
<g id="edge1418" class="edge">
<title>ring_attn_2_14_stage_8&#45;&gt;ring_attn_2_14_stage_9</title>
<path fill="none" stroke="black" d="M8443,-7769.87C8443,-7769.87 8443,-7663.25 8443,-7663.25"/>
<polygon fill="black" stroke="black" points="8446.5,-7663.25 8443,-7653.25 8439.5,-7663.25 8446.5,-7663.25"/>
</g>
<!-- ring_attn_2_15_stage_8 -->
<g id="node1530" class="node">
<title>ring_attn_2_15_stage_8</title>
<polygon fill="yellow" stroke="black" points="9030,-7906 8821,-7838 9030,-7770 9239,-7838 9030,-7906"/>
<text text-anchor="middle" x="9030" y="-7856.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-7841.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="9030" y="-7826.8" font-family="Times,serif" font-size="14.00">Q[15]×K[7]×V[7]</text>
<text text-anchor="middle" x="9030" y="-7811.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_14_stage_8&#45;&gt;ring_attn_2_15_stage_8 -->
<g id="edge2489" class="edge">
<title>ring_attn_2_14_stage_8&#45;&gt;ring_attn_2_15_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-7838C8652.02,-7838 8810.86,-7838 8810.86,-7838"/>
<polygon fill="red" stroke="red" points="8810.86,-7841.5 8820.86,-7838 8810.86,-7834.5 8810.86,-7841.5"/>
</g>
<!-- ring_attn_2_14_stage_9&#45;&gt;ring_attn_2_14_stage_10 -->
<g id="edge1419" class="edge">
<title>ring_attn_2_14_stage_9&#45;&gt;ring_attn_2_14_stage_10</title>
<path fill="none" stroke="black" d="M8443,-7516.87C8443,-7516.87 8443,-7410.25 8443,-7410.25"/>
<polygon fill="black" stroke="black" points="8446.5,-7410.25 8443,-7400.25 8439.5,-7410.25 8446.5,-7410.25"/>
</g>
<!-- ring_attn_2_15_stage_9 -->
<g id="node1531" class="node">
<title>ring_attn_2_15_stage_9</title>
<polygon fill="yellow" stroke="black" points="9030,-7653 8821,-7585 9030,-7517 9239,-7585 9030,-7653"/>
<text text-anchor="middle" x="9030" y="-7603.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-7588.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="9030" y="-7573.8" font-family="Times,serif" font-size="14.00">Q[15]×K[6]×V[6]</text>
<text text-anchor="middle" x="9030" y="-7558.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_14_stage_9&#45;&gt;ring_attn_2_15_stage_9 -->
<g id="edge2490" class="edge">
<title>ring_attn_2_14_stage_9&#45;&gt;ring_attn_2_15_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-7585C8652.02,-7585 8810.86,-7585 8810.86,-7585"/>
<polygon fill="red" stroke="red" points="8810.86,-7588.5 8820.86,-7585 8810.86,-7581.5 8810.86,-7588.5"/>
</g>
<!-- ring_attn_2_14_stage_10&#45;&gt;ring_attn_2_14_stage_11 -->
<g id="edge1420" class="edge">
<title>ring_attn_2_14_stage_10&#45;&gt;ring_attn_2_14_stage_11</title>
<path fill="none" stroke="black" d="M8443,-7263.87C8443,-7263.87 8443,-7157.25 8443,-7157.25"/>
<polygon fill="black" stroke="black" points="8446.5,-7157.25 8443,-7147.25 8439.5,-7157.25 8446.5,-7157.25"/>
</g>
<!-- ring_attn_2_15_stage_10 -->
<g id="node1532" class="node">
<title>ring_attn_2_15_stage_10</title>
<polygon fill="yellow" stroke="black" points="9030,-7400 8821,-7332 9030,-7264 9239,-7332 9030,-7400"/>
<text text-anchor="middle" x="9030" y="-7350.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-7335.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="9030" y="-7320.8" font-family="Times,serif" font-size="14.00">Q[15]×K[5]×V[5]</text>
<text text-anchor="middle" x="9030" y="-7305.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_14_stage_10&#45;&gt;ring_attn_2_15_stage_10 -->
<g id="edge2491" class="edge">
<title>ring_attn_2_14_stage_10&#45;&gt;ring_attn_2_15_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-7332C8652.02,-7332 8810.86,-7332 8810.86,-7332"/>
<polygon fill="red" stroke="red" points="8810.86,-7335.5 8820.86,-7332 8810.86,-7328.5 8810.86,-7335.5"/>
</g>
<!-- ring_attn_2_14_stage_11&#45;&gt;ring_attn_2_14_stage_12 -->
<g id="edge1421" class="edge">
<title>ring_attn_2_14_stage_11&#45;&gt;ring_attn_2_14_stage_12</title>
<path fill="none" stroke="black" d="M8443,-7010.87C8443,-7010.87 8443,-6904.25 8443,-6904.25"/>
<polygon fill="black" stroke="black" points="8446.5,-6904.25 8443,-6894.25 8439.5,-6904.25 8446.5,-6904.25"/>
</g>
<!-- ring_attn_2_15_stage_11 -->
<g id="node1533" class="node">
<title>ring_attn_2_15_stage_11</title>
<polygon fill="yellow" stroke="black" points="9030,-7147 8821,-7079 9030,-7011 9239,-7079 9030,-7147"/>
<text text-anchor="middle" x="9030" y="-7097.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-7082.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="9030" y="-7067.8" font-family="Times,serif" font-size="14.00">Q[15]×K[4]×V[4]</text>
<text text-anchor="middle" x="9030" y="-7052.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_14_stage_11&#45;&gt;ring_attn_2_15_stage_11 -->
<g id="edge2492" class="edge">
<title>ring_attn_2_14_stage_11&#45;&gt;ring_attn_2_15_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-7079C8652.02,-7079 8810.86,-7079 8810.86,-7079"/>
<polygon fill="red" stroke="red" points="8810.86,-7082.5 8820.86,-7079 8810.86,-7075.5 8810.86,-7082.5"/>
</g>
<!-- ring_attn_2_14_stage_12&#45;&gt;ring_attn_2_14_stage_13 -->
<g id="edge1422" class="edge">
<title>ring_attn_2_14_stage_12&#45;&gt;ring_attn_2_14_stage_13</title>
<path fill="none" stroke="black" d="M8443,-6757.87C8443,-6757.87 8443,-6651.25 8443,-6651.25"/>
<polygon fill="black" stroke="black" points="8446.5,-6651.25 8443,-6641.25 8439.5,-6651.25 8446.5,-6651.25"/>
</g>
<!-- ring_attn_2_15_stage_12 -->
<g id="node1534" class="node">
<title>ring_attn_2_15_stage_12</title>
<polygon fill="yellow" stroke="black" points="9030,-6894 8821,-6826 9030,-6758 9239,-6826 9030,-6894"/>
<text text-anchor="middle" x="9030" y="-6844.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-6829.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="9030" y="-6814.8" font-family="Times,serif" font-size="14.00">Q[15]×K[3]×V[3]</text>
<text text-anchor="middle" x="9030" y="-6799.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_14_stage_12&#45;&gt;ring_attn_2_15_stage_12 -->
<g id="edge2493" class="edge">
<title>ring_attn_2_14_stage_12&#45;&gt;ring_attn_2_15_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-6826C8652.02,-6826 8810.86,-6826 8810.86,-6826"/>
<polygon fill="red" stroke="red" points="8810.86,-6829.5 8820.86,-6826 8810.86,-6822.5 8810.86,-6829.5"/>
</g>
<!-- ring_attn_2_14_stage_13&#45;&gt;ring_attn_2_14_stage_14 -->
<g id="edge1423" class="edge">
<title>ring_attn_2_14_stage_13&#45;&gt;ring_attn_2_14_stage_14</title>
<path fill="none" stroke="black" d="M8443,-6504.87C8443,-6504.87 8443,-6398.25 8443,-6398.25"/>
<polygon fill="black" stroke="black" points="8446.5,-6398.25 8443,-6388.25 8439.5,-6398.25 8446.5,-6398.25"/>
</g>
<!-- ring_attn_2_15_stage_13 -->
<g id="node1535" class="node">
<title>ring_attn_2_15_stage_13</title>
<polygon fill="yellow" stroke="black" points="9030,-6641 8821,-6573 9030,-6505 9239,-6573 9030,-6641"/>
<text text-anchor="middle" x="9030" y="-6591.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-6576.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="9030" y="-6561.8" font-family="Times,serif" font-size="14.00">Q[15]×K[2]×V[2]</text>
<text text-anchor="middle" x="9030" y="-6546.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_14_stage_13&#45;&gt;ring_attn_2_15_stage_13 -->
<g id="edge2494" class="edge">
<title>ring_attn_2_14_stage_13&#45;&gt;ring_attn_2_15_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-6573C8652.02,-6573 8810.86,-6573 8810.86,-6573"/>
<polygon fill="red" stroke="red" points="8810.86,-6576.5 8820.86,-6573 8810.86,-6569.5 8810.86,-6576.5"/>
</g>
<!-- ring_attn_2_14_stage_14&#45;&gt;ring_attn_2_14_stage_15 -->
<g id="edge1424" class="edge">
<title>ring_attn_2_14_stage_14&#45;&gt;ring_attn_2_14_stage_15</title>
<path fill="none" stroke="black" d="M8443,-6251.87C8443,-6251.87 8443,-6145.25 8443,-6145.25"/>
<polygon fill="black" stroke="black" points="8446.5,-6145.25 8443,-6135.25 8439.5,-6145.25 8446.5,-6145.25"/>
</g>
<!-- ring_attn_2_15_stage_14 -->
<g id="node1536" class="node">
<title>ring_attn_2_15_stage_14</title>
<polygon fill="yellow" stroke="black" points="9030,-6388 8821,-6320 9030,-6252 9239,-6320 9030,-6388"/>
<text text-anchor="middle" x="9030" y="-6338.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-6323.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="9030" y="-6308.8" font-family="Times,serif" font-size="14.00">Q[15]×K[1]×V[1]</text>
<text text-anchor="middle" x="9030" y="-6293.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_14_stage_14&#45;&gt;ring_attn_2_15_stage_14 -->
<g id="edge2495" class="edge">
<title>ring_attn_2_14_stage_14&#45;&gt;ring_attn_2_15_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-6320C8652.02,-6320 8810.86,-6320 8810.86,-6320"/>
<polygon fill="red" stroke="red" points="8810.86,-6323.5 8820.86,-6320 8810.86,-6316.5 8810.86,-6323.5"/>
</g>
<!-- attn_out_2_14 -->
<g id="node1440" class="node">
<title>attn_out_2_14</title>
<polygon fill="none" stroke="black" points="8512.5,-5926 8373.5,-5926 8373.5,-5873 8512.5,-5873 8512.5,-5926"/>
<text text-anchor="middle" x="8443" y="-5910.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="8443" y="-5895.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="8443" y="-5880.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_2_14_stage_15&#45;&gt;attn_out_2_14 -->
<g id="edge1425" class="edge">
<title>ring_attn_2_14_stage_15&#45;&gt;attn_out_2_14</title>
<path fill="none" stroke="black" d="M8443,-5998.87C8443,-5998.87 8443,-5936.18 8443,-5936.18"/>
<polygon fill="black" stroke="black" points="8446.5,-5936.18 8443,-5926.18 8439.5,-5936.18 8446.5,-5936.18"/>
</g>
<!-- ring_attn_2_15_stage_15 -->
<g id="node1537" class="node">
<title>ring_attn_2_15_stage_15</title>
<polygon fill="yellow" stroke="black" points="9030,-6135 8821,-6067 9030,-5999 9239,-6067 9030,-6135"/>
<text text-anchor="middle" x="9030" y="-6085.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-6070.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="9030" y="-6055.8" font-family="Times,serif" font-size="14.00">Q[15]×K[0]×V[0]</text>
<text text-anchor="middle" x="9030" y="-6040.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_2_14_stage_15&#45;&gt;ring_attn_2_15_stage_15 -->
<g id="edge2496" class="edge">
<title>ring_attn_2_14_stage_15&#45;&gt;ring_attn_2_15_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-6067C8652.02,-6067 8810.86,-6067 8810.86,-6067"/>
<polygon fill="red" stroke="red" points="8810.86,-6070.5 8820.86,-6067 8810.86,-6063.5 8810.86,-6070.5"/>
</g>
<!-- attn_residual_2_14 -->
<g id="node1441" class="node">
<title>attn_residual_2_14</title>
<ellipse fill="none" stroke="black" cx="8443" cy="-5773" rx="105.5" ry="27"/>
<text text-anchor="middle" x="8443" y="-5776.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="8443" y="-5761.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_2_14&#45;&gt;attn_residual_2_14 -->
<g id="edge1426" class="edge">
<title>attn_out_2_14&#45;&gt;attn_residual_2_14</title>
<path fill="none" stroke="black" d="M8443,-5872.98C8443,-5872.98 8443,-5810.36 8443,-5810.36"/>
<polygon fill="black" stroke="black" points="8446.5,-5810.36 8443,-5800.36 8439.5,-5810.36 8446.5,-5810.36"/>
</g>
<!-- ffn_up_2_14 -->
<g id="node1442" class="node">
<title>ffn_up_2_14</title>
<polygon fill="none" stroke="black" points="8522,-5673 8364,-5673 8364,-5620 8522,-5620 8522,-5673"/>
<text text-anchor="middle" x="8443" y="-5657.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="8443" y="-5642.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="8443" y="-5627.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_2_14&#45;&gt;ffn_up_2_14 -->
<g id="edge1427" class="edge">
<title>attn_residual_2_14&#45;&gt;ffn_up_2_14</title>
<path fill="none" stroke="black" d="M8443,-5745.86C8443,-5745.86 8443,-5683.16 8443,-5683.16"/>
<polygon fill="black" stroke="black" points="8446.5,-5683.16 8443,-5673.16 8439.5,-5683.16 8446.5,-5683.16"/>
</g>
<!-- ffn_gelu_2_14 -->
<g id="node1443" class="node">
<title>ffn_gelu_2_14</title>
<ellipse fill="none" stroke="black" cx="8443" cy="-5520" rx="105.5" ry="27"/>
<text text-anchor="middle" x="8443" y="-5523.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="8443" y="-5508.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_2_14&#45;&gt;ffn_gelu_2_14 -->
<g id="edge1428" class="edge">
<title>ffn_up_2_14&#45;&gt;ffn_gelu_2_14</title>
<path fill="none" stroke="black" d="M8443,-5619.98C8443,-5619.98 8443,-5557.36 8443,-5557.36"/>
<polygon fill="black" stroke="black" points="8446.5,-5557.36 8443,-5547.36 8439.5,-5557.36 8446.5,-5557.36"/>
</g>
<!-- ffn_down_2_14 -->
<g id="node1444" class="node">
<title>ffn_down_2_14</title>
<polygon fill="none" stroke="black" points="8532,-5420 8354,-5420 8354,-5367 8532,-5367 8532,-5420"/>
<text text-anchor="middle" x="8443" y="-5404.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="8443" y="-5389.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="8443" y="-5374.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_2_14&#45;&gt;ffn_down_2_14 -->
<g id="edge1429" class="edge">
<title>ffn_gelu_2_14&#45;&gt;ffn_down_2_14</title>
<path fill="none" stroke="black" d="M8443,-5492.86C8443,-5492.86 8443,-5430.16 8443,-5430.16"/>
<polygon fill="black" stroke="black" points="8446.5,-5430.16 8443,-5420.16 8439.5,-5430.16 8446.5,-5430.16"/>
</g>
<!-- ffn_residual_2_14 -->
<g id="node1445" class="node">
<title>ffn_residual_2_14</title>
<ellipse fill="none" stroke="black" cx="8443" cy="-5267" rx="105.5" ry="27"/>
<text text-anchor="middle" x="8443" y="-5270.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="8443" y="-5255.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_2_14&#45;&gt;ffn_residual_2_14 -->
<g id="edge1430" class="edge">
<title>ffn_down_2_14&#45;&gt;ffn_residual_2_14</title>
<path fill="none" stroke="black" d="M8443,-5366.98C8443,-5366.98 8443,-5304.36 8443,-5304.36"/>
<polygon fill="black" stroke="black" points="8446.5,-5304.36 8443,-5294.36 8439.5,-5304.36 8446.5,-5304.36"/>
</g>
<!-- qkv_proj_3_14 -->
<g id="node1446" class="node">
<title>qkv_proj_3_14</title>
<polygon fill="none" stroke="black" points="8525.5,-5167 8360.5,-5167 8360.5,-5114 8525.5,-5114 8525.5,-5167"/>
<text text-anchor="middle" x="8443" y="-5151.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8443" y="-5136.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="8443" y="-5121.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_2_14&#45;&gt;qkv_proj_3_14 -->
<g id="edge1431" class="edge">
<title>ffn_residual_2_14&#45;&gt;qkv_proj_3_14</title>
<path fill="none" stroke="black" d="M8443,-5239.86C8443,-5239.86 8443,-5177.16 8443,-5177.16"/>
<polygon fill="black" stroke="black" points="8446.5,-5177.16 8443,-5167.16 8439.5,-5177.16 8446.5,-5177.16"/>
</g>
<!-- qkv_reshape_3_14 -->
<g id="node1447" class="node">
<title>qkv_reshape_3_14</title>
<ellipse fill="none" stroke="black" cx="8443" cy="-5014" rx="148" ry="27"/>
<text text-anchor="middle" x="8443" y="-5017.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="8443" y="-5002.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_3_14&#45;&gt;qkv_reshape_3_14 -->
<g id="edge1432" class="edge">
<title>qkv_proj_3_14&#45;&gt;qkv_reshape_3_14</title>
<path fill="none" stroke="black" d="M8443,-5113.98C8443,-5113.98 8443,-5051.36 8443,-5051.36"/>
<polygon fill="black" stroke="black" points="8446.5,-5051.36 8443,-5041.36 8439.5,-5051.36 8446.5,-5051.36"/>
</g>
<!-- qkv_reshape_3_14&#45;&gt;ring_attn_3_14_stage_0 -->
<g id="edge1433" class="edge">
<title>qkv_reshape_3_14&#45;&gt;ring_attn_3_14_stage_0</title>
<path fill="none" stroke="black" d="M8443,-4986.72C8443,-4986.72 8443,-4880.16 8443,-4880.16"/>
<polygon fill="black" stroke="black" points="8446.5,-4880.16 8443,-4870.16 8439.5,-4880.16 8446.5,-4880.16"/>
</g>
<!-- ring_attn_3_14_stage_0&#45;&gt;ring_attn_3_14_stage_1 -->
<g id="edge1434" class="edge">
<title>ring_attn_3_14_stage_0&#45;&gt;ring_attn_3_14_stage_1</title>
<path fill="none" stroke="black" d="M8443,-4733.87C8443,-4733.87 8443,-4627.25 8443,-4627.25"/>
<polygon fill="black" stroke="black" points="8446.5,-4627.25 8443,-4617.25 8439.5,-4627.25 8446.5,-4627.25"/>
</g>
<!-- ring_attn_3_15_stage_0 -->
<g id="node1546" class="node">
<title>ring_attn_3_15_stage_0</title>
<polygon fill="yellow" stroke="black" points="9030,-4870 8821,-4802 9030,-4734 9239,-4802 9030,-4870"/>
<text text-anchor="middle" x="9030" y="-4820.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-4805.8" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="9030" y="-4790.8" font-family="Times,serif" font-size="14.00">Q[15]×K[15]×V[15]</text>
<text text-anchor="middle" x="9030" y="-4775.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_14_stage_0&#45;&gt;ring_attn_3_15_stage_0 -->
<g id="edge2497" class="edge">
<title>ring_attn_3_14_stage_0&#45;&gt;ring_attn_3_15_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-4802C8652.02,-4802 8810.86,-4802 8810.86,-4802"/>
<polygon fill="red" stroke="red" points="8810.86,-4805.5 8820.86,-4802 8810.86,-4798.5 8810.86,-4805.5"/>
</g>
<!-- ring_attn_3_14_stage_1&#45;&gt;ring_attn_3_14_stage_2 -->
<g id="edge1435" class="edge">
<title>ring_attn_3_14_stage_1&#45;&gt;ring_attn_3_14_stage_2</title>
<path fill="none" stroke="black" d="M8443,-4480.87C8443,-4480.87 8443,-4374.25 8443,-4374.25"/>
<polygon fill="black" stroke="black" points="8446.5,-4374.25 8443,-4364.25 8439.5,-4374.25 8446.5,-4374.25"/>
</g>
<!-- ring_attn_3_15_stage_1 -->
<g id="node1547" class="node">
<title>ring_attn_3_15_stage_1</title>
<polygon fill="yellow" stroke="black" points="9030,-4617 8821,-4549 9030,-4481 9239,-4549 9030,-4617"/>
<text text-anchor="middle" x="9030" y="-4567.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-4552.8" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="9030" y="-4537.8" font-family="Times,serif" font-size="14.00">Q[15]×K[14]×V[14]</text>
<text text-anchor="middle" x="9030" y="-4522.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_14_stage_1&#45;&gt;ring_attn_3_15_stage_1 -->
<g id="edge2498" class="edge">
<title>ring_attn_3_14_stage_1&#45;&gt;ring_attn_3_15_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-4549C8652.02,-4549 8810.86,-4549 8810.86,-4549"/>
<polygon fill="red" stroke="red" points="8810.86,-4552.5 8820.86,-4549 8810.86,-4545.5 8810.86,-4552.5"/>
</g>
<!-- ring_attn_3_14_stage_2&#45;&gt;ring_attn_3_14_stage_3 -->
<g id="edge1436" class="edge">
<title>ring_attn_3_14_stage_2&#45;&gt;ring_attn_3_14_stage_3</title>
<path fill="none" stroke="black" d="M8443,-4227.87C8443,-4227.87 8443,-4121.25 8443,-4121.25"/>
<polygon fill="black" stroke="black" points="8446.5,-4121.25 8443,-4111.25 8439.5,-4121.25 8446.5,-4121.25"/>
</g>
<!-- ring_attn_3_15_stage_2 -->
<g id="node1548" class="node">
<title>ring_attn_3_15_stage_2</title>
<polygon fill="yellow" stroke="black" points="9030,-4364 8821,-4296 9030,-4228 9239,-4296 9030,-4364"/>
<text text-anchor="middle" x="9030" y="-4314.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-4299.8" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="9030" y="-4284.8" font-family="Times,serif" font-size="14.00">Q[15]×K[13]×V[13]</text>
<text text-anchor="middle" x="9030" y="-4269.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_14_stage_2&#45;&gt;ring_attn_3_15_stage_2 -->
<g id="edge2499" class="edge">
<title>ring_attn_3_14_stage_2&#45;&gt;ring_attn_3_15_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-4296C8652.02,-4296 8810.86,-4296 8810.86,-4296"/>
<polygon fill="red" stroke="red" points="8810.86,-4299.5 8820.86,-4296 8810.86,-4292.5 8810.86,-4299.5"/>
</g>
<!-- ring_attn_3_14_stage_3&#45;&gt;ring_attn_3_14_stage_4 -->
<g id="edge1437" class="edge">
<title>ring_attn_3_14_stage_3&#45;&gt;ring_attn_3_14_stage_4</title>
<path fill="none" stroke="black" d="M8443,-3974.87C8443,-3974.87 8443,-3868.25 8443,-3868.25"/>
<polygon fill="black" stroke="black" points="8446.5,-3868.25 8443,-3858.25 8439.5,-3868.25 8446.5,-3868.25"/>
</g>
<!-- ring_attn_3_15_stage_3 -->
<g id="node1549" class="node">
<title>ring_attn_3_15_stage_3</title>
<polygon fill="yellow" stroke="black" points="9030,-4111 8821,-4043 9030,-3975 9239,-4043 9030,-4111"/>
<text text-anchor="middle" x="9030" y="-4061.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-4046.8" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="9030" y="-4031.8" font-family="Times,serif" font-size="14.00">Q[15]×K[12]×V[12]</text>
<text text-anchor="middle" x="9030" y="-4016.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_14_stage_3&#45;&gt;ring_attn_3_15_stage_3 -->
<g id="edge2500" class="edge">
<title>ring_attn_3_14_stage_3&#45;&gt;ring_attn_3_15_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-4043C8652.02,-4043 8810.86,-4043 8810.86,-4043"/>
<polygon fill="red" stroke="red" points="8810.86,-4046.5 8820.86,-4043 8810.86,-4039.5 8810.86,-4046.5"/>
</g>
<!-- ring_attn_3_14_stage_4&#45;&gt;ring_attn_3_14_stage_5 -->
<g id="edge1438" class="edge">
<title>ring_attn_3_14_stage_4&#45;&gt;ring_attn_3_14_stage_5</title>
<path fill="none" stroke="black" d="M8443,-3721.87C8443,-3721.87 8443,-3615.25 8443,-3615.25"/>
<polygon fill="black" stroke="black" points="8446.5,-3615.25 8443,-3605.25 8439.5,-3615.25 8446.5,-3615.25"/>
</g>
<!-- ring_attn_3_15_stage_4 -->
<g id="node1550" class="node">
<title>ring_attn_3_15_stage_4</title>
<polygon fill="yellow" stroke="black" points="9030,-3858 8821,-3790 9030,-3722 9239,-3790 9030,-3858"/>
<text text-anchor="middle" x="9030" y="-3808.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-3793.8" font-family="Times,serif" font-size="14.00">Stage 4</text>
<text text-anchor="middle" x="9030" y="-3778.8" font-family="Times,serif" font-size="14.00">Q[15]×K[11]×V[11]</text>
<text text-anchor="middle" x="9030" y="-3763.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_14_stage_4&#45;&gt;ring_attn_3_15_stage_4 -->
<g id="edge2501" class="edge">
<title>ring_attn_3_14_stage_4&#45;&gt;ring_attn_3_15_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-3790C8652.02,-3790 8810.86,-3790 8810.86,-3790"/>
<polygon fill="red" stroke="red" points="8810.86,-3793.5 8820.86,-3790 8810.86,-3786.5 8810.86,-3793.5"/>
</g>
<!-- ring_attn_3_14_stage_5&#45;&gt;ring_attn_3_14_stage_6 -->
<g id="edge1439" class="edge">
<title>ring_attn_3_14_stage_5&#45;&gt;ring_attn_3_14_stage_6</title>
<path fill="none" stroke="black" d="M8443,-3468.87C8443,-3468.87 8443,-3362.25 8443,-3362.25"/>
<polygon fill="black" stroke="black" points="8446.5,-3362.25 8443,-3352.25 8439.5,-3362.25 8446.5,-3362.25"/>
</g>
<!-- ring_attn_3_15_stage_5 -->
<g id="node1551" class="node">
<title>ring_attn_3_15_stage_5</title>
<polygon fill="yellow" stroke="black" points="9030,-3605 8821,-3537 9030,-3469 9239,-3537 9030,-3605"/>
<text text-anchor="middle" x="9030" y="-3555.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-3540.8" font-family="Times,serif" font-size="14.00">Stage 5</text>
<text text-anchor="middle" x="9030" y="-3525.8" font-family="Times,serif" font-size="14.00">Q[15]×K[10]×V[10]</text>
<text text-anchor="middle" x="9030" y="-3510.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_14_stage_5&#45;&gt;ring_attn_3_15_stage_5 -->
<g id="edge2502" class="edge">
<title>ring_attn_3_14_stage_5&#45;&gt;ring_attn_3_15_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-3537C8652.02,-3537 8810.86,-3537 8810.86,-3537"/>
<polygon fill="red" stroke="red" points="8810.86,-3540.5 8820.86,-3537 8810.86,-3533.5 8810.86,-3540.5"/>
</g>
<!-- ring_attn_3_14_stage_6&#45;&gt;ring_attn_3_14_stage_7 -->
<g id="edge1440" class="edge">
<title>ring_attn_3_14_stage_6&#45;&gt;ring_attn_3_14_stage_7</title>
<path fill="none" stroke="black" d="M8443,-3215.87C8443,-3215.87 8443,-3109.25 8443,-3109.25"/>
<polygon fill="black" stroke="black" points="8446.5,-3109.25 8443,-3099.25 8439.5,-3109.25 8446.5,-3109.25"/>
</g>
<!-- ring_attn_3_15_stage_6 -->
<g id="node1552" class="node">
<title>ring_attn_3_15_stage_6</title>
<polygon fill="yellow" stroke="black" points="9030,-3352 8821,-3284 9030,-3216 9239,-3284 9030,-3352"/>
<text text-anchor="middle" x="9030" y="-3302.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-3287.8" font-family="Times,serif" font-size="14.00">Stage 6</text>
<text text-anchor="middle" x="9030" y="-3272.8" font-family="Times,serif" font-size="14.00">Q[15]×K[9]×V[9]</text>
<text text-anchor="middle" x="9030" y="-3257.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_14_stage_6&#45;&gt;ring_attn_3_15_stage_6 -->
<g id="edge2503" class="edge">
<title>ring_attn_3_14_stage_6&#45;&gt;ring_attn_3_15_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-3284C8652.02,-3284 8810.86,-3284 8810.86,-3284"/>
<polygon fill="red" stroke="red" points="8810.86,-3287.5 8820.86,-3284 8810.86,-3280.5 8810.86,-3287.5"/>
</g>
<!-- ring_attn_3_14_stage_7&#45;&gt;ring_attn_3_14_stage_8 -->
<g id="edge1441" class="edge">
<title>ring_attn_3_14_stage_7&#45;&gt;ring_attn_3_14_stage_8</title>
<path fill="none" stroke="black" d="M8443,-2962.87C8443,-2962.87 8443,-2856.25 8443,-2856.25"/>
<polygon fill="black" stroke="black" points="8446.5,-2856.25 8443,-2846.25 8439.5,-2856.25 8446.5,-2856.25"/>
</g>
<!-- ring_attn_3_15_stage_7 -->
<g id="node1553" class="node">
<title>ring_attn_3_15_stage_7</title>
<polygon fill="yellow" stroke="black" points="9030,-3099 8821,-3031 9030,-2963 9239,-3031 9030,-3099"/>
<text text-anchor="middle" x="9030" y="-3049.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-3034.8" font-family="Times,serif" font-size="14.00">Stage 7</text>
<text text-anchor="middle" x="9030" y="-3019.8" font-family="Times,serif" font-size="14.00">Q[15]×K[8]×V[8]</text>
<text text-anchor="middle" x="9030" y="-3004.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_14_stage_7&#45;&gt;ring_attn_3_15_stage_7 -->
<g id="edge2504" class="edge">
<title>ring_attn_3_14_stage_7&#45;&gt;ring_attn_3_15_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-3031C8652.02,-3031 8810.86,-3031 8810.86,-3031"/>
<polygon fill="red" stroke="red" points="8810.86,-3034.5 8820.86,-3031 8810.86,-3027.5 8810.86,-3034.5"/>
</g>
<!-- ring_attn_3_14_stage_8&#45;&gt;ring_attn_3_14_stage_9 -->
<g id="edge1442" class="edge">
<title>ring_attn_3_14_stage_8&#45;&gt;ring_attn_3_14_stage_9</title>
<path fill="none" stroke="black" d="M8443,-2709.87C8443,-2709.87 8443,-2603.25 8443,-2603.25"/>
<polygon fill="black" stroke="black" points="8446.5,-2603.25 8443,-2593.25 8439.5,-2603.25 8446.5,-2603.25"/>
</g>
<!-- ring_attn_3_15_stage_8 -->
<g id="node1554" class="node">
<title>ring_attn_3_15_stage_8</title>
<polygon fill="yellow" stroke="black" points="9030,-2846 8821,-2778 9030,-2710 9239,-2778 9030,-2846"/>
<text text-anchor="middle" x="9030" y="-2796.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-2781.8" font-family="Times,serif" font-size="14.00">Stage 8</text>
<text text-anchor="middle" x="9030" y="-2766.8" font-family="Times,serif" font-size="14.00">Q[15]×K[7]×V[7]</text>
<text text-anchor="middle" x="9030" y="-2751.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_14_stage_8&#45;&gt;ring_attn_3_15_stage_8 -->
<g id="edge2505" class="edge">
<title>ring_attn_3_14_stage_8&#45;&gt;ring_attn_3_15_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-2778C8652.02,-2778 8810.86,-2778 8810.86,-2778"/>
<polygon fill="red" stroke="red" points="8810.86,-2781.5 8820.86,-2778 8810.86,-2774.5 8810.86,-2781.5"/>
</g>
<!-- ring_attn_3_14_stage_9&#45;&gt;ring_attn_3_14_stage_10 -->
<g id="edge1443" class="edge">
<title>ring_attn_3_14_stage_9&#45;&gt;ring_attn_3_14_stage_10</title>
<path fill="none" stroke="black" d="M8443,-2456.87C8443,-2456.87 8443,-2350.25 8443,-2350.25"/>
<polygon fill="black" stroke="black" points="8446.5,-2350.25 8443,-2340.25 8439.5,-2350.25 8446.5,-2350.25"/>
</g>
<!-- ring_attn_3_15_stage_9 -->
<g id="node1555" class="node">
<title>ring_attn_3_15_stage_9</title>
<polygon fill="yellow" stroke="black" points="9030,-2593 8821,-2525 9030,-2457 9239,-2525 9030,-2593"/>
<text text-anchor="middle" x="9030" y="-2543.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-2528.8" font-family="Times,serif" font-size="14.00">Stage 9</text>
<text text-anchor="middle" x="9030" y="-2513.8" font-family="Times,serif" font-size="14.00">Q[15]×K[6]×V[6]</text>
<text text-anchor="middle" x="9030" y="-2498.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_14_stage_9&#45;&gt;ring_attn_3_15_stage_9 -->
<g id="edge2506" class="edge">
<title>ring_attn_3_14_stage_9&#45;&gt;ring_attn_3_15_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-2525C8652.02,-2525 8810.86,-2525 8810.86,-2525"/>
<polygon fill="red" stroke="red" points="8810.86,-2528.5 8820.86,-2525 8810.86,-2521.5 8810.86,-2528.5"/>
</g>
<!-- ring_attn_3_14_stage_10&#45;&gt;ring_attn_3_14_stage_11 -->
<g id="edge1444" class="edge">
<title>ring_attn_3_14_stage_10&#45;&gt;ring_attn_3_14_stage_11</title>
<path fill="none" stroke="black" d="M8443,-2203.87C8443,-2203.87 8443,-2097.25 8443,-2097.25"/>
<polygon fill="black" stroke="black" points="8446.5,-2097.25 8443,-2087.25 8439.5,-2097.25 8446.5,-2097.25"/>
</g>
<!-- ring_attn_3_15_stage_10 -->
<g id="node1556" class="node">
<title>ring_attn_3_15_stage_10</title>
<polygon fill="yellow" stroke="black" points="9030,-2340 8821,-2272 9030,-2204 9239,-2272 9030,-2340"/>
<text text-anchor="middle" x="9030" y="-2290.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-2275.8" font-family="Times,serif" font-size="14.00">Stage 10</text>
<text text-anchor="middle" x="9030" y="-2260.8" font-family="Times,serif" font-size="14.00">Q[15]×K[5]×V[5]</text>
<text text-anchor="middle" x="9030" y="-2245.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_14_stage_10&#45;&gt;ring_attn_3_15_stage_10 -->
<g id="edge2507" class="edge">
<title>ring_attn_3_14_stage_10&#45;&gt;ring_attn_3_15_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-2272C8652.02,-2272 8810.86,-2272 8810.86,-2272"/>
<polygon fill="red" stroke="red" points="8810.86,-2275.5 8820.86,-2272 8810.86,-2268.5 8810.86,-2275.5"/>
</g>
<!-- ring_attn_3_14_stage_11&#45;&gt;ring_attn_3_14_stage_12 -->
<g id="edge1445" class="edge">
<title>ring_attn_3_14_stage_11&#45;&gt;ring_attn_3_14_stage_12</title>
<path fill="none" stroke="black" d="M8443,-1950.87C8443,-1950.87 8443,-1844.25 8443,-1844.25"/>
<polygon fill="black" stroke="black" points="8446.5,-1844.25 8443,-1834.25 8439.5,-1844.25 8446.5,-1844.25"/>
</g>
<!-- ring_attn_3_15_stage_11 -->
<g id="node1557" class="node">
<title>ring_attn_3_15_stage_11</title>
<polygon fill="yellow" stroke="black" points="9030,-2087 8821,-2019 9030,-1951 9239,-2019 9030,-2087"/>
<text text-anchor="middle" x="9030" y="-2037.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-2022.8" font-family="Times,serif" font-size="14.00">Stage 11</text>
<text text-anchor="middle" x="9030" y="-2007.8" font-family="Times,serif" font-size="14.00">Q[15]×K[4]×V[4]</text>
<text text-anchor="middle" x="9030" y="-1992.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_14_stage_11&#45;&gt;ring_attn_3_15_stage_11 -->
<g id="edge2508" class="edge">
<title>ring_attn_3_14_stage_11&#45;&gt;ring_attn_3_15_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-2019C8652.02,-2019 8810.86,-2019 8810.86,-2019"/>
<polygon fill="red" stroke="red" points="8810.86,-2022.5 8820.86,-2019 8810.86,-2015.5 8810.86,-2022.5"/>
</g>
<!-- ring_attn_3_14_stage_12&#45;&gt;ring_attn_3_14_stage_13 -->
<g id="edge1446" class="edge">
<title>ring_attn_3_14_stage_12&#45;&gt;ring_attn_3_14_stage_13</title>
<path fill="none" stroke="black" d="M8443,-1697.87C8443,-1697.87 8443,-1591.25 8443,-1591.25"/>
<polygon fill="black" stroke="black" points="8446.5,-1591.25 8443,-1581.25 8439.5,-1591.25 8446.5,-1591.25"/>
</g>
<!-- ring_attn_3_15_stage_12 -->
<g id="node1558" class="node">
<title>ring_attn_3_15_stage_12</title>
<polygon fill="yellow" stroke="black" points="9030,-1834 8821,-1766 9030,-1698 9239,-1766 9030,-1834"/>
<text text-anchor="middle" x="9030" y="-1784.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-1769.8" font-family="Times,serif" font-size="14.00">Stage 12</text>
<text text-anchor="middle" x="9030" y="-1754.8" font-family="Times,serif" font-size="14.00">Q[15]×K[3]×V[3]</text>
<text text-anchor="middle" x="9030" y="-1739.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_14_stage_12&#45;&gt;ring_attn_3_15_stage_12 -->
<g id="edge2509" class="edge">
<title>ring_attn_3_14_stage_12&#45;&gt;ring_attn_3_15_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-1766C8652.02,-1766 8810.86,-1766 8810.86,-1766"/>
<polygon fill="red" stroke="red" points="8810.86,-1769.5 8820.86,-1766 8810.86,-1762.5 8810.86,-1769.5"/>
</g>
<!-- ring_attn_3_14_stage_13&#45;&gt;ring_attn_3_14_stage_14 -->
<g id="edge1447" class="edge">
<title>ring_attn_3_14_stage_13&#45;&gt;ring_attn_3_14_stage_14</title>
<path fill="none" stroke="black" d="M8443,-1444.87C8443,-1444.87 8443,-1338.25 8443,-1338.25"/>
<polygon fill="black" stroke="black" points="8446.5,-1338.25 8443,-1328.25 8439.5,-1338.25 8446.5,-1338.25"/>
</g>
<!-- ring_attn_3_15_stage_13 -->
<g id="node1559" class="node">
<title>ring_attn_3_15_stage_13</title>
<polygon fill="yellow" stroke="black" points="9030,-1581 8821,-1513 9030,-1445 9239,-1513 9030,-1581"/>
<text text-anchor="middle" x="9030" y="-1531.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-1516.8" font-family="Times,serif" font-size="14.00">Stage 13</text>
<text text-anchor="middle" x="9030" y="-1501.8" font-family="Times,serif" font-size="14.00">Q[15]×K[2]×V[2]</text>
<text text-anchor="middle" x="9030" y="-1486.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_14_stage_13&#45;&gt;ring_attn_3_15_stage_13 -->
<g id="edge2510" class="edge">
<title>ring_attn_3_14_stage_13&#45;&gt;ring_attn_3_15_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-1513C8652.02,-1513 8810.86,-1513 8810.86,-1513"/>
<polygon fill="red" stroke="red" points="8810.86,-1516.5 8820.86,-1513 8810.86,-1509.5 8810.86,-1516.5"/>
</g>
<!-- ring_attn_3_14_stage_14&#45;&gt;ring_attn_3_14_stage_15 -->
<g id="edge1448" class="edge">
<title>ring_attn_3_14_stage_14&#45;&gt;ring_attn_3_14_stage_15</title>
<path fill="none" stroke="black" d="M8443,-1191.87C8443,-1191.87 8443,-1085.25 8443,-1085.25"/>
<polygon fill="black" stroke="black" points="8446.5,-1085.25 8443,-1075.25 8439.5,-1085.25 8446.5,-1085.25"/>
</g>
<!-- ring_attn_3_15_stage_14 -->
<g id="node1560" class="node">
<title>ring_attn_3_15_stage_14</title>
<polygon fill="yellow" stroke="black" points="9030,-1328 8821,-1260 9030,-1192 9239,-1260 9030,-1328"/>
<text text-anchor="middle" x="9030" y="-1278.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-1263.8" font-family="Times,serif" font-size="14.00">Stage 14</text>
<text text-anchor="middle" x="9030" y="-1248.8" font-family="Times,serif" font-size="14.00">Q[15]×K[1]×V[1]</text>
<text text-anchor="middle" x="9030" y="-1233.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_14_stage_14&#45;&gt;ring_attn_3_15_stage_14 -->
<g id="edge2511" class="edge">
<title>ring_attn_3_14_stage_14&#45;&gt;ring_attn_3_15_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-1260C8652.02,-1260 8810.86,-1260 8810.86,-1260"/>
<polygon fill="red" stroke="red" points="8810.86,-1263.5 8820.86,-1260 8810.86,-1256.5 8810.86,-1263.5"/>
</g>
<!-- attn_out_3_14 -->
<g id="node1464" class="node">
<title>attn_out_3_14</title>
<polygon fill="none" stroke="black" points="8512.5,-866 8373.5,-866 8373.5,-813 8512.5,-813 8512.5,-866"/>
<text text-anchor="middle" x="8443" y="-850.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="8443" y="-835.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="8443" y="-820.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_3_14_stage_15&#45;&gt;attn_out_3_14 -->
<g id="edge1449" class="edge">
<title>ring_attn_3_14_stage_15&#45;&gt;attn_out_3_14</title>
<path fill="none" stroke="black" d="M8443,-938.87C8443,-938.87 8443,-876.18 8443,-876.18"/>
<polygon fill="black" stroke="black" points="8446.5,-876.18 8443,-866.18 8439.5,-876.18 8446.5,-876.18"/>
</g>
<!-- ring_attn_3_15_stage_15 -->
<g id="node1561" class="node">
<title>ring_attn_3_15_stage_15</title>
<polygon fill="yellow" stroke="black" points="9030,-1075 8821,-1007 9030,-939 9239,-1007 9030,-1075"/>
<text text-anchor="middle" x="9030" y="-1025.8" font-family="Times,serif" font-size="14.00">Ring Attention</text>
<text text-anchor="middle" x="9030" y="-1010.8" font-family="Times,serif" font-size="14.00">Stage 15</text>
<text text-anchor="middle" x="9030" y="-995.8" font-family="Times,serif" font-size="14.00">Q[15]×K[0]×V[0]</text>
<text text-anchor="middle" x="9030" y="-980.8" font-family="Times,serif" font-size="14.00">1024×1024×1024×2×128</text>
</g>
<!-- ring_attn_3_14_stage_15&#45;&gt;ring_attn_3_15_stage_15 -->
<g id="edge2512" class="edge">
<title>ring_attn_3_14_stage_15&#45;&gt;ring_attn_3_15_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8652.02,-1007C8652.02,-1007 8810.86,-1007 8810.86,-1007"/>
<polygon fill="red" stroke="red" points="8810.86,-1010.5 8820.86,-1007 8810.86,-1003.5 8810.86,-1010.5"/>
</g>
<!-- attn_residual_3_14 -->
<g id="node1465" class="node">
<title>attn_residual_3_14</title>
<ellipse fill="none" stroke="black" cx="8443" cy="-713" rx="105.5" ry="27"/>
<text text-anchor="middle" x="8443" y="-716.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="8443" y="-701.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_3_14&#45;&gt;attn_residual_3_14 -->
<g id="edge1450" class="edge">
<title>attn_out_3_14&#45;&gt;attn_residual_3_14</title>
<path fill="none" stroke="black" d="M8443,-812.98C8443,-812.98 8443,-750.36 8443,-750.36"/>
<polygon fill="black" stroke="black" points="8446.5,-750.36 8443,-740.36 8439.5,-750.36 8446.5,-750.36"/>
</g>
<!-- ffn_up_3_14 -->
<g id="node1466" class="node">
<title>ffn_up_3_14</title>
<polygon fill="none" stroke="black" points="8522,-613 8364,-613 8364,-560 8522,-560 8522,-613"/>
<text text-anchor="middle" x="8443" y="-597.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="8443" y="-582.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="8443" y="-567.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_3_14&#45;&gt;ffn_up_3_14 -->
<g id="edge1451" class="edge">
<title>attn_residual_3_14&#45;&gt;ffn_up_3_14</title>
<path fill="none" stroke="black" d="M8443,-685.86C8443,-685.86 8443,-623.16 8443,-623.16"/>
<polygon fill="black" stroke="black" points="8446.5,-623.16 8443,-613.16 8439.5,-623.16 8446.5,-623.16"/>
</g>
<!-- ffn_gelu_3_14 -->
<g id="node1467" class="node">
<title>ffn_gelu_3_14</title>
<ellipse fill="none" stroke="black" cx="8443" cy="-460" rx="105.5" ry="27"/>
<text text-anchor="middle" x="8443" y="-463.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="8443" y="-448.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_3_14&#45;&gt;ffn_gelu_3_14 -->
<g id="edge1452" class="edge">
<title>ffn_up_3_14&#45;&gt;ffn_gelu_3_14</title>
<path fill="none" stroke="black" d="M8443,-559.98C8443,-559.98 8443,-497.36 8443,-497.36"/>
<polygon fill="black" stroke="black" points="8446.5,-497.36 8443,-487.36 8439.5,-497.36 8446.5,-497.36"/>
</g>
<!-- ffn_down_3_14 -->
<g id="node1468" class="node">
<title>ffn_down_3_14</title>
<polygon fill="none" stroke="black" points="8532,-360 8354,-360 8354,-307 8532,-307 8532,-360"/>
<text text-anchor="middle" x="8443" y="-344.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="8443" y="-329.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="8443" y="-314.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_3_14&#45;&gt;ffn_down_3_14 -->
<g id="edge1453" class="edge">
<title>ffn_gelu_3_14&#45;&gt;ffn_down_3_14</title>
<path fill="none" stroke="black" d="M8443,-432.86C8443,-432.86 8443,-370.16 8443,-370.16"/>
<polygon fill="black" stroke="black" points="8446.5,-370.16 8443,-360.16 8439.5,-370.16 8446.5,-370.16"/>
</g>
<!-- ffn_residual_3_14 -->
<g id="node1469" class="node">
<title>ffn_residual_3_14</title>
<ellipse fill="none" stroke="black" cx="8443" cy="-207" rx="105.5" ry="27"/>
<text text-anchor="middle" x="8443" y="-210.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="8443" y="-195.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_3_14&#45;&gt;ffn_residual_3_14 -->
<g id="edge1454" class="edge">
<title>ffn_down_3_14&#45;&gt;ffn_residual_3_14</title>
<path fill="none" stroke="black" d="M8443,-306.98C8443,-306.98 8443,-244.36 8443,-244.36"/>
<polygon fill="black" stroke="black" points="8446.5,-244.36 8443,-234.36 8439.5,-244.36 8446.5,-244.36"/>
</g>
<!-- output_14 -->
<g id="node1470" class="node">
<title>output_14</title>
<polygon fill="lightcoral" stroke="black" points="8540.5,-107 8345.5,-107 8345.5,-69 8540.5,-69 8540.5,-107"/>
<text text-anchor="middle" x="8443" y="-91.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="8443" y="-76.8" font-family="Times,serif" font-size="14.00">Y[14]: 1024×1024×4096</text>
</g>
<!-- ffn_residual_3_14&#45;&gt;output_14 -->
<g id="edge1455" class="edge">
<title>ffn_residual_3_14&#45;&gt;output_14</title>
<path fill="none" stroke="black" d="M8443,-180C8443,-180 8443,-117.12 8443,-117.12"/>
<polygon fill="black" stroke="black" points="8446.5,-117.12 8443,-107.12 8439.5,-117.12 8446.5,-117.12"/>
</g>
<!-- input_15 -->
<g id="node1471" class="node">
<title>input_15</title>
<polygon fill="lightgreen" stroke="black" points="9128,-20458 8932,-20458 8932,-20420 9128,-20420 9128,-20458"/>
<text text-anchor="middle" x="9030" y="-20442.8" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="9030" y="-20427.8" font-family="Times,serif" font-size="14.00">X[15]: 1024×1024×4096</text>
</g>
<!-- qkv_proj_0_15 -->
<g id="node1472" class="node">
<title>qkv_proj_0_15</title>
<polygon fill="none" stroke="black" points="9112.5,-20347 8947.5,-20347 8947.5,-20294 9112.5,-20294 9112.5,-20347"/>
<text text-anchor="middle" x="9030" y="-20331.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9030" y="-20316.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="9030" y="-20301.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- input_15&#45;&gt;qkv_proj_0_15 -->
<g id="edge1456" class="edge">
<title>input_15&#45;&gt;qkv_proj_0_15</title>
<path fill="none" stroke="black" d="M9030,-20419.96C9030,-20419.96 9030,-20357.44 9030,-20357.44"/>
<polygon fill="black" stroke="black" points="9033.5,-20357.44 9030,-20347.44 9026.5,-20357.44 9033.5,-20357.44"/>
</g>
<!-- qkv_reshape_0_15 -->
<g id="node1473" class="node">
<title>qkv_reshape_0_15</title>
<ellipse fill="none" stroke="black" cx="9030" cy="-20194" rx="148" ry="27"/>
<text text-anchor="middle" x="9030" y="-20197.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="9030" y="-20182.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_0_15&#45;&gt;qkv_reshape_0_15 -->
<g id="edge1457" class="edge">
<title>qkv_proj_0_15&#45;&gt;qkv_reshape_0_15</title>
<path fill="none" stroke="black" d="M9030,-20293.98C9030,-20293.98 9030,-20231.36 9030,-20231.36"/>
<polygon fill="black" stroke="black" points="9033.5,-20231.36 9030,-20221.36 9026.5,-20231.36 9033.5,-20231.36"/>
</g>
<!-- qkv_reshape_0_15&#45;&gt;ring_attn_0_15_stage_0 -->
<g id="edge1458" class="edge">
<title>qkv_reshape_0_15&#45;&gt;ring_attn_0_15_stage_0</title>
<path fill="none" stroke="black" d="M9030,-20166.72C9030,-20166.72 9030,-20060.16 9030,-20060.16"/>
<polygon fill="black" stroke="black" points="9033.5,-20060.16 9030,-20050.16 9026.5,-20060.16 9033.5,-20060.16"/>
</g>
<!-- ring_attn_0_15_stage_0&#45;&gt;ring_attn_0_0_stage_0 -->
<g id="edge2513" class="edge">
<title>ring_attn_0_15_stage_0&#45;&gt;ring_attn_0_0_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8851.5,-19992.31C8851.5,-20022.4 8851.5,-20108 8851.5,-20108 8851.5,-20108 403.5,-20108 403.5,-20108 403.5,-20108 403.5,-20002.31 403.5,-20002.31"/>
<polygon fill="red" stroke="red" points="407,-20002.31 403.5,-19992.31 400,-20002.31 407,-20002.31"/>
<text text-anchor="middle" x="4628" y="-20119.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-20104.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-20089.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_0_15_stage_0&#45;&gt;ring_attn_0_15_stage_1 -->
<g id="edge1459" class="edge">
<title>ring_attn_0_15_stage_0&#45;&gt;ring_attn_0_15_stage_1</title>
<path fill="none" stroke="black" d="M9099.67,-19936.48C9099.67,-19936.48 9099.67,-19784.58 9099.67,-19784.58"/>
<polygon fill="black" stroke="black" points="9103.17,-19784.58 9099.67,-19774.58 9096.17,-19784.58 9103.17,-19784.58"/>
</g>
<!-- ring_attn_0_15_stage_1&#45;&gt;ring_attn_0_0_stage_1 -->
<g id="edge2514" class="edge">
<title>ring_attn_0_15_stage_1&#45;&gt;ring_attn_0_0_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-19774.49C8960.33,-19810.58 8960.33,-19855 8960.33,-19855 8960.33,-19855 294.67,-19855 294.67,-19855 294.67,-19855 294.67,-19784.49 294.67,-19784.49"/>
<polygon fill="red" stroke="red" points="298.17,-19784.49 294.67,-19774.49 291.17,-19784.49 298.17,-19784.49"/>
<text text-anchor="middle" x="4628" y="-19866.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-19851.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-19836.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_0_15_stage_1&#45;&gt;ring_attn_0_15_stage_2 -->
<g id="edge1460" class="edge">
<title>ring_attn_0_15_stage_1&#45;&gt;ring_attn_0_15_stage_2</title>
<path fill="none" stroke="black" d="M9099.67,-19683.48C9099.67,-19683.48 9099.67,-19531.58 9099.67,-19531.58"/>
<polygon fill="black" stroke="black" points="9103.17,-19531.58 9099.67,-19521.58 9096.17,-19531.58 9103.17,-19531.58"/>
</g>
<!-- ring_attn_0_15_stage_2&#45;&gt;ring_attn_0_0_stage_2 -->
<g id="edge2515" class="edge">
<title>ring_attn_0_15_stage_2&#45;&gt;ring_attn_0_0_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-19521.49C8960.33,-19557.58 8960.33,-19602 8960.33,-19602 8960.33,-19602 294.67,-19602 294.67,-19602 294.67,-19602 294.67,-19531.49 294.67,-19531.49"/>
<polygon fill="red" stroke="red" points="298.17,-19531.49 294.67,-19521.49 291.17,-19531.49 298.17,-19531.49"/>
<text text-anchor="middle" x="4628" y="-19613.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-19598.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-19583.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_0_15_stage_2&#45;&gt;ring_attn_0_15_stage_3 -->
<g id="edge1461" class="edge">
<title>ring_attn_0_15_stage_2&#45;&gt;ring_attn_0_15_stage_3</title>
<path fill="none" stroke="black" d="M9099.67,-19430.48C9099.67,-19430.48 9099.67,-19278.58 9099.67,-19278.58"/>
<polygon fill="black" stroke="black" points="9103.17,-19278.58 9099.67,-19268.58 9096.17,-19278.58 9103.17,-19278.58"/>
</g>
<!-- ring_attn_0_15_stage_3&#45;&gt;ring_attn_0_0_stage_3 -->
<g id="edge2516" class="edge">
<title>ring_attn_0_15_stage_3&#45;&gt;ring_attn_0_0_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-19268.49C8960.33,-19304.58 8960.33,-19349 8960.33,-19349 8960.33,-19349 294.67,-19349 294.67,-19349 294.67,-19349 294.67,-19278.49 294.67,-19278.49"/>
<polygon fill="red" stroke="red" points="298.17,-19278.49 294.67,-19268.49 291.17,-19278.49 298.17,-19278.49"/>
<text text-anchor="middle" x="4628" y="-19360.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-19345.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-19330.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_0_15_stage_3&#45;&gt;ring_attn_0_15_stage_4 -->
<g id="edge1462" class="edge">
<title>ring_attn_0_15_stage_3&#45;&gt;ring_attn_0_15_stage_4</title>
<path fill="none" stroke="black" d="M9030,-19154.87C9030,-19154.87 9030,-19048.25 9030,-19048.25"/>
<polygon fill="black" stroke="black" points="9033.5,-19048.25 9030,-19038.25 9026.5,-19048.25 9033.5,-19048.25"/>
</g>
<!-- ring_attn_0_15_stage_4&#45;&gt;ring_attn_0_0_stage_4 -->
<g id="edge2517" class="edge">
<title>ring_attn_0_15_stage_4&#45;&gt;ring_attn_0_0_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-18924.51C8960.33,-18888.07 8960.33,-18843 8960.33,-18843 8960.33,-18843 294.67,-18843 294.67,-18843 294.67,-18843 294.67,-18914.51 294.67,-18914.51"/>
<polygon fill="red" stroke="red" points="291.17,-18914.51 294.67,-18924.51 298.17,-18914.51 291.17,-18914.51"/>
<text text-anchor="middle" x="4628" y="-19107.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-19092.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-19077.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_0_15_stage_4&#45;&gt;ring_attn_0_15_stage_5 -->
<g id="edge1463" class="edge">
<title>ring_attn_0_15_stage_4&#45;&gt;ring_attn_0_15_stage_5</title>
<path fill="none" stroke="black" d="M9099.67,-18924.48C9099.67,-18924.48 9099.67,-18772.58 9099.67,-18772.58"/>
<polygon fill="black" stroke="black" points="9103.17,-18772.58 9099.67,-18762.58 9096.17,-18772.58 9103.17,-18772.58"/>
</g>
<!-- ring_attn_0_15_stage_5&#45;&gt;ring_attn_0_0_stage_5 -->
<g id="edge2518" class="edge">
<title>ring_attn_0_15_stage_5&#45;&gt;ring_attn_0_0_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-18671.51C8960.33,-18635.07 8960.33,-18590 8960.33,-18590 8960.33,-18590 294.67,-18590 294.67,-18590 294.67,-18590 294.67,-18661.51 294.67,-18661.51"/>
<polygon fill="red" stroke="red" points="291.17,-18661.51 294.67,-18671.51 298.17,-18661.51 291.17,-18661.51"/>
<text text-anchor="middle" x="4628" y="-18854.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-18839.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-18824.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_0_15_stage_5&#45;&gt;ring_attn_0_15_stage_6 -->
<g id="edge1464" class="edge">
<title>ring_attn_0_15_stage_5&#45;&gt;ring_attn_0_15_stage_6</title>
<path fill="none" stroke="black" d="M9099.67,-18671.48C9099.67,-18671.48 9099.67,-18519.58 9099.67,-18519.58"/>
<polygon fill="black" stroke="black" points="9103.17,-18519.58 9099.67,-18509.58 9096.17,-18519.58 9103.17,-18519.58"/>
</g>
<!-- ring_attn_0_15_stage_6&#45;&gt;ring_attn_0_0_stage_6 -->
<g id="edge2519" class="edge">
<title>ring_attn_0_15_stage_6&#45;&gt;ring_attn_0_0_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8925.5,-18429.85C8925.5,-18398.54 8925.5,-18357 8925.5,-18357 8925.5,-18357 329.5,-18357 329.5,-18357 329.5,-18357 329.5,-18419.85 329.5,-18419.85"/>
<polygon fill="red" stroke="red" points="326,-18419.85 329.5,-18429.85 333,-18419.85 326,-18419.85"/>
<text text-anchor="middle" x="4628" y="-18601.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-18586.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-18571.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_0_15_stage_6&#45;&gt;ring_attn_0_15_stage_7 -->
<g id="edge1465" class="edge">
<title>ring_attn_0_15_stage_6&#45;&gt;ring_attn_0_15_stage_7</title>
<path fill="none" stroke="black" d="M9134.5,-18429.88C9134.5,-18429.88 9134.5,-18255.39 9134.5,-18255.39"/>
<polygon fill="black" stroke="black" points="9138,-18255.39 9134.5,-18245.39 9131,-18255.39 9138,-18255.39"/>
</g>
<!-- ring_attn_0_15_stage_7&#45;&gt;ring_attn_0_0_stage_7 -->
<g id="edge2520" class="edge">
<title>ring_attn_0_15_stage_7&#45;&gt;ring_attn_0_0_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9030,-18279.07C9030,-18300.17 9030,-18318 9030,-18318 9030,-18318 225,-18318 225,-18318 225,-18318 225,-18289.07 225,-18289.07"/>
<polygon fill="red" stroke="red" points="228.5,-18289.07 225,-18279.07 221.5,-18289.07 228.5,-18289.07"/>
<text text-anchor="middle" x="4628" y="-18348.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-18333.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-18318.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_0_15_stage_7&#45;&gt;ring_attn_0_15_stage_8 -->
<g id="edge1466" class="edge">
<title>ring_attn_0_15_stage_7&#45;&gt;ring_attn_0_15_stage_8</title>
<path fill="none" stroke="black" d="M9099.67,-18165.48C9099.67,-18165.48 9099.67,-18013.58 9099.67,-18013.58"/>
<polygon fill="black" stroke="black" points="9103.17,-18013.58 9099.67,-18003.58 9096.17,-18013.58 9103.17,-18013.58"/>
</g>
<!-- ring_attn_0_15_stage_8&#45;&gt;ring_attn_0_0_stage_8 -->
<g id="edge2521" class="edge">
<title>ring_attn_0_15_stage_8&#45;&gt;ring_attn_0_0_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-18003.49C8960.33,-18039.58 8960.33,-18084 8960.33,-18084 8960.33,-18084 294.67,-18084 294.67,-18084 294.67,-18084 294.67,-18013.49 294.67,-18013.49"/>
<polygon fill="red" stroke="red" points="298.17,-18013.49 294.67,-18003.49 291.17,-18013.49 298.17,-18013.49"/>
<text text-anchor="middle" x="4628" y="-18095.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-18080.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-18065.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_0_15_stage_8&#45;&gt;ring_attn_0_15_stage_9 -->
<g id="edge1467" class="edge">
<title>ring_attn_0_15_stage_8&#45;&gt;ring_attn_0_15_stage_9</title>
<path fill="none" stroke="black" d="M9099.67,-17912.48C9099.67,-17912.48 9099.67,-17760.58 9099.67,-17760.58"/>
<polygon fill="black" stroke="black" points="9103.17,-17760.58 9099.67,-17750.58 9096.17,-17760.58 9103.17,-17760.58"/>
</g>
<!-- ring_attn_0_15_stage_9&#45;&gt;ring_attn_0_0_stage_9 -->
<g id="edge2522" class="edge">
<title>ring_attn_0_15_stage_9&#45;&gt;ring_attn_0_0_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-17750.49C8960.33,-17786.58 8960.33,-17831 8960.33,-17831 8960.33,-17831 294.67,-17831 294.67,-17831 294.67,-17831 294.67,-17760.49 294.67,-17760.49"/>
<polygon fill="red" stroke="red" points="298.17,-17760.49 294.67,-17750.49 291.17,-17760.49 298.17,-17760.49"/>
<text text-anchor="middle" x="4628" y="-17842.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-17827.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-17812.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_0_15_stage_9&#45;&gt;ring_attn_0_15_stage_10 -->
<g id="edge1468" class="edge">
<title>ring_attn_0_15_stage_9&#45;&gt;ring_attn_0_15_stage_10</title>
<path fill="none" stroke="black" d="M9099.67,-17659.48C9099.67,-17659.48 9099.67,-17507.58 9099.67,-17507.58"/>
<polygon fill="black" stroke="black" points="9103.17,-17507.58 9099.67,-17497.58 9096.17,-17507.58 9103.17,-17507.58"/>
</g>
<!-- ring_attn_0_15_stage_10&#45;&gt;ring_attn_0_0_stage_10 -->
<g id="edge2523" class="edge">
<title>ring_attn_0_15_stage_10&#45;&gt;ring_attn_0_0_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-17497.49C8960.33,-17533.58 8960.33,-17578 8960.33,-17578 8960.33,-17578 294.67,-17578 294.67,-17578 294.67,-17578 294.67,-17507.49 294.67,-17507.49"/>
<polygon fill="red" stroke="red" points="298.17,-17507.49 294.67,-17497.49 291.17,-17507.49 298.17,-17507.49"/>
<text text-anchor="middle" x="4628" y="-17589.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-17574.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-17559.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_0_15_stage_10&#45;&gt;ring_attn_0_15_stage_11 -->
<g id="edge1469" class="edge">
<title>ring_attn_0_15_stage_10&#45;&gt;ring_attn_0_15_stage_11</title>
<path fill="none" stroke="black" d="M9099.67,-17406.48C9099.67,-17406.48 9099.67,-17254.58 9099.67,-17254.58"/>
<polygon fill="black" stroke="black" points="9103.17,-17254.58 9099.67,-17244.58 9096.17,-17254.58 9103.17,-17254.58"/>
</g>
<!-- ring_attn_0_15_stage_11&#45;&gt;ring_attn_0_0_stage_11 -->
<g id="edge2524" class="edge">
<title>ring_attn_0_15_stage_11&#45;&gt;ring_attn_0_0_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-17244.49C8960.33,-17280.58 8960.33,-17325 8960.33,-17325 8960.33,-17325 294.67,-17325 294.67,-17325 294.67,-17325 294.67,-17254.49 294.67,-17254.49"/>
<polygon fill="red" stroke="red" points="298.17,-17254.49 294.67,-17244.49 291.17,-17254.49 298.17,-17254.49"/>
<text text-anchor="middle" x="4628" y="-17336.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-17321.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-17306.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_0_15_stage_11&#45;&gt;ring_attn_0_15_stage_12 -->
<g id="edge1470" class="edge">
<title>ring_attn_0_15_stage_11&#45;&gt;ring_attn_0_15_stage_12</title>
<path fill="none" stroke="black" d="M9099.67,-17153.48C9099.67,-17153.48 9099.67,-17001.58 9099.67,-17001.58"/>
<polygon fill="black" stroke="black" points="9103.17,-17001.58 9099.67,-16991.58 9096.17,-17001.58 9103.17,-17001.58"/>
</g>
<!-- ring_attn_0_15_stage_12&#45;&gt;ring_attn_0_0_stage_12 -->
<g id="edge2525" class="edge">
<title>ring_attn_0_15_stage_12&#45;&gt;ring_attn_0_0_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-16991.49C8960.33,-17027.58 8960.33,-17072 8960.33,-17072 8960.33,-17072 294.67,-17072 294.67,-17072 294.67,-17072 294.67,-17001.49 294.67,-17001.49"/>
<polygon fill="red" stroke="red" points="298.17,-17001.49 294.67,-16991.49 291.17,-17001.49 298.17,-17001.49"/>
<text text-anchor="middle" x="4628" y="-17083.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-17068.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-17053.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_0_15_stage_12&#45;&gt;ring_attn_0_15_stage_13 -->
<g id="edge1471" class="edge">
<title>ring_attn_0_15_stage_12&#45;&gt;ring_attn_0_15_stage_13</title>
<path fill="none" stroke="black" d="M9099.67,-16900.48C9099.67,-16900.48 9099.67,-16748.58 9099.67,-16748.58"/>
<polygon fill="black" stroke="black" points="9103.17,-16748.58 9099.67,-16738.58 9096.17,-16748.58 9103.17,-16748.58"/>
</g>
<!-- ring_attn_0_15_stage_13&#45;&gt;ring_attn_0_0_stage_13 -->
<g id="edge2526" class="edge">
<title>ring_attn_0_15_stage_13&#45;&gt;ring_attn_0_0_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-16738.49C8960.33,-16774.58 8960.33,-16819 8960.33,-16819 8960.33,-16819 294.67,-16819 294.67,-16819 294.67,-16819 294.67,-16748.49 294.67,-16748.49"/>
<polygon fill="red" stroke="red" points="298.17,-16748.49 294.67,-16738.49 291.17,-16748.49 298.17,-16748.49"/>
<text text-anchor="middle" x="4628" y="-16830.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-16815.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-16800.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_0_15_stage_13&#45;&gt;ring_attn_0_15_stage_14 -->
<g id="edge1472" class="edge">
<title>ring_attn_0_15_stage_13&#45;&gt;ring_attn_0_15_stage_14</title>
<path fill="none" stroke="black" d="M9030,-16624.87C9030,-16624.87 9030,-16518.25 9030,-16518.25"/>
<polygon fill="black" stroke="black" points="9033.5,-16518.25 9030,-16508.25 9026.5,-16518.25 9033.5,-16518.25"/>
</g>
<!-- ring_attn_0_15_stage_14&#45;&gt;ring_attn_0_0_stage_14 -->
<g id="edge2527" class="edge">
<title>ring_attn_0_15_stage_14&#45;&gt;ring_attn_0_0_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-16394.51C8960.33,-16358.07 8960.33,-16313 8960.33,-16313 8960.33,-16313 294.67,-16313 294.67,-16313 294.67,-16313 294.67,-16384.51 294.67,-16384.51"/>
<polygon fill="red" stroke="red" points="291.17,-16384.51 294.67,-16394.51 298.17,-16384.51 291.17,-16384.51"/>
<text text-anchor="middle" x="4628" y="-16577.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-16562.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-16547.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_0_15_stage_14&#45;&gt;ring_attn_0_15_stage_15 -->
<g id="edge1473" class="edge">
<title>ring_attn_0_15_stage_14&#45;&gt;ring_attn_0_15_stage_15</title>
<path fill="none" stroke="black" d="M9099.67,-16394.48C9099.67,-16394.48 9099.67,-16242.58 9099.67,-16242.58"/>
<polygon fill="black" stroke="black" points="9103.17,-16242.58 9099.67,-16232.58 9096.17,-16242.58 9103.17,-16242.58"/>
</g>
<!-- ring_attn_0_15_stage_15&#45;&gt;ring_attn_0_0_stage_15 -->
<g id="edge2528" class="edge">
<title>ring_attn_0_15_stage_15&#45;&gt;ring_attn_0_0_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8861.67,-16173.7C8861.67,-16145.45 8861.67,-16082 8861.67,-16082 8861.67,-16082 413.67,-16082 413.67,-16082 413.67,-16082 413.67,-16170.11 413.67,-16170.11"/>
<polygon fill="red" stroke="red" points="410.17,-16170.11 413.67,-16180.11 417.17,-16170.11 410.17,-16170.11"/>
<text text-anchor="middle" x="4628" y="-16324.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-16309.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-16294.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_0_15 -->
<g id="node1490" class="node">
<title>attn_out_0_15</title>
<polygon fill="none" stroke="black" points="9099.5,-16046 8960.5,-16046 8960.5,-15993 9099.5,-15993 9099.5,-16046"/>
<text text-anchor="middle" x="9030" y="-16030.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9030" y="-16015.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="9030" y="-16000.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_0_15_stage_15&#45;&gt;attn_out_0_15 -->
<g id="edge1474" class="edge">
<title>ring_attn_0_15_stage_15&#45;&gt;attn_out_0_15</title>
<path fill="none" stroke="black" d="M9030,-16118.87C9030,-16118.87 9030,-16056.18 9030,-16056.18"/>
<polygon fill="black" stroke="black" points="9033.5,-16056.18 9030,-16046.18 9026.5,-16056.18 9033.5,-16056.18"/>
</g>
<!-- attn_residual_0_15 -->
<g id="node1491" class="node">
<title>attn_residual_0_15</title>
<ellipse fill="none" stroke="black" cx="9030" cy="-15893" rx="105.5" ry="27"/>
<text text-anchor="middle" x="9030" y="-15896.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="9030" y="-15881.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_0_15&#45;&gt;attn_residual_0_15 -->
<g id="edge1475" class="edge">
<title>attn_out_0_15&#45;&gt;attn_residual_0_15</title>
<path fill="none" stroke="black" d="M9030,-15992.98C9030,-15992.98 9030,-15930.36 9030,-15930.36"/>
<polygon fill="black" stroke="black" points="9033.5,-15930.36 9030,-15920.36 9026.5,-15930.36 9033.5,-15930.36"/>
</g>
<!-- ffn_up_0_15 -->
<g id="node1492" class="node">
<title>ffn_up_0_15</title>
<polygon fill="none" stroke="black" points="9109,-15793 8951,-15793 8951,-15740 9109,-15740 9109,-15793"/>
<text text-anchor="middle" x="9030" y="-15777.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9030" y="-15762.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="9030" y="-15747.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_0_15&#45;&gt;ffn_up_0_15 -->
<g id="edge1476" class="edge">
<title>attn_residual_0_15&#45;&gt;ffn_up_0_15</title>
<path fill="none" stroke="black" d="M9030,-15865.86C9030,-15865.86 9030,-15803.16 9030,-15803.16"/>
<polygon fill="black" stroke="black" points="9033.5,-15803.16 9030,-15793.16 9026.5,-15803.16 9033.5,-15803.16"/>
</g>
<!-- ffn_gelu_0_15 -->
<g id="node1493" class="node">
<title>ffn_gelu_0_15</title>
<ellipse fill="none" stroke="black" cx="9030" cy="-15640" rx="105.5" ry="27"/>
<text text-anchor="middle" x="9030" y="-15643.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="9030" y="-15628.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_0_15&#45;&gt;ffn_gelu_0_15 -->
<g id="edge1477" class="edge">
<title>ffn_up_0_15&#45;&gt;ffn_gelu_0_15</title>
<path fill="none" stroke="black" d="M9030,-15739.98C9030,-15739.98 9030,-15677.36 9030,-15677.36"/>
<polygon fill="black" stroke="black" points="9033.5,-15677.36 9030,-15667.36 9026.5,-15677.36 9033.5,-15677.36"/>
</g>
<!-- ffn_down_0_15 -->
<g id="node1494" class="node">
<title>ffn_down_0_15</title>
<polygon fill="none" stroke="black" points="9119,-15540 8941,-15540 8941,-15487 9119,-15487 9119,-15540"/>
<text text-anchor="middle" x="9030" y="-15524.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9030" y="-15509.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="9030" y="-15494.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_0_15&#45;&gt;ffn_down_0_15 -->
<g id="edge1478" class="edge">
<title>ffn_gelu_0_15&#45;&gt;ffn_down_0_15</title>
<path fill="none" stroke="black" d="M9030,-15612.86C9030,-15612.86 9030,-15550.16 9030,-15550.16"/>
<polygon fill="black" stroke="black" points="9033.5,-15550.16 9030,-15540.16 9026.5,-15550.16 9033.5,-15550.16"/>
</g>
<!-- ffn_residual_0_15 -->
<g id="node1495" class="node">
<title>ffn_residual_0_15</title>
<ellipse fill="none" stroke="black" cx="9030" cy="-15387" rx="105.5" ry="27"/>
<text text-anchor="middle" x="9030" y="-15390.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="9030" y="-15375.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_0_15&#45;&gt;ffn_residual_0_15 -->
<g id="edge1479" class="edge">
<title>ffn_down_0_15&#45;&gt;ffn_residual_0_15</title>
<path fill="none" stroke="black" d="M9030,-15486.98C9030,-15486.98 9030,-15424.36 9030,-15424.36"/>
<polygon fill="black" stroke="black" points="9033.5,-15424.36 9030,-15414.36 9026.5,-15424.36 9033.5,-15424.36"/>
</g>
<!-- qkv_proj_1_15 -->
<g id="node1496" class="node">
<title>qkv_proj_1_15</title>
<polygon fill="none" stroke="black" points="9112.5,-15287 8947.5,-15287 8947.5,-15234 9112.5,-15234 9112.5,-15287"/>
<text text-anchor="middle" x="9030" y="-15271.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9030" y="-15256.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="9030" y="-15241.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_0_15&#45;&gt;qkv_proj_1_15 -->
<g id="edge1480" class="edge">
<title>ffn_residual_0_15&#45;&gt;qkv_proj_1_15</title>
<path fill="none" stroke="black" d="M9030,-15359.86C9030,-15359.86 9030,-15297.16 9030,-15297.16"/>
<polygon fill="black" stroke="black" points="9033.5,-15297.16 9030,-15287.16 9026.5,-15297.16 9033.5,-15297.16"/>
</g>
<!-- qkv_reshape_1_15 -->
<g id="node1497" class="node">
<title>qkv_reshape_1_15</title>
<ellipse fill="none" stroke="black" cx="9030" cy="-15134" rx="148" ry="27"/>
<text text-anchor="middle" x="9030" y="-15137.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="9030" y="-15122.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_1_15&#45;&gt;qkv_reshape_1_15 -->
<g id="edge1481" class="edge">
<title>qkv_proj_1_15&#45;&gt;qkv_reshape_1_15</title>
<path fill="none" stroke="black" d="M9030,-15233.98C9030,-15233.98 9030,-15171.36 9030,-15171.36"/>
<polygon fill="black" stroke="black" points="9033.5,-15171.36 9030,-15161.36 9026.5,-15171.36 9033.5,-15171.36"/>
</g>
<!-- qkv_reshape_1_15&#45;&gt;ring_attn_1_15_stage_0 -->
<g id="edge1482" class="edge">
<title>qkv_reshape_1_15&#45;&gt;ring_attn_1_15_stage_0</title>
<path fill="none" stroke="black" d="M9030,-15106.72C9030,-15106.72 9030,-15000.16 9030,-15000.16"/>
<polygon fill="black" stroke="black" points="9033.5,-15000.16 9030,-14990.16 9026.5,-15000.16 9033.5,-15000.16"/>
</g>
<!-- ring_attn_1_15_stage_0&#45;&gt;ring_attn_1_0_stage_0 -->
<g id="edge2529" class="edge">
<title>ring_attn_1_15_stage_0&#45;&gt;ring_attn_1_0_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8841.33,-14928.77C8841.33,-14954.95 8841.33,-15048 8841.33,-15048 8841.33,-15048 393.33,-15048 393.33,-15048 393.33,-15048 393.33,-14945.48 393.33,-14945.48"/>
<polygon fill="red" stroke="red" points="396.83,-14945.48 393.33,-14935.48 389.83,-14945.48 396.83,-14945.48"/>
<text text-anchor="middle" x="4628" y="-15059.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-15044.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-15029.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_1_15_stage_0&#45;&gt;ring_attn_1_15_stage_1 -->
<g id="edge1483" class="edge">
<title>ring_attn_1_15_stage_0&#45;&gt;ring_attn_1_15_stage_1</title>
<path fill="none" stroke="black" d="M9099.67,-14876.48C9099.67,-14876.48 9099.67,-14724.58 9099.67,-14724.58"/>
<polygon fill="black" stroke="black" points="9103.17,-14724.58 9099.67,-14714.58 9096.17,-14724.58 9103.17,-14724.58"/>
</g>
<!-- ring_attn_1_15_stage_1&#45;&gt;ring_attn_1_0_stage_1 -->
<g id="edge2530" class="edge">
<title>ring_attn_1_15_stage_1&#45;&gt;ring_attn_1_0_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-14714.49C8960.33,-14750.58 8960.33,-14795 8960.33,-14795 8960.33,-14795 294.67,-14795 294.67,-14795 294.67,-14795 294.67,-14724.49 294.67,-14724.49"/>
<polygon fill="red" stroke="red" points="298.17,-14724.49 294.67,-14714.49 291.17,-14724.49 298.17,-14724.49"/>
<text text-anchor="middle" x="4628" y="-14806.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-14791.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-14776.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_1_15_stage_1&#45;&gt;ring_attn_1_15_stage_2 -->
<g id="edge1484" class="edge">
<title>ring_attn_1_15_stage_1&#45;&gt;ring_attn_1_15_stage_2</title>
<path fill="none" stroke="black" d="M9099.67,-14623.48C9099.67,-14623.48 9099.67,-14471.58 9099.67,-14471.58"/>
<polygon fill="black" stroke="black" points="9103.17,-14471.58 9099.67,-14461.58 9096.17,-14471.58 9103.17,-14471.58"/>
</g>
<!-- ring_attn_1_15_stage_2&#45;&gt;ring_attn_1_0_stage_2 -->
<g id="edge2531" class="edge">
<title>ring_attn_1_15_stage_2&#45;&gt;ring_attn_1_0_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-14461.49C8960.33,-14497.58 8960.33,-14542 8960.33,-14542 8960.33,-14542 294.67,-14542 294.67,-14542 294.67,-14542 294.67,-14471.49 294.67,-14471.49"/>
<polygon fill="red" stroke="red" points="298.17,-14471.49 294.67,-14461.49 291.17,-14471.49 298.17,-14471.49"/>
<text text-anchor="middle" x="4628" y="-14553.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-14538.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-14523.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_1_15_stage_2&#45;&gt;ring_attn_1_15_stage_3 -->
<g id="edge1485" class="edge">
<title>ring_attn_1_15_stage_2&#45;&gt;ring_attn_1_15_stage_3</title>
<path fill="none" stroke="black" d="M9099.67,-14370.48C9099.67,-14370.48 9099.67,-14218.58 9099.67,-14218.58"/>
<polygon fill="black" stroke="black" points="9103.17,-14218.58 9099.67,-14208.58 9096.17,-14218.58 9103.17,-14218.58"/>
</g>
<!-- ring_attn_1_15_stage_3&#45;&gt;ring_attn_1_0_stage_3 -->
<g id="edge2532" class="edge">
<title>ring_attn_1_15_stage_3&#45;&gt;ring_attn_1_0_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-14208.49C8960.33,-14244.58 8960.33,-14289 8960.33,-14289 8960.33,-14289 294.67,-14289 294.67,-14289 294.67,-14289 294.67,-14218.49 294.67,-14218.49"/>
<polygon fill="red" stroke="red" points="298.17,-14218.49 294.67,-14208.49 291.17,-14218.49 298.17,-14218.49"/>
<text text-anchor="middle" x="4628" y="-14300.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-14285.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-14270.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_1_15_stage_3&#45;&gt;ring_attn_1_15_stage_4 -->
<g id="edge1486" class="edge">
<title>ring_attn_1_15_stage_3&#45;&gt;ring_attn_1_15_stage_4</title>
<path fill="none" stroke="black" d="M9030,-14094.87C9030,-14094.87 9030,-13988.25 9030,-13988.25"/>
<polygon fill="black" stroke="black" points="9033.5,-13988.25 9030,-13978.25 9026.5,-13988.25 9033.5,-13988.25"/>
</g>
<!-- ring_attn_1_15_stage_4&#45;&gt;ring_attn_1_0_stage_4 -->
<g id="edge2533" class="edge">
<title>ring_attn_1_15_stage_4&#45;&gt;ring_attn_1_0_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8925.5,-13875.85C8925.5,-13844.54 8925.5,-13803 8925.5,-13803 8925.5,-13803 329.5,-13803 329.5,-13803 329.5,-13803 329.5,-13865.85 329.5,-13865.85"/>
<polygon fill="red" stroke="red" points="326,-13865.85 329.5,-13875.85 333,-13865.85 326,-13865.85"/>
<text text-anchor="middle" x="4628" y="-14047.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-14032.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-14017.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_1_15_stage_4&#45;&gt;ring_attn_1_15_stage_5 -->
<g id="edge1487" class="edge">
<title>ring_attn_1_15_stage_4&#45;&gt;ring_attn_1_15_stage_5</title>
<path fill="none" stroke="black" d="M9134.5,-13875.88C9134.5,-13875.88 9134.5,-13701.39 9134.5,-13701.39"/>
<polygon fill="black" stroke="black" points="9138,-13701.39 9134.5,-13691.39 9131,-13701.39 9138,-13701.39"/>
</g>
<!-- ring_attn_1_15_stage_5&#45;&gt;ring_attn_1_0_stage_5 -->
<g id="edge2534" class="edge">
<title>ring_attn_1_15_stage_5&#45;&gt;ring_attn_1_0_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9030,-13725.07C9030,-13746.17 9030,-13764 9030,-13764 9030,-13764 225,-13764 225,-13764 225,-13764 225,-13735.07 225,-13735.07"/>
<polygon fill="red" stroke="red" points="228.5,-13735.07 225,-13725.07 221.5,-13735.07 228.5,-13735.07"/>
<text text-anchor="middle" x="4628" y="-13794.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-13779.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-13764.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_1_15_stage_5&#45;&gt;ring_attn_1_15_stage_6 -->
<g id="edge1488" class="edge">
<title>ring_attn_1_15_stage_5&#45;&gt;ring_attn_1_15_stage_6</title>
<path fill="none" stroke="black" d="M9030,-13588.87C9030,-13588.87 9030,-13482.25 9030,-13482.25"/>
<polygon fill="black" stroke="black" points="9033.5,-13482.25 9030,-13472.25 9026.5,-13482.25 9033.5,-13482.25"/>
</g>
<!-- ring_attn_1_15_stage_6&#45;&gt;ring_attn_1_0_stage_6 -->
<g id="edge2535" class="edge">
<title>ring_attn_1_15_stage_6&#45;&gt;ring_attn_1_0_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-13358.51C8960.33,-13322.07 8960.33,-13277 8960.33,-13277 8960.33,-13277 294.67,-13277 294.67,-13277 294.67,-13277 294.67,-13348.51 294.67,-13348.51"/>
<polygon fill="red" stroke="red" points="291.17,-13348.51 294.67,-13358.51 298.17,-13348.51 291.17,-13348.51"/>
<text text-anchor="middle" x="4628" y="-13541.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-13526.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-13511.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_1_15_stage_6&#45;&gt;ring_attn_1_15_stage_7 -->
<g id="edge1489" class="edge">
<title>ring_attn_1_15_stage_6&#45;&gt;ring_attn_1_15_stage_7</title>
<path fill="none" stroke="black" d="M9099.67,-13358.48C9099.67,-13358.48 9099.67,-13206.58 9099.67,-13206.58"/>
<polygon fill="black" stroke="black" points="9103.17,-13206.58 9099.67,-13196.58 9096.17,-13206.58 9103.17,-13206.58"/>
</g>
<!-- ring_attn_1_15_stage_7&#45;&gt;ring_attn_1_0_stage_7 -->
<g id="edge2536" class="edge">
<title>ring_attn_1_15_stage_7&#45;&gt;ring_attn_1_0_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-13105.51C8960.33,-13069.07 8960.33,-13024 8960.33,-13024 8960.33,-13024 294.67,-13024 294.67,-13024 294.67,-13024 294.67,-13095.51 294.67,-13095.51"/>
<polygon fill="red" stroke="red" points="291.17,-13095.51 294.67,-13105.51 298.17,-13095.51 291.17,-13095.51"/>
<text text-anchor="middle" x="4628" y="-13288.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-13273.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-13258.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_1_15_stage_7&#45;&gt;ring_attn_1_15_stage_8 -->
<g id="edge1490" class="edge">
<title>ring_attn_1_15_stage_7&#45;&gt;ring_attn_1_15_stage_8</title>
<path fill="none" stroke="black" d="M9099.67,-13105.48C9099.67,-13105.48 9099.67,-12953.58 9099.67,-12953.58"/>
<polygon fill="black" stroke="black" points="9103.17,-12953.58 9099.67,-12943.58 9096.17,-12953.58 9103.17,-12953.58"/>
</g>
<!-- ring_attn_1_15_stage_8&#45;&gt;ring_attn_1_0_stage_8 -->
<g id="edge2537" class="edge">
<title>ring_attn_1_15_stage_8&#45;&gt;ring_attn_1_0_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-12852.51C8960.33,-12816.07 8960.33,-12771 8960.33,-12771 8960.33,-12771 294.67,-12771 294.67,-12771 294.67,-12771 294.67,-12842.51 294.67,-12842.51"/>
<polygon fill="red" stroke="red" points="291.17,-12842.51 294.67,-12852.51 298.17,-12842.51 291.17,-12842.51"/>
<text text-anchor="middle" x="4628" y="-13035.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-13020.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-13005.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_1_15_stage_8&#45;&gt;ring_attn_1_15_stage_9 -->
<g id="edge1491" class="edge">
<title>ring_attn_1_15_stage_8&#45;&gt;ring_attn_1_15_stage_9</title>
<path fill="none" stroke="black" d="M9099.67,-12852.48C9099.67,-12852.48 9099.67,-12700.58 9099.67,-12700.58"/>
<polygon fill="black" stroke="black" points="9103.17,-12700.58 9099.67,-12690.58 9096.17,-12700.58 9103.17,-12700.58"/>
</g>
<!-- ring_attn_1_15_stage_9&#45;&gt;ring_attn_1_0_stage_9 -->
<g id="edge2538" class="edge">
<title>ring_attn_1_15_stage_9&#45;&gt;ring_attn_1_0_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-12599.51C8960.33,-12563.07 8960.33,-12518 8960.33,-12518 8960.33,-12518 294.67,-12518 294.67,-12518 294.67,-12518 294.67,-12589.51 294.67,-12589.51"/>
<polygon fill="red" stroke="red" points="291.17,-12589.51 294.67,-12599.51 298.17,-12589.51 291.17,-12589.51"/>
<text text-anchor="middle" x="4628" y="-12782.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-12767.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-12752.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_1_15_stage_9&#45;&gt;ring_attn_1_15_stage_10 -->
<g id="edge1492" class="edge">
<title>ring_attn_1_15_stage_9&#45;&gt;ring_attn_1_15_stage_10</title>
<path fill="none" stroke="black" d="M9099.67,-12599.48C9099.67,-12599.48 9099.67,-12447.58 9099.67,-12447.58"/>
<polygon fill="black" stroke="black" points="9103.17,-12447.58 9099.67,-12437.58 9096.17,-12447.58 9103.17,-12447.58"/>
</g>
<!-- ring_attn_1_15_stage_10&#45;&gt;ring_attn_1_0_stage_10 -->
<g id="edge2539" class="edge">
<title>ring_attn_1_15_stage_10&#45;&gt;ring_attn_1_0_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8925.5,-12357.85C8925.5,-12326.54 8925.5,-12285 8925.5,-12285 8925.5,-12285 329.5,-12285 329.5,-12285 329.5,-12285 329.5,-12347.85 329.5,-12347.85"/>
<polygon fill="red" stroke="red" points="326,-12347.85 329.5,-12357.85 333,-12347.85 326,-12347.85"/>
<text text-anchor="middle" x="4628" y="-12529.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-12514.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-12499.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_1_15_stage_10&#45;&gt;ring_attn_1_15_stage_11 -->
<g id="edge1493" class="edge">
<title>ring_attn_1_15_stage_10&#45;&gt;ring_attn_1_15_stage_11</title>
<path fill="none" stroke="black" d="M9134.5,-12357.88C9134.5,-12357.88 9134.5,-12183.39 9134.5,-12183.39"/>
<polygon fill="black" stroke="black" points="9138,-12183.39 9134.5,-12173.39 9131,-12183.39 9138,-12183.39"/>
</g>
<!-- ring_attn_1_15_stage_11&#45;&gt;ring_attn_1_0_stage_11 -->
<g id="edge2540" class="edge">
<title>ring_attn_1_15_stage_11&#45;&gt;ring_attn_1_0_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9030,-12207.07C9030,-12228.17 9030,-12246 9030,-12246 9030,-12246 225,-12246 225,-12246 225,-12246 225,-12217.07 225,-12217.07"/>
<polygon fill="red" stroke="red" points="228.5,-12217.07 225,-12207.07 221.5,-12217.07 228.5,-12217.07"/>
<text text-anchor="middle" x="4628" y="-12276.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-12261.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-12246.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_1_15_stage_11&#45;&gt;ring_attn_1_15_stage_12 -->
<g id="edge1494" class="edge">
<title>ring_attn_1_15_stage_11&#45;&gt;ring_attn_1_15_stage_12</title>
<path fill="none" stroke="black" d="M9099.67,-12093.48C9099.67,-12093.48 9099.67,-11941.58 9099.67,-11941.58"/>
<polygon fill="black" stroke="black" points="9103.17,-11941.58 9099.67,-11931.58 9096.17,-11941.58 9103.17,-11941.58"/>
</g>
<!-- ring_attn_1_15_stage_12&#45;&gt;ring_attn_1_0_stage_12 -->
<g id="edge2541" class="edge">
<title>ring_attn_1_15_stage_12&#45;&gt;ring_attn_1_0_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-11931.49C8960.33,-11967.58 8960.33,-12012 8960.33,-12012 8960.33,-12012 294.67,-12012 294.67,-12012 294.67,-12012 294.67,-11941.49 294.67,-11941.49"/>
<polygon fill="red" stroke="red" points="298.17,-11941.49 294.67,-11931.49 291.17,-11941.49 298.17,-11941.49"/>
<text text-anchor="middle" x="4628" y="-12023.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-12008.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-11993.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_1_15_stage_12&#45;&gt;ring_attn_1_15_stage_13 -->
<g id="edge1495" class="edge">
<title>ring_attn_1_15_stage_12&#45;&gt;ring_attn_1_15_stage_13</title>
<path fill="none" stroke="black" d="M9099.67,-11840.48C9099.67,-11840.48 9099.67,-11688.58 9099.67,-11688.58"/>
<polygon fill="black" stroke="black" points="9103.17,-11688.58 9099.67,-11678.58 9096.17,-11688.58 9103.17,-11688.58"/>
</g>
<!-- ring_attn_1_15_stage_13&#45;&gt;ring_attn_1_0_stage_13 -->
<g id="edge2542" class="edge">
<title>ring_attn_1_15_stage_13&#45;&gt;ring_attn_1_0_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-11678.49C8960.33,-11714.58 8960.33,-11759 8960.33,-11759 8960.33,-11759 294.67,-11759 294.67,-11759 294.67,-11759 294.67,-11688.49 294.67,-11688.49"/>
<polygon fill="red" stroke="red" points="298.17,-11688.49 294.67,-11678.49 291.17,-11688.49 298.17,-11688.49"/>
<text text-anchor="middle" x="4628" y="-11770.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-11755.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-11740.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_1_15_stage_13&#45;&gt;ring_attn_1_15_stage_14 -->
<g id="edge1496" class="edge">
<title>ring_attn_1_15_stage_13&#45;&gt;ring_attn_1_15_stage_14</title>
<path fill="none" stroke="black" d="M9030,-11564.87C9030,-11564.87 9030,-11458.25 9030,-11458.25"/>
<polygon fill="black" stroke="black" points="9033.5,-11458.25 9030,-11448.25 9026.5,-11458.25 9033.5,-11458.25"/>
</g>
<!-- ring_attn_1_15_stage_14&#45;&gt;ring_attn_1_0_stage_14 -->
<g id="edge2543" class="edge">
<title>ring_attn_1_15_stage_14&#45;&gt;ring_attn_1_0_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-11334.51C8960.33,-11298.07 8960.33,-11253 8960.33,-11253 8960.33,-11253 294.67,-11253 294.67,-11253 294.67,-11253 294.67,-11324.51 294.67,-11324.51"/>
<polygon fill="red" stroke="red" points="291.17,-11324.51 294.67,-11334.51 298.17,-11324.51 291.17,-11324.51"/>
<text text-anchor="middle" x="4628" y="-11517.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-11502.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-11487.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_1_15_stage_14&#45;&gt;ring_attn_1_15_stage_15 -->
<g id="edge1497" class="edge">
<title>ring_attn_1_15_stage_14&#45;&gt;ring_attn_1_15_stage_15</title>
<path fill="none" stroke="black" d="M9099.67,-11334.48C9099.67,-11334.48 9099.67,-11182.58 9099.67,-11182.58"/>
<polygon fill="black" stroke="black" points="9103.17,-11182.58 9099.67,-11172.58 9096.17,-11182.58 9103.17,-11182.58"/>
</g>
<!-- ring_attn_1_15_stage_15&#45;&gt;ring_attn_1_0_stage_15 -->
<g id="edge2544" class="edge">
<title>ring_attn_1_15_stage_15&#45;&gt;ring_attn_1_0_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8861.67,-11113.7C8861.67,-11085.45 8861.67,-11022 8861.67,-11022 8861.67,-11022 413.67,-11022 413.67,-11022 413.67,-11022 413.67,-11110.11 413.67,-11110.11"/>
<polygon fill="red" stroke="red" points="410.17,-11110.11 413.67,-11120.11 417.17,-11110.11 410.17,-11110.11"/>
<text text-anchor="middle" x="4628" y="-11264.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-11249.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-11234.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_1_15 -->
<g id="node1514" class="node">
<title>attn_out_1_15</title>
<polygon fill="none" stroke="black" points="9099.5,-10986 8960.5,-10986 8960.5,-10933 9099.5,-10933 9099.5,-10986"/>
<text text-anchor="middle" x="9030" y="-10970.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9030" y="-10955.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="9030" y="-10940.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_1_15_stage_15&#45;&gt;attn_out_1_15 -->
<g id="edge1498" class="edge">
<title>ring_attn_1_15_stage_15&#45;&gt;attn_out_1_15</title>
<path fill="none" stroke="black" d="M9030,-11058.87C9030,-11058.87 9030,-10996.18 9030,-10996.18"/>
<polygon fill="black" stroke="black" points="9033.5,-10996.18 9030,-10986.18 9026.5,-10996.18 9033.5,-10996.18"/>
</g>
<!-- attn_residual_1_15 -->
<g id="node1515" class="node">
<title>attn_residual_1_15</title>
<ellipse fill="none" stroke="black" cx="9030" cy="-10833" rx="105.5" ry="27"/>
<text text-anchor="middle" x="9030" y="-10836.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="9030" y="-10821.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_1_15&#45;&gt;attn_residual_1_15 -->
<g id="edge1499" class="edge">
<title>attn_out_1_15&#45;&gt;attn_residual_1_15</title>
<path fill="none" stroke="black" d="M9030,-10932.98C9030,-10932.98 9030,-10870.36 9030,-10870.36"/>
<polygon fill="black" stroke="black" points="9033.5,-10870.36 9030,-10860.36 9026.5,-10870.36 9033.5,-10870.36"/>
</g>
<!-- ffn_up_1_15 -->
<g id="node1516" class="node">
<title>ffn_up_1_15</title>
<polygon fill="none" stroke="black" points="9109,-10733 8951,-10733 8951,-10680 9109,-10680 9109,-10733"/>
<text text-anchor="middle" x="9030" y="-10717.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9030" y="-10702.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="9030" y="-10687.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_1_15&#45;&gt;ffn_up_1_15 -->
<g id="edge1500" class="edge">
<title>attn_residual_1_15&#45;&gt;ffn_up_1_15</title>
<path fill="none" stroke="black" d="M9030,-10805.86C9030,-10805.86 9030,-10743.16 9030,-10743.16"/>
<polygon fill="black" stroke="black" points="9033.5,-10743.16 9030,-10733.16 9026.5,-10743.16 9033.5,-10743.16"/>
</g>
<!-- ffn_gelu_1_15 -->
<g id="node1517" class="node">
<title>ffn_gelu_1_15</title>
<ellipse fill="none" stroke="black" cx="9030" cy="-10580" rx="105.5" ry="27"/>
<text text-anchor="middle" x="9030" y="-10583.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="9030" y="-10568.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_1_15&#45;&gt;ffn_gelu_1_15 -->
<g id="edge1501" class="edge">
<title>ffn_up_1_15&#45;&gt;ffn_gelu_1_15</title>
<path fill="none" stroke="black" d="M9030,-10679.98C9030,-10679.98 9030,-10617.36 9030,-10617.36"/>
<polygon fill="black" stroke="black" points="9033.5,-10617.36 9030,-10607.36 9026.5,-10617.36 9033.5,-10617.36"/>
</g>
<!-- ffn_down_1_15 -->
<g id="node1518" class="node">
<title>ffn_down_1_15</title>
<polygon fill="none" stroke="black" points="9119,-10480 8941,-10480 8941,-10427 9119,-10427 9119,-10480"/>
<text text-anchor="middle" x="9030" y="-10464.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9030" y="-10449.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="9030" y="-10434.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_1_15&#45;&gt;ffn_down_1_15 -->
<g id="edge1502" class="edge">
<title>ffn_gelu_1_15&#45;&gt;ffn_down_1_15</title>
<path fill="none" stroke="black" d="M9030,-10552.86C9030,-10552.86 9030,-10490.16 9030,-10490.16"/>
<polygon fill="black" stroke="black" points="9033.5,-10490.16 9030,-10480.16 9026.5,-10490.16 9033.5,-10490.16"/>
</g>
<!-- ffn_residual_1_15 -->
<g id="node1519" class="node">
<title>ffn_residual_1_15</title>
<ellipse fill="none" stroke="black" cx="9030" cy="-10327" rx="105.5" ry="27"/>
<text text-anchor="middle" x="9030" y="-10330.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="9030" y="-10315.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_1_15&#45;&gt;ffn_residual_1_15 -->
<g id="edge1503" class="edge">
<title>ffn_down_1_15&#45;&gt;ffn_residual_1_15</title>
<path fill="none" stroke="black" d="M9030,-10426.98C9030,-10426.98 9030,-10364.36 9030,-10364.36"/>
<polygon fill="black" stroke="black" points="9033.5,-10364.36 9030,-10354.36 9026.5,-10364.36 9033.5,-10364.36"/>
</g>
<!-- qkv_proj_2_15 -->
<g id="node1520" class="node">
<title>qkv_proj_2_15</title>
<polygon fill="none" stroke="black" points="9112.5,-10227 8947.5,-10227 8947.5,-10174 9112.5,-10174 9112.5,-10227"/>
<text text-anchor="middle" x="9030" y="-10211.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9030" y="-10196.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="9030" y="-10181.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_1_15&#45;&gt;qkv_proj_2_15 -->
<g id="edge1504" class="edge">
<title>ffn_residual_1_15&#45;&gt;qkv_proj_2_15</title>
<path fill="none" stroke="black" d="M9030,-10299.86C9030,-10299.86 9030,-10237.16 9030,-10237.16"/>
<polygon fill="black" stroke="black" points="9033.5,-10237.16 9030,-10227.16 9026.5,-10237.16 9033.5,-10237.16"/>
</g>
<!-- qkv_reshape_2_15 -->
<g id="node1521" class="node">
<title>qkv_reshape_2_15</title>
<ellipse fill="none" stroke="black" cx="9030" cy="-10074" rx="148" ry="27"/>
<text text-anchor="middle" x="9030" y="-10077.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="9030" y="-10062.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_2_15&#45;&gt;qkv_reshape_2_15 -->
<g id="edge1505" class="edge">
<title>qkv_proj_2_15&#45;&gt;qkv_reshape_2_15</title>
<path fill="none" stroke="black" d="M9030,-10173.98C9030,-10173.98 9030,-10111.36 9030,-10111.36"/>
<polygon fill="black" stroke="black" points="9033.5,-10111.36 9030,-10101.36 9026.5,-10111.36 9033.5,-10111.36"/>
</g>
<!-- qkv_reshape_2_15&#45;&gt;ring_attn_2_15_stage_0 -->
<g id="edge1506" class="edge">
<title>qkv_reshape_2_15&#45;&gt;ring_attn_2_15_stage_0</title>
<path fill="none" stroke="black" d="M9030,-10046.72C9030,-10046.72 9030,-9940.16 9030,-9940.16"/>
<polygon fill="black" stroke="black" points="9033.5,-9940.16 9030,-9930.16 9026.5,-9940.16 9033.5,-9940.16"/>
</g>
<!-- ring_attn_2_15_stage_0&#45;&gt;ring_attn_2_0_stage_0 -->
<g id="edge2545" class="edge">
<title>ring_attn_2_15_stage_0&#45;&gt;ring_attn_2_0_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8841.33,-9868.77C8841.33,-9894.95 8841.33,-9988 8841.33,-9988 8841.33,-9988 393.33,-9988 393.33,-9988 393.33,-9988 393.33,-9885.48 393.33,-9885.48"/>
<polygon fill="red" stroke="red" points="396.83,-9885.48 393.33,-9875.48 389.83,-9885.48 396.83,-9885.48"/>
<text text-anchor="middle" x="4628" y="-9999.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-9984.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-9969.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_2_15_stage_0&#45;&gt;ring_attn_2_15_stage_1 -->
<g id="edge1507" class="edge">
<title>ring_attn_2_15_stage_0&#45;&gt;ring_attn_2_15_stage_1</title>
<path fill="none" stroke="black" d="M9030,-9793.87C9030,-9793.87 9030,-9687.25 9030,-9687.25"/>
<polygon fill="black" stroke="black" points="9033.5,-9687.25 9030,-9677.25 9026.5,-9687.25 9033.5,-9687.25"/>
</g>
<!-- ring_attn_2_15_stage_1&#45;&gt;ring_attn_2_0_stage_1 -->
<g id="edge2546" class="edge">
<title>ring_attn_2_15_stage_1&#45;&gt;ring_attn_2_0_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8925.5,-9574.85C8925.5,-9543.54 8925.5,-9502 8925.5,-9502 8925.5,-9502 329.5,-9502 329.5,-9502 329.5,-9502 329.5,-9564.85 329.5,-9564.85"/>
<polygon fill="red" stroke="red" points="326,-9564.85 329.5,-9574.85 333,-9564.85 326,-9564.85"/>
<text text-anchor="middle" x="4628" y="-9746.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-9731.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-9716.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_2_15_stage_1&#45;&gt;ring_attn_2_15_stage_2 -->
<g id="edge1508" class="edge">
<title>ring_attn_2_15_stage_1&#45;&gt;ring_attn_2_15_stage_2</title>
<path fill="none" stroke="black" d="M9134.5,-9574.88C9134.5,-9574.88 9134.5,-9400.39 9134.5,-9400.39"/>
<polygon fill="black" stroke="black" points="9138,-9400.39 9134.5,-9390.39 9131,-9400.39 9138,-9400.39"/>
</g>
<!-- ring_attn_2_15_stage_2&#45;&gt;ring_attn_2_0_stage_2 -->
<g id="edge2547" class="edge">
<title>ring_attn_2_15_stage_2&#45;&gt;ring_attn_2_0_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9030,-9424.07C9030,-9445.17 9030,-9463 9030,-9463 9030,-9463 225,-9463 225,-9463 225,-9463 225,-9434.07 225,-9434.07"/>
<polygon fill="red" stroke="red" points="228.5,-9434.07 225,-9424.07 221.5,-9434.07 228.5,-9434.07"/>
<text text-anchor="middle" x="4628" y="-9493.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-9478.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-9463.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_2_15_stage_2&#45;&gt;ring_attn_2_15_stage_3 -->
<g id="edge1509" class="edge">
<title>ring_attn_2_15_stage_2&#45;&gt;ring_attn_2_15_stage_3</title>
<path fill="none" stroke="black" d="M9099.67,-9310.48C9099.67,-9310.48 9099.67,-9158.58 9099.67,-9158.58"/>
<polygon fill="black" stroke="black" points="9103.17,-9158.58 9099.67,-9148.58 9096.17,-9158.58 9103.17,-9158.58"/>
</g>
<!-- ring_attn_2_15_stage_3&#45;&gt;ring_attn_2_0_stage_3 -->
<g id="edge2548" class="edge">
<title>ring_attn_2_15_stage_3&#45;&gt;ring_attn_2_0_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-9148.49C8960.33,-9184.58 8960.33,-9229 8960.33,-9229 8960.33,-9229 294.67,-9229 294.67,-9229 294.67,-9229 294.67,-9158.49 294.67,-9158.49"/>
<polygon fill="red" stroke="red" points="298.17,-9158.49 294.67,-9148.49 291.17,-9158.49 298.17,-9158.49"/>
<text text-anchor="middle" x="4628" y="-9240.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-9225.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-9210.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_2_15_stage_3&#45;&gt;ring_attn_2_15_stage_4 -->
<g id="edge1510" class="edge">
<title>ring_attn_2_15_stage_3&#45;&gt;ring_attn_2_15_stage_4</title>
<path fill="none" stroke="black" d="M9099.67,-9057.48C9099.67,-9057.48 9099.67,-8905.58 9099.67,-8905.58"/>
<polygon fill="black" stroke="black" points="9103.17,-8905.58 9099.67,-8895.58 9096.17,-8905.58 9103.17,-8905.58"/>
</g>
<!-- ring_attn_2_15_stage_4&#45;&gt;ring_attn_2_0_stage_4 -->
<g id="edge2549" class="edge">
<title>ring_attn_2_15_stage_4&#45;&gt;ring_attn_2_0_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-8895.49C8960.33,-8931.58 8960.33,-8976 8960.33,-8976 8960.33,-8976 294.67,-8976 294.67,-8976 294.67,-8976 294.67,-8905.49 294.67,-8905.49"/>
<polygon fill="red" stroke="red" points="298.17,-8905.49 294.67,-8895.49 291.17,-8905.49 298.17,-8905.49"/>
<text text-anchor="middle" x="4628" y="-8987.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-8972.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-8957.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_2_15_stage_4&#45;&gt;ring_attn_2_15_stage_5 -->
<g id="edge1511" class="edge">
<title>ring_attn_2_15_stage_4&#45;&gt;ring_attn_2_15_stage_5</title>
<path fill="none" stroke="black" d="M9030,-8781.87C9030,-8781.87 9030,-8675.25 9030,-8675.25"/>
<polygon fill="black" stroke="black" points="9033.5,-8675.25 9030,-8665.25 9026.5,-8675.25 9033.5,-8675.25"/>
</g>
<!-- ring_attn_2_15_stage_5&#45;&gt;ring_attn_2_0_stage_5 -->
<g id="edge2550" class="edge">
<title>ring_attn_2_15_stage_5&#45;&gt;ring_attn_2_0_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-8551.51C8960.33,-8515.07 8960.33,-8470 8960.33,-8470 8960.33,-8470 294.67,-8470 294.67,-8470 294.67,-8470 294.67,-8541.51 294.67,-8541.51"/>
<polygon fill="red" stroke="red" points="291.17,-8541.51 294.67,-8551.51 298.17,-8541.51 291.17,-8541.51"/>
<text text-anchor="middle" x="4628" y="-8734.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-8719.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-8704.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_2_15_stage_5&#45;&gt;ring_attn_2_15_stage_6 -->
<g id="edge1512" class="edge">
<title>ring_attn_2_15_stage_5&#45;&gt;ring_attn_2_15_stage_6</title>
<path fill="none" stroke="black" d="M9099.67,-8551.48C9099.67,-8551.48 9099.67,-8399.58 9099.67,-8399.58"/>
<polygon fill="black" stroke="black" points="9103.17,-8399.58 9099.67,-8389.58 9096.17,-8399.58 9103.17,-8399.58"/>
</g>
<!-- ring_attn_2_15_stage_6&#45;&gt;ring_attn_2_0_stage_6 -->
<g id="edge2551" class="edge">
<title>ring_attn_2_15_stage_6&#45;&gt;ring_attn_2_0_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-8298.51C8960.33,-8262.07 8960.33,-8217 8960.33,-8217 8960.33,-8217 294.67,-8217 294.67,-8217 294.67,-8217 294.67,-8288.51 294.67,-8288.51"/>
<polygon fill="red" stroke="red" points="291.17,-8288.51 294.67,-8298.51 298.17,-8288.51 291.17,-8288.51"/>
<text text-anchor="middle" x="4628" y="-8481.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-8466.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-8451.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_2_15_stage_6&#45;&gt;ring_attn_2_15_stage_7 -->
<g id="edge1513" class="edge">
<title>ring_attn_2_15_stage_6&#45;&gt;ring_attn_2_15_stage_7</title>
<path fill="none" stroke="black" d="M9099.67,-8298.48C9099.67,-8298.48 9099.67,-8146.58 9099.67,-8146.58"/>
<polygon fill="black" stroke="black" points="9103.17,-8146.58 9099.67,-8136.58 9096.17,-8146.58 9103.17,-8146.58"/>
</g>
<!-- ring_attn_2_15_stage_7&#45;&gt;ring_attn_2_0_stage_7 -->
<g id="edge2552" class="edge">
<title>ring_attn_2_15_stage_7&#45;&gt;ring_attn_2_0_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-8045.51C8960.33,-8009.07 8960.33,-7964 8960.33,-7964 8960.33,-7964 294.67,-7964 294.67,-7964 294.67,-7964 294.67,-8035.51 294.67,-8035.51"/>
<polygon fill="red" stroke="red" points="291.17,-8035.51 294.67,-8045.51 298.17,-8035.51 291.17,-8035.51"/>
<text text-anchor="middle" x="4628" y="-8228.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-8213.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-8198.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_2_15_stage_7&#45;&gt;ring_attn_2_15_stage_8 -->
<g id="edge1514" class="edge">
<title>ring_attn_2_15_stage_7&#45;&gt;ring_attn_2_15_stage_8</title>
<path fill="none" stroke="black" d="M9099.67,-8045.48C9099.67,-8045.48 9099.67,-7893.58 9099.67,-7893.58"/>
<polygon fill="black" stroke="black" points="9103.17,-7893.58 9099.67,-7883.58 9096.17,-7893.58 9103.17,-7893.58"/>
</g>
<!-- ring_attn_2_15_stage_8&#45;&gt;ring_attn_2_0_stage_8 -->
<g id="edge2553" class="edge">
<title>ring_attn_2_15_stage_8&#45;&gt;ring_attn_2_0_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-7792.51C8960.33,-7756.07 8960.33,-7711 8960.33,-7711 8960.33,-7711 294.67,-7711 294.67,-7711 294.67,-7711 294.67,-7782.51 294.67,-7782.51"/>
<polygon fill="red" stroke="red" points="291.17,-7782.51 294.67,-7792.51 298.17,-7782.51 291.17,-7782.51"/>
<text text-anchor="middle" x="4628" y="-7975.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-7960.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-7945.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_2_15_stage_8&#45;&gt;ring_attn_2_15_stage_9 -->
<g id="edge1515" class="edge">
<title>ring_attn_2_15_stage_8&#45;&gt;ring_attn_2_15_stage_9</title>
<path fill="none" stroke="black" d="M9099.67,-7792.48C9099.67,-7792.48 9099.67,-7640.58 9099.67,-7640.58"/>
<polygon fill="black" stroke="black" points="9103.17,-7640.58 9099.67,-7630.58 9096.17,-7640.58 9103.17,-7640.58"/>
</g>
<!-- ring_attn_2_15_stage_9&#45;&gt;ring_attn_2_0_stage_9 -->
<g id="edge2554" class="edge">
<title>ring_attn_2_15_stage_9&#45;&gt;ring_attn_2_0_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8925.5,-7550.85C8925.5,-7519.54 8925.5,-7478 8925.5,-7478 8925.5,-7478 329.5,-7478 329.5,-7478 329.5,-7478 329.5,-7540.85 329.5,-7540.85"/>
<polygon fill="red" stroke="red" points="326,-7540.85 329.5,-7550.85 333,-7540.85 326,-7540.85"/>
<text text-anchor="middle" x="4628" y="-7722.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-7707.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-7692.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_2_15_stage_9&#45;&gt;ring_attn_2_15_stage_10 -->
<g id="edge1516" class="edge">
<title>ring_attn_2_15_stage_9&#45;&gt;ring_attn_2_15_stage_10</title>
<path fill="none" stroke="black" d="M9134.5,-7550.88C9134.5,-7550.88 9134.5,-7376.39 9134.5,-7376.39"/>
<polygon fill="black" stroke="black" points="9138,-7376.39 9134.5,-7366.39 9131,-7376.39 9138,-7376.39"/>
</g>
<!-- ring_attn_2_15_stage_10&#45;&gt;ring_attn_2_0_stage_10 -->
<g id="edge2555" class="edge">
<title>ring_attn_2_15_stage_10&#45;&gt;ring_attn_2_0_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9030,-7400.07C9030,-7421.17 9030,-7439 9030,-7439 9030,-7439 225,-7439 225,-7439 225,-7439 225,-7410.07 225,-7410.07"/>
<polygon fill="red" stroke="red" points="228.5,-7410.07 225,-7400.07 221.5,-7410.07 228.5,-7410.07"/>
<text text-anchor="middle" x="4628" y="-7469.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-7454.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-7439.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_2_15_stage_10&#45;&gt;ring_attn_2_15_stage_11 -->
<g id="edge1517" class="edge">
<title>ring_attn_2_15_stage_10&#45;&gt;ring_attn_2_15_stage_11</title>
<path fill="none" stroke="black" d="M9099.67,-7286.48C9099.67,-7286.48 9099.67,-7134.58 9099.67,-7134.58"/>
<polygon fill="black" stroke="black" points="9103.17,-7134.58 9099.67,-7124.58 9096.17,-7134.58 9103.17,-7134.58"/>
</g>
<!-- ring_attn_2_15_stage_11&#45;&gt;ring_attn_2_0_stage_11 -->
<g id="edge2556" class="edge">
<title>ring_attn_2_15_stage_11&#45;&gt;ring_attn_2_0_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-7124.49C8960.33,-7160.58 8960.33,-7205 8960.33,-7205 8960.33,-7205 294.67,-7205 294.67,-7205 294.67,-7205 294.67,-7134.49 294.67,-7134.49"/>
<polygon fill="red" stroke="red" points="298.17,-7134.49 294.67,-7124.49 291.17,-7134.49 298.17,-7134.49"/>
<text text-anchor="middle" x="4628" y="-7216.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-7201.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-7186.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_2_15_stage_11&#45;&gt;ring_attn_2_15_stage_12 -->
<g id="edge1518" class="edge">
<title>ring_attn_2_15_stage_11&#45;&gt;ring_attn_2_15_stage_12</title>
<path fill="none" stroke="black" d="M9030,-7010.87C9030,-7010.87 9030,-6904.25 9030,-6904.25"/>
<polygon fill="black" stroke="black" points="9033.5,-6904.25 9030,-6894.25 9026.5,-6904.25 9033.5,-6904.25"/>
</g>
<!-- ring_attn_2_15_stage_12&#45;&gt;ring_attn_2_0_stage_12 -->
<g id="edge2557" class="edge">
<title>ring_attn_2_15_stage_12&#45;&gt;ring_attn_2_0_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-6780.51C8960.33,-6744.07 8960.33,-6699 8960.33,-6699 8960.33,-6699 294.67,-6699 294.67,-6699 294.67,-6699 294.67,-6770.51 294.67,-6770.51"/>
<polygon fill="red" stroke="red" points="291.17,-6770.51 294.67,-6780.51 298.17,-6770.51 291.17,-6770.51"/>
<text text-anchor="middle" x="4628" y="-6963.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-6948.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-6933.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_2_15_stage_12&#45;&gt;ring_attn_2_15_stage_13 -->
<g id="edge1519" class="edge">
<title>ring_attn_2_15_stage_12&#45;&gt;ring_attn_2_15_stage_13</title>
<path fill="none" stroke="black" d="M9099.67,-6780.48C9099.67,-6780.48 9099.67,-6628.58 9099.67,-6628.58"/>
<polygon fill="black" stroke="black" points="9103.17,-6628.58 9099.67,-6618.58 9096.17,-6628.58 9103.17,-6628.58"/>
</g>
<!-- ring_attn_2_15_stage_13&#45;&gt;ring_attn_2_0_stage_13 -->
<g id="edge2558" class="edge">
<title>ring_attn_2_15_stage_13&#45;&gt;ring_attn_2_0_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-6527.51C8960.33,-6491.07 8960.33,-6446 8960.33,-6446 8960.33,-6446 294.67,-6446 294.67,-6446 294.67,-6446 294.67,-6517.51 294.67,-6517.51"/>
<polygon fill="red" stroke="red" points="291.17,-6517.51 294.67,-6527.51 298.17,-6517.51 291.17,-6517.51"/>
<text text-anchor="middle" x="4628" y="-6710.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-6695.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-6680.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_2_15_stage_13&#45;&gt;ring_attn_2_15_stage_14 -->
<g id="edge1520" class="edge">
<title>ring_attn_2_15_stage_13&#45;&gt;ring_attn_2_15_stage_14</title>
<path fill="none" stroke="black" d="M9099.67,-6527.48C9099.67,-6527.48 9099.67,-6375.58 9099.67,-6375.58"/>
<polygon fill="black" stroke="black" points="9103.17,-6375.58 9099.67,-6365.58 9096.17,-6375.58 9103.17,-6375.58"/>
</g>
<!-- ring_attn_2_15_stage_14&#45;&gt;ring_attn_2_0_stage_14 -->
<g id="edge2559" class="edge">
<title>ring_attn_2_15_stage_14&#45;&gt;ring_attn_2_0_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-6274.51C8960.33,-6238.07 8960.33,-6193 8960.33,-6193 8960.33,-6193 294.67,-6193 294.67,-6193 294.67,-6193 294.67,-6264.51 294.67,-6264.51"/>
<polygon fill="red" stroke="red" points="291.17,-6264.51 294.67,-6274.51 298.17,-6264.51 291.17,-6264.51"/>
<text text-anchor="middle" x="4628" y="-6457.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-6442.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-6427.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_2_15_stage_14&#45;&gt;ring_attn_2_15_stage_15 -->
<g id="edge1521" class="edge">
<title>ring_attn_2_15_stage_14&#45;&gt;ring_attn_2_15_stage_15</title>
<path fill="none" stroke="black" d="M9099.67,-6274.48C9099.67,-6274.48 9099.67,-6122.58 9099.67,-6122.58"/>
<polygon fill="black" stroke="black" points="9103.17,-6122.58 9099.67,-6112.58 9096.17,-6122.58 9103.17,-6122.58"/>
</g>
<!-- ring_attn_2_15_stage_15&#45;&gt;ring_attn_2_0_stage_15 -->
<g id="edge2560" class="edge">
<title>ring_attn_2_15_stage_15&#45;&gt;ring_attn_2_0_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8861.67,-6053.7C8861.67,-6025.45 8861.67,-5962 8861.67,-5962 8861.67,-5962 413.67,-5962 413.67,-5962 413.67,-5962 413.67,-6050.11 413.67,-6050.11"/>
<polygon fill="red" stroke="red" points="410.17,-6050.11 413.67,-6060.11 417.17,-6050.11 410.17,-6050.11"/>
<text text-anchor="middle" x="4628" y="-6204.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-6189.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-6174.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_2_15 -->
<g id="node1538" class="node">
<title>attn_out_2_15</title>
<polygon fill="none" stroke="black" points="9099.5,-5926 8960.5,-5926 8960.5,-5873 9099.5,-5873 9099.5,-5926"/>
<text text-anchor="middle" x="9030" y="-5910.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9030" y="-5895.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="9030" y="-5880.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_2_15_stage_15&#45;&gt;attn_out_2_15 -->
<g id="edge1522" class="edge">
<title>ring_attn_2_15_stage_15&#45;&gt;attn_out_2_15</title>
<path fill="none" stroke="black" d="M9030,-5998.87C9030,-5998.87 9030,-5936.18 9030,-5936.18"/>
<polygon fill="black" stroke="black" points="9033.5,-5936.18 9030,-5926.18 9026.5,-5936.18 9033.5,-5936.18"/>
</g>
<!-- attn_residual_2_15 -->
<g id="node1539" class="node">
<title>attn_residual_2_15</title>
<ellipse fill="none" stroke="black" cx="9030" cy="-5773" rx="105.5" ry="27"/>
<text text-anchor="middle" x="9030" y="-5776.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="9030" y="-5761.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_2_15&#45;&gt;attn_residual_2_15 -->
<g id="edge1523" class="edge">
<title>attn_out_2_15&#45;&gt;attn_residual_2_15</title>
<path fill="none" stroke="black" d="M9030,-5872.98C9030,-5872.98 9030,-5810.36 9030,-5810.36"/>
<polygon fill="black" stroke="black" points="9033.5,-5810.36 9030,-5800.36 9026.5,-5810.36 9033.5,-5810.36"/>
</g>
<!-- ffn_up_2_15 -->
<g id="node1540" class="node">
<title>ffn_up_2_15</title>
<polygon fill="none" stroke="black" points="9109,-5673 8951,-5673 8951,-5620 9109,-5620 9109,-5673"/>
<text text-anchor="middle" x="9030" y="-5657.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9030" y="-5642.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="9030" y="-5627.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_2_15&#45;&gt;ffn_up_2_15 -->
<g id="edge1524" class="edge">
<title>attn_residual_2_15&#45;&gt;ffn_up_2_15</title>
<path fill="none" stroke="black" d="M9030,-5745.86C9030,-5745.86 9030,-5683.16 9030,-5683.16"/>
<polygon fill="black" stroke="black" points="9033.5,-5683.16 9030,-5673.16 9026.5,-5683.16 9033.5,-5683.16"/>
</g>
<!-- ffn_gelu_2_15 -->
<g id="node1541" class="node">
<title>ffn_gelu_2_15</title>
<ellipse fill="none" stroke="black" cx="9030" cy="-5520" rx="105.5" ry="27"/>
<text text-anchor="middle" x="9030" y="-5523.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="9030" y="-5508.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_2_15&#45;&gt;ffn_gelu_2_15 -->
<g id="edge1525" class="edge">
<title>ffn_up_2_15&#45;&gt;ffn_gelu_2_15</title>
<path fill="none" stroke="black" d="M9030,-5619.98C9030,-5619.98 9030,-5557.36 9030,-5557.36"/>
<polygon fill="black" stroke="black" points="9033.5,-5557.36 9030,-5547.36 9026.5,-5557.36 9033.5,-5557.36"/>
</g>
<!-- ffn_down_2_15 -->
<g id="node1542" class="node">
<title>ffn_down_2_15</title>
<polygon fill="none" stroke="black" points="9119,-5420 8941,-5420 8941,-5367 9119,-5367 9119,-5420"/>
<text text-anchor="middle" x="9030" y="-5404.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9030" y="-5389.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="9030" y="-5374.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_2_15&#45;&gt;ffn_down_2_15 -->
<g id="edge1526" class="edge">
<title>ffn_gelu_2_15&#45;&gt;ffn_down_2_15</title>
<path fill="none" stroke="black" d="M9030,-5492.86C9030,-5492.86 9030,-5430.16 9030,-5430.16"/>
<polygon fill="black" stroke="black" points="9033.5,-5430.16 9030,-5420.16 9026.5,-5430.16 9033.5,-5430.16"/>
</g>
<!-- ffn_residual_2_15 -->
<g id="node1543" class="node">
<title>ffn_residual_2_15</title>
<ellipse fill="none" stroke="black" cx="9030" cy="-5267" rx="105.5" ry="27"/>
<text text-anchor="middle" x="9030" y="-5270.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="9030" y="-5255.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_2_15&#45;&gt;ffn_residual_2_15 -->
<g id="edge1527" class="edge">
<title>ffn_down_2_15&#45;&gt;ffn_residual_2_15</title>
<path fill="none" stroke="black" d="M9030,-5366.98C9030,-5366.98 9030,-5304.36 9030,-5304.36"/>
<polygon fill="black" stroke="black" points="9033.5,-5304.36 9030,-5294.36 9026.5,-5304.36 9033.5,-5304.36"/>
</g>
<!-- qkv_proj_3_15 -->
<g id="node1544" class="node">
<title>qkv_proj_3_15</title>
<polygon fill="none" stroke="black" points="9112.5,-5167 8947.5,-5167 8947.5,-5114 9112.5,-5114 9112.5,-5167"/>
<text text-anchor="middle" x="9030" y="-5151.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9030" y="-5136.8" font-family="Times,serif" font-size="14.00">W_qkv: 4096×12288</text>
<text text-anchor="middle" x="9030" y="-5121.8" font-family="Times,serif" font-size="14.00">Split: 4096×768</text>
</g>
<!-- ffn_residual_2_15&#45;&gt;qkv_proj_3_15 -->
<g id="edge1528" class="edge">
<title>ffn_residual_2_15&#45;&gt;qkv_proj_3_15</title>
<path fill="none" stroke="black" d="M9030,-5239.86C9030,-5239.86 9030,-5177.16 9030,-5177.16"/>
<polygon fill="black" stroke="black" points="9033.5,-5177.16 9030,-5167.16 9026.5,-5177.16 9033.5,-5177.16"/>
</g>
<!-- qkv_reshape_3_15 -->
<g id="node1545" class="node">
<title>qkv_reshape_3_15</title>
<ellipse fill="none" stroke="black" cx="9030" cy="-5014" rx="148" ry="27"/>
<text text-anchor="middle" x="9030" y="-5017.8" font-family="Times,serif" font-size="14.00">Reshape QKV</text>
<text text-anchor="middle" x="9030" y="-5002.8" font-family="Times,serif" font-size="14.00">Q,K,V: 1024×1024×2×128</text>
</g>
<!-- qkv_proj_3_15&#45;&gt;qkv_reshape_3_15 -->
<g id="edge1529" class="edge">
<title>qkv_proj_3_15&#45;&gt;qkv_reshape_3_15</title>
<path fill="none" stroke="black" d="M9030,-5113.98C9030,-5113.98 9030,-5051.36 9030,-5051.36"/>
<polygon fill="black" stroke="black" points="9033.5,-5051.36 9030,-5041.36 9026.5,-5051.36 9033.5,-5051.36"/>
</g>
<!-- qkv_reshape_3_15&#45;&gt;ring_attn_3_15_stage_0 -->
<g id="edge1530" class="edge">
<title>qkv_reshape_3_15&#45;&gt;ring_attn_3_15_stage_0</title>
<path fill="none" stroke="black" d="M9030,-4986.72C9030,-4986.72 9030,-4880.16 9030,-4880.16"/>
<polygon fill="black" stroke="black" points="9033.5,-4880.16 9030,-4870.16 9026.5,-4880.16 9033.5,-4880.16"/>
</g>
<!-- ring_attn_3_15_stage_0&#45;&gt;ring_attn_3_0_stage_0 -->
<g id="edge2561" class="edge">
<title>ring_attn_3_15_stage_0&#45;&gt;ring_attn_3_0_stage_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8841.33,-4808.77C8841.33,-4834.95 8841.33,-4928 8841.33,-4928 8841.33,-4928 393.33,-4928 393.33,-4928 393.33,-4928 393.33,-4825.48 393.33,-4825.48"/>
<polygon fill="red" stroke="red" points="396.83,-4825.48 393.33,-4815.48 389.83,-4825.48 396.83,-4825.48"/>
<text text-anchor="middle" x="4628" y="-4939.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-4924.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-4909.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_3_15_stage_0&#45;&gt;ring_attn_3_15_stage_1 -->
<g id="edge1531" class="edge">
<title>ring_attn_3_15_stage_0&#45;&gt;ring_attn_3_15_stage_1</title>
<path fill="none" stroke="black" d="M9030,-4733.87C9030,-4733.87 9030,-4627.25 9030,-4627.25"/>
<polygon fill="black" stroke="black" points="9033.5,-4627.25 9030,-4617.25 9026.5,-4627.25 9033.5,-4627.25"/>
</g>
<!-- ring_attn_3_15_stage_1&#45;&gt;ring_attn_3_0_stage_1 -->
<g id="edge2562" class="edge">
<title>ring_attn_3_15_stage_1&#45;&gt;ring_attn_3_0_stage_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8925.5,-4514.85C8925.5,-4483.54 8925.5,-4442 8925.5,-4442 8925.5,-4442 329.5,-4442 329.5,-4442 329.5,-4442 329.5,-4504.85 329.5,-4504.85"/>
<polygon fill="red" stroke="red" points="326,-4504.85 329.5,-4514.85 333,-4504.85 326,-4504.85"/>
<text text-anchor="middle" x="4628" y="-4686.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-4671.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-4656.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_3_15_stage_1&#45;&gt;ring_attn_3_15_stage_2 -->
<g id="edge1532" class="edge">
<title>ring_attn_3_15_stage_1&#45;&gt;ring_attn_3_15_stage_2</title>
<path fill="none" stroke="black" d="M9134.5,-4514.88C9134.5,-4514.88 9134.5,-4340.39 9134.5,-4340.39"/>
<polygon fill="black" stroke="black" points="9138,-4340.39 9134.5,-4330.39 9131,-4340.39 9138,-4340.39"/>
</g>
<!-- ring_attn_3_15_stage_2&#45;&gt;ring_attn_3_0_stage_2 -->
<g id="edge2563" class="edge">
<title>ring_attn_3_15_stage_2&#45;&gt;ring_attn_3_0_stage_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9030,-4364.07C9030,-4385.17 9030,-4403 9030,-4403 9030,-4403 225,-4403 225,-4403 225,-4403 225,-4374.07 225,-4374.07"/>
<polygon fill="red" stroke="red" points="228.5,-4374.07 225,-4364.07 221.5,-4374.07 228.5,-4374.07"/>
<text text-anchor="middle" x="4628" y="-4433.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-4418.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-4403.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_3_15_stage_2&#45;&gt;ring_attn_3_15_stage_3 -->
<g id="edge1533" class="edge">
<title>ring_attn_3_15_stage_2&#45;&gt;ring_attn_3_15_stage_3</title>
<path fill="none" stroke="black" d="M9099.67,-4250.48C9099.67,-4250.48 9099.67,-4098.58 9099.67,-4098.58"/>
<polygon fill="black" stroke="black" points="9103.17,-4098.58 9099.67,-4088.58 9096.17,-4098.58 9103.17,-4098.58"/>
</g>
<!-- ring_attn_3_15_stage_3&#45;&gt;ring_attn_3_0_stage_3 -->
<g id="edge2564" class="edge">
<title>ring_attn_3_15_stage_3&#45;&gt;ring_attn_3_0_stage_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-4088.49C8960.33,-4124.58 8960.33,-4169 8960.33,-4169 8960.33,-4169 294.67,-4169 294.67,-4169 294.67,-4169 294.67,-4098.49 294.67,-4098.49"/>
<polygon fill="red" stroke="red" points="298.17,-4098.49 294.67,-4088.49 291.17,-4098.49 298.17,-4098.49"/>
<text text-anchor="middle" x="4628" y="-4180.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-4165.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-4150.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_3_15_stage_3&#45;&gt;ring_attn_3_15_stage_4 -->
<g id="edge1534" class="edge">
<title>ring_attn_3_15_stage_3&#45;&gt;ring_attn_3_15_stage_4</title>
<path fill="none" stroke="black" d="M9099.67,-3997.48C9099.67,-3997.48 9099.67,-3845.58 9099.67,-3845.58"/>
<polygon fill="black" stroke="black" points="9103.17,-3845.58 9099.67,-3835.58 9096.17,-3845.58 9103.17,-3845.58"/>
</g>
<!-- ring_attn_3_15_stage_4&#45;&gt;ring_attn_3_0_stage_4 -->
<g id="edge2565" class="edge">
<title>ring_attn_3_15_stage_4&#45;&gt;ring_attn_3_0_stage_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-3835.49C8960.33,-3871.58 8960.33,-3916 8960.33,-3916 8960.33,-3916 294.67,-3916 294.67,-3916 294.67,-3916 294.67,-3845.49 294.67,-3845.49"/>
<polygon fill="red" stroke="red" points="298.17,-3845.49 294.67,-3835.49 291.17,-3845.49 298.17,-3845.49"/>
<text text-anchor="middle" x="4628" y="-3927.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-3912.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-3897.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_3_15_stage_4&#45;&gt;ring_attn_3_15_stage_5 -->
<g id="edge1535" class="edge">
<title>ring_attn_3_15_stage_4&#45;&gt;ring_attn_3_15_stage_5</title>
<path fill="none" stroke="black" d="M9099.67,-3744.48C9099.67,-3744.48 9099.67,-3592.58 9099.67,-3592.58"/>
<polygon fill="black" stroke="black" points="9103.17,-3592.58 9099.67,-3582.58 9096.17,-3592.58 9103.17,-3592.58"/>
</g>
<!-- ring_attn_3_15_stage_5&#45;&gt;ring_attn_3_0_stage_5 -->
<g id="edge2566" class="edge">
<title>ring_attn_3_15_stage_5&#45;&gt;ring_attn_3_0_stage_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-3582.49C8960.33,-3618.58 8960.33,-3663 8960.33,-3663 8960.33,-3663 294.67,-3663 294.67,-3663 294.67,-3663 294.67,-3592.49 294.67,-3592.49"/>
<polygon fill="red" stroke="red" points="298.17,-3592.49 294.67,-3582.49 291.17,-3592.49 298.17,-3592.49"/>
<text text-anchor="middle" x="4628" y="-3674.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-3659.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-3644.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_3_15_stage_5&#45;&gt;ring_attn_3_15_stage_6 -->
<g id="edge1536" class="edge">
<title>ring_attn_3_15_stage_5&#45;&gt;ring_attn_3_15_stage_6</title>
<path fill="none" stroke="black" d="M9099.67,-3491.48C9099.67,-3491.48 9099.67,-3339.58 9099.67,-3339.58"/>
<polygon fill="black" stroke="black" points="9103.17,-3339.58 9099.67,-3329.58 9096.17,-3339.58 9103.17,-3339.58"/>
</g>
<!-- ring_attn_3_15_stage_6&#45;&gt;ring_attn_3_0_stage_6 -->
<g id="edge2567" class="edge">
<title>ring_attn_3_15_stage_6&#45;&gt;ring_attn_3_0_stage_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-3329.49C8960.33,-3365.58 8960.33,-3410 8960.33,-3410 8960.33,-3410 294.67,-3410 294.67,-3410 294.67,-3410 294.67,-3339.49 294.67,-3339.49"/>
<polygon fill="red" stroke="red" points="298.17,-3339.49 294.67,-3329.49 291.17,-3339.49 298.17,-3339.49"/>
<text text-anchor="middle" x="4628" y="-3421.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-3406.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-3391.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_3_15_stage_6&#45;&gt;ring_attn_3_15_stage_7 -->
<g id="edge1537" class="edge">
<title>ring_attn_3_15_stage_6&#45;&gt;ring_attn_3_15_stage_7</title>
<path fill="none" stroke="black" d="M9099.67,-3238.48C9099.67,-3238.48 9099.67,-3086.58 9099.67,-3086.58"/>
<polygon fill="black" stroke="black" points="9103.17,-3086.58 9099.67,-3076.58 9096.17,-3086.58 9103.17,-3086.58"/>
</g>
<!-- ring_attn_3_15_stage_7&#45;&gt;ring_attn_3_0_stage_7 -->
<g id="edge2568" class="edge">
<title>ring_attn_3_15_stage_7&#45;&gt;ring_attn_3_0_stage_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-3076.49C8960.33,-3112.58 8960.33,-3157 8960.33,-3157 8960.33,-3157 294.67,-3157 294.67,-3157 294.67,-3157 294.67,-3086.49 294.67,-3086.49"/>
<polygon fill="red" stroke="red" points="298.17,-3086.49 294.67,-3076.49 291.17,-3086.49 298.17,-3086.49"/>
<text text-anchor="middle" x="4628" y="-3168.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-3153.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-3138.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_3_15_stage_7&#45;&gt;ring_attn_3_15_stage_8 -->
<g id="edge1538" class="edge">
<title>ring_attn_3_15_stage_7&#45;&gt;ring_attn_3_15_stage_8</title>
<path fill="none" stroke="black" d="M9030,-2962.87C9030,-2962.87 9030,-2856.25 9030,-2856.25"/>
<polygon fill="black" stroke="black" points="9033.5,-2856.25 9030,-2846.25 9026.5,-2856.25 9033.5,-2856.25"/>
</g>
<!-- ring_attn_3_15_stage_8&#45;&gt;ring_attn_3_0_stage_8 -->
<g id="edge2569" class="edge">
<title>ring_attn_3_15_stage_8&#45;&gt;ring_attn_3_0_stage_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-2732.51C8960.33,-2696.07 8960.33,-2651 8960.33,-2651 8960.33,-2651 294.67,-2651 294.67,-2651 294.67,-2651 294.67,-2722.51 294.67,-2722.51"/>
<polygon fill="red" stroke="red" points="291.17,-2722.51 294.67,-2732.51 298.17,-2722.51 291.17,-2722.51"/>
<text text-anchor="middle" x="4628" y="-2915.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-2900.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-2885.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_3_15_stage_8&#45;&gt;ring_attn_3_15_stage_9 -->
<g id="edge1539" class="edge">
<title>ring_attn_3_15_stage_8&#45;&gt;ring_attn_3_15_stage_9</title>
<path fill="none" stroke="black" d="M9099.67,-2732.48C9099.67,-2732.48 9099.67,-2580.58 9099.67,-2580.58"/>
<polygon fill="black" stroke="black" points="9103.17,-2580.58 9099.67,-2570.58 9096.17,-2580.58 9103.17,-2580.58"/>
</g>
<!-- ring_attn_3_15_stage_9&#45;&gt;ring_attn_3_0_stage_9 -->
<g id="edge2570" class="edge">
<title>ring_attn_3_15_stage_9&#45;&gt;ring_attn_3_0_stage_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8925.5,-2490.85C8925.5,-2459.54 8925.5,-2418 8925.5,-2418 8925.5,-2418 329.5,-2418 329.5,-2418 329.5,-2418 329.5,-2480.85 329.5,-2480.85"/>
<polygon fill="red" stroke="red" points="326,-2480.85 329.5,-2490.85 333,-2480.85 326,-2480.85"/>
<text text-anchor="middle" x="4628" y="-2662.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-2647.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-2632.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_3_15_stage_9&#45;&gt;ring_attn_3_15_stage_10 -->
<g id="edge1540" class="edge">
<title>ring_attn_3_15_stage_9&#45;&gt;ring_attn_3_15_stage_10</title>
<path fill="none" stroke="black" d="M9134.5,-2490.88C9134.5,-2490.88 9134.5,-2316.39 9134.5,-2316.39"/>
<polygon fill="black" stroke="black" points="9138,-2316.39 9134.5,-2306.39 9131,-2316.39 9138,-2316.39"/>
</g>
<!-- ring_attn_3_15_stage_10&#45;&gt;ring_attn_3_0_stage_10 -->
<g id="edge2571" class="edge">
<title>ring_attn_3_15_stage_10&#45;&gt;ring_attn_3_0_stage_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M9030,-2340.07C9030,-2361.17 9030,-2379 9030,-2379 9030,-2379 225,-2379 225,-2379 225,-2379 225,-2350.07 225,-2350.07"/>
<polygon fill="red" stroke="red" points="228.5,-2350.07 225,-2340.07 221.5,-2350.07 228.5,-2350.07"/>
<text text-anchor="middle" x="4628" y="-2409.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-2394.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-2379.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_3_15_stage_10&#45;&gt;ring_attn_3_15_stage_11 -->
<g id="edge1541" class="edge">
<title>ring_attn_3_15_stage_10&#45;&gt;ring_attn_3_15_stage_11</title>
<path fill="none" stroke="black" d="M9099.67,-2226.48C9099.67,-2226.48 9099.67,-2074.58 9099.67,-2074.58"/>
<polygon fill="black" stroke="black" points="9103.17,-2074.58 9099.67,-2064.58 9096.17,-2074.58 9103.17,-2074.58"/>
</g>
<!-- ring_attn_3_15_stage_11&#45;&gt;ring_attn_3_0_stage_11 -->
<g id="edge2572" class="edge">
<title>ring_attn_3_15_stage_11&#45;&gt;ring_attn_3_0_stage_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-2064.49C8960.33,-2100.58 8960.33,-2145 8960.33,-2145 8960.33,-2145 294.67,-2145 294.67,-2145 294.67,-2145 294.67,-2074.49 294.67,-2074.49"/>
<polygon fill="red" stroke="red" points="298.17,-2074.49 294.67,-2064.49 291.17,-2074.49 298.17,-2074.49"/>
<text text-anchor="middle" x="4628" y="-2156.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-2141.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-2126.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_3_15_stage_11&#45;&gt;ring_attn_3_15_stage_12 -->
<g id="edge1542" class="edge">
<title>ring_attn_3_15_stage_11&#45;&gt;ring_attn_3_15_stage_12</title>
<path fill="none" stroke="black" d="M9030,-1950.87C9030,-1950.87 9030,-1844.25 9030,-1844.25"/>
<polygon fill="black" stroke="black" points="9033.5,-1844.25 9030,-1834.25 9026.5,-1844.25 9033.5,-1844.25"/>
</g>
<!-- ring_attn_3_15_stage_12&#45;&gt;ring_attn_3_0_stage_12 -->
<g id="edge2573" class="edge">
<title>ring_attn_3_15_stage_12&#45;&gt;ring_attn_3_0_stage_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-1720.51C8960.33,-1684.07 8960.33,-1639 8960.33,-1639 8960.33,-1639 294.67,-1639 294.67,-1639 294.67,-1639 294.67,-1710.51 294.67,-1710.51"/>
<polygon fill="red" stroke="red" points="291.17,-1710.51 294.67,-1720.51 298.17,-1710.51 291.17,-1710.51"/>
<text text-anchor="middle" x="4628" y="-1903.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-1888.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-1873.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_3_15_stage_12&#45;&gt;ring_attn_3_15_stage_13 -->
<g id="edge1543" class="edge">
<title>ring_attn_3_15_stage_12&#45;&gt;ring_attn_3_15_stage_13</title>
<path fill="none" stroke="black" d="M9099.67,-1720.48C9099.67,-1720.48 9099.67,-1568.58 9099.67,-1568.58"/>
<polygon fill="black" stroke="black" points="9103.17,-1568.58 9099.67,-1558.58 9096.17,-1568.58 9103.17,-1568.58"/>
</g>
<!-- ring_attn_3_15_stage_13&#45;&gt;ring_attn_3_0_stage_13 -->
<g id="edge2574" class="edge">
<title>ring_attn_3_15_stage_13&#45;&gt;ring_attn_3_0_stage_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-1467.51C8960.33,-1431.07 8960.33,-1386 8960.33,-1386 8960.33,-1386 294.67,-1386 294.67,-1386 294.67,-1386 294.67,-1457.51 294.67,-1457.51"/>
<polygon fill="red" stroke="red" points="291.17,-1457.51 294.67,-1467.51 298.17,-1457.51 291.17,-1457.51"/>
<text text-anchor="middle" x="4628" y="-1650.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-1635.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-1620.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_3_15_stage_13&#45;&gt;ring_attn_3_15_stage_14 -->
<g id="edge1544" class="edge">
<title>ring_attn_3_15_stage_13&#45;&gt;ring_attn_3_15_stage_14</title>
<path fill="none" stroke="black" d="M9099.67,-1467.48C9099.67,-1467.48 9099.67,-1315.58 9099.67,-1315.58"/>
<polygon fill="black" stroke="black" points="9103.17,-1315.58 9099.67,-1305.58 9096.17,-1315.58 9103.17,-1315.58"/>
</g>
<!-- ring_attn_3_15_stage_14&#45;&gt;ring_attn_3_0_stage_14 -->
<g id="edge2575" class="edge">
<title>ring_attn_3_15_stage_14&#45;&gt;ring_attn_3_0_stage_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8960.33,-1214.51C8960.33,-1178.07 8960.33,-1133 8960.33,-1133 8960.33,-1133 294.67,-1133 294.67,-1133 294.67,-1133 294.67,-1204.51 294.67,-1204.51"/>
<polygon fill="red" stroke="red" points="291.17,-1204.51 294.67,-1214.51 298.17,-1204.51 291.17,-1204.51"/>
<text text-anchor="middle" x="4628" y="-1397.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-1382.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-1367.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ring_attn_3_15_stage_14&#45;&gt;ring_attn_3_15_stage_15 -->
<g id="edge1545" class="edge">
<title>ring_attn_3_15_stage_14&#45;&gt;ring_attn_3_15_stage_15</title>
<path fill="none" stroke="black" d="M9099.67,-1214.48C9099.67,-1214.48 9099.67,-1062.58 9099.67,-1062.58"/>
<polygon fill="black" stroke="black" points="9103.17,-1062.58 9099.67,-1052.58 9096.17,-1062.58 9103.17,-1062.58"/>
</g>
<!-- ring_attn_3_15_stage_15&#45;&gt;ring_attn_3_0_stage_15 -->
<g id="edge2576" class="edge">
<title>ring_attn_3_15_stage_15&#45;&gt;ring_attn_3_0_stage_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M8872.75,-990.13C8872.75,-960.45 8872.75,-902 8872.75,-902 8872.75,-902 382.25,-902 382.25,-902 382.25,-902 382.25,-980.13 382.25,-980.13"/>
<polygon fill="red" stroke="red" points="378.75,-980.13 382.25,-990.13 385.75,-980.13 378.75,-980.13"/>
<text text-anchor="middle" x="4628" y="-1144.8" font-family="Times,serif" font-size="14.00">KV Block Transfer</text>
<text text-anchor="middle" x="4628" y="-1129.8" font-family="Times,serif" font-size="14.00">GPU15→GPU0</text>
<text text-anchor="middle" x="4628" y="-1114.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_3_15 -->
<g id="node1562" class="node">
<title>attn_out_3_15</title>
<polygon fill="none" stroke="black" points="9099.5,-866 8960.5,-866 8960.5,-813 9099.5,-813 9099.5,-866"/>
<text text-anchor="middle" x="9030" y="-850.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9030" y="-835.8" font-family="Times,serif" font-size="14.00">W_o: 4096×4096</text>
<text text-anchor="middle" x="9030" y="-820.8" font-family="Times,serif" font-size="14.00">Split: 256×4096</text>
</g>
<!-- ring_attn_3_15_stage_15&#45;&gt;attn_out_3_15 -->
<g id="edge1546" class="edge">
<title>ring_attn_3_15_stage_15&#45;&gt;attn_out_3_15</title>
<path fill="none" stroke="black" d="M9030,-938.87C9030,-938.87 9030,-876.18 9030,-876.18"/>
<polygon fill="black" stroke="black" points="9033.5,-876.18 9030,-866.18 9026.5,-876.18 9033.5,-876.18"/>
</g>
<!-- attn_residual_3_15 -->
<g id="node1563" class="node">
<title>attn_residual_3_15</title>
<ellipse fill="none" stroke="black" cx="9030" cy="-713" rx="105.5" ry="27"/>
<text text-anchor="middle" x="9030" y="-716.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="9030" y="-701.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- attn_out_3_15&#45;&gt;attn_residual_3_15 -->
<g id="edge1547" class="edge">
<title>attn_out_3_15&#45;&gt;attn_residual_3_15</title>
<path fill="none" stroke="black" d="M9030,-812.98C9030,-812.98 9030,-750.36 9030,-750.36"/>
<polygon fill="black" stroke="black" points="9033.5,-750.36 9030,-740.36 9026.5,-750.36 9033.5,-750.36"/>
</g>
<!-- ffn_up_3_15 -->
<g id="node1564" class="node">
<title>ffn_up_3_15</title>
<polygon fill="none" stroke="black" points="9109,-613 8951,-613 8951,-560 9109,-560 9109,-613"/>
<text text-anchor="middle" x="9030" y="-597.8" font-family="Times,serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="9030" y="-582.8" font-family="Times,serif" font-size="14.00">W_up: 4096×16384</text>
<text text-anchor="middle" x="9030" y="-567.8" font-family="Times,serif" font-size="14.00">Split: 4096×1024</text>
</g>
<!-- attn_residual_3_15&#45;&gt;ffn_up_3_15 -->
<g id="edge1548" class="edge">
<title>attn_residual_3_15&#45;&gt;ffn_up_3_15</title>
<path fill="none" stroke="black" d="M9030,-685.86C9030,-685.86 9030,-623.16 9030,-623.16"/>
<polygon fill="black" stroke="black" points="9033.5,-623.16 9030,-613.16 9026.5,-623.16 9033.5,-623.16"/>
</g>
<!-- ffn_gelu_3_15 -->
<g id="node1565" class="node">
<title>ffn_gelu_3_15</title>
<ellipse fill="none" stroke="black" cx="9030" cy="-460" rx="105.5" ry="27"/>
<text text-anchor="middle" x="9030" y="-463.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="9030" y="-448.8" font-family="Times,serif" font-size="14.00">1024×1024×1024</text>
</g>
<!-- ffn_up_3_15&#45;&gt;ffn_gelu_3_15 -->
<g id="edge1549" class="edge">
<title>ffn_up_3_15&#45;&gt;ffn_gelu_3_15</title>
<path fill="none" stroke="black" d="M9030,-559.98C9030,-559.98 9030,-497.36 9030,-497.36"/>
<polygon fill="black" stroke="black" points="9033.5,-497.36 9030,-487.36 9026.5,-497.36 9033.5,-497.36"/>
</g>
<!-- ffn_down_3_15 -->
<g id="node1566" class="node">
<title>ffn_down_3_15</title>
<polygon fill="none" stroke="black" points="9119,-360 8941,-360 8941,-307 9119,-307 9119,-360"/>
<text text-anchor="middle" x="9030" y="-344.8" font-family="Times,serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="9030" y="-329.8" font-family="Times,serif" font-size="14.00">W_down: 16384×4096</text>
<text text-anchor="middle" x="9030" y="-314.8" font-family="Times,serif" font-size="14.00">Split: 1024×4096</text>
</g>
<!-- ffn_gelu_3_15&#45;&gt;ffn_down_3_15 -->
<g id="edge1550" class="edge">
<title>ffn_gelu_3_15&#45;&gt;ffn_down_3_15</title>
<path fill="none" stroke="black" d="M9030,-432.86C9030,-432.86 9030,-370.16 9030,-370.16"/>
<polygon fill="black" stroke="black" points="9033.5,-370.16 9030,-360.16 9026.5,-370.16 9033.5,-370.16"/>
</g>
<!-- ffn_residual_3_15 -->
<g id="node1567" class="node">
<title>ffn_residual_3_15</title>
<ellipse fill="none" stroke="black" cx="9030" cy="-207" rx="105.5" ry="27"/>
<text text-anchor="middle" x="9030" y="-210.8" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="9030" y="-195.8" font-family="Times,serif" font-size="14.00">1024×1024×4096</text>
</g>
<!-- ffn_down_3_15&#45;&gt;ffn_residual_3_15 -->
<g id="edge1551" class="edge">
<title>ffn_down_3_15&#45;&gt;ffn_residual_3_15</title>
<path fill="none" stroke="black" d="M9030,-306.98C9030,-306.98 9030,-244.36 9030,-244.36"/>
<polygon fill="black" stroke="black" points="9033.5,-244.36 9030,-234.36 9026.5,-244.36 9033.5,-244.36"/>
</g>
<!-- output_15 -->
<g id="node1568" class="node">
<title>output_15</title>
<polygon fill="lightcoral" stroke="black" points="9127.5,-107 8932.5,-107 8932.5,-69 9127.5,-69 9127.5,-107"/>
<text text-anchor="middle" x="9030" y="-91.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="9030" y="-76.8" font-family="Times,serif" font-size="14.00">Y[15]: 1024×1024×4096</text>
</g>
<!-- ffn_residual_3_15&#45;&gt;output_15 -->
<g id="edge1552" class="edge">
<title>ffn_residual_3_15&#45;&gt;output_15</title>
<path fill="none" stroke="black" d="M9030,-180C9030,-180 9030,-117.12 9030,-117.12"/>
<polygon fill="black" stroke="black" points="9033.5,-117.12 9030,-107.12 9026.5,-117.12 9033.5,-117.12"/>
</g>
</g>
</svg>
