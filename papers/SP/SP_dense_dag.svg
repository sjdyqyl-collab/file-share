<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Dense_Transformer_RA_SP Pages: 1 -->
<svg width="1722pt" height="3600pt"
 viewBox="0.00 0.00 1721.89 3600.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.3 0.3) rotate(0) translate(4 11833.66)">
<title>Dense_Transformer_RA_SP</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-11833.66 5658,-11833.66 5658,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-11707.66 8,-11821.66 5646,-11821.66 5646,-11707.66 8,-11707.66"/>
<text text-anchor="middle" x="2827" y="-11806.46" font-family="Times,serif" font-size="14.00">Input Sequence Parallel Split</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer1</title>
<path fill="none" stroke="black" d="M1042,-8816C1042,-8816 4360,-8816 4360,-8816 4366,-8816 4372,-8822 4372,-8828 4372,-8828 4372,-11676.66 4372,-11676.66 4372,-11682.66 4366,-11688.66 4360,-11688.66 4360,-11688.66 1042,-11688.66 1042,-11688.66 1036,-11688.66 1030,-11682.66 1030,-11676.66 1030,-11676.66 1030,-8828 1030,-8828 1030,-8822 1036,-8816 1042,-8816"/>
<text text-anchor="middle" x="2701" y="-11673.46" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_l1_stage0</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1247,-11420.5 1247,-11534.5 4364,-11534.5 4364,-11420.5 1247,-11420.5"/>
<text text-anchor="middle" x="2805.5" y="-11519.3" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_l1_stage1</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1247,-11273.5 1247,-11387.5 4364,-11387.5 4364,-11273.5 1247,-11273.5"/>
<text text-anchor="middle" x="2805.5" y="-11372.3" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_l1_stage2</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1247,-11126.5 1247,-11240.5 4364,-11240.5 4364,-11126.5 1247,-11126.5"/>
<text text-anchor="middle" x="2805.5" y="-11225.3" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_l1_stage3</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1247,-10979.5 1247,-11093.5 4364,-11093.5 4364,-10979.5 1247,-10979.5"/>
<text text-anchor="middle" x="2805.5" y="-11078.3" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_l1_stage4</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1247,-10832.5 1247,-10946.5 4364,-10946.5 4364,-10832.5 1247,-10832.5"/>
<text text-anchor="middle" x="2805.5" y="-10931.3" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_l1_stage5</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1247,-10685.5 1247,-10799.5 4364,-10799.5 4364,-10685.5 1247,-10685.5"/>
<text text-anchor="middle" x="2805.5" y="-10784.3" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_l1_stage6</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1247,-10538.5 1247,-10652.5 4364,-10652.5 4364,-10538.5 1247,-10538.5"/>
<text text-anchor="middle" x="2805.5" y="-10637.3" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_l1_stage7</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1247,-10391.5 1247,-10505.5 4364,-10505.5 4364,-10391.5 1247,-10391.5"/>
<text text-anchor="middle" x="2805.5" y="-10490.3" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_l1_stage8</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1247,-10244.5 1247,-10358.5 4364,-10358.5 4364,-10244.5 1247,-10244.5"/>
<text text-anchor="middle" x="2805.5" y="-10343.3" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_l1_stage9</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1247,-10097.5 1247,-10211.5 4364,-10211.5 4364,-10097.5 1247,-10097.5"/>
<text text-anchor="middle" x="2805.5" y="-10196.3" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_l1_stage10</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1038,-9950.5 1038,-10064.5 4364,-10064.5 4364,-9950.5 1038,-9950.5"/>
<text text-anchor="middle" x="2701" y="-10049.3" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_l1_stage11</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1038,-9803.5 1038,-9917.5 4364,-9917.5 4364,-9803.5 1038,-9803.5"/>
<text text-anchor="middle" x="2701" y="-9902.3" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_l1_stage12</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1038,-9656.5 1038,-9770.5 4364,-9770.5 4364,-9656.5 1038,-9656.5"/>
<text text-anchor="middle" x="2701" y="-9755.3" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_l1_stage13</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1038,-9509.5 1038,-9623.5 4364,-9623.5 4364,-9509.5 1038,-9509.5"/>
<text text-anchor="middle" x="2701" y="-9608.3" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_l1_stage14</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1038,-9362.5 1038,-9476.5 4364,-9476.5 4364,-9362.5 1038,-9362.5"/>
<text text-anchor="middle" x="2701" y="-9461.3" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_l1_stage15</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1038,-9215.5 1038,-9329.5 4364,-9329.5 4364,-9215.5 1038,-9215.5"/>
<text text-anchor="middle" x="2701" y="-9314.3" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_layer2</title>
<path fill="none" stroke="black" d="M984,-5924.33C984,-5924.33 4302,-5924.33 4302,-5924.33 4308,-5924.33 4314,-5930.33 4314,-5936.33 4314,-5936.33 4314,-8785 4314,-8785 4314,-8791 4308,-8797 4302,-8797 4302,-8797 984,-8797 984,-8797 978,-8797 972,-8791 972,-8785 972,-8785 972,-5936.33 972,-5936.33 972,-5930.33 978,-5924.33 984,-5924.33"/>
<text text-anchor="middle" x="2643" y="-8781.8" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_l2_stage0</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1189,-8528.83 1189,-8642.83 4306,-8642.83 4306,-8528.83 1189,-8528.83"/>
<text text-anchor="middle" x="2747.5" y="-8627.63" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_l2_stage1</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1189,-8381.83 1189,-8495.83 4306,-8495.83 4306,-8381.83 1189,-8381.83"/>
<text text-anchor="middle" x="2747.5" y="-8480.63" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_l2_stage2</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1189,-8234.83 1189,-8348.83 4306,-8348.83 4306,-8234.83 1189,-8234.83"/>
<text text-anchor="middle" x="2747.5" y="-8333.63" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_l2_stage3</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1189,-8087.83 1189,-8201.83 4306,-8201.83 4306,-8087.83 1189,-8087.83"/>
<text text-anchor="middle" x="2747.5" y="-8186.63" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
</g>
<g id="clust24" class="cluster">
<title>cluster_l2_stage4</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1189,-7940.83 1189,-8054.83 4306,-8054.83 4306,-7940.83 1189,-7940.83"/>
<text text-anchor="middle" x="2747.5" y="-8039.63" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
</g>
<g id="clust25" class="cluster">
<title>cluster_l2_stage5</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1189,-7793.83 1189,-7907.83 4306,-7907.83 4306,-7793.83 1189,-7793.83"/>
<text text-anchor="middle" x="2747.5" y="-7892.63" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
</g>
<g id="clust26" class="cluster">
<title>cluster_l2_stage6</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1189,-7646.83 1189,-7760.83 4306,-7760.83 4306,-7646.83 1189,-7646.83"/>
<text text-anchor="middle" x="2747.5" y="-7745.63" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
</g>
<g id="clust27" class="cluster">
<title>cluster_l2_stage7</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1189,-7499.83 1189,-7613.83 4306,-7613.83 4306,-7499.83 1189,-7499.83"/>
<text text-anchor="middle" x="2747.5" y="-7598.63" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
</g>
<g id="clust28" class="cluster">
<title>cluster_l2_stage8</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1189,-7352.83 1189,-7466.83 4306,-7466.83 4306,-7352.83 1189,-7352.83"/>
<text text-anchor="middle" x="2747.5" y="-7451.63" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
</g>
<g id="clust29" class="cluster">
<title>cluster_l2_stage9</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1189,-7205.83 1189,-7319.83 4306,-7319.83 4306,-7205.83 1189,-7205.83"/>
<text text-anchor="middle" x="2747.5" y="-7304.63" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
</g>
<g id="clust30" class="cluster">
<title>cluster_l2_stage10</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="980,-7058.83 980,-7172.83 4306,-7172.83 4306,-7058.83 980,-7058.83"/>
<text text-anchor="middle" x="2643" y="-7157.63" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
</g>
<g id="clust31" class="cluster">
<title>cluster_l2_stage11</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="980,-6911.83 980,-7025.83 4306,-7025.83 4306,-6911.83 980,-6911.83"/>
<text text-anchor="middle" x="2643" y="-7010.63" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
</g>
<g id="clust32" class="cluster">
<title>cluster_l2_stage12</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="980,-6764.83 980,-6878.83 4306,-6878.83 4306,-6764.83 980,-6764.83"/>
<text text-anchor="middle" x="2643" y="-6863.63" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
</g>
<g id="clust33" class="cluster">
<title>cluster_l2_stage13</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="980,-6617.83 980,-6731.83 4306,-6731.83 4306,-6617.83 980,-6617.83"/>
<text text-anchor="middle" x="2643" y="-6716.63" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
</g>
<g id="clust34" class="cluster">
<title>cluster_l2_stage14</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="980,-6470.83 980,-6584.83 4306,-6584.83 4306,-6470.83 980,-6470.83"/>
<text text-anchor="middle" x="2643" y="-6569.63" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
</g>
<g id="clust35" class="cluster">
<title>cluster_l2_stage15</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="980,-6323.83 980,-6437.83 4306,-6437.83 4306,-6323.83 980,-6323.83"/>
<text text-anchor="middle" x="2643" y="-6422.63" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
</g>
<g id="clust36" class="cluster">
<title>cluster_layer3</title>
<path fill="none" stroke="black" d="M929,-3032.67C929,-3032.67 4247,-3032.67 4247,-3032.67 4253,-3032.67 4259,-3038.67 4259,-3044.67 4259,-3044.67 4259,-5893.33 4259,-5893.33 4259,-5899.33 4253,-5905.33 4247,-5905.33 4247,-5905.33 929,-5905.33 929,-5905.33 923,-5905.33 917,-5899.33 917,-5893.33 917,-5893.33 917,-3044.67 917,-3044.67 917,-3038.67 923,-3032.67 929,-3032.67"/>
<text text-anchor="middle" x="2588" y="-5890.13" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<g id="clust37" class="cluster">
<title>cluster_l3_stage0</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1134,-5637.17 1134,-5751.17 4251,-5751.17 4251,-5637.17 1134,-5637.17"/>
<text text-anchor="middle" x="2692.5" y="-5735.97" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
</g>
<g id="clust38" class="cluster">
<title>cluster_l3_stage1</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1134,-5490.17 1134,-5604.17 4251,-5604.17 4251,-5490.17 1134,-5490.17"/>
<text text-anchor="middle" x="2692.5" y="-5588.97" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
</g>
<g id="clust39" class="cluster">
<title>cluster_l3_stage2</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1134,-5343.17 1134,-5457.17 4251,-5457.17 4251,-5343.17 1134,-5343.17"/>
<text text-anchor="middle" x="2692.5" y="-5441.97" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
</g>
<g id="clust40" class="cluster">
<title>cluster_l3_stage3</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1134,-5196.17 1134,-5310.17 4251,-5310.17 4251,-5196.17 1134,-5196.17"/>
<text text-anchor="middle" x="2692.5" y="-5294.97" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
</g>
<g id="clust41" class="cluster">
<title>cluster_l3_stage4</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1134,-5049.17 1134,-5163.17 4251,-5163.17 4251,-5049.17 1134,-5049.17"/>
<text text-anchor="middle" x="2692.5" y="-5147.97" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
</g>
<g id="clust42" class="cluster">
<title>cluster_l3_stage5</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1134,-4902.17 1134,-5016.17 4251,-5016.17 4251,-4902.17 1134,-4902.17"/>
<text text-anchor="middle" x="2692.5" y="-5000.97" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
</g>
<g id="clust43" class="cluster">
<title>cluster_l3_stage6</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1134,-4755.17 1134,-4869.17 4251,-4869.17 4251,-4755.17 1134,-4755.17"/>
<text text-anchor="middle" x="2692.5" y="-4853.97" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
</g>
<g id="clust44" class="cluster">
<title>cluster_l3_stage7</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1134,-4608.17 1134,-4722.17 4251,-4722.17 4251,-4608.17 1134,-4608.17"/>
<text text-anchor="middle" x="2692.5" y="-4706.97" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
</g>
<g id="clust45" class="cluster">
<title>cluster_l3_stage8</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1134,-4461.17 1134,-4575.17 4251,-4575.17 4251,-4461.17 1134,-4461.17"/>
<text text-anchor="middle" x="2692.5" y="-4559.97" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
</g>
<g id="clust46" class="cluster">
<title>cluster_l3_stage9</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1134,-4314.17 1134,-4428.17 4251,-4428.17 4251,-4314.17 1134,-4314.17"/>
<text text-anchor="middle" x="2692.5" y="-4412.97" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
</g>
<g id="clust47" class="cluster">
<title>cluster_l3_stage10</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="925,-4167.17 925,-4281.17 4251,-4281.17 4251,-4167.17 925,-4167.17"/>
<text text-anchor="middle" x="2588" y="-4265.97" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
</g>
<g id="clust48" class="cluster">
<title>cluster_l3_stage11</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="925,-4020.17 925,-4134.17 4251,-4134.17 4251,-4020.17 925,-4020.17"/>
<text text-anchor="middle" x="2588" y="-4118.97" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
</g>
<g id="clust49" class="cluster">
<title>cluster_l3_stage12</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="925,-3873.17 925,-3987.17 4251,-3987.17 4251,-3873.17 925,-3873.17"/>
<text text-anchor="middle" x="2588" y="-3971.97" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
</g>
<g id="clust50" class="cluster">
<title>cluster_l3_stage13</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="925,-3726.17 925,-3840.17 4251,-3840.17 4251,-3726.17 925,-3726.17"/>
<text text-anchor="middle" x="2588" y="-3824.97" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
</g>
<g id="clust51" class="cluster">
<title>cluster_l3_stage14</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="925,-3579.17 925,-3693.17 4251,-3693.17 4251,-3579.17 925,-3579.17"/>
<text text-anchor="middle" x="2588" y="-3677.97" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
</g>
<g id="clust52" class="cluster">
<title>cluster_l3_stage15</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="925,-3432.17 925,-3546.17 4251,-3546.17 4251,-3432.17 925,-3432.17"/>
<text text-anchor="middle" x="2588" y="-3530.97" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
</g>
<g id="clust53" class="cluster">
<title>cluster_layer4</title>
<path fill="none" stroke="black" d="M873,-141C873,-141 4191,-141 4191,-141 4197,-141 4203,-147 4203,-153 4203,-153 4203,-3001.67 4203,-3001.67 4203,-3007.67 4197,-3013.67 4191,-3013.67 4191,-3013.67 873,-3013.67 873,-3013.67 867,-3013.67 861,-3007.67 861,-3001.67 861,-3001.67 861,-153 861,-153 861,-147 867,-141 873,-141"/>
<text text-anchor="middle" x="2532" y="-2998.47" font-family="Times,serif" font-size="14.00">Layer 4</text>
</g>
<g id="clust54" class="cluster">
<title>cluster_l4_stage0</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1078,-2745.5 1078,-2859.5 4195,-2859.5 4195,-2745.5 1078,-2745.5"/>
<text text-anchor="middle" x="2636.5" y="-2844.3" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
</g>
<g id="clust55" class="cluster">
<title>cluster_l4_stage1</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1078,-2598.5 1078,-2712.5 4195,-2712.5 4195,-2598.5 1078,-2598.5"/>
<text text-anchor="middle" x="2636.5" y="-2697.3" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
</g>
<g id="clust56" class="cluster">
<title>cluster_l4_stage2</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1078,-2451.5 1078,-2565.5 4195,-2565.5 4195,-2451.5 1078,-2451.5"/>
<text text-anchor="middle" x="2636.5" y="-2550.3" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
</g>
<g id="clust57" class="cluster">
<title>cluster_l4_stage3</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1078,-2304.5 1078,-2418.5 4195,-2418.5 4195,-2304.5 1078,-2304.5"/>
<text text-anchor="middle" x="2636.5" y="-2403.3" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
</g>
<g id="clust58" class="cluster">
<title>cluster_l4_stage4</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1078,-2157.5 1078,-2271.5 4195,-2271.5 4195,-2157.5 1078,-2157.5"/>
<text text-anchor="middle" x="2636.5" y="-2256.3" font-family="Times,serif" font-size="14.00">Ring Stage 4</text>
</g>
<g id="clust59" class="cluster">
<title>cluster_l4_stage5</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1078,-2010.5 1078,-2124.5 4195,-2124.5 4195,-2010.5 1078,-2010.5"/>
<text text-anchor="middle" x="2636.5" y="-2109.3" font-family="Times,serif" font-size="14.00">Ring Stage 5</text>
</g>
<g id="clust60" class="cluster">
<title>cluster_l4_stage6</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1078,-1863.5 1078,-1977.5 4195,-1977.5 4195,-1863.5 1078,-1863.5"/>
<text text-anchor="middle" x="2636.5" y="-1962.3" font-family="Times,serif" font-size="14.00">Ring Stage 6</text>
</g>
<g id="clust61" class="cluster">
<title>cluster_l4_stage7</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1078,-1716.5 1078,-1830.5 4195,-1830.5 4195,-1716.5 1078,-1716.5"/>
<text text-anchor="middle" x="2636.5" y="-1815.3" font-family="Times,serif" font-size="14.00">Ring Stage 7</text>
</g>
<g id="clust62" class="cluster">
<title>cluster_l4_stage8</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1078,-1569.5 1078,-1683.5 4195,-1683.5 4195,-1569.5 1078,-1569.5"/>
<text text-anchor="middle" x="2636.5" y="-1668.3" font-family="Times,serif" font-size="14.00">Ring Stage 8</text>
</g>
<g id="clust63" class="cluster">
<title>cluster_l4_stage9</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1078,-1422.5 1078,-1536.5 4195,-1536.5 4195,-1422.5 1078,-1422.5"/>
<text text-anchor="middle" x="2636.5" y="-1521.3" font-family="Times,serif" font-size="14.00">Ring Stage 9</text>
</g>
<g id="clust64" class="cluster">
<title>cluster_l4_stage10</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="869,-1275.5 869,-1389.5 4195,-1389.5 4195,-1275.5 869,-1275.5"/>
<text text-anchor="middle" x="2532" y="-1374.3" font-family="Times,serif" font-size="14.00">Ring Stage 10</text>
</g>
<g id="clust65" class="cluster">
<title>cluster_l4_stage11</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="869,-1128.5 869,-1242.5 4195,-1242.5 4195,-1128.5 869,-1128.5"/>
<text text-anchor="middle" x="2532" y="-1227.3" font-family="Times,serif" font-size="14.00">Ring Stage 11</text>
</g>
<g id="clust66" class="cluster">
<title>cluster_l4_stage12</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="869,-981.5 869,-1095.5 4195,-1095.5 4195,-981.5 869,-981.5"/>
<text text-anchor="middle" x="2532" y="-1080.3" font-family="Times,serif" font-size="14.00">Ring Stage 12</text>
</g>
<g id="clust67" class="cluster">
<title>cluster_l4_stage13</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="869,-834.5 869,-948.5 4195,-948.5 4195,-834.5 869,-834.5"/>
<text text-anchor="middle" x="2532" y="-933.3" font-family="Times,serif" font-size="14.00">Ring Stage 13</text>
</g>
<g id="clust68" class="cluster">
<title>cluster_l4_stage14</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="869,-687.5 869,-801.5 4195,-801.5 4195,-687.5 869,-687.5"/>
<text text-anchor="middle" x="2532" y="-786.3" font-family="Times,serif" font-size="14.00">Ring Stage 14</text>
</g>
<g id="clust69" class="cluster">
<title>cluster_l4_stage15</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="869,-540.5 869,-654.5 4195,-654.5 4195,-540.5 869,-540.5"/>
<text text-anchor="middle" x="2532" y="-639.3" font-family="Times,serif" font-size="14.00">Ring Stage 15</text>
</g>
<g id="clust70" class="cluster">
<title>cluster_output</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="839,-8 839,-122 4229,-122 4229,-8 839,-8"/>
<text text-anchor="middle" x="2534" y="-106.8" font-family="Times,serif" font-size="14.00">Output Gather</text>
</g>
<!-- input_gpu0 -->
<g id="node1" class="node">
<title>input_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="181" cy="-11753.16" rx="165" ry="37.5"/>
<text text-anchor="middle" x="181" y="-11764.46" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="181" y="-11749.46" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="181" y="-11734.46" font-family="Times,serif" font-size="14.00">X[:, 0*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu0 -->
<g id="node273" class="node">
<title>l1_qkv_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1159" cy="-11609.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1159" y="-11628.38" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="1159" y="-11613.38" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1159" y="-11598.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1159" y="-11583.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu0&#45;&gt;l1_qkv_gpu0 -->
<g id="edge1217" class="edge">
<title>input_gpu0&#45;&gt;l1_qkv_gpu0</title>
<path fill="none" stroke="black" d="M283.09,-11723.69C306.58,-11717.8 331.56,-11712.06 355,-11707.66 605.76,-11660.67 904.97,-11631.52 1057.97,-11618.53"/>
<polygon fill="black" stroke="black" points="1058.61,-11621.99 1068.28,-11617.66 1058.02,-11615.01 1058.61,-11621.99"/>
</g>
<!-- input_gpu1 -->
<g id="node2" class="node">
<title>input_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="529" cy="-11753.16" rx="165" ry="37.5"/>
<text text-anchor="middle" x="529" y="-11764.46" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="529" y="-11749.46" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="529" y="-11734.46" font-family="Times,serif" font-size="14.00">X[:, 1*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu1 -->
<g id="node274" class="node">
<title>l1_qkv_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1402" cy="-11609.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1402" y="-11628.38" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="1402" y="-11613.38" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1402" y="-11598.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1402" y="-11583.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu1&#45;&gt;l1_qkv_gpu1 -->
<g id="edge1218" class="edge">
<title>input_gpu1&#45;&gt;l1_qkv_gpu1</title>
<path fill="none" stroke="black" d="M627.63,-11723C652.06,-11716.87 678.31,-11711.2 703,-11707.66 825.6,-11690.11 1140.59,-11721.51 1260,-11688.66 1287.18,-11681.19 1314.84,-11667.6 1338.43,-11653.83"/>
<polygon fill="black" stroke="black" points="1340.48,-11656.69 1347.27,-11648.56 1336.89,-11650.68 1340.48,-11656.69"/>
</g>
<!-- input_gpu2 -->
<g id="node3" class="node">
<title>input_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="877" cy="-11753.16" rx="165" ry="37.5"/>
<text text-anchor="middle" x="877" y="-11764.46" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="877" y="-11749.46" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="877" y="-11734.46" font-family="Times,serif" font-size="14.00">X[:, 2*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu2 -->
<g id="node275" class="node">
<title>l1_qkv_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1609" cy="-11609.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1609" y="-11628.38" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="1609" y="-11613.38" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1609" y="-11598.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1609" y="-11583.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu2&#45;&gt;l1_qkv_gpu2 -->
<g id="edge1219" class="edge">
<title>input_gpu2&#45;&gt;l1_qkv_gpu2</title>
<path fill="none" stroke="black" d="M976.11,-11723.02C1000.4,-11716.94 1026.48,-11711.28 1051,-11707.66 1150.46,-11693.02 1408.17,-11722.04 1503,-11688.66 1522.19,-11681.91 1540.84,-11670.42 1557.02,-11658.3"/>
<polygon fill="black" stroke="black" points="1559.48,-11660.81 1565.24,-11651.92 1555.19,-11655.28 1559.48,-11660.81"/>
</g>
<!-- input_gpu3 -->
<g id="node4" class="node">
<title>input_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1225" cy="-11753.16" rx="165" ry="37.5"/>
<text text-anchor="middle" x="1225" y="-11764.46" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1225" y="-11749.46" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1225" y="-11734.46" font-family="Times,serif" font-size="14.00">X[:, 3*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu3 -->
<g id="node276" class="node">
<title>l1_qkv_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1832" cy="-11609.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1832" y="-11628.38" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="1832" y="-11613.38" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1832" y="-11598.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1832" y="-11583.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu3&#45;&gt;l1_qkv_gpu3 -->
<g id="edge1220" class="edge">
<title>input_gpu3&#45;&gt;l1_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1324.62,-11723.24C1348.78,-11717.18 1374.67,-11711.48 1399,-11707.66 1467.4,-11696.93 1644.17,-11710.13 1710,-11688.66 1732.49,-11681.33 1754.93,-11668.84 1774.31,-11655.98"/>
<polygon fill="black" stroke="black" points="1776.42,-11658.78 1782.71,-11650.26 1772.48,-11653 1776.42,-11658.78"/>
</g>
<!-- input_gpu4 -->
<g id="node5" class="node">
<title>input_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1573" cy="-11753.16" rx="165" ry="37.5"/>
<text text-anchor="middle" x="1573" y="-11764.46" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1573" y="-11749.46" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1573" y="-11734.46" font-family="Times,serif" font-size="14.00">X[:, 4*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu4 -->
<g id="node277" class="node">
<title>l1_qkv_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2044" cy="-11609.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2044" y="-11628.38" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="2044" y="-11613.38" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2044" y="-11598.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2044" y="-11583.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu4&#45;&gt;l1_qkv_gpu4 -->
<g id="edge1221" class="edge">
<title>input_gpu4&#45;&gt;l1_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1674.57,-11723.49C1698.2,-11717.57 1723.36,-11711.87 1747,-11707.66 1828.81,-11693.11 1855.15,-11717.74 1933,-11688.66 1952.82,-11681.26 1972.4,-11669.44 1989.46,-11657.22"/>
<polygon fill="black" stroke="black" points="1991.65,-11659.95 1997.62,-11651.2 1987.5,-11654.32 1991.65,-11659.95"/>
</g>
<!-- input_gpu5 -->
<g id="node6" class="node">
<title>input_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="1921" cy="-11753.16" rx="165" ry="37.5"/>
<text text-anchor="middle" x="1921" y="-11764.46" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1921" y="-11749.46" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="1921" y="-11734.46" font-family="Times,serif" font-size="14.00">X[:, 5*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu5 -->
<g id="node278" class="node">
<title>l1_qkv_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2247" cy="-11609.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2247" y="-11628.38" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="2247" y="-11613.38" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2247" y="-11598.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2247" y="-11583.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu5&#45;&gt;l1_qkv_gpu5 -->
<g id="edge1222" class="edge">
<title>input_gpu5&#45;&gt;l1_qkv_gpu5</title>
<path fill="none" stroke="black" d="M2030.8,-11725.15C2076.7,-11713.02 2124.18,-11699.11 2145,-11688.66 2161.65,-11680.31 2178.3,-11669.1 2193.17,-11657.78"/>
<polygon fill="black" stroke="black" points="2195.49,-11660.4 2201.23,-11651.5 2191.19,-11654.88 2195.49,-11660.4"/>
</g>
<!-- input_gpu6 -->
<g id="node7" class="node">
<title>input_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2269" cy="-11753.16" rx="165" ry="37.5"/>
<text text-anchor="middle" x="2269" y="-11764.46" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="2269" y="-11749.46" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2269" y="-11734.46" font-family="Times,serif" font-size="14.00">X[:, 6*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu6 -->
<g id="node279" class="node">
<title>l1_qkv_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2450" cy="-11609.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2450" y="-11628.38" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="2450" y="-11613.38" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2450" y="-11598.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2450" y="-11583.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu6&#45;&gt;l1_qkv_gpu6 -->
<g id="edge1223" class="edge">
<title>input_gpu6&#45;&gt;l1_qkv_gpu6</title>
<path fill="none" stroke="black" d="M2314.21,-11716.8C2337.64,-11698.47 2366.53,-11675.87 2391.63,-11656.24"/>
<polygon fill="black" stroke="black" points="2393.91,-11658.9 2399.63,-11649.98 2389.6,-11653.38 2393.91,-11658.9"/>
</g>
<!-- input_gpu7 -->
<g id="node8" class="node">
<title>input_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2617" cy="-11753.16" rx="165" ry="37.5"/>
<text text-anchor="middle" x="2617" y="-11764.46" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="2617" y="-11749.46" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2617" y="-11734.46" font-family="Times,serif" font-size="14.00">X[:, 7*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu7 -->
<g id="node280" class="node">
<title>l1_qkv_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2655" cy="-11609.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2655" y="-11628.38" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="2655" y="-11613.38" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2655" y="-11598.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2655" y="-11583.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu7&#45;&gt;l1_qkv_gpu7 -->
<g id="edge1224" class="edge">
<title>input_gpu7&#45;&gt;l1_qkv_gpu7</title>
<path fill="none" stroke="black" d="M2626.79,-11715.7C2630.74,-11700.98 2635.39,-11683.64 2639.77,-11667.34"/>
<polygon fill="black" stroke="black" points="2643.23,-11667.92 2642.45,-11657.35 2636.47,-11666.1 2643.23,-11667.92"/>
</g>
<!-- input_gpu8 -->
<g id="node9" class="node">
<title>input_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2965" cy="-11753.16" rx="165" ry="37.5"/>
<text text-anchor="middle" x="2965" y="-11764.46" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="2965" y="-11749.46" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2965" y="-11734.46" font-family="Times,serif" font-size="14.00">X[:, 8*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu8 -->
<g id="node281" class="node">
<title>l1_qkv_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2858" cy="-11609.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2858" y="-11628.38" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="2858" y="-11613.38" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2858" y="-11598.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2858" y="-11583.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu8&#45;&gt;l1_qkv_gpu8 -->
<g id="edge1225" class="edge">
<title>input_gpu8&#45;&gt;l1_qkv_gpu8</title>
<path fill="none" stroke="black" d="M2937.72,-11716.07C2925.43,-11699.8 2910.68,-11680.28 2897.22,-11662.48"/>
<polygon fill="black" stroke="black" points="2899.97,-11660.31 2891.15,-11654.44 2894.39,-11664.53 2899.97,-11660.31"/>
</g>
<!-- input_gpu9 -->
<g id="node10" class="node">
<title>input_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3313" cy="-11753.16" rx="165" ry="37.5"/>
<text text-anchor="middle" x="3313" y="-11764.46" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="3313" y="-11749.46" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3313" y="-11734.46" font-family="Times,serif" font-size="14.00">X[:, 9*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu9 -->
<g id="node282" class="node">
<title>l1_qkv_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3060" cy="-11609.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3060" y="-11628.38" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="3060" y="-11613.38" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3060" y="-11598.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3060" y="-11583.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu9&#45;&gt;l1_qkv_gpu9 -->
<g id="edge1226" class="edge">
<title>input_gpu9&#45;&gt;l1_qkv_gpu9</title>
<path fill="none" stroke="black" d="M3227.48,-11721.05C3205.27,-11711.73 3181.76,-11700.75 3161,-11688.66 3145.47,-11679.63 3129.64,-11668.48 3115.26,-11657.47"/>
<polygon fill="black" stroke="black" points="3117.02,-11654.4 3106.98,-11651.02 3112.72,-11659.92 3117.02,-11654.4"/>
</g>
<!-- input_gpu10 -->
<g id="node11" class="node">
<title>input_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3667" cy="-11753.16" rx="171.03" ry="37.5"/>
<text text-anchor="middle" x="3667" y="-11764.46" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="3667" y="-11749.46" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3667" y="-11734.46" font-family="Times,serif" font-size="14.00">X[:, 10*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu10 -->
<g id="node283" class="node">
<title>l1_qkv_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3262" cy="-11609.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3262" y="-11628.38" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="3262" y="-11613.38" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3262" y="-11598.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3262" y="-11583.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu10&#45;&gt;l1_qkv_gpu10 -->
<g id="edge1227" class="edge">
<title>input_gpu10&#45;&gt;l1_qkv_gpu10</title>
<path fill="none" stroke="black" d="M3559.32,-11723.86C3535.59,-11718.1 3510.52,-11712.36 3487,-11707.66 3432.33,-11696.74 3414.24,-11710.64 3363,-11688.66 3345.64,-11681.22 3328.65,-11670.08 3313.7,-11658.53"/>
<polygon fill="black" stroke="black" points="3315.62,-11655.58 3305.61,-11652.09 3311.26,-11661.06 3315.62,-11655.58"/>
</g>
<!-- input_gpu11 -->
<g id="node12" class="node">
<title>input_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="4027" cy="-11753.16" rx="171.03" ry="37.5"/>
<text text-anchor="middle" x="4027" y="-11764.46" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="4027" y="-11749.46" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="4027" y="-11734.46" font-family="Times,serif" font-size="14.00">X[:, 11*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu11 -->
<g id="node284" class="node">
<title>l1_qkv_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3464" cy="-11609.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3464" y="-11628.38" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="3464" y="-11613.38" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3464" y="-11598.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3464" y="-11583.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu11&#45;&gt;l1_qkv_gpu11 -->
<g id="edge1228" class="edge">
<title>input_gpu11&#45;&gt;l1_qkv_gpu11</title>
<path fill="none" stroke="black" d="M3923.4,-11723.27C3898.55,-11717.25 3871.97,-11711.56 3847,-11707.66 3784.94,-11697.98 3623.72,-11710.95 3565,-11688.66 3547.17,-11681.9 3529.91,-11670.85 3514.85,-11659.18"/>
<polygon fill="black" stroke="black" points="3516.72,-11656.18 3506.73,-11652.65 3512.33,-11661.64 3516.72,-11656.18"/>
</g>
<!-- input_gpu12 -->
<g id="node13" class="node">
<title>input_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="4387" cy="-11753.16" rx="171.03" ry="37.5"/>
<text text-anchor="middle" x="4387" y="-11764.46" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="4387" y="-11749.46" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="4387" y="-11734.46" font-family="Times,serif" font-size="14.00">X[:, 12*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu12 -->
<g id="node285" class="node">
<title>l1_qkv_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3666" cy="-11609.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3666" y="-11628.38" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="3666" y="-11613.38" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3666" y="-11598.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3666" y="-11583.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu12&#45;&gt;l1_qkv_gpu12 -->
<g id="edge1229" class="edge">
<title>input_gpu12&#45;&gt;l1_qkv_gpu12</title>
<path fill="none" stroke="black" d="M4284.42,-11723.07C4259.29,-11716.98 4232.33,-11711.31 4207,-11707.66 4110.13,-11693.74 3858.91,-11722.28 3767,-11688.66 3748.91,-11682.05 3731.46,-11670.93 3716.31,-11659.12"/>
<polygon fill="black" stroke="black" points="3718.11,-11656.08 3708.13,-11652.51 3713.71,-11661.52 3718.11,-11656.08"/>
</g>
<!-- input_gpu13 -->
<g id="node14" class="node">
<title>input_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="4747" cy="-11753.16" rx="171.03" ry="37.5"/>
<text text-anchor="middle" x="4747" y="-11764.46" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="4747" y="-11749.46" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="4747" y="-11734.46" font-family="Times,serif" font-size="14.00">X[:, 13*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu13 -->
<g id="node286" class="node">
<title>l1_qkv_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3868" cy="-11609.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3868" y="-11628.38" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="3868" y="-11613.38" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3868" y="-11598.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3868" y="-11583.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu13&#45;&gt;l1_qkv_gpu13 -->
<g id="edge1230" class="edge">
<title>input_gpu13&#45;&gt;l1_qkv_gpu13</title>
<path fill="none" stroke="black" d="M4645.42,-11722.94C4620.01,-11716.78 4592.68,-11711.1 4567,-11707.66 4501.11,-11698.85 4031.34,-11711.76 3969,-11688.66 3950.94,-11681.97 3933.5,-11670.83 3918.34,-11659.02"/>
<polygon fill="black" stroke="black" points="3920.15,-11655.98 3910.17,-11652.42 3915.75,-11661.42 3920.15,-11655.98"/>
</g>
<!-- input_gpu14 -->
<g id="node15" class="node">
<title>input_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="5107" cy="-11753.16" rx="171.03" ry="37.5"/>
<text text-anchor="middle" x="5107" y="-11764.46" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="5107" y="-11749.46" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="5107" y="-11734.46" font-family="Times,serif" font-size="14.00">X[:, 14*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu14 -->
<g id="node287" class="node">
<title>l1_qkv_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4070" cy="-11609.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="4070" y="-11628.38" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="4070" y="-11613.38" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4070" y="-11598.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="4070" y="-11583.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu14&#45;&gt;l1_qkv_gpu14 -->
<g id="edge1231" class="edge">
<title>input_gpu14&#45;&gt;l1_qkv_gpu14</title>
<path fill="none" stroke="black" d="M5005.41,-11722.97C4980.01,-11716.8 4952.68,-11711.12 4927,-11707.66 4843.72,-11696.46 4250.17,-11716.81 4171,-11688.66 4152.85,-11682.21 4135.39,-11671.14 4120.23,-11659.33"/>
<polygon fill="black" stroke="black" points="4122.03,-11656.29 4112.06,-11652.72 4117.63,-11661.73 4122.03,-11656.29"/>
</g>
<!-- input_gpu15 -->
<g id="node16" class="node">
<title>input_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="5467" cy="-11753.16" rx="171.03" ry="37.5"/>
<text text-anchor="middle" x="5467" y="-11764.46" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="5467" y="-11749.46" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="5467" y="-11734.46" font-family="Times,serif" font-size="14.00">X[:, 15*L/16:(gpu_id+1)*L/16, :]</text>
</g>
<!-- l1_qkv_gpu15 -->
<g id="node288" class="node">
<title>l1_qkv_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4272" cy="-11609.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="4272" y="-11628.38" font-family="Times,serif" font-size="14.00">L1 QKV Proj</text>
<text text-anchor="middle" x="4272" y="-11613.38" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4272" y="-11598.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="4272" y="-11583.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- input_gpu15&#45;&gt;l1_qkv_gpu15 -->
<g id="edge1232" class="edge">
<title>input_gpu15&#45;&gt;l1_qkv_gpu15</title>
<path fill="none" stroke="black" d="M5361.9,-11723.43C5337.45,-11717.52 5311.43,-11711.83 5287,-11707.66 4955.6,-11651.17 4557.32,-11625.07 4373.76,-11615.36"/>
<polygon fill="black" stroke="black" points="4373.75,-11611.85 4363.58,-11614.82 4373.38,-11618.84 4373.75,-11611.85"/>
</g>
<!-- l1_attn_stage0_gpu0 -->
<g id="node17" class="node">
<title>l1_attn_stage0_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1343" cy="-11466" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1343" y="-11477.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="1343" y="-11462.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1343" y="-11447.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu0 -->
<g id="node33" class="node">
<title>l1_attn_stage1_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1343" cy="-11319" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1343" y="-11330.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="1343" y="-11315.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1343" y="-11300.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu0&#45;&gt;l1_attn_stage1_gpu0 -->
<g id="edge17" class="edge">
<title>l1_attn_stage0_gpu0&#45;&gt;l1_attn_stage1_gpu0</title>
<path fill="none" stroke="black" d="M1343,-11428.41C1343,-11409.69 1343,-11386.7 1343,-11366.71"/>
<polygon fill="black" stroke="black" points="1346.5,-11366.58 1343,-11356.58 1339.5,-11366.58 1346.5,-11366.58"/>
</g>
<!-- l1_attn_stage1_gpu[next_gpu] -->
<g id="node1313" class="node">
<title>l1_attn_stage1_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4530" cy="-11319" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4530" y="-11315.3" font-family="Times,serif" font-size="14.00">l1_attn_stage1_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage0_gpu0&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge1233" class="edge">
<title>l1_attn_stage0_gpu0&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1396.29,-11436C1410.43,-11429.66 1425.95,-11423.85 1441,-11420.5 1670.73,-11369.36 3323.66,-11398.05 3559,-11395.5 3603.94,-11395.01 4323.97,-11396.53 4368,-11387.5 4411.87,-11378.5 4458.77,-11357.58 4490.76,-11341.4"/>
<polygon fill="red" stroke="red" points="4492.49,-11344.44 4499.78,-11336.76 4489.28,-11338.22 4492.49,-11344.44"/>
<text text-anchor="middle" x="3590.5" y="-11399.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu1 -->
<g id="node18" class="node">
<title>l1_attn_stage0_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1538" cy="-11466" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1538" y="-11477.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="1538" y="-11462.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1538" y="-11447.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu1 -->
<g id="node34" class="node">
<title>l1_attn_stage1_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1538" cy="-11319" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1538" y="-11330.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="1538" y="-11315.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1538" y="-11300.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu1&#45;&gt;l1_attn_stage1_gpu1 -->
<g id="edge18" class="edge">
<title>l1_attn_stage0_gpu1&#45;&gt;l1_attn_stage1_gpu1</title>
<path fill="none" stroke="black" d="M1538,-11428.41C1538,-11409.69 1538,-11386.7 1538,-11366.71"/>
<polygon fill="black" stroke="black" points="1541.5,-11366.58 1538,-11356.58 1534.5,-11366.58 1541.5,-11366.58"/>
</g>
<!-- l1_attn_stage0_gpu1&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge1234" class="edge">
<title>l1_attn_stage0_gpu1&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1591.28,-11435.93C1605.41,-11429.59 1620.94,-11423.8 1636,-11420.5 1690,-11408.67 3573.82,-11428.76 3626,-11410.5 3636.15,-11406.94 3634.86,-11399.08 3645,-11395.5 3682.87,-11382.11 4328.66,-11395.59 4368,-11387.5 4411.87,-11378.47 4458.77,-11357.56 4490.76,-11341.38"/>
<polygon fill="red" stroke="red" points="4492.48,-11344.43 4499.78,-11336.75 4489.28,-11338.2 4492.48,-11344.43"/>
<text text-anchor="middle" x="3676.5" y="-11399.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu2 -->
<g id="node19" class="node">
<title>l1_attn_stage0_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1733" cy="-11466" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1733" y="-11477.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="1733" y="-11462.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1733" y="-11447.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu2 -->
<g id="node35" class="node">
<title>l1_attn_stage1_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1733" cy="-11319" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1733" y="-11330.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="1733" y="-11315.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1733" y="-11300.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu2&#45;&gt;l1_attn_stage1_gpu2 -->
<g id="edge19" class="edge">
<title>l1_attn_stage0_gpu2&#45;&gt;l1_attn_stage1_gpu2</title>
<path fill="none" stroke="black" d="M1733,-11428.41C1733,-11409.69 1733,-11386.7 1733,-11366.71"/>
<polygon fill="black" stroke="black" points="1736.5,-11366.58 1733,-11356.58 1729.5,-11366.58 1736.5,-11366.58"/>
</g>
<!-- l1_attn_stage0_gpu2&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge1235" class="edge">
<title>l1_attn_stage0_gpu2&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1786.28,-11435.93C1800.41,-11429.59 1815.94,-11423.8 1831,-11420.5 1882.04,-11409.31 3662.68,-11427.77 3712,-11410.5 3722.15,-11406.94 3720.86,-11399.09 3731,-11395.5 3764.36,-11383.68 4333.34,-11394.66 4368,-11387.5 4411.86,-11378.44 4458.76,-11357.53 4490.75,-11341.36"/>
<polygon fill="red" stroke="red" points="4492.48,-11344.41 4499.77,-11336.73 4489.28,-11338.19 4492.48,-11344.41"/>
<text text-anchor="middle" x="3762.5" y="-11399.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu3 -->
<g id="node20" class="node">
<title>l1_attn_stage0_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1928" cy="-11466" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1928" y="-11477.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="1928" y="-11462.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1928" y="-11447.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu3 -->
<g id="node36" class="node">
<title>l1_attn_stage1_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1928" cy="-11319" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1928" y="-11330.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="1928" y="-11315.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1928" y="-11300.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu3&#45;&gt;l1_attn_stage1_gpu3 -->
<g id="edge20" class="edge">
<title>l1_attn_stage0_gpu3&#45;&gt;l1_attn_stage1_gpu3</title>
<path fill="none" stroke="black" d="M1928,-11428.41C1928,-11409.69 1928,-11386.7 1928,-11366.71"/>
<polygon fill="black" stroke="black" points="1931.5,-11366.58 1928,-11356.58 1924.5,-11366.58 1931.5,-11366.58"/>
</g>
<!-- l1_attn_stage0_gpu3&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge1236" class="edge">
<title>l1_attn_stage0_gpu3&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1981.28,-11435.94C1995.41,-11429.6 2010.94,-11423.8 2026,-11420.5 2074.08,-11409.95 3751.55,-11426.77 3798,-11410.5 3808.15,-11406.94 3806.86,-11399.1 3817,-11395.5 3845.85,-11385.25 4338.02,-11393.72 4368,-11387.5 4411.85,-11378.4 4458.75,-11357.49 4490.75,-11341.34"/>
<polygon fill="red" stroke="red" points="4492.47,-11344.39 4499.77,-11336.71 4489.27,-11338.16 4492.47,-11344.39"/>
<text text-anchor="middle" x="3848.5" y="-11399.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu4 -->
<g id="node21" class="node">
<title>l1_attn_stage0_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2123" cy="-11466" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2123" y="-11477.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="2123" y="-11462.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2123" y="-11447.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu4 -->
<g id="node37" class="node">
<title>l1_attn_stage1_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2123" cy="-11319" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2123" y="-11330.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="2123" y="-11315.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2123" y="-11300.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu4&#45;&gt;l1_attn_stage1_gpu4 -->
<g id="edge21" class="edge">
<title>l1_attn_stage0_gpu4&#45;&gt;l1_attn_stage1_gpu4</title>
<path fill="none" stroke="black" d="M2123,-11428.41C2123,-11409.69 2123,-11386.7 2123,-11366.71"/>
<polygon fill="black" stroke="black" points="2126.5,-11366.58 2123,-11356.58 2119.5,-11366.58 2126.5,-11366.58"/>
</g>
<!-- l1_attn_stage0_gpu4&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge1237" class="edge">
<title>l1_attn_stage0_gpu4&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2176.28,-11435.94C2190.41,-11429.6 2205.94,-11423.8 2221,-11420.5 2266.12,-11410.59 3840.41,-11425.78 3884,-11410.5 3894.15,-11406.94 3892.87,-11399.11 3903,-11395.5 3951.67,-11378.13 4317.42,-11398.07 4368,-11387.5 4411.84,-11378.34 4458.74,-11357.44 4490.74,-11341.31"/>
<polygon fill="red" stroke="red" points="4492.46,-11344.36 4499.76,-11336.69 4489.27,-11338.13 4492.46,-11344.36"/>
<text text-anchor="middle" x="3934.5" y="-11399.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu5 -->
<g id="node22" class="node">
<title>l1_attn_stage0_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2318" cy="-11466" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2318" y="-11477.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="2318" y="-11462.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2318" y="-11447.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu5 -->
<g id="node38" class="node">
<title>l1_attn_stage1_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2318" cy="-11319" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2318" y="-11330.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="2318" y="-11315.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2318" y="-11300.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu5&#45;&gt;l1_attn_stage1_gpu5 -->
<g id="edge22" class="edge">
<title>l1_attn_stage0_gpu5&#45;&gt;l1_attn_stage1_gpu5</title>
<path fill="none" stroke="black" d="M2318,-11428.41C2318,-11409.69 2318,-11386.7 2318,-11366.71"/>
<polygon fill="black" stroke="black" points="2321.5,-11366.58 2318,-11356.58 2314.5,-11366.58 2321.5,-11366.58"/>
</g>
<!-- l1_attn_stage0_gpu5&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge1238" class="edge">
<title>l1_attn_stage0_gpu5&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2371.28,-11435.94C2385.41,-11429.6 2400.94,-11423.81 2416,-11420.5 2458.16,-11411.23 3929.27,-11424.79 3970,-11410.5 3980.15,-11406.94 3978.87,-11399.13 3989,-11395.5 4028.64,-11381.26 4326.79,-11396.19 4368,-11387.5 4411.82,-11378.25 4458.73,-11357.37 4490.73,-11341.26"/>
<polygon fill="red" stroke="red" points="4492.45,-11344.32 4499.75,-11336.65 4489.26,-11338.08 4492.45,-11344.32"/>
<text text-anchor="middle" x="4020.5" y="-11399.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu6 -->
<g id="node23" class="node">
<title>l1_attn_stage0_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2513" cy="-11466" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2513" y="-11477.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="2513" y="-11462.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2513" y="-11447.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu6 -->
<g id="node39" class="node">
<title>l1_attn_stage1_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2513" cy="-11319" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2513" y="-11330.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="2513" y="-11315.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2513" y="-11300.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu6&#45;&gt;l1_attn_stage1_gpu6 -->
<g id="edge23" class="edge">
<title>l1_attn_stage0_gpu6&#45;&gt;l1_attn_stage1_gpu6</title>
<path fill="none" stroke="black" d="M2513,-11428.41C2513,-11409.69 2513,-11386.7 2513,-11366.71"/>
<polygon fill="black" stroke="black" points="2516.5,-11366.58 2513,-11356.58 2509.5,-11366.58 2516.5,-11366.58"/>
</g>
<!-- l1_attn_stage0_gpu6&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge1239" class="edge">
<title>l1_attn_stage0_gpu6&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2566.28,-11435.95C2580.41,-11429.61 2595.94,-11423.81 2611,-11420.5 2650.2,-11411.87 4018.13,-11423.79 4056,-11410.5 4066.15,-11406.93 4064.89,-11399.16 4075,-11395.5 4105.62,-11384.4 4336.15,-11394.32 4368,-11387.5 4411.66,-11378.15 4458.41,-11357.38 4490.42,-11341.34"/>
<polygon fill="red" stroke="red" points="4492.12,-11344.4 4499.45,-11336.74 4488.95,-11338.16 4492.12,-11344.4"/>
<text text-anchor="middle" x="4106.5" y="-11399.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu7 -->
<g id="node24" class="node">
<title>l1_attn_stage0_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2708" cy="-11466" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2708" y="-11477.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="2708" y="-11462.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2708" y="-11447.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu7 -->
<g id="node40" class="node">
<title>l1_attn_stage1_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2708" cy="-11319" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2708" y="-11330.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="2708" y="-11315.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2708" y="-11300.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu7&#45;&gt;l1_attn_stage1_gpu7 -->
<g id="edge24" class="edge">
<title>l1_attn_stage0_gpu7&#45;&gt;l1_attn_stage1_gpu7</title>
<path fill="none" stroke="black" d="M2708,-11428.41C2708,-11409.69 2708,-11386.7 2708,-11366.71"/>
<polygon fill="black" stroke="black" points="2711.5,-11366.58 2708,-11356.58 2704.5,-11366.58 2711.5,-11366.58"/>
</g>
<!-- l1_attn_stage0_gpu7&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge1240" class="edge">
<title>l1_attn_stage0_gpu7&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2761.28,-11435.95C2775.42,-11429.62 2790.95,-11423.81 2806,-11420.5 2842.24,-11412.51 4106.99,-11422.8 4142,-11410.5 4152.15,-11406.93 4150.91,-11399.22 4161,-11395.5 4204.19,-11379.56 4323.04,-11397.4 4368,-11387.5 4411.6,-11377.9 4458.37,-11357.17 4490.39,-11341.2"/>
<polygon fill="red" stroke="red" points="4492.08,-11344.27 4499.42,-11336.63 4488.92,-11338.02 4492.08,-11344.27"/>
<text text-anchor="middle" x="4192.5" y="-11399.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu8 -->
<g id="node25" class="node">
<title>l1_attn_stage0_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2903" cy="-11466" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2903" y="-11477.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="2903" y="-11462.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2903" y="-11447.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu8 -->
<g id="node41" class="node">
<title>l1_attn_stage1_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2903" cy="-11319" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2903" y="-11330.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="2903" y="-11315.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2903" y="-11300.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu8&#45;&gt;l1_attn_stage1_gpu8 -->
<g id="edge25" class="edge">
<title>l1_attn_stage0_gpu8&#45;&gt;l1_attn_stage1_gpu8</title>
<path fill="none" stroke="black" d="M2903,-11428.41C2903,-11409.69 2903,-11386.7 2903,-11366.71"/>
<polygon fill="black" stroke="black" points="2906.5,-11366.58 2903,-11356.58 2899.5,-11366.58 2906.5,-11366.58"/>
</g>
<!-- l1_attn_stage0_gpu8&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge1241" class="edge">
<title>l1_attn_stage0_gpu8&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2956.28,-11435.96C2970.42,-11429.62 2985.95,-11423.82 3001,-11420.5 3067.57,-11405.81 4163.69,-11433.12 4228,-11410.5 4238.15,-11406.93 4236.96,-11399.36 4247,-11395.5 4297.3,-11376.15 4315.53,-11399.81 4368,-11387.5 4411.2,-11377.36 4457.67,-11356.92 4489.71,-11341.17"/>
<polygon fill="red" stroke="red" points="4491.38,-11344.25 4498.77,-11336.66 4488.25,-11337.99 4491.38,-11344.25"/>
<text text-anchor="middle" x="4278.5" y="-11399.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu9 -->
<g id="node26" class="node">
<title>l1_attn_stage0_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3098" cy="-11466" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3098" y="-11477.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="3098" y="-11462.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3098" y="-11447.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu9 -->
<g id="node42" class="node">
<title>l1_attn_stage1_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3098" cy="-11319" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3098" y="-11330.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="3098" y="-11315.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3098" y="-11300.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu9&#45;&gt;l1_attn_stage1_gpu9 -->
<g id="edge26" class="edge">
<title>l1_attn_stage0_gpu9&#45;&gt;l1_attn_stage1_gpu9</title>
<path fill="none" stroke="black" d="M3098,-11428.41C3098,-11409.69 3098,-11386.7 3098,-11366.71"/>
<polygon fill="black" stroke="black" points="3101.5,-11366.58 3098,-11356.58 3094.5,-11366.58 3101.5,-11366.58"/>
</g>
<!-- l1_attn_stage0_gpu9&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge1242" class="edge">
<title>l1_attn_stage0_gpu9&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3151.28,-11435.97C3165.42,-11429.63 3180.95,-11423.83 3196,-11420.5 3256.65,-11407.09 4255.41,-11431.13 4314,-11410.5 4324.15,-11406.92 4323.3,-11400.14 4333,-11395.5 4347.39,-11388.61 4352.8,-11392.36 4368,-11387.5 4408.94,-11374.4 4453.95,-11355.24 4486.12,-11340.67"/>
<polygon fill="red" stroke="red" points="4487.61,-11343.84 4495.25,-11336.51 4484.7,-11337.47 4487.61,-11343.84"/>
<text text-anchor="middle" x="4364.5" y="-11399.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu10 -->
<g id="node27" class="node">
<title>l1_attn_stage0_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3293" cy="-11466" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3293" y="-11477.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="3293" y="-11462.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3293" y="-11447.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu10 -->
<g id="node43" class="node">
<title>l1_attn_stage1_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3293" cy="-11319" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3293" y="-11330.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="3293" y="-11315.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3293" y="-11300.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu10&#45;&gt;l1_attn_stage1_gpu10 -->
<g id="edge27" class="edge">
<title>l1_attn_stage0_gpu10&#45;&gt;l1_attn_stage1_gpu10</title>
<path fill="none" stroke="black" d="M3293,-11428.41C3293,-11409.69 3293,-11386.7 3293,-11366.71"/>
<polygon fill="black" stroke="black" points="3296.5,-11366.58 3293,-11356.58 3289.5,-11366.58 3296.5,-11366.58"/>
</g>
<!-- l1_attn_stage0_gpu10&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge1243" class="edge">
<title>l1_attn_stage0_gpu10&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3346.29,-11435.98C3360.42,-11429.64 3375.95,-11423.83 3391,-11420.5 3445.73,-11408.37 4347.13,-11429.14 4400,-11410.5 4410.15,-11406.92 4410.32,-11401.86 4419,-11395.5 4444.22,-11377 4473.5,-11357.15 4495.65,-11342.45"/>
<polygon fill="red" stroke="red" points="4497.66,-11345.32 4504.07,-11336.88 4493.8,-11339.48 4497.66,-11345.32"/>
<text text-anchor="middle" x="4450.5" y="-11399.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu11 -->
<g id="node28" class="node">
<title>l1_attn_stage0_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3488" cy="-11466" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3488" y="-11477.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="3488" y="-11462.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3488" y="-11447.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu11 -->
<g id="node44" class="node">
<title>l1_attn_stage1_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3488" cy="-11319" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3488" y="-11330.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="3488" y="-11315.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3488" y="-11300.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu11&#45;&gt;l1_attn_stage1_gpu11 -->
<g id="edge28" class="edge">
<title>l1_attn_stage0_gpu11&#45;&gt;l1_attn_stage1_gpu11</title>
<path fill="none" stroke="black" d="M3488,-11428.41C3488,-11409.69 3488,-11386.7 3488,-11366.71"/>
<polygon fill="black" stroke="black" points="3491.5,-11366.58 3488,-11356.58 3484.5,-11366.58 3491.5,-11366.58"/>
</g>
<!-- l1_attn_stage0_gpu11&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge1244" class="edge">
<title>l1_attn_stage0_gpu11&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3541.29,-11435.99C3555.42,-11429.65 3570.95,-11423.84 3586,-11420.5 3610.41,-11415.07 4464.88,-11423.88 4486,-11410.5 4507.94,-11396.6 4519.24,-11368.32 4524.85,-11347.05"/>
<polygon fill="red" stroke="red" points="4528.27,-11347.81 4527.18,-11337.27 4521.46,-11346.19 4528.27,-11347.81"/>
<text text-anchor="middle" x="4532.5" y="-11399.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu12 -->
<g id="node29" class="node">
<title>l1_attn_stage0_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3683" cy="-11466" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3683" y="-11477.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="3683" y="-11462.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3683" y="-11447.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu12 -->
<g id="node45" class="node">
<title>l1_attn_stage1_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3683" cy="-11319" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3683" y="-11330.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="3683" y="-11315.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3683" y="-11300.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu12&#45;&gt;l1_attn_stage1_gpu12 -->
<g id="edge29" class="edge">
<title>l1_attn_stage0_gpu12&#45;&gt;l1_attn_stage1_gpu12</title>
<path fill="none" stroke="black" d="M3627.85,-11436.53C3614.43,-11430.5 3599.93,-11424.69 3586,-11420.5 3572.22,-11416.35 3531.36,-11421.43 3522,-11410.5 3487.08,-11369.7 3527.79,-11409.82 3586,-11387.5 3603.78,-11380.68 3621.42,-11369.93 3636.68,-11359"/>
<polygon fill="black" stroke="black" points="3638.93,-11361.69 3644.9,-11352.94 3634.77,-11356.06 3638.93,-11361.69"/>
</g>
<!-- l1_attn_stage0_gpu12&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge1245" class="edge">
<title>l1_attn_stage0_gpu12&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3736.29,-11436.01C3750.43,-11429.67 3765.95,-11423.85 3781,-11420.5 3802.45,-11415.71 4556.56,-11426.13 4572,-11410.5 4590.16,-11392.11 4572.89,-11364.42 4555.31,-11344.51"/>
<polygon fill="red" stroke="red" points="4557.75,-11341.99 4548.38,-11337.03 4552.61,-11346.75 4557.75,-11341.99"/>
<text text-anchor="middle" x="4610.5" y="-11399.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu13 -->
<g id="node30" class="node">
<title>l1_attn_stage0_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3878" cy="-11466" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3878" y="-11477.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="3878" y="-11462.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3878" y="-11447.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu13 -->
<g id="node46" class="node">
<title>l1_attn_stage1_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3878" cy="-11319" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3878" y="-11330.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="3878" y="-11315.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3878" y="-11300.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu13&#45;&gt;l1_attn_stage1_gpu13 -->
<g id="edge30" class="edge">
<title>l1_attn_stage0_gpu13&#45;&gt;l1_attn_stage1_gpu13</title>
<path fill="none" stroke="black" d="M3824.7,-11436.06C3810.85,-11429.8 3795.69,-11424.01 3781,-11420.5 3767.37,-11417.24 3538.71,-11420.6 3529,-11410.5 3524.38,-11405.69 3524.36,-11400.29 3529,-11395.5 3538.75,-11385.44 3767.7,-11391.9 3781,-11387.5 3799.4,-11381.4 3817.44,-11370.61 3832.87,-11359.42"/>
<polygon fill="black" stroke="black" points="3835.27,-11361.99 3841.16,-11353.19 3831.06,-11356.4 3835.27,-11361.99"/>
</g>
<!-- l1_attn_stage0_gpu13&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge1246" class="edge">
<title>l1_attn_stage0_gpu13&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3931.3,-11436.03C3945.43,-11429.69 3960.96,-11423.87 3976,-11420.5 3994.49,-11416.35 4644.7,-11423.99 4658,-11410.5 4686.36,-11381.72 4638.79,-11355.89 4593.82,-11339.26"/>
<polygon fill="red" stroke="red" points="4594.88,-11335.93 4584.29,-11335.86 4592.53,-11342.52 4594.88,-11335.93"/>
<text text-anchor="middle" x="4697.5" y="-11399.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu14 -->
<g id="node31" class="node">
<title>l1_attn_stage0_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4073" cy="-11466" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4073" y="-11477.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="4073" y="-11462.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4073" y="-11447.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu14 -->
<g id="node47" class="node">
<title>l1_attn_stage1_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4073" cy="-11319" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4073" y="-11330.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="4073" y="-11315.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4073" y="-11300.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu14&#45;&gt;l1_attn_stage1_gpu14 -->
<g id="edge31" class="edge">
<title>l1_attn_stage0_gpu14&#45;&gt;l1_attn_stage1_gpu14</title>
<path fill="none" stroke="black" d="M4019.74,-11435.88C4005.89,-11429.63 3990.71,-11423.89 3976,-11420.5 3952.17,-11415.01 3553.09,-11427.98 3536,-11410.5 3531.34,-11405.73 3531.33,-11400.25 3536,-11395.5 3544.56,-11386.78 3964.37,-11391.26 3976,-11387.5 3994.45,-11381.53 4012.49,-11370.77 4027.92,-11359.57"/>
<polygon fill="black" stroke="black" points="4030.32,-11362.14 4036.2,-11353.33 4026.11,-11356.54 4030.32,-11362.14"/>
</g>
<!-- l1_attn_stage0_gpu14&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge1247" class="edge">
<title>l1_attn_stage0_gpu14&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4126.3,-11436.06C4140.44,-11429.72 4155.96,-11423.89 4171,-11420.5 4186.53,-11417 4732.84,-11421.85 4744,-11410.5 4784.03,-11369.76 4714.32,-11346.4 4644.01,-11333.66"/>
<polygon fill="red" stroke="red" points="4644.55,-11330.2 4634.1,-11331.93 4643.35,-11337.1 4644.55,-11330.2"/>
<text text-anchor="middle" x="4784.5" y="-11399.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage0_gpu15 -->
<g id="node32" class="node">
<title>l1_attn_stage0_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4268" cy="-11466" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4268" y="-11477.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage0</text>
<text text-anchor="middle" x="4268" y="-11462.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4268" y="-11447.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu15 -->
<g id="node48" class="node">
<title>l1_attn_stage1_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4268" cy="-11319" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4268" y="-11330.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage1</text>
<text text-anchor="middle" x="4268" y="-11315.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4268" y="-11300.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage0_gpu15&#45;&gt;l1_attn_stage1_gpu15 -->
<g id="edge32" class="edge">
<title>l1_attn_stage0_gpu15&#45;&gt;l1_attn_stage1_gpu15</title>
<path fill="none" stroke="black" d="M4215.02,-11435.93C4201.09,-11429.63 4185.82,-11423.86 4171,-11420.5 4153.99,-11416.64 3555.24,-11422.93 3543,-11410.5 3538.32,-11405.75 3538.32,-11400.24 3543,-11395.5 3555.26,-11383.08 4154.39,-11392.83 4171,-11387.5 4189.46,-11381.58 4207.51,-11370.83 4222.94,-11359.63"/>
<polygon fill="black" stroke="black" points="4225.34,-11362.2 4231.22,-11353.38 4221.13,-11356.6 4225.34,-11362.2"/>
</g>
<!-- l1_attn_stage0_gpu15&#45;&gt;l1_attn_stage1_gpu[next_gpu] -->
<g id="edge1248" class="edge">
<title>l1_attn_stage0_gpu15&#45;&gt;l1_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4356.34,-11462.82C4506.61,-11458.19 4798.83,-11444.84 4830,-11410.5 4882.01,-11353.2 4783.61,-11331.64 4685.88,-11323.79"/>
<polygon fill="red" stroke="red" points="4686.06,-11320.29 4675.82,-11323.02 4685.53,-11327.27 4686.06,-11320.29"/>
<text text-anchor="middle" x="4869.5" y="-11399.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu0 -->
<g id="node49" class="node">
<title>l1_attn_stage2_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1343" cy="-11172" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1343" y="-11183.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="1343" y="-11168.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1343" y="-11153.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu0&#45;&gt;l1_attn_stage2_gpu0 -->
<g id="edge33" class="edge">
<title>l1_attn_stage1_gpu0&#45;&gt;l1_attn_stage2_gpu0</title>
<path fill="none" stroke="black" d="M1343,-11281.41C1343,-11262.69 1343,-11239.7 1343,-11219.71"/>
<polygon fill="black" stroke="black" points="1346.5,-11219.58 1343,-11209.58 1339.5,-11219.58 1346.5,-11219.58"/>
</g>
<!-- l1_attn_stage2_gpu[next_gpu] -->
<g id="node1314" class="node">
<title>l1_attn_stage2_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4530" cy="-11172" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4530" y="-11168.3" font-family="Times,serif" font-size="14.00">l1_attn_stage2_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage1_gpu0&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge1249" class="edge">
<title>l1_attn_stage1_gpu0&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1396.29,-11289C1410.43,-11282.66 1425.95,-11276.85 1441,-11273.5 1670.73,-11222.36 3323.66,-11251.05 3559,-11248.5 3603.94,-11248.01 4323.97,-11249.53 4368,-11240.5 4411.87,-11231.5 4458.77,-11210.58 4490.76,-11194.4"/>
<polygon fill="red" stroke="red" points="4492.49,-11197.44 4499.78,-11189.76 4489.28,-11191.22 4492.49,-11197.44"/>
<text text-anchor="middle" x="3590.5" y="-11252.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu1 -->
<g id="node50" class="node">
<title>l1_attn_stage2_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1538" cy="-11172" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1538" y="-11183.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="1538" y="-11168.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1538" y="-11153.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu1&#45;&gt;l1_attn_stage2_gpu1 -->
<g id="edge34" class="edge">
<title>l1_attn_stage1_gpu1&#45;&gt;l1_attn_stage2_gpu1</title>
<path fill="none" stroke="black" d="M1538,-11281.41C1538,-11262.69 1538,-11239.7 1538,-11219.71"/>
<polygon fill="black" stroke="black" points="1541.5,-11219.58 1538,-11209.58 1534.5,-11219.58 1541.5,-11219.58"/>
</g>
<!-- l1_attn_stage1_gpu1&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge1250" class="edge">
<title>l1_attn_stage1_gpu1&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1591.28,-11288.93C1605.41,-11282.59 1620.94,-11276.8 1636,-11273.5 1690,-11261.67 3573.82,-11281.76 3626,-11263.5 3636.15,-11259.94 3634.86,-11252.08 3645,-11248.5 3682.87,-11235.11 4328.66,-11248.59 4368,-11240.5 4411.87,-11231.47 4458.77,-11210.56 4490.76,-11194.38"/>
<polygon fill="red" stroke="red" points="4492.48,-11197.43 4499.78,-11189.75 4489.28,-11191.2 4492.48,-11197.43"/>
<text text-anchor="middle" x="3676.5" y="-11252.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu2 -->
<g id="node51" class="node">
<title>l1_attn_stage2_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1733" cy="-11172" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1733" y="-11183.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="1733" y="-11168.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1733" y="-11153.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu2&#45;&gt;l1_attn_stage2_gpu2 -->
<g id="edge35" class="edge">
<title>l1_attn_stage1_gpu2&#45;&gt;l1_attn_stage2_gpu2</title>
<path fill="none" stroke="black" d="M1733,-11281.41C1733,-11262.69 1733,-11239.7 1733,-11219.71"/>
<polygon fill="black" stroke="black" points="1736.5,-11219.58 1733,-11209.58 1729.5,-11219.58 1736.5,-11219.58"/>
</g>
<!-- l1_attn_stage1_gpu2&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge1251" class="edge">
<title>l1_attn_stage1_gpu2&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1786.28,-11288.93C1800.41,-11282.59 1815.94,-11276.8 1831,-11273.5 1882.04,-11262.31 3662.68,-11280.77 3712,-11263.5 3722.15,-11259.94 3720.86,-11252.09 3731,-11248.5 3764.36,-11236.68 4333.34,-11247.66 4368,-11240.5 4411.86,-11231.44 4458.76,-11210.53 4490.75,-11194.36"/>
<polygon fill="red" stroke="red" points="4492.48,-11197.41 4499.77,-11189.73 4489.28,-11191.19 4492.48,-11197.41"/>
<text text-anchor="middle" x="3762.5" y="-11252.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu3 -->
<g id="node52" class="node">
<title>l1_attn_stage2_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1928" cy="-11172" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1928" y="-11183.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="1928" y="-11168.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1928" y="-11153.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu3&#45;&gt;l1_attn_stage2_gpu3 -->
<g id="edge36" class="edge">
<title>l1_attn_stage1_gpu3&#45;&gt;l1_attn_stage2_gpu3</title>
<path fill="none" stroke="black" d="M1928,-11281.41C1928,-11262.69 1928,-11239.7 1928,-11219.71"/>
<polygon fill="black" stroke="black" points="1931.5,-11219.58 1928,-11209.58 1924.5,-11219.58 1931.5,-11219.58"/>
</g>
<!-- l1_attn_stage1_gpu3&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge1252" class="edge">
<title>l1_attn_stage1_gpu3&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1981.28,-11288.94C1995.41,-11282.6 2010.94,-11276.8 2026,-11273.5 2074.08,-11262.95 3751.55,-11279.77 3798,-11263.5 3808.15,-11259.94 3806.86,-11252.1 3817,-11248.5 3845.85,-11238.25 4338.02,-11246.72 4368,-11240.5 4411.85,-11231.4 4458.75,-11210.49 4490.75,-11194.34"/>
<polygon fill="red" stroke="red" points="4492.47,-11197.39 4499.77,-11189.71 4489.27,-11191.16 4492.47,-11197.39"/>
<text text-anchor="middle" x="3848.5" y="-11252.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu4 -->
<g id="node53" class="node">
<title>l1_attn_stage2_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2123" cy="-11172" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2123" y="-11183.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="2123" y="-11168.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2123" y="-11153.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu4&#45;&gt;l1_attn_stage2_gpu4 -->
<g id="edge37" class="edge">
<title>l1_attn_stage1_gpu4&#45;&gt;l1_attn_stage2_gpu4</title>
<path fill="none" stroke="black" d="M2123,-11281.41C2123,-11262.69 2123,-11239.7 2123,-11219.71"/>
<polygon fill="black" stroke="black" points="2126.5,-11219.58 2123,-11209.58 2119.5,-11219.58 2126.5,-11219.58"/>
</g>
<!-- l1_attn_stage1_gpu4&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge1253" class="edge">
<title>l1_attn_stage1_gpu4&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2176.28,-11288.94C2190.41,-11282.6 2205.94,-11276.8 2221,-11273.5 2266.12,-11263.59 3840.41,-11278.78 3884,-11263.5 3894.15,-11259.94 3892.87,-11252.11 3903,-11248.5 3951.67,-11231.13 4317.42,-11251.07 4368,-11240.5 4411.84,-11231.34 4458.74,-11210.44 4490.74,-11194.31"/>
<polygon fill="red" stroke="red" points="4492.46,-11197.36 4499.76,-11189.69 4489.27,-11191.13 4492.46,-11197.36"/>
<text text-anchor="middle" x="3934.5" y="-11252.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu5 -->
<g id="node54" class="node">
<title>l1_attn_stage2_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2318" cy="-11172" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2318" y="-11183.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="2318" y="-11168.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2318" y="-11153.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu5&#45;&gt;l1_attn_stage2_gpu5 -->
<g id="edge38" class="edge">
<title>l1_attn_stage1_gpu5&#45;&gt;l1_attn_stage2_gpu5</title>
<path fill="none" stroke="black" d="M2318,-11281.41C2318,-11262.69 2318,-11239.7 2318,-11219.71"/>
<polygon fill="black" stroke="black" points="2321.5,-11219.58 2318,-11209.58 2314.5,-11219.58 2321.5,-11219.58"/>
</g>
<!-- l1_attn_stage1_gpu5&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge1254" class="edge">
<title>l1_attn_stage1_gpu5&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2371.28,-11288.94C2385.41,-11282.6 2400.94,-11276.81 2416,-11273.5 2458.16,-11264.23 3929.27,-11277.79 3970,-11263.5 3980.15,-11259.94 3978.87,-11252.13 3989,-11248.5 4028.64,-11234.26 4326.79,-11249.19 4368,-11240.5 4411.82,-11231.25 4458.73,-11210.37 4490.73,-11194.26"/>
<polygon fill="red" stroke="red" points="4492.45,-11197.32 4499.75,-11189.65 4489.26,-11191.08 4492.45,-11197.32"/>
<text text-anchor="middle" x="4020.5" y="-11252.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu6 -->
<g id="node55" class="node">
<title>l1_attn_stage2_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2513" cy="-11172" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2513" y="-11183.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="2513" y="-11168.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2513" y="-11153.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu6&#45;&gt;l1_attn_stage2_gpu6 -->
<g id="edge39" class="edge">
<title>l1_attn_stage1_gpu6&#45;&gt;l1_attn_stage2_gpu6</title>
<path fill="none" stroke="black" d="M2513,-11281.41C2513,-11262.69 2513,-11239.7 2513,-11219.71"/>
<polygon fill="black" stroke="black" points="2516.5,-11219.58 2513,-11209.58 2509.5,-11219.58 2516.5,-11219.58"/>
</g>
<!-- l1_attn_stage1_gpu6&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge1255" class="edge">
<title>l1_attn_stage1_gpu6&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2566.28,-11288.95C2580.41,-11282.61 2595.94,-11276.81 2611,-11273.5 2650.2,-11264.87 4018.13,-11276.79 4056,-11263.5 4066.15,-11259.93 4064.89,-11252.16 4075,-11248.5 4105.62,-11237.4 4336.15,-11247.32 4368,-11240.5 4411.66,-11231.15 4458.41,-11210.38 4490.42,-11194.34"/>
<polygon fill="red" stroke="red" points="4492.12,-11197.4 4499.45,-11189.74 4488.95,-11191.16 4492.12,-11197.4"/>
<text text-anchor="middle" x="4106.5" y="-11252.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu7 -->
<g id="node56" class="node">
<title>l1_attn_stage2_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2708" cy="-11172" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2708" y="-11183.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="2708" y="-11168.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2708" y="-11153.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu7&#45;&gt;l1_attn_stage2_gpu7 -->
<g id="edge40" class="edge">
<title>l1_attn_stage1_gpu7&#45;&gt;l1_attn_stage2_gpu7</title>
<path fill="none" stroke="black" d="M2708,-11281.41C2708,-11262.69 2708,-11239.7 2708,-11219.71"/>
<polygon fill="black" stroke="black" points="2711.5,-11219.58 2708,-11209.58 2704.5,-11219.58 2711.5,-11219.58"/>
</g>
<!-- l1_attn_stage1_gpu7&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge1256" class="edge">
<title>l1_attn_stage1_gpu7&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2761.28,-11288.95C2775.42,-11282.62 2790.95,-11276.81 2806,-11273.5 2842.24,-11265.51 4106.99,-11275.8 4142,-11263.5 4152.15,-11259.93 4150.91,-11252.22 4161,-11248.5 4204.19,-11232.56 4323.04,-11250.4 4368,-11240.5 4411.6,-11230.9 4458.37,-11210.17 4490.39,-11194.2"/>
<polygon fill="red" stroke="red" points="4492.08,-11197.27 4499.42,-11189.63 4488.92,-11191.02 4492.08,-11197.27"/>
<text text-anchor="middle" x="4192.5" y="-11252.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu8 -->
<g id="node57" class="node">
<title>l1_attn_stage2_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2903" cy="-11172" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2903" y="-11183.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="2903" y="-11168.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2903" y="-11153.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu8&#45;&gt;l1_attn_stage2_gpu8 -->
<g id="edge41" class="edge">
<title>l1_attn_stage1_gpu8&#45;&gt;l1_attn_stage2_gpu8</title>
<path fill="none" stroke="black" d="M2903,-11281.41C2903,-11262.69 2903,-11239.7 2903,-11219.71"/>
<polygon fill="black" stroke="black" points="2906.5,-11219.58 2903,-11209.58 2899.5,-11219.58 2906.5,-11219.58"/>
</g>
<!-- l1_attn_stage1_gpu8&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge1257" class="edge">
<title>l1_attn_stage1_gpu8&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2956.28,-11288.96C2970.42,-11282.62 2985.95,-11276.82 3001,-11273.5 3067.57,-11258.81 4163.69,-11286.12 4228,-11263.5 4238.15,-11259.93 4236.96,-11252.36 4247,-11248.5 4297.3,-11229.15 4315.53,-11252.81 4368,-11240.5 4411.2,-11230.36 4457.67,-11209.92 4489.71,-11194.17"/>
<polygon fill="red" stroke="red" points="4491.38,-11197.25 4498.77,-11189.66 4488.25,-11190.99 4491.38,-11197.25"/>
<text text-anchor="middle" x="4278.5" y="-11252.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu9 -->
<g id="node58" class="node">
<title>l1_attn_stage2_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3098" cy="-11172" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3098" y="-11183.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="3098" y="-11168.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3098" y="-11153.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu9&#45;&gt;l1_attn_stage2_gpu9 -->
<g id="edge42" class="edge">
<title>l1_attn_stage1_gpu9&#45;&gt;l1_attn_stage2_gpu9</title>
<path fill="none" stroke="black" d="M3098,-11281.41C3098,-11262.69 3098,-11239.7 3098,-11219.71"/>
<polygon fill="black" stroke="black" points="3101.5,-11219.58 3098,-11209.58 3094.5,-11219.58 3101.5,-11219.58"/>
</g>
<!-- l1_attn_stage1_gpu9&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge1258" class="edge">
<title>l1_attn_stage1_gpu9&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3151.28,-11288.97C3165.42,-11282.63 3180.95,-11276.83 3196,-11273.5 3256.65,-11260.09 4255.41,-11284.13 4314,-11263.5 4324.15,-11259.92 4323.3,-11253.14 4333,-11248.5 4347.39,-11241.61 4352.8,-11245.36 4368,-11240.5 4408.94,-11227.4 4453.95,-11208.24 4486.12,-11193.67"/>
<polygon fill="red" stroke="red" points="4487.61,-11196.84 4495.25,-11189.51 4484.7,-11190.47 4487.61,-11196.84"/>
<text text-anchor="middle" x="4364.5" y="-11252.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu10 -->
<g id="node59" class="node">
<title>l1_attn_stage2_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3293" cy="-11172" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3293" y="-11183.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="3293" y="-11168.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3293" y="-11153.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu10&#45;&gt;l1_attn_stage2_gpu10 -->
<g id="edge43" class="edge">
<title>l1_attn_stage1_gpu10&#45;&gt;l1_attn_stage2_gpu10</title>
<path fill="none" stroke="black" d="M3293,-11281.41C3293,-11262.69 3293,-11239.7 3293,-11219.71"/>
<polygon fill="black" stroke="black" points="3296.5,-11219.58 3293,-11209.58 3289.5,-11219.58 3296.5,-11219.58"/>
</g>
<!-- l1_attn_stage1_gpu10&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge1259" class="edge">
<title>l1_attn_stage1_gpu10&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3346.29,-11288.98C3360.42,-11282.64 3375.95,-11276.83 3391,-11273.5 3445.73,-11261.37 4347.13,-11282.14 4400,-11263.5 4410.15,-11259.92 4410.32,-11254.86 4419,-11248.5 4444.22,-11230 4473.5,-11210.15 4495.65,-11195.45"/>
<polygon fill="red" stroke="red" points="4497.66,-11198.32 4504.07,-11189.88 4493.8,-11192.48 4497.66,-11198.32"/>
<text text-anchor="middle" x="4450.5" y="-11252.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu11 -->
<g id="node60" class="node">
<title>l1_attn_stage2_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3488" cy="-11172" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3488" y="-11183.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="3488" y="-11168.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3488" y="-11153.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu11&#45;&gt;l1_attn_stage2_gpu11 -->
<g id="edge44" class="edge">
<title>l1_attn_stage1_gpu11&#45;&gt;l1_attn_stage2_gpu11</title>
<path fill="none" stroke="black" d="M3488,-11281.41C3488,-11262.69 3488,-11239.7 3488,-11219.71"/>
<polygon fill="black" stroke="black" points="3491.5,-11219.58 3488,-11209.58 3484.5,-11219.58 3491.5,-11219.58"/>
</g>
<!-- l1_attn_stage1_gpu11&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge1260" class="edge">
<title>l1_attn_stage1_gpu11&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3541.29,-11288.99C3555.42,-11282.65 3570.95,-11276.84 3586,-11273.5 3610.41,-11268.07 4464.88,-11276.88 4486,-11263.5 4507.94,-11249.6 4519.24,-11221.32 4524.85,-11200.05"/>
<polygon fill="red" stroke="red" points="4528.27,-11200.81 4527.18,-11190.27 4521.46,-11199.19 4528.27,-11200.81"/>
<text text-anchor="middle" x="4532.5" y="-11252.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu12 -->
<g id="node61" class="node">
<title>l1_attn_stage2_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3683" cy="-11172" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3683" y="-11183.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="3683" y="-11168.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3683" y="-11153.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu12&#45;&gt;l1_attn_stage2_gpu12 -->
<g id="edge45" class="edge">
<title>l1_attn_stage1_gpu12&#45;&gt;l1_attn_stage2_gpu12</title>
<path fill="none" stroke="black" d="M3627.85,-11289.53C3614.43,-11283.5 3599.93,-11277.69 3586,-11273.5 3572.22,-11269.35 3531.36,-11274.43 3522,-11263.5 3487.08,-11222.7 3527.79,-11262.82 3586,-11240.5 3603.78,-11233.68 3621.42,-11222.93 3636.68,-11212"/>
<polygon fill="black" stroke="black" points="3638.93,-11214.69 3644.9,-11205.94 3634.77,-11209.06 3638.93,-11214.69"/>
</g>
<!-- l1_attn_stage1_gpu12&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge1261" class="edge">
<title>l1_attn_stage1_gpu12&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3736.29,-11289.01C3750.43,-11282.67 3765.95,-11276.85 3781,-11273.5 3802.45,-11268.71 4556.56,-11279.13 4572,-11263.5 4590.16,-11245.11 4572.89,-11217.42 4555.31,-11197.51"/>
<polygon fill="red" stroke="red" points="4557.75,-11194.99 4548.38,-11190.03 4552.61,-11199.75 4557.75,-11194.99"/>
<text text-anchor="middle" x="4610.5" y="-11252.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu13 -->
<g id="node62" class="node">
<title>l1_attn_stage2_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3878" cy="-11172" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3878" y="-11183.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="3878" y="-11168.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3878" y="-11153.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu13&#45;&gt;l1_attn_stage2_gpu13 -->
<g id="edge46" class="edge">
<title>l1_attn_stage1_gpu13&#45;&gt;l1_attn_stage2_gpu13</title>
<path fill="none" stroke="black" d="M3824.7,-11289.06C3810.85,-11282.8 3795.69,-11277.01 3781,-11273.5 3767.37,-11270.24 3538.71,-11273.6 3529,-11263.5 3524.38,-11258.69 3524.36,-11253.29 3529,-11248.5 3538.75,-11238.44 3767.7,-11244.9 3781,-11240.5 3799.4,-11234.4 3817.44,-11223.61 3832.87,-11212.42"/>
<polygon fill="black" stroke="black" points="3835.27,-11214.99 3841.16,-11206.19 3831.06,-11209.4 3835.27,-11214.99"/>
</g>
<!-- l1_attn_stage1_gpu13&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge1262" class="edge">
<title>l1_attn_stage1_gpu13&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3931.3,-11289.03C3945.43,-11282.69 3960.96,-11276.87 3976,-11273.5 3994.49,-11269.35 4644.7,-11276.99 4658,-11263.5 4686.36,-11234.72 4638.79,-11208.89 4593.82,-11192.26"/>
<polygon fill="red" stroke="red" points="4594.88,-11188.93 4584.29,-11188.86 4592.53,-11195.52 4594.88,-11188.93"/>
<text text-anchor="middle" x="4697.5" y="-11252.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu14 -->
<g id="node63" class="node">
<title>l1_attn_stage2_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4073" cy="-11172" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4073" y="-11183.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="4073" y="-11168.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4073" y="-11153.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu14&#45;&gt;l1_attn_stage2_gpu14 -->
<g id="edge47" class="edge">
<title>l1_attn_stage1_gpu14&#45;&gt;l1_attn_stage2_gpu14</title>
<path fill="none" stroke="black" d="M4019.74,-11288.88C4005.89,-11282.63 3990.71,-11276.89 3976,-11273.5 3952.17,-11268.01 3553.09,-11280.98 3536,-11263.5 3531.34,-11258.73 3531.33,-11253.25 3536,-11248.5 3544.56,-11239.78 3964.37,-11244.26 3976,-11240.5 3994.45,-11234.53 4012.49,-11223.77 4027.92,-11212.57"/>
<polygon fill="black" stroke="black" points="4030.32,-11215.14 4036.2,-11206.33 4026.11,-11209.54 4030.32,-11215.14"/>
</g>
<!-- l1_attn_stage1_gpu14&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge1263" class="edge">
<title>l1_attn_stage1_gpu14&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4126.3,-11289.06C4140.44,-11282.72 4155.96,-11276.89 4171,-11273.5 4186.53,-11270 4732.84,-11274.85 4744,-11263.5 4784.03,-11222.76 4714.32,-11199.4 4644.01,-11186.66"/>
<polygon fill="red" stroke="red" points="4644.55,-11183.2 4634.1,-11184.93 4643.35,-11190.1 4644.55,-11183.2"/>
<text text-anchor="middle" x="4784.5" y="-11252.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage2_gpu15 -->
<g id="node64" class="node">
<title>l1_attn_stage2_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4268" cy="-11172" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4268" y="-11183.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage2</text>
<text text-anchor="middle" x="4268" y="-11168.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4268" y="-11153.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage1_gpu15&#45;&gt;l1_attn_stage2_gpu15 -->
<g id="edge48" class="edge">
<title>l1_attn_stage1_gpu15&#45;&gt;l1_attn_stage2_gpu15</title>
<path fill="none" stroke="black" d="M4215.02,-11288.93C4201.09,-11282.63 4185.82,-11276.86 4171,-11273.5 4153.99,-11269.64 3555.24,-11275.93 3543,-11263.5 3538.32,-11258.75 3538.32,-11253.24 3543,-11248.5 3555.26,-11236.08 4154.39,-11245.83 4171,-11240.5 4189.46,-11234.58 4207.51,-11223.83 4222.94,-11212.63"/>
<polygon fill="black" stroke="black" points="4225.34,-11215.2 4231.22,-11206.38 4221.13,-11209.6 4225.34,-11215.2"/>
</g>
<!-- l1_attn_stage1_gpu15&#45;&gt;l1_attn_stage2_gpu[next_gpu] -->
<g id="edge1264" class="edge">
<title>l1_attn_stage1_gpu15&#45;&gt;l1_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4323.38,-11289.68C4338.74,-11283.12 4355.68,-11277.03 4372,-11273.5 4396.87,-11268.12 4812.2,-11281.69 4830,-11263.5 4884.67,-11207.62 4783.45,-11185.96 4684.12,-11177.71"/>
<polygon fill="red" stroke="red" points="4684.15,-11174.2 4673.9,-11176.9 4683.6,-11181.18 4684.15,-11174.2"/>
<text text-anchor="middle" x="4870.5" y="-11252.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu0 -->
<g id="node65" class="node">
<title>l1_attn_stage3_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1343" cy="-11025" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1343" y="-11036.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="1343" y="-11021.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1343" y="-11006.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu0&#45;&gt;l1_attn_stage3_gpu0 -->
<g id="edge49" class="edge">
<title>l1_attn_stage2_gpu0&#45;&gt;l1_attn_stage3_gpu0</title>
<path fill="none" stroke="black" d="M1343,-11134.41C1343,-11115.69 1343,-11092.7 1343,-11072.71"/>
<polygon fill="black" stroke="black" points="1346.5,-11072.58 1343,-11062.58 1339.5,-11072.58 1346.5,-11072.58"/>
</g>
<!-- l1_attn_stage3_gpu[next_gpu] -->
<g id="node1315" class="node">
<title>l1_attn_stage3_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4530" cy="-11025" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4530" y="-11021.3" font-family="Times,serif" font-size="14.00">l1_attn_stage3_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage2_gpu0&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge1265" class="edge">
<title>l1_attn_stage2_gpu0&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1396.29,-11142C1410.43,-11135.66 1425.95,-11129.85 1441,-11126.5 1670.73,-11075.36 3323.66,-11104.05 3559,-11101.5 3603.94,-11101.01 4323.97,-11102.53 4368,-11093.5 4411.87,-11084.5 4458.77,-11063.58 4490.76,-11047.4"/>
<polygon fill="red" stroke="red" points="4492.49,-11050.44 4499.78,-11042.76 4489.28,-11044.22 4492.49,-11050.44"/>
<text text-anchor="middle" x="3590.5" y="-11105.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu1 -->
<g id="node66" class="node">
<title>l1_attn_stage3_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1538" cy="-11025" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1538" y="-11036.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="1538" y="-11021.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1538" y="-11006.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu1&#45;&gt;l1_attn_stage3_gpu1 -->
<g id="edge50" class="edge">
<title>l1_attn_stage2_gpu1&#45;&gt;l1_attn_stage3_gpu1</title>
<path fill="none" stroke="black" d="M1538,-11134.41C1538,-11115.69 1538,-11092.7 1538,-11072.71"/>
<polygon fill="black" stroke="black" points="1541.5,-11072.58 1538,-11062.58 1534.5,-11072.58 1541.5,-11072.58"/>
</g>
<!-- l1_attn_stage2_gpu1&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge1266" class="edge">
<title>l1_attn_stage2_gpu1&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1591.28,-11141.93C1605.41,-11135.59 1620.94,-11129.8 1636,-11126.5 1690,-11114.67 3573.82,-11134.76 3626,-11116.5 3636.15,-11112.94 3634.86,-11105.08 3645,-11101.5 3682.87,-11088.11 4328.66,-11101.59 4368,-11093.5 4411.87,-11084.47 4458.77,-11063.56 4490.76,-11047.38"/>
<polygon fill="red" stroke="red" points="4492.48,-11050.43 4499.78,-11042.75 4489.28,-11044.2 4492.48,-11050.43"/>
<text text-anchor="middle" x="3676.5" y="-11105.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu2 -->
<g id="node67" class="node">
<title>l1_attn_stage3_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1733" cy="-11025" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1733" y="-11036.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="1733" y="-11021.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1733" y="-11006.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu2&#45;&gt;l1_attn_stage3_gpu2 -->
<g id="edge51" class="edge">
<title>l1_attn_stage2_gpu2&#45;&gt;l1_attn_stage3_gpu2</title>
<path fill="none" stroke="black" d="M1733,-11134.41C1733,-11115.69 1733,-11092.7 1733,-11072.71"/>
<polygon fill="black" stroke="black" points="1736.5,-11072.58 1733,-11062.58 1729.5,-11072.58 1736.5,-11072.58"/>
</g>
<!-- l1_attn_stage2_gpu2&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge1267" class="edge">
<title>l1_attn_stage2_gpu2&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1786.28,-11141.93C1800.41,-11135.59 1815.94,-11129.8 1831,-11126.5 1882.04,-11115.31 3662.68,-11133.77 3712,-11116.5 3722.15,-11112.94 3720.86,-11105.09 3731,-11101.5 3764.36,-11089.68 4333.34,-11100.66 4368,-11093.5 4411.86,-11084.44 4458.76,-11063.53 4490.75,-11047.36"/>
<polygon fill="red" stroke="red" points="4492.48,-11050.41 4499.77,-11042.73 4489.28,-11044.19 4492.48,-11050.41"/>
<text text-anchor="middle" x="3762.5" y="-11105.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu3 -->
<g id="node68" class="node">
<title>l1_attn_stage3_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1928" cy="-11025" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1928" y="-11036.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="1928" y="-11021.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1928" y="-11006.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu3&#45;&gt;l1_attn_stage3_gpu3 -->
<g id="edge52" class="edge">
<title>l1_attn_stage2_gpu3&#45;&gt;l1_attn_stage3_gpu3</title>
<path fill="none" stroke="black" d="M1928,-11134.41C1928,-11115.69 1928,-11092.7 1928,-11072.71"/>
<polygon fill="black" stroke="black" points="1931.5,-11072.58 1928,-11062.58 1924.5,-11072.58 1931.5,-11072.58"/>
</g>
<!-- l1_attn_stage2_gpu3&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge1268" class="edge">
<title>l1_attn_stage2_gpu3&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1981.28,-11141.94C1995.41,-11135.6 2010.94,-11129.8 2026,-11126.5 2074.08,-11115.95 3751.55,-11132.77 3798,-11116.5 3808.15,-11112.94 3806.86,-11105.1 3817,-11101.5 3845.85,-11091.25 4338.02,-11099.72 4368,-11093.5 4411.85,-11084.4 4458.75,-11063.49 4490.75,-11047.34"/>
<polygon fill="red" stroke="red" points="4492.47,-11050.39 4499.77,-11042.71 4489.27,-11044.16 4492.47,-11050.39"/>
<text text-anchor="middle" x="3848.5" y="-11105.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu4 -->
<g id="node69" class="node">
<title>l1_attn_stage3_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2123" cy="-11025" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2123" y="-11036.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="2123" y="-11021.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2123" y="-11006.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu4&#45;&gt;l1_attn_stage3_gpu4 -->
<g id="edge53" class="edge">
<title>l1_attn_stage2_gpu4&#45;&gt;l1_attn_stage3_gpu4</title>
<path fill="none" stroke="black" d="M2123,-11134.41C2123,-11115.69 2123,-11092.7 2123,-11072.71"/>
<polygon fill="black" stroke="black" points="2126.5,-11072.58 2123,-11062.58 2119.5,-11072.58 2126.5,-11072.58"/>
</g>
<!-- l1_attn_stage2_gpu4&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge1269" class="edge">
<title>l1_attn_stage2_gpu4&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2176.28,-11141.94C2190.41,-11135.6 2205.94,-11129.8 2221,-11126.5 2266.12,-11116.59 3840.41,-11131.78 3884,-11116.5 3894.15,-11112.94 3892.87,-11105.11 3903,-11101.5 3951.67,-11084.13 4317.42,-11104.07 4368,-11093.5 4411.84,-11084.34 4458.74,-11063.44 4490.74,-11047.31"/>
<polygon fill="red" stroke="red" points="4492.46,-11050.36 4499.76,-11042.69 4489.27,-11044.13 4492.46,-11050.36"/>
<text text-anchor="middle" x="3934.5" y="-11105.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu5 -->
<g id="node70" class="node">
<title>l1_attn_stage3_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2318" cy="-11025" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2318" y="-11036.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="2318" y="-11021.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2318" y="-11006.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu5&#45;&gt;l1_attn_stage3_gpu5 -->
<g id="edge54" class="edge">
<title>l1_attn_stage2_gpu5&#45;&gt;l1_attn_stage3_gpu5</title>
<path fill="none" stroke="black" d="M2318,-11134.41C2318,-11115.69 2318,-11092.7 2318,-11072.71"/>
<polygon fill="black" stroke="black" points="2321.5,-11072.58 2318,-11062.58 2314.5,-11072.58 2321.5,-11072.58"/>
</g>
<!-- l1_attn_stage2_gpu5&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge1270" class="edge">
<title>l1_attn_stage2_gpu5&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2371.28,-11141.94C2385.41,-11135.6 2400.94,-11129.81 2416,-11126.5 2458.16,-11117.23 3929.27,-11130.79 3970,-11116.5 3980.15,-11112.94 3978.87,-11105.13 3989,-11101.5 4028.64,-11087.26 4326.79,-11102.19 4368,-11093.5 4411.82,-11084.25 4458.73,-11063.37 4490.73,-11047.26"/>
<polygon fill="red" stroke="red" points="4492.45,-11050.32 4499.75,-11042.65 4489.26,-11044.08 4492.45,-11050.32"/>
<text text-anchor="middle" x="4020.5" y="-11105.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu6 -->
<g id="node71" class="node">
<title>l1_attn_stage3_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2513" cy="-11025" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2513" y="-11036.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="2513" y="-11021.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2513" y="-11006.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu6&#45;&gt;l1_attn_stage3_gpu6 -->
<g id="edge55" class="edge">
<title>l1_attn_stage2_gpu6&#45;&gt;l1_attn_stage3_gpu6</title>
<path fill="none" stroke="black" d="M2513,-11134.41C2513,-11115.69 2513,-11092.7 2513,-11072.71"/>
<polygon fill="black" stroke="black" points="2516.5,-11072.58 2513,-11062.58 2509.5,-11072.58 2516.5,-11072.58"/>
</g>
<!-- l1_attn_stage2_gpu6&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge1271" class="edge">
<title>l1_attn_stage2_gpu6&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2566.28,-11141.95C2580.41,-11135.61 2595.94,-11129.81 2611,-11126.5 2650.2,-11117.87 4018.13,-11129.79 4056,-11116.5 4066.15,-11112.93 4064.89,-11105.16 4075,-11101.5 4105.62,-11090.4 4336.15,-11100.32 4368,-11093.5 4411.66,-11084.15 4458.41,-11063.38 4490.42,-11047.34"/>
<polygon fill="red" stroke="red" points="4492.12,-11050.4 4499.45,-11042.74 4488.95,-11044.16 4492.12,-11050.4"/>
<text text-anchor="middle" x="4106.5" y="-11105.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu7 -->
<g id="node72" class="node">
<title>l1_attn_stage3_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2708" cy="-11025" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2708" y="-11036.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="2708" y="-11021.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2708" y="-11006.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu7&#45;&gt;l1_attn_stage3_gpu7 -->
<g id="edge56" class="edge">
<title>l1_attn_stage2_gpu7&#45;&gt;l1_attn_stage3_gpu7</title>
<path fill="none" stroke="black" d="M2708,-11134.41C2708,-11115.69 2708,-11092.7 2708,-11072.71"/>
<polygon fill="black" stroke="black" points="2711.5,-11072.58 2708,-11062.58 2704.5,-11072.58 2711.5,-11072.58"/>
</g>
<!-- l1_attn_stage2_gpu7&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge1272" class="edge">
<title>l1_attn_stage2_gpu7&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2761.28,-11141.95C2775.42,-11135.62 2790.95,-11129.81 2806,-11126.5 2842.24,-11118.51 4106.99,-11128.8 4142,-11116.5 4152.15,-11112.93 4150.91,-11105.22 4161,-11101.5 4204.19,-11085.56 4323.04,-11103.4 4368,-11093.5 4411.6,-11083.9 4458.37,-11063.17 4490.39,-11047.2"/>
<polygon fill="red" stroke="red" points="4492.08,-11050.27 4499.42,-11042.63 4488.92,-11044.02 4492.08,-11050.27"/>
<text text-anchor="middle" x="4192.5" y="-11105.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu8 -->
<g id="node73" class="node">
<title>l1_attn_stage3_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2903" cy="-11025" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2903" y="-11036.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="2903" y="-11021.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2903" y="-11006.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu8&#45;&gt;l1_attn_stage3_gpu8 -->
<g id="edge57" class="edge">
<title>l1_attn_stage2_gpu8&#45;&gt;l1_attn_stage3_gpu8</title>
<path fill="none" stroke="black" d="M2903,-11134.41C2903,-11115.69 2903,-11092.7 2903,-11072.71"/>
<polygon fill="black" stroke="black" points="2906.5,-11072.58 2903,-11062.58 2899.5,-11072.58 2906.5,-11072.58"/>
</g>
<!-- l1_attn_stage2_gpu8&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge1273" class="edge">
<title>l1_attn_stage2_gpu8&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2956.28,-11141.96C2970.42,-11135.62 2985.95,-11129.82 3001,-11126.5 3067.57,-11111.81 4163.69,-11139.12 4228,-11116.5 4238.15,-11112.93 4236.96,-11105.36 4247,-11101.5 4297.3,-11082.15 4315.53,-11105.81 4368,-11093.5 4411.2,-11083.36 4457.67,-11062.92 4489.71,-11047.17"/>
<polygon fill="red" stroke="red" points="4491.38,-11050.25 4498.77,-11042.66 4488.25,-11043.99 4491.38,-11050.25"/>
<text text-anchor="middle" x="4278.5" y="-11105.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu9 -->
<g id="node74" class="node">
<title>l1_attn_stage3_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3098" cy="-11025" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3098" y="-11036.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="3098" y="-11021.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3098" y="-11006.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu9&#45;&gt;l1_attn_stage3_gpu9 -->
<g id="edge58" class="edge">
<title>l1_attn_stage2_gpu9&#45;&gt;l1_attn_stage3_gpu9</title>
<path fill="none" stroke="black" d="M3098,-11134.41C3098,-11115.69 3098,-11092.7 3098,-11072.71"/>
<polygon fill="black" stroke="black" points="3101.5,-11072.58 3098,-11062.58 3094.5,-11072.58 3101.5,-11072.58"/>
</g>
<!-- l1_attn_stage2_gpu9&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge1274" class="edge">
<title>l1_attn_stage2_gpu9&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3151.28,-11141.97C3165.42,-11135.63 3180.95,-11129.83 3196,-11126.5 3256.65,-11113.09 4255.41,-11137.13 4314,-11116.5 4324.15,-11112.92 4323.3,-11106.14 4333,-11101.5 4347.39,-11094.61 4352.8,-11098.36 4368,-11093.5 4408.94,-11080.4 4453.95,-11061.24 4486.12,-11046.67"/>
<polygon fill="red" stroke="red" points="4487.61,-11049.84 4495.25,-11042.51 4484.7,-11043.47 4487.61,-11049.84"/>
<text text-anchor="middle" x="4364.5" y="-11105.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu10 -->
<g id="node75" class="node">
<title>l1_attn_stage3_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3293" cy="-11025" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3293" y="-11036.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="3293" y="-11021.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3293" y="-11006.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu10&#45;&gt;l1_attn_stage3_gpu10 -->
<g id="edge59" class="edge">
<title>l1_attn_stage2_gpu10&#45;&gt;l1_attn_stage3_gpu10</title>
<path fill="none" stroke="black" d="M3293,-11134.41C3293,-11115.69 3293,-11092.7 3293,-11072.71"/>
<polygon fill="black" stroke="black" points="3296.5,-11072.58 3293,-11062.58 3289.5,-11072.58 3296.5,-11072.58"/>
</g>
<!-- l1_attn_stage2_gpu10&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge1275" class="edge">
<title>l1_attn_stage2_gpu10&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3346.29,-11141.98C3360.42,-11135.64 3375.95,-11129.83 3391,-11126.5 3445.73,-11114.37 4347.13,-11135.14 4400,-11116.5 4410.15,-11112.92 4410.32,-11107.86 4419,-11101.5 4444.22,-11083 4473.5,-11063.15 4495.65,-11048.45"/>
<polygon fill="red" stroke="red" points="4497.66,-11051.32 4504.07,-11042.88 4493.8,-11045.48 4497.66,-11051.32"/>
<text text-anchor="middle" x="4450.5" y="-11105.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu11 -->
<g id="node76" class="node">
<title>l1_attn_stage3_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3488" cy="-11025" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3488" y="-11036.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="3488" y="-11021.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3488" y="-11006.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu11&#45;&gt;l1_attn_stage3_gpu11 -->
<g id="edge60" class="edge">
<title>l1_attn_stage2_gpu11&#45;&gt;l1_attn_stage3_gpu11</title>
<path fill="none" stroke="black" d="M3488,-11134.41C3488,-11115.69 3488,-11092.7 3488,-11072.71"/>
<polygon fill="black" stroke="black" points="3491.5,-11072.58 3488,-11062.58 3484.5,-11072.58 3491.5,-11072.58"/>
</g>
<!-- l1_attn_stage2_gpu11&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge1276" class="edge">
<title>l1_attn_stage2_gpu11&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3541.29,-11141.99C3555.42,-11135.65 3570.95,-11129.84 3586,-11126.5 3610.41,-11121.07 4464.88,-11129.88 4486,-11116.5 4507.94,-11102.6 4519.24,-11074.32 4524.85,-11053.05"/>
<polygon fill="red" stroke="red" points="4528.27,-11053.81 4527.18,-11043.27 4521.46,-11052.19 4528.27,-11053.81"/>
<text text-anchor="middle" x="4532.5" y="-11105.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu12 -->
<g id="node77" class="node">
<title>l1_attn_stage3_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3683" cy="-11025" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3683" y="-11036.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="3683" y="-11021.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3683" y="-11006.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu12&#45;&gt;l1_attn_stage3_gpu12 -->
<g id="edge61" class="edge">
<title>l1_attn_stage2_gpu12&#45;&gt;l1_attn_stage3_gpu12</title>
<path fill="none" stroke="black" d="M3627.85,-11142.53C3614.43,-11136.5 3599.93,-11130.69 3586,-11126.5 3572.22,-11122.35 3531.36,-11127.43 3522,-11116.5 3487.08,-11075.7 3527.79,-11115.82 3586,-11093.5 3603.78,-11086.68 3621.42,-11075.93 3636.68,-11065"/>
<polygon fill="black" stroke="black" points="3638.93,-11067.69 3644.9,-11058.94 3634.77,-11062.06 3638.93,-11067.69"/>
</g>
<!-- l1_attn_stage2_gpu12&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge1277" class="edge">
<title>l1_attn_stage2_gpu12&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3736.29,-11142.01C3750.43,-11135.67 3765.95,-11129.85 3781,-11126.5 3802.45,-11121.71 4556.56,-11132.13 4572,-11116.5 4590.16,-11098.11 4572.89,-11070.42 4555.31,-11050.51"/>
<polygon fill="red" stroke="red" points="4557.75,-11047.99 4548.38,-11043.03 4552.61,-11052.75 4557.75,-11047.99"/>
<text text-anchor="middle" x="4610.5" y="-11105.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu13 -->
<g id="node78" class="node">
<title>l1_attn_stage3_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3878" cy="-11025" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3878" y="-11036.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="3878" y="-11021.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3878" y="-11006.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu13&#45;&gt;l1_attn_stage3_gpu13 -->
<g id="edge62" class="edge">
<title>l1_attn_stage2_gpu13&#45;&gt;l1_attn_stage3_gpu13</title>
<path fill="none" stroke="black" d="M3824.7,-11142.06C3810.85,-11135.8 3795.69,-11130.01 3781,-11126.5 3767.37,-11123.24 3538.71,-11126.6 3529,-11116.5 3524.38,-11111.69 3524.36,-11106.29 3529,-11101.5 3538.75,-11091.44 3767.7,-11097.9 3781,-11093.5 3799.4,-11087.4 3817.44,-11076.61 3832.87,-11065.42"/>
<polygon fill="black" stroke="black" points="3835.27,-11067.99 3841.16,-11059.19 3831.06,-11062.4 3835.27,-11067.99"/>
</g>
<!-- l1_attn_stage2_gpu13&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge1278" class="edge">
<title>l1_attn_stage2_gpu13&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3931.3,-11142.03C3945.43,-11135.69 3960.96,-11129.87 3976,-11126.5 3994.49,-11122.35 4644.7,-11129.99 4658,-11116.5 4686.36,-11087.72 4638.79,-11061.89 4593.82,-11045.26"/>
<polygon fill="red" stroke="red" points="4594.88,-11041.93 4584.29,-11041.86 4592.53,-11048.52 4594.88,-11041.93"/>
<text text-anchor="middle" x="4697.5" y="-11105.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu14 -->
<g id="node79" class="node">
<title>l1_attn_stage3_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4073" cy="-11025" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4073" y="-11036.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="4073" y="-11021.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4073" y="-11006.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu14&#45;&gt;l1_attn_stage3_gpu14 -->
<g id="edge63" class="edge">
<title>l1_attn_stage2_gpu14&#45;&gt;l1_attn_stage3_gpu14</title>
<path fill="none" stroke="black" d="M4019.74,-11141.88C4005.89,-11135.63 3990.71,-11129.89 3976,-11126.5 3952.17,-11121.01 3553.09,-11133.98 3536,-11116.5 3531.34,-11111.73 3531.33,-11106.25 3536,-11101.5 3544.56,-11092.78 3964.37,-11097.26 3976,-11093.5 3994.45,-11087.53 4012.49,-11076.77 4027.92,-11065.57"/>
<polygon fill="black" stroke="black" points="4030.32,-11068.14 4036.2,-11059.33 4026.11,-11062.54 4030.32,-11068.14"/>
</g>
<!-- l1_attn_stage2_gpu14&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge1279" class="edge">
<title>l1_attn_stage2_gpu14&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4126.3,-11142.06C4140.44,-11135.72 4155.96,-11129.89 4171,-11126.5 4186.53,-11123 4732.84,-11127.85 4744,-11116.5 4784.03,-11075.76 4714.32,-11052.4 4644.01,-11039.66"/>
<polygon fill="red" stroke="red" points="4644.55,-11036.2 4634.1,-11037.93 4643.35,-11043.1 4644.55,-11036.2"/>
<text text-anchor="middle" x="4784.5" y="-11105.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage3_gpu15 -->
<g id="node80" class="node">
<title>l1_attn_stage3_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4268" cy="-11025" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4268" y="-11036.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage3</text>
<text text-anchor="middle" x="4268" y="-11021.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4268" y="-11006.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage2_gpu15&#45;&gt;l1_attn_stage3_gpu15 -->
<g id="edge64" class="edge">
<title>l1_attn_stage2_gpu15&#45;&gt;l1_attn_stage3_gpu15</title>
<path fill="none" stroke="black" d="M4215.02,-11141.93C4201.09,-11135.63 4185.82,-11129.86 4171,-11126.5 4153.99,-11122.64 3555.24,-11128.93 3543,-11116.5 3538.32,-11111.75 3538.32,-11106.24 3543,-11101.5 3555.26,-11089.08 4154.39,-11098.83 4171,-11093.5 4189.46,-11087.58 4207.51,-11076.83 4222.94,-11065.63"/>
<polygon fill="black" stroke="black" points="4225.34,-11068.2 4231.22,-11059.38 4221.13,-11062.6 4225.34,-11068.2"/>
</g>
<!-- l1_attn_stage2_gpu15&#45;&gt;l1_attn_stage3_gpu[next_gpu] -->
<g id="edge1280" class="edge">
<title>l1_attn_stage2_gpu15&#45;&gt;l1_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4323.38,-11142.68C4338.74,-11136.12 4355.68,-11130.03 4372,-11126.5 4396.87,-11121.12 4812.2,-11134.69 4830,-11116.5 4884.67,-11060.62 4783.45,-11038.96 4684.12,-11030.71"/>
<polygon fill="red" stroke="red" points="4684.15,-11027.2 4673.9,-11029.9 4683.6,-11034.18 4684.15,-11027.2"/>
<text text-anchor="middle" x="4870.5" y="-11105.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu0 -->
<g id="node81" class="node">
<title>l1_attn_stage4_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1343" cy="-10878" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1343" y="-10889.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="1343" y="-10874.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1343" y="-10859.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu0&#45;&gt;l1_attn_stage4_gpu0 -->
<g id="edge65" class="edge">
<title>l1_attn_stage3_gpu0&#45;&gt;l1_attn_stage4_gpu0</title>
<path fill="none" stroke="black" d="M1343,-10987.41C1343,-10968.69 1343,-10945.7 1343,-10925.71"/>
<polygon fill="black" stroke="black" points="1346.5,-10925.58 1343,-10915.58 1339.5,-10925.58 1346.5,-10925.58"/>
</g>
<!-- l1_attn_stage4_gpu[next_gpu] -->
<g id="node1316" class="node">
<title>l1_attn_stage4_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4530" cy="-10878" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4530" y="-10874.3" font-family="Times,serif" font-size="14.00">l1_attn_stage4_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage3_gpu0&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge1281" class="edge">
<title>l1_attn_stage3_gpu0&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1396.29,-10995C1410.43,-10988.66 1425.95,-10982.85 1441,-10979.5 1670.73,-10928.36 3323.66,-10957.05 3559,-10954.5 3603.94,-10954.01 4323.97,-10955.53 4368,-10946.5 4411.87,-10937.5 4458.77,-10916.58 4490.76,-10900.4"/>
<polygon fill="red" stroke="red" points="4492.49,-10903.44 4499.78,-10895.76 4489.28,-10897.22 4492.49,-10903.44"/>
<text text-anchor="middle" x="3590.5" y="-10958.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu1 -->
<g id="node82" class="node">
<title>l1_attn_stage4_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1538" cy="-10878" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1538" y="-10889.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="1538" y="-10874.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1538" y="-10859.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu1&#45;&gt;l1_attn_stage4_gpu1 -->
<g id="edge66" class="edge">
<title>l1_attn_stage3_gpu1&#45;&gt;l1_attn_stage4_gpu1</title>
<path fill="none" stroke="black" d="M1538,-10987.41C1538,-10968.69 1538,-10945.7 1538,-10925.71"/>
<polygon fill="black" stroke="black" points="1541.5,-10925.58 1538,-10915.58 1534.5,-10925.58 1541.5,-10925.58"/>
</g>
<!-- l1_attn_stage3_gpu1&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge1282" class="edge">
<title>l1_attn_stage3_gpu1&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1591.28,-10994.93C1605.41,-10988.59 1620.94,-10982.8 1636,-10979.5 1690,-10967.67 3573.82,-10987.76 3626,-10969.5 3636.15,-10965.94 3634.86,-10958.08 3645,-10954.5 3682.87,-10941.11 4328.66,-10954.59 4368,-10946.5 4411.87,-10937.47 4458.77,-10916.56 4490.76,-10900.38"/>
<polygon fill="red" stroke="red" points="4492.48,-10903.43 4499.78,-10895.75 4489.28,-10897.2 4492.48,-10903.43"/>
<text text-anchor="middle" x="3676.5" y="-10958.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu2 -->
<g id="node83" class="node">
<title>l1_attn_stage4_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1733" cy="-10878" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1733" y="-10889.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="1733" y="-10874.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1733" y="-10859.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu2&#45;&gt;l1_attn_stage4_gpu2 -->
<g id="edge67" class="edge">
<title>l1_attn_stage3_gpu2&#45;&gt;l1_attn_stage4_gpu2</title>
<path fill="none" stroke="black" d="M1733,-10987.41C1733,-10968.69 1733,-10945.7 1733,-10925.71"/>
<polygon fill="black" stroke="black" points="1736.5,-10925.58 1733,-10915.58 1729.5,-10925.58 1736.5,-10925.58"/>
</g>
<!-- l1_attn_stage3_gpu2&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge1283" class="edge">
<title>l1_attn_stage3_gpu2&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1786.28,-10994.93C1800.41,-10988.59 1815.94,-10982.8 1831,-10979.5 1882.04,-10968.31 3662.68,-10986.77 3712,-10969.5 3722.15,-10965.94 3720.86,-10958.09 3731,-10954.5 3764.36,-10942.68 4333.34,-10953.66 4368,-10946.5 4411.86,-10937.44 4458.76,-10916.53 4490.75,-10900.36"/>
<polygon fill="red" stroke="red" points="4492.48,-10903.41 4499.77,-10895.73 4489.28,-10897.19 4492.48,-10903.41"/>
<text text-anchor="middle" x="3762.5" y="-10958.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu3 -->
<g id="node84" class="node">
<title>l1_attn_stage4_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1928" cy="-10878" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1928" y="-10889.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="1928" y="-10874.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1928" y="-10859.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu3&#45;&gt;l1_attn_stage4_gpu3 -->
<g id="edge68" class="edge">
<title>l1_attn_stage3_gpu3&#45;&gt;l1_attn_stage4_gpu3</title>
<path fill="none" stroke="black" d="M1928,-10987.41C1928,-10968.69 1928,-10945.7 1928,-10925.71"/>
<polygon fill="black" stroke="black" points="1931.5,-10925.58 1928,-10915.58 1924.5,-10925.58 1931.5,-10925.58"/>
</g>
<!-- l1_attn_stage3_gpu3&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge1284" class="edge">
<title>l1_attn_stage3_gpu3&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1981.28,-10994.94C1995.41,-10988.6 2010.94,-10982.8 2026,-10979.5 2074.08,-10968.95 3751.55,-10985.77 3798,-10969.5 3808.15,-10965.94 3806.86,-10958.1 3817,-10954.5 3845.85,-10944.25 4338.02,-10952.72 4368,-10946.5 4411.85,-10937.4 4458.75,-10916.49 4490.75,-10900.34"/>
<polygon fill="red" stroke="red" points="4492.47,-10903.39 4499.77,-10895.71 4489.27,-10897.16 4492.47,-10903.39"/>
<text text-anchor="middle" x="3848.5" y="-10958.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu4 -->
<g id="node85" class="node">
<title>l1_attn_stage4_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2123" cy="-10878" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2123" y="-10889.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="2123" y="-10874.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2123" y="-10859.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu4&#45;&gt;l1_attn_stage4_gpu4 -->
<g id="edge69" class="edge">
<title>l1_attn_stage3_gpu4&#45;&gt;l1_attn_stage4_gpu4</title>
<path fill="none" stroke="black" d="M2123,-10987.41C2123,-10968.69 2123,-10945.7 2123,-10925.71"/>
<polygon fill="black" stroke="black" points="2126.5,-10925.58 2123,-10915.58 2119.5,-10925.58 2126.5,-10925.58"/>
</g>
<!-- l1_attn_stage3_gpu4&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge1285" class="edge">
<title>l1_attn_stage3_gpu4&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2176.28,-10994.94C2190.41,-10988.6 2205.94,-10982.8 2221,-10979.5 2266.12,-10969.59 3840.41,-10984.78 3884,-10969.5 3894.15,-10965.94 3892.87,-10958.11 3903,-10954.5 3951.67,-10937.13 4317.42,-10957.07 4368,-10946.5 4411.84,-10937.34 4458.74,-10916.44 4490.74,-10900.31"/>
<polygon fill="red" stroke="red" points="4492.46,-10903.36 4499.76,-10895.69 4489.27,-10897.13 4492.46,-10903.36"/>
<text text-anchor="middle" x="3934.5" y="-10958.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu5 -->
<g id="node86" class="node">
<title>l1_attn_stage4_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2318" cy="-10878" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2318" y="-10889.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="2318" y="-10874.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2318" y="-10859.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu5&#45;&gt;l1_attn_stage4_gpu5 -->
<g id="edge70" class="edge">
<title>l1_attn_stage3_gpu5&#45;&gt;l1_attn_stage4_gpu5</title>
<path fill="none" stroke="black" d="M2318,-10987.41C2318,-10968.69 2318,-10945.7 2318,-10925.71"/>
<polygon fill="black" stroke="black" points="2321.5,-10925.58 2318,-10915.58 2314.5,-10925.58 2321.5,-10925.58"/>
</g>
<!-- l1_attn_stage3_gpu5&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge1286" class="edge">
<title>l1_attn_stage3_gpu5&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2371.28,-10994.94C2385.41,-10988.6 2400.94,-10982.81 2416,-10979.5 2458.16,-10970.23 3929.27,-10983.79 3970,-10969.5 3980.15,-10965.94 3978.87,-10958.13 3989,-10954.5 4028.64,-10940.26 4326.79,-10955.19 4368,-10946.5 4411.82,-10937.25 4458.73,-10916.37 4490.73,-10900.26"/>
<polygon fill="red" stroke="red" points="4492.45,-10903.32 4499.75,-10895.65 4489.26,-10897.08 4492.45,-10903.32"/>
<text text-anchor="middle" x="4020.5" y="-10958.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu6 -->
<g id="node87" class="node">
<title>l1_attn_stage4_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2513" cy="-10878" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2513" y="-10889.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="2513" y="-10874.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2513" y="-10859.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu6&#45;&gt;l1_attn_stage4_gpu6 -->
<g id="edge71" class="edge">
<title>l1_attn_stage3_gpu6&#45;&gt;l1_attn_stage4_gpu6</title>
<path fill="none" stroke="black" d="M2513,-10987.41C2513,-10968.69 2513,-10945.7 2513,-10925.71"/>
<polygon fill="black" stroke="black" points="2516.5,-10925.58 2513,-10915.58 2509.5,-10925.58 2516.5,-10925.58"/>
</g>
<!-- l1_attn_stage3_gpu6&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge1287" class="edge">
<title>l1_attn_stage3_gpu6&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2566.28,-10994.95C2580.41,-10988.61 2595.94,-10982.81 2611,-10979.5 2650.2,-10970.87 4018.13,-10982.79 4056,-10969.5 4066.15,-10965.93 4064.89,-10958.16 4075,-10954.5 4105.62,-10943.4 4336.15,-10953.32 4368,-10946.5 4411.66,-10937.15 4458.41,-10916.38 4490.42,-10900.34"/>
<polygon fill="red" stroke="red" points="4492.12,-10903.4 4499.45,-10895.74 4488.95,-10897.16 4492.12,-10903.4"/>
<text text-anchor="middle" x="4106.5" y="-10958.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu7 -->
<g id="node88" class="node">
<title>l1_attn_stage4_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2708" cy="-10878" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2708" y="-10889.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="2708" y="-10874.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2708" y="-10859.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu7&#45;&gt;l1_attn_stage4_gpu7 -->
<g id="edge72" class="edge">
<title>l1_attn_stage3_gpu7&#45;&gt;l1_attn_stage4_gpu7</title>
<path fill="none" stroke="black" d="M2708,-10987.41C2708,-10968.69 2708,-10945.7 2708,-10925.71"/>
<polygon fill="black" stroke="black" points="2711.5,-10925.58 2708,-10915.58 2704.5,-10925.58 2711.5,-10925.58"/>
</g>
<!-- l1_attn_stage3_gpu7&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge1288" class="edge">
<title>l1_attn_stage3_gpu7&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2761.28,-10994.95C2775.42,-10988.62 2790.95,-10982.81 2806,-10979.5 2842.24,-10971.51 4106.99,-10981.8 4142,-10969.5 4152.15,-10965.93 4150.91,-10958.22 4161,-10954.5 4204.19,-10938.56 4323.04,-10956.4 4368,-10946.5 4411.6,-10936.9 4458.37,-10916.17 4490.39,-10900.2"/>
<polygon fill="red" stroke="red" points="4492.08,-10903.27 4499.42,-10895.63 4488.92,-10897.02 4492.08,-10903.27"/>
<text text-anchor="middle" x="4192.5" y="-10958.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu8 -->
<g id="node89" class="node">
<title>l1_attn_stage4_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2903" cy="-10878" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2903" y="-10889.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="2903" y="-10874.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2903" y="-10859.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu8&#45;&gt;l1_attn_stage4_gpu8 -->
<g id="edge73" class="edge">
<title>l1_attn_stage3_gpu8&#45;&gt;l1_attn_stage4_gpu8</title>
<path fill="none" stroke="black" d="M2903,-10987.41C2903,-10968.69 2903,-10945.7 2903,-10925.71"/>
<polygon fill="black" stroke="black" points="2906.5,-10925.58 2903,-10915.58 2899.5,-10925.58 2906.5,-10925.58"/>
</g>
<!-- l1_attn_stage3_gpu8&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge1289" class="edge">
<title>l1_attn_stage3_gpu8&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2956.28,-10994.96C2970.42,-10988.62 2985.95,-10982.82 3001,-10979.5 3067.57,-10964.81 4163.69,-10992.12 4228,-10969.5 4238.15,-10965.93 4236.96,-10958.36 4247,-10954.5 4297.3,-10935.15 4315.53,-10958.81 4368,-10946.5 4411.2,-10936.36 4457.67,-10915.92 4489.71,-10900.17"/>
<polygon fill="red" stroke="red" points="4491.38,-10903.25 4498.77,-10895.66 4488.25,-10896.99 4491.38,-10903.25"/>
<text text-anchor="middle" x="4278.5" y="-10958.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu9 -->
<g id="node90" class="node">
<title>l1_attn_stage4_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3098" cy="-10878" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3098" y="-10889.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="3098" y="-10874.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3098" y="-10859.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu9&#45;&gt;l1_attn_stage4_gpu9 -->
<g id="edge74" class="edge">
<title>l1_attn_stage3_gpu9&#45;&gt;l1_attn_stage4_gpu9</title>
<path fill="none" stroke="black" d="M3098,-10987.41C3098,-10968.69 3098,-10945.7 3098,-10925.71"/>
<polygon fill="black" stroke="black" points="3101.5,-10925.58 3098,-10915.58 3094.5,-10925.58 3101.5,-10925.58"/>
</g>
<!-- l1_attn_stage3_gpu9&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge1290" class="edge">
<title>l1_attn_stage3_gpu9&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3151.28,-10994.97C3165.42,-10988.63 3180.95,-10982.83 3196,-10979.5 3256.65,-10966.09 4255.41,-10990.13 4314,-10969.5 4324.15,-10965.92 4323.3,-10959.14 4333,-10954.5 4347.39,-10947.61 4352.8,-10951.36 4368,-10946.5 4408.94,-10933.4 4453.95,-10914.24 4486.12,-10899.67"/>
<polygon fill="red" stroke="red" points="4487.61,-10902.84 4495.25,-10895.51 4484.7,-10896.47 4487.61,-10902.84"/>
<text text-anchor="middle" x="4364.5" y="-10958.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu10 -->
<g id="node91" class="node">
<title>l1_attn_stage4_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3293" cy="-10878" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3293" y="-10889.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="3293" y="-10874.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3293" y="-10859.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu10&#45;&gt;l1_attn_stage4_gpu10 -->
<g id="edge75" class="edge">
<title>l1_attn_stage3_gpu10&#45;&gt;l1_attn_stage4_gpu10</title>
<path fill="none" stroke="black" d="M3293,-10987.41C3293,-10968.69 3293,-10945.7 3293,-10925.71"/>
<polygon fill="black" stroke="black" points="3296.5,-10925.58 3293,-10915.58 3289.5,-10925.58 3296.5,-10925.58"/>
</g>
<!-- l1_attn_stage3_gpu10&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge1291" class="edge">
<title>l1_attn_stage3_gpu10&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3346.29,-10994.98C3360.42,-10988.64 3375.95,-10982.83 3391,-10979.5 3445.73,-10967.37 4347.13,-10988.14 4400,-10969.5 4410.15,-10965.92 4410.32,-10960.86 4419,-10954.5 4444.22,-10936 4473.5,-10916.15 4495.65,-10901.45"/>
<polygon fill="red" stroke="red" points="4497.66,-10904.32 4504.07,-10895.88 4493.8,-10898.48 4497.66,-10904.32"/>
<text text-anchor="middle" x="4450.5" y="-10958.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu11 -->
<g id="node92" class="node">
<title>l1_attn_stage4_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3488" cy="-10878" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3488" y="-10889.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="3488" y="-10874.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3488" y="-10859.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu11&#45;&gt;l1_attn_stage4_gpu11 -->
<g id="edge76" class="edge">
<title>l1_attn_stage3_gpu11&#45;&gt;l1_attn_stage4_gpu11</title>
<path fill="none" stroke="black" d="M3488,-10987.41C3488,-10968.69 3488,-10945.7 3488,-10925.71"/>
<polygon fill="black" stroke="black" points="3491.5,-10925.58 3488,-10915.58 3484.5,-10925.58 3491.5,-10925.58"/>
</g>
<!-- l1_attn_stage3_gpu11&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge1292" class="edge">
<title>l1_attn_stage3_gpu11&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3541.29,-10994.99C3555.42,-10988.65 3570.95,-10982.84 3586,-10979.5 3610.41,-10974.07 4464.88,-10982.88 4486,-10969.5 4507.94,-10955.6 4519.24,-10927.32 4524.85,-10906.05"/>
<polygon fill="red" stroke="red" points="4528.27,-10906.81 4527.18,-10896.27 4521.46,-10905.19 4528.27,-10906.81"/>
<text text-anchor="middle" x="4532.5" y="-10958.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu12 -->
<g id="node93" class="node">
<title>l1_attn_stage4_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3683" cy="-10878" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3683" y="-10889.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="3683" y="-10874.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3683" y="-10859.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu12&#45;&gt;l1_attn_stage4_gpu12 -->
<g id="edge77" class="edge">
<title>l1_attn_stage3_gpu12&#45;&gt;l1_attn_stage4_gpu12</title>
<path fill="none" stroke="black" d="M3627.85,-10995.53C3614.43,-10989.5 3599.93,-10983.69 3586,-10979.5 3572.22,-10975.35 3531.36,-10980.43 3522,-10969.5 3487.08,-10928.7 3527.79,-10968.82 3586,-10946.5 3603.78,-10939.68 3621.42,-10928.93 3636.68,-10918"/>
<polygon fill="black" stroke="black" points="3638.93,-10920.69 3644.9,-10911.94 3634.77,-10915.06 3638.93,-10920.69"/>
</g>
<!-- l1_attn_stage3_gpu12&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge1293" class="edge">
<title>l1_attn_stage3_gpu12&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3736.29,-10995.01C3750.43,-10988.67 3765.95,-10982.85 3781,-10979.5 3802.45,-10974.71 4556.56,-10985.13 4572,-10969.5 4590.16,-10951.11 4572.89,-10923.42 4555.31,-10903.51"/>
<polygon fill="red" stroke="red" points="4557.75,-10900.99 4548.38,-10896.03 4552.61,-10905.75 4557.75,-10900.99"/>
<text text-anchor="middle" x="4610.5" y="-10958.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu13 -->
<g id="node94" class="node">
<title>l1_attn_stage4_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3878" cy="-10878" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3878" y="-10889.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="3878" y="-10874.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3878" y="-10859.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu13&#45;&gt;l1_attn_stage4_gpu13 -->
<g id="edge78" class="edge">
<title>l1_attn_stage3_gpu13&#45;&gt;l1_attn_stage4_gpu13</title>
<path fill="none" stroke="black" d="M3824.7,-10995.06C3810.85,-10988.8 3795.69,-10983.01 3781,-10979.5 3767.37,-10976.24 3538.71,-10979.6 3529,-10969.5 3524.38,-10964.69 3524.36,-10959.29 3529,-10954.5 3538.75,-10944.44 3767.7,-10950.9 3781,-10946.5 3799.4,-10940.4 3817.44,-10929.61 3832.87,-10918.42"/>
<polygon fill="black" stroke="black" points="3835.27,-10920.99 3841.16,-10912.19 3831.06,-10915.4 3835.27,-10920.99"/>
</g>
<!-- l1_attn_stage3_gpu13&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge1294" class="edge">
<title>l1_attn_stage3_gpu13&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3931.3,-10995.03C3945.43,-10988.69 3960.96,-10982.87 3976,-10979.5 3994.49,-10975.35 4644.7,-10982.99 4658,-10969.5 4686.36,-10940.72 4638.79,-10914.89 4593.82,-10898.26"/>
<polygon fill="red" stroke="red" points="4594.88,-10894.93 4584.29,-10894.86 4592.53,-10901.52 4594.88,-10894.93"/>
<text text-anchor="middle" x="4697.5" y="-10958.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu14 -->
<g id="node95" class="node">
<title>l1_attn_stage4_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4073" cy="-10878" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4073" y="-10889.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="4073" y="-10874.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4073" y="-10859.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu14&#45;&gt;l1_attn_stage4_gpu14 -->
<g id="edge79" class="edge">
<title>l1_attn_stage3_gpu14&#45;&gt;l1_attn_stage4_gpu14</title>
<path fill="none" stroke="black" d="M4019.74,-10994.88C4005.89,-10988.63 3990.71,-10982.89 3976,-10979.5 3952.17,-10974.01 3553.09,-10986.98 3536,-10969.5 3531.34,-10964.73 3531.33,-10959.25 3536,-10954.5 3544.56,-10945.78 3964.37,-10950.26 3976,-10946.5 3994.45,-10940.53 4012.49,-10929.77 4027.92,-10918.57"/>
<polygon fill="black" stroke="black" points="4030.32,-10921.14 4036.2,-10912.33 4026.11,-10915.54 4030.32,-10921.14"/>
</g>
<!-- l1_attn_stage3_gpu14&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge1295" class="edge">
<title>l1_attn_stage3_gpu14&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4126.3,-10995.06C4140.44,-10988.72 4155.96,-10982.89 4171,-10979.5 4186.53,-10976 4732.84,-10980.85 4744,-10969.5 4784.03,-10928.76 4714.32,-10905.4 4644.01,-10892.66"/>
<polygon fill="red" stroke="red" points="4644.55,-10889.2 4634.1,-10890.93 4643.35,-10896.1 4644.55,-10889.2"/>
<text text-anchor="middle" x="4784.5" y="-10958.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage4_gpu15 -->
<g id="node96" class="node">
<title>l1_attn_stage4_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4268" cy="-10878" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4268" y="-10889.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage4</text>
<text text-anchor="middle" x="4268" y="-10874.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4268" y="-10859.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage3_gpu15&#45;&gt;l1_attn_stage4_gpu15 -->
<g id="edge80" class="edge">
<title>l1_attn_stage3_gpu15&#45;&gt;l1_attn_stage4_gpu15</title>
<path fill="none" stroke="black" d="M4215.02,-10994.93C4201.09,-10988.63 4185.82,-10982.86 4171,-10979.5 4153.99,-10975.64 3555.24,-10981.93 3543,-10969.5 3538.32,-10964.75 3538.32,-10959.24 3543,-10954.5 3555.26,-10942.08 4154.39,-10951.83 4171,-10946.5 4189.46,-10940.58 4207.51,-10929.83 4222.94,-10918.63"/>
<polygon fill="black" stroke="black" points="4225.34,-10921.2 4231.22,-10912.38 4221.13,-10915.6 4225.34,-10921.2"/>
</g>
<!-- l1_attn_stage3_gpu15&#45;&gt;l1_attn_stage4_gpu[next_gpu] -->
<g id="edge1296" class="edge">
<title>l1_attn_stage3_gpu15&#45;&gt;l1_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4323.38,-10995.68C4338.74,-10989.12 4355.68,-10983.03 4372,-10979.5 4396.87,-10974.12 4812.2,-10987.69 4830,-10969.5 4884.67,-10913.62 4783.45,-10891.96 4684.12,-10883.71"/>
<polygon fill="red" stroke="red" points="4684.15,-10880.2 4673.9,-10882.9 4683.6,-10887.18 4684.15,-10880.2"/>
<text text-anchor="middle" x="4870.5" y="-10958.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu0 -->
<g id="node97" class="node">
<title>l1_attn_stage5_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1343" cy="-10731" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1343" y="-10742.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="1343" y="-10727.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1343" y="-10712.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu0&#45;&gt;l1_attn_stage5_gpu0 -->
<g id="edge81" class="edge">
<title>l1_attn_stage4_gpu0&#45;&gt;l1_attn_stage5_gpu0</title>
<path fill="none" stroke="black" d="M1343,-10840.41C1343,-10821.69 1343,-10798.7 1343,-10778.71"/>
<polygon fill="black" stroke="black" points="1346.5,-10778.58 1343,-10768.58 1339.5,-10778.58 1346.5,-10778.58"/>
</g>
<!-- l1_attn_stage5_gpu[next_gpu] -->
<g id="node1317" class="node">
<title>l1_attn_stage5_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4530" cy="-10731" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4530" y="-10727.3" font-family="Times,serif" font-size="14.00">l1_attn_stage5_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage4_gpu0&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge1297" class="edge">
<title>l1_attn_stage4_gpu0&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1396.29,-10848C1410.43,-10841.66 1425.95,-10835.85 1441,-10832.5 1670.73,-10781.36 3323.66,-10810.05 3559,-10807.5 3603.94,-10807.01 4323.97,-10808.53 4368,-10799.5 4411.87,-10790.5 4458.77,-10769.58 4490.76,-10753.4"/>
<polygon fill="red" stroke="red" points="4492.49,-10756.44 4499.78,-10748.76 4489.28,-10750.22 4492.49,-10756.44"/>
<text text-anchor="middle" x="3590.5" y="-10811.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu1 -->
<g id="node98" class="node">
<title>l1_attn_stage5_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1538" cy="-10731" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1538" y="-10742.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="1538" y="-10727.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1538" y="-10712.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu1&#45;&gt;l1_attn_stage5_gpu1 -->
<g id="edge82" class="edge">
<title>l1_attn_stage4_gpu1&#45;&gt;l1_attn_stage5_gpu1</title>
<path fill="none" stroke="black" d="M1538,-10840.41C1538,-10821.69 1538,-10798.7 1538,-10778.71"/>
<polygon fill="black" stroke="black" points="1541.5,-10778.58 1538,-10768.58 1534.5,-10778.58 1541.5,-10778.58"/>
</g>
<!-- l1_attn_stage4_gpu1&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge1298" class="edge">
<title>l1_attn_stage4_gpu1&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1591.28,-10847.93C1605.41,-10841.59 1620.94,-10835.8 1636,-10832.5 1690,-10820.67 3573.82,-10840.76 3626,-10822.5 3636.15,-10818.94 3634.86,-10811.08 3645,-10807.5 3682.87,-10794.11 4328.66,-10807.59 4368,-10799.5 4411.87,-10790.47 4458.77,-10769.56 4490.76,-10753.38"/>
<polygon fill="red" stroke="red" points="4492.48,-10756.43 4499.78,-10748.75 4489.28,-10750.2 4492.48,-10756.43"/>
<text text-anchor="middle" x="3676.5" y="-10811.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu2 -->
<g id="node99" class="node">
<title>l1_attn_stage5_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1733" cy="-10731" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1733" y="-10742.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="1733" y="-10727.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1733" y="-10712.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu2&#45;&gt;l1_attn_stage5_gpu2 -->
<g id="edge83" class="edge">
<title>l1_attn_stage4_gpu2&#45;&gt;l1_attn_stage5_gpu2</title>
<path fill="none" stroke="black" d="M1733,-10840.41C1733,-10821.69 1733,-10798.7 1733,-10778.71"/>
<polygon fill="black" stroke="black" points="1736.5,-10778.58 1733,-10768.58 1729.5,-10778.58 1736.5,-10778.58"/>
</g>
<!-- l1_attn_stage4_gpu2&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge1299" class="edge">
<title>l1_attn_stage4_gpu2&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1786.28,-10847.93C1800.41,-10841.59 1815.94,-10835.8 1831,-10832.5 1882.04,-10821.31 3662.68,-10839.77 3712,-10822.5 3722.15,-10818.94 3720.86,-10811.09 3731,-10807.5 3764.36,-10795.68 4333.34,-10806.66 4368,-10799.5 4411.86,-10790.44 4458.76,-10769.53 4490.75,-10753.36"/>
<polygon fill="red" stroke="red" points="4492.48,-10756.41 4499.77,-10748.73 4489.28,-10750.19 4492.48,-10756.41"/>
<text text-anchor="middle" x="3762.5" y="-10811.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu3 -->
<g id="node100" class="node">
<title>l1_attn_stage5_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1928" cy="-10731" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1928" y="-10742.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="1928" y="-10727.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1928" y="-10712.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu3&#45;&gt;l1_attn_stage5_gpu3 -->
<g id="edge84" class="edge">
<title>l1_attn_stage4_gpu3&#45;&gt;l1_attn_stage5_gpu3</title>
<path fill="none" stroke="black" d="M1928,-10840.41C1928,-10821.69 1928,-10798.7 1928,-10778.71"/>
<polygon fill="black" stroke="black" points="1931.5,-10778.58 1928,-10768.58 1924.5,-10778.58 1931.5,-10778.58"/>
</g>
<!-- l1_attn_stage4_gpu3&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge1300" class="edge">
<title>l1_attn_stage4_gpu3&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1981.28,-10847.94C1995.41,-10841.6 2010.94,-10835.8 2026,-10832.5 2074.08,-10821.95 3751.55,-10838.77 3798,-10822.5 3808.15,-10818.94 3806.86,-10811.1 3817,-10807.5 3845.85,-10797.25 4338.02,-10805.72 4368,-10799.5 4411.85,-10790.4 4458.75,-10769.49 4490.75,-10753.34"/>
<polygon fill="red" stroke="red" points="4492.47,-10756.39 4499.77,-10748.71 4489.27,-10750.16 4492.47,-10756.39"/>
<text text-anchor="middle" x="3848.5" y="-10811.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu4 -->
<g id="node101" class="node">
<title>l1_attn_stage5_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2123" cy="-10731" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2123" y="-10742.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="2123" y="-10727.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2123" y="-10712.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu4&#45;&gt;l1_attn_stage5_gpu4 -->
<g id="edge85" class="edge">
<title>l1_attn_stage4_gpu4&#45;&gt;l1_attn_stage5_gpu4</title>
<path fill="none" stroke="black" d="M2123,-10840.41C2123,-10821.69 2123,-10798.7 2123,-10778.71"/>
<polygon fill="black" stroke="black" points="2126.5,-10778.58 2123,-10768.58 2119.5,-10778.58 2126.5,-10778.58"/>
</g>
<!-- l1_attn_stage4_gpu4&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge1301" class="edge">
<title>l1_attn_stage4_gpu4&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2176.28,-10847.94C2190.41,-10841.6 2205.94,-10835.8 2221,-10832.5 2266.12,-10822.59 3840.41,-10837.78 3884,-10822.5 3894.15,-10818.94 3892.87,-10811.11 3903,-10807.5 3951.67,-10790.13 4317.42,-10810.07 4368,-10799.5 4411.84,-10790.34 4458.74,-10769.44 4490.74,-10753.31"/>
<polygon fill="red" stroke="red" points="4492.46,-10756.36 4499.76,-10748.69 4489.27,-10750.13 4492.46,-10756.36"/>
<text text-anchor="middle" x="3934.5" y="-10811.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu5 -->
<g id="node102" class="node">
<title>l1_attn_stage5_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2318" cy="-10731" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2318" y="-10742.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="2318" y="-10727.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2318" y="-10712.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu5&#45;&gt;l1_attn_stage5_gpu5 -->
<g id="edge86" class="edge">
<title>l1_attn_stage4_gpu5&#45;&gt;l1_attn_stage5_gpu5</title>
<path fill="none" stroke="black" d="M2318,-10840.41C2318,-10821.69 2318,-10798.7 2318,-10778.71"/>
<polygon fill="black" stroke="black" points="2321.5,-10778.58 2318,-10768.58 2314.5,-10778.58 2321.5,-10778.58"/>
</g>
<!-- l1_attn_stage4_gpu5&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge1302" class="edge">
<title>l1_attn_stage4_gpu5&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2371.28,-10847.94C2385.41,-10841.6 2400.94,-10835.81 2416,-10832.5 2458.16,-10823.23 3929.27,-10836.79 3970,-10822.5 3980.15,-10818.94 3978.87,-10811.13 3989,-10807.5 4028.64,-10793.26 4326.79,-10808.19 4368,-10799.5 4411.82,-10790.25 4458.73,-10769.37 4490.73,-10753.26"/>
<polygon fill="red" stroke="red" points="4492.45,-10756.32 4499.75,-10748.65 4489.26,-10750.08 4492.45,-10756.32"/>
<text text-anchor="middle" x="4020.5" y="-10811.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu6 -->
<g id="node103" class="node">
<title>l1_attn_stage5_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2513" cy="-10731" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2513" y="-10742.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="2513" y="-10727.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2513" y="-10712.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu6&#45;&gt;l1_attn_stage5_gpu6 -->
<g id="edge87" class="edge">
<title>l1_attn_stage4_gpu6&#45;&gt;l1_attn_stage5_gpu6</title>
<path fill="none" stroke="black" d="M2513,-10840.41C2513,-10821.69 2513,-10798.7 2513,-10778.71"/>
<polygon fill="black" stroke="black" points="2516.5,-10778.58 2513,-10768.58 2509.5,-10778.58 2516.5,-10778.58"/>
</g>
<!-- l1_attn_stage4_gpu6&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge1303" class="edge">
<title>l1_attn_stage4_gpu6&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2566.28,-10847.95C2580.41,-10841.61 2595.94,-10835.81 2611,-10832.5 2650.2,-10823.87 4018.13,-10835.79 4056,-10822.5 4066.15,-10818.93 4064.89,-10811.16 4075,-10807.5 4105.62,-10796.4 4336.15,-10806.32 4368,-10799.5 4411.66,-10790.15 4458.41,-10769.38 4490.42,-10753.34"/>
<polygon fill="red" stroke="red" points="4492.12,-10756.4 4499.45,-10748.74 4488.95,-10750.16 4492.12,-10756.4"/>
<text text-anchor="middle" x="4106.5" y="-10811.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu7 -->
<g id="node104" class="node">
<title>l1_attn_stage5_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2708" cy="-10731" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2708" y="-10742.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="2708" y="-10727.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2708" y="-10712.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu7&#45;&gt;l1_attn_stage5_gpu7 -->
<g id="edge88" class="edge">
<title>l1_attn_stage4_gpu7&#45;&gt;l1_attn_stage5_gpu7</title>
<path fill="none" stroke="black" d="M2708,-10840.41C2708,-10821.69 2708,-10798.7 2708,-10778.71"/>
<polygon fill="black" stroke="black" points="2711.5,-10778.58 2708,-10768.58 2704.5,-10778.58 2711.5,-10778.58"/>
</g>
<!-- l1_attn_stage4_gpu7&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge1304" class="edge">
<title>l1_attn_stage4_gpu7&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2761.28,-10847.95C2775.42,-10841.62 2790.95,-10835.81 2806,-10832.5 2842.24,-10824.51 4106.99,-10834.8 4142,-10822.5 4152.15,-10818.93 4150.91,-10811.22 4161,-10807.5 4204.19,-10791.56 4323.04,-10809.4 4368,-10799.5 4411.6,-10789.9 4458.37,-10769.17 4490.39,-10753.2"/>
<polygon fill="red" stroke="red" points="4492.08,-10756.27 4499.42,-10748.63 4488.92,-10750.02 4492.08,-10756.27"/>
<text text-anchor="middle" x="4192.5" y="-10811.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu8 -->
<g id="node105" class="node">
<title>l1_attn_stage5_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2903" cy="-10731" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2903" y="-10742.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="2903" y="-10727.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2903" y="-10712.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu8&#45;&gt;l1_attn_stage5_gpu8 -->
<g id="edge89" class="edge">
<title>l1_attn_stage4_gpu8&#45;&gt;l1_attn_stage5_gpu8</title>
<path fill="none" stroke="black" d="M2903,-10840.41C2903,-10821.69 2903,-10798.7 2903,-10778.71"/>
<polygon fill="black" stroke="black" points="2906.5,-10778.58 2903,-10768.58 2899.5,-10778.58 2906.5,-10778.58"/>
</g>
<!-- l1_attn_stage4_gpu8&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge1305" class="edge">
<title>l1_attn_stage4_gpu8&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2956.28,-10847.96C2970.42,-10841.62 2985.95,-10835.82 3001,-10832.5 3067.57,-10817.81 4163.69,-10845.12 4228,-10822.5 4238.15,-10818.93 4236.96,-10811.36 4247,-10807.5 4297.3,-10788.15 4315.53,-10811.81 4368,-10799.5 4411.2,-10789.36 4457.67,-10768.92 4489.71,-10753.17"/>
<polygon fill="red" stroke="red" points="4491.38,-10756.25 4498.77,-10748.66 4488.25,-10749.99 4491.38,-10756.25"/>
<text text-anchor="middle" x="4278.5" y="-10811.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu9 -->
<g id="node106" class="node">
<title>l1_attn_stage5_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3098" cy="-10731" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3098" y="-10742.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="3098" y="-10727.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3098" y="-10712.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu9&#45;&gt;l1_attn_stage5_gpu9 -->
<g id="edge90" class="edge">
<title>l1_attn_stage4_gpu9&#45;&gt;l1_attn_stage5_gpu9</title>
<path fill="none" stroke="black" d="M3098,-10840.41C3098,-10821.69 3098,-10798.7 3098,-10778.71"/>
<polygon fill="black" stroke="black" points="3101.5,-10778.58 3098,-10768.58 3094.5,-10778.58 3101.5,-10778.58"/>
</g>
<!-- l1_attn_stage4_gpu9&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge1306" class="edge">
<title>l1_attn_stage4_gpu9&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3151.28,-10847.97C3165.42,-10841.63 3180.95,-10835.83 3196,-10832.5 3256.65,-10819.09 4255.41,-10843.13 4314,-10822.5 4324.15,-10818.92 4323.3,-10812.14 4333,-10807.5 4347.39,-10800.61 4352.8,-10804.36 4368,-10799.5 4408.94,-10786.4 4453.95,-10767.24 4486.12,-10752.67"/>
<polygon fill="red" stroke="red" points="4487.61,-10755.84 4495.25,-10748.51 4484.7,-10749.47 4487.61,-10755.84"/>
<text text-anchor="middle" x="4364.5" y="-10811.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu10 -->
<g id="node107" class="node">
<title>l1_attn_stage5_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3293" cy="-10731" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3293" y="-10742.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="3293" y="-10727.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3293" y="-10712.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu10&#45;&gt;l1_attn_stage5_gpu10 -->
<g id="edge91" class="edge">
<title>l1_attn_stage4_gpu10&#45;&gt;l1_attn_stage5_gpu10</title>
<path fill="none" stroke="black" d="M3293,-10840.41C3293,-10821.69 3293,-10798.7 3293,-10778.71"/>
<polygon fill="black" stroke="black" points="3296.5,-10778.58 3293,-10768.58 3289.5,-10778.58 3296.5,-10778.58"/>
</g>
<!-- l1_attn_stage4_gpu10&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge1307" class="edge">
<title>l1_attn_stage4_gpu10&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3346.29,-10847.98C3360.42,-10841.64 3375.95,-10835.83 3391,-10832.5 3445.73,-10820.37 4347.13,-10841.14 4400,-10822.5 4410.15,-10818.92 4410.32,-10813.86 4419,-10807.5 4444.22,-10789 4473.5,-10769.15 4495.65,-10754.45"/>
<polygon fill="red" stroke="red" points="4497.66,-10757.32 4504.07,-10748.88 4493.8,-10751.48 4497.66,-10757.32"/>
<text text-anchor="middle" x="4450.5" y="-10811.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu11 -->
<g id="node108" class="node">
<title>l1_attn_stage5_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3488" cy="-10731" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3488" y="-10742.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="3488" y="-10727.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3488" y="-10712.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu11&#45;&gt;l1_attn_stage5_gpu11 -->
<g id="edge92" class="edge">
<title>l1_attn_stage4_gpu11&#45;&gt;l1_attn_stage5_gpu11</title>
<path fill="none" stroke="black" d="M3488,-10840.41C3488,-10821.69 3488,-10798.7 3488,-10778.71"/>
<polygon fill="black" stroke="black" points="3491.5,-10778.58 3488,-10768.58 3484.5,-10778.58 3491.5,-10778.58"/>
</g>
<!-- l1_attn_stage4_gpu11&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge1308" class="edge">
<title>l1_attn_stage4_gpu11&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3541.29,-10847.99C3555.42,-10841.65 3570.95,-10835.84 3586,-10832.5 3610.41,-10827.07 4464.88,-10835.88 4486,-10822.5 4507.94,-10808.6 4519.24,-10780.32 4524.85,-10759.05"/>
<polygon fill="red" stroke="red" points="4528.27,-10759.81 4527.18,-10749.27 4521.46,-10758.19 4528.27,-10759.81"/>
<text text-anchor="middle" x="4532.5" y="-10811.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu12 -->
<g id="node109" class="node">
<title>l1_attn_stage5_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3683" cy="-10731" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3683" y="-10742.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="3683" y="-10727.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3683" y="-10712.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu12&#45;&gt;l1_attn_stage5_gpu12 -->
<g id="edge93" class="edge">
<title>l1_attn_stage4_gpu12&#45;&gt;l1_attn_stage5_gpu12</title>
<path fill="none" stroke="black" d="M3627.85,-10848.53C3614.43,-10842.5 3599.93,-10836.69 3586,-10832.5 3572.22,-10828.35 3531.36,-10833.43 3522,-10822.5 3487.08,-10781.7 3527.79,-10821.82 3586,-10799.5 3603.78,-10792.68 3621.42,-10781.93 3636.68,-10771"/>
<polygon fill="black" stroke="black" points="3638.93,-10773.69 3644.9,-10764.94 3634.77,-10768.06 3638.93,-10773.69"/>
</g>
<!-- l1_attn_stage4_gpu12&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge1309" class="edge">
<title>l1_attn_stage4_gpu12&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3736.29,-10848.01C3750.43,-10841.67 3765.95,-10835.85 3781,-10832.5 3802.45,-10827.71 4556.56,-10838.13 4572,-10822.5 4590.16,-10804.11 4572.89,-10776.42 4555.31,-10756.51"/>
<polygon fill="red" stroke="red" points="4557.75,-10753.99 4548.38,-10749.03 4552.61,-10758.75 4557.75,-10753.99"/>
<text text-anchor="middle" x="4610.5" y="-10811.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu13 -->
<g id="node110" class="node">
<title>l1_attn_stage5_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3878" cy="-10731" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3878" y="-10742.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="3878" y="-10727.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3878" y="-10712.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu13&#45;&gt;l1_attn_stage5_gpu13 -->
<g id="edge94" class="edge">
<title>l1_attn_stage4_gpu13&#45;&gt;l1_attn_stage5_gpu13</title>
<path fill="none" stroke="black" d="M3824.7,-10848.06C3810.85,-10841.8 3795.69,-10836.01 3781,-10832.5 3767.37,-10829.24 3538.71,-10832.6 3529,-10822.5 3524.38,-10817.69 3524.36,-10812.29 3529,-10807.5 3538.75,-10797.44 3767.7,-10803.9 3781,-10799.5 3799.4,-10793.4 3817.44,-10782.61 3832.87,-10771.42"/>
<polygon fill="black" stroke="black" points="3835.27,-10773.99 3841.16,-10765.19 3831.06,-10768.4 3835.27,-10773.99"/>
</g>
<!-- l1_attn_stage4_gpu13&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge1310" class="edge">
<title>l1_attn_stage4_gpu13&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3931.3,-10848.03C3945.43,-10841.69 3960.96,-10835.87 3976,-10832.5 3994.49,-10828.35 4644.7,-10835.99 4658,-10822.5 4686.36,-10793.72 4638.79,-10767.89 4593.82,-10751.26"/>
<polygon fill="red" stroke="red" points="4594.88,-10747.93 4584.29,-10747.86 4592.53,-10754.52 4594.88,-10747.93"/>
<text text-anchor="middle" x="4697.5" y="-10811.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu14 -->
<g id="node111" class="node">
<title>l1_attn_stage5_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4073" cy="-10731" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4073" y="-10742.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="4073" y="-10727.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4073" y="-10712.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu14&#45;&gt;l1_attn_stage5_gpu14 -->
<g id="edge95" class="edge">
<title>l1_attn_stage4_gpu14&#45;&gt;l1_attn_stage5_gpu14</title>
<path fill="none" stroke="black" d="M4019.74,-10847.88C4005.89,-10841.63 3990.71,-10835.89 3976,-10832.5 3952.17,-10827.01 3553.09,-10839.98 3536,-10822.5 3531.34,-10817.73 3531.33,-10812.25 3536,-10807.5 3544.56,-10798.78 3964.37,-10803.26 3976,-10799.5 3994.45,-10793.53 4012.49,-10782.77 4027.92,-10771.57"/>
<polygon fill="black" stroke="black" points="4030.32,-10774.14 4036.2,-10765.33 4026.11,-10768.54 4030.32,-10774.14"/>
</g>
<!-- l1_attn_stage4_gpu14&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge1311" class="edge">
<title>l1_attn_stage4_gpu14&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4126.3,-10848.06C4140.44,-10841.72 4155.96,-10835.89 4171,-10832.5 4186.53,-10829 4732.84,-10833.85 4744,-10822.5 4784.03,-10781.76 4714.32,-10758.4 4644.01,-10745.66"/>
<polygon fill="red" stroke="red" points="4644.55,-10742.2 4634.1,-10743.93 4643.35,-10749.1 4644.55,-10742.2"/>
<text text-anchor="middle" x="4784.5" y="-10811.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage5_gpu15 -->
<g id="node112" class="node">
<title>l1_attn_stage5_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4268" cy="-10731" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4268" y="-10742.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage5</text>
<text text-anchor="middle" x="4268" y="-10727.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4268" y="-10712.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage4_gpu15&#45;&gt;l1_attn_stage5_gpu15 -->
<g id="edge96" class="edge">
<title>l1_attn_stage4_gpu15&#45;&gt;l1_attn_stage5_gpu15</title>
<path fill="none" stroke="black" d="M4215.02,-10847.93C4201.09,-10841.63 4185.82,-10835.86 4171,-10832.5 4153.99,-10828.64 3555.24,-10834.93 3543,-10822.5 3538.32,-10817.75 3538.32,-10812.24 3543,-10807.5 3555.26,-10795.08 4154.39,-10804.83 4171,-10799.5 4189.46,-10793.58 4207.51,-10782.83 4222.94,-10771.63"/>
<polygon fill="black" stroke="black" points="4225.34,-10774.2 4231.22,-10765.38 4221.13,-10768.6 4225.34,-10774.2"/>
</g>
<!-- l1_attn_stage4_gpu15&#45;&gt;l1_attn_stage5_gpu[next_gpu] -->
<g id="edge1312" class="edge">
<title>l1_attn_stage4_gpu15&#45;&gt;l1_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4323.38,-10848.68C4338.74,-10842.12 4355.68,-10836.03 4372,-10832.5 4396.87,-10827.12 4812.2,-10840.69 4830,-10822.5 4884.67,-10766.62 4783.45,-10744.96 4684.12,-10736.71"/>
<polygon fill="red" stroke="red" points="4684.15,-10733.2 4673.9,-10735.9 4683.6,-10740.18 4684.15,-10733.2"/>
<text text-anchor="middle" x="4870.5" y="-10811.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu0 -->
<g id="node113" class="node">
<title>l1_attn_stage6_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1343" cy="-10584" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1343" y="-10595.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="1343" y="-10580.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1343" y="-10565.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu0&#45;&gt;l1_attn_stage6_gpu0 -->
<g id="edge97" class="edge">
<title>l1_attn_stage5_gpu0&#45;&gt;l1_attn_stage6_gpu0</title>
<path fill="none" stroke="black" d="M1343,-10693.41C1343,-10674.69 1343,-10651.7 1343,-10631.71"/>
<polygon fill="black" stroke="black" points="1346.5,-10631.58 1343,-10621.58 1339.5,-10631.58 1346.5,-10631.58"/>
</g>
<!-- l1_attn_stage6_gpu[next_gpu] -->
<g id="node1318" class="node">
<title>l1_attn_stage6_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4530" cy="-10584" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4530" y="-10580.3" font-family="Times,serif" font-size="14.00">l1_attn_stage6_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage5_gpu0&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge1313" class="edge">
<title>l1_attn_stage5_gpu0&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1396.29,-10701C1410.43,-10694.66 1425.95,-10688.85 1441,-10685.5 1670.73,-10634.36 3323.66,-10663.05 3559,-10660.5 3603.94,-10660.01 4323.97,-10661.53 4368,-10652.5 4411.87,-10643.5 4458.77,-10622.58 4490.76,-10606.4"/>
<polygon fill="red" stroke="red" points="4492.49,-10609.44 4499.78,-10601.76 4489.28,-10603.22 4492.49,-10609.44"/>
<text text-anchor="middle" x="3590.5" y="-10664.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu1 -->
<g id="node114" class="node">
<title>l1_attn_stage6_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1538" cy="-10584" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1538" y="-10595.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="1538" y="-10580.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1538" y="-10565.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu1&#45;&gt;l1_attn_stage6_gpu1 -->
<g id="edge98" class="edge">
<title>l1_attn_stage5_gpu1&#45;&gt;l1_attn_stage6_gpu1</title>
<path fill="none" stroke="black" d="M1538,-10693.41C1538,-10674.69 1538,-10651.7 1538,-10631.71"/>
<polygon fill="black" stroke="black" points="1541.5,-10631.58 1538,-10621.58 1534.5,-10631.58 1541.5,-10631.58"/>
</g>
<!-- l1_attn_stage5_gpu1&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge1314" class="edge">
<title>l1_attn_stage5_gpu1&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1591.28,-10700.93C1605.41,-10694.59 1620.94,-10688.8 1636,-10685.5 1690,-10673.67 3573.82,-10693.76 3626,-10675.5 3636.15,-10671.94 3634.86,-10664.08 3645,-10660.5 3682.87,-10647.11 4328.66,-10660.59 4368,-10652.5 4411.87,-10643.47 4458.77,-10622.56 4490.76,-10606.38"/>
<polygon fill="red" stroke="red" points="4492.48,-10609.43 4499.78,-10601.75 4489.28,-10603.2 4492.48,-10609.43"/>
<text text-anchor="middle" x="3676.5" y="-10664.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu2 -->
<g id="node115" class="node">
<title>l1_attn_stage6_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1733" cy="-10584" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1733" y="-10595.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="1733" y="-10580.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1733" y="-10565.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu2&#45;&gt;l1_attn_stage6_gpu2 -->
<g id="edge99" class="edge">
<title>l1_attn_stage5_gpu2&#45;&gt;l1_attn_stage6_gpu2</title>
<path fill="none" stroke="black" d="M1733,-10693.41C1733,-10674.69 1733,-10651.7 1733,-10631.71"/>
<polygon fill="black" stroke="black" points="1736.5,-10631.58 1733,-10621.58 1729.5,-10631.58 1736.5,-10631.58"/>
</g>
<!-- l1_attn_stage5_gpu2&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge1315" class="edge">
<title>l1_attn_stage5_gpu2&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1786.28,-10700.93C1800.41,-10694.59 1815.94,-10688.8 1831,-10685.5 1882.04,-10674.31 3662.68,-10692.77 3712,-10675.5 3722.15,-10671.94 3720.86,-10664.09 3731,-10660.5 3764.36,-10648.68 4333.34,-10659.66 4368,-10652.5 4411.86,-10643.44 4458.76,-10622.53 4490.75,-10606.36"/>
<polygon fill="red" stroke="red" points="4492.48,-10609.41 4499.77,-10601.73 4489.28,-10603.19 4492.48,-10609.41"/>
<text text-anchor="middle" x="3762.5" y="-10664.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu3 -->
<g id="node116" class="node">
<title>l1_attn_stage6_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1928" cy="-10584" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1928" y="-10595.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="1928" y="-10580.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1928" y="-10565.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu3&#45;&gt;l1_attn_stage6_gpu3 -->
<g id="edge100" class="edge">
<title>l1_attn_stage5_gpu3&#45;&gt;l1_attn_stage6_gpu3</title>
<path fill="none" stroke="black" d="M1928,-10693.41C1928,-10674.69 1928,-10651.7 1928,-10631.71"/>
<polygon fill="black" stroke="black" points="1931.5,-10631.58 1928,-10621.58 1924.5,-10631.58 1931.5,-10631.58"/>
</g>
<!-- l1_attn_stage5_gpu3&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge1316" class="edge">
<title>l1_attn_stage5_gpu3&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1981.28,-10700.94C1995.41,-10694.6 2010.94,-10688.8 2026,-10685.5 2074.08,-10674.95 3751.55,-10691.77 3798,-10675.5 3808.15,-10671.94 3806.86,-10664.1 3817,-10660.5 3845.85,-10650.25 4338.02,-10658.72 4368,-10652.5 4411.85,-10643.4 4458.75,-10622.49 4490.75,-10606.34"/>
<polygon fill="red" stroke="red" points="4492.47,-10609.39 4499.77,-10601.71 4489.27,-10603.16 4492.47,-10609.39"/>
<text text-anchor="middle" x="3848.5" y="-10664.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu4 -->
<g id="node117" class="node">
<title>l1_attn_stage6_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2123" cy="-10584" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2123" y="-10595.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="2123" y="-10580.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2123" y="-10565.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu4&#45;&gt;l1_attn_stage6_gpu4 -->
<g id="edge101" class="edge">
<title>l1_attn_stage5_gpu4&#45;&gt;l1_attn_stage6_gpu4</title>
<path fill="none" stroke="black" d="M2123,-10693.41C2123,-10674.69 2123,-10651.7 2123,-10631.71"/>
<polygon fill="black" stroke="black" points="2126.5,-10631.58 2123,-10621.58 2119.5,-10631.58 2126.5,-10631.58"/>
</g>
<!-- l1_attn_stage5_gpu4&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge1317" class="edge">
<title>l1_attn_stage5_gpu4&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2176.28,-10700.94C2190.41,-10694.6 2205.94,-10688.8 2221,-10685.5 2266.12,-10675.59 3840.41,-10690.78 3884,-10675.5 3894.15,-10671.94 3892.87,-10664.11 3903,-10660.5 3951.67,-10643.13 4317.42,-10663.07 4368,-10652.5 4411.84,-10643.34 4458.74,-10622.44 4490.74,-10606.31"/>
<polygon fill="red" stroke="red" points="4492.46,-10609.36 4499.76,-10601.69 4489.27,-10603.13 4492.46,-10609.36"/>
<text text-anchor="middle" x="3934.5" y="-10664.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu5 -->
<g id="node118" class="node">
<title>l1_attn_stage6_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2318" cy="-10584" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2318" y="-10595.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="2318" y="-10580.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2318" y="-10565.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu5&#45;&gt;l1_attn_stage6_gpu5 -->
<g id="edge102" class="edge">
<title>l1_attn_stage5_gpu5&#45;&gt;l1_attn_stage6_gpu5</title>
<path fill="none" stroke="black" d="M2318,-10693.41C2318,-10674.69 2318,-10651.7 2318,-10631.71"/>
<polygon fill="black" stroke="black" points="2321.5,-10631.58 2318,-10621.58 2314.5,-10631.58 2321.5,-10631.58"/>
</g>
<!-- l1_attn_stage5_gpu5&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge1318" class="edge">
<title>l1_attn_stage5_gpu5&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2371.28,-10700.94C2385.41,-10694.6 2400.94,-10688.81 2416,-10685.5 2458.16,-10676.23 3929.27,-10689.79 3970,-10675.5 3980.15,-10671.94 3978.87,-10664.13 3989,-10660.5 4028.64,-10646.26 4326.79,-10661.19 4368,-10652.5 4411.82,-10643.25 4458.73,-10622.37 4490.73,-10606.26"/>
<polygon fill="red" stroke="red" points="4492.45,-10609.32 4499.75,-10601.65 4489.26,-10603.08 4492.45,-10609.32"/>
<text text-anchor="middle" x="4020.5" y="-10664.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu6 -->
<g id="node119" class="node">
<title>l1_attn_stage6_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2513" cy="-10584" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2513" y="-10595.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="2513" y="-10580.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2513" y="-10565.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu6&#45;&gt;l1_attn_stage6_gpu6 -->
<g id="edge103" class="edge">
<title>l1_attn_stage5_gpu6&#45;&gt;l1_attn_stage6_gpu6</title>
<path fill="none" stroke="black" d="M2513,-10693.41C2513,-10674.69 2513,-10651.7 2513,-10631.71"/>
<polygon fill="black" stroke="black" points="2516.5,-10631.58 2513,-10621.58 2509.5,-10631.58 2516.5,-10631.58"/>
</g>
<!-- l1_attn_stage5_gpu6&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge1319" class="edge">
<title>l1_attn_stage5_gpu6&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2566.28,-10700.95C2580.41,-10694.61 2595.94,-10688.81 2611,-10685.5 2650.2,-10676.87 4018.13,-10688.79 4056,-10675.5 4066.15,-10671.93 4064.89,-10664.16 4075,-10660.5 4105.62,-10649.4 4336.15,-10659.32 4368,-10652.5 4411.66,-10643.15 4458.41,-10622.38 4490.42,-10606.34"/>
<polygon fill="red" stroke="red" points="4492.12,-10609.4 4499.45,-10601.74 4488.95,-10603.16 4492.12,-10609.4"/>
<text text-anchor="middle" x="4106.5" y="-10664.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu7 -->
<g id="node120" class="node">
<title>l1_attn_stage6_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2708" cy="-10584" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2708" y="-10595.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="2708" y="-10580.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2708" y="-10565.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu7&#45;&gt;l1_attn_stage6_gpu7 -->
<g id="edge104" class="edge">
<title>l1_attn_stage5_gpu7&#45;&gt;l1_attn_stage6_gpu7</title>
<path fill="none" stroke="black" d="M2708,-10693.41C2708,-10674.69 2708,-10651.7 2708,-10631.71"/>
<polygon fill="black" stroke="black" points="2711.5,-10631.58 2708,-10621.58 2704.5,-10631.58 2711.5,-10631.58"/>
</g>
<!-- l1_attn_stage5_gpu7&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge1320" class="edge">
<title>l1_attn_stage5_gpu7&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2761.28,-10700.95C2775.42,-10694.62 2790.95,-10688.81 2806,-10685.5 2842.24,-10677.51 4106.99,-10687.8 4142,-10675.5 4152.15,-10671.93 4150.91,-10664.22 4161,-10660.5 4204.19,-10644.56 4323.04,-10662.4 4368,-10652.5 4411.6,-10642.9 4458.37,-10622.17 4490.39,-10606.2"/>
<polygon fill="red" stroke="red" points="4492.08,-10609.27 4499.42,-10601.63 4488.92,-10603.02 4492.08,-10609.27"/>
<text text-anchor="middle" x="4192.5" y="-10664.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu8 -->
<g id="node121" class="node">
<title>l1_attn_stage6_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2903" cy="-10584" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2903" y="-10595.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="2903" y="-10580.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2903" y="-10565.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu8&#45;&gt;l1_attn_stage6_gpu8 -->
<g id="edge105" class="edge">
<title>l1_attn_stage5_gpu8&#45;&gt;l1_attn_stage6_gpu8</title>
<path fill="none" stroke="black" d="M2903,-10693.41C2903,-10674.69 2903,-10651.7 2903,-10631.71"/>
<polygon fill="black" stroke="black" points="2906.5,-10631.58 2903,-10621.58 2899.5,-10631.58 2906.5,-10631.58"/>
</g>
<!-- l1_attn_stage5_gpu8&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge1321" class="edge">
<title>l1_attn_stage5_gpu8&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2956.28,-10700.96C2970.42,-10694.62 2985.95,-10688.82 3001,-10685.5 3067.57,-10670.81 4163.69,-10698.12 4228,-10675.5 4238.15,-10671.93 4236.96,-10664.36 4247,-10660.5 4297.3,-10641.15 4315.53,-10664.81 4368,-10652.5 4411.2,-10642.36 4457.67,-10621.92 4489.71,-10606.17"/>
<polygon fill="red" stroke="red" points="4491.38,-10609.25 4498.77,-10601.66 4488.25,-10602.99 4491.38,-10609.25"/>
<text text-anchor="middle" x="4278.5" y="-10664.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu9 -->
<g id="node122" class="node">
<title>l1_attn_stage6_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3098" cy="-10584" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3098" y="-10595.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="3098" y="-10580.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3098" y="-10565.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu9&#45;&gt;l1_attn_stage6_gpu9 -->
<g id="edge106" class="edge">
<title>l1_attn_stage5_gpu9&#45;&gt;l1_attn_stage6_gpu9</title>
<path fill="none" stroke="black" d="M3098,-10693.41C3098,-10674.69 3098,-10651.7 3098,-10631.71"/>
<polygon fill="black" stroke="black" points="3101.5,-10631.58 3098,-10621.58 3094.5,-10631.58 3101.5,-10631.58"/>
</g>
<!-- l1_attn_stage5_gpu9&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge1322" class="edge">
<title>l1_attn_stage5_gpu9&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3151.28,-10700.97C3165.42,-10694.63 3180.95,-10688.83 3196,-10685.5 3256.65,-10672.09 4255.41,-10696.13 4314,-10675.5 4324.15,-10671.92 4323.3,-10665.14 4333,-10660.5 4347.39,-10653.61 4352.8,-10657.36 4368,-10652.5 4408.94,-10639.4 4453.95,-10620.24 4486.12,-10605.67"/>
<polygon fill="red" stroke="red" points="4487.61,-10608.84 4495.25,-10601.51 4484.7,-10602.47 4487.61,-10608.84"/>
<text text-anchor="middle" x="4364.5" y="-10664.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu10 -->
<g id="node123" class="node">
<title>l1_attn_stage6_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3293" cy="-10584" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3293" y="-10595.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="3293" y="-10580.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3293" y="-10565.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu10&#45;&gt;l1_attn_stage6_gpu10 -->
<g id="edge107" class="edge">
<title>l1_attn_stage5_gpu10&#45;&gt;l1_attn_stage6_gpu10</title>
<path fill="none" stroke="black" d="M3293,-10693.41C3293,-10674.69 3293,-10651.7 3293,-10631.71"/>
<polygon fill="black" stroke="black" points="3296.5,-10631.58 3293,-10621.58 3289.5,-10631.58 3296.5,-10631.58"/>
</g>
<!-- l1_attn_stage5_gpu10&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge1323" class="edge">
<title>l1_attn_stage5_gpu10&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3346.29,-10700.98C3360.42,-10694.64 3375.95,-10688.83 3391,-10685.5 3445.73,-10673.37 4347.13,-10694.14 4400,-10675.5 4410.15,-10671.92 4410.32,-10666.86 4419,-10660.5 4444.22,-10642 4473.5,-10622.15 4495.65,-10607.45"/>
<polygon fill="red" stroke="red" points="4497.66,-10610.32 4504.07,-10601.88 4493.8,-10604.48 4497.66,-10610.32"/>
<text text-anchor="middle" x="4450.5" y="-10664.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu11 -->
<g id="node124" class="node">
<title>l1_attn_stage6_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3488" cy="-10584" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3488" y="-10595.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="3488" y="-10580.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3488" y="-10565.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu11&#45;&gt;l1_attn_stage6_gpu11 -->
<g id="edge108" class="edge">
<title>l1_attn_stage5_gpu11&#45;&gt;l1_attn_stage6_gpu11</title>
<path fill="none" stroke="black" d="M3488,-10693.41C3488,-10674.69 3488,-10651.7 3488,-10631.71"/>
<polygon fill="black" stroke="black" points="3491.5,-10631.58 3488,-10621.58 3484.5,-10631.58 3491.5,-10631.58"/>
</g>
<!-- l1_attn_stage5_gpu11&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge1324" class="edge">
<title>l1_attn_stage5_gpu11&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3541.29,-10700.99C3555.42,-10694.65 3570.95,-10688.84 3586,-10685.5 3610.41,-10680.07 4464.88,-10688.88 4486,-10675.5 4507.94,-10661.6 4519.24,-10633.32 4524.85,-10612.05"/>
<polygon fill="red" stroke="red" points="4528.27,-10612.81 4527.18,-10602.27 4521.46,-10611.19 4528.27,-10612.81"/>
<text text-anchor="middle" x="4532.5" y="-10664.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu12 -->
<g id="node125" class="node">
<title>l1_attn_stage6_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3683" cy="-10584" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3683" y="-10595.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="3683" y="-10580.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3683" y="-10565.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu12&#45;&gt;l1_attn_stage6_gpu12 -->
<g id="edge109" class="edge">
<title>l1_attn_stage5_gpu12&#45;&gt;l1_attn_stage6_gpu12</title>
<path fill="none" stroke="black" d="M3627.85,-10701.53C3614.43,-10695.5 3599.93,-10689.69 3586,-10685.5 3572.22,-10681.35 3531.36,-10686.43 3522,-10675.5 3487.08,-10634.7 3527.79,-10674.82 3586,-10652.5 3603.78,-10645.68 3621.42,-10634.93 3636.68,-10624"/>
<polygon fill="black" stroke="black" points="3638.93,-10626.69 3644.9,-10617.94 3634.77,-10621.06 3638.93,-10626.69"/>
</g>
<!-- l1_attn_stage5_gpu12&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge1325" class="edge">
<title>l1_attn_stage5_gpu12&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3736.29,-10701.01C3750.43,-10694.67 3765.95,-10688.85 3781,-10685.5 3802.45,-10680.71 4556.56,-10691.13 4572,-10675.5 4590.16,-10657.11 4572.89,-10629.42 4555.31,-10609.51"/>
<polygon fill="red" stroke="red" points="4557.75,-10606.99 4548.38,-10602.03 4552.61,-10611.75 4557.75,-10606.99"/>
<text text-anchor="middle" x="4610.5" y="-10664.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu13 -->
<g id="node126" class="node">
<title>l1_attn_stage6_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3878" cy="-10584" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3878" y="-10595.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="3878" y="-10580.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3878" y="-10565.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu13&#45;&gt;l1_attn_stage6_gpu13 -->
<g id="edge110" class="edge">
<title>l1_attn_stage5_gpu13&#45;&gt;l1_attn_stage6_gpu13</title>
<path fill="none" stroke="black" d="M3824.7,-10701.06C3810.85,-10694.8 3795.69,-10689.01 3781,-10685.5 3767.37,-10682.24 3538.71,-10685.6 3529,-10675.5 3524.38,-10670.69 3524.36,-10665.29 3529,-10660.5 3538.75,-10650.44 3767.7,-10656.9 3781,-10652.5 3799.4,-10646.4 3817.44,-10635.61 3832.87,-10624.42"/>
<polygon fill="black" stroke="black" points="3835.27,-10626.99 3841.16,-10618.19 3831.06,-10621.4 3835.27,-10626.99"/>
</g>
<!-- l1_attn_stage5_gpu13&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge1326" class="edge">
<title>l1_attn_stage5_gpu13&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3931.3,-10701.03C3945.43,-10694.69 3960.96,-10688.87 3976,-10685.5 3994.49,-10681.35 4644.7,-10688.99 4658,-10675.5 4686.36,-10646.72 4638.79,-10620.89 4593.82,-10604.26"/>
<polygon fill="red" stroke="red" points="4594.88,-10600.93 4584.29,-10600.86 4592.53,-10607.52 4594.88,-10600.93"/>
<text text-anchor="middle" x="4697.5" y="-10664.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu14 -->
<g id="node127" class="node">
<title>l1_attn_stage6_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4073" cy="-10584" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4073" y="-10595.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="4073" y="-10580.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4073" y="-10565.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu14&#45;&gt;l1_attn_stage6_gpu14 -->
<g id="edge111" class="edge">
<title>l1_attn_stage5_gpu14&#45;&gt;l1_attn_stage6_gpu14</title>
<path fill="none" stroke="black" d="M4019.74,-10700.88C4005.89,-10694.63 3990.71,-10688.89 3976,-10685.5 3952.17,-10680.01 3553.09,-10692.98 3536,-10675.5 3531.34,-10670.73 3531.33,-10665.25 3536,-10660.5 3544.56,-10651.78 3964.37,-10656.26 3976,-10652.5 3994.45,-10646.53 4012.49,-10635.77 4027.92,-10624.57"/>
<polygon fill="black" stroke="black" points="4030.32,-10627.14 4036.2,-10618.33 4026.11,-10621.54 4030.32,-10627.14"/>
</g>
<!-- l1_attn_stage5_gpu14&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge1327" class="edge">
<title>l1_attn_stage5_gpu14&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4126.3,-10701.06C4140.44,-10694.72 4155.96,-10688.89 4171,-10685.5 4186.53,-10682 4732.84,-10686.85 4744,-10675.5 4784.03,-10634.76 4714.32,-10611.4 4644.01,-10598.66"/>
<polygon fill="red" stroke="red" points="4644.55,-10595.2 4634.1,-10596.93 4643.35,-10602.1 4644.55,-10595.2"/>
<text text-anchor="middle" x="4784.5" y="-10664.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage6_gpu15 -->
<g id="node128" class="node">
<title>l1_attn_stage6_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4268" cy="-10584" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4268" y="-10595.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage6</text>
<text text-anchor="middle" x="4268" y="-10580.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4268" y="-10565.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage5_gpu15&#45;&gt;l1_attn_stage6_gpu15 -->
<g id="edge112" class="edge">
<title>l1_attn_stage5_gpu15&#45;&gt;l1_attn_stage6_gpu15</title>
<path fill="none" stroke="black" d="M4215.02,-10700.93C4201.09,-10694.63 4185.82,-10688.86 4171,-10685.5 4153.99,-10681.64 3555.24,-10687.93 3543,-10675.5 3538.32,-10670.75 3538.32,-10665.24 3543,-10660.5 3555.26,-10648.08 4154.39,-10657.83 4171,-10652.5 4189.46,-10646.58 4207.51,-10635.83 4222.94,-10624.63"/>
<polygon fill="black" stroke="black" points="4225.34,-10627.2 4231.22,-10618.38 4221.13,-10621.6 4225.34,-10627.2"/>
</g>
<!-- l1_attn_stage5_gpu15&#45;&gt;l1_attn_stage6_gpu[next_gpu] -->
<g id="edge1328" class="edge">
<title>l1_attn_stage5_gpu15&#45;&gt;l1_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4323.38,-10701.68C4338.74,-10695.12 4355.68,-10689.03 4372,-10685.5 4396.87,-10680.12 4812.2,-10693.69 4830,-10675.5 4884.67,-10619.62 4783.45,-10597.96 4684.12,-10589.71"/>
<polygon fill="red" stroke="red" points="4684.15,-10586.2 4673.9,-10588.9 4683.6,-10593.18 4684.15,-10586.2"/>
<text text-anchor="middle" x="4870.5" y="-10664.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu0 -->
<g id="node129" class="node">
<title>l1_attn_stage7_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1343" cy="-10437" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1343" y="-10448.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="1343" y="-10433.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1343" y="-10418.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu0&#45;&gt;l1_attn_stage7_gpu0 -->
<g id="edge113" class="edge">
<title>l1_attn_stage6_gpu0&#45;&gt;l1_attn_stage7_gpu0</title>
<path fill="none" stroke="black" d="M1343,-10546.41C1343,-10527.69 1343,-10504.7 1343,-10484.71"/>
<polygon fill="black" stroke="black" points="1346.5,-10484.58 1343,-10474.58 1339.5,-10484.58 1346.5,-10484.58"/>
</g>
<!-- l1_attn_stage7_gpu[next_gpu] -->
<g id="node1319" class="node">
<title>l1_attn_stage7_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4530" cy="-10437" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4530" y="-10433.3" font-family="Times,serif" font-size="14.00">l1_attn_stage7_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage6_gpu0&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge1329" class="edge">
<title>l1_attn_stage6_gpu0&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1396.29,-10554C1410.43,-10547.66 1425.95,-10541.85 1441,-10538.5 1670.73,-10487.36 3323.66,-10516.05 3559,-10513.5 3603.94,-10513.01 4323.97,-10514.53 4368,-10505.5 4411.87,-10496.5 4458.77,-10475.58 4490.76,-10459.4"/>
<polygon fill="red" stroke="red" points="4492.49,-10462.44 4499.78,-10454.76 4489.28,-10456.22 4492.49,-10462.44"/>
<text text-anchor="middle" x="3590.5" y="-10517.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu1 -->
<g id="node130" class="node">
<title>l1_attn_stage7_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1538" cy="-10437" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1538" y="-10448.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="1538" y="-10433.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1538" y="-10418.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu1&#45;&gt;l1_attn_stage7_gpu1 -->
<g id="edge114" class="edge">
<title>l1_attn_stage6_gpu1&#45;&gt;l1_attn_stage7_gpu1</title>
<path fill="none" stroke="black" d="M1538,-10546.41C1538,-10527.69 1538,-10504.7 1538,-10484.71"/>
<polygon fill="black" stroke="black" points="1541.5,-10484.58 1538,-10474.58 1534.5,-10484.58 1541.5,-10484.58"/>
</g>
<!-- l1_attn_stage6_gpu1&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge1330" class="edge">
<title>l1_attn_stage6_gpu1&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1591.28,-10553.93C1605.41,-10547.59 1620.94,-10541.8 1636,-10538.5 1690,-10526.67 3573.82,-10546.76 3626,-10528.5 3636.15,-10524.94 3634.86,-10517.08 3645,-10513.5 3682.87,-10500.11 4328.66,-10513.59 4368,-10505.5 4411.87,-10496.47 4458.77,-10475.56 4490.76,-10459.38"/>
<polygon fill="red" stroke="red" points="4492.48,-10462.43 4499.78,-10454.75 4489.28,-10456.2 4492.48,-10462.43"/>
<text text-anchor="middle" x="3676.5" y="-10517.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu2 -->
<g id="node131" class="node">
<title>l1_attn_stage7_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1733" cy="-10437" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1733" y="-10448.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="1733" y="-10433.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1733" y="-10418.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu2&#45;&gt;l1_attn_stage7_gpu2 -->
<g id="edge115" class="edge">
<title>l1_attn_stage6_gpu2&#45;&gt;l1_attn_stage7_gpu2</title>
<path fill="none" stroke="black" d="M1733,-10546.41C1733,-10527.69 1733,-10504.7 1733,-10484.71"/>
<polygon fill="black" stroke="black" points="1736.5,-10484.58 1733,-10474.58 1729.5,-10484.58 1736.5,-10484.58"/>
</g>
<!-- l1_attn_stage6_gpu2&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge1331" class="edge">
<title>l1_attn_stage6_gpu2&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1786.28,-10553.93C1800.41,-10547.59 1815.94,-10541.8 1831,-10538.5 1882.04,-10527.31 3662.68,-10545.77 3712,-10528.5 3722.15,-10524.94 3720.86,-10517.09 3731,-10513.5 3764.36,-10501.68 4333.34,-10512.66 4368,-10505.5 4411.86,-10496.44 4458.76,-10475.53 4490.75,-10459.36"/>
<polygon fill="red" stroke="red" points="4492.48,-10462.41 4499.77,-10454.73 4489.28,-10456.19 4492.48,-10462.41"/>
<text text-anchor="middle" x="3762.5" y="-10517.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu3 -->
<g id="node132" class="node">
<title>l1_attn_stage7_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1928" cy="-10437" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1928" y="-10448.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="1928" y="-10433.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1928" y="-10418.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu3&#45;&gt;l1_attn_stage7_gpu3 -->
<g id="edge116" class="edge">
<title>l1_attn_stage6_gpu3&#45;&gt;l1_attn_stage7_gpu3</title>
<path fill="none" stroke="black" d="M1928,-10546.41C1928,-10527.69 1928,-10504.7 1928,-10484.71"/>
<polygon fill="black" stroke="black" points="1931.5,-10484.58 1928,-10474.58 1924.5,-10484.58 1931.5,-10484.58"/>
</g>
<!-- l1_attn_stage6_gpu3&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge1332" class="edge">
<title>l1_attn_stage6_gpu3&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1981.28,-10553.94C1995.41,-10547.6 2010.94,-10541.8 2026,-10538.5 2074.08,-10527.95 3751.55,-10544.77 3798,-10528.5 3808.15,-10524.94 3806.86,-10517.1 3817,-10513.5 3845.85,-10503.25 4338.02,-10511.72 4368,-10505.5 4411.85,-10496.4 4458.75,-10475.49 4490.75,-10459.34"/>
<polygon fill="red" stroke="red" points="4492.47,-10462.39 4499.77,-10454.71 4489.27,-10456.16 4492.47,-10462.39"/>
<text text-anchor="middle" x="3848.5" y="-10517.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu4 -->
<g id="node133" class="node">
<title>l1_attn_stage7_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2123" cy="-10437" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2123" y="-10448.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="2123" y="-10433.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2123" y="-10418.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu4&#45;&gt;l1_attn_stage7_gpu4 -->
<g id="edge117" class="edge">
<title>l1_attn_stage6_gpu4&#45;&gt;l1_attn_stage7_gpu4</title>
<path fill="none" stroke="black" d="M2123,-10546.41C2123,-10527.69 2123,-10504.7 2123,-10484.71"/>
<polygon fill="black" stroke="black" points="2126.5,-10484.58 2123,-10474.58 2119.5,-10484.58 2126.5,-10484.58"/>
</g>
<!-- l1_attn_stage6_gpu4&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge1333" class="edge">
<title>l1_attn_stage6_gpu4&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2176.28,-10553.94C2190.41,-10547.6 2205.94,-10541.8 2221,-10538.5 2266.12,-10528.59 3840.41,-10543.78 3884,-10528.5 3894.15,-10524.94 3892.87,-10517.11 3903,-10513.5 3951.67,-10496.13 4317.42,-10516.07 4368,-10505.5 4411.84,-10496.34 4458.74,-10475.44 4490.74,-10459.31"/>
<polygon fill="red" stroke="red" points="4492.46,-10462.36 4499.76,-10454.69 4489.27,-10456.13 4492.46,-10462.36"/>
<text text-anchor="middle" x="3934.5" y="-10517.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu5 -->
<g id="node134" class="node">
<title>l1_attn_stage7_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2318" cy="-10437" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2318" y="-10448.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="2318" y="-10433.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2318" y="-10418.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu5&#45;&gt;l1_attn_stage7_gpu5 -->
<g id="edge118" class="edge">
<title>l1_attn_stage6_gpu5&#45;&gt;l1_attn_stage7_gpu5</title>
<path fill="none" stroke="black" d="M2318,-10546.41C2318,-10527.69 2318,-10504.7 2318,-10484.71"/>
<polygon fill="black" stroke="black" points="2321.5,-10484.58 2318,-10474.58 2314.5,-10484.58 2321.5,-10484.58"/>
</g>
<!-- l1_attn_stage6_gpu5&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge1334" class="edge">
<title>l1_attn_stage6_gpu5&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2371.28,-10553.94C2385.41,-10547.6 2400.94,-10541.81 2416,-10538.5 2458.16,-10529.23 3929.27,-10542.79 3970,-10528.5 3980.15,-10524.94 3978.87,-10517.13 3989,-10513.5 4028.64,-10499.26 4326.79,-10514.19 4368,-10505.5 4411.82,-10496.25 4458.73,-10475.37 4490.73,-10459.26"/>
<polygon fill="red" stroke="red" points="4492.45,-10462.32 4499.75,-10454.65 4489.26,-10456.08 4492.45,-10462.32"/>
<text text-anchor="middle" x="4020.5" y="-10517.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu6 -->
<g id="node135" class="node">
<title>l1_attn_stage7_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2513" cy="-10437" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2513" y="-10448.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="2513" y="-10433.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2513" y="-10418.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu6&#45;&gt;l1_attn_stage7_gpu6 -->
<g id="edge119" class="edge">
<title>l1_attn_stage6_gpu6&#45;&gt;l1_attn_stage7_gpu6</title>
<path fill="none" stroke="black" d="M2513,-10546.41C2513,-10527.69 2513,-10504.7 2513,-10484.71"/>
<polygon fill="black" stroke="black" points="2516.5,-10484.58 2513,-10474.58 2509.5,-10484.58 2516.5,-10484.58"/>
</g>
<!-- l1_attn_stage6_gpu6&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge1335" class="edge">
<title>l1_attn_stage6_gpu6&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2566.28,-10553.95C2580.41,-10547.61 2595.94,-10541.81 2611,-10538.5 2650.2,-10529.87 4018.13,-10541.79 4056,-10528.5 4066.15,-10524.93 4064.89,-10517.16 4075,-10513.5 4105.62,-10502.4 4336.15,-10512.32 4368,-10505.5 4411.66,-10496.15 4458.41,-10475.38 4490.42,-10459.34"/>
<polygon fill="red" stroke="red" points="4492.12,-10462.4 4499.45,-10454.74 4488.95,-10456.16 4492.12,-10462.4"/>
<text text-anchor="middle" x="4106.5" y="-10517.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu7 -->
<g id="node136" class="node">
<title>l1_attn_stage7_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2708" cy="-10437" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2708" y="-10448.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="2708" y="-10433.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2708" y="-10418.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu7&#45;&gt;l1_attn_stage7_gpu7 -->
<g id="edge120" class="edge">
<title>l1_attn_stage6_gpu7&#45;&gt;l1_attn_stage7_gpu7</title>
<path fill="none" stroke="black" d="M2708,-10546.41C2708,-10527.69 2708,-10504.7 2708,-10484.71"/>
<polygon fill="black" stroke="black" points="2711.5,-10484.58 2708,-10474.58 2704.5,-10484.58 2711.5,-10484.58"/>
</g>
<!-- l1_attn_stage6_gpu7&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge1336" class="edge">
<title>l1_attn_stage6_gpu7&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2761.28,-10553.95C2775.42,-10547.62 2790.95,-10541.81 2806,-10538.5 2842.24,-10530.51 4106.99,-10540.8 4142,-10528.5 4152.15,-10524.93 4150.91,-10517.22 4161,-10513.5 4204.19,-10497.56 4323.04,-10515.4 4368,-10505.5 4411.6,-10495.9 4458.37,-10475.17 4490.39,-10459.2"/>
<polygon fill="red" stroke="red" points="4492.08,-10462.27 4499.42,-10454.63 4488.92,-10456.02 4492.08,-10462.27"/>
<text text-anchor="middle" x="4192.5" y="-10517.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu8 -->
<g id="node137" class="node">
<title>l1_attn_stage7_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2903" cy="-10437" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2903" y="-10448.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="2903" y="-10433.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2903" y="-10418.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu8&#45;&gt;l1_attn_stage7_gpu8 -->
<g id="edge121" class="edge">
<title>l1_attn_stage6_gpu8&#45;&gt;l1_attn_stage7_gpu8</title>
<path fill="none" stroke="black" d="M2903,-10546.41C2903,-10527.69 2903,-10504.7 2903,-10484.71"/>
<polygon fill="black" stroke="black" points="2906.5,-10484.58 2903,-10474.58 2899.5,-10484.58 2906.5,-10484.58"/>
</g>
<!-- l1_attn_stage6_gpu8&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge1337" class="edge">
<title>l1_attn_stage6_gpu8&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2956.28,-10553.96C2970.42,-10547.62 2985.95,-10541.82 3001,-10538.5 3067.57,-10523.81 4163.69,-10551.12 4228,-10528.5 4238.15,-10524.93 4236.96,-10517.36 4247,-10513.5 4297.3,-10494.15 4315.53,-10517.81 4368,-10505.5 4411.2,-10495.36 4457.67,-10474.92 4489.71,-10459.17"/>
<polygon fill="red" stroke="red" points="4491.38,-10462.25 4498.77,-10454.66 4488.25,-10455.99 4491.38,-10462.25"/>
<text text-anchor="middle" x="4278.5" y="-10517.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu9 -->
<g id="node138" class="node">
<title>l1_attn_stage7_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3098" cy="-10437" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3098" y="-10448.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="3098" y="-10433.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3098" y="-10418.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu9&#45;&gt;l1_attn_stage7_gpu9 -->
<g id="edge122" class="edge">
<title>l1_attn_stage6_gpu9&#45;&gt;l1_attn_stage7_gpu9</title>
<path fill="none" stroke="black" d="M3098,-10546.41C3098,-10527.69 3098,-10504.7 3098,-10484.71"/>
<polygon fill="black" stroke="black" points="3101.5,-10484.58 3098,-10474.58 3094.5,-10484.58 3101.5,-10484.58"/>
</g>
<!-- l1_attn_stage6_gpu9&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge1338" class="edge">
<title>l1_attn_stage6_gpu9&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3151.28,-10553.97C3165.42,-10547.63 3180.95,-10541.83 3196,-10538.5 3256.65,-10525.09 4255.41,-10549.13 4314,-10528.5 4324.15,-10524.92 4323.3,-10518.14 4333,-10513.5 4347.39,-10506.61 4352.8,-10510.36 4368,-10505.5 4408.94,-10492.4 4453.95,-10473.24 4486.12,-10458.67"/>
<polygon fill="red" stroke="red" points="4487.61,-10461.84 4495.25,-10454.51 4484.7,-10455.47 4487.61,-10461.84"/>
<text text-anchor="middle" x="4364.5" y="-10517.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu10 -->
<g id="node139" class="node">
<title>l1_attn_stage7_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3293" cy="-10437" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3293" y="-10448.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="3293" y="-10433.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3293" y="-10418.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu10&#45;&gt;l1_attn_stage7_gpu10 -->
<g id="edge123" class="edge">
<title>l1_attn_stage6_gpu10&#45;&gt;l1_attn_stage7_gpu10</title>
<path fill="none" stroke="black" d="M3293,-10546.41C3293,-10527.69 3293,-10504.7 3293,-10484.71"/>
<polygon fill="black" stroke="black" points="3296.5,-10484.58 3293,-10474.58 3289.5,-10484.58 3296.5,-10484.58"/>
</g>
<!-- l1_attn_stage6_gpu10&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge1339" class="edge">
<title>l1_attn_stage6_gpu10&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3346.29,-10553.98C3360.42,-10547.64 3375.95,-10541.83 3391,-10538.5 3445.73,-10526.37 4347.13,-10547.14 4400,-10528.5 4410.15,-10524.92 4410.32,-10519.86 4419,-10513.5 4444.22,-10495 4473.5,-10475.15 4495.65,-10460.45"/>
<polygon fill="red" stroke="red" points="4497.66,-10463.32 4504.07,-10454.88 4493.8,-10457.48 4497.66,-10463.32"/>
<text text-anchor="middle" x="4450.5" y="-10517.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu11 -->
<g id="node140" class="node">
<title>l1_attn_stage7_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3488" cy="-10437" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3488" y="-10448.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="3488" y="-10433.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3488" y="-10418.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu11&#45;&gt;l1_attn_stage7_gpu11 -->
<g id="edge124" class="edge">
<title>l1_attn_stage6_gpu11&#45;&gt;l1_attn_stage7_gpu11</title>
<path fill="none" stroke="black" d="M3488,-10546.41C3488,-10527.69 3488,-10504.7 3488,-10484.71"/>
<polygon fill="black" stroke="black" points="3491.5,-10484.58 3488,-10474.58 3484.5,-10484.58 3491.5,-10484.58"/>
</g>
<!-- l1_attn_stage6_gpu11&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge1340" class="edge">
<title>l1_attn_stage6_gpu11&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3541.29,-10553.99C3555.42,-10547.65 3570.95,-10541.84 3586,-10538.5 3610.41,-10533.07 4464.88,-10541.88 4486,-10528.5 4507.94,-10514.6 4519.24,-10486.32 4524.85,-10465.05"/>
<polygon fill="red" stroke="red" points="4528.27,-10465.81 4527.18,-10455.27 4521.46,-10464.19 4528.27,-10465.81"/>
<text text-anchor="middle" x="4532.5" y="-10517.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu12 -->
<g id="node141" class="node">
<title>l1_attn_stage7_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3683" cy="-10437" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3683" y="-10448.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="3683" y="-10433.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3683" y="-10418.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu12&#45;&gt;l1_attn_stage7_gpu12 -->
<g id="edge125" class="edge">
<title>l1_attn_stage6_gpu12&#45;&gt;l1_attn_stage7_gpu12</title>
<path fill="none" stroke="black" d="M3627.85,-10554.53C3614.43,-10548.5 3599.93,-10542.69 3586,-10538.5 3572.22,-10534.35 3531.36,-10539.43 3522,-10528.5 3487.08,-10487.7 3527.79,-10527.82 3586,-10505.5 3603.78,-10498.68 3621.42,-10487.93 3636.68,-10477"/>
<polygon fill="black" stroke="black" points="3638.93,-10479.69 3644.9,-10470.94 3634.77,-10474.06 3638.93,-10479.69"/>
</g>
<!-- l1_attn_stage6_gpu12&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge1341" class="edge">
<title>l1_attn_stage6_gpu12&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3736.29,-10554.01C3750.43,-10547.67 3765.95,-10541.85 3781,-10538.5 3802.45,-10533.71 4556.56,-10544.13 4572,-10528.5 4590.16,-10510.11 4572.89,-10482.42 4555.31,-10462.51"/>
<polygon fill="red" stroke="red" points="4557.75,-10459.99 4548.38,-10455.03 4552.61,-10464.75 4557.75,-10459.99"/>
<text text-anchor="middle" x="4610.5" y="-10517.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu13 -->
<g id="node142" class="node">
<title>l1_attn_stage7_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3878" cy="-10437" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3878" y="-10448.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="3878" y="-10433.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3878" y="-10418.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu13&#45;&gt;l1_attn_stage7_gpu13 -->
<g id="edge126" class="edge">
<title>l1_attn_stage6_gpu13&#45;&gt;l1_attn_stage7_gpu13</title>
<path fill="none" stroke="black" d="M3824.7,-10554.06C3810.85,-10547.8 3795.69,-10542.01 3781,-10538.5 3767.37,-10535.24 3538.71,-10538.6 3529,-10528.5 3524.38,-10523.69 3524.36,-10518.29 3529,-10513.5 3538.75,-10503.44 3767.7,-10509.9 3781,-10505.5 3799.4,-10499.4 3817.44,-10488.61 3832.87,-10477.42"/>
<polygon fill="black" stroke="black" points="3835.27,-10479.99 3841.16,-10471.19 3831.06,-10474.4 3835.27,-10479.99"/>
</g>
<!-- l1_attn_stage6_gpu13&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge1342" class="edge">
<title>l1_attn_stage6_gpu13&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3931.3,-10554.03C3945.43,-10547.69 3960.96,-10541.87 3976,-10538.5 3994.49,-10534.35 4644.7,-10541.99 4658,-10528.5 4686.36,-10499.72 4638.79,-10473.89 4593.82,-10457.26"/>
<polygon fill="red" stroke="red" points="4594.88,-10453.93 4584.29,-10453.86 4592.53,-10460.52 4594.88,-10453.93"/>
<text text-anchor="middle" x="4697.5" y="-10517.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu14 -->
<g id="node143" class="node">
<title>l1_attn_stage7_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4073" cy="-10437" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4073" y="-10448.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="4073" y="-10433.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4073" y="-10418.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu14&#45;&gt;l1_attn_stage7_gpu14 -->
<g id="edge127" class="edge">
<title>l1_attn_stage6_gpu14&#45;&gt;l1_attn_stage7_gpu14</title>
<path fill="none" stroke="black" d="M4019.74,-10553.88C4005.89,-10547.63 3990.71,-10541.89 3976,-10538.5 3952.17,-10533.01 3553.09,-10545.98 3536,-10528.5 3531.34,-10523.73 3531.33,-10518.25 3536,-10513.5 3544.56,-10504.78 3964.37,-10509.26 3976,-10505.5 3994.45,-10499.53 4012.49,-10488.77 4027.92,-10477.57"/>
<polygon fill="black" stroke="black" points="4030.32,-10480.14 4036.2,-10471.33 4026.11,-10474.54 4030.32,-10480.14"/>
</g>
<!-- l1_attn_stage6_gpu14&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge1343" class="edge">
<title>l1_attn_stage6_gpu14&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4126.3,-10554.06C4140.44,-10547.72 4155.96,-10541.89 4171,-10538.5 4186.53,-10535 4732.84,-10539.85 4744,-10528.5 4784.03,-10487.76 4714.32,-10464.4 4644.01,-10451.66"/>
<polygon fill="red" stroke="red" points="4644.55,-10448.2 4634.1,-10449.93 4643.35,-10455.1 4644.55,-10448.2"/>
<text text-anchor="middle" x="4784.5" y="-10517.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage7_gpu15 -->
<g id="node144" class="node">
<title>l1_attn_stage7_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4268" cy="-10437" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4268" y="-10448.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage7</text>
<text text-anchor="middle" x="4268" y="-10433.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4268" y="-10418.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage6_gpu15&#45;&gt;l1_attn_stage7_gpu15 -->
<g id="edge128" class="edge">
<title>l1_attn_stage6_gpu15&#45;&gt;l1_attn_stage7_gpu15</title>
<path fill="none" stroke="black" d="M4215.02,-10553.93C4201.09,-10547.63 4185.82,-10541.86 4171,-10538.5 4153.99,-10534.64 3555.24,-10540.93 3543,-10528.5 3538.32,-10523.75 3538.32,-10518.24 3543,-10513.5 3555.26,-10501.08 4154.39,-10510.83 4171,-10505.5 4189.46,-10499.58 4207.51,-10488.83 4222.94,-10477.63"/>
<polygon fill="black" stroke="black" points="4225.34,-10480.2 4231.22,-10471.38 4221.13,-10474.6 4225.34,-10480.2"/>
</g>
<!-- l1_attn_stage6_gpu15&#45;&gt;l1_attn_stage7_gpu[next_gpu] -->
<g id="edge1344" class="edge">
<title>l1_attn_stage6_gpu15&#45;&gt;l1_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4323.38,-10554.68C4338.74,-10548.12 4355.68,-10542.03 4372,-10538.5 4396.87,-10533.12 4812.2,-10546.69 4830,-10528.5 4884.67,-10472.62 4783.45,-10450.96 4684.12,-10442.71"/>
<polygon fill="red" stroke="red" points="4684.15,-10439.2 4673.9,-10441.9 4683.6,-10446.18 4684.15,-10439.2"/>
<text text-anchor="middle" x="4870.5" y="-10517.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu0 -->
<g id="node145" class="node">
<title>l1_attn_stage8_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1343" cy="-10290" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1343" y="-10301.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="1343" y="-10286.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1343" y="-10271.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu0&#45;&gt;l1_attn_stage8_gpu0 -->
<g id="edge129" class="edge">
<title>l1_attn_stage7_gpu0&#45;&gt;l1_attn_stage8_gpu0</title>
<path fill="none" stroke="black" d="M1343,-10399.41C1343,-10380.69 1343,-10357.7 1343,-10337.71"/>
<polygon fill="black" stroke="black" points="1346.5,-10337.58 1343,-10327.58 1339.5,-10337.58 1346.5,-10337.58"/>
</g>
<!-- l1_attn_stage8_gpu[next_gpu] -->
<g id="node1320" class="node">
<title>l1_attn_stage8_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4530" cy="-10290" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4530" y="-10286.3" font-family="Times,serif" font-size="14.00">l1_attn_stage8_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage7_gpu0&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge1345" class="edge">
<title>l1_attn_stage7_gpu0&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1396.29,-10407C1410.43,-10400.66 1425.95,-10394.85 1441,-10391.5 1670.73,-10340.36 3323.66,-10369.05 3559,-10366.5 3603.94,-10366.01 4323.97,-10367.53 4368,-10358.5 4411.87,-10349.5 4458.77,-10328.58 4490.76,-10312.4"/>
<polygon fill="red" stroke="red" points="4492.49,-10315.44 4499.78,-10307.76 4489.28,-10309.22 4492.49,-10315.44"/>
<text text-anchor="middle" x="3590.5" y="-10370.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu1 -->
<g id="node146" class="node">
<title>l1_attn_stage8_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1538" cy="-10290" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1538" y="-10301.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="1538" y="-10286.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1538" y="-10271.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu1&#45;&gt;l1_attn_stage8_gpu1 -->
<g id="edge130" class="edge">
<title>l1_attn_stage7_gpu1&#45;&gt;l1_attn_stage8_gpu1</title>
<path fill="none" stroke="black" d="M1538,-10399.41C1538,-10380.69 1538,-10357.7 1538,-10337.71"/>
<polygon fill="black" stroke="black" points="1541.5,-10337.58 1538,-10327.58 1534.5,-10337.58 1541.5,-10337.58"/>
</g>
<!-- l1_attn_stage7_gpu1&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge1346" class="edge">
<title>l1_attn_stage7_gpu1&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1591.28,-10406.93C1605.41,-10400.59 1620.94,-10394.8 1636,-10391.5 1690,-10379.67 3573.82,-10399.76 3626,-10381.5 3636.15,-10377.94 3634.86,-10370.08 3645,-10366.5 3682.87,-10353.11 4328.66,-10366.59 4368,-10358.5 4411.87,-10349.47 4458.77,-10328.56 4490.76,-10312.38"/>
<polygon fill="red" stroke="red" points="4492.48,-10315.43 4499.78,-10307.75 4489.28,-10309.2 4492.48,-10315.43"/>
<text text-anchor="middle" x="3676.5" y="-10370.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu2 -->
<g id="node147" class="node">
<title>l1_attn_stage8_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1733" cy="-10290" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1733" y="-10301.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="1733" y="-10286.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1733" y="-10271.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu2&#45;&gt;l1_attn_stage8_gpu2 -->
<g id="edge131" class="edge">
<title>l1_attn_stage7_gpu2&#45;&gt;l1_attn_stage8_gpu2</title>
<path fill="none" stroke="black" d="M1733,-10399.41C1733,-10380.69 1733,-10357.7 1733,-10337.71"/>
<polygon fill="black" stroke="black" points="1736.5,-10337.58 1733,-10327.58 1729.5,-10337.58 1736.5,-10337.58"/>
</g>
<!-- l1_attn_stage7_gpu2&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge1347" class="edge">
<title>l1_attn_stage7_gpu2&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1786.28,-10406.93C1800.41,-10400.59 1815.94,-10394.8 1831,-10391.5 1882.04,-10380.31 3662.68,-10398.77 3712,-10381.5 3722.15,-10377.94 3720.86,-10370.09 3731,-10366.5 3764.36,-10354.68 4333.34,-10365.66 4368,-10358.5 4411.86,-10349.44 4458.76,-10328.53 4490.75,-10312.36"/>
<polygon fill="red" stroke="red" points="4492.48,-10315.41 4499.77,-10307.73 4489.28,-10309.19 4492.48,-10315.41"/>
<text text-anchor="middle" x="3762.5" y="-10370.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu3 -->
<g id="node148" class="node">
<title>l1_attn_stage8_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1928" cy="-10290" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1928" y="-10301.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="1928" y="-10286.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1928" y="-10271.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu3&#45;&gt;l1_attn_stage8_gpu3 -->
<g id="edge132" class="edge">
<title>l1_attn_stage7_gpu3&#45;&gt;l1_attn_stage8_gpu3</title>
<path fill="none" stroke="black" d="M1928,-10399.41C1928,-10380.69 1928,-10357.7 1928,-10337.71"/>
<polygon fill="black" stroke="black" points="1931.5,-10337.58 1928,-10327.58 1924.5,-10337.58 1931.5,-10337.58"/>
</g>
<!-- l1_attn_stage7_gpu3&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge1348" class="edge">
<title>l1_attn_stage7_gpu3&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1981.28,-10406.94C1995.41,-10400.6 2010.94,-10394.8 2026,-10391.5 2074.08,-10380.95 3751.55,-10397.77 3798,-10381.5 3808.15,-10377.94 3806.86,-10370.1 3817,-10366.5 3845.85,-10356.25 4338.02,-10364.72 4368,-10358.5 4411.85,-10349.4 4458.75,-10328.49 4490.75,-10312.34"/>
<polygon fill="red" stroke="red" points="4492.47,-10315.39 4499.77,-10307.71 4489.27,-10309.16 4492.47,-10315.39"/>
<text text-anchor="middle" x="3848.5" y="-10370.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu4 -->
<g id="node149" class="node">
<title>l1_attn_stage8_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2123" cy="-10290" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2123" y="-10301.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="2123" y="-10286.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2123" y="-10271.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu4&#45;&gt;l1_attn_stage8_gpu4 -->
<g id="edge133" class="edge">
<title>l1_attn_stage7_gpu4&#45;&gt;l1_attn_stage8_gpu4</title>
<path fill="none" stroke="black" d="M2123,-10399.41C2123,-10380.69 2123,-10357.7 2123,-10337.71"/>
<polygon fill="black" stroke="black" points="2126.5,-10337.58 2123,-10327.58 2119.5,-10337.58 2126.5,-10337.58"/>
</g>
<!-- l1_attn_stage7_gpu4&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge1349" class="edge">
<title>l1_attn_stage7_gpu4&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2176.28,-10406.94C2190.41,-10400.6 2205.94,-10394.8 2221,-10391.5 2266.12,-10381.59 3840.41,-10396.78 3884,-10381.5 3894.15,-10377.94 3892.87,-10370.11 3903,-10366.5 3951.67,-10349.13 4317.42,-10369.07 4368,-10358.5 4411.84,-10349.34 4458.74,-10328.44 4490.74,-10312.31"/>
<polygon fill="red" stroke="red" points="4492.46,-10315.36 4499.76,-10307.69 4489.27,-10309.13 4492.46,-10315.36"/>
<text text-anchor="middle" x="3934.5" y="-10370.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu5 -->
<g id="node150" class="node">
<title>l1_attn_stage8_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2318" cy="-10290" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2318" y="-10301.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="2318" y="-10286.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2318" y="-10271.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu5&#45;&gt;l1_attn_stage8_gpu5 -->
<g id="edge134" class="edge">
<title>l1_attn_stage7_gpu5&#45;&gt;l1_attn_stage8_gpu5</title>
<path fill="none" stroke="black" d="M2318,-10399.41C2318,-10380.69 2318,-10357.7 2318,-10337.71"/>
<polygon fill="black" stroke="black" points="2321.5,-10337.58 2318,-10327.58 2314.5,-10337.58 2321.5,-10337.58"/>
</g>
<!-- l1_attn_stage7_gpu5&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge1350" class="edge">
<title>l1_attn_stage7_gpu5&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2371.28,-10406.94C2385.41,-10400.6 2400.94,-10394.81 2416,-10391.5 2458.16,-10382.23 3929.27,-10395.79 3970,-10381.5 3980.15,-10377.94 3978.87,-10370.13 3989,-10366.5 4028.64,-10352.26 4326.79,-10367.19 4368,-10358.5 4411.82,-10349.25 4458.73,-10328.37 4490.73,-10312.26"/>
<polygon fill="red" stroke="red" points="4492.45,-10315.32 4499.75,-10307.65 4489.26,-10309.08 4492.45,-10315.32"/>
<text text-anchor="middle" x="4020.5" y="-10370.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu6 -->
<g id="node151" class="node">
<title>l1_attn_stage8_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2513" cy="-10290" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2513" y="-10301.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="2513" y="-10286.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2513" y="-10271.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu6&#45;&gt;l1_attn_stage8_gpu6 -->
<g id="edge135" class="edge">
<title>l1_attn_stage7_gpu6&#45;&gt;l1_attn_stage8_gpu6</title>
<path fill="none" stroke="black" d="M2513,-10399.41C2513,-10380.69 2513,-10357.7 2513,-10337.71"/>
<polygon fill="black" stroke="black" points="2516.5,-10337.58 2513,-10327.58 2509.5,-10337.58 2516.5,-10337.58"/>
</g>
<!-- l1_attn_stage7_gpu6&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge1351" class="edge">
<title>l1_attn_stage7_gpu6&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2566.28,-10406.95C2580.41,-10400.61 2595.94,-10394.81 2611,-10391.5 2650.2,-10382.87 4018.13,-10394.79 4056,-10381.5 4066.15,-10377.93 4064.89,-10370.16 4075,-10366.5 4105.62,-10355.4 4336.15,-10365.32 4368,-10358.5 4411.66,-10349.15 4458.41,-10328.38 4490.42,-10312.34"/>
<polygon fill="red" stroke="red" points="4492.12,-10315.4 4499.45,-10307.74 4488.95,-10309.16 4492.12,-10315.4"/>
<text text-anchor="middle" x="4106.5" y="-10370.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu7 -->
<g id="node152" class="node">
<title>l1_attn_stage8_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2708" cy="-10290" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2708" y="-10301.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="2708" y="-10286.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2708" y="-10271.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu7&#45;&gt;l1_attn_stage8_gpu7 -->
<g id="edge136" class="edge">
<title>l1_attn_stage7_gpu7&#45;&gt;l1_attn_stage8_gpu7</title>
<path fill="none" stroke="black" d="M2708,-10399.41C2708,-10380.69 2708,-10357.7 2708,-10337.71"/>
<polygon fill="black" stroke="black" points="2711.5,-10337.58 2708,-10327.58 2704.5,-10337.58 2711.5,-10337.58"/>
</g>
<!-- l1_attn_stage7_gpu7&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge1352" class="edge">
<title>l1_attn_stage7_gpu7&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2761.28,-10406.95C2775.42,-10400.62 2790.95,-10394.81 2806,-10391.5 2842.24,-10383.51 4106.99,-10393.8 4142,-10381.5 4152.15,-10377.93 4150.91,-10370.22 4161,-10366.5 4204.19,-10350.56 4323.04,-10368.4 4368,-10358.5 4411.6,-10348.9 4458.37,-10328.17 4490.39,-10312.2"/>
<polygon fill="red" stroke="red" points="4492.08,-10315.27 4499.42,-10307.63 4488.92,-10309.02 4492.08,-10315.27"/>
<text text-anchor="middle" x="4192.5" y="-10370.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu8 -->
<g id="node153" class="node">
<title>l1_attn_stage8_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2903" cy="-10290" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2903" y="-10301.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="2903" y="-10286.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2903" y="-10271.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu8&#45;&gt;l1_attn_stage8_gpu8 -->
<g id="edge137" class="edge">
<title>l1_attn_stage7_gpu8&#45;&gt;l1_attn_stage8_gpu8</title>
<path fill="none" stroke="black" d="M2903,-10399.41C2903,-10380.69 2903,-10357.7 2903,-10337.71"/>
<polygon fill="black" stroke="black" points="2906.5,-10337.58 2903,-10327.58 2899.5,-10337.58 2906.5,-10337.58"/>
</g>
<!-- l1_attn_stage7_gpu8&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge1353" class="edge">
<title>l1_attn_stage7_gpu8&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2956.28,-10406.96C2970.42,-10400.62 2985.95,-10394.82 3001,-10391.5 3067.57,-10376.81 4163.69,-10404.12 4228,-10381.5 4238.15,-10377.93 4236.96,-10370.36 4247,-10366.5 4297.3,-10347.15 4315.53,-10370.81 4368,-10358.5 4411.2,-10348.36 4457.67,-10327.92 4489.71,-10312.17"/>
<polygon fill="red" stroke="red" points="4491.38,-10315.25 4498.77,-10307.66 4488.25,-10308.99 4491.38,-10315.25"/>
<text text-anchor="middle" x="4278.5" y="-10370.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu9 -->
<g id="node154" class="node">
<title>l1_attn_stage8_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3098" cy="-10290" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3098" y="-10301.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="3098" y="-10286.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3098" y="-10271.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu9&#45;&gt;l1_attn_stage8_gpu9 -->
<g id="edge138" class="edge">
<title>l1_attn_stage7_gpu9&#45;&gt;l1_attn_stage8_gpu9</title>
<path fill="none" stroke="black" d="M3098,-10399.41C3098,-10380.69 3098,-10357.7 3098,-10337.71"/>
<polygon fill="black" stroke="black" points="3101.5,-10337.58 3098,-10327.58 3094.5,-10337.58 3101.5,-10337.58"/>
</g>
<!-- l1_attn_stage7_gpu9&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge1354" class="edge">
<title>l1_attn_stage7_gpu9&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3151.28,-10406.97C3165.42,-10400.63 3180.95,-10394.83 3196,-10391.5 3256.65,-10378.09 4255.41,-10402.13 4314,-10381.5 4324.15,-10377.92 4323.3,-10371.14 4333,-10366.5 4347.39,-10359.61 4352.8,-10363.36 4368,-10358.5 4408.94,-10345.4 4453.95,-10326.24 4486.12,-10311.67"/>
<polygon fill="red" stroke="red" points="4487.61,-10314.84 4495.25,-10307.51 4484.7,-10308.47 4487.61,-10314.84"/>
<text text-anchor="middle" x="4364.5" y="-10370.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu10 -->
<g id="node155" class="node">
<title>l1_attn_stage8_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3293" cy="-10290" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3293" y="-10301.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="3293" y="-10286.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3293" y="-10271.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu10&#45;&gt;l1_attn_stage8_gpu10 -->
<g id="edge139" class="edge">
<title>l1_attn_stage7_gpu10&#45;&gt;l1_attn_stage8_gpu10</title>
<path fill="none" stroke="black" d="M3293,-10399.41C3293,-10380.69 3293,-10357.7 3293,-10337.71"/>
<polygon fill="black" stroke="black" points="3296.5,-10337.58 3293,-10327.58 3289.5,-10337.58 3296.5,-10337.58"/>
</g>
<!-- l1_attn_stage7_gpu10&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge1355" class="edge">
<title>l1_attn_stage7_gpu10&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3346.29,-10406.98C3360.42,-10400.64 3375.95,-10394.83 3391,-10391.5 3445.73,-10379.37 4347.13,-10400.14 4400,-10381.5 4410.15,-10377.92 4410.32,-10372.86 4419,-10366.5 4444.22,-10348 4473.5,-10328.15 4495.65,-10313.45"/>
<polygon fill="red" stroke="red" points="4497.66,-10316.32 4504.07,-10307.88 4493.8,-10310.48 4497.66,-10316.32"/>
<text text-anchor="middle" x="4450.5" y="-10370.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu11 -->
<g id="node156" class="node">
<title>l1_attn_stage8_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3488" cy="-10290" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3488" y="-10301.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="3488" y="-10286.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3488" y="-10271.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu11&#45;&gt;l1_attn_stage8_gpu11 -->
<g id="edge140" class="edge">
<title>l1_attn_stage7_gpu11&#45;&gt;l1_attn_stage8_gpu11</title>
<path fill="none" stroke="black" d="M3488,-10399.41C3488,-10380.69 3488,-10357.7 3488,-10337.71"/>
<polygon fill="black" stroke="black" points="3491.5,-10337.58 3488,-10327.58 3484.5,-10337.58 3491.5,-10337.58"/>
</g>
<!-- l1_attn_stage7_gpu11&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge1356" class="edge">
<title>l1_attn_stage7_gpu11&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3541.29,-10406.99C3555.42,-10400.65 3570.95,-10394.84 3586,-10391.5 3610.41,-10386.07 4464.88,-10394.88 4486,-10381.5 4507.94,-10367.6 4519.24,-10339.32 4524.85,-10318.05"/>
<polygon fill="red" stroke="red" points="4528.27,-10318.81 4527.18,-10308.27 4521.46,-10317.19 4528.27,-10318.81"/>
<text text-anchor="middle" x="4532.5" y="-10370.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu12 -->
<g id="node157" class="node">
<title>l1_attn_stage8_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3683" cy="-10290" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3683" y="-10301.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="3683" y="-10286.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3683" y="-10271.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu12&#45;&gt;l1_attn_stage8_gpu12 -->
<g id="edge141" class="edge">
<title>l1_attn_stage7_gpu12&#45;&gt;l1_attn_stage8_gpu12</title>
<path fill="none" stroke="black" d="M3627.85,-10407.53C3614.43,-10401.5 3599.93,-10395.69 3586,-10391.5 3572.22,-10387.35 3531.36,-10392.43 3522,-10381.5 3487.08,-10340.7 3527.79,-10380.82 3586,-10358.5 3603.78,-10351.68 3621.42,-10340.93 3636.68,-10330"/>
<polygon fill="black" stroke="black" points="3638.93,-10332.69 3644.9,-10323.94 3634.77,-10327.06 3638.93,-10332.69"/>
</g>
<!-- l1_attn_stage7_gpu12&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge1357" class="edge">
<title>l1_attn_stage7_gpu12&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3736.29,-10407.01C3750.43,-10400.67 3765.95,-10394.85 3781,-10391.5 3802.45,-10386.71 4556.56,-10397.13 4572,-10381.5 4590.16,-10363.11 4572.89,-10335.42 4555.31,-10315.51"/>
<polygon fill="red" stroke="red" points="4557.75,-10312.99 4548.38,-10308.03 4552.61,-10317.75 4557.75,-10312.99"/>
<text text-anchor="middle" x="4610.5" y="-10370.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu13 -->
<g id="node158" class="node">
<title>l1_attn_stage8_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3878" cy="-10290" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3878" y="-10301.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="3878" y="-10286.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3878" y="-10271.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu13&#45;&gt;l1_attn_stage8_gpu13 -->
<g id="edge142" class="edge">
<title>l1_attn_stage7_gpu13&#45;&gt;l1_attn_stage8_gpu13</title>
<path fill="none" stroke="black" d="M3824.7,-10407.06C3810.85,-10400.8 3795.69,-10395.01 3781,-10391.5 3767.37,-10388.24 3538.71,-10391.6 3529,-10381.5 3524.38,-10376.69 3524.36,-10371.29 3529,-10366.5 3538.75,-10356.44 3767.7,-10362.9 3781,-10358.5 3799.4,-10352.4 3817.44,-10341.61 3832.87,-10330.42"/>
<polygon fill="black" stroke="black" points="3835.27,-10332.99 3841.16,-10324.19 3831.06,-10327.4 3835.27,-10332.99"/>
</g>
<!-- l1_attn_stage7_gpu13&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge1358" class="edge">
<title>l1_attn_stage7_gpu13&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3931.3,-10407.03C3945.43,-10400.69 3960.96,-10394.87 3976,-10391.5 3994.49,-10387.35 4644.7,-10394.99 4658,-10381.5 4686.36,-10352.72 4638.79,-10326.89 4593.82,-10310.26"/>
<polygon fill="red" stroke="red" points="4594.88,-10306.93 4584.29,-10306.86 4592.53,-10313.52 4594.88,-10306.93"/>
<text text-anchor="middle" x="4697.5" y="-10370.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu14 -->
<g id="node159" class="node">
<title>l1_attn_stage8_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4073" cy="-10290" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4073" y="-10301.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="4073" y="-10286.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4073" y="-10271.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu14&#45;&gt;l1_attn_stage8_gpu14 -->
<g id="edge143" class="edge">
<title>l1_attn_stage7_gpu14&#45;&gt;l1_attn_stage8_gpu14</title>
<path fill="none" stroke="black" d="M4019.74,-10406.88C4005.89,-10400.63 3990.71,-10394.89 3976,-10391.5 3952.17,-10386.01 3553.09,-10398.98 3536,-10381.5 3531.34,-10376.73 3531.33,-10371.25 3536,-10366.5 3544.56,-10357.78 3964.37,-10362.26 3976,-10358.5 3994.45,-10352.53 4012.49,-10341.77 4027.92,-10330.57"/>
<polygon fill="black" stroke="black" points="4030.32,-10333.14 4036.2,-10324.33 4026.11,-10327.54 4030.32,-10333.14"/>
</g>
<!-- l1_attn_stage7_gpu14&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge1359" class="edge">
<title>l1_attn_stage7_gpu14&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4126.3,-10407.06C4140.44,-10400.72 4155.96,-10394.89 4171,-10391.5 4186.53,-10388 4732.84,-10392.85 4744,-10381.5 4784.03,-10340.76 4714.32,-10317.4 4644.01,-10304.66"/>
<polygon fill="red" stroke="red" points="4644.55,-10301.2 4634.1,-10302.93 4643.35,-10308.1 4644.55,-10301.2"/>
<text text-anchor="middle" x="4784.5" y="-10370.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage8_gpu15 -->
<g id="node160" class="node">
<title>l1_attn_stage8_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4268" cy="-10290" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4268" y="-10301.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage8</text>
<text text-anchor="middle" x="4268" y="-10286.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4268" y="-10271.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage7_gpu15&#45;&gt;l1_attn_stage8_gpu15 -->
<g id="edge144" class="edge">
<title>l1_attn_stage7_gpu15&#45;&gt;l1_attn_stage8_gpu15</title>
<path fill="none" stroke="black" d="M4215.02,-10406.93C4201.09,-10400.63 4185.82,-10394.86 4171,-10391.5 4153.99,-10387.64 3555.24,-10393.93 3543,-10381.5 3538.32,-10376.75 3538.32,-10371.24 3543,-10366.5 3555.26,-10354.08 4154.39,-10363.83 4171,-10358.5 4189.46,-10352.58 4207.51,-10341.83 4222.94,-10330.63"/>
<polygon fill="black" stroke="black" points="4225.34,-10333.2 4231.22,-10324.38 4221.13,-10327.6 4225.34,-10333.2"/>
</g>
<!-- l1_attn_stage7_gpu15&#45;&gt;l1_attn_stage8_gpu[next_gpu] -->
<g id="edge1360" class="edge">
<title>l1_attn_stage7_gpu15&#45;&gt;l1_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4323.38,-10407.68C4338.74,-10401.12 4355.68,-10395.03 4372,-10391.5 4396.87,-10386.12 4812.2,-10399.69 4830,-10381.5 4884.67,-10325.62 4783.45,-10303.96 4684.12,-10295.71"/>
<polygon fill="red" stroke="red" points="4684.15,-10292.2 4673.9,-10294.9 4683.6,-10299.18 4684.15,-10292.2"/>
<text text-anchor="middle" x="4870.5" y="-10370.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu0 -->
<g id="node161" class="node">
<title>l1_attn_stage9_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1343" cy="-10143" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1343" y="-10154.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="1343" y="-10139.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1343" y="-10124.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu0&#45;&gt;l1_attn_stage9_gpu0 -->
<g id="edge145" class="edge">
<title>l1_attn_stage8_gpu0&#45;&gt;l1_attn_stage9_gpu0</title>
<path fill="none" stroke="black" d="M1343,-10252.41C1343,-10233.69 1343,-10210.7 1343,-10190.71"/>
<polygon fill="black" stroke="black" points="1346.5,-10190.58 1343,-10180.58 1339.5,-10190.58 1346.5,-10190.58"/>
</g>
<!-- l1_attn_stage9_gpu[next_gpu] -->
<g id="node1321" class="node">
<title>l1_attn_stage9_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4530" cy="-10143" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4530" y="-10139.3" font-family="Times,serif" font-size="14.00">l1_attn_stage9_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage8_gpu0&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge1361" class="edge">
<title>l1_attn_stage8_gpu0&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1396.29,-10260C1410.43,-10253.66 1425.95,-10247.85 1441,-10244.5 1670.73,-10193.36 3323.66,-10222.05 3559,-10219.5 3603.94,-10219.01 4323.97,-10220.53 4368,-10211.5 4411.87,-10202.5 4458.77,-10181.58 4490.76,-10165.4"/>
<polygon fill="red" stroke="red" points="4492.49,-10168.44 4499.78,-10160.76 4489.28,-10162.22 4492.49,-10168.44"/>
<text text-anchor="middle" x="3590.5" y="-10223.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu1 -->
<g id="node162" class="node">
<title>l1_attn_stage9_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1538" cy="-10143" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1538" y="-10154.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="1538" y="-10139.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1538" y="-10124.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu1&#45;&gt;l1_attn_stage9_gpu1 -->
<g id="edge146" class="edge">
<title>l1_attn_stage8_gpu1&#45;&gt;l1_attn_stage9_gpu1</title>
<path fill="none" stroke="black" d="M1538,-10252.41C1538,-10233.69 1538,-10210.7 1538,-10190.71"/>
<polygon fill="black" stroke="black" points="1541.5,-10190.58 1538,-10180.58 1534.5,-10190.58 1541.5,-10190.58"/>
</g>
<!-- l1_attn_stage8_gpu1&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge1362" class="edge">
<title>l1_attn_stage8_gpu1&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1591.28,-10259.93C1605.41,-10253.59 1620.94,-10247.8 1636,-10244.5 1690,-10232.67 3573.82,-10252.76 3626,-10234.5 3636.15,-10230.94 3634.86,-10223.08 3645,-10219.5 3682.87,-10206.11 4328.66,-10219.59 4368,-10211.5 4411.87,-10202.47 4458.77,-10181.56 4490.76,-10165.38"/>
<polygon fill="red" stroke="red" points="4492.48,-10168.43 4499.78,-10160.75 4489.28,-10162.2 4492.48,-10168.43"/>
<text text-anchor="middle" x="3676.5" y="-10223.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu2 -->
<g id="node163" class="node">
<title>l1_attn_stage9_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1733" cy="-10143" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1733" y="-10154.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="1733" y="-10139.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1733" y="-10124.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu2&#45;&gt;l1_attn_stage9_gpu2 -->
<g id="edge147" class="edge">
<title>l1_attn_stage8_gpu2&#45;&gt;l1_attn_stage9_gpu2</title>
<path fill="none" stroke="black" d="M1733,-10252.41C1733,-10233.69 1733,-10210.7 1733,-10190.71"/>
<polygon fill="black" stroke="black" points="1736.5,-10190.58 1733,-10180.58 1729.5,-10190.58 1736.5,-10190.58"/>
</g>
<!-- l1_attn_stage8_gpu2&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge1363" class="edge">
<title>l1_attn_stage8_gpu2&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1786.28,-10259.93C1800.41,-10253.59 1815.94,-10247.8 1831,-10244.5 1882.04,-10233.31 3662.68,-10251.77 3712,-10234.5 3722.15,-10230.94 3720.86,-10223.09 3731,-10219.5 3764.36,-10207.68 4333.34,-10218.66 4368,-10211.5 4411.86,-10202.44 4458.76,-10181.53 4490.75,-10165.36"/>
<polygon fill="red" stroke="red" points="4492.48,-10168.41 4499.77,-10160.73 4489.28,-10162.19 4492.48,-10168.41"/>
<text text-anchor="middle" x="3762.5" y="-10223.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu3 -->
<g id="node164" class="node">
<title>l1_attn_stage9_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1928" cy="-10143" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1928" y="-10154.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="1928" y="-10139.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1928" y="-10124.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu3&#45;&gt;l1_attn_stage9_gpu3 -->
<g id="edge148" class="edge">
<title>l1_attn_stage8_gpu3&#45;&gt;l1_attn_stage9_gpu3</title>
<path fill="none" stroke="black" d="M1928,-10252.41C1928,-10233.69 1928,-10210.7 1928,-10190.71"/>
<polygon fill="black" stroke="black" points="1931.5,-10190.58 1928,-10180.58 1924.5,-10190.58 1931.5,-10190.58"/>
</g>
<!-- l1_attn_stage8_gpu3&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge1364" class="edge">
<title>l1_attn_stage8_gpu3&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1981.28,-10259.94C1995.41,-10253.6 2010.94,-10247.8 2026,-10244.5 2074.08,-10233.95 3751.55,-10250.77 3798,-10234.5 3808.15,-10230.94 3806.86,-10223.1 3817,-10219.5 3845.85,-10209.25 4338.02,-10217.72 4368,-10211.5 4411.85,-10202.4 4458.75,-10181.49 4490.75,-10165.34"/>
<polygon fill="red" stroke="red" points="4492.47,-10168.39 4499.77,-10160.71 4489.27,-10162.16 4492.47,-10168.39"/>
<text text-anchor="middle" x="3848.5" y="-10223.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu4 -->
<g id="node165" class="node">
<title>l1_attn_stage9_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2123" cy="-10143" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2123" y="-10154.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="2123" y="-10139.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2123" y="-10124.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu4&#45;&gt;l1_attn_stage9_gpu4 -->
<g id="edge149" class="edge">
<title>l1_attn_stage8_gpu4&#45;&gt;l1_attn_stage9_gpu4</title>
<path fill="none" stroke="black" d="M2123,-10252.41C2123,-10233.69 2123,-10210.7 2123,-10190.71"/>
<polygon fill="black" stroke="black" points="2126.5,-10190.58 2123,-10180.58 2119.5,-10190.58 2126.5,-10190.58"/>
</g>
<!-- l1_attn_stage8_gpu4&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge1365" class="edge">
<title>l1_attn_stage8_gpu4&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2176.28,-10259.94C2190.41,-10253.6 2205.94,-10247.8 2221,-10244.5 2266.12,-10234.59 3840.41,-10249.78 3884,-10234.5 3894.15,-10230.94 3892.87,-10223.11 3903,-10219.5 3951.67,-10202.13 4317.42,-10222.07 4368,-10211.5 4411.84,-10202.34 4458.74,-10181.44 4490.74,-10165.31"/>
<polygon fill="red" stroke="red" points="4492.46,-10168.36 4499.76,-10160.69 4489.27,-10162.13 4492.46,-10168.36"/>
<text text-anchor="middle" x="3934.5" y="-10223.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu5 -->
<g id="node166" class="node">
<title>l1_attn_stage9_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2318" cy="-10143" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2318" y="-10154.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="2318" y="-10139.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2318" y="-10124.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu5&#45;&gt;l1_attn_stage9_gpu5 -->
<g id="edge150" class="edge">
<title>l1_attn_stage8_gpu5&#45;&gt;l1_attn_stage9_gpu5</title>
<path fill="none" stroke="black" d="M2318,-10252.41C2318,-10233.69 2318,-10210.7 2318,-10190.71"/>
<polygon fill="black" stroke="black" points="2321.5,-10190.58 2318,-10180.58 2314.5,-10190.58 2321.5,-10190.58"/>
</g>
<!-- l1_attn_stage8_gpu5&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge1366" class="edge">
<title>l1_attn_stage8_gpu5&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2371.28,-10259.94C2385.41,-10253.6 2400.94,-10247.81 2416,-10244.5 2458.16,-10235.23 3929.27,-10248.79 3970,-10234.5 3980.15,-10230.94 3978.87,-10223.13 3989,-10219.5 4028.64,-10205.26 4326.79,-10220.19 4368,-10211.5 4411.82,-10202.25 4458.73,-10181.37 4490.73,-10165.26"/>
<polygon fill="red" stroke="red" points="4492.45,-10168.32 4499.75,-10160.65 4489.26,-10162.08 4492.45,-10168.32"/>
<text text-anchor="middle" x="4020.5" y="-10223.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu6 -->
<g id="node167" class="node">
<title>l1_attn_stage9_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2513" cy="-10143" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2513" y="-10154.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="2513" y="-10139.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2513" y="-10124.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu6&#45;&gt;l1_attn_stage9_gpu6 -->
<g id="edge151" class="edge">
<title>l1_attn_stage8_gpu6&#45;&gt;l1_attn_stage9_gpu6</title>
<path fill="none" stroke="black" d="M2513,-10252.41C2513,-10233.69 2513,-10210.7 2513,-10190.71"/>
<polygon fill="black" stroke="black" points="2516.5,-10190.58 2513,-10180.58 2509.5,-10190.58 2516.5,-10190.58"/>
</g>
<!-- l1_attn_stage8_gpu6&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge1367" class="edge">
<title>l1_attn_stage8_gpu6&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2566.28,-10259.95C2580.41,-10253.61 2595.94,-10247.81 2611,-10244.5 2650.2,-10235.87 4018.13,-10247.79 4056,-10234.5 4066.15,-10230.93 4064.89,-10223.16 4075,-10219.5 4105.62,-10208.4 4336.15,-10218.32 4368,-10211.5 4411.66,-10202.15 4458.41,-10181.38 4490.42,-10165.34"/>
<polygon fill="red" stroke="red" points="4492.12,-10168.4 4499.45,-10160.74 4488.95,-10162.16 4492.12,-10168.4"/>
<text text-anchor="middle" x="4106.5" y="-10223.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu7 -->
<g id="node168" class="node">
<title>l1_attn_stage9_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2708" cy="-10143" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2708" y="-10154.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="2708" y="-10139.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2708" y="-10124.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu7&#45;&gt;l1_attn_stage9_gpu7 -->
<g id="edge152" class="edge">
<title>l1_attn_stage8_gpu7&#45;&gt;l1_attn_stage9_gpu7</title>
<path fill="none" stroke="black" d="M2708,-10252.41C2708,-10233.69 2708,-10210.7 2708,-10190.71"/>
<polygon fill="black" stroke="black" points="2711.5,-10190.58 2708,-10180.58 2704.5,-10190.58 2711.5,-10190.58"/>
</g>
<!-- l1_attn_stage8_gpu7&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge1368" class="edge">
<title>l1_attn_stage8_gpu7&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2761.28,-10259.95C2775.42,-10253.62 2790.95,-10247.81 2806,-10244.5 2842.24,-10236.51 4106.99,-10246.8 4142,-10234.5 4152.15,-10230.93 4150.91,-10223.22 4161,-10219.5 4204.19,-10203.56 4323.04,-10221.4 4368,-10211.5 4411.6,-10201.9 4458.37,-10181.17 4490.39,-10165.2"/>
<polygon fill="red" stroke="red" points="4492.08,-10168.27 4499.42,-10160.63 4488.92,-10162.02 4492.08,-10168.27"/>
<text text-anchor="middle" x="4192.5" y="-10223.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu8 -->
<g id="node169" class="node">
<title>l1_attn_stage9_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2903" cy="-10143" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2903" y="-10154.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="2903" y="-10139.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2903" y="-10124.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu8&#45;&gt;l1_attn_stage9_gpu8 -->
<g id="edge153" class="edge">
<title>l1_attn_stage8_gpu8&#45;&gt;l1_attn_stage9_gpu8</title>
<path fill="none" stroke="black" d="M2903,-10252.41C2903,-10233.69 2903,-10210.7 2903,-10190.71"/>
<polygon fill="black" stroke="black" points="2906.5,-10190.58 2903,-10180.58 2899.5,-10190.58 2906.5,-10190.58"/>
</g>
<!-- l1_attn_stage8_gpu8&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge1369" class="edge">
<title>l1_attn_stage8_gpu8&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2956.28,-10259.96C2970.42,-10253.62 2985.95,-10247.82 3001,-10244.5 3067.57,-10229.81 4163.69,-10257.12 4228,-10234.5 4238.15,-10230.93 4236.96,-10223.36 4247,-10219.5 4297.3,-10200.15 4315.53,-10223.81 4368,-10211.5 4411.2,-10201.36 4457.67,-10180.92 4489.71,-10165.17"/>
<polygon fill="red" stroke="red" points="4491.38,-10168.25 4498.77,-10160.66 4488.25,-10161.99 4491.38,-10168.25"/>
<text text-anchor="middle" x="4278.5" y="-10223.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu9 -->
<g id="node170" class="node">
<title>l1_attn_stage9_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3098" cy="-10143" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3098" y="-10154.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="3098" y="-10139.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3098" y="-10124.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu9&#45;&gt;l1_attn_stage9_gpu9 -->
<g id="edge154" class="edge">
<title>l1_attn_stage8_gpu9&#45;&gt;l1_attn_stage9_gpu9</title>
<path fill="none" stroke="black" d="M3098,-10252.41C3098,-10233.69 3098,-10210.7 3098,-10190.71"/>
<polygon fill="black" stroke="black" points="3101.5,-10190.58 3098,-10180.58 3094.5,-10190.58 3101.5,-10190.58"/>
</g>
<!-- l1_attn_stage8_gpu9&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge1370" class="edge">
<title>l1_attn_stage8_gpu9&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3151.28,-10259.97C3165.42,-10253.63 3180.95,-10247.83 3196,-10244.5 3256.65,-10231.09 4255.41,-10255.13 4314,-10234.5 4324.15,-10230.92 4323.3,-10224.14 4333,-10219.5 4347.39,-10212.61 4352.8,-10216.36 4368,-10211.5 4408.94,-10198.4 4453.95,-10179.24 4486.12,-10164.67"/>
<polygon fill="red" stroke="red" points="4487.61,-10167.84 4495.25,-10160.51 4484.7,-10161.47 4487.61,-10167.84"/>
<text text-anchor="middle" x="4364.5" y="-10223.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu10 -->
<g id="node171" class="node">
<title>l1_attn_stage9_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3293" cy="-10143" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3293" y="-10154.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="3293" y="-10139.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3293" y="-10124.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu10&#45;&gt;l1_attn_stage9_gpu10 -->
<g id="edge155" class="edge">
<title>l1_attn_stage8_gpu10&#45;&gt;l1_attn_stage9_gpu10</title>
<path fill="none" stroke="black" d="M3293,-10252.41C3293,-10233.69 3293,-10210.7 3293,-10190.71"/>
<polygon fill="black" stroke="black" points="3296.5,-10190.58 3293,-10180.58 3289.5,-10190.58 3296.5,-10190.58"/>
</g>
<!-- l1_attn_stage8_gpu10&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge1371" class="edge">
<title>l1_attn_stage8_gpu10&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3346.29,-10259.98C3360.42,-10253.64 3375.95,-10247.83 3391,-10244.5 3445.73,-10232.37 4347.13,-10253.14 4400,-10234.5 4410.15,-10230.92 4410.32,-10225.86 4419,-10219.5 4444.22,-10201 4473.5,-10181.15 4495.65,-10166.45"/>
<polygon fill="red" stroke="red" points="4497.66,-10169.32 4504.07,-10160.88 4493.8,-10163.48 4497.66,-10169.32"/>
<text text-anchor="middle" x="4450.5" y="-10223.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu11 -->
<g id="node172" class="node">
<title>l1_attn_stage9_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3488" cy="-10143" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3488" y="-10154.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="3488" y="-10139.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3488" y="-10124.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu11&#45;&gt;l1_attn_stage9_gpu11 -->
<g id="edge156" class="edge">
<title>l1_attn_stage8_gpu11&#45;&gt;l1_attn_stage9_gpu11</title>
<path fill="none" stroke="black" d="M3488,-10252.41C3488,-10233.69 3488,-10210.7 3488,-10190.71"/>
<polygon fill="black" stroke="black" points="3491.5,-10190.58 3488,-10180.58 3484.5,-10190.58 3491.5,-10190.58"/>
</g>
<!-- l1_attn_stage8_gpu11&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge1372" class="edge">
<title>l1_attn_stage8_gpu11&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3541.29,-10259.99C3555.42,-10253.65 3570.95,-10247.84 3586,-10244.5 3610.41,-10239.07 4464.88,-10247.88 4486,-10234.5 4507.94,-10220.6 4519.24,-10192.32 4524.85,-10171.05"/>
<polygon fill="red" stroke="red" points="4528.27,-10171.81 4527.18,-10161.27 4521.46,-10170.19 4528.27,-10171.81"/>
<text text-anchor="middle" x="4532.5" y="-10223.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu12 -->
<g id="node173" class="node">
<title>l1_attn_stage9_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3683" cy="-10143" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3683" y="-10154.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="3683" y="-10139.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3683" y="-10124.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu12&#45;&gt;l1_attn_stage9_gpu12 -->
<g id="edge157" class="edge">
<title>l1_attn_stage8_gpu12&#45;&gt;l1_attn_stage9_gpu12</title>
<path fill="none" stroke="black" d="M3627.85,-10260.53C3614.43,-10254.5 3599.93,-10248.69 3586,-10244.5 3572.22,-10240.35 3531.36,-10245.43 3522,-10234.5 3487.08,-10193.7 3527.79,-10233.82 3586,-10211.5 3603.78,-10204.68 3621.42,-10193.93 3636.68,-10183"/>
<polygon fill="black" stroke="black" points="3638.93,-10185.69 3644.9,-10176.94 3634.77,-10180.06 3638.93,-10185.69"/>
</g>
<!-- l1_attn_stage8_gpu12&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge1373" class="edge">
<title>l1_attn_stage8_gpu12&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3736.29,-10260.01C3750.43,-10253.67 3765.95,-10247.85 3781,-10244.5 3802.45,-10239.71 4556.56,-10250.13 4572,-10234.5 4590.16,-10216.11 4572.89,-10188.42 4555.31,-10168.51"/>
<polygon fill="red" stroke="red" points="4557.75,-10165.99 4548.38,-10161.03 4552.61,-10170.75 4557.75,-10165.99"/>
<text text-anchor="middle" x="4610.5" y="-10223.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu13 -->
<g id="node174" class="node">
<title>l1_attn_stage9_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3878" cy="-10143" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3878" y="-10154.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="3878" y="-10139.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3878" y="-10124.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu13&#45;&gt;l1_attn_stage9_gpu13 -->
<g id="edge158" class="edge">
<title>l1_attn_stage8_gpu13&#45;&gt;l1_attn_stage9_gpu13</title>
<path fill="none" stroke="black" d="M3824.7,-10260.06C3810.85,-10253.8 3795.69,-10248.01 3781,-10244.5 3767.37,-10241.24 3538.71,-10244.6 3529,-10234.5 3524.38,-10229.69 3524.36,-10224.29 3529,-10219.5 3538.75,-10209.44 3767.7,-10215.9 3781,-10211.5 3799.4,-10205.4 3817.44,-10194.61 3832.87,-10183.42"/>
<polygon fill="black" stroke="black" points="3835.27,-10185.99 3841.16,-10177.19 3831.06,-10180.4 3835.27,-10185.99"/>
</g>
<!-- l1_attn_stage8_gpu13&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge1374" class="edge">
<title>l1_attn_stage8_gpu13&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3931.3,-10260.03C3945.43,-10253.69 3960.96,-10247.87 3976,-10244.5 3994.49,-10240.35 4644.7,-10247.99 4658,-10234.5 4686.36,-10205.72 4638.79,-10179.89 4593.82,-10163.26"/>
<polygon fill="red" stroke="red" points="4594.88,-10159.93 4584.29,-10159.86 4592.53,-10166.52 4594.88,-10159.93"/>
<text text-anchor="middle" x="4697.5" y="-10223.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu14 -->
<g id="node175" class="node">
<title>l1_attn_stage9_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4073" cy="-10143" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4073" y="-10154.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="4073" y="-10139.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4073" y="-10124.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu14&#45;&gt;l1_attn_stage9_gpu14 -->
<g id="edge159" class="edge">
<title>l1_attn_stage8_gpu14&#45;&gt;l1_attn_stage9_gpu14</title>
<path fill="none" stroke="black" d="M4019.74,-10259.88C4005.89,-10253.63 3990.71,-10247.89 3976,-10244.5 3952.17,-10239.01 3553.09,-10251.98 3536,-10234.5 3531.34,-10229.73 3531.33,-10224.25 3536,-10219.5 3544.56,-10210.78 3964.37,-10215.26 3976,-10211.5 3994.45,-10205.53 4012.49,-10194.77 4027.92,-10183.57"/>
<polygon fill="black" stroke="black" points="4030.32,-10186.14 4036.2,-10177.33 4026.11,-10180.54 4030.32,-10186.14"/>
</g>
<!-- l1_attn_stage8_gpu14&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge1375" class="edge">
<title>l1_attn_stage8_gpu14&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4126.3,-10260.06C4140.44,-10253.72 4155.96,-10247.89 4171,-10244.5 4186.53,-10241 4732.84,-10245.85 4744,-10234.5 4784.03,-10193.76 4714.32,-10170.4 4644.01,-10157.66"/>
<polygon fill="red" stroke="red" points="4644.55,-10154.2 4634.1,-10155.93 4643.35,-10161.1 4644.55,-10154.2"/>
<text text-anchor="middle" x="4784.5" y="-10223.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage9_gpu15 -->
<g id="node176" class="node">
<title>l1_attn_stage9_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4268" cy="-10143" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4268" y="-10154.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage9</text>
<text text-anchor="middle" x="4268" y="-10139.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4268" y="-10124.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage8_gpu15&#45;&gt;l1_attn_stage9_gpu15 -->
<g id="edge160" class="edge">
<title>l1_attn_stage8_gpu15&#45;&gt;l1_attn_stage9_gpu15</title>
<path fill="none" stroke="black" d="M4215.02,-10259.93C4201.09,-10253.63 4185.82,-10247.86 4171,-10244.5 4153.99,-10240.64 3555.24,-10246.93 3543,-10234.5 3538.32,-10229.75 3538.32,-10224.24 3543,-10219.5 3555.26,-10207.08 4154.39,-10216.83 4171,-10211.5 4189.46,-10205.58 4207.51,-10194.83 4222.94,-10183.63"/>
<polygon fill="black" stroke="black" points="4225.34,-10186.2 4231.22,-10177.38 4221.13,-10180.6 4225.34,-10186.2"/>
</g>
<!-- l1_attn_stage8_gpu15&#45;&gt;l1_attn_stage9_gpu[next_gpu] -->
<g id="edge1376" class="edge">
<title>l1_attn_stage8_gpu15&#45;&gt;l1_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4323.38,-10260.68C4338.74,-10254.12 4355.68,-10248.03 4372,-10244.5 4396.87,-10239.12 4812.2,-10252.69 4830,-10234.5 4884.67,-10178.62 4783.45,-10156.96 4684.12,-10148.71"/>
<polygon fill="red" stroke="red" points="4684.15,-10145.2 4673.9,-10147.9 4683.6,-10152.18 4684.15,-10145.2"/>
<text text-anchor="middle" x="4870.5" y="-10223.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu0 -->
<g id="node177" class="node">
<title>l1_attn_stage10_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1141" cy="-9996" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1141" y="-10007.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="1141" y="-9992.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1141" y="-9977.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu0&#45;&gt;l1_attn_stage10_gpu0 -->
<g id="edge161" class="edge">
<title>l1_attn_stage9_gpu0&#45;&gt;l1_attn_stage10_gpu0</title>
<path fill="none" stroke="black" d="M1298.67,-10110.18C1267.97,-10088.14 1226.93,-10058.68 1194.42,-10035.35"/>
<polygon fill="black" stroke="black" points="1196.09,-10032.23 1185.92,-10029.25 1192.01,-10037.92 1196.09,-10032.23"/>
</g>
<!-- l1_attn_stage10_gpu[next_gpu] -->
<g id="node1322" class="node">
<title>l1_attn_stage10_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4536" cy="-9996" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4536" y="-9992.3" font-family="Times,serif" font-size="14.00">l1_attn_stage10_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage9_gpu0&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge1377" class="edge">
<title>l1_attn_stage9_gpu0&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1396.29,-10113C1410.43,-10106.66 1425.95,-10100.85 1441,-10097.5 1669.1,-10046.71 3310.33,-10075.02 3544,-10072.5 3589.78,-10072 4323.1,-10073.41 4368,-10064.5 4413.32,-10055.51 4461.98,-10034.59 4495.21,-10018.4"/>
<polygon fill="red" stroke="red" points="4497.17,-10021.34 4504.58,-10013.76 4494.06,-10015.06 4497.17,-10021.34"/>
<text text-anchor="middle" x="3575.5" y="-10076.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu1 -->
<g id="node178" class="node">
<title>l1_attn_stage10_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1349" cy="-9996" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1349" y="-10007.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="1349" y="-9992.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1349" y="-9977.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu1&#45;&gt;l1_attn_stage10_gpu1 -->
<g id="edge162" class="edge">
<title>l1_attn_stage9_gpu1&#45;&gt;l1_attn_stage10_gpu1</title>
<path fill="none" stroke="black" d="M1496.05,-10109.82C1467.62,-10088.01 1429.89,-10059.06 1399.76,-10035.94"/>
<polygon fill="black" stroke="black" points="1401.55,-10032.9 1391.48,-10029.59 1397.29,-10038.45 1401.55,-10032.9"/>
</g>
<!-- l1_attn_stage9_gpu1&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge1378" class="edge">
<title>l1_attn_stage9_gpu1&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1591.28,-10112.93C1605.41,-10106.59 1620.94,-10100.8 1636,-10097.5 1689.59,-10085.76 3559.22,-10105.62 3611,-10087.5 3621.15,-10083.94 3619.86,-10076.08 3630,-10072.5 3668.66,-10058.84 4327.79,-10072.5 4368,-10064.5 4413.31,-10055.48 4461.98,-10034.56 4495.21,-10018.39"/>
<polygon fill="red" stroke="red" points="4497.17,-10021.32 4504.58,-10013.75 4494.06,-10015.05 4497.17,-10021.32"/>
<text text-anchor="middle" x="3661.5" y="-10076.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu2 -->
<g id="node179" class="node">
<title>l1_attn_stage10_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1557" cy="-9996" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1557" y="-10007.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="1557" y="-9992.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1557" y="-9977.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu2&#45;&gt;l1_attn_stage10_gpu2 -->
<g id="edge163" class="edge">
<title>l1_attn_stage9_gpu2&#45;&gt;l1_attn_stage10_gpu2</title>
<path fill="none" stroke="black" d="M1693.06,-10109.1C1666.94,-10087.57 1632.66,-10059.34 1605.05,-10036.59"/>
<polygon fill="black" stroke="black" points="1607.03,-10033.68 1597.08,-10030.02 1602.58,-10039.08 1607.03,-10033.68"/>
</g>
<!-- l1_attn_stage9_gpu2&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge1379" class="edge">
<title>l1_attn_stage9_gpu2&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1786.28,-10112.93C1800.41,-10106.59 1815.94,-10100.8 1831,-10097.5 1881.63,-10086.4 3648.08,-10104.63 3697,-10087.5 3707.15,-10083.94 3705.86,-10076.09 3716,-10072.5 3750.15,-10060.41 4332.48,-10071.59 4368,-10064.5 4413.31,-10055.45 4461.97,-10034.54 4495.2,-10018.37"/>
<polygon fill="red" stroke="red" points="4497.16,-10021.31 4504.57,-10013.74 4494.06,-10015.03 4497.16,-10021.31"/>
<text text-anchor="middle" x="3747.5" y="-10076.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu3 -->
<g id="node180" class="node">
<title>l1_attn_stage10_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1765" cy="-9996" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1765" y="-10007.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="1765" y="-9992.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1765" y="-9977.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu3&#45;&gt;l1_attn_stage10_gpu3 -->
<g id="edge164" class="edge">
<title>l1_attn_stage9_gpu3&#45;&gt;l1_attn_stage10_gpu3</title>
<path fill="none" stroke="black" d="M1890.6,-10108.73C1866.75,-10087.52 1835.69,-10059.88 1810.43,-10037.41"/>
<polygon fill="black" stroke="black" points="1812.58,-10034.64 1802.79,-10030.61 1807.93,-10039.87 1812.58,-10034.64"/>
</g>
<!-- l1_attn_stage9_gpu3&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge1380" class="edge">
<title>l1_attn_stage9_gpu3&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1981.28,-10112.94C1995.41,-10106.6 2010.94,-10100.8 2026,-10097.5 2073.67,-10087.04 3736.94,-10103.64 3783,-10087.5 3793.15,-10083.94 3791.86,-10076.1 3802,-10072.5 3831.63,-10061.97 4337.17,-10070.69 4368,-10064.5 4413.3,-10055.41 4461.97,-10034.5 4495.2,-10018.35"/>
<polygon fill="red" stroke="red" points="4497.15,-10021.28 4504.57,-10013.72 4494.05,-10015.01 4497.15,-10021.28"/>
<text text-anchor="middle" x="3833.5" y="-10076.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu4 -->
<g id="node181" class="node">
<title>l1_attn_stage10_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1973" cy="-9996" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1973" y="-10007.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="1973" y="-9992.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1973" y="-9977.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu4&#45;&gt;l1_attn_stage10_gpu4 -->
<g id="edge165" class="edge">
<title>l1_attn_stage9_gpu4&#45;&gt;l1_attn_stage10_gpu4</title>
<path fill="none" stroke="black" d="M2088.21,-10108.37C2066.5,-10087.38 2038.41,-10060.23 2015.4,-10037.98"/>
<polygon fill="black" stroke="black" points="2017.74,-10035.38 2008.12,-10030.95 2012.88,-10040.41 2017.74,-10035.38"/>
</g>
<!-- l1_attn_stage9_gpu4&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge1381" class="edge">
<title>l1_attn_stage9_gpu4&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2176.28,-10112.94C2190.41,-10106.6 2205.94,-10100.8 2221,-10097.5 2265.71,-10087.68 3825.8,-10102.64 3869,-10087.5 3879.15,-10083.94 3877.87,-10076.11 3888,-10072.5 3938.24,-10054.58 4315.72,-10075.06 4368,-10064.5 4413.29,-10055.35 4461.96,-10034.45 4495.19,-10018.31"/>
<polygon fill="red" stroke="red" points="4497.14,-10021.25 4504.56,-10013.69 4494.05,-10014.98 4497.14,-10021.25"/>
<text text-anchor="middle" x="3919.5" y="-10076.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu5 -->
<g id="node182" class="node">
<title>l1_attn_stage10_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2181" cy="-9996" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2181" y="-10007.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="2181" y="-9992.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2181" y="-9977.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu5&#45;&gt;l1_attn_stage10_gpu5 -->
<g id="edge166" class="edge">
<title>l1_attn_stage9_gpu5&#45;&gt;l1_attn_stage10_gpu5</title>
<path fill="none" stroke="black" d="M2285.88,-10108C2266.35,-10087.34 2241.27,-10060.79 2220.53,-10038.84"/>
<polygon fill="black" stroke="black" points="2222.81,-10036.15 2213.39,-10031.28 2217.72,-10040.96 2222.81,-10036.15"/>
</g>
<!-- l1_attn_stage9_gpu5&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge1382" class="edge">
<title>l1_attn_stage9_gpu5&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2371.28,-10112.94C2385.41,-10106.61 2400.94,-10100.81 2416,-10097.5 2457.75,-10088.32 3914.66,-10101.65 3955,-10087.5 3965.15,-10083.94 3963.87,-10076.13 3974,-10072.5 4015.22,-10057.72 4325.1,-10073.25 4368,-10064.5 4413.27,-10055.27 4461.94,-10034.38 4495.18,-10018.27"/>
<polygon fill="red" stroke="red" points="4497.13,-10021.21 4504.56,-10013.65 4494.04,-10014.93 4497.13,-10021.21"/>
<text text-anchor="middle" x="4005.5" y="-10076.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu6 -->
<g id="node183" class="node">
<title>l1_attn_stage10_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2389" cy="-9996" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2389" y="-10007.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="2389" y="-9992.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2389" y="-9977.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu6&#45;&gt;l1_attn_stage10_gpu6 -->
<g id="edge167" class="edge">
<title>l1_attn_stage9_gpu6&#45;&gt;l1_attn_stage10_gpu6</title>
<path fill="none" stroke="black" d="M2483.3,-10107.27C2465.88,-10086.9 2443.74,-10061.01 2425.29,-10039.43"/>
<polygon fill="black" stroke="black" points="2427.83,-10037.02 2418.67,-10031.7 2422.51,-10041.57 2427.83,-10037.02"/>
</g>
<!-- l1_attn_stage9_gpu6&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge1383" class="edge">
<title>l1_attn_stage9_gpu6&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2566.28,-10112.95C2580.41,-10106.61 2595.94,-10100.81 2611,-10097.5 2649.79,-10088.96 4003.52,-10100.66 4041,-10087.5 4051.15,-10083.93 4049.88,-10076.16 4060,-10072.5 4092.19,-10060.85 4334.48,-10071.43 4368,-10064.5 4413.11,-10055.17 4461.62,-10034.4 4494.86,-10018.35"/>
<polygon fill="red" stroke="red" points="4496.8,-10021.3 4504.24,-10013.75 4493.72,-10015.01 4496.8,-10021.3"/>
<text text-anchor="middle" x="4091.5" y="-10076.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu7 -->
<g id="node184" class="node">
<title>l1_attn_stage10_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2597" cy="-9996" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2597" y="-10007.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="2597" y="-9992.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2597" y="-9977.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu7&#45;&gt;l1_attn_stage10_gpu7 -->
<g id="edge168" class="edge">
<title>l1_attn_stage9_gpu7&#45;&gt;l1_attn_stage10_gpu7</title>
<path fill="none" stroke="black" d="M2681.13,-10106.9C2665.71,-10086.76 2646.23,-10061.31 2629.9,-10039.98"/>
<polygon fill="black" stroke="black" points="2632.67,-10037.84 2623.81,-10032.03 2627.11,-10042.09 2632.67,-10037.84"/>
</g>
<!-- l1_attn_stage9_gpu7&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge1384" class="edge">
<title>l1_attn_stage9_gpu7&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2761.28,-10112.96C2775.42,-10106.62 2790.95,-10100.82 2806,-10097.5 2877.67,-10081.7 4057.76,-10111.83 4127,-10087.5 4137.15,-10083.93 4135.9,-10076.21 4146,-10072.5 4192.34,-10055.47 4319.71,-10074.74 4368,-10064.5 4413.06,-10054.94 4461.58,-10034.21 4494.83,-10018.23"/>
<polygon fill="red" stroke="red" points="4496.76,-10021.18 4504.22,-10013.65 4493.69,-10014.89 4496.76,-10021.18"/>
<text text-anchor="middle" x="4177.5" y="-10076.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu8 -->
<g id="node185" class="node">
<title>l1_attn_stage10_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2805" cy="-9996" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2805" y="-10007.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="2805" y="-9992.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2805" y="-9977.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu8&#45;&gt;l1_attn_stage10_gpu8 -->
<g id="edge169" class="edge">
<title>l1_attn_stage9_gpu8&#45;&gt;l1_attn_stage10_gpu8</title>
<path fill="none" stroke="black" d="M2879.03,-10106.53C2865.63,-10086.7 2848.82,-10061.83 2834.61,-10040.8"/>
<polygon fill="black" stroke="black" points="2837.4,-10038.68 2828.9,-10032.35 2831.6,-10042.6 2837.4,-10038.68"/>
</g>
<!-- l1_attn_stage9_gpu8&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge1385" class="edge">
<title>l1_attn_stage9_gpu8&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2956.28,-10112.96C2970.42,-10106.62 2985.95,-10100.82 3001,-10097.5 3066.75,-10082.98 4149.48,-10109.84 4213,-10087.5 4223.15,-10083.93 4221.94,-10076.32 4232,-10072.5 4260.3,-10061.73 4338.46,-10071.12 4368,-10064.5 4412.67,-10054.49 4460.88,-10034.03 4494.15,-10018.24"/>
<polygon fill="red" stroke="red" points="4496.06,-10021.21 4503.55,-10013.72 4493.02,-10014.9 4496.06,-10021.21"/>
<text text-anchor="middle" x="4263.5" y="-10076.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu9 -->
<g id="node186" class="node">
<title>l1_attn_stage10_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3013" cy="-9996" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3013" y="-10007.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="3013" y="-9992.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3013" y="-9977.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu9&#45;&gt;l1_attn_stage10_gpu9 -->
<g id="edge170" class="edge">
<title>l1_attn_stage9_gpu9&#45;&gt;l1_attn_stage10_gpu9</title>
<path fill="none" stroke="black" d="M3077.21,-10106.53C3065.68,-10086.87 3051.24,-10062.24 3038.98,-10041.32"/>
<polygon fill="black" stroke="black" points="3041.95,-10039.46 3033.87,-10032.61 3035.91,-10043 3041.95,-10039.46"/>
</g>
<!-- l1_attn_stage9_gpu9&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge1386" class="edge">
<title>l1_attn_stage9_gpu9&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3151.29,-10112.97C3165.42,-10106.63 3180.95,-10100.83 3196,-10097.5 3255.83,-10084.26 4241.2,-10107.86 4299,-10087.5 4309.15,-10083.92 4308.15,-10076.82 4318,-10072.5 4338.61,-10063.46 4346.31,-10070.51 4368,-10064.5 4411.28,-10052.5 4458.59,-10032.87 4491.94,-10017.86"/>
<polygon fill="red" stroke="red" points="4493.74,-10020.89 4501.4,-10013.56 4490.84,-10014.51 4493.74,-10020.89"/>
<text text-anchor="middle" x="4349.5" y="-10076.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu10 -->
<g id="node187" class="node">
<title>l1_attn_stage10_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3221" cy="-9996" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3221" y="-10007.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="3221" y="-9992.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3221" y="-9977.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu10&#45;&gt;l1_attn_stage10_gpu10 -->
<g id="edge171" class="edge">
<title>l1_attn_stage9_gpu10&#45;&gt;l1_attn_stage10_gpu10</title>
<path fill="none" stroke="black" d="M3275.2,-10106.16C3265.6,-10086.81 3253.64,-10062.74 3243.41,-10042.13"/>
<polygon fill="black" stroke="black" points="3246.42,-10040.33 3238.84,-10032.93 3240.16,-10043.44 3246.42,-10040.33"/>
</g>
<!-- l1_attn_stage9_gpu10&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge1387" class="edge">
<title>l1_attn_stage9_gpu10&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3346.29,-10112.98C3360.42,-10106.64 3375.95,-10100.83 3391,-10097.5 3444.92,-10085.55 4332.92,-10105.87 4385,-10087.5 4395.15,-10083.92 4395.08,-10078.52 4404,-10072.5 4433.36,-10052.67 4468.2,-10032.89 4494.72,-10018.55"/>
<polygon fill="red" stroke="red" points="4496.57,-10021.53 4503.73,-10013.71 4493.26,-10015.36 4496.57,-10021.53"/>
<text text-anchor="middle" x="4435.5" y="-10076.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu11 -->
<g id="node188" class="node">
<title>l1_attn_stage10_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3429" cy="-9996" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3429" y="-10007.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="3429" y="-9992.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3429" y="-9977.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu11&#45;&gt;l1_attn_stage10_gpu11 -->
<g id="edge172" class="edge">
<title>l1_attn_stage9_gpu11&#45;&gt;l1_attn_stage10_gpu11</title>
<path fill="none" stroke="black" d="M3473.26,-10105.78C3465.49,-10086.66 3455.86,-10063.01 3447.58,-10042.65"/>
<polygon fill="black" stroke="black" points="3450.76,-10041.2 3443.75,-10033.25 3444.28,-10043.84 3450.76,-10041.2"/>
</g>
<!-- l1_attn_stage9_gpu11&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge1388" class="edge">
<title>l1_attn_stage9_gpu11&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3541.29,-10112.99C3555.42,-10106.65 3570.95,-10100.84 3586,-10097.5 3610,-10092.16 4449.19,-10098.84 4471,-10087.5 4484.7,-10080.37 4506.58,-10046.95 4521.12,-10022.8"/>
<polygon fill="red" stroke="red" points="4524.21,-10024.45 4526.3,-10014.07 4518.19,-10020.88 4524.21,-10024.45"/>
<text text-anchor="middle" x="4517.5" y="-10076.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu12 -->
<g id="node189" class="node">
<title>l1_attn_stage10_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3637" cy="-9996" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3637" y="-10007.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="3637" y="-9992.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3637" y="-9977.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu12&#45;&gt;l1_attn_stage10_gpu12 -->
<g id="edge173" class="edge">
<title>l1_attn_stage9_gpu12&#45;&gt;l1_attn_stage10_gpu12</title>
<path fill="none" stroke="black" d="M3628.2,-10113.36C3614.7,-10107.29 3600.07,-10101.51 3586,-10097.5 3568.98,-10092.64 3518.7,-10100.77 3507,-10087.5 3502.59,-10082.5 3503.04,-10077.86 3507,-10072.5 3514.18,-10062.77 3522.05,-10069.62 3533,-10064.5 3550.44,-10056.35 3568.39,-10045.65 3584.36,-10035.19"/>
<polygon fill="black" stroke="black" points="3586.64,-10037.88 3593.02,-10029.42 3582.76,-10032.05 3586.64,-10037.88"/>
</g>
<!-- l1_attn_stage9_gpu12&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge1389" class="edge">
<title>l1_attn_stage9_gpu12&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3736.29,-10113.01C3750.43,-10106.67 3765.95,-10100.86 3781,-10097.5 3802.04,-10092.8 4541.86,-10102.84 4557,-10087.5 4573.7,-10070.58 4564.21,-10043.13 4553.14,-10022.9"/>
<polygon fill="red" stroke="red" points="4556.11,-10021.03 4548.04,-10014.17 4550.07,-10024.57 4556.11,-10021.03"/>
<text text-anchor="middle" x="4595.5" y="-10076.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu13 -->
<g id="node190" class="node">
<title>l1_attn_stage10_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3845" cy="-9996" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3845" y="-10007.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="3845" y="-9992.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3845" y="-9977.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu13&#45;&gt;l1_attn_stage10_gpu13 -->
<g id="edge174" class="edge">
<title>l1_attn_stage9_gpu13&#45;&gt;l1_attn_stage10_gpu13</title>
<path fill="none" stroke="black" d="M3824.71,-10113.03C3810.86,-10106.78 3795.69,-10101 3781,-10097.5 3766.56,-10094.06 3524.3,-10098.19 3514,-10087.5 3509.38,-10082.7 3509.37,-10077.29 3514,-10072.5 3522.76,-10063.42 3728.97,-10068.29 3741,-10064.5 3760.58,-10058.32 3780,-10047.38 3796.67,-10036.08"/>
<polygon fill="black" stroke="black" points="3798.94,-10038.76 3805.13,-10030.16 3794.93,-10033.03 3798.94,-10038.76"/>
</g>
<!-- l1_attn_stage9_gpu13&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge1390" class="edge">
<title>l1_attn_stage9_gpu13&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3931.3,-10113.03C3945.43,-10106.69 3960.96,-10100.87 3976,-10097.5 3994.08,-10093.44 4630,-10100.7 4643,-10087.5 4668.61,-10061.5 4627.49,-10034.91 4589.03,-10017.33"/>
<polygon fill="red" stroke="red" points="4590.43,-10014.13 4579.87,-10013.29 4587.61,-10020.53 4590.43,-10014.13"/>
<text text-anchor="middle" x="4681.5" y="-10076.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu14 -->
<g id="node191" class="node">
<title>l1_attn_stage10_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4053" cy="-9996" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4053" y="-10007.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="4053" y="-9992.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4053" y="-9977.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu14&#45;&gt;l1_attn_stage10_gpu14 -->
<g id="edge175" class="edge">
<title>l1_attn_stage9_gpu14&#45;&gt;l1_attn_stage10_gpu14</title>
<path fill="none" stroke="black" d="M4019.75,-10112.87C4005.89,-10106.62 3990.72,-10100.88 3976,-10097.5 3951.36,-10091.83 3538.68,-10105.57 3521,-10087.5 3516.34,-10082.73 3516.33,-10077.26 3521,-10072.5 3529.33,-10064.01 3937.63,-10067.98 3949,-10064.5 3968.63,-10058.49 3988.07,-10047.58 4004.73,-10036.27"/>
<polygon fill="black" stroke="black" points="4007.01,-10038.95 4013.18,-10030.34 4002.99,-10033.22 4007.01,-10038.95"/>
</g>
<!-- l1_attn_stage9_gpu14&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge1391" class="edge">
<title>l1_attn_stage9_gpu14&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4126.31,-10113.06C4140.44,-10106.72 4155.96,-10100.89 4171,-10097.5 4186.12,-10094.08 4718.14,-10098.56 4729,-10087.5 4765.82,-10050.02 4702.45,-10026.28 4638.69,-10012.56"/>
<polygon fill="red" stroke="red" points="4639.38,-10009.13 4628.88,-10010.53 4637.96,-10015.98 4639.38,-10009.13"/>
<text text-anchor="middle" x="4768.5" y="-10076.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage10_gpu15 -->
<g id="node192" class="node">
<title>l1_attn_stage10_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4261" cy="-9996" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4261" y="-10007.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage10</text>
<text text-anchor="middle" x="4261" y="-9992.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4261" y="-9977.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage9_gpu15&#45;&gt;l1_attn_stage10_gpu15 -->
<g id="edge176" class="edge">
<title>l1_attn_stage9_gpu15&#45;&gt;l1_attn_stage10_gpu15</title>
<path fill="none" stroke="black" d="M4215.02,-10112.92C4201.09,-10106.63 4185.82,-10100.86 4171,-10097.5 4153.58,-10093.55 3540.53,-10100.23 3528,-10087.5 3523.32,-10082.75 3523.32,-10077.24 3528,-10072.5 3540.28,-10060.06 4140.28,-10069.56 4157,-10064.5 4176.65,-10058.54 4196.09,-10047.66 4212.75,-10036.34"/>
<polygon fill="black" stroke="black" points="4215.03,-10039.02 4221.2,-10030.41 4211.01,-10033.29 4215.03,-10039.02"/>
</g>
<!-- l1_attn_stage9_gpu15&#45;&gt;l1_attn_stage10_gpu[next_gpu] -->
<g id="edge1392" class="edge">
<title>l1_attn_stage9_gpu15&#45;&gt;l1_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4323.38,-10113.69C4338.74,-10107.13 4355.69,-10101.03 4372,-10097.5 4396.06,-10092.28 4797.79,-10105.1 4815,-10087.5 4864.67,-10036.7 4777.33,-10014.39 4687.57,-10004.6"/>
<polygon fill="red" stroke="red" points="4687.78,-10001.11 4677.47,-10003.56 4687.05,-10008.07 4687.78,-10001.11"/>
<text text-anchor="middle" x="4854.5" y="-10076.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu0 -->
<g id="node193" class="node">
<title>l1_attn_stage11_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1141" cy="-9849" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1141" y="-9860.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="1141" y="-9845.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1141" y="-9830.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu0&#45;&gt;l1_attn_stage11_gpu0 -->
<g id="edge177" class="edge">
<title>l1_attn_stage10_gpu0&#45;&gt;l1_attn_stage11_gpu0</title>
<path fill="none" stroke="black" d="M1141,-9958.41C1141,-9939.69 1141,-9916.7 1141,-9896.71"/>
<polygon fill="black" stroke="black" points="1144.5,-9896.58 1141,-9886.58 1137.5,-9896.58 1144.5,-9896.58"/>
</g>
<!-- l1_attn_stage11_gpu[next_gpu] -->
<g id="node1323" class="node">
<title>l1_attn_stage11_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4536" cy="-9849" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4536" y="-9845.3" font-family="Times,serif" font-size="14.00">l1_attn_stage11_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage10_gpu0&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge1393" class="edge">
<title>l1_attn_stage10_gpu0&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1197.98,-9965.87C1212.91,-9959.58 1229.24,-9953.82 1245,-9950.5 1494.97,-9897.85 3288.55,-9928.13 3544,-9925.5 3589.78,-9925.03 4323.1,-9926.41 4368,-9917.5 4413.32,-9908.51 4461.98,-9887.59 4495.21,-9871.4"/>
<polygon fill="red" stroke="red" points="4497.17,-9874.34 4504.58,-9866.76 4494.06,-9868.06 4497.17,-9874.34"/>
<text text-anchor="middle" x="3575.5" y="-9929.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu1 -->
<g id="node194" class="node">
<title>l1_attn_stage11_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1349" cy="-9849" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1349" y="-9860.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="1349" y="-9845.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1349" y="-9830.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu1&#45;&gt;l1_attn_stage11_gpu1 -->
<g id="edge178" class="edge">
<title>l1_attn_stage10_gpu1&#45;&gt;l1_attn_stage11_gpu1</title>
<path fill="none" stroke="black" d="M1349,-9958.41C1349,-9939.69 1349,-9916.7 1349,-9896.71"/>
<polygon fill="black" stroke="black" points="1352.5,-9896.58 1349,-9886.58 1345.5,-9896.58 1352.5,-9896.58"/>
</g>
<!-- l1_attn_stage10_gpu1&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge1394" class="edge">
<title>l1_attn_stage10_gpu1&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1405.97,-9965.8C1420.89,-9959.51 1437.23,-9953.77 1453,-9950.5 1511.7,-9938.33 3554.42,-9960.29 3611,-9940.5 3621.16,-9936.95 3619.86,-9929.08 3630,-9925.5 3668.66,-9911.84 4327.79,-9925.5 4368,-9917.5 4413.31,-9908.48 4461.98,-9887.56 4495.21,-9871.39"/>
<polygon fill="red" stroke="red" points="4497.17,-9874.32 4504.58,-9866.75 4494.06,-9868.05 4497.17,-9874.32"/>
<text text-anchor="middle" x="3661.5" y="-9929.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu2 -->
<g id="node195" class="node">
<title>l1_attn_stage11_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1557" cy="-9849" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1557" y="-9860.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="1557" y="-9845.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1557" y="-9830.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu2&#45;&gt;l1_attn_stage11_gpu2 -->
<g id="edge179" class="edge">
<title>l1_attn_stage10_gpu2&#45;&gt;l1_attn_stage11_gpu2</title>
<path fill="none" stroke="black" d="M1557,-9958.41C1557,-9939.69 1557,-9916.7 1557,-9896.71"/>
<polygon fill="black" stroke="black" points="1560.5,-9896.58 1557,-9886.58 1553.5,-9896.58 1560.5,-9896.58"/>
</g>
<!-- l1_attn_stage10_gpu2&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge1395" class="edge">
<title>l1_attn_stage10_gpu2&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1613.97,-9965.8C1628.89,-9959.51 1645.23,-9953.77 1661,-9950.5 1716.38,-9939.01 3643.62,-9959.18 3697,-9940.5 3707.16,-9936.94 3705.86,-9929.09 3716,-9925.5 3750.15,-9913.41 4332.48,-9924.59 4368,-9917.5 4413.31,-9908.45 4461.97,-9887.54 4495.2,-9871.37"/>
<polygon fill="red" stroke="red" points="4497.16,-9874.31 4504.57,-9866.74 4494.06,-9868.03 4497.16,-9874.31"/>
<text text-anchor="middle" x="3747.5" y="-9929.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu3 -->
<g id="node196" class="node">
<title>l1_attn_stage11_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1765" cy="-9849" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1765" y="-9860.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="1765" y="-9845.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1765" y="-9830.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu3&#45;&gt;l1_attn_stage11_gpu3 -->
<g id="edge180" class="edge">
<title>l1_attn_stage10_gpu3&#45;&gt;l1_attn_stage11_gpu3</title>
<path fill="none" stroke="black" d="M1765,-9958.41C1765,-9939.69 1765,-9916.7 1765,-9896.71"/>
<polygon fill="black" stroke="black" points="1768.5,-9896.58 1765,-9886.58 1761.5,-9896.58 1768.5,-9896.58"/>
</g>
<!-- l1_attn_stage10_gpu3&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge1396" class="edge">
<title>l1_attn_stage10_gpu3&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1821.97,-9965.81C1836.9,-9959.51 1853.23,-9953.77 1869,-9950.5 1921.06,-9939.69 3732.82,-9958.07 3783,-9940.5 3793.15,-9936.94 3791.86,-9929.1 3802,-9925.5 3831.63,-9914.97 4337.17,-9923.69 4368,-9917.5 4413.3,-9908.41 4461.97,-9887.5 4495.2,-9871.35"/>
<polygon fill="red" stroke="red" points="4497.15,-9874.28 4504.57,-9866.72 4494.05,-9868.01 4497.15,-9874.28"/>
<text text-anchor="middle" x="3833.5" y="-9929.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu4 -->
<g id="node197" class="node">
<title>l1_attn_stage11_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1973" cy="-9849" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1973" y="-9860.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="1973" y="-9845.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1973" y="-9830.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu4&#45;&gt;l1_attn_stage11_gpu4 -->
<g id="edge181" class="edge">
<title>l1_attn_stage10_gpu4&#45;&gt;l1_attn_stage11_gpu4</title>
<path fill="none" stroke="black" d="M1973,-9958.41C1973,-9939.69 1973,-9916.7 1973,-9896.71"/>
<polygon fill="black" stroke="black" points="1976.5,-9896.58 1973,-9886.58 1969.5,-9896.58 1976.5,-9896.58"/>
</g>
<!-- l1_attn_stage10_gpu4&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge1397" class="edge">
<title>l1_attn_stage10_gpu4&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2029.97,-9965.81C2044.9,-9959.52 2061.23,-9953.78 2077,-9950.5 2125.74,-9940.37 3822.02,-9956.95 3869,-9940.5 3879.15,-9936.94 3877.87,-9929.11 3888,-9925.5 3938.24,-9907.58 4315.72,-9928.06 4368,-9917.5 4413.29,-9908.35 4461.96,-9887.45 4495.19,-9871.31"/>
<polygon fill="red" stroke="red" points="4497.14,-9874.25 4504.56,-9866.69 4494.05,-9867.98 4497.14,-9874.25"/>
<text text-anchor="middle" x="3919.5" y="-9929.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu5 -->
<g id="node198" class="node">
<title>l1_attn_stage11_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2181" cy="-9849" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2181" y="-9860.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="2181" y="-9845.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2181" y="-9830.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu5&#45;&gt;l1_attn_stage11_gpu5 -->
<g id="edge182" class="edge">
<title>l1_attn_stage10_gpu5&#45;&gt;l1_attn_stage11_gpu5</title>
<path fill="none" stroke="black" d="M2181,-9958.41C2181,-9939.69 2181,-9916.7 2181,-9896.71"/>
<polygon fill="black" stroke="black" points="2184.5,-9896.58 2181,-9886.58 2177.5,-9896.58 2184.5,-9896.58"/>
</g>
<!-- l1_attn_stage10_gpu5&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge1398" class="edge">
<title>l1_attn_stage10_gpu5&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2237.97,-9965.82C2252.9,-9959.52 2269.23,-9953.78 2285,-9950.5 2330.42,-9941.05 3911.22,-9955.84 3955,-9940.5 3965.15,-9936.94 3963.87,-9929.13 3974,-9925.5 4015.22,-9910.72 4325.1,-9926.25 4368,-9917.5 4413.27,-9908.27 4461.94,-9887.38 4495.18,-9871.27"/>
<polygon fill="red" stroke="red" points="4497.13,-9874.21 4504.56,-9866.65 4494.04,-9867.93 4497.13,-9874.21"/>
<text text-anchor="middle" x="4005.5" y="-9929.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu6 -->
<g id="node199" class="node">
<title>l1_attn_stage11_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2389" cy="-9849" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2389" y="-9860.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="2389" y="-9845.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2389" y="-9830.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu6&#45;&gt;l1_attn_stage11_gpu6 -->
<g id="edge183" class="edge">
<title>l1_attn_stage10_gpu6&#45;&gt;l1_attn_stage11_gpu6</title>
<path fill="none" stroke="black" d="M2389,-9958.41C2389,-9939.69 2389,-9916.7 2389,-9896.71"/>
<polygon fill="black" stroke="black" points="2392.5,-9896.58 2389,-9886.58 2385.5,-9896.58 2392.5,-9896.58"/>
</g>
<!-- l1_attn_stage10_gpu6&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge1399" class="edge">
<title>l1_attn_stage10_gpu6&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2445.97,-9965.82C2460.9,-9959.53 2477.23,-9953.78 2493,-9950.5 2535.1,-9941.73 4000.42,-9954.73 4041,-9940.5 4051.15,-9936.94 4049.88,-9929.16 4060,-9925.5 4092.19,-9913.85 4334.48,-9924.43 4368,-9917.5 4413.11,-9908.17 4461.62,-9887.4 4494.86,-9871.35"/>
<polygon fill="red" stroke="red" points="4496.8,-9874.3 4504.24,-9866.75 4493.72,-9868.01 4496.8,-9874.3"/>
<text text-anchor="middle" x="4091.5" y="-9929.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu7 -->
<g id="node200" class="node">
<title>l1_attn_stage11_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2597" cy="-9849" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2597" y="-9860.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="2597" y="-9845.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2597" y="-9830.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu7&#45;&gt;l1_attn_stage11_gpu7 -->
<g id="edge184" class="edge">
<title>l1_attn_stage10_gpu7&#45;&gt;l1_attn_stage11_gpu7</title>
<path fill="none" stroke="black" d="M2597,-9958.41C2597,-9939.69 2597,-9916.7 2597,-9896.71"/>
<polygon fill="black" stroke="black" points="2600.5,-9896.58 2597,-9886.58 2593.5,-9896.58 2600.5,-9896.58"/>
</g>
<!-- l1_attn_stage10_gpu7&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge1400" class="edge">
<title>l1_attn_stage10_gpu7&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2653.98,-9965.83C2668.9,-9959.53 2685.24,-9953.79 2701,-9950.5 2739.78,-9942.41 4089.62,-9953.62 4127,-9940.5 4137.15,-9936.93 4135.9,-9929.21 4146,-9925.5 4192.34,-9908.47 4319.71,-9927.74 4368,-9917.5 4413.06,-9907.94 4461.58,-9887.21 4494.83,-9871.23"/>
<polygon fill="red" stroke="red" points="4496.76,-9874.18 4504.22,-9866.65 4493.69,-9867.89 4496.76,-9874.18"/>
<text text-anchor="middle" x="4177.5" y="-9929.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu8 -->
<g id="node201" class="node">
<title>l1_attn_stage11_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2805" cy="-9849" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2805" y="-9860.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="2805" y="-9845.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2805" y="-9830.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu8&#45;&gt;l1_attn_stage11_gpu8 -->
<g id="edge185" class="edge">
<title>l1_attn_stage10_gpu8&#45;&gt;l1_attn_stage11_gpu8</title>
<path fill="none" stroke="black" d="M2805,-9958.41C2805,-9939.69 2805,-9916.7 2805,-9896.71"/>
<polygon fill="black" stroke="black" points="2808.5,-9896.58 2805,-9886.58 2801.5,-9896.58 2808.5,-9896.58"/>
</g>
<!-- l1_attn_stage10_gpu8&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge1401" class="edge">
<title>l1_attn_stage10_gpu8&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2861.98,-9965.84C2876.9,-9959.54 2893.24,-9953.79 2909,-9950.5 2979.91,-9935.68 4144.65,-9964.52 4213,-9940.5 4223.15,-9936.93 4221.94,-9929.32 4232,-9925.5 4260.3,-9914.73 4338.46,-9924.12 4368,-9917.5 4412.67,-9907.49 4460.88,-9887.03 4494.15,-9871.24"/>
<polygon fill="red" stroke="red" points="4496.06,-9874.21 4503.55,-9866.72 4493.02,-9867.9 4496.06,-9874.21"/>
<text text-anchor="middle" x="4263.5" y="-9929.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu9 -->
<g id="node202" class="node">
<title>l1_attn_stage11_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3013" cy="-9849" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3013" y="-9860.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="3013" y="-9845.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3013" y="-9830.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu9&#45;&gt;l1_attn_stage11_gpu9 -->
<g id="edge186" class="edge">
<title>l1_attn_stage10_gpu9&#45;&gt;l1_attn_stage11_gpu9</title>
<path fill="none" stroke="black" d="M3013,-9958.41C3013,-9939.69 3013,-9916.7 3013,-9896.71"/>
<polygon fill="black" stroke="black" points="3016.5,-9896.58 3013,-9886.58 3009.5,-9896.58 3016.5,-9896.58"/>
</g>
<!-- l1_attn_stage10_gpu9&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge1402" class="edge">
<title>l1_attn_stage10_gpu9&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3069.98,-9965.84C3084.9,-9959.55 3101.24,-9953.8 3117,-9950.5 3181.28,-9937.04 4237.05,-9962.3 4299,-9940.5 4309.15,-9936.93 4308.15,-9929.82 4318,-9925.5 4338.61,-9916.46 4346.31,-9923.51 4368,-9917.5 4411.28,-9905.5 4458.59,-9885.87 4491.94,-9870.86"/>
<polygon fill="red" stroke="red" points="4493.74,-9873.89 4501.4,-9866.56 4490.84,-9867.51 4493.74,-9873.89"/>
<text text-anchor="middle" x="4349.5" y="-9929.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu10 -->
<g id="node203" class="node">
<title>l1_attn_stage11_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3221" cy="-9849" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3221" y="-9860.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="3221" y="-9845.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3221" y="-9830.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu10&#45;&gt;l1_attn_stage11_gpu10 -->
<g id="edge187" class="edge">
<title>l1_attn_stage10_gpu10&#45;&gt;l1_attn_stage11_gpu10</title>
<path fill="none" stroke="black" d="M3221,-9958.41C3221,-9939.69 3221,-9916.7 3221,-9896.71"/>
<polygon fill="black" stroke="black" points="3224.5,-9896.58 3221,-9886.58 3217.5,-9896.58 3224.5,-9896.58"/>
</g>
<!-- l1_attn_stage10_gpu10&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge1403" class="edge">
<title>l1_attn_stage10_gpu10&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3277.98,-9965.85C3292.91,-9959.56 3309.24,-9953.81 3325,-9950.5 3382.64,-9938.4 4329.46,-9960.07 4385,-9940.5 4395.15,-9936.92 4395.08,-9931.52 4404,-9925.5 4433.36,-9905.67 4468.2,-9885.89 4494.72,-9871.55"/>
<polygon fill="red" stroke="red" points="4496.57,-9874.53 4503.73,-9866.71 4493.26,-9868.36 4496.57,-9874.53"/>
<text text-anchor="middle" x="4435.5" y="-9929.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu11 -->
<g id="node204" class="node">
<title>l1_attn_stage11_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3429" cy="-9849" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3429" y="-9860.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="3429" y="-9845.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3429" y="-9830.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu11&#45;&gt;l1_attn_stage11_gpu11 -->
<g id="edge188" class="edge">
<title>l1_attn_stage10_gpu11&#45;&gt;l1_attn_stage11_gpu11</title>
<path fill="none" stroke="black" d="M3429,-9958.41C3429,-9939.69 3429,-9916.7 3429,-9896.71"/>
<polygon fill="black" stroke="black" points="3432.5,-9896.58 3429,-9886.58 3425.5,-9896.58 3432.5,-9896.58"/>
</g>
<!-- l1_attn_stage10_gpu11&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge1404" class="edge">
<title>l1_attn_stage10_gpu11&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3485.98,-9965.87C3500.91,-9959.57 3517.24,-9953.82 3533,-9950.5 3558.5,-9945.13 4447.88,-9952.51 4471,-9940.5 4484.7,-9933.38 4506.58,-9899.96 4521.12,-9875.8"/>
<polygon fill="red" stroke="red" points="4524.21,-9877.45 4526.3,-9867.07 4518.19,-9873.88 4524.21,-9877.45"/>
<text text-anchor="middle" x="4517.5" y="-9929.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu12 -->
<g id="node205" class="node">
<title>l1_attn_stage11_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3637" cy="-9849" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3637" y="-9860.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="3637" y="-9845.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3637" y="-9830.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu12&#45;&gt;l1_attn_stage11_gpu12 -->
<g id="edge189" class="edge">
<title>l1_attn_stage10_gpu12&#45;&gt;l1_attn_stage11_gpu12</title>
<path fill="none" stroke="black" d="M3574.19,-9967.68C3560.64,-9961.91 3546.37,-9955.93 3533,-9950.5 3521.53,-9945.84 3514.01,-9950.7 3507,-9940.5 3503.23,-9935 3503.04,-9930.86 3507,-9925.5 3514.18,-9915.77 3522.05,-9922.62 3533,-9917.5 3550.44,-9909.35 3568.39,-9898.65 3584.36,-9888.19"/>
<polygon fill="black" stroke="black" points="3586.64,-9890.88 3593.02,-9882.42 3582.76,-9885.05 3586.64,-9890.88"/>
</g>
<!-- l1_attn_stage10_gpu12&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge1405" class="edge">
<title>l1_attn_stage10_gpu12&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3693.99,-9965.89C3708.91,-9959.59 3725.24,-9953.83 3741,-9950.5 3763.18,-9945.81 4541.07,-9956.62 4557,-9940.5 4573.71,-9923.58 4564.21,-9896.14 4553.15,-9875.9"/>
<polygon fill="red" stroke="red" points="4556.11,-9874.04 4548.04,-9867.17 4550.07,-9877.57 4556.11,-9874.04"/>
<text text-anchor="middle" x="4595.5" y="-9929.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu13 -->
<g id="node206" class="node">
<title>l1_attn_stage11_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3845" cy="-9849" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3845" y="-9860.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="3845" y="-9845.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3845" y="-9830.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu13&#45;&gt;l1_attn_stage11_gpu13 -->
<g id="edge190" class="edge">
<title>l1_attn_stage10_gpu13&#45;&gt;l1_attn_stage11_gpu13</title>
<path fill="none" stroke="black" d="M3787.39,-9966C3772.62,-9959.79 3756.51,-9954.03 3741,-9950.5 3716.39,-9944.89 3531.45,-9958.74 3514,-9940.5 3509.39,-9935.68 3509.37,-9930.29 3514,-9925.5 3522.76,-9916.42 3728.97,-9921.29 3741,-9917.5 3760.58,-9911.32 3780,-9900.38 3796.67,-9889.08"/>
<polygon fill="black" stroke="black" points="3798.94,-9891.76 3805.13,-9883.16 3794.93,-9886.03 3798.94,-9891.76"/>
</g>
<!-- l1_attn_stage10_gpu13&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge1406" class="edge">
<title>l1_attn_stage10_gpu13&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3901.99,-9965.91C3916.92,-9959.61 3933.25,-9953.84 3949,-9950.5 3967.86,-9946.49 4629.47,-9954.23 4643,-9940.5 4668.62,-9914.51 4627.49,-9887.91 4589.04,-9870.34"/>
<polygon fill="red" stroke="red" points="4590.44,-9867.13 4579.88,-9866.29 4587.61,-9873.53 4590.44,-9867.13"/>
<text text-anchor="middle" x="4681.5" y="-9929.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu14 -->
<g id="node207" class="node">
<title>l1_attn_stage11_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4053" cy="-9849" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4053" y="-9860.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="4053" y="-9845.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4053" y="-9830.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu14&#45;&gt;l1_attn_stage11_gpu14 -->
<g id="edge191" class="edge">
<title>l1_attn_stage10_gpu14&#45;&gt;l1_attn_stage11_gpu14</title>
<path fill="none" stroke="black" d="M3995.71,-9965.89C3980.86,-9959.64 3964.64,-9953.89 3949,-9950.5 3925.76,-9945.45 3537.62,-9957.51 3521,-9940.5 3516.34,-9935.73 3516.33,-9930.26 3521,-9925.5 3529.33,-9917.01 3937.63,-9920.98 3949,-9917.5 3968.63,-9911.49 3988.07,-9900.58 4004.73,-9889.27"/>
<polygon fill="black" stroke="black" points="4007.01,-9891.95 4013.18,-9883.34 4002.99,-9886.22 4007.01,-9891.95"/>
</g>
<!-- l1_attn_stage10_gpu14&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge1407" class="edge">
<title>l1_attn_stage10_gpu14&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4110,-9965.94C4124.92,-9959.65 4141.25,-9953.87 4157,-9950.5 4172.54,-9947.17 4717.86,-9951.83 4729,-9940.5 4765.88,-9902.96 4702.24,-9879.2 4638.37,-9865.5"/>
<polygon fill="red" stroke="red" points="4639.05,-9862.06 4628.55,-9863.47 4637.63,-9868.92 4639.05,-9862.06"/>
<text text-anchor="middle" x="4768.5" y="-9929.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage11_gpu15 -->
<g id="node208" class="node">
<title>l1_attn_stage11_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4261" cy="-9849" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4261" y="-9860.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage11</text>
<text text-anchor="middle" x="4261" y="-9845.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4261" y="-9830.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage10_gpu15&#45;&gt;l1_attn_stage11_gpu15 -->
<g id="edge192" class="edge">
<title>l1_attn_stage10_gpu15&#45;&gt;l1_attn_stage11_gpu15</title>
<path fill="none" stroke="black" d="M4204,-9965.92C4189.08,-9959.63 4172.75,-9953.86 4157,-9950.5 4139.91,-9946.85 3540.26,-9952.95 3528,-9940.5 3523.32,-9935.75 3523.32,-9930.24 3528,-9925.5 3540.28,-9913.06 4140.28,-9922.56 4157,-9917.5 4176.65,-9911.54 4196.09,-9900.66 4212.75,-9889.34"/>
<polygon fill="black" stroke="black" points="4215.03,-9892.02 4221.2,-9883.41 4211.01,-9886.29 4215.03,-9892.02"/>
</g>
<!-- l1_attn_stage10_gpu15&#45;&gt;l1_attn_stage11_gpu[next_gpu] -->
<g id="edge1408" class="edge">
<title>l1_attn_stage10_gpu15&#45;&gt;l1_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4320.56,-9966.58C4336.88,-9960.06 4354.81,-9954.02 4372,-9950.5 4396.12,-9945.56 4797.79,-9958.1 4815,-9940.5 4864.67,-9889.7 4777.33,-9867.39 4687.57,-9857.6"/>
<polygon fill="red" stroke="red" points="4687.78,-9854.11 4677.47,-9856.56 4687.05,-9861.07 4687.78,-9854.11"/>
<text text-anchor="middle" x="4854.5" y="-9929.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu0 -->
<g id="node209" class="node">
<title>l1_attn_stage12_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1141" cy="-9702" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1141" y="-9713.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="1141" y="-9698.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1141" y="-9683.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu0&#45;&gt;l1_attn_stage12_gpu0 -->
<g id="edge193" class="edge">
<title>l1_attn_stage11_gpu0&#45;&gt;l1_attn_stage12_gpu0</title>
<path fill="none" stroke="black" d="M1141,-9811.41C1141,-9792.69 1141,-9769.7 1141,-9749.71"/>
<polygon fill="black" stroke="black" points="1144.5,-9749.58 1141,-9739.58 1137.5,-9749.58 1144.5,-9749.58"/>
</g>
<!-- l1_attn_stage12_gpu[next_gpu] -->
<g id="node1324" class="node">
<title>l1_attn_stage12_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4536" cy="-9702" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4536" y="-9698.3" font-family="Times,serif" font-size="14.00">l1_attn_stage12_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage11_gpu0&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge1409" class="edge">
<title>l1_attn_stage11_gpu0&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1197.98,-9818.87C1212.91,-9812.58 1229.24,-9806.82 1245,-9803.5 1494.97,-9750.85 3288.55,-9781.13 3544,-9778.5 3589.78,-9778.03 4323.1,-9779.41 4368,-9770.5 4413.32,-9761.51 4461.98,-9740.59 4495.21,-9724.4"/>
<polygon fill="red" stroke="red" points="4497.17,-9727.34 4504.58,-9719.76 4494.06,-9721.06 4497.17,-9727.34"/>
<text text-anchor="middle" x="3575.5" y="-9782.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu1 -->
<g id="node210" class="node">
<title>l1_attn_stage12_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1349" cy="-9702" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1349" y="-9713.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="1349" y="-9698.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1349" y="-9683.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu1&#45;&gt;l1_attn_stage12_gpu1 -->
<g id="edge194" class="edge">
<title>l1_attn_stage11_gpu1&#45;&gt;l1_attn_stage12_gpu1</title>
<path fill="none" stroke="black" d="M1349,-9811.41C1349,-9792.69 1349,-9769.7 1349,-9749.71"/>
<polygon fill="black" stroke="black" points="1352.5,-9749.58 1349,-9739.58 1345.5,-9749.58 1352.5,-9749.58"/>
</g>
<!-- l1_attn_stage11_gpu1&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge1410" class="edge">
<title>l1_attn_stage11_gpu1&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1405.97,-9818.8C1420.89,-9812.51 1437.23,-9806.77 1453,-9803.5 1511.7,-9791.33 3554.42,-9813.29 3611,-9793.5 3621.16,-9789.95 3619.86,-9782.08 3630,-9778.5 3668.66,-9764.84 4327.79,-9778.5 4368,-9770.5 4413.31,-9761.48 4461.98,-9740.56 4495.21,-9724.39"/>
<polygon fill="red" stroke="red" points="4497.17,-9727.32 4504.58,-9719.75 4494.06,-9721.05 4497.17,-9727.32"/>
<text text-anchor="middle" x="3661.5" y="-9782.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu2 -->
<g id="node211" class="node">
<title>l1_attn_stage12_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1557" cy="-9702" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1557" y="-9713.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="1557" y="-9698.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1557" y="-9683.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu2&#45;&gt;l1_attn_stage12_gpu2 -->
<g id="edge195" class="edge">
<title>l1_attn_stage11_gpu2&#45;&gt;l1_attn_stage12_gpu2</title>
<path fill="none" stroke="black" d="M1557,-9811.41C1557,-9792.69 1557,-9769.7 1557,-9749.71"/>
<polygon fill="black" stroke="black" points="1560.5,-9749.58 1557,-9739.58 1553.5,-9749.58 1560.5,-9749.58"/>
</g>
<!-- l1_attn_stage11_gpu2&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge1411" class="edge">
<title>l1_attn_stage11_gpu2&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1613.97,-9818.8C1628.89,-9812.51 1645.23,-9806.77 1661,-9803.5 1716.38,-9792.01 3643.62,-9812.18 3697,-9793.5 3707.16,-9789.94 3705.86,-9782.09 3716,-9778.5 3750.15,-9766.41 4332.48,-9777.59 4368,-9770.5 4413.31,-9761.45 4461.97,-9740.54 4495.2,-9724.37"/>
<polygon fill="red" stroke="red" points="4497.16,-9727.31 4504.57,-9719.74 4494.06,-9721.03 4497.16,-9727.31"/>
<text text-anchor="middle" x="3747.5" y="-9782.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu3 -->
<g id="node212" class="node">
<title>l1_attn_stage12_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1765" cy="-9702" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1765" y="-9713.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="1765" y="-9698.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1765" y="-9683.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu3&#45;&gt;l1_attn_stage12_gpu3 -->
<g id="edge196" class="edge">
<title>l1_attn_stage11_gpu3&#45;&gt;l1_attn_stage12_gpu3</title>
<path fill="none" stroke="black" d="M1765,-9811.41C1765,-9792.69 1765,-9769.7 1765,-9749.71"/>
<polygon fill="black" stroke="black" points="1768.5,-9749.58 1765,-9739.58 1761.5,-9749.58 1768.5,-9749.58"/>
</g>
<!-- l1_attn_stage11_gpu3&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge1412" class="edge">
<title>l1_attn_stage11_gpu3&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1821.97,-9818.81C1836.9,-9812.51 1853.23,-9806.77 1869,-9803.5 1921.06,-9792.69 3732.82,-9811.07 3783,-9793.5 3793.15,-9789.94 3791.86,-9782.1 3802,-9778.5 3831.63,-9767.97 4337.17,-9776.69 4368,-9770.5 4413.3,-9761.41 4461.97,-9740.5 4495.2,-9724.35"/>
<polygon fill="red" stroke="red" points="4497.15,-9727.28 4504.57,-9719.72 4494.05,-9721.01 4497.15,-9727.28"/>
<text text-anchor="middle" x="3833.5" y="-9782.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu4 -->
<g id="node213" class="node">
<title>l1_attn_stage12_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1973" cy="-9702" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1973" y="-9713.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="1973" y="-9698.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1973" y="-9683.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu4&#45;&gt;l1_attn_stage12_gpu4 -->
<g id="edge197" class="edge">
<title>l1_attn_stage11_gpu4&#45;&gt;l1_attn_stage12_gpu4</title>
<path fill="none" stroke="black" d="M1973,-9811.41C1973,-9792.69 1973,-9769.7 1973,-9749.71"/>
<polygon fill="black" stroke="black" points="1976.5,-9749.58 1973,-9739.58 1969.5,-9749.58 1976.5,-9749.58"/>
</g>
<!-- l1_attn_stage11_gpu4&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge1413" class="edge">
<title>l1_attn_stage11_gpu4&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2029.97,-9818.81C2044.9,-9812.52 2061.23,-9806.78 2077,-9803.5 2125.74,-9793.37 3822.02,-9809.95 3869,-9793.5 3879.15,-9789.94 3877.87,-9782.11 3888,-9778.5 3938.24,-9760.58 4315.72,-9781.06 4368,-9770.5 4413.29,-9761.35 4461.96,-9740.45 4495.19,-9724.31"/>
<polygon fill="red" stroke="red" points="4497.14,-9727.25 4504.56,-9719.69 4494.05,-9720.98 4497.14,-9727.25"/>
<text text-anchor="middle" x="3919.5" y="-9782.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu5 -->
<g id="node214" class="node">
<title>l1_attn_stage12_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2181" cy="-9702" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2181" y="-9713.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="2181" y="-9698.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2181" y="-9683.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu5&#45;&gt;l1_attn_stage12_gpu5 -->
<g id="edge198" class="edge">
<title>l1_attn_stage11_gpu5&#45;&gt;l1_attn_stage12_gpu5</title>
<path fill="none" stroke="black" d="M2181,-9811.41C2181,-9792.69 2181,-9769.7 2181,-9749.71"/>
<polygon fill="black" stroke="black" points="2184.5,-9749.58 2181,-9739.58 2177.5,-9749.58 2184.5,-9749.58"/>
</g>
<!-- l1_attn_stage11_gpu5&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge1414" class="edge">
<title>l1_attn_stage11_gpu5&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2237.97,-9818.82C2252.9,-9812.52 2269.23,-9806.78 2285,-9803.5 2330.42,-9794.05 3911.22,-9808.84 3955,-9793.5 3965.15,-9789.94 3963.87,-9782.13 3974,-9778.5 4015.22,-9763.72 4325.1,-9779.25 4368,-9770.5 4413.27,-9761.27 4461.94,-9740.38 4495.18,-9724.27"/>
<polygon fill="red" stroke="red" points="4497.13,-9727.21 4504.56,-9719.65 4494.04,-9720.93 4497.13,-9727.21"/>
<text text-anchor="middle" x="4005.5" y="-9782.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu6 -->
<g id="node215" class="node">
<title>l1_attn_stage12_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2389" cy="-9702" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2389" y="-9713.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="2389" y="-9698.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2389" y="-9683.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu6&#45;&gt;l1_attn_stage12_gpu6 -->
<g id="edge199" class="edge">
<title>l1_attn_stage11_gpu6&#45;&gt;l1_attn_stage12_gpu6</title>
<path fill="none" stroke="black" d="M2389,-9811.41C2389,-9792.69 2389,-9769.7 2389,-9749.71"/>
<polygon fill="black" stroke="black" points="2392.5,-9749.58 2389,-9739.58 2385.5,-9749.58 2392.5,-9749.58"/>
</g>
<!-- l1_attn_stage11_gpu6&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge1415" class="edge">
<title>l1_attn_stage11_gpu6&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2445.97,-9818.82C2460.9,-9812.53 2477.23,-9806.78 2493,-9803.5 2535.1,-9794.73 4000.42,-9807.73 4041,-9793.5 4051.15,-9789.94 4049.88,-9782.16 4060,-9778.5 4092.19,-9766.85 4334.48,-9777.43 4368,-9770.5 4413.11,-9761.17 4461.62,-9740.4 4494.86,-9724.35"/>
<polygon fill="red" stroke="red" points="4496.8,-9727.3 4504.24,-9719.75 4493.72,-9721.01 4496.8,-9727.3"/>
<text text-anchor="middle" x="4091.5" y="-9782.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu7 -->
<g id="node216" class="node">
<title>l1_attn_stage12_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2597" cy="-9702" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2597" y="-9713.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="2597" y="-9698.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2597" y="-9683.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu7&#45;&gt;l1_attn_stage12_gpu7 -->
<g id="edge200" class="edge">
<title>l1_attn_stage11_gpu7&#45;&gt;l1_attn_stage12_gpu7</title>
<path fill="none" stroke="black" d="M2597,-9811.41C2597,-9792.69 2597,-9769.7 2597,-9749.71"/>
<polygon fill="black" stroke="black" points="2600.5,-9749.58 2597,-9739.58 2593.5,-9749.58 2600.5,-9749.58"/>
</g>
<!-- l1_attn_stage11_gpu7&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge1416" class="edge">
<title>l1_attn_stage11_gpu7&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2653.98,-9818.83C2668.9,-9812.53 2685.24,-9806.79 2701,-9803.5 2739.78,-9795.41 4089.62,-9806.62 4127,-9793.5 4137.15,-9789.93 4135.9,-9782.21 4146,-9778.5 4192.34,-9761.47 4319.71,-9780.74 4368,-9770.5 4413.06,-9760.94 4461.58,-9740.21 4494.83,-9724.23"/>
<polygon fill="red" stroke="red" points="4496.76,-9727.18 4504.22,-9719.65 4493.69,-9720.89 4496.76,-9727.18"/>
<text text-anchor="middle" x="4177.5" y="-9782.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu8 -->
<g id="node217" class="node">
<title>l1_attn_stage12_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2805" cy="-9702" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2805" y="-9713.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="2805" y="-9698.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2805" y="-9683.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu8&#45;&gt;l1_attn_stage12_gpu8 -->
<g id="edge201" class="edge">
<title>l1_attn_stage11_gpu8&#45;&gt;l1_attn_stage12_gpu8</title>
<path fill="none" stroke="black" d="M2805,-9811.41C2805,-9792.69 2805,-9769.7 2805,-9749.71"/>
<polygon fill="black" stroke="black" points="2808.5,-9749.58 2805,-9739.58 2801.5,-9749.58 2808.5,-9749.58"/>
</g>
<!-- l1_attn_stage11_gpu8&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge1417" class="edge">
<title>l1_attn_stage11_gpu8&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2861.98,-9818.84C2876.9,-9812.54 2893.24,-9806.79 2909,-9803.5 2979.91,-9788.68 4144.65,-9817.52 4213,-9793.5 4223.15,-9789.93 4221.94,-9782.32 4232,-9778.5 4260.3,-9767.73 4338.46,-9777.12 4368,-9770.5 4412.67,-9760.49 4460.88,-9740.03 4494.15,-9724.24"/>
<polygon fill="red" stroke="red" points="4496.06,-9727.21 4503.55,-9719.72 4493.02,-9720.9 4496.06,-9727.21"/>
<text text-anchor="middle" x="4263.5" y="-9782.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu9 -->
<g id="node218" class="node">
<title>l1_attn_stage12_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3013" cy="-9702" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3013" y="-9713.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="3013" y="-9698.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3013" y="-9683.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu9&#45;&gt;l1_attn_stage12_gpu9 -->
<g id="edge202" class="edge">
<title>l1_attn_stage11_gpu9&#45;&gt;l1_attn_stage12_gpu9</title>
<path fill="none" stroke="black" d="M3013,-9811.41C3013,-9792.69 3013,-9769.7 3013,-9749.71"/>
<polygon fill="black" stroke="black" points="3016.5,-9749.58 3013,-9739.58 3009.5,-9749.58 3016.5,-9749.58"/>
</g>
<!-- l1_attn_stage11_gpu9&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge1418" class="edge">
<title>l1_attn_stage11_gpu9&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3069.98,-9818.84C3084.9,-9812.55 3101.24,-9806.8 3117,-9803.5 3181.28,-9790.04 4237.05,-9815.3 4299,-9793.5 4309.15,-9789.93 4308.15,-9782.82 4318,-9778.5 4338.61,-9769.46 4346.31,-9776.51 4368,-9770.5 4411.28,-9758.5 4458.59,-9738.87 4491.94,-9723.86"/>
<polygon fill="red" stroke="red" points="4493.74,-9726.89 4501.4,-9719.56 4490.84,-9720.51 4493.74,-9726.89"/>
<text text-anchor="middle" x="4349.5" y="-9782.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu10 -->
<g id="node219" class="node">
<title>l1_attn_stage12_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3221" cy="-9702" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3221" y="-9713.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="3221" y="-9698.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3221" y="-9683.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu10&#45;&gt;l1_attn_stage12_gpu10 -->
<g id="edge203" class="edge">
<title>l1_attn_stage11_gpu10&#45;&gt;l1_attn_stage12_gpu10</title>
<path fill="none" stroke="black" d="M3221,-9811.41C3221,-9792.69 3221,-9769.7 3221,-9749.71"/>
<polygon fill="black" stroke="black" points="3224.5,-9749.58 3221,-9739.58 3217.5,-9749.58 3224.5,-9749.58"/>
</g>
<!-- l1_attn_stage11_gpu10&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge1419" class="edge">
<title>l1_attn_stage11_gpu10&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3277.98,-9818.85C3292.91,-9812.56 3309.24,-9806.81 3325,-9803.5 3382.64,-9791.4 4329.46,-9813.07 4385,-9793.5 4395.15,-9789.92 4395.08,-9784.52 4404,-9778.5 4433.36,-9758.67 4468.2,-9738.89 4494.72,-9724.55"/>
<polygon fill="red" stroke="red" points="4496.57,-9727.53 4503.73,-9719.71 4493.26,-9721.36 4496.57,-9727.53"/>
<text text-anchor="middle" x="4435.5" y="-9782.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu11 -->
<g id="node220" class="node">
<title>l1_attn_stage12_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3429" cy="-9702" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3429" y="-9713.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="3429" y="-9698.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3429" y="-9683.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu11&#45;&gt;l1_attn_stage12_gpu11 -->
<g id="edge204" class="edge">
<title>l1_attn_stage11_gpu11&#45;&gt;l1_attn_stage12_gpu11</title>
<path fill="none" stroke="black" d="M3429,-9811.41C3429,-9792.69 3429,-9769.7 3429,-9749.71"/>
<polygon fill="black" stroke="black" points="3432.5,-9749.58 3429,-9739.58 3425.5,-9749.58 3432.5,-9749.58"/>
</g>
<!-- l1_attn_stage11_gpu11&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge1420" class="edge">
<title>l1_attn_stage11_gpu11&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3485.98,-9818.87C3500.91,-9812.57 3517.24,-9806.82 3533,-9803.5 3558.5,-9798.13 4447.88,-9805.51 4471,-9793.5 4484.7,-9786.38 4506.58,-9752.96 4521.12,-9728.8"/>
<polygon fill="red" stroke="red" points="4524.21,-9730.45 4526.3,-9720.07 4518.19,-9726.88 4524.21,-9730.45"/>
<text text-anchor="middle" x="4517.5" y="-9782.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu12 -->
<g id="node221" class="node">
<title>l1_attn_stage12_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3637" cy="-9702" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3637" y="-9713.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="3637" y="-9698.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3637" y="-9683.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu12&#45;&gt;l1_attn_stage12_gpu12 -->
<g id="edge205" class="edge">
<title>l1_attn_stage11_gpu12&#45;&gt;l1_attn_stage12_gpu12</title>
<path fill="none" stroke="black" d="M3574.19,-9820.68C3560.64,-9814.91 3546.37,-9808.93 3533,-9803.5 3521.53,-9798.84 3514.01,-9803.7 3507,-9793.5 3503.23,-9788 3503.04,-9783.86 3507,-9778.5 3514.18,-9768.77 3522.05,-9775.62 3533,-9770.5 3550.44,-9762.35 3568.39,-9751.65 3584.36,-9741.19"/>
<polygon fill="black" stroke="black" points="3586.64,-9743.88 3593.02,-9735.42 3582.76,-9738.05 3586.64,-9743.88"/>
</g>
<!-- l1_attn_stage11_gpu12&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge1421" class="edge">
<title>l1_attn_stage11_gpu12&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3693.99,-9818.89C3708.91,-9812.59 3725.24,-9806.83 3741,-9803.5 3763.18,-9798.81 4541.07,-9809.62 4557,-9793.5 4573.71,-9776.58 4564.21,-9749.14 4553.15,-9728.9"/>
<polygon fill="red" stroke="red" points="4556.11,-9727.04 4548.04,-9720.17 4550.07,-9730.57 4556.11,-9727.04"/>
<text text-anchor="middle" x="4595.5" y="-9782.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu13 -->
<g id="node222" class="node">
<title>l1_attn_stage12_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3845" cy="-9702" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3845" y="-9713.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="3845" y="-9698.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3845" y="-9683.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu13&#45;&gt;l1_attn_stage12_gpu13 -->
<g id="edge206" class="edge">
<title>l1_attn_stage11_gpu13&#45;&gt;l1_attn_stage12_gpu13</title>
<path fill="none" stroke="black" d="M3787.39,-9819C3772.62,-9812.79 3756.51,-9807.03 3741,-9803.5 3716.39,-9797.89 3531.45,-9811.74 3514,-9793.5 3509.39,-9788.68 3509.37,-9783.29 3514,-9778.5 3522.76,-9769.42 3728.97,-9774.29 3741,-9770.5 3760.58,-9764.32 3780,-9753.38 3796.67,-9742.08"/>
<polygon fill="black" stroke="black" points="3798.94,-9744.76 3805.13,-9736.16 3794.93,-9739.03 3798.94,-9744.76"/>
</g>
<!-- l1_attn_stage11_gpu13&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge1422" class="edge">
<title>l1_attn_stage11_gpu13&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3901.99,-9818.91C3916.92,-9812.61 3933.25,-9806.84 3949,-9803.5 3967.86,-9799.49 4629.47,-9807.23 4643,-9793.5 4668.62,-9767.51 4627.49,-9740.91 4589.04,-9723.34"/>
<polygon fill="red" stroke="red" points="4590.44,-9720.13 4579.88,-9719.29 4587.61,-9726.53 4590.44,-9720.13"/>
<text text-anchor="middle" x="4681.5" y="-9782.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu14 -->
<g id="node223" class="node">
<title>l1_attn_stage12_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4053" cy="-9702" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4053" y="-9713.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="4053" y="-9698.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4053" y="-9683.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu14&#45;&gt;l1_attn_stage12_gpu14 -->
<g id="edge207" class="edge">
<title>l1_attn_stage11_gpu14&#45;&gt;l1_attn_stage12_gpu14</title>
<path fill="none" stroke="black" d="M3995.71,-9818.89C3980.86,-9812.64 3964.64,-9806.89 3949,-9803.5 3925.76,-9798.45 3537.62,-9810.51 3521,-9793.5 3516.34,-9788.73 3516.33,-9783.26 3521,-9778.5 3529.33,-9770.01 3937.63,-9773.98 3949,-9770.5 3968.63,-9764.49 3988.07,-9753.58 4004.73,-9742.27"/>
<polygon fill="black" stroke="black" points="4007.01,-9744.95 4013.18,-9736.34 4002.99,-9739.22 4007.01,-9744.95"/>
</g>
<!-- l1_attn_stage11_gpu14&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge1423" class="edge">
<title>l1_attn_stage11_gpu14&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4110,-9818.94C4124.92,-9812.65 4141.25,-9806.87 4157,-9803.5 4172.54,-9800.17 4717.86,-9804.83 4729,-9793.5 4765.88,-9755.96 4702.24,-9732.2 4638.37,-9718.5"/>
<polygon fill="red" stroke="red" points="4639.05,-9715.06 4628.55,-9716.47 4637.63,-9721.92 4639.05,-9715.06"/>
<text text-anchor="middle" x="4768.5" y="-9782.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage12_gpu15 -->
<g id="node224" class="node">
<title>l1_attn_stage12_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4261" cy="-9702" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4261" y="-9713.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage12</text>
<text text-anchor="middle" x="4261" y="-9698.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4261" y="-9683.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage11_gpu15&#45;&gt;l1_attn_stage12_gpu15 -->
<g id="edge208" class="edge">
<title>l1_attn_stage11_gpu15&#45;&gt;l1_attn_stage12_gpu15</title>
<path fill="none" stroke="black" d="M4204,-9818.92C4189.08,-9812.63 4172.75,-9806.86 4157,-9803.5 4139.91,-9799.85 3540.26,-9805.95 3528,-9793.5 3523.32,-9788.75 3523.32,-9783.24 3528,-9778.5 3540.28,-9766.06 4140.28,-9775.56 4157,-9770.5 4176.65,-9764.54 4196.09,-9753.66 4212.75,-9742.34"/>
<polygon fill="black" stroke="black" points="4215.03,-9745.02 4221.2,-9736.41 4211.01,-9739.29 4215.03,-9745.02"/>
</g>
<!-- l1_attn_stage11_gpu15&#45;&gt;l1_attn_stage12_gpu[next_gpu] -->
<g id="edge1424" class="edge">
<title>l1_attn_stage11_gpu15&#45;&gt;l1_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4320.56,-9819.58C4336.88,-9813.06 4354.81,-9807.02 4372,-9803.5 4396.12,-9798.56 4797.79,-9811.1 4815,-9793.5 4864.67,-9742.7 4777.33,-9720.39 4687.57,-9710.6"/>
<polygon fill="red" stroke="red" points="4687.78,-9707.11 4677.47,-9709.56 4687.05,-9714.07 4687.78,-9707.11"/>
<text text-anchor="middle" x="4854.5" y="-9782.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu0 -->
<g id="node225" class="node">
<title>l1_attn_stage13_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1141" cy="-9555" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1141" y="-9566.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="1141" y="-9551.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1141" y="-9536.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu0&#45;&gt;l1_attn_stage13_gpu0 -->
<g id="edge209" class="edge">
<title>l1_attn_stage12_gpu0&#45;&gt;l1_attn_stage13_gpu0</title>
<path fill="none" stroke="black" d="M1141,-9664.41C1141,-9645.69 1141,-9622.7 1141,-9602.71"/>
<polygon fill="black" stroke="black" points="1144.5,-9602.58 1141,-9592.58 1137.5,-9602.58 1144.5,-9602.58"/>
</g>
<!-- l1_attn_stage13_gpu[next_gpu] -->
<g id="node1325" class="node">
<title>l1_attn_stage13_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4536" cy="-9555" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4536" y="-9551.3" font-family="Times,serif" font-size="14.00">l1_attn_stage13_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage12_gpu0&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge1425" class="edge">
<title>l1_attn_stage12_gpu0&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1197.98,-9671.87C1212.91,-9665.58 1229.24,-9659.82 1245,-9656.5 1494.97,-9603.85 3288.55,-9634.13 3544,-9631.5 3589.78,-9631.03 4323.1,-9632.41 4368,-9623.5 4413.32,-9614.51 4461.98,-9593.59 4495.21,-9577.4"/>
<polygon fill="red" stroke="red" points="4497.17,-9580.34 4504.58,-9572.76 4494.06,-9574.06 4497.17,-9580.34"/>
<text text-anchor="middle" x="3575.5" y="-9635.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu1 -->
<g id="node226" class="node">
<title>l1_attn_stage13_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1349" cy="-9555" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1349" y="-9566.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="1349" y="-9551.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1349" y="-9536.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu1&#45;&gt;l1_attn_stage13_gpu1 -->
<g id="edge210" class="edge">
<title>l1_attn_stage12_gpu1&#45;&gt;l1_attn_stage13_gpu1</title>
<path fill="none" stroke="black" d="M1349,-9664.41C1349,-9645.69 1349,-9622.7 1349,-9602.71"/>
<polygon fill="black" stroke="black" points="1352.5,-9602.58 1349,-9592.58 1345.5,-9602.58 1352.5,-9602.58"/>
</g>
<!-- l1_attn_stage12_gpu1&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge1426" class="edge">
<title>l1_attn_stage12_gpu1&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1405.97,-9671.8C1420.89,-9665.51 1437.23,-9659.77 1453,-9656.5 1511.7,-9644.33 3554.42,-9666.29 3611,-9646.5 3621.16,-9642.95 3619.86,-9635.08 3630,-9631.5 3668.66,-9617.84 4327.79,-9631.5 4368,-9623.5 4413.31,-9614.48 4461.98,-9593.56 4495.21,-9577.39"/>
<polygon fill="red" stroke="red" points="4497.17,-9580.32 4504.58,-9572.75 4494.06,-9574.05 4497.17,-9580.32"/>
<text text-anchor="middle" x="3661.5" y="-9635.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu2 -->
<g id="node227" class="node">
<title>l1_attn_stage13_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1557" cy="-9555" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1557" y="-9566.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="1557" y="-9551.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1557" y="-9536.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu2&#45;&gt;l1_attn_stage13_gpu2 -->
<g id="edge211" class="edge">
<title>l1_attn_stage12_gpu2&#45;&gt;l1_attn_stage13_gpu2</title>
<path fill="none" stroke="black" d="M1557,-9664.41C1557,-9645.69 1557,-9622.7 1557,-9602.71"/>
<polygon fill="black" stroke="black" points="1560.5,-9602.58 1557,-9592.58 1553.5,-9602.58 1560.5,-9602.58"/>
</g>
<!-- l1_attn_stage12_gpu2&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge1427" class="edge">
<title>l1_attn_stage12_gpu2&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1613.97,-9671.8C1628.89,-9665.51 1645.23,-9659.77 1661,-9656.5 1716.38,-9645.01 3643.62,-9665.18 3697,-9646.5 3707.16,-9642.94 3705.86,-9635.09 3716,-9631.5 3750.15,-9619.41 4332.48,-9630.59 4368,-9623.5 4413.31,-9614.45 4461.97,-9593.54 4495.2,-9577.37"/>
<polygon fill="red" stroke="red" points="4497.16,-9580.31 4504.57,-9572.74 4494.06,-9574.03 4497.16,-9580.31"/>
<text text-anchor="middle" x="3747.5" y="-9635.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu3 -->
<g id="node228" class="node">
<title>l1_attn_stage13_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1765" cy="-9555" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1765" y="-9566.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="1765" y="-9551.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1765" y="-9536.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu3&#45;&gt;l1_attn_stage13_gpu3 -->
<g id="edge212" class="edge">
<title>l1_attn_stage12_gpu3&#45;&gt;l1_attn_stage13_gpu3</title>
<path fill="none" stroke="black" d="M1765,-9664.41C1765,-9645.69 1765,-9622.7 1765,-9602.71"/>
<polygon fill="black" stroke="black" points="1768.5,-9602.58 1765,-9592.58 1761.5,-9602.58 1768.5,-9602.58"/>
</g>
<!-- l1_attn_stage12_gpu3&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge1428" class="edge">
<title>l1_attn_stage12_gpu3&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1821.97,-9671.81C1836.9,-9665.51 1853.23,-9659.77 1869,-9656.5 1921.06,-9645.69 3732.82,-9664.07 3783,-9646.5 3793.15,-9642.94 3791.86,-9635.1 3802,-9631.5 3831.63,-9620.97 4337.17,-9629.69 4368,-9623.5 4413.3,-9614.41 4461.97,-9593.5 4495.2,-9577.35"/>
<polygon fill="red" stroke="red" points="4497.15,-9580.28 4504.57,-9572.72 4494.05,-9574.01 4497.15,-9580.28"/>
<text text-anchor="middle" x="3833.5" y="-9635.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu4 -->
<g id="node229" class="node">
<title>l1_attn_stage13_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1973" cy="-9555" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1973" y="-9566.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="1973" y="-9551.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1973" y="-9536.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu4&#45;&gt;l1_attn_stage13_gpu4 -->
<g id="edge213" class="edge">
<title>l1_attn_stage12_gpu4&#45;&gt;l1_attn_stage13_gpu4</title>
<path fill="none" stroke="black" d="M1973,-9664.41C1973,-9645.69 1973,-9622.7 1973,-9602.71"/>
<polygon fill="black" stroke="black" points="1976.5,-9602.58 1973,-9592.58 1969.5,-9602.58 1976.5,-9602.58"/>
</g>
<!-- l1_attn_stage12_gpu4&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge1429" class="edge">
<title>l1_attn_stage12_gpu4&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2029.97,-9671.81C2044.9,-9665.52 2061.23,-9659.78 2077,-9656.5 2125.74,-9646.37 3822.02,-9662.95 3869,-9646.5 3879.15,-9642.94 3877.87,-9635.11 3888,-9631.5 3938.24,-9613.58 4315.72,-9634.06 4368,-9623.5 4413.29,-9614.35 4461.96,-9593.45 4495.19,-9577.31"/>
<polygon fill="red" stroke="red" points="4497.14,-9580.25 4504.56,-9572.69 4494.05,-9573.98 4497.14,-9580.25"/>
<text text-anchor="middle" x="3919.5" y="-9635.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu5 -->
<g id="node230" class="node">
<title>l1_attn_stage13_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2181" cy="-9555" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2181" y="-9566.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="2181" y="-9551.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2181" y="-9536.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu5&#45;&gt;l1_attn_stage13_gpu5 -->
<g id="edge214" class="edge">
<title>l1_attn_stage12_gpu5&#45;&gt;l1_attn_stage13_gpu5</title>
<path fill="none" stroke="black" d="M2181,-9664.41C2181,-9645.69 2181,-9622.7 2181,-9602.71"/>
<polygon fill="black" stroke="black" points="2184.5,-9602.58 2181,-9592.58 2177.5,-9602.58 2184.5,-9602.58"/>
</g>
<!-- l1_attn_stage12_gpu5&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge1430" class="edge">
<title>l1_attn_stage12_gpu5&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2237.97,-9671.82C2252.9,-9665.52 2269.23,-9659.78 2285,-9656.5 2330.42,-9647.05 3911.22,-9661.84 3955,-9646.5 3965.15,-9642.94 3963.87,-9635.13 3974,-9631.5 4015.22,-9616.72 4325.1,-9632.25 4368,-9623.5 4413.27,-9614.27 4461.94,-9593.38 4495.18,-9577.27"/>
<polygon fill="red" stroke="red" points="4497.13,-9580.21 4504.56,-9572.65 4494.04,-9573.93 4497.13,-9580.21"/>
<text text-anchor="middle" x="4005.5" y="-9635.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu6 -->
<g id="node231" class="node">
<title>l1_attn_stage13_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2389" cy="-9555" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2389" y="-9566.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="2389" y="-9551.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2389" y="-9536.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu6&#45;&gt;l1_attn_stage13_gpu6 -->
<g id="edge215" class="edge">
<title>l1_attn_stage12_gpu6&#45;&gt;l1_attn_stage13_gpu6</title>
<path fill="none" stroke="black" d="M2389,-9664.41C2389,-9645.69 2389,-9622.7 2389,-9602.71"/>
<polygon fill="black" stroke="black" points="2392.5,-9602.58 2389,-9592.58 2385.5,-9602.58 2392.5,-9602.58"/>
</g>
<!-- l1_attn_stage12_gpu6&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge1431" class="edge">
<title>l1_attn_stage12_gpu6&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2445.97,-9671.82C2460.9,-9665.53 2477.23,-9659.78 2493,-9656.5 2535.1,-9647.73 4000.42,-9660.73 4041,-9646.5 4051.15,-9642.94 4049.88,-9635.16 4060,-9631.5 4092.19,-9619.85 4334.48,-9630.43 4368,-9623.5 4413.11,-9614.17 4461.62,-9593.4 4494.86,-9577.35"/>
<polygon fill="red" stroke="red" points="4496.8,-9580.3 4504.24,-9572.75 4493.72,-9574.01 4496.8,-9580.3"/>
<text text-anchor="middle" x="4091.5" y="-9635.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu7 -->
<g id="node232" class="node">
<title>l1_attn_stage13_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2597" cy="-9555" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2597" y="-9566.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="2597" y="-9551.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2597" y="-9536.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu7&#45;&gt;l1_attn_stage13_gpu7 -->
<g id="edge216" class="edge">
<title>l1_attn_stage12_gpu7&#45;&gt;l1_attn_stage13_gpu7</title>
<path fill="none" stroke="black" d="M2597,-9664.41C2597,-9645.69 2597,-9622.7 2597,-9602.71"/>
<polygon fill="black" stroke="black" points="2600.5,-9602.58 2597,-9592.58 2593.5,-9602.58 2600.5,-9602.58"/>
</g>
<!-- l1_attn_stage12_gpu7&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge1432" class="edge">
<title>l1_attn_stage12_gpu7&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2653.98,-9671.83C2668.9,-9665.53 2685.24,-9659.79 2701,-9656.5 2739.78,-9648.41 4089.62,-9659.62 4127,-9646.5 4137.15,-9642.93 4135.9,-9635.21 4146,-9631.5 4192.34,-9614.47 4319.71,-9633.74 4368,-9623.5 4413.06,-9613.94 4461.58,-9593.21 4494.83,-9577.23"/>
<polygon fill="red" stroke="red" points="4496.76,-9580.18 4504.22,-9572.65 4493.69,-9573.89 4496.76,-9580.18"/>
<text text-anchor="middle" x="4177.5" y="-9635.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu8 -->
<g id="node233" class="node">
<title>l1_attn_stage13_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2805" cy="-9555" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2805" y="-9566.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="2805" y="-9551.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2805" y="-9536.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu8&#45;&gt;l1_attn_stage13_gpu8 -->
<g id="edge217" class="edge">
<title>l1_attn_stage12_gpu8&#45;&gt;l1_attn_stage13_gpu8</title>
<path fill="none" stroke="black" d="M2805,-9664.41C2805,-9645.69 2805,-9622.7 2805,-9602.71"/>
<polygon fill="black" stroke="black" points="2808.5,-9602.58 2805,-9592.58 2801.5,-9602.58 2808.5,-9602.58"/>
</g>
<!-- l1_attn_stage12_gpu8&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge1433" class="edge">
<title>l1_attn_stage12_gpu8&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2861.98,-9671.84C2876.9,-9665.54 2893.24,-9659.79 2909,-9656.5 2979.91,-9641.68 4144.65,-9670.52 4213,-9646.5 4223.15,-9642.93 4221.94,-9635.32 4232,-9631.5 4260.3,-9620.73 4338.46,-9630.12 4368,-9623.5 4412.67,-9613.49 4460.88,-9593.03 4494.15,-9577.24"/>
<polygon fill="red" stroke="red" points="4496.06,-9580.21 4503.55,-9572.72 4493.02,-9573.9 4496.06,-9580.21"/>
<text text-anchor="middle" x="4263.5" y="-9635.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu9 -->
<g id="node234" class="node">
<title>l1_attn_stage13_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3013" cy="-9555" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3013" y="-9566.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="3013" y="-9551.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3013" y="-9536.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu9&#45;&gt;l1_attn_stage13_gpu9 -->
<g id="edge218" class="edge">
<title>l1_attn_stage12_gpu9&#45;&gt;l1_attn_stage13_gpu9</title>
<path fill="none" stroke="black" d="M3013,-9664.41C3013,-9645.69 3013,-9622.7 3013,-9602.71"/>
<polygon fill="black" stroke="black" points="3016.5,-9602.58 3013,-9592.58 3009.5,-9602.58 3016.5,-9602.58"/>
</g>
<!-- l1_attn_stage12_gpu9&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge1434" class="edge">
<title>l1_attn_stage12_gpu9&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3069.98,-9671.84C3084.9,-9665.55 3101.24,-9659.8 3117,-9656.5 3181.28,-9643.04 4237.05,-9668.3 4299,-9646.5 4309.15,-9642.93 4308.15,-9635.82 4318,-9631.5 4338.61,-9622.46 4346.31,-9629.51 4368,-9623.5 4411.28,-9611.5 4458.59,-9591.87 4491.94,-9576.86"/>
<polygon fill="red" stroke="red" points="4493.74,-9579.89 4501.4,-9572.56 4490.84,-9573.51 4493.74,-9579.89"/>
<text text-anchor="middle" x="4349.5" y="-9635.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu10 -->
<g id="node235" class="node">
<title>l1_attn_stage13_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3221" cy="-9555" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3221" y="-9566.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="3221" y="-9551.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3221" y="-9536.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu10&#45;&gt;l1_attn_stage13_gpu10 -->
<g id="edge219" class="edge">
<title>l1_attn_stage12_gpu10&#45;&gt;l1_attn_stage13_gpu10</title>
<path fill="none" stroke="black" d="M3221,-9664.41C3221,-9645.69 3221,-9622.7 3221,-9602.71"/>
<polygon fill="black" stroke="black" points="3224.5,-9602.58 3221,-9592.58 3217.5,-9602.58 3224.5,-9602.58"/>
</g>
<!-- l1_attn_stage12_gpu10&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge1435" class="edge">
<title>l1_attn_stage12_gpu10&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3277.98,-9671.85C3292.91,-9665.56 3309.24,-9659.81 3325,-9656.5 3382.64,-9644.4 4329.46,-9666.07 4385,-9646.5 4395.15,-9642.92 4395.08,-9637.52 4404,-9631.5 4433.36,-9611.67 4468.2,-9591.89 4494.72,-9577.55"/>
<polygon fill="red" stroke="red" points="4496.57,-9580.53 4503.73,-9572.71 4493.26,-9574.36 4496.57,-9580.53"/>
<text text-anchor="middle" x="4435.5" y="-9635.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu11 -->
<g id="node236" class="node">
<title>l1_attn_stage13_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3429" cy="-9555" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3429" y="-9566.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="3429" y="-9551.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3429" y="-9536.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu11&#45;&gt;l1_attn_stage13_gpu11 -->
<g id="edge220" class="edge">
<title>l1_attn_stage12_gpu11&#45;&gt;l1_attn_stage13_gpu11</title>
<path fill="none" stroke="black" d="M3429,-9664.41C3429,-9645.69 3429,-9622.7 3429,-9602.71"/>
<polygon fill="black" stroke="black" points="3432.5,-9602.58 3429,-9592.58 3425.5,-9602.58 3432.5,-9602.58"/>
</g>
<!-- l1_attn_stage12_gpu11&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge1436" class="edge">
<title>l1_attn_stage12_gpu11&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3485.98,-9671.87C3500.91,-9665.57 3517.24,-9659.82 3533,-9656.5 3558.5,-9651.13 4447.88,-9658.51 4471,-9646.5 4484.7,-9639.38 4506.58,-9605.96 4521.12,-9581.8"/>
<polygon fill="red" stroke="red" points="4524.21,-9583.45 4526.3,-9573.07 4518.19,-9579.88 4524.21,-9583.45"/>
<text text-anchor="middle" x="4517.5" y="-9635.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu12 -->
<g id="node237" class="node">
<title>l1_attn_stage13_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3637" cy="-9555" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3637" y="-9566.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="3637" y="-9551.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3637" y="-9536.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu12&#45;&gt;l1_attn_stage13_gpu12 -->
<g id="edge221" class="edge">
<title>l1_attn_stage12_gpu12&#45;&gt;l1_attn_stage13_gpu12</title>
<path fill="none" stroke="black" d="M3574.19,-9673.68C3560.64,-9667.91 3546.37,-9661.93 3533,-9656.5 3521.53,-9651.84 3514.01,-9656.7 3507,-9646.5 3503.23,-9641 3503.04,-9636.86 3507,-9631.5 3514.18,-9621.77 3522.05,-9628.62 3533,-9623.5 3550.44,-9615.35 3568.39,-9604.65 3584.36,-9594.19"/>
<polygon fill="black" stroke="black" points="3586.64,-9596.88 3593.02,-9588.42 3582.76,-9591.05 3586.64,-9596.88"/>
</g>
<!-- l1_attn_stage12_gpu12&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge1437" class="edge">
<title>l1_attn_stage12_gpu12&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3693.99,-9671.89C3708.91,-9665.59 3725.24,-9659.83 3741,-9656.5 3763.18,-9651.81 4541.07,-9662.62 4557,-9646.5 4573.71,-9629.58 4564.21,-9602.14 4553.15,-9581.9"/>
<polygon fill="red" stroke="red" points="4556.11,-9580.04 4548.04,-9573.17 4550.07,-9583.57 4556.11,-9580.04"/>
<text text-anchor="middle" x="4595.5" y="-9635.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu13 -->
<g id="node238" class="node">
<title>l1_attn_stage13_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3845" cy="-9555" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3845" y="-9566.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="3845" y="-9551.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3845" y="-9536.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu13&#45;&gt;l1_attn_stage13_gpu13 -->
<g id="edge222" class="edge">
<title>l1_attn_stage12_gpu13&#45;&gt;l1_attn_stage13_gpu13</title>
<path fill="none" stroke="black" d="M3787.39,-9672C3772.62,-9665.79 3756.51,-9660.03 3741,-9656.5 3716.39,-9650.89 3531.45,-9664.74 3514,-9646.5 3509.39,-9641.68 3509.37,-9636.29 3514,-9631.5 3522.76,-9622.42 3728.97,-9627.29 3741,-9623.5 3760.58,-9617.32 3780,-9606.38 3796.67,-9595.08"/>
<polygon fill="black" stroke="black" points="3798.94,-9597.76 3805.13,-9589.16 3794.93,-9592.03 3798.94,-9597.76"/>
</g>
<!-- l1_attn_stage12_gpu13&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge1438" class="edge">
<title>l1_attn_stage12_gpu13&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3901.99,-9671.91C3916.92,-9665.61 3933.25,-9659.84 3949,-9656.5 3967.86,-9652.49 4629.47,-9660.23 4643,-9646.5 4668.62,-9620.51 4627.49,-9593.91 4589.04,-9576.34"/>
<polygon fill="red" stroke="red" points="4590.44,-9573.13 4579.88,-9572.29 4587.61,-9579.53 4590.44,-9573.13"/>
<text text-anchor="middle" x="4681.5" y="-9635.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu14 -->
<g id="node239" class="node">
<title>l1_attn_stage13_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4053" cy="-9555" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4053" y="-9566.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="4053" y="-9551.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4053" y="-9536.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu14&#45;&gt;l1_attn_stage13_gpu14 -->
<g id="edge223" class="edge">
<title>l1_attn_stage12_gpu14&#45;&gt;l1_attn_stage13_gpu14</title>
<path fill="none" stroke="black" d="M3995.71,-9671.89C3980.86,-9665.64 3964.64,-9659.89 3949,-9656.5 3925.76,-9651.45 3537.62,-9663.51 3521,-9646.5 3516.34,-9641.73 3516.33,-9636.26 3521,-9631.5 3529.33,-9623.01 3937.63,-9626.98 3949,-9623.5 3968.63,-9617.49 3988.07,-9606.58 4004.73,-9595.27"/>
<polygon fill="black" stroke="black" points="4007.01,-9597.95 4013.18,-9589.34 4002.99,-9592.22 4007.01,-9597.95"/>
</g>
<!-- l1_attn_stage12_gpu14&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge1439" class="edge">
<title>l1_attn_stage12_gpu14&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4110,-9671.94C4124.92,-9665.65 4141.25,-9659.87 4157,-9656.5 4172.54,-9653.17 4717.86,-9657.83 4729,-9646.5 4765.88,-9608.96 4702.24,-9585.2 4638.37,-9571.5"/>
<polygon fill="red" stroke="red" points="4639.05,-9568.06 4628.55,-9569.47 4637.63,-9574.92 4639.05,-9568.06"/>
<text text-anchor="middle" x="4768.5" y="-9635.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage13_gpu15 -->
<g id="node240" class="node">
<title>l1_attn_stage13_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4261" cy="-9555" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4261" y="-9566.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage13</text>
<text text-anchor="middle" x="4261" y="-9551.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4261" y="-9536.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage12_gpu15&#45;&gt;l1_attn_stage13_gpu15 -->
<g id="edge224" class="edge">
<title>l1_attn_stage12_gpu15&#45;&gt;l1_attn_stage13_gpu15</title>
<path fill="none" stroke="black" d="M4204,-9671.92C4189.08,-9665.63 4172.75,-9659.86 4157,-9656.5 4139.91,-9652.85 3540.26,-9658.95 3528,-9646.5 3523.32,-9641.75 3523.32,-9636.24 3528,-9631.5 3540.28,-9619.06 4140.28,-9628.56 4157,-9623.5 4176.65,-9617.54 4196.09,-9606.66 4212.75,-9595.34"/>
<polygon fill="black" stroke="black" points="4215.03,-9598.02 4221.2,-9589.41 4211.01,-9592.29 4215.03,-9598.02"/>
</g>
<!-- l1_attn_stage12_gpu15&#45;&gt;l1_attn_stage13_gpu[next_gpu] -->
<g id="edge1440" class="edge">
<title>l1_attn_stage12_gpu15&#45;&gt;l1_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4320.56,-9672.58C4336.88,-9666.06 4354.81,-9660.02 4372,-9656.5 4396.12,-9651.56 4797.79,-9664.1 4815,-9646.5 4864.67,-9595.7 4777.33,-9573.39 4687.57,-9563.6"/>
<polygon fill="red" stroke="red" points="4687.78,-9560.11 4677.47,-9562.56 4687.05,-9567.07 4687.78,-9560.11"/>
<text text-anchor="middle" x="4854.5" y="-9635.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu0 -->
<g id="node241" class="node">
<title>l1_attn_stage14_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1141" cy="-9408" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1141" y="-9419.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="1141" y="-9404.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1141" y="-9389.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu0&#45;&gt;l1_attn_stage14_gpu0 -->
<g id="edge225" class="edge">
<title>l1_attn_stage13_gpu0&#45;&gt;l1_attn_stage14_gpu0</title>
<path fill="none" stroke="black" d="M1141,-9517.41C1141,-9498.69 1141,-9475.7 1141,-9455.71"/>
<polygon fill="black" stroke="black" points="1144.5,-9455.58 1141,-9445.58 1137.5,-9455.58 1144.5,-9455.58"/>
</g>
<!-- l1_attn_stage14_gpu[next_gpu] -->
<g id="node1326" class="node">
<title>l1_attn_stage14_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4536" cy="-9408" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4536" y="-9404.3" font-family="Times,serif" font-size="14.00">l1_attn_stage14_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage13_gpu0&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge1441" class="edge">
<title>l1_attn_stage13_gpu0&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1197.98,-9524.87C1212.91,-9518.58 1229.24,-9512.82 1245,-9509.5 1494.97,-9456.85 3288.55,-9487.13 3544,-9484.5 3589.78,-9484.03 4323.1,-9485.41 4368,-9476.5 4413.32,-9467.51 4461.98,-9446.59 4495.21,-9430.4"/>
<polygon fill="red" stroke="red" points="4497.17,-9433.34 4504.58,-9425.76 4494.06,-9427.06 4497.17,-9433.34"/>
<text text-anchor="middle" x="3575.5" y="-9488.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu1 -->
<g id="node242" class="node">
<title>l1_attn_stage14_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1349" cy="-9408" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1349" y="-9419.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="1349" y="-9404.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1349" y="-9389.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu1&#45;&gt;l1_attn_stage14_gpu1 -->
<g id="edge226" class="edge">
<title>l1_attn_stage13_gpu1&#45;&gt;l1_attn_stage14_gpu1</title>
<path fill="none" stroke="black" d="M1349,-9517.41C1349,-9498.69 1349,-9475.7 1349,-9455.71"/>
<polygon fill="black" stroke="black" points="1352.5,-9455.58 1349,-9445.58 1345.5,-9455.58 1352.5,-9455.58"/>
</g>
<!-- l1_attn_stage13_gpu1&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge1442" class="edge">
<title>l1_attn_stage13_gpu1&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1405.97,-9524.8C1420.89,-9518.51 1437.23,-9512.77 1453,-9509.5 1511.7,-9497.33 3554.42,-9519.29 3611,-9499.5 3621.16,-9495.95 3619.86,-9488.08 3630,-9484.5 3668.66,-9470.84 4327.79,-9484.5 4368,-9476.5 4413.31,-9467.48 4461.98,-9446.56 4495.21,-9430.39"/>
<polygon fill="red" stroke="red" points="4497.17,-9433.32 4504.58,-9425.75 4494.06,-9427.05 4497.17,-9433.32"/>
<text text-anchor="middle" x="3661.5" y="-9488.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu2 -->
<g id="node243" class="node">
<title>l1_attn_stage14_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1557" cy="-9408" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1557" y="-9419.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="1557" y="-9404.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1557" y="-9389.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu2&#45;&gt;l1_attn_stage14_gpu2 -->
<g id="edge227" class="edge">
<title>l1_attn_stage13_gpu2&#45;&gt;l1_attn_stage14_gpu2</title>
<path fill="none" stroke="black" d="M1557,-9517.41C1557,-9498.69 1557,-9475.7 1557,-9455.71"/>
<polygon fill="black" stroke="black" points="1560.5,-9455.58 1557,-9445.58 1553.5,-9455.58 1560.5,-9455.58"/>
</g>
<!-- l1_attn_stage13_gpu2&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge1443" class="edge">
<title>l1_attn_stage13_gpu2&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1613.97,-9524.8C1628.89,-9518.51 1645.23,-9512.77 1661,-9509.5 1716.38,-9498.01 3643.62,-9518.18 3697,-9499.5 3707.16,-9495.94 3705.86,-9488.09 3716,-9484.5 3750.15,-9472.41 4332.48,-9483.59 4368,-9476.5 4413.31,-9467.45 4461.97,-9446.54 4495.2,-9430.37"/>
<polygon fill="red" stroke="red" points="4497.16,-9433.31 4504.57,-9425.74 4494.06,-9427.03 4497.16,-9433.31"/>
<text text-anchor="middle" x="3747.5" y="-9488.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu3 -->
<g id="node244" class="node">
<title>l1_attn_stage14_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1765" cy="-9408" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1765" y="-9419.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="1765" y="-9404.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1765" y="-9389.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu3&#45;&gt;l1_attn_stage14_gpu3 -->
<g id="edge228" class="edge">
<title>l1_attn_stage13_gpu3&#45;&gt;l1_attn_stage14_gpu3</title>
<path fill="none" stroke="black" d="M1765,-9517.41C1765,-9498.69 1765,-9475.7 1765,-9455.71"/>
<polygon fill="black" stroke="black" points="1768.5,-9455.58 1765,-9445.58 1761.5,-9455.58 1768.5,-9455.58"/>
</g>
<!-- l1_attn_stage13_gpu3&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge1444" class="edge">
<title>l1_attn_stage13_gpu3&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1821.97,-9524.81C1836.9,-9518.51 1853.23,-9512.77 1869,-9509.5 1921.06,-9498.69 3732.82,-9517.07 3783,-9499.5 3793.15,-9495.94 3791.86,-9488.1 3802,-9484.5 3831.63,-9473.97 4337.17,-9482.69 4368,-9476.5 4413.3,-9467.41 4461.97,-9446.5 4495.2,-9430.35"/>
<polygon fill="red" stroke="red" points="4497.15,-9433.28 4504.57,-9425.72 4494.05,-9427.01 4497.15,-9433.28"/>
<text text-anchor="middle" x="3833.5" y="-9488.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu4 -->
<g id="node245" class="node">
<title>l1_attn_stage14_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1973" cy="-9408" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1973" y="-9419.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="1973" y="-9404.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1973" y="-9389.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu4&#45;&gt;l1_attn_stage14_gpu4 -->
<g id="edge229" class="edge">
<title>l1_attn_stage13_gpu4&#45;&gt;l1_attn_stage14_gpu4</title>
<path fill="none" stroke="black" d="M1973,-9517.41C1973,-9498.69 1973,-9475.7 1973,-9455.71"/>
<polygon fill="black" stroke="black" points="1976.5,-9455.58 1973,-9445.58 1969.5,-9455.58 1976.5,-9455.58"/>
</g>
<!-- l1_attn_stage13_gpu4&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge1445" class="edge">
<title>l1_attn_stage13_gpu4&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2029.97,-9524.81C2044.9,-9518.52 2061.23,-9512.78 2077,-9509.5 2125.74,-9499.37 3822.02,-9515.95 3869,-9499.5 3879.15,-9495.94 3877.87,-9488.11 3888,-9484.5 3938.24,-9466.58 4315.72,-9487.06 4368,-9476.5 4413.29,-9467.35 4461.96,-9446.45 4495.19,-9430.31"/>
<polygon fill="red" stroke="red" points="4497.14,-9433.25 4504.56,-9425.69 4494.05,-9426.98 4497.14,-9433.25"/>
<text text-anchor="middle" x="3919.5" y="-9488.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu5 -->
<g id="node246" class="node">
<title>l1_attn_stage14_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2181" cy="-9408" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2181" y="-9419.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="2181" y="-9404.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2181" y="-9389.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu5&#45;&gt;l1_attn_stage14_gpu5 -->
<g id="edge230" class="edge">
<title>l1_attn_stage13_gpu5&#45;&gt;l1_attn_stage14_gpu5</title>
<path fill="none" stroke="black" d="M2181,-9517.41C2181,-9498.69 2181,-9475.7 2181,-9455.71"/>
<polygon fill="black" stroke="black" points="2184.5,-9455.58 2181,-9445.58 2177.5,-9455.58 2184.5,-9455.58"/>
</g>
<!-- l1_attn_stage13_gpu5&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge1446" class="edge">
<title>l1_attn_stage13_gpu5&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2237.97,-9524.82C2252.9,-9518.52 2269.23,-9512.78 2285,-9509.5 2330.42,-9500.05 3911.22,-9514.84 3955,-9499.5 3965.15,-9495.94 3963.87,-9488.13 3974,-9484.5 4015.22,-9469.72 4325.1,-9485.25 4368,-9476.5 4413.27,-9467.27 4461.94,-9446.38 4495.18,-9430.27"/>
<polygon fill="red" stroke="red" points="4497.13,-9433.21 4504.56,-9425.65 4494.04,-9426.93 4497.13,-9433.21"/>
<text text-anchor="middle" x="4005.5" y="-9488.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu6 -->
<g id="node247" class="node">
<title>l1_attn_stage14_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2389" cy="-9408" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2389" y="-9419.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="2389" y="-9404.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2389" y="-9389.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu6&#45;&gt;l1_attn_stage14_gpu6 -->
<g id="edge231" class="edge">
<title>l1_attn_stage13_gpu6&#45;&gt;l1_attn_stage14_gpu6</title>
<path fill="none" stroke="black" d="M2389,-9517.41C2389,-9498.69 2389,-9475.7 2389,-9455.71"/>
<polygon fill="black" stroke="black" points="2392.5,-9455.58 2389,-9445.58 2385.5,-9455.58 2392.5,-9455.58"/>
</g>
<!-- l1_attn_stage13_gpu6&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge1447" class="edge">
<title>l1_attn_stage13_gpu6&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2445.97,-9524.82C2460.9,-9518.53 2477.23,-9512.78 2493,-9509.5 2535.1,-9500.73 4000.42,-9513.73 4041,-9499.5 4051.15,-9495.94 4049.88,-9488.16 4060,-9484.5 4092.19,-9472.85 4334.48,-9483.43 4368,-9476.5 4413.11,-9467.17 4461.62,-9446.4 4494.86,-9430.35"/>
<polygon fill="red" stroke="red" points="4496.8,-9433.3 4504.24,-9425.75 4493.72,-9427.01 4496.8,-9433.3"/>
<text text-anchor="middle" x="4091.5" y="-9488.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu7 -->
<g id="node248" class="node">
<title>l1_attn_stage14_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2597" cy="-9408" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2597" y="-9419.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="2597" y="-9404.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2597" y="-9389.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu7&#45;&gt;l1_attn_stage14_gpu7 -->
<g id="edge232" class="edge">
<title>l1_attn_stage13_gpu7&#45;&gt;l1_attn_stage14_gpu7</title>
<path fill="none" stroke="black" d="M2597,-9517.41C2597,-9498.69 2597,-9475.7 2597,-9455.71"/>
<polygon fill="black" stroke="black" points="2600.5,-9455.58 2597,-9445.58 2593.5,-9455.58 2600.5,-9455.58"/>
</g>
<!-- l1_attn_stage13_gpu7&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge1448" class="edge">
<title>l1_attn_stage13_gpu7&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2653.98,-9524.83C2668.9,-9518.53 2685.24,-9512.79 2701,-9509.5 2739.78,-9501.41 4089.62,-9512.62 4127,-9499.5 4137.15,-9495.93 4135.9,-9488.21 4146,-9484.5 4192.34,-9467.47 4319.71,-9486.74 4368,-9476.5 4413.06,-9466.94 4461.58,-9446.21 4494.83,-9430.23"/>
<polygon fill="red" stroke="red" points="4496.76,-9433.18 4504.22,-9425.65 4493.69,-9426.89 4496.76,-9433.18"/>
<text text-anchor="middle" x="4177.5" y="-9488.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu8 -->
<g id="node249" class="node">
<title>l1_attn_stage14_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2805" cy="-9408" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2805" y="-9419.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="2805" y="-9404.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2805" y="-9389.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu8&#45;&gt;l1_attn_stage14_gpu8 -->
<g id="edge233" class="edge">
<title>l1_attn_stage13_gpu8&#45;&gt;l1_attn_stage14_gpu8</title>
<path fill="none" stroke="black" d="M2805,-9517.41C2805,-9498.69 2805,-9475.7 2805,-9455.71"/>
<polygon fill="black" stroke="black" points="2808.5,-9455.58 2805,-9445.58 2801.5,-9455.58 2808.5,-9455.58"/>
</g>
<!-- l1_attn_stage13_gpu8&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge1449" class="edge">
<title>l1_attn_stage13_gpu8&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2861.98,-9524.84C2876.9,-9518.54 2893.24,-9512.79 2909,-9509.5 2979.91,-9494.68 4144.65,-9523.52 4213,-9499.5 4223.15,-9495.93 4221.94,-9488.32 4232,-9484.5 4260.3,-9473.73 4338.46,-9483.12 4368,-9476.5 4412.67,-9466.49 4460.88,-9446.03 4494.15,-9430.24"/>
<polygon fill="red" stroke="red" points="4496.06,-9433.21 4503.55,-9425.72 4493.02,-9426.9 4496.06,-9433.21"/>
<text text-anchor="middle" x="4263.5" y="-9488.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu9 -->
<g id="node250" class="node">
<title>l1_attn_stage14_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3013" cy="-9408" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3013" y="-9419.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="3013" y="-9404.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3013" y="-9389.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu9&#45;&gt;l1_attn_stage14_gpu9 -->
<g id="edge234" class="edge">
<title>l1_attn_stage13_gpu9&#45;&gt;l1_attn_stage14_gpu9</title>
<path fill="none" stroke="black" d="M3013,-9517.41C3013,-9498.69 3013,-9475.7 3013,-9455.71"/>
<polygon fill="black" stroke="black" points="3016.5,-9455.58 3013,-9445.58 3009.5,-9455.58 3016.5,-9455.58"/>
</g>
<!-- l1_attn_stage13_gpu9&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge1450" class="edge">
<title>l1_attn_stage13_gpu9&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3069.98,-9524.84C3084.9,-9518.55 3101.24,-9512.8 3117,-9509.5 3181.28,-9496.04 4237.05,-9521.3 4299,-9499.5 4309.15,-9495.93 4308.15,-9488.82 4318,-9484.5 4338.61,-9475.46 4346.31,-9482.51 4368,-9476.5 4411.28,-9464.5 4458.59,-9444.87 4491.94,-9429.86"/>
<polygon fill="red" stroke="red" points="4493.74,-9432.89 4501.4,-9425.56 4490.84,-9426.51 4493.74,-9432.89"/>
<text text-anchor="middle" x="4349.5" y="-9488.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu10 -->
<g id="node251" class="node">
<title>l1_attn_stage14_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3221" cy="-9408" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3221" y="-9419.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="3221" y="-9404.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3221" y="-9389.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu10&#45;&gt;l1_attn_stage14_gpu10 -->
<g id="edge235" class="edge">
<title>l1_attn_stage13_gpu10&#45;&gt;l1_attn_stage14_gpu10</title>
<path fill="none" stroke="black" d="M3221,-9517.41C3221,-9498.69 3221,-9475.7 3221,-9455.71"/>
<polygon fill="black" stroke="black" points="3224.5,-9455.58 3221,-9445.58 3217.5,-9455.58 3224.5,-9455.58"/>
</g>
<!-- l1_attn_stage13_gpu10&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge1451" class="edge">
<title>l1_attn_stage13_gpu10&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3277.98,-9524.85C3292.91,-9518.56 3309.24,-9512.81 3325,-9509.5 3382.64,-9497.4 4329.46,-9519.07 4385,-9499.5 4395.15,-9495.92 4395.08,-9490.52 4404,-9484.5 4433.36,-9464.67 4468.2,-9444.89 4494.72,-9430.55"/>
<polygon fill="red" stroke="red" points="4496.57,-9433.53 4503.73,-9425.71 4493.26,-9427.36 4496.57,-9433.53"/>
<text text-anchor="middle" x="4435.5" y="-9488.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu11 -->
<g id="node252" class="node">
<title>l1_attn_stage14_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3429" cy="-9408" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3429" y="-9419.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="3429" y="-9404.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3429" y="-9389.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu11&#45;&gt;l1_attn_stage14_gpu11 -->
<g id="edge236" class="edge">
<title>l1_attn_stage13_gpu11&#45;&gt;l1_attn_stage14_gpu11</title>
<path fill="none" stroke="black" d="M3429,-9517.41C3429,-9498.69 3429,-9475.7 3429,-9455.71"/>
<polygon fill="black" stroke="black" points="3432.5,-9455.58 3429,-9445.58 3425.5,-9455.58 3432.5,-9455.58"/>
</g>
<!-- l1_attn_stage13_gpu11&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge1452" class="edge">
<title>l1_attn_stage13_gpu11&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3485.98,-9524.87C3500.91,-9518.57 3517.24,-9512.82 3533,-9509.5 3558.5,-9504.13 4447.88,-9511.51 4471,-9499.5 4484.7,-9492.38 4506.58,-9458.96 4521.12,-9434.8"/>
<polygon fill="red" stroke="red" points="4524.21,-9436.45 4526.3,-9426.07 4518.19,-9432.88 4524.21,-9436.45"/>
<text text-anchor="middle" x="4517.5" y="-9488.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu12 -->
<g id="node253" class="node">
<title>l1_attn_stage14_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3637" cy="-9408" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3637" y="-9419.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="3637" y="-9404.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3637" y="-9389.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu12&#45;&gt;l1_attn_stage14_gpu12 -->
<g id="edge237" class="edge">
<title>l1_attn_stage13_gpu12&#45;&gt;l1_attn_stage14_gpu12</title>
<path fill="none" stroke="black" d="M3574.19,-9526.68C3560.64,-9520.91 3546.37,-9514.93 3533,-9509.5 3521.53,-9504.84 3514.01,-9509.7 3507,-9499.5 3503.23,-9494 3503.04,-9489.86 3507,-9484.5 3514.18,-9474.77 3522.05,-9481.62 3533,-9476.5 3550.44,-9468.35 3568.39,-9457.65 3584.36,-9447.19"/>
<polygon fill="black" stroke="black" points="3586.64,-9449.88 3593.02,-9441.42 3582.76,-9444.05 3586.64,-9449.88"/>
</g>
<!-- l1_attn_stage13_gpu12&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge1453" class="edge">
<title>l1_attn_stage13_gpu12&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3693.99,-9524.89C3708.91,-9518.59 3725.24,-9512.83 3741,-9509.5 3763.18,-9504.81 4541.07,-9515.62 4557,-9499.5 4573.71,-9482.58 4564.21,-9455.14 4553.15,-9434.9"/>
<polygon fill="red" stroke="red" points="4556.11,-9433.04 4548.04,-9426.17 4550.07,-9436.57 4556.11,-9433.04"/>
<text text-anchor="middle" x="4595.5" y="-9488.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu13 -->
<g id="node254" class="node">
<title>l1_attn_stage14_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3845" cy="-9408" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3845" y="-9419.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="3845" y="-9404.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3845" y="-9389.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu13&#45;&gt;l1_attn_stage14_gpu13 -->
<g id="edge238" class="edge">
<title>l1_attn_stage13_gpu13&#45;&gt;l1_attn_stage14_gpu13</title>
<path fill="none" stroke="black" d="M3787.39,-9525C3772.62,-9518.79 3756.51,-9513.03 3741,-9509.5 3716.39,-9503.89 3531.45,-9517.74 3514,-9499.5 3509.39,-9494.68 3509.37,-9489.29 3514,-9484.5 3522.76,-9475.42 3728.97,-9480.29 3741,-9476.5 3760.58,-9470.32 3780,-9459.38 3796.67,-9448.08"/>
<polygon fill="black" stroke="black" points="3798.94,-9450.76 3805.13,-9442.16 3794.93,-9445.03 3798.94,-9450.76"/>
</g>
<!-- l1_attn_stage13_gpu13&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge1454" class="edge">
<title>l1_attn_stage13_gpu13&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3901.99,-9524.91C3916.92,-9518.61 3933.25,-9512.84 3949,-9509.5 3967.86,-9505.49 4629.47,-9513.23 4643,-9499.5 4668.62,-9473.51 4627.49,-9446.91 4589.04,-9429.34"/>
<polygon fill="red" stroke="red" points="4590.44,-9426.13 4579.88,-9425.29 4587.61,-9432.53 4590.44,-9426.13"/>
<text text-anchor="middle" x="4681.5" y="-9488.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu14 -->
<g id="node255" class="node">
<title>l1_attn_stage14_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4053" cy="-9408" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4053" y="-9419.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="4053" y="-9404.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4053" y="-9389.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu14&#45;&gt;l1_attn_stage14_gpu14 -->
<g id="edge239" class="edge">
<title>l1_attn_stage13_gpu14&#45;&gt;l1_attn_stage14_gpu14</title>
<path fill="none" stroke="black" d="M3995.71,-9524.89C3980.86,-9518.64 3964.64,-9512.89 3949,-9509.5 3925.76,-9504.45 3537.62,-9516.51 3521,-9499.5 3516.34,-9494.73 3516.33,-9489.26 3521,-9484.5 3529.33,-9476.01 3937.63,-9479.98 3949,-9476.5 3968.63,-9470.49 3988.07,-9459.58 4004.73,-9448.27"/>
<polygon fill="black" stroke="black" points="4007.01,-9450.95 4013.18,-9442.34 4002.99,-9445.22 4007.01,-9450.95"/>
</g>
<!-- l1_attn_stage13_gpu14&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge1455" class="edge">
<title>l1_attn_stage13_gpu14&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4110,-9524.94C4124.92,-9518.65 4141.25,-9512.87 4157,-9509.5 4172.54,-9506.17 4717.86,-9510.83 4729,-9499.5 4765.88,-9461.96 4702.24,-9438.2 4638.37,-9424.5"/>
<polygon fill="red" stroke="red" points="4639.05,-9421.06 4628.55,-9422.47 4637.63,-9427.92 4639.05,-9421.06"/>
<text text-anchor="middle" x="4768.5" y="-9488.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage14_gpu15 -->
<g id="node256" class="node">
<title>l1_attn_stage14_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4261" cy="-9408" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4261" y="-9419.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage14</text>
<text text-anchor="middle" x="4261" y="-9404.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4261" y="-9389.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage13_gpu15&#45;&gt;l1_attn_stage14_gpu15 -->
<g id="edge240" class="edge">
<title>l1_attn_stage13_gpu15&#45;&gt;l1_attn_stage14_gpu15</title>
<path fill="none" stroke="black" d="M4204,-9524.92C4189.08,-9518.63 4172.75,-9512.86 4157,-9509.5 4139.91,-9505.85 3540.26,-9511.95 3528,-9499.5 3523.32,-9494.75 3523.32,-9489.24 3528,-9484.5 3540.28,-9472.06 4140.28,-9481.56 4157,-9476.5 4176.65,-9470.54 4196.09,-9459.66 4212.75,-9448.34"/>
<polygon fill="black" stroke="black" points="4215.03,-9451.02 4221.2,-9442.41 4211.01,-9445.29 4215.03,-9451.02"/>
</g>
<!-- l1_attn_stage13_gpu15&#45;&gt;l1_attn_stage14_gpu[next_gpu] -->
<g id="edge1456" class="edge">
<title>l1_attn_stage13_gpu15&#45;&gt;l1_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4320.56,-9525.58C4336.88,-9519.06 4354.81,-9513.02 4372,-9509.5 4396.12,-9504.56 4797.79,-9517.1 4815,-9499.5 4864.67,-9448.7 4777.33,-9426.39 4687.57,-9416.6"/>
<polygon fill="red" stroke="red" points="4687.78,-9413.11 4677.47,-9415.56 4687.05,-9420.07 4687.78,-9413.11"/>
<text text-anchor="middle" x="4854.5" y="-9488.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu0 -->
<g id="node257" class="node">
<title>l1_attn_stage15_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1141" cy="-9261" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1141" y="-9272.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="1141" y="-9257.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1141" y="-9242.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu0&#45;&gt;l1_attn_stage15_gpu0 -->
<g id="edge241" class="edge">
<title>l1_attn_stage14_gpu0&#45;&gt;l1_attn_stage15_gpu0</title>
<path fill="none" stroke="black" d="M1141,-9370.41C1141,-9351.69 1141,-9328.7 1141,-9308.71"/>
<polygon fill="black" stroke="black" points="1144.5,-9308.58 1141,-9298.58 1137.5,-9308.58 1144.5,-9308.58"/>
</g>
<!-- l1_attn_stage15_gpu[next_gpu] -->
<g id="node1327" class="node">
<title>l1_attn_stage15_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4536" cy="-9261" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4536" y="-9257.3" font-family="Times,serif" font-size="14.00">l1_attn_stage15_gpu[next_gpu]</text>
</g>
<!-- l1_attn_stage14_gpu0&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge1457" class="edge">
<title>l1_attn_stage14_gpu0&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1197.98,-9377.87C1212.91,-9371.58 1229.24,-9365.82 1245,-9362.5 1494.97,-9309.85 3288.55,-9340.13 3544,-9337.5 3589.78,-9337.03 4323.1,-9338.41 4368,-9329.5 4413.32,-9320.51 4461.98,-9299.59 4495.21,-9283.4"/>
<polygon fill="red" stroke="red" points="4497.17,-9286.34 4504.58,-9278.76 4494.06,-9280.06 4497.17,-9286.34"/>
<text text-anchor="middle" x="3575.5" y="-9341.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu1 -->
<g id="node258" class="node">
<title>l1_attn_stage15_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1349" cy="-9261" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1349" y="-9272.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="1349" y="-9257.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1349" y="-9242.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu1&#45;&gt;l1_attn_stage15_gpu1 -->
<g id="edge242" class="edge">
<title>l1_attn_stage14_gpu1&#45;&gt;l1_attn_stage15_gpu1</title>
<path fill="none" stroke="black" d="M1349,-9370.41C1349,-9351.69 1349,-9328.7 1349,-9308.71"/>
<polygon fill="black" stroke="black" points="1352.5,-9308.58 1349,-9298.58 1345.5,-9308.58 1352.5,-9308.58"/>
</g>
<!-- l1_attn_stage14_gpu1&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge1458" class="edge">
<title>l1_attn_stage14_gpu1&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1405.97,-9377.8C1420.89,-9371.51 1437.23,-9365.77 1453,-9362.5 1511.7,-9350.33 3554.42,-9372.29 3611,-9352.5 3621.16,-9348.95 3619.86,-9341.08 3630,-9337.5 3668.66,-9323.84 4327.79,-9337.5 4368,-9329.5 4413.31,-9320.48 4461.98,-9299.56 4495.21,-9283.39"/>
<polygon fill="red" stroke="red" points="4497.17,-9286.32 4504.58,-9278.75 4494.06,-9280.05 4497.17,-9286.32"/>
<text text-anchor="middle" x="3661.5" y="-9341.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu2 -->
<g id="node259" class="node">
<title>l1_attn_stage15_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1557" cy="-9261" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1557" y="-9272.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="1557" y="-9257.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1557" y="-9242.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu2&#45;&gt;l1_attn_stage15_gpu2 -->
<g id="edge243" class="edge">
<title>l1_attn_stage14_gpu2&#45;&gt;l1_attn_stage15_gpu2</title>
<path fill="none" stroke="black" d="M1557,-9370.41C1557,-9351.69 1557,-9328.7 1557,-9308.71"/>
<polygon fill="black" stroke="black" points="1560.5,-9308.58 1557,-9298.58 1553.5,-9308.58 1560.5,-9308.58"/>
</g>
<!-- l1_attn_stage14_gpu2&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge1459" class="edge">
<title>l1_attn_stage14_gpu2&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1613.97,-9377.8C1628.89,-9371.51 1645.23,-9365.77 1661,-9362.5 1716.38,-9351.01 3643.62,-9371.18 3697,-9352.5 3707.16,-9348.94 3705.86,-9341.09 3716,-9337.5 3750.15,-9325.41 4332.48,-9336.59 4368,-9329.5 4413.31,-9320.45 4461.97,-9299.54 4495.2,-9283.37"/>
<polygon fill="red" stroke="red" points="4497.16,-9286.31 4504.57,-9278.74 4494.06,-9280.03 4497.16,-9286.31"/>
<text text-anchor="middle" x="3747.5" y="-9341.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu3 -->
<g id="node260" class="node">
<title>l1_attn_stage15_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1765" cy="-9261" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1765" y="-9272.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="1765" y="-9257.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1765" y="-9242.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu3&#45;&gt;l1_attn_stage15_gpu3 -->
<g id="edge244" class="edge">
<title>l1_attn_stage14_gpu3&#45;&gt;l1_attn_stage15_gpu3</title>
<path fill="none" stroke="black" d="M1765,-9370.41C1765,-9351.69 1765,-9328.7 1765,-9308.71"/>
<polygon fill="black" stroke="black" points="1768.5,-9308.58 1765,-9298.58 1761.5,-9308.58 1768.5,-9308.58"/>
</g>
<!-- l1_attn_stage14_gpu3&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge1460" class="edge">
<title>l1_attn_stage14_gpu3&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1821.97,-9377.81C1836.9,-9371.51 1853.23,-9365.77 1869,-9362.5 1921.06,-9351.69 3732.82,-9370.07 3783,-9352.5 3793.15,-9348.94 3791.86,-9341.1 3802,-9337.5 3831.63,-9326.97 4337.17,-9335.69 4368,-9329.5 4413.3,-9320.41 4461.97,-9299.5 4495.2,-9283.35"/>
<polygon fill="red" stroke="red" points="4497.15,-9286.28 4504.57,-9278.72 4494.05,-9280.01 4497.15,-9286.28"/>
<text text-anchor="middle" x="3833.5" y="-9341.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu4 -->
<g id="node261" class="node">
<title>l1_attn_stage15_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1973" cy="-9261" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1973" y="-9272.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="1973" y="-9257.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1973" y="-9242.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu4&#45;&gt;l1_attn_stage15_gpu4 -->
<g id="edge245" class="edge">
<title>l1_attn_stage14_gpu4&#45;&gt;l1_attn_stage15_gpu4</title>
<path fill="none" stroke="black" d="M1973,-9370.41C1973,-9351.69 1973,-9328.7 1973,-9308.71"/>
<polygon fill="black" stroke="black" points="1976.5,-9308.58 1973,-9298.58 1969.5,-9308.58 1976.5,-9308.58"/>
</g>
<!-- l1_attn_stage14_gpu4&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge1461" class="edge">
<title>l1_attn_stage14_gpu4&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2029.97,-9377.81C2044.9,-9371.52 2061.23,-9365.78 2077,-9362.5 2125.74,-9352.37 3822.02,-9368.95 3869,-9352.5 3879.15,-9348.94 3877.87,-9341.11 3888,-9337.5 3938.24,-9319.58 4315.72,-9340.06 4368,-9329.5 4413.29,-9320.35 4461.96,-9299.45 4495.19,-9283.31"/>
<polygon fill="red" stroke="red" points="4497.14,-9286.25 4504.56,-9278.69 4494.05,-9279.98 4497.14,-9286.25"/>
<text text-anchor="middle" x="3919.5" y="-9341.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu5 -->
<g id="node262" class="node">
<title>l1_attn_stage15_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2181" cy="-9261" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2181" y="-9272.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="2181" y="-9257.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2181" y="-9242.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu5&#45;&gt;l1_attn_stage15_gpu5 -->
<g id="edge246" class="edge">
<title>l1_attn_stage14_gpu5&#45;&gt;l1_attn_stage15_gpu5</title>
<path fill="none" stroke="black" d="M2181,-9370.41C2181,-9351.69 2181,-9328.7 2181,-9308.71"/>
<polygon fill="black" stroke="black" points="2184.5,-9308.58 2181,-9298.58 2177.5,-9308.58 2184.5,-9308.58"/>
</g>
<!-- l1_attn_stage14_gpu5&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge1462" class="edge">
<title>l1_attn_stage14_gpu5&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2237.97,-9377.82C2252.9,-9371.52 2269.23,-9365.78 2285,-9362.5 2330.42,-9353.05 3911.22,-9367.84 3955,-9352.5 3965.15,-9348.94 3963.87,-9341.13 3974,-9337.5 4015.22,-9322.72 4325.1,-9338.25 4368,-9329.5 4413.27,-9320.27 4461.94,-9299.38 4495.18,-9283.27"/>
<polygon fill="red" stroke="red" points="4497.13,-9286.21 4504.56,-9278.65 4494.04,-9279.93 4497.13,-9286.21"/>
<text text-anchor="middle" x="4005.5" y="-9341.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu6 -->
<g id="node263" class="node">
<title>l1_attn_stage15_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2389" cy="-9261" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2389" y="-9272.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="2389" y="-9257.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2389" y="-9242.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu6&#45;&gt;l1_attn_stage15_gpu6 -->
<g id="edge247" class="edge">
<title>l1_attn_stage14_gpu6&#45;&gt;l1_attn_stage15_gpu6</title>
<path fill="none" stroke="black" d="M2389,-9370.41C2389,-9351.69 2389,-9328.7 2389,-9308.71"/>
<polygon fill="black" stroke="black" points="2392.5,-9308.58 2389,-9298.58 2385.5,-9308.58 2392.5,-9308.58"/>
</g>
<!-- l1_attn_stage14_gpu6&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge1463" class="edge">
<title>l1_attn_stage14_gpu6&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2445.97,-9377.82C2460.9,-9371.53 2477.23,-9365.78 2493,-9362.5 2535.1,-9353.73 4000.42,-9366.73 4041,-9352.5 4051.15,-9348.94 4049.88,-9341.16 4060,-9337.5 4092.19,-9325.85 4334.48,-9336.43 4368,-9329.5 4413.11,-9320.17 4461.62,-9299.4 4494.86,-9283.35"/>
<polygon fill="red" stroke="red" points="4496.8,-9286.3 4504.24,-9278.75 4493.72,-9280.01 4496.8,-9286.3"/>
<text text-anchor="middle" x="4091.5" y="-9341.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu7 -->
<g id="node264" class="node">
<title>l1_attn_stage15_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2597" cy="-9261" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2597" y="-9272.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="2597" y="-9257.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2597" y="-9242.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu7&#45;&gt;l1_attn_stage15_gpu7 -->
<g id="edge248" class="edge">
<title>l1_attn_stage14_gpu7&#45;&gt;l1_attn_stage15_gpu7</title>
<path fill="none" stroke="black" d="M2597,-9370.41C2597,-9351.69 2597,-9328.7 2597,-9308.71"/>
<polygon fill="black" stroke="black" points="2600.5,-9308.58 2597,-9298.58 2593.5,-9308.58 2600.5,-9308.58"/>
</g>
<!-- l1_attn_stage14_gpu7&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge1464" class="edge">
<title>l1_attn_stage14_gpu7&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2653.98,-9377.83C2668.9,-9371.53 2685.24,-9365.79 2701,-9362.5 2739.78,-9354.41 4089.62,-9365.62 4127,-9352.5 4137.15,-9348.93 4135.9,-9341.21 4146,-9337.5 4192.34,-9320.47 4319.71,-9339.74 4368,-9329.5 4413.06,-9319.94 4461.58,-9299.21 4494.83,-9283.23"/>
<polygon fill="red" stroke="red" points="4496.76,-9286.18 4504.22,-9278.65 4493.69,-9279.89 4496.76,-9286.18"/>
<text text-anchor="middle" x="4177.5" y="-9341.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu8 -->
<g id="node265" class="node">
<title>l1_attn_stage15_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2805" cy="-9261" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2805" y="-9272.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="2805" y="-9257.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2805" y="-9242.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu8&#45;&gt;l1_attn_stage15_gpu8 -->
<g id="edge249" class="edge">
<title>l1_attn_stage14_gpu8&#45;&gt;l1_attn_stage15_gpu8</title>
<path fill="none" stroke="black" d="M2805,-9370.41C2805,-9351.69 2805,-9328.7 2805,-9308.71"/>
<polygon fill="black" stroke="black" points="2808.5,-9308.58 2805,-9298.58 2801.5,-9308.58 2808.5,-9308.58"/>
</g>
<!-- l1_attn_stage14_gpu8&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge1465" class="edge">
<title>l1_attn_stage14_gpu8&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2861.98,-9377.84C2876.9,-9371.54 2893.24,-9365.79 2909,-9362.5 2979.91,-9347.68 4144.65,-9376.52 4213,-9352.5 4223.15,-9348.93 4221.94,-9341.32 4232,-9337.5 4260.3,-9326.73 4338.46,-9336.12 4368,-9329.5 4412.67,-9319.49 4460.88,-9299.03 4494.15,-9283.24"/>
<polygon fill="red" stroke="red" points="4496.06,-9286.21 4503.55,-9278.72 4493.02,-9279.9 4496.06,-9286.21"/>
<text text-anchor="middle" x="4263.5" y="-9341.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu9 -->
<g id="node266" class="node">
<title>l1_attn_stage15_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3013" cy="-9261" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3013" y="-9272.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="3013" y="-9257.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3013" y="-9242.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu9&#45;&gt;l1_attn_stage15_gpu9 -->
<g id="edge250" class="edge">
<title>l1_attn_stage14_gpu9&#45;&gt;l1_attn_stage15_gpu9</title>
<path fill="none" stroke="black" d="M3013,-9370.41C3013,-9351.69 3013,-9328.7 3013,-9308.71"/>
<polygon fill="black" stroke="black" points="3016.5,-9308.58 3013,-9298.58 3009.5,-9308.58 3016.5,-9308.58"/>
</g>
<!-- l1_attn_stage14_gpu9&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge1466" class="edge">
<title>l1_attn_stage14_gpu9&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3069.98,-9377.84C3084.9,-9371.55 3101.24,-9365.8 3117,-9362.5 3181.28,-9349.04 4237.05,-9374.3 4299,-9352.5 4309.15,-9348.93 4308.15,-9341.82 4318,-9337.5 4338.61,-9328.46 4346.31,-9335.51 4368,-9329.5 4411.28,-9317.5 4458.59,-9297.87 4491.94,-9282.86"/>
<polygon fill="red" stroke="red" points="4493.74,-9285.89 4501.4,-9278.56 4490.84,-9279.51 4493.74,-9285.89"/>
<text text-anchor="middle" x="4349.5" y="-9341.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu10 -->
<g id="node267" class="node">
<title>l1_attn_stage15_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3221" cy="-9261" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3221" y="-9272.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="3221" y="-9257.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3221" y="-9242.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu10&#45;&gt;l1_attn_stage15_gpu10 -->
<g id="edge251" class="edge">
<title>l1_attn_stage14_gpu10&#45;&gt;l1_attn_stage15_gpu10</title>
<path fill="none" stroke="black" d="M3221,-9370.41C3221,-9351.69 3221,-9328.7 3221,-9308.71"/>
<polygon fill="black" stroke="black" points="3224.5,-9308.58 3221,-9298.58 3217.5,-9308.58 3224.5,-9308.58"/>
</g>
<!-- l1_attn_stage14_gpu10&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge1467" class="edge">
<title>l1_attn_stage14_gpu10&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3277.98,-9377.85C3292.91,-9371.56 3309.24,-9365.81 3325,-9362.5 3382.64,-9350.4 4329.46,-9372.07 4385,-9352.5 4395.15,-9348.92 4395.08,-9343.52 4404,-9337.5 4433.36,-9317.67 4468.2,-9297.89 4494.72,-9283.55"/>
<polygon fill="red" stroke="red" points="4496.57,-9286.53 4503.73,-9278.71 4493.26,-9280.36 4496.57,-9286.53"/>
<text text-anchor="middle" x="4435.5" y="-9341.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu11 -->
<g id="node268" class="node">
<title>l1_attn_stage15_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3429" cy="-9261" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3429" y="-9272.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="3429" y="-9257.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3429" y="-9242.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu11&#45;&gt;l1_attn_stage15_gpu11 -->
<g id="edge252" class="edge">
<title>l1_attn_stage14_gpu11&#45;&gt;l1_attn_stage15_gpu11</title>
<path fill="none" stroke="black" d="M3429,-9370.41C3429,-9351.69 3429,-9328.7 3429,-9308.71"/>
<polygon fill="black" stroke="black" points="3432.5,-9308.58 3429,-9298.58 3425.5,-9308.58 3432.5,-9308.58"/>
</g>
<!-- l1_attn_stage14_gpu11&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge1468" class="edge">
<title>l1_attn_stage14_gpu11&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3485.98,-9377.87C3500.91,-9371.57 3517.24,-9365.82 3533,-9362.5 3558.5,-9357.13 4447.88,-9364.51 4471,-9352.5 4484.7,-9345.38 4506.58,-9311.96 4521.12,-9287.8"/>
<polygon fill="red" stroke="red" points="4524.21,-9289.45 4526.3,-9279.07 4518.19,-9285.88 4524.21,-9289.45"/>
<text text-anchor="middle" x="4517.5" y="-9341.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu12 -->
<g id="node269" class="node">
<title>l1_attn_stage15_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3637" cy="-9261" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3637" y="-9272.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="3637" y="-9257.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3637" y="-9242.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu12&#45;&gt;l1_attn_stage15_gpu12 -->
<g id="edge253" class="edge">
<title>l1_attn_stage14_gpu12&#45;&gt;l1_attn_stage15_gpu12</title>
<path fill="none" stroke="black" d="M3574.19,-9379.68C3560.64,-9373.91 3546.37,-9367.93 3533,-9362.5 3521.53,-9357.84 3514.01,-9362.7 3507,-9352.5 3503.23,-9347 3503.04,-9342.86 3507,-9337.5 3514.18,-9327.77 3522.05,-9334.62 3533,-9329.5 3550.44,-9321.35 3568.39,-9310.65 3584.36,-9300.19"/>
<polygon fill="black" stroke="black" points="3586.64,-9302.88 3593.02,-9294.42 3582.76,-9297.05 3586.64,-9302.88"/>
</g>
<!-- l1_attn_stage14_gpu12&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge1469" class="edge">
<title>l1_attn_stage14_gpu12&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3693.99,-9377.89C3708.91,-9371.59 3725.24,-9365.83 3741,-9362.5 3763.18,-9357.81 4541.07,-9368.62 4557,-9352.5 4573.71,-9335.58 4564.21,-9308.14 4553.15,-9287.9"/>
<polygon fill="red" stroke="red" points="4556.11,-9286.04 4548.04,-9279.17 4550.07,-9289.57 4556.11,-9286.04"/>
<text text-anchor="middle" x="4595.5" y="-9341.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu13 -->
<g id="node270" class="node">
<title>l1_attn_stage15_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3845" cy="-9261" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3845" y="-9272.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="3845" y="-9257.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3845" y="-9242.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu13&#45;&gt;l1_attn_stage15_gpu13 -->
<g id="edge254" class="edge">
<title>l1_attn_stage14_gpu13&#45;&gt;l1_attn_stage15_gpu13</title>
<path fill="none" stroke="black" d="M3787.39,-9378C3772.62,-9371.79 3756.51,-9366.03 3741,-9362.5 3716.39,-9356.89 3531.45,-9370.74 3514,-9352.5 3509.39,-9347.68 3509.37,-9342.29 3514,-9337.5 3522.76,-9328.42 3728.97,-9333.29 3741,-9329.5 3760.58,-9323.32 3780,-9312.38 3796.67,-9301.08"/>
<polygon fill="black" stroke="black" points="3798.94,-9303.76 3805.13,-9295.16 3794.93,-9298.03 3798.94,-9303.76"/>
</g>
<!-- l1_attn_stage14_gpu13&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge1470" class="edge">
<title>l1_attn_stage14_gpu13&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3901.99,-9377.91C3916.92,-9371.61 3933.25,-9365.84 3949,-9362.5 3967.86,-9358.49 4629.47,-9366.23 4643,-9352.5 4668.62,-9326.51 4627.49,-9299.91 4589.04,-9282.34"/>
<polygon fill="red" stroke="red" points="4590.44,-9279.13 4579.88,-9278.29 4587.61,-9285.53 4590.44,-9279.13"/>
<text text-anchor="middle" x="4681.5" y="-9341.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu14 -->
<g id="node271" class="node">
<title>l1_attn_stage15_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4053" cy="-9261" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4053" y="-9272.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="4053" y="-9257.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4053" y="-9242.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu14&#45;&gt;l1_attn_stage15_gpu14 -->
<g id="edge255" class="edge">
<title>l1_attn_stage14_gpu14&#45;&gt;l1_attn_stage15_gpu14</title>
<path fill="none" stroke="black" d="M3995.71,-9377.89C3980.86,-9371.64 3964.64,-9365.89 3949,-9362.5 3925.76,-9357.45 3537.62,-9369.51 3521,-9352.5 3516.34,-9347.73 3516.33,-9342.26 3521,-9337.5 3529.33,-9329.01 3937.63,-9332.98 3949,-9329.5 3968.63,-9323.49 3988.07,-9312.58 4004.73,-9301.27"/>
<polygon fill="black" stroke="black" points="4007.01,-9303.95 4013.18,-9295.34 4002.99,-9298.22 4007.01,-9303.95"/>
</g>
<!-- l1_attn_stage14_gpu14&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge1471" class="edge">
<title>l1_attn_stage14_gpu14&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4110,-9377.94C4124.92,-9371.65 4141.25,-9365.87 4157,-9362.5 4172.54,-9359.17 4717.86,-9363.83 4729,-9352.5 4765.88,-9314.96 4702.24,-9291.2 4638.37,-9277.5"/>
<polygon fill="red" stroke="red" points="4639.05,-9274.06 4628.55,-9275.47 4637.63,-9280.92 4639.05,-9274.06"/>
<text text-anchor="middle" x="4768.5" y="-9341.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_stage15_gpu15 -->
<g id="node272" class="node">
<title>l1_attn_stage15_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4261" cy="-9261" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4261" y="-9272.3" font-family="Times,serif" font-size="14.00">L1 Attn Stage15</text>
<text text-anchor="middle" x="4261" y="-9257.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4261" y="-9242.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l1_attn_stage14_gpu15&#45;&gt;l1_attn_stage15_gpu15 -->
<g id="edge256" class="edge">
<title>l1_attn_stage14_gpu15&#45;&gt;l1_attn_stage15_gpu15</title>
<path fill="none" stroke="black" d="M4204,-9377.92C4189.08,-9371.63 4172.75,-9365.86 4157,-9362.5 4139.91,-9358.85 3540.26,-9364.95 3528,-9352.5 3523.32,-9347.75 3523.32,-9342.24 3528,-9337.5 3540.28,-9325.06 4140.28,-9334.56 4157,-9329.5 4176.65,-9323.54 4196.09,-9312.66 4212.75,-9301.34"/>
<polygon fill="black" stroke="black" points="4215.03,-9304.02 4221.2,-9295.41 4211.01,-9298.29 4215.03,-9304.02"/>
</g>
<!-- l1_attn_stage14_gpu15&#45;&gt;l1_attn_stage15_gpu[next_gpu] -->
<g id="edge1472" class="edge">
<title>l1_attn_stage14_gpu15&#45;&gt;l1_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4320.56,-9378.58C4336.88,-9372.06 4354.81,-9366.02 4372,-9362.5 4396.12,-9357.56 4797.79,-9370.1 4815,-9352.5 4864.67,-9301.7 4777.33,-9279.39 4687.57,-9269.6"/>
<polygon fill="red" stroke="red" points="4687.78,-9266.11 4677.47,-9268.56 4687.05,-9273.07 4687.78,-9266.11"/>
<text text-anchor="middle" x="4854.5" y="-9341.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l1_attn_out_gpu0 -->
<g id="node289" class="node">
<title>l1_attn_out_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1161" cy="-9138.41" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1161" y="-9157.21" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="1161" y="-9142.21" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1161" y="-9127.21" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1161" y="-9112.21" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu0&#45;&gt;l1_attn_out_gpu0 -->
<g id="edge257" class="edge">
<title>l1_attn_stage15_gpu0&#45;&gt;l1_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M1147.05,-9223.49C1148.47,-9214.94 1150.02,-9205.63 1151.55,-9196.42"/>
<polygon fill="black" stroke="black" points="1155.01,-9196.94 1153.19,-9186.5 1148.1,-9195.8 1155.01,-9196.94"/>
</g>
<!-- l1_attn_out_gpu1 -->
<g id="node290" class="node">
<title>l1_attn_out_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1349" cy="-9138.41" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1349" y="-9157.21" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="1349" y="-9142.21" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1349" y="-9127.21" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1349" y="-9112.21" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu1&#45;&gt;l1_attn_out_gpu1 -->
<g id="edge258" class="edge">
<title>l1_attn_stage15_gpu1&#45;&gt;l1_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M1349,-9223.49C1349,-9215.03 1349,-9205.83 1349,-9196.71"/>
<polygon fill="black" stroke="black" points="1352.5,-9196.5 1349,-9186.5 1345.5,-9196.5 1352.5,-9196.5"/>
</g>
<!-- l1_attn_out_gpu2 -->
<g id="node291" class="node">
<title>l1_attn_out_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1565" cy="-9138.41" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1565" y="-9157.21" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="1565" y="-9142.21" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1565" y="-9127.21" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1565" y="-9112.21" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu2&#45;&gt;l1_attn_out_gpu2 -->
<g id="edge259" class="edge">
<title>l1_attn_stage15_gpu2&#45;&gt;l1_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M1559.42,-9223.49C1559.98,-9215.03 1560.59,-9205.83 1561.2,-9196.71"/>
<polygon fill="black" stroke="black" points="1564.71,-9196.71 1561.88,-9186.5 1557.72,-9196.25 1564.71,-9196.71"/>
</g>
<!-- l1_attn_out_gpu3 -->
<g id="node292" class="node">
<title>l1_attn_out_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1780" cy="-9138.41" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1780" y="-9157.21" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="1780" y="-9142.21" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1780" y="-9127.21" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1780" y="-9112.21" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu3&#45;&gt;l1_attn_out_gpu3 -->
<g id="edge260" class="edge">
<title>l1_attn_stage15_gpu3&#45;&gt;l1_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M1769.54,-9223.49C1770.59,-9215.03 1771.74,-9205.83 1772.87,-9196.71"/>
<polygon fill="black" stroke="black" points="1776.38,-9196.86 1774.14,-9186.5 1769.43,-9196 1776.38,-9196.86"/>
</g>
<!-- l1_attn_out_gpu4 -->
<g id="node293" class="node">
<title>l1_attn_out_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1977" cy="-9138.41" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1977" y="-9157.21" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="1977" y="-9142.21" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1977" y="-9127.21" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1977" y="-9112.21" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu4&#45;&gt;l1_attn_out_gpu4 -->
<g id="edge261" class="edge">
<title>l1_attn_stage15_gpu4&#45;&gt;l1_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M1974.21,-9223.49C1974.49,-9215.03 1974.8,-9205.83 1975.1,-9196.71"/>
<polygon fill="black" stroke="black" points="1978.6,-9196.62 1975.44,-9186.5 1971.61,-9196.38 1978.6,-9196.62"/>
</g>
<!-- l1_attn_out_gpu5 -->
<g id="node294" class="node">
<title>l1_attn_out_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2183" cy="-9138.41" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2183" y="-9157.21" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="2183" y="-9142.21" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2183" y="-9127.21" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2183" y="-9112.21" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu5&#45;&gt;l1_attn_out_gpu5 -->
<g id="edge262" class="edge">
<title>l1_attn_stage15_gpu5&#45;&gt;l1_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M2181.61,-9223.49C2181.75,-9215.03 2181.9,-9205.83 2182.05,-9196.71"/>
<polygon fill="black" stroke="black" points="2185.55,-9196.56 2182.22,-9186.5 2178.55,-9196.45 2185.55,-9196.56"/>
</g>
<!-- l1_attn_out_gpu6 -->
<g id="node295" class="node">
<title>l1_attn_out_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2392" cy="-9138.41" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2392" y="-9157.21" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="2392" y="-9142.21" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2392" y="-9127.21" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2392" y="-9112.21" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu6&#45;&gt;l1_attn_out_gpu6 -->
<g id="edge263" class="edge">
<title>l1_attn_stage15_gpu6&#45;&gt;l1_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M2389.91,-9223.49C2390.12,-9215.03 2390.35,-9205.83 2390.57,-9196.71"/>
<polygon fill="black" stroke="black" points="2394.08,-9196.59 2390.83,-9186.5 2387.08,-9196.41 2394.08,-9196.59"/>
</g>
<!-- l1_attn_out_gpu7 -->
<g id="node296" class="node">
<title>l1_attn_out_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2597" cy="-9138.41" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2597" y="-9157.21" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="2597" y="-9142.21" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2597" y="-9127.21" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2597" y="-9112.21" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu7&#45;&gt;l1_attn_out_gpu7 -->
<g id="edge264" class="edge">
<title>l1_attn_stage15_gpu7&#45;&gt;l1_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M2597,-9223.49C2597,-9215.03 2597,-9205.83 2597,-9196.71"/>
<polygon fill="black" stroke="black" points="2600.5,-9196.5 2597,-9186.5 2593.5,-9196.5 2600.5,-9196.5"/>
</g>
<!-- l1_attn_out_gpu8 -->
<g id="node297" class="node">
<title>l1_attn_out_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2804" cy="-9138.41" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2804" y="-9157.21" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="2804" y="-9142.21" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2804" y="-9127.21" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2804" y="-9112.21" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu8&#45;&gt;l1_attn_out_gpu8 -->
<g id="edge265" class="edge">
<title>l1_attn_stage15_gpu8&#45;&gt;l1_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M2804.7,-9223.49C2804.63,-9215.03 2804.55,-9205.83 2804.48,-9196.71"/>
<polygon fill="black" stroke="black" points="2807.97,-9196.48 2804.39,-9186.5 2800.97,-9196.53 2807.97,-9196.48"/>
</g>
<!-- l1_attn_out_gpu9 -->
<g id="node298" class="node">
<title>l1_attn_out_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3010" cy="-9138.41" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3010" y="-9157.21" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="3010" y="-9142.21" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3010" y="-9127.21" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3010" y="-9112.21" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu9&#45;&gt;l1_attn_out_gpu9 -->
<g id="edge266" class="edge">
<title>l1_attn_stage15_gpu9&#45;&gt;l1_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M3012.09,-9223.49C3011.88,-9215.03 3011.65,-9205.83 3011.43,-9196.71"/>
<polygon fill="black" stroke="black" points="3014.92,-9196.41 3011.17,-9186.5 3007.92,-9196.59 3014.92,-9196.41"/>
</g>
<!-- l1_attn_out_gpu10 -->
<g id="node299" class="node">
<title>l1_attn_out_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3218" cy="-9138.41" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3218" y="-9157.21" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="3218" y="-9142.21" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3218" y="-9127.21" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3218" y="-9112.21" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu10&#45;&gt;l1_attn_out_gpu10 -->
<g id="edge267" class="edge">
<title>l1_attn_stage15_gpu10&#45;&gt;l1_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M3220.09,-9223.49C3219.88,-9215.03 3219.65,-9205.83 3219.43,-9196.71"/>
<polygon fill="black" stroke="black" points="3222.92,-9196.41 3219.17,-9186.5 3215.92,-9196.59 3222.92,-9196.41"/>
</g>
<!-- l1_attn_out_gpu11 -->
<g id="node300" class="node">
<title>l1_attn_out_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3425" cy="-9138.41" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3425" y="-9157.21" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="3425" y="-9142.21" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3425" y="-9127.21" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3425" y="-9112.21" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu11&#45;&gt;l1_attn_out_gpu11 -->
<g id="edge268" class="edge">
<title>l1_attn_stage15_gpu11&#45;&gt;l1_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M3427.79,-9223.49C3427.51,-9215.03 3427.2,-9205.83 3426.9,-9196.71"/>
<polygon fill="black" stroke="black" points="3430.39,-9196.38 3426.56,-9186.5 3423.4,-9196.62 3430.39,-9196.38"/>
</g>
<!-- l1_attn_out_gpu12 -->
<g id="node301" class="node">
<title>l1_attn_out_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3632" cy="-9138.41" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3632" y="-9157.21" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="3632" y="-9142.21" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3632" y="-9127.21" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3632" y="-9112.21" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu12&#45;&gt;l1_attn_out_gpu12 -->
<g id="edge269" class="edge">
<title>l1_attn_stage15_gpu12&#45;&gt;l1_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M3635.49,-9223.49C3635.14,-9215.03 3634.75,-9205.83 3634.38,-9196.71"/>
<polygon fill="black" stroke="black" points="3637.86,-9196.35 3633.95,-9186.5 3630.87,-9196.64 3637.86,-9196.35"/>
</g>
<!-- l1_attn_out_gpu13 -->
<g id="node302" class="node">
<title>l1_attn_out_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3842" cy="-9138.41" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3842" y="-9157.21" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="3842" y="-9142.21" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3842" y="-9127.21" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3842" y="-9112.21" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu13&#45;&gt;l1_attn_out_gpu13 -->
<g id="edge270" class="edge">
<title>l1_attn_stage15_gpu13&#45;&gt;l1_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M3844.09,-9223.49C3843.88,-9215.03 3843.65,-9205.83 3843.43,-9196.71"/>
<polygon fill="black" stroke="black" points="3846.92,-9196.41 3843.17,-9186.5 3839.92,-9196.59 3846.92,-9196.41"/>
</g>
<!-- l1_attn_out_gpu14 -->
<g id="node303" class="node">
<title>l1_attn_out_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4053" cy="-9138.41" rx="75" ry="48.17"/>
<text text-anchor="middle" x="4053" y="-9157.21" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="4053" y="-9142.21" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4053" y="-9127.21" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="4053" y="-9112.21" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu14&#45;&gt;l1_attn_out_gpu14 -->
<g id="edge271" class="edge">
<title>l1_attn_stage15_gpu14&#45;&gt;l1_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M4053,-9223.49C4053,-9215.03 4053,-9205.83 4053,-9196.71"/>
<polygon fill="black" stroke="black" points="4056.5,-9196.5 4053,-9186.5 4049.5,-9196.5 4056.5,-9196.5"/>
</g>
<!-- l1_attn_out_gpu15 -->
<g id="node304" class="node">
<title>l1_attn_out_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4241" cy="-9138.41" rx="75" ry="48.17"/>
<text text-anchor="middle" x="4241" y="-9157.21" font-family="Times,serif" font-size="14.00">L1 Attn Out</text>
<text text-anchor="middle" x="4241" y="-9142.21" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4241" y="-9127.21" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="4241" y="-9112.21" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l1_attn_stage15_gpu15&#45;&gt;l1_attn_out_gpu15 -->
<g id="edge272" class="edge">
<title>l1_attn_stage15_gpu15&#45;&gt;l1_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M4254.95,-9223.49C4253.53,-9214.94 4251.98,-9205.63 4250.45,-9196.42"/>
<polygon fill="black" stroke="black" points="4253.9,-9195.8 4248.81,-9186.5 4246.99,-9196.94 4253.9,-9195.8"/>
</g>
<!-- l1_qkv_gpu0&#45;&gt;l1_attn_stage0_gpu0 -->
<g id="edge1" class="edge">
<title>l1_qkv_gpu0&#45;&gt;l1_attn_stage0_gpu0</title>
<path fill="none" stroke="black" d="M1210.25,-11569.14C1236.16,-11549.21 1267.47,-11525.12 1293.17,-11505.34"/>
<polygon fill="black" stroke="black" points="1295.52,-11507.95 1301.31,-11499.08 1291.25,-11502.4 1295.52,-11507.95"/>
</g>
<!-- l1_qkv_gpu1&#45;&gt;l1_attn_stage0_gpu1 -->
<g id="edge2" class="edge">
<title>l1_qkv_gpu1&#45;&gt;l1_attn_stage0_gpu1</title>
<path fill="none" stroke="black" d="M1442.8,-11566.1C1460.33,-11547.86 1480.74,-11526.61 1498.16,-11508.47"/>
<polygon fill="black" stroke="black" points="1501.02,-11510.55 1505.42,-11500.91 1495.97,-11505.7 1501.02,-11510.55"/>
</g>
<!-- l1_qkv_gpu2&#45;&gt;l1_attn_stage0_gpu2 -->
<g id="edge3" class="edge">
<title>l1_qkv_gpu2&#45;&gt;l1_attn_stage0_gpu2</title>
<path fill="none" stroke="black" d="M1646.88,-11565.33C1662.44,-11547.56 1680.41,-11527.05 1695.89,-11509.37"/>
<polygon fill="black" stroke="black" points="1698.86,-11511.29 1702.81,-11501.46 1693.59,-11506.68 1698.86,-11511.29"/>
</g>
<!-- l1_qkv_gpu3&#45;&gt;l1_attn_stage0_gpu3 -->
<g id="edge4" class="edge">
<title>l1_qkv_gpu3&#45;&gt;l1_attn_stage0_gpu3</title>
<path fill="none" stroke="black" d="M1862.38,-11563.78C1873.79,-11546.95 1886.75,-11527.84 1898.12,-11511.07"/>
<polygon fill="black" stroke="black" points="1901.18,-11512.78 1903.9,-11502.54 1895.39,-11508.86 1901.18,-11512.78"/>
</g>
<!-- l1_qkv_gpu4&#45;&gt;l1_attn_stage0_gpu4 -->
<g id="edge5" class="edge">
<title>l1_qkv_gpu4&#45;&gt;l1_attn_stage0_gpu4</title>
<path fill="none" stroke="black" d="M2069.43,-11563C2078.64,-11546.5 2089.02,-11527.89 2098.18,-11511.48"/>
<polygon fill="black" stroke="black" points="2101.31,-11513.05 2103.13,-11502.61 2095.2,-11509.64 2101.31,-11513.05"/>
</g>
<!-- l1_qkv_gpu5&#45;&gt;l1_attn_stage0_gpu5 -->
<g id="edge6" class="edge">
<title>l1_qkv_gpu5&#45;&gt;l1_attn_stage0_gpu5</title>
<path fill="none" stroke="black" d="M2269.86,-11563C2277.99,-11546.79 2287.14,-11528.54 2295.26,-11512.34"/>
<polygon fill="black" stroke="black" points="2298.56,-11513.58 2299.91,-11503.07 2292.3,-11510.44 2298.56,-11513.58"/>
</g>
<!-- l1_qkv_gpu6&#45;&gt;l1_attn_stage0_gpu6 -->
<g id="edge7" class="edge">
<title>l1_qkv_gpu6&#45;&gt;l1_attn_stage0_gpu6</title>
<path fill="none" stroke="black" d="M2470.45,-11562.61C2477.6,-11546.55 2485.62,-11528.53 2492.75,-11512.5"/>
<polygon fill="black" stroke="black" points="2495.97,-11513.89 2496.83,-11503.33 2489.57,-11511.04 2495.97,-11513.89"/>
</g>
<!-- l1_qkv_gpu7&#45;&gt;l1_attn_stage0_gpu7 -->
<g id="edge8" class="edge">
<title>l1_qkv_gpu7&#45;&gt;l1_attn_stage0_gpu7</title>
<path fill="none" stroke="black" d="M2672.35,-11562.22C2678.3,-11546.33 2684.96,-11528.56 2690.89,-11512.71"/>
<polygon fill="black" stroke="black" points="2694.25,-11513.72 2694.47,-11503.13 2687.69,-11511.27 2694.25,-11513.72"/>
</g>
<!-- l1_qkv_gpu8&#45;&gt;l1_attn_stage0_gpu8 -->
<g id="edge9" class="edge">
<title>l1_qkv_gpu8&#45;&gt;l1_attn_stage0_gpu8</title>
<path fill="none" stroke="black" d="M2872.86,-11561.83C2877.82,-11546.24 2883.33,-11528.88 2888.28,-11513.32"/>
<polygon fill="black" stroke="black" points="2891.74,-11513.98 2891.43,-11503.39 2885.07,-11511.86 2891.74,-11513.98"/>
</g>
<!-- l1_qkv_gpu9&#45;&gt;l1_attn_stage0_gpu9 -->
<g id="edge10" class="edge">
<title>l1_qkv_gpu9&#45;&gt;l1_attn_stage0_gpu9</title>
<path fill="none" stroke="black" d="M3072.55,-11561.83C3076.73,-11546.24 3081.39,-11528.88 3085.57,-11513.32"/>
<polygon fill="black" stroke="black" points="3089.02,-11513.95 3088.23,-11503.39 3082.26,-11512.14 3089.02,-11513.95"/>
</g>
<!-- l1_qkv_gpu10&#45;&gt;l1_attn_stage0_gpu10 -->
<g id="edge11" class="edge">
<title>l1_qkv_gpu10&#45;&gt;l1_attn_stage0_gpu10</title>
<path fill="none" stroke="black" d="M3272.32,-11561.44C3275.7,-11545.99 3279.46,-11528.86 3282.83,-11513.47"/>
<polygon fill="black" stroke="black" points="3286.26,-11514.16 3284.98,-11503.64 3279.42,-11512.66 3286.26,-11514.16"/>
</g>
<!-- l1_qkv_gpu11&#45;&gt;l1_attn_stage0_gpu11 -->
<g id="edge12" class="edge">
<title>l1_qkv_gpu11&#45;&gt;l1_attn_stage0_gpu11</title>
<path fill="none" stroke="black" d="M3471.99,-11561.44C3474.58,-11546.14 3477.46,-11529.18 3480.05,-11513.91"/>
<polygon fill="black" stroke="black" points="3483.57,-11514.08 3481.79,-11503.64 3476.67,-11512.91 3483.57,-11514.08"/>
</g>
<!-- l1_qkv_gpu12&#45;&gt;l1_attn_stage0_gpu12 -->
<g id="edge13" class="edge">
<title>l1_qkv_gpu12&#45;&gt;l1_attn_stage0_gpu12</title>
<path fill="none" stroke="black" d="M3671.66,-11561.44C3673.5,-11546.14 3675.53,-11529.18 3677.37,-11513.91"/>
<polygon fill="black" stroke="black" points="3680.88,-11513.99 3678.6,-11503.64 3673.93,-11513.15 3680.88,-11513.99"/>
</g>
<!-- l1_qkv_gpu13&#45;&gt;l1_attn_stage0_gpu13 -->
<g id="edge14" class="edge">
<title>l1_qkv_gpu13&#45;&gt;l1_attn_stage0_gpu13</title>
<path fill="none" stroke="black" d="M3871.33,-11561.44C3872.41,-11546.14 3873.61,-11529.18 3874.69,-11513.91"/>
<polygon fill="black" stroke="black" points="3878.2,-11513.86 3875.41,-11503.64 3871.22,-11513.37 3878.2,-11513.86"/>
</g>
<!-- l1_qkv_gpu14&#45;&gt;l1_attn_stage0_gpu14 -->
<g id="edge15" class="edge">
<title>l1_qkv_gpu14&#45;&gt;l1_attn_stage0_gpu14</title>
<path fill="none" stroke="black" d="M4071,-11561.44C4071.32,-11546.14 4071.68,-11529.18 4072.01,-11513.91"/>
<polygon fill="black" stroke="black" points="4075.51,-11513.71 4072.22,-11503.64 4068.51,-11513.56 4075.51,-11513.71"/>
</g>
<!-- l1_qkv_gpu15&#45;&gt;l1_attn_stage0_gpu15 -->
<g id="edge16" class="edge">
<title>l1_qkv_gpu15&#45;&gt;l1_attn_stage0_gpu15</title>
<path fill="none" stroke="black" d="M4270.67,-11561.44C4270.24,-11546.14 4269.76,-11529.18 4269.33,-11513.91"/>
<polygon fill="black" stroke="black" points="4272.82,-11513.54 4269.04,-11503.64 4265.82,-11513.74 4272.82,-11513.54"/>
</g>
<!-- l1_mlp_h2_4h_gpu0 -->
<g id="node305" class="node">
<title>l1_mlp_h2_4h_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1161" cy="-9005.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1161" y="-9024.05" font-family="Times,serif" font-size="14.00">L1 MLP h24h</text>
<text text-anchor="middle" x="1161" y="-9009.05" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1161" y="-8994.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1161" y="-8979.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l1_attn_out_gpu0&#45;&gt;l1_mlp_h2_4h_gpu0 -->
<g id="edge273" class="edge">
<title>l1_attn_out_gpu0&#45;&gt;l1_mlp_h2_4h_gpu0</title>
<path fill="none" stroke="black" d="M1161,-9090.06C1161,-9081.52 1161,-9072.52 1161,-9063.73"/>
<polygon fill="black" stroke="black" points="1164.5,-9063.53 1161,-9053.53 1157.5,-9063.53 1164.5,-9063.53"/>
</g>
<!-- l1_mlp_h2_4h_gpu1 -->
<g id="node306" class="node">
<title>l1_mlp_h2_4h_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1379" cy="-9005.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1379" y="-9024.05" font-family="Times,serif" font-size="14.00">L1 MLP h24h</text>
<text text-anchor="middle" x="1379" y="-9009.05" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1379" y="-8994.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1379" y="-8979.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l1_attn_out_gpu1&#45;&gt;l1_mlp_h2_4h_gpu1 -->
<g id="edge274" class="edge">
<title>l1_attn_out_gpu1&#45;&gt;l1_mlp_h2_4h_gpu1</title>
<path fill="none" stroke="black" d="M1359.66,-9090.8C1361.71,-9081.82 1363.89,-9072.33 1366,-9063.07"/>
<polygon fill="black" stroke="black" points="1369.45,-9063.68 1368.27,-9053.15 1362.63,-9062.12 1369.45,-9063.68"/>
</g>
<!-- l1_mlp_h2_4h_gpu2 -->
<g id="node307" class="node">
<title>l1_mlp_h2_4h_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1582" cy="-9005.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1582" y="-9024.05" font-family="Times,serif" font-size="14.00">L1 MLP h24h</text>
<text text-anchor="middle" x="1582" y="-9009.05" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1582" y="-8994.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1582" y="-8979.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l1_attn_out_gpu2&#45;&gt;l1_mlp_h2_4h_gpu2 -->
<g id="edge275" class="edge">
<title>l1_attn_out_gpu2&#45;&gt;l1_mlp_h2_4h_gpu2</title>
<path fill="none" stroke="black" d="M1571.09,-9090.43C1572.22,-9081.67 1573.42,-9072.43 1574.59,-9063.4"/>
<polygon fill="black" stroke="black" points="1578.08,-9063.71 1575.9,-9053.34 1571.14,-9062.81 1578.08,-9063.71"/>
</g>
<!-- l1_mlp_h2_4h_gpu3 -->
<g id="node308" class="node">
<title>l1_mlp_h2_4h_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1784" cy="-9005.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1784" y="-9024.05" font-family="Times,serif" font-size="14.00">L1 MLP h24h</text>
<text text-anchor="middle" x="1784" y="-9009.05" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1784" y="-8994.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1784" y="-8979.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l1_attn_out_gpu3&#45;&gt;l1_mlp_h2_4h_gpu3 -->
<g id="edge276" class="edge">
<title>l1_attn_out_gpu3&#45;&gt;l1_mlp_h2_4h_gpu3</title>
<path fill="none" stroke="black" d="M1781.44,-9090.06C1781.7,-9081.52 1781.98,-9072.52 1782.25,-9063.73"/>
<polygon fill="black" stroke="black" points="1785.75,-9063.63 1782.56,-9053.53 1778.75,-9063.42 1785.75,-9063.63"/>
</g>
<!-- l1_mlp_h2_4h_gpu4 -->
<g id="node309" class="node">
<title>l1_mlp_h2_4h_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1987" cy="-9005.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1987" y="-9024.05" font-family="Times,serif" font-size="14.00">L1 MLP h24h</text>
<text text-anchor="middle" x="1987" y="-9009.05" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1987" y="-8994.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1987" y="-8979.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l1_attn_out_gpu4&#45;&gt;l1_mlp_h2_4h_gpu4 -->
<g id="edge277" class="edge">
<title>l1_attn_out_gpu4&#45;&gt;l1_mlp_h2_4h_gpu4</title>
<path fill="none" stroke="black" d="M1980.61,-9090.06C1981.26,-9081.52 1981.95,-9072.52 1982.62,-9063.73"/>
<polygon fill="black" stroke="black" points="1986.12,-9063.77 1983.4,-9053.53 1979.14,-9063.24 1986.12,-9063.77"/>
</g>
<!-- l1_mlp_h2_4h_gpu5 -->
<g id="node310" class="node">
<title>l1_mlp_h2_4h_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2189" cy="-9005.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2189" y="-9024.05" font-family="Times,serif" font-size="14.00">L1 MLP h24h</text>
<text text-anchor="middle" x="2189" y="-9009.05" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2189" y="-8994.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2189" y="-8979.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l1_attn_out_gpu5&#45;&gt;l1_mlp_h2_4h_gpu5 -->
<g id="edge278" class="edge">
<title>l1_attn_out_gpu5&#45;&gt;l1_mlp_h2_4h_gpu5</title>
<path fill="none" stroke="black" d="M2185.17,-9090.06C2185.56,-9081.52 2185.97,-9072.52 2186.37,-9063.73"/>
<polygon fill="black" stroke="black" points="2189.88,-9063.68 2186.84,-9053.53 2182.88,-9063.36 2189.88,-9063.68"/>
</g>
<!-- l1_mlp_h2_4h_gpu6 -->
<g id="node311" class="node">
<title>l1_mlp_h2_4h_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2396" cy="-9005.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2396" y="-9024.05" font-family="Times,serif" font-size="14.00">L1 MLP h24h</text>
<text text-anchor="middle" x="2396" y="-9009.05" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2396" y="-8994.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2396" y="-8979.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l1_attn_out_gpu6&#45;&gt;l1_mlp_h2_4h_gpu6 -->
<g id="edge279" class="edge">
<title>l1_attn_out_gpu6&#45;&gt;l1_mlp_h2_4h_gpu6</title>
<path fill="none" stroke="black" d="M2393.44,-9090.06C2393.7,-9081.52 2393.98,-9072.52 2394.25,-9063.73"/>
<polygon fill="black" stroke="black" points="2397.75,-9063.63 2394.56,-9053.53 2390.75,-9063.42 2397.75,-9063.63"/>
</g>
<!-- l1_mlp_h2_4h_gpu7 -->
<g id="node312" class="node">
<title>l1_mlp_h2_4h_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2598" cy="-9005.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2598" y="-9024.05" font-family="Times,serif" font-size="14.00">L1 MLP h24h</text>
<text text-anchor="middle" x="2598" y="-9009.05" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2598" y="-8994.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2598" y="-8979.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l1_attn_out_gpu7&#45;&gt;l1_mlp_h2_4h_gpu7 -->
<g id="edge280" class="edge">
<title>l1_attn_out_gpu7&#45;&gt;l1_mlp_h2_4h_gpu7</title>
<path fill="none" stroke="black" d="M2597.36,-9090.06C2597.43,-9081.52 2597.49,-9072.52 2597.56,-9063.73"/>
<polygon fill="black" stroke="black" points="2601.06,-9063.56 2597.64,-9053.53 2594.06,-9063.51 2601.06,-9063.56"/>
</g>
<!-- l1_mlp_h2_4h_gpu8 -->
<g id="node313" class="node">
<title>l1_mlp_h2_4h_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2801" cy="-9005.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2801" y="-9024.05" font-family="Times,serif" font-size="14.00">L1 MLP h24h</text>
<text text-anchor="middle" x="2801" y="-9009.05" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2801" y="-8994.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2801" y="-8979.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l1_attn_out_gpu8&#45;&gt;l1_mlp_h2_4h_gpu8 -->
<g id="edge281" class="edge">
<title>l1_attn_out_gpu8&#45;&gt;l1_mlp_h2_4h_gpu8</title>
<path fill="none" stroke="black" d="M2802.92,-9090.06C2802.72,-9081.52 2802.52,-9072.52 2802.31,-9063.73"/>
<polygon fill="black" stroke="black" points="2805.81,-9063.45 2802.08,-9053.53 2798.81,-9063.61 2805.81,-9063.45"/>
</g>
<!-- l1_mlp_h2_4h_gpu9 -->
<g id="node314" class="node">
<title>l1_mlp_h2_4h_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3006" cy="-9005.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3006" y="-9024.05" font-family="Times,serif" font-size="14.00">L1 MLP h24h</text>
<text text-anchor="middle" x="3006" y="-9009.05" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3006" y="-8994.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3006" y="-8979.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l1_attn_out_gpu9&#45;&gt;l1_mlp_h2_4h_gpu9 -->
<g id="edge282" class="edge">
<title>l1_attn_out_gpu9&#45;&gt;l1_mlp_h2_4h_gpu9</title>
<path fill="none" stroke="black" d="M3008.56,-9090.06C3008.3,-9081.52 3008.02,-9072.52 3007.75,-9063.73"/>
<polygon fill="black" stroke="black" points="3011.25,-9063.42 3007.44,-9053.53 3004.25,-9063.63 3011.25,-9063.42"/>
</g>
<!-- l1_mlp_h2_4h_gpu10 -->
<g id="node315" class="node">
<title>l1_mlp_h2_4h_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3211" cy="-9005.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3211" y="-9024.05" font-family="Times,serif" font-size="14.00">L1 MLP h24h</text>
<text text-anchor="middle" x="3211" y="-9009.05" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3211" y="-8994.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3211" y="-8979.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l1_attn_out_gpu10&#45;&gt;l1_mlp_h2_4h_gpu10 -->
<g id="edge283" class="edge">
<title>l1_attn_out_gpu10&#45;&gt;l1_mlp_h2_4h_gpu10</title>
<path fill="none" stroke="black" d="M3215.47,-9090.06C3215.02,-9081.52 3214.54,-9072.52 3214.07,-9063.73"/>
<polygon fill="black" stroke="black" points="3217.55,-9063.33 3213.52,-9053.53 3210.56,-9063.71 3217.55,-9063.33"/>
</g>
<!-- l1_mlp_h2_4h_gpu11 -->
<g id="node316" class="node">
<title>l1_mlp_h2_4h_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3414" cy="-9005.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3414" y="-9024.05" font-family="Times,serif" font-size="14.00">L1 MLP h24h</text>
<text text-anchor="middle" x="3414" y="-9009.05" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3414" y="-8994.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3414" y="-8979.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l1_attn_out_gpu11&#45;&gt;l1_mlp_h2_4h_gpu11 -->
<g id="edge284" class="edge">
<title>l1_attn_out_gpu11&#45;&gt;l1_mlp_h2_4h_gpu11</title>
<path fill="none" stroke="black" d="M3421.03,-9090.06C3420.31,-9081.52 3419.56,-9072.52 3418.82,-9063.73"/>
<polygon fill="black" stroke="black" points="3422.29,-9063.21 3417.97,-9053.53 3415.31,-9063.79 3422.29,-9063.21"/>
</g>
<!-- l1_mlp_h2_4h_gpu12 -->
<g id="node317" class="node">
<title>l1_mlp_h2_4h_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3617" cy="-9005.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3617" y="-9024.05" font-family="Times,serif" font-size="14.00">L1 MLP h24h</text>
<text text-anchor="middle" x="3617" y="-9009.05" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3617" y="-8994.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3617" y="-8979.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l1_attn_out_gpu12&#45;&gt;l1_mlp_h2_4h_gpu12 -->
<g id="edge285" class="edge">
<title>l1_attn_out_gpu12&#45;&gt;l1_mlp_h2_4h_gpu12</title>
<path fill="none" stroke="black" d="M3626.63,-9090.43C3625.63,-9081.67 3624.57,-9072.43 3623.54,-9063.4"/>
<polygon fill="black" stroke="black" points="3627,-9062.88 3622.39,-9053.34 3620.04,-9063.68 3627,-9062.88"/>
</g>
<!-- l1_mlp_h2_4h_gpu13 -->
<g id="node318" class="node">
<title>l1_mlp_h2_4h_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3826" cy="-9005.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3826" y="-9024.05" font-family="Times,serif" font-size="14.00">L1 MLP h24h</text>
<text text-anchor="middle" x="3826" y="-9009.05" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3826" y="-8994.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3826" y="-8979.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l1_attn_out_gpu13&#45;&gt;l1_mlp_h2_4h_gpu13 -->
<g id="edge286" class="edge">
<title>l1_attn_out_gpu13&#45;&gt;l1_mlp_h2_4h_gpu13</title>
<path fill="none" stroke="black" d="M3836.27,-9090.43C3835.2,-9081.67 3834.07,-9072.43 3832.97,-9063.4"/>
<polygon fill="black" stroke="black" points="3836.43,-9062.85 3831.74,-9053.34 3829.48,-9063.69 3836.43,-9062.85"/>
</g>
<!-- l1_mlp_h2_4h_gpu14 -->
<g id="node319" class="node">
<title>l1_mlp_h2_4h_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4033" cy="-9005.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="4033" y="-9024.05" font-family="Times,serif" font-size="14.00">L1 MLP h24h</text>
<text text-anchor="middle" x="4033" y="-9009.05" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4033" y="-8994.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="4033" y="-8979.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l1_attn_out_gpu14&#45;&gt;l1_mlp_h2_4h_gpu14 -->
<g id="edge287" class="edge">
<title>l1_attn_out_gpu14&#45;&gt;l1_mlp_h2_4h_gpu14</title>
<path fill="none" stroke="black" d="M4045.84,-9090.43C4044.5,-9081.67 4043.09,-9072.43 4041.72,-9063.4"/>
<polygon fill="black" stroke="black" points="4045.15,-9062.7 4040.18,-9053.34 4038.23,-9063.76 4045.15,-9062.7"/>
</g>
<!-- l1_mlp_h2_4h_gpu15 -->
<g id="node320" class="node">
<title>l1_mlp_h2_4h_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4239" cy="-9005.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="4239" y="-9024.05" font-family="Times,serif" font-size="14.00">L1 MLP h24h</text>
<text text-anchor="middle" x="4239" y="-9009.05" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4239" y="-8994.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="4239" y="-8979.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l1_attn_out_gpu15&#45;&gt;l1_mlp_h2_4h_gpu15 -->
<g id="edge288" class="edge">
<title>l1_attn_out_gpu15&#45;&gt;l1_mlp_h2_4h_gpu15</title>
<path fill="none" stroke="black" d="M4240.28,-9090.06C4240.15,-9081.52 4240.01,-9072.52 4239.88,-9063.73"/>
<polygon fill="black" stroke="black" points="4243.37,-9063.48 4239.72,-9053.53 4236.37,-9063.58 4243.37,-9063.48"/>
</g>
<!-- l1_mlp_4h2_h_gpu0 -->
<g id="node321" class="node">
<title>l1_mlp_4h2_h_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1172" cy="-8872.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1172" y="-8890.88" font-family="Times,serif" font-size="14.00">L1 MLP 4h2h</text>
<text text-anchor="middle" x="1172" y="-8875.88" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1172" y="-8860.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1172" y="-8845.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l1_mlp_h2_4h_gpu0&#45;&gt;l1_mlp_4h2_h_gpu0 -->
<g id="edge289" class="edge">
<title>l1_mlp_h2_4h_gpu0&#45;&gt;l1_mlp_4h2_h_gpu0</title>
<path fill="none" stroke="black" d="M1164.97,-8956.89C1165.69,-8948.35 1166.44,-8939.36 1167.18,-8930.56"/>
<polygon fill="black" stroke="black" points="1170.69,-8930.62 1168.03,-8920.37 1163.71,-8930.04 1170.69,-8930.62"/>
</g>
<!-- l1_mlp_4h2_h_gpu1 -->
<g id="node322" class="node">
<title>l1_mlp_4h2_h_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1381" cy="-8872.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1381" y="-8890.88" font-family="Times,serif" font-size="14.00">L1 MLP 4h2h</text>
<text text-anchor="middle" x="1381" y="-8875.88" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1381" y="-8860.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1381" y="-8845.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l1_mlp_h2_4h_gpu1&#45;&gt;l1_mlp_4h2_h_gpu1 -->
<g id="edge290" class="edge">
<title>l1_mlp_h2_4h_gpu1&#45;&gt;l1_mlp_4h2_h_gpu1</title>
<path fill="none" stroke="black" d="M1379.72,-8956.89C1379.85,-8948.35 1379.99,-8939.36 1380.12,-8930.56"/>
<polygon fill="black" stroke="black" points="1383.63,-8930.42 1380.28,-8920.37 1376.63,-8930.31 1383.63,-8930.42"/>
</g>
<!-- l1_mlp_4h2_h_gpu2 -->
<g id="node323" class="node">
<title>l1_mlp_4h2_h_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1583" cy="-8872.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1583" y="-8890.88" font-family="Times,serif" font-size="14.00">L1 MLP 4h2h</text>
<text text-anchor="middle" x="1583" y="-8875.88" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1583" y="-8860.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1583" y="-8845.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l1_mlp_h2_4h_gpu2&#45;&gt;l1_mlp_4h2_h_gpu2 -->
<g id="edge291" class="edge">
<title>l1_mlp_h2_4h_gpu2&#45;&gt;l1_mlp_4h2_h_gpu2</title>
<path fill="none" stroke="black" d="M1582.36,-8956.89C1582.43,-8948.35 1582.49,-8939.36 1582.56,-8930.56"/>
<polygon fill="black" stroke="black" points="1586.06,-8930.39 1582.64,-8920.37 1579.06,-8930.34 1586.06,-8930.39"/>
</g>
<!-- l1_mlp_4h2_h_gpu3 -->
<g id="node324" class="node">
<title>l1_mlp_4h2_h_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1786" cy="-8872.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1786" y="-8890.88" font-family="Times,serif" font-size="14.00">L1 MLP 4h2h</text>
<text text-anchor="middle" x="1786" y="-8875.88" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1786" y="-8860.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1786" y="-8845.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l1_mlp_h2_4h_gpu3&#45;&gt;l1_mlp_4h2_h_gpu3 -->
<g id="edge292" class="edge">
<title>l1_mlp_h2_4h_gpu3&#45;&gt;l1_mlp_4h2_h_gpu3</title>
<path fill="none" stroke="black" d="M1784.72,-8956.89C1784.85,-8948.35 1784.99,-8939.36 1785.12,-8930.56"/>
<polygon fill="black" stroke="black" points="1788.63,-8930.42 1785.28,-8920.37 1781.63,-8930.31 1788.63,-8930.42"/>
</g>
<!-- l1_mlp_4h2_h_gpu4 -->
<g id="node325" class="node">
<title>l1_mlp_4h2_h_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1990" cy="-8872.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1990" y="-8890.88" font-family="Times,serif" font-size="14.00">L1 MLP 4h2h</text>
<text text-anchor="middle" x="1990" y="-8875.88" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1990" y="-8860.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1990" y="-8845.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l1_mlp_h2_4h_gpu4&#45;&gt;l1_mlp_4h2_h_gpu4 -->
<g id="edge293" class="edge">
<title>l1_mlp_h2_4h_gpu4&#45;&gt;l1_mlp_4h2_h_gpu4</title>
<path fill="none" stroke="black" d="M1988.08,-8956.89C1988.28,-8948.35 1988.48,-8939.36 1988.69,-8930.56"/>
<polygon fill="black" stroke="black" points="1992.19,-8930.44 1988.92,-8920.37 1985.19,-8930.28 1992.19,-8930.44"/>
</g>
<!-- l1_mlp_4h2_h_gpu5 -->
<g id="node326" class="node">
<title>l1_mlp_4h2_h_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2191" cy="-8872.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2191" y="-8890.88" font-family="Times,serif" font-size="14.00">L1 MLP 4h2h</text>
<text text-anchor="middle" x="2191" y="-8875.88" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2191" y="-8860.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2191" y="-8845.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l1_mlp_h2_4h_gpu5&#45;&gt;l1_mlp_4h2_h_gpu5 -->
<g id="edge294" class="edge">
<title>l1_mlp_h2_4h_gpu5&#45;&gt;l1_mlp_4h2_h_gpu5</title>
<path fill="none" stroke="black" d="M2189.72,-8956.89C2189.85,-8948.35 2189.99,-8939.36 2190.12,-8930.56"/>
<polygon fill="black" stroke="black" points="2193.63,-8930.42 2190.28,-8920.37 2186.63,-8930.31 2193.63,-8930.42"/>
</g>
<!-- l1_mlp_4h2_h_gpu6 -->
<g id="node327" class="node">
<title>l1_mlp_4h2_h_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2396" cy="-8872.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2396" y="-8890.88" font-family="Times,serif" font-size="14.00">L1 MLP 4h2h</text>
<text text-anchor="middle" x="2396" y="-8875.88" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2396" y="-8860.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2396" y="-8845.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l1_mlp_h2_4h_gpu6&#45;&gt;l1_mlp_4h2_h_gpu6 -->
<g id="edge295" class="edge">
<title>l1_mlp_h2_4h_gpu6&#45;&gt;l1_mlp_4h2_h_gpu6</title>
<path fill="none" stroke="black" d="M2396,-8956.89C2396,-8948.35 2396,-8939.36 2396,-8930.56"/>
<polygon fill="black" stroke="black" points="2399.5,-8930.37 2396,-8920.37 2392.5,-8930.37 2399.5,-8930.37"/>
</g>
<!-- l1_mlp_4h2_h_gpu7 -->
<g id="node328" class="node">
<title>l1_mlp_4h2_h_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2598" cy="-8872.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2598" y="-8890.88" font-family="Times,serif" font-size="14.00">L1 MLP 4h2h</text>
<text text-anchor="middle" x="2598" y="-8875.88" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2598" y="-8860.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2598" y="-8845.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l1_mlp_h2_4h_gpu7&#45;&gt;l1_mlp_4h2_h_gpu7 -->
<g id="edge296" class="edge">
<title>l1_mlp_h2_4h_gpu7&#45;&gt;l1_mlp_4h2_h_gpu7</title>
<path fill="none" stroke="black" d="M2598,-8956.89C2598,-8948.35 2598,-8939.36 2598,-8930.56"/>
<polygon fill="black" stroke="black" points="2601.5,-8930.37 2598,-8920.37 2594.5,-8930.37 2601.5,-8930.37"/>
</g>
<!-- l1_mlp_4h2_h_gpu8 -->
<g id="node329" class="node">
<title>l1_mlp_4h2_h_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2801" cy="-8872.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2801" y="-8890.88" font-family="Times,serif" font-size="14.00">L1 MLP 4h2h</text>
<text text-anchor="middle" x="2801" y="-8875.88" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2801" y="-8860.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2801" y="-8845.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l1_mlp_h2_4h_gpu8&#45;&gt;l1_mlp_4h2_h_gpu8 -->
<g id="edge297" class="edge">
<title>l1_mlp_h2_4h_gpu8&#45;&gt;l1_mlp_4h2_h_gpu8</title>
<path fill="none" stroke="black" d="M2801,-8956.89C2801,-8948.35 2801,-8939.36 2801,-8930.56"/>
<polygon fill="black" stroke="black" points="2804.5,-8930.37 2801,-8920.37 2797.5,-8930.37 2804.5,-8930.37"/>
</g>
<!-- l1_mlp_4h2_h_gpu9 -->
<g id="node330" class="node">
<title>l1_mlp_4h2_h_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3004" cy="-8872.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3004" y="-8890.88" font-family="Times,serif" font-size="14.00">L1 MLP 4h2h</text>
<text text-anchor="middle" x="3004" y="-8875.88" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3004" y="-8860.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3004" y="-8845.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l1_mlp_h2_4h_gpu9&#45;&gt;l1_mlp_4h2_h_gpu9 -->
<g id="edge298" class="edge">
<title>l1_mlp_h2_4h_gpu9&#45;&gt;l1_mlp_4h2_h_gpu9</title>
<path fill="none" stroke="black" d="M3005.28,-8956.89C3005.15,-8948.35 3005.01,-8939.36 3004.88,-8930.56"/>
<polygon fill="black" stroke="black" points="3008.37,-8930.31 3004.72,-8920.37 3001.37,-8930.42 3008.37,-8930.31"/>
</g>
<!-- l1_mlp_4h2_h_gpu10 -->
<g id="node331" class="node">
<title>l1_mlp_4h2_h_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3209" cy="-8872.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3209" y="-8890.88" font-family="Times,serif" font-size="14.00">L1 MLP 4h2h</text>
<text text-anchor="middle" x="3209" y="-8875.88" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3209" y="-8860.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3209" y="-8845.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l1_mlp_h2_4h_gpu10&#45;&gt;l1_mlp_4h2_h_gpu10 -->
<g id="edge299" class="edge">
<title>l1_mlp_h2_4h_gpu10&#45;&gt;l1_mlp_4h2_h_gpu10</title>
<path fill="none" stroke="black" d="M3210.28,-8956.89C3210.15,-8948.35 3210.01,-8939.36 3209.88,-8930.56"/>
<polygon fill="black" stroke="black" points="3213.37,-8930.31 3209.72,-8920.37 3206.37,-8930.42 3213.37,-8930.31"/>
</g>
<!-- l1_mlp_4h2_h_gpu11 -->
<g id="node332" class="node">
<title>l1_mlp_4h2_h_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3411" cy="-8872.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3411" y="-8890.88" font-family="Times,serif" font-size="14.00">L1 MLP 4h2h</text>
<text text-anchor="middle" x="3411" y="-8875.88" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3411" y="-8860.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3411" y="-8845.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l1_mlp_h2_4h_gpu11&#45;&gt;l1_mlp_4h2_h_gpu11 -->
<g id="edge300" class="edge">
<title>l1_mlp_h2_4h_gpu11&#45;&gt;l1_mlp_4h2_h_gpu11</title>
<path fill="none" stroke="black" d="M3412.92,-8956.89C3412.72,-8948.35 3412.52,-8939.36 3412.31,-8930.56"/>
<polygon fill="black" stroke="black" points="3415.81,-8930.28 3412.08,-8920.37 3408.81,-8930.44 3415.81,-8930.28"/>
</g>
<!-- l1_mlp_4h2_h_gpu12 -->
<g id="node333" class="node">
<title>l1_mlp_4h2_h_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3616" cy="-8872.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3616" y="-8890.88" font-family="Times,serif" font-size="14.00">L1 MLP 4h2h</text>
<text text-anchor="middle" x="3616" y="-8875.88" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3616" y="-8860.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3616" y="-8845.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l1_mlp_h2_4h_gpu12&#45;&gt;l1_mlp_4h2_h_gpu12 -->
<g id="edge301" class="edge">
<title>l1_mlp_h2_4h_gpu12&#45;&gt;l1_mlp_4h2_h_gpu12</title>
<path fill="none" stroke="black" d="M3616.64,-8956.89C3616.57,-8948.35 3616.51,-8939.36 3616.44,-8930.56"/>
<polygon fill="black" stroke="black" points="3619.94,-8930.34 3616.36,-8920.37 3612.94,-8930.39 3619.94,-8930.34"/>
</g>
<!-- l1_mlp_4h2_h_gpu13 -->
<g id="node334" class="node">
<title>l1_mlp_4h2_h_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3812" cy="-8872.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3812" y="-8890.88" font-family="Times,serif" font-size="14.00">L1 MLP 4h2h</text>
<text text-anchor="middle" x="3812" y="-8875.88" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3812" y="-8860.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3812" y="-8845.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l1_mlp_h2_4h_gpu13&#45;&gt;l1_mlp_4h2_h_gpu13 -->
<g id="edge302" class="edge">
<title>l1_mlp_h2_4h_gpu13&#45;&gt;l1_mlp_4h2_h_gpu13</title>
<path fill="none" stroke="black" d="M3820.95,-8956.89C3820.03,-8948.35 3819.07,-8939.36 3818.14,-8930.56"/>
<polygon fill="black" stroke="black" points="3821.59,-8929.94 3817.05,-8920.37 3814.63,-8930.68 3821.59,-8929.94"/>
</g>
<!-- l1_mlp_4h2_h_gpu14 -->
<g id="node335" class="node">
<title>l1_mlp_4h2_h_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4026" cy="-8872.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="4026" y="-8890.88" font-family="Times,serif" font-size="14.00">L1 MLP 4h2h</text>
<text text-anchor="middle" x="4026" y="-8875.88" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4026" y="-8860.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="4026" y="-8845.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l1_mlp_h2_4h_gpu14&#45;&gt;l1_mlp_4h2_h_gpu14 -->
<g id="edge303" class="edge">
<title>l1_mlp_h2_4h_gpu14&#45;&gt;l1_mlp_4h2_h_gpu14</title>
<path fill="none" stroke="black" d="M4030.47,-8956.89C4030.02,-8948.35 4029.54,-8939.36 4029.07,-8930.56"/>
<polygon fill="black" stroke="black" points="4032.55,-8930.17 4028.52,-8920.37 4025.56,-8930.54 4032.55,-8930.17"/>
</g>
<!-- l1_mlp_4h2_h_gpu15 -->
<g id="node336" class="node">
<title>l1_mlp_4h2_h_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4224" cy="-8872.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="4224" y="-8890.88" font-family="Times,serif" font-size="14.00">L1 MLP 4h2h</text>
<text text-anchor="middle" x="4224" y="-8875.88" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4224" y="-8860.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="4224" y="-8845.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l1_mlp_h2_4h_gpu15&#45;&gt;l1_mlp_4h2_h_gpu15 -->
<g id="edge304" class="edge">
<title>l1_mlp_h2_4h_gpu15&#45;&gt;l1_mlp_4h2_h_gpu15</title>
<path fill="none" stroke="black" d="M4233.58,-8956.89C4232.61,-8948.35 4231.58,-8939.36 4230.57,-8930.56"/>
<polygon fill="black" stroke="black" points="4234.02,-8929.9 4229.41,-8920.37 4227.07,-8930.7 4234.02,-8929.9"/>
</g>
<!-- l2_qkv_gpu0 -->
<g id="node593" class="node">
<title>l2_qkv_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1179" cy="-8717.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1179" y="-8736.72" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="1179" y="-8721.72" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1179" y="-8706.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1179" y="-8691.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_mlp_4h2_h_gpu0&#45;&gt;l2_qkv_gpu0 -->
<g id="edge1473" class="edge">
<title>l1_mlp_4h2_h_gpu0&#45;&gt;l2_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1174.18,-8823.77C1174.87,-8808.74 1175.64,-8791.95 1176.36,-8776.3"/>
<polygon fill="black" stroke="black" points="1179.86,-8776.35 1176.82,-8766.2 1172.87,-8776.03 1179.86,-8776.35"/>
</g>
<!-- l2_qkv_gpu1 -->
<g id="node594" class="node">
<title>l2_qkv_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1384" cy="-8717.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1384" y="-8736.72" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="1384" y="-8721.72" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1384" y="-8706.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1384" y="-8691.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_mlp_4h2_h_gpu1&#45;&gt;l2_qkv_gpu1 -->
<g id="edge1474" class="edge">
<title>l1_mlp_4h2_h_gpu1&#45;&gt;l2_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1381.93,-8823.77C1382.23,-8808.74 1382.56,-8791.95 1382.87,-8776.3"/>
<polygon fill="black" stroke="black" points="1386.37,-8776.27 1383.07,-8766.2 1379.37,-8776.13 1386.37,-8776.27"/>
</g>
<!-- l2_qkv_gpu2 -->
<g id="node595" class="node">
<title>l2_qkv_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1587" cy="-8717.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1587" y="-8736.72" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="1587" y="-8721.72" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1587" y="-8706.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1587" y="-8691.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_mlp_4h2_h_gpu2&#45;&gt;l2_qkv_gpu2 -->
<g id="edge1475" class="edge">
<title>l1_mlp_4h2_h_gpu2&#45;&gt;l2_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1584.24,-8823.77C1584.64,-8808.74 1585.08,-8791.95 1585.49,-8776.3"/>
<polygon fill="black" stroke="black" points="1588.99,-8776.29 1585.76,-8766.2 1582,-8776.1 1588.99,-8776.29"/>
</g>
<!-- l2_qkv_gpu3 -->
<g id="node596" class="node">
<title>l2_qkv_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1790" cy="-8717.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1790" y="-8736.72" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="1790" y="-8721.72" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1790" y="-8706.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1790" y="-8691.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_mlp_4h2_h_gpu3&#45;&gt;l2_qkv_gpu3 -->
<g id="edge1476" class="edge">
<title>l1_mlp_4h2_h_gpu3&#45;&gt;l2_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1787.24,-8823.77C1787.64,-8808.74 1788.08,-8791.95 1788.49,-8776.3"/>
<polygon fill="black" stroke="black" points="1791.99,-8776.29 1788.76,-8766.2 1785,-8776.1 1791.99,-8776.29"/>
</g>
<!-- l2_qkv_gpu4 -->
<g id="node597" class="node">
<title>l2_qkv_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1992" cy="-8717.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1992" y="-8736.72" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="1992" y="-8721.72" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1992" y="-8706.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1992" y="-8691.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_mlp_4h2_h_gpu4&#45;&gt;l2_qkv_gpu4 -->
<g id="edge1477" class="edge">
<title>l1_mlp_4h2_h_gpu4&#45;&gt;l2_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1990.62,-8823.77C1990.82,-8808.74 1991.04,-8791.95 1991.25,-8776.3"/>
<polygon fill="black" stroke="black" points="1994.75,-8776.24 1991.38,-8766.2 1987.75,-8776.15 1994.75,-8776.24"/>
</g>
<!-- l2_qkv_gpu5 -->
<g id="node598" class="node">
<title>l2_qkv_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2194" cy="-8717.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2194" y="-8736.72" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="2194" y="-8721.72" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2194" y="-8706.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2194" y="-8691.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_mlp_4h2_h_gpu5&#45;&gt;l2_qkv_gpu5 -->
<g id="edge1478" class="edge">
<title>l1_mlp_4h2_h_gpu5&#45;&gt;l2_qkv_gpu5</title>
<path fill="none" stroke="black" d="M2191.93,-8823.77C2192.23,-8808.74 2192.56,-8791.95 2192.87,-8776.3"/>
<polygon fill="black" stroke="black" points="2196.37,-8776.27 2193.07,-8766.2 2189.37,-8776.13 2196.37,-8776.27"/>
</g>
<!-- l2_qkv_gpu6 -->
<g id="node599" class="node">
<title>l2_qkv_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2396" cy="-8717.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2396" y="-8736.72" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="2396" y="-8721.72" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2396" y="-8706.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2396" y="-8691.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_mlp_4h2_h_gpu6&#45;&gt;l2_qkv_gpu6 -->
<g id="edge1479" class="edge">
<title>l1_mlp_4h2_h_gpu6&#45;&gt;l2_qkv_gpu6</title>
<path fill="none" stroke="black" d="M2396,-8823.77C2396,-8808.74 2396,-8791.95 2396,-8776.3"/>
<polygon fill="black" stroke="black" points="2399.5,-8776.2 2396,-8766.2 2392.5,-8776.2 2399.5,-8776.2"/>
</g>
<!-- l2_qkv_gpu7 -->
<g id="node600" class="node">
<title>l2_qkv_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2598" cy="-8717.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2598" y="-8736.72" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="2598" y="-8721.72" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2598" y="-8706.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2598" y="-8691.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_mlp_4h2_h_gpu7&#45;&gt;l2_qkv_gpu7 -->
<g id="edge1480" class="edge">
<title>l1_mlp_4h2_h_gpu7&#45;&gt;l2_qkv_gpu7</title>
<path fill="none" stroke="black" d="M2598,-8823.77C2598,-8808.74 2598,-8791.95 2598,-8776.3"/>
<polygon fill="black" stroke="black" points="2601.5,-8776.2 2598,-8766.2 2594.5,-8776.2 2601.5,-8776.2"/>
</g>
<!-- l2_qkv_gpu8 -->
<g id="node601" class="node">
<title>l2_qkv_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2800" cy="-8717.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2800" y="-8736.72" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="2800" y="-8721.72" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2800" y="-8706.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2800" y="-8691.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_mlp_4h2_h_gpu8&#45;&gt;l2_qkv_gpu8 -->
<g id="edge1481" class="edge">
<title>l1_mlp_4h2_h_gpu8&#45;&gt;l2_qkv_gpu8</title>
<path fill="none" stroke="black" d="M2800.69,-8823.77C2800.59,-8808.74 2800.48,-8791.95 2800.38,-8776.3"/>
<polygon fill="black" stroke="black" points="2803.88,-8776.17 2800.31,-8766.2 2796.88,-8776.22 2803.88,-8776.17"/>
</g>
<!-- l2_qkv_gpu9 -->
<g id="node602" class="node">
<title>l2_qkv_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3002" cy="-8717.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3002" y="-8736.72" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="3002" y="-8721.72" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3002" y="-8706.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3002" y="-8691.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_mlp_4h2_h_gpu9&#45;&gt;l2_qkv_gpu9 -->
<g id="edge1482" class="edge">
<title>l1_mlp_4h2_h_gpu9&#45;&gt;l2_qkv_gpu9</title>
<path fill="none" stroke="black" d="M3003.38,-8823.77C3003.18,-8808.74 3002.96,-8791.95 3002.75,-8776.3"/>
<polygon fill="black" stroke="black" points="3006.25,-8776.15 3002.62,-8766.2 2999.25,-8776.24 3006.25,-8776.15"/>
</g>
<!-- l2_qkv_gpu10 -->
<g id="node603" class="node">
<title>l2_qkv_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3204" cy="-8717.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3204" y="-8736.72" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="3204" y="-8721.72" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3204" y="-8706.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3204" y="-8691.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_mlp_4h2_h_gpu10&#45;&gt;l2_qkv_gpu10 -->
<g id="edge1483" class="edge">
<title>l1_mlp_4h2_h_gpu10&#45;&gt;l2_qkv_gpu10</title>
<path fill="none" stroke="black" d="M3207.45,-8823.77C3206.95,-8808.74 3206.4,-8791.95 3205.89,-8776.3"/>
<polygon fill="black" stroke="black" points="3209.38,-8776.08 3205.55,-8766.2 3202.38,-8776.31 3209.38,-8776.08"/>
</g>
<!-- l2_qkv_gpu11 -->
<g id="node604" class="node">
<title>l2_qkv_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3406" cy="-8717.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3406" y="-8736.72" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="3406" y="-8721.72" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3406" y="-8706.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3406" y="-8691.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_mlp_4h2_h_gpu11&#45;&gt;l2_qkv_gpu11 -->
<g id="edge1484" class="edge">
<title>l1_mlp_4h2_h_gpu11&#45;&gt;l2_qkv_gpu11</title>
<path fill="none" stroke="black" d="M3409.45,-8823.77C3408.95,-8808.74 3408.4,-8791.95 3407.89,-8776.3"/>
<polygon fill="black" stroke="black" points="3411.38,-8776.08 3407.55,-8766.2 3404.38,-8776.31 3411.38,-8776.08"/>
</g>
<!-- l2_qkv_gpu12 -->
<g id="node605" class="node">
<title>l2_qkv_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3608" cy="-8717.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3608" y="-8736.72" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="3608" y="-8721.72" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3608" y="-8706.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3608" y="-8691.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_mlp_4h2_h_gpu12&#45;&gt;l2_qkv_gpu12 -->
<g id="edge1485" class="edge">
<title>l1_mlp_4h2_h_gpu12&#45;&gt;l2_qkv_gpu12</title>
<path fill="none" stroke="black" d="M3613.51,-8823.77C3612.72,-8808.74 3611.84,-8791.95 3611.02,-8776.3"/>
<polygon fill="black" stroke="black" points="3614.51,-8776 3610.49,-8766.2 3607.52,-8776.37 3614.51,-8776"/>
</g>
<!-- l2_qkv_gpu13 -->
<g id="node606" class="node">
<title>l2_qkv_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3810" cy="-8717.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3810" y="-8736.72" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="3810" y="-8721.72" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3810" y="-8706.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3810" y="-8691.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_mlp_4h2_h_gpu13&#45;&gt;l2_qkv_gpu13 -->
<g id="edge1486" class="edge">
<title>l1_mlp_4h2_h_gpu13&#45;&gt;l2_qkv_gpu13</title>
<path fill="none" stroke="black" d="M3811.38,-8823.77C3811.18,-8808.74 3810.96,-8791.95 3810.75,-8776.3"/>
<polygon fill="black" stroke="black" points="3814.25,-8776.15 3810.62,-8766.2 3807.25,-8776.24 3814.25,-8776.15"/>
</g>
<!-- l2_qkv_gpu14 -->
<g id="node607" class="node">
<title>l2_qkv_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4012" cy="-8717.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="4012" y="-8736.72" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="4012" y="-8721.72" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4012" y="-8706.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="4012" y="-8691.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_mlp_4h2_h_gpu14&#45;&gt;l2_qkv_gpu14 -->
<g id="edge1487" class="edge">
<title>l1_mlp_4h2_h_gpu14&#45;&gt;l2_qkv_gpu14</title>
<path fill="none" stroke="black" d="M4021.65,-8823.77C4020.26,-8808.74 4018.72,-8791.95 4017.28,-8776.3"/>
<polygon fill="black" stroke="black" points="4020.75,-8775.84 4016.35,-8766.2 4013.78,-8776.48 4020.75,-8775.84"/>
</g>
<!-- l2_qkv_gpu15 -->
<g id="node608" class="node">
<title>l2_qkv_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4214" cy="-8717.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="4214" y="-8736.72" font-family="Times,serif" font-size="14.00">L2 QKV Proj</text>
<text text-anchor="middle" x="4214" y="-8721.72" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4214" y="-8706.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="4214" y="-8691.72" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l1_mlp_4h2_h_gpu15&#45;&gt;l2_qkv_gpu15 -->
<g id="edge1488" class="edge">
<title>l1_mlp_4h2_h_gpu15&#45;&gt;l2_qkv_gpu15</title>
<path fill="none" stroke="black" d="M4220.89,-8823.77C4219.9,-8808.74 4218.8,-8791.95 4217.77,-8776.3"/>
<polygon fill="black" stroke="black" points="4221.26,-8775.95 4217.11,-8766.2 4214.27,-8776.41 4221.26,-8775.95"/>
</g>
<!-- l2_attn_stage0_gpu0 -->
<g id="node337" class="node">
<title>l2_attn_stage0_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1285" cy="-8574.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1285" y="-8585.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="1285" y="-8570.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1285" y="-8555.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu0 -->
<g id="node353" class="node">
<title>l2_attn_stage1_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1285" cy="-8427.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1285" y="-8438.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="1285" y="-8423.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1285" y="-8408.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu0&#45;&gt;l2_attn_stage1_gpu0 -->
<g id="edge321" class="edge">
<title>l2_attn_stage0_gpu0&#45;&gt;l2_attn_stage1_gpu0</title>
<path fill="none" stroke="black" d="M1285,-8536.74C1285,-8518.02 1285,-8495.03 1285,-8475.05"/>
<polygon fill="black" stroke="black" points="1288.5,-8474.91 1285,-8464.91 1281.5,-8474.91 1288.5,-8474.91"/>
</g>
<!-- l2_attn_stage1_gpu[next_gpu] -->
<g id="node1328" class="node">
<title>l2_attn_stage1_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4472" cy="-8427.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4472" y="-8423.63" font-family="Times,serif" font-size="14.00">l2_attn_stage1_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage0_gpu0&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge1489" class="edge">
<title>l2_attn_stage0_gpu0&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1338.29,-8544.33C1352.43,-8537.99 1367.95,-8532.18 1383,-8528.83 1612.73,-8477.7 3265.66,-8506.38 3501,-8503.83 3545.94,-8503.34 4265.97,-8504.86 4310,-8495.83 4353.87,-8486.83 4400.77,-8465.91 4432.76,-8449.73"/>
<polygon fill="red" stroke="red" points="4434.49,-8452.78 4441.78,-8445.09 4431.28,-8446.55 4434.49,-8452.78"/>
<text text-anchor="middle" x="3532.5" y="-8507.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu1 -->
<g id="node338" class="node">
<title>l2_attn_stage0_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1480" cy="-8574.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1480" y="-8585.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="1480" y="-8570.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1480" y="-8555.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu1 -->
<g id="node354" class="node">
<title>l2_attn_stage1_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1480" cy="-8427.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1480" y="-8438.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="1480" y="-8423.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1480" y="-8408.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu1&#45;&gt;l2_attn_stage1_gpu1 -->
<g id="edge322" class="edge">
<title>l2_attn_stage0_gpu1&#45;&gt;l2_attn_stage1_gpu1</title>
<path fill="none" stroke="black" d="M1480,-8536.74C1480,-8518.02 1480,-8495.03 1480,-8475.05"/>
<polygon fill="black" stroke="black" points="1483.5,-8474.91 1480,-8464.91 1476.5,-8474.91 1483.5,-8474.91"/>
</g>
<!-- l2_attn_stage0_gpu1&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge1490" class="edge">
<title>l2_attn_stage0_gpu1&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1533.28,-8544.26C1547.41,-8537.92 1562.94,-8532.13 1578,-8528.83 1632,-8517 3515.82,-8537.09 3568,-8518.83 3578.15,-8515.28 3576.86,-8507.42 3587,-8503.83 3624.87,-8490.45 4270.66,-8503.93 4310,-8495.83 4353.87,-8486.81 4400.77,-8465.89 4432.76,-8449.72"/>
<polygon fill="red" stroke="red" points="4434.48,-8452.76 4441.78,-8445.08 4431.28,-8446.54 4434.48,-8452.76"/>
<text text-anchor="middle" x="3618.5" y="-8507.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu2 -->
<g id="node339" class="node">
<title>l2_attn_stage0_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1675" cy="-8574.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1675" y="-8585.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="1675" y="-8570.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1675" y="-8555.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu2 -->
<g id="node355" class="node">
<title>l2_attn_stage1_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1675" cy="-8427.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1675" y="-8438.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="1675" y="-8423.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1675" y="-8408.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu2&#45;&gt;l2_attn_stage1_gpu2 -->
<g id="edge323" class="edge">
<title>l2_attn_stage0_gpu2&#45;&gt;l2_attn_stage1_gpu2</title>
<path fill="none" stroke="black" d="M1675,-8536.74C1675,-8518.02 1675,-8495.03 1675,-8475.05"/>
<polygon fill="black" stroke="black" points="1678.5,-8474.91 1675,-8464.91 1671.5,-8474.91 1678.5,-8474.91"/>
</g>
<!-- l2_attn_stage0_gpu2&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge1491" class="edge">
<title>l2_attn_stage0_gpu2&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1728.28,-8544.27C1742.41,-8537.93 1757.94,-8532.13 1773,-8528.83 1824.04,-8517.64 3604.68,-8536.1 3654,-8518.83 3664.15,-8515.28 3662.86,-8507.42 3673,-8503.83 3706.36,-8492.01 4275.34,-8502.99 4310,-8495.83 4353.86,-8486.77 4400.76,-8465.86 4432.75,-8449.7"/>
<polygon fill="red" stroke="red" points="4434.48,-8452.75 4441.77,-8445.07 4431.28,-8446.52 4434.48,-8452.75"/>
<text text-anchor="middle" x="3704.5" y="-8507.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu3 -->
<g id="node340" class="node">
<title>l2_attn_stage0_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1870" cy="-8574.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1870" y="-8585.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="1870" y="-8570.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1870" y="-8555.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu3 -->
<g id="node356" class="node">
<title>l2_attn_stage1_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1870" cy="-8427.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1870" y="-8438.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="1870" y="-8423.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1870" y="-8408.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu3&#45;&gt;l2_attn_stage1_gpu3 -->
<g id="edge324" class="edge">
<title>l2_attn_stage0_gpu3&#45;&gt;l2_attn_stage1_gpu3</title>
<path fill="none" stroke="black" d="M1870,-8536.74C1870,-8518.02 1870,-8495.03 1870,-8475.05"/>
<polygon fill="black" stroke="black" points="1873.5,-8474.91 1870,-8464.91 1866.5,-8474.91 1873.5,-8474.91"/>
</g>
<!-- l2_attn_stage0_gpu3&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge1492" class="edge">
<title>l2_attn_stage0_gpu3&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1923.28,-8544.27C1937.41,-8537.93 1952.94,-8532.13 1968,-8528.83 2016.08,-8518.28 3693.55,-8535.11 3740,-8518.83 3750.15,-8515.27 3748.86,-8507.43 3759,-8503.83 3787.85,-8493.58 4280.02,-8502.05 4310,-8495.83 4353.85,-8486.73 4400.75,-8465.83 4432.75,-8449.67"/>
<polygon fill="red" stroke="red" points="4434.47,-8452.73 4441.77,-8445.05 4431.27,-8446.5 4434.47,-8452.73"/>
<text text-anchor="middle" x="3790.5" y="-8507.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu4 -->
<g id="node341" class="node">
<title>l2_attn_stage0_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2065" cy="-8574.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2065" y="-8585.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="2065" y="-8570.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2065" y="-8555.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu4 -->
<g id="node357" class="node">
<title>l2_attn_stage1_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2065" cy="-8427.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2065" y="-8438.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="2065" y="-8423.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2065" y="-8408.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu4&#45;&gt;l2_attn_stage1_gpu4 -->
<g id="edge325" class="edge">
<title>l2_attn_stage0_gpu4&#45;&gt;l2_attn_stage1_gpu4</title>
<path fill="none" stroke="black" d="M2065,-8536.74C2065,-8518.02 2065,-8495.03 2065,-8475.05"/>
<polygon fill="black" stroke="black" points="2068.5,-8474.91 2065,-8464.91 2061.5,-8474.91 2068.5,-8474.91"/>
</g>
<!-- l2_attn_stage0_gpu4&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge1493" class="edge">
<title>l2_attn_stage0_gpu4&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2118.28,-8544.27C2132.41,-8537.93 2147.94,-8532.14 2163,-8528.83 2208.12,-8518.93 3782.41,-8534.11 3826,-8518.83 3836.15,-8515.27 3834.87,-8507.45 3845,-8503.83 3893.67,-8486.47 4259.42,-8506.4 4310,-8495.83 4353.84,-8486.67 4400.74,-8465.78 4432.74,-8449.64"/>
<polygon fill="red" stroke="red" points="4434.46,-8452.7 4441.76,-8445.02 4431.27,-8446.47 4434.46,-8452.7"/>
<text text-anchor="middle" x="3876.5" y="-8507.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu5 -->
<g id="node342" class="node">
<title>l2_attn_stage0_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2260" cy="-8574.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2260" y="-8585.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="2260" y="-8570.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2260" y="-8555.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu5 -->
<g id="node358" class="node">
<title>l2_attn_stage1_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2260" cy="-8427.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2260" y="-8438.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="2260" y="-8423.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2260" y="-8408.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu5&#45;&gt;l2_attn_stage1_gpu5 -->
<g id="edge326" class="edge">
<title>l2_attn_stage0_gpu5&#45;&gt;l2_attn_stage1_gpu5</title>
<path fill="none" stroke="black" d="M2260,-8536.74C2260,-8518.02 2260,-8495.03 2260,-8475.05"/>
<polygon fill="black" stroke="black" points="2263.5,-8474.91 2260,-8464.91 2256.5,-8474.91 2263.5,-8474.91"/>
</g>
<!-- l2_attn_stage0_gpu5&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge1494" class="edge">
<title>l2_attn_stage0_gpu5&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2313.28,-8544.28C2327.41,-8537.94 2342.94,-8532.14 2358,-8528.83 2400.16,-8519.57 3871.27,-8533.12 3912,-8518.83 3922.15,-8515.27 3920.87,-8507.47 3931,-8503.83 3970.64,-8489.6 4268.79,-8504.53 4310,-8495.83 4353.82,-8486.59 4400.73,-8465.7 4432.73,-8449.6"/>
<polygon fill="red" stroke="red" points="4434.45,-8452.65 4441.75,-8444.98 4431.26,-8446.42 4434.45,-8452.65"/>
<text text-anchor="middle" x="3962.5" y="-8507.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu6 -->
<g id="node343" class="node">
<title>l2_attn_stage0_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2455" cy="-8574.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2455" y="-8585.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="2455" y="-8570.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2455" y="-8555.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu6 -->
<g id="node359" class="node">
<title>l2_attn_stage1_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2455" cy="-8427.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2455" y="-8438.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="2455" y="-8423.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2455" y="-8408.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu6&#45;&gt;l2_attn_stage1_gpu6 -->
<g id="edge327" class="edge">
<title>l2_attn_stage0_gpu6&#45;&gt;l2_attn_stage1_gpu6</title>
<path fill="none" stroke="black" d="M2455,-8536.74C2455,-8518.02 2455,-8495.03 2455,-8475.05"/>
<polygon fill="black" stroke="black" points="2458.5,-8474.91 2455,-8464.91 2451.5,-8474.91 2458.5,-8474.91"/>
</g>
<!-- l2_attn_stage0_gpu6&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge1495" class="edge">
<title>l2_attn_stage0_gpu6&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2508.28,-8544.28C2522.41,-8537.94 2537.94,-8532.14 2553,-8528.83 2592.2,-8520.21 3960.13,-8532.13 3998,-8518.83 4008.15,-8515.27 4006.89,-8507.5 4017,-8503.83 4047.62,-8492.73 4278.15,-8502.65 4310,-8495.83 4353.66,-8486.48 4400.41,-8465.72 4432.42,-8449.67"/>
<polygon fill="red" stroke="red" points="4434.12,-8452.73 4441.45,-8445.07 4430.95,-8446.49 4434.12,-8452.73"/>
<text text-anchor="middle" x="4048.5" y="-8507.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu7 -->
<g id="node344" class="node">
<title>l2_attn_stage0_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2650" cy="-8574.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2650" y="-8585.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="2650" y="-8570.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2650" y="-8555.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu7 -->
<g id="node360" class="node">
<title>l2_attn_stage1_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2650" cy="-8427.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2650" y="-8438.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="2650" y="-8423.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2650" y="-8408.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu7&#45;&gt;l2_attn_stage1_gpu7 -->
<g id="edge328" class="edge">
<title>l2_attn_stage0_gpu7&#45;&gt;l2_attn_stage1_gpu7</title>
<path fill="none" stroke="black" d="M2650,-8536.74C2650,-8518.02 2650,-8495.03 2650,-8475.05"/>
<polygon fill="black" stroke="black" points="2653.5,-8474.91 2650,-8464.91 2646.5,-8474.91 2653.5,-8474.91"/>
</g>
<!-- l2_attn_stage0_gpu7&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge1496" class="edge">
<title>l2_attn_stage0_gpu7&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2703.28,-8544.29C2717.42,-8537.95 2732.95,-8532.15 2748,-8528.83 2784.24,-8520.85 4048.99,-8531.13 4084,-8518.83 4094.15,-8515.27 4092.91,-8507.56 4103,-8503.83 4146.19,-8487.9 4265.04,-8505.73 4310,-8495.83 4353.6,-8486.23 4400.37,-8465.51 4432.39,-8449.54"/>
<polygon fill="red" stroke="red" points="4434.08,-8452.6 4441.42,-8444.96 4430.92,-8446.36 4434.08,-8452.6"/>
<text text-anchor="middle" x="4134.5" y="-8507.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu8 -->
<g id="node345" class="node">
<title>l2_attn_stage0_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2845" cy="-8574.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2845" y="-8585.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="2845" y="-8570.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2845" y="-8555.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu8 -->
<g id="node361" class="node">
<title>l2_attn_stage1_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2845" cy="-8427.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2845" y="-8438.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="2845" y="-8423.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2845" y="-8408.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu8&#45;&gt;l2_attn_stage1_gpu8 -->
<g id="edge329" class="edge">
<title>l2_attn_stage0_gpu8&#45;&gt;l2_attn_stage1_gpu8</title>
<path fill="none" stroke="black" d="M2845,-8536.74C2845,-8518.02 2845,-8495.03 2845,-8475.05"/>
<polygon fill="black" stroke="black" points="2848.5,-8474.91 2845,-8464.91 2841.5,-8474.91 2848.5,-8474.91"/>
</g>
<!-- l2_attn_stage0_gpu8&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge1497" class="edge">
<title>l2_attn_stage0_gpu8&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2898.28,-8544.3C2912.42,-8537.96 2927.95,-8532.15 2943,-8528.83 3009.57,-8514.14 4105.69,-8541.45 4170,-8518.83 4180.15,-8515.26 4178.96,-8507.69 4189,-8503.83 4239.3,-8484.49 4257.53,-8508.14 4310,-8495.83 4353.2,-8485.7 4399.67,-8465.25 4431.71,-8449.5"/>
<polygon fill="red" stroke="red" points="4433.38,-8452.59 4440.77,-8444.99 4430.25,-8446.32 4433.38,-8452.59"/>
<text text-anchor="middle" x="4220.5" y="-8507.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu9 -->
<g id="node346" class="node">
<title>l2_attn_stage0_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3040" cy="-8574.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3040" y="-8585.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="3040" y="-8570.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3040" y="-8555.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu9 -->
<g id="node362" class="node">
<title>l2_attn_stage1_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3040" cy="-8427.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3040" y="-8438.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="3040" y="-8423.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3040" y="-8408.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu9&#45;&gt;l2_attn_stage1_gpu9 -->
<g id="edge330" class="edge">
<title>l2_attn_stage0_gpu9&#45;&gt;l2_attn_stage1_gpu9</title>
<path fill="none" stroke="black" d="M3040,-8536.74C3040,-8518.02 3040,-8495.03 3040,-8475.05"/>
<polygon fill="black" stroke="black" points="3043.5,-8474.91 3040,-8464.91 3036.5,-8474.91 3043.5,-8474.91"/>
</g>
<!-- l2_attn_stage0_gpu9&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge1498" class="edge">
<title>l2_attn_stage0_gpu9&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3093.28,-8544.3C3107.42,-8537.96 3122.95,-8532.16 3138,-8528.83 3198.65,-8515.42 4197.41,-8539.46 4256,-8518.83 4266.15,-8515.26 4265.3,-8508.48 4275,-8503.83 4289.39,-8496.94 4294.8,-8500.7 4310,-8495.83 4350.94,-8482.73 4395.95,-8463.57 4428.12,-8449.01"/>
<polygon fill="red" stroke="red" points="4429.61,-8452.17 4437.25,-8444.84 4426.7,-8445.81 4429.61,-8452.17"/>
<text text-anchor="middle" x="4306.5" y="-8507.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu10 -->
<g id="node347" class="node">
<title>l2_attn_stage0_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3235" cy="-8574.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3235" y="-8585.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="3235" y="-8570.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3235" y="-8555.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu10 -->
<g id="node363" class="node">
<title>l2_attn_stage1_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3235" cy="-8427.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3235" y="-8438.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="3235" y="-8423.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3235" y="-8408.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu10&#45;&gt;l2_attn_stage1_gpu10 -->
<g id="edge331" class="edge">
<title>l2_attn_stage0_gpu10&#45;&gt;l2_attn_stage1_gpu10</title>
<path fill="none" stroke="black" d="M3235,-8536.74C3235,-8518.02 3235,-8495.03 3235,-8475.05"/>
<polygon fill="black" stroke="black" points="3238.5,-8474.91 3235,-8464.91 3231.5,-8474.91 3238.5,-8474.91"/>
</g>
<!-- l2_attn_stage0_gpu10&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge1499" class="edge">
<title>l2_attn_stage0_gpu10&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3288.29,-8544.31C3302.42,-8537.97 3317.95,-8532.17 3333,-8528.83 3387.73,-8516.7 4289.13,-8537.48 4342,-8518.83 4352.15,-8515.25 4352.32,-8510.19 4361,-8503.83 4386.22,-8485.34 4415.5,-8465.49 4437.65,-8450.78"/>
<polygon fill="red" stroke="red" points="4439.66,-8453.65 4446.07,-8445.22 4435.8,-8447.81 4439.66,-8453.65"/>
<text text-anchor="middle" x="4392.5" y="-8507.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu11 -->
<g id="node348" class="node">
<title>l2_attn_stage0_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3430" cy="-8574.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3430" y="-8585.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="3430" y="-8570.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3430" y="-8555.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu11 -->
<g id="node364" class="node">
<title>l2_attn_stage1_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3430" cy="-8427.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3430" y="-8438.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="3430" y="-8423.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3430" y="-8408.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu11&#45;&gt;l2_attn_stage1_gpu11 -->
<g id="edge332" class="edge">
<title>l2_attn_stage0_gpu11&#45;&gt;l2_attn_stage1_gpu11</title>
<path fill="none" stroke="black" d="M3430,-8536.74C3430,-8518.02 3430,-8495.03 3430,-8475.05"/>
<polygon fill="black" stroke="black" points="3433.5,-8474.91 3430,-8464.91 3426.5,-8474.91 3433.5,-8474.91"/>
</g>
<!-- l2_attn_stage0_gpu11&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge1500" class="edge">
<title>l2_attn_stage0_gpu11&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3483.29,-8544.33C3497.42,-8537.99 3512.95,-8532.18 3528,-8528.83 3552.41,-8523.41 4406.88,-8532.21 4428,-8518.83 4449.94,-8504.93 4461.24,-8476.65 4466.85,-8455.39"/>
<polygon fill="red" stroke="red" points="4470.27,-8456.14 4469.18,-8445.6 4463.46,-8454.52 4470.27,-8456.14"/>
<text text-anchor="middle" x="4474.5" y="-8507.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu12 -->
<g id="node349" class="node">
<title>l2_attn_stage0_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3625" cy="-8574.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3625" y="-8585.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="3625" y="-8570.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3625" y="-8555.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu12 -->
<g id="node365" class="node">
<title>l2_attn_stage1_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3625" cy="-8427.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3625" y="-8438.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="3625" y="-8423.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3625" y="-8408.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu12&#45;&gt;l2_attn_stage1_gpu12 -->
<g id="edge333" class="edge">
<title>l2_attn_stage0_gpu12&#45;&gt;l2_attn_stage1_gpu12</title>
<path fill="none" stroke="black" d="M3569.85,-8544.87C3556.43,-8538.83 3541.93,-8533.03 3528,-8528.83 3514.22,-8524.68 3473.36,-8529.77 3464,-8518.83 3429.08,-8478.03 3469.79,-8518.15 3528,-8495.83 3545.78,-8489.01 3563.42,-8478.27 3578.68,-8467.34"/>
<polygon fill="black" stroke="black" points="3580.93,-8470.02 3586.9,-8461.27 3576.77,-8464.39 3580.93,-8470.02"/>
</g>
<!-- l2_attn_stage0_gpu12&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge1501" class="edge">
<title>l2_attn_stage0_gpu12&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3678.29,-8544.34C3692.43,-8538 3707.95,-8532.19 3723,-8528.83 3744.45,-8524.05 4498.56,-8534.47 4514,-8518.83 4532.16,-8500.44 4514.89,-8472.75 4497.31,-8452.84"/>
<polygon fill="red" stroke="red" points="4499.75,-8450.32 4490.38,-8445.37 4494.61,-8455.08 4499.75,-8450.32"/>
<text text-anchor="middle" x="4552.5" y="-8507.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu13 -->
<g id="node350" class="node">
<title>l2_attn_stage0_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3820" cy="-8574.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3820" y="-8585.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="3820" y="-8570.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3820" y="-8555.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu13 -->
<g id="node366" class="node">
<title>l2_attn_stage1_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3820" cy="-8427.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3820" y="-8438.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="3820" y="-8423.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3820" y="-8408.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu13&#45;&gt;l2_attn_stage1_gpu13 -->
<g id="edge334" class="edge">
<title>l2_attn_stage0_gpu13&#45;&gt;l2_attn_stage1_gpu13</title>
<path fill="none" stroke="black" d="M3766.7,-8544.39C3752.85,-8538.13 3737.69,-8532.35 3723,-8528.83 3709.37,-8525.57 3480.71,-8528.93 3471,-8518.83 3466.38,-8514.03 3466.36,-8508.62 3471,-8503.83 3480.75,-8493.77 3709.7,-8500.24 3723,-8495.83 3741.4,-8489.74 3759.44,-8478.94 3774.87,-8467.75"/>
<polygon fill="black" stroke="black" points="3777.27,-8470.33 3783.16,-8461.52 3773.06,-8464.73 3777.27,-8470.33"/>
</g>
<!-- l2_attn_stage0_gpu13&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge1502" class="edge">
<title>l2_attn_stage0_gpu13&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3873.3,-8544.36C3887.43,-8538.02 3902.96,-8532.2 3918,-8528.83 3936.49,-8524.69 4586.7,-8532.33 4600,-8518.83 4628.36,-8490.06 4580.79,-8464.22 4535.82,-8447.6"/>
<polygon fill="red" stroke="red" points="4536.88,-8444.26 4526.29,-8444.19 4534.53,-8450.85 4536.88,-8444.26"/>
<text text-anchor="middle" x="4639.5" y="-8507.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu14 -->
<g id="node351" class="node">
<title>l2_attn_stage0_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4015" cy="-8574.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4015" y="-8585.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="4015" y="-8570.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4015" y="-8555.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu14 -->
<g id="node367" class="node">
<title>l2_attn_stage1_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4015" cy="-8427.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4015" y="-8438.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="4015" y="-8423.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4015" y="-8408.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu14&#45;&gt;l2_attn_stage1_gpu14 -->
<g id="edge335" class="edge">
<title>l2_attn_stage0_gpu14&#45;&gt;l2_attn_stage1_gpu14</title>
<path fill="none" stroke="black" d="M3961.74,-8544.22C3947.89,-8537.96 3932.71,-8532.22 3918,-8528.83 3894.17,-8523.34 3495.09,-8536.32 3478,-8518.83 3473.34,-8514.06 3473.33,-8508.59 3478,-8503.83 3486.56,-8495.11 3906.37,-8499.6 3918,-8495.83 3936.45,-8489.86 3954.49,-8479.1 3969.92,-8467.9"/>
<polygon fill="black" stroke="black" points="3972.32,-8470.47 3978.2,-8461.66 3968.11,-8464.88 3972.32,-8470.47"/>
</g>
<!-- l2_attn_stage0_gpu14&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge1503" class="edge">
<title>l2_attn_stage0_gpu14&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4068.3,-8544.39C4082.44,-8538.05 4097.96,-8532.22 4113,-8528.83 4128.53,-8525.33 4674.84,-8530.19 4686,-8518.83 4726.03,-8478.09 4656.32,-8454.74 4586.01,-8441.99"/>
<polygon fill="red" stroke="red" points="4586.55,-8438.53 4576.1,-8440.26 4585.35,-8445.43 4586.55,-8438.53"/>
<text text-anchor="middle" x="4726.5" y="-8507.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage0_gpu15 -->
<g id="node352" class="node">
<title>l2_attn_stage0_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4210" cy="-8574.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4210" y="-8585.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage0</text>
<text text-anchor="middle" x="4210" y="-8570.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4210" y="-8555.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu15 -->
<g id="node368" class="node">
<title>l2_attn_stage1_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4210" cy="-8427.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4210" y="-8438.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage1</text>
<text text-anchor="middle" x="4210" y="-8423.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4210" y="-8408.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage0_gpu15&#45;&gt;l2_attn_stage1_gpu15 -->
<g id="edge336" class="edge">
<title>l2_attn_stage0_gpu15&#45;&gt;l2_attn_stage1_gpu15</title>
<path fill="none" stroke="black" d="M4157.02,-8544.26C4143.09,-8537.97 4127.82,-8532.19 4113,-8528.83 4095.99,-8524.97 3497.24,-8531.27 3485,-8518.83 3480.32,-8514.08 3480.32,-8508.58 3485,-8503.83 3497.26,-8491.42 4096.39,-8501.16 4113,-8495.83 4131.46,-8489.91 4149.51,-8479.16 4164.94,-8467.96"/>
<polygon fill="black" stroke="black" points="4167.34,-8470.53 4173.22,-8461.72 4163.13,-8464.94 4167.34,-8470.53"/>
</g>
<!-- l2_attn_stage0_gpu15&#45;&gt;l2_attn_stage1_gpu[next_gpu] -->
<g id="edge1504" class="edge">
<title>l2_attn_stage0_gpu15&#45;&gt;l2_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4298.34,-8571.15C4448.61,-8566.52 4740.83,-8553.17 4772,-8518.83 4824.01,-8461.54 4725.61,-8439.97 4627.88,-8432.12"/>
<polygon fill="red" stroke="red" points="4628.06,-8428.62 4617.82,-8431.36 4627.53,-8435.6 4628.06,-8428.62"/>
<text text-anchor="middle" x="4811.5" y="-8507.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu0 -->
<g id="node369" class="node">
<title>l2_attn_stage2_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1285" cy="-8280.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1285" y="-8291.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="1285" y="-8276.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1285" y="-8261.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu0&#45;&gt;l2_attn_stage2_gpu0 -->
<g id="edge337" class="edge">
<title>l2_attn_stage1_gpu0&#45;&gt;l2_attn_stage2_gpu0</title>
<path fill="none" stroke="black" d="M1285,-8389.74C1285,-8371.02 1285,-8348.03 1285,-8328.05"/>
<polygon fill="black" stroke="black" points="1288.5,-8327.91 1285,-8317.91 1281.5,-8327.91 1288.5,-8327.91"/>
</g>
<!-- l2_attn_stage2_gpu[next_gpu] -->
<g id="node1329" class="node">
<title>l2_attn_stage2_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4472" cy="-8280.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4472" y="-8276.63" font-family="Times,serif" font-size="14.00">l2_attn_stage2_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage1_gpu0&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge1505" class="edge">
<title>l2_attn_stage1_gpu0&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1338.29,-8397.33C1352.43,-8390.99 1367.95,-8385.18 1383,-8381.83 1612.73,-8330.7 3265.66,-8359.38 3501,-8356.83 3545.94,-8356.34 4265.97,-8357.86 4310,-8348.83 4353.87,-8339.83 4400.77,-8318.91 4432.76,-8302.73"/>
<polygon fill="red" stroke="red" points="4434.49,-8305.78 4441.78,-8298.09 4431.28,-8299.55 4434.49,-8305.78"/>
<text text-anchor="middle" x="3532.5" y="-8360.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu1 -->
<g id="node370" class="node">
<title>l2_attn_stage2_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1480" cy="-8280.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1480" y="-8291.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="1480" y="-8276.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1480" y="-8261.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu1&#45;&gt;l2_attn_stage2_gpu1 -->
<g id="edge338" class="edge">
<title>l2_attn_stage1_gpu1&#45;&gt;l2_attn_stage2_gpu1</title>
<path fill="none" stroke="black" d="M1480,-8389.74C1480,-8371.02 1480,-8348.03 1480,-8328.05"/>
<polygon fill="black" stroke="black" points="1483.5,-8327.91 1480,-8317.91 1476.5,-8327.91 1483.5,-8327.91"/>
</g>
<!-- l2_attn_stage1_gpu1&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge1506" class="edge">
<title>l2_attn_stage1_gpu1&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1533.28,-8397.26C1547.41,-8390.92 1562.94,-8385.13 1578,-8381.83 1632,-8370 3515.82,-8390.09 3568,-8371.83 3578.15,-8368.28 3576.86,-8360.42 3587,-8356.83 3624.87,-8343.45 4270.66,-8356.93 4310,-8348.83 4353.87,-8339.81 4400.77,-8318.89 4432.76,-8302.72"/>
<polygon fill="red" stroke="red" points="4434.48,-8305.76 4441.78,-8298.08 4431.28,-8299.54 4434.48,-8305.76"/>
<text text-anchor="middle" x="3618.5" y="-8360.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu2 -->
<g id="node371" class="node">
<title>l2_attn_stage2_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1675" cy="-8280.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1675" y="-8291.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="1675" y="-8276.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1675" y="-8261.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu2&#45;&gt;l2_attn_stage2_gpu2 -->
<g id="edge339" class="edge">
<title>l2_attn_stage1_gpu2&#45;&gt;l2_attn_stage2_gpu2</title>
<path fill="none" stroke="black" d="M1675,-8389.74C1675,-8371.02 1675,-8348.03 1675,-8328.05"/>
<polygon fill="black" stroke="black" points="1678.5,-8327.91 1675,-8317.91 1671.5,-8327.91 1678.5,-8327.91"/>
</g>
<!-- l2_attn_stage1_gpu2&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge1507" class="edge">
<title>l2_attn_stage1_gpu2&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1728.28,-8397.27C1742.41,-8390.93 1757.94,-8385.13 1773,-8381.83 1824.04,-8370.64 3604.68,-8389.1 3654,-8371.83 3664.15,-8368.28 3662.86,-8360.42 3673,-8356.83 3706.36,-8345.01 4275.34,-8355.99 4310,-8348.83 4353.86,-8339.77 4400.76,-8318.86 4432.75,-8302.7"/>
<polygon fill="red" stroke="red" points="4434.48,-8305.75 4441.77,-8298.07 4431.28,-8299.52 4434.48,-8305.75"/>
<text text-anchor="middle" x="3704.5" y="-8360.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu3 -->
<g id="node372" class="node">
<title>l2_attn_stage2_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1870" cy="-8280.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1870" y="-8291.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="1870" y="-8276.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1870" y="-8261.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu3&#45;&gt;l2_attn_stage2_gpu3 -->
<g id="edge340" class="edge">
<title>l2_attn_stage1_gpu3&#45;&gt;l2_attn_stage2_gpu3</title>
<path fill="none" stroke="black" d="M1870,-8389.74C1870,-8371.02 1870,-8348.03 1870,-8328.05"/>
<polygon fill="black" stroke="black" points="1873.5,-8327.91 1870,-8317.91 1866.5,-8327.91 1873.5,-8327.91"/>
</g>
<!-- l2_attn_stage1_gpu3&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge1508" class="edge">
<title>l2_attn_stage1_gpu3&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1923.28,-8397.27C1937.41,-8390.93 1952.94,-8385.13 1968,-8381.83 2016.08,-8371.28 3693.55,-8388.11 3740,-8371.83 3750.15,-8368.27 3748.86,-8360.43 3759,-8356.83 3787.85,-8346.58 4280.02,-8355.05 4310,-8348.83 4353.85,-8339.73 4400.75,-8318.83 4432.75,-8302.67"/>
<polygon fill="red" stroke="red" points="4434.47,-8305.73 4441.77,-8298.05 4431.27,-8299.5 4434.47,-8305.73"/>
<text text-anchor="middle" x="3790.5" y="-8360.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu4 -->
<g id="node373" class="node">
<title>l2_attn_stage2_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2065" cy="-8280.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2065" y="-8291.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="2065" y="-8276.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2065" y="-8261.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu4&#45;&gt;l2_attn_stage2_gpu4 -->
<g id="edge341" class="edge">
<title>l2_attn_stage1_gpu4&#45;&gt;l2_attn_stage2_gpu4</title>
<path fill="none" stroke="black" d="M2065,-8389.74C2065,-8371.02 2065,-8348.03 2065,-8328.05"/>
<polygon fill="black" stroke="black" points="2068.5,-8327.91 2065,-8317.91 2061.5,-8327.91 2068.5,-8327.91"/>
</g>
<!-- l2_attn_stage1_gpu4&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge1509" class="edge">
<title>l2_attn_stage1_gpu4&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2118.28,-8397.27C2132.41,-8390.93 2147.94,-8385.14 2163,-8381.83 2208.12,-8371.93 3782.41,-8387.11 3826,-8371.83 3836.15,-8368.27 3834.87,-8360.45 3845,-8356.83 3893.67,-8339.47 4259.42,-8359.4 4310,-8348.83 4353.84,-8339.67 4400.74,-8318.78 4432.74,-8302.64"/>
<polygon fill="red" stroke="red" points="4434.46,-8305.7 4441.76,-8298.02 4431.27,-8299.47 4434.46,-8305.7"/>
<text text-anchor="middle" x="3876.5" y="-8360.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu5 -->
<g id="node374" class="node">
<title>l2_attn_stage2_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2260" cy="-8280.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2260" y="-8291.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="2260" y="-8276.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2260" y="-8261.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu5&#45;&gt;l2_attn_stage2_gpu5 -->
<g id="edge342" class="edge">
<title>l2_attn_stage1_gpu5&#45;&gt;l2_attn_stage2_gpu5</title>
<path fill="none" stroke="black" d="M2260,-8389.74C2260,-8371.02 2260,-8348.03 2260,-8328.05"/>
<polygon fill="black" stroke="black" points="2263.5,-8327.91 2260,-8317.91 2256.5,-8327.91 2263.5,-8327.91"/>
</g>
<!-- l2_attn_stage1_gpu5&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge1510" class="edge">
<title>l2_attn_stage1_gpu5&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2313.28,-8397.28C2327.41,-8390.94 2342.94,-8385.14 2358,-8381.83 2400.16,-8372.57 3871.27,-8386.12 3912,-8371.83 3922.15,-8368.27 3920.87,-8360.47 3931,-8356.83 3970.64,-8342.6 4268.79,-8357.53 4310,-8348.83 4353.82,-8339.59 4400.73,-8318.7 4432.73,-8302.6"/>
<polygon fill="red" stroke="red" points="4434.45,-8305.65 4441.75,-8297.98 4431.26,-8299.42 4434.45,-8305.65"/>
<text text-anchor="middle" x="3962.5" y="-8360.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu6 -->
<g id="node375" class="node">
<title>l2_attn_stage2_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2455" cy="-8280.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2455" y="-8291.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="2455" y="-8276.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2455" y="-8261.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu6&#45;&gt;l2_attn_stage2_gpu6 -->
<g id="edge343" class="edge">
<title>l2_attn_stage1_gpu6&#45;&gt;l2_attn_stage2_gpu6</title>
<path fill="none" stroke="black" d="M2455,-8389.74C2455,-8371.02 2455,-8348.03 2455,-8328.05"/>
<polygon fill="black" stroke="black" points="2458.5,-8327.91 2455,-8317.91 2451.5,-8327.91 2458.5,-8327.91"/>
</g>
<!-- l2_attn_stage1_gpu6&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge1511" class="edge">
<title>l2_attn_stage1_gpu6&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2508.28,-8397.28C2522.41,-8390.94 2537.94,-8385.14 2553,-8381.83 2592.2,-8373.21 3960.13,-8385.13 3998,-8371.83 4008.15,-8368.27 4006.89,-8360.5 4017,-8356.83 4047.62,-8345.73 4278.15,-8355.65 4310,-8348.83 4353.66,-8339.48 4400.41,-8318.72 4432.42,-8302.67"/>
<polygon fill="red" stroke="red" points="4434.12,-8305.73 4441.45,-8298.07 4430.95,-8299.49 4434.12,-8305.73"/>
<text text-anchor="middle" x="4048.5" y="-8360.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu7 -->
<g id="node376" class="node">
<title>l2_attn_stage2_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2650" cy="-8280.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2650" y="-8291.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="2650" y="-8276.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2650" y="-8261.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu7&#45;&gt;l2_attn_stage2_gpu7 -->
<g id="edge344" class="edge">
<title>l2_attn_stage1_gpu7&#45;&gt;l2_attn_stage2_gpu7</title>
<path fill="none" stroke="black" d="M2650,-8389.74C2650,-8371.02 2650,-8348.03 2650,-8328.05"/>
<polygon fill="black" stroke="black" points="2653.5,-8327.91 2650,-8317.91 2646.5,-8327.91 2653.5,-8327.91"/>
</g>
<!-- l2_attn_stage1_gpu7&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge1512" class="edge">
<title>l2_attn_stage1_gpu7&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2703.28,-8397.29C2717.42,-8390.95 2732.95,-8385.15 2748,-8381.83 2784.24,-8373.85 4048.99,-8384.13 4084,-8371.83 4094.15,-8368.27 4092.91,-8360.56 4103,-8356.83 4146.19,-8340.9 4265.04,-8358.73 4310,-8348.83 4353.6,-8339.23 4400.37,-8318.51 4432.39,-8302.54"/>
<polygon fill="red" stroke="red" points="4434.08,-8305.6 4441.42,-8297.96 4430.92,-8299.36 4434.08,-8305.6"/>
<text text-anchor="middle" x="4134.5" y="-8360.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu8 -->
<g id="node377" class="node">
<title>l2_attn_stage2_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2845" cy="-8280.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2845" y="-8291.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="2845" y="-8276.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2845" y="-8261.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu8&#45;&gt;l2_attn_stage2_gpu8 -->
<g id="edge345" class="edge">
<title>l2_attn_stage1_gpu8&#45;&gt;l2_attn_stage2_gpu8</title>
<path fill="none" stroke="black" d="M2845,-8389.74C2845,-8371.02 2845,-8348.03 2845,-8328.05"/>
<polygon fill="black" stroke="black" points="2848.5,-8327.91 2845,-8317.91 2841.5,-8327.91 2848.5,-8327.91"/>
</g>
<!-- l2_attn_stage1_gpu8&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge1513" class="edge">
<title>l2_attn_stage1_gpu8&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2898.28,-8397.3C2912.42,-8390.96 2927.95,-8385.15 2943,-8381.83 3009.57,-8367.14 4105.69,-8394.45 4170,-8371.83 4180.15,-8368.26 4178.96,-8360.69 4189,-8356.83 4239.3,-8337.49 4257.53,-8361.14 4310,-8348.83 4353.2,-8338.7 4399.67,-8318.25 4431.71,-8302.5"/>
<polygon fill="red" stroke="red" points="4433.38,-8305.59 4440.77,-8297.99 4430.25,-8299.32 4433.38,-8305.59"/>
<text text-anchor="middle" x="4220.5" y="-8360.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu9 -->
<g id="node378" class="node">
<title>l2_attn_stage2_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3040" cy="-8280.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3040" y="-8291.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="3040" y="-8276.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3040" y="-8261.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu9&#45;&gt;l2_attn_stage2_gpu9 -->
<g id="edge346" class="edge">
<title>l2_attn_stage1_gpu9&#45;&gt;l2_attn_stage2_gpu9</title>
<path fill="none" stroke="black" d="M3040,-8389.74C3040,-8371.02 3040,-8348.03 3040,-8328.05"/>
<polygon fill="black" stroke="black" points="3043.5,-8327.91 3040,-8317.91 3036.5,-8327.91 3043.5,-8327.91"/>
</g>
<!-- l2_attn_stage1_gpu9&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge1514" class="edge">
<title>l2_attn_stage1_gpu9&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3093.28,-8397.3C3107.42,-8390.96 3122.95,-8385.16 3138,-8381.83 3198.65,-8368.42 4197.41,-8392.46 4256,-8371.83 4266.15,-8368.26 4265.3,-8361.48 4275,-8356.83 4289.39,-8349.94 4294.8,-8353.7 4310,-8348.83 4350.94,-8335.73 4395.95,-8316.57 4428.12,-8302.01"/>
<polygon fill="red" stroke="red" points="4429.61,-8305.17 4437.25,-8297.84 4426.7,-8298.81 4429.61,-8305.17"/>
<text text-anchor="middle" x="4306.5" y="-8360.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu10 -->
<g id="node379" class="node">
<title>l2_attn_stage2_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3235" cy="-8280.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3235" y="-8291.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="3235" y="-8276.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3235" y="-8261.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu10&#45;&gt;l2_attn_stage2_gpu10 -->
<g id="edge347" class="edge">
<title>l2_attn_stage1_gpu10&#45;&gt;l2_attn_stage2_gpu10</title>
<path fill="none" stroke="black" d="M3235,-8389.74C3235,-8371.02 3235,-8348.03 3235,-8328.05"/>
<polygon fill="black" stroke="black" points="3238.5,-8327.91 3235,-8317.91 3231.5,-8327.91 3238.5,-8327.91"/>
</g>
<!-- l2_attn_stage1_gpu10&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge1515" class="edge">
<title>l2_attn_stage1_gpu10&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3288.29,-8397.31C3302.42,-8390.97 3317.95,-8385.17 3333,-8381.83 3387.73,-8369.7 4289.13,-8390.48 4342,-8371.83 4352.15,-8368.25 4352.32,-8363.19 4361,-8356.83 4386.22,-8338.34 4415.5,-8318.49 4437.65,-8303.78"/>
<polygon fill="red" stroke="red" points="4439.66,-8306.65 4446.07,-8298.22 4435.8,-8300.81 4439.66,-8306.65"/>
<text text-anchor="middle" x="4392.5" y="-8360.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu11 -->
<g id="node380" class="node">
<title>l2_attn_stage2_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3430" cy="-8280.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3430" y="-8291.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="3430" y="-8276.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3430" y="-8261.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu11&#45;&gt;l2_attn_stage2_gpu11 -->
<g id="edge348" class="edge">
<title>l2_attn_stage1_gpu11&#45;&gt;l2_attn_stage2_gpu11</title>
<path fill="none" stroke="black" d="M3430,-8389.74C3430,-8371.02 3430,-8348.03 3430,-8328.05"/>
<polygon fill="black" stroke="black" points="3433.5,-8327.91 3430,-8317.91 3426.5,-8327.91 3433.5,-8327.91"/>
</g>
<!-- l2_attn_stage1_gpu11&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge1516" class="edge">
<title>l2_attn_stage1_gpu11&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3483.29,-8397.33C3497.42,-8390.99 3512.95,-8385.18 3528,-8381.83 3552.41,-8376.41 4406.88,-8385.21 4428,-8371.83 4449.94,-8357.93 4461.24,-8329.65 4466.85,-8308.39"/>
<polygon fill="red" stroke="red" points="4470.27,-8309.14 4469.18,-8298.6 4463.46,-8307.52 4470.27,-8309.14"/>
<text text-anchor="middle" x="4474.5" y="-8360.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu12 -->
<g id="node381" class="node">
<title>l2_attn_stage2_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3625" cy="-8280.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3625" y="-8291.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="3625" y="-8276.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3625" y="-8261.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu12&#45;&gt;l2_attn_stage2_gpu12 -->
<g id="edge349" class="edge">
<title>l2_attn_stage1_gpu12&#45;&gt;l2_attn_stage2_gpu12</title>
<path fill="none" stroke="black" d="M3569.85,-8397.87C3556.43,-8391.83 3541.93,-8386.03 3528,-8381.83 3514.22,-8377.68 3473.36,-8382.77 3464,-8371.83 3429.08,-8331.03 3469.79,-8371.15 3528,-8348.83 3545.78,-8342.01 3563.42,-8331.27 3578.68,-8320.34"/>
<polygon fill="black" stroke="black" points="3580.93,-8323.02 3586.9,-8314.27 3576.77,-8317.39 3580.93,-8323.02"/>
</g>
<!-- l2_attn_stage1_gpu12&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge1517" class="edge">
<title>l2_attn_stage1_gpu12&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3678.29,-8397.34C3692.43,-8391 3707.95,-8385.19 3723,-8381.83 3744.45,-8377.05 4498.56,-8387.47 4514,-8371.83 4532.16,-8353.44 4514.89,-8325.75 4497.31,-8305.84"/>
<polygon fill="red" stroke="red" points="4499.75,-8303.32 4490.38,-8298.37 4494.61,-8308.08 4499.75,-8303.32"/>
<text text-anchor="middle" x="4552.5" y="-8360.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu13 -->
<g id="node382" class="node">
<title>l2_attn_stage2_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3820" cy="-8280.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3820" y="-8291.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="3820" y="-8276.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3820" y="-8261.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu13&#45;&gt;l2_attn_stage2_gpu13 -->
<g id="edge350" class="edge">
<title>l2_attn_stage1_gpu13&#45;&gt;l2_attn_stage2_gpu13</title>
<path fill="none" stroke="black" d="M3766.7,-8397.39C3752.85,-8391.13 3737.69,-8385.35 3723,-8381.83 3709.37,-8378.57 3480.71,-8381.93 3471,-8371.83 3466.38,-8367.03 3466.36,-8361.62 3471,-8356.83 3480.75,-8346.77 3709.7,-8353.24 3723,-8348.83 3741.4,-8342.74 3759.44,-8331.94 3774.87,-8320.75"/>
<polygon fill="black" stroke="black" points="3777.27,-8323.33 3783.16,-8314.52 3773.06,-8317.73 3777.27,-8323.33"/>
</g>
<!-- l2_attn_stage1_gpu13&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge1518" class="edge">
<title>l2_attn_stage1_gpu13&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3873.3,-8397.36C3887.43,-8391.02 3902.96,-8385.2 3918,-8381.83 3936.49,-8377.69 4586.7,-8385.33 4600,-8371.83 4628.36,-8343.06 4580.79,-8317.22 4535.82,-8300.6"/>
<polygon fill="red" stroke="red" points="4536.88,-8297.26 4526.29,-8297.19 4534.53,-8303.85 4536.88,-8297.26"/>
<text text-anchor="middle" x="4639.5" y="-8360.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu14 -->
<g id="node383" class="node">
<title>l2_attn_stage2_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4015" cy="-8280.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4015" y="-8291.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="4015" y="-8276.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4015" y="-8261.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu14&#45;&gt;l2_attn_stage2_gpu14 -->
<g id="edge351" class="edge">
<title>l2_attn_stage1_gpu14&#45;&gt;l2_attn_stage2_gpu14</title>
<path fill="none" stroke="black" d="M3961.74,-8397.22C3947.89,-8390.96 3932.71,-8385.22 3918,-8381.83 3894.17,-8376.34 3495.09,-8389.32 3478,-8371.83 3473.34,-8367.06 3473.33,-8361.59 3478,-8356.83 3486.56,-8348.11 3906.37,-8352.6 3918,-8348.83 3936.45,-8342.86 3954.49,-8332.1 3969.92,-8320.9"/>
<polygon fill="black" stroke="black" points="3972.32,-8323.47 3978.2,-8314.66 3968.11,-8317.88 3972.32,-8323.47"/>
</g>
<!-- l2_attn_stage1_gpu14&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge1519" class="edge">
<title>l2_attn_stage1_gpu14&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4068.3,-8397.39C4082.44,-8391.05 4097.96,-8385.22 4113,-8381.83 4128.53,-8378.33 4674.84,-8383.19 4686,-8371.83 4726.03,-8331.09 4656.32,-8307.74 4586.01,-8294.99"/>
<polygon fill="red" stroke="red" points="4586.55,-8291.53 4576.1,-8293.26 4585.35,-8298.43 4586.55,-8291.53"/>
<text text-anchor="middle" x="4726.5" y="-8360.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage2_gpu15 -->
<g id="node384" class="node">
<title>l2_attn_stage2_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4210" cy="-8280.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4210" y="-8291.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage2</text>
<text text-anchor="middle" x="4210" y="-8276.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4210" y="-8261.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage1_gpu15&#45;&gt;l2_attn_stage2_gpu15 -->
<g id="edge352" class="edge">
<title>l2_attn_stage1_gpu15&#45;&gt;l2_attn_stage2_gpu15</title>
<path fill="none" stroke="black" d="M4157.02,-8397.26C4143.09,-8390.97 4127.82,-8385.19 4113,-8381.83 4095.99,-8377.97 3497.24,-8384.27 3485,-8371.83 3480.32,-8367.08 3480.32,-8361.58 3485,-8356.83 3497.26,-8344.42 4096.39,-8354.16 4113,-8348.83 4131.46,-8342.91 4149.51,-8332.16 4164.94,-8320.96"/>
<polygon fill="black" stroke="black" points="4167.34,-8323.53 4173.22,-8314.72 4163.13,-8317.94 4167.34,-8323.53"/>
</g>
<!-- l2_attn_stage1_gpu15&#45;&gt;l2_attn_stage2_gpu[next_gpu] -->
<g id="edge1520" class="edge">
<title>l2_attn_stage1_gpu15&#45;&gt;l2_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4265.38,-8398.02C4280.74,-8391.45 4297.68,-8385.36 4314,-8381.83 4338.87,-8376.45 4754.2,-8390.02 4772,-8371.83 4826.67,-8315.96 4725.45,-8294.29 4626.12,-8286.04"/>
<polygon fill="red" stroke="red" points="4626.15,-8282.53 4615.9,-8285.24 4625.6,-8289.51 4626.15,-8282.53"/>
<text text-anchor="middle" x="4812.5" y="-8360.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu0 -->
<g id="node385" class="node">
<title>l2_attn_stage3_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1285" cy="-8133.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1285" y="-8144.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="1285" y="-8129.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1285" y="-8114.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu0&#45;&gt;l2_attn_stage3_gpu0 -->
<g id="edge353" class="edge">
<title>l2_attn_stage2_gpu0&#45;&gt;l2_attn_stage3_gpu0</title>
<path fill="none" stroke="black" d="M1285,-8242.74C1285,-8224.02 1285,-8201.03 1285,-8181.05"/>
<polygon fill="black" stroke="black" points="1288.5,-8180.91 1285,-8170.91 1281.5,-8180.91 1288.5,-8180.91"/>
</g>
<!-- l2_attn_stage3_gpu[next_gpu] -->
<g id="node1330" class="node">
<title>l2_attn_stage3_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4472" cy="-8133.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4472" y="-8129.63" font-family="Times,serif" font-size="14.00">l2_attn_stage3_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage2_gpu0&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge1521" class="edge">
<title>l2_attn_stage2_gpu0&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1338.29,-8250.33C1352.43,-8243.99 1367.95,-8238.18 1383,-8234.83 1612.73,-8183.7 3265.66,-8212.38 3501,-8209.83 3545.94,-8209.34 4265.97,-8210.86 4310,-8201.83 4353.87,-8192.83 4400.77,-8171.91 4432.76,-8155.73"/>
<polygon fill="red" stroke="red" points="4434.49,-8158.78 4441.78,-8151.09 4431.28,-8152.55 4434.49,-8158.78"/>
<text text-anchor="middle" x="3532.5" y="-8213.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu1 -->
<g id="node386" class="node">
<title>l2_attn_stage3_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1480" cy="-8133.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1480" y="-8144.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="1480" y="-8129.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1480" y="-8114.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu1&#45;&gt;l2_attn_stage3_gpu1 -->
<g id="edge354" class="edge">
<title>l2_attn_stage2_gpu1&#45;&gt;l2_attn_stage3_gpu1</title>
<path fill="none" stroke="black" d="M1480,-8242.74C1480,-8224.02 1480,-8201.03 1480,-8181.05"/>
<polygon fill="black" stroke="black" points="1483.5,-8180.91 1480,-8170.91 1476.5,-8180.91 1483.5,-8180.91"/>
</g>
<!-- l2_attn_stage2_gpu1&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge1522" class="edge">
<title>l2_attn_stage2_gpu1&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1533.28,-8250.26C1547.41,-8243.92 1562.94,-8238.13 1578,-8234.83 1632,-8223 3515.82,-8243.09 3568,-8224.83 3578.15,-8221.28 3576.86,-8213.42 3587,-8209.83 3624.87,-8196.45 4270.66,-8209.93 4310,-8201.83 4353.87,-8192.81 4400.77,-8171.89 4432.76,-8155.72"/>
<polygon fill="red" stroke="red" points="4434.48,-8158.76 4441.78,-8151.08 4431.28,-8152.54 4434.48,-8158.76"/>
<text text-anchor="middle" x="3618.5" y="-8213.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu2 -->
<g id="node387" class="node">
<title>l2_attn_stage3_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1675" cy="-8133.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1675" y="-8144.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="1675" y="-8129.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1675" y="-8114.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu2&#45;&gt;l2_attn_stage3_gpu2 -->
<g id="edge355" class="edge">
<title>l2_attn_stage2_gpu2&#45;&gt;l2_attn_stage3_gpu2</title>
<path fill="none" stroke="black" d="M1675,-8242.74C1675,-8224.02 1675,-8201.03 1675,-8181.05"/>
<polygon fill="black" stroke="black" points="1678.5,-8180.91 1675,-8170.91 1671.5,-8180.91 1678.5,-8180.91"/>
</g>
<!-- l2_attn_stage2_gpu2&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge1523" class="edge">
<title>l2_attn_stage2_gpu2&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1728.28,-8250.27C1742.41,-8243.93 1757.94,-8238.13 1773,-8234.83 1824.04,-8223.64 3604.68,-8242.1 3654,-8224.83 3664.15,-8221.28 3662.86,-8213.42 3673,-8209.83 3706.36,-8198.01 4275.34,-8208.99 4310,-8201.83 4353.86,-8192.77 4400.76,-8171.86 4432.75,-8155.7"/>
<polygon fill="red" stroke="red" points="4434.48,-8158.75 4441.77,-8151.07 4431.28,-8152.52 4434.48,-8158.75"/>
<text text-anchor="middle" x="3704.5" y="-8213.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu3 -->
<g id="node388" class="node">
<title>l2_attn_stage3_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1870" cy="-8133.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1870" y="-8144.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="1870" y="-8129.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1870" y="-8114.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu3&#45;&gt;l2_attn_stage3_gpu3 -->
<g id="edge356" class="edge">
<title>l2_attn_stage2_gpu3&#45;&gt;l2_attn_stage3_gpu3</title>
<path fill="none" stroke="black" d="M1870,-8242.74C1870,-8224.02 1870,-8201.03 1870,-8181.05"/>
<polygon fill="black" stroke="black" points="1873.5,-8180.91 1870,-8170.91 1866.5,-8180.91 1873.5,-8180.91"/>
</g>
<!-- l2_attn_stage2_gpu3&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge1524" class="edge">
<title>l2_attn_stage2_gpu3&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1923.28,-8250.27C1937.41,-8243.93 1952.94,-8238.13 1968,-8234.83 2016.08,-8224.28 3693.55,-8241.11 3740,-8224.83 3750.15,-8221.27 3748.86,-8213.43 3759,-8209.83 3787.85,-8199.58 4280.02,-8208.05 4310,-8201.83 4353.85,-8192.73 4400.75,-8171.83 4432.75,-8155.67"/>
<polygon fill="red" stroke="red" points="4434.47,-8158.73 4441.77,-8151.05 4431.27,-8152.5 4434.47,-8158.73"/>
<text text-anchor="middle" x="3790.5" y="-8213.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu4 -->
<g id="node389" class="node">
<title>l2_attn_stage3_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2065" cy="-8133.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2065" y="-8144.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="2065" y="-8129.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2065" y="-8114.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu4&#45;&gt;l2_attn_stage3_gpu4 -->
<g id="edge357" class="edge">
<title>l2_attn_stage2_gpu4&#45;&gt;l2_attn_stage3_gpu4</title>
<path fill="none" stroke="black" d="M2065,-8242.74C2065,-8224.02 2065,-8201.03 2065,-8181.05"/>
<polygon fill="black" stroke="black" points="2068.5,-8180.91 2065,-8170.91 2061.5,-8180.91 2068.5,-8180.91"/>
</g>
<!-- l2_attn_stage2_gpu4&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge1525" class="edge">
<title>l2_attn_stage2_gpu4&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2118.28,-8250.27C2132.41,-8243.93 2147.94,-8238.14 2163,-8234.83 2208.12,-8224.93 3782.41,-8240.11 3826,-8224.83 3836.15,-8221.27 3834.87,-8213.45 3845,-8209.83 3893.67,-8192.47 4259.42,-8212.4 4310,-8201.83 4353.84,-8192.67 4400.74,-8171.78 4432.74,-8155.64"/>
<polygon fill="red" stroke="red" points="4434.46,-8158.7 4441.76,-8151.02 4431.27,-8152.47 4434.46,-8158.7"/>
<text text-anchor="middle" x="3876.5" y="-8213.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu5 -->
<g id="node390" class="node">
<title>l2_attn_stage3_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2260" cy="-8133.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2260" y="-8144.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="2260" y="-8129.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2260" y="-8114.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu5&#45;&gt;l2_attn_stage3_gpu5 -->
<g id="edge358" class="edge">
<title>l2_attn_stage2_gpu5&#45;&gt;l2_attn_stage3_gpu5</title>
<path fill="none" stroke="black" d="M2260,-8242.74C2260,-8224.02 2260,-8201.03 2260,-8181.05"/>
<polygon fill="black" stroke="black" points="2263.5,-8180.91 2260,-8170.91 2256.5,-8180.91 2263.5,-8180.91"/>
</g>
<!-- l2_attn_stage2_gpu5&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge1526" class="edge">
<title>l2_attn_stage2_gpu5&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2313.28,-8250.28C2327.41,-8243.94 2342.94,-8238.14 2358,-8234.83 2400.16,-8225.57 3871.27,-8239.12 3912,-8224.83 3922.15,-8221.27 3920.87,-8213.47 3931,-8209.83 3970.64,-8195.6 4268.79,-8210.53 4310,-8201.83 4353.82,-8192.59 4400.73,-8171.7 4432.73,-8155.6"/>
<polygon fill="red" stroke="red" points="4434.45,-8158.65 4441.75,-8150.98 4431.26,-8152.42 4434.45,-8158.65"/>
<text text-anchor="middle" x="3962.5" y="-8213.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu6 -->
<g id="node391" class="node">
<title>l2_attn_stage3_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2455" cy="-8133.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2455" y="-8144.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="2455" y="-8129.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2455" y="-8114.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu6&#45;&gt;l2_attn_stage3_gpu6 -->
<g id="edge359" class="edge">
<title>l2_attn_stage2_gpu6&#45;&gt;l2_attn_stage3_gpu6</title>
<path fill="none" stroke="black" d="M2455,-8242.74C2455,-8224.02 2455,-8201.03 2455,-8181.05"/>
<polygon fill="black" stroke="black" points="2458.5,-8180.91 2455,-8170.91 2451.5,-8180.91 2458.5,-8180.91"/>
</g>
<!-- l2_attn_stage2_gpu6&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge1527" class="edge">
<title>l2_attn_stage2_gpu6&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2508.28,-8250.28C2522.41,-8243.94 2537.94,-8238.14 2553,-8234.83 2592.2,-8226.21 3960.13,-8238.13 3998,-8224.83 4008.15,-8221.27 4006.89,-8213.5 4017,-8209.83 4047.62,-8198.73 4278.15,-8208.65 4310,-8201.83 4353.66,-8192.48 4400.41,-8171.72 4432.42,-8155.67"/>
<polygon fill="red" stroke="red" points="4434.12,-8158.73 4441.45,-8151.07 4430.95,-8152.49 4434.12,-8158.73"/>
<text text-anchor="middle" x="4048.5" y="-8213.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu7 -->
<g id="node392" class="node">
<title>l2_attn_stage3_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2650" cy="-8133.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2650" y="-8144.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="2650" y="-8129.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2650" y="-8114.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu7&#45;&gt;l2_attn_stage3_gpu7 -->
<g id="edge360" class="edge">
<title>l2_attn_stage2_gpu7&#45;&gt;l2_attn_stage3_gpu7</title>
<path fill="none" stroke="black" d="M2650,-8242.74C2650,-8224.02 2650,-8201.03 2650,-8181.05"/>
<polygon fill="black" stroke="black" points="2653.5,-8180.91 2650,-8170.91 2646.5,-8180.91 2653.5,-8180.91"/>
</g>
<!-- l2_attn_stage2_gpu7&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge1528" class="edge">
<title>l2_attn_stage2_gpu7&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2703.28,-8250.29C2717.42,-8243.95 2732.95,-8238.15 2748,-8234.83 2784.24,-8226.85 4048.99,-8237.13 4084,-8224.83 4094.15,-8221.27 4092.91,-8213.56 4103,-8209.83 4146.19,-8193.9 4265.04,-8211.73 4310,-8201.83 4353.6,-8192.23 4400.37,-8171.51 4432.39,-8155.54"/>
<polygon fill="red" stroke="red" points="4434.08,-8158.6 4441.42,-8150.96 4430.92,-8152.36 4434.08,-8158.6"/>
<text text-anchor="middle" x="4134.5" y="-8213.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu8 -->
<g id="node393" class="node">
<title>l2_attn_stage3_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2845" cy="-8133.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2845" y="-8144.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="2845" y="-8129.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2845" y="-8114.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu8&#45;&gt;l2_attn_stage3_gpu8 -->
<g id="edge361" class="edge">
<title>l2_attn_stage2_gpu8&#45;&gt;l2_attn_stage3_gpu8</title>
<path fill="none" stroke="black" d="M2845,-8242.74C2845,-8224.02 2845,-8201.03 2845,-8181.05"/>
<polygon fill="black" stroke="black" points="2848.5,-8180.91 2845,-8170.91 2841.5,-8180.91 2848.5,-8180.91"/>
</g>
<!-- l2_attn_stage2_gpu8&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge1529" class="edge">
<title>l2_attn_stage2_gpu8&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2898.28,-8250.3C2912.42,-8243.96 2927.95,-8238.15 2943,-8234.83 3009.57,-8220.14 4105.69,-8247.45 4170,-8224.83 4180.15,-8221.26 4178.96,-8213.69 4189,-8209.83 4239.3,-8190.49 4257.53,-8214.14 4310,-8201.83 4353.2,-8191.7 4399.67,-8171.25 4431.71,-8155.5"/>
<polygon fill="red" stroke="red" points="4433.38,-8158.59 4440.77,-8150.99 4430.25,-8152.32 4433.38,-8158.59"/>
<text text-anchor="middle" x="4220.5" y="-8213.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu9 -->
<g id="node394" class="node">
<title>l2_attn_stage3_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3040" cy="-8133.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3040" y="-8144.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="3040" y="-8129.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3040" y="-8114.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu9&#45;&gt;l2_attn_stage3_gpu9 -->
<g id="edge362" class="edge">
<title>l2_attn_stage2_gpu9&#45;&gt;l2_attn_stage3_gpu9</title>
<path fill="none" stroke="black" d="M3040,-8242.74C3040,-8224.02 3040,-8201.03 3040,-8181.05"/>
<polygon fill="black" stroke="black" points="3043.5,-8180.91 3040,-8170.91 3036.5,-8180.91 3043.5,-8180.91"/>
</g>
<!-- l2_attn_stage2_gpu9&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge1530" class="edge">
<title>l2_attn_stage2_gpu9&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3093.28,-8250.3C3107.42,-8243.96 3122.95,-8238.16 3138,-8234.83 3198.65,-8221.42 4197.41,-8245.46 4256,-8224.83 4266.15,-8221.26 4265.3,-8214.48 4275,-8209.83 4289.39,-8202.94 4294.8,-8206.7 4310,-8201.83 4350.94,-8188.73 4395.95,-8169.57 4428.12,-8155.01"/>
<polygon fill="red" stroke="red" points="4429.61,-8158.17 4437.25,-8150.84 4426.7,-8151.81 4429.61,-8158.17"/>
<text text-anchor="middle" x="4306.5" y="-8213.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu10 -->
<g id="node395" class="node">
<title>l2_attn_stage3_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3235" cy="-8133.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3235" y="-8144.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="3235" y="-8129.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3235" y="-8114.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu10&#45;&gt;l2_attn_stage3_gpu10 -->
<g id="edge363" class="edge">
<title>l2_attn_stage2_gpu10&#45;&gt;l2_attn_stage3_gpu10</title>
<path fill="none" stroke="black" d="M3235,-8242.74C3235,-8224.02 3235,-8201.03 3235,-8181.05"/>
<polygon fill="black" stroke="black" points="3238.5,-8180.91 3235,-8170.91 3231.5,-8180.91 3238.5,-8180.91"/>
</g>
<!-- l2_attn_stage2_gpu10&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge1531" class="edge">
<title>l2_attn_stage2_gpu10&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3288.29,-8250.31C3302.42,-8243.97 3317.95,-8238.17 3333,-8234.83 3387.73,-8222.7 4289.13,-8243.48 4342,-8224.83 4352.15,-8221.25 4352.32,-8216.19 4361,-8209.83 4386.22,-8191.34 4415.5,-8171.49 4437.65,-8156.78"/>
<polygon fill="red" stroke="red" points="4439.66,-8159.65 4446.07,-8151.22 4435.8,-8153.81 4439.66,-8159.65"/>
<text text-anchor="middle" x="4392.5" y="-8213.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu11 -->
<g id="node396" class="node">
<title>l2_attn_stage3_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3430" cy="-8133.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3430" y="-8144.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="3430" y="-8129.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3430" y="-8114.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu11&#45;&gt;l2_attn_stage3_gpu11 -->
<g id="edge364" class="edge">
<title>l2_attn_stage2_gpu11&#45;&gt;l2_attn_stage3_gpu11</title>
<path fill="none" stroke="black" d="M3430,-8242.74C3430,-8224.02 3430,-8201.03 3430,-8181.05"/>
<polygon fill="black" stroke="black" points="3433.5,-8180.91 3430,-8170.91 3426.5,-8180.91 3433.5,-8180.91"/>
</g>
<!-- l2_attn_stage2_gpu11&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge1532" class="edge">
<title>l2_attn_stage2_gpu11&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3483.29,-8250.33C3497.42,-8243.99 3512.95,-8238.18 3528,-8234.83 3552.41,-8229.41 4406.88,-8238.21 4428,-8224.83 4449.94,-8210.93 4461.24,-8182.65 4466.85,-8161.39"/>
<polygon fill="red" stroke="red" points="4470.27,-8162.14 4469.18,-8151.6 4463.46,-8160.52 4470.27,-8162.14"/>
<text text-anchor="middle" x="4474.5" y="-8213.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu12 -->
<g id="node397" class="node">
<title>l2_attn_stage3_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3625" cy="-8133.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3625" y="-8144.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="3625" y="-8129.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3625" y="-8114.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu12&#45;&gt;l2_attn_stage3_gpu12 -->
<g id="edge365" class="edge">
<title>l2_attn_stage2_gpu12&#45;&gt;l2_attn_stage3_gpu12</title>
<path fill="none" stroke="black" d="M3569.85,-8250.87C3556.43,-8244.83 3541.93,-8239.03 3528,-8234.83 3514.22,-8230.68 3473.36,-8235.77 3464,-8224.83 3429.08,-8184.03 3469.79,-8224.15 3528,-8201.83 3545.78,-8195.01 3563.42,-8184.27 3578.68,-8173.34"/>
<polygon fill="black" stroke="black" points="3580.93,-8176.02 3586.9,-8167.27 3576.77,-8170.39 3580.93,-8176.02"/>
</g>
<!-- l2_attn_stage2_gpu12&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge1533" class="edge">
<title>l2_attn_stage2_gpu12&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3678.29,-8250.34C3692.43,-8244 3707.95,-8238.19 3723,-8234.83 3744.45,-8230.05 4498.56,-8240.47 4514,-8224.83 4532.16,-8206.44 4514.89,-8178.75 4497.31,-8158.84"/>
<polygon fill="red" stroke="red" points="4499.75,-8156.32 4490.38,-8151.37 4494.61,-8161.08 4499.75,-8156.32"/>
<text text-anchor="middle" x="4552.5" y="-8213.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu13 -->
<g id="node398" class="node">
<title>l2_attn_stage3_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3820" cy="-8133.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3820" y="-8144.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="3820" y="-8129.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3820" y="-8114.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu13&#45;&gt;l2_attn_stage3_gpu13 -->
<g id="edge366" class="edge">
<title>l2_attn_stage2_gpu13&#45;&gt;l2_attn_stage3_gpu13</title>
<path fill="none" stroke="black" d="M3766.7,-8250.39C3752.85,-8244.13 3737.69,-8238.35 3723,-8234.83 3709.37,-8231.57 3480.71,-8234.93 3471,-8224.83 3466.38,-8220.03 3466.36,-8214.62 3471,-8209.83 3480.75,-8199.77 3709.7,-8206.24 3723,-8201.83 3741.4,-8195.74 3759.44,-8184.94 3774.87,-8173.75"/>
<polygon fill="black" stroke="black" points="3777.27,-8176.33 3783.16,-8167.52 3773.06,-8170.73 3777.27,-8176.33"/>
</g>
<!-- l2_attn_stage2_gpu13&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge1534" class="edge">
<title>l2_attn_stage2_gpu13&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3873.3,-8250.36C3887.43,-8244.02 3902.96,-8238.2 3918,-8234.83 3936.49,-8230.69 4586.7,-8238.33 4600,-8224.83 4628.36,-8196.06 4580.79,-8170.22 4535.82,-8153.6"/>
<polygon fill="red" stroke="red" points="4536.88,-8150.26 4526.29,-8150.19 4534.53,-8156.85 4536.88,-8150.26"/>
<text text-anchor="middle" x="4639.5" y="-8213.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu14 -->
<g id="node399" class="node">
<title>l2_attn_stage3_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4015" cy="-8133.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4015" y="-8144.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="4015" y="-8129.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4015" y="-8114.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu14&#45;&gt;l2_attn_stage3_gpu14 -->
<g id="edge367" class="edge">
<title>l2_attn_stage2_gpu14&#45;&gt;l2_attn_stage3_gpu14</title>
<path fill="none" stroke="black" d="M3961.74,-8250.22C3947.89,-8243.96 3932.71,-8238.22 3918,-8234.83 3894.17,-8229.34 3495.09,-8242.32 3478,-8224.83 3473.34,-8220.06 3473.33,-8214.59 3478,-8209.83 3486.56,-8201.11 3906.37,-8205.6 3918,-8201.83 3936.45,-8195.86 3954.49,-8185.1 3969.92,-8173.9"/>
<polygon fill="black" stroke="black" points="3972.32,-8176.47 3978.2,-8167.66 3968.11,-8170.88 3972.32,-8176.47"/>
</g>
<!-- l2_attn_stage2_gpu14&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge1535" class="edge">
<title>l2_attn_stage2_gpu14&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4068.3,-8250.39C4082.44,-8244.05 4097.96,-8238.22 4113,-8234.83 4128.53,-8231.33 4674.84,-8236.19 4686,-8224.83 4726.03,-8184.09 4656.32,-8160.74 4586.01,-8147.99"/>
<polygon fill="red" stroke="red" points="4586.55,-8144.53 4576.1,-8146.26 4585.35,-8151.43 4586.55,-8144.53"/>
<text text-anchor="middle" x="4726.5" y="-8213.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage3_gpu15 -->
<g id="node400" class="node">
<title>l2_attn_stage3_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4210" cy="-8133.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4210" y="-8144.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage3</text>
<text text-anchor="middle" x="4210" y="-8129.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4210" y="-8114.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage2_gpu15&#45;&gt;l2_attn_stage3_gpu15 -->
<g id="edge368" class="edge">
<title>l2_attn_stage2_gpu15&#45;&gt;l2_attn_stage3_gpu15</title>
<path fill="none" stroke="black" d="M4157.02,-8250.26C4143.09,-8243.97 4127.82,-8238.19 4113,-8234.83 4095.99,-8230.97 3497.24,-8237.27 3485,-8224.83 3480.32,-8220.08 3480.32,-8214.58 3485,-8209.83 3497.26,-8197.42 4096.39,-8207.16 4113,-8201.83 4131.46,-8195.91 4149.51,-8185.16 4164.94,-8173.96"/>
<polygon fill="black" stroke="black" points="4167.34,-8176.53 4173.22,-8167.72 4163.13,-8170.94 4167.34,-8176.53"/>
</g>
<!-- l2_attn_stage2_gpu15&#45;&gt;l2_attn_stage3_gpu[next_gpu] -->
<g id="edge1536" class="edge">
<title>l2_attn_stage2_gpu15&#45;&gt;l2_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4265.38,-8251.02C4280.74,-8244.45 4297.68,-8238.36 4314,-8234.83 4338.87,-8229.45 4754.2,-8243.02 4772,-8224.83 4826.67,-8168.96 4725.45,-8147.29 4626.12,-8139.04"/>
<polygon fill="red" stroke="red" points="4626.15,-8135.53 4615.9,-8138.24 4625.6,-8142.51 4626.15,-8135.53"/>
<text text-anchor="middle" x="4812.5" y="-8213.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu0 -->
<g id="node401" class="node">
<title>l2_attn_stage4_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1285" cy="-7986.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1285" y="-7997.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="1285" y="-7982.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1285" y="-7967.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu0&#45;&gt;l2_attn_stage4_gpu0 -->
<g id="edge369" class="edge">
<title>l2_attn_stage3_gpu0&#45;&gt;l2_attn_stage4_gpu0</title>
<path fill="none" stroke="black" d="M1285,-8095.74C1285,-8077.02 1285,-8054.03 1285,-8034.05"/>
<polygon fill="black" stroke="black" points="1288.5,-8033.91 1285,-8023.91 1281.5,-8033.91 1288.5,-8033.91"/>
</g>
<!-- l2_attn_stage4_gpu[next_gpu] -->
<g id="node1331" class="node">
<title>l2_attn_stage4_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4472" cy="-7986.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4472" y="-7982.63" font-family="Times,serif" font-size="14.00">l2_attn_stage4_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage3_gpu0&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge1537" class="edge">
<title>l2_attn_stage3_gpu0&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1338.29,-8103.33C1352.43,-8096.99 1367.95,-8091.18 1383,-8087.83 1612.73,-8036.7 3265.66,-8065.38 3501,-8062.83 3545.94,-8062.34 4265.97,-8063.86 4310,-8054.83 4353.87,-8045.83 4400.77,-8024.91 4432.76,-8008.73"/>
<polygon fill="red" stroke="red" points="4434.49,-8011.78 4441.78,-8004.09 4431.28,-8005.55 4434.49,-8011.78"/>
<text text-anchor="middle" x="3532.5" y="-8066.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu1 -->
<g id="node402" class="node">
<title>l2_attn_stage4_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1480" cy="-7986.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1480" y="-7997.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="1480" y="-7982.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1480" y="-7967.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu1&#45;&gt;l2_attn_stage4_gpu1 -->
<g id="edge370" class="edge">
<title>l2_attn_stage3_gpu1&#45;&gt;l2_attn_stage4_gpu1</title>
<path fill="none" stroke="black" d="M1480,-8095.74C1480,-8077.02 1480,-8054.03 1480,-8034.05"/>
<polygon fill="black" stroke="black" points="1483.5,-8033.91 1480,-8023.91 1476.5,-8033.91 1483.5,-8033.91"/>
</g>
<!-- l2_attn_stage3_gpu1&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge1538" class="edge">
<title>l2_attn_stage3_gpu1&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1533.28,-8103.26C1547.41,-8096.92 1562.94,-8091.13 1578,-8087.83 1632,-8076 3515.82,-8096.09 3568,-8077.83 3578.15,-8074.28 3576.86,-8066.42 3587,-8062.83 3624.87,-8049.45 4270.66,-8062.93 4310,-8054.83 4353.87,-8045.81 4400.77,-8024.89 4432.76,-8008.72"/>
<polygon fill="red" stroke="red" points="4434.48,-8011.76 4441.78,-8004.08 4431.28,-8005.54 4434.48,-8011.76"/>
<text text-anchor="middle" x="3618.5" y="-8066.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu2 -->
<g id="node403" class="node">
<title>l2_attn_stage4_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1675" cy="-7986.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1675" y="-7997.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="1675" y="-7982.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1675" y="-7967.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu2&#45;&gt;l2_attn_stage4_gpu2 -->
<g id="edge371" class="edge">
<title>l2_attn_stage3_gpu2&#45;&gt;l2_attn_stage4_gpu2</title>
<path fill="none" stroke="black" d="M1675,-8095.74C1675,-8077.02 1675,-8054.03 1675,-8034.05"/>
<polygon fill="black" stroke="black" points="1678.5,-8033.91 1675,-8023.91 1671.5,-8033.91 1678.5,-8033.91"/>
</g>
<!-- l2_attn_stage3_gpu2&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge1539" class="edge">
<title>l2_attn_stage3_gpu2&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1728.28,-8103.27C1742.41,-8096.93 1757.94,-8091.13 1773,-8087.83 1824.04,-8076.64 3604.68,-8095.1 3654,-8077.83 3664.15,-8074.28 3662.86,-8066.42 3673,-8062.83 3706.36,-8051.01 4275.34,-8061.99 4310,-8054.83 4353.86,-8045.77 4400.76,-8024.86 4432.75,-8008.7"/>
<polygon fill="red" stroke="red" points="4434.48,-8011.75 4441.77,-8004.07 4431.28,-8005.52 4434.48,-8011.75"/>
<text text-anchor="middle" x="3704.5" y="-8066.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu3 -->
<g id="node404" class="node">
<title>l2_attn_stage4_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1870" cy="-7986.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1870" y="-7997.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="1870" y="-7982.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1870" y="-7967.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu3&#45;&gt;l2_attn_stage4_gpu3 -->
<g id="edge372" class="edge">
<title>l2_attn_stage3_gpu3&#45;&gt;l2_attn_stage4_gpu3</title>
<path fill="none" stroke="black" d="M1870,-8095.74C1870,-8077.02 1870,-8054.03 1870,-8034.05"/>
<polygon fill="black" stroke="black" points="1873.5,-8033.91 1870,-8023.91 1866.5,-8033.91 1873.5,-8033.91"/>
</g>
<!-- l2_attn_stage3_gpu3&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge1540" class="edge">
<title>l2_attn_stage3_gpu3&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1923.28,-8103.27C1937.41,-8096.93 1952.94,-8091.13 1968,-8087.83 2016.08,-8077.28 3693.55,-8094.11 3740,-8077.83 3750.15,-8074.27 3748.86,-8066.43 3759,-8062.83 3787.85,-8052.58 4280.02,-8061.05 4310,-8054.83 4353.85,-8045.73 4400.75,-8024.83 4432.75,-8008.67"/>
<polygon fill="red" stroke="red" points="4434.47,-8011.73 4441.77,-8004.05 4431.27,-8005.5 4434.47,-8011.73"/>
<text text-anchor="middle" x="3790.5" y="-8066.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu4 -->
<g id="node405" class="node">
<title>l2_attn_stage4_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2065" cy="-7986.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2065" y="-7997.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="2065" y="-7982.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2065" y="-7967.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu4&#45;&gt;l2_attn_stage4_gpu4 -->
<g id="edge373" class="edge">
<title>l2_attn_stage3_gpu4&#45;&gt;l2_attn_stage4_gpu4</title>
<path fill="none" stroke="black" d="M2065,-8095.74C2065,-8077.02 2065,-8054.03 2065,-8034.05"/>
<polygon fill="black" stroke="black" points="2068.5,-8033.91 2065,-8023.91 2061.5,-8033.91 2068.5,-8033.91"/>
</g>
<!-- l2_attn_stage3_gpu4&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge1541" class="edge">
<title>l2_attn_stage3_gpu4&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2118.28,-8103.27C2132.41,-8096.93 2147.94,-8091.14 2163,-8087.83 2208.12,-8077.93 3782.41,-8093.11 3826,-8077.83 3836.15,-8074.27 3834.87,-8066.45 3845,-8062.83 3893.67,-8045.47 4259.42,-8065.4 4310,-8054.83 4353.84,-8045.67 4400.74,-8024.78 4432.74,-8008.64"/>
<polygon fill="red" stroke="red" points="4434.46,-8011.7 4441.76,-8004.02 4431.27,-8005.47 4434.46,-8011.7"/>
<text text-anchor="middle" x="3876.5" y="-8066.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu5 -->
<g id="node406" class="node">
<title>l2_attn_stage4_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2260" cy="-7986.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2260" y="-7997.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="2260" y="-7982.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2260" y="-7967.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu5&#45;&gt;l2_attn_stage4_gpu5 -->
<g id="edge374" class="edge">
<title>l2_attn_stage3_gpu5&#45;&gt;l2_attn_stage4_gpu5</title>
<path fill="none" stroke="black" d="M2260,-8095.74C2260,-8077.02 2260,-8054.03 2260,-8034.05"/>
<polygon fill="black" stroke="black" points="2263.5,-8033.91 2260,-8023.91 2256.5,-8033.91 2263.5,-8033.91"/>
</g>
<!-- l2_attn_stage3_gpu5&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge1542" class="edge">
<title>l2_attn_stage3_gpu5&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2313.28,-8103.28C2327.41,-8096.94 2342.94,-8091.14 2358,-8087.83 2400.16,-8078.57 3871.27,-8092.12 3912,-8077.83 3922.15,-8074.27 3920.87,-8066.47 3931,-8062.83 3970.64,-8048.6 4268.79,-8063.53 4310,-8054.83 4353.82,-8045.59 4400.73,-8024.7 4432.73,-8008.6"/>
<polygon fill="red" stroke="red" points="4434.45,-8011.65 4441.75,-8003.98 4431.26,-8005.42 4434.45,-8011.65"/>
<text text-anchor="middle" x="3962.5" y="-8066.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu6 -->
<g id="node407" class="node">
<title>l2_attn_stage4_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2455" cy="-7986.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2455" y="-7997.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="2455" y="-7982.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2455" y="-7967.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu6&#45;&gt;l2_attn_stage4_gpu6 -->
<g id="edge375" class="edge">
<title>l2_attn_stage3_gpu6&#45;&gt;l2_attn_stage4_gpu6</title>
<path fill="none" stroke="black" d="M2455,-8095.74C2455,-8077.02 2455,-8054.03 2455,-8034.05"/>
<polygon fill="black" stroke="black" points="2458.5,-8033.91 2455,-8023.91 2451.5,-8033.91 2458.5,-8033.91"/>
</g>
<!-- l2_attn_stage3_gpu6&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge1543" class="edge">
<title>l2_attn_stage3_gpu6&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2508.28,-8103.28C2522.41,-8096.94 2537.94,-8091.14 2553,-8087.83 2592.2,-8079.21 3960.13,-8091.13 3998,-8077.83 4008.15,-8074.27 4006.89,-8066.5 4017,-8062.83 4047.62,-8051.73 4278.15,-8061.65 4310,-8054.83 4353.66,-8045.48 4400.41,-8024.72 4432.42,-8008.67"/>
<polygon fill="red" stroke="red" points="4434.12,-8011.73 4441.45,-8004.07 4430.95,-8005.49 4434.12,-8011.73"/>
<text text-anchor="middle" x="4048.5" y="-8066.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu7 -->
<g id="node408" class="node">
<title>l2_attn_stage4_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2650" cy="-7986.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2650" y="-7997.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="2650" y="-7982.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2650" y="-7967.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu7&#45;&gt;l2_attn_stage4_gpu7 -->
<g id="edge376" class="edge">
<title>l2_attn_stage3_gpu7&#45;&gt;l2_attn_stage4_gpu7</title>
<path fill="none" stroke="black" d="M2650,-8095.74C2650,-8077.02 2650,-8054.03 2650,-8034.05"/>
<polygon fill="black" stroke="black" points="2653.5,-8033.91 2650,-8023.91 2646.5,-8033.91 2653.5,-8033.91"/>
</g>
<!-- l2_attn_stage3_gpu7&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge1544" class="edge">
<title>l2_attn_stage3_gpu7&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2703.28,-8103.29C2717.42,-8096.95 2732.95,-8091.15 2748,-8087.83 2784.24,-8079.85 4048.99,-8090.13 4084,-8077.83 4094.15,-8074.27 4092.91,-8066.56 4103,-8062.83 4146.19,-8046.9 4265.04,-8064.73 4310,-8054.83 4353.6,-8045.23 4400.37,-8024.51 4432.39,-8008.54"/>
<polygon fill="red" stroke="red" points="4434.08,-8011.6 4441.42,-8003.96 4430.92,-8005.36 4434.08,-8011.6"/>
<text text-anchor="middle" x="4134.5" y="-8066.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu8 -->
<g id="node409" class="node">
<title>l2_attn_stage4_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2845" cy="-7986.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2845" y="-7997.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="2845" y="-7982.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2845" y="-7967.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu8&#45;&gt;l2_attn_stage4_gpu8 -->
<g id="edge377" class="edge">
<title>l2_attn_stage3_gpu8&#45;&gt;l2_attn_stage4_gpu8</title>
<path fill="none" stroke="black" d="M2845,-8095.74C2845,-8077.02 2845,-8054.03 2845,-8034.05"/>
<polygon fill="black" stroke="black" points="2848.5,-8033.91 2845,-8023.91 2841.5,-8033.91 2848.5,-8033.91"/>
</g>
<!-- l2_attn_stage3_gpu8&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge1545" class="edge">
<title>l2_attn_stage3_gpu8&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2898.28,-8103.3C2912.42,-8096.96 2927.95,-8091.15 2943,-8087.83 3009.57,-8073.14 4105.69,-8100.45 4170,-8077.83 4180.15,-8074.26 4178.96,-8066.69 4189,-8062.83 4239.3,-8043.49 4257.53,-8067.14 4310,-8054.83 4353.2,-8044.7 4399.67,-8024.25 4431.71,-8008.5"/>
<polygon fill="red" stroke="red" points="4433.38,-8011.59 4440.77,-8003.99 4430.25,-8005.32 4433.38,-8011.59"/>
<text text-anchor="middle" x="4220.5" y="-8066.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu9 -->
<g id="node410" class="node">
<title>l2_attn_stage4_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3040" cy="-7986.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3040" y="-7997.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="3040" y="-7982.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3040" y="-7967.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu9&#45;&gt;l2_attn_stage4_gpu9 -->
<g id="edge378" class="edge">
<title>l2_attn_stage3_gpu9&#45;&gt;l2_attn_stage4_gpu9</title>
<path fill="none" stroke="black" d="M3040,-8095.74C3040,-8077.02 3040,-8054.03 3040,-8034.05"/>
<polygon fill="black" stroke="black" points="3043.5,-8033.91 3040,-8023.91 3036.5,-8033.91 3043.5,-8033.91"/>
</g>
<!-- l2_attn_stage3_gpu9&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge1546" class="edge">
<title>l2_attn_stage3_gpu9&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3093.28,-8103.3C3107.42,-8096.96 3122.95,-8091.16 3138,-8087.83 3198.65,-8074.42 4197.41,-8098.46 4256,-8077.83 4266.15,-8074.26 4265.3,-8067.48 4275,-8062.83 4289.39,-8055.94 4294.8,-8059.7 4310,-8054.83 4350.94,-8041.73 4395.95,-8022.57 4428.12,-8008.01"/>
<polygon fill="red" stroke="red" points="4429.61,-8011.17 4437.25,-8003.84 4426.7,-8004.81 4429.61,-8011.17"/>
<text text-anchor="middle" x="4306.5" y="-8066.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu10 -->
<g id="node411" class="node">
<title>l2_attn_stage4_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3235" cy="-7986.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3235" y="-7997.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="3235" y="-7982.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3235" y="-7967.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu10&#45;&gt;l2_attn_stage4_gpu10 -->
<g id="edge379" class="edge">
<title>l2_attn_stage3_gpu10&#45;&gt;l2_attn_stage4_gpu10</title>
<path fill="none" stroke="black" d="M3235,-8095.74C3235,-8077.02 3235,-8054.03 3235,-8034.05"/>
<polygon fill="black" stroke="black" points="3238.5,-8033.91 3235,-8023.91 3231.5,-8033.91 3238.5,-8033.91"/>
</g>
<!-- l2_attn_stage3_gpu10&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge1547" class="edge">
<title>l2_attn_stage3_gpu10&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3288.29,-8103.31C3302.42,-8096.97 3317.95,-8091.17 3333,-8087.83 3387.73,-8075.7 4289.13,-8096.48 4342,-8077.83 4352.15,-8074.25 4352.32,-8069.19 4361,-8062.83 4386.22,-8044.34 4415.5,-8024.49 4437.65,-8009.78"/>
<polygon fill="red" stroke="red" points="4439.66,-8012.65 4446.07,-8004.22 4435.8,-8006.81 4439.66,-8012.65"/>
<text text-anchor="middle" x="4392.5" y="-8066.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu11 -->
<g id="node412" class="node">
<title>l2_attn_stage4_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3430" cy="-7986.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3430" y="-7997.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="3430" y="-7982.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3430" y="-7967.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu11&#45;&gt;l2_attn_stage4_gpu11 -->
<g id="edge380" class="edge">
<title>l2_attn_stage3_gpu11&#45;&gt;l2_attn_stage4_gpu11</title>
<path fill="none" stroke="black" d="M3430,-8095.74C3430,-8077.02 3430,-8054.03 3430,-8034.05"/>
<polygon fill="black" stroke="black" points="3433.5,-8033.91 3430,-8023.91 3426.5,-8033.91 3433.5,-8033.91"/>
</g>
<!-- l2_attn_stage3_gpu11&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge1548" class="edge">
<title>l2_attn_stage3_gpu11&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3483.29,-8103.33C3497.42,-8096.99 3512.95,-8091.18 3528,-8087.83 3552.41,-8082.41 4406.88,-8091.21 4428,-8077.83 4449.94,-8063.93 4461.24,-8035.65 4466.85,-8014.39"/>
<polygon fill="red" stroke="red" points="4470.27,-8015.14 4469.18,-8004.6 4463.46,-8013.52 4470.27,-8015.14"/>
<text text-anchor="middle" x="4474.5" y="-8066.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu12 -->
<g id="node413" class="node">
<title>l2_attn_stage4_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3625" cy="-7986.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3625" y="-7997.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="3625" y="-7982.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3625" y="-7967.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu12&#45;&gt;l2_attn_stage4_gpu12 -->
<g id="edge381" class="edge">
<title>l2_attn_stage3_gpu12&#45;&gt;l2_attn_stage4_gpu12</title>
<path fill="none" stroke="black" d="M3569.85,-8103.87C3556.43,-8097.83 3541.93,-8092.03 3528,-8087.83 3514.22,-8083.68 3473.36,-8088.77 3464,-8077.83 3429.08,-8037.03 3469.79,-8077.15 3528,-8054.83 3545.78,-8048.01 3563.42,-8037.27 3578.68,-8026.34"/>
<polygon fill="black" stroke="black" points="3580.93,-8029.02 3586.9,-8020.27 3576.77,-8023.39 3580.93,-8029.02"/>
</g>
<!-- l2_attn_stage3_gpu12&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge1549" class="edge">
<title>l2_attn_stage3_gpu12&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3678.29,-8103.34C3692.43,-8097 3707.95,-8091.19 3723,-8087.83 3744.45,-8083.05 4498.56,-8093.47 4514,-8077.83 4532.16,-8059.44 4514.89,-8031.75 4497.31,-8011.84"/>
<polygon fill="red" stroke="red" points="4499.75,-8009.32 4490.38,-8004.37 4494.61,-8014.08 4499.75,-8009.32"/>
<text text-anchor="middle" x="4552.5" y="-8066.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu13 -->
<g id="node414" class="node">
<title>l2_attn_stage4_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3820" cy="-7986.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3820" y="-7997.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="3820" y="-7982.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3820" y="-7967.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu13&#45;&gt;l2_attn_stage4_gpu13 -->
<g id="edge382" class="edge">
<title>l2_attn_stage3_gpu13&#45;&gt;l2_attn_stage4_gpu13</title>
<path fill="none" stroke="black" d="M3766.7,-8103.39C3752.85,-8097.13 3737.69,-8091.35 3723,-8087.83 3709.37,-8084.57 3480.71,-8087.93 3471,-8077.83 3466.38,-8073.03 3466.36,-8067.62 3471,-8062.83 3480.75,-8052.77 3709.7,-8059.24 3723,-8054.83 3741.4,-8048.74 3759.44,-8037.94 3774.87,-8026.75"/>
<polygon fill="black" stroke="black" points="3777.27,-8029.33 3783.16,-8020.52 3773.06,-8023.73 3777.27,-8029.33"/>
</g>
<!-- l2_attn_stage3_gpu13&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge1550" class="edge">
<title>l2_attn_stage3_gpu13&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3873.3,-8103.36C3887.43,-8097.02 3902.96,-8091.2 3918,-8087.83 3936.49,-8083.69 4586.7,-8091.33 4600,-8077.83 4628.36,-8049.06 4580.79,-8023.22 4535.82,-8006.6"/>
<polygon fill="red" stroke="red" points="4536.88,-8003.26 4526.29,-8003.19 4534.53,-8009.85 4536.88,-8003.26"/>
<text text-anchor="middle" x="4639.5" y="-8066.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu14 -->
<g id="node415" class="node">
<title>l2_attn_stage4_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4015" cy="-7986.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4015" y="-7997.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="4015" y="-7982.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4015" y="-7967.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu14&#45;&gt;l2_attn_stage4_gpu14 -->
<g id="edge383" class="edge">
<title>l2_attn_stage3_gpu14&#45;&gt;l2_attn_stage4_gpu14</title>
<path fill="none" stroke="black" d="M3961.74,-8103.22C3947.89,-8096.96 3932.71,-8091.22 3918,-8087.83 3894.17,-8082.34 3495.09,-8095.32 3478,-8077.83 3473.34,-8073.06 3473.33,-8067.59 3478,-8062.83 3486.56,-8054.11 3906.37,-8058.6 3918,-8054.83 3936.45,-8048.86 3954.49,-8038.1 3969.92,-8026.9"/>
<polygon fill="black" stroke="black" points="3972.32,-8029.47 3978.2,-8020.66 3968.11,-8023.88 3972.32,-8029.47"/>
</g>
<!-- l2_attn_stage3_gpu14&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge1551" class="edge">
<title>l2_attn_stage3_gpu14&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4068.3,-8103.39C4082.44,-8097.05 4097.96,-8091.22 4113,-8087.83 4128.53,-8084.33 4674.84,-8089.19 4686,-8077.83 4726.03,-8037.09 4656.32,-8013.74 4586.01,-8000.99"/>
<polygon fill="red" stroke="red" points="4586.55,-7997.53 4576.1,-7999.26 4585.35,-8004.43 4586.55,-7997.53"/>
<text text-anchor="middle" x="4726.5" y="-8066.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage4_gpu15 -->
<g id="node416" class="node">
<title>l2_attn_stage4_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4210" cy="-7986.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4210" y="-7997.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage4</text>
<text text-anchor="middle" x="4210" y="-7982.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4210" y="-7967.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage3_gpu15&#45;&gt;l2_attn_stage4_gpu15 -->
<g id="edge384" class="edge">
<title>l2_attn_stage3_gpu15&#45;&gt;l2_attn_stage4_gpu15</title>
<path fill="none" stroke="black" d="M4157.02,-8103.26C4143.09,-8096.97 4127.82,-8091.19 4113,-8087.83 4095.99,-8083.97 3497.24,-8090.27 3485,-8077.83 3480.32,-8073.08 3480.32,-8067.58 3485,-8062.83 3497.26,-8050.42 4096.39,-8060.16 4113,-8054.83 4131.46,-8048.91 4149.51,-8038.16 4164.94,-8026.96"/>
<polygon fill="black" stroke="black" points="4167.34,-8029.53 4173.22,-8020.72 4163.13,-8023.94 4167.34,-8029.53"/>
</g>
<!-- l2_attn_stage3_gpu15&#45;&gt;l2_attn_stage4_gpu[next_gpu] -->
<g id="edge1552" class="edge">
<title>l2_attn_stage3_gpu15&#45;&gt;l2_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4265.38,-8104.02C4280.74,-8097.45 4297.68,-8091.36 4314,-8087.83 4338.87,-8082.45 4754.2,-8096.02 4772,-8077.83 4826.67,-8021.96 4725.45,-8000.29 4626.12,-7992.04"/>
<polygon fill="red" stroke="red" points="4626.15,-7988.53 4615.9,-7991.24 4625.6,-7995.51 4626.15,-7988.53"/>
<text text-anchor="middle" x="4812.5" y="-8066.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu0 -->
<g id="node417" class="node">
<title>l2_attn_stage5_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1285" cy="-7839.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1285" y="-7850.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="1285" y="-7835.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1285" y="-7820.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu0&#45;&gt;l2_attn_stage5_gpu0 -->
<g id="edge385" class="edge">
<title>l2_attn_stage4_gpu0&#45;&gt;l2_attn_stage5_gpu0</title>
<path fill="none" stroke="black" d="M1285,-7948.74C1285,-7930.02 1285,-7907.03 1285,-7887.05"/>
<polygon fill="black" stroke="black" points="1288.5,-7886.91 1285,-7876.91 1281.5,-7886.91 1288.5,-7886.91"/>
</g>
<!-- l2_attn_stage5_gpu[next_gpu] -->
<g id="node1332" class="node">
<title>l2_attn_stage5_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4472" cy="-7839.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4472" y="-7835.63" font-family="Times,serif" font-size="14.00">l2_attn_stage5_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage4_gpu0&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge1553" class="edge">
<title>l2_attn_stage4_gpu0&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1338.29,-7956.33C1352.43,-7949.99 1367.95,-7944.18 1383,-7940.83 1612.73,-7889.7 3265.66,-7918.38 3501,-7915.83 3545.94,-7915.34 4265.97,-7916.86 4310,-7907.83 4353.87,-7898.83 4400.77,-7877.91 4432.76,-7861.73"/>
<polygon fill="red" stroke="red" points="4434.49,-7864.78 4441.78,-7857.09 4431.28,-7858.55 4434.49,-7864.78"/>
<text text-anchor="middle" x="3532.5" y="-7919.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu1 -->
<g id="node418" class="node">
<title>l2_attn_stage5_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1480" cy="-7839.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1480" y="-7850.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="1480" y="-7835.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1480" y="-7820.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu1&#45;&gt;l2_attn_stage5_gpu1 -->
<g id="edge386" class="edge">
<title>l2_attn_stage4_gpu1&#45;&gt;l2_attn_stage5_gpu1</title>
<path fill="none" stroke="black" d="M1480,-7948.74C1480,-7930.02 1480,-7907.03 1480,-7887.05"/>
<polygon fill="black" stroke="black" points="1483.5,-7886.91 1480,-7876.91 1476.5,-7886.91 1483.5,-7886.91"/>
</g>
<!-- l2_attn_stage4_gpu1&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge1554" class="edge">
<title>l2_attn_stage4_gpu1&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1533.28,-7956.26C1547.41,-7949.92 1562.94,-7944.13 1578,-7940.83 1632,-7929 3515.82,-7949.09 3568,-7930.83 3578.15,-7927.28 3576.86,-7919.42 3587,-7915.83 3624.87,-7902.45 4270.66,-7915.93 4310,-7907.83 4353.87,-7898.81 4400.77,-7877.89 4432.76,-7861.72"/>
<polygon fill="red" stroke="red" points="4434.48,-7864.76 4441.78,-7857.08 4431.28,-7858.54 4434.48,-7864.76"/>
<text text-anchor="middle" x="3618.5" y="-7919.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu2 -->
<g id="node419" class="node">
<title>l2_attn_stage5_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1675" cy="-7839.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1675" y="-7850.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="1675" y="-7835.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1675" y="-7820.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu2&#45;&gt;l2_attn_stage5_gpu2 -->
<g id="edge387" class="edge">
<title>l2_attn_stage4_gpu2&#45;&gt;l2_attn_stage5_gpu2</title>
<path fill="none" stroke="black" d="M1675,-7948.74C1675,-7930.02 1675,-7907.03 1675,-7887.05"/>
<polygon fill="black" stroke="black" points="1678.5,-7886.91 1675,-7876.91 1671.5,-7886.91 1678.5,-7886.91"/>
</g>
<!-- l2_attn_stage4_gpu2&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge1555" class="edge">
<title>l2_attn_stage4_gpu2&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1728.28,-7956.27C1742.41,-7949.93 1757.94,-7944.13 1773,-7940.83 1824.04,-7929.64 3604.68,-7948.1 3654,-7930.83 3664.15,-7927.28 3662.86,-7919.42 3673,-7915.83 3706.36,-7904.01 4275.34,-7914.99 4310,-7907.83 4353.86,-7898.77 4400.76,-7877.86 4432.75,-7861.7"/>
<polygon fill="red" stroke="red" points="4434.48,-7864.75 4441.77,-7857.07 4431.28,-7858.52 4434.48,-7864.75"/>
<text text-anchor="middle" x="3704.5" y="-7919.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu3 -->
<g id="node420" class="node">
<title>l2_attn_stage5_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1870" cy="-7839.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1870" y="-7850.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="1870" y="-7835.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1870" y="-7820.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu3&#45;&gt;l2_attn_stage5_gpu3 -->
<g id="edge388" class="edge">
<title>l2_attn_stage4_gpu3&#45;&gt;l2_attn_stage5_gpu3</title>
<path fill="none" stroke="black" d="M1870,-7948.74C1870,-7930.02 1870,-7907.03 1870,-7887.05"/>
<polygon fill="black" stroke="black" points="1873.5,-7886.91 1870,-7876.91 1866.5,-7886.91 1873.5,-7886.91"/>
</g>
<!-- l2_attn_stage4_gpu3&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge1556" class="edge">
<title>l2_attn_stage4_gpu3&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1923.28,-7956.27C1937.41,-7949.93 1952.94,-7944.13 1968,-7940.83 2016.08,-7930.28 3693.55,-7947.11 3740,-7930.83 3750.15,-7927.27 3748.86,-7919.43 3759,-7915.83 3787.85,-7905.58 4280.02,-7914.05 4310,-7907.83 4353.85,-7898.73 4400.75,-7877.83 4432.75,-7861.67"/>
<polygon fill="red" stroke="red" points="4434.47,-7864.73 4441.77,-7857.05 4431.27,-7858.5 4434.47,-7864.73"/>
<text text-anchor="middle" x="3790.5" y="-7919.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu4 -->
<g id="node421" class="node">
<title>l2_attn_stage5_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2065" cy="-7839.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2065" y="-7850.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="2065" y="-7835.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2065" y="-7820.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu4&#45;&gt;l2_attn_stage5_gpu4 -->
<g id="edge389" class="edge">
<title>l2_attn_stage4_gpu4&#45;&gt;l2_attn_stage5_gpu4</title>
<path fill="none" stroke="black" d="M2065,-7948.74C2065,-7930.02 2065,-7907.03 2065,-7887.05"/>
<polygon fill="black" stroke="black" points="2068.5,-7886.91 2065,-7876.91 2061.5,-7886.91 2068.5,-7886.91"/>
</g>
<!-- l2_attn_stage4_gpu4&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge1557" class="edge">
<title>l2_attn_stage4_gpu4&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2118.28,-7956.27C2132.41,-7949.93 2147.94,-7944.14 2163,-7940.83 2208.12,-7930.93 3782.41,-7946.11 3826,-7930.83 3836.15,-7927.27 3834.87,-7919.45 3845,-7915.83 3893.67,-7898.47 4259.42,-7918.4 4310,-7907.83 4353.84,-7898.67 4400.74,-7877.78 4432.74,-7861.64"/>
<polygon fill="red" stroke="red" points="4434.46,-7864.7 4441.76,-7857.02 4431.27,-7858.47 4434.46,-7864.7"/>
<text text-anchor="middle" x="3876.5" y="-7919.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu5 -->
<g id="node422" class="node">
<title>l2_attn_stage5_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2260" cy="-7839.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2260" y="-7850.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="2260" y="-7835.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2260" y="-7820.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu5&#45;&gt;l2_attn_stage5_gpu5 -->
<g id="edge390" class="edge">
<title>l2_attn_stage4_gpu5&#45;&gt;l2_attn_stage5_gpu5</title>
<path fill="none" stroke="black" d="M2260,-7948.74C2260,-7930.02 2260,-7907.03 2260,-7887.05"/>
<polygon fill="black" stroke="black" points="2263.5,-7886.91 2260,-7876.91 2256.5,-7886.91 2263.5,-7886.91"/>
</g>
<!-- l2_attn_stage4_gpu5&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge1558" class="edge">
<title>l2_attn_stage4_gpu5&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2313.28,-7956.28C2327.41,-7949.94 2342.94,-7944.14 2358,-7940.83 2400.16,-7931.57 3871.27,-7945.12 3912,-7930.83 3922.15,-7927.27 3920.87,-7919.47 3931,-7915.83 3970.64,-7901.6 4268.79,-7916.53 4310,-7907.83 4353.82,-7898.59 4400.73,-7877.7 4432.73,-7861.6"/>
<polygon fill="red" stroke="red" points="4434.45,-7864.65 4441.75,-7856.98 4431.26,-7858.42 4434.45,-7864.65"/>
<text text-anchor="middle" x="3962.5" y="-7919.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu6 -->
<g id="node423" class="node">
<title>l2_attn_stage5_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2455" cy="-7839.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2455" y="-7850.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="2455" y="-7835.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2455" y="-7820.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu6&#45;&gt;l2_attn_stage5_gpu6 -->
<g id="edge391" class="edge">
<title>l2_attn_stage4_gpu6&#45;&gt;l2_attn_stage5_gpu6</title>
<path fill="none" stroke="black" d="M2455,-7948.74C2455,-7930.02 2455,-7907.03 2455,-7887.05"/>
<polygon fill="black" stroke="black" points="2458.5,-7886.91 2455,-7876.91 2451.5,-7886.91 2458.5,-7886.91"/>
</g>
<!-- l2_attn_stage4_gpu6&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge1559" class="edge">
<title>l2_attn_stage4_gpu6&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2508.28,-7956.28C2522.41,-7949.94 2537.94,-7944.14 2553,-7940.83 2592.2,-7932.21 3960.13,-7944.13 3998,-7930.83 4008.15,-7927.27 4006.89,-7919.5 4017,-7915.83 4047.62,-7904.73 4278.15,-7914.65 4310,-7907.83 4353.66,-7898.48 4400.41,-7877.72 4432.42,-7861.67"/>
<polygon fill="red" stroke="red" points="4434.12,-7864.73 4441.45,-7857.07 4430.95,-7858.49 4434.12,-7864.73"/>
<text text-anchor="middle" x="4048.5" y="-7919.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu7 -->
<g id="node424" class="node">
<title>l2_attn_stage5_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2650" cy="-7839.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2650" y="-7850.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="2650" y="-7835.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2650" y="-7820.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu7&#45;&gt;l2_attn_stage5_gpu7 -->
<g id="edge392" class="edge">
<title>l2_attn_stage4_gpu7&#45;&gt;l2_attn_stage5_gpu7</title>
<path fill="none" stroke="black" d="M2650,-7948.74C2650,-7930.02 2650,-7907.03 2650,-7887.05"/>
<polygon fill="black" stroke="black" points="2653.5,-7886.91 2650,-7876.91 2646.5,-7886.91 2653.5,-7886.91"/>
</g>
<!-- l2_attn_stage4_gpu7&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge1560" class="edge">
<title>l2_attn_stage4_gpu7&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2703.28,-7956.29C2717.42,-7949.95 2732.95,-7944.15 2748,-7940.83 2784.24,-7932.85 4048.99,-7943.13 4084,-7930.83 4094.15,-7927.27 4092.91,-7919.56 4103,-7915.83 4146.19,-7899.9 4265.04,-7917.73 4310,-7907.83 4353.6,-7898.23 4400.37,-7877.51 4432.39,-7861.54"/>
<polygon fill="red" stroke="red" points="4434.08,-7864.6 4441.42,-7856.96 4430.92,-7858.36 4434.08,-7864.6"/>
<text text-anchor="middle" x="4134.5" y="-7919.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu8 -->
<g id="node425" class="node">
<title>l2_attn_stage5_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2845" cy="-7839.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2845" y="-7850.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="2845" y="-7835.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2845" y="-7820.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu8&#45;&gt;l2_attn_stage5_gpu8 -->
<g id="edge393" class="edge">
<title>l2_attn_stage4_gpu8&#45;&gt;l2_attn_stage5_gpu8</title>
<path fill="none" stroke="black" d="M2845,-7948.74C2845,-7930.02 2845,-7907.03 2845,-7887.05"/>
<polygon fill="black" stroke="black" points="2848.5,-7886.91 2845,-7876.91 2841.5,-7886.91 2848.5,-7886.91"/>
</g>
<!-- l2_attn_stage4_gpu8&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge1561" class="edge">
<title>l2_attn_stage4_gpu8&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2898.28,-7956.3C2912.42,-7949.96 2927.95,-7944.15 2943,-7940.83 3009.57,-7926.14 4105.69,-7953.45 4170,-7930.83 4180.15,-7927.26 4178.96,-7919.69 4189,-7915.83 4239.3,-7896.49 4257.53,-7920.14 4310,-7907.83 4353.2,-7897.7 4399.67,-7877.25 4431.71,-7861.5"/>
<polygon fill="red" stroke="red" points="4433.38,-7864.59 4440.77,-7856.99 4430.25,-7858.32 4433.38,-7864.59"/>
<text text-anchor="middle" x="4220.5" y="-7919.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu9 -->
<g id="node426" class="node">
<title>l2_attn_stage5_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3040" cy="-7839.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3040" y="-7850.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="3040" y="-7835.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3040" y="-7820.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu9&#45;&gt;l2_attn_stage5_gpu9 -->
<g id="edge394" class="edge">
<title>l2_attn_stage4_gpu9&#45;&gt;l2_attn_stage5_gpu9</title>
<path fill="none" stroke="black" d="M3040,-7948.74C3040,-7930.02 3040,-7907.03 3040,-7887.05"/>
<polygon fill="black" stroke="black" points="3043.5,-7886.91 3040,-7876.91 3036.5,-7886.91 3043.5,-7886.91"/>
</g>
<!-- l2_attn_stage4_gpu9&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge1562" class="edge">
<title>l2_attn_stage4_gpu9&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3093.28,-7956.3C3107.42,-7949.96 3122.95,-7944.16 3138,-7940.83 3198.65,-7927.42 4197.41,-7951.46 4256,-7930.83 4266.15,-7927.26 4265.3,-7920.48 4275,-7915.83 4289.39,-7908.94 4294.8,-7912.7 4310,-7907.83 4350.94,-7894.73 4395.95,-7875.57 4428.12,-7861.01"/>
<polygon fill="red" stroke="red" points="4429.61,-7864.17 4437.25,-7856.84 4426.7,-7857.81 4429.61,-7864.17"/>
<text text-anchor="middle" x="4306.5" y="-7919.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu10 -->
<g id="node427" class="node">
<title>l2_attn_stage5_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3235" cy="-7839.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3235" y="-7850.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="3235" y="-7835.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3235" y="-7820.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu10&#45;&gt;l2_attn_stage5_gpu10 -->
<g id="edge395" class="edge">
<title>l2_attn_stage4_gpu10&#45;&gt;l2_attn_stage5_gpu10</title>
<path fill="none" stroke="black" d="M3235,-7948.74C3235,-7930.02 3235,-7907.03 3235,-7887.05"/>
<polygon fill="black" stroke="black" points="3238.5,-7886.91 3235,-7876.91 3231.5,-7886.91 3238.5,-7886.91"/>
</g>
<!-- l2_attn_stage4_gpu10&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge1563" class="edge">
<title>l2_attn_stage4_gpu10&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3288.29,-7956.31C3302.42,-7949.97 3317.95,-7944.17 3333,-7940.83 3387.73,-7928.7 4289.13,-7949.48 4342,-7930.83 4352.15,-7927.25 4352.32,-7922.19 4361,-7915.83 4386.22,-7897.34 4415.5,-7877.49 4437.65,-7862.78"/>
<polygon fill="red" stroke="red" points="4439.66,-7865.65 4446.07,-7857.22 4435.8,-7859.81 4439.66,-7865.65"/>
<text text-anchor="middle" x="4392.5" y="-7919.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu11 -->
<g id="node428" class="node">
<title>l2_attn_stage5_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3430" cy="-7839.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3430" y="-7850.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="3430" y="-7835.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3430" y="-7820.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu11&#45;&gt;l2_attn_stage5_gpu11 -->
<g id="edge396" class="edge">
<title>l2_attn_stage4_gpu11&#45;&gt;l2_attn_stage5_gpu11</title>
<path fill="none" stroke="black" d="M3430,-7948.74C3430,-7930.02 3430,-7907.03 3430,-7887.05"/>
<polygon fill="black" stroke="black" points="3433.5,-7886.91 3430,-7876.91 3426.5,-7886.91 3433.5,-7886.91"/>
</g>
<!-- l2_attn_stage4_gpu11&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge1564" class="edge">
<title>l2_attn_stage4_gpu11&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3483.29,-7956.33C3497.42,-7949.99 3512.95,-7944.18 3528,-7940.83 3552.41,-7935.41 4406.88,-7944.21 4428,-7930.83 4449.94,-7916.93 4461.24,-7888.65 4466.85,-7867.39"/>
<polygon fill="red" stroke="red" points="4470.27,-7868.14 4469.18,-7857.6 4463.46,-7866.52 4470.27,-7868.14"/>
<text text-anchor="middle" x="4474.5" y="-7919.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu12 -->
<g id="node429" class="node">
<title>l2_attn_stage5_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3625" cy="-7839.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3625" y="-7850.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="3625" y="-7835.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3625" y="-7820.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu12&#45;&gt;l2_attn_stage5_gpu12 -->
<g id="edge397" class="edge">
<title>l2_attn_stage4_gpu12&#45;&gt;l2_attn_stage5_gpu12</title>
<path fill="none" stroke="black" d="M3569.85,-7956.87C3556.43,-7950.83 3541.93,-7945.03 3528,-7940.83 3514.22,-7936.68 3473.36,-7941.77 3464,-7930.83 3429.08,-7890.03 3469.79,-7930.15 3528,-7907.83 3545.78,-7901.01 3563.42,-7890.27 3578.68,-7879.34"/>
<polygon fill="black" stroke="black" points="3580.93,-7882.02 3586.9,-7873.27 3576.77,-7876.39 3580.93,-7882.02"/>
</g>
<!-- l2_attn_stage4_gpu12&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge1565" class="edge">
<title>l2_attn_stage4_gpu12&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3678.29,-7956.34C3692.43,-7950 3707.95,-7944.19 3723,-7940.83 3744.45,-7936.05 4498.56,-7946.47 4514,-7930.83 4532.16,-7912.44 4514.89,-7884.75 4497.31,-7864.84"/>
<polygon fill="red" stroke="red" points="4499.75,-7862.32 4490.38,-7857.37 4494.61,-7867.08 4499.75,-7862.32"/>
<text text-anchor="middle" x="4552.5" y="-7919.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu13 -->
<g id="node430" class="node">
<title>l2_attn_stage5_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3820" cy="-7839.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3820" y="-7850.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="3820" y="-7835.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3820" y="-7820.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu13&#45;&gt;l2_attn_stage5_gpu13 -->
<g id="edge398" class="edge">
<title>l2_attn_stage4_gpu13&#45;&gt;l2_attn_stage5_gpu13</title>
<path fill="none" stroke="black" d="M3766.7,-7956.39C3752.85,-7950.13 3737.69,-7944.35 3723,-7940.83 3709.37,-7937.57 3480.71,-7940.93 3471,-7930.83 3466.38,-7926.03 3466.36,-7920.62 3471,-7915.83 3480.75,-7905.77 3709.7,-7912.24 3723,-7907.83 3741.4,-7901.74 3759.44,-7890.94 3774.87,-7879.75"/>
<polygon fill="black" stroke="black" points="3777.27,-7882.33 3783.16,-7873.52 3773.06,-7876.73 3777.27,-7882.33"/>
</g>
<!-- l2_attn_stage4_gpu13&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge1566" class="edge">
<title>l2_attn_stage4_gpu13&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3873.3,-7956.36C3887.43,-7950.02 3902.96,-7944.2 3918,-7940.83 3936.49,-7936.69 4586.7,-7944.33 4600,-7930.83 4628.36,-7902.06 4580.79,-7876.22 4535.82,-7859.6"/>
<polygon fill="red" stroke="red" points="4536.88,-7856.26 4526.29,-7856.19 4534.53,-7862.85 4536.88,-7856.26"/>
<text text-anchor="middle" x="4639.5" y="-7919.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu14 -->
<g id="node431" class="node">
<title>l2_attn_stage5_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4015" cy="-7839.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4015" y="-7850.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="4015" y="-7835.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4015" y="-7820.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu14&#45;&gt;l2_attn_stage5_gpu14 -->
<g id="edge399" class="edge">
<title>l2_attn_stage4_gpu14&#45;&gt;l2_attn_stage5_gpu14</title>
<path fill="none" stroke="black" d="M3961.74,-7956.22C3947.89,-7949.96 3932.71,-7944.22 3918,-7940.83 3894.17,-7935.34 3495.09,-7948.32 3478,-7930.83 3473.34,-7926.06 3473.33,-7920.59 3478,-7915.83 3486.56,-7907.11 3906.37,-7911.6 3918,-7907.83 3936.45,-7901.86 3954.49,-7891.1 3969.92,-7879.9"/>
<polygon fill="black" stroke="black" points="3972.32,-7882.47 3978.2,-7873.66 3968.11,-7876.88 3972.32,-7882.47"/>
</g>
<!-- l2_attn_stage4_gpu14&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge1567" class="edge">
<title>l2_attn_stage4_gpu14&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4068.3,-7956.39C4082.44,-7950.05 4097.96,-7944.22 4113,-7940.83 4128.53,-7937.33 4674.84,-7942.19 4686,-7930.83 4726.03,-7890.09 4656.32,-7866.74 4586.01,-7853.99"/>
<polygon fill="red" stroke="red" points="4586.55,-7850.53 4576.1,-7852.26 4585.35,-7857.43 4586.55,-7850.53"/>
<text text-anchor="middle" x="4726.5" y="-7919.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage5_gpu15 -->
<g id="node432" class="node">
<title>l2_attn_stage5_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4210" cy="-7839.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4210" y="-7850.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage5</text>
<text text-anchor="middle" x="4210" y="-7835.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4210" y="-7820.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage4_gpu15&#45;&gt;l2_attn_stage5_gpu15 -->
<g id="edge400" class="edge">
<title>l2_attn_stage4_gpu15&#45;&gt;l2_attn_stage5_gpu15</title>
<path fill="none" stroke="black" d="M4157.02,-7956.26C4143.09,-7949.97 4127.82,-7944.19 4113,-7940.83 4095.99,-7936.97 3497.24,-7943.27 3485,-7930.83 3480.32,-7926.08 3480.32,-7920.58 3485,-7915.83 3497.26,-7903.42 4096.39,-7913.16 4113,-7907.83 4131.46,-7901.91 4149.51,-7891.16 4164.94,-7879.96"/>
<polygon fill="black" stroke="black" points="4167.34,-7882.53 4173.22,-7873.72 4163.13,-7876.94 4167.34,-7882.53"/>
</g>
<!-- l2_attn_stage4_gpu15&#45;&gt;l2_attn_stage5_gpu[next_gpu] -->
<g id="edge1568" class="edge">
<title>l2_attn_stage4_gpu15&#45;&gt;l2_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4265.38,-7957.02C4280.74,-7950.45 4297.68,-7944.36 4314,-7940.83 4338.87,-7935.45 4754.2,-7949.02 4772,-7930.83 4826.67,-7874.96 4725.45,-7853.29 4626.12,-7845.04"/>
<polygon fill="red" stroke="red" points="4626.15,-7841.53 4615.9,-7844.24 4625.6,-7848.51 4626.15,-7841.53"/>
<text text-anchor="middle" x="4812.5" y="-7919.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu0 -->
<g id="node433" class="node">
<title>l2_attn_stage6_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1285" cy="-7692.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1285" y="-7703.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="1285" y="-7688.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1285" y="-7673.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu0&#45;&gt;l2_attn_stage6_gpu0 -->
<g id="edge401" class="edge">
<title>l2_attn_stage5_gpu0&#45;&gt;l2_attn_stage6_gpu0</title>
<path fill="none" stroke="black" d="M1285,-7801.74C1285,-7783.02 1285,-7760.03 1285,-7740.05"/>
<polygon fill="black" stroke="black" points="1288.5,-7739.91 1285,-7729.91 1281.5,-7739.91 1288.5,-7739.91"/>
</g>
<!-- l2_attn_stage6_gpu[next_gpu] -->
<g id="node1333" class="node">
<title>l2_attn_stage6_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4472" cy="-7692.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4472" y="-7688.63" font-family="Times,serif" font-size="14.00">l2_attn_stage6_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage5_gpu0&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge1569" class="edge">
<title>l2_attn_stage5_gpu0&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1338.29,-7809.33C1352.43,-7802.99 1367.95,-7797.18 1383,-7793.83 1612.73,-7742.7 3265.66,-7771.38 3501,-7768.83 3545.94,-7768.34 4265.97,-7769.86 4310,-7760.83 4353.87,-7751.83 4400.77,-7730.91 4432.76,-7714.73"/>
<polygon fill="red" stroke="red" points="4434.49,-7717.78 4441.78,-7710.09 4431.28,-7711.55 4434.49,-7717.78"/>
<text text-anchor="middle" x="3532.5" y="-7772.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu1 -->
<g id="node434" class="node">
<title>l2_attn_stage6_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1480" cy="-7692.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1480" y="-7703.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="1480" y="-7688.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1480" y="-7673.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu1&#45;&gt;l2_attn_stage6_gpu1 -->
<g id="edge402" class="edge">
<title>l2_attn_stage5_gpu1&#45;&gt;l2_attn_stage6_gpu1</title>
<path fill="none" stroke="black" d="M1480,-7801.74C1480,-7783.02 1480,-7760.03 1480,-7740.05"/>
<polygon fill="black" stroke="black" points="1483.5,-7739.91 1480,-7729.91 1476.5,-7739.91 1483.5,-7739.91"/>
</g>
<!-- l2_attn_stage5_gpu1&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge1570" class="edge">
<title>l2_attn_stage5_gpu1&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1533.28,-7809.26C1547.41,-7802.92 1562.94,-7797.13 1578,-7793.83 1632,-7782 3515.82,-7802.09 3568,-7783.83 3578.15,-7780.28 3576.86,-7772.42 3587,-7768.83 3624.87,-7755.45 4270.66,-7768.93 4310,-7760.83 4353.87,-7751.81 4400.77,-7730.89 4432.76,-7714.72"/>
<polygon fill="red" stroke="red" points="4434.48,-7717.76 4441.78,-7710.08 4431.28,-7711.54 4434.48,-7717.76"/>
<text text-anchor="middle" x="3618.5" y="-7772.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu2 -->
<g id="node435" class="node">
<title>l2_attn_stage6_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1675" cy="-7692.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1675" y="-7703.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="1675" y="-7688.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1675" y="-7673.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu2&#45;&gt;l2_attn_stage6_gpu2 -->
<g id="edge403" class="edge">
<title>l2_attn_stage5_gpu2&#45;&gt;l2_attn_stage6_gpu2</title>
<path fill="none" stroke="black" d="M1675,-7801.74C1675,-7783.02 1675,-7760.03 1675,-7740.05"/>
<polygon fill="black" stroke="black" points="1678.5,-7739.91 1675,-7729.91 1671.5,-7739.91 1678.5,-7739.91"/>
</g>
<!-- l2_attn_stage5_gpu2&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge1571" class="edge">
<title>l2_attn_stage5_gpu2&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1728.28,-7809.27C1742.41,-7802.93 1757.94,-7797.13 1773,-7793.83 1824.04,-7782.64 3604.68,-7801.1 3654,-7783.83 3664.15,-7780.28 3662.86,-7772.42 3673,-7768.83 3706.36,-7757.01 4275.34,-7767.99 4310,-7760.83 4353.86,-7751.77 4400.76,-7730.86 4432.75,-7714.7"/>
<polygon fill="red" stroke="red" points="4434.48,-7717.75 4441.77,-7710.07 4431.28,-7711.52 4434.48,-7717.75"/>
<text text-anchor="middle" x="3704.5" y="-7772.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu3 -->
<g id="node436" class="node">
<title>l2_attn_stage6_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1870" cy="-7692.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1870" y="-7703.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="1870" y="-7688.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1870" y="-7673.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu3&#45;&gt;l2_attn_stage6_gpu3 -->
<g id="edge404" class="edge">
<title>l2_attn_stage5_gpu3&#45;&gt;l2_attn_stage6_gpu3</title>
<path fill="none" stroke="black" d="M1870,-7801.74C1870,-7783.02 1870,-7760.03 1870,-7740.05"/>
<polygon fill="black" stroke="black" points="1873.5,-7739.91 1870,-7729.91 1866.5,-7739.91 1873.5,-7739.91"/>
</g>
<!-- l2_attn_stage5_gpu3&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge1572" class="edge">
<title>l2_attn_stage5_gpu3&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1923.28,-7809.27C1937.41,-7802.93 1952.94,-7797.13 1968,-7793.83 2016.08,-7783.28 3693.55,-7800.11 3740,-7783.83 3750.15,-7780.27 3748.86,-7772.43 3759,-7768.83 3787.85,-7758.58 4280.02,-7767.05 4310,-7760.83 4353.85,-7751.73 4400.75,-7730.83 4432.75,-7714.67"/>
<polygon fill="red" stroke="red" points="4434.47,-7717.73 4441.77,-7710.05 4431.27,-7711.5 4434.47,-7717.73"/>
<text text-anchor="middle" x="3790.5" y="-7772.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu4 -->
<g id="node437" class="node">
<title>l2_attn_stage6_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2065" cy="-7692.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2065" y="-7703.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="2065" y="-7688.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2065" y="-7673.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu4&#45;&gt;l2_attn_stage6_gpu4 -->
<g id="edge405" class="edge">
<title>l2_attn_stage5_gpu4&#45;&gt;l2_attn_stage6_gpu4</title>
<path fill="none" stroke="black" d="M2065,-7801.74C2065,-7783.02 2065,-7760.03 2065,-7740.05"/>
<polygon fill="black" stroke="black" points="2068.5,-7739.91 2065,-7729.91 2061.5,-7739.91 2068.5,-7739.91"/>
</g>
<!-- l2_attn_stage5_gpu4&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge1573" class="edge">
<title>l2_attn_stage5_gpu4&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2118.28,-7809.27C2132.41,-7802.93 2147.94,-7797.14 2163,-7793.83 2208.12,-7783.93 3782.41,-7799.11 3826,-7783.83 3836.15,-7780.27 3834.87,-7772.45 3845,-7768.83 3893.67,-7751.47 4259.42,-7771.4 4310,-7760.83 4353.84,-7751.67 4400.74,-7730.78 4432.74,-7714.64"/>
<polygon fill="red" stroke="red" points="4434.46,-7717.7 4441.76,-7710.02 4431.27,-7711.47 4434.46,-7717.7"/>
<text text-anchor="middle" x="3876.5" y="-7772.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu5 -->
<g id="node438" class="node">
<title>l2_attn_stage6_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2260" cy="-7692.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2260" y="-7703.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="2260" y="-7688.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2260" y="-7673.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu5&#45;&gt;l2_attn_stage6_gpu5 -->
<g id="edge406" class="edge">
<title>l2_attn_stage5_gpu5&#45;&gt;l2_attn_stage6_gpu5</title>
<path fill="none" stroke="black" d="M2260,-7801.74C2260,-7783.02 2260,-7760.03 2260,-7740.05"/>
<polygon fill="black" stroke="black" points="2263.5,-7739.91 2260,-7729.91 2256.5,-7739.91 2263.5,-7739.91"/>
</g>
<!-- l2_attn_stage5_gpu5&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge1574" class="edge">
<title>l2_attn_stage5_gpu5&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2313.28,-7809.28C2327.41,-7802.94 2342.94,-7797.14 2358,-7793.83 2400.16,-7784.57 3871.27,-7798.12 3912,-7783.83 3922.15,-7780.27 3920.87,-7772.47 3931,-7768.83 3970.64,-7754.6 4268.79,-7769.53 4310,-7760.83 4353.82,-7751.59 4400.73,-7730.7 4432.73,-7714.6"/>
<polygon fill="red" stroke="red" points="4434.45,-7717.65 4441.75,-7709.98 4431.26,-7711.42 4434.45,-7717.65"/>
<text text-anchor="middle" x="3962.5" y="-7772.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu6 -->
<g id="node439" class="node">
<title>l2_attn_stage6_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2455" cy="-7692.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2455" y="-7703.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="2455" y="-7688.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2455" y="-7673.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu6&#45;&gt;l2_attn_stage6_gpu6 -->
<g id="edge407" class="edge">
<title>l2_attn_stage5_gpu6&#45;&gt;l2_attn_stage6_gpu6</title>
<path fill="none" stroke="black" d="M2455,-7801.74C2455,-7783.02 2455,-7760.03 2455,-7740.05"/>
<polygon fill="black" stroke="black" points="2458.5,-7739.91 2455,-7729.91 2451.5,-7739.91 2458.5,-7739.91"/>
</g>
<!-- l2_attn_stage5_gpu6&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge1575" class="edge">
<title>l2_attn_stage5_gpu6&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2508.28,-7809.28C2522.41,-7802.94 2537.94,-7797.14 2553,-7793.83 2592.2,-7785.21 3960.13,-7797.13 3998,-7783.83 4008.15,-7780.27 4006.89,-7772.5 4017,-7768.83 4047.62,-7757.73 4278.15,-7767.65 4310,-7760.83 4353.66,-7751.48 4400.41,-7730.72 4432.42,-7714.67"/>
<polygon fill="red" stroke="red" points="4434.12,-7717.73 4441.45,-7710.07 4430.95,-7711.49 4434.12,-7717.73"/>
<text text-anchor="middle" x="4048.5" y="-7772.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu7 -->
<g id="node440" class="node">
<title>l2_attn_stage6_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2650" cy="-7692.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2650" y="-7703.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="2650" y="-7688.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2650" y="-7673.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu7&#45;&gt;l2_attn_stage6_gpu7 -->
<g id="edge408" class="edge">
<title>l2_attn_stage5_gpu7&#45;&gt;l2_attn_stage6_gpu7</title>
<path fill="none" stroke="black" d="M2650,-7801.74C2650,-7783.02 2650,-7760.03 2650,-7740.05"/>
<polygon fill="black" stroke="black" points="2653.5,-7739.91 2650,-7729.91 2646.5,-7739.91 2653.5,-7739.91"/>
</g>
<!-- l2_attn_stage5_gpu7&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge1576" class="edge">
<title>l2_attn_stage5_gpu7&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2703.28,-7809.29C2717.42,-7802.95 2732.95,-7797.15 2748,-7793.83 2784.24,-7785.85 4048.99,-7796.13 4084,-7783.83 4094.15,-7780.27 4092.91,-7772.56 4103,-7768.83 4146.19,-7752.9 4265.04,-7770.73 4310,-7760.83 4353.6,-7751.23 4400.37,-7730.51 4432.39,-7714.54"/>
<polygon fill="red" stroke="red" points="4434.08,-7717.6 4441.42,-7709.96 4430.92,-7711.36 4434.08,-7717.6"/>
<text text-anchor="middle" x="4134.5" y="-7772.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu8 -->
<g id="node441" class="node">
<title>l2_attn_stage6_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2845" cy="-7692.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2845" y="-7703.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="2845" y="-7688.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2845" y="-7673.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu8&#45;&gt;l2_attn_stage6_gpu8 -->
<g id="edge409" class="edge">
<title>l2_attn_stage5_gpu8&#45;&gt;l2_attn_stage6_gpu8</title>
<path fill="none" stroke="black" d="M2845,-7801.74C2845,-7783.02 2845,-7760.03 2845,-7740.05"/>
<polygon fill="black" stroke="black" points="2848.5,-7739.91 2845,-7729.91 2841.5,-7739.91 2848.5,-7739.91"/>
</g>
<!-- l2_attn_stage5_gpu8&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge1577" class="edge">
<title>l2_attn_stage5_gpu8&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2898.28,-7809.3C2912.42,-7802.96 2927.95,-7797.15 2943,-7793.83 3009.57,-7779.14 4105.69,-7806.45 4170,-7783.83 4180.15,-7780.26 4178.96,-7772.69 4189,-7768.83 4239.3,-7749.49 4257.53,-7773.14 4310,-7760.83 4353.2,-7750.7 4399.67,-7730.25 4431.71,-7714.5"/>
<polygon fill="red" stroke="red" points="4433.38,-7717.59 4440.77,-7709.99 4430.25,-7711.32 4433.38,-7717.59"/>
<text text-anchor="middle" x="4220.5" y="-7772.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu9 -->
<g id="node442" class="node">
<title>l2_attn_stage6_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3040" cy="-7692.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3040" y="-7703.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="3040" y="-7688.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3040" y="-7673.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu9&#45;&gt;l2_attn_stage6_gpu9 -->
<g id="edge410" class="edge">
<title>l2_attn_stage5_gpu9&#45;&gt;l2_attn_stage6_gpu9</title>
<path fill="none" stroke="black" d="M3040,-7801.74C3040,-7783.02 3040,-7760.03 3040,-7740.05"/>
<polygon fill="black" stroke="black" points="3043.5,-7739.91 3040,-7729.91 3036.5,-7739.91 3043.5,-7739.91"/>
</g>
<!-- l2_attn_stage5_gpu9&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge1578" class="edge">
<title>l2_attn_stage5_gpu9&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3093.28,-7809.3C3107.42,-7802.96 3122.95,-7797.16 3138,-7793.83 3198.65,-7780.42 4197.41,-7804.46 4256,-7783.83 4266.15,-7780.26 4265.3,-7773.48 4275,-7768.83 4289.39,-7761.94 4294.8,-7765.7 4310,-7760.83 4350.94,-7747.73 4395.95,-7728.57 4428.12,-7714.01"/>
<polygon fill="red" stroke="red" points="4429.61,-7717.17 4437.25,-7709.84 4426.7,-7710.81 4429.61,-7717.17"/>
<text text-anchor="middle" x="4306.5" y="-7772.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu10 -->
<g id="node443" class="node">
<title>l2_attn_stage6_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3235" cy="-7692.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3235" y="-7703.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="3235" y="-7688.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3235" y="-7673.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu10&#45;&gt;l2_attn_stage6_gpu10 -->
<g id="edge411" class="edge">
<title>l2_attn_stage5_gpu10&#45;&gt;l2_attn_stage6_gpu10</title>
<path fill="none" stroke="black" d="M3235,-7801.74C3235,-7783.02 3235,-7760.03 3235,-7740.05"/>
<polygon fill="black" stroke="black" points="3238.5,-7739.91 3235,-7729.91 3231.5,-7739.91 3238.5,-7739.91"/>
</g>
<!-- l2_attn_stage5_gpu10&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge1579" class="edge">
<title>l2_attn_stage5_gpu10&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3288.29,-7809.31C3302.42,-7802.97 3317.95,-7797.17 3333,-7793.83 3387.73,-7781.7 4289.13,-7802.48 4342,-7783.83 4352.15,-7780.25 4352.32,-7775.19 4361,-7768.83 4386.22,-7750.34 4415.5,-7730.49 4437.65,-7715.78"/>
<polygon fill="red" stroke="red" points="4439.66,-7718.65 4446.07,-7710.22 4435.8,-7712.81 4439.66,-7718.65"/>
<text text-anchor="middle" x="4392.5" y="-7772.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu11 -->
<g id="node444" class="node">
<title>l2_attn_stage6_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3430" cy="-7692.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3430" y="-7703.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="3430" y="-7688.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3430" y="-7673.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu11&#45;&gt;l2_attn_stage6_gpu11 -->
<g id="edge412" class="edge">
<title>l2_attn_stage5_gpu11&#45;&gt;l2_attn_stage6_gpu11</title>
<path fill="none" stroke="black" d="M3430,-7801.74C3430,-7783.02 3430,-7760.03 3430,-7740.05"/>
<polygon fill="black" stroke="black" points="3433.5,-7739.91 3430,-7729.91 3426.5,-7739.91 3433.5,-7739.91"/>
</g>
<!-- l2_attn_stage5_gpu11&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge1580" class="edge">
<title>l2_attn_stage5_gpu11&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3483.29,-7809.33C3497.42,-7802.99 3512.95,-7797.18 3528,-7793.83 3552.41,-7788.41 4406.88,-7797.21 4428,-7783.83 4449.94,-7769.93 4461.24,-7741.65 4466.85,-7720.39"/>
<polygon fill="red" stroke="red" points="4470.27,-7721.14 4469.18,-7710.6 4463.46,-7719.52 4470.27,-7721.14"/>
<text text-anchor="middle" x="4474.5" y="-7772.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu12 -->
<g id="node445" class="node">
<title>l2_attn_stage6_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3625" cy="-7692.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3625" y="-7703.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="3625" y="-7688.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3625" y="-7673.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu12&#45;&gt;l2_attn_stage6_gpu12 -->
<g id="edge413" class="edge">
<title>l2_attn_stage5_gpu12&#45;&gt;l2_attn_stage6_gpu12</title>
<path fill="none" stroke="black" d="M3569.85,-7809.87C3556.43,-7803.83 3541.93,-7798.03 3528,-7793.83 3514.22,-7789.68 3473.36,-7794.77 3464,-7783.83 3429.08,-7743.03 3469.79,-7783.15 3528,-7760.83 3545.78,-7754.01 3563.42,-7743.27 3578.68,-7732.34"/>
<polygon fill="black" stroke="black" points="3580.93,-7735.02 3586.9,-7726.27 3576.77,-7729.39 3580.93,-7735.02"/>
</g>
<!-- l2_attn_stage5_gpu12&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge1581" class="edge">
<title>l2_attn_stage5_gpu12&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3678.29,-7809.34C3692.43,-7803 3707.95,-7797.19 3723,-7793.83 3744.45,-7789.05 4498.56,-7799.47 4514,-7783.83 4532.16,-7765.44 4514.89,-7737.75 4497.31,-7717.84"/>
<polygon fill="red" stroke="red" points="4499.75,-7715.32 4490.38,-7710.37 4494.61,-7720.08 4499.75,-7715.32"/>
<text text-anchor="middle" x="4552.5" y="-7772.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu13 -->
<g id="node446" class="node">
<title>l2_attn_stage6_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3820" cy="-7692.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3820" y="-7703.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="3820" y="-7688.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3820" y="-7673.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu13&#45;&gt;l2_attn_stage6_gpu13 -->
<g id="edge414" class="edge">
<title>l2_attn_stage5_gpu13&#45;&gt;l2_attn_stage6_gpu13</title>
<path fill="none" stroke="black" d="M3766.7,-7809.39C3752.85,-7803.13 3737.69,-7797.35 3723,-7793.83 3709.37,-7790.57 3480.71,-7793.93 3471,-7783.83 3466.38,-7779.03 3466.36,-7773.62 3471,-7768.83 3480.75,-7758.77 3709.7,-7765.24 3723,-7760.83 3741.4,-7754.74 3759.44,-7743.94 3774.87,-7732.75"/>
<polygon fill="black" stroke="black" points="3777.27,-7735.33 3783.16,-7726.52 3773.06,-7729.73 3777.27,-7735.33"/>
</g>
<!-- l2_attn_stage5_gpu13&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge1582" class="edge">
<title>l2_attn_stage5_gpu13&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3873.3,-7809.36C3887.43,-7803.02 3902.96,-7797.2 3918,-7793.83 3936.49,-7789.69 4586.7,-7797.33 4600,-7783.83 4628.36,-7755.06 4580.79,-7729.22 4535.82,-7712.6"/>
<polygon fill="red" stroke="red" points="4536.88,-7709.26 4526.29,-7709.19 4534.53,-7715.85 4536.88,-7709.26"/>
<text text-anchor="middle" x="4639.5" y="-7772.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu14 -->
<g id="node447" class="node">
<title>l2_attn_stage6_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4015" cy="-7692.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4015" y="-7703.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="4015" y="-7688.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4015" y="-7673.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu14&#45;&gt;l2_attn_stage6_gpu14 -->
<g id="edge415" class="edge">
<title>l2_attn_stage5_gpu14&#45;&gt;l2_attn_stage6_gpu14</title>
<path fill="none" stroke="black" d="M3961.74,-7809.22C3947.89,-7802.96 3932.71,-7797.22 3918,-7793.83 3894.17,-7788.34 3495.09,-7801.32 3478,-7783.83 3473.34,-7779.06 3473.33,-7773.59 3478,-7768.83 3486.56,-7760.11 3906.37,-7764.6 3918,-7760.83 3936.45,-7754.86 3954.49,-7744.1 3969.92,-7732.9"/>
<polygon fill="black" stroke="black" points="3972.32,-7735.47 3978.2,-7726.66 3968.11,-7729.88 3972.32,-7735.47"/>
</g>
<!-- l2_attn_stage5_gpu14&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge1583" class="edge">
<title>l2_attn_stage5_gpu14&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4068.3,-7809.39C4082.44,-7803.05 4097.96,-7797.22 4113,-7793.83 4128.53,-7790.33 4674.84,-7795.19 4686,-7783.83 4726.03,-7743.09 4656.32,-7719.74 4586.01,-7706.99"/>
<polygon fill="red" stroke="red" points="4586.55,-7703.53 4576.1,-7705.26 4585.35,-7710.43 4586.55,-7703.53"/>
<text text-anchor="middle" x="4726.5" y="-7772.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage6_gpu15 -->
<g id="node448" class="node">
<title>l2_attn_stage6_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4210" cy="-7692.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4210" y="-7703.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage6</text>
<text text-anchor="middle" x="4210" y="-7688.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4210" y="-7673.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage5_gpu15&#45;&gt;l2_attn_stage6_gpu15 -->
<g id="edge416" class="edge">
<title>l2_attn_stage5_gpu15&#45;&gt;l2_attn_stage6_gpu15</title>
<path fill="none" stroke="black" d="M4157.02,-7809.26C4143.09,-7802.97 4127.82,-7797.19 4113,-7793.83 4095.99,-7789.97 3497.24,-7796.27 3485,-7783.83 3480.32,-7779.08 3480.32,-7773.58 3485,-7768.83 3497.26,-7756.42 4096.39,-7766.16 4113,-7760.83 4131.46,-7754.91 4149.51,-7744.16 4164.94,-7732.96"/>
<polygon fill="black" stroke="black" points="4167.34,-7735.53 4173.22,-7726.72 4163.13,-7729.94 4167.34,-7735.53"/>
</g>
<!-- l2_attn_stage5_gpu15&#45;&gt;l2_attn_stage6_gpu[next_gpu] -->
<g id="edge1584" class="edge">
<title>l2_attn_stage5_gpu15&#45;&gt;l2_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4265.38,-7810.02C4280.74,-7803.45 4297.68,-7797.36 4314,-7793.83 4338.87,-7788.45 4754.2,-7802.02 4772,-7783.83 4826.67,-7727.96 4725.45,-7706.29 4626.12,-7698.04"/>
<polygon fill="red" stroke="red" points="4626.15,-7694.53 4615.9,-7697.24 4625.6,-7701.51 4626.15,-7694.53"/>
<text text-anchor="middle" x="4812.5" y="-7772.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu0 -->
<g id="node449" class="node">
<title>l2_attn_stage7_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1285" cy="-7545.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1285" y="-7556.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="1285" y="-7541.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1285" y="-7526.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu0&#45;&gt;l2_attn_stage7_gpu0 -->
<g id="edge417" class="edge">
<title>l2_attn_stage6_gpu0&#45;&gt;l2_attn_stage7_gpu0</title>
<path fill="none" stroke="black" d="M1285,-7654.74C1285,-7636.02 1285,-7613.03 1285,-7593.05"/>
<polygon fill="black" stroke="black" points="1288.5,-7592.91 1285,-7582.91 1281.5,-7592.91 1288.5,-7592.91"/>
</g>
<!-- l2_attn_stage7_gpu[next_gpu] -->
<g id="node1334" class="node">
<title>l2_attn_stage7_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4472" cy="-7545.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4472" y="-7541.63" font-family="Times,serif" font-size="14.00">l2_attn_stage7_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage6_gpu0&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge1585" class="edge">
<title>l2_attn_stage6_gpu0&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1338.29,-7662.33C1352.43,-7655.99 1367.95,-7650.18 1383,-7646.83 1612.73,-7595.7 3265.66,-7624.38 3501,-7621.83 3545.94,-7621.34 4265.97,-7622.86 4310,-7613.83 4353.87,-7604.83 4400.77,-7583.91 4432.76,-7567.73"/>
<polygon fill="red" stroke="red" points="4434.49,-7570.78 4441.78,-7563.09 4431.28,-7564.55 4434.49,-7570.78"/>
<text text-anchor="middle" x="3532.5" y="-7625.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu1 -->
<g id="node450" class="node">
<title>l2_attn_stage7_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1480" cy="-7545.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1480" y="-7556.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="1480" y="-7541.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1480" y="-7526.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu1&#45;&gt;l2_attn_stage7_gpu1 -->
<g id="edge418" class="edge">
<title>l2_attn_stage6_gpu1&#45;&gt;l2_attn_stage7_gpu1</title>
<path fill="none" stroke="black" d="M1480,-7654.74C1480,-7636.02 1480,-7613.03 1480,-7593.05"/>
<polygon fill="black" stroke="black" points="1483.5,-7592.91 1480,-7582.91 1476.5,-7592.91 1483.5,-7592.91"/>
</g>
<!-- l2_attn_stage6_gpu1&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge1586" class="edge">
<title>l2_attn_stage6_gpu1&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1533.28,-7662.26C1547.41,-7655.92 1562.94,-7650.13 1578,-7646.83 1632,-7635 3515.82,-7655.09 3568,-7636.83 3578.15,-7633.28 3576.86,-7625.42 3587,-7621.83 3624.87,-7608.45 4270.66,-7621.93 4310,-7613.83 4353.87,-7604.81 4400.77,-7583.89 4432.76,-7567.72"/>
<polygon fill="red" stroke="red" points="4434.48,-7570.76 4441.78,-7563.08 4431.28,-7564.54 4434.48,-7570.76"/>
<text text-anchor="middle" x="3618.5" y="-7625.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu2 -->
<g id="node451" class="node">
<title>l2_attn_stage7_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1675" cy="-7545.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1675" y="-7556.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="1675" y="-7541.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1675" y="-7526.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu2&#45;&gt;l2_attn_stage7_gpu2 -->
<g id="edge419" class="edge">
<title>l2_attn_stage6_gpu2&#45;&gt;l2_attn_stage7_gpu2</title>
<path fill="none" stroke="black" d="M1675,-7654.74C1675,-7636.02 1675,-7613.03 1675,-7593.05"/>
<polygon fill="black" stroke="black" points="1678.5,-7592.91 1675,-7582.91 1671.5,-7592.91 1678.5,-7592.91"/>
</g>
<!-- l2_attn_stage6_gpu2&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge1587" class="edge">
<title>l2_attn_stage6_gpu2&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1728.28,-7662.27C1742.41,-7655.93 1757.94,-7650.13 1773,-7646.83 1824.04,-7635.64 3604.68,-7654.1 3654,-7636.83 3664.15,-7633.28 3662.86,-7625.42 3673,-7621.83 3706.36,-7610.01 4275.34,-7620.99 4310,-7613.83 4353.86,-7604.77 4400.76,-7583.86 4432.75,-7567.7"/>
<polygon fill="red" stroke="red" points="4434.48,-7570.75 4441.77,-7563.07 4431.28,-7564.52 4434.48,-7570.75"/>
<text text-anchor="middle" x="3704.5" y="-7625.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu3 -->
<g id="node452" class="node">
<title>l2_attn_stage7_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1870" cy="-7545.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1870" y="-7556.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="1870" y="-7541.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1870" y="-7526.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu3&#45;&gt;l2_attn_stage7_gpu3 -->
<g id="edge420" class="edge">
<title>l2_attn_stage6_gpu3&#45;&gt;l2_attn_stage7_gpu3</title>
<path fill="none" stroke="black" d="M1870,-7654.74C1870,-7636.02 1870,-7613.03 1870,-7593.05"/>
<polygon fill="black" stroke="black" points="1873.5,-7592.91 1870,-7582.91 1866.5,-7592.91 1873.5,-7592.91"/>
</g>
<!-- l2_attn_stage6_gpu3&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge1588" class="edge">
<title>l2_attn_stage6_gpu3&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1923.28,-7662.27C1937.41,-7655.93 1952.94,-7650.13 1968,-7646.83 2016.08,-7636.28 3693.55,-7653.11 3740,-7636.83 3750.15,-7633.27 3748.86,-7625.43 3759,-7621.83 3787.85,-7611.58 4280.02,-7620.05 4310,-7613.83 4353.85,-7604.73 4400.75,-7583.83 4432.75,-7567.67"/>
<polygon fill="red" stroke="red" points="4434.47,-7570.73 4441.77,-7563.05 4431.27,-7564.5 4434.47,-7570.73"/>
<text text-anchor="middle" x="3790.5" y="-7625.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu4 -->
<g id="node453" class="node">
<title>l2_attn_stage7_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2065" cy="-7545.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2065" y="-7556.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="2065" y="-7541.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2065" y="-7526.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu4&#45;&gt;l2_attn_stage7_gpu4 -->
<g id="edge421" class="edge">
<title>l2_attn_stage6_gpu4&#45;&gt;l2_attn_stage7_gpu4</title>
<path fill="none" stroke="black" d="M2065,-7654.74C2065,-7636.02 2065,-7613.03 2065,-7593.05"/>
<polygon fill="black" stroke="black" points="2068.5,-7592.91 2065,-7582.91 2061.5,-7592.91 2068.5,-7592.91"/>
</g>
<!-- l2_attn_stage6_gpu4&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge1589" class="edge">
<title>l2_attn_stage6_gpu4&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2118.28,-7662.27C2132.41,-7655.93 2147.94,-7650.14 2163,-7646.83 2208.12,-7636.93 3782.41,-7652.11 3826,-7636.83 3836.15,-7633.27 3834.87,-7625.45 3845,-7621.83 3893.67,-7604.47 4259.42,-7624.4 4310,-7613.83 4353.84,-7604.67 4400.74,-7583.78 4432.74,-7567.64"/>
<polygon fill="red" stroke="red" points="4434.46,-7570.7 4441.76,-7563.02 4431.27,-7564.47 4434.46,-7570.7"/>
<text text-anchor="middle" x="3876.5" y="-7625.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu5 -->
<g id="node454" class="node">
<title>l2_attn_stage7_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2260" cy="-7545.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2260" y="-7556.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="2260" y="-7541.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2260" y="-7526.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu5&#45;&gt;l2_attn_stage7_gpu5 -->
<g id="edge422" class="edge">
<title>l2_attn_stage6_gpu5&#45;&gt;l2_attn_stage7_gpu5</title>
<path fill="none" stroke="black" d="M2260,-7654.74C2260,-7636.02 2260,-7613.03 2260,-7593.05"/>
<polygon fill="black" stroke="black" points="2263.5,-7592.91 2260,-7582.91 2256.5,-7592.91 2263.5,-7592.91"/>
</g>
<!-- l2_attn_stage6_gpu5&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge1590" class="edge">
<title>l2_attn_stage6_gpu5&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2313.28,-7662.28C2327.41,-7655.94 2342.94,-7650.14 2358,-7646.83 2400.16,-7637.57 3871.27,-7651.12 3912,-7636.83 3922.15,-7633.27 3920.87,-7625.47 3931,-7621.83 3970.64,-7607.6 4268.79,-7622.53 4310,-7613.83 4353.82,-7604.59 4400.73,-7583.7 4432.73,-7567.6"/>
<polygon fill="red" stroke="red" points="4434.45,-7570.65 4441.75,-7562.98 4431.26,-7564.42 4434.45,-7570.65"/>
<text text-anchor="middle" x="3962.5" y="-7625.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu6 -->
<g id="node455" class="node">
<title>l2_attn_stage7_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2455" cy="-7545.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2455" y="-7556.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="2455" y="-7541.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2455" y="-7526.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu6&#45;&gt;l2_attn_stage7_gpu6 -->
<g id="edge423" class="edge">
<title>l2_attn_stage6_gpu6&#45;&gt;l2_attn_stage7_gpu6</title>
<path fill="none" stroke="black" d="M2455,-7654.74C2455,-7636.02 2455,-7613.03 2455,-7593.05"/>
<polygon fill="black" stroke="black" points="2458.5,-7592.91 2455,-7582.91 2451.5,-7592.91 2458.5,-7592.91"/>
</g>
<!-- l2_attn_stage6_gpu6&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge1591" class="edge">
<title>l2_attn_stage6_gpu6&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2508.28,-7662.28C2522.41,-7655.94 2537.94,-7650.14 2553,-7646.83 2592.2,-7638.21 3960.13,-7650.13 3998,-7636.83 4008.15,-7633.27 4006.89,-7625.5 4017,-7621.83 4047.62,-7610.73 4278.15,-7620.65 4310,-7613.83 4353.66,-7604.48 4400.41,-7583.72 4432.42,-7567.67"/>
<polygon fill="red" stroke="red" points="4434.12,-7570.73 4441.45,-7563.07 4430.95,-7564.49 4434.12,-7570.73"/>
<text text-anchor="middle" x="4048.5" y="-7625.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu7 -->
<g id="node456" class="node">
<title>l2_attn_stage7_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2650" cy="-7545.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2650" y="-7556.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="2650" y="-7541.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2650" y="-7526.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu7&#45;&gt;l2_attn_stage7_gpu7 -->
<g id="edge424" class="edge">
<title>l2_attn_stage6_gpu7&#45;&gt;l2_attn_stage7_gpu7</title>
<path fill="none" stroke="black" d="M2650,-7654.74C2650,-7636.02 2650,-7613.03 2650,-7593.05"/>
<polygon fill="black" stroke="black" points="2653.5,-7592.91 2650,-7582.91 2646.5,-7592.91 2653.5,-7592.91"/>
</g>
<!-- l2_attn_stage6_gpu7&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge1592" class="edge">
<title>l2_attn_stage6_gpu7&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2703.28,-7662.29C2717.42,-7655.95 2732.95,-7650.15 2748,-7646.83 2784.24,-7638.85 4048.99,-7649.13 4084,-7636.83 4094.15,-7633.27 4092.91,-7625.56 4103,-7621.83 4146.19,-7605.9 4265.04,-7623.73 4310,-7613.83 4353.6,-7604.23 4400.37,-7583.51 4432.39,-7567.54"/>
<polygon fill="red" stroke="red" points="4434.08,-7570.6 4441.42,-7562.96 4430.92,-7564.36 4434.08,-7570.6"/>
<text text-anchor="middle" x="4134.5" y="-7625.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu8 -->
<g id="node457" class="node">
<title>l2_attn_stage7_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2845" cy="-7545.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2845" y="-7556.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="2845" y="-7541.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2845" y="-7526.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu8&#45;&gt;l2_attn_stage7_gpu8 -->
<g id="edge425" class="edge">
<title>l2_attn_stage6_gpu8&#45;&gt;l2_attn_stage7_gpu8</title>
<path fill="none" stroke="black" d="M2845,-7654.74C2845,-7636.02 2845,-7613.03 2845,-7593.05"/>
<polygon fill="black" stroke="black" points="2848.5,-7592.91 2845,-7582.91 2841.5,-7592.91 2848.5,-7592.91"/>
</g>
<!-- l2_attn_stage6_gpu8&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge1593" class="edge">
<title>l2_attn_stage6_gpu8&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2898.28,-7662.3C2912.42,-7655.96 2927.95,-7650.15 2943,-7646.83 3009.57,-7632.14 4105.69,-7659.45 4170,-7636.83 4180.15,-7633.26 4178.96,-7625.69 4189,-7621.83 4239.3,-7602.49 4257.53,-7626.14 4310,-7613.83 4353.2,-7603.7 4399.67,-7583.25 4431.71,-7567.5"/>
<polygon fill="red" stroke="red" points="4433.38,-7570.59 4440.77,-7562.99 4430.25,-7564.32 4433.38,-7570.59"/>
<text text-anchor="middle" x="4220.5" y="-7625.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu9 -->
<g id="node458" class="node">
<title>l2_attn_stage7_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3040" cy="-7545.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3040" y="-7556.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="3040" y="-7541.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3040" y="-7526.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu9&#45;&gt;l2_attn_stage7_gpu9 -->
<g id="edge426" class="edge">
<title>l2_attn_stage6_gpu9&#45;&gt;l2_attn_stage7_gpu9</title>
<path fill="none" stroke="black" d="M3040,-7654.74C3040,-7636.02 3040,-7613.03 3040,-7593.05"/>
<polygon fill="black" stroke="black" points="3043.5,-7592.91 3040,-7582.91 3036.5,-7592.91 3043.5,-7592.91"/>
</g>
<!-- l2_attn_stage6_gpu9&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge1594" class="edge">
<title>l2_attn_stage6_gpu9&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3093.28,-7662.3C3107.42,-7655.96 3122.95,-7650.16 3138,-7646.83 3198.65,-7633.42 4197.41,-7657.46 4256,-7636.83 4266.15,-7633.26 4265.3,-7626.48 4275,-7621.83 4289.39,-7614.94 4294.8,-7618.7 4310,-7613.83 4350.94,-7600.73 4395.95,-7581.57 4428.12,-7567.01"/>
<polygon fill="red" stroke="red" points="4429.61,-7570.17 4437.25,-7562.84 4426.7,-7563.81 4429.61,-7570.17"/>
<text text-anchor="middle" x="4306.5" y="-7625.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu10 -->
<g id="node459" class="node">
<title>l2_attn_stage7_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3235" cy="-7545.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3235" y="-7556.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="3235" y="-7541.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3235" y="-7526.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu10&#45;&gt;l2_attn_stage7_gpu10 -->
<g id="edge427" class="edge">
<title>l2_attn_stage6_gpu10&#45;&gt;l2_attn_stage7_gpu10</title>
<path fill="none" stroke="black" d="M3235,-7654.74C3235,-7636.02 3235,-7613.03 3235,-7593.05"/>
<polygon fill="black" stroke="black" points="3238.5,-7592.91 3235,-7582.91 3231.5,-7592.91 3238.5,-7592.91"/>
</g>
<!-- l2_attn_stage6_gpu10&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge1595" class="edge">
<title>l2_attn_stage6_gpu10&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3288.29,-7662.31C3302.42,-7655.97 3317.95,-7650.17 3333,-7646.83 3387.73,-7634.7 4289.13,-7655.48 4342,-7636.83 4352.15,-7633.25 4352.32,-7628.19 4361,-7621.83 4386.22,-7603.34 4415.5,-7583.49 4437.65,-7568.78"/>
<polygon fill="red" stroke="red" points="4439.66,-7571.65 4446.07,-7563.22 4435.8,-7565.81 4439.66,-7571.65"/>
<text text-anchor="middle" x="4392.5" y="-7625.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu11 -->
<g id="node460" class="node">
<title>l2_attn_stage7_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3430" cy="-7545.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3430" y="-7556.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="3430" y="-7541.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3430" y="-7526.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu11&#45;&gt;l2_attn_stage7_gpu11 -->
<g id="edge428" class="edge">
<title>l2_attn_stage6_gpu11&#45;&gt;l2_attn_stage7_gpu11</title>
<path fill="none" stroke="black" d="M3430,-7654.74C3430,-7636.02 3430,-7613.03 3430,-7593.05"/>
<polygon fill="black" stroke="black" points="3433.5,-7592.91 3430,-7582.91 3426.5,-7592.91 3433.5,-7592.91"/>
</g>
<!-- l2_attn_stage6_gpu11&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge1596" class="edge">
<title>l2_attn_stage6_gpu11&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3483.29,-7662.33C3497.42,-7655.99 3512.95,-7650.18 3528,-7646.83 3552.41,-7641.41 4406.88,-7650.21 4428,-7636.83 4449.94,-7622.93 4461.24,-7594.65 4466.85,-7573.39"/>
<polygon fill="red" stroke="red" points="4470.27,-7574.14 4469.18,-7563.6 4463.46,-7572.52 4470.27,-7574.14"/>
<text text-anchor="middle" x="4474.5" y="-7625.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu12 -->
<g id="node461" class="node">
<title>l2_attn_stage7_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3625" cy="-7545.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3625" y="-7556.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="3625" y="-7541.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3625" y="-7526.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu12&#45;&gt;l2_attn_stage7_gpu12 -->
<g id="edge429" class="edge">
<title>l2_attn_stage6_gpu12&#45;&gt;l2_attn_stage7_gpu12</title>
<path fill="none" stroke="black" d="M3569.85,-7662.87C3556.43,-7656.83 3541.93,-7651.03 3528,-7646.83 3514.22,-7642.68 3473.36,-7647.77 3464,-7636.83 3429.08,-7596.03 3469.79,-7636.15 3528,-7613.83 3545.78,-7607.01 3563.42,-7596.27 3578.68,-7585.34"/>
<polygon fill="black" stroke="black" points="3580.93,-7588.02 3586.9,-7579.27 3576.77,-7582.39 3580.93,-7588.02"/>
</g>
<!-- l2_attn_stage6_gpu12&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge1597" class="edge">
<title>l2_attn_stage6_gpu12&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3678.29,-7662.34C3692.43,-7656 3707.95,-7650.19 3723,-7646.83 3744.45,-7642.05 4498.56,-7652.47 4514,-7636.83 4532.16,-7618.44 4514.89,-7590.75 4497.31,-7570.84"/>
<polygon fill="red" stroke="red" points="4499.75,-7568.32 4490.38,-7563.37 4494.61,-7573.08 4499.75,-7568.32"/>
<text text-anchor="middle" x="4552.5" y="-7625.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu13 -->
<g id="node462" class="node">
<title>l2_attn_stage7_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3820" cy="-7545.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3820" y="-7556.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="3820" y="-7541.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3820" y="-7526.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu13&#45;&gt;l2_attn_stage7_gpu13 -->
<g id="edge430" class="edge">
<title>l2_attn_stage6_gpu13&#45;&gt;l2_attn_stage7_gpu13</title>
<path fill="none" stroke="black" d="M3766.7,-7662.39C3752.85,-7656.13 3737.69,-7650.35 3723,-7646.83 3709.37,-7643.57 3480.71,-7646.93 3471,-7636.83 3466.38,-7632.03 3466.36,-7626.62 3471,-7621.83 3480.75,-7611.77 3709.7,-7618.24 3723,-7613.83 3741.4,-7607.74 3759.44,-7596.94 3774.87,-7585.75"/>
<polygon fill="black" stroke="black" points="3777.27,-7588.33 3783.16,-7579.52 3773.06,-7582.73 3777.27,-7588.33"/>
</g>
<!-- l2_attn_stage6_gpu13&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge1598" class="edge">
<title>l2_attn_stage6_gpu13&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3873.3,-7662.36C3887.43,-7656.02 3902.96,-7650.2 3918,-7646.83 3936.49,-7642.69 4586.7,-7650.33 4600,-7636.83 4628.36,-7608.06 4580.79,-7582.22 4535.82,-7565.6"/>
<polygon fill="red" stroke="red" points="4536.88,-7562.26 4526.29,-7562.19 4534.53,-7568.85 4536.88,-7562.26"/>
<text text-anchor="middle" x="4639.5" y="-7625.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu14 -->
<g id="node463" class="node">
<title>l2_attn_stage7_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4015" cy="-7545.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4015" y="-7556.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="4015" y="-7541.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4015" y="-7526.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu14&#45;&gt;l2_attn_stage7_gpu14 -->
<g id="edge431" class="edge">
<title>l2_attn_stage6_gpu14&#45;&gt;l2_attn_stage7_gpu14</title>
<path fill="none" stroke="black" d="M3961.74,-7662.22C3947.89,-7655.96 3932.71,-7650.22 3918,-7646.83 3894.17,-7641.34 3495.09,-7654.32 3478,-7636.83 3473.34,-7632.06 3473.33,-7626.59 3478,-7621.83 3486.56,-7613.11 3906.37,-7617.6 3918,-7613.83 3936.45,-7607.86 3954.49,-7597.1 3969.92,-7585.9"/>
<polygon fill="black" stroke="black" points="3972.32,-7588.47 3978.2,-7579.66 3968.11,-7582.88 3972.32,-7588.47"/>
</g>
<!-- l2_attn_stage6_gpu14&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge1599" class="edge">
<title>l2_attn_stage6_gpu14&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4068.3,-7662.39C4082.44,-7656.05 4097.96,-7650.22 4113,-7646.83 4128.53,-7643.33 4674.84,-7648.19 4686,-7636.83 4726.03,-7596.09 4656.32,-7572.74 4586.01,-7559.99"/>
<polygon fill="red" stroke="red" points="4586.55,-7556.53 4576.1,-7558.26 4585.35,-7563.43 4586.55,-7556.53"/>
<text text-anchor="middle" x="4726.5" y="-7625.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage7_gpu15 -->
<g id="node464" class="node">
<title>l2_attn_stage7_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4210" cy="-7545.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4210" y="-7556.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage7</text>
<text text-anchor="middle" x="4210" y="-7541.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4210" y="-7526.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage6_gpu15&#45;&gt;l2_attn_stage7_gpu15 -->
<g id="edge432" class="edge">
<title>l2_attn_stage6_gpu15&#45;&gt;l2_attn_stage7_gpu15</title>
<path fill="none" stroke="black" d="M4157.02,-7662.26C4143.09,-7655.97 4127.82,-7650.19 4113,-7646.83 4095.99,-7642.97 3497.24,-7649.27 3485,-7636.83 3480.32,-7632.08 3480.32,-7626.58 3485,-7621.83 3497.26,-7609.42 4096.39,-7619.16 4113,-7613.83 4131.46,-7607.91 4149.51,-7597.16 4164.94,-7585.96"/>
<polygon fill="black" stroke="black" points="4167.34,-7588.53 4173.22,-7579.72 4163.13,-7582.94 4167.34,-7588.53"/>
</g>
<!-- l2_attn_stage6_gpu15&#45;&gt;l2_attn_stage7_gpu[next_gpu] -->
<g id="edge1600" class="edge">
<title>l2_attn_stage6_gpu15&#45;&gt;l2_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4265.38,-7663.02C4280.74,-7656.45 4297.68,-7650.36 4314,-7646.83 4338.87,-7641.45 4754.2,-7655.02 4772,-7636.83 4826.67,-7580.96 4725.45,-7559.29 4626.12,-7551.04"/>
<polygon fill="red" stroke="red" points="4626.15,-7547.53 4615.9,-7550.24 4625.6,-7554.51 4626.15,-7547.53"/>
<text text-anchor="middle" x="4812.5" y="-7625.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu0 -->
<g id="node465" class="node">
<title>l2_attn_stage8_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1285" cy="-7398.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1285" y="-7409.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="1285" y="-7394.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1285" y="-7379.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu0&#45;&gt;l2_attn_stage8_gpu0 -->
<g id="edge433" class="edge">
<title>l2_attn_stage7_gpu0&#45;&gt;l2_attn_stage8_gpu0</title>
<path fill="none" stroke="black" d="M1285,-7507.74C1285,-7489.02 1285,-7466.03 1285,-7446.05"/>
<polygon fill="black" stroke="black" points="1288.5,-7445.91 1285,-7435.91 1281.5,-7445.91 1288.5,-7445.91"/>
</g>
<!-- l2_attn_stage8_gpu[next_gpu] -->
<g id="node1335" class="node">
<title>l2_attn_stage8_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4472" cy="-7398.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4472" y="-7394.63" font-family="Times,serif" font-size="14.00">l2_attn_stage8_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage7_gpu0&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge1601" class="edge">
<title>l2_attn_stage7_gpu0&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1338.29,-7515.33C1352.43,-7508.99 1367.95,-7503.18 1383,-7499.83 1612.73,-7448.7 3265.66,-7477.38 3501,-7474.83 3545.94,-7474.34 4265.97,-7475.86 4310,-7466.83 4353.87,-7457.83 4400.77,-7436.91 4432.76,-7420.73"/>
<polygon fill="red" stroke="red" points="4434.49,-7423.78 4441.78,-7416.09 4431.28,-7417.55 4434.49,-7423.78"/>
<text text-anchor="middle" x="3532.5" y="-7478.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu1 -->
<g id="node466" class="node">
<title>l2_attn_stage8_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1480" cy="-7398.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1480" y="-7409.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="1480" y="-7394.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1480" y="-7379.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu1&#45;&gt;l2_attn_stage8_gpu1 -->
<g id="edge434" class="edge">
<title>l2_attn_stage7_gpu1&#45;&gt;l2_attn_stage8_gpu1</title>
<path fill="none" stroke="black" d="M1480,-7507.74C1480,-7489.02 1480,-7466.03 1480,-7446.05"/>
<polygon fill="black" stroke="black" points="1483.5,-7445.91 1480,-7435.91 1476.5,-7445.91 1483.5,-7445.91"/>
</g>
<!-- l2_attn_stage7_gpu1&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge1602" class="edge">
<title>l2_attn_stage7_gpu1&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1533.28,-7515.26C1547.41,-7508.92 1562.94,-7503.13 1578,-7499.83 1632,-7488 3515.82,-7508.09 3568,-7489.83 3578.15,-7486.28 3576.86,-7478.42 3587,-7474.83 3624.87,-7461.45 4270.66,-7474.93 4310,-7466.83 4353.87,-7457.81 4400.77,-7436.89 4432.76,-7420.72"/>
<polygon fill="red" stroke="red" points="4434.48,-7423.76 4441.78,-7416.08 4431.28,-7417.54 4434.48,-7423.76"/>
<text text-anchor="middle" x="3618.5" y="-7478.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu2 -->
<g id="node467" class="node">
<title>l2_attn_stage8_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1675" cy="-7398.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1675" y="-7409.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="1675" y="-7394.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1675" y="-7379.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu2&#45;&gt;l2_attn_stage8_gpu2 -->
<g id="edge435" class="edge">
<title>l2_attn_stage7_gpu2&#45;&gt;l2_attn_stage8_gpu2</title>
<path fill="none" stroke="black" d="M1675,-7507.74C1675,-7489.02 1675,-7466.03 1675,-7446.05"/>
<polygon fill="black" stroke="black" points="1678.5,-7445.91 1675,-7435.91 1671.5,-7445.91 1678.5,-7445.91"/>
</g>
<!-- l2_attn_stage7_gpu2&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge1603" class="edge">
<title>l2_attn_stage7_gpu2&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1728.28,-7515.27C1742.41,-7508.93 1757.94,-7503.13 1773,-7499.83 1824.04,-7488.64 3604.68,-7507.1 3654,-7489.83 3664.15,-7486.28 3662.86,-7478.42 3673,-7474.83 3706.36,-7463.01 4275.34,-7473.99 4310,-7466.83 4353.86,-7457.77 4400.76,-7436.86 4432.75,-7420.7"/>
<polygon fill="red" stroke="red" points="4434.48,-7423.75 4441.77,-7416.07 4431.28,-7417.52 4434.48,-7423.75"/>
<text text-anchor="middle" x="3704.5" y="-7478.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu3 -->
<g id="node468" class="node">
<title>l2_attn_stage8_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1870" cy="-7398.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1870" y="-7409.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="1870" y="-7394.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1870" y="-7379.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu3&#45;&gt;l2_attn_stage8_gpu3 -->
<g id="edge436" class="edge">
<title>l2_attn_stage7_gpu3&#45;&gt;l2_attn_stage8_gpu3</title>
<path fill="none" stroke="black" d="M1870,-7507.74C1870,-7489.02 1870,-7466.03 1870,-7446.05"/>
<polygon fill="black" stroke="black" points="1873.5,-7445.91 1870,-7435.91 1866.5,-7445.91 1873.5,-7445.91"/>
</g>
<!-- l2_attn_stage7_gpu3&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge1604" class="edge">
<title>l2_attn_stage7_gpu3&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1923.28,-7515.27C1937.41,-7508.93 1952.94,-7503.13 1968,-7499.83 2016.08,-7489.28 3693.55,-7506.11 3740,-7489.83 3750.15,-7486.27 3748.86,-7478.43 3759,-7474.83 3787.85,-7464.58 4280.02,-7473.05 4310,-7466.83 4353.85,-7457.73 4400.75,-7436.83 4432.75,-7420.67"/>
<polygon fill="red" stroke="red" points="4434.47,-7423.73 4441.77,-7416.05 4431.27,-7417.5 4434.47,-7423.73"/>
<text text-anchor="middle" x="3790.5" y="-7478.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu4 -->
<g id="node469" class="node">
<title>l2_attn_stage8_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2065" cy="-7398.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2065" y="-7409.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="2065" y="-7394.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2065" y="-7379.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu4&#45;&gt;l2_attn_stage8_gpu4 -->
<g id="edge437" class="edge">
<title>l2_attn_stage7_gpu4&#45;&gt;l2_attn_stage8_gpu4</title>
<path fill="none" stroke="black" d="M2065,-7507.74C2065,-7489.02 2065,-7466.03 2065,-7446.05"/>
<polygon fill="black" stroke="black" points="2068.5,-7445.91 2065,-7435.91 2061.5,-7445.91 2068.5,-7445.91"/>
</g>
<!-- l2_attn_stage7_gpu4&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge1605" class="edge">
<title>l2_attn_stage7_gpu4&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2118.28,-7515.27C2132.41,-7508.93 2147.94,-7503.14 2163,-7499.83 2208.12,-7489.93 3782.41,-7505.11 3826,-7489.83 3836.15,-7486.27 3834.87,-7478.45 3845,-7474.83 3893.67,-7457.47 4259.42,-7477.4 4310,-7466.83 4353.84,-7457.67 4400.74,-7436.78 4432.74,-7420.64"/>
<polygon fill="red" stroke="red" points="4434.46,-7423.7 4441.76,-7416.02 4431.27,-7417.47 4434.46,-7423.7"/>
<text text-anchor="middle" x="3876.5" y="-7478.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu5 -->
<g id="node470" class="node">
<title>l2_attn_stage8_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2260" cy="-7398.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2260" y="-7409.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="2260" y="-7394.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2260" y="-7379.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu5&#45;&gt;l2_attn_stage8_gpu5 -->
<g id="edge438" class="edge">
<title>l2_attn_stage7_gpu5&#45;&gt;l2_attn_stage8_gpu5</title>
<path fill="none" stroke="black" d="M2260,-7507.74C2260,-7489.02 2260,-7466.03 2260,-7446.05"/>
<polygon fill="black" stroke="black" points="2263.5,-7445.91 2260,-7435.91 2256.5,-7445.91 2263.5,-7445.91"/>
</g>
<!-- l2_attn_stage7_gpu5&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge1606" class="edge">
<title>l2_attn_stage7_gpu5&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2313.28,-7515.28C2327.41,-7508.94 2342.94,-7503.14 2358,-7499.83 2400.16,-7490.57 3871.27,-7504.12 3912,-7489.83 3922.15,-7486.27 3920.87,-7478.47 3931,-7474.83 3970.64,-7460.6 4268.79,-7475.53 4310,-7466.83 4353.82,-7457.59 4400.73,-7436.7 4432.73,-7420.6"/>
<polygon fill="red" stroke="red" points="4434.45,-7423.65 4441.75,-7415.98 4431.26,-7417.42 4434.45,-7423.65"/>
<text text-anchor="middle" x="3962.5" y="-7478.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu6 -->
<g id="node471" class="node">
<title>l2_attn_stage8_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2455" cy="-7398.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2455" y="-7409.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="2455" y="-7394.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2455" y="-7379.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu6&#45;&gt;l2_attn_stage8_gpu6 -->
<g id="edge439" class="edge">
<title>l2_attn_stage7_gpu6&#45;&gt;l2_attn_stage8_gpu6</title>
<path fill="none" stroke="black" d="M2455,-7507.74C2455,-7489.02 2455,-7466.03 2455,-7446.05"/>
<polygon fill="black" stroke="black" points="2458.5,-7445.91 2455,-7435.91 2451.5,-7445.91 2458.5,-7445.91"/>
</g>
<!-- l2_attn_stage7_gpu6&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge1607" class="edge">
<title>l2_attn_stage7_gpu6&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2508.28,-7515.28C2522.41,-7508.94 2537.94,-7503.14 2553,-7499.83 2592.2,-7491.21 3960.13,-7503.13 3998,-7489.83 4008.15,-7486.27 4006.89,-7478.5 4017,-7474.83 4047.62,-7463.73 4278.15,-7473.65 4310,-7466.83 4353.66,-7457.48 4400.41,-7436.72 4432.42,-7420.67"/>
<polygon fill="red" stroke="red" points="4434.12,-7423.73 4441.45,-7416.07 4430.95,-7417.49 4434.12,-7423.73"/>
<text text-anchor="middle" x="4048.5" y="-7478.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu7 -->
<g id="node472" class="node">
<title>l2_attn_stage8_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2650" cy="-7398.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2650" y="-7409.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="2650" y="-7394.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2650" y="-7379.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu7&#45;&gt;l2_attn_stage8_gpu7 -->
<g id="edge440" class="edge">
<title>l2_attn_stage7_gpu7&#45;&gt;l2_attn_stage8_gpu7</title>
<path fill="none" stroke="black" d="M2650,-7507.74C2650,-7489.02 2650,-7466.03 2650,-7446.05"/>
<polygon fill="black" stroke="black" points="2653.5,-7445.91 2650,-7435.91 2646.5,-7445.91 2653.5,-7445.91"/>
</g>
<!-- l2_attn_stage7_gpu7&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge1608" class="edge">
<title>l2_attn_stage7_gpu7&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2703.28,-7515.29C2717.42,-7508.95 2732.95,-7503.15 2748,-7499.83 2784.24,-7491.85 4048.99,-7502.13 4084,-7489.83 4094.15,-7486.27 4092.91,-7478.56 4103,-7474.83 4146.19,-7458.9 4265.04,-7476.73 4310,-7466.83 4353.6,-7457.23 4400.37,-7436.51 4432.39,-7420.54"/>
<polygon fill="red" stroke="red" points="4434.08,-7423.6 4441.42,-7415.96 4430.92,-7417.36 4434.08,-7423.6"/>
<text text-anchor="middle" x="4134.5" y="-7478.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu8 -->
<g id="node473" class="node">
<title>l2_attn_stage8_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2845" cy="-7398.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2845" y="-7409.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="2845" y="-7394.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2845" y="-7379.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu8&#45;&gt;l2_attn_stage8_gpu8 -->
<g id="edge441" class="edge">
<title>l2_attn_stage7_gpu8&#45;&gt;l2_attn_stage8_gpu8</title>
<path fill="none" stroke="black" d="M2845,-7507.74C2845,-7489.02 2845,-7466.03 2845,-7446.05"/>
<polygon fill="black" stroke="black" points="2848.5,-7445.91 2845,-7435.91 2841.5,-7445.91 2848.5,-7445.91"/>
</g>
<!-- l2_attn_stage7_gpu8&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge1609" class="edge">
<title>l2_attn_stage7_gpu8&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2898.28,-7515.3C2912.42,-7508.96 2927.95,-7503.15 2943,-7499.83 3009.57,-7485.14 4105.69,-7512.45 4170,-7489.83 4180.15,-7486.26 4178.96,-7478.69 4189,-7474.83 4239.3,-7455.49 4257.53,-7479.14 4310,-7466.83 4353.2,-7456.7 4399.67,-7436.25 4431.71,-7420.5"/>
<polygon fill="red" stroke="red" points="4433.38,-7423.59 4440.77,-7415.99 4430.25,-7417.32 4433.38,-7423.59"/>
<text text-anchor="middle" x="4220.5" y="-7478.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu9 -->
<g id="node474" class="node">
<title>l2_attn_stage8_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3040" cy="-7398.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3040" y="-7409.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="3040" y="-7394.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3040" y="-7379.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu9&#45;&gt;l2_attn_stage8_gpu9 -->
<g id="edge442" class="edge">
<title>l2_attn_stage7_gpu9&#45;&gt;l2_attn_stage8_gpu9</title>
<path fill="none" stroke="black" d="M3040,-7507.74C3040,-7489.02 3040,-7466.03 3040,-7446.05"/>
<polygon fill="black" stroke="black" points="3043.5,-7445.91 3040,-7435.91 3036.5,-7445.91 3043.5,-7445.91"/>
</g>
<!-- l2_attn_stage7_gpu9&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge1610" class="edge">
<title>l2_attn_stage7_gpu9&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3093.28,-7515.3C3107.42,-7508.96 3122.95,-7503.16 3138,-7499.83 3198.65,-7486.42 4197.41,-7510.46 4256,-7489.83 4266.15,-7486.26 4265.3,-7479.48 4275,-7474.83 4289.39,-7467.94 4294.8,-7471.7 4310,-7466.83 4350.94,-7453.73 4395.95,-7434.57 4428.12,-7420.01"/>
<polygon fill="red" stroke="red" points="4429.61,-7423.17 4437.25,-7415.84 4426.7,-7416.81 4429.61,-7423.17"/>
<text text-anchor="middle" x="4306.5" y="-7478.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu10 -->
<g id="node475" class="node">
<title>l2_attn_stage8_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3235" cy="-7398.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3235" y="-7409.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="3235" y="-7394.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3235" y="-7379.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu10&#45;&gt;l2_attn_stage8_gpu10 -->
<g id="edge443" class="edge">
<title>l2_attn_stage7_gpu10&#45;&gt;l2_attn_stage8_gpu10</title>
<path fill="none" stroke="black" d="M3235,-7507.74C3235,-7489.02 3235,-7466.03 3235,-7446.05"/>
<polygon fill="black" stroke="black" points="3238.5,-7445.91 3235,-7435.91 3231.5,-7445.91 3238.5,-7445.91"/>
</g>
<!-- l2_attn_stage7_gpu10&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge1611" class="edge">
<title>l2_attn_stage7_gpu10&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3288.29,-7515.31C3302.42,-7508.97 3317.95,-7503.17 3333,-7499.83 3387.73,-7487.7 4289.13,-7508.48 4342,-7489.83 4352.15,-7486.25 4352.32,-7481.19 4361,-7474.83 4386.22,-7456.34 4415.5,-7436.49 4437.65,-7421.78"/>
<polygon fill="red" stroke="red" points="4439.66,-7424.65 4446.07,-7416.22 4435.8,-7418.81 4439.66,-7424.65"/>
<text text-anchor="middle" x="4392.5" y="-7478.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu11 -->
<g id="node476" class="node">
<title>l2_attn_stage8_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3430" cy="-7398.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3430" y="-7409.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="3430" y="-7394.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3430" y="-7379.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu11&#45;&gt;l2_attn_stage8_gpu11 -->
<g id="edge444" class="edge">
<title>l2_attn_stage7_gpu11&#45;&gt;l2_attn_stage8_gpu11</title>
<path fill="none" stroke="black" d="M3430,-7507.74C3430,-7489.02 3430,-7466.03 3430,-7446.05"/>
<polygon fill="black" stroke="black" points="3433.5,-7445.91 3430,-7435.91 3426.5,-7445.91 3433.5,-7445.91"/>
</g>
<!-- l2_attn_stage7_gpu11&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge1612" class="edge">
<title>l2_attn_stage7_gpu11&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3483.29,-7515.33C3497.42,-7508.99 3512.95,-7503.18 3528,-7499.83 3552.41,-7494.41 4406.88,-7503.21 4428,-7489.83 4449.94,-7475.93 4461.24,-7447.65 4466.85,-7426.39"/>
<polygon fill="red" stroke="red" points="4470.27,-7427.14 4469.18,-7416.6 4463.46,-7425.52 4470.27,-7427.14"/>
<text text-anchor="middle" x="4474.5" y="-7478.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu12 -->
<g id="node477" class="node">
<title>l2_attn_stage8_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3625" cy="-7398.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3625" y="-7409.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="3625" y="-7394.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3625" y="-7379.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu12&#45;&gt;l2_attn_stage8_gpu12 -->
<g id="edge445" class="edge">
<title>l2_attn_stage7_gpu12&#45;&gt;l2_attn_stage8_gpu12</title>
<path fill="none" stroke="black" d="M3569.85,-7515.87C3556.43,-7509.83 3541.93,-7504.03 3528,-7499.83 3514.22,-7495.68 3473.36,-7500.77 3464,-7489.83 3429.08,-7449.03 3469.79,-7489.15 3528,-7466.83 3545.78,-7460.01 3563.42,-7449.27 3578.68,-7438.34"/>
<polygon fill="black" stroke="black" points="3580.93,-7441.02 3586.9,-7432.27 3576.77,-7435.39 3580.93,-7441.02"/>
</g>
<!-- l2_attn_stage7_gpu12&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge1613" class="edge">
<title>l2_attn_stage7_gpu12&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3678.29,-7515.34C3692.43,-7509 3707.95,-7503.19 3723,-7499.83 3744.45,-7495.05 4498.56,-7505.47 4514,-7489.83 4532.16,-7471.44 4514.89,-7443.75 4497.31,-7423.84"/>
<polygon fill="red" stroke="red" points="4499.75,-7421.32 4490.38,-7416.37 4494.61,-7426.08 4499.75,-7421.32"/>
<text text-anchor="middle" x="4552.5" y="-7478.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu13 -->
<g id="node478" class="node">
<title>l2_attn_stage8_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3820" cy="-7398.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3820" y="-7409.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="3820" y="-7394.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3820" y="-7379.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu13&#45;&gt;l2_attn_stage8_gpu13 -->
<g id="edge446" class="edge">
<title>l2_attn_stage7_gpu13&#45;&gt;l2_attn_stage8_gpu13</title>
<path fill="none" stroke="black" d="M3766.7,-7515.39C3752.85,-7509.13 3737.69,-7503.35 3723,-7499.83 3709.37,-7496.57 3480.71,-7499.93 3471,-7489.83 3466.38,-7485.03 3466.36,-7479.62 3471,-7474.83 3480.75,-7464.77 3709.7,-7471.24 3723,-7466.83 3741.4,-7460.74 3759.44,-7449.94 3774.87,-7438.75"/>
<polygon fill="black" stroke="black" points="3777.27,-7441.33 3783.16,-7432.52 3773.06,-7435.73 3777.27,-7441.33"/>
</g>
<!-- l2_attn_stage7_gpu13&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge1614" class="edge">
<title>l2_attn_stage7_gpu13&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3873.3,-7515.36C3887.43,-7509.02 3902.96,-7503.2 3918,-7499.83 3936.49,-7495.69 4586.7,-7503.33 4600,-7489.83 4628.36,-7461.06 4580.79,-7435.22 4535.82,-7418.6"/>
<polygon fill="red" stroke="red" points="4536.88,-7415.26 4526.29,-7415.19 4534.53,-7421.85 4536.88,-7415.26"/>
<text text-anchor="middle" x="4639.5" y="-7478.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu14 -->
<g id="node479" class="node">
<title>l2_attn_stage8_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4015" cy="-7398.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4015" y="-7409.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="4015" y="-7394.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4015" y="-7379.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu14&#45;&gt;l2_attn_stage8_gpu14 -->
<g id="edge447" class="edge">
<title>l2_attn_stage7_gpu14&#45;&gt;l2_attn_stage8_gpu14</title>
<path fill="none" stroke="black" d="M3961.74,-7515.22C3947.89,-7508.96 3932.71,-7503.22 3918,-7499.83 3894.17,-7494.34 3495.09,-7507.32 3478,-7489.83 3473.34,-7485.06 3473.33,-7479.59 3478,-7474.83 3486.56,-7466.11 3906.37,-7470.6 3918,-7466.83 3936.45,-7460.86 3954.49,-7450.1 3969.92,-7438.9"/>
<polygon fill="black" stroke="black" points="3972.32,-7441.47 3978.2,-7432.66 3968.11,-7435.88 3972.32,-7441.47"/>
</g>
<!-- l2_attn_stage7_gpu14&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge1615" class="edge">
<title>l2_attn_stage7_gpu14&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4068.3,-7515.39C4082.44,-7509.05 4097.96,-7503.22 4113,-7499.83 4128.53,-7496.33 4674.84,-7501.19 4686,-7489.83 4726.03,-7449.09 4656.32,-7425.74 4586.01,-7412.99"/>
<polygon fill="red" stroke="red" points="4586.55,-7409.53 4576.1,-7411.26 4585.35,-7416.43 4586.55,-7409.53"/>
<text text-anchor="middle" x="4726.5" y="-7478.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage8_gpu15 -->
<g id="node480" class="node">
<title>l2_attn_stage8_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4210" cy="-7398.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4210" y="-7409.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage8</text>
<text text-anchor="middle" x="4210" y="-7394.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4210" y="-7379.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage7_gpu15&#45;&gt;l2_attn_stage8_gpu15 -->
<g id="edge448" class="edge">
<title>l2_attn_stage7_gpu15&#45;&gt;l2_attn_stage8_gpu15</title>
<path fill="none" stroke="black" d="M4157.02,-7515.26C4143.09,-7508.97 4127.82,-7503.19 4113,-7499.83 4095.99,-7495.97 3497.24,-7502.27 3485,-7489.83 3480.32,-7485.08 3480.32,-7479.58 3485,-7474.83 3497.26,-7462.42 4096.39,-7472.16 4113,-7466.83 4131.46,-7460.91 4149.51,-7450.16 4164.94,-7438.96"/>
<polygon fill="black" stroke="black" points="4167.34,-7441.53 4173.22,-7432.72 4163.13,-7435.94 4167.34,-7441.53"/>
</g>
<!-- l2_attn_stage7_gpu15&#45;&gt;l2_attn_stage8_gpu[next_gpu] -->
<g id="edge1616" class="edge">
<title>l2_attn_stage7_gpu15&#45;&gt;l2_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4265.38,-7516.02C4280.74,-7509.45 4297.68,-7503.36 4314,-7499.83 4338.87,-7494.45 4754.2,-7508.02 4772,-7489.83 4826.67,-7433.96 4725.45,-7412.29 4626.12,-7404.04"/>
<polygon fill="red" stroke="red" points="4626.15,-7400.53 4615.9,-7403.24 4625.6,-7407.51 4626.15,-7400.53"/>
<text text-anchor="middle" x="4812.5" y="-7478.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu0 -->
<g id="node481" class="node">
<title>l2_attn_stage9_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1285" cy="-7251.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1285" y="-7262.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="1285" y="-7247.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1285" y="-7232.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu0&#45;&gt;l2_attn_stage9_gpu0 -->
<g id="edge449" class="edge">
<title>l2_attn_stage8_gpu0&#45;&gt;l2_attn_stage9_gpu0</title>
<path fill="none" stroke="black" d="M1285,-7360.74C1285,-7342.02 1285,-7319.03 1285,-7299.05"/>
<polygon fill="black" stroke="black" points="1288.5,-7298.91 1285,-7288.91 1281.5,-7298.91 1288.5,-7298.91"/>
</g>
<!-- l2_attn_stage9_gpu[next_gpu] -->
<g id="node1336" class="node">
<title>l2_attn_stage9_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4472" cy="-7251.33" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4472" y="-7247.63" font-family="Times,serif" font-size="14.00">l2_attn_stage9_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage8_gpu0&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge1617" class="edge">
<title>l2_attn_stage8_gpu0&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1338.29,-7368.33C1352.43,-7361.99 1367.95,-7356.18 1383,-7352.83 1612.73,-7301.7 3265.66,-7330.38 3501,-7327.83 3545.94,-7327.34 4265.97,-7328.86 4310,-7319.83 4353.87,-7310.83 4400.77,-7289.91 4432.76,-7273.73"/>
<polygon fill="red" stroke="red" points="4434.49,-7276.78 4441.78,-7269.09 4431.28,-7270.55 4434.49,-7276.78"/>
<text text-anchor="middle" x="3532.5" y="-7331.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu1 -->
<g id="node482" class="node">
<title>l2_attn_stage9_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1480" cy="-7251.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1480" y="-7262.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="1480" y="-7247.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1480" y="-7232.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu1&#45;&gt;l2_attn_stage9_gpu1 -->
<g id="edge450" class="edge">
<title>l2_attn_stage8_gpu1&#45;&gt;l2_attn_stage9_gpu1</title>
<path fill="none" stroke="black" d="M1480,-7360.74C1480,-7342.02 1480,-7319.03 1480,-7299.05"/>
<polygon fill="black" stroke="black" points="1483.5,-7298.91 1480,-7288.91 1476.5,-7298.91 1483.5,-7298.91"/>
</g>
<!-- l2_attn_stage8_gpu1&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge1618" class="edge">
<title>l2_attn_stage8_gpu1&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1533.28,-7368.26C1547.41,-7361.92 1562.94,-7356.13 1578,-7352.83 1632,-7341 3515.82,-7361.09 3568,-7342.83 3578.15,-7339.28 3576.86,-7331.42 3587,-7327.83 3624.87,-7314.45 4270.66,-7327.93 4310,-7319.83 4353.87,-7310.81 4400.77,-7289.89 4432.76,-7273.72"/>
<polygon fill="red" stroke="red" points="4434.48,-7276.76 4441.78,-7269.08 4431.28,-7270.54 4434.48,-7276.76"/>
<text text-anchor="middle" x="3618.5" y="-7331.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu2 -->
<g id="node483" class="node">
<title>l2_attn_stage9_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1675" cy="-7251.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1675" y="-7262.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="1675" y="-7247.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1675" y="-7232.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu2&#45;&gt;l2_attn_stage9_gpu2 -->
<g id="edge451" class="edge">
<title>l2_attn_stage8_gpu2&#45;&gt;l2_attn_stage9_gpu2</title>
<path fill="none" stroke="black" d="M1675,-7360.74C1675,-7342.02 1675,-7319.03 1675,-7299.05"/>
<polygon fill="black" stroke="black" points="1678.5,-7298.91 1675,-7288.91 1671.5,-7298.91 1678.5,-7298.91"/>
</g>
<!-- l2_attn_stage8_gpu2&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge1619" class="edge">
<title>l2_attn_stage8_gpu2&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1728.28,-7368.27C1742.41,-7361.93 1757.94,-7356.13 1773,-7352.83 1824.04,-7341.64 3604.68,-7360.1 3654,-7342.83 3664.15,-7339.28 3662.86,-7331.42 3673,-7327.83 3706.36,-7316.01 4275.34,-7326.99 4310,-7319.83 4353.86,-7310.77 4400.76,-7289.86 4432.75,-7273.7"/>
<polygon fill="red" stroke="red" points="4434.48,-7276.75 4441.77,-7269.07 4431.28,-7270.52 4434.48,-7276.75"/>
<text text-anchor="middle" x="3704.5" y="-7331.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu3 -->
<g id="node484" class="node">
<title>l2_attn_stage9_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1870" cy="-7251.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1870" y="-7262.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="1870" y="-7247.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1870" y="-7232.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu3&#45;&gt;l2_attn_stage9_gpu3 -->
<g id="edge452" class="edge">
<title>l2_attn_stage8_gpu3&#45;&gt;l2_attn_stage9_gpu3</title>
<path fill="none" stroke="black" d="M1870,-7360.74C1870,-7342.02 1870,-7319.03 1870,-7299.05"/>
<polygon fill="black" stroke="black" points="1873.5,-7298.91 1870,-7288.91 1866.5,-7298.91 1873.5,-7298.91"/>
</g>
<!-- l2_attn_stage8_gpu3&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge1620" class="edge">
<title>l2_attn_stage8_gpu3&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1923.28,-7368.27C1937.41,-7361.93 1952.94,-7356.13 1968,-7352.83 2016.08,-7342.28 3693.55,-7359.11 3740,-7342.83 3750.15,-7339.27 3748.86,-7331.43 3759,-7327.83 3787.85,-7317.58 4280.02,-7326.05 4310,-7319.83 4353.85,-7310.73 4400.75,-7289.83 4432.75,-7273.67"/>
<polygon fill="red" stroke="red" points="4434.47,-7276.73 4441.77,-7269.05 4431.27,-7270.5 4434.47,-7276.73"/>
<text text-anchor="middle" x="3790.5" y="-7331.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu4 -->
<g id="node485" class="node">
<title>l2_attn_stage9_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2065" cy="-7251.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2065" y="-7262.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="2065" y="-7247.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2065" y="-7232.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu4&#45;&gt;l2_attn_stage9_gpu4 -->
<g id="edge453" class="edge">
<title>l2_attn_stage8_gpu4&#45;&gt;l2_attn_stage9_gpu4</title>
<path fill="none" stroke="black" d="M2065,-7360.74C2065,-7342.02 2065,-7319.03 2065,-7299.05"/>
<polygon fill="black" stroke="black" points="2068.5,-7298.91 2065,-7288.91 2061.5,-7298.91 2068.5,-7298.91"/>
</g>
<!-- l2_attn_stage8_gpu4&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge1621" class="edge">
<title>l2_attn_stage8_gpu4&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2118.28,-7368.27C2132.41,-7361.93 2147.94,-7356.14 2163,-7352.83 2208.12,-7342.93 3782.41,-7358.11 3826,-7342.83 3836.15,-7339.27 3834.87,-7331.45 3845,-7327.83 3893.67,-7310.47 4259.42,-7330.4 4310,-7319.83 4353.84,-7310.67 4400.74,-7289.78 4432.74,-7273.64"/>
<polygon fill="red" stroke="red" points="4434.46,-7276.7 4441.76,-7269.02 4431.27,-7270.47 4434.46,-7276.7"/>
<text text-anchor="middle" x="3876.5" y="-7331.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu5 -->
<g id="node486" class="node">
<title>l2_attn_stage9_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2260" cy="-7251.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2260" y="-7262.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="2260" y="-7247.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2260" y="-7232.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu5&#45;&gt;l2_attn_stage9_gpu5 -->
<g id="edge454" class="edge">
<title>l2_attn_stage8_gpu5&#45;&gt;l2_attn_stage9_gpu5</title>
<path fill="none" stroke="black" d="M2260,-7360.74C2260,-7342.02 2260,-7319.03 2260,-7299.05"/>
<polygon fill="black" stroke="black" points="2263.5,-7298.91 2260,-7288.91 2256.5,-7298.91 2263.5,-7298.91"/>
</g>
<!-- l2_attn_stage8_gpu5&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge1622" class="edge">
<title>l2_attn_stage8_gpu5&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2313.28,-7368.28C2327.41,-7361.94 2342.94,-7356.14 2358,-7352.83 2400.16,-7343.57 3871.27,-7357.12 3912,-7342.83 3922.15,-7339.27 3920.87,-7331.47 3931,-7327.83 3970.64,-7313.6 4268.79,-7328.53 4310,-7319.83 4353.82,-7310.59 4400.73,-7289.7 4432.73,-7273.6"/>
<polygon fill="red" stroke="red" points="4434.45,-7276.65 4441.75,-7268.98 4431.26,-7270.42 4434.45,-7276.65"/>
<text text-anchor="middle" x="3962.5" y="-7331.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu6 -->
<g id="node487" class="node">
<title>l2_attn_stage9_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2455" cy="-7251.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2455" y="-7262.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="2455" y="-7247.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2455" y="-7232.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu6&#45;&gt;l2_attn_stage9_gpu6 -->
<g id="edge455" class="edge">
<title>l2_attn_stage8_gpu6&#45;&gt;l2_attn_stage9_gpu6</title>
<path fill="none" stroke="black" d="M2455,-7360.74C2455,-7342.02 2455,-7319.03 2455,-7299.05"/>
<polygon fill="black" stroke="black" points="2458.5,-7298.91 2455,-7288.91 2451.5,-7298.91 2458.5,-7298.91"/>
</g>
<!-- l2_attn_stage8_gpu6&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge1623" class="edge">
<title>l2_attn_stage8_gpu6&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2508.28,-7368.28C2522.41,-7361.94 2537.94,-7356.14 2553,-7352.83 2592.2,-7344.21 3960.13,-7356.13 3998,-7342.83 4008.15,-7339.27 4006.89,-7331.5 4017,-7327.83 4047.62,-7316.73 4278.15,-7326.65 4310,-7319.83 4353.66,-7310.48 4400.41,-7289.72 4432.42,-7273.67"/>
<polygon fill="red" stroke="red" points="4434.12,-7276.73 4441.45,-7269.07 4430.95,-7270.49 4434.12,-7276.73"/>
<text text-anchor="middle" x="4048.5" y="-7331.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu7 -->
<g id="node488" class="node">
<title>l2_attn_stage9_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2650" cy="-7251.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2650" y="-7262.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="2650" y="-7247.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2650" y="-7232.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu7&#45;&gt;l2_attn_stage9_gpu7 -->
<g id="edge456" class="edge">
<title>l2_attn_stage8_gpu7&#45;&gt;l2_attn_stage9_gpu7</title>
<path fill="none" stroke="black" d="M2650,-7360.74C2650,-7342.02 2650,-7319.03 2650,-7299.05"/>
<polygon fill="black" stroke="black" points="2653.5,-7298.91 2650,-7288.91 2646.5,-7298.91 2653.5,-7298.91"/>
</g>
<!-- l2_attn_stage8_gpu7&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge1624" class="edge">
<title>l2_attn_stage8_gpu7&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2703.28,-7368.29C2717.42,-7361.95 2732.95,-7356.15 2748,-7352.83 2784.24,-7344.85 4048.99,-7355.13 4084,-7342.83 4094.15,-7339.27 4092.91,-7331.56 4103,-7327.83 4146.19,-7311.9 4265.04,-7329.73 4310,-7319.83 4353.6,-7310.23 4400.37,-7289.51 4432.39,-7273.54"/>
<polygon fill="red" stroke="red" points="4434.08,-7276.6 4441.42,-7268.96 4430.92,-7270.36 4434.08,-7276.6"/>
<text text-anchor="middle" x="4134.5" y="-7331.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu8 -->
<g id="node489" class="node">
<title>l2_attn_stage9_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2845" cy="-7251.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2845" y="-7262.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="2845" y="-7247.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2845" y="-7232.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu8&#45;&gt;l2_attn_stage9_gpu8 -->
<g id="edge457" class="edge">
<title>l2_attn_stage8_gpu8&#45;&gt;l2_attn_stage9_gpu8</title>
<path fill="none" stroke="black" d="M2845,-7360.74C2845,-7342.02 2845,-7319.03 2845,-7299.05"/>
<polygon fill="black" stroke="black" points="2848.5,-7298.91 2845,-7288.91 2841.5,-7298.91 2848.5,-7298.91"/>
</g>
<!-- l2_attn_stage8_gpu8&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge1625" class="edge">
<title>l2_attn_stage8_gpu8&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2898.28,-7368.3C2912.42,-7361.96 2927.95,-7356.15 2943,-7352.83 3009.57,-7338.14 4105.69,-7365.45 4170,-7342.83 4180.15,-7339.26 4178.96,-7331.69 4189,-7327.83 4239.3,-7308.49 4257.53,-7332.14 4310,-7319.83 4353.2,-7309.7 4399.67,-7289.25 4431.71,-7273.5"/>
<polygon fill="red" stroke="red" points="4433.38,-7276.59 4440.77,-7268.99 4430.25,-7270.32 4433.38,-7276.59"/>
<text text-anchor="middle" x="4220.5" y="-7331.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu9 -->
<g id="node490" class="node">
<title>l2_attn_stage9_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="3040" cy="-7251.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3040" y="-7262.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="3040" y="-7247.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="3040" y="-7232.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu9&#45;&gt;l2_attn_stage9_gpu9 -->
<g id="edge458" class="edge">
<title>l2_attn_stage8_gpu9&#45;&gt;l2_attn_stage9_gpu9</title>
<path fill="none" stroke="black" d="M3040,-7360.74C3040,-7342.02 3040,-7319.03 3040,-7299.05"/>
<polygon fill="black" stroke="black" points="3043.5,-7298.91 3040,-7288.91 3036.5,-7298.91 3043.5,-7298.91"/>
</g>
<!-- l2_attn_stage8_gpu9&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge1626" class="edge">
<title>l2_attn_stage8_gpu9&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3093.28,-7368.3C3107.42,-7361.96 3122.95,-7356.16 3138,-7352.83 3198.65,-7339.42 4197.41,-7363.46 4256,-7342.83 4266.15,-7339.26 4265.3,-7332.48 4275,-7327.83 4289.39,-7320.94 4294.8,-7324.7 4310,-7319.83 4350.94,-7306.73 4395.95,-7287.57 4428.12,-7273.01"/>
<polygon fill="red" stroke="red" points="4429.61,-7276.17 4437.25,-7268.84 4426.7,-7269.81 4429.61,-7276.17"/>
<text text-anchor="middle" x="4306.5" y="-7331.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu10 -->
<g id="node491" class="node">
<title>l2_attn_stage9_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3235" cy="-7251.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3235" y="-7262.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="3235" y="-7247.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3235" y="-7232.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu10&#45;&gt;l2_attn_stage9_gpu10 -->
<g id="edge459" class="edge">
<title>l2_attn_stage8_gpu10&#45;&gt;l2_attn_stage9_gpu10</title>
<path fill="none" stroke="black" d="M3235,-7360.74C3235,-7342.02 3235,-7319.03 3235,-7299.05"/>
<polygon fill="black" stroke="black" points="3238.5,-7298.91 3235,-7288.91 3231.5,-7298.91 3238.5,-7298.91"/>
</g>
<!-- l2_attn_stage8_gpu10&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge1627" class="edge">
<title>l2_attn_stage8_gpu10&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3288.29,-7368.31C3302.42,-7361.97 3317.95,-7356.17 3333,-7352.83 3387.73,-7340.7 4289.13,-7361.48 4342,-7342.83 4352.15,-7339.25 4352.32,-7334.19 4361,-7327.83 4386.22,-7309.34 4415.5,-7289.49 4437.65,-7274.78"/>
<polygon fill="red" stroke="red" points="4439.66,-7277.65 4446.07,-7269.22 4435.8,-7271.81 4439.66,-7277.65"/>
<text text-anchor="middle" x="4392.5" y="-7331.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu11 -->
<g id="node492" class="node">
<title>l2_attn_stage9_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3430" cy="-7251.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3430" y="-7262.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="3430" y="-7247.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3430" y="-7232.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu11&#45;&gt;l2_attn_stage9_gpu11 -->
<g id="edge460" class="edge">
<title>l2_attn_stage8_gpu11&#45;&gt;l2_attn_stage9_gpu11</title>
<path fill="none" stroke="black" d="M3430,-7360.74C3430,-7342.02 3430,-7319.03 3430,-7299.05"/>
<polygon fill="black" stroke="black" points="3433.5,-7298.91 3430,-7288.91 3426.5,-7298.91 3433.5,-7298.91"/>
</g>
<!-- l2_attn_stage8_gpu11&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge1628" class="edge">
<title>l2_attn_stage8_gpu11&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3483.29,-7368.33C3497.42,-7361.99 3512.95,-7356.18 3528,-7352.83 3552.41,-7347.41 4406.88,-7356.21 4428,-7342.83 4449.94,-7328.93 4461.24,-7300.65 4466.85,-7279.39"/>
<polygon fill="red" stroke="red" points="4470.27,-7280.14 4469.18,-7269.6 4463.46,-7278.52 4470.27,-7280.14"/>
<text text-anchor="middle" x="4474.5" y="-7331.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu12 -->
<g id="node493" class="node">
<title>l2_attn_stage9_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3625" cy="-7251.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3625" y="-7262.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="3625" y="-7247.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3625" y="-7232.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu12&#45;&gt;l2_attn_stage9_gpu12 -->
<g id="edge461" class="edge">
<title>l2_attn_stage8_gpu12&#45;&gt;l2_attn_stage9_gpu12</title>
<path fill="none" stroke="black" d="M3569.85,-7368.87C3556.43,-7362.83 3541.93,-7357.03 3528,-7352.83 3514.22,-7348.68 3473.36,-7353.77 3464,-7342.83 3429.08,-7302.03 3469.79,-7342.15 3528,-7319.83 3545.78,-7313.01 3563.42,-7302.27 3578.68,-7291.34"/>
<polygon fill="black" stroke="black" points="3580.93,-7294.02 3586.9,-7285.27 3576.77,-7288.39 3580.93,-7294.02"/>
</g>
<!-- l2_attn_stage8_gpu12&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge1629" class="edge">
<title>l2_attn_stage8_gpu12&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3678.29,-7368.34C3692.43,-7362 3707.95,-7356.19 3723,-7352.83 3744.45,-7348.05 4498.56,-7358.47 4514,-7342.83 4532.16,-7324.44 4514.89,-7296.75 4497.31,-7276.84"/>
<polygon fill="red" stroke="red" points="4499.75,-7274.32 4490.38,-7269.37 4494.61,-7279.08 4499.75,-7274.32"/>
<text text-anchor="middle" x="4552.5" y="-7331.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu13 -->
<g id="node494" class="node">
<title>l2_attn_stage9_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3820" cy="-7251.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3820" y="-7262.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="3820" y="-7247.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3820" y="-7232.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu13&#45;&gt;l2_attn_stage9_gpu13 -->
<g id="edge462" class="edge">
<title>l2_attn_stage8_gpu13&#45;&gt;l2_attn_stage9_gpu13</title>
<path fill="none" stroke="black" d="M3766.7,-7368.39C3752.85,-7362.13 3737.69,-7356.35 3723,-7352.83 3709.37,-7349.57 3480.71,-7352.93 3471,-7342.83 3466.38,-7338.03 3466.36,-7332.62 3471,-7327.83 3480.75,-7317.77 3709.7,-7324.24 3723,-7319.83 3741.4,-7313.74 3759.44,-7302.94 3774.87,-7291.75"/>
<polygon fill="black" stroke="black" points="3777.27,-7294.33 3783.16,-7285.52 3773.06,-7288.73 3777.27,-7294.33"/>
</g>
<!-- l2_attn_stage8_gpu13&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge1630" class="edge">
<title>l2_attn_stage8_gpu13&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3873.3,-7368.36C3887.43,-7362.02 3902.96,-7356.2 3918,-7352.83 3936.49,-7348.69 4586.7,-7356.33 4600,-7342.83 4628.36,-7314.06 4580.79,-7288.22 4535.82,-7271.6"/>
<polygon fill="red" stroke="red" points="4536.88,-7268.26 4526.29,-7268.19 4534.53,-7274.85 4536.88,-7268.26"/>
<text text-anchor="middle" x="4639.5" y="-7331.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu14 -->
<g id="node495" class="node">
<title>l2_attn_stage9_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="4015" cy="-7251.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4015" y="-7262.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="4015" y="-7247.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4015" y="-7232.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu14&#45;&gt;l2_attn_stage9_gpu14 -->
<g id="edge463" class="edge">
<title>l2_attn_stage8_gpu14&#45;&gt;l2_attn_stage9_gpu14</title>
<path fill="none" stroke="black" d="M3961.74,-7368.22C3947.89,-7361.96 3932.71,-7356.22 3918,-7352.83 3894.17,-7347.34 3495.09,-7360.32 3478,-7342.83 3473.34,-7338.06 3473.33,-7332.59 3478,-7327.83 3486.56,-7319.11 3906.37,-7323.6 3918,-7319.83 3936.45,-7313.86 3954.49,-7303.1 3969.92,-7291.9"/>
<polygon fill="black" stroke="black" points="3972.32,-7294.47 3978.2,-7285.66 3968.11,-7288.88 3972.32,-7294.47"/>
</g>
<!-- l2_attn_stage8_gpu14&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge1631" class="edge">
<title>l2_attn_stage8_gpu14&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4068.3,-7368.39C4082.44,-7362.05 4097.96,-7356.22 4113,-7352.83 4128.53,-7349.33 4674.84,-7354.19 4686,-7342.83 4726.03,-7302.09 4656.32,-7278.74 4586.01,-7265.99"/>
<polygon fill="red" stroke="red" points="4586.55,-7262.53 4576.1,-7264.26 4585.35,-7269.43 4586.55,-7262.53"/>
<text text-anchor="middle" x="4726.5" y="-7331.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage9_gpu15 -->
<g id="node496" class="node">
<title>l2_attn_stage9_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4210" cy="-7251.33" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4210" y="-7262.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage9</text>
<text text-anchor="middle" x="4210" y="-7247.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4210" y="-7232.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage8_gpu15&#45;&gt;l2_attn_stage9_gpu15 -->
<g id="edge464" class="edge">
<title>l2_attn_stage8_gpu15&#45;&gt;l2_attn_stage9_gpu15</title>
<path fill="none" stroke="black" d="M4157.02,-7368.26C4143.09,-7361.97 4127.82,-7356.19 4113,-7352.83 4095.99,-7348.97 3497.24,-7355.27 3485,-7342.83 3480.32,-7338.08 3480.32,-7332.58 3485,-7327.83 3497.26,-7315.42 4096.39,-7325.16 4113,-7319.83 4131.46,-7313.91 4149.51,-7303.16 4164.94,-7291.96"/>
<polygon fill="black" stroke="black" points="4167.34,-7294.53 4173.22,-7285.72 4163.13,-7288.94 4167.34,-7294.53"/>
</g>
<!-- l2_attn_stage8_gpu15&#45;&gt;l2_attn_stage9_gpu[next_gpu] -->
<g id="edge1632" class="edge">
<title>l2_attn_stage8_gpu15&#45;&gt;l2_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4265.38,-7369.02C4280.74,-7362.45 4297.68,-7356.36 4314,-7352.83 4338.87,-7347.45 4754.2,-7361.02 4772,-7342.83 4826.67,-7286.96 4725.45,-7265.29 4626.12,-7257.04"/>
<polygon fill="red" stroke="red" points="4626.15,-7253.53 4615.9,-7256.24 4625.6,-7260.51 4626.15,-7253.53"/>
<text text-anchor="middle" x="4812.5" y="-7331.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu0 -->
<g id="node497" class="node">
<title>l2_attn_stage10_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1083" cy="-7104.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1083" y="-7115.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="1083" y="-7100.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1083" y="-7085.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu0&#45;&gt;l2_attn_stage10_gpu0 -->
<g id="edge465" class="edge">
<title>l2_attn_stage9_gpu0&#45;&gt;l2_attn_stage10_gpu0</title>
<path fill="none" stroke="black" d="M1240.67,-7218.51C1209.97,-7196.47 1168.93,-7167.02 1136.42,-7143.68"/>
<polygon fill="black" stroke="black" points="1138.09,-7140.57 1127.92,-7137.58 1134.01,-7146.25 1138.09,-7140.57"/>
</g>
<!-- l2_attn_stage10_gpu[next_gpu] -->
<g id="node1337" class="node">
<title>l2_attn_stage10_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4478" cy="-7104.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4478" y="-7100.63" font-family="Times,serif" font-size="14.00">l2_attn_stage10_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage9_gpu0&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge1633" class="edge">
<title>l2_attn_stage9_gpu0&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1338.29,-7221.33C1352.43,-7214.99 1367.95,-7209.18 1383,-7205.83 1611.1,-7155.05 3252.33,-7183.35 3486,-7180.83 3531.78,-7180.34 4265.1,-7181.74 4310,-7172.83 4355.32,-7163.84 4403.98,-7142.92 4437.21,-7126.73"/>
<polygon fill="red" stroke="red" points="4439.17,-7129.67 4446.58,-7122.1 4436.06,-7123.4 4439.17,-7129.67"/>
<text text-anchor="middle" x="3517.5" y="-7184.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu1 -->
<g id="node498" class="node">
<title>l2_attn_stage10_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1291" cy="-7104.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1291" y="-7115.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="1291" y="-7100.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1291" y="-7085.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu1&#45;&gt;l2_attn_stage10_gpu1 -->
<g id="edge466" class="edge">
<title>l2_attn_stage9_gpu1&#45;&gt;l2_attn_stage10_gpu1</title>
<path fill="none" stroke="black" d="M1438.05,-7218.15C1409.62,-7196.34 1371.89,-7167.39 1341.76,-7144.28"/>
<polygon fill="black" stroke="black" points="1343.55,-7141.23 1333.48,-7137.92 1339.29,-7146.79 1343.55,-7141.23"/>
</g>
<!-- l2_attn_stage9_gpu1&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge1634" class="edge">
<title>l2_attn_stage9_gpu1&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1533.28,-7221.26C1547.41,-7214.92 1562.94,-7209.13 1578,-7205.83 1631.59,-7194.09 3501.22,-7213.96 3553,-7195.83 3563.15,-7192.28 3561.86,-7184.42 3572,-7180.83 3610.66,-7167.17 4269.79,-7180.83 4310,-7172.83 4355.31,-7163.81 4403.98,-7142.9 4437.21,-7126.72"/>
<polygon fill="red" stroke="red" points="4439.17,-7129.66 4446.58,-7122.08 4436.06,-7123.38 4439.17,-7129.66"/>
<text text-anchor="middle" x="3603.5" y="-7184.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu2 -->
<g id="node499" class="node">
<title>l2_attn_stage10_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1499" cy="-7104.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1499" y="-7115.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="1499" y="-7100.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1499" y="-7085.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu2&#45;&gt;l2_attn_stage10_gpu2 -->
<g id="edge467" class="edge">
<title>l2_attn_stage9_gpu2&#45;&gt;l2_attn_stage10_gpu2</title>
<path fill="none" stroke="black" d="M1635.06,-7217.43C1608.94,-7195.91 1574.66,-7167.67 1547.05,-7144.92"/>
<polygon fill="black" stroke="black" points="1549.03,-7142.01 1539.08,-7138.35 1544.58,-7147.41 1549.03,-7142.01"/>
</g>
<!-- l2_attn_stage9_gpu2&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge1635" class="edge">
<title>l2_attn_stage9_gpu2&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1728.28,-7221.27C1742.41,-7214.93 1757.94,-7209.13 1773,-7205.83 1823.63,-7194.73 3590.08,-7212.96 3639,-7195.83 3649.15,-7192.28 3647.86,-7184.42 3658,-7180.83 3692.15,-7168.74 4274.48,-7179.93 4310,-7172.83 4355.31,-7163.78 4403.97,-7142.87 4437.2,-7126.7"/>
<polygon fill="red" stroke="red" points="4439.16,-7129.64 4446.57,-7122.07 4436.06,-7123.36 4439.16,-7129.64"/>
<text text-anchor="middle" x="3689.5" y="-7184.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu3 -->
<g id="node500" class="node">
<title>l2_attn_stage10_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1707" cy="-7104.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1707" y="-7115.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="1707" y="-7100.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1707" y="-7085.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu3&#45;&gt;l2_attn_stage10_gpu3 -->
<g id="edge468" class="edge">
<title>l2_attn_stage9_gpu3&#45;&gt;l2_attn_stage10_gpu3</title>
<path fill="none" stroke="black" d="M1832.6,-7217.07C1808.75,-7195.85 1777.69,-7168.22 1752.43,-7145.74"/>
<polygon fill="black" stroke="black" points="1754.58,-7142.98 1744.79,-7138.95 1749.93,-7148.21 1754.58,-7142.98"/>
</g>
<!-- l2_attn_stage9_gpu3&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge1636" class="edge">
<title>l2_attn_stage9_gpu3&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1923.28,-7221.27C1937.41,-7214.93 1952.94,-7209.14 1968,-7205.83 2015.67,-7195.37 3678.94,-7211.97 3725,-7195.83 3735.15,-7192.27 3733.86,-7184.43 3744,-7180.83 3773.63,-7170.31 4279.17,-7179.02 4310,-7172.83 4355.3,-7163.74 4403.97,-7142.83 4437.2,-7126.68"/>
<polygon fill="red" stroke="red" points="4439.15,-7129.62 4446.57,-7122.05 4436.05,-7123.34 4439.15,-7129.62"/>
<text text-anchor="middle" x="3775.5" y="-7184.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu4 -->
<g id="node501" class="node">
<title>l2_attn_stage10_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1915" cy="-7104.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1915" y="-7115.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="1915" y="-7100.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1915" y="-7085.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu4&#45;&gt;l2_attn_stage10_gpu4 -->
<g id="edge469" class="edge">
<title>l2_attn_stage9_gpu4&#45;&gt;l2_attn_stage10_gpu4</title>
<path fill="none" stroke="black" d="M2030.21,-7216.7C2008.5,-7195.71 1980.41,-7168.56 1957.4,-7146.32"/>
<polygon fill="black" stroke="black" points="1959.74,-7143.72 1950.12,-7139.28 1954.88,-7148.75 1959.74,-7143.72"/>
</g>
<!-- l2_attn_stage9_gpu4&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge1637" class="edge">
<title>l2_attn_stage9_gpu4&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2118.28,-7221.27C2132.41,-7214.93 2147.94,-7209.14 2163,-7205.83 2207.71,-7196.01 3767.8,-7210.98 3811,-7195.83 3821.15,-7192.27 3819.87,-7184.44 3830,-7180.83 3880.24,-7162.92 4257.72,-7183.4 4310,-7172.83 4355.29,-7163.68 4403.96,-7142.79 4437.19,-7126.65"/>
<polygon fill="red" stroke="red" points="4439.14,-7129.59 4446.56,-7122.03 4436.05,-7123.31 4439.14,-7129.59"/>
<text text-anchor="middle" x="3861.5" y="-7184.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu5 -->
<g id="node502" class="node">
<title>l2_attn_stage10_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2123" cy="-7104.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2123" y="-7115.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="2123" y="-7100.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2123" y="-7085.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu5&#45;&gt;l2_attn_stage10_gpu5 -->
<g id="edge470" class="edge">
<title>l2_attn_stage9_gpu5&#45;&gt;l2_attn_stage10_gpu5</title>
<path fill="none" stroke="black" d="M2227.88,-7216.34C2208.35,-7195.67 2183.27,-7169.12 2162.53,-7147.17"/>
<polygon fill="black" stroke="black" points="2164.81,-7144.48 2155.39,-7139.62 2159.72,-7149.29 2164.81,-7144.48"/>
</g>
<!-- l2_attn_stage9_gpu5&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge1638" class="edge">
<title>l2_attn_stage9_gpu5&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2313.28,-7221.28C2327.41,-7214.94 2342.94,-7209.14 2358,-7205.83 2399.75,-7196.65 3856.66,-7209.98 3897,-7195.83 3907.15,-7192.27 3905.87,-7184.46 3916,-7180.83 3957.22,-7166.05 4267.1,-7181.58 4310,-7172.83 4355.27,-7163.6 4403.94,-7142.72 4437.18,-7126.6"/>
<polygon fill="red" stroke="red" points="4439.13,-7129.55 4446.56,-7121.99 4436.04,-7123.27 4439.13,-7129.55"/>
<text text-anchor="middle" x="3947.5" y="-7184.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu6 -->
<g id="node503" class="node">
<title>l2_attn_stage10_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2331" cy="-7104.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2331" y="-7115.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="2331" y="-7100.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2331" y="-7085.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu6&#45;&gt;l2_attn_stage10_gpu6 -->
<g id="edge471" class="edge">
<title>l2_attn_stage9_gpu6&#45;&gt;l2_attn_stage10_gpu6</title>
<path fill="none" stroke="black" d="M2425.3,-7215.6C2407.88,-7195.23 2385.74,-7169.34 2367.29,-7147.77"/>
<polygon fill="black" stroke="black" points="2369.83,-7145.36 2360.67,-7140.03 2364.51,-7149.91 2369.83,-7145.36"/>
</g>
<!-- l2_attn_stage9_gpu6&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge1639" class="edge">
<title>l2_attn_stage9_gpu6&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2508.28,-7221.28C2522.41,-7214.94 2537.94,-7209.15 2553,-7205.83 2591.79,-7197.29 3945.52,-7208.99 3983,-7195.83 3993.15,-7192.27 3991.88,-7184.49 4002,-7180.83 4034.19,-7169.19 4276.48,-7179.77 4310,-7172.83 4355.11,-7163.5 4403.62,-7142.74 4436.86,-7126.68"/>
<polygon fill="red" stroke="red" points="4438.8,-7129.63 4446.24,-7122.08 4435.72,-7123.34 4438.8,-7129.63"/>
<text text-anchor="middle" x="4033.5" y="-7184.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu7 -->
<g id="node504" class="node">
<title>l2_attn_stage10_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2539" cy="-7104.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2539" y="-7115.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="2539" y="-7100.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2539" y="-7085.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu7&#45;&gt;l2_attn_stage10_gpu7 -->
<g id="edge472" class="edge">
<title>l2_attn_stage9_gpu7&#45;&gt;l2_attn_stage10_gpu7</title>
<path fill="none" stroke="black" d="M2623.13,-7215.23C2607.71,-7195.09 2588.23,-7169.65 2571.9,-7148.31"/>
<polygon fill="black" stroke="black" points="2574.67,-7146.17 2565.81,-7140.36 2569.11,-7150.43 2574.67,-7146.17"/>
</g>
<!-- l2_attn_stage9_gpu7&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge1640" class="edge">
<title>l2_attn_stage9_gpu7&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2703.28,-7221.29C2717.42,-7214.95 2732.95,-7209.15 2748,-7205.83 2819.67,-7190.04 3999.76,-7220.16 4069,-7195.83 4079.15,-7192.26 4077.9,-7184.54 4088,-7180.83 4134.34,-7163.8 4261.71,-7183.08 4310,-7172.83 4355.06,-7163.27 4403.58,-7142.54 4436.83,-7126.56"/>
<polygon fill="red" stroke="red" points="4438.76,-7129.51 4446.22,-7121.98 4435.69,-7123.22 4438.76,-7129.51"/>
<text text-anchor="middle" x="4119.5" y="-7184.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu8 -->
<g id="node505" class="node">
<title>l2_attn_stage10_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2747" cy="-7104.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2747" y="-7115.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="2747" y="-7100.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2747" y="-7085.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu8&#45;&gt;l2_attn_stage10_gpu8 -->
<g id="edge473" class="edge">
<title>l2_attn_stage9_gpu8&#45;&gt;l2_attn_stage10_gpu8</title>
<path fill="none" stroke="black" d="M2821.03,-7214.86C2807.63,-7195.04 2790.82,-7170.17 2776.61,-7149.14"/>
<polygon fill="black" stroke="black" points="2779.4,-7147.01 2770.9,-7140.69 2773.6,-7150.93 2779.4,-7147.01"/>
</g>
<!-- l2_attn_stage9_gpu8&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge1641" class="edge">
<title>l2_attn_stage9_gpu8&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2898.28,-7221.3C2912.42,-7214.96 2927.95,-7209.15 2943,-7205.83 3008.75,-7191.32 4091.48,-7218.18 4155,-7195.83 4165.15,-7192.26 4163.94,-7184.66 4174,-7180.83 4202.3,-7170.07 4280.46,-7179.45 4310,-7172.83 4354.67,-7162.82 4402.88,-7142.36 4436.15,-7126.57"/>
<polygon fill="red" stroke="red" points="4438.06,-7129.54 4445.55,-7122.05 4435.02,-7123.23 4438.06,-7129.54"/>
<text text-anchor="middle" x="4205.5" y="-7184.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu9 -->
<g id="node506" class="node">
<title>l2_attn_stage10_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2955" cy="-7104.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2955" y="-7115.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="2955" y="-7100.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2955" y="-7085.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu9&#45;&gt;l2_attn_stage10_gpu9 -->
<g id="edge474" class="edge">
<title>l2_attn_stage9_gpu9&#45;&gt;l2_attn_stage10_gpu9</title>
<path fill="none" stroke="black" d="M3019.21,-7214.86C3007.68,-7195.2 2993.24,-7170.57 2980.98,-7149.65"/>
<polygon fill="black" stroke="black" points="2983.95,-7147.8 2975.87,-7140.94 2977.91,-7151.34 2983.95,-7147.8"/>
</g>
<!-- l2_attn_stage9_gpu9&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge1642" class="edge">
<title>l2_attn_stage9_gpu9&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3093.29,-7221.3C3107.42,-7214.97 3122.95,-7209.16 3138,-7205.83 3197.83,-7192.6 4183.2,-7216.19 4241,-7195.83 4251.15,-7192.26 4250.15,-7185.15 4260,-7180.83 4280.61,-7171.79 4288.31,-7178.84 4310,-7172.83 4353.28,-7160.84 4400.59,-7141.2 4433.94,-7126.19"/>
<polygon fill="red" stroke="red" points="4435.74,-7129.22 4443.4,-7121.9 4432.84,-7122.85 4435.74,-7129.22"/>
<text text-anchor="middle" x="4291.5" y="-7184.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu10 -->
<g id="node507" class="node">
<title>l2_attn_stage10_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3163" cy="-7104.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3163" y="-7115.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="3163" y="-7100.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3163" y="-7085.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu10&#45;&gt;l2_attn_stage10_gpu10 -->
<g id="edge475" class="edge">
<title>l2_attn_stage9_gpu10&#45;&gt;l2_attn_stage10_gpu10</title>
<path fill="none" stroke="black" d="M3217.2,-7214.49C3207.6,-7195.14 3195.64,-7171.07 3185.41,-7150.46"/>
<polygon fill="black" stroke="black" points="3188.42,-7148.66 3180.84,-7141.26 3182.16,-7151.78 3188.42,-7148.66"/>
</g>
<!-- l2_attn_stage9_gpu10&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge1643" class="edge">
<title>l2_attn_stage9_gpu10&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3288.29,-7221.32C3302.42,-7214.98 3317.95,-7209.17 3333,-7205.83 3386.92,-7193.88 4274.92,-7214.21 4327,-7195.83 4337.15,-7192.25 4337.08,-7186.85 4346,-7180.83 4375.36,-7161.01 4410.2,-7141.22 4436.72,-7126.88"/>
<polygon fill="red" stroke="red" points="4438.57,-7129.86 4445.73,-7122.05 4435.26,-7123.69 4438.57,-7129.86"/>
<text text-anchor="middle" x="4377.5" y="-7184.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu11 -->
<g id="node508" class="node">
<title>l2_attn_stage10_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3371" cy="-7104.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3371" y="-7115.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="3371" y="-7100.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3371" y="-7085.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu11&#45;&gt;l2_attn_stage10_gpu11 -->
<g id="edge476" class="edge">
<title>l2_attn_stage9_gpu11&#45;&gt;l2_attn_stage10_gpu11</title>
<path fill="none" stroke="black" d="M3415.26,-7214.12C3407.49,-7195 3397.86,-7171.35 3389.58,-7150.98"/>
<polygon fill="black" stroke="black" points="3392.76,-7149.53 3385.75,-7141.59 3386.28,-7152.17 3392.76,-7149.53"/>
</g>
<!-- l2_attn_stage9_gpu11&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge1644" class="edge">
<title>l2_attn_stage9_gpu11&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3483.29,-7221.33C3497.42,-7214.99 3512.95,-7209.18 3528,-7205.83 3552,-7200.5 4391.19,-7207.18 4413,-7195.83 4426.7,-7188.71 4448.58,-7155.29 4463.12,-7131.13"/>
<polygon fill="red" stroke="red" points="4466.21,-7132.79 4468.3,-7122.4 4460.19,-7129.21 4466.21,-7132.79"/>
<text text-anchor="middle" x="4459.5" y="-7184.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu12 -->
<g id="node509" class="node">
<title>l2_attn_stage10_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3579" cy="-7104.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3579" y="-7115.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="3579" y="-7100.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3579" y="-7085.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu12&#45;&gt;l2_attn_stage10_gpu12 -->
<g id="edge477" class="edge">
<title>l2_attn_stage9_gpu12&#45;&gt;l2_attn_stage10_gpu12</title>
<path fill="none" stroke="black" d="M3570.2,-7221.69C3556.7,-7215.62 3542.07,-7209.85 3528,-7205.83 3510.98,-7200.98 3460.7,-7209.11 3449,-7195.83 3444.59,-7190.83 3445.04,-7186.19 3449,-7180.83 3456.18,-7171.11 3464.05,-7177.95 3475,-7172.83 3492.44,-7164.68 3510.39,-7153.99 3526.36,-7143.52"/>
<polygon fill="black" stroke="black" points="3528.64,-7146.21 3535.02,-7137.75 3524.76,-7140.39 3528.64,-7146.21"/>
</g>
<!-- l2_attn_stage9_gpu12&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge1645" class="edge">
<title>l2_attn_stage9_gpu12&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3678.29,-7221.34C3692.43,-7215 3707.95,-7209.19 3723,-7205.83 3744.04,-7201.14 4483.86,-7211.17 4499,-7195.83 4515.7,-7178.91 4506.21,-7151.47 4495.14,-7131.23"/>
<polygon fill="red" stroke="red" points="4498.11,-7129.37 4490.04,-7122.5 4492.07,-7132.9 4498.11,-7129.37"/>
<text text-anchor="middle" x="4537.5" y="-7184.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu13 -->
<g id="node510" class="node">
<title>l2_attn_stage10_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3787" cy="-7104.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3787" y="-7115.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="3787" y="-7100.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3787" y="-7085.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu13&#45;&gt;l2_attn_stage10_gpu13 -->
<g id="edge478" class="edge">
<title>l2_attn_stage9_gpu13&#45;&gt;l2_attn_stage10_gpu13</title>
<path fill="none" stroke="black" d="M3766.71,-7221.37C3752.86,-7215.11 3737.69,-7209.33 3723,-7205.83 3708.56,-7202.39 3466.3,-7206.52 3456,-7195.83 3451.38,-7191.03 3451.37,-7185.63 3456,-7180.83 3464.76,-7171.75 3670.97,-7176.63 3683,-7172.83 3702.58,-7166.66 3722,-7155.72 3738.67,-7144.41"/>
<polygon fill="black" stroke="black" points="3740.94,-7147.1 3747.13,-7138.49 3736.93,-7141.36 3740.94,-7147.1"/>
</g>
<!-- l2_attn_stage9_gpu13&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge1646" class="edge">
<title>l2_attn_stage9_gpu13&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3873.3,-7221.37C3887.43,-7215.03 3902.96,-7209.21 3918,-7205.83 3936.08,-7201.78 4572,-7209.03 4585,-7195.83 4610.61,-7169.84 4569.49,-7143.24 4531.03,-7125.67"/>
<polygon fill="red" stroke="red" points="4532.43,-7122.46 4521.87,-7121.62 4529.61,-7128.86 4532.43,-7122.46"/>
<text text-anchor="middle" x="4623.5" y="-7184.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu14 -->
<g id="node511" class="node">
<title>l2_attn_stage10_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3995" cy="-7104.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3995" y="-7115.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="3995" y="-7100.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3995" y="-7085.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu14&#45;&gt;l2_attn_stage10_gpu14 -->
<g id="edge479" class="edge">
<title>l2_attn_stage9_gpu14&#45;&gt;l2_attn_stage10_gpu14</title>
<path fill="none" stroke="black" d="M3961.75,-7221.21C3947.89,-7214.96 3932.72,-7209.22 3918,-7205.83 3893.36,-7200.16 3480.68,-7213.91 3463,-7195.83 3458.34,-7191.07 3458.33,-7185.59 3463,-7180.83 3471.33,-7172.35 3879.63,-7176.31 3891,-7172.83 3910.63,-7166.82 3930.07,-7155.92 3946.73,-7144.61"/>
<polygon fill="black" stroke="black" points="3949.01,-7147.29 3955.18,-7138.68 3944.99,-7141.56 3949.01,-7147.29"/>
</g>
<!-- l2_attn_stage9_gpu14&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge1647" class="edge">
<title>l2_attn_stage9_gpu14&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4068.31,-7221.4C4082.44,-7215.06 4097.96,-7209.23 4113,-7205.83 4128.12,-7202.42 4660.14,-7206.89 4671,-7195.83 4707.82,-7158.35 4644.45,-7134.61 4580.69,-7120.89"/>
<polygon fill="red" stroke="red" points="4581.38,-7117.46 4570.88,-7118.86 4579.96,-7124.32 4581.38,-7117.46"/>
<text text-anchor="middle" x="4710.5" y="-7184.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage10_gpu15 -->
<g id="node512" class="node">
<title>l2_attn_stage10_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4203" cy="-7104.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4203" y="-7115.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage10</text>
<text text-anchor="middle" x="4203" y="-7100.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4203" y="-7085.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage9_gpu15&#45;&gt;l2_attn_stage10_gpu15 -->
<g id="edge480" class="edge">
<title>l2_attn_stage9_gpu15&#45;&gt;l2_attn_stage10_gpu15</title>
<path fill="none" stroke="black" d="M4157.02,-7221.26C4143.09,-7214.96 4127.82,-7209.19 4113,-7205.83 4095.58,-7201.88 3482.53,-7208.56 3470,-7195.83 3465.32,-7191.08 3465.32,-7185.58 3470,-7180.83 3482.28,-7168.4 4082.28,-7177.9 4099,-7172.83 4118.65,-7166.88 4138.09,-7155.99 4154.75,-7144.67"/>
<polygon fill="black" stroke="black" points="4157.03,-7147.35 4163.2,-7138.74 4153.01,-7141.63 4157.03,-7147.35"/>
</g>
<!-- l2_attn_stage9_gpu15&#45;&gt;l2_attn_stage10_gpu[next_gpu] -->
<g id="edge1648" class="edge">
<title>l2_attn_stage9_gpu15&#45;&gt;l2_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4265.38,-7222.02C4280.74,-7215.46 4297.69,-7209.37 4314,-7205.83 4338.06,-7200.62 4739.79,-7213.43 4757,-7195.83 4806.67,-7145.03 4719.33,-7122.72 4629.57,-7112.94"/>
<polygon fill="red" stroke="red" points="4629.78,-7109.44 4619.47,-7111.89 4629.05,-7116.4 4629.78,-7109.44"/>
<text text-anchor="middle" x="4796.5" y="-7184.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu0 -->
<g id="node513" class="node">
<title>l2_attn_stage11_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1083" cy="-6957.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1083" y="-6968.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="1083" y="-6953.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1083" y="-6938.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu0&#45;&gt;l2_attn_stage11_gpu0 -->
<g id="edge481" class="edge">
<title>l2_attn_stage10_gpu0&#45;&gt;l2_attn_stage11_gpu0</title>
<path fill="none" stroke="black" d="M1083,-7066.74C1083,-7048.02 1083,-7025.03 1083,-7005.05"/>
<polygon fill="black" stroke="black" points="1086.5,-7004.91 1083,-6994.91 1079.5,-7004.91 1086.5,-7004.91"/>
</g>
<!-- l2_attn_stage11_gpu[next_gpu] -->
<g id="node1338" class="node">
<title>l2_attn_stage11_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4478" cy="-6957.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4478" y="-6953.63" font-family="Times,serif" font-size="14.00">l2_attn_stage11_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage10_gpu0&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge1649" class="edge">
<title>l2_attn_stage10_gpu0&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1139.98,-7074.2C1154.91,-7067.91 1171.24,-7062.15 1187,-7058.83 1436.97,-7006.18 3230.55,-7036.46 3486,-7033.83 3531.78,-7033.36 4265.1,-7034.74 4310,-7025.83 4355.32,-7016.84 4403.98,-6995.92 4437.21,-6979.73"/>
<polygon fill="red" stroke="red" points="4439.17,-6982.67 4446.58,-6975.1 4436.06,-6976.4 4439.17,-6982.67"/>
<text text-anchor="middle" x="3517.5" y="-7037.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu1 -->
<g id="node514" class="node">
<title>l2_attn_stage11_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1291" cy="-6957.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1291" y="-6968.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="1291" y="-6953.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1291" y="-6938.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu1&#45;&gt;l2_attn_stage11_gpu1 -->
<g id="edge482" class="edge">
<title>l2_attn_stage10_gpu1&#45;&gt;l2_attn_stage11_gpu1</title>
<path fill="none" stroke="black" d="M1291,-7066.74C1291,-7048.02 1291,-7025.03 1291,-7005.05"/>
<polygon fill="black" stroke="black" points="1294.5,-7004.91 1291,-6994.91 1287.5,-7004.91 1294.5,-7004.91"/>
</g>
<!-- l2_attn_stage10_gpu1&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge1650" class="edge">
<title>l2_attn_stage10_gpu1&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1347.97,-7074.14C1362.89,-7067.84 1379.23,-7062.1 1395,-7058.83 1453.7,-7046.66 3496.42,-7068.62 3553,-7048.83 3563.16,-7045.28 3561.86,-7037.42 3572,-7033.83 3610.66,-7020.17 4269.79,-7033.83 4310,-7025.83 4355.31,-7016.81 4403.98,-6995.9 4437.21,-6979.72"/>
<polygon fill="red" stroke="red" points="4439.17,-6982.66 4446.58,-6975.08 4436.06,-6976.38 4439.17,-6982.66"/>
<text text-anchor="middle" x="3603.5" y="-7037.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu2 -->
<g id="node515" class="node">
<title>l2_attn_stage11_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1499" cy="-6957.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1499" y="-6968.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="1499" y="-6953.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1499" y="-6938.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu2&#45;&gt;l2_attn_stage11_gpu2 -->
<g id="edge483" class="edge">
<title>l2_attn_stage10_gpu2&#45;&gt;l2_attn_stage11_gpu2</title>
<path fill="none" stroke="black" d="M1499,-7066.74C1499,-7048.02 1499,-7025.03 1499,-7005.05"/>
<polygon fill="black" stroke="black" points="1502.5,-7004.91 1499,-6994.91 1495.5,-7004.91 1502.5,-7004.91"/>
</g>
<!-- l2_attn_stage10_gpu2&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge1651" class="edge">
<title>l2_attn_stage10_gpu2&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1555.97,-7074.14C1570.89,-7067.85 1587.23,-7062.1 1603,-7058.83 1658.38,-7047.34 3585.62,-7067.51 3639,-7048.83 3649.16,-7045.28 3647.86,-7037.42 3658,-7033.83 3692.15,-7021.74 4274.48,-7032.93 4310,-7025.83 4355.31,-7016.78 4403.97,-6995.87 4437.2,-6979.7"/>
<polygon fill="red" stroke="red" points="4439.16,-6982.64 4446.57,-6975.07 4436.06,-6976.36 4439.16,-6982.64"/>
<text text-anchor="middle" x="3689.5" y="-7037.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu3 -->
<g id="node516" class="node">
<title>l2_attn_stage11_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1707" cy="-6957.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1707" y="-6968.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="1707" y="-6953.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1707" y="-6938.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu3&#45;&gt;l2_attn_stage11_gpu3 -->
<g id="edge484" class="edge">
<title>l2_attn_stage10_gpu3&#45;&gt;l2_attn_stage11_gpu3</title>
<path fill="none" stroke="black" d="M1707,-7066.74C1707,-7048.02 1707,-7025.03 1707,-7005.05"/>
<polygon fill="black" stroke="black" points="1710.5,-7004.91 1707,-6994.91 1703.5,-7004.91 1710.5,-7004.91"/>
</g>
<!-- l2_attn_stage10_gpu3&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge1652" class="edge">
<title>l2_attn_stage10_gpu3&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1763.97,-7074.14C1778.9,-7067.85 1795.23,-7062.11 1811,-7058.83 1863.06,-7048.02 3674.82,-7066.4 3725,-7048.83 3735.15,-7045.28 3733.86,-7037.43 3744,-7033.83 3773.63,-7023.31 4279.17,-7032.02 4310,-7025.83 4355.3,-7016.74 4403.97,-6995.83 4437.2,-6979.68"/>
<polygon fill="red" stroke="red" points="4439.15,-6982.62 4446.57,-6975.05 4436.05,-6976.34 4439.15,-6982.62"/>
<text text-anchor="middle" x="3775.5" y="-7037.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu4 -->
<g id="node517" class="node">
<title>l2_attn_stage11_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1915" cy="-6957.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1915" y="-6968.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="1915" y="-6953.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1915" y="-6938.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu4&#45;&gt;l2_attn_stage11_gpu4 -->
<g id="edge485" class="edge">
<title>l2_attn_stage10_gpu4&#45;&gt;l2_attn_stage11_gpu4</title>
<path fill="none" stroke="black" d="M1915,-7066.74C1915,-7048.02 1915,-7025.03 1915,-7005.05"/>
<polygon fill="black" stroke="black" points="1918.5,-7004.91 1915,-6994.91 1911.5,-7004.91 1918.5,-7004.91"/>
</g>
<!-- l2_attn_stage10_gpu4&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge1653" class="edge">
<title>l2_attn_stage10_gpu4&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1971.97,-7074.15C1986.9,-7067.85 2003.23,-7062.11 2019,-7058.83 2067.74,-7048.7 3764.02,-7065.29 3811,-7048.83 3821.15,-7045.27 3819.87,-7037.44 3830,-7033.83 3880.24,-7015.92 4257.72,-7036.4 4310,-7025.83 4355.29,-7016.68 4403.96,-6995.79 4437.19,-6979.65"/>
<polygon fill="red" stroke="red" points="4439.14,-6982.59 4446.56,-6975.03 4436.05,-6976.31 4439.14,-6982.59"/>
<text text-anchor="middle" x="3861.5" y="-7037.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu5 -->
<g id="node518" class="node">
<title>l2_attn_stage11_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2123" cy="-6957.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2123" y="-6968.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="2123" y="-6953.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2123" y="-6938.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu5&#45;&gt;l2_attn_stage11_gpu5 -->
<g id="edge486" class="edge">
<title>l2_attn_stage10_gpu5&#45;&gt;l2_attn_stage11_gpu5</title>
<path fill="none" stroke="black" d="M2123,-7066.74C2123,-7048.02 2123,-7025.03 2123,-7005.05"/>
<polygon fill="black" stroke="black" points="2126.5,-7004.91 2123,-6994.91 2119.5,-7004.91 2126.5,-7004.91"/>
</g>
<!-- l2_attn_stage10_gpu5&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge1654" class="edge">
<title>l2_attn_stage10_gpu5&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2179.97,-7074.15C2194.9,-7067.86 2211.23,-7062.11 2227,-7058.83 2272.42,-7049.38 3853.22,-7064.18 3897,-7048.83 3907.15,-7045.27 3905.87,-7037.46 3916,-7033.83 3957.22,-7019.05 4267.1,-7034.58 4310,-7025.83 4355.27,-7016.6 4403.94,-6995.72 4437.18,-6979.6"/>
<polygon fill="red" stroke="red" points="4439.13,-6982.55 4446.56,-6974.99 4436.04,-6976.27 4439.13,-6982.55"/>
<text text-anchor="middle" x="3947.5" y="-7037.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu6 -->
<g id="node519" class="node">
<title>l2_attn_stage11_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2331" cy="-6957.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2331" y="-6968.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="2331" y="-6953.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2331" y="-6938.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu6&#45;&gt;l2_attn_stage11_gpu6 -->
<g id="edge487" class="edge">
<title>l2_attn_stage10_gpu6&#45;&gt;l2_attn_stage11_gpu6</title>
<path fill="none" stroke="black" d="M2331,-7066.74C2331,-7048.02 2331,-7025.03 2331,-7005.05"/>
<polygon fill="black" stroke="black" points="2334.5,-7004.91 2331,-6994.91 2327.5,-7004.91 2334.5,-7004.91"/>
</g>
<!-- l2_attn_stage10_gpu6&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge1655" class="edge">
<title>l2_attn_stage10_gpu6&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2387.97,-7074.16C2402.9,-7067.86 2419.23,-7062.12 2435,-7058.83 2477.1,-7050.06 3942.42,-7063.07 3983,-7048.83 3993.15,-7045.27 3991.88,-7037.49 4002,-7033.83 4034.19,-7022.19 4276.48,-7032.77 4310,-7025.83 4355.11,-7016.5 4403.62,-6995.74 4436.86,-6979.68"/>
<polygon fill="red" stroke="red" points="4438.8,-6982.63 4446.24,-6975.08 4435.72,-6976.34 4438.8,-6982.63"/>
<text text-anchor="middle" x="4033.5" y="-7037.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu7 -->
<g id="node520" class="node">
<title>l2_attn_stage11_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2539" cy="-6957.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2539" y="-6968.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="2539" y="-6953.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2539" y="-6938.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu7&#45;&gt;l2_attn_stage11_gpu7 -->
<g id="edge488" class="edge">
<title>l2_attn_stage10_gpu7&#45;&gt;l2_attn_stage11_gpu7</title>
<path fill="none" stroke="black" d="M2539,-7066.74C2539,-7048.02 2539,-7025.03 2539,-7005.05"/>
<polygon fill="black" stroke="black" points="2542.5,-7004.91 2539,-6994.91 2535.5,-7004.91 2542.5,-7004.91"/>
</g>
<!-- l2_attn_stage10_gpu7&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge1656" class="edge">
<title>l2_attn_stage10_gpu7&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2595.98,-7074.16C2610.9,-7067.87 2627.24,-7062.12 2643,-7058.83 2681.78,-7050.74 4031.62,-7061.95 4069,-7048.83 4079.15,-7045.27 4077.9,-7037.54 4088,-7033.83 4134.34,-7016.8 4261.71,-7036.08 4310,-7025.83 4355.06,-7016.27 4403.58,-6995.54 4436.83,-6979.56"/>
<polygon fill="red" stroke="red" points="4438.76,-6982.51 4446.22,-6974.98 4435.69,-6976.22 4438.76,-6982.51"/>
<text text-anchor="middle" x="4119.5" y="-7037.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu8 -->
<g id="node521" class="node">
<title>l2_attn_stage11_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2747" cy="-6957.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2747" y="-6968.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="2747" y="-6953.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2747" y="-6938.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu8&#45;&gt;l2_attn_stage11_gpu8 -->
<g id="edge489" class="edge">
<title>l2_attn_stage10_gpu8&#45;&gt;l2_attn_stage11_gpu8</title>
<path fill="none" stroke="black" d="M2747,-7066.74C2747,-7048.02 2747,-7025.03 2747,-7005.05"/>
<polygon fill="black" stroke="black" points="2750.5,-7004.91 2747,-6994.91 2743.5,-7004.91 2750.5,-7004.91"/>
</g>
<!-- l2_attn_stage10_gpu8&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge1657" class="edge">
<title>l2_attn_stage10_gpu8&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2803.98,-7074.17C2818.9,-7067.88 2835.24,-7062.13 2851,-7058.83 2921.91,-7044.01 4086.65,-7072.85 4155,-7048.83 4165.15,-7045.26 4163.94,-7037.66 4174,-7033.83 4202.3,-7023.07 4280.46,-7032.45 4310,-7025.83 4354.67,-7015.82 4402.88,-6995.36 4436.15,-6979.57"/>
<polygon fill="red" stroke="red" points="4438.06,-6982.54 4445.55,-6975.05 4435.02,-6976.23 4438.06,-6982.54"/>
<text text-anchor="middle" x="4205.5" y="-7037.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu9 -->
<g id="node522" class="node">
<title>l2_attn_stage11_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2955" cy="-6957.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2955" y="-6968.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="2955" y="-6953.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2955" y="-6938.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu9&#45;&gt;l2_attn_stage11_gpu9 -->
<g id="edge490" class="edge">
<title>l2_attn_stage10_gpu9&#45;&gt;l2_attn_stage11_gpu9</title>
<path fill="none" stroke="black" d="M2955,-7066.74C2955,-7048.02 2955,-7025.03 2955,-7005.05"/>
<polygon fill="black" stroke="black" points="2958.5,-7004.91 2955,-6994.91 2951.5,-7004.91 2958.5,-7004.91"/>
</g>
<!-- l2_attn_stage10_gpu9&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge1658" class="edge">
<title>l2_attn_stage10_gpu9&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3011.98,-7074.18C3026.9,-7067.88 3043.24,-7062.13 3059,-7058.83 3123.28,-7045.37 4179.05,-7070.63 4241,-7048.83 4251.15,-7045.26 4250.15,-7038.15 4260,-7033.83 4280.61,-7024.79 4288.31,-7031.84 4310,-7025.83 4353.28,-7013.84 4400.59,-6994.2 4433.94,-6979.19"/>
<polygon fill="red" stroke="red" points="4435.74,-6982.22 4443.4,-6974.9 4432.84,-6975.85 4435.74,-6982.22"/>
<text text-anchor="middle" x="4291.5" y="-7037.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu10 -->
<g id="node523" class="node">
<title>l2_attn_stage11_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3163" cy="-6957.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3163" y="-6968.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="3163" y="-6953.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3163" y="-6938.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu10&#45;&gt;l2_attn_stage11_gpu10 -->
<g id="edge491" class="edge">
<title>l2_attn_stage10_gpu10&#45;&gt;l2_attn_stage11_gpu10</title>
<path fill="none" stroke="black" d="M3163,-7066.74C3163,-7048.02 3163,-7025.03 3163,-7005.05"/>
<polygon fill="black" stroke="black" points="3166.5,-7004.91 3163,-6994.91 3159.5,-7004.91 3166.5,-7004.91"/>
</g>
<!-- l2_attn_stage10_gpu10&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge1659" class="edge">
<title>l2_attn_stage10_gpu10&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3219.98,-7074.19C3234.91,-7067.89 3251.24,-7062.14 3267,-7058.83 3324.64,-7046.74 4271.46,-7068.41 4327,-7048.83 4337.15,-7045.26 4337.08,-7039.85 4346,-7033.83 4375.36,-7014.01 4410.2,-6994.22 4436.72,-6979.88"/>
<polygon fill="red" stroke="red" points="4438.57,-6982.86 4445.73,-6975.05 4435.26,-6976.69 4438.57,-6982.86"/>
<text text-anchor="middle" x="4377.5" y="-7037.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu11 -->
<g id="node524" class="node">
<title>l2_attn_stage11_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3371" cy="-6957.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3371" y="-6968.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="3371" y="-6953.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3371" y="-6938.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu11&#45;&gt;l2_attn_stage11_gpu11 -->
<g id="edge492" class="edge">
<title>l2_attn_stage10_gpu11&#45;&gt;l2_attn_stage11_gpu11</title>
<path fill="none" stroke="black" d="M3371,-7066.74C3371,-7048.02 3371,-7025.03 3371,-7005.05"/>
<polygon fill="black" stroke="black" points="3374.5,-7004.91 3371,-6994.91 3367.5,-7004.91 3374.5,-7004.91"/>
</g>
<!-- l2_attn_stage10_gpu11&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge1660" class="edge">
<title>l2_attn_stage10_gpu11&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3427.98,-7074.2C3442.91,-7067.91 3459.24,-7062.15 3475,-7058.83 3500.5,-7053.46 4389.88,-7060.85 4413,-7048.83 4426.7,-7041.71 4448.58,-7008.29 4463.12,-6984.13"/>
<polygon fill="red" stroke="red" points="4466.21,-6985.79 4468.3,-6975.4 4460.19,-6982.22 4466.21,-6985.79"/>
<text text-anchor="middle" x="4459.5" y="-7037.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu12 -->
<g id="node525" class="node">
<title>l2_attn_stage11_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3579" cy="-6957.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3579" y="-6968.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="3579" y="-6953.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3579" y="-6938.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu12&#45;&gt;l2_attn_stage11_gpu12 -->
<g id="edge493" class="edge">
<title>l2_attn_stage10_gpu12&#45;&gt;l2_attn_stage11_gpu12</title>
<path fill="none" stroke="black" d="M3516.19,-7076.01C3502.64,-7070.24 3488.37,-7064.26 3475,-7058.83 3463.53,-7054.17 3456.01,-7059.04 3449,-7048.83 3445.23,-7043.34 3445.04,-7039.19 3449,-7033.83 3456.18,-7024.11 3464.05,-7030.95 3475,-7025.83 3492.44,-7017.68 3510.39,-7006.99 3526.36,-6996.52"/>
<polygon fill="black" stroke="black" points="3528.64,-6999.21 3535.02,-6990.75 3524.76,-6993.39 3528.64,-6999.21"/>
</g>
<!-- l2_attn_stage10_gpu12&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge1661" class="edge">
<title>l2_attn_stage10_gpu12&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3635.99,-7074.22C3650.91,-7067.92 3667.24,-7062.16 3683,-7058.83 3705.18,-7054.14 4483.07,-7064.96 4499,-7048.83 4515.71,-7031.92 4506.21,-7004.47 4495.15,-6984.23"/>
<polygon fill="red" stroke="red" points="4498.11,-6982.37 4490.04,-6975.51 4492.07,-6985.9 4498.11,-6982.37"/>
<text text-anchor="middle" x="4537.5" y="-7037.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu13 -->
<g id="node526" class="node">
<title>l2_attn_stage11_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3787" cy="-6957.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3787" y="-6968.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="3787" y="-6953.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3787" y="-6938.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu13&#45;&gt;l2_attn_stage11_gpu13 -->
<g id="edge494" class="edge">
<title>l2_attn_stage10_gpu13&#45;&gt;l2_attn_stage11_gpu13</title>
<path fill="none" stroke="black" d="M3729.39,-7074.33C3714.62,-7068.12 3698.51,-7062.37 3683,-7058.83 3658.39,-7053.22 3473.45,-7067.07 3456,-7048.83 3451.39,-7044.02 3451.37,-7038.63 3456,-7033.83 3464.76,-7024.75 3670.97,-7029.63 3683,-7025.83 3702.58,-7019.66 3722,-7008.72 3738.67,-6997.41"/>
<polygon fill="black" stroke="black" points="3740.94,-7000.1 3747.13,-6991.49 3736.93,-6994.36 3740.94,-7000.1"/>
</g>
<!-- l2_attn_stage10_gpu13&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge1662" class="edge">
<title>l2_attn_stage10_gpu13&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3843.99,-7074.24C3858.92,-7067.95 3875.25,-7062.18 3891,-7058.83 3909.86,-7054.82 4571.47,-7062.56 4585,-7048.83 4610.62,-7022.84 4569.49,-6996.25 4531.04,-6978.67"/>
<polygon fill="red" stroke="red" points="4532.44,-6975.46 4521.88,-6974.62 4529.61,-6981.87 4532.44,-6975.46"/>
<text text-anchor="middle" x="4623.5" y="-7037.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu14 -->
<g id="node527" class="node">
<title>l2_attn_stage11_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3995" cy="-6957.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3995" y="-6968.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="3995" y="-6953.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3995" y="-6938.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu14&#45;&gt;l2_attn_stage11_gpu14 -->
<g id="edge495" class="edge">
<title>l2_attn_stage10_gpu14&#45;&gt;l2_attn_stage11_gpu14</title>
<path fill="none" stroke="black" d="M3937.71,-7074.23C3922.86,-7067.97 3906.64,-7062.23 3891,-7058.83 3867.76,-7053.78 3479.62,-7065.85 3463,-7048.83 3458.34,-7044.06 3458.33,-7038.59 3463,-7033.83 3471.33,-7025.35 3879.63,-7029.31 3891,-7025.83 3910.63,-7019.82 3930.07,-7008.92 3946.73,-6997.61"/>
<polygon fill="black" stroke="black" points="3949.01,-7000.29 3955.18,-6991.68 3944.99,-6994.56 3949.01,-7000.29"/>
</g>
<!-- l2_attn_stage10_gpu14&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge1663" class="edge">
<title>l2_attn_stage10_gpu14&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4052,-7074.28C4066.92,-7067.98 4083.25,-7062.2 4099,-7058.83 4114.54,-7055.51 4659.86,-7060.17 4671,-7048.83 4707.88,-7011.3 4644.24,-6987.54 4580.37,-6973.83"/>
<polygon fill="red" stroke="red" points="4581.05,-6970.4 4570.55,-6971.8 4579.63,-6977.25 4581.05,-6970.4"/>
<text text-anchor="middle" x="4710.5" y="-7037.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage11_gpu15 -->
<g id="node528" class="node">
<title>l2_attn_stage11_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4203" cy="-6957.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4203" y="-6968.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage11</text>
<text text-anchor="middle" x="4203" y="-6953.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4203" y="-6938.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage10_gpu15&#45;&gt;l2_attn_stage11_gpu15 -->
<g id="edge496" class="edge">
<title>l2_attn_stage10_gpu15&#45;&gt;l2_attn_stage11_gpu15</title>
<path fill="none" stroke="black" d="M4146,-7074.26C4131.08,-7067.96 4114.75,-7062.19 4099,-7058.83 4081.91,-7055.19 3482.26,-7061.29 3470,-7048.83 3465.32,-7044.08 3465.32,-7038.58 3470,-7033.83 3482.28,-7021.4 4082.28,-7030.9 4099,-7025.83 4118.65,-7019.88 4138.09,-7008.99 4154.75,-6997.67"/>
<polygon fill="black" stroke="black" points="4157.03,-7000.35 4163.2,-6991.74 4153.01,-6994.63 4157.03,-7000.35"/>
</g>
<!-- l2_attn_stage10_gpu15&#45;&gt;l2_attn_stage11_gpu[next_gpu] -->
<g id="edge1664" class="edge">
<title>l2_attn_stage10_gpu15&#45;&gt;l2_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4262.56,-7074.91C4278.88,-7068.39 4296.81,-7062.35 4314,-7058.83 4338.12,-7053.89 4739.79,-7066.43 4757,-7048.83 4806.67,-6998.03 4719.33,-6975.72 4629.57,-6965.94"/>
<polygon fill="red" stroke="red" points="4629.78,-6962.44 4619.47,-6964.89 4629.05,-6969.4 4629.78,-6962.44"/>
<text text-anchor="middle" x="4796.5" y="-7037.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu0 -->
<g id="node529" class="node">
<title>l2_attn_stage12_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1083" cy="-6810.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1083" y="-6821.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="1083" y="-6806.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1083" y="-6791.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu0&#45;&gt;l2_attn_stage12_gpu0 -->
<g id="edge497" class="edge">
<title>l2_attn_stage11_gpu0&#45;&gt;l2_attn_stage12_gpu0</title>
<path fill="none" stroke="black" d="M1083,-6919.74C1083,-6901.02 1083,-6878.03 1083,-6858.05"/>
<polygon fill="black" stroke="black" points="1086.5,-6857.91 1083,-6847.91 1079.5,-6857.91 1086.5,-6857.91"/>
</g>
<!-- l2_attn_stage12_gpu[next_gpu] -->
<g id="node1339" class="node">
<title>l2_attn_stage12_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4478" cy="-6810.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4478" y="-6806.63" font-family="Times,serif" font-size="14.00">l2_attn_stage12_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage11_gpu0&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge1665" class="edge">
<title>l2_attn_stage11_gpu0&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1139.98,-6927.2C1154.91,-6920.91 1171.24,-6915.15 1187,-6911.83 1436.97,-6859.18 3230.55,-6889.46 3486,-6886.83 3531.78,-6886.36 4265.1,-6887.74 4310,-6878.83 4355.32,-6869.84 4403.98,-6848.92 4437.21,-6832.73"/>
<polygon fill="red" stroke="red" points="4439.17,-6835.67 4446.58,-6828.1 4436.06,-6829.4 4439.17,-6835.67"/>
<text text-anchor="middle" x="3517.5" y="-6890.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu1 -->
<g id="node530" class="node">
<title>l2_attn_stage12_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1291" cy="-6810.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1291" y="-6821.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="1291" y="-6806.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1291" y="-6791.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu1&#45;&gt;l2_attn_stage12_gpu1 -->
<g id="edge498" class="edge">
<title>l2_attn_stage11_gpu1&#45;&gt;l2_attn_stage12_gpu1</title>
<path fill="none" stroke="black" d="M1291,-6919.74C1291,-6901.02 1291,-6878.03 1291,-6858.05"/>
<polygon fill="black" stroke="black" points="1294.5,-6857.91 1291,-6847.91 1287.5,-6857.91 1294.5,-6857.91"/>
</g>
<!-- l2_attn_stage11_gpu1&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge1666" class="edge">
<title>l2_attn_stage11_gpu1&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1347.97,-6927.14C1362.89,-6920.84 1379.23,-6915.1 1395,-6911.83 1453.7,-6899.66 3496.42,-6921.62 3553,-6901.83 3563.16,-6898.28 3561.86,-6890.42 3572,-6886.83 3610.66,-6873.17 4269.79,-6886.83 4310,-6878.83 4355.31,-6869.81 4403.98,-6848.9 4437.21,-6832.72"/>
<polygon fill="red" stroke="red" points="4439.17,-6835.66 4446.58,-6828.08 4436.06,-6829.38 4439.17,-6835.66"/>
<text text-anchor="middle" x="3603.5" y="-6890.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu2 -->
<g id="node531" class="node">
<title>l2_attn_stage12_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1499" cy="-6810.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1499" y="-6821.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="1499" y="-6806.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1499" y="-6791.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu2&#45;&gt;l2_attn_stage12_gpu2 -->
<g id="edge499" class="edge">
<title>l2_attn_stage11_gpu2&#45;&gt;l2_attn_stage12_gpu2</title>
<path fill="none" stroke="black" d="M1499,-6919.74C1499,-6901.02 1499,-6878.03 1499,-6858.05"/>
<polygon fill="black" stroke="black" points="1502.5,-6857.91 1499,-6847.91 1495.5,-6857.91 1502.5,-6857.91"/>
</g>
<!-- l2_attn_stage11_gpu2&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge1667" class="edge">
<title>l2_attn_stage11_gpu2&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1555.97,-6927.14C1570.89,-6920.85 1587.23,-6915.1 1603,-6911.83 1658.38,-6900.34 3585.62,-6920.51 3639,-6901.83 3649.16,-6898.28 3647.86,-6890.42 3658,-6886.83 3692.15,-6874.74 4274.48,-6885.93 4310,-6878.83 4355.31,-6869.78 4403.97,-6848.87 4437.2,-6832.7"/>
<polygon fill="red" stroke="red" points="4439.16,-6835.64 4446.57,-6828.07 4436.06,-6829.36 4439.16,-6835.64"/>
<text text-anchor="middle" x="3689.5" y="-6890.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu3 -->
<g id="node532" class="node">
<title>l2_attn_stage12_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1707" cy="-6810.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1707" y="-6821.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="1707" y="-6806.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1707" y="-6791.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu3&#45;&gt;l2_attn_stage12_gpu3 -->
<g id="edge500" class="edge">
<title>l2_attn_stage11_gpu3&#45;&gt;l2_attn_stage12_gpu3</title>
<path fill="none" stroke="black" d="M1707,-6919.74C1707,-6901.02 1707,-6878.03 1707,-6858.05"/>
<polygon fill="black" stroke="black" points="1710.5,-6857.91 1707,-6847.91 1703.5,-6857.91 1710.5,-6857.91"/>
</g>
<!-- l2_attn_stage11_gpu3&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge1668" class="edge">
<title>l2_attn_stage11_gpu3&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1763.97,-6927.14C1778.9,-6920.85 1795.23,-6915.11 1811,-6911.83 1863.06,-6901.02 3674.82,-6919.4 3725,-6901.83 3735.15,-6898.28 3733.86,-6890.43 3744,-6886.83 3773.63,-6876.31 4279.17,-6885.02 4310,-6878.83 4355.3,-6869.74 4403.97,-6848.83 4437.2,-6832.68"/>
<polygon fill="red" stroke="red" points="4439.15,-6835.62 4446.57,-6828.05 4436.05,-6829.34 4439.15,-6835.62"/>
<text text-anchor="middle" x="3775.5" y="-6890.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu4 -->
<g id="node533" class="node">
<title>l2_attn_stage12_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1915" cy="-6810.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1915" y="-6821.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="1915" y="-6806.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1915" y="-6791.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu4&#45;&gt;l2_attn_stage12_gpu4 -->
<g id="edge501" class="edge">
<title>l2_attn_stage11_gpu4&#45;&gt;l2_attn_stage12_gpu4</title>
<path fill="none" stroke="black" d="M1915,-6919.74C1915,-6901.02 1915,-6878.03 1915,-6858.05"/>
<polygon fill="black" stroke="black" points="1918.5,-6857.91 1915,-6847.91 1911.5,-6857.91 1918.5,-6857.91"/>
</g>
<!-- l2_attn_stage11_gpu4&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge1669" class="edge">
<title>l2_attn_stage11_gpu4&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1971.97,-6927.15C1986.9,-6920.85 2003.23,-6915.11 2019,-6911.83 2067.74,-6901.7 3764.02,-6918.29 3811,-6901.83 3821.15,-6898.27 3819.87,-6890.44 3830,-6886.83 3880.24,-6868.92 4257.72,-6889.4 4310,-6878.83 4355.29,-6869.68 4403.96,-6848.79 4437.19,-6832.65"/>
<polygon fill="red" stroke="red" points="4439.14,-6835.59 4446.56,-6828.03 4436.05,-6829.31 4439.14,-6835.59"/>
<text text-anchor="middle" x="3861.5" y="-6890.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu5 -->
<g id="node534" class="node">
<title>l2_attn_stage12_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2123" cy="-6810.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2123" y="-6821.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="2123" y="-6806.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2123" y="-6791.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu5&#45;&gt;l2_attn_stage12_gpu5 -->
<g id="edge502" class="edge">
<title>l2_attn_stage11_gpu5&#45;&gt;l2_attn_stage12_gpu5</title>
<path fill="none" stroke="black" d="M2123,-6919.74C2123,-6901.02 2123,-6878.03 2123,-6858.05"/>
<polygon fill="black" stroke="black" points="2126.5,-6857.91 2123,-6847.91 2119.5,-6857.91 2126.5,-6857.91"/>
</g>
<!-- l2_attn_stage11_gpu5&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge1670" class="edge">
<title>l2_attn_stage11_gpu5&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2179.97,-6927.15C2194.9,-6920.86 2211.23,-6915.11 2227,-6911.83 2272.42,-6902.38 3853.22,-6917.18 3897,-6901.83 3907.15,-6898.27 3905.87,-6890.46 3916,-6886.83 3957.22,-6872.05 4267.1,-6887.58 4310,-6878.83 4355.27,-6869.6 4403.94,-6848.72 4437.18,-6832.6"/>
<polygon fill="red" stroke="red" points="4439.13,-6835.55 4446.56,-6827.99 4436.04,-6829.27 4439.13,-6835.55"/>
<text text-anchor="middle" x="3947.5" y="-6890.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu6 -->
<g id="node535" class="node">
<title>l2_attn_stage12_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2331" cy="-6810.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2331" y="-6821.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="2331" y="-6806.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2331" y="-6791.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu6&#45;&gt;l2_attn_stage12_gpu6 -->
<g id="edge503" class="edge">
<title>l2_attn_stage11_gpu6&#45;&gt;l2_attn_stage12_gpu6</title>
<path fill="none" stroke="black" d="M2331,-6919.74C2331,-6901.02 2331,-6878.03 2331,-6858.05"/>
<polygon fill="black" stroke="black" points="2334.5,-6857.91 2331,-6847.91 2327.5,-6857.91 2334.5,-6857.91"/>
</g>
<!-- l2_attn_stage11_gpu6&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge1671" class="edge">
<title>l2_attn_stage11_gpu6&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2387.97,-6927.16C2402.9,-6920.86 2419.23,-6915.12 2435,-6911.83 2477.1,-6903.06 3942.42,-6916.07 3983,-6901.83 3993.15,-6898.27 3991.88,-6890.49 4002,-6886.83 4034.19,-6875.19 4276.48,-6885.77 4310,-6878.83 4355.11,-6869.5 4403.62,-6848.74 4436.86,-6832.68"/>
<polygon fill="red" stroke="red" points="4438.8,-6835.63 4446.24,-6828.08 4435.72,-6829.34 4438.8,-6835.63"/>
<text text-anchor="middle" x="4033.5" y="-6890.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu7 -->
<g id="node536" class="node">
<title>l2_attn_stage12_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2539" cy="-6810.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2539" y="-6821.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="2539" y="-6806.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2539" y="-6791.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu7&#45;&gt;l2_attn_stage12_gpu7 -->
<g id="edge504" class="edge">
<title>l2_attn_stage11_gpu7&#45;&gt;l2_attn_stage12_gpu7</title>
<path fill="none" stroke="black" d="M2539,-6919.74C2539,-6901.02 2539,-6878.03 2539,-6858.05"/>
<polygon fill="black" stroke="black" points="2542.5,-6857.91 2539,-6847.91 2535.5,-6857.91 2542.5,-6857.91"/>
</g>
<!-- l2_attn_stage11_gpu7&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge1672" class="edge">
<title>l2_attn_stage11_gpu7&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2595.98,-6927.16C2610.9,-6920.87 2627.24,-6915.12 2643,-6911.83 2681.78,-6903.74 4031.62,-6914.95 4069,-6901.83 4079.15,-6898.27 4077.9,-6890.54 4088,-6886.83 4134.34,-6869.8 4261.71,-6889.08 4310,-6878.83 4355.06,-6869.27 4403.58,-6848.54 4436.83,-6832.56"/>
<polygon fill="red" stroke="red" points="4438.76,-6835.51 4446.22,-6827.98 4435.69,-6829.22 4438.76,-6835.51"/>
<text text-anchor="middle" x="4119.5" y="-6890.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu8 -->
<g id="node537" class="node">
<title>l2_attn_stage12_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2747" cy="-6810.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2747" y="-6821.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="2747" y="-6806.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2747" y="-6791.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu8&#45;&gt;l2_attn_stage12_gpu8 -->
<g id="edge505" class="edge">
<title>l2_attn_stage11_gpu8&#45;&gt;l2_attn_stage12_gpu8</title>
<path fill="none" stroke="black" d="M2747,-6919.74C2747,-6901.02 2747,-6878.03 2747,-6858.05"/>
<polygon fill="black" stroke="black" points="2750.5,-6857.91 2747,-6847.91 2743.5,-6857.91 2750.5,-6857.91"/>
</g>
<!-- l2_attn_stage11_gpu8&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge1673" class="edge">
<title>l2_attn_stage11_gpu8&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2803.98,-6927.17C2818.9,-6920.88 2835.24,-6915.13 2851,-6911.83 2921.91,-6897.01 4086.65,-6925.85 4155,-6901.83 4165.15,-6898.26 4163.94,-6890.66 4174,-6886.83 4202.3,-6876.07 4280.46,-6885.45 4310,-6878.83 4354.67,-6868.82 4402.88,-6848.36 4436.15,-6832.57"/>
<polygon fill="red" stroke="red" points="4438.06,-6835.54 4445.55,-6828.05 4435.02,-6829.23 4438.06,-6835.54"/>
<text text-anchor="middle" x="4205.5" y="-6890.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu9 -->
<g id="node538" class="node">
<title>l2_attn_stage12_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2955" cy="-6810.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2955" y="-6821.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="2955" y="-6806.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2955" y="-6791.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu9&#45;&gt;l2_attn_stage12_gpu9 -->
<g id="edge506" class="edge">
<title>l2_attn_stage11_gpu9&#45;&gt;l2_attn_stage12_gpu9</title>
<path fill="none" stroke="black" d="M2955,-6919.74C2955,-6901.02 2955,-6878.03 2955,-6858.05"/>
<polygon fill="black" stroke="black" points="2958.5,-6857.91 2955,-6847.91 2951.5,-6857.91 2958.5,-6857.91"/>
</g>
<!-- l2_attn_stage11_gpu9&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge1674" class="edge">
<title>l2_attn_stage11_gpu9&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3011.98,-6927.18C3026.9,-6920.88 3043.24,-6915.13 3059,-6911.83 3123.28,-6898.37 4179.05,-6923.63 4241,-6901.83 4251.15,-6898.26 4250.15,-6891.15 4260,-6886.83 4280.61,-6877.79 4288.31,-6884.84 4310,-6878.83 4353.28,-6866.84 4400.59,-6847.2 4433.94,-6832.19"/>
<polygon fill="red" stroke="red" points="4435.74,-6835.22 4443.4,-6827.9 4432.84,-6828.85 4435.74,-6835.22"/>
<text text-anchor="middle" x="4291.5" y="-6890.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu10 -->
<g id="node539" class="node">
<title>l2_attn_stage12_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3163" cy="-6810.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3163" y="-6821.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="3163" y="-6806.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3163" y="-6791.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu10&#45;&gt;l2_attn_stage12_gpu10 -->
<g id="edge507" class="edge">
<title>l2_attn_stage11_gpu10&#45;&gt;l2_attn_stage12_gpu10</title>
<path fill="none" stroke="black" d="M3163,-6919.74C3163,-6901.02 3163,-6878.03 3163,-6858.05"/>
<polygon fill="black" stroke="black" points="3166.5,-6857.91 3163,-6847.91 3159.5,-6857.91 3166.5,-6857.91"/>
</g>
<!-- l2_attn_stage11_gpu10&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge1675" class="edge">
<title>l2_attn_stage11_gpu10&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3219.98,-6927.19C3234.91,-6920.89 3251.24,-6915.14 3267,-6911.83 3324.64,-6899.74 4271.46,-6921.41 4327,-6901.83 4337.15,-6898.26 4337.08,-6892.85 4346,-6886.83 4375.36,-6867.01 4410.2,-6847.22 4436.72,-6832.88"/>
<polygon fill="red" stroke="red" points="4438.57,-6835.86 4445.73,-6828.05 4435.26,-6829.69 4438.57,-6835.86"/>
<text text-anchor="middle" x="4377.5" y="-6890.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu11 -->
<g id="node540" class="node">
<title>l2_attn_stage12_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3371" cy="-6810.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3371" y="-6821.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="3371" y="-6806.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3371" y="-6791.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu11&#45;&gt;l2_attn_stage12_gpu11 -->
<g id="edge508" class="edge">
<title>l2_attn_stage11_gpu11&#45;&gt;l2_attn_stage12_gpu11</title>
<path fill="none" stroke="black" d="M3371,-6919.74C3371,-6901.02 3371,-6878.03 3371,-6858.05"/>
<polygon fill="black" stroke="black" points="3374.5,-6857.91 3371,-6847.91 3367.5,-6857.91 3374.5,-6857.91"/>
</g>
<!-- l2_attn_stage11_gpu11&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge1676" class="edge">
<title>l2_attn_stage11_gpu11&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3427.98,-6927.2C3442.91,-6920.91 3459.24,-6915.15 3475,-6911.83 3500.5,-6906.46 4389.88,-6913.85 4413,-6901.83 4426.7,-6894.71 4448.58,-6861.29 4463.12,-6837.13"/>
<polygon fill="red" stroke="red" points="4466.21,-6838.79 4468.3,-6828.4 4460.19,-6835.22 4466.21,-6838.79"/>
<text text-anchor="middle" x="4459.5" y="-6890.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu12 -->
<g id="node541" class="node">
<title>l2_attn_stage12_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3579" cy="-6810.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3579" y="-6821.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="3579" y="-6806.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3579" y="-6791.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu12&#45;&gt;l2_attn_stage12_gpu12 -->
<g id="edge509" class="edge">
<title>l2_attn_stage11_gpu12&#45;&gt;l2_attn_stage12_gpu12</title>
<path fill="none" stroke="black" d="M3516.19,-6929.01C3502.64,-6923.24 3488.37,-6917.26 3475,-6911.83 3463.53,-6907.17 3456.01,-6912.04 3449,-6901.83 3445.23,-6896.34 3445.04,-6892.19 3449,-6886.83 3456.18,-6877.11 3464.05,-6883.95 3475,-6878.83 3492.44,-6870.68 3510.39,-6859.99 3526.36,-6849.52"/>
<polygon fill="black" stroke="black" points="3528.64,-6852.21 3535.02,-6843.75 3524.76,-6846.39 3528.64,-6852.21"/>
</g>
<!-- l2_attn_stage11_gpu12&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge1677" class="edge">
<title>l2_attn_stage11_gpu12&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3635.99,-6927.22C3650.91,-6920.92 3667.24,-6915.16 3683,-6911.83 3705.18,-6907.14 4483.07,-6917.96 4499,-6901.83 4515.71,-6884.92 4506.21,-6857.47 4495.15,-6837.23"/>
<polygon fill="red" stroke="red" points="4498.11,-6835.37 4490.04,-6828.51 4492.07,-6838.9 4498.11,-6835.37"/>
<text text-anchor="middle" x="4537.5" y="-6890.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu13 -->
<g id="node542" class="node">
<title>l2_attn_stage12_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3787" cy="-6810.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3787" y="-6821.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="3787" y="-6806.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3787" y="-6791.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu13&#45;&gt;l2_attn_stage12_gpu13 -->
<g id="edge510" class="edge">
<title>l2_attn_stage11_gpu13&#45;&gt;l2_attn_stage12_gpu13</title>
<path fill="none" stroke="black" d="M3729.39,-6927.33C3714.62,-6921.12 3698.51,-6915.37 3683,-6911.83 3658.39,-6906.22 3473.45,-6920.07 3456,-6901.83 3451.39,-6897.02 3451.37,-6891.63 3456,-6886.83 3464.76,-6877.75 3670.97,-6882.63 3683,-6878.83 3702.58,-6872.66 3722,-6861.72 3738.67,-6850.41"/>
<polygon fill="black" stroke="black" points="3740.94,-6853.1 3747.13,-6844.49 3736.93,-6847.36 3740.94,-6853.1"/>
</g>
<!-- l2_attn_stage11_gpu13&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge1678" class="edge">
<title>l2_attn_stage11_gpu13&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3843.99,-6927.24C3858.92,-6920.95 3875.25,-6915.18 3891,-6911.83 3909.86,-6907.82 4571.47,-6915.56 4585,-6901.83 4610.62,-6875.84 4569.49,-6849.25 4531.04,-6831.67"/>
<polygon fill="red" stroke="red" points="4532.44,-6828.46 4521.88,-6827.62 4529.61,-6834.87 4532.44,-6828.46"/>
<text text-anchor="middle" x="4623.5" y="-6890.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu14 -->
<g id="node543" class="node">
<title>l2_attn_stage12_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3995" cy="-6810.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3995" y="-6821.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="3995" y="-6806.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3995" y="-6791.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu14&#45;&gt;l2_attn_stage12_gpu14 -->
<g id="edge511" class="edge">
<title>l2_attn_stage11_gpu14&#45;&gt;l2_attn_stage12_gpu14</title>
<path fill="none" stroke="black" d="M3937.71,-6927.23C3922.86,-6920.97 3906.64,-6915.23 3891,-6911.83 3867.76,-6906.78 3479.62,-6918.85 3463,-6901.83 3458.34,-6897.06 3458.33,-6891.59 3463,-6886.83 3471.33,-6878.35 3879.63,-6882.31 3891,-6878.83 3910.63,-6872.82 3930.07,-6861.92 3946.73,-6850.61"/>
<polygon fill="black" stroke="black" points="3949.01,-6853.29 3955.18,-6844.68 3944.99,-6847.56 3949.01,-6853.29"/>
</g>
<!-- l2_attn_stage11_gpu14&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge1679" class="edge">
<title>l2_attn_stage11_gpu14&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4052,-6927.28C4066.92,-6920.98 4083.25,-6915.2 4099,-6911.83 4114.54,-6908.51 4659.86,-6913.17 4671,-6901.83 4707.88,-6864.3 4644.24,-6840.54 4580.37,-6826.83"/>
<polygon fill="red" stroke="red" points="4581.05,-6823.4 4570.55,-6824.8 4579.63,-6830.25 4581.05,-6823.4"/>
<text text-anchor="middle" x="4710.5" y="-6890.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage12_gpu15 -->
<g id="node544" class="node">
<title>l2_attn_stage12_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4203" cy="-6810.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4203" y="-6821.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage12</text>
<text text-anchor="middle" x="4203" y="-6806.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4203" y="-6791.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage11_gpu15&#45;&gt;l2_attn_stage12_gpu15 -->
<g id="edge512" class="edge">
<title>l2_attn_stage11_gpu15&#45;&gt;l2_attn_stage12_gpu15</title>
<path fill="none" stroke="black" d="M4146,-6927.26C4131.08,-6920.96 4114.75,-6915.19 4099,-6911.83 4081.91,-6908.19 3482.26,-6914.29 3470,-6901.83 3465.32,-6897.08 3465.32,-6891.58 3470,-6886.83 3482.28,-6874.4 4082.28,-6883.9 4099,-6878.83 4118.65,-6872.88 4138.09,-6861.99 4154.75,-6850.67"/>
<polygon fill="black" stroke="black" points="4157.03,-6853.35 4163.2,-6844.74 4153.01,-6847.63 4157.03,-6853.35"/>
</g>
<!-- l2_attn_stage11_gpu15&#45;&gt;l2_attn_stage12_gpu[next_gpu] -->
<g id="edge1680" class="edge">
<title>l2_attn_stage11_gpu15&#45;&gt;l2_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4262.56,-6927.91C4278.88,-6921.39 4296.81,-6915.35 4314,-6911.83 4338.12,-6906.89 4739.79,-6919.43 4757,-6901.83 4806.67,-6851.03 4719.33,-6828.72 4629.57,-6818.94"/>
<polygon fill="red" stroke="red" points="4629.78,-6815.44 4619.47,-6817.89 4629.05,-6822.4 4629.78,-6815.44"/>
<text text-anchor="middle" x="4796.5" y="-6890.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu0 -->
<g id="node545" class="node">
<title>l2_attn_stage13_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1083" cy="-6663.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1083" y="-6674.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="1083" y="-6659.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1083" y="-6644.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu0&#45;&gt;l2_attn_stage13_gpu0 -->
<g id="edge513" class="edge">
<title>l2_attn_stage12_gpu0&#45;&gt;l2_attn_stage13_gpu0</title>
<path fill="none" stroke="black" d="M1083,-6772.74C1083,-6754.02 1083,-6731.03 1083,-6711.05"/>
<polygon fill="black" stroke="black" points="1086.5,-6710.91 1083,-6700.91 1079.5,-6710.91 1086.5,-6710.91"/>
</g>
<!-- l2_attn_stage13_gpu[next_gpu] -->
<g id="node1340" class="node">
<title>l2_attn_stage13_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4478" cy="-6663.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4478" y="-6659.63" font-family="Times,serif" font-size="14.00">l2_attn_stage13_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage12_gpu0&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge1681" class="edge">
<title>l2_attn_stage12_gpu0&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1139.98,-6780.2C1154.91,-6773.91 1171.24,-6768.15 1187,-6764.83 1436.97,-6712.18 3230.55,-6742.46 3486,-6739.83 3531.78,-6739.36 4265.1,-6740.74 4310,-6731.83 4355.32,-6722.84 4403.98,-6701.92 4437.21,-6685.73"/>
<polygon fill="red" stroke="red" points="4439.17,-6688.67 4446.58,-6681.1 4436.06,-6682.4 4439.17,-6688.67"/>
<text text-anchor="middle" x="3517.5" y="-6743.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu1 -->
<g id="node546" class="node">
<title>l2_attn_stage13_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1291" cy="-6663.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1291" y="-6674.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="1291" y="-6659.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1291" y="-6644.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu1&#45;&gt;l2_attn_stage13_gpu1 -->
<g id="edge514" class="edge">
<title>l2_attn_stage12_gpu1&#45;&gt;l2_attn_stage13_gpu1</title>
<path fill="none" stroke="black" d="M1291,-6772.74C1291,-6754.02 1291,-6731.03 1291,-6711.05"/>
<polygon fill="black" stroke="black" points="1294.5,-6710.91 1291,-6700.91 1287.5,-6710.91 1294.5,-6710.91"/>
</g>
<!-- l2_attn_stage12_gpu1&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge1682" class="edge">
<title>l2_attn_stage12_gpu1&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1347.97,-6780.14C1362.89,-6773.84 1379.23,-6768.1 1395,-6764.83 1453.7,-6752.66 3496.42,-6774.62 3553,-6754.83 3563.16,-6751.28 3561.86,-6743.42 3572,-6739.83 3610.66,-6726.17 4269.79,-6739.83 4310,-6731.83 4355.31,-6722.81 4403.98,-6701.9 4437.21,-6685.72"/>
<polygon fill="red" stroke="red" points="4439.17,-6688.66 4446.58,-6681.08 4436.06,-6682.38 4439.17,-6688.66"/>
<text text-anchor="middle" x="3603.5" y="-6743.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu2 -->
<g id="node547" class="node">
<title>l2_attn_stage13_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1499" cy="-6663.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1499" y="-6674.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="1499" y="-6659.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1499" y="-6644.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu2&#45;&gt;l2_attn_stage13_gpu2 -->
<g id="edge515" class="edge">
<title>l2_attn_stage12_gpu2&#45;&gt;l2_attn_stage13_gpu2</title>
<path fill="none" stroke="black" d="M1499,-6772.74C1499,-6754.02 1499,-6731.03 1499,-6711.05"/>
<polygon fill="black" stroke="black" points="1502.5,-6710.91 1499,-6700.91 1495.5,-6710.91 1502.5,-6710.91"/>
</g>
<!-- l2_attn_stage12_gpu2&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge1683" class="edge">
<title>l2_attn_stage12_gpu2&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1555.97,-6780.14C1570.89,-6773.85 1587.23,-6768.1 1603,-6764.83 1658.38,-6753.34 3585.62,-6773.51 3639,-6754.83 3649.16,-6751.28 3647.86,-6743.42 3658,-6739.83 3692.15,-6727.74 4274.48,-6738.93 4310,-6731.83 4355.31,-6722.78 4403.97,-6701.87 4437.2,-6685.7"/>
<polygon fill="red" stroke="red" points="4439.16,-6688.64 4446.57,-6681.07 4436.06,-6682.36 4439.16,-6688.64"/>
<text text-anchor="middle" x="3689.5" y="-6743.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu3 -->
<g id="node548" class="node">
<title>l2_attn_stage13_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1707" cy="-6663.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1707" y="-6674.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="1707" y="-6659.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1707" y="-6644.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu3&#45;&gt;l2_attn_stage13_gpu3 -->
<g id="edge516" class="edge">
<title>l2_attn_stage12_gpu3&#45;&gt;l2_attn_stage13_gpu3</title>
<path fill="none" stroke="black" d="M1707,-6772.74C1707,-6754.02 1707,-6731.03 1707,-6711.05"/>
<polygon fill="black" stroke="black" points="1710.5,-6710.91 1707,-6700.91 1703.5,-6710.91 1710.5,-6710.91"/>
</g>
<!-- l2_attn_stage12_gpu3&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge1684" class="edge">
<title>l2_attn_stage12_gpu3&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1763.97,-6780.14C1778.9,-6773.85 1795.23,-6768.11 1811,-6764.83 1863.06,-6754.02 3674.82,-6772.4 3725,-6754.83 3735.15,-6751.28 3733.86,-6743.43 3744,-6739.83 3773.63,-6729.31 4279.17,-6738.02 4310,-6731.83 4355.3,-6722.74 4403.97,-6701.83 4437.2,-6685.68"/>
<polygon fill="red" stroke="red" points="4439.15,-6688.62 4446.57,-6681.05 4436.05,-6682.34 4439.15,-6688.62"/>
<text text-anchor="middle" x="3775.5" y="-6743.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu4 -->
<g id="node549" class="node">
<title>l2_attn_stage13_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1915" cy="-6663.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1915" y="-6674.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="1915" y="-6659.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1915" y="-6644.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu4&#45;&gt;l2_attn_stage13_gpu4 -->
<g id="edge517" class="edge">
<title>l2_attn_stage12_gpu4&#45;&gt;l2_attn_stage13_gpu4</title>
<path fill="none" stroke="black" d="M1915,-6772.74C1915,-6754.02 1915,-6731.03 1915,-6711.05"/>
<polygon fill="black" stroke="black" points="1918.5,-6710.91 1915,-6700.91 1911.5,-6710.91 1918.5,-6710.91"/>
</g>
<!-- l2_attn_stage12_gpu4&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge1685" class="edge">
<title>l2_attn_stage12_gpu4&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1971.97,-6780.15C1986.9,-6773.85 2003.23,-6768.11 2019,-6764.83 2067.74,-6754.7 3764.02,-6771.29 3811,-6754.83 3821.15,-6751.27 3819.87,-6743.44 3830,-6739.83 3880.24,-6721.92 4257.72,-6742.4 4310,-6731.83 4355.29,-6722.68 4403.96,-6701.79 4437.19,-6685.65"/>
<polygon fill="red" stroke="red" points="4439.14,-6688.59 4446.56,-6681.03 4436.05,-6682.31 4439.14,-6688.59"/>
<text text-anchor="middle" x="3861.5" y="-6743.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu5 -->
<g id="node550" class="node">
<title>l2_attn_stage13_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2123" cy="-6663.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2123" y="-6674.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="2123" y="-6659.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2123" y="-6644.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu5&#45;&gt;l2_attn_stage13_gpu5 -->
<g id="edge518" class="edge">
<title>l2_attn_stage12_gpu5&#45;&gt;l2_attn_stage13_gpu5</title>
<path fill="none" stroke="black" d="M2123,-6772.74C2123,-6754.02 2123,-6731.03 2123,-6711.05"/>
<polygon fill="black" stroke="black" points="2126.5,-6710.91 2123,-6700.91 2119.5,-6710.91 2126.5,-6710.91"/>
</g>
<!-- l2_attn_stage12_gpu5&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge1686" class="edge">
<title>l2_attn_stage12_gpu5&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2179.97,-6780.15C2194.9,-6773.86 2211.23,-6768.11 2227,-6764.83 2272.42,-6755.38 3853.22,-6770.18 3897,-6754.83 3907.15,-6751.27 3905.87,-6743.46 3916,-6739.83 3957.22,-6725.05 4267.1,-6740.58 4310,-6731.83 4355.27,-6722.6 4403.94,-6701.72 4437.18,-6685.6"/>
<polygon fill="red" stroke="red" points="4439.13,-6688.55 4446.56,-6680.99 4436.04,-6682.27 4439.13,-6688.55"/>
<text text-anchor="middle" x="3947.5" y="-6743.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu6 -->
<g id="node551" class="node">
<title>l2_attn_stage13_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2331" cy="-6663.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2331" y="-6674.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="2331" y="-6659.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2331" y="-6644.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu6&#45;&gt;l2_attn_stage13_gpu6 -->
<g id="edge519" class="edge">
<title>l2_attn_stage12_gpu6&#45;&gt;l2_attn_stage13_gpu6</title>
<path fill="none" stroke="black" d="M2331,-6772.74C2331,-6754.02 2331,-6731.03 2331,-6711.05"/>
<polygon fill="black" stroke="black" points="2334.5,-6710.91 2331,-6700.91 2327.5,-6710.91 2334.5,-6710.91"/>
</g>
<!-- l2_attn_stage12_gpu6&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge1687" class="edge">
<title>l2_attn_stage12_gpu6&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2387.97,-6780.16C2402.9,-6773.86 2419.23,-6768.12 2435,-6764.83 2477.1,-6756.06 3942.42,-6769.07 3983,-6754.83 3993.15,-6751.27 3991.88,-6743.49 4002,-6739.83 4034.19,-6728.19 4276.48,-6738.77 4310,-6731.83 4355.11,-6722.5 4403.62,-6701.74 4436.86,-6685.68"/>
<polygon fill="red" stroke="red" points="4438.8,-6688.63 4446.24,-6681.08 4435.72,-6682.34 4438.8,-6688.63"/>
<text text-anchor="middle" x="4033.5" y="-6743.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu7 -->
<g id="node552" class="node">
<title>l2_attn_stage13_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2539" cy="-6663.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2539" y="-6674.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="2539" y="-6659.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2539" y="-6644.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu7&#45;&gt;l2_attn_stage13_gpu7 -->
<g id="edge520" class="edge">
<title>l2_attn_stage12_gpu7&#45;&gt;l2_attn_stage13_gpu7</title>
<path fill="none" stroke="black" d="M2539,-6772.74C2539,-6754.02 2539,-6731.03 2539,-6711.05"/>
<polygon fill="black" stroke="black" points="2542.5,-6710.91 2539,-6700.91 2535.5,-6710.91 2542.5,-6710.91"/>
</g>
<!-- l2_attn_stage12_gpu7&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge1688" class="edge">
<title>l2_attn_stage12_gpu7&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2595.98,-6780.16C2610.9,-6773.87 2627.24,-6768.12 2643,-6764.83 2681.78,-6756.74 4031.62,-6767.95 4069,-6754.83 4079.15,-6751.27 4077.9,-6743.54 4088,-6739.83 4134.34,-6722.8 4261.71,-6742.08 4310,-6731.83 4355.06,-6722.27 4403.58,-6701.54 4436.83,-6685.56"/>
<polygon fill="red" stroke="red" points="4438.76,-6688.51 4446.22,-6680.98 4435.69,-6682.22 4438.76,-6688.51"/>
<text text-anchor="middle" x="4119.5" y="-6743.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu8 -->
<g id="node553" class="node">
<title>l2_attn_stage13_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2747" cy="-6663.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2747" y="-6674.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="2747" y="-6659.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2747" y="-6644.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu8&#45;&gt;l2_attn_stage13_gpu8 -->
<g id="edge521" class="edge">
<title>l2_attn_stage12_gpu8&#45;&gt;l2_attn_stage13_gpu8</title>
<path fill="none" stroke="black" d="M2747,-6772.74C2747,-6754.02 2747,-6731.03 2747,-6711.05"/>
<polygon fill="black" stroke="black" points="2750.5,-6710.91 2747,-6700.91 2743.5,-6710.91 2750.5,-6710.91"/>
</g>
<!-- l2_attn_stage12_gpu8&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge1689" class="edge">
<title>l2_attn_stage12_gpu8&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2803.98,-6780.17C2818.9,-6773.88 2835.24,-6768.13 2851,-6764.83 2921.91,-6750.01 4086.65,-6778.85 4155,-6754.83 4165.15,-6751.26 4163.94,-6743.66 4174,-6739.83 4202.3,-6729.07 4280.46,-6738.45 4310,-6731.83 4354.67,-6721.82 4402.88,-6701.36 4436.15,-6685.57"/>
<polygon fill="red" stroke="red" points="4438.06,-6688.54 4445.55,-6681.05 4435.02,-6682.23 4438.06,-6688.54"/>
<text text-anchor="middle" x="4205.5" y="-6743.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu9 -->
<g id="node554" class="node">
<title>l2_attn_stage13_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2955" cy="-6663.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2955" y="-6674.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="2955" y="-6659.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2955" y="-6644.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu9&#45;&gt;l2_attn_stage13_gpu9 -->
<g id="edge522" class="edge">
<title>l2_attn_stage12_gpu9&#45;&gt;l2_attn_stage13_gpu9</title>
<path fill="none" stroke="black" d="M2955,-6772.74C2955,-6754.02 2955,-6731.03 2955,-6711.05"/>
<polygon fill="black" stroke="black" points="2958.5,-6710.91 2955,-6700.91 2951.5,-6710.91 2958.5,-6710.91"/>
</g>
<!-- l2_attn_stage12_gpu9&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge1690" class="edge">
<title>l2_attn_stage12_gpu9&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3011.98,-6780.18C3026.9,-6773.88 3043.24,-6768.13 3059,-6764.83 3123.28,-6751.37 4179.05,-6776.63 4241,-6754.83 4251.15,-6751.26 4250.15,-6744.15 4260,-6739.83 4280.61,-6730.79 4288.31,-6737.84 4310,-6731.83 4353.28,-6719.84 4400.59,-6700.2 4433.94,-6685.19"/>
<polygon fill="red" stroke="red" points="4435.74,-6688.22 4443.4,-6680.9 4432.84,-6681.85 4435.74,-6688.22"/>
<text text-anchor="middle" x="4291.5" y="-6743.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu10 -->
<g id="node555" class="node">
<title>l2_attn_stage13_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3163" cy="-6663.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3163" y="-6674.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="3163" y="-6659.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3163" y="-6644.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu10&#45;&gt;l2_attn_stage13_gpu10 -->
<g id="edge523" class="edge">
<title>l2_attn_stage12_gpu10&#45;&gt;l2_attn_stage13_gpu10</title>
<path fill="none" stroke="black" d="M3163,-6772.74C3163,-6754.02 3163,-6731.03 3163,-6711.05"/>
<polygon fill="black" stroke="black" points="3166.5,-6710.91 3163,-6700.91 3159.5,-6710.91 3166.5,-6710.91"/>
</g>
<!-- l2_attn_stage12_gpu10&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge1691" class="edge">
<title>l2_attn_stage12_gpu10&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3219.98,-6780.19C3234.91,-6773.89 3251.24,-6768.14 3267,-6764.83 3324.64,-6752.74 4271.46,-6774.41 4327,-6754.83 4337.15,-6751.26 4337.08,-6745.85 4346,-6739.83 4375.36,-6720.01 4410.2,-6700.22 4436.72,-6685.88"/>
<polygon fill="red" stroke="red" points="4438.57,-6688.86 4445.73,-6681.05 4435.26,-6682.69 4438.57,-6688.86"/>
<text text-anchor="middle" x="4377.5" y="-6743.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu11 -->
<g id="node556" class="node">
<title>l2_attn_stage13_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3371" cy="-6663.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3371" y="-6674.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="3371" y="-6659.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3371" y="-6644.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu11&#45;&gt;l2_attn_stage13_gpu11 -->
<g id="edge524" class="edge">
<title>l2_attn_stage12_gpu11&#45;&gt;l2_attn_stage13_gpu11</title>
<path fill="none" stroke="black" d="M3371,-6772.74C3371,-6754.02 3371,-6731.03 3371,-6711.05"/>
<polygon fill="black" stroke="black" points="3374.5,-6710.91 3371,-6700.91 3367.5,-6710.91 3374.5,-6710.91"/>
</g>
<!-- l2_attn_stage12_gpu11&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge1692" class="edge">
<title>l2_attn_stage12_gpu11&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3427.98,-6780.2C3442.91,-6773.91 3459.24,-6768.15 3475,-6764.83 3500.5,-6759.46 4389.88,-6766.85 4413,-6754.83 4426.7,-6747.71 4448.58,-6714.29 4463.12,-6690.13"/>
<polygon fill="red" stroke="red" points="4466.21,-6691.79 4468.3,-6681.4 4460.19,-6688.22 4466.21,-6691.79"/>
<text text-anchor="middle" x="4459.5" y="-6743.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu12 -->
<g id="node557" class="node">
<title>l2_attn_stage13_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3579" cy="-6663.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3579" y="-6674.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="3579" y="-6659.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3579" y="-6644.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu12&#45;&gt;l2_attn_stage13_gpu12 -->
<g id="edge525" class="edge">
<title>l2_attn_stage12_gpu12&#45;&gt;l2_attn_stage13_gpu12</title>
<path fill="none" stroke="black" d="M3516.19,-6782.01C3502.64,-6776.24 3488.37,-6770.26 3475,-6764.83 3463.53,-6760.17 3456.01,-6765.04 3449,-6754.83 3445.23,-6749.34 3445.04,-6745.19 3449,-6739.83 3456.18,-6730.11 3464.05,-6736.95 3475,-6731.83 3492.44,-6723.68 3510.39,-6712.99 3526.36,-6702.52"/>
<polygon fill="black" stroke="black" points="3528.64,-6705.21 3535.02,-6696.75 3524.76,-6699.39 3528.64,-6705.21"/>
</g>
<!-- l2_attn_stage12_gpu12&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge1693" class="edge">
<title>l2_attn_stage12_gpu12&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3635.99,-6780.22C3650.91,-6773.92 3667.24,-6768.16 3683,-6764.83 3705.18,-6760.14 4483.07,-6770.96 4499,-6754.83 4515.71,-6737.92 4506.21,-6710.47 4495.15,-6690.23"/>
<polygon fill="red" stroke="red" points="4498.11,-6688.37 4490.04,-6681.51 4492.07,-6691.9 4498.11,-6688.37"/>
<text text-anchor="middle" x="4537.5" y="-6743.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu13 -->
<g id="node558" class="node">
<title>l2_attn_stage13_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3787" cy="-6663.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3787" y="-6674.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="3787" y="-6659.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3787" y="-6644.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu13&#45;&gt;l2_attn_stage13_gpu13 -->
<g id="edge526" class="edge">
<title>l2_attn_stage12_gpu13&#45;&gt;l2_attn_stage13_gpu13</title>
<path fill="none" stroke="black" d="M3729.39,-6780.33C3714.62,-6774.12 3698.51,-6768.37 3683,-6764.83 3658.39,-6759.22 3473.45,-6773.07 3456,-6754.83 3451.39,-6750.02 3451.37,-6744.63 3456,-6739.83 3464.76,-6730.75 3670.97,-6735.63 3683,-6731.83 3702.58,-6725.66 3722,-6714.72 3738.67,-6703.41"/>
<polygon fill="black" stroke="black" points="3740.94,-6706.1 3747.13,-6697.49 3736.93,-6700.36 3740.94,-6706.1"/>
</g>
<!-- l2_attn_stage12_gpu13&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge1694" class="edge">
<title>l2_attn_stage12_gpu13&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3843.99,-6780.24C3858.92,-6773.95 3875.25,-6768.18 3891,-6764.83 3909.86,-6760.82 4571.47,-6768.56 4585,-6754.83 4610.62,-6728.84 4569.49,-6702.25 4531.04,-6684.67"/>
<polygon fill="red" stroke="red" points="4532.44,-6681.46 4521.88,-6680.62 4529.61,-6687.87 4532.44,-6681.46"/>
<text text-anchor="middle" x="4623.5" y="-6743.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu14 -->
<g id="node559" class="node">
<title>l2_attn_stage13_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3995" cy="-6663.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3995" y="-6674.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="3995" y="-6659.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3995" y="-6644.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu14&#45;&gt;l2_attn_stage13_gpu14 -->
<g id="edge527" class="edge">
<title>l2_attn_stage12_gpu14&#45;&gt;l2_attn_stage13_gpu14</title>
<path fill="none" stroke="black" d="M3937.71,-6780.23C3922.86,-6773.97 3906.64,-6768.23 3891,-6764.83 3867.76,-6759.78 3479.62,-6771.85 3463,-6754.83 3458.34,-6750.06 3458.33,-6744.59 3463,-6739.83 3471.33,-6731.35 3879.63,-6735.31 3891,-6731.83 3910.63,-6725.82 3930.07,-6714.92 3946.73,-6703.61"/>
<polygon fill="black" stroke="black" points="3949.01,-6706.29 3955.18,-6697.68 3944.99,-6700.56 3949.01,-6706.29"/>
</g>
<!-- l2_attn_stage12_gpu14&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge1695" class="edge">
<title>l2_attn_stage12_gpu14&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4052,-6780.28C4066.92,-6773.98 4083.25,-6768.2 4099,-6764.83 4114.54,-6761.51 4659.86,-6766.17 4671,-6754.83 4707.88,-6717.3 4644.24,-6693.54 4580.37,-6679.83"/>
<polygon fill="red" stroke="red" points="4581.05,-6676.4 4570.55,-6677.8 4579.63,-6683.25 4581.05,-6676.4"/>
<text text-anchor="middle" x="4710.5" y="-6743.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage13_gpu15 -->
<g id="node560" class="node">
<title>l2_attn_stage13_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4203" cy="-6663.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4203" y="-6674.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage13</text>
<text text-anchor="middle" x="4203" y="-6659.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4203" y="-6644.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage12_gpu15&#45;&gt;l2_attn_stage13_gpu15 -->
<g id="edge528" class="edge">
<title>l2_attn_stage12_gpu15&#45;&gt;l2_attn_stage13_gpu15</title>
<path fill="none" stroke="black" d="M4146,-6780.26C4131.08,-6773.96 4114.75,-6768.19 4099,-6764.83 4081.91,-6761.19 3482.26,-6767.29 3470,-6754.83 3465.32,-6750.08 3465.32,-6744.58 3470,-6739.83 3482.28,-6727.4 4082.28,-6736.9 4099,-6731.83 4118.65,-6725.88 4138.09,-6714.99 4154.75,-6703.67"/>
<polygon fill="black" stroke="black" points="4157.03,-6706.35 4163.2,-6697.74 4153.01,-6700.63 4157.03,-6706.35"/>
</g>
<!-- l2_attn_stage12_gpu15&#45;&gt;l2_attn_stage13_gpu[next_gpu] -->
<g id="edge1696" class="edge">
<title>l2_attn_stage12_gpu15&#45;&gt;l2_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4262.56,-6780.91C4278.88,-6774.39 4296.81,-6768.35 4314,-6764.83 4338.12,-6759.89 4739.79,-6772.43 4757,-6754.83 4806.67,-6704.03 4719.33,-6681.72 4629.57,-6671.94"/>
<polygon fill="red" stroke="red" points="4629.78,-6668.44 4619.47,-6670.89 4629.05,-6675.4 4629.78,-6668.44"/>
<text text-anchor="middle" x="4796.5" y="-6743.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu0 -->
<g id="node561" class="node">
<title>l2_attn_stage14_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1083" cy="-6516.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1083" y="-6527.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="1083" y="-6512.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1083" y="-6497.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu0&#45;&gt;l2_attn_stage14_gpu0 -->
<g id="edge529" class="edge">
<title>l2_attn_stage13_gpu0&#45;&gt;l2_attn_stage14_gpu0</title>
<path fill="none" stroke="black" d="M1083,-6625.74C1083,-6607.02 1083,-6584.03 1083,-6564.05"/>
<polygon fill="black" stroke="black" points="1086.5,-6563.91 1083,-6553.91 1079.5,-6563.91 1086.5,-6563.91"/>
</g>
<!-- l2_attn_stage14_gpu[next_gpu] -->
<g id="node1341" class="node">
<title>l2_attn_stage14_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4478" cy="-6516.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4478" y="-6512.63" font-family="Times,serif" font-size="14.00">l2_attn_stage14_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage13_gpu0&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge1697" class="edge">
<title>l2_attn_stage13_gpu0&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1139.98,-6633.2C1154.91,-6626.91 1171.24,-6621.15 1187,-6617.83 1436.97,-6565.18 3230.55,-6595.46 3486,-6592.83 3531.78,-6592.36 4265.1,-6593.74 4310,-6584.83 4355.32,-6575.84 4403.98,-6554.92 4437.21,-6538.73"/>
<polygon fill="red" stroke="red" points="4439.17,-6541.67 4446.58,-6534.1 4436.06,-6535.4 4439.17,-6541.67"/>
<text text-anchor="middle" x="3517.5" y="-6596.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu1 -->
<g id="node562" class="node">
<title>l2_attn_stage14_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1291" cy="-6516.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1291" y="-6527.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="1291" y="-6512.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1291" y="-6497.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu1&#45;&gt;l2_attn_stage14_gpu1 -->
<g id="edge530" class="edge">
<title>l2_attn_stage13_gpu1&#45;&gt;l2_attn_stage14_gpu1</title>
<path fill="none" stroke="black" d="M1291,-6625.74C1291,-6607.02 1291,-6584.03 1291,-6564.05"/>
<polygon fill="black" stroke="black" points="1294.5,-6563.91 1291,-6553.91 1287.5,-6563.91 1294.5,-6563.91"/>
</g>
<!-- l2_attn_stage13_gpu1&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge1698" class="edge">
<title>l2_attn_stage13_gpu1&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1347.97,-6633.14C1362.89,-6626.84 1379.23,-6621.1 1395,-6617.83 1453.7,-6605.66 3496.42,-6627.62 3553,-6607.83 3563.16,-6604.28 3561.86,-6596.42 3572,-6592.83 3610.66,-6579.17 4269.79,-6592.83 4310,-6584.83 4355.31,-6575.81 4403.98,-6554.9 4437.21,-6538.72"/>
<polygon fill="red" stroke="red" points="4439.17,-6541.66 4446.58,-6534.08 4436.06,-6535.38 4439.17,-6541.66"/>
<text text-anchor="middle" x="3603.5" y="-6596.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu2 -->
<g id="node563" class="node">
<title>l2_attn_stage14_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1499" cy="-6516.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1499" y="-6527.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="1499" y="-6512.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1499" y="-6497.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu2&#45;&gt;l2_attn_stage14_gpu2 -->
<g id="edge531" class="edge">
<title>l2_attn_stage13_gpu2&#45;&gt;l2_attn_stage14_gpu2</title>
<path fill="none" stroke="black" d="M1499,-6625.74C1499,-6607.02 1499,-6584.03 1499,-6564.05"/>
<polygon fill="black" stroke="black" points="1502.5,-6563.91 1499,-6553.91 1495.5,-6563.91 1502.5,-6563.91"/>
</g>
<!-- l2_attn_stage13_gpu2&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge1699" class="edge">
<title>l2_attn_stage13_gpu2&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1555.97,-6633.14C1570.89,-6626.85 1587.23,-6621.1 1603,-6617.83 1658.38,-6606.34 3585.62,-6626.51 3639,-6607.83 3649.16,-6604.28 3647.86,-6596.42 3658,-6592.83 3692.15,-6580.74 4274.48,-6591.93 4310,-6584.83 4355.31,-6575.78 4403.97,-6554.87 4437.2,-6538.7"/>
<polygon fill="red" stroke="red" points="4439.16,-6541.64 4446.57,-6534.07 4436.06,-6535.36 4439.16,-6541.64"/>
<text text-anchor="middle" x="3689.5" y="-6596.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu3 -->
<g id="node564" class="node">
<title>l2_attn_stage14_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1707" cy="-6516.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1707" y="-6527.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="1707" y="-6512.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1707" y="-6497.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu3&#45;&gt;l2_attn_stage14_gpu3 -->
<g id="edge532" class="edge">
<title>l2_attn_stage13_gpu3&#45;&gt;l2_attn_stage14_gpu3</title>
<path fill="none" stroke="black" d="M1707,-6625.74C1707,-6607.02 1707,-6584.03 1707,-6564.05"/>
<polygon fill="black" stroke="black" points="1710.5,-6563.91 1707,-6553.91 1703.5,-6563.91 1710.5,-6563.91"/>
</g>
<!-- l2_attn_stage13_gpu3&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge1700" class="edge">
<title>l2_attn_stage13_gpu3&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1763.97,-6633.14C1778.9,-6626.85 1795.23,-6621.11 1811,-6617.83 1863.06,-6607.02 3674.82,-6625.4 3725,-6607.83 3735.15,-6604.28 3733.86,-6596.43 3744,-6592.83 3773.63,-6582.31 4279.17,-6591.02 4310,-6584.83 4355.3,-6575.74 4403.97,-6554.83 4437.2,-6538.68"/>
<polygon fill="red" stroke="red" points="4439.15,-6541.62 4446.57,-6534.05 4436.05,-6535.34 4439.15,-6541.62"/>
<text text-anchor="middle" x="3775.5" y="-6596.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu4 -->
<g id="node565" class="node">
<title>l2_attn_stage14_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1915" cy="-6516.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1915" y="-6527.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="1915" y="-6512.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1915" y="-6497.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu4&#45;&gt;l2_attn_stage14_gpu4 -->
<g id="edge533" class="edge">
<title>l2_attn_stage13_gpu4&#45;&gt;l2_attn_stage14_gpu4</title>
<path fill="none" stroke="black" d="M1915,-6625.74C1915,-6607.02 1915,-6584.03 1915,-6564.05"/>
<polygon fill="black" stroke="black" points="1918.5,-6563.91 1915,-6553.91 1911.5,-6563.91 1918.5,-6563.91"/>
</g>
<!-- l2_attn_stage13_gpu4&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge1701" class="edge">
<title>l2_attn_stage13_gpu4&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1971.97,-6633.15C1986.9,-6626.85 2003.23,-6621.11 2019,-6617.83 2067.74,-6607.7 3764.02,-6624.29 3811,-6607.83 3821.15,-6604.27 3819.87,-6596.44 3830,-6592.83 3880.24,-6574.92 4257.72,-6595.4 4310,-6584.83 4355.29,-6575.68 4403.96,-6554.79 4437.19,-6538.65"/>
<polygon fill="red" stroke="red" points="4439.14,-6541.59 4446.56,-6534.03 4436.05,-6535.31 4439.14,-6541.59"/>
<text text-anchor="middle" x="3861.5" y="-6596.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu5 -->
<g id="node566" class="node">
<title>l2_attn_stage14_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2123" cy="-6516.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2123" y="-6527.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="2123" y="-6512.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2123" y="-6497.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu5&#45;&gt;l2_attn_stage14_gpu5 -->
<g id="edge534" class="edge">
<title>l2_attn_stage13_gpu5&#45;&gt;l2_attn_stage14_gpu5</title>
<path fill="none" stroke="black" d="M2123,-6625.74C2123,-6607.02 2123,-6584.03 2123,-6564.05"/>
<polygon fill="black" stroke="black" points="2126.5,-6563.91 2123,-6553.91 2119.5,-6563.91 2126.5,-6563.91"/>
</g>
<!-- l2_attn_stage13_gpu5&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge1702" class="edge">
<title>l2_attn_stage13_gpu5&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2179.97,-6633.15C2194.9,-6626.86 2211.23,-6621.11 2227,-6617.83 2272.42,-6608.38 3853.22,-6623.18 3897,-6607.83 3907.15,-6604.27 3905.87,-6596.46 3916,-6592.83 3957.22,-6578.05 4267.1,-6593.58 4310,-6584.83 4355.27,-6575.6 4403.94,-6554.72 4437.18,-6538.6"/>
<polygon fill="red" stroke="red" points="4439.13,-6541.55 4446.56,-6533.99 4436.04,-6535.27 4439.13,-6541.55"/>
<text text-anchor="middle" x="3947.5" y="-6596.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu6 -->
<g id="node567" class="node">
<title>l2_attn_stage14_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2331" cy="-6516.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2331" y="-6527.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="2331" y="-6512.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2331" y="-6497.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu6&#45;&gt;l2_attn_stage14_gpu6 -->
<g id="edge535" class="edge">
<title>l2_attn_stage13_gpu6&#45;&gt;l2_attn_stage14_gpu6</title>
<path fill="none" stroke="black" d="M2331,-6625.74C2331,-6607.02 2331,-6584.03 2331,-6564.05"/>
<polygon fill="black" stroke="black" points="2334.5,-6563.91 2331,-6553.91 2327.5,-6563.91 2334.5,-6563.91"/>
</g>
<!-- l2_attn_stage13_gpu6&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge1703" class="edge">
<title>l2_attn_stage13_gpu6&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2387.97,-6633.16C2402.9,-6626.86 2419.23,-6621.12 2435,-6617.83 2477.1,-6609.06 3942.42,-6622.07 3983,-6607.83 3993.15,-6604.27 3991.88,-6596.49 4002,-6592.83 4034.19,-6581.19 4276.48,-6591.77 4310,-6584.83 4355.11,-6575.5 4403.62,-6554.74 4436.86,-6538.68"/>
<polygon fill="red" stroke="red" points="4438.8,-6541.63 4446.24,-6534.08 4435.72,-6535.34 4438.8,-6541.63"/>
<text text-anchor="middle" x="4033.5" y="-6596.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu7 -->
<g id="node568" class="node">
<title>l2_attn_stage14_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2539" cy="-6516.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2539" y="-6527.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="2539" y="-6512.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2539" y="-6497.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu7&#45;&gt;l2_attn_stage14_gpu7 -->
<g id="edge536" class="edge">
<title>l2_attn_stage13_gpu7&#45;&gt;l2_attn_stage14_gpu7</title>
<path fill="none" stroke="black" d="M2539,-6625.74C2539,-6607.02 2539,-6584.03 2539,-6564.05"/>
<polygon fill="black" stroke="black" points="2542.5,-6563.91 2539,-6553.91 2535.5,-6563.91 2542.5,-6563.91"/>
</g>
<!-- l2_attn_stage13_gpu7&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge1704" class="edge">
<title>l2_attn_stage13_gpu7&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2595.98,-6633.16C2610.9,-6626.87 2627.24,-6621.12 2643,-6617.83 2681.78,-6609.74 4031.62,-6620.95 4069,-6607.83 4079.15,-6604.27 4077.9,-6596.54 4088,-6592.83 4134.34,-6575.8 4261.71,-6595.08 4310,-6584.83 4355.06,-6575.27 4403.58,-6554.54 4436.83,-6538.56"/>
<polygon fill="red" stroke="red" points="4438.76,-6541.51 4446.22,-6533.98 4435.69,-6535.22 4438.76,-6541.51"/>
<text text-anchor="middle" x="4119.5" y="-6596.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu8 -->
<g id="node569" class="node">
<title>l2_attn_stage14_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2747" cy="-6516.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2747" y="-6527.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="2747" y="-6512.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2747" y="-6497.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu8&#45;&gt;l2_attn_stage14_gpu8 -->
<g id="edge537" class="edge">
<title>l2_attn_stage13_gpu8&#45;&gt;l2_attn_stage14_gpu8</title>
<path fill="none" stroke="black" d="M2747,-6625.74C2747,-6607.02 2747,-6584.03 2747,-6564.05"/>
<polygon fill="black" stroke="black" points="2750.5,-6563.91 2747,-6553.91 2743.5,-6563.91 2750.5,-6563.91"/>
</g>
<!-- l2_attn_stage13_gpu8&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge1705" class="edge">
<title>l2_attn_stage13_gpu8&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2803.98,-6633.17C2818.9,-6626.88 2835.24,-6621.13 2851,-6617.83 2921.91,-6603.01 4086.65,-6631.85 4155,-6607.83 4165.15,-6604.26 4163.94,-6596.66 4174,-6592.83 4202.3,-6582.07 4280.46,-6591.45 4310,-6584.83 4354.67,-6574.82 4402.88,-6554.36 4436.15,-6538.57"/>
<polygon fill="red" stroke="red" points="4438.06,-6541.54 4445.55,-6534.05 4435.02,-6535.23 4438.06,-6541.54"/>
<text text-anchor="middle" x="4205.5" y="-6596.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu9 -->
<g id="node570" class="node">
<title>l2_attn_stage14_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2955" cy="-6516.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2955" y="-6527.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="2955" y="-6512.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2955" y="-6497.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu9&#45;&gt;l2_attn_stage14_gpu9 -->
<g id="edge538" class="edge">
<title>l2_attn_stage13_gpu9&#45;&gt;l2_attn_stage14_gpu9</title>
<path fill="none" stroke="black" d="M2955,-6625.74C2955,-6607.02 2955,-6584.03 2955,-6564.05"/>
<polygon fill="black" stroke="black" points="2958.5,-6563.91 2955,-6553.91 2951.5,-6563.91 2958.5,-6563.91"/>
</g>
<!-- l2_attn_stage13_gpu9&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge1706" class="edge">
<title>l2_attn_stage13_gpu9&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3011.98,-6633.18C3026.9,-6626.88 3043.24,-6621.13 3059,-6617.83 3123.28,-6604.37 4179.05,-6629.63 4241,-6607.83 4251.15,-6604.26 4250.15,-6597.15 4260,-6592.83 4280.61,-6583.79 4288.31,-6590.84 4310,-6584.83 4353.28,-6572.84 4400.59,-6553.2 4433.94,-6538.19"/>
<polygon fill="red" stroke="red" points="4435.74,-6541.22 4443.4,-6533.9 4432.84,-6534.85 4435.74,-6541.22"/>
<text text-anchor="middle" x="4291.5" y="-6596.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu10 -->
<g id="node571" class="node">
<title>l2_attn_stage14_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3163" cy="-6516.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3163" y="-6527.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="3163" y="-6512.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3163" y="-6497.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu10&#45;&gt;l2_attn_stage14_gpu10 -->
<g id="edge539" class="edge">
<title>l2_attn_stage13_gpu10&#45;&gt;l2_attn_stage14_gpu10</title>
<path fill="none" stroke="black" d="M3163,-6625.74C3163,-6607.02 3163,-6584.03 3163,-6564.05"/>
<polygon fill="black" stroke="black" points="3166.5,-6563.91 3163,-6553.91 3159.5,-6563.91 3166.5,-6563.91"/>
</g>
<!-- l2_attn_stage13_gpu10&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge1707" class="edge">
<title>l2_attn_stage13_gpu10&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3219.98,-6633.19C3234.91,-6626.89 3251.24,-6621.14 3267,-6617.83 3324.64,-6605.74 4271.46,-6627.41 4327,-6607.83 4337.15,-6604.26 4337.08,-6598.85 4346,-6592.83 4375.36,-6573.01 4410.2,-6553.22 4436.72,-6538.88"/>
<polygon fill="red" stroke="red" points="4438.57,-6541.86 4445.73,-6534.05 4435.26,-6535.69 4438.57,-6541.86"/>
<text text-anchor="middle" x="4377.5" y="-6596.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu11 -->
<g id="node572" class="node">
<title>l2_attn_stage14_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3371" cy="-6516.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3371" y="-6527.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="3371" y="-6512.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3371" y="-6497.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu11&#45;&gt;l2_attn_stage14_gpu11 -->
<g id="edge540" class="edge">
<title>l2_attn_stage13_gpu11&#45;&gt;l2_attn_stage14_gpu11</title>
<path fill="none" stroke="black" d="M3371,-6625.74C3371,-6607.02 3371,-6584.03 3371,-6564.05"/>
<polygon fill="black" stroke="black" points="3374.5,-6563.91 3371,-6553.91 3367.5,-6563.91 3374.5,-6563.91"/>
</g>
<!-- l2_attn_stage13_gpu11&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge1708" class="edge">
<title>l2_attn_stage13_gpu11&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3427.98,-6633.2C3442.91,-6626.91 3459.24,-6621.15 3475,-6617.83 3500.5,-6612.46 4389.88,-6619.85 4413,-6607.83 4426.7,-6600.71 4448.58,-6567.29 4463.12,-6543.13"/>
<polygon fill="red" stroke="red" points="4466.21,-6544.79 4468.3,-6534.4 4460.19,-6541.22 4466.21,-6544.79"/>
<text text-anchor="middle" x="4459.5" y="-6596.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu12 -->
<g id="node573" class="node">
<title>l2_attn_stage14_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3579" cy="-6516.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3579" y="-6527.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="3579" y="-6512.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3579" y="-6497.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu12&#45;&gt;l2_attn_stage14_gpu12 -->
<g id="edge541" class="edge">
<title>l2_attn_stage13_gpu12&#45;&gt;l2_attn_stage14_gpu12</title>
<path fill="none" stroke="black" d="M3516.19,-6635.01C3502.64,-6629.24 3488.37,-6623.26 3475,-6617.83 3463.53,-6613.17 3456.01,-6618.04 3449,-6607.83 3445.23,-6602.34 3445.04,-6598.19 3449,-6592.83 3456.18,-6583.11 3464.05,-6589.95 3475,-6584.83 3492.44,-6576.68 3510.39,-6565.99 3526.36,-6555.52"/>
<polygon fill="black" stroke="black" points="3528.64,-6558.21 3535.02,-6549.75 3524.76,-6552.39 3528.64,-6558.21"/>
</g>
<!-- l2_attn_stage13_gpu12&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge1709" class="edge">
<title>l2_attn_stage13_gpu12&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3635.99,-6633.22C3650.91,-6626.92 3667.24,-6621.16 3683,-6617.83 3705.18,-6613.14 4483.07,-6623.96 4499,-6607.83 4515.71,-6590.92 4506.21,-6563.47 4495.15,-6543.23"/>
<polygon fill="red" stroke="red" points="4498.11,-6541.37 4490.04,-6534.51 4492.07,-6544.9 4498.11,-6541.37"/>
<text text-anchor="middle" x="4537.5" y="-6596.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu13 -->
<g id="node574" class="node">
<title>l2_attn_stage14_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3787" cy="-6516.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3787" y="-6527.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="3787" y="-6512.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3787" y="-6497.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu13&#45;&gt;l2_attn_stage14_gpu13 -->
<g id="edge542" class="edge">
<title>l2_attn_stage13_gpu13&#45;&gt;l2_attn_stage14_gpu13</title>
<path fill="none" stroke="black" d="M3729.39,-6633.33C3714.62,-6627.12 3698.51,-6621.37 3683,-6617.83 3658.39,-6612.22 3473.45,-6626.07 3456,-6607.83 3451.39,-6603.02 3451.37,-6597.63 3456,-6592.83 3464.76,-6583.75 3670.97,-6588.63 3683,-6584.83 3702.58,-6578.66 3722,-6567.72 3738.67,-6556.41"/>
<polygon fill="black" stroke="black" points="3740.94,-6559.1 3747.13,-6550.49 3736.93,-6553.36 3740.94,-6559.1"/>
</g>
<!-- l2_attn_stage13_gpu13&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge1710" class="edge">
<title>l2_attn_stage13_gpu13&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3843.99,-6633.24C3858.92,-6626.95 3875.25,-6621.18 3891,-6617.83 3909.86,-6613.82 4571.47,-6621.56 4585,-6607.83 4610.62,-6581.84 4569.49,-6555.25 4531.04,-6537.67"/>
<polygon fill="red" stroke="red" points="4532.44,-6534.46 4521.88,-6533.62 4529.61,-6540.87 4532.44,-6534.46"/>
<text text-anchor="middle" x="4623.5" y="-6596.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu14 -->
<g id="node575" class="node">
<title>l2_attn_stage14_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3995" cy="-6516.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3995" y="-6527.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="3995" y="-6512.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3995" y="-6497.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu14&#45;&gt;l2_attn_stage14_gpu14 -->
<g id="edge543" class="edge">
<title>l2_attn_stage13_gpu14&#45;&gt;l2_attn_stage14_gpu14</title>
<path fill="none" stroke="black" d="M3937.71,-6633.23C3922.86,-6626.97 3906.64,-6621.23 3891,-6617.83 3867.76,-6612.78 3479.62,-6624.85 3463,-6607.83 3458.34,-6603.06 3458.33,-6597.59 3463,-6592.83 3471.33,-6584.35 3879.63,-6588.31 3891,-6584.83 3910.63,-6578.82 3930.07,-6567.92 3946.73,-6556.61"/>
<polygon fill="black" stroke="black" points="3949.01,-6559.29 3955.18,-6550.68 3944.99,-6553.56 3949.01,-6559.29"/>
</g>
<!-- l2_attn_stage13_gpu14&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge1711" class="edge">
<title>l2_attn_stage13_gpu14&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4052,-6633.28C4066.92,-6626.98 4083.25,-6621.2 4099,-6617.83 4114.54,-6614.51 4659.86,-6619.17 4671,-6607.83 4707.88,-6570.3 4644.24,-6546.54 4580.37,-6532.83"/>
<polygon fill="red" stroke="red" points="4581.05,-6529.4 4570.55,-6530.8 4579.63,-6536.25 4581.05,-6529.4"/>
<text text-anchor="middle" x="4710.5" y="-6596.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage14_gpu15 -->
<g id="node576" class="node">
<title>l2_attn_stage14_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4203" cy="-6516.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4203" y="-6527.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage14</text>
<text text-anchor="middle" x="4203" y="-6512.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4203" y="-6497.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage13_gpu15&#45;&gt;l2_attn_stage14_gpu15 -->
<g id="edge544" class="edge">
<title>l2_attn_stage13_gpu15&#45;&gt;l2_attn_stage14_gpu15</title>
<path fill="none" stroke="black" d="M4146,-6633.26C4131.08,-6626.96 4114.75,-6621.19 4099,-6617.83 4081.91,-6614.19 3482.26,-6620.29 3470,-6607.83 3465.32,-6603.08 3465.32,-6597.58 3470,-6592.83 3482.28,-6580.4 4082.28,-6589.9 4099,-6584.83 4118.65,-6578.88 4138.09,-6567.99 4154.75,-6556.67"/>
<polygon fill="black" stroke="black" points="4157.03,-6559.35 4163.2,-6550.74 4153.01,-6553.63 4157.03,-6559.35"/>
</g>
<!-- l2_attn_stage13_gpu15&#45;&gt;l2_attn_stage14_gpu[next_gpu] -->
<g id="edge1712" class="edge">
<title>l2_attn_stage13_gpu15&#45;&gt;l2_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4262.56,-6633.91C4278.88,-6627.39 4296.81,-6621.35 4314,-6617.83 4338.12,-6612.89 4739.79,-6625.43 4757,-6607.83 4806.67,-6557.03 4719.33,-6534.72 4629.57,-6524.94"/>
<polygon fill="red" stroke="red" points="4629.78,-6521.44 4619.47,-6523.89 4629.05,-6528.4 4629.78,-6521.44"/>
<text text-anchor="middle" x="4796.5" y="-6596.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu0 -->
<g id="node577" class="node">
<title>l2_attn_stage15_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1083" cy="-6369.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1083" y="-6380.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="1083" y="-6365.63" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1083" y="-6350.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu0&#45;&gt;l2_attn_stage15_gpu0 -->
<g id="edge545" class="edge">
<title>l2_attn_stage14_gpu0&#45;&gt;l2_attn_stage15_gpu0</title>
<path fill="none" stroke="black" d="M1083,-6478.74C1083,-6460.02 1083,-6437.03 1083,-6417.05"/>
<polygon fill="black" stroke="black" points="1086.5,-6416.91 1083,-6406.91 1079.5,-6416.91 1086.5,-6416.91"/>
</g>
<!-- l2_attn_stage15_gpu[next_gpu] -->
<g id="node1342" class="node">
<title>l2_attn_stage15_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4478" cy="-6369.33" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4478" y="-6365.63" font-family="Times,serif" font-size="14.00">l2_attn_stage15_gpu[next_gpu]</text>
</g>
<!-- l2_attn_stage14_gpu0&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge1713" class="edge">
<title>l2_attn_stage14_gpu0&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1139.98,-6486.2C1154.91,-6479.91 1171.24,-6474.15 1187,-6470.83 1436.97,-6418.18 3230.55,-6448.46 3486,-6445.83 3531.78,-6445.36 4265.1,-6446.74 4310,-6437.83 4355.32,-6428.84 4403.98,-6407.92 4437.21,-6391.73"/>
<polygon fill="red" stroke="red" points="4439.17,-6394.67 4446.58,-6387.1 4436.06,-6388.4 4439.17,-6394.67"/>
<text text-anchor="middle" x="3517.5" y="-6449.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu1 -->
<g id="node578" class="node">
<title>l2_attn_stage15_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1291" cy="-6369.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1291" y="-6380.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="1291" y="-6365.63" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1291" y="-6350.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu1&#45;&gt;l2_attn_stage15_gpu1 -->
<g id="edge546" class="edge">
<title>l2_attn_stage14_gpu1&#45;&gt;l2_attn_stage15_gpu1</title>
<path fill="none" stroke="black" d="M1291,-6478.74C1291,-6460.02 1291,-6437.03 1291,-6417.05"/>
<polygon fill="black" stroke="black" points="1294.5,-6416.91 1291,-6406.91 1287.5,-6416.91 1294.5,-6416.91"/>
</g>
<!-- l2_attn_stage14_gpu1&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge1714" class="edge">
<title>l2_attn_stage14_gpu1&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1347.97,-6486.14C1362.89,-6479.84 1379.23,-6474.1 1395,-6470.83 1453.7,-6458.66 3496.42,-6480.62 3553,-6460.83 3563.16,-6457.28 3561.86,-6449.42 3572,-6445.83 3610.66,-6432.17 4269.79,-6445.83 4310,-6437.83 4355.31,-6428.81 4403.98,-6407.9 4437.21,-6391.72"/>
<polygon fill="red" stroke="red" points="4439.17,-6394.66 4446.58,-6387.08 4436.06,-6388.38 4439.17,-6394.66"/>
<text text-anchor="middle" x="3603.5" y="-6449.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu2 -->
<g id="node579" class="node">
<title>l2_attn_stage15_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1499" cy="-6369.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1499" y="-6380.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="1499" y="-6365.63" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1499" y="-6350.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu2&#45;&gt;l2_attn_stage15_gpu2 -->
<g id="edge547" class="edge">
<title>l2_attn_stage14_gpu2&#45;&gt;l2_attn_stage15_gpu2</title>
<path fill="none" stroke="black" d="M1499,-6478.74C1499,-6460.02 1499,-6437.03 1499,-6417.05"/>
<polygon fill="black" stroke="black" points="1502.5,-6416.91 1499,-6406.91 1495.5,-6416.91 1502.5,-6416.91"/>
</g>
<!-- l2_attn_stage14_gpu2&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge1715" class="edge">
<title>l2_attn_stage14_gpu2&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1555.97,-6486.14C1570.89,-6479.85 1587.23,-6474.1 1603,-6470.83 1658.38,-6459.34 3585.62,-6479.51 3639,-6460.83 3649.16,-6457.28 3647.86,-6449.42 3658,-6445.83 3692.15,-6433.74 4274.48,-6444.93 4310,-6437.83 4355.31,-6428.78 4403.97,-6407.87 4437.2,-6391.7"/>
<polygon fill="red" stroke="red" points="4439.16,-6394.64 4446.57,-6387.07 4436.06,-6388.36 4439.16,-6394.64"/>
<text text-anchor="middle" x="3689.5" y="-6449.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu3 -->
<g id="node580" class="node">
<title>l2_attn_stage15_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1707" cy="-6369.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1707" y="-6380.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="1707" y="-6365.63" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1707" y="-6350.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu3&#45;&gt;l2_attn_stage15_gpu3 -->
<g id="edge548" class="edge">
<title>l2_attn_stage14_gpu3&#45;&gt;l2_attn_stage15_gpu3</title>
<path fill="none" stroke="black" d="M1707,-6478.74C1707,-6460.02 1707,-6437.03 1707,-6417.05"/>
<polygon fill="black" stroke="black" points="1710.5,-6416.91 1707,-6406.91 1703.5,-6416.91 1710.5,-6416.91"/>
</g>
<!-- l2_attn_stage14_gpu3&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge1716" class="edge">
<title>l2_attn_stage14_gpu3&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1763.97,-6486.14C1778.9,-6479.85 1795.23,-6474.11 1811,-6470.83 1863.06,-6460.02 3674.82,-6478.4 3725,-6460.83 3735.15,-6457.28 3733.86,-6449.43 3744,-6445.83 3773.63,-6435.31 4279.17,-6444.02 4310,-6437.83 4355.3,-6428.74 4403.97,-6407.83 4437.2,-6391.68"/>
<polygon fill="red" stroke="red" points="4439.15,-6394.62 4446.57,-6387.05 4436.05,-6388.34 4439.15,-6394.62"/>
<text text-anchor="middle" x="3775.5" y="-6449.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu4 -->
<g id="node581" class="node">
<title>l2_attn_stage15_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1915" cy="-6369.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1915" y="-6380.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="1915" y="-6365.63" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1915" y="-6350.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu4&#45;&gt;l2_attn_stage15_gpu4 -->
<g id="edge549" class="edge">
<title>l2_attn_stage14_gpu4&#45;&gt;l2_attn_stage15_gpu4</title>
<path fill="none" stroke="black" d="M1915,-6478.74C1915,-6460.02 1915,-6437.03 1915,-6417.05"/>
<polygon fill="black" stroke="black" points="1918.5,-6416.91 1915,-6406.91 1911.5,-6416.91 1918.5,-6416.91"/>
</g>
<!-- l2_attn_stage14_gpu4&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge1717" class="edge">
<title>l2_attn_stage14_gpu4&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1971.97,-6486.15C1986.9,-6479.85 2003.23,-6474.11 2019,-6470.83 2067.74,-6460.7 3764.02,-6477.29 3811,-6460.83 3821.15,-6457.27 3819.87,-6449.44 3830,-6445.83 3880.24,-6427.92 4257.72,-6448.4 4310,-6437.83 4355.29,-6428.68 4403.96,-6407.79 4437.19,-6391.65"/>
<polygon fill="red" stroke="red" points="4439.14,-6394.59 4446.56,-6387.03 4436.05,-6388.31 4439.14,-6394.59"/>
<text text-anchor="middle" x="3861.5" y="-6449.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu5 -->
<g id="node582" class="node">
<title>l2_attn_stage15_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2123" cy="-6369.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2123" y="-6380.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="2123" y="-6365.63" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2123" y="-6350.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu5&#45;&gt;l2_attn_stage15_gpu5 -->
<g id="edge550" class="edge">
<title>l2_attn_stage14_gpu5&#45;&gt;l2_attn_stage15_gpu5</title>
<path fill="none" stroke="black" d="M2123,-6478.74C2123,-6460.02 2123,-6437.03 2123,-6417.05"/>
<polygon fill="black" stroke="black" points="2126.5,-6416.91 2123,-6406.91 2119.5,-6416.91 2126.5,-6416.91"/>
</g>
<!-- l2_attn_stage14_gpu5&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge1718" class="edge">
<title>l2_attn_stage14_gpu5&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2179.97,-6486.15C2194.9,-6479.86 2211.23,-6474.11 2227,-6470.83 2272.42,-6461.38 3853.22,-6476.18 3897,-6460.83 3907.15,-6457.27 3905.87,-6449.46 3916,-6445.83 3957.22,-6431.05 4267.1,-6446.58 4310,-6437.83 4355.27,-6428.6 4403.94,-6407.72 4437.18,-6391.6"/>
<polygon fill="red" stroke="red" points="4439.13,-6394.55 4446.56,-6386.99 4436.04,-6388.27 4439.13,-6394.55"/>
<text text-anchor="middle" x="3947.5" y="-6449.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu6 -->
<g id="node583" class="node">
<title>l2_attn_stage15_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2331" cy="-6369.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2331" y="-6380.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="2331" y="-6365.63" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2331" y="-6350.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu6&#45;&gt;l2_attn_stage15_gpu6 -->
<g id="edge551" class="edge">
<title>l2_attn_stage14_gpu6&#45;&gt;l2_attn_stage15_gpu6</title>
<path fill="none" stroke="black" d="M2331,-6478.74C2331,-6460.02 2331,-6437.03 2331,-6417.05"/>
<polygon fill="black" stroke="black" points="2334.5,-6416.91 2331,-6406.91 2327.5,-6416.91 2334.5,-6416.91"/>
</g>
<!-- l2_attn_stage14_gpu6&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge1719" class="edge">
<title>l2_attn_stage14_gpu6&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2387.97,-6486.16C2402.9,-6479.86 2419.23,-6474.12 2435,-6470.83 2477.1,-6462.06 3942.42,-6475.07 3983,-6460.83 3993.15,-6457.27 3991.88,-6449.49 4002,-6445.83 4034.19,-6434.19 4276.48,-6444.77 4310,-6437.83 4355.11,-6428.5 4403.62,-6407.74 4436.86,-6391.68"/>
<polygon fill="red" stroke="red" points="4438.8,-6394.63 4446.24,-6387.08 4435.72,-6388.34 4438.8,-6394.63"/>
<text text-anchor="middle" x="4033.5" y="-6449.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu7 -->
<g id="node584" class="node">
<title>l2_attn_stage15_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2539" cy="-6369.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2539" y="-6380.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="2539" y="-6365.63" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2539" y="-6350.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu7&#45;&gt;l2_attn_stage15_gpu7 -->
<g id="edge552" class="edge">
<title>l2_attn_stage14_gpu7&#45;&gt;l2_attn_stage15_gpu7</title>
<path fill="none" stroke="black" d="M2539,-6478.74C2539,-6460.02 2539,-6437.03 2539,-6417.05"/>
<polygon fill="black" stroke="black" points="2542.5,-6416.91 2539,-6406.91 2535.5,-6416.91 2542.5,-6416.91"/>
</g>
<!-- l2_attn_stage14_gpu7&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge1720" class="edge">
<title>l2_attn_stage14_gpu7&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2595.98,-6486.16C2610.9,-6479.87 2627.24,-6474.12 2643,-6470.83 2681.78,-6462.74 4031.62,-6473.95 4069,-6460.83 4079.15,-6457.27 4077.9,-6449.54 4088,-6445.83 4134.34,-6428.8 4261.71,-6448.08 4310,-6437.83 4355.06,-6428.27 4403.58,-6407.54 4436.83,-6391.56"/>
<polygon fill="red" stroke="red" points="4438.76,-6394.51 4446.22,-6386.98 4435.69,-6388.22 4438.76,-6394.51"/>
<text text-anchor="middle" x="4119.5" y="-6449.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu8 -->
<g id="node585" class="node">
<title>l2_attn_stage15_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2747" cy="-6369.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2747" y="-6380.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="2747" y="-6365.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2747" y="-6350.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu8&#45;&gt;l2_attn_stage15_gpu8 -->
<g id="edge553" class="edge">
<title>l2_attn_stage14_gpu8&#45;&gt;l2_attn_stage15_gpu8</title>
<path fill="none" stroke="black" d="M2747,-6478.74C2747,-6460.02 2747,-6437.03 2747,-6417.05"/>
<polygon fill="black" stroke="black" points="2750.5,-6416.91 2747,-6406.91 2743.5,-6416.91 2750.5,-6416.91"/>
</g>
<!-- l2_attn_stage14_gpu8&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge1721" class="edge">
<title>l2_attn_stage14_gpu8&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2803.98,-6486.17C2818.9,-6479.88 2835.24,-6474.13 2851,-6470.83 2921.91,-6456.01 4086.65,-6484.85 4155,-6460.83 4165.15,-6457.26 4163.94,-6449.66 4174,-6445.83 4202.3,-6435.07 4280.46,-6444.45 4310,-6437.83 4354.67,-6427.82 4402.88,-6407.36 4436.15,-6391.57"/>
<polygon fill="red" stroke="red" points="4438.06,-6394.54 4445.55,-6387.05 4435.02,-6388.23 4438.06,-6394.54"/>
<text text-anchor="middle" x="4205.5" y="-6449.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu9 -->
<g id="node586" class="node">
<title>l2_attn_stage15_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2955" cy="-6369.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2955" y="-6380.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="2955" y="-6365.63" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2955" y="-6350.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu9&#45;&gt;l2_attn_stage15_gpu9 -->
<g id="edge554" class="edge">
<title>l2_attn_stage14_gpu9&#45;&gt;l2_attn_stage15_gpu9</title>
<path fill="none" stroke="black" d="M2955,-6478.74C2955,-6460.02 2955,-6437.03 2955,-6417.05"/>
<polygon fill="black" stroke="black" points="2958.5,-6416.91 2955,-6406.91 2951.5,-6416.91 2958.5,-6416.91"/>
</g>
<!-- l2_attn_stage14_gpu9&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge1722" class="edge">
<title>l2_attn_stage14_gpu9&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3011.98,-6486.18C3026.9,-6479.88 3043.24,-6474.13 3059,-6470.83 3123.28,-6457.37 4179.05,-6482.63 4241,-6460.83 4251.15,-6457.26 4250.15,-6450.15 4260,-6445.83 4280.61,-6436.79 4288.31,-6443.84 4310,-6437.83 4353.28,-6425.84 4400.59,-6406.2 4433.94,-6391.19"/>
<polygon fill="red" stroke="red" points="4435.74,-6394.22 4443.4,-6386.9 4432.84,-6387.85 4435.74,-6394.22"/>
<text text-anchor="middle" x="4291.5" y="-6449.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu10 -->
<g id="node587" class="node">
<title>l2_attn_stage15_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3163" cy="-6369.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3163" y="-6380.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="3163" y="-6365.63" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3163" y="-6350.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu10&#45;&gt;l2_attn_stage15_gpu10 -->
<g id="edge555" class="edge">
<title>l2_attn_stage14_gpu10&#45;&gt;l2_attn_stage15_gpu10</title>
<path fill="none" stroke="black" d="M3163,-6478.74C3163,-6460.02 3163,-6437.03 3163,-6417.05"/>
<polygon fill="black" stroke="black" points="3166.5,-6416.91 3163,-6406.91 3159.5,-6416.91 3166.5,-6416.91"/>
</g>
<!-- l2_attn_stage14_gpu10&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge1723" class="edge">
<title>l2_attn_stage14_gpu10&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3219.98,-6486.19C3234.91,-6479.89 3251.24,-6474.14 3267,-6470.83 3324.64,-6458.74 4271.46,-6480.41 4327,-6460.83 4337.15,-6457.26 4337.08,-6451.85 4346,-6445.83 4375.36,-6426.01 4410.2,-6406.22 4436.72,-6391.88"/>
<polygon fill="red" stroke="red" points="4438.57,-6394.86 4445.73,-6387.05 4435.26,-6388.69 4438.57,-6394.86"/>
<text text-anchor="middle" x="4377.5" y="-6449.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu11 -->
<g id="node588" class="node">
<title>l2_attn_stage15_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3371" cy="-6369.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3371" y="-6380.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="3371" y="-6365.63" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3371" y="-6350.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu11&#45;&gt;l2_attn_stage15_gpu11 -->
<g id="edge556" class="edge">
<title>l2_attn_stage14_gpu11&#45;&gt;l2_attn_stage15_gpu11</title>
<path fill="none" stroke="black" d="M3371,-6478.74C3371,-6460.02 3371,-6437.03 3371,-6417.05"/>
<polygon fill="black" stroke="black" points="3374.5,-6416.91 3371,-6406.91 3367.5,-6416.91 3374.5,-6416.91"/>
</g>
<!-- l2_attn_stage14_gpu11&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge1724" class="edge">
<title>l2_attn_stage14_gpu11&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3427.98,-6486.2C3442.91,-6479.91 3459.24,-6474.15 3475,-6470.83 3500.5,-6465.46 4389.88,-6472.85 4413,-6460.83 4426.7,-6453.71 4448.58,-6420.29 4463.12,-6396.13"/>
<polygon fill="red" stroke="red" points="4466.21,-6397.79 4468.3,-6387.4 4460.19,-6394.22 4466.21,-6397.79"/>
<text text-anchor="middle" x="4459.5" y="-6449.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu12 -->
<g id="node589" class="node">
<title>l2_attn_stage15_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3579" cy="-6369.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3579" y="-6380.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="3579" y="-6365.63" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3579" y="-6350.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu12&#45;&gt;l2_attn_stage15_gpu12 -->
<g id="edge557" class="edge">
<title>l2_attn_stage14_gpu12&#45;&gt;l2_attn_stage15_gpu12</title>
<path fill="none" stroke="black" d="M3516.19,-6488.01C3502.64,-6482.24 3488.37,-6476.26 3475,-6470.83 3463.53,-6466.17 3456.01,-6471.04 3449,-6460.83 3445.23,-6455.34 3445.04,-6451.19 3449,-6445.83 3456.18,-6436.11 3464.05,-6442.95 3475,-6437.83 3492.44,-6429.68 3510.39,-6418.99 3526.36,-6408.52"/>
<polygon fill="black" stroke="black" points="3528.64,-6411.21 3535.02,-6402.75 3524.76,-6405.39 3528.64,-6411.21"/>
</g>
<!-- l2_attn_stage14_gpu12&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge1725" class="edge">
<title>l2_attn_stage14_gpu12&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3635.99,-6486.22C3650.91,-6479.92 3667.24,-6474.16 3683,-6470.83 3705.18,-6466.14 4483.07,-6476.96 4499,-6460.83 4515.71,-6443.92 4506.21,-6416.47 4495.15,-6396.23"/>
<polygon fill="red" stroke="red" points="4498.11,-6394.37 4490.04,-6387.51 4492.07,-6397.9 4498.11,-6394.37"/>
<text text-anchor="middle" x="4537.5" y="-6449.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu13 -->
<g id="node590" class="node">
<title>l2_attn_stage15_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3787" cy="-6369.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3787" y="-6380.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="3787" y="-6365.63" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3787" y="-6350.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu13&#45;&gt;l2_attn_stage15_gpu13 -->
<g id="edge558" class="edge">
<title>l2_attn_stage14_gpu13&#45;&gt;l2_attn_stage15_gpu13</title>
<path fill="none" stroke="black" d="M3729.39,-6486.33C3714.62,-6480.12 3698.51,-6474.37 3683,-6470.83 3658.39,-6465.22 3473.45,-6479.07 3456,-6460.83 3451.39,-6456.02 3451.37,-6450.63 3456,-6445.83 3464.76,-6436.75 3670.97,-6441.63 3683,-6437.83 3702.58,-6431.66 3722,-6420.72 3738.67,-6409.41"/>
<polygon fill="black" stroke="black" points="3740.94,-6412.1 3747.13,-6403.49 3736.93,-6406.36 3740.94,-6412.1"/>
</g>
<!-- l2_attn_stage14_gpu13&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge1726" class="edge">
<title>l2_attn_stage14_gpu13&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3843.99,-6486.24C3858.92,-6479.95 3875.25,-6474.18 3891,-6470.83 3909.86,-6466.82 4571.47,-6474.56 4585,-6460.83 4610.62,-6434.84 4569.49,-6408.25 4531.04,-6390.67"/>
<polygon fill="red" stroke="red" points="4532.44,-6387.46 4521.88,-6386.62 4529.61,-6393.87 4532.44,-6387.46"/>
<text text-anchor="middle" x="4623.5" y="-6449.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu14 -->
<g id="node591" class="node">
<title>l2_attn_stage15_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3995" cy="-6369.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3995" y="-6380.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="3995" y="-6365.63" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3995" y="-6350.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu14&#45;&gt;l2_attn_stage15_gpu14 -->
<g id="edge559" class="edge">
<title>l2_attn_stage14_gpu14&#45;&gt;l2_attn_stage15_gpu14</title>
<path fill="none" stroke="black" d="M3937.71,-6486.23C3922.86,-6479.97 3906.64,-6474.23 3891,-6470.83 3867.76,-6465.78 3479.62,-6477.85 3463,-6460.83 3458.34,-6456.06 3458.33,-6450.59 3463,-6445.83 3471.33,-6437.35 3879.63,-6441.31 3891,-6437.83 3910.63,-6431.82 3930.07,-6420.92 3946.73,-6409.61"/>
<polygon fill="black" stroke="black" points="3949.01,-6412.29 3955.18,-6403.68 3944.99,-6406.56 3949.01,-6412.29"/>
</g>
<!-- l2_attn_stage14_gpu14&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge1727" class="edge">
<title>l2_attn_stage14_gpu14&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4052,-6486.28C4066.92,-6479.98 4083.25,-6474.2 4099,-6470.83 4114.54,-6467.51 4659.86,-6472.17 4671,-6460.83 4707.88,-6423.3 4644.24,-6399.54 4580.37,-6385.83"/>
<polygon fill="red" stroke="red" points="4581.05,-6382.4 4570.55,-6383.8 4579.63,-6389.25 4581.05,-6382.4"/>
<text text-anchor="middle" x="4710.5" y="-6449.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_stage15_gpu15 -->
<g id="node592" class="node">
<title>l2_attn_stage15_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4203" cy="-6369.33" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4203" y="-6380.63" font-family="Times,serif" font-size="14.00">L2 Attn Stage15</text>
<text text-anchor="middle" x="4203" y="-6365.63" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4203" y="-6350.63" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l2_attn_stage14_gpu15&#45;&gt;l2_attn_stage15_gpu15 -->
<g id="edge560" class="edge">
<title>l2_attn_stage14_gpu15&#45;&gt;l2_attn_stage15_gpu15</title>
<path fill="none" stroke="black" d="M4146,-6486.26C4131.08,-6479.96 4114.75,-6474.19 4099,-6470.83 4081.91,-6467.19 3482.26,-6473.29 3470,-6460.83 3465.32,-6456.08 3465.32,-6450.58 3470,-6445.83 3482.28,-6433.4 4082.28,-6442.9 4099,-6437.83 4118.65,-6431.88 4138.09,-6420.99 4154.75,-6409.67"/>
<polygon fill="black" stroke="black" points="4157.03,-6412.35 4163.2,-6403.74 4153.01,-6406.63 4157.03,-6412.35"/>
</g>
<!-- l2_attn_stage14_gpu15&#45;&gt;l2_attn_stage15_gpu[next_gpu] -->
<g id="edge1728" class="edge">
<title>l2_attn_stage14_gpu15&#45;&gt;l2_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4262.56,-6486.91C4278.88,-6480.39 4296.81,-6474.35 4314,-6470.83 4338.12,-6465.89 4739.79,-6478.43 4757,-6460.83 4806.67,-6410.03 4719.33,-6387.72 4629.57,-6377.94"/>
<polygon fill="red" stroke="red" points="4629.78,-6374.44 4619.47,-6376.89 4629.05,-6381.4 4629.78,-6374.44"/>
<text text-anchor="middle" x="4796.5" y="-6449.63" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l2_attn_out_gpu0 -->
<g id="node609" class="node">
<title>l2_attn_out_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1085" cy="-6246.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1085" y="-6265.55" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="1085" y="-6250.55" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1085" y="-6235.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1085" y="-6220.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu0&#45;&gt;l2_attn_out_gpu0 -->
<g id="edge561" class="edge">
<title>l2_attn_stage15_gpu0&#45;&gt;l2_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M1083.61,-6331.83C1083.75,-6323.36 1083.9,-6314.16 1084.05,-6305.05"/>
<polygon fill="black" stroke="black" points="1087.55,-6304.9 1084.22,-6294.84 1080.55,-6304.78 1087.55,-6304.9"/>
</g>
<!-- l2_attn_out_gpu1 -->
<g id="node610" class="node">
<title>l2_attn_out_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1298" cy="-6246.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1298" y="-6265.55" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="1298" y="-6250.55" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1298" y="-6235.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1298" y="-6220.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu1&#45;&gt;l2_attn_out_gpu1 -->
<g id="edge562" class="edge">
<title>l2_attn_stage15_gpu1&#45;&gt;l2_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M1293.12,-6331.83C1293.61,-6323.36 1294.14,-6314.16 1294.67,-6305.05"/>
<polygon fill="black" stroke="black" points="1298.18,-6305.02 1295.27,-6294.84 1291.19,-6304.62 1298.18,-6305.02"/>
</g>
<!-- l2_attn_out_gpu2 -->
<g id="node611" class="node">
<title>l2_attn_out_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1504" cy="-6246.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1504" y="-6265.55" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="1504" y="-6250.55" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1504" y="-6235.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1504" y="-6220.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu2&#45;&gt;l2_attn_out_gpu2 -->
<g id="edge563" class="edge">
<title>l2_attn_stage15_gpu2&#45;&gt;l2_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M1500.51,-6331.83C1500.86,-6323.36 1501.25,-6314.16 1501.62,-6305.05"/>
<polygon fill="black" stroke="black" points="1505.13,-6304.98 1502.05,-6294.84 1498.14,-6304.68 1505.13,-6304.98"/>
</g>
<!-- l2_attn_out_gpu3 -->
<g id="node612" class="node">
<title>l2_attn_out_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1710" cy="-6246.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1710" y="-6265.55" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="1710" y="-6250.55" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1710" y="-6235.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1710" y="-6220.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu3&#45;&gt;l2_attn_out_gpu3 -->
<g id="edge564" class="edge">
<title>l2_attn_stage15_gpu3&#45;&gt;l2_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M1707.91,-6331.83C1708.12,-6323.36 1708.35,-6314.16 1708.57,-6305.05"/>
<polygon fill="black" stroke="black" points="1712.08,-6304.92 1708.83,-6294.84 1705.08,-6304.75 1712.08,-6304.92"/>
</g>
<!-- l2_attn_out_gpu4 -->
<g id="node613" class="node">
<title>l2_attn_out_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1917" cy="-6246.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1917" y="-6265.55" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="1917" y="-6250.55" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1917" y="-6235.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1917" y="-6220.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu4&#45;&gt;l2_attn_out_gpu4 -->
<g id="edge565" class="edge">
<title>l2_attn_stage15_gpu4&#45;&gt;l2_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M1915.61,-6331.83C1915.75,-6323.36 1915.9,-6314.16 1916.05,-6305.05"/>
<polygon fill="black" stroke="black" points="1919.55,-6304.9 1916.22,-6294.84 1912.55,-6304.78 1919.55,-6304.9"/>
</g>
<!-- l2_attn_out_gpu5 -->
<g id="node614" class="node">
<title>l2_attn_out_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2126" cy="-6246.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2126" y="-6265.55" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="2126" y="-6250.55" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2126" y="-6235.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2126" y="-6220.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu5&#45;&gt;l2_attn_out_gpu5 -->
<g id="edge566" class="edge">
<title>l2_attn_stage15_gpu5&#45;&gt;l2_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M2123.91,-6331.83C2124.12,-6323.36 2124.35,-6314.16 2124.57,-6305.05"/>
<polygon fill="black" stroke="black" points="2128.08,-6304.92 2124.83,-6294.84 2121.08,-6304.75 2128.08,-6304.92"/>
</g>
<!-- l2_attn_out_gpu6 -->
<g id="node615" class="node">
<title>l2_attn_out_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2333" cy="-6246.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2333" y="-6265.55" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="2333" y="-6250.55" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2333" y="-6235.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2333" y="-6220.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu6&#45;&gt;l2_attn_out_gpu6 -->
<g id="edge567" class="edge">
<title>l2_attn_stage15_gpu6&#45;&gt;l2_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M2331.61,-6331.83C2331.75,-6323.36 2331.9,-6314.16 2332.05,-6305.05"/>
<polygon fill="black" stroke="black" points="2335.55,-6304.9 2332.22,-6294.84 2328.55,-6304.78 2335.55,-6304.9"/>
</g>
<!-- l2_attn_out_gpu7 -->
<g id="node616" class="node">
<title>l2_attn_out_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2542" cy="-6246.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2542" y="-6265.55" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="2542" y="-6250.55" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2542" y="-6235.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2542" y="-6220.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu7&#45;&gt;l2_attn_out_gpu7 -->
<g id="edge568" class="edge">
<title>l2_attn_stage15_gpu7&#45;&gt;l2_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M2539.91,-6331.83C2540.12,-6323.36 2540.35,-6314.16 2540.57,-6305.05"/>
<polygon fill="black" stroke="black" points="2544.08,-6304.92 2540.83,-6294.84 2537.08,-6304.75 2544.08,-6304.92"/>
</g>
<!-- l2_attn_out_gpu8 -->
<g id="node617" class="node">
<title>l2_attn_out_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2747" cy="-6246.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2747" y="-6265.55" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="2747" y="-6250.55" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2747" y="-6235.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2747" y="-6220.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu8&#45;&gt;l2_attn_out_gpu8 -->
<g id="edge569" class="edge">
<title>l2_attn_stage15_gpu8&#45;&gt;l2_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M2747,-6331.83C2747,-6323.36 2747,-6314.16 2747,-6305.05"/>
<polygon fill="black" stroke="black" points="2750.5,-6304.84 2747,-6294.84 2743.5,-6304.84 2750.5,-6304.84"/>
</g>
<!-- l2_attn_out_gpu9 -->
<g id="node618" class="node">
<title>l2_attn_out_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2953" cy="-6246.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2953" y="-6265.55" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="2953" y="-6250.55" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2953" y="-6235.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2953" y="-6220.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu9&#45;&gt;l2_attn_out_gpu9 -->
<g id="edge570" class="edge">
<title>l2_attn_stage15_gpu9&#45;&gt;l2_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M2954.39,-6331.83C2954.25,-6323.36 2954.1,-6314.16 2953.95,-6305.05"/>
<polygon fill="black" stroke="black" points="2957.45,-6304.78 2953.78,-6294.84 2950.45,-6304.9 2957.45,-6304.78"/>
</g>
<!-- l2_attn_out_gpu10 -->
<g id="node619" class="node">
<title>l2_attn_out_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3160" cy="-6246.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3160" y="-6265.55" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="3160" y="-6250.55" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3160" y="-6235.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3160" y="-6220.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu10&#45;&gt;l2_attn_out_gpu10 -->
<g id="edge571" class="edge">
<title>l2_attn_stage15_gpu10&#45;&gt;l2_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M3162.09,-6331.83C3161.88,-6323.36 3161.65,-6314.16 3161.43,-6305.05"/>
<polygon fill="black" stroke="black" points="3164.92,-6304.75 3161.17,-6294.84 3157.92,-6304.92 3164.92,-6304.75"/>
</g>
<!-- l2_attn_out_gpu11 -->
<g id="node620" class="node">
<title>l2_attn_out_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3368" cy="-6246.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3368" y="-6265.55" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="3368" y="-6250.55" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3368" y="-6235.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3368" y="-6220.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu11&#45;&gt;l2_attn_out_gpu11 -->
<g id="edge572" class="edge">
<title>l2_attn_stage15_gpu11&#45;&gt;l2_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M3370.09,-6331.83C3369.88,-6323.36 3369.65,-6314.16 3369.43,-6305.05"/>
<polygon fill="black" stroke="black" points="3372.92,-6304.75 3369.17,-6294.84 3365.92,-6304.92 3372.92,-6304.75"/>
</g>
<!-- l2_attn_out_gpu12 -->
<g id="node621" class="node">
<title>l2_attn_out_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3575" cy="-6246.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3575" y="-6265.55" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="3575" y="-6250.55" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3575" y="-6235.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3575" y="-6220.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu12&#45;&gt;l2_attn_out_gpu12 -->
<g id="edge573" class="edge">
<title>l2_attn_stage15_gpu12&#45;&gt;l2_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M3577.79,-6331.83C3577.51,-6323.36 3577.2,-6314.16 3576.9,-6305.05"/>
<polygon fill="black" stroke="black" points="3580.39,-6304.72 3576.56,-6294.84 3573.4,-6304.95 3580.39,-6304.72"/>
</g>
<!-- l2_attn_out_gpu13 -->
<g id="node622" class="node">
<title>l2_attn_out_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3780" cy="-6246.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3780" y="-6265.55" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="3780" y="-6250.55" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3780" y="-6235.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3780" y="-6220.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu13&#45;&gt;l2_attn_out_gpu13 -->
<g id="edge574" class="edge">
<title>l2_attn_stage15_gpu13&#45;&gt;l2_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M3784.88,-6331.83C3784.39,-6323.36 3783.86,-6314.16 3783.33,-6305.05"/>
<polygon fill="black" stroke="black" points="3786.81,-6304.62 3782.73,-6294.84 3779.82,-6305.02 3786.81,-6304.62"/>
</g>
<!-- l2_attn_out_gpu14 -->
<g id="node623" class="node">
<title>l2_attn_out_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3987" cy="-6246.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3987" y="-6265.55" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="3987" y="-6250.55" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3987" y="-6235.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3987" y="-6220.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu14&#45;&gt;l2_attn_out_gpu14 -->
<g id="edge575" class="edge">
<title>l2_attn_stage15_gpu14&#45;&gt;l2_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M3992.58,-6331.83C3992.02,-6323.36 3991.41,-6314.16 3990.8,-6305.05"/>
<polygon fill="black" stroke="black" points="3994.28,-6304.58 3990.12,-6294.84 3987.29,-6305.05 3994.28,-6304.58"/>
</g>
<!-- l2_attn_out_gpu15 -->
<g id="node624" class="node">
<title>l2_attn_out_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4195" cy="-6246.75" rx="75" ry="48.17"/>
<text text-anchor="middle" x="4195" y="-6265.55" font-family="Times,serif" font-size="14.00">L2 Attn Out</text>
<text text-anchor="middle" x="4195" y="-6250.55" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4195" y="-6235.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="4195" y="-6220.55" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l2_attn_stage15_gpu15&#45;&gt;l2_attn_out_gpu15 -->
<g id="edge576" class="edge">
<title>l2_attn_stage15_gpu15&#45;&gt;l2_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M4200.58,-6331.83C4200.02,-6323.36 4199.41,-6314.16 4198.8,-6305.05"/>
<polygon fill="black" stroke="black" points="4202.28,-6304.58 4198.12,-6294.84 4195.29,-6305.05 4202.28,-6304.58"/>
</g>
<!-- l2_qkv_gpu0&#45;&gt;l2_attn_stage0_gpu0 -->
<g id="edge305" class="edge">
<title>l2_qkv_gpu0&#45;&gt;l2_attn_stage0_gpu0</title>
<path fill="none" stroke="black" d="M1211.96,-8672.89C1224.91,-8655.59 1239.74,-8635.79 1252.63,-8618.57"/>
<polygon fill="black" stroke="black" points="1255.6,-8620.44 1258.79,-8610.34 1249.99,-8616.25 1255.6,-8620.44"/>
</g>
<!-- l2_qkv_gpu1&#45;&gt;l2_attn_stage0_gpu1 -->
<g id="edge306" class="edge">
<title>l2_qkv_gpu1&#45;&gt;l2_attn_stage0_gpu1</title>
<path fill="none" stroke="black" d="M1414.38,-8672.12C1425.79,-8655.28 1438.75,-8636.17 1450.12,-8619.41"/>
<polygon fill="black" stroke="black" points="1453.18,-8621.12 1455.9,-8610.88 1447.39,-8617.19 1453.18,-8621.12"/>
</g>
<!-- l2_qkv_gpu2&#45;&gt;l2_attn_stage0_gpu2 -->
<g id="edge307" class="edge">
<title>l2_qkv_gpu2&#45;&gt;l2_attn_stage0_gpu2</title>
<path fill="none" stroke="black" d="M1615.09,-8671.73C1625.44,-8655.07 1637.16,-8636.22 1647.46,-8619.64"/>
<polygon fill="black" stroke="black" points="1650.72,-8621.03 1653.03,-8610.69 1644.77,-8617.33 1650.72,-8621.03"/>
</g>
<!-- l2_qkv_gpu3&#45;&gt;l2_attn_stage0_gpu3 -->
<g id="edge308" class="edge">
<title>l2_qkv_gpu3&#45;&gt;l2_attn_stage0_gpu3</title>
<path fill="none" stroke="black" d="M1815.75,-8671.34C1825.08,-8654.83 1835.59,-8636.22 1844.87,-8619.81"/>
<polygon fill="black" stroke="black" points="1848,-8621.38 1849.88,-8610.95 1841.91,-8617.93 1848,-8621.38"/>
</g>
<!-- l2_qkv_gpu4&#45;&gt;l2_attn_stage0_gpu4 -->
<g id="edge309" class="edge">
<title>l2_qkv_gpu4&#45;&gt;l2_attn_stage0_gpu4</title>
<path fill="none" stroke="black" d="M2015.5,-8671.34C2023.86,-8655.12 2033.27,-8636.87 2041.62,-8620.67"/>
<polygon fill="black" stroke="black" points="2044.93,-8621.89 2046.4,-8611.4 2038.71,-8618.69 2044.93,-8621.89"/>
</g>
<!-- l2_qkv_gpu5&#45;&gt;l2_attn_stage0_gpu5 -->
<g id="edge310" class="edge">
<title>l2_qkv_gpu5&#45;&gt;l2_attn_stage0_gpu5</title>
<path fill="none" stroke="black" d="M2215.43,-8670.95C2222.98,-8654.75 2231.46,-8636.56 2238.97,-8620.44"/>
<polygon fill="black" stroke="black" points="2242.22,-8621.75 2243.28,-8611.21 2235.88,-8618.79 2242.22,-8621.75"/>
</g>
<!-- l2_qkv_gpu6&#45;&gt;l2_attn_stage0_gpu6 -->
<g id="edge311" class="edge">
<title>l2_qkv_gpu6&#45;&gt;l2_attn_stage0_gpu6</title>
<path fill="none" stroke="black" d="M2415.32,-8670.56C2421.94,-8654.66 2429.35,-8636.89 2435.95,-8621.05"/>
<polygon fill="black" stroke="black" points="2439.33,-8622.04 2439.94,-8611.47 2432.87,-8619.35 2439.33,-8622.04"/>
</g>
<!-- l2_qkv_gpu7&#45;&gt;l2_attn_stage0_gpu7 -->
<g id="edge312" class="edge">
<title>l2_qkv_gpu7&#45;&gt;l2_attn_stage0_gpu7</title>
<path fill="none" stroke="black" d="M2615.03,-8670.56C2620.86,-8654.66 2627.39,-8636.89 2633.21,-8621.05"/>
<polygon fill="black" stroke="black" points="2636.57,-8622.06 2636.73,-8611.47 2630,-8619.65 2636.57,-8622.06"/>
</g>
<!-- l2_qkv_gpu8&#45;&gt;l2_attn_stage0_gpu8 -->
<g id="edge313" class="edge">
<title>l2_qkv_gpu8&#45;&gt;l2_attn_stage0_gpu8</title>
<path fill="none" stroke="black" d="M2814.86,-8670.16C2819.82,-8654.57 2825.33,-8637.21 2830.28,-8621.65"/>
<polygon fill="black" stroke="black" points="2833.74,-8622.31 2833.43,-8611.72 2827.07,-8620.19 2833.74,-8622.31"/>
</g>
<!-- l2_qkv_gpu9&#45;&gt;l2_attn_stage0_gpu9 -->
<g id="edge314" class="edge">
<title>l2_qkv_gpu9&#45;&gt;l2_attn_stage0_gpu9</title>
<path fill="none" stroke="black" d="M3014.55,-8670.16C3018.73,-8654.57 3023.39,-8637.21 3027.57,-8621.65"/>
<polygon fill="black" stroke="black" points="3031.02,-8622.29 3030.23,-8611.72 3024.26,-8620.47 3031.02,-8622.29"/>
</g>
<!-- l2_qkv_gpu10&#45;&gt;l2_attn_stage0_gpu10 -->
<g id="edge315" class="edge">
<title>l2_qkv_gpu10&#45;&gt;l2_attn_stage0_gpu10</title>
<path fill="none" stroke="black" d="M3214.32,-8669.77C3217.7,-8654.33 3221.46,-8637.19 3224.83,-8621.8"/>
<polygon fill="black" stroke="black" points="3228.26,-8622.49 3226.98,-8611.97 3221.42,-8620.99 3228.26,-8622.49"/>
</g>
<!-- l2_qkv_gpu11&#45;&gt;l2_attn_stage0_gpu11 -->
<g id="edge316" class="edge">
<title>l2_qkv_gpu11&#45;&gt;l2_attn_stage0_gpu11</title>
<path fill="none" stroke="black" d="M3413.99,-8669.77C3416.58,-8654.48 3419.46,-8637.52 3422.05,-8622.24"/>
<polygon fill="black" stroke="black" points="3425.57,-8622.42 3423.79,-8611.97 3418.67,-8621.25 3425.57,-8622.42"/>
</g>
<!-- l2_qkv_gpu12&#45;&gt;l2_attn_stage0_gpu12 -->
<g id="edge317" class="edge">
<title>l2_qkv_gpu12&#45;&gt;l2_attn_stage0_gpu12</title>
<path fill="none" stroke="black" d="M3613.66,-8669.77C3615.5,-8654.48 3617.53,-8637.52 3619.37,-8622.24"/>
<polygon fill="black" stroke="black" points="3622.88,-8622.32 3620.6,-8611.97 3615.93,-8621.49 3622.88,-8622.32"/>
</g>
<!-- l2_qkv_gpu13&#45;&gt;l2_attn_stage0_gpu13 -->
<g id="edge318" class="edge">
<title>l2_qkv_gpu13&#45;&gt;l2_attn_stage0_gpu13</title>
<path fill="none" stroke="black" d="M3813.33,-8669.77C3814.41,-8654.48 3815.61,-8637.52 3816.69,-8622.24"/>
<polygon fill="black" stroke="black" points="3820.2,-8622.2 3817.41,-8611.97 3813.22,-8621.7 3820.2,-8622.2"/>
</g>
<!-- l2_qkv_gpu14&#45;&gt;l2_attn_stage0_gpu14 -->
<g id="edge319" class="edge">
<title>l2_qkv_gpu14&#45;&gt;l2_attn_stage0_gpu14</title>
<path fill="none" stroke="black" d="M4013,-8669.77C4013.32,-8654.48 4013.68,-8637.52 4014.01,-8622.24"/>
<polygon fill="black" stroke="black" points="4017.51,-8622.05 4014.22,-8611.97 4010.51,-8621.9 4017.51,-8622.05"/>
</g>
<!-- l2_qkv_gpu15&#45;&gt;l2_attn_stage0_gpu15 -->
<g id="edge320" class="edge">
<title>l2_qkv_gpu15&#45;&gt;l2_attn_stage0_gpu15</title>
<path fill="none" stroke="black" d="M4212.67,-8669.77C4212.24,-8654.48 4211.76,-8637.52 4211.33,-8622.24"/>
<polygon fill="black" stroke="black" points="4214.82,-8621.87 4211.04,-8611.97 4207.82,-8622.07 4214.82,-8621.87"/>
</g>
<!-- l2_mlp_h2_4h_gpu0 -->
<g id="node625" class="node">
<title>l2_mlp_h2_4h_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1103" cy="-6113.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1103" y="-6132.38" font-family="Times,serif" font-size="14.00">L2 MLP h24h</text>
<text text-anchor="middle" x="1103" y="-6117.38" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1103" y="-6102.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1103" y="-6087.38" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l2_attn_out_gpu0&#45;&gt;l2_mlp_h2_4h_gpu0 -->
<g id="edge577" class="edge">
<title>l2_attn_out_gpu0&#45;&gt;l2_mlp_h2_4h_gpu0</title>
<path fill="none" stroke="black" d="M1091.45,-6198.76C1092.65,-6190.01 1093.92,-6180.76 1095.16,-6171.74"/>
<polygon fill="black" stroke="black" points="1098.64,-6172.06 1096.54,-6161.68 1091.71,-6171.11 1098.64,-6172.06"/>
</g>
<!-- l2_mlp_h2_4h_gpu1 -->
<g id="node627" class="node">
<title>l2_mlp_h2_4h_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1314" cy="-6113.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1314" y="-6132.38" font-family="Times,serif" font-size="14.00">L2 MLP h24h</text>
<text text-anchor="middle" x="1314" y="-6117.38" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1314" y="-6102.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1314" y="-6087.38" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l2_attn_out_gpu1&#45;&gt;l2_mlp_h2_4h_gpu1 -->
<g id="edge579" class="edge">
<title>l2_attn_out_gpu1&#45;&gt;l2_mlp_h2_4h_gpu1</title>
<path fill="none" stroke="black" d="M1303.73,-6198.76C1304.8,-6190.01 1305.93,-6180.76 1307.03,-6171.74"/>
<polygon fill="black" stroke="black" points="1310.52,-6172.03 1308.26,-6161.68 1303.57,-6171.18 1310.52,-6172.03"/>
</g>
<!-- l2_mlp_h2_4h_gpu2 -->
<g id="node629" class="node">
<title>l2_mlp_h2_4h_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1516" cy="-6113.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1516" y="-6132.38" font-family="Times,serif" font-size="14.00">L2 MLP h24h</text>
<text text-anchor="middle" x="1516" y="-6117.38" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1516" y="-6102.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1516" y="-6087.38" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l2_attn_out_gpu2&#45;&gt;l2_mlp_h2_4h_gpu2 -->
<g id="edge581" class="edge">
<title>l2_attn_out_gpu2&#45;&gt;l2_mlp_h2_4h_gpu2</title>
<path fill="none" stroke="black" d="M1508.33,-6198.39C1509.11,-6189.85 1509.94,-6180.86 1510.74,-6172.06"/>
<polygon fill="black" stroke="black" points="1514.25,-6172.14 1511.67,-6161.87 1507.28,-6171.51 1514.25,-6172.14"/>
</g>
<!-- l2_mlp_h2_4h_gpu3 -->
<g id="node631" class="node">
<title>l2_mlp_h2_4h_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1718" cy="-6113.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1718" y="-6132.38" font-family="Times,serif" font-size="14.00">L2 MLP h24h</text>
<text text-anchor="middle" x="1718" y="-6117.38" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1718" y="-6102.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1718" y="-6087.38" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l2_attn_out_gpu3&#45;&gt;l2_mlp_h2_4h_gpu3 -->
<g id="edge583" class="edge">
<title>l2_attn_out_gpu3&#45;&gt;l2_mlp_h2_4h_gpu3</title>
<path fill="none" stroke="black" d="M1712.89,-6198.39C1713.41,-6189.85 1713.96,-6180.86 1714.49,-6172.06"/>
<polygon fill="black" stroke="black" points="1718,-6172.06 1715.12,-6161.87 1711.01,-6171.63 1718,-6172.06"/>
</g>
<!-- l2_mlp_h2_4h_gpu4 -->
<g id="node633" class="node">
<title>l2_mlp_h2_4h_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1921" cy="-6113.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1921" y="-6132.38" font-family="Times,serif" font-size="14.00">L2 MLP h24h</text>
<text text-anchor="middle" x="1921" y="-6117.38" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1921" y="-6102.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1921" y="-6087.38" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l2_attn_out_gpu4&#45;&gt;l2_mlp_h2_4h_gpu4 -->
<g id="edge585" class="edge">
<title>l2_attn_out_gpu4&#45;&gt;l2_mlp_h2_4h_gpu4</title>
<path fill="none" stroke="black" d="M1918.44,-6198.39C1918.7,-6189.85 1918.98,-6180.86 1919.25,-6172.06"/>
<polygon fill="black" stroke="black" points="1922.75,-6171.97 1919.56,-6161.87 1915.75,-6171.76 1922.75,-6171.97"/>
</g>
<!-- l2_mlp_h2_4h_gpu5 -->
<g id="node635" class="node">
<title>l2_mlp_h2_4h_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2132" cy="-6113.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2132" y="-6132.38" font-family="Times,serif" font-size="14.00">L2 MLP h24h</text>
<text text-anchor="middle" x="2132" y="-6117.38" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2132" y="-6102.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2132" y="-6087.38" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l2_attn_out_gpu5&#45;&gt;l2_mlp_h2_4h_gpu5 -->
<g id="edge587" class="edge">
<title>l2_attn_out_gpu5&#45;&gt;l2_mlp_h2_4h_gpu5</title>
<path fill="none" stroke="black" d="M2128.17,-6198.39C2128.56,-6189.85 2128.97,-6180.86 2129.37,-6172.06"/>
<polygon fill="black" stroke="black" points="2132.88,-6172.02 2129.84,-6161.87 2125.88,-6171.7 2132.88,-6172.02"/>
</g>
<!-- l2_mlp_h2_4h_gpu6 -->
<g id="node637" class="node">
<title>l2_mlp_h2_4h_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2338" cy="-6113.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2338" y="-6132.38" font-family="Times,serif" font-size="14.00">L2 MLP h24h</text>
<text text-anchor="middle" x="2338" y="-6117.38" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2338" y="-6102.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2338" y="-6087.38" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l2_attn_out_gpu6&#45;&gt;l2_mlp_h2_4h_gpu6 -->
<g id="edge589" class="edge">
<title>l2_attn_out_gpu6&#45;&gt;l2_mlp_h2_4h_gpu6</title>
<path fill="none" stroke="black" d="M2334.81,-6198.39C2335.13,-6189.85 2335.47,-6180.86 2335.81,-6172.06"/>
<polygon fill="black" stroke="black" points="2339.31,-6171.99 2336.2,-6161.87 2332.32,-6171.73 2339.31,-6171.99"/>
</g>
<!-- l2_mlp_h2_4h_gpu7 -->
<g id="node639" class="node">
<title>l2_mlp_h2_4h_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2543" cy="-6113.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2543" y="-6132.38" font-family="Times,serif" font-size="14.00">L2 MLP h24h</text>
<text text-anchor="middle" x="2543" y="-6117.38" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2543" y="-6102.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2543" y="-6087.38" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l2_attn_out_gpu7&#45;&gt;l2_mlp_h2_4h_gpu7 -->
<g id="edge591" class="edge">
<title>l2_attn_out_gpu7&#45;&gt;l2_mlp_h2_4h_gpu7</title>
<path fill="none" stroke="black" d="M2542.36,-6198.39C2542.43,-6189.85 2542.49,-6180.86 2542.56,-6172.06"/>
<polygon fill="black" stroke="black" points="2546.06,-6171.89 2542.64,-6161.87 2539.06,-6171.84 2546.06,-6171.89"/>
</g>
<!-- l2_mlp_h2_4h_gpu8 -->
<g id="node641" class="node">
<title>l2_mlp_h2_4h_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2746" cy="-6113.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2746" y="-6132.38" font-family="Times,serif" font-size="14.00">L2 MLP h24h</text>
<text text-anchor="middle" x="2746" y="-6117.38" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2746" y="-6102.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2746" y="-6087.38" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l2_attn_out_gpu8&#45;&gt;l2_mlp_h2_4h_gpu8 -->
<g id="edge593" class="edge">
<title>l2_attn_out_gpu8&#45;&gt;l2_mlp_h2_4h_gpu8</title>
<path fill="none" stroke="black" d="M2746.64,-6198.39C2746.57,-6189.85 2746.51,-6180.86 2746.44,-6172.06"/>
<polygon fill="black" stroke="black" points="2749.94,-6171.84 2746.36,-6161.87 2742.94,-6171.89 2749.94,-6171.84"/>
</g>
<!-- l2_mlp_h2_4h_gpu9 -->
<g id="node643" class="node">
<title>l2_mlp_h2_4h_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2950" cy="-6113.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2950" y="-6132.38" font-family="Times,serif" font-size="14.00">L2 MLP h24h</text>
<text text-anchor="middle" x="2950" y="-6117.38" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2950" y="-6102.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2950" y="-6087.38" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l2_attn_out_gpu9&#45;&gt;l2_mlp_h2_4h_gpu9 -->
<g id="edge595" class="edge">
<title>l2_attn_out_gpu9&#45;&gt;l2_mlp_h2_4h_gpu9</title>
<path fill="none" stroke="black" d="M2951.92,-6198.39C2951.72,-6189.85 2951.52,-6180.86 2951.31,-6172.06"/>
<polygon fill="black" stroke="black" points="2954.81,-6171.78 2951.08,-6161.87 2947.81,-6171.94 2954.81,-6171.78"/>
</g>
<!-- l2_mlp_h2_4h_gpu10 -->
<g id="node645" class="node">
<title>l2_mlp_h2_4h_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3156" cy="-6113.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3156" y="-6132.38" font-family="Times,serif" font-size="14.00">L2 MLP h24h</text>
<text text-anchor="middle" x="3156" y="-6117.38" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3156" y="-6102.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3156" y="-6087.38" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l2_attn_out_gpu10&#45;&gt;l2_mlp_h2_4h_gpu10 -->
<g id="edge597" class="edge">
<title>l2_attn_out_gpu10&#45;&gt;l2_mlp_h2_4h_gpu10</title>
<path fill="none" stroke="black" d="M3158.56,-6198.39C3158.3,-6189.85 3158.02,-6180.86 3157.75,-6172.06"/>
<polygon fill="black" stroke="black" points="3161.25,-6171.76 3157.44,-6161.87 3154.25,-6171.97 3161.25,-6171.76"/>
</g>
<!-- l2_mlp_h2_4h_gpu11 -->
<g id="node647" class="node">
<title>l2_mlp_h2_4h_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3361" cy="-6113.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3361" y="-6132.38" font-family="Times,serif" font-size="14.00">L2 MLP h24h</text>
<text text-anchor="middle" x="3361" y="-6117.38" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3361" y="-6102.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3361" y="-6087.38" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l2_attn_out_gpu11&#45;&gt;l2_mlp_h2_4h_gpu11 -->
<g id="edge599" class="edge">
<title>l2_attn_out_gpu11&#45;&gt;l2_mlp_h2_4h_gpu11</title>
<path fill="none" stroke="black" d="M3365.47,-6198.39C3365.02,-6189.85 3364.54,-6180.86 3364.07,-6172.06"/>
<polygon fill="black" stroke="black" points="3367.55,-6171.67 3363.52,-6161.87 3360.56,-6172.04 3367.55,-6171.67"/>
</g>
<!-- l2_mlp_h2_4h_gpu12 -->
<g id="node649" class="node">
<title>l2_mlp_h2_4h_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3565" cy="-6113.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3565" y="-6132.38" font-family="Times,serif" font-size="14.00">L2 MLP h24h</text>
<text text-anchor="middle" x="3565" y="-6117.38" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3565" y="-6102.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3565" y="-6087.38" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l2_attn_out_gpu12&#45;&gt;l2_mlp_h2_4h_gpu12 -->
<g id="edge601" class="edge">
<title>l2_attn_out_gpu12&#45;&gt;l2_mlp_h2_4h_gpu12</title>
<path fill="none" stroke="black" d="M3571.39,-6198.39C3570.74,-6189.85 3570.05,-6180.86 3569.38,-6172.06"/>
<polygon fill="black" stroke="black" points="3572.86,-6171.57 3568.6,-6161.87 3565.88,-6172.1 3572.86,-6171.57"/>
</g>
<!-- l2_mlp_h2_4h_gpu13 -->
<g id="node651" class="node">
<title>l2_mlp_h2_4h_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3770" cy="-6113.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3770" y="-6132.38" font-family="Times,serif" font-size="14.00">L2 MLP h24h</text>
<text text-anchor="middle" x="3770" y="-6117.38" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3770" y="-6102.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3770" y="-6087.38" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l2_attn_out_gpu13&#45;&gt;l2_mlp_h2_4h_gpu13 -->
<g id="edge603" class="edge">
<title>l2_attn_out_gpu13&#45;&gt;l2_mlp_h2_4h_gpu13</title>
<path fill="none" stroke="black" d="M3776.39,-6198.39C3775.74,-6189.85 3775.05,-6180.86 3774.38,-6172.06"/>
<polygon fill="black" stroke="black" points="3777.86,-6171.57 3773.6,-6161.87 3770.88,-6172.1 3777.86,-6171.57"/>
</g>
<!-- l2_mlp_h2_4h_gpu14 -->
<g id="node653" class="node">
<title>l2_mlp_h2_4h_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3978" cy="-6113.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3978" y="-6132.38" font-family="Times,serif" font-size="14.00">L2 MLP h24h</text>
<text text-anchor="middle" x="3978" y="-6117.38" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3978" y="-6102.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3978" y="-6087.38" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l2_attn_out_gpu14&#45;&gt;l2_mlp_h2_4h_gpu14 -->
<g id="edge605" class="edge">
<title>l2_attn_out_gpu14&#45;&gt;l2_mlp_h2_4h_gpu14</title>
<path fill="none" stroke="black" d="M3983.75,-6198.39C3983.16,-6189.85 3982.55,-6180.86 3981.94,-6172.06"/>
<polygon fill="black" stroke="black" points="3985.42,-6171.6 3981.24,-6161.87 3978.44,-6172.08 3985.42,-6171.6"/>
</g>
<!-- l2_mlp_h2_4h_gpu15 -->
<g id="node655" class="node">
<title>l2_mlp_h2_4h_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4184" cy="-6113.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="4184" y="-6132.38" font-family="Times,serif" font-size="14.00">L2 MLP h24h</text>
<text text-anchor="middle" x="4184" y="-6117.38" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4184" y="-6102.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="4184" y="-6087.38" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l2_attn_out_gpu15&#45;&gt;l2_mlp_h2_4h_gpu15 -->
<g id="edge607" class="edge">
<title>l2_attn_out_gpu15&#45;&gt;l2_mlp_h2_4h_gpu15</title>
<path fill="none" stroke="black" d="M4191.03,-6198.39C4190.31,-6189.85 4189.56,-6180.86 4188.82,-6172.06"/>
<polygon fill="black" stroke="black" points="4192.29,-6171.54 4187.97,-6161.87 4185.31,-6172.12 4192.29,-6171.54"/>
</g>
<!-- l2_mlp_4h2_h_gpu0 -->
<g id="node626" class="node">
<title>l2_mlp_4h2_h_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1112" cy="-5980.42" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1112" y="-5999.22" font-family="Times,serif" font-size="14.00">L2 MLP 4h2h</text>
<text text-anchor="middle" x="1112" y="-5984.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1112" y="-5969.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1112" y="-5954.22" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l2_mlp_h2_4h_gpu0&#45;&gt;l2_mlp_4h2_h_gpu0 -->
<g id="edge578" class="edge">
<title>l2_mlp_h2_4h_gpu0&#45;&gt;l2_mlp_4h2_h_gpu0</title>
<path fill="none" stroke="black" d="M1106.25,-6065.23C1106.84,-6056.68 1107.45,-6047.69 1108.06,-6038.9"/>
<polygon fill="black" stroke="black" points="1111.56,-6038.92 1108.76,-6028.7 1104.58,-6038.44 1111.56,-6038.92"/>
</g>
<!-- l3_qkv_gpu0 -->
<g id="node913" class="node">
<title>l3_qkv_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1115" cy="-5826.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1115" y="-5845.05" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="1115" y="-5830.05" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1115" y="-5815.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1115" y="-5800.05" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_mlp_4h2_h_gpu0&#45;&gt;l3_qkv_gpu0 -->
<g id="edge1729" class="edge">
<title>l2_mlp_4h2_h_gpu0&#45;&gt;l3_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1112.93,-5932.1C1113.23,-5917.07 1113.56,-5900.29 1113.87,-5884.63"/>
<polygon fill="black" stroke="black" points="1117.37,-5884.6 1114.07,-5874.53 1110.37,-5884.46 1117.37,-5884.6"/>
</g>
<!-- l2_mlp_4h2_h_gpu1 -->
<g id="node628" class="node">
<title>l2_mlp_4h2_h_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1319" cy="-5980.42" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1319" y="-5999.22" font-family="Times,serif" font-size="14.00">L2 MLP 4h2h</text>
<text text-anchor="middle" x="1319" y="-5984.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1319" y="-5969.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1319" y="-5954.22" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l2_mlp_h2_4h_gpu1&#45;&gt;l2_mlp_4h2_h_gpu1 -->
<g id="edge580" class="edge">
<title>l2_mlp_h2_4h_gpu1&#45;&gt;l2_mlp_4h2_h_gpu1</title>
<path fill="none" stroke="black" d="M1315.81,-6065.23C1316.13,-6056.68 1316.47,-6047.69 1316.81,-6038.9"/>
<polygon fill="black" stroke="black" points="1320.31,-6038.83 1317.2,-6028.7 1313.32,-6038.56 1320.31,-6038.83"/>
</g>
<!-- l3_qkv_gpu1 -->
<g id="node914" class="node">
<title>l3_qkv_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1321" cy="-5826.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1321" y="-5845.05" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="1321" y="-5830.05" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1321" y="-5815.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1321" y="-5800.05" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_mlp_4h2_h_gpu1&#45;&gt;l3_qkv_gpu1 -->
<g id="edge1730" class="edge">
<title>l2_mlp_4h2_h_gpu1&#45;&gt;l3_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1319.62,-5932.1C1319.82,-5917.07 1320.04,-5900.29 1320.25,-5884.63"/>
<polygon fill="black" stroke="black" points="1323.75,-5884.58 1320.38,-5874.53 1316.75,-5884.49 1323.75,-5884.58"/>
</g>
<!-- l2_mlp_4h2_h_gpu2 -->
<g id="node630" class="node">
<title>l2_mlp_4h2_h_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1521" cy="-5980.42" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1521" y="-5999.22" font-family="Times,serif" font-size="14.00">L2 MLP 4h2h</text>
<text text-anchor="middle" x="1521" y="-5984.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1521" y="-5969.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1521" y="-5954.22" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l2_mlp_h2_4h_gpu2&#45;&gt;l2_mlp_4h2_h_gpu2 -->
<g id="edge582" class="edge">
<title>l2_mlp_h2_4h_gpu2&#45;&gt;l2_mlp_4h2_h_gpu2</title>
<path fill="none" stroke="black" d="M1517.81,-6065.23C1518.13,-6056.68 1518.47,-6047.69 1518.81,-6038.9"/>
<polygon fill="black" stroke="black" points="1522.31,-6038.83 1519.2,-6028.7 1515.32,-6038.56 1522.31,-6038.83"/>
</g>
<!-- l3_qkv_gpu2 -->
<g id="node915" class="node">
<title>l3_qkv_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1523" cy="-5826.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1523" y="-5845.05" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="1523" y="-5830.05" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1523" y="-5815.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1523" y="-5800.05" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_mlp_4h2_h_gpu2&#45;&gt;l3_qkv_gpu2 -->
<g id="edge1731" class="edge">
<title>l2_mlp_4h2_h_gpu2&#45;&gt;l3_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1521.62,-5932.1C1521.82,-5917.07 1522.04,-5900.29 1522.25,-5884.63"/>
<polygon fill="black" stroke="black" points="1525.75,-5884.58 1522.38,-5874.53 1518.75,-5884.49 1525.75,-5884.58"/>
</g>
<!-- l2_mlp_4h2_h_gpu3 -->
<g id="node632" class="node">
<title>l2_mlp_4h2_h_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1720" cy="-5980.42" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1720" y="-5999.22" font-family="Times,serif" font-size="14.00">L2 MLP 4h2h</text>
<text text-anchor="middle" x="1720" y="-5984.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1720" y="-5969.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1720" y="-5954.22" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l2_mlp_h2_4h_gpu3&#45;&gt;l2_mlp_4h2_h_gpu3 -->
<g id="edge584" class="edge">
<title>l2_mlp_h2_4h_gpu3&#45;&gt;l2_mlp_4h2_h_gpu3</title>
<path fill="none" stroke="black" d="M1718.72,-6065.23C1718.85,-6056.68 1718.99,-6047.69 1719.12,-6038.9"/>
<polygon fill="black" stroke="black" points="1722.63,-6038.75 1719.28,-6028.7 1715.63,-6038.65 1722.63,-6038.75"/>
</g>
<!-- l3_qkv_gpu3 -->
<g id="node916" class="node">
<title>l3_qkv_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1725" cy="-5826.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1725" y="-5845.05" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="1725" y="-5830.05" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1725" y="-5815.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1725" y="-5800.05" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_mlp_4h2_h_gpu3&#45;&gt;l3_qkv_gpu3 -->
<g id="edge1732" class="edge">
<title>l2_mlp_4h2_h_gpu3&#45;&gt;l3_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1721.55,-5932.1C1722.05,-5917.07 1722.6,-5900.29 1723.11,-5884.63"/>
<polygon fill="black" stroke="black" points="1726.62,-5884.64 1723.45,-5874.53 1719.62,-5884.41 1726.62,-5884.64"/>
</g>
<!-- l2_mlp_4h2_h_gpu4 -->
<g id="node634" class="node">
<title>l2_mlp_4h2_h_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1928" cy="-5980.42" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1928" y="-5999.22" font-family="Times,serif" font-size="14.00">L2 MLP 4h2h</text>
<text text-anchor="middle" x="1928" y="-5984.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1928" y="-5969.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1928" y="-5954.22" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l2_mlp_h2_4h_gpu4&#45;&gt;l2_mlp_4h2_h_gpu4 -->
<g id="edge586" class="edge">
<title>l2_mlp_h2_4h_gpu4&#45;&gt;l2_mlp_4h2_h_gpu4</title>
<path fill="none" stroke="black" d="M1923.53,-6065.23C1923.98,-6056.68 1924.46,-6047.69 1924.93,-6038.9"/>
<polygon fill="black" stroke="black" points="1928.44,-6038.87 1925.48,-6028.7 1921.45,-6038.5 1928.44,-6038.87"/>
</g>
<!-- l3_qkv_gpu4 -->
<g id="node917" class="node">
<title>l3_qkv_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1931" cy="-5826.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1931" y="-5845.05" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="1931" y="-5830.05" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1931" y="-5815.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1931" y="-5800.05" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_mlp_4h2_h_gpu4&#45;&gt;l3_qkv_gpu4 -->
<g id="edge1733" class="edge">
<title>l2_mlp_4h2_h_gpu4&#45;&gt;l3_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1928.93,-5932.1C1929.23,-5917.07 1929.56,-5900.29 1929.87,-5884.63"/>
<polygon fill="black" stroke="black" points="1933.37,-5884.6 1930.07,-5874.53 1926.37,-5884.46 1933.37,-5884.6"/>
</g>
<!-- l2_mlp_4h2_h_gpu5 -->
<g id="node636" class="node">
<title>l2_mlp_4h2_h_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2134" cy="-5980.42" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2134" y="-5999.22" font-family="Times,serif" font-size="14.00">L2 MLP 4h2h</text>
<text text-anchor="middle" x="2134" y="-5984.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2134" y="-5969.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2134" y="-5954.22" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l2_mlp_h2_4h_gpu5&#45;&gt;l2_mlp_4h2_h_gpu5 -->
<g id="edge588" class="edge">
<title>l2_mlp_h2_4h_gpu5&#45;&gt;l2_mlp_4h2_h_gpu5</title>
<path fill="none" stroke="black" d="M2132.72,-6065.23C2132.85,-6056.68 2132.99,-6047.69 2133.12,-6038.9"/>
<polygon fill="black" stroke="black" points="2136.63,-6038.75 2133.28,-6028.7 2129.63,-6038.65 2136.63,-6038.75"/>
</g>
<!-- l3_qkv_gpu5 -->
<g id="node918" class="node">
<title>l3_qkv_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2137" cy="-5826.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2137" y="-5845.05" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="2137" y="-5830.05" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2137" y="-5815.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2137" y="-5800.05" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_mlp_4h2_h_gpu5&#45;&gt;l3_qkv_gpu5 -->
<g id="edge1734" class="edge">
<title>l2_mlp_4h2_h_gpu5&#45;&gt;l3_qkv_gpu5</title>
<path fill="none" stroke="black" d="M2134.93,-5932.1C2135.23,-5917.07 2135.56,-5900.29 2135.87,-5884.63"/>
<polygon fill="black" stroke="black" points="2139.37,-5884.6 2136.07,-5874.53 2132.37,-5884.46 2139.37,-5884.6"/>
</g>
<!-- l2_mlp_4h2_h_gpu6 -->
<g id="node638" class="node">
<title>l2_mlp_4h2_h_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2340" cy="-5980.42" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2340" y="-5999.22" font-family="Times,serif" font-size="14.00">L2 MLP 4h2h</text>
<text text-anchor="middle" x="2340" y="-5984.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2340" y="-5969.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2340" y="-5954.22" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l2_mlp_h2_4h_gpu6&#45;&gt;l2_mlp_4h2_h_gpu6 -->
<g id="edge590" class="edge">
<title>l2_mlp_h2_4h_gpu6&#45;&gt;l2_mlp_4h2_h_gpu6</title>
<path fill="none" stroke="black" d="M2338.72,-6065.23C2338.85,-6056.68 2338.99,-6047.69 2339.12,-6038.9"/>
<polygon fill="black" stroke="black" points="2342.63,-6038.75 2339.28,-6028.7 2335.63,-6038.65 2342.63,-6038.75"/>
</g>
<!-- l3_qkv_gpu6 -->
<g id="node919" class="node">
<title>l3_qkv_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2341" cy="-5826.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2341" y="-5845.05" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="2341" y="-5830.05" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2341" y="-5815.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2341" y="-5800.05" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_mlp_4h2_h_gpu6&#45;&gt;l3_qkv_gpu6 -->
<g id="edge1735" class="edge">
<title>l2_mlp_4h2_h_gpu6&#45;&gt;l3_qkv_gpu6</title>
<path fill="none" stroke="black" d="M2340.31,-5932.1C2340.41,-5917.07 2340.52,-5900.29 2340.62,-5884.63"/>
<polygon fill="black" stroke="black" points="2344.12,-5884.55 2340.69,-5874.53 2337.12,-5884.51 2344.12,-5884.55"/>
</g>
<!-- l2_mlp_4h2_h_gpu7 -->
<g id="node640" class="node">
<title>l2_mlp_4h2_h_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2543" cy="-5980.42" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2543" y="-5999.22" font-family="Times,serif" font-size="14.00">L2 MLP 4h2h</text>
<text text-anchor="middle" x="2543" y="-5984.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2543" y="-5969.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2543" y="-5954.22" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l2_mlp_h2_4h_gpu7&#45;&gt;l2_mlp_4h2_h_gpu7 -->
<g id="edge592" class="edge">
<title>l2_mlp_h2_4h_gpu7&#45;&gt;l2_mlp_4h2_h_gpu7</title>
<path fill="none" stroke="black" d="M2543,-6065.23C2543,-6056.68 2543,-6047.69 2543,-6038.9"/>
<polygon fill="black" stroke="black" points="2546.5,-6038.7 2543,-6028.7 2539.5,-6038.7 2546.5,-6038.7"/>
</g>
<!-- l3_qkv_gpu7 -->
<g id="node920" class="node">
<title>l3_qkv_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2543" cy="-5826.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2543" y="-5845.05" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="2543" y="-5830.05" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2543" y="-5815.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2543" y="-5800.05" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_mlp_4h2_h_gpu7&#45;&gt;l3_qkv_gpu7 -->
<g id="edge1736" class="edge">
<title>l2_mlp_4h2_h_gpu7&#45;&gt;l3_qkv_gpu7</title>
<path fill="none" stroke="black" d="M2543,-5932.1C2543,-5917.07 2543,-5900.29 2543,-5884.63"/>
<polygon fill="black" stroke="black" points="2546.5,-5884.53 2543,-5874.53 2539.5,-5884.53 2546.5,-5884.53"/>
</g>
<!-- l2_mlp_4h2_h_gpu8 -->
<g id="node642" class="node">
<title>l2_mlp_4h2_h_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2746" cy="-5980.42" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2746" y="-5999.22" font-family="Times,serif" font-size="14.00">L2 MLP 4h2h</text>
<text text-anchor="middle" x="2746" y="-5984.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2746" y="-5969.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2746" y="-5954.22" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l2_mlp_h2_4h_gpu8&#45;&gt;l2_mlp_4h2_h_gpu8 -->
<g id="edge594" class="edge">
<title>l2_mlp_h2_4h_gpu8&#45;&gt;l2_mlp_4h2_h_gpu8</title>
<path fill="none" stroke="black" d="M2746,-6065.23C2746,-6056.68 2746,-6047.69 2746,-6038.9"/>
<polygon fill="black" stroke="black" points="2749.5,-6038.7 2746,-6028.7 2742.5,-6038.7 2749.5,-6038.7"/>
</g>
<!-- l3_qkv_gpu8 -->
<g id="node921" class="node">
<title>l3_qkv_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2745" cy="-5826.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2745" y="-5845.05" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="2745" y="-5830.05" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2745" y="-5815.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2745" y="-5800.05" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_mlp_4h2_h_gpu8&#45;&gt;l3_qkv_gpu8 -->
<g id="edge1737" class="edge">
<title>l2_mlp_4h2_h_gpu8&#45;&gt;l3_qkv_gpu8</title>
<path fill="none" stroke="black" d="M2745.69,-5932.1C2745.59,-5917.07 2745.48,-5900.29 2745.38,-5884.63"/>
<polygon fill="black" stroke="black" points="2748.88,-5884.51 2745.31,-5874.53 2741.88,-5884.55 2748.88,-5884.51"/>
</g>
<!-- l2_mlp_4h2_h_gpu9 -->
<g id="node644" class="node">
<title>l2_mlp_4h2_h_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2948" cy="-5980.42" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2948" y="-5999.22" font-family="Times,serif" font-size="14.00">L2 MLP 4h2h</text>
<text text-anchor="middle" x="2948" y="-5984.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2948" y="-5969.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2948" y="-5954.22" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l2_mlp_h2_4h_gpu9&#45;&gt;l2_mlp_4h2_h_gpu9 -->
<g id="edge596" class="edge">
<title>l2_mlp_h2_4h_gpu9&#45;&gt;l2_mlp_4h2_h_gpu9</title>
<path fill="none" stroke="black" d="M2949.28,-6065.23C2949.15,-6056.68 2949.01,-6047.69 2948.88,-6038.9"/>
<polygon fill="black" stroke="black" points="2952.37,-6038.65 2948.72,-6028.7 2945.37,-6038.75 2952.37,-6038.65"/>
</g>
<!-- l3_qkv_gpu9 -->
<g id="node922" class="node">
<title>l3_qkv_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2947" cy="-5826.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2947" y="-5845.05" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="2947" y="-5830.05" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2947" y="-5815.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2947" y="-5800.05" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_mlp_4h2_h_gpu9&#45;&gt;l3_qkv_gpu9 -->
<g id="edge1738" class="edge">
<title>l2_mlp_4h2_h_gpu9&#45;&gt;l3_qkv_gpu9</title>
<path fill="none" stroke="black" d="M2947.69,-5932.1C2947.59,-5917.07 2947.48,-5900.29 2947.38,-5884.63"/>
<polygon fill="black" stroke="black" points="2950.88,-5884.51 2947.31,-5874.53 2943.88,-5884.55 2950.88,-5884.51"/>
</g>
<!-- l2_mlp_4h2_h_gpu10 -->
<g id="node646" class="node">
<title>l2_mlp_4h2_h_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3150" cy="-5980.42" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3150" y="-5999.22" font-family="Times,serif" font-size="14.00">L2 MLP 4h2h</text>
<text text-anchor="middle" x="3150" y="-5984.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3150" y="-5969.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3150" y="-5954.22" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l2_mlp_h2_4h_gpu10&#45;&gt;l2_mlp_4h2_h_gpu10 -->
<g id="edge598" class="edge">
<title>l2_mlp_h2_4h_gpu10&#45;&gt;l2_mlp_4h2_h_gpu10</title>
<path fill="none" stroke="black" d="M3153.83,-6065.23C3153.44,-6056.68 3153.03,-6047.69 3152.63,-6038.9"/>
<polygon fill="black" stroke="black" points="3156.12,-6038.53 3152.16,-6028.7 3149.12,-6038.85 3156.12,-6038.53"/>
</g>
<!-- l3_qkv_gpu10 -->
<g id="node923" class="node">
<title>l3_qkv_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3149" cy="-5826.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3149" y="-5845.05" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="3149" y="-5830.05" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3149" y="-5815.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3149" y="-5800.05" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_mlp_4h2_h_gpu10&#45;&gt;l3_qkv_gpu10 -->
<g id="edge1739" class="edge">
<title>l2_mlp_4h2_h_gpu10&#45;&gt;l3_qkv_gpu10</title>
<path fill="none" stroke="black" d="M3149.69,-5932.1C3149.59,-5917.07 3149.48,-5900.29 3149.38,-5884.63"/>
<polygon fill="black" stroke="black" points="3152.88,-5884.51 3149.31,-5874.53 3145.88,-5884.55 3152.88,-5884.51"/>
</g>
<!-- l2_mlp_4h2_h_gpu11 -->
<g id="node648" class="node">
<title>l2_mlp_4h2_h_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3353" cy="-5980.42" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3353" y="-5999.22" font-family="Times,serif" font-size="14.00">L2 MLP 4h2h</text>
<text text-anchor="middle" x="3353" y="-5984.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3353" y="-5969.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3353" y="-5954.22" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l2_mlp_h2_4h_gpu11&#45;&gt;l2_mlp_4h2_h_gpu11 -->
<g id="edge600" class="edge">
<title>l2_mlp_h2_4h_gpu11&#45;&gt;l2_mlp_4h2_h_gpu11</title>
<path fill="none" stroke="black" d="M3358.11,-6065.23C3357.59,-6056.68 3357.04,-6047.69 3356.51,-6038.9"/>
<polygon fill="black" stroke="black" points="3359.99,-6038.47 3355.88,-6028.7 3353,-6038.89 3359.99,-6038.47"/>
</g>
<!-- l3_qkv_gpu11 -->
<g id="node924" class="node">
<title>l3_qkv_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3351" cy="-5826.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3351" y="-5845.05" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="3351" y="-5830.05" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3351" y="-5815.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3351" y="-5800.05" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_mlp_4h2_h_gpu11&#45;&gt;l3_qkv_gpu11 -->
<g id="edge1740" class="edge">
<title>l2_mlp_4h2_h_gpu11&#45;&gt;l3_qkv_gpu11</title>
<path fill="none" stroke="black" d="M3352.38,-5932.1C3352.18,-5917.07 3351.96,-5900.29 3351.75,-5884.63"/>
<polygon fill="black" stroke="black" points="3355.25,-5884.49 3351.62,-5874.53 3348.25,-5884.58 3355.25,-5884.49"/>
</g>
<!-- l2_mlp_4h2_h_gpu12 -->
<g id="node650" class="node">
<title>l2_mlp_4h2_h_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3557" cy="-5980.42" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3557" y="-5999.22" font-family="Times,serif" font-size="14.00">L2 MLP 4h2h</text>
<text text-anchor="middle" x="3557" y="-5984.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3557" y="-5969.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3557" y="-5954.22" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l2_mlp_h2_4h_gpu12&#45;&gt;l2_mlp_4h2_h_gpu12 -->
<g id="edge602" class="edge">
<title>l2_mlp_h2_4h_gpu12&#45;&gt;l2_mlp_4h2_h_gpu12</title>
<path fill="none" stroke="black" d="M3562.11,-6065.23C3561.59,-6056.68 3561.04,-6047.69 3560.51,-6038.9"/>
<polygon fill="black" stroke="black" points="3563.99,-6038.47 3559.88,-6028.7 3557,-6038.89 3563.99,-6038.47"/>
</g>
<!-- l3_qkv_gpu12 -->
<g id="node925" class="node">
<title>l3_qkv_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3553" cy="-5826.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3553" y="-5845.05" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="3553" y="-5830.05" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3553" y="-5815.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3553" y="-5800.05" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_mlp_4h2_h_gpu12&#45;&gt;l3_qkv_gpu12 -->
<g id="edge1741" class="edge">
<title>l2_mlp_4h2_h_gpu12&#45;&gt;l3_qkv_gpu12</title>
<path fill="none" stroke="black" d="M3555.76,-5932.1C3555.36,-5917.07 3554.92,-5900.29 3554.51,-5884.63"/>
<polygon fill="black" stroke="black" points="3558,-5884.44 3554.24,-5874.53 3551.01,-5884.62 3558,-5884.44"/>
</g>
<!-- l2_mlp_4h2_h_gpu13 -->
<g id="node652" class="node">
<title>l2_mlp_4h2_h_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3760" cy="-5980.42" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3760" y="-5999.22" font-family="Times,serif" font-size="14.00">L2 MLP 4h2h</text>
<text text-anchor="middle" x="3760" y="-5984.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3760" y="-5969.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3760" y="-5954.22" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l2_mlp_h2_4h_gpu13&#45;&gt;l2_mlp_4h2_h_gpu13 -->
<g id="edge604" class="edge">
<title>l2_mlp_h2_4h_gpu13&#45;&gt;l2_mlp_4h2_h_gpu13</title>
<path fill="none" stroke="black" d="M3766.39,-6065.23C3765.74,-6056.68 3765.05,-6047.69 3764.38,-6038.9"/>
<polygon fill="black" stroke="black" points="3767.86,-6038.41 3763.6,-6028.7 3760.88,-6038.94 3767.86,-6038.41"/>
</g>
<!-- l3_qkv_gpu13 -->
<g id="node926" class="node">
<title>l3_qkv_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3755" cy="-5826.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3755" y="-5845.05" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="3755" y="-5830.05" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3755" y="-5815.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3755" y="-5800.05" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_mlp_4h2_h_gpu13&#45;&gt;l3_qkv_gpu13 -->
<g id="edge1742" class="edge">
<title>l2_mlp_4h2_h_gpu13&#45;&gt;l3_qkv_gpu13</title>
<path fill="none" stroke="black" d="M3758.45,-5932.1C3757.95,-5917.07 3757.4,-5900.29 3756.89,-5884.63"/>
<polygon fill="black" stroke="black" points="3760.38,-5884.41 3756.55,-5874.53 3753.38,-5884.64 3760.38,-5884.41"/>
</g>
<!-- l2_mlp_4h2_h_gpu14 -->
<g id="node654" class="node">
<title>l2_mlp_4h2_h_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3963" cy="-5980.42" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3963" y="-5999.22" font-family="Times,serif" font-size="14.00">L2 MLP 4h2h</text>
<text text-anchor="middle" x="3963" y="-5984.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3963" y="-5969.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3963" y="-5954.22" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l2_mlp_h2_4h_gpu14&#45;&gt;l2_mlp_4h2_h_gpu14 -->
<g id="edge606" class="edge">
<title>l2_mlp_h2_4h_gpu14&#45;&gt;l2_mlp_4h2_h_gpu14</title>
<path fill="none" stroke="black" d="M3972.58,-6065.23C3971.61,-6056.68 3970.58,-6047.69 3969.57,-6038.9"/>
<polygon fill="black" stroke="black" points="3973.02,-6038.24 3968.41,-6028.7 3966.07,-6039.03 3973.02,-6038.24"/>
</g>
<!-- l3_qkv_gpu14 -->
<g id="node927" class="node">
<title>l3_qkv_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3957" cy="-5826.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3957" y="-5845.05" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="3957" y="-5830.05" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3957" y="-5815.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3957" y="-5800.05" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_mlp_4h2_h_gpu14&#45;&gt;l3_qkv_gpu14 -->
<g id="edge1743" class="edge">
<title>l2_mlp_4h2_h_gpu14&#45;&gt;l3_qkv_gpu14</title>
<path fill="none" stroke="black" d="M3961.13,-5932.1C3960.54,-5917.07 3959.88,-5900.29 3959.26,-5884.63"/>
<polygon fill="black" stroke="black" points="3962.76,-5884.39 3958.86,-5874.53 3955.76,-5884.66 3962.76,-5884.39"/>
</g>
<!-- l2_mlp_4h2_h_gpu15 -->
<g id="node656" class="node">
<title>l2_mlp_4h2_h_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4168" cy="-5980.42" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="4168" y="-5999.22" font-family="Times,serif" font-size="14.00">L2 MLP 4h2h</text>
<text text-anchor="middle" x="4168" y="-5984.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4168" y="-5969.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="4168" y="-5954.22" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l2_mlp_h2_4h_gpu15&#45;&gt;l2_mlp_4h2_h_gpu15 -->
<g id="edge608" class="edge">
<title>l2_mlp_h2_4h_gpu15&#45;&gt;l2_mlp_4h2_h_gpu15</title>
<path fill="none" stroke="black" d="M4178.22,-6065.23C4177.18,-6056.68 4176.08,-6047.69 4175.01,-6038.9"/>
<polygon fill="black" stroke="black" points="4178.45,-6038.2 4173.77,-6028.7 4171.5,-6039.05 4178.45,-6038.2"/>
</g>
<!-- l3_qkv_gpu15 -->
<g id="node928" class="node">
<title>l3_qkv_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4159" cy="-5826.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="4159" y="-5845.05" font-family="Times,serif" font-size="14.00">L3 QKV Proj</text>
<text text-anchor="middle" x="4159" y="-5830.05" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4159" y="-5815.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="4159" y="-5800.05" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l2_mlp_4h2_h_gpu15&#45;&gt;l3_qkv_gpu15 -->
<g id="edge1744" class="edge">
<title>l2_mlp_4h2_h_gpu15&#45;&gt;l3_qkv_gpu15</title>
<path fill="none" stroke="black" d="M4165.2,-5932.1C4164.31,-5917.07 4163.32,-5900.29 4162.39,-5884.63"/>
<polygon fill="black" stroke="black" points="4165.88,-5884.31 4161.8,-5874.53 4158.89,-5884.72 4165.88,-5884.31"/>
</g>
<!-- l3_attn_stage0_gpu0 -->
<g id="node657" class="node">
<title>l3_attn_stage0_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1230" cy="-5682.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1230" y="-5693.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="1230" y="-5678.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1230" y="-5663.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu0 -->
<g id="node673" class="node">
<title>l3_attn_stage1_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1230" cy="-5535.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1230" y="-5546.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="1230" y="-5531.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1230" y="-5516.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu0&#45;&gt;l3_attn_stage1_gpu0 -->
<g id="edge625" class="edge">
<title>l3_attn_stage0_gpu0&#45;&gt;l3_attn_stage1_gpu0</title>
<path fill="none" stroke="black" d="M1230,-5645.08C1230,-5626.36 1230,-5603.37 1230,-5583.38"/>
<polygon fill="black" stroke="black" points="1233.5,-5583.24 1230,-5573.24 1226.5,-5583.24 1233.5,-5583.24"/>
</g>
<!-- l3_attn_stage1_gpu[next_gpu] -->
<g id="node1343" class="node">
<title>l3_attn_stage1_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4417" cy="-5535.67" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4417" y="-5531.97" font-family="Times,serif" font-size="14.00">l3_attn_stage1_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage0_gpu0&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge1745" class="edge">
<title>l3_attn_stage0_gpu0&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1283.29,-5652.67C1297.43,-5646.33 1312.95,-5640.52 1328,-5637.17 1557.73,-5586.03 3210.66,-5614.72 3446,-5612.17 3490.94,-5611.68 4210.97,-5613.2 4255,-5604.17 4298.87,-5595.17 4345.77,-5574.25 4377.76,-5558.06"/>
<polygon fill="red" stroke="red" points="4379.49,-5561.11 4386.78,-5553.43 4376.28,-5554.89 4379.49,-5561.11"/>
<text text-anchor="middle" x="3477.5" y="-5615.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu1 -->
<g id="node658" class="node">
<title>l3_attn_stage0_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1425" cy="-5682.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1425" y="-5693.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="1425" y="-5678.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1425" y="-5663.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu1 -->
<g id="node674" class="node">
<title>l3_attn_stage1_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1425" cy="-5535.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1425" y="-5546.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="1425" y="-5531.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1425" y="-5516.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu1&#45;&gt;l3_attn_stage1_gpu1 -->
<g id="edge626" class="edge">
<title>l3_attn_stage0_gpu1&#45;&gt;l3_attn_stage1_gpu1</title>
<path fill="none" stroke="black" d="M1425,-5645.08C1425,-5626.36 1425,-5603.37 1425,-5583.38"/>
<polygon fill="black" stroke="black" points="1428.5,-5583.24 1425,-5573.24 1421.5,-5583.24 1428.5,-5583.24"/>
</g>
<!-- l3_attn_stage0_gpu1&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge1746" class="edge">
<title>l3_attn_stage0_gpu1&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1478.28,-5652.6C1492.41,-5646.26 1507.94,-5640.46 1523,-5637.17 1577,-5625.34 3460.82,-5645.43 3513,-5627.17 3523.15,-5623.61 3521.86,-5615.75 3532,-5612.17 3569.87,-5598.78 4215.66,-5612.26 4255,-5604.17 4298.87,-5595.14 4345.77,-5574.23 4377.76,-5558.05"/>
<polygon fill="red" stroke="red" points="4379.48,-5561.1 4386.78,-5553.41 4376.28,-5554.87 4379.48,-5561.1"/>
<text text-anchor="middle" x="3563.5" y="-5615.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu2 -->
<g id="node659" class="node">
<title>l3_attn_stage0_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1620" cy="-5682.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1620" y="-5693.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="1620" y="-5678.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1620" y="-5663.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu2 -->
<g id="node675" class="node">
<title>l3_attn_stage1_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1620" cy="-5535.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1620" y="-5546.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="1620" y="-5531.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1620" y="-5516.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu2&#45;&gt;l3_attn_stage1_gpu2 -->
<g id="edge627" class="edge">
<title>l3_attn_stage0_gpu2&#45;&gt;l3_attn_stage1_gpu2</title>
<path fill="none" stroke="black" d="M1620,-5645.08C1620,-5626.36 1620,-5603.37 1620,-5583.38"/>
<polygon fill="black" stroke="black" points="1623.5,-5583.24 1620,-5573.24 1616.5,-5583.24 1623.5,-5583.24"/>
</g>
<!-- l3_attn_stage0_gpu2&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge1747" class="edge">
<title>l3_attn_stage0_gpu2&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1673.28,-5652.6C1687.41,-5646.26 1702.94,-5640.47 1718,-5637.17 1769.04,-5625.98 3549.68,-5644.43 3599,-5627.17 3609.15,-5623.61 3607.86,-5615.76 3618,-5612.17 3651.36,-5600.35 4220.34,-5611.32 4255,-5604.17 4298.86,-5595.11 4345.76,-5574.2 4377.75,-5558.03"/>
<polygon fill="red" stroke="red" points="4379.48,-5561.08 4386.77,-5553.4 4376.28,-5554.85 4379.48,-5561.08"/>
<text text-anchor="middle" x="3649.5" y="-5615.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu3 -->
<g id="node660" class="node">
<title>l3_attn_stage0_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1815" cy="-5682.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1815" y="-5693.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="1815" y="-5678.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1815" y="-5663.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu3 -->
<g id="node676" class="node">
<title>l3_attn_stage1_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1815" cy="-5535.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1815" y="-5546.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="1815" y="-5531.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1815" y="-5516.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu3&#45;&gt;l3_attn_stage1_gpu3 -->
<g id="edge628" class="edge">
<title>l3_attn_stage0_gpu3&#45;&gt;l3_attn_stage1_gpu3</title>
<path fill="none" stroke="black" d="M1815,-5645.08C1815,-5626.36 1815,-5603.37 1815,-5583.38"/>
<polygon fill="black" stroke="black" points="1818.5,-5583.24 1815,-5573.24 1811.5,-5583.24 1818.5,-5583.24"/>
</g>
<!-- l3_attn_stage0_gpu3&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge1748" class="edge">
<title>l3_attn_stage0_gpu3&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1868.28,-5652.6C1882.41,-5646.26 1897.94,-5640.47 1913,-5637.17 1961.08,-5626.62 3638.55,-5643.44 3685,-5627.17 3695.15,-5623.61 3693.86,-5615.77 3704,-5612.17 3732.85,-5601.92 4225.02,-5610.39 4255,-5604.17 4298.85,-5595.06 4345.75,-5574.16 4377.75,-5558.01"/>
<polygon fill="red" stroke="red" points="4379.47,-5561.06 4386.77,-5553.38 4376.27,-5554.83 4379.47,-5561.06"/>
<text text-anchor="middle" x="3735.5" y="-5615.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu4 -->
<g id="node661" class="node">
<title>l3_attn_stage0_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2010" cy="-5682.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2010" y="-5693.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="2010" y="-5678.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2010" y="-5663.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu4 -->
<g id="node677" class="node">
<title>l3_attn_stage1_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2010" cy="-5535.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2010" y="-5546.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="2010" y="-5531.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2010" y="-5516.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu4&#45;&gt;l3_attn_stage1_gpu4 -->
<g id="edge629" class="edge">
<title>l3_attn_stage0_gpu4&#45;&gt;l3_attn_stage1_gpu4</title>
<path fill="none" stroke="black" d="M2010,-5645.08C2010,-5626.36 2010,-5603.37 2010,-5583.38"/>
<polygon fill="black" stroke="black" points="2013.5,-5583.24 2010,-5573.24 2006.5,-5583.24 2013.5,-5583.24"/>
</g>
<!-- l3_attn_stage0_gpu4&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge1749" class="edge">
<title>l3_attn_stage0_gpu4&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2063.28,-5652.61C2077.41,-5646.27 2092.94,-5640.47 2108,-5637.17 2153.12,-5627.26 3727.41,-5642.45 3771,-5627.17 3781.15,-5623.61 3779.87,-5615.78 3790,-5612.17 3838.67,-5594.8 4204.42,-5614.74 4255,-5604.17 4298.84,-5595 4345.74,-5574.11 4377.74,-5557.98"/>
<polygon fill="red" stroke="red" points="4379.46,-5561.03 4386.76,-5553.35 4376.27,-5554.8 4379.46,-5561.03"/>
<text text-anchor="middle" x="3821.5" y="-5615.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu5 -->
<g id="node662" class="node">
<title>l3_attn_stage0_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2205" cy="-5682.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2205" y="-5693.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="2205" y="-5678.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2205" y="-5663.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu5 -->
<g id="node678" class="node">
<title>l3_attn_stage1_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2205" cy="-5535.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2205" y="-5546.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="2205" y="-5531.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2205" y="-5516.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu5&#45;&gt;l3_attn_stage1_gpu5 -->
<g id="edge630" class="edge">
<title>l3_attn_stage0_gpu5&#45;&gt;l3_attn_stage1_gpu5</title>
<path fill="none" stroke="black" d="M2205,-5645.08C2205,-5626.36 2205,-5603.37 2205,-5583.38"/>
<polygon fill="black" stroke="black" points="2208.5,-5583.24 2205,-5573.24 2201.5,-5583.24 2208.5,-5583.24"/>
</g>
<!-- l3_attn_stage0_gpu5&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge1750" class="edge">
<title>l3_attn_stage0_gpu5&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2258.28,-5652.61C2272.41,-5646.27 2287.94,-5640.47 2303,-5637.17 2345.16,-5627.9 3816.27,-5641.45 3857,-5627.17 3867.15,-5623.6 3865.87,-5615.8 3876,-5612.17 3915.64,-5597.93 4213.79,-5612.86 4255,-5604.17 4298.82,-5594.92 4345.73,-5574.04 4377.73,-5557.93"/>
<polygon fill="red" stroke="red" points="4379.45,-5560.98 4386.75,-5553.32 4376.26,-5554.75 4379.45,-5560.98"/>
<text text-anchor="middle" x="3907.5" y="-5615.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu6 -->
<g id="node663" class="node">
<title>l3_attn_stage0_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2400" cy="-5682.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2400" y="-5693.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="2400" y="-5678.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2400" y="-5663.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu6 -->
<g id="node679" class="node">
<title>l3_attn_stage1_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2400" cy="-5535.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2400" y="-5546.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="2400" y="-5531.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2400" y="-5516.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu6&#45;&gt;l3_attn_stage1_gpu6 -->
<g id="edge631" class="edge">
<title>l3_attn_stage0_gpu6&#45;&gt;l3_attn_stage1_gpu6</title>
<path fill="none" stroke="black" d="M2400,-5645.08C2400,-5626.36 2400,-5603.37 2400,-5583.38"/>
<polygon fill="black" stroke="black" points="2403.5,-5583.24 2400,-5573.24 2396.5,-5583.24 2403.5,-5583.24"/>
</g>
<!-- l3_attn_stage0_gpu6&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge1751" class="edge">
<title>l3_attn_stage0_gpu6&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2453.28,-5652.62C2467.41,-5646.28 2482.94,-5640.48 2498,-5637.17 2537.2,-5628.54 3905.13,-5640.46 3943,-5627.17 3953.15,-5623.6 3951.89,-5615.83 3962,-5612.17 3992.62,-5601.07 4223.15,-5610.99 4255,-5604.17 4298.66,-5594.81 4345.41,-5574.05 4377.42,-5558.01"/>
<polygon fill="red" stroke="red" points="4379.12,-5561.06 4386.45,-5553.41 4375.95,-5554.83 4379.12,-5561.06"/>
<text text-anchor="middle" x="3993.5" y="-5615.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu7 -->
<g id="node664" class="node">
<title>l3_attn_stage0_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2595" cy="-5682.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2595" y="-5693.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="2595" y="-5678.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2595" y="-5663.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu7 -->
<g id="node680" class="node">
<title>l3_attn_stage1_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2595" cy="-5535.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2595" y="-5546.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="2595" y="-5531.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2595" y="-5516.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu7&#45;&gt;l3_attn_stage1_gpu7 -->
<g id="edge632" class="edge">
<title>l3_attn_stage0_gpu7&#45;&gt;l3_attn_stage1_gpu7</title>
<path fill="none" stroke="black" d="M2595,-5645.08C2595,-5626.36 2595,-5603.37 2595,-5583.38"/>
<polygon fill="black" stroke="black" points="2598.5,-5583.24 2595,-5573.24 2591.5,-5583.24 2598.5,-5583.24"/>
</g>
<!-- l3_attn_stage0_gpu7&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge1752" class="edge">
<title>l3_attn_stage0_gpu7&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2648.28,-5652.62C2662.42,-5646.28 2677.95,-5640.48 2693,-5637.17 2729.24,-5629.18 3993.99,-5639.47 4029,-5627.17 4039.15,-5623.6 4037.91,-5615.89 4048,-5612.17 4091.19,-5596.23 4210.04,-5614.06 4255,-5604.17 4298.6,-5594.57 4345.37,-5573.84 4377.39,-5557.87"/>
<polygon fill="red" stroke="red" points="4379.08,-5560.94 4386.42,-5553.3 4375.92,-5554.69 4379.08,-5560.94"/>
<text text-anchor="middle" x="4079.5" y="-5615.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu8 -->
<g id="node665" class="node">
<title>l3_attn_stage0_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2790" cy="-5682.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2790" y="-5693.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="2790" y="-5678.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2790" y="-5663.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu8 -->
<g id="node681" class="node">
<title>l3_attn_stage1_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2790" cy="-5535.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2790" y="-5546.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="2790" y="-5531.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2790" y="-5516.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu8&#45;&gt;l3_attn_stage1_gpu8 -->
<g id="edge633" class="edge">
<title>l3_attn_stage0_gpu8&#45;&gt;l3_attn_stage1_gpu8</title>
<path fill="none" stroke="black" d="M2790,-5645.08C2790,-5626.36 2790,-5603.37 2790,-5583.38"/>
<polygon fill="black" stroke="black" points="2793.5,-5583.24 2790,-5573.24 2786.5,-5583.24 2793.5,-5583.24"/>
</g>
<!-- l3_attn_stage0_gpu8&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge1753" class="edge">
<title>l3_attn_stage0_gpu8&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2843.28,-5652.63C2857.42,-5646.29 2872.95,-5640.49 2888,-5637.17 2954.57,-5622.48 4050.69,-5649.78 4115,-5627.17 4125.15,-5623.6 4123.96,-5616.03 4134,-5612.17 4184.3,-5592.82 4202.53,-5616.47 4255,-5604.17 4298.2,-5594.03 4344.67,-5573.59 4376.71,-5557.84"/>
<polygon fill="red" stroke="red" points="4378.38,-5560.92 4385.77,-5553.33 4375.25,-5554.66 4378.38,-5560.92"/>
<text text-anchor="middle" x="4165.5" y="-5615.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu9 -->
<g id="node666" class="node">
<title>l3_attn_stage0_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2985" cy="-5682.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2985" y="-5693.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="2985" y="-5678.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2985" y="-5663.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu9 -->
<g id="node682" class="node">
<title>l3_attn_stage1_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2985" cy="-5535.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2985" y="-5546.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="2985" y="-5531.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2985" y="-5516.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu9&#45;&gt;l3_attn_stage1_gpu9 -->
<g id="edge634" class="edge">
<title>l3_attn_stage0_gpu9&#45;&gt;l3_attn_stage1_gpu9</title>
<path fill="none" stroke="black" d="M2985,-5645.08C2985,-5626.36 2985,-5603.37 2985,-5583.38"/>
<polygon fill="black" stroke="black" points="2988.5,-5583.24 2985,-5573.24 2981.5,-5583.24 2988.5,-5583.24"/>
</g>
<!-- l3_attn_stage0_gpu9&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge1754" class="edge">
<title>l3_attn_stage0_gpu9&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3038.28,-5652.64C3052.42,-5646.3 3067.95,-5640.49 3083,-5637.17 3143.65,-5623.76 4142.41,-5647.8 4201,-5627.17 4211.15,-5623.59 4210.3,-5616.81 4220,-5612.17 4234.39,-5605.28 4239.8,-5609.03 4255,-5604.17 4295.94,-5591.06 4340.95,-5571.9 4373.12,-5557.34"/>
<polygon fill="red" stroke="red" points="4374.61,-5560.51 4382.25,-5553.17 4371.7,-5554.14 4374.61,-5560.51"/>
<text text-anchor="middle" x="4251.5" y="-5615.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu10 -->
<g id="node667" class="node">
<title>l3_attn_stage0_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3180" cy="-5682.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3180" y="-5693.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="3180" y="-5678.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3180" y="-5663.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu10 -->
<g id="node683" class="node">
<title>l3_attn_stage1_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3180" cy="-5535.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3180" y="-5546.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="3180" y="-5531.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3180" y="-5516.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu10&#45;&gt;l3_attn_stage1_gpu10 -->
<g id="edge635" class="edge">
<title>l3_attn_stage0_gpu10&#45;&gt;l3_attn_stage1_gpu10</title>
<path fill="none" stroke="black" d="M3180,-5645.08C3180,-5626.36 3180,-5603.37 3180,-5583.38"/>
<polygon fill="black" stroke="black" points="3183.5,-5583.24 3180,-5573.24 3176.5,-5583.24 3183.5,-5583.24"/>
</g>
<!-- l3_attn_stage0_gpu10&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge1755" class="edge">
<title>l3_attn_stage0_gpu10&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3233.29,-5652.65C3247.42,-5646.31 3262.95,-5640.5 3278,-5637.17 3332.73,-5625.04 4234.13,-5645.81 4287,-5627.17 4297.15,-5623.59 4297.32,-5618.53 4306,-5612.17 4331.22,-5593.67 4360.5,-5573.82 4382.65,-5559.12"/>
<polygon fill="red" stroke="red" points="4384.66,-5561.99 4391.07,-5553.55 4380.8,-5556.15 4384.66,-5561.99"/>
<text text-anchor="middle" x="4337.5" y="-5615.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu11 -->
<g id="node668" class="node">
<title>l3_attn_stage0_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3375" cy="-5682.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3375" y="-5693.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="3375" y="-5678.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3375" y="-5663.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu11 -->
<g id="node684" class="node">
<title>l3_attn_stage1_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3375" cy="-5535.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3375" y="-5546.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="3375" y="-5531.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3375" y="-5516.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu11&#45;&gt;l3_attn_stage1_gpu11 -->
<g id="edge636" class="edge">
<title>l3_attn_stage0_gpu11&#45;&gt;l3_attn_stage1_gpu11</title>
<path fill="none" stroke="black" d="M3375,-5645.08C3375,-5626.36 3375,-5603.37 3375,-5583.38"/>
<polygon fill="black" stroke="black" points="3378.5,-5583.24 3375,-5573.24 3371.5,-5583.24 3378.5,-5583.24"/>
</g>
<!-- l3_attn_stage0_gpu11&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge1756" class="edge">
<title>l3_attn_stage0_gpu11&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3428.29,-5652.66C3442.42,-5646.32 3457.95,-5640.51 3473,-5637.17 3497.41,-5631.74 4351.88,-5640.55 4373,-5627.17 4394.94,-5613.27 4406.24,-5584.99 4411.85,-5563.72"/>
<polygon fill="red" stroke="red" points="4415.27,-5564.47 4414.18,-5553.94 4408.46,-5562.86 4415.27,-5564.47"/>
<text text-anchor="middle" x="4419.5" y="-5615.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu12 -->
<g id="node669" class="node">
<title>l3_attn_stage0_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3570" cy="-5682.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3570" y="-5693.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="3570" y="-5678.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3570" y="-5663.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu12 -->
<g id="node685" class="node">
<title>l3_attn_stage1_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3570" cy="-5535.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3570" y="-5546.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="3570" y="-5531.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3570" y="-5516.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu12&#45;&gt;l3_attn_stage1_gpu12 -->
<g id="edge637" class="edge">
<title>l3_attn_stage0_gpu12&#45;&gt;l3_attn_stage1_gpu12</title>
<path fill="none" stroke="black" d="M3514.85,-5653.2C3501.43,-5647.17 3486.93,-5641.36 3473,-5637.17 3459.22,-5633.01 3418.36,-5638.1 3409,-5627.17 3374.08,-5586.36 3414.79,-5626.49 3473,-5604.17 3490.78,-5597.35 3508.42,-5586.6 3523.68,-5575.67"/>
<polygon fill="black" stroke="black" points="3525.93,-5578.36 3531.9,-5569.6 3521.77,-5572.73 3525.93,-5578.36"/>
</g>
<!-- l3_attn_stage0_gpu12&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge1757" class="edge">
<title>l3_attn_stage0_gpu12&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3623.29,-5652.68C3637.43,-5646.34 3652.95,-5640.52 3668,-5637.17 3689.45,-5632.38 4443.56,-5642.8 4459,-5627.17 4477.16,-5608.78 4459.89,-5581.08 4442.31,-5561.18"/>
<polygon fill="red" stroke="red" points="4444.75,-5558.65 4435.38,-5553.7 4439.61,-5563.41 4444.75,-5558.65"/>
<text text-anchor="middle" x="4497.5" y="-5615.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu13 -->
<g id="node670" class="node">
<title>l3_attn_stage0_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3765" cy="-5682.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3765" y="-5693.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="3765" y="-5678.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3765" y="-5663.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu13 -->
<g id="node686" class="node">
<title>l3_attn_stage1_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3765" cy="-5535.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3765" y="-5546.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="3765" y="-5531.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3765" y="-5516.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu13&#45;&gt;l3_attn_stage1_gpu13 -->
<g id="edge638" class="edge">
<title>l3_attn_stage0_gpu13&#45;&gt;l3_attn_stage1_gpu13</title>
<path fill="none" stroke="black" d="M3711.7,-5652.72C3697.85,-5646.47 3682.69,-5640.68 3668,-5637.17 3654.37,-5633.9 3425.71,-5637.27 3416,-5627.17 3411.38,-5622.36 3411.36,-5616.95 3416,-5612.17 3425.75,-5602.11 3654.7,-5608.57 3668,-5604.17 3686.4,-5598.07 3704.44,-5587.28 3719.87,-5576.08"/>
<polygon fill="black" stroke="black" points="3722.27,-5578.66 3728.16,-5569.85 3718.06,-5573.06 3722.27,-5578.66"/>
</g>
<!-- l3_attn_stage0_gpu13&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge1758" class="edge">
<title>l3_attn_stage0_gpu13&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3818.3,-5652.7C3832.43,-5646.36 3847.96,-5640.54 3863,-5637.17 3881.49,-5633.02 4531.7,-5640.66 4545,-5627.17 4573.36,-5598.39 4525.79,-5572.56 4480.82,-5555.93"/>
<polygon fill="red" stroke="red" points="4481.88,-5552.59 4471.29,-5552.52 4479.53,-5559.18 4481.88,-5552.59"/>
<text text-anchor="middle" x="4584.5" y="-5615.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu14 -->
<g id="node671" class="node">
<title>l3_attn_stage0_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3960" cy="-5682.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3960" y="-5693.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="3960" y="-5678.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3960" y="-5663.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu14 -->
<g id="node687" class="node">
<title>l3_attn_stage1_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3960" cy="-5535.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3960" y="-5546.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="3960" y="-5531.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3960" y="-5516.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu14&#45;&gt;l3_attn_stage1_gpu14 -->
<g id="edge639" class="edge">
<title>l3_attn_stage0_gpu14&#45;&gt;l3_attn_stage1_gpu14</title>
<path fill="none" stroke="black" d="M3906.74,-5652.55C3892.89,-5646.3 3877.71,-5640.56 3863,-5637.17 3839.17,-5631.68 3440.09,-5644.65 3423,-5627.17 3418.34,-5622.4 3418.33,-5616.92 3423,-5612.17 3431.56,-5603.44 3851.37,-5607.93 3863,-5604.17 3881.45,-5598.19 3899.49,-5587.43 3914.92,-5576.23"/>
<polygon fill="black" stroke="black" points="3917.32,-5578.8 3923.2,-5569.99 3913.11,-5573.21 3917.32,-5578.8"/>
</g>
<!-- l3_attn_stage0_gpu14&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge1759" class="edge">
<title>l3_attn_stage0_gpu14&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4013.3,-5652.73C4027.44,-5646.38 4042.96,-5640.56 4058,-5637.17 4073.53,-5633.66 4619.84,-5638.52 4631,-5627.17 4671.03,-5586.43 4601.32,-5563.07 4531.01,-5550.33"/>
<polygon fill="red" stroke="red" points="4531.55,-5546.87 4521.1,-5548.6 4530.35,-5553.76 4531.55,-5546.87"/>
<text text-anchor="middle" x="4671.5" y="-5615.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage0_gpu15 -->
<g id="node672" class="node">
<title>l3_attn_stage0_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4155" cy="-5682.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4155" y="-5693.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage0</text>
<text text-anchor="middle" x="4155" y="-5678.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4155" y="-5663.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu15 -->
<g id="node688" class="node">
<title>l3_attn_stage1_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4155" cy="-5535.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4155" y="-5546.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage1</text>
<text text-anchor="middle" x="4155" y="-5531.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4155" y="-5516.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage0_gpu15&#45;&gt;l3_attn_stage1_gpu15 -->
<g id="edge640" class="edge">
<title>l3_attn_stage0_gpu15&#45;&gt;l3_attn_stage1_gpu15</title>
<path fill="none" stroke="black" d="M4102.02,-5652.59C4088.09,-5646.3 4072.82,-5640.53 4058,-5637.17 4040.99,-5633.31 3442.24,-5639.6 3430,-5627.17 3425.32,-5622.41 3425.32,-5616.91 3430,-5612.17 3442.26,-5599.75 4041.39,-5609.49 4058,-5604.17 4076.46,-5598.24 4094.51,-5587.5 4109.94,-5576.29"/>
<polygon fill="black" stroke="black" points="4112.34,-5578.86 4118.22,-5570.05 4108.13,-5573.27 4112.34,-5578.86"/>
</g>
<!-- l3_attn_stage0_gpu15&#45;&gt;l3_attn_stage1_gpu[next_gpu] -->
<g id="edge1760" class="edge">
<title>l3_attn_stage0_gpu15&#45;&gt;l3_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4243.34,-5679.49C4393.61,-5674.86 4685.83,-5661.51 4717,-5627.17 4769.01,-5569.87 4670.61,-5548.3 4572.88,-5540.45"/>
<polygon fill="red" stroke="red" points="4573.06,-5536.96 4562.82,-5539.69 4572.53,-5543.94 4573.06,-5536.96"/>
<text text-anchor="middle" x="4756.5" y="-5615.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu0 -->
<g id="node689" class="node">
<title>l3_attn_stage2_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1230" cy="-5388.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1230" y="-5399.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="1230" y="-5384.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1230" y="-5369.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu0&#45;&gt;l3_attn_stage2_gpu0 -->
<g id="edge641" class="edge">
<title>l3_attn_stage1_gpu0&#45;&gt;l3_attn_stage2_gpu0</title>
<path fill="none" stroke="black" d="M1230,-5498.08C1230,-5479.36 1230,-5456.37 1230,-5436.38"/>
<polygon fill="black" stroke="black" points="1233.5,-5436.24 1230,-5426.24 1226.5,-5436.24 1233.5,-5436.24"/>
</g>
<!-- l3_attn_stage2_gpu[next_gpu] -->
<g id="node1344" class="node">
<title>l3_attn_stage2_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4417" cy="-5388.67" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4417" y="-5384.97" font-family="Times,serif" font-size="14.00">l3_attn_stage2_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage1_gpu0&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge1761" class="edge">
<title>l3_attn_stage1_gpu0&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1283.29,-5505.67C1297.43,-5499.33 1312.95,-5493.52 1328,-5490.17 1557.73,-5439.03 3210.66,-5467.72 3446,-5465.17 3490.94,-5464.68 4210.97,-5466.2 4255,-5457.17 4298.87,-5448.17 4345.77,-5427.25 4377.76,-5411.06"/>
<polygon fill="red" stroke="red" points="4379.49,-5414.11 4386.78,-5406.43 4376.28,-5407.89 4379.49,-5414.11"/>
<text text-anchor="middle" x="3477.5" y="-5468.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu1 -->
<g id="node690" class="node">
<title>l3_attn_stage2_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1425" cy="-5388.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1425" y="-5399.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="1425" y="-5384.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1425" y="-5369.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu1&#45;&gt;l3_attn_stage2_gpu1 -->
<g id="edge642" class="edge">
<title>l3_attn_stage1_gpu1&#45;&gt;l3_attn_stage2_gpu1</title>
<path fill="none" stroke="black" d="M1425,-5498.08C1425,-5479.36 1425,-5456.37 1425,-5436.38"/>
<polygon fill="black" stroke="black" points="1428.5,-5436.24 1425,-5426.24 1421.5,-5436.24 1428.5,-5436.24"/>
</g>
<!-- l3_attn_stage1_gpu1&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge1762" class="edge">
<title>l3_attn_stage1_gpu1&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1478.28,-5505.6C1492.41,-5499.26 1507.94,-5493.46 1523,-5490.17 1577,-5478.34 3460.82,-5498.43 3513,-5480.17 3523.15,-5476.61 3521.86,-5468.75 3532,-5465.17 3569.87,-5451.78 4215.66,-5465.26 4255,-5457.17 4298.87,-5448.14 4345.77,-5427.23 4377.76,-5411.05"/>
<polygon fill="red" stroke="red" points="4379.48,-5414.1 4386.78,-5406.41 4376.28,-5407.87 4379.48,-5414.1"/>
<text text-anchor="middle" x="3563.5" y="-5468.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu2 -->
<g id="node691" class="node">
<title>l3_attn_stage2_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1620" cy="-5388.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1620" y="-5399.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="1620" y="-5384.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1620" y="-5369.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu2&#45;&gt;l3_attn_stage2_gpu2 -->
<g id="edge643" class="edge">
<title>l3_attn_stage1_gpu2&#45;&gt;l3_attn_stage2_gpu2</title>
<path fill="none" stroke="black" d="M1620,-5498.08C1620,-5479.36 1620,-5456.37 1620,-5436.38"/>
<polygon fill="black" stroke="black" points="1623.5,-5436.24 1620,-5426.24 1616.5,-5436.24 1623.5,-5436.24"/>
</g>
<!-- l3_attn_stage1_gpu2&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge1763" class="edge">
<title>l3_attn_stage1_gpu2&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1673.28,-5505.6C1687.41,-5499.26 1702.94,-5493.47 1718,-5490.17 1769.04,-5478.98 3549.68,-5497.43 3599,-5480.17 3609.15,-5476.61 3607.86,-5468.76 3618,-5465.17 3651.36,-5453.35 4220.34,-5464.32 4255,-5457.17 4298.86,-5448.11 4345.76,-5427.2 4377.75,-5411.03"/>
<polygon fill="red" stroke="red" points="4379.48,-5414.08 4386.77,-5406.4 4376.28,-5407.85 4379.48,-5414.08"/>
<text text-anchor="middle" x="3649.5" y="-5468.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu3 -->
<g id="node692" class="node">
<title>l3_attn_stage2_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1815" cy="-5388.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1815" y="-5399.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="1815" y="-5384.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1815" y="-5369.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu3&#45;&gt;l3_attn_stage2_gpu3 -->
<g id="edge644" class="edge">
<title>l3_attn_stage1_gpu3&#45;&gt;l3_attn_stage2_gpu3</title>
<path fill="none" stroke="black" d="M1815,-5498.08C1815,-5479.36 1815,-5456.37 1815,-5436.38"/>
<polygon fill="black" stroke="black" points="1818.5,-5436.24 1815,-5426.24 1811.5,-5436.24 1818.5,-5436.24"/>
</g>
<!-- l3_attn_stage1_gpu3&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge1764" class="edge">
<title>l3_attn_stage1_gpu3&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1868.28,-5505.6C1882.41,-5499.26 1897.94,-5493.47 1913,-5490.17 1961.08,-5479.62 3638.55,-5496.44 3685,-5480.17 3695.15,-5476.61 3693.86,-5468.77 3704,-5465.17 3732.85,-5454.92 4225.02,-5463.39 4255,-5457.17 4298.85,-5448.06 4345.75,-5427.16 4377.75,-5411.01"/>
<polygon fill="red" stroke="red" points="4379.47,-5414.06 4386.77,-5406.38 4376.27,-5407.83 4379.47,-5414.06"/>
<text text-anchor="middle" x="3735.5" y="-5468.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu4 -->
<g id="node693" class="node">
<title>l3_attn_stage2_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2010" cy="-5388.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2010" y="-5399.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="2010" y="-5384.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2010" y="-5369.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu4&#45;&gt;l3_attn_stage2_gpu4 -->
<g id="edge645" class="edge">
<title>l3_attn_stage1_gpu4&#45;&gt;l3_attn_stage2_gpu4</title>
<path fill="none" stroke="black" d="M2010,-5498.08C2010,-5479.36 2010,-5456.37 2010,-5436.38"/>
<polygon fill="black" stroke="black" points="2013.5,-5436.24 2010,-5426.24 2006.5,-5436.24 2013.5,-5436.24"/>
</g>
<!-- l3_attn_stage1_gpu4&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge1765" class="edge">
<title>l3_attn_stage1_gpu4&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2063.28,-5505.61C2077.41,-5499.27 2092.94,-5493.47 2108,-5490.17 2153.12,-5480.26 3727.41,-5495.45 3771,-5480.17 3781.15,-5476.61 3779.87,-5468.78 3790,-5465.17 3838.67,-5447.8 4204.42,-5467.74 4255,-5457.17 4298.84,-5448 4345.74,-5427.11 4377.74,-5410.98"/>
<polygon fill="red" stroke="red" points="4379.46,-5414.03 4386.76,-5406.35 4376.27,-5407.8 4379.46,-5414.03"/>
<text text-anchor="middle" x="3821.5" y="-5468.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu5 -->
<g id="node694" class="node">
<title>l3_attn_stage2_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2205" cy="-5388.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2205" y="-5399.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="2205" y="-5384.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2205" y="-5369.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu5&#45;&gt;l3_attn_stage2_gpu5 -->
<g id="edge646" class="edge">
<title>l3_attn_stage1_gpu5&#45;&gt;l3_attn_stage2_gpu5</title>
<path fill="none" stroke="black" d="M2205,-5498.08C2205,-5479.36 2205,-5456.37 2205,-5436.38"/>
<polygon fill="black" stroke="black" points="2208.5,-5436.24 2205,-5426.24 2201.5,-5436.24 2208.5,-5436.24"/>
</g>
<!-- l3_attn_stage1_gpu5&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge1766" class="edge">
<title>l3_attn_stage1_gpu5&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2258.28,-5505.61C2272.41,-5499.27 2287.94,-5493.47 2303,-5490.17 2345.16,-5480.9 3816.27,-5494.45 3857,-5480.17 3867.15,-5476.6 3865.87,-5468.8 3876,-5465.17 3915.64,-5450.93 4213.79,-5465.86 4255,-5457.17 4298.82,-5447.92 4345.73,-5427.04 4377.73,-5410.93"/>
<polygon fill="red" stroke="red" points="4379.45,-5413.98 4386.75,-5406.32 4376.26,-5407.75 4379.45,-5413.98"/>
<text text-anchor="middle" x="3907.5" y="-5468.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu6 -->
<g id="node695" class="node">
<title>l3_attn_stage2_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2400" cy="-5388.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2400" y="-5399.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="2400" y="-5384.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2400" y="-5369.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu6&#45;&gt;l3_attn_stage2_gpu6 -->
<g id="edge647" class="edge">
<title>l3_attn_stage1_gpu6&#45;&gt;l3_attn_stage2_gpu6</title>
<path fill="none" stroke="black" d="M2400,-5498.08C2400,-5479.36 2400,-5456.37 2400,-5436.38"/>
<polygon fill="black" stroke="black" points="2403.5,-5436.24 2400,-5426.24 2396.5,-5436.24 2403.5,-5436.24"/>
</g>
<!-- l3_attn_stage1_gpu6&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge1767" class="edge">
<title>l3_attn_stage1_gpu6&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2453.28,-5505.62C2467.41,-5499.28 2482.94,-5493.48 2498,-5490.17 2537.2,-5481.54 3905.13,-5493.46 3943,-5480.17 3953.15,-5476.6 3951.89,-5468.83 3962,-5465.17 3992.62,-5454.07 4223.15,-5463.99 4255,-5457.17 4298.66,-5447.81 4345.41,-5427.05 4377.42,-5411.01"/>
<polygon fill="red" stroke="red" points="4379.12,-5414.06 4386.45,-5406.41 4375.95,-5407.83 4379.12,-5414.06"/>
<text text-anchor="middle" x="3993.5" y="-5468.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu7 -->
<g id="node696" class="node">
<title>l3_attn_stage2_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2595" cy="-5388.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2595" y="-5399.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="2595" y="-5384.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2595" y="-5369.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu7&#45;&gt;l3_attn_stage2_gpu7 -->
<g id="edge648" class="edge">
<title>l3_attn_stage1_gpu7&#45;&gt;l3_attn_stage2_gpu7</title>
<path fill="none" stroke="black" d="M2595,-5498.08C2595,-5479.36 2595,-5456.37 2595,-5436.38"/>
<polygon fill="black" stroke="black" points="2598.5,-5436.24 2595,-5426.24 2591.5,-5436.24 2598.5,-5436.24"/>
</g>
<!-- l3_attn_stage1_gpu7&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge1768" class="edge">
<title>l3_attn_stage1_gpu7&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2648.28,-5505.62C2662.42,-5499.28 2677.95,-5493.48 2693,-5490.17 2729.24,-5482.18 3993.99,-5492.47 4029,-5480.17 4039.15,-5476.6 4037.91,-5468.89 4048,-5465.17 4091.19,-5449.23 4210.04,-5467.06 4255,-5457.17 4298.6,-5447.57 4345.37,-5426.84 4377.39,-5410.87"/>
<polygon fill="red" stroke="red" points="4379.08,-5413.94 4386.42,-5406.3 4375.92,-5407.69 4379.08,-5413.94"/>
<text text-anchor="middle" x="4079.5" y="-5468.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu8 -->
<g id="node697" class="node">
<title>l3_attn_stage2_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2790" cy="-5388.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2790" y="-5399.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="2790" y="-5384.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2790" y="-5369.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu8&#45;&gt;l3_attn_stage2_gpu8 -->
<g id="edge649" class="edge">
<title>l3_attn_stage1_gpu8&#45;&gt;l3_attn_stage2_gpu8</title>
<path fill="none" stroke="black" d="M2790,-5498.08C2790,-5479.36 2790,-5456.37 2790,-5436.38"/>
<polygon fill="black" stroke="black" points="2793.5,-5436.24 2790,-5426.24 2786.5,-5436.24 2793.5,-5436.24"/>
</g>
<!-- l3_attn_stage1_gpu8&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge1769" class="edge">
<title>l3_attn_stage1_gpu8&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2843.28,-5505.63C2857.42,-5499.29 2872.95,-5493.49 2888,-5490.17 2954.57,-5475.48 4050.69,-5502.78 4115,-5480.17 4125.15,-5476.6 4123.96,-5469.03 4134,-5465.17 4184.3,-5445.82 4202.53,-5469.47 4255,-5457.17 4298.2,-5447.03 4344.67,-5426.59 4376.71,-5410.84"/>
<polygon fill="red" stroke="red" points="4378.38,-5413.92 4385.77,-5406.33 4375.25,-5407.66 4378.38,-5413.92"/>
<text text-anchor="middle" x="4165.5" y="-5468.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu9 -->
<g id="node698" class="node">
<title>l3_attn_stage2_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2985" cy="-5388.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2985" y="-5399.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="2985" y="-5384.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2985" y="-5369.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu9&#45;&gt;l3_attn_stage2_gpu9 -->
<g id="edge650" class="edge">
<title>l3_attn_stage1_gpu9&#45;&gt;l3_attn_stage2_gpu9</title>
<path fill="none" stroke="black" d="M2985,-5498.08C2985,-5479.36 2985,-5456.37 2985,-5436.38"/>
<polygon fill="black" stroke="black" points="2988.5,-5436.24 2985,-5426.24 2981.5,-5436.24 2988.5,-5436.24"/>
</g>
<!-- l3_attn_stage1_gpu9&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge1770" class="edge">
<title>l3_attn_stage1_gpu9&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3038.28,-5505.64C3052.42,-5499.3 3067.95,-5493.49 3083,-5490.17 3143.65,-5476.76 4142.41,-5500.8 4201,-5480.17 4211.15,-5476.59 4210.3,-5469.81 4220,-5465.17 4234.39,-5458.28 4239.8,-5462.03 4255,-5457.17 4295.94,-5444.06 4340.95,-5424.9 4373.12,-5410.34"/>
<polygon fill="red" stroke="red" points="4374.61,-5413.51 4382.25,-5406.17 4371.7,-5407.14 4374.61,-5413.51"/>
<text text-anchor="middle" x="4251.5" y="-5468.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu10 -->
<g id="node699" class="node">
<title>l3_attn_stage2_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3180" cy="-5388.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3180" y="-5399.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="3180" y="-5384.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3180" y="-5369.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu10&#45;&gt;l3_attn_stage2_gpu10 -->
<g id="edge651" class="edge">
<title>l3_attn_stage1_gpu10&#45;&gt;l3_attn_stage2_gpu10</title>
<path fill="none" stroke="black" d="M3180,-5498.08C3180,-5479.36 3180,-5456.37 3180,-5436.38"/>
<polygon fill="black" stroke="black" points="3183.5,-5436.24 3180,-5426.24 3176.5,-5436.24 3183.5,-5436.24"/>
</g>
<!-- l3_attn_stage1_gpu10&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge1771" class="edge">
<title>l3_attn_stage1_gpu10&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3233.29,-5505.65C3247.42,-5499.31 3262.95,-5493.5 3278,-5490.17 3332.73,-5478.04 4234.13,-5498.81 4287,-5480.17 4297.15,-5476.59 4297.32,-5471.53 4306,-5465.17 4331.22,-5446.67 4360.5,-5426.82 4382.65,-5412.12"/>
<polygon fill="red" stroke="red" points="4384.66,-5414.99 4391.07,-5406.55 4380.8,-5409.15 4384.66,-5414.99"/>
<text text-anchor="middle" x="4337.5" y="-5468.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu11 -->
<g id="node700" class="node">
<title>l3_attn_stage2_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3375" cy="-5388.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3375" y="-5399.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="3375" y="-5384.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3375" y="-5369.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu11&#45;&gt;l3_attn_stage2_gpu11 -->
<g id="edge652" class="edge">
<title>l3_attn_stage1_gpu11&#45;&gt;l3_attn_stage2_gpu11</title>
<path fill="none" stroke="black" d="M3375,-5498.08C3375,-5479.36 3375,-5456.37 3375,-5436.38"/>
<polygon fill="black" stroke="black" points="3378.5,-5436.24 3375,-5426.24 3371.5,-5436.24 3378.5,-5436.24"/>
</g>
<!-- l3_attn_stage1_gpu11&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge1772" class="edge">
<title>l3_attn_stage1_gpu11&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3428.29,-5505.66C3442.42,-5499.32 3457.95,-5493.51 3473,-5490.17 3497.41,-5484.74 4351.88,-5493.55 4373,-5480.17 4394.94,-5466.27 4406.24,-5437.99 4411.85,-5416.72"/>
<polygon fill="red" stroke="red" points="4415.27,-5417.47 4414.18,-5406.94 4408.46,-5415.86 4415.27,-5417.47"/>
<text text-anchor="middle" x="4419.5" y="-5468.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu12 -->
<g id="node701" class="node">
<title>l3_attn_stage2_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3570" cy="-5388.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3570" y="-5399.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="3570" y="-5384.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3570" y="-5369.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu12&#45;&gt;l3_attn_stage2_gpu12 -->
<g id="edge653" class="edge">
<title>l3_attn_stage1_gpu12&#45;&gt;l3_attn_stage2_gpu12</title>
<path fill="none" stroke="black" d="M3514.85,-5506.2C3501.43,-5500.17 3486.93,-5494.36 3473,-5490.17 3459.22,-5486.01 3418.36,-5491.1 3409,-5480.17 3374.08,-5439.36 3414.79,-5479.49 3473,-5457.17 3490.78,-5450.35 3508.42,-5439.6 3523.68,-5428.67"/>
<polygon fill="black" stroke="black" points="3525.93,-5431.36 3531.9,-5422.6 3521.77,-5425.73 3525.93,-5431.36"/>
</g>
<!-- l3_attn_stage1_gpu12&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge1773" class="edge">
<title>l3_attn_stage1_gpu12&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3623.29,-5505.68C3637.43,-5499.34 3652.95,-5493.52 3668,-5490.17 3689.45,-5485.38 4443.56,-5495.8 4459,-5480.17 4477.16,-5461.78 4459.89,-5434.08 4442.31,-5414.18"/>
<polygon fill="red" stroke="red" points="4444.75,-5411.65 4435.38,-5406.7 4439.61,-5416.41 4444.75,-5411.65"/>
<text text-anchor="middle" x="4497.5" y="-5468.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu13 -->
<g id="node702" class="node">
<title>l3_attn_stage2_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3765" cy="-5388.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3765" y="-5399.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="3765" y="-5384.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3765" y="-5369.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu13&#45;&gt;l3_attn_stage2_gpu13 -->
<g id="edge654" class="edge">
<title>l3_attn_stage1_gpu13&#45;&gt;l3_attn_stage2_gpu13</title>
<path fill="none" stroke="black" d="M3711.7,-5505.72C3697.85,-5499.47 3682.69,-5493.68 3668,-5490.17 3654.37,-5486.9 3425.71,-5490.27 3416,-5480.17 3411.38,-5475.36 3411.36,-5469.95 3416,-5465.17 3425.75,-5455.11 3654.7,-5461.57 3668,-5457.17 3686.4,-5451.07 3704.44,-5440.28 3719.87,-5429.08"/>
<polygon fill="black" stroke="black" points="3722.27,-5431.66 3728.16,-5422.85 3718.06,-5426.06 3722.27,-5431.66"/>
</g>
<!-- l3_attn_stage1_gpu13&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge1774" class="edge">
<title>l3_attn_stage1_gpu13&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3818.3,-5505.7C3832.43,-5499.36 3847.96,-5493.54 3863,-5490.17 3881.49,-5486.02 4531.7,-5493.66 4545,-5480.17 4573.36,-5451.39 4525.79,-5425.56 4480.82,-5408.93"/>
<polygon fill="red" stroke="red" points="4481.88,-5405.59 4471.29,-5405.52 4479.53,-5412.18 4481.88,-5405.59"/>
<text text-anchor="middle" x="4584.5" y="-5468.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu14 -->
<g id="node703" class="node">
<title>l3_attn_stage2_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3960" cy="-5388.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3960" y="-5399.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="3960" y="-5384.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3960" y="-5369.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu14&#45;&gt;l3_attn_stage2_gpu14 -->
<g id="edge655" class="edge">
<title>l3_attn_stage1_gpu14&#45;&gt;l3_attn_stage2_gpu14</title>
<path fill="none" stroke="black" d="M3906.74,-5505.55C3892.89,-5499.3 3877.71,-5493.56 3863,-5490.17 3839.17,-5484.68 3440.09,-5497.65 3423,-5480.17 3418.34,-5475.4 3418.33,-5469.92 3423,-5465.17 3431.56,-5456.44 3851.37,-5460.93 3863,-5457.17 3881.45,-5451.19 3899.49,-5440.43 3914.92,-5429.23"/>
<polygon fill="black" stroke="black" points="3917.32,-5431.8 3923.2,-5422.99 3913.11,-5426.21 3917.32,-5431.8"/>
</g>
<!-- l3_attn_stage1_gpu14&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge1775" class="edge">
<title>l3_attn_stage1_gpu14&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4013.3,-5505.73C4027.44,-5499.38 4042.96,-5493.56 4058,-5490.17 4073.53,-5486.66 4619.84,-5491.52 4631,-5480.17 4671.03,-5439.43 4601.32,-5416.07 4531.01,-5403.33"/>
<polygon fill="red" stroke="red" points="4531.55,-5399.87 4521.1,-5401.6 4530.35,-5406.76 4531.55,-5399.87"/>
<text text-anchor="middle" x="4671.5" y="-5468.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage2_gpu15 -->
<g id="node704" class="node">
<title>l3_attn_stage2_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4155" cy="-5388.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4155" y="-5399.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage2</text>
<text text-anchor="middle" x="4155" y="-5384.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4155" y="-5369.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage1_gpu15&#45;&gt;l3_attn_stage2_gpu15 -->
<g id="edge656" class="edge">
<title>l3_attn_stage1_gpu15&#45;&gt;l3_attn_stage2_gpu15</title>
<path fill="none" stroke="black" d="M4102.02,-5505.59C4088.09,-5499.3 4072.82,-5493.53 4058,-5490.17 4040.99,-5486.31 3442.24,-5492.6 3430,-5480.17 3425.32,-5475.41 3425.32,-5469.91 3430,-5465.17 3442.26,-5452.75 4041.39,-5462.49 4058,-5457.17 4076.46,-5451.24 4094.51,-5440.5 4109.94,-5429.29"/>
<polygon fill="black" stroke="black" points="4112.34,-5431.86 4118.22,-5423.05 4108.13,-5426.27 4112.34,-5431.86"/>
</g>
<!-- l3_attn_stage1_gpu15&#45;&gt;l3_attn_stage2_gpu[next_gpu] -->
<g id="edge1776" class="edge">
<title>l3_attn_stage1_gpu15&#45;&gt;l3_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4210.38,-5506.35C4225.74,-5499.79 4242.68,-5493.7 4259,-5490.17 4283.87,-5484.78 4699.2,-5498.36 4717,-5480.17 4771.67,-5424.29 4670.45,-5402.63 4571.12,-5394.38"/>
<polygon fill="red" stroke="red" points="4571.15,-5390.87 4560.9,-5393.57 4570.6,-5397.84 4571.15,-5390.87"/>
<text text-anchor="middle" x="4757.5" y="-5468.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu0 -->
<g id="node705" class="node">
<title>l3_attn_stage3_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1230" cy="-5241.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1230" y="-5252.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="1230" y="-5237.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1230" y="-5222.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu0&#45;&gt;l3_attn_stage3_gpu0 -->
<g id="edge657" class="edge">
<title>l3_attn_stage2_gpu0&#45;&gt;l3_attn_stage3_gpu0</title>
<path fill="none" stroke="black" d="M1230,-5351.08C1230,-5332.36 1230,-5309.37 1230,-5289.38"/>
<polygon fill="black" stroke="black" points="1233.5,-5289.24 1230,-5279.24 1226.5,-5289.24 1233.5,-5289.24"/>
</g>
<!-- l3_attn_stage3_gpu[next_gpu] -->
<g id="node1345" class="node">
<title>l3_attn_stage3_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4417" cy="-5241.67" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4417" y="-5237.97" font-family="Times,serif" font-size="14.00">l3_attn_stage3_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage2_gpu0&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge1777" class="edge">
<title>l3_attn_stage2_gpu0&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1283.29,-5358.67C1297.43,-5352.33 1312.95,-5346.52 1328,-5343.17 1557.73,-5292.03 3210.66,-5320.72 3446,-5318.17 3490.94,-5317.68 4210.97,-5319.2 4255,-5310.17 4298.87,-5301.17 4345.77,-5280.25 4377.76,-5264.06"/>
<polygon fill="red" stroke="red" points="4379.49,-5267.11 4386.78,-5259.43 4376.28,-5260.89 4379.49,-5267.11"/>
<text text-anchor="middle" x="3477.5" y="-5321.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu1 -->
<g id="node706" class="node">
<title>l3_attn_stage3_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1425" cy="-5241.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1425" y="-5252.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="1425" y="-5237.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1425" y="-5222.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu1&#45;&gt;l3_attn_stage3_gpu1 -->
<g id="edge658" class="edge">
<title>l3_attn_stage2_gpu1&#45;&gt;l3_attn_stage3_gpu1</title>
<path fill="none" stroke="black" d="M1425,-5351.08C1425,-5332.36 1425,-5309.37 1425,-5289.38"/>
<polygon fill="black" stroke="black" points="1428.5,-5289.24 1425,-5279.24 1421.5,-5289.24 1428.5,-5289.24"/>
</g>
<!-- l3_attn_stage2_gpu1&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge1778" class="edge">
<title>l3_attn_stage2_gpu1&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1478.28,-5358.6C1492.41,-5352.26 1507.94,-5346.46 1523,-5343.17 1577,-5331.34 3460.82,-5351.43 3513,-5333.17 3523.15,-5329.61 3521.86,-5321.75 3532,-5318.17 3569.87,-5304.78 4215.66,-5318.26 4255,-5310.17 4298.87,-5301.14 4345.77,-5280.23 4377.76,-5264.05"/>
<polygon fill="red" stroke="red" points="4379.48,-5267.1 4386.78,-5259.41 4376.28,-5260.87 4379.48,-5267.1"/>
<text text-anchor="middle" x="3563.5" y="-5321.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu2 -->
<g id="node707" class="node">
<title>l3_attn_stage3_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1620" cy="-5241.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1620" y="-5252.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="1620" y="-5237.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1620" y="-5222.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu2&#45;&gt;l3_attn_stage3_gpu2 -->
<g id="edge659" class="edge">
<title>l3_attn_stage2_gpu2&#45;&gt;l3_attn_stage3_gpu2</title>
<path fill="none" stroke="black" d="M1620,-5351.08C1620,-5332.36 1620,-5309.37 1620,-5289.38"/>
<polygon fill="black" stroke="black" points="1623.5,-5289.24 1620,-5279.24 1616.5,-5289.24 1623.5,-5289.24"/>
</g>
<!-- l3_attn_stage2_gpu2&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge1779" class="edge">
<title>l3_attn_stage2_gpu2&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1673.28,-5358.6C1687.41,-5352.26 1702.94,-5346.47 1718,-5343.17 1769.04,-5331.98 3549.68,-5350.43 3599,-5333.17 3609.15,-5329.61 3607.86,-5321.76 3618,-5318.17 3651.36,-5306.35 4220.34,-5317.32 4255,-5310.17 4298.86,-5301.11 4345.76,-5280.2 4377.75,-5264.03"/>
<polygon fill="red" stroke="red" points="4379.48,-5267.08 4386.77,-5259.4 4376.28,-5260.85 4379.48,-5267.08"/>
<text text-anchor="middle" x="3649.5" y="-5321.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu3 -->
<g id="node708" class="node">
<title>l3_attn_stage3_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1815" cy="-5241.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1815" y="-5252.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="1815" y="-5237.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1815" y="-5222.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu3&#45;&gt;l3_attn_stage3_gpu3 -->
<g id="edge660" class="edge">
<title>l3_attn_stage2_gpu3&#45;&gt;l3_attn_stage3_gpu3</title>
<path fill="none" stroke="black" d="M1815,-5351.08C1815,-5332.36 1815,-5309.37 1815,-5289.38"/>
<polygon fill="black" stroke="black" points="1818.5,-5289.24 1815,-5279.24 1811.5,-5289.24 1818.5,-5289.24"/>
</g>
<!-- l3_attn_stage2_gpu3&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge1780" class="edge">
<title>l3_attn_stage2_gpu3&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1868.28,-5358.6C1882.41,-5352.26 1897.94,-5346.47 1913,-5343.17 1961.08,-5332.62 3638.55,-5349.44 3685,-5333.17 3695.15,-5329.61 3693.86,-5321.77 3704,-5318.17 3732.85,-5307.92 4225.02,-5316.39 4255,-5310.17 4298.85,-5301.06 4345.75,-5280.16 4377.75,-5264.01"/>
<polygon fill="red" stroke="red" points="4379.47,-5267.06 4386.77,-5259.38 4376.27,-5260.83 4379.47,-5267.06"/>
<text text-anchor="middle" x="3735.5" y="-5321.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu4 -->
<g id="node709" class="node">
<title>l3_attn_stage3_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2010" cy="-5241.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2010" y="-5252.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="2010" y="-5237.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2010" y="-5222.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu4&#45;&gt;l3_attn_stage3_gpu4 -->
<g id="edge661" class="edge">
<title>l3_attn_stage2_gpu4&#45;&gt;l3_attn_stage3_gpu4</title>
<path fill="none" stroke="black" d="M2010,-5351.08C2010,-5332.36 2010,-5309.37 2010,-5289.38"/>
<polygon fill="black" stroke="black" points="2013.5,-5289.24 2010,-5279.24 2006.5,-5289.24 2013.5,-5289.24"/>
</g>
<!-- l3_attn_stage2_gpu4&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge1781" class="edge">
<title>l3_attn_stage2_gpu4&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2063.28,-5358.61C2077.41,-5352.27 2092.94,-5346.47 2108,-5343.17 2153.12,-5333.26 3727.41,-5348.45 3771,-5333.17 3781.15,-5329.61 3779.87,-5321.78 3790,-5318.17 3838.67,-5300.8 4204.42,-5320.74 4255,-5310.17 4298.84,-5301 4345.74,-5280.11 4377.74,-5263.98"/>
<polygon fill="red" stroke="red" points="4379.46,-5267.03 4386.76,-5259.35 4376.27,-5260.8 4379.46,-5267.03"/>
<text text-anchor="middle" x="3821.5" y="-5321.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu5 -->
<g id="node710" class="node">
<title>l3_attn_stage3_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2205" cy="-5241.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2205" y="-5252.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="2205" y="-5237.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2205" y="-5222.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu5&#45;&gt;l3_attn_stage3_gpu5 -->
<g id="edge662" class="edge">
<title>l3_attn_stage2_gpu5&#45;&gt;l3_attn_stage3_gpu5</title>
<path fill="none" stroke="black" d="M2205,-5351.08C2205,-5332.36 2205,-5309.37 2205,-5289.38"/>
<polygon fill="black" stroke="black" points="2208.5,-5289.24 2205,-5279.24 2201.5,-5289.24 2208.5,-5289.24"/>
</g>
<!-- l3_attn_stage2_gpu5&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge1782" class="edge">
<title>l3_attn_stage2_gpu5&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2258.28,-5358.61C2272.41,-5352.27 2287.94,-5346.47 2303,-5343.17 2345.16,-5333.9 3816.27,-5347.45 3857,-5333.17 3867.15,-5329.6 3865.87,-5321.8 3876,-5318.17 3915.64,-5303.93 4213.79,-5318.86 4255,-5310.17 4298.82,-5300.92 4345.73,-5280.04 4377.73,-5263.93"/>
<polygon fill="red" stroke="red" points="4379.45,-5266.98 4386.75,-5259.32 4376.26,-5260.75 4379.45,-5266.98"/>
<text text-anchor="middle" x="3907.5" y="-5321.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu6 -->
<g id="node711" class="node">
<title>l3_attn_stage3_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2400" cy="-5241.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2400" y="-5252.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="2400" y="-5237.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2400" y="-5222.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu6&#45;&gt;l3_attn_stage3_gpu6 -->
<g id="edge663" class="edge">
<title>l3_attn_stage2_gpu6&#45;&gt;l3_attn_stage3_gpu6</title>
<path fill="none" stroke="black" d="M2400,-5351.08C2400,-5332.36 2400,-5309.37 2400,-5289.38"/>
<polygon fill="black" stroke="black" points="2403.5,-5289.24 2400,-5279.24 2396.5,-5289.24 2403.5,-5289.24"/>
</g>
<!-- l3_attn_stage2_gpu6&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge1783" class="edge">
<title>l3_attn_stage2_gpu6&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2453.28,-5358.62C2467.41,-5352.28 2482.94,-5346.48 2498,-5343.17 2537.2,-5334.54 3905.13,-5346.46 3943,-5333.17 3953.15,-5329.6 3951.89,-5321.83 3962,-5318.17 3992.62,-5307.07 4223.15,-5316.99 4255,-5310.17 4298.66,-5300.81 4345.41,-5280.05 4377.42,-5264.01"/>
<polygon fill="red" stroke="red" points="4379.12,-5267.06 4386.45,-5259.41 4375.95,-5260.83 4379.12,-5267.06"/>
<text text-anchor="middle" x="3993.5" y="-5321.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu7 -->
<g id="node712" class="node">
<title>l3_attn_stage3_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2595" cy="-5241.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2595" y="-5252.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="2595" y="-5237.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2595" y="-5222.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu7&#45;&gt;l3_attn_stage3_gpu7 -->
<g id="edge664" class="edge">
<title>l3_attn_stage2_gpu7&#45;&gt;l3_attn_stage3_gpu7</title>
<path fill="none" stroke="black" d="M2595,-5351.08C2595,-5332.36 2595,-5309.37 2595,-5289.38"/>
<polygon fill="black" stroke="black" points="2598.5,-5289.24 2595,-5279.24 2591.5,-5289.24 2598.5,-5289.24"/>
</g>
<!-- l3_attn_stage2_gpu7&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge1784" class="edge">
<title>l3_attn_stage2_gpu7&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2648.28,-5358.62C2662.42,-5352.28 2677.95,-5346.48 2693,-5343.17 2729.24,-5335.18 3993.99,-5345.47 4029,-5333.17 4039.15,-5329.6 4037.91,-5321.89 4048,-5318.17 4091.19,-5302.23 4210.04,-5320.06 4255,-5310.17 4298.6,-5300.57 4345.37,-5279.84 4377.39,-5263.87"/>
<polygon fill="red" stroke="red" points="4379.08,-5266.94 4386.42,-5259.3 4375.92,-5260.69 4379.08,-5266.94"/>
<text text-anchor="middle" x="4079.5" y="-5321.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu8 -->
<g id="node713" class="node">
<title>l3_attn_stage3_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2790" cy="-5241.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2790" y="-5252.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="2790" y="-5237.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2790" y="-5222.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu8&#45;&gt;l3_attn_stage3_gpu8 -->
<g id="edge665" class="edge">
<title>l3_attn_stage2_gpu8&#45;&gt;l3_attn_stage3_gpu8</title>
<path fill="none" stroke="black" d="M2790,-5351.08C2790,-5332.36 2790,-5309.37 2790,-5289.38"/>
<polygon fill="black" stroke="black" points="2793.5,-5289.24 2790,-5279.24 2786.5,-5289.24 2793.5,-5289.24"/>
</g>
<!-- l3_attn_stage2_gpu8&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge1785" class="edge">
<title>l3_attn_stage2_gpu8&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2843.28,-5358.63C2857.42,-5352.29 2872.95,-5346.49 2888,-5343.17 2954.57,-5328.48 4050.69,-5355.78 4115,-5333.17 4125.15,-5329.6 4123.96,-5322.03 4134,-5318.17 4184.3,-5298.82 4202.53,-5322.47 4255,-5310.17 4298.2,-5300.03 4344.67,-5279.59 4376.71,-5263.84"/>
<polygon fill="red" stroke="red" points="4378.38,-5266.92 4385.77,-5259.33 4375.25,-5260.66 4378.38,-5266.92"/>
<text text-anchor="middle" x="4165.5" y="-5321.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu9 -->
<g id="node714" class="node">
<title>l3_attn_stage3_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2985" cy="-5241.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2985" y="-5252.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="2985" y="-5237.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2985" y="-5222.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu9&#45;&gt;l3_attn_stage3_gpu9 -->
<g id="edge666" class="edge">
<title>l3_attn_stage2_gpu9&#45;&gt;l3_attn_stage3_gpu9</title>
<path fill="none" stroke="black" d="M2985,-5351.08C2985,-5332.36 2985,-5309.37 2985,-5289.38"/>
<polygon fill="black" stroke="black" points="2988.5,-5289.24 2985,-5279.24 2981.5,-5289.24 2988.5,-5289.24"/>
</g>
<!-- l3_attn_stage2_gpu9&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge1786" class="edge">
<title>l3_attn_stage2_gpu9&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3038.28,-5358.64C3052.42,-5352.3 3067.95,-5346.49 3083,-5343.17 3143.65,-5329.76 4142.41,-5353.8 4201,-5333.17 4211.15,-5329.59 4210.3,-5322.81 4220,-5318.17 4234.39,-5311.28 4239.8,-5315.03 4255,-5310.17 4295.94,-5297.06 4340.95,-5277.9 4373.12,-5263.34"/>
<polygon fill="red" stroke="red" points="4374.61,-5266.51 4382.25,-5259.17 4371.7,-5260.14 4374.61,-5266.51"/>
<text text-anchor="middle" x="4251.5" y="-5321.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu10 -->
<g id="node715" class="node">
<title>l3_attn_stage3_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3180" cy="-5241.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3180" y="-5252.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="3180" y="-5237.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3180" y="-5222.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu10&#45;&gt;l3_attn_stage3_gpu10 -->
<g id="edge667" class="edge">
<title>l3_attn_stage2_gpu10&#45;&gt;l3_attn_stage3_gpu10</title>
<path fill="none" stroke="black" d="M3180,-5351.08C3180,-5332.36 3180,-5309.37 3180,-5289.38"/>
<polygon fill="black" stroke="black" points="3183.5,-5289.24 3180,-5279.24 3176.5,-5289.24 3183.5,-5289.24"/>
</g>
<!-- l3_attn_stage2_gpu10&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge1787" class="edge">
<title>l3_attn_stage2_gpu10&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3233.29,-5358.65C3247.42,-5352.31 3262.95,-5346.5 3278,-5343.17 3332.73,-5331.04 4234.13,-5351.81 4287,-5333.17 4297.15,-5329.59 4297.32,-5324.53 4306,-5318.17 4331.22,-5299.67 4360.5,-5279.82 4382.65,-5265.12"/>
<polygon fill="red" stroke="red" points="4384.66,-5267.99 4391.07,-5259.55 4380.8,-5262.15 4384.66,-5267.99"/>
<text text-anchor="middle" x="4337.5" y="-5321.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu11 -->
<g id="node716" class="node">
<title>l3_attn_stage3_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3375" cy="-5241.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3375" y="-5252.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="3375" y="-5237.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3375" y="-5222.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu11&#45;&gt;l3_attn_stage3_gpu11 -->
<g id="edge668" class="edge">
<title>l3_attn_stage2_gpu11&#45;&gt;l3_attn_stage3_gpu11</title>
<path fill="none" stroke="black" d="M3375,-5351.08C3375,-5332.36 3375,-5309.37 3375,-5289.38"/>
<polygon fill="black" stroke="black" points="3378.5,-5289.24 3375,-5279.24 3371.5,-5289.24 3378.5,-5289.24"/>
</g>
<!-- l3_attn_stage2_gpu11&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge1788" class="edge">
<title>l3_attn_stage2_gpu11&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3428.29,-5358.66C3442.42,-5352.32 3457.95,-5346.51 3473,-5343.17 3497.41,-5337.74 4351.88,-5346.55 4373,-5333.17 4394.94,-5319.27 4406.24,-5290.99 4411.85,-5269.72"/>
<polygon fill="red" stroke="red" points="4415.27,-5270.47 4414.18,-5259.94 4408.46,-5268.86 4415.27,-5270.47"/>
<text text-anchor="middle" x="4419.5" y="-5321.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu12 -->
<g id="node717" class="node">
<title>l3_attn_stage3_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3570" cy="-5241.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3570" y="-5252.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="3570" y="-5237.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3570" y="-5222.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu12&#45;&gt;l3_attn_stage3_gpu12 -->
<g id="edge669" class="edge">
<title>l3_attn_stage2_gpu12&#45;&gt;l3_attn_stage3_gpu12</title>
<path fill="none" stroke="black" d="M3514.85,-5359.2C3501.43,-5353.17 3486.93,-5347.36 3473,-5343.17 3459.22,-5339.01 3418.36,-5344.1 3409,-5333.17 3374.08,-5292.36 3414.79,-5332.49 3473,-5310.17 3490.78,-5303.35 3508.42,-5292.6 3523.68,-5281.67"/>
<polygon fill="black" stroke="black" points="3525.93,-5284.36 3531.9,-5275.6 3521.77,-5278.73 3525.93,-5284.36"/>
</g>
<!-- l3_attn_stage2_gpu12&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge1789" class="edge">
<title>l3_attn_stage2_gpu12&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3623.29,-5358.68C3637.43,-5352.34 3652.95,-5346.52 3668,-5343.17 3689.45,-5338.38 4443.56,-5348.8 4459,-5333.17 4477.16,-5314.78 4459.89,-5287.08 4442.31,-5267.18"/>
<polygon fill="red" stroke="red" points="4444.75,-5264.65 4435.38,-5259.7 4439.61,-5269.41 4444.75,-5264.65"/>
<text text-anchor="middle" x="4497.5" y="-5321.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu13 -->
<g id="node718" class="node">
<title>l3_attn_stage3_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3765" cy="-5241.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3765" y="-5252.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="3765" y="-5237.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3765" y="-5222.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu13&#45;&gt;l3_attn_stage3_gpu13 -->
<g id="edge670" class="edge">
<title>l3_attn_stage2_gpu13&#45;&gt;l3_attn_stage3_gpu13</title>
<path fill="none" stroke="black" d="M3711.7,-5358.72C3697.85,-5352.47 3682.69,-5346.68 3668,-5343.17 3654.37,-5339.9 3425.71,-5343.27 3416,-5333.17 3411.38,-5328.36 3411.36,-5322.95 3416,-5318.17 3425.75,-5308.11 3654.7,-5314.57 3668,-5310.17 3686.4,-5304.07 3704.44,-5293.28 3719.87,-5282.08"/>
<polygon fill="black" stroke="black" points="3722.27,-5284.66 3728.16,-5275.85 3718.06,-5279.06 3722.27,-5284.66"/>
</g>
<!-- l3_attn_stage2_gpu13&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge1790" class="edge">
<title>l3_attn_stage2_gpu13&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3818.3,-5358.7C3832.43,-5352.36 3847.96,-5346.54 3863,-5343.17 3881.49,-5339.02 4531.7,-5346.66 4545,-5333.17 4573.36,-5304.39 4525.79,-5278.56 4480.82,-5261.93"/>
<polygon fill="red" stroke="red" points="4481.88,-5258.59 4471.29,-5258.52 4479.53,-5265.18 4481.88,-5258.59"/>
<text text-anchor="middle" x="4584.5" y="-5321.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu14 -->
<g id="node719" class="node">
<title>l3_attn_stage3_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3960" cy="-5241.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3960" y="-5252.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="3960" y="-5237.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3960" y="-5222.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu14&#45;&gt;l3_attn_stage3_gpu14 -->
<g id="edge671" class="edge">
<title>l3_attn_stage2_gpu14&#45;&gt;l3_attn_stage3_gpu14</title>
<path fill="none" stroke="black" d="M3906.74,-5358.55C3892.89,-5352.3 3877.71,-5346.56 3863,-5343.17 3839.17,-5337.68 3440.09,-5350.65 3423,-5333.17 3418.34,-5328.4 3418.33,-5322.92 3423,-5318.17 3431.56,-5309.44 3851.37,-5313.93 3863,-5310.17 3881.45,-5304.19 3899.49,-5293.43 3914.92,-5282.23"/>
<polygon fill="black" stroke="black" points="3917.32,-5284.8 3923.2,-5275.99 3913.11,-5279.21 3917.32,-5284.8"/>
</g>
<!-- l3_attn_stage2_gpu14&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge1791" class="edge">
<title>l3_attn_stage2_gpu14&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4013.3,-5358.73C4027.44,-5352.38 4042.96,-5346.56 4058,-5343.17 4073.53,-5339.66 4619.84,-5344.52 4631,-5333.17 4671.03,-5292.43 4601.32,-5269.07 4531.01,-5256.33"/>
<polygon fill="red" stroke="red" points="4531.55,-5252.87 4521.1,-5254.6 4530.35,-5259.76 4531.55,-5252.87"/>
<text text-anchor="middle" x="4671.5" y="-5321.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage3_gpu15 -->
<g id="node720" class="node">
<title>l3_attn_stage3_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4155" cy="-5241.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4155" y="-5252.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage3</text>
<text text-anchor="middle" x="4155" y="-5237.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4155" y="-5222.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage2_gpu15&#45;&gt;l3_attn_stage3_gpu15 -->
<g id="edge672" class="edge">
<title>l3_attn_stage2_gpu15&#45;&gt;l3_attn_stage3_gpu15</title>
<path fill="none" stroke="black" d="M4102.02,-5358.59C4088.09,-5352.3 4072.82,-5346.53 4058,-5343.17 4040.99,-5339.31 3442.24,-5345.6 3430,-5333.17 3425.32,-5328.41 3425.32,-5322.91 3430,-5318.17 3442.26,-5305.75 4041.39,-5315.49 4058,-5310.17 4076.46,-5304.24 4094.51,-5293.5 4109.94,-5282.29"/>
<polygon fill="black" stroke="black" points="4112.34,-5284.86 4118.22,-5276.05 4108.13,-5279.27 4112.34,-5284.86"/>
</g>
<!-- l3_attn_stage2_gpu15&#45;&gt;l3_attn_stage3_gpu[next_gpu] -->
<g id="edge1792" class="edge">
<title>l3_attn_stage2_gpu15&#45;&gt;l3_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4210.38,-5359.35C4225.74,-5352.79 4242.68,-5346.7 4259,-5343.17 4283.87,-5337.78 4699.2,-5351.36 4717,-5333.17 4771.67,-5277.29 4670.45,-5255.63 4571.12,-5247.38"/>
<polygon fill="red" stroke="red" points="4571.15,-5243.87 4560.9,-5246.57 4570.6,-5250.84 4571.15,-5243.87"/>
<text text-anchor="middle" x="4757.5" y="-5321.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu0 -->
<g id="node721" class="node">
<title>l3_attn_stage4_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1230" cy="-5094.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1230" y="-5105.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="1230" y="-5090.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1230" y="-5075.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu0&#45;&gt;l3_attn_stage4_gpu0 -->
<g id="edge673" class="edge">
<title>l3_attn_stage3_gpu0&#45;&gt;l3_attn_stage4_gpu0</title>
<path fill="none" stroke="black" d="M1230,-5204.08C1230,-5185.36 1230,-5162.37 1230,-5142.38"/>
<polygon fill="black" stroke="black" points="1233.5,-5142.24 1230,-5132.24 1226.5,-5142.24 1233.5,-5142.24"/>
</g>
<!-- l3_attn_stage4_gpu[next_gpu] -->
<g id="node1346" class="node">
<title>l3_attn_stage4_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4417" cy="-5094.67" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4417" y="-5090.97" font-family="Times,serif" font-size="14.00">l3_attn_stage4_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage3_gpu0&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge1793" class="edge">
<title>l3_attn_stage3_gpu0&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1283.29,-5211.67C1297.43,-5205.33 1312.95,-5199.52 1328,-5196.17 1557.73,-5145.03 3210.66,-5173.72 3446,-5171.17 3490.94,-5170.68 4210.97,-5172.2 4255,-5163.17 4298.87,-5154.17 4345.77,-5133.25 4377.76,-5117.06"/>
<polygon fill="red" stroke="red" points="4379.49,-5120.11 4386.78,-5112.43 4376.28,-5113.89 4379.49,-5120.11"/>
<text text-anchor="middle" x="3477.5" y="-5174.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu1 -->
<g id="node722" class="node">
<title>l3_attn_stage4_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1425" cy="-5094.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1425" y="-5105.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="1425" y="-5090.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1425" y="-5075.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu1&#45;&gt;l3_attn_stage4_gpu1 -->
<g id="edge674" class="edge">
<title>l3_attn_stage3_gpu1&#45;&gt;l3_attn_stage4_gpu1</title>
<path fill="none" stroke="black" d="M1425,-5204.08C1425,-5185.36 1425,-5162.37 1425,-5142.38"/>
<polygon fill="black" stroke="black" points="1428.5,-5142.24 1425,-5132.24 1421.5,-5142.24 1428.5,-5142.24"/>
</g>
<!-- l3_attn_stage3_gpu1&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge1794" class="edge">
<title>l3_attn_stage3_gpu1&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1478.28,-5211.6C1492.41,-5205.26 1507.94,-5199.46 1523,-5196.17 1577,-5184.34 3460.82,-5204.43 3513,-5186.17 3523.15,-5182.61 3521.86,-5174.75 3532,-5171.17 3569.87,-5157.78 4215.66,-5171.26 4255,-5163.17 4298.87,-5154.14 4345.77,-5133.23 4377.76,-5117.05"/>
<polygon fill="red" stroke="red" points="4379.48,-5120.1 4386.78,-5112.41 4376.28,-5113.87 4379.48,-5120.1"/>
<text text-anchor="middle" x="3563.5" y="-5174.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu2 -->
<g id="node723" class="node">
<title>l3_attn_stage4_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1620" cy="-5094.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1620" y="-5105.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="1620" y="-5090.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1620" y="-5075.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu2&#45;&gt;l3_attn_stage4_gpu2 -->
<g id="edge675" class="edge">
<title>l3_attn_stage3_gpu2&#45;&gt;l3_attn_stage4_gpu2</title>
<path fill="none" stroke="black" d="M1620,-5204.08C1620,-5185.36 1620,-5162.37 1620,-5142.38"/>
<polygon fill="black" stroke="black" points="1623.5,-5142.24 1620,-5132.24 1616.5,-5142.24 1623.5,-5142.24"/>
</g>
<!-- l3_attn_stage3_gpu2&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge1795" class="edge">
<title>l3_attn_stage3_gpu2&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1673.28,-5211.6C1687.41,-5205.26 1702.94,-5199.47 1718,-5196.17 1769.04,-5184.98 3549.68,-5203.43 3599,-5186.17 3609.15,-5182.61 3607.86,-5174.76 3618,-5171.17 3651.36,-5159.35 4220.34,-5170.32 4255,-5163.17 4298.86,-5154.11 4345.76,-5133.2 4377.75,-5117.03"/>
<polygon fill="red" stroke="red" points="4379.48,-5120.08 4386.77,-5112.4 4376.28,-5113.85 4379.48,-5120.08"/>
<text text-anchor="middle" x="3649.5" y="-5174.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu3 -->
<g id="node724" class="node">
<title>l3_attn_stage4_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1815" cy="-5094.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1815" y="-5105.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="1815" y="-5090.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1815" y="-5075.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu3&#45;&gt;l3_attn_stage4_gpu3 -->
<g id="edge676" class="edge">
<title>l3_attn_stage3_gpu3&#45;&gt;l3_attn_stage4_gpu3</title>
<path fill="none" stroke="black" d="M1815,-5204.08C1815,-5185.36 1815,-5162.37 1815,-5142.38"/>
<polygon fill="black" stroke="black" points="1818.5,-5142.24 1815,-5132.24 1811.5,-5142.24 1818.5,-5142.24"/>
</g>
<!-- l3_attn_stage3_gpu3&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge1796" class="edge">
<title>l3_attn_stage3_gpu3&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1868.28,-5211.6C1882.41,-5205.26 1897.94,-5199.47 1913,-5196.17 1961.08,-5185.62 3638.55,-5202.44 3685,-5186.17 3695.15,-5182.61 3693.86,-5174.77 3704,-5171.17 3732.85,-5160.92 4225.02,-5169.39 4255,-5163.17 4298.85,-5154.06 4345.75,-5133.16 4377.75,-5117.01"/>
<polygon fill="red" stroke="red" points="4379.47,-5120.06 4386.77,-5112.38 4376.27,-5113.83 4379.47,-5120.06"/>
<text text-anchor="middle" x="3735.5" y="-5174.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu4 -->
<g id="node725" class="node">
<title>l3_attn_stage4_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2010" cy="-5094.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2010" y="-5105.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="2010" y="-5090.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2010" y="-5075.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu4&#45;&gt;l3_attn_stage4_gpu4 -->
<g id="edge677" class="edge">
<title>l3_attn_stage3_gpu4&#45;&gt;l3_attn_stage4_gpu4</title>
<path fill="none" stroke="black" d="M2010,-5204.08C2010,-5185.36 2010,-5162.37 2010,-5142.38"/>
<polygon fill="black" stroke="black" points="2013.5,-5142.24 2010,-5132.24 2006.5,-5142.24 2013.5,-5142.24"/>
</g>
<!-- l3_attn_stage3_gpu4&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge1797" class="edge">
<title>l3_attn_stage3_gpu4&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2063.28,-5211.61C2077.41,-5205.27 2092.94,-5199.47 2108,-5196.17 2153.12,-5186.26 3727.41,-5201.45 3771,-5186.17 3781.15,-5182.61 3779.87,-5174.78 3790,-5171.17 3838.67,-5153.8 4204.42,-5173.74 4255,-5163.17 4298.84,-5154 4345.74,-5133.11 4377.74,-5116.98"/>
<polygon fill="red" stroke="red" points="4379.46,-5120.03 4386.76,-5112.35 4376.27,-5113.8 4379.46,-5120.03"/>
<text text-anchor="middle" x="3821.5" y="-5174.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu5 -->
<g id="node726" class="node">
<title>l3_attn_stage4_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2205" cy="-5094.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2205" y="-5105.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="2205" y="-5090.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2205" y="-5075.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu5&#45;&gt;l3_attn_stage4_gpu5 -->
<g id="edge678" class="edge">
<title>l3_attn_stage3_gpu5&#45;&gt;l3_attn_stage4_gpu5</title>
<path fill="none" stroke="black" d="M2205,-5204.08C2205,-5185.36 2205,-5162.37 2205,-5142.38"/>
<polygon fill="black" stroke="black" points="2208.5,-5142.24 2205,-5132.24 2201.5,-5142.24 2208.5,-5142.24"/>
</g>
<!-- l3_attn_stage3_gpu5&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge1798" class="edge">
<title>l3_attn_stage3_gpu5&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2258.28,-5211.61C2272.41,-5205.27 2287.94,-5199.47 2303,-5196.17 2345.16,-5186.9 3816.27,-5200.45 3857,-5186.17 3867.15,-5182.6 3865.87,-5174.8 3876,-5171.17 3915.64,-5156.93 4213.79,-5171.86 4255,-5163.17 4298.82,-5153.92 4345.73,-5133.04 4377.73,-5116.93"/>
<polygon fill="red" stroke="red" points="4379.45,-5119.98 4386.75,-5112.32 4376.26,-5113.75 4379.45,-5119.98"/>
<text text-anchor="middle" x="3907.5" y="-5174.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu6 -->
<g id="node727" class="node">
<title>l3_attn_stage4_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2400" cy="-5094.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2400" y="-5105.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="2400" y="-5090.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2400" y="-5075.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu6&#45;&gt;l3_attn_stage4_gpu6 -->
<g id="edge679" class="edge">
<title>l3_attn_stage3_gpu6&#45;&gt;l3_attn_stage4_gpu6</title>
<path fill="none" stroke="black" d="M2400,-5204.08C2400,-5185.36 2400,-5162.37 2400,-5142.38"/>
<polygon fill="black" stroke="black" points="2403.5,-5142.24 2400,-5132.24 2396.5,-5142.24 2403.5,-5142.24"/>
</g>
<!-- l3_attn_stage3_gpu6&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge1799" class="edge">
<title>l3_attn_stage3_gpu6&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2453.28,-5211.62C2467.41,-5205.28 2482.94,-5199.48 2498,-5196.17 2537.2,-5187.54 3905.13,-5199.46 3943,-5186.17 3953.15,-5182.6 3951.89,-5174.83 3962,-5171.17 3992.62,-5160.07 4223.15,-5169.99 4255,-5163.17 4298.66,-5153.81 4345.41,-5133.05 4377.42,-5117.01"/>
<polygon fill="red" stroke="red" points="4379.12,-5120.06 4386.45,-5112.41 4375.95,-5113.83 4379.12,-5120.06"/>
<text text-anchor="middle" x="3993.5" y="-5174.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu7 -->
<g id="node728" class="node">
<title>l3_attn_stage4_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2595" cy="-5094.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2595" y="-5105.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="2595" y="-5090.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2595" y="-5075.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu7&#45;&gt;l3_attn_stage4_gpu7 -->
<g id="edge680" class="edge">
<title>l3_attn_stage3_gpu7&#45;&gt;l3_attn_stage4_gpu7</title>
<path fill="none" stroke="black" d="M2595,-5204.08C2595,-5185.36 2595,-5162.37 2595,-5142.38"/>
<polygon fill="black" stroke="black" points="2598.5,-5142.24 2595,-5132.24 2591.5,-5142.24 2598.5,-5142.24"/>
</g>
<!-- l3_attn_stage3_gpu7&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge1800" class="edge">
<title>l3_attn_stage3_gpu7&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2648.28,-5211.62C2662.42,-5205.28 2677.95,-5199.48 2693,-5196.17 2729.24,-5188.18 3993.99,-5198.47 4029,-5186.17 4039.15,-5182.6 4037.91,-5174.89 4048,-5171.17 4091.19,-5155.23 4210.04,-5173.06 4255,-5163.17 4298.6,-5153.57 4345.37,-5132.84 4377.39,-5116.87"/>
<polygon fill="red" stroke="red" points="4379.08,-5119.94 4386.42,-5112.3 4375.92,-5113.69 4379.08,-5119.94"/>
<text text-anchor="middle" x="4079.5" y="-5174.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu8 -->
<g id="node729" class="node">
<title>l3_attn_stage4_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2790" cy="-5094.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2790" y="-5105.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="2790" y="-5090.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2790" y="-5075.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu8&#45;&gt;l3_attn_stage4_gpu8 -->
<g id="edge681" class="edge">
<title>l3_attn_stage3_gpu8&#45;&gt;l3_attn_stage4_gpu8</title>
<path fill="none" stroke="black" d="M2790,-5204.08C2790,-5185.36 2790,-5162.37 2790,-5142.38"/>
<polygon fill="black" stroke="black" points="2793.5,-5142.24 2790,-5132.24 2786.5,-5142.24 2793.5,-5142.24"/>
</g>
<!-- l3_attn_stage3_gpu8&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge1801" class="edge">
<title>l3_attn_stage3_gpu8&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2843.28,-5211.63C2857.42,-5205.29 2872.95,-5199.49 2888,-5196.17 2954.57,-5181.48 4050.69,-5208.78 4115,-5186.17 4125.15,-5182.6 4123.96,-5175.03 4134,-5171.17 4184.3,-5151.82 4202.53,-5175.47 4255,-5163.17 4298.2,-5153.03 4344.67,-5132.59 4376.71,-5116.84"/>
<polygon fill="red" stroke="red" points="4378.38,-5119.92 4385.77,-5112.33 4375.25,-5113.66 4378.38,-5119.92"/>
<text text-anchor="middle" x="4165.5" y="-5174.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu9 -->
<g id="node730" class="node">
<title>l3_attn_stage4_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2985" cy="-5094.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2985" y="-5105.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="2985" y="-5090.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2985" y="-5075.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu9&#45;&gt;l3_attn_stage4_gpu9 -->
<g id="edge682" class="edge">
<title>l3_attn_stage3_gpu9&#45;&gt;l3_attn_stage4_gpu9</title>
<path fill="none" stroke="black" d="M2985,-5204.08C2985,-5185.36 2985,-5162.37 2985,-5142.38"/>
<polygon fill="black" stroke="black" points="2988.5,-5142.24 2985,-5132.24 2981.5,-5142.24 2988.5,-5142.24"/>
</g>
<!-- l3_attn_stage3_gpu9&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge1802" class="edge">
<title>l3_attn_stage3_gpu9&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3038.28,-5211.64C3052.42,-5205.3 3067.95,-5199.49 3083,-5196.17 3143.65,-5182.76 4142.41,-5206.8 4201,-5186.17 4211.15,-5182.59 4210.3,-5175.81 4220,-5171.17 4234.39,-5164.28 4239.8,-5168.03 4255,-5163.17 4295.94,-5150.06 4340.95,-5130.9 4373.12,-5116.34"/>
<polygon fill="red" stroke="red" points="4374.61,-5119.51 4382.25,-5112.17 4371.7,-5113.14 4374.61,-5119.51"/>
<text text-anchor="middle" x="4251.5" y="-5174.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu10 -->
<g id="node731" class="node">
<title>l3_attn_stage4_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3180" cy="-5094.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3180" y="-5105.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="3180" y="-5090.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3180" y="-5075.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu10&#45;&gt;l3_attn_stage4_gpu10 -->
<g id="edge683" class="edge">
<title>l3_attn_stage3_gpu10&#45;&gt;l3_attn_stage4_gpu10</title>
<path fill="none" stroke="black" d="M3180,-5204.08C3180,-5185.36 3180,-5162.37 3180,-5142.38"/>
<polygon fill="black" stroke="black" points="3183.5,-5142.24 3180,-5132.24 3176.5,-5142.24 3183.5,-5142.24"/>
</g>
<!-- l3_attn_stage3_gpu10&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge1803" class="edge">
<title>l3_attn_stage3_gpu10&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3233.29,-5211.65C3247.42,-5205.31 3262.95,-5199.5 3278,-5196.17 3332.73,-5184.04 4234.13,-5204.81 4287,-5186.17 4297.15,-5182.59 4297.32,-5177.53 4306,-5171.17 4331.22,-5152.67 4360.5,-5132.82 4382.65,-5118.12"/>
<polygon fill="red" stroke="red" points="4384.66,-5120.99 4391.07,-5112.55 4380.8,-5115.15 4384.66,-5120.99"/>
<text text-anchor="middle" x="4337.5" y="-5174.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu11 -->
<g id="node732" class="node">
<title>l3_attn_stage4_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3375" cy="-5094.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3375" y="-5105.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="3375" y="-5090.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3375" y="-5075.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu11&#45;&gt;l3_attn_stage4_gpu11 -->
<g id="edge684" class="edge">
<title>l3_attn_stage3_gpu11&#45;&gt;l3_attn_stage4_gpu11</title>
<path fill="none" stroke="black" d="M3375,-5204.08C3375,-5185.36 3375,-5162.37 3375,-5142.38"/>
<polygon fill="black" stroke="black" points="3378.5,-5142.24 3375,-5132.24 3371.5,-5142.24 3378.5,-5142.24"/>
</g>
<!-- l3_attn_stage3_gpu11&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge1804" class="edge">
<title>l3_attn_stage3_gpu11&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3428.29,-5211.66C3442.42,-5205.32 3457.95,-5199.51 3473,-5196.17 3497.41,-5190.74 4351.88,-5199.55 4373,-5186.17 4394.94,-5172.27 4406.24,-5143.99 4411.85,-5122.72"/>
<polygon fill="red" stroke="red" points="4415.27,-5123.47 4414.18,-5112.94 4408.46,-5121.86 4415.27,-5123.47"/>
<text text-anchor="middle" x="4419.5" y="-5174.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu12 -->
<g id="node733" class="node">
<title>l3_attn_stage4_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3570" cy="-5094.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3570" y="-5105.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="3570" y="-5090.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3570" y="-5075.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu12&#45;&gt;l3_attn_stage4_gpu12 -->
<g id="edge685" class="edge">
<title>l3_attn_stage3_gpu12&#45;&gt;l3_attn_stage4_gpu12</title>
<path fill="none" stroke="black" d="M3514.85,-5212.2C3501.43,-5206.17 3486.93,-5200.36 3473,-5196.17 3459.22,-5192.01 3418.36,-5197.1 3409,-5186.17 3374.08,-5145.36 3414.79,-5185.49 3473,-5163.17 3490.78,-5156.35 3508.42,-5145.6 3523.68,-5134.67"/>
<polygon fill="black" stroke="black" points="3525.93,-5137.36 3531.9,-5128.6 3521.77,-5131.73 3525.93,-5137.36"/>
</g>
<!-- l3_attn_stage3_gpu12&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge1805" class="edge">
<title>l3_attn_stage3_gpu12&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3623.29,-5211.68C3637.43,-5205.34 3652.95,-5199.52 3668,-5196.17 3689.45,-5191.38 4443.56,-5201.8 4459,-5186.17 4477.16,-5167.78 4459.89,-5140.08 4442.31,-5120.18"/>
<polygon fill="red" stroke="red" points="4444.75,-5117.65 4435.38,-5112.7 4439.61,-5122.41 4444.75,-5117.65"/>
<text text-anchor="middle" x="4497.5" y="-5174.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu13 -->
<g id="node734" class="node">
<title>l3_attn_stage4_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3765" cy="-5094.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3765" y="-5105.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="3765" y="-5090.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3765" y="-5075.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu13&#45;&gt;l3_attn_stage4_gpu13 -->
<g id="edge686" class="edge">
<title>l3_attn_stage3_gpu13&#45;&gt;l3_attn_stage4_gpu13</title>
<path fill="none" stroke="black" d="M3711.7,-5211.72C3697.85,-5205.47 3682.69,-5199.68 3668,-5196.17 3654.37,-5192.9 3425.71,-5196.27 3416,-5186.17 3411.38,-5181.36 3411.36,-5175.95 3416,-5171.17 3425.75,-5161.11 3654.7,-5167.57 3668,-5163.17 3686.4,-5157.07 3704.44,-5146.28 3719.87,-5135.08"/>
<polygon fill="black" stroke="black" points="3722.27,-5137.66 3728.16,-5128.85 3718.06,-5132.06 3722.27,-5137.66"/>
</g>
<!-- l3_attn_stage3_gpu13&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge1806" class="edge">
<title>l3_attn_stage3_gpu13&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3818.3,-5211.7C3832.43,-5205.36 3847.96,-5199.54 3863,-5196.17 3881.49,-5192.02 4531.7,-5199.66 4545,-5186.17 4573.36,-5157.39 4525.79,-5131.56 4480.82,-5114.93"/>
<polygon fill="red" stroke="red" points="4481.88,-5111.59 4471.29,-5111.52 4479.53,-5118.18 4481.88,-5111.59"/>
<text text-anchor="middle" x="4584.5" y="-5174.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu14 -->
<g id="node735" class="node">
<title>l3_attn_stage4_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3960" cy="-5094.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3960" y="-5105.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="3960" y="-5090.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3960" y="-5075.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu14&#45;&gt;l3_attn_stage4_gpu14 -->
<g id="edge687" class="edge">
<title>l3_attn_stage3_gpu14&#45;&gt;l3_attn_stage4_gpu14</title>
<path fill="none" stroke="black" d="M3906.74,-5211.55C3892.89,-5205.3 3877.71,-5199.56 3863,-5196.17 3839.17,-5190.68 3440.09,-5203.65 3423,-5186.17 3418.34,-5181.4 3418.33,-5175.92 3423,-5171.17 3431.56,-5162.44 3851.37,-5166.93 3863,-5163.17 3881.45,-5157.19 3899.49,-5146.43 3914.92,-5135.23"/>
<polygon fill="black" stroke="black" points="3917.32,-5137.8 3923.2,-5128.99 3913.11,-5132.21 3917.32,-5137.8"/>
</g>
<!-- l3_attn_stage3_gpu14&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge1807" class="edge">
<title>l3_attn_stage3_gpu14&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4013.3,-5211.73C4027.44,-5205.38 4042.96,-5199.56 4058,-5196.17 4073.53,-5192.66 4619.84,-5197.52 4631,-5186.17 4671.03,-5145.43 4601.32,-5122.07 4531.01,-5109.33"/>
<polygon fill="red" stroke="red" points="4531.55,-5105.87 4521.1,-5107.6 4530.35,-5112.76 4531.55,-5105.87"/>
<text text-anchor="middle" x="4671.5" y="-5174.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage4_gpu15 -->
<g id="node736" class="node">
<title>l3_attn_stage4_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4155" cy="-5094.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4155" y="-5105.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage4</text>
<text text-anchor="middle" x="4155" y="-5090.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4155" y="-5075.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage3_gpu15&#45;&gt;l3_attn_stage4_gpu15 -->
<g id="edge688" class="edge">
<title>l3_attn_stage3_gpu15&#45;&gt;l3_attn_stage4_gpu15</title>
<path fill="none" stroke="black" d="M4102.02,-5211.59C4088.09,-5205.3 4072.82,-5199.53 4058,-5196.17 4040.99,-5192.31 3442.24,-5198.6 3430,-5186.17 3425.32,-5181.41 3425.32,-5175.91 3430,-5171.17 3442.26,-5158.75 4041.39,-5168.49 4058,-5163.17 4076.46,-5157.24 4094.51,-5146.5 4109.94,-5135.29"/>
<polygon fill="black" stroke="black" points="4112.34,-5137.86 4118.22,-5129.05 4108.13,-5132.27 4112.34,-5137.86"/>
</g>
<!-- l3_attn_stage3_gpu15&#45;&gt;l3_attn_stage4_gpu[next_gpu] -->
<g id="edge1808" class="edge">
<title>l3_attn_stage3_gpu15&#45;&gt;l3_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4210.38,-5212.35C4225.74,-5205.79 4242.68,-5199.7 4259,-5196.17 4283.87,-5190.78 4699.2,-5204.36 4717,-5186.17 4771.67,-5130.29 4670.45,-5108.63 4571.12,-5100.38"/>
<polygon fill="red" stroke="red" points="4571.15,-5096.87 4560.9,-5099.57 4570.6,-5103.84 4571.15,-5096.87"/>
<text text-anchor="middle" x="4757.5" y="-5174.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu0 -->
<g id="node737" class="node">
<title>l3_attn_stage5_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1230" cy="-4947.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1230" y="-4958.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="1230" y="-4943.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1230" y="-4928.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu0&#45;&gt;l3_attn_stage5_gpu0 -->
<g id="edge689" class="edge">
<title>l3_attn_stage4_gpu0&#45;&gt;l3_attn_stage5_gpu0</title>
<path fill="none" stroke="black" d="M1230,-5057.08C1230,-5038.36 1230,-5015.37 1230,-4995.38"/>
<polygon fill="black" stroke="black" points="1233.5,-4995.24 1230,-4985.24 1226.5,-4995.24 1233.5,-4995.24"/>
</g>
<!-- l3_attn_stage5_gpu[next_gpu] -->
<g id="node1347" class="node">
<title>l3_attn_stage5_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4417" cy="-4947.67" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4417" y="-4943.97" font-family="Times,serif" font-size="14.00">l3_attn_stage5_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage4_gpu0&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge1809" class="edge">
<title>l3_attn_stage4_gpu0&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1283.29,-5064.67C1297.43,-5058.33 1312.95,-5052.52 1328,-5049.17 1557.73,-4998.03 3210.66,-5026.72 3446,-5024.17 3490.94,-5023.68 4210.97,-5025.2 4255,-5016.17 4298.87,-5007.17 4345.77,-4986.25 4377.76,-4970.06"/>
<polygon fill="red" stroke="red" points="4379.49,-4973.11 4386.78,-4965.43 4376.28,-4966.89 4379.49,-4973.11"/>
<text text-anchor="middle" x="3477.5" y="-5027.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu1 -->
<g id="node738" class="node">
<title>l3_attn_stage5_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1425" cy="-4947.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1425" y="-4958.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="1425" y="-4943.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1425" y="-4928.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu1&#45;&gt;l3_attn_stage5_gpu1 -->
<g id="edge690" class="edge">
<title>l3_attn_stage4_gpu1&#45;&gt;l3_attn_stage5_gpu1</title>
<path fill="none" stroke="black" d="M1425,-5057.08C1425,-5038.36 1425,-5015.37 1425,-4995.38"/>
<polygon fill="black" stroke="black" points="1428.5,-4995.24 1425,-4985.24 1421.5,-4995.24 1428.5,-4995.24"/>
</g>
<!-- l3_attn_stage4_gpu1&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge1810" class="edge">
<title>l3_attn_stage4_gpu1&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1478.28,-5064.6C1492.41,-5058.26 1507.94,-5052.46 1523,-5049.17 1577,-5037.34 3460.82,-5057.43 3513,-5039.17 3523.15,-5035.61 3521.86,-5027.75 3532,-5024.17 3569.87,-5010.78 4215.66,-5024.26 4255,-5016.17 4298.87,-5007.14 4345.77,-4986.23 4377.76,-4970.05"/>
<polygon fill="red" stroke="red" points="4379.48,-4973.1 4386.78,-4965.41 4376.28,-4966.87 4379.48,-4973.1"/>
<text text-anchor="middle" x="3563.5" y="-5027.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu2 -->
<g id="node739" class="node">
<title>l3_attn_stage5_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1620" cy="-4947.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1620" y="-4958.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="1620" y="-4943.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1620" y="-4928.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu2&#45;&gt;l3_attn_stage5_gpu2 -->
<g id="edge691" class="edge">
<title>l3_attn_stage4_gpu2&#45;&gt;l3_attn_stage5_gpu2</title>
<path fill="none" stroke="black" d="M1620,-5057.08C1620,-5038.36 1620,-5015.37 1620,-4995.38"/>
<polygon fill="black" stroke="black" points="1623.5,-4995.24 1620,-4985.24 1616.5,-4995.24 1623.5,-4995.24"/>
</g>
<!-- l3_attn_stage4_gpu2&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge1811" class="edge">
<title>l3_attn_stage4_gpu2&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1673.28,-5064.6C1687.41,-5058.26 1702.94,-5052.47 1718,-5049.17 1769.04,-5037.98 3549.68,-5056.43 3599,-5039.17 3609.15,-5035.61 3607.86,-5027.76 3618,-5024.17 3651.36,-5012.35 4220.34,-5023.32 4255,-5016.17 4298.86,-5007.11 4345.76,-4986.2 4377.75,-4970.03"/>
<polygon fill="red" stroke="red" points="4379.48,-4973.08 4386.77,-4965.4 4376.28,-4966.85 4379.48,-4973.08"/>
<text text-anchor="middle" x="3649.5" y="-5027.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu3 -->
<g id="node740" class="node">
<title>l3_attn_stage5_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1815" cy="-4947.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1815" y="-4958.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="1815" y="-4943.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1815" y="-4928.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu3&#45;&gt;l3_attn_stage5_gpu3 -->
<g id="edge692" class="edge">
<title>l3_attn_stage4_gpu3&#45;&gt;l3_attn_stage5_gpu3</title>
<path fill="none" stroke="black" d="M1815,-5057.08C1815,-5038.36 1815,-5015.37 1815,-4995.38"/>
<polygon fill="black" stroke="black" points="1818.5,-4995.24 1815,-4985.24 1811.5,-4995.24 1818.5,-4995.24"/>
</g>
<!-- l3_attn_stage4_gpu3&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge1812" class="edge">
<title>l3_attn_stage4_gpu3&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1868.28,-5064.6C1882.41,-5058.26 1897.94,-5052.47 1913,-5049.17 1961.08,-5038.62 3638.55,-5055.44 3685,-5039.17 3695.15,-5035.61 3693.86,-5027.77 3704,-5024.17 3732.85,-5013.92 4225.02,-5022.39 4255,-5016.17 4298.85,-5007.06 4345.75,-4986.16 4377.75,-4970.01"/>
<polygon fill="red" stroke="red" points="4379.47,-4973.06 4386.77,-4965.38 4376.27,-4966.83 4379.47,-4973.06"/>
<text text-anchor="middle" x="3735.5" y="-5027.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu4 -->
<g id="node741" class="node">
<title>l3_attn_stage5_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2010" cy="-4947.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2010" y="-4958.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="2010" y="-4943.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2010" y="-4928.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu4&#45;&gt;l3_attn_stage5_gpu4 -->
<g id="edge693" class="edge">
<title>l3_attn_stage4_gpu4&#45;&gt;l3_attn_stage5_gpu4</title>
<path fill="none" stroke="black" d="M2010,-5057.08C2010,-5038.36 2010,-5015.37 2010,-4995.38"/>
<polygon fill="black" stroke="black" points="2013.5,-4995.24 2010,-4985.24 2006.5,-4995.24 2013.5,-4995.24"/>
</g>
<!-- l3_attn_stage4_gpu4&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge1813" class="edge">
<title>l3_attn_stage4_gpu4&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2063.28,-5064.61C2077.41,-5058.27 2092.94,-5052.47 2108,-5049.17 2153.12,-5039.26 3727.41,-5054.45 3771,-5039.17 3781.15,-5035.61 3779.87,-5027.78 3790,-5024.17 3838.67,-5006.8 4204.42,-5026.74 4255,-5016.17 4298.84,-5007 4345.74,-4986.11 4377.74,-4969.98"/>
<polygon fill="red" stroke="red" points="4379.46,-4973.03 4386.76,-4965.35 4376.27,-4966.8 4379.46,-4973.03"/>
<text text-anchor="middle" x="3821.5" y="-5027.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu5 -->
<g id="node742" class="node">
<title>l3_attn_stage5_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2205" cy="-4947.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2205" y="-4958.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="2205" y="-4943.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2205" y="-4928.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu5&#45;&gt;l3_attn_stage5_gpu5 -->
<g id="edge694" class="edge">
<title>l3_attn_stage4_gpu5&#45;&gt;l3_attn_stage5_gpu5</title>
<path fill="none" stroke="black" d="M2205,-5057.08C2205,-5038.36 2205,-5015.37 2205,-4995.38"/>
<polygon fill="black" stroke="black" points="2208.5,-4995.24 2205,-4985.24 2201.5,-4995.24 2208.5,-4995.24"/>
</g>
<!-- l3_attn_stage4_gpu5&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge1814" class="edge">
<title>l3_attn_stage4_gpu5&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2258.28,-5064.61C2272.41,-5058.27 2287.94,-5052.47 2303,-5049.17 2345.16,-5039.9 3816.27,-5053.45 3857,-5039.17 3867.15,-5035.6 3865.87,-5027.8 3876,-5024.17 3915.64,-5009.93 4213.79,-5024.86 4255,-5016.17 4298.82,-5006.92 4345.73,-4986.04 4377.73,-4969.93"/>
<polygon fill="red" stroke="red" points="4379.45,-4972.98 4386.75,-4965.32 4376.26,-4966.75 4379.45,-4972.98"/>
<text text-anchor="middle" x="3907.5" y="-5027.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu6 -->
<g id="node743" class="node">
<title>l3_attn_stage5_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2400" cy="-4947.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2400" y="-4958.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="2400" y="-4943.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2400" y="-4928.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu6&#45;&gt;l3_attn_stage5_gpu6 -->
<g id="edge695" class="edge">
<title>l3_attn_stage4_gpu6&#45;&gt;l3_attn_stage5_gpu6</title>
<path fill="none" stroke="black" d="M2400,-5057.08C2400,-5038.36 2400,-5015.37 2400,-4995.38"/>
<polygon fill="black" stroke="black" points="2403.5,-4995.24 2400,-4985.24 2396.5,-4995.24 2403.5,-4995.24"/>
</g>
<!-- l3_attn_stage4_gpu6&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge1815" class="edge">
<title>l3_attn_stage4_gpu6&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2453.28,-5064.62C2467.41,-5058.28 2482.94,-5052.48 2498,-5049.17 2537.2,-5040.54 3905.13,-5052.46 3943,-5039.17 3953.15,-5035.6 3951.89,-5027.83 3962,-5024.17 3992.62,-5013.07 4223.15,-5022.99 4255,-5016.17 4298.66,-5006.81 4345.41,-4986.05 4377.42,-4970.01"/>
<polygon fill="red" stroke="red" points="4379.12,-4973.06 4386.45,-4965.41 4375.95,-4966.83 4379.12,-4973.06"/>
<text text-anchor="middle" x="3993.5" y="-5027.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu7 -->
<g id="node744" class="node">
<title>l3_attn_stage5_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2595" cy="-4947.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2595" y="-4958.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="2595" y="-4943.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2595" y="-4928.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu7&#45;&gt;l3_attn_stage5_gpu7 -->
<g id="edge696" class="edge">
<title>l3_attn_stage4_gpu7&#45;&gt;l3_attn_stage5_gpu7</title>
<path fill="none" stroke="black" d="M2595,-5057.08C2595,-5038.36 2595,-5015.37 2595,-4995.38"/>
<polygon fill="black" stroke="black" points="2598.5,-4995.24 2595,-4985.24 2591.5,-4995.24 2598.5,-4995.24"/>
</g>
<!-- l3_attn_stage4_gpu7&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge1816" class="edge">
<title>l3_attn_stage4_gpu7&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2648.28,-5064.62C2662.42,-5058.28 2677.95,-5052.48 2693,-5049.17 2729.24,-5041.18 3993.99,-5051.47 4029,-5039.17 4039.15,-5035.6 4037.91,-5027.89 4048,-5024.17 4091.19,-5008.23 4210.04,-5026.06 4255,-5016.17 4298.6,-5006.57 4345.37,-4985.84 4377.39,-4969.87"/>
<polygon fill="red" stroke="red" points="4379.08,-4972.94 4386.42,-4965.3 4375.92,-4966.69 4379.08,-4972.94"/>
<text text-anchor="middle" x="4079.5" y="-5027.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu8 -->
<g id="node745" class="node">
<title>l3_attn_stage5_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2790" cy="-4947.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2790" y="-4958.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="2790" y="-4943.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2790" y="-4928.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu8&#45;&gt;l3_attn_stage5_gpu8 -->
<g id="edge697" class="edge">
<title>l3_attn_stage4_gpu8&#45;&gt;l3_attn_stage5_gpu8</title>
<path fill="none" stroke="black" d="M2790,-5057.08C2790,-5038.36 2790,-5015.37 2790,-4995.38"/>
<polygon fill="black" stroke="black" points="2793.5,-4995.24 2790,-4985.24 2786.5,-4995.24 2793.5,-4995.24"/>
</g>
<!-- l3_attn_stage4_gpu8&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge1817" class="edge">
<title>l3_attn_stage4_gpu8&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2843.28,-5064.63C2857.42,-5058.29 2872.95,-5052.49 2888,-5049.17 2954.57,-5034.48 4050.69,-5061.78 4115,-5039.17 4125.15,-5035.6 4123.96,-5028.03 4134,-5024.17 4184.3,-5004.82 4202.53,-5028.47 4255,-5016.17 4298.2,-5006.03 4344.67,-4985.59 4376.71,-4969.84"/>
<polygon fill="red" stroke="red" points="4378.38,-4972.92 4385.77,-4965.33 4375.25,-4966.66 4378.38,-4972.92"/>
<text text-anchor="middle" x="4165.5" y="-5027.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu9 -->
<g id="node746" class="node">
<title>l3_attn_stage5_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2985" cy="-4947.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2985" y="-4958.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="2985" y="-4943.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2985" y="-4928.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu9&#45;&gt;l3_attn_stage5_gpu9 -->
<g id="edge698" class="edge">
<title>l3_attn_stage4_gpu9&#45;&gt;l3_attn_stage5_gpu9</title>
<path fill="none" stroke="black" d="M2985,-5057.08C2985,-5038.36 2985,-5015.37 2985,-4995.38"/>
<polygon fill="black" stroke="black" points="2988.5,-4995.24 2985,-4985.24 2981.5,-4995.24 2988.5,-4995.24"/>
</g>
<!-- l3_attn_stage4_gpu9&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge1818" class="edge">
<title>l3_attn_stage4_gpu9&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3038.28,-5064.64C3052.42,-5058.3 3067.95,-5052.49 3083,-5049.17 3143.65,-5035.76 4142.41,-5059.8 4201,-5039.17 4211.15,-5035.59 4210.3,-5028.81 4220,-5024.17 4234.39,-5017.28 4239.8,-5021.03 4255,-5016.17 4295.94,-5003.06 4340.95,-4983.9 4373.12,-4969.34"/>
<polygon fill="red" stroke="red" points="4374.61,-4972.51 4382.25,-4965.17 4371.7,-4966.14 4374.61,-4972.51"/>
<text text-anchor="middle" x="4251.5" y="-5027.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu10 -->
<g id="node747" class="node">
<title>l3_attn_stage5_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3180" cy="-4947.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3180" y="-4958.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="3180" y="-4943.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3180" y="-4928.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu10&#45;&gt;l3_attn_stage5_gpu10 -->
<g id="edge699" class="edge">
<title>l3_attn_stage4_gpu10&#45;&gt;l3_attn_stage5_gpu10</title>
<path fill="none" stroke="black" d="M3180,-5057.08C3180,-5038.36 3180,-5015.37 3180,-4995.38"/>
<polygon fill="black" stroke="black" points="3183.5,-4995.24 3180,-4985.24 3176.5,-4995.24 3183.5,-4995.24"/>
</g>
<!-- l3_attn_stage4_gpu10&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge1819" class="edge">
<title>l3_attn_stage4_gpu10&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3233.29,-5064.65C3247.42,-5058.31 3262.95,-5052.5 3278,-5049.17 3332.73,-5037.04 4234.13,-5057.81 4287,-5039.17 4297.15,-5035.59 4297.32,-5030.53 4306,-5024.17 4331.22,-5005.67 4360.5,-4985.82 4382.65,-4971.12"/>
<polygon fill="red" stroke="red" points="4384.66,-4973.99 4391.07,-4965.55 4380.8,-4968.15 4384.66,-4973.99"/>
<text text-anchor="middle" x="4337.5" y="-5027.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu11 -->
<g id="node748" class="node">
<title>l3_attn_stage5_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3375" cy="-4947.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3375" y="-4958.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="3375" y="-4943.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3375" y="-4928.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu11&#45;&gt;l3_attn_stage5_gpu11 -->
<g id="edge700" class="edge">
<title>l3_attn_stage4_gpu11&#45;&gt;l3_attn_stage5_gpu11</title>
<path fill="none" stroke="black" d="M3375,-5057.08C3375,-5038.36 3375,-5015.37 3375,-4995.38"/>
<polygon fill="black" stroke="black" points="3378.5,-4995.24 3375,-4985.24 3371.5,-4995.24 3378.5,-4995.24"/>
</g>
<!-- l3_attn_stage4_gpu11&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge1820" class="edge">
<title>l3_attn_stage4_gpu11&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3428.29,-5064.66C3442.42,-5058.32 3457.95,-5052.51 3473,-5049.17 3497.41,-5043.74 4351.88,-5052.55 4373,-5039.17 4394.94,-5025.27 4406.24,-4996.99 4411.85,-4975.72"/>
<polygon fill="red" stroke="red" points="4415.27,-4976.47 4414.18,-4965.94 4408.46,-4974.86 4415.27,-4976.47"/>
<text text-anchor="middle" x="4419.5" y="-5027.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu12 -->
<g id="node749" class="node">
<title>l3_attn_stage5_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3570" cy="-4947.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3570" y="-4958.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="3570" y="-4943.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3570" y="-4928.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu12&#45;&gt;l3_attn_stage5_gpu12 -->
<g id="edge701" class="edge">
<title>l3_attn_stage4_gpu12&#45;&gt;l3_attn_stage5_gpu12</title>
<path fill="none" stroke="black" d="M3514.85,-5065.2C3501.43,-5059.17 3486.93,-5053.36 3473,-5049.17 3459.22,-5045.01 3418.36,-5050.1 3409,-5039.17 3374.08,-4998.36 3414.79,-5038.49 3473,-5016.17 3490.78,-5009.35 3508.42,-4998.6 3523.68,-4987.67"/>
<polygon fill="black" stroke="black" points="3525.93,-4990.36 3531.9,-4981.6 3521.77,-4984.73 3525.93,-4990.36"/>
</g>
<!-- l3_attn_stage4_gpu12&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge1821" class="edge">
<title>l3_attn_stage4_gpu12&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3623.29,-5064.68C3637.43,-5058.34 3652.95,-5052.52 3668,-5049.17 3689.45,-5044.38 4443.56,-5054.8 4459,-5039.17 4477.16,-5020.78 4459.89,-4993.08 4442.31,-4973.18"/>
<polygon fill="red" stroke="red" points="4444.75,-4970.65 4435.38,-4965.7 4439.61,-4975.41 4444.75,-4970.65"/>
<text text-anchor="middle" x="4497.5" y="-5027.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu13 -->
<g id="node750" class="node">
<title>l3_attn_stage5_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3765" cy="-4947.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3765" y="-4958.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="3765" y="-4943.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3765" y="-4928.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu13&#45;&gt;l3_attn_stage5_gpu13 -->
<g id="edge702" class="edge">
<title>l3_attn_stage4_gpu13&#45;&gt;l3_attn_stage5_gpu13</title>
<path fill="none" stroke="black" d="M3711.7,-5064.72C3697.85,-5058.47 3682.69,-5052.68 3668,-5049.17 3654.37,-5045.9 3425.71,-5049.27 3416,-5039.17 3411.38,-5034.36 3411.36,-5028.95 3416,-5024.17 3425.75,-5014.11 3654.7,-5020.57 3668,-5016.17 3686.4,-5010.07 3704.44,-4999.28 3719.87,-4988.08"/>
<polygon fill="black" stroke="black" points="3722.27,-4990.66 3728.16,-4981.85 3718.06,-4985.06 3722.27,-4990.66"/>
</g>
<!-- l3_attn_stage4_gpu13&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge1822" class="edge">
<title>l3_attn_stage4_gpu13&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3818.3,-5064.7C3832.43,-5058.36 3847.96,-5052.54 3863,-5049.17 3881.49,-5045.02 4531.7,-5052.66 4545,-5039.17 4573.36,-5010.39 4525.79,-4984.56 4480.82,-4967.93"/>
<polygon fill="red" stroke="red" points="4481.88,-4964.59 4471.29,-4964.52 4479.53,-4971.18 4481.88,-4964.59"/>
<text text-anchor="middle" x="4584.5" y="-5027.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu14 -->
<g id="node751" class="node">
<title>l3_attn_stage5_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3960" cy="-4947.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3960" y="-4958.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="3960" y="-4943.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3960" y="-4928.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu14&#45;&gt;l3_attn_stage5_gpu14 -->
<g id="edge703" class="edge">
<title>l3_attn_stage4_gpu14&#45;&gt;l3_attn_stage5_gpu14</title>
<path fill="none" stroke="black" d="M3906.74,-5064.55C3892.89,-5058.3 3877.71,-5052.56 3863,-5049.17 3839.17,-5043.68 3440.09,-5056.65 3423,-5039.17 3418.34,-5034.4 3418.33,-5028.92 3423,-5024.17 3431.56,-5015.44 3851.37,-5019.93 3863,-5016.17 3881.45,-5010.19 3899.49,-4999.43 3914.92,-4988.23"/>
<polygon fill="black" stroke="black" points="3917.32,-4990.8 3923.2,-4981.99 3913.11,-4985.21 3917.32,-4990.8"/>
</g>
<!-- l3_attn_stage4_gpu14&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge1823" class="edge">
<title>l3_attn_stage4_gpu14&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4013.3,-5064.73C4027.44,-5058.38 4042.96,-5052.56 4058,-5049.17 4073.53,-5045.66 4619.84,-5050.52 4631,-5039.17 4671.03,-4998.43 4601.32,-4975.07 4531.01,-4962.33"/>
<polygon fill="red" stroke="red" points="4531.55,-4958.87 4521.1,-4960.6 4530.35,-4965.76 4531.55,-4958.87"/>
<text text-anchor="middle" x="4671.5" y="-5027.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage5_gpu15 -->
<g id="node752" class="node">
<title>l3_attn_stage5_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4155" cy="-4947.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4155" y="-4958.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage5</text>
<text text-anchor="middle" x="4155" y="-4943.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4155" y="-4928.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage4_gpu15&#45;&gt;l3_attn_stage5_gpu15 -->
<g id="edge704" class="edge">
<title>l3_attn_stage4_gpu15&#45;&gt;l3_attn_stage5_gpu15</title>
<path fill="none" stroke="black" d="M4102.02,-5064.59C4088.09,-5058.3 4072.82,-5052.53 4058,-5049.17 4040.99,-5045.31 3442.24,-5051.6 3430,-5039.17 3425.32,-5034.41 3425.32,-5028.91 3430,-5024.17 3442.26,-5011.75 4041.39,-5021.49 4058,-5016.17 4076.46,-5010.24 4094.51,-4999.5 4109.94,-4988.29"/>
<polygon fill="black" stroke="black" points="4112.34,-4990.86 4118.22,-4982.05 4108.13,-4985.27 4112.34,-4990.86"/>
</g>
<!-- l3_attn_stage4_gpu15&#45;&gt;l3_attn_stage5_gpu[next_gpu] -->
<g id="edge1824" class="edge">
<title>l3_attn_stage4_gpu15&#45;&gt;l3_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4210.38,-5065.35C4225.74,-5058.79 4242.68,-5052.7 4259,-5049.17 4283.87,-5043.78 4699.2,-5057.36 4717,-5039.17 4771.67,-4983.29 4670.45,-4961.63 4571.12,-4953.38"/>
<polygon fill="red" stroke="red" points="4571.15,-4949.87 4560.9,-4952.57 4570.6,-4956.84 4571.15,-4949.87"/>
<text text-anchor="middle" x="4757.5" y="-5027.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu0 -->
<g id="node753" class="node">
<title>l3_attn_stage6_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1230" cy="-4800.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1230" y="-4811.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="1230" y="-4796.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1230" y="-4781.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu0&#45;&gt;l3_attn_stage6_gpu0 -->
<g id="edge705" class="edge">
<title>l3_attn_stage5_gpu0&#45;&gt;l3_attn_stage6_gpu0</title>
<path fill="none" stroke="black" d="M1230,-4910.08C1230,-4891.36 1230,-4868.37 1230,-4848.38"/>
<polygon fill="black" stroke="black" points="1233.5,-4848.24 1230,-4838.24 1226.5,-4848.24 1233.5,-4848.24"/>
</g>
<!-- l3_attn_stage6_gpu[next_gpu] -->
<g id="node1348" class="node">
<title>l3_attn_stage6_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4417" cy="-4800.67" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4417" y="-4796.97" font-family="Times,serif" font-size="14.00">l3_attn_stage6_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage5_gpu0&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge1825" class="edge">
<title>l3_attn_stage5_gpu0&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1283.29,-4917.67C1297.43,-4911.33 1312.95,-4905.52 1328,-4902.17 1557.73,-4851.03 3210.66,-4879.72 3446,-4877.17 3490.94,-4876.68 4210.97,-4878.2 4255,-4869.17 4298.87,-4860.17 4345.77,-4839.25 4377.76,-4823.06"/>
<polygon fill="red" stroke="red" points="4379.49,-4826.11 4386.78,-4818.43 4376.28,-4819.89 4379.49,-4826.11"/>
<text text-anchor="middle" x="3477.5" y="-4880.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu1 -->
<g id="node754" class="node">
<title>l3_attn_stage6_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1425" cy="-4800.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1425" y="-4811.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="1425" y="-4796.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1425" y="-4781.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu1&#45;&gt;l3_attn_stage6_gpu1 -->
<g id="edge706" class="edge">
<title>l3_attn_stage5_gpu1&#45;&gt;l3_attn_stage6_gpu1</title>
<path fill="none" stroke="black" d="M1425,-4910.08C1425,-4891.36 1425,-4868.37 1425,-4848.38"/>
<polygon fill="black" stroke="black" points="1428.5,-4848.24 1425,-4838.24 1421.5,-4848.24 1428.5,-4848.24"/>
</g>
<!-- l3_attn_stage5_gpu1&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge1826" class="edge">
<title>l3_attn_stage5_gpu1&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1478.28,-4917.6C1492.41,-4911.26 1507.94,-4905.46 1523,-4902.17 1577,-4890.34 3460.82,-4910.43 3513,-4892.17 3523.15,-4888.61 3521.86,-4880.75 3532,-4877.17 3569.87,-4863.78 4215.66,-4877.26 4255,-4869.17 4298.87,-4860.14 4345.77,-4839.23 4377.76,-4823.05"/>
<polygon fill="red" stroke="red" points="4379.48,-4826.1 4386.78,-4818.41 4376.28,-4819.87 4379.48,-4826.1"/>
<text text-anchor="middle" x="3563.5" y="-4880.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu2 -->
<g id="node755" class="node">
<title>l3_attn_stage6_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1620" cy="-4800.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1620" y="-4811.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="1620" y="-4796.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1620" y="-4781.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu2&#45;&gt;l3_attn_stage6_gpu2 -->
<g id="edge707" class="edge">
<title>l3_attn_stage5_gpu2&#45;&gt;l3_attn_stage6_gpu2</title>
<path fill="none" stroke="black" d="M1620,-4910.08C1620,-4891.36 1620,-4868.37 1620,-4848.38"/>
<polygon fill="black" stroke="black" points="1623.5,-4848.24 1620,-4838.24 1616.5,-4848.24 1623.5,-4848.24"/>
</g>
<!-- l3_attn_stage5_gpu2&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge1827" class="edge">
<title>l3_attn_stage5_gpu2&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1673.28,-4917.6C1687.41,-4911.26 1702.94,-4905.47 1718,-4902.17 1769.04,-4890.98 3549.68,-4909.43 3599,-4892.17 3609.15,-4888.61 3607.86,-4880.76 3618,-4877.17 3651.36,-4865.35 4220.34,-4876.32 4255,-4869.17 4298.86,-4860.11 4345.76,-4839.2 4377.75,-4823.03"/>
<polygon fill="red" stroke="red" points="4379.48,-4826.08 4386.77,-4818.4 4376.28,-4819.85 4379.48,-4826.08"/>
<text text-anchor="middle" x="3649.5" y="-4880.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu3 -->
<g id="node756" class="node">
<title>l3_attn_stage6_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1815" cy="-4800.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1815" y="-4811.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="1815" y="-4796.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1815" y="-4781.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu3&#45;&gt;l3_attn_stage6_gpu3 -->
<g id="edge708" class="edge">
<title>l3_attn_stage5_gpu3&#45;&gt;l3_attn_stage6_gpu3</title>
<path fill="none" stroke="black" d="M1815,-4910.08C1815,-4891.36 1815,-4868.37 1815,-4848.38"/>
<polygon fill="black" stroke="black" points="1818.5,-4848.24 1815,-4838.24 1811.5,-4848.24 1818.5,-4848.24"/>
</g>
<!-- l3_attn_stage5_gpu3&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge1828" class="edge">
<title>l3_attn_stage5_gpu3&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1868.28,-4917.6C1882.41,-4911.26 1897.94,-4905.47 1913,-4902.17 1961.08,-4891.62 3638.55,-4908.44 3685,-4892.17 3695.15,-4888.61 3693.86,-4880.77 3704,-4877.17 3732.85,-4866.92 4225.02,-4875.39 4255,-4869.17 4298.85,-4860.06 4345.75,-4839.16 4377.75,-4823.01"/>
<polygon fill="red" stroke="red" points="4379.47,-4826.06 4386.77,-4818.38 4376.27,-4819.83 4379.47,-4826.06"/>
<text text-anchor="middle" x="3735.5" y="-4880.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu4 -->
<g id="node757" class="node">
<title>l3_attn_stage6_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2010" cy="-4800.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2010" y="-4811.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="2010" y="-4796.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2010" y="-4781.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu4&#45;&gt;l3_attn_stage6_gpu4 -->
<g id="edge709" class="edge">
<title>l3_attn_stage5_gpu4&#45;&gt;l3_attn_stage6_gpu4</title>
<path fill="none" stroke="black" d="M2010,-4910.08C2010,-4891.36 2010,-4868.37 2010,-4848.38"/>
<polygon fill="black" stroke="black" points="2013.5,-4848.24 2010,-4838.24 2006.5,-4848.24 2013.5,-4848.24"/>
</g>
<!-- l3_attn_stage5_gpu4&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge1829" class="edge">
<title>l3_attn_stage5_gpu4&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2063.28,-4917.61C2077.41,-4911.27 2092.94,-4905.47 2108,-4902.17 2153.12,-4892.26 3727.41,-4907.45 3771,-4892.17 3781.15,-4888.61 3779.87,-4880.78 3790,-4877.17 3838.67,-4859.8 4204.42,-4879.74 4255,-4869.17 4298.84,-4860 4345.74,-4839.11 4377.74,-4822.98"/>
<polygon fill="red" stroke="red" points="4379.46,-4826.03 4386.76,-4818.35 4376.27,-4819.8 4379.46,-4826.03"/>
<text text-anchor="middle" x="3821.5" y="-4880.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu5 -->
<g id="node758" class="node">
<title>l3_attn_stage6_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2205" cy="-4800.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2205" y="-4811.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="2205" y="-4796.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2205" y="-4781.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu5&#45;&gt;l3_attn_stage6_gpu5 -->
<g id="edge710" class="edge">
<title>l3_attn_stage5_gpu5&#45;&gt;l3_attn_stage6_gpu5</title>
<path fill="none" stroke="black" d="M2205,-4910.08C2205,-4891.36 2205,-4868.37 2205,-4848.38"/>
<polygon fill="black" stroke="black" points="2208.5,-4848.24 2205,-4838.24 2201.5,-4848.24 2208.5,-4848.24"/>
</g>
<!-- l3_attn_stage5_gpu5&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge1830" class="edge">
<title>l3_attn_stage5_gpu5&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2258.28,-4917.61C2272.41,-4911.27 2287.94,-4905.47 2303,-4902.17 2345.16,-4892.9 3816.27,-4906.45 3857,-4892.17 3867.15,-4888.6 3865.87,-4880.8 3876,-4877.17 3915.64,-4862.93 4213.79,-4877.86 4255,-4869.17 4298.82,-4859.92 4345.73,-4839.04 4377.73,-4822.93"/>
<polygon fill="red" stroke="red" points="4379.45,-4825.98 4386.75,-4818.32 4376.26,-4819.75 4379.45,-4825.98"/>
<text text-anchor="middle" x="3907.5" y="-4880.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu6 -->
<g id="node759" class="node">
<title>l3_attn_stage6_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2400" cy="-4800.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2400" y="-4811.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="2400" y="-4796.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2400" y="-4781.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu6&#45;&gt;l3_attn_stage6_gpu6 -->
<g id="edge711" class="edge">
<title>l3_attn_stage5_gpu6&#45;&gt;l3_attn_stage6_gpu6</title>
<path fill="none" stroke="black" d="M2400,-4910.08C2400,-4891.36 2400,-4868.37 2400,-4848.38"/>
<polygon fill="black" stroke="black" points="2403.5,-4848.24 2400,-4838.24 2396.5,-4848.24 2403.5,-4848.24"/>
</g>
<!-- l3_attn_stage5_gpu6&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge1831" class="edge">
<title>l3_attn_stage5_gpu6&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2453.28,-4917.62C2467.41,-4911.28 2482.94,-4905.48 2498,-4902.17 2537.2,-4893.54 3905.13,-4905.46 3943,-4892.17 3953.15,-4888.6 3951.89,-4880.83 3962,-4877.17 3992.62,-4866.07 4223.15,-4875.99 4255,-4869.17 4298.66,-4859.81 4345.41,-4839.05 4377.42,-4823.01"/>
<polygon fill="red" stroke="red" points="4379.12,-4826.06 4386.45,-4818.41 4375.95,-4819.83 4379.12,-4826.06"/>
<text text-anchor="middle" x="3993.5" y="-4880.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu7 -->
<g id="node760" class="node">
<title>l3_attn_stage6_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2595" cy="-4800.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2595" y="-4811.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="2595" y="-4796.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2595" y="-4781.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu7&#45;&gt;l3_attn_stage6_gpu7 -->
<g id="edge712" class="edge">
<title>l3_attn_stage5_gpu7&#45;&gt;l3_attn_stage6_gpu7</title>
<path fill="none" stroke="black" d="M2595,-4910.08C2595,-4891.36 2595,-4868.37 2595,-4848.38"/>
<polygon fill="black" stroke="black" points="2598.5,-4848.24 2595,-4838.24 2591.5,-4848.24 2598.5,-4848.24"/>
</g>
<!-- l3_attn_stage5_gpu7&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge1832" class="edge">
<title>l3_attn_stage5_gpu7&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2648.28,-4917.62C2662.42,-4911.28 2677.95,-4905.48 2693,-4902.17 2729.24,-4894.18 3993.99,-4904.47 4029,-4892.17 4039.15,-4888.6 4037.91,-4880.89 4048,-4877.17 4091.19,-4861.23 4210.04,-4879.06 4255,-4869.17 4298.6,-4859.57 4345.37,-4838.84 4377.39,-4822.87"/>
<polygon fill="red" stroke="red" points="4379.08,-4825.94 4386.42,-4818.3 4375.92,-4819.69 4379.08,-4825.94"/>
<text text-anchor="middle" x="4079.5" y="-4880.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu8 -->
<g id="node761" class="node">
<title>l3_attn_stage6_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2790" cy="-4800.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2790" y="-4811.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="2790" y="-4796.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2790" y="-4781.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu8&#45;&gt;l3_attn_stage6_gpu8 -->
<g id="edge713" class="edge">
<title>l3_attn_stage5_gpu8&#45;&gt;l3_attn_stage6_gpu8</title>
<path fill="none" stroke="black" d="M2790,-4910.08C2790,-4891.36 2790,-4868.37 2790,-4848.38"/>
<polygon fill="black" stroke="black" points="2793.5,-4848.24 2790,-4838.24 2786.5,-4848.24 2793.5,-4848.24"/>
</g>
<!-- l3_attn_stage5_gpu8&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge1833" class="edge">
<title>l3_attn_stage5_gpu8&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2843.28,-4917.63C2857.42,-4911.29 2872.95,-4905.49 2888,-4902.17 2954.57,-4887.48 4050.69,-4914.78 4115,-4892.17 4125.15,-4888.6 4123.96,-4881.03 4134,-4877.17 4184.3,-4857.82 4202.53,-4881.47 4255,-4869.17 4298.2,-4859.03 4344.67,-4838.59 4376.71,-4822.84"/>
<polygon fill="red" stroke="red" points="4378.38,-4825.92 4385.77,-4818.33 4375.25,-4819.66 4378.38,-4825.92"/>
<text text-anchor="middle" x="4165.5" y="-4880.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu9 -->
<g id="node762" class="node">
<title>l3_attn_stage6_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2985" cy="-4800.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2985" y="-4811.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="2985" y="-4796.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2985" y="-4781.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu9&#45;&gt;l3_attn_stage6_gpu9 -->
<g id="edge714" class="edge">
<title>l3_attn_stage5_gpu9&#45;&gt;l3_attn_stage6_gpu9</title>
<path fill="none" stroke="black" d="M2985,-4910.08C2985,-4891.36 2985,-4868.37 2985,-4848.38"/>
<polygon fill="black" stroke="black" points="2988.5,-4848.24 2985,-4838.24 2981.5,-4848.24 2988.5,-4848.24"/>
</g>
<!-- l3_attn_stage5_gpu9&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge1834" class="edge">
<title>l3_attn_stage5_gpu9&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3038.28,-4917.64C3052.42,-4911.3 3067.95,-4905.49 3083,-4902.17 3143.65,-4888.76 4142.41,-4912.8 4201,-4892.17 4211.15,-4888.59 4210.3,-4881.81 4220,-4877.17 4234.39,-4870.28 4239.8,-4874.03 4255,-4869.17 4295.94,-4856.06 4340.95,-4836.9 4373.12,-4822.34"/>
<polygon fill="red" stroke="red" points="4374.61,-4825.51 4382.25,-4818.17 4371.7,-4819.14 4374.61,-4825.51"/>
<text text-anchor="middle" x="4251.5" y="-4880.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu10 -->
<g id="node763" class="node">
<title>l3_attn_stage6_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3180" cy="-4800.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3180" y="-4811.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="3180" y="-4796.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3180" y="-4781.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu10&#45;&gt;l3_attn_stage6_gpu10 -->
<g id="edge715" class="edge">
<title>l3_attn_stage5_gpu10&#45;&gt;l3_attn_stage6_gpu10</title>
<path fill="none" stroke="black" d="M3180,-4910.08C3180,-4891.36 3180,-4868.37 3180,-4848.38"/>
<polygon fill="black" stroke="black" points="3183.5,-4848.24 3180,-4838.24 3176.5,-4848.24 3183.5,-4848.24"/>
</g>
<!-- l3_attn_stage5_gpu10&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge1835" class="edge">
<title>l3_attn_stage5_gpu10&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3233.29,-4917.65C3247.42,-4911.31 3262.95,-4905.5 3278,-4902.17 3332.73,-4890.04 4234.13,-4910.81 4287,-4892.17 4297.15,-4888.59 4297.32,-4883.53 4306,-4877.17 4331.22,-4858.67 4360.5,-4838.82 4382.65,-4824.12"/>
<polygon fill="red" stroke="red" points="4384.66,-4826.99 4391.07,-4818.55 4380.8,-4821.15 4384.66,-4826.99"/>
<text text-anchor="middle" x="4337.5" y="-4880.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu11 -->
<g id="node764" class="node">
<title>l3_attn_stage6_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3375" cy="-4800.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3375" y="-4811.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="3375" y="-4796.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3375" y="-4781.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu11&#45;&gt;l3_attn_stage6_gpu11 -->
<g id="edge716" class="edge">
<title>l3_attn_stage5_gpu11&#45;&gt;l3_attn_stage6_gpu11</title>
<path fill="none" stroke="black" d="M3375,-4910.08C3375,-4891.36 3375,-4868.37 3375,-4848.38"/>
<polygon fill="black" stroke="black" points="3378.5,-4848.24 3375,-4838.24 3371.5,-4848.24 3378.5,-4848.24"/>
</g>
<!-- l3_attn_stage5_gpu11&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge1836" class="edge">
<title>l3_attn_stage5_gpu11&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3428.29,-4917.66C3442.42,-4911.32 3457.95,-4905.51 3473,-4902.17 3497.41,-4896.74 4351.88,-4905.55 4373,-4892.17 4394.94,-4878.27 4406.24,-4849.99 4411.85,-4828.72"/>
<polygon fill="red" stroke="red" points="4415.27,-4829.47 4414.18,-4818.94 4408.46,-4827.86 4415.27,-4829.47"/>
<text text-anchor="middle" x="4419.5" y="-4880.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu12 -->
<g id="node765" class="node">
<title>l3_attn_stage6_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3570" cy="-4800.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3570" y="-4811.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="3570" y="-4796.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3570" y="-4781.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu12&#45;&gt;l3_attn_stage6_gpu12 -->
<g id="edge717" class="edge">
<title>l3_attn_stage5_gpu12&#45;&gt;l3_attn_stage6_gpu12</title>
<path fill="none" stroke="black" d="M3514.85,-4918.2C3501.43,-4912.17 3486.93,-4906.36 3473,-4902.17 3459.22,-4898.01 3418.36,-4903.1 3409,-4892.17 3374.08,-4851.36 3414.79,-4891.49 3473,-4869.17 3490.78,-4862.35 3508.42,-4851.6 3523.68,-4840.67"/>
<polygon fill="black" stroke="black" points="3525.93,-4843.36 3531.9,-4834.6 3521.77,-4837.73 3525.93,-4843.36"/>
</g>
<!-- l3_attn_stage5_gpu12&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge1837" class="edge">
<title>l3_attn_stage5_gpu12&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3623.29,-4917.68C3637.43,-4911.34 3652.95,-4905.52 3668,-4902.17 3689.45,-4897.38 4443.56,-4907.8 4459,-4892.17 4477.16,-4873.78 4459.89,-4846.08 4442.31,-4826.18"/>
<polygon fill="red" stroke="red" points="4444.75,-4823.65 4435.38,-4818.7 4439.61,-4828.41 4444.75,-4823.65"/>
<text text-anchor="middle" x="4497.5" y="-4880.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu13 -->
<g id="node766" class="node">
<title>l3_attn_stage6_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3765" cy="-4800.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3765" y="-4811.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="3765" y="-4796.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3765" y="-4781.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu13&#45;&gt;l3_attn_stage6_gpu13 -->
<g id="edge718" class="edge">
<title>l3_attn_stage5_gpu13&#45;&gt;l3_attn_stage6_gpu13</title>
<path fill="none" stroke="black" d="M3711.7,-4917.72C3697.85,-4911.47 3682.69,-4905.68 3668,-4902.17 3654.37,-4898.9 3425.71,-4902.27 3416,-4892.17 3411.38,-4887.36 3411.36,-4881.95 3416,-4877.17 3425.75,-4867.11 3654.7,-4873.57 3668,-4869.17 3686.4,-4863.07 3704.44,-4852.28 3719.87,-4841.08"/>
<polygon fill="black" stroke="black" points="3722.27,-4843.66 3728.16,-4834.85 3718.06,-4838.06 3722.27,-4843.66"/>
</g>
<!-- l3_attn_stage5_gpu13&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge1838" class="edge">
<title>l3_attn_stage5_gpu13&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3818.3,-4917.7C3832.43,-4911.36 3847.96,-4905.54 3863,-4902.17 3881.49,-4898.02 4531.7,-4905.66 4545,-4892.17 4573.36,-4863.39 4525.79,-4837.56 4480.82,-4820.93"/>
<polygon fill="red" stroke="red" points="4481.88,-4817.59 4471.29,-4817.52 4479.53,-4824.18 4481.88,-4817.59"/>
<text text-anchor="middle" x="4584.5" y="-4880.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu14 -->
<g id="node767" class="node">
<title>l3_attn_stage6_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3960" cy="-4800.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3960" y="-4811.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="3960" y="-4796.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3960" y="-4781.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu14&#45;&gt;l3_attn_stage6_gpu14 -->
<g id="edge719" class="edge">
<title>l3_attn_stage5_gpu14&#45;&gt;l3_attn_stage6_gpu14</title>
<path fill="none" stroke="black" d="M3906.74,-4917.55C3892.89,-4911.3 3877.71,-4905.56 3863,-4902.17 3839.17,-4896.68 3440.09,-4909.65 3423,-4892.17 3418.34,-4887.4 3418.33,-4881.92 3423,-4877.17 3431.56,-4868.44 3851.37,-4872.93 3863,-4869.17 3881.45,-4863.19 3899.49,-4852.43 3914.92,-4841.23"/>
<polygon fill="black" stroke="black" points="3917.32,-4843.8 3923.2,-4834.99 3913.11,-4838.21 3917.32,-4843.8"/>
</g>
<!-- l3_attn_stage5_gpu14&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge1839" class="edge">
<title>l3_attn_stage5_gpu14&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4013.3,-4917.73C4027.44,-4911.38 4042.96,-4905.56 4058,-4902.17 4073.53,-4898.66 4619.84,-4903.52 4631,-4892.17 4671.03,-4851.43 4601.32,-4828.07 4531.01,-4815.33"/>
<polygon fill="red" stroke="red" points="4531.55,-4811.87 4521.1,-4813.6 4530.35,-4818.76 4531.55,-4811.87"/>
<text text-anchor="middle" x="4671.5" y="-4880.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage6_gpu15 -->
<g id="node768" class="node">
<title>l3_attn_stage6_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4155" cy="-4800.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4155" y="-4811.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage6</text>
<text text-anchor="middle" x="4155" y="-4796.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4155" y="-4781.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage5_gpu15&#45;&gt;l3_attn_stage6_gpu15 -->
<g id="edge720" class="edge">
<title>l3_attn_stage5_gpu15&#45;&gt;l3_attn_stage6_gpu15</title>
<path fill="none" stroke="black" d="M4102.02,-4917.59C4088.09,-4911.3 4072.82,-4905.53 4058,-4902.17 4040.99,-4898.31 3442.24,-4904.6 3430,-4892.17 3425.32,-4887.41 3425.32,-4881.91 3430,-4877.17 3442.26,-4864.75 4041.39,-4874.49 4058,-4869.17 4076.46,-4863.24 4094.51,-4852.5 4109.94,-4841.29"/>
<polygon fill="black" stroke="black" points="4112.34,-4843.86 4118.22,-4835.05 4108.13,-4838.27 4112.34,-4843.86"/>
</g>
<!-- l3_attn_stage5_gpu15&#45;&gt;l3_attn_stage6_gpu[next_gpu] -->
<g id="edge1840" class="edge">
<title>l3_attn_stage5_gpu15&#45;&gt;l3_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4210.38,-4918.35C4225.74,-4911.79 4242.68,-4905.7 4259,-4902.17 4283.87,-4896.78 4699.2,-4910.36 4717,-4892.17 4771.67,-4836.29 4670.45,-4814.63 4571.12,-4806.38"/>
<polygon fill="red" stroke="red" points="4571.15,-4802.87 4560.9,-4805.57 4570.6,-4809.84 4571.15,-4802.87"/>
<text text-anchor="middle" x="4757.5" y="-4880.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu0 -->
<g id="node769" class="node">
<title>l3_attn_stage7_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1230" cy="-4653.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1230" y="-4664.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="1230" y="-4649.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1230" y="-4634.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu0&#45;&gt;l3_attn_stage7_gpu0 -->
<g id="edge721" class="edge">
<title>l3_attn_stage6_gpu0&#45;&gt;l3_attn_stage7_gpu0</title>
<path fill="none" stroke="black" d="M1230,-4763.08C1230,-4744.36 1230,-4721.37 1230,-4701.38"/>
<polygon fill="black" stroke="black" points="1233.5,-4701.24 1230,-4691.24 1226.5,-4701.24 1233.5,-4701.24"/>
</g>
<!-- l3_attn_stage7_gpu[next_gpu] -->
<g id="node1349" class="node">
<title>l3_attn_stage7_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4417" cy="-4653.67" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4417" y="-4649.97" font-family="Times,serif" font-size="14.00">l3_attn_stage7_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage6_gpu0&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge1841" class="edge">
<title>l3_attn_stage6_gpu0&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1283.29,-4770.67C1297.43,-4764.33 1312.95,-4758.52 1328,-4755.17 1557.73,-4704.03 3210.66,-4732.72 3446,-4730.17 3490.94,-4729.68 4210.97,-4731.2 4255,-4722.17 4298.87,-4713.17 4345.77,-4692.25 4377.76,-4676.06"/>
<polygon fill="red" stroke="red" points="4379.49,-4679.11 4386.78,-4671.43 4376.28,-4672.89 4379.49,-4679.11"/>
<text text-anchor="middle" x="3477.5" y="-4733.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu1 -->
<g id="node770" class="node">
<title>l3_attn_stage7_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1425" cy="-4653.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1425" y="-4664.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="1425" y="-4649.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1425" y="-4634.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu1&#45;&gt;l3_attn_stage7_gpu1 -->
<g id="edge722" class="edge">
<title>l3_attn_stage6_gpu1&#45;&gt;l3_attn_stage7_gpu1</title>
<path fill="none" stroke="black" d="M1425,-4763.08C1425,-4744.36 1425,-4721.37 1425,-4701.38"/>
<polygon fill="black" stroke="black" points="1428.5,-4701.24 1425,-4691.24 1421.5,-4701.24 1428.5,-4701.24"/>
</g>
<!-- l3_attn_stage6_gpu1&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge1842" class="edge">
<title>l3_attn_stage6_gpu1&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1478.28,-4770.6C1492.41,-4764.26 1507.94,-4758.46 1523,-4755.17 1577,-4743.34 3460.82,-4763.43 3513,-4745.17 3523.15,-4741.61 3521.86,-4733.75 3532,-4730.17 3569.87,-4716.78 4215.66,-4730.26 4255,-4722.17 4298.87,-4713.14 4345.77,-4692.23 4377.76,-4676.05"/>
<polygon fill="red" stroke="red" points="4379.48,-4679.1 4386.78,-4671.41 4376.28,-4672.87 4379.48,-4679.1"/>
<text text-anchor="middle" x="3563.5" y="-4733.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu2 -->
<g id="node771" class="node">
<title>l3_attn_stage7_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1620" cy="-4653.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1620" y="-4664.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="1620" y="-4649.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1620" y="-4634.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu2&#45;&gt;l3_attn_stage7_gpu2 -->
<g id="edge723" class="edge">
<title>l3_attn_stage6_gpu2&#45;&gt;l3_attn_stage7_gpu2</title>
<path fill="none" stroke="black" d="M1620,-4763.08C1620,-4744.36 1620,-4721.37 1620,-4701.38"/>
<polygon fill="black" stroke="black" points="1623.5,-4701.24 1620,-4691.24 1616.5,-4701.24 1623.5,-4701.24"/>
</g>
<!-- l3_attn_stage6_gpu2&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge1843" class="edge">
<title>l3_attn_stage6_gpu2&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1673.28,-4770.6C1687.41,-4764.26 1702.94,-4758.47 1718,-4755.17 1769.04,-4743.98 3549.68,-4762.43 3599,-4745.17 3609.15,-4741.61 3607.86,-4733.76 3618,-4730.17 3651.36,-4718.35 4220.34,-4729.32 4255,-4722.17 4298.86,-4713.11 4345.76,-4692.2 4377.75,-4676.03"/>
<polygon fill="red" stroke="red" points="4379.48,-4679.08 4386.77,-4671.4 4376.28,-4672.85 4379.48,-4679.08"/>
<text text-anchor="middle" x="3649.5" y="-4733.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu3 -->
<g id="node772" class="node">
<title>l3_attn_stage7_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1815" cy="-4653.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1815" y="-4664.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="1815" y="-4649.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1815" y="-4634.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu3&#45;&gt;l3_attn_stage7_gpu3 -->
<g id="edge724" class="edge">
<title>l3_attn_stage6_gpu3&#45;&gt;l3_attn_stage7_gpu3</title>
<path fill="none" stroke="black" d="M1815,-4763.08C1815,-4744.36 1815,-4721.37 1815,-4701.38"/>
<polygon fill="black" stroke="black" points="1818.5,-4701.24 1815,-4691.24 1811.5,-4701.24 1818.5,-4701.24"/>
</g>
<!-- l3_attn_stage6_gpu3&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge1844" class="edge">
<title>l3_attn_stage6_gpu3&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1868.28,-4770.6C1882.41,-4764.26 1897.94,-4758.47 1913,-4755.17 1961.08,-4744.62 3638.55,-4761.44 3685,-4745.17 3695.15,-4741.61 3693.86,-4733.77 3704,-4730.17 3732.85,-4719.92 4225.02,-4728.39 4255,-4722.17 4298.85,-4713.06 4345.75,-4692.16 4377.75,-4676.01"/>
<polygon fill="red" stroke="red" points="4379.47,-4679.06 4386.77,-4671.38 4376.27,-4672.83 4379.47,-4679.06"/>
<text text-anchor="middle" x="3735.5" y="-4733.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu4 -->
<g id="node773" class="node">
<title>l3_attn_stage7_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2010" cy="-4653.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2010" y="-4664.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="2010" y="-4649.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2010" y="-4634.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu4&#45;&gt;l3_attn_stage7_gpu4 -->
<g id="edge725" class="edge">
<title>l3_attn_stage6_gpu4&#45;&gt;l3_attn_stage7_gpu4</title>
<path fill="none" stroke="black" d="M2010,-4763.08C2010,-4744.36 2010,-4721.37 2010,-4701.38"/>
<polygon fill="black" stroke="black" points="2013.5,-4701.24 2010,-4691.24 2006.5,-4701.24 2013.5,-4701.24"/>
</g>
<!-- l3_attn_stage6_gpu4&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge1845" class="edge">
<title>l3_attn_stage6_gpu4&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2063.28,-4770.61C2077.41,-4764.27 2092.94,-4758.47 2108,-4755.17 2153.12,-4745.26 3727.41,-4760.45 3771,-4745.17 3781.15,-4741.61 3779.87,-4733.78 3790,-4730.17 3838.67,-4712.8 4204.42,-4732.74 4255,-4722.17 4298.84,-4713 4345.74,-4692.11 4377.74,-4675.98"/>
<polygon fill="red" stroke="red" points="4379.46,-4679.03 4386.76,-4671.35 4376.27,-4672.8 4379.46,-4679.03"/>
<text text-anchor="middle" x="3821.5" y="-4733.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu5 -->
<g id="node774" class="node">
<title>l3_attn_stage7_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2205" cy="-4653.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2205" y="-4664.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="2205" y="-4649.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2205" y="-4634.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu5&#45;&gt;l3_attn_stage7_gpu5 -->
<g id="edge726" class="edge">
<title>l3_attn_stage6_gpu5&#45;&gt;l3_attn_stage7_gpu5</title>
<path fill="none" stroke="black" d="M2205,-4763.08C2205,-4744.36 2205,-4721.37 2205,-4701.38"/>
<polygon fill="black" stroke="black" points="2208.5,-4701.24 2205,-4691.24 2201.5,-4701.24 2208.5,-4701.24"/>
</g>
<!-- l3_attn_stage6_gpu5&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge1846" class="edge">
<title>l3_attn_stage6_gpu5&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2258.28,-4770.61C2272.41,-4764.27 2287.94,-4758.47 2303,-4755.17 2345.16,-4745.9 3816.27,-4759.45 3857,-4745.17 3867.15,-4741.6 3865.87,-4733.8 3876,-4730.17 3915.64,-4715.93 4213.79,-4730.86 4255,-4722.17 4298.82,-4712.92 4345.73,-4692.04 4377.73,-4675.93"/>
<polygon fill="red" stroke="red" points="4379.45,-4678.98 4386.75,-4671.32 4376.26,-4672.75 4379.45,-4678.98"/>
<text text-anchor="middle" x="3907.5" y="-4733.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu6 -->
<g id="node775" class="node">
<title>l3_attn_stage7_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2400" cy="-4653.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2400" y="-4664.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="2400" y="-4649.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2400" y="-4634.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu6&#45;&gt;l3_attn_stage7_gpu6 -->
<g id="edge727" class="edge">
<title>l3_attn_stage6_gpu6&#45;&gt;l3_attn_stage7_gpu6</title>
<path fill="none" stroke="black" d="M2400,-4763.08C2400,-4744.36 2400,-4721.37 2400,-4701.38"/>
<polygon fill="black" stroke="black" points="2403.5,-4701.24 2400,-4691.24 2396.5,-4701.24 2403.5,-4701.24"/>
</g>
<!-- l3_attn_stage6_gpu6&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge1847" class="edge">
<title>l3_attn_stage6_gpu6&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2453.28,-4770.62C2467.41,-4764.28 2482.94,-4758.48 2498,-4755.17 2537.2,-4746.54 3905.13,-4758.46 3943,-4745.17 3953.15,-4741.6 3951.89,-4733.83 3962,-4730.17 3992.62,-4719.07 4223.15,-4728.99 4255,-4722.17 4298.66,-4712.81 4345.41,-4692.05 4377.42,-4676.01"/>
<polygon fill="red" stroke="red" points="4379.12,-4679.06 4386.45,-4671.41 4375.95,-4672.83 4379.12,-4679.06"/>
<text text-anchor="middle" x="3993.5" y="-4733.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu7 -->
<g id="node776" class="node">
<title>l3_attn_stage7_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2595" cy="-4653.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2595" y="-4664.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="2595" y="-4649.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2595" y="-4634.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu7&#45;&gt;l3_attn_stage7_gpu7 -->
<g id="edge728" class="edge">
<title>l3_attn_stage6_gpu7&#45;&gt;l3_attn_stage7_gpu7</title>
<path fill="none" stroke="black" d="M2595,-4763.08C2595,-4744.36 2595,-4721.37 2595,-4701.38"/>
<polygon fill="black" stroke="black" points="2598.5,-4701.24 2595,-4691.24 2591.5,-4701.24 2598.5,-4701.24"/>
</g>
<!-- l3_attn_stage6_gpu7&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge1848" class="edge">
<title>l3_attn_stage6_gpu7&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2648.28,-4770.62C2662.42,-4764.28 2677.95,-4758.48 2693,-4755.17 2729.24,-4747.18 3993.99,-4757.47 4029,-4745.17 4039.15,-4741.6 4037.91,-4733.89 4048,-4730.17 4091.19,-4714.23 4210.04,-4732.06 4255,-4722.17 4298.6,-4712.57 4345.37,-4691.84 4377.39,-4675.87"/>
<polygon fill="red" stroke="red" points="4379.08,-4678.94 4386.42,-4671.3 4375.92,-4672.69 4379.08,-4678.94"/>
<text text-anchor="middle" x="4079.5" y="-4733.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu8 -->
<g id="node777" class="node">
<title>l3_attn_stage7_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2790" cy="-4653.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2790" y="-4664.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="2790" y="-4649.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2790" y="-4634.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu8&#45;&gt;l3_attn_stage7_gpu8 -->
<g id="edge729" class="edge">
<title>l3_attn_stage6_gpu8&#45;&gt;l3_attn_stage7_gpu8</title>
<path fill="none" stroke="black" d="M2790,-4763.08C2790,-4744.36 2790,-4721.37 2790,-4701.38"/>
<polygon fill="black" stroke="black" points="2793.5,-4701.24 2790,-4691.24 2786.5,-4701.24 2793.5,-4701.24"/>
</g>
<!-- l3_attn_stage6_gpu8&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge1849" class="edge">
<title>l3_attn_stage6_gpu8&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2843.28,-4770.63C2857.42,-4764.29 2872.95,-4758.49 2888,-4755.17 2954.57,-4740.48 4050.69,-4767.78 4115,-4745.17 4125.15,-4741.6 4123.96,-4734.03 4134,-4730.17 4184.3,-4710.82 4202.53,-4734.47 4255,-4722.17 4298.2,-4712.03 4344.67,-4691.59 4376.71,-4675.84"/>
<polygon fill="red" stroke="red" points="4378.38,-4678.92 4385.77,-4671.33 4375.25,-4672.66 4378.38,-4678.92"/>
<text text-anchor="middle" x="4165.5" y="-4733.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu9 -->
<g id="node778" class="node">
<title>l3_attn_stage7_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2985" cy="-4653.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2985" y="-4664.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="2985" y="-4649.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2985" y="-4634.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu9&#45;&gt;l3_attn_stage7_gpu9 -->
<g id="edge730" class="edge">
<title>l3_attn_stage6_gpu9&#45;&gt;l3_attn_stage7_gpu9</title>
<path fill="none" stroke="black" d="M2985,-4763.08C2985,-4744.36 2985,-4721.37 2985,-4701.38"/>
<polygon fill="black" stroke="black" points="2988.5,-4701.24 2985,-4691.24 2981.5,-4701.24 2988.5,-4701.24"/>
</g>
<!-- l3_attn_stage6_gpu9&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge1850" class="edge">
<title>l3_attn_stage6_gpu9&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3038.28,-4770.64C3052.42,-4764.3 3067.95,-4758.49 3083,-4755.17 3143.65,-4741.76 4142.41,-4765.8 4201,-4745.17 4211.15,-4741.59 4210.3,-4734.81 4220,-4730.17 4234.39,-4723.28 4239.8,-4727.03 4255,-4722.17 4295.94,-4709.06 4340.95,-4689.9 4373.12,-4675.34"/>
<polygon fill="red" stroke="red" points="4374.61,-4678.51 4382.25,-4671.17 4371.7,-4672.14 4374.61,-4678.51"/>
<text text-anchor="middle" x="4251.5" y="-4733.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu10 -->
<g id="node779" class="node">
<title>l3_attn_stage7_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3180" cy="-4653.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3180" y="-4664.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="3180" y="-4649.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3180" y="-4634.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu10&#45;&gt;l3_attn_stage7_gpu10 -->
<g id="edge731" class="edge">
<title>l3_attn_stage6_gpu10&#45;&gt;l3_attn_stage7_gpu10</title>
<path fill="none" stroke="black" d="M3180,-4763.08C3180,-4744.36 3180,-4721.37 3180,-4701.38"/>
<polygon fill="black" stroke="black" points="3183.5,-4701.24 3180,-4691.24 3176.5,-4701.24 3183.5,-4701.24"/>
</g>
<!-- l3_attn_stage6_gpu10&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge1851" class="edge">
<title>l3_attn_stage6_gpu10&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3233.29,-4770.65C3247.42,-4764.31 3262.95,-4758.5 3278,-4755.17 3332.73,-4743.04 4234.13,-4763.81 4287,-4745.17 4297.15,-4741.59 4297.32,-4736.53 4306,-4730.17 4331.22,-4711.67 4360.5,-4691.82 4382.65,-4677.12"/>
<polygon fill="red" stroke="red" points="4384.66,-4679.99 4391.07,-4671.55 4380.8,-4674.15 4384.66,-4679.99"/>
<text text-anchor="middle" x="4337.5" y="-4733.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu11 -->
<g id="node780" class="node">
<title>l3_attn_stage7_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3375" cy="-4653.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3375" y="-4664.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="3375" y="-4649.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3375" y="-4634.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu11&#45;&gt;l3_attn_stage7_gpu11 -->
<g id="edge732" class="edge">
<title>l3_attn_stage6_gpu11&#45;&gt;l3_attn_stage7_gpu11</title>
<path fill="none" stroke="black" d="M3375,-4763.08C3375,-4744.36 3375,-4721.37 3375,-4701.38"/>
<polygon fill="black" stroke="black" points="3378.5,-4701.24 3375,-4691.24 3371.5,-4701.24 3378.5,-4701.24"/>
</g>
<!-- l3_attn_stage6_gpu11&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge1852" class="edge">
<title>l3_attn_stage6_gpu11&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3428.29,-4770.66C3442.42,-4764.32 3457.95,-4758.51 3473,-4755.17 3497.41,-4749.74 4351.88,-4758.55 4373,-4745.17 4394.94,-4731.27 4406.24,-4702.99 4411.85,-4681.72"/>
<polygon fill="red" stroke="red" points="4415.27,-4682.47 4414.18,-4671.94 4408.46,-4680.86 4415.27,-4682.47"/>
<text text-anchor="middle" x="4419.5" y="-4733.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu12 -->
<g id="node781" class="node">
<title>l3_attn_stage7_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3570" cy="-4653.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3570" y="-4664.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="3570" y="-4649.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3570" y="-4634.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu12&#45;&gt;l3_attn_stage7_gpu12 -->
<g id="edge733" class="edge">
<title>l3_attn_stage6_gpu12&#45;&gt;l3_attn_stage7_gpu12</title>
<path fill="none" stroke="black" d="M3514.85,-4771.2C3501.43,-4765.17 3486.93,-4759.36 3473,-4755.17 3459.22,-4751.01 3418.36,-4756.1 3409,-4745.17 3374.08,-4704.36 3414.79,-4744.49 3473,-4722.17 3490.78,-4715.35 3508.42,-4704.6 3523.68,-4693.67"/>
<polygon fill="black" stroke="black" points="3525.93,-4696.36 3531.9,-4687.6 3521.77,-4690.73 3525.93,-4696.36"/>
</g>
<!-- l3_attn_stage6_gpu12&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge1853" class="edge">
<title>l3_attn_stage6_gpu12&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3623.29,-4770.68C3637.43,-4764.34 3652.95,-4758.52 3668,-4755.17 3689.45,-4750.38 4443.56,-4760.8 4459,-4745.17 4477.16,-4726.78 4459.89,-4699.08 4442.31,-4679.18"/>
<polygon fill="red" stroke="red" points="4444.75,-4676.65 4435.38,-4671.7 4439.61,-4681.41 4444.75,-4676.65"/>
<text text-anchor="middle" x="4497.5" y="-4733.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu13 -->
<g id="node782" class="node">
<title>l3_attn_stage7_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3765" cy="-4653.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3765" y="-4664.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="3765" y="-4649.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3765" y="-4634.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu13&#45;&gt;l3_attn_stage7_gpu13 -->
<g id="edge734" class="edge">
<title>l3_attn_stage6_gpu13&#45;&gt;l3_attn_stage7_gpu13</title>
<path fill="none" stroke="black" d="M3711.7,-4770.72C3697.85,-4764.47 3682.69,-4758.68 3668,-4755.17 3654.37,-4751.9 3425.71,-4755.27 3416,-4745.17 3411.38,-4740.36 3411.36,-4734.95 3416,-4730.17 3425.75,-4720.11 3654.7,-4726.57 3668,-4722.17 3686.4,-4716.07 3704.44,-4705.28 3719.87,-4694.08"/>
<polygon fill="black" stroke="black" points="3722.27,-4696.66 3728.16,-4687.85 3718.06,-4691.06 3722.27,-4696.66"/>
</g>
<!-- l3_attn_stage6_gpu13&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge1854" class="edge">
<title>l3_attn_stage6_gpu13&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3818.3,-4770.7C3832.43,-4764.36 3847.96,-4758.54 3863,-4755.17 3881.49,-4751.02 4531.7,-4758.66 4545,-4745.17 4573.36,-4716.39 4525.79,-4690.56 4480.82,-4673.93"/>
<polygon fill="red" stroke="red" points="4481.88,-4670.59 4471.29,-4670.52 4479.53,-4677.18 4481.88,-4670.59"/>
<text text-anchor="middle" x="4584.5" y="-4733.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu14 -->
<g id="node783" class="node">
<title>l3_attn_stage7_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3960" cy="-4653.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3960" y="-4664.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="3960" y="-4649.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3960" y="-4634.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu14&#45;&gt;l3_attn_stage7_gpu14 -->
<g id="edge735" class="edge">
<title>l3_attn_stage6_gpu14&#45;&gt;l3_attn_stage7_gpu14</title>
<path fill="none" stroke="black" d="M3906.74,-4770.55C3892.89,-4764.3 3877.71,-4758.56 3863,-4755.17 3839.17,-4749.68 3440.09,-4762.65 3423,-4745.17 3418.34,-4740.4 3418.33,-4734.92 3423,-4730.17 3431.56,-4721.44 3851.37,-4725.93 3863,-4722.17 3881.45,-4716.19 3899.49,-4705.43 3914.92,-4694.23"/>
<polygon fill="black" stroke="black" points="3917.32,-4696.8 3923.2,-4687.99 3913.11,-4691.21 3917.32,-4696.8"/>
</g>
<!-- l3_attn_stage6_gpu14&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge1855" class="edge">
<title>l3_attn_stage6_gpu14&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4013.3,-4770.73C4027.44,-4764.38 4042.96,-4758.56 4058,-4755.17 4073.53,-4751.66 4619.84,-4756.52 4631,-4745.17 4671.03,-4704.43 4601.32,-4681.07 4531.01,-4668.33"/>
<polygon fill="red" stroke="red" points="4531.55,-4664.87 4521.1,-4666.6 4530.35,-4671.76 4531.55,-4664.87"/>
<text text-anchor="middle" x="4671.5" y="-4733.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage7_gpu15 -->
<g id="node784" class="node">
<title>l3_attn_stage7_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4155" cy="-4653.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4155" y="-4664.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage7</text>
<text text-anchor="middle" x="4155" y="-4649.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4155" y="-4634.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage6_gpu15&#45;&gt;l3_attn_stage7_gpu15 -->
<g id="edge736" class="edge">
<title>l3_attn_stage6_gpu15&#45;&gt;l3_attn_stage7_gpu15</title>
<path fill="none" stroke="black" d="M4102.02,-4770.59C4088.09,-4764.3 4072.82,-4758.53 4058,-4755.17 4040.99,-4751.31 3442.24,-4757.6 3430,-4745.17 3425.32,-4740.41 3425.32,-4734.91 3430,-4730.17 3442.26,-4717.75 4041.39,-4727.49 4058,-4722.17 4076.46,-4716.24 4094.51,-4705.5 4109.94,-4694.29"/>
<polygon fill="black" stroke="black" points="4112.34,-4696.86 4118.22,-4688.05 4108.13,-4691.27 4112.34,-4696.86"/>
</g>
<!-- l3_attn_stage6_gpu15&#45;&gt;l3_attn_stage7_gpu[next_gpu] -->
<g id="edge1856" class="edge">
<title>l3_attn_stage6_gpu15&#45;&gt;l3_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4210.38,-4771.35C4225.74,-4764.79 4242.68,-4758.7 4259,-4755.17 4283.87,-4749.78 4699.2,-4763.36 4717,-4745.17 4771.67,-4689.29 4670.45,-4667.63 4571.12,-4659.38"/>
<polygon fill="red" stroke="red" points="4571.15,-4655.87 4560.9,-4658.57 4570.6,-4662.84 4571.15,-4655.87"/>
<text text-anchor="middle" x="4757.5" y="-4733.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu0 -->
<g id="node785" class="node">
<title>l3_attn_stage8_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1230" cy="-4506.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1230" y="-4517.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="1230" y="-4502.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1230" y="-4487.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu0&#45;&gt;l3_attn_stage8_gpu0 -->
<g id="edge737" class="edge">
<title>l3_attn_stage7_gpu0&#45;&gt;l3_attn_stage8_gpu0</title>
<path fill="none" stroke="black" d="M1230,-4616.08C1230,-4597.36 1230,-4574.37 1230,-4554.38"/>
<polygon fill="black" stroke="black" points="1233.5,-4554.24 1230,-4544.24 1226.5,-4554.24 1233.5,-4554.24"/>
</g>
<!-- l3_attn_stage8_gpu[next_gpu] -->
<g id="node1350" class="node">
<title>l3_attn_stage8_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4417" cy="-4506.67" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4417" y="-4502.97" font-family="Times,serif" font-size="14.00">l3_attn_stage8_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage7_gpu0&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge1857" class="edge">
<title>l3_attn_stage7_gpu0&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1283.29,-4623.67C1297.43,-4617.33 1312.95,-4611.52 1328,-4608.17 1557.73,-4557.03 3210.66,-4585.72 3446,-4583.17 3490.94,-4582.68 4210.97,-4584.2 4255,-4575.17 4298.87,-4566.17 4345.77,-4545.25 4377.76,-4529.06"/>
<polygon fill="red" stroke="red" points="4379.49,-4532.11 4386.78,-4524.43 4376.28,-4525.89 4379.49,-4532.11"/>
<text text-anchor="middle" x="3477.5" y="-4586.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu1 -->
<g id="node786" class="node">
<title>l3_attn_stage8_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1425" cy="-4506.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1425" y="-4517.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="1425" y="-4502.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1425" y="-4487.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu1&#45;&gt;l3_attn_stage8_gpu1 -->
<g id="edge738" class="edge">
<title>l3_attn_stage7_gpu1&#45;&gt;l3_attn_stage8_gpu1</title>
<path fill="none" stroke="black" d="M1425,-4616.08C1425,-4597.36 1425,-4574.37 1425,-4554.38"/>
<polygon fill="black" stroke="black" points="1428.5,-4554.24 1425,-4544.24 1421.5,-4554.24 1428.5,-4554.24"/>
</g>
<!-- l3_attn_stage7_gpu1&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge1858" class="edge">
<title>l3_attn_stage7_gpu1&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1478.28,-4623.6C1492.41,-4617.26 1507.94,-4611.46 1523,-4608.17 1577,-4596.34 3460.82,-4616.43 3513,-4598.17 3523.15,-4594.61 3521.86,-4586.75 3532,-4583.17 3569.87,-4569.78 4215.66,-4583.26 4255,-4575.17 4298.87,-4566.14 4345.77,-4545.23 4377.76,-4529.05"/>
<polygon fill="red" stroke="red" points="4379.48,-4532.1 4386.78,-4524.41 4376.28,-4525.87 4379.48,-4532.1"/>
<text text-anchor="middle" x="3563.5" y="-4586.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu2 -->
<g id="node787" class="node">
<title>l3_attn_stage8_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1620" cy="-4506.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1620" y="-4517.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="1620" y="-4502.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1620" y="-4487.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu2&#45;&gt;l3_attn_stage8_gpu2 -->
<g id="edge739" class="edge">
<title>l3_attn_stage7_gpu2&#45;&gt;l3_attn_stage8_gpu2</title>
<path fill="none" stroke="black" d="M1620,-4616.08C1620,-4597.36 1620,-4574.37 1620,-4554.38"/>
<polygon fill="black" stroke="black" points="1623.5,-4554.24 1620,-4544.24 1616.5,-4554.24 1623.5,-4554.24"/>
</g>
<!-- l3_attn_stage7_gpu2&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge1859" class="edge">
<title>l3_attn_stage7_gpu2&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1673.28,-4623.6C1687.41,-4617.26 1702.94,-4611.47 1718,-4608.17 1769.04,-4596.98 3549.68,-4615.43 3599,-4598.17 3609.15,-4594.61 3607.86,-4586.76 3618,-4583.17 3651.36,-4571.35 4220.34,-4582.32 4255,-4575.17 4298.86,-4566.11 4345.76,-4545.2 4377.75,-4529.03"/>
<polygon fill="red" stroke="red" points="4379.48,-4532.08 4386.77,-4524.4 4376.28,-4525.85 4379.48,-4532.08"/>
<text text-anchor="middle" x="3649.5" y="-4586.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu3 -->
<g id="node788" class="node">
<title>l3_attn_stage8_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1815" cy="-4506.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1815" y="-4517.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="1815" y="-4502.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1815" y="-4487.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu3&#45;&gt;l3_attn_stage8_gpu3 -->
<g id="edge740" class="edge">
<title>l3_attn_stage7_gpu3&#45;&gt;l3_attn_stage8_gpu3</title>
<path fill="none" stroke="black" d="M1815,-4616.08C1815,-4597.36 1815,-4574.37 1815,-4554.38"/>
<polygon fill="black" stroke="black" points="1818.5,-4554.24 1815,-4544.24 1811.5,-4554.24 1818.5,-4554.24"/>
</g>
<!-- l3_attn_stage7_gpu3&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge1860" class="edge">
<title>l3_attn_stage7_gpu3&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1868.28,-4623.6C1882.41,-4617.26 1897.94,-4611.47 1913,-4608.17 1961.08,-4597.62 3638.55,-4614.44 3685,-4598.17 3695.15,-4594.61 3693.86,-4586.77 3704,-4583.17 3732.85,-4572.92 4225.02,-4581.39 4255,-4575.17 4298.85,-4566.06 4345.75,-4545.16 4377.75,-4529.01"/>
<polygon fill="red" stroke="red" points="4379.47,-4532.06 4386.77,-4524.38 4376.27,-4525.83 4379.47,-4532.06"/>
<text text-anchor="middle" x="3735.5" y="-4586.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu4 -->
<g id="node789" class="node">
<title>l3_attn_stage8_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2010" cy="-4506.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2010" y="-4517.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="2010" y="-4502.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2010" y="-4487.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu4&#45;&gt;l3_attn_stage8_gpu4 -->
<g id="edge741" class="edge">
<title>l3_attn_stage7_gpu4&#45;&gt;l3_attn_stage8_gpu4</title>
<path fill="none" stroke="black" d="M2010,-4616.08C2010,-4597.36 2010,-4574.37 2010,-4554.38"/>
<polygon fill="black" stroke="black" points="2013.5,-4554.24 2010,-4544.24 2006.5,-4554.24 2013.5,-4554.24"/>
</g>
<!-- l3_attn_stage7_gpu4&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge1861" class="edge">
<title>l3_attn_stage7_gpu4&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2063.28,-4623.61C2077.41,-4617.27 2092.94,-4611.47 2108,-4608.17 2153.12,-4598.26 3727.41,-4613.45 3771,-4598.17 3781.15,-4594.61 3779.87,-4586.78 3790,-4583.17 3838.67,-4565.8 4204.42,-4585.74 4255,-4575.17 4298.84,-4566 4345.74,-4545.11 4377.74,-4528.98"/>
<polygon fill="red" stroke="red" points="4379.46,-4532.03 4386.76,-4524.35 4376.27,-4525.8 4379.46,-4532.03"/>
<text text-anchor="middle" x="3821.5" y="-4586.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu5 -->
<g id="node790" class="node">
<title>l3_attn_stage8_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2205" cy="-4506.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2205" y="-4517.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="2205" y="-4502.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2205" y="-4487.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu5&#45;&gt;l3_attn_stage8_gpu5 -->
<g id="edge742" class="edge">
<title>l3_attn_stage7_gpu5&#45;&gt;l3_attn_stage8_gpu5</title>
<path fill="none" stroke="black" d="M2205,-4616.08C2205,-4597.36 2205,-4574.37 2205,-4554.38"/>
<polygon fill="black" stroke="black" points="2208.5,-4554.24 2205,-4544.24 2201.5,-4554.24 2208.5,-4554.24"/>
</g>
<!-- l3_attn_stage7_gpu5&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge1862" class="edge">
<title>l3_attn_stage7_gpu5&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2258.28,-4623.61C2272.41,-4617.27 2287.94,-4611.47 2303,-4608.17 2345.16,-4598.9 3816.27,-4612.45 3857,-4598.17 3867.15,-4594.6 3865.87,-4586.8 3876,-4583.17 3915.64,-4568.93 4213.79,-4583.86 4255,-4575.17 4298.82,-4565.92 4345.73,-4545.04 4377.73,-4528.93"/>
<polygon fill="red" stroke="red" points="4379.45,-4531.98 4386.75,-4524.32 4376.26,-4525.75 4379.45,-4531.98"/>
<text text-anchor="middle" x="3907.5" y="-4586.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu6 -->
<g id="node791" class="node">
<title>l3_attn_stage8_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2400" cy="-4506.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2400" y="-4517.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="2400" y="-4502.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2400" y="-4487.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu6&#45;&gt;l3_attn_stage8_gpu6 -->
<g id="edge743" class="edge">
<title>l3_attn_stage7_gpu6&#45;&gt;l3_attn_stage8_gpu6</title>
<path fill="none" stroke="black" d="M2400,-4616.08C2400,-4597.36 2400,-4574.37 2400,-4554.38"/>
<polygon fill="black" stroke="black" points="2403.5,-4554.24 2400,-4544.24 2396.5,-4554.24 2403.5,-4554.24"/>
</g>
<!-- l3_attn_stage7_gpu6&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge1863" class="edge">
<title>l3_attn_stage7_gpu6&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2453.28,-4623.62C2467.41,-4617.28 2482.94,-4611.48 2498,-4608.17 2537.2,-4599.54 3905.13,-4611.46 3943,-4598.17 3953.15,-4594.6 3951.89,-4586.83 3962,-4583.17 3992.62,-4572.07 4223.15,-4581.99 4255,-4575.17 4298.66,-4565.81 4345.41,-4545.05 4377.42,-4529.01"/>
<polygon fill="red" stroke="red" points="4379.12,-4532.06 4386.45,-4524.41 4375.95,-4525.83 4379.12,-4532.06"/>
<text text-anchor="middle" x="3993.5" y="-4586.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu7 -->
<g id="node792" class="node">
<title>l3_attn_stage8_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2595" cy="-4506.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2595" y="-4517.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="2595" y="-4502.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2595" y="-4487.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu7&#45;&gt;l3_attn_stage8_gpu7 -->
<g id="edge744" class="edge">
<title>l3_attn_stage7_gpu7&#45;&gt;l3_attn_stage8_gpu7</title>
<path fill="none" stroke="black" d="M2595,-4616.08C2595,-4597.36 2595,-4574.37 2595,-4554.38"/>
<polygon fill="black" stroke="black" points="2598.5,-4554.24 2595,-4544.24 2591.5,-4554.24 2598.5,-4554.24"/>
</g>
<!-- l3_attn_stage7_gpu7&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge1864" class="edge">
<title>l3_attn_stage7_gpu7&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2648.28,-4623.62C2662.42,-4617.28 2677.95,-4611.48 2693,-4608.17 2729.24,-4600.18 3993.99,-4610.47 4029,-4598.17 4039.15,-4594.6 4037.91,-4586.89 4048,-4583.17 4091.19,-4567.23 4210.04,-4585.06 4255,-4575.17 4298.6,-4565.57 4345.37,-4544.84 4377.39,-4528.87"/>
<polygon fill="red" stroke="red" points="4379.08,-4531.94 4386.42,-4524.3 4375.92,-4525.69 4379.08,-4531.94"/>
<text text-anchor="middle" x="4079.5" y="-4586.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu8 -->
<g id="node793" class="node">
<title>l3_attn_stage8_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2790" cy="-4506.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2790" y="-4517.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="2790" y="-4502.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2790" y="-4487.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu8&#45;&gt;l3_attn_stage8_gpu8 -->
<g id="edge745" class="edge">
<title>l3_attn_stage7_gpu8&#45;&gt;l3_attn_stage8_gpu8</title>
<path fill="none" stroke="black" d="M2790,-4616.08C2790,-4597.36 2790,-4574.37 2790,-4554.38"/>
<polygon fill="black" stroke="black" points="2793.5,-4554.24 2790,-4544.24 2786.5,-4554.24 2793.5,-4554.24"/>
</g>
<!-- l3_attn_stage7_gpu8&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge1865" class="edge">
<title>l3_attn_stage7_gpu8&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2843.28,-4623.63C2857.42,-4617.29 2872.95,-4611.49 2888,-4608.17 2954.57,-4593.48 4050.69,-4620.78 4115,-4598.17 4125.15,-4594.6 4123.96,-4587.03 4134,-4583.17 4184.3,-4563.82 4202.53,-4587.47 4255,-4575.17 4298.2,-4565.03 4344.67,-4544.59 4376.71,-4528.84"/>
<polygon fill="red" stroke="red" points="4378.38,-4531.92 4385.77,-4524.33 4375.25,-4525.66 4378.38,-4531.92"/>
<text text-anchor="middle" x="4165.5" y="-4586.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu9 -->
<g id="node794" class="node">
<title>l3_attn_stage8_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2985" cy="-4506.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2985" y="-4517.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="2985" y="-4502.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2985" y="-4487.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu9&#45;&gt;l3_attn_stage8_gpu9 -->
<g id="edge746" class="edge">
<title>l3_attn_stage7_gpu9&#45;&gt;l3_attn_stage8_gpu9</title>
<path fill="none" stroke="black" d="M2985,-4616.08C2985,-4597.36 2985,-4574.37 2985,-4554.38"/>
<polygon fill="black" stroke="black" points="2988.5,-4554.24 2985,-4544.24 2981.5,-4554.24 2988.5,-4554.24"/>
</g>
<!-- l3_attn_stage7_gpu9&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge1866" class="edge">
<title>l3_attn_stage7_gpu9&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3038.28,-4623.64C3052.42,-4617.3 3067.95,-4611.49 3083,-4608.17 3143.65,-4594.76 4142.41,-4618.8 4201,-4598.17 4211.15,-4594.59 4210.3,-4587.81 4220,-4583.17 4234.39,-4576.28 4239.8,-4580.03 4255,-4575.17 4295.94,-4562.06 4340.95,-4542.9 4373.12,-4528.34"/>
<polygon fill="red" stroke="red" points="4374.61,-4531.51 4382.25,-4524.17 4371.7,-4525.14 4374.61,-4531.51"/>
<text text-anchor="middle" x="4251.5" y="-4586.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu10 -->
<g id="node795" class="node">
<title>l3_attn_stage8_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3180" cy="-4506.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3180" y="-4517.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="3180" y="-4502.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3180" y="-4487.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu10&#45;&gt;l3_attn_stage8_gpu10 -->
<g id="edge747" class="edge">
<title>l3_attn_stage7_gpu10&#45;&gt;l3_attn_stage8_gpu10</title>
<path fill="none" stroke="black" d="M3180,-4616.08C3180,-4597.36 3180,-4574.37 3180,-4554.38"/>
<polygon fill="black" stroke="black" points="3183.5,-4554.24 3180,-4544.24 3176.5,-4554.24 3183.5,-4554.24"/>
</g>
<!-- l3_attn_stage7_gpu10&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge1867" class="edge">
<title>l3_attn_stage7_gpu10&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3233.29,-4623.65C3247.42,-4617.31 3262.95,-4611.5 3278,-4608.17 3332.73,-4596.04 4234.13,-4616.81 4287,-4598.17 4297.15,-4594.59 4297.32,-4589.53 4306,-4583.17 4331.22,-4564.67 4360.5,-4544.82 4382.65,-4530.12"/>
<polygon fill="red" stroke="red" points="4384.66,-4532.99 4391.07,-4524.55 4380.8,-4527.15 4384.66,-4532.99"/>
<text text-anchor="middle" x="4337.5" y="-4586.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu11 -->
<g id="node796" class="node">
<title>l3_attn_stage8_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3375" cy="-4506.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3375" y="-4517.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="3375" y="-4502.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3375" y="-4487.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu11&#45;&gt;l3_attn_stage8_gpu11 -->
<g id="edge748" class="edge">
<title>l3_attn_stage7_gpu11&#45;&gt;l3_attn_stage8_gpu11</title>
<path fill="none" stroke="black" d="M3375,-4616.08C3375,-4597.36 3375,-4574.37 3375,-4554.38"/>
<polygon fill="black" stroke="black" points="3378.5,-4554.24 3375,-4544.24 3371.5,-4554.24 3378.5,-4554.24"/>
</g>
<!-- l3_attn_stage7_gpu11&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge1868" class="edge">
<title>l3_attn_stage7_gpu11&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3428.29,-4623.66C3442.42,-4617.32 3457.95,-4611.51 3473,-4608.17 3497.41,-4602.74 4351.88,-4611.55 4373,-4598.17 4394.94,-4584.27 4406.24,-4555.99 4411.85,-4534.72"/>
<polygon fill="red" stroke="red" points="4415.27,-4535.47 4414.18,-4524.94 4408.46,-4533.86 4415.27,-4535.47"/>
<text text-anchor="middle" x="4419.5" y="-4586.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu12 -->
<g id="node797" class="node">
<title>l3_attn_stage8_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3570" cy="-4506.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3570" y="-4517.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="3570" y="-4502.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3570" y="-4487.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu12&#45;&gt;l3_attn_stage8_gpu12 -->
<g id="edge749" class="edge">
<title>l3_attn_stage7_gpu12&#45;&gt;l3_attn_stage8_gpu12</title>
<path fill="none" stroke="black" d="M3514.85,-4624.2C3501.43,-4618.17 3486.93,-4612.36 3473,-4608.17 3459.22,-4604.01 3418.36,-4609.1 3409,-4598.17 3374.08,-4557.36 3414.79,-4597.49 3473,-4575.17 3490.78,-4568.35 3508.42,-4557.6 3523.68,-4546.67"/>
<polygon fill="black" stroke="black" points="3525.93,-4549.36 3531.9,-4540.6 3521.77,-4543.73 3525.93,-4549.36"/>
</g>
<!-- l3_attn_stage7_gpu12&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge1869" class="edge">
<title>l3_attn_stage7_gpu12&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3623.29,-4623.68C3637.43,-4617.34 3652.95,-4611.52 3668,-4608.17 3689.45,-4603.38 4443.56,-4613.8 4459,-4598.17 4477.16,-4579.78 4459.89,-4552.08 4442.31,-4532.18"/>
<polygon fill="red" stroke="red" points="4444.75,-4529.65 4435.38,-4524.7 4439.61,-4534.41 4444.75,-4529.65"/>
<text text-anchor="middle" x="4497.5" y="-4586.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu13 -->
<g id="node798" class="node">
<title>l3_attn_stage8_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3765" cy="-4506.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3765" y="-4517.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="3765" y="-4502.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3765" y="-4487.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu13&#45;&gt;l3_attn_stage8_gpu13 -->
<g id="edge750" class="edge">
<title>l3_attn_stage7_gpu13&#45;&gt;l3_attn_stage8_gpu13</title>
<path fill="none" stroke="black" d="M3711.7,-4623.72C3697.85,-4617.47 3682.69,-4611.68 3668,-4608.17 3654.37,-4604.9 3425.71,-4608.27 3416,-4598.17 3411.38,-4593.36 3411.36,-4587.95 3416,-4583.17 3425.75,-4573.11 3654.7,-4579.57 3668,-4575.17 3686.4,-4569.07 3704.44,-4558.28 3719.87,-4547.08"/>
<polygon fill="black" stroke="black" points="3722.27,-4549.66 3728.16,-4540.85 3718.06,-4544.06 3722.27,-4549.66"/>
</g>
<!-- l3_attn_stage7_gpu13&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge1870" class="edge">
<title>l3_attn_stage7_gpu13&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3818.3,-4623.7C3832.43,-4617.36 3847.96,-4611.54 3863,-4608.17 3881.49,-4604.02 4531.7,-4611.66 4545,-4598.17 4573.36,-4569.39 4525.79,-4543.56 4480.82,-4526.93"/>
<polygon fill="red" stroke="red" points="4481.88,-4523.59 4471.29,-4523.52 4479.53,-4530.18 4481.88,-4523.59"/>
<text text-anchor="middle" x="4584.5" y="-4586.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu14 -->
<g id="node799" class="node">
<title>l3_attn_stage8_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3960" cy="-4506.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3960" y="-4517.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="3960" y="-4502.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3960" y="-4487.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu14&#45;&gt;l3_attn_stage8_gpu14 -->
<g id="edge751" class="edge">
<title>l3_attn_stage7_gpu14&#45;&gt;l3_attn_stage8_gpu14</title>
<path fill="none" stroke="black" d="M3906.74,-4623.55C3892.89,-4617.3 3877.71,-4611.56 3863,-4608.17 3839.17,-4602.68 3440.09,-4615.65 3423,-4598.17 3418.34,-4593.4 3418.33,-4587.92 3423,-4583.17 3431.56,-4574.44 3851.37,-4578.93 3863,-4575.17 3881.45,-4569.19 3899.49,-4558.43 3914.92,-4547.23"/>
<polygon fill="black" stroke="black" points="3917.32,-4549.8 3923.2,-4540.99 3913.11,-4544.21 3917.32,-4549.8"/>
</g>
<!-- l3_attn_stage7_gpu14&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge1871" class="edge">
<title>l3_attn_stage7_gpu14&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4013.3,-4623.73C4027.44,-4617.38 4042.96,-4611.56 4058,-4608.17 4073.53,-4604.66 4619.84,-4609.52 4631,-4598.17 4671.03,-4557.43 4601.32,-4534.07 4531.01,-4521.33"/>
<polygon fill="red" stroke="red" points="4531.55,-4517.87 4521.1,-4519.6 4530.35,-4524.76 4531.55,-4517.87"/>
<text text-anchor="middle" x="4671.5" y="-4586.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage8_gpu15 -->
<g id="node800" class="node">
<title>l3_attn_stage8_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4155" cy="-4506.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4155" y="-4517.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage8</text>
<text text-anchor="middle" x="4155" y="-4502.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4155" y="-4487.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage7_gpu15&#45;&gt;l3_attn_stage8_gpu15 -->
<g id="edge752" class="edge">
<title>l3_attn_stage7_gpu15&#45;&gt;l3_attn_stage8_gpu15</title>
<path fill="none" stroke="black" d="M4102.02,-4623.59C4088.09,-4617.3 4072.82,-4611.53 4058,-4608.17 4040.99,-4604.31 3442.24,-4610.6 3430,-4598.17 3425.32,-4593.41 3425.32,-4587.91 3430,-4583.17 3442.26,-4570.75 4041.39,-4580.49 4058,-4575.17 4076.46,-4569.24 4094.51,-4558.5 4109.94,-4547.29"/>
<polygon fill="black" stroke="black" points="4112.34,-4549.86 4118.22,-4541.05 4108.13,-4544.27 4112.34,-4549.86"/>
</g>
<!-- l3_attn_stage7_gpu15&#45;&gt;l3_attn_stage8_gpu[next_gpu] -->
<g id="edge1872" class="edge">
<title>l3_attn_stage7_gpu15&#45;&gt;l3_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4210.38,-4624.35C4225.74,-4617.79 4242.68,-4611.7 4259,-4608.17 4283.87,-4602.78 4699.2,-4616.36 4717,-4598.17 4771.67,-4542.29 4670.45,-4520.63 4571.12,-4512.38"/>
<polygon fill="red" stroke="red" points="4571.15,-4508.87 4560.9,-4511.57 4570.6,-4515.84 4571.15,-4508.87"/>
<text text-anchor="middle" x="4757.5" y="-4586.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu0 -->
<g id="node801" class="node">
<title>l3_attn_stage9_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1230" cy="-4359.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1230" y="-4370.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="1230" y="-4355.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1230" y="-4340.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu0&#45;&gt;l3_attn_stage9_gpu0 -->
<g id="edge753" class="edge">
<title>l3_attn_stage8_gpu0&#45;&gt;l3_attn_stage9_gpu0</title>
<path fill="none" stroke="black" d="M1230,-4469.08C1230,-4450.36 1230,-4427.37 1230,-4407.38"/>
<polygon fill="black" stroke="black" points="1233.5,-4407.24 1230,-4397.24 1226.5,-4407.24 1233.5,-4407.24"/>
</g>
<!-- l3_attn_stage9_gpu[next_gpu] -->
<g id="node1351" class="node">
<title>l3_attn_stage9_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4417" cy="-4359.67" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4417" y="-4355.97" font-family="Times,serif" font-size="14.00">l3_attn_stage9_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage8_gpu0&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge1873" class="edge">
<title>l3_attn_stage8_gpu0&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1283.29,-4476.67C1297.43,-4470.33 1312.95,-4464.52 1328,-4461.17 1557.73,-4410.03 3210.66,-4438.72 3446,-4436.17 3490.94,-4435.68 4210.97,-4437.2 4255,-4428.17 4298.87,-4419.17 4345.77,-4398.25 4377.76,-4382.06"/>
<polygon fill="red" stroke="red" points="4379.49,-4385.11 4386.78,-4377.43 4376.28,-4378.89 4379.49,-4385.11"/>
<text text-anchor="middle" x="3477.5" y="-4439.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu1 -->
<g id="node802" class="node">
<title>l3_attn_stage9_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1425" cy="-4359.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1425" y="-4370.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="1425" y="-4355.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1425" y="-4340.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu1&#45;&gt;l3_attn_stage9_gpu1 -->
<g id="edge754" class="edge">
<title>l3_attn_stage8_gpu1&#45;&gt;l3_attn_stage9_gpu1</title>
<path fill="none" stroke="black" d="M1425,-4469.08C1425,-4450.36 1425,-4427.37 1425,-4407.38"/>
<polygon fill="black" stroke="black" points="1428.5,-4407.24 1425,-4397.24 1421.5,-4407.24 1428.5,-4407.24"/>
</g>
<!-- l3_attn_stage8_gpu1&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge1874" class="edge">
<title>l3_attn_stage8_gpu1&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1478.28,-4476.6C1492.41,-4470.26 1507.94,-4464.46 1523,-4461.17 1577,-4449.34 3460.82,-4469.43 3513,-4451.17 3523.15,-4447.61 3521.86,-4439.75 3532,-4436.17 3569.87,-4422.78 4215.66,-4436.26 4255,-4428.17 4298.87,-4419.14 4345.77,-4398.23 4377.76,-4382.05"/>
<polygon fill="red" stroke="red" points="4379.48,-4385.1 4386.78,-4377.41 4376.28,-4378.87 4379.48,-4385.1"/>
<text text-anchor="middle" x="3563.5" y="-4439.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu2 -->
<g id="node803" class="node">
<title>l3_attn_stage9_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1620" cy="-4359.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1620" y="-4370.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="1620" y="-4355.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1620" y="-4340.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu2&#45;&gt;l3_attn_stage9_gpu2 -->
<g id="edge755" class="edge">
<title>l3_attn_stage8_gpu2&#45;&gt;l3_attn_stage9_gpu2</title>
<path fill="none" stroke="black" d="M1620,-4469.08C1620,-4450.36 1620,-4427.37 1620,-4407.38"/>
<polygon fill="black" stroke="black" points="1623.5,-4407.24 1620,-4397.24 1616.5,-4407.24 1623.5,-4407.24"/>
</g>
<!-- l3_attn_stage8_gpu2&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge1875" class="edge">
<title>l3_attn_stage8_gpu2&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1673.28,-4476.6C1687.41,-4470.26 1702.94,-4464.47 1718,-4461.17 1769.04,-4449.98 3549.68,-4468.43 3599,-4451.17 3609.15,-4447.61 3607.86,-4439.76 3618,-4436.17 3651.36,-4424.35 4220.34,-4435.32 4255,-4428.17 4298.86,-4419.11 4345.76,-4398.2 4377.75,-4382.03"/>
<polygon fill="red" stroke="red" points="4379.48,-4385.08 4386.77,-4377.4 4376.28,-4378.85 4379.48,-4385.08"/>
<text text-anchor="middle" x="3649.5" y="-4439.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu3 -->
<g id="node804" class="node">
<title>l3_attn_stage9_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1815" cy="-4359.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1815" y="-4370.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="1815" y="-4355.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1815" y="-4340.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu3&#45;&gt;l3_attn_stage9_gpu3 -->
<g id="edge756" class="edge">
<title>l3_attn_stage8_gpu3&#45;&gt;l3_attn_stage9_gpu3</title>
<path fill="none" stroke="black" d="M1815,-4469.08C1815,-4450.36 1815,-4427.37 1815,-4407.38"/>
<polygon fill="black" stroke="black" points="1818.5,-4407.24 1815,-4397.24 1811.5,-4407.24 1818.5,-4407.24"/>
</g>
<!-- l3_attn_stage8_gpu3&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge1876" class="edge">
<title>l3_attn_stage8_gpu3&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1868.28,-4476.6C1882.41,-4470.26 1897.94,-4464.47 1913,-4461.17 1961.08,-4450.62 3638.55,-4467.44 3685,-4451.17 3695.15,-4447.61 3693.86,-4439.77 3704,-4436.17 3732.85,-4425.92 4225.02,-4434.39 4255,-4428.17 4298.85,-4419.06 4345.75,-4398.16 4377.75,-4382.01"/>
<polygon fill="red" stroke="red" points="4379.47,-4385.06 4386.77,-4377.38 4376.27,-4378.83 4379.47,-4385.06"/>
<text text-anchor="middle" x="3735.5" y="-4439.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu4 -->
<g id="node805" class="node">
<title>l3_attn_stage9_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="2010" cy="-4359.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2010" y="-4370.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="2010" y="-4355.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="2010" y="-4340.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu4&#45;&gt;l3_attn_stage9_gpu4 -->
<g id="edge757" class="edge">
<title>l3_attn_stage8_gpu4&#45;&gt;l3_attn_stage9_gpu4</title>
<path fill="none" stroke="black" d="M2010,-4469.08C2010,-4450.36 2010,-4427.37 2010,-4407.38"/>
<polygon fill="black" stroke="black" points="2013.5,-4407.24 2010,-4397.24 2006.5,-4407.24 2013.5,-4407.24"/>
</g>
<!-- l3_attn_stage8_gpu4&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge1877" class="edge">
<title>l3_attn_stage8_gpu4&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2063.28,-4476.61C2077.41,-4470.27 2092.94,-4464.47 2108,-4461.17 2153.12,-4451.26 3727.41,-4466.45 3771,-4451.17 3781.15,-4447.61 3779.87,-4439.78 3790,-4436.17 3838.67,-4418.8 4204.42,-4438.74 4255,-4428.17 4298.84,-4419 4345.74,-4398.11 4377.74,-4381.98"/>
<polygon fill="red" stroke="red" points="4379.46,-4385.03 4386.76,-4377.35 4376.27,-4378.8 4379.46,-4385.03"/>
<text text-anchor="middle" x="3821.5" y="-4439.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu5 -->
<g id="node806" class="node">
<title>l3_attn_stage9_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2205" cy="-4359.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2205" y="-4370.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="2205" y="-4355.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2205" y="-4340.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu5&#45;&gt;l3_attn_stage9_gpu5 -->
<g id="edge758" class="edge">
<title>l3_attn_stage8_gpu5&#45;&gt;l3_attn_stage9_gpu5</title>
<path fill="none" stroke="black" d="M2205,-4469.08C2205,-4450.36 2205,-4427.37 2205,-4407.38"/>
<polygon fill="black" stroke="black" points="2208.5,-4407.24 2205,-4397.24 2201.5,-4407.24 2208.5,-4407.24"/>
</g>
<!-- l3_attn_stage8_gpu5&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge1878" class="edge">
<title>l3_attn_stage8_gpu5&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2258.28,-4476.61C2272.41,-4470.27 2287.94,-4464.47 2303,-4461.17 2345.16,-4451.9 3816.27,-4465.45 3857,-4451.17 3867.15,-4447.6 3865.87,-4439.8 3876,-4436.17 3915.64,-4421.93 4213.79,-4436.86 4255,-4428.17 4298.82,-4418.92 4345.73,-4398.04 4377.73,-4381.93"/>
<polygon fill="red" stroke="red" points="4379.45,-4384.98 4386.75,-4377.32 4376.26,-4378.75 4379.45,-4384.98"/>
<text text-anchor="middle" x="3907.5" y="-4439.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu6 -->
<g id="node807" class="node">
<title>l3_attn_stage9_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2400" cy="-4359.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2400" y="-4370.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="2400" y="-4355.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2400" y="-4340.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu6&#45;&gt;l3_attn_stage9_gpu6 -->
<g id="edge759" class="edge">
<title>l3_attn_stage8_gpu6&#45;&gt;l3_attn_stage9_gpu6</title>
<path fill="none" stroke="black" d="M2400,-4469.08C2400,-4450.36 2400,-4427.37 2400,-4407.38"/>
<polygon fill="black" stroke="black" points="2403.5,-4407.24 2400,-4397.24 2396.5,-4407.24 2403.5,-4407.24"/>
</g>
<!-- l3_attn_stage8_gpu6&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge1879" class="edge">
<title>l3_attn_stage8_gpu6&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2453.28,-4476.62C2467.41,-4470.28 2482.94,-4464.48 2498,-4461.17 2537.2,-4452.54 3905.13,-4464.46 3943,-4451.17 3953.15,-4447.6 3951.89,-4439.83 3962,-4436.17 3992.62,-4425.07 4223.15,-4434.99 4255,-4428.17 4298.66,-4418.81 4345.41,-4398.05 4377.42,-4382.01"/>
<polygon fill="red" stroke="red" points="4379.12,-4385.06 4386.45,-4377.41 4375.95,-4378.83 4379.12,-4385.06"/>
<text text-anchor="middle" x="3993.5" y="-4439.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu7 -->
<g id="node808" class="node">
<title>l3_attn_stage9_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2595" cy="-4359.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2595" y="-4370.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="2595" y="-4355.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2595" y="-4340.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu7&#45;&gt;l3_attn_stage9_gpu7 -->
<g id="edge760" class="edge">
<title>l3_attn_stage8_gpu7&#45;&gt;l3_attn_stage9_gpu7</title>
<path fill="none" stroke="black" d="M2595,-4469.08C2595,-4450.36 2595,-4427.37 2595,-4407.38"/>
<polygon fill="black" stroke="black" points="2598.5,-4407.24 2595,-4397.24 2591.5,-4407.24 2598.5,-4407.24"/>
</g>
<!-- l3_attn_stage8_gpu7&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge1880" class="edge">
<title>l3_attn_stage8_gpu7&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2648.28,-4476.62C2662.42,-4470.28 2677.95,-4464.48 2693,-4461.17 2729.24,-4453.18 3993.99,-4463.47 4029,-4451.17 4039.15,-4447.6 4037.91,-4439.89 4048,-4436.17 4091.19,-4420.23 4210.04,-4438.06 4255,-4428.17 4298.6,-4418.57 4345.37,-4397.84 4377.39,-4381.87"/>
<polygon fill="red" stroke="red" points="4379.08,-4384.94 4386.42,-4377.3 4375.92,-4378.69 4379.08,-4384.94"/>
<text text-anchor="middle" x="4079.5" y="-4439.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu8 -->
<g id="node809" class="node">
<title>l3_attn_stage9_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2790" cy="-4359.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2790" y="-4370.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="2790" y="-4355.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2790" y="-4340.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu8&#45;&gt;l3_attn_stage9_gpu8 -->
<g id="edge761" class="edge">
<title>l3_attn_stage8_gpu8&#45;&gt;l3_attn_stage9_gpu8</title>
<path fill="none" stroke="black" d="M2790,-4469.08C2790,-4450.36 2790,-4427.37 2790,-4407.38"/>
<polygon fill="black" stroke="black" points="2793.5,-4407.24 2790,-4397.24 2786.5,-4407.24 2793.5,-4407.24"/>
</g>
<!-- l3_attn_stage8_gpu8&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge1881" class="edge">
<title>l3_attn_stage8_gpu8&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2843.28,-4476.63C2857.42,-4470.29 2872.95,-4464.49 2888,-4461.17 2954.57,-4446.48 4050.69,-4473.78 4115,-4451.17 4125.15,-4447.6 4123.96,-4440.03 4134,-4436.17 4184.3,-4416.82 4202.53,-4440.47 4255,-4428.17 4298.2,-4418.03 4344.67,-4397.59 4376.71,-4381.84"/>
<polygon fill="red" stroke="red" points="4378.38,-4384.92 4385.77,-4377.33 4375.25,-4378.66 4378.38,-4384.92"/>
<text text-anchor="middle" x="4165.5" y="-4439.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu9 -->
<g id="node810" class="node">
<title>l3_attn_stage9_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2985" cy="-4359.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2985" y="-4370.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="2985" y="-4355.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2985" y="-4340.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu9&#45;&gt;l3_attn_stage9_gpu9 -->
<g id="edge762" class="edge">
<title>l3_attn_stage8_gpu9&#45;&gt;l3_attn_stage9_gpu9</title>
<path fill="none" stroke="black" d="M2985,-4469.08C2985,-4450.36 2985,-4427.37 2985,-4407.38"/>
<polygon fill="black" stroke="black" points="2988.5,-4407.24 2985,-4397.24 2981.5,-4407.24 2988.5,-4407.24"/>
</g>
<!-- l3_attn_stage8_gpu9&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge1882" class="edge">
<title>l3_attn_stage8_gpu9&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3038.28,-4476.64C3052.42,-4470.3 3067.95,-4464.49 3083,-4461.17 3143.65,-4447.76 4142.41,-4471.8 4201,-4451.17 4211.15,-4447.59 4210.3,-4440.81 4220,-4436.17 4234.39,-4429.28 4239.8,-4433.03 4255,-4428.17 4295.94,-4415.06 4340.95,-4395.9 4373.12,-4381.34"/>
<polygon fill="red" stroke="red" points="4374.61,-4384.51 4382.25,-4377.17 4371.7,-4378.14 4374.61,-4384.51"/>
<text text-anchor="middle" x="4251.5" y="-4439.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu10 -->
<g id="node811" class="node">
<title>l3_attn_stage9_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3180" cy="-4359.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3180" y="-4370.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="3180" y="-4355.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3180" y="-4340.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu10&#45;&gt;l3_attn_stage9_gpu10 -->
<g id="edge763" class="edge">
<title>l3_attn_stage8_gpu10&#45;&gt;l3_attn_stage9_gpu10</title>
<path fill="none" stroke="black" d="M3180,-4469.08C3180,-4450.36 3180,-4427.37 3180,-4407.38"/>
<polygon fill="black" stroke="black" points="3183.5,-4407.24 3180,-4397.24 3176.5,-4407.24 3183.5,-4407.24"/>
</g>
<!-- l3_attn_stage8_gpu10&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge1883" class="edge">
<title>l3_attn_stage8_gpu10&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3233.29,-4476.65C3247.42,-4470.31 3262.95,-4464.5 3278,-4461.17 3332.73,-4449.04 4234.13,-4469.81 4287,-4451.17 4297.15,-4447.59 4297.32,-4442.53 4306,-4436.17 4331.22,-4417.67 4360.5,-4397.82 4382.65,-4383.12"/>
<polygon fill="red" stroke="red" points="4384.66,-4385.99 4391.07,-4377.55 4380.8,-4380.15 4384.66,-4385.99"/>
<text text-anchor="middle" x="4337.5" y="-4439.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu11 -->
<g id="node812" class="node">
<title>l3_attn_stage9_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3375" cy="-4359.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3375" y="-4370.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="3375" y="-4355.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3375" y="-4340.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu11&#45;&gt;l3_attn_stage9_gpu11 -->
<g id="edge764" class="edge">
<title>l3_attn_stage8_gpu11&#45;&gt;l3_attn_stage9_gpu11</title>
<path fill="none" stroke="black" d="M3375,-4469.08C3375,-4450.36 3375,-4427.37 3375,-4407.38"/>
<polygon fill="black" stroke="black" points="3378.5,-4407.24 3375,-4397.24 3371.5,-4407.24 3378.5,-4407.24"/>
</g>
<!-- l3_attn_stage8_gpu11&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge1884" class="edge">
<title>l3_attn_stage8_gpu11&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3428.29,-4476.66C3442.42,-4470.32 3457.95,-4464.51 3473,-4461.17 3497.41,-4455.74 4351.88,-4464.55 4373,-4451.17 4394.94,-4437.27 4406.24,-4408.99 4411.85,-4387.72"/>
<polygon fill="red" stroke="red" points="4415.27,-4388.47 4414.18,-4377.94 4408.46,-4386.86 4415.27,-4388.47"/>
<text text-anchor="middle" x="4419.5" y="-4439.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu12 -->
<g id="node813" class="node">
<title>l3_attn_stage9_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3570" cy="-4359.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3570" y="-4370.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="3570" y="-4355.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3570" y="-4340.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu12&#45;&gt;l3_attn_stage9_gpu12 -->
<g id="edge765" class="edge">
<title>l3_attn_stage8_gpu12&#45;&gt;l3_attn_stage9_gpu12</title>
<path fill="none" stroke="black" d="M3514.85,-4477.2C3501.43,-4471.17 3486.93,-4465.36 3473,-4461.17 3459.22,-4457.01 3418.36,-4462.1 3409,-4451.17 3374.08,-4410.36 3414.79,-4450.49 3473,-4428.17 3490.78,-4421.35 3508.42,-4410.6 3523.68,-4399.67"/>
<polygon fill="black" stroke="black" points="3525.93,-4402.36 3531.9,-4393.6 3521.77,-4396.73 3525.93,-4402.36"/>
</g>
<!-- l3_attn_stage8_gpu12&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge1885" class="edge">
<title>l3_attn_stage8_gpu12&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3623.29,-4476.68C3637.43,-4470.34 3652.95,-4464.52 3668,-4461.17 3689.45,-4456.38 4443.56,-4466.8 4459,-4451.17 4477.16,-4432.78 4459.89,-4405.08 4442.31,-4385.18"/>
<polygon fill="red" stroke="red" points="4444.75,-4382.65 4435.38,-4377.7 4439.61,-4387.41 4444.75,-4382.65"/>
<text text-anchor="middle" x="4497.5" y="-4439.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu13 -->
<g id="node814" class="node">
<title>l3_attn_stage9_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3765" cy="-4359.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3765" y="-4370.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="3765" y="-4355.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3765" y="-4340.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu13&#45;&gt;l3_attn_stage9_gpu13 -->
<g id="edge766" class="edge">
<title>l3_attn_stage8_gpu13&#45;&gt;l3_attn_stage9_gpu13</title>
<path fill="none" stroke="black" d="M3711.7,-4476.72C3697.85,-4470.47 3682.69,-4464.68 3668,-4461.17 3654.37,-4457.9 3425.71,-4461.27 3416,-4451.17 3411.38,-4446.36 3411.36,-4440.95 3416,-4436.17 3425.75,-4426.11 3654.7,-4432.57 3668,-4428.17 3686.4,-4422.07 3704.44,-4411.28 3719.87,-4400.08"/>
<polygon fill="black" stroke="black" points="3722.27,-4402.66 3728.16,-4393.85 3718.06,-4397.06 3722.27,-4402.66"/>
</g>
<!-- l3_attn_stage8_gpu13&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge1886" class="edge">
<title>l3_attn_stage8_gpu13&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3818.3,-4476.7C3832.43,-4470.36 3847.96,-4464.54 3863,-4461.17 3881.49,-4457.02 4531.7,-4464.66 4545,-4451.17 4573.36,-4422.39 4525.79,-4396.56 4480.82,-4379.93"/>
<polygon fill="red" stroke="red" points="4481.88,-4376.59 4471.29,-4376.52 4479.53,-4383.18 4481.88,-4376.59"/>
<text text-anchor="middle" x="4584.5" y="-4439.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu14 -->
<g id="node815" class="node">
<title>l3_attn_stage9_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3960" cy="-4359.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3960" y="-4370.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="3960" y="-4355.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3960" y="-4340.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu14&#45;&gt;l3_attn_stage9_gpu14 -->
<g id="edge767" class="edge">
<title>l3_attn_stage8_gpu14&#45;&gt;l3_attn_stage9_gpu14</title>
<path fill="none" stroke="black" d="M3906.74,-4476.55C3892.89,-4470.3 3877.71,-4464.56 3863,-4461.17 3839.17,-4455.68 3440.09,-4468.65 3423,-4451.17 3418.34,-4446.4 3418.33,-4440.92 3423,-4436.17 3431.56,-4427.44 3851.37,-4431.93 3863,-4428.17 3881.45,-4422.19 3899.49,-4411.43 3914.92,-4400.23"/>
<polygon fill="black" stroke="black" points="3917.32,-4402.8 3923.2,-4393.99 3913.11,-4397.21 3917.32,-4402.8"/>
</g>
<!-- l3_attn_stage8_gpu14&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge1887" class="edge">
<title>l3_attn_stage8_gpu14&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4013.3,-4476.73C4027.44,-4470.38 4042.96,-4464.56 4058,-4461.17 4073.53,-4457.66 4619.84,-4462.52 4631,-4451.17 4671.03,-4410.43 4601.32,-4387.07 4531.01,-4374.33"/>
<polygon fill="red" stroke="red" points="4531.55,-4370.87 4521.1,-4372.6 4530.35,-4377.76 4531.55,-4370.87"/>
<text text-anchor="middle" x="4671.5" y="-4439.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage9_gpu15 -->
<g id="node816" class="node">
<title>l3_attn_stage9_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4155" cy="-4359.67" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4155" y="-4370.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage9</text>
<text text-anchor="middle" x="4155" y="-4355.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4155" y="-4340.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage8_gpu15&#45;&gt;l3_attn_stage9_gpu15 -->
<g id="edge768" class="edge">
<title>l3_attn_stage8_gpu15&#45;&gt;l3_attn_stage9_gpu15</title>
<path fill="none" stroke="black" d="M4102.02,-4476.59C4088.09,-4470.3 4072.82,-4464.53 4058,-4461.17 4040.99,-4457.31 3442.24,-4463.6 3430,-4451.17 3425.32,-4446.41 3425.32,-4440.91 3430,-4436.17 3442.26,-4423.75 4041.39,-4433.49 4058,-4428.17 4076.46,-4422.24 4094.51,-4411.5 4109.94,-4400.29"/>
<polygon fill="black" stroke="black" points="4112.34,-4402.86 4118.22,-4394.05 4108.13,-4397.27 4112.34,-4402.86"/>
</g>
<!-- l3_attn_stage8_gpu15&#45;&gt;l3_attn_stage9_gpu[next_gpu] -->
<g id="edge1888" class="edge">
<title>l3_attn_stage8_gpu15&#45;&gt;l3_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4210.38,-4477.35C4225.74,-4470.79 4242.68,-4464.7 4259,-4461.17 4283.87,-4455.78 4699.2,-4469.36 4717,-4451.17 4771.67,-4395.29 4670.45,-4373.63 4571.12,-4365.38"/>
<polygon fill="red" stroke="red" points="4571.15,-4361.87 4560.9,-4364.57 4570.6,-4368.84 4571.15,-4361.87"/>
<text text-anchor="middle" x="4757.5" y="-4439.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu0 -->
<g id="node817" class="node">
<title>l3_attn_stage10_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1028" cy="-4212.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1028" y="-4223.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="1028" y="-4208.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1028" y="-4193.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu0&#45;&gt;l3_attn_stage10_gpu0 -->
<g id="edge769" class="edge">
<title>l3_attn_stage9_gpu0&#45;&gt;l3_attn_stage10_gpu0</title>
<path fill="none" stroke="black" d="M1185.67,-4326.84C1154.97,-4304.81 1113.93,-4275.35 1081.42,-4252.01"/>
<polygon fill="black" stroke="black" points="1083.09,-4248.9 1072.92,-4245.91 1079.01,-4254.59 1083.09,-4248.9"/>
</g>
<!-- l3_attn_stage10_gpu[next_gpu] -->
<g id="node1352" class="node">
<title>l3_attn_stage10_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4423" cy="-4212.67" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4423" y="-4208.97" font-family="Times,serif" font-size="14.00">l3_attn_stage10_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage9_gpu0&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge1889" class="edge">
<title>l3_attn_stage9_gpu0&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1283.29,-4329.67C1297.43,-4323.33 1312.95,-4317.52 1328,-4314.17 1553.93,-4263.85 3179.55,-4291.65 3411,-4289.17 3457.89,-4288.66 4209,-4290.29 4255,-4281.17 4300.32,-4272.18 4348.98,-4251.26 4382.21,-4235.07"/>
<polygon fill="red" stroke="red" points="4384.17,-4238.01 4391.58,-4230.43 4381.06,-4231.73 4384.17,-4238.01"/>
<text text-anchor="middle" x="3442.5" y="-4292.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu1 -->
<g id="node818" class="node">
<title>l3_attn_stage10_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1236" cy="-4212.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1236" y="-4223.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="1236" y="-4208.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1236" y="-4193.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu1&#45;&gt;l3_attn_stage10_gpu1 -->
<g id="edge770" class="edge">
<title>l3_attn_stage9_gpu1&#45;&gt;l3_attn_stage10_gpu1</title>
<path fill="none" stroke="black" d="M1383.05,-4326.49C1354.62,-4304.67 1316.89,-4275.72 1286.76,-4252.61"/>
<polygon fill="black" stroke="black" points="1288.55,-4249.57 1278.48,-4246.26 1284.29,-4255.12 1288.55,-4249.57"/>
</g>
<!-- l3_attn_stage9_gpu1&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge1890" class="edge">
<title>l3_attn_stage9_gpu1&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1478.28,-4329.6C1492.41,-4323.26 1507.94,-4317.46 1523,-4314.17 1576.05,-4302.54 3426.74,-4322.11 3478,-4304.17 3488.15,-4300.61 3486.85,-4292.75 3497,-4289.17 3536.71,-4275.14 4213.7,-4289.38 4255,-4281.17 4300.32,-4272.15 4348.98,-4251.24 4382.21,-4235.06"/>
<polygon fill="red" stroke="red" points="4384.17,-4237.99 4391.58,-4230.42 4381.06,-4231.72 4384.17,-4237.99"/>
<text text-anchor="middle" x="3528.5" y="-4292.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu2 -->
<g id="node819" class="node">
<title>l3_attn_stage10_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1444" cy="-4212.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1444" y="-4223.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="1444" y="-4208.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1444" y="-4193.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu2&#45;&gt;l3_attn_stage10_gpu2 -->
<g id="edge771" class="edge">
<title>l3_attn_stage9_gpu2&#45;&gt;l3_attn_stage10_gpu2</title>
<path fill="none" stroke="black" d="M1580.06,-4325.76C1553.94,-4304.24 1519.66,-4276 1492.05,-4253.25"/>
<polygon fill="black" stroke="black" points="1494.03,-4250.35 1484.08,-4246.69 1489.58,-4255.75 1494.03,-4250.35"/>
</g>
<!-- l3_attn_stage9_gpu2&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge1891" class="edge">
<title>l3_attn_stage9_gpu2&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1673.28,-4329.6C1687.41,-4323.26 1702.94,-4317.47 1718,-4314.17 1768.09,-4303.18 3515.6,-4321.11 3564,-4304.17 3574.15,-4300.61 3572.86,-4292.75 3583,-4289.17 3618.2,-4276.71 4218.39,-4288.47 4255,-4281.17 4300.31,-4272.12 4348.97,-4251.21 4382.2,-4235.04"/>
<polygon fill="red" stroke="red" points="4384.16,-4237.98 4391.57,-4230.41 4381.06,-4231.7 4384.16,-4237.98"/>
<text text-anchor="middle" x="3614.5" y="-4292.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu3 -->
<g id="node820" class="node">
<title>l3_attn_stage10_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1652" cy="-4212.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1652" y="-4223.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="1652" y="-4208.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1652" y="-4193.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu3&#45;&gt;l3_attn_stage10_gpu3 -->
<g id="edge772" class="edge">
<title>l3_attn_stage9_gpu3&#45;&gt;l3_attn_stage10_gpu3</title>
<path fill="none" stroke="black" d="M1777.6,-4325.4C1753.75,-4304.18 1722.69,-4276.55 1697.43,-4254.08"/>
<polygon fill="black" stroke="black" points="1699.58,-4251.31 1689.79,-4247.28 1694.93,-4256.54 1699.58,-4251.31"/>
</g>
<!-- l3_attn_stage9_gpu3&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge1892" class="edge">
<title>l3_attn_stage9_gpu3&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1868.28,-4329.6C1882.41,-4323.27 1897.94,-4317.47 1913,-4314.17 1960.13,-4303.82 3604.46,-4320.12 3650,-4304.17 3660.15,-4300.61 3658.86,-4292.76 3669,-4289.17 3699.68,-4278.28 4223.08,-4287.57 4255,-4281.17 4300.3,-4272.08 4348.97,-4251.18 4382.2,-4235.02"/>
<polygon fill="red" stroke="red" points="4384.16,-4237.96 4391.57,-4230.39 4381.06,-4231.68 4384.16,-4237.96"/>
<text text-anchor="middle" x="3700.5" y="-4292.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu4 -->
<g id="node821" class="node">
<title>l3_attn_stage10_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1860" cy="-4212.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1860" y="-4223.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="1860" y="-4208.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1860" y="-4193.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu4&#45;&gt;l3_attn_stage10_gpu4 -->
<g id="edge773" class="edge">
<title>l3_attn_stage9_gpu4&#45;&gt;l3_attn_stage10_gpu4</title>
<path fill="none" stroke="black" d="M1975.21,-4325.04C1953.5,-4304.05 1925.41,-4276.89 1902.4,-4254.65"/>
<polygon fill="black" stroke="black" points="1904.74,-4252.05 1895.12,-4247.62 1899.88,-4257.08 1904.74,-4252.05"/>
</g>
<!-- l3_attn_stage9_gpu4&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge1893" class="edge">
<title>l3_attn_stage9_gpu4&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2063.28,-4329.61C2077.41,-4323.27 2092.94,-4317.47 2108,-4314.17 2152.17,-4304.46 3693.32,-4319.13 3736,-4304.17 3746.15,-4300.61 3744.86,-4292.78 3755,-4289.17 3807.34,-4270.52 4200.53,-4292.15 4255,-4281.17 4300.29,-4272.03 4348.96,-4251.13 4382.19,-4234.99"/>
<polygon fill="red" stroke="red" points="4384.15,-4237.93 4391.57,-4230.37 4381.05,-4231.65 4384.15,-4237.93"/>
<text text-anchor="middle" x="3786.5" y="-4292.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu5 -->
<g id="node822" class="node">
<title>l3_attn_stage10_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2068" cy="-4212.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2068" y="-4223.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="2068" y="-4208.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2068" y="-4193.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu5&#45;&gt;l3_attn_stage10_gpu5 -->
<g id="edge774" class="edge">
<title>l3_attn_stage9_gpu5&#45;&gt;l3_attn_stage10_gpu5</title>
<path fill="none" stroke="black" d="M2172.88,-4324.67C2153.35,-4304 2128.27,-4277.46 2107.53,-4255.51"/>
<polygon fill="black" stroke="black" points="2109.81,-4252.82 2100.39,-4247.95 2104.72,-4257.62 2109.81,-4252.82"/>
</g>
<!-- l3_attn_stage9_gpu5&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge1894" class="edge">
<title>l3_attn_stage9_gpu5&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2258.28,-4329.61C2272.41,-4323.27 2287.94,-4317.48 2303,-4314.17 2344.21,-4305.11 3782.18,-4318.14 3822,-4304.17 3832.15,-4300.6 3830.87,-4292.79 3841,-4289.17 3884.32,-4273.66 4209.91,-4290.34 4255,-4281.17 4300.28,-4271.96 4348.95,-4251.07 4382.18,-4234.95"/>
<polygon fill="red" stroke="red" points="4384.14,-4237.89 4391.56,-4230.33 4381.04,-4231.61 4384.14,-4237.89"/>
<text text-anchor="middle" x="3872.5" y="-4292.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu6 -->
<g id="node823" class="node">
<title>l3_attn_stage10_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2276" cy="-4212.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2276" y="-4223.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="2276" y="-4208.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2276" y="-4193.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu6&#45;&gt;l3_attn_stage10_gpu6 -->
<g id="edge775" class="edge">
<title>l3_attn_stage9_gpu6&#45;&gt;l3_attn_stage10_gpu6</title>
<path fill="none" stroke="black" d="M2370.3,-4323.93C2352.88,-4303.56 2330.74,-4277.67 2312.29,-4256.1"/>
<polygon fill="black" stroke="black" points="2314.83,-4253.69 2305.67,-4248.36 2309.51,-4258.24 2314.83,-4253.69"/>
</g>
<!-- l3_attn_stage9_gpu6&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge1895" class="edge">
<title>l3_attn_stage9_gpu6&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2453.28,-4329.62C2467.42,-4323.28 2482.94,-4317.48 2498,-4314.17 2536.25,-4305.75 3871.04,-4317.14 3908,-4304.17 3918.15,-4300.6 3916.88,-4292.82 3927,-4289.17 3961.29,-4276.79 4219.29,-4288.52 4255,-4281.17 4300.11,-4271.87 4348.62,-4251.1 4381.86,-4235.04"/>
<polygon fill="red" stroke="red" points="4383.81,-4237.98 4391.24,-4230.43 4380.72,-4231.7 4383.81,-4237.98"/>
<text text-anchor="middle" x="3958.5" y="-4292.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu7 -->
<g id="node824" class="node">
<title>l3_attn_stage10_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2484" cy="-4212.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2484" y="-4223.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="2484" y="-4208.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2484" y="-4193.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu7&#45;&gt;l3_attn_stage10_gpu7 -->
<g id="edge776" class="edge">
<title>l3_attn_stage9_gpu7&#45;&gt;l3_attn_stage10_gpu7</title>
<path fill="none" stroke="black" d="M2568.13,-4323.57C2552.71,-4303.42 2533.23,-4277.98 2516.9,-4256.65"/>
<polygon fill="black" stroke="black" points="2519.67,-4254.51 2510.81,-4248.69 2514.11,-4258.76 2519.67,-4254.51"/>
</g>
<!-- l3_attn_stage9_gpu7&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge1896" class="edge">
<title>l3_attn_stage9_gpu7&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2648.28,-4329.62C2662.42,-4323.29 2677.95,-4317.48 2693,-4314.17 2763.59,-4298.61 3925.81,-4328.13 3994,-4304.17 4004.15,-4300.6 4002.9,-4292.86 4013,-4289.17 4063.53,-4270.68 4202.35,-4292.25 4255,-4281.17 4300.07,-4271.67 4348.59,-4250.93 4381.84,-4234.93"/>
<polygon fill="red" stroke="red" points="4383.78,-4237.88 4391.22,-4230.34 4380.7,-4231.59 4383.78,-4237.88"/>
<text text-anchor="middle" x="4044.5" y="-4292.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu8 -->
<g id="node825" class="node">
<title>l3_attn_stage10_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2692" cy="-4212.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2692" y="-4223.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="2692" y="-4208.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2692" y="-4193.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu8&#45;&gt;l3_attn_stage10_gpu8 -->
<g id="edge777" class="edge">
<title>l3_attn_stage9_gpu8&#45;&gt;l3_attn_stage10_gpu8</title>
<path fill="none" stroke="black" d="M2766.03,-4323.19C2752.63,-4303.37 2735.82,-4278.5 2721.61,-4257.47"/>
<polygon fill="black" stroke="black" points="2724.4,-4255.35 2715.9,-4249.02 2718.6,-4259.27 2724.4,-4255.35"/>
</g>
<!-- l3_attn_stage9_gpu8&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge1897" class="edge">
<title>l3_attn_stage9_gpu8&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2843.28,-4329.63C2857.42,-4323.29 2872.95,-4317.49 2888,-4314.17 2952.67,-4299.89 4017.53,-4326.15 4080,-4304.17 4090.15,-4300.59 4088.93,-4292.95 4099,-4289.17 4131.49,-4276.95 4221.1,-4288.63 4255,-4281.17 4299.84,-4271.3 4348.21,-4250.71 4381.48,-4234.85"/>
<polygon fill="red" stroke="red" points="4383.4,-4237.82 4390.87,-4230.31 4380.35,-4231.51 4383.4,-4237.82"/>
<text text-anchor="middle" x="4130.5" y="-4292.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu9 -->
<g id="node826" class="node">
<title>l3_attn_stage10_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2900" cy="-4212.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2900" y="-4223.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="2900" y="-4208.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2900" y="-4193.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu9&#45;&gt;l3_attn_stage10_gpu9 -->
<g id="edge778" class="edge">
<title>l3_attn_stage9_gpu9&#45;&gt;l3_attn_stage10_gpu9</title>
<path fill="none" stroke="black" d="M2964.21,-4323.19C2952.68,-4303.53 2938.24,-4278.91 2925.98,-4257.99"/>
<polygon fill="black" stroke="black" points="2928.95,-4256.13 2920.87,-4249.27 2922.91,-4259.67 2928.95,-4256.13"/>
</g>
<!-- l3_attn_stage9_gpu9&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge1898" class="edge">
<title>l3_attn_stage9_gpu9&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3038.29,-4329.64C3052.42,-4323.3 3067.95,-4317.5 3083,-4314.17 3141.75,-4301.17 4109.25,-4324.16 4166,-4304.17 4176.15,-4300.59 4175.05,-4293.27 4185,-4289.17 4213.95,-4277.23 4224.64,-4288.85 4255,-4281.17 4298.96,-4270.04 4346.72,-4250.02 4380.04,-4234.66"/>
<polygon fill="red" stroke="red" points="4381.89,-4237.66 4389.47,-4230.26 4378.93,-4231.32 4381.89,-4237.66"/>
<text text-anchor="middle" x="4216.5" y="-4292.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu10 -->
<g id="node827" class="node">
<title>l3_attn_stage10_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3108" cy="-4212.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3108" y="-4223.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="3108" y="-4208.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3108" y="-4193.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu10&#45;&gt;l3_attn_stage10_gpu10 -->
<g id="edge779" class="edge">
<title>l3_attn_stage9_gpu10&#45;&gt;l3_attn_stage10_gpu10</title>
<path fill="none" stroke="black" d="M3162.2,-4322.82C3152.6,-4303.48 3140.64,-4279.41 3130.41,-4258.8"/>
<polygon fill="black" stroke="black" points="3133.42,-4257 3125.84,-4249.6 3127.16,-4260.11 3133.42,-4257"/>
</g>
<!-- l3_attn_stage9_gpu10&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge1899" class="edge">
<title>l3_attn_stage9_gpu10&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3233.29,-4329.65C3247.42,-4323.31 3262.95,-4317.5 3278,-4314.17 3330.83,-4302.45 4200.97,-4322.18 4252,-4304.17 4262.15,-4300.59 4261.91,-4294.92 4271,-4289.17 4304.39,-4268.02 4344.51,-4248.31 4375.15,-4234.33"/>
<polygon fill="red" stroke="red" points="4376.66,-4237.49 4384.34,-4230.18 4373.78,-4231.11 4376.66,-4237.49"/>
<text text-anchor="middle" x="4302.5" y="-4292.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu11 -->
<g id="node828" class="node">
<title>l3_attn_stage10_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3316" cy="-4212.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3316" y="-4223.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="3316" y="-4208.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3316" y="-4193.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu11&#45;&gt;l3_attn_stage10_gpu11 -->
<g id="edge780" class="edge">
<title>l3_attn_stage9_gpu11&#45;&gt;l3_attn_stage10_gpu11</title>
<path fill="none" stroke="black" d="M3360.26,-4322.45C3352.49,-4303.33 3342.86,-4279.68 3334.58,-4259.32"/>
<polygon fill="black" stroke="black" points="3337.76,-4257.87 3330.75,-4249.92 3331.28,-4260.5 3337.76,-4257.87"/>
</g>
<!-- l3_attn_stage9_gpu11&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge1900" class="edge">
<title>l3_attn_stage9_gpu11&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3428.29,-4329.66C3442.43,-4323.32 3457.95,-4317.51 3473,-4314.17 3519.91,-4303.73 4294,-4323.5 4338,-4304.17 4346.1,-4300.6 4378.79,-4264.37 4401.18,-4238.85"/>
<polygon fill="red" stroke="red" points="4404.1,-4240.82 4408.05,-4230.99 4398.83,-4236.22 4404.1,-4240.82"/>
<text text-anchor="middle" x="4384.5" y="-4292.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu12 -->
<g id="node829" class="node">
<title>l3_attn_stage10_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3524" cy="-4212.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3524" y="-4223.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="3524" y="-4208.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3524" y="-4193.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu12&#45;&gt;l3_attn_stage10_gpu12 -->
<g id="edge781" class="edge">
<title>l3_attn_stage9_gpu12&#45;&gt;l3_attn_stage10_gpu12</title>
<path fill="none" stroke="black" d="M3515.78,-4330C3502.14,-4323.86 3487.3,-4318.05 3473,-4314.17 3451.66,-4308.37 3388.83,-4320.57 3374,-4304.17 3343.62,-4270.57 3393.35,-4291.62 3420,-4281.17 3438.6,-4273.87 3457.38,-4262.99 3473.77,-4252.08"/>
<polygon fill="black" stroke="black" points="3475.82,-4254.92 3482.11,-4246.4 3471.88,-4249.14 3475.82,-4254.92"/>
</g>
<!-- l3_attn_stage9_gpu12&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge1901" class="edge">
<title>l3_attn_stage9_gpu12&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3623.29,-4329.68C3637.43,-4323.34 3652.95,-4317.53 3668,-4314.17 3688.5,-4309.59 4409.25,-4319.11 4424,-4304.17 4440.05,-4287.9 4437.54,-4260.91 4432.38,-4240.63"/>
<polygon fill="red" stroke="red" points="4435.74,-4239.65 4429.62,-4231.01 4429.01,-4241.58 4435.74,-4239.65"/>
<text text-anchor="middle" x="4463.5" y="-4292.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu13 -->
<g id="node830" class="node">
<title>l3_attn_stage10_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3732" cy="-4212.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3732" y="-4223.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="3732" y="-4208.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3732" y="-4193.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu13&#45;&gt;l3_attn_stage10_gpu13 -->
<g id="edge782" class="edge">
<title>l3_attn_stage9_gpu13&#45;&gt;l3_attn_stage10_gpu13</title>
<path fill="none" stroke="black" d="M3711.72,-4329.67C3697.86,-4323.42 3682.69,-4317.64 3668,-4314.17 3652.48,-4310.49 3392.08,-4315.64 3381,-4304.17 3376.37,-4299.37 3376.36,-4293.96 3381,-4289.17 3390.55,-4279.3 3614.9,-4285.28 3628,-4281.17 3647.59,-4275.02 3667.02,-4264.08 3683.68,-4252.78"/>
<polygon fill="black" stroke="black" points="3685.95,-4255.46 3692.14,-4246.86 3681.94,-4249.73 3685.95,-4255.46"/>
</g>
<!-- l3_attn_stage9_gpu13&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge1902" class="edge">
<title>l3_attn_stage9_gpu13&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3818.3,-4329.7C3832.43,-4323.36 3847.96,-4317.54 3863,-4314.17 3880.54,-4310.23 4497.39,-4316.97 4510,-4304.17 4532.99,-4280.81 4498.96,-4253.67 4466.96,-4235.25"/>
<polygon fill="red" stroke="red" points="4468.48,-4232.09 4458.04,-4230.29 4465.08,-4238.21 4468.48,-4232.09"/>
<text text-anchor="middle" x="4548.5" y="-4292.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu14 -->
<g id="node831" class="node">
<title>l3_attn_stage10_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3940" cy="-4212.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3940" y="-4223.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="3940" y="-4208.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3940" y="-4193.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu14&#45;&gt;l3_attn_stage10_gpu14 -->
<g id="edge783" class="edge">
<title>l3_attn_stage9_gpu14&#45;&gt;l3_attn_stage10_gpu14</title>
<path fill="none" stroke="black" d="M3906.75,-4329.53C3892.9,-4323.28 3877.72,-4317.54 3863,-4314.17 3837.27,-4308.26 3406.47,-4323.02 3388,-4304.17 3383.34,-4299.4 3383.33,-4293.92 3388,-4289.17 3396.72,-4280.29 3824.1,-4284.81 3836,-4281.17 3855.63,-4275.16 3875.07,-4264.26 3891.74,-4252.95"/>
<polygon fill="black" stroke="black" points="3894.01,-4255.63 3900.18,-4247.02 3889.99,-4249.9 3894.01,-4255.63"/>
</g>
<!-- l3_attn_stage9_gpu14&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge1903" class="edge">
<title>l3_attn_stage9_gpu14&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4013.56,-4329.62C4027.63,-4323.33 4043.06,-4317.55 4058,-4314.17 4072.58,-4310.87 4585.53,-4314.83 4596,-4304.17 4630.12,-4269.41 4571.44,-4245.16 4513.38,-4230.57"/>
<polygon fill="red" stroke="red" points="4513.87,-4227.09 4503.33,-4228.13 4512.22,-4233.89 4513.87,-4227.09"/>
<text text-anchor="middle" x="4636.5" y="-4292.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage10_gpu15 -->
<g id="node832" class="node">
<title>l3_attn_stage10_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4148" cy="-4212.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4148" y="-4223.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage10</text>
<text text-anchor="middle" x="4148" y="-4208.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4148" y="-4193.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage9_gpu15&#45;&gt;l3_attn_stage10_gpu15 -->
<g id="edge784" class="edge">
<title>l3_attn_stage9_gpu15&#45;&gt;l3_attn_stage10_gpu15</title>
<path fill="none" stroke="black" d="M4102.02,-4329.59C4088.1,-4323.29 4072.82,-4317.52 4058,-4314.17 4040.04,-4310.1 3407.93,-4317.29 3395,-4304.17 3390.32,-4299.42 3390.32,-4293.91 3395,-4289.17 3407.67,-4276.34 4026.74,-4286.39 4044,-4281.17 4063.65,-4275.22 4083.09,-4264.33 4099.76,-4253.01"/>
<polygon fill="black" stroke="black" points="4102.03,-4255.69 4108.2,-4247.08 4098.01,-4249.96 4102.03,-4255.69"/>
</g>
<!-- l3_attn_stage9_gpu15&#45;&gt;l3_attn_stage10_gpu[next_gpu] -->
<g id="edge1904" class="edge">
<title>l3_attn_stage9_gpu15&#45;&gt;l3_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4210.38,-4330.37C4225.74,-4323.81 4242.69,-4317.71 4259,-4314.17 4281.97,-4309.17 4665.58,-4320.98 4682,-4304.17 4728.21,-4256.85 4648.09,-4234.24 4565.09,-4223.45"/>
<polygon fill="red" stroke="red" points="4565.32,-4219.95 4554.97,-4222.19 4564.46,-4226.9 4565.32,-4219.95"/>
<text text-anchor="middle" x="4723.5" y="-4292.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu0 -->
<g id="node833" class="node">
<title>l3_attn_stage11_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1028" cy="-4065.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1028" y="-4076.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="1028" y="-4061.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1028" y="-4046.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu0&#45;&gt;l3_attn_stage11_gpu0 -->
<g id="edge785" class="edge">
<title>l3_attn_stage10_gpu0&#45;&gt;l3_attn_stage11_gpu0</title>
<path fill="none" stroke="black" d="M1028,-4175.08C1028,-4156.36 1028,-4133.37 1028,-4113.38"/>
<polygon fill="black" stroke="black" points="1031.5,-4113.24 1028,-4103.24 1024.5,-4113.24 1031.5,-4113.24"/>
</g>
<!-- l3_attn_stage11_gpu[next_gpu] -->
<g id="node1353" class="node">
<title>l3_attn_stage11_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4423" cy="-4065.67" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4423" y="-4061.97" font-family="Times,serif" font-size="14.00">l3_attn_stage11_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage10_gpu0&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge1905" class="edge">
<title>l3_attn_stage10_gpu0&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1084.98,-4182.54C1099.91,-4176.24 1116.24,-4170.48 1132,-4167.17 1381.97,-4114.51 3175.55,-4144.79 3431,-4142.17 3476.78,-4141.69 4210.1,-4143.08 4255,-4134.17 4300.32,-4125.17 4348.98,-4104.25 4382.21,-4088.07"/>
<polygon fill="red" stroke="red" points="4384.17,-4091 4391.58,-4083.43 4381.06,-4084.73 4384.17,-4091"/>
<text text-anchor="middle" x="3462.5" y="-4145.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu1 -->
<g id="node834" class="node">
<title>l3_attn_stage11_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1236" cy="-4065.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1236" y="-4076.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="1236" y="-4061.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1236" y="-4046.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu1&#45;&gt;l3_attn_stage11_gpu1 -->
<g id="edge786" class="edge">
<title>l3_attn_stage10_gpu1&#45;&gt;l3_attn_stage11_gpu1</title>
<path fill="none" stroke="black" d="M1236,-4175.08C1236,-4156.36 1236,-4133.37 1236,-4113.38"/>
<polygon fill="black" stroke="black" points="1239.5,-4113.24 1236,-4103.24 1232.5,-4113.24 1239.5,-4113.24"/>
</g>
<!-- l3_attn_stage10_gpu1&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge1906" class="edge">
<title>l3_attn_stage10_gpu1&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1292.97,-4182.47C1307.89,-4176.18 1324.23,-4170.44 1340,-4167.17 1398.7,-4154.99 3441.42,-4176.96 3498,-4157.17 3508.16,-4153.61 3506.86,-4145.75 3517,-4142.17 3555.66,-4128.51 4214.79,-4142.17 4255,-4134.17 4300.31,-4125.15 4348.98,-4104.23 4382.21,-4088.05"/>
<polygon fill="red" stroke="red" points="4384.17,-4090.99 4391.58,-4083.42 4381.06,-4084.72 4384.17,-4090.99"/>
<text text-anchor="middle" x="3548.5" y="-4145.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu2 -->
<g id="node835" class="node">
<title>l3_attn_stage11_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1444" cy="-4065.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1444" y="-4076.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="1444" y="-4061.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1444" y="-4046.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu2&#45;&gt;l3_attn_stage11_gpu2 -->
<g id="edge787" class="edge">
<title>l3_attn_stage10_gpu2&#45;&gt;l3_attn_stage11_gpu2</title>
<path fill="none" stroke="black" d="M1444,-4175.08C1444,-4156.36 1444,-4133.37 1444,-4113.38"/>
<polygon fill="black" stroke="black" points="1447.5,-4113.24 1444,-4103.24 1440.5,-4113.24 1447.5,-4113.24"/>
</g>
<!-- l3_attn_stage10_gpu2&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge1907" class="edge">
<title>l3_attn_stage10_gpu2&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1500.97,-4182.47C1515.89,-4176.18 1532.23,-4170.44 1548,-4167.17 1603.38,-4155.67 3530.62,-4175.85 3584,-4157.17 3594.16,-4153.61 3592.86,-4145.76 3603,-4142.17 3637.15,-4130.08 4219.48,-4141.26 4255,-4134.17 4300.31,-4125.12 4348.97,-4104.2 4382.2,-4088.04"/>
<polygon fill="red" stroke="red" points="4384.16,-4090.97 4391.57,-4083.4 4381.06,-4084.7 4384.16,-4090.97"/>
<text text-anchor="middle" x="3634.5" y="-4145.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu3 -->
<g id="node836" class="node">
<title>l3_attn_stage11_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1652" cy="-4065.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1652" y="-4076.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="1652" y="-4061.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1652" y="-4046.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu3&#45;&gt;l3_attn_stage11_gpu3 -->
<g id="edge788" class="edge">
<title>l3_attn_stage10_gpu3&#45;&gt;l3_attn_stage11_gpu3</title>
<path fill="none" stroke="black" d="M1652,-4175.08C1652,-4156.36 1652,-4133.37 1652,-4113.38"/>
<polygon fill="black" stroke="black" points="1655.5,-4113.24 1652,-4103.24 1648.5,-4113.24 1655.5,-4113.24"/>
</g>
<!-- l3_attn_stage10_gpu3&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge1908" class="edge">
<title>l3_attn_stage10_gpu3&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1708.97,-4182.48C1723.9,-4176.18 1740.23,-4170.44 1756,-4167.17 1808.06,-4156.35 3619.82,-4174.73 3670,-4157.17 3680.15,-4153.61 3678.86,-4145.77 3689,-4142.17 3718.63,-4131.64 4224.17,-4140.35 4255,-4134.17 4300.3,-4125.07 4348.97,-4104.17 4382.2,-4088.01"/>
<polygon fill="red" stroke="red" points="4384.15,-4090.95 4391.57,-4083.38 4381.05,-4084.68 4384.15,-4090.95"/>
<text text-anchor="middle" x="3720.5" y="-4145.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu4 -->
<g id="node837" class="node">
<title>l3_attn_stage11_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1860" cy="-4065.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1860" y="-4076.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="1860" y="-4061.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1860" y="-4046.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu4&#45;&gt;l3_attn_stage11_gpu4 -->
<g id="edge789" class="edge">
<title>l3_attn_stage10_gpu4&#45;&gt;l3_attn_stage11_gpu4</title>
<path fill="none" stroke="black" d="M1860,-4175.08C1860,-4156.36 1860,-4133.37 1860,-4113.38"/>
<polygon fill="black" stroke="black" points="1863.5,-4113.24 1860,-4103.24 1856.5,-4113.24 1863.5,-4113.24"/>
</g>
<!-- l3_attn_stage10_gpu4&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge1909" class="edge">
<title>l3_attn_stage10_gpu4&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1916.97,-4182.48C1931.9,-4176.19 1948.23,-4170.44 1964,-4167.17 2012.74,-4157.04 3709.02,-4173.62 3756,-4157.17 3766.15,-4153.61 3764.87,-4145.78 3775,-4142.17 3825.24,-4124.25 4202.72,-4144.73 4255,-4134.17 4300.29,-4125.02 4348.96,-4104.12 4382.19,-4087.98"/>
<polygon fill="red" stroke="red" points="4384.14,-4090.92 4391.56,-4083.36 4381.05,-4084.64 4384.14,-4090.92"/>
<text text-anchor="middle" x="3806.5" y="-4145.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu5 -->
<g id="node838" class="node">
<title>l3_attn_stage11_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2068" cy="-4065.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2068" y="-4076.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="2068" y="-4061.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2068" y="-4046.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu5&#45;&gt;l3_attn_stage11_gpu5 -->
<g id="edge790" class="edge">
<title>l3_attn_stage10_gpu5&#45;&gt;l3_attn_stage11_gpu5</title>
<path fill="none" stroke="black" d="M2068,-4175.08C2068,-4156.36 2068,-4133.37 2068,-4113.38"/>
<polygon fill="black" stroke="black" points="2071.5,-4113.24 2068,-4103.24 2064.5,-4113.24 2071.5,-4113.24"/>
</g>
<!-- l3_attn_stage10_gpu5&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge1910" class="edge">
<title>l3_attn_stage10_gpu5&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2124.97,-4182.48C2139.9,-4176.19 2156.23,-4170.45 2172,-4167.17 2217.42,-4157.72 3798.22,-4172.51 3842,-4157.17 3852.15,-4153.61 3850.87,-4145.8 3861,-4142.17 3902.22,-4127.39 4212.1,-4142.92 4255,-4134.17 4300.27,-4124.93 4348.94,-4104.05 4382.18,-4087.94"/>
<polygon fill="red" stroke="red" points="4384.13,-4090.88 4391.56,-4083.32 4381.04,-4084.6 4384.13,-4090.88"/>
<text text-anchor="middle" x="3892.5" y="-4145.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu6 -->
<g id="node839" class="node">
<title>l3_attn_stage11_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2276" cy="-4065.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2276" y="-4076.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="2276" y="-4061.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2276" y="-4046.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu6&#45;&gt;l3_attn_stage11_gpu6 -->
<g id="edge791" class="edge">
<title>l3_attn_stage10_gpu6&#45;&gt;l3_attn_stage11_gpu6</title>
<path fill="none" stroke="black" d="M2276,-4175.08C2276,-4156.36 2276,-4133.37 2276,-4113.38"/>
<polygon fill="black" stroke="black" points="2279.5,-4113.24 2276,-4103.24 2272.5,-4113.24 2279.5,-4113.24"/>
</g>
<!-- l3_attn_stage10_gpu6&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge1911" class="edge">
<title>l3_attn_stage10_gpu6&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2332.97,-4182.49C2347.9,-4176.2 2364.23,-4170.45 2380,-4167.17 2422.1,-4158.4 3887.42,-4171.4 3928,-4157.17 3938.15,-4153.6 3936.88,-4145.83 3947,-4142.17 3979.19,-4130.52 4221.48,-4141.1 4255,-4134.17 4300.11,-4124.83 4348.62,-4104.07 4381.86,-4088.02"/>
<polygon fill="red" stroke="red" points="4383.8,-4090.96 4391.24,-4083.42 4380.72,-4084.68 4383.8,-4090.96"/>
<text text-anchor="middle" x="3978.5" y="-4145.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu7 -->
<g id="node840" class="node">
<title>l3_attn_stage11_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2484" cy="-4065.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2484" y="-4076.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="2484" y="-4061.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2484" y="-4046.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu7&#45;&gt;l3_attn_stage11_gpu7 -->
<g id="edge792" class="edge">
<title>l3_attn_stage10_gpu7&#45;&gt;l3_attn_stage11_gpu7</title>
<path fill="none" stroke="black" d="M2484,-4175.08C2484,-4156.36 2484,-4133.37 2484,-4113.38"/>
<polygon fill="black" stroke="black" points="2487.5,-4113.24 2484,-4103.24 2480.5,-4113.24 2487.5,-4113.24"/>
</g>
<!-- l3_attn_stage10_gpu7&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge1912" class="edge">
<title>l3_attn_stage10_gpu7&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2540.98,-4182.5C2555.9,-4176.2 2572.24,-4170.45 2588,-4167.17 2626.78,-4159.08 3976.62,-4170.29 4014,-4157.17 4024.15,-4153.6 4022.9,-4145.88 4033,-4142.17 4079.34,-4125.14 4206.71,-4144.41 4255,-4134.17 4300.06,-4124.61 4348.58,-4103.88 4381.83,-4087.89"/>
<polygon fill="red" stroke="red" points="4383.76,-4090.85 4391.22,-4083.31 4380.69,-4084.55 4383.76,-4090.85"/>
<text text-anchor="middle" x="4064.5" y="-4145.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu8 -->
<g id="node841" class="node">
<title>l3_attn_stage11_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2692" cy="-4065.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2692" y="-4076.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="2692" y="-4061.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2692" y="-4046.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu8&#45;&gt;l3_attn_stage11_gpu8 -->
<g id="edge793" class="edge">
<title>l3_attn_stage10_gpu8&#45;&gt;l3_attn_stage11_gpu8</title>
<path fill="none" stroke="black" d="M2692,-4175.08C2692,-4156.36 2692,-4133.37 2692,-4113.38"/>
<polygon fill="black" stroke="black" points="2695.5,-4113.24 2692,-4103.24 2688.5,-4113.24 2695.5,-4113.24"/>
</g>
<!-- l3_attn_stage10_gpu8&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge1913" class="edge">
<title>l3_attn_stage10_gpu8&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2748.98,-4182.5C2763.9,-4176.21 2780.24,-4170.46 2796,-4167.17 2866.91,-4152.35 4031.65,-4181.19 4100,-4157.17 4110.15,-4153.6 4108.94,-4145.99 4119,-4142.17 4147.3,-4131.4 4225.46,-4140.78 4255,-4134.17 4299.67,-4124.16 4347.88,-4103.69 4381.15,-4087.91"/>
<polygon fill="red" stroke="red" points="4383.06,-4090.88 4390.55,-4083.38 4380.02,-4084.57 4383.06,-4090.88"/>
<text text-anchor="middle" x="4150.5" y="-4145.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu9 -->
<g id="node842" class="node">
<title>l3_attn_stage11_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2900" cy="-4065.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2900" y="-4076.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="2900" y="-4061.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2900" y="-4046.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu9&#45;&gt;l3_attn_stage11_gpu9 -->
<g id="edge794" class="edge">
<title>l3_attn_stage10_gpu9&#45;&gt;l3_attn_stage11_gpu9</title>
<path fill="none" stroke="black" d="M2900,-4175.08C2900,-4156.36 2900,-4133.37 2900,-4113.38"/>
<polygon fill="black" stroke="black" points="2903.5,-4113.24 2900,-4103.24 2896.5,-4113.24 2903.5,-4113.24"/>
</g>
<!-- l3_attn_stage10_gpu9&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge1914" class="edge">
<title>l3_attn_stage10_gpu9&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2956.98,-4182.51C2971.9,-4176.22 2988.24,-4170.47 3004,-4167.17 3068.28,-4153.71 4124.05,-4178.96 4186,-4157.17 4196.15,-4153.59 4195.15,-4146.49 4205,-4142.17 4225.61,-4133.12 4233.31,-4140.18 4255,-4134.17 4298.28,-4122.17 4345.59,-4102.54 4378.94,-4087.53"/>
<polygon fill="red" stroke="red" points="4380.74,-4090.55 4388.4,-4083.23 4377.84,-4084.18 4380.74,-4090.55"/>
<text text-anchor="middle" x="4236.5" y="-4145.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu10 -->
<g id="node843" class="node">
<title>l3_attn_stage11_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3108" cy="-4065.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3108" y="-4076.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="3108" y="-4061.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3108" y="-4046.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu10&#45;&gt;l3_attn_stage11_gpu10 -->
<g id="edge795" class="edge">
<title>l3_attn_stage10_gpu10&#45;&gt;l3_attn_stage11_gpu10</title>
<path fill="none" stroke="black" d="M3108,-4175.08C3108,-4156.36 3108,-4133.37 3108,-4113.38"/>
<polygon fill="black" stroke="black" points="3111.5,-4113.24 3108,-4103.24 3104.5,-4113.24 3111.5,-4113.24"/>
</g>
<!-- l3_attn_stage10_gpu10&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge1915" class="edge">
<title>l3_attn_stage10_gpu10&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3164.98,-4182.52C3179.91,-4176.23 3196.24,-4170.47 3212,-4167.17 3269.64,-4155.07 4216.46,-4176.74 4272,-4157.17 4282.15,-4153.59 4282.08,-4148.19 4291,-4142.17 4320.36,-4122.34 4355.2,-4102.56 4381.72,-4088.22"/>
<polygon fill="red" stroke="red" points="4383.57,-4091.19 4390.73,-4083.38 4380.26,-4085.03 4383.57,-4091.19"/>
<text text-anchor="middle" x="4322.5" y="-4145.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu11 -->
<g id="node844" class="node">
<title>l3_attn_stage11_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3316" cy="-4065.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3316" y="-4076.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="3316" y="-4061.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3316" y="-4046.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu11&#45;&gt;l3_attn_stage11_gpu11 -->
<g id="edge796" class="edge">
<title>l3_attn_stage10_gpu11&#45;&gt;l3_attn_stage11_gpu11</title>
<path fill="none" stroke="black" d="M3316,-4175.08C3316,-4156.36 3316,-4133.37 3316,-4113.38"/>
<polygon fill="black" stroke="black" points="3319.5,-4113.24 3316,-4103.24 3312.5,-4113.24 3319.5,-4113.24"/>
</g>
<!-- l3_attn_stage10_gpu11&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge1916" class="edge">
<title>l3_attn_stage10_gpu11&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3372.98,-4182.54C3387.91,-4176.24 3404.24,-4170.48 3420,-4167.17 3445.5,-4161.8 4334.88,-4169.18 4358,-4157.17 4371.7,-4150.05 4393.58,-4116.63 4408.12,-4092.47"/>
<polygon fill="red" stroke="red" points="4411.21,-4094.12 4413.3,-4083.74 4405.19,-4090.55 4411.21,-4094.12"/>
<text text-anchor="middle" x="4404.5" y="-4145.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu12 -->
<g id="node845" class="node">
<title>l3_attn_stage11_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3524" cy="-4065.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3524" y="-4076.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="3524" y="-4061.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3524" y="-4046.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu12&#45;&gt;l3_attn_stage11_gpu12 -->
<g id="edge797" class="edge">
<title>l3_attn_stage10_gpu12&#45;&gt;l3_attn_stage11_gpu12</title>
<path fill="none" stroke="black" d="M3461.19,-4184.34C3447.64,-4178.58 3433.37,-4172.6 3420,-4167.17 3408.53,-4162.51 3401.01,-4167.37 3394,-4157.17 3390.23,-4151.67 3390.04,-4147.53 3394,-4142.17 3401.18,-4132.44 3409.05,-4139.28 3420,-4134.17 3437.44,-4126.02 3455.39,-4115.32 3471.36,-4104.86"/>
<polygon fill="black" stroke="black" points="3473.64,-4107.54 3480.02,-4099.08 3469.76,-4101.72 3473.64,-4107.54"/>
</g>
<!-- l3_attn_stage10_gpu12&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge1917" class="edge">
<title>l3_attn_stage10_gpu12&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3580.99,-4182.55C3595.91,-4176.26 3612.24,-4170.5 3628,-4167.17 3650.18,-4162.48 4428.07,-4173.29 4444,-4157.17 4460.71,-4140.25 4451.21,-4112.8 4440.15,-4092.57"/>
<polygon fill="red" stroke="red" points="4443.11,-4090.7 4435.04,-4083.84 4437.07,-4094.24 4443.11,-4090.7"/>
<text text-anchor="middle" x="4482.5" y="-4145.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu13 -->
<g id="node846" class="node">
<title>l3_attn_stage11_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3732" cy="-4065.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3732" y="-4076.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="3732" y="-4061.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3732" y="-4046.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu13&#45;&gt;l3_attn_stage11_gpu13 -->
<g id="edge798" class="edge">
<title>l3_attn_stage10_gpu13&#45;&gt;l3_attn_stage11_gpu13</title>
<path fill="none" stroke="black" d="M3674.39,-4182.67C3659.62,-4176.46 3643.51,-4170.7 3628,-4167.17 3603.39,-4161.55 3418.45,-4175.41 3401,-4157.17 3396.39,-4152.35 3396.37,-4146.96 3401,-4142.17 3409.76,-4133.09 3615.97,-4137.96 3628,-4134.17 3647.58,-4127.99 3667,-4117.05 3683.67,-4105.75"/>
<polygon fill="black" stroke="black" points="3685.94,-4108.43 3692.13,-4099.83 3681.93,-4102.7 3685.94,-4108.43"/>
</g>
<!-- l3_attn_stage10_gpu13&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge1918" class="edge">
<title>l3_attn_stage10_gpu13&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3788.99,-4182.58C3803.92,-4176.28 3820.25,-4170.51 3836,-4167.17 3854.86,-4163.16 4516.47,-4170.9 4530,-4157.17 4555.62,-4131.18 4514.49,-4104.58 4476.04,-4087"/>
<polygon fill="red" stroke="red" points="4477.44,-4083.8 4466.88,-4082.96 4474.61,-4090.2 4477.44,-4083.8"/>
<text text-anchor="middle" x="4568.5" y="-4145.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu14 -->
<g id="node847" class="node">
<title>l3_attn_stage11_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3940" cy="-4065.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3940" y="-4076.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="3940" y="-4061.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3940" y="-4046.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu14&#45;&gt;l3_attn_stage11_gpu14 -->
<g id="edge799" class="edge">
<title>l3_attn_stage10_gpu14&#45;&gt;l3_attn_stage11_gpu14</title>
<path fill="none" stroke="black" d="M3882.71,-4182.56C3867.86,-4176.31 3851.64,-4170.56 3836,-4167.17 3812.76,-4162.12 3424.62,-4174.18 3408,-4157.17 3403.34,-4152.4 3403.33,-4146.92 3408,-4142.17 3416.33,-4133.68 3824.63,-4137.65 3836,-4134.17 3855.63,-4128.15 3875.07,-4117.25 3891.73,-4105.94"/>
<polygon fill="black" stroke="black" points="3894.01,-4108.62 3900.18,-4100.01 3889.99,-4102.89 3894.01,-4108.62"/>
</g>
<!-- l3_attn_stage10_gpu14&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge1919" class="edge">
<title>l3_attn_stage10_gpu14&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3997,-4182.61C4011.92,-4176.31 4028.25,-4170.54 4044,-4167.17 4059.54,-4163.84 4604.86,-4168.5 4616,-4157.17 4652.88,-4119.63 4589.24,-4095.87 4525.37,-4082.16"/>
<polygon fill="red" stroke="red" points="4526.05,-4078.73 4515.55,-4080.13 4524.63,-4085.59 4526.05,-4078.73"/>
<text text-anchor="middle" x="4655.5" y="-4145.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage11_gpu15 -->
<g id="node848" class="node">
<title>l3_attn_stage11_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4148" cy="-4065.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4148" y="-4076.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage11</text>
<text text-anchor="middle" x="4148" y="-4061.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4148" y="-4046.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage10_gpu15&#45;&gt;l3_attn_stage11_gpu15 -->
<g id="edge800" class="edge">
<title>l3_attn_stage10_gpu15&#45;&gt;l3_attn_stage11_gpu15</title>
<path fill="none" stroke="black" d="M4091,-4182.59C4076.08,-4176.3 4059.75,-4170.52 4044,-4167.17 4026.91,-4163.52 3427.26,-4169.62 3415,-4157.17 3410.32,-4152.41 3410.32,-4146.91 3415,-4142.17 3427.28,-4129.73 4027.28,-4139.23 4044,-4134.17 4063.65,-4128.21 4083.09,-4117.33 4099.75,-4106.01"/>
<polygon fill="black" stroke="black" points="4102.03,-4108.69 4108.2,-4100.07 4098.01,-4102.96 4102.03,-4108.69"/>
</g>
<!-- l3_attn_stage10_gpu15&#45;&gt;l3_attn_stage11_gpu[next_gpu] -->
<g id="edge1920" class="edge">
<title>l3_attn_stage10_gpu15&#45;&gt;l3_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4207.56,-4183.25C4223.88,-4176.73 4241.81,-4170.68 4259,-4167.17 4283.12,-4162.23 4684.79,-4174.77 4702,-4157.17 4751.67,-4106.36 4664.33,-4084.06 4574.57,-4074.27"/>
<polygon fill="red" stroke="red" points="4574.78,-4070.78 4564.47,-4073.22 4574.05,-4077.74 4574.78,-4070.78"/>
<text text-anchor="middle" x="4741.5" y="-4145.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu0 -->
<g id="node849" class="node">
<title>l3_attn_stage12_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1028" cy="-3918.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1028" y="-3929.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="1028" y="-3914.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1028" y="-3899.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu0&#45;&gt;l3_attn_stage12_gpu0 -->
<g id="edge801" class="edge">
<title>l3_attn_stage11_gpu0&#45;&gt;l3_attn_stage12_gpu0</title>
<path fill="none" stroke="black" d="M1028,-4028.08C1028,-4009.36 1028,-3986.37 1028,-3966.38"/>
<polygon fill="black" stroke="black" points="1031.5,-3966.24 1028,-3956.24 1024.5,-3966.24 1031.5,-3966.24"/>
</g>
<!-- l3_attn_stage12_gpu[next_gpu] -->
<g id="node1354" class="node">
<title>l3_attn_stage12_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4423" cy="-3918.67" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4423" y="-3914.97" font-family="Times,serif" font-size="14.00">l3_attn_stage12_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage11_gpu0&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge1921" class="edge">
<title>l3_attn_stage11_gpu0&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1084.98,-4035.54C1099.91,-4029.24 1116.24,-4023.48 1132,-4020.17 1381.97,-3967.51 3175.55,-3997.79 3431,-3995.17 3476.78,-3994.69 4210.1,-3996.08 4255,-3987.17 4300.32,-3978.17 4348.98,-3957.25 4382.21,-3941.07"/>
<polygon fill="red" stroke="red" points="4384.17,-3944 4391.58,-3936.43 4381.06,-3937.73 4384.17,-3944"/>
<text text-anchor="middle" x="3462.5" y="-3998.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu1 -->
<g id="node850" class="node">
<title>l3_attn_stage12_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1236" cy="-3918.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1236" y="-3929.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="1236" y="-3914.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1236" y="-3899.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu1&#45;&gt;l3_attn_stage12_gpu1 -->
<g id="edge802" class="edge">
<title>l3_attn_stage11_gpu1&#45;&gt;l3_attn_stage12_gpu1</title>
<path fill="none" stroke="black" d="M1236,-4028.08C1236,-4009.36 1236,-3986.37 1236,-3966.38"/>
<polygon fill="black" stroke="black" points="1239.5,-3966.24 1236,-3956.24 1232.5,-3966.24 1239.5,-3966.24"/>
</g>
<!-- l3_attn_stage11_gpu1&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge1922" class="edge">
<title>l3_attn_stage11_gpu1&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1292.97,-4035.47C1307.89,-4029.18 1324.23,-4023.44 1340,-4020.17 1398.7,-4007.99 3441.42,-4029.96 3498,-4010.17 3508.16,-4006.61 3506.86,-3998.75 3517,-3995.17 3555.66,-3981.51 4214.79,-3995.17 4255,-3987.17 4300.31,-3978.15 4348.98,-3957.23 4382.21,-3941.05"/>
<polygon fill="red" stroke="red" points="4384.17,-3943.99 4391.58,-3936.42 4381.06,-3937.72 4384.17,-3943.99"/>
<text text-anchor="middle" x="3548.5" y="-3998.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu2 -->
<g id="node851" class="node">
<title>l3_attn_stage12_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1444" cy="-3918.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1444" y="-3929.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="1444" y="-3914.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1444" y="-3899.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu2&#45;&gt;l3_attn_stage12_gpu2 -->
<g id="edge803" class="edge">
<title>l3_attn_stage11_gpu2&#45;&gt;l3_attn_stage12_gpu2</title>
<path fill="none" stroke="black" d="M1444,-4028.08C1444,-4009.36 1444,-3986.37 1444,-3966.38"/>
<polygon fill="black" stroke="black" points="1447.5,-3966.24 1444,-3956.24 1440.5,-3966.24 1447.5,-3966.24"/>
</g>
<!-- l3_attn_stage11_gpu2&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge1923" class="edge">
<title>l3_attn_stage11_gpu2&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1500.97,-4035.47C1515.89,-4029.18 1532.23,-4023.44 1548,-4020.17 1603.38,-4008.67 3530.62,-4028.85 3584,-4010.17 3594.16,-4006.61 3592.86,-3998.76 3603,-3995.17 3637.15,-3983.08 4219.48,-3994.26 4255,-3987.17 4300.31,-3978.12 4348.97,-3957.2 4382.2,-3941.04"/>
<polygon fill="red" stroke="red" points="4384.16,-3943.97 4391.57,-3936.4 4381.06,-3937.7 4384.16,-3943.97"/>
<text text-anchor="middle" x="3634.5" y="-3998.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu3 -->
<g id="node852" class="node">
<title>l3_attn_stage12_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1652" cy="-3918.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1652" y="-3929.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="1652" y="-3914.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1652" y="-3899.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu3&#45;&gt;l3_attn_stage12_gpu3 -->
<g id="edge804" class="edge">
<title>l3_attn_stage11_gpu3&#45;&gt;l3_attn_stage12_gpu3</title>
<path fill="none" stroke="black" d="M1652,-4028.08C1652,-4009.36 1652,-3986.37 1652,-3966.38"/>
<polygon fill="black" stroke="black" points="1655.5,-3966.24 1652,-3956.24 1648.5,-3966.24 1655.5,-3966.24"/>
</g>
<!-- l3_attn_stage11_gpu3&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge1924" class="edge">
<title>l3_attn_stage11_gpu3&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1708.97,-4035.48C1723.9,-4029.18 1740.23,-4023.44 1756,-4020.17 1808.06,-4009.35 3619.82,-4027.73 3670,-4010.17 3680.15,-4006.61 3678.86,-3998.77 3689,-3995.17 3718.63,-3984.64 4224.17,-3993.35 4255,-3987.17 4300.3,-3978.07 4348.97,-3957.17 4382.2,-3941.01"/>
<polygon fill="red" stroke="red" points="4384.15,-3943.95 4391.57,-3936.38 4381.05,-3937.68 4384.15,-3943.95"/>
<text text-anchor="middle" x="3720.5" y="-3998.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu4 -->
<g id="node853" class="node">
<title>l3_attn_stage12_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1860" cy="-3918.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1860" y="-3929.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="1860" y="-3914.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1860" y="-3899.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu4&#45;&gt;l3_attn_stage12_gpu4 -->
<g id="edge805" class="edge">
<title>l3_attn_stage11_gpu4&#45;&gt;l3_attn_stage12_gpu4</title>
<path fill="none" stroke="black" d="M1860,-4028.08C1860,-4009.36 1860,-3986.37 1860,-3966.38"/>
<polygon fill="black" stroke="black" points="1863.5,-3966.24 1860,-3956.24 1856.5,-3966.24 1863.5,-3966.24"/>
</g>
<!-- l3_attn_stage11_gpu4&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge1925" class="edge">
<title>l3_attn_stage11_gpu4&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1916.97,-4035.48C1931.9,-4029.19 1948.23,-4023.44 1964,-4020.17 2012.74,-4010.04 3709.02,-4026.62 3756,-4010.17 3766.15,-4006.61 3764.87,-3998.78 3775,-3995.17 3825.24,-3977.25 4202.72,-3997.73 4255,-3987.17 4300.29,-3978.02 4348.96,-3957.12 4382.19,-3940.98"/>
<polygon fill="red" stroke="red" points="4384.14,-3943.92 4391.56,-3936.36 4381.05,-3937.64 4384.14,-3943.92"/>
<text text-anchor="middle" x="3806.5" y="-3998.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu5 -->
<g id="node854" class="node">
<title>l3_attn_stage12_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2068" cy="-3918.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2068" y="-3929.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="2068" y="-3914.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2068" y="-3899.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu5&#45;&gt;l3_attn_stage12_gpu5 -->
<g id="edge806" class="edge">
<title>l3_attn_stage11_gpu5&#45;&gt;l3_attn_stage12_gpu5</title>
<path fill="none" stroke="black" d="M2068,-4028.08C2068,-4009.36 2068,-3986.37 2068,-3966.38"/>
<polygon fill="black" stroke="black" points="2071.5,-3966.24 2068,-3956.24 2064.5,-3966.24 2071.5,-3966.24"/>
</g>
<!-- l3_attn_stage11_gpu5&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge1926" class="edge">
<title>l3_attn_stage11_gpu5&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2124.97,-4035.48C2139.9,-4029.19 2156.23,-4023.45 2172,-4020.17 2217.42,-4010.72 3798.22,-4025.51 3842,-4010.17 3852.15,-4006.61 3850.87,-3998.8 3861,-3995.17 3902.22,-3980.39 4212.1,-3995.92 4255,-3987.17 4300.27,-3977.93 4348.94,-3957.05 4382.18,-3940.94"/>
<polygon fill="red" stroke="red" points="4384.13,-3943.88 4391.56,-3936.32 4381.04,-3937.6 4384.13,-3943.88"/>
<text text-anchor="middle" x="3892.5" y="-3998.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu6 -->
<g id="node855" class="node">
<title>l3_attn_stage12_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2276" cy="-3918.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2276" y="-3929.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="2276" y="-3914.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2276" y="-3899.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu6&#45;&gt;l3_attn_stage12_gpu6 -->
<g id="edge807" class="edge">
<title>l3_attn_stage11_gpu6&#45;&gt;l3_attn_stage12_gpu6</title>
<path fill="none" stroke="black" d="M2276,-4028.08C2276,-4009.36 2276,-3986.37 2276,-3966.38"/>
<polygon fill="black" stroke="black" points="2279.5,-3966.24 2276,-3956.24 2272.5,-3966.24 2279.5,-3966.24"/>
</g>
<!-- l3_attn_stage11_gpu6&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge1927" class="edge">
<title>l3_attn_stage11_gpu6&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2332.97,-4035.49C2347.9,-4029.2 2364.23,-4023.45 2380,-4020.17 2422.1,-4011.4 3887.42,-4024.4 3928,-4010.17 3938.15,-4006.6 3936.88,-3998.83 3947,-3995.17 3979.19,-3983.52 4221.48,-3994.1 4255,-3987.17 4300.11,-3977.83 4348.62,-3957.07 4381.86,-3941.02"/>
<polygon fill="red" stroke="red" points="4383.8,-3943.96 4391.24,-3936.42 4380.72,-3937.68 4383.8,-3943.96"/>
<text text-anchor="middle" x="3978.5" y="-3998.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu7 -->
<g id="node856" class="node">
<title>l3_attn_stage12_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2484" cy="-3918.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2484" y="-3929.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="2484" y="-3914.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2484" y="-3899.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu7&#45;&gt;l3_attn_stage12_gpu7 -->
<g id="edge808" class="edge">
<title>l3_attn_stage11_gpu7&#45;&gt;l3_attn_stage12_gpu7</title>
<path fill="none" stroke="black" d="M2484,-4028.08C2484,-4009.36 2484,-3986.37 2484,-3966.38"/>
<polygon fill="black" stroke="black" points="2487.5,-3966.24 2484,-3956.24 2480.5,-3966.24 2487.5,-3966.24"/>
</g>
<!-- l3_attn_stage11_gpu7&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge1928" class="edge">
<title>l3_attn_stage11_gpu7&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2540.98,-4035.5C2555.9,-4029.2 2572.24,-4023.45 2588,-4020.17 2626.78,-4012.08 3976.62,-4023.29 4014,-4010.17 4024.15,-4006.6 4022.9,-3998.88 4033,-3995.17 4079.34,-3978.14 4206.71,-3997.41 4255,-3987.17 4300.06,-3977.61 4348.58,-3956.88 4381.83,-3940.89"/>
<polygon fill="red" stroke="red" points="4383.76,-3943.85 4391.22,-3936.31 4380.69,-3937.55 4383.76,-3943.85"/>
<text text-anchor="middle" x="4064.5" y="-3998.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu8 -->
<g id="node857" class="node">
<title>l3_attn_stage12_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2692" cy="-3918.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2692" y="-3929.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="2692" y="-3914.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2692" y="-3899.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu8&#45;&gt;l3_attn_stage12_gpu8 -->
<g id="edge809" class="edge">
<title>l3_attn_stage11_gpu8&#45;&gt;l3_attn_stage12_gpu8</title>
<path fill="none" stroke="black" d="M2692,-4028.08C2692,-4009.36 2692,-3986.37 2692,-3966.38"/>
<polygon fill="black" stroke="black" points="2695.5,-3966.24 2692,-3956.24 2688.5,-3966.24 2695.5,-3966.24"/>
</g>
<!-- l3_attn_stage11_gpu8&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge1929" class="edge">
<title>l3_attn_stage11_gpu8&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2748.98,-4035.5C2763.9,-4029.21 2780.24,-4023.46 2796,-4020.17 2866.91,-4005.35 4031.65,-4034.19 4100,-4010.17 4110.15,-4006.6 4108.94,-3998.99 4119,-3995.17 4147.3,-3984.4 4225.46,-3993.78 4255,-3987.17 4299.67,-3977.16 4347.88,-3956.69 4381.15,-3940.91"/>
<polygon fill="red" stroke="red" points="4383.06,-3943.88 4390.55,-3936.38 4380.02,-3937.57 4383.06,-3943.88"/>
<text text-anchor="middle" x="4150.5" y="-3998.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu9 -->
<g id="node858" class="node">
<title>l3_attn_stage12_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2900" cy="-3918.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2900" y="-3929.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="2900" y="-3914.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2900" y="-3899.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu9&#45;&gt;l3_attn_stage12_gpu9 -->
<g id="edge810" class="edge">
<title>l3_attn_stage11_gpu9&#45;&gt;l3_attn_stage12_gpu9</title>
<path fill="none" stroke="black" d="M2900,-4028.08C2900,-4009.36 2900,-3986.37 2900,-3966.38"/>
<polygon fill="black" stroke="black" points="2903.5,-3966.24 2900,-3956.24 2896.5,-3966.24 2903.5,-3966.24"/>
</g>
<!-- l3_attn_stage11_gpu9&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge1930" class="edge">
<title>l3_attn_stage11_gpu9&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2956.98,-4035.51C2971.9,-4029.22 2988.24,-4023.47 3004,-4020.17 3068.28,-4006.71 4124.05,-4031.96 4186,-4010.17 4196.15,-4006.59 4195.15,-3999.49 4205,-3995.17 4225.61,-3986.12 4233.31,-3993.18 4255,-3987.17 4298.28,-3975.17 4345.59,-3955.54 4378.94,-3940.53"/>
<polygon fill="red" stroke="red" points="4380.74,-3943.55 4388.4,-3936.23 4377.84,-3937.18 4380.74,-3943.55"/>
<text text-anchor="middle" x="4236.5" y="-3998.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu10 -->
<g id="node859" class="node">
<title>l3_attn_stage12_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3108" cy="-3918.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3108" y="-3929.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="3108" y="-3914.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3108" y="-3899.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu10&#45;&gt;l3_attn_stage12_gpu10 -->
<g id="edge811" class="edge">
<title>l3_attn_stage11_gpu10&#45;&gt;l3_attn_stage12_gpu10</title>
<path fill="none" stroke="black" d="M3108,-4028.08C3108,-4009.36 3108,-3986.37 3108,-3966.38"/>
<polygon fill="black" stroke="black" points="3111.5,-3966.24 3108,-3956.24 3104.5,-3966.24 3111.5,-3966.24"/>
</g>
<!-- l3_attn_stage11_gpu10&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge1931" class="edge">
<title>l3_attn_stage11_gpu10&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3164.98,-4035.52C3179.91,-4029.23 3196.24,-4023.47 3212,-4020.17 3269.64,-4008.07 4216.46,-4029.74 4272,-4010.17 4282.15,-4006.59 4282.08,-4001.19 4291,-3995.17 4320.36,-3975.34 4355.2,-3955.56 4381.72,-3941.22"/>
<polygon fill="red" stroke="red" points="4383.57,-3944.19 4390.73,-3936.38 4380.26,-3938.03 4383.57,-3944.19"/>
<text text-anchor="middle" x="4322.5" y="-3998.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu11 -->
<g id="node860" class="node">
<title>l3_attn_stage12_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3316" cy="-3918.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3316" y="-3929.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="3316" y="-3914.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3316" y="-3899.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu11&#45;&gt;l3_attn_stage12_gpu11 -->
<g id="edge812" class="edge">
<title>l3_attn_stage11_gpu11&#45;&gt;l3_attn_stage12_gpu11</title>
<path fill="none" stroke="black" d="M3316,-4028.08C3316,-4009.36 3316,-3986.37 3316,-3966.38"/>
<polygon fill="black" stroke="black" points="3319.5,-3966.24 3316,-3956.24 3312.5,-3966.24 3319.5,-3966.24"/>
</g>
<!-- l3_attn_stage11_gpu11&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge1932" class="edge">
<title>l3_attn_stage11_gpu11&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3372.98,-4035.54C3387.91,-4029.24 3404.24,-4023.48 3420,-4020.17 3445.5,-4014.8 4334.88,-4022.18 4358,-4010.17 4371.7,-4003.05 4393.58,-3969.63 4408.12,-3945.47"/>
<polygon fill="red" stroke="red" points="4411.21,-3947.12 4413.3,-3936.74 4405.19,-3943.55 4411.21,-3947.12"/>
<text text-anchor="middle" x="4404.5" y="-3998.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu12 -->
<g id="node861" class="node">
<title>l3_attn_stage12_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3524" cy="-3918.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3524" y="-3929.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="3524" y="-3914.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3524" y="-3899.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu12&#45;&gt;l3_attn_stage12_gpu12 -->
<g id="edge813" class="edge">
<title>l3_attn_stage11_gpu12&#45;&gt;l3_attn_stage12_gpu12</title>
<path fill="none" stroke="black" d="M3461.19,-4037.34C3447.64,-4031.58 3433.37,-4025.6 3420,-4020.17 3408.53,-4015.51 3401.01,-4020.37 3394,-4010.17 3390.23,-4004.67 3390.04,-4000.53 3394,-3995.17 3401.18,-3985.44 3409.05,-3992.28 3420,-3987.17 3437.44,-3979.02 3455.39,-3968.32 3471.36,-3957.86"/>
<polygon fill="black" stroke="black" points="3473.64,-3960.54 3480.02,-3952.08 3469.76,-3954.72 3473.64,-3960.54"/>
</g>
<!-- l3_attn_stage11_gpu12&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge1933" class="edge">
<title>l3_attn_stage11_gpu12&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3580.99,-4035.55C3595.91,-4029.26 3612.24,-4023.5 3628,-4020.17 3650.18,-4015.48 4428.07,-4026.29 4444,-4010.17 4460.71,-3993.25 4451.21,-3965.8 4440.15,-3945.57"/>
<polygon fill="red" stroke="red" points="4443.11,-3943.7 4435.04,-3936.84 4437.07,-3947.24 4443.11,-3943.7"/>
<text text-anchor="middle" x="4482.5" y="-3998.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu13 -->
<g id="node862" class="node">
<title>l3_attn_stage12_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3732" cy="-3918.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3732" y="-3929.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="3732" y="-3914.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3732" y="-3899.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu13&#45;&gt;l3_attn_stage12_gpu13 -->
<g id="edge814" class="edge">
<title>l3_attn_stage11_gpu13&#45;&gt;l3_attn_stage12_gpu13</title>
<path fill="none" stroke="black" d="M3674.39,-4035.67C3659.62,-4029.46 3643.51,-4023.7 3628,-4020.17 3603.39,-4014.55 3418.45,-4028.41 3401,-4010.17 3396.39,-4005.35 3396.37,-3999.96 3401,-3995.17 3409.76,-3986.09 3615.97,-3990.96 3628,-3987.17 3647.58,-3980.99 3667,-3970.05 3683.67,-3958.75"/>
<polygon fill="black" stroke="black" points="3685.94,-3961.43 3692.13,-3952.83 3681.93,-3955.7 3685.94,-3961.43"/>
</g>
<!-- l3_attn_stage11_gpu13&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge1934" class="edge">
<title>l3_attn_stage11_gpu13&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3788.99,-4035.58C3803.92,-4029.28 3820.25,-4023.51 3836,-4020.17 3854.86,-4016.16 4516.47,-4023.9 4530,-4010.17 4555.62,-3984.18 4514.49,-3957.58 4476.04,-3940"/>
<polygon fill="red" stroke="red" points="4477.44,-3936.8 4466.88,-3935.96 4474.61,-3943.2 4477.44,-3936.8"/>
<text text-anchor="middle" x="4568.5" y="-3998.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu14 -->
<g id="node863" class="node">
<title>l3_attn_stage12_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3940" cy="-3918.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3940" y="-3929.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="3940" y="-3914.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3940" y="-3899.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu14&#45;&gt;l3_attn_stage12_gpu14 -->
<g id="edge815" class="edge">
<title>l3_attn_stage11_gpu14&#45;&gt;l3_attn_stage12_gpu14</title>
<path fill="none" stroke="black" d="M3882.71,-4035.56C3867.86,-4029.31 3851.64,-4023.56 3836,-4020.17 3812.76,-4015.12 3424.62,-4027.18 3408,-4010.17 3403.34,-4005.4 3403.33,-3999.92 3408,-3995.17 3416.33,-3986.68 3824.63,-3990.65 3836,-3987.17 3855.63,-3981.15 3875.07,-3970.25 3891.73,-3958.94"/>
<polygon fill="black" stroke="black" points="3894.01,-3961.62 3900.18,-3953.01 3889.99,-3955.89 3894.01,-3961.62"/>
</g>
<!-- l3_attn_stage11_gpu14&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge1935" class="edge">
<title>l3_attn_stage11_gpu14&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3997,-4035.61C4011.92,-4029.31 4028.25,-4023.54 4044,-4020.17 4059.54,-4016.84 4604.86,-4021.5 4616,-4010.17 4652.88,-3972.63 4589.24,-3948.87 4525.37,-3935.16"/>
<polygon fill="red" stroke="red" points="4526.05,-3931.73 4515.55,-3933.13 4524.63,-3938.59 4526.05,-3931.73"/>
<text text-anchor="middle" x="4655.5" y="-3998.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage12_gpu15 -->
<g id="node864" class="node">
<title>l3_attn_stage12_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4148" cy="-3918.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4148" y="-3929.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage12</text>
<text text-anchor="middle" x="4148" y="-3914.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4148" y="-3899.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage11_gpu15&#45;&gt;l3_attn_stage12_gpu15 -->
<g id="edge816" class="edge">
<title>l3_attn_stage11_gpu15&#45;&gt;l3_attn_stage12_gpu15</title>
<path fill="none" stroke="black" d="M4091,-4035.59C4076.08,-4029.3 4059.75,-4023.52 4044,-4020.17 4026.91,-4016.52 3427.26,-4022.62 3415,-4010.17 3410.32,-4005.41 3410.32,-3999.91 3415,-3995.17 3427.28,-3982.73 4027.28,-3992.23 4044,-3987.17 4063.65,-3981.21 4083.09,-3970.33 4099.75,-3959.01"/>
<polygon fill="black" stroke="black" points="4102.03,-3961.69 4108.2,-3953.07 4098.01,-3955.96 4102.03,-3961.69"/>
</g>
<!-- l3_attn_stage11_gpu15&#45;&gt;l3_attn_stage12_gpu[next_gpu] -->
<g id="edge1936" class="edge">
<title>l3_attn_stage11_gpu15&#45;&gt;l3_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4207.56,-4036.25C4223.88,-4029.73 4241.81,-4023.68 4259,-4020.17 4283.12,-4015.23 4684.79,-4027.77 4702,-4010.17 4751.67,-3959.36 4664.33,-3937.06 4574.57,-3927.27"/>
<polygon fill="red" stroke="red" points="4574.78,-3923.78 4564.47,-3926.22 4574.05,-3930.74 4574.78,-3923.78"/>
<text text-anchor="middle" x="4741.5" y="-3998.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu0 -->
<g id="node865" class="node">
<title>l3_attn_stage13_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1028" cy="-3771.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1028" y="-3782.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="1028" y="-3767.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1028" y="-3752.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu0&#45;&gt;l3_attn_stage13_gpu0 -->
<g id="edge817" class="edge">
<title>l3_attn_stage12_gpu0&#45;&gt;l3_attn_stage13_gpu0</title>
<path fill="none" stroke="black" d="M1028,-3881.08C1028,-3862.36 1028,-3839.37 1028,-3819.38"/>
<polygon fill="black" stroke="black" points="1031.5,-3819.24 1028,-3809.24 1024.5,-3819.24 1031.5,-3819.24"/>
</g>
<!-- l3_attn_stage13_gpu[next_gpu] -->
<g id="node1355" class="node">
<title>l3_attn_stage13_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4423" cy="-3771.67" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4423" y="-3767.97" font-family="Times,serif" font-size="14.00">l3_attn_stage13_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage12_gpu0&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge1937" class="edge">
<title>l3_attn_stage12_gpu0&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1084.98,-3888.54C1099.91,-3882.24 1116.24,-3876.48 1132,-3873.17 1381.97,-3820.51 3175.55,-3850.79 3431,-3848.17 3476.78,-3847.69 4210.1,-3849.08 4255,-3840.17 4300.32,-3831.17 4348.98,-3810.25 4382.21,-3794.07"/>
<polygon fill="red" stroke="red" points="4384.17,-3797 4391.58,-3789.43 4381.06,-3790.73 4384.17,-3797"/>
<text text-anchor="middle" x="3462.5" y="-3851.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu1 -->
<g id="node866" class="node">
<title>l3_attn_stage13_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1236" cy="-3771.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1236" y="-3782.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="1236" y="-3767.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1236" y="-3752.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu1&#45;&gt;l3_attn_stage13_gpu1 -->
<g id="edge818" class="edge">
<title>l3_attn_stage12_gpu1&#45;&gt;l3_attn_stage13_gpu1</title>
<path fill="none" stroke="black" d="M1236,-3881.08C1236,-3862.36 1236,-3839.37 1236,-3819.38"/>
<polygon fill="black" stroke="black" points="1239.5,-3819.24 1236,-3809.24 1232.5,-3819.24 1239.5,-3819.24"/>
</g>
<!-- l3_attn_stage12_gpu1&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge1938" class="edge">
<title>l3_attn_stage12_gpu1&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1292.97,-3888.47C1307.89,-3882.18 1324.23,-3876.44 1340,-3873.17 1398.7,-3860.99 3441.42,-3882.96 3498,-3863.17 3508.16,-3859.61 3506.86,-3851.75 3517,-3848.17 3555.66,-3834.51 4214.79,-3848.17 4255,-3840.17 4300.31,-3831.15 4348.98,-3810.23 4382.21,-3794.05"/>
<polygon fill="red" stroke="red" points="4384.17,-3796.99 4391.58,-3789.42 4381.06,-3790.72 4384.17,-3796.99"/>
<text text-anchor="middle" x="3548.5" y="-3851.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu2 -->
<g id="node867" class="node">
<title>l3_attn_stage13_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1444" cy="-3771.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1444" y="-3782.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="1444" y="-3767.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1444" y="-3752.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu2&#45;&gt;l3_attn_stage13_gpu2 -->
<g id="edge819" class="edge">
<title>l3_attn_stage12_gpu2&#45;&gt;l3_attn_stage13_gpu2</title>
<path fill="none" stroke="black" d="M1444,-3881.08C1444,-3862.36 1444,-3839.37 1444,-3819.38"/>
<polygon fill="black" stroke="black" points="1447.5,-3819.24 1444,-3809.24 1440.5,-3819.24 1447.5,-3819.24"/>
</g>
<!-- l3_attn_stage12_gpu2&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge1939" class="edge">
<title>l3_attn_stage12_gpu2&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1500.97,-3888.47C1515.89,-3882.18 1532.23,-3876.44 1548,-3873.17 1603.38,-3861.67 3530.62,-3881.85 3584,-3863.17 3594.16,-3859.61 3592.86,-3851.76 3603,-3848.17 3637.15,-3836.08 4219.48,-3847.26 4255,-3840.17 4300.31,-3831.12 4348.97,-3810.2 4382.2,-3794.04"/>
<polygon fill="red" stroke="red" points="4384.16,-3796.97 4391.57,-3789.4 4381.06,-3790.7 4384.16,-3796.97"/>
<text text-anchor="middle" x="3634.5" y="-3851.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu3 -->
<g id="node868" class="node">
<title>l3_attn_stage13_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1652" cy="-3771.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1652" y="-3782.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="1652" y="-3767.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1652" y="-3752.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu3&#45;&gt;l3_attn_stage13_gpu3 -->
<g id="edge820" class="edge">
<title>l3_attn_stage12_gpu3&#45;&gt;l3_attn_stage13_gpu3</title>
<path fill="none" stroke="black" d="M1652,-3881.08C1652,-3862.36 1652,-3839.37 1652,-3819.38"/>
<polygon fill="black" stroke="black" points="1655.5,-3819.24 1652,-3809.24 1648.5,-3819.24 1655.5,-3819.24"/>
</g>
<!-- l3_attn_stage12_gpu3&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge1940" class="edge">
<title>l3_attn_stage12_gpu3&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1708.97,-3888.48C1723.9,-3882.18 1740.23,-3876.44 1756,-3873.17 1808.06,-3862.35 3619.82,-3880.73 3670,-3863.17 3680.15,-3859.61 3678.86,-3851.77 3689,-3848.17 3718.63,-3837.64 4224.17,-3846.35 4255,-3840.17 4300.3,-3831.07 4348.97,-3810.17 4382.2,-3794.01"/>
<polygon fill="red" stroke="red" points="4384.15,-3796.95 4391.57,-3789.38 4381.05,-3790.68 4384.15,-3796.95"/>
<text text-anchor="middle" x="3720.5" y="-3851.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu4 -->
<g id="node869" class="node">
<title>l3_attn_stage13_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1860" cy="-3771.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1860" y="-3782.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="1860" y="-3767.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1860" y="-3752.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu4&#45;&gt;l3_attn_stage13_gpu4 -->
<g id="edge821" class="edge">
<title>l3_attn_stage12_gpu4&#45;&gt;l3_attn_stage13_gpu4</title>
<path fill="none" stroke="black" d="M1860,-3881.08C1860,-3862.36 1860,-3839.37 1860,-3819.38"/>
<polygon fill="black" stroke="black" points="1863.5,-3819.24 1860,-3809.24 1856.5,-3819.24 1863.5,-3819.24"/>
</g>
<!-- l3_attn_stage12_gpu4&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge1941" class="edge">
<title>l3_attn_stage12_gpu4&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1916.97,-3888.48C1931.9,-3882.19 1948.23,-3876.44 1964,-3873.17 2012.74,-3863.04 3709.02,-3879.62 3756,-3863.17 3766.15,-3859.61 3764.87,-3851.78 3775,-3848.17 3825.24,-3830.25 4202.72,-3850.73 4255,-3840.17 4300.29,-3831.02 4348.96,-3810.12 4382.19,-3793.98"/>
<polygon fill="red" stroke="red" points="4384.14,-3796.92 4391.56,-3789.36 4381.05,-3790.64 4384.14,-3796.92"/>
<text text-anchor="middle" x="3806.5" y="-3851.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu5 -->
<g id="node870" class="node">
<title>l3_attn_stage13_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2068" cy="-3771.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2068" y="-3782.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="2068" y="-3767.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2068" y="-3752.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu5&#45;&gt;l3_attn_stage13_gpu5 -->
<g id="edge822" class="edge">
<title>l3_attn_stage12_gpu5&#45;&gt;l3_attn_stage13_gpu5</title>
<path fill="none" stroke="black" d="M2068,-3881.08C2068,-3862.36 2068,-3839.37 2068,-3819.38"/>
<polygon fill="black" stroke="black" points="2071.5,-3819.24 2068,-3809.24 2064.5,-3819.24 2071.5,-3819.24"/>
</g>
<!-- l3_attn_stage12_gpu5&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge1942" class="edge">
<title>l3_attn_stage12_gpu5&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2124.97,-3888.48C2139.9,-3882.19 2156.23,-3876.45 2172,-3873.17 2217.42,-3863.72 3798.22,-3878.51 3842,-3863.17 3852.15,-3859.61 3850.87,-3851.8 3861,-3848.17 3902.22,-3833.39 4212.1,-3848.92 4255,-3840.17 4300.27,-3830.93 4348.94,-3810.05 4382.18,-3793.94"/>
<polygon fill="red" stroke="red" points="4384.13,-3796.88 4391.56,-3789.32 4381.04,-3790.6 4384.13,-3796.88"/>
<text text-anchor="middle" x="3892.5" y="-3851.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu6 -->
<g id="node871" class="node">
<title>l3_attn_stage13_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2276" cy="-3771.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2276" y="-3782.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="2276" y="-3767.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2276" y="-3752.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu6&#45;&gt;l3_attn_stage13_gpu6 -->
<g id="edge823" class="edge">
<title>l3_attn_stage12_gpu6&#45;&gt;l3_attn_stage13_gpu6</title>
<path fill="none" stroke="black" d="M2276,-3881.08C2276,-3862.36 2276,-3839.37 2276,-3819.38"/>
<polygon fill="black" stroke="black" points="2279.5,-3819.24 2276,-3809.24 2272.5,-3819.24 2279.5,-3819.24"/>
</g>
<!-- l3_attn_stage12_gpu6&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge1943" class="edge">
<title>l3_attn_stage12_gpu6&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2332.97,-3888.49C2347.9,-3882.2 2364.23,-3876.45 2380,-3873.17 2422.1,-3864.4 3887.42,-3877.4 3928,-3863.17 3938.15,-3859.6 3936.88,-3851.83 3947,-3848.17 3979.19,-3836.52 4221.48,-3847.1 4255,-3840.17 4300.11,-3830.83 4348.62,-3810.07 4381.86,-3794.02"/>
<polygon fill="red" stroke="red" points="4383.8,-3796.96 4391.24,-3789.42 4380.72,-3790.68 4383.8,-3796.96"/>
<text text-anchor="middle" x="3978.5" y="-3851.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu7 -->
<g id="node872" class="node">
<title>l3_attn_stage13_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2484" cy="-3771.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2484" y="-3782.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="2484" y="-3767.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2484" y="-3752.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu7&#45;&gt;l3_attn_stage13_gpu7 -->
<g id="edge824" class="edge">
<title>l3_attn_stage12_gpu7&#45;&gt;l3_attn_stage13_gpu7</title>
<path fill="none" stroke="black" d="M2484,-3881.08C2484,-3862.36 2484,-3839.37 2484,-3819.38"/>
<polygon fill="black" stroke="black" points="2487.5,-3819.24 2484,-3809.24 2480.5,-3819.24 2487.5,-3819.24"/>
</g>
<!-- l3_attn_stage12_gpu7&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge1944" class="edge">
<title>l3_attn_stage12_gpu7&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2540.98,-3888.5C2555.9,-3882.2 2572.24,-3876.45 2588,-3873.17 2626.78,-3865.08 3976.62,-3876.29 4014,-3863.17 4024.15,-3859.6 4022.9,-3851.88 4033,-3848.17 4079.34,-3831.14 4206.71,-3850.41 4255,-3840.17 4300.06,-3830.61 4348.58,-3809.88 4381.83,-3793.89"/>
<polygon fill="red" stroke="red" points="4383.76,-3796.85 4391.22,-3789.31 4380.69,-3790.55 4383.76,-3796.85"/>
<text text-anchor="middle" x="4064.5" y="-3851.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu8 -->
<g id="node873" class="node">
<title>l3_attn_stage13_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2692" cy="-3771.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2692" y="-3782.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="2692" y="-3767.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2692" y="-3752.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu8&#45;&gt;l3_attn_stage13_gpu8 -->
<g id="edge825" class="edge">
<title>l3_attn_stage12_gpu8&#45;&gt;l3_attn_stage13_gpu8</title>
<path fill="none" stroke="black" d="M2692,-3881.08C2692,-3862.36 2692,-3839.37 2692,-3819.38"/>
<polygon fill="black" stroke="black" points="2695.5,-3819.24 2692,-3809.24 2688.5,-3819.24 2695.5,-3819.24"/>
</g>
<!-- l3_attn_stage12_gpu8&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge1945" class="edge">
<title>l3_attn_stage12_gpu8&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2748.98,-3888.5C2763.9,-3882.21 2780.24,-3876.46 2796,-3873.17 2866.91,-3858.35 4031.65,-3887.19 4100,-3863.17 4110.15,-3859.6 4108.94,-3851.99 4119,-3848.17 4147.3,-3837.4 4225.46,-3846.78 4255,-3840.17 4299.67,-3830.16 4347.88,-3809.69 4381.15,-3793.91"/>
<polygon fill="red" stroke="red" points="4383.06,-3796.88 4390.55,-3789.38 4380.02,-3790.57 4383.06,-3796.88"/>
<text text-anchor="middle" x="4150.5" y="-3851.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu9 -->
<g id="node874" class="node">
<title>l3_attn_stage13_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2900" cy="-3771.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2900" y="-3782.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="2900" y="-3767.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2900" y="-3752.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu9&#45;&gt;l3_attn_stage13_gpu9 -->
<g id="edge826" class="edge">
<title>l3_attn_stage12_gpu9&#45;&gt;l3_attn_stage13_gpu9</title>
<path fill="none" stroke="black" d="M2900,-3881.08C2900,-3862.36 2900,-3839.37 2900,-3819.38"/>
<polygon fill="black" stroke="black" points="2903.5,-3819.24 2900,-3809.24 2896.5,-3819.24 2903.5,-3819.24"/>
</g>
<!-- l3_attn_stage12_gpu9&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge1946" class="edge">
<title>l3_attn_stage12_gpu9&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2956.98,-3888.51C2971.9,-3882.22 2988.24,-3876.47 3004,-3873.17 3068.28,-3859.71 4124.05,-3884.96 4186,-3863.17 4196.15,-3859.59 4195.15,-3852.49 4205,-3848.17 4225.61,-3839.12 4233.31,-3846.18 4255,-3840.17 4298.28,-3828.17 4345.59,-3808.54 4378.94,-3793.53"/>
<polygon fill="red" stroke="red" points="4380.74,-3796.55 4388.4,-3789.23 4377.84,-3790.18 4380.74,-3796.55"/>
<text text-anchor="middle" x="4236.5" y="-3851.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu10 -->
<g id="node875" class="node">
<title>l3_attn_stage13_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3108" cy="-3771.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3108" y="-3782.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="3108" y="-3767.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3108" y="-3752.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu10&#45;&gt;l3_attn_stage13_gpu10 -->
<g id="edge827" class="edge">
<title>l3_attn_stage12_gpu10&#45;&gt;l3_attn_stage13_gpu10</title>
<path fill="none" stroke="black" d="M3108,-3881.08C3108,-3862.36 3108,-3839.37 3108,-3819.38"/>
<polygon fill="black" stroke="black" points="3111.5,-3819.24 3108,-3809.24 3104.5,-3819.24 3111.5,-3819.24"/>
</g>
<!-- l3_attn_stage12_gpu10&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge1947" class="edge">
<title>l3_attn_stage12_gpu10&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3164.98,-3888.52C3179.91,-3882.23 3196.24,-3876.47 3212,-3873.17 3269.64,-3861.07 4216.46,-3882.74 4272,-3863.17 4282.15,-3859.59 4282.08,-3854.19 4291,-3848.17 4320.36,-3828.34 4355.2,-3808.56 4381.72,-3794.22"/>
<polygon fill="red" stroke="red" points="4383.57,-3797.19 4390.73,-3789.38 4380.26,-3791.03 4383.57,-3797.19"/>
<text text-anchor="middle" x="4322.5" y="-3851.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu11 -->
<g id="node876" class="node">
<title>l3_attn_stage13_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3316" cy="-3771.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3316" y="-3782.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="3316" y="-3767.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3316" y="-3752.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu11&#45;&gt;l3_attn_stage13_gpu11 -->
<g id="edge828" class="edge">
<title>l3_attn_stage12_gpu11&#45;&gt;l3_attn_stage13_gpu11</title>
<path fill="none" stroke="black" d="M3316,-3881.08C3316,-3862.36 3316,-3839.37 3316,-3819.38"/>
<polygon fill="black" stroke="black" points="3319.5,-3819.24 3316,-3809.24 3312.5,-3819.24 3319.5,-3819.24"/>
</g>
<!-- l3_attn_stage12_gpu11&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge1948" class="edge">
<title>l3_attn_stage12_gpu11&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3372.98,-3888.54C3387.91,-3882.24 3404.24,-3876.48 3420,-3873.17 3445.5,-3867.8 4334.88,-3875.18 4358,-3863.17 4371.7,-3856.05 4393.58,-3822.63 4408.12,-3798.47"/>
<polygon fill="red" stroke="red" points="4411.21,-3800.12 4413.3,-3789.74 4405.19,-3796.55 4411.21,-3800.12"/>
<text text-anchor="middle" x="4404.5" y="-3851.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu12 -->
<g id="node877" class="node">
<title>l3_attn_stage13_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3524" cy="-3771.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3524" y="-3782.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="3524" y="-3767.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3524" y="-3752.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu12&#45;&gt;l3_attn_stage13_gpu12 -->
<g id="edge829" class="edge">
<title>l3_attn_stage12_gpu12&#45;&gt;l3_attn_stage13_gpu12</title>
<path fill="none" stroke="black" d="M3461.19,-3890.34C3447.64,-3884.58 3433.37,-3878.6 3420,-3873.17 3408.53,-3868.51 3401.01,-3873.37 3394,-3863.17 3390.23,-3857.67 3390.04,-3853.53 3394,-3848.17 3401.18,-3838.44 3409.05,-3845.28 3420,-3840.17 3437.44,-3832.02 3455.39,-3821.32 3471.36,-3810.86"/>
<polygon fill="black" stroke="black" points="3473.64,-3813.54 3480.02,-3805.08 3469.76,-3807.72 3473.64,-3813.54"/>
</g>
<!-- l3_attn_stage12_gpu12&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge1949" class="edge">
<title>l3_attn_stage12_gpu12&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3580.99,-3888.55C3595.91,-3882.26 3612.24,-3876.5 3628,-3873.17 3650.18,-3868.48 4428.07,-3879.29 4444,-3863.17 4460.71,-3846.25 4451.21,-3818.8 4440.15,-3798.57"/>
<polygon fill="red" stroke="red" points="4443.11,-3796.7 4435.04,-3789.84 4437.07,-3800.24 4443.11,-3796.7"/>
<text text-anchor="middle" x="4482.5" y="-3851.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu13 -->
<g id="node878" class="node">
<title>l3_attn_stage13_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3732" cy="-3771.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3732" y="-3782.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="3732" y="-3767.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3732" y="-3752.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu13&#45;&gt;l3_attn_stage13_gpu13 -->
<g id="edge830" class="edge">
<title>l3_attn_stage12_gpu13&#45;&gt;l3_attn_stage13_gpu13</title>
<path fill="none" stroke="black" d="M3674.39,-3888.67C3659.62,-3882.46 3643.51,-3876.7 3628,-3873.17 3603.39,-3867.55 3418.45,-3881.41 3401,-3863.17 3396.39,-3858.35 3396.37,-3852.96 3401,-3848.17 3409.76,-3839.09 3615.97,-3843.96 3628,-3840.17 3647.58,-3833.99 3667,-3823.05 3683.67,-3811.75"/>
<polygon fill="black" stroke="black" points="3685.94,-3814.43 3692.13,-3805.83 3681.93,-3808.7 3685.94,-3814.43"/>
</g>
<!-- l3_attn_stage12_gpu13&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge1950" class="edge">
<title>l3_attn_stage12_gpu13&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3788.99,-3888.58C3803.92,-3882.28 3820.25,-3876.51 3836,-3873.17 3854.86,-3869.16 4516.47,-3876.9 4530,-3863.17 4555.62,-3837.18 4514.49,-3810.58 4476.04,-3793"/>
<polygon fill="red" stroke="red" points="4477.44,-3789.8 4466.88,-3788.96 4474.61,-3796.2 4477.44,-3789.8"/>
<text text-anchor="middle" x="4568.5" y="-3851.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu14 -->
<g id="node879" class="node">
<title>l3_attn_stage13_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3940" cy="-3771.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3940" y="-3782.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="3940" y="-3767.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3940" y="-3752.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu14&#45;&gt;l3_attn_stage13_gpu14 -->
<g id="edge831" class="edge">
<title>l3_attn_stage12_gpu14&#45;&gt;l3_attn_stage13_gpu14</title>
<path fill="none" stroke="black" d="M3882.71,-3888.56C3867.86,-3882.31 3851.64,-3876.56 3836,-3873.17 3812.76,-3868.12 3424.62,-3880.18 3408,-3863.17 3403.34,-3858.4 3403.33,-3852.92 3408,-3848.17 3416.33,-3839.68 3824.63,-3843.65 3836,-3840.17 3855.63,-3834.15 3875.07,-3823.25 3891.73,-3811.94"/>
<polygon fill="black" stroke="black" points="3894.01,-3814.62 3900.18,-3806.01 3889.99,-3808.89 3894.01,-3814.62"/>
</g>
<!-- l3_attn_stage12_gpu14&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge1951" class="edge">
<title>l3_attn_stage12_gpu14&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3997,-3888.61C4011.92,-3882.31 4028.25,-3876.54 4044,-3873.17 4059.54,-3869.84 4604.86,-3874.5 4616,-3863.17 4652.88,-3825.63 4589.24,-3801.87 4525.37,-3788.16"/>
<polygon fill="red" stroke="red" points="4526.05,-3784.73 4515.55,-3786.13 4524.63,-3791.59 4526.05,-3784.73"/>
<text text-anchor="middle" x="4655.5" y="-3851.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage13_gpu15 -->
<g id="node880" class="node">
<title>l3_attn_stage13_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4148" cy="-3771.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4148" y="-3782.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage13</text>
<text text-anchor="middle" x="4148" y="-3767.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4148" y="-3752.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage12_gpu15&#45;&gt;l3_attn_stage13_gpu15 -->
<g id="edge832" class="edge">
<title>l3_attn_stage12_gpu15&#45;&gt;l3_attn_stage13_gpu15</title>
<path fill="none" stroke="black" d="M4091,-3888.59C4076.08,-3882.3 4059.75,-3876.52 4044,-3873.17 4026.91,-3869.52 3427.26,-3875.62 3415,-3863.17 3410.32,-3858.41 3410.32,-3852.91 3415,-3848.17 3427.28,-3835.73 4027.28,-3845.23 4044,-3840.17 4063.65,-3834.21 4083.09,-3823.33 4099.75,-3812.01"/>
<polygon fill="black" stroke="black" points="4102.03,-3814.69 4108.2,-3806.07 4098.01,-3808.96 4102.03,-3814.69"/>
</g>
<!-- l3_attn_stage12_gpu15&#45;&gt;l3_attn_stage13_gpu[next_gpu] -->
<g id="edge1952" class="edge">
<title>l3_attn_stage12_gpu15&#45;&gt;l3_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4207.56,-3889.25C4223.88,-3882.73 4241.81,-3876.68 4259,-3873.17 4283.12,-3868.23 4684.79,-3880.77 4702,-3863.17 4751.67,-3812.36 4664.33,-3790.06 4574.57,-3780.27"/>
<polygon fill="red" stroke="red" points="4574.78,-3776.78 4564.47,-3779.22 4574.05,-3783.74 4574.78,-3776.78"/>
<text text-anchor="middle" x="4741.5" y="-3851.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu0 -->
<g id="node881" class="node">
<title>l3_attn_stage14_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1028" cy="-3624.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1028" y="-3635.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="1028" y="-3620.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1028" y="-3605.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu0&#45;&gt;l3_attn_stage14_gpu0 -->
<g id="edge833" class="edge">
<title>l3_attn_stage13_gpu0&#45;&gt;l3_attn_stage14_gpu0</title>
<path fill="none" stroke="black" d="M1028,-3734.08C1028,-3715.36 1028,-3692.37 1028,-3672.38"/>
<polygon fill="black" stroke="black" points="1031.5,-3672.24 1028,-3662.24 1024.5,-3672.24 1031.5,-3672.24"/>
</g>
<!-- l3_attn_stage14_gpu[next_gpu] -->
<g id="node1356" class="node">
<title>l3_attn_stage14_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4423" cy="-3624.67" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4423" y="-3620.97" font-family="Times,serif" font-size="14.00">l3_attn_stage14_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage13_gpu0&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge1953" class="edge">
<title>l3_attn_stage13_gpu0&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1084.98,-3741.54C1099.91,-3735.24 1116.24,-3729.48 1132,-3726.17 1381.97,-3673.51 3175.55,-3703.79 3431,-3701.17 3476.78,-3700.69 4210.1,-3702.08 4255,-3693.17 4300.32,-3684.17 4348.98,-3663.25 4382.21,-3647.07"/>
<polygon fill="red" stroke="red" points="4384.17,-3650 4391.58,-3642.43 4381.06,-3643.73 4384.17,-3650"/>
<text text-anchor="middle" x="3462.5" y="-3704.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu1 -->
<g id="node882" class="node">
<title>l3_attn_stage14_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1236" cy="-3624.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1236" y="-3635.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="1236" y="-3620.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1236" y="-3605.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu1&#45;&gt;l3_attn_stage14_gpu1 -->
<g id="edge834" class="edge">
<title>l3_attn_stage13_gpu1&#45;&gt;l3_attn_stage14_gpu1</title>
<path fill="none" stroke="black" d="M1236,-3734.08C1236,-3715.36 1236,-3692.37 1236,-3672.38"/>
<polygon fill="black" stroke="black" points="1239.5,-3672.24 1236,-3662.24 1232.5,-3672.24 1239.5,-3672.24"/>
</g>
<!-- l3_attn_stage13_gpu1&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge1954" class="edge">
<title>l3_attn_stage13_gpu1&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1292.97,-3741.47C1307.89,-3735.18 1324.23,-3729.44 1340,-3726.17 1398.7,-3713.99 3441.42,-3735.96 3498,-3716.17 3508.16,-3712.61 3506.86,-3704.75 3517,-3701.17 3555.66,-3687.51 4214.79,-3701.17 4255,-3693.17 4300.31,-3684.15 4348.98,-3663.23 4382.21,-3647.05"/>
<polygon fill="red" stroke="red" points="4384.17,-3649.99 4391.58,-3642.42 4381.06,-3643.72 4384.17,-3649.99"/>
<text text-anchor="middle" x="3548.5" y="-3704.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu2 -->
<g id="node883" class="node">
<title>l3_attn_stage14_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1444" cy="-3624.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1444" y="-3635.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="1444" y="-3620.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1444" y="-3605.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu2&#45;&gt;l3_attn_stage14_gpu2 -->
<g id="edge835" class="edge">
<title>l3_attn_stage13_gpu2&#45;&gt;l3_attn_stage14_gpu2</title>
<path fill="none" stroke="black" d="M1444,-3734.08C1444,-3715.36 1444,-3692.37 1444,-3672.38"/>
<polygon fill="black" stroke="black" points="1447.5,-3672.24 1444,-3662.24 1440.5,-3672.24 1447.5,-3672.24"/>
</g>
<!-- l3_attn_stage13_gpu2&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge1955" class="edge">
<title>l3_attn_stage13_gpu2&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1500.97,-3741.47C1515.89,-3735.18 1532.23,-3729.44 1548,-3726.17 1603.38,-3714.67 3530.62,-3734.85 3584,-3716.17 3594.16,-3712.61 3592.86,-3704.76 3603,-3701.17 3637.15,-3689.08 4219.48,-3700.26 4255,-3693.17 4300.31,-3684.12 4348.97,-3663.2 4382.2,-3647.04"/>
<polygon fill="red" stroke="red" points="4384.16,-3649.97 4391.57,-3642.4 4381.06,-3643.7 4384.16,-3649.97"/>
<text text-anchor="middle" x="3634.5" y="-3704.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu3 -->
<g id="node884" class="node">
<title>l3_attn_stage14_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1652" cy="-3624.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1652" y="-3635.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="1652" y="-3620.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1652" y="-3605.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu3&#45;&gt;l3_attn_stage14_gpu3 -->
<g id="edge836" class="edge">
<title>l3_attn_stage13_gpu3&#45;&gt;l3_attn_stage14_gpu3</title>
<path fill="none" stroke="black" d="M1652,-3734.08C1652,-3715.36 1652,-3692.37 1652,-3672.38"/>
<polygon fill="black" stroke="black" points="1655.5,-3672.24 1652,-3662.24 1648.5,-3672.24 1655.5,-3672.24"/>
</g>
<!-- l3_attn_stage13_gpu3&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge1956" class="edge">
<title>l3_attn_stage13_gpu3&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1708.97,-3741.48C1723.9,-3735.18 1740.23,-3729.44 1756,-3726.17 1808.06,-3715.35 3619.82,-3733.73 3670,-3716.17 3680.15,-3712.61 3678.86,-3704.77 3689,-3701.17 3718.63,-3690.64 4224.17,-3699.35 4255,-3693.17 4300.3,-3684.07 4348.97,-3663.17 4382.2,-3647.01"/>
<polygon fill="red" stroke="red" points="4384.15,-3649.95 4391.57,-3642.38 4381.05,-3643.68 4384.15,-3649.95"/>
<text text-anchor="middle" x="3720.5" y="-3704.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu4 -->
<g id="node885" class="node">
<title>l3_attn_stage14_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1860" cy="-3624.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1860" y="-3635.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="1860" y="-3620.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1860" y="-3605.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu4&#45;&gt;l3_attn_stage14_gpu4 -->
<g id="edge837" class="edge">
<title>l3_attn_stage13_gpu4&#45;&gt;l3_attn_stage14_gpu4</title>
<path fill="none" stroke="black" d="M1860,-3734.08C1860,-3715.36 1860,-3692.37 1860,-3672.38"/>
<polygon fill="black" stroke="black" points="1863.5,-3672.24 1860,-3662.24 1856.5,-3672.24 1863.5,-3672.24"/>
</g>
<!-- l3_attn_stage13_gpu4&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge1957" class="edge">
<title>l3_attn_stage13_gpu4&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1916.97,-3741.48C1931.9,-3735.19 1948.23,-3729.44 1964,-3726.17 2012.74,-3716.04 3709.02,-3732.62 3756,-3716.17 3766.15,-3712.61 3764.87,-3704.78 3775,-3701.17 3825.24,-3683.25 4202.72,-3703.73 4255,-3693.17 4300.29,-3684.02 4348.96,-3663.12 4382.19,-3646.98"/>
<polygon fill="red" stroke="red" points="4384.14,-3649.92 4391.56,-3642.36 4381.05,-3643.64 4384.14,-3649.92"/>
<text text-anchor="middle" x="3806.5" y="-3704.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu5 -->
<g id="node886" class="node">
<title>l3_attn_stage14_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2068" cy="-3624.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2068" y="-3635.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="2068" y="-3620.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2068" y="-3605.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu5&#45;&gt;l3_attn_stage14_gpu5 -->
<g id="edge838" class="edge">
<title>l3_attn_stage13_gpu5&#45;&gt;l3_attn_stage14_gpu5</title>
<path fill="none" stroke="black" d="M2068,-3734.08C2068,-3715.36 2068,-3692.37 2068,-3672.38"/>
<polygon fill="black" stroke="black" points="2071.5,-3672.24 2068,-3662.24 2064.5,-3672.24 2071.5,-3672.24"/>
</g>
<!-- l3_attn_stage13_gpu5&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge1958" class="edge">
<title>l3_attn_stage13_gpu5&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2124.97,-3741.48C2139.9,-3735.19 2156.23,-3729.45 2172,-3726.17 2217.42,-3716.72 3798.22,-3731.51 3842,-3716.17 3852.15,-3712.61 3850.87,-3704.8 3861,-3701.17 3902.22,-3686.39 4212.1,-3701.92 4255,-3693.17 4300.27,-3683.93 4348.94,-3663.05 4382.18,-3646.94"/>
<polygon fill="red" stroke="red" points="4384.13,-3649.88 4391.56,-3642.32 4381.04,-3643.6 4384.13,-3649.88"/>
<text text-anchor="middle" x="3892.5" y="-3704.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu6 -->
<g id="node887" class="node">
<title>l3_attn_stage14_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2276" cy="-3624.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2276" y="-3635.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="2276" y="-3620.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2276" y="-3605.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu6&#45;&gt;l3_attn_stage14_gpu6 -->
<g id="edge839" class="edge">
<title>l3_attn_stage13_gpu6&#45;&gt;l3_attn_stage14_gpu6</title>
<path fill="none" stroke="black" d="M2276,-3734.08C2276,-3715.36 2276,-3692.37 2276,-3672.38"/>
<polygon fill="black" stroke="black" points="2279.5,-3672.24 2276,-3662.24 2272.5,-3672.24 2279.5,-3672.24"/>
</g>
<!-- l3_attn_stage13_gpu6&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge1959" class="edge">
<title>l3_attn_stage13_gpu6&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2332.97,-3741.49C2347.9,-3735.2 2364.23,-3729.45 2380,-3726.17 2422.1,-3717.4 3887.42,-3730.4 3928,-3716.17 3938.15,-3712.6 3936.88,-3704.83 3947,-3701.17 3979.19,-3689.52 4221.48,-3700.1 4255,-3693.17 4300.11,-3683.83 4348.62,-3663.07 4381.86,-3647.02"/>
<polygon fill="red" stroke="red" points="4383.8,-3649.96 4391.24,-3642.42 4380.72,-3643.68 4383.8,-3649.96"/>
<text text-anchor="middle" x="3978.5" y="-3704.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu7 -->
<g id="node888" class="node">
<title>l3_attn_stage14_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2484" cy="-3624.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2484" y="-3635.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="2484" y="-3620.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2484" y="-3605.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu7&#45;&gt;l3_attn_stage14_gpu7 -->
<g id="edge840" class="edge">
<title>l3_attn_stage13_gpu7&#45;&gt;l3_attn_stage14_gpu7</title>
<path fill="none" stroke="black" d="M2484,-3734.08C2484,-3715.36 2484,-3692.37 2484,-3672.38"/>
<polygon fill="black" stroke="black" points="2487.5,-3672.24 2484,-3662.24 2480.5,-3672.24 2487.5,-3672.24"/>
</g>
<!-- l3_attn_stage13_gpu7&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge1960" class="edge">
<title>l3_attn_stage13_gpu7&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2540.98,-3741.5C2555.9,-3735.2 2572.24,-3729.45 2588,-3726.17 2626.78,-3718.08 3976.62,-3729.29 4014,-3716.17 4024.15,-3712.6 4022.9,-3704.88 4033,-3701.17 4079.34,-3684.14 4206.71,-3703.41 4255,-3693.17 4300.06,-3683.61 4348.58,-3662.88 4381.83,-3646.89"/>
<polygon fill="red" stroke="red" points="4383.76,-3649.85 4391.22,-3642.31 4380.69,-3643.55 4383.76,-3649.85"/>
<text text-anchor="middle" x="4064.5" y="-3704.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu8 -->
<g id="node889" class="node">
<title>l3_attn_stage14_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2692" cy="-3624.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2692" y="-3635.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="2692" y="-3620.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2692" y="-3605.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu8&#45;&gt;l3_attn_stage14_gpu8 -->
<g id="edge841" class="edge">
<title>l3_attn_stage13_gpu8&#45;&gt;l3_attn_stage14_gpu8</title>
<path fill="none" stroke="black" d="M2692,-3734.08C2692,-3715.36 2692,-3692.37 2692,-3672.38"/>
<polygon fill="black" stroke="black" points="2695.5,-3672.24 2692,-3662.24 2688.5,-3672.24 2695.5,-3672.24"/>
</g>
<!-- l3_attn_stage13_gpu8&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge1961" class="edge">
<title>l3_attn_stage13_gpu8&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2748.98,-3741.5C2763.9,-3735.21 2780.24,-3729.46 2796,-3726.17 2866.91,-3711.35 4031.65,-3740.19 4100,-3716.17 4110.15,-3712.6 4108.94,-3704.99 4119,-3701.17 4147.3,-3690.4 4225.46,-3699.78 4255,-3693.17 4299.67,-3683.16 4347.88,-3662.69 4381.15,-3646.91"/>
<polygon fill="red" stroke="red" points="4383.06,-3649.88 4390.55,-3642.38 4380.02,-3643.57 4383.06,-3649.88"/>
<text text-anchor="middle" x="4150.5" y="-3704.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu9 -->
<g id="node890" class="node">
<title>l3_attn_stage14_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2900" cy="-3624.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2900" y="-3635.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="2900" y="-3620.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2900" y="-3605.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu9&#45;&gt;l3_attn_stage14_gpu9 -->
<g id="edge842" class="edge">
<title>l3_attn_stage13_gpu9&#45;&gt;l3_attn_stage14_gpu9</title>
<path fill="none" stroke="black" d="M2900,-3734.08C2900,-3715.36 2900,-3692.37 2900,-3672.38"/>
<polygon fill="black" stroke="black" points="2903.5,-3672.24 2900,-3662.24 2896.5,-3672.24 2903.5,-3672.24"/>
</g>
<!-- l3_attn_stage13_gpu9&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge1962" class="edge">
<title>l3_attn_stage13_gpu9&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2956.98,-3741.51C2971.9,-3735.22 2988.24,-3729.47 3004,-3726.17 3068.28,-3712.71 4124.05,-3737.96 4186,-3716.17 4196.15,-3712.59 4195.15,-3705.49 4205,-3701.17 4225.61,-3692.12 4233.31,-3699.18 4255,-3693.17 4298.28,-3681.17 4345.59,-3661.54 4378.94,-3646.53"/>
<polygon fill="red" stroke="red" points="4380.74,-3649.55 4388.4,-3642.23 4377.84,-3643.18 4380.74,-3649.55"/>
<text text-anchor="middle" x="4236.5" y="-3704.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu10 -->
<g id="node891" class="node">
<title>l3_attn_stage14_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3108" cy="-3624.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3108" y="-3635.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="3108" y="-3620.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3108" y="-3605.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu10&#45;&gt;l3_attn_stage14_gpu10 -->
<g id="edge843" class="edge">
<title>l3_attn_stage13_gpu10&#45;&gt;l3_attn_stage14_gpu10</title>
<path fill="none" stroke="black" d="M3108,-3734.08C3108,-3715.36 3108,-3692.37 3108,-3672.38"/>
<polygon fill="black" stroke="black" points="3111.5,-3672.24 3108,-3662.24 3104.5,-3672.24 3111.5,-3672.24"/>
</g>
<!-- l3_attn_stage13_gpu10&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge1963" class="edge">
<title>l3_attn_stage13_gpu10&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3164.98,-3741.52C3179.91,-3735.23 3196.24,-3729.47 3212,-3726.17 3269.64,-3714.07 4216.46,-3735.74 4272,-3716.17 4282.15,-3712.59 4282.08,-3707.19 4291,-3701.17 4320.36,-3681.34 4355.2,-3661.56 4381.72,-3647.22"/>
<polygon fill="red" stroke="red" points="4383.57,-3650.19 4390.73,-3642.38 4380.26,-3644.03 4383.57,-3650.19"/>
<text text-anchor="middle" x="4322.5" y="-3704.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu11 -->
<g id="node892" class="node">
<title>l3_attn_stage14_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3316" cy="-3624.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3316" y="-3635.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="3316" y="-3620.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3316" y="-3605.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu11&#45;&gt;l3_attn_stage14_gpu11 -->
<g id="edge844" class="edge">
<title>l3_attn_stage13_gpu11&#45;&gt;l3_attn_stage14_gpu11</title>
<path fill="none" stroke="black" d="M3316,-3734.08C3316,-3715.36 3316,-3692.37 3316,-3672.38"/>
<polygon fill="black" stroke="black" points="3319.5,-3672.24 3316,-3662.24 3312.5,-3672.24 3319.5,-3672.24"/>
</g>
<!-- l3_attn_stage13_gpu11&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge1964" class="edge">
<title>l3_attn_stage13_gpu11&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3372.98,-3741.54C3387.91,-3735.24 3404.24,-3729.48 3420,-3726.17 3445.5,-3720.8 4334.88,-3728.18 4358,-3716.17 4371.7,-3709.05 4393.58,-3675.63 4408.12,-3651.47"/>
<polygon fill="red" stroke="red" points="4411.21,-3653.12 4413.3,-3642.74 4405.19,-3649.55 4411.21,-3653.12"/>
<text text-anchor="middle" x="4404.5" y="-3704.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu12 -->
<g id="node893" class="node">
<title>l3_attn_stage14_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3524" cy="-3624.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3524" y="-3635.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="3524" y="-3620.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3524" y="-3605.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu12&#45;&gt;l3_attn_stage14_gpu12 -->
<g id="edge845" class="edge">
<title>l3_attn_stage13_gpu12&#45;&gt;l3_attn_stage14_gpu12</title>
<path fill="none" stroke="black" d="M3461.19,-3743.34C3447.64,-3737.58 3433.37,-3731.6 3420,-3726.17 3408.53,-3721.51 3401.01,-3726.37 3394,-3716.17 3390.23,-3710.67 3390.04,-3706.53 3394,-3701.17 3401.18,-3691.44 3409.05,-3698.28 3420,-3693.17 3437.44,-3685.02 3455.39,-3674.32 3471.36,-3663.86"/>
<polygon fill="black" stroke="black" points="3473.64,-3666.54 3480.02,-3658.08 3469.76,-3660.72 3473.64,-3666.54"/>
</g>
<!-- l3_attn_stage13_gpu12&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge1965" class="edge">
<title>l3_attn_stage13_gpu12&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3580.99,-3741.55C3595.91,-3735.26 3612.24,-3729.5 3628,-3726.17 3650.18,-3721.48 4428.07,-3732.29 4444,-3716.17 4460.71,-3699.25 4451.21,-3671.8 4440.15,-3651.57"/>
<polygon fill="red" stroke="red" points="4443.11,-3649.7 4435.04,-3642.84 4437.07,-3653.24 4443.11,-3649.7"/>
<text text-anchor="middle" x="4482.5" y="-3704.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu13 -->
<g id="node894" class="node">
<title>l3_attn_stage14_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3732" cy="-3624.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3732" y="-3635.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="3732" y="-3620.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3732" y="-3605.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu13&#45;&gt;l3_attn_stage14_gpu13 -->
<g id="edge846" class="edge">
<title>l3_attn_stage13_gpu13&#45;&gt;l3_attn_stage14_gpu13</title>
<path fill="none" stroke="black" d="M3674.39,-3741.67C3659.62,-3735.46 3643.51,-3729.7 3628,-3726.17 3603.39,-3720.55 3418.45,-3734.41 3401,-3716.17 3396.39,-3711.35 3396.37,-3705.96 3401,-3701.17 3409.76,-3692.09 3615.97,-3696.96 3628,-3693.17 3647.58,-3686.99 3667,-3676.05 3683.67,-3664.75"/>
<polygon fill="black" stroke="black" points="3685.94,-3667.43 3692.13,-3658.83 3681.93,-3661.7 3685.94,-3667.43"/>
</g>
<!-- l3_attn_stage13_gpu13&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge1966" class="edge">
<title>l3_attn_stage13_gpu13&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3788.99,-3741.58C3803.92,-3735.28 3820.25,-3729.51 3836,-3726.17 3854.86,-3722.16 4516.47,-3729.9 4530,-3716.17 4555.62,-3690.18 4514.49,-3663.58 4476.04,-3646"/>
<polygon fill="red" stroke="red" points="4477.44,-3642.8 4466.88,-3641.96 4474.61,-3649.2 4477.44,-3642.8"/>
<text text-anchor="middle" x="4568.5" y="-3704.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu14 -->
<g id="node895" class="node">
<title>l3_attn_stage14_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3940" cy="-3624.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3940" y="-3635.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="3940" y="-3620.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3940" y="-3605.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu14&#45;&gt;l3_attn_stage14_gpu14 -->
<g id="edge847" class="edge">
<title>l3_attn_stage13_gpu14&#45;&gt;l3_attn_stage14_gpu14</title>
<path fill="none" stroke="black" d="M3882.71,-3741.56C3867.86,-3735.31 3851.64,-3729.56 3836,-3726.17 3812.76,-3721.12 3424.62,-3733.18 3408,-3716.17 3403.34,-3711.4 3403.33,-3705.92 3408,-3701.17 3416.33,-3692.68 3824.63,-3696.65 3836,-3693.17 3855.63,-3687.15 3875.07,-3676.25 3891.73,-3664.94"/>
<polygon fill="black" stroke="black" points="3894.01,-3667.62 3900.18,-3659.01 3889.99,-3661.89 3894.01,-3667.62"/>
</g>
<!-- l3_attn_stage13_gpu14&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge1967" class="edge">
<title>l3_attn_stage13_gpu14&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3997,-3741.61C4011.92,-3735.31 4028.25,-3729.54 4044,-3726.17 4059.54,-3722.84 4604.86,-3727.5 4616,-3716.17 4652.88,-3678.63 4589.24,-3654.87 4525.37,-3641.16"/>
<polygon fill="red" stroke="red" points="4526.05,-3637.73 4515.55,-3639.13 4524.63,-3644.59 4526.05,-3637.73"/>
<text text-anchor="middle" x="4655.5" y="-3704.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage14_gpu15 -->
<g id="node896" class="node">
<title>l3_attn_stage14_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4148" cy="-3624.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4148" y="-3635.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage14</text>
<text text-anchor="middle" x="4148" y="-3620.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4148" y="-3605.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage13_gpu15&#45;&gt;l3_attn_stage14_gpu15 -->
<g id="edge848" class="edge">
<title>l3_attn_stage13_gpu15&#45;&gt;l3_attn_stage14_gpu15</title>
<path fill="none" stroke="black" d="M4091,-3741.59C4076.08,-3735.3 4059.75,-3729.52 4044,-3726.17 4026.91,-3722.52 3427.26,-3728.62 3415,-3716.17 3410.32,-3711.41 3410.32,-3705.91 3415,-3701.17 3427.28,-3688.73 4027.28,-3698.23 4044,-3693.17 4063.65,-3687.21 4083.09,-3676.33 4099.75,-3665.01"/>
<polygon fill="black" stroke="black" points="4102.03,-3667.69 4108.2,-3659.07 4098.01,-3661.96 4102.03,-3667.69"/>
</g>
<!-- l3_attn_stage13_gpu15&#45;&gt;l3_attn_stage14_gpu[next_gpu] -->
<g id="edge1968" class="edge">
<title>l3_attn_stage13_gpu15&#45;&gt;l3_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4207.56,-3742.25C4223.88,-3735.73 4241.81,-3729.68 4259,-3726.17 4283.12,-3721.23 4684.79,-3733.77 4702,-3716.17 4751.67,-3665.36 4664.33,-3643.06 4574.57,-3633.27"/>
<polygon fill="red" stroke="red" points="4574.78,-3629.78 4564.47,-3632.22 4574.05,-3636.74 4574.78,-3629.78"/>
<text text-anchor="middle" x="4741.5" y="-3704.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu0 -->
<g id="node897" class="node">
<title>l3_attn_stage15_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1028" cy="-3477.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1028" y="-3488.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="1028" y="-3473.97" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1028" y="-3458.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu0&#45;&gt;l3_attn_stage15_gpu0 -->
<g id="edge849" class="edge">
<title>l3_attn_stage14_gpu0&#45;&gt;l3_attn_stage15_gpu0</title>
<path fill="none" stroke="black" d="M1028,-3587.08C1028,-3568.36 1028,-3545.37 1028,-3525.38"/>
<polygon fill="black" stroke="black" points="1031.5,-3525.24 1028,-3515.24 1024.5,-3525.24 1031.5,-3525.24"/>
</g>
<!-- l3_attn_stage15_gpu[next_gpu] -->
<g id="node1357" class="node">
<title>l3_attn_stage15_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4423" cy="-3477.67" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4423" y="-3473.97" font-family="Times,serif" font-size="14.00">l3_attn_stage15_gpu[next_gpu]</text>
</g>
<!-- l3_attn_stage14_gpu0&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge1969" class="edge">
<title>l3_attn_stage14_gpu0&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1084.98,-3594.54C1099.91,-3588.24 1116.24,-3582.48 1132,-3579.17 1381.97,-3526.51 3175.55,-3556.79 3431,-3554.17 3476.78,-3553.69 4210.1,-3555.08 4255,-3546.17 4300.32,-3537.17 4348.98,-3516.25 4382.21,-3500.07"/>
<polygon fill="red" stroke="red" points="4384.17,-3503 4391.58,-3495.43 4381.06,-3496.73 4384.17,-3503"/>
<text text-anchor="middle" x="3462.5" y="-3557.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu1 -->
<g id="node898" class="node">
<title>l3_attn_stage15_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1236" cy="-3477.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1236" y="-3488.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="1236" y="-3473.97" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1236" y="-3458.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu1&#45;&gt;l3_attn_stage15_gpu1 -->
<g id="edge850" class="edge">
<title>l3_attn_stage14_gpu1&#45;&gt;l3_attn_stage15_gpu1</title>
<path fill="none" stroke="black" d="M1236,-3587.08C1236,-3568.36 1236,-3545.37 1236,-3525.38"/>
<polygon fill="black" stroke="black" points="1239.5,-3525.24 1236,-3515.24 1232.5,-3525.24 1239.5,-3525.24"/>
</g>
<!-- l3_attn_stage14_gpu1&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge1970" class="edge">
<title>l3_attn_stage14_gpu1&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1292.97,-3594.47C1307.89,-3588.18 1324.23,-3582.44 1340,-3579.17 1398.7,-3566.99 3441.42,-3588.96 3498,-3569.17 3508.16,-3565.61 3506.86,-3557.75 3517,-3554.17 3555.66,-3540.51 4214.79,-3554.17 4255,-3546.17 4300.31,-3537.15 4348.98,-3516.23 4382.21,-3500.05"/>
<polygon fill="red" stroke="red" points="4384.17,-3502.99 4391.58,-3495.42 4381.06,-3496.72 4384.17,-3502.99"/>
<text text-anchor="middle" x="3548.5" y="-3557.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu2 -->
<g id="node899" class="node">
<title>l3_attn_stage15_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1444" cy="-3477.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1444" y="-3488.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="1444" y="-3473.97" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1444" y="-3458.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu2&#45;&gt;l3_attn_stage15_gpu2 -->
<g id="edge851" class="edge">
<title>l3_attn_stage14_gpu2&#45;&gt;l3_attn_stage15_gpu2</title>
<path fill="none" stroke="black" d="M1444,-3587.08C1444,-3568.36 1444,-3545.37 1444,-3525.38"/>
<polygon fill="black" stroke="black" points="1447.5,-3525.24 1444,-3515.24 1440.5,-3525.24 1447.5,-3525.24"/>
</g>
<!-- l3_attn_stage14_gpu2&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge1971" class="edge">
<title>l3_attn_stage14_gpu2&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1500.97,-3594.47C1515.89,-3588.18 1532.23,-3582.44 1548,-3579.17 1603.38,-3567.67 3530.62,-3587.85 3584,-3569.17 3594.16,-3565.61 3592.86,-3557.76 3603,-3554.17 3637.15,-3542.08 4219.48,-3553.26 4255,-3546.17 4300.31,-3537.12 4348.97,-3516.2 4382.2,-3500.04"/>
<polygon fill="red" stroke="red" points="4384.16,-3502.97 4391.57,-3495.4 4381.06,-3496.7 4384.16,-3502.97"/>
<text text-anchor="middle" x="3634.5" y="-3557.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu3 -->
<g id="node900" class="node">
<title>l3_attn_stage15_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1652" cy="-3477.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1652" y="-3488.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="1652" y="-3473.97" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1652" y="-3458.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu3&#45;&gt;l3_attn_stage15_gpu3 -->
<g id="edge852" class="edge">
<title>l3_attn_stage14_gpu3&#45;&gt;l3_attn_stage15_gpu3</title>
<path fill="none" stroke="black" d="M1652,-3587.08C1652,-3568.36 1652,-3545.37 1652,-3525.38"/>
<polygon fill="black" stroke="black" points="1655.5,-3525.24 1652,-3515.24 1648.5,-3525.24 1655.5,-3525.24"/>
</g>
<!-- l3_attn_stage14_gpu3&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge1972" class="edge">
<title>l3_attn_stage14_gpu3&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1708.97,-3594.48C1723.9,-3588.18 1740.23,-3582.44 1756,-3579.17 1808.06,-3568.35 3619.82,-3586.73 3670,-3569.17 3680.15,-3565.61 3678.86,-3557.77 3689,-3554.17 3718.63,-3543.64 4224.17,-3552.35 4255,-3546.17 4300.3,-3537.07 4348.97,-3516.17 4382.2,-3500.01"/>
<polygon fill="red" stroke="red" points="4384.15,-3502.95 4391.57,-3495.38 4381.05,-3496.68 4384.15,-3502.95"/>
<text text-anchor="middle" x="3720.5" y="-3557.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu4 -->
<g id="node901" class="node">
<title>l3_attn_stage15_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1860" cy="-3477.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1860" y="-3488.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="1860" y="-3473.97" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1860" y="-3458.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu4&#45;&gt;l3_attn_stage15_gpu4 -->
<g id="edge853" class="edge">
<title>l3_attn_stage14_gpu4&#45;&gt;l3_attn_stage15_gpu4</title>
<path fill="none" stroke="black" d="M1860,-3587.08C1860,-3568.36 1860,-3545.37 1860,-3525.38"/>
<polygon fill="black" stroke="black" points="1863.5,-3525.24 1860,-3515.24 1856.5,-3525.24 1863.5,-3525.24"/>
</g>
<!-- l3_attn_stage14_gpu4&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge1973" class="edge">
<title>l3_attn_stage14_gpu4&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1916.97,-3594.48C1931.9,-3588.19 1948.23,-3582.44 1964,-3579.17 2012.74,-3569.04 3709.02,-3585.62 3756,-3569.17 3766.15,-3565.61 3764.87,-3557.78 3775,-3554.17 3825.24,-3536.25 4202.72,-3556.73 4255,-3546.17 4300.29,-3537.02 4348.96,-3516.12 4382.19,-3499.98"/>
<polygon fill="red" stroke="red" points="4384.14,-3502.92 4391.56,-3495.36 4381.05,-3496.64 4384.14,-3502.92"/>
<text text-anchor="middle" x="3806.5" y="-3557.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu5 -->
<g id="node902" class="node">
<title>l3_attn_stage15_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2068" cy="-3477.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2068" y="-3488.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="2068" y="-3473.97" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2068" y="-3458.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu5&#45;&gt;l3_attn_stage15_gpu5 -->
<g id="edge854" class="edge">
<title>l3_attn_stage14_gpu5&#45;&gt;l3_attn_stage15_gpu5</title>
<path fill="none" stroke="black" d="M2068,-3587.08C2068,-3568.36 2068,-3545.37 2068,-3525.38"/>
<polygon fill="black" stroke="black" points="2071.5,-3525.24 2068,-3515.24 2064.5,-3525.24 2071.5,-3525.24"/>
</g>
<!-- l3_attn_stage14_gpu5&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge1974" class="edge">
<title>l3_attn_stage14_gpu5&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2124.97,-3594.48C2139.9,-3588.19 2156.23,-3582.45 2172,-3579.17 2217.42,-3569.72 3798.22,-3584.51 3842,-3569.17 3852.15,-3565.61 3850.87,-3557.8 3861,-3554.17 3902.22,-3539.39 4212.1,-3554.92 4255,-3546.17 4300.27,-3536.93 4348.94,-3516.05 4382.18,-3499.94"/>
<polygon fill="red" stroke="red" points="4384.13,-3502.88 4391.56,-3495.32 4381.04,-3496.6 4384.13,-3502.88"/>
<text text-anchor="middle" x="3892.5" y="-3557.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu6 -->
<g id="node903" class="node">
<title>l3_attn_stage15_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2276" cy="-3477.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2276" y="-3488.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="2276" y="-3473.97" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2276" y="-3458.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu6&#45;&gt;l3_attn_stage15_gpu6 -->
<g id="edge855" class="edge">
<title>l3_attn_stage14_gpu6&#45;&gt;l3_attn_stage15_gpu6</title>
<path fill="none" stroke="black" d="M2276,-3587.08C2276,-3568.36 2276,-3545.37 2276,-3525.38"/>
<polygon fill="black" stroke="black" points="2279.5,-3525.24 2276,-3515.24 2272.5,-3525.24 2279.5,-3525.24"/>
</g>
<!-- l3_attn_stage14_gpu6&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge1975" class="edge">
<title>l3_attn_stage14_gpu6&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2332.97,-3594.49C2347.9,-3588.2 2364.23,-3582.45 2380,-3579.17 2422.1,-3570.4 3887.42,-3583.4 3928,-3569.17 3938.15,-3565.6 3936.88,-3557.83 3947,-3554.17 3979.19,-3542.52 4221.48,-3553.1 4255,-3546.17 4300.11,-3536.83 4348.62,-3516.07 4381.86,-3500.02"/>
<polygon fill="red" stroke="red" points="4383.8,-3502.96 4391.24,-3495.42 4380.72,-3496.68 4383.8,-3502.96"/>
<text text-anchor="middle" x="3978.5" y="-3557.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu7 -->
<g id="node904" class="node">
<title>l3_attn_stage15_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2484" cy="-3477.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2484" y="-3488.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="2484" y="-3473.97" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2484" y="-3458.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu7&#45;&gt;l3_attn_stage15_gpu7 -->
<g id="edge856" class="edge">
<title>l3_attn_stage14_gpu7&#45;&gt;l3_attn_stage15_gpu7</title>
<path fill="none" stroke="black" d="M2484,-3587.08C2484,-3568.36 2484,-3545.37 2484,-3525.38"/>
<polygon fill="black" stroke="black" points="2487.5,-3525.24 2484,-3515.24 2480.5,-3525.24 2487.5,-3525.24"/>
</g>
<!-- l3_attn_stage14_gpu7&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge1976" class="edge">
<title>l3_attn_stage14_gpu7&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2540.98,-3594.5C2555.9,-3588.2 2572.24,-3582.45 2588,-3579.17 2626.78,-3571.08 3976.62,-3582.29 4014,-3569.17 4024.15,-3565.6 4022.9,-3557.88 4033,-3554.17 4079.34,-3537.14 4206.71,-3556.41 4255,-3546.17 4300.06,-3536.61 4348.58,-3515.88 4381.83,-3499.89"/>
<polygon fill="red" stroke="red" points="4383.76,-3502.85 4391.22,-3495.31 4380.69,-3496.55 4383.76,-3502.85"/>
<text text-anchor="middle" x="4064.5" y="-3557.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu8 -->
<g id="node905" class="node">
<title>l3_attn_stage15_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2692" cy="-3477.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2692" y="-3488.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="2692" y="-3473.97" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2692" y="-3458.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu8&#45;&gt;l3_attn_stage15_gpu8 -->
<g id="edge857" class="edge">
<title>l3_attn_stage14_gpu8&#45;&gt;l3_attn_stage15_gpu8</title>
<path fill="none" stroke="black" d="M2692,-3587.08C2692,-3568.36 2692,-3545.37 2692,-3525.38"/>
<polygon fill="black" stroke="black" points="2695.5,-3525.24 2692,-3515.24 2688.5,-3525.24 2695.5,-3525.24"/>
</g>
<!-- l3_attn_stage14_gpu8&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge1977" class="edge">
<title>l3_attn_stage14_gpu8&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2748.98,-3594.5C2763.9,-3588.21 2780.24,-3582.46 2796,-3579.17 2866.91,-3564.35 4031.65,-3593.19 4100,-3569.17 4110.15,-3565.6 4108.94,-3557.99 4119,-3554.17 4147.3,-3543.4 4225.46,-3552.78 4255,-3546.17 4299.67,-3536.16 4347.88,-3515.69 4381.15,-3499.91"/>
<polygon fill="red" stroke="red" points="4383.06,-3502.88 4390.55,-3495.38 4380.02,-3496.57 4383.06,-3502.88"/>
<text text-anchor="middle" x="4150.5" y="-3557.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu9 -->
<g id="node906" class="node">
<title>l3_attn_stage15_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2900" cy="-3477.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2900" y="-3488.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="2900" y="-3473.97" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2900" y="-3458.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu9&#45;&gt;l3_attn_stage15_gpu9 -->
<g id="edge858" class="edge">
<title>l3_attn_stage14_gpu9&#45;&gt;l3_attn_stage15_gpu9</title>
<path fill="none" stroke="black" d="M2900,-3587.08C2900,-3568.36 2900,-3545.37 2900,-3525.38"/>
<polygon fill="black" stroke="black" points="2903.5,-3525.24 2900,-3515.24 2896.5,-3525.24 2903.5,-3525.24"/>
</g>
<!-- l3_attn_stage14_gpu9&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge1978" class="edge">
<title>l3_attn_stage14_gpu9&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2956.98,-3594.51C2971.9,-3588.22 2988.24,-3582.47 3004,-3579.17 3068.28,-3565.71 4124.05,-3590.96 4186,-3569.17 4196.15,-3565.59 4195.15,-3558.49 4205,-3554.17 4225.61,-3545.12 4233.31,-3552.18 4255,-3546.17 4298.28,-3534.17 4345.59,-3514.54 4378.94,-3499.53"/>
<polygon fill="red" stroke="red" points="4380.74,-3502.55 4388.4,-3495.23 4377.84,-3496.18 4380.74,-3502.55"/>
<text text-anchor="middle" x="4236.5" y="-3557.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu10 -->
<g id="node907" class="node">
<title>l3_attn_stage15_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3108" cy="-3477.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3108" y="-3488.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="3108" y="-3473.97" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3108" y="-3458.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu10&#45;&gt;l3_attn_stage15_gpu10 -->
<g id="edge859" class="edge">
<title>l3_attn_stage14_gpu10&#45;&gt;l3_attn_stage15_gpu10</title>
<path fill="none" stroke="black" d="M3108,-3587.08C3108,-3568.36 3108,-3545.37 3108,-3525.38"/>
<polygon fill="black" stroke="black" points="3111.5,-3525.24 3108,-3515.24 3104.5,-3525.24 3111.5,-3525.24"/>
</g>
<!-- l3_attn_stage14_gpu10&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge1979" class="edge">
<title>l3_attn_stage14_gpu10&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3164.98,-3594.52C3179.91,-3588.23 3196.24,-3582.47 3212,-3579.17 3269.64,-3567.07 4216.46,-3588.74 4272,-3569.17 4282.15,-3565.59 4282.08,-3560.19 4291,-3554.17 4320.36,-3534.34 4355.2,-3514.56 4381.72,-3500.22"/>
<polygon fill="red" stroke="red" points="4383.57,-3503.19 4390.73,-3495.38 4380.26,-3497.03 4383.57,-3503.19"/>
<text text-anchor="middle" x="4322.5" y="-3557.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu11 -->
<g id="node908" class="node">
<title>l3_attn_stage15_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3316" cy="-3477.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3316" y="-3488.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="3316" y="-3473.97" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3316" y="-3458.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu11&#45;&gt;l3_attn_stage15_gpu11 -->
<g id="edge860" class="edge">
<title>l3_attn_stage14_gpu11&#45;&gt;l3_attn_stage15_gpu11</title>
<path fill="none" stroke="black" d="M3316,-3587.08C3316,-3568.36 3316,-3545.37 3316,-3525.38"/>
<polygon fill="black" stroke="black" points="3319.5,-3525.24 3316,-3515.24 3312.5,-3525.24 3319.5,-3525.24"/>
</g>
<!-- l3_attn_stage14_gpu11&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge1980" class="edge">
<title>l3_attn_stage14_gpu11&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3372.98,-3594.54C3387.91,-3588.24 3404.24,-3582.48 3420,-3579.17 3445.5,-3573.8 4334.88,-3581.18 4358,-3569.17 4371.7,-3562.05 4393.58,-3528.63 4408.12,-3504.47"/>
<polygon fill="red" stroke="red" points="4411.21,-3506.12 4413.3,-3495.74 4405.19,-3502.55 4411.21,-3506.12"/>
<text text-anchor="middle" x="4404.5" y="-3557.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu12 -->
<g id="node909" class="node">
<title>l3_attn_stage15_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3524" cy="-3477.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3524" y="-3488.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="3524" y="-3473.97" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3524" y="-3458.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu12&#45;&gt;l3_attn_stage15_gpu12 -->
<g id="edge861" class="edge">
<title>l3_attn_stage14_gpu12&#45;&gt;l3_attn_stage15_gpu12</title>
<path fill="none" stroke="black" d="M3461.19,-3596.34C3447.64,-3590.58 3433.37,-3584.6 3420,-3579.17 3408.53,-3574.51 3401.01,-3579.37 3394,-3569.17 3390.23,-3563.67 3390.04,-3559.53 3394,-3554.17 3401.18,-3544.44 3409.05,-3551.28 3420,-3546.17 3437.44,-3538.02 3455.39,-3527.32 3471.36,-3516.86"/>
<polygon fill="black" stroke="black" points="3473.64,-3519.54 3480.02,-3511.08 3469.76,-3513.72 3473.64,-3519.54"/>
</g>
<!-- l3_attn_stage14_gpu12&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge1981" class="edge">
<title>l3_attn_stage14_gpu12&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3580.99,-3594.55C3595.91,-3588.26 3612.24,-3582.5 3628,-3579.17 3650.18,-3574.48 4428.07,-3585.29 4444,-3569.17 4460.71,-3552.25 4451.21,-3524.8 4440.15,-3504.57"/>
<polygon fill="red" stroke="red" points="4443.11,-3502.7 4435.04,-3495.84 4437.07,-3506.24 4443.11,-3502.7"/>
<text text-anchor="middle" x="4482.5" y="-3557.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu13 -->
<g id="node910" class="node">
<title>l3_attn_stage15_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3732" cy="-3477.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3732" y="-3488.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="3732" y="-3473.97" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3732" y="-3458.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu13&#45;&gt;l3_attn_stage15_gpu13 -->
<g id="edge862" class="edge">
<title>l3_attn_stage14_gpu13&#45;&gt;l3_attn_stage15_gpu13</title>
<path fill="none" stroke="black" d="M3674.39,-3594.67C3659.62,-3588.46 3643.51,-3582.7 3628,-3579.17 3603.39,-3573.55 3418.45,-3587.41 3401,-3569.17 3396.39,-3564.35 3396.37,-3558.96 3401,-3554.17 3409.76,-3545.09 3615.97,-3549.96 3628,-3546.17 3647.58,-3539.99 3667,-3529.05 3683.67,-3517.75"/>
<polygon fill="black" stroke="black" points="3685.94,-3520.43 3692.13,-3511.83 3681.93,-3514.7 3685.94,-3520.43"/>
</g>
<!-- l3_attn_stage14_gpu13&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge1982" class="edge">
<title>l3_attn_stage14_gpu13&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3788.99,-3594.58C3803.92,-3588.28 3820.25,-3582.51 3836,-3579.17 3854.86,-3575.16 4516.47,-3582.9 4530,-3569.17 4555.62,-3543.18 4514.49,-3516.58 4476.04,-3499"/>
<polygon fill="red" stroke="red" points="4477.44,-3495.8 4466.88,-3494.96 4474.61,-3502.2 4477.44,-3495.8"/>
<text text-anchor="middle" x="4568.5" y="-3557.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu14 -->
<g id="node911" class="node">
<title>l3_attn_stage15_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3940" cy="-3477.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3940" y="-3488.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="3940" y="-3473.97" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3940" y="-3458.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu14&#45;&gt;l3_attn_stage15_gpu14 -->
<g id="edge863" class="edge">
<title>l3_attn_stage14_gpu14&#45;&gt;l3_attn_stage15_gpu14</title>
<path fill="none" stroke="black" d="M3882.71,-3594.56C3867.86,-3588.31 3851.64,-3582.56 3836,-3579.17 3812.76,-3574.12 3424.62,-3586.18 3408,-3569.17 3403.34,-3564.4 3403.33,-3558.92 3408,-3554.17 3416.33,-3545.68 3824.63,-3549.65 3836,-3546.17 3855.63,-3540.15 3875.07,-3529.25 3891.73,-3517.94"/>
<polygon fill="black" stroke="black" points="3894.01,-3520.62 3900.18,-3512.01 3889.99,-3514.89 3894.01,-3520.62"/>
</g>
<!-- l3_attn_stage14_gpu14&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge1983" class="edge">
<title>l3_attn_stage14_gpu14&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3997,-3594.61C4011.92,-3588.31 4028.25,-3582.54 4044,-3579.17 4059.54,-3575.84 4604.86,-3580.5 4616,-3569.17 4652.88,-3531.63 4589.24,-3507.87 4525.37,-3494.16"/>
<polygon fill="red" stroke="red" points="4526.05,-3490.73 4515.55,-3492.13 4524.63,-3497.59 4526.05,-3490.73"/>
<text text-anchor="middle" x="4655.5" y="-3557.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_stage15_gpu15 -->
<g id="node912" class="node">
<title>l3_attn_stage15_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4148" cy="-3477.67" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4148" y="-3488.97" font-family="Times,serif" font-size="14.00">L3 Attn Stage15</text>
<text text-anchor="middle" x="4148" y="-3473.97" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4148" y="-3458.97" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l3_attn_stage14_gpu15&#45;&gt;l3_attn_stage15_gpu15 -->
<g id="edge864" class="edge">
<title>l3_attn_stage14_gpu15&#45;&gt;l3_attn_stage15_gpu15</title>
<path fill="none" stroke="black" d="M4091,-3594.59C4076.08,-3588.3 4059.75,-3582.52 4044,-3579.17 4026.91,-3575.52 3427.26,-3581.62 3415,-3569.17 3410.32,-3564.41 3410.32,-3558.91 3415,-3554.17 3427.28,-3541.73 4027.28,-3551.23 4044,-3546.17 4063.65,-3540.21 4083.09,-3529.33 4099.75,-3518.01"/>
<polygon fill="black" stroke="black" points="4102.03,-3520.69 4108.2,-3512.07 4098.01,-3514.96 4102.03,-3520.69"/>
</g>
<!-- l3_attn_stage14_gpu15&#45;&gt;l3_attn_stage15_gpu[next_gpu] -->
<g id="edge1984" class="edge">
<title>l3_attn_stage14_gpu15&#45;&gt;l3_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4207.56,-3595.25C4223.88,-3588.73 4241.81,-3582.68 4259,-3579.17 4283.12,-3574.23 4684.79,-3586.77 4702,-3569.17 4751.67,-3518.36 4664.33,-3496.06 4574.57,-3486.27"/>
<polygon fill="red" stroke="red" points="4574.78,-3482.78 4564.47,-3485.22 4574.05,-3489.74 4574.78,-3482.78"/>
<text text-anchor="middle" x="4741.5" y="-3557.97" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l3_attn_out_gpu0 -->
<g id="node929" class="node">
<title>l3_attn_out_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1029" cy="-3355.08" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1029" y="-3373.88" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="1029" y="-3358.88" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1029" y="-3343.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1029" y="-3328.88" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu0&#45;&gt;l3_attn_out_gpu0 -->
<g id="edge865" class="edge">
<title>l3_attn_stage15_gpu0&#45;&gt;l3_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M1028.3,-3440.16C1028.37,-3431.7 1028.45,-3422.49 1028.52,-3413.38"/>
<polygon fill="black" stroke="black" points="1032.03,-3413.2 1028.61,-3403.17 1025.03,-3413.14 1032.03,-3413.2"/>
</g>
<!-- l3_attn_out_gpu1 -->
<g id="node930" class="node">
<title>l3_attn_out_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1252" cy="-3355.08" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1252" y="-3373.88" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="1252" y="-3358.88" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1252" y="-3343.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1252" y="-3328.88" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu1&#45;&gt;l3_attn_out_gpu1 -->
<g id="edge866" class="edge">
<title>l3_attn_stage15_gpu1&#45;&gt;l3_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M1240.84,-3440.16C1241.97,-3431.7 1243.19,-3422.49 1244.4,-3413.38"/>
<polygon fill="black" stroke="black" points="1247.91,-3413.55 1245.75,-3403.17 1240.97,-3412.63 1247.91,-3413.55"/>
</g>
<!-- l3_attn_out_gpu2 -->
<g id="node931" class="node">
<title>l3_attn_out_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1452" cy="-3355.08" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1452" y="-3373.88" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="1452" y="-3358.88" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1452" y="-3343.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1452" y="-3328.88" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu2&#45;&gt;l3_attn_out_gpu2 -->
<g id="edge867" class="edge">
<title>l3_attn_stage15_gpu2&#45;&gt;l3_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M1446.42,-3440.16C1446.98,-3431.7 1447.59,-3422.49 1448.2,-3413.38"/>
<polygon fill="black" stroke="black" points="1451.71,-3413.38 1448.88,-3403.17 1444.72,-3412.92 1451.71,-3413.38"/>
</g>
<!-- l3_attn_out_gpu3 -->
<g id="node932" class="node">
<title>l3_attn_out_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1664" cy="-3355.08" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1664" y="-3373.88" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="1664" y="-3358.88" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1664" y="-3343.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1664" y="-3328.88" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu3&#45;&gt;l3_attn_out_gpu3 -->
<g id="edge868" class="edge">
<title>l3_attn_stage15_gpu3&#45;&gt;l3_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M1655.63,-3440.16C1656.47,-3431.7 1657.39,-3422.49 1658.3,-3413.38"/>
<polygon fill="black" stroke="black" points="1661.81,-3413.47 1659.31,-3403.17 1654.84,-3412.78 1661.81,-3413.47"/>
</g>
<!-- l3_attn_out_gpu4 -->
<g id="node933" class="node">
<title>l3_attn_out_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1868" cy="-3355.08" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1868" y="-3373.88" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="1868" y="-3358.88" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1868" y="-3343.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1868" y="-3328.88" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu4&#45;&gt;l3_attn_out_gpu4 -->
<g id="edge869" class="edge">
<title>l3_attn_stage15_gpu4&#45;&gt;l3_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M1862.42,-3440.16C1862.98,-3431.7 1863.59,-3422.49 1864.2,-3413.38"/>
<polygon fill="black" stroke="black" points="1867.71,-3413.38 1864.88,-3403.17 1860.72,-3412.92 1867.71,-3413.38"/>
</g>
<!-- l3_attn_out_gpu5 -->
<g id="node934" class="node">
<title>l3_attn_out_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2073" cy="-3355.08" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2073" y="-3373.88" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="2073" y="-3358.88" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2073" y="-3343.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2073" y="-3328.88" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu5&#45;&gt;l3_attn_out_gpu5 -->
<g id="edge870" class="edge">
<title>l3_attn_stage15_gpu5&#45;&gt;l3_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M2069.51,-3440.16C2069.86,-3431.7 2070.25,-3422.49 2070.62,-3413.38"/>
<polygon fill="black" stroke="black" points="2074.13,-3413.31 2071.05,-3403.17 2067.14,-3413.02 2074.13,-3413.31"/>
</g>
<!-- l3_attn_out_gpu6 -->
<g id="node935" class="node">
<title>l3_attn_out_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2281" cy="-3355.08" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2281" y="-3373.88" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="2281" y="-3358.88" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2281" y="-3343.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2281" y="-3328.88" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu6&#45;&gt;l3_attn_out_gpu6 -->
<g id="edge871" class="edge">
<title>l3_attn_stage15_gpu6&#45;&gt;l3_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M2277.51,-3440.16C2277.86,-3431.7 2278.25,-3422.49 2278.62,-3413.38"/>
<polygon fill="black" stroke="black" points="2282.13,-3413.31 2279.05,-3403.17 2275.14,-3413.02 2282.13,-3413.31"/>
</g>
<!-- l3_attn_out_gpu7 -->
<g id="node936" class="node">
<title>l3_attn_out_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2484" cy="-3355.08" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2484" y="-3373.88" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="2484" y="-3358.88" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2484" y="-3343.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2484" y="-3328.88" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu7&#45;&gt;l3_attn_out_gpu7 -->
<g id="edge872" class="edge">
<title>l3_attn_stage15_gpu7&#45;&gt;l3_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M2484,-3440.16C2484,-3431.7 2484,-3422.49 2484,-3413.38"/>
<polygon fill="black" stroke="black" points="2487.5,-3413.17 2484,-3403.17 2480.5,-3413.17 2487.5,-3413.17"/>
</g>
<!-- l3_attn_out_gpu8 -->
<g id="node937" class="node">
<title>l3_attn_out_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2690" cy="-3355.08" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2690" y="-3373.88" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="2690" y="-3358.88" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2690" y="-3343.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2690" y="-3328.88" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu8&#45;&gt;l3_attn_out_gpu8 -->
<g id="edge873" class="edge">
<title>l3_attn_stage15_gpu8&#45;&gt;l3_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M2691.39,-3440.16C2691.25,-3431.7 2691.1,-3422.49 2690.95,-3413.38"/>
<polygon fill="black" stroke="black" points="2694.45,-3413.11 2690.78,-3403.17 2687.45,-3413.23 2694.45,-3413.11"/>
</g>
<!-- l3_attn_out_gpu9 -->
<g id="node938" class="node">
<title>l3_attn_out_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2898" cy="-3355.08" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2898" y="-3373.88" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="2898" y="-3358.88" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2898" y="-3343.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2898" y="-3328.88" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu9&#45;&gt;l3_attn_out_gpu9 -->
<g id="edge874" class="edge">
<title>l3_attn_stage15_gpu9&#45;&gt;l3_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M2899.39,-3440.16C2899.25,-3431.7 2899.1,-3422.49 2898.95,-3413.38"/>
<polygon fill="black" stroke="black" points="2902.45,-3413.11 2898.78,-3403.17 2895.45,-3413.23 2902.45,-3413.11"/>
</g>
<!-- l3_attn_out_gpu10 -->
<g id="node939" class="node">
<title>l3_attn_out_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3103" cy="-3355.08" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3103" y="-3373.88" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="3103" y="-3358.88" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3103" y="-3343.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3103" y="-3328.88" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu10&#45;&gt;l3_attn_out_gpu10 -->
<g id="edge875" class="edge">
<title>l3_attn_stage15_gpu10&#45;&gt;l3_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M3106.49,-3440.16C3106.14,-3431.7 3105.75,-3422.49 3105.38,-3413.38"/>
<polygon fill="black" stroke="black" points="3108.86,-3413.02 3104.95,-3403.17 3101.87,-3413.31 3108.86,-3413.02"/>
</g>
<!-- l3_attn_out_gpu11 -->
<g id="node940" class="node">
<title>l3_attn_out_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3312" cy="-3355.08" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3312" y="-3373.88" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="3312" y="-3358.88" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3312" y="-3343.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3312" y="-3328.88" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu11&#45;&gt;l3_attn_out_gpu11 -->
<g id="edge876" class="edge">
<title>l3_attn_stage15_gpu11&#45;&gt;l3_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M3314.79,-3440.16C3314.51,-3431.7 3314.2,-3422.49 3313.9,-3413.38"/>
<polygon fill="black" stroke="black" points="3317.39,-3413.05 3313.56,-3403.17 3310.4,-3413.28 3317.39,-3413.05"/>
</g>
<!-- l3_attn_out_gpu12 -->
<g id="node941" class="node">
<title>l3_attn_out_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3514" cy="-3355.08" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3514" y="-3373.88" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="3514" y="-3358.88" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3514" y="-3343.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3514" y="-3328.88" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu12&#45;&gt;l3_attn_out_gpu12 -->
<g id="edge877" class="edge">
<title>l3_attn_stage15_gpu12&#45;&gt;l3_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M3520.97,-3440.16C3520.27,-3431.7 3519.51,-3422.49 3518.75,-3413.38"/>
<polygon fill="black" stroke="black" points="3522.22,-3412.85 3517.91,-3403.17 3515.24,-3413.43 3522.22,-3412.85"/>
</g>
<!-- l3_attn_out_gpu13 -->
<g id="node942" class="node">
<title>l3_attn_out_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3723" cy="-3355.08" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3723" y="-3373.88" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="3723" y="-3358.88" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3723" y="-3343.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3723" y="-3328.88" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu13&#45;&gt;l3_attn_out_gpu13 -->
<g id="edge878" class="edge">
<title>l3_attn_stage15_gpu13&#45;&gt;l3_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M3729.28,-3440.16C3728.64,-3431.7 3727.96,-3422.49 3727.28,-3413.38"/>
<polygon fill="black" stroke="black" points="3730.75,-3412.88 3726.51,-3403.17 3723.77,-3413.41 3730.75,-3412.88"/>
</g>
<!-- l3_attn_out_gpu14 -->
<g id="node943" class="node">
<title>l3_attn_out_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3931" cy="-3355.08" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3931" y="-3373.88" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="3931" y="-3358.88" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3931" y="-3343.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3931" y="-3328.88" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu14&#45;&gt;l3_attn_out_gpu14 -->
<g id="edge879" class="edge">
<title>l3_attn_stage15_gpu14&#45;&gt;l3_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M3937.28,-3440.16C3936.64,-3431.7 3935.96,-3422.49 3935.28,-3413.38"/>
<polygon fill="black" stroke="black" points="3938.75,-3412.88 3934.51,-3403.17 3931.77,-3413.41 3938.75,-3412.88"/>
</g>
<!-- l3_attn_out_gpu15 -->
<g id="node944" class="node">
<title>l3_attn_out_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4139" cy="-3355.08" rx="75" ry="48.17"/>
<text text-anchor="middle" x="4139" y="-3373.88" font-family="Times,serif" font-size="14.00">L3 Attn Out</text>
<text text-anchor="middle" x="4139" y="-3358.88" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4139" y="-3343.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="4139" y="-3328.88" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l3_attn_stage15_gpu15&#45;&gt;l3_attn_out_gpu15 -->
<g id="edge880" class="edge">
<title>l3_attn_stage15_gpu15&#45;&gt;l3_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M4145.28,-3440.16C4144.64,-3431.7 4143.96,-3422.49 4143.28,-3413.38"/>
<polygon fill="black" stroke="black" points="4146.75,-3412.88 4142.51,-3403.17 4139.77,-3413.41 4146.75,-3412.88"/>
</g>
<!-- l3_qkv_gpu0&#45;&gt;l3_attn_stage0_gpu0 -->
<g id="edge609" class="edge">
<title>l3_qkv_gpu0&#45;&gt;l3_attn_stage0_gpu0</title>
<path fill="none" stroke="black" d="M1150.44,-5781.61C1164.75,-5764 1181.21,-5743.74 1195.42,-5726.23"/>
<polygon fill="black" stroke="black" points="1198.2,-5728.37 1201.78,-5718.4 1192.76,-5723.96 1198.2,-5728.37"/>
</g>
<!-- l3_qkv_gpu1&#45;&gt;l3_attn_stage0_gpu1 -->
<g id="edge610" class="edge">
<title>l3_qkv_gpu1&#45;&gt;l3_attn_stage0_gpu1</title>
<path fill="none" stroke="black" d="M1353.34,-5781.23C1366.04,-5763.93 1380.59,-5744.12 1393.24,-5726.9"/>
<polygon fill="black" stroke="black" points="1396.18,-5728.81 1399.28,-5718.68 1390.54,-5724.66 1396.18,-5728.81"/>
</g>
<!-- l3_qkv_gpu2&#45;&gt;l3_attn_stage0_gpu2 -->
<g id="edge611" class="edge">
<title>l3_qkv_gpu2&#45;&gt;l3_attn_stage0_gpu2</title>
<path fill="none" stroke="black" d="M1553.43,-5780.84C1565.06,-5763.85 1578.32,-5744.5 1589.93,-5727.56"/>
<polygon fill="black" stroke="black" points="1593.07,-5729.17 1595.83,-5718.94 1587.29,-5725.22 1593.07,-5729.17"/>
</g>
<!-- l3_qkv_gpu3&#45;&gt;l3_attn_stage0_gpu3 -->
<g id="edge612" class="edge">
<title>l3_qkv_gpu3&#45;&gt;l3_attn_stage0_gpu3</title>
<path fill="none" stroke="black" d="M1753.48,-5780.45C1764.18,-5763.62 1776.32,-5744.51 1786.98,-5727.74"/>
<polygon fill="black" stroke="black" points="1789.99,-5729.53 1792.41,-5719.21 1784.09,-5725.77 1789.99,-5729.53"/>
</g>
<!-- l3_qkv_gpu4&#45;&gt;l3_attn_stage0_gpu4 -->
<g id="edge613" class="edge">
<title>l3_qkv_gpu4&#45;&gt;l3_attn_stage0_gpu4</title>
<path fill="none" stroke="black" d="M1956.43,-5779.67C1965.64,-5763.17 1976.02,-5744.56 1985.18,-5728.15"/>
<polygon fill="black" stroke="black" points="1988.31,-5729.72 1990.13,-5719.28 1982.2,-5726.31 1988.31,-5729.72"/>
</g>
<!-- l3_qkv_gpu5&#45;&gt;l3_attn_stage0_gpu5 -->
<g id="edge614" class="edge">
<title>l3_qkv_gpu5&#45;&gt;l3_attn_stage0_gpu5</title>
<path fill="none" stroke="black" d="M2159.08,-5779.28C2166.86,-5763.08 2175.59,-5744.9 2183.34,-5728.77"/>
<polygon fill="black" stroke="black" points="2186.59,-5730.07 2187.77,-5719.54 2180.28,-5727.04 2186.59,-5730.07"/>
</g>
<!-- l3_qkv_gpu6&#45;&gt;l3_attn_stage0_gpu6 -->
<g id="edge615" class="edge">
<title>l3_qkv_gpu6&#45;&gt;l3_attn_stage0_gpu6</title>
<path fill="none" stroke="black" d="M2360.32,-5778.89C2366.94,-5762.99 2374.35,-5745.23 2380.95,-5729.38"/>
<polygon fill="black" stroke="black" points="2384.33,-5730.38 2384.94,-5719.8 2377.87,-5727.68 2384.33,-5730.38"/>
</g>
<!-- l3_qkv_gpu7&#45;&gt;l3_attn_stage0_gpu7 -->
<g id="edge616" class="edge">
<title>l3_qkv_gpu7&#45;&gt;l3_attn_stage0_gpu7</title>
<path fill="none" stroke="black" d="M2560.03,-5778.89C2565.86,-5762.99 2572.39,-5745.23 2578.21,-5729.38"/>
<polygon fill="black" stroke="black" points="2581.57,-5730.39 2581.73,-5719.8 2575,-5727.98 2581.57,-5730.39"/>
</g>
<!-- l3_qkv_gpu8&#45;&gt;l3_attn_stage0_gpu8 -->
<g id="edge617" class="edge">
<title>l3_qkv_gpu8&#45;&gt;l3_attn_stage0_gpu8</title>
<path fill="none" stroke="black" d="M2759.86,-5778.5C2764.82,-5762.9 2770.33,-5745.54 2775.28,-5729.98"/>
<polygon fill="black" stroke="black" points="2778.74,-5730.65 2778.43,-5720.06 2772.07,-5728.53 2778.74,-5730.65"/>
</g>
<!-- l3_qkv_gpu9&#45;&gt;l3_attn_stage0_gpu9 -->
<g id="edge618" class="edge">
<title>l3_qkv_gpu9&#45;&gt;l3_attn_stage0_gpu9</title>
<path fill="none" stroke="black" d="M2959.55,-5778.5C2963.73,-5762.9 2968.39,-5745.54 2972.57,-5729.98"/>
<polygon fill="black" stroke="black" points="2976.02,-5730.62 2975.23,-5720.06 2969.26,-5728.81 2976.02,-5730.62"/>
</g>
<!-- l3_qkv_gpu10&#45;&gt;l3_attn_stage0_gpu10 -->
<g id="edge619" class="edge">
<title>l3_qkv_gpu10&#45;&gt;l3_attn_stage0_gpu10</title>
<path fill="none" stroke="black" d="M3159.32,-5778.1C3162.7,-5762.66 3166.46,-5745.53 3169.83,-5730.13"/>
<polygon fill="black" stroke="black" points="3173.26,-5730.83 3171.98,-5720.31 3166.42,-5729.33 3173.26,-5730.83"/>
</g>
<!-- l3_qkv_gpu11&#45;&gt;l3_attn_stage0_gpu11 -->
<g id="edge620" class="edge">
<title>l3_qkv_gpu11&#45;&gt;l3_attn_stage0_gpu11</title>
<path fill="none" stroke="black" d="M3358.99,-5778.1C3361.58,-5762.81 3364.46,-5745.85 3367.05,-5730.57"/>
<polygon fill="black" stroke="black" points="3370.57,-5730.75 3368.79,-5720.31 3363.67,-5729.58 3370.57,-5730.75"/>
</g>
<!-- l3_qkv_gpu12&#45;&gt;l3_attn_stage0_gpu12 -->
<g id="edge621" class="edge">
<title>l3_qkv_gpu12&#45;&gt;l3_attn_stage0_gpu12</title>
<path fill="none" stroke="black" d="M3558.66,-5778.1C3560.5,-5762.81 3562.53,-5745.85 3564.37,-5730.57"/>
<polygon fill="black" stroke="black" points="3567.88,-5730.65 3565.6,-5720.31 3560.93,-5729.82 3567.88,-5730.65"/>
</g>
<!-- l3_qkv_gpu13&#45;&gt;l3_attn_stage0_gpu13 -->
<g id="edge622" class="edge">
<title>l3_qkv_gpu13&#45;&gt;l3_attn_stage0_gpu13</title>
<path fill="none" stroke="black" d="M3758.33,-5778.1C3759.41,-5762.81 3760.61,-5745.85 3761.69,-5730.57"/>
<polygon fill="black" stroke="black" points="3765.2,-5730.53 3762.41,-5720.31 3758.22,-5730.04 3765.2,-5730.53"/>
</g>
<!-- l3_qkv_gpu14&#45;&gt;l3_attn_stage0_gpu14 -->
<g id="edge623" class="edge">
<title>l3_qkv_gpu14&#45;&gt;l3_attn_stage0_gpu14</title>
<path fill="none" stroke="black" d="M3958,-5778.1C3958.32,-5762.81 3958.68,-5745.85 3959.01,-5730.57"/>
<polygon fill="black" stroke="black" points="3962.51,-5730.38 3959.22,-5720.31 3955.51,-5730.23 3962.51,-5730.38"/>
</g>
<!-- l3_qkv_gpu15&#45;&gt;l3_attn_stage0_gpu15 -->
<g id="edge624" class="edge">
<title>l3_qkv_gpu15&#45;&gt;l3_attn_stage0_gpu15</title>
<path fill="none" stroke="black" d="M4157.67,-5778.1C4157.24,-5762.81 4156.76,-5745.85 4156.33,-5730.57"/>
<polygon fill="black" stroke="black" points="4159.82,-5730.21 4156.04,-5720.31 4152.82,-5730.4 4159.82,-5730.21"/>
</g>
<!-- l3_mlp_h2_4h_gpu0 -->
<g id="node945" class="node">
<title>l3_mlp_h2_4h_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1046" cy="-3221.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1046" y="-3240.72" font-family="Times,serif" font-size="14.00">L3 MLP h24h</text>
<text text-anchor="middle" x="1046" y="-3225.72" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1046" y="-3210.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1046" y="-3195.72" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l3_attn_out_gpu0&#45;&gt;l3_mlp_h2_4h_gpu0 -->
<g id="edge881" class="edge">
<title>l3_attn_out_gpu0&#45;&gt;l3_mlp_h2_4h_gpu0</title>
<path fill="none" stroke="black" d="M1035.09,-3307.1C1036.22,-3298.34 1037.42,-3289.1 1038.59,-3280.07"/>
<polygon fill="black" stroke="black" points="1042.08,-3280.38 1039.9,-3270.01 1035.14,-3279.48 1042.08,-3280.38"/>
</g>
<!-- l3_mlp_h2_4h_gpu1 -->
<g id="node947" class="node">
<title>l3_mlp_h2_4h_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1258" cy="-3221.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1258" y="-3240.72" font-family="Times,serif" font-size="14.00">L3 MLP h24h</text>
<text text-anchor="middle" x="1258" y="-3225.72" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1258" y="-3210.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1258" y="-3195.72" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l3_attn_out_gpu1&#45;&gt;l3_mlp_h2_4h_gpu1 -->
<g id="edge883" class="edge">
<title>l3_attn_out_gpu1&#45;&gt;l3_mlp_h2_4h_gpu1</title>
<path fill="none" stroke="black" d="M1254.17,-3306.73C1254.56,-3298.18 1254.97,-3289.19 1255.37,-3280.4"/>
<polygon fill="black" stroke="black" points="1258.88,-3280.35 1255.84,-3270.2 1251.88,-3280.03 1258.88,-3280.35"/>
</g>
<!-- l3_mlp_h2_4h_gpu2 -->
<g id="node949" class="node">
<title>l3_mlp_h2_4h_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1465" cy="-3221.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1465" y="-3240.72" font-family="Times,serif" font-size="14.00">L3 MLP h24h</text>
<text text-anchor="middle" x="1465" y="-3225.72" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1465" y="-3210.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1465" y="-3195.72" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l3_attn_out_gpu2&#45;&gt;l3_mlp_h2_4h_gpu2 -->
<g id="edge885" class="edge">
<title>l3_attn_out_gpu2&#45;&gt;l3_mlp_h2_4h_gpu2</title>
<path fill="none" stroke="black" d="M1456.69,-3306.73C1457.54,-3298.18 1458.43,-3289.19 1459.3,-3280.4"/>
<polygon fill="black" stroke="black" points="1462.81,-3280.5 1460.31,-3270.2 1455.84,-3279.81 1462.81,-3280.5"/>
</g>
<!-- l3_mlp_h2_4h_gpu3 -->
<g id="node951" class="node">
<title>l3_mlp_h2_4h_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1667" cy="-3221.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1667" y="-3240.72" font-family="Times,serif" font-size="14.00">L3 MLP h24h</text>
<text text-anchor="middle" x="1667" y="-3225.72" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1667" y="-3210.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1667" y="-3195.72" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l3_attn_out_gpu3&#45;&gt;l3_mlp_h2_4h_gpu3 -->
<g id="edge887" class="edge">
<title>l3_attn_out_gpu3&#45;&gt;l3_mlp_h2_4h_gpu3</title>
<path fill="none" stroke="black" d="M1665.08,-3306.73C1665.28,-3298.18 1665.48,-3289.19 1665.69,-3280.4"/>
<polygon fill="black" stroke="black" points="1669.19,-3280.28 1665.92,-3270.2 1662.19,-3280.12 1669.19,-3280.28"/>
</g>
<!-- l3_mlp_h2_4h_gpu4 -->
<g id="node953" class="node">
<title>l3_mlp_h2_4h_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1871" cy="-3221.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1871" y="-3240.72" font-family="Times,serif" font-size="14.00">L3 MLP h24h</text>
<text text-anchor="middle" x="1871" y="-3225.72" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1871" y="-3210.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1871" y="-3195.72" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l3_attn_out_gpu4&#45;&gt;l3_mlp_h2_4h_gpu4 -->
<g id="edge889" class="edge">
<title>l3_attn_out_gpu4&#45;&gt;l3_mlp_h2_4h_gpu4</title>
<path fill="none" stroke="black" d="M1869.08,-3306.73C1869.28,-3298.18 1869.48,-3289.19 1869.69,-3280.4"/>
<polygon fill="black" stroke="black" points="1873.19,-3280.28 1869.92,-3270.2 1866.19,-3280.12 1873.19,-3280.28"/>
</g>
<!-- l3_mlp_h2_4h_gpu5 -->
<g id="node955" class="node">
<title>l3_mlp_h2_4h_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2079" cy="-3221.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2079" y="-3240.72" font-family="Times,serif" font-size="14.00">L3 MLP h24h</text>
<text text-anchor="middle" x="2079" y="-3225.72" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2079" y="-3210.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2079" y="-3195.72" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l3_attn_out_gpu5&#45;&gt;l3_mlp_h2_4h_gpu5 -->
<g id="edge891" class="edge">
<title>l3_attn_out_gpu5&#45;&gt;l3_mlp_h2_4h_gpu5</title>
<path fill="none" stroke="black" d="M2075.17,-3306.73C2075.56,-3298.18 2075.97,-3289.19 2076.37,-3280.4"/>
<polygon fill="black" stroke="black" points="2079.88,-3280.35 2076.84,-3270.2 2072.88,-3280.03 2079.88,-3280.35"/>
</g>
<!-- l3_mlp_h2_4h_gpu6 -->
<g id="node957" class="node">
<title>l3_mlp_h2_4h_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2284" cy="-3221.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2284" y="-3240.72" font-family="Times,serif" font-size="14.00">L3 MLP h24h</text>
<text text-anchor="middle" x="2284" y="-3225.72" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2284" y="-3210.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2284" y="-3195.72" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l3_attn_out_gpu6&#45;&gt;l3_mlp_h2_4h_gpu6 -->
<g id="edge893" class="edge">
<title>l3_attn_out_gpu6&#45;&gt;l3_mlp_h2_4h_gpu6</title>
<path fill="none" stroke="black" d="M2282.08,-3306.73C2282.28,-3298.18 2282.48,-3289.19 2282.69,-3280.4"/>
<polygon fill="black" stroke="black" points="2286.19,-3280.28 2282.92,-3270.2 2279.19,-3280.12 2286.19,-3280.28"/>
</g>
<!-- l3_mlp_h2_4h_gpu7 -->
<g id="node959" class="node">
<title>l3_mlp_h2_4h_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2487" cy="-3221.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2487" y="-3240.72" font-family="Times,serif" font-size="14.00">L3 MLP h24h</text>
<text text-anchor="middle" x="2487" y="-3225.72" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2487" y="-3210.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2487" y="-3195.72" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l3_attn_out_gpu7&#45;&gt;l3_mlp_h2_4h_gpu7 -->
<g id="edge895" class="edge">
<title>l3_attn_out_gpu7&#45;&gt;l3_mlp_h2_4h_gpu7</title>
<path fill="none" stroke="black" d="M2485.08,-3306.73C2485.28,-3298.18 2485.48,-3289.19 2485.69,-3280.4"/>
<polygon fill="black" stroke="black" points="2489.19,-3280.28 2485.92,-3270.2 2482.19,-3280.12 2489.19,-3280.28"/>
</g>
<!-- l3_mlp_h2_4h_gpu8 -->
<g id="node961" class="node">
<title>l3_mlp_h2_4h_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2689" cy="-3221.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2689" y="-3240.72" font-family="Times,serif" font-size="14.00">L3 MLP h24h</text>
<text text-anchor="middle" x="2689" y="-3225.72" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2689" y="-3210.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2689" y="-3195.72" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l3_attn_out_gpu8&#45;&gt;l3_mlp_h2_4h_gpu8 -->
<g id="edge897" class="edge">
<title>l3_attn_out_gpu8&#45;&gt;l3_mlp_h2_4h_gpu8</title>
<path fill="none" stroke="black" d="M2689.64,-3306.73C2689.57,-3298.18 2689.51,-3289.19 2689.44,-3280.4"/>
<polygon fill="black" stroke="black" points="2692.94,-3280.17 2689.36,-3270.2 2685.94,-3280.23 2692.94,-3280.17"/>
</g>
<!-- l3_mlp_h2_4h_gpu9 -->
<g id="node963" class="node">
<title>l3_mlp_h2_4h_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2897" cy="-3221.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2897" y="-3240.72" font-family="Times,serif" font-size="14.00">L3 MLP h24h</text>
<text text-anchor="middle" x="2897" y="-3225.72" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2897" y="-3210.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2897" y="-3195.72" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l3_attn_out_gpu9&#45;&gt;l3_mlp_h2_4h_gpu9 -->
<g id="edge899" class="edge">
<title>l3_attn_out_gpu9&#45;&gt;l3_mlp_h2_4h_gpu9</title>
<path fill="none" stroke="black" d="M2897.64,-3306.73C2897.57,-3298.18 2897.51,-3289.19 2897.44,-3280.4"/>
<polygon fill="black" stroke="black" points="2900.94,-3280.17 2897.36,-3270.2 2893.94,-3280.23 2900.94,-3280.17"/>
</g>
<!-- l3_mlp_h2_4h_gpu10 -->
<g id="node965" class="node">
<title>l3_mlp_h2_4h_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3100" cy="-3221.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3100" y="-3240.72" font-family="Times,serif" font-size="14.00">L3 MLP h24h</text>
<text text-anchor="middle" x="3100" y="-3225.72" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3100" y="-3210.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3100" y="-3195.72" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l3_attn_out_gpu10&#45;&gt;l3_mlp_h2_4h_gpu10 -->
<g id="edge901" class="edge">
<title>l3_attn_out_gpu10&#45;&gt;l3_mlp_h2_4h_gpu10</title>
<path fill="none" stroke="black" d="M3101.92,-3306.73C3101.72,-3298.18 3101.52,-3289.19 3101.31,-3280.4"/>
<polygon fill="black" stroke="black" points="3104.81,-3280.12 3101.08,-3270.2 3097.81,-3280.28 3104.81,-3280.12"/>
</g>
<!-- l3_mlp_h2_4h_gpu11 -->
<g id="node967" class="node">
<title>l3_mlp_h2_4h_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3305" cy="-3221.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3305" y="-3240.72" font-family="Times,serif" font-size="14.00">L3 MLP h24h</text>
<text text-anchor="middle" x="3305" y="-3225.72" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3305" y="-3210.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3305" y="-3195.72" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l3_attn_out_gpu11&#45;&gt;l3_mlp_h2_4h_gpu11 -->
<g id="edge903" class="edge">
<title>l3_attn_out_gpu11&#45;&gt;l3_mlp_h2_4h_gpu11</title>
<path fill="none" stroke="black" d="M3309.47,-3306.73C3309.02,-3298.18 3308.54,-3289.19 3308.07,-3280.4"/>
<polygon fill="black" stroke="black" points="3311.55,-3280 3307.52,-3270.2 3304.56,-3280.37 3311.55,-3280"/>
</g>
<!-- l3_mlp_h2_4h_gpu12 -->
<g id="node969" class="node">
<title>l3_mlp_h2_4h_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3510" cy="-3221.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3510" y="-3240.72" font-family="Times,serif" font-size="14.00">L3 MLP h24h</text>
<text text-anchor="middle" x="3510" y="-3225.72" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3510" y="-3210.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3510" y="-3195.72" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l3_attn_out_gpu12&#45;&gt;l3_mlp_h2_4h_gpu12 -->
<g id="edge905" class="edge">
<title>l3_attn_out_gpu12&#45;&gt;l3_mlp_h2_4h_gpu12</title>
<path fill="none" stroke="black" d="M3512.56,-3306.73C3512.3,-3298.18 3512.02,-3289.19 3511.75,-3280.4"/>
<polygon fill="black" stroke="black" points="3515.25,-3280.09 3511.44,-3270.2 3508.25,-3280.3 3515.25,-3280.09"/>
</g>
<!-- l3_mlp_h2_4h_gpu13 -->
<g id="node971" class="node">
<title>l3_mlp_h2_4h_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3715" cy="-3221.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3715" y="-3240.72" font-family="Times,serif" font-size="14.00">L3 MLP h24h</text>
<text text-anchor="middle" x="3715" y="-3225.72" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3715" y="-3210.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3715" y="-3195.72" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l3_attn_out_gpu13&#45;&gt;l3_mlp_h2_4h_gpu13 -->
<g id="edge907" class="edge">
<title>l3_attn_out_gpu13&#45;&gt;l3_mlp_h2_4h_gpu13</title>
<path fill="none" stroke="black" d="M3720.11,-3306.73C3719.59,-3298.18 3719.04,-3289.19 3718.51,-3280.4"/>
<polygon fill="black" stroke="black" points="3721.99,-3279.97 3717.88,-3270.2 3715,-3280.4 3721.99,-3279.97"/>
</g>
<!-- l3_mlp_h2_4h_gpu14 -->
<g id="node973" class="node">
<title>l3_mlp_h2_4h_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3922" cy="-3221.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3922" y="-3240.72" font-family="Times,serif" font-size="14.00">L3 MLP h24h</text>
<text text-anchor="middle" x="3922" y="-3225.72" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3922" y="-3210.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3922" y="-3195.72" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l3_attn_out_gpu14&#45;&gt;l3_mlp_h2_4h_gpu14 -->
<g id="edge909" class="edge">
<title>l3_attn_out_gpu14&#45;&gt;l3_mlp_h2_4h_gpu14</title>
<path fill="none" stroke="black" d="M3927.75,-3306.73C3927.16,-3298.18 3926.55,-3289.19 3925.94,-3280.4"/>
<polygon fill="black" stroke="black" points="3929.42,-3279.94 3925.24,-3270.2 3922.44,-3280.42 3929.42,-3279.94"/>
</g>
<!-- l3_mlp_h2_4h_gpu15 -->
<g id="node975" class="node">
<title>l3_mlp_h2_4h_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4130" cy="-3221.92" rx="92" ry="48.17"/>
<text text-anchor="middle" x="4130" y="-3240.72" font-family="Times,serif" font-size="14.00">L3 MLP h24h</text>
<text text-anchor="middle" x="4130" y="-3225.72" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4130" y="-3210.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="4130" y="-3195.72" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l3_attn_out_gpu15&#45;&gt;l3_mlp_h2_4h_gpu15 -->
<g id="edge911" class="edge">
<title>l3_attn_out_gpu15&#45;&gt;l3_mlp_h2_4h_gpu15</title>
<path fill="none" stroke="black" d="M4135.75,-3306.73C4135.16,-3298.18 4134.55,-3289.19 4133.94,-3280.4"/>
<polygon fill="black" stroke="black" points="4137.42,-3279.94 4133.24,-3270.2 4130.44,-3280.42 4137.42,-3279.94"/>
</g>
<!-- l3_mlp_4h2_h_gpu0 -->
<g id="node946" class="node">
<title>l3_mlp_4h2_h_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1048" cy="-3088.75" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1048" y="-3107.55" font-family="Times,serif" font-size="14.00">L3 MLP 4h2h</text>
<text text-anchor="middle" x="1048" y="-3092.55" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1048" y="-3077.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1048" y="-3062.55" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l3_mlp_h2_4h_gpu0&#45;&gt;l3_mlp_4h2_h_gpu0 -->
<g id="edge882" class="edge">
<title>l3_mlp_h2_4h_gpu0&#45;&gt;l3_mlp_4h2_h_gpu0</title>
<path fill="none" stroke="black" d="M1046.72,-3173.56C1046.85,-3165.02 1046.99,-3156.02 1047.12,-3147.23"/>
<polygon fill="black" stroke="black" points="1050.63,-3147.09 1047.28,-3137.03 1043.63,-3146.98 1050.63,-3147.09"/>
</g>
<!-- l4_qkv_gpu0 -->
<g id="node1233" class="node">
<title>l4_qkv_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1061" cy="-2934.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1061" y="-2953.38" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="1061" y="-2938.38" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1061" y="-2923.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1061" y="-2908.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_mlp_4h2_h_gpu0&#45;&gt;l4_qkv_gpu0 -->
<g id="edge1985" class="edge">
<title>l3_mlp_4h2_h_gpu0&#45;&gt;l4_qkv_gpu0</title>
<path fill="none" stroke="black" d="M1052.04,-3040.44C1053.33,-3025.41 1054.76,-3008.62 1056.1,-2992.96"/>
<polygon fill="black" stroke="black" points="1059.6,-2993.13 1056.96,-2982.87 1052.62,-2992.53 1059.6,-2993.13"/>
</g>
<!-- l3_mlp_4h2_h_gpu1 -->
<g id="node948" class="node">
<title>l3_mlp_4h2_h_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1266" cy="-3088.75" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1266" y="-3107.55" font-family="Times,serif" font-size="14.00">L3 MLP 4h2h</text>
<text text-anchor="middle" x="1266" y="-3092.55" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1266" y="-3077.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1266" y="-3062.55" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l3_mlp_h2_4h_gpu1&#45;&gt;l3_mlp_4h2_h_gpu1 -->
<g id="edge884" class="edge">
<title>l3_mlp_h2_4h_gpu1&#45;&gt;l3_mlp_4h2_h_gpu1</title>
<path fill="none" stroke="black" d="M1260.89,-3173.56C1261.41,-3165.02 1261.96,-3156.02 1262.49,-3147.23"/>
<polygon fill="black" stroke="black" points="1266,-3147.23 1263.12,-3137.03 1259.01,-3146.8 1266,-3147.23"/>
</g>
<!-- l4_qkv_gpu1 -->
<g id="node1234" class="node">
<title>l4_qkv_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1270" cy="-2934.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1270" y="-2953.38" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="1270" y="-2938.38" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1270" y="-2923.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1270" y="-2908.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_mlp_4h2_h_gpu1&#45;&gt;l4_qkv_gpu1 -->
<g id="edge1986" class="edge">
<title>l3_mlp_4h2_h_gpu1&#45;&gt;l4_qkv_gpu1</title>
<path fill="none" stroke="black" d="M1267.24,-3040.44C1267.64,-3025.41 1268.08,-3008.62 1268.49,-2992.96"/>
<polygon fill="black" stroke="black" points="1271.99,-2992.95 1268.76,-2982.87 1265,-2992.77 1271.99,-2992.95"/>
</g>
<!-- l3_mlp_4h2_h_gpu2 -->
<g id="node950" class="node">
<title>l3_mlp_4h2_h_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1472" cy="-3088.75" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1472" y="-3107.55" font-family="Times,serif" font-size="14.00">L3 MLP 4h2h</text>
<text text-anchor="middle" x="1472" y="-3092.55" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1472" y="-3077.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1472" y="-3062.55" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l3_mlp_h2_4h_gpu2&#45;&gt;l3_mlp_4h2_h_gpu2 -->
<g id="edge886" class="edge">
<title>l3_mlp_h2_4h_gpu2&#45;&gt;l3_mlp_4h2_h_gpu2</title>
<path fill="none" stroke="black" d="M1467.53,-3173.56C1467.98,-3165.02 1468.46,-3156.02 1468.93,-3147.23"/>
<polygon fill="black" stroke="black" points="1472.44,-3147.21 1469.48,-3137.03 1465.45,-3146.83 1472.44,-3147.21"/>
</g>
<!-- l4_qkv_gpu2 -->
<g id="node1235" class="node">
<title>l4_qkv_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1475" cy="-2934.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1475" y="-2953.38" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="1475" y="-2938.38" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1475" y="-2923.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1475" y="-2908.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_mlp_4h2_h_gpu2&#45;&gt;l4_qkv_gpu2 -->
<g id="edge1987" class="edge">
<title>l3_mlp_4h2_h_gpu2&#45;&gt;l4_qkv_gpu2</title>
<path fill="none" stroke="black" d="M1472.93,-3040.44C1473.23,-3025.41 1473.56,-3008.62 1473.87,-2992.96"/>
<polygon fill="black" stroke="black" points="1477.37,-2992.93 1474.07,-2982.87 1470.37,-2992.79 1477.37,-2992.93"/>
</g>
<!-- l3_mlp_4h2_h_gpu3 -->
<g id="node952" class="node">
<title>l3_mlp_4h2_h_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1669" cy="-3088.75" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1669" y="-3107.55" font-family="Times,serif" font-size="14.00">L3 MLP 4h2h</text>
<text text-anchor="middle" x="1669" y="-3092.55" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1669" y="-3077.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1669" y="-3062.55" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l3_mlp_h2_4h_gpu3&#45;&gt;l3_mlp_4h2_h_gpu3 -->
<g id="edge888" class="edge">
<title>l3_mlp_h2_4h_gpu3&#45;&gt;l3_mlp_4h2_h_gpu3</title>
<path fill="none" stroke="black" d="M1667.72,-3173.56C1667.85,-3165.02 1667.99,-3156.02 1668.12,-3147.23"/>
<polygon fill="black" stroke="black" points="1671.63,-3147.09 1668.28,-3137.03 1664.63,-3146.98 1671.63,-3147.09"/>
</g>
<!-- l4_qkv_gpu3 -->
<g id="node1236" class="node">
<title>l4_qkv_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1678" cy="-2934.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1678" y="-2953.38" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="1678" y="-2938.38" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1678" y="-2923.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1678" y="-2908.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_mlp_4h2_h_gpu3&#45;&gt;l4_qkv_gpu3 -->
<g id="edge1988" class="edge">
<title>l3_mlp_4h2_h_gpu3&#45;&gt;l4_qkv_gpu3</title>
<path fill="none" stroke="black" d="M1671.8,-3040.44C1672.69,-3025.41 1673.68,-3008.62 1674.61,-2992.96"/>
<polygon fill="black" stroke="black" points="1678.11,-2993.06 1675.2,-2982.87 1671.12,-2992.64 1678.11,-2993.06"/>
</g>
<!-- l3_mlp_4h2_h_gpu4 -->
<g id="node954" class="node">
<title>l3_mlp_4h2_h_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1875" cy="-3088.75" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1875" y="-3107.55" font-family="Times,serif" font-size="14.00">L3 MLP 4h2h</text>
<text text-anchor="middle" x="1875" y="-3092.55" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1875" y="-3077.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1875" y="-3062.55" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l3_mlp_h2_4h_gpu4&#45;&gt;l3_mlp_4h2_h_gpu4 -->
<g id="edge890" class="edge">
<title>l3_mlp_h2_4h_gpu4&#45;&gt;l3_mlp_4h2_h_gpu4</title>
<path fill="none" stroke="black" d="M1872.44,-3173.56C1872.7,-3165.02 1872.98,-3156.02 1873.25,-3147.23"/>
<polygon fill="black" stroke="black" points="1876.75,-3147.14 1873.56,-3137.03 1869.75,-3146.92 1876.75,-3147.14"/>
</g>
<!-- l4_qkv_gpu4 -->
<g id="node1237" class="node">
<title>l4_qkv_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1881" cy="-2934.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1881" y="-2953.38" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="1881" y="-2938.38" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1881" y="-2923.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1881" y="-2908.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_mlp_4h2_h_gpu4&#45;&gt;l4_qkv_gpu4 -->
<g id="edge1989" class="edge">
<title>l3_mlp_4h2_h_gpu4&#45;&gt;l4_qkv_gpu4</title>
<path fill="none" stroke="black" d="M1876.87,-3040.44C1877.46,-3025.41 1878.12,-3008.62 1878.74,-2992.96"/>
<polygon fill="black" stroke="black" points="1882.24,-2993 1879.14,-2982.87 1875.24,-2992.72 1882.24,-2993"/>
</g>
<!-- l3_mlp_4h2_h_gpu5 -->
<g id="node956" class="node">
<title>l3_mlp_4h2_h_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2081" cy="-3088.75" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2081" y="-3107.55" font-family="Times,serif" font-size="14.00">L3 MLP 4h2h</text>
<text text-anchor="middle" x="2081" y="-3092.55" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2081" y="-3077.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2081" y="-3062.55" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l3_mlp_h2_4h_gpu5&#45;&gt;l3_mlp_4h2_h_gpu5 -->
<g id="edge892" class="edge">
<title>l3_mlp_h2_4h_gpu5&#45;&gt;l3_mlp_4h2_h_gpu5</title>
<path fill="none" stroke="black" d="M2079.72,-3173.56C2079.85,-3165.02 2079.99,-3156.02 2080.12,-3147.23"/>
<polygon fill="black" stroke="black" points="2083.63,-3147.09 2080.28,-3137.03 2076.63,-3146.98 2083.63,-3147.09"/>
</g>
<!-- l4_qkv_gpu5 -->
<g id="node1238" class="node">
<title>l4_qkv_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2083" cy="-2934.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2083" y="-2953.38" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="2083" y="-2938.38" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2083" y="-2923.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2083" y="-2908.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_mlp_4h2_h_gpu5&#45;&gt;l4_qkv_gpu5 -->
<g id="edge1990" class="edge">
<title>l3_mlp_4h2_h_gpu5&#45;&gt;l4_qkv_gpu5</title>
<path fill="none" stroke="black" d="M2081.62,-3040.44C2081.82,-3025.41 2082.04,-3008.62 2082.25,-2992.96"/>
<polygon fill="black" stroke="black" points="2085.75,-2992.91 2082.38,-2982.87 2078.75,-2992.82 2085.75,-2992.91"/>
</g>
<!-- l3_mlp_4h2_h_gpu6 -->
<g id="node958" class="node">
<title>l3_mlp_4h2_h_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2284" cy="-3088.75" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2284" y="-3107.55" font-family="Times,serif" font-size="14.00">L3 MLP 4h2h</text>
<text text-anchor="middle" x="2284" y="-3092.55" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2284" y="-3077.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2284" y="-3062.55" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l3_mlp_h2_4h_gpu6&#45;&gt;l3_mlp_4h2_h_gpu6 -->
<g id="edge894" class="edge">
<title>l3_mlp_h2_4h_gpu6&#45;&gt;l3_mlp_4h2_h_gpu6</title>
<path fill="none" stroke="black" d="M2284,-3173.56C2284,-3165.02 2284,-3156.02 2284,-3147.23"/>
<polygon fill="black" stroke="black" points="2287.5,-3147.03 2284,-3137.03 2280.5,-3147.03 2287.5,-3147.03"/>
</g>
<!-- l4_qkv_gpu6 -->
<g id="node1239" class="node">
<title>l4_qkv_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2285" cy="-2934.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2285" y="-2953.38" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="2285" y="-2938.38" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2285" y="-2923.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2285" y="-2908.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_mlp_4h2_h_gpu6&#45;&gt;l4_qkv_gpu6 -->
<g id="edge1991" class="edge">
<title>l3_mlp_4h2_h_gpu6&#45;&gt;l4_qkv_gpu6</title>
<path fill="none" stroke="black" d="M2284.31,-3040.44C2284.41,-3025.41 2284.52,-3008.62 2284.62,-2992.96"/>
<polygon fill="black" stroke="black" points="2288.12,-2992.89 2284.69,-2982.87 2281.12,-2992.84 2288.12,-2992.89"/>
</g>
<!-- l3_mlp_4h2_h_gpu7 -->
<g id="node960" class="node">
<title>l3_mlp_4h2_h_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2487" cy="-3088.75" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2487" y="-3107.55" font-family="Times,serif" font-size="14.00">L3 MLP 4h2h</text>
<text text-anchor="middle" x="2487" y="-3092.55" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2487" y="-3077.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2487" y="-3062.55" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l3_mlp_h2_4h_gpu7&#45;&gt;l3_mlp_4h2_h_gpu7 -->
<g id="edge896" class="edge">
<title>l3_mlp_h2_4h_gpu7&#45;&gt;l3_mlp_4h2_h_gpu7</title>
<path fill="none" stroke="black" d="M2487,-3173.56C2487,-3165.02 2487,-3156.02 2487,-3147.23"/>
<polygon fill="black" stroke="black" points="2490.5,-3147.03 2487,-3137.03 2483.5,-3147.03 2490.5,-3147.03"/>
</g>
<!-- l4_qkv_gpu7 -->
<g id="node1240" class="node">
<title>l4_qkv_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2487" cy="-2934.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2487" y="-2953.38" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="2487" y="-2938.38" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2487" y="-2923.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2487" y="-2908.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_mlp_4h2_h_gpu7&#45;&gt;l4_qkv_gpu7 -->
<g id="edge1992" class="edge">
<title>l3_mlp_4h2_h_gpu7&#45;&gt;l4_qkv_gpu7</title>
<path fill="none" stroke="black" d="M2487,-3040.44C2487,-3025.41 2487,-3008.62 2487,-2992.96"/>
<polygon fill="black" stroke="black" points="2490.5,-2992.87 2487,-2982.87 2483.5,-2992.87 2490.5,-2992.87"/>
</g>
<!-- l3_mlp_4h2_h_gpu8 -->
<g id="node962" class="node">
<title>l3_mlp_4h2_h_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2689" cy="-3088.75" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2689" y="-3107.55" font-family="Times,serif" font-size="14.00">L3 MLP 4h2h</text>
<text text-anchor="middle" x="2689" y="-3092.55" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2689" y="-3077.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2689" y="-3062.55" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l3_mlp_h2_4h_gpu8&#45;&gt;l3_mlp_4h2_h_gpu8 -->
<g id="edge898" class="edge">
<title>l3_mlp_h2_4h_gpu8&#45;&gt;l3_mlp_4h2_h_gpu8</title>
<path fill="none" stroke="black" d="M2689,-3173.56C2689,-3165.02 2689,-3156.02 2689,-3147.23"/>
<polygon fill="black" stroke="black" points="2692.5,-3147.03 2689,-3137.03 2685.5,-3147.03 2692.5,-3147.03"/>
</g>
<!-- l4_qkv_gpu8 -->
<g id="node1241" class="node">
<title>l4_qkv_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2689" cy="-2934.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2689" y="-2953.38" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="2689" y="-2938.38" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2689" y="-2923.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2689" y="-2908.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_mlp_4h2_h_gpu8&#45;&gt;l4_qkv_gpu8 -->
<g id="edge1993" class="edge">
<title>l3_mlp_4h2_h_gpu8&#45;&gt;l4_qkv_gpu8</title>
<path fill="none" stroke="black" d="M2689,-3040.44C2689,-3025.41 2689,-3008.62 2689,-2992.96"/>
<polygon fill="black" stroke="black" points="2692.5,-2992.87 2689,-2982.87 2685.5,-2992.87 2692.5,-2992.87"/>
</g>
<!-- l3_mlp_4h2_h_gpu9 -->
<g id="node964" class="node">
<title>l3_mlp_4h2_h_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2895" cy="-3088.75" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2895" y="-3107.55" font-family="Times,serif" font-size="14.00">L3 MLP 4h2h</text>
<text text-anchor="middle" x="2895" y="-3092.55" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2895" y="-3077.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2895" y="-3062.55" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l3_mlp_h2_4h_gpu9&#45;&gt;l3_mlp_4h2_h_gpu9 -->
<g id="edge900" class="edge">
<title>l3_mlp_h2_4h_gpu9&#45;&gt;l3_mlp_4h2_h_gpu9</title>
<path fill="none" stroke="black" d="M2896.28,-3173.56C2896.15,-3165.02 2896.01,-3156.02 2895.88,-3147.23"/>
<polygon fill="black" stroke="black" points="2899.37,-3146.98 2895.72,-3137.03 2892.37,-3147.09 2899.37,-3146.98"/>
</g>
<!-- l4_qkv_gpu9 -->
<g id="node1242" class="node">
<title>l4_qkv_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2891" cy="-2934.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2891" y="-2953.38" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="2891" y="-2938.38" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2891" y="-2923.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2891" y="-2908.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_mlp_4h2_h_gpu9&#45;&gt;l4_qkv_gpu9 -->
<g id="edge1994" class="edge">
<title>l3_mlp_4h2_h_gpu9&#45;&gt;l4_qkv_gpu9</title>
<path fill="none" stroke="black" d="M2893.76,-3040.44C2893.36,-3025.41 2892.92,-3008.62 2892.51,-2992.96"/>
<polygon fill="black" stroke="black" points="2896,-2992.77 2892.24,-2982.87 2889.01,-2992.95 2896,-2992.77"/>
</g>
<!-- l3_mlp_4h2_h_gpu10 -->
<g id="node966" class="node">
<title>l3_mlp_4h2_h_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3093" cy="-3088.75" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3093" y="-3107.55" font-family="Times,serif" font-size="14.00">L3 MLP 4h2h</text>
<text text-anchor="middle" x="3093" y="-3092.55" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3093" y="-3077.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3093" y="-3062.55" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l3_mlp_h2_4h_gpu10&#45;&gt;l3_mlp_4h2_h_gpu10 -->
<g id="edge902" class="edge">
<title>l3_mlp_h2_4h_gpu10&#45;&gt;l3_mlp_4h2_h_gpu10</title>
<path fill="none" stroke="black" d="M3097.47,-3173.56C3097.02,-3165.02 3096.54,-3156.02 3096.07,-3147.23"/>
<polygon fill="black" stroke="black" points="3099.55,-3146.83 3095.52,-3137.03 3092.56,-3147.21 3099.55,-3146.83"/>
</g>
<!-- l4_qkv_gpu10 -->
<g id="node1243" class="node">
<title>l4_qkv_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3093" cy="-2934.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3093" y="-2953.38" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="3093" y="-2938.38" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3093" y="-2923.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3093" y="-2908.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_mlp_4h2_h_gpu10&#45;&gt;l4_qkv_gpu10 -->
<g id="edge1995" class="edge">
<title>l3_mlp_4h2_h_gpu10&#45;&gt;l4_qkv_gpu10</title>
<path fill="none" stroke="black" d="M3093,-3040.44C3093,-3025.41 3093,-3008.62 3093,-2992.96"/>
<polygon fill="black" stroke="black" points="3096.5,-2992.87 3093,-2982.87 3089.5,-2992.87 3096.5,-2992.87"/>
</g>
<!-- l3_mlp_4h2_h_gpu11 -->
<g id="node968" class="node">
<title>l3_mlp_4h2_h_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3301" cy="-3088.75" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3301" y="-3107.55" font-family="Times,serif" font-size="14.00">L3 MLP 4h2h</text>
<text text-anchor="middle" x="3301" y="-3092.55" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3301" y="-3077.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3301" y="-3062.55" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l3_mlp_h2_4h_gpu11&#45;&gt;l3_mlp_4h2_h_gpu11 -->
<g id="edge904" class="edge">
<title>l3_mlp_h2_4h_gpu11&#45;&gt;l3_mlp_4h2_h_gpu11</title>
<path fill="none" stroke="black" d="M3303.56,-3173.56C3303.3,-3165.02 3303.02,-3156.02 3302.75,-3147.23"/>
<polygon fill="black" stroke="black" points="3306.25,-3146.92 3302.44,-3137.03 3299.25,-3147.14 3306.25,-3146.92"/>
</g>
<!-- l4_qkv_gpu11 -->
<g id="node1244" class="node">
<title>l4_qkv_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3295" cy="-2934.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3295" y="-2953.38" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="3295" y="-2938.38" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3295" y="-2923.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3295" y="-2908.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_mlp_4h2_h_gpu11&#45;&gt;l4_qkv_gpu11 -->
<g id="edge1996" class="edge">
<title>l3_mlp_4h2_h_gpu11&#45;&gt;l4_qkv_gpu11</title>
<path fill="none" stroke="black" d="M3299.13,-3040.44C3298.54,-3025.41 3297.88,-3008.62 3297.26,-2992.96"/>
<polygon fill="black" stroke="black" points="3300.76,-2992.72 3296.86,-2982.87 3293.76,-2993 3300.76,-2992.72"/>
</g>
<!-- l3_mlp_4h2_h_gpu12 -->
<g id="node970" class="node">
<title>l3_mlp_4h2_h_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3500" cy="-3088.75" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3500" y="-3107.55" font-family="Times,serif" font-size="14.00">L3 MLP 4h2h</text>
<text text-anchor="middle" x="3500" y="-3092.55" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3500" y="-3077.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3500" y="-3062.55" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l3_mlp_h2_4h_gpu12&#45;&gt;l3_mlp_4h2_h_gpu12 -->
<g id="edge906" class="edge">
<title>l3_mlp_h2_4h_gpu12&#45;&gt;l3_mlp_4h2_h_gpu12</title>
<path fill="none" stroke="black" d="M3506.39,-3173.56C3505.74,-3165.02 3505.05,-3156.02 3504.38,-3147.23"/>
<polygon fill="black" stroke="black" points="3507.86,-3146.74 3503.6,-3137.03 3500.88,-3147.27 3507.86,-3146.74"/>
</g>
<!-- l4_qkv_gpu12 -->
<g id="node1245" class="node">
<title>l4_qkv_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3497" cy="-2934.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3497" y="-2953.38" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="3497" y="-2938.38" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3497" y="-2923.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3497" y="-2908.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_mlp_4h2_h_gpu12&#45;&gt;l4_qkv_gpu12 -->
<g id="edge1997" class="edge">
<title>l3_mlp_4h2_h_gpu12&#45;&gt;l4_qkv_gpu12</title>
<path fill="none" stroke="black" d="M3499.07,-3040.44C3498.77,-3025.41 3498.44,-3008.62 3498.13,-2992.96"/>
<polygon fill="black" stroke="black" points="3501.63,-2992.79 3497.93,-2982.87 3494.63,-2992.93 3501.63,-2992.79"/>
</g>
<!-- l3_mlp_4h2_h_gpu13 -->
<g id="node972" class="node">
<title>l3_mlp_4h2_h_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3702" cy="-3088.75" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3702" y="-3107.55" font-family="Times,serif" font-size="14.00">L3 MLP 4h2h</text>
<text text-anchor="middle" x="3702" y="-3092.55" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3702" y="-3077.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3702" y="-3062.55" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l3_mlp_h2_4h_gpu13&#45;&gt;l3_mlp_4h2_h_gpu13 -->
<g id="edge908" class="edge">
<title>l3_mlp_h2_4h_gpu13&#45;&gt;l3_mlp_4h2_h_gpu13</title>
<path fill="none" stroke="black" d="M3710.31,-3173.56C3709.46,-3165.02 3708.57,-3156.02 3707.7,-3147.23"/>
<polygon fill="black" stroke="black" points="3711.16,-3146.64 3706.69,-3137.03 3704.19,-3147.33 3711.16,-3146.64"/>
</g>
<!-- l4_qkv_gpu13 -->
<g id="node1246" class="node">
<title>l4_qkv_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3699" cy="-2934.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3699" y="-2953.38" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="3699" y="-2938.38" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3699" y="-2923.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3699" y="-2908.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_mlp_4h2_h_gpu13&#45;&gt;l4_qkv_gpu13 -->
<g id="edge1998" class="edge">
<title>l3_mlp_4h2_h_gpu13&#45;&gt;l4_qkv_gpu13</title>
<path fill="none" stroke="black" d="M3701.07,-3040.44C3700.77,-3025.41 3700.44,-3008.62 3700.13,-2992.96"/>
<polygon fill="black" stroke="black" points="3703.63,-2992.79 3699.93,-2982.87 3696.63,-2992.93 3703.63,-2992.79"/>
</g>
<!-- l3_mlp_4h2_h_gpu14 -->
<g id="node974" class="node">
<title>l3_mlp_4h2_h_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3908" cy="-3088.75" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3908" y="-3107.55" font-family="Times,serif" font-size="14.00">L3 MLP 4h2h</text>
<text text-anchor="middle" x="3908" y="-3092.55" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3908" y="-3077.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3908" y="-3062.55" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l3_mlp_h2_4h_gpu14&#45;&gt;l3_mlp_4h2_h_gpu14 -->
<g id="edge910" class="edge">
<title>l3_mlp_h2_4h_gpu14&#45;&gt;l3_mlp_4h2_h_gpu14</title>
<path fill="none" stroke="black" d="M3916.95,-3173.56C3916.03,-3165.02 3915.07,-3156.02 3914.14,-3147.23"/>
<polygon fill="black" stroke="black" points="3917.59,-3146.61 3913.05,-3137.03 3910.63,-3147.35 3917.59,-3146.61"/>
</g>
<!-- l4_qkv_gpu14 -->
<g id="node1247" class="node">
<title>l4_qkv_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3901" cy="-2934.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3901" y="-2953.38" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="3901" y="-2938.38" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3901" y="-2923.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3901" y="-2908.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_mlp_4h2_h_gpu14&#45;&gt;l4_qkv_gpu14 -->
<g id="edge1999" class="edge">
<title>l3_mlp_4h2_h_gpu14&#45;&gt;l4_qkv_gpu14</title>
<path fill="none" stroke="black" d="M3905.82,-3040.44C3905.13,-3025.41 3904.36,-3008.62 3903.64,-2992.96"/>
<polygon fill="black" stroke="black" points="3907.13,-2992.69 3903.18,-2982.87 3900.14,-2993.02 3907.13,-2992.69"/>
</g>
<!-- l3_mlp_4h2_h_gpu15 -->
<g id="node976" class="node">
<title>l3_mlp_4h2_h_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4114" cy="-3088.75" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="4114" y="-3107.55" font-family="Times,serif" font-size="14.00">L3 MLP 4h2h</text>
<text text-anchor="middle" x="4114" y="-3092.55" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4114" y="-3077.55" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="4114" y="-3062.55" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l3_mlp_h2_4h_gpu15&#45;&gt;l3_mlp_4h2_h_gpu15 -->
<g id="edge912" class="edge">
<title>l3_mlp_h2_4h_gpu15&#45;&gt;l3_mlp_4h2_h_gpu15</title>
<path fill="none" stroke="black" d="M4124.22,-3173.56C4123.18,-3165.02 4122.08,-3156.02 4121.01,-3147.23"/>
<polygon fill="black" stroke="black" points="4124.45,-3146.54 4119.77,-3137.03 4117.5,-3147.38 4124.45,-3146.54"/>
</g>
<!-- l4_qkv_gpu15 -->
<g id="node1248" class="node">
<title>l4_qkv_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4103" cy="-2934.58" rx="92" ry="48.17"/>
<text text-anchor="middle" x="4103" y="-2953.38" font-family="Times,serif" font-size="14.00">L4 QKV Proj</text>
<text text-anchor="middle" x="4103" y="-2938.38" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4103" y="-2923.38" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="4103" y="-2908.38" font-family="Times,serif" font-size="14.00">3*d_model/16</text>
</g>
<!-- l3_mlp_4h2_h_gpu15&#45;&gt;l4_qkv_gpu15 -->
<g id="edge2000" class="edge">
<title>l3_mlp_4h2_h_gpu15&#45;&gt;l4_qkv_gpu15</title>
<path fill="none" stroke="black" d="M4110.58,-3040.44C4109.49,-3025.41 4108.28,-3008.62 4107.15,-2992.96"/>
<polygon fill="black" stroke="black" points="4110.63,-2992.59 4106.42,-2982.87 4103.65,-2993.09 4110.63,-2992.59"/>
</g>
<!-- l4_attn_stage0_gpu0 -->
<g id="node977" class="node">
<title>l4_attn_stage0_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1174" cy="-2791" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1174" y="-2802.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="1174" y="-2787.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1174" y="-2772.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu0 -->
<g id="node993" class="node">
<title>l4_attn_stage1_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1174" cy="-2644" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1174" y="-2655.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="1174" y="-2640.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1174" y="-2625.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu0&#45;&gt;l4_attn_stage1_gpu0 -->
<g id="edge929" class="edge">
<title>l4_attn_stage0_gpu0&#45;&gt;l4_attn_stage1_gpu0</title>
<path fill="none" stroke="black" d="M1174,-2753.41C1174,-2734.69 1174,-2711.7 1174,-2691.72"/>
<polygon fill="black" stroke="black" points="1177.5,-2691.58 1174,-2681.58 1170.5,-2691.58 1177.5,-2691.58"/>
</g>
<!-- l4_attn_stage1_gpu[next_gpu] -->
<g id="node1358" class="node">
<title>l4_attn_stage1_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4361" cy="-2644" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4361" y="-2640.3" font-family="Times,serif" font-size="14.00">l4_attn_stage1_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage0_gpu0&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2001" class="edge">
<title>l4_attn_stage0_gpu0&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1227.29,-2761C1241.43,-2754.66 1256.95,-2748.85 1272,-2745.5 1501.73,-2694.36 3154.66,-2723.05 3390,-2720.5 3434.94,-2720.01 4154.97,-2721.53 4199,-2712.5 4242.87,-2703.5 4289.77,-2682.58 4321.76,-2666.4"/>
<polygon fill="red" stroke="red" points="4323.49,-2669.45 4330.78,-2661.76 4320.28,-2663.22 4323.49,-2669.45"/>
<text text-anchor="middle" x="3421.5" y="-2724.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu1 -->
<g id="node978" class="node">
<title>l4_attn_stage0_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1369" cy="-2791" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1369" y="-2802.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="1369" y="-2787.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1369" y="-2772.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu1 -->
<g id="node994" class="node">
<title>l4_attn_stage1_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1369" cy="-2644" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1369" y="-2655.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="1369" y="-2640.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1369" y="-2625.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu1&#45;&gt;l4_attn_stage1_gpu1 -->
<g id="edge930" class="edge">
<title>l4_attn_stage0_gpu1&#45;&gt;l4_attn_stage1_gpu1</title>
<path fill="none" stroke="black" d="M1369,-2753.41C1369,-2734.69 1369,-2711.7 1369,-2691.72"/>
<polygon fill="black" stroke="black" points="1372.5,-2691.58 1369,-2681.58 1365.5,-2691.58 1372.5,-2691.58"/>
</g>
<!-- l4_attn_stage0_gpu1&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2002" class="edge">
<title>l4_attn_stage0_gpu1&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1422.28,-2760.93C1436.41,-2754.59 1451.94,-2748.8 1467,-2745.5 1521,-2733.67 3404.82,-2753.76 3457,-2735.5 3467.15,-2731.95 3465.86,-2724.08 3476,-2720.5 3513.87,-2707.12 4159.66,-2720.6 4199,-2712.5 4242.87,-2703.47 4289.77,-2682.56 4321.76,-2666.38"/>
<polygon fill="red" stroke="red" points="4323.48,-2669.43 4330.78,-2661.75 4320.28,-2663.21 4323.48,-2669.43"/>
<text text-anchor="middle" x="3507.5" y="-2724.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu2 -->
<g id="node979" class="node">
<title>l4_attn_stage0_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1564" cy="-2791" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1564" y="-2802.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="1564" y="-2787.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1564" y="-2772.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu2 -->
<g id="node995" class="node">
<title>l4_attn_stage1_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1564" cy="-2644" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1564" y="-2655.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="1564" y="-2640.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1564" y="-2625.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu2&#45;&gt;l4_attn_stage1_gpu2 -->
<g id="edge931" class="edge">
<title>l4_attn_stage0_gpu2&#45;&gt;l4_attn_stage1_gpu2</title>
<path fill="none" stroke="black" d="M1564,-2753.41C1564,-2734.69 1564,-2711.7 1564,-2691.72"/>
<polygon fill="black" stroke="black" points="1567.5,-2691.58 1564,-2681.58 1560.5,-2691.58 1567.5,-2691.58"/>
</g>
<!-- l4_attn_stage0_gpu2&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2003" class="edge">
<title>l4_attn_stage0_gpu2&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1617.28,-2760.93C1631.41,-2754.6 1646.94,-2748.8 1662,-2745.5 1713.04,-2734.31 3493.68,-2752.77 3543,-2735.5 3553.15,-2731.94 3551.86,-2724.09 3562,-2720.5 3595.36,-2708.68 4164.34,-2719.66 4199,-2712.5 4242.86,-2703.44 4289.76,-2682.53 4321.75,-2666.37"/>
<polygon fill="red" stroke="red" points="4323.48,-2669.42 4330.77,-2661.73 4320.28,-2663.19 4323.48,-2669.42"/>
<text text-anchor="middle" x="3593.5" y="-2724.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu3 -->
<g id="node980" class="node">
<title>l4_attn_stage0_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1759" cy="-2791" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1759" y="-2802.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="1759" y="-2787.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1759" y="-2772.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu3 -->
<g id="node996" class="node">
<title>l4_attn_stage1_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1759" cy="-2644" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1759" y="-2655.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="1759" y="-2640.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1759" y="-2625.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu3&#45;&gt;l4_attn_stage1_gpu3 -->
<g id="edge932" class="edge">
<title>l4_attn_stage0_gpu3&#45;&gt;l4_attn_stage1_gpu3</title>
<path fill="none" stroke="black" d="M1759,-2753.41C1759,-2734.69 1759,-2711.7 1759,-2691.72"/>
<polygon fill="black" stroke="black" points="1762.5,-2691.58 1759,-2681.58 1755.5,-2691.58 1762.5,-2691.58"/>
</g>
<!-- l4_attn_stage0_gpu3&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2004" class="edge">
<title>l4_attn_stage0_gpu3&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1812.28,-2760.94C1826.41,-2754.6 1841.94,-2748.8 1857,-2745.5 1905.08,-2734.95 3582.55,-2751.77 3629,-2735.5 3639.15,-2731.94 3637.86,-2724.1 3648,-2720.5 3676.85,-2710.25 4169.02,-2718.72 4199,-2712.5 4242.85,-2703.4 4289.75,-2682.49 4321.75,-2666.34"/>
<polygon fill="red" stroke="red" points="4323.47,-2669.39 4330.77,-2661.71 4320.27,-2663.17 4323.47,-2669.39"/>
<text text-anchor="middle" x="3679.5" y="-2724.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu4 -->
<g id="node981" class="node">
<title>l4_attn_stage0_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1954" cy="-2791" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1954" y="-2802.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="1954" y="-2787.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1954" y="-2772.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu4 -->
<g id="node997" class="node">
<title>l4_attn_stage1_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1954" cy="-2644" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1954" y="-2655.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="1954" y="-2640.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1954" y="-2625.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu4&#45;&gt;l4_attn_stage1_gpu4 -->
<g id="edge933" class="edge">
<title>l4_attn_stage0_gpu4&#45;&gt;l4_attn_stage1_gpu4</title>
<path fill="none" stroke="black" d="M1954,-2753.41C1954,-2734.69 1954,-2711.7 1954,-2691.72"/>
<polygon fill="black" stroke="black" points="1957.5,-2691.58 1954,-2681.58 1950.5,-2691.58 1957.5,-2691.58"/>
</g>
<!-- l4_attn_stage0_gpu4&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2005" class="edge">
<title>l4_attn_stage0_gpu4&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2007.28,-2760.94C2021.41,-2754.6 2036.94,-2748.81 2052,-2745.5 2097.12,-2735.59 3671.41,-2750.78 3715,-2735.5 3725.15,-2731.94 3723.87,-2724.12 3734,-2720.5 3782.67,-2703.13 4148.42,-2723.07 4199,-2712.5 4242.84,-2703.34 4289.74,-2682.44 4321.74,-2666.31"/>
<polygon fill="red" stroke="red" points="4323.46,-2669.36 4330.76,-2661.69 4320.27,-2663.13 4323.46,-2669.36"/>
<text text-anchor="middle" x="3765.5" y="-2724.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu5 -->
<g id="node982" class="node">
<title>l4_attn_stage0_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2149" cy="-2791" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2149" y="-2802.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="2149" y="-2787.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2149" y="-2772.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu5 -->
<g id="node998" class="node">
<title>l4_attn_stage1_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2149" cy="-2644" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2149" y="-2655.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="2149" y="-2640.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2149" y="-2625.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu5&#45;&gt;l4_attn_stage1_gpu5 -->
<g id="edge934" class="edge">
<title>l4_attn_stage0_gpu5&#45;&gt;l4_attn_stage1_gpu5</title>
<path fill="none" stroke="black" d="M2149,-2753.41C2149,-2734.69 2149,-2711.7 2149,-2691.72"/>
<polygon fill="black" stroke="black" points="2152.5,-2691.58 2149,-2681.58 2145.5,-2691.58 2152.5,-2691.58"/>
</g>
<!-- l4_attn_stage0_gpu5&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2006" class="edge">
<title>l4_attn_stage0_gpu5&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2202.28,-2760.95C2216.41,-2754.61 2231.94,-2748.81 2247,-2745.5 2289.16,-2736.23 3760.27,-2749.79 3801,-2735.5 3811.15,-2731.94 3809.87,-2724.14 3820,-2720.5 3859.64,-2706.27 4157.79,-2721.2 4199,-2712.5 4242.82,-2703.25 4289.73,-2682.37 4321.73,-2666.26"/>
<polygon fill="red" stroke="red" points="4323.45,-2669.32 4330.75,-2661.65 4320.26,-2663.09 4323.45,-2669.32"/>
<text text-anchor="middle" x="3851.5" y="-2724.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu6 -->
<g id="node983" class="node">
<title>l4_attn_stage0_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2344" cy="-2791" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2344" y="-2802.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="2344" y="-2787.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2344" y="-2772.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu6 -->
<g id="node999" class="node">
<title>l4_attn_stage1_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2344" cy="-2644" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2344" y="-2655.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="2344" y="-2640.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2344" y="-2625.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu6&#45;&gt;l4_attn_stage1_gpu6 -->
<g id="edge935" class="edge">
<title>l4_attn_stage0_gpu6&#45;&gt;l4_attn_stage1_gpu6</title>
<path fill="none" stroke="black" d="M2344,-2753.41C2344,-2734.69 2344,-2711.7 2344,-2691.72"/>
<polygon fill="black" stroke="black" points="2347.5,-2691.58 2344,-2681.58 2340.5,-2691.58 2347.5,-2691.58"/>
</g>
<!-- l4_attn_stage0_gpu6&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2007" class="edge">
<title>l4_attn_stage0_gpu6&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2397.28,-2760.95C2411.41,-2754.61 2426.94,-2748.81 2442,-2745.5 2481.2,-2736.87 3849.13,-2748.8 3887,-2735.5 3897.15,-2731.94 3895.89,-2724.17 3906,-2720.5 3936.62,-2709.4 4167.15,-2719.32 4199,-2712.5 4242.66,-2703.15 4289.41,-2682.39 4321.42,-2666.34"/>
<polygon fill="red" stroke="red" points="4323.12,-2669.4 4330.45,-2661.74 4319.95,-2663.16 4323.12,-2669.4"/>
<text text-anchor="middle" x="3937.5" y="-2724.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu7 -->
<g id="node984" class="node">
<title>l4_attn_stage0_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2539" cy="-2791" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2539" y="-2802.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="2539" y="-2787.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2539" y="-2772.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu7 -->
<g id="node1000" class="node">
<title>l4_attn_stage1_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2539" cy="-2644" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2539" y="-2655.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="2539" y="-2640.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2539" y="-2625.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu7&#45;&gt;l4_attn_stage1_gpu7 -->
<g id="edge936" class="edge">
<title>l4_attn_stage0_gpu7&#45;&gt;l4_attn_stage1_gpu7</title>
<path fill="none" stroke="black" d="M2539,-2753.41C2539,-2734.69 2539,-2711.7 2539,-2691.72"/>
<polygon fill="black" stroke="black" points="2542.5,-2691.58 2539,-2681.58 2535.5,-2691.58 2542.5,-2691.58"/>
</g>
<!-- l4_attn_stage0_gpu7&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2008" class="edge">
<title>l4_attn_stage0_gpu7&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2592.28,-2760.96C2606.42,-2754.62 2621.95,-2748.82 2637,-2745.5 2673.24,-2737.51 3937.99,-2747.8 3973,-2735.5 3983.15,-2731.93 3981.91,-2724.22 3992,-2720.5 4035.19,-2704.57 4154.04,-2722.4 4199,-2712.5 4242.6,-2702.9 4289.37,-2682.17 4321.39,-2666.2"/>
<polygon fill="red" stroke="red" points="4323.08,-2669.27 4330.42,-2661.63 4319.92,-2663.02 4323.08,-2669.27"/>
<text text-anchor="middle" x="4023.5" y="-2724.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu8 -->
<g id="node985" class="node">
<title>l4_attn_stage0_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2734" cy="-2791" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2734" y="-2802.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="2734" y="-2787.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2734" y="-2772.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu8 -->
<g id="node1001" class="node">
<title>l4_attn_stage1_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2734" cy="-2644" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2734" y="-2655.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="2734" y="-2640.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2734" y="-2625.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu8&#45;&gt;l4_attn_stage1_gpu8 -->
<g id="edge937" class="edge">
<title>l4_attn_stage0_gpu8&#45;&gt;l4_attn_stage1_gpu8</title>
<path fill="none" stroke="black" d="M2734,-2753.41C2734,-2734.69 2734,-2711.7 2734,-2691.72"/>
<polygon fill="black" stroke="black" points="2737.5,-2691.58 2734,-2681.58 2730.5,-2691.58 2737.5,-2691.58"/>
</g>
<!-- l4_attn_stage0_gpu8&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2009" class="edge">
<title>l4_attn_stage0_gpu8&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2787.28,-2760.96C2801.42,-2754.62 2816.95,-2748.82 2832,-2745.5 2898.57,-2730.81 3994.69,-2758.12 4059,-2735.5 4069.15,-2731.93 4067.96,-2724.36 4078,-2720.5 4128.3,-2701.15 4146.53,-2724.81 4199,-2712.5 4242.2,-2702.37 4288.67,-2681.92 4320.71,-2666.17"/>
<polygon fill="red" stroke="red" points="4322.38,-2669.25 4329.77,-2661.66 4319.25,-2662.99 4322.38,-2669.25"/>
<text text-anchor="middle" x="4109.5" y="-2724.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu9 -->
<g id="node986" class="node">
<title>l4_attn_stage0_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2929" cy="-2791" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2929" y="-2802.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="2929" y="-2787.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2929" y="-2772.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu9 -->
<g id="node1002" class="node">
<title>l4_attn_stage1_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2929" cy="-2644" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2929" y="-2655.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="2929" y="-2640.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2929" y="-2625.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu9&#45;&gt;l4_attn_stage1_gpu9 -->
<g id="edge938" class="edge">
<title>l4_attn_stage0_gpu9&#45;&gt;l4_attn_stage1_gpu9</title>
<path fill="none" stroke="black" d="M2929,-2753.41C2929,-2734.69 2929,-2711.7 2929,-2691.72"/>
<polygon fill="black" stroke="black" points="2932.5,-2691.58 2929,-2681.58 2925.5,-2691.58 2932.5,-2691.58"/>
</g>
<!-- l4_attn_stage0_gpu9&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2010" class="edge">
<title>l4_attn_stage0_gpu9&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2982.28,-2760.97C2996.42,-2754.63 3011.95,-2748.83 3027,-2745.5 3087.65,-2732.09 4086.41,-2756.13 4145,-2735.5 4155.15,-2731.93 4154.3,-2725.15 4164,-2720.5 4178.39,-2713.61 4183.8,-2717.36 4199,-2712.5 4239.94,-2699.4 4284.95,-2680.24 4317.12,-2665.67"/>
<polygon fill="red" stroke="red" points="4318.61,-2668.84 4326.25,-2661.51 4315.7,-2662.47 4318.61,-2668.84"/>
<text text-anchor="middle" x="4195.5" y="-2724.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu10 -->
<g id="node987" class="node">
<title>l4_attn_stage0_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3124" cy="-2791" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3124" y="-2802.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="3124" y="-2787.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3124" y="-2772.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu10 -->
<g id="node1003" class="node">
<title>l4_attn_stage1_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3124" cy="-2644" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3124" y="-2655.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="3124" y="-2640.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3124" y="-2625.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu10&#45;&gt;l4_attn_stage1_gpu10 -->
<g id="edge939" class="edge">
<title>l4_attn_stage0_gpu10&#45;&gt;l4_attn_stage1_gpu10</title>
<path fill="none" stroke="black" d="M3124,-2753.41C3124,-2734.69 3124,-2711.7 3124,-2691.72"/>
<polygon fill="black" stroke="black" points="3127.5,-2691.58 3124,-2681.58 3120.5,-2691.58 3127.5,-2691.58"/>
</g>
<!-- l4_attn_stage0_gpu10&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2011" class="edge">
<title>l4_attn_stage0_gpu10&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3177.29,-2760.98C3191.42,-2754.64 3206.95,-2748.83 3222,-2745.5 3276.73,-2733.37 4178.13,-2754.15 4231,-2735.5 4241.15,-2731.92 4241.32,-2726.86 4250,-2720.5 4275.22,-2702 4304.5,-2682.15 4326.65,-2667.45"/>
<polygon fill="red" stroke="red" points="4328.66,-2670.32 4335.07,-2661.88 4324.8,-2664.48 4328.66,-2670.32"/>
<text text-anchor="middle" x="4281.5" y="-2724.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu11 -->
<g id="node988" class="node">
<title>l4_attn_stage0_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3319" cy="-2791" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3319" y="-2802.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="3319" y="-2787.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3319" y="-2772.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu11 -->
<g id="node1004" class="node">
<title>l4_attn_stage1_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3319" cy="-2644" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3319" y="-2655.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="3319" y="-2640.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3319" y="-2625.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu11&#45;&gt;l4_attn_stage1_gpu11 -->
<g id="edge940" class="edge">
<title>l4_attn_stage0_gpu11&#45;&gt;l4_attn_stage1_gpu11</title>
<path fill="none" stroke="black" d="M3319,-2753.41C3319,-2734.69 3319,-2711.7 3319,-2691.72"/>
<polygon fill="black" stroke="black" points="3322.5,-2691.58 3319,-2681.58 3315.5,-2691.58 3322.5,-2691.58"/>
</g>
<!-- l4_attn_stage0_gpu11&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2012" class="edge">
<title>l4_attn_stage0_gpu11&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3372.29,-2760.99C3386.42,-2754.65 3401.95,-2748.84 3417,-2745.5 3441.41,-2740.08 4295.88,-2748.88 4317,-2735.5 4338.94,-2721.6 4350.24,-2693.32 4355.85,-2672.05"/>
<polygon fill="red" stroke="red" points="4359.27,-2672.81 4358.18,-2662.27 4352.46,-2671.19 4359.27,-2672.81"/>
<text text-anchor="middle" x="4363.5" y="-2724.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu12 -->
<g id="node989" class="node">
<title>l4_attn_stage0_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3514" cy="-2791" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3514" y="-2802.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="3514" y="-2787.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3514" y="-2772.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu12 -->
<g id="node1005" class="node">
<title>l4_attn_stage1_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3514" cy="-2644" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3514" y="-2655.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="3514" y="-2640.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3514" y="-2625.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu12&#45;&gt;l4_attn_stage1_gpu12 -->
<g id="edge941" class="edge">
<title>l4_attn_stage0_gpu12&#45;&gt;l4_attn_stage1_gpu12</title>
<path fill="none" stroke="black" d="M3458.85,-2761.54C3445.43,-2755.5 3430.93,-2749.69 3417,-2745.5 3403.22,-2741.35 3362.36,-2746.44 3353,-2735.5 3318.08,-2694.7 3358.79,-2734.82 3417,-2712.5 3434.78,-2705.68 3452.42,-2694.94 3467.68,-2684.01"/>
<polygon fill="black" stroke="black" points="3469.93,-2686.69 3475.9,-2677.94 3465.77,-2681.06 3469.93,-2686.69"/>
</g>
<!-- l4_attn_stage0_gpu12&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2013" class="edge">
<title>l4_attn_stage0_gpu12&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3567.29,-2761.01C3581.43,-2754.67 3596.95,-2748.86 3612,-2745.5 3633.45,-2740.72 4387.56,-2751.14 4403,-2735.5 4421.16,-2717.11 4403.89,-2689.42 4386.31,-2669.51"/>
<polygon fill="red" stroke="red" points="4388.75,-2666.99 4379.38,-2662.03 4383.61,-2671.75 4388.75,-2666.99"/>
<text text-anchor="middle" x="4441.5" y="-2724.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu13 -->
<g id="node990" class="node">
<title>l4_attn_stage0_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3709" cy="-2791" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3709" y="-2802.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="3709" y="-2787.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3709" y="-2772.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu13 -->
<g id="node1006" class="node">
<title>l4_attn_stage1_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3709" cy="-2644" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3709" y="-2655.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="3709" y="-2640.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3709" y="-2625.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu13&#45;&gt;l4_attn_stage1_gpu13 -->
<g id="edge942" class="edge">
<title>l4_attn_stage0_gpu13&#45;&gt;l4_attn_stage1_gpu13</title>
<path fill="none" stroke="black" d="M3655.7,-2761.06C3641.85,-2754.8 3626.69,-2749.01 3612,-2745.5 3598.37,-2742.24 3369.71,-2745.6 3360,-2735.5 3355.38,-2730.69 3355.36,-2725.29 3360,-2720.5 3369.75,-2710.44 3598.7,-2716.9 3612,-2712.5 3630.4,-2706.4 3648.44,-2695.61 3663.87,-2684.42"/>
<polygon fill="black" stroke="black" points="3666.27,-2686.99 3672.16,-2678.19 3662.06,-2681.4 3666.27,-2686.99"/>
</g>
<!-- l4_attn_stage0_gpu13&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2014" class="edge">
<title>l4_attn_stage0_gpu13&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3762.3,-2761.03C3776.43,-2754.69 3791.96,-2748.87 3807,-2745.5 3825.49,-2741.36 4475.7,-2748.99 4489,-2735.5 4517.36,-2706.72 4469.79,-2680.89 4424.82,-2664.26"/>
<polygon fill="red" stroke="red" points="4425.88,-2660.93 4415.29,-2660.86 4423.53,-2667.52 4425.88,-2660.93"/>
<text text-anchor="middle" x="4528.5" y="-2724.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu14 -->
<g id="node991" class="node">
<title>l4_attn_stage0_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3904" cy="-2791" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3904" y="-2802.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="3904" y="-2787.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3904" y="-2772.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu14 -->
<g id="node1007" class="node">
<title>l4_attn_stage1_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3904" cy="-2644" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3904" y="-2655.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="3904" y="-2640.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3904" y="-2625.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu14&#45;&gt;l4_attn_stage1_gpu14 -->
<g id="edge943" class="edge">
<title>l4_attn_stage0_gpu14&#45;&gt;l4_attn_stage1_gpu14</title>
<path fill="none" stroke="black" d="M3850.74,-2760.88C3836.89,-2754.63 3821.71,-2748.89 3807,-2745.5 3783.17,-2740.01 3384.09,-2752.98 3367,-2735.5 3362.34,-2730.73 3362.33,-2725.26 3367,-2720.5 3375.56,-2711.78 3795.37,-2716.26 3807,-2712.5 3825.45,-2706.53 3843.49,-2695.77 3858.92,-2684.57"/>
<polygon fill="black" stroke="black" points="3861.32,-2687.14 3867.2,-2678.33 3857.11,-2681.55 3861.32,-2687.14"/>
</g>
<!-- l4_attn_stage0_gpu14&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2015" class="edge">
<title>l4_attn_stage0_gpu14&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3957.3,-2761.06C3971.44,-2754.72 3986.96,-2748.89 4002,-2745.5 4017.53,-2742 4563.84,-2746.85 4575,-2735.5 4615.03,-2694.76 4545.32,-2671.4 4475.01,-2658.66"/>
<polygon fill="red" stroke="red" points="4475.55,-2655.2 4465.1,-2656.93 4474.35,-2662.1 4475.55,-2655.2"/>
<text text-anchor="middle" x="4615.5" y="-2724.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage0_gpu15 -->
<g id="node992" class="node">
<title>l4_attn_stage0_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4099" cy="-2791" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4099" y="-2802.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage0</text>
<text text-anchor="middle" x="4099" y="-2787.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4099" y="-2772.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu15 -->
<g id="node1008" class="node">
<title>l4_attn_stage1_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4099" cy="-2644" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4099" y="-2655.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage1</text>
<text text-anchor="middle" x="4099" y="-2640.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4099" y="-2625.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage0_gpu15&#45;&gt;l4_attn_stage1_gpu15 -->
<g id="edge944" class="edge">
<title>l4_attn_stage0_gpu15&#45;&gt;l4_attn_stage1_gpu15</title>
<path fill="none" stroke="black" d="M4046.02,-2760.93C4032.09,-2754.63 4016.82,-2748.86 4002,-2745.5 3984.99,-2741.64 3386.24,-2747.93 3374,-2735.5 3369.32,-2730.75 3369.32,-2725.24 3374,-2720.5 3386.26,-2708.09 3985.39,-2717.83 4002,-2712.5 4020.46,-2706.58 4038.51,-2695.83 4053.94,-2684.63"/>
<polygon fill="black" stroke="black" points="4056.34,-2687.2 4062.22,-2678.38 4052.13,-2681.61 4056.34,-2687.2"/>
</g>
<!-- l4_attn_stage0_gpu15&#45;&gt;l4_attn_stage1_gpu[next_gpu] -->
<g id="edge2016" class="edge">
<title>l4_attn_stage0_gpu15&#45;&gt;l4_attn_stage1_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4187.34,-2787.82C4337.61,-2783.19 4629.83,-2769.84 4661,-2735.5 4713.01,-2678.2 4614.61,-2656.64 4516.88,-2648.79"/>
<polygon fill="red" stroke="red" points="4517.06,-2645.29 4506.82,-2648.03 4516.53,-2652.27 4517.06,-2645.29"/>
<text text-anchor="middle" x="4700.5" y="-2724.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu0 -->
<g id="node1009" class="node">
<title>l4_attn_stage2_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1174" cy="-2497" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1174" y="-2508.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="1174" y="-2493.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1174" y="-2478.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu0&#45;&gt;l4_attn_stage2_gpu0 -->
<g id="edge945" class="edge">
<title>l4_attn_stage1_gpu0&#45;&gt;l4_attn_stage2_gpu0</title>
<path fill="none" stroke="black" d="M1174,-2606.41C1174,-2587.69 1174,-2564.7 1174,-2544.72"/>
<polygon fill="black" stroke="black" points="1177.5,-2544.58 1174,-2534.58 1170.5,-2544.58 1177.5,-2544.58"/>
</g>
<!-- l4_attn_stage2_gpu[next_gpu] -->
<g id="node1359" class="node">
<title>l4_attn_stage2_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4361" cy="-2497" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4361" y="-2493.3" font-family="Times,serif" font-size="14.00">l4_attn_stage2_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage1_gpu0&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2017" class="edge">
<title>l4_attn_stage1_gpu0&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1227.29,-2614C1241.43,-2607.66 1256.95,-2601.85 1272,-2598.5 1501.73,-2547.36 3154.66,-2576.05 3390,-2573.5 3434.94,-2573.01 4154.97,-2574.53 4199,-2565.5 4242.87,-2556.5 4289.77,-2535.58 4321.76,-2519.4"/>
<polygon fill="red" stroke="red" points="4323.49,-2522.45 4330.78,-2514.76 4320.28,-2516.22 4323.49,-2522.45"/>
<text text-anchor="middle" x="3421.5" y="-2577.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu1 -->
<g id="node1010" class="node">
<title>l4_attn_stage2_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1369" cy="-2497" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1369" y="-2508.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="1369" y="-2493.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1369" y="-2478.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu1&#45;&gt;l4_attn_stage2_gpu1 -->
<g id="edge946" class="edge">
<title>l4_attn_stage1_gpu1&#45;&gt;l4_attn_stage2_gpu1</title>
<path fill="none" stroke="black" d="M1369,-2606.41C1369,-2587.69 1369,-2564.7 1369,-2544.72"/>
<polygon fill="black" stroke="black" points="1372.5,-2544.58 1369,-2534.58 1365.5,-2544.58 1372.5,-2544.58"/>
</g>
<!-- l4_attn_stage1_gpu1&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2018" class="edge">
<title>l4_attn_stage1_gpu1&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1422.28,-2613.93C1436.41,-2607.59 1451.94,-2601.8 1467,-2598.5 1521,-2586.67 3404.82,-2606.76 3457,-2588.5 3467.15,-2584.95 3465.86,-2577.08 3476,-2573.5 3513.87,-2560.12 4159.66,-2573.6 4199,-2565.5 4242.87,-2556.47 4289.77,-2535.56 4321.76,-2519.38"/>
<polygon fill="red" stroke="red" points="4323.48,-2522.43 4330.78,-2514.75 4320.28,-2516.21 4323.48,-2522.43"/>
<text text-anchor="middle" x="3507.5" y="-2577.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu2 -->
<g id="node1011" class="node">
<title>l4_attn_stage2_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1564" cy="-2497" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1564" y="-2508.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="1564" y="-2493.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1564" y="-2478.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu2&#45;&gt;l4_attn_stage2_gpu2 -->
<g id="edge947" class="edge">
<title>l4_attn_stage1_gpu2&#45;&gt;l4_attn_stage2_gpu2</title>
<path fill="none" stroke="black" d="M1564,-2606.41C1564,-2587.69 1564,-2564.7 1564,-2544.72"/>
<polygon fill="black" stroke="black" points="1567.5,-2544.58 1564,-2534.58 1560.5,-2544.58 1567.5,-2544.58"/>
</g>
<!-- l4_attn_stage1_gpu2&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2019" class="edge">
<title>l4_attn_stage1_gpu2&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1617.28,-2613.93C1631.41,-2607.6 1646.94,-2601.8 1662,-2598.5 1713.04,-2587.31 3493.68,-2605.77 3543,-2588.5 3553.15,-2584.94 3551.86,-2577.09 3562,-2573.5 3595.36,-2561.68 4164.34,-2572.66 4199,-2565.5 4242.86,-2556.44 4289.76,-2535.53 4321.75,-2519.37"/>
<polygon fill="red" stroke="red" points="4323.48,-2522.42 4330.77,-2514.73 4320.28,-2516.19 4323.48,-2522.42"/>
<text text-anchor="middle" x="3593.5" y="-2577.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu3 -->
<g id="node1012" class="node">
<title>l4_attn_stage2_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1759" cy="-2497" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1759" y="-2508.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="1759" y="-2493.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1759" y="-2478.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu3&#45;&gt;l4_attn_stage2_gpu3 -->
<g id="edge948" class="edge">
<title>l4_attn_stage1_gpu3&#45;&gt;l4_attn_stage2_gpu3</title>
<path fill="none" stroke="black" d="M1759,-2606.41C1759,-2587.69 1759,-2564.7 1759,-2544.72"/>
<polygon fill="black" stroke="black" points="1762.5,-2544.58 1759,-2534.58 1755.5,-2544.58 1762.5,-2544.58"/>
</g>
<!-- l4_attn_stage1_gpu3&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2020" class="edge">
<title>l4_attn_stage1_gpu3&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1812.28,-2613.94C1826.41,-2607.6 1841.94,-2601.8 1857,-2598.5 1905.08,-2587.95 3582.55,-2604.77 3629,-2588.5 3639.15,-2584.94 3637.86,-2577.1 3648,-2573.5 3676.85,-2563.25 4169.02,-2571.72 4199,-2565.5 4242.85,-2556.4 4289.75,-2535.49 4321.75,-2519.34"/>
<polygon fill="red" stroke="red" points="4323.47,-2522.39 4330.77,-2514.71 4320.27,-2516.17 4323.47,-2522.39"/>
<text text-anchor="middle" x="3679.5" y="-2577.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu4 -->
<g id="node1013" class="node">
<title>l4_attn_stage2_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1954" cy="-2497" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1954" y="-2508.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="1954" y="-2493.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1954" y="-2478.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu4&#45;&gt;l4_attn_stage2_gpu4 -->
<g id="edge949" class="edge">
<title>l4_attn_stage1_gpu4&#45;&gt;l4_attn_stage2_gpu4</title>
<path fill="none" stroke="black" d="M1954,-2606.41C1954,-2587.69 1954,-2564.7 1954,-2544.72"/>
<polygon fill="black" stroke="black" points="1957.5,-2544.58 1954,-2534.58 1950.5,-2544.58 1957.5,-2544.58"/>
</g>
<!-- l4_attn_stage1_gpu4&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2021" class="edge">
<title>l4_attn_stage1_gpu4&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2007.28,-2613.94C2021.41,-2607.6 2036.94,-2601.81 2052,-2598.5 2097.12,-2588.59 3671.41,-2603.78 3715,-2588.5 3725.15,-2584.94 3723.87,-2577.12 3734,-2573.5 3782.67,-2556.13 4148.42,-2576.07 4199,-2565.5 4242.84,-2556.34 4289.74,-2535.44 4321.74,-2519.31"/>
<polygon fill="red" stroke="red" points="4323.46,-2522.36 4330.76,-2514.69 4320.27,-2516.13 4323.46,-2522.36"/>
<text text-anchor="middle" x="3765.5" y="-2577.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu5 -->
<g id="node1014" class="node">
<title>l4_attn_stage2_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2149" cy="-2497" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2149" y="-2508.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="2149" y="-2493.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2149" y="-2478.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu5&#45;&gt;l4_attn_stage2_gpu5 -->
<g id="edge950" class="edge">
<title>l4_attn_stage1_gpu5&#45;&gt;l4_attn_stage2_gpu5</title>
<path fill="none" stroke="black" d="M2149,-2606.41C2149,-2587.69 2149,-2564.7 2149,-2544.72"/>
<polygon fill="black" stroke="black" points="2152.5,-2544.58 2149,-2534.58 2145.5,-2544.58 2152.5,-2544.58"/>
</g>
<!-- l4_attn_stage1_gpu5&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2022" class="edge">
<title>l4_attn_stage1_gpu5&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2202.28,-2613.95C2216.41,-2607.61 2231.94,-2601.81 2247,-2598.5 2289.16,-2589.23 3760.27,-2602.79 3801,-2588.5 3811.15,-2584.94 3809.87,-2577.14 3820,-2573.5 3859.64,-2559.27 4157.79,-2574.2 4199,-2565.5 4242.82,-2556.25 4289.73,-2535.37 4321.73,-2519.26"/>
<polygon fill="red" stroke="red" points="4323.45,-2522.32 4330.75,-2514.65 4320.26,-2516.09 4323.45,-2522.32"/>
<text text-anchor="middle" x="3851.5" y="-2577.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu6 -->
<g id="node1015" class="node">
<title>l4_attn_stage2_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2344" cy="-2497" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2344" y="-2508.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="2344" y="-2493.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2344" y="-2478.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu6&#45;&gt;l4_attn_stage2_gpu6 -->
<g id="edge951" class="edge">
<title>l4_attn_stage1_gpu6&#45;&gt;l4_attn_stage2_gpu6</title>
<path fill="none" stroke="black" d="M2344,-2606.41C2344,-2587.69 2344,-2564.7 2344,-2544.72"/>
<polygon fill="black" stroke="black" points="2347.5,-2544.58 2344,-2534.58 2340.5,-2544.58 2347.5,-2544.58"/>
</g>
<!-- l4_attn_stage1_gpu6&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2023" class="edge">
<title>l4_attn_stage1_gpu6&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2397.28,-2613.95C2411.41,-2607.61 2426.94,-2601.81 2442,-2598.5 2481.2,-2589.87 3849.13,-2601.8 3887,-2588.5 3897.15,-2584.94 3895.89,-2577.17 3906,-2573.5 3936.62,-2562.4 4167.15,-2572.32 4199,-2565.5 4242.66,-2556.15 4289.41,-2535.39 4321.42,-2519.34"/>
<polygon fill="red" stroke="red" points="4323.12,-2522.4 4330.45,-2514.74 4319.95,-2516.16 4323.12,-2522.4"/>
<text text-anchor="middle" x="3937.5" y="-2577.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu7 -->
<g id="node1016" class="node">
<title>l4_attn_stage2_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2539" cy="-2497" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2539" y="-2508.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="2539" y="-2493.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2539" y="-2478.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu7&#45;&gt;l4_attn_stage2_gpu7 -->
<g id="edge952" class="edge">
<title>l4_attn_stage1_gpu7&#45;&gt;l4_attn_stage2_gpu7</title>
<path fill="none" stroke="black" d="M2539,-2606.41C2539,-2587.69 2539,-2564.7 2539,-2544.72"/>
<polygon fill="black" stroke="black" points="2542.5,-2544.58 2539,-2534.58 2535.5,-2544.58 2542.5,-2544.58"/>
</g>
<!-- l4_attn_stage1_gpu7&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2024" class="edge">
<title>l4_attn_stage1_gpu7&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2592.28,-2613.96C2606.42,-2607.62 2621.95,-2601.82 2637,-2598.5 2673.24,-2590.51 3937.99,-2600.8 3973,-2588.5 3983.15,-2584.93 3981.91,-2577.22 3992,-2573.5 4035.19,-2557.57 4154.04,-2575.4 4199,-2565.5 4242.6,-2555.9 4289.37,-2535.17 4321.39,-2519.2"/>
<polygon fill="red" stroke="red" points="4323.08,-2522.27 4330.42,-2514.63 4319.92,-2516.02 4323.08,-2522.27"/>
<text text-anchor="middle" x="4023.5" y="-2577.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu8 -->
<g id="node1017" class="node">
<title>l4_attn_stage2_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2734" cy="-2497" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2734" y="-2508.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="2734" y="-2493.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2734" y="-2478.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu8&#45;&gt;l4_attn_stage2_gpu8 -->
<g id="edge953" class="edge">
<title>l4_attn_stage1_gpu8&#45;&gt;l4_attn_stage2_gpu8</title>
<path fill="none" stroke="black" d="M2734,-2606.41C2734,-2587.69 2734,-2564.7 2734,-2544.72"/>
<polygon fill="black" stroke="black" points="2737.5,-2544.58 2734,-2534.58 2730.5,-2544.58 2737.5,-2544.58"/>
</g>
<!-- l4_attn_stage1_gpu8&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2025" class="edge">
<title>l4_attn_stage1_gpu8&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2787.28,-2613.96C2801.42,-2607.62 2816.95,-2601.82 2832,-2598.5 2898.57,-2583.81 3994.69,-2611.12 4059,-2588.5 4069.15,-2584.93 4067.96,-2577.36 4078,-2573.5 4128.3,-2554.15 4146.53,-2577.81 4199,-2565.5 4242.2,-2555.37 4288.67,-2534.92 4320.71,-2519.17"/>
<polygon fill="red" stroke="red" points="4322.38,-2522.25 4329.77,-2514.66 4319.25,-2515.99 4322.38,-2522.25"/>
<text text-anchor="middle" x="4109.5" y="-2577.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu9 -->
<g id="node1018" class="node">
<title>l4_attn_stage2_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2929" cy="-2497" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2929" y="-2508.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="2929" y="-2493.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2929" y="-2478.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu9&#45;&gt;l4_attn_stage2_gpu9 -->
<g id="edge954" class="edge">
<title>l4_attn_stage1_gpu9&#45;&gt;l4_attn_stage2_gpu9</title>
<path fill="none" stroke="black" d="M2929,-2606.41C2929,-2587.69 2929,-2564.7 2929,-2544.72"/>
<polygon fill="black" stroke="black" points="2932.5,-2544.58 2929,-2534.58 2925.5,-2544.58 2932.5,-2544.58"/>
</g>
<!-- l4_attn_stage1_gpu9&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2026" class="edge">
<title>l4_attn_stage1_gpu9&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2982.28,-2613.97C2996.42,-2607.63 3011.95,-2601.83 3027,-2598.5 3087.65,-2585.09 4086.41,-2609.13 4145,-2588.5 4155.15,-2584.93 4154.3,-2578.15 4164,-2573.5 4178.39,-2566.61 4183.8,-2570.36 4199,-2565.5 4239.94,-2552.4 4284.95,-2533.24 4317.12,-2518.67"/>
<polygon fill="red" stroke="red" points="4318.61,-2521.84 4326.25,-2514.51 4315.7,-2515.47 4318.61,-2521.84"/>
<text text-anchor="middle" x="4195.5" y="-2577.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu10 -->
<g id="node1019" class="node">
<title>l4_attn_stage2_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3124" cy="-2497" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3124" y="-2508.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="3124" y="-2493.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3124" y="-2478.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu10&#45;&gt;l4_attn_stage2_gpu10 -->
<g id="edge955" class="edge">
<title>l4_attn_stage1_gpu10&#45;&gt;l4_attn_stage2_gpu10</title>
<path fill="none" stroke="black" d="M3124,-2606.41C3124,-2587.69 3124,-2564.7 3124,-2544.72"/>
<polygon fill="black" stroke="black" points="3127.5,-2544.58 3124,-2534.58 3120.5,-2544.58 3127.5,-2544.58"/>
</g>
<!-- l4_attn_stage1_gpu10&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2027" class="edge">
<title>l4_attn_stage1_gpu10&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3177.29,-2613.98C3191.42,-2607.64 3206.95,-2601.83 3222,-2598.5 3276.73,-2586.37 4178.13,-2607.15 4231,-2588.5 4241.15,-2584.92 4241.32,-2579.86 4250,-2573.5 4275.22,-2555 4304.5,-2535.15 4326.65,-2520.45"/>
<polygon fill="red" stroke="red" points="4328.66,-2523.32 4335.07,-2514.88 4324.8,-2517.48 4328.66,-2523.32"/>
<text text-anchor="middle" x="4281.5" y="-2577.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu11 -->
<g id="node1020" class="node">
<title>l4_attn_stage2_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3319" cy="-2497" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3319" y="-2508.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="3319" y="-2493.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3319" y="-2478.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu11&#45;&gt;l4_attn_stage2_gpu11 -->
<g id="edge956" class="edge">
<title>l4_attn_stage1_gpu11&#45;&gt;l4_attn_stage2_gpu11</title>
<path fill="none" stroke="black" d="M3319,-2606.41C3319,-2587.69 3319,-2564.7 3319,-2544.72"/>
<polygon fill="black" stroke="black" points="3322.5,-2544.58 3319,-2534.58 3315.5,-2544.58 3322.5,-2544.58"/>
</g>
<!-- l4_attn_stage1_gpu11&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2028" class="edge">
<title>l4_attn_stage1_gpu11&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3372.29,-2613.99C3386.42,-2607.65 3401.95,-2601.84 3417,-2598.5 3441.41,-2593.08 4295.88,-2601.88 4317,-2588.5 4338.94,-2574.6 4350.24,-2546.32 4355.85,-2525.05"/>
<polygon fill="red" stroke="red" points="4359.27,-2525.81 4358.18,-2515.27 4352.46,-2524.19 4359.27,-2525.81"/>
<text text-anchor="middle" x="4363.5" y="-2577.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu12 -->
<g id="node1021" class="node">
<title>l4_attn_stage2_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3514" cy="-2497" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3514" y="-2508.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="3514" y="-2493.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3514" y="-2478.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu12&#45;&gt;l4_attn_stage2_gpu12 -->
<g id="edge957" class="edge">
<title>l4_attn_stage1_gpu12&#45;&gt;l4_attn_stage2_gpu12</title>
<path fill="none" stroke="black" d="M3458.85,-2614.54C3445.43,-2608.5 3430.93,-2602.69 3417,-2598.5 3403.22,-2594.35 3362.36,-2599.44 3353,-2588.5 3318.08,-2547.7 3358.79,-2587.82 3417,-2565.5 3434.78,-2558.68 3452.42,-2547.94 3467.68,-2537.01"/>
<polygon fill="black" stroke="black" points="3469.93,-2539.69 3475.9,-2530.94 3465.77,-2534.06 3469.93,-2539.69"/>
</g>
<!-- l4_attn_stage1_gpu12&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2029" class="edge">
<title>l4_attn_stage1_gpu12&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3567.29,-2614.01C3581.43,-2607.67 3596.95,-2601.86 3612,-2598.5 3633.45,-2593.72 4387.56,-2604.14 4403,-2588.5 4421.16,-2570.11 4403.89,-2542.42 4386.31,-2522.51"/>
<polygon fill="red" stroke="red" points="4388.75,-2519.99 4379.38,-2515.03 4383.61,-2524.75 4388.75,-2519.99"/>
<text text-anchor="middle" x="4441.5" y="-2577.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu13 -->
<g id="node1022" class="node">
<title>l4_attn_stage2_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3709" cy="-2497" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3709" y="-2508.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="3709" y="-2493.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3709" y="-2478.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu13&#45;&gt;l4_attn_stage2_gpu13 -->
<g id="edge958" class="edge">
<title>l4_attn_stage1_gpu13&#45;&gt;l4_attn_stage2_gpu13</title>
<path fill="none" stroke="black" d="M3655.7,-2614.06C3641.85,-2607.8 3626.69,-2602.01 3612,-2598.5 3598.37,-2595.24 3369.71,-2598.6 3360,-2588.5 3355.38,-2583.69 3355.36,-2578.29 3360,-2573.5 3369.75,-2563.44 3598.7,-2569.9 3612,-2565.5 3630.4,-2559.4 3648.44,-2548.61 3663.87,-2537.42"/>
<polygon fill="black" stroke="black" points="3666.27,-2539.99 3672.16,-2531.19 3662.06,-2534.4 3666.27,-2539.99"/>
</g>
<!-- l4_attn_stage1_gpu13&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2030" class="edge">
<title>l4_attn_stage1_gpu13&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3762.3,-2614.03C3776.43,-2607.69 3791.96,-2601.87 3807,-2598.5 3825.49,-2594.36 4475.7,-2601.99 4489,-2588.5 4517.36,-2559.72 4469.79,-2533.89 4424.82,-2517.26"/>
<polygon fill="red" stroke="red" points="4425.88,-2513.93 4415.29,-2513.86 4423.53,-2520.52 4425.88,-2513.93"/>
<text text-anchor="middle" x="4528.5" y="-2577.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu14 -->
<g id="node1023" class="node">
<title>l4_attn_stage2_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3904" cy="-2497" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3904" y="-2508.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="3904" y="-2493.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3904" y="-2478.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu14&#45;&gt;l4_attn_stage2_gpu14 -->
<g id="edge959" class="edge">
<title>l4_attn_stage1_gpu14&#45;&gt;l4_attn_stage2_gpu14</title>
<path fill="none" stroke="black" d="M3850.74,-2613.88C3836.89,-2607.63 3821.71,-2601.89 3807,-2598.5 3783.17,-2593.01 3384.09,-2605.98 3367,-2588.5 3362.34,-2583.73 3362.33,-2578.26 3367,-2573.5 3375.56,-2564.78 3795.37,-2569.26 3807,-2565.5 3825.45,-2559.53 3843.49,-2548.77 3858.92,-2537.57"/>
<polygon fill="black" stroke="black" points="3861.32,-2540.14 3867.2,-2531.33 3857.11,-2534.55 3861.32,-2540.14"/>
</g>
<!-- l4_attn_stage1_gpu14&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2031" class="edge">
<title>l4_attn_stage1_gpu14&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3957.3,-2614.06C3971.44,-2607.72 3986.96,-2601.89 4002,-2598.5 4017.53,-2595 4563.84,-2599.85 4575,-2588.5 4615.03,-2547.76 4545.32,-2524.4 4475.01,-2511.66"/>
<polygon fill="red" stroke="red" points="4475.55,-2508.2 4465.1,-2509.93 4474.35,-2515.1 4475.55,-2508.2"/>
<text text-anchor="middle" x="4615.5" y="-2577.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage2_gpu15 -->
<g id="node1024" class="node">
<title>l4_attn_stage2_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4099" cy="-2497" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4099" y="-2508.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage2</text>
<text text-anchor="middle" x="4099" y="-2493.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4099" y="-2478.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage1_gpu15&#45;&gt;l4_attn_stage2_gpu15 -->
<g id="edge960" class="edge">
<title>l4_attn_stage1_gpu15&#45;&gt;l4_attn_stage2_gpu15</title>
<path fill="none" stroke="black" d="M4046.02,-2613.93C4032.09,-2607.63 4016.82,-2601.86 4002,-2598.5 3984.99,-2594.64 3386.24,-2600.93 3374,-2588.5 3369.32,-2583.75 3369.32,-2578.24 3374,-2573.5 3386.26,-2561.09 3985.39,-2570.83 4002,-2565.5 4020.46,-2559.58 4038.51,-2548.83 4053.94,-2537.63"/>
<polygon fill="black" stroke="black" points="4056.34,-2540.2 4062.22,-2531.38 4052.13,-2534.61 4056.34,-2540.2"/>
</g>
<!-- l4_attn_stage1_gpu15&#45;&gt;l4_attn_stage2_gpu[next_gpu] -->
<g id="edge2032" class="edge">
<title>l4_attn_stage1_gpu15&#45;&gt;l4_attn_stage2_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4154.38,-2614.68C4169.74,-2608.12 4186.68,-2602.03 4203,-2598.5 4227.87,-2593.12 4643.2,-2606.69 4661,-2588.5 4715.67,-2532.63 4614.45,-2510.96 4515.12,-2502.71"/>
<polygon fill="red" stroke="red" points="4515.15,-2499.2 4504.9,-2501.91 4514.6,-2506.18 4515.15,-2499.2"/>
<text text-anchor="middle" x="4701.5" y="-2577.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu0 -->
<g id="node1025" class="node">
<title>l4_attn_stage3_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1174" cy="-2350" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1174" y="-2361.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="1174" y="-2346.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1174" y="-2331.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu0&#45;&gt;l4_attn_stage3_gpu0 -->
<g id="edge961" class="edge">
<title>l4_attn_stage2_gpu0&#45;&gt;l4_attn_stage3_gpu0</title>
<path fill="none" stroke="black" d="M1174,-2459.41C1174,-2440.69 1174,-2417.7 1174,-2397.72"/>
<polygon fill="black" stroke="black" points="1177.5,-2397.58 1174,-2387.58 1170.5,-2397.58 1177.5,-2397.58"/>
</g>
<!-- l4_attn_stage3_gpu[next_gpu] -->
<g id="node1360" class="node">
<title>l4_attn_stage3_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4361" cy="-2350" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4361" y="-2346.3" font-family="Times,serif" font-size="14.00">l4_attn_stage3_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage2_gpu0&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2033" class="edge">
<title>l4_attn_stage2_gpu0&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1227.29,-2467C1241.43,-2460.66 1256.95,-2454.85 1272,-2451.5 1501.73,-2400.36 3154.66,-2429.05 3390,-2426.5 3434.94,-2426.01 4154.97,-2427.53 4199,-2418.5 4242.87,-2409.5 4289.77,-2388.58 4321.76,-2372.4"/>
<polygon fill="red" stroke="red" points="4323.49,-2375.45 4330.78,-2367.76 4320.28,-2369.22 4323.49,-2375.45"/>
<text text-anchor="middle" x="3421.5" y="-2430.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu1 -->
<g id="node1026" class="node">
<title>l4_attn_stage3_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1369" cy="-2350" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1369" y="-2361.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="1369" y="-2346.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1369" y="-2331.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu1&#45;&gt;l4_attn_stage3_gpu1 -->
<g id="edge962" class="edge">
<title>l4_attn_stage2_gpu1&#45;&gt;l4_attn_stage3_gpu1</title>
<path fill="none" stroke="black" d="M1369,-2459.41C1369,-2440.69 1369,-2417.7 1369,-2397.72"/>
<polygon fill="black" stroke="black" points="1372.5,-2397.58 1369,-2387.58 1365.5,-2397.58 1372.5,-2397.58"/>
</g>
<!-- l4_attn_stage2_gpu1&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2034" class="edge">
<title>l4_attn_stage2_gpu1&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1422.28,-2466.93C1436.41,-2460.59 1451.94,-2454.8 1467,-2451.5 1521,-2439.67 3404.82,-2459.76 3457,-2441.5 3467.15,-2437.95 3465.86,-2430.08 3476,-2426.5 3513.87,-2413.12 4159.66,-2426.6 4199,-2418.5 4242.87,-2409.47 4289.77,-2388.56 4321.76,-2372.38"/>
<polygon fill="red" stroke="red" points="4323.48,-2375.43 4330.78,-2367.75 4320.28,-2369.21 4323.48,-2375.43"/>
<text text-anchor="middle" x="3507.5" y="-2430.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu2 -->
<g id="node1027" class="node">
<title>l4_attn_stage3_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1564" cy="-2350" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1564" y="-2361.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="1564" y="-2346.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1564" y="-2331.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu2&#45;&gt;l4_attn_stage3_gpu2 -->
<g id="edge963" class="edge">
<title>l4_attn_stage2_gpu2&#45;&gt;l4_attn_stage3_gpu2</title>
<path fill="none" stroke="black" d="M1564,-2459.41C1564,-2440.69 1564,-2417.7 1564,-2397.72"/>
<polygon fill="black" stroke="black" points="1567.5,-2397.58 1564,-2387.58 1560.5,-2397.58 1567.5,-2397.58"/>
</g>
<!-- l4_attn_stage2_gpu2&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2035" class="edge">
<title>l4_attn_stage2_gpu2&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1617.28,-2466.93C1631.41,-2460.6 1646.94,-2454.8 1662,-2451.5 1713.04,-2440.31 3493.68,-2458.77 3543,-2441.5 3553.15,-2437.94 3551.86,-2430.09 3562,-2426.5 3595.36,-2414.68 4164.34,-2425.66 4199,-2418.5 4242.86,-2409.44 4289.76,-2388.53 4321.75,-2372.37"/>
<polygon fill="red" stroke="red" points="4323.48,-2375.42 4330.77,-2367.73 4320.28,-2369.19 4323.48,-2375.42"/>
<text text-anchor="middle" x="3593.5" y="-2430.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu3 -->
<g id="node1028" class="node">
<title>l4_attn_stage3_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1759" cy="-2350" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1759" y="-2361.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="1759" y="-2346.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1759" y="-2331.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu3&#45;&gt;l4_attn_stage3_gpu3 -->
<g id="edge964" class="edge">
<title>l4_attn_stage2_gpu3&#45;&gt;l4_attn_stage3_gpu3</title>
<path fill="none" stroke="black" d="M1759,-2459.41C1759,-2440.69 1759,-2417.7 1759,-2397.72"/>
<polygon fill="black" stroke="black" points="1762.5,-2397.58 1759,-2387.58 1755.5,-2397.58 1762.5,-2397.58"/>
</g>
<!-- l4_attn_stage2_gpu3&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2036" class="edge">
<title>l4_attn_stage2_gpu3&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1812.28,-2466.94C1826.41,-2460.6 1841.94,-2454.8 1857,-2451.5 1905.08,-2440.95 3582.55,-2457.77 3629,-2441.5 3639.15,-2437.94 3637.86,-2430.1 3648,-2426.5 3676.85,-2416.25 4169.02,-2424.72 4199,-2418.5 4242.85,-2409.4 4289.75,-2388.49 4321.75,-2372.34"/>
<polygon fill="red" stroke="red" points="4323.47,-2375.39 4330.77,-2367.71 4320.27,-2369.17 4323.47,-2375.39"/>
<text text-anchor="middle" x="3679.5" y="-2430.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu4 -->
<g id="node1029" class="node">
<title>l4_attn_stage3_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1954" cy="-2350" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1954" y="-2361.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="1954" y="-2346.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1954" y="-2331.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu4&#45;&gt;l4_attn_stage3_gpu4 -->
<g id="edge965" class="edge">
<title>l4_attn_stage2_gpu4&#45;&gt;l4_attn_stage3_gpu4</title>
<path fill="none" stroke="black" d="M1954,-2459.41C1954,-2440.69 1954,-2417.7 1954,-2397.72"/>
<polygon fill="black" stroke="black" points="1957.5,-2397.58 1954,-2387.58 1950.5,-2397.58 1957.5,-2397.58"/>
</g>
<!-- l4_attn_stage2_gpu4&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2037" class="edge">
<title>l4_attn_stage2_gpu4&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2007.28,-2466.94C2021.41,-2460.6 2036.94,-2454.81 2052,-2451.5 2097.12,-2441.59 3671.41,-2456.78 3715,-2441.5 3725.15,-2437.94 3723.87,-2430.12 3734,-2426.5 3782.67,-2409.13 4148.42,-2429.07 4199,-2418.5 4242.84,-2409.34 4289.74,-2388.44 4321.74,-2372.31"/>
<polygon fill="red" stroke="red" points="4323.46,-2375.36 4330.76,-2367.69 4320.27,-2369.13 4323.46,-2375.36"/>
<text text-anchor="middle" x="3765.5" y="-2430.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu5 -->
<g id="node1030" class="node">
<title>l4_attn_stage3_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2149" cy="-2350" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2149" y="-2361.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="2149" y="-2346.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2149" y="-2331.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu5&#45;&gt;l4_attn_stage3_gpu5 -->
<g id="edge966" class="edge">
<title>l4_attn_stage2_gpu5&#45;&gt;l4_attn_stage3_gpu5</title>
<path fill="none" stroke="black" d="M2149,-2459.41C2149,-2440.69 2149,-2417.7 2149,-2397.72"/>
<polygon fill="black" stroke="black" points="2152.5,-2397.58 2149,-2387.58 2145.5,-2397.58 2152.5,-2397.58"/>
</g>
<!-- l4_attn_stage2_gpu5&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2038" class="edge">
<title>l4_attn_stage2_gpu5&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2202.28,-2466.95C2216.41,-2460.61 2231.94,-2454.81 2247,-2451.5 2289.16,-2442.23 3760.27,-2455.79 3801,-2441.5 3811.15,-2437.94 3809.87,-2430.14 3820,-2426.5 3859.64,-2412.27 4157.79,-2427.2 4199,-2418.5 4242.82,-2409.25 4289.73,-2388.37 4321.73,-2372.26"/>
<polygon fill="red" stroke="red" points="4323.45,-2375.32 4330.75,-2367.65 4320.26,-2369.09 4323.45,-2375.32"/>
<text text-anchor="middle" x="3851.5" y="-2430.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu6 -->
<g id="node1031" class="node">
<title>l4_attn_stage3_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2344" cy="-2350" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2344" y="-2361.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="2344" y="-2346.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2344" y="-2331.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu6&#45;&gt;l4_attn_stage3_gpu6 -->
<g id="edge967" class="edge">
<title>l4_attn_stage2_gpu6&#45;&gt;l4_attn_stage3_gpu6</title>
<path fill="none" stroke="black" d="M2344,-2459.41C2344,-2440.69 2344,-2417.7 2344,-2397.72"/>
<polygon fill="black" stroke="black" points="2347.5,-2397.58 2344,-2387.58 2340.5,-2397.58 2347.5,-2397.58"/>
</g>
<!-- l4_attn_stage2_gpu6&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2039" class="edge">
<title>l4_attn_stage2_gpu6&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2397.28,-2466.95C2411.41,-2460.61 2426.94,-2454.81 2442,-2451.5 2481.2,-2442.87 3849.13,-2454.8 3887,-2441.5 3897.15,-2437.94 3895.89,-2430.17 3906,-2426.5 3936.62,-2415.4 4167.15,-2425.32 4199,-2418.5 4242.66,-2409.15 4289.41,-2388.39 4321.42,-2372.34"/>
<polygon fill="red" stroke="red" points="4323.12,-2375.4 4330.45,-2367.74 4319.95,-2369.16 4323.12,-2375.4"/>
<text text-anchor="middle" x="3937.5" y="-2430.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu7 -->
<g id="node1032" class="node">
<title>l4_attn_stage3_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2539" cy="-2350" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2539" y="-2361.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="2539" y="-2346.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2539" y="-2331.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu7&#45;&gt;l4_attn_stage3_gpu7 -->
<g id="edge968" class="edge">
<title>l4_attn_stage2_gpu7&#45;&gt;l4_attn_stage3_gpu7</title>
<path fill="none" stroke="black" d="M2539,-2459.41C2539,-2440.69 2539,-2417.7 2539,-2397.72"/>
<polygon fill="black" stroke="black" points="2542.5,-2397.58 2539,-2387.58 2535.5,-2397.58 2542.5,-2397.58"/>
</g>
<!-- l4_attn_stage2_gpu7&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2040" class="edge">
<title>l4_attn_stage2_gpu7&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2592.28,-2466.96C2606.42,-2460.62 2621.95,-2454.82 2637,-2451.5 2673.24,-2443.51 3937.99,-2453.8 3973,-2441.5 3983.15,-2437.93 3981.91,-2430.22 3992,-2426.5 4035.19,-2410.57 4154.04,-2428.4 4199,-2418.5 4242.6,-2408.9 4289.37,-2388.17 4321.39,-2372.2"/>
<polygon fill="red" stroke="red" points="4323.08,-2375.27 4330.42,-2367.63 4319.92,-2369.02 4323.08,-2375.27"/>
<text text-anchor="middle" x="4023.5" y="-2430.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu8 -->
<g id="node1033" class="node">
<title>l4_attn_stage3_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2734" cy="-2350" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2734" y="-2361.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="2734" y="-2346.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2734" y="-2331.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu8&#45;&gt;l4_attn_stage3_gpu8 -->
<g id="edge969" class="edge">
<title>l4_attn_stage2_gpu8&#45;&gt;l4_attn_stage3_gpu8</title>
<path fill="none" stroke="black" d="M2734,-2459.41C2734,-2440.69 2734,-2417.7 2734,-2397.72"/>
<polygon fill="black" stroke="black" points="2737.5,-2397.58 2734,-2387.58 2730.5,-2397.58 2737.5,-2397.58"/>
</g>
<!-- l4_attn_stage2_gpu8&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2041" class="edge">
<title>l4_attn_stage2_gpu8&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2787.28,-2466.96C2801.42,-2460.62 2816.95,-2454.82 2832,-2451.5 2898.57,-2436.81 3994.69,-2464.12 4059,-2441.5 4069.15,-2437.93 4067.96,-2430.36 4078,-2426.5 4128.3,-2407.15 4146.53,-2430.81 4199,-2418.5 4242.2,-2408.37 4288.67,-2387.92 4320.71,-2372.17"/>
<polygon fill="red" stroke="red" points="4322.38,-2375.25 4329.77,-2367.66 4319.25,-2368.99 4322.38,-2375.25"/>
<text text-anchor="middle" x="4109.5" y="-2430.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu9 -->
<g id="node1034" class="node">
<title>l4_attn_stage3_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2929" cy="-2350" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2929" y="-2361.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="2929" y="-2346.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2929" y="-2331.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu9&#45;&gt;l4_attn_stage3_gpu9 -->
<g id="edge970" class="edge">
<title>l4_attn_stage2_gpu9&#45;&gt;l4_attn_stage3_gpu9</title>
<path fill="none" stroke="black" d="M2929,-2459.41C2929,-2440.69 2929,-2417.7 2929,-2397.72"/>
<polygon fill="black" stroke="black" points="2932.5,-2397.58 2929,-2387.58 2925.5,-2397.58 2932.5,-2397.58"/>
</g>
<!-- l4_attn_stage2_gpu9&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2042" class="edge">
<title>l4_attn_stage2_gpu9&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2982.28,-2466.97C2996.42,-2460.63 3011.95,-2454.83 3027,-2451.5 3087.65,-2438.09 4086.41,-2462.13 4145,-2441.5 4155.15,-2437.93 4154.3,-2431.15 4164,-2426.5 4178.39,-2419.61 4183.8,-2423.36 4199,-2418.5 4239.94,-2405.4 4284.95,-2386.24 4317.12,-2371.67"/>
<polygon fill="red" stroke="red" points="4318.61,-2374.84 4326.25,-2367.51 4315.7,-2368.47 4318.61,-2374.84"/>
<text text-anchor="middle" x="4195.5" y="-2430.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu10 -->
<g id="node1035" class="node">
<title>l4_attn_stage3_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3124" cy="-2350" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3124" y="-2361.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="3124" y="-2346.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3124" y="-2331.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu10&#45;&gt;l4_attn_stage3_gpu10 -->
<g id="edge971" class="edge">
<title>l4_attn_stage2_gpu10&#45;&gt;l4_attn_stage3_gpu10</title>
<path fill="none" stroke="black" d="M3124,-2459.41C3124,-2440.69 3124,-2417.7 3124,-2397.72"/>
<polygon fill="black" stroke="black" points="3127.5,-2397.58 3124,-2387.58 3120.5,-2397.58 3127.5,-2397.58"/>
</g>
<!-- l4_attn_stage2_gpu10&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2043" class="edge">
<title>l4_attn_stage2_gpu10&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3177.29,-2466.98C3191.42,-2460.64 3206.95,-2454.83 3222,-2451.5 3276.73,-2439.37 4178.13,-2460.15 4231,-2441.5 4241.15,-2437.92 4241.32,-2432.86 4250,-2426.5 4275.22,-2408 4304.5,-2388.15 4326.65,-2373.45"/>
<polygon fill="red" stroke="red" points="4328.66,-2376.32 4335.07,-2367.88 4324.8,-2370.48 4328.66,-2376.32"/>
<text text-anchor="middle" x="4281.5" y="-2430.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu11 -->
<g id="node1036" class="node">
<title>l4_attn_stage3_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3319" cy="-2350" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3319" y="-2361.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="3319" y="-2346.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3319" y="-2331.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu11&#45;&gt;l4_attn_stage3_gpu11 -->
<g id="edge972" class="edge">
<title>l4_attn_stage2_gpu11&#45;&gt;l4_attn_stage3_gpu11</title>
<path fill="none" stroke="black" d="M3319,-2459.41C3319,-2440.69 3319,-2417.7 3319,-2397.72"/>
<polygon fill="black" stroke="black" points="3322.5,-2397.58 3319,-2387.58 3315.5,-2397.58 3322.5,-2397.58"/>
</g>
<!-- l4_attn_stage2_gpu11&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2044" class="edge">
<title>l4_attn_stage2_gpu11&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3372.29,-2466.99C3386.42,-2460.65 3401.95,-2454.84 3417,-2451.5 3441.41,-2446.08 4295.88,-2454.88 4317,-2441.5 4338.94,-2427.6 4350.24,-2399.32 4355.85,-2378.05"/>
<polygon fill="red" stroke="red" points="4359.27,-2378.81 4358.18,-2368.27 4352.46,-2377.19 4359.27,-2378.81"/>
<text text-anchor="middle" x="4363.5" y="-2430.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu12 -->
<g id="node1037" class="node">
<title>l4_attn_stage3_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3514" cy="-2350" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3514" y="-2361.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="3514" y="-2346.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3514" y="-2331.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu12&#45;&gt;l4_attn_stage3_gpu12 -->
<g id="edge973" class="edge">
<title>l4_attn_stage2_gpu12&#45;&gt;l4_attn_stage3_gpu12</title>
<path fill="none" stroke="black" d="M3458.85,-2467.54C3445.43,-2461.5 3430.93,-2455.69 3417,-2451.5 3403.22,-2447.35 3362.36,-2452.44 3353,-2441.5 3318.08,-2400.7 3358.79,-2440.82 3417,-2418.5 3434.78,-2411.68 3452.42,-2400.94 3467.68,-2390.01"/>
<polygon fill="black" stroke="black" points="3469.93,-2392.69 3475.9,-2383.94 3465.77,-2387.06 3469.93,-2392.69"/>
</g>
<!-- l4_attn_stage2_gpu12&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2045" class="edge">
<title>l4_attn_stage2_gpu12&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3567.29,-2467.01C3581.43,-2460.67 3596.95,-2454.86 3612,-2451.5 3633.45,-2446.72 4387.56,-2457.14 4403,-2441.5 4421.16,-2423.11 4403.89,-2395.42 4386.31,-2375.51"/>
<polygon fill="red" stroke="red" points="4388.75,-2372.99 4379.38,-2368.03 4383.61,-2377.75 4388.75,-2372.99"/>
<text text-anchor="middle" x="4441.5" y="-2430.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu13 -->
<g id="node1038" class="node">
<title>l4_attn_stage3_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3709" cy="-2350" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3709" y="-2361.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="3709" y="-2346.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3709" y="-2331.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu13&#45;&gt;l4_attn_stage3_gpu13 -->
<g id="edge974" class="edge">
<title>l4_attn_stage2_gpu13&#45;&gt;l4_attn_stage3_gpu13</title>
<path fill="none" stroke="black" d="M3655.7,-2467.06C3641.85,-2460.8 3626.69,-2455.01 3612,-2451.5 3598.37,-2448.24 3369.71,-2451.6 3360,-2441.5 3355.38,-2436.69 3355.36,-2431.29 3360,-2426.5 3369.75,-2416.44 3598.7,-2422.9 3612,-2418.5 3630.4,-2412.4 3648.44,-2401.61 3663.87,-2390.42"/>
<polygon fill="black" stroke="black" points="3666.27,-2392.99 3672.16,-2384.19 3662.06,-2387.4 3666.27,-2392.99"/>
</g>
<!-- l4_attn_stage2_gpu13&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2046" class="edge">
<title>l4_attn_stage2_gpu13&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3762.3,-2467.03C3776.43,-2460.69 3791.96,-2454.87 3807,-2451.5 3825.49,-2447.36 4475.7,-2454.99 4489,-2441.5 4517.36,-2412.72 4469.79,-2386.89 4424.82,-2370.26"/>
<polygon fill="red" stroke="red" points="4425.88,-2366.93 4415.29,-2366.86 4423.53,-2373.52 4425.88,-2366.93"/>
<text text-anchor="middle" x="4528.5" y="-2430.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu14 -->
<g id="node1039" class="node">
<title>l4_attn_stage3_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3904" cy="-2350" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3904" y="-2361.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="3904" y="-2346.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3904" y="-2331.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu14&#45;&gt;l4_attn_stage3_gpu14 -->
<g id="edge975" class="edge">
<title>l4_attn_stage2_gpu14&#45;&gt;l4_attn_stage3_gpu14</title>
<path fill="none" stroke="black" d="M3850.74,-2466.88C3836.89,-2460.63 3821.71,-2454.89 3807,-2451.5 3783.17,-2446.01 3384.09,-2458.98 3367,-2441.5 3362.34,-2436.73 3362.33,-2431.26 3367,-2426.5 3375.56,-2417.78 3795.37,-2422.26 3807,-2418.5 3825.45,-2412.53 3843.49,-2401.77 3858.92,-2390.57"/>
<polygon fill="black" stroke="black" points="3861.32,-2393.14 3867.2,-2384.33 3857.11,-2387.55 3861.32,-2393.14"/>
</g>
<!-- l4_attn_stage2_gpu14&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2047" class="edge">
<title>l4_attn_stage2_gpu14&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3957.3,-2467.06C3971.44,-2460.72 3986.96,-2454.89 4002,-2451.5 4017.53,-2448 4563.84,-2452.85 4575,-2441.5 4615.03,-2400.76 4545.32,-2377.4 4475.01,-2364.66"/>
<polygon fill="red" stroke="red" points="4475.55,-2361.2 4465.1,-2362.93 4474.35,-2368.1 4475.55,-2361.2"/>
<text text-anchor="middle" x="4615.5" y="-2430.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage3_gpu15 -->
<g id="node1040" class="node">
<title>l4_attn_stage3_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4099" cy="-2350" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4099" y="-2361.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage3</text>
<text text-anchor="middle" x="4099" y="-2346.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4099" y="-2331.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage2_gpu15&#45;&gt;l4_attn_stage3_gpu15 -->
<g id="edge976" class="edge">
<title>l4_attn_stage2_gpu15&#45;&gt;l4_attn_stage3_gpu15</title>
<path fill="none" stroke="black" d="M4046.02,-2466.93C4032.09,-2460.63 4016.82,-2454.86 4002,-2451.5 3984.99,-2447.64 3386.24,-2453.93 3374,-2441.5 3369.32,-2436.75 3369.32,-2431.24 3374,-2426.5 3386.26,-2414.09 3985.39,-2423.83 4002,-2418.5 4020.46,-2412.58 4038.51,-2401.83 4053.94,-2390.63"/>
<polygon fill="black" stroke="black" points="4056.34,-2393.2 4062.22,-2384.38 4052.13,-2387.61 4056.34,-2393.2"/>
</g>
<!-- l4_attn_stage2_gpu15&#45;&gt;l4_attn_stage3_gpu[next_gpu] -->
<g id="edge2048" class="edge">
<title>l4_attn_stage2_gpu15&#45;&gt;l4_attn_stage3_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4154.38,-2467.68C4169.74,-2461.12 4186.68,-2455.03 4203,-2451.5 4227.87,-2446.12 4643.2,-2459.69 4661,-2441.5 4715.67,-2385.63 4614.45,-2363.96 4515.12,-2355.71"/>
<polygon fill="red" stroke="red" points="4515.15,-2352.2 4504.9,-2354.91 4514.6,-2359.18 4515.15,-2352.2"/>
<text text-anchor="middle" x="4701.5" y="-2430.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu0 -->
<g id="node1041" class="node">
<title>l4_attn_stage4_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1174" cy="-2203" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1174" y="-2214.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="1174" y="-2199.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1174" y="-2184.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu0&#45;&gt;l4_attn_stage4_gpu0 -->
<g id="edge977" class="edge">
<title>l4_attn_stage3_gpu0&#45;&gt;l4_attn_stage4_gpu0</title>
<path fill="none" stroke="black" d="M1174,-2312.41C1174,-2293.69 1174,-2270.7 1174,-2250.72"/>
<polygon fill="black" stroke="black" points="1177.5,-2250.58 1174,-2240.58 1170.5,-2250.58 1177.5,-2250.58"/>
</g>
<!-- l4_attn_stage4_gpu[next_gpu] -->
<g id="node1361" class="node">
<title>l4_attn_stage4_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4361" cy="-2203" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4361" y="-2199.3" font-family="Times,serif" font-size="14.00">l4_attn_stage4_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage3_gpu0&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge2049" class="edge">
<title>l4_attn_stage3_gpu0&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1227.29,-2320C1241.43,-2313.66 1256.95,-2307.85 1272,-2304.5 1501.73,-2253.36 3154.66,-2282.05 3390,-2279.5 3434.94,-2279.01 4154.97,-2280.53 4199,-2271.5 4242.87,-2262.5 4289.77,-2241.58 4321.76,-2225.4"/>
<polygon fill="red" stroke="red" points="4323.49,-2228.45 4330.78,-2220.76 4320.28,-2222.22 4323.49,-2228.45"/>
<text text-anchor="middle" x="3421.5" y="-2283.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu1 -->
<g id="node1042" class="node">
<title>l4_attn_stage4_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1369" cy="-2203" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1369" y="-2214.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="1369" y="-2199.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1369" y="-2184.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu1&#45;&gt;l4_attn_stage4_gpu1 -->
<g id="edge978" class="edge">
<title>l4_attn_stage3_gpu1&#45;&gt;l4_attn_stage4_gpu1</title>
<path fill="none" stroke="black" d="M1369,-2312.41C1369,-2293.69 1369,-2270.7 1369,-2250.72"/>
<polygon fill="black" stroke="black" points="1372.5,-2250.58 1369,-2240.58 1365.5,-2250.58 1372.5,-2250.58"/>
</g>
<!-- l4_attn_stage3_gpu1&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge2050" class="edge">
<title>l4_attn_stage3_gpu1&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1422.28,-2319.93C1436.41,-2313.59 1451.94,-2307.8 1467,-2304.5 1521,-2292.67 3404.82,-2312.76 3457,-2294.5 3467.15,-2290.95 3465.86,-2283.08 3476,-2279.5 3513.87,-2266.12 4159.66,-2279.6 4199,-2271.5 4242.87,-2262.47 4289.77,-2241.56 4321.76,-2225.38"/>
<polygon fill="red" stroke="red" points="4323.48,-2228.43 4330.78,-2220.75 4320.28,-2222.21 4323.48,-2228.43"/>
<text text-anchor="middle" x="3507.5" y="-2283.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu2 -->
<g id="node1043" class="node">
<title>l4_attn_stage4_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1564" cy="-2203" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1564" y="-2214.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="1564" y="-2199.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1564" y="-2184.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu2&#45;&gt;l4_attn_stage4_gpu2 -->
<g id="edge979" class="edge">
<title>l4_attn_stage3_gpu2&#45;&gt;l4_attn_stage4_gpu2</title>
<path fill="none" stroke="black" d="M1564,-2312.41C1564,-2293.69 1564,-2270.7 1564,-2250.72"/>
<polygon fill="black" stroke="black" points="1567.5,-2250.58 1564,-2240.58 1560.5,-2250.58 1567.5,-2250.58"/>
</g>
<!-- l4_attn_stage3_gpu2&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge2051" class="edge">
<title>l4_attn_stage3_gpu2&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1617.28,-2319.93C1631.41,-2313.6 1646.94,-2307.8 1662,-2304.5 1713.04,-2293.31 3493.68,-2311.77 3543,-2294.5 3553.15,-2290.94 3551.86,-2283.09 3562,-2279.5 3595.36,-2267.68 4164.34,-2278.66 4199,-2271.5 4242.86,-2262.44 4289.76,-2241.53 4321.75,-2225.37"/>
<polygon fill="red" stroke="red" points="4323.48,-2228.42 4330.77,-2220.73 4320.28,-2222.19 4323.48,-2228.42"/>
<text text-anchor="middle" x="3593.5" y="-2283.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu3 -->
<g id="node1044" class="node">
<title>l4_attn_stage4_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1759" cy="-2203" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1759" y="-2214.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="1759" y="-2199.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1759" y="-2184.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu3&#45;&gt;l4_attn_stage4_gpu3 -->
<g id="edge980" class="edge">
<title>l4_attn_stage3_gpu3&#45;&gt;l4_attn_stage4_gpu3</title>
<path fill="none" stroke="black" d="M1759,-2312.41C1759,-2293.69 1759,-2270.7 1759,-2250.72"/>
<polygon fill="black" stroke="black" points="1762.5,-2250.58 1759,-2240.58 1755.5,-2250.58 1762.5,-2250.58"/>
</g>
<!-- l4_attn_stage3_gpu3&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge2052" class="edge">
<title>l4_attn_stage3_gpu3&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1812.28,-2319.94C1826.41,-2313.6 1841.94,-2307.8 1857,-2304.5 1905.08,-2293.95 3582.55,-2310.77 3629,-2294.5 3639.15,-2290.94 3637.86,-2283.1 3648,-2279.5 3676.85,-2269.25 4169.02,-2277.72 4199,-2271.5 4242.85,-2262.4 4289.75,-2241.49 4321.75,-2225.34"/>
<polygon fill="red" stroke="red" points="4323.47,-2228.39 4330.77,-2220.71 4320.27,-2222.17 4323.47,-2228.39"/>
<text text-anchor="middle" x="3679.5" y="-2283.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu4 -->
<g id="node1045" class="node">
<title>l4_attn_stage4_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1954" cy="-2203" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1954" y="-2214.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="1954" y="-2199.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1954" y="-2184.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu4&#45;&gt;l4_attn_stage4_gpu4 -->
<g id="edge981" class="edge">
<title>l4_attn_stage3_gpu4&#45;&gt;l4_attn_stage4_gpu4</title>
<path fill="none" stroke="black" d="M1954,-2312.41C1954,-2293.69 1954,-2270.7 1954,-2250.72"/>
<polygon fill="black" stroke="black" points="1957.5,-2250.58 1954,-2240.58 1950.5,-2250.58 1957.5,-2250.58"/>
</g>
<!-- l4_attn_stage3_gpu4&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge2053" class="edge">
<title>l4_attn_stage3_gpu4&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2007.28,-2319.94C2021.41,-2313.6 2036.94,-2307.81 2052,-2304.5 2097.12,-2294.59 3671.41,-2309.78 3715,-2294.5 3725.15,-2290.94 3723.87,-2283.12 3734,-2279.5 3782.67,-2262.13 4148.42,-2282.07 4199,-2271.5 4242.84,-2262.34 4289.74,-2241.44 4321.74,-2225.31"/>
<polygon fill="red" stroke="red" points="4323.46,-2228.36 4330.76,-2220.69 4320.27,-2222.13 4323.46,-2228.36"/>
<text text-anchor="middle" x="3765.5" y="-2283.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu5 -->
<g id="node1046" class="node">
<title>l4_attn_stage4_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2149" cy="-2203" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2149" y="-2214.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="2149" y="-2199.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2149" y="-2184.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu5&#45;&gt;l4_attn_stage4_gpu5 -->
<g id="edge982" class="edge">
<title>l4_attn_stage3_gpu5&#45;&gt;l4_attn_stage4_gpu5</title>
<path fill="none" stroke="black" d="M2149,-2312.41C2149,-2293.69 2149,-2270.7 2149,-2250.72"/>
<polygon fill="black" stroke="black" points="2152.5,-2250.58 2149,-2240.58 2145.5,-2250.58 2152.5,-2250.58"/>
</g>
<!-- l4_attn_stage3_gpu5&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge2054" class="edge">
<title>l4_attn_stage3_gpu5&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2202.28,-2319.95C2216.41,-2313.61 2231.94,-2307.81 2247,-2304.5 2289.16,-2295.23 3760.27,-2308.79 3801,-2294.5 3811.15,-2290.94 3809.87,-2283.14 3820,-2279.5 3859.64,-2265.27 4157.79,-2280.2 4199,-2271.5 4242.82,-2262.25 4289.73,-2241.37 4321.73,-2225.26"/>
<polygon fill="red" stroke="red" points="4323.45,-2228.32 4330.75,-2220.65 4320.26,-2222.09 4323.45,-2228.32"/>
<text text-anchor="middle" x="3851.5" y="-2283.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu6 -->
<g id="node1047" class="node">
<title>l4_attn_stage4_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2344" cy="-2203" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2344" y="-2214.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="2344" y="-2199.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2344" y="-2184.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu6&#45;&gt;l4_attn_stage4_gpu6 -->
<g id="edge983" class="edge">
<title>l4_attn_stage3_gpu6&#45;&gt;l4_attn_stage4_gpu6</title>
<path fill="none" stroke="black" d="M2344,-2312.41C2344,-2293.69 2344,-2270.7 2344,-2250.72"/>
<polygon fill="black" stroke="black" points="2347.5,-2250.58 2344,-2240.58 2340.5,-2250.58 2347.5,-2250.58"/>
</g>
<!-- l4_attn_stage3_gpu6&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge2055" class="edge">
<title>l4_attn_stage3_gpu6&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2397.28,-2319.95C2411.41,-2313.61 2426.94,-2307.81 2442,-2304.5 2481.2,-2295.87 3849.13,-2307.8 3887,-2294.5 3897.15,-2290.94 3895.89,-2283.17 3906,-2279.5 3936.62,-2268.4 4167.15,-2278.32 4199,-2271.5 4242.66,-2262.15 4289.41,-2241.39 4321.42,-2225.34"/>
<polygon fill="red" stroke="red" points="4323.12,-2228.4 4330.45,-2220.74 4319.95,-2222.16 4323.12,-2228.4"/>
<text text-anchor="middle" x="3937.5" y="-2283.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu7 -->
<g id="node1048" class="node">
<title>l4_attn_stage4_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2539" cy="-2203" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2539" y="-2214.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="2539" y="-2199.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2539" y="-2184.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu7&#45;&gt;l4_attn_stage4_gpu7 -->
<g id="edge984" class="edge">
<title>l4_attn_stage3_gpu7&#45;&gt;l4_attn_stage4_gpu7</title>
<path fill="none" stroke="black" d="M2539,-2312.41C2539,-2293.69 2539,-2270.7 2539,-2250.72"/>
<polygon fill="black" stroke="black" points="2542.5,-2250.58 2539,-2240.58 2535.5,-2250.58 2542.5,-2250.58"/>
</g>
<!-- l4_attn_stage3_gpu7&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge2056" class="edge">
<title>l4_attn_stage3_gpu7&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2592.28,-2319.96C2606.42,-2313.62 2621.95,-2307.82 2637,-2304.5 2673.24,-2296.51 3937.99,-2306.8 3973,-2294.5 3983.15,-2290.93 3981.91,-2283.22 3992,-2279.5 4035.19,-2263.57 4154.04,-2281.4 4199,-2271.5 4242.6,-2261.9 4289.37,-2241.17 4321.39,-2225.2"/>
<polygon fill="red" stroke="red" points="4323.08,-2228.27 4330.42,-2220.63 4319.92,-2222.02 4323.08,-2228.27"/>
<text text-anchor="middle" x="4023.5" y="-2283.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu8 -->
<g id="node1049" class="node">
<title>l4_attn_stage4_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2734" cy="-2203" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2734" y="-2214.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="2734" y="-2199.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2734" y="-2184.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu8&#45;&gt;l4_attn_stage4_gpu8 -->
<g id="edge985" class="edge">
<title>l4_attn_stage3_gpu8&#45;&gt;l4_attn_stage4_gpu8</title>
<path fill="none" stroke="black" d="M2734,-2312.41C2734,-2293.69 2734,-2270.7 2734,-2250.72"/>
<polygon fill="black" stroke="black" points="2737.5,-2250.58 2734,-2240.58 2730.5,-2250.58 2737.5,-2250.58"/>
</g>
<!-- l4_attn_stage3_gpu8&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge2057" class="edge">
<title>l4_attn_stage3_gpu8&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2787.28,-2319.96C2801.42,-2313.62 2816.95,-2307.82 2832,-2304.5 2898.57,-2289.81 3994.69,-2317.12 4059,-2294.5 4069.15,-2290.93 4067.96,-2283.36 4078,-2279.5 4128.3,-2260.15 4146.53,-2283.81 4199,-2271.5 4242.2,-2261.37 4288.67,-2240.92 4320.71,-2225.17"/>
<polygon fill="red" stroke="red" points="4322.38,-2228.25 4329.77,-2220.66 4319.25,-2221.99 4322.38,-2228.25"/>
<text text-anchor="middle" x="4109.5" y="-2283.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu9 -->
<g id="node1050" class="node">
<title>l4_attn_stage4_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2929" cy="-2203" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2929" y="-2214.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="2929" y="-2199.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2929" y="-2184.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu9&#45;&gt;l4_attn_stage4_gpu9 -->
<g id="edge986" class="edge">
<title>l4_attn_stage3_gpu9&#45;&gt;l4_attn_stage4_gpu9</title>
<path fill="none" stroke="black" d="M2929,-2312.41C2929,-2293.69 2929,-2270.7 2929,-2250.72"/>
<polygon fill="black" stroke="black" points="2932.5,-2250.58 2929,-2240.58 2925.5,-2250.58 2932.5,-2250.58"/>
</g>
<!-- l4_attn_stage3_gpu9&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge2058" class="edge">
<title>l4_attn_stage3_gpu9&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2982.28,-2319.97C2996.42,-2313.63 3011.95,-2307.83 3027,-2304.5 3087.65,-2291.09 4086.41,-2315.13 4145,-2294.5 4155.15,-2290.93 4154.3,-2284.15 4164,-2279.5 4178.39,-2272.61 4183.8,-2276.36 4199,-2271.5 4239.94,-2258.4 4284.95,-2239.24 4317.12,-2224.67"/>
<polygon fill="red" stroke="red" points="4318.61,-2227.84 4326.25,-2220.51 4315.7,-2221.47 4318.61,-2227.84"/>
<text text-anchor="middle" x="4195.5" y="-2283.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu10 -->
<g id="node1051" class="node">
<title>l4_attn_stage4_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3124" cy="-2203" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3124" y="-2214.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="3124" y="-2199.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3124" y="-2184.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu10&#45;&gt;l4_attn_stage4_gpu10 -->
<g id="edge987" class="edge">
<title>l4_attn_stage3_gpu10&#45;&gt;l4_attn_stage4_gpu10</title>
<path fill="none" stroke="black" d="M3124,-2312.41C3124,-2293.69 3124,-2270.7 3124,-2250.72"/>
<polygon fill="black" stroke="black" points="3127.5,-2250.58 3124,-2240.58 3120.5,-2250.58 3127.5,-2250.58"/>
</g>
<!-- l4_attn_stage3_gpu10&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge2059" class="edge">
<title>l4_attn_stage3_gpu10&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3177.29,-2319.98C3191.42,-2313.64 3206.95,-2307.83 3222,-2304.5 3276.73,-2292.37 4178.13,-2313.15 4231,-2294.5 4241.15,-2290.92 4241.32,-2285.86 4250,-2279.5 4275.22,-2261 4304.5,-2241.15 4326.65,-2226.45"/>
<polygon fill="red" stroke="red" points="4328.66,-2229.32 4335.07,-2220.88 4324.8,-2223.48 4328.66,-2229.32"/>
<text text-anchor="middle" x="4281.5" y="-2283.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu11 -->
<g id="node1052" class="node">
<title>l4_attn_stage4_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3319" cy="-2203" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3319" y="-2214.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="3319" y="-2199.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3319" y="-2184.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu11&#45;&gt;l4_attn_stage4_gpu11 -->
<g id="edge988" class="edge">
<title>l4_attn_stage3_gpu11&#45;&gt;l4_attn_stage4_gpu11</title>
<path fill="none" stroke="black" d="M3319,-2312.41C3319,-2293.69 3319,-2270.7 3319,-2250.72"/>
<polygon fill="black" stroke="black" points="3322.5,-2250.58 3319,-2240.58 3315.5,-2250.58 3322.5,-2250.58"/>
</g>
<!-- l4_attn_stage3_gpu11&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge2060" class="edge">
<title>l4_attn_stage3_gpu11&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3372.29,-2319.99C3386.42,-2313.65 3401.95,-2307.84 3417,-2304.5 3441.41,-2299.08 4295.88,-2307.88 4317,-2294.5 4338.94,-2280.6 4350.24,-2252.32 4355.85,-2231.05"/>
<polygon fill="red" stroke="red" points="4359.27,-2231.81 4358.18,-2221.27 4352.46,-2230.19 4359.27,-2231.81"/>
<text text-anchor="middle" x="4363.5" y="-2283.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu12 -->
<g id="node1053" class="node">
<title>l4_attn_stage4_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3514" cy="-2203" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3514" y="-2214.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="3514" y="-2199.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3514" y="-2184.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu12&#45;&gt;l4_attn_stage4_gpu12 -->
<g id="edge989" class="edge">
<title>l4_attn_stage3_gpu12&#45;&gt;l4_attn_stage4_gpu12</title>
<path fill="none" stroke="black" d="M3458.85,-2320.54C3445.43,-2314.5 3430.93,-2308.69 3417,-2304.5 3403.22,-2300.35 3362.36,-2305.44 3353,-2294.5 3318.08,-2253.7 3358.79,-2293.82 3417,-2271.5 3434.78,-2264.68 3452.42,-2253.94 3467.68,-2243.01"/>
<polygon fill="black" stroke="black" points="3469.93,-2245.69 3475.9,-2236.94 3465.77,-2240.06 3469.93,-2245.69"/>
</g>
<!-- l4_attn_stage3_gpu12&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge2061" class="edge">
<title>l4_attn_stage3_gpu12&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3567.29,-2320.01C3581.43,-2313.67 3596.95,-2307.86 3612,-2304.5 3633.45,-2299.72 4387.56,-2310.14 4403,-2294.5 4421.16,-2276.11 4403.89,-2248.42 4386.31,-2228.51"/>
<polygon fill="red" stroke="red" points="4388.75,-2225.99 4379.38,-2221.03 4383.61,-2230.75 4388.75,-2225.99"/>
<text text-anchor="middle" x="4441.5" y="-2283.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu13 -->
<g id="node1054" class="node">
<title>l4_attn_stage4_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3709" cy="-2203" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3709" y="-2214.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="3709" y="-2199.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3709" y="-2184.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu13&#45;&gt;l4_attn_stage4_gpu13 -->
<g id="edge990" class="edge">
<title>l4_attn_stage3_gpu13&#45;&gt;l4_attn_stage4_gpu13</title>
<path fill="none" stroke="black" d="M3655.7,-2320.06C3641.85,-2313.8 3626.69,-2308.01 3612,-2304.5 3598.37,-2301.24 3369.71,-2304.6 3360,-2294.5 3355.38,-2289.69 3355.36,-2284.29 3360,-2279.5 3369.75,-2269.44 3598.7,-2275.9 3612,-2271.5 3630.4,-2265.4 3648.44,-2254.61 3663.87,-2243.42"/>
<polygon fill="black" stroke="black" points="3666.27,-2245.99 3672.16,-2237.19 3662.06,-2240.4 3666.27,-2245.99"/>
</g>
<!-- l4_attn_stage3_gpu13&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge2062" class="edge">
<title>l4_attn_stage3_gpu13&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3762.3,-2320.03C3776.43,-2313.69 3791.96,-2307.87 3807,-2304.5 3825.49,-2300.36 4475.7,-2307.99 4489,-2294.5 4517.36,-2265.72 4469.79,-2239.89 4424.82,-2223.26"/>
<polygon fill="red" stroke="red" points="4425.88,-2219.93 4415.29,-2219.86 4423.53,-2226.52 4425.88,-2219.93"/>
<text text-anchor="middle" x="4528.5" y="-2283.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu14 -->
<g id="node1055" class="node">
<title>l4_attn_stage4_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3904" cy="-2203" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3904" y="-2214.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="3904" y="-2199.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3904" y="-2184.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu14&#45;&gt;l4_attn_stage4_gpu14 -->
<g id="edge991" class="edge">
<title>l4_attn_stage3_gpu14&#45;&gt;l4_attn_stage4_gpu14</title>
<path fill="none" stroke="black" d="M3850.74,-2319.88C3836.89,-2313.63 3821.71,-2307.89 3807,-2304.5 3783.17,-2299.01 3384.09,-2311.98 3367,-2294.5 3362.34,-2289.73 3362.33,-2284.26 3367,-2279.5 3375.56,-2270.78 3795.37,-2275.26 3807,-2271.5 3825.45,-2265.53 3843.49,-2254.77 3858.92,-2243.57"/>
<polygon fill="black" stroke="black" points="3861.32,-2246.14 3867.2,-2237.33 3857.11,-2240.55 3861.32,-2246.14"/>
</g>
<!-- l4_attn_stage3_gpu14&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge2063" class="edge">
<title>l4_attn_stage3_gpu14&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3957.3,-2320.06C3971.44,-2313.72 3986.96,-2307.89 4002,-2304.5 4017.53,-2301 4563.84,-2305.85 4575,-2294.5 4615.03,-2253.76 4545.32,-2230.4 4475.01,-2217.66"/>
<polygon fill="red" stroke="red" points="4475.55,-2214.2 4465.1,-2215.93 4474.35,-2221.1 4475.55,-2214.2"/>
<text text-anchor="middle" x="4615.5" y="-2283.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage4_gpu15 -->
<g id="node1056" class="node">
<title>l4_attn_stage4_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4099" cy="-2203" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4099" y="-2214.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage4</text>
<text text-anchor="middle" x="4099" y="-2199.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4099" y="-2184.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage3_gpu15&#45;&gt;l4_attn_stage4_gpu15 -->
<g id="edge992" class="edge">
<title>l4_attn_stage3_gpu15&#45;&gt;l4_attn_stage4_gpu15</title>
<path fill="none" stroke="black" d="M4046.02,-2319.93C4032.09,-2313.63 4016.82,-2307.86 4002,-2304.5 3984.99,-2300.64 3386.24,-2306.93 3374,-2294.5 3369.32,-2289.75 3369.32,-2284.24 3374,-2279.5 3386.26,-2267.09 3985.39,-2276.83 4002,-2271.5 4020.46,-2265.58 4038.51,-2254.83 4053.94,-2243.63"/>
<polygon fill="black" stroke="black" points="4056.34,-2246.2 4062.22,-2237.38 4052.13,-2240.61 4056.34,-2246.2"/>
</g>
<!-- l4_attn_stage3_gpu15&#45;&gt;l4_attn_stage4_gpu[next_gpu] -->
<g id="edge2064" class="edge">
<title>l4_attn_stage3_gpu15&#45;&gt;l4_attn_stage4_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4154.38,-2320.68C4169.74,-2314.12 4186.68,-2308.03 4203,-2304.5 4227.87,-2299.12 4643.2,-2312.69 4661,-2294.5 4715.67,-2238.63 4614.45,-2216.96 4515.12,-2208.71"/>
<polygon fill="red" stroke="red" points="4515.15,-2205.2 4504.9,-2207.91 4514.6,-2212.18 4515.15,-2205.2"/>
<text text-anchor="middle" x="4701.5" y="-2283.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu0 -->
<g id="node1057" class="node">
<title>l4_attn_stage5_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1174" cy="-2056" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1174" y="-2067.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="1174" y="-2052.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1174" y="-2037.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu0&#45;&gt;l4_attn_stage5_gpu0 -->
<g id="edge993" class="edge">
<title>l4_attn_stage4_gpu0&#45;&gt;l4_attn_stage5_gpu0</title>
<path fill="none" stroke="black" d="M1174,-2165.41C1174,-2146.69 1174,-2123.7 1174,-2103.72"/>
<polygon fill="black" stroke="black" points="1177.5,-2103.58 1174,-2093.58 1170.5,-2103.58 1177.5,-2103.58"/>
</g>
<!-- l4_attn_stage5_gpu[next_gpu] -->
<g id="node1362" class="node">
<title>l4_attn_stage5_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4361" cy="-2056" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4361" y="-2052.3" font-family="Times,serif" font-size="14.00">l4_attn_stage5_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage4_gpu0&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge2065" class="edge">
<title>l4_attn_stage4_gpu0&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1227.29,-2173C1241.43,-2166.66 1256.95,-2160.85 1272,-2157.5 1501.73,-2106.36 3154.66,-2135.05 3390,-2132.5 3434.94,-2132.01 4154.97,-2133.53 4199,-2124.5 4242.87,-2115.5 4289.77,-2094.58 4321.76,-2078.4"/>
<polygon fill="red" stroke="red" points="4323.49,-2081.45 4330.78,-2073.76 4320.28,-2075.22 4323.49,-2081.45"/>
<text text-anchor="middle" x="3421.5" y="-2136.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu1 -->
<g id="node1058" class="node">
<title>l4_attn_stage5_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1369" cy="-2056" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1369" y="-2067.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="1369" y="-2052.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1369" y="-2037.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu1&#45;&gt;l4_attn_stage5_gpu1 -->
<g id="edge994" class="edge">
<title>l4_attn_stage4_gpu1&#45;&gt;l4_attn_stage5_gpu1</title>
<path fill="none" stroke="black" d="M1369,-2165.41C1369,-2146.69 1369,-2123.7 1369,-2103.72"/>
<polygon fill="black" stroke="black" points="1372.5,-2103.58 1369,-2093.58 1365.5,-2103.58 1372.5,-2103.58"/>
</g>
<!-- l4_attn_stage4_gpu1&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge2066" class="edge">
<title>l4_attn_stage4_gpu1&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1422.28,-2172.93C1436.41,-2166.59 1451.94,-2160.8 1467,-2157.5 1521,-2145.67 3404.82,-2165.76 3457,-2147.5 3467.15,-2143.95 3465.86,-2136.08 3476,-2132.5 3513.87,-2119.12 4159.66,-2132.6 4199,-2124.5 4242.87,-2115.47 4289.77,-2094.56 4321.76,-2078.38"/>
<polygon fill="red" stroke="red" points="4323.48,-2081.43 4330.78,-2073.75 4320.28,-2075.21 4323.48,-2081.43"/>
<text text-anchor="middle" x="3507.5" y="-2136.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu2 -->
<g id="node1059" class="node">
<title>l4_attn_stage5_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1564" cy="-2056" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1564" y="-2067.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="1564" y="-2052.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1564" y="-2037.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu2&#45;&gt;l4_attn_stage5_gpu2 -->
<g id="edge995" class="edge">
<title>l4_attn_stage4_gpu2&#45;&gt;l4_attn_stage5_gpu2</title>
<path fill="none" stroke="black" d="M1564,-2165.41C1564,-2146.69 1564,-2123.7 1564,-2103.72"/>
<polygon fill="black" stroke="black" points="1567.5,-2103.58 1564,-2093.58 1560.5,-2103.58 1567.5,-2103.58"/>
</g>
<!-- l4_attn_stage4_gpu2&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge2067" class="edge">
<title>l4_attn_stage4_gpu2&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1617.28,-2172.93C1631.41,-2166.6 1646.94,-2160.8 1662,-2157.5 1713.04,-2146.31 3493.68,-2164.77 3543,-2147.5 3553.15,-2143.94 3551.86,-2136.09 3562,-2132.5 3595.36,-2120.68 4164.34,-2131.66 4199,-2124.5 4242.86,-2115.44 4289.76,-2094.53 4321.75,-2078.37"/>
<polygon fill="red" stroke="red" points="4323.48,-2081.42 4330.77,-2073.73 4320.28,-2075.19 4323.48,-2081.42"/>
<text text-anchor="middle" x="3593.5" y="-2136.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu3 -->
<g id="node1060" class="node">
<title>l4_attn_stage5_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1759" cy="-2056" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1759" y="-2067.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="1759" y="-2052.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1759" y="-2037.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu3&#45;&gt;l4_attn_stage5_gpu3 -->
<g id="edge996" class="edge">
<title>l4_attn_stage4_gpu3&#45;&gt;l4_attn_stage5_gpu3</title>
<path fill="none" stroke="black" d="M1759,-2165.41C1759,-2146.69 1759,-2123.7 1759,-2103.72"/>
<polygon fill="black" stroke="black" points="1762.5,-2103.58 1759,-2093.58 1755.5,-2103.58 1762.5,-2103.58"/>
</g>
<!-- l4_attn_stage4_gpu3&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge2068" class="edge">
<title>l4_attn_stage4_gpu3&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1812.28,-2172.94C1826.41,-2166.6 1841.94,-2160.8 1857,-2157.5 1905.08,-2146.95 3582.55,-2163.77 3629,-2147.5 3639.15,-2143.94 3637.86,-2136.1 3648,-2132.5 3676.85,-2122.25 4169.02,-2130.72 4199,-2124.5 4242.85,-2115.4 4289.75,-2094.49 4321.75,-2078.34"/>
<polygon fill="red" stroke="red" points="4323.47,-2081.39 4330.77,-2073.71 4320.27,-2075.17 4323.47,-2081.39"/>
<text text-anchor="middle" x="3679.5" y="-2136.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu4 -->
<g id="node1061" class="node">
<title>l4_attn_stage5_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1954" cy="-2056" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1954" y="-2067.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="1954" y="-2052.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1954" y="-2037.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu4&#45;&gt;l4_attn_stage5_gpu4 -->
<g id="edge997" class="edge">
<title>l4_attn_stage4_gpu4&#45;&gt;l4_attn_stage5_gpu4</title>
<path fill="none" stroke="black" d="M1954,-2165.41C1954,-2146.69 1954,-2123.7 1954,-2103.72"/>
<polygon fill="black" stroke="black" points="1957.5,-2103.58 1954,-2093.58 1950.5,-2103.58 1957.5,-2103.58"/>
</g>
<!-- l4_attn_stage4_gpu4&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge2069" class="edge">
<title>l4_attn_stage4_gpu4&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2007.28,-2172.94C2021.41,-2166.6 2036.94,-2160.81 2052,-2157.5 2097.12,-2147.59 3671.41,-2162.78 3715,-2147.5 3725.15,-2143.94 3723.87,-2136.12 3734,-2132.5 3782.67,-2115.13 4148.42,-2135.07 4199,-2124.5 4242.84,-2115.34 4289.74,-2094.44 4321.74,-2078.31"/>
<polygon fill="red" stroke="red" points="4323.46,-2081.36 4330.76,-2073.69 4320.27,-2075.13 4323.46,-2081.36"/>
<text text-anchor="middle" x="3765.5" y="-2136.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu5 -->
<g id="node1062" class="node">
<title>l4_attn_stage5_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2149" cy="-2056" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2149" y="-2067.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="2149" y="-2052.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2149" y="-2037.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu5&#45;&gt;l4_attn_stage5_gpu5 -->
<g id="edge998" class="edge">
<title>l4_attn_stage4_gpu5&#45;&gt;l4_attn_stage5_gpu5</title>
<path fill="none" stroke="black" d="M2149,-2165.41C2149,-2146.69 2149,-2123.7 2149,-2103.72"/>
<polygon fill="black" stroke="black" points="2152.5,-2103.58 2149,-2093.58 2145.5,-2103.58 2152.5,-2103.58"/>
</g>
<!-- l4_attn_stage4_gpu5&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge2070" class="edge">
<title>l4_attn_stage4_gpu5&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2202.28,-2172.95C2216.41,-2166.61 2231.94,-2160.81 2247,-2157.5 2289.16,-2148.23 3760.27,-2161.79 3801,-2147.5 3811.15,-2143.94 3809.87,-2136.14 3820,-2132.5 3859.64,-2118.27 4157.79,-2133.2 4199,-2124.5 4242.82,-2115.25 4289.73,-2094.37 4321.73,-2078.26"/>
<polygon fill="red" stroke="red" points="4323.45,-2081.32 4330.75,-2073.65 4320.26,-2075.09 4323.45,-2081.32"/>
<text text-anchor="middle" x="3851.5" y="-2136.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu6 -->
<g id="node1063" class="node">
<title>l4_attn_stage5_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2344" cy="-2056" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2344" y="-2067.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="2344" y="-2052.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2344" y="-2037.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu6&#45;&gt;l4_attn_stage5_gpu6 -->
<g id="edge999" class="edge">
<title>l4_attn_stage4_gpu6&#45;&gt;l4_attn_stage5_gpu6</title>
<path fill="none" stroke="black" d="M2344,-2165.41C2344,-2146.69 2344,-2123.7 2344,-2103.72"/>
<polygon fill="black" stroke="black" points="2347.5,-2103.58 2344,-2093.58 2340.5,-2103.58 2347.5,-2103.58"/>
</g>
<!-- l4_attn_stage4_gpu6&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge2071" class="edge">
<title>l4_attn_stage4_gpu6&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2397.28,-2172.95C2411.41,-2166.61 2426.94,-2160.81 2442,-2157.5 2481.2,-2148.87 3849.13,-2160.8 3887,-2147.5 3897.15,-2143.94 3895.89,-2136.17 3906,-2132.5 3936.62,-2121.4 4167.15,-2131.32 4199,-2124.5 4242.66,-2115.15 4289.41,-2094.39 4321.42,-2078.34"/>
<polygon fill="red" stroke="red" points="4323.12,-2081.4 4330.45,-2073.74 4319.95,-2075.16 4323.12,-2081.4"/>
<text text-anchor="middle" x="3937.5" y="-2136.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu7 -->
<g id="node1064" class="node">
<title>l4_attn_stage5_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2539" cy="-2056" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2539" y="-2067.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="2539" y="-2052.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2539" y="-2037.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu7&#45;&gt;l4_attn_stage5_gpu7 -->
<g id="edge1000" class="edge">
<title>l4_attn_stage4_gpu7&#45;&gt;l4_attn_stage5_gpu7</title>
<path fill="none" stroke="black" d="M2539,-2165.41C2539,-2146.69 2539,-2123.7 2539,-2103.72"/>
<polygon fill="black" stroke="black" points="2542.5,-2103.58 2539,-2093.58 2535.5,-2103.58 2542.5,-2103.58"/>
</g>
<!-- l4_attn_stage4_gpu7&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge2072" class="edge">
<title>l4_attn_stage4_gpu7&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2592.28,-2172.96C2606.42,-2166.62 2621.95,-2160.82 2637,-2157.5 2673.24,-2149.51 3937.99,-2159.8 3973,-2147.5 3983.15,-2143.93 3981.91,-2136.22 3992,-2132.5 4035.19,-2116.57 4154.04,-2134.4 4199,-2124.5 4242.6,-2114.9 4289.37,-2094.17 4321.39,-2078.2"/>
<polygon fill="red" stroke="red" points="4323.08,-2081.27 4330.42,-2073.63 4319.92,-2075.02 4323.08,-2081.27"/>
<text text-anchor="middle" x="4023.5" y="-2136.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu8 -->
<g id="node1065" class="node">
<title>l4_attn_stage5_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2734" cy="-2056" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2734" y="-2067.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="2734" y="-2052.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2734" y="-2037.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu8&#45;&gt;l4_attn_stage5_gpu8 -->
<g id="edge1001" class="edge">
<title>l4_attn_stage4_gpu8&#45;&gt;l4_attn_stage5_gpu8</title>
<path fill="none" stroke="black" d="M2734,-2165.41C2734,-2146.69 2734,-2123.7 2734,-2103.72"/>
<polygon fill="black" stroke="black" points="2737.5,-2103.58 2734,-2093.58 2730.5,-2103.58 2737.5,-2103.58"/>
</g>
<!-- l4_attn_stage4_gpu8&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge2073" class="edge">
<title>l4_attn_stage4_gpu8&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2787.28,-2172.96C2801.42,-2166.62 2816.95,-2160.82 2832,-2157.5 2898.57,-2142.81 3994.69,-2170.12 4059,-2147.5 4069.15,-2143.93 4067.96,-2136.36 4078,-2132.5 4128.3,-2113.15 4146.53,-2136.81 4199,-2124.5 4242.2,-2114.37 4288.67,-2093.92 4320.71,-2078.17"/>
<polygon fill="red" stroke="red" points="4322.38,-2081.25 4329.77,-2073.66 4319.25,-2074.99 4322.38,-2081.25"/>
<text text-anchor="middle" x="4109.5" y="-2136.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu9 -->
<g id="node1066" class="node">
<title>l4_attn_stage5_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2929" cy="-2056" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2929" y="-2067.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="2929" y="-2052.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2929" y="-2037.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu9&#45;&gt;l4_attn_stage5_gpu9 -->
<g id="edge1002" class="edge">
<title>l4_attn_stage4_gpu9&#45;&gt;l4_attn_stage5_gpu9</title>
<path fill="none" stroke="black" d="M2929,-2165.41C2929,-2146.69 2929,-2123.7 2929,-2103.72"/>
<polygon fill="black" stroke="black" points="2932.5,-2103.58 2929,-2093.58 2925.5,-2103.58 2932.5,-2103.58"/>
</g>
<!-- l4_attn_stage4_gpu9&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge2074" class="edge">
<title>l4_attn_stage4_gpu9&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2982.28,-2172.97C2996.42,-2166.63 3011.95,-2160.83 3027,-2157.5 3087.65,-2144.09 4086.41,-2168.13 4145,-2147.5 4155.15,-2143.93 4154.3,-2137.15 4164,-2132.5 4178.39,-2125.61 4183.8,-2129.36 4199,-2124.5 4239.94,-2111.4 4284.95,-2092.24 4317.12,-2077.67"/>
<polygon fill="red" stroke="red" points="4318.61,-2080.84 4326.25,-2073.51 4315.7,-2074.47 4318.61,-2080.84"/>
<text text-anchor="middle" x="4195.5" y="-2136.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu10 -->
<g id="node1067" class="node">
<title>l4_attn_stage5_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3124" cy="-2056" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3124" y="-2067.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="3124" y="-2052.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3124" y="-2037.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu10&#45;&gt;l4_attn_stage5_gpu10 -->
<g id="edge1003" class="edge">
<title>l4_attn_stage4_gpu10&#45;&gt;l4_attn_stage5_gpu10</title>
<path fill="none" stroke="black" d="M3124,-2165.41C3124,-2146.69 3124,-2123.7 3124,-2103.72"/>
<polygon fill="black" stroke="black" points="3127.5,-2103.58 3124,-2093.58 3120.5,-2103.58 3127.5,-2103.58"/>
</g>
<!-- l4_attn_stage4_gpu10&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge2075" class="edge">
<title>l4_attn_stage4_gpu10&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3177.29,-2172.98C3191.42,-2166.64 3206.95,-2160.83 3222,-2157.5 3276.73,-2145.37 4178.13,-2166.15 4231,-2147.5 4241.15,-2143.92 4241.32,-2138.86 4250,-2132.5 4275.22,-2114 4304.5,-2094.15 4326.65,-2079.45"/>
<polygon fill="red" stroke="red" points="4328.66,-2082.32 4335.07,-2073.88 4324.8,-2076.48 4328.66,-2082.32"/>
<text text-anchor="middle" x="4281.5" y="-2136.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu11 -->
<g id="node1068" class="node">
<title>l4_attn_stage5_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3319" cy="-2056" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3319" y="-2067.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="3319" y="-2052.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3319" y="-2037.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu11&#45;&gt;l4_attn_stage5_gpu11 -->
<g id="edge1004" class="edge">
<title>l4_attn_stage4_gpu11&#45;&gt;l4_attn_stage5_gpu11</title>
<path fill="none" stroke="black" d="M3319,-2165.41C3319,-2146.69 3319,-2123.7 3319,-2103.72"/>
<polygon fill="black" stroke="black" points="3322.5,-2103.58 3319,-2093.58 3315.5,-2103.58 3322.5,-2103.58"/>
</g>
<!-- l4_attn_stage4_gpu11&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge2076" class="edge">
<title>l4_attn_stage4_gpu11&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3372.29,-2172.99C3386.42,-2166.65 3401.95,-2160.84 3417,-2157.5 3441.41,-2152.08 4295.88,-2160.88 4317,-2147.5 4338.94,-2133.6 4350.24,-2105.32 4355.85,-2084.05"/>
<polygon fill="red" stroke="red" points="4359.27,-2084.81 4358.18,-2074.27 4352.46,-2083.19 4359.27,-2084.81"/>
<text text-anchor="middle" x="4363.5" y="-2136.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu12 -->
<g id="node1069" class="node">
<title>l4_attn_stage5_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3514" cy="-2056" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3514" y="-2067.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="3514" y="-2052.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3514" y="-2037.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu12&#45;&gt;l4_attn_stage5_gpu12 -->
<g id="edge1005" class="edge">
<title>l4_attn_stage4_gpu12&#45;&gt;l4_attn_stage5_gpu12</title>
<path fill="none" stroke="black" d="M3458.85,-2173.54C3445.43,-2167.5 3430.93,-2161.69 3417,-2157.5 3403.22,-2153.35 3362.36,-2158.44 3353,-2147.5 3318.08,-2106.7 3358.79,-2146.82 3417,-2124.5 3434.78,-2117.68 3452.42,-2106.94 3467.68,-2096.01"/>
<polygon fill="black" stroke="black" points="3469.93,-2098.69 3475.9,-2089.94 3465.77,-2093.06 3469.93,-2098.69"/>
</g>
<!-- l4_attn_stage4_gpu12&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge2077" class="edge">
<title>l4_attn_stage4_gpu12&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3567.29,-2173.01C3581.43,-2166.67 3596.95,-2160.86 3612,-2157.5 3633.45,-2152.72 4387.56,-2163.14 4403,-2147.5 4421.16,-2129.11 4403.89,-2101.42 4386.31,-2081.51"/>
<polygon fill="red" stroke="red" points="4388.75,-2078.99 4379.38,-2074.03 4383.61,-2083.75 4388.75,-2078.99"/>
<text text-anchor="middle" x="4441.5" y="-2136.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu13 -->
<g id="node1070" class="node">
<title>l4_attn_stage5_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3709" cy="-2056" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3709" y="-2067.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="3709" y="-2052.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3709" y="-2037.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu13&#45;&gt;l4_attn_stage5_gpu13 -->
<g id="edge1006" class="edge">
<title>l4_attn_stage4_gpu13&#45;&gt;l4_attn_stage5_gpu13</title>
<path fill="none" stroke="black" d="M3655.7,-2173.06C3641.85,-2166.8 3626.69,-2161.01 3612,-2157.5 3598.37,-2154.24 3369.71,-2157.6 3360,-2147.5 3355.38,-2142.69 3355.36,-2137.29 3360,-2132.5 3369.75,-2122.44 3598.7,-2128.9 3612,-2124.5 3630.4,-2118.4 3648.44,-2107.61 3663.87,-2096.42"/>
<polygon fill="black" stroke="black" points="3666.27,-2098.99 3672.16,-2090.19 3662.06,-2093.4 3666.27,-2098.99"/>
</g>
<!-- l4_attn_stage4_gpu13&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge2078" class="edge">
<title>l4_attn_stage4_gpu13&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3762.3,-2173.03C3776.43,-2166.69 3791.96,-2160.87 3807,-2157.5 3825.49,-2153.36 4475.7,-2160.99 4489,-2147.5 4517.36,-2118.72 4469.79,-2092.89 4424.82,-2076.26"/>
<polygon fill="red" stroke="red" points="4425.88,-2072.93 4415.29,-2072.86 4423.53,-2079.52 4425.88,-2072.93"/>
<text text-anchor="middle" x="4528.5" y="-2136.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu14 -->
<g id="node1071" class="node">
<title>l4_attn_stage5_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3904" cy="-2056" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3904" y="-2067.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="3904" y="-2052.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3904" y="-2037.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu14&#45;&gt;l4_attn_stage5_gpu14 -->
<g id="edge1007" class="edge">
<title>l4_attn_stage4_gpu14&#45;&gt;l4_attn_stage5_gpu14</title>
<path fill="none" stroke="black" d="M3850.74,-2172.88C3836.89,-2166.63 3821.71,-2160.89 3807,-2157.5 3783.17,-2152.01 3384.09,-2164.98 3367,-2147.5 3362.34,-2142.73 3362.33,-2137.26 3367,-2132.5 3375.56,-2123.78 3795.37,-2128.26 3807,-2124.5 3825.45,-2118.53 3843.49,-2107.77 3858.92,-2096.57"/>
<polygon fill="black" stroke="black" points="3861.32,-2099.14 3867.2,-2090.33 3857.11,-2093.55 3861.32,-2099.14"/>
</g>
<!-- l4_attn_stage4_gpu14&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge2079" class="edge">
<title>l4_attn_stage4_gpu14&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3957.3,-2173.06C3971.44,-2166.72 3986.96,-2160.89 4002,-2157.5 4017.53,-2154 4563.84,-2158.85 4575,-2147.5 4615.03,-2106.76 4545.32,-2083.4 4475.01,-2070.66"/>
<polygon fill="red" stroke="red" points="4475.55,-2067.2 4465.1,-2068.93 4474.35,-2074.1 4475.55,-2067.2"/>
<text text-anchor="middle" x="4615.5" y="-2136.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage5_gpu15 -->
<g id="node1072" class="node">
<title>l4_attn_stage5_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4099" cy="-2056" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4099" y="-2067.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage5</text>
<text text-anchor="middle" x="4099" y="-2052.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4099" y="-2037.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage4_gpu15&#45;&gt;l4_attn_stage5_gpu15 -->
<g id="edge1008" class="edge">
<title>l4_attn_stage4_gpu15&#45;&gt;l4_attn_stage5_gpu15</title>
<path fill="none" stroke="black" d="M4046.02,-2172.93C4032.09,-2166.63 4016.82,-2160.86 4002,-2157.5 3984.99,-2153.64 3386.24,-2159.93 3374,-2147.5 3369.32,-2142.75 3369.32,-2137.24 3374,-2132.5 3386.26,-2120.09 3985.39,-2129.83 4002,-2124.5 4020.46,-2118.58 4038.51,-2107.83 4053.94,-2096.63"/>
<polygon fill="black" stroke="black" points="4056.34,-2099.2 4062.22,-2090.38 4052.13,-2093.61 4056.34,-2099.2"/>
</g>
<!-- l4_attn_stage4_gpu15&#45;&gt;l4_attn_stage5_gpu[next_gpu] -->
<g id="edge2080" class="edge">
<title>l4_attn_stage4_gpu15&#45;&gt;l4_attn_stage5_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4154.38,-2173.68C4169.74,-2167.12 4186.68,-2161.03 4203,-2157.5 4227.87,-2152.12 4643.2,-2165.69 4661,-2147.5 4715.67,-2091.63 4614.45,-2069.96 4515.12,-2061.71"/>
<polygon fill="red" stroke="red" points="4515.15,-2058.2 4504.9,-2060.91 4514.6,-2065.18 4515.15,-2058.2"/>
<text text-anchor="middle" x="4701.5" y="-2136.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu0 -->
<g id="node1073" class="node">
<title>l4_attn_stage6_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1174" cy="-1909" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1174" y="-1920.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="1174" y="-1905.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1174" y="-1890.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu0&#45;&gt;l4_attn_stage6_gpu0 -->
<g id="edge1009" class="edge">
<title>l4_attn_stage5_gpu0&#45;&gt;l4_attn_stage6_gpu0</title>
<path fill="none" stroke="black" d="M1174,-2018.41C1174,-1999.69 1174,-1976.7 1174,-1956.72"/>
<polygon fill="black" stroke="black" points="1177.5,-1956.58 1174,-1946.58 1170.5,-1956.58 1177.5,-1956.58"/>
</g>
<!-- l4_attn_stage6_gpu[next_gpu] -->
<g id="node1363" class="node">
<title>l4_attn_stage6_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4361" cy="-1909" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4361" y="-1905.3" font-family="Times,serif" font-size="14.00">l4_attn_stage6_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage5_gpu0&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge2081" class="edge">
<title>l4_attn_stage5_gpu0&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1227.29,-2026C1241.43,-2019.66 1256.95,-2013.85 1272,-2010.5 1501.73,-1959.36 3154.66,-1988.05 3390,-1985.5 3434.94,-1985.01 4154.97,-1986.53 4199,-1977.5 4242.87,-1968.5 4289.77,-1947.58 4321.76,-1931.4"/>
<polygon fill="red" stroke="red" points="4323.49,-1934.45 4330.78,-1926.76 4320.28,-1928.22 4323.49,-1934.45"/>
<text text-anchor="middle" x="3421.5" y="-1989.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu1 -->
<g id="node1074" class="node">
<title>l4_attn_stage6_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1369" cy="-1909" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1369" y="-1920.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="1369" y="-1905.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1369" y="-1890.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu1&#45;&gt;l4_attn_stage6_gpu1 -->
<g id="edge1010" class="edge">
<title>l4_attn_stage5_gpu1&#45;&gt;l4_attn_stage6_gpu1</title>
<path fill="none" stroke="black" d="M1369,-2018.41C1369,-1999.69 1369,-1976.7 1369,-1956.72"/>
<polygon fill="black" stroke="black" points="1372.5,-1956.58 1369,-1946.58 1365.5,-1956.58 1372.5,-1956.58"/>
</g>
<!-- l4_attn_stage5_gpu1&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge2082" class="edge">
<title>l4_attn_stage5_gpu1&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1422.28,-2025.93C1436.41,-2019.59 1451.94,-2013.8 1467,-2010.5 1521,-1998.67 3404.82,-2018.76 3457,-2000.5 3467.15,-1996.95 3465.86,-1989.08 3476,-1985.5 3513.87,-1972.12 4159.66,-1985.6 4199,-1977.5 4242.87,-1968.47 4289.77,-1947.56 4321.76,-1931.38"/>
<polygon fill="red" stroke="red" points="4323.48,-1934.43 4330.78,-1926.75 4320.28,-1928.21 4323.48,-1934.43"/>
<text text-anchor="middle" x="3507.5" y="-1989.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu2 -->
<g id="node1075" class="node">
<title>l4_attn_stage6_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1564" cy="-1909" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1564" y="-1920.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="1564" y="-1905.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1564" y="-1890.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu2&#45;&gt;l4_attn_stage6_gpu2 -->
<g id="edge1011" class="edge">
<title>l4_attn_stage5_gpu2&#45;&gt;l4_attn_stage6_gpu2</title>
<path fill="none" stroke="black" d="M1564,-2018.41C1564,-1999.69 1564,-1976.7 1564,-1956.72"/>
<polygon fill="black" stroke="black" points="1567.5,-1956.58 1564,-1946.58 1560.5,-1956.58 1567.5,-1956.58"/>
</g>
<!-- l4_attn_stage5_gpu2&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge2083" class="edge">
<title>l4_attn_stage5_gpu2&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1617.28,-2025.93C1631.41,-2019.6 1646.94,-2013.8 1662,-2010.5 1713.04,-1999.31 3493.68,-2017.77 3543,-2000.5 3553.15,-1996.94 3551.86,-1989.09 3562,-1985.5 3595.36,-1973.68 4164.34,-1984.66 4199,-1977.5 4242.86,-1968.44 4289.76,-1947.53 4321.75,-1931.37"/>
<polygon fill="red" stroke="red" points="4323.48,-1934.42 4330.77,-1926.73 4320.28,-1928.19 4323.48,-1934.42"/>
<text text-anchor="middle" x="3593.5" y="-1989.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu3 -->
<g id="node1076" class="node">
<title>l4_attn_stage6_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1759" cy="-1909" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1759" y="-1920.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="1759" y="-1905.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1759" y="-1890.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu3&#45;&gt;l4_attn_stage6_gpu3 -->
<g id="edge1012" class="edge">
<title>l4_attn_stage5_gpu3&#45;&gt;l4_attn_stage6_gpu3</title>
<path fill="none" stroke="black" d="M1759,-2018.41C1759,-1999.69 1759,-1976.7 1759,-1956.72"/>
<polygon fill="black" stroke="black" points="1762.5,-1956.58 1759,-1946.58 1755.5,-1956.58 1762.5,-1956.58"/>
</g>
<!-- l4_attn_stage5_gpu3&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge2084" class="edge">
<title>l4_attn_stage5_gpu3&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1812.28,-2025.94C1826.41,-2019.6 1841.94,-2013.8 1857,-2010.5 1905.08,-1999.95 3582.55,-2016.77 3629,-2000.5 3639.15,-1996.94 3637.86,-1989.1 3648,-1985.5 3676.85,-1975.25 4169.02,-1983.72 4199,-1977.5 4242.85,-1968.4 4289.75,-1947.49 4321.75,-1931.34"/>
<polygon fill="red" stroke="red" points="4323.47,-1934.39 4330.77,-1926.71 4320.27,-1928.17 4323.47,-1934.39"/>
<text text-anchor="middle" x="3679.5" y="-1989.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu4 -->
<g id="node1077" class="node">
<title>l4_attn_stage6_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1954" cy="-1909" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1954" y="-1920.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="1954" y="-1905.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1954" y="-1890.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu4&#45;&gt;l4_attn_stage6_gpu4 -->
<g id="edge1013" class="edge">
<title>l4_attn_stage5_gpu4&#45;&gt;l4_attn_stage6_gpu4</title>
<path fill="none" stroke="black" d="M1954,-2018.41C1954,-1999.69 1954,-1976.7 1954,-1956.72"/>
<polygon fill="black" stroke="black" points="1957.5,-1956.58 1954,-1946.58 1950.5,-1956.58 1957.5,-1956.58"/>
</g>
<!-- l4_attn_stage5_gpu4&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge2085" class="edge">
<title>l4_attn_stage5_gpu4&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2007.28,-2025.94C2021.41,-2019.6 2036.94,-2013.81 2052,-2010.5 2097.12,-2000.59 3671.41,-2015.78 3715,-2000.5 3725.15,-1996.94 3723.87,-1989.12 3734,-1985.5 3782.67,-1968.13 4148.42,-1988.07 4199,-1977.5 4242.84,-1968.34 4289.74,-1947.44 4321.74,-1931.31"/>
<polygon fill="red" stroke="red" points="4323.46,-1934.36 4330.76,-1926.69 4320.27,-1928.13 4323.46,-1934.36"/>
<text text-anchor="middle" x="3765.5" y="-1989.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu5 -->
<g id="node1078" class="node">
<title>l4_attn_stage6_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2149" cy="-1909" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2149" y="-1920.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="2149" y="-1905.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2149" y="-1890.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu5&#45;&gt;l4_attn_stage6_gpu5 -->
<g id="edge1014" class="edge">
<title>l4_attn_stage5_gpu5&#45;&gt;l4_attn_stage6_gpu5</title>
<path fill="none" stroke="black" d="M2149,-2018.41C2149,-1999.69 2149,-1976.7 2149,-1956.72"/>
<polygon fill="black" stroke="black" points="2152.5,-1956.58 2149,-1946.58 2145.5,-1956.58 2152.5,-1956.58"/>
</g>
<!-- l4_attn_stage5_gpu5&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge2086" class="edge">
<title>l4_attn_stage5_gpu5&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2202.28,-2025.95C2216.41,-2019.61 2231.94,-2013.81 2247,-2010.5 2289.16,-2001.23 3760.27,-2014.79 3801,-2000.5 3811.15,-1996.94 3809.87,-1989.14 3820,-1985.5 3859.64,-1971.27 4157.79,-1986.2 4199,-1977.5 4242.82,-1968.25 4289.73,-1947.37 4321.73,-1931.26"/>
<polygon fill="red" stroke="red" points="4323.45,-1934.32 4330.75,-1926.65 4320.26,-1928.09 4323.45,-1934.32"/>
<text text-anchor="middle" x="3851.5" y="-1989.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu6 -->
<g id="node1079" class="node">
<title>l4_attn_stage6_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2344" cy="-1909" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2344" y="-1920.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="2344" y="-1905.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2344" y="-1890.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu6&#45;&gt;l4_attn_stage6_gpu6 -->
<g id="edge1015" class="edge">
<title>l4_attn_stage5_gpu6&#45;&gt;l4_attn_stage6_gpu6</title>
<path fill="none" stroke="black" d="M2344,-2018.41C2344,-1999.69 2344,-1976.7 2344,-1956.72"/>
<polygon fill="black" stroke="black" points="2347.5,-1956.58 2344,-1946.58 2340.5,-1956.58 2347.5,-1956.58"/>
</g>
<!-- l4_attn_stage5_gpu6&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge2087" class="edge">
<title>l4_attn_stage5_gpu6&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2397.28,-2025.95C2411.41,-2019.61 2426.94,-2013.81 2442,-2010.5 2481.2,-2001.87 3849.13,-2013.8 3887,-2000.5 3897.15,-1996.94 3895.89,-1989.17 3906,-1985.5 3936.62,-1974.4 4167.15,-1984.32 4199,-1977.5 4242.66,-1968.15 4289.41,-1947.39 4321.42,-1931.34"/>
<polygon fill="red" stroke="red" points="4323.12,-1934.4 4330.45,-1926.74 4319.95,-1928.16 4323.12,-1934.4"/>
<text text-anchor="middle" x="3937.5" y="-1989.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu7 -->
<g id="node1080" class="node">
<title>l4_attn_stage6_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2539" cy="-1909" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2539" y="-1920.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="2539" y="-1905.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2539" y="-1890.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu7&#45;&gt;l4_attn_stage6_gpu7 -->
<g id="edge1016" class="edge">
<title>l4_attn_stage5_gpu7&#45;&gt;l4_attn_stage6_gpu7</title>
<path fill="none" stroke="black" d="M2539,-2018.41C2539,-1999.69 2539,-1976.7 2539,-1956.72"/>
<polygon fill="black" stroke="black" points="2542.5,-1956.58 2539,-1946.58 2535.5,-1956.58 2542.5,-1956.58"/>
</g>
<!-- l4_attn_stage5_gpu7&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge2088" class="edge">
<title>l4_attn_stage5_gpu7&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2592.28,-2025.96C2606.42,-2019.62 2621.95,-2013.82 2637,-2010.5 2673.24,-2002.51 3937.99,-2012.8 3973,-2000.5 3983.15,-1996.93 3981.91,-1989.22 3992,-1985.5 4035.19,-1969.57 4154.04,-1987.4 4199,-1977.5 4242.6,-1967.9 4289.37,-1947.17 4321.39,-1931.2"/>
<polygon fill="red" stroke="red" points="4323.08,-1934.27 4330.42,-1926.63 4319.92,-1928.02 4323.08,-1934.27"/>
<text text-anchor="middle" x="4023.5" y="-1989.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu8 -->
<g id="node1081" class="node">
<title>l4_attn_stage6_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2734" cy="-1909" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2734" y="-1920.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="2734" y="-1905.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2734" y="-1890.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu8&#45;&gt;l4_attn_stage6_gpu8 -->
<g id="edge1017" class="edge">
<title>l4_attn_stage5_gpu8&#45;&gt;l4_attn_stage6_gpu8</title>
<path fill="none" stroke="black" d="M2734,-2018.41C2734,-1999.69 2734,-1976.7 2734,-1956.72"/>
<polygon fill="black" stroke="black" points="2737.5,-1956.58 2734,-1946.58 2730.5,-1956.58 2737.5,-1956.58"/>
</g>
<!-- l4_attn_stage5_gpu8&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge2089" class="edge">
<title>l4_attn_stage5_gpu8&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2787.28,-2025.96C2801.42,-2019.62 2816.95,-2013.82 2832,-2010.5 2898.57,-1995.81 3994.69,-2023.12 4059,-2000.5 4069.15,-1996.93 4067.96,-1989.36 4078,-1985.5 4128.3,-1966.15 4146.53,-1989.81 4199,-1977.5 4242.2,-1967.37 4288.67,-1946.92 4320.71,-1931.17"/>
<polygon fill="red" stroke="red" points="4322.38,-1934.25 4329.77,-1926.66 4319.25,-1927.99 4322.38,-1934.25"/>
<text text-anchor="middle" x="4109.5" y="-1989.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu9 -->
<g id="node1082" class="node">
<title>l4_attn_stage6_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2929" cy="-1909" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2929" y="-1920.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="2929" y="-1905.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2929" y="-1890.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu9&#45;&gt;l4_attn_stage6_gpu9 -->
<g id="edge1018" class="edge">
<title>l4_attn_stage5_gpu9&#45;&gt;l4_attn_stage6_gpu9</title>
<path fill="none" stroke="black" d="M2929,-2018.41C2929,-1999.69 2929,-1976.7 2929,-1956.72"/>
<polygon fill="black" stroke="black" points="2932.5,-1956.58 2929,-1946.58 2925.5,-1956.58 2932.5,-1956.58"/>
</g>
<!-- l4_attn_stage5_gpu9&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge2090" class="edge">
<title>l4_attn_stage5_gpu9&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2982.28,-2025.97C2996.42,-2019.63 3011.95,-2013.83 3027,-2010.5 3087.65,-1997.09 4086.41,-2021.13 4145,-2000.5 4155.15,-1996.93 4154.3,-1990.15 4164,-1985.5 4178.39,-1978.61 4183.8,-1982.36 4199,-1977.5 4239.94,-1964.4 4284.95,-1945.24 4317.12,-1930.67"/>
<polygon fill="red" stroke="red" points="4318.61,-1933.84 4326.25,-1926.51 4315.7,-1927.47 4318.61,-1933.84"/>
<text text-anchor="middle" x="4195.5" y="-1989.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu10 -->
<g id="node1083" class="node">
<title>l4_attn_stage6_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3124" cy="-1909" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3124" y="-1920.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="3124" y="-1905.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3124" y="-1890.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu10&#45;&gt;l4_attn_stage6_gpu10 -->
<g id="edge1019" class="edge">
<title>l4_attn_stage5_gpu10&#45;&gt;l4_attn_stage6_gpu10</title>
<path fill="none" stroke="black" d="M3124,-2018.41C3124,-1999.69 3124,-1976.7 3124,-1956.72"/>
<polygon fill="black" stroke="black" points="3127.5,-1956.58 3124,-1946.58 3120.5,-1956.58 3127.5,-1956.58"/>
</g>
<!-- l4_attn_stage5_gpu10&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge2091" class="edge">
<title>l4_attn_stage5_gpu10&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3177.29,-2025.98C3191.42,-2019.64 3206.95,-2013.83 3222,-2010.5 3276.73,-1998.37 4178.13,-2019.15 4231,-2000.5 4241.15,-1996.92 4241.32,-1991.86 4250,-1985.5 4275.22,-1967 4304.5,-1947.15 4326.65,-1932.45"/>
<polygon fill="red" stroke="red" points="4328.66,-1935.32 4335.07,-1926.88 4324.8,-1929.48 4328.66,-1935.32"/>
<text text-anchor="middle" x="4281.5" y="-1989.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu11 -->
<g id="node1084" class="node">
<title>l4_attn_stage6_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3319" cy="-1909" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3319" y="-1920.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="3319" y="-1905.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3319" y="-1890.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu11&#45;&gt;l4_attn_stage6_gpu11 -->
<g id="edge1020" class="edge">
<title>l4_attn_stage5_gpu11&#45;&gt;l4_attn_stage6_gpu11</title>
<path fill="none" stroke="black" d="M3319,-2018.41C3319,-1999.69 3319,-1976.7 3319,-1956.72"/>
<polygon fill="black" stroke="black" points="3322.5,-1956.58 3319,-1946.58 3315.5,-1956.58 3322.5,-1956.58"/>
</g>
<!-- l4_attn_stage5_gpu11&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge2092" class="edge">
<title>l4_attn_stage5_gpu11&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3372.29,-2025.99C3386.42,-2019.65 3401.95,-2013.84 3417,-2010.5 3441.41,-2005.08 4295.88,-2013.88 4317,-2000.5 4338.94,-1986.6 4350.24,-1958.32 4355.85,-1937.05"/>
<polygon fill="red" stroke="red" points="4359.27,-1937.81 4358.18,-1927.27 4352.46,-1936.19 4359.27,-1937.81"/>
<text text-anchor="middle" x="4363.5" y="-1989.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu12 -->
<g id="node1085" class="node">
<title>l4_attn_stage6_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3514" cy="-1909" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3514" y="-1920.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="3514" y="-1905.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3514" y="-1890.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu12&#45;&gt;l4_attn_stage6_gpu12 -->
<g id="edge1021" class="edge">
<title>l4_attn_stage5_gpu12&#45;&gt;l4_attn_stage6_gpu12</title>
<path fill="none" stroke="black" d="M3458.85,-2026.54C3445.43,-2020.5 3430.93,-2014.69 3417,-2010.5 3403.22,-2006.35 3362.36,-2011.44 3353,-2000.5 3318.08,-1959.7 3358.79,-1999.82 3417,-1977.5 3434.78,-1970.68 3452.42,-1959.94 3467.68,-1949.01"/>
<polygon fill="black" stroke="black" points="3469.93,-1951.69 3475.9,-1942.94 3465.77,-1946.06 3469.93,-1951.69"/>
</g>
<!-- l4_attn_stage5_gpu12&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge2093" class="edge">
<title>l4_attn_stage5_gpu12&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3567.29,-2026.01C3581.43,-2019.67 3596.95,-2013.86 3612,-2010.5 3633.45,-2005.72 4387.56,-2016.14 4403,-2000.5 4421.16,-1982.11 4403.89,-1954.42 4386.31,-1934.51"/>
<polygon fill="red" stroke="red" points="4388.75,-1931.99 4379.38,-1927.03 4383.61,-1936.75 4388.75,-1931.99"/>
<text text-anchor="middle" x="4441.5" y="-1989.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu13 -->
<g id="node1086" class="node">
<title>l4_attn_stage6_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3709" cy="-1909" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3709" y="-1920.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="3709" y="-1905.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3709" y="-1890.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu13&#45;&gt;l4_attn_stage6_gpu13 -->
<g id="edge1022" class="edge">
<title>l4_attn_stage5_gpu13&#45;&gt;l4_attn_stage6_gpu13</title>
<path fill="none" stroke="black" d="M3655.7,-2026.06C3641.85,-2019.8 3626.69,-2014.01 3612,-2010.5 3598.37,-2007.24 3369.71,-2010.6 3360,-2000.5 3355.38,-1995.69 3355.36,-1990.29 3360,-1985.5 3369.75,-1975.44 3598.7,-1981.9 3612,-1977.5 3630.4,-1971.4 3648.44,-1960.61 3663.87,-1949.42"/>
<polygon fill="black" stroke="black" points="3666.27,-1951.99 3672.16,-1943.19 3662.06,-1946.4 3666.27,-1951.99"/>
</g>
<!-- l4_attn_stage5_gpu13&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge2094" class="edge">
<title>l4_attn_stage5_gpu13&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3762.3,-2026.03C3776.43,-2019.69 3791.96,-2013.87 3807,-2010.5 3825.49,-2006.36 4475.7,-2013.99 4489,-2000.5 4517.36,-1971.72 4469.79,-1945.89 4424.82,-1929.26"/>
<polygon fill="red" stroke="red" points="4425.88,-1925.93 4415.29,-1925.86 4423.53,-1932.52 4425.88,-1925.93"/>
<text text-anchor="middle" x="4528.5" y="-1989.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu14 -->
<g id="node1087" class="node">
<title>l4_attn_stage6_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3904" cy="-1909" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3904" y="-1920.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="3904" y="-1905.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3904" y="-1890.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu14&#45;&gt;l4_attn_stage6_gpu14 -->
<g id="edge1023" class="edge">
<title>l4_attn_stage5_gpu14&#45;&gt;l4_attn_stage6_gpu14</title>
<path fill="none" stroke="black" d="M3850.74,-2025.88C3836.89,-2019.63 3821.71,-2013.89 3807,-2010.5 3783.17,-2005.01 3384.09,-2017.98 3367,-2000.5 3362.34,-1995.73 3362.33,-1990.26 3367,-1985.5 3375.56,-1976.78 3795.37,-1981.26 3807,-1977.5 3825.45,-1971.53 3843.49,-1960.77 3858.92,-1949.57"/>
<polygon fill="black" stroke="black" points="3861.32,-1952.14 3867.2,-1943.33 3857.11,-1946.55 3861.32,-1952.14"/>
</g>
<!-- l4_attn_stage5_gpu14&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge2095" class="edge">
<title>l4_attn_stage5_gpu14&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3957.3,-2026.06C3971.44,-2019.72 3986.96,-2013.89 4002,-2010.5 4017.53,-2007 4563.84,-2011.85 4575,-2000.5 4615.03,-1959.76 4545.32,-1936.4 4475.01,-1923.66"/>
<polygon fill="red" stroke="red" points="4475.55,-1920.2 4465.1,-1921.93 4474.35,-1927.1 4475.55,-1920.2"/>
<text text-anchor="middle" x="4615.5" y="-1989.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage6_gpu15 -->
<g id="node1088" class="node">
<title>l4_attn_stage6_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4099" cy="-1909" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4099" y="-1920.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage6</text>
<text text-anchor="middle" x="4099" y="-1905.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4099" y="-1890.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage5_gpu15&#45;&gt;l4_attn_stage6_gpu15 -->
<g id="edge1024" class="edge">
<title>l4_attn_stage5_gpu15&#45;&gt;l4_attn_stage6_gpu15</title>
<path fill="none" stroke="black" d="M4046.02,-2025.93C4032.09,-2019.63 4016.82,-2013.86 4002,-2010.5 3984.99,-2006.64 3386.24,-2012.93 3374,-2000.5 3369.32,-1995.75 3369.32,-1990.24 3374,-1985.5 3386.26,-1973.09 3985.39,-1982.83 4002,-1977.5 4020.46,-1971.58 4038.51,-1960.83 4053.94,-1949.63"/>
<polygon fill="black" stroke="black" points="4056.34,-1952.2 4062.22,-1943.38 4052.13,-1946.61 4056.34,-1952.2"/>
</g>
<!-- l4_attn_stage5_gpu15&#45;&gt;l4_attn_stage6_gpu[next_gpu] -->
<g id="edge2096" class="edge">
<title>l4_attn_stage5_gpu15&#45;&gt;l4_attn_stage6_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4154.38,-2026.68C4169.74,-2020.12 4186.68,-2014.03 4203,-2010.5 4227.87,-2005.12 4643.2,-2018.69 4661,-2000.5 4715.67,-1944.63 4614.45,-1922.96 4515.12,-1914.71"/>
<polygon fill="red" stroke="red" points="4515.15,-1911.2 4504.9,-1913.91 4514.6,-1918.18 4515.15,-1911.2"/>
<text text-anchor="middle" x="4701.5" y="-1989.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu0 -->
<g id="node1089" class="node">
<title>l4_attn_stage7_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1174" cy="-1762" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1174" y="-1773.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="1174" y="-1758.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1174" y="-1743.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu0&#45;&gt;l4_attn_stage7_gpu0 -->
<g id="edge1025" class="edge">
<title>l4_attn_stage6_gpu0&#45;&gt;l4_attn_stage7_gpu0</title>
<path fill="none" stroke="black" d="M1174,-1871.41C1174,-1852.69 1174,-1829.7 1174,-1809.72"/>
<polygon fill="black" stroke="black" points="1177.5,-1809.58 1174,-1799.58 1170.5,-1809.58 1177.5,-1809.58"/>
</g>
<!-- l4_attn_stage7_gpu[next_gpu] -->
<g id="node1364" class="node">
<title>l4_attn_stage7_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4361" cy="-1762" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4361" y="-1758.3" font-family="Times,serif" font-size="14.00">l4_attn_stage7_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage6_gpu0&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge2097" class="edge">
<title>l4_attn_stage6_gpu0&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1227.29,-1879C1241.43,-1872.66 1256.95,-1866.85 1272,-1863.5 1501.73,-1812.36 3154.66,-1841.05 3390,-1838.5 3434.94,-1838.01 4154.97,-1839.53 4199,-1830.5 4242.87,-1821.5 4289.77,-1800.58 4321.76,-1784.4"/>
<polygon fill="red" stroke="red" points="4323.49,-1787.45 4330.78,-1779.76 4320.28,-1781.22 4323.49,-1787.45"/>
<text text-anchor="middle" x="3421.5" y="-1842.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu1 -->
<g id="node1090" class="node">
<title>l4_attn_stage7_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1369" cy="-1762" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1369" y="-1773.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="1369" y="-1758.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1369" y="-1743.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu1&#45;&gt;l4_attn_stage7_gpu1 -->
<g id="edge1026" class="edge">
<title>l4_attn_stage6_gpu1&#45;&gt;l4_attn_stage7_gpu1</title>
<path fill="none" stroke="black" d="M1369,-1871.41C1369,-1852.69 1369,-1829.7 1369,-1809.72"/>
<polygon fill="black" stroke="black" points="1372.5,-1809.58 1369,-1799.58 1365.5,-1809.58 1372.5,-1809.58"/>
</g>
<!-- l4_attn_stage6_gpu1&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge2098" class="edge">
<title>l4_attn_stage6_gpu1&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1422.28,-1878.93C1436.41,-1872.59 1451.94,-1866.8 1467,-1863.5 1521,-1851.67 3404.82,-1871.76 3457,-1853.5 3467.15,-1849.95 3465.86,-1842.08 3476,-1838.5 3513.87,-1825.12 4159.66,-1838.6 4199,-1830.5 4242.87,-1821.47 4289.77,-1800.56 4321.76,-1784.38"/>
<polygon fill="red" stroke="red" points="4323.48,-1787.43 4330.78,-1779.75 4320.28,-1781.21 4323.48,-1787.43"/>
<text text-anchor="middle" x="3507.5" y="-1842.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu2 -->
<g id="node1091" class="node">
<title>l4_attn_stage7_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1564" cy="-1762" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1564" y="-1773.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="1564" y="-1758.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1564" y="-1743.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu2&#45;&gt;l4_attn_stage7_gpu2 -->
<g id="edge1027" class="edge">
<title>l4_attn_stage6_gpu2&#45;&gt;l4_attn_stage7_gpu2</title>
<path fill="none" stroke="black" d="M1564,-1871.41C1564,-1852.69 1564,-1829.7 1564,-1809.72"/>
<polygon fill="black" stroke="black" points="1567.5,-1809.58 1564,-1799.58 1560.5,-1809.58 1567.5,-1809.58"/>
</g>
<!-- l4_attn_stage6_gpu2&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge2099" class="edge">
<title>l4_attn_stage6_gpu2&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1617.28,-1878.93C1631.41,-1872.6 1646.94,-1866.8 1662,-1863.5 1713.04,-1852.31 3493.68,-1870.77 3543,-1853.5 3553.15,-1849.94 3551.86,-1842.09 3562,-1838.5 3595.36,-1826.68 4164.34,-1837.66 4199,-1830.5 4242.86,-1821.44 4289.76,-1800.53 4321.75,-1784.37"/>
<polygon fill="red" stroke="red" points="4323.48,-1787.42 4330.77,-1779.73 4320.28,-1781.19 4323.48,-1787.42"/>
<text text-anchor="middle" x="3593.5" y="-1842.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu3 -->
<g id="node1092" class="node">
<title>l4_attn_stage7_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1759" cy="-1762" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1759" y="-1773.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="1759" y="-1758.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1759" y="-1743.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu3&#45;&gt;l4_attn_stage7_gpu3 -->
<g id="edge1028" class="edge">
<title>l4_attn_stage6_gpu3&#45;&gt;l4_attn_stage7_gpu3</title>
<path fill="none" stroke="black" d="M1759,-1871.41C1759,-1852.69 1759,-1829.7 1759,-1809.72"/>
<polygon fill="black" stroke="black" points="1762.5,-1809.58 1759,-1799.58 1755.5,-1809.58 1762.5,-1809.58"/>
</g>
<!-- l4_attn_stage6_gpu3&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge2100" class="edge">
<title>l4_attn_stage6_gpu3&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1812.28,-1878.94C1826.41,-1872.6 1841.94,-1866.8 1857,-1863.5 1905.08,-1852.95 3582.55,-1869.77 3629,-1853.5 3639.15,-1849.94 3637.86,-1842.1 3648,-1838.5 3676.85,-1828.25 4169.02,-1836.72 4199,-1830.5 4242.85,-1821.4 4289.75,-1800.49 4321.75,-1784.34"/>
<polygon fill="red" stroke="red" points="4323.47,-1787.39 4330.77,-1779.71 4320.27,-1781.17 4323.47,-1787.39"/>
<text text-anchor="middle" x="3679.5" y="-1842.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu4 -->
<g id="node1093" class="node">
<title>l4_attn_stage7_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1954" cy="-1762" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1954" y="-1773.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="1954" y="-1758.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1954" y="-1743.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu4&#45;&gt;l4_attn_stage7_gpu4 -->
<g id="edge1029" class="edge">
<title>l4_attn_stage6_gpu4&#45;&gt;l4_attn_stage7_gpu4</title>
<path fill="none" stroke="black" d="M1954,-1871.41C1954,-1852.69 1954,-1829.7 1954,-1809.72"/>
<polygon fill="black" stroke="black" points="1957.5,-1809.58 1954,-1799.58 1950.5,-1809.58 1957.5,-1809.58"/>
</g>
<!-- l4_attn_stage6_gpu4&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge2101" class="edge">
<title>l4_attn_stage6_gpu4&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2007.28,-1878.94C2021.41,-1872.6 2036.94,-1866.81 2052,-1863.5 2097.12,-1853.59 3671.41,-1868.78 3715,-1853.5 3725.15,-1849.94 3723.87,-1842.12 3734,-1838.5 3782.67,-1821.13 4148.42,-1841.07 4199,-1830.5 4242.84,-1821.34 4289.74,-1800.44 4321.74,-1784.31"/>
<polygon fill="red" stroke="red" points="4323.46,-1787.36 4330.76,-1779.69 4320.27,-1781.13 4323.46,-1787.36"/>
<text text-anchor="middle" x="3765.5" y="-1842.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu5 -->
<g id="node1094" class="node">
<title>l4_attn_stage7_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2149" cy="-1762" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2149" y="-1773.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="2149" y="-1758.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2149" y="-1743.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu5&#45;&gt;l4_attn_stage7_gpu5 -->
<g id="edge1030" class="edge">
<title>l4_attn_stage6_gpu5&#45;&gt;l4_attn_stage7_gpu5</title>
<path fill="none" stroke="black" d="M2149,-1871.41C2149,-1852.69 2149,-1829.7 2149,-1809.72"/>
<polygon fill="black" stroke="black" points="2152.5,-1809.58 2149,-1799.58 2145.5,-1809.58 2152.5,-1809.58"/>
</g>
<!-- l4_attn_stage6_gpu5&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge2102" class="edge">
<title>l4_attn_stage6_gpu5&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2202.28,-1878.95C2216.41,-1872.61 2231.94,-1866.81 2247,-1863.5 2289.16,-1854.23 3760.27,-1867.79 3801,-1853.5 3811.15,-1849.94 3809.87,-1842.14 3820,-1838.5 3859.64,-1824.27 4157.79,-1839.2 4199,-1830.5 4242.82,-1821.25 4289.73,-1800.37 4321.73,-1784.26"/>
<polygon fill="red" stroke="red" points="4323.45,-1787.32 4330.75,-1779.65 4320.26,-1781.09 4323.45,-1787.32"/>
<text text-anchor="middle" x="3851.5" y="-1842.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu6 -->
<g id="node1095" class="node">
<title>l4_attn_stage7_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2344" cy="-1762" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2344" y="-1773.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="2344" y="-1758.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2344" y="-1743.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu6&#45;&gt;l4_attn_stage7_gpu6 -->
<g id="edge1031" class="edge">
<title>l4_attn_stage6_gpu6&#45;&gt;l4_attn_stage7_gpu6</title>
<path fill="none" stroke="black" d="M2344,-1871.41C2344,-1852.69 2344,-1829.7 2344,-1809.72"/>
<polygon fill="black" stroke="black" points="2347.5,-1809.58 2344,-1799.58 2340.5,-1809.58 2347.5,-1809.58"/>
</g>
<!-- l4_attn_stage6_gpu6&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge2103" class="edge">
<title>l4_attn_stage6_gpu6&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2397.28,-1878.95C2411.41,-1872.61 2426.94,-1866.81 2442,-1863.5 2481.2,-1854.87 3849.13,-1866.8 3887,-1853.5 3897.15,-1849.94 3895.89,-1842.17 3906,-1838.5 3936.62,-1827.4 4167.15,-1837.32 4199,-1830.5 4242.66,-1821.15 4289.41,-1800.39 4321.42,-1784.34"/>
<polygon fill="red" stroke="red" points="4323.12,-1787.4 4330.45,-1779.74 4319.95,-1781.16 4323.12,-1787.4"/>
<text text-anchor="middle" x="3937.5" y="-1842.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu7 -->
<g id="node1096" class="node">
<title>l4_attn_stage7_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2539" cy="-1762" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2539" y="-1773.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="2539" y="-1758.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2539" y="-1743.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu7&#45;&gt;l4_attn_stage7_gpu7 -->
<g id="edge1032" class="edge">
<title>l4_attn_stage6_gpu7&#45;&gt;l4_attn_stage7_gpu7</title>
<path fill="none" stroke="black" d="M2539,-1871.41C2539,-1852.69 2539,-1829.7 2539,-1809.72"/>
<polygon fill="black" stroke="black" points="2542.5,-1809.58 2539,-1799.58 2535.5,-1809.58 2542.5,-1809.58"/>
</g>
<!-- l4_attn_stage6_gpu7&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge2104" class="edge">
<title>l4_attn_stage6_gpu7&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2592.28,-1878.96C2606.42,-1872.62 2621.95,-1866.82 2637,-1863.5 2673.24,-1855.51 3937.99,-1865.8 3973,-1853.5 3983.15,-1849.93 3981.91,-1842.22 3992,-1838.5 4035.19,-1822.57 4154.04,-1840.4 4199,-1830.5 4242.6,-1820.9 4289.37,-1800.17 4321.39,-1784.2"/>
<polygon fill="red" stroke="red" points="4323.08,-1787.27 4330.42,-1779.63 4319.92,-1781.02 4323.08,-1787.27"/>
<text text-anchor="middle" x="4023.5" y="-1842.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu8 -->
<g id="node1097" class="node">
<title>l4_attn_stage7_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2734" cy="-1762" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2734" y="-1773.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="2734" y="-1758.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2734" y="-1743.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu8&#45;&gt;l4_attn_stage7_gpu8 -->
<g id="edge1033" class="edge">
<title>l4_attn_stage6_gpu8&#45;&gt;l4_attn_stage7_gpu8</title>
<path fill="none" stroke="black" d="M2734,-1871.41C2734,-1852.69 2734,-1829.7 2734,-1809.72"/>
<polygon fill="black" stroke="black" points="2737.5,-1809.58 2734,-1799.58 2730.5,-1809.58 2737.5,-1809.58"/>
</g>
<!-- l4_attn_stage6_gpu8&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge2105" class="edge">
<title>l4_attn_stage6_gpu8&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2787.28,-1878.96C2801.42,-1872.62 2816.95,-1866.82 2832,-1863.5 2898.57,-1848.81 3994.69,-1876.12 4059,-1853.5 4069.15,-1849.93 4067.96,-1842.36 4078,-1838.5 4128.3,-1819.15 4146.53,-1842.81 4199,-1830.5 4242.2,-1820.37 4288.67,-1799.92 4320.71,-1784.17"/>
<polygon fill="red" stroke="red" points="4322.38,-1787.25 4329.77,-1779.66 4319.25,-1780.99 4322.38,-1787.25"/>
<text text-anchor="middle" x="4109.5" y="-1842.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu9 -->
<g id="node1098" class="node">
<title>l4_attn_stage7_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2929" cy="-1762" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2929" y="-1773.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="2929" y="-1758.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2929" y="-1743.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu9&#45;&gt;l4_attn_stage7_gpu9 -->
<g id="edge1034" class="edge">
<title>l4_attn_stage6_gpu9&#45;&gt;l4_attn_stage7_gpu9</title>
<path fill="none" stroke="black" d="M2929,-1871.41C2929,-1852.69 2929,-1829.7 2929,-1809.72"/>
<polygon fill="black" stroke="black" points="2932.5,-1809.58 2929,-1799.58 2925.5,-1809.58 2932.5,-1809.58"/>
</g>
<!-- l4_attn_stage6_gpu9&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge2106" class="edge">
<title>l4_attn_stage6_gpu9&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2982.28,-1878.97C2996.42,-1872.63 3011.95,-1866.83 3027,-1863.5 3087.65,-1850.09 4086.41,-1874.13 4145,-1853.5 4155.15,-1849.93 4154.3,-1843.15 4164,-1838.5 4178.39,-1831.61 4183.8,-1835.36 4199,-1830.5 4239.94,-1817.4 4284.95,-1798.24 4317.12,-1783.67"/>
<polygon fill="red" stroke="red" points="4318.61,-1786.84 4326.25,-1779.51 4315.7,-1780.47 4318.61,-1786.84"/>
<text text-anchor="middle" x="4195.5" y="-1842.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu10 -->
<g id="node1099" class="node">
<title>l4_attn_stage7_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3124" cy="-1762" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3124" y="-1773.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="3124" y="-1758.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3124" y="-1743.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu10&#45;&gt;l4_attn_stage7_gpu10 -->
<g id="edge1035" class="edge">
<title>l4_attn_stage6_gpu10&#45;&gt;l4_attn_stage7_gpu10</title>
<path fill="none" stroke="black" d="M3124,-1871.41C3124,-1852.69 3124,-1829.7 3124,-1809.72"/>
<polygon fill="black" stroke="black" points="3127.5,-1809.58 3124,-1799.58 3120.5,-1809.58 3127.5,-1809.58"/>
</g>
<!-- l4_attn_stage6_gpu10&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge2107" class="edge">
<title>l4_attn_stage6_gpu10&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3177.29,-1878.98C3191.42,-1872.64 3206.95,-1866.83 3222,-1863.5 3276.73,-1851.37 4178.13,-1872.15 4231,-1853.5 4241.15,-1849.92 4241.32,-1844.86 4250,-1838.5 4275.22,-1820 4304.5,-1800.15 4326.65,-1785.45"/>
<polygon fill="red" stroke="red" points="4328.66,-1788.32 4335.07,-1779.88 4324.8,-1782.48 4328.66,-1788.32"/>
<text text-anchor="middle" x="4281.5" y="-1842.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu11 -->
<g id="node1100" class="node">
<title>l4_attn_stage7_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3319" cy="-1762" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3319" y="-1773.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="3319" y="-1758.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3319" y="-1743.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu11&#45;&gt;l4_attn_stage7_gpu11 -->
<g id="edge1036" class="edge">
<title>l4_attn_stage6_gpu11&#45;&gt;l4_attn_stage7_gpu11</title>
<path fill="none" stroke="black" d="M3319,-1871.41C3319,-1852.69 3319,-1829.7 3319,-1809.72"/>
<polygon fill="black" stroke="black" points="3322.5,-1809.58 3319,-1799.58 3315.5,-1809.58 3322.5,-1809.58"/>
</g>
<!-- l4_attn_stage6_gpu11&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge2108" class="edge">
<title>l4_attn_stage6_gpu11&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3372.29,-1878.99C3386.42,-1872.65 3401.95,-1866.84 3417,-1863.5 3441.41,-1858.08 4295.88,-1866.88 4317,-1853.5 4338.94,-1839.6 4350.24,-1811.32 4355.85,-1790.05"/>
<polygon fill="red" stroke="red" points="4359.27,-1790.81 4358.18,-1780.27 4352.46,-1789.19 4359.27,-1790.81"/>
<text text-anchor="middle" x="4363.5" y="-1842.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu12 -->
<g id="node1101" class="node">
<title>l4_attn_stage7_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3514" cy="-1762" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3514" y="-1773.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="3514" y="-1758.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3514" y="-1743.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu12&#45;&gt;l4_attn_stage7_gpu12 -->
<g id="edge1037" class="edge">
<title>l4_attn_stage6_gpu12&#45;&gt;l4_attn_stage7_gpu12</title>
<path fill="none" stroke="black" d="M3458.85,-1879.54C3445.43,-1873.5 3430.93,-1867.69 3417,-1863.5 3403.22,-1859.35 3362.36,-1864.44 3353,-1853.5 3318.08,-1812.7 3358.79,-1852.82 3417,-1830.5 3434.78,-1823.68 3452.42,-1812.94 3467.68,-1802.01"/>
<polygon fill="black" stroke="black" points="3469.93,-1804.69 3475.9,-1795.94 3465.77,-1799.06 3469.93,-1804.69"/>
</g>
<!-- l4_attn_stage6_gpu12&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge2109" class="edge">
<title>l4_attn_stage6_gpu12&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3567.29,-1879.01C3581.43,-1872.67 3596.95,-1866.86 3612,-1863.5 3633.45,-1858.72 4387.56,-1869.14 4403,-1853.5 4421.16,-1835.11 4403.89,-1807.42 4386.31,-1787.51"/>
<polygon fill="red" stroke="red" points="4388.75,-1784.99 4379.38,-1780.03 4383.61,-1789.75 4388.75,-1784.99"/>
<text text-anchor="middle" x="4441.5" y="-1842.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu13 -->
<g id="node1102" class="node">
<title>l4_attn_stage7_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3709" cy="-1762" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3709" y="-1773.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="3709" y="-1758.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3709" y="-1743.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu13&#45;&gt;l4_attn_stage7_gpu13 -->
<g id="edge1038" class="edge">
<title>l4_attn_stage6_gpu13&#45;&gt;l4_attn_stage7_gpu13</title>
<path fill="none" stroke="black" d="M3655.7,-1879.06C3641.85,-1872.8 3626.69,-1867.01 3612,-1863.5 3598.37,-1860.24 3369.71,-1863.6 3360,-1853.5 3355.38,-1848.69 3355.36,-1843.29 3360,-1838.5 3369.75,-1828.44 3598.7,-1834.9 3612,-1830.5 3630.4,-1824.4 3648.44,-1813.61 3663.87,-1802.42"/>
<polygon fill="black" stroke="black" points="3666.27,-1804.99 3672.16,-1796.19 3662.06,-1799.4 3666.27,-1804.99"/>
</g>
<!-- l4_attn_stage6_gpu13&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge2110" class="edge">
<title>l4_attn_stage6_gpu13&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3762.3,-1879.03C3776.43,-1872.69 3791.96,-1866.87 3807,-1863.5 3825.49,-1859.36 4475.7,-1866.99 4489,-1853.5 4517.36,-1824.72 4469.79,-1798.89 4424.82,-1782.26"/>
<polygon fill="red" stroke="red" points="4425.88,-1778.93 4415.29,-1778.86 4423.53,-1785.52 4425.88,-1778.93"/>
<text text-anchor="middle" x="4528.5" y="-1842.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu14 -->
<g id="node1103" class="node">
<title>l4_attn_stage7_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3904" cy="-1762" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3904" y="-1773.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="3904" y="-1758.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3904" y="-1743.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu14&#45;&gt;l4_attn_stage7_gpu14 -->
<g id="edge1039" class="edge">
<title>l4_attn_stage6_gpu14&#45;&gt;l4_attn_stage7_gpu14</title>
<path fill="none" stroke="black" d="M3850.74,-1878.88C3836.89,-1872.63 3821.71,-1866.89 3807,-1863.5 3783.17,-1858.01 3384.09,-1870.98 3367,-1853.5 3362.34,-1848.73 3362.33,-1843.26 3367,-1838.5 3375.56,-1829.78 3795.37,-1834.26 3807,-1830.5 3825.45,-1824.53 3843.49,-1813.77 3858.92,-1802.57"/>
<polygon fill="black" stroke="black" points="3861.32,-1805.14 3867.2,-1796.33 3857.11,-1799.55 3861.32,-1805.14"/>
</g>
<!-- l4_attn_stage6_gpu14&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge2111" class="edge">
<title>l4_attn_stage6_gpu14&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3957.3,-1879.06C3971.44,-1872.72 3986.96,-1866.89 4002,-1863.5 4017.53,-1860 4563.84,-1864.85 4575,-1853.5 4615.03,-1812.76 4545.32,-1789.4 4475.01,-1776.66"/>
<polygon fill="red" stroke="red" points="4475.55,-1773.2 4465.1,-1774.93 4474.35,-1780.1 4475.55,-1773.2"/>
<text text-anchor="middle" x="4615.5" y="-1842.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage7_gpu15 -->
<g id="node1104" class="node">
<title>l4_attn_stage7_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4099" cy="-1762" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4099" y="-1773.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage7</text>
<text text-anchor="middle" x="4099" y="-1758.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4099" y="-1743.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage6_gpu15&#45;&gt;l4_attn_stage7_gpu15 -->
<g id="edge1040" class="edge">
<title>l4_attn_stage6_gpu15&#45;&gt;l4_attn_stage7_gpu15</title>
<path fill="none" stroke="black" d="M4046.02,-1878.93C4032.09,-1872.63 4016.82,-1866.86 4002,-1863.5 3984.99,-1859.64 3386.24,-1865.93 3374,-1853.5 3369.32,-1848.75 3369.32,-1843.24 3374,-1838.5 3386.26,-1826.09 3985.39,-1835.83 4002,-1830.5 4020.46,-1824.58 4038.51,-1813.83 4053.94,-1802.63"/>
<polygon fill="black" stroke="black" points="4056.34,-1805.2 4062.22,-1796.38 4052.13,-1799.61 4056.34,-1805.2"/>
</g>
<!-- l4_attn_stage6_gpu15&#45;&gt;l4_attn_stage7_gpu[next_gpu] -->
<g id="edge2112" class="edge">
<title>l4_attn_stage6_gpu15&#45;&gt;l4_attn_stage7_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4154.38,-1879.68C4169.74,-1873.12 4186.68,-1867.03 4203,-1863.5 4227.87,-1858.12 4643.2,-1871.69 4661,-1853.5 4715.67,-1797.63 4614.45,-1775.96 4515.12,-1767.71"/>
<polygon fill="red" stroke="red" points="4515.15,-1764.2 4504.9,-1766.91 4514.6,-1771.18 4515.15,-1764.2"/>
<text text-anchor="middle" x="4701.5" y="-1842.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu0 -->
<g id="node1105" class="node">
<title>l4_attn_stage8_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1174" cy="-1615" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1174" y="-1626.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="1174" y="-1611.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1174" y="-1596.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu0&#45;&gt;l4_attn_stage8_gpu0 -->
<g id="edge1041" class="edge">
<title>l4_attn_stage7_gpu0&#45;&gt;l4_attn_stage8_gpu0</title>
<path fill="none" stroke="black" d="M1174,-1724.41C1174,-1705.69 1174,-1682.7 1174,-1662.72"/>
<polygon fill="black" stroke="black" points="1177.5,-1662.58 1174,-1652.58 1170.5,-1662.58 1177.5,-1662.58"/>
</g>
<!-- l4_attn_stage8_gpu[next_gpu] -->
<g id="node1365" class="node">
<title>l4_attn_stage8_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4361" cy="-1615" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4361" y="-1611.3" font-family="Times,serif" font-size="14.00">l4_attn_stage8_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage7_gpu0&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge2113" class="edge">
<title>l4_attn_stage7_gpu0&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1227.29,-1732C1241.43,-1725.66 1256.95,-1719.85 1272,-1716.5 1501.73,-1665.36 3154.66,-1694.05 3390,-1691.5 3434.94,-1691.01 4154.97,-1692.53 4199,-1683.5 4242.87,-1674.5 4289.77,-1653.58 4321.76,-1637.4"/>
<polygon fill="red" stroke="red" points="4323.49,-1640.45 4330.78,-1632.76 4320.28,-1634.22 4323.49,-1640.45"/>
<text text-anchor="middle" x="3421.5" y="-1695.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu1 -->
<g id="node1106" class="node">
<title>l4_attn_stage8_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1369" cy="-1615" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1369" y="-1626.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="1369" y="-1611.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1369" y="-1596.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu1&#45;&gt;l4_attn_stage8_gpu1 -->
<g id="edge1042" class="edge">
<title>l4_attn_stage7_gpu1&#45;&gt;l4_attn_stage8_gpu1</title>
<path fill="none" stroke="black" d="M1369,-1724.41C1369,-1705.69 1369,-1682.7 1369,-1662.72"/>
<polygon fill="black" stroke="black" points="1372.5,-1662.58 1369,-1652.58 1365.5,-1662.58 1372.5,-1662.58"/>
</g>
<!-- l4_attn_stage7_gpu1&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge2114" class="edge">
<title>l4_attn_stage7_gpu1&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1422.28,-1731.93C1436.41,-1725.59 1451.94,-1719.8 1467,-1716.5 1521,-1704.67 3404.82,-1724.76 3457,-1706.5 3467.15,-1702.95 3465.86,-1695.08 3476,-1691.5 3513.87,-1678.12 4159.66,-1691.6 4199,-1683.5 4242.87,-1674.47 4289.77,-1653.56 4321.76,-1637.38"/>
<polygon fill="red" stroke="red" points="4323.48,-1640.43 4330.78,-1632.75 4320.28,-1634.21 4323.48,-1640.43"/>
<text text-anchor="middle" x="3507.5" y="-1695.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu2 -->
<g id="node1107" class="node">
<title>l4_attn_stage8_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1564" cy="-1615" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1564" y="-1626.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="1564" y="-1611.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1564" y="-1596.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu2&#45;&gt;l4_attn_stage8_gpu2 -->
<g id="edge1043" class="edge">
<title>l4_attn_stage7_gpu2&#45;&gt;l4_attn_stage8_gpu2</title>
<path fill="none" stroke="black" d="M1564,-1724.41C1564,-1705.69 1564,-1682.7 1564,-1662.72"/>
<polygon fill="black" stroke="black" points="1567.5,-1662.58 1564,-1652.58 1560.5,-1662.58 1567.5,-1662.58"/>
</g>
<!-- l4_attn_stage7_gpu2&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge2115" class="edge">
<title>l4_attn_stage7_gpu2&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1617.28,-1731.93C1631.41,-1725.6 1646.94,-1719.8 1662,-1716.5 1713.04,-1705.31 3493.68,-1723.77 3543,-1706.5 3553.15,-1702.94 3551.86,-1695.09 3562,-1691.5 3595.36,-1679.68 4164.34,-1690.66 4199,-1683.5 4242.86,-1674.44 4289.76,-1653.53 4321.75,-1637.37"/>
<polygon fill="red" stroke="red" points="4323.48,-1640.42 4330.77,-1632.73 4320.28,-1634.19 4323.48,-1640.42"/>
<text text-anchor="middle" x="3593.5" y="-1695.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu3 -->
<g id="node1108" class="node">
<title>l4_attn_stage8_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1759" cy="-1615" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1759" y="-1626.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="1759" y="-1611.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1759" y="-1596.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu3&#45;&gt;l4_attn_stage8_gpu3 -->
<g id="edge1044" class="edge">
<title>l4_attn_stage7_gpu3&#45;&gt;l4_attn_stage8_gpu3</title>
<path fill="none" stroke="black" d="M1759,-1724.41C1759,-1705.69 1759,-1682.7 1759,-1662.72"/>
<polygon fill="black" stroke="black" points="1762.5,-1662.58 1759,-1652.58 1755.5,-1662.58 1762.5,-1662.58"/>
</g>
<!-- l4_attn_stage7_gpu3&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge2116" class="edge">
<title>l4_attn_stage7_gpu3&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1812.28,-1731.94C1826.41,-1725.6 1841.94,-1719.8 1857,-1716.5 1905.08,-1705.95 3582.55,-1722.77 3629,-1706.5 3639.15,-1702.94 3637.86,-1695.1 3648,-1691.5 3676.85,-1681.25 4169.02,-1689.72 4199,-1683.5 4242.85,-1674.4 4289.75,-1653.49 4321.75,-1637.34"/>
<polygon fill="red" stroke="red" points="4323.47,-1640.39 4330.77,-1632.71 4320.27,-1634.17 4323.47,-1640.39"/>
<text text-anchor="middle" x="3679.5" y="-1695.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu4 -->
<g id="node1109" class="node">
<title>l4_attn_stage8_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1954" cy="-1615" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1954" y="-1626.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="1954" y="-1611.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1954" y="-1596.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu4&#45;&gt;l4_attn_stage8_gpu4 -->
<g id="edge1045" class="edge">
<title>l4_attn_stage7_gpu4&#45;&gt;l4_attn_stage8_gpu4</title>
<path fill="none" stroke="black" d="M1954,-1724.41C1954,-1705.69 1954,-1682.7 1954,-1662.72"/>
<polygon fill="black" stroke="black" points="1957.5,-1662.58 1954,-1652.58 1950.5,-1662.58 1957.5,-1662.58"/>
</g>
<!-- l4_attn_stage7_gpu4&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge2117" class="edge">
<title>l4_attn_stage7_gpu4&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2007.28,-1731.94C2021.41,-1725.6 2036.94,-1719.81 2052,-1716.5 2097.12,-1706.59 3671.41,-1721.78 3715,-1706.5 3725.15,-1702.94 3723.87,-1695.12 3734,-1691.5 3782.67,-1674.13 4148.42,-1694.07 4199,-1683.5 4242.84,-1674.34 4289.74,-1653.44 4321.74,-1637.31"/>
<polygon fill="red" stroke="red" points="4323.46,-1640.36 4330.76,-1632.69 4320.27,-1634.13 4323.46,-1640.36"/>
<text text-anchor="middle" x="3765.5" y="-1695.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu5 -->
<g id="node1110" class="node">
<title>l4_attn_stage8_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2149" cy="-1615" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2149" y="-1626.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="2149" y="-1611.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2149" y="-1596.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu5&#45;&gt;l4_attn_stage8_gpu5 -->
<g id="edge1046" class="edge">
<title>l4_attn_stage7_gpu5&#45;&gt;l4_attn_stage8_gpu5</title>
<path fill="none" stroke="black" d="M2149,-1724.41C2149,-1705.69 2149,-1682.7 2149,-1662.72"/>
<polygon fill="black" stroke="black" points="2152.5,-1662.58 2149,-1652.58 2145.5,-1662.58 2152.5,-1662.58"/>
</g>
<!-- l4_attn_stage7_gpu5&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge2118" class="edge">
<title>l4_attn_stage7_gpu5&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2202.28,-1731.95C2216.41,-1725.61 2231.94,-1719.81 2247,-1716.5 2289.16,-1707.23 3760.27,-1720.79 3801,-1706.5 3811.15,-1702.94 3809.87,-1695.14 3820,-1691.5 3859.64,-1677.27 4157.79,-1692.2 4199,-1683.5 4242.82,-1674.25 4289.73,-1653.37 4321.73,-1637.26"/>
<polygon fill="red" stroke="red" points="4323.45,-1640.32 4330.75,-1632.65 4320.26,-1634.09 4323.45,-1640.32"/>
<text text-anchor="middle" x="3851.5" y="-1695.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu6 -->
<g id="node1111" class="node">
<title>l4_attn_stage8_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2344" cy="-1615" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2344" y="-1626.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="2344" y="-1611.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2344" y="-1596.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu6&#45;&gt;l4_attn_stage8_gpu6 -->
<g id="edge1047" class="edge">
<title>l4_attn_stage7_gpu6&#45;&gt;l4_attn_stage8_gpu6</title>
<path fill="none" stroke="black" d="M2344,-1724.41C2344,-1705.69 2344,-1682.7 2344,-1662.72"/>
<polygon fill="black" stroke="black" points="2347.5,-1662.58 2344,-1652.58 2340.5,-1662.58 2347.5,-1662.58"/>
</g>
<!-- l4_attn_stage7_gpu6&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge2119" class="edge">
<title>l4_attn_stage7_gpu6&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2397.28,-1731.95C2411.41,-1725.61 2426.94,-1719.81 2442,-1716.5 2481.2,-1707.87 3849.13,-1719.8 3887,-1706.5 3897.15,-1702.94 3895.89,-1695.17 3906,-1691.5 3936.62,-1680.4 4167.15,-1690.32 4199,-1683.5 4242.66,-1674.15 4289.41,-1653.39 4321.42,-1637.34"/>
<polygon fill="red" stroke="red" points="4323.12,-1640.4 4330.45,-1632.74 4319.95,-1634.16 4323.12,-1640.4"/>
<text text-anchor="middle" x="3937.5" y="-1695.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu7 -->
<g id="node1112" class="node">
<title>l4_attn_stage8_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2539" cy="-1615" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2539" y="-1626.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="2539" y="-1611.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2539" y="-1596.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu7&#45;&gt;l4_attn_stage8_gpu7 -->
<g id="edge1048" class="edge">
<title>l4_attn_stage7_gpu7&#45;&gt;l4_attn_stage8_gpu7</title>
<path fill="none" stroke="black" d="M2539,-1724.41C2539,-1705.69 2539,-1682.7 2539,-1662.72"/>
<polygon fill="black" stroke="black" points="2542.5,-1662.58 2539,-1652.58 2535.5,-1662.58 2542.5,-1662.58"/>
</g>
<!-- l4_attn_stage7_gpu7&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge2120" class="edge">
<title>l4_attn_stage7_gpu7&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2592.28,-1731.96C2606.42,-1725.62 2621.95,-1719.82 2637,-1716.5 2673.24,-1708.51 3937.99,-1718.8 3973,-1706.5 3983.15,-1702.93 3981.91,-1695.22 3992,-1691.5 4035.19,-1675.57 4154.04,-1693.4 4199,-1683.5 4242.6,-1673.9 4289.37,-1653.17 4321.39,-1637.2"/>
<polygon fill="red" stroke="red" points="4323.08,-1640.27 4330.42,-1632.63 4319.92,-1634.02 4323.08,-1640.27"/>
<text text-anchor="middle" x="4023.5" y="-1695.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu8 -->
<g id="node1113" class="node">
<title>l4_attn_stage8_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2734" cy="-1615" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2734" y="-1626.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="2734" y="-1611.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2734" y="-1596.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu8&#45;&gt;l4_attn_stage8_gpu8 -->
<g id="edge1049" class="edge">
<title>l4_attn_stage7_gpu8&#45;&gt;l4_attn_stage8_gpu8</title>
<path fill="none" stroke="black" d="M2734,-1724.41C2734,-1705.69 2734,-1682.7 2734,-1662.72"/>
<polygon fill="black" stroke="black" points="2737.5,-1662.58 2734,-1652.58 2730.5,-1662.58 2737.5,-1662.58"/>
</g>
<!-- l4_attn_stage7_gpu8&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge2121" class="edge">
<title>l4_attn_stage7_gpu8&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2787.28,-1731.96C2801.42,-1725.62 2816.95,-1719.82 2832,-1716.5 2898.57,-1701.81 3994.69,-1729.12 4059,-1706.5 4069.15,-1702.93 4067.96,-1695.36 4078,-1691.5 4128.3,-1672.15 4146.53,-1695.81 4199,-1683.5 4242.2,-1673.37 4288.67,-1652.92 4320.71,-1637.17"/>
<polygon fill="red" stroke="red" points="4322.38,-1640.25 4329.77,-1632.66 4319.25,-1633.99 4322.38,-1640.25"/>
<text text-anchor="middle" x="4109.5" y="-1695.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu9 -->
<g id="node1114" class="node">
<title>l4_attn_stage8_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2929" cy="-1615" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2929" y="-1626.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="2929" y="-1611.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2929" y="-1596.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu9&#45;&gt;l4_attn_stage8_gpu9 -->
<g id="edge1050" class="edge">
<title>l4_attn_stage7_gpu9&#45;&gt;l4_attn_stage8_gpu9</title>
<path fill="none" stroke="black" d="M2929,-1724.41C2929,-1705.69 2929,-1682.7 2929,-1662.72"/>
<polygon fill="black" stroke="black" points="2932.5,-1662.58 2929,-1652.58 2925.5,-1662.58 2932.5,-1662.58"/>
</g>
<!-- l4_attn_stage7_gpu9&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge2122" class="edge">
<title>l4_attn_stage7_gpu9&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2982.28,-1731.97C2996.42,-1725.63 3011.95,-1719.83 3027,-1716.5 3087.65,-1703.09 4086.41,-1727.13 4145,-1706.5 4155.15,-1702.93 4154.3,-1696.15 4164,-1691.5 4178.39,-1684.61 4183.8,-1688.36 4199,-1683.5 4239.94,-1670.4 4284.95,-1651.24 4317.12,-1636.67"/>
<polygon fill="red" stroke="red" points="4318.61,-1639.84 4326.25,-1632.51 4315.7,-1633.47 4318.61,-1639.84"/>
<text text-anchor="middle" x="4195.5" y="-1695.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu10 -->
<g id="node1115" class="node">
<title>l4_attn_stage8_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3124" cy="-1615" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3124" y="-1626.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="3124" y="-1611.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3124" y="-1596.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu10&#45;&gt;l4_attn_stage8_gpu10 -->
<g id="edge1051" class="edge">
<title>l4_attn_stage7_gpu10&#45;&gt;l4_attn_stage8_gpu10</title>
<path fill="none" stroke="black" d="M3124,-1724.41C3124,-1705.69 3124,-1682.7 3124,-1662.72"/>
<polygon fill="black" stroke="black" points="3127.5,-1662.58 3124,-1652.58 3120.5,-1662.58 3127.5,-1662.58"/>
</g>
<!-- l4_attn_stage7_gpu10&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge2123" class="edge">
<title>l4_attn_stage7_gpu10&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3177.29,-1731.98C3191.42,-1725.64 3206.95,-1719.83 3222,-1716.5 3276.73,-1704.37 4178.13,-1725.15 4231,-1706.5 4241.15,-1702.92 4241.32,-1697.86 4250,-1691.5 4275.22,-1673 4304.5,-1653.15 4326.65,-1638.45"/>
<polygon fill="red" stroke="red" points="4328.66,-1641.32 4335.07,-1632.88 4324.8,-1635.48 4328.66,-1641.32"/>
<text text-anchor="middle" x="4281.5" y="-1695.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu11 -->
<g id="node1116" class="node">
<title>l4_attn_stage8_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3319" cy="-1615" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3319" y="-1626.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="3319" y="-1611.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3319" y="-1596.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu11&#45;&gt;l4_attn_stage8_gpu11 -->
<g id="edge1052" class="edge">
<title>l4_attn_stage7_gpu11&#45;&gt;l4_attn_stage8_gpu11</title>
<path fill="none" stroke="black" d="M3319,-1724.41C3319,-1705.69 3319,-1682.7 3319,-1662.72"/>
<polygon fill="black" stroke="black" points="3322.5,-1662.58 3319,-1652.58 3315.5,-1662.58 3322.5,-1662.58"/>
</g>
<!-- l4_attn_stage7_gpu11&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge2124" class="edge">
<title>l4_attn_stage7_gpu11&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3372.29,-1731.99C3386.42,-1725.65 3401.95,-1719.84 3417,-1716.5 3441.41,-1711.08 4295.88,-1719.88 4317,-1706.5 4338.94,-1692.6 4350.24,-1664.32 4355.85,-1643.05"/>
<polygon fill="red" stroke="red" points="4359.27,-1643.81 4358.18,-1633.27 4352.46,-1642.19 4359.27,-1643.81"/>
<text text-anchor="middle" x="4363.5" y="-1695.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu12 -->
<g id="node1117" class="node">
<title>l4_attn_stage8_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3514" cy="-1615" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3514" y="-1626.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="3514" y="-1611.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3514" y="-1596.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu12&#45;&gt;l4_attn_stage8_gpu12 -->
<g id="edge1053" class="edge">
<title>l4_attn_stage7_gpu12&#45;&gt;l4_attn_stage8_gpu12</title>
<path fill="none" stroke="black" d="M3458.85,-1732.54C3445.43,-1726.5 3430.93,-1720.69 3417,-1716.5 3403.22,-1712.35 3362.36,-1717.44 3353,-1706.5 3318.08,-1665.7 3358.79,-1705.82 3417,-1683.5 3434.78,-1676.68 3452.42,-1665.94 3467.68,-1655.01"/>
<polygon fill="black" stroke="black" points="3469.93,-1657.69 3475.9,-1648.94 3465.77,-1652.06 3469.93,-1657.69"/>
</g>
<!-- l4_attn_stage7_gpu12&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge2125" class="edge">
<title>l4_attn_stage7_gpu12&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3567.29,-1732.01C3581.43,-1725.67 3596.95,-1719.86 3612,-1716.5 3633.45,-1711.72 4387.56,-1722.14 4403,-1706.5 4421.16,-1688.11 4403.89,-1660.42 4386.31,-1640.51"/>
<polygon fill="red" stroke="red" points="4388.75,-1637.99 4379.38,-1633.03 4383.61,-1642.75 4388.75,-1637.99"/>
<text text-anchor="middle" x="4441.5" y="-1695.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu13 -->
<g id="node1118" class="node">
<title>l4_attn_stage8_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3709" cy="-1615" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3709" y="-1626.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="3709" y="-1611.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3709" y="-1596.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu13&#45;&gt;l4_attn_stage8_gpu13 -->
<g id="edge1054" class="edge">
<title>l4_attn_stage7_gpu13&#45;&gt;l4_attn_stage8_gpu13</title>
<path fill="none" stroke="black" d="M3655.7,-1732.06C3641.85,-1725.8 3626.69,-1720.01 3612,-1716.5 3598.37,-1713.24 3369.71,-1716.6 3360,-1706.5 3355.38,-1701.69 3355.36,-1696.29 3360,-1691.5 3369.75,-1681.44 3598.7,-1687.9 3612,-1683.5 3630.4,-1677.4 3648.44,-1666.61 3663.87,-1655.42"/>
<polygon fill="black" stroke="black" points="3666.27,-1657.99 3672.16,-1649.19 3662.06,-1652.4 3666.27,-1657.99"/>
</g>
<!-- l4_attn_stage7_gpu13&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge2126" class="edge">
<title>l4_attn_stage7_gpu13&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3762.3,-1732.03C3776.43,-1725.69 3791.96,-1719.87 3807,-1716.5 3825.49,-1712.36 4475.7,-1719.99 4489,-1706.5 4517.36,-1677.72 4469.79,-1651.89 4424.82,-1635.26"/>
<polygon fill="red" stroke="red" points="4425.88,-1631.93 4415.29,-1631.86 4423.53,-1638.52 4425.88,-1631.93"/>
<text text-anchor="middle" x="4528.5" y="-1695.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu14 -->
<g id="node1119" class="node">
<title>l4_attn_stage8_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3904" cy="-1615" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3904" y="-1626.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="3904" y="-1611.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3904" y="-1596.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu14&#45;&gt;l4_attn_stage8_gpu14 -->
<g id="edge1055" class="edge">
<title>l4_attn_stage7_gpu14&#45;&gt;l4_attn_stage8_gpu14</title>
<path fill="none" stroke="black" d="M3850.74,-1731.88C3836.89,-1725.63 3821.71,-1719.89 3807,-1716.5 3783.17,-1711.01 3384.09,-1723.98 3367,-1706.5 3362.34,-1701.73 3362.33,-1696.26 3367,-1691.5 3375.56,-1682.78 3795.37,-1687.26 3807,-1683.5 3825.45,-1677.53 3843.49,-1666.77 3858.92,-1655.57"/>
<polygon fill="black" stroke="black" points="3861.32,-1658.14 3867.2,-1649.33 3857.11,-1652.55 3861.32,-1658.14"/>
</g>
<!-- l4_attn_stage7_gpu14&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge2127" class="edge">
<title>l4_attn_stage7_gpu14&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3957.3,-1732.06C3971.44,-1725.72 3986.96,-1719.89 4002,-1716.5 4017.53,-1713 4563.84,-1717.85 4575,-1706.5 4615.03,-1665.76 4545.32,-1642.4 4475.01,-1629.66"/>
<polygon fill="red" stroke="red" points="4475.55,-1626.2 4465.1,-1627.93 4474.35,-1633.1 4475.55,-1626.2"/>
<text text-anchor="middle" x="4615.5" y="-1695.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage8_gpu15 -->
<g id="node1120" class="node">
<title>l4_attn_stage8_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4099" cy="-1615" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4099" y="-1626.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage8</text>
<text text-anchor="middle" x="4099" y="-1611.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4099" y="-1596.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage7_gpu15&#45;&gt;l4_attn_stage8_gpu15 -->
<g id="edge1056" class="edge">
<title>l4_attn_stage7_gpu15&#45;&gt;l4_attn_stage8_gpu15</title>
<path fill="none" stroke="black" d="M4046.02,-1731.93C4032.09,-1725.63 4016.82,-1719.86 4002,-1716.5 3984.99,-1712.64 3386.24,-1718.93 3374,-1706.5 3369.32,-1701.75 3369.32,-1696.24 3374,-1691.5 3386.26,-1679.09 3985.39,-1688.83 4002,-1683.5 4020.46,-1677.58 4038.51,-1666.83 4053.94,-1655.63"/>
<polygon fill="black" stroke="black" points="4056.34,-1658.2 4062.22,-1649.38 4052.13,-1652.61 4056.34,-1658.2"/>
</g>
<!-- l4_attn_stage7_gpu15&#45;&gt;l4_attn_stage8_gpu[next_gpu] -->
<g id="edge2128" class="edge">
<title>l4_attn_stage7_gpu15&#45;&gt;l4_attn_stage8_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4154.38,-1732.68C4169.74,-1726.12 4186.68,-1720.03 4203,-1716.5 4227.87,-1711.12 4643.2,-1724.69 4661,-1706.5 4715.67,-1650.63 4614.45,-1628.96 4515.12,-1620.71"/>
<polygon fill="red" stroke="red" points="4515.15,-1617.2 4504.9,-1619.91 4514.6,-1624.18 4515.15,-1617.2"/>
<text text-anchor="middle" x="4701.5" y="-1695.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu0 -->
<g id="node1121" class="node">
<title>l4_attn_stage9_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="1174" cy="-1468" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1174" y="-1479.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="1174" y="-1464.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="1174" y="-1449.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu0&#45;&gt;l4_attn_stage9_gpu0 -->
<g id="edge1057" class="edge">
<title>l4_attn_stage8_gpu0&#45;&gt;l4_attn_stage9_gpu0</title>
<path fill="none" stroke="black" d="M1174,-1577.41C1174,-1558.69 1174,-1535.7 1174,-1515.72"/>
<polygon fill="black" stroke="black" points="1177.5,-1515.58 1174,-1505.58 1170.5,-1515.58 1177.5,-1515.58"/>
</g>
<!-- l4_attn_stage9_gpu[next_gpu] -->
<g id="node1366" class="node">
<title>l4_attn_stage9_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4361" cy="-1468" rx="149.5" ry="18"/>
<text text-anchor="middle" x="4361" y="-1464.3" font-family="Times,serif" font-size="14.00">l4_attn_stage9_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage8_gpu0&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge2129" class="edge">
<title>l4_attn_stage8_gpu0&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1227.29,-1585C1241.43,-1578.66 1256.95,-1572.85 1272,-1569.5 1501.73,-1518.36 3154.66,-1547.05 3390,-1544.5 3434.94,-1544.01 4154.97,-1545.53 4199,-1536.5 4242.87,-1527.5 4289.77,-1506.58 4321.76,-1490.4"/>
<polygon fill="red" stroke="red" points="4323.49,-1493.45 4330.78,-1485.76 4320.28,-1487.22 4323.49,-1493.45"/>
<text text-anchor="middle" x="3421.5" y="-1548.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu1 -->
<g id="node1122" class="node">
<title>l4_attn_stage9_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1369" cy="-1468" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1369" y="-1479.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="1369" y="-1464.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1369" y="-1449.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu1&#45;&gt;l4_attn_stage9_gpu1 -->
<g id="edge1058" class="edge">
<title>l4_attn_stage8_gpu1&#45;&gt;l4_attn_stage9_gpu1</title>
<path fill="none" stroke="black" d="M1369,-1577.41C1369,-1558.69 1369,-1535.7 1369,-1515.72"/>
<polygon fill="black" stroke="black" points="1372.5,-1515.58 1369,-1505.58 1365.5,-1515.58 1372.5,-1515.58"/>
</g>
<!-- l4_attn_stage8_gpu1&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge2130" class="edge">
<title>l4_attn_stage8_gpu1&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1422.28,-1584.93C1436.41,-1578.59 1451.94,-1572.8 1467,-1569.5 1521,-1557.67 3404.82,-1577.76 3457,-1559.5 3467.15,-1555.95 3465.86,-1548.08 3476,-1544.5 3513.87,-1531.12 4159.66,-1544.6 4199,-1536.5 4242.87,-1527.47 4289.77,-1506.56 4321.76,-1490.38"/>
<polygon fill="red" stroke="red" points="4323.48,-1493.43 4330.78,-1485.75 4320.28,-1487.21 4323.48,-1493.43"/>
<text text-anchor="middle" x="3507.5" y="-1548.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu2 -->
<g id="node1123" class="node">
<title>l4_attn_stage9_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1564" cy="-1468" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1564" y="-1479.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="1564" y="-1464.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1564" y="-1449.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu2&#45;&gt;l4_attn_stage9_gpu2 -->
<g id="edge1059" class="edge">
<title>l4_attn_stage8_gpu2&#45;&gt;l4_attn_stage9_gpu2</title>
<path fill="none" stroke="black" d="M1564,-1577.41C1564,-1558.69 1564,-1535.7 1564,-1515.72"/>
<polygon fill="black" stroke="black" points="1567.5,-1515.58 1564,-1505.58 1560.5,-1515.58 1567.5,-1515.58"/>
</g>
<!-- l4_attn_stage8_gpu2&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge2131" class="edge">
<title>l4_attn_stage8_gpu2&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1617.28,-1584.93C1631.41,-1578.6 1646.94,-1572.8 1662,-1569.5 1713.04,-1558.31 3493.68,-1576.77 3543,-1559.5 3553.15,-1555.94 3551.86,-1548.09 3562,-1544.5 3595.36,-1532.68 4164.34,-1543.66 4199,-1536.5 4242.86,-1527.44 4289.76,-1506.53 4321.75,-1490.37"/>
<polygon fill="red" stroke="red" points="4323.48,-1493.42 4330.77,-1485.73 4320.28,-1487.19 4323.48,-1493.42"/>
<text text-anchor="middle" x="3593.5" y="-1548.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu3 -->
<g id="node1124" class="node">
<title>l4_attn_stage9_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1759" cy="-1468" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1759" y="-1479.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="1759" y="-1464.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1759" y="-1449.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu3&#45;&gt;l4_attn_stage9_gpu3 -->
<g id="edge1060" class="edge">
<title>l4_attn_stage8_gpu3&#45;&gt;l4_attn_stage9_gpu3</title>
<path fill="none" stroke="black" d="M1759,-1577.41C1759,-1558.69 1759,-1535.7 1759,-1515.72"/>
<polygon fill="black" stroke="black" points="1762.5,-1515.58 1759,-1505.58 1755.5,-1515.58 1762.5,-1515.58"/>
</g>
<!-- l4_attn_stage8_gpu3&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge2132" class="edge">
<title>l4_attn_stage8_gpu3&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1812.28,-1584.94C1826.41,-1578.6 1841.94,-1572.8 1857,-1569.5 1905.08,-1558.95 3582.55,-1575.77 3629,-1559.5 3639.15,-1555.94 3637.86,-1548.1 3648,-1544.5 3676.85,-1534.25 4169.02,-1542.72 4199,-1536.5 4242.85,-1527.4 4289.75,-1506.49 4321.75,-1490.34"/>
<polygon fill="red" stroke="red" points="4323.47,-1493.39 4330.77,-1485.71 4320.27,-1487.17 4323.47,-1493.39"/>
<text text-anchor="middle" x="3679.5" y="-1548.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu4 -->
<g id="node1125" class="node">
<title>l4_attn_stage9_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1954" cy="-1468" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="1954" y="-1479.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="1954" y="-1464.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1954" y="-1449.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu4&#45;&gt;l4_attn_stage9_gpu4 -->
<g id="edge1061" class="edge">
<title>l4_attn_stage8_gpu4&#45;&gt;l4_attn_stage9_gpu4</title>
<path fill="none" stroke="black" d="M1954,-1577.41C1954,-1558.69 1954,-1535.7 1954,-1515.72"/>
<polygon fill="black" stroke="black" points="1957.5,-1515.58 1954,-1505.58 1950.5,-1515.58 1957.5,-1515.58"/>
</g>
<!-- l4_attn_stage8_gpu4&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge2133" class="edge">
<title>l4_attn_stage8_gpu4&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2007.28,-1584.94C2021.41,-1578.6 2036.94,-1572.81 2052,-1569.5 2097.12,-1559.59 3671.41,-1574.78 3715,-1559.5 3725.15,-1555.94 3723.87,-1548.12 3734,-1544.5 3782.67,-1527.13 4148.42,-1547.07 4199,-1536.5 4242.84,-1527.34 4289.74,-1506.44 4321.74,-1490.31"/>
<polygon fill="red" stroke="red" points="4323.46,-1493.36 4330.76,-1485.69 4320.27,-1487.13 4323.46,-1493.36"/>
<text text-anchor="middle" x="3765.5" y="-1548.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu5 -->
<g id="node1126" class="node">
<title>l4_attn_stage9_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2149" cy="-1468" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2149" y="-1479.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="2149" y="-1464.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2149" y="-1449.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu5&#45;&gt;l4_attn_stage9_gpu5 -->
<g id="edge1062" class="edge">
<title>l4_attn_stage8_gpu5&#45;&gt;l4_attn_stage9_gpu5</title>
<path fill="none" stroke="black" d="M2149,-1577.41C2149,-1558.69 2149,-1535.7 2149,-1515.72"/>
<polygon fill="black" stroke="black" points="2152.5,-1515.58 2149,-1505.58 2145.5,-1515.58 2152.5,-1515.58"/>
</g>
<!-- l4_attn_stage8_gpu5&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge2134" class="edge">
<title>l4_attn_stage8_gpu5&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2202.28,-1584.95C2216.41,-1578.61 2231.94,-1572.81 2247,-1569.5 2289.16,-1560.23 3760.27,-1573.79 3801,-1559.5 3811.15,-1555.94 3809.87,-1548.14 3820,-1544.5 3859.64,-1530.27 4157.79,-1545.2 4199,-1536.5 4242.82,-1527.25 4289.73,-1506.37 4321.73,-1490.26"/>
<polygon fill="red" stroke="red" points="4323.45,-1493.32 4330.75,-1485.65 4320.26,-1487.09 4323.45,-1493.32"/>
<text text-anchor="middle" x="3851.5" y="-1548.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu6 -->
<g id="node1127" class="node">
<title>l4_attn_stage9_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2344" cy="-1468" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2344" y="-1479.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="2344" y="-1464.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2344" y="-1449.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu6&#45;&gt;l4_attn_stage9_gpu6 -->
<g id="edge1063" class="edge">
<title>l4_attn_stage8_gpu6&#45;&gt;l4_attn_stage9_gpu6</title>
<path fill="none" stroke="black" d="M2344,-1577.41C2344,-1558.69 2344,-1535.7 2344,-1515.72"/>
<polygon fill="black" stroke="black" points="2347.5,-1515.58 2344,-1505.58 2340.5,-1515.58 2347.5,-1515.58"/>
</g>
<!-- l4_attn_stage8_gpu6&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge2135" class="edge">
<title>l4_attn_stage8_gpu6&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2397.28,-1584.95C2411.41,-1578.61 2426.94,-1572.81 2442,-1569.5 2481.2,-1560.87 3849.13,-1572.8 3887,-1559.5 3897.15,-1555.94 3895.89,-1548.17 3906,-1544.5 3936.62,-1533.4 4167.15,-1543.32 4199,-1536.5 4242.66,-1527.15 4289.41,-1506.39 4321.42,-1490.34"/>
<polygon fill="red" stroke="red" points="4323.12,-1493.4 4330.45,-1485.74 4319.95,-1487.16 4323.12,-1493.4"/>
<text text-anchor="middle" x="3937.5" y="-1548.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu7 -->
<g id="node1128" class="node">
<title>l4_attn_stage9_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2539" cy="-1468" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2539" y="-1479.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="2539" y="-1464.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2539" y="-1449.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu7&#45;&gt;l4_attn_stage9_gpu7 -->
<g id="edge1064" class="edge">
<title>l4_attn_stage8_gpu7&#45;&gt;l4_attn_stage9_gpu7</title>
<path fill="none" stroke="black" d="M2539,-1577.41C2539,-1558.69 2539,-1535.7 2539,-1515.72"/>
<polygon fill="black" stroke="black" points="2542.5,-1515.58 2539,-1505.58 2535.5,-1515.58 2542.5,-1515.58"/>
</g>
<!-- l4_attn_stage8_gpu7&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge2136" class="edge">
<title>l4_attn_stage8_gpu7&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2592.28,-1584.96C2606.42,-1578.62 2621.95,-1572.82 2637,-1569.5 2673.24,-1561.51 3937.99,-1571.8 3973,-1559.5 3983.15,-1555.93 3981.91,-1548.22 3992,-1544.5 4035.19,-1528.57 4154.04,-1546.4 4199,-1536.5 4242.6,-1526.9 4289.37,-1506.17 4321.39,-1490.2"/>
<polygon fill="red" stroke="red" points="4323.08,-1493.27 4330.42,-1485.63 4319.92,-1487.02 4323.08,-1493.27"/>
<text text-anchor="middle" x="4023.5" y="-1548.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu8 -->
<g id="node1129" class="node">
<title>l4_attn_stage9_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2734" cy="-1468" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2734" y="-1479.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="2734" y="-1464.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2734" y="-1449.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu8&#45;&gt;l4_attn_stage9_gpu8 -->
<g id="edge1065" class="edge">
<title>l4_attn_stage8_gpu8&#45;&gt;l4_attn_stage9_gpu8</title>
<path fill="none" stroke="black" d="M2734,-1577.41C2734,-1558.69 2734,-1535.7 2734,-1515.72"/>
<polygon fill="black" stroke="black" points="2737.5,-1515.58 2734,-1505.58 2730.5,-1515.58 2737.5,-1515.58"/>
</g>
<!-- l4_attn_stage8_gpu8&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge2137" class="edge">
<title>l4_attn_stage8_gpu8&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2787.28,-1584.96C2801.42,-1578.62 2816.95,-1572.82 2832,-1569.5 2898.57,-1554.81 3994.69,-1582.12 4059,-1559.5 4069.15,-1555.93 4067.96,-1548.36 4078,-1544.5 4128.3,-1525.15 4146.53,-1548.81 4199,-1536.5 4242.2,-1526.37 4288.67,-1505.92 4320.71,-1490.17"/>
<polygon fill="red" stroke="red" points="4322.38,-1493.25 4329.77,-1485.66 4319.25,-1486.99 4322.38,-1493.25"/>
<text text-anchor="middle" x="4109.5" y="-1548.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu9 -->
<g id="node1130" class="node">
<title>l4_attn_stage9_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2929" cy="-1468" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="2929" y="-1479.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="2929" y="-1464.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2929" y="-1449.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu9&#45;&gt;l4_attn_stage9_gpu9 -->
<g id="edge1066" class="edge">
<title>l4_attn_stage8_gpu9&#45;&gt;l4_attn_stage9_gpu9</title>
<path fill="none" stroke="black" d="M2929,-1577.41C2929,-1558.69 2929,-1535.7 2929,-1515.72"/>
<polygon fill="black" stroke="black" points="2932.5,-1515.58 2929,-1505.58 2925.5,-1515.58 2932.5,-1515.58"/>
</g>
<!-- l4_attn_stage8_gpu9&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge2138" class="edge">
<title>l4_attn_stage8_gpu9&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2982.28,-1584.97C2996.42,-1578.63 3011.95,-1572.83 3027,-1569.5 3087.65,-1556.09 4086.41,-1580.13 4145,-1559.5 4155.15,-1555.93 4154.3,-1549.15 4164,-1544.5 4178.39,-1537.61 4183.8,-1541.36 4199,-1536.5 4239.94,-1523.4 4284.95,-1504.24 4317.12,-1489.67"/>
<polygon fill="red" stroke="red" points="4318.61,-1492.84 4326.25,-1485.51 4315.7,-1486.47 4318.61,-1492.84"/>
<text text-anchor="middle" x="4195.5" y="-1548.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu10 -->
<g id="node1131" class="node">
<title>l4_attn_stage9_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3124" cy="-1468" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3124" y="-1479.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="3124" y="-1464.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3124" y="-1449.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu10&#45;&gt;l4_attn_stage9_gpu10 -->
<g id="edge1067" class="edge">
<title>l4_attn_stage8_gpu10&#45;&gt;l4_attn_stage9_gpu10</title>
<path fill="none" stroke="black" d="M3124,-1577.41C3124,-1558.69 3124,-1535.7 3124,-1515.72"/>
<polygon fill="black" stroke="black" points="3127.5,-1515.58 3124,-1505.58 3120.5,-1515.58 3127.5,-1515.58"/>
</g>
<!-- l4_attn_stage8_gpu10&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge2139" class="edge">
<title>l4_attn_stage8_gpu10&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3177.29,-1584.98C3191.42,-1578.64 3206.95,-1572.83 3222,-1569.5 3276.73,-1557.37 4178.13,-1578.15 4231,-1559.5 4241.15,-1555.92 4241.32,-1550.86 4250,-1544.5 4275.22,-1526 4304.5,-1506.15 4326.65,-1491.45"/>
<polygon fill="red" stroke="red" points="4328.66,-1494.32 4335.07,-1485.88 4324.8,-1488.48 4328.66,-1494.32"/>
<text text-anchor="middle" x="4281.5" y="-1548.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu11 -->
<g id="node1132" class="node">
<title>l4_attn_stage9_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3319" cy="-1468" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3319" y="-1479.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="3319" y="-1464.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3319" y="-1449.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu11&#45;&gt;l4_attn_stage9_gpu11 -->
<g id="edge1068" class="edge">
<title>l4_attn_stage8_gpu11&#45;&gt;l4_attn_stage9_gpu11</title>
<path fill="none" stroke="black" d="M3319,-1577.41C3319,-1558.69 3319,-1535.7 3319,-1515.72"/>
<polygon fill="black" stroke="black" points="3322.5,-1515.58 3319,-1505.58 3315.5,-1515.58 3322.5,-1515.58"/>
</g>
<!-- l4_attn_stage8_gpu11&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge2140" class="edge">
<title>l4_attn_stage8_gpu11&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3372.29,-1584.99C3386.42,-1578.65 3401.95,-1572.84 3417,-1569.5 3441.41,-1564.08 4295.88,-1572.88 4317,-1559.5 4338.94,-1545.6 4350.24,-1517.32 4355.85,-1496.05"/>
<polygon fill="red" stroke="red" points="4359.27,-1496.81 4358.18,-1486.27 4352.46,-1495.19 4359.27,-1496.81"/>
<text text-anchor="middle" x="4363.5" y="-1548.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu12 -->
<g id="node1133" class="node">
<title>l4_attn_stage9_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3514" cy="-1468" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3514" y="-1479.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="3514" y="-1464.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3514" y="-1449.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu12&#45;&gt;l4_attn_stage9_gpu12 -->
<g id="edge1069" class="edge">
<title>l4_attn_stage8_gpu12&#45;&gt;l4_attn_stage9_gpu12</title>
<path fill="none" stroke="black" d="M3458.85,-1585.54C3445.43,-1579.5 3430.93,-1573.69 3417,-1569.5 3403.22,-1565.35 3362.36,-1570.44 3353,-1559.5 3318.08,-1518.7 3358.79,-1558.82 3417,-1536.5 3434.78,-1529.68 3452.42,-1518.94 3467.68,-1508.01"/>
<polygon fill="black" stroke="black" points="3469.93,-1510.69 3475.9,-1501.94 3465.77,-1505.06 3469.93,-1510.69"/>
</g>
<!-- l4_attn_stage8_gpu12&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge2141" class="edge">
<title>l4_attn_stage8_gpu12&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3567.29,-1585.01C3581.43,-1578.67 3596.95,-1572.86 3612,-1569.5 3633.45,-1564.72 4387.56,-1575.14 4403,-1559.5 4421.16,-1541.11 4403.89,-1513.42 4386.31,-1493.51"/>
<polygon fill="red" stroke="red" points="4388.75,-1490.99 4379.38,-1486.03 4383.61,-1495.75 4388.75,-1490.99"/>
<text text-anchor="middle" x="4441.5" y="-1548.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu13 -->
<g id="node1134" class="node">
<title>l4_attn_stage9_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3709" cy="-1468" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3709" y="-1479.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="3709" y="-1464.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3709" y="-1449.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu13&#45;&gt;l4_attn_stage9_gpu13 -->
<g id="edge1070" class="edge">
<title>l4_attn_stage8_gpu13&#45;&gt;l4_attn_stage9_gpu13</title>
<path fill="none" stroke="black" d="M3655.7,-1585.06C3641.85,-1578.8 3626.69,-1573.01 3612,-1569.5 3598.37,-1566.24 3369.71,-1569.6 3360,-1559.5 3355.38,-1554.69 3355.36,-1549.29 3360,-1544.5 3369.75,-1534.44 3598.7,-1540.9 3612,-1536.5 3630.4,-1530.4 3648.44,-1519.61 3663.87,-1508.42"/>
<polygon fill="black" stroke="black" points="3666.27,-1510.99 3672.16,-1502.19 3662.06,-1505.4 3666.27,-1510.99"/>
</g>
<!-- l4_attn_stage8_gpu13&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge2142" class="edge">
<title>l4_attn_stage8_gpu13&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3762.3,-1585.03C3776.43,-1578.69 3791.96,-1572.87 3807,-1569.5 3825.49,-1565.36 4475.7,-1572.99 4489,-1559.5 4517.36,-1530.72 4469.79,-1504.89 4424.82,-1488.26"/>
<polygon fill="red" stroke="red" points="4425.88,-1484.93 4415.29,-1484.86 4423.53,-1491.52 4425.88,-1484.93"/>
<text text-anchor="middle" x="4528.5" y="-1548.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu14 -->
<g id="node1135" class="node">
<title>l4_attn_stage9_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3904" cy="-1468" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="3904" y="-1479.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="3904" y="-1464.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3904" y="-1449.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu14&#45;&gt;l4_attn_stage9_gpu14 -->
<g id="edge1071" class="edge">
<title>l4_attn_stage8_gpu14&#45;&gt;l4_attn_stage9_gpu14</title>
<path fill="none" stroke="black" d="M3850.74,-1584.88C3836.89,-1578.63 3821.71,-1572.89 3807,-1569.5 3783.17,-1564.01 3384.09,-1576.98 3367,-1559.5 3362.34,-1554.73 3362.33,-1549.26 3367,-1544.5 3375.56,-1535.78 3795.37,-1540.26 3807,-1536.5 3825.45,-1530.53 3843.49,-1519.77 3858.92,-1508.57"/>
<polygon fill="black" stroke="black" points="3861.32,-1511.14 3867.2,-1502.33 3857.11,-1505.55 3861.32,-1511.14"/>
</g>
<!-- l4_attn_stage8_gpu14&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge2143" class="edge">
<title>l4_attn_stage8_gpu14&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3957.3,-1585.06C3971.44,-1578.72 3986.96,-1572.89 4002,-1569.5 4017.53,-1566 4563.84,-1570.85 4575,-1559.5 4615.03,-1518.76 4545.32,-1495.4 4475.01,-1482.66"/>
<polygon fill="red" stroke="red" points="4475.55,-1479.2 4465.1,-1480.93 4474.35,-1486.1 4475.55,-1479.2"/>
<text text-anchor="middle" x="4615.5" y="-1548.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage9_gpu15 -->
<g id="node1136" class="node">
<title>l4_attn_stage9_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4099" cy="-1468" rx="88.5" ry="37.5"/>
<text text-anchor="middle" x="4099" y="-1479.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage9</text>
<text text-anchor="middle" x="4099" y="-1464.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4099" y="-1449.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage8_gpu15&#45;&gt;l4_attn_stage9_gpu15 -->
<g id="edge1072" class="edge">
<title>l4_attn_stage8_gpu15&#45;&gt;l4_attn_stage9_gpu15</title>
<path fill="none" stroke="black" d="M4046.02,-1584.93C4032.09,-1578.63 4016.82,-1572.86 4002,-1569.5 3984.99,-1565.64 3386.24,-1571.93 3374,-1559.5 3369.32,-1554.75 3369.32,-1549.24 3374,-1544.5 3386.26,-1532.09 3985.39,-1541.83 4002,-1536.5 4020.46,-1530.58 4038.51,-1519.83 4053.94,-1508.63"/>
<polygon fill="black" stroke="black" points="4056.34,-1511.2 4062.22,-1502.38 4052.13,-1505.61 4056.34,-1511.2"/>
</g>
<!-- l4_attn_stage8_gpu15&#45;&gt;l4_attn_stage9_gpu[next_gpu] -->
<g id="edge2144" class="edge">
<title>l4_attn_stage8_gpu15&#45;&gt;l4_attn_stage9_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4154.38,-1585.68C4169.74,-1579.12 4186.68,-1573.03 4203,-1569.5 4227.87,-1564.12 4643.2,-1577.69 4661,-1559.5 4715.67,-1503.63 4614.45,-1481.96 4515.12,-1473.71"/>
<polygon fill="red" stroke="red" points="4515.15,-1470.2 4504.9,-1472.91 4514.6,-1477.18 4515.15,-1470.2"/>
<text text-anchor="middle" x="4701.5" y="-1548.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu0 -->
<g id="node1137" class="node">
<title>l4_attn_stage10_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="972" cy="-1321" rx="95" ry="37.5"/>
<text text-anchor="middle" x="972" y="-1332.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="972" y="-1317.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="972" y="-1302.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu0&#45;&gt;l4_attn_stage10_gpu0 -->
<g id="edge1073" class="edge">
<title>l4_attn_stage9_gpu0&#45;&gt;l4_attn_stage10_gpu0</title>
<path fill="none" stroke="black" d="M1129.67,-1435.18C1098.97,-1413.14 1057.93,-1383.68 1025.42,-1360.35"/>
<polygon fill="black" stroke="black" points="1027.09,-1357.24 1016.92,-1354.25 1023.01,-1362.92 1027.09,-1357.24"/>
</g>
<!-- l4_attn_stage10_gpu[next_gpu] -->
<g id="node1367" class="node">
<title>l4_attn_stage10_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4367" cy="-1321" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4367" y="-1317.3" font-family="Times,serif" font-size="14.00">l4_attn_stage10_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage9_gpu0&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge2145" class="edge">
<title>l4_attn_stage9_gpu0&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1227.29,-1438C1241.43,-1431.66 1256.95,-1425.85 1272,-1422.5 1497.93,-1372.19 3123.55,-1399.99 3355,-1397.5 3401.89,-1397 4153,-1398.62 4199,-1389.5 4244.32,-1380.51 4292.98,-1359.59 4326.21,-1343.41"/>
<polygon fill="red" stroke="red" points="4328.17,-1346.34 4335.58,-1338.77 4325.06,-1340.07 4328.17,-1346.34"/>
<text text-anchor="middle" x="3386.5" y="-1401.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu1 -->
<g id="node1138" class="node">
<title>l4_attn_stage10_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1180" cy="-1321" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1180" y="-1332.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="1180" y="-1317.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1180" y="-1302.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu1&#45;&gt;l4_attn_stage10_gpu1 -->
<g id="edge1074" class="edge">
<title>l4_attn_stage9_gpu1&#45;&gt;l4_attn_stage10_gpu1</title>
<path fill="none" stroke="black" d="M1327.05,-1434.82C1298.62,-1413.01 1260.89,-1384.06 1230.76,-1360.94"/>
<polygon fill="black" stroke="black" points="1232.55,-1357.9 1222.48,-1354.59 1228.29,-1363.46 1232.55,-1357.9"/>
</g>
<!-- l4_attn_stage9_gpu1&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge2146" class="edge">
<title>l4_attn_stage9_gpu1&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1422.28,-1437.93C1436.41,-1431.59 1451.94,-1425.8 1467,-1422.5 1520.05,-1410.88 3370.74,-1430.44 3422,-1412.5 3432.15,-1408.95 3430.85,-1401.08 3441,-1397.5 3480.71,-1383.48 4157.7,-1397.71 4199,-1389.5 4244.32,-1380.49 4292.98,-1359.57 4326.21,-1343.39"/>
<polygon fill="red" stroke="red" points="4328.17,-1346.33 4335.58,-1338.76 4325.06,-1340.05 4328.17,-1346.33"/>
<text text-anchor="middle" x="3472.5" y="-1401.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu2 -->
<g id="node1139" class="node">
<title>l4_attn_stage10_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1388" cy="-1321" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1388" y="-1332.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="1388" y="-1317.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1388" y="-1302.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu2&#45;&gt;l4_attn_stage10_gpu2 -->
<g id="edge1075" class="edge">
<title>l4_attn_stage9_gpu2&#45;&gt;l4_attn_stage10_gpu2</title>
<path fill="none" stroke="black" d="M1524.06,-1434.1C1497.94,-1412.57 1463.66,-1384.34 1436.05,-1361.59"/>
<polygon fill="black" stroke="black" points="1438.03,-1358.68 1428.08,-1355.02 1433.58,-1364.08 1438.03,-1358.68"/>
</g>
<!-- l4_attn_stage9_gpu2&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge2147" class="edge">
<title>l4_attn_stage9_gpu2&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1617.28,-1437.93C1631.41,-1431.6 1646.94,-1425.8 1662,-1422.5 1712.09,-1411.52 3459.6,-1429.45 3508,-1412.5 3518.15,-1408.94 3516.86,-1401.09 3527,-1397.5 3562.2,-1385.05 4162.39,-1396.81 4199,-1389.5 4244.31,-1380.46 4292.97,-1359.55 4326.2,-1343.38"/>
<polygon fill="red" stroke="red" points="4328.16,-1346.31 4335.57,-1338.74 4325.06,-1340.04 4328.16,-1346.31"/>
<text text-anchor="middle" x="3558.5" y="-1401.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu3 -->
<g id="node1140" class="node">
<title>l4_attn_stage10_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1596" cy="-1321" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1596" y="-1332.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="1596" y="-1317.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1596" y="-1302.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu3&#45;&gt;l4_attn_stage10_gpu3 -->
<g id="edge1076" class="edge">
<title>l4_attn_stage9_gpu3&#45;&gt;l4_attn_stage10_gpu3</title>
<path fill="none" stroke="black" d="M1721.6,-1433.73C1697.75,-1412.52 1666.69,-1384.89 1641.43,-1362.41"/>
<polygon fill="black" stroke="black" points="1643.58,-1359.64 1633.79,-1355.61 1638.93,-1364.87 1643.58,-1359.64"/>
</g>
<!-- l4_attn_stage9_gpu3&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge2148" class="edge">
<title>l4_attn_stage9_gpu3&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1812.28,-1437.94C1826.41,-1431.6 1841.94,-1425.8 1857,-1422.5 1904.13,-1412.16 3548.46,-1428.46 3594,-1412.5 3604.15,-1408.94 3602.86,-1401.1 3613,-1397.5 3643.68,-1386.61 4167.08,-1395.9 4199,-1389.5 4244.3,-1380.42 4292.97,-1359.51 4326.2,-1343.35"/>
<polygon fill="red" stroke="red" points="4328.16,-1346.29 4335.57,-1338.72 4325.06,-1340.02 4328.16,-1346.29"/>
<text text-anchor="middle" x="3644.5" y="-1401.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu4 -->
<g id="node1141" class="node">
<title>l4_attn_stage10_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1804" cy="-1321" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1804" y="-1332.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="1804" y="-1317.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1804" y="-1302.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu4&#45;&gt;l4_attn_stage10_gpu4 -->
<g id="edge1077" class="edge">
<title>l4_attn_stage9_gpu4&#45;&gt;l4_attn_stage10_gpu4</title>
<path fill="none" stroke="black" d="M1919.21,-1433.37C1897.5,-1412.38 1869.41,-1385.23 1846.4,-1362.98"/>
<polygon fill="black" stroke="black" points="1848.74,-1360.38 1839.12,-1355.95 1843.88,-1365.42 1848.74,-1360.38"/>
</g>
<!-- l4_attn_stage9_gpu4&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge2149" class="edge">
<title>l4_attn_stage9_gpu4&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2007.28,-1437.94C2021.41,-1431.6 2036.94,-1425.81 2052,-1422.5 2096.17,-1412.8 3637.32,-1427.46 3680,-1412.5 3690.15,-1408.94 3688.86,-1401.11 3699,-1397.5 3751.34,-1378.86 4144.53,-1400.48 4199,-1389.5 4244.29,-1380.36 4292.96,-1359.47 4326.19,-1343.32"/>
<polygon fill="red" stroke="red" points="4328.15,-1346.26 4335.57,-1338.7 4325.05,-1339.99 4328.15,-1346.26"/>
<text text-anchor="middle" x="3730.5" y="-1401.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu5 -->
<g id="node1142" class="node">
<title>l4_attn_stage10_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2012" cy="-1321" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2012" y="-1332.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="2012" y="-1317.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2012" y="-1302.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu5&#45;&gt;l4_attn_stage10_gpu5 -->
<g id="edge1078" class="edge">
<title>l4_attn_stage9_gpu5&#45;&gt;l4_attn_stage10_gpu5</title>
<path fill="none" stroke="black" d="M2116.88,-1433C2097.35,-1412.34 2072.27,-1385.79 2051.53,-1363.84"/>
<polygon fill="black" stroke="black" points="2053.81,-1361.15 2044.39,-1356.29 2048.72,-1365.96 2053.81,-1361.15"/>
</g>
<!-- l4_attn_stage9_gpu5&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge2150" class="edge">
<title>l4_attn_stage9_gpu5&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2202.28,-1437.95C2216.41,-1431.61 2231.94,-1425.81 2247,-1422.5 2288.21,-1413.44 3726.18,-1426.47 3766,-1412.5 3776.15,-1408.94 3774.87,-1401.13 3785,-1397.5 3828.32,-1381.99 4153.91,-1398.67 4199,-1389.5 4244.28,-1380.29 4292.95,-1359.4 4326.18,-1343.28"/>
<polygon fill="red" stroke="red" points="4328.14,-1346.22 4335.56,-1338.67 4325.04,-1339.95 4328.14,-1346.22"/>
<text text-anchor="middle" x="3816.5" y="-1401.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu6 -->
<g id="node1143" class="node">
<title>l4_attn_stage10_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2220" cy="-1321" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2220" y="-1332.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="2220" y="-1317.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2220" y="-1302.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu6&#45;&gt;l4_attn_stage10_gpu6 -->
<g id="edge1079" class="edge">
<title>l4_attn_stage9_gpu6&#45;&gt;l4_attn_stage10_gpu6</title>
<path fill="none" stroke="black" d="M2314.3,-1432.27C2296.88,-1411.9 2274.74,-1386.01 2256.29,-1364.43"/>
<polygon fill="black" stroke="black" points="2258.83,-1362.02 2249.67,-1356.7 2253.51,-1366.57 2258.83,-1362.02"/>
</g>
<!-- l4_attn_stage9_gpu6&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge2151" class="edge">
<title>l4_attn_stage9_gpu6&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2397.28,-1437.95C2411.42,-1431.61 2426.94,-1425.81 2442,-1422.5 2480.25,-1414.08 3815.04,-1425.48 3852,-1412.5 3862.15,-1408.94 3860.88,-1401.15 3871,-1397.5 3905.29,-1385.12 4163.29,-1396.86 4199,-1389.5 4244.11,-1380.2 4292.62,-1359.43 4325.86,-1343.37"/>
<polygon fill="red" stroke="red" points="4327.81,-1346.32 4335.24,-1338.77 4324.72,-1340.03 4327.81,-1346.32"/>
<text text-anchor="middle" x="3902.5" y="-1401.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu7 -->
<g id="node1144" class="node">
<title>l4_attn_stage10_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2428" cy="-1321" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2428" y="-1332.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="2428" y="-1317.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2428" y="-1302.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu7&#45;&gt;l4_attn_stage10_gpu7 -->
<g id="edge1080" class="edge">
<title>l4_attn_stage9_gpu7&#45;&gt;l4_attn_stage10_gpu7</title>
<path fill="none" stroke="black" d="M2512.13,-1431.9C2496.71,-1411.76 2477.23,-1386.31 2460.9,-1364.98"/>
<polygon fill="black" stroke="black" points="2463.67,-1362.84 2454.81,-1357.03 2458.11,-1367.1 2463.67,-1362.84"/>
</g>
<!-- l4_attn_stage9_gpu7&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge2152" class="edge">
<title>l4_attn_stage9_gpu7&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2592.28,-1437.96C2606.42,-1431.62 2621.95,-1425.82 2637,-1422.5 2707.59,-1406.94 3869.81,-1436.47 3938,-1412.5 3948.15,-1408.93 3946.9,-1401.2 3957,-1397.5 4007.53,-1379.02 4146.35,-1400.59 4199,-1389.5 4244.07,-1380.01 4292.59,-1359.27 4325.84,-1343.26"/>
<polygon fill="red" stroke="red" points="4327.78,-1346.21 4335.22,-1338.68 4324.7,-1339.92 4327.78,-1346.21"/>
<text text-anchor="middle" x="3988.5" y="-1401.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu8 -->
<g id="node1145" class="node">
<title>l4_attn_stage10_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2636" cy="-1321" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2636" y="-1332.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="2636" y="-1317.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2636" y="-1302.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu8&#45;&gt;l4_attn_stage10_gpu8 -->
<g id="edge1081" class="edge">
<title>l4_attn_stage9_gpu8&#45;&gt;l4_attn_stage10_gpu8</title>
<path fill="none" stroke="black" d="M2710.03,-1431.53C2696.63,-1411.71 2679.82,-1386.84 2665.61,-1365.81"/>
<polygon fill="black" stroke="black" points="2668.4,-1363.68 2659.9,-1357.36 2662.6,-1367.6 2668.4,-1363.68"/>
</g>
<!-- l4_attn_stage9_gpu8&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge2153" class="edge">
<title>l4_attn_stage9_gpu8&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2787.28,-1437.97C2801.42,-1431.63 2816.95,-1425.82 2832,-1422.5 2896.67,-1408.22 3961.53,-1434.48 4024,-1412.5 4034.15,-1408.93 4032.93,-1401.29 4043,-1397.5 4075.49,-1385.28 4165.1,-1396.96 4199,-1389.5 4243.84,-1379.63 4292.21,-1359.04 4325.48,-1343.19"/>
<polygon fill="red" stroke="red" points="4327.4,-1346.15 4334.87,-1338.64 4324.35,-1339.85 4327.4,-1346.15"/>
<text text-anchor="middle" x="4074.5" y="-1401.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu9 -->
<g id="node1146" class="node">
<title>l4_attn_stage10_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2844" cy="-1321" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2844" y="-1332.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="2844" y="-1317.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2844" y="-1302.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu9&#45;&gt;l4_attn_stage10_gpu9 -->
<g id="edge1082" class="edge">
<title>l4_attn_stage9_gpu9&#45;&gt;l4_attn_stage10_gpu9</title>
<path fill="none" stroke="black" d="M2908.21,-1431.53C2896.68,-1411.87 2882.24,-1387.24 2869.98,-1366.32"/>
<polygon fill="black" stroke="black" points="2872.95,-1364.46 2864.87,-1357.61 2866.91,-1368 2872.95,-1364.46"/>
</g>
<!-- l4_attn_stage9_gpu9&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge2154" class="edge">
<title>l4_attn_stage9_gpu9&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2982.29,-1437.97C2996.42,-1431.64 3011.95,-1425.83 3027,-1422.5 3085.75,-1409.5 4053.25,-1432.49 4110,-1412.5 4120.15,-1408.92 4119.05,-1401.6 4129,-1397.5 4157.95,-1385.56 4168.64,-1397.18 4199,-1389.5 4242.96,-1378.37 4290.72,-1358.35 4324.04,-1342.99"/>
<polygon fill="red" stroke="red" points="4325.89,-1345.99 4333.47,-1338.59 4322.93,-1339.65 4325.89,-1345.99"/>
<text text-anchor="middle" x="4160.5" y="-1401.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu10 -->
<g id="node1147" class="node">
<title>l4_attn_stage10_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3052" cy="-1321" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3052" y="-1332.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="3052" y="-1317.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3052" y="-1302.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu10&#45;&gt;l4_attn_stage10_gpu10 -->
<g id="edge1083" class="edge">
<title>l4_attn_stage9_gpu10&#45;&gt;l4_attn_stage10_gpu10</title>
<path fill="none" stroke="black" d="M3106.2,-1431.16C3096.6,-1411.81 3084.64,-1387.74 3074.41,-1367.13"/>
<polygon fill="black" stroke="black" points="3077.42,-1365.33 3069.84,-1357.93 3071.16,-1368.45 3077.42,-1365.33"/>
</g>
<!-- l4_attn_stage9_gpu10&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge2155" class="edge">
<title>l4_attn_stage9_gpu10&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3177.29,-1437.99C3191.42,-1431.65 3206.95,-1425.84 3222,-1422.5 3274.83,-1410.78 4144.97,-1430.51 4196,-1412.5 4206.15,-1408.92 4205.91,-1403.26 4215,-1397.5 4248.39,-1376.35 4288.51,-1356.64 4319.15,-1342.66"/>
<polygon fill="red" stroke="red" points="4320.66,-1345.82 4328.34,-1338.51 4317.78,-1339.44 4320.66,-1345.82"/>
<text text-anchor="middle" x="4246.5" y="-1401.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu11 -->
<g id="node1148" class="node">
<title>l4_attn_stage10_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3260" cy="-1321" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3260" y="-1332.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="3260" y="-1317.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3260" y="-1302.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu11&#45;&gt;l4_attn_stage10_gpu11 -->
<g id="edge1084" class="edge">
<title>l4_attn_stage9_gpu11&#45;&gt;l4_attn_stage10_gpu11</title>
<path fill="none" stroke="black" d="M3304.26,-1430.78C3296.49,-1411.67 3286.86,-1388.01 3278.58,-1367.65"/>
<polygon fill="black" stroke="black" points="3281.76,-1366.2 3274.75,-1358.26 3275.28,-1368.84 3281.76,-1366.2"/>
</g>
<!-- l4_attn_stage9_gpu11&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge2156" class="edge">
<title>l4_attn_stage9_gpu11&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3372.29,-1438C3386.43,-1431.66 3401.95,-1425.85 3417,-1422.5 3463.91,-1412.06 4238,-1431.84 4282,-1412.5 4290.1,-1408.94 4322.79,-1372.7 4345.18,-1347.18"/>
<polygon fill="red" stroke="red" points="4348.1,-1349.16 4352.05,-1339.32 4342.83,-1344.55 4348.1,-1349.16"/>
<text text-anchor="middle" x="4328.5" y="-1401.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu12 -->
<g id="node1149" class="node">
<title>l4_attn_stage10_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3468" cy="-1321" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3468" y="-1332.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="3468" y="-1317.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3468" y="-1302.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu12&#45;&gt;l4_attn_stage10_gpu12 -->
<g id="edge1085" class="edge">
<title>l4_attn_stage9_gpu12&#45;&gt;l4_attn_stage10_gpu12</title>
<path fill="none" stroke="black" d="M3459.78,-1438.33C3446.14,-1432.19 3431.3,-1426.39 3417,-1422.5 3395.66,-1416.7 3332.83,-1428.9 3318,-1412.5 3287.62,-1378.9 3337.35,-1399.96 3364,-1389.5 3382.6,-1382.2 3401.38,-1371.32 3417.77,-1360.42"/>
<polygon fill="black" stroke="black" points="3419.82,-1363.26 3426.11,-1354.73 3415.88,-1357.47 3419.82,-1363.26"/>
</g>
<!-- l4_attn_stage9_gpu12&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge2157" class="edge">
<title>l4_attn_stage9_gpu12&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3567.29,-1438.02C3581.43,-1431.68 3596.95,-1425.86 3612,-1422.5 3632.5,-1417.92 4353.25,-1427.45 4368,-1412.5 4384.05,-1396.23 4381.54,-1369.24 4376.38,-1348.96"/>
<polygon fill="red" stroke="red" points="4379.74,-1347.98 4373.62,-1339.34 4373.01,-1349.92 4379.74,-1347.98"/>
<text text-anchor="middle" x="4407.5" y="-1401.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu13 -->
<g id="node1150" class="node">
<title>l4_attn_stage10_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3676" cy="-1321" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3676" y="-1332.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="3676" y="-1317.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3676" y="-1302.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu13&#45;&gt;l4_attn_stage10_gpu13 -->
<g id="edge1086" class="edge">
<title>l4_attn_stage9_gpu13&#45;&gt;l4_attn_stage10_gpu13</title>
<path fill="none" stroke="black" d="M3655.72,-1438.01C3641.86,-1431.75 3626.69,-1425.98 3612,-1422.5 3596.48,-1418.82 3336.08,-1423.98 3325,-1412.5 3320.37,-1407.7 3320.36,-1402.29 3325,-1397.5 3334.55,-1387.64 3558.9,-1393.61 3572,-1389.5 3591.59,-1383.35 3611.02,-1372.42 3627.68,-1361.11"/>
<polygon fill="black" stroke="black" points="3629.95,-1363.8 3636.14,-1355.19 3625.94,-1358.07 3629.95,-1363.8"/>
</g>
<!-- l4_attn_stage9_gpu13&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge2158" class="edge">
<title>l4_attn_stage9_gpu13&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3762.3,-1438.04C3776.43,-1431.7 3791.96,-1425.88 3807,-1422.5 3824.54,-1418.56 4441.39,-1425.31 4454,-1412.5 4476.99,-1389.15 4442.96,-1362.01 4410.96,-1343.58"/>
<polygon fill="red" stroke="red" points="4412.48,-1340.42 4402.04,-1338.63 4409.08,-1346.54 4412.48,-1340.42"/>
<text text-anchor="middle" x="4492.5" y="-1401.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu14 -->
<g id="node1151" class="node">
<title>l4_attn_stage10_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3884" cy="-1321" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3884" y="-1332.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="3884" y="-1317.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3884" y="-1302.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu14&#45;&gt;l4_attn_stage10_gpu14 -->
<g id="edge1087" class="edge">
<title>l4_attn_stage9_gpu14&#45;&gt;l4_attn_stage10_gpu14</title>
<path fill="none" stroke="black" d="M3850.75,-1437.87C3836.9,-1431.61 3821.72,-1425.88 3807,-1422.5 3781.27,-1416.6 3350.47,-1431.36 3332,-1412.5 3327.34,-1407.74 3327.33,-1402.26 3332,-1397.5 3340.72,-1388.62 3768.1,-1393.14 3780,-1389.5 3799.63,-1383.5 3819.07,-1372.6 3835.74,-1361.28"/>
<polygon fill="black" stroke="black" points="3838.01,-1363.96 3844.18,-1355.35 3833.99,-1358.23 3838.01,-1363.96"/>
</g>
<!-- l4_attn_stage9_gpu14&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge2159" class="edge">
<title>l4_attn_stage9_gpu14&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3957.56,-1437.96C3971.63,-1431.66 3987.06,-1425.88 4002,-1422.5 4016.58,-1419.2 4529.53,-1423.17 4540,-1412.5 4574.12,-1377.74 4515.44,-1353.49 4457.38,-1338.9"/>
<polygon fill="red" stroke="red" points="4457.87,-1335.42 4447.33,-1336.47 4456.22,-1342.22 4457.87,-1335.42"/>
<text text-anchor="middle" x="4580.5" y="-1401.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage10_gpu15 -->
<g id="node1152" class="node">
<title>l4_attn_stage10_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4092" cy="-1321" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4092" y="-1332.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage10</text>
<text text-anchor="middle" x="4092" y="-1317.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4092" y="-1302.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage9_gpu15&#45;&gt;l4_attn_stage10_gpu15 -->
<g id="edge1088" class="edge">
<title>l4_attn_stage9_gpu15&#45;&gt;l4_attn_stage10_gpu15</title>
<path fill="none" stroke="black" d="M4046.02,-1437.92C4032.1,-1431.62 4016.82,-1425.85 4002,-1422.5 3984.04,-1418.43 3351.93,-1425.62 3339,-1412.5 3334.32,-1407.75 3334.32,-1402.24 3339,-1397.5 3351.67,-1384.67 3970.74,-1394.72 3988,-1389.5 4007.65,-1383.55 4027.09,-1372.66 4043.76,-1361.35"/>
<polygon fill="black" stroke="black" points="4046.03,-1364.03 4052.2,-1355.41 4042.01,-1358.3 4046.03,-1364.03"/>
</g>
<!-- l4_attn_stage9_gpu15&#45;&gt;l4_attn_stage10_gpu[next_gpu] -->
<g id="edge2160" class="edge">
<title>l4_attn_stage9_gpu15&#45;&gt;l4_attn_stage10_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4154.38,-1438.7C4169.74,-1432.14 4186.69,-1426.04 4203,-1422.5 4225.97,-1417.51 4609.58,-1429.32 4626,-1412.5 4672.21,-1365.18 4592.09,-1342.57 4509.09,-1331.78"/>
<polygon fill="red" stroke="red" points="4509.32,-1328.29 4498.97,-1330.53 4508.46,-1335.23 4509.32,-1328.29"/>
<text text-anchor="middle" x="4667.5" y="-1401.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu0 -->
<g id="node1153" class="node">
<title>l4_attn_stage11_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="972" cy="-1174" rx="95" ry="37.5"/>
<text text-anchor="middle" x="972" y="-1185.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="972" y="-1170.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="972" y="-1155.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu0&#45;&gt;l4_attn_stage11_gpu0 -->
<g id="edge1089" class="edge">
<title>l4_attn_stage10_gpu0&#45;&gt;l4_attn_stage11_gpu0</title>
<path fill="none" stroke="black" d="M972,-1283.41C972,-1264.69 972,-1241.7 972,-1221.72"/>
<polygon fill="black" stroke="black" points="975.5,-1221.58 972,-1211.58 968.5,-1221.58 975.5,-1221.58"/>
</g>
<!-- l4_attn_stage11_gpu[next_gpu] -->
<g id="node1368" class="node">
<title>l4_attn_stage11_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4367" cy="-1174" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4367" y="-1170.3" font-family="Times,serif" font-size="14.00">l4_attn_stage11_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage10_gpu0&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge2161" class="edge">
<title>l4_attn_stage10_gpu0&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1028.98,-1290.87C1043.91,-1284.58 1060.24,-1278.82 1076,-1275.5 1325.97,-1222.85 3119.55,-1253.13 3375,-1250.5 3420.78,-1250.03 4154.1,-1251.41 4199,-1242.5 4244.32,-1233.51 4292.98,-1212.59 4326.21,-1196.4"/>
<polygon fill="red" stroke="red" points="4328.17,-1199.34 4335.58,-1191.76 4325.06,-1193.06 4328.17,-1199.34"/>
<text text-anchor="middle" x="3406.5" y="-1254.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu1 -->
<g id="node1154" class="node">
<title>l4_attn_stage11_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1180" cy="-1174" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1180" y="-1185.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="1180" y="-1170.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1180" y="-1155.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu1&#45;&gt;l4_attn_stage11_gpu1 -->
<g id="edge1090" class="edge">
<title>l4_attn_stage10_gpu1&#45;&gt;l4_attn_stage11_gpu1</title>
<path fill="none" stroke="black" d="M1180,-1283.41C1180,-1264.69 1180,-1241.7 1180,-1221.72"/>
<polygon fill="black" stroke="black" points="1183.5,-1221.58 1180,-1211.58 1176.5,-1221.58 1183.5,-1221.58"/>
</g>
<!-- l4_attn_stage10_gpu1&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge2162" class="edge">
<title>l4_attn_stage10_gpu1&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1236.97,-1290.8C1251.89,-1284.51 1268.23,-1278.77 1284,-1275.5 1342.7,-1263.33 3385.42,-1285.29 3442,-1265.5 3452.16,-1261.95 3450.86,-1254.08 3461,-1250.5 3499.66,-1236.84 4158.79,-1250.5 4199,-1242.5 4244.31,-1233.48 4292.98,-1212.57 4326.21,-1196.39"/>
<polygon fill="red" stroke="red" points="4328.17,-1199.32 4335.58,-1191.75 4325.06,-1193.05 4328.17,-1199.32"/>
<text text-anchor="middle" x="3492.5" y="-1254.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu2 -->
<g id="node1155" class="node">
<title>l4_attn_stage11_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1388" cy="-1174" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1388" y="-1185.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="1388" y="-1170.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1388" y="-1155.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu2&#45;&gt;l4_attn_stage11_gpu2 -->
<g id="edge1091" class="edge">
<title>l4_attn_stage10_gpu2&#45;&gt;l4_attn_stage11_gpu2</title>
<path fill="none" stroke="black" d="M1388,-1283.41C1388,-1264.69 1388,-1241.7 1388,-1221.72"/>
<polygon fill="black" stroke="black" points="1391.5,-1221.58 1388,-1211.58 1384.5,-1221.58 1391.5,-1221.58"/>
</g>
<!-- l4_attn_stage10_gpu2&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge2163" class="edge">
<title>l4_attn_stage10_gpu2&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1444.97,-1290.81C1459.89,-1284.51 1476.23,-1278.77 1492,-1275.5 1547.38,-1264.01 3474.62,-1284.18 3528,-1265.5 3538.16,-1261.95 3536.86,-1254.09 3547,-1250.5 3581.15,-1238.41 4163.48,-1249.6 4199,-1242.5 4244.31,-1233.45 4292.97,-1212.54 4326.2,-1196.37"/>
<polygon fill="red" stroke="red" points="4328.16,-1199.31 4335.57,-1191.74 4325.06,-1193.03 4328.16,-1199.31"/>
<text text-anchor="middle" x="3578.5" y="-1254.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu3 -->
<g id="node1156" class="node">
<title>l4_attn_stage11_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1596" cy="-1174" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1596" y="-1185.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="1596" y="-1170.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1596" y="-1155.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu3&#45;&gt;l4_attn_stage11_gpu3 -->
<g id="edge1092" class="edge">
<title>l4_attn_stage10_gpu3&#45;&gt;l4_attn_stage11_gpu3</title>
<path fill="none" stroke="black" d="M1596,-1283.41C1596,-1264.69 1596,-1241.7 1596,-1221.72"/>
<polygon fill="black" stroke="black" points="1599.5,-1221.58 1596,-1211.58 1592.5,-1221.58 1599.5,-1221.58"/>
</g>
<!-- l4_attn_stage10_gpu3&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge2164" class="edge">
<title>l4_attn_stage10_gpu3&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1652.97,-1290.81C1667.9,-1284.52 1684.23,-1278.77 1700,-1275.5 1752.06,-1264.69 3563.82,-1283.07 3614,-1265.5 3624.15,-1261.94 3622.86,-1254.1 3633,-1250.5 3662.63,-1239.98 4168.17,-1248.69 4199,-1242.5 4244.3,-1233.41 4292.97,-1212.5 4326.2,-1196.35"/>
<polygon fill="red" stroke="red" points="4328.15,-1199.29 4335.57,-1191.72 4325.05,-1193.01 4328.15,-1199.29"/>
<text text-anchor="middle" x="3664.5" y="-1254.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu4 -->
<g id="node1157" class="node">
<title>l4_attn_stage11_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1804" cy="-1174" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1804" y="-1185.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="1804" y="-1170.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1804" y="-1155.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu4&#45;&gt;l4_attn_stage11_gpu4 -->
<g id="edge1093" class="edge">
<title>l4_attn_stage10_gpu4&#45;&gt;l4_attn_stage11_gpu4</title>
<path fill="none" stroke="black" d="M1804,-1283.41C1804,-1264.69 1804,-1241.7 1804,-1221.72"/>
<polygon fill="black" stroke="black" points="1807.5,-1221.58 1804,-1211.58 1800.5,-1221.58 1807.5,-1221.58"/>
</g>
<!-- l4_attn_stage10_gpu4&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge2165" class="edge">
<title>l4_attn_stage10_gpu4&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1860.97,-1290.81C1875.9,-1284.52 1892.23,-1278.78 1908,-1275.5 1956.74,-1265.37 3653.02,-1281.96 3700,-1265.5 3710.15,-1261.94 3708.87,-1254.11 3719,-1250.5 3769.24,-1232.59 4146.72,-1253.06 4199,-1242.5 4244.29,-1233.35 4292.96,-1212.45 4326.19,-1196.32"/>
<polygon fill="red" stroke="red" points="4328.14,-1199.26 4335.56,-1191.69 4325.05,-1192.98 4328.14,-1199.26"/>
<text text-anchor="middle" x="3750.5" y="-1254.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu5 -->
<g id="node1158" class="node">
<title>l4_attn_stage11_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2012" cy="-1174" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2012" y="-1185.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="2012" y="-1170.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2012" y="-1155.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu5&#45;&gt;l4_attn_stage11_gpu5 -->
<g id="edge1094" class="edge">
<title>l4_attn_stage10_gpu5&#45;&gt;l4_attn_stage11_gpu5</title>
<path fill="none" stroke="black" d="M2012,-1283.41C2012,-1264.69 2012,-1241.7 2012,-1221.72"/>
<polygon fill="black" stroke="black" points="2015.5,-1221.58 2012,-1211.58 2008.5,-1221.58 2015.5,-1221.58"/>
</g>
<!-- l4_attn_stage10_gpu5&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge2166" class="edge">
<title>l4_attn_stage10_gpu5&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2068.97,-1290.82C2083.9,-1284.52 2100.23,-1278.78 2116,-1275.5 2161.42,-1266.05 3742.22,-1280.84 3786,-1265.5 3796.15,-1261.94 3794.87,-1254.13 3805,-1250.5 3846.22,-1235.72 4156.1,-1251.25 4199,-1242.5 4244.27,-1233.27 4292.94,-1212.38 4326.18,-1196.27"/>
<polygon fill="red" stroke="red" points="4328.13,-1199.21 4335.56,-1191.66 4325.04,-1192.93 4328.13,-1199.21"/>
<text text-anchor="middle" x="3836.5" y="-1254.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu6 -->
<g id="node1159" class="node">
<title>l4_attn_stage11_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2220" cy="-1174" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2220" y="-1185.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="2220" y="-1170.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2220" y="-1155.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu6&#45;&gt;l4_attn_stage11_gpu6 -->
<g id="edge1095" class="edge">
<title>l4_attn_stage10_gpu6&#45;&gt;l4_attn_stage11_gpu6</title>
<path fill="none" stroke="black" d="M2220,-1283.41C2220,-1264.69 2220,-1241.7 2220,-1221.72"/>
<polygon fill="black" stroke="black" points="2223.5,-1221.58 2220,-1211.58 2216.5,-1221.58 2223.5,-1221.58"/>
</g>
<!-- l4_attn_stage10_gpu6&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge2167" class="edge">
<title>l4_attn_stage10_gpu6&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2276.97,-1290.82C2291.9,-1284.53 2308.23,-1278.78 2324,-1275.5 2366.1,-1266.73 3831.42,-1279.73 3872,-1265.5 3882.15,-1261.94 3880.88,-1254.16 3891,-1250.5 3923.19,-1238.85 4165.48,-1249.44 4199,-1242.5 4244.11,-1233.17 4292.62,-1212.4 4325.86,-1196.35"/>
<polygon fill="red" stroke="red" points="4327.8,-1199.3 4335.24,-1191.75 4324.72,-1193.01 4327.8,-1199.3"/>
<text text-anchor="middle" x="3922.5" y="-1254.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu7 -->
<g id="node1160" class="node">
<title>l4_attn_stage11_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2428" cy="-1174" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2428" y="-1185.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="2428" y="-1170.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2428" y="-1155.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu7&#45;&gt;l4_attn_stage11_gpu7 -->
<g id="edge1096" class="edge">
<title>l4_attn_stage10_gpu7&#45;&gt;l4_attn_stage11_gpu7</title>
<path fill="none" stroke="black" d="M2428,-1283.41C2428,-1264.69 2428,-1241.7 2428,-1221.72"/>
<polygon fill="black" stroke="black" points="2431.5,-1221.58 2428,-1211.58 2424.5,-1221.58 2431.5,-1221.58"/>
</g>
<!-- l4_attn_stage10_gpu7&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge2168" class="edge">
<title>l4_attn_stage10_gpu7&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2484.98,-1290.83C2499.9,-1284.54 2516.24,-1278.79 2532,-1275.5 2570.78,-1267.41 3920.62,-1278.62 3958,-1265.5 3968.15,-1261.94 3966.9,-1254.21 3977,-1250.5 4023.34,-1233.47 4150.71,-1252.74 4199,-1242.5 4244.06,-1232.94 4292.58,-1212.21 4325.83,-1196.23"/>
<polygon fill="red" stroke="red" points="4327.76,-1199.18 4335.22,-1191.65 4324.69,-1192.89 4327.76,-1199.18"/>
<text text-anchor="middle" x="4008.5" y="-1254.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu8 -->
<g id="node1161" class="node">
<title>l4_attn_stage11_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2636" cy="-1174" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2636" y="-1185.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="2636" y="-1170.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2636" y="-1155.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu8&#45;&gt;l4_attn_stage11_gpu8 -->
<g id="edge1097" class="edge">
<title>l4_attn_stage10_gpu8&#45;&gt;l4_attn_stage11_gpu8</title>
<path fill="none" stroke="black" d="M2636,-1283.41C2636,-1264.69 2636,-1241.7 2636,-1221.72"/>
<polygon fill="black" stroke="black" points="2639.5,-1221.58 2636,-1211.58 2632.5,-1221.58 2639.5,-1221.58"/>
</g>
<!-- l4_attn_stage10_gpu8&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge2169" class="edge">
<title>l4_attn_stage10_gpu8&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2692.98,-1290.84C2707.9,-1284.54 2724.24,-1278.79 2740,-1275.5 2810.91,-1260.68 3975.65,-1289.52 4044,-1265.5 4054.15,-1261.93 4052.94,-1254.33 4063,-1250.5 4091.3,-1239.73 4169.46,-1249.12 4199,-1242.5 4243.67,-1232.49 4291.88,-1212.03 4325.15,-1196.24"/>
<polygon fill="red" stroke="red" points="4327.06,-1199.21 4334.55,-1191.72 4324.02,-1192.9 4327.06,-1199.21"/>
<text text-anchor="middle" x="4094.5" y="-1254.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu9 -->
<g id="node1162" class="node">
<title>l4_attn_stage11_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2844" cy="-1174" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2844" y="-1185.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="2844" y="-1170.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2844" y="-1155.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu9&#45;&gt;l4_attn_stage11_gpu9 -->
<g id="edge1098" class="edge">
<title>l4_attn_stage10_gpu9&#45;&gt;l4_attn_stage11_gpu9</title>
<path fill="none" stroke="black" d="M2844,-1283.41C2844,-1264.69 2844,-1241.7 2844,-1221.72"/>
<polygon fill="black" stroke="black" points="2847.5,-1221.58 2844,-1211.58 2840.5,-1221.58 2847.5,-1221.58"/>
</g>
<!-- l4_attn_stage10_gpu9&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge2170" class="edge">
<title>l4_attn_stage10_gpu9&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2900.98,-1290.85C2915.9,-1284.55 2932.24,-1278.8 2948,-1275.5 3012.28,-1262.04 4068.05,-1287.3 4130,-1265.5 4140.15,-1261.93 4139.15,-1254.82 4149,-1250.5 4169.61,-1241.46 4177.31,-1248.51 4199,-1242.5 4242.28,-1230.5 4289.59,-1210.87 4322.94,-1195.86"/>
<polygon fill="red" stroke="red" points="4324.74,-1198.89 4332.4,-1191.56 4321.84,-1192.52 4324.74,-1198.89"/>
<text text-anchor="middle" x="4180.5" y="-1254.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu10 -->
<g id="node1163" class="node">
<title>l4_attn_stage11_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3052" cy="-1174" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3052" y="-1185.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="3052" y="-1170.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3052" y="-1155.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu10&#45;&gt;l4_attn_stage11_gpu10 -->
<g id="edge1099" class="edge">
<title>l4_attn_stage10_gpu10&#45;&gt;l4_attn_stage11_gpu10</title>
<path fill="none" stroke="black" d="M3052,-1283.41C3052,-1264.69 3052,-1241.7 3052,-1221.72"/>
<polygon fill="black" stroke="black" points="3055.5,-1221.58 3052,-1211.58 3048.5,-1221.58 3055.5,-1221.58"/>
</g>
<!-- l4_attn_stage10_gpu10&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge2171" class="edge">
<title>l4_attn_stage10_gpu10&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3108.98,-1290.86C3123.91,-1284.56 3140.24,-1278.81 3156,-1275.5 3213.64,-1263.4 4160.46,-1285.08 4216,-1265.5 4226.15,-1261.92 4226.08,-1256.52 4235,-1250.5 4264.36,-1230.68 4299.2,-1210.89 4325.72,-1196.55"/>
<polygon fill="red" stroke="red" points="4327.57,-1199.53 4334.73,-1191.71 4324.26,-1193.36 4327.57,-1199.53"/>
<text text-anchor="middle" x="4266.5" y="-1254.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu11 -->
<g id="node1164" class="node">
<title>l4_attn_stage11_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3260" cy="-1174" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3260" y="-1185.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="3260" y="-1170.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3260" y="-1155.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu11&#45;&gt;l4_attn_stage11_gpu11 -->
<g id="edge1100" class="edge">
<title>l4_attn_stage10_gpu11&#45;&gt;l4_attn_stage11_gpu11</title>
<path fill="none" stroke="black" d="M3260,-1283.41C3260,-1264.69 3260,-1241.7 3260,-1221.72"/>
<polygon fill="black" stroke="black" points="3263.5,-1221.58 3260,-1211.58 3256.5,-1221.58 3263.5,-1221.58"/>
</g>
<!-- l4_attn_stage10_gpu11&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge2172" class="edge">
<title>l4_attn_stage10_gpu11&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3316.98,-1290.87C3331.91,-1284.57 3348.24,-1278.82 3364,-1275.5 3389.5,-1270.13 4278.88,-1277.52 4302,-1265.5 4315.7,-1258.38 4337.58,-1224.96 4352.12,-1200.8"/>
<polygon fill="red" stroke="red" points="4355.21,-1202.46 4357.3,-1192.07 4349.19,-1198.88 4355.21,-1202.46"/>
<text text-anchor="middle" x="4348.5" y="-1254.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu12 -->
<g id="node1165" class="node">
<title>l4_attn_stage11_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3468" cy="-1174" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3468" y="-1185.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="3468" y="-1170.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3468" y="-1155.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu12&#45;&gt;l4_attn_stage11_gpu12 -->
<g id="edge1101" class="edge">
<title>l4_attn_stage10_gpu12&#45;&gt;l4_attn_stage11_gpu12</title>
<path fill="none" stroke="black" d="M3405.19,-1292.68C3391.64,-1286.91 3377.37,-1280.93 3364,-1275.5 3352.53,-1270.84 3345.01,-1275.71 3338,-1265.5 3334.23,-1260 3334.04,-1255.86 3338,-1250.5 3345.18,-1240.77 3353.05,-1247.62 3364,-1242.5 3381.44,-1234.35 3399.39,-1223.66 3415.36,-1213.19"/>
<polygon fill="black" stroke="black" points="3417.64,-1215.88 3424.02,-1207.42 3413.76,-1210.05 3417.64,-1215.88"/>
</g>
<!-- l4_attn_stage10_gpu12&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge2173" class="edge">
<title>l4_attn_stage10_gpu12&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3524.99,-1290.89C3539.91,-1284.59 3556.24,-1278.83 3572,-1275.5 3594.18,-1270.81 4372.07,-1281.63 4388,-1265.5 4404.71,-1248.58 4395.21,-1221.14 4384.15,-1200.9"/>
<polygon fill="red" stroke="red" points="4387.11,-1199.04 4379.04,-1192.17 4381.07,-1202.57 4387.11,-1199.04"/>
<text text-anchor="middle" x="4426.5" y="-1254.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu13 -->
<g id="node1166" class="node">
<title>l4_attn_stage11_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3676" cy="-1174" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3676" y="-1185.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="3676" y="-1170.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3676" y="-1155.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu13&#45;&gt;l4_attn_stage11_gpu13 -->
<g id="edge1102" class="edge">
<title>l4_attn_stage10_gpu13&#45;&gt;l4_attn_stage11_gpu13</title>
<path fill="none" stroke="black" d="M3618.39,-1291C3603.62,-1284.79 3587.51,-1279.04 3572,-1275.5 3547.39,-1269.89 3362.45,-1283.74 3345,-1265.5 3340.39,-1260.68 3340.37,-1255.3 3345,-1250.5 3353.76,-1241.42 3559.97,-1246.29 3572,-1242.5 3591.58,-1236.33 3611,-1225.38 3627.67,-1214.08"/>
<polygon fill="black" stroke="black" points="3629.94,-1216.77 3636.13,-1208.16 3625.93,-1211.03 3629.94,-1216.77"/>
</g>
<!-- l4_attn_stage10_gpu13&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge2174" class="edge">
<title>l4_attn_stage10_gpu13&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3732.99,-1290.91C3747.92,-1284.62 3764.25,-1278.85 3780,-1275.5 3798.86,-1271.49 4460.47,-1279.23 4474,-1265.5 4499.62,-1239.51 4458.49,-1212.91 4420.04,-1195.34"/>
<polygon fill="red" stroke="red" points="4421.44,-1192.13 4410.88,-1191.29 4418.61,-1198.53 4421.44,-1192.13"/>
<text text-anchor="middle" x="4512.5" y="-1254.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu14 -->
<g id="node1167" class="node">
<title>l4_attn_stage11_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3884" cy="-1174" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3884" y="-1185.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="3884" y="-1170.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3884" y="-1155.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu14&#45;&gt;l4_attn_stage11_gpu14 -->
<g id="edge1103" class="edge">
<title>l4_attn_stage10_gpu14&#45;&gt;l4_attn_stage11_gpu14</title>
<path fill="none" stroke="black" d="M3826.71,-1290.89C3811.86,-1284.64 3795.64,-1278.9 3780,-1275.5 3756.76,-1270.45 3368.62,-1282.51 3352,-1265.5 3347.34,-1260.73 3347.33,-1255.26 3352,-1250.5 3360.33,-1242.01 3768.63,-1245.98 3780,-1242.5 3799.63,-1236.49 3819.07,-1225.59 3835.73,-1214.27"/>
<polygon fill="black" stroke="black" points="3838.01,-1216.95 3844.18,-1208.34 3833.99,-1211.22 3838.01,-1216.95"/>
</g>
<!-- l4_attn_stage10_gpu14&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge2175" class="edge">
<title>l4_attn_stage10_gpu14&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3941,-1290.94C3955.92,-1284.65 3972.25,-1278.87 3988,-1275.5 4003.54,-1272.17 4548.86,-1276.83 4560,-1265.5 4596.88,-1227.96 4533.24,-1204.2 4469.37,-1190.5"/>
<polygon fill="red" stroke="red" points="4470.05,-1187.06 4459.55,-1188.47 4468.63,-1193.92 4470.05,-1187.06"/>
<text text-anchor="middle" x="4599.5" y="-1254.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage11_gpu15 -->
<g id="node1168" class="node">
<title>l4_attn_stage11_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4092" cy="-1174" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4092" y="-1185.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage11</text>
<text text-anchor="middle" x="4092" y="-1170.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4092" y="-1155.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage10_gpu15&#45;&gt;l4_attn_stage11_gpu15 -->
<g id="edge1104" class="edge">
<title>l4_attn_stage10_gpu15&#45;&gt;l4_attn_stage11_gpu15</title>
<path fill="none" stroke="black" d="M4035,-1290.93C4020.08,-1284.63 4003.75,-1278.86 3988,-1275.5 3970.91,-1271.86 3371.26,-1277.95 3359,-1265.5 3354.32,-1260.75 3354.32,-1255.24 3359,-1250.5 3371.28,-1238.07 3971.28,-1247.57 3988,-1242.5 4007.65,-1236.55 4027.09,-1225.66 4043.75,-1214.34"/>
<polygon fill="black" stroke="black" points="4046.03,-1217.02 4052.2,-1208.41 4042.01,-1211.29 4046.03,-1217.02"/>
</g>
<!-- l4_attn_stage10_gpu15&#45;&gt;l4_attn_stage11_gpu[next_gpu] -->
<g id="edge2176" class="edge">
<title>l4_attn_stage10_gpu15&#45;&gt;l4_attn_stage11_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4151.56,-1291.58C4167.88,-1285.06 4185.81,-1279.02 4203,-1275.5 4227.12,-1270.56 4628.79,-1283.1 4646,-1265.5 4695.67,-1214.7 4608.33,-1192.39 4518.57,-1182.61"/>
<polygon fill="red" stroke="red" points="4518.78,-1179.11 4508.47,-1181.56 4518.05,-1186.07 4518.78,-1179.11"/>
<text text-anchor="middle" x="4685.5" y="-1254.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu0 -->
<g id="node1169" class="node">
<title>l4_attn_stage12_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="972" cy="-1027" rx="95" ry="37.5"/>
<text text-anchor="middle" x="972" y="-1038.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="972" y="-1023.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="972" y="-1008.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu0&#45;&gt;l4_attn_stage12_gpu0 -->
<g id="edge1105" class="edge">
<title>l4_attn_stage11_gpu0&#45;&gt;l4_attn_stage12_gpu0</title>
<path fill="none" stroke="black" d="M972,-1136.41C972,-1117.69 972,-1094.7 972,-1074.72"/>
<polygon fill="black" stroke="black" points="975.5,-1074.58 972,-1064.58 968.5,-1074.58 975.5,-1074.58"/>
</g>
<!-- l4_attn_stage12_gpu[next_gpu] -->
<g id="node1369" class="node">
<title>l4_attn_stage12_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4367" cy="-1027" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4367" y="-1023.3" font-family="Times,serif" font-size="14.00">l4_attn_stage12_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage11_gpu0&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge2177" class="edge">
<title>l4_attn_stage11_gpu0&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1028.98,-1143.87C1043.91,-1137.58 1060.24,-1131.82 1076,-1128.5 1325.97,-1075.85 3119.55,-1106.13 3375,-1103.5 3420.78,-1103.03 4154.1,-1104.41 4199,-1095.5 4244.32,-1086.51 4292.98,-1065.59 4326.21,-1049.4"/>
<polygon fill="red" stroke="red" points="4328.17,-1052.34 4335.58,-1044.76 4325.06,-1046.06 4328.17,-1052.34"/>
<text text-anchor="middle" x="3406.5" y="-1107.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu1 -->
<g id="node1170" class="node">
<title>l4_attn_stage12_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1180" cy="-1027" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1180" y="-1038.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="1180" y="-1023.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1180" y="-1008.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu1&#45;&gt;l4_attn_stage12_gpu1 -->
<g id="edge1106" class="edge">
<title>l4_attn_stage11_gpu1&#45;&gt;l4_attn_stage12_gpu1</title>
<path fill="none" stroke="black" d="M1180,-1136.41C1180,-1117.69 1180,-1094.7 1180,-1074.72"/>
<polygon fill="black" stroke="black" points="1183.5,-1074.58 1180,-1064.58 1176.5,-1074.58 1183.5,-1074.58"/>
</g>
<!-- l4_attn_stage11_gpu1&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge2178" class="edge">
<title>l4_attn_stage11_gpu1&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1236.97,-1143.8C1251.89,-1137.51 1268.23,-1131.77 1284,-1128.5 1342.7,-1116.33 3385.42,-1138.29 3442,-1118.5 3452.16,-1114.95 3450.86,-1107.08 3461,-1103.5 3499.66,-1089.84 4158.79,-1103.5 4199,-1095.5 4244.31,-1086.48 4292.98,-1065.57 4326.21,-1049.39"/>
<polygon fill="red" stroke="red" points="4328.17,-1052.32 4335.58,-1044.75 4325.06,-1046.05 4328.17,-1052.32"/>
<text text-anchor="middle" x="3492.5" y="-1107.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu2 -->
<g id="node1171" class="node">
<title>l4_attn_stage12_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1388" cy="-1027" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1388" y="-1038.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="1388" y="-1023.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1388" y="-1008.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu2&#45;&gt;l4_attn_stage12_gpu2 -->
<g id="edge1107" class="edge">
<title>l4_attn_stage11_gpu2&#45;&gt;l4_attn_stage12_gpu2</title>
<path fill="none" stroke="black" d="M1388,-1136.41C1388,-1117.69 1388,-1094.7 1388,-1074.72"/>
<polygon fill="black" stroke="black" points="1391.5,-1074.58 1388,-1064.58 1384.5,-1074.58 1391.5,-1074.58"/>
</g>
<!-- l4_attn_stage11_gpu2&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge2179" class="edge">
<title>l4_attn_stage11_gpu2&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1444.97,-1143.81C1459.89,-1137.51 1476.23,-1131.77 1492,-1128.5 1547.38,-1117.01 3474.62,-1137.18 3528,-1118.5 3538.16,-1114.95 3536.86,-1107.09 3547,-1103.5 3581.15,-1091.41 4163.48,-1102.6 4199,-1095.5 4244.31,-1086.45 4292.97,-1065.54 4326.2,-1049.37"/>
<polygon fill="red" stroke="red" points="4328.16,-1052.31 4335.57,-1044.74 4325.06,-1046.03 4328.16,-1052.31"/>
<text text-anchor="middle" x="3578.5" y="-1107.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu3 -->
<g id="node1172" class="node">
<title>l4_attn_stage12_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1596" cy="-1027" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1596" y="-1038.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="1596" y="-1023.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1596" y="-1008.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu3&#45;&gt;l4_attn_stage12_gpu3 -->
<g id="edge1108" class="edge">
<title>l4_attn_stage11_gpu3&#45;&gt;l4_attn_stage12_gpu3</title>
<path fill="none" stroke="black" d="M1596,-1136.41C1596,-1117.69 1596,-1094.7 1596,-1074.72"/>
<polygon fill="black" stroke="black" points="1599.5,-1074.58 1596,-1064.58 1592.5,-1074.58 1599.5,-1074.58"/>
</g>
<!-- l4_attn_stage11_gpu3&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge2180" class="edge">
<title>l4_attn_stage11_gpu3&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1652.97,-1143.81C1667.9,-1137.52 1684.23,-1131.77 1700,-1128.5 1752.06,-1117.69 3563.82,-1136.07 3614,-1118.5 3624.15,-1114.94 3622.86,-1107.1 3633,-1103.5 3662.63,-1092.98 4168.17,-1101.69 4199,-1095.5 4244.3,-1086.41 4292.97,-1065.5 4326.2,-1049.35"/>
<polygon fill="red" stroke="red" points="4328.15,-1052.29 4335.57,-1044.72 4325.05,-1046.01 4328.15,-1052.29"/>
<text text-anchor="middle" x="3664.5" y="-1107.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu4 -->
<g id="node1173" class="node">
<title>l4_attn_stage12_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1804" cy="-1027" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1804" y="-1038.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="1804" y="-1023.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1804" y="-1008.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu4&#45;&gt;l4_attn_stage12_gpu4 -->
<g id="edge1109" class="edge">
<title>l4_attn_stage11_gpu4&#45;&gt;l4_attn_stage12_gpu4</title>
<path fill="none" stroke="black" d="M1804,-1136.41C1804,-1117.69 1804,-1094.7 1804,-1074.72"/>
<polygon fill="black" stroke="black" points="1807.5,-1074.58 1804,-1064.58 1800.5,-1074.58 1807.5,-1074.58"/>
</g>
<!-- l4_attn_stage11_gpu4&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge2181" class="edge">
<title>l4_attn_stage11_gpu4&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1860.97,-1143.81C1875.9,-1137.52 1892.23,-1131.78 1908,-1128.5 1956.74,-1118.37 3653.02,-1134.96 3700,-1118.5 3710.15,-1114.94 3708.87,-1107.11 3719,-1103.5 3769.24,-1085.59 4146.72,-1106.06 4199,-1095.5 4244.29,-1086.35 4292.96,-1065.45 4326.19,-1049.32"/>
<polygon fill="red" stroke="red" points="4328.14,-1052.26 4335.56,-1044.69 4325.05,-1045.98 4328.14,-1052.26"/>
<text text-anchor="middle" x="3750.5" y="-1107.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu5 -->
<g id="node1174" class="node">
<title>l4_attn_stage12_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2012" cy="-1027" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2012" y="-1038.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="2012" y="-1023.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2012" y="-1008.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu5&#45;&gt;l4_attn_stage12_gpu5 -->
<g id="edge1110" class="edge">
<title>l4_attn_stage11_gpu5&#45;&gt;l4_attn_stage12_gpu5</title>
<path fill="none" stroke="black" d="M2012,-1136.41C2012,-1117.69 2012,-1094.7 2012,-1074.72"/>
<polygon fill="black" stroke="black" points="2015.5,-1074.58 2012,-1064.58 2008.5,-1074.58 2015.5,-1074.58"/>
</g>
<!-- l4_attn_stage11_gpu5&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge2182" class="edge">
<title>l4_attn_stage11_gpu5&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2068.97,-1143.82C2083.9,-1137.52 2100.23,-1131.78 2116,-1128.5 2161.42,-1119.05 3742.22,-1133.84 3786,-1118.5 3796.15,-1114.94 3794.87,-1107.13 3805,-1103.5 3846.22,-1088.72 4156.1,-1104.25 4199,-1095.5 4244.27,-1086.27 4292.94,-1065.38 4326.18,-1049.27"/>
<polygon fill="red" stroke="red" points="4328.13,-1052.21 4335.56,-1044.66 4325.04,-1045.93 4328.13,-1052.21"/>
<text text-anchor="middle" x="3836.5" y="-1107.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu6 -->
<g id="node1175" class="node">
<title>l4_attn_stage12_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2220" cy="-1027" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2220" y="-1038.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="2220" y="-1023.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2220" y="-1008.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu6&#45;&gt;l4_attn_stage12_gpu6 -->
<g id="edge1111" class="edge">
<title>l4_attn_stage11_gpu6&#45;&gt;l4_attn_stage12_gpu6</title>
<path fill="none" stroke="black" d="M2220,-1136.41C2220,-1117.69 2220,-1094.7 2220,-1074.72"/>
<polygon fill="black" stroke="black" points="2223.5,-1074.58 2220,-1064.58 2216.5,-1074.58 2223.5,-1074.58"/>
</g>
<!-- l4_attn_stage11_gpu6&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge2183" class="edge">
<title>l4_attn_stage11_gpu6&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2276.97,-1143.82C2291.9,-1137.53 2308.23,-1131.78 2324,-1128.5 2366.1,-1119.73 3831.42,-1132.73 3872,-1118.5 3882.15,-1114.94 3880.88,-1107.16 3891,-1103.5 3923.19,-1091.85 4165.48,-1102.44 4199,-1095.5 4244.11,-1086.17 4292.62,-1065.4 4325.86,-1049.35"/>
<polygon fill="red" stroke="red" points="4327.8,-1052.3 4335.24,-1044.75 4324.72,-1046.01 4327.8,-1052.3"/>
<text text-anchor="middle" x="3922.5" y="-1107.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu7 -->
<g id="node1176" class="node">
<title>l4_attn_stage12_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2428" cy="-1027" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2428" y="-1038.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="2428" y="-1023.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2428" y="-1008.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu7&#45;&gt;l4_attn_stage12_gpu7 -->
<g id="edge1112" class="edge">
<title>l4_attn_stage11_gpu7&#45;&gt;l4_attn_stage12_gpu7</title>
<path fill="none" stroke="black" d="M2428,-1136.41C2428,-1117.69 2428,-1094.7 2428,-1074.72"/>
<polygon fill="black" stroke="black" points="2431.5,-1074.58 2428,-1064.58 2424.5,-1074.58 2431.5,-1074.58"/>
</g>
<!-- l4_attn_stage11_gpu7&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge2184" class="edge">
<title>l4_attn_stage11_gpu7&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2484.98,-1143.83C2499.9,-1137.54 2516.24,-1131.79 2532,-1128.5 2570.78,-1120.41 3920.62,-1131.62 3958,-1118.5 3968.15,-1114.94 3966.9,-1107.21 3977,-1103.5 4023.34,-1086.47 4150.71,-1105.74 4199,-1095.5 4244.06,-1085.94 4292.58,-1065.21 4325.83,-1049.23"/>
<polygon fill="red" stroke="red" points="4327.76,-1052.18 4335.22,-1044.65 4324.69,-1045.89 4327.76,-1052.18"/>
<text text-anchor="middle" x="4008.5" y="-1107.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu8 -->
<g id="node1177" class="node">
<title>l4_attn_stage12_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2636" cy="-1027" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2636" y="-1038.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="2636" y="-1023.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2636" y="-1008.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu8&#45;&gt;l4_attn_stage12_gpu8 -->
<g id="edge1113" class="edge">
<title>l4_attn_stage11_gpu8&#45;&gt;l4_attn_stage12_gpu8</title>
<path fill="none" stroke="black" d="M2636,-1136.41C2636,-1117.69 2636,-1094.7 2636,-1074.72"/>
<polygon fill="black" stroke="black" points="2639.5,-1074.58 2636,-1064.58 2632.5,-1074.58 2639.5,-1074.58"/>
</g>
<!-- l4_attn_stage11_gpu8&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge2185" class="edge">
<title>l4_attn_stage11_gpu8&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2692.98,-1143.84C2707.9,-1137.54 2724.24,-1131.79 2740,-1128.5 2810.91,-1113.68 3975.65,-1142.52 4044,-1118.5 4054.15,-1114.93 4052.94,-1107.33 4063,-1103.5 4091.3,-1092.73 4169.46,-1102.12 4199,-1095.5 4243.67,-1085.49 4291.88,-1065.03 4325.15,-1049.24"/>
<polygon fill="red" stroke="red" points="4327.06,-1052.21 4334.55,-1044.72 4324.02,-1045.9 4327.06,-1052.21"/>
<text text-anchor="middle" x="4094.5" y="-1107.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu9 -->
<g id="node1178" class="node">
<title>l4_attn_stage12_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2844" cy="-1027" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2844" y="-1038.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="2844" y="-1023.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2844" y="-1008.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu9&#45;&gt;l4_attn_stage12_gpu9 -->
<g id="edge1114" class="edge">
<title>l4_attn_stage11_gpu9&#45;&gt;l4_attn_stage12_gpu9</title>
<path fill="none" stroke="black" d="M2844,-1136.41C2844,-1117.69 2844,-1094.7 2844,-1074.72"/>
<polygon fill="black" stroke="black" points="2847.5,-1074.58 2844,-1064.58 2840.5,-1074.58 2847.5,-1074.58"/>
</g>
<!-- l4_attn_stage11_gpu9&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge2186" class="edge">
<title>l4_attn_stage11_gpu9&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2900.98,-1143.85C2915.9,-1137.55 2932.24,-1131.8 2948,-1128.5 3012.28,-1115.04 4068.05,-1140.3 4130,-1118.5 4140.15,-1114.93 4139.15,-1107.82 4149,-1103.5 4169.61,-1094.46 4177.31,-1101.51 4199,-1095.5 4242.28,-1083.5 4289.59,-1063.87 4322.94,-1048.86"/>
<polygon fill="red" stroke="red" points="4324.74,-1051.89 4332.4,-1044.56 4321.84,-1045.52 4324.74,-1051.89"/>
<text text-anchor="middle" x="4180.5" y="-1107.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu10 -->
<g id="node1179" class="node">
<title>l4_attn_stage12_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3052" cy="-1027" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3052" y="-1038.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="3052" y="-1023.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3052" y="-1008.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu10&#45;&gt;l4_attn_stage12_gpu10 -->
<g id="edge1115" class="edge">
<title>l4_attn_stage11_gpu10&#45;&gt;l4_attn_stage12_gpu10</title>
<path fill="none" stroke="black" d="M3052,-1136.41C3052,-1117.69 3052,-1094.7 3052,-1074.72"/>
<polygon fill="black" stroke="black" points="3055.5,-1074.58 3052,-1064.58 3048.5,-1074.58 3055.5,-1074.58"/>
</g>
<!-- l4_attn_stage11_gpu10&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge2187" class="edge">
<title>l4_attn_stage11_gpu10&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3108.98,-1143.86C3123.91,-1137.56 3140.24,-1131.81 3156,-1128.5 3213.64,-1116.4 4160.46,-1138.08 4216,-1118.5 4226.15,-1114.92 4226.08,-1109.52 4235,-1103.5 4264.36,-1083.68 4299.2,-1063.89 4325.72,-1049.55"/>
<polygon fill="red" stroke="red" points="4327.57,-1052.53 4334.73,-1044.71 4324.26,-1046.36 4327.57,-1052.53"/>
<text text-anchor="middle" x="4266.5" y="-1107.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu11 -->
<g id="node1180" class="node">
<title>l4_attn_stage12_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3260" cy="-1027" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3260" y="-1038.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="3260" y="-1023.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3260" y="-1008.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu11&#45;&gt;l4_attn_stage12_gpu11 -->
<g id="edge1116" class="edge">
<title>l4_attn_stage11_gpu11&#45;&gt;l4_attn_stage12_gpu11</title>
<path fill="none" stroke="black" d="M3260,-1136.41C3260,-1117.69 3260,-1094.7 3260,-1074.72"/>
<polygon fill="black" stroke="black" points="3263.5,-1074.58 3260,-1064.58 3256.5,-1074.58 3263.5,-1074.58"/>
</g>
<!-- l4_attn_stage11_gpu11&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge2188" class="edge">
<title>l4_attn_stage11_gpu11&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3316.98,-1143.87C3331.91,-1137.57 3348.24,-1131.82 3364,-1128.5 3389.5,-1123.13 4278.88,-1130.52 4302,-1118.5 4315.7,-1111.38 4337.58,-1077.96 4352.12,-1053.8"/>
<polygon fill="red" stroke="red" points="4355.21,-1055.46 4357.3,-1045.07 4349.19,-1051.88 4355.21,-1055.46"/>
<text text-anchor="middle" x="4348.5" y="-1107.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu12 -->
<g id="node1181" class="node">
<title>l4_attn_stage12_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3468" cy="-1027" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3468" y="-1038.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="3468" y="-1023.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3468" y="-1008.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu12&#45;&gt;l4_attn_stage12_gpu12 -->
<g id="edge1117" class="edge">
<title>l4_attn_stage11_gpu12&#45;&gt;l4_attn_stage12_gpu12</title>
<path fill="none" stroke="black" d="M3405.19,-1145.68C3391.64,-1139.91 3377.37,-1133.93 3364,-1128.5 3352.53,-1123.84 3345.01,-1128.71 3338,-1118.5 3334.23,-1113 3334.04,-1108.86 3338,-1103.5 3345.18,-1093.77 3353.05,-1100.62 3364,-1095.5 3381.44,-1087.35 3399.39,-1076.66 3415.36,-1066.19"/>
<polygon fill="black" stroke="black" points="3417.64,-1068.88 3424.02,-1060.42 3413.76,-1063.05 3417.64,-1068.88"/>
</g>
<!-- l4_attn_stage11_gpu12&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge2189" class="edge">
<title>l4_attn_stage11_gpu12&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3524.99,-1143.89C3539.91,-1137.59 3556.24,-1131.83 3572,-1128.5 3594.18,-1123.81 4372.07,-1134.63 4388,-1118.5 4404.71,-1101.58 4395.21,-1074.14 4384.15,-1053.9"/>
<polygon fill="red" stroke="red" points="4387.11,-1052.04 4379.04,-1045.17 4381.07,-1055.57 4387.11,-1052.04"/>
<text text-anchor="middle" x="4426.5" y="-1107.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu13 -->
<g id="node1182" class="node">
<title>l4_attn_stage12_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3676" cy="-1027" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3676" y="-1038.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="3676" y="-1023.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3676" y="-1008.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu13&#45;&gt;l4_attn_stage12_gpu13 -->
<g id="edge1118" class="edge">
<title>l4_attn_stage11_gpu13&#45;&gt;l4_attn_stage12_gpu13</title>
<path fill="none" stroke="black" d="M3618.39,-1144C3603.62,-1137.79 3587.51,-1132.04 3572,-1128.5 3547.39,-1122.89 3362.45,-1136.74 3345,-1118.5 3340.39,-1113.68 3340.37,-1108.3 3345,-1103.5 3353.76,-1094.42 3559.97,-1099.29 3572,-1095.5 3591.58,-1089.33 3611,-1078.38 3627.67,-1067.08"/>
<polygon fill="black" stroke="black" points="3629.94,-1069.77 3636.13,-1061.16 3625.93,-1064.03 3629.94,-1069.77"/>
</g>
<!-- l4_attn_stage11_gpu13&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge2190" class="edge">
<title>l4_attn_stage11_gpu13&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3732.99,-1143.91C3747.92,-1137.62 3764.25,-1131.85 3780,-1128.5 3798.86,-1124.49 4460.47,-1132.23 4474,-1118.5 4499.62,-1092.51 4458.49,-1065.91 4420.04,-1048.34"/>
<polygon fill="red" stroke="red" points="4421.44,-1045.13 4410.88,-1044.29 4418.61,-1051.53 4421.44,-1045.13"/>
<text text-anchor="middle" x="4512.5" y="-1107.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu14 -->
<g id="node1183" class="node">
<title>l4_attn_stage12_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3884" cy="-1027" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3884" y="-1038.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="3884" y="-1023.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3884" y="-1008.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu14&#45;&gt;l4_attn_stage12_gpu14 -->
<g id="edge1119" class="edge">
<title>l4_attn_stage11_gpu14&#45;&gt;l4_attn_stage12_gpu14</title>
<path fill="none" stroke="black" d="M3826.71,-1143.89C3811.86,-1137.64 3795.64,-1131.9 3780,-1128.5 3756.76,-1123.45 3368.62,-1135.51 3352,-1118.5 3347.34,-1113.73 3347.33,-1108.26 3352,-1103.5 3360.33,-1095.01 3768.63,-1098.98 3780,-1095.5 3799.63,-1089.49 3819.07,-1078.59 3835.73,-1067.27"/>
<polygon fill="black" stroke="black" points="3838.01,-1069.95 3844.18,-1061.34 3833.99,-1064.22 3838.01,-1069.95"/>
</g>
<!-- l4_attn_stage11_gpu14&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge2191" class="edge">
<title>l4_attn_stage11_gpu14&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3941,-1143.94C3955.92,-1137.65 3972.25,-1131.87 3988,-1128.5 4003.54,-1125.17 4548.86,-1129.83 4560,-1118.5 4596.88,-1080.96 4533.24,-1057.2 4469.37,-1043.5"/>
<polygon fill="red" stroke="red" points="4470.05,-1040.06 4459.55,-1041.47 4468.63,-1046.92 4470.05,-1040.06"/>
<text text-anchor="middle" x="4599.5" y="-1107.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage12_gpu15 -->
<g id="node1184" class="node">
<title>l4_attn_stage12_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4092" cy="-1027" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4092" y="-1038.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage12</text>
<text text-anchor="middle" x="4092" y="-1023.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4092" y="-1008.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage11_gpu15&#45;&gt;l4_attn_stage12_gpu15 -->
<g id="edge1120" class="edge">
<title>l4_attn_stage11_gpu15&#45;&gt;l4_attn_stage12_gpu15</title>
<path fill="none" stroke="black" d="M4035,-1143.93C4020.08,-1137.63 4003.75,-1131.86 3988,-1128.5 3970.91,-1124.86 3371.26,-1130.95 3359,-1118.5 3354.32,-1113.75 3354.32,-1108.24 3359,-1103.5 3371.28,-1091.07 3971.28,-1100.57 3988,-1095.5 4007.65,-1089.55 4027.09,-1078.66 4043.75,-1067.34"/>
<polygon fill="black" stroke="black" points="4046.03,-1070.02 4052.2,-1061.41 4042.01,-1064.29 4046.03,-1070.02"/>
</g>
<!-- l4_attn_stage11_gpu15&#45;&gt;l4_attn_stage12_gpu[next_gpu] -->
<g id="edge2192" class="edge">
<title>l4_attn_stage11_gpu15&#45;&gt;l4_attn_stage12_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4151.56,-1144.58C4167.88,-1138.06 4185.81,-1132.02 4203,-1128.5 4227.12,-1123.56 4628.79,-1136.1 4646,-1118.5 4695.67,-1067.7 4608.33,-1045.39 4518.57,-1035.61"/>
<polygon fill="red" stroke="red" points="4518.78,-1032.11 4508.47,-1034.56 4518.05,-1039.07 4518.78,-1032.11"/>
<text text-anchor="middle" x="4685.5" y="-1107.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu0 -->
<g id="node1185" class="node">
<title>l4_attn_stage13_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="972" cy="-880" rx="95" ry="37.5"/>
<text text-anchor="middle" x="972" y="-891.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="972" y="-876.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="972" y="-861.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu0&#45;&gt;l4_attn_stage13_gpu0 -->
<g id="edge1121" class="edge">
<title>l4_attn_stage12_gpu0&#45;&gt;l4_attn_stage13_gpu0</title>
<path fill="none" stroke="black" d="M972,-989.41C972,-970.69 972,-947.7 972,-927.72"/>
<polygon fill="black" stroke="black" points="975.5,-927.58 972,-917.58 968.5,-927.58 975.5,-927.58"/>
</g>
<!-- l4_attn_stage13_gpu[next_gpu] -->
<g id="node1370" class="node">
<title>l4_attn_stage13_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4367" cy="-880" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4367" y="-876.3" font-family="Times,serif" font-size="14.00">l4_attn_stage13_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage12_gpu0&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge2193" class="edge">
<title>l4_attn_stage12_gpu0&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1028.98,-996.87C1043.91,-990.58 1060.24,-984.82 1076,-981.5 1325.97,-928.85 3119.55,-959.13 3375,-956.5 3420.78,-956.03 4154.1,-957.41 4199,-948.5 4244.32,-939.51 4292.98,-918.59 4326.21,-902.4"/>
<polygon fill="red" stroke="red" points="4328.17,-905.34 4335.58,-897.76 4325.06,-899.06 4328.17,-905.34"/>
<text text-anchor="middle" x="3406.5" y="-960.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu1 -->
<g id="node1186" class="node">
<title>l4_attn_stage13_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1180" cy="-880" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1180" y="-891.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="1180" y="-876.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1180" y="-861.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu1&#45;&gt;l4_attn_stage13_gpu1 -->
<g id="edge1122" class="edge">
<title>l4_attn_stage12_gpu1&#45;&gt;l4_attn_stage13_gpu1</title>
<path fill="none" stroke="black" d="M1180,-989.41C1180,-970.69 1180,-947.7 1180,-927.72"/>
<polygon fill="black" stroke="black" points="1183.5,-927.58 1180,-917.58 1176.5,-927.58 1183.5,-927.58"/>
</g>
<!-- l4_attn_stage12_gpu1&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge2194" class="edge">
<title>l4_attn_stage12_gpu1&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1236.97,-996.8C1251.89,-990.51 1268.23,-984.77 1284,-981.5 1342.7,-969.33 3385.42,-991.29 3442,-971.5 3452.16,-967.95 3450.86,-960.08 3461,-956.5 3499.66,-942.84 4158.79,-956.5 4199,-948.5 4244.31,-939.48 4292.98,-918.57 4326.21,-902.39"/>
<polygon fill="red" stroke="red" points="4328.17,-905.32 4335.58,-897.75 4325.06,-899.05 4328.17,-905.32"/>
<text text-anchor="middle" x="3492.5" y="-960.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu2 -->
<g id="node1187" class="node">
<title>l4_attn_stage13_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1388" cy="-880" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1388" y="-891.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="1388" y="-876.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1388" y="-861.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu2&#45;&gt;l4_attn_stage13_gpu2 -->
<g id="edge1123" class="edge">
<title>l4_attn_stage12_gpu2&#45;&gt;l4_attn_stage13_gpu2</title>
<path fill="none" stroke="black" d="M1388,-989.41C1388,-970.69 1388,-947.7 1388,-927.72"/>
<polygon fill="black" stroke="black" points="1391.5,-927.58 1388,-917.58 1384.5,-927.58 1391.5,-927.58"/>
</g>
<!-- l4_attn_stage12_gpu2&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge2195" class="edge">
<title>l4_attn_stage12_gpu2&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1444.97,-996.81C1459.89,-990.51 1476.23,-984.77 1492,-981.5 1547.38,-970.01 3474.62,-990.18 3528,-971.5 3538.16,-967.95 3536.86,-960.09 3547,-956.5 3581.15,-944.41 4163.48,-955.6 4199,-948.5 4244.31,-939.45 4292.97,-918.54 4326.2,-902.37"/>
<polygon fill="red" stroke="red" points="4328.16,-905.31 4335.57,-897.74 4325.06,-899.03 4328.16,-905.31"/>
<text text-anchor="middle" x="3578.5" y="-960.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu3 -->
<g id="node1188" class="node">
<title>l4_attn_stage13_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1596" cy="-880" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1596" y="-891.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="1596" y="-876.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1596" y="-861.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu3&#45;&gt;l4_attn_stage13_gpu3 -->
<g id="edge1124" class="edge">
<title>l4_attn_stage12_gpu3&#45;&gt;l4_attn_stage13_gpu3</title>
<path fill="none" stroke="black" d="M1596,-989.41C1596,-970.69 1596,-947.7 1596,-927.72"/>
<polygon fill="black" stroke="black" points="1599.5,-927.58 1596,-917.58 1592.5,-927.58 1599.5,-927.58"/>
</g>
<!-- l4_attn_stage12_gpu3&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge2196" class="edge">
<title>l4_attn_stage12_gpu3&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1652.97,-996.81C1667.9,-990.52 1684.23,-984.77 1700,-981.5 1752.06,-970.69 3563.82,-989.07 3614,-971.5 3624.15,-967.94 3622.86,-960.1 3633,-956.5 3662.63,-945.98 4168.17,-954.69 4199,-948.5 4244.3,-939.41 4292.97,-918.5 4326.2,-902.35"/>
<polygon fill="red" stroke="red" points="4328.15,-905.29 4335.57,-897.72 4325.05,-899.01 4328.15,-905.29"/>
<text text-anchor="middle" x="3664.5" y="-960.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu4 -->
<g id="node1189" class="node">
<title>l4_attn_stage13_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1804" cy="-880" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1804" y="-891.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="1804" y="-876.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1804" y="-861.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu4&#45;&gt;l4_attn_stage13_gpu4 -->
<g id="edge1125" class="edge">
<title>l4_attn_stage12_gpu4&#45;&gt;l4_attn_stage13_gpu4</title>
<path fill="none" stroke="black" d="M1804,-989.41C1804,-970.69 1804,-947.7 1804,-927.72"/>
<polygon fill="black" stroke="black" points="1807.5,-927.58 1804,-917.58 1800.5,-927.58 1807.5,-927.58"/>
</g>
<!-- l4_attn_stage12_gpu4&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge2197" class="edge">
<title>l4_attn_stage12_gpu4&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1860.97,-996.81C1875.9,-990.52 1892.23,-984.78 1908,-981.5 1956.74,-971.37 3653.02,-987.96 3700,-971.5 3710.15,-967.94 3708.87,-960.11 3719,-956.5 3769.24,-938.59 4146.72,-959.06 4199,-948.5 4244.29,-939.35 4292.96,-918.45 4326.19,-902.32"/>
<polygon fill="red" stroke="red" points="4328.14,-905.26 4335.56,-897.69 4325.05,-898.98 4328.14,-905.26"/>
<text text-anchor="middle" x="3750.5" y="-960.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu5 -->
<g id="node1190" class="node">
<title>l4_attn_stage13_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2012" cy="-880" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2012" y="-891.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="2012" y="-876.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2012" y="-861.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu5&#45;&gt;l4_attn_stage13_gpu5 -->
<g id="edge1126" class="edge">
<title>l4_attn_stage12_gpu5&#45;&gt;l4_attn_stage13_gpu5</title>
<path fill="none" stroke="black" d="M2012,-989.41C2012,-970.69 2012,-947.7 2012,-927.72"/>
<polygon fill="black" stroke="black" points="2015.5,-927.58 2012,-917.58 2008.5,-927.58 2015.5,-927.58"/>
</g>
<!-- l4_attn_stage12_gpu5&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge2198" class="edge">
<title>l4_attn_stage12_gpu5&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2068.97,-996.82C2083.9,-990.52 2100.23,-984.78 2116,-981.5 2161.42,-972.05 3742.22,-986.84 3786,-971.5 3796.15,-967.94 3794.87,-960.13 3805,-956.5 3846.22,-941.72 4156.1,-957.25 4199,-948.5 4244.27,-939.27 4292.94,-918.38 4326.18,-902.27"/>
<polygon fill="red" stroke="red" points="4328.13,-905.21 4335.56,-897.66 4325.04,-898.93 4328.13,-905.21"/>
<text text-anchor="middle" x="3836.5" y="-960.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu6 -->
<g id="node1191" class="node">
<title>l4_attn_stage13_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2220" cy="-880" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2220" y="-891.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="2220" y="-876.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2220" y="-861.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu6&#45;&gt;l4_attn_stage13_gpu6 -->
<g id="edge1127" class="edge">
<title>l4_attn_stage12_gpu6&#45;&gt;l4_attn_stage13_gpu6</title>
<path fill="none" stroke="black" d="M2220,-989.41C2220,-970.69 2220,-947.7 2220,-927.72"/>
<polygon fill="black" stroke="black" points="2223.5,-927.58 2220,-917.58 2216.5,-927.58 2223.5,-927.58"/>
</g>
<!-- l4_attn_stage12_gpu6&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge2199" class="edge">
<title>l4_attn_stage12_gpu6&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2276.97,-996.82C2291.9,-990.53 2308.23,-984.78 2324,-981.5 2366.1,-972.73 3831.42,-985.73 3872,-971.5 3882.15,-967.94 3880.88,-960.16 3891,-956.5 3923.19,-944.85 4165.48,-955.44 4199,-948.5 4244.11,-939.17 4292.62,-918.4 4325.86,-902.35"/>
<polygon fill="red" stroke="red" points="4327.8,-905.3 4335.24,-897.75 4324.72,-899.01 4327.8,-905.3"/>
<text text-anchor="middle" x="3922.5" y="-960.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu7 -->
<g id="node1192" class="node">
<title>l4_attn_stage13_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2428" cy="-880" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2428" y="-891.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="2428" y="-876.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2428" y="-861.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu7&#45;&gt;l4_attn_stage13_gpu7 -->
<g id="edge1128" class="edge">
<title>l4_attn_stage12_gpu7&#45;&gt;l4_attn_stage13_gpu7</title>
<path fill="none" stroke="black" d="M2428,-989.41C2428,-970.69 2428,-947.7 2428,-927.72"/>
<polygon fill="black" stroke="black" points="2431.5,-927.58 2428,-917.58 2424.5,-927.58 2431.5,-927.58"/>
</g>
<!-- l4_attn_stage12_gpu7&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge2200" class="edge">
<title>l4_attn_stage12_gpu7&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2484.98,-996.83C2499.9,-990.54 2516.24,-984.79 2532,-981.5 2570.78,-973.41 3920.62,-984.62 3958,-971.5 3968.15,-967.94 3966.9,-960.21 3977,-956.5 4023.34,-939.47 4150.71,-958.74 4199,-948.5 4244.06,-938.94 4292.58,-918.21 4325.83,-902.23"/>
<polygon fill="red" stroke="red" points="4327.76,-905.18 4335.22,-897.65 4324.69,-898.89 4327.76,-905.18"/>
<text text-anchor="middle" x="4008.5" y="-960.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu8 -->
<g id="node1193" class="node">
<title>l4_attn_stage13_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2636" cy="-880" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2636" y="-891.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="2636" y="-876.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2636" y="-861.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu8&#45;&gt;l4_attn_stage13_gpu8 -->
<g id="edge1129" class="edge">
<title>l4_attn_stage12_gpu8&#45;&gt;l4_attn_stage13_gpu8</title>
<path fill="none" stroke="black" d="M2636,-989.41C2636,-970.69 2636,-947.7 2636,-927.72"/>
<polygon fill="black" stroke="black" points="2639.5,-927.58 2636,-917.58 2632.5,-927.58 2639.5,-927.58"/>
</g>
<!-- l4_attn_stage12_gpu8&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge2201" class="edge">
<title>l4_attn_stage12_gpu8&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2692.98,-996.84C2707.9,-990.54 2724.24,-984.79 2740,-981.5 2810.91,-966.68 3975.65,-995.52 4044,-971.5 4054.15,-967.93 4052.94,-960.33 4063,-956.5 4091.3,-945.73 4169.46,-955.12 4199,-948.5 4243.67,-938.49 4291.88,-918.03 4325.15,-902.24"/>
<polygon fill="red" stroke="red" points="4327.06,-905.21 4334.55,-897.72 4324.02,-898.9 4327.06,-905.21"/>
<text text-anchor="middle" x="4094.5" y="-960.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu9 -->
<g id="node1194" class="node">
<title>l4_attn_stage13_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2844" cy="-880" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2844" y="-891.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="2844" y="-876.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2844" y="-861.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu9&#45;&gt;l4_attn_stage13_gpu9 -->
<g id="edge1130" class="edge">
<title>l4_attn_stage12_gpu9&#45;&gt;l4_attn_stage13_gpu9</title>
<path fill="none" stroke="black" d="M2844,-989.41C2844,-970.69 2844,-947.7 2844,-927.72"/>
<polygon fill="black" stroke="black" points="2847.5,-927.58 2844,-917.58 2840.5,-927.58 2847.5,-927.58"/>
</g>
<!-- l4_attn_stage12_gpu9&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge2202" class="edge">
<title>l4_attn_stage12_gpu9&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2900.98,-996.85C2915.9,-990.55 2932.24,-984.8 2948,-981.5 3012.28,-968.04 4068.05,-993.3 4130,-971.5 4140.15,-967.93 4139.15,-960.82 4149,-956.5 4169.61,-947.46 4177.31,-954.51 4199,-948.5 4242.28,-936.5 4289.59,-916.87 4322.94,-901.86"/>
<polygon fill="red" stroke="red" points="4324.74,-904.89 4332.4,-897.56 4321.84,-898.52 4324.74,-904.89"/>
<text text-anchor="middle" x="4180.5" y="-960.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu10 -->
<g id="node1195" class="node">
<title>l4_attn_stage13_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3052" cy="-880" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3052" y="-891.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="3052" y="-876.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3052" y="-861.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu10&#45;&gt;l4_attn_stage13_gpu10 -->
<g id="edge1131" class="edge">
<title>l4_attn_stage12_gpu10&#45;&gt;l4_attn_stage13_gpu10</title>
<path fill="none" stroke="black" d="M3052,-989.41C3052,-970.69 3052,-947.7 3052,-927.72"/>
<polygon fill="black" stroke="black" points="3055.5,-927.58 3052,-917.58 3048.5,-927.58 3055.5,-927.58"/>
</g>
<!-- l4_attn_stage12_gpu10&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge2203" class="edge">
<title>l4_attn_stage12_gpu10&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3108.98,-996.86C3123.91,-990.56 3140.24,-984.81 3156,-981.5 3213.64,-969.4 4160.46,-991.08 4216,-971.5 4226.15,-967.92 4226.08,-962.52 4235,-956.5 4264.36,-936.68 4299.2,-916.89 4325.72,-902.55"/>
<polygon fill="red" stroke="red" points="4327.57,-905.53 4334.73,-897.71 4324.26,-899.36 4327.57,-905.53"/>
<text text-anchor="middle" x="4266.5" y="-960.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu11 -->
<g id="node1196" class="node">
<title>l4_attn_stage13_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3260" cy="-880" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3260" y="-891.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="3260" y="-876.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3260" y="-861.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu11&#45;&gt;l4_attn_stage13_gpu11 -->
<g id="edge1132" class="edge">
<title>l4_attn_stage12_gpu11&#45;&gt;l4_attn_stage13_gpu11</title>
<path fill="none" stroke="black" d="M3260,-989.41C3260,-970.69 3260,-947.7 3260,-927.72"/>
<polygon fill="black" stroke="black" points="3263.5,-927.58 3260,-917.58 3256.5,-927.58 3263.5,-927.58"/>
</g>
<!-- l4_attn_stage12_gpu11&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge2204" class="edge">
<title>l4_attn_stage12_gpu11&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3316.98,-996.87C3331.91,-990.57 3348.24,-984.82 3364,-981.5 3389.5,-976.13 4278.88,-983.52 4302,-971.5 4315.7,-964.38 4337.58,-930.96 4352.12,-906.8"/>
<polygon fill="red" stroke="red" points="4355.21,-908.46 4357.3,-898.07 4349.19,-904.88 4355.21,-908.46"/>
<text text-anchor="middle" x="4348.5" y="-960.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu12 -->
<g id="node1197" class="node">
<title>l4_attn_stage13_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3468" cy="-880" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3468" y="-891.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="3468" y="-876.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3468" y="-861.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu12&#45;&gt;l4_attn_stage13_gpu12 -->
<g id="edge1133" class="edge">
<title>l4_attn_stage12_gpu12&#45;&gt;l4_attn_stage13_gpu12</title>
<path fill="none" stroke="black" d="M3405.19,-998.68C3391.64,-992.91 3377.37,-986.93 3364,-981.5 3352.53,-976.84 3345.01,-981.71 3338,-971.5 3334.23,-966 3334.04,-961.86 3338,-956.5 3345.18,-946.77 3353.05,-953.62 3364,-948.5 3381.44,-940.35 3399.39,-929.66 3415.36,-919.19"/>
<polygon fill="black" stroke="black" points="3417.64,-921.88 3424.02,-913.42 3413.76,-916.05 3417.64,-921.88"/>
</g>
<!-- l4_attn_stage12_gpu12&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge2205" class="edge">
<title>l4_attn_stage12_gpu12&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3524.99,-996.89C3539.91,-990.59 3556.24,-984.83 3572,-981.5 3594.18,-976.81 4372.07,-987.63 4388,-971.5 4404.71,-954.58 4395.21,-927.14 4384.15,-906.9"/>
<polygon fill="red" stroke="red" points="4387.11,-905.04 4379.04,-898.17 4381.07,-908.57 4387.11,-905.04"/>
<text text-anchor="middle" x="4426.5" y="-960.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu13 -->
<g id="node1198" class="node">
<title>l4_attn_stage13_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3676" cy="-880" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3676" y="-891.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="3676" y="-876.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3676" y="-861.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu13&#45;&gt;l4_attn_stage13_gpu13 -->
<g id="edge1134" class="edge">
<title>l4_attn_stage12_gpu13&#45;&gt;l4_attn_stage13_gpu13</title>
<path fill="none" stroke="black" d="M3618.39,-997C3603.62,-990.79 3587.51,-985.04 3572,-981.5 3547.39,-975.89 3362.45,-989.74 3345,-971.5 3340.39,-966.68 3340.37,-961.3 3345,-956.5 3353.76,-947.42 3559.97,-952.29 3572,-948.5 3591.58,-942.33 3611,-931.38 3627.67,-920.08"/>
<polygon fill="black" stroke="black" points="3629.94,-922.77 3636.13,-914.16 3625.93,-917.03 3629.94,-922.77"/>
</g>
<!-- l4_attn_stage12_gpu13&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge2206" class="edge">
<title>l4_attn_stage12_gpu13&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3732.99,-996.91C3747.92,-990.62 3764.25,-984.85 3780,-981.5 3798.86,-977.49 4460.47,-985.23 4474,-971.5 4499.62,-945.51 4458.49,-918.91 4420.04,-901.34"/>
<polygon fill="red" stroke="red" points="4421.44,-898.13 4410.88,-897.29 4418.61,-904.53 4421.44,-898.13"/>
<text text-anchor="middle" x="4512.5" y="-960.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu14 -->
<g id="node1199" class="node">
<title>l4_attn_stage13_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3884" cy="-880" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3884" y="-891.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="3884" y="-876.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3884" y="-861.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu14&#45;&gt;l4_attn_stage13_gpu14 -->
<g id="edge1135" class="edge">
<title>l4_attn_stage12_gpu14&#45;&gt;l4_attn_stage13_gpu14</title>
<path fill="none" stroke="black" d="M3826.71,-996.89C3811.86,-990.64 3795.64,-984.9 3780,-981.5 3756.76,-976.45 3368.62,-988.51 3352,-971.5 3347.34,-966.73 3347.33,-961.26 3352,-956.5 3360.33,-948.01 3768.63,-951.98 3780,-948.5 3799.63,-942.49 3819.07,-931.59 3835.73,-920.27"/>
<polygon fill="black" stroke="black" points="3838.01,-922.95 3844.18,-914.34 3833.99,-917.22 3838.01,-922.95"/>
</g>
<!-- l4_attn_stage12_gpu14&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge2207" class="edge">
<title>l4_attn_stage12_gpu14&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3941,-996.94C3955.92,-990.65 3972.25,-984.87 3988,-981.5 4003.54,-978.17 4548.86,-982.83 4560,-971.5 4596.88,-933.96 4533.24,-910.2 4469.37,-896.5"/>
<polygon fill="red" stroke="red" points="4470.05,-893.06 4459.55,-894.47 4468.63,-899.92 4470.05,-893.06"/>
<text text-anchor="middle" x="4599.5" y="-960.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage13_gpu15 -->
<g id="node1200" class="node">
<title>l4_attn_stage13_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4092" cy="-880" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4092" y="-891.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage13</text>
<text text-anchor="middle" x="4092" y="-876.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4092" y="-861.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage12_gpu15&#45;&gt;l4_attn_stage13_gpu15 -->
<g id="edge1136" class="edge">
<title>l4_attn_stage12_gpu15&#45;&gt;l4_attn_stage13_gpu15</title>
<path fill="none" stroke="black" d="M4035,-996.93C4020.08,-990.63 4003.75,-984.86 3988,-981.5 3970.91,-977.86 3371.26,-983.95 3359,-971.5 3354.32,-966.75 3354.32,-961.24 3359,-956.5 3371.28,-944.07 3971.28,-953.57 3988,-948.5 4007.65,-942.55 4027.09,-931.66 4043.75,-920.34"/>
<polygon fill="black" stroke="black" points="4046.03,-923.02 4052.2,-914.41 4042.01,-917.29 4046.03,-923.02"/>
</g>
<!-- l4_attn_stage12_gpu15&#45;&gt;l4_attn_stage13_gpu[next_gpu] -->
<g id="edge2208" class="edge">
<title>l4_attn_stage12_gpu15&#45;&gt;l4_attn_stage13_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4151.56,-997.58C4167.88,-991.06 4185.81,-985.02 4203,-981.5 4227.12,-976.56 4628.79,-989.1 4646,-971.5 4695.67,-920.7 4608.33,-898.39 4518.57,-888.61"/>
<polygon fill="red" stroke="red" points="4518.78,-885.11 4508.47,-887.56 4518.05,-892.07 4518.78,-885.11"/>
<text text-anchor="middle" x="4685.5" y="-960.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu0 -->
<g id="node1201" class="node">
<title>l4_attn_stage14_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="972" cy="-733" rx="95" ry="37.5"/>
<text text-anchor="middle" x="972" y="-744.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="972" y="-729.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="972" y="-714.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu0&#45;&gt;l4_attn_stage14_gpu0 -->
<g id="edge1137" class="edge">
<title>l4_attn_stage13_gpu0&#45;&gt;l4_attn_stage14_gpu0</title>
<path fill="none" stroke="black" d="M972,-842.41C972,-823.69 972,-800.7 972,-780.72"/>
<polygon fill="black" stroke="black" points="975.5,-780.58 972,-770.58 968.5,-780.58 975.5,-780.58"/>
</g>
<!-- l4_attn_stage14_gpu[next_gpu] -->
<g id="node1371" class="node">
<title>l4_attn_stage14_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4367" cy="-733" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4367" y="-729.3" font-family="Times,serif" font-size="14.00">l4_attn_stage14_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage13_gpu0&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge2209" class="edge">
<title>l4_attn_stage13_gpu0&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1028.98,-849.87C1043.91,-843.58 1060.24,-837.82 1076,-834.5 1325.97,-781.85 3119.55,-812.13 3375,-809.5 3420.78,-809.03 4154.1,-810.41 4199,-801.5 4244.32,-792.51 4292.98,-771.59 4326.21,-755.4"/>
<polygon fill="red" stroke="red" points="4328.17,-758.34 4335.58,-750.76 4325.06,-752.06 4328.17,-758.34"/>
<text text-anchor="middle" x="3406.5" y="-813.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu1 -->
<g id="node1202" class="node">
<title>l4_attn_stage14_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1180" cy="-733" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1180" y="-744.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="1180" y="-729.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1180" y="-714.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu1&#45;&gt;l4_attn_stage14_gpu1 -->
<g id="edge1138" class="edge">
<title>l4_attn_stage13_gpu1&#45;&gt;l4_attn_stage14_gpu1</title>
<path fill="none" stroke="black" d="M1180,-842.41C1180,-823.69 1180,-800.7 1180,-780.72"/>
<polygon fill="black" stroke="black" points="1183.5,-780.58 1180,-770.58 1176.5,-780.58 1183.5,-780.58"/>
</g>
<!-- l4_attn_stage13_gpu1&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge2210" class="edge">
<title>l4_attn_stage13_gpu1&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1236.97,-849.8C1251.89,-843.51 1268.23,-837.77 1284,-834.5 1342.7,-822.33 3385.42,-844.29 3442,-824.5 3452.16,-820.95 3450.86,-813.08 3461,-809.5 3499.66,-795.84 4158.79,-809.5 4199,-801.5 4244.31,-792.48 4292.98,-771.57 4326.21,-755.39"/>
<polygon fill="red" stroke="red" points="4328.17,-758.32 4335.58,-750.75 4325.06,-752.05 4328.17,-758.32"/>
<text text-anchor="middle" x="3492.5" y="-813.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu2 -->
<g id="node1203" class="node">
<title>l4_attn_stage14_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1388" cy="-733" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1388" y="-744.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="1388" y="-729.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1388" y="-714.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu2&#45;&gt;l4_attn_stage14_gpu2 -->
<g id="edge1139" class="edge">
<title>l4_attn_stage13_gpu2&#45;&gt;l4_attn_stage14_gpu2</title>
<path fill="none" stroke="black" d="M1388,-842.41C1388,-823.69 1388,-800.7 1388,-780.72"/>
<polygon fill="black" stroke="black" points="1391.5,-780.58 1388,-770.58 1384.5,-780.58 1391.5,-780.58"/>
</g>
<!-- l4_attn_stage13_gpu2&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge2211" class="edge">
<title>l4_attn_stage13_gpu2&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1444.97,-849.81C1459.89,-843.51 1476.23,-837.77 1492,-834.5 1547.38,-823.01 3474.62,-843.18 3528,-824.5 3538.16,-820.95 3536.86,-813.09 3547,-809.5 3581.15,-797.41 4163.48,-808.6 4199,-801.5 4244.31,-792.45 4292.97,-771.54 4326.2,-755.37"/>
<polygon fill="red" stroke="red" points="4328.16,-758.31 4335.57,-750.74 4325.06,-752.03 4328.16,-758.31"/>
<text text-anchor="middle" x="3578.5" y="-813.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu3 -->
<g id="node1204" class="node">
<title>l4_attn_stage14_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1596" cy="-733" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1596" y="-744.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="1596" y="-729.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1596" y="-714.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu3&#45;&gt;l4_attn_stage14_gpu3 -->
<g id="edge1140" class="edge">
<title>l4_attn_stage13_gpu3&#45;&gt;l4_attn_stage14_gpu3</title>
<path fill="none" stroke="black" d="M1596,-842.41C1596,-823.69 1596,-800.7 1596,-780.72"/>
<polygon fill="black" stroke="black" points="1599.5,-780.58 1596,-770.58 1592.5,-780.58 1599.5,-780.58"/>
</g>
<!-- l4_attn_stage13_gpu3&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge2212" class="edge">
<title>l4_attn_stage13_gpu3&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1652.97,-849.81C1667.9,-843.52 1684.23,-837.77 1700,-834.5 1752.06,-823.69 3563.82,-842.07 3614,-824.5 3624.15,-820.94 3622.86,-813.1 3633,-809.5 3662.63,-798.98 4168.17,-807.69 4199,-801.5 4244.3,-792.41 4292.97,-771.5 4326.2,-755.35"/>
<polygon fill="red" stroke="red" points="4328.15,-758.29 4335.57,-750.72 4325.05,-752.01 4328.15,-758.29"/>
<text text-anchor="middle" x="3664.5" y="-813.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu4 -->
<g id="node1205" class="node">
<title>l4_attn_stage14_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1804" cy="-733" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1804" y="-744.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="1804" y="-729.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1804" y="-714.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu4&#45;&gt;l4_attn_stage14_gpu4 -->
<g id="edge1141" class="edge">
<title>l4_attn_stage13_gpu4&#45;&gt;l4_attn_stage14_gpu4</title>
<path fill="none" stroke="black" d="M1804,-842.41C1804,-823.69 1804,-800.7 1804,-780.72"/>
<polygon fill="black" stroke="black" points="1807.5,-780.58 1804,-770.58 1800.5,-780.58 1807.5,-780.58"/>
</g>
<!-- l4_attn_stage13_gpu4&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge2213" class="edge">
<title>l4_attn_stage13_gpu4&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1860.97,-849.81C1875.9,-843.52 1892.23,-837.78 1908,-834.5 1956.74,-824.37 3653.02,-840.96 3700,-824.5 3710.15,-820.94 3708.87,-813.11 3719,-809.5 3769.24,-791.59 4146.72,-812.06 4199,-801.5 4244.29,-792.35 4292.96,-771.45 4326.19,-755.32"/>
<polygon fill="red" stroke="red" points="4328.14,-758.26 4335.56,-750.69 4325.05,-751.98 4328.14,-758.26"/>
<text text-anchor="middle" x="3750.5" y="-813.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu5 -->
<g id="node1206" class="node">
<title>l4_attn_stage14_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2012" cy="-733" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2012" y="-744.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="2012" y="-729.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2012" y="-714.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu5&#45;&gt;l4_attn_stage14_gpu5 -->
<g id="edge1142" class="edge">
<title>l4_attn_stage13_gpu5&#45;&gt;l4_attn_stage14_gpu5</title>
<path fill="none" stroke="black" d="M2012,-842.41C2012,-823.69 2012,-800.7 2012,-780.72"/>
<polygon fill="black" stroke="black" points="2015.5,-780.58 2012,-770.58 2008.5,-780.58 2015.5,-780.58"/>
</g>
<!-- l4_attn_stage13_gpu5&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge2214" class="edge">
<title>l4_attn_stage13_gpu5&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2068.97,-849.82C2083.9,-843.52 2100.23,-837.78 2116,-834.5 2161.42,-825.05 3742.22,-839.84 3786,-824.5 3796.15,-820.94 3794.87,-813.13 3805,-809.5 3846.22,-794.72 4156.1,-810.25 4199,-801.5 4244.27,-792.27 4292.94,-771.38 4326.18,-755.27"/>
<polygon fill="red" stroke="red" points="4328.13,-758.21 4335.56,-750.66 4325.04,-751.93 4328.13,-758.21"/>
<text text-anchor="middle" x="3836.5" y="-813.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu6 -->
<g id="node1207" class="node">
<title>l4_attn_stage14_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2220" cy="-733" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2220" y="-744.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="2220" y="-729.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2220" y="-714.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu6&#45;&gt;l4_attn_stage14_gpu6 -->
<g id="edge1143" class="edge">
<title>l4_attn_stage13_gpu6&#45;&gt;l4_attn_stage14_gpu6</title>
<path fill="none" stroke="black" d="M2220,-842.41C2220,-823.69 2220,-800.7 2220,-780.72"/>
<polygon fill="black" stroke="black" points="2223.5,-780.58 2220,-770.58 2216.5,-780.58 2223.5,-780.58"/>
</g>
<!-- l4_attn_stage13_gpu6&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge2215" class="edge">
<title>l4_attn_stage13_gpu6&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2276.97,-849.82C2291.9,-843.53 2308.23,-837.78 2324,-834.5 2366.1,-825.73 3831.42,-838.73 3872,-824.5 3882.15,-820.94 3880.88,-813.16 3891,-809.5 3923.19,-797.85 4165.48,-808.44 4199,-801.5 4244.11,-792.17 4292.62,-771.4 4325.86,-755.35"/>
<polygon fill="red" stroke="red" points="4327.8,-758.3 4335.24,-750.75 4324.72,-752.01 4327.8,-758.3"/>
<text text-anchor="middle" x="3922.5" y="-813.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu7 -->
<g id="node1208" class="node">
<title>l4_attn_stage14_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2428" cy="-733" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2428" y="-744.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="2428" y="-729.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2428" y="-714.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu7&#45;&gt;l4_attn_stage14_gpu7 -->
<g id="edge1144" class="edge">
<title>l4_attn_stage13_gpu7&#45;&gt;l4_attn_stage14_gpu7</title>
<path fill="none" stroke="black" d="M2428,-842.41C2428,-823.69 2428,-800.7 2428,-780.72"/>
<polygon fill="black" stroke="black" points="2431.5,-780.58 2428,-770.58 2424.5,-780.58 2431.5,-780.58"/>
</g>
<!-- l4_attn_stage13_gpu7&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge2216" class="edge">
<title>l4_attn_stage13_gpu7&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2484.98,-849.83C2499.9,-843.54 2516.24,-837.79 2532,-834.5 2570.78,-826.41 3920.62,-837.62 3958,-824.5 3968.15,-820.94 3966.9,-813.21 3977,-809.5 4023.34,-792.47 4150.71,-811.74 4199,-801.5 4244.06,-791.94 4292.58,-771.21 4325.83,-755.23"/>
<polygon fill="red" stroke="red" points="4327.76,-758.18 4335.22,-750.65 4324.69,-751.89 4327.76,-758.18"/>
<text text-anchor="middle" x="4008.5" y="-813.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu8 -->
<g id="node1209" class="node">
<title>l4_attn_stage14_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2636" cy="-733" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2636" y="-744.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="2636" y="-729.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2636" y="-714.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu8&#45;&gt;l4_attn_stage14_gpu8 -->
<g id="edge1145" class="edge">
<title>l4_attn_stage13_gpu8&#45;&gt;l4_attn_stage14_gpu8</title>
<path fill="none" stroke="black" d="M2636,-842.41C2636,-823.69 2636,-800.7 2636,-780.72"/>
<polygon fill="black" stroke="black" points="2639.5,-780.58 2636,-770.58 2632.5,-780.58 2639.5,-780.58"/>
</g>
<!-- l4_attn_stage13_gpu8&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge2217" class="edge">
<title>l4_attn_stage13_gpu8&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2692.98,-849.84C2707.9,-843.54 2724.24,-837.79 2740,-834.5 2810.91,-819.68 3975.65,-848.52 4044,-824.5 4054.15,-820.93 4052.94,-813.33 4063,-809.5 4091.3,-798.73 4169.46,-808.12 4199,-801.5 4243.67,-791.49 4291.88,-771.03 4325.15,-755.24"/>
<polygon fill="red" stroke="red" points="4327.06,-758.21 4334.55,-750.72 4324.02,-751.9 4327.06,-758.21"/>
<text text-anchor="middle" x="4094.5" y="-813.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu9 -->
<g id="node1210" class="node">
<title>l4_attn_stage14_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2844" cy="-733" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2844" y="-744.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="2844" y="-729.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2844" y="-714.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu9&#45;&gt;l4_attn_stage14_gpu9 -->
<g id="edge1146" class="edge">
<title>l4_attn_stage13_gpu9&#45;&gt;l4_attn_stage14_gpu9</title>
<path fill="none" stroke="black" d="M2844,-842.41C2844,-823.69 2844,-800.7 2844,-780.72"/>
<polygon fill="black" stroke="black" points="2847.5,-780.58 2844,-770.58 2840.5,-780.58 2847.5,-780.58"/>
</g>
<!-- l4_attn_stage13_gpu9&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge2218" class="edge">
<title>l4_attn_stage13_gpu9&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2900.98,-849.85C2915.9,-843.55 2932.24,-837.8 2948,-834.5 3012.28,-821.04 4068.05,-846.3 4130,-824.5 4140.15,-820.93 4139.15,-813.82 4149,-809.5 4169.61,-800.46 4177.31,-807.51 4199,-801.5 4242.28,-789.5 4289.59,-769.87 4322.94,-754.86"/>
<polygon fill="red" stroke="red" points="4324.74,-757.89 4332.4,-750.56 4321.84,-751.52 4324.74,-757.89"/>
<text text-anchor="middle" x="4180.5" y="-813.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu10 -->
<g id="node1211" class="node">
<title>l4_attn_stage14_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3052" cy="-733" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3052" y="-744.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="3052" y="-729.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3052" y="-714.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu10&#45;&gt;l4_attn_stage14_gpu10 -->
<g id="edge1147" class="edge">
<title>l4_attn_stage13_gpu10&#45;&gt;l4_attn_stage14_gpu10</title>
<path fill="none" stroke="black" d="M3052,-842.41C3052,-823.69 3052,-800.7 3052,-780.72"/>
<polygon fill="black" stroke="black" points="3055.5,-780.58 3052,-770.58 3048.5,-780.58 3055.5,-780.58"/>
</g>
<!-- l4_attn_stage13_gpu10&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge2219" class="edge">
<title>l4_attn_stage13_gpu10&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3108.98,-849.86C3123.91,-843.56 3140.24,-837.81 3156,-834.5 3213.64,-822.4 4160.46,-844.08 4216,-824.5 4226.15,-820.92 4226.08,-815.52 4235,-809.5 4264.36,-789.68 4299.2,-769.89 4325.72,-755.55"/>
<polygon fill="red" stroke="red" points="4327.57,-758.53 4334.73,-750.71 4324.26,-752.36 4327.57,-758.53"/>
<text text-anchor="middle" x="4266.5" y="-813.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu11 -->
<g id="node1212" class="node">
<title>l4_attn_stage14_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3260" cy="-733" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3260" y="-744.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="3260" y="-729.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3260" y="-714.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu11&#45;&gt;l4_attn_stage14_gpu11 -->
<g id="edge1148" class="edge">
<title>l4_attn_stage13_gpu11&#45;&gt;l4_attn_stage14_gpu11</title>
<path fill="none" stroke="black" d="M3260,-842.41C3260,-823.69 3260,-800.7 3260,-780.72"/>
<polygon fill="black" stroke="black" points="3263.5,-780.58 3260,-770.58 3256.5,-780.58 3263.5,-780.58"/>
</g>
<!-- l4_attn_stage13_gpu11&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge2220" class="edge">
<title>l4_attn_stage13_gpu11&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3316.98,-849.87C3331.91,-843.57 3348.24,-837.82 3364,-834.5 3389.5,-829.13 4278.88,-836.52 4302,-824.5 4315.7,-817.38 4337.58,-783.96 4352.12,-759.8"/>
<polygon fill="red" stroke="red" points="4355.21,-761.46 4357.3,-751.07 4349.19,-757.88 4355.21,-761.46"/>
<text text-anchor="middle" x="4348.5" y="-813.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu12 -->
<g id="node1213" class="node">
<title>l4_attn_stage14_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3468" cy="-733" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3468" y="-744.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="3468" y="-729.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3468" y="-714.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu12&#45;&gt;l4_attn_stage14_gpu12 -->
<g id="edge1149" class="edge">
<title>l4_attn_stage13_gpu12&#45;&gt;l4_attn_stage14_gpu12</title>
<path fill="none" stroke="black" d="M3405.19,-851.68C3391.64,-845.91 3377.37,-839.93 3364,-834.5 3352.53,-829.84 3345.01,-834.71 3338,-824.5 3334.23,-819 3334.04,-814.86 3338,-809.5 3345.18,-799.77 3353.05,-806.62 3364,-801.5 3381.44,-793.35 3399.39,-782.66 3415.36,-772.19"/>
<polygon fill="black" stroke="black" points="3417.64,-774.88 3424.02,-766.42 3413.76,-769.05 3417.64,-774.88"/>
</g>
<!-- l4_attn_stage13_gpu12&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge2221" class="edge">
<title>l4_attn_stage13_gpu12&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3524.99,-849.89C3539.91,-843.59 3556.24,-837.83 3572,-834.5 3594.18,-829.81 4372.07,-840.63 4388,-824.5 4404.71,-807.58 4395.21,-780.14 4384.15,-759.9"/>
<polygon fill="red" stroke="red" points="4387.11,-758.04 4379.04,-751.17 4381.07,-761.57 4387.11,-758.04"/>
<text text-anchor="middle" x="4426.5" y="-813.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu13 -->
<g id="node1214" class="node">
<title>l4_attn_stage14_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3676" cy="-733" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3676" y="-744.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="3676" y="-729.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3676" y="-714.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu13&#45;&gt;l4_attn_stage14_gpu13 -->
<g id="edge1150" class="edge">
<title>l4_attn_stage13_gpu13&#45;&gt;l4_attn_stage14_gpu13</title>
<path fill="none" stroke="black" d="M3618.39,-850C3603.62,-843.79 3587.51,-838.04 3572,-834.5 3547.39,-828.89 3362.45,-842.74 3345,-824.5 3340.39,-819.68 3340.37,-814.3 3345,-809.5 3353.76,-800.42 3559.97,-805.29 3572,-801.5 3591.58,-795.33 3611,-784.38 3627.67,-773.08"/>
<polygon fill="black" stroke="black" points="3629.94,-775.77 3636.13,-767.16 3625.93,-770.03 3629.94,-775.77"/>
</g>
<!-- l4_attn_stage13_gpu13&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge2222" class="edge">
<title>l4_attn_stage13_gpu13&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3732.99,-849.91C3747.92,-843.62 3764.25,-837.85 3780,-834.5 3798.86,-830.49 4460.47,-838.23 4474,-824.5 4499.62,-798.51 4458.49,-771.91 4420.04,-754.34"/>
<polygon fill="red" stroke="red" points="4421.44,-751.13 4410.88,-750.29 4418.61,-757.53 4421.44,-751.13"/>
<text text-anchor="middle" x="4512.5" y="-813.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu14 -->
<g id="node1215" class="node">
<title>l4_attn_stage14_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3884" cy="-733" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3884" y="-744.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="3884" y="-729.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3884" y="-714.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu14&#45;&gt;l4_attn_stage14_gpu14 -->
<g id="edge1151" class="edge">
<title>l4_attn_stage13_gpu14&#45;&gt;l4_attn_stage14_gpu14</title>
<path fill="none" stroke="black" d="M3826.71,-849.89C3811.86,-843.64 3795.64,-837.9 3780,-834.5 3756.76,-829.45 3368.62,-841.51 3352,-824.5 3347.34,-819.73 3347.33,-814.26 3352,-809.5 3360.33,-801.01 3768.63,-804.98 3780,-801.5 3799.63,-795.49 3819.07,-784.59 3835.73,-773.27"/>
<polygon fill="black" stroke="black" points="3838.01,-775.95 3844.18,-767.34 3833.99,-770.22 3838.01,-775.95"/>
</g>
<!-- l4_attn_stage13_gpu14&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge2223" class="edge">
<title>l4_attn_stage13_gpu14&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3941,-849.94C3955.92,-843.65 3972.25,-837.87 3988,-834.5 4003.54,-831.17 4548.86,-835.83 4560,-824.5 4596.88,-786.96 4533.24,-763.2 4469.37,-749.5"/>
<polygon fill="red" stroke="red" points="4470.05,-746.06 4459.55,-747.47 4468.63,-752.92 4470.05,-746.06"/>
<text text-anchor="middle" x="4599.5" y="-813.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage14_gpu15 -->
<g id="node1216" class="node">
<title>l4_attn_stage14_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4092" cy="-733" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4092" y="-744.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage14</text>
<text text-anchor="middle" x="4092" y="-729.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4092" y="-714.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage13_gpu15&#45;&gt;l4_attn_stage14_gpu15 -->
<g id="edge1152" class="edge">
<title>l4_attn_stage13_gpu15&#45;&gt;l4_attn_stage14_gpu15</title>
<path fill="none" stroke="black" d="M4035,-849.93C4020.08,-843.63 4003.75,-837.86 3988,-834.5 3970.91,-830.86 3371.26,-836.95 3359,-824.5 3354.32,-819.75 3354.32,-814.24 3359,-809.5 3371.28,-797.07 3971.28,-806.57 3988,-801.5 4007.65,-795.55 4027.09,-784.66 4043.75,-773.34"/>
<polygon fill="black" stroke="black" points="4046.03,-776.02 4052.2,-767.41 4042.01,-770.29 4046.03,-776.02"/>
</g>
<!-- l4_attn_stage13_gpu15&#45;&gt;l4_attn_stage14_gpu[next_gpu] -->
<g id="edge2224" class="edge">
<title>l4_attn_stage13_gpu15&#45;&gt;l4_attn_stage14_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4151.56,-850.58C4167.88,-844.06 4185.81,-838.02 4203,-834.5 4227.12,-829.56 4628.79,-842.1 4646,-824.5 4695.67,-773.7 4608.33,-751.39 4518.57,-741.61"/>
<polygon fill="red" stroke="red" points="4518.78,-738.11 4508.47,-740.56 4518.05,-745.07 4518.78,-738.11"/>
<text text-anchor="middle" x="4685.5" y="-813.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu0 -->
<g id="node1217" class="node">
<title>l4_attn_stage15_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="972" cy="-586" rx="95" ry="37.5"/>
<text text-anchor="middle" x="972" y="-597.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="972" y="-582.3" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="972" y="-567.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu0&#45;&gt;l4_attn_stage15_gpu0 -->
<g id="edge1153" class="edge">
<title>l4_attn_stage14_gpu0&#45;&gt;l4_attn_stage15_gpu0</title>
<path fill="none" stroke="black" d="M972,-695.41C972,-676.69 972,-653.7 972,-633.72"/>
<polygon fill="black" stroke="black" points="975.5,-633.58 972,-623.58 968.5,-633.58 975.5,-633.58"/>
</g>
<!-- l4_attn_stage15_gpu[next_gpu] -->
<g id="node1372" class="node">
<title>l4_attn_stage15_gpu[next_gpu]</title>
<ellipse fill="none" stroke="black" cx="4367" cy="-586" rx="155.5" ry="18"/>
<text text-anchor="middle" x="4367" y="-582.3" font-family="Times,serif" font-size="14.00">l4_attn_stage15_gpu[next_gpu]</text>
</g>
<!-- l4_attn_stage14_gpu0&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge2225" class="edge">
<title>l4_attn_stage14_gpu0&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1028.98,-702.87C1043.91,-696.58 1060.24,-690.82 1076,-687.5 1325.97,-634.85 3119.55,-665.13 3375,-662.5 3420.78,-662.03 4154.1,-663.41 4199,-654.5 4244.32,-645.51 4292.98,-624.59 4326.21,-608.4"/>
<polygon fill="red" stroke="red" points="4328.17,-611.34 4335.58,-603.76 4325.06,-605.06 4328.17,-611.34"/>
<text text-anchor="middle" x="3406.5" y="-666.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu1 -->
<g id="node1218" class="node">
<title>l4_attn_stage15_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1180" cy="-586" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1180" y="-597.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="1180" y="-582.3" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1180" y="-567.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu1&#45;&gt;l4_attn_stage15_gpu1 -->
<g id="edge1154" class="edge">
<title>l4_attn_stage14_gpu1&#45;&gt;l4_attn_stage15_gpu1</title>
<path fill="none" stroke="black" d="M1180,-695.41C1180,-676.69 1180,-653.7 1180,-633.72"/>
<polygon fill="black" stroke="black" points="1183.5,-633.58 1180,-623.58 1176.5,-633.58 1183.5,-633.58"/>
</g>
<!-- l4_attn_stage14_gpu1&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge2226" class="edge">
<title>l4_attn_stage14_gpu1&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1236.97,-702.8C1251.89,-696.51 1268.23,-690.77 1284,-687.5 1342.7,-675.33 3385.42,-697.29 3442,-677.5 3452.16,-673.95 3450.86,-666.08 3461,-662.5 3499.66,-648.84 4158.79,-662.5 4199,-654.5 4244.31,-645.48 4292.98,-624.57 4326.21,-608.39"/>
<polygon fill="red" stroke="red" points="4328.17,-611.32 4335.58,-603.75 4325.06,-605.05 4328.17,-611.32"/>
<text text-anchor="middle" x="3492.5" y="-666.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu2 -->
<g id="node1219" class="node">
<title>l4_attn_stage15_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1388" cy="-586" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1388" y="-597.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="1388" y="-582.3" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1388" y="-567.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu2&#45;&gt;l4_attn_stage15_gpu2 -->
<g id="edge1155" class="edge">
<title>l4_attn_stage14_gpu2&#45;&gt;l4_attn_stage15_gpu2</title>
<path fill="none" stroke="black" d="M1388,-695.41C1388,-676.69 1388,-653.7 1388,-633.72"/>
<polygon fill="black" stroke="black" points="1391.5,-633.58 1388,-623.58 1384.5,-633.58 1391.5,-633.58"/>
</g>
<!-- l4_attn_stage14_gpu2&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge2227" class="edge">
<title>l4_attn_stage14_gpu2&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1444.97,-702.81C1459.89,-696.51 1476.23,-690.77 1492,-687.5 1547.38,-676.01 3474.62,-696.18 3528,-677.5 3538.16,-673.95 3536.86,-666.09 3547,-662.5 3581.15,-650.41 4163.48,-661.6 4199,-654.5 4244.31,-645.45 4292.97,-624.54 4326.2,-608.37"/>
<polygon fill="red" stroke="red" points="4328.16,-611.31 4335.57,-603.74 4325.06,-605.03 4328.16,-611.31"/>
<text text-anchor="middle" x="3578.5" y="-666.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu3 -->
<g id="node1220" class="node">
<title>l4_attn_stage15_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1596" cy="-586" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1596" y="-597.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="1596" y="-582.3" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1596" y="-567.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu3&#45;&gt;l4_attn_stage15_gpu3 -->
<g id="edge1156" class="edge">
<title>l4_attn_stage14_gpu3&#45;&gt;l4_attn_stage15_gpu3</title>
<path fill="none" stroke="black" d="M1596,-695.41C1596,-676.69 1596,-653.7 1596,-633.72"/>
<polygon fill="black" stroke="black" points="1599.5,-633.58 1596,-623.58 1592.5,-633.58 1599.5,-633.58"/>
</g>
<!-- l4_attn_stage14_gpu3&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge2228" class="edge">
<title>l4_attn_stage14_gpu3&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1652.97,-702.81C1667.9,-696.52 1684.23,-690.77 1700,-687.5 1752.06,-676.69 3563.82,-695.07 3614,-677.5 3624.15,-673.94 3622.86,-666.1 3633,-662.5 3662.63,-651.98 4168.17,-660.69 4199,-654.5 4244.3,-645.41 4292.97,-624.5 4326.2,-608.35"/>
<polygon fill="red" stroke="red" points="4328.15,-611.29 4335.57,-603.72 4325.05,-605.01 4328.15,-611.29"/>
<text text-anchor="middle" x="3664.5" y="-666.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu4 -->
<g id="node1221" class="node">
<title>l4_attn_stage15_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1804" cy="-586" rx="95" ry="37.5"/>
<text text-anchor="middle" x="1804" y="-597.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="1804" y="-582.3" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1804" y="-567.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu4&#45;&gt;l4_attn_stage15_gpu4 -->
<g id="edge1157" class="edge">
<title>l4_attn_stage14_gpu4&#45;&gt;l4_attn_stage15_gpu4</title>
<path fill="none" stroke="black" d="M1804,-695.41C1804,-676.69 1804,-653.7 1804,-633.72"/>
<polygon fill="black" stroke="black" points="1807.5,-633.58 1804,-623.58 1800.5,-633.58 1807.5,-633.58"/>
</g>
<!-- l4_attn_stage14_gpu4&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge2229" class="edge">
<title>l4_attn_stage14_gpu4&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1860.97,-702.81C1875.9,-696.52 1892.23,-690.78 1908,-687.5 1956.74,-677.37 3653.02,-693.96 3700,-677.5 3710.15,-673.94 3708.87,-666.11 3719,-662.5 3769.24,-644.59 4146.72,-665.06 4199,-654.5 4244.29,-645.35 4292.96,-624.45 4326.19,-608.32"/>
<polygon fill="red" stroke="red" points="4328.14,-611.26 4335.56,-603.69 4325.05,-604.98 4328.14,-611.26"/>
<text text-anchor="middle" x="3750.5" y="-666.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu5 -->
<g id="node1222" class="node">
<title>l4_attn_stage15_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2012" cy="-586" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2012" y="-597.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="2012" y="-582.3" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2012" y="-567.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu5&#45;&gt;l4_attn_stage15_gpu5 -->
<g id="edge1158" class="edge">
<title>l4_attn_stage14_gpu5&#45;&gt;l4_attn_stage15_gpu5</title>
<path fill="none" stroke="black" d="M2012,-695.41C2012,-676.69 2012,-653.7 2012,-633.72"/>
<polygon fill="black" stroke="black" points="2015.5,-633.58 2012,-623.58 2008.5,-633.58 2015.5,-633.58"/>
</g>
<!-- l4_attn_stage14_gpu5&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge2230" class="edge">
<title>l4_attn_stage14_gpu5&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2068.97,-702.82C2083.9,-696.52 2100.23,-690.78 2116,-687.5 2161.42,-678.05 3742.22,-692.84 3786,-677.5 3796.15,-673.94 3794.87,-666.13 3805,-662.5 3846.22,-647.72 4156.1,-663.25 4199,-654.5 4244.27,-645.27 4292.94,-624.38 4326.18,-608.27"/>
<polygon fill="red" stroke="red" points="4328.13,-611.21 4335.56,-603.66 4325.04,-604.93 4328.13,-611.21"/>
<text text-anchor="middle" x="3836.5" y="-666.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu6 -->
<g id="node1223" class="node">
<title>l4_attn_stage15_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2220" cy="-586" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2220" y="-597.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="2220" y="-582.3" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2220" y="-567.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu6&#45;&gt;l4_attn_stage15_gpu6 -->
<g id="edge1159" class="edge">
<title>l4_attn_stage14_gpu6&#45;&gt;l4_attn_stage15_gpu6</title>
<path fill="none" stroke="black" d="M2220,-695.41C2220,-676.69 2220,-653.7 2220,-633.72"/>
<polygon fill="black" stroke="black" points="2223.5,-633.58 2220,-623.58 2216.5,-633.58 2223.5,-633.58"/>
</g>
<!-- l4_attn_stage14_gpu6&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge2231" class="edge">
<title>l4_attn_stage14_gpu6&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2276.97,-702.82C2291.9,-696.53 2308.23,-690.78 2324,-687.5 2366.1,-678.73 3831.42,-691.73 3872,-677.5 3882.15,-673.94 3880.88,-666.16 3891,-662.5 3923.19,-650.85 4165.48,-661.44 4199,-654.5 4244.11,-645.17 4292.62,-624.4 4325.86,-608.35"/>
<polygon fill="red" stroke="red" points="4327.8,-611.3 4335.24,-603.75 4324.72,-605.01 4327.8,-611.3"/>
<text text-anchor="middle" x="3922.5" y="-666.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu7 -->
<g id="node1224" class="node">
<title>l4_attn_stage15_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2428" cy="-586" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2428" y="-597.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="2428" y="-582.3" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2428" y="-567.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu7&#45;&gt;l4_attn_stage15_gpu7 -->
<g id="edge1160" class="edge">
<title>l4_attn_stage14_gpu7&#45;&gt;l4_attn_stage15_gpu7</title>
<path fill="none" stroke="black" d="M2428,-695.41C2428,-676.69 2428,-653.7 2428,-633.72"/>
<polygon fill="black" stroke="black" points="2431.5,-633.58 2428,-623.58 2424.5,-633.58 2431.5,-633.58"/>
</g>
<!-- l4_attn_stage14_gpu7&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge2232" class="edge">
<title>l4_attn_stage14_gpu7&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2484.98,-702.83C2499.9,-696.54 2516.24,-690.79 2532,-687.5 2570.78,-679.41 3920.62,-690.62 3958,-677.5 3968.15,-673.94 3966.9,-666.21 3977,-662.5 4023.34,-645.47 4150.71,-664.74 4199,-654.5 4244.06,-644.94 4292.58,-624.21 4325.83,-608.23"/>
<polygon fill="red" stroke="red" points="4327.76,-611.18 4335.22,-603.65 4324.69,-604.89 4327.76,-611.18"/>
<text text-anchor="middle" x="4008.5" y="-666.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu8 -->
<g id="node1225" class="node">
<title>l4_attn_stage15_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2636" cy="-586" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2636" y="-597.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="2636" y="-582.3" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2636" y="-567.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu8&#45;&gt;l4_attn_stage15_gpu8 -->
<g id="edge1161" class="edge">
<title>l4_attn_stage14_gpu8&#45;&gt;l4_attn_stage15_gpu8</title>
<path fill="none" stroke="black" d="M2636,-695.41C2636,-676.69 2636,-653.7 2636,-633.72"/>
<polygon fill="black" stroke="black" points="2639.5,-633.58 2636,-623.58 2632.5,-633.58 2639.5,-633.58"/>
</g>
<!-- l4_attn_stage14_gpu8&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge2233" class="edge">
<title>l4_attn_stage14_gpu8&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2692.98,-702.84C2707.9,-696.54 2724.24,-690.79 2740,-687.5 2810.91,-672.68 3975.65,-701.52 4044,-677.5 4054.15,-673.93 4052.94,-666.33 4063,-662.5 4091.3,-651.73 4169.46,-661.12 4199,-654.5 4243.67,-644.49 4291.88,-624.03 4325.15,-608.24"/>
<polygon fill="red" stroke="red" points="4327.06,-611.21 4334.55,-603.72 4324.02,-604.9 4327.06,-611.21"/>
<text text-anchor="middle" x="4094.5" y="-666.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu9 -->
<g id="node1226" class="node">
<title>l4_attn_stage15_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2844" cy="-586" rx="95" ry="37.5"/>
<text text-anchor="middle" x="2844" y="-597.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="2844" y="-582.3" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2844" y="-567.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu9&#45;&gt;l4_attn_stage15_gpu9 -->
<g id="edge1162" class="edge">
<title>l4_attn_stage14_gpu9&#45;&gt;l4_attn_stage15_gpu9</title>
<path fill="none" stroke="black" d="M2844,-695.41C2844,-676.69 2844,-653.7 2844,-633.72"/>
<polygon fill="black" stroke="black" points="2847.5,-633.58 2844,-623.58 2840.5,-633.58 2847.5,-633.58"/>
</g>
<!-- l4_attn_stage14_gpu9&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge2234" class="edge">
<title>l4_attn_stage14_gpu9&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2900.98,-702.85C2915.9,-696.55 2932.24,-690.8 2948,-687.5 3012.28,-674.04 4068.05,-699.3 4130,-677.5 4140.15,-673.93 4139.15,-666.82 4149,-662.5 4169.61,-653.46 4177.31,-660.51 4199,-654.5 4242.28,-642.5 4289.59,-622.87 4322.94,-607.86"/>
<polygon fill="red" stroke="red" points="4324.74,-610.89 4332.4,-603.56 4321.84,-604.52 4324.74,-610.89"/>
<text text-anchor="middle" x="4180.5" y="-666.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu10 -->
<g id="node1227" class="node">
<title>l4_attn_stage15_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3052" cy="-586" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3052" y="-597.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="3052" y="-582.3" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3052" y="-567.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu10&#45;&gt;l4_attn_stage15_gpu10 -->
<g id="edge1163" class="edge">
<title>l4_attn_stage14_gpu10&#45;&gt;l4_attn_stage15_gpu10</title>
<path fill="none" stroke="black" d="M3052,-695.41C3052,-676.69 3052,-653.7 3052,-633.72"/>
<polygon fill="black" stroke="black" points="3055.5,-633.58 3052,-623.58 3048.5,-633.58 3055.5,-633.58"/>
</g>
<!-- l4_attn_stage14_gpu10&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge2235" class="edge">
<title>l4_attn_stage14_gpu10&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3108.98,-702.86C3123.91,-696.56 3140.24,-690.81 3156,-687.5 3213.64,-675.4 4160.46,-697.08 4216,-677.5 4226.15,-673.92 4226.08,-668.52 4235,-662.5 4264.36,-642.68 4299.2,-622.89 4325.72,-608.55"/>
<polygon fill="red" stroke="red" points="4327.57,-611.53 4334.73,-603.71 4324.26,-605.36 4327.57,-611.53"/>
<text text-anchor="middle" x="4266.5" y="-666.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu11 -->
<g id="node1228" class="node">
<title>l4_attn_stage15_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3260" cy="-586" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3260" y="-597.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="3260" y="-582.3" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3260" y="-567.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu11&#45;&gt;l4_attn_stage15_gpu11 -->
<g id="edge1164" class="edge">
<title>l4_attn_stage14_gpu11&#45;&gt;l4_attn_stage15_gpu11</title>
<path fill="none" stroke="black" d="M3260,-695.41C3260,-676.69 3260,-653.7 3260,-633.72"/>
<polygon fill="black" stroke="black" points="3263.5,-633.58 3260,-623.58 3256.5,-633.58 3263.5,-633.58"/>
</g>
<!-- l4_attn_stage14_gpu11&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge2236" class="edge">
<title>l4_attn_stage14_gpu11&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3316.98,-702.87C3331.91,-696.57 3348.24,-690.82 3364,-687.5 3389.5,-682.13 4278.88,-689.52 4302,-677.5 4315.7,-670.38 4337.58,-636.96 4352.12,-612.8"/>
<polygon fill="red" stroke="red" points="4355.21,-614.46 4357.3,-604.07 4349.19,-610.88 4355.21,-614.46"/>
<text text-anchor="middle" x="4348.5" y="-666.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu12 -->
<g id="node1229" class="node">
<title>l4_attn_stage15_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3468" cy="-586" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3468" y="-597.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="3468" y="-582.3" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3468" y="-567.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu12&#45;&gt;l4_attn_stage15_gpu12 -->
<g id="edge1165" class="edge">
<title>l4_attn_stage14_gpu12&#45;&gt;l4_attn_stage15_gpu12</title>
<path fill="none" stroke="black" d="M3405.19,-704.68C3391.64,-698.91 3377.37,-692.93 3364,-687.5 3352.53,-682.84 3345.01,-687.71 3338,-677.5 3334.23,-672 3334.04,-667.86 3338,-662.5 3345.18,-652.77 3353.05,-659.62 3364,-654.5 3381.44,-646.35 3399.39,-635.66 3415.36,-625.19"/>
<polygon fill="black" stroke="black" points="3417.64,-627.88 3424.02,-619.42 3413.76,-622.05 3417.64,-627.88"/>
</g>
<!-- l4_attn_stage14_gpu12&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge2237" class="edge">
<title>l4_attn_stage14_gpu12&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3524.99,-702.89C3539.91,-696.59 3556.24,-690.83 3572,-687.5 3594.18,-682.81 4372.07,-693.63 4388,-677.5 4404.71,-660.58 4395.21,-633.14 4384.15,-612.9"/>
<polygon fill="red" stroke="red" points="4387.11,-611.04 4379.04,-604.17 4381.07,-614.57 4387.11,-611.04"/>
<text text-anchor="middle" x="4426.5" y="-666.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu13 -->
<g id="node1230" class="node">
<title>l4_attn_stage15_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3676" cy="-586" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3676" y="-597.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="3676" y="-582.3" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3676" y="-567.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu13&#45;&gt;l4_attn_stage15_gpu13 -->
<g id="edge1166" class="edge">
<title>l4_attn_stage14_gpu13&#45;&gt;l4_attn_stage15_gpu13</title>
<path fill="none" stroke="black" d="M3618.39,-703C3603.62,-696.79 3587.51,-691.04 3572,-687.5 3547.39,-681.89 3362.45,-695.74 3345,-677.5 3340.39,-672.68 3340.37,-667.3 3345,-662.5 3353.76,-653.42 3559.97,-658.29 3572,-654.5 3591.58,-648.33 3611,-637.38 3627.67,-626.08"/>
<polygon fill="black" stroke="black" points="3629.94,-628.77 3636.13,-620.16 3625.93,-623.03 3629.94,-628.77"/>
</g>
<!-- l4_attn_stage14_gpu13&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge2238" class="edge">
<title>l4_attn_stage14_gpu13&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3732.99,-702.91C3747.92,-696.62 3764.25,-690.85 3780,-687.5 3798.86,-683.49 4460.47,-691.23 4474,-677.5 4499.62,-651.51 4458.49,-624.91 4420.04,-607.34"/>
<polygon fill="red" stroke="red" points="4421.44,-604.13 4410.88,-603.29 4418.61,-610.53 4421.44,-604.13"/>
<text text-anchor="middle" x="4512.5" y="-666.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu14 -->
<g id="node1231" class="node">
<title>l4_attn_stage15_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3884" cy="-586" rx="95" ry="37.5"/>
<text text-anchor="middle" x="3884" y="-597.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="3884" y="-582.3" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3884" y="-567.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu14&#45;&gt;l4_attn_stage15_gpu14 -->
<g id="edge1167" class="edge">
<title>l4_attn_stage14_gpu14&#45;&gt;l4_attn_stage15_gpu14</title>
<path fill="none" stroke="black" d="M3826.71,-702.89C3811.86,-696.64 3795.64,-690.9 3780,-687.5 3756.76,-682.45 3368.62,-694.51 3352,-677.5 3347.34,-672.73 3347.33,-667.26 3352,-662.5 3360.33,-654.01 3768.63,-657.98 3780,-654.5 3799.63,-648.49 3819.07,-637.59 3835.73,-626.27"/>
<polygon fill="black" stroke="black" points="3838.01,-628.95 3844.18,-620.34 3833.99,-623.22 3838.01,-628.95"/>
</g>
<!-- l4_attn_stage14_gpu14&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge2239" class="edge">
<title>l4_attn_stage14_gpu14&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3941,-702.94C3955.92,-696.65 3972.25,-690.87 3988,-687.5 4003.54,-684.17 4548.86,-688.83 4560,-677.5 4596.88,-639.96 4533.24,-616.2 4469.37,-602.5"/>
<polygon fill="red" stroke="red" points="4470.05,-599.06 4459.55,-600.47 4468.63,-605.92 4470.05,-599.06"/>
<text text-anchor="middle" x="4599.5" y="-666.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_stage15_gpu15 -->
<g id="node1232" class="node">
<title>l4_attn_stage15_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4092" cy="-586" rx="95" ry="37.5"/>
<text text-anchor="middle" x="4092" y="-597.3" font-family="Times,serif" font-size="14.00">L4 Attn Stage15</text>
<text text-anchor="middle" x="4092" y="-582.3" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4092" y="-567.3" font-family="Times,serif" font-size="14.00">Q_p @ K_src.T</text>
</g>
<!-- l4_attn_stage14_gpu15&#45;&gt;l4_attn_stage15_gpu15 -->
<g id="edge1168" class="edge">
<title>l4_attn_stage14_gpu15&#45;&gt;l4_attn_stage15_gpu15</title>
<path fill="none" stroke="black" d="M4035,-702.93C4020.08,-696.63 4003.75,-690.86 3988,-687.5 3970.91,-683.86 3371.26,-689.95 3359,-677.5 3354.32,-672.75 3354.32,-667.24 3359,-662.5 3371.28,-650.07 3971.28,-659.57 3988,-654.5 4007.65,-648.55 4027.09,-637.66 4043.75,-626.34"/>
<polygon fill="black" stroke="black" points="4046.03,-629.02 4052.2,-620.41 4042.01,-623.29 4046.03,-629.02"/>
</g>
<!-- l4_attn_stage14_gpu15&#45;&gt;l4_attn_stage15_gpu[next_gpu] -->
<g id="edge2240" class="edge">
<title>l4_attn_stage14_gpu15&#45;&gt;l4_attn_stage15_gpu[next_gpu]</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4151.56,-703.58C4167.88,-697.06 4185.81,-691.02 4203,-687.5 4227.12,-682.56 4628.79,-695.1 4646,-677.5 4695.67,-626.7 4608.33,-604.39 4518.57,-594.61"/>
<polygon fill="red" stroke="red" points="4518.78,-591.11 4508.47,-593.56 4518.05,-598.07 4518.78,-591.11"/>
<text text-anchor="middle" x="4685.5" y="-666.3" font-family="Times,serif" font-size="14.00">KV block</text>
</g>
<!-- l4_attn_out_gpu0 -->
<g id="node1249" class="node">
<title>l4_attn_out_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="970" cy="-463.42" rx="75" ry="48.17"/>
<text text-anchor="middle" x="970" y="-482.22" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="970" y="-467.22" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="970" y="-452.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="970" y="-437.22" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu0&#45;&gt;l4_attn_out_gpu0 -->
<g id="edge1169" class="edge">
<title>l4_attn_stage15_gpu0&#45;&gt;l4_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M971.39,-548.49C971.25,-540.03 971.1,-530.83 970.95,-521.71"/>
<polygon fill="black" stroke="black" points="974.45,-521.45 970.78,-511.51 967.45,-521.56 974.45,-521.45"/>
</g>
<!-- l4_attn_out_gpu1 -->
<g id="node1250" class="node">
<title>l4_attn_out_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1173" cy="-463.42" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1173" y="-482.22" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="1173" y="-467.22" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1173" y="-452.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1173" y="-437.22" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu1&#45;&gt;l4_attn_out_gpu1 -->
<g id="edge1170" class="edge">
<title>l4_attn_stage15_gpu1&#45;&gt;l4_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M1177.88,-548.49C1177.39,-540.03 1176.86,-530.83 1176.33,-521.71"/>
<polygon fill="black" stroke="black" points="1179.81,-521.29 1175.73,-511.51 1172.82,-521.69 1179.81,-521.29"/>
</g>
<!-- l4_attn_out_gpu2 -->
<g id="node1251" class="node">
<title>l4_attn_out_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1386" cy="-463.42" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1386" y="-482.22" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="1386" y="-467.22" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1386" y="-452.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1386" y="-437.22" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu2&#45;&gt;l4_attn_out_gpu2 -->
<g id="edge1171" class="edge">
<title>l4_attn_stage15_gpu2&#45;&gt;l4_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M1387.39,-548.49C1387.25,-540.03 1387.1,-530.83 1386.95,-521.71"/>
<polygon fill="black" stroke="black" points="1390.45,-521.45 1386.78,-511.51 1383.45,-521.56 1390.45,-521.45"/>
</g>
<!-- l4_attn_out_gpu3 -->
<g id="node1252" class="node">
<title>l4_attn_out_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1592" cy="-463.42" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1592" y="-482.22" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="1592" y="-467.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1592" y="-452.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1592" y="-437.22" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu3&#45;&gt;l4_attn_out_gpu3 -->
<g id="edge1172" class="edge">
<title>l4_attn_stage15_gpu3&#45;&gt;l4_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M1594.79,-548.49C1594.51,-540.03 1594.2,-530.83 1593.9,-521.71"/>
<polygon fill="black" stroke="black" points="1597.39,-521.38 1593.56,-511.51 1590.4,-521.62 1597.39,-521.38"/>
</g>
<!-- l4_attn_out_gpu4 -->
<g id="node1253" class="node">
<title>l4_attn_out_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1803" cy="-463.42" rx="75" ry="48.17"/>
<text text-anchor="middle" x="1803" y="-482.22" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="1803" y="-467.22" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1803" y="-452.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1803" y="-437.22" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu4&#45;&gt;l4_attn_out_gpu4 -->
<g id="edge1173" class="edge">
<title>l4_attn_stage15_gpu4&#45;&gt;l4_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M1803.7,-548.49C1803.63,-540.03 1803.55,-530.83 1803.48,-521.71"/>
<polygon fill="black" stroke="black" points="1806.97,-521.48 1803.39,-511.51 1799.97,-521.54 1806.97,-521.48"/>
</g>
<!-- l4_attn_out_gpu5 -->
<g id="node1254" class="node">
<title>l4_attn_out_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2008" cy="-463.42" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2008" y="-482.22" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="2008" y="-467.22" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2008" y="-452.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2008" y="-437.22" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu5&#45;&gt;l4_attn_out_gpu5 -->
<g id="edge1174" class="edge">
<title>l4_attn_stage15_gpu5&#45;&gt;l4_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M2010.79,-548.49C2010.51,-540.03 2010.2,-530.83 2009.9,-521.71"/>
<polygon fill="black" stroke="black" points="2013.39,-521.38 2009.56,-511.51 2006.4,-521.62 2013.39,-521.38"/>
</g>
<!-- l4_attn_out_gpu6 -->
<g id="node1255" class="node">
<title>l4_attn_out_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2218" cy="-463.42" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2218" y="-482.22" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="2218" y="-467.22" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2218" y="-452.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2218" y="-437.22" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu6&#45;&gt;l4_attn_out_gpu6 -->
<g id="edge1175" class="edge">
<title>l4_attn_stage15_gpu6&#45;&gt;l4_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M2219.39,-548.49C2219.25,-540.03 2219.1,-530.83 2218.95,-521.71"/>
<polygon fill="black" stroke="black" points="2222.45,-521.45 2218.78,-511.51 2215.45,-521.56 2222.45,-521.45"/>
</g>
<!-- l4_attn_out_gpu7 -->
<g id="node1256" class="node">
<title>l4_attn_out_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2428" cy="-463.42" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2428" y="-482.22" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="2428" y="-467.22" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2428" y="-452.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2428" y="-437.22" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu7&#45;&gt;l4_attn_out_gpu7 -->
<g id="edge1176" class="edge">
<title>l4_attn_stage15_gpu7&#45;&gt;l4_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M2428,-548.49C2428,-540.03 2428,-530.83 2428,-521.71"/>
<polygon fill="black" stroke="black" points="2431.5,-521.51 2428,-511.51 2424.5,-521.51 2431.5,-521.51"/>
</g>
<!-- l4_attn_out_gpu8 -->
<g id="node1257" class="node">
<title>l4_attn_out_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2637" cy="-463.42" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2637" y="-482.22" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="2637" y="-467.22" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2637" y="-452.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2637" y="-437.22" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu8&#45;&gt;l4_attn_out_gpu8 -->
<g id="edge1177" class="edge">
<title>l4_attn_stage15_gpu8&#45;&gt;l4_attn_out_gpu8</title>
<path fill="none" stroke="black" d="M2636.3,-548.49C2636.37,-540.03 2636.45,-530.83 2636.52,-521.71"/>
<polygon fill="black" stroke="black" points="2640.03,-521.54 2636.61,-511.51 2633.03,-521.48 2640.03,-521.54"/>
</g>
<!-- l4_attn_out_gpu9 -->
<g id="node1258" class="node">
<title>l4_attn_out_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2845" cy="-463.42" rx="75" ry="48.17"/>
<text text-anchor="middle" x="2845" y="-482.22" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="2845" y="-467.22" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2845" y="-452.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2845" y="-437.22" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu9&#45;&gt;l4_attn_out_gpu9 -->
<g id="edge1178" class="edge">
<title>l4_attn_stage15_gpu9&#45;&gt;l4_attn_out_gpu9</title>
<path fill="none" stroke="black" d="M2844.3,-548.49C2844.37,-540.03 2844.45,-530.83 2844.52,-521.71"/>
<polygon fill="black" stroke="black" points="2848.03,-521.54 2844.61,-511.51 2841.03,-521.48 2848.03,-521.54"/>
</g>
<!-- l4_attn_out_gpu10 -->
<g id="node1259" class="node">
<title>l4_attn_out_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3054" cy="-463.42" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3054" y="-482.22" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="3054" y="-467.22" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3054" y="-452.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3054" y="-437.22" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu10&#45;&gt;l4_attn_out_gpu10 -->
<g id="edge1179" class="edge">
<title>l4_attn_stage15_gpu10&#45;&gt;l4_attn_out_gpu10</title>
<path fill="none" stroke="black" d="M3052.61,-548.49C3052.75,-540.03 3052.9,-530.83 3053.05,-521.71"/>
<polygon fill="black" stroke="black" points="3056.55,-521.56 3053.22,-511.51 3049.55,-521.45 3056.55,-521.56"/>
</g>
<!-- l4_attn_out_gpu11 -->
<g id="node1260" class="node">
<title>l4_attn_out_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3262" cy="-463.42" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3262" y="-482.22" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="3262" y="-467.22" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3262" y="-452.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3262" y="-437.22" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu11&#45;&gt;l4_attn_out_gpu11 -->
<g id="edge1180" class="edge">
<title>l4_attn_stage15_gpu11&#45;&gt;l4_attn_out_gpu11</title>
<path fill="none" stroke="black" d="M3260.61,-548.49C3260.75,-540.03 3260.9,-530.83 3261.05,-521.71"/>
<polygon fill="black" stroke="black" points="3264.55,-521.56 3261.22,-511.51 3257.55,-521.45 3264.55,-521.56"/>
</g>
<!-- l4_attn_out_gpu12 -->
<g id="node1261" class="node">
<title>l4_attn_out_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3472" cy="-463.42" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3472" y="-482.22" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="3472" y="-467.22" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3472" y="-452.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3472" y="-437.22" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu12&#45;&gt;l4_attn_out_gpu12 -->
<g id="edge1181" class="edge">
<title>l4_attn_stage15_gpu12&#45;&gt;l4_attn_out_gpu12</title>
<path fill="none" stroke="black" d="M3469.21,-548.49C3469.49,-540.03 3469.8,-530.83 3470.1,-521.71"/>
<polygon fill="black" stroke="black" points="3473.6,-521.62 3470.44,-511.51 3466.61,-521.38 3473.6,-521.62"/>
</g>
<!-- l4_attn_out_gpu13 -->
<g id="node1262" class="node">
<title>l4_attn_out_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3680" cy="-463.42" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3680" y="-482.22" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="3680" y="-467.22" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3680" y="-452.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3680" y="-437.22" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu13&#45;&gt;l4_attn_out_gpu13 -->
<g id="edge1182" class="edge">
<title>l4_attn_stage15_gpu13&#45;&gt;l4_attn_out_gpu13</title>
<path fill="none" stroke="black" d="M3677.21,-548.49C3677.49,-540.03 3677.8,-530.83 3678.1,-521.71"/>
<polygon fill="black" stroke="black" points="3681.6,-521.62 3678.44,-511.51 3674.61,-521.38 3681.6,-521.62"/>
</g>
<!-- l4_attn_out_gpu14 -->
<g id="node1263" class="node">
<title>l4_attn_out_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3888" cy="-463.42" rx="75" ry="48.17"/>
<text text-anchor="middle" x="3888" y="-482.22" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="3888" y="-467.22" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3888" y="-452.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3888" y="-437.22" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu14&#45;&gt;l4_attn_out_gpu14 -->
<g id="edge1183" class="edge">
<title>l4_attn_stage15_gpu14&#45;&gt;l4_attn_out_gpu14</title>
<path fill="none" stroke="black" d="M3885.21,-548.49C3885.49,-540.03 3885.8,-530.83 3886.1,-521.71"/>
<polygon fill="black" stroke="black" points="3889.6,-521.62 3886.44,-511.51 3882.61,-521.38 3889.6,-521.62"/>
</g>
<!-- l4_attn_out_gpu15 -->
<g id="node1264" class="node">
<title>l4_attn_out_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4096" cy="-463.42" rx="75" ry="48.17"/>
<text text-anchor="middle" x="4096" y="-482.22" font-family="Times,serif" font-size="14.00">L4 Attn Out</text>
<text text-anchor="middle" x="4096" y="-467.22" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4096" y="-452.22" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="4096" y="-437.22" font-family="Times,serif" font-size="14.00">d_model</text>
</g>
<!-- l4_attn_stage15_gpu15&#45;&gt;l4_attn_out_gpu15 -->
<g id="edge1184" class="edge">
<title>l4_attn_stage15_gpu15&#45;&gt;l4_attn_out_gpu15</title>
<path fill="none" stroke="black" d="M4093.21,-548.49C4093.49,-540.03 4093.8,-530.83 4094.1,-521.71"/>
<polygon fill="black" stroke="black" points="4097.6,-521.62 4094.44,-511.51 4090.61,-521.38 4097.6,-521.62"/>
</g>
<!-- l4_qkv_gpu0&#45;&gt;l4_attn_stage0_gpu0 -->
<g id="edge913" class="edge">
<title>l4_qkv_gpu0&#45;&gt;l4_attn_stage0_gpu0</title>
<path fill="none" stroke="black" d="M1095.83,-2889.95C1109.88,-2872.33 1126.05,-2852.07 1140.03,-2834.57"/>
<polygon fill="black" stroke="black" points="1142.77,-2836.74 1146.27,-2826.74 1137.3,-2832.37 1142.77,-2836.74"/>
</g>
<!-- l4_qkv_gpu1&#45;&gt;l4_attn_stage0_gpu1 -->
<g id="edge914" class="edge">
<title>l4_qkv_gpu1&#45;&gt;l4_attn_stage0_gpu1</title>
<path fill="none" stroke="black" d="M1301.05,-2889.17C1312.93,-2872.18 1326.46,-2852.83 1338.31,-2835.89"/>
<polygon fill="black" stroke="black" points="1341.47,-2837.48 1344.33,-2827.28 1335.73,-2833.47 1341.47,-2837.48"/>
</g>
<!-- l4_qkv_gpu2&#45;&gt;l4_attn_stage0_gpu2 -->
<g id="edge915" class="edge">
<title>l4_qkv_gpu2&#45;&gt;l4_attn_stage0_gpu2</title>
<path fill="none" stroke="black" d="M1503.16,-2888.78C1513.74,-2871.95 1525.75,-2852.84 1536.29,-2836.07"/>
<polygon fill="black" stroke="black" points="1539.3,-2837.87 1541.66,-2827.54 1533.37,-2834.15 1539.3,-2837.87"/>
</g>
<!-- l4_qkv_gpu3&#45;&gt;l4_attn_stage0_gpu3 -->
<g id="edge916" class="edge">
<title>l4_qkv_gpu3&#45;&gt;l4_attn_stage0_gpu3</title>
<path fill="none" stroke="black" d="M1703.85,-2888.4C1713.31,-2871.87 1723.99,-2853.2 1733.42,-2836.71"/>
<polygon fill="black" stroke="black" points="1736.59,-2838.23 1738.51,-2827.81 1730.51,-2834.75 1736.59,-2838.23"/>
</g>
<!-- l4_qkv_gpu4&#45;&gt;l4_attn_stage0_gpu4 -->
<g id="edge917" class="edge">
<title>l4_qkv_gpu4&#45;&gt;l4_attn_stage0_gpu4</title>
<path fill="none" stroke="black" d="M1904.5,-2888.01C1912.86,-2871.79 1922.27,-2853.54 1930.62,-2837.34"/>
<polygon fill="black" stroke="black" points="1933.93,-2838.56 1935.4,-2828.07 1927.71,-2835.35 1933.93,-2838.56"/>
</g>
<!-- l4_qkv_gpu5&#45;&gt;l4_attn_stage0_gpu5 -->
<g id="edge918" class="edge">
<title>l4_qkv_gpu5&#45;&gt;l4_attn_stage0_gpu5</title>
<path fill="none" stroke="black" d="M2104.43,-2887.61C2111.98,-2871.42 2120.46,-2853.23 2127.97,-2837.1"/>
<polygon fill="black" stroke="black" points="2131.22,-2838.42 2132.28,-2827.88 2124.88,-2835.46 2131.22,-2838.42"/>
</g>
<!-- l4_qkv_gpu6&#45;&gt;l4_attn_stage0_gpu6 -->
<g id="edge919" class="edge">
<title>l4_qkv_gpu6&#45;&gt;l4_attn_stage0_gpu6</title>
<path fill="none" stroke="black" d="M2304.32,-2887.22C2310.94,-2871.33 2318.35,-2853.56 2324.95,-2837.72"/>
<polygon fill="black" stroke="black" points="2328.33,-2838.71 2328.94,-2828.13 2321.87,-2836.02 2328.33,-2838.71"/>
</g>
<!-- l4_qkv_gpu7&#45;&gt;l4_attn_stage0_gpu7 -->
<g id="edge920" class="edge">
<title>l4_qkv_gpu7&#45;&gt;l4_attn_stage0_gpu7</title>
<path fill="none" stroke="black" d="M2504.03,-2887.22C2509.86,-2871.33 2516.39,-2853.56 2522.21,-2837.72"/>
<polygon fill="black" stroke="black" points="2525.57,-2838.73 2525.73,-2828.13 2519,-2836.31 2525.57,-2838.73"/>
</g>
<!-- l4_qkv_gpu8&#45;&gt;l4_attn_stage0_gpu8 -->
<g id="edge921" class="edge">
<title>l4_qkv_gpu8&#45;&gt;l4_attn_stage0_gpu8</title>
<path fill="none" stroke="black" d="M2703.86,-2886.83C2708.82,-2871.24 2714.33,-2853.88 2719.28,-2838.32"/>
<polygon fill="black" stroke="black" points="2722.74,-2838.98 2722.43,-2828.39 2716.07,-2836.86 2722.74,-2838.98"/>
</g>
<!-- l4_qkv_gpu9&#45;&gt;l4_attn_stage0_gpu9 -->
<g id="edge922" class="edge">
<title>l4_qkv_gpu9&#45;&gt;l4_attn_stage0_gpu9</title>
<path fill="none" stroke="black" d="M2903.55,-2886.83C2907.73,-2871.24 2912.39,-2853.88 2916.57,-2838.32"/>
<polygon fill="black" stroke="black" points="2920.02,-2838.95 2919.23,-2828.39 2913.26,-2837.14 2920.02,-2838.95"/>
</g>
<!-- l4_qkv_gpu10&#45;&gt;l4_attn_stage0_gpu10 -->
<g id="edge923" class="edge">
<title>l4_qkv_gpu10&#45;&gt;l4_attn_stage0_gpu10</title>
<path fill="none" stroke="black" d="M3103.32,-2886.44C3106.7,-2871 3110.46,-2853.86 3113.83,-2838.47"/>
<polygon fill="black" stroke="black" points="3117.26,-2839.16 3115.98,-2828.64 3110.42,-2837.66 3117.26,-2839.16"/>
</g>
<!-- l4_qkv_gpu11&#45;&gt;l4_attn_stage0_gpu11 -->
<g id="edge924" class="edge">
<title>l4_qkv_gpu11&#45;&gt;l4_attn_stage0_gpu11</title>
<path fill="none" stroke="black" d="M3302.99,-2886.44C3305.58,-2871.14 3308.46,-2854.19 3311.05,-2838.91"/>
<polygon fill="black" stroke="black" points="3314.57,-2839.09 3312.79,-2828.64 3307.67,-2837.92 3314.57,-2839.09"/>
</g>
<!-- l4_qkv_gpu12&#45;&gt;l4_attn_stage0_gpu12 -->
<g id="edge925" class="edge">
<title>l4_qkv_gpu12&#45;&gt;l4_attn_stage0_gpu12</title>
<path fill="none" stroke="black" d="M3502.66,-2886.44C3504.5,-2871.14 3506.53,-2854.19 3508.37,-2838.91"/>
<polygon fill="black" stroke="black" points="3511.88,-2838.99 3509.6,-2828.64 3504.93,-2838.15 3511.88,-2838.99"/>
</g>
<!-- l4_qkv_gpu13&#45;&gt;l4_attn_stage0_gpu13 -->
<g id="edge926" class="edge">
<title>l4_qkv_gpu13&#45;&gt;l4_attn_stage0_gpu13</title>
<path fill="none" stroke="black" d="M3702.33,-2886.44C3703.41,-2871.14 3704.61,-2854.19 3705.69,-2838.91"/>
<polygon fill="black" stroke="black" points="3709.2,-2838.86 3706.41,-2828.64 3702.22,-2838.37 3709.2,-2838.86"/>
</g>
<!-- l4_qkv_gpu14&#45;&gt;l4_attn_stage0_gpu14 -->
<g id="edge927" class="edge">
<title>l4_qkv_gpu14&#45;&gt;l4_attn_stage0_gpu14</title>
<path fill="none" stroke="black" d="M3902,-2886.44C3902.32,-2871.14 3902.68,-2854.19 3903.01,-2838.91"/>
<polygon fill="black" stroke="black" points="3906.51,-2838.71 3903.22,-2828.64 3899.51,-2838.57 3906.51,-2838.71"/>
</g>
<!-- l4_qkv_gpu15&#45;&gt;l4_attn_stage0_gpu15 -->
<g id="edge928" class="edge">
<title>l4_qkv_gpu15&#45;&gt;l4_attn_stage0_gpu15</title>
<path fill="none" stroke="black" d="M4101.67,-2886.44C4101.24,-2871.14 4100.76,-2854.19 4100.33,-2838.91"/>
<polygon fill="black" stroke="black" points="4103.82,-2838.54 4100.04,-2828.64 4096.82,-2838.74 4103.82,-2838.54"/>
</g>
<!-- l4_mlp_h2_4h_gpu0 -->
<g id="node1265" class="node">
<title>l4_mlp_h2_4h_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="962" cy="-330.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="962" y="-349.05" font-family="Times,serif" font-size="14.00">L4 MLP h24h</text>
<text text-anchor="middle" x="962" y="-334.05" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="962" y="-319.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="962" y="-304.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l4_attn_out_gpu0&#45;&gt;l4_mlp_h2_4h_gpu0 -->
<g id="edge1185" class="edge">
<title>l4_attn_out_gpu0&#45;&gt;l4_mlp_h2_4h_gpu0</title>
<path fill="none" stroke="black" d="M967.11,-415.06C966.59,-406.52 966.04,-397.53 965.51,-388.73"/>
<polygon fill="black" stroke="black" points="968.99,-388.3 964.88,-378.53 962,-388.73 968.99,-388.3"/>
</g>
<!-- l4_mlp_h2_4h_gpu1 -->
<g id="node1267" class="node">
<title>l4_mlp_h2_4h_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1171" cy="-330.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1171" y="-349.05" font-family="Times,serif" font-size="14.00">L4 MLP h24h</text>
<text text-anchor="middle" x="1171" y="-334.05" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1171" y="-319.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1171" y="-304.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l4_attn_out_gpu1&#45;&gt;l4_mlp_h2_4h_gpu1 -->
<g id="edge1187" class="edge">
<title>l4_attn_out_gpu1&#45;&gt;l4_mlp_h2_4h_gpu1</title>
<path fill="none" stroke="black" d="M1172.28,-415.06C1172.15,-406.52 1172.01,-397.53 1171.88,-388.73"/>
<polygon fill="black" stroke="black" points="1175.37,-388.48 1171.72,-378.53 1168.37,-388.59 1175.37,-388.48"/>
</g>
<!-- l4_mlp_h2_4h_gpu2 -->
<g id="node1269" class="node">
<title>l4_mlp_h2_4h_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1376" cy="-330.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1376" y="-349.05" font-family="Times,serif" font-size="14.00">L4 MLP h24h</text>
<text text-anchor="middle" x="1376" y="-334.05" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1376" y="-319.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1376" y="-304.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l4_attn_out_gpu2&#45;&gt;l4_mlp_h2_4h_gpu2 -->
<g id="edge1189" class="edge">
<title>l4_attn_out_gpu2&#45;&gt;l4_mlp_h2_4h_gpu2</title>
<path fill="none" stroke="black" d="M1382.39,-415.06C1381.74,-406.52 1381.05,-397.53 1380.38,-388.73"/>
<polygon fill="black" stroke="black" points="1383.86,-388.24 1379.6,-378.53 1376.88,-388.77 1383.86,-388.24"/>
</g>
<!-- l4_mlp_h2_4h_gpu3 -->
<g id="node1271" class="node">
<title>l4_mlp_h2_4h_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1590" cy="-330.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1590" y="-349.05" font-family="Times,serif" font-size="14.00">L4 MLP h24h</text>
<text text-anchor="middle" x="1590" y="-334.05" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1590" y="-319.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1590" y="-304.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l4_attn_out_gpu3&#45;&gt;l4_mlp_h2_4h_gpu3 -->
<g id="edge1191" class="edge">
<title>l4_attn_out_gpu3&#45;&gt;l4_mlp_h2_4h_gpu3</title>
<path fill="none" stroke="black" d="M1591.28,-415.06C1591.15,-406.52 1591.01,-397.53 1590.88,-388.73"/>
<polygon fill="black" stroke="black" points="1594.37,-388.48 1590.72,-378.53 1587.37,-388.59 1594.37,-388.48"/>
</g>
<!-- l4_mlp_h2_4h_gpu4 -->
<g id="node1273" class="node">
<title>l4_mlp_h2_4h_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1797" cy="-330.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="1797" y="-349.05" font-family="Times,serif" font-size="14.00">L4 MLP h24h</text>
<text text-anchor="middle" x="1797" y="-334.05" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1797" y="-319.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1797" y="-304.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l4_attn_out_gpu4&#45;&gt;l4_mlp_h2_4h_gpu4 -->
<g id="edge1193" class="edge">
<title>l4_attn_out_gpu4&#45;&gt;l4_mlp_h2_4h_gpu4</title>
<path fill="none" stroke="black" d="M1800.83,-415.06C1800.44,-406.52 1800.03,-397.53 1799.63,-388.73"/>
<polygon fill="black" stroke="black" points="1803.12,-388.36 1799.16,-378.53 1796.12,-388.68 1803.12,-388.36"/>
</g>
<!-- l4_mlp_h2_4h_gpu5 -->
<g id="node1275" class="node">
<title>l4_mlp_h2_4h_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2007" cy="-330.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2007" y="-349.05" font-family="Times,serif" font-size="14.00">L4 MLP h24h</text>
<text text-anchor="middle" x="2007" y="-334.05" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2007" y="-319.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2007" y="-304.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l4_attn_out_gpu5&#45;&gt;l4_mlp_h2_4h_gpu5 -->
<g id="edge1195" class="edge">
<title>l4_attn_out_gpu5&#45;&gt;l4_mlp_h2_4h_gpu5</title>
<path fill="none" stroke="black" d="M2007.64,-415.06C2007.57,-406.52 2007.51,-397.53 2007.44,-388.73"/>
<polygon fill="black" stroke="black" points="2010.94,-388.51 2007.36,-378.53 2003.94,-388.56 2010.94,-388.51"/>
</g>
<!-- l4_mlp_h2_4h_gpu6 -->
<g id="node1277" class="node">
<title>l4_mlp_h2_4h_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2217" cy="-330.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2217" y="-349.05" font-family="Times,serif" font-size="14.00">L4 MLP h24h</text>
<text text-anchor="middle" x="2217" y="-334.05" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2217" y="-319.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2217" y="-304.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l4_attn_out_gpu6&#45;&gt;l4_mlp_h2_4h_gpu6 -->
<g id="edge1197" class="edge">
<title>l4_attn_out_gpu6&#45;&gt;l4_mlp_h2_4h_gpu6</title>
<path fill="none" stroke="black" d="M2217.64,-415.06C2217.57,-406.52 2217.51,-397.53 2217.44,-388.73"/>
<polygon fill="black" stroke="black" points="2220.94,-388.51 2217.36,-378.53 2213.94,-388.56 2220.94,-388.51"/>
</g>
<!-- l4_mlp_h2_4h_gpu7 -->
<g id="node1279" class="node">
<title>l4_mlp_h2_4h_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2428" cy="-330.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2428" y="-349.05" font-family="Times,serif" font-size="14.00">L4 MLP h24h</text>
<text text-anchor="middle" x="2428" y="-334.05" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2428" y="-319.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2428" y="-304.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l4_attn_out_gpu7&#45;&gt;l4_mlp_h2_4h_gpu7 -->
<g id="edge1199" class="edge">
<title>l4_attn_out_gpu7&#45;&gt;l4_mlp_h2_4h_gpu7</title>
<path fill="none" stroke="black" d="M2428,-415.06C2428,-406.52 2428,-397.53 2428,-388.73"/>
<polygon fill="black" stroke="black" points="2431.5,-388.53 2428,-378.53 2424.5,-388.53 2431.5,-388.53"/>
</g>
<!-- l4_mlp_h2_4h_gpu8 -->
<g id="node1281" class="node">
<title>l4_mlp_h2_4h_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2638" cy="-330.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2638" y="-349.05" font-family="Times,serif" font-size="14.00">L4 MLP h24h</text>
<text text-anchor="middle" x="2638" y="-334.05" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2638" y="-319.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2638" y="-304.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l4_attn_out_gpu8&#45;&gt;l4_mlp_h2_4h_gpu8 -->
<g id="edge1201" class="edge">
<title>l4_attn_out_gpu8&#45;&gt;l4_mlp_h2_4h_gpu8</title>
<path fill="none" stroke="black" d="M2637.36,-415.06C2637.43,-406.52 2637.49,-397.53 2637.56,-388.73"/>
<polygon fill="black" stroke="black" points="2641.06,-388.56 2637.64,-378.53 2634.06,-388.51 2641.06,-388.56"/>
</g>
<!-- l4_mlp_h2_4h_gpu9 -->
<g id="node1283" class="node">
<title>l4_mlp_h2_4h_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2847" cy="-330.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="2847" y="-349.05" font-family="Times,serif" font-size="14.00">L4 MLP h24h</text>
<text text-anchor="middle" x="2847" y="-334.05" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2847" y="-319.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="2847" y="-304.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l4_attn_out_gpu9&#45;&gt;l4_mlp_h2_4h_gpu9 -->
<g id="edge1203" class="edge">
<title>l4_attn_out_gpu9&#45;&gt;l4_mlp_h2_4h_gpu9</title>
<path fill="none" stroke="black" d="M2845.72,-415.06C2845.85,-406.52 2845.99,-397.53 2846.12,-388.73"/>
<polygon fill="black" stroke="black" points="2849.63,-388.59 2846.28,-378.53 2842.63,-388.48 2849.63,-388.59"/>
</g>
<!-- l4_mlp_h2_4h_gpu10 -->
<g id="node1285" class="node">
<title>l4_mlp_h2_4h_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3057" cy="-330.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3057" y="-349.05" font-family="Times,serif" font-size="14.00">L4 MLP h24h</text>
<text text-anchor="middle" x="3057" y="-334.05" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3057" y="-319.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3057" y="-304.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l4_attn_out_gpu10&#45;&gt;l4_mlp_h2_4h_gpu10 -->
<g id="edge1205" class="edge">
<title>l4_attn_out_gpu10&#45;&gt;l4_mlp_h2_4h_gpu10</title>
<path fill="none" stroke="black" d="M3055.08,-415.06C3055.28,-406.52 3055.48,-397.53 3055.69,-388.73"/>
<polygon fill="black" stroke="black" points="3059.19,-388.61 3055.92,-378.53 3052.19,-388.45 3059.19,-388.61"/>
</g>
<!-- l4_mlp_h2_4h_gpu11 -->
<g id="node1287" class="node">
<title>l4_mlp_h2_4h_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3266" cy="-330.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3266" y="-349.05" font-family="Times,serif" font-size="14.00">L4 MLP h24h</text>
<text text-anchor="middle" x="3266" y="-334.05" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3266" y="-319.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3266" y="-304.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l4_attn_out_gpu11&#45;&gt;l4_mlp_h2_4h_gpu11 -->
<g id="edge1207" class="edge">
<title>l4_attn_out_gpu11&#45;&gt;l4_mlp_h2_4h_gpu11</title>
<path fill="none" stroke="black" d="M3263.44,-415.06C3263.7,-406.52 3263.98,-397.53 3264.25,-388.73"/>
<polygon fill="black" stroke="black" points="3267.75,-388.64 3264.56,-378.53 3260.75,-388.42 3267.75,-388.64"/>
</g>
<!-- l4_mlp_h2_4h_gpu12 -->
<g id="node1289" class="node">
<title>l4_mlp_h2_4h_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3477" cy="-330.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3477" y="-349.05" font-family="Times,serif" font-size="14.00">L4 MLP h24h</text>
<text text-anchor="middle" x="3477" y="-334.05" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3477" y="-319.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3477" y="-304.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l4_attn_out_gpu12&#45;&gt;l4_mlp_h2_4h_gpu12 -->
<g id="edge1209" class="edge">
<title>l4_attn_out_gpu12&#45;&gt;l4_mlp_h2_4h_gpu12</title>
<path fill="none" stroke="black" d="M3473.81,-415.06C3474.13,-406.52 3474.47,-397.53 3474.81,-388.73"/>
<polygon fill="black" stroke="black" points="3478.31,-388.66 3475.2,-378.53 3471.32,-388.39 3478.31,-388.66"/>
</g>
<!-- l4_mlp_h2_4h_gpu13 -->
<g id="node1291" class="node">
<title>l4_mlp_h2_4h_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3688" cy="-330.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3688" y="-349.05" font-family="Times,serif" font-size="14.00">L4 MLP h24h</text>
<text text-anchor="middle" x="3688" y="-334.05" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3688" y="-319.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3688" y="-304.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l4_attn_out_gpu13&#45;&gt;l4_mlp_h2_4h_gpu13 -->
<g id="edge1211" class="edge">
<title>l4_attn_out_gpu13&#45;&gt;l4_mlp_h2_4h_gpu13</title>
<path fill="none" stroke="black" d="M3682.89,-415.06C3683.41,-406.52 3683.96,-397.53 3684.49,-388.73"/>
<polygon fill="black" stroke="black" points="3688,-388.73 3685.12,-378.53 3681.01,-388.3 3688,-388.73"/>
</g>
<!-- l4_mlp_h2_4h_gpu14 -->
<g id="node1293" class="node">
<title>l4_mlp_h2_4h_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3893" cy="-330.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="3893" y="-349.05" font-family="Times,serif" font-size="14.00">L4 MLP h24h</text>
<text text-anchor="middle" x="3893" y="-334.05" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3893" y="-319.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="3893" y="-304.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l4_attn_out_gpu14&#45;&gt;l4_mlp_h2_4h_gpu14 -->
<g id="edge1213" class="edge">
<title>l4_attn_out_gpu14&#45;&gt;l4_mlp_h2_4h_gpu14</title>
<path fill="none" stroke="black" d="M3889.81,-415.06C3890.13,-406.52 3890.47,-397.53 3890.81,-388.73"/>
<polygon fill="black" stroke="black" points="3894.31,-388.66 3891.2,-378.53 3887.32,-388.39 3894.31,-388.66"/>
</g>
<!-- l4_mlp_h2_4h_gpu15 -->
<g id="node1295" class="node">
<title>l4_mlp_h2_4h_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4097" cy="-330.25" rx="92" ry="48.17"/>
<text text-anchor="middle" x="4097" y="-349.05" font-family="Times,serif" font-size="14.00">L4 MLP h24h</text>
<text text-anchor="middle" x="4097" y="-334.05" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4097" y="-319.05" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="4097" y="-304.05" font-family="Times,serif" font-size="14.00">4h/16</text>
</g>
<!-- l4_attn_out_gpu15&#45;&gt;l4_mlp_h2_4h_gpu15 -->
<g id="edge1215" class="edge">
<title>l4_attn_out_gpu15&#45;&gt;l4_mlp_h2_4h_gpu15</title>
<path fill="none" stroke="black" d="M4096.36,-415.06C4096.43,-406.52 4096.49,-397.53 4096.56,-388.73"/>
<polygon fill="black" stroke="black" points="4100.06,-388.56 4096.64,-378.53 4093.06,-388.51 4100.06,-388.56"/>
</g>
<!-- l4_mlp_4h2_h_gpu0 -->
<g id="node1266" class="node">
<title>l4_mlp_4h2_h_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="959" cy="-197.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="959" y="-215.88" font-family="Times,serif" font-size="14.00">L4 MLP 4h2h</text>
<text text-anchor="middle" x="959" y="-200.88" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="959" y="-185.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="959" y="-170.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l4_mlp_h2_4h_gpu0&#45;&gt;l4_mlp_4h2_h_gpu0 -->
<g id="edge1186" class="edge">
<title>l4_mlp_h2_4h_gpu0&#45;&gt;l4_mlp_4h2_h_gpu0</title>
<path fill="none" stroke="black" d="M960.92,-281.9C960.72,-273.35 960.52,-264.36 960.31,-255.56"/>
<polygon fill="black" stroke="black" points="963.81,-255.29 960.08,-245.37 956.81,-255.45 963.81,-255.29"/>
</g>
<!-- output_gpu0 -->
<g id="node1297" class="node">
<title>output_gpu0</title>
<ellipse fill="#ff9999" stroke="black" cx="944" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="944" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="944" y="-49.8" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="944" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_mlp_4h2_h_gpu0&#45;&gt;output_gpu0 -->
<g id="edge2241" class="edge">
<title>l4_mlp_4h2_h_gpu0&#45;&gt;output_gpu0</title>
<path fill="none" stroke="black" d="M954.01,-148.94C952.38,-133.64 950.59,-116.69 948.97,-101.41"/>
<polygon fill="black" stroke="black" points="952.42,-100.72 947.88,-91.14 945.46,-101.46 952.42,-100.72"/>
</g>
<!-- l4_mlp_4h2_h_gpu1 -->
<g id="node1268" class="node">
<title>l4_mlp_4h2_h_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1161" cy="-197.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1161" y="-215.88" font-family="Times,serif" font-size="14.00">L4 MLP 4h2h</text>
<text text-anchor="middle" x="1161" y="-200.88" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1161" y="-185.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1161" y="-170.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l4_mlp_h2_4h_gpu1&#45;&gt;l4_mlp_4h2_h_gpu1 -->
<g id="edge1188" class="edge">
<title>l4_mlp_h2_4h_gpu1&#45;&gt;l4_mlp_4h2_h_gpu1</title>
<path fill="none" stroke="black" d="M1167.39,-281.9C1166.74,-273.35 1166.05,-264.36 1165.38,-255.56"/>
<polygon fill="black" stroke="black" points="1168.86,-255.07 1164.6,-245.37 1161.88,-255.61 1168.86,-255.07"/>
</g>
<!-- output_gpu1 -->
<g id="node1298" class="node">
<title>output_gpu1</title>
<ellipse fill="#ffcc99" stroke="black" cx="1156" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="1156" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="1156" y="-49.8" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="1156" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_mlp_4h2_h_gpu1&#45;&gt;output_gpu1 -->
<g id="edge2242" class="edge">
<title>l4_mlp_4h2_h_gpu1&#45;&gt;output_gpu1</title>
<path fill="none" stroke="black" d="M1159.34,-148.94C1158.79,-133.64 1158.2,-116.69 1157.66,-101.41"/>
<polygon fill="black" stroke="black" points="1161.14,-101.01 1157.29,-91.14 1154.15,-101.26 1161.14,-101.01"/>
</g>
<!-- l4_mlp_4h2_h_gpu2 -->
<g id="node1270" class="node">
<title>l4_mlp_4h2_h_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1371" cy="-197.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1371" y="-215.88" font-family="Times,serif" font-size="14.00">L4 MLP 4h2h</text>
<text text-anchor="middle" x="1371" y="-200.88" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1371" y="-185.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1371" y="-170.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l4_mlp_h2_4h_gpu2&#45;&gt;l4_mlp_4h2_h_gpu2 -->
<g id="edge1190" class="edge">
<title>l4_mlp_h2_4h_gpu2&#45;&gt;l4_mlp_4h2_h_gpu2</title>
<path fill="none" stroke="black" d="M1374.19,-281.9C1373.87,-273.35 1373.53,-264.36 1373.19,-255.56"/>
<polygon fill="black" stroke="black" points="1376.68,-255.23 1372.8,-245.37 1369.69,-255.49 1376.68,-255.23"/>
</g>
<!-- output_gpu2 -->
<g id="node1299" class="node">
<title>output_gpu2</title>
<ellipse fill="#ffff99" stroke="black" cx="1368" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="1368" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="1368" y="-49.8" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1368" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_mlp_4h2_h_gpu2&#45;&gt;output_gpu2 -->
<g id="edge2243" class="edge">
<title>l4_mlp_4h2_h_gpu2&#45;&gt;output_gpu2</title>
<path fill="none" stroke="black" d="M1370,-148.94C1369.68,-133.64 1369.32,-116.69 1368.99,-101.41"/>
<polygon fill="black" stroke="black" points="1372.49,-101.07 1368.78,-91.14 1365.49,-101.21 1372.49,-101.07"/>
</g>
<!-- l4_mlp_4h2_h_gpu3 -->
<g id="node1272" class="node">
<title>l4_mlp_4h2_h_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1585" cy="-197.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1585" y="-215.88" font-family="Times,serif" font-size="14.00">L4 MLP 4h2h</text>
<text text-anchor="middle" x="1585" y="-200.88" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1585" y="-185.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1585" y="-170.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l4_mlp_h2_4h_gpu3&#45;&gt;l4_mlp_4h2_h_gpu3 -->
<g id="edge1192" class="edge">
<title>l4_mlp_h2_4h_gpu3&#45;&gt;l4_mlp_4h2_h_gpu3</title>
<path fill="none" stroke="black" d="M1588.19,-281.9C1587.87,-273.35 1587.53,-264.36 1587.19,-255.56"/>
<polygon fill="black" stroke="black" points="1590.68,-255.23 1586.8,-245.37 1583.69,-255.49 1590.68,-255.23"/>
</g>
<!-- output_gpu3 -->
<g id="node1300" class="node">
<title>output_gpu3</title>
<ellipse fill="#99ff99" stroke="black" cx="1580" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="1580" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="1580" y="-49.8" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1580" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_mlp_4h2_h_gpu3&#45;&gt;output_gpu3 -->
<g id="edge2244" class="edge">
<title>l4_mlp_4h2_h_gpu3&#45;&gt;output_gpu3</title>
<path fill="none" stroke="black" d="M1583.34,-148.94C1582.79,-133.64 1582.2,-116.69 1581.66,-101.41"/>
<polygon fill="black" stroke="black" points="1585.14,-101.01 1581.29,-91.14 1578.15,-101.26 1585.14,-101.01"/>
</g>
<!-- l4_mlp_4h2_h_gpu4 -->
<g id="node1274" class="node">
<title>l4_mlp_4h2_h_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1793" cy="-197.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="1793" y="-215.88" font-family="Times,serif" font-size="14.00">L4 MLP 4h2h</text>
<text text-anchor="middle" x="1793" y="-200.88" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1793" y="-185.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1793" y="-170.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l4_mlp_h2_4h_gpu4&#45;&gt;l4_mlp_4h2_h_gpu4 -->
<g id="edge1194" class="edge">
<title>l4_mlp_h2_4h_gpu4&#45;&gt;l4_mlp_4h2_h_gpu4</title>
<path fill="none" stroke="black" d="M1795.56,-281.9C1795.3,-273.35 1795.02,-264.36 1794.75,-255.56"/>
<polygon fill="black" stroke="black" points="1798.25,-255.26 1794.44,-245.37 1791.25,-255.47 1798.25,-255.26"/>
</g>
<!-- output_gpu4 -->
<g id="node1301" class="node">
<title>output_gpu4</title>
<ellipse fill="#99ccff" stroke="black" cx="1792" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="1792" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="1792" y="-49.8" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1792" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_mlp_4h2_h_gpu4&#45;&gt;output_gpu4 -->
<g id="edge2245" class="edge">
<title>l4_mlp_4h2_h_gpu4&#45;&gt;output_gpu4</title>
<path fill="none" stroke="black" d="M1792.67,-148.94C1792.56,-133.64 1792.44,-116.69 1792.33,-101.41"/>
<polygon fill="black" stroke="black" points="1795.83,-101.12 1792.26,-91.14 1788.83,-101.17 1795.83,-101.12"/>
</g>
<!-- l4_mlp_4h2_h_gpu5 -->
<g id="node1276" class="node">
<title>l4_mlp_4h2_h_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2005" cy="-197.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2005" y="-215.88" font-family="Times,serif" font-size="14.00">L4 MLP 4h2h</text>
<text text-anchor="middle" x="2005" y="-200.88" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2005" y="-185.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2005" y="-170.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l4_mlp_h2_4h_gpu5&#45;&gt;l4_mlp_4h2_h_gpu5 -->
<g id="edge1196" class="edge">
<title>l4_mlp_h2_4h_gpu5&#45;&gt;l4_mlp_4h2_h_gpu5</title>
<path fill="none" stroke="black" d="M2006.28,-281.9C2006.15,-273.35 2006.01,-264.36 2005.88,-255.56"/>
<polygon fill="black" stroke="black" points="2009.37,-255.31 2005.72,-245.37 2002.37,-255.42 2009.37,-255.31"/>
</g>
<!-- output_gpu5 -->
<g id="node1302" class="node">
<title>output_gpu5</title>
<ellipse fill="#cc99ff" stroke="black" cx="2004" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="2004" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="2004" y="-49.8" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="2004" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_mlp_4h2_h_gpu5&#45;&gt;output_gpu5 -->
<g id="edge2246" class="edge">
<title>l4_mlp_4h2_h_gpu5&#45;&gt;output_gpu5</title>
<path fill="none" stroke="black" d="M2004.67,-148.94C2004.56,-133.64 2004.44,-116.69 2004.33,-101.41"/>
<polygon fill="black" stroke="black" points="2007.83,-101.12 2004.26,-91.14 2000.83,-101.17 2007.83,-101.12"/>
</g>
<!-- l4_mlp_4h2_h_gpu6 -->
<g id="node1278" class="node">
<title>l4_mlp_4h2_h_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2216" cy="-197.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2216" y="-215.88" font-family="Times,serif" font-size="14.00">L4 MLP 4h2h</text>
<text text-anchor="middle" x="2216" y="-200.88" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2216" y="-185.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2216" y="-170.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l4_mlp_h2_4h_gpu6&#45;&gt;l4_mlp_4h2_h_gpu6 -->
<g id="edge1198" class="edge">
<title>l4_mlp_h2_4h_gpu6&#45;&gt;l4_mlp_4h2_h_gpu6</title>
<path fill="none" stroke="black" d="M2216.64,-281.9C2216.57,-273.35 2216.51,-264.36 2216.44,-255.56"/>
<polygon fill="black" stroke="black" points="2219.94,-255.34 2216.36,-245.37 2212.94,-255.39 2219.94,-255.34"/>
</g>
<!-- output_gpu6 -->
<g id="node1303" class="node">
<title>output_gpu6</title>
<ellipse fill="#ff99cc" stroke="black" cx="2216" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="2216" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="2216" y="-49.8" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="2216" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_mlp_4h2_h_gpu6&#45;&gt;output_gpu6 -->
<g id="edge2247" class="edge">
<title>l4_mlp_4h2_h_gpu6&#45;&gt;output_gpu6</title>
<path fill="none" stroke="black" d="M2216,-148.94C2216,-133.64 2216,-116.69 2216,-101.41"/>
<polygon fill="black" stroke="black" points="2219.5,-101.14 2216,-91.14 2212.5,-101.14 2219.5,-101.14"/>
</g>
<!-- l4_mlp_4h2_h_gpu7 -->
<g id="node1280" class="node">
<title>l4_mlp_4h2_h_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2428" cy="-197.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2428" y="-215.88" font-family="Times,serif" font-size="14.00">L4 MLP 4h2h</text>
<text text-anchor="middle" x="2428" y="-200.88" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2428" y="-185.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2428" y="-170.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l4_mlp_h2_4h_gpu7&#45;&gt;l4_mlp_4h2_h_gpu7 -->
<g id="edge1200" class="edge">
<title>l4_mlp_h2_4h_gpu7&#45;&gt;l4_mlp_4h2_h_gpu7</title>
<path fill="none" stroke="black" d="M2428,-281.9C2428,-273.35 2428,-264.36 2428,-255.56"/>
<polygon fill="black" stroke="black" points="2431.5,-255.37 2428,-245.37 2424.5,-255.37 2431.5,-255.37"/>
</g>
<!-- output_gpu7 -->
<g id="node1304" class="node">
<title>output_gpu7</title>
<ellipse fill="#99ffcc" stroke="black" cx="2428" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="2428" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="2428" y="-49.8" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="2428" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_mlp_4h2_h_gpu7&#45;&gt;output_gpu7 -->
<g id="edge2248" class="edge">
<title>l4_mlp_4h2_h_gpu7&#45;&gt;output_gpu7</title>
<path fill="none" stroke="black" d="M2428,-148.94C2428,-133.64 2428,-116.69 2428,-101.41"/>
<polygon fill="black" stroke="black" points="2431.5,-101.14 2428,-91.14 2424.5,-101.14 2431.5,-101.14"/>
</g>
<!-- l4_mlp_4h2_h_gpu8 -->
<g id="node1282" class="node">
<title>l4_mlp_4h2_h_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2640" cy="-197.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2640" y="-215.88" font-family="Times,serif" font-size="14.00">L4 MLP 4h2h</text>
<text text-anchor="middle" x="2640" y="-200.88" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2640" y="-185.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2640" y="-170.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l4_mlp_h2_4h_gpu8&#45;&gt;l4_mlp_4h2_h_gpu8 -->
<g id="edge1202" class="edge">
<title>l4_mlp_h2_4h_gpu8&#45;&gt;l4_mlp_4h2_h_gpu8</title>
<path fill="none" stroke="black" d="M2638.72,-281.9C2638.85,-273.35 2638.99,-264.36 2639.12,-255.56"/>
<polygon fill="black" stroke="black" points="2642.63,-255.42 2639.28,-245.37 2635.63,-255.31 2642.63,-255.42"/>
</g>
<!-- output_gpu8 -->
<g id="node1305" class="node">
<title>output_gpu8</title>
<ellipse fill="#ff6666" stroke="black" cx="2640" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="2640" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="2640" y="-49.8" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="2640" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_mlp_4h2_h_gpu8&#45;&gt;output_gpu8 -->
<g id="edge2249" class="edge">
<title>l4_mlp_4h2_h_gpu8&#45;&gt;output_gpu8</title>
<path fill="none" stroke="black" d="M2640,-148.94C2640,-133.64 2640,-116.69 2640,-101.41"/>
<polygon fill="black" stroke="black" points="2643.5,-101.14 2640,-91.14 2636.5,-101.14 2643.5,-101.14"/>
</g>
<!-- l4_mlp_4h2_h_gpu9 -->
<g id="node1284" class="node">
<title>l4_mlp_4h2_h_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2851" cy="-197.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="2851" y="-215.88" font-family="Times,serif" font-size="14.00">L4 MLP 4h2h</text>
<text text-anchor="middle" x="2851" y="-200.88" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2851" y="-185.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="2851" y="-170.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l4_mlp_h2_4h_gpu9&#45;&gt;l4_mlp_4h2_h_gpu9 -->
<g id="edge1204" class="edge">
<title>l4_mlp_h2_4h_gpu9&#45;&gt;l4_mlp_4h2_h_gpu9</title>
<path fill="none" stroke="black" d="M2848.44,-281.9C2848.7,-273.35 2848.98,-264.36 2849.25,-255.56"/>
<polygon fill="black" stroke="black" points="2852.75,-255.47 2849.56,-245.37 2845.75,-255.26 2852.75,-255.47"/>
</g>
<!-- output_gpu9 -->
<g id="node1306" class="node">
<title>output_gpu9</title>
<ellipse fill="#ff9966" stroke="black" cx="2852" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="2852" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="2852" y="-49.8" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="2852" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_mlp_4h2_h_gpu9&#45;&gt;output_gpu9 -->
<g id="edge2250" class="edge">
<title>l4_mlp_4h2_h_gpu9&#45;&gt;output_gpu9</title>
<path fill="none" stroke="black" d="M2851.33,-148.94C2851.44,-133.64 2851.56,-116.69 2851.67,-101.41"/>
<polygon fill="black" stroke="black" points="2855.17,-101.17 2851.74,-91.14 2848.17,-101.12 2855.17,-101.17"/>
</g>
<!-- l4_mlp_4h2_h_gpu10 -->
<g id="node1286" class="node">
<title>l4_mlp_4h2_h_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3063" cy="-197.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3063" y="-215.88" font-family="Times,serif" font-size="14.00">L4 MLP 4h2h</text>
<text text-anchor="middle" x="3063" y="-200.88" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3063" y="-185.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3063" y="-170.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l4_mlp_h2_4h_gpu10&#45;&gt;l4_mlp_4h2_h_gpu10 -->
<g id="edge1206" class="edge">
<title>l4_mlp_h2_4h_gpu10&#45;&gt;l4_mlp_4h2_h_gpu10</title>
<path fill="none" stroke="black" d="M3059.17,-281.9C3059.56,-273.35 3059.97,-264.36 3060.37,-255.56"/>
<polygon fill="black" stroke="black" points="3063.88,-255.52 3060.84,-245.37 3056.88,-255.2 3063.88,-255.52"/>
</g>
<!-- output_gpu10 -->
<g id="node1307" class="node">
<title>output_gpu10</title>
<ellipse fill="#ffff66" stroke="black" cx="3064" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="3064" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="3064" y="-49.8" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="3064" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_mlp_4h2_h_gpu10&#45;&gt;output_gpu10 -->
<g id="edge2251" class="edge">
<title>l4_mlp_4h2_h_gpu10&#45;&gt;output_gpu10</title>
<path fill="none" stroke="black" d="M3063.33,-148.94C3063.44,-133.64 3063.56,-116.69 3063.67,-101.41"/>
<polygon fill="black" stroke="black" points="3067.17,-101.17 3063.74,-91.14 3060.17,-101.12 3067.17,-101.17"/>
</g>
<!-- l4_mlp_4h2_h_gpu11 -->
<g id="node1288" class="node">
<title>l4_mlp_4h2_h_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3274" cy="-197.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3274" y="-215.88" font-family="Times,serif" font-size="14.00">L4 MLP 4h2h</text>
<text text-anchor="middle" x="3274" y="-200.88" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3274" y="-185.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3274" y="-170.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l4_mlp_h2_4h_gpu11&#45;&gt;l4_mlp_4h2_h_gpu11 -->
<g id="edge1208" class="edge">
<title>l4_mlp_h2_4h_gpu11&#45;&gt;l4_mlp_4h2_h_gpu11</title>
<path fill="none" stroke="black" d="M3268.89,-281.9C3269.41,-273.35 3269.96,-264.36 3270.49,-255.56"/>
<polygon fill="black" stroke="black" points="3274,-255.56 3271.12,-245.37 3267.01,-255.14 3274,-255.56"/>
</g>
<!-- output_gpu11 -->
<g id="node1308" class="node">
<title>output_gpu11</title>
<ellipse fill="#66ff66" stroke="black" cx="3276" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="3276" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="3276" y="-49.8" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="3276" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_mlp_4h2_h_gpu11&#45;&gt;output_gpu11 -->
<g id="edge2252" class="edge">
<title>l4_mlp_4h2_h_gpu11&#45;&gt;output_gpu11</title>
<path fill="none" stroke="black" d="M3274.67,-148.94C3274.88,-133.64 3275.12,-116.69 3275.34,-101.41"/>
<polygon fill="black" stroke="black" points="3278.84,-101.19 3275.48,-91.14 3271.84,-101.09 3278.84,-101.19"/>
</g>
<!-- l4_mlp_4h2_h_gpu12 -->
<g id="node1290" class="node">
<title>l4_mlp_4h2_h_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3479" cy="-197.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3479" y="-215.88" font-family="Times,serif" font-size="14.00">L4 MLP 4h2h</text>
<text text-anchor="middle" x="3479" y="-200.88" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3479" y="-185.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3479" y="-170.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l4_mlp_h2_4h_gpu12&#45;&gt;l4_mlp_4h2_h_gpu12 -->
<g id="edge1210" class="edge">
<title>l4_mlp_h2_4h_gpu12&#45;&gt;l4_mlp_4h2_h_gpu12</title>
<path fill="none" stroke="black" d="M3477.72,-281.9C3477.85,-273.35 3477.99,-264.36 3478.12,-255.56"/>
<polygon fill="black" stroke="black" points="3481.63,-255.42 3478.28,-245.37 3474.63,-255.31 3481.63,-255.42"/>
</g>
<!-- output_gpu12 -->
<g id="node1309" class="node">
<title>output_gpu12</title>
<ellipse fill="#6699ff" stroke="black" cx="3488" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="3488" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="3488" y="-49.8" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3488" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_mlp_4h2_h_gpu12&#45;&gt;output_gpu12 -->
<g id="edge2253" class="edge">
<title>l4_mlp_4h2_h_gpu12&#45;&gt;output_gpu12</title>
<path fill="none" stroke="black" d="M3482,-148.94C3482.97,-133.64 3484.05,-116.69 3485.02,-101.41"/>
<polygon fill="black" stroke="black" points="3488.53,-101.34 3485.67,-91.14 3481.54,-100.9 3488.53,-101.34"/>
</g>
<!-- l4_mlp_4h2_h_gpu13 -->
<g id="node1292" class="node">
<title>l4_mlp_4h2_h_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3691" cy="-197.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3691" y="-215.88" font-family="Times,serif" font-size="14.00">L4 MLP 4h2h</text>
<text text-anchor="middle" x="3691" y="-200.88" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3691" y="-185.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3691" y="-170.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l4_mlp_h2_4h_gpu13&#45;&gt;l4_mlp_4h2_h_gpu13 -->
<g id="edge1212" class="edge">
<title>l4_mlp_h2_4h_gpu13&#45;&gt;l4_mlp_4h2_h_gpu13</title>
<path fill="none" stroke="black" d="M3689.08,-281.9C3689.28,-273.35 3689.48,-264.36 3689.69,-255.56"/>
<polygon fill="black" stroke="black" points="3693.19,-255.45 3689.92,-245.37 3686.19,-255.29 3693.19,-255.45"/>
</g>
<!-- output_gpu13 -->
<g id="node1310" class="node">
<title>output_gpu13</title>
<ellipse fill="#9966ff" stroke="black" cx="3700" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="3700" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="3700" y="-49.8" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3700" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_mlp_4h2_h_gpu13&#45;&gt;output_gpu13 -->
<g id="edge2254" class="edge">
<title>l4_mlp_4h2_h_gpu13&#45;&gt;output_gpu13</title>
<path fill="none" stroke="black" d="M3694,-148.94C3694.97,-133.64 3696.05,-116.69 3697.02,-101.41"/>
<polygon fill="black" stroke="black" points="3700.53,-101.34 3697.67,-91.14 3693.54,-100.9 3700.53,-101.34"/>
</g>
<!-- l4_mlp_4h2_h_gpu14 -->
<g id="node1294" class="node">
<title>l4_mlp_4h2_h_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3905" cy="-197.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="3905" y="-215.88" font-family="Times,serif" font-size="14.00">L4 MLP 4h2h</text>
<text text-anchor="middle" x="3905" y="-200.88" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3905" y="-185.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="3905" y="-170.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l4_mlp_h2_4h_gpu14&#45;&gt;l4_mlp_4h2_h_gpu14 -->
<g id="edge1214" class="edge">
<title>l4_mlp_h2_4h_gpu14&#45;&gt;l4_mlp_4h2_h_gpu14</title>
<path fill="none" stroke="black" d="M3897.33,-281.9C3898.11,-273.35 3898.94,-264.36 3899.74,-255.56"/>
<polygon fill="black" stroke="black" points="3903.25,-255.65 3900.67,-245.37 3896.28,-255.01 3903.25,-255.65"/>
</g>
<!-- output_gpu14 -->
<g id="node1311" class="node">
<title>output_gpu14</title>
<ellipse fill="#ff66cc" stroke="black" cx="3912" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="3912" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="3912" y="-49.8" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3912" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_mlp_4h2_h_gpu14&#45;&gt;output_gpu14 -->
<g id="edge2255" class="edge">
<title>l4_mlp_4h2_h_gpu14&#45;&gt;output_gpu14</title>
<path fill="none" stroke="black" d="M3907.33,-148.94C3908.09,-133.64 3908.93,-116.69 3909.68,-101.41"/>
<polygon fill="black" stroke="black" points="3913.19,-101.3 3910.19,-91.14 3906.2,-100.96 3913.19,-101.3"/>
</g>
<!-- l4_mlp_4h2_h_gpu15 -->
<g id="node1296" class="node">
<title>l4_mlp_4h2_h_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4106" cy="-197.08" rx="88.5" ry="48.17"/>
<text text-anchor="middle" x="4106" y="-215.88" font-family="Times,serif" font-size="14.00">L4 MLP 4h2h</text>
<text text-anchor="middle" x="4106" y="-200.88" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4106" y="-185.88" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="4106" y="-170.88" font-family="Times,serif" font-size="14.00">h</text>
</g>
<!-- l4_mlp_h2_4h_gpu15&#45;&gt;l4_mlp_4h2_h_gpu15 -->
<g id="edge1216" class="edge">
<title>l4_mlp_h2_4h_gpu15&#45;&gt;l4_mlp_4h2_h_gpu15</title>
<path fill="none" stroke="black" d="M4100.25,-281.9C4100.84,-273.35 4101.45,-264.36 4102.06,-255.56"/>
<polygon fill="black" stroke="black" points="4105.56,-255.58 4102.76,-245.37 4098.58,-255.1 4105.56,-255.58"/>
</g>
<!-- output_gpu15 -->
<g id="node1312" class="node">
<title>output_gpu15</title>
<ellipse fill="#66ffcc" stroke="black" cx="4124" cy="-53.5" rx="97" ry="37.5"/>
<text text-anchor="middle" x="4124" y="-64.8" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="4124" y="-49.8" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4124" y="-34.8" font-family="Times,serif" font-size="14.00">Gather sequence</text>
</g>
<!-- l4_mlp_4h2_h_gpu15&#45;&gt;output_gpu15 -->
<g id="edge2256" class="edge">
<title>l4_mlp_4h2_h_gpu15&#45;&gt;output_gpu15</title>
<path fill="none" stroke="black" d="M4111.99,-148.94C4113.94,-133.64 4116.09,-116.69 4118.04,-101.41"/>
<polygon fill="black" stroke="black" points="4121.55,-101.5 4119.34,-91.14 4114.61,-100.62 4121.55,-101.5"/>
</g>
</g>
</svg>
