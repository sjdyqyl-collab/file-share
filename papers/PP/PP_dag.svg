<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: LayerWiseDeployment Pages: 1 -->
<svg width="53530pt" height="417pt"
 viewBox="0.00 0.00 53530.05 417.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 413)">
<title>LayerWiseDeployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-413 53526.05,-413 53526.05,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_gpu_0</title>
<path fill="#ff6b6b" fill-opacity="0.125490" stroke="#ff6b6b" d="M490,-8C490,-8 3534.82,-8 3534.82,-8 3540.82,-8 3546.82,-14 3546.82,-20 3546.82,-20 3546.82,-123 3546.82,-123 3546.82,-129 3540.82,-135 3534.82,-135 3534.82,-135 490,-135 490,-135 484,-135 478,-129 478,-123 478,-123 478,-20 478,-20 478,-14 484,-8 490,-8"/>
<text text-anchor="middle" x="2012.41" y="-119.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu_1</title>
<path fill="#4ecdc4" fill-opacity="0.125490" stroke="#4ecdc4" d="M3789.82,-15C3789.82,-15 6834.63,-15 6834.63,-15 6840.63,-15 6846.63,-21 6846.63,-27 6846.63,-27 6846.63,-130 6846.63,-130 6846.63,-136 6840.63,-142 6834.63,-142 6834.63,-142 3789.82,-142 3789.82,-142 3783.82,-142 3777.82,-136 3777.82,-130 3777.82,-130 3777.82,-27 3777.82,-27 3777.82,-21 3783.82,-15 3789.82,-15"/>
<text text-anchor="middle" x="5312.23" y="-126.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu_2</title>
<path fill="#45b7d1" fill-opacity="0.125490" stroke="#45b7d1" d="M7089.63,-22C7089.63,-22 10134.45,-22 10134.45,-22 10140.45,-22 10146.45,-28 10146.45,-34 10146.45,-34 10146.45,-137 10146.45,-137 10146.45,-143 10140.45,-149 10134.45,-149 10134.45,-149 7089.63,-149 7089.63,-149 7083.63,-149 7077.63,-143 7077.63,-137 7077.63,-137 7077.63,-34 7077.63,-34 7077.63,-28 7083.63,-22 7089.63,-22"/>
<text text-anchor="middle" x="8612.04" y="-133.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_gpu_3</title>
<path fill="#96ceb4" fill-opacity="0.125490" stroke="#96ceb4" d="M10389.45,-29C10389.45,-29 13434.26,-29 13434.26,-29 13440.26,-29 13446.26,-35 13446.26,-41 13446.26,-41 13446.26,-144 13446.26,-144 13446.26,-150 13440.26,-156 13434.26,-156 13434.26,-156 10389.45,-156 10389.45,-156 10383.45,-156 10377.45,-150 10377.45,-144 10377.45,-144 10377.45,-41 10377.45,-41 10377.45,-35 10383.45,-29 10389.45,-29"/>
<text text-anchor="middle" x="11911.86" y="-140.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_gpu_4</title>
<path fill="#feca57" fill-opacity="0.125490" stroke="#feca57" d="M13689.26,-36C13689.26,-36 16734.08,-36 16734.08,-36 16740.08,-36 16746.08,-42 16746.08,-48 16746.08,-48 16746.08,-151 16746.08,-151 16746.08,-157 16740.08,-163 16734.08,-163 16734.08,-163 13689.26,-163 13689.26,-163 13683.26,-163 13677.26,-157 13677.26,-151 13677.26,-151 13677.26,-48 13677.26,-48 13677.26,-42 13683.26,-36 13689.26,-36"/>
<text text-anchor="middle" x="15211.67" y="-147.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_gpu_5</title>
<path fill="#ff9ff3" fill-opacity="0.125490" stroke="#ff9ff3" d="M16989.08,-43C16989.08,-43 20033.89,-43 20033.89,-43 20039.89,-43 20045.89,-49 20045.89,-55 20045.89,-55 20045.89,-158 20045.89,-158 20045.89,-164 20039.89,-170 20033.89,-170 20033.89,-170 16989.08,-170 16989.08,-170 16983.08,-170 16977.08,-164 16977.08,-158 16977.08,-158 16977.08,-55 16977.08,-55 16977.08,-49 16983.08,-43 16989.08,-43"/>
<text text-anchor="middle" x="18511.49" y="-154.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_gpu_6</title>
<path fill="#54a0ff" fill-opacity="0.125490" stroke="#54a0ff" d="M20288.89,-50C20288.89,-50 23333.71,-50 23333.71,-50 23339.71,-50 23345.71,-56 23345.71,-62 23345.71,-62 23345.71,-165 23345.71,-165 23345.71,-171 23339.71,-177 23333.71,-177 23333.71,-177 20288.89,-177 20288.89,-177 20282.89,-177 20276.89,-171 20276.89,-165 20276.89,-165 20276.89,-62 20276.89,-62 20276.89,-56 20282.89,-50 20288.89,-50"/>
<text text-anchor="middle" x="21811.3" y="-161.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_gpu_7</title>
<path fill="#5f27cd" fill-opacity="0.125490" stroke="#5f27cd" d="M23588.71,-57C23588.71,-57 26633.53,-57 26633.53,-57 26639.53,-57 26645.53,-63 26645.53,-69 26645.53,-69 26645.53,-172 26645.53,-172 26645.53,-178 26639.53,-184 26633.53,-184 26633.53,-184 23588.71,-184 23588.71,-184 23582.71,-184 23576.71,-178 23576.71,-172 23576.71,-172 23576.71,-69 23576.71,-69 23576.71,-63 23582.71,-57 23588.71,-57"/>
<text text-anchor="middle" x="25111.12" y="-168.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_gpu_8</title>
<path fill="#00d2d3" fill-opacity="0.125490" stroke="#00d2d3" d="M26888.53,-64C26888.53,-64 29933.34,-64 29933.34,-64 29939.34,-64 29945.34,-70 29945.34,-76 29945.34,-76 29945.34,-179 29945.34,-179 29945.34,-185 29939.34,-191 29933.34,-191 29933.34,-191 26888.53,-191 26888.53,-191 26882.53,-191 26876.53,-185 26876.53,-179 26876.53,-179 26876.53,-76 26876.53,-76 26876.53,-70 26882.53,-64 26888.53,-64"/>
<text text-anchor="middle" x="28410.93" y="-175.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_gpu_9</title>
<path fill="#ff9f43" fill-opacity="0.125490" stroke="#ff9f43" d="M30188.34,-71C30188.34,-71 33233.16,-71 33233.16,-71 33239.16,-71 33245.16,-77 33245.16,-83 33245.16,-83 33245.16,-186 33245.16,-186 33245.16,-192 33239.16,-198 33233.16,-198 33233.16,-198 30188.34,-198 30188.34,-198 30182.34,-198 30176.34,-192 30176.34,-186 30176.34,-186 30176.34,-83 30176.34,-83 30176.34,-77 30182.34,-71 30188.34,-71"/>
<text text-anchor="middle" x="31710.75" y="-182.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_gpu_10</title>
<path fill="#ee5a24" fill-opacity="0.125490" stroke="#ee5a24" d="M33488.16,-78C33488.16,-78 36532.97,-78 36532.97,-78 36538.97,-78 36544.97,-84 36544.97,-90 36544.97,-90 36544.97,-193 36544.97,-193 36544.97,-199 36538.97,-205 36532.97,-205 36532.97,-205 33488.16,-205 33488.16,-205 33482.16,-205 33476.16,-199 33476.16,-193 33476.16,-193 33476.16,-90 33476.16,-90 33476.16,-84 33482.16,-78 33488.16,-78"/>
<text text-anchor="middle" x="35010.56" y="-189.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_gpu_11</title>
<path fill="#009432" fill-opacity="0.125490" stroke="#009432" d="M36787.97,-85C36787.97,-85 39832.79,-85 39832.79,-85 39838.79,-85 39844.79,-91 39844.79,-97 39844.79,-97 39844.79,-200 39844.79,-200 39844.79,-206 39838.79,-212 39832.79,-212 39832.79,-212 36787.97,-212 36787.97,-212 36781.97,-212 36775.97,-206 36775.97,-200 36775.97,-200 36775.97,-97 36775.97,-97 36775.97,-91 36781.97,-85 36787.97,-85"/>
<text text-anchor="middle" x="38310.38" y="-196.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_gpu_12</title>
<path fill="#0652dd" fill-opacity="0.125490" stroke="#0652dd" d="M40087.79,-92C40087.79,-92 43132.6,-92 43132.6,-92 43138.6,-92 43144.6,-98 43144.6,-104 43144.6,-104 43144.6,-207 43144.6,-207 43144.6,-213 43138.6,-219 43132.6,-219 43132.6,-219 40087.79,-219 40087.79,-219 40081.79,-219 40075.79,-213 40075.79,-207 40075.79,-207 40075.79,-104 40075.79,-104 40075.79,-98 40081.79,-92 40087.79,-92"/>
<text text-anchor="middle" x="41610.19" y="-203.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_gpu_13</title>
<path fill="#9980fa" fill-opacity="0.125490" stroke="#9980fa" d="M43387.6,-99C43387.6,-99 46432.42,-99 46432.42,-99 46438.42,-99 46444.42,-105 46444.42,-111 46444.42,-111 46444.42,-214 46444.42,-214 46444.42,-220 46438.42,-226 46432.42,-226 46432.42,-226 43387.6,-226 43387.6,-226 43381.6,-226 43375.6,-220 43375.6,-214 43375.6,-214 43375.6,-111 43375.6,-111 43375.6,-105 43381.6,-99 43387.6,-99"/>
<text text-anchor="middle" x="44910.01" y="-210.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_gpu_14</title>
<path fill="#d63031" fill-opacity="0.125490" stroke="#d63031" d="M46687.42,-106C46687.42,-106 49732.23,-106 49732.23,-106 49738.23,-106 49744.23,-112 49744.23,-118 49744.23,-118 49744.23,-221 49744.23,-221 49744.23,-227 49738.23,-233 49732.23,-233 49732.23,-233 46687.42,-233 46687.42,-233 46681.42,-233 46675.42,-227 46675.42,-221 46675.42,-221 46675.42,-118 46675.42,-118 46675.42,-112 46681.42,-106 46687.42,-106"/>
<text text-anchor="middle" x="48209.82" y="-217.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_gpu_15</title>
<path fill="#74b9ff" fill-opacity="0.125490" stroke="#74b9ff" d="M49987.23,-113C49987.23,-113 53032.05,-113 53032.05,-113 53038.05,-113 53044.05,-119 53044.05,-125 53044.05,-125 53044.05,-228 53044.05,-228 53044.05,-234 53038.05,-240 53032.05,-240 53032.05,-240 49987.23,-240 49987.23,-240 49981.23,-240 49975.23,-234 49975.23,-228 49975.23,-228 49975.23,-125 49975.23,-125 49975.23,-119 49981.23,-113 49987.23,-113"/>
<text text-anchor="middle" x="51509.64" y="-224.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_legend</title>
<path fill="lightgray" stroke="black" d="M39,-138C39,-138 200,-138 200,-138 206,-138 212,-144 212,-150 212,-150 212,-389 212,-389 212,-395 206,-401 200,-401 200,-401 39,-401 39,-401 33,-401 27,-395 27,-389 27,-389 27,-150 27,-150 27,-144 33,-138 39,-138"/>
<text text-anchor="middle" x="119.5" y="-385.8" font-family="Times,serif" font-size="14.00">Communication Legend</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="#e8e8e8" stroke="black" cx="119.5" cy="-67" rx="119.5" ry="21.43"/>
<text text-anchor="middle" x="119.5" y="-70" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="119.5" y="-59" font-family="Arial" font-size="10.00">[batch=1024, seq_len, hidden_dim]</text>
</g>
<!-- gpu0_layer1_attn_qkv -->
<g id="node2" class="node">
<title>gpu0_layer1_attn_qkv</title>
<polygon fill="#ff6b6b" stroke="black" points="623,-104 486,-104 486,-30 623,-30 623,-104"/>
<text text-anchor="middle" x="554.5" y="-92" font-family="Arial" font-size="10.00">Layer 1</text>
<text text-anchor="middle" x="554.5" y="-81" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="554.5" y="-70" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="554.5" y="-59" font-family="Arial" font-size="10.00">[hidden_dim, 3*hidden_dim]</text>
<text text-anchor="middle" x="554.5" y="-48" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="554.5" y="-37" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- input&#45;&gt;gpu0_layer1_attn_qkv -->
<g id="edge1" class="edge">
<title>input&#45;&gt;gpu0_layer1_attn_qkv</title>
<path fill="none" stroke="black" d="M239.23,-67C239.23,-67 475.9,-67 475.9,-67"/>
<polygon fill="black" stroke="black" points="475.9,-70.5 485.9,-67 475.9,-63.5 475.9,-70.5"/>
<text text-anchor="middle" x="362.5" y="-85.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="362.5" y="-70.8" font-family="Times,serif" font-size="14.00">No comm</text>
</g>
<!-- gpu0_layer1_attn_score -->
<g id="node3" class="node">
<title>gpu0_layer1_attn_score</title>
<polygon fill="#ff6b6b" stroke="black" points="1027,-94.5 905,-94.5 905,-53.5 1027,-53.5 1027,-94.5"/>
<text text-anchor="middle" x="966" y="-82.5" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="966" y="-71.5" font-family="Arial" font-size="10.00">Score Computation</text>
<text text-anchor="middle" x="966" y="-60.5" font-family="Arial" font-size="10.00">[batch, heads, seq, seq]</text>
</g>
<!-- gpu0_layer1_attn_qkv&#45;&gt;gpu0_layer1_attn_score -->
<g id="edge2" class="edge">
<title>gpu0_layer1_attn_qkv&#45;&gt;gpu0_layer1_attn_score</title>
<path fill="none" stroke="blue" d="M623.38,-74C623.38,-74 894.97,-74 894.97,-74"/>
<polygon fill="blue" stroke="blue" points="894.97,-77.5 904.97,-74 894.97,-70.5 894.97,-77.5"/>
<text text-anchor="middle" x="764" y="-92.8" font-family="Times,serif" font-size="14.00">[1024, seq, 3*hidden/tp]</text>
<text text-anchor="middle" x="764" y="-77.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu0_layer1_attn_dense -->
<g id="node4" class="node">
<title>gpu0_layer1_attn_dense</title>
<polygon fill="#ff6b6b" stroke="black" points="1421,-103.5 1293,-103.5 1293,-40.5 1421,-40.5 1421,-103.5"/>
<text text-anchor="middle" x="1357" y="-91.5" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="1357" y="-80.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="1357" y="-69.5" font-family="Arial" font-size="10.00">[hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="1357" y="-58.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="1357" y="-47.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu0_layer1_attn_score&#45;&gt;gpu0_layer1_attn_dense -->
<g id="edge3" class="edge">
<title>gpu0_layer1_attn_score&#45;&gt;gpu0_layer1_attn_dense</title>
<path fill="none" stroke="blue" d="M1027.1,-74C1027.1,-74 1282.76,-74 1282.76,-74"/>
<polygon fill="blue" stroke="blue" points="1282.76,-77.5 1292.76,-74 1282.76,-70.5 1282.76,-77.5"/>
<text text-anchor="middle" x="1160" y="-92.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden/tp]</text>
<text text-anchor="middle" x="1160" y="-77.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu0_layer1_attn_layernorm -->
<g id="node5" class="node">
<title>gpu0_layer1_attn_layernorm</title>
<ellipse fill="#ff6b6b" stroke="black" cx="1755.68" cy="-74" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="1755.68" y="-77" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1755.68" y="-66" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu0_layer1_attn_dense&#45;&gt;gpu0_layer1_attn_layernorm -->
<g id="edge4" class="edge">
<title>gpu0_layer1_attn_dense&#45;&gt;gpu0_layer1_attn_layernorm</title>
<path fill="none" stroke="red" d="M1421.06,-74C1421.06,-74 1657.64,-74 1657.64,-74"/>
<polygon fill="red" stroke="red" points="1657.64,-77.5 1667.64,-74 1657.64,-70.5 1657.64,-77.5"/>
<text text-anchor="middle" x="1544.5" y="-92.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="1544.5" y="-77.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu0_layer1_ffn_up -->
<g id="node6" class="node">
<title>gpu0_layer1_ffn_up</title>
<polygon fill="#ff6b6b" stroke="black" points="2227.36,-103.5 2090.36,-103.5 2090.36,-40.5 2227.36,-40.5 2227.36,-103.5"/>
<text text-anchor="middle" x="2158.86" y="-91.5" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="2158.86" y="-80.5" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="2158.86" y="-69.5" font-family="Arial" font-size="10.00">[hidden_dim, 4*hidden_dim]</text>
<text text-anchor="middle" x="2158.86" y="-58.5" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="2158.86" y="-47.5" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu0_layer1_attn_layernorm&#45;&gt;gpu0_layer1_ffn_up -->
<g id="edge5" class="edge">
<title>gpu0_layer1_attn_layernorm&#45;&gt;gpu0_layer1_ffn_up</title>
<path fill="none" stroke="green" d="M1843.66,-74C1843.66,-74 2080.09,-74 2080.09,-74"/>
<polygon fill="green" stroke="green" points="2080.09,-77.5 2090.09,-74 2080.09,-70.5 2080.09,-77.5"/>
<text text-anchor="middle" x="1966.86" y="-92.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="1966.86" y="-77.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu0_layer1_ffn_act -->
<g id="node7" class="node">
<title>gpu0_layer1_ffn_act</title>
<ellipse fill="#ff6b6b" stroke="black" cx="2603.41" cy="-74" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="2603.41" y="-82.5" font-family="Arial" font-size="10.00">Activation</text>
<text text-anchor="middle" x="2603.41" y="-71.5" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="2603.41" y="-60.5" font-family="Arial" font-size="10.00">[batch, seq, 4*hidden_dim]</text>
</g>
<!-- gpu0_layer1_ffn_up&#45;&gt;gpu0_layer1_ffn_act -->
<g id="edge6" class="edge">
<title>gpu0_layer1_ffn_up&#45;&gt;gpu0_layer1_ffn_act</title>
<path fill="none" stroke="green" d="M2227.84,-74C2227.84,-74 2499.05,-74 2499.05,-74"/>
<polygon fill="green" stroke="green" points="2499.05,-77.5 2509.05,-74 2499.05,-70.5 2499.05,-77.5"/>
<text text-anchor="middle" x="2368.36" y="-92.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="2368.36" y="-77.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu0_layer1_ffn_down -->
<g id="node8" class="node">
<title>gpu0_layer1_ffn_down</title>
<polygon fill="#ff6b6b" stroke="black" points="3116.45,-103.5 2979.45,-103.5 2979.45,-40.5 3116.45,-40.5 3116.45,-103.5"/>
<text text-anchor="middle" x="3047.95" y="-91.5" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="3047.95" y="-80.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="3047.95" y="-69.5" font-family="Arial" font-size="10.00">[4*hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="3047.95" y="-58.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="3047.95" y="-47.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu0_layer1_ffn_act&#45;&gt;gpu0_layer1_ffn_down -->
<g id="edge7" class="edge">
<title>gpu0_layer1_ffn_act&#45;&gt;gpu0_layer1_ffn_down</title>
<path fill="none" stroke="green" d="M2697.69,-74C2697.69,-74 2969.21,-74 2969.21,-74"/>
<polygon fill="green" stroke="green" points="2969.21,-77.5 2979.21,-74 2969.21,-70.5 2969.21,-77.5"/>
<text text-anchor="middle" x="2838.45" y="-92.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="2838.45" y="-77.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu0_layer1_ffn_layernorm -->
<g id="node9" class="node">
<title>gpu0_layer1_ffn_layernorm</title>
<ellipse fill="#ff6b6b" stroke="black" cx="3451.14" cy="-74" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="3451.14" y="-77" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="3451.14" y="-66" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu0_layer1_ffn_down&#45;&gt;gpu0_layer1_ffn_layernorm -->
<g id="edge8" class="edge">
<title>gpu0_layer1_ffn_down&#45;&gt;gpu0_layer1_ffn_layernorm</title>
<path fill="none" stroke="red" d="M3116.81,-74C3116.81,-74 3353.19,-74 3353.19,-74"/>
<polygon fill="red" stroke="red" points="3353.19,-77.5 3363.19,-74 3353.19,-70.5 3353.19,-77.5"/>
<text text-anchor="middle" x="3239.95" y="-92.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="3239.95" y="-77.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu1_layer2_attn_qkv -->
<g id="node10" class="node">
<title>gpu1_layer2_attn_qkv</title>
<polygon fill="#4ecdc4" stroke="black" points="3922.82,-111 3785.82,-111 3785.82,-37 3922.82,-37 3922.82,-111"/>
<text text-anchor="middle" x="3854.32" y="-99" font-family="Arial" font-size="10.00">Layer 2</text>
<text text-anchor="middle" x="3854.32" y="-88" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="3854.32" y="-77" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="3854.32" y="-66" font-family="Arial" font-size="10.00">[hidden_dim, 3*hidden_dim]</text>
<text text-anchor="middle" x="3854.32" y="-55" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="3854.32" y="-44" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu0_layer1_ffn_layernorm&#45;&gt;gpu1_layer2_attn_qkv -->
<g id="edge114" class="edge">
<title>gpu0_layer1_ffn_layernorm&#45;&gt;gpu1_layer2_attn_qkv</title>
<path fill="none" stroke="purple" stroke-width="2" stroke-dasharray="5,2" d="M3539.12,-74C3539.12,-74 3775.55,-74 3775.55,-74"/>
<polygon fill="purple" stroke="purple" stroke-width="2" points="3775.55,-77.5 3785.55,-74 3775.55,-70.5 3775.55,-77.5"/>
<text text-anchor="middle" x="3662.32" y="-92.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="3662.32" y="-77.8" font-family="Times,serif" font-size="14.00">GPU0→GPU1</text>
</g>
<!-- gpu1_layer2_attn_score -->
<g id="node11" class="node">
<title>gpu1_layer2_attn_score</title>
<polygon fill="#4ecdc4" stroke="black" points="4326.82,-101.5 4204.82,-101.5 4204.82,-60.5 4326.82,-60.5 4326.82,-101.5"/>
<text text-anchor="middle" x="4265.82" y="-89.5" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="4265.82" y="-78.5" font-family="Arial" font-size="10.00">Score Computation</text>
<text text-anchor="middle" x="4265.82" y="-67.5" font-family="Arial" font-size="10.00">[batch, heads, seq, seq]</text>
</g>
<!-- gpu1_layer2_attn_qkv&#45;&gt;gpu1_layer2_attn_score -->
<g id="edge9" class="edge">
<title>gpu1_layer2_attn_qkv&#45;&gt;gpu1_layer2_attn_score</title>
<path fill="none" stroke="blue" d="M3923.19,-81C3923.19,-81 4194.78,-81 4194.78,-81"/>
<polygon fill="blue" stroke="blue" points="4194.78,-84.5 4204.78,-81 4194.78,-77.5 4194.78,-84.5"/>
<text text-anchor="middle" x="4063.82" y="-99.8" font-family="Times,serif" font-size="14.00">[1024, seq, 3*hidden/tp]</text>
<text text-anchor="middle" x="4063.82" y="-84.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu1_layer2_attn_dense -->
<g id="node12" class="node">
<title>gpu1_layer2_attn_dense</title>
<polygon fill="#4ecdc4" stroke="black" points="4720.82,-110.5 4592.82,-110.5 4592.82,-47.5 4720.82,-47.5 4720.82,-110.5"/>
<text text-anchor="middle" x="4656.82" y="-98.5" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="4656.82" y="-87.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="4656.82" y="-76.5" font-family="Arial" font-size="10.00">[hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="4656.82" y="-65.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="4656.82" y="-54.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu1_layer2_attn_score&#45;&gt;gpu1_layer2_attn_dense -->
<g id="edge10" class="edge">
<title>gpu1_layer2_attn_score&#45;&gt;gpu1_layer2_attn_dense</title>
<path fill="none" stroke="blue" d="M4326.91,-81C4326.91,-81 4582.58,-81 4582.58,-81"/>
<polygon fill="blue" stroke="blue" points="4582.58,-84.5 4592.58,-81 4582.58,-77.5 4582.58,-84.5"/>
<text text-anchor="middle" x="4459.82" y="-99.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden/tp]</text>
<text text-anchor="middle" x="4459.82" y="-84.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu1_layer2_attn_layernorm -->
<g id="node13" class="node">
<title>gpu1_layer2_attn_layernorm</title>
<ellipse fill="#4ecdc4" stroke="black" cx="5055.5" cy="-81" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="5055.5" y="-84" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="5055.5" y="-73" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu1_layer2_attn_dense&#45;&gt;gpu1_layer2_attn_layernorm -->
<g id="edge11" class="edge">
<title>gpu1_layer2_attn_dense&#45;&gt;gpu1_layer2_attn_layernorm</title>
<path fill="none" stroke="red" d="M4720.87,-81C4720.87,-81 4957.45,-81 4957.45,-81"/>
<polygon fill="red" stroke="red" points="4957.45,-84.5 4967.45,-81 4957.45,-77.5 4957.45,-84.5"/>
<text text-anchor="middle" x="4844.32" y="-99.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="4844.32" y="-84.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu1_layer2_ffn_up -->
<g id="node14" class="node">
<title>gpu1_layer2_ffn_up</title>
<polygon fill="#4ecdc4" stroke="black" points="5527.18,-110.5 5390.18,-110.5 5390.18,-47.5 5527.18,-47.5 5527.18,-110.5"/>
<text text-anchor="middle" x="5458.68" y="-98.5" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="5458.68" y="-87.5" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="5458.68" y="-76.5" font-family="Arial" font-size="10.00">[hidden_dim, 4*hidden_dim]</text>
<text text-anchor="middle" x="5458.68" y="-65.5" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="5458.68" y="-54.5" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu1_layer2_attn_layernorm&#45;&gt;gpu1_layer2_ffn_up -->
<g id="edge12" class="edge">
<title>gpu1_layer2_attn_layernorm&#45;&gt;gpu1_layer2_ffn_up</title>
<path fill="none" stroke="green" d="M5143.48,-81C5143.48,-81 5379.91,-81 5379.91,-81"/>
<polygon fill="green" stroke="green" points="5379.91,-84.5 5389.91,-81 5379.91,-77.5 5379.91,-84.5"/>
<text text-anchor="middle" x="5266.68" y="-99.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="5266.68" y="-84.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu1_layer2_ffn_act -->
<g id="node15" class="node">
<title>gpu1_layer2_ffn_act</title>
<ellipse fill="#4ecdc4" stroke="black" cx="5903.23" cy="-81" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="5903.23" y="-89.5" font-family="Arial" font-size="10.00">Activation</text>
<text text-anchor="middle" x="5903.23" y="-78.5" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="5903.23" y="-67.5" font-family="Arial" font-size="10.00">[batch, seq, 4*hidden_dim]</text>
</g>
<!-- gpu1_layer2_ffn_up&#45;&gt;gpu1_layer2_ffn_act -->
<g id="edge13" class="edge">
<title>gpu1_layer2_ffn_up&#45;&gt;gpu1_layer2_ffn_act</title>
<path fill="none" stroke="green" d="M5527.65,-81C5527.65,-81 5798.87,-81 5798.87,-81"/>
<polygon fill="green" stroke="green" points="5798.87,-84.5 5808.87,-81 5798.87,-77.5 5798.87,-84.5"/>
<text text-anchor="middle" x="5668.18" y="-99.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="5668.18" y="-84.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu1_layer2_ffn_down -->
<g id="node16" class="node">
<title>gpu1_layer2_ffn_down</title>
<polygon fill="#4ecdc4" stroke="black" points="6416.27,-110.5 6279.27,-110.5 6279.27,-47.5 6416.27,-47.5 6416.27,-110.5"/>
<text text-anchor="middle" x="6347.77" y="-98.5" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="6347.77" y="-87.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="6347.77" y="-76.5" font-family="Arial" font-size="10.00">[4*hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="6347.77" y="-65.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="6347.77" y="-54.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu1_layer2_ffn_act&#45;&gt;gpu1_layer2_ffn_down -->
<g id="edge14" class="edge">
<title>gpu1_layer2_ffn_act&#45;&gt;gpu1_layer2_ffn_down</title>
<path fill="none" stroke="green" d="M5997.5,-81C5997.5,-81 6269.03,-81 6269.03,-81"/>
<polygon fill="green" stroke="green" points="6269.03,-84.5 6279.03,-81 6269.03,-77.5 6269.03,-84.5"/>
<text text-anchor="middle" x="6138.27" y="-99.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="6138.27" y="-84.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu1_layer2_ffn_layernorm -->
<g id="node17" class="node">
<title>gpu1_layer2_ffn_layernorm</title>
<ellipse fill="#4ecdc4" stroke="black" cx="6750.95" cy="-81" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="6750.95" y="-84" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="6750.95" y="-73" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu1_layer2_ffn_down&#45;&gt;gpu1_layer2_ffn_layernorm -->
<g id="edge15" class="edge">
<title>gpu1_layer2_ffn_down&#45;&gt;gpu1_layer2_ffn_layernorm</title>
<path fill="none" stroke="red" d="M6416.62,-81C6416.62,-81 6653,-81 6653,-81"/>
<polygon fill="red" stroke="red" points="6653,-84.5 6663,-81 6653,-77.5 6653,-84.5"/>
<text text-anchor="middle" x="6539.77" y="-99.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="6539.77" y="-84.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu2_layer3_attn_qkv -->
<g id="node18" class="node">
<title>gpu2_layer3_attn_qkv</title>
<polygon fill="#45b7d1" stroke="black" points="7222.63,-118 7085.63,-118 7085.63,-44 7222.63,-44 7222.63,-118"/>
<text text-anchor="middle" x="7154.13" y="-106" font-family="Arial" font-size="10.00">Layer 3</text>
<text text-anchor="middle" x="7154.13" y="-95" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="7154.13" y="-84" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="7154.13" y="-73" font-family="Arial" font-size="10.00">[hidden_dim, 3*hidden_dim]</text>
<text text-anchor="middle" x="7154.13" y="-62" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="7154.13" y="-51" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu1_layer2_ffn_layernorm&#45;&gt;gpu2_layer3_attn_qkv -->
<g id="edge115" class="edge">
<title>gpu1_layer2_ffn_layernorm&#45;&gt;gpu2_layer3_attn_qkv</title>
<path fill="none" stroke="purple" stroke-width="2" stroke-dasharray="5,2" d="M6838.93,-81C6838.93,-81 7075.36,-81 7075.36,-81"/>
<polygon fill="purple" stroke="purple" stroke-width="2" points="7075.36,-84.5 7085.36,-81 7075.36,-77.5 7075.36,-84.5"/>
<text text-anchor="middle" x="6962.13" y="-99.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="6962.13" y="-84.8" font-family="Times,serif" font-size="14.00">GPU1→GPU2</text>
</g>
<!-- gpu2_layer3_attn_score -->
<g id="node19" class="node">
<title>gpu2_layer3_attn_score</title>
<polygon fill="#45b7d1" stroke="black" points="7626.63,-108.5 7504.63,-108.5 7504.63,-67.5 7626.63,-67.5 7626.63,-108.5"/>
<text text-anchor="middle" x="7565.63" y="-96.5" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="7565.63" y="-85.5" font-family="Arial" font-size="10.00">Score Computation</text>
<text text-anchor="middle" x="7565.63" y="-74.5" font-family="Arial" font-size="10.00">[batch, heads, seq, seq]</text>
</g>
<!-- gpu2_layer3_attn_qkv&#45;&gt;gpu2_layer3_attn_score -->
<g id="edge16" class="edge">
<title>gpu2_layer3_attn_qkv&#45;&gt;gpu2_layer3_attn_score</title>
<path fill="none" stroke="blue" d="M7223.01,-88C7223.01,-88 7494.6,-88 7494.6,-88"/>
<polygon fill="blue" stroke="blue" points="7494.6,-91.5 7504.6,-88 7494.6,-84.5 7494.6,-91.5"/>
<text text-anchor="middle" x="7363.63" y="-106.8" font-family="Times,serif" font-size="14.00">[1024, seq, 3*hidden/tp]</text>
<text text-anchor="middle" x="7363.63" y="-91.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu2_layer3_attn_dense -->
<g id="node20" class="node">
<title>gpu2_layer3_attn_dense</title>
<polygon fill="#45b7d1" stroke="black" points="8020.63,-117.5 7892.63,-117.5 7892.63,-54.5 8020.63,-54.5 8020.63,-117.5"/>
<text text-anchor="middle" x="7956.63" y="-105.5" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="7956.63" y="-94.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="7956.63" y="-83.5" font-family="Arial" font-size="10.00">[hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="7956.63" y="-72.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="7956.63" y="-61.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu2_layer3_attn_score&#45;&gt;gpu2_layer3_attn_dense -->
<g id="edge17" class="edge">
<title>gpu2_layer3_attn_score&#45;&gt;gpu2_layer3_attn_dense</title>
<path fill="none" stroke="blue" d="M7626.73,-88C7626.73,-88 7882.4,-88 7882.4,-88"/>
<polygon fill="blue" stroke="blue" points="7882.4,-91.5 7892.4,-88 7882.4,-84.5 7882.4,-91.5"/>
<text text-anchor="middle" x="7759.63" y="-106.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden/tp]</text>
<text text-anchor="middle" x="7759.63" y="-91.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu2_layer3_attn_layernorm -->
<g id="node21" class="node">
<title>gpu2_layer3_attn_layernorm</title>
<ellipse fill="#45b7d1" stroke="black" cx="8355.31" cy="-88" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="8355.31" y="-91" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="8355.31" y="-80" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu2_layer3_attn_dense&#45;&gt;gpu2_layer3_attn_layernorm -->
<g id="edge18" class="edge">
<title>gpu2_layer3_attn_dense&#45;&gt;gpu2_layer3_attn_layernorm</title>
<path fill="none" stroke="red" d="M8020.69,-88C8020.69,-88 8257.27,-88 8257.27,-88"/>
<polygon fill="red" stroke="red" points="8257.27,-91.5 8267.27,-88 8257.27,-84.5 8257.27,-91.5"/>
<text text-anchor="middle" x="8144.13" y="-106.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="8144.13" y="-91.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu2_layer3_ffn_up -->
<g id="node22" class="node">
<title>gpu2_layer3_ffn_up</title>
<polygon fill="#45b7d1" stroke="black" points="8827,-117.5 8690,-117.5 8690,-54.5 8827,-54.5 8827,-117.5"/>
<text text-anchor="middle" x="8758.5" y="-105.5" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="8758.5" y="-94.5" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="8758.5" y="-83.5" font-family="Arial" font-size="10.00">[hidden_dim, 4*hidden_dim]</text>
<text text-anchor="middle" x="8758.5" y="-72.5" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="8758.5" y="-61.5" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu2_layer3_attn_layernorm&#45;&gt;gpu2_layer3_ffn_up -->
<g id="edge19" class="edge">
<title>gpu2_layer3_attn_layernorm&#45;&gt;gpu2_layer3_ffn_up</title>
<path fill="none" stroke="green" d="M8443.3,-88C8443.3,-88 8679.72,-88 8679.72,-88"/>
<polygon fill="green" stroke="green" points="8679.72,-91.5 8689.72,-88 8679.72,-84.5 8679.72,-91.5"/>
<text text-anchor="middle" x="8566.5" y="-106.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="8566.5" y="-91.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu2_layer3_ffn_act -->
<g id="node23" class="node">
<title>gpu2_layer3_ffn_act</title>
<ellipse fill="#45b7d1" stroke="black" cx="9203.04" cy="-88" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="9203.04" y="-96.5" font-family="Arial" font-size="10.00">Activation</text>
<text text-anchor="middle" x="9203.04" y="-85.5" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="9203.04" y="-74.5" font-family="Arial" font-size="10.00">[batch, seq, 4*hidden_dim]</text>
</g>
<!-- gpu2_layer3_ffn_up&#45;&gt;gpu2_layer3_ffn_act -->
<g id="edge20" class="edge">
<title>gpu2_layer3_ffn_up&#45;&gt;gpu2_layer3_ffn_act</title>
<path fill="none" stroke="green" d="M8827.47,-88C8827.47,-88 9098.68,-88 9098.68,-88"/>
<polygon fill="green" stroke="green" points="9098.68,-91.5 9108.68,-88 9098.68,-84.5 9098.68,-91.5"/>
<text text-anchor="middle" x="8968" y="-106.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="8968" y="-91.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu2_layer3_ffn_down -->
<g id="node24" class="node">
<title>gpu2_layer3_ffn_down</title>
<polygon fill="#45b7d1" stroke="black" points="9716.09,-117.5 9579.09,-117.5 9579.09,-54.5 9716.09,-54.5 9716.09,-117.5"/>
<text text-anchor="middle" x="9647.59" y="-105.5" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="9647.59" y="-94.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="9647.59" y="-83.5" font-family="Arial" font-size="10.00">[4*hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="9647.59" y="-72.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="9647.59" y="-61.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu2_layer3_ffn_act&#45;&gt;gpu2_layer3_ffn_down -->
<g id="edge21" class="edge">
<title>gpu2_layer3_ffn_act&#45;&gt;gpu2_layer3_ffn_down</title>
<path fill="none" stroke="green" d="M9297.32,-88C9297.32,-88 9568.84,-88 9568.84,-88"/>
<polygon fill="green" stroke="green" points="9568.84,-91.5 9578.84,-88 9568.84,-84.5 9568.84,-91.5"/>
<text text-anchor="middle" x="9438.09" y="-106.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="9438.09" y="-91.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu2_layer3_ffn_layernorm -->
<g id="node25" class="node">
<title>gpu2_layer3_ffn_layernorm</title>
<ellipse fill="#45b7d1" stroke="black" cx="10050.77" cy="-88" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="10050.77" y="-91" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="10050.77" y="-80" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu2_layer3_ffn_down&#45;&gt;gpu2_layer3_ffn_layernorm -->
<g id="edge22" class="edge">
<title>gpu2_layer3_ffn_down&#45;&gt;gpu2_layer3_ffn_layernorm</title>
<path fill="none" stroke="red" d="M9716.44,-88C9716.44,-88 9952.82,-88 9952.82,-88"/>
<polygon fill="red" stroke="red" points="9952.82,-91.5 9962.82,-88 9952.82,-84.5 9952.82,-91.5"/>
<text text-anchor="middle" x="9839.59" y="-106.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="9839.59" y="-91.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu3_layer4_attn_qkv -->
<g id="node26" class="node">
<title>gpu3_layer4_attn_qkv</title>
<polygon fill="#96ceb4" stroke="black" points="10522.45,-125 10385.45,-125 10385.45,-51 10522.45,-51 10522.45,-125"/>
<text text-anchor="middle" x="10453.95" y="-113" font-family="Arial" font-size="10.00">Layer 4</text>
<text text-anchor="middle" x="10453.95" y="-102" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="10453.95" y="-91" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="10453.95" y="-80" font-family="Arial" font-size="10.00">[hidden_dim, 3*hidden_dim]</text>
<text text-anchor="middle" x="10453.95" y="-69" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="10453.95" y="-58" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu2_layer3_ffn_layernorm&#45;&gt;gpu3_layer4_attn_qkv -->
<g id="edge116" class="edge">
<title>gpu2_layer3_ffn_layernorm&#45;&gt;gpu3_layer4_attn_qkv</title>
<path fill="none" stroke="purple" stroke-width="2" stroke-dasharray="5,2" d="M10138.75,-88C10138.75,-88 10375.18,-88 10375.18,-88"/>
<polygon fill="purple" stroke="purple" stroke-width="2" points="10375.18,-91.5 10385.18,-88 10375.18,-84.5 10375.18,-91.5"/>
<text text-anchor="middle" x="10261.95" y="-106.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="10261.95" y="-91.8" font-family="Times,serif" font-size="14.00">GPU2→GPU3</text>
</g>
<!-- gpu3_layer4_attn_score -->
<g id="node27" class="node">
<title>gpu3_layer4_attn_score</title>
<polygon fill="#96ceb4" stroke="black" points="10926.45,-115.5 10804.45,-115.5 10804.45,-74.5 10926.45,-74.5 10926.45,-115.5"/>
<text text-anchor="middle" x="10865.45" y="-103.5" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="10865.45" y="-92.5" font-family="Arial" font-size="10.00">Score Computation</text>
<text text-anchor="middle" x="10865.45" y="-81.5" font-family="Arial" font-size="10.00">[batch, heads, seq, seq]</text>
</g>
<!-- gpu3_layer4_attn_qkv&#45;&gt;gpu3_layer4_attn_score -->
<g id="edge23" class="edge">
<title>gpu3_layer4_attn_qkv&#45;&gt;gpu3_layer4_attn_score</title>
<path fill="none" stroke="blue" d="M10522.82,-95C10522.82,-95 10794.41,-95 10794.41,-95"/>
<polygon fill="blue" stroke="blue" points="10794.41,-98.5 10804.41,-95 10794.41,-91.5 10794.41,-98.5"/>
<text text-anchor="middle" x="10663.45" y="-113.8" font-family="Times,serif" font-size="14.00">[1024, seq, 3*hidden/tp]</text>
<text text-anchor="middle" x="10663.45" y="-98.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu3_layer4_attn_dense -->
<g id="node28" class="node">
<title>gpu3_layer4_attn_dense</title>
<polygon fill="#96ceb4" stroke="black" points="11320.45,-124.5 11192.45,-124.5 11192.45,-61.5 11320.45,-61.5 11320.45,-124.5"/>
<text text-anchor="middle" x="11256.45" y="-112.5" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="11256.45" y="-101.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="11256.45" y="-90.5" font-family="Arial" font-size="10.00">[hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="11256.45" y="-79.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="11256.45" y="-68.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu3_layer4_attn_score&#45;&gt;gpu3_layer4_attn_dense -->
<g id="edge24" class="edge">
<title>gpu3_layer4_attn_score&#45;&gt;gpu3_layer4_attn_dense</title>
<path fill="none" stroke="blue" d="M10926.54,-95C10926.54,-95 11182.21,-95 11182.21,-95"/>
<polygon fill="blue" stroke="blue" points="11182.21,-98.5 11192.21,-95 11182.21,-91.5 11182.21,-98.5"/>
<text text-anchor="middle" x="11059.45" y="-113.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden/tp]</text>
<text text-anchor="middle" x="11059.45" y="-98.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu3_layer4_attn_layernorm -->
<g id="node29" class="node">
<title>gpu3_layer4_attn_layernorm</title>
<ellipse fill="#96ceb4" stroke="black" cx="11655.13" cy="-95" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="11655.13" y="-98" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="11655.13" y="-87" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu3_layer4_attn_dense&#45;&gt;gpu3_layer4_attn_layernorm -->
<g id="edge25" class="edge">
<title>gpu3_layer4_attn_dense&#45;&gt;gpu3_layer4_attn_layernorm</title>
<path fill="none" stroke="red" d="M11320.5,-95C11320.5,-95 11557.08,-95 11557.08,-95"/>
<polygon fill="red" stroke="red" points="11557.08,-98.5 11567.08,-95 11557.08,-91.5 11557.08,-98.5"/>
<text text-anchor="middle" x="11443.95" y="-113.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="11443.95" y="-98.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu3_layer4_ffn_up -->
<g id="node30" class="node">
<title>gpu3_layer4_ffn_up</title>
<polygon fill="#96ceb4" stroke="black" points="12126.81,-124.5 11989.81,-124.5 11989.81,-61.5 12126.81,-61.5 12126.81,-124.5"/>
<text text-anchor="middle" x="12058.31" y="-112.5" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="12058.31" y="-101.5" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="12058.31" y="-90.5" font-family="Arial" font-size="10.00">[hidden_dim, 4*hidden_dim]</text>
<text text-anchor="middle" x="12058.31" y="-79.5" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="12058.31" y="-68.5" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu3_layer4_attn_layernorm&#45;&gt;gpu3_layer4_ffn_up -->
<g id="edge26" class="edge">
<title>gpu3_layer4_attn_layernorm&#45;&gt;gpu3_layer4_ffn_up</title>
<path fill="none" stroke="green" d="M11743.11,-95C11743.11,-95 11979.54,-95 11979.54,-95"/>
<polygon fill="green" stroke="green" points="11979.54,-98.5 11989.54,-95 11979.54,-91.5 11979.54,-98.5"/>
<text text-anchor="middle" x="11866.31" y="-113.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="11866.31" y="-98.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu3_layer4_ffn_act -->
<g id="node31" class="node">
<title>gpu3_layer4_ffn_act</title>
<ellipse fill="#96ceb4" stroke="black" cx="12502.86" cy="-95" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="12502.86" y="-103.5" font-family="Arial" font-size="10.00">Activation</text>
<text text-anchor="middle" x="12502.86" y="-92.5" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="12502.86" y="-81.5" font-family="Arial" font-size="10.00">[batch, seq, 4*hidden_dim]</text>
</g>
<!-- gpu3_layer4_ffn_up&#45;&gt;gpu3_layer4_ffn_act -->
<g id="edge27" class="edge">
<title>gpu3_layer4_ffn_up&#45;&gt;gpu3_layer4_ffn_act</title>
<path fill="none" stroke="green" d="M12127.28,-95C12127.28,-95 12398.5,-95 12398.5,-95"/>
<polygon fill="green" stroke="green" points="12398.5,-98.5 12408.5,-95 12398.5,-91.5 12398.5,-98.5"/>
<text text-anchor="middle" x="12267.81" y="-113.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="12267.81" y="-98.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu3_layer4_ffn_down -->
<g id="node32" class="node">
<title>gpu3_layer4_ffn_down</title>
<polygon fill="#96ceb4" stroke="black" points="13015.9,-124.5 12878.9,-124.5 12878.9,-61.5 13015.9,-61.5 13015.9,-124.5"/>
<text text-anchor="middle" x="12947.4" y="-112.5" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="12947.4" y="-101.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="12947.4" y="-90.5" font-family="Arial" font-size="10.00">[4*hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="12947.4" y="-79.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="12947.4" y="-68.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu3_layer4_ffn_act&#45;&gt;gpu3_layer4_ffn_down -->
<g id="edge28" class="edge">
<title>gpu3_layer4_ffn_act&#45;&gt;gpu3_layer4_ffn_down</title>
<path fill="none" stroke="green" d="M12597.13,-95C12597.13,-95 12868.66,-95 12868.66,-95"/>
<polygon fill="green" stroke="green" points="12868.66,-98.5 12878.66,-95 12868.66,-91.5 12868.66,-98.5"/>
<text text-anchor="middle" x="12737.9" y="-113.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="12737.9" y="-98.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu3_layer4_ffn_layernorm -->
<g id="node33" class="node">
<title>gpu3_layer4_ffn_layernorm</title>
<ellipse fill="#96ceb4" stroke="black" cx="13350.58" cy="-95" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="13350.58" y="-98" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="13350.58" y="-87" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu3_layer4_ffn_down&#45;&gt;gpu3_layer4_ffn_layernorm -->
<g id="edge29" class="edge">
<title>gpu3_layer4_ffn_down&#45;&gt;gpu3_layer4_ffn_layernorm</title>
<path fill="none" stroke="red" d="M13016.25,-95C13016.25,-95 13252.64,-95 13252.64,-95"/>
<polygon fill="red" stroke="red" points="13252.64,-98.5 13262.64,-95 13252.64,-91.5 13252.64,-98.5"/>
<text text-anchor="middle" x="13139.4" y="-113.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="13139.4" y="-98.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu4_layer5_attn_qkv -->
<g id="node34" class="node">
<title>gpu4_layer5_attn_qkv</title>
<polygon fill="#feca57" stroke="black" points="13822.26,-132 13685.26,-132 13685.26,-58 13822.26,-58 13822.26,-132"/>
<text text-anchor="middle" x="13753.76" y="-120" font-family="Arial" font-size="10.00">Layer 5</text>
<text text-anchor="middle" x="13753.76" y="-109" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="13753.76" y="-98" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="13753.76" y="-87" font-family="Arial" font-size="10.00">[hidden_dim, 3*hidden_dim]</text>
<text text-anchor="middle" x="13753.76" y="-76" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="13753.76" y="-65" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu3_layer4_ffn_layernorm&#45;&gt;gpu4_layer5_attn_qkv -->
<g id="edge117" class="edge">
<title>gpu3_layer4_ffn_layernorm&#45;&gt;gpu4_layer5_attn_qkv</title>
<path fill="none" stroke="purple" stroke-width="2" stroke-dasharray="5,2" d="M13438.56,-95C13438.56,-95 13674.99,-95 13674.99,-95"/>
<polygon fill="purple" stroke="purple" stroke-width="2" points="13674.99,-98.5 13684.99,-95 13674.99,-91.5 13674.99,-98.5"/>
<text text-anchor="middle" x="13561.76" y="-113.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="13561.76" y="-98.8" font-family="Times,serif" font-size="14.00">GPU3→GPU4</text>
</g>
<!-- gpu4_layer5_attn_score -->
<g id="node35" class="node">
<title>gpu4_layer5_attn_score</title>
<polygon fill="#feca57" stroke="black" points="14226.26,-122.5 14104.26,-122.5 14104.26,-81.5 14226.26,-81.5 14226.26,-122.5"/>
<text text-anchor="middle" x="14165.26" y="-110.5" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="14165.26" y="-99.5" font-family="Arial" font-size="10.00">Score Computation</text>
<text text-anchor="middle" x="14165.26" y="-88.5" font-family="Arial" font-size="10.00">[batch, heads, seq, seq]</text>
</g>
<!-- gpu4_layer5_attn_qkv&#45;&gt;gpu4_layer5_attn_score -->
<g id="edge30" class="edge">
<title>gpu4_layer5_attn_qkv&#45;&gt;gpu4_layer5_attn_score</title>
<path fill="none" stroke="blue" d="M13822.64,-102C13822.64,-102 14094.23,-102 14094.23,-102"/>
<polygon fill="blue" stroke="blue" points="14094.23,-105.5 14104.23,-102 14094.23,-98.5 14094.23,-105.5"/>
<text text-anchor="middle" x="13963.26" y="-120.8" font-family="Times,serif" font-size="14.00">[1024, seq, 3*hidden/tp]</text>
<text text-anchor="middle" x="13963.26" y="-105.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu4_layer5_attn_dense -->
<g id="node36" class="node">
<title>gpu4_layer5_attn_dense</title>
<polygon fill="#feca57" stroke="black" points="14620.26,-131.5 14492.26,-131.5 14492.26,-68.5 14620.26,-68.5 14620.26,-131.5"/>
<text text-anchor="middle" x="14556.26" y="-119.5" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="14556.26" y="-108.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="14556.26" y="-97.5" font-family="Arial" font-size="10.00">[hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="14556.26" y="-86.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="14556.26" y="-75.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu4_layer5_attn_score&#45;&gt;gpu4_layer5_attn_dense -->
<g id="edge31" class="edge">
<title>gpu4_layer5_attn_score&#45;&gt;gpu4_layer5_attn_dense</title>
<path fill="none" stroke="blue" d="M14226.36,-102C14226.36,-102 14482.03,-102 14482.03,-102"/>
<polygon fill="blue" stroke="blue" points="14482.03,-105.5 14492.03,-102 14482.03,-98.5 14482.03,-105.5"/>
<text text-anchor="middle" x="14359.26" y="-120.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden/tp]</text>
<text text-anchor="middle" x="14359.26" y="-105.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu4_layer5_attn_layernorm -->
<g id="node37" class="node">
<title>gpu4_layer5_attn_layernorm</title>
<ellipse fill="#feca57" stroke="black" cx="14954.94" cy="-102" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="14954.94" y="-105" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="14954.94" y="-94" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu4_layer5_attn_dense&#45;&gt;gpu4_layer5_attn_layernorm -->
<g id="edge32" class="edge">
<title>gpu4_layer5_attn_dense&#45;&gt;gpu4_layer5_attn_layernorm</title>
<path fill="none" stroke="red" d="M14620.32,-102C14620.32,-102 14856.9,-102 14856.9,-102"/>
<polygon fill="red" stroke="red" points="14856.9,-105.5 14866.9,-102 14856.9,-98.5 14856.9,-105.5"/>
<text text-anchor="middle" x="14743.76" y="-120.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="14743.76" y="-105.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu4_layer5_ffn_up -->
<g id="node38" class="node">
<title>gpu4_layer5_ffn_up</title>
<polygon fill="#feca57" stroke="black" points="15426.63,-131.5 15289.63,-131.5 15289.63,-68.5 15426.63,-68.5 15426.63,-131.5"/>
<text text-anchor="middle" x="15358.13" y="-119.5" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="15358.13" y="-108.5" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="15358.13" y="-97.5" font-family="Arial" font-size="10.00">[hidden_dim, 4*hidden_dim]</text>
<text text-anchor="middle" x="15358.13" y="-86.5" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="15358.13" y="-75.5" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu4_layer5_attn_layernorm&#45;&gt;gpu4_layer5_ffn_up -->
<g id="edge33" class="edge">
<title>gpu4_layer5_attn_layernorm&#45;&gt;gpu4_layer5_ffn_up</title>
<path fill="none" stroke="green" d="M15042.93,-102C15042.93,-102 15279.36,-102 15279.36,-102"/>
<polygon fill="green" stroke="green" points="15279.36,-105.5 15289.36,-102 15279.36,-98.5 15279.36,-105.5"/>
<text text-anchor="middle" x="15166.13" y="-120.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="15166.13" y="-105.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu4_layer5_ffn_act -->
<g id="node39" class="node">
<title>gpu4_layer5_ffn_act</title>
<ellipse fill="#feca57" stroke="black" cx="15802.67" cy="-102" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="15802.67" y="-110.5" font-family="Arial" font-size="10.00">Activation</text>
<text text-anchor="middle" x="15802.67" y="-99.5" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="15802.67" y="-88.5" font-family="Arial" font-size="10.00">[batch, seq, 4*hidden_dim]</text>
</g>
<!-- gpu4_layer5_ffn_up&#45;&gt;gpu4_layer5_ffn_act -->
<g id="edge34" class="edge">
<title>gpu4_layer5_ffn_up&#45;&gt;gpu4_layer5_ffn_act</title>
<path fill="none" stroke="green" d="M15427.1,-102C15427.1,-102 15698.32,-102 15698.32,-102"/>
<polygon fill="green" stroke="green" points="15698.32,-105.5 15708.32,-102 15698.32,-98.5 15698.32,-105.5"/>
<text text-anchor="middle" x="15567.63" y="-120.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="15567.63" y="-105.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu4_layer5_ffn_down -->
<g id="node40" class="node">
<title>gpu4_layer5_ffn_down</title>
<polygon fill="#feca57" stroke="black" points="16315.72,-131.5 16178.72,-131.5 16178.72,-68.5 16315.72,-68.5 16315.72,-131.5"/>
<text text-anchor="middle" x="16247.22" y="-119.5" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="16247.22" y="-108.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="16247.22" y="-97.5" font-family="Arial" font-size="10.00">[4*hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="16247.22" y="-86.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="16247.22" y="-75.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu4_layer5_ffn_act&#45;&gt;gpu4_layer5_ffn_down -->
<g id="edge35" class="edge">
<title>gpu4_layer5_ffn_act&#45;&gt;gpu4_layer5_ffn_down</title>
<path fill="none" stroke="green" d="M15896.95,-102C15896.95,-102 16168.47,-102 16168.47,-102"/>
<polygon fill="green" stroke="green" points="16168.47,-105.5 16178.47,-102 16168.47,-98.5 16168.47,-105.5"/>
<text text-anchor="middle" x="16037.72" y="-120.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="16037.72" y="-105.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu4_layer5_ffn_layernorm -->
<g id="node41" class="node">
<title>gpu4_layer5_ffn_layernorm</title>
<ellipse fill="#feca57" stroke="black" cx="16650.4" cy="-102" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="16650.4" y="-105" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="16650.4" y="-94" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu4_layer5_ffn_down&#45;&gt;gpu4_layer5_ffn_layernorm -->
<g id="edge36" class="edge">
<title>gpu4_layer5_ffn_down&#45;&gt;gpu4_layer5_ffn_layernorm</title>
<path fill="none" stroke="red" d="M16316.07,-102C16316.07,-102 16552.45,-102 16552.45,-102"/>
<polygon fill="red" stroke="red" points="16552.45,-105.5 16562.45,-102 16552.45,-98.5 16552.45,-105.5"/>
<text text-anchor="middle" x="16439.22" y="-120.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="16439.22" y="-105.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu5_layer6_attn_qkv -->
<g id="node42" class="node">
<title>gpu5_layer6_attn_qkv</title>
<polygon fill="#ff9ff3" stroke="black" points="17122.08,-139 16985.08,-139 16985.08,-65 17122.08,-65 17122.08,-139"/>
<text text-anchor="middle" x="17053.58" y="-127" font-family="Arial" font-size="10.00">Layer 6</text>
<text text-anchor="middle" x="17053.58" y="-116" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="17053.58" y="-105" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="17053.58" y="-94" font-family="Arial" font-size="10.00">[hidden_dim, 3*hidden_dim]</text>
<text text-anchor="middle" x="17053.58" y="-83" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="17053.58" y="-72" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu4_layer5_ffn_layernorm&#45;&gt;gpu5_layer6_attn_qkv -->
<g id="edge118" class="edge">
<title>gpu4_layer5_ffn_layernorm&#45;&gt;gpu5_layer6_attn_qkv</title>
<path fill="none" stroke="purple" stroke-width="2" stroke-dasharray="5,2" d="M16738.38,-102C16738.38,-102 16974.81,-102 16974.81,-102"/>
<polygon fill="purple" stroke="purple" stroke-width="2" points="16974.81,-105.5 16984.81,-102 16974.81,-98.5 16974.81,-105.5"/>
<text text-anchor="middle" x="16861.58" y="-120.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="16861.58" y="-105.8" font-family="Times,serif" font-size="14.00">GPU4→GPU5</text>
</g>
<!-- gpu5_layer6_attn_score -->
<g id="node43" class="node">
<title>gpu5_layer6_attn_score</title>
<polygon fill="#ff9ff3" stroke="black" points="17526.08,-129.5 17404.08,-129.5 17404.08,-88.5 17526.08,-88.5 17526.08,-129.5"/>
<text text-anchor="middle" x="17465.08" y="-117.5" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="17465.08" y="-106.5" font-family="Arial" font-size="10.00">Score Computation</text>
<text text-anchor="middle" x="17465.08" y="-95.5" font-family="Arial" font-size="10.00">[batch, heads, seq, seq]</text>
</g>
<!-- gpu5_layer6_attn_qkv&#45;&gt;gpu5_layer6_attn_score -->
<g id="edge37" class="edge">
<title>gpu5_layer6_attn_qkv&#45;&gt;gpu5_layer6_attn_score</title>
<path fill="none" stroke="blue" d="M17122.45,-109C17122.45,-109 17394.04,-109 17394.04,-109"/>
<polygon fill="blue" stroke="blue" points="17394.04,-112.5 17404.04,-109 17394.04,-105.5 17394.04,-112.5"/>
<text text-anchor="middle" x="17263.08" y="-127.8" font-family="Times,serif" font-size="14.00">[1024, seq, 3*hidden/tp]</text>
<text text-anchor="middle" x="17263.08" y="-112.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu5_layer6_attn_dense -->
<g id="node44" class="node">
<title>gpu5_layer6_attn_dense</title>
<polygon fill="#ff9ff3" stroke="black" points="17920.08,-138.5 17792.08,-138.5 17792.08,-75.5 17920.08,-75.5 17920.08,-138.5"/>
<text text-anchor="middle" x="17856.08" y="-126.5" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="17856.08" y="-115.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="17856.08" y="-104.5" font-family="Arial" font-size="10.00">[hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="17856.08" y="-93.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="17856.08" y="-82.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu5_layer6_attn_score&#45;&gt;gpu5_layer6_attn_dense -->
<g id="edge38" class="edge">
<title>gpu5_layer6_attn_score&#45;&gt;gpu5_layer6_attn_dense</title>
<path fill="none" stroke="blue" d="M17526.17,-109C17526.17,-109 17781.84,-109 17781.84,-109"/>
<polygon fill="blue" stroke="blue" points="17781.84,-112.5 17791.84,-109 17781.84,-105.5 17781.84,-112.5"/>
<text text-anchor="middle" x="17659.08" y="-127.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden/tp]</text>
<text text-anchor="middle" x="17659.08" y="-112.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu5_layer6_attn_layernorm -->
<g id="node45" class="node">
<title>gpu5_layer6_attn_layernorm</title>
<ellipse fill="#ff9ff3" stroke="black" cx="18254.76" cy="-109" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="18254.76" y="-112" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="18254.76" y="-101" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu5_layer6_attn_dense&#45;&gt;gpu5_layer6_attn_layernorm -->
<g id="edge39" class="edge">
<title>gpu5_layer6_attn_dense&#45;&gt;gpu5_layer6_attn_layernorm</title>
<path fill="none" stroke="red" d="M17920.13,-109C17920.13,-109 18156.71,-109 18156.71,-109"/>
<polygon fill="red" stroke="red" points="18156.71,-112.5 18166.71,-109 18156.71,-105.5 18156.71,-112.5"/>
<text text-anchor="middle" x="18043.58" y="-127.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="18043.58" y="-112.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu5_layer6_ffn_up -->
<g id="node46" class="node">
<title>gpu5_layer6_ffn_up</title>
<polygon fill="#ff9ff3" stroke="black" points="18726.44,-138.5 18589.44,-138.5 18589.44,-75.5 18726.44,-75.5 18726.44,-138.5"/>
<text text-anchor="middle" x="18657.94" y="-126.5" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="18657.94" y="-115.5" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="18657.94" y="-104.5" font-family="Arial" font-size="10.00">[hidden_dim, 4*hidden_dim]</text>
<text text-anchor="middle" x="18657.94" y="-93.5" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="18657.94" y="-82.5" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu5_layer6_attn_layernorm&#45;&gt;gpu5_layer6_ffn_up -->
<g id="edge40" class="edge">
<title>gpu5_layer6_attn_layernorm&#45;&gt;gpu5_layer6_ffn_up</title>
<path fill="none" stroke="green" d="M18342.74,-109C18342.74,-109 18579.17,-109 18579.17,-109"/>
<polygon fill="green" stroke="green" points="18579.17,-112.5 18589.17,-109 18579.17,-105.5 18579.17,-112.5"/>
<text text-anchor="middle" x="18465.94" y="-127.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="18465.94" y="-112.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu5_layer6_ffn_act -->
<g id="node47" class="node">
<title>gpu5_layer6_ffn_act</title>
<ellipse fill="#ff9ff3" stroke="black" cx="19102.49" cy="-109" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="19102.49" y="-117.5" font-family="Arial" font-size="10.00">Activation</text>
<text text-anchor="middle" x="19102.49" y="-106.5" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="19102.49" y="-95.5" font-family="Arial" font-size="10.00">[batch, seq, 4*hidden_dim]</text>
</g>
<!-- gpu5_layer6_ffn_up&#45;&gt;gpu5_layer6_ffn_act -->
<g id="edge41" class="edge">
<title>gpu5_layer6_ffn_up&#45;&gt;gpu5_layer6_ffn_act</title>
<path fill="none" stroke="green" d="M18726.91,-109C18726.91,-109 18998.13,-109 18998.13,-109"/>
<polygon fill="green" stroke="green" points="18998.13,-112.5 19008.13,-109 18998.13,-105.5 18998.13,-112.5"/>
<text text-anchor="middle" x="18867.44" y="-127.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="18867.44" y="-112.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu5_layer6_ffn_down -->
<g id="node48" class="node">
<title>gpu5_layer6_ffn_down</title>
<polygon fill="#ff9ff3" stroke="black" points="19615.53,-138.5 19478.53,-138.5 19478.53,-75.5 19615.53,-75.5 19615.53,-138.5"/>
<text text-anchor="middle" x="19547.03" y="-126.5" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="19547.03" y="-115.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="19547.03" y="-104.5" font-family="Arial" font-size="10.00">[4*hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="19547.03" y="-93.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="19547.03" y="-82.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu5_layer6_ffn_act&#45;&gt;gpu5_layer6_ffn_down -->
<g id="edge42" class="edge">
<title>gpu5_layer6_ffn_act&#45;&gt;gpu5_layer6_ffn_down</title>
<path fill="none" stroke="green" d="M19196.76,-109C19196.76,-109 19468.29,-109 19468.29,-109"/>
<polygon fill="green" stroke="green" points="19468.29,-112.5 19478.29,-109 19468.29,-105.5 19468.29,-112.5"/>
<text text-anchor="middle" x="19337.53" y="-127.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="19337.53" y="-112.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu5_layer6_ffn_layernorm -->
<g id="node49" class="node">
<title>gpu5_layer6_ffn_layernorm</title>
<ellipse fill="#ff9ff3" stroke="black" cx="19950.21" cy="-109" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="19950.21" y="-112" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="19950.21" y="-101" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu5_layer6_ffn_down&#45;&gt;gpu5_layer6_ffn_layernorm -->
<g id="edge43" class="edge">
<title>gpu5_layer6_ffn_down&#45;&gt;gpu5_layer6_ffn_layernorm</title>
<path fill="none" stroke="red" d="M19615.88,-109C19615.88,-109 19852.27,-109 19852.27,-109"/>
<polygon fill="red" stroke="red" points="19852.27,-112.5 19862.27,-109 19852.27,-105.5 19852.27,-112.5"/>
<text text-anchor="middle" x="19739.03" y="-127.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="19739.03" y="-112.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu6_layer7_attn_qkv -->
<g id="node50" class="node">
<title>gpu6_layer7_attn_qkv</title>
<polygon fill="#54a0ff" stroke="black" points="20421.89,-146 20284.89,-146 20284.89,-72 20421.89,-72 20421.89,-146"/>
<text text-anchor="middle" x="20353.39" y="-134" font-family="Arial" font-size="10.00">Layer 7</text>
<text text-anchor="middle" x="20353.39" y="-123" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="20353.39" y="-112" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="20353.39" y="-101" font-family="Arial" font-size="10.00">[hidden_dim, 3*hidden_dim]</text>
<text text-anchor="middle" x="20353.39" y="-90" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="20353.39" y="-79" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu5_layer6_ffn_layernorm&#45;&gt;gpu6_layer7_attn_qkv -->
<g id="edge119" class="edge">
<title>gpu5_layer6_ffn_layernorm&#45;&gt;gpu6_layer7_attn_qkv</title>
<path fill="none" stroke="purple" stroke-width="2" stroke-dasharray="5,2" d="M20038.19,-109C20038.19,-109 20274.62,-109 20274.62,-109"/>
<polygon fill="purple" stroke="purple" stroke-width="2" points="20274.62,-112.5 20284.62,-109 20274.62,-105.5 20274.62,-112.5"/>
<text text-anchor="middle" x="20161.39" y="-127.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="20161.39" y="-112.8" font-family="Times,serif" font-size="14.00">GPU5→GPU6</text>
</g>
<!-- gpu6_layer7_attn_score -->
<g id="node51" class="node">
<title>gpu6_layer7_attn_score</title>
<polygon fill="#54a0ff" stroke="black" points="20825.89,-136.5 20703.89,-136.5 20703.89,-95.5 20825.89,-95.5 20825.89,-136.5"/>
<text text-anchor="middle" x="20764.89" y="-124.5" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="20764.89" y="-113.5" font-family="Arial" font-size="10.00">Score Computation</text>
<text text-anchor="middle" x="20764.89" y="-102.5" font-family="Arial" font-size="10.00">[batch, heads, seq, seq]</text>
</g>
<!-- gpu6_layer7_attn_qkv&#45;&gt;gpu6_layer7_attn_score -->
<g id="edge44" class="edge">
<title>gpu6_layer7_attn_qkv&#45;&gt;gpu6_layer7_attn_score</title>
<path fill="none" stroke="blue" d="M20422.27,-116C20422.27,-116 20693.86,-116 20693.86,-116"/>
<polygon fill="blue" stroke="blue" points="20693.86,-119.5 20703.86,-116 20693.86,-112.5 20693.86,-119.5"/>
<text text-anchor="middle" x="20562.89" y="-134.8" font-family="Times,serif" font-size="14.00">[1024, seq, 3*hidden/tp]</text>
<text text-anchor="middle" x="20562.89" y="-119.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu6_layer7_attn_dense -->
<g id="node52" class="node">
<title>gpu6_layer7_attn_dense</title>
<polygon fill="#54a0ff" stroke="black" points="21219.89,-145.5 21091.89,-145.5 21091.89,-82.5 21219.89,-82.5 21219.89,-145.5"/>
<text text-anchor="middle" x="21155.89" y="-133.5" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="21155.89" y="-122.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="21155.89" y="-111.5" font-family="Arial" font-size="10.00">[hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="21155.89" y="-100.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="21155.89" y="-89.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu6_layer7_attn_score&#45;&gt;gpu6_layer7_attn_dense -->
<g id="edge45" class="edge">
<title>gpu6_layer7_attn_score&#45;&gt;gpu6_layer7_attn_dense</title>
<path fill="none" stroke="blue" d="M20825.99,-116C20825.99,-116 21081.66,-116 21081.66,-116"/>
<polygon fill="blue" stroke="blue" points="21081.66,-119.5 21091.66,-116 21081.66,-112.5 21081.66,-119.5"/>
<text text-anchor="middle" x="20958.89" y="-134.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden/tp]</text>
<text text-anchor="middle" x="20958.89" y="-119.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu6_layer7_attn_layernorm -->
<g id="node53" class="node">
<title>gpu6_layer7_attn_layernorm</title>
<ellipse fill="#54a0ff" stroke="black" cx="21554.58" cy="-116" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="21554.58" y="-119" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="21554.58" y="-108" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu6_layer7_attn_dense&#45;&gt;gpu6_layer7_attn_layernorm -->
<g id="edge46" class="edge">
<title>gpu6_layer7_attn_dense&#45;&gt;gpu6_layer7_attn_layernorm</title>
<path fill="none" stroke="red" d="M21219.95,-116C21219.95,-116 21456.53,-116 21456.53,-116"/>
<polygon fill="red" stroke="red" points="21456.53,-119.5 21466.53,-116 21456.53,-112.5 21456.53,-119.5"/>
<text text-anchor="middle" x="21343.39" y="-134.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="21343.39" y="-119.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu6_layer7_ffn_up -->
<g id="node54" class="node">
<title>gpu6_layer7_ffn_up</title>
<polygon fill="#54a0ff" stroke="black" points="22026.26,-145.5 21889.26,-145.5 21889.26,-82.5 22026.26,-82.5 22026.26,-145.5"/>
<text text-anchor="middle" x="21957.76" y="-133.5" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="21957.76" y="-122.5" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="21957.76" y="-111.5" font-family="Arial" font-size="10.00">[hidden_dim, 4*hidden_dim]</text>
<text text-anchor="middle" x="21957.76" y="-100.5" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="21957.76" y="-89.5" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu6_layer7_attn_layernorm&#45;&gt;gpu6_layer7_ffn_up -->
<g id="edge47" class="edge">
<title>gpu6_layer7_attn_layernorm&#45;&gt;gpu6_layer7_ffn_up</title>
<path fill="none" stroke="green" d="M21642.56,-116C21642.56,-116 21878.99,-116 21878.99,-116"/>
<polygon fill="green" stroke="green" points="21878.99,-119.5 21888.99,-116 21878.99,-112.5 21878.99,-119.5"/>
<text text-anchor="middle" x="21765.76" y="-134.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="21765.76" y="-119.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu6_layer7_ffn_act -->
<g id="node55" class="node">
<title>gpu6_layer7_ffn_act</title>
<ellipse fill="#54a0ff" stroke="black" cx="22402.3" cy="-116" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="22402.3" y="-124.5" font-family="Arial" font-size="10.00">Activation</text>
<text text-anchor="middle" x="22402.3" y="-113.5" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="22402.3" y="-102.5" font-family="Arial" font-size="10.00">[batch, seq, 4*hidden_dim]</text>
</g>
<!-- gpu6_layer7_ffn_up&#45;&gt;gpu6_layer7_ffn_act -->
<g id="edge48" class="edge">
<title>gpu6_layer7_ffn_up&#45;&gt;gpu6_layer7_ffn_act</title>
<path fill="none" stroke="green" d="M22026.73,-116C22026.73,-116 22297.95,-116 22297.95,-116"/>
<polygon fill="green" stroke="green" points="22297.95,-119.5 22307.95,-116 22297.95,-112.5 22297.95,-119.5"/>
<text text-anchor="middle" x="22167.26" y="-134.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="22167.26" y="-119.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu6_layer7_ffn_down -->
<g id="node56" class="node">
<title>gpu6_layer7_ffn_down</title>
<polygon fill="#54a0ff" stroke="black" points="22915.35,-145.5 22778.35,-145.5 22778.35,-82.5 22915.35,-82.5 22915.35,-145.5"/>
<text text-anchor="middle" x="22846.85" y="-133.5" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="22846.85" y="-122.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="22846.85" y="-111.5" font-family="Arial" font-size="10.00">[4*hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="22846.85" y="-100.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="22846.85" y="-89.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu6_layer7_ffn_act&#45;&gt;gpu6_layer7_ffn_down -->
<g id="edge49" class="edge">
<title>gpu6_layer7_ffn_act&#45;&gt;gpu6_layer7_ffn_down</title>
<path fill="none" stroke="green" d="M22496.58,-116C22496.58,-116 22768.1,-116 22768.1,-116"/>
<polygon fill="green" stroke="green" points="22768.1,-119.5 22778.1,-116 22768.1,-112.5 22768.1,-119.5"/>
<text text-anchor="middle" x="22637.35" y="-134.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="22637.35" y="-119.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu6_layer7_ffn_layernorm -->
<g id="node57" class="node">
<title>gpu6_layer7_ffn_layernorm</title>
<ellipse fill="#54a0ff" stroke="black" cx="23250.03" cy="-116" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="23250.03" y="-119" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="23250.03" y="-108" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu6_layer7_ffn_down&#45;&gt;gpu6_layer7_ffn_layernorm -->
<g id="edge50" class="edge">
<title>gpu6_layer7_ffn_down&#45;&gt;gpu6_layer7_ffn_layernorm</title>
<path fill="none" stroke="red" d="M22915.7,-116C22915.7,-116 23152.08,-116 23152.08,-116"/>
<polygon fill="red" stroke="red" points="23152.08,-119.5 23162.08,-116 23152.08,-112.5 23152.08,-119.5"/>
<text text-anchor="middle" x="23038.85" y="-134.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="23038.85" y="-119.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu7_layer8_attn_qkv -->
<g id="node58" class="node">
<title>gpu7_layer8_attn_qkv</title>
<polygon fill="#5f27cd" stroke="black" points="23721.71,-153 23584.71,-153 23584.71,-79 23721.71,-79 23721.71,-153"/>
<text text-anchor="middle" x="23653.21" y="-141" font-family="Arial" font-size="10.00">Layer 8</text>
<text text-anchor="middle" x="23653.21" y="-130" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="23653.21" y="-119" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="23653.21" y="-108" font-family="Arial" font-size="10.00">[hidden_dim, 3*hidden_dim]</text>
<text text-anchor="middle" x="23653.21" y="-97" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="23653.21" y="-86" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu6_layer7_ffn_layernorm&#45;&gt;gpu7_layer8_attn_qkv -->
<g id="edge120" class="edge">
<title>gpu6_layer7_ffn_layernorm&#45;&gt;gpu7_layer8_attn_qkv</title>
<path fill="none" stroke="purple" stroke-width="2" stroke-dasharray="5,2" d="M23338.01,-116C23338.01,-116 23574.44,-116 23574.44,-116"/>
<polygon fill="purple" stroke="purple" stroke-width="2" points="23574.44,-119.5 23584.44,-116 23574.44,-112.5 23574.44,-119.5"/>
<text text-anchor="middle" x="23461.21" y="-134.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="23461.21" y="-119.8" font-family="Times,serif" font-size="14.00">GPU6→GPU7</text>
</g>
<!-- gpu7_layer8_attn_score -->
<g id="node59" class="node">
<title>gpu7_layer8_attn_score</title>
<polygon fill="#5f27cd" stroke="black" points="24125.71,-143.5 24003.71,-143.5 24003.71,-102.5 24125.71,-102.5 24125.71,-143.5"/>
<text text-anchor="middle" x="24064.71" y="-131.5" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="24064.71" y="-120.5" font-family="Arial" font-size="10.00">Score Computation</text>
<text text-anchor="middle" x="24064.71" y="-109.5" font-family="Arial" font-size="10.00">[batch, heads, seq, seq]</text>
</g>
<!-- gpu7_layer8_attn_qkv&#45;&gt;gpu7_layer8_attn_score -->
<g id="edge51" class="edge">
<title>gpu7_layer8_attn_qkv&#45;&gt;gpu7_layer8_attn_score</title>
<path fill="none" stroke="blue" d="M23722.09,-123C23722.09,-123 23993.67,-123 23993.67,-123"/>
<polygon fill="blue" stroke="blue" points="23993.67,-126.5 24003.67,-123 23993.67,-119.5 23993.67,-126.5"/>
<text text-anchor="middle" x="23862.71" y="-141.8" font-family="Times,serif" font-size="14.00">[1024, seq, 3*hidden/tp]</text>
<text text-anchor="middle" x="23862.71" y="-126.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu7_layer8_attn_dense -->
<g id="node60" class="node">
<title>gpu7_layer8_attn_dense</title>
<polygon fill="#5f27cd" stroke="black" points="24519.71,-152.5 24391.71,-152.5 24391.71,-89.5 24519.71,-89.5 24519.71,-152.5"/>
<text text-anchor="middle" x="24455.71" y="-140.5" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="24455.71" y="-129.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="24455.71" y="-118.5" font-family="Arial" font-size="10.00">[hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="24455.71" y="-107.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="24455.71" y="-96.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu7_layer8_attn_score&#45;&gt;gpu7_layer8_attn_dense -->
<g id="edge52" class="edge">
<title>gpu7_layer8_attn_score&#45;&gt;gpu7_layer8_attn_dense</title>
<path fill="none" stroke="blue" d="M24125.8,-123C24125.8,-123 24381.47,-123 24381.47,-123"/>
<polygon fill="blue" stroke="blue" points="24381.47,-126.5 24391.47,-123 24381.47,-119.5 24381.47,-126.5"/>
<text text-anchor="middle" x="24258.71" y="-141.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden/tp]</text>
<text text-anchor="middle" x="24258.71" y="-126.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu7_layer8_attn_layernorm -->
<g id="node61" class="node">
<title>gpu7_layer8_attn_layernorm</title>
<ellipse fill="#5f27cd" stroke="black" cx="24854.39" cy="-123" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="24854.39" y="-126" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="24854.39" y="-115" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu7_layer8_attn_dense&#45;&gt;gpu7_layer8_attn_layernorm -->
<g id="edge53" class="edge">
<title>gpu7_layer8_attn_dense&#45;&gt;gpu7_layer8_attn_layernorm</title>
<path fill="none" stroke="red" d="M24519.76,-123C24519.76,-123 24756.35,-123 24756.35,-123"/>
<polygon fill="red" stroke="red" points="24756.35,-126.5 24766.35,-123 24756.35,-119.5 24756.35,-126.5"/>
<text text-anchor="middle" x="24643.21" y="-141.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="24643.21" y="-126.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu7_layer8_ffn_up -->
<g id="node62" class="node">
<title>gpu7_layer8_ffn_up</title>
<polygon fill="#5f27cd" stroke="black" points="25326.07,-152.5 25189.07,-152.5 25189.07,-89.5 25326.07,-89.5 25326.07,-152.5"/>
<text text-anchor="middle" x="25257.57" y="-140.5" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="25257.57" y="-129.5" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="25257.57" y="-118.5" font-family="Arial" font-size="10.00">[hidden_dim, 4*hidden_dim]</text>
<text text-anchor="middle" x="25257.57" y="-107.5" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="25257.57" y="-96.5" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu7_layer8_attn_layernorm&#45;&gt;gpu7_layer8_ffn_up -->
<g id="edge54" class="edge">
<title>gpu7_layer8_attn_layernorm&#45;&gt;gpu7_layer8_ffn_up</title>
<path fill="none" stroke="green" d="M24942.37,-123C24942.37,-123 25178.8,-123 25178.8,-123"/>
<polygon fill="green" stroke="green" points="25178.8,-126.5 25188.8,-123 25178.8,-119.5 25178.8,-126.5"/>
<text text-anchor="middle" x="25065.57" y="-141.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="25065.57" y="-126.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu7_layer8_ffn_act -->
<g id="node63" class="node">
<title>gpu7_layer8_ffn_act</title>
<ellipse fill="#5f27cd" stroke="black" cx="25702.12" cy="-123" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="25702.12" y="-131.5" font-family="Arial" font-size="10.00">Activation</text>
<text text-anchor="middle" x="25702.12" y="-120.5" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="25702.12" y="-109.5" font-family="Arial" font-size="10.00">[batch, seq, 4*hidden_dim]</text>
</g>
<!-- gpu7_layer8_ffn_up&#45;&gt;gpu7_layer8_ffn_act -->
<g id="edge55" class="edge">
<title>gpu7_layer8_ffn_up&#45;&gt;gpu7_layer8_ffn_act</title>
<path fill="none" stroke="green" d="M25326.54,-123C25326.54,-123 25597.76,-123 25597.76,-123"/>
<polygon fill="green" stroke="green" points="25597.76,-126.5 25607.76,-123 25597.76,-119.5 25597.76,-126.5"/>
<text text-anchor="middle" x="25467.07" y="-141.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="25467.07" y="-126.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu7_layer8_ffn_down -->
<g id="node64" class="node">
<title>gpu7_layer8_ffn_down</title>
<polygon fill="#5f27cd" stroke="black" points="26215.16,-152.5 26078.16,-152.5 26078.16,-89.5 26215.16,-89.5 26215.16,-152.5"/>
<text text-anchor="middle" x="26146.66" y="-140.5" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="26146.66" y="-129.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="26146.66" y="-118.5" font-family="Arial" font-size="10.00">[4*hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="26146.66" y="-107.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="26146.66" y="-96.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu7_layer8_ffn_act&#45;&gt;gpu7_layer8_ffn_down -->
<g id="edge56" class="edge">
<title>gpu7_layer8_ffn_act&#45;&gt;gpu7_layer8_ffn_down</title>
<path fill="none" stroke="green" d="M25796.39,-123C25796.39,-123 26067.92,-123 26067.92,-123"/>
<polygon fill="green" stroke="green" points="26067.92,-126.5 26077.92,-123 26067.92,-119.5 26067.92,-126.5"/>
<text text-anchor="middle" x="25937.16" y="-141.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="25937.16" y="-126.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu7_layer8_ffn_layernorm -->
<g id="node65" class="node">
<title>gpu7_layer8_ffn_layernorm</title>
<ellipse fill="#5f27cd" stroke="black" cx="26549.84" cy="-123" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="26549.84" y="-126" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="26549.84" y="-115" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu7_layer8_ffn_down&#45;&gt;gpu7_layer8_ffn_layernorm -->
<g id="edge57" class="edge">
<title>gpu7_layer8_ffn_down&#45;&gt;gpu7_layer8_ffn_layernorm</title>
<path fill="none" stroke="red" d="M26215.51,-123C26215.51,-123 26451.9,-123 26451.9,-123"/>
<polygon fill="red" stroke="red" points="26451.9,-126.5 26461.9,-123 26451.9,-119.5 26451.9,-126.5"/>
<text text-anchor="middle" x="26338.66" y="-141.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="26338.66" y="-126.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu8_layer9_attn_qkv -->
<g id="node66" class="node">
<title>gpu8_layer9_attn_qkv</title>
<polygon fill="#00d2d3" stroke="black" points="27021.53,-160 26884.53,-160 26884.53,-86 27021.53,-86 27021.53,-160"/>
<text text-anchor="middle" x="26953.03" y="-148" font-family="Arial" font-size="10.00">Layer 9</text>
<text text-anchor="middle" x="26953.03" y="-137" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="26953.03" y="-126" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="26953.03" y="-115" font-family="Arial" font-size="10.00">[hidden_dim, 3*hidden_dim]</text>
<text text-anchor="middle" x="26953.03" y="-104" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="26953.03" y="-93" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu7_layer8_ffn_layernorm&#45;&gt;gpu8_layer9_attn_qkv -->
<g id="edge121" class="edge">
<title>gpu7_layer8_ffn_layernorm&#45;&gt;gpu8_layer9_attn_qkv</title>
<path fill="none" stroke="purple" stroke-width="2" stroke-dasharray="5,2" d="M26637.83,-123C26637.83,-123 26874.25,-123 26874.25,-123"/>
<polygon fill="purple" stroke="purple" stroke-width="2" points="26874.25,-126.5 26884.25,-123 26874.25,-119.5 26874.25,-126.5"/>
<text text-anchor="middle" x="26761.03" y="-141.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="26761.03" y="-126.8" font-family="Times,serif" font-size="14.00">GPU7→GPU8</text>
</g>
<!-- gpu8_layer9_attn_score -->
<g id="node67" class="node">
<title>gpu8_layer9_attn_score</title>
<polygon fill="#00d2d3" stroke="black" points="27425.53,-150.5 27303.53,-150.5 27303.53,-109.5 27425.53,-109.5 27425.53,-150.5"/>
<text text-anchor="middle" x="27364.53" y="-138.5" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="27364.53" y="-127.5" font-family="Arial" font-size="10.00">Score Computation</text>
<text text-anchor="middle" x="27364.53" y="-116.5" font-family="Arial" font-size="10.00">[batch, heads, seq, seq]</text>
</g>
<!-- gpu8_layer9_attn_qkv&#45;&gt;gpu8_layer9_attn_score -->
<g id="edge58" class="edge">
<title>gpu8_layer9_attn_qkv&#45;&gt;gpu8_layer9_attn_score</title>
<path fill="none" stroke="blue" d="M27021.9,-130C27021.9,-130 27293.49,-130 27293.49,-130"/>
<polygon fill="blue" stroke="blue" points="27293.49,-133.5 27303.49,-130 27293.49,-126.5 27293.49,-133.5"/>
<text text-anchor="middle" x="27162.53" y="-148.8" font-family="Times,serif" font-size="14.00">[1024, seq, 3*hidden/tp]</text>
<text text-anchor="middle" x="27162.53" y="-133.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu8_layer9_attn_dense -->
<g id="node68" class="node">
<title>gpu8_layer9_attn_dense</title>
<polygon fill="#00d2d3" stroke="black" points="27819.53,-159.5 27691.53,-159.5 27691.53,-96.5 27819.53,-96.5 27819.53,-159.5"/>
<text text-anchor="middle" x="27755.53" y="-147.5" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="27755.53" y="-136.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="27755.53" y="-125.5" font-family="Arial" font-size="10.00">[hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="27755.53" y="-114.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="27755.53" y="-103.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu8_layer9_attn_score&#45;&gt;gpu8_layer9_attn_dense -->
<g id="edge59" class="edge">
<title>gpu8_layer9_attn_score&#45;&gt;gpu8_layer9_attn_dense</title>
<path fill="none" stroke="blue" d="M27425.62,-130C27425.62,-130 27681.29,-130 27681.29,-130"/>
<polygon fill="blue" stroke="blue" points="27681.29,-133.5 27691.29,-130 27681.29,-126.5 27681.29,-133.5"/>
<text text-anchor="middle" x="27558.53" y="-148.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden/tp]</text>
<text text-anchor="middle" x="27558.53" y="-133.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu8_layer9_attn_layernorm -->
<g id="node69" class="node">
<title>gpu8_layer9_attn_layernorm</title>
<ellipse fill="#00d2d3" stroke="black" cx="28154.21" cy="-130" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="28154.21" y="-133" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="28154.21" y="-122" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu8_layer9_attn_dense&#45;&gt;gpu8_layer9_attn_layernorm -->
<g id="edge60" class="edge">
<title>gpu8_layer9_attn_dense&#45;&gt;gpu8_layer9_attn_layernorm</title>
<path fill="none" stroke="red" d="M27819.58,-130C27819.58,-130 28056.16,-130 28056.16,-130"/>
<polygon fill="red" stroke="red" points="28056.16,-133.5 28066.16,-130 28056.16,-126.5 28056.16,-133.5"/>
<text text-anchor="middle" x="27943.03" y="-148.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="27943.03" y="-133.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu8_layer9_ffn_up -->
<g id="node70" class="node">
<title>gpu8_layer9_ffn_up</title>
<polygon fill="#00d2d3" stroke="black" points="28625.89,-159.5 28488.89,-159.5 28488.89,-96.5 28625.89,-96.5 28625.89,-159.5"/>
<text text-anchor="middle" x="28557.39" y="-147.5" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="28557.39" y="-136.5" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="28557.39" y="-125.5" font-family="Arial" font-size="10.00">[hidden_dim, 4*hidden_dim]</text>
<text text-anchor="middle" x="28557.39" y="-114.5" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="28557.39" y="-103.5" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu8_layer9_attn_layernorm&#45;&gt;gpu8_layer9_ffn_up -->
<g id="edge61" class="edge">
<title>gpu8_layer9_attn_layernorm&#45;&gt;gpu8_layer9_ffn_up</title>
<path fill="none" stroke="green" d="M28242.19,-130C28242.19,-130 28478.62,-130 28478.62,-130"/>
<polygon fill="green" stroke="green" points="28478.62,-133.5 28488.62,-130 28478.62,-126.5 28478.62,-133.5"/>
<text text-anchor="middle" x="28365.39" y="-148.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="28365.39" y="-133.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu8_layer9_ffn_act -->
<g id="node71" class="node">
<title>gpu8_layer9_ffn_act</title>
<ellipse fill="#00d2d3" stroke="black" cx="29001.93" cy="-130" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="29001.93" y="-138.5" font-family="Arial" font-size="10.00">Activation</text>
<text text-anchor="middle" x="29001.93" y="-127.5" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="29001.93" y="-116.5" font-family="Arial" font-size="10.00">[batch, seq, 4*hidden_dim]</text>
</g>
<!-- gpu8_layer9_ffn_up&#45;&gt;gpu8_layer9_ffn_act -->
<g id="edge62" class="edge">
<title>gpu8_layer9_ffn_up&#45;&gt;gpu8_layer9_ffn_act</title>
<path fill="none" stroke="green" d="M28626.36,-130C28626.36,-130 28897.58,-130 28897.58,-130"/>
<polygon fill="green" stroke="green" points="28897.58,-133.5 28907.58,-130 28897.58,-126.5 28897.58,-133.5"/>
<text text-anchor="middle" x="28766.89" y="-148.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="28766.89" y="-133.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu8_layer9_ffn_down -->
<g id="node72" class="node">
<title>gpu8_layer9_ffn_down</title>
<polygon fill="#00d2d3" stroke="black" points="29514.98,-159.5 29377.98,-159.5 29377.98,-96.5 29514.98,-96.5 29514.98,-159.5"/>
<text text-anchor="middle" x="29446.48" y="-147.5" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="29446.48" y="-136.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="29446.48" y="-125.5" font-family="Arial" font-size="10.00">[4*hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="29446.48" y="-114.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="29446.48" y="-103.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu8_layer9_ffn_act&#45;&gt;gpu8_layer9_ffn_down -->
<g id="edge63" class="edge">
<title>gpu8_layer9_ffn_act&#45;&gt;gpu8_layer9_ffn_down</title>
<path fill="none" stroke="green" d="M29096.21,-130C29096.21,-130 29367.73,-130 29367.73,-130"/>
<polygon fill="green" stroke="green" points="29367.73,-133.5 29377.73,-130 29367.73,-126.5 29367.73,-133.5"/>
<text text-anchor="middle" x="29236.98" y="-148.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="29236.98" y="-133.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu8_layer9_ffn_layernorm -->
<g id="node73" class="node">
<title>gpu8_layer9_ffn_layernorm</title>
<ellipse fill="#00d2d3" stroke="black" cx="29849.66" cy="-130" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="29849.66" y="-133" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="29849.66" y="-122" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu8_layer9_ffn_down&#45;&gt;gpu8_layer9_ffn_layernorm -->
<g id="edge64" class="edge">
<title>gpu8_layer9_ffn_down&#45;&gt;gpu8_layer9_ffn_layernorm</title>
<path fill="none" stroke="red" d="M29515.33,-130C29515.33,-130 29751.71,-130 29751.71,-130"/>
<polygon fill="red" stroke="red" points="29751.71,-133.5 29761.71,-130 29751.71,-126.5 29751.71,-133.5"/>
<text text-anchor="middle" x="29638.48" y="-148.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="29638.48" y="-133.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu9_layer10_attn_qkv -->
<g id="node74" class="node">
<title>gpu9_layer10_attn_qkv</title>
<polygon fill="#ff9f43" stroke="black" points="30321.34,-167 30184.34,-167 30184.34,-93 30321.34,-93 30321.34,-167"/>
<text text-anchor="middle" x="30252.84" y="-155" font-family="Arial" font-size="10.00">Layer 10</text>
<text text-anchor="middle" x="30252.84" y="-144" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="30252.84" y="-133" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="30252.84" y="-122" font-family="Arial" font-size="10.00">[hidden_dim, 3*hidden_dim]</text>
<text text-anchor="middle" x="30252.84" y="-111" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="30252.84" y="-100" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu8_layer9_ffn_layernorm&#45;&gt;gpu9_layer10_attn_qkv -->
<g id="edge122" class="edge">
<title>gpu8_layer9_ffn_layernorm&#45;&gt;gpu9_layer10_attn_qkv</title>
<path fill="none" stroke="purple" stroke-width="2" stroke-dasharray="5,2" d="M29937.64,-130C29937.64,-130 30174.07,-130 30174.07,-130"/>
<polygon fill="purple" stroke="purple" stroke-width="2" points="30174.07,-133.5 30184.07,-130 30174.07,-126.5 30174.07,-133.5"/>
<text text-anchor="middle" x="30060.84" y="-148.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="30060.84" y="-133.8" font-family="Times,serif" font-size="14.00">GPU8→GPU9</text>
</g>
<!-- gpu9_layer10_attn_score -->
<g id="node75" class="node">
<title>gpu9_layer10_attn_score</title>
<polygon fill="#ff9f43" stroke="black" points="30725.34,-157.5 30603.34,-157.5 30603.34,-116.5 30725.34,-116.5 30725.34,-157.5"/>
<text text-anchor="middle" x="30664.34" y="-145.5" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="30664.34" y="-134.5" font-family="Arial" font-size="10.00">Score Computation</text>
<text text-anchor="middle" x="30664.34" y="-123.5" font-family="Arial" font-size="10.00">[batch, heads, seq, seq]</text>
</g>
<!-- gpu9_layer10_attn_qkv&#45;&gt;gpu9_layer10_attn_score -->
<g id="edge65" class="edge">
<title>gpu9_layer10_attn_qkv&#45;&gt;gpu9_layer10_attn_score</title>
<path fill="none" stroke="blue" d="M30321.72,-137C30321.72,-137 30593.3,-137 30593.3,-137"/>
<polygon fill="blue" stroke="blue" points="30593.3,-140.5 30603.3,-137 30593.3,-133.5 30593.3,-140.5"/>
<text text-anchor="middle" x="30462.34" y="-155.8" font-family="Times,serif" font-size="14.00">[1024, seq, 3*hidden/tp]</text>
<text text-anchor="middle" x="30462.34" y="-140.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu9_layer10_attn_dense -->
<g id="node76" class="node">
<title>gpu9_layer10_attn_dense</title>
<polygon fill="#ff9f43" stroke="black" points="31119.34,-166.5 30991.34,-166.5 30991.34,-103.5 31119.34,-103.5 31119.34,-166.5"/>
<text text-anchor="middle" x="31055.34" y="-154.5" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="31055.34" y="-143.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="31055.34" y="-132.5" font-family="Arial" font-size="10.00">[hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="31055.34" y="-121.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="31055.34" y="-110.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu9_layer10_attn_score&#45;&gt;gpu9_layer10_attn_dense -->
<g id="edge66" class="edge">
<title>gpu9_layer10_attn_score&#45;&gt;gpu9_layer10_attn_dense</title>
<path fill="none" stroke="blue" d="M30725.43,-137C30725.43,-137 30981.1,-137 30981.1,-137"/>
<polygon fill="blue" stroke="blue" points="30981.1,-140.5 30991.1,-137 30981.1,-133.5 30981.1,-140.5"/>
<text text-anchor="middle" x="30858.34" y="-155.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden/tp]</text>
<text text-anchor="middle" x="30858.34" y="-140.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu9_layer10_attn_layernorm -->
<g id="node77" class="node">
<title>gpu9_layer10_attn_layernorm</title>
<ellipse fill="#ff9f43" stroke="black" cx="31454.02" cy="-137" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="31454.02" y="-140" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="31454.02" y="-129" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu9_layer10_attn_dense&#45;&gt;gpu9_layer10_attn_layernorm -->
<g id="edge67" class="edge">
<title>gpu9_layer10_attn_dense&#45;&gt;gpu9_layer10_attn_layernorm</title>
<path fill="none" stroke="red" d="M31119.4,-137C31119.4,-137 31355.98,-137 31355.98,-137"/>
<polygon fill="red" stroke="red" points="31355.98,-140.5 31365.98,-137 31355.98,-133.5 31355.98,-140.5"/>
<text text-anchor="middle" x="31242.84" y="-155.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="31242.84" y="-140.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu9_layer10_ffn_up -->
<g id="node78" class="node">
<title>gpu9_layer10_ffn_up</title>
<polygon fill="#ff9f43" stroke="black" points="31925.7,-166.5 31788.7,-166.5 31788.7,-103.5 31925.7,-103.5 31925.7,-166.5"/>
<text text-anchor="middle" x="31857.2" y="-154.5" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="31857.2" y="-143.5" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="31857.2" y="-132.5" font-family="Arial" font-size="10.00">[hidden_dim, 4*hidden_dim]</text>
<text text-anchor="middle" x="31857.2" y="-121.5" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="31857.2" y="-110.5" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu9_layer10_attn_layernorm&#45;&gt;gpu9_layer10_ffn_up -->
<g id="edge68" class="edge">
<title>gpu9_layer10_attn_layernorm&#45;&gt;gpu9_layer10_ffn_up</title>
<path fill="none" stroke="green" d="M31542,-137C31542,-137 31778.43,-137 31778.43,-137"/>
<polygon fill="green" stroke="green" points="31778.43,-140.5 31788.43,-137 31778.43,-133.5 31778.43,-140.5"/>
<text text-anchor="middle" x="31665.2" y="-155.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="31665.2" y="-140.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu9_layer10_ffn_act -->
<g id="node79" class="node">
<title>gpu9_layer10_ffn_act</title>
<ellipse fill="#ff9f43" stroke="black" cx="32301.75" cy="-137" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="32301.75" y="-145.5" font-family="Arial" font-size="10.00">Activation</text>
<text text-anchor="middle" x="32301.75" y="-134.5" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="32301.75" y="-123.5" font-family="Arial" font-size="10.00">[batch, seq, 4*hidden_dim]</text>
</g>
<!-- gpu9_layer10_ffn_up&#45;&gt;gpu9_layer10_ffn_act -->
<g id="edge69" class="edge">
<title>gpu9_layer10_ffn_up&#45;&gt;gpu9_layer10_ffn_act</title>
<path fill="none" stroke="green" d="M31926.18,-137C31926.18,-137 32197.39,-137 32197.39,-137"/>
<polygon fill="green" stroke="green" points="32197.39,-140.5 32207.39,-137 32197.39,-133.5 32197.39,-140.5"/>
<text text-anchor="middle" x="32066.7" y="-155.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="32066.7" y="-140.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu9_layer10_ffn_down -->
<g id="node80" class="node">
<title>gpu9_layer10_ffn_down</title>
<polygon fill="#ff9f43" stroke="black" points="32814.79,-166.5 32677.79,-166.5 32677.79,-103.5 32814.79,-103.5 32814.79,-166.5"/>
<text text-anchor="middle" x="32746.29" y="-154.5" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="32746.29" y="-143.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="32746.29" y="-132.5" font-family="Arial" font-size="10.00">[4*hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="32746.29" y="-121.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="32746.29" y="-110.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu9_layer10_ffn_act&#45;&gt;gpu9_layer10_ffn_down -->
<g id="edge70" class="edge">
<title>gpu9_layer10_ffn_act&#45;&gt;gpu9_layer10_ffn_down</title>
<path fill="none" stroke="green" d="M32396.02,-137C32396.02,-137 32667.55,-137 32667.55,-137"/>
<polygon fill="green" stroke="green" points="32667.55,-140.5 32677.55,-137 32667.55,-133.5 32667.55,-140.5"/>
<text text-anchor="middle" x="32536.79" y="-155.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="32536.79" y="-140.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu9_layer10_ffn_layernorm -->
<g id="node81" class="node">
<title>gpu9_layer10_ffn_layernorm</title>
<ellipse fill="#ff9f43" stroke="black" cx="33149.47" cy="-137" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="33149.47" y="-140" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="33149.47" y="-129" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu9_layer10_ffn_down&#45;&gt;gpu9_layer10_ffn_layernorm -->
<g id="edge71" class="edge">
<title>gpu9_layer10_ffn_down&#45;&gt;gpu9_layer10_ffn_layernorm</title>
<path fill="none" stroke="red" d="M32815.14,-137C32815.14,-137 33051.53,-137 33051.53,-137"/>
<polygon fill="red" stroke="red" points="33051.53,-140.5 33061.53,-137 33051.53,-133.5 33051.53,-140.5"/>
<text text-anchor="middle" x="32938.29" y="-155.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="32938.29" y="-140.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu10_layer11_attn_qkv -->
<g id="node82" class="node">
<title>gpu10_layer11_attn_qkv</title>
<polygon fill="#ee5a24" stroke="black" points="33621.16,-174 33484.16,-174 33484.16,-100 33621.16,-100 33621.16,-174"/>
<text text-anchor="middle" x="33552.66" y="-162" font-family="Arial" font-size="10.00">Layer 11</text>
<text text-anchor="middle" x="33552.66" y="-151" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="33552.66" y="-140" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="33552.66" y="-129" font-family="Arial" font-size="10.00">[hidden_dim, 3*hidden_dim]</text>
<text text-anchor="middle" x="33552.66" y="-118" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="33552.66" y="-107" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu9_layer10_ffn_layernorm&#45;&gt;gpu10_layer11_attn_qkv -->
<g id="edge123" class="edge">
<title>gpu9_layer10_ffn_layernorm&#45;&gt;gpu10_layer11_attn_qkv</title>
<path fill="none" stroke="purple" stroke-width="2" stroke-dasharray="5,2" d="M33237.46,-137C33237.46,-137 33473.89,-137 33473.89,-137"/>
<polygon fill="purple" stroke="purple" stroke-width="2" points="33473.89,-140.5 33483.89,-137 33473.89,-133.5 33473.89,-140.5"/>
<text text-anchor="middle" x="33360.66" y="-155.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="33360.66" y="-140.8" font-family="Times,serif" font-size="14.00">GPU9→GPU10</text>
</g>
<!-- gpu10_layer11_attn_score -->
<g id="node83" class="node">
<title>gpu10_layer11_attn_score</title>
<polygon fill="#ee5a24" stroke="black" points="34025.16,-164.5 33903.16,-164.5 33903.16,-123.5 34025.16,-123.5 34025.16,-164.5"/>
<text text-anchor="middle" x="33964.16" y="-152.5" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="33964.16" y="-141.5" font-family="Arial" font-size="10.00">Score Computation</text>
<text text-anchor="middle" x="33964.16" y="-130.5" font-family="Arial" font-size="10.00">[batch, heads, seq, seq]</text>
</g>
<!-- gpu10_layer11_attn_qkv&#45;&gt;gpu10_layer11_attn_score -->
<g id="edge72" class="edge">
<title>gpu10_layer11_attn_qkv&#45;&gt;gpu10_layer11_attn_score</title>
<path fill="none" stroke="blue" d="M33621.53,-144C33621.53,-144 33893.12,-144 33893.12,-144"/>
<polygon fill="blue" stroke="blue" points="33893.12,-147.5 33903.12,-144 33893.12,-140.5 33893.12,-147.5"/>
<text text-anchor="middle" x="33762.16" y="-162.8" font-family="Times,serif" font-size="14.00">[1024, seq, 3*hidden/tp]</text>
<text text-anchor="middle" x="33762.16" y="-147.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu10_layer11_attn_dense -->
<g id="node84" class="node">
<title>gpu10_layer11_attn_dense</title>
<polygon fill="#ee5a24" stroke="black" points="34419.16,-173.5 34291.16,-173.5 34291.16,-110.5 34419.16,-110.5 34419.16,-173.5"/>
<text text-anchor="middle" x="34355.16" y="-161.5" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="34355.16" y="-150.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="34355.16" y="-139.5" font-family="Arial" font-size="10.00">[hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="34355.16" y="-128.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="34355.16" y="-117.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu10_layer11_attn_score&#45;&gt;gpu10_layer11_attn_dense -->
<g id="edge73" class="edge">
<title>gpu10_layer11_attn_score&#45;&gt;gpu10_layer11_attn_dense</title>
<path fill="none" stroke="blue" d="M34025.25,-144C34025.25,-144 34280.92,-144 34280.92,-144"/>
<polygon fill="blue" stroke="blue" points="34280.92,-147.5 34290.92,-144 34280.92,-140.5 34280.92,-147.5"/>
<text text-anchor="middle" x="34158.16" y="-162.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden/tp]</text>
<text text-anchor="middle" x="34158.16" y="-147.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu10_layer11_attn_layernorm -->
<g id="node85" class="node">
<title>gpu10_layer11_attn_layernorm</title>
<ellipse fill="#ee5a24" stroke="black" cx="34753.84" cy="-144" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="34753.84" y="-147" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="34753.84" y="-136" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu10_layer11_attn_dense&#45;&gt;gpu10_layer11_attn_layernorm -->
<g id="edge74" class="edge">
<title>gpu10_layer11_attn_dense&#45;&gt;gpu10_layer11_attn_layernorm</title>
<path fill="none" stroke="red" d="M34419.21,-144C34419.21,-144 34655.79,-144 34655.79,-144"/>
<polygon fill="red" stroke="red" points="34655.79,-147.5 34665.79,-144 34655.79,-140.5 34655.79,-147.5"/>
<text text-anchor="middle" x="34542.66" y="-162.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="34542.66" y="-147.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu10_layer11_ffn_up -->
<g id="node86" class="node">
<title>gpu10_layer11_ffn_up</title>
<polygon fill="#ee5a24" stroke="black" points="35225.52,-173.5 35088.52,-173.5 35088.52,-110.5 35225.52,-110.5 35225.52,-173.5"/>
<text text-anchor="middle" x="35157.02" y="-161.5" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="35157.02" y="-150.5" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="35157.02" y="-139.5" font-family="Arial" font-size="10.00">[hidden_dim, 4*hidden_dim]</text>
<text text-anchor="middle" x="35157.02" y="-128.5" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="35157.02" y="-117.5" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu10_layer11_attn_layernorm&#45;&gt;gpu10_layer11_ffn_up -->
<g id="edge75" class="edge">
<title>gpu10_layer11_attn_layernorm&#45;&gt;gpu10_layer11_ffn_up</title>
<path fill="none" stroke="green" d="M34841.82,-144C34841.82,-144 35078.25,-144 35078.25,-144"/>
<polygon fill="green" stroke="green" points="35078.25,-147.5 35088.25,-144 35078.25,-140.5 35078.25,-147.5"/>
<text text-anchor="middle" x="34965.02" y="-162.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="34965.02" y="-147.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu10_layer11_ffn_act -->
<g id="node87" class="node">
<title>gpu10_layer11_ffn_act</title>
<ellipse fill="#ee5a24" stroke="black" cx="35601.56" cy="-144" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="35601.56" y="-152.5" font-family="Arial" font-size="10.00">Activation</text>
<text text-anchor="middle" x="35601.56" y="-141.5" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="35601.56" y="-130.5" font-family="Arial" font-size="10.00">[batch, seq, 4*hidden_dim]</text>
</g>
<!-- gpu10_layer11_ffn_up&#45;&gt;gpu10_layer11_ffn_act -->
<g id="edge76" class="edge">
<title>gpu10_layer11_ffn_up&#45;&gt;gpu10_layer11_ffn_act</title>
<path fill="none" stroke="green" d="M35225.99,-144C35225.99,-144 35497.21,-144 35497.21,-144"/>
<polygon fill="green" stroke="green" points="35497.21,-147.5 35507.21,-144 35497.21,-140.5 35497.21,-147.5"/>
<text text-anchor="middle" x="35366.52" y="-162.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="35366.52" y="-147.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu10_layer11_ffn_down -->
<g id="node88" class="node">
<title>gpu10_layer11_ffn_down</title>
<polygon fill="#ee5a24" stroke="black" points="36114.61,-173.5 35977.61,-173.5 35977.61,-110.5 36114.61,-110.5 36114.61,-173.5"/>
<text text-anchor="middle" x="36046.11" y="-161.5" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="36046.11" y="-150.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="36046.11" y="-139.5" font-family="Arial" font-size="10.00">[4*hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="36046.11" y="-128.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="36046.11" y="-117.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu10_layer11_ffn_act&#45;&gt;gpu10_layer11_ffn_down -->
<g id="edge77" class="edge">
<title>gpu10_layer11_ffn_act&#45;&gt;gpu10_layer11_ffn_down</title>
<path fill="none" stroke="green" d="M35695.84,-144C35695.84,-144 35967.36,-144 35967.36,-144"/>
<polygon fill="green" stroke="green" points="35967.36,-147.5 35977.36,-144 35967.36,-140.5 35967.36,-147.5"/>
<text text-anchor="middle" x="35836.61" y="-162.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="35836.61" y="-147.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu10_layer11_ffn_layernorm -->
<g id="node89" class="node">
<title>gpu10_layer11_ffn_layernorm</title>
<ellipse fill="#ee5a24" stroke="black" cx="36449.29" cy="-144" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="36449.29" y="-147" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="36449.29" y="-136" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu10_layer11_ffn_down&#45;&gt;gpu10_layer11_ffn_layernorm -->
<g id="edge78" class="edge">
<title>gpu10_layer11_ffn_down&#45;&gt;gpu10_layer11_ffn_layernorm</title>
<path fill="none" stroke="red" d="M36114.96,-144C36114.96,-144 36351.34,-144 36351.34,-144"/>
<polygon fill="red" stroke="red" points="36351.34,-147.5 36361.34,-144 36351.34,-140.5 36351.34,-147.5"/>
<text text-anchor="middle" x="36238.11" y="-162.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="36238.11" y="-147.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu11_layer12_attn_qkv -->
<g id="node90" class="node">
<title>gpu11_layer12_attn_qkv</title>
<polygon fill="#009432" stroke="black" points="36920.97,-181 36783.97,-181 36783.97,-107 36920.97,-107 36920.97,-181"/>
<text text-anchor="middle" x="36852.47" y="-169" font-family="Arial" font-size="10.00">Layer 12</text>
<text text-anchor="middle" x="36852.47" y="-158" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="36852.47" y="-147" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="36852.47" y="-136" font-family="Arial" font-size="10.00">[hidden_dim, 3*hidden_dim]</text>
<text text-anchor="middle" x="36852.47" y="-125" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="36852.47" y="-114" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu10_layer11_ffn_layernorm&#45;&gt;gpu11_layer12_attn_qkv -->
<g id="edge124" class="edge">
<title>gpu10_layer11_ffn_layernorm&#45;&gt;gpu11_layer12_attn_qkv</title>
<path fill="none" stroke="purple" stroke-width="2" stroke-dasharray="5,2" d="M36537.27,-144C36537.27,-144 36773.7,-144 36773.7,-144"/>
<polygon fill="purple" stroke="purple" stroke-width="2" points="36773.7,-147.5 36783.7,-144 36773.7,-140.5 36773.7,-147.5"/>
<text text-anchor="middle" x="36660.47" y="-162.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="36660.47" y="-147.8" font-family="Times,serif" font-size="14.00">GPU10→GPU11</text>
</g>
<!-- gpu11_layer12_attn_score -->
<g id="node91" class="node">
<title>gpu11_layer12_attn_score</title>
<polygon fill="#009432" stroke="black" points="37324.97,-171.5 37202.97,-171.5 37202.97,-130.5 37324.97,-130.5 37324.97,-171.5"/>
<text text-anchor="middle" x="37263.97" y="-159.5" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="37263.97" y="-148.5" font-family="Arial" font-size="10.00">Score Computation</text>
<text text-anchor="middle" x="37263.97" y="-137.5" font-family="Arial" font-size="10.00">[batch, heads, seq, seq]</text>
</g>
<!-- gpu11_layer12_attn_qkv&#45;&gt;gpu11_layer12_attn_score -->
<g id="edge79" class="edge">
<title>gpu11_layer12_attn_qkv&#45;&gt;gpu11_layer12_attn_score</title>
<path fill="none" stroke="blue" d="M36921.35,-151C36921.35,-151 37192.93,-151 37192.93,-151"/>
<polygon fill="blue" stroke="blue" points="37192.93,-154.5 37202.93,-151 37192.93,-147.5 37192.93,-154.5"/>
<text text-anchor="middle" x="37061.97" y="-169.8" font-family="Times,serif" font-size="14.00">[1024, seq, 3*hidden/tp]</text>
<text text-anchor="middle" x="37061.97" y="-154.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu11_layer12_attn_dense -->
<g id="node92" class="node">
<title>gpu11_layer12_attn_dense</title>
<polygon fill="#009432" stroke="black" points="37718.97,-180.5 37590.97,-180.5 37590.97,-117.5 37718.97,-117.5 37718.97,-180.5"/>
<text text-anchor="middle" x="37654.97" y="-168.5" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="37654.97" y="-157.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="37654.97" y="-146.5" font-family="Arial" font-size="10.00">[hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="37654.97" y="-135.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="37654.97" y="-124.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu11_layer12_attn_score&#45;&gt;gpu11_layer12_attn_dense -->
<g id="edge80" class="edge">
<title>gpu11_layer12_attn_score&#45;&gt;gpu11_layer12_attn_dense</title>
<path fill="none" stroke="blue" d="M37325.06,-151C37325.06,-151 37580.73,-151 37580.73,-151"/>
<polygon fill="blue" stroke="blue" points="37580.73,-154.5 37590.73,-151 37580.73,-147.5 37580.73,-154.5"/>
<text text-anchor="middle" x="37457.97" y="-169.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden/tp]</text>
<text text-anchor="middle" x="37457.97" y="-154.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu11_layer12_attn_layernorm -->
<g id="node93" class="node">
<title>gpu11_layer12_attn_layernorm</title>
<ellipse fill="#009432" stroke="black" cx="38053.65" cy="-151" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="38053.65" y="-154" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="38053.65" y="-143" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu11_layer12_attn_dense&#45;&gt;gpu11_layer12_attn_layernorm -->
<g id="edge81" class="edge">
<title>gpu11_layer12_attn_dense&#45;&gt;gpu11_layer12_attn_layernorm</title>
<path fill="none" stroke="red" d="M37719.03,-151C37719.03,-151 37955.61,-151 37955.61,-151"/>
<polygon fill="red" stroke="red" points="37955.61,-154.5 37965.61,-151 37955.61,-147.5 37955.61,-154.5"/>
<text text-anchor="middle" x="37842.47" y="-169.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="37842.47" y="-154.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu11_layer12_ffn_up -->
<g id="node94" class="node">
<title>gpu11_layer12_ffn_up</title>
<polygon fill="#009432" stroke="black" points="38525.33,-180.5 38388.33,-180.5 38388.33,-117.5 38525.33,-117.5 38525.33,-180.5"/>
<text text-anchor="middle" x="38456.83" y="-168.5" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="38456.83" y="-157.5" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="38456.83" y="-146.5" font-family="Arial" font-size="10.00">[hidden_dim, 4*hidden_dim]</text>
<text text-anchor="middle" x="38456.83" y="-135.5" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="38456.83" y="-124.5" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu11_layer12_attn_layernorm&#45;&gt;gpu11_layer12_ffn_up -->
<g id="edge82" class="edge">
<title>gpu11_layer12_attn_layernorm&#45;&gt;gpu11_layer12_ffn_up</title>
<path fill="none" stroke="green" d="M38141.63,-151C38141.63,-151 38378.06,-151 38378.06,-151"/>
<polygon fill="green" stroke="green" points="38378.06,-154.5 38388.06,-151 38378.06,-147.5 38378.06,-154.5"/>
<text text-anchor="middle" x="38264.83" y="-169.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="38264.83" y="-154.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu11_layer12_ffn_act -->
<g id="node95" class="node">
<title>gpu11_layer12_ffn_act</title>
<ellipse fill="#009432" stroke="black" cx="38901.38" cy="-151" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="38901.38" y="-159.5" font-family="Arial" font-size="10.00">Activation</text>
<text text-anchor="middle" x="38901.38" y="-148.5" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="38901.38" y="-137.5" font-family="Arial" font-size="10.00">[batch, seq, 4*hidden_dim]</text>
</g>
<!-- gpu11_layer12_ffn_up&#45;&gt;gpu11_layer12_ffn_act -->
<g id="edge83" class="edge">
<title>gpu11_layer12_ffn_up&#45;&gt;gpu11_layer12_ffn_act</title>
<path fill="none" stroke="green" d="M38525.81,-151C38525.81,-151 38797.02,-151 38797.02,-151"/>
<polygon fill="green" stroke="green" points="38797.02,-154.5 38807.02,-151 38797.02,-147.5 38797.02,-154.5"/>
<text text-anchor="middle" x="38666.33" y="-169.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="38666.33" y="-154.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu11_layer12_ffn_down -->
<g id="node96" class="node">
<title>gpu11_layer12_ffn_down</title>
<polygon fill="#009432" stroke="black" points="39414.42,-180.5 39277.42,-180.5 39277.42,-117.5 39414.42,-117.5 39414.42,-180.5"/>
<text text-anchor="middle" x="39345.92" y="-168.5" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="39345.92" y="-157.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="39345.92" y="-146.5" font-family="Arial" font-size="10.00">[4*hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="39345.92" y="-135.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="39345.92" y="-124.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu11_layer12_ffn_act&#45;&gt;gpu11_layer12_ffn_down -->
<g id="edge84" class="edge">
<title>gpu11_layer12_ffn_act&#45;&gt;gpu11_layer12_ffn_down</title>
<path fill="none" stroke="green" d="M38995.66,-151C38995.66,-151 39267.18,-151 39267.18,-151"/>
<polygon fill="green" stroke="green" points="39267.18,-154.5 39277.18,-151 39267.18,-147.5 39267.18,-154.5"/>
<text text-anchor="middle" x="39136.42" y="-169.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="39136.42" y="-154.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu11_layer12_ffn_layernorm -->
<g id="node97" class="node">
<title>gpu11_layer12_ffn_layernorm</title>
<ellipse fill="#009432" stroke="black" cx="39749.11" cy="-151" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="39749.11" y="-154" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="39749.11" y="-143" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu11_layer12_ffn_down&#45;&gt;gpu11_layer12_ffn_layernorm -->
<g id="edge85" class="edge">
<title>gpu11_layer12_ffn_down&#45;&gt;gpu11_layer12_ffn_layernorm</title>
<path fill="none" stroke="red" d="M39414.78,-151C39414.78,-151 39651.16,-151 39651.16,-151"/>
<polygon fill="red" stroke="red" points="39651.16,-154.5 39661.16,-151 39651.16,-147.5 39651.16,-154.5"/>
<text text-anchor="middle" x="39537.92" y="-169.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="39537.92" y="-154.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu12_layer13_attn_qkv -->
<g id="node98" class="node">
<title>gpu12_layer13_attn_qkv</title>
<polygon fill="#0652dd" stroke="black" points="40220.79,-188 40083.79,-188 40083.79,-114 40220.79,-114 40220.79,-188"/>
<text text-anchor="middle" x="40152.29" y="-176" font-family="Arial" font-size="10.00">Layer 13</text>
<text text-anchor="middle" x="40152.29" y="-165" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="40152.29" y="-154" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="40152.29" y="-143" font-family="Arial" font-size="10.00">[hidden_dim, 3*hidden_dim]</text>
<text text-anchor="middle" x="40152.29" y="-132" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="40152.29" y="-121" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu11_layer12_ffn_layernorm&#45;&gt;gpu12_layer13_attn_qkv -->
<g id="edge125" class="edge">
<title>gpu11_layer12_ffn_layernorm&#45;&gt;gpu12_layer13_attn_qkv</title>
<path fill="none" stroke="purple" stroke-width="2" stroke-dasharray="5,2" d="M39837.09,-151C39837.09,-151 40073.52,-151 40073.52,-151"/>
<polygon fill="purple" stroke="purple" stroke-width="2" points="40073.52,-154.5 40083.52,-151 40073.52,-147.5 40073.52,-154.5"/>
<text text-anchor="middle" x="39960.29" y="-169.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="39960.29" y="-154.8" font-family="Times,serif" font-size="14.00">GPU11→GPU12</text>
</g>
<!-- gpu12_layer13_attn_score -->
<g id="node99" class="node">
<title>gpu12_layer13_attn_score</title>
<polygon fill="#0652dd" stroke="black" points="40624.79,-178.5 40502.79,-178.5 40502.79,-137.5 40624.79,-137.5 40624.79,-178.5"/>
<text text-anchor="middle" x="40563.79" y="-166.5" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="40563.79" y="-155.5" font-family="Arial" font-size="10.00">Score Computation</text>
<text text-anchor="middle" x="40563.79" y="-144.5" font-family="Arial" font-size="10.00">[batch, heads, seq, seq]</text>
</g>
<!-- gpu12_layer13_attn_qkv&#45;&gt;gpu12_layer13_attn_score -->
<g id="edge86" class="edge">
<title>gpu12_layer13_attn_qkv&#45;&gt;gpu12_layer13_attn_score</title>
<path fill="none" stroke="blue" d="M40221.16,-158C40221.16,-158 40492.75,-158 40492.75,-158"/>
<polygon fill="blue" stroke="blue" points="40492.75,-161.5 40502.75,-158 40492.75,-154.5 40492.75,-161.5"/>
<text text-anchor="middle" x="40361.79" y="-176.8" font-family="Times,serif" font-size="14.00">[1024, seq, 3*hidden/tp]</text>
<text text-anchor="middle" x="40361.79" y="-161.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu12_layer13_attn_dense -->
<g id="node100" class="node">
<title>gpu12_layer13_attn_dense</title>
<polygon fill="#0652dd" stroke="black" points="41018.79,-187.5 40890.79,-187.5 40890.79,-124.5 41018.79,-124.5 41018.79,-187.5"/>
<text text-anchor="middle" x="40954.79" y="-175.5" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="40954.79" y="-164.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="40954.79" y="-153.5" font-family="Arial" font-size="10.00">[hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="40954.79" y="-142.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="40954.79" y="-131.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu12_layer13_attn_score&#45;&gt;gpu12_layer13_attn_dense -->
<g id="edge87" class="edge">
<title>gpu12_layer13_attn_score&#45;&gt;gpu12_layer13_attn_dense</title>
<path fill="none" stroke="blue" d="M40624.88,-158C40624.88,-158 40880.55,-158 40880.55,-158"/>
<polygon fill="blue" stroke="blue" points="40880.55,-161.5 40890.55,-158 40880.55,-154.5 40880.55,-161.5"/>
<text text-anchor="middle" x="40757.79" y="-176.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden/tp]</text>
<text text-anchor="middle" x="40757.79" y="-161.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu12_layer13_attn_layernorm -->
<g id="node101" class="node">
<title>gpu12_layer13_attn_layernorm</title>
<ellipse fill="#0652dd" stroke="black" cx="41353.47" cy="-158" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="41353.47" y="-161" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="41353.47" y="-150" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu12_layer13_attn_dense&#45;&gt;gpu12_layer13_attn_layernorm -->
<g id="edge88" class="edge">
<title>gpu12_layer13_attn_dense&#45;&gt;gpu12_layer13_attn_layernorm</title>
<path fill="none" stroke="red" d="M41018.84,-158C41018.84,-158 41255.42,-158 41255.42,-158"/>
<polygon fill="red" stroke="red" points="41255.42,-161.5 41265.42,-158 41255.42,-154.5 41255.42,-161.5"/>
<text text-anchor="middle" x="41142.29" y="-176.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="41142.29" y="-161.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu12_layer13_ffn_up -->
<g id="node102" class="node">
<title>gpu12_layer13_ffn_up</title>
<polygon fill="#0652dd" stroke="black" points="41825.15,-187.5 41688.15,-187.5 41688.15,-124.5 41825.15,-124.5 41825.15,-187.5"/>
<text text-anchor="middle" x="41756.65" y="-175.5" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="41756.65" y="-164.5" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="41756.65" y="-153.5" font-family="Arial" font-size="10.00">[hidden_dim, 4*hidden_dim]</text>
<text text-anchor="middle" x="41756.65" y="-142.5" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="41756.65" y="-131.5" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu12_layer13_attn_layernorm&#45;&gt;gpu12_layer13_ffn_up -->
<g id="edge89" class="edge">
<title>gpu12_layer13_attn_layernorm&#45;&gt;gpu12_layer13_ffn_up</title>
<path fill="none" stroke="green" d="M41441.45,-158C41441.45,-158 41677.88,-158 41677.88,-158"/>
<polygon fill="green" stroke="green" points="41677.88,-161.5 41687.88,-158 41677.88,-154.5 41677.88,-161.5"/>
<text text-anchor="middle" x="41564.65" y="-176.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="41564.65" y="-161.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu12_layer13_ffn_act -->
<g id="node103" class="node">
<title>gpu12_layer13_ffn_act</title>
<ellipse fill="#0652dd" stroke="black" cx="42201.19" cy="-158" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="42201.19" y="-166.5" font-family="Arial" font-size="10.00">Activation</text>
<text text-anchor="middle" x="42201.19" y="-155.5" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="42201.19" y="-144.5" font-family="Arial" font-size="10.00">[batch, seq, 4*hidden_dim]</text>
</g>
<!-- gpu12_layer13_ffn_up&#45;&gt;gpu12_layer13_ffn_act -->
<g id="edge90" class="edge">
<title>gpu12_layer13_ffn_up&#45;&gt;gpu12_layer13_ffn_act</title>
<path fill="none" stroke="green" d="M41825.62,-158C41825.62,-158 42096.84,-158 42096.84,-158"/>
<polygon fill="green" stroke="green" points="42096.84,-161.5 42106.84,-158 42096.84,-154.5 42096.84,-161.5"/>
<text text-anchor="middle" x="41966.15" y="-176.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="41966.15" y="-161.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu12_layer13_ffn_down -->
<g id="node104" class="node">
<title>gpu12_layer13_ffn_down</title>
<polygon fill="#0652dd" stroke="black" points="42714.24,-187.5 42577.24,-187.5 42577.24,-124.5 42714.24,-124.5 42714.24,-187.5"/>
<text text-anchor="middle" x="42645.74" y="-175.5" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="42645.74" y="-164.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="42645.74" y="-153.5" font-family="Arial" font-size="10.00">[4*hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="42645.74" y="-142.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="42645.74" y="-131.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu12_layer13_ffn_act&#45;&gt;gpu12_layer13_ffn_down -->
<g id="edge91" class="edge">
<title>gpu12_layer13_ffn_act&#45;&gt;gpu12_layer13_ffn_down</title>
<path fill="none" stroke="green" d="M42295.47,-158C42295.47,-158 42567,-158 42567,-158"/>
<polygon fill="green" stroke="green" points="42567,-161.5 42577,-158 42567,-154.5 42567,-161.5"/>
<text text-anchor="middle" x="42436.24" y="-176.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="42436.24" y="-161.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu12_layer13_ffn_layernorm -->
<g id="node105" class="node">
<title>gpu12_layer13_ffn_layernorm</title>
<ellipse fill="#0652dd" stroke="black" cx="43048.92" cy="-158" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="43048.92" y="-161" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="43048.92" y="-150" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu12_layer13_ffn_down&#45;&gt;gpu12_layer13_ffn_layernorm -->
<g id="edge92" class="edge">
<title>gpu12_layer13_ffn_down&#45;&gt;gpu12_layer13_ffn_layernorm</title>
<path fill="none" stroke="red" d="M42714.59,-158C42714.59,-158 42950.97,-158 42950.97,-158"/>
<polygon fill="red" stroke="red" points="42950.97,-161.5 42960.97,-158 42950.97,-154.5 42950.97,-161.5"/>
<text text-anchor="middle" x="42837.74" y="-176.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="42837.74" y="-161.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu13_layer14_attn_qkv -->
<g id="node106" class="node">
<title>gpu13_layer14_attn_qkv</title>
<polygon fill="#9980fa" stroke="black" points="43520.6,-195 43383.6,-195 43383.6,-121 43520.6,-121 43520.6,-195"/>
<text text-anchor="middle" x="43452.1" y="-183" font-family="Arial" font-size="10.00">Layer 14</text>
<text text-anchor="middle" x="43452.1" y="-172" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="43452.1" y="-161" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="43452.1" y="-150" font-family="Arial" font-size="10.00">[hidden_dim, 3*hidden_dim]</text>
<text text-anchor="middle" x="43452.1" y="-139" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="43452.1" y="-128" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu12_layer13_ffn_layernorm&#45;&gt;gpu13_layer14_attn_qkv -->
<g id="edge126" class="edge">
<title>gpu12_layer13_ffn_layernorm&#45;&gt;gpu13_layer14_attn_qkv</title>
<path fill="none" stroke="purple" stroke-width="2" stroke-dasharray="5,2" d="M43136.9,-158C43136.9,-158 43373.33,-158 43373.33,-158"/>
<polygon fill="purple" stroke="purple" stroke-width="2" points="43373.33,-161.5 43383.33,-158 43373.33,-154.5 43373.33,-161.5"/>
<text text-anchor="middle" x="43260.1" y="-176.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="43260.1" y="-161.8" font-family="Times,serif" font-size="14.00">GPU12→GPU13</text>
</g>
<!-- gpu13_layer14_attn_score -->
<g id="node107" class="node">
<title>gpu13_layer14_attn_score</title>
<polygon fill="#9980fa" stroke="black" points="43924.6,-185.5 43802.6,-185.5 43802.6,-144.5 43924.6,-144.5 43924.6,-185.5"/>
<text text-anchor="middle" x="43863.6" y="-173.5" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="43863.6" y="-162.5" font-family="Arial" font-size="10.00">Score Computation</text>
<text text-anchor="middle" x="43863.6" y="-151.5" font-family="Arial" font-size="10.00">[batch, heads, seq, seq]</text>
</g>
<!-- gpu13_layer14_attn_qkv&#45;&gt;gpu13_layer14_attn_score -->
<g id="edge93" class="edge">
<title>gpu13_layer14_attn_qkv&#45;&gt;gpu13_layer14_attn_score</title>
<path fill="none" stroke="blue" d="M43520.98,-165C43520.98,-165 43792.57,-165 43792.57,-165"/>
<polygon fill="blue" stroke="blue" points="43792.57,-168.5 43802.57,-165 43792.57,-161.5 43792.57,-168.5"/>
<text text-anchor="middle" x="43661.6" y="-183.8" font-family="Times,serif" font-size="14.00">[1024, seq, 3*hidden/tp]</text>
<text text-anchor="middle" x="43661.6" y="-168.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu13_layer14_attn_dense -->
<g id="node108" class="node">
<title>gpu13_layer14_attn_dense</title>
<polygon fill="#9980fa" stroke="black" points="44318.6,-194.5 44190.6,-194.5 44190.6,-131.5 44318.6,-131.5 44318.6,-194.5"/>
<text text-anchor="middle" x="44254.6" y="-182.5" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="44254.6" y="-171.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="44254.6" y="-160.5" font-family="Arial" font-size="10.00">[hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="44254.6" y="-149.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="44254.6" y="-138.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu13_layer14_attn_score&#45;&gt;gpu13_layer14_attn_dense -->
<g id="edge94" class="edge">
<title>gpu13_layer14_attn_score&#45;&gt;gpu13_layer14_attn_dense</title>
<path fill="none" stroke="blue" d="M43924.7,-165C43924.7,-165 44180.36,-165 44180.36,-165"/>
<polygon fill="blue" stroke="blue" points="44180.36,-168.5 44190.36,-165 44180.36,-161.5 44180.36,-168.5"/>
<text text-anchor="middle" x="44057.6" y="-183.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden/tp]</text>
<text text-anchor="middle" x="44057.6" y="-168.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu13_layer14_attn_layernorm -->
<g id="node109" class="node">
<title>gpu13_layer14_attn_layernorm</title>
<ellipse fill="#9980fa" stroke="black" cx="44653.28" cy="-165" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="44653.28" y="-168" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="44653.28" y="-157" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu13_layer14_attn_dense&#45;&gt;gpu13_layer14_attn_layernorm -->
<g id="edge95" class="edge">
<title>gpu13_layer14_attn_dense&#45;&gt;gpu13_layer14_attn_layernorm</title>
<path fill="none" stroke="red" d="M44318.66,-165C44318.66,-165 44555.24,-165 44555.24,-165"/>
<polygon fill="red" stroke="red" points="44555.24,-168.5 44565.24,-165 44555.24,-161.5 44555.24,-168.5"/>
<text text-anchor="middle" x="44442.1" y="-183.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="44442.1" y="-168.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu13_layer14_ffn_up -->
<g id="node110" class="node">
<title>gpu13_layer14_ffn_up</title>
<polygon fill="#9980fa" stroke="black" points="45124.96,-194.5 44987.96,-194.5 44987.96,-131.5 45124.96,-131.5 45124.96,-194.5"/>
<text text-anchor="middle" x="45056.46" y="-182.5" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="45056.46" y="-171.5" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="45056.46" y="-160.5" font-family="Arial" font-size="10.00">[hidden_dim, 4*hidden_dim]</text>
<text text-anchor="middle" x="45056.46" y="-149.5" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="45056.46" y="-138.5" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu13_layer14_attn_layernorm&#45;&gt;gpu13_layer14_ffn_up -->
<g id="edge96" class="edge">
<title>gpu13_layer14_attn_layernorm&#45;&gt;gpu13_layer14_ffn_up</title>
<path fill="none" stroke="green" d="M44741.26,-165C44741.26,-165 44977.69,-165 44977.69,-165"/>
<polygon fill="green" stroke="green" points="44977.69,-168.5 44987.69,-165 44977.69,-161.5 44977.69,-168.5"/>
<text text-anchor="middle" x="44864.46" y="-183.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="44864.46" y="-168.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu13_layer14_ffn_act -->
<g id="node111" class="node">
<title>gpu13_layer14_ffn_act</title>
<ellipse fill="#9980fa" stroke="black" cx="45501.01" cy="-165" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="45501.01" y="-173.5" font-family="Arial" font-size="10.00">Activation</text>
<text text-anchor="middle" x="45501.01" y="-162.5" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="45501.01" y="-151.5" font-family="Arial" font-size="10.00">[batch, seq, 4*hidden_dim]</text>
</g>
<!-- gpu13_layer14_ffn_up&#45;&gt;gpu13_layer14_ffn_act -->
<g id="edge97" class="edge">
<title>gpu13_layer14_ffn_up&#45;&gt;gpu13_layer14_ffn_act</title>
<path fill="none" stroke="green" d="M45125.44,-165C45125.44,-165 45396.65,-165 45396.65,-165"/>
<polygon fill="green" stroke="green" points="45396.65,-168.5 45406.65,-165 45396.65,-161.5 45396.65,-168.5"/>
<text text-anchor="middle" x="45265.96" y="-183.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="45265.96" y="-168.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu13_layer14_ffn_down -->
<g id="node112" class="node">
<title>gpu13_layer14_ffn_down</title>
<polygon fill="#9980fa" stroke="black" points="46014.05,-194.5 45877.05,-194.5 45877.05,-131.5 46014.05,-131.5 46014.05,-194.5"/>
<text text-anchor="middle" x="45945.55" y="-182.5" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="45945.55" y="-171.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="45945.55" y="-160.5" font-family="Arial" font-size="10.00">[4*hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="45945.55" y="-149.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="45945.55" y="-138.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu13_layer14_ffn_act&#45;&gt;gpu13_layer14_ffn_down -->
<g id="edge98" class="edge">
<title>gpu13_layer14_ffn_act&#45;&gt;gpu13_layer14_ffn_down</title>
<path fill="none" stroke="green" d="M45595.29,-165C45595.29,-165 45866.81,-165 45866.81,-165"/>
<polygon fill="green" stroke="green" points="45866.81,-168.5 45876.81,-165 45866.81,-161.5 45866.81,-168.5"/>
<text text-anchor="middle" x="45736.05" y="-183.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="45736.05" y="-168.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu13_layer14_ffn_layernorm -->
<g id="node113" class="node">
<title>gpu13_layer14_ffn_layernorm</title>
<ellipse fill="#9980fa" stroke="black" cx="46348.74" cy="-165" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="46348.74" y="-168" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="46348.74" y="-157" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu13_layer14_ffn_down&#45;&gt;gpu13_layer14_ffn_layernorm -->
<g id="edge99" class="edge">
<title>gpu13_layer14_ffn_down&#45;&gt;gpu13_layer14_ffn_layernorm</title>
<path fill="none" stroke="red" d="M46014.41,-165C46014.41,-165 46250.79,-165 46250.79,-165"/>
<polygon fill="red" stroke="red" points="46250.79,-168.5 46260.79,-165 46250.79,-161.5 46250.79,-168.5"/>
<text text-anchor="middle" x="46137.55" y="-183.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="46137.55" y="-168.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu14_layer15_attn_qkv -->
<g id="node114" class="node">
<title>gpu14_layer15_attn_qkv</title>
<polygon fill="#d63031" stroke="black" points="46820.42,-202 46683.42,-202 46683.42,-128 46820.42,-128 46820.42,-202"/>
<text text-anchor="middle" x="46751.92" y="-190" font-family="Arial" font-size="10.00">Layer 15</text>
<text text-anchor="middle" x="46751.92" y="-179" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="46751.92" y="-168" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="46751.92" y="-157" font-family="Arial" font-size="10.00">[hidden_dim, 3*hidden_dim]</text>
<text text-anchor="middle" x="46751.92" y="-146" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="46751.92" y="-135" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu13_layer14_ffn_layernorm&#45;&gt;gpu14_layer15_attn_qkv -->
<g id="edge127" class="edge">
<title>gpu13_layer14_ffn_layernorm&#45;&gt;gpu14_layer15_attn_qkv</title>
<path fill="none" stroke="purple" stroke-width="2" stroke-dasharray="5,2" d="M46436.72,-165C46436.72,-165 46673.15,-165 46673.15,-165"/>
<polygon fill="purple" stroke="purple" stroke-width="2" points="46673.15,-168.5 46683.15,-165 46673.15,-161.5 46673.15,-168.5"/>
<text text-anchor="middle" x="46559.92" y="-183.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="46559.92" y="-168.8" font-family="Times,serif" font-size="14.00">GPU13→GPU14</text>
</g>
<!-- gpu14_layer15_attn_score -->
<g id="node115" class="node">
<title>gpu14_layer15_attn_score</title>
<polygon fill="#d63031" stroke="black" points="47224.42,-192.5 47102.42,-192.5 47102.42,-151.5 47224.42,-151.5 47224.42,-192.5"/>
<text text-anchor="middle" x="47163.42" y="-180.5" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="47163.42" y="-169.5" font-family="Arial" font-size="10.00">Score Computation</text>
<text text-anchor="middle" x="47163.42" y="-158.5" font-family="Arial" font-size="10.00">[batch, heads, seq, seq]</text>
</g>
<!-- gpu14_layer15_attn_qkv&#45;&gt;gpu14_layer15_attn_score -->
<g id="edge100" class="edge">
<title>gpu14_layer15_attn_qkv&#45;&gt;gpu14_layer15_attn_score</title>
<path fill="none" stroke="blue" d="M46820.79,-172C46820.79,-172 47092.38,-172 47092.38,-172"/>
<polygon fill="blue" stroke="blue" points="47092.38,-175.5 47102.38,-172 47092.38,-168.5 47092.38,-175.5"/>
<text text-anchor="middle" x="46961.42" y="-190.8" font-family="Times,serif" font-size="14.00">[1024, seq, 3*hidden/tp]</text>
<text text-anchor="middle" x="46961.42" y="-175.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu14_layer15_attn_dense -->
<g id="node116" class="node">
<title>gpu14_layer15_attn_dense</title>
<polygon fill="#d63031" stroke="black" points="47618.42,-201.5 47490.42,-201.5 47490.42,-138.5 47618.42,-138.5 47618.42,-201.5"/>
<text text-anchor="middle" x="47554.42" y="-189.5" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="47554.42" y="-178.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="47554.42" y="-167.5" font-family="Arial" font-size="10.00">[hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="47554.42" y="-156.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="47554.42" y="-145.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu14_layer15_attn_score&#45;&gt;gpu14_layer15_attn_dense -->
<g id="edge101" class="edge">
<title>gpu14_layer15_attn_score&#45;&gt;gpu14_layer15_attn_dense</title>
<path fill="none" stroke="blue" d="M47224.51,-172C47224.51,-172 47480.18,-172 47480.18,-172"/>
<polygon fill="blue" stroke="blue" points="47480.18,-175.5 47490.18,-172 47480.18,-168.5 47480.18,-175.5"/>
<text text-anchor="middle" x="47357.42" y="-190.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden/tp]</text>
<text text-anchor="middle" x="47357.42" y="-175.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu14_layer15_attn_layernorm -->
<g id="node117" class="node">
<title>gpu14_layer15_attn_layernorm</title>
<ellipse fill="#d63031" stroke="black" cx="47953.1" cy="-172" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="47953.1" y="-175" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="47953.1" y="-164" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu14_layer15_attn_dense&#45;&gt;gpu14_layer15_attn_layernorm -->
<g id="edge102" class="edge">
<title>gpu14_layer15_attn_dense&#45;&gt;gpu14_layer15_attn_layernorm</title>
<path fill="none" stroke="red" d="M47618.47,-172C47618.47,-172 47855.05,-172 47855.05,-172"/>
<polygon fill="red" stroke="red" points="47855.05,-175.5 47865.05,-172 47855.05,-168.5 47855.05,-175.5"/>
<text text-anchor="middle" x="47741.92" y="-190.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="47741.92" y="-175.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu14_layer15_ffn_up -->
<g id="node118" class="node">
<title>gpu14_layer15_ffn_up</title>
<polygon fill="#d63031" stroke="black" points="48424.78,-201.5 48287.78,-201.5 48287.78,-138.5 48424.78,-138.5 48424.78,-201.5"/>
<text text-anchor="middle" x="48356.28" y="-189.5" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="48356.28" y="-178.5" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="48356.28" y="-167.5" font-family="Arial" font-size="10.00">[hidden_dim, 4*hidden_dim]</text>
<text text-anchor="middle" x="48356.28" y="-156.5" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="48356.28" y="-145.5" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu14_layer15_attn_layernorm&#45;&gt;gpu14_layer15_ffn_up -->
<g id="edge103" class="edge">
<title>gpu14_layer15_attn_layernorm&#45;&gt;gpu14_layer15_ffn_up</title>
<path fill="none" stroke="green" d="M48041.08,-172C48041.08,-172 48277.51,-172 48277.51,-172"/>
<polygon fill="green" stroke="green" points="48277.51,-175.5 48287.51,-172 48277.51,-168.5 48277.51,-175.5"/>
<text text-anchor="middle" x="48164.28" y="-190.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="48164.28" y="-175.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu14_layer15_ffn_act -->
<g id="node119" class="node">
<title>gpu14_layer15_ffn_act</title>
<ellipse fill="#d63031" stroke="black" cx="48800.82" cy="-172" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="48800.82" y="-180.5" font-family="Arial" font-size="10.00">Activation</text>
<text text-anchor="middle" x="48800.82" y="-169.5" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="48800.82" y="-158.5" font-family="Arial" font-size="10.00">[batch, seq, 4*hidden_dim]</text>
</g>
<!-- gpu14_layer15_ffn_up&#45;&gt;gpu14_layer15_ffn_act -->
<g id="edge104" class="edge">
<title>gpu14_layer15_ffn_up&#45;&gt;gpu14_layer15_ffn_act</title>
<path fill="none" stroke="green" d="M48425.25,-172C48425.25,-172 48696.47,-172 48696.47,-172"/>
<polygon fill="green" stroke="green" points="48696.47,-175.5 48706.47,-172 48696.47,-168.5 48696.47,-175.5"/>
<text text-anchor="middle" x="48565.78" y="-190.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="48565.78" y="-175.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu14_layer15_ffn_down -->
<g id="node120" class="node">
<title>gpu14_layer15_ffn_down</title>
<polygon fill="#d63031" stroke="black" points="49313.87,-201.5 49176.87,-201.5 49176.87,-138.5 49313.87,-138.5 49313.87,-201.5"/>
<text text-anchor="middle" x="49245.37" y="-189.5" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="49245.37" y="-178.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="49245.37" y="-167.5" font-family="Arial" font-size="10.00">[4*hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="49245.37" y="-156.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="49245.37" y="-145.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu14_layer15_ffn_act&#45;&gt;gpu14_layer15_ffn_down -->
<g id="edge105" class="edge">
<title>gpu14_layer15_ffn_act&#45;&gt;gpu14_layer15_ffn_down</title>
<path fill="none" stroke="green" d="M48895.1,-172C48895.1,-172 49166.63,-172 49166.63,-172"/>
<polygon fill="green" stroke="green" points="49166.63,-175.5 49176.63,-172 49166.63,-168.5 49166.63,-175.5"/>
<text text-anchor="middle" x="49035.87" y="-190.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="49035.87" y="-175.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu14_layer15_ffn_layernorm -->
<g id="node121" class="node">
<title>gpu14_layer15_ffn_layernorm</title>
<ellipse fill="#d63031" stroke="black" cx="49648.55" cy="-172" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="49648.55" y="-175" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="49648.55" y="-164" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu14_layer15_ffn_down&#45;&gt;gpu14_layer15_ffn_layernorm -->
<g id="edge106" class="edge">
<title>gpu14_layer15_ffn_down&#45;&gt;gpu14_layer15_ffn_layernorm</title>
<path fill="none" stroke="red" d="M49314.22,-172C49314.22,-172 49550.6,-172 49550.6,-172"/>
<polygon fill="red" stroke="red" points="49550.6,-175.5 49560.6,-172 49550.6,-168.5 49550.6,-175.5"/>
<text text-anchor="middle" x="49437.37" y="-190.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="49437.37" y="-175.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu15_layer16_attn_qkv -->
<g id="node122" class="node">
<title>gpu15_layer16_attn_qkv</title>
<polygon fill="#74b9ff" stroke="black" points="50120.23,-209 49983.23,-209 49983.23,-135 50120.23,-135 50120.23,-209"/>
<text text-anchor="middle" x="50051.73" y="-197" font-family="Arial" font-size="10.00">Layer 16</text>
<text text-anchor="middle" x="50051.73" y="-186" font-family="Arial" font-size="10.00">Attention QKV</text>
<text text-anchor="middle" x="50051.73" y="-175" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="50051.73" y="-164" font-family="Arial" font-size="10.00">[hidden_dim, 3*hidden_dim]</text>
<text text-anchor="middle" x="50051.73" y="-153" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="50051.73" y="-142" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu14_layer15_ffn_layernorm&#45;&gt;gpu15_layer16_attn_qkv -->
<g id="edge128" class="edge">
<title>gpu14_layer15_ffn_layernorm&#45;&gt;gpu15_layer16_attn_qkv</title>
<path fill="none" stroke="purple" stroke-width="2" stroke-dasharray="5,2" d="M49736.53,-172C49736.53,-172 49972.96,-172 49972.96,-172"/>
<polygon fill="purple" stroke="purple" stroke-width="2" points="49972.96,-175.5 49982.96,-172 49972.96,-168.5 49972.96,-175.5"/>
<text text-anchor="middle" x="49859.73" y="-190.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="49859.73" y="-175.8" font-family="Times,serif" font-size="14.00">GPU14→GPU15</text>
</g>
<!-- gpu15_layer16_attn_score -->
<g id="node123" class="node">
<title>gpu15_layer16_attn_score</title>
<polygon fill="#74b9ff" stroke="black" points="50524.23,-199.5 50402.23,-199.5 50402.23,-158.5 50524.23,-158.5 50524.23,-199.5"/>
<text text-anchor="middle" x="50463.23" y="-187.5" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="50463.23" y="-176.5" font-family="Arial" font-size="10.00">Score Computation</text>
<text text-anchor="middle" x="50463.23" y="-165.5" font-family="Arial" font-size="10.00">[batch, heads, seq, seq]</text>
</g>
<!-- gpu15_layer16_attn_qkv&#45;&gt;gpu15_layer16_attn_score -->
<g id="edge107" class="edge">
<title>gpu15_layer16_attn_qkv&#45;&gt;gpu15_layer16_attn_score</title>
<path fill="none" stroke="blue" d="M50120.61,-179C50120.61,-179 50392.2,-179 50392.2,-179"/>
<polygon fill="blue" stroke="blue" points="50392.2,-182.5 50402.2,-179 50392.2,-175.5 50392.2,-182.5"/>
<text text-anchor="middle" x="50261.23" y="-197.8" font-family="Times,serif" font-size="14.00">[1024, seq, 3*hidden/tp]</text>
<text text-anchor="middle" x="50261.23" y="-182.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu15_layer16_attn_dense -->
<g id="node124" class="node">
<title>gpu15_layer16_attn_dense</title>
<polygon fill="#74b9ff" stroke="black" points="50918.23,-208.5 50790.23,-208.5 50790.23,-145.5 50918.23,-145.5 50918.23,-208.5"/>
<text text-anchor="middle" x="50854.23" y="-196.5" font-family="Arial" font-size="10.00">Attention Output</text>
<text text-anchor="middle" x="50854.23" y="-185.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="50854.23" y="-174.5" font-family="Arial" font-size="10.00">[hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="50854.23" y="-163.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="50854.23" y="-152.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu15_layer16_attn_score&#45;&gt;gpu15_layer16_attn_dense -->
<g id="edge108" class="edge">
<title>gpu15_layer16_attn_score&#45;&gt;gpu15_layer16_attn_dense</title>
<path fill="none" stroke="blue" d="M50524.33,-179C50524.33,-179 50780,-179 50780,-179"/>
<polygon fill="blue" stroke="blue" points="50780,-182.5 50790,-179 50780,-175.5 50780,-182.5"/>
<text text-anchor="middle" x="50657.23" y="-197.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden/tp]</text>
<text text-anchor="middle" x="50657.23" y="-182.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu15_layer16_attn_layernorm -->
<g id="node125" class="node">
<title>gpu15_layer16_attn_layernorm</title>
<ellipse fill="#74b9ff" stroke="black" cx="51252.91" cy="-179" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="51252.91" y="-182" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="51252.91" y="-171" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu15_layer16_attn_dense&#45;&gt;gpu15_layer16_attn_layernorm -->
<g id="edge109" class="edge">
<title>gpu15_layer16_attn_dense&#45;&gt;gpu15_layer16_attn_layernorm</title>
<path fill="none" stroke="red" d="M50918.29,-179C50918.29,-179 51154.87,-179 51154.87,-179"/>
<polygon fill="red" stroke="red" points="51154.87,-182.5 51164.87,-179 51154.87,-175.5 51154.87,-182.5"/>
<text text-anchor="middle" x="51041.73" y="-197.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="51041.73" y="-182.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- gpu15_layer16_ffn_up -->
<g id="node126" class="node">
<title>gpu15_layer16_ffn_up</title>
<polygon fill="#74b9ff" stroke="black" points="51724.6,-208.5 51587.6,-208.5 51587.6,-145.5 51724.6,-145.5 51724.6,-208.5"/>
<text text-anchor="middle" x="51656.1" y="-196.5" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="51656.1" y="-185.5" font-family="Arial" font-size="10.00">ColumnParallelLinear</text>
<text text-anchor="middle" x="51656.1" y="-174.5" font-family="Arial" font-size="10.00">[hidden_dim, 4*hidden_dim]</text>
<text text-anchor="middle" x="51656.1" y="-163.5" font-family="Arial" font-size="10.00">Type: Column</text>
<text text-anchor="middle" x="51656.1" y="-152.5" font-family="Arial" font-size="10.00">Gather: False</text>
</g>
<!-- gpu15_layer16_attn_layernorm&#45;&gt;gpu15_layer16_ffn_up -->
<g id="edge110" class="edge">
<title>gpu15_layer16_attn_layernorm&#45;&gt;gpu15_layer16_ffn_up</title>
<path fill="none" stroke="green" d="M51340.9,-179C51340.9,-179 51577.32,-179 51577.32,-179"/>
<polygon fill="green" stroke="green" points="51577.32,-182.5 51587.32,-179 51577.32,-175.5 51577.32,-182.5"/>
<text text-anchor="middle" x="51464.1" y="-197.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="51464.1" y="-182.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu15_layer16_ffn_act -->
<g id="node127" class="node">
<title>gpu15_layer16_ffn_act</title>
<ellipse fill="#74b9ff" stroke="black" cx="52100.64" cy="-179" rx="94.09" ry="28.98"/>
<text text-anchor="middle" x="52100.64" y="-187.5" font-family="Arial" font-size="10.00">Activation</text>
<text text-anchor="middle" x="52100.64" y="-176.5" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="52100.64" y="-165.5" font-family="Arial" font-size="10.00">[batch, seq, 4*hidden_dim]</text>
</g>
<!-- gpu15_layer16_ffn_up&#45;&gt;gpu15_layer16_ffn_act -->
<g id="edge111" class="edge">
<title>gpu15_layer16_ffn_up&#45;&gt;gpu15_layer16_ffn_act</title>
<path fill="none" stroke="green" d="M51725.07,-179C51725.07,-179 51996.28,-179 51996.28,-179"/>
<polygon fill="green" stroke="green" points="51996.28,-182.5 52006.28,-179 51996.28,-175.5 51996.28,-182.5"/>
<text text-anchor="middle" x="51865.6" y="-197.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="51865.6" y="-182.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu15_layer16_ffn_down -->
<g id="node128" class="node">
<title>gpu15_layer16_ffn_down</title>
<polygon fill="#74b9ff" stroke="black" points="52613.69,-208.5 52476.69,-208.5 52476.69,-145.5 52613.69,-145.5 52613.69,-208.5"/>
<text text-anchor="middle" x="52545.19" y="-196.5" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="52545.19" y="-185.5" font-family="Arial" font-size="10.00">RowParallelLinear</text>
<text text-anchor="middle" x="52545.19" y="-174.5" font-family="Arial" font-size="10.00">[4*hidden_dim, hidden_dim]</text>
<text text-anchor="middle" x="52545.19" y="-163.5" font-family="Arial" font-size="10.00">Type: Row</text>
<text text-anchor="middle" x="52545.19" y="-152.5" font-family="Arial" font-size="10.00">Gather: True</text>
</g>
<!-- gpu15_layer16_ffn_act&#45;&gt;gpu15_layer16_ffn_down -->
<g id="edge112" class="edge">
<title>gpu15_layer16_ffn_act&#45;&gt;gpu15_layer16_ffn_down</title>
<path fill="none" stroke="green" d="M52194.92,-179C52194.92,-179 52466.44,-179 52466.44,-179"/>
<polygon fill="green" stroke="green" points="52466.44,-182.5 52476.44,-179 52466.44,-175.5 52466.44,-182.5"/>
<text text-anchor="middle" x="52335.69" y="-197.8" font-family="Times,serif" font-size="14.00">[1024, seq, 4*hidden/tp]</text>
<text text-anchor="middle" x="52335.69" y="-182.8" font-family="Times,serif" font-size="14.00">Local</text>
</g>
<!-- gpu15_layer16_ffn_layernorm -->
<g id="node129" class="node">
<title>gpu15_layer16_ffn_layernorm</title>
<ellipse fill="#74b9ff" stroke="black" cx="52948.37" cy="-179" rx="87.86" ry="21.43"/>
<text text-anchor="middle" x="52948.37" y="-182" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="52948.37" y="-171" font-family="Arial" font-size="10.00">[batch, seq, hidden_dim]</text>
</g>
<!-- gpu15_layer16_ffn_down&#45;&gt;gpu15_layer16_ffn_layernorm -->
<g id="edge113" class="edge">
<title>gpu15_layer16_ffn_down&#45;&gt;gpu15_layer16_ffn_layernorm</title>
<path fill="none" stroke="red" d="M52614.04,-179C52614.04,-179 52850.42,-179 52850.42,-179"/>
<polygon fill="red" stroke="red" points="52850.42,-182.5 52860.42,-179 52850.42,-175.5 52850.42,-182.5"/>
<text text-anchor="middle" x="52737.19" y="-197.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="52737.19" y="-182.8" font-family="Times,serif" font-size="14.00">AllReduce</text>
</g>
<!-- output -->
<g id="node130" class="node">
<title>output</title>
<ellipse fill="#e8e8e8" stroke="black" cx="53402.55" cy="-179" rx="119.5" ry="21.43"/>
<text text-anchor="middle" x="53402.55" y="-182" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="53402.55" y="-171" font-family="Arial" font-size="10.00">[batch=1024, seq_len, hidden_dim]</text>
</g>
<!-- gpu15_layer16_ffn_layernorm&#45;&gt;output -->
<g id="edge129" class="edge">
<title>gpu15_layer16_ffn_layernorm&#45;&gt;output</title>
<path fill="none" stroke="black" d="M53036.21,-179C53036.21,-179 53272.76,-179 53272.76,-179"/>
<polygon fill="black" stroke="black" points="53272.76,-182.5 53282.76,-179 53272.76,-175.5 53272.76,-182.5"/>
<text text-anchor="middle" x="53159.55" y="-197.8" font-family="Times,serif" font-size="14.00">[1024, seq, hidden]</text>
<text text-anchor="middle" x="53159.55" y="-182.8" font-family="Times,serif" font-size="14.00">Final output</text>
</g>
<!-- legend_local -->
<g id="node131" class="node">
<title>legend_local</title>
<polygon fill="white" stroke="black" points="168.5,-370 70.5,-370 70.5,-334 168.5,-334 168.5,-370"/>
<text text-anchor="middle" x="119.5" y="-349.5" font-family="Arial" font-size="10.00">Local Computation</text>
</g>
<!-- legend_allreduce -->
<g id="node132" class="node">
<title>legend_allreduce</title>
<polygon fill="lightcoral" stroke="black" points="187,-276 52,-276 52,-240 187,-240 187,-276"/>
<text text-anchor="middle" x="119.5" y="-255.5" font-family="Arial" font-size="10.00">AllReduce (Tensor Parallel)</text>
</g>
<!-- legend_intergpu -->
<g id="node133" class="node">
<title>legend_intergpu</title>
<polygon fill="lightblue" stroke="black" points="169,-182 70,-182 70,-146 169,-146 169,-182"/>
<text text-anchor="middle" x="119.5" y="-161.5" font-family="Arial" font-size="10.00">Inter&#45;GPU Transfer</text>
</g>
</g>
</svg>
