<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: LayerWiseDeployment Pages: 1 -->
<svg width="4994pt" height="5759pt"
 viewBox="0.00 0.00 4994.00 5759.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 5755)">
<title>LayerWiseDeployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-5755 4990,-5755 4990,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_moe</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-8 8,-5743 288,-5743 288,-8 8,-8"/>
<text text-anchor="middle" x="148" y="-5727.8" font-family="Times,serif" font-size="14.00">MoE Model Flow</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer1_detail</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="296,-4556 296,-5588 568,-5588 568,-4556 296,-4556"/>
<text text-anchor="middle" x="432" y="-5572.8" font-family="Times,serif" font-size="14.00">Layer 1 Detailed Tensor Parallelism</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu_boundaries</title>
<polygon fill="none" stroke="black" stroke-width="2" points="1055,-5073 1055,-5264 4261,-5264 4261,-5073 1055,-5073"/>
<text text-anchor="middle" x="2658" y="-5248.8" font-family="Times,serif" font-size="14.00">GPU Card Boundaries (16 GPUs)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_gpu_1</title>
<path fill="none" stroke="black" d="M1075,-5081C1075,-5081 1245,-5081 1245,-5081 1251,-5081 1257,-5087 1257,-5093 1257,-5093 1257,-5221 1257,-5221 1257,-5227 1251,-5233 1245,-5233 1245,-5233 1075,-5233 1075,-5233 1069,-5233 1063,-5227 1063,-5221 1063,-5221 1063,-5093 1063,-5093 1063,-5087 1069,-5081 1075,-5081"/>
<text text-anchor="middle" x="1160" y="-5217.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_gpu_2</title>
<path fill="none" stroke="black" d="M1289,-5081C1289,-5081 1459,-5081 1459,-5081 1465,-5081 1471,-5087 1471,-5093 1471,-5093 1471,-5221 1471,-5221 1471,-5227 1465,-5233 1459,-5233 1459,-5233 1289,-5233 1289,-5233 1283,-5233 1277,-5227 1277,-5221 1277,-5221 1277,-5093 1277,-5093 1277,-5087 1283,-5081 1289,-5081"/>
<text text-anchor="middle" x="1374" y="-5217.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_gpu_3</title>
<path fill="none" stroke="black" d="M1503,-5081C1503,-5081 1673,-5081 1673,-5081 1679,-5081 1685,-5087 1685,-5093 1685,-5093 1685,-5221 1685,-5221 1685,-5227 1679,-5233 1673,-5233 1673,-5233 1503,-5233 1503,-5233 1497,-5233 1491,-5227 1491,-5221 1491,-5221 1491,-5093 1491,-5093 1491,-5087 1497,-5081 1503,-5081"/>
<text text-anchor="middle" x="1588" y="-5217.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_gpu_4</title>
<path fill="none" stroke="black" d="M1717,-5081C1717,-5081 1887,-5081 1887,-5081 1893,-5081 1899,-5087 1899,-5093 1899,-5093 1899,-5221 1899,-5221 1899,-5227 1893,-5233 1887,-5233 1887,-5233 1717,-5233 1717,-5233 1711,-5233 1705,-5227 1705,-5221 1705,-5221 1705,-5093 1705,-5093 1705,-5087 1711,-5081 1717,-5081"/>
<text text-anchor="middle" x="1802" y="-5217.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_gpu_5</title>
<path fill="none" stroke="black" d="M1931,-5081C1931,-5081 2101,-5081 2101,-5081 2107,-5081 2113,-5087 2113,-5093 2113,-5093 2113,-5221 2113,-5221 2113,-5227 2107,-5233 2101,-5233 2101,-5233 1931,-5233 1931,-5233 1925,-5233 1919,-5227 1919,-5221 1919,-5221 1919,-5093 1919,-5093 1919,-5087 1925,-5081 1931,-5081"/>
<text text-anchor="middle" x="2016" y="-5217.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_gpu_6</title>
<path fill="none" stroke="black" d="M2145,-5081C2145,-5081 2315,-5081 2315,-5081 2321,-5081 2327,-5087 2327,-5093 2327,-5093 2327,-5221 2327,-5221 2327,-5227 2321,-5233 2315,-5233 2315,-5233 2145,-5233 2145,-5233 2139,-5233 2133,-5227 2133,-5221 2133,-5221 2133,-5093 2133,-5093 2133,-5087 2139,-5081 2145,-5081"/>
<text text-anchor="middle" x="2230" y="-5217.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_gpu_7</title>
<path fill="none" stroke="black" d="M2359,-5081C2359,-5081 2529,-5081 2529,-5081 2535,-5081 2541,-5087 2541,-5093 2541,-5093 2541,-5221 2541,-5221 2541,-5227 2535,-5233 2529,-5233 2529,-5233 2359,-5233 2359,-5233 2353,-5233 2347,-5227 2347,-5221 2347,-5221 2347,-5093 2347,-5093 2347,-5087 2353,-5081 2359,-5081"/>
<text text-anchor="middle" x="2444" y="-5217.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_gpu_8</title>
<path fill="none" stroke="black" d="M2573,-5081C2573,-5081 2743,-5081 2743,-5081 2749,-5081 2755,-5087 2755,-5093 2755,-5093 2755,-5221 2755,-5221 2755,-5227 2749,-5233 2743,-5233 2743,-5233 2573,-5233 2573,-5233 2567,-5233 2561,-5227 2561,-5221 2561,-5221 2561,-5093 2561,-5093 2561,-5087 2567,-5081 2573,-5081"/>
<text text-anchor="middle" x="2658" y="-5217.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_gpu_9</title>
<path fill="none" stroke="black" d="M2787,-5081C2787,-5081 2957,-5081 2957,-5081 2963,-5081 2969,-5087 2969,-5093 2969,-5093 2969,-5221 2969,-5221 2969,-5227 2963,-5233 2957,-5233 2957,-5233 2787,-5233 2787,-5233 2781,-5233 2775,-5227 2775,-5221 2775,-5221 2775,-5093 2775,-5093 2775,-5087 2781,-5081 2787,-5081"/>
<text text-anchor="middle" x="2872" y="-5217.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_gpu_10</title>
<path fill="none" stroke="black" d="M3001,-5081C3001,-5081 3171,-5081 3171,-5081 3177,-5081 3183,-5087 3183,-5093 3183,-5093 3183,-5221 3183,-5221 3183,-5227 3177,-5233 3171,-5233 3171,-5233 3001,-5233 3001,-5233 2995,-5233 2989,-5227 2989,-5221 2989,-5221 2989,-5093 2989,-5093 2989,-5087 2995,-5081 3001,-5081"/>
<text text-anchor="middle" x="3086" y="-5217.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_gpu_11</title>
<path fill="none" stroke="black" d="M3215,-5081C3215,-5081 3385,-5081 3385,-5081 3391,-5081 3397,-5087 3397,-5093 3397,-5093 3397,-5221 3397,-5221 3397,-5227 3391,-5233 3385,-5233 3385,-5233 3215,-5233 3215,-5233 3209,-5233 3203,-5227 3203,-5221 3203,-5221 3203,-5093 3203,-5093 3203,-5087 3209,-5081 3215,-5081"/>
<text text-anchor="middle" x="3300" y="-5217.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_gpu_12</title>
<path fill="none" stroke="black" d="M3429,-5081C3429,-5081 3599,-5081 3599,-5081 3605,-5081 3611,-5087 3611,-5093 3611,-5093 3611,-5221 3611,-5221 3611,-5227 3605,-5233 3599,-5233 3599,-5233 3429,-5233 3429,-5233 3423,-5233 3417,-5227 3417,-5221 3417,-5221 3417,-5093 3417,-5093 3417,-5087 3423,-5081 3429,-5081"/>
<text text-anchor="middle" x="3514" y="-5217.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_gpu_13</title>
<path fill="none" stroke="black" d="M3643,-5081C3643,-5081 3813,-5081 3813,-5081 3819,-5081 3825,-5087 3825,-5093 3825,-5093 3825,-5221 3825,-5221 3825,-5227 3819,-5233 3813,-5233 3813,-5233 3643,-5233 3643,-5233 3637,-5233 3631,-5227 3631,-5221 3631,-5221 3631,-5093 3631,-5093 3631,-5087 3637,-5081 3643,-5081"/>
<text text-anchor="middle" x="3728" y="-5217.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_gpu_14</title>
<path fill="none" stroke="black" d="M3857,-5081C3857,-5081 4027,-5081 4027,-5081 4033,-5081 4039,-5087 4039,-5093 4039,-5093 4039,-5221 4039,-5221 4039,-5227 4033,-5233 4027,-5233 4027,-5233 3857,-5233 3857,-5233 3851,-5233 3845,-5227 3845,-5221 3845,-5221 3845,-5093 3845,-5093 3845,-5087 3851,-5081 3857,-5081"/>
<text text-anchor="middle" x="3942" y="-5217.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_gpu_15</title>
<path fill="none" stroke="black" d="M4071,-5081C4071,-5081 4241,-5081 4241,-5081 4247,-5081 4253,-5087 4253,-5093 4253,-5093 4253,-5221 4253,-5221 4253,-5227 4247,-5233 4241,-5233 4241,-5233 4071,-5233 4071,-5233 4065,-5233 4059,-5227 4059,-5221 4059,-5221 4059,-5093 4059,-5093 4059,-5087 4065,-5081 4071,-5081"/>
<text text-anchor="middle" x="4156" y="-5217.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<path fill="lightblue" stroke="black" d="M246,-5712C246,-5712 58,-5712 58,-5712 52,-5712 46,-5706 46,-5700 46,-5700 46,-5671 46,-5671 46,-5665 52,-5659 58,-5659 58,-5659 246,-5659 246,-5659 252,-5659 258,-5665 258,-5671 258,-5671 258,-5700 258,-5700 258,-5706 252,-5712 246,-5712"/>
<text text-anchor="middle" x="152" y="-5696.8" font-family="Arial" font-size="14.00">Input</text>
<text text-anchor="middle" x="152" y="-5681.8" font-family="Arial" font-size="14.00">Shape: [1024, 2048]</text>
<text text-anchor="middle" x="152" y="-5666.8" font-family="Arial" font-size="14.00">Embeddings: [1024, 2048, 4096]</text>
</g>
<!-- moe_layer_1 -->
<g id="node2" class="node">
<title>moe_layer_1</title>
<path fill="lightcoral" stroke="black" d="M226,-5557C226,-5557 72,-5557 72,-5557 66,-5557 60,-5551 60,-5545 60,-5545 60,-5456 60,-5456 60,-5450 66,-5444 72,-5444 72,-5444 226,-5444 226,-5444 232,-5444 238,-5450 238,-5456 238,-5456 238,-5545 238,-5545 238,-5551 232,-5557 226,-5557"/>
<text text-anchor="middle" x="149" y="-5541.8" font-family="Arial" font-size="14.00">MoE Layer 1</text>
<text text-anchor="middle" x="149" y="-5526.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="149" y="-5511.8" font-family="Arial" font-size="14.00">MHA + 8 Experts</text>
<text text-anchor="middle" x="149" y="-5496.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="149" y="-5481.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="149" y="-5466.8" font-family="Arial" font-size="14.00">Expert Weights: ~536MB</text>
<text text-anchor="middle" x="149" y="-5451.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- input&#45;&gt;moe_layer_1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;moe_layer_1</title>
<path fill="none" stroke="black" d="M149,-5658.99C149,-5658.99 149,-5567.08 149,-5567.08"/>
<polygon fill="black" stroke="black" points="152.5,-5567.08 149,-5557.08 145.5,-5567.08 152.5,-5567.08"/>
</g>
<!-- dense_layer_1 -->
<g id="node34" class="node">
<title>dense_layer_1</title>
<path fill="lightgreen" stroke="black" d="M486,-5557C486,-5557 332,-5557 332,-5557 326,-5557 320,-5551 320,-5545 320,-5545 320,-5456 320,-5456 320,-5450 326,-5444 332,-5444 332,-5444 486,-5444 486,-5444 492,-5444 498,-5450 498,-5456 498,-5456 498,-5545 498,-5545 498,-5551 492,-5557 486,-5557"/>
<text text-anchor="middle" x="409" y="-5541.8" font-family="Arial" font-size="14.00">Dense Layer 1</text>
<text text-anchor="middle" x="409" y="-5526.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="409" y="-5511.8" font-family="Arial" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="409" y="-5496.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="409" y="-5481.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="409" y="-5466.8" font-family="Arial" font-size="14.00">Weights: ~67MB</text>
<text text-anchor="middle" x="409" y="-5451.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- input&#45;&gt;dense_layer_1 -->
<g id="edge38" class="edge">
<title>input&#45;&gt;dense_layer_1</title>
<path fill="none" stroke="black" d="M248,-5658.92C248,-5607.63 248,-5500 248,-5500 248,-5500 309.55,-5500 309.55,-5500"/>
<polygon fill="black" stroke="black" points="309.55,-5503.5 319.55,-5500 309.55,-5496.5 309.55,-5503.5"/>
</g>
<!-- comm_moe_1_2 -->
<g id="node3" class="node">
<title>comm_moe_1_2</title>
<ellipse fill="lightyellow" stroke="black" cx="148" cy="-5323" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="148" y="-5341.8" font-family="Arial" font-size="14.00">MoE Comm</text>
<text text-anchor="middle" x="148" y="-5326.8" font-family="Arial" font-size="14.00">GPU 0 → GPU 1</text>
<text text-anchor="middle" x="148" y="-5311.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-5296.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- moe_layer_1&#45;&gt;comm_moe_1_2 -->
<g id="edge2" class="edge">
<title>moe_layer_1&#45;&gt;comm_moe_1_2</title>
<path fill="none" stroke="black" d="M149,-5443.85C149,-5443.85 149,-5381.36 149,-5381.36"/>
<polygon fill="black" stroke="black" points="152.5,-5381.36 149,-5371.36 145.5,-5381.36 152.5,-5381.36"/>
</g>
<!-- moe_layer_2 -->
<g id="node4" class="node">
<title>moe_layer_2</title>
<path fill="lightcoral" stroke="black" d="M225,-5202C225,-5202 71,-5202 71,-5202 65,-5202 59,-5196 59,-5190 59,-5190 59,-5101 59,-5101 59,-5095 65,-5089 71,-5089 71,-5089 225,-5089 225,-5089 231,-5089 237,-5095 237,-5101 237,-5101 237,-5190 237,-5190 237,-5196 231,-5202 225,-5202"/>
<text text-anchor="middle" x="148" y="-5186.8" font-family="Arial" font-size="14.00">MoE Layer 2</text>
<text text-anchor="middle" x="148" y="-5171.8" font-family="Arial" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="148" y="-5156.8" font-family="Arial" font-size="14.00">MHA + 8 Experts</text>
<text text-anchor="middle" x="148" y="-5141.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-5126.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-5111.8" font-family="Arial" font-size="14.00">Expert Weights: ~536MB</text>
<text text-anchor="middle" x="148" y="-5096.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_moe_1_2&#45;&gt;moe_layer_2 -->
<g id="edge18" class="edge">
<title>comm_moe_1_2&#45;&gt;moe_layer_2</title>
<path fill="none" stroke="black" d="M148,-5274.5C148,-5274.5 148,-5212.12 148,-5212.12"/>
<polygon fill="black" stroke="black" points="151.5,-5212.12 148,-5202.12 144.5,-5212.12 151.5,-5212.12"/>
</g>
<!-- comm_moe_2_3 -->
<g id="node5" class="node">
<title>comm_moe_2_3</title>
<ellipse fill="lightyellow" stroke="black" cx="148" cy="-4968" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="148" y="-4986.8" font-family="Arial" font-size="14.00">MoE Comm</text>
<text text-anchor="middle" x="148" y="-4971.8" font-family="Arial" font-size="14.00">GPU 1 → GPU 2</text>
<text text-anchor="middle" x="148" y="-4956.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-4941.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- moe_layer_2&#45;&gt;comm_moe_2_3 -->
<g id="edge3" class="edge">
<title>moe_layer_2&#45;&gt;comm_moe_2_3</title>
<path fill="none" stroke="black" d="M148,-5088.85C148,-5088.85 148,-5026.36 148,-5026.36"/>
<polygon fill="black" stroke="black" points="151.5,-5026.36 148,-5016.36 144.5,-5026.36 151.5,-5026.36"/>
</g>
<!-- moe_layer_3 -->
<g id="node6" class="node">
<title>moe_layer_3</title>
<path fill="lightcoral" stroke="black" d="M225,-4847C225,-4847 71,-4847 71,-4847 65,-4847 59,-4841 59,-4835 59,-4835 59,-4746 59,-4746 59,-4740 65,-4734 71,-4734 71,-4734 225,-4734 225,-4734 231,-4734 237,-4740 237,-4746 237,-4746 237,-4835 237,-4835 237,-4841 231,-4847 225,-4847"/>
<text text-anchor="middle" x="148" y="-4831.8" font-family="Arial" font-size="14.00">MoE Layer 3</text>
<text text-anchor="middle" x="148" y="-4816.8" font-family="Arial" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="148" y="-4801.8" font-family="Arial" font-size="14.00">MHA + 8 Experts</text>
<text text-anchor="middle" x="148" y="-4786.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-4771.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-4756.8" font-family="Arial" font-size="14.00">Expert Weights: ~536MB</text>
<text text-anchor="middle" x="148" y="-4741.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_moe_2_3&#45;&gt;moe_layer_3 -->
<g id="edge19" class="edge">
<title>comm_moe_2_3&#45;&gt;moe_layer_3</title>
<path fill="none" stroke="black" d="M148,-4919.5C148,-4919.5 148,-4857.12 148,-4857.12"/>
<polygon fill="black" stroke="black" points="151.5,-4857.12 148,-4847.12 144.5,-4857.12 151.5,-4857.12"/>
</g>
<!-- comm_moe_3_4 -->
<g id="node7" class="node">
<title>comm_moe_3_4</title>
<ellipse fill="lightyellow" stroke="black" cx="148" cy="-4613" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="148" y="-4631.8" font-family="Arial" font-size="14.00">MoE Comm</text>
<text text-anchor="middle" x="148" y="-4616.8" font-family="Arial" font-size="14.00">GPU 2 → GPU 3</text>
<text text-anchor="middle" x="148" y="-4601.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-4586.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- moe_layer_3&#45;&gt;comm_moe_3_4 -->
<g id="edge4" class="edge">
<title>moe_layer_3&#45;&gt;comm_moe_3_4</title>
<path fill="none" stroke="black" d="M148,-4733.85C148,-4733.85 148,-4671.36 148,-4671.36"/>
<polygon fill="black" stroke="black" points="151.5,-4671.36 148,-4661.36 144.5,-4671.36 151.5,-4671.36"/>
</g>
<!-- moe_layer_4 -->
<g id="node8" class="node">
<title>moe_layer_4</title>
<path fill="lightcoral" stroke="black" d="M225,-4492C225,-4492 71,-4492 71,-4492 65,-4492 59,-4486 59,-4480 59,-4480 59,-4391 59,-4391 59,-4385 65,-4379 71,-4379 71,-4379 225,-4379 225,-4379 231,-4379 237,-4385 237,-4391 237,-4391 237,-4480 237,-4480 237,-4486 231,-4492 225,-4492"/>
<text text-anchor="middle" x="148" y="-4476.8" font-family="Arial" font-size="14.00">MoE Layer 4</text>
<text text-anchor="middle" x="148" y="-4461.8" font-family="Arial" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="148" y="-4446.8" font-family="Arial" font-size="14.00">MHA + 8 Experts</text>
<text text-anchor="middle" x="148" y="-4431.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-4416.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-4401.8" font-family="Arial" font-size="14.00">Expert Weights: ~536MB</text>
<text text-anchor="middle" x="148" y="-4386.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_moe_3_4&#45;&gt;moe_layer_4 -->
<g id="edge20" class="edge">
<title>comm_moe_3_4&#45;&gt;moe_layer_4</title>
<path fill="none" stroke="black" d="M148,-4564.5C148,-4564.5 148,-4502.12 148,-4502.12"/>
<polygon fill="black" stroke="black" points="151.5,-4502.12 148,-4492.12 144.5,-4502.12 151.5,-4502.12"/>
</g>
<!-- comm_moe_4_5 -->
<g id="node9" class="node">
<title>comm_moe_4_5</title>
<ellipse fill="lightyellow" stroke="black" cx="148" cy="-4258.92" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="148" y="-4277.72" font-family="Arial" font-size="14.00">MoE Comm</text>
<text text-anchor="middle" x="148" y="-4262.72" font-family="Arial" font-size="14.00">GPU 3 → GPU 4</text>
<text text-anchor="middle" x="148" y="-4247.72" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-4232.72" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- moe_layer_4&#45;&gt;comm_moe_4_5 -->
<g id="edge5" class="edge">
<title>moe_layer_4&#45;&gt;comm_moe_4_5</title>
<path fill="none" stroke="black" d="M148,-4378.65C148,-4378.65 148,-4317.06 148,-4317.06"/>
<polygon fill="black" stroke="black" points="151.5,-4317.06 148,-4307.06 144.5,-4317.06 151.5,-4317.06"/>
</g>
<!-- moe_layer_5 -->
<g id="node10" class="node">
<title>moe_layer_5</title>
<path fill="lightcoral" stroke="black" d="M225,-4138.83C225,-4138.83 71,-4138.83 71,-4138.83 65,-4138.83 59,-4132.83 59,-4126.83 59,-4126.83 59,-4037.83 59,-4037.83 59,-4031.83 65,-4025.83 71,-4025.83 71,-4025.83 225,-4025.83 225,-4025.83 231,-4025.83 237,-4031.83 237,-4037.83 237,-4037.83 237,-4126.83 237,-4126.83 237,-4132.83 231,-4138.83 225,-4138.83"/>
<text text-anchor="middle" x="148" y="-4123.63" font-family="Arial" font-size="14.00">MoE Layer 5</text>
<text text-anchor="middle" x="148" y="-4108.63" font-family="Arial" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="148" y="-4093.63" font-family="Arial" font-size="14.00">MHA + 8 Experts</text>
<text text-anchor="middle" x="148" y="-4078.63" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-4063.63" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-4048.63" font-family="Arial" font-size="14.00">Expert Weights: ~536MB</text>
<text text-anchor="middle" x="148" y="-4033.63" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_moe_4_5&#45;&gt;moe_layer_5 -->
<g id="edge21" class="edge">
<title>comm_moe_4_5&#45;&gt;moe_layer_5</title>
<path fill="none" stroke="black" d="M148,-4210.66C148,-4210.66 148,-4148.98 148,-4148.98"/>
<polygon fill="black" stroke="black" points="151.5,-4148.98 148,-4138.98 144.5,-4148.98 151.5,-4148.98"/>
</g>
<!-- comm_moe_5_6 -->
<g id="node11" class="node">
<title>comm_moe_5_6</title>
<ellipse fill="lightyellow" stroke="black" cx="148" cy="-3905.75" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="148" y="-3924.55" font-family="Arial" font-size="14.00">MoE Comm</text>
<text text-anchor="middle" x="148" y="-3909.55" font-family="Arial" font-size="14.00">GPU 4 → GPU 5</text>
<text text-anchor="middle" x="148" y="-3894.55" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-3879.55" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- moe_layer_5&#45;&gt;comm_moe_5_6 -->
<g id="edge6" class="edge">
<title>moe_layer_5&#45;&gt;comm_moe_5_6</title>
<path fill="none" stroke="black" d="M148,-4025.49C148,-4025.49 148,-3963.89 148,-3963.89"/>
<polygon fill="black" stroke="black" points="151.5,-3963.89 148,-3953.89 144.5,-3963.89 151.5,-3963.89"/>
</g>
<!-- moe_layer_6 -->
<g id="node12" class="node">
<title>moe_layer_6</title>
<path fill="lightcoral" stroke="black" d="M225,-3785.67C225,-3785.67 71,-3785.67 71,-3785.67 65,-3785.67 59,-3779.67 59,-3773.67 59,-3773.67 59,-3684.67 59,-3684.67 59,-3678.67 65,-3672.67 71,-3672.67 71,-3672.67 225,-3672.67 225,-3672.67 231,-3672.67 237,-3678.67 237,-3684.67 237,-3684.67 237,-3773.67 237,-3773.67 237,-3779.67 231,-3785.67 225,-3785.67"/>
<text text-anchor="middle" x="148" y="-3770.47" font-family="Arial" font-size="14.00">MoE Layer 6</text>
<text text-anchor="middle" x="148" y="-3755.47" font-family="Arial" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="148" y="-3740.47" font-family="Arial" font-size="14.00">MHA + 8 Experts</text>
<text text-anchor="middle" x="148" y="-3725.47" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-3710.47" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-3695.47" font-family="Arial" font-size="14.00">Expert Weights: ~536MB</text>
<text text-anchor="middle" x="148" y="-3680.47" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_moe_5_6&#45;&gt;moe_layer_6 -->
<g id="edge22" class="edge">
<title>comm_moe_5_6&#45;&gt;moe_layer_6</title>
<path fill="none" stroke="black" d="M148,-3857.5C148,-3857.5 148,-3795.81 148,-3795.81"/>
<polygon fill="black" stroke="black" points="151.5,-3795.81 148,-3785.81 144.5,-3795.81 151.5,-3795.81"/>
</g>
<!-- comm_moe_6_7 -->
<g id="node13" class="node">
<title>comm_moe_6_7</title>
<ellipse fill="lightyellow" stroke="black" cx="148" cy="-3552.58" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="148" y="-3571.38" font-family="Arial" font-size="14.00">MoE Comm</text>
<text text-anchor="middle" x="148" y="-3556.38" font-family="Arial" font-size="14.00">GPU 5 → GPU 6</text>
<text text-anchor="middle" x="148" y="-3541.38" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-3526.38" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- moe_layer_6&#45;&gt;comm_moe_6_7 -->
<g id="edge7" class="edge">
<title>moe_layer_6&#45;&gt;comm_moe_6_7</title>
<path fill="none" stroke="black" d="M148,-3672.32C148,-3672.32 148,-3610.73 148,-3610.73"/>
<polygon fill="black" stroke="black" points="151.5,-3610.73 148,-3600.73 144.5,-3610.73 151.5,-3610.73"/>
</g>
<!-- moe_layer_7 -->
<g id="node14" class="node">
<title>moe_layer_7</title>
<path fill="lightcoral" stroke="black" d="M225,-3432.5C225,-3432.5 71,-3432.5 71,-3432.5 65,-3432.5 59,-3426.5 59,-3420.5 59,-3420.5 59,-3331.5 59,-3331.5 59,-3325.5 65,-3319.5 71,-3319.5 71,-3319.5 225,-3319.5 225,-3319.5 231,-3319.5 237,-3325.5 237,-3331.5 237,-3331.5 237,-3420.5 237,-3420.5 237,-3426.5 231,-3432.5 225,-3432.5"/>
<text text-anchor="middle" x="148" y="-3417.3" font-family="Arial" font-size="14.00">MoE Layer 7</text>
<text text-anchor="middle" x="148" y="-3402.3" font-family="Arial" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="148" y="-3387.3" font-family="Arial" font-size="14.00">MHA + 8 Experts</text>
<text text-anchor="middle" x="148" y="-3372.3" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-3357.3" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-3342.3" font-family="Arial" font-size="14.00">Expert Weights: ~536MB</text>
<text text-anchor="middle" x="148" y="-3327.3" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_moe_6_7&#45;&gt;moe_layer_7 -->
<g id="edge23" class="edge">
<title>comm_moe_6_7&#45;&gt;moe_layer_7</title>
<path fill="none" stroke="black" d="M148,-3504.33C148,-3504.33 148,-3442.64 148,-3442.64"/>
<polygon fill="black" stroke="black" points="151.5,-3442.64 148,-3432.64 144.5,-3442.65 151.5,-3442.64"/>
</g>
<!-- comm_moe_7_8 -->
<g id="node15" class="node">
<title>comm_moe_7_8</title>
<ellipse fill="lightyellow" stroke="black" cx="148" cy="-3199.42" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="148" y="-3218.22" font-family="Arial" font-size="14.00">MoE Comm</text>
<text text-anchor="middle" x="148" y="-3203.22" font-family="Arial" font-size="14.00">GPU 6 → GPU 7</text>
<text text-anchor="middle" x="148" y="-3188.22" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-3173.22" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- moe_layer_7&#45;&gt;comm_moe_7_8 -->
<g id="edge8" class="edge">
<title>moe_layer_7&#45;&gt;comm_moe_7_8</title>
<path fill="none" stroke="black" d="M148,-3319.15C148,-3319.15 148,-3257.56 148,-3257.56"/>
<polygon fill="black" stroke="black" points="151.5,-3257.56 148,-3247.56 144.5,-3257.56 151.5,-3257.56"/>
</g>
<!-- moe_layer_8 -->
<g id="node16" class="node">
<title>moe_layer_8</title>
<path fill="lightcoral" stroke="black" d="M225,-3079.33C225,-3079.33 71,-3079.33 71,-3079.33 65,-3079.33 59,-3073.33 59,-3067.33 59,-3067.33 59,-2978.33 59,-2978.33 59,-2972.33 65,-2966.33 71,-2966.33 71,-2966.33 225,-2966.33 225,-2966.33 231,-2966.33 237,-2972.33 237,-2978.33 237,-2978.33 237,-3067.33 237,-3067.33 237,-3073.33 231,-3079.33 225,-3079.33"/>
<text text-anchor="middle" x="148" y="-3064.13" font-family="Arial" font-size="14.00">MoE Layer 8</text>
<text text-anchor="middle" x="148" y="-3049.13" font-family="Arial" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="148" y="-3034.13" font-family="Arial" font-size="14.00">MHA + 8 Experts</text>
<text text-anchor="middle" x="148" y="-3019.13" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-3004.13" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-2989.13" font-family="Arial" font-size="14.00">Expert Weights: ~536MB</text>
<text text-anchor="middle" x="148" y="-2974.13" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_moe_7_8&#45;&gt;moe_layer_8 -->
<g id="edge24" class="edge">
<title>comm_moe_7_8&#45;&gt;moe_layer_8</title>
<path fill="none" stroke="black" d="M148,-3151.16C148,-3151.16 148,-3089.48 148,-3089.48"/>
<polygon fill="black" stroke="black" points="151.5,-3089.48 148,-3079.48 144.5,-3089.48 151.5,-3089.48"/>
</g>
<!-- comm_moe_8_9 -->
<g id="node17" class="node">
<title>comm_moe_8_9</title>
<ellipse fill="lightyellow" stroke="black" cx="148" cy="-2846.25" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="148" y="-2865.05" font-family="Arial" font-size="14.00">MoE Comm</text>
<text text-anchor="middle" x="148" y="-2850.05" font-family="Arial" font-size="14.00">GPU 7 → GPU 8</text>
<text text-anchor="middle" x="148" y="-2835.05" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-2820.05" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- moe_layer_8&#45;&gt;comm_moe_8_9 -->
<g id="edge9" class="edge">
<title>moe_layer_8&#45;&gt;comm_moe_8_9</title>
<path fill="none" stroke="black" d="M148,-2965.99C148,-2965.99 148,-2904.39 148,-2904.39"/>
<polygon fill="black" stroke="black" points="151.5,-2904.39 148,-2894.39 144.5,-2904.39 151.5,-2904.39"/>
</g>
<!-- moe_layer_9 -->
<g id="node18" class="node">
<title>moe_layer_9</title>
<path fill="lightcoral" stroke="black" d="M225,-2726.17C225,-2726.17 71,-2726.17 71,-2726.17 65,-2726.17 59,-2720.17 59,-2714.17 59,-2714.17 59,-2625.17 59,-2625.17 59,-2619.17 65,-2613.17 71,-2613.17 71,-2613.17 225,-2613.17 225,-2613.17 231,-2613.17 237,-2619.17 237,-2625.17 237,-2625.17 237,-2714.17 237,-2714.17 237,-2720.17 231,-2726.17 225,-2726.17"/>
<text text-anchor="middle" x="148" y="-2710.97" font-family="Arial" font-size="14.00">MoE Layer 9</text>
<text text-anchor="middle" x="148" y="-2695.97" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="148" y="-2680.97" font-family="Arial" font-size="14.00">MHA + 8 Experts</text>
<text text-anchor="middle" x="148" y="-2665.97" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-2650.97" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-2635.97" font-family="Arial" font-size="14.00">Expert Weights: ~536MB</text>
<text text-anchor="middle" x="148" y="-2620.97" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_moe_8_9&#45;&gt;moe_layer_9 -->
<g id="edge25" class="edge">
<title>comm_moe_8_9&#45;&gt;moe_layer_9</title>
<path fill="none" stroke="black" d="M148,-2798C148,-2798 148,-2736.31 148,-2736.31"/>
<polygon fill="black" stroke="black" points="151.5,-2736.31 148,-2726.31 144.5,-2736.31 151.5,-2736.31"/>
</g>
<!-- comm_moe_9_10 -->
<g id="node19" class="node">
<title>comm_moe_9_10</title>
<ellipse fill="lightyellow" stroke="black" cx="148" cy="-2493.08" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="148" y="-2511.88" font-family="Arial" font-size="14.00">MoE Comm</text>
<text text-anchor="middle" x="148" y="-2496.88" font-family="Arial" font-size="14.00">GPU 8 → GPU 9</text>
<text text-anchor="middle" x="148" y="-2481.88" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-2466.88" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- moe_layer_9&#45;&gt;comm_moe_9_10 -->
<g id="edge10" class="edge">
<title>moe_layer_9&#45;&gt;comm_moe_9_10</title>
<path fill="none" stroke="black" d="M148,-2612.82C148,-2612.82 148,-2551.23 148,-2551.23"/>
<polygon fill="black" stroke="black" points="151.5,-2551.23 148,-2541.23 144.5,-2551.23 151.5,-2551.23"/>
</g>
<!-- moe_layer_10 -->
<g id="node20" class="node">
<title>moe_layer_10</title>
<path fill="lightcoral" stroke="black" d="M225,-2373C225,-2373 71,-2373 71,-2373 65,-2373 59,-2367 59,-2361 59,-2361 59,-2272 59,-2272 59,-2266 65,-2260 71,-2260 71,-2260 225,-2260 225,-2260 231,-2260 237,-2266 237,-2272 237,-2272 237,-2361 237,-2361 237,-2367 231,-2373 225,-2373"/>
<text text-anchor="middle" x="148" y="-2357.8" font-family="Arial" font-size="14.00">MoE Layer 10</text>
<text text-anchor="middle" x="148" y="-2342.8" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="148" y="-2327.8" font-family="Arial" font-size="14.00">MHA + 8 Experts</text>
<text text-anchor="middle" x="148" y="-2312.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-2297.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-2282.8" font-family="Arial" font-size="14.00">Expert Weights: ~536MB</text>
<text text-anchor="middle" x="148" y="-2267.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_moe_9_10&#45;&gt;moe_layer_10 -->
<g id="edge26" class="edge">
<title>comm_moe_9_10&#45;&gt;moe_layer_10</title>
<path fill="none" stroke="black" d="M148,-2444.83C148,-2444.83 148,-2383.15 148,-2383.15"/>
<polygon fill="black" stroke="black" points="151.5,-2383.15 148,-2373.15 144.5,-2383.15 151.5,-2383.15"/>
</g>
<!-- comm_moe_10_11 -->
<g id="node21" class="node">
<title>comm_moe_10_11</title>
<ellipse fill="lightyellow" stroke="black" cx="148" cy="-2139.92" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="148" y="-2158.72" font-family="Arial" font-size="14.00">MoE Comm</text>
<text text-anchor="middle" x="148" y="-2143.72" font-family="Arial" font-size="14.00">GPU 9 → GPU 10</text>
<text text-anchor="middle" x="148" y="-2128.72" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-2113.72" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- moe_layer_10&#45;&gt;comm_moe_10_11 -->
<g id="edge11" class="edge">
<title>moe_layer_10&#45;&gt;comm_moe_10_11</title>
<path fill="none" stroke="black" d="M148,-2259.66C148,-2259.66 148,-2198.06 148,-2198.06"/>
<polygon fill="black" stroke="black" points="151.5,-2198.06 148,-2188.06 144.5,-2198.06 151.5,-2198.06"/>
</g>
<!-- moe_layer_11 -->
<g id="node22" class="node">
<title>moe_layer_11</title>
<path fill="lightcoral" stroke="black" d="M225,-2019.83C225,-2019.83 71,-2019.83 71,-2019.83 65,-2019.83 59,-2013.83 59,-2007.83 59,-2007.83 59,-1918.83 59,-1918.83 59,-1912.83 65,-1906.83 71,-1906.83 71,-1906.83 225,-1906.83 225,-1906.83 231,-1906.83 237,-1912.83 237,-1918.83 237,-1918.83 237,-2007.83 237,-2007.83 237,-2013.83 231,-2019.83 225,-2019.83"/>
<text text-anchor="middle" x="148" y="-2004.63" font-family="Arial" font-size="14.00">MoE Layer 11</text>
<text text-anchor="middle" x="148" y="-1989.63" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="148" y="-1974.63" font-family="Arial" font-size="14.00">MHA + 8 Experts</text>
<text text-anchor="middle" x="148" y="-1959.63" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-1944.63" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-1929.63" font-family="Arial" font-size="14.00">Expert Weights: ~536MB</text>
<text text-anchor="middle" x="148" y="-1914.63" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_moe_10_11&#45;&gt;moe_layer_11 -->
<g id="edge27" class="edge">
<title>comm_moe_10_11&#45;&gt;moe_layer_11</title>
<path fill="none" stroke="black" d="M148,-2091.66C148,-2091.66 148,-2029.98 148,-2029.98"/>
<polygon fill="black" stroke="black" points="151.5,-2029.98 148,-2019.98 144.5,-2029.98 151.5,-2029.98"/>
</g>
<!-- comm_moe_11_12 -->
<g id="node23" class="node">
<title>comm_moe_11_12</title>
<ellipse fill="lightyellow" stroke="black" cx="148" cy="-1786.75" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="148" y="-1805.55" font-family="Arial" font-size="14.00">MoE Comm</text>
<text text-anchor="middle" x="148" y="-1790.55" font-family="Arial" font-size="14.00">GPU 10 → GPU 11</text>
<text text-anchor="middle" x="148" y="-1775.55" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-1760.55" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- moe_layer_11&#45;&gt;comm_moe_11_12 -->
<g id="edge12" class="edge">
<title>moe_layer_11&#45;&gt;comm_moe_11_12</title>
<path fill="none" stroke="black" d="M148,-1906.49C148,-1906.49 148,-1844.89 148,-1844.89"/>
<polygon fill="black" stroke="black" points="151.5,-1844.89 148,-1834.89 144.5,-1844.89 151.5,-1844.89"/>
</g>
<!-- moe_layer_12 -->
<g id="node24" class="node">
<title>moe_layer_12</title>
<path fill="lightcoral" stroke="black" d="M225,-1666.67C225,-1666.67 71,-1666.67 71,-1666.67 65,-1666.67 59,-1660.67 59,-1654.67 59,-1654.67 59,-1565.67 59,-1565.67 59,-1559.67 65,-1553.67 71,-1553.67 71,-1553.67 225,-1553.67 225,-1553.67 231,-1553.67 237,-1559.67 237,-1565.67 237,-1565.67 237,-1654.67 237,-1654.67 237,-1660.67 231,-1666.67 225,-1666.67"/>
<text text-anchor="middle" x="148" y="-1651.47" font-family="Arial" font-size="14.00">MoE Layer 12</text>
<text text-anchor="middle" x="148" y="-1636.47" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="148" y="-1621.47" font-family="Arial" font-size="14.00">MHA + 8 Experts</text>
<text text-anchor="middle" x="148" y="-1606.47" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-1591.47" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-1576.47" font-family="Arial" font-size="14.00">Expert Weights: ~536MB</text>
<text text-anchor="middle" x="148" y="-1561.47" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_moe_11_12&#45;&gt;moe_layer_12 -->
<g id="edge28" class="edge">
<title>comm_moe_11_12&#45;&gt;moe_layer_12</title>
<path fill="none" stroke="black" d="M148,-1738.5C148,-1738.5 148,-1676.81 148,-1676.81"/>
<polygon fill="black" stroke="black" points="151.5,-1676.81 148,-1666.81 144.5,-1676.81 151.5,-1676.81"/>
</g>
<!-- comm_moe_12_13 -->
<g id="node25" class="node">
<title>comm_moe_12_13</title>
<ellipse fill="lightyellow" stroke="black" cx="148" cy="-1433.58" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="148" y="-1452.38" font-family="Arial" font-size="14.00">MoE Comm</text>
<text text-anchor="middle" x="148" y="-1437.38" font-family="Arial" font-size="14.00">GPU 11 → GPU 12</text>
<text text-anchor="middle" x="148" y="-1422.38" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-1407.38" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- moe_layer_12&#45;&gt;comm_moe_12_13 -->
<g id="edge13" class="edge">
<title>moe_layer_12&#45;&gt;comm_moe_12_13</title>
<path fill="none" stroke="black" d="M148,-1553.32C148,-1553.32 148,-1491.73 148,-1491.73"/>
<polygon fill="black" stroke="black" points="151.5,-1491.73 148,-1481.73 144.5,-1491.73 151.5,-1491.73"/>
</g>
<!-- moe_layer_13 -->
<g id="node26" class="node">
<title>moe_layer_13</title>
<path fill="lightcoral" stroke="black" d="M225,-1313.5C225,-1313.5 71,-1313.5 71,-1313.5 65,-1313.5 59,-1307.5 59,-1301.5 59,-1301.5 59,-1212.5 59,-1212.5 59,-1206.5 65,-1200.5 71,-1200.5 71,-1200.5 225,-1200.5 225,-1200.5 231,-1200.5 237,-1206.5 237,-1212.5 237,-1212.5 237,-1301.5 237,-1301.5 237,-1307.5 231,-1313.5 225,-1313.5"/>
<text text-anchor="middle" x="148" y="-1298.3" font-family="Arial" font-size="14.00">MoE Layer 13</text>
<text text-anchor="middle" x="148" y="-1283.3" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="148" y="-1268.3" font-family="Arial" font-size="14.00">MHA + 8 Experts</text>
<text text-anchor="middle" x="148" y="-1253.3" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-1238.3" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-1223.3" font-family="Arial" font-size="14.00">Expert Weights: ~536MB</text>
<text text-anchor="middle" x="148" y="-1208.3" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_moe_12_13&#45;&gt;moe_layer_13 -->
<g id="edge29" class="edge">
<title>comm_moe_12_13&#45;&gt;moe_layer_13</title>
<path fill="none" stroke="black" d="M148,-1385.33C148,-1385.33 148,-1323.65 148,-1323.65"/>
<polygon fill="black" stroke="black" points="151.5,-1323.65 148,-1313.65 144.5,-1323.65 151.5,-1323.65"/>
</g>
<!-- comm_moe_13_14 -->
<g id="node27" class="node">
<title>comm_moe_13_14</title>
<ellipse fill="lightyellow" stroke="black" cx="148" cy="-1080.42" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="148" y="-1099.22" font-family="Arial" font-size="14.00">MoE Comm</text>
<text text-anchor="middle" x="148" y="-1084.22" font-family="Arial" font-size="14.00">GPU 12 → GPU 13</text>
<text text-anchor="middle" x="148" y="-1069.22" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-1054.22" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- moe_layer_13&#45;&gt;comm_moe_13_14 -->
<g id="edge14" class="edge">
<title>moe_layer_13&#45;&gt;comm_moe_13_14</title>
<path fill="none" stroke="black" d="M148,-1200.16C148,-1200.16 148,-1138.56 148,-1138.56"/>
<polygon fill="black" stroke="black" points="151.5,-1138.56 148,-1128.56 144.5,-1138.56 151.5,-1138.56"/>
</g>
<!-- moe_layer_14 -->
<g id="node28" class="node">
<title>moe_layer_14</title>
<path fill="lightcoral" stroke="black" d="M225,-960.33C225,-960.33 71,-960.33 71,-960.33 65,-960.33 59,-954.33 59,-948.33 59,-948.33 59,-859.33 59,-859.33 59,-853.33 65,-847.33 71,-847.33 71,-847.33 225,-847.33 225,-847.33 231,-847.33 237,-853.33 237,-859.33 237,-859.33 237,-948.33 237,-948.33 237,-954.33 231,-960.33 225,-960.33"/>
<text text-anchor="middle" x="148" y="-945.13" font-family="Arial" font-size="14.00">MoE Layer 14</text>
<text text-anchor="middle" x="148" y="-930.13" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="148" y="-915.13" font-family="Arial" font-size="14.00">MHA + 8 Experts</text>
<text text-anchor="middle" x="148" y="-900.13" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-885.13" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-870.13" font-family="Arial" font-size="14.00">Expert Weights: ~536MB</text>
<text text-anchor="middle" x="148" y="-855.13" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_moe_13_14&#45;&gt;moe_layer_14 -->
<g id="edge30" class="edge">
<title>comm_moe_13_14&#45;&gt;moe_layer_14</title>
<path fill="none" stroke="black" d="M148,-1032.16C148,-1032.16 148,-970.48 148,-970.48"/>
<polygon fill="black" stroke="black" points="151.5,-970.48 148,-960.48 144.5,-970.48 151.5,-970.48"/>
</g>
<!-- comm_moe_14_15 -->
<g id="node29" class="node">
<title>comm_moe_14_15</title>
<ellipse fill="lightyellow" stroke="black" cx="148" cy="-727.25" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="148" y="-746.05" font-family="Arial" font-size="14.00">MoE Comm</text>
<text text-anchor="middle" x="148" y="-731.05" font-family="Arial" font-size="14.00">GPU 13 → GPU 14</text>
<text text-anchor="middle" x="148" y="-716.05" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-701.05" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- moe_layer_14&#45;&gt;comm_moe_14_15 -->
<g id="edge15" class="edge">
<title>moe_layer_14&#45;&gt;comm_moe_14_15</title>
<path fill="none" stroke="black" d="M148,-846.99C148,-846.99 148,-785.39 148,-785.39"/>
<polygon fill="black" stroke="black" points="151.5,-785.39 148,-775.39 144.5,-785.39 151.5,-785.39"/>
</g>
<!-- moe_layer_15 -->
<g id="node30" class="node">
<title>moe_layer_15</title>
<path fill="lightcoral" stroke="black" d="M225,-607.17C225,-607.17 71,-607.17 71,-607.17 65,-607.17 59,-601.17 59,-595.17 59,-595.17 59,-506.17 59,-506.17 59,-500.17 65,-494.17 71,-494.17 71,-494.17 225,-494.17 225,-494.17 231,-494.17 237,-500.17 237,-506.17 237,-506.17 237,-595.17 237,-595.17 237,-601.17 231,-607.17 225,-607.17"/>
<text text-anchor="middle" x="148" y="-591.97" font-family="Arial" font-size="14.00">MoE Layer 15</text>
<text text-anchor="middle" x="148" y="-576.97" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="148" y="-561.97" font-family="Arial" font-size="14.00">MHA + 8 Experts</text>
<text text-anchor="middle" x="148" y="-546.97" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-531.97" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-516.97" font-family="Arial" font-size="14.00">Expert Weights: ~536MB</text>
<text text-anchor="middle" x="148" y="-501.97" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_moe_14_15&#45;&gt;moe_layer_15 -->
<g id="edge31" class="edge">
<title>comm_moe_14_15&#45;&gt;moe_layer_15</title>
<path fill="none" stroke="black" d="M148,-679C148,-679 148,-617.31 148,-617.31"/>
<polygon fill="black" stroke="black" points="151.5,-617.31 148,-607.31 144.5,-617.31 151.5,-617.31"/>
</g>
<!-- comm_moe_15_16 -->
<g id="node31" class="node">
<title>comm_moe_15_16</title>
<ellipse fill="lightyellow" stroke="black" cx="148" cy="-374.08" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="148" y="-392.88" font-family="Arial" font-size="14.00">MoE Comm</text>
<text text-anchor="middle" x="148" y="-377.88" font-family="Arial" font-size="14.00">GPU 14 → GPU 15</text>
<text text-anchor="middle" x="148" y="-362.88" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-347.88" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- moe_layer_15&#45;&gt;comm_moe_15_16 -->
<g id="edge16" class="edge">
<title>moe_layer_15&#45;&gt;comm_moe_15_16</title>
<path fill="none" stroke="black" d="M148,-493.82C148,-493.82 148,-432.23 148,-432.23"/>
<polygon fill="black" stroke="black" points="151.5,-432.23 148,-422.23 144.5,-432.23 151.5,-432.23"/>
</g>
<!-- moe_layer_16 -->
<g id="node32" class="node">
<title>moe_layer_16</title>
<path fill="lightcoral" stroke="black" d="M225,-254C225,-254 71,-254 71,-254 65,-254 59,-248 59,-242 59,-242 59,-153 59,-153 59,-147 65,-141 71,-141 71,-141 225,-141 225,-141 231,-141 237,-147 237,-153 237,-153 237,-242 237,-242 237,-248 231,-254 225,-254"/>
<text text-anchor="middle" x="148" y="-238.8" font-family="Arial" font-size="14.00">MoE Layer 16</text>
<text text-anchor="middle" x="148" y="-223.8" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="148" y="-208.8" font-family="Arial" font-size="14.00">MHA + 8 Experts</text>
<text text-anchor="middle" x="148" y="-193.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-178.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-163.8" font-family="Arial" font-size="14.00">Expert Weights: ~536MB</text>
<text text-anchor="middle" x="148" y="-148.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_moe_15_16&#45;&gt;moe_layer_16 -->
<g id="edge32" class="edge">
<title>comm_moe_15_16&#45;&gt;moe_layer_16</title>
<path fill="none" stroke="black" d="M148,-325.83C148,-325.83 148,-264.15 148,-264.15"/>
<polygon fill="black" stroke="black" points="151.5,-264.15 148,-254.15 144.5,-264.15 151.5,-264.15"/>
</g>
<!-- output_moe -->
<g id="node33" class="node">
<title>output_moe</title>
<path fill="lightblue" stroke="black" d="M241,-69C241,-69 55,-69 55,-69 49,-69 43,-63 43,-57 43,-57 43,-28 43,-28 43,-22 49,-16 55,-16 55,-16 241,-16 241,-16 247,-16 253,-22 253,-28 253,-28 253,-57 253,-57 253,-63 247,-69 241,-69"/>
<text text-anchor="middle" x="148" y="-53.8" font-family="Arial" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="148" y="-38.8" font-family="Arial" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="148" y="-23.8" font-family="Arial" font-size="14.00">Logits: [1024, 2048, vocab_size]</text>
</g>
<!-- moe_layer_16&#45;&gt;output_moe -->
<g id="edge17" class="edge">
<title>moe_layer_16&#45;&gt;output_moe</title>
<path fill="none" stroke="black" d="M148,-140.66C148,-140.66 148,-79.38 148,-79.38"/>
<polygon fill="black" stroke="black" points="151.5,-79.38 148,-69.38 144.5,-79.38 151.5,-79.38"/>
</g>
<!-- mha_qkv_1 -->
<g id="node35" class="node">
<title>mha_qkv_1</title>
<path fill="lightpink" stroke="black" d="M489.5,-5372C489.5,-5372 328.5,-5372 328.5,-5372 322.5,-5372 316.5,-5366 316.5,-5360 316.5,-5360 316.5,-5286 316.5,-5286 316.5,-5280 322.5,-5274 328.5,-5274 328.5,-5274 489.5,-5274 489.5,-5274 495.5,-5274 501.5,-5280 501.5,-5286 501.5,-5286 501.5,-5360 501.5,-5360 501.5,-5366 495.5,-5372 489.5,-5372"/>
<text text-anchor="middle" x="409" y="-5356.8" font-family="Arial" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="409" y="-5341.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="409" y="-5326.8" font-family="Arial" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="409" y="-5311.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="409" y="-5296.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 12288]</text>
<text text-anchor="middle" x="409" y="-5281.8" font-family="Arial" font-size="14.00">Weights: ~100MB</text>
</g>
<!-- dense_layer_1&#45;&gt;mha_qkv_1 -->
<g id="edge33" class="edge">
<title>dense_layer_1&#45;&gt;mha_qkv_1</title>
<path fill="none" stroke="black" d="M409,-5443.85C409,-5443.85 409,-5382.24 409,-5382.24"/>
<polygon fill="black" stroke="black" points="412.5,-5382.24 409,-5372.24 405.5,-5382.24 412.5,-5382.24"/>
</g>
<!-- comm_dense_1_2 -->
<g id="node55" class="node">
<title>comm_dense_1_2</title>
<ellipse fill="lightyellow" stroke="black" cx="934" cy="-5323" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="934" y="-5341.8" font-family="Arial" font-size="14.00">Dense Comm</text>
<text text-anchor="middle" x="934" y="-5326.8" font-family="Arial" font-size="14.00">GPU 0 → GPU 1</text>
<text text-anchor="middle" x="934" y="-5311.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="934" y="-5296.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- dense_layer_1&#45;&gt;comm_dense_1_2 -->
<g id="edge39" class="edge">
<title>dense_layer_1&#45;&gt;comm_dense_1_2</title>
<path fill="none" stroke="black" d="M498.09,-5500C627.42,-5500 851.89,-5500 851.89,-5500 851.89,-5500 851.89,-5370.97 851.89,-5370.97"/>
<polygon fill="black" stroke="black" points="855.39,-5370.97 851.89,-5360.97 848.39,-5370.97 855.39,-5370.97"/>
</g>
<!-- mha_out_1 -->
<g id="node36" class="node">
<title>mha_out_1</title>
<path fill="lightpink" stroke="black" d="M486,-5194.5C486,-5194.5 332,-5194.5 332,-5194.5 326,-5194.5 320,-5188.5 320,-5182.5 320,-5182.5 320,-5108.5 320,-5108.5 320,-5102.5 326,-5096.5 332,-5096.5 332,-5096.5 486,-5096.5 486,-5096.5 492,-5096.5 498,-5102.5 498,-5108.5 498,-5108.5 498,-5182.5 498,-5182.5 498,-5188.5 492,-5194.5 486,-5194.5"/>
<text text-anchor="middle" x="409" y="-5179.3" font-family="Arial" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="409" y="-5164.3" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="409" y="-5149.3" font-family="Arial" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="409" y="-5134.3" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="409" y="-5119.3" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="409" y="-5104.3" font-family="Arial" font-size="14.00">Weights: ~67MB</text>
</g>
<!-- mha_qkv_1&#45;&gt;mha_out_1 -->
<g id="edge34" class="edge">
<title>mha_qkv_1&#45;&gt;mha_out_1</title>
<path fill="none" stroke="black" d="M409,-5273.55C409,-5273.55 409,-5204.68 409,-5204.68"/>
<polygon fill="black" stroke="black" points="412.5,-5204.68 409,-5194.68 405.5,-5204.68 412.5,-5204.68"/>
</g>
<!-- ffn_gate_1 -->
<g id="node37" class="node">
<title>ffn_gate_1</title>
<path fill="lightcyan" stroke="black" d="M489.5,-5017C489.5,-5017 328.5,-5017 328.5,-5017 322.5,-5017 316.5,-5011 316.5,-5005 316.5,-5005 316.5,-4931 316.5,-4931 316.5,-4925 322.5,-4919 328.5,-4919 328.5,-4919 489.5,-4919 489.5,-4919 495.5,-4919 501.5,-4925 501.5,-4931 501.5,-4931 501.5,-5005 501.5,-5005 501.5,-5011 495.5,-5017 489.5,-5017"/>
<text text-anchor="middle" x="409" y="-5001.8" font-family="Arial" font-size="14.00">FFN Gate Linear</text>
<text text-anchor="middle" x="409" y="-4986.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="409" y="-4971.8" font-family="Arial" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="409" y="-4956.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="409" y="-4941.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 16384]</text>
<text text-anchor="middle" x="409" y="-4926.8" font-family="Arial" font-size="14.00">Weights: ~268MB</text>
</g>
<!-- mha_out_1&#45;&gt;ffn_gate_1 -->
<g id="edge35" class="edge">
<title>mha_out_1&#45;&gt;ffn_gate_1</title>
<path fill="none" stroke="black" d="M409,-5096.05C409,-5096.05 409,-5027.18 409,-5027.18"/>
<polygon fill="black" stroke="black" points="412.5,-5027.18 409,-5017.18 405.5,-5027.18 412.5,-5027.18"/>
</g>
<!-- ffn_up_1 -->
<g id="node38" class="node">
<title>ffn_up_1</title>
<path fill="lightcyan" stroke="black" d="M489.5,-4839.5C489.5,-4839.5 328.5,-4839.5 328.5,-4839.5 322.5,-4839.5 316.5,-4833.5 316.5,-4827.5 316.5,-4827.5 316.5,-4753.5 316.5,-4753.5 316.5,-4747.5 322.5,-4741.5 328.5,-4741.5 328.5,-4741.5 489.5,-4741.5 489.5,-4741.5 495.5,-4741.5 501.5,-4747.5 501.5,-4753.5 501.5,-4753.5 501.5,-4827.5 501.5,-4827.5 501.5,-4833.5 495.5,-4839.5 489.5,-4839.5"/>
<text text-anchor="middle" x="409" y="-4824.3" font-family="Arial" font-size="14.00">FFN Up Linear</text>
<text text-anchor="middle" x="409" y="-4809.3" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="409" y="-4794.3" font-family="Arial" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="409" y="-4779.3" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="409" y="-4764.3" font-family="Arial" font-size="14.00">Output: [1024, 2048, 16384]</text>
<text text-anchor="middle" x="409" y="-4749.3" font-family="Arial" font-size="14.00">Weights: ~268MB</text>
</g>
<!-- ffn_gate_1&#45;&gt;ffn_up_1 -->
<g id="edge36" class="edge">
<title>ffn_gate_1&#45;&gt;ffn_up_1</title>
<path fill="none" stroke="black" d="M409,-4918.55C409,-4918.55 409,-4849.68 409,-4849.68"/>
<polygon fill="black" stroke="black" points="412.5,-4849.68 409,-4839.68 405.5,-4849.68 412.5,-4849.68"/>
</g>
<!-- ffn_down_1 -->
<g id="node39" class="node">
<title>ffn_down_1</title>
<path fill="lightcyan" stroke="black" d="M486,-4662C486,-4662 332,-4662 332,-4662 326,-4662 320,-4656 320,-4650 320,-4650 320,-4576 320,-4576 320,-4570 326,-4564 332,-4564 332,-4564 486,-4564 486,-4564 492,-4564 498,-4570 498,-4576 498,-4576 498,-4650 498,-4650 498,-4656 492,-4662 486,-4662"/>
<text text-anchor="middle" x="409" y="-4646.8" font-family="Arial" font-size="14.00">FFN Down Linear</text>
<text text-anchor="middle" x="409" y="-4631.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="409" y="-4616.8" font-family="Arial" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="409" y="-4601.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 16384]</text>
<text text-anchor="middle" x="409" y="-4586.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="409" y="-4571.8" font-family="Arial" font-size="14.00">Weights: ~268MB</text>
</g>
<!-- ffn_up_1&#45;&gt;ffn_down_1 -->
<g id="edge37" class="edge">
<title>ffn_up_1&#45;&gt;ffn_down_1</title>
<path fill="none" stroke="black" d="M409,-4741.05C409,-4741.05 409,-4672.18 409,-4672.18"/>
<polygon fill="black" stroke="black" points="412.5,-4672.18 409,-4662.18 405.5,-4672.18 412.5,-4672.18"/>
</g>
<!-- dense_layer_2 -->
<g id="node40" class="node">
<title>dense_layer_2</title>
<path fill="lightgreen" stroke="black" d="M1237,-5202C1237,-5202 1083,-5202 1083,-5202 1077,-5202 1071,-5196 1071,-5190 1071,-5190 1071,-5101 1071,-5101 1071,-5095 1077,-5089 1083,-5089 1083,-5089 1237,-5089 1237,-5089 1243,-5089 1249,-5095 1249,-5101 1249,-5101 1249,-5190 1249,-5190 1249,-5196 1243,-5202 1237,-5202"/>
<text text-anchor="middle" x="1160" y="-5186.8" font-family="Arial" font-size="14.00">Dense Layer 2</text>
<text text-anchor="middle" x="1160" y="-5171.8" font-family="Arial" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1160" y="-5156.8" font-family="Arial" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="1160" y="-5141.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1160" y="-5126.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1160" y="-5111.8" font-family="Arial" font-size="14.00">Weights: ~67MB</text>
<text text-anchor="middle" x="1160" y="-5096.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_dense_2_3 -->
<g id="node56" class="node">
<title>comm_dense_2_3</title>
<ellipse fill="lightyellow" stroke="black" cx="708" cy="-4968" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="708" y="-4986.8" font-family="Arial" font-size="14.00">Dense Comm</text>
<text text-anchor="middle" x="708" y="-4971.8" font-family="Arial" font-size="14.00">GPU 1 → GPU 2</text>
<text text-anchor="middle" x="708" y="-4956.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="708" y="-4941.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- dense_layer_2&#45;&gt;comm_dense_2_3 -->
<g id="edge40" class="edge">
<title>dense_layer_2&#45;&gt;comm_dense_2_3</title>
<path fill="none" stroke="black" d="M1070.6,-5092C968.26,-5092 814.59,-5092 814.59,-5092 814.59,-5092 814.59,-5006.76 814.59,-5006.76"/>
<polygon fill="black" stroke="black" points="818.09,-5006.76 814.59,-4996.76 811.09,-5006.76 818.09,-5006.76"/>
</g>
<!-- dense_layer_3 -->
<g id="node41" class="node">
<title>dense_layer_3</title>
<path fill="lightgreen" stroke="black" d="M1451,-5202C1451,-5202 1297,-5202 1297,-5202 1291,-5202 1285,-5196 1285,-5190 1285,-5190 1285,-5101 1285,-5101 1285,-5095 1291,-5089 1297,-5089 1297,-5089 1451,-5089 1451,-5089 1457,-5089 1463,-5095 1463,-5101 1463,-5101 1463,-5190 1463,-5190 1463,-5196 1457,-5202 1451,-5202"/>
<text text-anchor="middle" x="1374" y="-5186.8" font-family="Arial" font-size="14.00">Dense Layer 3</text>
<text text-anchor="middle" x="1374" y="-5171.8" font-family="Arial" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1374" y="-5156.8" font-family="Arial" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="1374" y="-5141.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1374" y="-5126.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1374" y="-5111.8" font-family="Arial" font-size="14.00">Weights: ~67MB</text>
<text text-anchor="middle" x="1374" y="-5096.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_dense_3_4 -->
<g id="node57" class="node">
<title>comm_dense_3_4</title>
<ellipse fill="lightyellow" stroke="black" cx="1008" cy="-4968" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="1008" y="-4986.8" font-family="Arial" font-size="14.00">Dense Comm</text>
<text text-anchor="middle" x="1008" y="-4971.8" font-family="Arial" font-size="14.00">GPU 2 → GPU 3</text>
<text text-anchor="middle" x="1008" y="-4956.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1008" y="-4941.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- dense_layer_3&#45;&gt;comm_dense_3_4 -->
<g id="edge41" class="edge">
<title>dense_layer_3&#45;&gt;comm_dense_3_4</title>
<path fill="none" stroke="black" d="M1362.61,-5088.84C1362.61,-5068.28 1362.61,-5050 1362.61,-5050 1362.61,-5050 1094.08,-5050 1094.08,-5050 1094.08,-5050 1094.08,-5014.68 1094.08,-5014.68"/>
<polygon fill="black" stroke="black" points="1097.58,-5014.68 1094.08,-5004.68 1090.58,-5014.68 1097.58,-5014.68"/>
</g>
<!-- dense_layer_4 -->
<g id="node42" class="node">
<title>dense_layer_4</title>
<path fill="lightgreen" stroke="black" d="M1665,-5202C1665,-5202 1511,-5202 1511,-5202 1505,-5202 1499,-5196 1499,-5190 1499,-5190 1499,-5101 1499,-5101 1499,-5095 1505,-5089 1511,-5089 1511,-5089 1665,-5089 1665,-5089 1671,-5089 1677,-5095 1677,-5101 1677,-5101 1677,-5190 1677,-5190 1677,-5196 1671,-5202 1665,-5202"/>
<text text-anchor="middle" x="1588" y="-5186.8" font-family="Arial" font-size="14.00">Dense Layer 4</text>
<text text-anchor="middle" x="1588" y="-5171.8" font-family="Arial" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1588" y="-5156.8" font-family="Arial" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="1588" y="-5141.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1588" y="-5126.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1588" y="-5111.8" font-family="Arial" font-size="14.00">Weights: ~67MB</text>
<text text-anchor="middle" x="1588" y="-5096.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_dense_4_5 -->
<g id="node58" class="node">
<title>comm_dense_4_5</title>
<ellipse fill="lightyellow" stroke="black" cx="1308" cy="-4968" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="1308" y="-4986.8" font-family="Arial" font-size="14.00">Dense Comm</text>
<text text-anchor="middle" x="1308" y="-4971.8" font-family="Arial" font-size="14.00">GPU 3 → GPU 4</text>
<text text-anchor="middle" x="1308" y="-4956.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1308" y="-4941.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- dense_layer_4&#45;&gt;comm_dense_4_5 -->
<g id="edge42" class="edge">
<title>dense_layer_4&#45;&gt;comm_dense_4_5</title>
<path fill="none" stroke="black" d="M1498.71,-5145C1481.85,-5145 1469.39,-5145 1469.39,-5145 1469.39,-5145 1469.39,-4967 1469.39,-4967 1469.39,-4967 1450.53,-4967 1450.53,-4967"/>
<polygon fill="black" stroke="black" points="1450.53,-4963.5 1440.53,-4967 1450.53,-4970.5 1450.53,-4963.5"/>
</g>
<!-- dense_layer_5 -->
<g id="node43" class="node">
<title>dense_layer_5</title>
<path fill="lightgreen" stroke="black" d="M1879,-5202C1879,-5202 1725,-5202 1725,-5202 1719,-5202 1713,-5196 1713,-5190 1713,-5190 1713,-5101 1713,-5101 1713,-5095 1719,-5089 1725,-5089 1725,-5089 1879,-5089 1879,-5089 1885,-5089 1891,-5095 1891,-5101 1891,-5101 1891,-5190 1891,-5190 1891,-5196 1885,-5202 1879,-5202"/>
<text text-anchor="middle" x="1802" y="-5186.8" font-family="Arial" font-size="14.00">Dense Layer 5</text>
<text text-anchor="middle" x="1802" y="-5171.8" font-family="Arial" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1802" y="-5156.8" font-family="Arial" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="1802" y="-5141.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1802" y="-5126.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1802" y="-5111.8" font-family="Arial" font-size="14.00">Weights: ~67MB</text>
<text text-anchor="middle" x="1802" y="-5096.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_dense_5_6 -->
<g id="node59" class="node">
<title>comm_dense_5_6</title>
<ellipse fill="lightyellow" stroke="black" cx="1608" cy="-4968" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="1608" y="-4986.8" font-family="Arial" font-size="14.00">Dense Comm</text>
<text text-anchor="middle" x="1608" y="-4971.8" font-family="Arial" font-size="14.00">GPU 4 → GPU 5</text>
<text text-anchor="middle" x="1608" y="-4956.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1608" y="-4941.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- dense_layer_5&#45;&gt;comm_dense_5_6 -->
<g id="edge43" class="edge">
<title>dense_layer_5&#45;&gt;comm_dense_5_6</title>
<path fill="none" stroke="black" d="M1726.61,-5088.85C1726.61,-5088.85 1726.61,-4999.37 1726.61,-4999.37"/>
<polygon fill="black" stroke="black" points="1730.11,-4999.37 1726.61,-4989.37 1723.11,-4999.37 1730.11,-4999.37"/>
</g>
<!-- dense_layer_6 -->
<g id="node44" class="node">
<title>dense_layer_6</title>
<path fill="lightgreen" stroke="black" d="M2093,-5202C2093,-5202 1939,-5202 1939,-5202 1933,-5202 1927,-5196 1927,-5190 1927,-5190 1927,-5101 1927,-5101 1927,-5095 1933,-5089 1939,-5089 1939,-5089 2093,-5089 2093,-5089 2099,-5089 2105,-5095 2105,-5101 2105,-5101 2105,-5190 2105,-5190 2105,-5196 2099,-5202 2093,-5202"/>
<text text-anchor="middle" x="2016" y="-5186.8" font-family="Arial" font-size="14.00">Dense Layer 6</text>
<text text-anchor="middle" x="2016" y="-5171.8" font-family="Arial" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2016" y="-5156.8" font-family="Arial" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="2016" y="-5141.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2016" y="-5126.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2016" y="-5111.8" font-family="Arial" font-size="14.00">Weights: ~67MB</text>
<text text-anchor="middle" x="2016" y="-5096.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_dense_6_7 -->
<g id="node60" class="node">
<title>comm_dense_6_7</title>
<ellipse fill="lightyellow" stroke="black" cx="1908" cy="-4968" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="1908" y="-4986.8" font-family="Arial" font-size="14.00">Dense Comm</text>
<text text-anchor="middle" x="1908" y="-4971.8" font-family="Arial" font-size="14.00">GPU 5 → GPU 6</text>
<text text-anchor="middle" x="1908" y="-4956.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1908" y="-4941.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- dense_layer_6&#45;&gt;comm_dense_6_7 -->
<g id="edge44" class="edge">
<title>dense_layer_6&#45;&gt;comm_dense_6_7</title>
<path fill="none" stroke="black" d="M1983.61,-5088.85C1983.61,-5088.85 1983.61,-5017.56 1983.61,-5017.56"/>
<polygon fill="black" stroke="black" points="1987.11,-5017.56 1983.61,-5007.56 1980.11,-5017.56 1987.11,-5017.56"/>
</g>
<!-- dense_layer_7 -->
<g id="node45" class="node">
<title>dense_layer_7</title>
<path fill="lightgreen" stroke="black" d="M2307,-5202C2307,-5202 2153,-5202 2153,-5202 2147,-5202 2141,-5196 2141,-5190 2141,-5190 2141,-5101 2141,-5101 2141,-5095 2147,-5089 2153,-5089 2153,-5089 2307,-5089 2307,-5089 2313,-5089 2319,-5095 2319,-5101 2319,-5101 2319,-5190 2319,-5190 2319,-5196 2313,-5202 2307,-5202"/>
<text text-anchor="middle" x="2230" y="-5186.8" font-family="Arial" font-size="14.00">Dense Layer 7</text>
<text text-anchor="middle" x="2230" y="-5171.8" font-family="Arial" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="2230" y="-5156.8" font-family="Arial" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="2230" y="-5141.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2230" y="-5126.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2230" y="-5111.8" font-family="Arial" font-size="14.00">Weights: ~67MB</text>
<text text-anchor="middle" x="2230" y="-5096.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_dense_7_8 -->
<g id="node61" class="node">
<title>comm_dense_7_8</title>
<ellipse fill="lightyellow" stroke="black" cx="2208" cy="-4968" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="2208" y="-4986.8" font-family="Arial" font-size="14.00">Dense Comm</text>
<text text-anchor="middle" x="2208" y="-4971.8" font-family="Arial" font-size="14.00">GPU 6 → GPU 7</text>
<text text-anchor="middle" x="2208" y="-4956.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2208" y="-4941.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- dense_layer_7&#45;&gt;comm_dense_7_8 -->
<g id="edge45" class="edge">
<title>dense_layer_7&#45;&gt;comm_dense_7_8</title>
<path fill="none" stroke="black" d="M2259.67,-5088.85C2259.67,-5088.85 2259.67,-5022.32 2259.67,-5022.32"/>
<polygon fill="black" stroke="black" points="2263.17,-5022.32 2259.67,-5012.32 2256.17,-5022.32 2263.17,-5022.32"/>
</g>
<!-- dense_layer_8 -->
<g id="node46" class="node">
<title>dense_layer_8</title>
<path fill="lightgreen" stroke="black" d="M2521,-5202C2521,-5202 2367,-5202 2367,-5202 2361,-5202 2355,-5196 2355,-5190 2355,-5190 2355,-5101 2355,-5101 2355,-5095 2361,-5089 2367,-5089 2367,-5089 2521,-5089 2521,-5089 2527,-5089 2533,-5095 2533,-5101 2533,-5101 2533,-5190 2533,-5190 2533,-5196 2527,-5202 2521,-5202"/>
<text text-anchor="middle" x="2444" y="-5186.8" font-family="Arial" font-size="14.00">Dense Layer 8</text>
<text text-anchor="middle" x="2444" y="-5171.8" font-family="Arial" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="2444" y="-5156.8" font-family="Arial" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="2444" y="-5141.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2444" y="-5126.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2444" y="-5111.8" font-family="Arial" font-size="14.00">Weights: ~67MB</text>
<text text-anchor="middle" x="2444" y="-5096.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_dense_8_9 -->
<g id="node62" class="node">
<title>comm_dense_8_9</title>
<ellipse fill="lightyellow" stroke="black" cx="2508" cy="-4968" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="2508" y="-4986.8" font-family="Arial" font-size="14.00">Dense Comm</text>
<text text-anchor="middle" x="2508" y="-4971.8" font-family="Arial" font-size="14.00">GPU 7 → GPU 8</text>
<text text-anchor="middle" x="2508" y="-4956.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2508" y="-4941.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- dense_layer_8&#45;&gt;comm_dense_8_9 -->
<g id="edge46" class="edge">
<title>dense_layer_8&#45;&gt;comm_dense_8_9</title>
<path fill="none" stroke="black" d="M2454.39,-5088.85C2454.39,-5088.85 2454.39,-5022.04 2454.39,-5022.04"/>
<polygon fill="black" stroke="black" points="2457.89,-5022.04 2454.39,-5012.04 2450.89,-5022.04 2457.89,-5022.04"/>
</g>
<!-- dense_layer_9 -->
<g id="node47" class="node">
<title>dense_layer_9</title>
<path fill="lightgreen" stroke="black" d="M2735,-5202C2735,-5202 2581,-5202 2581,-5202 2575,-5202 2569,-5196 2569,-5190 2569,-5190 2569,-5101 2569,-5101 2569,-5095 2575,-5089 2581,-5089 2581,-5089 2735,-5089 2735,-5089 2741,-5089 2747,-5095 2747,-5101 2747,-5101 2747,-5190 2747,-5190 2747,-5196 2741,-5202 2735,-5202"/>
<text text-anchor="middle" x="2658" y="-5186.8" font-family="Arial" font-size="14.00">Dense Layer 9</text>
<text text-anchor="middle" x="2658" y="-5171.8" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="2658" y="-5156.8" font-family="Arial" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="2658" y="-5141.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2658" y="-5126.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2658" y="-5111.8" font-family="Arial" font-size="14.00">Weights: ~67MB</text>
<text text-anchor="middle" x="2658" y="-5096.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_dense_9_10 -->
<g id="node63" class="node">
<title>comm_dense_9_10</title>
<ellipse fill="lightyellow" stroke="black" cx="2808" cy="-4968" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="2808" y="-4986.8" font-family="Arial" font-size="14.00">Dense Comm</text>
<text text-anchor="middle" x="2808" y="-4971.8" font-family="Arial" font-size="14.00">GPU 8 → GPU 9</text>
<text text-anchor="middle" x="2808" y="-4956.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2808" y="-4941.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- dense_layer_9&#45;&gt;comm_dense_9_10 -->
<g id="edge47" class="edge">
<title>dense_layer_9&#45;&gt;comm_dense_9_10</title>
<path fill="none" stroke="black" d="M2711.39,-5088.85C2711.39,-5088.85 2711.39,-5010.89 2711.39,-5010.89"/>
<polygon fill="black" stroke="black" points="2714.89,-5010.89 2711.39,-5000.89 2707.89,-5010.89 2714.89,-5010.89"/>
</g>
<!-- dense_layer_10 -->
<g id="node48" class="node">
<title>dense_layer_10</title>
<path fill="lightgreen" stroke="black" d="M2949,-5202C2949,-5202 2795,-5202 2795,-5202 2789,-5202 2783,-5196 2783,-5190 2783,-5190 2783,-5101 2783,-5101 2783,-5095 2789,-5089 2795,-5089 2795,-5089 2949,-5089 2949,-5089 2955,-5089 2961,-5095 2961,-5101 2961,-5101 2961,-5190 2961,-5190 2961,-5196 2955,-5202 2949,-5202"/>
<text text-anchor="middle" x="2872" y="-5186.8" font-family="Arial" font-size="14.00">Dense Layer 10</text>
<text text-anchor="middle" x="2872" y="-5171.8" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="2872" y="-5156.8" font-family="Arial" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="2872" y="-5141.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2872" y="-5126.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="2872" y="-5111.8" font-family="Arial" font-size="14.00">Weights: ~67MB</text>
<text text-anchor="middle" x="2872" y="-5096.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_dense_10_11 -->
<g id="node64" class="node">
<title>comm_dense_10_11</title>
<ellipse fill="lightyellow" stroke="black" cx="3108" cy="-4968" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="3108" y="-4986.8" font-family="Arial" font-size="14.00">Dense Comm</text>
<text text-anchor="middle" x="3108" y="-4971.8" font-family="Arial" font-size="14.00">GPU 9 → GPU 10</text>
<text text-anchor="middle" x="3108" y="-4956.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="3108" y="-4941.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- dense_layer_10&#45;&gt;comm_dense_10_11 -->
<g id="edge48" class="edge">
<title>dense_layer_10&#45;&gt;comm_dense_10_11</title>
<path fill="none" stroke="black" d="M2950.61,-5088.53C2950.61,-5036.29 2950.61,-4967 2950.61,-4967 2950.61,-4967 2965.55,-4967 2965.55,-4967"/>
<polygon fill="black" stroke="black" points="2965.55,-4970.5 2975.55,-4967 2965.55,-4963.5 2965.55,-4970.5"/>
</g>
<!-- dense_layer_11 -->
<g id="node49" class="node">
<title>dense_layer_11</title>
<path fill="lightgreen" stroke="black" d="M3163,-5202C3163,-5202 3009,-5202 3009,-5202 3003,-5202 2997,-5196 2997,-5190 2997,-5190 2997,-5101 2997,-5101 2997,-5095 3003,-5089 3009,-5089 3009,-5089 3163,-5089 3163,-5089 3169,-5089 3175,-5095 3175,-5101 3175,-5101 3175,-5190 3175,-5190 3175,-5196 3169,-5202 3163,-5202"/>
<text text-anchor="middle" x="3086" y="-5186.8" font-family="Arial" font-size="14.00">Dense Layer 11</text>
<text text-anchor="middle" x="3086" y="-5171.8" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="3086" y="-5156.8" font-family="Arial" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="3086" y="-5141.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="3086" y="-5126.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="3086" y="-5111.8" font-family="Arial" font-size="14.00">Weights: ~67MB</text>
<text text-anchor="middle" x="3086" y="-5096.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_dense_11_12 -->
<g id="node65" class="node">
<title>comm_dense_11_12</title>
<ellipse fill="lightyellow" stroke="black" cx="3408" cy="-4968" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="3408" y="-4986.8" font-family="Arial" font-size="14.00">Dense Comm</text>
<text text-anchor="middle" x="3408" y="-4971.8" font-family="Arial" font-size="14.00">GPU 10 → GPU 11</text>
<text text-anchor="middle" x="3408" y="-4956.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="3408" y="-4941.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- dense_layer_11&#45;&gt;comm_dense_11_12 -->
<g id="edge49" class="edge">
<title>dense_layer_11&#45;&gt;comm_dense_11_12</title>
<path fill="none" stroke="black" d="M3056.33,-5088.81C3056.33,-5056.34 3056.33,-5022 3056.33,-5022 3056.33,-5022 3304.08,-5022 3304.08,-5022 3304.08,-5022 3304.08,-5007.84 3304.08,-5007.84"/>
<polygon fill="black" stroke="black" points="3307.58,-5007.84 3304.08,-4997.84 3300.58,-5007.84 3307.58,-5007.84"/>
</g>
<!-- dense_layer_12 -->
<g id="node50" class="node">
<title>dense_layer_12</title>
<path fill="lightgreen" stroke="black" d="M3377,-5202C3377,-5202 3223,-5202 3223,-5202 3217,-5202 3211,-5196 3211,-5190 3211,-5190 3211,-5101 3211,-5101 3211,-5095 3217,-5089 3223,-5089 3223,-5089 3377,-5089 3377,-5089 3383,-5089 3389,-5095 3389,-5101 3389,-5101 3389,-5190 3389,-5190 3389,-5196 3383,-5202 3377,-5202"/>
<text text-anchor="middle" x="3300" y="-5186.8" font-family="Arial" font-size="14.00">Dense Layer 12</text>
<text text-anchor="middle" x="3300" y="-5171.8" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="3300" y="-5156.8" font-family="Arial" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="3300" y="-5141.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="3300" y="-5126.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="3300" y="-5111.8" font-family="Arial" font-size="14.00">Weights: ~67MB</text>
<text text-anchor="middle" x="3300" y="-5096.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_dense_12_13 -->
<g id="node66" class="node">
<title>comm_dense_12_13</title>
<ellipse fill="lightyellow" stroke="black" cx="3708" cy="-4968" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="3708" y="-4986.8" font-family="Arial" font-size="14.00">Dense Comm</text>
<text text-anchor="middle" x="3708" y="-4971.8" font-family="Arial" font-size="14.00">GPU 11 → GPU 12</text>
<text text-anchor="middle" x="3708" y="-4956.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="3708" y="-4941.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- dense_layer_12&#45;&gt;comm_dense_12_13 -->
<g id="edge50" class="edge">
<title>dense_layer_12&#45;&gt;comm_dense_12_13</title>
<path fill="none" stroke="black" d="M3332.39,-5088.96C3332.39,-5070.66 3332.39,-5055 3332.39,-5055 3332.39,-5055 3582.58,-5055 3582.58,-5055 3582.58,-5055 3582.58,-4993.55 3582.58,-4993.55"/>
<polygon fill="black" stroke="black" points="3586.08,-4993.55 3582.58,-4983.55 3579.08,-4993.55 3586.08,-4993.55"/>
</g>
<!-- dense_layer_13 -->
<g id="node51" class="node">
<title>dense_layer_13</title>
<path fill="lightgreen" stroke="black" d="M3591,-5202C3591,-5202 3437,-5202 3437,-5202 3431,-5202 3425,-5196 3425,-5190 3425,-5190 3425,-5101 3425,-5101 3425,-5095 3431,-5089 3437,-5089 3437,-5089 3591,-5089 3591,-5089 3597,-5089 3603,-5095 3603,-5101 3603,-5101 3603,-5190 3603,-5190 3603,-5196 3597,-5202 3591,-5202"/>
<text text-anchor="middle" x="3514" y="-5186.8" font-family="Arial" font-size="14.00">Dense Layer 13</text>
<text text-anchor="middle" x="3514" y="-5171.8" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="3514" y="-5156.8" font-family="Arial" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="3514" y="-5141.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="3514" y="-5126.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="3514" y="-5111.8" font-family="Arial" font-size="14.00">Weights: ~67MB</text>
<text text-anchor="middle" x="3514" y="-5096.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_dense_13_14 -->
<g id="node67" class="node">
<title>comm_dense_13_14</title>
<ellipse fill="lightyellow" stroke="black" cx="4008" cy="-4968" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="4008" y="-4986.8" font-family="Arial" font-size="14.00">Dense Comm</text>
<text text-anchor="middle" x="4008" y="-4971.8" font-family="Arial" font-size="14.00">GPU 12 → GPU 13</text>
<text text-anchor="middle" x="4008" y="-4956.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="4008" y="-4941.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- dense_layer_13&#45;&gt;comm_dense_13_14 -->
<g id="edge51" class="edge">
<title>dense_layer_13&#45;&gt;comm_dense_13_14</title>
<path fill="none" stroke="black" d="M3589.39,-5088.67C3589.39,-5073.38 3589.39,-5061 3589.39,-5061 3589.39,-5061 3914.58,-5061 3914.58,-5061 3914.58,-5061 3914.58,-5012.1 3914.58,-5012.1"/>
<polygon fill="black" stroke="black" points="3918.08,-5012.1 3914.58,-5002.1 3911.08,-5012.1 3918.08,-5012.1"/>
</g>
<!-- dense_layer_14 -->
<g id="node52" class="node">
<title>dense_layer_14</title>
<path fill="lightgreen" stroke="black" d="M3805,-5202C3805,-5202 3651,-5202 3651,-5202 3645,-5202 3639,-5196 3639,-5190 3639,-5190 3639,-5101 3639,-5101 3639,-5095 3645,-5089 3651,-5089 3651,-5089 3805,-5089 3805,-5089 3811,-5089 3817,-5095 3817,-5101 3817,-5101 3817,-5190 3817,-5190 3817,-5196 3811,-5202 3805,-5202"/>
<text text-anchor="middle" x="3728" y="-5186.8" font-family="Arial" font-size="14.00">Dense Layer 14</text>
<text text-anchor="middle" x="3728" y="-5171.8" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="3728" y="-5156.8" font-family="Arial" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="3728" y="-5141.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="3728" y="-5126.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="3728" y="-5111.8" font-family="Arial" font-size="14.00">Weights: ~67MB</text>
<text text-anchor="middle" x="3728" y="-5096.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_dense_14_15 -->
<g id="node68" class="node">
<title>comm_dense_14_15</title>
<ellipse fill="lightyellow" stroke="black" cx="4308" cy="-4968" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="4308" y="-4986.8" font-family="Arial" font-size="14.00">Dense Comm</text>
<text text-anchor="middle" x="4308" y="-4971.8" font-family="Arial" font-size="14.00">GPU 13 → GPU 14</text>
<text text-anchor="middle" x="4308" y="-4956.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="4308" y="-4941.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- dense_layer_14&#45;&gt;comm_dense_14_15 -->
<g id="edge52" class="edge">
<title>dense_layer_14&#45;&gt;comm_dense_14_15</title>
<path fill="none" stroke="black" d="M3728,-5088.99C3728,-5076.05 3728,-5066 3728,-5066 3728,-5066 4198.85,-5066 4198.85,-5066 4198.85,-5066 4198.85,-5005.3 4198.85,-5005.3"/>
<polygon fill="black" stroke="black" points="4202.35,-5005.3 4198.85,-4995.3 4195.35,-5005.3 4202.35,-5005.3"/>
</g>
<!-- dense_layer_15 -->
<g id="node53" class="node">
<title>dense_layer_15</title>
<path fill="lightgreen" stroke="black" d="M4019,-5202C4019,-5202 3865,-5202 3865,-5202 3859,-5202 3853,-5196 3853,-5190 3853,-5190 3853,-5101 3853,-5101 3853,-5095 3859,-5089 3865,-5089 3865,-5089 4019,-5089 4019,-5089 4025,-5089 4031,-5095 4031,-5101 4031,-5101 4031,-5190 4031,-5190 4031,-5196 4025,-5202 4019,-5202"/>
<text text-anchor="middle" x="3942" y="-5186.8" font-family="Arial" font-size="14.00">Dense Layer 15</text>
<text text-anchor="middle" x="3942" y="-5171.8" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="3942" y="-5156.8" font-family="Arial" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="3942" y="-5141.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="3942" y="-5126.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="3942" y="-5111.8" font-family="Arial" font-size="14.00">Weights: ~67MB</text>
<text text-anchor="middle" x="3942" y="-5096.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- comm_dense_15_16 -->
<g id="node69" class="node">
<title>comm_dense_15_16</title>
<ellipse fill="lightyellow" stroke="black" cx="4608" cy="-4968" rx="132.46" ry="48.17"/>
<text text-anchor="middle" x="4608" y="-4986.8" font-family="Arial" font-size="14.00">Dense Comm</text>
<text text-anchor="middle" x="4608" y="-4971.8" font-family="Arial" font-size="14.00">GPU 14 → GPU 15</text>
<text text-anchor="middle" x="4608" y="-4956.8" font-family="Arial" font-size="14.00">Transfer: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="4608" y="-4941.8" font-family="Arial" font-size="14.00">Size: ~67MB</text>
</g>
<!-- dense_layer_15&#45;&gt;comm_dense_15_16 -->
<g id="edge53" class="edge">
<title>dense_layer_15&#45;&gt;comm_dense_15_16</title>
<path fill="none" stroke="black" d="M3953.39,-5088.93C3953.39,-5081.83 3953.39,-5077 3953.39,-5077 3953.39,-5077 4563.92,-5077 4563.92,-5077 4563.92,-5077 4563.92,-5023.59 4563.92,-5023.59"/>
<polygon fill="black" stroke="black" points="4567.42,-5023.59 4563.92,-5013.59 4560.42,-5023.59 4567.42,-5023.59"/>
</g>
<!-- dense_layer_16 -->
<g id="node54" class="node">
<title>dense_layer_16</title>
<path fill="lightgreen" stroke="black" d="M4233,-5202C4233,-5202 4079,-5202 4079,-5202 4073,-5202 4067,-5196 4067,-5190 4067,-5190 4067,-5101 4067,-5101 4067,-5095 4073,-5089 4079,-5089 4079,-5089 4233,-5089 4233,-5089 4239,-5089 4245,-5095 4245,-5101 4245,-5101 4245,-5190 4245,-5190 4245,-5196 4239,-5202 4233,-5202"/>
<text text-anchor="middle" x="4156" y="-5186.8" font-family="Arial" font-size="14.00">Dense Layer 16</text>
<text text-anchor="middle" x="4156" y="-5171.8" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="4156" y="-5156.8" font-family="Arial" font-size="14.00">MHA + FFN</text>
<text text-anchor="middle" x="4156" y="-5141.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="4156" y="-5126.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="4156" y="-5111.8" font-family="Arial" font-size="14.00">Weights: ~67MB</text>
<text text-anchor="middle" x="4156" y="-5096.8" font-family="Arial" font-size="14.00">Activations: ~67MB</text>
</g>
<!-- output_dense -->
<g id="node70" class="node">
<title>output_dense</title>
<path fill="lightblue" stroke="black" d="M4974,-4994.5C4974,-4994.5 4788,-4994.5 4788,-4994.5 4782,-4994.5 4776,-4988.5 4776,-4982.5 4776,-4982.5 4776,-4953.5 4776,-4953.5 4776,-4947.5 4782,-4941.5 4788,-4941.5 4788,-4941.5 4974,-4941.5 4974,-4941.5 4980,-4941.5 4986,-4947.5 4986,-4953.5 4986,-4953.5 4986,-4982.5 4986,-4982.5 4986,-4988.5 4980,-4994.5 4974,-4994.5"/>
<text text-anchor="middle" x="4881" y="-4979.3" font-family="Arial" font-size="14.00">Dense Output</text>
<text text-anchor="middle" x="4881" y="-4964.3" font-family="Arial" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="4881" y="-4949.3" font-family="Arial" font-size="14.00">Logits: [1024, 2048, vocab_size]</text>
</g>
<!-- dense_layer_16&#45;&gt;output_dense -->
<g id="edge54" class="edge">
<title>dense_layer_16&#45;&gt;output_dense</title>
<path fill="none" stroke="black" d="M4245.26,-5164C4439.05,-5164 4881,-5164 4881,-5164 4881,-5164 4881,-5004.84 4881,-5004.84"/>
<polygon fill="black" stroke="black" points="4884.5,-5004.84 4881,-4994.84 4877.5,-5004.84 4884.5,-5004.84"/>
</g>
<!-- comm_dense_1_2&#45;&gt;dense_layer_2 -->
<g id="edge55" class="edge">
<title>comm_dense_1_2&#45;&gt;dense_layer_2</title>
<path fill="none" stroke="black" d="M1066.44,-5322C1082.57,-5322 1093.5,-5322 1093.5,-5322 1093.5,-5322 1093.5,-5212.32 1093.5,-5212.32"/>
<polygon fill="black" stroke="black" points="1097,-5212.32 1093.5,-5202.32 1090,-5212.32 1097,-5212.32"/>
</g>
<!-- comm_dense_2_3&#45;&gt;dense_layer_3 -->
<g id="edge56" class="edge">
<title>comm_dense_2_3&#45;&gt;dense_layer_3</title>
<path fill="none" stroke="black" d="M827.41,-4988.82C827.41,-5021.96 827.41,-5083 827.41,-5083 827.41,-5083 1323.81,-5083 1323.81,-5083 1323.81,-5083 1323.81,-5083.58 1323.81,-5083.58"/>
<polygon fill="black" stroke="black" points="1320.31,-5078.77 1323.81,-5088.77 1327.31,-5078.77 1320.31,-5078.77"/>
</g>
<!-- comm_dense_3_4&#45;&gt;dense_layer_4 -->
<g id="edge57" class="edge">
<title>comm_dense_3_4&#45;&gt;dense_layer_4</title>
<path fill="none" stroke="black" d="M1117.15,-4995.44C1117.15,-5017.21 1117.15,-5044 1117.15,-5044 1117.15,-5044 1588,-5044 1588,-5044 1588,-5044 1588,-5078.81 1588,-5078.81"/>
<polygon fill="black" stroke="black" points="1584.5,-5078.81 1588,-5088.81 1591.5,-5078.81 1584.5,-5078.81"/>
</g>
<!-- comm_dense_4_5&#45;&gt;dense_layer_5 -->
<g id="edge58" class="edge">
<title>comm_dense_4_5&#45;&gt;dense_layer_5</title>
<path fill="none" stroke="black" d="M1401.42,-5002.25C1401.42,-5020.41 1401.42,-5039 1401.42,-5039 1401.42,-5039 1719.81,-5039 1719.81,-5039 1719.81,-5039 1719.81,-5078.82 1719.81,-5078.82"/>
<polygon fill="black" stroke="black" points="1716.31,-5078.82 1719.81,-5088.82 1723.31,-5078.82 1716.31,-5078.82"/>
</g>
<!-- comm_dense_5_6&#45;&gt;dense_layer_6 -->
<g id="edge59" class="edge">
<title>comm_dense_5_6&#45;&gt;dense_layer_6</title>
<path fill="none" stroke="black" d="M1733.42,-4983.4C1733.42,-5002.62 1733.42,-5033 1733.42,-5033 1733.42,-5033 1955.31,-5033 1955.31,-5033 1955.31,-5033 1955.31,-5078.92 1955.31,-5078.92"/>
<polygon fill="black" stroke="black" points="1951.81,-5078.92 1955.31,-5088.92 1958.81,-5078.92 1951.81,-5078.92"/>
</g>
<!-- comm_dense_6_7&#45;&gt;dense_layer_7 -->
<g id="edge60" class="edge">
<title>comm_dense_6_7&#45;&gt;dense_layer_7</title>
<path fill="none" stroke="black" d="M2011.92,-4998C2011.92,-5013 2011.92,-5028 2011.92,-5028 2011.92,-5028 2200.33,-5028 2200.33,-5028 2200.33,-5028 2200.33,-5078.81 2200.33,-5078.81"/>
<polygon fill="black" stroke="black" points="2196.83,-5078.81 2200.33,-5088.81 2203.83,-5078.81 2196.83,-5078.81"/>
</g>
<!-- comm_dense_7_8&#45;&gt;dense_layer_8 -->
<g id="edge61" class="edge">
<title>comm_dense_7_8&#45;&gt;dense_layer_8</title>
<path fill="none" stroke="black" d="M2340.45,-4967C2355.39,-4967 2365.39,-4967 2365.39,-4967 2365.39,-4967 2365.39,-5078.53 2365.39,-5078.53"/>
<polygon fill="black" stroke="black" points="2361.89,-5078.53 2365.39,-5088.53 2368.89,-5078.53 2361.89,-5078.53"/>
</g>
<!-- comm_dense_8_9&#45;&gt;dense_layer_9 -->
<g id="edge62" class="edge">
<title>comm_dense_8_9&#45;&gt;dense_layer_9</title>
<path fill="none" stroke="black" d="M2604.61,-5000.97C2604.61,-5000.97 2604.61,-5078.97 2604.61,-5078.97"/>
<polygon fill="black" stroke="black" points="2601.11,-5078.97 2604.61,-5088.97 2608.11,-5078.97 2601.11,-5078.97"/>
</g>
<!-- comm_dense_9_10&#45;&gt;dense_layer_10 -->
<g id="edge63" class="edge">
<title>comm_dense_9_10&#45;&gt;dense_layer_10</title>
<path fill="none" stroke="black" d="M2861.61,-5012.33C2861.61,-5012.33 2861.61,-5078.99 2861.61,-5078.99"/>
<polygon fill="black" stroke="black" points="2858.11,-5078.99 2861.61,-5088.99 2865.11,-5078.99 2858.11,-5078.99"/>
</g>
<!-- comm_dense_10_11&#45;&gt;dense_layer_11 -->
<g id="edge64" class="edge">
<title>comm_dense_10_11&#45;&gt;dense_layer_11</title>
<path fill="none" stroke="black" d="M3115.67,-5016.03C3115.67,-5016.03 3115.67,-5078.92 3115.67,-5078.92"/>
<polygon fill="black" stroke="black" points="3112.17,-5078.92 3115.67,-5088.92 3119.17,-5078.92 3112.17,-5078.92"/>
</g>
<!-- comm_dense_11_12&#45;&gt;dense_layer_12 -->
<g id="edge65" class="edge">
<title>comm_dense_11_12&#45;&gt;dense_layer_12</title>
<path fill="none" stroke="black" d="M3360.69,-5013.25C3360.69,-5013.25 3360.69,-5078.88 3360.69,-5078.88"/>
<polygon fill="black" stroke="black" points="3357.19,-5078.88 3360.69,-5088.88 3364.19,-5078.88 3357.19,-5078.88"/>
</g>
<!-- comm_dense_12_13&#45;&gt;dense_layer_13 -->
<g id="edge66" class="edge">
<title>comm_dense_12_13&#45;&gt;dense_layer_13</title>
<path fill="none" stroke="black" d="M3596.19,-4993.81C3596.19,-4993.81 3596.19,-5078.86 3596.19,-5078.86"/>
<polygon fill="black" stroke="black" points="3592.69,-5078.86 3596.19,-5088.86 3599.69,-5078.86 3592.69,-5078.86"/>
</g>
<!-- comm_dense_13_14&#45;&gt;dense_layer_14 -->
<g id="edge67" class="edge">
<title>comm_dense_13_14&#45;&gt;dense_layer_14</title>
<path fill="none" stroke="black" d="M3875.47,-4967C3858.34,-4967 3846.61,-4967 3846.61,-4967 3846.61,-4967 3846.61,-5145 3846.61,-5145 3846.61,-5145 3827.29,-5145 3827.29,-5145"/>
<polygon fill="black" stroke="black" points="3827.29,-5141.5 3817.29,-5145 3827.29,-5148.5 3827.29,-5141.5"/>
</g>
<!-- comm_dense_14_15&#45;&gt;dense_layer_15 -->
<g id="edge68" class="edge">
<title>comm_dense_14_15&#45;&gt;dense_layer_15</title>
<path fill="none" stroke="black" d="M4221.92,-5004.67C4221.92,-5034.61 4221.92,-5072 4221.92,-5072 4221.92,-5072 3992.19,-5072 3992.19,-5072 3992.19,-5072 3992.19,-5078.68 3992.19,-5078.68"/>
<polygon fill="black" stroke="black" points="3988.69,-5078.68 3992.19,-5088.68 3995.69,-5078.68 3988.69,-5078.68"/>
</g>
<!-- comm_dense_15_16&#45;&gt;dense_layer_16 -->
<g id="edge69" class="edge">
<title>comm_dense_15_16&#45;&gt;dense_layer_16</title>
<path fill="none" stroke="black" d="M4652.08,-5013.7C4652.08,-5060.36 4652.08,-5126 4652.08,-5126 4652.08,-5126 4255.26,-5126 4255.26,-5126"/>
<polygon fill="black" stroke="black" points="4255.26,-5122.5 4245.26,-5126 4255.26,-5129.5 4255.26,-5122.5"/>
</g>
<!-- expert_1_0 -->
<g id="node71" class="node">
<title>expert_1_0</title>
<path fill="lightyellow" stroke="black" d="M462,-5742C462,-5742 308,-5742 308,-5742 302,-5742 296,-5736 296,-5730 296,-5730 296,-5641 296,-5641 296,-5635 302,-5629 308,-5629 308,-5629 462,-5629 462,-5629 468,-5629 474,-5635 474,-5641 474,-5641 474,-5730 474,-5730 474,-5736 468,-5742 462,-5742"/>
<text text-anchor="middle" x="385" y="-5726.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="385" y="-5711.8" font-family="Arial" font-size="14.00">MoE Layer 1</text>
<text text-anchor="middle" x="385" y="-5696.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="385" y="-5681.8" font-family="Arial" font-size="14.00">Gate+Up+Down</text>
<text text-anchor="middle" x="385" y="-5666.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="385" y="-5651.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="385" y="-5636.8" font-family="Arial" font-size="14.00">Weights: ~201MB</text>
</g>
<!-- expert_1_1 -->
<g id="node72" class="node">
<title>expert_1_1</title>
<path fill="lightyellow" stroke="black" d="M676,-5742C676,-5742 522,-5742 522,-5742 516,-5742 510,-5736 510,-5730 510,-5730 510,-5641 510,-5641 510,-5635 516,-5629 522,-5629 522,-5629 676,-5629 676,-5629 682,-5629 688,-5635 688,-5641 688,-5641 688,-5730 688,-5730 688,-5736 682,-5742 676,-5742"/>
<text text-anchor="middle" x="599" y="-5726.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="599" y="-5711.8" font-family="Arial" font-size="14.00">MoE Layer 1</text>
<text text-anchor="middle" x="599" y="-5696.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="599" y="-5681.8" font-family="Arial" font-size="14.00">Gate+Up+Down</text>
<text text-anchor="middle" x="599" y="-5666.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="599" y="-5651.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="599" y="-5636.8" font-family="Arial" font-size="14.00">Weights: ~201MB</text>
</g>
<!-- expert_1_2 -->
<g id="node73" class="node">
<title>expert_1_2</title>
<path fill="lightyellow" stroke="black" d="M890,-5742C890,-5742 736,-5742 736,-5742 730,-5742 724,-5736 724,-5730 724,-5730 724,-5641 724,-5641 724,-5635 730,-5629 736,-5629 736,-5629 890,-5629 890,-5629 896,-5629 902,-5635 902,-5641 902,-5641 902,-5730 902,-5730 902,-5736 896,-5742 890,-5742"/>
<text text-anchor="middle" x="813" y="-5726.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="813" y="-5711.8" font-family="Arial" font-size="14.00">MoE Layer 1</text>
<text text-anchor="middle" x="813" y="-5696.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="813" y="-5681.8" font-family="Arial" font-size="14.00">Gate+Up+Down</text>
<text text-anchor="middle" x="813" y="-5666.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="813" y="-5651.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="813" y="-5636.8" font-family="Arial" font-size="14.00">Weights: ~201MB</text>
</g>
<!-- expert_1_3 -->
<g id="node74" class="node">
<title>expert_1_3</title>
<path fill="lightyellow" stroke="black" d="M1104,-5742C1104,-5742 950,-5742 950,-5742 944,-5742 938,-5736 938,-5730 938,-5730 938,-5641 938,-5641 938,-5635 944,-5629 950,-5629 950,-5629 1104,-5629 1104,-5629 1110,-5629 1116,-5635 1116,-5641 1116,-5641 1116,-5730 1116,-5730 1116,-5736 1110,-5742 1104,-5742"/>
<text text-anchor="middle" x="1027" y="-5726.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1027" y="-5711.8" font-family="Arial" font-size="14.00">MoE Layer 1</text>
<text text-anchor="middle" x="1027" y="-5696.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1027" y="-5681.8" font-family="Arial" font-size="14.00">Gate+Up+Down</text>
<text text-anchor="middle" x="1027" y="-5666.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1027" y="-5651.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1027" y="-5636.8" font-family="Arial" font-size="14.00">Weights: ~201MB</text>
</g>
<!-- expert_1_4 -->
<g id="node75" class="node">
<title>expert_1_4</title>
<path fill="lightyellow" stroke="black" d="M1318,-5742C1318,-5742 1164,-5742 1164,-5742 1158,-5742 1152,-5736 1152,-5730 1152,-5730 1152,-5641 1152,-5641 1152,-5635 1158,-5629 1164,-5629 1164,-5629 1318,-5629 1318,-5629 1324,-5629 1330,-5635 1330,-5641 1330,-5641 1330,-5730 1330,-5730 1330,-5736 1324,-5742 1318,-5742"/>
<text text-anchor="middle" x="1241" y="-5726.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1241" y="-5711.8" font-family="Arial" font-size="14.00">MoE Layer 1</text>
<text text-anchor="middle" x="1241" y="-5696.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1241" y="-5681.8" font-family="Arial" font-size="14.00">Gate+Up+Down</text>
<text text-anchor="middle" x="1241" y="-5666.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1241" y="-5651.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1241" y="-5636.8" font-family="Arial" font-size="14.00">Weights: ~201MB</text>
</g>
<!-- expert_1_5 -->
<g id="node76" class="node">
<title>expert_1_5</title>
<path fill="lightyellow" stroke="black" d="M1532,-5742C1532,-5742 1378,-5742 1378,-5742 1372,-5742 1366,-5736 1366,-5730 1366,-5730 1366,-5641 1366,-5641 1366,-5635 1372,-5629 1378,-5629 1378,-5629 1532,-5629 1532,-5629 1538,-5629 1544,-5635 1544,-5641 1544,-5641 1544,-5730 1544,-5730 1544,-5736 1538,-5742 1532,-5742"/>
<text text-anchor="middle" x="1455" y="-5726.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="1455" y="-5711.8" font-family="Arial" font-size="14.00">MoE Layer 1</text>
<text text-anchor="middle" x="1455" y="-5696.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1455" y="-5681.8" font-family="Arial" font-size="14.00">Gate+Up+Down</text>
<text text-anchor="middle" x="1455" y="-5666.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1455" y="-5651.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1455" y="-5636.8" font-family="Arial" font-size="14.00">Weights: ~201MB</text>
</g>
<!-- expert_1_6 -->
<g id="node77" class="node">
<title>expert_1_6</title>
<path fill="lightyellow" stroke="black" d="M1746,-5742C1746,-5742 1592,-5742 1592,-5742 1586,-5742 1580,-5736 1580,-5730 1580,-5730 1580,-5641 1580,-5641 1580,-5635 1586,-5629 1592,-5629 1592,-5629 1746,-5629 1746,-5629 1752,-5629 1758,-5635 1758,-5641 1758,-5641 1758,-5730 1758,-5730 1758,-5736 1752,-5742 1746,-5742"/>
<text text-anchor="middle" x="1669" y="-5726.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1669" y="-5711.8" font-family="Arial" font-size="14.00">MoE Layer 1</text>
<text text-anchor="middle" x="1669" y="-5696.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1669" y="-5681.8" font-family="Arial" font-size="14.00">Gate+Up+Down</text>
<text text-anchor="middle" x="1669" y="-5666.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1669" y="-5651.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1669" y="-5636.8" font-family="Arial" font-size="14.00">Weights: ~201MB</text>
</g>
<!-- expert_1_7 -->
<g id="node78" class="node">
<title>expert_1_7</title>
<path fill="lightyellow" stroke="black" d="M1960,-5742C1960,-5742 1806,-5742 1806,-5742 1800,-5742 1794,-5736 1794,-5730 1794,-5730 1794,-5641 1794,-5641 1794,-5635 1800,-5629 1806,-5629 1806,-5629 1960,-5629 1960,-5629 1966,-5629 1972,-5635 1972,-5641 1972,-5641 1972,-5730 1972,-5730 1972,-5736 1966,-5742 1960,-5742"/>
<text text-anchor="middle" x="1883" y="-5726.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="1883" y="-5711.8" font-family="Arial" font-size="14.00">MoE Layer 1</text>
<text text-anchor="middle" x="1883" y="-5696.8" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1883" y="-5681.8" font-family="Arial" font-size="14.00">Gate+Up+Down</text>
<text text-anchor="middle" x="1883" y="-5666.8" font-family="Arial" font-size="14.00">Input: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1883" y="-5651.8" font-family="Arial" font-size="14.00">Output: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1883" y="-5636.8" font-family="Arial" font-size="14.00">Weights: ~201MB</text>
</g>
</g>
</svg>
